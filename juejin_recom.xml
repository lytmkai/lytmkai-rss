<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[AI å‘å³ï¼Œç¤¾åŒºå‘å·¦-Captain çš„ 2025å¹´ç»ˆæ€»ç»“]]></title>    <link>https://juejin.cn/post/7589509638354321435</link>    <guid>https://juejin.cn/post/7589509638354321435</guid>    <pubDate>2025-12-30T09:53:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589509638354321435" data-draft-id="7589214068093927443" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI å‘å³ï¼Œç¤¾åŒºå‘å·¦-Captain çš„ 2025å¹´ç»ˆæ€»ç»“"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-30T09:53:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XCaptaino"/> <meta itemprop="url" content="https://juejin.cn/user/3052665287739005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI å‘å³ï¼Œç¤¾åŒºå‘å·¦-Captain çš„ 2025å¹´ç»ˆæ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3052665287739005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XCaptaino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:53:30.000Z" title="Tue Dec 30 2025 09:53:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI å‘å³ï¼Œç¤¾åŒºå‘å·¦</h2>
<p>ç«™åœ¨ 2025 çš„å°¾å·´ä¸Šå›æœ›ï¼Œè¿™ç¡®å®æ˜¯æå…·æ’•è£‚æ„Ÿçš„ä¸€å¹´ã€‚</p>
<p>ä¸€æ–¹é¢ï¼ŒAI æŠ€æœ¯åƒä¸€åˆ—é«˜é€Ÿåˆ—è½¦ï¼Œè½°é¸£ç€å‘ç€æ›´å¼ºçš„é€»è¾‘ã€æ›´é«˜çš„æ•ˆç‡ã€æ›´æè‡´çš„è‡ªåŠ¨åŒ–ç‹‚å¥”â€”â€”æˆ‘ç§°ä¹‹ä¸º <strong>â€œå‘å³â€ <strong>ï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨ç®—æ³•çš„æŒ¤å‹ä¸‹ï¼Œäººç±»çš„ç¤¾åŒºã€æƒ…æ„Ÿä¸ä»·å€¼æ­£åœ¨å‘ç”ŸæŸç§åº”æ¿€æ€§çš„å›æ’¤ï¼Œæˆ‘ä»¬å¼€å§‹å¯»æ‰¾é‚£äº›æ¨¡å‹å’Œ AIæ— æ³•è§¦è¾¾çš„æ¸©çƒ­â€”â€”æˆ‘ç§°ä¹‹ä¸º</strong>â€œå‘å·¦â€</strong>ã€‚</p>
<p>ä½œä¸ºèº«å¤„AIé£æš´ä¸­å¿ƒçš„è§‚å¯Ÿè€…ï¼Œè¿™æ˜¯æˆ‘å¯¹ 2025 å¹´ AI ç¼–ç¨‹å‘å±•çš„æ€è€ƒï¼Œä»¥åŠæˆ‘è¿™ä¸€å¹´çš„ä¸ªäººç­”å·ã€‚</p>
<h2 data-id="heading-1">Part 1. AI å‘å³ï¼šèŒƒå¼çš„æé€Ÿç‹‚å¥”</h2>
<p>æœ¬æ¬¡è§‚å¯Ÿä¸»è¦æ˜¯ç»“åˆAndrej Karpathy æ˜¯ OpenAI è”åˆåˆ›å§‹äººã€å‰ç‰¹æ–¯æ‹‰ AI æ€»ç›‘çš„ 2025 å¹´ LLM å¹´åº¦å›é¡¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0af4b5621dfe45f99b66d1c953c17431~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767693325&amp;x-signature=bdtLO7%2Fg%2FAco4UN6jgh%2BCWEF5M0%3D" alt="img_v3_02t7_5d451660-02e5-4df8-bc0d-a5fbe9e86a3g.jpg" loading="lazy"/></p>
<p>Andrej Karpathyï¼ˆOpenAI è”åˆåˆ›å§‹äººï¼‰çš„å¹´åº¦å›é¡¾ç²¾å‡†åœ°æç»˜äº† AI æŠ€æœ¯â€œå‘å³â€ç‹‚å¥”çš„è½¨è¿¹ã€‚è¿™ä¸€å¹´ï¼ŒAI ç¼–ç¨‹ä¸å†æ˜¯ç®€å•çš„è¾…åŠ©ï¼Œè€Œæ˜¯æ­£åœ¨é‡å¡‘â€œæ™ºèƒ½â€çš„å®šä¹‰ã€‚</p>
<h4 data-id="heading-2">1. è®­ç»ƒèŒƒå¼çš„â€œé¡¿æ‚Ÿâ€</h4>
<p>2025 å¹´æœ€å¤§çš„æŠ€æœ¯å˜é‡æ˜¯ <strong>RLVRï¼ˆå¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹ ï¼‰</strong> ã€‚ è¿‡å»çš„ AI æ˜¯â€œç…§è‘«èŠ¦ç”»ç“¢â€ï¼Œäººç±»æ€ä¹ˆå†™ä»£ç å®ƒå°±æ€ä¹ˆå­¦ã€‚ä½† RLVR å¼•å…¥äº†â€œæ ‡å‡†ç­”æ¡ˆâ€ç¯å¢ƒï¼ˆå¦‚æ•°å­¦é¢˜ã€ä»£ç ç¼–è¯‘ï¼‰ï¼ŒæŠŠæ¨¡å‹ç›´æ¥æ‰”è¿›æ°´é‡Œï¼Œåªè¦æ¸¸åˆ°å¯¹å²¸ï¼Œå§¿åŠ¿éšä¾¿ã€‚ ç»“æœä»¤äººéœ‡æƒŠï¼šæ¨¡å‹è‡ªå·±â€œæ‚Ÿâ€å‡ºäº†æ¨ç†èƒ½åŠ›ã€‚å®ƒå­¦ä¼šäº†æ‹†è§£æ­¥éª¤ã€å­¦ä¼šäº†è‡ªæˆ‘çº é”™ã€‚OpenAI çš„ o1 å’Œ o3 å°±æ˜¯è¿™ç§æ€ç»´é“¾æ¡ï¼ˆChain of Thoughtï¼‰çš„äº§ç‰©ã€‚ç®—åŠ›åˆ†é…ä¹Ÿå˜äº†â€”â€”ä»æ­»ç£•é¢„è®­ç»ƒï¼Œè½¬å‘äº†è®©æ¨¡å‹åœ¨æ¨ç†æ—¶â€œå¤šæƒ³ä¸€ä¼šå„¿â€ã€‚</p>
<h4 data-id="heading-3">2. â€œå‚å·®ä¸é½â€çš„å¹½çµ</h4>
<p>Karpathy è¯´æˆ‘ä»¬åœ¨â€œå¬å”¤å¹½çµâ€ã€‚å› ä¸ºä¼˜åŒ–ç›®æ ‡ä¸åŒï¼ˆäººç±»ä¸ºäº†ç”Ÿå­˜ï¼ŒAI ä¸ºäº†åˆ·æ¦œï¼‰ï¼ŒAI å±•ç°å‡ºä¸€ç§ <strong>Jagged Intelligenceï¼ˆå‚å·®ä¸é½çš„æ™ºèƒ½ï¼‰</strong> ã€‚ å®ƒåœ¨æœ‰æ ‡å‡†ç­”æ¡ˆçš„é¢†åŸŸï¼ˆä»£ç ã€æ•°å­¦ï¼‰è¿›åŒ–ç¥é€Ÿï¼Œé•¿å‡ºäº†å°–åˆºï¼›ä½†åœ¨å¸¸è¯†ã€åˆ›æ„ç­‰æ¨¡ç³Šé¢†åŸŸï¼Œä¾ç„¶ä¼šçŠ¯ä½çº§é”™è¯¯ã€‚è¿™ä¹Ÿå¯¼è‡´äº†åŸºå‡†æµ‹è¯•ï¼ˆBenchmarkï¼‰çš„å´©å¡Œâ€”â€”åˆ·æ¦œæˆäº†ä¸€ç§é’ˆå¯¹æ€§ä¼˜åŒ–çš„è‰ºæœ¯ï¼Œåˆ†æ•°è™½é«˜ï¼Œç¦»é€šç”¨æ™ºèƒ½å°šè¿œã€‚</p>
<h4 data-id="heading-4">3. åº”ç”¨å±‚çš„çˆ†å‘ä¸â€œVibe Codingâ€</h4>
<p>Cursor çš„ç«çˆ†è¯æ˜äº† <strong>â€œLLM åº”ç”¨å±‚â€</strong> çš„æˆç«‹ã€‚å®ƒæ˜¯æŠŠé€šç”¨æ¨¡å‹ï¼ˆå¤§å­¦æ¯•ä¸šç”Ÿï¼‰åŸ¹è®­æˆä¸“ä¸šå‘˜å·¥ï¼ˆè¡Œä¸šä¸“å®¶ï¼‰çš„ä¸­é—´å±‚ã€‚ æ›´æ¿€è¿›çš„å˜åŒ–æ˜¯ <strong>Vibe Codingï¼ˆæ°›å›´ç¼–ç¨‹ï¼‰</strong> çš„å…´èµ·ã€‚ç°åœ¨çš„ç¼–ç¨‹é—¨æ§›ä½åˆ°åªéœ€è¦ä½ ä¼šè‹±è¯­ï¼Œæè¿°éœ€æ±‚ï¼Œå®Œå…¨ä¸ç”¨ç®¡ä»£ç å®ç°ã€‚ä»£ç å˜å¾—å»‰ä»·ã€å³ç”¨å³å¼ƒï¼Œåƒè‰ç¨¿çº¸ä¸€æ ·ã€‚ è¿™ä¸ä»…è®©æ™®é€šäººèƒ½ç¼–ç¨‹ï¼Œä¹Ÿè®©ä¸“ä¸šç¨‹åºå‘˜å¼€å§‹å†™é‚£äº›ä»¥å‰â€œä¸å€¼å¾—å†™â€çš„ä¸€æ¬¡æ€§å·¥å…·ã€‚</p>
<h4 data-id="heading-5">4. ä½åœ¨ç”µè„‘é‡Œçš„â€œå°ç²¾çµâ€</h4>
<p>Claude Code å±•ç¤ºäº†æœªæ¥çš„æ–¹å‘ï¼š<strong>æœ¬åœ°åŒ–æ™ºèƒ½ä½“ï¼ˆAgentï¼‰</strong> ã€‚ OpenAI æ›¾èµŒæ³¨äº‘ç«¯ï¼Œä½† Karpathy è®¤ä¸ºå½“ä¸‹æ›´åˆç†çš„æ˜¯è®© AI è·‘åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œè¯»å–ä½ çš„æœ¬åœ°ç¯å¢ƒã€æ–‡ä»¶å’Œä¸Šä¸‹æ–‡ï¼Œåƒä¸€ä¸ªå’Œä½ å¹¶è‚©ä½œæˆ˜çš„åŒäº‹ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç½‘é¡µèŠå¤©æ¡†ã€‚</p>
<h4 data-id="heading-6">5. å¤§æ¨¡å‹çš„ GUI æ—¶ä»£</h4>
<p>Google Gemini Nano Banana é¢„ç¤ºäº†ä¸‹ä¸€ä¸ªèŒƒå¼ï¼šå¤§æ¨¡å‹ä¸è¯¥åªåæ–‡å­—ï¼Œå®ƒåº”è¯¥åƒ 80 å¹´ä»£çš„è®¡ç®—æœºè¿›åŒ–å‡ºå›¾å½¢ç•Œé¢ä¸€æ ·ï¼Œå­¦ä¼šç”¨å›¾è¡¨ã€å¹»ç¯ç‰‡ã€ç™½æ¿ç”šè‡³å°åº”ç”¨æ¥å›åº”äººç±»ã€‚è¿™æ‰æ˜¯ LLM çœŸæ­£çš„åŸç”Ÿäº¤äº’å½¢æ€ã€‚</p>
<p>Karpathy çš„æ€»ç»“æ˜¯è¿™æ ·çš„ï¼š2025 å¹´çš„å¤§æ¨¡å‹ï¼Œæ¯”ä»–é¢„æœŸçš„èªæ˜ï¼Œä¹Ÿæ¯”ä»–é¢„æœŸçš„è ¢ã€‚ä¸¤è€…åŒæ—¶æˆç«‹ã€‚</p>
<p>ä½†æœ‰ä¸€ç‚¹å¾ˆç¡®å®šï¼šå³ä½¿ä»¥ç°åœ¨çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬è¿ 10% çš„æ½œåŠ›éƒ½æ²¡æŒ–æ˜å‡ºæ¥ã€‚è¿˜æœ‰å¤ªå¤šæƒ³æ³•å¯ä»¥è¯•ï¼Œæ•´ä¸ªé¢†åŸŸæ„Ÿè§‰æ˜¯æ•å¼€çš„ã€‚</p>
<p>ä»–åœ¨ Dwarkesh çš„æ’­å®¢é‡Œè¯´è¿‡ä¸€å¥çœ‹ä¼¼çŸ›ç›¾çš„è¯ï¼š</p>
<blockquote>
<p>ä»–ç›¸ä¿¡è¿›æ­¥ä¼šç»§ç»­é£é€Ÿæ¨è¿›ï¼Œ</p>
</blockquote>
<blockquote>
<p>åŒæ—¶ä¹Ÿç›¸ä¿¡è¿˜æœ‰å¤§é‡çš„å·¥ä½œè¦åšã€‚</p>
</blockquote>
<p>å…¶å®ä¸¤ä»¶äº‹å¹¶ä¸çŸ›ç›¾ã€‚ç›®å‰è¿™ä¸ªé˜¶æ®µçš„AI è®©æ‰§è¡Œå˜å¿«äº†ï¼Œä½†å®ƒæ²¡æœ‰è®©â€œçŸ¥é“è¯¥åšä»€ä¹ˆâ€è¿™ä»¶äº‹å˜ç®€å•ã€‚ç›¸åï¼Œå› ä¸ºæ‰§è¡Œæˆæœ¬ä¸‹é™ï¼Œâ€œåšä»€ä¹ˆâ€çš„å†³ç­–å˜å¾—æ›´é‡è¦äº†â€”â€”ä½ å¯ä»¥å¾ˆå¿«åšå‡º 20 ä¸ªç‰ˆæœ¬ï¼Œä½†ä½ å¾—çŸ¥é“å“ªä¸ªæ˜¯å¯¹çš„ã€‚</p>
<p>å‡ å¹´åçš„è½¯ä»¶å·¥ç¨‹ä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿæ²¡äººèƒ½å‡†ç¡®é¢„æµ‹ã€‚ä½† Claude Code å›¢é˜Ÿçš„ä»Šå¤©ï¼Œå¯èƒ½æ˜¯å¾ˆå¤šå›¢é˜Ÿæ˜å¤©çš„æŸç§é¢„æ¼”â€”â€”æ›´å¿«çš„è¿­ä»£ã€æ›´å°‘çš„â€œæ¬ç –â€ã€æ›´å¤šçš„åˆ¤æ–­å’Œå†³ç­–ã€‚</p>
<p>å·¥å…·åœ¨å˜ã€‚ä¸å˜çš„æ˜¯ï¼Œæœ€ç»ˆåšå†³å®šçš„è¿˜æ˜¯äººã€‚</p>
<h2 data-id="heading-7">Part 2. ç¤¾åŒºå‘å·¦ï¼šäººç±»çš„ä»·å€¼å›æ’¤å’Œé‡å¡‘</h2>
<p>å½“ AI åœ¨ç¬¦å·é€»è¾‘çš„é¢†åŸŸæ”»åŸç•¥åœ°æ—¶ï¼Œä¼ ç»Ÿçš„ç¨‹åºå‘˜ç¤¾åŒºå’Œäººç±»åŠ³åŠ¨ä»·å€¼æ­£åœ¨è¢«è¿«å¯»æ‰¾æ–°çš„é”šç‚¹ã€‚</p>
<h3 data-id="heading-8">ä¼ ç»Ÿé—®ç­”ç¤¾åŒºçš„é»„æ˜</h3>
<p>æ‰€æœ‰ç±»ä¼¼ Stack Overflow çš„é—®ç­”å’ŒçŸ¥è¯†ç¤¾åŒºè¡°è½æ˜¯ä¸å¯é€†çš„ã€‚</p>
<p>æ—¢ç„¶ AI èƒ½ç¬é—´ç»™å‡ºä»£ç ç‰‡æ®µï¼Œè°è¿˜æ„¿æ„å»æœç´¢å¼•æ“æˆ–è€… BBSè®ºå›ç­‰å¾…ä¸€ä¸ªæœªçŸ¥çš„å›å¤ï¼Ÿ</p>
<ul>
<li><strong>æµé‡æš´è·Œï¼š</strong> åªæœ‰çº¯æŠ€æœ¯é—®ç­”åœ¨è¢«æ›¿ä»£ã€‚</li>
<li><strong>è´¨é‡æ¶åŒ–ï¼š</strong> AI ç”Ÿæˆçš„åƒåœ¾å†…å®¹æ³›æ»¥ï¼Œéœ€è¦äººè‚‰æ’é›·ã€‚</li>
</ul>
<p>ä½† Reddit è¿™ç§å¼ºç¤¾äº¤å±æ€§çš„ç¤¾åŒºåè€Œåœ¨å¤å…´ã€‚<strong>è¿™è¯´æ˜äº†â€œå‘å·¦â€çš„è¶‹åŠ¿ï¼š</strong> çŸ¥è¯†è·å–å˜å¾—å»‰ä»·åï¼Œ<strong>äººä¸äººçš„è¿æ¥ã€æƒ…æ„Ÿå…±é¸£ã€çº¿ä¸‹è§é¢çš„ä»·å€¼</strong>åè€Œå˜å¾—æ— æ¯”æ˜‚è´µã€‚é‚£ä¹ˆåé¢ç¤¾åŒºçš„æŒä¹…ä»·å€¼åœ¨å“ªé‡Œï¼Ÿå¯ä»¥æ·±åº¦é“¾æ¥çº¿ä¸‹ç¤¾åŒºå’Œæ·±åº¦ç¤¾äº¤çš„ç¤¾åŒºï¼Œå› æ­¤æˆ‘ä¸ªäººæ¯”è¾ƒçœ‹å¥½ reddit å’Œç¤¾ç¾¤çš„ä»·å€¼ã€‚</p>
<h3 data-id="heading-9">ç¡…åŸºç”Ÿå‘½è¿«ä½¿æˆ‘ä»¬é‡æ–°æ€è€ƒåŠ³åŠ¨åŠ›ä»·å€¼</h3>
<p>èµ·å› æ˜¯æœ‰ä¸€å¤©å‘¨æœ«åšäº† aidp å¹³å°ç¾è§‚åº¦æ ‡æ³¨çš„ä¸€é“é¢˜ï¼Œå¤§æ¦‚æ”¶å…¥ 600 å…ƒï¼Œæˆ‘ä¸ªäººæ˜¯æœ‰ç‚¹æ„Ÿæ…¨ä¸‡åƒï¼Œå°±æ˜¯æ„Ÿè§‰åœ¨å¸®åŠ©æ¨¡å‹æ˜å¢“ç¨‹åºå‘˜ï¼Œæœ€è¿‘ç¾¤å‹è¯»ã€Šé€å¤–å–ã€‹ä¹Ÿæ˜¯ï¼Œæœ€ç»†é¢—ç²’åº¦çš„è·¯çº¿å’Œé€é¤æ–¹å¼æ•°æ®æ¨¡å‹è¿˜å­¦ä¸ä¼šï¼Œå°±é€šè¿‡æœºåˆ¶è®©å¤–å–å‘˜åŠ¨è„‘å­â€œæ¦¨â€å‡ºæ¥æœ€æœ«ç«¯çš„æ€è€ƒ</p>
<p>åœ¨AIå¿«é€Ÿå–ä»£äººç±»åŠ³åŠ¨åŠ›çš„æµªæ½®ä¸­ï¼Œä¸€ä¸ªæ ¸å¿ƒè§„å¾‹é€æ¸æ¸…æ™°ï¼šè¶Šæ˜¯çº¯ç¬¦å·ã€å¯å½¢å¼åŒ–ã€å°é—­è§„åˆ™çš„çŸ¥è¯†å·¥ä½œï¼ˆå¦‚ç¼–ç¨‹ã€æ•°å­¦è¯æ˜ã€æ–‡ä¹¦å¤„ç†ï¼‰ï¼Œè¶Šå®¹æ˜“è¢«å¤§æ¨¡å‹è¿…é€Ÿåƒæ‰ï¼Œå› ä¸ºè¿™äº›é¢†åŸŸæ²¡æœ‰ç‰©ç†é™åˆ¶ï¼ŒAIå¯ä»¥æ— é™è¯•é”™å’Œè¿­ä»£ï¼Œäººç±»ç¨‹åºå‘˜çš„ç»éªŒå¾ˆå¿«å°±ä¼šè¢«â€œå·å¸ˆâ€å¹¶å›ºåŒ–æˆæ›´ä¸¥è‹›çš„ç®—æ³•ï¼Œé™·å…¥è¢«è¿½èµ¶çš„è¢«åŠ¨ã€‚</p>
<p>ç›¸åï¼Œè¶Šæ˜¯ä¾èµ–è‚‰èº«å­˜åœ¨ã€é«˜åº¦æƒ…å¢ƒåŒ–ã€å……æ»¡ç¤¾ä¼šäº’åŠ¨å’Œé•¿å°¾ç¬å˜çš„é•¿å°¾åœºæ™¯ï¼ˆå¦‚å¤–å–æœ€åä¸€å…¬é‡Œã€é¤å…æœåŠ¡ã€åŒ»ç–—æŠ¤ç†ã€å…»è€é™ªä¼´ï¼‰ï¼ŒAIå’Œæœºå™¨äººè¶Šéš¾å½»åº•å–ä»£ã€‚ç°å®ä¸–ç•Œçš„å¤æ‚æ€§ã€åŠ¨æ€æ€§å’Œæƒ…æ„Ÿéœ€æ±‚ï¼Œè®©æœ€ç»†é¢—ç²’åº¦çš„ä¼˜åŒ–æ°¸è¿œå­¦ä¸å®Œâ€”â€”ä»Šå¤©çš„æ–°å°å··ã€æ˜å¤©çš„å®¢äººæƒ…ç»ªã€åå¤©çš„çªå‘çŠ¶å†µï¼Œéƒ½åœ¨ä¸æ–­äº§ç”Ÿæ–°çŸ¥è¯†ã€‚å¹³å°å’Œæœºå™¨äººå†æ€ä¹ˆä»äººç±»èº«ä¸Šâ€œå·å¸ˆâ€ï¼Œä¹Ÿæ€»æœ‰è¿½ä¸ä¸Šçš„åœ°æ–¹ã€‚</p>
<p>å› æ­¤ï¼ŒçœŸæ­£æŠ—AIå–ä»£çš„ï¼Œå¾€å¾€ä¸æ˜¯é«˜è–ªçš„é«˜çº§çŸ¥è¯†å·¥ä½œï¼Œè€Œæ˜¯é‚£äº›çœ‹ä¼¼ä½ç«¯çš„â€œæœåŠ¡ä¸šâ€ã€‚æœåŠ¡å‘˜ã€æŠ¤ç†å‘˜ã€é™ªæŠ¤äººå‘˜ï¼Œè¿™äº›éœ€è¦æ¸©åº¦ã€å…±æƒ…ã€å³æ—¶åº”å˜å’Œèº«ä½“åœ¨åœºçš„å²—ä½ï¼Œå¯èƒ½æˆä¸ºäººç±»åŠ³åŠ¨åŠ›æœ€åçš„å ¡å’ã€‚å½“æœºå™¨äººç»ˆäºèƒ½ç«¯ç¨³ä¸€ç›˜çƒ­æ±¤ã€è¯»æ‡‚å®¢äººçš„çœ¼ç¥ã€å¤„ç†ä¸€åœºå®¶åº­çº çº·æ—¶ï¼Œæˆ–è®¸æ‰ç§°å¾—ä¸Šäººç±»åŠ³åŠ¨åŠ›çš„çœŸæ­£å¤§è§£æ”¾ã€‚è€Œåœ¨é‚£ä¸€åˆ»åˆ°æ¥ä¹‹å‰ï¼ŒæœåŠ¡ä¸šå¾ˆå¯èƒ½æ¯”å†™ä»£ç æ›´æœ‰æœªæ¥â€”â€”å› ä¸ºå®ƒæœ€éš¾è¢«å®Œå…¨ç®—æ³•åŒ–å’Œè‡ªåŠ¨åŒ–ã€‚</p>
<p>è¯´åˆ°åº•ï¼ŒAIæœ€å®¹æ˜“å–ä»£çš„ï¼Œæ˜¯é‚£äº›ä¸éœ€è¦â€œæˆä¸ºäººç±»â€å°±èƒ½å®Œæˆçš„å·¥ä½œï¼›è€Œæœ€é¡½å¼ºå­˜æ´»ä¸‹æ¥çš„ï¼Œå¾€å¾€æ­£æ˜¯é‚£äº›åªæœ‰äººç±»æ‰èƒ½åšå¥½çš„äº‹ã€‚</p>
<h3 data-id="heading-10">ç¤¾åŒºçš„ä¸ªä½“åº”è¯¥ä¹Ÿå°±æ˜¯ç å†œçš„æˆ‘ä»¬åº”è¯¥å¦‚ä½•åº”å¯¹å†²å‡»</h3>
<p>å…¶å®å¾ˆå¤šä¸œè¥¿æ˜¯äº˜å¤ä¸å˜çš„ï¼Œæ‰“ä¸è¿‡å°±ç§¯ææ‹¥æŠ±ï¼Œå¿«é€Ÿæ·±å…¥ã€‚</p>
<ul>
<li>
<p><strong>æ‹¥æŠ±å¿«é€Ÿè½åœ°ï¼š</strong> å¯ä»¥æ·±åº¦å°è¯•ä»ä¸¤å‘¨ä¸€ä¸ªåŸå‹å˜æˆä¸€å‘¨ä¸‰ä¸ªã€‚</p>
</li>
<li>
<p><strong>AI è¾…åŠ© TDDï¼š</strong> è®©å†™æµ‹è¯•ä¸å†æ˜‚è´µã€‚</p>
</li>
<li>
<p><strong>æˆä¸º Product-minded Engineerï¼š</strong> åƒ Claude Code å›¢é˜Ÿé‚£æ ·ï¼Œä¸éœ€è¦ä¸“é—¨çš„ PMï¼Œå·¥ç¨‹å¸ˆåˆ©ç”¨ AI è¡¥é½çŸ­æ¿ï¼Œç›´æ¥å¯¹äº§å“ç»“æœè´Ÿè´£ã€‚</p>
</li>
</ul>
<h2 data-id="heading-11">Captain çš„ 2025-è°ˆè°ˆæˆ‘ä¸ªäººçš„å·¥ä½œå’Œç”Ÿæ´»</h2>
<h3 data-id="heading-12">æˆ‘å»å¹´ç«‹è¿‡çš„ Flag</h3>
<ul>
<li>
<p>å‡è‚¥ï¼šå¤±è´¥ï¼Œæˆ’çƒŸä¸€å¹´è¯ä»¶æ•´ï¼Œæ„Ÿè§‰è‡³å°‘è‚¥äº† 10 å…¬æ–¤ï¼Œ</p>
</li>
<li>
<p>æˆ’çƒŸï¼šæˆåŠŸï½è¿™ç‚¹ç¡®å®åšæŒäº†ä¸€å¹´ï¼Œ</p>
</li>
<li>
<p>è®¡åˆ’å‡º 3 æœ¬ä¹¦
å®é™…åªå‡ºç‰ˆäº† 2 æœ¬ï¼ŒåŠæ ¼åˆ†ï¼Œä½†æ˜¯ç¬¬äºŒæœ¬ä¹¦æœ‰å¹¸å’Œè‹±å›½å‡ºç‰ˆç¤¾åˆä½œäº†ï¼Œä¹Ÿç®—å‡ºäº†ä¸‰æœ¬</p>
<ul>
<li>ç¬¬ä¸€ä¸ªVibe ç¼–ç¨‹ æ¢ç´¢ AI æ—¶ä»£ç¼–ç¨‹æ–°èŒƒå¼
<ul>
<li>å…ˆè¯´ä¸‹å†™è¿™æœ¬ä¹¦çš„åˆè¡·æ˜¯å› ä¸ºä»ä¸šåŸå› è§‚å¯Ÿåˆ°äº† AI ç¼–ç¨‹çš„ä¼šå¯¹å„ä½ç¨‹åºå‘˜ä»¬äº§ç”Ÿå·¨å¤§çš„å†²å‡»ï¼Œå¸Œæœ›å¤§å®¶èƒ½çœ‹åˆ°è¿™ä¸ªå˜åŒ–ï¼Œä½†æ˜¯ç”±äºå››ä½ä½œè€…å¤§å®¶çš„è®¤çŸ¥å’ŒæŠ•å…¥åº¦éƒ½ä¸ä¸€æ ·ï¼Œæˆ‘å¯¹è¿™æœ¬ä¹¦æ•´ä½“æ˜¯ä¸æ»¡æ„çš„ï¼Œä¸»è¦è¿˜æ˜¯æŠ€æœ¯äººçœ‹äº†æ‘‡å¤´ï¼ŒéæŠ€æœ¯äººçœ‹ä¸æ‡‚ï¼Œç•¥æ˜¾é¸¡è‚‹ã€‚</li>
<li/>
</ul>
</li>
</ul>
</li>
</ul>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6af8d155de6541c4897308f50a910cea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767693325&amp;x-signature=3%2FX4xInk80ru%2Bf6A7wstgnfAq60%3D" alt="ea39a75caf710d13bbec1bc8bbd18849.jpg" width="30%" loading="lazy"/>
<ul>
<li>
<p>ç¬¬äºŒæœ¬æ˜¯äººäººéƒ½æ˜¯ AI ç¨‹åºå‘˜-TRAE +Cursor ä» 0 åˆ° 1 å…¨æ ˆå®æˆ˜
è¿™æœ¬ä¹¦ä¹Ÿæ˜¯ä¸€æ³¢ä¸‰æŠ˜ï½ä½†æ˜¯æ‰¾äº†å¾ˆå¤šæœ‹å‹çœ‹äº†ï¼Œè§‰å¾—å¾ˆæœ‰ä¿¡å¿ƒã€‚æœŸå¾…ä¸Šå¸‚è¡¨ç°</p>
  <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/380d8c94704844fb875488fcb6b03d99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767693325&amp;x-signature=KyQSDtcKsw4mSFzNZMWUI5BY1Zw%3D" alt="d0a500e114a75960fbec995d152b3878.jpg" width="30%" loading="lazy"/>
</li>
<li>
<p>æµªè¯´æ’­å®¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flangshuo0.podcast.xyz" target="_blank" title="https://langshuo0.podcast.xyz" ref="nofollow noopener noreferrer">langshuo0.podcast.xyz</a> æ²¡æœ‰æ–­æ›´ï½ï½ï½</p>
<ul>
<li>å…¨ç½‘ 4000 ç²‰ï¼Œç´¯è®¡ 20w æ’­æ”¾</li>
<li>æœ€è¿‘å½•åˆ¶çš„ä¸¤æœŸçš„æ’­å®¢æ¨èå¬ä¸€ä¸‹
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.xiaoyuzhoufm.com%2Fepisode%2F69376f77238f302e4b281483%3Fs%3DeyJ1IjoiNWYzYzhhYjdlMGY1ZTcyM2JiMDVjMDdlIn0%253D" target="_blank" title="https://www.xiaoyuzhoufm.com/episode/69376f77238f302e4b281483?s=eyJ1IjoiNWYzYzhhYjdlMGY1ZTcyM2JiMDVjMDdlIn0%3D" ref="nofollow noopener noreferrer">èŠèŠ AI ç¼–ç¨‹çš„ç°çŠ¶å’Œæœªæ¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.xiaoyuzhoufm.com%2Fepisode%2F694b33d77c91834b9fc14a95%3Fs%3DeyJ1IjoiNWYzYzhhYjdlMGY1ZTcyM2JiMDVjMDdlIn0%253D" target="_blank" title="https://www.xiaoyuzhoufm.com/episode/694b33d77c91834b9fc14a95?s=eyJ1IjoiNWYzYzhhYjdlMGY1ZTcyM2JiMDVjMDdlIn0%3D" ref="nofollow noopener noreferrer">æµªè¯´å¹´ç»ˆç›˜ç‚¹-AI ç¼–ç¨‹è¿™ä¸€å¹´ï¼šæ˜¯é™ç»´æ‰“å‡»ï¼Ÿè¿˜æ˜¯èµ›åšåƒåœ¾çš„ç‹‚æ¬¢ï¼Ÿ</a>
<ul>
<li>2026å¹´ç»ˆç›˜ç‚¹ã€‚é‚£å¤©æ™šä¸Šå‘å¸ƒæ’­å®¢ï¼Œå‡†å¤‡ç´ æå¬äº†è‡ªå·±çš„æ’­å®¢ï¼Œæ„Ÿè§‰å¾ˆå¥‡æ€ªä¹Ÿå¾ˆæœ‰è¶£ï¼Œæˆ‘ä»å¤´åˆ°å°¾å¤´ä¸€æ¬¡å¬äº†è‡ªå·± 2h çš„æ’­å®¢ï¼Œå®é™…è¿™æœŸæ’­å®¢å½•åˆ¶æ—¶å€™æœ‰å¾ˆå¤šæ‚éŸ³çš„[ç ´æ¶•ä¸ºç¬‘]ã€‚
ç‹¼å” æ˜¯ AI ç¼–ç¨‹ä¿å®ˆæ´¾ï¼Œä¸”å¸¦ç€å¯¹ AI ç¼–ç¨‹çš„æ— é™å˜²è®½
è¢æ»šæ»š  è§‚ç‚¹å°–é”ï¼Œè®¨åŒ AI å‘³çš„äº§ç‰©
folyd 26 å¹´ç›®æ ‡ 1M ARR
williemJiangå¤å…¸æ´¾ï¼Œä¹Ÿå¼€å§‹ç”¨ AI ç¼–ç¨‹å»ç»´æŠ¤å¼€æºé¡¹ç›®ã€‚
ä»Šå¹´æ€»ç»“æ˜¯æœ‰è¶£çš„ä¸€æœŸï¼Œå¸Œæœ›å¤§å®¶æœ‰æ‰€æ”¶è·</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-13">å·¥ä½œä¸Šç¤¾åŒºçš„å˜åŒ–</h3>
<ul>
<li>ç»“åˆä»Šå¹´çš„çƒ­ç‚¹åšäº†ï¼šaicoding.juejin.cn ï¼Œç§ç§åŸå› ï¼Œæ²¡æœ‰åšå¥½ï¼Œè¿™ä¹Ÿè®©æˆ‘é‡æ–°å®¡è§†ä¼ ç»ŸæŠ€æœ¯ç¤¾åŒºçš„ä»·å€¼ã€‚</li>
<li>ä¸»è¦å·¥ä½œä¸­å¿ƒæ”¾åœ¨ TRAE ä¸Š</li>
<li>å»äº†ä¸Šæµ·ã€æ­å·ã€å¹¿å·ã€æ·±åœ³ã€æˆéƒ½ã€é‡åº†è·‘äº†ä¸€åœˆï¼Œç»„ç»‡äº†å¾ˆå¤šçº¿ä¸‹æ´»åŠ¨</li>
<li>ç¬¬ä¸€æ¬¡çœŸæ­£æ„ä¹‰ä¸Šçš„è·¨å›½å»åˆ°ä¸œäº¬ç»„ç»‡äº†ä¸€æ¬¡æ´»åŠ¨</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8403237079c14e7eb3df344e463ad11d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767693325&amp;x-signature=7xRq4ulsqil4mFFew%2BWTKgf%2BSaA%3D" alt="31f4b0a02f9bf35f5004fdb8c5108c50.jpg" loading="lazy"/></p>
<blockquote>
<p><strong>è¿™äº›çº¿ä¸‹é¢å¯¹é¢çš„ç¢°æ’ç»™æˆ‘çš„ä½“ä¼šæ˜¯ï¼š</strong> ä»£ç å¯ä»¥ç”± AI ç”Ÿæˆï¼Œä½†ä¿¡ä»»ã€æ¿€æƒ…å’Œçµæ„Ÿçš„ç¢°æ’ï¼Œä¾ç„¶åªå‘ç”Ÿåœ¨äººä¸äººé¢å¯¹é¢çš„æ—¶åˆ»ã€‚</p>
</blockquote>
<h3 data-id="heading-14">26 å¹´çš„ ä¸ªäººflag</h3>
<ul>
<li>å‡è‚¥ï¼Œå¸Œæœ›ç˜¦å›é«˜ä¸­æ—¶ä»£</li>
<li>æœ‰ä¸ªå¨ƒå¨ƒ</li>
<li>åšä¸€äº›é‡è¦å†³ç­–</li>
<li>ä¹°ä¸ªæ‘©æ‰˜è½¦å¯ä»¥æ‘©æ—…</li>
<li>æ·±åº¦ä½¿ç”¨ å’Œæ‹¥æŠ± AI</li>
<li>åšæŒå½•æ’­å®¢</li>
<li>è®¸æ„¿ç¾å›½ç­¾è¯å’Œå·´è¥¿ç­¾è¯é¡ºåˆ©ä¸‹æ¥ï¼Œå¯ä»¥èµ°å‡ºäºšæ´²ï½ï½ï½</li>
<li>å¸®åŠ©æ›´å¤šäººäº†è§£ AI ç¼–ç¨‹</li>
</ul>
<p>æˆ‘æ˜¯ Captainï¼Œâ€œ25å¹´å¤ªæ¼«é•¿ã€å¤ªç–²æƒ«äº†ï¼Œä½ å¯ä»¥å¼€å¯æ–°ç”Ÿæ´»äº†ã€‚â€</p>
<p>æŠ€æœ¯æ˜¯ä¸€ç›´åœ¨å˜ï¼Œå·¥å…·ä¹Ÿåœ¨å˜ï¼Œä½†åšå†³å®šçš„ä¾ç„¶æ˜¯äººã€‚ AI è®©æ‰§è¡Œå˜å¾—æå…¶å»‰ä»·ï¼Œè¿™å°±æ„å‘³ç€ **â€œå†³å®šåšä»€ä¹ˆâ€**å˜å¾—å‰æ‰€æœªæœ‰çš„æ˜‚è´µã€‚</p>
<p>è¿™é‡Œä¹Ÿåˆ†äº«ä¸€ä¸‹æœ€è¿‘ youtube çˆ†ç«ä¸­å¹´ç¨‹åºå‘˜çš„è§†é¢‘ï¼Œä¸€åœºå…³äºé‡‘é’±ã€æ—¶é—´ä¸ç”Ÿå‘½æ„ä¹‰çš„æ·±åˆ»å¤ç›˜ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyoutu.be%2FVeMA9WGKxOg%3Fsi%3Dxx5AAOuJLy87ePeV" target="_blank" title="https://youtu.be/VeMA9WGKxOg?si=xx5AAOuJLy87ePeV" ref="nofollow noopener noreferrer">youtu.be/VeMA9WGKxOgâ€¦</a></p>
<p>ä»å°‘å¹´æ—¶ä»£æŠ±ç€O'ReillyæŠ€æœ¯ä¹¦ç‹‚å•ƒï¼Œåˆ°å¦‚ä»Šæ‰‹æ¡ä¸“åˆ©ã€æ‹¿ç€å¤§å‚å¤©ä»·è‚¡ç¥¨çš„æŠ€æœ¯é«˜ç®¡ï¼Œè¿™ä½40å¤šå²çš„å¤§å“¥å›é¡¾äº†è‡ªå·±ç§‘æŠ€åœˆæ‘¸çˆ¬æ»šæ‰“çš„25å¹´ã€‚å…‰é²œäº®ä¸½çš„è¡¨é¢ä¸‹ï¼Œæ˜¯æ®‹é…·çš„ç°å®ï¼šå³ä½¿åšåˆ°æ¶æ„å¸ˆï¼Œä¹Ÿå‘ç°è‡ªå·±ä¸è¿‡åœ¨é‡å¤é€ è½®å­ï¼Œä»£ç å¹¶æœªçœŸæ­£è®©ä¸–ç•Œå˜å¥½ã€‚ä»–äº²çœ¼ç›®ç¹æ‰åæ¨ªæº¢çš„åŒäº‹å› è¿‡åŠ³ç¦»ä¸–ï¼Œå´ä»…ä¸€å‘¨åï¼Œå…¬å¸é‡Œå°±ä»¿ä½›è¿™ä¸ªäººä»æœªå­˜åœ¨è¿‡ã€‚æ¯å¤©åªå‰©1å°æ—¶é™ªä¼´å­©å­ï¼Œé”™è¿‡äº†å¸¦ä»–ä»¬éœ²è¥ã€é’“é±¼çš„å®è´µæ—¶å…‰ã€‚å¾—ç›Šäºæ—©å¹´å¯¹è´¢å¯Œçš„è§‰é†’ï¼Œåœ¨æœ€åä¸€è½®å¤§è£å‘˜ä¸­ï¼Œä»–åšå‡ºä¸€ä¸ªå‹‡æ•¢å†³å®šï¼šä¸ºä¿ä½ç»„é‡Œå¹´è½»äººçš„é¥­ç¢—ï¼Œä»–ä¸»åŠ¨æŠŠè‡ªå·±æ”¾è¿›è£å‘˜åå•ã€‚</p>
<p>è¯„è®ºåŒºå¾ˆæœ‰è¶£ï¼Œå¤§å®¶è¯´è¿™æ‰æ˜¯YouTubeå­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<p>â€œå”¯ä¸€ä¼šè®°å¾—ä½ åŠ ç­åˆ°æ·±å¤œçš„äººï¼Œåªæœ‰ä½ çš„å­©å­å’Œå®¶äººã€‚ç§‘æŠ€è¡Œä¸šæ—©å·²ç¼ºä¹å¿ è¯šä¸ä½“é¢ã€‚â€</p>
<p>â€œå¦‚æœä½ æ­»äº†ï¼Œä½ çš„èŒä½ä¼šåœ¨è®£å‘ŠåˆŠç™»å‰å°±è¢«é‡æ–°æ‹›è˜ã€‚â€</p>
<p>â€œå…„å¼Ÿçœ‹èµ·æ¥çœŸçš„å› ä¸ºè¢«è£å‘˜è€Œå¼€å¿ƒã€‚ä¹Ÿè®¸è¿™å…¶å®æ˜¯å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦ã€‚â€</p>
<p>â€œè¯·å¤šå‘ä¸€äº›è§†é¢‘ã€‚ç¤¾äº¤åª’ä½“ä¸Šå……æ–¥ç€åƒåœ¾å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦æœ‰çœŸå®ç”Ÿæ´»ç»éªŒçš„çœŸäººåˆ†äº«æ•…äº‹ã€‚â€</p>
<p>â€œè¢«è£å‘˜æ˜¯æ¯ä¸ªç§‘æŠ€ä»ä¸šè€…çš„å®¿å‘½ã€‚ä½ å¿…é¡»æˆä¸ºåˆä¼™äººâ€”â€”è¦ä¹ˆåœ¨å½“å‰å…¬å¸ï¼Œè¦ä¹ˆåˆ›åŠè‡ªå·±çš„å…¬å¸ã€‚â€</p>
<p>â€œ25å¹´å¤ªæ¼«é•¿ã€å¤ªç–²æƒ«äº†ï¼Œä½ å¯ä»¥å¼€å¯æ–°ç”Ÿæ´»äº†ã€‚â€</p>
<p>2026 å¸Œæœ›ç»§ç»­å’Œå¤§å®¶åŒåœ¨ï¼Œæ¬¢è¿å¤§å®¶æŒç»­æ‰¾æˆ‘äº¤æµèŠå¤©ï¼Œä¸ªäººå¾®ä¿¡ï¼š229199157ï¼Œæ¨ç‰¹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FXCaptaincc" target="_blank" title="https://x.com/XCaptaincc" ref="nofollow noopener noreferrer">x.com/XCaptaincc</a></p>
<p>çœ‹åˆ°ç»“å°¾çš„åˆ«æ˜å‹ä»¬åˆ«åˆ’èµ°ï¼Œè¯·ç•™ä¸‹ä½ çš„æ€è€ƒå’Œæ„Ÿè§¦ï¼Œæˆ‘ä¼šå¡«é€‰ 3-5 äººè¯„è®ºé€å‡ºçš„æˆ‘çš„ä¸ªäººç­¾åä¹¦ä¸€æœ¬ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ¶ä½œæ—©é¤ï¼Œæˆ‘å¼‚æ­¥ç¼–ç¨‹]]></title>    <link>https://juejin.cn/post/7589475923696336915</link>    <guid>https://juejin.cn/post/7589475923696336915</guid>    <pubDate>2025-12-30T08:03:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589475923696336915" data-draft-id="7589212818807242815" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ¶ä½œæ—©é¤ï¼Œæˆ‘å¼‚æ­¥ç¼–ç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T08:03:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ƒå®ä¸‰å”"/> <meta itemprop="url" content="https://juejin.cn/user/2508420375913500"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ¶ä½œæ—©é¤ï¼Œæˆ‘å¼‚æ­¥ç¼–ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2508420375913500/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ƒå®ä¸‰å”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:03:33.000Z" title="Tue Dec 30 2025 08:03:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åœºæ™¯ï¼šå¿™ç¢Œçš„æ—©æ™¨åˆ¶ä½œæ—©é¤</h2>
<p>æƒ³è±¡ä¸€ä¸‹å·¥ä½œæ—¥çš„æ—©æ™¨ï¼Œä½ éœ€è¦å‡†å¤‡ä¸€ä»½å®Œæ•´çš„æ—©é¤ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè¿‡ç¨‹å¦‚ä½•ç”¨åŒæ­¥å’Œå¼‚æ­¥çš„æ–¹å¼æ¥æ‰§è¡Œï¼š</p>
<p>csharp</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Diagnostics;
<span class="hljs-keyword">using</span> System.Threading.Tasks;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">BreakfastAsyncExample</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ—©é¤é£Ÿæå’Œå·¥å…·</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Kitchen</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> CoffeeReady { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> ToastReady { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> EggsReady { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> JuiceReady { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    }

    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"=== æ—©é¤åˆ¶ä½œæ¨¡æ‹Ÿ ===\n"</span>);
            
            <span class="hljs-comment">// æ¼”ç¤ºåŒæ­¥åˆ¶ä½œæ—©é¤ï¼ˆä½æ•ˆæ–¹å¼ï¼‰</span>
            Console.WriteLine(<span class="hljs-string">"1. åŒæ­¥åˆ¶ä½œæ—©é¤ï¼ˆä½æ•ˆæ–¹å¼ï¼‰ï¼š"</span>);
            <span class="hljs-keyword">await</span> MakeBreakfastSynchronously();
            
            Console.WriteLine(<span class="hljs-string">"\n"</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>(<span class="hljs-string">'-'</span>, <span class="hljs-number">50</span>) + <span class="hljs-string">"\n"</span>);
            
            <span class="hljs-comment">// æ¼”ç¤ºå¼‚æ­¥åˆ¶ä½œæ—©é¤ï¼ˆé«˜æ•ˆæ–¹å¼ï¼‰</span>
            Console.WriteLine(<span class="hljs-string">"2. å¼‚æ­¥åˆ¶ä½œæ—©é¤ï¼ˆé«˜æ•ˆæ–¹å¼ï¼‰ï¼š"</span>);
            <span class="hljs-keyword">await</span> MakeBreakfastAsynchronously();
            
            Console.WriteLine(<span class="hljs-string">"\n"</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>(<span class="hljs-string">'-'</span>, <span class="hljs-number">50</span>) + <span class="hljs-string">"\n"</span>);
            
            <span class="hljs-comment">// æ¼”ç¤ºæ›´é«˜çº§çš„å¼‚æ­¥æ¨¡å¼</span>
            Console.WriteLine(<span class="hljs-string">"3. å¹¶è¡Œå¼‚æ­¥åˆ¶ä½œæ—©é¤ï¼ˆæœ€ä¼˜æ–¹å¼ï¼‰ï¼š"</span>);
            <span class="hljs-keyword">await</span> MakeBreakfastParallelAsync();
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> åŒæ­¥æ–¹å¼åˆ¶ä½œæ—©é¤ - ä½æ•ˆä½†ç®€å•</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">MakeBreakfastSynchronously</span>()</span>
        {
            <span class="hljs-keyword">var</span> stopwatch = Stopwatch.StartNew();
            <span class="hljs-keyword">var</span> kitchen = <span class="hljs-keyword">new</span> Kitchen();
            
            Console.WriteLine(<span class="hljs-string">"æ—©ä¸Š7:00 - å¼€å§‹åˆ¶ä½œæ—©é¤"</span>);
            
            <span class="hljs-comment">// åŒæ­¥æ–¹å¼ï¼šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°åš</span>
            <span class="hljs-keyword">await</span> MakeCoffeeAsync(kitchen);        <span class="hljs-comment">// ç…®å’–å•¡éœ€è¦3åˆ†é’Ÿ</span>
            <span class="hljs-keyword">await</span> MakeToastAsync(kitchen);         <span class="hljs-comment">// çƒ¤é¢åŒ…éœ€è¦2åˆ†é’Ÿ</span>
            <span class="hljs-keyword">await</span> FryEggsAsync(kitchen);           <span class="hljs-comment">// ç…é¸¡è›‹éœ€è¦4åˆ†é’Ÿ</span>
            <span class="hljs-keyword">await</span> PourJuiceAsync(kitchen);         <span class="hljs-comment">// å€’æœæ±éœ€è¦1åˆ†é’Ÿ</span>
            
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"æ—©ä¸Š7:10 - æ—©é¤å®Œæˆï¼æ€»å…±è€—æ—¶: <span class="hljs-subst">{stopwatch.Elapsed.TotalSeconds:F1}</span>ç§’"</span>);
            ServeBreakfast(kitchen);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¼‚æ­¥æ–¹å¼åˆ¶ä½œæ—©é¤ - é«˜æ•ˆä½†ä¸å®Œç¾</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">MakeBreakfastAsynchronously</span>()</span>
        {
            <span class="hljs-keyword">var</span> stopwatch = Stopwatch.StartNew();
            <span class="hljs-keyword">var</span> kitchen = <span class="hljs-keyword">new</span> Kitchen();
            
            Console.WriteLine(<span class="hljs-string">"æ—©ä¸Š7:00 - å¼€å§‹åˆ¶ä½œæ—©é¤"</span>);
            
            <span class="hljs-comment">// å¼‚æ­¥æ–¹å¼ï¼šå¼€å§‹æ‰€æœ‰ä»»åŠ¡ï¼Œç„¶åç­‰å¾…</span>
            <span class="hljs-keyword">var</span> coffeeTask = MakeCoffeeAsync(kitchen);        <span class="hljs-comment">// 3åˆ†é’Ÿ</span>
            <span class="hljs-keyword">var</span> toastTask = MakeToastAsync(kitchen);          <span class="hljs-comment">// 2åˆ†é’Ÿ</span>
            <span class="hljs-keyword">var</span> eggsTask = FryEggsAsync(kitchen);             <span class="hljs-comment">// 4åˆ†é’Ÿ</span>
            <span class="hljs-keyword">var</span> juiceTask = PourJuiceAsync(kitchen);          <span class="hljs-comment">// 1åˆ†é’Ÿ</span>
            
            <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
            <span class="hljs-keyword">await</span> coffeeTask;
            <span class="hljs-keyword">await</span> toastTask;
            <span class="hljs-keyword">await</span> eggsTask;
            <span class="hljs-keyword">await</span> juiceTask;
            
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"æ—©ä¸Š7:04 - æ—©é¤å®Œæˆï¼æ€»å…±è€—æ—¶: <span class="hljs-subst">{stopwatch.Elapsed.TotalSeconds:F1}</span>ç§’"</span>);
            ServeBreakfast(kitchen);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¹¶è¡Œå¼‚æ­¥åˆ¶ä½œæ—©é¤ - æœ€ä¼˜æ–¹å¼</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">MakeBreakfastParallelAsync</span>()</span>
        {
            <span class="hljs-keyword">var</span> stopwatch = Stopwatch.StartNew();
            <span class="hljs-keyword">var</span> kitchen = <span class="hljs-keyword">new</span> Kitchen();
            
            Console.WriteLine(<span class="hljs-string">"æ—©ä¸Š7:00 - å¼€å§‹åˆ¶ä½œæ—©é¤"</span>);
            
            <span class="hljs-comment">// ä½¿ç”¨Task.WhenAllå¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡</span>
            <span class="hljs-keyword">await</span> Task.WhenAll(
                MakeCoffeeAsync(kitchen),        <span class="hljs-comment">// 3åˆ†é’Ÿ</span>
                MakeToastAsync(kitchen),         <span class="hljs-comment">// 2åˆ†é’Ÿ  </span>
                FryEggsAsync(kitchen),           <span class="hljs-comment">// 4åˆ†é’Ÿ</span>
                PourJuiceAsync(kitchen)          <span class="hljs-comment">// 1åˆ†é’Ÿ</span>
            );
            
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"æ—©ä¸Š7:04 - æ—©é¤å®Œæˆï¼æ€»å…±è€—æ—¶: <span class="hljs-subst">{stopwatch.Elapsed.TotalSeconds:F1}</span>ç§’"</span>);
            ServeBreakfast(kitchen);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¼‚æ­¥ç…®å’–å•¡ - æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">MakeCoffeeAsync</span>(<span class="hljs-params">Kitchen kitchen</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">$"  å¼€å§‹ç…®å’–å•¡ï¼ˆéœ€è¦3ç§’ï¼‰..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">3000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ3ç§’çš„ç…®å’–å•¡æ—¶é—´</span>
            
            kitchen.CoffeeReady = <span class="hljs-literal">true</span>;
            Console.WriteLine(<span class="hljs-string">$"  âœ“ å’–å•¡ç…®å¥½äº†ï¼"</span>);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¼‚æ­¥çƒ¤é¢åŒ… - æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">MakeToastAsync</span>(<span class="hljs-params">Kitchen kitchen</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">$"  å¼€å§‹çƒ¤é¢åŒ…ï¼ˆéœ€è¦2ç§’ï¼‰..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">2000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ2ç§’çš„çƒ¤é¢åŒ…æ—¶é—´</span>
            
            kitchen.ToastReady = <span class="hljs-literal">true</span>;
            Console.WriteLine(<span class="hljs-string">$"  âœ“ é¢åŒ…çƒ¤å¥½äº†ï¼"</span>);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¼‚æ­¥ç…é¸¡è›‹ - æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">FryEggsAsync</span>(<span class="hljs-params">Kitchen kitchen</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">$"  å¼€å§‹ç…é¸¡è›‹ï¼ˆéœ€è¦4ç§’ï¼‰..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">4000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ4ç§’çš„ç…é¸¡è›‹æ—¶é—´</span>
            
            kitchen.EggsReady = <span class="hljs-literal">true</span>;
            Console.WriteLine(<span class="hljs-string">$"  âœ“ é¸¡è›‹ç…å¥½äº†ï¼"</span>);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å¼‚æ­¥å€’æœæ± - æ¨¡æ‹Ÿç®€å•æ“ä½œ</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">PourJuiceAsync</span>(<span class="hljs-params">Kitchen kitchen</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">$"  å¼€å§‹å€’æœæ±ï¼ˆéœ€è¦1ç§’ï¼‰..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">1000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ1ç§’çš„å€’æœæ±æ—¶é—´</span>
            
            kitchen.JuiceReady = <span class="hljs-literal">true</span>;
            Console.WriteLine(<span class="hljs-string">$"  âœ“ æœæ±å€’å¥½äº†ï¼"</span>);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> ä¸Šèœ</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ServeBreakfast</span>(<span class="hljs-params">Kitchen kitchen</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"\n  æ—©é¤ä¸Šæ¡Œï¼š"</span>);
            <span class="hljs-keyword">if</span> (kitchen.CoffeeReady) Console.WriteLine(<span class="hljs-string">"  â˜• çƒ­å’–å•¡"</span>);
            <span class="hljs-keyword">if</span> (kitchen.ToastReady) Console.WriteLine(<span class="hljs-string">"  ğŸ çƒ¤é¢åŒ…"</span>);
            <span class="hljs-keyword">if</span> (kitchen.EggsReady) Console.WriteLine(<span class="hljs-string">"  ğŸ³ ç…é¸¡è›‹"</span>);
            <span class="hljs-keyword">if</span> (kitchen.JuiceReady) Console.WriteLine(<span class="hljs-string">"  ğŸ¥¤ æ©™æ±"</span>);
        }
    }
}
</code></pre>
<h2 data-id="heading-1">æ›´æ·±å…¥çš„ç”Ÿæ´»ä¾‹å­ï¼šæ—©ä¸Šçš„å¤šé‡ä»»åŠ¡</h2>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´è´´è¿‘ç”Ÿæ´»çš„å¤æ‚ä¾‹å­ï¼š</p>
<p>csharp</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">MorningRoutineExample</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MorningPerson</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsShowered { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsDressed { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> HasEaten { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> EmailResult Emails { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> HasNews { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EmailResult</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Count { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> List&lt;<span class="hljs-built_in">string</span>&gt; ImportantEmails { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    }
    
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"ğŸŒ… é«˜æ•ˆçš„æ—©æ™¨ï¼šå¼‚æ­¥ç¼–ç¨‹çš„æ—¥å¸¸åº”ç”¨\n"</span>);
            
            <span class="hljs-keyword">await</span> DemonstrateMorningRoutine();
            
            Console.WriteLine(<span class="hljs-string">"\n"</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>(<span class="hljs-string">'='</span>, <span class="hljs-number">60</span>) + <span class="hljs-string">"\n"</span>);
            
            <span class="hljs-keyword">await</span> DemonstrateRealWorldAsyncPatterns();
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> æ¼”ç¤ºæ—©æ™¨æ—¥å¸¸çš„å¼‚æ­¥æ¨¡å¼</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DemonstrateMorningRoutine</span>()</span>
        {
            <span class="hljs-keyword">var</span> person = <span class="hljs-keyword">new</span> MorningPerson();
            <span class="hljs-keyword">var</span> morningTasks = <span class="hljs-keyword">new</span> List&lt;Task&gt;();
            
            Console.WriteLine(<span class="hljs-string">"ã€åœºæ™¯1ï¼šæ™®é€šäººçš„æ—©æ™¨ã€‘"</span>);
            Console.WriteLine(<span class="hljs-string">"7:00 é—¹é’Ÿå“äº†ï¼Œå¼€å§‹æ—©æ™¨æ—¥å¸¸...\n"</span>);
            
            <span class="hljs-comment">// 1. å¹¶è¡Œå¼€å§‹å¤šä¸ªä»»åŠ¡</span>
            <span class="hljs-keyword">var</span> showerTask = TakeShowerAsync(person);
            <span class="hljs-keyword">var</span> coffeeTask = MakeCoffeeAsync(); <span class="hljs-comment">// è¿™ä¸ªæˆ‘ä»¬ä¸éœ€è¦ç­‰å®ƒå®Œæˆæ‰åšå…¶ä»–äº‹</span>
            
            <span class="hljs-comment">// 2. ç­‰å¾…å¿…é¡»å®Œæˆçš„ä»»åŠ¡ï¼ˆæ´—æ¾¡ï¼‰</span>
            <span class="hljs-keyword">await</span> showerTask;
            Console.WriteLine(<span class="hljs-string">"  7:10 âœ“ æ´—å®Œæ¾¡äº†\n"</span>);
            
            <span class="hljs-comment">// 3. ç»§ç»­å…¶ä»–å¯ä»¥å¹¶è¡Œçš„ä»»åŠ¡</span>
            <span class="hljs-keyword">var</span> dressTask = GetDressedAsync(person);
            <span class="hljs-keyword">var</span> breakfastTask = HaveBreakfastAsync(person);
            
            <span class="hljs-comment">// 4. åŒæ—¶æ£€æŸ¥æ–°é—»å’Œå¤©æ°”ï¼ˆéå…³é”®ä»»åŠ¡ï¼‰</span>
            <span class="hljs-keyword">var</span> newsTask = CheckNewsAsync(person);
            
            <span class="hljs-comment">// 5. ç­‰å¾…ç©¿è¡£å’Œæ—©é¤å®Œæˆ</span>
            <span class="hljs-keyword">await</span> Task.WhenAll(dressTask, breakfastTask);
            Console.WriteLine(<span class="hljs-string">"  7:20 âœ“ ç©¿å¥½è¡£æœåƒå®Œæ—©é¤\n"</span>);
            
            <span class="hljs-comment">// 6. æ£€æŸ¥å’–å•¡æ˜¯å¦å¥½äº†</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> coffeeTask)
            {
                Console.WriteLine(<span class="hljs-string">"  â˜• å’–å•¡å·²ç»å¥½äº†ï¼Œå¯ä»¥å¸¦ç€è·¯ä¸Šå–\n"</span>);
            }
            
            <span class="hljs-comment">// 7. å¤„ç†æ–°é—»ï¼ˆå¦‚æœæœ‰ï¼‰</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> newsTask)
            {
                Console.WriteLine(<span class="hljs-string">"  ğŸ“° äº†è§£äº†ä»Šå¤©çš„å¤´æ¡æ–°é—»\n"</span>);
            }
            
            Console.WriteLine(<span class="hljs-string">"  7:25 ğŸš— å‡†æ—¶å‡ºé—¨ä¸Šç­ï¼"</span>);
        }
        
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> æ¼”ç¤ºçœŸå®ä¸–ç•Œä¸­çš„å¼‚æ­¥æ¨¡å¼</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DemonstrateRealWorldAsyncPatterns</span>()</span>
        {
            Console.WriteLine(<span class="hljs-string">"ã€åœºæ™¯2ï¼šå·¥ä½œä¸­çš„å¼‚æ­¥ç¼–ç¨‹ã€‘"</span>);
            Console.WriteLine(<span class="hljs-string">"9:00 åˆ°è¾¾åŠå…¬å®¤ï¼Œå¼€å§‹å·¥ä½œ...\n"</span>);
            
            <span class="hljs-keyword">try</span>
            {
                <span class="hljs-comment">// æ¨¡å¼1ï¼šè¶…æ—¶æ§åˆ¶ - ç­‰å¾…å›å¤é‚®ä»¶ï¼Œä½†ä¸è¶…è¿‡5åˆ†é’Ÿ</span>
                Console.WriteLine(<span class="hljs-string">"1. å‘é€é‡è¦é‚®ä»¶å¹¶ç­‰å¾…å›å¤ï¼ˆæœ€å¤šç­‰5åˆ†é’Ÿï¼‰..."</span>);
                <span class="hljs-keyword">var</span> emailReply = <span class="hljs-keyword">await</span> WaitForEmailReplyAsync()
                    .WithTimeout(TimeSpan.FromMinutes(<span class="hljs-number">5</span>));
                
                <span class="hljs-keyword">if</span> (emailReply != <span class="hljs-literal">null</span>)
                {
                    Console.WriteLine(<span class="hljs-string">"   âœ“ æ”¶åˆ°äº†å›å¤"</span>);
                }
                <span class="hljs-keyword">else</span>
                {
                    Console.WriteLine(<span class="hljs-string">"   â±ï¸  è¶…æ—¶äº†ï¼Œç»§ç»­å…¶ä»–å·¥ä½œ"</span>);
                }
                
                <span class="hljs-comment">// æ¨¡å¼2ï¼šå¹¶è¡Œä¸‹è½½å¤šä¸ªæ–‡ä»¶</span>
                Console.WriteLine(<span class="hljs-string">"\n2. åŒæ—¶ä¸‹è½½å¤šä¸ªæ–‡ä»¶..."</span>);
                <span class="hljs-keyword">var</span> fileTasks = <span class="hljs-keyword">new</span> List&lt;Task&lt;<span class="hljs-built_in">string</span>&gt;&gt;
                {
                    DownloadFileAsync(<span class="hljs-string">"å­£åº¦æŠ¥å‘Š.pdf"</span>),
                    DownloadFileAsync(<span class="hljs-string">"å®¢æˆ·æ•°æ®.xlsx"</span>),
                    DownloadFileAsync(<span class="hljs-string">"ä¼šè®®è®°å½•.docx"</span>)
                };
                
                <span class="hljs-comment">// ä½¿ç”¨WhenAny - å“ªä¸ªå…ˆå®Œæˆå°±å…ˆå¤„ç†å“ªä¸ª</span>
                <span class="hljs-keyword">while</span> (fileTasks.Count &gt; <span class="hljs-number">0</span>)
                {
                    <span class="hljs-keyword">var</span> completedTask = <span class="hljs-keyword">await</span> Task.WhenAny(fileTasks);
                    <span class="hljs-keyword">var</span> fileName = <span class="hljs-keyword">await</span> completedTask;
                    Console.WriteLine(<span class="hljs-string">$"   âœ“ å·²ä¸‹è½½: <span class="hljs-subst">{fileName}</span>"</span>);
                    fileTasks.Remove(completedTask);
                }
                
                <span class="hljs-comment">// æ¨¡å¼3ï¼šå–æ¶ˆæ“ä½œ</span>
                Console.WriteLine(<span class="hljs-string">"\n3. å¼€å§‹é•¿æ—¶é—´è®¡ç®—ï¼ˆå¯å–æ¶ˆï¼‰..."</span>);
                <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> cts = <span class="hljs-keyword">new</span> System.Threading.CancellationTokenSource();
                
                <span class="hljs-comment">// è®¾ç½®3ç§’åè‡ªåŠ¨å–æ¶ˆ</span>
                cts.CancelAfter(<span class="hljs-number">3000</span>);
                
                <span class="hljs-keyword">try</span>
                {
                    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> LongRunningCalculationAsync(cts.Token);
                    Console.WriteLine(<span class="hljs-string">$"   âœ“ è®¡ç®—å®Œæˆ: <span class="hljs-subst">{result}</span>"</span>);
                }
                <span class="hljs-keyword">catch</span> (TaskCanceledException)
                {
                    Console.WriteLine(<span class="hljs-string">"   ğŸš« è®¡ç®—è¢«å–æ¶ˆäº†ï¼ˆè¶…è¿‡3ç§’ï¼‰"</span>);
                }
                
                <span class="hljs-comment">// æ¨¡å¼4ï¼šè¿›åº¦æŠ¥å‘Š</span>
                Console.WriteLine(<span class="hljs-string">"\n4. å¤„ç†å¤§é‡æ•°æ®ï¼ˆå¸¦è¿›åº¦æŠ¥å‘Šï¼‰..."</span>);
                <span class="hljs-keyword">var</span> progress = <span class="hljs-keyword">new</span> Progress&lt;<span class="hljs-built_in">int</span>&gt;(percent =&gt;
                {
                    Console.Write(<span class="hljs-string">$"\r   å¤„ç†è¿›åº¦: <span class="hljs-subst">{percent}</span>%  "</span>);
                });
                
                <span class="hljs-keyword">await</span> ProcessLargeDataAsync(progress);
                Console.WriteLine(<span class="hljs-string">"\n   âœ“ æ•°æ®å¤„ç†å®Œæˆ"</span>);
            }
            <span class="hljs-keyword">catch</span> (Exception ex)
            {
                Console.WriteLine(<span class="hljs-string">$"   âŒ å‡ºç°é”™è¯¯: <span class="hljs-subst">{ex.Message}</span>"</span>);
            }
        }
        
        <span class="hljs-meta">#<span class="hljs-keyword">region</span> æ—©æ™¨æ—¥å¸¸æ–¹æ³•</span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">TakeShowerAsync</span>(<span class="hljs-params">MorningPerson person</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"  ğŸš¿ å¼€å§‹æ´—æ¾¡..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">3000</span>); <span class="hljs-comment">// æ´—æ¾¡éœ€è¦3åˆ†é’Ÿ</span>
            person.IsShowered = <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">bool</span>&gt; <span class="hljs-title">MakeCoffeeAsync</span>()</span>
        {
            Console.WriteLine(<span class="hljs-string">"  â˜• å¼€å§‹ç…®å’–å•¡..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">5000</span>); <span class="hljs-comment">// ç…®å’–å•¡éœ€è¦5åˆ†é’Ÿ</span>
            Console.WriteLine(<span class="hljs-string">"  âœ“ å’–å•¡ç…®å¥½äº†"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">GetDressedAsync</span>(<span class="hljs-params">MorningPerson person</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"  ğŸ‘” å¼€å§‹ç©¿è¡£æœ..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">2000</span>); <span class="hljs-comment">// ç©¿è¡£éœ€è¦2åˆ†é’Ÿ</span>
            person.IsDressed = <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HaveBreakfastAsync</span>(<span class="hljs-params">MorningPerson person</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"  ğŸ³ å¼€å§‹åƒæ—©é¤..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">2500</span>); <span class="hljs-comment">// æ—©é¤éœ€è¦2.5åˆ†é’Ÿ</span>
            person.HasEaten = <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">bool</span>&gt; <span class="hljs-title">CheckNewsAsync</span>(<span class="hljs-params">MorningPerson person</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"  ğŸ“± å¿«é€Ÿæµè§ˆæ–°é—»..."</span>);
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">1500</span>); <span class="hljs-comment">// çœ‹æ–°é—»éœ€è¦1.5åˆ†é’Ÿ</span>
            person.HasNews = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-meta">#<span class="hljs-keyword">endregion</span></span>
        
        <span class="hljs-meta">#<span class="hljs-keyword">region</span> å·¥ä½œåœºæ™¯æ–¹æ³•</span>
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">WaitForEmailReplyAsync</span>()</span>
        {
            <span class="hljs-comment">// æ¨¡æ‹Ÿç­‰å¾…é‚®ä»¶å›å¤</span>
            <span class="hljs-keyword">var</span> random = <span class="hljs-keyword">new</span> Random();
            <span class="hljs-keyword">var</span> waitTime = random.Next(<span class="hljs-number">1000</span>, <span class="hljs-number">10000</span>); <span class="hljs-comment">// 1-10ç§’</span>
            
            <span class="hljs-keyword">await</span> Task.Delay(waitTime);
            
            <span class="hljs-keyword">if</span> (waitTime &lt; <span class="hljs-number">5000</span>) <span class="hljs-comment">// 5ç§’å†…å›å¤</span>
                <span class="hljs-keyword">return</span> <span class="hljs-string">"å®¢æˆ·å›å¤äº†é‚®ä»¶"</span>;
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ¨¡æ‹Ÿè¶…æ—¶æ— å›å¤</span>
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">DownloadFileAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> fileName</span>)</span>
        {
            <span class="hljs-keyword">var</span> random = <span class="hljs-keyword">new</span> Random();
            <span class="hljs-keyword">var</span> downloadTime = random.Next(<span class="hljs-number">1000</span>, <span class="hljs-number">5000</span>); <span class="hljs-comment">// 1-5ç§’</span>
            
            <span class="hljs-keyword">await</span> Task.Delay(downloadTime);
            <span class="hljs-keyword">return</span> fileName;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-built_in">int</span>&gt; <span class="hljs-title">LongRunningCalculationAsync</span>(<span class="hljs-params">
            System.Threading.CancellationToken cancellationToken</span>)</span>
        {
            <span class="hljs-comment">// æ¨¡æ‹Ÿé•¿æ—¶é—´è®¡ç®—</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)
            {
                cancellationToken.ThrowIfCancellationRequested();
                <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">100</span>); <span class="hljs-comment">// æ¯æ­¥0.1ç§’</span>
                
                <span class="hljs-comment">// æ¨¡æ‹Ÿè®¡ç®—å·¥ä½œ</span>
                <span class="hljs-keyword">if</span> (i % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>)
                    Console.Write(<span class="hljs-string">$"\r   è®¡ç®—ä¸­... <span class="hljs-subst">{i}</span>%  "</span>);
            }
            
            <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>; <span class="hljs-comment">// ç­”æ¡ˆæ€»æ˜¯42</span>
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessLargeDataAsync</span>(<span class="hljs-params">IProgress&lt;<span class="hljs-built_in">int</span>&gt; progress</span>)</span>
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">100</span>; i += <span class="hljs-number">10</span>)
            {
                <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">200</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿå¤„ç†æ—¶é—´</span>
                progress?.Report(i);
            }
        }
        <span class="hljs-meta">#<span class="hljs-keyword">endregion</span></span>
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ‰©å±•æ–¹æ³•ï¼šä¸ºTaskæ·»åŠ è¶…æ—¶åŠŸèƒ½</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TaskExtensions</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title">Task</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">WithTimeout</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">
            <span class="hljs-keyword">this</span> Task&lt;T&gt; task, TimeSpan timeout</span>)</span>
        {
            <span class="hljs-keyword">var</span> delayTask = Task.Delay(timeout);
            <span class="hljs-keyword">var</span> completedTask = <span class="hljs-keyword">await</span> Task.WhenAny(task, delayTask);
            
            <span class="hljs-keyword">if</span> (completedTask == delayTask)
            {
                <span class="hljs-comment">// è¶…æ—¶äº†</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">default</span>;
            }
            
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> task;
        }
    }
}
</code></pre>
<h2 data-id="heading-2">å¼‚æ­¥ç¼–ç¨‹çš„å…³é”®æ¦‚å¿µï¼ˆç”¨æ—©é¤ä¾‹å­è§£é‡Šï¼‰</h2>
<h3 data-id="heading-3">1.Â <strong>åŒæ­¥ vs å¼‚æ­¥</strong></h3>
<ul>
<li><strong>åŒæ­¥</strong>ï¼ˆä½æ•ˆæ—©é¤ï¼‰ï¼šç…®å’–å•¡â†’ç­‰å’–å•¡å¥½â†’çƒ¤é¢åŒ…â†’ç­‰é¢åŒ…å¥½â†’ç…é¸¡è›‹â†’ç­‰é¸¡è›‹å¥½</li>
<li><strong>å¼‚æ­¥</strong>ï¼ˆé«˜æ•ˆæ—©é¤ï¼‰ï¼šå¼€å§‹ç…®å’–å•¡â†’åŒæ—¶å¼€å§‹çƒ¤é¢åŒ…â†’åŒæ—¶å¼€å§‹ç…é¸¡è›‹â†’ç­‰å¾…æ‰€æœ‰å®Œæˆ</li>
</ul>
<h3 data-id="heading-4">2.Â <strong>async/await æ¨¡å¼</strong></h3>
<p>csharp</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// async æ ‡è®°å¼‚æ­¥æ–¹æ³•</span>
<span class="hljs-function">async <span class="hljs-built_in">Task</span> <span class="hljs-title">MakeCoffeeAsync</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// await ç­‰å¾…å¼‚æ­¥æ“ä½œå®Œæˆï¼Œä½†ä¸é˜»å¡çº¿ç¨‹</span>
    await <span class="hljs-built_in">Task</span>.<span class="hljs-built_in">Delay</span>(<span class="hljs-number">3000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿç…®å’–å•¡æ—¶é—´</span>
    <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">WriteLine</span>(<span class="hljs-string">"å’–å•¡å¥½äº†"</span>);
}
</code></pre>
<h3 data-id="heading-5">3.Â <strong>Task.WhenAll() - åŒæ—¶ç­‰å¾…å¤šä¸ªä»»åŠ¡</strong></h3>
<p>csharp</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// å°±åƒåŒæ—¶å¯åŠ¨å’–å•¡æœºã€çƒ¤é¢åŒ…æœºå’Œç…é”…</span>
await Task<span class="hljs-selector-class">.WhenAll</span>(
    MakeCoffeeAsync(),    <span class="hljs-comment">// 3åˆ†é’Ÿ</span>
    <span class="hljs-built_in">MakeToastAsync</span>(),     <span class="hljs-comment">// 2åˆ†é’Ÿ</span>
    <span class="hljs-built_in">FryEggsAsync</span>()        <span class="hljs-comment">// 4åˆ†é’Ÿ</span>
);
<span class="hljs-comment">// æ€»å…±åªéœ€4åˆ†é’Ÿï¼Œè€Œä¸æ˜¯9åˆ†é’Ÿ</span>
</code></pre>
<h3 data-id="heading-6">4.Â <strong>Task.WhenAny() - ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡</strong></h3>
<p>csharp</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å°±åƒçœ‹å“ªä¸ªæ—©é¤éƒ¨åˆ†å…ˆå‡†å¤‡å¥½å°±å…ˆåƒå“ªä¸ª</span>
<span class="hljs-keyword">var</span> firstReady = <span class="hljs-keyword">await</span> Task.WhenAny(
    coffeeTask,
    toastTask,
    eggsTask
);
</code></pre>
<h3 data-id="heading-7">5.Â <strong>å–æ¶ˆæœºåˆ¶ (CancellationToken)</strong></h3>
<p>csharp</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å°±åƒè®¾ç½®ç…®è›‹è®¡æ—¶å™¨ï¼Œæ—¶é—´åˆ°äº†è‡ªåŠ¨å…³ç«</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> cts = <span class="hljs-keyword">new</span> CancellationTokenSource(TimeSpan.FromMinutes(<span class="hljs-number">5</span>));
<span class="hljs-keyword">try</span>
{
    <span class="hljs-keyword">await</span> CookEggsAsync(cts.Token);
}
<span class="hljs-keyword">catch</span> (TaskCanceledException)
{
    Console.WriteLine(<span class="hljs-string">"ç…®è›‹è¶…æ—¶äº†ï¼"</span>);
}
</code></pre>
<h2 data-id="heading-8">ç°å®ç”Ÿæ´»ä¸­çš„å¼‚æ­¥åœºæ™¯</h2>
<ol>
<li>
<p><strong>ç‚¹å¤–å–åº”ç”¨</strong>ï¼š</p>
<ul>
<li>æäº¤è®¢å•ï¼ˆå¼‚æ­¥ï¼‰</li>
<li>ç­‰å¾…é¤å…ç¡®è®¤ï¼ˆåå°ç­‰å¾…ï¼‰</li>
<li>åŒæ—¶ä½ å¯ä»¥ç»§ç»­æµè§ˆå…¶ä»–å†…å®¹ï¼ˆUIä¸å†»ç»“ï¼‰</li>
<li>æ”¶åˆ°æ¨é€é€šçŸ¥ï¼ˆå›è°ƒï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶ä¸‹è½½</strong>ï¼š</p>
<ul>
<li>å¼€å§‹ä¸‹è½½å¤§æ–‡ä»¶ï¼ˆåå°ä»»åŠ¡ï¼‰</li>
<li>æ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆè¿›åº¦æŠ¥å‘Šï¼‰</li>
<li>å…è®¸å–æ¶ˆä¸‹è½½ï¼ˆå–æ¶ˆä»¤ç‰Œï¼‰</li>
<li>ä¸‹è½½å®Œæˆåé€šçŸ¥ï¼ˆä»»åŠ¡å®Œæˆï¼‰</li>
</ul>
</li>
<li>
<p><strong>èŠå¤©åº”ç”¨</strong>ï¼š</p>
<ul>
<li>å‘é€æ¶ˆæ¯ï¼ˆç«‹å³è¿”å›ï¼‰</li>
<li>ç­‰å¾…å¯¹æ–¹å›å¤ï¼ˆå¼‚æ­¥ç­‰å¾…ï¼‰</li>
<li>åŒæ—¶å¯ä»¥å‘é€å…¶ä»–æ¶ˆæ¯ï¼ˆå¹¶å‘ï¼‰</li>
<li>æ”¶åˆ°å›å¤æ—¶æé†’ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰</li>
</ul>
</li>
</ol>
<h2 data-id="heading-9">æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h2>
<ol>
<li><strong>ä¸æµªè´¹ç­‰å¾…æ—¶é—´</strong>ï¼šå°±åƒåœ¨ç­‰å’–å•¡ç…®å¥½çš„æ—¶å€™å»çƒ¤é¢åŒ…</li>
<li><strong>å“åº”æ€§</strong>ï¼šUIä¸ä¼šå†»ç»“ï¼Œç”¨æˆ·å¯ä»¥ç»§ç»­æ“ä½œ</li>
<li><strong>èµ„æºé«˜æ•ˆ</strong>ï¼šä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªä»»åŠ¡</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå¯ä»¥è½»æ¾å¤„ç†å¤§é‡å¹¶å‘æ“ä½œ</li>
</ol>
<p><strong>è®°ä½è¿™ä¸ªæ¯”å–»</strong>ï¼šå¼‚æ­¥ç¼–ç¨‹å°±åƒæ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å¨å¸ˆï¼ŒåŒæ—¶ç…§çœ‹å¤šä¸ªç‚‰ç¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‚‰ç¶ä¸€ä¸ªç‚‰ç¶åœ°é¡ºåºæ“ä½œã€‚è¿™æ ·æ—©é¤ï¼ˆç¨‹åºï¼‰å°±èƒ½æ›´å¿«å‡†å¤‡å¥½ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cookieä¸localStorageã€sessionStorageæ€»ç»“]]></title>    <link>https://juejin.cn/post/7589386961648877603</link>    <guid>https://juejin.cn/post/7589386961648877603</guid>    <pubDate>2025-12-30T08:11:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589386961648877603" data-draft-id="7589466356778336308" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cookieä¸localStorageã€sessionStorageæ€»ç»“"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,HTTPS"/> <meta itemprop="datePublished" content="2025-12-30T08:11:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Crystal328"/> <meta itemprop="url" content="https://juejin.cn/user/2359973194513272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cookieä¸localStorageã€sessionStorageæ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2359973194513272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Crystal328
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:11:05.000Z" title="Tue Dec 30 2025 08:11:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. Cookie</h2>
<ul>
<li>Cookie æ˜¯<strong>æµè§ˆå™¨å­˜å‚¨æ•°æ®</strong>çš„ä¸€ç§æ–¹å¼</li>
<li><strong>å­˜å‚¨åœ¨ç”¨æˆ·æœ¬åœ°</strong>ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Š</li>
<li>å¯ä»¥<strong>éšç€æµè§ˆå™¨æ¯æ¬¡è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ç«¯</strong></li>
</ul>
<h3 data-id="heading-1">1.1 Cookie çš„ç”¨æ³•</h3>
<ul>
<li>åªèƒ½ä¸€ä¸ªä¸€ä¸ªçš„å†™å…¥ï¼Œä¸èƒ½å°†å¤šä¸ª Cookie å†™åœ¨ä¸€èµ·</li>
<li>å†™å…¥ Cookie æ—¶æ˜¯å¯ä»¥åŠ å…¥å¤šä¸ªå±æ€§çš„ï¼Œå±æ€§ä¸å±æ€§ä¹‹é—´æ˜¯éœ€è¦Â <code>;</code>Â ï¼ˆåˆ†å·+ç©ºæ ¼ï¼‰æ¥åˆ†å¼€</li>
</ul>
<blockquote>
<p>åŸç”Ÿçš„ Cookie æ˜¯ä¸èƒ½é€šè¿‡ç‰¹å®šçš„åç§°æ¥è¯»å–ç‰¹å®šçš„å€¼ï¼Œåªèƒ½ä¸€æ¬¡æ€§å…¨éƒ¨è¯»å–å‡ºæ¥ã€‚</p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªCookieç±»ï¼Œæ·»åŠ ä¸‰ä¸ªé™æ€æ–¹æ³•ï¼Œå°†Cookieç±»ä½œä¸ºæ¥å£å¯¼å‡º</span>
<span class="hljs-comment">// setæ–¹æ³• è®¾ç½®Cookie</span>
<span class="hljs-comment">// getæ–¹æ³•ï¼Œé€šè¿‡Cookieçš„nameè·å–valueå€¼</span>
<span class="hljs-comment">// removeæ–¹æ³•ï¼Œé€šè¿‡cookieçš„nameåˆ é™¤å¯¹åº”çš„Cookie</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> {
  <span class="hljs-comment">// è®¾ç½®Cookie</span>
  <span class="hljs-comment">//è®¾ç½®Cookie name,value,max-age,domain path,secure</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">name, value, { maxAge, domain, path, secure } = {}</span>) {
    <span class="hljs-keyword">let</span> cookieText = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(name)}</span> = <span class="hljs-subst">${<span class="hljs-built_in">decodeURIComponent</span>(value)}</span>`</span>;
    <span class="hljs-comment">//è®¾ç½®å¤±æ•ˆæ—¶é—´</span>
    <span class="hljs-keyword">if</span> (maxAge) {
      cookieText += <span class="hljs-string">`; max-age=<span class="hljs-subst">${maxAge}</span>`</span>
    }
    <span class="hljs-comment">//   è®¾ç½®åŸŸ</span>
    <span class="hljs-keyword">if</span> (domain) {
      cookieText += <span class="hljs-string">`; domain=<span class="hljs-subst">${domain}</span>`</span>
    }
    <span class="hljs-comment">// è®¾ç½®è·¯å¾„</span>
    <span class="hljs-keyword">if</span> (path) {
      cookieText += <span class="hljs-string">`; path=<span class="hljs-subst">${path}</span>`</span>
    }
    <span class="hljs-comment">// å®‰å…¨æ ‡å¿—</span>
    <span class="hljs-keyword">if</span> (secure) {
      cookieText += <span class="hljs-string">`; secure=<span class="hljs-subst">${secure}</span>`</span>
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = cookieText
  }
  <span class="hljs-comment">// è·å–Cookie</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-comment">// å¾—åˆ°è¿™ä¸ªnameï¼Œä¹Ÿéœ€è¦ç¼–ç </span>
    name = <span class="hljs-built_in">encodeURIComponent</span>(name)
    <span class="hljs-comment">// è¯»å–cookie</span>
    <span class="hljs-keyword">let</span> cookies = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'; '</span>)
    <span class="hljs-comment">// éå†æ•°ç»„çš„æ¯ä¸€é¡¹</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> cookies) {
      <span class="hljs-keyword">const</span> [cookieName, cookieValue] = item.<span class="hljs-title function_">split</span>(<span class="hljs-string">'='</span>)
      <span class="hljs-keyword">if</span> (cookieName === name) {
        <span class="hljs-keyword">return</span> cookieValue
      }
    }

  }
  <span class="hljs-comment">// åˆ é™¤Cookie</span>
  <span class="hljs-comment">// è®¾ç½®è¿‡æœŸæ—¶é—´å³å¯</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">remove</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, { domain, path, <span class="hljs-attr">maxAge</span>: -<span class="hljs-number">1</span> })
  }
}
</code></pre>
<h3 data-id="heading-2">1.2 Cookie çš„å±æ€§</h3>























































<table><thead><tr><th>å±æ€§åˆ†ç±»</th><th>å±æ€§åç§°</th><th>è¯¦ç»†è¯´æ˜</th></tr></thead><tbody><tr><td>å¿…é€‰æ ¸å¿ƒå±æ€§</td><td>åç§°ï¼ˆnameï¼‰</td><td>1. åˆ›å»º Cookie æ—¶å¿…é¡»å¡«å†™ï¼›2. ä¸ Domainã€Path å…±åŒåˆ¤å®šæ˜¯å¦ä¸ºåŒä¸€ä¸ª Cookieï¼ˆä¸‰è€…å‡ç›¸åŒåˆ™ä¸ºåŒä¸€ Cookieï¼‰</td></tr><tr><td>å¿…é€‰æ ¸å¿ƒå±æ€§</td><td>å€¼ï¼ˆvalueï¼‰</td><td>1. åˆ›å»º Cookie æ—¶å¿…é¡»å¡«å†™ï¼Œç”¨äºå­˜å‚¨æ ¸å¿ƒæ•°æ®ï¼›2. è‹¥åŒ…å«éè‹±æ–‡å­—æ¯ï¼Œå†™å…¥æ—¶éœ€ç”¨Â <code>encodeURIComponent()</code>Â ç¼–ç ï¼›3. è‹¥å†™å…¥æ—¶å·²ç¼–ç ï¼Œè¯»å–æ—¶éœ€ç”¨Â <code>decodeURIComponent()</code>Â è§£ç </td></tr><tr><td>å¤±æ•ˆï¼ˆåˆ°æœŸï¼‰å±æ€§</td><td>Expires</td><td>1. ç”¨äºè®¾ç½® Cookie å…·ä½“è¿‡æœŸæ—¶é—´ï¼Œå€¼ä¸ºÂ <code>Date</code>Â ç±»å‹ï¼›2. ä¸è®¾ç½®æ—¶ï¼Œé»˜è®¤ä¼šè¯ç»“æŸå Cookie è¢«æµè§ˆå™¨æ¸…é™¤ï¼›3. å¤±æ•ˆåçš„ Cookie ä¼šè¢«æµè§ˆå™¨è‡ªåŠ¨æ¸…ç†</td></tr><tr><td>å¤±æ•ˆï¼ˆåˆ°æœŸï¼‰å±æ€§</td><td>Max-Age</td><td>1. ç”¨äºè®¾ç½® Cookie è¿‡æœŸæ—¶é•¿ï¼Œå€¼ä¸ºæ•°å­—ï¼ˆå•ä½ï¼šç§’ï¼Œå½“å‰æ—¶é—´ç´¯åŠ è¯¥ç§’æ•°åè¿‡æœŸï¼‰ï¼›2. å€¼ä¸º 0 æˆ–è´Ÿæ•°æ—¶ï¼ŒCookie ä¼šè¢«ç«‹å³åˆ é™¤ï¼›3. ä¼˜å…ˆçº§é€šå¸¸é«˜äº Expires</td></tr><tr><td>è®¿é—®èŒƒå›´é™å®š</td><td>Domainï¼ˆåŸŸï¼‰</td><td>1. é™å®šä¸åŒåŸŸä¸‹çš„ Cookie è®¿é—®èŒƒå›´ï¼›2. JS ä»…èƒ½å†™å…¥ / è¯»å–å½“å‰åŸŸæˆ–çˆ¶åŸŸçš„ Cookieï¼Œæ— æ³•æ“ä½œå…¶ä»–æ— å…³åŸŸçš„ Cookie</td></tr><tr><td>è®¿é—®èŒƒå›´é™å®š</td><td>Pathï¼ˆè·¯å¾„ï¼‰</td><td>1. é™å®šåŒåŸŸä¸åŒè·¯å¾„ä¸‹çš„ Cookie è®¿é—®èŒƒå›´ï¼›2. JS ä»…èƒ½å†™å…¥ / è¯»å–å½“å‰è·¯å¾„æˆ–ä¸Šçº§è·¯å¾„çš„ Cookieï¼Œæ— æ³•æ“ä½œå…¶ä»–æ— å…³è·¯å¾„çš„ Cookie</td></tr><tr><td>å®‰å…¨ç›¸å…³å±æ€§</td><td>HttpOnly</td><td>1. ä»…æ”¯æŒåç«¯è®¾ç½®ï¼Œå‰ç«¯æ— æ³•é€šè¿‡ JSï¼ˆ<code>document.cookie</code>ï¼‰è·å–æˆ–ä¿®æ”¹ï¼›2. æ ¸å¿ƒä½œç”¨ï¼šé˜²æ­¢ XSS æ”»å‡»çªƒå– Cookie æ•°æ®</td></tr><tr><td>å®‰å…¨ç›¸å…³å±æ€§</td><td>Secure</td><td>1. é™å®šä»…åœ¨Â <code>HTTPS</code>Â åè®®ä¸‹ï¼ŒCookie æ‰ä¼šéšè¯·æ±‚å‘é€è‡³æœåŠ¡ç«¯ï¼›2.Â <code>HTTP</code>Â åè®®ä¸‹æ— æ³•ä¼ é€’å¸¦æœ‰è¯¥å±æ€§çš„ Cookie</td></tr><tr><td>ç”Ÿæ•ˆæ¡ä»¶è¡¥å……</td><td>-</td><td>Cookie éœ€åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰ä¼šéšè¯·æ±‚å‘é€åˆ°æœåŠ¡ç«¯ï¼š1. Domain åŒ¹é…ï¼›2. Path åŒ¹é…ï¼›3. Secure æ¡ä»¶åŒ¹é…ï¼ˆHTTPS ç¯å¢ƒï¼‰ï¼›4. Cookie æœªè¿‡æœŸ</td></tr></tbody></table>
<h3 data-id="heading-3">1.4 æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>å‰åç«¯éƒ½å¯ä»¥å†™å…¥å’Œè¯»å– Cookie</li>
<li>æ¯ä¸ªåŸŸåä¸‹çš„ Cookie æ•°é‡æœ‰é™</li>
<li>æ¯ä¸ª Cookie çš„å­˜å‚¨å®¹é‡å¾ˆå°ï¼Œæœ€å¤šåªæœ‰ 4KB å·¦å³ï¼Œæ¯ä¸ªæµè§ˆå™¨ä¸ä¸€æ ·</li>
</ul>
<h2 data-id="heading-4">2. localStorage</h2>
<ul>
<li>localStorage æ˜¯<strong>æµè§ˆå™¨å­˜å‚¨æ•°æ®</strong>çš„ä¸€ç§æ–¹å¼</li>
<li><strong>å­˜å‚¨åœ¨ç”¨æˆ·æœ¬åœ°ï¼Œä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯</strong></li>
<li>å•ä¸ªåŸŸåä¸‹çš„æ€»å¤§å°æœ‰é™åˆ¶ï¼ˆä¸€èˆ¬æœ€å¤§ 5MB å·¦å³ï¼‰æ¯ä¸ªæµè§ˆå™¨ä¸ä¸€æ ·</li>
</ul>
<h3 data-id="heading-5">2.1 localStorage çš„åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è®¾ç½®ï¼ˆæ·»åŠ ï¼‰localStorage æ•°æ®é¡¹</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">"username"</span>, <span class="hljs-string">"icoding"</span>);
<span class="hljs-comment">// è·å– localStorage æ•°æ®é¡¹</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">"username"</span>);
<span class="hljs-comment">// ç§»é™¤ localStorage æ•°æ®é¡¹</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">"username"</span>);
<span class="hljs-comment">// ç§»é™¤æ‰€æœ‰çš„ localStorage æ•°æ®é¡¹</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">clear</span>();
<span class="hljs-comment">// length localStorage ä¸­æœ‰å­˜å‚¨å¤šå°‘æ•°æ®</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">length</span>;
</code></pre>
<h3 data-id="heading-6">2.2 æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>localStorage å­˜å‚¨çš„æ•°æ®ï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤ï¼ˆå¦‚ é€šè¿‡ JS åˆ é™¤ æˆ– æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼‰å¦åˆ™ï¼Œæ•°æ®æ°¸è¿œä¸ä¼šè¿‡æœŸçš„ã€‚å®ƒæ˜¯<strong>æŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨</strong>ã€‚</li>
<li>sessionStorage å­˜å‚¨çš„æ•°æ®ï¼Œæ˜¯å½“å‰ä¼šè¯ç»“æŸï¼ˆå¦‚ å…³é—­æµè§ˆå™¨ï¼‰çš„æ—¶å€™ï¼ŒsessionStorage ä¸­çš„æ•°æ®ä¼šè¢«æ¸…ç©º</li>
<li><strong>sessionStorage çš„ä½¿ç”¨æ–¹æ³• ä¸ localStorage ä¸€æ¨¡ä¸€æ ·</strong></li>
<li>localStorage å­˜å‚¨çš„é”®å’Œå€¼<strong>åªèƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹</strong></li>
<li><strong>ä¸åŒçš„åŸŸåä¸èƒ½å…±ç”¨ localStorage</strong></li>
</ul>
<h3 data-id="heading-7">2.3 å°è£…</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å‡ºå°è£…åçš„ localStorage æ“ä½œå¯¹è±¡</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// setæ–¹æ³•ï¼šæ ¹æ®keyã€valueæ·»åŠ /ä¿®æ”¹æ•°æ®ï¼ˆè‡ªåŠ¨åºåˆ—åŒ–å¯¹è±¡ç±»å‹ï¼‰</span>
  <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) { 
      value = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value);
    }
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, value);
  },

  <span class="hljs-comment">// getæ–¹æ³•ï¼šæ ¹æ®keyè·å–å€¼ï¼ˆè‡ªåŠ¨å°è¯•ååºåˆ—åŒ–ï¼Œå¤±è´¥åˆ™è¿”å›åŸå§‹å€¼ï¼‰</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span>) { <span class="hljs-comment">// å…ˆåˆ¤æ–­keyä¸å­˜åœ¨çš„æƒ…å†µï¼Œç›´æ¥è¿”å›null</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è§£ææˆåŠŸåï¼Œè¿”å›è§£æåçš„ç»“æœ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(value);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-comment">// è§£æå¤±è´¥ï¼ˆåŸå§‹å€¼ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼‰ï¼Œè¿”å›åŸå§‹value</span>
      <span class="hljs-keyword">return</span> value;
    }
  },

  <span class="hljs-comment">// removeæ–¹æ³•ï¼šæ ¹æ®keyç§»é™¤æŒ‡å®šé¡¹</span>
  <span class="hljs-title function_">remove</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);
  },

  <span class="hljs-comment">// clearæ–¹æ³•ï¼šæ¸…ç©ºå½“å‰åŸŸåä¸‹æ‰€æœ‰localStorageæ•°æ®</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">clear</span>();
  }
};
</code></pre>
<h2 data-id="heading-8">Cookieã€localStorageã€sessionStorage çš„å¯¹æ¯”ï¼ˆé¢è¯•é¢˜ï¼‰</h2>









































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>Cookie</th><th>LocalStorage</th><th>sessionStorage</th></tr></thead><tbody><tr><td>å­˜å‚¨å¤§å°</td><td>4K</td><td>5M</td><td>5M</td></tr><tr><td>æœ‰æ•ˆæœŸ</td><td>æ‰‹åŠ¨è®¾ç½®</td><td>æ— </td><td>æµè§ˆå™¨çª—å£å…³é—­</td></tr><tr><td>å­˜å‚¨ä½ç½®</td><td>æµè§ˆå™¨</td><td>æµè§ˆå™¨</td><td>æµè§ˆå™¨</td></tr><tr><td>ä¸è¯·æ±‚ä¸€èµ·å‘é€</td><td>æ˜¯</td><td>å¦</td><td>å¦</td></tr><tr><td>è®¿é—®é™æ­¢</td><td>å­åŸŸå¯ä»¥è®¿é—®è‡ªå·±å’Œçˆ¶åŸŸä¸­çš„ Cookie</td><td>åŒåŸŸä¸‹éƒ½å¯ä»¥è®¿é—®</td><td>åªé™å½“å‰çª—å£</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çœŸå®æ¡ˆä¾‹å¤ç›˜ï¼šä»â€œä¸‰å¥—çƒŸå›±â€åˆ°Â AllÂ inÂ ESï¼Œè¿™å®¶ä¼ä¸šå¦‚ä½•ç æ‰Â 40%è¿ç»´æˆæœ¬ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7589445154534506548</link>    <guid>https://juejin.cn/post/7589445154534506548</guid>    <pubDate>2025-12-30T09:58:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589445154534506548" data-draft-id="7589477775209611316" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çœŸå®æ¡ˆä¾‹å¤ç›˜ï¼šä»â€œä¸‰å¥—çƒŸå›±â€åˆ°Â AllÂ inÂ ESï¼Œè¿™å®¶ä¼ä¸šå¦‚ä½•ç æ‰Â 40%è¿ç»´æˆæœ¬ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Elasticsearch,æœç´¢å¼•æ“"/> <meta itemprop="datePublished" content="2025-12-30T09:58:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çœŸå®æ¡ˆä¾‹å¤ç›˜ï¼šä»â€œä¸‰å¥—çƒŸå›±â€åˆ°Â AllÂ inÂ ESï¼Œè¿™å®¶ä¼ä¸šå¦‚ä½•ç æ‰Â 40%è¿ç»´æˆæœ¬ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:58:53.000Z" title="Tue Dec 30 2025 09:58:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">æ–‡Â /Â é˜¿é‡Œäº‘AIæœç´¢äº§ç ”å›¢é˜Ÿ</h4>
<p>åœ¨åšæœç´¢æŠ€æœ¯æ¶æ„å’¨è¯¢æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°ä¸€å¥è¯ï¼šâ€œæˆ‘ä¹ŸçŸ¥é“ä¸šåŠ¡ç³»ç»Ÿå¤æ‚ï¼Œä½†ä¸çŸ¥é“æ€ä¹ˆç®€åŒ–æ¶æ„éƒ¨ç½²?â€</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬æƒ³èŠèŠÂ â€œæŸçŸ¥åäº’è”ç½‘æ³›å¨±ä¹è§†è§‰å¹³å°Â Aâ€ï¼ˆä»¥ä¸‹ç®€ç§°Â AÂ å…¬å¸ï¼‰çš„æœç´¢æ¶æ„æ¼”è¿›æ•…äº‹ã€‚ä»–ä»¬çš„äº‘ä¸Šè¿ç§»ç»å†ï¼Œæ˜¯æ— æ•°æ­£åœ¨ä¸ºâ€œæŠ€æœ¯æ ˆç¢ç‰‡åŒ–â€ä¸"AIæœç´¢æ¶æ„æ”¹é€ "å¤´ç–¼çš„ä¼ä¸šçš„çœŸå®å†™ç…§ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€é˜¶æ®µï¼šä¸ºäº†ä¸šåŠ¡çš„â€œå¿«â€ï¼Œä»–ä»¬å»ºäº†ä¸‰æ ¹çƒŸå›±</h2>
<p>ä¸€å¹´å‰ï¼ŒAÂ å…¬å¸çš„æŠ€æœ¯æ¶æ„è´Ÿè´£äººè€æé¢ä¸´ç€æå¤§çš„å‹åŠ›ã€‚éšç€åŸå…ˆçš„æ£€ç´¢ä¸šåŠ¡å¼•å…¥å…¨é‡æ—¥å¿—å®¡è®¡çš„è¿ç»´ç®¡ç†ï¼Œå†åˆ°æ¥å…¥å¤§æ¨¡å‹Â RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ï¼Œä»–ä»¬çš„æ¶æ„å˜æˆäº†å…¸å‹çš„â€œæ‹¼å‡‘å‹â€ï¼š</p>
<p><strong>é€šç”¨æœç´¢ä¸šåŠ¡</strong>ï¼šç´ æä¸­å°ã€è§†é¢‘/è¡¨æƒ…åŒ…å…³é”®è¯æ£€ç´¢ï¼Œæ¶‰åŠå¤§è§„æ¨¡ç”¨æˆ·ã€è¯é¢˜åŠæ´»åŠ¨ä¿¡æ¯ã€‚è·‘åœ¨å¼€æºESé›†ç¾¤ä¸Šã€‚</p>
<p><strong>æ—¥å¿—æ£€ç´¢ä¸šåŠ¡</strong>ï¼šä¸ºäº†åˆè§„å­˜å‚¨æµ·é‡Â AccessÂ Logï¼Œé‡‡è´­äº†ç‹¬ç«‹çš„æ—¥å¿—æœåŠ¡ã€‚Appè¡Œä¸ºæ—¥å¿—ã€æœåŠ¡ç«¯ç³»ç»Ÿæ—¥å¿—ï¼Œç”¨äºæ€§èƒ½ç›‘æ§ä¸è¿è¥å†³ç­–ã€‚ä¸ºäº†çœé’±åˆæŠŠéƒ¨åˆ†è€æ—¥å¿—å¯¼åˆ°äº†Â å¯¹è±¡å­˜å‚¨é‡Œï¼ŒæŸ¥è¯¢æå…¶ä¸ä¾¿ã€‚</p>
<p><strong>å‘é‡æ£€ç´¢ä¸šåŠ¡</strong>ï¼šåŸºäºè§†è§‰ç‰¹å¾çš„ç›¸ä¼¼å›¾ç‰‡æ£€ç´¢ã€åŸºäºç”¨æˆ·ç”»åƒçš„æ™ºèƒ½æ¨èï¼ˆå¦‚ç›¸ä¼¼æ»¤é•œã€æ¨¡æ¿æ¨èï¼‰ã€‚ä¸ºäº†åšÂ RAGÂ å’ŒçŒœä½ å–œæ¬¢ï¼Œåˆä¸å¾—ä¸å•ç‹¬æ­å»ºäº†ä¸€å¥—Â å¼€æºMilvusã€‚</p>
<h4 data-id="heading-2">è€æçš„ç—›ç‚¹éå¸¸å…·ä½“ï¼š</h4>
<p><strong>â€œåŠå¤œçƒ§é’±â€</strong>ï¼šAÂ å…¬å¸çš„æµé‡æœ‰æ˜æ˜¾çš„æ½®æ±æ•ˆåº”ã€‚æ¯å¤©æ™šä¸ŠÂ 8Â ç‚¹åˆ°Â 12Â ç‚¹æ˜¯æ—¥å¿—å†™å…¥æ´ªå³°ï¼Œä½†å‡Œæ™¨Â 2Â ç‚¹åˆ°æ—©ä¸ŠÂ 8Â ç‚¹æµé‡æä½ã€‚ä¸ºäº†æŠ—ä½é‚£Â 4Â å°æ—¶çš„å³°å€¼ï¼Œä»–ä»¬å¿…é¡»æŒ‰æœ€é«˜æ°´ä½è´­ä¹°æ—¥å¿—èµ„æºã€‚ç»“æœå°±æ˜¯ï¼šæ¯å¤©æœ‰Â 16Â ä¸ªå°æ—¶ï¼Œæ˜‚è´µçš„è®¡ç®—èµ„æºåœ¨ç©ºè½¬ã€‚çªå‘æµé‡å¯¼è‡´çš„æ‰©å®¹å‹åŠ›ä¸å­˜å‚¨æˆæœ¬ä¸æˆæ­£æ¯”ã€‚</p>
<p><strong>â€œèƒ¶æ°´ä»£ç â€</strong>ï¼šåœ¨åšÂ RAGÂ æ—¶ï¼Œå¼€å‘åŒå­¦éœ€è¦åœ¨ä»£ç é‡Œå…ˆæŸ¥Â MilvusÂ æ‹¿Â IDï¼Œå†å›æŸ¥Â ESÂ æ‹¿æ–‡æœ¬ã€‚ä¸ä»…ä»£ç éš¾ç»´æŠ¤ï¼Œä¸€æ—¦å‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼ˆæ¯”å¦‚æ–‡ç« åˆ äº†ï¼Œå‘é‡è¿˜åœ¨ï¼‰ï¼Œç”¨æˆ·å°±ä¼šç‚¹è¿›Â 404Â é¡µé¢ï¼ŒæŠ•è¯‰ç‡é£™å‡ã€‚</p>
<p><strong>â€œä¸‰æ ¹çƒŸå›±â€</strong>ï¼Œå¤šç§æœç´¢èƒ½åŠ›éš”ç¦»åˆ†å¼€ï¼Œå¼€å‘ä¸è¿ç»´æˆæœ¬æé«˜ï¼Œéš¾ä»¥æ”¯æŒå¤æ‚çš„è·¨æ¨¡æ€æ£€ç´¢ã€‚</p>
<p><strong>â€œèœ—è¡Œç‰›æ­¥â€</strong>ï¼šå…¨é‡åŒæ­¥è€—æ—¶é•¿ï¼Œå¤§æ•°æ®é‡ä¸‹çš„å®æ—¶æ›´æ–°ä¸ç´¢å¼•é‡å»ºæ•ˆç‡ä½ä¸‹ã€‚</p>
<h2 data-id="heading-3">ç¬¬äºŒé˜¶æ®µï¼šåšå‡æ³•ï¼Œæ‹¥æŠ±Â AllÂ inÂ ES</h2>
<p>åœ¨ä¸é˜¿é‡Œäº‘AIæœç´¢ä¸“å®¶å›¢é˜Ÿæ·±èŠåï¼ŒAÂ å…¬å¸å†³å®šè¿›è¡Œä¸€æ¬¡å½»åº•æŠ€æœ¯â€œæ–­èˆç¦»â€ï¼Œå°†AIæœç´¢æ‰€éœ€çš„å¤šç§æŠ€æœ¯æ ˆç»Ÿä¸€æ”¶æ•›åˆ°é˜¿é‡Œäº‘Â ElasticsearchÂ ä¸Šã€‚</p>
<ol>
<li>
<p><strong>æ—¥å¿—åœºæ™¯ï¼šæŠŠâ€œå›ºå®šèµ„äº§â€å˜æˆâ€œç”µè´¹å•â€</strong> AÂ å…¬å¸é¦–å…ˆæ”¹é€ çš„æ˜¯æœ€çƒ§é’±çš„æ—¥å¿—ç³»ç»Ÿã€‚ä»–ä»¬æ²¡æœ‰ç»§ç»­è´­ä¹°åºå¤§çš„è‡ªå»ºESèŠ‚ç‚¹ï¼Œè€Œæ˜¯æ¥å…¥äº†é˜¿é‡Œäº‘Â ESÂ çš„Â é«˜æ€§èƒ½å†™å…¥æ‰˜ç®¡æœåŠ¡IndexingÂ ServiceÂ å’ŒÂ æ··åˆå­˜å‚¨æœåŠ¡OpenStoreã€‚</p>
<p>å˜åŒ–å‰ï¼šä¸ºäº†æŠ—å³°å€¼ï¼Œå¸¸é©»Â 20Â å°Â 8C32GÂ çš„æœºå™¨ã€‚å‡Œæ™¨æµé‡è·Œåˆ°è°·åº•æ—¶ï¼Œè¿™Â 20Â å°æœºå™¨ä¾ç„¶åœ¨è®¡è´¹ã€‚</p>
<p>å˜åŒ–åï¼šå½»åº•Â ServerlessÂ åŒ–ã€‚æ™šé«˜å³°æµé‡æ¥äº†ï¼Œäº‘ç«¯è‡ªåŠ¨æ‰©å®¹æ‰›å‹ï¼›å‡Œæ™¨æµé‡æ²¡äº†ï¼Œè®¡è´¹å‡ ä¹å½’é›¶ã€‚å­˜å‚¨æ–¹é¢ï¼Œæ•°æ®è‡ªåŠ¨æ²‰é™åˆ°Â OpenStoreï¼ˆå¯¹è±¡å­˜å‚¨ä»‹è´¨ï¼‰ï¼Œæˆæœ¬ç›´æ¥å¯¹å…¶å½’æ¡£å­˜å‚¨ã€‚</p>
<p>è€æçš„åé¦ˆï¼šâ€œä»¥å‰æ˜¯å…»è½¦ï¼Œä¸ç®¡å¼€ä¸å¼€éƒ½å¾—ä»˜æŠ˜æ—§å’Œä¿é™©ï¼›ç°åœ¨æ˜¯æ‰“è½¦ï¼Œè·‘å¤šå°‘ä»˜å¤šå°‘ã€‚å•è¿™ä¸€é¡¹ï¼Œæ—¥å¿—è´¦å•é™äº†Â 60%ã€‚â€</p>
</li>
<li>
<p><strong>å‘é‡åœºæ™¯ï¼šåˆ æ‰èƒ¶æ°´ä»£ç ï¼Œå›å½’åŸç”Ÿ</strong> è§£å†³äº†æ—¥å¿—ï¼ŒAÂ å…¬å¸å¼€å§‹åŠ¨åˆ€å‘é‡æœç´¢ã€‚ä»–ä»¬åˆ©ç”¨é˜¿é‡Œäº‘Â ESÂ å†…æ ¸çº§å¼ºåŒ–çš„æ··åˆå‘é‡å¼•æ“ï¼Œæ›¿ä»£äº†ç‹¬ç«‹çš„å‘é‡åº“ã€‚</p>
</li>
</ol>
<p>å˜åŒ–å‰ï¼šåº”ç”¨Â -&gt;Â æŸ¥å‘é‡åº“Â -&gt;Â æ‹¿Â IDÂ -&gt;Â æŸ¥Â ESÂ -&gt;Â åº”ç”¨å±‚æ’åºã€‚å»¶è¿ŸÂ 200ms+ã€‚</p>
<p>å˜åŒ–åï¼šåº”ç”¨Â -&gt;Â é˜¿é‡Œäº‘Â ESÂ (æ··åˆæ£€ç´¢Â API)Â -&gt;Â è¿”å›ç»“æœã€‚</p>
<p>ç”±äº<strong>é˜¿é‡Œäº‘Â ESÂ å…¨è‡ªç ”äº‘åŸç”Ÿå¼•æ“FalconSeek</strong>åœ¨å†…æ ¸å±‚å¼•å…¥äº†Â SIMDÂ æŒ‡ä»¤é›†åŠ é€Ÿå’ŒÂ HNSWÂ ç®—æ³•ä¼˜åŒ–ï¼Œåœ¨åƒä¸‡çº§æ•°æ®é‡ä¸‹ï¼Œæ€§èƒ½å®Œå…¨æ»¡è¶³Â AÂ å…¬å¸çš„éœ€æ±‚ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä»–ä»¬ç»ˆäºå¯ä»¥ç”¨ä¸€ä¸ªÂ DSLÂ è¯­å¥åŒæ—¶æå®šâ€œè¯­ä¹‰æœç´¢Â +Â å…³é”®è¯åŒ¹é…Â +Â è¾¹æ—¶é—´è¿‡æ»¤è¾¹æ£€ç´¢â€ã€‚</p>
<p>è€æçš„åé¦ˆï¼šâ€œæ¶æ„å›¾ä¸Šå°‘äº†ä¸€ä¸ªæ¡†ï¼Œä»£ç é‡Œå°‘äº†å‡ ç™¾è¡Œèƒ¶æ°´é€»è¾‘ï¼Œå¼€å‘åŒå­¦ç»ˆäºä¸ç”¨åœ¨ä¸¤ä¸ªåº“ä¹‹é—´ä¿®æ•°æ®ä¸€è‡´æ€§çš„Â BugÂ äº†ã€‚â€</p>
<h2 data-id="heading-4">ä¸ºä»€ä¹ˆé€‰æ‹©Â AllÂ inÂ ESï¼Ÿå› ä¸ºâ€œç»Ÿä¸€â€æœ¬èº«å°±æ˜¯ç”Ÿäº§åŠ›</h2>
<p>AÂ å…¬å¸çš„æ•…äº‹å¹¶éå­¤ä¾‹ã€‚å½“ä»–ä»¬å°†æ—¥å¿—ã€æœç´¢ã€å‘é‡æ”¶æ•›åˆ°é˜¿é‡Œäº‘Â ElasticsearchÂ è¿™ä¸€å¥—æŠ€æœ¯æ ˆä¸Šæ—¶ï¼Œå‘ç”Ÿçš„ä¸ä»…ä»…æ˜¯æˆæœ¬çš„é™ä½ï¼š</p>
<h4 data-id="heading-5">ç³»ç»Ÿæ¶æ„ä¼˜åŒ–ï¼š</h4>
<ol>
<li>
<p>æè‡´çš„è®¡ç®—èµ„æºå¼¹æ€§ï¼ˆServerlessï¼‰ï¼šÂ å¯¹äºæ—¥å¿—è¿™ç§å…·æœ‰æ˜æ˜¾â€œå³°è°·æ•ˆåº”â€çš„æ•°æ®ï¼Œä¼ ç»Ÿçš„é¢„ç½®æœºå™¨æ¨¡å¼æ³¨å®šæ˜¯æµªè´¹ã€‚é˜¿é‡Œäº‘Â ESÂ çš„Â IndexingÂ ServiceÂ è®©ç®—åŠ›åƒæ°´ä¸€æ ·æµåŠ¨ï¼Œâ€œç”¨æ—¶ä»˜è´¹ï¼Œä¸ç”¨å…è´¹â€ï¼Œè¿™æ‰æ˜¯äº‘åŸç”Ÿè¯¥æœ‰çš„æ ·å­ã€‚</p>
</li>
<li>
<p>è¿ç»´æ ‡å‡†çš„ç»Ÿä¸€ï¼šÂ ç°åœ¨ï¼ŒAÂ å…¬å¸çš„è¿ç»´å›¢é˜Ÿåªéœ€è¦ç²¾é€šÂ ESÂ è¿™ä¸€é—¨æ‰‹è‰ºã€‚æ— è®ºæ˜¯æŸ¥ä¸šåŠ¡æ…¢æŸ¥è¯¢ï¼Œè¿˜æ˜¯åšæ—¥å¿—åˆ†æï¼Œäº¦æˆ–æ˜¯ç®¡ç†å‘é‡ç´¢å¼•ï¼Œéƒ½åœ¨åŒä¸€ä¸ªæ§åˆ¶å°ï¼Œéµå¾ªåŒä¸€å¥—å®‰å…¨æ ‡å‡†ï¼ˆRBAC/VPCï¼‰ï¼Œçœ‹åŒä¸€å¥—ç›‘æ§å¤§ç›˜ã€‚</p>
</li>
<li>
<p>æ•°æ®ä»·å€¼çš„é—­ç¯ï¼šÂ æ—¥å¿—æ•°æ®è¿›æ¥ï¼Œæ¸…æ´—åç›´æ¥å¯ä»¥ç”¨äºä¸šåŠ¡åˆ†æï¼›ä¸šåŠ¡æ•°æ®è¿›æ¥ï¼Œç›´æ¥ç”Ÿæˆå‘é‡ç”¨äºæ¨èã€‚æ•°æ®åœ¨åŒä¸€ä¸ªç”Ÿæ€å†…æµè½¬ï¼Œæ²¡æœ‰ä¸­é—´å•†èµšå·®ä»·ã€‚</p>
</li>
</ol>
<h4 data-id="heading-6">æ—¥å¿—æ£€ç´¢å¢å¼ºï¼š</h4>
<p>åœ¨Aå…¬å¸ä¸­å¹¿æ³›ä½¿ç”¨çš„æ—¥å¿—æ£€ç´¢ï¼Œé‡‡ç”¨é˜¿é‡Œäº‘Elasticsearchä¼ä¸šç‰ˆä»¥ä¸‹æ–¹é¢è¿›è¡Œå…¨é¢ä¼˜åŒ–ã€‚</p>
<p><strong>æè‡´å†™å…¥ä¼˜åŒ–Â -Â IndexingÂ serviceè¯»å†™åˆ†ç¦»ï¼Œç»¼åˆå†™å…¥æˆæœ¬é™ä½60%</strong></p>
<ul>
<li>
<p>é«˜æ€§èƒ½ï¼šä¸“ä¸šçº§å†™å…¥ä¼˜åŒ–ï¼Œå¤šè‡ªç ”ç‰¹æ€§åŠ æŒ(ç‰©ç†å¤åˆ¶,å®šå‘è·¯ç”±ç­‰)</p>
</li>
<li>
<p>é«˜ç¨³å®šï¼šå¤šé›†ç¾¤å†—ä½™å¤‡ä»½ï¼Œç§’çº§åˆ‡æ¢</p>
</li>
<li>
<p>ä½æˆæœ¬ï¼šå†™å…¥èµ„æºï¼Œå­˜å‚¨å¤§å°åŠä»‹è´¨ç­‰ä¼˜åŒ–</p>
</li>
<li>
<p>å¼¹æ€§æ‰©å±•ï¼šå†™å…¥èµ„æºç”±äº‘ç«¯åå°è°ƒé…å’Œç®¡ç†ï¼Œä»¥åº”å¯¹æµé‡æ³¢åŠ¨</p>
</li>
<li>
<p>å…è¿ç»´ï¼šæ— é¡»å…³æ³¨å†™å…¥èµ„æºå’Œå†™å…¥å‹åŠ›, æå¤§é™ä½é›†ç¾¤è¿ç»´æˆæœ¬</p>
</li>
</ul>
<p><strong>å­˜ç®—åˆ†ç¦»ä¼˜åŒ–Â -Â OpenStoreæ··åˆå­˜å‚¨æ¶æ„ï¼Œå­˜å‚¨æˆæœ¬é™ä½60%ä»¥ä¸Š</strong></p>
<ul>
<li>
<p>é‡‡ç”¨å­˜ç®—åˆ†ç¦»æ¶æ„ï¼Œé™ä½æ•°æ®å†—ä½™å­˜å‚¨</p>
</li>
<li>
<p>é‡‡ç”¨å¯¹è±¡å­˜å‚¨é™ä½å­˜å‚¨æˆæœ¬</p>
</li>
<li>
<p>å¤šçº§ç¼“å­˜åŠå¹¶å‘æŸ¥è¯¢ä¿è¯æŸ¥è¯¢æ€§èƒ½</p>
</li>
</ul>
<h4 data-id="heading-7">ä¸“ä¸šçº§æŸ¥è¯¢ä¼˜åŒ–:</h4>
<ul>
<li>é’ˆå¯¹æ—¥å¿—åœºæ™¯çš„å…¸å‹æŸ¥è¯¢caseè¿›è¡Œæ·±åº¦ä¼˜åŒ–ï¼Œæé«˜ç”¨æˆ·æŸ¥è¯¢æ€§èƒ½ï¼ŒÂ å¦‚bkdæŸ¥è¯¢ä¼˜åŒ–ç­‰</li>
<li>è´´è¿‘ç”¨æˆ·ä¸šåŠ¡ï¼Œé’ˆå¯¹ç”¨æˆ·ä½¿ç”¨è¿‡ç¨‹ä¸­çš„æŸ¥è¯¢é—®é¢˜è¿›è¡Œå®šåˆ¶ä¼˜åŒ–ï¼Œå¦‚åœ¨æ”¯æŒAå®¢æˆ·ä¸­é‡åˆ°çš„cardinalityå¼€æºç¼ºé™·å¯¼è‡´çš„æŸ¥è¯¢æ€§èƒ½é—®é¢˜ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-8">å‘é‡ç´¢å¼•è°ƒä¼˜ï¼š</h4>
<p>å‘é‡ç´¢å¼•åœ¨AIæœç´¢åœºæ™¯ä¸­è¶Šæ¥è¶Šé‡è¦ï¼ŒAå…¬å¸ä¸ºæé«˜æ€§èƒ½ï¼Œé™ä½æ•´ä½“æˆæœ¬ï¼Œå……åˆ†é‡‡ç”¨äº†é˜¿é‡Œäº‘ESçš„è‹¥å¹²ä¼˜åŒ–æ‰‹æ®µã€‚æˆåŠŸçš„å°†æˆæœ¬é™ä½ä¸€å€ä»¥ä¸Šï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡æ•°å€ä»¥ä¸Šï¼š</p>
<ul>
<li>
<p><strong>è‡ªç ”FalconSeekäº‘åŸç”Ÿç´¢å¼•åº”ç”¨</strong>ï¼šé˜¿é‡Œäº‘æœ€æ–°å‘å¸ƒå…¨è‡ªç ”äº‘åŸç”ŸC++å†…æ ¸å¼•æ“,Â å¯¹æ–‡æœ¬æ£€ç´¢ä¸å‘é‡æ£€ç´¢æ€§èƒ½æå‡ï¼Œå‘é‡æ€§èƒ½è¿›ä¸€æ­¥æå‡40%ä»¥ä¸Šã€‚Â ä½¿ç”¨FalconSeekçš„<strong>Filter-Knn</strong>ç‰¹æ€§ï¼Œæ€§èƒ½æå‡æœ€å¤š4å€ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡ŒForceÂ Merge</strong>ï¼šå­˜é‡æ•°æ®å®šæœŸæ‰§è¡ŒForceÂ Mergeï¼Œæ€§èƒ½æå‡5å€ä»¥ä¸Šã€‚</p>
</li>
<li>
<p><strong>åŸæ–‡æ’é™¤å‘é‡å­—æ®µ</strong>ï¼šåœ¨å†™å…¥çš„sourceä¸­æ’é™¤å‘é‡å­—æ®µï¼Œå­˜å‚¨ç©ºé—´èŠ‚çº¦1å€ä»¥ä¸Šã€‚</p>
</li>
<li>
<p><strong>æ··åˆæœç´¢ï¼š</strong> é‡‡ç”¨<strong>RRFï¼ˆReciprocalÂ RankÂ Fusionï¼‰</strong> ç®—æ³•æˆ–è‡ªå®šä¹‰çº¿æ€§æƒé‡ï¼Œå°†å‘é‡ç›¸ä¼¼åº¦å¾—åˆ†ä¸BM25æ–‡æœ¬å¾—åˆ†è¿›è¡ŒåŠ æƒèåˆï¼Œä»¥å…¼é¡¾æ£€ç´¢çš„ç²¾ç¡®æ€§ä¸æ³›åŒ–æ€§ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">æˆæœ¬æ•ˆèƒ½å¯¹æ¯”ä¸é€‰å‹å»ºè®®</h2>
<p>æ ¹æ®Aå…¬å¸è¿ç§»é˜¿é‡Œäº‘çš„æµ‹ç®—åˆ†æï¼Œä¼ä¸šåœ¨æ„å»ºå¤šåœºæ™¯AIæœç´¢æ—¶ï¼Œå¯é‡ç‚¹å…³æ³¨ä»¥ä¸‹æˆæœ¬æŒ‡æ ‡ï¼š</p>






























<table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>å»ºè®®æ–¹æ¡ˆ</strong></th><th><strong>ä»·å€¼äº§å‡º</strong></th></tr></thead><tbody><tr><td><strong>è®¡ç®—èµ„æº</strong></td><td>è‡ªç ”FalconSeekå¼•æ“åº”ç”¨<br/>é€‰ç”¨è®¡ç®—å‹ecs.g8iæˆ–r8iç³»åˆ—</td><td>æå‡å‘é‡è¿ç®—ï¼ˆHNSWç­‰ç®—æ³•ï¼‰çš„ååé‡</td></tr><tr><td><strong>å­˜å‚¨èµ„æº</strong></td><td>OpenStoreå­˜ç®—åˆ†ç¦»æ¶æ„</td><td>è§£å†³æ—¥å¿—/å†·æ•°æ®å­˜å‚¨é«˜æˆæœ¬ç—›ç‚¹</td></tr><tr><td><strong>å†™å…¥æ€§èƒ½</strong></td><td>IndexingÂ Serviceé«˜å†™å…¥æœåŠ¡ï¼Œ<br/>å¼€å¯ç‰©ç†å¤åˆ¶ï¼ˆPhysicalÂ Replicationï¼‰</td><td>é™ä½é«˜å¹¶å‘å†™å…¥æ—¶çš„CPUå ç”¨</td></tr><tr><td><strong>è¿ç»´æ•ˆç‡</strong></td><td>ç»Ÿä¸€å…¬ç”¨é›†ç¾¤ä¸ç´ æä¸­å°é›†ç¾¤</td><td>å‡å°‘20%ä»¥ä¸Šçš„ç¢ç‰‡åŒ–äººåŠ›æŠ•å…¥</td></tr></tbody></table>
<h2 data-id="heading-10">æ€»ç»“ï¼šOneÂ Stackä¸€ç«™å¼æœç´¢,Â ç®€å•æ¶æ„æ˜¯æœ€å¥½çš„æ¶æ„</h2>
<p>å›çœ‹Â AÂ å…¬å¸çš„æœç´¢æŠ€æœ¯æ¼”è¿›ä¹‹è·¯ï¼Œå…¶å®å°±æ˜¯ä¸€æ¡ä»â€œåšåŠ æ³•â€åˆ°â€œåšå‡æ³•â€çš„è·¯ã€‚</p>
<p>å¯¹äºæ¶æ„å¸ˆï¼šä½ çš„ç³»ç»Ÿæ‹“æ‰‘å›¾å˜æ¸…æ™°äº†ï¼Œæ•°æ®é“¾è·¯å˜çŸ­äº†ï¼Œç³»ç»Ÿç¨³å®šæ€§å˜å¼ºäº†ã€‚</p>
<p>å¯¹äºè¿ç»´ï¼šåªè¦ç²¾é€šÂ ESÂ ä¸€é—¨äº§å“æŠ€æœ¯æ‰‹è‰ºï¼Œå°±èƒ½æå®šå…¨å…¬å¸çš„æ ¸å¿ƒæ•°æ®æ£€ç´¢å…¨é“¾è·¯ã€‚</p>
<p>å¯¹äºè€æ¿ï¼šTCOï¼ˆæ€»æ‹¥æœ‰æˆæœ¬ï¼‰æ˜¾è‘—ä¸‹é™ï¼ŒåŒæ—¶è·å¾—äº†ä¼ä¸šçº§çš„å®‰å…¨åˆè§„ä¿éšœã€‚</p>
<p>ä¸è¦è®©å¤æ‚çš„å·¥å…·é“¾æ‹–ç´¯ä½ çš„ä¸šåŠ¡åˆ›æ–°çš„é€Ÿåº¦ã€‚</p>
<p>ä»ä»Šå¤©å¼€å§‹ï¼Œå‚è€ƒÂ AÂ å…¬å¸çš„è·¯å¾„ï¼Œé‡æ–°å®¡è§†ä½ çš„æ¶æ„ã€‚å°è¯•é˜¿é‡Œäº‘Â Elasticsearchä¼ä¸šç‰ˆï¼Œä½“éªŒâ€œAllÂ inÂ ESâ€å¸¦æ¥çš„æç®€ä¸é«˜æ•ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[mini-reactæœ€å°å®ç°æ‰‹æŠŠæ‰‹å¸¦ä½ çœ‹æ¸…hooksæœ¬è´¨]]></title>    <link>https://juejin.cn/post/7589212818807390271</link>    <guid>https://juejin.cn/post/7589212818807390271</guid>    <pubDate>2025-12-30T08:25:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589212818807390271" data-draft-id="7589475923696566291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="mini-reactæœ€å°å®ç°æ‰‹æŠŠæ‰‹å¸¦ä½ çœ‹æ¸…hooksæœ¬è´¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T08:25:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="echo_e"/> <meta itemprop="url" content="https://juejin.cn/user/1267099625328903"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            mini-reactæœ€å°å®ç°æ‰‹æŠŠæ‰‹å¸¦ä½ çœ‹æ¸…hooksæœ¬è´¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1267099625328903/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    echo_e
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:25:07.000Z" title="Tue Dec 30 2025 08:25:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Mini React Runtime å®ç°è§£æï¼ˆFiber + Hooksï¼‰</h2>
<p>åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å°†åˆ†äº«ä¸€ä¸ªæœ€å°åŒ– React Runtime çš„å®ç°ï¼ŒåŒ…æ‹¬ Fiber æ¶æ„å’Œ Hooks çš„åŸç†ã€‚æœ¬æ–‡é€‚åˆæƒ³æ·±å…¥ç†è§£ React å†…éƒ¨å·¥ä½œæœºåˆ¶çš„å‰ç«¯å¼€å‘è€…ã€‚</p>
<hr/>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>React çš„æ ¸å¿ƒæ˜¯ <strong>è™šæ‹Ÿ DOM + Fiber + Hooks</strong>ã€‚</p>
<ul>
<li><strong>Fiber</strong>ï¼šè¿è¡Œæ—¶çš„ç»„ä»¶å®ä¾‹ï¼Œè´Ÿè´£ç®¡ç†çŠ¶æ€ã€hooks å’Œè°ƒåº¦ã€‚</li>
<li><strong>Hooks</strong>ï¼šå‡½æ•°ç»„ä»¶çš„çŠ¶æ€ç®¡ç†æœºåˆ¶ï¼Œé€šè¿‡è°ƒç”¨é¡ºåºä¿è¯çŠ¶æ€ç¨³å®šæ€§ã€‚</li>
<li><strong>è™šæ‹Ÿ DOM</strong>ï¼šæè¿° UI çš„å¯¹è±¡ï¼Œä¸ç›´æ¥æ¸²æŸ“ï¼ŒFiber æ ¹æ®å®ƒæ„å»ºçœŸå® DOMã€‚</li>
</ul>
<p>æœ¬æ–‡å®ç°çš„æ˜¯ä¸€ä¸ªæœ€å°å¯è¿è¡Œç‰ˆæœ¬ï¼Œå¸®åŠ©ç†è§£åŸç†ã€‚</p>
<hr/>
<h3 data-id="heading-2">æ•´ä½“æ¶æ„</h3>
<h4 data-id="heading-3">æ¶æ„å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[React Element] --&gt;|createFiber| B[Fiber èŠ‚ç‚¹]
    B --&gt;|child/sibling é“¾è¡¨| C[Fiber æ ‘]
    C --&gt;|performUnitOfWork| D[Function Component æ‰§è¡Œ]
    D --&gt;|è°ƒç”¨ Hooks| E[Hooks çŠ¶æ€å­˜å‚¨åœ¨ Fiber.hooks]
    B --&gt;|createDom| F[çœŸå® DOM èŠ‚ç‚¹]
    C --&gt;|commitEffects| G[useEffect æ‰§è¡Œ]
    H[æ›´æ–°æ“ä½œ] --&gt;|setState/useMemo ç­‰| B
    E --&gt;|è¯»å–/ä¿®æ”¹| D
    F --&gt;|æŒ‚è½½åˆ°çˆ¶ DOM| DOM[é¡µé¢ DOM]

    style A fill:#f9f,stroke:#333,stroke-width:1px
    style B fill:#bbf,stroke:#333,stroke-width:1px
    style C fill:#bfb,stroke:#333,stroke-width:1px
    style D fill:#ffb,stroke:#333,stroke-width:1px
    style E fill:#fbf,stroke:#333,stroke-width:1px
    style F fill:#fbb,stroke:#333,stroke-width:1px
    style G fill:#bff,stroke:#333,stroke-width:1px
    style H fill:#eee,stroke:#333,stroke-width:1px
</code></pre>
<h4 data-id="heading-4">æ‰§è¡Œé¡ºåº</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    %% åˆæ¬¡æ¸²æŸ“
    A["render(TodoApp)"] --&gt; B["åˆ›å»ºæ ¹ Fiber"]
    B --&gt; C["performUnitOfWork(æ ¹ Fiber)"]
    C --&gt; D{"Fiber.type æ˜¯å¦ä¸ºå‡½æ•°ç»„ä»¶?"}
    D -- æ˜¯ --&gt; E["è®¾ç½® wipFiber=å½“å‰ Fiber, hookIndex=0, hooks=[]"]
    E --&gt; F["æ‰§è¡Œ TodoApp(props)"]

    %% useState
    F --&gt; G["è°ƒç”¨ useState(0)"]
    G --&gt; H["æ£€æŸ¥ oldHook æ˜¯å¦å­˜åœ¨"]
    H --&gt; I{"é¦–æ¬¡æ¸²æŸ“? (oldHook ä¸ºç©º)"}
    I -- æ˜¯ --&gt; J["åˆ›å»ºæ–° Hook {state=0, queue=[]}"]
    I -- å¦ --&gt; K["åº”ç”¨é˜Ÿåˆ—æ›´æ–°è®¡ç®—æœ€æ–° state"]
    J --&gt; L["hookIndex++ è¿”å› state, setState"]
    K --&gt; L

    %% useMemo
    L --&gt; M["è°ƒç”¨ useMemo(() =&gt; count*2, [count])"]
    M --&gt; N["æ£€æŸ¥ oldHook æ˜¯å¦å­˜åœ¨å¹¶æ¯”è¾ƒ deps"]
    N --&gt; O{"ä¾èµ–æ˜¯å¦å˜åŒ–?"}
    O -- æ˜¯ --&gt; P["æ‰§è¡Œ factory() è®¡ç®—æ–° value"]
    O -- å¦ --&gt; Q["å¤ç”¨ä¸Šä¸€æ¬¡ value"]
    P --&gt; R["hookIndex++ è¿”å› memo value"]
    Q --&gt; R

    %% useEffect
    R --&gt; S["è°ƒç”¨ useEffect(..., [count])"]
    S --&gt; T["æ£€æŸ¥ oldHook æ˜¯å¦å­˜åœ¨å¹¶æ¯”è¾ƒ deps"]
    T --&gt; U{"ä¾èµ–æ˜¯å¦å˜åŒ–?"}
    U -- æ˜¯ --&gt; V["å°† effect æ”¾å…¥ pendingEffects é˜Ÿåˆ—"]
    U -- å¦ --&gt; W["ä¸æ”¶é›† effect"]
    V --&gt; X["hookIndex++"]
    W --&gt; X

    %% è¿”å› JSX
    X --&gt; Y["è¿”å›å­ Element: div &gt; h3/p/button"]
    Y --&gt; Z["reconcileChildren åˆ›å»ºå­ Fiber"]
    Z --&gt; AA{"fiber.child æ˜¯å¦å­˜åœ¨?"}
    AA -- æ˜¯ --&gt; C
    AA -- å¦ --&gt; AB["å¤„ç† sibling æˆ–å›åˆ° parent"]
    AB --&gt; AC["commit é˜¶æ®µ: æŒ‚è½½ DOM"]
    AC --&gt; AD["æ‰§è¡Œ pendingEffects ä¸­çš„ useEffect"]

    %% ç”¨æˆ·ç‚¹å‡» button
    AD --&gt; AE["ç”¨æˆ·ç‚¹å‡» button è°ƒç”¨ setCount(c =&gt; c+1)"]
    AE --&gt; AF["å…¥é˜Ÿæ›´æ–° Hook.queue"]
    AF --&gt; AG["rerender() é‡ç½® hookIndex=0, æ‰§è¡Œ TodoApp"]
    AG --&gt; G

    style A fill:#f9f,stroke:#333
    style B fill:#bbf,stroke:#333
    style C fill:#bfb,stroke:#333
    style D fill:#ffb,stroke:#333
    style E fill:#fbf,stroke:#333
    style F fill:#fbb,stroke:#333
    style G fill:#bff,stroke:#333
    style H fill:#ffe,stroke:#333
    style I fill:#eef,stroke:#333
    style J fill:#ddd,stroke:#333
    style K fill:#ccd,stroke:#333
    style L fill:#ffd,stroke:#333
    style M fill:#cff,stroke:#333
    style N fill:#ecf,stroke:#333
    style O fill:#fcf,stroke:#333
    style P fill:#ffc,stroke:#333
    style Q fill:#eef,stroke:#333
    style R fill:#ddf,stroke:#333
    style S fill:#fdd,stroke:#333
    style T fill:#def,stroke:#333
    style U fill:#ffd,stroke:#333
    style V fill:#cfc,stroke:#333
    style W fill:#eee,stroke:#333
    style X fill:#fdf,stroke:#333
    style Y fill:#f9f,stroke:#333
    style Z fill:#bbf,stroke:#333
    style AA fill:#bfb,stroke:#333
    style AB fill:#ffb,stroke:#333
    style AC fill:#fbf,stroke:#333
    style AD fill:#fbb,stroke:#333
    style AE fill:#bff,stroke:#333
    style AF fill:#ffe,stroke:#333
    style AG fill:#def,stroke:#333
</code></pre>
<h3 data-id="heading-5">Element å±‚ï¼ˆè™šæ‹Ÿ DOMï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-params">type, props, ...children</span>) {
    <span class="hljs-keyword">return</span> {
        type,
        <span class="hljs-attr">props</span>: {
            ...props,
            <span class="hljs-attr">children</span>: children.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span>
                <span class="hljs-keyword">typeof</span> child === <span class="hljs-string">"object"</span> ? child : <span class="hljs-title function_">createTextElement</span>(child)
            ),
        },
    };
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createTextElement</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"TEXT"</span>,
        <span class="hljs-attr">props</span>: {
            <span class="hljs-attr">nodeValue</span>: text,
            <span class="hljs-attr">children</span>: [],
        },
    };
}
</code></pre>
<ul>
<li><code>createElement</code>ï¼šç”Ÿæˆè™šæ‹Ÿ DOM å¯¹è±¡</li>
<li><code>createTextElement</code>ï¼šå°†å­—ç¬¦ä¸²æˆ–æ•°å­—åŒ…è£…æˆæ–‡æœ¬èŠ‚ç‚¹</li>
<li>æ‰€æœ‰å­èŠ‚ç‚¹ç»Ÿä¸€æˆå¯¹è±¡å½¢å¼ï¼Œæ–¹ä¾¿ Fiber éå†</li>
</ul>
<hr/>
<h3 data-id="heading-6">Fiber å±‚ï¼ˆè¿è¡Œæ—¶å®ä¾‹ï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createFiber</span>(<span class="hljs-params">element, parent</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: element.<span class="hljs-property">type</span>,
        <span class="hljs-attr">props</span>: element.<span class="hljs-property">props</span>,
        parent,
        <span class="hljs-attr">child</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">sibling</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">dom</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">alternate</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">hooks</span>: <span class="hljs-literal">null</span>,
    };
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDom</span>(<span class="hljs-params">fiber</span>) {
    <span class="hljs-keyword">if</span> (fiber.<span class="hljs-property">type</span> === <span class="hljs-string">"TEXT"</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(fiber.<span class="hljs-property">props</span>.<span class="hljs-property">nodeValue</span> || <span class="hljs-string">""</span>);
    <span class="hljs-keyword">const</span> dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(fiber.<span class="hljs-property">type</span>);
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(fiber.<span class="hljs-property">props</span>)
        .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> key !== <span class="hljs-string">"children"</span>)
        .<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> dom[name] = fiber.<span class="hljs-property">props</span>[name]);
    <span class="hljs-keyword">return</span> dom;
}
</code></pre>
<ul>
<li>æ¯ä¸ª Fiber å¯¹åº”ä¸€ä¸ªç»„ä»¶æˆ– DOM èŠ‚ç‚¹</li>
<li><code>alternate</code> ç”¨äºä¿å­˜ä¸Šä¸€æ¬¡æ¸²æŸ“çš„ Fiberï¼Œå®ç°çŠ¶æ€å¤ç”¨</li>
<li><code>hooks</code> ä¿å­˜å½“å‰ç»„ä»¶çš„æ‰€æœ‰ hooks</li>
</ul>
<hr/>
<h3 data-id="heading-7">Render é˜¶æ®µï¼ˆFiber æ„å»ºï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">performUnitOfWork</span>(<span class="hljs-params">fiber</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fiber.<span class="hljs-property">type</span> === <span class="hljs-string">"function"</span>) {
        wipFiber = fiber;
        hookIndex = <span class="hljs-number">0</span>;
        wipFiber.<span class="hljs-property">hooks</span> = [];
        <span class="hljs-keyword">const</span> children = [fiber.<span class="hljs-title function_">type</span>(fiber.<span class="hljs-property">props</span>)];
        <span class="hljs-title function_">reconcileChildren</span>(fiber, children);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (!fiber.<span class="hljs-property">dom</span>) fiber.<span class="hljs-property">dom</span> = <span class="hljs-title function_">createDom</span>(fiber);
        <span class="hljs-keyword">const</span> parentDom = <span class="hljs-title function_">getParentDom</span>(fiber);
        <span class="hljs-keyword">if</span> (parentDom) parentDom.<span class="hljs-title function_">appendChild</span>(fiber.<span class="hljs-property">dom</span>);
        <span class="hljs-title function_">reconcileChildren</span>(fiber, fiber.<span class="hljs-property">props</span>.<span class="hljs-property">children</span> || []);
    }

    <span class="hljs-keyword">if</span> (fiber.<span class="hljs-property">child</span>) <span class="hljs-keyword">return</span> fiber.<span class="hljs-property">child</span>;
    <span class="hljs-keyword">let</span> next = fiber;
    <span class="hljs-keyword">while</span> (next) {
        <span class="hljs-keyword">if</span> (next.<span class="hljs-property">sibling</span>) <span class="hljs-keyword">return</span> next.<span class="hljs-property">sibling</span>;
        next = next.<span class="hljs-property">parent</span>;
    }
}
</code></pre>
<ul>
<li>å¯¹ Function Component æ‰§è¡Œç»„ä»¶å‡½æ•°å¹¶æ”¶é›† hooks</li>
<li>å¯¹ DOM èŠ‚ç‚¹åˆ›å»ºçœŸå® DOM å¹¶æŒ‚è½½</li>
<li>æ·±åº¦ä¼˜å…ˆéå† Fiber æ ‘</li>
</ul>
<hr/>
<h3 data-id="heading-8">Hooks å®ç°</h3>
<h4 data-id="heading-9">useState</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useState</span>(<span class="hljs-params">initialState</span>) {
    <span class="hljs-keyword">const</span> oldHook = wipFiber.<span class="hljs-property">alternate</span>?.<span class="hljs-property">hooks</span>?.[hookIndex];
    <span class="hljs-keyword">const</span> hook = { <span class="hljs-attr">state</span>: oldHook ? oldHook.<span class="hljs-property">state</span> : initialState, <span class="hljs-attr">queue</span>: [] };
    (oldHook?.<span class="hljs-property">queue</span> || []).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> {
        hook.<span class="hljs-property">state</span> = <span class="hljs-keyword">typeof</span> action === <span class="hljs-string">"function"</span> ? <span class="hljs-title function_">action</span>(hook.<span class="hljs-property">state</span>) : action;
    });
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">setState</span> = action =&gt; { hook.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(action); <span class="hljs-title function_">rerender</span>(); };
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
    <span class="hljs-keyword">return</span> [hook.<span class="hljs-property">state</span>, setState];
}
</code></pre>
<ul>
<li>state ä¿å­˜åœ¨ Fiber.hooks ä¸­</li>
<li>é€šè¿‡ hookIndex ä¿è¯é¡ºåº</li>
<li>setState å…¥é˜Ÿå¹¶è§¦å‘ rerender</li>
</ul>
<h4 data-id="heading-10">useEffect</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useEffect</span>(<span class="hljs-params">effect, deps</span>) {
    <span class="hljs-keyword">const</span> oldHook = wipFiber.<span class="hljs-property">alternate</span>?.<span class="hljs-property">hooks</span>?.[hookIndex];
    <span class="hljs-keyword">let</span> hasChanged = !oldHook || !deps || deps.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">d,i</span>) =&gt;</span> !<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(d, oldHook.<span class="hljs-property">deps</span>[i]));
    <span class="hljs-keyword">const</span> hook = { effect, deps, <span class="hljs-attr">cleanup</span>: oldHook?.<span class="hljs-property">cleanup</span> };
    <span class="hljs-keyword">if</span> (hasChanged) pendingEffects.<span class="hljs-title function_">push</span>(hook);
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
}
</code></pre>
<ul>
<li>render é˜¶æ®µæ”¶é›† effect</li>
<li>commit é˜¶æ®µç»Ÿä¸€æ‰§è¡Œ</li>
<li>deps ä¸å˜æ—¶è·³è¿‡</li>
</ul>
<h4 data-id="heading-11">useRef</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useRef</span>(<span class="hljs-params">initialValue</span>) {
    <span class="hljs-keyword">const</span> oldHook = wipFiber.<span class="hljs-property">alternate</span>?.<span class="hljs-property">hooks</span>?.[hookIndex];
    <span class="hljs-keyword">const</span> hook = { <span class="hljs-attr">current</span>: oldHook ? oldHook.<span class="hljs-property">current</span> : initialValue };
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
    <span class="hljs-keyword">return</span> hook;
}
</code></pre>
<ul>
<li>è¿”å›ç¨³å®šå¼•ç”¨</li>
<li>ä¿®æ”¹ current ä¸è§¦å‘ rerender</li>
</ul>
<h4 data-id="heading-12">useMemo</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useMemo</span>(<span class="hljs-params">factory, deps</span>) {
    <span class="hljs-keyword">const</span> oldHook = wipFiber.<span class="hljs-property">alternate</span>?.<span class="hljs-property">hooks</span>?.[hookIndex];
    <span class="hljs-keyword">const</span> hasChanged = !oldHook || !deps || deps.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">d,i</span>) =&gt;</span> !<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(d, oldHook.<span class="hljs-property">deps</span>[i]));
    <span class="hljs-keyword">const</span> hook = { <span class="hljs-attr">value</span>: hasChanged ? <span class="hljs-title function_">factory</span>() : oldHook.<span class="hljs-property">value</span>, deps };
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
    <span class="hljs-keyword">return</span> hook.<span class="hljs-property">value</span>;
}
</code></pre>
<ul>
<li>ç¼“å­˜è®¡ç®—ç»“æœ</li>
<li>deps ä¸å˜æ—¶è¿”å›ä¸Šæ¬¡ç»“æœ</li>
</ul>
<h4 data-id="heading-13">useContext</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useContext</span>(<span class="hljs-params">context</span>) {
    <span class="hljs-keyword">const</span> hook = { <span class="hljs-attr">value</span>: context.<span class="hljs-property">_currentValue</span> };
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
    <span class="hljs-keyword">return</span> hook.<span class="hljs-property">value</span>;
}
</code></pre>
<ul>
<li>è¯»å– context._currentValue</li>
<li>è¿™æ˜¯ä¸€ä¸ªæç®€å®ç°ï¼Œä¸æ”¯æŒåµŒå¥— Provider</li>
</ul>
<hr/>
<h3 data-id="heading-14">Demo ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">TodoApp</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">const</span> double = <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> count * <span class="hljs-number">2</span>, [count]);
    <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count), [count]);

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(
        <span class="hljs-string">"div"</span>,
        <span class="hljs-literal">null</span>,
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"h3"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"Count: "</span>, count),
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"Double: "</span>, double),
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(
            <span class="hljs-string">"button"</span>,
            { <span class="hljs-attr">onclick</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>) },
            <span class="hljs-string">"Add"</span>
        )
    );
}

<span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">render</span>(<span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">TodoApp</span>, <span class="hljs-literal">null</span>), <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"root"</span>));
</code></pre>
<ul>
<li>æ¼”ç¤ºäº† useStateã€useEffectã€useMemo</li>
<li>æ¯æ¬¡ç‚¹å‡»æŒ‰é’®éƒ½ä¼šè§¦å‘ rerender</li>
</ul>
<hr/>
<h3 data-id="heading-15">æ€»ç»“</h3>
<p>é€šè¿‡è¿™ä¸ª Mini React Runtimeï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ï¼š</p>
<ol>
<li><strong>Fiber æ ‘çš„ä½œç”¨</strong>ï¼šç®¡ç†ç»„ä»¶å®ä¾‹å’Œ hooks</li>
<li><strong>Hooks çš„åŸç†</strong>ï¼šä¾èµ–è°ƒç”¨é¡ºåºå’Œ Fiber å­˜å‚¨</li>
<li><strong>render é˜¶æ®µ vs commit é˜¶æ®µ</strong>ï¼šrender åªæ˜¯æ„å»º Fiberï¼Œä¸æ“ä½œ DOMï¼›commit æ‰çœŸæ­£æ›´æ–° DOM</li>
<li><strong>æœ€å°åŒ–å®ç°è¶³å¤Ÿæ•™å­¦</strong>ï¼Œå¯ä»¥é€æ­¥æ‰©å±•æ”¯æŒ diff ç®—æ³•ã€å¼‚æ­¥æ¸²æŸ“ã€useLayoutEffect ç­‰</li>
</ol>
<blockquote>
<p>è¿™æ˜¯ç†è§£ React Hooks å’Œ Fiber å†…éƒ¨æœºåˆ¶çš„ç»ä½³å…¥é—¨æ¡ˆä¾‹ã€‚</p>
</blockquote>
<p>å¯ä»¥ä»”ç»†é˜…è¯»ä¸‹é¢æºç æ³¨é‡Šå†™çš„éå¸¸æ¸…æ¥š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**************************************************************
 * Mini React Runtime (Fiber + Hooks)
 *
 * è¿™æ˜¯ä¸€ä¸ªæ•™å­¦ç”¨é€”çš„ã€Œæœ€å°å¯è¿è¡Œ React å†…æ ¸ã€
 * ç›®æ ‡ï¼šå¸®åŠ©ä½ **å®Œæ•´ç†è§£ React Fiber + Hooks çš„è¿è¡Œæœºåˆ¶**
 *
 * ç‰¹ç‚¹ï¼š
 * - åŒæ­¥ renderï¼ˆæ— å¹¶å‘ã€æ— æ—¶é—´åˆ‡ç‰‡ï¼‰
 * - Fiber æ ‘ç»“æ„
 * - Hooks åŸºäºã€Œè°ƒç”¨é¡ºåºã€å®ç°
 * - æ”¯æŒ useState / useEffect / useRef / useMemo / useContext
 **************************************************************/</span>

<span class="hljs-comment">/**************************************************************
 * å…¨å±€è¿è¡Œæ—¶çŠ¶æ€ï¼ˆéå¸¸å…³é”®ï¼‰
 **************************************************************/</span>

<span class="hljs-keyword">let</span> wipFiber = <span class="hljs-literal">null</span>;
<span class="hljs-comment">// å½“å‰æ­£åœ¨ render çš„ Function Component å¯¹åº”çš„ Fiber</span>
<span class="hljs-comment">// Hooks çš„æ‰€æœ‰è¯»å†™éƒ½ä¾èµ–å®ƒ</span>

<span class="hljs-keyword">let</span> hookIndex = <span class="hljs-number">0</span>;
<span class="hljs-comment">// å½“å‰ç»„ä»¶ render è¿‡ç¨‹ä¸­ï¼Œç¬¬å‡ ä¸ª hook</span>
<span class="hljs-comment">// useState/useEffect/... å…¨éƒ¨ä¾èµ–ã€Œè°ƒç”¨é¡ºåºã€</span>

<span class="hljs-keyword">let</span> currentRoot = <span class="hljs-literal">null</span>;
<span class="hljs-comment">// å·²ç» commit çš„æ ¹ Fiber</span>
<span class="hljs-comment">// rerender æ—¶ä½œä¸º alternateï¼ˆæ—§ Fiber æ ‘ï¼‰</span>
<span class="hljs-comment">// ç”¨æ¥ä¿å­˜å·²ç»æäº¤çš„Fiberæ ‘ï¼Œä¸‹ä¸€æ¬¡renderæ—¶å€™æŠŠæ–°çš„rootFiberçš„alternateæŒ‡å‘å®ƒ</span>

<span class="hljs-keyword">let</span> pendingEffects = [];
<span class="hljs-comment">// render é˜¶æ®µæ”¶é›†çš„æ‰€æœ‰ useEffect</span>
<span class="hljs-comment">// ä¼šåœ¨ commit é˜¶æ®µç»Ÿä¸€æ‰§è¡Œ</span>


<span class="hljs-comment">/**************************************************************
 * Element å±‚ï¼ˆè™šæ‹Ÿ DOMï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * createElement
 * ç”¨äºåˆ›å»º React Elementï¼ˆè™šæ‹ŸèŠ‚ç‚¹ï¼‰
 *
 * ç­‰ä»·äºï¼š
 *   React.createElement(type, props, ...children)
 *
 * React Element æ˜¯ä¸€ä¸ªã€Œçº¯æè¿°å¯¹è±¡ã€
 * å¹¶ä¸ä¼šç›´æ¥å‚ä¸æ¸²æŸ“
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-params">type, props, ...children</span>) {
    <span class="hljs-keyword">return</span> {
        type, <span class="hljs-comment">// stringï¼ˆdivï¼‰æˆ– functionï¼ˆç»„ä»¶ï¼‰</span>
        <span class="hljs-attr">props</span>: {
            ...props,
            <span class="hljs-comment">// children å¿…é¡»ç»Ÿä¸€æˆ object</span>
            <span class="hljs-attr">children</span>: children.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span>
                <span class="hljs-keyword">typeof</span> child === <span class="hljs-string">"object"</span>
                    ? child
                    : <span class="hljs-title function_">createTextElement</span>(child)
            ),
        },
    };
}

<span class="hljs-comment">/**
 * createTextElement
 * å°†å­—ç¬¦ä¸² / æ•°å­—åŒ…è£…æˆ TEXT ç±»å‹çš„ Element
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createTextElement</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"TEXT"</span>,
        <span class="hljs-attr">props</span>: {
            <span class="hljs-attr">nodeValue</span>: text,
            <span class="hljs-attr">children</span>: [],
        },
    };
}


<span class="hljs-comment">/**************************************************************
 * Fiber å±‚ï¼ˆè¿è¡Œæ—¶å®ä¾‹ï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * createFiber
 *
 * Fiber æ˜¯ React è¿è¡Œæ—¶çš„æ ¸å¿ƒæ•°æ®ç»“æ„
 * æ¯ä¸€ä¸ª Fiber â‰ˆ ä¸€ä¸ªç»„ä»¶/DOM å®ä¾‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createFiber</span>(<span class="hljs-params">element, parent</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: element.<span class="hljs-property">type</span>,     <span class="hljs-comment">// ç»„ä»¶å‡½æ•° or DOM æ ‡ç­¾</span>
        <span class="hljs-attr">props</span>: element.<span class="hljs-property">props</span>,   <span class="hljs-comment">// props</span>
        parent,                 <span class="hljs-comment">// çˆ¶ Fiber</span>
        <span class="hljs-attr">child</span>: <span class="hljs-literal">null</span>,            <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå­ Fiber</span>
        <span class="hljs-attr">sibling</span>: <span class="hljs-literal">null</span>,          <span class="hljs-comment">// ä¸‹ä¸€ä¸ªå…„å¼Ÿ Fiber</span>
        <span class="hljs-attr">dom</span>: <span class="hljs-literal">null</span>,              <span class="hljs-comment">// å¯¹åº”çš„çœŸå® DOM</span>
        <span class="hljs-attr">alternate</span>: <span class="hljs-literal">null</span>,        <span class="hljs-comment">// ä¸Šä¸€æ¬¡ render çš„ Fiber</span>
        <span class="hljs-attr">hooks</span>: <span class="hljs-literal">null</span>,            <span class="hljs-comment">// hooks æ•°ç»„ï¼ˆFunction Component ä¸“å±ï¼‰</span>
    };
}

<span class="hljs-comment">/**
 * createDom
 * æ ¹æ® Fiber åˆ›å»ºçœŸå® DOM èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDom</span>(<span class="hljs-params">fiber</span>) {
    <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (fiber.<span class="hljs-property">type</span> === <span class="hljs-string">"TEXT"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(fiber.<span class="hljs-property">props</span>.<span class="hljs-property">nodeValue</span> ?? <span class="hljs-string">""</span>);
    }

    <span class="hljs-comment">// æ™®é€š DOM èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(fiber.<span class="hljs-property">type</span>);

    <span class="hljs-comment">// å°† props æ˜ å°„åˆ° DOM ä¸Šï¼ˆäº‹ä»¶ã€å±æ€§ï¼‰</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(fiber.<span class="hljs-property">props</span>)
        .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> key !== <span class="hljs-string">"children"</span>)
        .<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> {
            dom[name] = fiber.<span class="hljs-property">props</span>[name];
        });

    <span class="hljs-keyword">return</span> dom;
}


<span class="hljs-comment">/**************************************************************
 * Fiber æ„å»ºï¼ˆreconcileï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * reconcileChildren
 *
 * æ ¹æ® element åˆ—è¡¨æ„å»º Fiber.child / Fiber.sibling é“¾è¡¨
 *
 * åŒæ—¶ï¼š
 * - å°è¯•å¤ç”¨ oldFiberï¼ˆalternateï¼‰
 * - ä¿è¯ hooks èƒ½å¤Ÿè·¨ render å¤ç”¨
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reconcileChildren</span>(<span class="hljs-params">fiber, elements = []</span>) {
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> prevSibling = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// ä¸Šä¸€æ¬¡ render çš„ç¬¬ä¸€ä¸ªå­ Fiber</span>
    <span class="hljs-keyword">let</span> oldFiber = fiber.<span class="hljs-property">alternate</span> &amp;&amp; fiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">child</span>;

    <span class="hljs-keyword">while</span> (index &lt; elements.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> element = elements[index];
        <span class="hljs-keyword">if</span> (!element) {
            index++;
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-comment">// ä¸º element åˆ›å»ºæ–°çš„ Fiber</span>
        <span class="hljs-keyword">const</span> newFiber = <span class="hljs-title function_">createFiber</span>(element, fiber);

        <span class="hljs-comment">// å…³è”æ—§ Fiberï¼ˆç”¨äº hooks / state å¤ç”¨ï¼‰</span>
        <span class="hljs-keyword">if</span> (oldFiber) {
            newFiber.<span class="hljs-property">alternate</span> = oldFiber;
            oldFiber = oldFiber.<span class="hljs-property">sibling</span>;
        }

        <span class="hljs-comment">// æ„å»º child / sibling é“¾è¡¨</span>
        <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) {
            fiber.<span class="hljs-property">child</span> = newFiber;
        } <span class="hljs-keyword">else</span> {
            prevSibling.<span class="hljs-property">sibling</span> = newFiber;
        }

        prevSibling = newFiber;
        index++;
    }
}

<span class="hljs-comment">/**
 * getParentDom
 * å‘ä¸ŠæŸ¥æ‰¾æœ€è¿‘çš„ Host Fiberï¼ˆæœ‰ dom çš„ Fiberï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getParentDom</span>(<span class="hljs-params">fiber</span>) {
    <span class="hljs-keyword">let</span> parent = fiber.<span class="hljs-property">parent</span>;
    <span class="hljs-keyword">while</span> (parent &amp;&amp; !parent.<span class="hljs-property">dom</span>) {
        parent = parent.<span class="hljs-property">parent</span>;
    }
    <span class="hljs-keyword">return</span> parent ? parent.<span class="hljs-property">dom</span> : <span class="hljs-literal">null</span>;
}


<span class="hljs-comment">/**************************************************************
 * Render é˜¶æ®µï¼ˆFiber æ„å»ºï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * performUnitOfWork
 *
 * Fiber æ„å»ºçš„æ ¸å¿ƒè°ƒåº¦å‡½æ•°
 * é‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼ˆDFSï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">performUnitOfWork</span>(<span class="hljs-params">fiber</span>) {

    <span class="hljs-comment">/******** Function Component ********/</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fiber.<span class="hljs-property">type</span> === <span class="hljs-string">"function"</span>) {

        <span class="hljs-comment">// æ ‡è®°å½“å‰æ­£åœ¨ render çš„ Fiber</span>
        wipFiber = fiber;

        <span class="hljs-comment">// hooks ä» 0 å¼€å§‹</span>
        hookIndex = <span class="hljs-number">0</span>;

        <span class="hljs-comment">// åˆå§‹åŒ– hooks å®¹å™¨</span>
        wipFiber.<span class="hljs-property">hooks</span> = [];

        <span class="hljs-comment">// æ‰§è¡Œç»„ä»¶å‡½æ•°ï¼ˆrender é˜¶æ®µï¼‰</span>
        <span class="hljs-keyword">const</span> children = [fiber.<span class="hljs-title function_">type</span>(fiber.<span class="hljs-property">props</span>)];

        <span class="hljs-comment">// æ ¹æ®è¿”å›çš„ element æ„å»ºå­ Fiber</span>
        <span class="hljs-title function_">reconcileChildren</span>(fiber, children);
    }

    <span class="hljs-comment">/******** Host Componentï¼ˆDOMï¼‰ ********/</span>
    <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// åˆ›å»º DOM</span>
        <span class="hljs-keyword">if</span> (!fiber.<span class="hljs-property">dom</span>) {
            fiber.<span class="hljs-property">dom</span> = <span class="hljs-title function_">createDom</span>(fiber);
        }

        <span class="hljs-comment">// æŒ‚è½½åˆ°çˆ¶ DOM</span>
        <span class="hljs-keyword">const</span> parentDom = <span class="hljs-title function_">getParentDom</span>(fiber);
        <span class="hljs-keyword">if</span> (parentDom) {
            parentDom.<span class="hljs-title function_">appendChild</span>(fiber.<span class="hljs-property">dom</span>);
        }

        <span class="hljs-comment">// ç»§ç»­å‘ä¸‹æ„å»º</span>
        <span class="hljs-title function_">reconcileChildren</span>(fiber, fiber.<span class="hljs-property">props</span>.<span class="hljs-property">children</span> || []);
    }

    <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†</span>
    <span class="hljs-keyword">if</span> (fiber.<span class="hljs-property">child</span>) <span class="hljs-keyword">return</span> fiber.<span class="hljs-property">child</span>;

    <span class="hljs-keyword">let</span> next = fiber;
    <span class="hljs-keyword">while</span> (next) {
        <span class="hljs-keyword">if</span> (next.<span class="hljs-property">sibling</span>) <span class="hljs-keyword">return</span> next.<span class="hljs-property">sibling</span>;
        next = next.<span class="hljs-property">parent</span>;
    }
}


<span class="hljs-comment">/**************************************************************
 * render å…¥å£
 **************************************************************/</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">element, container</span>) {

    <span class="hljs-keyword">const</span> rootFiber = {
        <span class="hljs-attr">dom</span>: container,
        <span class="hljs-attr">props</span>: { <span class="hljs-attr">children</span>: [element] },
        <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">child</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">sibling</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">alternate</span>: currentRoot, <span class="hljs-comment">// æ—§ Fiber æ ‘</span>
    };

    currentRoot = rootFiber;

    <span class="hljs-keyword">let</span> nextUnitOfWork = rootFiber;
    <span class="hljs-keyword">while</span> (nextUnitOfWork) {
        nextUnitOfWork = <span class="hljs-title function_">performUnitOfWork</span>(nextUnitOfWork);
    }

    <span class="hljs-comment">// commit é˜¶æ®µ</span>
    <span class="hljs-title function_">commitEffects</span>();
}

<span class="hljs-comment">/**
 * rerender
 * æ‰€æœ‰ setState çš„æœ€ç»ˆè§¦å‘ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">rerender</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> container = currentRoot.<span class="hljs-property">dom</span>;
    container.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">""</span>;
    <span class="hljs-title function_">render</span>(currentRoot.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>], container);
}


<span class="hljs-comment">/**************************************************************
 * Hooks å®ç°
 **************************************************************/</span>

<span class="hljs-comment">/**
 * useState
 *
 * åŸç†æ€»ç»“ï¼š
 * 1. state å­˜å‚¨åœ¨ fiber.hooks ä¸­
 * 2. é€šè¿‡ hookIndex ä¿è¯é¡ºåºä¸€è‡´
 * 3. setState åªæ˜¯å…¥é˜Ÿï¼Œä¸ç«‹å³æ›´æ–°
 * 4. rerender æ—¶ç»Ÿä¸€è®¡ç®—æ–° state
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useState</span>(<span class="hljs-params">initialState</span>) {

    <span class="hljs-comment">// æ‰¾åˆ°æ—§ hook</span>
    <span class="hljs-keyword">const</span> oldHook =
        wipFiber.<span class="hljs-property">alternate</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span>[hookIndex];

    <span class="hljs-comment">// åˆå§‹åŒ– hook</span>
    <span class="hljs-keyword">const</span> hook = {
        <span class="hljs-attr">state</span>: oldHook ? oldHook.<span class="hljs-property">state</span> : initialState,
        <span class="hljs-attr">queue</span>: [],
    };

    <span class="hljs-comment">// æ‰§è¡Œä¸Šä¸€æ¬¡ setState å…¥é˜Ÿçš„ action</span>
    <span class="hljs-keyword">const</span> actions = oldHook ? oldHook.<span class="hljs-property">queue</span> : [];
    actions.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> {
        <span class="hljs-comment">// è·å–æœ€æ–°çŠ¶æ€</span>
        hook.<span class="hljs-property">state</span> =
            <span class="hljs-keyword">typeof</span> action === <span class="hljs-string">"function"</span>
                ? <span class="hljs-title function_">action</span>(hook.<span class="hljs-property">state</span>)
                : action;
    });

    <span class="hljs-comment">// setState å®ç°</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">setState</span> = action =&gt; {
        <span class="hljs-comment">// å‘ä¹‹å‰çš„wipFiberå¯¹åº”çš„hookçš„queueä¸­æ·»åŠ action</span>
        hook.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(action);
        <span class="hljs-title function_">rerender</span>();
    };

    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;

    <span class="hljs-keyword">return</span> [hook.<span class="hljs-property">state</span>, setState];
}


<span class="hljs-comment">/**
 * useEffect
 *
 * æ ¸å¿ƒæ€æƒ³ï¼š
 * - render é˜¶æ®µåªæ”¶é›†
 * - commit é˜¶æ®µç»Ÿä¸€æ‰§è¡Œ
 * - deps æ§åˆ¶æ˜¯å¦é‡æ–°æ‰§è¡Œ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useEffect</span>(<span class="hljs-params">effect, deps</span>) {

    <span class="hljs-keyword">const</span> oldHook =
        wipFiber.<span class="hljs-property">alternate</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span>[hookIndex];

    <span class="hljs-keyword">let</span> hasChanged = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// deps å¯¹æ¯”</span>
    <span class="hljs-keyword">if</span> (oldHook &amp;&amp; deps) {
        hasChanged = deps.<span class="hljs-title function_">some</span>(
            <span class="hljs-function">(<span class="hljs-params">dep, i</span>) =&gt;</span> !<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(dep, oldHook.<span class="hljs-property">deps</span>[i])
        );
    }

    <span class="hljs-keyword">const</span> hook = {
        effect,                <span class="hljs-comment">// å‰¯ä½œç”¨å‡½æ•°</span>
        deps,                  <span class="hljs-comment">// ä¾èµ–</span>
        <span class="hljs-attr">cleanup</span>: oldHook ? oldHook.<span class="hljs-property">cleanup</span> : <span class="hljs-literal">null</span>,
    };

    <span class="hljs-keyword">if</span> (hasChanged) {
        pendingEffects.<span class="hljs-title function_">push</span>(hook);
    }

    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
}


<span class="hljs-comment">/**
 * commitEffects
 * effect çš„çœŸæ­£æ‰§è¡Œé˜¶æ®µ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">commitEffects</span>(<span class="hljs-params"/>) {
    pendingEffects.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">hook</span> =&gt;</span> {

        <span class="hljs-comment">// å…ˆæ‰§è¡Œä¸Šä¸€æ¬¡ cleanup</span>
        <span class="hljs-keyword">if</span> (hook.<span class="hljs-property">cleanup</span>) {
            hook.<span class="hljs-title function_">cleanup</span>();
        }

        <span class="hljs-comment">// å†æ‰§è¡Œ effect</span>
        <span class="hljs-keyword">const</span> cleanup = hook.<span class="hljs-title function_">effect</span>();

        <span class="hljs-comment">// ä¿å­˜ cleanup</span>
        hook.<span class="hljs-property">cleanup</span> = <span class="hljs-keyword">typeof</span> cleanup === <span class="hljs-string">"function"</span> ? cleanup : <span class="hljs-literal">null</span>;
    });

    pendingEffects = [];
}


<span class="hljs-comment">/**
 * useRef
 *
 * ç‰¹ç‚¹ï¼š
 * - è¿”å›ç¨³å®šå¼•ç”¨
 * - ä¿®æ”¹ current ä¸ä¼šè§¦å‘ render
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useRef</span>(<span class="hljs-params">initialValue</span>) {
    <span class="hljs-keyword">const</span> oldHook =
        wipFiber.<span class="hljs-property">alternate</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span>[hookIndex];

    <span class="hljs-keyword">const</span> hook = {
        <span class="hljs-attr">current</span>: oldHook ? oldHook.<span class="hljs-property">current</span> : initialValue,
    };

    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;

    <span class="hljs-keyword">return</span> hook;
}


<span class="hljs-comment">/**
 * useMemo
 *
 * ä½œç”¨ï¼š
 * - ç¼“å­˜è®¡ç®—ç»“æœ
 * - deps ä¸å˜æ—¶å¤ç”¨
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useMemo</span>(<span class="hljs-params">factory, deps</span>) {
    <span class="hljs-keyword">const</span> oldHook =
        wipFiber.<span class="hljs-property">alternate</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span> &amp;&amp;
        wipFiber.<span class="hljs-property">alternate</span>.<span class="hljs-property">hooks</span>[hookIndex];

    <span class="hljs-keyword">let</span> hasChanged = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">if</span> (oldHook &amp;&amp; deps) {
        hasChanged = deps.<span class="hljs-title function_">some</span>(
            <span class="hljs-function">(<span class="hljs-params">dep, i</span>) =&gt;</span> !<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(dep, oldHook.<span class="hljs-property">deps</span>[i])
        );
    }

    <span class="hljs-keyword">const</span> hook = {
        <span class="hljs-attr">value</span>: hasChanged ? <span class="hljs-title function_">factory</span>() : oldHook.<span class="hljs-property">value</span>,
        deps,
    };

    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;

    <span class="hljs-keyword">return</span> hook.<span class="hljs-property">value</span>;
}


<span class="hljs-comment">/**************************************************************
 * Contextï¼ˆæç®€ç‰ˆï¼‰
 **************************************************************/</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createContext</span>(<span class="hljs-params">defaultValue</span>) {
    <span class="hljs-keyword">const</span> context = {
        <span class="hljs-attr">_currentValue</span>: defaultValue,
        <span class="hljs-title class_">Provider</span>: <span class="hljs-literal">null</span>,
    };

    context.<span class="hljs-property">Provider</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">Provider</span>(<span class="hljs-params">props</span>) {
        context.<span class="hljs-property">_currentValue</span> = props.<span class="hljs-property">value</span>;
        <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;
    };

    <span class="hljs-keyword">return</span> context;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useContext</span>(<span class="hljs-params">context</span>) {
    <span class="hljs-keyword">const</span> hook = { <span class="hljs-attr">value</span>: context.<span class="hljs-property">_currentValue</span> };
    wipFiber.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">push</span>(hook);
    hookIndex++;
    <span class="hljs-keyword">return</span> hook.<span class="hljs-property">value</span>;
}


<span class="hljs-comment">/**************************************************************
 * å¯¹å¤– API
 **************************************************************/</span>

<span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniReact</span> = {
    createElement,
    render,
    useState,
    useEffect,
    useRef,
    useMemo,
    useContext,
    createContext,
};


<span class="hljs-comment">/**************************************************************
 * Demo
 **************************************************************/</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">TodoApp</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

    <span class="hljs-keyword">const</span> double = <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"compute memo"</span>);
        <span class="hljs-keyword">return</span> count * <span class="hljs-number">2</span>;
    }, [count]);

    <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"effect:"</span>, count);
    }, [count]);

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(
        <span class="hljs-string">"div"</span>,
        <span class="hljs-literal">null</span>,
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"h3"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"Count: "</span>, count),
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"Double: "</span>, double),
        <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(
            <span class="hljs-string">"button"</span>,
            { <span class="hljs-attr">onclick</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>) },
            <span class="hljs-string">"Add"</span>
        )
    );
}

<span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">render</span>(
    <span class="hljs-title class_">MiniReact</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">TodoApp</span>, <span class="hljs-literal">null</span>),
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"root"</span>)
);


<span class="hljs-comment">/**************************************************************
 * TodoApp åˆå§‹åŒ–æµç¨‹ï¼ˆç²¾ç»† Fiber + Hooks æ³¨é‡Šï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * ======================= Step 1: render() è¢«è°ƒç”¨ =======================
 * MiniReact.render(element, container)
 * container = &lt;div id="root"&gt;&lt;/div&gt;
 *
 * åˆ›å»ºæ ¹ Fiber:
 * rootFiber = {
 *   dom: container,
 *   props: { children: [TodoApp element] },
 *   parent: null,
 *   child: null,
 *   sibling: null,
 *   alternate: null
 * }
 *
 * currentRoot = rootFiber
 * nextUnitOfWork = rootFiber
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 2: performUnitOfWork(rootFiber) =======================
 * fiber = rootFiber
 * fiber.type = undefined / å®¹å™¨ DOM
 *
 * 1. åˆ›å»º DOM:
 *    fiber.dom = container
 *    parentDom = null (fiber.parent = null)
 *
 * 2. reconcileChildren(fiber, [TodoApp element])
 *    - index=0
 *    - åˆ›å»º TodoApp Fiber:
 *      todoFiber = {
 *        type: TodoApp,
 *        props: {},
 *        parent: rootFiber,
 *        child: null,
 *        sibling: null,
 *        dom: null,
 *        alternate: null,
 *        hooks: null
 *      }
 *    - rootFiber.child = todoFiber
 *
 * nextUnitOfWork = todoFiber
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 3: performUnitOfWork(todoFiber) =======================
 * fiber = todoFiber
 * fiber.type = TodoApp (å‡½æ•°ç»„ä»¶)
 *
 * 1. å‡†å¤‡ render å‡½æ•°ç»„ä»¶:
 *    wipFiber = todoFiber
 *    hookIndex = 0
 *    wipFiber.hooks = []   &lt;-- æ–° Fiber çš„ hooks æ•°ç»„åˆå§‹åŒ–
 *
 * 2. æ‰§è¡Œ TodoApp():
 *    const [count, setCount] = useState(0)
 *
 * ======================= Step 3a: useState =======================
 * oldHook = null (é¦–æ¬¡æ¸²æŸ“ï¼ŒwipFiber.alternate = null)
 * æ–° hook:
 * 0: { state: 0, queue: [] }
 * wipFiber.hooks = [ { state:0, queue:[] } ]
 * hookIndex++ =&gt; 1
 * è¿”å› count = 0, setCount = function
 *
 * ======================= Step 3b: useMemo =======================
 * const double = useMemo(() =&gt; count*2, [count])
 * oldHook = null
 * hasChanged = true (é¦–æ¬¡æ¸²æŸ“)
 * æ–° hook:
 * 1: { value: 0, deps:[0] }
 * wipFiber.hooks = [
 *   { state:0, queue:[] },
 *   { value:0, deps:[0] }
 * ]
 * hookIndex++ =&gt; 2
 * double = 0
 *
 * ======================= Step 3c: useEffect =======================
 * const effect = () =&gt; { console.log(count); }
 * oldHook = null
 * hasChanged = true
 * æ–° hook:
 * 2: { effect: effectFn, deps:[0], cleanup: null }
 * pendingEffects = [ hook ]
 * wipFiber.hooks = [
 *   { state:0, queue:[] },
 *   { value:0, deps:[0] },
 *   { effect:effectFn, deps:[0], cleanup:null }
 * ]
 * hookIndex++ =&gt; 3
 *
 * 3. TodoApp è¿”å› JSX:
 * &lt;div&gt;
 *   &lt;h3&gt;Count: 0&lt;/h3&gt;
 *   &lt;p&gt;Double: 0&lt;/p&gt;
 *   &lt;button&gt;Add&lt;/button&gt;
 * &lt;/div&gt;
 *
 * reconcileChildren(todoFiber, [div element])
 * åˆ›å»º divFiberã€h3Fiberã€pFiberã€buttonFiber
 * å»ºç«‹ child/sibling é“¾è¡¨
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 4: commit é˜¶æ®µ =======================
 * éå† Fiber æ ‘ï¼ŒæŒ‚è½½ DOM:
 * rootFiber.dom.appendChild(todoFiber.dom) -&gt; divFiber.dom -&gt; h3/p/button
 *
 * æ‰§è¡Œ pendingEffects:
 * hook.effect() -&gt; console.log(count) è¾“å‡º 0
 * hook.cleanup = null
 * pendingEffects æ¸…ç©º
 *
 * æœ€ç»ˆçŠ¶æ€:
 * currentRoot = rootFiber
 * wipFiber = null
 * hookIndex = 0
 * Fiber æ ‘:
 * ROOT
 * â””â”€â”€ TodoApp Fiber
 *     â””â”€â”€ divFiber
 *         â”œâ”€â”€ h3Fiber
 *         â”œâ”€â”€ pFiber
 *         â””â”€â”€ buttonFiber
 * Hooks çŠ¶æ€:
 * 0: { state:0, queue:[] }
 * 1: { value:0, deps:[0] }
 * 2: { effect: effectFn, deps:[0], cleanup:null }
 */</span>




<span class="hljs-comment">/**************************************************************
 * TodoApp ç¬¬ä¸€æ¬¡ç‚¹å‡»æŒ‰é’®æ›´æ–°æµç¨‹ï¼ˆç²¾ç»† Fiber + Hooks æ³¨é‡Šï¼‰
 **************************************************************/</span>

<span class="hljs-comment">/**
 * ======================= Step 1: ç”¨æˆ·ç‚¹å‡»æŒ‰é’® =======================
 * ç‚¹å‡» button æ‰§è¡Œ onclick:
 * setCount(c =&gt; c + 1)
 *
 * 1. æŸ¥æ‰¾å½“å‰ Hookï¼š
 *    wipFiber = null (å°šæœªè¿›å…¥ render)
 *    hookIndex = å½“å‰è°ƒç”¨ä½ç½® 0
 *    å¯¹åº”æ—§ Hook:
 *    oldHook = currentRoot.child.hooks[0] = { state:0, queue:[] }
 *
 * 2. å…¥é˜Ÿ action åˆ° hook.queue:
 *    action = c =&gt; c + 1
 *    oldHook.queue.push(action)
 *
 *    Hooks çŠ¶æ€ï¼ˆæ—§ Fiber çš„ hooksï¼Œä¸å˜ï¼‰:
 *    0: { state:0, queue:[c=&gt;c+1] }
 *    1: { value:0, deps:[0] }
 *    2: { effect:effectFn, deps:[0], cleanup:null }
 *
 * 3. è°ƒç”¨ rerender()
 *    æ¸…ç©ºæ ¹ DOM: container.innerHTML = ""
 *    å‡†å¤‡é‡æ–° render(currentRoot.props.children[0], currentRoot.dom)
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 2: performUnitOfWork(todoFiber) =======================
 * wipFiber = todoFiber
 * hookIndex = 0
 * wipFiber.hooks = []   &lt;-- æ–° Fiber hooks é‡å»º
 *
 * æ‰§è¡Œ TodoApp():
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 2a: useState =======================
 * hookIndex = 0
 * oldHook = { state:0, queue:[c=&gt;c+1] }
 *
 * æ–° hook:
 * state = oldHook.state = 0
 * queue = [] (æ–° hook çš„ queue ä¸´æ—¶ä¸ºç©º)
 *
 * å¤„ç†æ—§ queue:
 * for action in oldHook.queue:
 *   state = action(state) = (0+1) = 1
 * æ–° hook.state = 1
 *
 * hookIndex++ =&gt; 1
 * wipFiber.hooks = [
 *   { state:1, queue:[] }   &lt;-- æ›´æ–°åçš„ useState
 * ]
 *
 * è¿”å› count = 1, setCount = function
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 2b: useMemo =======================
 * hookIndex = 1
 * oldHook = { value:0, deps:[0] }
 *
 * æ£€æŸ¥ deps:
 * æ—§ deps = [0], æ–° count = 1
 * deps å˜åŒ– -&gt; hasChanged = true
 *
 * é‡æ–°è®¡ç®— value = count*2 = 1*2 = 2
 * æ–° hook:
 * { value:2, deps:[1] }
 * hookIndex++ =&gt; 2
 * wipFiber.hooks = [
 *   { state:1, queue:[] },
 *   { value:2, deps:[1] }
 * ]
 *
 * double = 2
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 2c: useEffect =======================
 * hookIndex = 2
 * oldHook = { effect: effectFn, deps:[0], cleanup:null }
 *
 * æ£€æŸ¥ deps:
 * old deps=[0], count=1 -&gt; depså˜åŒ– -&gt; hasChanged = true
 *
 * æ–° hook:
 * { effect:effectFn, deps:[1], cleanup:null }
 * pendingEffects.push(newHook)
 * hookIndex++ =&gt; 3
 * wipFiber.hooks = [
 *   { state:1, queue:[] },
 *   { value:2, deps:[1] },
 *   { effect:effectFn, deps:[1], cleanup:null }
 * ]
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 3: JSX è¿”å› &amp; Fiber æ ‘å¤ç”¨ =======================
 * TodoApp è¿”å›:
 * &lt;div&gt;
 *   &lt;h3&gt;Count: 1&lt;/h3&gt;
 *   &lt;p&gt;Double: 2&lt;/p&gt;
 *   &lt;button&gt;Add&lt;/button&gt;
 * &lt;/div&gt;
 *
 * reconcileChildren(todoFiber, [div element])
 * Fiber æ ‘å¤ç”¨:
 * todoFiber.child = divFiber (å¤ç”¨æ—§èŠ‚ç‚¹)
 * divFiber.child = h3Fiber -&gt; pFiber -&gt; buttonFiber (å¤ç”¨æ—§èŠ‚ç‚¹)
 *
 * dom ä¸é‡å»ºï¼Œåªæ›´æ–° textContent
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 4: commit é˜¶æ®µ =======================
 * æ›´æ–° DOM:
 * h3.textContent = "Count:1"
 * p.textContent = "Double:2"
 *
 * æ‰§è¡Œ pendingEffects:
 * hook.effect() -&gt; console.log(count) è¾“å‡º 1
 * alert("Count is: 1")
 * hook.cleanup = null
 * pendingEffects æ¸…ç©º
 */</span>

<span class="hljs-comment">/**
 * ======================= Step 5: æœ€ç»ˆçŠ¶æ€ =======================
 * currentRoot = rootFiber
 * wipFiber = null
 * hookIndex = 0
 *
 * Fiber æ ‘:
 * ROOT
 * â””â”€â”€ TodoApp Fiber
 *     â””â”€â”€ divFiber
 *         â”œâ”€â”€ h3Fiber
 *         â”œâ”€â”€ pFiber
 *         â””â”€â”€ buttonFiber
 *
 * Hooks çŠ¶æ€:
 * 0: { state:1, queue:[] }          &lt;-- useState å·²å¤„ç† queue
 * 1: { value:2, deps:[1] }          &lt;-- useMemo æ›´æ–°
 * 2: { effect:effectFn, deps:[1], cleanup:null } &lt;-- useEffect æ›´æ–°
 *
 * pendingEffects = []
 */</span>

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[reactå­¦ä¹ 15ï¼šåŸºäº React Router å®ç° keepalive]]></title>    <link>https://juejin.cn/post/7589475923696746515</link>    <guid>https://juejin.cn/post/7589475923696746515</guid>    <pubDate>2025-12-30T08:47:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589475923696746515" data-draft-id="7576994308273668115" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="reactå­¦ä¹ 15ï¼šåŸºäº React Router å®ç° keepalive"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-30T08:47:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ±Ÿä¸œæµæ°´"/> <meta itemprop="url" content="https://juejin.cn/user/1151943917181880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            reactå­¦ä¹ 15ï¼šåŸºäº React Router å®ç° keepalive
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943917181880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ±Ÿä¸œæµæ°´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:47:32.000Z" title="Tue Dec 30 2025 08:47:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“è·¯ç”±åˆ‡æ¢çš„æ—¶å€™ï¼Œreact router ä¼šé”€æ¯ä¹‹å‰è·¯ç”±çš„ç»„ä»¶ï¼Œç„¶åæ¸²æŸ“æ–°çš„è·¯ç”±å¯¹åº”çš„ç»„ä»¶ã€‚</p>
<p>åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œè¿™æ ·æ˜¯æœ‰é—®é¢˜çš„ã€‚</p>
<p>æ¯”å¦‚ç§»åŠ¨ç«¯å¾ˆå¤šé•¿åˆ—è¡¨ï¼Œç”¨æˆ·åˆ’äº†å¾ˆä¹…ä¹‹åï¼Œç‚¹å‡»æŸä¸ªåˆ—è¡¨é¡¹è·³åˆ°è¯¦æƒ…é¡µï¼Œä¹‹ååˆè·³å›æ¥ï¼Œä½†æ˜¯è¿™æ—¶å€™åˆ—è¡¨é¡µçš„ç»„ä»¶é”€æ¯é‡æ–°åˆ›å»ºï¼Œåˆå›åˆ°äº†æœ€ä¸Šé¢ã€‚</p>
<p>æ¯”å¦‚ç§»åŠ¨ç«¯å¡«å†™äº†æŸä¸ªè¡¨å•ï¼Œæœ‰çš„è¡¨å•éœ€è¦è·³åˆ°åˆ«çš„é¡µé¢è·å–æ•°æ®ï¼Œç„¶åè·³å›æ¥ï¼Œè·³å›æ¥å‘ç°ç»„ä»¶é”€æ¯é‡æ–°åˆ›å»ºï¼Œä¹‹å‰å¡«çš„éƒ½æ²¡äº†ã€‚</p>
<p>ç±»ä¼¼è¿™ç§åœºæ™¯ï¼Œå°±éœ€è¦è·¯ç”±åˆ‡æ¢çš„æ—¶å€™ä¸é”€æ¯ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ keepaliveã€‚</p>
<p>æˆ‘ä»¬å…ˆå¤ç°ä¸‹è¿™ä¸ªåœºæ™¯ï¼š</p>
<pre><code class="hljs language-js" lang="js">npx create-vite
</code></pre>
<p>é€‰æ‹© react + typescript åˆ›å»ºé¡¹ç›®ã€‚</p>
<p>å®‰è£… react-routerï¼š</p>
<pre><code class="hljs language-js" lang="js">npm i --save react-router-dom
</code></pre>
<p>åœ¨ App.tsx å†™ä¸‹è·¯ç”±ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> {  <span class="hljs-title class_">Link</span>, useLocation, <span class="hljs-title class_">RouterProvider</span>, createBrowserRouter, <span class="hljs-title class_">Outlet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Layout</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> { pathname } = <span class="hljs-title function_">useLocation</span>();

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å½“å‰è·¯ç”±: {pathname}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Aaa</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count =&gt; count + 1)}&gt;åŠ ä¸€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">'/bbb'</span>&gt;</span>å» Bbb é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">'/ccc'</span>&gt;</span>å» Ccc é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Bbb</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count =&gt; count + 1)}&gt;åŠ ä¸€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">'/'</span>&gt;</span>å»é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Ccc</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ccc<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">'/'</span>&gt;</span>å»é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
};

<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Layout</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Layout</span>&gt;</span></span>,
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Aaa</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Aaa</span>&gt;</span></span>,
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">"/bbb"</span>,
        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Bbb</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Bbb</span>&gt;</span></span>
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">"/ccc"</span>,
        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Ccc</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Ccc</span>&gt;</span></span>
      }
    ]
  }
];

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createBrowserRouter</span>(routes);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">RouterProvider</span> <span class="hljs-attr">router</span>=<span class="hljs-string">{router}/</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p>è¿™é‡Œæœ‰ /ã€/bbbã€/ccc è¿™ä¸‰ä¸ªè·¯ç”±ã€‚</p>
<p>ä¸€çº§è·¯ç”±æ¸²æŸ“ Layout ç»„ä»¶ï¼Œé‡Œé¢é€šè¿‡ Outlet æŒ‡å®šæ¸²æŸ“äºŒçº§è·¯ç”±çš„åœ°æ–¹ã€‚</p>
<p>äºŒçº§è·¯ç”± / æ¸²æŸ“ Aaa ç»„ä»¶ï¼Œ/bbb æ¸²æŸ“ Bbb ç»„ä»¶ï¼Œ/ccc æ¸²æŸ“ Ccc ç»„ä»¶ã€‚</p>
<p>è¿™é‡Œçš„ Outlet ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥æ¢æˆ useOutletï¼Œæ•ˆæœä¸€æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e8e3f2660c44359bbb1c9729ea64792~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767689252&amp;x-signature=rqOkIY5kelNcV00c75U8VzzjGb8%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d145057fa8464d76a5fd570b762fe73e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767689252&amp;x-signature=mGgQxHQ6m5FVLtq%2B4wv4NgUXejc%3D" alt="image.png" loading="lazy"/></p>
<p>é»˜è®¤è·¯ç”±åˆ‡æ¢ï¼Œå¯¹åº”çš„ç»„ä»¶å°±ä¼šé”€æ¯ã€‚</p>
<p>æˆ‘ä»¬æœ‰æ—¶å€™ä¸å¸Œæœ›åˆ‡æ¢è·¯ç”±æ—¶é”€æ¯é¡µé¢ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯å¸Œæœ›èƒ½å®ç° keepaliveã€‚</p>
<p>æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>å…¶å®å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰éœ€è¦ keepalive çš„ç»„ä»¶ä¿å­˜åˆ°ä¸€ä¸ªå…¨å±€å¯¹è±¡ã€‚</p>
<p>ç„¶åæ¸²æŸ“çš„æ—¶å€™æŠŠå®ƒä»¬éƒ½æ¸²æŸ“å‡ºæ¥ï¼Œè·¯ç”±åˆ‡æ¢åªæ˜¯æ”¹å˜æ˜¾ç¤ºéšè—ã€‚</p>
<p>æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥å†™ä¸€ä¸‹ï¼š</p>
<p>æ–°å»º KeepAliveLayout.tsxï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { createContext, useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useOutlet, useLocation, matchPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>
<span class="hljs-keyword">import</span> type { <span class="hljs-variable constant_">FC</span>, <span class="hljs-title class_">PropsWithChildren</span>, <span class="hljs-title class_">ReactNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

interface <span class="hljs-title class_">KeepAliveLayoutProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">PropsWithChildren</span>{
    <span class="hljs-attr">keepPaths</span>: <span class="hljs-title class_">Array</span>&lt;string | <span class="hljs-title class_">RegExp</span>&gt;;
    keepElements?: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">ReactNode</span>&gt;;
    dropByPath?: <span class="hljs-function">(<span class="hljs-params">path: string</span>) =&gt;</span> <span class="hljs-keyword">void</span>;
}

type <span class="hljs-title class_">KeepAliveContextType</span> = <span class="hljs-title class_">Omit</span>&lt;<span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">KeepAliveLayoutProps</span>&gt;, <span class="hljs-string">'children'</span>&gt;;

<span class="hljs-keyword">const</span> <span class="hljs-attr">keepElements</span>: <span class="hljs-title class_">KeepAliveContextType</span>[<span class="hljs-string">'keepElements'</span>] = {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">KeepAliveContext</span> = createContext&lt;<span class="hljs-title class_">KeepAliveContextType</span>&gt;({
    <span class="hljs-attr">keepPaths</span>: [],
    keepElements,
    <span class="hljs-title function_">dropByPath</span>(<span class="hljs-params">path: string</span>) {
        keepElements[path] = <span class="hljs-literal">null</span>;
    }
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">isKeepPath</span> = (<span class="hljs-params">keepPaths: <span class="hljs-built_in">Array</span>&lt;string | <span class="hljs-built_in">RegExp</span>&gt;, path: string</span>) =&gt; {
    <span class="hljs-keyword">let</span> isKeep = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i&lt; keepPaths.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">let</span> item = keepPaths[i];
        <span class="hljs-keyword">if</span> (item === path) {
            isKeep = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (item <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span> &amp;&amp; item.<span class="hljs-title function_">test</span>(path)) {
            isKeep = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item === <span class="hljs-string">'string'</span> &amp;&amp; item.<span class="hljs-title function_">toLowerCase</span>() === path) {
            isKeep = <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-keyword">return</span> isKeep;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useKeepOutlet</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> location = <span class="hljs-title function_">useLocation</span>();
    <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">useOutlet</span>();

    <span class="hljs-keyword">const</span> { keepElements, keepPaths } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">KeepAliveContext</span>);
    <span class="hljs-keyword">const</span> isKeep = <span class="hljs-title function_">isKeepPath</span>(keepPaths, location.<span class="hljs-property">pathname</span>);

    <span class="hljs-keyword">if</span> (isKeep) {
        keepElements![location.<span class="hljs-property">pathname</span>] = element;
    }

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        {
            Object.entries(keepElements).map(([pathname, element]) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
                    <span class="hljs-attr">key</span>=<span class="hljs-string">{pathname}</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> '<span class="hljs-attr">100</span>%', <span class="hljs-attr">width:</span> '<span class="hljs-attr">100</span>%', <span class="hljs-attr">position:</span> '<span class="hljs-attr">relative</span>', <span class="hljs-attr">overflow:</span> '<span class="hljs-attr">hidden</span> <span class="hljs-attr">auto</span>' }}
                    <span class="hljs-attr">className</span>=<span class="hljs-string">"keep-alive-page"</span>
                    <span class="hljs-attr">hidden</span>=<span class="hljs-string">{!matchPath(location.pathname,</span> <span class="hljs-attr">pathname</span>)}
                &gt;</span>
                    {element}
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))
        }
        {!isKeep &amp;&amp; element}
    <span class="hljs-tag">&lt;/&gt;</span></span>
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">KeepAliveLayout</span>: <span class="hljs-variable constant_">FC</span>&lt;<span class="hljs-title class_">KeepAliveLayoutProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { keepPaths, ...other } = props;

    <span class="hljs-keyword">const</span> { keepElements, dropByPath } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">KeepAliveContext</span>);

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAliveContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">keepPaths</span>, <span class="hljs-attr">keepElements</span>, <span class="hljs-attr">dropByPath</span> }} {<span class="hljs-attr">...other</span>} /&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">KeepAliveLayout</span>;
</code></pre>
<h2 data-id="heading-0">ts ç›¸å…³çŸ¥è¯†ç‚¹</h2>
<h3 data-id="heading-1">PropsWithChildren</h3>
<p>åœ¨ React ä¸­ï¼Œ<code>PropsWithChildren</code>Â æ˜¯ TypeScript æä¾›çš„ä¸€ä¸ªå·¥å…·ç±»å‹ï¼Œç”¨äºä¸ºç»„ä»¶çš„ props ç±»å‹æ·»åŠ Â <code>children</code>Â å±æ€§çš„ç±»å‹å®šä¹‰ã€‚</p>
<p>å½“ä½ å®šä¹‰ç»„ä»¶çš„ props ç±»å‹æ—¶ï¼Œå¦‚æœç»„ä»¶éœ€è¦æ¥æ”¶Â <code>children</code>ï¼ˆå­å…ƒç´ ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨Â <code>PropsWithChildren</code>Â æ¥è‡ªåŠ¨åŒ…å«Â <code>children</code>Â çš„ç±»å‹ï¼Œæ— éœ€æ‰‹åŠ¨å£°æ˜ã€‚</p>
<p>å®ƒçš„æœ¬è´¨æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå®šä¹‰å¦‚ä¸‹ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js">type <span class="hljs-title class_">PropsWithChildren</span>&lt;P = {}&gt; = P &amp; { children?: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span> };
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { type <span class="hljs-title class_">PropsWithChildren</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// è‡ªå®šä¹‰ props ç±»å‹</span>
type <span class="hljs-title class_">CardProps</span> = {
  <span class="hljs-attr">title</span>: string;
  className?: string;
};

<span class="hljs-comment">// ä½¿ç”¨ PropsWithChildren åŒ…å« children</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Card</span> = (<span class="hljs-params">{ title, className, children }: PropsWithChildren&lt;CardProps&gt;</span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{className}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-comment">// ä½¿ç”¨ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å¡ç‰‡æ ‡é¢˜"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯å¡ç‰‡å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span></span>
  );
};
</code></pre>
<h3 data-id="heading-2">Recordã€ Requireã€ Omit</h3>
<ul>
<li>Record æ˜¯åˆ›å»ºä¸€ä¸ª key value çš„å¯¹è±¡ç±»å‹ï¼š</li>
</ul>
<pre><code class="hljs language-js" lang="js"> keepElements?: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">ReactNode</span>&gt;;
</code></pre>
<ul>
<li>
<p>Requried æ˜¯å»æ‰å¯é€‰ -?</p>
</li>
<li>
<p>Omit æ˜¯åˆ æ‰å…¶ä¸­çš„éƒ¨åˆ†å±æ€§ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-js" lang="js">type <span class="hljs-title class_">KeepAliveContextType</span> = <span class="hljs-title class_">Omit</span>&lt;<span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">KeepAliveLayoutProps</span>&gt;, <span class="hljs-string">'children'</span>&gt;;
</code></pre>
<p>å¦‚æœè¦çŸ¥é“æŸä¸ªå±æ€§çš„ç±»å‹å‘¢ï¼Ÿ å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-attr">keepElements</span>: <span class="hljs-title class_">KeepAliveContextType</span>[<span class="hljs-string">'keepElements'</span>] = {};
</code></pre>
<p><code>KeepAliveContextType['keepElements']</code> å°±è¿”å›äº† <code>keepElements</code> å±æ€§çš„ç±»å‹ã€‚</p>
<p>æ˜¯ä¸æ˜¯æ„Ÿè§‰tsè·Ÿç¼–ç¨‹ä¸€æ ·ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">KeepAliveLayout</span>: <span class="hljs-variable constant_">FC</span>&lt;<span class="hljs-title class_">KeepAliveLayoutProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { keepPaths, ...other } = props;

    <span class="hljs-keyword">const</span> { keepElements, dropByPath } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">KeepAliveContext</span>);

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAliveContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">keepPaths</span>, <span class="hljs-attr">keepElements</span>, <span class="hljs-attr">dropByPath</span> }} {<span class="hljs-attr">...other</span>} /&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">KeepAliveLayout</span>;
</code></pre>
<p>é¦–å…ˆä»çˆ¶ç»„ä»¶ä¸­ä¼ å…¥propsï¼Œå…¶ä¸­åŒ…æ‹¬å®šä¹‰çš„ <code>keepPaths</code>, ç„¶åä»useContext å–å‡ºå…¶ä»–å€¼ï¼Œç„¶åé€šè¿‡KeepAliveContext.Provider çš„value è¿›è¡Œè®¾ç½®ï¼Œè¿™æ ·å­ç»„ä»¶å°±èƒ½è·å–åˆ°è¿™äº›å€¼ã€‚</p>
<p>ç„¶åæš´éœ²ä¸€ä¸ª useKeepOutlet çš„ hookï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useKeepOutlet</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> location = <span class="hljs-title function_">useLocation</span>();
    <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">useOutlet</span>();

    <span class="hljs-keyword">const</span> { keepElements, keepPaths } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">KeepAliveContext</span>);
    <span class="hljs-keyword">const</span> isKeep = <span class="hljs-title function_">isKeepPath</span>(keepPaths, location.<span class="hljs-property">pathname</span>);

    <span class="hljs-keyword">if</span> (isKeep) {
        keepElements![location.<span class="hljs-property">pathname</span>] = element;
    }

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        {
            Object.entries(keepElements).map(([pathname, element]) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
                    <span class="hljs-attr">key</span>=<span class="hljs-string">{pathname}</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> '<span class="hljs-attr">100</span>%', <span class="hljs-attr">width:</span> '<span class="hljs-attr">100</span>%', <span class="hljs-attr">position:</span> '<span class="hljs-attr">relative</span>', <span class="hljs-attr">overflow:</span> '<span class="hljs-attr">hidden</span> <span class="hljs-attr">auto</span>' }}
                    <span class="hljs-attr">className</span>=<span class="hljs-string">"keep-alive-page"</span>
                    <span class="hljs-attr">hidden</span>=<span class="hljs-string">{!matchPath(location.pathname,</span> <span class="hljs-attr">pathname</span>)}
                &gt;</span>
                    {element}
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))
        }
        {!isKeep &amp;&amp; element}
    <span class="hljs-tag">&lt;/&gt;</span></span>
}
</code></pre>
<p>ç”¨ useLocation æ‹¿åˆ°å½“å‰è·¯ç”±ï¼Œç”¨ useOutlet æ‹¿åˆ°å¯¹åº”çš„ç»„ä»¶ã€‚</p>
<p>åˆ¤æ–­ä¸‹å½“å‰è·¯ç”±æ˜¯å¦åœ¨éœ€è¦ keepalive çš„è·¯ç”±å†…ï¼Œæ˜¯çš„è¯å°±ä¿å­˜åˆ° keepElementsã€‚</p>
<p>ç„¶åæ¸²æŸ“æ‰€æœ‰çš„ keepElementsï¼Œå¦‚æœä¸åŒ¹é… matchPath å°±éšè—ã€‚</p>
<p>å¹¶ä¸”å¦‚æœå½“å‰è·¯ç”±ä¸åœ¨ keepPaths å†…ï¼Œå°±ç›´æ¥æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼š  {!isKeep &amp;&amp; element} ã€‚</p>
<p>å…¶å®åŸç†æ¯”è¾ƒå®¹æ˜“çœ‹æ‡‚ï¼š<strong>åœ¨ context ä¸­ä¿å­˜æ‰€æœ‰éœ€è¦ keepalive çš„ç»„ä»¶ï¼Œå…¨éƒ¨æ¸²æŸ“å‡ºæ¥ï¼Œé€šè¿‡è·¯ç”±æ˜¯å¦åŒ¹é…æ¥åˆ‡æ¢å¯¹åº”ç»„ä»¶çš„æ˜¾ç¤ºéšè—ã€‚</strong></p>
<p>åœ¨ App.tsx é‡Œå¼•å…¥æµ‹è¯•ä¸‹ï¼š</p>
<p>åœ¨å¤–é¢åŒ…ä¸€å±‚ KeepAliveLayout ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAliveLayout</span> <span class="hljs-attr">keepPaths</span>=<span class="hljs-string">{[</span>'/<span class="hljs-attr">bbb</span>', '/']}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">RouterProvider</span> <span class="hljs-attr">router</span>=<span class="hljs-string">{router}/</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAliveLayout</span>&gt;</span></span>
    )
}
</code></pre>
<p><code>&lt;RouterProvider router={router}/&gt;</code>ä¼šä½œä¸º<code>children</code>ä¼ é€’åˆ°<code>KeepAliveLayout</code>ç»„ä»¶ä¸­ã€‚</p>
<p>ç„¶åæŠŠ useOutlet æ¢æˆ useKeepOutletï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Layout</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> { pathname } = <span class="hljs-title function_">useLocation</span>();

    <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">useKeepOutlet</span>()

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å½“å‰è·¯ç”±: {pathname}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            { element }
            {/* <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span>/&gt;</span> */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h2 data-id="heading-3">æ€»ç»“</h2>
<p>è·¯ç”±åˆ‡æ¢ä¼šé”€æ¯å¯¹åº”çš„ç»„ä»¶ï¼Œä½†å¾ˆå¤šåœºæ™¯æˆ‘ä»¬å¸Œæœ›è·¯ç”±åˆ‡æ¢ç»„ä»¶ä¸é”€æ¯ï¼Œä¹Ÿå°±æ˜¯ keepaliveã€‚</p>
<p>react router å¹¶æ²¡æœ‰å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åšã€‚</p>
<p>æˆ‘ä»¬åœ¨ context ä¸­ä¿å­˜æ‰€æœ‰éœ€è¦ keepalive çš„ç»„ä»¶ï¼Œç„¶åæ¸²æŸ“çš„æ—¶å€™å…¨éƒ¨æ¸²æŸ“å‡ºæ¥ï¼Œé€šè¿‡è·¯ç”±æ˜¯å¦åŒ¹é…æ¥åˆ‡æ¢æ˜¾ç¤ºéšè—ã€‚</p>
<p>è¿™æ ·å®ç°äº† keepaliveã€‚</p>
<p>è¿™ä¸ªåŠŸèƒ½æ˜¯ä¾èµ– React Router çš„ useLocationã€useOutletã€matchPath ç­‰ api å®ç°çš„ï¼Œå’Œè·¯ç”±åŠŸèƒ½å¯†ä¸å¯åˆ†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript é—­åŒ…å®æˆ˜ï¼šæ‰‹å†™é˜²æŠ–ä¸èŠ‚æµå‡½æ•°ï¼Œä¼˜åŒ–é«˜é¢‘äº‹ä»¶æ€§èƒ½]]></title>    <link>https://juejin.cn/post/7589445154533933108</link>    <guid>https://juejin.cn/post/7589445154533933108</guid>    <pubDate>2025-12-30T08:55:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589445154533933108" data-draft-id="7589386961649205283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript é—­åŒ…å®æˆ˜ï¼šæ‰‹å†™é˜²æŠ–ä¸èŠ‚æµå‡½æ•°ï¼Œä¼˜åŒ–é«˜é¢‘äº‹ä»¶æ€§èƒ½"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-30T08:55:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¶…çº§èµ›äºšäºº_"/> <meta itemprop="url" content="https://juejin.cn/user/793196846923641"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript é—­åŒ…å®æˆ˜ï¼šæ‰‹å†™é˜²æŠ–ä¸èŠ‚æµå‡½æ•°ï¼Œä¼˜åŒ–é«˜é¢‘äº‹ä»¶æ€§èƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793196846923641/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¶…çº§èµ›äºšäºº_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:55:15.000Z" title="Tue Dec 30 2025 08:55:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°é«˜é¢‘è§¦å‘çš„äº‹ä»¶ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>è¾“å…¥æ¡† keyup æ—¶çš„æœç´¢å»ºè®®ï¼ˆç±»ä¼¼ç™¾åº¦ã€VS Code çš„æ™ºèƒ½è¡¥å…¨ï¼‰</li>
<li>çª—å£ resize æ—¶çš„å¸ƒå±€é‡æ–°è®¡ç®—</li>
<li>é¡µé¢æ»šåŠ¨æ—¶çš„æ‡’åŠ è½½æˆ–è¿”å›é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º</li>
<li>é¼ æ ‡ mousemove æ—¶çš„æ‹–æ‹½é¢„è§ˆ</li>
</ul>
<p>è¿™äº›äº‹ä»¶å¾€å¾€åœ¨çŸ­æ—¶é—´å†…è¢«è§¦å‘æ•°ç™¾ç”šè‡³ä¸Šåƒæ¬¡ï¼Œå¦‚æœæ¯æ¬¡éƒ½ç›´æ¥æ‰§è¡Œå¤æ‚çš„é€»è¾‘ï¼ˆå¦‚å‘ AJAX è¯·æ±‚ã€æ“ä½œ DOMã€è®¡ç®—å¸ƒå±€ï¼‰ï¼Œä¼šä¸¥é‡æ¶ˆè€—æµè§ˆå™¨èµ„æºï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ã€æ‰å¸§ï¼Œç”šè‡³å´©æºƒã€‚</p>
<p>è§£å†³è¿™ç±»é—®é¢˜çš„æ ¸å¿ƒæ–¹æ¡ˆå°±æ˜¯<strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰<strong>å’Œ</strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong> ï¼Œè€Œå®ƒä»¬çš„å®ç°éƒ½ç¦»ä¸å¼€ JavaScript çš„çµé­‚ç‰¹æ€§â€”â€”<strong>é—­åŒ…</strong>ã€‚</p>
<p>æœ¬æ–‡å°†ä»å®é™…åœºæ™¯å‡ºå‘ï¼Œè¯¦ç»†è®²è§£é˜²æŠ–å’ŒèŠ‚æµçš„åŸç†ã€åŒºåˆ«ã€æ‰‹åŠ¨å®ç°ï¼Œå¹¶æä¾›å®Œæ•´å¯è¿è¡Œçš„ HTML ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ å½»åº•æŒæ¡è¿™ä¸€å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„å¿…å¤‡æŠ€èƒ½ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿä¸ºä»€ä¹ˆèƒ½ç”¨äºé˜²æŠ–èŠ‚æµï¼Ÿ</h2>
<p>é—­åŒ…æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿâ€œè®°ä½â€å¹¶è®¿é—®å…¶è¯æ³•ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå³ä½¿å‡½æ•°åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚</p>
<p>åœ¨é˜²æŠ–å’ŒèŠ‚æµä¸­ï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p>
<ul>
<li>ä¿å­˜å®šæ—¶å™¨ IDï¼ˆç”¨äºæ¸…é™¤æˆ–åˆ¤æ–­æ—¶é—´ï¼‰</li>
<li>è®°ä½ä¸Šä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´æˆ³</li>
<li>ä¿ç•™æ­£ç¡®çš„ this æŒ‡å‘å’Œå‚æ•°</li>
</ul>
<p>è¿™äº›å˜é‡å¿…é¡»åœ¨å¤šæ¬¡äº‹ä»¶è§¦å‘é—´â€œå­˜æ´»â€ä¸‹æ¥ï¼Œè€Œä¸èƒ½æ¯æ¬¡éƒ½é‡æ–°åˆ›å»ºâ€”â€”è¿™æ­£æ˜¯é—­åŒ…çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h2 data-id="heading-1">åœºæ™¯ä¸€ï¼šæœç´¢è¾“å…¥æ¡†çš„ AJAX è¯·æ±‚ä¼˜åŒ–</h2>
<p>ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®æ—¶æ˜¾ç¤ºæœç´¢å»ºè®®ï¼ˆå¦‚ç™¾åº¦è¾“å…¥â€œreactâ€æ—¶ä¸‹æ–¹å‡ºç°çš„å»ºè®®åˆ—è¡¨ï¼‰ã€‚</p>
<p>å¦‚æœä¸åšä»»ä½•å¤„ç†ï¼Œæ¯æ¬¡ keyup éƒ½ç«‹å³å‘é€è¯·æ±‚ï¼š</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥â€œreactâ€äº”ä¸ªå­—ç¬¦ â†’ è§¦å‘ 5 æ¬¡è¯·æ±‚</li>
<li>ç½‘ç»œå¼€é”€å¤§ã€æœåŠ¡å™¨å‹åŠ›å¤§</li>
<li>ç”¨æˆ·ä½“éªŒå·®ï¼ˆå¿«é€Ÿè¾“å…¥æ—¶å»ºè®®é—ªçƒï¼‰</li>
</ul>
<p>ç†æƒ³æ•ˆæœæ˜¯ï¼šç”¨æˆ·åœæ­¢è¾“å…¥ 500ms åï¼Œæ‰å‘é€ä¸€æ¬¡è¯·æ±‚ã€‚</p>
<p>è¿™æ­£æ˜¯<strong>é˜²æŠ–</strong>çš„å…¸å‹åº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-2">å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰åŸç†ä¸å®ç°</h2>
<p><strong>é˜²æŠ–çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼šä¸ç®¡äº‹ä»¶è§¦å‘å¤šå°‘æ¬¡ï¼Œæˆ‘åªå…³å¿ƒæœ€åä¸€æ¬¡ã€‚åœ¨æœ€åä¸€æ¬¡è§¦å‘åçš„ delay æ—¶é—´å†…å¦‚æœæ²¡æœ‰æ–°è§¦å‘ï¼Œæ‰çœŸæ­£æ‰§è¡Œå‡½æ•°ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// é—­åŒ…ä¸­ä¿å­˜å®šæ—¶å™¨ ID</span>

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;

    <span class="hljs-comment">// æ¯æ¬¡è§¦å‘æ—¶ï¼Œå…ˆæ¸…é™¤ä¸Šä¸€æ¬¡çš„å®šæ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (timer) {
      <span class="hljs-built_in">clearTimeout</span>(timer);
    }

    <span class="hljs-comment">// é‡æ–°è®¾ç½®å®šæ—¶å™¨</span>
    timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      fn.<span class="hljs-title function_">apply</span>(context, args);
      timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ‰§è¡Œå®Œå¯å¯é€‰æ¸…ç†</span>
    }, delay);
  };
}
</code></pre>
<p>å…³é”®ç‚¹è§£æï¼š</p>
<ul>
<li>timer å˜é‡å®šä¹‰åœ¨ debounce å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œè¢«è¿”å›çš„å‡½æ•°â€œè®°ä½â€ï¼ˆé—­åŒ…ï¼‰ã€‚</li>
<li>æ¯æ¬¡äº‹ä»¶è§¦å‘éƒ½æ¸…é™¤æ—§å®šæ—¶å™¨ï¼Œé‡æ–°å¼€å§‹å€’è®¡æ—¶ã€‚</li>
<li>åªæœ‰åœ¨ delay æ—¶é—´å†…æ²¡æœ‰æ–°è§¦å‘æ—¶ï¼Œå®šæ—¶å™¨æ‰ä¼šæ‰§è¡Œ fnã€‚</li>
<li>ä½¿ç”¨ apply ä¿ç•™æ­£ç¡®çš„ this å’Œå‚æ•°ã€‚</li>
</ul>
<h2 data-id="heading-3">å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰åŸç†ä¸å®ç°</h2>
<p><strong>èŠ‚æµçš„æ ¸å¿ƒæ€æƒ³</strong>ï¼šåœ¨è§„å®šæ—¶é—´å†…ï¼Œæ— è®ºè§¦å‘å¤šå°‘æ¬¡ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚å¸¸ç”¨äºé™åˆ¶æ‰§è¡Œé¢‘ç‡ã€‚</p>
<p>å…¸å‹åœºæ™¯ï¼šé¡µé¢æ»šåŠ¨æ—¶åŠ è½½æ›´å¤šå†…å®¹ï¼ˆscroll äº‹ä»¶ï¼‰ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ 500ms æœ€å¤šæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦åˆ°è¾¾åº•éƒ¨ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">function throttle(fn, delay) {
  let <span class="hljs-attr">last</span> = <span class="hljs-number">0</span><span class="hljs-comment">; // é—­åŒ…ä¸­è®°å½•ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>

  return function(...args) {
    const <span class="hljs-attr">context</span> = this<span class="hljs-comment">;</span>
    const <span class="hljs-attr">now</span> = Date.now()<span class="hljs-comment">;</span>

    // å¦‚æœè·ç¦»ä¸Šæ¬¡æ‰§è¡Œä¸è¶³ delayï¼Œåˆ™ä¸æ‰§è¡Œ
    if (now - last &lt; delay) {
      return<span class="hljs-comment">;</span>
    }

    // æ‰§è¡Œå¹¶æ›´æ–° last
    <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
    fn.apply(context, args)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}
</code></pre>
<p>æ›´å¸¸è§çš„<strong>æ—¶é—´æˆ³ + å®šæ—¶å™¨æ··åˆç‰ˆ</strong>ï¼ˆæ”¯æŒå°¾éƒ¨æ‰§è¡Œï¼‰ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">function throttle(fn, delay) {
  let <span class="hljs-attr">last</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
  let <span class="hljs-attr">timer</span> = null<span class="hljs-comment">;</span>

  return function(...args) {
    const <span class="hljs-attr">context</span> = this<span class="hljs-comment">;</span>
    const <span class="hljs-attr">now</span> = Date.now()<span class="hljs-comment">;</span>

    // å¦‚æœè¿˜åœ¨å†·å´æœŸï¼Œä¸”æ²¡æœ‰å®šæ—¶å™¨ï¼ˆé¿å…é‡å¤è®¾ç½®ï¼‰
    if (now - last &lt; delay) {
      clearTimeout(timer)<span class="hljs-comment">;</span>
      <span class="hljs-attr">timer</span> = setTimeout(() =&gt; {
        <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
        fn.apply(context, args)<span class="hljs-comment">;</span>
      }, delay)<span class="hljs-comment">;</span>
    } else {
      // ç«‹å³æ‰§è¡Œï¼ˆé¢†å…ˆæ‰§è¡Œï¼‰
      <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
      fn.apply(context, args)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
}
</code></pre>
<p>è¿™ç§å®ç°å…¼é¡¾äº†â€œå›ºå®šé¢‘ç‡æ‰§è¡Œâ€å’Œâ€œåœæ­¢è§¦å‘åä»èƒ½æ‰§è¡Œæœ€åä¸€æ¬¡â€ã€‚</p>
<h2 data-id="heading-4">é˜²æŠ– vs èŠ‚æµï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ</h2>






























<table><thead><tr><th>ç‰¹æ€§</th><th>é˜²æŠ– (debounce)</th><th>èŠ‚æµ (throttle)</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ—¶æœº</td><td>äº‹ä»¶åœæ­¢è§¦å‘å delay æ—¶é—´æ‰§è¡Œä¸€æ¬¡</td><td>æ¯éš” delay æ—¶é—´æ‰§è¡Œä¸€æ¬¡</td></tr><tr><td>å…¸å‹åœºæ™¯</td><td>æœç´¢è¾“å…¥ã€è¡¨å•æäº¤éªŒè¯</td><td>æ»šåŠ¨åŠ è½½ã€é¼ æ ‡è·Ÿéšã€å°„å‡»æ¸¸æˆå°„é€Ÿ</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>ç­‰å¾…ç”¨æˆ·â€œæƒ³å¥½äº†â€å†å“åº”</td><td>æŒç»­æ“ä½œæ—¶ä¿æŒæµç•…å“åº”</td></tr><tr><td>å®ç°å¤æ‚åº¦</td><td>ç›¸å¯¹ç®€å•ï¼ˆsetTimeoutï¼‰</td><td>ç¨å¤æ‚ï¼ˆæ—¶é—´æˆ³æˆ–å®šæ—¶å™¨æ··åˆï¼‰</td></tr></tbody></table>
<p>è®°å¿†å£è¯€ï¼š</p>
<ul>
<li>éœ€è¦â€œæœ€åä¸€æ¬¡â€æ‰§è¡Œ â†’ ç”¨é˜²æŠ–ï¼ˆå¦‚æœç´¢ï¼‰</li>
<li>éœ€è¦â€œæŒç»­ä½†é™é¢‘â€æ‰§è¡Œ â†’ ç”¨èŠ‚æµï¼ˆå¦‚æ»šåŠ¨ï¼‰</li>
</ul>
<h2 data-id="heading-5">å®Œæ•´å¯è¿è¡Œç¤ºä¾‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ HTML æ–‡ä»¶ï¼ŒåŒ…å«ä¸‰ä¸ªè¾“å…¥æ¡†ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªï¼šæ— ä¼˜åŒ–ï¼Œæ¯æ¬¡ keyup éƒ½å‘è¯·æ±‚</li>
<li>ç¬¬äºŒä¸ªï¼šé˜²æŠ–ä¼˜åŒ–ï¼Œåœæ­¢è¾“å…¥ 500ms åå‘ä¸€æ¬¡è¯·æ±‚</li>
<li>ç¬¬ä¸‰ä¸ªï¼šèŠ‚æµä¼˜åŒ–ï¼Œæ¯ 500ms æœ€å¤šå‘ä¸€æ¬¡è¯·æ±‚</li>
</ul>
<p>HTML</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>é˜²æŠ–ä¸èŠ‚æµæ¼”ç¤º<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">font-family</span>: Arial, sans-serif; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
    <span class="hljs-selector-tag">input</span> { <span class="hljs-attribute">display</span>: block; <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> <span class="hljs-number">0</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>; <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>; }
    <span class="hljs-selector-tag">label</span> { <span class="hljs-attribute">font-weight</span>: bold; }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>æ— ä¼˜åŒ–ï¼ˆæ¯æ¬¡è¾“å…¥éƒ½è¯·æ±‚ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"undebounce"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¿«é€Ÿè¾“å…¥è§‚å¯Ÿæ§åˆ¶å°"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é˜²æŠ–ï¼ˆåœæ­¢è¾“å…¥500msåè¯·æ±‚ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"debounce"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥å®Œæˆåæ‰ä¼šè¯·æ±‚"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>èŠ‚æµï¼ˆæ¯500msæœ€å¤šè¯·æ±‚ä¸€æ¬¡ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"throttle"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"æŒç»­è¾“å…¥æ—¶ä¼šå®šæœŸè¯·æ±‚"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">content</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ajax request:'</span>, content);
    }

    <span class="hljs-comment">// é˜²æŠ–å®ç°</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
      <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
        <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);
        timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          fn.<span class="hljs-title function_">apply</span>(context, args);
        }, delay);
      };
    }

    <span class="hljs-comment">// èŠ‚æµå®ç°ï¼ˆæ—¶é—´æˆ³ + å®šæ—¶å™¨æ··åˆç‰ˆï¼‰</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, delay</span>) {
      <span class="hljs-keyword">let</span> last = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
        <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">if</span> (now - last &lt; delay) {
          <span class="hljs-built_in">clearTimeout</span>(timer);
          timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            last = now;
            fn.<span class="hljs-title function_">apply</span>(context, args);
          }, delay);
        } <span class="hljs-keyword">else</span> {
          last = now;
          fn.<span class="hljs-title function_">apply</span>(context, args);
        }
      };
    }

    <span class="hljs-keyword">const</span> inputA = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'undebounce'</span>);
    <span class="hljs-keyword">const</span> inputB = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'debounce'</span>);
    <span class="hljs-keyword">const</span> inputC = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'throttle'</span>);

    <span class="hljs-keyword">const</span> debouncedAjax = <span class="hljs-title function_">debounce</span>(ajax, <span class="hljs-number">500</span>);
    <span class="hljs-keyword">const</span> throttledAjax = <span class="hljs-title function_">throttle</span>(ajax, <span class="hljs-number">500</span>);

    inputA.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keyup'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-title function_">ajax</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
    });

    inputB.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keyup'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-title function_">debouncedAjax</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
    });

    inputC.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keyup'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-title function_">throttledAjax</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œåˆ†åˆ«åœ¨ä¸‰ä¸ªè¾“å…¥æ¡†å¿«é€Ÿè¾“å…¥ï¼Œä½ ä¼šæ¸…æ™°çœ‹åˆ°ä¸‰è€…çš„å·¨å¤§å·®å¼‚ã€‚</p>
<h2 data-id="heading-6">ç°ä»£æ¡†æ¶ä¸­çš„åº”ç”¨</h2>
<p>è™½ç„¶åŸç”Ÿ JS éœ€è¦æ‰‹å†™ï¼Œä½†ç°ä»£æ¡†æ¶/åº“å·²å†…ç½®ï¼š</p>
<ul>
<li>Lodashï¼š_.debounce(fn, wait) å’Œ _.throttle(fn, wait)</li>
<li>Vueï¼š@input.debounce="500ms"</li>
<li>Reactï¼šå¯é…åˆ useCallback + useRef å®ç°ï¼Œæˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹å¦‚ use-debounce</li>
</ul>
<p>ä½†ç†è§£åº•å±‚åŸç†ï¼Œèƒ½è®©ä½ åœ¨å¤æ‚åœºæ™¯ä¸‹è‡ªå®šä¹‰è¡Œä¸ºï¼ˆå¦‚ç«‹å³æ‰§è¡Œé€‰é¡¹ã€å–æ¶ˆåŠŸèƒ½ç­‰ï¼‰ã€‚</p>
<h2 data-id="heading-7">æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>æœç´¢è¾“å…¥</strong> â†’ é˜²æŠ–ï¼ˆèŠ‚çº¦èµ„æºï¼Œç”¨æˆ·è¾“å…¥å®Œæˆåå“åº”ï¼‰</li>
<li><strong>æ»šåŠ¨äº‹ä»¶</strong> â†’ èŠ‚æµï¼ˆä¿æŒæµç•…ï¼‰</li>
<li><strong>æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»</strong> â†’ é˜²æŠ–ï¼ˆdelay è®¾ä¸º 1000msï¼‰</li>
<li><strong>resize/scroll è®¡ç®—å¤æ‚å¸ƒå±€</strong> â†’ èŠ‚æµ</li>
<li><strong>æ‹–æ‹½è¿‡ç¨‹ä¸­å®æ—¶é¢„è§ˆ</strong> â†’ èŠ‚æµ</li>
</ol>
<h2 data-id="heading-8">ç»“è¯­</h2>
<p>é—­åŒ…æ˜¯ JavaScript æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œè€Œé˜²æŠ–å’ŒèŠ‚æµåˆ™æ˜¯å®ƒåœ¨æ€§èƒ½ä¼˜åŒ–é¢†åŸŸæœ€ç»å…¸çš„åº”ç”¨ä½“ç°ã€‚</p>
<p>é€šè¿‡åˆç†ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>å¤§å¹…å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚å’Œè®¡ç®—</li>
<li>æå‡é¡µé¢å“åº”é€Ÿåº¦å’Œæµç•…åº¦</li>
<li>æ”¹å–„ç”¨æˆ·ä½“éªŒ</li>
<li>é™ä½æœåŠ¡å™¨å‹åŠ›</li>
</ul>
<p>æ— è®ºä½ æ˜¯é¢è¯•è¢«é—®â€œæ‰‹å†™é˜²æŠ–èŠ‚æµâ€ï¼Œè¿˜æ˜¯å®é™…é¡¹ç›®ä¸­é‡åˆ°å¡é¡¿é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯ä½ å·¥å…·ç®±ä¸­ä¸å¯æˆ–ç¼ºçš„åˆ©å™¨ã€‚</p>
<p>å»ºè®®ç«‹å³å¤åˆ¶ä¸Šé¢çš„å®Œæ•´ç¤ºä¾‹åˆ°æœ¬åœ°è¿è¡Œï¼Œäº²èº«ä½“éªŒä¸‰è€…çš„å·®å¼‚â€”â€”ç†è®ºç»“åˆå®è·µï¼Œä½ æ‰èƒ½çœŸæ­£æŒæ¡ã€‚</p>
<p>å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼Œä»ç†è§£é—­åŒ…å¼€å§‹ï¼Œä»æ‰‹å†™é˜²æŠ–èŠ‚æµèµ·æ­¥ã€‚æ„¿ä½ çš„é¡µé¢æ°¸è¿œä¸æ»‘æµç•…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¥¯2025 å¹´ç»ˆæé¿å‘æŒ‡å—ï¼šSpring Boot 2.7 + 3.2 æ··åˆé›†ç¾¤çš„ Redis + OAuth2 åºåˆ—åŒ–è¡€æ³ªå²]]></title>    <link>https://juejin.cn/post/7589250237069639690</link>    <guid>https://juejin.cn/post/7589250237069639690</guid>    <pubDate>2025-12-30T09:50:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589250237069639690" data-draft-id="7589474656874627082" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¥¯2025 å¹´ç»ˆæé¿å‘æŒ‡å—ï¼šSpring Boot 2.7 + 3.2 æ··åˆé›†ç¾¤çš„ Redis + OAuth2 åºåˆ—åŒ–è¡€æ³ªå²"/> <meta itemprop="keywords" content="åç«¯,Java,Spring Cloud"/> <meta itemprop="datePublished" content="2025-12-30T09:50:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·352180245475"/> <meta itemprop="url" content="https://juejin.cn/user/156576846710315"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¥¯2025 å¹´ç»ˆæé¿å‘æŒ‡å—ï¼šSpring Boot 2.7 + 3.2 æ··åˆé›†ç¾¤çš„ Redis + OAuth2 åºåˆ—åŒ–è¡€æ³ªå²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/156576846710315/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·352180245475
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:50:34.000Z" title="Tue Dec 30 2025 09:50:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§äº‹ï¼šè®¤è¯ä¸­å¿ƒä¸æ•¢åŠ¨ï¼ˆæ€•å‡çº§ç‚¸ï¼‰ï¼Œä¸šåŠ¡æœåŠ¡å´å…¨å‡åˆ° Boot 3.2ï¼Œç»“æœ Redis å…±äº«æ•°æ®æˆäº†â€œæˆ˜åœºâ€ï¼Ÿ æˆ‘è¸©äº†ä¸€ä¸ªæœˆçš„å‘ï¼Œä» Jackson å¼‚å¸¸ç‹‚è½°æ»¥ç‚¸ï¼Œåˆ° Redis å¯†ç ç‰¹æ®Šç¬¦å·é—¹å‰§ï¼Œå†åˆ°è„æ•°æ®æš—æ€â€¦â€¦ä»Šå¤©æŠŠå…¨è¿‡ç¨‹å†™æˆè¿™ç¯‡åšå®¢ï¼Œè½»æ¾æ´»æ³¼ç‰ˆï¼Œä¿è¯ä½ çœ‹å®Œç¬‘ç€å°±æŠŠå‘é¿å¼€ï¼</p>
<h3 data-id="heading-0">ä¸ºä»€ä¹ˆæˆ‘ä¼šæ‰è¿›è¿™ä¸ªå¤§å‘ï¼Ÿ</h3>
<p>ç®€å•è¯´ï¼šå…¬å¸è®¤è¯ä¸­å¿ƒç”¨ Boot 2.7 + è€ Authorization Serverï¼ˆ0.2.3/0.4.xï¼‰ï¼Œç¨³å¦‚è€ç‹—ï¼Œç»´æŠ¤åˆ° 2028 å¹´ã€‚ ä¸šåŠ¡å¾®æœåŠ¡å…¨å‡ Boot 3.2ï¼Œäº«å— VirtualThreadã€æ–°ç‰¹æ€§ã€‚ å…±äº« Redis å­˜ Session + OAuth2Authorization â†’ åºåˆ—åŒ–ä¸å…¼å®¹ â†’ å…¨çº¿çˆ†ç‚¸ï¼</p>
<p>æˆ‘å½“æ—¶æƒ³ï¼šâ€œä¸å°±ä¸ªåºåˆ—åŒ–å—ï¼ŒåŠ å‡ ä¸ª Jackson Module ä¸å°±å®Œäº†ï¼Ÿâ€ ç»“æœâ€¦â€¦ä¸€ä¸ªæœˆåæˆ‘æ‰çˆ¬å‡ºæ¥ğŸ˜‚</p>
<h3 data-id="heading-1">æˆ‘åˆ°åº•å‘ç°äº†å“ªäº›é¬¼ç•œé—®é¢˜ï¼Ÿ</h3>
<ol>
<li>
<p>Jackson å¼‚å¸¸è¿ç¯æ€</p>
<ul>
<li>Cannot construct instance of SimpleGrantedAuthorityï¼ˆGrantedAuthority å˜ record äº†ï¼‰</li>
<li>Unrecognized field "settings"ï¼ˆè€ç‰ˆæœ¬é—ç•™å­—æ®µï¼‰</li>
<li>Cannot construct instance of ClientSettings/TokenSettingsï¼ˆæ— é»˜è®¤æ„é€ å‡½æ•°ï¼‰</li>
<li>The token generator failed to generate the access tokenï¼ˆsettings ä¸º nullï¼Œæœ€éšæ™¦çš„å‘ï¼ï¼‰</li>
</ul>
</li>
<li>
<p>NPE ä¸ null ç‹‚é­”</p>
<ul>
<li>tokens ä¸º null â†’ getAccessToken() NPE</li>
<li>attributes.putAll(null) â†’ HashMap NPE</li>
<li>GenericJackson2JsonRedisSerializer åŠ  "value" åŒ…è£…ï¼Œå¯¼è‡´æµ‹è¯•å’Œç”Ÿäº§è¡Œä¸ºä¸ä¸€è‡´</li>
</ul>
</li>
<li>
<p>åˆ·æ–°ä»¤ç‰Œå¼‚å¸¸</p>
<ul>
<li>Type id handling not implemented for java.lang.Object</li>
<li>Unrecognized field "settings"</li>
<li>Problem deserializing 'setterless' property</li>
<li>OAuth2AuthenticationException: The token generator failed</li>
</ul>
</li>
<li>
<p>ç»ˆæ Bossï¼šè„æ•°æ®</p>
<ul>
<li>Redis é‡Œæ··è¿› Boot 3.2 å†™çš„æ•°æ®ï¼ˆattributes æœ‰ "java.security.Principal" keyï¼‰</li>
<li>Boot 2.7 è¯»åˆ°ç›´æ¥åè¡€</li>
</ul>
</li>
</ol>
<h3 data-id="heading-2">æˆ‘æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥çˆ¬å‡ºæ¥çš„ï¼Ÿï¼ˆè§£å†³è¿‡ç¨‹è¶…æç¬‘ï¼‰</h3>
<ol>
<li>
<p><strong>Jackson è¡¥ä¸å¤§æˆ˜</strong> åŠ äº† SecurityJackson2Moduleã€OAuth2LegacyJacksonModule å¤„ç†ç‰¹æ®Šç±»ã€‚ å†™äº†è‡ªå®šä¹‰ Deserializerï¼Œæ‰‹åŠ¨å¡«å…… tokensï¼ˆå› ä¸ºè€ç‰ˆæœ¬æ²¡æœ‰ setterï¼‰ã€‚ visibility é…ç½® FIELD ANY è®© Jackson çœ‹åˆ° private å­—æ®µã€‚</p>
</li>
<li>
<p><strong>NPE çŒæ€æ—¶åˆ»</strong> attributes åˆ¤ nullï¼ŒauthorizationGrantType åˆ¤ nullã€‚ å‘ç° GenericJackson2JsonRedisSerializer ä¼šåŠ  "value" åŒ…è£… â†’ æµ‹è¯•è¦ç”¨ serializer.serialize() å­˜æ•°æ®ã€‚</p>
</li>
<li>
<p>è‡ªå®šä¹‰ Provider åï¼Œ<strong>ç§»é™¤é»˜è®¤çš„Provider</strong></p>
</li>
<li>
<p>è„æ•°æ®å¤§æ¸…æ´—</p>
<p>ä¸€æ¡å‘½ä»¤è§£å†³ 90% é—®é¢˜ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-css" lang="css">Â redis-cli <span class="hljs-attr">--scan</span> <span class="hljs-attr">--pattern</span> "*:token::*<span class="hljs-string">" | xargs redis-cli del
</span></code></pre>
<p>æ¸…ç†å®Œé‡æ–°ç™»å½•ï¼Œä¸–ç•Œå®‰é™äº†ğŸ˜‚</p>
</li>
</ol>
<h3 data-id="heading-3">ç»ˆææ— æ•Œé…ç½®ï¼ˆå¤åˆ¶å³ç”¨ï¼Œ2025 å¹´è€é¡¹ç›®æ•‘æ˜Ÿï¼‰</h3>
<ul>
<li><strong>PublicJsonRedisSerializer</strong>:springboot3ä¸springboot2éƒ½ä½¿ç”¨è¿™ä¸ªç±»ï¼ŒSecurityå…¬å…± JSON åºåˆ—åŒ–å™¨</li>
</ul>
<pre><code class="hljs language-arduino" lang="arduino">Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonTypeInfo;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.DeserializationFeature;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.jsontype.BasicPolymorphicTypeValidator;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-keyword">module</span>.SimpleModule;
Â <span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
Â <span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;
Â <span class="hljs-keyword">import</span> org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.server.authorization.OAuth2Authorization;
Â â€‹
Â @Configuration
Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PublicJsonRedisSerializer</span> {
Â â€‹
Â  Â  Â <span class="hljs-comment">/**
Â  Â  Â  * å…¬å…± JSON åºåˆ—åŒ–å™¨ï¼ˆæˆ‘ä»¬æ‰“ç£¨ä¸‡å¹´çš„ç»ˆæç‰ˆï¼‰
Â  Â  Â  * åå­—å« publicJsonRedisSerializerï¼Œæ‰€æœ‰åœ°æ–¹ç»Ÿä¸€ç”¨è¿™ä¸ª
Â  Â  Â  */</span>
Â  Â  Â @<span class="hljs-function">Bean
Â  Â  Â <span class="hljs-keyword">public</span> GenericJackson2JsonRedisSerializer <span class="hljs-title">publicJsonRedisSerializer</span><span class="hljs-params">()</span> </span>{
Â  Â  Â  Â  Â ObjectMapper objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ObjectMapper</span>();
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// Java8 æ—¶é—´æ”¯æŒ</span>
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">registerModule</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">JavaTimeModule</span>());
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">disable</span>(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
Â â€‹
Â  Â  Â  Â  Â SimpleModule <span class="hljs-keyword">module</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SimpleModule</span>(<span class="hljs-string">"OAuth2AuthorizationModule"</span>);
Â  Â  Â  Â  Â <span class="hljs-keyword">module</span>.<span class="hljs-built_in">addDeserializer</span>(OAuth2Authorization.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">OAuth2AuthorizationDeserializer</span>());
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">registerModule</span>(<span class="hljs-keyword">module</span>);
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// å…¨å±€å¿½ç•¥æœªçŸ¥å­—æ®µï¼ˆæ²»æ„ˆå†å²è„æ•°æ®ï¼‰</span>
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">configure</span>(com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="hljs-literal">false</span>);
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">configure</span>(DeserializationFeature.READ_UNKNOWN_ENUM_VALUES_AS_NULL, <span class="hljs-literal">true</span>);
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">registerModule</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">SecurityJackson2Module</span>());
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">registerModule</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">OAuth2LegacyJacksonModule</span>());
Â  Â  Â  Â  Â <span class="hljs-comment">// å®‰å…¨çš„å¤šæ€æ”¯æŒï¼ˆBoot 3 æ¨èå†™æ³•ï¼‰</span>
Â  Â  Â  Â  Â objectMapper.<span class="hljs-built_in">activateDefaultTyping</span>(
Â  Â  Â  Â  Â  Â  Â  Â  Â BasicPolymorphicTypeValidator.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .<span class="hljs-built_in">allowIfBaseType</span>(Object.<span class="hljs-keyword">class</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .<span class="hljs-built_in">build</span>(),
Â  Â  Â  Â  Â  Â  Â  Â  Â ObjectMapper.DefaultTyping.NON_FINAL,
Â  Â  Â  Â  Â  Â  Â  Â  Â JsonTypeInfo.As.PROPERTY
Â  Â  Â  Â   );
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">GenericJackson2JsonRedisSerializer</span>(objectMapper);
Â  Â   }
Â }
Â â€‹
</code></pre>
<p>RedisTemplate å¼ºåˆ¶ç”¨å®ƒï¼ŒOAuth2AuthorizationService ä¹Ÿå¼ºåˆ¶ç”¨å®ƒã€‚</p>
<ul>
<li>
<p>OAuth2AuthorizationDeserializer</p>
<p>å› ä¸º spring-security-oauth2-authorization-server 0.2.3 ç‰ˆæœ¬çš„ååºåˆ—åŒ–è®¾è®¡å¤ªâ€œåäººç±»â€äº†ï¼ŒJackson é»˜è®¤æ–¹å¼æ ¹æœ¬è¯»ä¸å‡ºæ¥å®Œæ•´çš„ OAuth2Authorization å¯¹è±¡ï¼Œå°¤å…¶æ˜¯ accessTokenã€refreshToken ç­‰å…³é”® token ä¼šä¸¢å¤±ï¼Œå¯¼è‡´ getAccessToken() è¿”å› nullï¼Œè¿›è€Œå¼•å‘ NPE æˆ– introspect å¤±è´¥ã€‚</p>
<p><strong>æ ¸å¿ƒé—®é¢˜ï¼ˆè€ç‰ˆæœ¬ 0.2.3 çš„â€œå‘ç‹è®¾è®¡â€ï¼‰</strong></p>
<ul>
<li>
<p>JSON æ ¼å¼æ˜¯ç‹¬ç«‹çš„å­—æ®µ</p>
<pre><code class="hljs language-perl" lang="perl">Â {
Â  Â <span class="hljs-string">"accessToken"</span>: { <span class="hljs-string">"@class"</span>: <span class="hljs-string">"OAuth2Authorization$Token"</span>, <span class="hljs-string">"token"</span>: { ... } },
Â  Â <span class="hljs-string">"refreshToken"</span>: { ... }
Â }
</code></pre>
</li>
</ul>

<ul>
<li>
<p>ç±»ç»“æ„å´æ˜¯ private final tokens Map</p>
<pre><code class="hljs language-swift" lang="swift">Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Map</span>&lt;<span class="hljs-type">Class</span>&lt;? extends <span class="hljs-type">OAuth2Token</span>&gt;, <span class="hljs-type">Token</span>&lt;?&gt;&gt; tokens <span class="hljs-operator">=</span> new <span class="hljs-type">HashMap</span>&lt;&gt;();
Â <span class="hljs-comment">// æ²¡æœ‰ public setAccessToken() / setRefreshToken()</span>
Â <span class="hljs-comment">// å”¯ä¸€åˆæ³•å¡«å……æ–¹å¼æ˜¯ Builder.token(...) â†’ build()</span>
</code></pre>
</li>
</ul>

<ul>
<li>
<p>Jackson é»˜è®¤è¡Œä¸º</p>
<ul>
<li>çœ‹åˆ° "accessToken" å­—æ®µï¼Œä½†ç±»é‡Œæ²¡æœ‰å¯¹åº”çš„ setter â†’ å¿½ç•¥ï¼</li>
<li>tokens æ˜¯ private final â†’ é»˜è®¤ä¸å¡«å……</li>
<li>ç»“æœï¼šååºåˆ—åŒ–å tokens ä¸ºç©º â†’ getAccessToken()/getRefreshToken() å…¨æ˜¯ null â†’ ä¸šåŠ¡çˆ†ç‚¸</li>
</ul>
</li>
</ul>
<p><strong>å®Œæ•´ä»£ç </strong></p>
<pre><code class="hljs language-ini" lang="ini">Â import com.fasterxml.jackson.core.JsonParser<span class="hljs-comment">;</span>
Â import com.fasterxml.jackson.databind.DeserializationContext<span class="hljs-comment">;</span>
Â import com.fasterxml.jackson.databind.JsonNode<span class="hljs-comment">;</span>
Â import com.fasterxml.jackson.databind.ObjectMapper<span class="hljs-comment">;</span>
Â import com.fasterxml.jackson.databind.deser.std.StdDeserializer<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.AuthorizationGrantType<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.ClientAuthenticationMethod<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.OAuth2AccessToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.OAuth2RefreshToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.OAuth2Authorization<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.client.RegisteredClient<span class="hljs-comment">;</span>
Â â€‹
Â import java.io.IOException<span class="hljs-comment">;</span>
Â import java.time.Instant<span class="hljs-comment">;</span>
Â import java.util.HashMap<span class="hljs-comment">;</span>
Â import java.util.HashSet<span class="hljs-comment">;</span>
Â import java.util.Map<span class="hljs-comment">;</span>
Â import java.util.Set<span class="hljs-comment">;</span>
Â â€‹
Â public class OAuth2AuthorizationDeserializer extends StdDeserializer&lt;OAuth2Authorization&gt; {
Â â€‹
Â  Â  Â public OAuth2AuthorizationDeserializer() {
Â  Â  Â  Â  Â super(OAuth2Authorization.class)<span class="hljs-comment">;</span>
Â  Â   }
Â â€‹
Â  Â  Â @Override
Â  Â  Â public OAuth2Authorization deserialize(JsonParser p, DeserializationContext ctxt) throws IOException {
Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">root</span> = p.getCodec().readTree(p)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â ObjectMapper <span class="hljs-attr">mapper</span> = (ObjectMapper) p.getCodec()<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â // 1. åˆ›å»ºä¸€ä¸ªæœ€å°çš„åˆæ³• dummy RegisteredClientï¼ˆåªä¸ºé€šè¿‡ Builder æ ¡éªŒï¼‰
Â  Â  Â  Â  Â String <span class="hljs-attr">registeredClientId</span> = root.get(<span class="hljs-string">"registeredClientId"</span>).asText(<span class="hljs-string">"dummy"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â RegisteredClient <span class="hljs-attr">dummyClient</span> = RegisteredClient.withId(registeredClientId)
Â  Â  Â  Â  Â  Â  Â  Â   .clientId(registeredClientId)
Â  Â  Â  Â  Â  Â  Â  Â   .clientSecret("{noop}secret")
Â  Â  Â  Â  Â  Â  Â  Â   .clientAuthenticationMethod(ClientAuthenticationMethod.CLIENT_SECRET_BASIC)
Â  Â  Â  Â  Â  Â  Â  Â   .authorizationGrantType(AuthorizationGrantType.CLIENT_CREDENTIALS)
Â  Â  Â  Â  Â  Â  Â  Â   .scope("dummy")
Â  Â  Â  Â  Â  Â  Â  Â   .build()<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â // 2. å¼€å§‹æ„å»º
Â  Â  Â  Â  Â OAuth2Authorization.Builder <span class="hljs-attr">builder</span> = OAuth2Authorization.withRegisteredClient(dummyClient)
Â  Â  Â  Â  Â  Â  Â  Â   .id(root.get("id").asText())
Â  Â  Â  Â  Â  Â  Â  Â   .principalName(root.get("principalName").asText())<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â // authorizationGrantType
Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">grantNode</span> = root.get(<span class="hljs-string">"authorizationGrantType"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â String <span class="hljs-attr">grantTypeValue</span> = grantNode.has(<span class="hljs-string">"value"</span>) ? grantNode.get(<span class="hljs-string">"value"</span>).asText() : <span class="hljs-string">"client_credentials"</span><span class="hljs-comment">;</span>
Â  Â  Â  Â  Â builder.authorizationGrantType(new AuthorizationGrantType(grantTypeValue))<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â // authorizedScopes
Â  Â  Â  Â  Â if (root.has("authorizedScopes")) {
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">scopesArray</span> = root.get(<span class="hljs-string">"authorizedScopes"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (scopesArray.isArray() &amp;&amp; scopesArray.size() &gt; 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â Set&lt;String&gt; <span class="hljs-attr">scopes</span> = new HashSet&lt;&gt;()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">actualScopes</span> = scopesArray.get(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â for (JsonNode s : actualScopes) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â scopes.add(s.asText())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â  Â  Â builder.authorizedScopes(scopes)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â // attributesï¼ˆç©ºå°±ç©ºï¼Œæ²¡äº‹ï¼‰
Â  Â  Â  Â  Â if (root.has("attributes")) {
Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">attributes</span> = mapper.treeToValue(root.get(<span class="hljs-string">"attributes"</span>), Map.class)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â builder.attributes(attrs -&gt; attrs.putAll(attributes))<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â // ========== å…³é”®ï¼šæ‰‹åŠ¨è§£æ Token èŠ‚ç‚¹ï¼Œè‡ªå·± new Token&lt;&gt;() ==========
Â  Â  Â  Â  Â if (root.has("accessToken")) {
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">accessTokenNode</span> = root.get(<span class="hljs-string">"accessToken"</span>)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â // è§£æ OAuth2AccessToken
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">tokenNode</span> = accessTokenNode.get(<span class="hljs-string">"token"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â String <span class="hljs-attr">tokenValue</span> = tokenNode.get(<span class="hljs-string">"tokenValue"</span>).asText()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â Instant <span class="hljs-attr">issuedAt</span> = tokenNode.has(<span class="hljs-string">"issuedAt"</span>) ? Instant.parse(tokenNode.get(<span class="hljs-string">"issuedAt"</span>).asText()) : null<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â Instant <span class="hljs-attr">expiresAt</span> = tokenNode.has(<span class="hljs-string">"expiresAt"</span>) ? Instant.parse(tokenNode.get(<span class="hljs-string">"expiresAt"</span>).asText()) : null<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">tokenTypeNode</span> = tokenNode.get(<span class="hljs-string">"tokenType"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â OAuth2AccessToken.TokenType <span class="hljs-attr">tokenType</span> =
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â OAuth2AccessToken.TokenType.BEARER<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â Set&lt;String&gt; <span class="hljs-attr">scopes</span> = new HashSet&lt;&gt;()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (tokenNode.has("scopes")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">scopesWrapper</span> = tokenNode.get(<span class="hljs-string">"scopes"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â if (scopesWrapper.isArray() &amp;&amp; scopesWrapper.size() &gt; 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">scopesArray</span> = scopesWrapper.get(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â for (JsonNode s : scopesArray) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â scopes.add(s.asText())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â OAuth2AccessToken <span class="hljs-attr">accessToken</span> = new OAuth2AccessToken(tokenType, tokenValue, issuedAt, expiresAt, scopes)<span class="hljs-comment">;</span>
Â â€‹
Â â€‹
Â // Â  Â  Â  Â  Â   OAuth2AccessToken <span class="hljs-attr">accessToken</span> = mapper.treeToValue(tokenNode, OAuth2AccessToken.class)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â // è§£æ metadataï¼ˆå¦‚æœæœ‰ï¼‰
Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">metadata</span> = new HashMap&lt;&gt;()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (accessTokenNode.has("metadata")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">metadata</span> = mapper.treeToValue(accessTokenNode.get(<span class="hljs-string">"metadata"</span>), Map.class)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â // è§£æ claimsï¼ˆå¦‚æœæœ‰ï¼‰
Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">claims</span> = null<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (accessTokenNode.has("claims")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">claims</span> = mapper.treeToValue(accessTokenNode.get(<span class="hljs-string">"claims"</span>), Map.class)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   } else if (metadata.containsKey(OAuth2Authorization.Token.CLAIMS_METADATA_NAME)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">claims</span> = (Map&lt;String, Object&gt;) metadata.get(OAuth2Authorization.Token.CLAIMS_METADATA_NAME)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â // å…³é”®ï¼šæ­£ç¡®è°ƒç”¨ token æ–¹æ³•
Â  Â  Â  Â  Â  Â  Â if (claims != null) {
Â  Â  Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">finalClaims</span> = claims<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">finalMetadata</span> = metadata<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â builder.token(accessToken, meta -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â meta.putAll(finalMetadata)<span class="hljs-comment">; Â // å…ˆæ”¾åŸæœ‰ metadata</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â meta.put(OAuth2Authorization.Token.CLAIMS_METADATA_NAME, finalClaims)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â   })<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">finalMetadata</span> = metadata<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â builder.token(accessToken, meta -&gt; meta.putAll(finalMetadata))<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (root.has("refreshToken")) {
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">refreshTokenNode</span> = root.get(<span class="hljs-string">"refreshToken"</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â JsonNode <span class="hljs-attr">tokenNode</span> = refreshTokenNode.get(<span class="hljs-string">"token"</span>)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â String <span class="hljs-attr">tokenValue</span> = tokenNode.get(<span class="hljs-string">"tokenValue"</span>).asText()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â Instant <span class="hljs-attr">issuedAt</span> = tokenNode.has(<span class="hljs-string">"issuedAt"</span>) ? Instant.parse(tokenNode.get(<span class="hljs-string">"issuedAt"</span>).asText()) : null<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â Instant <span class="hljs-attr">expiresAt</span> = tokenNode.has(<span class="hljs-string">"expiresAt"</span>) ? Instant.parse(tokenNode.get(<span class="hljs-string">"expiresAt"</span>).asText()) : null<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â OAuth2RefreshToken <span class="hljs-attr">refreshToken</span> = new OAuth2RefreshToken(tokenValue, issuedAt, expiresAt)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">metadata</span> = new HashMap&lt;&gt;()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (refreshTokenNode.has("metadata")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">metadata</span> = mapper.treeToValue(refreshTokenNode.get(<span class="hljs-string">"metadata"</span>), Map.class)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">finalMetadata</span> = metadata<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â builder.token(refreshToken, meta -&gt; meta.putAll(finalMetadata))<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â  Â  Â  Â  Â return builder.build()<span class="hljs-comment">;</span>
Â  Â   }
Â }
</code></pre>
</li>
</ul>

<ul>
<li>
<p><strong>SecurityJackson2Module</strong></p>
<p>åœ¨ Spring Securityï¼ˆåŒ…æ‹¬ Boot 2.7 å’Œ 3.xï¼‰é‡Œï¼Œç”¨æˆ·æƒé™æ˜¯ç”¨ SimpleGrantedAuthority è¡¨ç¤ºçš„ï¼š</p>
<p>Java</p>
<pre><code class="hljs language-arduino" lang="arduino">Â <span class="hljs-keyword">new</span> <span class="hljs-built_in">SimpleGrantedAuthority</span>(<span class="hljs-string">"ROLE_ADMIN"</span>)
</code></pre>
<p>è¿™ä¸ªç±»é•¿è¿™æ ·ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<p>Java</p>
<pre><code class="hljs language-arduino" lang="arduino">Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleGrantedAuthority</span> implements GrantedAuthority {
Â  Â   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> authority;  <span class="hljs-comment">// åªæœ‰è¿™ä¸ªå­—æ®µï¼Œæ²¡æœ‰ setterï¼</span>
Â â€‹
Â  Â   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SimpleGrantedAuthority</span><span class="hljs-params">(<span class="hljs-type">String</span> authority)</span> </span>{
Â  Â  Â  Â   <span class="hljs-keyword">this</span>.authority = authority;
Â  Â   }
Â â€‹
Â  Â   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getAuthority</span><span class="hljs-params">()</span> </span>{
Â  Â  Â  Â   <span class="hljs-keyword">return</span> authority;
Â  Â   }
Â }
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li><strong>æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°</strong></li>
<li><strong>æ²¡æœ‰ setter</strong></li>
<li><strong>åªæœ‰ getter</strong></li>
</ul>
<p>å½“ä½ ç”¨ Redis + JSON åºåˆ—åŒ–å­˜ç”¨æˆ·æƒé™ï¼ˆSession æˆ– OAuth2Authorizationï¼‰æ—¶ï¼ŒJSON ä¼šå˜æˆï¼š</p>
<p>JSON</p>
<pre><code class="hljs language-less" lang="less">Â {
Â   "<span class="hljs-variable">@class</span><span class="hljs-string">": "</span>org.springframework.security.core.authority.SimpleGrantedAuthority",
Â   <span class="hljs-string">"authority"</span>: <span class="hljs-string">"ROLE_ADMIN"</span>
Â }
</code></pre>
<p>Jackson ååºåˆ—åŒ–æ—¶å‚»çœ¼äº†ï¼š</p>
<ul>
<li>æ‰¾ä¸åˆ°æ— å‚æ„é€ å‡½æ•° â†’ æŠ¥ no Creators, like default constructor, exist</li>
<li>æ‰¾ä¸åˆ° setter â†’ ä¸çŸ¥é“æ€ä¹ˆè®¾ç½® authority å­—æ®µ</li>
</ul>
<p>ç»“æœï¼šæƒé™è¯»ä¸å‡ºæ¥ â†’ ç”¨æˆ·ç™»å½•åæƒé™ä¸ºç©º â†’ æ¥å£ 403 â†’ ä¸šåŠ¡å…¨ç‚¸ï¼</p>
<p><strong>å®Œæ•´çš„ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-scala" lang="scala">Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.core.<span class="hljs-type">JsonParser</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.core.<span class="hljs-type">JsonToken</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-type">DeserializationContext</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-type">JsonNode</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.deser.std.<span class="hljs-type">StdDeserializer</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.module.<span class="hljs-type">SimpleModule</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.core.authority.<span class="hljs-type">SimpleGrantedAuthority</span>;
Â â€‹
Â <span class="hljs-keyword">import</span> java.io.<span class="hljs-type">IOException</span>;
Â â€‹
Â public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityJackson2Module</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimpleModule</span> </span>{
Â â€‹
Â  Â  Â public <span class="hljs-type">SecurityJackson2Module</span>() {
Â  Â  Â  Â  Â <span class="hljs-keyword">super</span>();
Â  Â  Â  Â  Â <span class="hljs-comment">// åŒæ—¶å…¼å®¹ Spring Boot 2.7 å’Œ 3.x çš„ SimpleGrantedAuthority ååºåˆ—åŒ–</span>
Â  Â  Â  Â  Â addDeserializer(<span class="hljs-type">SimpleGrantedAuthority</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-type">SimpleGrantedAuthorityDeserializer</span>());
Â  Â   }
Â â€‹
Â  Â  Â static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleGrantedAuthorityDeserializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StdDeserializer&lt;SimpleGrantedAuthority&gt;</span> </span>{
Â â€‹
Â  Â  Â  Â  Â public <span class="hljs-type">SimpleGrantedAuthorityDeserializer</span>() {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">super</span>(<span class="hljs-type">SimpleGrantedAuthority</span>.<span class="hljs-keyword">class</span>);
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â public <span class="hljs-type">SimpleGrantedAuthority</span> deserialize(<span class="hljs-type">JsonParser</span> p, <span class="hljs-type">DeserializationContext</span> ctxt)
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ”¯æŒä¸¤ç§æ ¼å¼ï¼š{"authority":"ROLE_ADMIN"} æˆ– ç›´æ¥å­—ç¬¦ä¸² "ROLE_ADMIN"</span>
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (p.currentToken() == <span class="hljs-type">JsonToken</span>.<span class="hljs-type">VALUE_STRING</span>) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">SimpleGrantedAuthority</span>(p.getText());
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> node = p.getCodec().readTree(p);
Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">String</span> authority = <span class="hljs-literal">null</span>;
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (node.isTextual()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â authority = node.asText();
Â  Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.has(<span class="hljs-string">"authority"</span>)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â authority = node.get(<span class="hljs-string">"authority"</span>).asText();
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> authority != <span class="hljs-literal">null</span> ? <span class="hljs-keyword">new</span> <span class="hljs-type">SimpleGrantedAuthority</span>(authority) : <span class="hljs-literal">null</span>;
Â  Â  Â  Â   }
Â  Â   }
Â }
</code></pre>
</li>
</ul>

<ul>
<li>
<p>OAuth2LegacyJacksonModule</p>
<p>è¿™ä¸ª OAuth2LegacyJacksonModule æ‰æ˜¯æˆ‘æ•´ä¸ªåºåˆ—åŒ–å¤§æˆ˜çš„â€œæ•‘å‘½ç¨»è‰â€ï¼æ²¡æœ‰å®ƒï¼ŒBoot 2.7 è®¤è¯ä¸­å¿ƒè¯» Redis é‡Œçš„ OAuth2 æ•°æ®ï¼Œç›´æ¥åŸåœ°çˆ†ç‚¸ğŸ˜‚</p>
<p><strong>æ ¸å¿ƒé—®é¢˜ï¼ˆè€ Authorization Server çš„â€œé—äº§å‘â€ï¼‰</strong></p>
<p>åœ¨è€ç‰ˆæœ¬ spring-security-oauth2-authorization-serverï¼ˆ0.2.x/0.4.xï¼‰é‡Œï¼Œå‡ ä¸ªå…³é”®ç±»åºåˆ—åŒ–æ ¼å¼è¶…çº§â€œä»»æ€§â€ï¼š</p>
<ol>
<li>
<p>ClientAuthenticationMethod</p>
<ul>
<li>Boot 2.7 å­˜çš„æ˜¯å­—ç¬¦ä¸² "client_secret_basic"</li>
<li>Boot 3.2 å­˜çš„æ˜¯å¯¹è±¡ {"value": "client_secret_basic"}</li>
<li>Boot 2.7 è¯» Boot 3.2 çš„æ•°æ® â†’ Cannot construct instance (no delegate- or property-based Creator)</li>
</ul>
</li>
<li>
<p>AuthorizationGrantType</p>
<ul>
<li>åŒä¸Šï¼Œå­—ç¬¦ä¸² vs {"value": "..."} â†’ ç‚¸ï¼</li>
</ul>
</li>
<li>
<p>ClientSettings / TokenSettings</p>
<ul>
<li>Boot 3.2 æ˜¯ recordï¼ˆæ— é»˜è®¤æ„é€ å‡½æ•°ï¼‰</li>
<li>Boot 2.7 è¯»åˆ° â†’ no Creators, like default constructor, exist</li>
</ul>
</li>
<li>
<p>è€ç‰ˆæœ¬é—ç•™å­—æ®µ "settings"</p>
<ul>
<li>æ—©æœŸç‰ˆæœ¬æœ‰ "settings" å­—æ®µï¼Œåæ¥æ‹†æˆ clientSettings + tokenSettings</li>
<li>æ–°ä»£ç è¯»è€æ•°æ® â†’ Unrecognized field "settings"</li>
</ul>
</li>
</ol>
<p>ç»“æœï¼šç™»å½• â†’ ç™»å‡º â†’ å†ç™»å½•ï¼Œå¿…ç‚¸ï¼ï¼ˆå› ä¸ºç™»å‡ºæ¸… Sessionï¼Œé‡æ–°è¯» Redis é‡Œçš„ RegisteredClient/OAuth2Authorizationï¼‰</p>
<pre><code class="hljs language-scala" lang="scala">Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.core.<span class="hljs-type">JsonParser</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-type">DeserializationContext</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-type">JsonNode</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.deser.std.<span class="hljs-type">StdDeserializer</span>;
Â <span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.module.<span class="hljs-type">SimpleModule</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.core.<span class="hljs-type">AuthorizationGrantType</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.core.<span class="hljs-type">ClientAuthenticationMethod</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.server.authorization.settings.<span class="hljs-type">ClientSettings</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.server.authorization.settings.<span class="hljs-type">OAuth2TokenFormat</span>;
Â <span class="hljs-keyword">import</span> org.springframework.security.oauth2.server.authorization.settings.<span class="hljs-type">TokenSettings</span>;
Â â€‹
Â <span class="hljs-keyword">import</span> java.io.<span class="hljs-type">IOException</span>;
Â <span class="hljs-keyword">import</span> java.time.<span class="hljs-type">Duration</span>;
Â â€‹
Â public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OAuth2LegacyJacksonModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimpleModule</span> </span>{
Â â€‹
Â  Â  Â  Â  Â public <span class="hljs-type">OAuth2LegacyJacksonModule</span>() {
Â  Â  Â  Â  Â  Â  Â addDeserializer(<span class="hljs-type">ClientAuthenticationMethod</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-type">ClientAuthenticationMethodDeserializer</span>());
Â  Â  Â  Â  Â  Â  Â addDeserializer(<span class="hljs-type">AuthorizationGrantType</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-type">AuthorizationGrantTypeDeserializer</span>());
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ–°å¢è¿™ä¸¤è¡Œï¼Œä¸“æ²» ClientSettings å’Œ TokenSettingsï¼ˆBoot3 record æ ¼å¼ï¼‰</span>
Â  Â  Â  Â  Â  Â  Â addDeserializer(<span class="hljs-type">ClientSettings</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-type">ClientSettingsDeserializer</span>());
Â  Â  Â  Â  Â  Â  Â addDeserializer(<span class="hljs-type">TokenSettings</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-type">TokenSettingsDeserializer</span>());
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// ... ä½ ä¹‹å‰å·²æœ‰çš„ä¸¤ä¸ª Deserializer ä¸å˜ ...</span>
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// æ–°å¢ï¼šå…¼å®¹ Boot3 å­˜çš„ ClientSettings</span>
Â  Â  Â  Â  Â static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientSettingsDeserializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StdDeserializer&lt;ClientSettings&gt;</span> </span>{
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">ClientSettingsDeserializer</span>() {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">super</span>(<span class="hljs-type">ClientSettings</span>.<span class="hljs-keyword">class</span>);
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">ClientSettings</span> deserialize(<span class="hljs-type">JsonParser</span> p, <span class="hljs-type">DeserializationContext</span> ctxt) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> node = p.getCodec().readTree(p);
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// Boot3 é»˜è®¤å€¼ï¼šrequireProofKey=false, requireAuthorizationConsent=true</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â boolean requireProofKey = node.has(<span class="hljs-string">"requireProofKey"</span>) &amp;&amp; node.get(<span class="hljs-string">"requireProofKey"</span>).asBoolean();
Â  Â  Â  Â  Â  Â  Â  Â  Â boolean requireAuthorizationConsent = node.has(<span class="hljs-string">"requireAuthorizationConsent"</span>) ?
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â node.get(<span class="hljs-string">"requireAuthorizationConsent"</span>).asBoolean() : <span class="hljs-literal">true</span>;
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-type">ClientSettings</span>.builder()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .requireProofKey(requireProofKey)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .requireAuthorizationConsent(requireAuthorizationConsent)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .build();
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">ClientSettings</span> getNullValue(<span class="hljs-type">DeserializationContext</span> ctxt) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-type">ClientSettings</span>.builder()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .requireAuthorizationConsent(<span class="hljs-literal">true</span>) Â <span class="hljs-comment">// ä½ é¡¹ç›®å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯ true</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .requireProofKey(<span class="hljs-literal">false</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .build();
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// æ–°å¢ï¼šå…¼å®¹ Boot3 å­˜çš„ TokenSettings</span>
Â  Â  Â  Â  Â static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TokenSettingsDeserializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StdDeserializer&lt;TokenSettings&gt;</span> </span>{
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">TokenSettingsDeserializer</span>() {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">super</span>(<span class="hljs-type">TokenSettings</span>.<span class="hljs-keyword">class</span>);
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">TokenSettings</span> deserialize(<span class="hljs-type">JsonParser</span> p, <span class="hljs-type">DeserializationContext</span> ctxt) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> node = p.getCodec().readTree(p);
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">TokenSettings</span>.<span class="hljs-type">Builder</span> builder = <span class="hljs-type">TokenSettings</span>.builder();
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 1. accessTokenFormatï¼šä½ ä»£ç é‡Œè®¾çš„æ˜¯ REFERENCEï¼ˆä¸é€æ˜ä»¤ç‰Œï¼‰</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// Â   Boot3 é»˜è®¤æ˜¯ SELF_CONTAINEDï¼ˆJWTï¼‰ï¼Œæ‰€ä»¥å¿…é¡»æ˜¾å¼å¤„ç†</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (node != <span class="hljs-literal">null</span> &amp;&amp; node.has(<span class="hljs-string">"accessTokenFormat"</span>)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> formatNode = node.get(<span class="hljs-string">"accessTokenFormat"</span>);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (formatNode.has(<span class="hljs-string">"value"</span>)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">String</span> value = formatNode.get(<span class="hljs-string">"value"</span>).asText();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-string">"reference"</span>.equalsIgnoreCase(value)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.accessTokenFormat(<span class="hljs-type">OAuth2TokenFormat</span>.<span class="hljs-type">REFERENCE</span>);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.accessTokenFormat(<span class="hljs-type">OAuth2TokenFormat</span>.<span class="hljs-type">SELF_CONTAINED</span>);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// é»˜è®¤è·Ÿä½ ä»£ç ä¿æŒä¸€è‡´ï¼šREFERENCEï¼ˆå¤§éƒ¨åˆ†èµ„æºæœåŠ¡å™¨ + Redis å­˜å‚¨éƒ½ç”¨è¿™ä¸ªï¼‰</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.accessTokenFormat(<span class="hljs-type">OAuth2TokenFormat</span>.<span class="hljs-type">REFERENCE</span>);
Â  Â  Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 2. accessTokenTimeToLive</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (node != <span class="hljs-literal">null</span> &amp;&amp; node.has(<span class="hljs-string">"accessTokenTimeToLive"</span>)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â long seconds = node.get(<span class="hljs-string">"accessTokenTimeToLive"</span>).asLong();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.accessTokenTimeToLive(<span class="hljs-type">Duration</span>.ofSeconds(seconds));
Â  Â  Â  Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ç»™ä¸€ä¸ªå…œåº•é»˜è®¤å€¼ï¼ˆæ¯”å¦‚ 1 å°æ—¶ï¼‰ï¼Œé˜²æ­¢ null</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.accessTokenTimeToLive(<span class="hljs-type">Duration</span>.ofHours(<span class="hljs-number">1</span>));
Â  Â  Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 3. refreshTokenTimeToLive</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (node != <span class="hljs-literal">null</span> &amp;&amp; node.has(<span class="hljs-string">"refreshTokenTimeToLive"</span>)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â long seconds = node.get(<span class="hljs-string">"refreshTokenTimeToLive"</span>).asLong();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.refreshTokenTimeToLive(<span class="hljs-type">Duration</span>.ofSeconds(seconds));
Â  Â  Â  Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â builder.refreshTokenTimeToLive(<span class="hljs-type">Duration</span>.ofDays(<span class="hljs-number">30</span>)); <span class="hljs-comment">// å¸¸è§é»˜è®¤å€¼</span>
Â  Â  Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ä½ å¦‚æœè¿˜è®¾ç½®äº† reuseRefreshTokensã€idTokenSignatureAlgorithm ç­‰ï¼Œç»§ç»­åŠ å³å¯</span>
Â â€‹
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> builder.build();
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å…³é”®ï¼šå³ä½¿ Redis é‡Œå®Œå…¨æ²¡æœ‰ tokenSettings å­—æ®µï¼Œä¹Ÿè¦è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„é»˜è®¤å®ä¾‹ï¼</span>
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">TokenSettings</span> getNullValue(<span class="hljs-type">DeserializationContext</span> ctxt) {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-type">TokenSettings</span>.builder()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .accessTokenFormat(<span class="hljs-type">OAuth2TokenFormat</span>.<span class="hljs-type">REFERENCE</span>) Â <span class="hljs-comment">// è·Ÿä½ ä»£ç ä¿æŒä¸€è‡´</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .accessTokenTimeToLive(<span class="hljs-type">Duration</span>.ofHours(<span class="hljs-number">1</span>))
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .refreshTokenTimeToLive(<span class="hljs-type">Duration</span>.ofDays(<span class="hljs-number">30</span>))
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .build();
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// ä½ ä¹‹å‰å·²æœ‰çš„ä¸¤ä¸ªä¿æŒä¸å˜</span>
Â  Â  Â  Â  Â static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientAuthenticationMethodDeserializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StdDeserializer&lt;ClientAuthenticationMethod&gt;</span> </span>{
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">ClientAuthenticationMethodDeserializer</span>() { <span class="hljs-keyword">super</span>(<span class="hljs-type">ClientAuthenticationMethod</span>.<span class="hljs-keyword">class</span>); }
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span> public <span class="hljs-type">ClientAuthenticationMethod</span> deserialize(<span class="hljs-type">JsonParser</span> p, <span class="hljs-type">DeserializationContext</span> ctxt) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> node = p.getCodec().readTree(p);
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">String</span> value = node.isTextual() ? node.asText() : node.get(<span class="hljs-string">"value"</span>).asText();
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">ClientAuthenticationMethod</span>(value);
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthorizationGrantTypeDeserializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StdDeserializer&lt;AuthorizationGrantType&gt;</span> </span>{
Â  Â  Â  Â  Â  Â  Â public <span class="hljs-type">AuthorizationGrantTypeDeserializer</span>() { <span class="hljs-keyword">super</span>(<span class="hljs-type">AuthorizationGrantType</span>.<span class="hljs-keyword">class</span>); }
Â  Â  Â  Â  Â  Â  Â <span class="hljs-meta">@Override</span> public <span class="hljs-type">AuthorizationGrantType</span> deserialize(<span class="hljs-type">JsonParser</span> p, <span class="hljs-type">DeserializationContext</span> ctxt) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">JsonNode</span> node = p.getCodec().readTree(p);
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">String</span> value = node.isTextual() ? node.asText() : node.get(<span class="hljs-string">"value"</span>).asText();
Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">AuthorizationGrantType</span>(value);
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â }
</code></pre>
</li>
<li>
<p>oAuth2AuthorizationRedisTemplate</p>
<p>ä¸ºäº†ä¸å½±å“å…¶ä»–çš„ä¸šåŠ¡ä¿¡æ¯ï¼Œåˆ›å»ºä¸€ä¸ªè®¤è¯ç”¨çš„RedisTemplate,ä¸è®¤è¯ç›¸å…³çš„éƒ½ç”¨è¿™ä¸ªï¼ŒåŸæ¥çš„é‚£äº›ä¸šåŠ¡ä¸å˜ï¼Œå½“ç„¶å¦‚æœä½ æƒ³è¦éƒ½ä½¿ç”¨jsonæ¥ä¿å­˜ä¸šåŠ¡æ•°æ®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ŒæŒ‰éœ€æ¥æ“ä½œï¼</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-comment">/**
Â      * ä¸»è¦ç”¨äºå­˜å‚¨ OAuth2Authorizationï¼Œå¯¹æˆæƒçš„jsonåºåˆ—åŒ–
Â      * <span class="hljs-doctag">@param</span> <span class="hljs-variable">publicJsonRedisSerializer</span>
Â      * <span class="hljs-doctag">@param</span> <span class="hljs-variable">redisConnectionFactory</span>
Â      * <span class="hljs-doctag">@return</span>
Â      */</span>
Â     <span class="hljs-meta">@Bean</span>
Â     <span class="hljs-keyword">public</span> <span class="hljs-title class_">RedisTemplate</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">oAuth2AuthorizationRedisTemplate</span>(<span class="hljs-params">RedisSerializer&lt;<span class="hljs-built_in">Object</span>&gt; publicJsonRedisSerializer, RedisConnectionFactory redisConnectionFactory</span>) {
Â         <span class="hljs-title class_">RedisTemplate</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; redisTemplate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisTemplate</span>&lt;&gt;();
Â         redisTemplate.<span class="hljs-title function_">setKeySerializer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());
Â         redisTemplate.<span class="hljs-title function_">setHashKeySerializer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());
Â         redisTemplate.<span class="hljs-title function_">setValueSerializer</span>(publicJsonRedisSerializer);
Â         redisTemplate.<span class="hljs-title function_">setHashValueSerializer</span>(publicJsonRedisSerializer);
Â         redisTemplate.<span class="hljs-title function_">setConnectionFactory</span>(redisConnectionFactory);
Â         <span class="hljs-keyword">return</span> redisTemplate;
Â     }
</code></pre>
<p>é‡è¦ï¼Œè¿™è¾¹ä½¿ç”¨setValueSerializerä¸setHashValueSerializeréƒ½ä½¿ç”¨publicJsonRedisSerializerã€‚</p>
</li>
<li>
<p>RedisOAuth2AuthorizationService</p>
<p>ä¿®æ”¹è‡ªå·±çš„redisè®¤è¯æœåŠ¡ç±»ï¼Œæˆ‘çš„å¯èƒ½è·Ÿå¤§å®¶çš„ä¸ä¸€æ ·ï¼ŒæŒ‰ç…§è‡ªå·±çš„æ¥ï¼ä¸‹é¢ä»…ä¾›å‚è€ƒï¼</p>
<p><img src="" alt="image-20251230171343623" loading="lazy"/></p>
</li>
</ul>

<ul>
<li>
<p>è‡ªå®šä¹‰Provider</p>
<pre><code class="hljs language-ini" lang="ini">Â import org.apache.commons.logging.Log<span class="hljs-comment">;</span>
Â import org.apache.commons.logging.LogFactory<span class="hljs-comment">;</span>
Â import org.springframework.security.authentication.AuthenticationProvider<span class="hljs-comment">;</span>
Â import org.springframework.security.authentication.UsernamePasswordAuthenticationToken<span class="hljs-comment">;</span>
Â import org.springframework.security.core.Authentication<span class="hljs-comment">;</span>
Â import org.springframework.security.core.AuthenticationException<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.*<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.oidc.OidcIdToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.oidc.OidcScopes<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.core.oidc.endpoint.OidcParameterNames<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.jwt.Jwt<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.OAuth2Authorization<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.OAuth2TokenType<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.authentication.OAuth2AccessTokenAuthenticationToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.authentication.OAuth2ClientAuthenticationToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.authentication.OAuth2RefreshTokenAuthenticationToken<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.client.RegisteredClient<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.context.AuthorizationServerContextHolder<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.token.DefaultOAuth2TokenContext<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.token.OAuth2TokenContext<span class="hljs-comment">;</span>
Â import org.springframework.security.oauth2.server.authorization.token.OAuth2TokenGenerator<span class="hljs-comment">;</span>
Â import org.springframework.util.Assert<span class="hljs-comment">;</span>
Â â€‹
Â import java.util.Collections<span class="hljs-comment">;</span>
Â import java.util.HashMap<span class="hljs-comment">;</span>
Â import java.util.Map<span class="hljs-comment">;</span>
Â import java.util.Set<span class="hljs-comment">;</span>
Â â€‹
Â â€‹
Â public class OAuth2RefreshTokenAuthenticationProvider implements AuthenticationProvider {
Â  Â  Â private static final String <span class="hljs-attr">ERROR_URI</span> = <span class="hljs-string">"https://datatracker.ietf.org/doc/html/rfc6749#section-5.2"</span><span class="hljs-comment">;</span>
Â  Â  Â private static final OAuth2TokenType <span class="hljs-attr">ID_TOKEN_TOKEN_TYPE</span> = new OAuth2TokenType(OidcParameterNames.ID_TOKEN)<span class="hljs-comment">;</span>
Â  Â  Â private final Log <span class="hljs-attr">logger</span> = LogFactory.getLog(getClass())<span class="hljs-comment">;</span>
Â  Â  Â private final OAuth2AuthorizationService authorizationService<span class="hljs-comment">;</span>
Â  Â  Â private final OAuth2TokenGenerator&lt;? extends OAuth2Token&gt; tokenGenerator<span class="hljs-comment">;</span>
Â  Â  Â private final UserDetailsService userDetailsService<span class="hljs-comment">;</span>
Â  Â  Â /**
Â  Â  Â  * Constructs an {@code OAuth2RefreshTokenAuthenticationProvider} using the provided parameters.
Â  Â  Â  *
Â  Â  Â  * @param authorizationService the authorization service
Â  Â  Â  * @param tokenGenerator Â  Â  Â  the token generator
Â  Â  Â  * @since 0.2.3
Â  Â  Â  */
Â  Â  Â public OAuth2RefreshTokenAuthenticationProvider(OAuth2AuthorizationService authorizationService,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â OAuth2TokenGenerator&lt;? extends OAuth2Token&gt; tokenGenerator,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â UserDetailsService userDetailsService) {
Â  Â  Â  Â  Â Assert.notNull(authorizationService, "authorizationService cannot be null")<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â Assert.notNull(tokenGenerator, "tokenGenerator cannot be null")<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â <span class="hljs-attr">this.authorizationService</span> = authorizationService<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â <span class="hljs-attr">this.tokenGenerator</span> = tokenGenerator<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â <span class="hljs-attr">this.userDetailsService</span> = userDetailsService<span class="hljs-comment">;</span>
Â  Â   }
Â â€‹
Â  Â  Â @Override
Â  Â  Â public Authentication authenticate(Authentication authentication) throws AuthenticationException {
Â  Â  Â  Â  Â OAuth2RefreshTokenAuthenticationToken <span class="hljs-attr">refreshTokenAuthentication</span> =
Â  Â  Â  Â  Â  Â  Â  Â   (OAuth2RefreshTokenAuthenticationToken) authentication<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â OAuth2ClientAuthenticationToken <span class="hljs-attr">clientPrincipal</span> =
Â  Â  Â  Â  Â  Â  Â  Â  Â OAuth2AuthenticationProviderUtils.getAuthenticatedClientElseThrowInvalidClient(refreshTokenAuthentication)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â RegisteredClient <span class="hljs-attr">registeredClient</span> = clientPrincipal.getRegisteredClient()<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Retrieved registered client")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â OAuth2Authorization <span class="hljs-attr">authorization</span> = this.authorizationService.findByToken(
Â  Â  Â  Â  Â  Â  Â  Â  Â refreshTokenAuthentication.getRefreshToken(), OAuth2TokenType.REFRESH_TOKEN)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (<span class="hljs-attr">authorization</span> == null) {
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(OAuth2ErrorCodes.INVALID_GRANT)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Retrieved authorization with refresh token")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (!registeredClient.getId().equals(authorization.getRegisteredClientId())) {
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(OAuth2ErrorCodes.INVALID_CLIENT)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (!registeredClient.getAuthorizationGrantTypes().contains(AuthorizationGrantType.REFRESH_TOKEN)) {
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(OAuth2ErrorCodes.UNAUTHORIZED_CLIENT)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â OAuth2Authorization.Token&lt;OAuth2RefreshToken&gt; <span class="hljs-attr">refreshToken</span> = authorization.getRefreshToken()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (!refreshToken.isActive()) {
Â  Â  Â  Â  Â  Â  Â // As per https://tools.ietf.org/html/rfc6749<span class="hljs-comment">#section-5.2</span>
Â  Â  Â  Â  Â  Â  Â // invalid_grant: The provided authorization grant (e.g., authorization code,
Â  Â  Â  Â  Â  Â  Â // resource owner credentials) or refresh token is invalid, expired, revoked <span class="hljs-section">[...]</span>.
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(OAuth2ErrorCodes.INVALID_GRANT)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â // As per https://tools.ietf.org/html/rfc6749<span class="hljs-comment">#section-6</span>
Â  Â  Â  Â  Â // The requested scope MUST NOT include any scope not originally granted by the resource owner,
Â  Â  Â  Â  Â // and if omitted is treated as equal to the scope originally granted by the resource owner.
Â  Â  Â  Â  Â Set&lt;String&gt; <span class="hljs-attr">scopes</span> = refreshTokenAuthentication.getScopes()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â Set&lt;String&gt; <span class="hljs-attr">authorizedScopes</span> = authorization.getAuthorizedScopes()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (!authorizedScopes.containsAll(scopes)) {
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(OAuth2ErrorCodes.INVALID_SCOPE)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Validated token request parameters")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (scopes.isEmpty()) {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">scopes</span> = authorizedScopes<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â // Â  Â  Â   AuthenticationManager <span class="hljs-attr">authenticationManager</span> = http.getSharedObject(AuthenticationManager.class)<span class="hljs-comment">;</span>
Â // Â  Â  Â   Authentication <span class="hljs-attr">usernamePasswordAuthentication</span> = authenticationManager
Â // Â  Â  Â  Â  Â  Â  Â   .authenticate(new UsernamePasswordAuthenticationToken(authorization.getPrincipalName(),null))<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â //éœ€è¦ç›´æ¥è·å–åˆ°ç™»å½•ç”¨æˆ·ä¿¡æ¯
Â  Â  Â  Â  Â String <span class="hljs-attr">principalName</span> = authorization.getPrincipalName()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â User <span class="hljs-attr">user</span> = (User) userDetailsService.loadUserByUsername(principalName)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â Authentication <span class="hljs-attr">principalAuth</span> = new UsernamePasswordAuthenticationToken(user, null, user.getAuthorities())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â // @formatter:off
Â  Â  Â  Â  Â DefaultOAuth2TokenContext.Builder <span class="hljs-attr">tokenContextBuilder</span> = DefaultOAuth2TokenContext.builder()
Â  Â  Â  Â  Â  Â  Â  Â   .registeredClient(registeredClient)
Â  Â  Â  Â  Â  Â  Â  Â   .principal(principalAuth)
Â  Â  Â  Â  Â  Â  Â  Â   .authorizationServerContext(AuthorizationServerContextHolder.getContext())
Â  Â  Â  Â  Â  Â  Â  Â   .authorization(authorization)
Â  Â  Â  Â  Â  Â  Â  Â   .authorizedScopes(scopes)
Â  Â  Â  Â  Â  Â  Â  Â   .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
Â  Â  Â  Â  Â  Â  Â  Â   .authorizationGrant(refreshTokenAuthentication)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â // @formatter:on
Â â€‹
Â  Â  Â  Â  Â OAuth2Authorization.Builder <span class="hljs-attr">authorizationBuilder</span> = OAuth2Authorization.from(authorization)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â // ----- Access token -----
Â  Â  Â  Â  Â OAuth2TokenContext <span class="hljs-attr">tokenContext</span> = tokenContextBuilder.tokenType(OAuth2TokenType.ACCESS_TOKEN).build()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â OAuth2Token <span class="hljs-attr">generatedAccessToken</span> = this.tokenGenerator.generate(tokenContext)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (<span class="hljs-attr">generatedAccessToken</span> == null) {
Â  Â  Â  Â  Â  Â  Â OAuth2Error <span class="hljs-attr">error</span> = new OAuth2Error(OAuth2ErrorCodes.SERVER_ERROR,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â "The token generator failed to generate the access token.", ERROR_URI)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(error)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Generated access token")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â OAuth2AccessToken <span class="hljs-attr">accessToken</span> = new OAuth2AccessToken(OAuth2AccessToken.TokenType.BEARER,
Â  Â  Â  Â  Â  Â  Â  Â  Â generatedAccessToken.getTokenValue(), generatedAccessToken.getIssuedAt(),
Â  Â  Â  Â  Â  Â  Â  Â  Â generatedAccessToken.getExpiresAt(), tokenContext.getAuthorizedScopes())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (generatedAccessToken instanceof ClaimAccessor) {
Â  Â  Â  Â  Â  Â  Â authorizationBuilder.token(accessToken, (metadata) -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â metadata.put(OAuth2Authorization.Token.CLAIMS_METADATA_NAME, ((ClaimAccessor) generatedAccessToken).getClaims())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â metadata.put(OAuth2Authorization.Token.INVALIDATED_METADATA_NAME, false)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   })<span class="hljs-comment">;</span>
Â  Â  Â  Â   } else {
Â  Â  Â  Â  Â  Â  Â authorizationBuilder.accessToken(accessToken)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â // ----- Refresh token -----
Â  Â  Â  Â  Â OAuth2RefreshToken <span class="hljs-attr">currentRefreshToken</span> = refreshToken.getToken()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (!registeredClient.getTokenSettings().isReuseRefreshTokens()) {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">tokenContext</span> = tokenContextBuilder.tokenType(OAuth2TokenType.REFRESH_TOKEN).build()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â OAuth2Token <span class="hljs-attr">generatedRefreshToken</span> = this.tokenGenerator.generate(tokenContext)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (!(generatedRefreshToken instanceof OAuth2RefreshToken)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â OAuth2Error <span class="hljs-attr">error</span> = new OAuth2Error(OAuth2ErrorCodes.SERVER_ERROR,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â "The token generator failed to generate the refresh token.", ERROR_URI)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(error)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â this.logger.trace("Generated refresh token")<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">currentRefreshToken</span> = (OAuth2RefreshToken) generatedRefreshToken<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â authorizationBuilder.refreshToken(currentRefreshToken)<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â // ----- ID token -----
Â  Â  Â  Â  Â OidcIdToken idToken<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (authorizedScopes.contains(OidcScopes.OPENID)) {
Â  Â  Â  Â  Â  Â  Â // @formatter:off
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">tokenContext</span> = tokenContextBuilder
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .tokenType(ID_TOKEN_TOKEN_TYPE)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .authorization(authorizationBuilder.build())    // ID token customizer may need access to the access token and/or refresh token
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .build()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â // @formatter:on
Â  Â  Â  Â  Â  Â  Â OAuth2Token <span class="hljs-attr">generatedIdToken</span> = this.tokenGenerator.generate(tokenContext)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â if (!(generatedIdToken instanceof Jwt)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â OAuth2Error <span class="hljs-attr">error</span> = new OAuth2Error(OAuth2ErrorCodes.SERVER_ERROR,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â "The token generator failed to generate the ID token.", ERROR_URI)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â throw new OAuth2AuthenticationException(error)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â this.logger.trace("Generated id token")<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">idToken</span> = new OidcIdToken(generatedIdToken.getTokenValue(), generatedIdToken.getIssuedAt(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â generatedIdToken.getExpiresAt(), ((Jwt) generatedIdToken).getClaims())<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â authorizationBuilder.token(idToken, (metadata) -&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â metadata.put(OAuth2Authorization.Token.CLAIMS_METADATA_NAME, idToken.getClaims()))<span class="hljs-comment">;</span>
Â  Â  Â  Â   } else {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">idToken</span> = null<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-attr">authorization</span> = authorizationBuilder.build()<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â this.authorizationService.save(authorization)<span class="hljs-comment">;</span>
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Saved authorization")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â Map&lt;String, Object&gt; <span class="hljs-attr">additionalParameters</span> = Collections.emptyMap()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â if (idToken != null) {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">additionalParameters</span> = new HashMap&lt;&gt;()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â additionalParameters.put(OidcParameterNames.ID_TOKEN, idToken.getTokenValue())<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â if (this.logger.isTraceEnabled()) {
Â  Â  Â  Â  Â  Â  Â this.logger.trace("Authenticated token request")<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â return new OAuth2AccessTokenAuthenticationToken(
Â  Â  Â  Â  Â  Â  Â  Â  Â registeredClient, clientPrincipal, accessToken, currentRefreshToken, additionalParameters)<span class="hljs-comment">;</span>
Â  Â   }
Â â€‹
Â  Â  Â @Override
Â  Â  Â public boolean supports(Class&lt;?&gt; authentication) {
Â  Â  Â  Â  Â return OAuth2RefreshTokenAuthenticationToken.class.isAssignableFrom(authentication)<span class="hljs-comment">;</span>
Â  Â   }
Â }
Â â€‹
</code></pre>
</li>
<li>
<p>OAuth2AuthenticationProviderUtils</p>
<pre><code class="hljs language-scss" lang="scss">Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.Authentication</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.OAuth2AuthenticationException</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.OAuth2ErrorCodes</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.OAuth2RefreshToken</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.OAuth2Token</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.server</span><span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.OAuth2Authorization</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.server</span><span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.OAuth2AuthorizationCode</span>;
Â import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.oauth2</span><span class="hljs-selector-class">.server</span><span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.authentication</span><span class="hljs-selector-class">.OAuth2ClientAuthenticationToken</span>;
Â â€‹
Â public class OAuth2AuthenticationProviderUtils {
Â  Â  Â private <span class="hljs-built_in">OAuth2AuthenticationProviderUtils</span>() {
Â  Â   }
Â â€‹
Â  Â  Â static OAuth2ClientAuthenticationToken <span class="hljs-built_in">getAuthenticatedClientElseThrowInvalidClient</span>(Authentication authentication) {
Â  Â  Â  Â  Â OAuth2ClientAuthenticationToken clientPrincipal = null;
Â  Â  Â  Â  Â if (OAuth2ClientAuthenticationToken.class.isAssignableFrom(authentication.getPrincipal()<span class="hljs-selector-class">.getClass</span>())) {
Â  Â  Â  Â  Â  Â  Â clientPrincipal = (OAuth2ClientAuthenticationToken) authentication<span class="hljs-selector-class">.getPrincipal</span>();
Â  Â  Â  Â   }
Â  Â  Â  Â  Â if (clientPrincipal != null &amp;&amp; clientPrincipal.isAuthenticated()) {
Â  Â  Â  Â  Â  Â  Â return clientPrincipal;
Â  Â  Â  Â   }
Â  Â  Â  Â  Â throw new <span class="hljs-built_in">OAuth2AuthenticationException</span>(OAuth2ErrorCodes.INVALID_CLIENT);
Â  Â   }
Â â€‹
Â  Â  Â static &lt;T extends OAuth2Token&gt; OAuth2Authorization <span class="hljs-built_in">invalidate</span>(
Â  Â  Â  Â  Â  Â  Â OAuth2Authorization authorization, T token) {
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-comment">// @formatter:off</span>
Â  Â  Â  Â  Â OAuth2Authorization<span class="hljs-selector-class">.Builder</span> authorizationBuilder = OAuth2Authorization<span class="hljs-selector-class">.from</span>(authorization)
Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-selector-class">.token</span>(token,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (metadata) -&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â metadata<span class="hljs-selector-class">.put</span>(OAuth2Authorization.Token.INVALIDATED_METADATA_NAME, true));
Â â€‹
Â  Â  Â  Â  Â if (OAuth2RefreshToken.class.isAssignableFrom(token.getClass())) {
Â  Â  Â  Â  Â  Â  Â authorizationBuilder<span class="hljs-selector-class">.token</span>(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â authorization.getAccessToken()<span class="hljs-selector-class">.getToken</span>(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (metadata) -&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â metadata<span class="hljs-selector-class">.put</span>(OAuth2Authorization.Token.INVALIDATED_METADATA_NAME, true));
Â â€‹
Â  Â  Â  Â  Â  Â  Â OAuth2Authorization<span class="hljs-selector-class">.Token</span>&lt;OAuth2AuthorizationCode&gt; authorizationCode =
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â authorization<span class="hljs-selector-class">.getToken</span>(OAuth2AuthorizationCode.class);
Â  Â  Â  Â  Â  Â  Â if (authorizationCode != null &amp;&amp; !authorizationCode.isInvalidated()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â authorizationBuilder<span class="hljs-selector-class">.token</span>(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â authorizationCode.getToken(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (metadata) -&gt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â metadata<span class="hljs-selector-class">.put</span>(OAuth2Authorization.Token.INVALIDATED_METADATA_NAME, true));
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â   }
Â  Â  Â  Â  Â <span class="hljs-comment">// @formatter:on</span>
Â â€‹
Â  Â  Â  Â  Â return authorizationBuilder<span class="hljs-selector-class">.build</span>();
Â  Â   }
Â }
</code></pre>
</li>
<li>
<p>AuthorizationServerConfiguration,ä»»åŠ¡æœåŠ¡çš„é…ç½®é¡¹ï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œå½±å“åˆ°tokençš„åˆ·æ–°åŠŸèƒ½</p>
<pre><code class="hljs language-less" lang="less">Â <span class="hljs-selector-tag">http</span><span class="hljs-selector-class">.apply</span>(authorizationServerConfigurer.<span class="hljs-built_in">tokenEndpoint</span>((tokenEndpoint) -&gt; {<span class="hljs-comment">// ä¸ªæ€§åŒ–è®¤è¯æˆæƒç«¯ç‚¹</span>
Â                     <span class="hljs-comment">//å¤„ç† OAuth2RefreshTokenAuthenticationToken åˆ·æ–°ä»¤ç‰Œ</span>
Â             OAuth2RefreshTokenAuthenticationProvider oAuth2RefreshTokenAuthenticationProvider = new <span class="hljs-built_in">OAuth2RefreshTokenAuthenticationProvider</span>(
Â                     authorizationService, <span class="hljs-built_in">oAuth2TokenGenerator</span>(),slkjUserDetailsService);
Â â€‹
Â             tokenEndpoint.<span class="hljs-built_in">accessTokenRequestConverter</span>(<span class="hljs-built_in">accessTokenRequestConverter</span>()) <span class="hljs-comment">// æ³¨å…¥è‡ªå®šä¹‰çš„æˆæƒè®¤è¯Converter</span>
Â                     .<span class="hljs-built_in">authenticationProviders</span>(providers -&gt; {
Â                         <span class="hljs-comment">// ç§»é™¤é»˜è®¤çš„ OAuth2RefreshTokenAuthenticationProvider</span>
Â                         providers.<span class="hljs-built_in">removeIf</span>(p -&gt; p instanceof OAuth2RefreshTokenAuthenticationProvider);
Â                     })
Â                     .<span class="hljs-built_in">authenticationProvider</span>(slkjOAuth2RefreshTokenAuthenticationProvider)
Â                     .<span class="hljs-built_in">accessTokenResponseHandler</span>(successEventHandler) <span class="hljs-comment">// ç™»å½•æˆåŠŸå¤„ç†å™¨</span>
Â                     .<span class="hljs-built_in">errorResponseHandler</span>(failureEventHandler);<span class="hljs-comment">// ç™»å½•å¤±è´¥å¤„ç†å™¨</span>
Â         }).<span class="hljs-built_in">clientAuthentication</span>(oAuth2ClientAuthenticationConfigurer -&gt; <span class="hljs-comment">// ä¸ªæ€§åŒ–å®¢æˆ·ç«¯è®¤è¯</span>
</code></pre>
<p>éœ€è¦å†è¿™è¾¹æ·»åŠ OAuth2RefreshTokenAuthenticationProviderï¼Œç„¶åç§»é™¤é»˜è®¤çš„ OAuth2RefreshTokenAuthenticationProvider</p>
</li>
</ul>
<h3 data-id="heading-4">å†™åœ¨æœ€åï¼šç»™è¿˜åœ¨å‘é‡Œçš„å…„å¼Ÿä»¬</h3>
<ul>
<li><strong>ç»Ÿä¸€ JSON åºåˆ—åŒ–</strong>ï¼ŒJDK åºåˆ—åŒ–è·¨ç‰ˆæœ¬å¿…ç‚¸ï¼</li>
<li><strong>æ¸…ç†è„æ•°æ®</strong>ï¼Œè¿™æ˜¯ 90% å¼‚å¸¸çš„å…ƒå‡¶ï¼</li>
<li><strong>åˆ«åŠ å¤ªå¤šè‡ªå®šä¹‰ Module</strong>ï¼Œå®¹æ˜“æŠŠè‡ªå·±ç©æ­»ğŸ˜‚</li>
<li><strong>æµ‹è¯•ç”¨ serializer.serialize() å­˜æ•°æ®</strong>ï¼Œåˆ«æ‰‹å†™ JSONï¼</li>
<li>è‡ªå®šä¹‰ Provider åï¼Œ<strong>ç§»é™¤é»˜è®¤çš„Provider</strong>ï¼</li>
</ul>
<p>å¦‚æœä½ ä¹Ÿåœ¨æ··ç”¨ Boot 2.7 å’Œ 3.2ï¼Œèµ¶ç´§æ”¶è—è¿™ç¯‡ï¼ è¸©å‘ä¸€ä¸ªæœˆï¼Œæˆ‘å“­äº†ï¼Œä½ åˆ«å“­äº†ï½,å¦å¤–æˆ‘çš„ä»£ç ä¸ä¸€å®šè·Ÿæ‚¨çš„ä¸€æ¨¡ä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œä»…ä¾›å‚è€ƒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[react hookæ³¨æ„äº‹é¡¹]]></title>    <link>https://juejin.cn/post/7589462007527784482</link>    <guid>https://juejin.cn/post/7589462007527784482</guid>    <pubDate>2025-12-30T09:06:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589462007527784482" data-draft-id="7589308109640990755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="react hookæ³¨æ„äº‹é¡¹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T09:06:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’ç“œè¾¾åˆ©å›­"/> <meta itemprop="url" content="https://juejin.cn/user/4062065158258954"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            react hookæ³¨æ„äº‹é¡¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4062065158258954/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’ç“œè¾¾åˆ©å›­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:06:47.000Z" title="Tue Dec 30 2025 09:06:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å†™ä»£ç å‡ºé”™äº†ï¼Œå¾ˆå°‘æ·±å…¥äº†è§£ hookã€‚è®©aiç»™æ€»ç»“äº†ä¸€ä¸‹ã€‚</p>
<p>è¿™ç¡®å®æ˜¯ React ä¸­éå¸¸æ ¸å¿ƒä¸”å®¹æ˜“è¢«å¿½è§†çš„â€œé“å¾‹â€ã€‚React çš„å¾ˆå¤šè®¾è®¡ç†å¿µä¸ä¼ ç»Ÿçš„å‘½ä»¤å¼ç¼–ç¨‹ï¼ˆå¦‚ jQueryï¼‰æˆ–åŸºäºç±»çš„ç¼–ç¨‹ï¼ˆVue Options APIï¼‰ä¸å¤ªä¸€æ ·ï¼Œå› æ­¤æœ‰å¾ˆå¤šç±»ä¼¼çš„â€œæ½œè§„åˆ™â€å’Œé™·é˜±ã€‚</p>
<p>ä»¥ä¸‹ä¸ºæ‚¨æ•´ç†äº† <strong>React å¼€å‘ä¸­å¿…é¡»çŸ¥é“çš„ 6 ä¸ªæ ¸å¿ƒæ³¨æ„äº‹é¡¹</strong>ï¼ŒæŒæ¡è¿™äº›å¯ä»¥å¸®æ‚¨é¿å¼€ 90% çš„ Bugï¼š</p>
<h3 data-id="heading-0">1. <code>useEffect</code> ä¾èµ–æ•°ç»„ä¸èƒ½â€œæ’’è°â€ (Stale Closure / é—­åŒ…é™·é˜±)</h3>
<p>è¿™æ˜¯ Hook æœ€å®¹æ˜“å‡º Bug çš„åœ°æ–¹ã€‚å¦‚æœä½ åœ¨ <code>useEffect</code> æˆ– <code>useCallback</code> å†…éƒ¨ä½¿ç”¨äº†æŸä¸ªå˜é‡ï¼Œä½†æ²¡æœ‰æŠŠå®ƒåŠ åˆ°ä¾èµ–æ•°ç»„ <code>[]</code> ä¸­ï¼ŒHook å†…éƒ¨å°±ä¼šä¸€ç›´å¼•ç”¨<strong>æ—§çš„å˜é‡å€¼</strong>ã€‚</p>
<ul>
<li>
<p><strong>âŒ é”™è¯¯å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// æ°¸è¿œæ‰“å° 0ï¼å› ä¸ºè¿™é‡Œçš„ count æ˜¯é—­åŒ…æ•è·çš„åˆå§‹å€¼</span>
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);
}, []); <span class="hljs-comment">// ä¾èµ–æ•°ç»„æ˜¯ç©ºçš„ï¼Œå¯¼è‡´ effect åªè¿è¡Œä¸€æ¬¡ï¼Œå†…éƒ¨æ°¸è¿œæ‹¿ç€æ—§çš„ count</span>
</code></pre>
</li>
<li>
<p><strong>âœ… æ­£ç¡®å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);
}, [count]); <span class="hljs-comment">// ä¾èµ– countï¼Œæ¯æ¬¡ count å˜åŒ–ï¼Œeffect ä¼šé”€æ¯æ—§çš„å¹¶é‡æ–°è¿è¡Œ</span>
</code></pre>
<p><em>æˆ–è€…ä½¿ç”¨å‡½æ•°å¼æ›´æ–°ï¼ˆå¦‚æœä¸ä¾èµ–å¤–éƒ¨å˜é‡è§¦å‘ Effectï¼‰ï¼š</em></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// è¿™ç§å†™æ³•ä¸éœ€è¦ä¾èµ– count</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-1">2. State æ›´æ–°æ˜¯â€œå¼‚æ­¥â€çš„ï¼ˆå¿«ç…§ç‰¹æ€§ï¼‰</h3>
<p>è°ƒç”¨ <code>setState</code> åï¼ŒçŠ¶æ€<strong>ä¸ä¼š</strong>ç«‹å³æ”¹å˜ã€‚React ä¼šæŠŠæ›´æ–°æ”¾å…¥é˜Ÿåˆ—ï¼Œç­‰åˆ°ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<ul>
<li>
<p><strong>âŒ å¸¸è§è¯¯åŒºï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// æ‰“å°çš„ä»ç„¶æ˜¯æ—§å€¼ï¼ä¸æ˜¯ +1 åçš„å€¼</span>

  <span class="hljs-comment">// å¦‚æœæ­¤æ—¶å‘è¯·æ±‚ï¼Œå‘å‡ºå»çš„ä¹Ÿæ˜¯æ—§å€¼</span>
  <span class="hljs-title function_">fetchData</span>(count); 
};
</code></pre>
</li>
<li>
<p>âœ… æ­£ç¡®ç†è§£ï¼š</p>
<p>å¦‚æœä½ éœ€è¦ä½¿ç”¨æ›´æ–°åçš„å€¼ï¼Œåº”è¯¥ä½¿ç”¨ useEffect ç›‘å¬è¯¥å€¼çš„å˜åŒ–ï¼Œæˆ–è€…åœ¨ setState ä¸­ä½¿ç”¨å›è°ƒå‡½æ•°ï¼ˆä»…ç”¨äºè®¡ç®—æ–°å€¼ï¼‰ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// è¿™é‡Œæ‰èƒ½æ‹¿åˆ°æ›´æ–°åçš„å€¼</span>
  <span class="hljs-title function_">fetchData</span>(count);
}, [count]);
</code></pre>
</li>
</ul>
<h3 data-id="heading-2">3. æ°¸è¿œä¸è¦ç›´æ¥ä¿®æ”¹ State (Immutability / ä¸å¯å˜æ€§)</h3>
<p>React æ¯”è¾ƒçŠ¶æ€æ˜¯å¦å˜åŒ–æ˜¯åŸºäº<strong>å¼•ç”¨æ¯”è¾ƒ</strong>ï¼ˆShallow Compareï¼‰ã€‚å¦‚æœä½ ç›´æ¥ä¿®æ”¹å¯¹è±¡å±æ€§ï¼Œå¼•ç”¨åœ°å€æ²¡å˜ï¼ŒReact å°±ä¸çŸ¥é“æ•°æ®å˜äº†ï¼Œé¡µé¢å°±ä¸ä¼šåˆ·æ–°ã€‚</p>
<ul>
<li>
<p><strong>âŒ é”™è¯¯å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> });

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateName</span> = (<span class="hljs-params"/>) =&gt; {
  user.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// ä¿®æ”¹äº†å†…å®¹ï¼Œä½†å¯¹è±¡å¼•ç”¨æ²¡å˜</span>
  <span class="hljs-title function_">setUser</span>(user);     <span class="hljs-comment">// React è®¤ä¸ºå‰åæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä¸è§¦å‘é‡æ–°æ¸²æŸ“</span>
};
</code></pre>
</li>
<li>
<p><strong>âœ… æ­£ç¡®å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">updateName</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆå¤åˆ¶æ—§å±æ€§ + è¦†ç›–æ–°å±æ€§ï¼‰</span>
  <span class="hljs-title function_">setUser</span>({ ...user, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span> }); 
};
</code></pre>
</li>
</ul>
<h3 data-id="heading-3">4. åˆ—è¡¨æ¸²æŸ“å¿…é¡»æœ‰å”¯ä¸€çš„ <code>key</code>ï¼ˆä¸”å°½é‡ä¸è¦ç”¨ indexï¼‰</h3>
<p><code>key</code> æ˜¯ React è¯†åˆ« DOM èŠ‚ç‚¹çš„èº«ä»½è¯ã€‚å¦‚æœä½¿ç”¨æ•°ç»„ç´¢å¼•ï¼ˆindexï¼‰ä½œä¸º keyï¼Œå½“åˆ—è¡¨é¡ºåºå‘ç”Ÿå˜åŒ–ï¼ˆæ’å…¥ã€åˆ é™¤ã€æ’åºï¼‰æ—¶ï¼ŒReact ä¼šå¤ç”¨é”™è¯¯çš„ DOM èŠ‚ç‚¹ï¼Œå¯¼è‡´çŠ¶æ€é”™ä¹±ã€‚</p>
<ul>
<li>
<p><strong>âŒ é£é™©å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// å¦‚æœåˆ—è¡¨é¡ºåºä¼šå˜ï¼Œåƒä¸‡åˆ«ç”¨ index</span>
{items.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>)}
</code></pre>
</li>
<li>
<p><strong>âœ… æ­£ç¡®å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// ä½¿ç”¨æ•°æ®ä¸­çš„å”¯ä¸€ ID</span>
{items.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>)}
</code></pre>
</li>
</ul>
<h3 data-id="heading-4">5. <code>useEffect</code> çš„æ¸…ç†å‡½æ•° (Cleanup Function)</h3>
<p>å¦‚æœåœ¨ <code>useEffect</code> ä¸­è®¢é˜…äº†äº‹ä»¶ã€è®¾ç½®äº†å®šæ—¶å™¨æˆ–å‘èµ·äº†è¯·æ±‚ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼æˆ–é€»è¾‘é”™è¯¯ï¼ˆæ¯”å¦‚ç»„ä»¶å¸è½½äº†ä½†å®šæ—¶å™¨è¿˜åœ¨è·‘ï¼‰ã€‚</p>
<ul>
<li>
<p><strong>âœ… æ ‡å‡†æ¨¡æ¿ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// 1. è®¾ç½®å‰¯ä½œç”¨</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleResize</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>);
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);

  <span class="hljs-comment">// 2. è¿”å›æ¸…ç†å‡½æ•°</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);
  };
}, []);
</code></pre>
</li>
</ul>
<h3 data-id="heading-5">6. React Strict Mode ä¸‹çš„â€œé‡å¤æ‰§è¡Œâ€</h3>
<p>åœ¨å¼€å‘ç¯å¢ƒï¼ˆDevelopmentï¼‰ä¸­ï¼Œä¸ºäº†å¸®ä½ æ£€æŸ¥ä¸çº¯çš„å‰¯ä½œç”¨ï¼ŒReact çš„ <code>&lt;StrictMode&gt;</code> ä¼šæ•…æ„å°†ä½ çš„ç»„ä»¶<strong>æ¸²æŸ“ä¸¤æ¬¡</strong>ï¼Œ<code>useEffect</code> ä¹Ÿä¼šæ‰§è¡Œä¸¤æ¬¡ã€‚</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šä½ çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œå‘ç° API è¯·æ±‚å‘äº†ä¸¤æ¬¡ï¼Œæˆ–è€… <code>console.log</code> æ‰“å°äº†ä¸¤æ¬¡ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šè¿™<strong>ä¸æ˜¯ Bug</strong>ï¼Œç”Ÿäº§ç¯å¢ƒï¼ˆProductionï¼‰ä¸ä¼šå‘ç”Ÿã€‚ä¸è¦ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å»å†™å¥‡æ€ªçš„ä»£ç ï¼Œè€Œåº”è¯¥ç¡®ä¿ä½ çš„ Effect æ˜¯å¯ä»¥é‡å¤æ‰§è¡Œä¸”æ— å®³çš„ï¼ˆåšå¥½æ¸…ç†å·¥ä½œï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">æ€»ç»“å»ºè®®</h3>
<p>æ‚¨åˆšé‡åˆ°çš„ <strong>â€œHook é¡ºåºä¸æ•°é‡å¿…é¡»ä¸€è‡´â€</strong> æ˜¯ React è¿è¡Œæœºåˆ¶çš„ç‰©ç†é™åˆ¶ï¼ˆReact å†…éƒ¨æ˜¯é æ•°ç»„ç´¢å¼•æ¥è®°å½•æ¯ä¸ª Hook çš„çŠ¶æ€çš„ï¼Œå¦‚æœé¡ºåºä¹±äº†ï¼ŒçŠ¶æ€å°±å¼ å† ææˆ´äº†ï¼‰ã€‚</p>
<p>è€Œä¸Šé¢æåˆ°çš„è¿™ 6 ç‚¹ï¼Œæ›´å¤šæ˜¯<strong>é€»è¾‘å’Œæ¨¡å¼</strong>ä¸Šçš„æ³¨æ„äº‹é¡¹ã€‚æŒæ¡äº†è¿™äº›ï¼Œæ‚¨å†™ React å°±ä¼šéå¸¸æœ‰åº•æ°”äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¶…è¯¦ç»† Vue CLI ç§»åŠ¨ç«¯é¢„è§ˆæ’ä»¶å®æˆ˜ï¼šæ”¯æŒæœ¬åœ°/TPGZ/NPM/Git å¤šåœºæ™¯ä½¿ç”¨ï¼ˆå°ç™½é›¶åŸºç¡€å…¥é—¨ï¼‰]]></title>    <link>https://juejin.cn/post/7589454621719380018</link>    <guid>https://juejin.cn/post/7589454621719380018</guid>    <pubDate>2025-12-30T09:11:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589454621719380018" data-draft-id="7589231401659138058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¶…è¯¦ç»† Vue CLI ç§»åŠ¨ç«¯é¢„è§ˆæ’ä»¶å®æˆ˜ï¼šæ”¯æŒæœ¬åœ°/TPGZ/NPM/Git å¤šåœºæ™¯ä½¿ç”¨ï¼ˆå°ç™½é›¶åŸºç¡€å…¥é—¨ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T09:11:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›…ç—_yuppie"/> <meta itemprop="url" content="https://juejin.cn/user/3466134893364247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¶…è¯¦ç»† Vue CLI ç§»åŠ¨ç«¯é¢„è§ˆæ’ä»¶å®æˆ˜ï¼šæ”¯æŒæœ¬åœ°/TPGZ/NPM/Git å¤šåœºæ™¯ä½¿ç”¨ï¼ˆå°ç™½é›¶åŸºç¡€å…¥é—¨ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3466134893364247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›…ç—_yuppie
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:11:50.000Z" title="Tue Dec 30 2025 09:11:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‘˜è¦</h2>
<p>ä½ æ˜¯å¦è¿˜åœ¨ä¸ºã€Œç§»åŠ¨ç«¯å¦‚ä½•å¿«é€Ÿé¢„è§ˆæœ¬åœ° Vue å¼€å‘é¡¹ç›®ã€è€Œçƒ¦æ¼ï¼Ÿæ‰‹åŠ¨æŸ¥æ‰¾å±€åŸŸç½‘ IPã€è¾“å…¥ç«¯å£å·ç¹çåˆå®¹æ˜“å‡ºé”™ï¼Ÿæœ¬æ–‡å°†å›´ç»•ã€Œ<strong>å®ç°ç§»åŠ¨ç«¯ä¾¿æ·é¢„è§ˆæœ¬åœ°æœåŠ¡é¡¹ç›®</strong>ã€è¿™ä¸€æ ¸å¿ƒéœ€æ±‚ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å¼€å‘ä¸€æ¬¾ Vue CLI ä¸“å±äºŒç»´ç æ’ä»¶ã€‚æ’ä»¶ä¸ä»…èƒ½è‡ªåŠ¨ç”Ÿæˆç§»åŠ¨ç«¯å¯æ‰«ç çš„äºŒç»´ç ï¼Œè¿˜å®Œç¾æ”¯æŒæœ¬åœ°è°ƒè¯•ã€TGZ å‹ç¼©åŒ…ã€NPM å…¬å¼€åŒ…ã€Git ä»“åº“å››ç§ä½¿ç”¨åœºæ™¯ï¼ŒåŒæ—¶é™„å¸¦è§£å†³æ’ä»¶å¼€å‘ä¸­ã€ŒäºŒç»´ç è¾“å‡ºæ—¶æœºã€çš„å¸¸è§é—®é¢˜ï¼Œä»£ç å¯ç›´æ¥å¤åˆ¶ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹ï¼</p>
<h2 data-id="heading-1">ä¸€ã€å‰è¨€</h2>
<p>åœ¨ Vue é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œã€Œç§»åŠ¨ç«¯é¢„è§ˆæœ¬åœ°æœåŠ¡ã€æ˜¯é«˜é¢‘åˆšéœ€ï¼šå¼€å‘è€…éœ€è¦åœ¨æ‰‹æœºä¸ŠéªŒè¯é¡µé¢é€‚é…ã€äº¤äº’æ•ˆæœç­‰ï¼Œä½†ä¼ ç»Ÿæ–¹å¼éœ€è¦æ‰‹åŠ¨æŸ¥è¯¢ç”µè„‘å±€åŸŸç½‘ IPã€è®°å½•é¡¹ç›®ç«¯å£ï¼Œå†åœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è¾“å…¥åœ°å€ï¼Œæ­¥éª¤ç¹çä¸”å®¹æ˜“å‡ºé”™ï¼ˆå¦‚ IP è¾“å…¥é”™è¯¯ã€ç«¯å£å†²çªç­‰ï¼‰ã€‚</p>
<p>æœ¬æ–‡çš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼šå¼€å‘ä¸€æ¬¾ Vue CLI æ’ä»¶ï¼Œé€šè¿‡ã€Œè‡ªåŠ¨ç”Ÿæˆå¯è§†åŒ–äºŒç»´ç ã€çš„æ–¹å¼ï¼Œè®©æ‰‹æœºæ‰«ç å³å¯å¿«é€Ÿè®¿é—®æœ¬åœ° Vue æœåŠ¡ï¼ŒåŒæ—¶æ”¯æŒæœ¬åœ°è°ƒè¯•ã€TGZ åŒ…ã€NPM åŒ…ã€Git åŒ…å››ç§ä½¿ç”¨åœºæ™¯ï¼Œæ»¡è¶³ä¸ªäººå¼€å‘ã€å›¢é˜Ÿåä½œã€å…¨ç½‘å¤ç”¨ç­‰ä¸åŒéœ€æ±‚ï¼ŒåŒæ—¶è§£å†³å¼€å‘è¿‡ç¨‹ä¸­ã€ŒäºŒç»´ç è¾“å‡ºæ—¶æœºã€çš„å¸¸è§é—®é¢˜ã€‚</p>
<h2 data-id="heading-2">äºŒã€æ ¸å¿ƒéœ€æ±‚ä¸æ’ä»¶ä¼˜åŠ¿</h2>
<h3 data-id="heading-3">1.  æ ¸å¿ƒéœ€æ±‚</h3>
<ul>
<li>æ ¸å¿ƒåŠŸèƒ½ï¼šè‡ªåŠ¨è·å–ç”µè„‘å±€åŸŸç½‘ IP + é¡¹ç›®ç«¯å£ï¼Œç”Ÿæˆç§»åŠ¨ç«¯å¯æ‰«ç çš„äºŒç»´ç ï¼Œæ‰«ç å³å¯è®¿é—®æœ¬åœ° Vue æœåŠ¡ï¼›</li>
<li>å¤šåœºæ™¯ä½¿ç”¨ï¼šæ”¯æŒæœ¬åœ°è°ƒè¯•ï¼ˆæœªå‘å¸ƒæ’ä»¶ï¼‰ã€TGZ å‹ç¼©åŒ…ï¼ˆç§æœ‰éƒ¨ç½²ï¼‰ã€NPM å…¬å¼€åŒ…ï¼ˆå…¨ç½‘å¤ç”¨ï¼‰ã€Git ä»“åº“ï¼ˆå›¢é˜Ÿåä½œï¼‰å››ç§å¼•å…¥æ–¹å¼ï¼›</li>
<li>å…¼å®¹æ€§å¼ºï¼šæ”¯æŒ Vue 2/Vue 3 é¡¹ç›®ï¼Œé€‚é… Vue CLI 3+ æ‰€æœ‰ç‰ˆæœ¬ï¼›</li>
<li>æ— éœ€æ‰‹åŠ¨é…ç½®ï¼šæ’ä»¶è‡ªåŠ¨å¼€å¯å±€åŸŸç½‘è®¿é—®ï¼Œæ— éœ€ç”¨æˆ·ä¿®æ”¹ <code>vue.config.js</code>ï¼›</li>
<li>ç»†èŠ‚ä¼˜åŒ–ï¼šè§£å†³äºŒç»´ç è¾“å‡ºæ—¶æœºé—®é¢˜ï¼Œç¡®ä¿ä½¿ç”¨ä½“éªŒæµç•…ï¼Œé¿å…æ—¥å¿—æ··ä¹±æˆ–è¾“å‡ºè¿‡æ™šã€‚</li>
</ul>
<h3 data-id="heading-4">2.  æ’ä»¶æ ¸å¿ƒä¼˜åŠ¿</h3>





























<table><thead><tr><th>ä¼˜åŠ¿ç‚¹</th><th>å…·ä½“è¯´æ˜</th></tr></thead><tbody><tr><td>ä¾¿æ·æ€§</td><td>æ‰«ç è®¿é—®ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥ IP + ç«¯å£ï¼Œé›¶å‡ºé”™</td></tr><tr><td>å¤šåœºæ™¯å…¼å®¹</td><td>æ”¯æŒæœ¬åœ°/TPGZ/NPM/Git å››ç§ä½¿ç”¨æ–¹å¼</td></tr><tr><td>æ— ä¾µå…¥æ€§</td><td>ä¸ä¿®æ”¹é¡¹ç›®åŸæœ‰ä»£ç ï¼Œå¸è½½åæ— æ®‹ç•™</td></tr><tr><td>è‡ªåŠ¨é…ç½®</td><td>è‡ªåŠ¨å¼€å¯ <code>host: 0.0.0.0</code>ï¼Œæ”¯æŒå±€åŸŸç½‘è®¿é—®</td></tr><tr><td>ç»†èŠ‚ä¼˜åŒ–</td><td>è§£å†³äºŒç»´ç è¾“å‡ºæ—¶æœºé—®é¢˜ï¼Œæ—¥å¿—æ•´æ´ç¾è§‚</td></tr></tbody></table>
<h2 data-id="heading-5">ä¸‰ã€ç¬¬ä¸€æ­¥ï¼šæ’ä»¶å¼€å‘ï¼ˆæ ¸å¿ƒåŠŸèƒ½å®ç°ï¼Œæ”¯æŒç§»åŠ¨ç«¯æ‰«ç é¢„è§ˆï¼‰</h2>
<h3 data-id="heading-6">1.  æ’ä»¶ç›®å½•è§„èŒƒï¼ˆVue CLI è¦æ±‚ï¼Œå¿…é¡»éµå®ˆï¼‰</h3>
<p>Vue CLI æ’ä»¶å¿…é¡»ä»¥ <code>vue-cli-plugin-xxx</code> å‘½åï¼Œå¦åˆ™æ— æ³•è¢«é¡¹ç›®è‡ªåŠ¨è¯†åˆ«ï¼Œæ‰§è¡Œå‘½ä»¤åˆ›å»ºç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ’ä»¶ç›®å½•å¹¶è¿›å…¥ï¼ˆå°ç™½ç›´æ¥å¤åˆ¶ç»ˆç«¯æ‰§è¡Œï¼‰</span>
<span class="hljs-built_in">mkdir</span> vue-cli-plugin-vue-mobile-preview &amp;&amp; <span class="hljs-built_in">cd</span> vue-cli-plugin-vue-mobile-preview
</code></pre>
<h3 data-id="heading-7">2.  åˆå§‹åŒ– package.jsonï¼ˆé…ç½®æ’ä»¶ä¿¡æ¯ä¸ä¾èµ–ï¼‰</h3>
<p>åœ¨æ’ä»¶ç›®å½•ä¸‹æ‰§è¡Œ <code>npm init -y</code> å¿«é€Ÿç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œå†æ‰‹åŠ¨æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼ˆç¡®ä¿ä¾èµ–ä¸å…¼å®¹æ€§ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vue-cli-plugin-vue-mobile-preview"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Vue CLI 3+ æ’ä»¶ï¼šè‡ªåŠ¨ç”ŸæˆäºŒç»´ç ï¼Œæ”¯æŒç§»åŠ¨ç«¯æ‰«ç é¢„è§ˆæœ¬åœ°VueæœåŠ¡ï¼Œå…¼å®¹æœ¬åœ°/TGZ/NPM/Gitå¤šåœºæ™¯"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"index.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"keywords"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"vue"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"vue-cli"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"mobile preview"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"qrcode"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"local service"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"TGZ"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"NPM"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Git"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"qrcode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.5.3"</span> <span class="hljs-comment">// æ ¸å¿ƒä¾èµ–ï¼šç”¨äºç”Ÿæˆç»ˆç«¯å¯è§†åŒ–äºŒç»´ç </span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"peerDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@vue/cli-service"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&gt;=3.0.0"</span> <span class="hljs-comment">// å…¼å®¹ Vue CLI 3+ æ‰€æœ‰ç‰ˆæœ¬</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„å§“å"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"license"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MIT"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li>å…³é”®è¯´æ˜ï¼š<code>dependencies</code> ä¸­å£°æ˜ <code>qrcode</code> ä¾èµ–ï¼Œç”¨æˆ·å®‰è£…æ’ä»¶åæ— éœ€æ‰‹åŠ¨å®‰è£…ï¼›<code>peerDependencies</code> ç¡®ä¿æ’ä»¶ä¸ Vue CLI ç‰ˆæœ¬å…¼å®¹ã€‚</li>
</ul>
<h3 data-id="heading-8">3.  ç¼–å†™æ ¸å¿ƒ index.jsï¼ˆå®ç°ç§»åŠ¨ç«¯æ‰«ç é¢„è§ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰</h3>
<p>è¿™æ˜¯æ’ä»¶çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå®ç°ã€Œè‡ªåŠ¨è·å–å±€åŸŸç½‘ IP + é¡¹ç›®ç«¯å£ + ç”ŸæˆäºŒç»´ç ã€çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒæ—¶è§£å†³ã€ŒäºŒç»´ç è¾“å‡ºæ—¶æœºã€é—®é¢˜ï¼Œä»£ç å«è¯¦ç»†æ³¨é‡Šï¼Œå°ç™½å¯ç›´æ¥å¤åˆ¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼•å…¥æ ¸å¿ƒä¾èµ–</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">QRCode</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'qrcode'</span>);
<span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>); <span class="hljs-comment">// Node.js åŸç”Ÿæ¨¡å—ï¼Œæ— éœ€é¢å¤–å®‰è£…ï¼Œç”¨äºè·å–å±€åŸŸç½‘IP</span>

<span class="hljs-comment">/**
 * æ ¸å¿ƒåŠŸèƒ½1ï¼šè‡ªåŠ¨è·å–æœ¬æœºå±€åŸŸç½‘ IPv4 åœ°å€ï¼ˆç§»åŠ¨ç«¯è®¿é—®éœ€è¦è¯¥ IPï¼‰
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} æœ‰æ•ˆå±€åŸŸç½‘IP | å…œåº•æœ¬åœ°å›ç¯åœ°å€ï¼ˆ127.0.0.1ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getLocalLanIp</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> networkInterfaces = os.<span class="hljs-title function_">networkInterfaces</span>();
  <span class="hljs-comment">// éå†æ‰€æœ‰ç½‘å¡æ¥å£ï¼Œç­›é€‰ç¬¦åˆæ¡ä»¶çš„å±€åŸŸç½‘ IP</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> ifaceName <span class="hljs-keyword">in</span> networkInterfaces) {
    <span class="hljs-keyword">const</span> ifaceList = networkInterfaces[ifaceName];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> iface <span class="hljs-keyword">of</span> ifaceList) {
      <span class="hljs-comment">// è¿‡æ»¤æ¡ä»¶ï¼šIPv4 åè®®ã€éæœ¬åœ°å›ç¯åœ°å€ã€éè™šæ‹Ÿå†…ç½‘åœ°å€</span>
      <span class="hljs-keyword">if</span> (iface.<span class="hljs-property">family</span> === <span class="hljs-string">'IPv4'</span> &amp;&amp; !iface.<span class="hljs-property">internal</span> &amp;&amp; iface.<span class="hljs-property">address</span> !== <span class="hljs-string">'127.0.0.1'</span>) {
        <span class="hljs-keyword">return</span> iface.<span class="hljs-property">address</span>; <span class="hljs-comment">// è¿”å›æœ‰æ•ˆå±€åŸŸç½‘ IP</span>
      }
    }
  }
  <span class="hljs-comment">// å…œåº•ï¼šæœªè·å–åˆ°å±€åŸŸç½‘ IP æ—¶ï¼Œè¿”å›æœ¬åœ°å›ç¯åœ°å€ï¼ˆä»…æœ¬æœºå¯è®¿é—®ï¼Œç§»åŠ¨ç«¯æ— æ³•æ‰«ç ï¼‰</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'127.0.0.1'</span>;
}

<span class="hljs-comment">/**
 * æ ¸å¿ƒåŠŸèƒ½2ï¼šç”Ÿæˆå¹¶æ‰“å°ç§»åŠ¨ç«¯å¯æ‰«ç çš„äºŒç»´ç ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} lanIp å±€åŸŸç½‘ IP
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} port é¡¹ç›®ç«¯å£
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">printMobileQrcode</span>(<span class="hljs-params">lanIp, port</span>) {
  <span class="hljs-comment">// æ„é€ ç§»åŠ¨ç«¯è®¿é—®åœ°å€ï¼ˆæ ¸å¿ƒï¼šå±€åŸŸç½‘ IP + é¡¹ç›®ç«¯å£ï¼Œæ‰‹æœºæ‰«ç å³å¯è®¿é—®ï¼‰</span>
  <span class="hljs-keyword">const</span> mobileAccessUrl = <span class="hljs-string">`http://<span class="hljs-subst">${lanIp}</span>:<span class="hljs-subst">${port}</span>`</span>;
  <span class="hljs-comment">// æ„é€ æœ¬æœºè®¿é—®åœ°å€ï¼ˆç”¨äºæç¤ºå¼€å‘è€…ï¼‰</span>
  <span class="hljs-keyword">const</span> localAccessUrl = <span class="hljs-string">`http://localhost:<span class="hljs-subst">${port}</span>`</span>;

  <span class="hljs-comment">// æ‰“å°é†’ç›®æç¤ºä¿¡æ¯ï¼ŒåŒºåˆ†æ—¥å¿—å±‚çº§</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n====================================================='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸ‰ [vue-cli-plugin-vue-mobile-preview] ç§»åŠ¨ç«¯é¢„è§ˆäºŒç»´ç å·²ç”Ÿæˆï¼'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”§  æœ¬æœºè®¿é—®åœ°å€ï¼š<span class="hljs-subst">${localAccessUrl}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸŒ  ç§»åŠ¨ç«¯è®¿é—®åœ°å€ï¼š<span class="hljs-subst">${mobileAccessUrl}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸ“±  æ‰«ç æç¤ºï¼šæ‰‹æœºä¸ç”µè„‘è¿æ¥åŒä¸€ WiFiï¼Œæ‰“å¼€ç›¸æœº/å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯é¢„è§ˆï¼\n'</span>);

  <span class="hljs-comment">// ç”Ÿæˆç»ˆç«¯å¯è§†åŒ–äºŒç»´ç </span>
  <span class="hljs-title class_">QRCode</span>.<span class="hljs-title function_">toString</span>(mobileAccessUrl, {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'terminal'</span>, <span class="hljs-comment">// è¾“å‡ºåˆ°ç»ˆç«¯</span>
    <span class="hljs-attr">margin</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// äºŒç»´ç è¾¹è·ï¼ˆç´§å‡‘ç¾è§‚ï¼‰</span>
    <span class="hljs-attr">small</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// æ˜¾ç¤ºå¤§å°ºå¯¸äºŒç»´ç ï¼Œæé«˜æ‰‹æœºæ‰«ç æˆåŠŸç‡</span>
  }, <span class="hljs-function">(<span class="hljs-params">err, qrCodeStr</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(qrCodeStr); <span class="hljs-comment">// æ‰“å°äºŒç»´ç </span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å¼‚å¸¸æ•è·ï¼šäºŒç»´ç ç”Ÿæˆå¤±è´¥æ—¶ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯ä½†ä¸å½±å“é¡¹ç›®è¿è¡Œ</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼š'</span>, err.<span class="hljs-property">message</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸ’¡ æ›¿ä»£æ–¹æ¡ˆï¼šæ‰‹åŠ¨åœ¨æ‰‹æœºæµè§ˆå™¨è¾“å…¥åœ°å€ -&gt; '</span>, mobileAccessUrl);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=====================================================\n'</span>);
  });
}

<span class="hljs-comment">/**
 * è¾…åŠ©å˜é‡ï¼šæ ‡è®°æ˜¯å¦å·²æ‰“å°äºŒç»´ç ï¼ˆé¿å…çƒ­æ›´æ–°æ—¶é‡å¤è¾“å‡ºï¼‰
 */</span>
<span class="hljs-keyword">let</span> hasPrintQrcode = <span class="hljs-literal">false</span>;

<span class="hljs-comment">/**
 * Vue CLI æ’ä»¶æ ¸å¿ƒå¯¼å‡ºå‡½æ•°ï¼ˆå…¥å£é€»è¾‘ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} api Vue CLI æ ¸å¿ƒ API
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} options é¡¹ç›®çš„ vue.config.js é…ç½®é¡¹
 */</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">api, options</span>) =&gt;</span> {
  api.<span class="hljs-title function_">chainWebpack</span>(<span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-comment">// æ ¸å¿ƒé…ç½®ï¼šå¼ºåˆ¶è®¾ç½® host: 0.0.0.0ï¼Œå…è®¸å±€åŸŸç½‘è®¾å¤‡ï¼ˆæ‰‹æœºï¼‰è®¿é—®æœ¬åœ°æœåŠ¡</span>
    <span class="hljs-comment">// æ— éœ€ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹ vue.config.jsï¼Œæ’ä»¶è‡ªåŠ¨é…ç½®</span>
    config.<span class="hljs-property">devServer</span>.<span class="hljs-title function_">host</span>(<span class="hljs-string">'0.0.0.0'</span>);

    <span class="hljs-comment">// è§£å†³äºŒç»´ç è¾“å‡ºæ—¶æœºé—®é¢˜ï¼šä½¿ç”¨ compiler.hooks.done äº‹ä»¶ï¼ˆé¡¹ç›®å®Œå…¨å°±ç»ªåè¾“å‡ºï¼Œé¿å…æ—¥å¿—æ··ä¹±ï¼‰</span>
    <span class="hljs-comment">// è¿™æ˜¯æ’ä»¶å¼€å‘ä¸­çš„ç»†èŠ‚ä¼˜åŒ–ï¼Œä¸å½±å“æ ¸å¿ƒçš„ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½</span>
    config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">'mobile-preview-qrcode-plugin'</span>).<span class="hljs-title function_">use</span>(<span class="hljs-keyword">class</span> <span class="hljs-title class_">MobilePreviewPlugin</span> {
      <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) {
        <span class="hljs-comment">// compiler.hooks.doneï¼šWebpack ç¼–è¯‘ï¼ˆé¦–æ¬¡æ„å»º/çƒ­æ›´æ–°ï¼‰å®Œæˆåè§¦å‘</span>
        compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">done</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">'MobilePreviewPlugin'</span>, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-comment">// ä»…åœ¨é¦–æ¬¡æ„å»ºå®Œæˆåæ‰“å°ä¸€æ¬¡äºŒç»´ç ï¼Œé¿å…çƒ­æ›´æ–°æ—¶é‡å¤è¾“å‡º</span>
          <span class="hljs-keyword">if</span> (hasPrintQrcode) {
            <span class="hljs-keyword">return</span>;
          }

          <span class="hljs-comment">// è·å–é¡¹ç›®ç«¯å£ï¼ˆä¼˜å…ˆä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰ç«¯å£ï¼Œé»˜è®¤ 8080ï¼‰</span>
          <span class="hljs-keyword">const</span> devServerConfig = options.<span class="hljs-property">devServer</span> || {};
          <span class="hljs-keyword">const</span> projectPort = devServerConfig.<span class="hljs-property">port</span> || <span class="hljs-number">8080</span>;
          <span class="hljs-comment">// è·å–å±€åŸŸç½‘ IP</span>
          <span class="hljs-keyword">const</span> localLanIp = <span class="hljs-title function_">getLocalLanIp</span>();
          <span class="hljs-comment">// ç”Ÿæˆå¹¶æ‰“å°ç§»åŠ¨ç«¯é¢„è§ˆäºŒç»´ç </span>
          <span class="hljs-title function_">printMobileQrcode</span>(localLanIp, projectPort);

          <span class="hljs-comment">// æ ‡è®°å·²æ‰“å°äºŒç»´ç </span>
          hasPrintQrcode = <span class="hljs-literal">true</span>;
        });
      }
    });
  });
};
</code></pre>
<h3 data-id="heading-9">4.  æ’ä»¶æœ€ç»ˆç›®å½•ç»“æ„ï¼ˆå°ç™½æ ¸å¯¹ï¼Œç¡®ä¿æ— è¯¯ï¼‰</h3>
<p>æ’ä»¶ç›®å½•ä»…éœ€ 2 ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼Œç®€æ´æ˜“ç»´æŠ¤ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">vue-cli-plugin-vue-mobile-preview/
â”œâ”€â”€ index.js       <span class="hljs-comment"># æ ¸å¿ƒé€»è¾‘æ–‡ä»¶ï¼ˆå®ç°ç§»åŠ¨ç«¯æ‰«ç é¢„è§ˆ+æ—¶æœºä¼˜åŒ–ï¼‰</span>
â””â”€â”€ package.json   <span class="hljs-comment"># æ’ä»¶é…ç½®æ–‡ä»¶ï¼ˆä¾èµ–+å…¼å®¹æ€§é…ç½®ï¼‰</span>
</code></pre>
<h2 data-id="heading-10">å››ã€ç¬¬äºŒæ­¥ï¼šå¤šåœºæ™¯ä½¿ç”¨æ•™ç¨‹ï¼ˆæ ¸å¿ƒé‡ç‚¹ï¼Œè¦†ç›–æ‰€æœ‰ä½¿ç”¨åœºæ™¯ï¼‰</h2>
<p>æ’ä»¶å¼€å‘å®Œæˆåï¼Œæ”¯æŒ 4 ç§ä½¿ç”¨åœºæ™¯ï¼Œæ»¡è¶³ä¸åŒå¼€å‘éœ€æ±‚ï¼ˆä¸ªäººè°ƒè¯•ã€å›¢é˜Ÿåä½œã€å…¨ç½‘å¤ç”¨ç­‰ï¼‰ï¼Œæ­¥éª¤è¯¦ç»†ï¼Œå°ç™½å¯æŒ‰éœ€é€‰æ‹©ã€‚</p>
<h3 data-id="heading-11">åœºæ™¯1ï¼šæœ¬åœ°è°ƒè¯•ï¼ˆä¸ªäººå¼€å‘ï¼Œæœªå‘å¸ƒæ’ä»¶ï¼Œå¿«é€ŸéªŒè¯åŠŸèƒ½ï¼‰</h3>
<p>é€‚ç”¨äºæ’ä»¶å¼€å‘å®Œæˆåï¼Œä¸ªäººåœ¨æœ¬åœ° Vue é¡¹ç›®ä¸­éªŒè¯åŠŸèƒ½ï¼Œæ— éœ€å‘å¸ƒåˆ°ä»»ä½•ä»“åº“ã€‚</p>
<h4 data-id="heading-12">å‰ç½®å‡†å¤‡</h4>
<ul>
<li>æ’ä»¶ç›®å½•ä¸ç›®æ ‡ Vue é¡¹ç›®åŒçº§ï¼ˆæ–¹ä¾¿å…³è”ï¼‰ï¼Œç›®å½•ç»“æ„ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-perl" lang="perl">â”œâ”€â”€ vue-cli-plugin-vue-mobile-preview/  <span class="hljs-comment"># æ’ä»¶ç›®å½•</span>
â””â”€â”€ <span class="hljs-keyword">my</span>-vue-project/                <span class="hljs-comment"># ç›®æ ‡ Vue é¡¹ç›®ï¼ˆéœ€è¦ç§»åŠ¨ç«¯é¢„è§ˆçš„é¡¹ç›®ï¼‰</span>
    â”œâ”€â”€ src/
    â”œâ”€â”€ package.json
    â””â”€â”€ ... å…¶ä»–é¡¹ç›®æ–‡ä»¶
</code></pre>
<h4 data-id="heading-13">æ“ä½œæ­¥éª¤</h4>
<ol>
<li>
<p>è¿›å…¥<strong>ç›®æ ‡ Vue é¡¹ç›®æ ¹ç›®å½•</strong>ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å…³è”æœ¬åœ°æ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm å‘½ä»¤ï¼ˆå…¼å®¹æ‰€æœ‰ç¯å¢ƒï¼Œæ¨èå°ç™½ä½¿ç”¨ï¼‰</span>
npm install file:../vue-cli-plugin-vue-mobile-preview --save-dev

<span class="hljs-comment"># è‹¥ä½¿ç”¨ pnpmï¼Œæ‰§è¡Œæ­¤å‘½ä»¤</span>
<span class="hljs-comment"># pnpm add file:../vue-cli-plugin-vue-mobile-preview -D</span>

<span class="hljs-comment"># è‹¥ä½¿ç”¨ yarnï¼Œæ‰§è¡Œæ­¤å‘½ä»¤</span>
<span class="hljs-comment"># yarn add file:../vue-cli-plugin-vue-mobile-preview --dev</span>
</code></pre>
<ul>
<li>è·¯å¾„è¯´æ˜ï¼š<code>../vue-cli-plugin-vue-mobile-preview</code> æ˜¯æ’ä»¶çš„ç›¸å¯¹è·¯å¾„ï¼Œè‹¥ç›®å½•å±‚çº§ä¸åŒå¯è°ƒæ•´ï¼ˆå¦‚ <code>../../xxx</code>ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>éªŒè¯æ’ä»¶å®‰è£…æˆåŠŸï¼š
æŸ¥çœ‹ç›®æ ‡é¡¹ç›®çš„ <code>package.json</code> æ–‡ä»¶ï¼Œè‹¥ <code>devDependencies</code> ä¸­å‡ºç°ä»¥ä¸‹é…ç½®ï¼Œè¯´æ˜å…³è”æˆåŠŸï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"vue-cli-plugin-vue-mobile-preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"file:../vue-cli-plugin-vue-mobile-preview"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p>å¯åŠ¨é¡¹ç›®ï¼ŒéªŒè¯ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½ï¼š
åœ¨ç›®æ ‡é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Vue CLI 3+ é€šç”¨å‘½ä»¤</span>
npm run serve

<span class="hljs-comment"># å…¼å®¹å‘½ä»¤ï¼šnpm run devï¼ˆéƒ¨åˆ†é¡¹ç›®é…ç½®åˆ«åï¼‰</span>
</code></pre>
</li>
<li>
<p>ç§»åŠ¨ç«¯æ‰«ç é¢„è§ˆï¼š</p>
<ul>
<li>ç»ˆç«¯æœ€åä¼šè¾“å‡ºäºŒç»´ç ï¼ˆå¸¦é†’ç›®æç¤ºï¼‰ï¼›</li>
<li>ç¡®ä¿æ‰‹æœºä¸ç”µè„‘è¿æ¥<strong>åŒä¸€ WiFi</strong>ï¼ˆåŒä¸€å±€åŸŸç½‘ï¼‰ï¼›</li>
<li>æ‰“å¼€æ‰‹æœºç›¸æœº/å¾®ä¿¡/æ”¯ä»˜å®ã€Œæ‰«ä¸€æ‰«ã€ï¼Œæ‰«æç»ˆç«¯äºŒç»´ç ï¼Œå³å¯å¿«é€Ÿé¢„è§ˆæœ¬åœ° Vue é¡¹ç›®ã€‚</li>
</ul>
</li>
<li>
<p>æœ¬åœ°æ’ä»¶å¸è½½ï¼ˆè‹¥æ— éœ€ä½¿ç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm å‘½ä»¤</span>
npm uninstall vue-cli-plugin-vue-mobile-preview

<span class="hljs-comment"># pnpm/yarn å‘½ä»¤å¯¹åº”ï¼špnpm remove / yarn remove</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-14">åœºæ™¯2ï¼šTGZ å‹ç¼©åŒ…ä½¿ç”¨ï¼ˆç§æœ‰éƒ¨ç½²ï¼Œå›¢é˜Ÿå†…éƒ¨å¤ç”¨ï¼Œæ— éœ€å‘å¸ƒ NPMï¼‰</h3>
<p>é€‚ç”¨äºæ’ä»¶æ— éœ€å…¬å¼€ï¼Œä»…åœ¨å…¬å¸/å›¢é˜Ÿå†…éƒ¨å¤ç”¨ï¼Œå¯ä¸Šä¼ åˆ°ç§æœ‰æœåŠ¡å™¨æˆ–å…±äº«æ–‡ä»¶å¤¹ä¾›å›¢é˜Ÿæˆå‘˜ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-15">æ“ä½œæ­¥éª¤</h4>
<ol>
<li>
<p>æ’ä»¶æ‰“åŒ…ä¸º TGZ å‹ç¼©åŒ…ï¼š
è¿›å…¥æ’ä»¶ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰“åŒ…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥æ’ä»¶ç›®å½•</span>
<span class="hljs-built_in">cd</span> vue-cli-plugin-vue-mobile-preview

<span class="hljs-comment"># æ‰“åŒ…ç”Ÿæˆ TGZ å‹ç¼©åŒ…ï¼ˆnpm pack æ˜¯ npm åŸç”Ÿå‘½ä»¤ï¼Œæ— éœ€é¢å¤–å®‰è£…å·¥å…·ï¼‰</span>
npm pack
</code></pre>
<ul>
<li>æ‰“åŒ…æˆåŠŸåï¼Œæ’ä»¶ç›®å½•åŒçº§ä¼šç”Ÿæˆ <code>vue-cli-plugin-vue-mobile-preview-1.0.0.tgz</code> æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ ¼å¼ï¼šæ’ä»¶åç§°+ç‰ˆæœ¬å·ï¼‰ï¼›</li>
<li>è¯¥å‹ç¼©åŒ…åŒ…å«æ’ä»¶æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶ï¼Œå¯ç›´æ¥ç”¨äºå®‰è£…ã€‚</li>
</ul>
</li>
<li>
<p>åˆ†å‘ TGZ å‹ç¼©åŒ…ï¼š
å°†ç”Ÿæˆçš„ TGZ æ–‡ä»¶åˆ†å‘åˆ°å›¢é˜Ÿæˆå‘˜ï¼ˆå¦‚ä¸Šä¼ åˆ°å…¬å¸ç§æœ‰æœåŠ¡å™¨ã€å…±äº«ç½‘ç›˜ã€GitLab ç§æœ‰ä»“åº“é™„ä»¶ç­‰ï¼‰ï¼Œè·å–å¯è®¿é—®çš„è·¯å¾„/åœ°å€ï¼ˆç¤ºä¾‹ï¼‰ï¼š</p>
<ul>
<li>æœ¬åœ°å…±äº«ï¼š<code>/Users/xxx/Shared/vue-cli-plugin-vue-mobile-preview-1.0.0.tgz</code></li>
<li>ç§æœ‰æœåŠ¡å™¨ï¼š<code>https://xxx.company.com/plugins/vue-cli-plugin-vue-mobile-preview-1.0.0.tgz</code></li>
</ul>
</li>
<li>
<p>é¡¹ç›®ä¸­å®‰è£… TGZ æ’ä»¶ï¼š
è¿›å…¥ç›®æ ‡ Vue é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼ˆæ ¹æ® TGZ åœ°å€ç±»å‹é€‰æ‹©ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šå®‰è£…æœ¬åœ°/å…±äº«æ–‡ä»¶å¤¹ä¸­çš„ TGZ åŒ…</span>
npm install file:/Users/xxx/Shared/vue-cli-plugin-vue-mobile-preview-1.0.0.tgz --save-dev

<span class="hljs-comment"># æ–¹å¼2ï¼šå®‰è£…ç§æœ‰æœåŠ¡å™¨ä¸Šçš„ TGZ åŒ…ï¼ˆHTTPS åœ°å€ï¼‰</span>
npm install https://xxx.company.com/plugins/vue-cli-plugin-vue-mobile-preview-1.0.0.tgz --save-dev

<span class="hljs-comment"># pnpm/yarn å‘½ä»¤å…¼å®¹ï¼Œåªéœ€æ›¿æ¢ npm install ä¸º pnpm add / yarn add</span>
</code></pre>
</li>
<li>
<p>éªŒè¯ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½ï¼š
æ‰§è¡Œ <code>npm run serve</code> å¯åŠ¨é¡¹ç›®ï¼Œåç»­æ­¥éª¤åŒã€Œæœ¬åœ°è°ƒè¯•ã€ï¼Œæ‰‹æœºæ‰«ç å³å¯é¢„è§ˆã€‚</p>
</li>
</ol>
<h3 data-id="heading-16">åœºæ™¯3ï¼šNPM å…¬å¼€åŒ…ä½¿ç”¨ï¼ˆå…¨ç½‘å¤ç”¨ï¼Œå¼€æºå…±äº«ï¼‰</h3>
<p>é€‚ç”¨äºæ’ä»¶åŠŸèƒ½æˆç†Ÿï¼Œéœ€è¦å…¬å¼€ç»™å…¨ç½‘å¼€å‘è€…ä½¿ç”¨ï¼Œå‘å¸ƒåˆ° npm å…¬å¼€ä»“åº“ã€‚</p>
<h4 data-id="heading-17">æ“ä½œæ­¥éª¤</h4>
<ol>
<li>
<p>å‰ç½®å‡†å¤‡ï¼š</p>
<ul>
<li>æ‹¥æœ‰ npm è´¦å·ï¼ˆæœªæ³¨å†Œå¯å‰å¾€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2F" target="_blank" title="https://www.npmjs.com/" ref="nofollow noopener noreferrer">npm å®˜ç½‘</a> æ³¨å†Œï¼‰ï¼›</li>
<li>åˆ‡æ¢åˆ° npm å®˜æ–¹æºï¼ˆè‹¥é…ç½®äº†å›½å†…é•œåƒæºï¼Œå°ç™½æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">npm config <span class="hljs-built_in">set</span> registry https://registry.npmjs.org/
</code></pre>
</li>
<li>
<p>ç™»å½• npm è´¦å·ï¼š
è¿›å…¥æ’ä»¶ç›®å½•ï¼Œæ‰§è¡Œç™»å½•å‘½ä»¤ï¼ŒæŒ‰æç¤ºè¾“å…¥ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥æ’ä»¶ç›®å½•</span>
<span class="hljs-built_in">cd</span> vue-cli-plugin-vue-mobile-preview

<span class="hljs-comment"># ç™»å½• npm è´¦å·</span>
npm login
</code></pre>
</li>
<li>
<p>å‘å¸ƒæ’ä»¶åˆ° npm å…¬å¼€ä»“åº“ï¼š
åœ¨æ’ä»¶ç›®å½•ä¸‹æ‰§è¡Œå‘å¸ƒå‘½ä»¤ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm publish
</code></pre>
<ul>
<li>å‘å¸ƒå¤±è´¥æ’æŸ¥ï¼šè‹¥æç¤ºåŒ…åé‡å¤ï¼Œä¿®æ”¹ <code>package.json</code> ä¸­çš„ <code>name</code> å­—æ®µï¼›è‹¥æç¤ºç‰ˆæœ¬é‡å¤ï¼Œä¿®æ”¹ <code>version</code> å­—æ®µï¼ˆå¦‚ä» 1.0.0 æ”¹ä¸º 1.0.1ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>é¡¹ç›®ä¸­å®‰è£… NPM æ’ä»¶ï¼š
åœ¨ä»»æ„ Vue CLI 3+ é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å®‰è£…ï¼ˆå…¨ç½‘å¼€å‘è€…å‡å¯ä½¿ç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šnpm å‘½ä»¤ï¼ˆæ¨èï¼‰</span>
npm install vue-cli-plugin-vue-mobile-preview --save-dev

<span class="hljs-comment"># æ–¹å¼2ï¼šVue CLI ä¸“å±å¿«æ·å‘½ä»¤ï¼ˆè‡ªåŠ¨è¯†åˆ«æ’ä»¶ï¼Œæ— éœ€åŠ  --save-devï¼‰</span>
vue add vue-mobile-preview

<span class="hljs-comment"># pnpm/yarn å‘½ä»¤å…¼å®¹</span>
<span class="hljs-comment"># pnpm add vue-cli-plugin-vue-mobile-preview -D</span>
<span class="hljs-comment"># yarn add vue-cli-plugin-vue-mobile-preview --dev</span>
</code></pre>
</li>
<li>
<p>éªŒè¯ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½ï¼š
æ‰§è¡Œ <code>npm run serve</code> å¯åŠ¨é¡¹ç›®ï¼Œæ‰‹æœºæ‰«ç å³å¯é¢„è§ˆæœ¬åœ° Vue é¡¹ç›®ã€‚</p>
</li>
</ol>
<h3 data-id="heading-18">åœºæ™¯4ï¼šGit ä»“åº“ä½¿ç”¨ï¼ˆå›¢é˜Ÿåä½œï¼Œæ— éœ€å‘å¸ƒ NPMï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶ï¼‰</h3>
<p>é€‚ç”¨äºæ’ä»¶æ‰˜ç®¡åœ¨ Git ä»“åº“ï¼ˆGitHub/Gitee/GitLabï¼‰ï¼Œå›¢é˜Ÿæˆå‘˜å¯ç›´æ¥é€šè¿‡ Git åœ°å€å®‰è£…ï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶å’Œä»£ç åŒæ­¥ã€‚</p>
<h4 data-id="heading-19">æ“ä½œæ­¥éª¤</h4>
<ol>
<li>
<p>æ’ä»¶ç›®å½•åˆå§‹åŒ– Git ä»“åº“ï¼š
è¿›å…¥æ’ä»¶ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ–å¹¶æäº¤ä»£ç ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥æ’ä»¶ç›®å½•</span>
<span class="hljs-built_in">cd</span> vue-cli-plugin-vue-mobile-preview

<span class="hljs-comment"># åˆå§‹åŒ– Git ä»“åº“</span>
git init

<span class="hljs-comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span>
git add .

<span class="hljs-comment"># æäº¤ä»£ç </span>
git commit -m <span class="hljs-string">"init: å®Œæˆç§»åŠ¨ç«¯é¢„è§ˆæ’ä»¶å¼€å‘ï¼Œæ”¯æŒæ‰«ç è®¿é—®"</span>
</code></pre>
</li>
<li>
<p>æ¨é€æ’ä»¶åˆ°çº¿ä¸Š Git ä»“åº“ï¼š
åœ¨ GitHub/Gitee/GitLab ä¸Šåˆ›å»ºä¸€ä¸ªæ–°ä»“åº“ï¼Œç„¶åå°†æœ¬åœ°æ’ä»¶ä»£ç æ¨é€ä¸Šå»ï¼ˆä»¥ GitHub ä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…³è”çº¿ä¸Š Git ä»“åº“ï¼ˆæ›¿æ¢ä¸ºä½ çš„ä»“åº“åœ°å€ï¼‰</span>
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/vue-cli-plugin-vue-mobile-preview.git

<span class="hljs-comment"># æ¨é€ä»£ç åˆ° master/main åˆ†æ”¯</span>
git push -u origin master
</code></pre>
</li>
<li>
<p>é¡¹ç›®ä¸­é€šè¿‡ Git åœ°å€å®‰è£…æ’ä»¶ï¼š
è¿›å…¥ç›®æ ‡ Vue é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼ˆæ”¯æŒ HTTPS/SSH ä¸¤ç§åœ°å€æ ¼å¼ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šHTTPS åœ°å€ï¼ˆæ— éœ€é…ç½®å¯†é’¥ï¼Œå°ç™½æ¨èä½¿ç”¨ï¼Œå…¬å¼€/ç§æœ‰ä»“åº“å‡å¯ï¼‰</span>
npm install https://github.com/ä½ çš„ç”¨æˆ·å/vue-cli-plugin-vue-mobile-preview.git --save-dev

<span class="hljs-comment"># æ–¹å¼2ï¼šSSH åœ°å€ï¼ˆéœ€é…ç½® Git å¯†é’¥ï¼Œæ¨èå›¢é˜Ÿç§æœ‰ä»“åº“ä½¿ç”¨ï¼‰</span>
npm install git+ssh://git@github.com/ä½ çš„ç”¨æˆ·å/vue-cli-plugin-vue-mobile-preview.git --save-dev

<span class="hljs-comment"># æ–¹å¼3ï¼šGitHub ä¸“å±ç®€åŒ–æ ¼å¼ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰</span>
npm install ä½ çš„ç”¨æˆ·å/vue-cli-plugin-vue-mobile-preview --save-dev

<span class="hljs-comment"># pnpm/yarn å‘½ä»¤å…¼å®¹</span>
</code></pre>
</li>
<li>
<p>éªŒè¯ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½ï¼š
æ‰§è¡Œ <code>npm run serve</code> å¯åŠ¨é¡¹ç›®ï¼Œæ‰‹æœºæ‰«ç å³å¯é¢„è§ˆæœ¬åœ° Vue é¡¹ç›®ï¼ŒåŒæ—¶å¯é€šè¿‡ Git ä»“åº“å®ç°æ’ä»¶ç‰ˆæœ¬æ›´æ–°å’Œå›¢é˜ŸåŒæ­¥ã€‚</p>
</li>
</ol>
<h2 data-id="heading-20">äº”ã€æ’ä»¶å¼€å‘ç»†èŠ‚ä¼˜åŒ–ï¼ˆè§£å†³äºŒç»´ç è¾“å‡ºæ—¶æœºé—®é¢˜ï¼‰</h2>
<p>è¿™æ˜¯æ’ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„å¸¸è§é—®é¢˜ï¼Œä¸å½±å“æ ¸å¿ƒçš„ç§»åŠ¨ç«¯é¢„è§ˆåŠŸèƒ½ï¼Œä½†å¯ä¼˜åŒ–ä½¿ç”¨ä½“éªŒï¼Œå°ç™½å¯ç›´æ¥å¤ç”¨ä»£ç ï¼Œæ— éœ€æ·±å…¥ç†è§£ã€‚</p>
<h3 data-id="heading-21">1.  é—®é¢˜æè¿°</h3>
<p>è‹¥ä½¿ç”¨ <code>devServer.after</code> é’©å­è¾“å‡ºäºŒç»´ç ï¼Œä¼šå‡ºç°ã€ŒäºŒç»´ç è¾“å‡ºåè¿˜æœ‰ Webpack ç¼–è¯‘æ—¥å¿—ã€çš„é—®é¢˜ï¼Œå¯¼è‡´æ—¥å¿—æ··ä¹±ï¼›è‹¥æå‰è¾“å‡ºï¼Œä¼šè¢«æ„å»ºæ—¥å¿—è¦†ç›–ï¼Œå½±å“æ‰«ç ä½“éªŒã€‚</p>
<h3 data-id="heading-22">2.  è§£å†³æ–¹æ¡ˆ</h3>
<p>ä½¿ç”¨ <code>compiler.hooks.done</code> äº‹ä»¶ï¼Œåœ¨ Webpack ç¼–è¯‘ï¼ˆé¦–æ¬¡æ„å»ºï¼‰å®Œæˆåè¾“å‡ºäºŒç»´ç ï¼ŒåŒæ—¶æ·»åŠ  <code>hasPrintQrcode</code> æ ‡è®°ï¼Œé¿å…çƒ­æ›´æ–°æ—¶é‡å¤è¾“å‡ºï¼Œä»£ç å·²é›†æˆåœ¨æ’ä»¶æ ¸å¿ƒ <code>index.js</code> ä¸­ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹ã€‚</p>
<h3 data-id="heading-23">3.  ä¼˜åŒ–æ•ˆæœ</h3>
<ul>
<li>äºŒç»´ç åœ¨é¡¹ç›®å®Œå…¨å°±ç»ªåè¾“å‡ºï¼Œæ—¥å¿—æ•´æ´ç¾è§‚ï¼Œæ— å¤šä½™ä¿¡æ¯å¹²æ‰°ï¼›</li>
<li>ä»…è¾“å‡ºä¸€æ¬¡äºŒç»´ç ï¼Œé¿å…çƒ­æ›´æ–°æ—¶é‡å¤æ‰“å°ï¼Œæå‡ä½¿ç”¨ä½“éªŒã€‚</li>
</ul>
<h2 data-id="heading-24">å…­ã€å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆå°ç™½é¿å‘æŒ‡å—ï¼‰</h2>
<h3 data-id="heading-25">1.  ç§»åŠ¨ç«¯æ‰«ç æ— æ³•è®¿é—®æœ¬åœ°é¡¹ç›®</h3>
<ul>
<li>æ’æŸ¥1ï¼šæ‰‹æœºä¸ç”µè„‘æ˜¯å¦è¿æ¥<strong>åŒä¸€ WiFi</strong>ï¼ˆåŒä¸€å±€åŸŸç½‘ï¼‰ï¼›</li>
<li>æ’æŸ¥2ï¼šç”µè„‘é˜²ç«å¢™æ˜¯å¦å…³é—­ï¼ˆé˜²ç«å¢™å¯èƒ½æ‹¦æˆªæ‰‹æœºçš„è®¿é—®è¯·æ±‚ï¼‰ï¼›</li>
<li>æ’æŸ¥3ï¼šé¡¹ç›®ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼ˆæ›´æ¢ç«¯å£åé‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œå¦‚åœ¨ <code>vue.config.js</code> ä¸­é…ç½® <code>devServer.port: 8081</code>ï¼‰ï¼›</li>
<li>æ’æŸ¥4ï¼šæ’ä»¶æ˜¯å¦è‡ªåŠ¨é…ç½® <code>host: 0.0.0.0</code>ï¼ˆæœ¬æ–‡æ’ä»¶å·²è‡ªåŠ¨é…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-26">2.  æ’ä»¶å®‰è£…åæ— äºŒç»´ç è¾“å‡º</h3>
<ul>
<li>æ’æŸ¥1ï¼šæ’ä»¶åç§°æ˜¯å¦ä»¥ <code>vue-cli-plugin-</code> å¼€å¤´ï¼ˆVue CLI ä»…è‡ªåŠ¨è¯†åˆ«è¯¥å‰ç¼€ï¼‰ï¼›</li>
<li>æ’æŸ¥2ï¼šæ˜¯å¦é‡å¯é¡¹ç›®ï¼ˆæ’ä»¶å®‰è£…åéœ€é‡å¯é¡¹ç›®æ‰èƒ½ç”Ÿæ•ˆï¼‰ï¼›</li>
<li>æ’æŸ¥3ï¼šç›®æ ‡é¡¹ç›® <code>package.json</code> ä¸­æ˜¯å¦å­˜åœ¨æ’ä»¶ä¾èµ–ï¼ˆç¡®è®¤å®‰è£…æˆåŠŸï¼‰ï¼›</li>
<li>æ’æŸ¥4ï¼šæ˜¯å¦å®‰è£… <code>qrcode</code> ä¾èµ–ï¼ˆæ’ä»¶å·²å£°æ˜ä¾èµ–ï¼Œè‹¥ç¼ºå¤±å¯æ‰‹åŠ¨æ‰§è¡Œ <code>npm install qrcode --save-dev</code>ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-27">3.  äºŒç»´ç é‡å¤è¾“å‡ºï¼ˆçƒ­æ›´æ–°æ—¶ï¼‰</h3>
<ul>
<li>æ’æŸ¥ï¼šæ˜¯å¦æ·»åŠ  <code>hasPrintQrcode</code> æ ‡è®°ï¼ˆæœ¬æ–‡æ’ä»¶å·²æ·»åŠ ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-28">4.  TGZ/Git æ’ä»¶å®‰è£…å¤±è´¥</h3>
<ul>
<li>æ’æŸ¥1ï¼šåœ°å€æ˜¯å¦æ­£ç¡®ï¼ˆTGZ åœ°å€éœ€æŒ‡å‘ <code>.tgz</code> æ–‡ä»¶ï¼ŒGit åœ°å€éœ€å¸¦ <code>.git</code> åç¼€ï¼‰ï¼›</li>
<li>æ’æŸ¥2ï¼šç½‘ç»œæ˜¯å¦é€šç•…ï¼ˆç§æœ‰æœåŠ¡å™¨/Git ä»“åº“æ˜¯å¦å¯æ­£å¸¸è®¿é—®ï¼‰ï¼›</li>
<li>æ’æŸ¥3ï¼šåŒ…ç®¡ç†å™¨ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ï¼ˆå»ºè®®ä½¿ç”¨ npm 8+ / pnpm 6+ / yarn 1+ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-29">ä¸ƒã€æ€»ç»“</h2>
<ol>
<li><strong>æ ¸å¿ƒç›®æ ‡è¾¾æˆ</strong>ï¼šæœ¬æ–‡å›´ç»•ã€Œç§»åŠ¨ç«¯ä¾¿æ·é¢„è§ˆæœ¬åœ° Vue æœåŠ¡é¡¹ç›®ã€è¿™ä¸€æ ¸å¿ƒéœ€æ±‚ï¼Œå¼€å‘äº†ä¸€æ¬¾ Vue CLI æ’ä»¶ï¼Œå®ç°äº†ã€Œè‡ªåŠ¨ç”ŸæˆäºŒç»´ç  + æ‰«ç å¿«é€Ÿè®¿é—®ã€çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œè§£å†³äº†æ‰‹åŠ¨è¾“å…¥ IP + ç«¯å£çš„ç¹çé—®é¢˜ï¼›</li>
<li><strong>å¤šåœºæ™¯å…¨è¦†ç›–</strong>ï¼šè¯¦ç»†è®²è§£äº†æ’ä»¶çš„ 4 ç§ä½¿ç”¨åœºæ™¯ï¼ˆæœ¬åœ°è°ƒè¯•ã€TGZ å‹ç¼©åŒ…ã€NPM å…¬å¼€åŒ…ã€Git ä»“åº“ï¼‰ï¼Œæ»¡è¶³ä¸ªäººå¼€å‘ã€å›¢é˜Ÿåä½œã€å…¨ç½‘å¤ç”¨ç­‰ä¸åŒéœ€æ±‚ï¼›</li>
<li><strong>å°ç™½å‹å¥½</strong>ï¼šæ‰€æœ‰ä»£ç å¯ç›´æ¥å¤åˆ¶ï¼Œæ­¥éª¤è¯¦ç»†æ— é—æ¼ï¼Œæ— éœ€å¤æ‚é…ç½®ï¼ŒåŒæ—¶æä¾›å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—ï¼Œé™ä½ä¸Šæ‰‹é—¨æ§›ï¼›</li>
<li><strong>ç»†èŠ‚ä¼˜åŒ–åˆ°ä½</strong>ï¼šé™„å¸¦è§£å†³æ’ä»¶å¼€å‘ä¸­ã€ŒäºŒç»´ç è¾“å‡ºæ—¶æœºã€çš„é—®é¢˜ï¼Œä¼˜åŒ–ä½¿ç”¨ä½“éªŒï¼Œç¡®ä¿æ—¥å¿—æ•´æ´ã€æ— é‡å¤è¾“å‡ºï¼›</li>
<li><strong>å…¼å®¹æ€§å¼º</strong>ï¼šæ”¯æŒ Vue 2/Vue 3 é¡¹ç›®ï¼Œé€‚é… Vue CLI 3+ æ‰€æœ‰ç‰ˆæœ¬ï¼Œæ— ä¾µå…¥æ€§ï¼Œå¸è½½åæ— æ®‹ç•™ã€‚</li>
</ol>
<p>é€šè¿‡æœ¬æ–‡ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾å¼€å‘å¹¶ä½¿ç”¨ Vue CLI ç§»åŠ¨ç«¯é¢„è§ˆæ’ä»¶ï¼Œå®ç°å¤šåœºæ™¯ä¸‹çš„ç§»åŠ¨ç«¯ä¾¿æ·é¢„è§ˆï¼Œæå‡ Vue é¡¹ç›®å¼€å‘æ•ˆç‡ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“AIæˆä¸ºä½ çš„å‰ç«¯æ­å­ï¼šé›¶é—¨æ§›ç”¨Cursorå¼€å¯é«˜æ•ˆå¼€å‘æ–°æ—¶ä»£]]></title>    <link>https://juejin.cn/post/7589477775209873460</link>    <guid>https://juejin.cn/post/7589477775209873460</guid>    <pubDate>2025-12-30T09:26:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589477775209873460" data-draft-id="7589462007528046626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“AIæˆä¸ºä½ çš„å‰ç«¯æ­å­ï¼šé›¶é—¨æ§›ç”¨Cursorå¼€å¯é«˜æ•ˆå¼€å‘æ–°æ—¶ä»£"/> <meta itemprop="keywords" content="å‰ç«¯,Cursor"/> <meta itemprop="datePublished" content="2025-12-30T09:26:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mr_chiu"/> <meta itemprop="url" content="https://juejin.cn/user/1644525124592974"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“AIæˆä¸ºä½ çš„å‰ç«¯æ­å­ï¼šé›¶é—¨æ§›ç”¨Cursorå¼€å¯é«˜æ•ˆå¼€å‘æ–°æ—¶ä»£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1644525124592974/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mr_chiu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:26:04.000Z" title="Tue Dec 30 2025 09:26:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä»é¡¹ç›®åˆå§‹åŒ–åˆ°ä»£ç ä¼˜åŒ–ï¼Œä¸€ä¸ªAIåŠ©æ‰‹å¦‚ä½•å½»åº•æ”¹å˜å‰ç«¯å¼€å‘çš„å·¥ä½œæµ</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šä¸ºä»€ä¹ˆå‰ç«¯å¼€å‘è€…éœ€è¦Cursorï¼Ÿ</h2>
<p>å‰ç«¯å¼€å‘æ­£ç»å†ä¸€åœºé™æ‚„æ‚„çš„é©å‘½ã€‚è¿‡å»å‡ å¹´ï¼Œæˆ‘ä»¬è§è¯äº†ä»jQueryåˆ°ä¸‰å¤§æ¡†æ¶çš„å˜è¿ï¼Œä»æ‰‹åŠ¨é…ç½®Webpackåˆ°Viteçš„é›¶é…ç½®ä½“éªŒï¼Œè€Œç°åœ¨ï¼ŒAIç¼–ç¨‹åŠ©æ‰‹æ­£åœ¨é‡æ–°å®šä¹‰æˆ‘ä»¬ç¼–å†™ä»£ç çš„æ–¹å¼ã€‚</p>
<p>ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œä½ æ˜¯å¦ä¹Ÿæ›¾é¢ä¸´è¿™äº›ç—›ç‚¹ï¼š</p>
<ul>
<li>çº ç»“äºæŸä¸ªå¤æ‚ç»„ä»¶çš„å®ç°æ–¹æ¡ˆ</li>
<li>èŠ±è´¹å¤§é‡æ—¶é—´è°ƒè¯•è¯¡å¼‚çš„æ ·å¼å…¼å®¹æ€§é—®é¢˜</li>
<li>åœ¨é‡å¤çš„ä¸šåŠ¡ä»£ç ä¸­æ¶ˆè€—åˆ›é€ åŠ›</li>
<li>é¢å¯¹æ–°æŠ€æœ¯æ ˆçš„å­¦ä¹ æ›²çº¿æ„Ÿåˆ°ç„¦è™‘</li>
</ul>
<p>Cursorçš„å‡ºç°ï¼Œå°±åƒæ˜¯ä¸ºæ¯ä¸ªå‰ç«¯å¼€å‘è€…é…å¤‡äº†ä¸€ä¸ª24å°æ—¶åœ¨çº¿çš„èµ„æ·±æ­æ¡£ã€‚ä½†ä¸åŒäºæ™®é€šçš„ä»£ç è¡¥å…¨å·¥å…·ï¼ŒCursoråŸºäºGPT-4ï¼Œèƒ½å¤Ÿç†è§£ä¸Šä¸‹æ–‡ã€åˆ†ææ•´ä¸ªé¡¹ç›®ç»“æ„ï¼Œå¹¶ç»™å‡ºæ™ºèƒ½çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€Cursoråˆä½“éªŒï¼šä»å®‰è£…åˆ°ç¬¬ä¸€ä¸ªæ™ºèƒ½ç»„ä»¶</h2>
<h3 data-id="heading-2">1.1 å®‰è£…ä¸ç¯å¢ƒé…ç½®</h3>
<p>Cursorçš„å®‰è£…è¿‡ç¨‹ç®€å•åˆ°ä»¤äººæƒŠè®¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¿é—®å®˜ç½‘ä¸‹è½½å¯¹åº”ç‰ˆæœ¬</span>
https://www.cursor.so/

<span class="hljs-comment"># æˆ–è€…é€šè¿‡Homebrewï¼ˆmacOSï¼‰</span>
brew install --cask cursor
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªä¸VS Codeæå…¶ç›¸ä¼¼çš„ç•Œé¢â€”â€”å®é™…ä¸Šï¼ŒCursoræ­£æ˜¯åŸºäºVS Codeçš„å¼€æºç‰ˆæœ¬å¼€å‘ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ä½ ç†Ÿæ‚‰çš„VS Codeå¿«æ·é”®å’Œæ‰©å±•ç”Ÿæ€åŸºæœ¬éƒ½èƒ½æ— ç¼è¿ç§»ã€‚</p>
<p><strong>é‡è¦è®¾ç½®</strong>ï¼šé¦–æ¬¡å¯åŠ¨åï¼Œå»ºè®®åœ¨è®¾ç½®ä¸­å¼€å¯â€œè‡ªåŠ¨åº”ç”¨å»ºè®®â€åŠŸèƒ½ï¼Œè¿™å°†å¤§å¹…æå‡ç¼–ç æ•ˆç‡ã€‚</p>
<h3 data-id="heading-3">1.2 ä½ çš„ç¬¬ä¸€ä¸ªAIè¾…åŠ©ç»„ä»¶</h3>
<p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªå®é™…çš„å‰ç«¯åœºæ™¯å¼€å§‹ï¼šåˆ›å»ºä¸€ä¸ªå¯å¤ç”¨çš„è¡¨å•è¾“å…¥ç»„ä»¶ã€‚</p>
<p>ä¼ ç»Ÿçš„å¼€å‘æµç¨‹ï¼š</p>
<ol>
<li>åˆ›å»ºæ–‡ä»¶ <code>InputField.jsx</code></li>
<li>ç¼–å†™åŸºç¡€ç»“æ„</li>
<li>é€æ­¥æ·»åŠ åŠŸèƒ½</li>
<li>è°ƒè¯•å’Œä¼˜åŒ–</li>
</ol>
<p>ä½¿ç”¨Cursorçš„æµç¨‹å‘ç”Ÿäº†æœ¬è´¨å˜åŒ–ï¼š</p>
<p><strong>æ­¥éª¤1ï¼šç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚</strong>
ç›´æ¥åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">åˆ›å»ºä¸€ä¸ªReactè¡¨å•è¾“å…¥ç»„ä»¶ï¼Œè¦æ±‚ï¼š
<span class="hljs-bullet">1.</span> æ”¯æŒæ ‡ç­¾ã€å ä½ç¬¦ã€é”™è¯¯çŠ¶æ€
<span class="hljs-bullet">2.</span> åŒ…å«è¾“å…¥éªŒè¯åŠŸèƒ½
<span class="hljs-bullet">3.</span> æœ‰åŠ¨ç”»è¿‡æ¸¡æ•ˆæœ
<span class="hljs-bullet">4.</span> æ”¯æŒè‡ªå®šä¹‰æ ·å¼
<span class="hljs-bullet">5.</span> ä½¿ç”¨TypeScript
</code></pre>
<p><strong>æ­¥éª¤2ï¼šè®©Cursorç”Ÿæˆä»£ç </strong>
æŒ‰ä¸‹ <code>Cmd/Ctrl + K</code>ï¼ŒCursorä¼šåˆ†æä½ çš„éœ€æ±‚å¹¶ç”Ÿæˆå®Œæ•´ä»£ç ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./InputField.css'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">InputFieldProps</span> {
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;
  placeholder?: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">type</span>?: <span class="hljs-string">'text'</span> | <span class="hljs-string">'email'</span> | <span class="hljs-string">'password'</span> | <span class="hljs-string">'number'</span>;
  required?: <span class="hljs-built_in">boolean</span>;
  error?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">onChange</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span>, isValid: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  customClassName?: <span class="hljs-built_in">string</span>;
  validationRules?: {
    pattern?: <span class="hljs-title class_">RegExp</span>;
    minLength?: <span class="hljs-built_in">number</span>;
    maxLength?: <span class="hljs-built_in">number</span>;
    customValidator?: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">boolean</span>;
  };
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">InputField</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">InputFieldProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{
  label,
  placeholder = <span class="hljs-string">''</span>,
  <span class="hljs-keyword">type</span> = <span class="hljs-string">'text'</span>,
  required = <span class="hljs-literal">false</span>,
  error: externalError,
  value,
  onChange,
  customClassName = <span class="hljs-string">''</span>,
  validationRules = {}
}</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [internalError, setInternalError] = useState&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [isTouched, setIsTouched] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [isAnimating, setIsAnimating] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> validateInput = (<span class="hljs-attr">inputValue</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (required &amp;&amp; !inputValue.<span class="hljs-title function_">trim</span>()) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'æ­¤å­—æ®µä¸ºå¿…å¡«é¡¹'</span>;
    }

    <span class="hljs-keyword">if</span> (validationRules.<span class="hljs-property">pattern</span> &amp;&amp; !validationRules.<span class="hljs-property">pattern</span>.<span class="hljs-title function_">test</span>(inputValue)) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'æ ¼å¼ä¸æ­£ç¡®'</span>;
    }

    <span class="hljs-keyword">if</span> (validationRules.<span class="hljs-property">minLength</span> &amp;&amp; inputValue.<span class="hljs-property">length</span> &lt; validationRules.<span class="hljs-property">minLength</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`é•¿åº¦ä¸èƒ½å°‘äº<span class="hljs-subst">${validationRules.minLength}</span>ä¸ªå­—ç¬¦`</span>;
    }

    <span class="hljs-keyword">if</span> (validationRules.<span class="hljs-property">maxLength</span> &amp;&amp; inputValue.<span class="hljs-property">length</span> &gt; validationRules.<span class="hljs-property">maxLength</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`é•¿åº¦ä¸èƒ½è¶…è¿‡<span class="hljs-subst">${validationRules.maxLength}</span>ä¸ªå­—ç¬¦`</span>;
    }

    <span class="hljs-keyword">if</span> (validationRules.<span class="hljs-property">customValidator</span> &amp;&amp; !validationRules.<span class="hljs-title function_">customValidator</span>(inputValue)) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'è‡ªå®šä¹‰éªŒè¯å¤±è´¥'</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt; {
    <span class="hljs-keyword">const</span> newValue = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
    <span class="hljs-keyword">const</span> errorMsg = <span class="hljs-title function_">validateInput</span>(newValue);
    <span class="hljs-title function_">setInternalError</span>(errorMsg);
    
    <span class="hljs-comment">// è§¦å‘åŠ¨ç”»</span>
    <span class="hljs-keyword">if</span> (errorMsg &amp;&amp; !isAnimating) {
      <span class="hljs-title function_">setIsAnimating</span>(<span class="hljs-literal">true</span>);
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setIsAnimating</span>(<span class="hljs-literal">false</span>), <span class="hljs-number">300</span>);
    }
    
    <span class="hljs-title function_">onChange</span>(newValue, !errorMsg);
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleBlur</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setIsTouched</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">if</span> (value) {
      <span class="hljs-keyword">const</span> errorMsg = <span class="hljs-title function_">validateInput</span>(value);
      <span class="hljs-title function_">setInternalError</span>(errorMsg);
    }
  };

  <span class="hljs-keyword">const</span> error = externalError || internalError;
  <span class="hljs-keyword">const</span> showError = isTouched &amp;&amp; error;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">input-field</span> ${<span class="hljs-attr">customClassName</span>} ${<span class="hljs-attr">showError</span> ? '<span class="hljs-attr">error</span>' <span class="hljs-attr">:</span> ''} ${<span class="hljs-attr">isAnimating</span> ? '<span class="hljs-attr">shake</span>' <span class="hljs-attr">:</span> ''}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"input-label"</span>&gt;</span>
        {label}
        {required &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"required-asterisk"</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">{placeholder}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">input-element</span> ${<span class="hljs-attr">showError</span> ? '<span class="hljs-attr">input-error</span>' <span class="hljs-attr">:</span> ''}`}
        <span class="hljs-attr">aria-invalid</span>=<span class="hljs-string">{!!showError}</span>
        <span class="hljs-attr">aria-describedby</span>=<span class="hljs-string">{showError</span> ? `<span class="hljs-attr">error-</span>${<span class="hljs-attr">label</span>}` <span class="hljs-attr">:</span> <span class="hljs-attr">undefined</span>}
      /&gt;</span>
      {showError &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
          <span class="hljs-attr">id</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">error-</span>${<span class="hljs-attr">label</span>}`}
          <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message animate-in"</span>
          <span class="hljs-attr">role</span>=<span class="hljs-string">"alert"</span>
        &gt;</span>
          {error}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">InputField</span>;
</code></pre>
<p><strong>æ­¥éª¤3ï¼šè®©Cursorç”Ÿæˆé…å¥—æ ·å¼</strong>
ç»§ç»­ä½¿ç”¨ <code>Cmd/Ctrl + K</code>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ä¸ºä¸Šé¢çš„ç»„ä»¶ç”Ÿæˆåˆé€‚çš„CSSæ ·å¼ï¼Œè¦æ±‚ï¼š
<span class="hljs-bullet">1.</span> ä½¿ç”¨ç°ä»£CSSè®¾è®¡
<span class="hljs-bullet">2.</span> åŒ…å«é”™è¯¯çŠ¶æ€çš„è§†è§‰åé¦ˆ
<span class="hljs-bullet">3.</span> å®ç°æ‘‡åŠ¨åŠ¨ç”»æ•ˆæœ
<span class="hljs-bullet">4.</span> ç¡®ä¿å¯è®¿é—®æ€§
</code></pre>
<p>Cursorä¼šç”Ÿæˆå®Œæ•´çš„CSSæ–‡ä»¶ï¼Œç”šè‡³åŒ…æ‹¬CSSå˜é‡å’ŒåŠ¨ç”»å…³é”®å¸§ã€‚</p>
<h3 data-id="heading-4">1.3 è¿›é˜¶åŠŸèƒ½ï¼šè®©Cursoré‡æ„å’Œä¼˜åŒ–ä»£ç </h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸ºç»„ä»¶æ·»åŠ é˜²æŠ–åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ“ä½œï¼š</p>
<p>é€‰ä¸­éœ€è¦ä¿®æ”¹çš„å‡½æ•°ï¼ŒæŒ‰ä¸‹ <code>Cmd/Ctrl + L</code> æ‰“å¼€èŠå¤©æ¡†ï¼š</p>
<pre><code class="hljs">ä¸ºhandleChangeå‡½æ•°æ·»åŠ é˜²æŠ–åŠŸèƒ½ï¼Œ300mså»¶è¿Ÿ
</code></pre>
<p>Cursorä¼šè‡ªåŠ¨é‡æ„ä»£ç ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { debounce } <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash-es'</span>;

<span class="hljs-comment">// åœ¨ç»„ä»¶å†…éƒ¨</span>
<span class="hljs-keyword">const</span> debouncedChangeHandler = <span class="hljs-title function_">useMemo</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-function">(<span class="hljs-params">newValue: <span class="hljs-built_in">string</span>, isValid: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
    <span class="hljs-title function_">onChange</span>(newValue, isValid);
  }, <span class="hljs-number">300</span>),
  [onChange]
);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt; {
  <span class="hljs-keyword">const</span> newValue = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
  <span class="hljs-keyword">const</span> errorMsg = <span class="hljs-title function_">validateInput</span>(newValue);
  <span class="hljs-title function_">setInternalError</span>(errorMsg);
  
  <span class="hljs-keyword">if</span> (errorMsg &amp;&amp; !isAnimating) {
    <span class="hljs-title function_">setIsAnimating</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setIsAnimating</span>(<span class="hljs-literal">false</span>), <span class="hljs-number">300</span>);
  }
  
  <span class="hljs-comment">// ä½¿ç”¨é˜²æŠ–ç‰ˆæœ¬</span>
  <span class="hljs-title function_">debouncedChangeHandler</span>(newValue, !errorMsg);
};
</code></pre>
<h2 data-id="heading-5">äºŒã€Cursorçš„æ ¸å¿ƒä¼˜åŠ¿ï¼šå‰ç«¯å¼€å‘çš„å››å¤§åœºæ™¯</h2>
<h3 data-id="heading-6">2.1 æ™ºèƒ½ä»£ç è¡¥å…¨ä¸ä¸Šä¸‹æ–‡ç†è§£</h3>
<p>ä¼ ç»ŸIDEçš„è‡ªåŠ¨è¡¥å…¨åªèƒ½åŸºäºè¯­æ³•ï¼Œè€ŒCursorèƒ½åŸºäºæ•´ä¸ªé¡¹ç›®ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨Reduxé¡¹ç›®ä¸­è¾“å…¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ è¾“å…¥ï¼šåˆ›å»ºä¸€ä¸ªaction creatoræ¥å¤„ç†ç”¨æˆ·ç™»å½•</span>
<span class="hljs-comment">// Cursorä¼šè‡ªåŠ¨ç”Ÿæˆï¼š</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">loginUser</span> = (<span class="hljs-params">credentials</span>) =&gt; <span class="hljs-keyword">async</span> (dispatch) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'LOGIN_REQUEST'</span> });
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/auth/login'</span>, credentials);
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>, response.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>);
    <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'LOGIN_SUCCESS'</span>, <span class="hljs-attr">payload</span>: response.<span class="hljs-property">data</span>.<span class="hljs-property">user</span> });
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'LOGIN_FAILURE'</span>, <span class="hljs-attr">payload</span>: error.<span class="hljs-property">message</span> });
    <span class="hljs-keyword">throw</span> error;
  }
};
</code></pre>
<h3 data-id="heading-7">2.2 é›¶æˆæœ¬å­¦ä¹ æ–°æŠ€æœ¯æ ˆ</h3>
<p>æƒ³å°è¯•Svelteä½†ä¸æƒ³èŠ±æ—¶é—´å­¦ä¹ æ‰€æœ‰ç»†èŠ‚ï¼Ÿç›´æ¥å‘Šè¯‰Cursorï¼š</p>
<pre><code class="hljs">ç”¨Svelteåˆ›å»ºä¸€ä¸ªå¯æ‹–æ‹½çš„ä»»åŠ¡çœ‹æ¿ç»„ä»¶ï¼Œæ”¯æŒæœ¬åœ°å­˜å‚¨
</code></pre>
<h3 data-id="heading-8">2.3 è°ƒè¯•ä¸é—®é¢˜è§£å†³</h3>
<p>é‡åˆ°ä¸€ä¸ªæ£˜æ‰‹çš„bugï¼Ÿç›´æ¥æŠŠé”™è¯¯ä¿¡æ¯è´´ç»™Cursorï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">æˆ‘åœ¨<span class="hljs-keyword">Next</span>.jsé¡¹ç›®ä¸­é‡åˆ°è¿™ä¸ªé”™è¯¯ï¼šHydration failed because the initial UI does <span class="hljs-keyword">not</span> match what was rendered <span class="hljs-keyword">on</span> the <span class="hljs-built_in">server</span>
è¿™æ˜¯ç›¸å…³ç»„ä»¶ä»£ç ï¼š[ç²˜è´´ä»£ç ]
å¦‚ä½•ä¿®å¤ï¼Ÿ
</code></pre>
<p>Cursorä¸ä»…èƒ½è§£é‡Šé—®é¢˜åŸå› ï¼Œè¿˜èƒ½ç»™å‡ºå…·ä½“çš„ä¿®å¤æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-9">2.4 æ–‡æ¡£å’Œæµ‹è¯•ç”Ÿæˆ</h3>
<p>ç”Ÿæˆç»„ä»¶æ–‡æ¡£ï¼š</p>
<pre><code class="hljs">ä¸ºInputFieldç»„ä»¶ç”ŸæˆMarkdownæ–‡æ¡£ï¼ŒåŒ…æ‹¬propsè¡¨æ ¼å’Œä½¿ç”¨ç¤ºä¾‹
</code></pre>
<p>ç”Ÿæˆå•å…ƒæµ‹è¯•ï¼š</p>
<pre><code class="hljs">ä¸ºInputFieldç»„ä»¶ç¼–å†™Jestæµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–æ‰€æœ‰éªŒè¯è§„åˆ™
</code></pre>
<h2 data-id="heading-10">ä¸‰ã€å®æˆ˜æ¼”ç»ƒï¼šç”¨Cursorå¿«é€Ÿæ­å»ºé¡¹ç›®éª¨æ¶</h2>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨30åˆ†é’Ÿæ­å»ºä¸€ä¸ªç°ä»£Reactåº”ç”¨éª¨æ¶ï¼š</p>
<ol>
<li><strong>é¡¹ç›®åˆå§‹åŒ–</strong></li>
</ol>
<pre><code class="hljs">ä½¿ç”¨Vite + React + TypeScriptåˆ›å»ºæ–°é¡¹ç›®ï¼Œé…ç½®å¥½ESLintã€Prettierã€Tailwind CSSå’ŒReact Router
</code></pre>
<ol start="2">
<li><strong>å¸ƒå±€ç»„ä»¶ç”Ÿæˆ</strong></li>
</ol>
<pre><code class="hljs">åˆ›å»ºä¸€ä¸ªå“åº”å¼å¸ƒå±€ç»„ä»¶ï¼ŒåŒ…å«å¯¼èˆªæ ã€ä¾§è¾¹æ å’Œä¸»å†…å®¹åŒºåŸŸ
å¯¼èˆªæ åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤ºæ±‰å ¡èœå•
</code></pre>
<ol start="3">
<li><strong>é¡µé¢ç»„ä»¶æ‰¹é‡åˆ›å»º</strong></li>
</ol>
<pre><code class="hljs language-diff" lang="diff">åˆ›å»ºä»¥ä¸‹é¡µé¢ç»„ä»¶ï¼š
<span class="hljs-deletion">- é¦–é¡µï¼šå±•ç¤ºä»ªè¡¨ç›˜</span>
<span class="hljs-deletion">- ç”¨æˆ·åˆ—è¡¨ï¼šå¸¦æœç´¢å’Œåˆ†é¡µ</span>
<span class="hljs-deletion">- è®¾ç½®é¡µé¢ï¼šé€‰é¡¹å¡å¸ƒå±€</span>
<span class="hljs-deletion">- 404é¡µé¢</span>
</code></pre>
<ol start="4">
<li><strong>çŠ¶æ€ç®¡ç†é…ç½®</strong></li>
</ol>
<pre><code class="hljs">é…ç½®Zustandä½œä¸ºçŠ¶æ€ç®¡ç†ï¼Œåˆ›å»ºç”¨æˆ·å’Œä¸»é¢˜çš„store
</code></pre>
<ol start="5">
<li><strong>APIå±‚å°è£…</strong></li>
</ol>
<pre><code class="hljs">åˆ›å»ºç»Ÿä¸€çš„APIè¯·æ±‚å·¥å…·ï¼ŒåŒ…å«æ‹¦æˆªå™¨ã€é”™è¯¯å¤„ç†å’ŒLoadingçŠ¶æ€ç®¡ç†
</code></pre>
<h2 data-id="heading-11">å››ã€Cursorä½¿ç”¨æŠ€å·§ï¼šæå‡æ•ˆç‡çš„ç§˜ç±</h2>
<h3 data-id="heading-12">4.1 ç²¾å‡†æé—®çš„è‰ºæœ¯</h3>
<p>ä½æ•ˆæé—®ï¼š</p>
<pre><code class="hljs">å¦‚ä½•åšä¸€ä¸ªæŒ‰é’®ï¼Ÿ
</code></pre>
<p>é«˜æ•ˆæé—®ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">åˆ›å»ºä¸€ä¸ªReactæŒ‰é’®ç»„ä»¶ï¼Œè¦æ±‚ï¼š
<span class="hljs-bullet">1.</span> æ”¯æŒprimaryã€secondaryã€dangerä¸‰ç§ç±»å‹
<span class="hljs-bullet">2.</span> æœ‰loadingçŠ¶æ€å’Œç¦ç”¨çŠ¶æ€
<span class="hljs-bullet">3.</span> æ”¯æŒå›¾æ ‡å’Œæ–‡æœ¬ç»„åˆ
<span class="hljs-bullet">4.</span> ä½¿ç”¨CSS-in-JSæ–¹æ¡ˆ
<span class="hljs-bullet">5.</span> å¯¼å‡ºTypeScriptç±»å‹å®šä¹‰
</code></pre>
<h3 data-id="heading-13">4.2 åˆ©ç”¨é¡¹ç›®ä¸Šä¸‹æ–‡</h3>
<p>Cursorå¯ä»¥åˆ†ææ•´ä¸ªé¡¹ç›®ç»“æ„ã€‚åœ¨æé—®å‰ï¼Œç¡®ä¿ï¼š</p>
<ol>
<li>å·²ç»æ‰“å¼€äº†ç›¸å…³æ–‡ä»¶</li>
<li>æåˆ°äº†é‡è¦çš„ä¾èµ–é¡¹</li>
<li>è¯´æ˜äº†é¡¹ç›®çº¦æŸæ¡ä»¶</li>
</ol>
<h3 data-id="heading-14">4.3 é“¾å¼è°ƒç”¨</h3>
<p>å¤æ‚ä»»åŠ¡å¯ä»¥åˆ†è§£ï¼š</p>
<pre><code class="hljs">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·æ¨¡å‹æ¥å£
ç¬¬äºŒæ­¥ï¼šåŸºäºè¿™ä¸ªæ¥å£åˆ›å»ºCRUD APIå‡½æ•°
ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå¯¹åº”çš„React Hookå°è£…
ç¬¬å››æ­¥ï¼šç”Ÿæˆä½¿ç”¨ç¤ºä¾‹
</code></pre>
<h2 data-id="heading-15">äº”ã€æ½œåœ¨é™·é˜±ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">5.1 éœ€è¦è°¨æ…å¯¹å¾…çš„åœºæ™¯</h3>
<ol>
<li><strong>å®‰å…¨æ€§</strong>ï¼šæ°¸è¿œä¸è¦è®©Cursorç”Ÿæˆæ¶‰åŠæ•æ„Ÿé€»è¾‘çš„ä»£ç ï¼ˆå¦‚è®¤è¯ã€æ”¯ä»˜ï¼‰</li>
<li><strong>æ€§èƒ½å…³é”®ä»£ç </strong>ï¼šç®—æ³•ä¼˜åŒ–ç­‰éœ€è¦äººå·¥å®¡æŸ¥</li>
<li><strong>ä¸šåŠ¡å¤æ‚é€»è¾‘</strong>ï¼šAIå¯èƒ½ä¸ç†è§£ä¸šåŠ¡ä¸Šä¸‹æ–‡</li>
</ol>
<h3 data-id="heading-17">5.2 æ¨èçš„å¼€å‘æµç¨‹</h3>
<pre><code class="hljs language-css" lang="css">éœ€æ±‚åˆ†æ â†’ äººå·¥è®¾è®¡æ ¸å¿ƒæ¶æ„ â†’ <span class="hljs-attribute">Cursor</span>è¾…åŠ©å®ç°ç»†èŠ‚ â†’ äººå·¥ä»£ç å®¡æŸ¥ â†’ æµ‹è¯•éªŒè¯
</code></pre>
<h3 data-id="heading-18">5.3 ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥</h3>
<p>å»ºè®®ï¼šå°†æ‰€æœ‰Cursorç”Ÿæˆçš„ä»£ç è§†ä¸º"åˆç¨¿"ï¼Œç»è¿‡å®¡æŸ¥ä¿®æ”¹åå†æäº¤ã€‚å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„æäº¤å‰ç¼€ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m "cursor: ç”ŸæˆåŸºç¡€ç»„ä»¶æ¡†æ¶"
git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m "feat: ä¼˜åŒ–Cursorç”Ÿæˆçš„è¡¨å•ç»„ä»¶"
</code></pre>
<h2 data-id="heading-19">ç»“è¯­ï¼šAIæ—¶ä»£çš„å‰ç«¯å¼€å‘è€…å®šä½</h2>
<p>Cursorä¸æ˜¯è¦å–ä»£å‰ç«¯å¼€å‘è€…ï¼Œè€Œæ˜¯æˆä¸ºæˆ‘ä»¬çš„"è¶…èƒ½åŠ›æ‰©å±•"ã€‚å®ƒè®©æˆ‘ä»¬ï¼š</p>
<ol>
<li><strong>ä¸“æ³¨æ¶æ„è®¾è®¡</strong>ï¼šä»çç¢ä»£ç ä¸­è§£æ”¾å‡ºæ¥</li>
<li><strong>åŠ é€Ÿå­¦ä¹ æ›²çº¿</strong>ï¼šå¿«é€ŸæŒæ¡æ–°æŠ€æœ¯</li>
<li><strong>æå‡ä»£ç è´¨é‡</strong>ï¼šè·å¾—å³æ—¶çš„æœ€ä½³å®è·µå»ºè®®</li>
<li><strong>æ¿€å‘åˆ›é€ åŠ›</strong>ï¼šå°è¯•æ›´å¤šåˆ›æ–°æ–¹æ¡ˆ</li>
</ol>
<p><strong>è®°ä½</strong>ï¼šæœ€å¼ºå¤§çš„å¼€å‘è€…ä¸æ˜¯ä¼šå†™æ‰€æœ‰ä»£ç çš„äººï¼Œè€Œæ˜¯çŸ¥é“å¦‚ä½•è®©AIå†™å‡ºæ›´å¥½ä»£ç çš„äººã€‚</p>
<hr/>
<p><strong>é¢„å‘Š</strong>ï¼šåœ¨ä¸‹ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¦‚ä½•ç”¨Cursoré‡æ„å¤§å‹å‰ç«¯é¡¹ç›®ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>é—ç•™ä»£ç çš„æ™ºèƒ½åˆ†æä¸é‡æ„</li>
<li>æŠ€æœ¯æ ˆè¿ç§»çš„è‡ªåŠ¨åŒ–ç­–ç•¥</li>
<li>æ€§èƒ½ä¼˜åŒ–çš„AIè¾…åŠ©æ–¹æ¡ˆ</li>
<li>å›¢é˜Ÿåä½œä¸­Cursorçš„æœ€ä½³å®è·µ</li>
</ul>
<p>å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šåœºæ™¯æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚è®©æˆ‘ä»¬å…±åŒæ¢ç´¢AIæ—¶ä»£å‰ç«¯å¼€å‘çš„æ–°èŒƒå¼ï¼</p>
<p><strong>æ€è€ƒé¢˜</strong>ï¼šåœ¨ä½ çš„å½“å‰é¡¹ç›®ä¸­ï¼Œå“ªä¸ªé‡å¤æ€§æœ€é«˜çš„ä»»åŠ¡æœ€é€‚åˆè®©Cursoræ¥ååŠ©å®Œæˆï¼Ÿè¯•ç€ç”¨å®ƒè§£å†³ä¸€ä¸ªå°é—®é¢˜ï¼Œå¹¶åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ä½“éªŒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜²æŠ–ä¸èŠ‚æµï¼šå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„â€œåŒå­æ˜Ÿâ€ï¼Œè®©ä½ çš„ç½‘é¡µä¸æ»‘å¦‚å¾·èŠ™ï¼]]></title>    <link>https://juejin.cn/post/7589462007528292386</link>    <guid>https://juejin.cn/post/7589462007528292386</guid>    <pubDate>2025-12-30T09:47:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589462007528292386" data-draft-id="7589466356779515956" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜²æŠ–ä¸èŠ‚æµï¼šå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„â€œåŒå­æ˜Ÿâ€ï¼Œè®©ä½ çš„ç½‘é¡µä¸æ»‘å¦‚å¾·èŠ™ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-30T09:47:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yira"/> <meta itemprop="url" content="https://juejin.cn/user/262123324974122"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜²æŠ–ä¸èŠ‚æµï¼šå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„â€œåŒå­æ˜Ÿâ€ï¼Œè®©ä½ çš„ç½‘é¡µä¸æ»‘å¦‚å¾·èŠ™ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/262123324974122/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yira
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:47:30.000Z" title="Tue Dec 30 2025 09:47:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é˜²æŠ–ä¸èŠ‚æµï¼šå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„â€œåŒå­æ˜Ÿâ€ï¼Œè®©ä½ çš„ç½‘é¡µä¸æ»‘å¦‚å¾·èŠ™ï¼</h2>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œç”¨æˆ·äº¤äº’è¶Šæ¥è¶Šä¸°å¯Œï¼Œäº‹ä»¶è§¦å‘ä¹Ÿè¶Šæ¥è¶Šé¢‘ç¹ã€‚æ— è®ºæ˜¯æœç´¢æ¡†çš„å®æ—¶å»ºè®®ã€é¡µé¢æ»šåŠ¨åŠ è½½ï¼Œè¿˜æ˜¯çª—å£å°ºå¯¸è°ƒæ•´ï¼Œè¿™äº›çœ‹ä¼¼ç®€å•çš„æ“ä½œèƒŒåï¼Œéƒ½å¯èƒ½éšè—ç€<strong>æ€§èƒ½é™·é˜±</strong>ã€‚å¦‚æœä¸åŠ ä»¥æ§åˆ¶ï¼Œé«˜é¢‘äº‹ä»¶ä¼šåƒæ´ªæ°´ä¸€æ ·å†²å®ä½ çš„åº”ç”¨â€”â€”å¯¼è‡´å¡é¡¿ã€å†…å­˜æ³„æ¼ï¼Œç”šè‡³æœåŠ¡å™¨å´©æºƒã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆæ—©å·²æ‰¾åˆ°äº†ä¸¤å¤§åˆ©å™¨ï¼š<strong>é˜²æŠ–ï¼ˆDebounceï¼‰</strong> ä¸ <strong>èŠ‚æµï¼ˆThrottleï¼‰</strong> ã€‚å®ƒä»¬å¦‚åŒæ€§èƒ½ä¼˜åŒ–é¢†åŸŸçš„â€œåŒå­æ˜Ÿâ€ï¼Œä¸€ä¸ªä¸“æ³¨â€œç­‰ä½ åœæ‰‹â€ï¼Œä¸€ä¸ªåšæŒâ€œæŒ‰èŠ‚å¥æ¥â€ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ·±å…¥å‰–æè¿™ä¸¤ä½é«˜æ‰‹çš„åŸç†ã€åŒºåˆ«ä¸å®æˆ˜ç”¨æ³•ï¼ŒåŠ©ä½ å†™å‡ºæ›´é«˜æ•ˆã€æ›´æµç•…çš„ä»£ç ï¼</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é—®é¢˜æ ¹æºï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦é˜²æŠ–å’ŒèŠ‚æµï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨ç™¾åº¦æœç´¢æ¡†è¾“å…¥â€œReactæ•™ç¨‹â€ï¼š</p>
<ul>
<li>æ¯æŒ‰ä¸‹ä¸€ä¸ªé”®ï¼ˆR â†’ e â†’ a â†’ c â†’ t â€¦ï¼‰ï¼Œæµè§ˆå™¨éƒ½ä¼šè§¦å‘ä¸€æ¬¡Â <code>keyup</code>Â äº‹ä»¶ï¼›</li>
<li>å¦‚æœæ¯æ¬¡äº‹ä»¶éƒ½ç«‹å³å‘é€ AJAX è¯·æ±‚ï¼Œé‚£ä¹ˆçŸ­çŸ­ 6 ä¸ªå­—å°±ä¼šå‘å‡ºÂ <strong>6 æ¬¡ç½‘ç»œè¯·æ±‚</strong>ï¼›</li>
<li>è€Œå®é™…ä¸Šï¼Œä½ åªå…³å¿ƒæœ€ç»ˆçš„å…³é”®è¯ â€œReactæ•™ç¨‹â€ã€‚</li>
</ul>
<p>è¿™å°±æ˜¯å…¸å‹çš„ <strong>â€œé«˜é¢‘äº‹ä»¶ + å¤æ‚ä»»åŠ¡â€</strong> ç»„åˆï¼š</p>
<ul>
<li><strong>äº‹ä»¶å¤ªå¯†é›†</strong>ï¼š<code>keyup</code>ã€<code>scroll</code>ã€<code>resize</code>Â ç­‰äº‹ä»¶æ¯ç§’å¯è§¦å‘æ•°åæ¬¡ï¼›</li>
<li><strong>ä»»åŠ¡å¤ªå¤æ‚</strong>ï¼šAJAX è¯·æ±‚ã€DOM æ“ä½œã€å¤æ‚è®¡ç®—ç­‰æ¶ˆè€—å¤§é‡èµ„æºã€‚</li>
</ul>
<p>è‹¥ä¸åŠ é™åˆ¶ï¼Œåæœä¸¥é‡ï¼š</p>
<ul>
<li>æµªè´¹å¸¦å®½å’ŒæœåŠ¡å™¨èµ„æºï¼›</li>
<li>é¡µé¢å¡é¡¿ï¼Œç”¨æˆ·ä½“éªŒå·®ï¼›</li>
<li>å¯èƒ½å› è¯·æ±‚é¡ºåºé”™ä¹±å¯¼è‡´ UI æ˜¾ç¤ºé”™è¯¯ï¼ˆç«æ€æ¡ä»¶ï¼‰ã€‚</li>
</ul>
<p>äºæ˜¯ï¼Œ<strong>é˜²æŠ–</strong> å’Œ <strong>èŠ‚æµ</strong> åº”è¿è€Œç”Ÿã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€é˜²æŠ–ï¼ˆDebounceï¼‰ï¼šåªæ‰§è¡Œæœ€åä¸€æ¬¡</h3>
<h4 data-id="heading-3">âœ… æ ¸å¿ƒæ€æƒ³</h4>
<blockquote>
<p><strong>â€œåˆ«æ€¥ï¼Œç­‰ç”¨æˆ·å½»åº•åœæ‰‹å†è¯´ï¼â€</strong></p>
</blockquote>
<p>é˜²æŠ–çš„é€»è¾‘éå¸¸ç®€å•ï¼š<strong>åœ¨è¿ç»­è§¦å‘äº‹ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ‰§è¡Œä»»åŠ¡ï¼›åªæœ‰å½“äº‹ä»¶åœæ­¢è§¦å‘è¶…è¿‡æŒ‡å®šæ—¶é—´åï¼Œæ‰æ‰§è¡Œä¸€æ¬¡ã€‚</strong></p>
<h4 data-id="heading-4">ğŸ  ç”Ÿæ´»ç±»æ¯”ï¼šç”µæ¢¯å…³é—¨</h4>
<ul>
<li>ç”µæ¢¯é—¨æ‰“å¼€åï¼Œç­‰å¾… 5 ç§’å†å…³é—­ï¼›</li>
<li>å¦‚æœç¬¬ 3 ç§’æœ‰äººè¿›æ¥ï¼Œå°±<strong>é‡æ–°è®¡æ—¶ 5 ç§’</strong>ï¼›</li>
<li>åªæœ‰è¿ç»­ 5 ç§’æ²¡äººè¿›å…¥ï¼Œé—¨æ‰çœŸæ­£å…³é—­ã€‚</li>
</ul>
<h4 data-id="heading-5">ğŸ’» ä»£ç å®ç°ï¼ˆé—­åŒ… + å®šæ—¶å™¨ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
  <span class="hljs-keyword">let</span> timer; <span class="hljs-comment">// é—­åŒ…å˜é‡ï¼Œä¿å­˜å®šæ—¶å™¨ ID</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timer); <span class="hljs-comment">// æ¸…é™¤ä¸Šä¸€ä¸ªå®šæ—¶å™¨</span>
    timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args); <span class="hljs-comment">// æ‰§è¡ŒåŸå‡½æ•°</span>
    }, delay);
  };
}
</code></pre>
<h5 data-id="heading-6">å…³é”®ç‚¹è§£æï¼š</h5>
<ul>
<li><code>timer</code>Â æ˜¯<strong>è‡ªç”±å˜é‡</strong>ï¼Œè¢«å†…éƒ¨å‡½æ•°é€šè¿‡é—­åŒ…â€œè®°ä½â€ï¼›</li>
<li>æ¯æ¬¡è°ƒç”¨è¿”å›çš„å‡½æ•°ï¼Œéƒ½ä¼šå…ˆÂ <code>clearTimeout</code>ï¼Œå†Â <code>setTimeout</code>ï¼›</li>
<li>ç»“æœï¼š<strong>åªæœ‰æœ€åä¸€æ¬¡è§¦å‘åçš„Â <code>delay</code>Â æ¯«ç§’å†…æ— æ–°è§¦å‘ï¼Œæ‰ä¼šæ‰§è¡Œ</strong>ã€‚</li>
</ul>
<h4 data-id="heading-7">ğŸŒŸ å…¸å‹åº”ç”¨åœºæ™¯</h4>





















<table><thead><tr><th>åœºæ™¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æœç´¢å»ºè®®</strong></td><td>ç”¨æˆ·æ‰“å­—æ—¶ï¼Œç­‰ä»–åœæ‰‹å†å‘è¯·æ±‚ï¼Œé¿å…æ— æ•ˆæœç´¢</td></tr><tr><td><strong>è¡¨å•æ ¡éªŒ</strong></td><td>è¾“å…¥é‚®ç®±/å¯†ç åï¼Œå»¶è¿ŸéªŒè¯ï¼Œå‡å°‘å¹²æ‰°</td></tr><tr><td><strong>çª—å£ resize ä¿å­˜å¸ƒå±€</strong></td><td>ç”¨æˆ·è°ƒæ•´å®Œçª—å£å¤§å°å†ä¿å­˜ï¼Œè€Œéè¿‡ç¨‹ä¸­åå¤ä¿å­˜</td></tr></tbody></table>
<blockquote>
<p>âœ… ä¸€å¥è¯æ€»ç»“ï¼š<strong>é˜²æŠ–é€‚ç”¨äºâ€œæœ‰æ˜ç¡®ç»“æŸç‚¹â€çš„æ“ä½œï¼Œå…³æ³¨æœ€ç»ˆçŠ¶æ€ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€èŠ‚æµï¼ˆThrottleï¼‰ï¼šå›ºå®šé—´éš”æ‰§è¡Œ</h3>
<h4 data-id="heading-9">âœ… æ ¸å¿ƒæ€æƒ³</h4>
<blockquote>
<p><strong>â€œåˆ«æ…Œï¼ŒæŒ‰æˆ‘çš„èŠ‚å¥æ¥ï¼â€</strong></p>
</blockquote>
<p>èŠ‚æµçš„é€»è¾‘æ˜¯ï¼š<strong>æ— è®ºäº‹ä»¶è§¦å‘å¤šé¢‘ç¹ï¼Œæˆ‘ä¿è¯æ¯éš” X æ¯«ç§’æœ€å¤šæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ã€‚</strong></p>
<h4 data-id="heading-10">ğŸ  ç”Ÿæ´»ç±»æ¯”ï¼šFPS æ¸¸æˆå°„é€Ÿ</h4>
<ul>
<li>å³ä½¿ä½ ä¸€ç›´æŒ‰ä½é¼ æ ‡å·¦é”®ï¼Œæªä¹Ÿåªä¼šæŒ‰ç…§è®¾å®šçš„å°„é€Ÿï¼ˆå¦‚æ¯ç§’ 10 å‘ï¼‰å°„å‡»ï¼›</li>
<li>å¤šä½™çš„ç‚¹å‡»ä¼šè¢«å¿½ç•¥ã€‚</li>
</ul>
<h4 data-id="heading-11">ğŸ’» ä»£ç å®ç°ï¼ˆæ—¶é—´æˆ³ç‰ˆï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">function throttle(fn, delay) {
  let <span class="hljs-attr">last</span> = <span class="hljs-number">0</span><span class="hljs-comment">; // ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>
  return function (...args) {
    const <span class="hljs-attr">now</span> = Date.now()<span class="hljs-comment">;</span>
    if (now - last &gt;= delay) {
      fn.apply(this, args)<span class="hljs-comment">;</span>
      <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
}
</code></pre>
<p>ä½†ä½ æä¾›çš„ä»£ç æ›´æ™ºèƒ½â€”â€”å®ƒç»“åˆäº†<strong>å°¾éƒ¨è¡¥å¿</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function throttle(fn, delay) {
  let last, deferTimer<span class="hljs-comment">;</span>
  return function () {
    let <span class="hljs-attr">that</span> = this<span class="hljs-comment">;</span>
    let <span class="hljs-attr">_args</span> = arguments<span class="hljs-comment">;</span>
    let <span class="hljs-attr">now</span> = +new Date()<span class="hljs-comment">;</span>

    if (last &amp;&amp; now &lt; last + delay) {
      // è¿˜åœ¨å†·å´æœŸï¼šæ¸…é™¤æ—§å®šæ—¶å™¨ï¼Œå®‰æ’æ–°å°¾éƒ¨ä»»åŠ¡
      clearTimeout(deferTimer)<span class="hljs-comment">;</span>
      <span class="hljs-attr">deferTimer</span> = setTimeout(() =&gt; {
        <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
        fn.apply(that, _args)<span class="hljs-comment">;</span>
      }, delay)<span class="hljs-comment">;</span>
    } else {
      // å†·å´æœŸç»“æŸï¼šç«‹å³æ‰§è¡Œ
      <span class="hljs-attr">last</span> = now<span class="hljs-comment">;</span>
      fn.apply(that, _args)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
}
</code></pre>
<h5 data-id="heading-12">å·¥ä½œæµç¨‹ï¼š</h5>
<ol>
<li>ç¬¬ä¸€æ¬¡è°ƒç”¨ â†’ ç«‹å³æ‰§è¡Œï¼›</li>
<li>é«˜é¢‘è°ƒç”¨æœŸé—´ â†’ å¿½ç•¥ä¸­é—´æ“ä½œï¼Œä½†<strong>è®°å½•æœ€åä¸€æ¬¡</strong>ï¼›</li>
<li>åœæ­¢è§¦å‘å â†’ åœ¨Â <code>delay</code>Â æ¯«ç§’åæ‰§è¡Œæœ€åä¸€æ¬¡ã€‚</li>
</ol>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šè¿™ç§å®ç°ç¡®ä¿äº†<strong>å°¾éƒ¨æ“ä½œä¸ä¸¢å¤±</strong>ï¼Œé€‚åˆéœ€è¦â€œæ”¶å°¾â€çš„åœºæ™¯ã€‚</p>
</blockquote>
<h4 data-id="heading-13">ğŸŒŸ å…¸å‹åº”ç”¨åœºæ™¯</h4>

























<table><thead><tr><th>åœºæ™¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é¡µé¢æ»šåŠ¨ï¼ˆscrollï¼‰</strong></td><td>æ¯ 200ms è®°å½•ä¸€æ¬¡æ»šåŠ¨ä½ç½®ï¼Œé¿å…å¡é¡¿</td></tr><tr><td><strong>é¼ æ ‡ç§»åŠ¨ï¼ˆmousemoveï¼‰</strong></td><td>æ§åˆ¶åŠ¨ç”»æˆ–ç»˜å›¾é¢‘ç‡</td></tr><tr><td><strong>æŒ‰é’®é˜²è¿ç‚¹</strong></td><td>æäº¤è®¢å•å 1 ç§’å†…ç¦æ­¢å†æ¬¡ç‚¹å‡»</td></tr><tr><td><strong>æ— é™æ»šåŠ¨åŠ è½½</strong></td><td>ç”¨æˆ·æ»šåŠ¨åˆ°åº•éƒ¨æ—¶ï¼Œå®šæœŸæ£€æŸ¥æ˜¯å¦éœ€åŠ è½½æ–°æ•°æ®</td></tr></tbody></table>
<blockquote>
<p>âœ… ä¸€å¥è¯æ€»ç»“ï¼š<strong>èŠ‚æµé€‚ç”¨äºâ€œæŒç»­é«˜é¢‘â€çš„æ“ä½œï¼Œå…³æ³¨è¿‡ç¨‹èŠ‚å¥ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-14">å››ã€é˜²æŠ– vs èŠ‚æµï¼šå…³é”®åŒºåˆ«ä¸€ç›®äº†ç„¶</h3>








































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>é˜²æŠ–ï¼ˆDebounceï¼‰</th><th>èŠ‚æµï¼ˆThrottleï¼‰</th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>åœæ­¢è§¦å‘åå»¶è¿Ÿæ‰§è¡Œ</td><td>å›ºå®šé—´éš”æ‰§è¡Œ</td></tr><tr><td><strong>æ‰§è¡Œæ¬¡æ•°</strong></td><td>N æ¬¡è§¦å‘ â†’ 1 æ¬¡æ‰§è¡Œ</td><td>N æ¬¡è§¦å‘ â†’ â‰ˆ N/delay æ¬¡æ‰§è¡Œ</td></tr><tr><td><strong>æ˜¯å¦ä¿ç•™å°¾éƒ¨</strong></td><td>æ˜¯ï¼ˆå¤©ç„¶ä¿ç•™ï¼‰</td><td>åŸºç¡€ç‰ˆå¦ï¼Œå¢å¼ºç‰ˆå¯ä¿ç•™</td></tr><tr><td><strong>æ ¸å¿ƒæœºåˆ¶</strong></td><td><code>clearTimeout + setTimeout</code></td><td>æ—¶é—´æˆ³åˆ¤æ–­ æˆ–Â <code>setTimeout</code>Â æ§åˆ¶</td></tr><tr><td><strong>é€‚ç”¨äº‹ä»¶</strong></td><td><code>input</code>,Â <code>keyup</code></td><td><code>scroll</code>,Â <code>resize</code>,Â <code>mousemove</code></td></tr><tr><td><strong>ç”¨æˆ·æ„ŸçŸ¥</strong></td><td>â€œæ‰“å®Œå­—æ‰å“åº”â€</td><td>â€œæ»šåŠ¨æ—¶å®šæœŸå“åº”â€</td></tr></tbody></table>
<blockquote>
<p>ğŸ”¥ è®°ä½è¿™ä¸ªå£è¯€ï¼š<br/>
<strong>â€œé˜²æŠ–ç­‰åœæ‰‹ï¼ŒèŠ‚æµæ§èŠ‚å¥ã€‚â€</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-15">äº”ã€é—­åŒ…ï¼šé˜²æŠ–ä¸èŠ‚æµçš„â€œå¹•åè‹±é›„â€</h3>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œæ— è®ºæ˜¯ <code>debounce</code> è¿˜æ˜¯ <code>throttle</code>ï¼Œéƒ½ç”¨åˆ°äº† <strong>é—­åŒ…</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
  <span class="hljs-keyword">let</span> timer; <span class="hljs-comment">// â† è¿™ä¸ªå˜é‡è¢«å†…éƒ¨å‡½æ•°â€œè®°ä½â€</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">clearTimeout</span>(timer); <span class="hljs-comment">// â† èƒ½è®¿é—®å¤–éƒ¨çš„ timer</span>
    <span class="hljs-comment">// ...</span>
  };
}
</code></pre>
<h4 data-id="heading-16">ä¸ºä»€ä¹ˆå¿…é¡»ç”¨é—­åŒ…ï¼Ÿ</h4>
<ul>
<li><code>timer</code>ã€<code>last</code>Â ç­‰çŠ¶æ€éœ€è¦åœ¨<strong>å¤šæ¬¡å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒ</strong>ï¼›</li>
<li>æ™®é€šå±€éƒ¨å˜é‡åœ¨å‡½æ•°æ‰§è¡Œå®Œå°±é”€æ¯ï¼›</li>
<li>è€Œé—­åŒ…è®©å†…éƒ¨å‡½æ•°<strong>æŒç»­æŒæœ‰å¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨</strong>ï¼Œå½¢æˆâ€œç§æœ‰è®°å¿†â€ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ é—­åŒ… = å‡½æ•° + å…¶è¯æ³•ç¯å¢ƒã€‚å®ƒæ˜¯å®ç°çŠ¶æ€ç®¡ç†çš„åŸºçŸ³ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-17">å…­ã€å®æˆ˜å»ºè®®ï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ</h3>





























<table><thead><tr><th>ä½ çš„éœ€æ±‚</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>ç”¨æˆ·è¾“å…¥æœç´¢è¯</td><td>âœ… é˜²æŠ–ï¼ˆ500msï¼‰</td></tr><tr><td>ç›‘å¬çª—å£ resize</td><td>âœ… èŠ‚æµï¼ˆ200msï¼‰</td></tr><tr><td>æ»šåŠ¨åŠ è½½æ›´å¤š</td><td>âœ… èŠ‚æµï¼ˆ300msï¼‰</td></tr><tr><td>è¡¨å•è‡ªåŠ¨ä¿å­˜è‰ç¨¿</td><td>âœ… é˜²æŠ–ï¼ˆ1000msï¼‰</td></tr><tr><td>é¼ æ ‡æ‹–æ‹½å…ƒç´ </td><td>âœ… èŠ‚æµï¼ˆ16ms â‰ˆ 60fpsï¼‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ å°æŠ€å·§ï¼š</p>
<ul>
<li>é˜²æŠ–å»¶è¿Ÿé€šå¸¸Â <strong>300~500ms</strong>ï¼ˆå¹³è¡¡å“åº”ä¸æ€§èƒ½ï¼‰ï¼›</li>
<li>èŠ‚æµé—´éš”é€šå¸¸Â <strong>100~300ms</strong>ï¼ˆæ ¹æ®åœºæ™¯è°ƒæ•´ï¼‰ã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-18">ä¸ƒã€ç»“è¯­ï¼šä¼˜é›…åœ°æ§åˆ¶é¢‘ç‡ï¼Œæ˜¯ä¸“ä¸šå‰ç«¯çš„æ ‡å¿—</h3>
<p>é˜²æŠ–ä¸èŠ‚æµï¼Œçœ‹ä¼¼åªæ˜¯å‡ è¡Œä»£ç ï¼Œå´ä½“ç°äº†<strong>å¯¹ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿæ€§èƒ½çš„æ·±åˆ»ç†è§£</strong>ã€‚å®ƒä»¬ä¸æ˜¯ç‚«æŠ€ï¼Œè€Œæ˜¯å·¥ç¨‹å®è·µä¸­ä¸å¯æˆ–ç¼ºçš„â€œå®‰å…¨é˜€â€ã€‚</p>
<p>ä¸‹æ¬¡å½“ä½ é¢å¯¹é«˜é¢‘äº‹ä»¶æ—¶ï¼Œä¸å¦¨é—®é—®è‡ªå·±ï¼š</p>
<ul>
<li>æˆ‘éœ€è¦çš„æ˜¯<strong>æœ€ç»ˆç»“æœ</strong>ï¼Œè¿˜æ˜¯<strong>è¿‡ç¨‹é‡‡æ ·</strong>ï¼Ÿ</li>
<li>ç”¨æˆ·æ˜¯å¦å¸Œæœ›<strong>ç«‹åˆ»å“åº”</strong>ï¼Œè¿˜æ˜¯å¯ä»¥<strong>ç¨ç­‰ç‰‡åˆ»</strong>ï¼Ÿ</li>
</ul>
<p>ç­”æ¡ˆå°†æŒ‡å¼•ä½ é€‰æ‹©é˜²æŠ–æˆ–èŠ‚æµã€‚æŒæ¡è¿™â€œåŒå­æ˜Ÿâ€ï¼Œä½ çš„ä»£ç å°†ä¸å†â€œé¢¤æŠ–â€ï¼Œè€Œæ˜¯å¦‚ä¸èˆ¬é¡ºæ»‘â€”â€”è¿™æ‰æ˜¯çœŸæ­£çš„å‰ç«¯è‰ºæœ¯ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3 KeepAlive æ ¸å¿ƒåŸç†å’Œæ¸²æŸ“æ›´æ–°æµç¨‹]]></title>    <link>https://juejin.cn/post/7589445154534408244</link>    <guid>https://juejin.cn/post/7589445154534408244</guid>    <pubDate>2025-12-30T09:45:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589445154534408244" data-draft-id="7589475497000861711" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3 KeepAlive æ ¸å¿ƒåŸç†å’Œæ¸²æŸ“æ›´æ–°æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-30T09:45:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ·‹ç€141"/> <meta itemprop="url" content="https://juejin.cn/user/457013611467416"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3 KeepAlive æ ¸å¿ƒåŸç†å’Œæ¸²æŸ“æ›´æ–°æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/457013611467416/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ·‹ç€141
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:45:43.000Z" title="Tue Dec 30 2025 09:45:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">vue3 KeepAlive æ ¸å¿ƒåŸç†å’Œæ¸²æŸ“æ›´æ–°æµç¨‹</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2Fguide%2Fbuilt-ins%2Fkeep-alive" target="_blank" title="https://cn.vuejs.org/guide/built-ins/keep-alive" ref="nofollow noopener noreferrer">KeepAlive</a> æ˜¯ Vue 3 çš„å†…ç½®ç»„ä»¶ï¼Œç”¨äºç¼“å­˜åŠ¨æ€ç»„ä»¶ï¼Œé¿å…é‡å¤åˆ›å»ºå’Œé”€æ¯ç»„ä»¶å®ä¾‹ã€‚
å½“ç»„ä»¶è¢«åˆ‡æ¢æ—¶ï¼ŒKeepAlive ä¼šå°†ç»„ä»¶å®ä¾‹å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯å®Œå…¨é”€æ¯å®ƒï¼Œä»è€Œä¿ç•™ç»„ä»¶çŠ¶æ€å¹¶æå‡æ€§èƒ½ã€‚</p>
<h3 data-id="heading-1">1. æŒ‚è½½</h3>
<p>å°†å­ç»„ä»¶vnodeè¿›è¡Œç¼“å­˜ï¼Œå¹¶ä¸”è®¾ç½®<code>vnode.shapeFlag |= ShapeFlags.COMPONENT_SHOULD_KEEP_ALIVE</code>,ä¾›è¿è¡Œæ—¶åœ¨å¸è½½æ—¶ç‰¹æ®Šå¤„ç†</p>
<h3 data-id="heading-2">2. åœç”¨ <code>deactivate</code></h3>
<p>å½“ç»„ä»¶éœ€è¦éšè—æ—¶, æ ¹æ®<code>COMPONENT_SHOULD_KEEP_ALIVE å’Œ renderer</code>çš„é€»è¾‘</p>
<ol>
<li>å°†ç»„ä»¶ç§»åŠ¨åˆ° <code>storageContainer</code>ï¼ˆä¸€ä¸ªä¸å¯è§çš„ DOM å®¹å™¨ï¼‰</li>
<li>è§¦å‘ç»„ä»¶çš„ <code>deactivated</code> ç”Ÿå‘½å‘¨æœŸé’©å­</li>
<li>ç»„ä»¶å®ä¾‹å’ŒçŠ¶æ€å¾—ä»¥ä¿ç•™</li>
</ol>
<h3 data-id="heading-3">3. æ¿€æ´» <code>activate</code></h3>
<p>å½“ç»„ä»¶å†æ¬¡æ¿€æ´»æ—¶, æ ¹æ®<code>COMPONENT_KEPT_ALIVE å’Œ renderer</code>çš„é€»è¾‘</p>
<ol>
<li><code>æ–°çš„ vnode.el ä½¿ç”¨ cachedVNode.el</code></li>
<li><code>æ–°çš„ vnode.component ä½¿ç”¨ cachedVNode.component</code>ï¼Œè¿™ä¸ªæ˜¯å·²ç»æŒ‚è½½çš„ ç»„ä»¶äº†ï¼Œé‡Œé¢çš„subTreeéƒ½æ˜¯æœ‰elçš„</li>
<li>å°† vnode ç§»å›ç›®æ ‡å®¹å™¨</li>
<li>æ‰§è¡Œ patch æ›´æ–°ï¼ˆå¤„ç† props å˜åŒ–ï¼‰</li>
<li>è§¦å‘ç»„ä»¶çš„ <code>activated</code> ç”Ÿå‘½å‘¨æœŸé’©å­</li>
</ol>
<h3 data-id="heading-4">4. ç›¸å…³æºç ï¼ˆåªä¿ç•™å…³äºKeepAliveç›¸å…³çš„æ ¸å¿ƒé€»è¾‘ï¼‰</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-title class_">KeepAliveImpl</span>: <span class="hljs-title class_">ComponentOptions</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">`KeepAlive`</span>,
  <span class="hljs-attr">__isKeepAlive</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-title function_">setup</span>(<span class="hljs-params">_, { slots }: SetupContext</span>) {
    <span class="hljs-keyword">const</span> instance = <span class="hljs-title function_">getCurrentInstance</span>()!
    <span class="hljs-keyword">const</span> sharedContext = instance.<span class="hljs-property">ctx</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">KeepAliveContext</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">cache</span>: <span class="hljs-title class_">Cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
    <span class="hljs-keyword">const</span> <span class="hljs-attr">keys</span>: <span class="hljs-title class_">Keys</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()

    <span class="hljs-keyword">const</span> {
      <span class="hljs-attr">renderer</span>: {
        <span class="hljs-attr">p</span>: patch,
        <span class="hljs-attr">m</span>: move,
        <span class="hljs-attr">um</span>: _unmount,
        <span class="hljs-attr">o</span>: { createElement },
      },
    } = sharedContext
    <span class="hljs-keyword">const</span> storageContainer = <span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)

    <span class="hljs-comment">// vnode ç¼“å­˜çš„å­ç»„ä»¶, ç»“åˆruntime patch</span>
    sharedContext.<span class="hljs-property">activate</span> = <span class="hljs-function">(<span class="hljs-params">
      vnode,
      container,
      anchor,
      <span class="hljs-keyword">namespace</span>,
      optimized
    </span>) =&gt;</span> {
      <span class="hljs-comment">// instance æ˜¯å­ç»„ä»¶å®ä¾‹</span>
      <span class="hljs-keyword">const</span> instance = vnode.<span class="hljs-property">component</span>!
      <span class="hljs-comment">// ç§»å›æ¥</span>
      <span class="hljs-title function_">move</span>(vnode, container, anchor, <span class="hljs-title class_">MoveType</span>.<span class="hljs-property">ENTER</span>, parentSuspense)
      <span class="hljs-comment">// in case props have changed</span>
      <span class="hljs-title function_">patch</span>(instance.<span class="hljs-property">vnode</span>, vnode, container, anchor, instance,...)
      <span class="hljs-title function_">queuePostRenderEffect</span>(<span class="hljs-function">() =&gt;</span> {
        instance.<span class="hljs-property">isDeactivated</span> = <span class="hljs-literal">false</span>
        <span class="hljs-keyword">if</span> (instance.<span class="hljs-property">a</span>) {
          <span class="hljs-title function_">invokeArrayFns</span>(instance.<span class="hljs-property">a</span>)
        }
      }, parentSuspense)
    }

    <span class="hljs-comment">// vnode ç¼“å­˜çš„å­ç»„ä»¶ï¼Œé‡Œé¢çš„ç¼“å­˜çš„ç»„ä»¶é™¤äº†è¿™ä¸¤ä¸ªé’©å­ï¼Œå…¶ä»–éƒ½æ˜¯å¸¸è§„æµç¨‹</span>
    sharedContext.<span class="hljs-property">deactivate</span> = <span class="hljs-function">(<span class="hljs-params">vnode: VNode</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> instance = vnode.<span class="hljs-property">component</span>!
      <span class="hljs-comment">// ç§»åˆ°ç¼“å­˜å®¹å™¨</span>
      <span class="hljs-title function_">move</span>(vnode, storageContainer, <span class="hljs-literal">null</span>, <span class="hljs-title class_">MoveType</span>.<span class="hljs-property">LEAVE</span>, parentSuspense)
      <span class="hljs-title function_">queuePostRenderEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">if</span> (instance.<span class="hljs-property">da</span>) {
          <span class="hljs-title function_">invokeArrayFns</span>(instance.<span class="hljs-property">da</span>)
        }
      }, parentSuspense)
    }

    <span class="hljs-comment">// å½“ç¼“å­˜å¤±æ•ˆï¼Œå°±éœ€è¦çœŸæ­£çš„å¸è½½</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">unmount</span>(<span class="hljs-params">vnode: VNode</span>) {
      <span class="hljs-comment">// reset the shapeFlag so it can be properly unmounted</span>
      <span class="hljs-title function_">resetShapeFlag</span>(vnode)
      <span class="hljs-title function_">_unmount</span>(vnode, instance, parentSuspense, <span class="hljs-literal">true</span>)
    }

    <span class="hljs-keyword">let</span> <span class="hljs-attr">pendingCacheKey</span>: <span class="hljs-title class_">CacheKey</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">cacheSubtree</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-comment">// fix #1621, the pendingCacheKey could be 0</span>
      <span class="hljs-keyword">if</span> (pendingCacheKey != <span class="hljs-literal">null</span>) {
        cache.<span class="hljs-title function_">set</span>(pendingCacheKey, <span class="hljs-title function_">getInnerChild</span>(instance.<span class="hljs-property">subTree</span>))
      }
    }
    <span class="hljs-title function_">onMounted</span>(cacheSubtree)
    <span class="hljs-title function_">onUpdated</span>(cacheSubtree)

    <span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
      cache.<span class="hljs-title function_">forEach</span>(unmount)
    })

    <span class="hljs-comment">// æ¸²æŸ“å‡½æ•°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      pendingCacheKey = <span class="hljs-literal">null</span>

      <span class="hljs-keyword">const</span> children = slots.<span class="hljs-title function_">default</span>()
      <span class="hljs-keyword">const</span> rawVNode = children[<span class="hljs-number">0</span>]
      <span class="hljs-keyword">const</span> vnode = children[<span class="hljs-number">0</span>]
      <span class="hljs-comment">// è¿™é‡Œçš„vnode å°±æ˜¯æŒ‡ ç¼“å­˜çš„ç»„ä»¶</span>
      <span class="hljs-comment">// warn(`KeepAlive should contain exactly one component child.`)</span>

      <span class="hljs-keyword">const</span> comp = vnode.<span class="hljs-property">type</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">ConcreteComponent</span>

      <span class="hljs-keyword">const</span> name = <span class="hljs-title function_">getComponentName</span>(comp)

      <span class="hljs-keyword">const</span> { include, exclude, max } = props

      <span class="hljs-keyword">if</span> (
        (include &amp;&amp; (!name || !<span class="hljs-title function_">matches</span>(include, name))) ||
        (exclude &amp;&amp; name &amp;&amp; <span class="hljs-title function_">matches</span>(exclude, name))
      ) {
        <span class="hljs-comment">// #11717 // æˆ‘å†™çš„pr!!!!</span>
        vnode.<span class="hljs-property">shapeFlag</span> &amp;= ~<span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT_SHOULD_KEEP_ALIVE</span>
        <span class="hljs-keyword">return</span> rawVNode
      }

      <span class="hljs-keyword">const</span> key = vnode.<span class="hljs-property">key</span> == <span class="hljs-literal">null</span> ? comp : vnode.<span class="hljs-property">key</span>
      <span class="hljs-keyword">const</span> cachedVNode = cache.<span class="hljs-title function_">get</span>(key)

      pendingCacheKey = key

      <span class="hljs-keyword">if</span> (cachedVNode) {
        <span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜çš„elï¼Œç¼“å­˜çš„component treeï¼Œæ‰€ä»¥å°±ä¸ç”¨èµ°mount</span>
        <span class="hljs-comment">// copy over mounted state</span>
        vnode.<span class="hljs-property">el</span> = cachedVNode.<span class="hljs-property">el</span>
        vnode.<span class="hljs-property">component</span> = cachedVNode.<span class="hljs-property">component</span>
        <span class="hljs-comment">// ç»“åˆruntime patch æµç¨‹ å½“æ¿€æ´»æ—¶å°±ä¸èµ°mount</span>
        vnode.<span class="hljs-property">shapeFlag</span> |= <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT_KEPT_ALIVE</span>
      } <span class="hljs-keyword">else</span> {
        keys.<span class="hljs-title function_">add</span>(key)
      }
      <span class="hljs-comment">// avoid vnode being unmounted</span>
      <span class="hljs-comment">// ç»“åˆruntime patch æµç¨‹ å½“å¸è½½æ—¶å°±ä¸èµ°unmount</span>
      vnode.<span class="hljs-property">shapeFlag</span> |= <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT_SHOULD_KEEP_ALIVE</span>

      <span class="hljs-keyword">return</span> vnode
    }
  },
}
</code></pre>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// renderer ä¸­å…³äº KeepAliveçš„é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">baseCreateRenderer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">processComponent</span> = (<span class="hljs-params">
    n1: VNode | <span class="hljs-literal">null</span>,
    n2: VNode,
    container: RendererElement,
    anchor: RendererNode | <span class="hljs-literal">null</span>,
    parentComponent: ComponentInternalInstance | <span class="hljs-literal">null</span>
  </span>) =&gt; {
    <span class="hljs-comment">// parentComponent å°±æ˜¯ keepalive</span>
    <span class="hljs-keyword">if</span> (n1 == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (n2.<span class="hljs-property">shapeFlag</span> &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT_KEPT_ALIVE</span>) {
        ;(parentComponent!.<span class="hljs-property">ctx</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">KeepAliveContext</span>).<span class="hljs-title function_">activate</span>(
          n2,
          container,
          anchor,
          <span class="hljs-keyword">namespace</span>,
          optimized
        )
      } else {
        <span class="hljs-comment">// æ­£å¸¸mount mountComponent</span>
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ­£å¸¸æ›´æ–° updateComponent</span>
    }
  }

  <span class="hljs-keyword">const</span> <span class="hljs-attr">mountComponent</span>: <span class="hljs-title class_">MountComponentFn</span> = <span class="hljs-function">(<span class="hljs-params">initialVNode</span>) =&gt;</span> {
    <span class="hljs-comment">// initialVNode æ˜¯keepaliveçš„vnodeæ—¶ï¼ŒæŠŠå¯¹åº”çš„renderä¼ å…¥è¿›å»ï¼Œè¿™é€»è¾‘å…¶å®ä¸é‡è¦ï¼Œåªæ˜¯ä¸ºäº†å°è£…å¤ç”¨</span>
    <span class="hljs-comment">// inject renderer internals for keepAlive</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isKeepAlive</span>(initialVNode)) {
      ;(instance.<span class="hljs-property">ctx</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">KeepAliveContext</span>).<span class="hljs-property">renderer</span> = internals
    }
  }

  <span class="hljs-keyword">const</span> <span class="hljs-attr">unmount</span>: <span class="hljs-title class_">UnmountFn</span> = <span class="hljs-function">(<span class="hljs-params">vnode, parentComponent</span>) =&gt;</span> {
    <span class="hljs-comment">// parentComponent å°±æ˜¯ keepalive</span>
    <span class="hljs-keyword">const</span> { shapeFlag } = vnode
    <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT_SHOULD_KEEP_ALIVE</span>) {
      ;(parentComponent!.<span class="hljs-property">ctx</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">KeepAliveContext</span>).<span class="hljs-title function_">deactivate</span>(vnode)
      <span class="hljs-keyword">return</span>
    }
  }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æŠŠæ‰‹å°è£…Iframeçˆ¶å­å•å‘åŒå‘é€šè®¯åŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7589466356779597876</link>    <guid>https://juejin.cn/post/7589466356779597876</guid>    <pubDate>2025-12-30T10:01:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589466356779597876" data-draft-id="7589462007528407074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æŠŠæ‰‹å°è£…Iframeçˆ¶å­å•å‘åŒå‘é€šè®¯åŠŸèƒ½"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-30T10:01:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="redæ¶¦"/> <meta itemprop="url" content="https://juejin.cn/user/372051848729127"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æŠŠæ‰‹å°è£…Iframeçˆ¶å­å•å‘åŒå‘é€šè®¯åŠŸèƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/372051848729127/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    redæ¶¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T10:01:52.000Z" title="Tue Dec 30 2025 10:01:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰‹æŠŠæ‰‹å°è£…Iframeçˆ¶å­å•å‘åŒå‘é€šè®¯åŠŸèƒ½</h2>
<h3 data-id="heading-1">å¯¼è¨€</h3>
<blockquote>
<p>æœ€è¿‘åœ¨ç ”ç©¶<strong>å¤šç³»ç»Ÿ</strong>é›†æˆåˆ°ä¸€ä¸ª<strong>ä¸»ç³»ç»Ÿ</strong>ä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“â€œå¾®å‰ç«¯â€ï¼Œåœ¨ç ”ç©¶äº†ç”¨å¾®å‰ç«¯æ¡†æ¶ <strong>micro-app</strong>å’Œ<strong>qiankun</strong>æ¥æ­å»ºæµ‹è¯•é¡¹ç›®ï¼Œå‘ç°ä¼¼ä¹æœ‰ä¸€ç‚¹éº»çƒ¦ã€‚</p>
<p>å› ä¸ºæˆ‘çš„é¡¹ç›®ä¸éœ€è¦å¤æ‚çš„è·¯ç”±è·³è½¬ï¼Œåªæœ‰ç®€å•çš„æ•°æ®é€šè®¯ï¼Œä¼¼ä¹ç”¨<strong>Iframe</strong>æ›´åŠ ç¬¦åˆæˆ‘å½“å‰çš„ä¸šåŠ¡åœºæ™¯ã€‚</p>
</blockquote>
<h3 data-id="heading-2">ä¸šåŠ¡åœºæ™¯åˆ†æ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5305370300f4c6694889c65e831aa8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVk5ram:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767693712&amp;x-signature=WQCqwP8JuaqfnRHxZvwx4z1bewY%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>å¦‚ä¸Šå›¾ï¼Œæˆ‘å°†ä¸šåŠ¡åœºæ™¯ä½¿ç”¨æœ€å°demoå±•ç¤ºå‡ºæ¥</p>
<p>æˆ‘ä»¬ä½¿ç”¨vue3+hookå°è£…å·¥å…·å‡½æ•°</p>
</blockquote>
<h4 data-id="heading-3">ç›®å‰å®ç°çš„åŠŸèƒ½</h4>
<blockquote>
<p>æˆ‘éœ€è¦çˆ¶å­é¡µé¢èƒ½å¤Ÿ<strong>å•å‘</strong>å’Œ<strong>åŒå‘</strong>çš„äº’ç›¸é€šè®¯</p>
<p>ä¸‹é¢æ˜¯å®ç°çš„ä»£ç ç‰‡æ®µåŠŸèƒ½</p>
</blockquote>
<h5 data-id="heading-4">å•å‘æ•°æ®ä¼ è¾“</h5>
<ol start="0">
<li>
<p>çˆ¶çº§å‘å­çº§ä¸»åŠ¨å‘é€æ•°æ®ï¼Œå­çº§æ¥æ”¶çˆ¶çº§å‘æ¥çš„æ•°æ®ã€‚</p>
<ul>
<li>
<pre><code class="hljs language-php" lang="php">  <span class="hljs-comment">// çˆ¶çº§å‘å­çº§ä¸»åŠ¨å‘é€æ•°æ®</span>
  <span class="hljs-title function_ invoke__">send</span>(<span class="hljs-string">'parent_message'</span>, {
   Â  <span class="hljs-attr">Â action</span>: <span class="hljs-string">'update'</span>,
   Â  <span class="hljs-attr">Â value</span>: <span class="hljs-string">'Hello from parent'</span>
  });
</code></pre>
</li>
<li>
<pre><code class="hljs language-ini" lang="ini">  // å­çº§æ¥æ”¶çˆ¶çº§å‘æ¥çš„æ•°æ®
  on('parent_message', <span class="hljs-attr">data</span> =&gt; {
   Â  Â <span class="hljs-attr">parentData.value</span> = data<span class="hljs-comment">;</span>
   Â  Â console.log('æ”¶åˆ°çˆ¶åº”ç”¨æ¶ˆæ¯', data)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
  // æ”¶åˆ°çˆ¶åº”ç”¨æ¶ˆæ¯ {action: 'update', value: 'Hello from parent'}
</code></pre>
</li>
</ul>
</li>
<li>
<p>å­çº§å‘çˆ¶çº§ä¸»é€å‘é€æ•°æ®ï¼Œçˆ¶çº§æ¥æ”¶å­çº§å‘æ¥çš„æ•°æ®ã€‚</p>
<ul>
<li>
<pre><code class="hljs language-php" lang="php">  <span class="hljs-comment">// å­çº§å‘çˆ¶çº§ä¸»é€å‘é€æ•°æ®</span>
  <span class="hljs-title function_ invoke__">send</span>(<span class="hljs-string">'child_message'</span>, {
   Â  <span class="hljs-attr">Â message</span>: <span class="hljs-string">'Hello from child'</span>,
   Â  <span class="hljs-attr">Â time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_ invoke__">toISOString</span>()
  });
</code></pre>
  
<pre><code class="hljs language-ini" lang="ini">  // çˆ¶çº§æ¥æ”¶å­çº§å‘æ¥çš„æ•°æ®ã€‚
  on('child_message', <span class="hljs-attr">data</span> =&gt; {
   Â <span class="hljs-attr">receivedData.value</span> = data<span class="hljs-comment">;</span>
   Â console.log('æ”¶åˆ°å­åº”ç”¨æ¶ˆæ¯', data)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
  // æ”¶åˆ°å­åº”ç”¨æ¶ˆæ¯ {message: 'Hello from child', time: '2025-12-30T08:23:38.850Z'}
</code></pre>
</li>
</ul>
</li>
</ol>
<h5 data-id="heading-5">åŒå‘æ•°æ®ä¼ è¾“</h5>
<ol start="0">
<li>
<p>çˆ¶çº§å‘å­çº§å‘èµ·æ•°æ®è·å–è¯·æ±‚å¹¶ç­‰å¾…ï¼Œå­çº§æ”¶åˆ°è¯·æ±‚å¹¶å“åº”</p>
<ul>
<li>
<pre><code class="hljs language-javascript" lang="javascript">  <span class="hljs-comment">// çˆ¶çº§å‘å­çº§å‘èµ·æ•°æ®è·å–è¯·æ±‚å¹¶ç­‰å¾…</span>
  <span class="hljs-keyword">try</span> {
   Â  Â <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendWithResponse</span>(<span class="hljs-string">'get_data'</span>, {
   Â  Â  Â  Â <span class="hljs-attr">query</span>: <span class="hljs-string">'some data'</span><span class="hljs-comment">// å‘ç»™å­çº§çš„æ•°æ®</span>
   Â   });
   Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å­çº§å“åº”æ•°æ®'</span>, response);
  } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>, error);
  }
  <span class="hljs-comment">// æ”¶åˆ°å­çº§å“åº”æ•°æ® {result: 'data from child', query: 'some data', _responseType: 'get_data_response_1767082999194'}</span>
</code></pre>
</li>
<li>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-comment">// å­çº§æ”¶åˆ°è¯·æ±‚å¹¶å“åº”</span>
  handleRequest(<span class="hljs-string">'get_data'</span>, async <span class="hljs-keyword">data</span> =&gt; {
   Â  Â <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
   Â  Â <span class="hljs-keyword">return</span> {
   Â  Â  Â  Â result: <span class="hljs-string">'data from child'</span>,
   Â  Â  Â  Â ...<span class="hljs-keyword">data</span>
   Â   };
  });
</code></pre>
</li>
</ul>
</li>
<li>
<p>å­çº§å‘çˆ¶çº§å‘èµ·æ•°æ®è·å–è¯·æ±‚å¹¶ç­‰å¾…ï¼Œçˆ¶çº§æ”¶åˆ°è¯·æ±‚å¹¶å“åº”</p>
<ul>
<li>
<pre><code class="hljs language-javascript" lang="javascript">  <span class="hljs-comment">// å­çº§å‘çˆ¶çº§å‘èµ·æ•°æ®è·å–è¯·æ±‚å¹¶ç­‰å¾…</span>
    <span class="hljs-keyword">try</span> {
   Â   <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendWithResponse</span>(<span class="hljs-string">'get_data'</span>, {
   Â  Â   <span class="hljs-attr">query</span>: <span class="hljs-string">'some data'</span>
   Â   });
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å“åº”æ•°æ®'</span>, response);
    } <span class="hljs-keyword">catch</span> (error) {
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>, error);
    }
    æ”¶åˆ°å“åº”æ•°æ® {<span class="hljs-attr">result</span>: <span class="hljs-string">'data from parent'</span>, <span class="hljs-attr">query</span>: <span class="hljs-string">'some data'</span>, <span class="hljs-attr">_responseType</span>: <span class="hljs-string">'get_data_response_1767083018851'</span>}
</code></pre>
</li>
<li>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-comment">// çˆ¶çº§æ”¶åˆ°è¯·æ±‚å¹¶å“åº”</span>
    handleRequest(<span class="hljs-string">'get_data'</span>, async <span class="hljs-keyword">data</span> =&gt; {
   Â   <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
   Â   <span class="hljs-keyword">return</span> {
   Â  Â   result: <span class="hljs-string">'data from parent'</span>,
   Â  Â   ...<span class="hljs-keyword">data</span>
   Â   };
    });
</code></pre>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">Iframeé€šè®¯åŸç†è§£æ</h3>
<h4 data-id="heading-7">åˆ¤æ–­æ˜¯å¦åœ¨iframeåµŒå¥—ä¸­</h4>
<blockquote>
<p>è¿™æ˜¯æœ€ç®€å•ä¸”å¸¸ç”¨çš„æ–¹æ³•ã€‚</p>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// window.self è¡¨ç¤ºå½“å‰çª—å£å¯¹è±¡ï¼Œè€Œ window.top è¡¨ç¤ºæœ€é¡¶å±‚çª—å£å¯¹è±¡ã€‚</span>
<span class="hljs-comment">// å¦‚æœä¸¤è€…ä¸ç›¸ç­‰ï¼Œåˆ™è¯´æ˜å½“å‰é¡µé¢è¢«åµŒå¥—åœ¨ iframe ä¸­ã€‚</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">self</span> !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">top</span>) {
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å½“å‰é¡µé¢è¢«åµŒå¥—åœ¨ iframe ä¸­"</span>);
} <span class="hljs-keyword">else</span> {
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å½“å‰é¡µé¢æœªè¢«åµŒå¥—"</span>);
}
</code></pre>
<h4 data-id="heading-8">æ ¸å¿ƒå‘é€æ¶ˆæ¯é€»è¾‘</h4>
<blockquote>
<p>å¸¸ä½¿ç”¨<strong>postMessage</strong>æ¥è¿›è¡Œæ¶ˆæ¯å‘é€</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini">otherWindow.postMessage(message, targetOrigin, <span class="hljs-section">[transfer]</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>
<p>otherWindow</p>
<ul>
<li>å…¶ä»–çª—å£çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ¯”å¦‚ iframe çš„ contentWindow å±æ€§ã€‚</li>
</ul>
</li>
<li>
<p>message</p>
<ul>
<li>å°†è¦å‘é€åˆ°å…¶ä»– window çš„æ•°æ®ã€‚å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡ç±»å‹ã€‚</li>
</ul>
</li>
<li>
<p>targetOrigin</p>
<ul>
<li>é€šè¿‡çª—å£çš„ origin å±æ€§æ¥æŒ‡å®šå“ªäº›çª—å£èƒ½<strong>æ¥æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶</strong>ï¼Œå…¶å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²"*"ï¼ˆè¡¨ç¤ºæ— é™åˆ¶ï¼‰æˆ–è€…ä¸€ä¸ª URIã€‚</li>
</ul>
</li>
<li>
<p>transferï¼ˆä¸€èˆ¬ä¸ä¼ ï¼‰</p>
<ul>
<li>æ˜¯ä¸€ä¸²å’Œ message åŒæ—¶ä¼ é€’çš„ <code>Transferable</code> å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡çš„æ‰€æœ‰æƒå°†è¢«è½¬ç§»ç»™æ¶ˆæ¯çš„æ¥æ”¶æ–¹ï¼Œè€Œå‘é€ä¸€æ–¹å°†ä¸å†ä¿æœ‰æ‰€æœ‰æƒã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-9">æ ¸å¿ƒæ¥æ”¶æ¶ˆæ¯é€»è¾‘</h4>
<blockquote>
<p>çˆ¶å­å…ƒç´ é€šè¿‡ ç›‘å¬ messageäº‹ä»¶æ¥è·å–æ¥æ”¶åˆ°çš„æ•°æ®ã€‚æˆ‘ä»¬å°†æ ¹æ®è¿™ä¸ªå‡½æ•°æ¥å°è£…è‡ªå·±çš„å·¥å…·å‡½æ•°</p>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
 Â   <span class="hljs-comment">// é€šè¿‡originå¯¹æ¶ˆæ¯è¿›è¡Œè¿‡æ»¤ï¼Œé¿å…é­åˆ°XSSæ”»å‡»</span>
 Â   <span class="hljs-keyword">if</span> (e.<span class="hljs-property">origin</span> === <span class="hljs-string">'http://xxxx.com'</span>) {
 Â  Â  Â   <span class="hljs-comment">// åˆ¤æ–­æ¥æºæ˜¯å¦å’Œè¦é€šè®¯çš„åœ°å€æ¥æºä¸€è‡´</span>
 Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">data</span>)  <span class="hljs-comment">// å­é¡µé¢å‘é€çš„æ¶ˆæ¯, hello, parent!</span>
 Â   }
}, <span class="hljs-literal">false</span>);
</code></pre>
<h3 data-id="heading-10">é¡¹ç›®æ­å»º</h3>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ utils/
â”‚ Â  â”œâ”€â”€ iframe-comm.js Â  Â  Â   <span class="hljs-comment"># çˆ¶åº”ç”¨é€šä¿¡ç±»</span>
â”‚ Â  â””â”€â”€ iframe-comm-child.js  <span class="hljs-comment"># å­åº”ç”¨é€šä¿¡ç±»</span>
â”œâ”€â”€ composables/
â”‚ Â  â””â”€â”€ useIframeComm.js Â  Â   <span class="hljs-comment"># Vue3 ç»„åˆå¼å‡½æ•°</span>
â”œâ”€â”€ App.vue Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># çˆ¶åº”ç”¨ä¸»ç»„ä»¶</span>
â””â”€â”€ main.js
</code></pre>
<h4 data-id="heading-11">ä½¿ç”¨<strong>vite</strong>åˆ›å»ºä¸¤ä¸ª<strong>vue3</strong>é¡¹ç›®</h4>
<pre><code class="hljs language-lua" lang="lua">pnpm <span class="hljs-built_in">create</span> vite
</code></pre>
<blockquote>
<p>é¡¹ç›®ååˆ†åˆ«æ˜¯<strong>Parent</strong>å’Œ<strong>Child</strong>,åˆ†åˆ«ä»£è¡¨çˆ¶çº§åº”ç”¨å’Œå­çº§åº”ç”¨ï¼Œé™¤äº†<strong>App.vue</strong>ä¸ä¸€æ ·å…¶ä»–ä»£ç éƒ½æ˜¯ç›¸åŒçš„</p>
<p><img src="" alt="image-20251230164134789" loading="lazy"/></p>
</blockquote>
<h3 data-id="heading-12">æºç åˆ†æ</h3>
<blockquote>
<p>æ ¸å¿ƒé€»è¾‘åˆ†æ</p>
<p>æˆ‘ä»¬é¦–å…ˆå®ç°ä¸¤ä¸ªå·¥å…·å‡½æ•°ï¼Œ<strong>iframe-comm.js</strong>å’Œ<strong>iframe-comm-child.js</strong>,åˆ†åˆ«ä½œä¸ºçˆ¶çº§å’Œå­çº§çš„å·¥å…·å‡½æ•°ï¼Œä»–ä»¬çš„é€»è¾‘å¤§è‡´ä¸€æ ·ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯ï¼š</p>
<ul>
<li>
<p>constructor</p>
<ul>
<li>åˆå§‹åŒ–é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿æ¥ç›®æ ‡åœ°å€ï¼Œæ˜¯çˆ¶çº§è¿˜æ˜¯å­çº§ï¼Œäº‹ä»¶å¯¹è±¡å¤„ç†åˆé›†ç­‰</li>
</ul>
</li>
<li>
<p>initMessageListener</p>
<ul>
<li>åˆå§‹åŒ–messageäº‹ä»¶æ¶ˆæ¯ç›‘å¬</li>
</ul>
</li>
<li>
<p>connect</p>
<ul>
<li>ä¼ å…¥iframeå…ƒç´ ï¼Œä¸ºå…¨å±€å¯¹è±¡è®¾ç½®iframe</li>
</ul>
</li>
<li>
<p>send</p>
<ul>
<li>é€šè¿‡postMessageå‘é€æ¶ˆæ¯</li>
</ul>
</li>
<li>
<p>on</p>
<ul>
<li>ç›‘å¬æ¶ˆæ¯ï¼Œé€šè¿‡new Map(äº‹ä»¶ç±»åˆ«,[äº‹ä»¶å›è°ƒ])ï¼Œå¯ä»¥å®ç°å¯¹å¤šä¸ªä¸åŒäº‹ä»¶ç›‘å¬å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œåç»­ç›‘å¬é¡ºåºè§¦å‘å›è°ƒå‡½æ•°ï¼Œè·å–æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚</li>
</ul>
</li>
<li>
<p>off</p>
<ul>
<li>å–æ¶ˆç›‘å¬æ¶ˆæ¯</li>
</ul>
</li>
<li>
<p>sendWithResponse</p>
<ul>
<li>å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº”ï¼Œå‘ç”Ÿæ¶ˆæ¯ä¹‹å‰ï¼Œè®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“æ¶ˆæ¯å‘é€æˆåŠŸåï¼Œå›è°ƒå‡½æ•°ä¼šè¢«è§¦å‘ï¼Œè§¦å‘åå›è°ƒå‡½æ•°æ¸…æ¥šã€‚</li>
</ul>
</li>
<li>
<p>handleRequest</p>
<ul>
<li>é…åˆsendWithResponseä½¿ç”¨ï¼Œä¸»è¦ç›‘å¬sendWithResponseäº‹ä»¶ç±»åˆ«æ‰€å‘æ¥çš„æ•°æ®ï¼Œå¤„ç†å®Œæˆå¹¶è¿”å›ç»“æœæ•°æ®ï¼Œè¿”å›çš„ç»“æœä¼šè§¦å‘sendWithResponseä¸­è®¾ç½®çš„å›è°ƒå‡½æ•°</li>
</ul>
</li>
<li>
<p>destroy</p>
<ul>
<li>é”€æ¯å®ä¾‹</li>
</ul>
</li>
</ul>
<p>ç„¶åæ˜¯hookå‡½æ•°<strong>useIframeComm.js</strong>ï¼Œè¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯å°è£…äº†ä¸Šé¢ä¸¤ä¸ªå·¥å…·æ–¹æ³•ï¼Œæ–¹ä¾¿vue3é¡¹ç›®é›†æˆä½¿ç”¨</p>
<p>å¦‚æœæ˜¯reactæ¡†æ¶å¯ä»¥è‡ªè¡Œå°è£…hookå‡½æ•°ï¼ŒåŸç”Ÿ<strong>JS</strong>é¡¹ç›®çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šé¢çš„å·¥å…·å‡½æ•°</p>
<p>ç„¶åå°±æ˜¯App.vueçš„å®ç°äº†,å¯ä»¥ç›´æ¥å‚ç…§æºç </p>
</blockquote>
<h6 data-id="heading-13">src/utilså·¥å…·å‡½æ•°</h6>
<ul>
<li>
<p>iframe-comm-child.js ä¾›å­çº§ä½¿ç”¨çš„å·¥å…·å‡½æ•°</p>
<ul>
<li>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-comment">// iframe-comm-child.js</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">IframeCommChild</span> {
    <span class="hljs-keyword">constructor</span>(options = {}) {
   Â   <span class="hljs-keyword">this</span>.parentOrigin = options.parentOrigin || window.location.origin;
   Â   <span class="hljs-keyword">this</span>.handlers = new Map();
   Â   <span class="hljs-keyword">this</span>.isParent = <span class="hljs-literal">false</span>;
  â€‹
   Â   <span class="hljs-comment">// åˆå§‹åŒ–æ¶ˆæ¯ç›‘å¬</span>
   Â   <span class="hljs-keyword">this</span>.initMessageListener();
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å‘çˆ¶åº”ç”¨å‘é€æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {any} data - æ¶ˆæ¯æ•°æ®
   Â  */</span>
    send(type, <span class="hljs-keyword">data</span>) {
   Â   <span class="hljs-keyword">const</span> message = {
   Â  Â   type,
   Â  Â   <span class="hljs-keyword">data</span>,
   Â  Â   source: <span class="hljs-string">'child'</span>,
   Â  Â   timestamp: Date.now()
   Â   };
  â€‹
   Â   <span class="hljs-keyword">try</span> {
   Â  Â   window.parent.postMessage(message, <span class="hljs-keyword">this</span>.parentOrigin);
   Â  Â   <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
   Â   } <span class="hljs-keyword">catch</span> (error) {
   Â  Â   console.error(<span class="hljs-string">'å‘é€æ¶ˆæ¯åˆ°çˆ¶åº”ç”¨å¤±è´¥:'</span>, error);
   Â  Â   <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   Â   }
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * ç›‘å¬æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {Function} handler - å¤„ç†å‡½æ•°
   Â  */</span>
    on(type, handler) {
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handlers.has(type)) {
   Â  Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">set</span>(type, []);
   Â   }
   Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type).push(handler);
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å–æ¶ˆç›‘å¬æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {Function} handler - å¤„ç†å‡½æ•°
   Â  */</span>
    off(type, handler) {
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handlers.has(type)) <span class="hljs-keyword">return</span>;
  â€‹
   Â   <span class="hljs-keyword">if</span> (handler) {
   Â  Â   <span class="hljs-keyword">const</span> handlers = <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type);
   Â  Â   <span class="hljs-keyword">const</span> index = handlers.indexOf(handler);
   Â  Â   <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
   Â  Â  Â   handlers.splice(index, <span class="hljs-number">1</span>);
   Â  Â   }
   Â   } <span class="hljs-keyword">else</span> {
   Â  Â   <span class="hljs-keyword">this</span>.handlers.delete(type);
   Â   }
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * è‡ªåŠ¨å“åº”è¯·æ±‚
   Â  * <span class="hljs-doctag">@param</span> {string} requestType - è¯·æ±‚ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {Function} handler - å¤„ç†å‡½æ•°ï¼Œè¿”å›å“åº”æ•°æ®
   Â  */</span>
    handleRequest(requestType, handler) {
   Â   <span class="hljs-keyword">this</span>.on(requestType, async (<span class="hljs-keyword">data</span>, event) =&gt; {
   Â  Â   <span class="hljs-keyword">const</span> responseType = <span class="hljs-keyword">data</span>?._responseType;
   Â  Â   <span class="hljs-keyword">if</span> (responseType) {
   Â  Â  Â   <span class="hljs-keyword">try</span> {
   Â  Â  Â  Â   <span class="hljs-keyword">const</span> responseData = await handler(<span class="hljs-keyword">data</span>, event);
   Â  Â  Â  Â   <span class="hljs-keyword">this</span>.send(responseType, {
   Â  Â  Â  Â  Â   success: <span class="hljs-literal">true</span>,
   Â  Â  Â  Â  Â   <span class="hljs-keyword">data</span>: responseData
   Â  Â  Â  Â   });
   Â  Â  Â   } <span class="hljs-keyword">catch</span> (error) {
   Â  Â  Â  Â   <span class="hljs-keyword">this</span>.send(responseType, {
   Â  Â  Â  Â  Â   success: <span class="hljs-literal">false</span>,
   Â  Â  Â  Â  Â   error: error.message
   Â  Â  Â  Â   });
   Â  Â  Â   }
   Â  Â   }
   Â   });
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº”
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {any} data - æ¶ˆæ¯æ•°æ®
   Â  * <span class="hljs-doctag">@param</span> {number} timeout - è¶…æ—¶æ—¶é—´(æ¯«ç§’)
   Â  * <span class="hljs-doctag">@returns</span> {Promise}
   Â  */</span>
    sendWithResponse(type, <span class="hljs-keyword">data</span>, timeout = <span class="hljs-number">5000</span>) {
   Â   <span class="hljs-keyword">return</span> new Promise((resolve, reject) =&gt; {
   Â  Â   <span class="hljs-keyword">const</span> responseType = `${type}_response_${Date.now()}`;
   Â  Â   let timeoutId;
  â€‹
   Â  Â   <span class="hljs-keyword">const</span> responseHandler = (response) =&gt; {
   Â  Â  Â   clearTimeout(timeoutId);
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   resolve(response.<span class="hljs-keyword">data</span>);
   Â  Â   };
  â€‹
   Â  Â   <span class="hljs-keyword">this</span>.on(responseType, responseHandler);
  â€‹
   Â  Â   <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
   Â  Â   <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">this</span>.send(type, {
   Â  Â  Â   ...<span class="hljs-keyword">data</span>,
   Â  Â  Â   _responseType: responseType
   Â  Â   });
  â€‹
   Â  Â   <span class="hljs-keyword">if</span> (!success) {
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   reject(new Error(<span class="hljs-string">'å‘é€æ¶ˆæ¯å¤±è´¥'</span>));
   Â  Â  Â   <span class="hljs-keyword">return</span>;
   Â  Â   }
  â€‹
   Â  Â   <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
   Â  Â   timeoutId = setTimeout(() =&gt; {
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   reject(new Error(<span class="hljs-string">'ç­‰å¾…å“åº”è¶…æ—¶'</span>));
   Â  Â   }, timeout);
   Â   });
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * åˆå§‹åŒ–æ¶ˆæ¯ç›‘å¬å™¨
   Â  */</span>
    initMessageListener() {
   Â   window.addEventListener(<span class="hljs-string">'message'</span>, (event) =&gt; {
   Â  Â   <span class="hljs-comment">// å®‰å…¨æ£€æŸ¥</span>
   Â  Â   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.parentOrigin !== <span class="hljs-string">'*'</span> &amp;&amp; event.origin !== <span class="hljs-keyword">this</span>.parentOrigin) {
   Â  Â  Â   <span class="hljs-keyword">return</span>;
   Â  Â   }
  â€‹
   Â  Â   <span class="hljs-keyword">const</span> { type, <span class="hljs-keyword">data</span>, source } = event.<span class="hljs-keyword">data</span>;
  â€‹
   Â  Â   <span class="hljs-comment">// åªå¤„ç†æ¥è‡ªçˆ¶åº”ç”¨çš„æ¶ˆæ¯</span>
   Â  Â   <span class="hljs-keyword">if</span> (source !== <span class="hljs-string">'parent'</span>) <span class="hljs-keyword">return</span>;
  â€‹
   Â  Â   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.handlers.has(type)) {
   Â  Â  Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type).forEach(handler =&gt; {
   Â  Â  Â  Â   <span class="hljs-keyword">try</span> {
   Â  Â  Â  Â  Â   handler(<span class="hljs-keyword">data</span>, event);
   Â  Â  Â  Â   } <span class="hljs-keyword">catch</span> (error) {
   Â  Â  Â  Â  Â   console.error(`å¤„ç†æ¶ˆæ¯ ${type} æ—¶å‡ºé”™:`, error);
   Â  Â  Â  Â   }
   Â  Â  Â   });
   Â  Â   }
   Â   });
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * é”€æ¯å®ä¾‹
   Â  */</span>
    destroy() {
   Â   window.removeEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-keyword">this</span>.messageHandler);
   Â   <span class="hljs-keyword">this</span>.handlers.clear();
    }
  }
  â€‹
  export default IframeCommChild;
</code></pre>
</li>
</ul>
</li>
<li>
<p>iframe-comm.js ä¾›çˆ¶çº§ä½¿ç”¨çš„å·¥å…·å‡½æ•°</p>
<ul>
<li>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-comment">// iframe-comm.js</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">IframeComm</span> {
    <span class="hljs-keyword">constructor</span>(options = {}) {
   Â   <span class="hljs-keyword">this</span>.origin = options.origin || <span class="hljs-string">'*'</span>;
   Â   <span class="hljs-keyword">this</span>.targetOrigin = options.targetOrigin || window.location.origin;
   Â   <span class="hljs-keyword">this</span>.handlers = new Map();
   Â   <span class="hljs-keyword">this</span>.iframe = <span class="hljs-literal">null</span>;
   Â   <span class="hljs-keyword">this</span>.isParent = <span class="hljs-literal">true</span>;
  â€‹
   Â   <span class="hljs-comment">// åˆå§‹åŒ–æ¶ˆæ¯ç›‘å¬</span>
   Â   <span class="hljs-keyword">this</span>.initMessageListener();
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * è¿æ¥åˆ°æŒ‡å®šiframe
   Â  * <span class="hljs-doctag">@param</span> {HTMLIFrameElement|string} iframe - iframeå…ƒç´ æˆ–é€‰æ‹©å™¨
   Â  */</span>
    connect(iframe) {
   Â   <span class="hljs-keyword">if</span> (typeof iframe === <span class="hljs-string">'string'</span>) {
   Â  Â   <span class="hljs-keyword">this</span>.iframe = document.querySelector(iframe);
   Â   } <span class="hljs-keyword">else</span> {
   Â  Â   <span class="hljs-keyword">this</span>.iframe = iframe;
   Â   }
  â€‹
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.iframe || !<span class="hljs-keyword">this</span>.iframe.contentWindow) {
   Â  Â   console.error(<span class="hljs-string">'æ— æ•ˆçš„iframeå…ƒç´ '</span>);
   Â  Â   <span class="hljs-keyword">return</span>;
   Â   }
  â€‹
   Â   <span class="hljs-keyword">this</span>.isParent = <span class="hljs-literal">true</span>;
   Â   <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å‘å­åº”ç”¨å‘é€æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {any} data - æ¶ˆæ¯æ•°æ®
   Â  * <span class="hljs-doctag">@param</span> {string} targetOrigin - ç›®æ ‡origin
   Â  */</span>
    send(type, <span class="hljs-keyword">data</span>, targetOrigin = <span class="hljs-keyword">this</span>.targetOrigin) {
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.iframe?.contentWindow) {
   Â  Â   console.error(<span class="hljs-string">'æœªè¿æ¥åˆ°iframeæˆ–iframeæœªåŠ è½½å®Œæˆ'</span>);
   Â  Â   <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   Â   }
  â€‹
   Â   <span class="hljs-keyword">const</span> message = {
   Â  Â   type,
   Â  Â   <span class="hljs-keyword">data</span>,
   Â  Â   source: <span class="hljs-string">'parent'</span>,
   Â  Â   timestamp: Date.now()
   Â   };
  â€‹
   Â   <span class="hljs-keyword">try</span> {
   Â  Â   <span class="hljs-keyword">this</span>.iframe.contentWindow.postMessage(message, targetOrigin);
   Â  Â   <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
   Â   } <span class="hljs-keyword">catch</span> (error) {
   Â  Â   console.error(<span class="hljs-string">'å‘é€æ¶ˆæ¯å¤±è´¥:'</span>, error);
   Â  Â   <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   Â   }
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * ç›‘å¬æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {Function} handler - å¤„ç†å‡½æ•°
   Â  */</span>
    on(type, handler) {
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handlers.has(type)) {
   Â  Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">set</span>(type, []);
   Â   }
   Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type).push(handler);
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å–æ¶ˆç›‘å¬æ¶ˆæ¯
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {Function} handler - å¤„ç†å‡½æ•°
   Â  */</span>
    off(type, handler) {
   Â   <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handlers.has(type)) <span class="hljs-keyword">return</span>;
  â€‹
   Â   <span class="hljs-keyword">if</span> (handler) {
   Â  Â   <span class="hljs-keyword">const</span> handlers = <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type);
   Â  Â   <span class="hljs-keyword">const</span> index = handlers.indexOf(handler);
   Â  Â   <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
   Â  Â  Â   handlers.splice(index, <span class="hljs-number">1</span>);
   Â  Â   }
   Â   } <span class="hljs-keyword">else</span> {
   Â  Â   <span class="hljs-keyword">this</span>.handlers.delete(type);
   Â   }
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº”
   Â  * <span class="hljs-doctag">@param</span> {string} type - æ¶ˆæ¯ç±»å‹
   Â  * <span class="hljs-doctag">@param</span> {any} data - æ¶ˆæ¯æ•°æ®
   Â  * <span class="hljs-doctag">@param</span> {number} timeout - è¶…æ—¶æ—¶é—´(æ¯«ç§’)
   Â  * <span class="hljs-doctag">@returns</span> {Promise}
   Â  */</span>
    sendWithResponse(type, <span class="hljs-keyword">data</span>, timeout = <span class="hljs-number">5000</span>) {
   Â   <span class="hljs-keyword">return</span> new Promise((resolve, reject) =&gt; {
   Â  Â   <span class="hljs-keyword">const</span> responseType = `${type}_response_${Date.now()}`;
   Â  Â   let timeoutId;
  â€‹
   Â  Â   <span class="hljs-keyword">const</span> responseHandler = (response) =&gt; {
   Â  Â  Â   clearTimeout(timeoutId);
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   resolve(response.<span class="hljs-keyword">data</span>);
   Â  Â   };
  â€‹
   Â  Â   <span class="hljs-keyword">this</span>.on(responseType, responseHandler);
  â€‹
   Â  Â   <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
   Â  Â   <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">this</span>.send(type, {
   Â  Â  Â   ...<span class="hljs-keyword">data</span>,
   Â  Â  Â   _responseType: responseType
   Â  Â   });
  â€‹
   Â  Â   <span class="hljs-keyword">if</span> (!success) {
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   reject(new Error(<span class="hljs-string">'å‘é€æ¶ˆæ¯å¤±è´¥'</span>));
   Â  Â  Â   <span class="hljs-keyword">return</span>;
   Â  Â   }
  â€‹
   Â  Â   <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
   Â  Â   timeoutId = setTimeout(() =&gt; {
   Â  Â  Â   <span class="hljs-keyword">this</span>.off(responseType, responseHandler);
   Â  Â  Â   reject(new Error(<span class="hljs-string">'ç­‰å¾…å“åº”è¶…æ—¶'</span>));
   Â  Â   }, timeout);
   Â   });
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * åˆå§‹åŒ–æ¶ˆæ¯ç›‘å¬å™¨
   Â  */</span>
    initMessageListener() {
   Â   window.addEventListener(<span class="hljs-string">'message'</span>, (event) =&gt; {
   Â  Â   <span class="hljs-comment">// å®‰å…¨æ£€æŸ¥</span>
   Â  Â   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.targetOrigin !== <span class="hljs-string">'*'</span> &amp;&amp; event.origin !== <span class="hljs-keyword">this</span>.targetOrigin) {
   Â  Â  Â   <span class="hljs-keyword">return</span>;
   Â  Â   }
  â€‹
   Â  Â   <span class="hljs-keyword">const</span> { type, <span class="hljs-keyword">data</span>, source } = event.<span class="hljs-keyword">data</span>;
  â€‹
   Â  Â   <span class="hljs-comment">// åªå¤„ç†æ¥è‡ªå­åº”ç”¨çš„æ¶ˆæ¯</span>
   Â  Â   <span class="hljs-keyword">if</span> (source !== <span class="hljs-string">'child'</span>) <span class="hljs-keyword">return</span>;
  â€‹
   Â  Â   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.handlers.has(type)) {
   Â  Â  Â   <span class="hljs-keyword">this</span>.handlers.<span class="hljs-keyword">get</span>(type).forEach(handler =&gt; {
   Â  Â  Â  Â   <span class="hljs-keyword">try</span> {
   Â  Â  Â  Â  Â   handler(<span class="hljs-keyword">data</span>, event);
   Â  Â  Â  Â   } <span class="hljs-keyword">catch</span> (error) {
   Â  Â  Â  Â  Â   console.error(`å¤„ç†æ¶ˆæ¯ ${type} æ—¶å‡ºé”™:`, error);
   Â  Â  Â  Â   }
   Â  Â  Â   });
   Â  Â   }
   Â   });
    }
  â€‹
    <span class="hljs-comment">/**
   Â  * é”€æ¯å®ä¾‹
   Â  */</span>
    destroy() {
   Â   window.removeEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-keyword">this</span>.messageHandler);
   Â   <span class="hljs-keyword">this</span>.handlers.clear();
   Â   <span class="hljs-keyword">this</span>.iframe = <span class="hljs-literal">null</span>;
    }
  }
  â€‹
  export default IframeComm;
</code></pre>
</li>
</ul>
</li>
</ul>
<h6 data-id="heading-14">src/composables é’©å­å‡½æ•°</h6>
<ul>
<li>
<blockquote>
<p>è¿™é‡Œé¢æ˜¯æ ¸å¿ƒhookå‡½æ•°</p>
</blockquote>
</li>
</ul>

<ul>
<li>
<p>useIframeComm.js</p>
<ul>
<li>
<pre><code class="hljs language-ini" lang="ini">  // useIframeComm.js
  import { ref, onUnmounted } from 'vue'<span class="hljs-comment">;</span>
  import IframeComm from '../utils/iframe-comm.js'<span class="hljs-comment">;</span>
  import IframeCommChild from '../utils/iframe-comm-child.js'<span class="hljs-comment">;</span>
  â€‹
  /**
   * Vue3ç»„åˆå¼å‡½æ•° - çˆ¶åº”ç”¨
   */
  export function useIframeComm(<span class="hljs-attr">options</span> = {}) {
    const <span class="hljs-attr">comm</span> = ref(null)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">isConnected</span> = ref(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">lastMessage</span> = ref(null)<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">connect</span> = (iframe) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.destroy()<span class="hljs-comment">;</span>
   Â   }
  â€‹
   Â   <span class="hljs-attr">comm.value</span> = new IframeComm(options)<span class="hljs-comment">;</span>
   Â   comm.value.connect(iframe)<span class="hljs-comment">;</span>
   Â   <span class="hljs-attr">isConnected.value</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
  â€‹
   Â   // ç›‘å¬æ‰€æœ‰æ¶ˆæ¯
   Â   comm.value.on('*', (data, event) =&gt; {
   Â  Â   <span class="hljs-attr">lastMessage.value</span> = { data, timestamp: Date.now() }<span class="hljs-comment">;</span>
   Â   })<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">send</span> = (type, data) =&gt; {
   Â   if (!comm.value) {
   Â  Â   console.error('æœªè¿æ¥åˆ°iframe')<span class="hljs-comment">;</span>
   Â  Â   return false<span class="hljs-comment">;</span>
   Â   }
   Â   return comm.value.send(type, data)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">on</span> = (type, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.on(type, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">off</span> = (type, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.off(type, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">sendWithResponse</span> = async (type, data, timeout) =&gt; {
   Â   try {
   Â  Â   if (!comm.value) {
   Â  Â  Â   throw new Error('æœªè¿æ¥åˆ°iframe')<span class="hljs-comment">;</span>
   Â  Â   }
   Â  Â   return await comm.value.sendWithResponse(type, data, timeout)<span class="hljs-comment">;</span>
   Â   } catch (error) {
   Â  Â   console.error(error)<span class="hljs-comment">;</span>
  â€‹
   Â   }
    }<span class="hljs-comment">;</span>
    const <span class="hljs-attr">handleRequest</span> = (requestType, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.handleRequest(requestType, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    onUnmounted(() =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.destroy()<span class="hljs-comment">;</span>
   Â   }
    })<span class="hljs-comment">;</span>
  â€‹
    return {
   Â   comm,
   Â   isConnected,
   Â   lastMessage,
   Â   connect,
   Â   send,
   Â   on,
   Â   off,
   Â   sendWithResponse,
   Â   handleRequest
    }<span class="hljs-comment">;</span>
  }
  â€‹
  /**
   * Vue3ç»„åˆå¼å‡½æ•° - å­åº”ç”¨
   */
  export function useIframeCommChild(<span class="hljs-attr">options</span> = {}) {
    const <span class="hljs-attr">comm</span> = ref(null)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">isReady</span> = ref(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">lastMessage</span> = ref(null)<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">init</span> = () =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.destroy()<span class="hljs-comment">;</span>
   Â   }
  â€‹
   Â   <span class="hljs-attr">comm.value</span> = new IframeCommChild(options)<span class="hljs-comment">;</span>
   Â   <span class="hljs-attr">isReady.value</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
  â€‹
   Â   // ç›‘å¬æ‰€æœ‰æ¶ˆæ¯
   Â   comm.value.on('*', (data, event) =&gt; {
   Â  Â   <span class="hljs-attr">lastMessage.value</span> = { data, timestamp: Date.now() }<span class="hljs-comment">;</span>
   Â   })<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">send</span> = (type, data) =&gt; {
   Â   if (!comm.value) {
   Â  Â   console.error('å­åº”ç”¨é€šä¿¡æœªåˆå§‹åŒ–')<span class="hljs-comment">;</span>
   Â  Â   return false<span class="hljs-comment">;</span>
   Â   }
   Â   return comm.value.send(type, data)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">on</span> = (type, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.on(type, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">off</span> = (type, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.off(type, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">sendWithResponse</span> = async (type, data, timeout) =&gt; {
   Â   try {
   Â  Â   if (!comm.value) {
   Â  Â  Â   throw new Error('å­åº”ç”¨é€šä¿¡æœªåˆå§‹åŒ–')<span class="hljs-comment">;</span>
   Â  Â   }
   Â  Â   return await comm.value.sendWithResponse(type, data, timeout)<span class="hljs-comment">;</span>
   Â   } catch (error) {
   Â  Â   console.error(error)<span class="hljs-comment">;</span>
  â€‹
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    const <span class="hljs-attr">handleRequest</span> = (requestType, handler) =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.handleRequest(requestType, handler)<span class="hljs-comment">;</span>
   Â   }
    }<span class="hljs-comment">;</span>
  â€‹
    onUnmounted(() =&gt; {
   Â   if (comm.value) {
   Â  Â   comm.value.destroy()<span class="hljs-comment">;</span>
   Â   }
    })<span class="hljs-comment">;</span>
  â€‹
    return {
   Â   comm,
   Â   isReady,
   Â   lastMessage,
   Â   init,
   Â   send,
   Â   on,
   Â   off,
   Â   sendWithResponse,
   Â   handleRequest
    }<span class="hljs-comment">;</span>
  }
</code></pre>
</li>
</ul>
</li>
</ul>
<h6 data-id="heading-15">src/App.vue ä¸»ä»£ç </h6>
<ul>
<li>
<p>è¿™æ˜¯çˆ¶çº§çš„App.vue</p>
<ul>
<li>
<blockquote>
<p>çˆ¶çº§çš„ç«¯å£æ˜¯5173ï¼Œæ‰€ä»¥ä»–è¦è¿æ¥åˆ°5174</p>
</blockquote>
</li>
<li>
<pre><code class="hljs language-xml" lang="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
  <span class="hljs-keyword">import</span> { useIframeComm } <span class="hljs-keyword">from</span> <span class="hljs-string">'./composables/useIframeComm'</span>;
  <span class="hljs-keyword">const</span> iframeRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> receivedData = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-comment">// åˆå§‹åŒ–é€šè®¯</span>
  <span class="hljs-keyword">const</span> { connect, send, on, sendWithResponse, handleRequest, lastMessage } = <span class="hljs-title function_">useIframeComm</span>({
    <span class="hljs-attr">targetOrigin</span>: <span class="hljs-string">'http://localhost:5174'</span>
  });
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">onIframeLoad</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">connect</span>(iframeRef.<span class="hljs-property">value</span>);
    <span class="hljs-comment">// ç›‘å¬å­åº”ç”¨</span>
    <span class="hljs-title function_">on</span>(<span class="hljs-string">'child_message'</span>, <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
   Â   receivedData.<span class="hljs-property">value</span> = data;
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å­åº”ç”¨æ¶ˆæ¯'</span>, data);
    });
    <span class="hljs-title function_">on</span>(<span class="hljs-string">'child_response'</span>, <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å­åº”ç”¨å“åº”'</span>, data);
    });
    <span class="hljs-comment">// å¤„ç†è¯·æ±‚å¹¶è‡ªè‡ªåŠ¨å“åº”</span>
    <span class="hljs-title function_">handleRequest</span>(<span class="hljs-string">'get_data'</span>, <span class="hljs-keyword">async</span> data =&gt; {
   Â   <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
   Â   <span class="hljs-keyword">return</span> {
   Â  Â   <span class="hljs-attr">result</span>: <span class="hljs-string">'data from parent'</span>,
   Â  Â   ...data
   Â   };
    });
  };
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">send</span>(<span class="hljs-string">'parent_message'</span>, {
   Â   <span class="hljs-attr">action</span>: <span class="hljs-string">'update'</span>,
   Â   <span class="hljs-attr">value</span>: <span class="hljs-string">'Hello from parent'</span>
    });
    <span class="hljs-comment">// å‘é€å¹¶ç­‰å¾…å“åº”</span>
    <span class="hljs-keyword">try</span> {
   Â   <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendWithResponse</span>(<span class="hljs-string">'get_data'</span>, {
   Â  Â   <span class="hljs-attr">query</span>: <span class="hljs-string">'some data'</span>
   Â   });
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å­çº§å“åº”æ•°æ®'</span>, response);
    } <span class="hljs-keyword">catch</span> (error) {
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>, error);
    }
  };
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  â€‹
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>çˆ¶åº”ç”¨<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"iframeRef"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://localhost:5174"</span> @<span class="hljs-attr">load</span>=<span class="hljs-string">"onIframeLoad"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: flex; flex-direction: row"</span>&gt;</span>
   Â  Â   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"flex: 2; border: 1px solid black; height: 100px"</span>&gt;</span>æ¥æ”¶åˆ°çš„å­çº§æ¶ˆæ¯ï¼š{{ receivedData }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
   Â  Â   <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"flex: 1"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"sendMessage"</span>&gt;</span>å‘é€æ¶ˆæ¯åˆ°å­åº”ç”¨<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  â€‹
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.parent</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">background-color</span>: white;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-selector-tag">iframe</span> {
   Â   <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
    }
    <span class="hljs-selector-tag">h1</span> {
   Â   <span class="hljs-attribute">text-align</span>: center;
    }
  }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  â€‹
</code></pre>
</li>
</ul>
</li>
<li>
<p>è¿™æ˜¯å­çº§çš„App.vue</p>
<ul>
<li>
<blockquote>
<p>å­çº§çš„ç«¯å£æ˜¯5174ï¼Œæ‰€ä»¥ä»–è¦è¿æ¥åˆ°5173</p>
</blockquote>
</li>
<li>
<pre><code class="hljs language-xml" lang="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { onMounted, ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
  <span class="hljs-keyword">import</span> { useIframeCommChild } <span class="hljs-keyword">from</span> <span class="hljs-string">'./composables/useIframeComm'</span>;
  <span class="hljs-keyword">const</span> parentData = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> { init, send, on, handleRequest, sendWithResponse } = <span class="hljs-title function_">useIframeCommChild</span>({
    <span class="hljs-attr">parentOrigin</span>: <span class="hljs-string">'http://localhost:5173'</span>
  });
  <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">init</span>();
    <span class="hljs-title function_">on</span>(<span class="hljs-string">'parent_message'</span>, <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
   Â   parentData.<span class="hljs-property">value</span> = data;
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°çˆ¶åº”ç”¨æ¶ˆæ¯'</span>, data);
    });
    <span class="hljs-comment">// å¤„ç†è¯·æ±‚å¹¶è‡ªè‡ªåŠ¨å“åº”</span>
    <span class="hljs-title function_">handleRequest</span>(<span class="hljs-string">'get_data'</span>, <span class="hljs-keyword">async</span> data =&gt; {
   Â   <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
   Â   <span class="hljs-keyword">return</span> {
   Â  Â   <span class="hljs-attr">result</span>: <span class="hljs-string">'data from child'</span>,
   Â  Â   ...data
   Â   };
    });
  });
  <span class="hljs-comment">// å‘é€æ¶ˆæ¯åˆ°çˆ¶çº§</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendToParent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">send</span>(<span class="hljs-string">'child_message'</span>, {
   Â   <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello from child'</span>,
   Â   <span class="hljs-attr">time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    });
    <span class="hljs-comment">// // å‘é€å“åº”ä¿¡æ¯</span>
    <span class="hljs-comment">// send('child_response', { status: 'success' });</span>
    <span class="hljs-comment">// å‘é€å¹¶ç­‰å¾…å“åº”</span>
    <span class="hljs-keyword">try</span> {
   Â   <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendWithResponse</span>(<span class="hljs-string">'get_data'</span>, {
   Â  Â   <span class="hljs-attr">query</span>: <span class="hljs-string">'some data'</span>
   Â   });
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å“åº”æ•°æ®'</span>, response);
    } <span class="hljs-keyword">catch</span> (error) {
   Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>, error);
    }
  };
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  â€‹
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child"</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å­åº”ç”¨<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: flex; flex-direction: row"</span>&gt;</span>
   Â  Â   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"flex: 2; border: 1px solid black; height: 100px"</span>&gt;</span>æ¥æ”¶åˆ°çš„çˆ¶çº§æ¶ˆæ¯ï¼š{{ parentData }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
   Â  Â   <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"sendToParent"</span>&gt;</span>å‘é€åˆ°çˆ¶åº”ç”¨<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
   Â   <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  â€‹
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.child</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">border</span>: <span class="hljs-number">5px</span> dashed black;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-selector-tag">h1</span> {
   Â   <span class="hljs-attribute">text-align</span>: center;
    }
  }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  â€‹
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-16">ç»“å°¾</h3>
<p>è¿™ä¸ªå°è£…æ–¹æ¡ˆæä¾›äº†ä¸€ä¸ªå®Œæ•´ã€å¯é çš„ Iframe é€šä¿¡è§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºå„ç§å¾®å‰ç«¯é›†æˆåœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŒæ­¥çš„ deferï¼Œå¼‚æ­¥çš„é™·é˜±ï¼šSwift å¹¶å‘ä¸­åŠ è½½åŠ¨ç”»å…³ä¸æ‰çš„è°ƒè¯•å®å½•]]></title>    <link>https://juejin.cn/post/7589454621718970418</link>    <guid>https://juejin.cn/post/7589454621718970418</guid>    <pubDate>2025-12-30T08:12:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589454621718970418" data-draft-id="7589250237069049866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŒæ­¥çš„ deferï¼Œå¼‚æ­¥çš„é™·é˜±ï¼šSwift å¹¶å‘ä¸­åŠ è½½åŠ¨ç”»å…³ä¸æ‰çš„è°ƒè¯•å®å½•"/> <meta itemprop="keywords" content="Swift,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-30T08:12:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JQShan"/> <meta itemprop="url" content="https://juejin.cn/user/1636535083759005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŒæ­¥çš„ deferï¼Œå¼‚æ­¥çš„é™·é˜±ï¼šSwift å¹¶å‘ä¸­åŠ è½½åŠ¨ç”»å…³ä¸æ‰çš„è°ƒè¯•å®å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1636535083759005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JQShan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:12:09.000Z" title="Tue Dec 30 2025 08:12:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Swift å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œ<code>defer</code>è¯­å¥ä¸<code>Task</code>çš„ç»„åˆå¸¸å¸¸æš—è—è®¤çŸ¥åå·®ï¼Œå¾ˆå®¹æ˜“å†™å‡º â€œçœ‹ä¼¼åˆç†ã€å®é™…å¤±æ•ˆâ€ çš„ä»£ç ã€‚æœ¬æ–‡å°†é€šè¿‡ä¸€æ¬¡çœŸå®çš„è°ƒè¯•ç»å†ï¼Œæ‹†è§£ â€œä¸ºä»€ä¹ˆ<code>defer</code>ä¸­çš„ä»£ç çœ‹ä¼¼åˆç†å´æ²¡æœ‰æ‰§è¡Œâ€ çš„æ ¸å¿ƒåŸå› ï¼Œå¹¶æ¢³ç†å¯¹åº”çš„æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—ã€‚</p>
<h2 data-id="heading-0">åœºæ™¯é‡ç°ï¼šæŒ¥ä¹‹ä¸å»çš„æ”¯ä»˜åŠ è½½åŠ¨ç”»</h2>
<p>åœ¨æ”¯ä»˜é¡µé¢çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªåŸºç¡€åŠŸèƒ½ï¼šæ”¯ä»˜æµç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œè‡ªåŠ¨å…³é—­åŠ è½½åŠ¨ç”»ã€‚æœ€åˆçš„ä»£ç å®ç°å¦‚ä¸‹ï¼Œé€»è¾‘çœ‹ä¼¼æ— æ‡ˆå¯å‡»ï¼Œä½†å®é™…è¿è¡Œä¸­ï¼ŒåŠ è½½åŠ¨ç”»å¶å°”ä¼š â€œå¹½çµèˆ¬â€ æ— æ³•å…³é—­ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">processPayment</span>() {
    <span class="hljs-type">Task</span> {
        showLoading <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
        
        <span class="hljs-keyword">defer</span> {
            <span class="hljs-comment">// ä¸»è§‚é¢„æœŸï¼šæ­¤å¤„ä»£ç ä¼šå¯é æ‰§è¡Œï¼Œå…³é—­åŠ è½½åŠ¨ç”»</span>
            <span class="hljs-type">Task</span> { <span class="hljs-meta">@MainActor</span> <span class="hljs-keyword">in</span>
                showLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
            }
        }
        
        <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> paymentService.pay()
        handleResult(result)
    }
}
</code></pre>
<h2 data-id="heading-1">æ ¸å¿ƒçŸ¥è¯†ç‚¹æ‹†è§£ï¼šé—®é¢˜çš„æœ¬è´¨</h2>
<h3 data-id="heading-2">çŸ¥è¯†ç‚¹ 1ï¼š<code>defer</code>çš„æ‰§è¡Œè¾¹ç•Œ â€”â€” ä»…ä¿è¯åŒæ­¥ä»£ç å¯é æ‰§è¡Œ</h3>
<p><code>defer</code>è¯­å¥çš„æ ¸å¿ƒç‰¹æ€§æ˜¯<strong>åœ¨å½“å‰ä½œç”¨åŸŸé€€å‡ºæ—¶å¿…ç„¶æ‰§è¡Œ</strong>ï¼Œæ— è®ºä½œç”¨åŸŸæ˜¯æ­£å¸¸è¿”å›ã€æŠ›å‡ºé”™è¯¯è¿˜æ˜¯è¢«å–æ¶ˆã€‚ä½†è¿™ä¸€ â€œå¿…ç„¶æ‰§è¡Œâ€ çš„ä¿è¯ï¼Œä»…é’ˆå¯¹<code>defer</code>å—å†…çš„åŒæ­¥ä»£ç ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">example</span>() {
    <span class="hljs-keyword">defer</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"1. æˆ‘ä¸€å®šä¼šæ‰§è¡Œï¼ˆåŒæ­¥ä»£ç ï¼‰"</span>)
        
        <span class="hljs-type">Task</span> {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"2. æˆ‘å¯èƒ½ä¸ä¼šæ‰§è¡Œï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰"</span>)
        }
    }
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"3. æ­£å¸¸ä¸šåŠ¡ä»£ç "</span>)
}
</code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>print("1. æˆ‘ä¸€å®šä¼šæ‰§è¡Œ")</code>ä¼šç™¾åˆ†ç™¾è§¦å‘ï¼Œä½†å†…éƒ¨åˆ›å»ºçš„å¼‚æ­¥<code>Task</code>å¯èƒ½è¿˜æœªè¢«ç³»ç»Ÿè°ƒåº¦ï¼Œå½“å‰ä½œç”¨åŸŸå°±å·²å®Œå…¨é”€æ¯ï¼Œå¯¼è‡´å¼‚æ­¥ä»»åŠ¡æ— æ³•æ‰§è¡Œã€‚</p>
<h3 data-id="heading-3">çŸ¥è¯†ç‚¹ 2ï¼šSwiftÂ <code>Task</code>çš„å–æ¶ˆç‰¹æ€§ â€”â€” åä½œå¼è€Œéå¼ºåˆ¶å¼</h3>
<p>Swift çš„<code>Task</code>å–æ¶ˆéµå¾ª â€œåä½œå¼â€ åŸåˆ™ï¼Œè€Œéå¼ºåˆ¶ç»ˆæ­¢ä»»åŠ¡è¿è¡Œã€‚è¿™ä¸€ç‰¹æ€§å†³å®šäº†<code>defer</code>æœ¬èº«çš„æ‰§è¡Œç¨³å®šæ€§ï¼Œä½†æ— æ³•ä¿éšœ<code>defer</code>å†…æ–°åˆ›å»ºå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-keyword">defer</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å³ä½¿ä»»åŠ¡è¢«å–æ¶ˆï¼Œæˆ‘ä¹Ÿä¼šæ‰§è¡Œ"</span>)
    }
    
    <span class="hljs-comment">// æ­¤å¤„ä¼šè‡ªåŠ¨æ£€æŸ¥ä»»åŠ¡å–æ¶ˆçŠ¶æ€</span>
    <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> someAsyncWork()
    
    <span class="hljs-comment">// è‹¥ä»»åŠ¡è¢«å–æ¶ˆï¼Œä¸Šé¢çš„awaitä¼šæŠ›å‡ºCancellationError</span>
    <span class="hljs-comment">// ä½†deferå—ä»ä¼šä¸å—å½±å“åœ°æ‰§è¡Œ</span>
}
</code></pre>
<p>å…³é”®ç—›ç‚¹ï¼š<code>defer</code>å—æœ¬èº«ä¼šå¯é æ‰§è¡Œï¼Œä½†å…¶ä¸­æ–°åˆ›å»ºçš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¯èƒ½å› è°ƒåº¦å»¶è¿Ÿã€ä¸Šä¸‹æ–‡é”€æ¯ç­‰é—®é¢˜ï¼Œæ— æ³•æ­£å¸¸æ‰§è¡Œåç»­é€»è¾‘ã€‚</p>
<h3 data-id="heading-4">çŸ¥è¯†ç‚¹ 3ï¼šé¡µé¢é”€æ¯æ—¶çš„ â€œæ—¶é—´å·®â€â€”â€” çŠ¶æ€å¤±æ•ˆçš„éšå½¢æ€æ‰‹</h3>
<p>å½“æ”¯ä»˜æµç¨‹å®Œæˆåæ‰§è¡Œé¡µé¢é”€æ¯æ“ä½œæ—¶ï¼Œæ—¶åºä¸Šçš„é”™ä½ä¼šç›´æ¥å¯¼è‡´åŠ è½½åŠ¨ç”»å…³é—­é€»è¾‘å¤±æ•ˆï¼Œè¿™ä¹Ÿæ˜¯é—®é¢˜å¤ç°çš„æ ¸å¿ƒåœºæ™¯ã€‚</p>
<h4 data-id="heading-5">é—®é¢˜æ—¶åºçº¿</h4>
<ol>
<li><code>await paymentService.pay()</code>æ‰§è¡Œå®Œæˆï¼Œ<code>dismissPage()</code>è¢«è°ƒç”¨ï¼Œé¡µé¢å¼€å§‹é”€æ¯æµç¨‹</li>
<li>SwiftUI æ¡†æ¶å¼€å§‹é”€æ¯å½“å‰ View å®ä¾‹ï¼Œé‡Šæ”¾ç›¸å…³èµ„æº</li>
<li>View ä¸­çš„<code>@State</code>ï¼ˆ<code>showLoading</code>ï¼‰ç­‰çŠ¶æ€å˜é‡è¢«æ¸…ç†å¤±æ•ˆ</li>
<li>å¤–å±‚<code>Task</code>ä½œç”¨åŸŸé€€å‡ºï¼Œ<code>defer</code>å—æ‰§è¡Œï¼Œåˆ›å»ºæ–°çš„å¼‚æ­¥<code>Task</code></li>
<li>æ–°<code>Task</code>å°šæœªè¢«ç³»ç»Ÿè°ƒåº¦ï¼ŒView å·²å®Œå…¨é”€æ¯</li>
<li>å³ä¾¿åç»­æ–°<code>Task</code>è¢«è°ƒåº¦æ‰§è¡Œï¼Œ<code>showLoading = false</code>å¯¹å·²é”€æ¯çš„ View æ— ä»»ä½•æ•ˆæœï¼ŒåŠ¨ç”»æ— æ³•å…³é—­</li>
</ol>
<h2 data-id="heading-6">æ­£ç¡®è§£å†³æ–¹æ¡ˆï¼šæŠ›å¼ƒ â€œåµŒå¥—å¼‚æ­¥â€ï¼Œç›´æ¥ä¸»çº¿ç¨‹åŒæ­¥æ‰§è¡Œ</h2>
<p>è§£å†³è¯¥é—®é¢˜çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼š<strong>é¿å…åœ¨<code>defer</code>ä¸­åˆ›å»ºæ–°å¼‚æ­¥ä»»åŠ¡ï¼Œç›´æ¥é€šè¿‡<code>await MainActor.run</code>åœ¨ä¸»çº¿ç¨‹åŒæ­¥æ‰§è¡Œ UI æ›´æ–°æ“ä½œ</strong>ï¼Œæ¶ˆé™¤è°ƒåº¦å»¶è¿Ÿä¸ä¸Šä¸‹æ–‡å¤±æ•ˆçš„é£é™©ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">processPayment</span>() {
    <span class="hljs-type">Task</span> {
        <span class="hljs-comment">// ä¸»çº¿ç¨‹å¼€å¯åŠ è½½åŠ¨ç”»</span>
        <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
            showLoading <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
        }
        
        <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> paymentService.pay()
        
        <span class="hljs-comment">// âœ… æœ€ä¼˜è§£ï¼šä¸»çº¿ç¨‹åŒæ­¥æ‰§è¡Œï¼Œç¡®ä¿é€»è¾‘å¯é è§¦å‘</span>
        <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
            showLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
            handleResult(result)
        }
    }
}
</code></pre>
<h3 data-id="heading-7">è¯¥æ–¹æ¡ˆçš„ä¼˜åŠ¿</h3>
<ol>
<li><code>await MainActor.run</code>ä¼šé˜»å¡å½“å‰<code>Task</code>ï¼Œç­‰å¾…ä¸»çº¿ç¨‹ä¸Šçš„ UI æ“ä½œæ‰§è¡Œå®Œæˆåå†ç»§ç»­ï¼Œæ— è°ƒåº¦å»¶è¿Ÿ</li>
<li>ä¸åˆ›å»ºæ–°çš„å¼‚æ­¥<code>Task</code>ï¼Œç›´æ¥å¤ç”¨å¤–å±‚<code>Task</code>ä¸Šä¸‹æ–‡ï¼Œé¿å…ä¸Šä¸‹æ–‡é”€æ¯å¯¼è‡´çš„é€»è¾‘å¤±æ•ˆ</li>
<li>å³ä½¿å¤–å±‚<code>Task</code>è¢«å–æ¶ˆï¼Œ<code>await</code>ä¹‹å‰çš„ä»£ç å·²æ‰§è¡Œå®Œæ¯•ï¼Œ<code>await</code>å†…çš„é€»è¾‘ä¹Ÿä¼šä¼˜å…ˆå®Œæˆæ ¸å¿ƒæ¸…ç†å·¥ä½œ</li>
</ol>
<h2 data-id="heading-8">å»¶ä¼¸çŸ¥è¯†ç‚¹ï¼šSwift Task ç”Ÿå‘½å‘¨æœŸæ·±åº¦è§£æ</h2>
<h3 data-id="heading-9">1. Task çš„ä¸‰ç§æ ¸å¿ƒåˆ›å»ºæ–¹å¼</h3>

























<table><thead><tr><th>åˆ›å»ºæ–¹å¼</th><th>ç‰¹æ€§</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>ç»“æ„åŒ–å¹¶å‘ï¼ˆæ¨èï¼‰<code>Task { /* ä»£ç  */ }</code></td><td>ç»§æ‰¿å½“å‰ä¸Šä¸‹æ–‡ï¼ˆActorã€ä¼˜å…ˆçº§ã€å–æ¶ˆçŠ¶æ€ç­‰ï¼‰</td><td>å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ï¼Œä¾èµ–å½“å‰ä¸Šä¸‹æ–‡çš„å¼‚æ­¥æ“ä½œ</td></tr><tr><td>éç»“æ„åŒ–å¹¶å‘<code>Task.detached { /* ä»£ç  */ }</code></td><td>æ‹¥æœ‰ç‹¬ç«‹æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸ç»§æ‰¿å½“å‰ç¯å¢ƒ</td><td>æ— éœ€ä¾èµ–å½“å‰ä¸Šä¸‹æ–‡çš„ç‹¬ç«‹å¼‚æ­¥ä»»åŠ¡</td></tr><tr><td>æŒ‡å®š Actor æ‰§è¡Œ<code>Task { @MainActor in /* ä»£ç  */ }</code></td><td>ç»‘å®šæŒ‡å®š Actorï¼ˆå¦‚ä¸»çº¿ç¨‹ï¼‰æ‰§è¡Œï¼Œè‡ªåŠ¨å¤„ç†çº¿ç¨‹åˆ‡æ¢</td><td>ç›´æ¥æ›´æ–° UI æˆ–æ“ä½œ Actor å†…çŠ¶æ€çš„åœºæ™¯</td></tr></tbody></table>
<h3 data-id="heading-10">2. Task çš„å–æ¶ˆæ£€æŸ¥ç‚¹</h3>
<p><code>Task</code>ä»…åœ¨ç‰¹å®šæ—¶æœºè‡ªåŠ¨æ£€æŸ¥å–æ¶ˆçŠ¶æ€ï¼Œéæ£€æŸ¥ç‚¹å†…çš„é•¿æ—¶é—´åŒæ­¥ä»£ç ä¼šæ— è§†å–æ¶ˆæŒ‡ä»¤ï¼Œå¯¼è‡´ä»»åŠ¡ â€œæ— æ³•ç»ˆæ­¢â€ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-comment">// âœ… è‡ªåŠ¨æ£€æŸ¥å–æ¶ˆçŠ¶æ€çš„æ—¶æœº</span>
    <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> someAsyncOperation() <span class="hljs-comment">// å¼‚æ­¥ç­‰å¾…æ—¶è‡ªåŠ¨æ£€æŸ¥</span>
    <span class="hljs-keyword">try</span> <span class="hljs-type">Task</span>.checkCancellation()   <span class="hljs-comment">// æ‰‹åŠ¨ä¸»åŠ¨æ£€æŸ¥å–æ¶ˆçŠ¶æ€</span>
    <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.yield()             <span class="hljs-comment">// è®©å‡ºæ‰§è¡Œæƒæ—¶è‡ªåŠ¨æ£€æŸ¥</span>
    
    <span class="hljs-comment">// âŒ ä¸æ£€æŸ¥å–æ¶ˆçŠ¶æ€çš„åœºæ™¯</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">1000000</span> {
        <span class="hljs-comment">// é•¿æ—¶é—´åŒæ­¥å¾ªç¯ï¼Œä¸ä¼šå“åº”å–æ¶ˆæŒ‡ä»¤</span>
        heavySyncWork(i)
    }
}
</code></pre>
<h3 data-id="heading-11">3. å¤šä»»åŠ¡ç®¡ç†ï¼šTaskGroup çš„ä½¿ç”¨</h3>
<p>å½“éœ€è¦å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡å¹¶ç»Ÿä¸€ç®¡ç†æ—¶ï¼Œ<code>TaskGroup</code>æ˜¯æœ€ä¼˜é€‰æ‹©ï¼Œå¯å®ç°æ‰¹é‡ä»»åŠ¡æ·»åŠ ã€ç»“æœæ±‡æ€»ã€æ‰¹é‡å–æ¶ˆç­‰åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">await</span> withTaskGroup(of: <span class="hljs-type">Result</span>.<span class="hljs-keyword">self</span>) { group <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// æ‰¹é‡æ·»åŠ ä»»åŠ¡</span>
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items {
        group.addTask {
            <span class="hljs-keyword">await</span> processItem(item)
        }
    }
    
    <span class="hljs-comment">// æŒ‰éœ€æ‰¹é‡å–æ¶ˆæ‰€æœ‰ä»»åŠ¡ï¼ˆå¦‚æŸä¸ªä»»åŠ¡å¤±è´¥æ—¶ï¼‰</span>
    <span class="hljs-comment">// group.cancelAll()</span>
    
    <span class="hljs-comment">// éå†è·å–æ‰€æœ‰ä»»åŠ¡ç»“æœ</span>
    <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> result <span class="hljs-keyword">in</span> group {
        handleTaskResult(result)
    }
}
</code></pre>
<h2 data-id="heading-12">æœ€ä½³å®è·µæ€»ç»“</h2>
<h3 data-id="heading-13">âœ… æ¨èåšæ³•</h3>
<ol>
<li>UI æ›´æ–°ä¼˜å…ˆä½¿ç”¨<code>await MainActor.run</code>ï¼ŒåŒæ­¥æ‰§è¡Œç¡®ä¿é€»è¾‘å¯é </li>
<li>åšå†³é¿å…åœ¨<code>defer</code>å—ä¸­åˆ›å»ºæ–°çš„å¼‚æ­¥<code>Task</code>ï¼Œè§„é¿è°ƒåº¦ä¸ä¸Šä¸‹æ–‡é£é™©</li>
<li>ä¼˜å…ˆé‡‡ç”¨ç»“æ„åŒ–å¹¶å‘ï¼ˆé»˜è®¤<code>Task</code>ï¼‰ç®¡ç†ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸï¼Œç®€åŒ–ä¸Šä¸‹æ–‡ç»§æ‰¿</li>
<li>åœ¨é•¿æ—¶é—´å¼‚æ­¥æµç¨‹ä¸­ï¼Œä¸»åŠ¨æ·»åŠ å–æ¶ˆæ£€æŸ¥ç‚¹ï¼ˆ<code>try Task.checkCancellation()</code>ï¼‰</li>
<li>å¤šä»»åŠ¡å¹¶è¡Œåœºæ™¯ï¼Œä½¿ç”¨<code>TaskGroup</code>å®ç°ç»Ÿä¸€ç®¡ç†ä¸æ‰¹é‡æ§åˆ¶</li>
</ol>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æ ‡å‡†ä¼˜é›…çš„ä»£ç ç¤ºä¾‹</span>
<span class="hljs-type">Task</span> {
    <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šä¸»çº¿ç¨‹æ›´æ–°UIï¼ˆå¼€å¯åŠ è½½/æ›´æ–°çŠ¶æ€ï¼‰</span>
    <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
        updateUI()
    }
    
    <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œæ ¸å¿ƒå¼‚æ­¥ä¸šåŠ¡é€»è¾‘</span>
    <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> processData()
    
    <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šä¸»çº¿ç¨‹åŒæ­¥æ›´æ–°ç»“æœ/å…³é—­åŠ è½½</span>
    <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
        showResult(result)
    }
}
</code></pre>
<h3 data-id="heading-14">âŒ é¿å…åšæ³•</h3>
<ol>
<li>åœ¨<code>defer</code>ä¸­åˆ›å»ºå¼‚æ­¥<code>Task</code>æ‰§è¡Œæ¸…ç†æˆ– UI æ›´æ–°æ“ä½œ</li>
<li>ä¸»è§‚å‡è®¾å¼‚æ­¥ä»»åŠ¡ä¼šè¢« â€œç«‹å³è°ƒåº¦æ‰§è¡Œâ€</li>
<li>å¿½ç•¥<code>Task</code>çš„å–æ¶ˆçŠ¶æ€ï¼Œå¯¼è‡´é•¿æ—¶é—´ä»»åŠ¡æ— æ³•ç»ˆæ­¢</li>
<li>æ»¥ç”¨<code>Task.detached</code>ï¼ˆéç»“æ„åŒ–å¹¶å‘ï¼‰ï¼Œå¢åŠ ä¸Šä¸‹æ–‡ç®¡ç†æˆæœ¬</li>
<li>ç›´æ¥åœ¨éä¸»çº¿ç¨‹<code>Task</code>ä¸­ä¿®æ”¹<code>@State</code>ç­‰ UI ç›¸å…³çŠ¶æ€</li>
</ol>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ éœ€åšå†³è§„é¿çš„ä¸è‰¯ä»£ç </span>
<span class="hljs-keyword">defer</span> {
    <span class="hljs-type">Task</span> { <span class="hljs-meta">@MainActor</span> <span class="hljs-keyword">in</span>
        cleanup()  <span class="hljs-comment">// å¯èƒ½å› è°ƒåº¦å»¶è¿Ÿæˆ–ä¸Šä¸‹æ–‡é”€æ¯è€Œæ— æ³•æ‰§è¡Œ</span>
    }
}
</code></pre>
<h2 data-id="heading-15">å®ç”¨è°ƒè¯•æŠ€å·§</h2>
<h3 data-id="heading-16">1. æ—¥å¿—è¿½è¸ªï¼šæ˜ç¡®ä»£ç æ‰§è¡Œæ—¶åº</h3>
<p>é€šè¿‡æ·»åŠ æœ‰åºæ—¥å¿—ï¼Œå¯å¿«é€Ÿå®šä½<code>defer</code>ä¸<code>Task</code>çš„æ‰§è¡Œé¡ºåºï¼Œæ’æŸ¥æ˜¯å¦å­˜åœ¨å¼‚æ­¥ä»»åŠ¡æœªæ‰§è¡Œçš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"1. å¤–å±‚Taskå¼€å§‹æ‰§è¡Œ"</span>)
    <span class="hljs-keyword">defer</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"2. deferå—å¼€å§‹æ‰§è¡Œ"</span>)
    }
    
    <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"3. MainActor.runå†…UIæ“ä½œæ‰§è¡Œ"</span>)
    }
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"4. å¤–å±‚Taskå³å°†ç»“æŸ"</span>)
}
</code></pre>
<h3 data-id="heading-17">2. ä¸»åŠ¨æ£€æŸ¥ï¼šç¡®è®¤ Task å–æ¶ˆçŠ¶æ€</h3>
<p>åœ¨å…³é”®ä¸šåŠ¡èŠ‚ç‚¹ä¸»åŠ¨æ£€æŸ¥ä»»åŠ¡å–æ¶ˆçŠ¶æ€ï¼Œå¯æå‰ç»ˆæ­¢æ— æ•ˆé€»è¾‘ï¼Œé¿å…èµ„æºæµªè´¹ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-comment">// å…³é”®èŠ‚ç‚¹æ£€æŸ¥å–æ¶ˆçŠ¶æ€</span>
    <span class="hljs-keyword">if</span> <span class="hljs-type">Task</span>.isCancelled {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä»»åŠ¡å·²è¢«å–æ¶ˆï¼Œç»ˆæ­¢åç»­æ“ä½œ"</span>)
        <span class="hljs-keyword">return</span>
    }
    
    <span class="hljs-comment">// ç»§ç»­æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span>
    <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> processBusiness()
}
</code></pre>
<h3 data-id="heading-18">3. ä¼˜å…ˆçº§æ§åˆ¶ï¼šç¡®ä¿å…³é”®ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œ</h3>
<p>é€šè¿‡æŒ‡å®š<code>Task</code>ä¼˜å…ˆçº§ï¼Œå¯è®©æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚æ”¯ä»˜ç»“æœå¤„ç†ã€åŠ è½½åŠ¨ç”»å…³é—­ï¼‰ä¼˜å…ˆè¢«ç³»ç»Ÿè°ƒåº¦ï¼Œå‡å°‘æ‰§è¡Œå»¶è¿Ÿã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// é«˜ä¼˜å…ˆçº§ï¼šç”¨æˆ·ä¸»åŠ¨è§¦å‘çš„æ ¸å¿ƒæ“ä½œ</span>
<span class="hljs-type">Task</span>(priority: .userInitiated) {
    <span class="hljs-keyword">await</span> processPayment()
}

<span class="hljs-comment">// ä½ä¼˜å…ˆçº§ï¼šåå°æ— å…³ç´§è¦çš„è¾…åŠ©æ“ä½œ</span>
<span class="hljs-type">Task</span>(priority: .utility) {
    <span class="hljs-keyword">await</span> syncLocalData()
}
</code></pre>
<h2 data-id="heading-19">ç»“è¯­ï¼šè®© Swift å¹¶å‘ä»£ç æ›´å¯é </h2>
<p>Swift å¹¶å‘ç¼–ç¨‹çš„æ ¸å¿ƒéš¾ç‚¹ï¼Œåœ¨äºç†è§£åŒæ­¥æ“ä½œä¸å¼‚æ­¥æ“ä½œçš„æ‰§è¡Œè¾¹ç•Œï¼Œä»¥åŠ<code>Task</code>çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚<code>defer</code>è¯­å¥çš„ â€œåŒæ­¥å¯é æ€§â€ ä¸<code>Task</code>çš„ â€œå¼‚æ­¥è°ƒåº¦æ€§â€ å½¢æˆçš„åå·®ï¼Œæ˜¯å¯¼è‡´åŠ è½½åŠ¨ç”»æ— æ³•å…³é—­çš„æ ¹æœ¬åŸå› ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œåªè¦éµå¾ª â€œé¿å…<code>defer</code>å†…åµŒå¥—å¼‚æ­¥ä»»åŠ¡â€â€œä¼˜å…ˆä½¿ç”¨<code>await MainActor.run</code>æ›´æ–° UIâ€â€œé‡‡ç”¨ç»“æ„åŒ–å¹¶å‘ç®¡ç†ä»»åŠ¡â€ çš„åŸåˆ™ï¼Œå°±èƒ½æœ‰æ•ˆé¿å¼€è¿™ç±»éšå½¢é™·é˜±ï¼Œè®©ä»£ç ä» â€œåº”è¯¥ä¼šå·¥ä½œâ€ å˜æˆ â€œå¿…ç„¶ä¼šå·¥ä½œâ€ï¼Œæ„å»ºæ›´ç¨³å®šã€æ›´å¯é çš„å¹¶å‘é€»è¾‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift å¤šçº¿ç¨‹é€šå…³æŒ‡å—ï¼šä» GCD å›è°ƒåœ°ç‹±åˆ° Task/Actor èººèµ¢]]></title>    <link>https://juejin.cn/post/7589454621719117874</link>    <guid>https://juejin.cn/post/7589454621719117874</guid>    <pubDate>2025-12-30T08:32:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589454621719117874" data-draft-id="7589509638339756058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift å¤šçº¿ç¨‹é€šå…³æŒ‡å—ï¼šä» GCD å›è°ƒåœ°ç‹±åˆ° Task/Actor èººèµ¢"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2025-12-30T08:32:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JQShan"/> <meta itemprop="url" content="https://juejin.cn/user/1636535083759005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift å¤šçº¿ç¨‹é€šå…³æŒ‡å—ï¼šä» GCD å›è°ƒåœ°ç‹±åˆ° Task/Actor èººèµ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1636535083759005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JQShan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:32:13.000Z" title="Tue Dec 30 2025 08:32:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å„ä½ iOS å¼€å‘è€…å®å­ä»¬ï¼Œè°è¿˜æ²¡è¢«å¤šçº¿ç¨‹æŠ˜ç£¨è¿‡ï¼Ÿæƒ³å½“å¹´ç”¨ GCD çš„æ—¶å€™ï¼Œå›è°ƒåµŒå¥—åƒå¥—å¨ƒï¼Œçº¿ç¨‹å®‰å…¨åƒèµ°é’¢ä¸ï¼ŒæŸ¥ä¸ªæ•°æ®é”™ä¹±çš„ Bug èƒ½ç†¬åˆ°åŠå¤œå‘é™…çº¿åç§»ã€‚ç›´åˆ° Swift 5.5 ç”©å‡ºäº†ã€Œå¹¶å‘æ¡†æ¶ã€è¿™ä¸ªç‹ç‚¸ï¼ŒTask å’Œ Actor é—ªäº®ç™»åœºï¼Œæ‰è®©æˆ‘ä»¬æ‘†è„±äº† â€œå¤šçº¿ç¨‹ PUAâ€ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡åšå®¢ï¼Œå’±ä»¬å°±ç”¨ â€œå” å—‘å¼â€ é£æ ¼ï¼ŒæŠŠ Taskã€Actor çš„åŸç†ã€ç”¨æ³•ã€æœ€ä½³å®è·µå’Œé¿å‘æŒ‡å—è®²å¾—æ˜æ˜ç™½ç™½ï¼Œä¿è¯ä½ çœ‹å¾—æ‡‚ã€ç”¨å¾—ä¸Šï¼Œè¿˜èƒ½é¡ºä¾¿ç¬‘å‡ºå£°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å‰è¨€ï¼šé‚£äº›å¹´æˆ‘ä»¬è¸©è¿‡çš„ GCD å‘</h2>
<p>åœ¨èŠæ–°ä¸œè¥¿ä¹‹å‰ï¼Œå…ˆæ‰å¿ƒå›é¡¾ä¸€ä¸‹ GCD çš„ â€œç½ªè¡Œâ€ï¼š</p>
<ol>
<li><strong>å›è°ƒåœ°ç‹±</strong>ï¼šè¯·æ±‚æ¥å£â†’è§£ææ•°æ®â†’æ›´æ–° UIï¼Œä¸‰å±‚åµŒå¥—ä¸‹å»ï¼Œä»£ç åƒä¿„ç½—æ–¯å¥—å¨ƒï¼ŒåæœŸç»´æŠ¤çœ‹ä¸€çœ¼å°±è„‘å£³ç–¼ï¼›</li>
<li><strong>çº¿ç¨‹å®‰å…¨ç„å­¦</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªå˜é‡ï¼Œæ—¶è€Œæ­£å¸¸æ—¶è€Œå´©æºƒï¼Œæ•°æ®é”™ä¹±çš„ Bug æŸ¥åŠå¤©ï¼Œæœ€åå‘ç°æ˜¯å¿˜äº†åŠ <code>dispatch_barrier</code>ï¼›</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸå¤±æ§</strong>ï¼šæ‰‹åŠ¨åˆ›å»ºçš„é˜Ÿåˆ—å’Œä»»åŠ¡ï¼Œä¸€ä¸å°å¿ƒå°±å¿˜è®°å–æ¶ˆï¼Œå¯¼è‡´å†…å­˜æ³„æ¼æˆ–æ— æ•ˆæ“ä½œï¼›</li>
<li><strong>ä¸»çº¿ç¨‹åˆ¤æ–­éº»çƒ¦</strong>ï¼šæ›´æ–° UI å‰è¿˜è¦å†™<code>if Thread.isMainThread</code>ï¼Œç¨ä¸æ³¨æ„å°±é—ªé€€ã€‚</li>
</ol>
<p>ç›´åˆ° Swift å¹¶å‘æ¡†æ¶ä¸Šçº¿ï¼ŒTaskï¼ˆå¼‚æ­¥ä»»åŠ¡åŒ…å·¥å¤´ï¼‰å’Œ Actorï¼ˆçº¿ç¨‹å®‰å…¨ç®¡ç†å‘˜ï¼‰å¼ºå¼ºè”æ‰‹ï¼Œæ‰è®©å¤šçº¿ç¨‹å¼€å‘ä» â€œæ¸¡åŠ«â€ å˜æˆ â€œèººèµ¢â€ã€‚æ¥ä¸‹æ¥ï¼Œå’±ä»¬é€ä¸ªæ‹†è§£è¿™ä¸¤ä¸ªæ ¸å¿ƒç©å®¶ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒç©å®¶ 1ï¼šTask â€”â€” å¼‚æ­¥ä»»åŠ¡çš„ â€œåŒ…å·¥å¤´â€</h2>
<h3 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ Taskï¼Ÿé€šä¿—ç‚¹è¯´å°±æ˜¯ â€œå¹²æ´»çš„åŒ…å·¥å¤´â€</h3>
<p>ä½ å¯ä»¥æŠŠ Task ç†è§£ä¸ºä¸€ä¸ªåŒ…å·¥å¤´ï¼Œä½ ç»™å®ƒåˆ†é…æ´»ï¼ˆå¼‚æ­¥ä»£ç ï¼‰ï¼Œå®ƒä¼šå¸®ä½ å®‰æ’å·¥äººï¼ˆçº¿ç¨‹ï¼‰å»å¹²ï¼Œè¿˜èƒ½å‘Šè¯‰ä½ å•¥æ—¶å€™å¹²å®Œï¼ˆé€šè¿‡<code>await</code>ç­‰å¾…ç»“æœï¼‰ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>å°è£…å¼‚æ­¥æ“ä½œ</strong>ï¼Œæ‘†è„± GCD çš„é—­åŒ…åµŒå¥—ï¼Œè®©å¼‚æ­¥ä»£ç åƒåŒæ­¥ä»£ç ä¸€æ ·çº¿æ€§ä¹¦å†™ â€”â€” è¿™ä¹Ÿæ˜¯ Swift å¹¶å‘çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š<strong>å¼‚æ­¥ä»£ç åŒæ­¥åŒ–</strong>ã€‚</p>
<h3 data-id="heading-3">2. Task çš„æ ¸å¿ƒåŸç†ï¼šç»“æ„åŒ– vs éç»“æ„åŒ–ï¼ˆå®¶æ—ä¼ä¸š vs é‡ç”Ÿæ”¾å…»ï¼‰</h3>
<p>Task æœ‰ä¸¤ç§æ ¸å¿ƒå½¢æ€ï¼Œè¿™æ˜¯ç†è§£å®ƒçš„å…³é”®ï¼Œå’±ä»¬ç”¨æ¯”å–»è®²æ¸…æ¥šï¼š</p>
<h4 data-id="heading-4">ï¼ˆ1ï¼‰ç»“æ„åŒ–å¹¶å‘ï¼ˆé»˜è®¤ Taskï¼‰ï¼šå®¶æ—ä¼ä¸šï¼Œçˆ¶å­ç»‘å®š</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// ç»“æ„åŒ–Taskï¼šçˆ¶ä»»åŠ¡ï¼ˆåŒ…å·¥å¤´è€æ¿ï¼‰</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">parentTask</span>() <span class="hljs-keyword">async</span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"è€æ¿ï¼šæˆ‘è¦å®‰æ’ä¸ªå°å·¥å¹²æ´»"</span>)
    <span class="hljs-comment">// å­ä»»åŠ¡ï¼ˆå°å·¥ï¼‰ï¼šç»§æ‰¿çˆ¶ä»»åŠ¡çš„ä¸Šä¸‹æ–‡ï¼ˆä¼˜å…ˆçº§ã€å–æ¶ˆçŠ¶æ€ç­‰ï¼‰</span>
    <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å°å·¥ï¼šå¼€å§‹å¹²æ´»"</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(<span class="hljs-number">1_000_000_000</span>) <span class="hljs-comment">// å¹²æ´»1ç§’</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ´»å¹²å®Œäº†"</span>
    }.value
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"è€æ¿ï¼šå°å·¥æ±‡æŠ¥ç»“æœï¼š(result)"</span>)
}
</code></pre>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼ˆå®¶æ—ä¼ä¸šè§„åˆ™ï¼‰</strong> ï¼š</p>
<ul>
<li>çˆ¶ä»»åŠ¡ä¼šç­‰å­ä»»åŠ¡å¹²å®Œæ‰ç»§ç»­æ‰§è¡Œï¼ˆè€æ¿ç­‰å°å·¥æ±‡æŠ¥ï¼‰ï¼›</li>
<li>å­ä»»åŠ¡ç»§æ‰¿çˆ¶ä»»åŠ¡çš„ â€œå®¶åº•â€ï¼šä¼˜å…ˆçº§ã€Actor ä¸Šä¸‹æ–‡ã€å–æ¶ˆçŠ¶æ€ç­‰ï¼›</li>
<li>çˆ¶ä»»åŠ¡è¢«å–æ¶ˆï¼Œå­ä»»åŠ¡ä¼šè·Ÿç€è¢«å–æ¶ˆï¼ˆè€æ¿è·‘è·¯ï¼Œå°å·¥ä¹Ÿåœå·¥ï¼‰ï¼›</li>
<li>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç®¡ç†ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸï¼Œä¸ç”¨æ‰‹åŠ¨æ“å¿ƒå†…å­˜æ³„æ¼ã€‚</li>
</ul>
<p>è¿™æ˜¯ Swift å®˜æ–¹<strong>å¼ºçƒˆæ¨è</strong>çš„ç”¨æ³•ï¼Œä¹Ÿæ˜¯æœ€å®‰å…¨ã€æœ€çœå¿ƒçš„æ–¹å¼ã€‚</p>
<h4 data-id="heading-5">ï¼ˆ2ï¼‰éç»“æ„åŒ–å¹¶å‘ï¼ˆTask.detachedï¼‰ï¼šé‡ç”Ÿæ”¾å…»ï¼Œè‡ªç”Ÿè‡ªç­</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// éç»“æ„åŒ–Taskï¼šé‡ç”ŸåŒ…å·¥å¤´ï¼Œå’Œä½ æ²¡å…³ç³»</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">wildTask</span>() {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æˆ‘ï¼šå®‰æ’ä¸ªé‡ç”ŸåŒ…å·¥å¤´å¹²æ´»"</span>)
    <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> <span class="hljs-type">Task</span>.detached {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"é‡ç”ŸåŒ…å·¥å¤´ï¼šè‡ªå·±å¹²è‡ªå·±çš„"</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(<span class="hljs-number">1_000_000_000</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"é‡ç”Ÿæ´»å¹²å®Œäº†"</span>
    }
    
    <span class="hljs-comment">// æƒ³æ‹¿ç»“æœå¾—ä¸»åŠ¨ç­‰</span>
    <span class="hljs-type">Task</span> {
        <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> task.value
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æˆ‘ï¼šé‡ç”ŸåŒ…å·¥å¤´æ±‡æŠ¥ç»“æœï¼š(result)"</span>)
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼ˆé‡ç”Ÿè§„åˆ™ï¼‰</strong> ï¼š</p>
<ul>
<li>ä¸ç»§æ‰¿ä»»ä½•ä¸Šä¸‹æ–‡ï¼ˆä¼˜å…ˆçº§ã€Actor ç­‰éƒ½æ˜¯é»˜è®¤å€¼ï¼‰ï¼›</li>
<li>å’Œåˆ›å»ºå®ƒçš„çº¿ç¨‹ / ä»»åŠ¡ â€œæ–­ç»å…³ç³»â€ï¼Œçˆ¶ä¸ç®¡å­ï¼Œå­ä¸è®¤çˆ¶ï¼›</li>
<li>ç”Ÿå‘½å‘¨æœŸå®Œå…¨ç”±ä½ æ‰‹åŠ¨ç®¡ç†ï¼Œå¿˜è®°å–æ¶ˆå°±å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼›</li>
<li>ä»…é€‚ç”¨äº â€œä¸éœ€è¦ä¾èµ–å½“å‰ä¸Šä¸‹æ–‡ï¼Œå®Œå…¨ç‹¬ç«‹çš„ä»»åŠ¡â€ï¼ˆæ¯”å¦‚åå°åŒæ­¥æ—¥å¿—ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">3. Task çš„ 3 ç§å¸¸ç”¨åˆ›å»ºæ–¹å¼ï¼ˆä»£ç ç¤ºä¾‹ + åœºæ™¯ï¼‰</h3>

























<table><thead><tr><th>åˆ›å»ºæ–¹å¼</th><th>ä»£ç ç¤ºä¾‹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>ç»“æ„åŒ– Taskï¼ˆé»˜è®¤ï¼‰</td><td><code>Task { await doSomething() }</code></td><td>å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ï¼ˆæ¥å£è¯·æ±‚ã€æ•°æ®å¤„ç†ç­‰ï¼‰ï¼Œä¾èµ–å½“å‰ä¸Šä¸‹æ–‡</td></tr><tr><td>éç»“æ„åŒ– Task</td><td><code>Task.detached { await doSomething() }</code></td><td>ç‹¬ç«‹åå°ä»»åŠ¡ï¼ˆæ—¥å¿—åŒæ­¥ã€ç¼“å­˜æ¸…ç†ç­‰ï¼‰ï¼Œä¸ä¾èµ–å½“å‰ä¸Šä¸‹æ–‡</td></tr><tr><td>æŒ‡å®š Actor Task</td><td><code>Task { @MainActor in updateUI() }</code></td><td>ç›´æ¥åˆ‡æ¢åˆ°æŒ‡å®š Actorï¼ˆå¦‚ MainActor æ›´æ–° UIï¼‰</td></tr></tbody></table>
<h3 data-id="heading-7">4. Task çš„å°çŸ¥è¯†ç‚¹ï¼ˆå¿…çŸ¥å¿…ä¼šï¼‰</h3>
<ul>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼šå¯ä»¥ç»™ Task æŒ‡å®šä¼˜å…ˆçº§ï¼Œç³»ç»Ÿä¼šä¼˜å…ˆè°ƒåº¦é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆæ¯”å¦‚æ”¯ä»˜ï¼åå°åŒæ­¥ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// é«˜ä¼˜å…ˆçº§ï¼šç”¨æˆ·ä¸»åŠ¨æ“ä½œ</span>
<span class="hljs-type">Task</span>(priority: .userInitiated) {
    <span class="hljs-keyword">await</span> processPayment()
}
<span class="hljs-comment">// ä½ä¼˜å…ˆçº§ï¼šåå°è¾…åŠ©æ“ä½œ</span>
<span class="hljs-type">Task</span>(priority: .utility) {
    <span class="hljs-keyword">await</span> syncLocalCache()
}
</code></pre>
<ul>
<li><strong>å–æ¶ˆ</strong>ï¼šTask çš„å–æ¶ˆæ˜¯ â€œåä½œå¼â€ çš„ï¼ˆä¸æ˜¯å¼ºåˆ¶æªæ¯™ï¼Œæ˜¯æé†’ä»»åŠ¡è‡ªå·±åœå·¥ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> <span class="hljs-type">Task</span> {
    <span class="hljs-comment">// å¹²æ´»å‰å…ˆæ£€æŸ¥æ˜¯å¦è¢«å–æ¶ˆ</span>
    <span class="hljs-keyword">if</span> <span class="hljs-type">Task</span>.isCancelled {
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">await</span> doSomething()
    <span class="hljs-comment">// å¹²æ´»ä¸­é€”ä¹Ÿå¯ä»¥æ£€æŸ¥</span>
    <span class="hljs-keyword">try</span> <span class="hljs-type">Task</span>.checkCancellation()
    <span class="hljs-keyword">await</span> doSomethingElse()
}
<span class="hljs-comment">// æ‰‹åŠ¨å–æ¶ˆä»»åŠ¡</span>
task.cancel()
</code></pre>
<ul>
<li><strong>ç­‰å¾…ç»“æœ</strong>ï¼šç”¨<code>await task.value</code>å¯ä»¥è·å– Task çš„æ‰§è¡Œç»“æœï¼Œç»“æ„åŒ– Task ä¹Ÿå¯ä»¥ç›´æ¥å†…è”ç­‰å¾…ã€‚</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒç©å®¶ 2ï¼šActor â€”â€” çº¿ç¨‹å®‰å…¨çš„ â€œå«ç”Ÿé—´ç®¡ç†å‘˜â€</h2>
<h3 data-id="heading-9">1. çº¿ç¨‹å®‰å…¨çš„ç—›ç‚¹ï¼šå¤šä¸ªäººæŠ¢å«ç”Ÿé—´çš„å™©æ¢¦</h3>
<p>å…ˆæƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ å’ŒåŒäº‹ä»¬å…±ç”¨ä¸€ä¸ªå«ç”Ÿé—´ï¼ˆå…±äº«å˜é‡ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ç®¡ç†å‘˜ï¼Œå¤§å®¶åŒæ—¶æŒ¤è¿›å»ï¼Œåœºé¢ä¼šæåº¦æ··ä¹±ï¼ˆæ•°æ®é”™ä¹±ã€å´©æºƒï¼‰ã€‚</p>
<p>åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œè¿™ä¸ª â€œå«ç”Ÿé—´â€ å°±æ˜¯å…±äº«å˜é‡ï¼ˆæ¯”å¦‚<code>var userList: [User]</code>ï¼‰ï¼Œâ€œæŠ¢å«ç”Ÿé—´â€ å°±æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™è¿™ä¸ªå˜é‡ï¼Œè¿™ä¹Ÿæ˜¯ GCD ä¸­æœ€å¤´ç–¼çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-10">2. ä»€ä¹ˆæ˜¯ Actorï¼Ÿé€šä¿—ç‚¹è¯´å°±æ˜¯ â€œå«ç”Ÿé—´ç®¡ç†å‘˜â€</h3>
<p>Actor çš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>ä¿è¯çº¿ç¨‹å®‰å…¨</strong>ï¼Œå®ƒå°±åƒä¸€ä¸ªä¸¥æ ¼çš„å«ç”Ÿé—´ç®¡ç†å‘˜ï¼Œéµå®ˆä¸€ä¸ªé“å¾‹ï¼š<strong>ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹ï¼ˆäººï¼‰è¿›å…¥ Actor çš„ â€œç§äººç©ºé—´â€ï¼ˆå†…éƒ¨å±æ€§å’Œæ–¹æ³•ï¼‰</strong> ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œå°±ä»æ ¹æœ¬ä¸Šæœç»äº† â€œå¤šçº¿ç¨‹åŒæ—¶è¯»å†™å…±äº«å˜é‡â€ çš„é—®é¢˜ï¼Œä¸ç”¨å†æ‰‹åŠ¨åŠ é”ã€åŠ å±éšœï¼Œç¼–è¯‘å™¨ä¼šå¸®ä½ æå®šä¸€åˆ‡ã€‚</p>
<h3 data-id="heading-11">3. Actor çš„æ ¸å¿ƒåŸç†ï¼šéš”ç¦»åŸŸ + æ¶ˆæ¯ä¼ é€’</h3>
<p>Actor çš„åº•å±‚åŸç†å…¶å®å¾ˆç®€å•ï¼Œå°±ä¸¤ä¸ªå…³é”®ç‚¹ï¼Œå’±ä»¬ç”¨å¤§ç™½è¯è§£é‡Šï¼š</p>
<h4 data-id="heading-12">ï¼ˆ1ï¼‰éš”ç¦»åŸŸï¼ˆç§äººç©ºé—´ï¼‰</h4>
<p>æ¯ä¸ª Actor éƒ½æœ‰è‡ªå·±çš„ â€œéš”ç¦»åŸŸâ€ï¼Œç›¸å½“äºå«ç”Ÿé—´çš„å›´å¢™ï¼Œå¤–éƒ¨çº¿ç¨‹æ— æ³•ç›´æ¥è®¿é—® Actor å†…éƒ¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡ç®¡ç†å‘˜ï¼ˆActorï¼‰ä¼ é€’æ¶ˆæ¯ã€‚</p>
<p>æ¯”å¦‚ä½ ä¸èƒ½ç›´æ¥å†™<code>actor.userList = []</code>ï¼Œç¼–è¯‘å™¨ä¼šç›´æ¥æŠ¥é”™ â€”â€” è¿™å°±åƒä½ ä¸èƒ½ç›´æ¥è¸¹å¼€å«ç”Ÿé—´é—¨ï¼Œåªèƒ½è·Ÿç®¡ç†å‘˜è¯´ â€œæˆ‘è¦è¿›å»â€ã€‚</p>
<h4 data-id="heading-13">ï¼ˆ2ï¼‰æ¶ˆæ¯ä¼ é€’ï¼ˆæ’é˜Ÿå«å·ï¼‰</h4>
<p>å¤–éƒ¨çº¿ç¨‹æƒ³è¦æ“ä½œ Actor çš„å†…éƒ¨èµ„æºï¼Œéœ€è¦ç»™ Actor å‘é€ â€œæ¶ˆæ¯â€ï¼ˆè°ƒç”¨ Actor çš„æ–¹æ³•ï¼‰ï¼ŒActor ä¼šæŠŠè¿™äº›æ¶ˆæ¯æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åä¸²è¡Œå¤„ç†ï¼ˆä¸€ä¸ªæ¥ä¸€ä¸ªï¼Œä¸æ’é˜Ÿï¼‰ã€‚</p>
<p>è¿™å°±åƒä½ è·Ÿç®¡ç†å‘˜è¯´ â€œæˆ‘è¦è¿›å»â€ï¼Œç®¡ç†å‘˜ä¼šæŠŠä½ æ’åˆ°é˜Ÿå°¾ï¼Œç­‰å‰é¢çš„äººå‡ºæ¥ï¼Œå†è®©ä½ è¿›å»ï¼Œå®Œç¾ä¿è¯äº†å®‰å…¨ã€‚</p>
<h3 data-id="heading-14">4. Actor çš„ä½¿ç”¨æ–¹æ³•ï¼ˆä»£ç ç¤ºä¾‹ + åœºæ™¯ï¼‰</h3>
<h4 data-id="heading-15">ï¼ˆ1ï¼‰è‡ªå®šä¹‰ Actorï¼šåˆ›å»ºä½ çš„ â€œå«ç”Ÿé—´ç®¡ç†å‘˜â€</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªActorï¼šç”¨æˆ·åˆ—è¡¨ç®¡ç†å‘˜</span>
<span class="hljs-keyword">actor</span> <span class="hljs-title class_">UserManager</span> {
    <span class="hljs-comment">// å†…éƒ¨å…±äº«å˜é‡ï¼ˆå«ç”Ÿé—´ï¼‰ï¼šå¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> userList: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
    
    <span class="hljs-comment">// æä¾›æ–¹æ³•ï¼ˆå«å·æœåŠ¡ï¼‰ï¼šå¤–éƒ¨å¯ä»¥é€šè¿‡awaitè°ƒç”¨</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">addUser</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">name</span>: <span class="hljs-type">String</span>) {
        <span class="hljs-comment">// è¿™é‡Œçš„ä»£ç ä¸²è¡Œæ‰§è¡Œï¼Œç»å¯¹çº¿ç¨‹å®‰å…¨</span>
        userList.append(name)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ·»åŠ ç”¨æˆ·ï¼š(name)ï¼Œå½“å‰åˆ—è¡¨ï¼š(userList)"</span>)
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">getUserList</span>() -&gt; [<span class="hljs-type">String</span>] {
        <span class="hljs-keyword">return</span> userList
    }
}

<span class="hljs-comment">// ä½¿ç”¨Actor</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">useUserManager</span>() <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// åˆ›å»ºActorå®ä¾‹</span>
    <span class="hljs-keyword">let</span> manager <span class="hljs-operator">=</span> <span class="hljs-type">UserManager</span>()
    
    <span class="hljs-comment">// è°ƒç”¨Actoræ–¹æ³•ï¼šå¿…é¡»åŠ awaitï¼ˆç­‰ç®¡ç†å‘˜å«å·ï¼‰</span>
    <span class="hljs-keyword">await</span> manager.addUser(<span class="hljs-string">"å¼ ä¸‰"</span>)
    <span class="hljs-keyword">await</span> manager.addUser(<span class="hljs-string">"æå››"</span>)
    
    <span class="hljs-comment">// è·å–ç”¨æˆ·åˆ—è¡¨</span>
    <span class="hljs-keyword">let</span> list <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> manager.getUserList()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ç»ˆç”¨æˆ·åˆ—è¡¨ï¼š(list)"</span>)
}
</code></pre>
<p><strong>å…³é”®æ³¨æ„ç‚¹</strong>ï¼šè°ƒç”¨ Actor çš„ä»»ä½•æ–¹æ³•éƒ½å¿…é¡»åŠ <code>await</code>ï¼Œå› ä¸º Actor å¤„ç†æ¶ˆæ¯éœ€è¦æ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚</p>
<h4 data-id="heading-16">ï¼ˆ2ï¼‰MainActorï¼šä¸“å±ä¸»çº¿ç¨‹çš„ â€œUI ç®¡ç†å‘˜â€</h4>
<p>é™¤äº†è‡ªå®šä¹‰ Actorï¼ŒSwift è¿˜æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„ Actorâ€”â€”<code>MainActor</code>ï¼Œå®ƒä¸“é—¨ç»‘å®šä¸»çº¿ç¨‹ï¼Œæ˜¯æ›´æ–° UI çš„ â€œä¸“å±é€šé“â€ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒUI æ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œä»¥å‰ç”¨ GCD è¦å†™<code>dispatch_async(dispatch_get_main_queue())</code>ï¼Œç°åœ¨ç”¨<code>MainActor</code>æ›´ç®€å•ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æ–¹å¼1ï¼šä¿®é¥°å‡½æ•°ï¼Œæ•´ä¸ªå‡½æ•°åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</span>
<span class="hljs-meta">@MainActor</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">updateUserName</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">name</span>: <span class="hljs-type">String</span>) {
    <span class="hljs-comment">// è¿™é‡Œçš„ä»£ç ä¸€å®šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œæ”¾å¿ƒæ›´æ–°UI</span>
    <span class="hljs-keyword">self</span>.userNameLabel.text <span class="hljs-operator">=</span> name
}

<span class="hljs-comment">// æ–¹å¼2ï¼šä¿®é¥°å±æ€§ï¼Œå±æ€§çš„è¯»å†™éƒ½åœ¨ä¸»çº¿ç¨‹</span>
<span class="hljs-meta">@MainActor</span> <span class="hljs-keyword">var</span> userAvatar: <span class="hljs-type">UIImage</span>?

<span class="hljs-comment">// æ–¹å¼3ï¼šåœ¨Taskä¸­æŒ‡å®šMainActor</span>
<span class="hljs-type">Task</span> { <span class="hljs-meta">@MainActor</span> <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">self</span>.userNameLabel.text <span class="hljs-operator">=</span> <span class="hljs-string">"å¼ ä¸‰"</span>
}

<span class="hljs-comment">// æ–¹å¼4ï¼šawait MainActor.run å±€éƒ¨åˆ‡æ¢ä¸»çº¿ç¨‹</span>
<span class="hljs-type">Task</span> {
    <span class="hljs-comment">// åå°æ‰§è¡Œè€—æ—¶æ“ä½œ</span>
    <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> fetchUser()
    <span class="hljs-comment">// åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI</span>
    <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
        <span class="hljs-keyword">self</span>.userNameLabel.text <span class="hljs-operator">=</span> user.name
    }
}
</code></pre>
<p><strong>MainActor æ˜¯ UI æ›´æ–°çš„é¦–é€‰</strong>ï¼Œä¸ç”¨å†æ‰‹åŠ¨åˆ¤æ–­ä¸»çº¿ç¨‹ï¼Œç¼–è¯‘å™¨ä¼šå¸®ä½ ä¿è¯ UI æ“ä½œåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œæœç»é—ªé€€ã€‚</p>
<h3 data-id="heading-17">5. Actor çš„å°çŸ¥è¯†ç‚¹ï¼ˆå¿…çŸ¥å¿…ä¼šï¼‰</h3>
<ul>
<li><strong>Actor é‡å…¥</strong>ï¼šActor å…è®¸ â€œåµŒå¥—è°ƒç”¨â€ï¼Œæ¯”å¦‚ Actor çš„æ–¹æ³• A è°ƒç”¨äº†æ–¹æ³• Bï¼Œè¿™æ˜¯å…è®¸çš„ï¼Œä¸”ä»ç„¶ä¸²è¡Œæ‰§è¡Œï¼›</li>
<li><strong>Actor é—´é€šä¿¡</strong>ï¼šå¤šä¸ª Actor ä¹‹é—´è°ƒç”¨æ–¹æ³•ï¼ŒåŒæ ·éœ€è¦åŠ <code>await</code>ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†æ¶ˆæ¯ä¼ é€’ï¼›</li>
<li><strong>ä¸å¯å˜å±æ€§</strong>ï¼šActor çš„ä¸å¯å˜å±æ€§ï¼ˆ<code>let</code>ï¼‰å¯ä»¥ç›´æ¥è®¿é—®ï¼ˆä¸ç”¨<code>await</code>ï¼‰ï¼Œå› ä¸ºä¸å¯å˜å±æ€§ä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-18">å››ã€é»„é‡‘æ­æ¡£ï¼šTask + Actor å®æˆ˜æ¼”ç»ƒ</h2>
<p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œå’±ä»¬ç»“åˆå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œçœ‹çœ‹ Task å’Œ Actor æ€ä¹ˆé…åˆä½¿ç”¨ï¼š</p>
<h3 data-id="heading-19">åœºæ™¯ï¼šæ¥å£è¯·æ±‚ + æ•°æ®è§£æ + UI æ›´æ–°ï¼ˆçº¿ç¨‹å®‰å…¨ç‰ˆï¼‰</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// 1. å®šä¹‰æ•°æ®å­˜å‚¨Actorï¼ˆä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰</span>
<span class="hljs-keyword">actor</span> <span class="hljs-title class_">DataStore</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> userData: <span class="hljs-type">UserModel</span>?
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">saveUser</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">user</span>: <span class="hljs-type">UserModel</span>) {
        userData <span class="hljs-operator">=</span> user
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">getUser</span>() -&gt; <span class="hljs-type">UserModel</span>? {
        <span class="hljs-keyword">return</span> userData
    }
}

<span class="hljs-comment">// 2. æ¥å£è¯·æ±‚å‡½æ•°ï¼ˆåå°æ‰§è¡Œï¼‰</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchUserFromAPI</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">UserModel</span> {
    <span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£è¯·æ±‚ï¼ˆåå°çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(<span class="hljs-number">1_000_000_000</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-type">UserModel</span>(name: <span class="hljs-string">"æå››"</span>, age: <span class="hljs-number">25</span>)
}

<span class="hljs-comment">// 3. æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆTask + Actor + MainActorï¼‰</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">loadUserData</span>() {
    <span class="hljs-comment">// ç»“æ„åŒ–Taskï¼šç®¡ç†å¼‚æ­¥æµç¨‹</span>
    <span class="hljs-type">Task</span> {
        <span class="hljs-keyword">do</span> {
            <span class="hljs-comment">// æ­¥éª¤1ï¼šä¸»çº¿ç¨‹æ˜¾ç¤ºåŠ è½½åŠ¨ç”»</span>
            <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
                <span class="hljs-keyword">self</span>.loadingView.isHidden <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
            }
            
            <span class="hljs-comment">// æ­¥éª¤2ï¼šåå°è¯·æ±‚æ¥å£ï¼ˆéä¸»çº¿ç¨‹ï¼Œä¸å¡é¡¿UIï¼‰</span>
            <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchUserFromAPI()
            
            <span class="hljs-comment">// æ­¥éª¤3ï¼šçº¿ç¨‹å®‰å…¨å­˜å‚¨æ•°æ®</span>
            <span class="hljs-keyword">let</span> dataStore <span class="hljs-operator">=</span> <span class="hljs-type">DataStore</span>()
            <span class="hljs-keyword">await</span> dataStore.saveUser(user)
            
            <span class="hljs-comment">// æ­¥éª¤4ï¼šä¸»çº¿ç¨‹æ›´æ–°UI + éšè—åŠ è½½åŠ¨ç”»</span>
            <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
                <span class="hljs-keyword">self</span>.userNameLabel.text <span class="hljs-operator">=</span> user.name
                <span class="hljs-keyword">self</span>.ageLabel.text <span class="hljs-operator">=</span> <span class="hljs-string">"(user.age)"</span>
                <span class="hljs-keyword">self</span>.loadingView.isHidden <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
            }
            
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-comment">// å¼‚å¸¸å¤„ç†ï¼šä¸»çº¿ç¨‹éšè—åŠ è½½åŠ¨ç”» + æç¤ºé”™è¯¯</span>
            <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
                <span class="hljs-keyword">self</span>.loadingView.isHidden <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
                <span class="hljs-keyword">self</span>.toastLabel.text <span class="hljs-operator">=</span> <span class="hljs-string">"è¯·æ±‚å¤±è´¥ï¼š(error.localizedDescription)"</span>
            }
        }
    }
}
</code></pre>
<p>è¿™ä¸ªç¤ºä¾‹å®Œç¾ç»“åˆäº† Taskï¼ˆå¼‚æ­¥æµç¨‹ç®¡ç†ï¼‰ã€Actorï¼ˆæ•°æ®å­˜å‚¨çº¿ç¨‹å®‰å…¨ï¼‰ã€MainActorï¼ˆUI æ›´æ–°ï¼‰ï¼Œæ²¡æœ‰å›è°ƒåµŒå¥—ï¼Œçº¿ç¨‹å®‰å…¨æœ‰ä¿éšœï¼ŒUI ä¸å¡é¡¿ï¼Œè¿™å°±æ˜¯ Swift å¹¶å‘çš„æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼</p>
<h2 data-id="heading-20">äº”ã€æœ€ä½³å®è·µï¼šå°‘è¸©å‘ï¼Œå¤šæ‘¸é±¼</h2>
<p>æŒæ¡äº†åŸç†å’Œç”¨æ³•ï¼Œæ¥ä¸‹æ¥çš„æœ€ä½³å®è·µèƒ½è®©ä½ åœ¨å®é™…å¼€å‘ä¸­äº‹åŠåŠŸå€ï¼Œå°‘èµ°å¼¯è·¯ï¼š</p>
<h3 data-id="heading-21">1. ä¼˜å…ˆä½¿ç”¨ç»“æ„åŒ– Taskï¼Œæ‹’ç»æ”¾å…»å¼ Task.detached</h3>
<p>ç»“æ„åŒ– Task çš„ç”Ÿå‘½å‘¨æœŸç”±ç¼–è¯‘å™¨ç®¡ç†ï¼Œå®‰å…¨çœå¿ƒï¼Œ90% çš„åœºæ™¯éƒ½ç”¨å®ƒã€‚åªæœ‰åœ¨éœ€è¦å®Œå…¨ç‹¬ç«‹çš„åå°ä»»åŠ¡ï¼ˆå¦‚æ—¥å¿—åŒæ­¥ï¼‰æ—¶ï¼Œæ‰è€ƒè™‘ Task.detachedï¼Œä¸”ä¸€å®šè¦æ‰‹åŠ¨ç®¡ç†å–æ¶ˆã€‚</p>
<h3 data-id="heading-22">2. UI æ›´æ–°è®¤å‡† MainActorï¼Œåˆ«åœ¨åå°çæŠ˜è…¾</h3>
<p>æ— è®ºç”¨<code>@MainActor</code>ä¿®é¥°å‡½æ•°ã€è¿˜æ˜¯<code>await MainActor.run</code>ï¼Œéƒ½è¦ä¿è¯ UI æ“ä½œåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œè¿™æ˜¯æœç» UI é—ªé€€å’Œå¡é¡¿çš„å…³é”®ã€‚</p>
<h3 data-id="heading-23">3. Actor é‡Œåªæ”¾çº¿ç¨‹ä¸å®‰å…¨çš„çŠ¶æ€ï¼Œåˆ«å•¥éƒ½å¾€é‡Œå¡</h3>
<p>Actor çš„æ–¹æ³•æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œå¦‚æœæŠŠéå…±äº«çš„ã€ä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„é€»è¾‘ä¹Ÿæ”¾è¿› Actorï¼Œä¼šé™ä½æ‰§è¡Œæ•ˆç‡ã€‚Actor åªè´Ÿè´£ç®¡ç† â€œå…±äº«å¯å˜çŠ¶æ€â€ï¼ˆå¦‚ç”¨æˆ·åˆ—è¡¨ã€ç¼“å­˜æ•°æ®ï¼‰ã€‚</p>
<h3 data-id="heading-24">4. ç”¨ TaskGroup ç®¡ç†å¤šä»»åŠ¡ï¼Œæ‰¹é‡æ§åˆ¶æ›´çœå¿ƒ</h3>
<p>å¦‚æœéœ€è¦å¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼ˆå¦‚æ‰¹é‡è¯·æ±‚æ¥å£ï¼‰ï¼Œç”¨<code>TaskGroup</code>æ¯”æ‰‹åŠ¨åˆ›å»ºå¤šä¸ª Task æ›´æ–¹ä¾¿ï¼Œæ”¯æŒæ‰¹é‡æ·»åŠ ã€æ‰¹é‡å–æ¶ˆã€æ‰¹é‡è·å–ç»“æœï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">await</span> withTaskGroup(of: <span class="hljs-type">UserModel</span>.<span class="hljs-keyword">self</span>) { group <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// æ‰¹é‡æ·»åŠ ä»»åŠ¡</span>
    <span class="hljs-keyword">for</span> userId <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] {
        group.addTask {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> fetchUserById(userId)
        }
    }
    
    <span class="hljs-comment">// æ‰¹é‡è·å–ç»“æœ</span>
    <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> user <span class="hljs-keyword">in</span> group {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–åˆ°ç”¨æˆ·ï¼š(user.name)"</span>)
    }
}
</code></pre>
<h3 data-id="heading-25">5. defer é‡Œåˆ«ä¹±åˆ› Taskï¼Œå°å¿ƒ â€œå¹½çµä»»åŠ¡â€</h3>
<p>è¿™æ˜¯å’±ä»¬ä¹‹å‰è¸©è¿‡çš„å‘ï¼š<code>defer</code>å—é‡Œåˆ›å»ºçš„å¼‚æ­¥ Taskï¼Œå¯èƒ½å› ä¸ºä¸Šä¸‹æ–‡é”€æ¯è€Œæ— æ³•æ‰§è¡Œï¼ˆæ¯”å¦‚é¡µé¢å…³é—­åï¼ŒTask è¿˜æ²¡è¢«è°ƒåº¦ï¼‰ï¼Œå¯¼è‡´åŠ è½½åŠ¨ç”»å…³ä¸æ‰ã€èµ„æºæ¸…ç†ä¸å½»åº•ã€‚</p>
<h3 data-id="heading-26">6. å…³é”®èŠ‚ç‚¹æ£€æŸ¥ Task å–æ¶ˆçŠ¶æ€ï¼Œé¿å…æ— æ•ˆæ“ä½œ</h3>
<p>å¦‚æœç”¨æˆ·ä¸­é€”é€€å‡ºé¡µé¢ï¼Œå¯¹åº”çš„ Task åº”è¯¥è¢«å–æ¶ˆï¼Œåœ¨è€—æ—¶æ“ä½œå‰åæ£€æŸ¥<code>Task.isCancelled</code>æˆ–<code>try Task.checkCancellation()</code>ï¼Œå¯ä»¥åŠæ—¶ç»ˆæ­¢æ— æ•ˆæ“ä½œï¼ŒèŠ‚çœèµ„æºã€‚</p>
<h2 data-id="heading-27">å…­ã€é¿å‘æŒ‡å—ï¼šé‚£äº›è®©ä½ å¤´ç§ƒçš„å‘</h2>
<p>å³ä½¿æŒæ¡äº†æœ€ä½³å®è·µï¼Œä¹Ÿéš¾å…è¸©å‘ï¼Œè¿™äº›å‘ä½ ä¸€å®šè¦è­¦æƒ•ï¼š</p>
<h3 data-id="heading-28">1. å‘ 1ï¼šActor é‡å…¥ â€”â€” çœ‹ä¼¼ä¸²è¡Œï¼Œå®åˆ™å¯èƒ½åµŒå¥—æ‰§è¡Œ</h3>
<p>Actor å…è®¸æ–¹æ³•åµŒå¥—è°ƒç”¨ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">actor</span> <span class="hljs-title class_">MyActor</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">methodA</span>() <span class="hljs-keyword">async</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Aå¼€å§‹"</span>)
        <span class="hljs-keyword">await</span> methodB()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Aç»“æŸ"</span>)
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">methodB</span>() <span class="hljs-keyword">async</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Bæ‰§è¡Œ"</span>)
    }
}
</code></pre>
<p>è°ƒç”¨<code>await myActor.methodA()</code>æ—¶ï¼Œä¼šè¾“å‡º â€œA å¼€å§‹â†’B æ‰§è¡Œâ†’A ç»“æŸâ€ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œä¸”ä»ç„¶çº¿ç¨‹å®‰å…¨ï¼Œä¸ç”¨è¿‡åº¦æ‹…å¿ƒã€‚</p>
<h3 data-id="heading-29">2. å‘ 2ï¼šTask å–æ¶ˆæ˜¯ â€œåä½œå¼â€ï¼Œä¸æ˜¯ â€œå¼ºåˆ¶æªæ¯™â€</h3>
<p>Task ä¸ä¼šè¢«å¼ºåˆ¶ç»ˆæ­¢ï¼Œåªæœ‰åœ¨ â€œå–æ¶ˆæ£€æŸ¥ç‚¹â€ æ‰ä¼šå“åº”å–æ¶ˆï¼š</p>
<ul>
<li>âœ… å–æ¶ˆæ£€æŸ¥ç‚¹ï¼š<code>await</code>å¼‚æ­¥æ“ä½œã€<code>try Task.checkCancellation()</code>ã€<code>await Task.yield()</code></li>
<li>âŒ éæ£€æŸ¥ç‚¹ï¼šé•¿æ—¶é—´åŒæ­¥å¾ªç¯ï¼ˆå¦‚<code>for i in 0..&lt;1000000</code>ï¼‰ï¼Œä¸ä¼šå“åº”å–æ¶ˆ</li>
</ul>
<p>å¦‚æœæœ‰é•¿æ—¶é—´åŒæ­¥ä»£ç ï¼Œè¦æ‰‹åŠ¨æ’å…¥å–æ¶ˆæ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">1000000</span> {
        <span class="hljs-comment">// æ‰‹åŠ¨æ£€æŸ¥å–æ¶ˆçŠ¶æ€</span>
        <span class="hljs-keyword">if</span> <span class="hljs-type">Task</span>.isCancelled {
            <span class="hljs-keyword">return</span>
        }
        heavySyncWork(i)
    }
}
</code></pre>
<h3 data-id="heading-30">3. å‘ 3ï¼šåœ¨ MainActor å‡½æ•°é‡Œæ‰§è¡Œè€—æ—¶æ“ä½œï¼Œå¯¼è‡´ UI å¡é¡¿</h3>
<p><code>@MainActor</code>ä¿®é¥°çš„å‡½æ•°ä¼šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå¦‚æœåœ¨é‡Œé¢æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚å¤§æ•°æ®è§£æã€å¤æ‚åŠ å¯†ï¼‰ï¼Œä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´ UI å¡é¡¿ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯åšæ³•ï¼šä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶è§£æ</span>
<span class="hljs-meta">@MainActor</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">parseLargeData</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) {
    <span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-keyword">try!</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">LargeModel</span>.<span class="hljs-keyword">self</span>, from: data)
    <span class="hljs-keyword">self</span>.model <span class="hljs-operator">=</span> model
}

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•ï¼šåå°è§£æï¼Œä¸»çº¿ç¨‹æ›´æ–°UI</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">loadLargeData</span>() {
    <span class="hljs-type">Task</span> {
        <span class="hljs-comment">// åå°è§£æ</span>
        <span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.detached {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">try!</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">LargeModel</span>.<span class="hljs-keyword">self</span>, from: data)
        }.value
        
        <span class="hljs-comment">// ä¸»çº¿ç¨‹æ›´æ–°UI</span>
        <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
            <span class="hljs-keyword">self</span>.model <span class="hljs-operator">=</span> model
        }
    }
}
</code></pre>
<h3 data-id="heading-31">4. å‘ 4ï¼šç›´æ¥è®¿é—® Actor çš„å±æ€§ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™</h3>
<p>Actor çš„å±æ€§æ˜¯éš”ç¦»çš„ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®ï¼Œå¿…é¡»é€šè¿‡æ–¹æ³•è·å–ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯åšæ³•ï¼šç›´æ¥è®¿é—®Actorå±æ€§</span>
<span class="hljs-keyword">let</span> manager <span class="hljs-operator">=</span> <span class="hljs-type">UserManager</span>()
<span class="hljs-built_in">print</span>(manager.userList) <span class="hljs-comment">// ç¼–è¯‘å™¨æŠ¥é”™</span>

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•ï¼šé€šè¿‡Actoræ–¹æ³•è·å–</span>
<span class="hljs-keyword">let</span> list <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> manager.getUserList()
<span class="hljs-built_in">print</span>(list)
</code></pre>
<h3 data-id="heading-32">5. å‘ 5ï¼šéç»“æ„åŒ– Task å¿˜è®°å–æ¶ˆï¼Œå¯¼è‡´å†…å­˜æ³„æ¼</h3>
<p>Task.detached åˆ›å»ºçš„ä»»åŠ¡å¦‚æœæŒæœ‰äº†<code>self</code>ï¼Œä¸”å¿˜è®°å–æ¶ˆï¼Œä¼šå¯¼è‡´<code>self</code>æ— æ³•é‡Šæ”¾ï¼Œå†…å­˜æ³„æ¼ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯åšæ³•ï¼šå¿˜è®°å–æ¶ˆTask</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">badTask</span>() {
    <span class="hljs-type">Task</span>.detached { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
        <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span> {
            <span class="hljs-keyword">await</span> <span class="hljs-keyword">self</span>.syncLog()
            <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(<span class="hljs-number">10_000_000_000</span>)
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•ï¼šæ‰‹åŠ¨æŒæœ‰Taskï¼Œåœ¨åˆé€‚æ—¶æœºå–æ¶ˆ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyVC</span>: <span class="hljs-title class_">UIViewController</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> syncTask: <span class="hljs-type">Task</span>&lt;<span class="hljs-type">Void</span>, <span class="hljs-type">Never</span>&gt;?
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
        <span class="hljs-keyword">super</span>.viewDidLoad()
        syncTask <span class="hljs-operator">=</span> <span class="hljs-type">Task</span>.detached { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
            <span class="hljs-keyword">while</span> <span class="hljs-operator">!</span><span class="hljs-type">Task</span>.isCancelled {
                <span class="hljs-keyword">await</span> <span class="hljs-keyword">self</span>.syncLog()
                <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(<span class="hljs-number">10_000_000_000</span>)
            }
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewWillDisappear</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">animated</span>: <span class="hljs-type">Bool</span>) {
        <span class="hljs-keyword">super</span>.viewWillDisappear(animated)
        <span class="hljs-comment">// é¡µé¢æ¶ˆå¤±æ—¶å–æ¶ˆä»»åŠ¡</span>
        syncTask<span class="hljs-operator">?</span>.cancel()
    }
}
</code></pre>
<h2 data-id="heading-33">ä¸ƒã€æ€»ç»“ï¼šSwift å¤šçº¿ç¨‹çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</h2>
<ol>
<li><strong>å‘Šåˆ« GCD å›è°ƒåœ°ç‹±</strong>ï¼šç”¨ Task æŠŠå¼‚æ­¥ä»£ç å†™æˆåŒæ­¥é£æ ¼ï¼Œçº¿æ€§ä¹¦å†™ï¼Œæ˜“è¯»æ˜“ç»´æŠ¤ï¼›</li>
<li><strong>å‘Šåˆ«çº¿ç¨‹å®‰å…¨ç„å­¦</strong>ï¼šç”¨ Actorï¼ˆå°¤å…¶æ˜¯ MainActorï¼‰ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä¸ç”¨æ‰‹åŠ¨åŠ é”ï¼›</li>
<li><strong>ä¼˜å…ˆç»“æ„åŒ–å¹¶å‘</strong>ï¼š90% çš„åœºæ™¯ç”¨é»˜è®¤ Taskï¼Œå°‘ç”¨ Task.detachedï¼Œé¿å…ç”Ÿå‘½å‘¨æœŸå¤±æ§ï¼›</li>
<li><strong>UI æ›´æ–°è®¤å‡† MainActor</strong>ï¼šæ— è®ºæ˜¯<code>@MainActor</code>è¿˜æ˜¯<code>await MainActor.run</code>ï¼Œä¿è¯ UI åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼›</li>
<li><strong>å…³é”®èŠ‚ç‚¹æ£€æŸ¥å–æ¶ˆ</strong>ï¼šåœ¨è€—æ—¶æ“ä½œå‰åæ£€æŸ¥ Task å–æ¶ˆçŠ¶æ€ï¼Œé¿å…æ— æ•ˆæ“ä½œï¼›</li>
<li><strong>ç”¨ TaskGroup ç®¡ç†å¤šä»»åŠ¡</strong>ï¼šæ‰¹é‡æ·»åŠ ã€æ‰¹é‡å–æ¶ˆï¼Œæ•ˆç‡æ›´é«˜ã€‚</li>
</ol>
<p>Swift çš„ Task å’Œ Actor ä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒä»¬ç¡®å®è®©å¤šçº¿ç¨‹å¼€å‘å˜å¾—æ›´ç®€å•ã€æ›´å®‰å…¨ã€‚ä» GCD è¿‡æ¸¡åˆ° Swift å¹¶å‘æ¡†æ¶ï¼Œå¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œä½ ä¼šå‘ç°æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ â€”â€” åŸæ¥å¤šçº¿ç¨‹å¼€å‘ä¹Ÿå¯ä»¥è¿™ä¹ˆè½»æ¾ï¼</p>
<p>æœ€åï¼Œé€å¤§å®¶ä¸€å¥è¯ï¼š<strong>å¤šçº¿ç¨‹ä¸å¯æ€•ï¼Œåªè¦ç”¨å¥½ Task å’Œ Actorï¼Œä½ ä¹Ÿèƒ½èººèµ¢ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android ä½å»¶è¿Ÿæµåª’ä½“æ’­æ”¾å™¨å®æˆ˜ï¼šåŸºäº FFmpeg 6.1.1 çš„ RTSP/RTMP è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7589275237038243875</link>    <guid>https://juejin.cn/post/7589275237038243875</guid>    <pubDate>2025-12-30T07:33:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589275237038243875" data-draft-id="7589509638339330074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android ä½å»¶è¿Ÿæµåª’ä½“æ’­æ”¾å™¨å®æˆ˜ï¼šåŸºäº FFmpeg 6.1.1 çš„ RTSP/RTMP è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-30T07:33:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å±æ¯"/> <meta itemprop="url" content="https://juejin.cn/user/861643816574349"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android ä½å»¶è¿Ÿæµåª’ä½“æ’­æ”¾å™¨å®æˆ˜ï¼šåŸºäº FFmpeg 6.1.1 çš„ RTSP/RTMP è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/861643816574349/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å±æ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:33:36.000Z" title="Tue Dec 30 2025 07:33:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åš Android æµåª’ä½“å¼€å‘çš„åŒå­¦åº”è¯¥éƒ½æ‡‚ï¼ŒåŸç”Ÿ<code>MediaPlayer</code>ç®€ç›´æ˜¯ â€œç—›ç‚¹é›†åˆä½“â€â€”â€” å»¶è¿Ÿé«˜åˆ°æ²¡æ³•å¿ã€åè®®æ”¯æŒæ‰è¥Ÿè§è‚˜ï¼Œç¬¬ä¸‰æ–¹æ’­æ”¾å™¨è¦ä¹ˆä½“ç§¯è‡ƒè‚¿ï¼Œè¦ä¹ˆå®šåˆ¶åŒ–èƒ½åŠ›å·®ï¼Œæƒ³åšä¸ªä½å»¶è¿Ÿã€æ”¯æŒå¤šè·¯æ’­æ”¾è¿˜èƒ½è‡ªå®šä¹‰å¤„ç†å¸§æ•°æ®çš„åŠŸèƒ½ï¼Œæ€»å¾—è¸©ä¸€å †å‘ã€‚</p>
<p>æœ€è¿‘åŸºäº FFmpeg 6.1.1 å°è£…äº†ä¸€æ¬¾è½»é‡çº§æµåª’ä½“æ’­æ”¾å™¨<code>FFmpegStreamPlayer</code>ï¼Œè§£å†³äº†é¡¹ç›®ä¸­é‡åˆ°çš„ä½å»¶è¿Ÿã€å¤šæµå¹¶å‘ã€YUV å¸§è‡ªå®šä¹‰å¤„ç†ç­‰æ ¸å¿ƒé—®é¢˜ï¼Œä»Šå¤©è·Ÿå¤§å®¶èŠèŠè¿™æ¬¾æ’­æ”¾å™¨çš„æ ¸å¿ƒä»·å€¼ã€é€‚ç”¨åœºæ™¯ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒèƒ½é€‚é…å¤§éƒ¨åˆ†å®‰å“æµåª’ä½“å¼€å‘éœ€æ±‚ã€‚</p>
<p>åº”ç”¨æˆªå›¾ï¼š</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f21e59efe914e86b435cc43ab04d217~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bGP5oGv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684895&amp;x-signature=uLaNEC1e4s6DVwYXKy14xNW3Zsk%3D" alt="MuMu-20251011-153144-611.png" width="30%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0df56d75f1824ba791efdb46973c5c9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bGP5oGv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684895&amp;x-signature=ym8t4g181nRJUz%2FHOimdAICbse4%3D" alt="MuMu-20251011-155352-156.png" width="30%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcd8d8ea8fe242ce959ebe3003490930~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bGP5oGv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684895&amp;x-signature=jymlRem9xQItZrb5BWdTDutBLkA%3D" alt="MuMu-20251218-104858-750.png" width="30%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/194ed87b0b934d9c9a061000d57db468~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bGP5oGv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684895&amp;x-signature=DvOQRfhsyXh8W5LeVouzrwq0B5k%3D" alt="MuMu-20251219-141657-940.png" width="30%" loading="lazy"/>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦è¿™æ¬¾æ’­æ”¾å™¨ï¼Ÿ</h2>
<p>å…ˆè¯´è¯´æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„çœŸå®ç—›ç‚¹ï¼š</p>
<ol>
<li><strong>åŸç”Ÿæ’­æ”¾å™¨å®Œå…¨ä¸å¤Ÿç”¨</strong>ï¼šåŸç”Ÿ<code>MediaPlayer</code>çš„å»¶è¿Ÿèƒ½åˆ° 300-800msï¼Œåšå®‰é˜²ç›‘æ§ã€å®æ—¶ç›´æ’­è¿™ç±»å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åœºæ™¯ï¼Œç”¨æˆ·ä½“éªŒç›´æ¥æ‹‰èƒ¯ï¼›è€Œä¸”å¯¹ RTSPã€HTTP-FLV è¿™ç±»åè®®çš„é€‚é…æ€§æå·®ï¼Œç»å¸¸å‡ºç°æ’­æ”¾å¡é¡¿ã€æ–­æµçš„æƒ…å†µã€‚</li>
<li><strong>ç¬¬ä¸‰æ–¹æ’­æ”¾å™¨çš„ â€œéšå½¢é—¨æ§›â€</strong> ï¼šå¸‚é¢ä¸Šä¸å°‘æ’­æ”¾å™¨è¦ä¹ˆåªæ”¯æŒå•ä¸€åè®®ï¼ˆæ¯”å¦‚åªåš RTMPï¼‰ï¼Œè¦ä¹ˆç¡¬ä»¶è§£ç é€‚é…å·®ï¼Œéƒ¨åˆ†æœºå‹ç›´æ¥é—ªé€€ï¼›è¿˜æœ‰çš„ä¸å¼€æºï¼Œæƒ³è‡ªå®šä¹‰å¤„ç† YUV å¸§ã€åŠ ä¸ª AI åˆ†æåŠŸèƒ½éƒ½æ— ä»ä¸‹æ‰‹ã€‚</li>
<li><strong>é¡¹ç›®çš„æ ¸å¿ƒè¯‰æ±‚æ²¡è¢«æ»¡è¶³</strong>ï¼šæˆ‘ä»¬åšå®‰é˜²é¡¹ç›®æ—¶ï¼Œéœ€è¦åŒæ—¶æ’­æ”¾ 16 è·¯ç›‘æ§æµã€å®æ—¶å½•åˆ¶ã€è·å– YUV å¸§åšäººè„¸æ£€æµ‹ï¼Œè¿˜è¦é€‚é… 16kb çš„ç‰¹æ®Šå±å¹• â€”â€” è¿™äº›éœ€æ±‚ï¼Œç°æˆçš„æ’­æ”¾å™¨è¦ä¹ˆåšä¸åˆ°ï¼Œè¦ä¹ˆéœ€è¦å¤§é‡äºŒæ¬¡å¼€å‘ã€‚</li>
</ol>
<p>åŸºäºè¿™äº›ç—›ç‚¹ï¼Œæ‰å°è£…äº†è¿™æ¬¾<code>FFmpegStreamPlayer</code>ï¼Œæ ¸å¿ƒå°±æ˜¯ â€œè§£å†³å®é™…é—®é¢˜â€ï¼Œè€Œä¸æ˜¯åšä¸€ä¸ª â€œèƒ½ç”¨ä½†ä¸å¥½ç”¨â€ çš„ç©å…·ã€‚</p>
<h2 data-id="heading-1">è¿™æ¬¾æ’­æ”¾å™¨çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-2">1. å®‰é˜²ç›‘æ§åœºæ™¯</h3>
<p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„åœºæ™¯ï¼šæ”¯æŒ RTSP åè®®ï¼ˆå®‰é˜²æ‘„åƒå¤´ä¸»æµåè®®ï¼‰ï¼Œæœ€é«˜ 16 è·¯æµåŒæ—¶æ’­æ”¾ï¼ˆå…·ä½“è·¯æ•°çœ‹è®¾å¤‡æ€§èƒ½ï¼‰ï¼Œç¡¬ä»¶è§£ç å»¶è¿Ÿ 80-120msï¼Œèƒ½å®æ—¶çœ‹åˆ°ç›‘æ§ç”»é¢ï¼›è¿˜æ”¯æŒè¾¹æ’­è¾¹å½•ï¼Œå½•åˆ¶çš„è§†é¢‘è´¨é‡æ— æŸï¼Œæ»¡è¶³å–è¯ã€å›æ”¾çš„éœ€æ±‚ã€‚</p>
<h3 data-id="heading-3">2. ç›´æ’­äº’åŠ¨åœºæ™¯</h3>
<p>ä¸ç®¡æ˜¯ RTMP è¿˜æ˜¯ HTTP-FLV åè®®çš„ç›´æ’­ï¼Œéƒ½èƒ½åšåˆ°è¶…ä½å»¶è¿Ÿæ’­æ”¾ â€”â€” ç¡¬ä»¶è§£ç  100ms çº§çš„å»¶è¿Ÿï¼Œæ¯”åŸç”Ÿæ’­æ”¾å™¨å¿« 3 å€ä»¥ä¸Šï¼Œé€‚åˆç›´æ’­å¸¦è´§ã€åœ¨çº¿æ•™è‚²è¿™ç±»éœ€è¦å®æ—¶äº’åŠ¨çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-4">3. æ™ºèƒ½åˆ†æ / è‡ªå®šä¹‰å¤„ç†åœºæ™¯</h3>
<p>è½¯ä»¶è§£ç æ¨¡å¼ä¸‹èƒ½è·å– YUV åŸå§‹å¸§ï¼Œæ”¯æŒä¸‰ç§å¤„ç†æ¨¡å¼ï¼š</p>
<ul>
<li>åªè¯»åˆ†æï¼ˆæ¯”å¦‚äººè„¸æ£€æµ‹ã€è¡Œä¸ºåˆ†æï¼‰ï¼Œä¸å½±å“æ­£å¸¸æ’­æ”¾ï¼›</li>
<li>å¤„ç†åæ¸²æŸ“ï¼ˆæ¯”å¦‚åŠ ç¾é¢œã€æ»¤é•œï¼‰ï¼›</li>
<li>å®Œå…¨æ¥ç®¡æ¸²æŸ“ï¼ˆè‡ªå·±ç”¨ OpenGL ç”»ï¼‰ã€‚åš AI æ¨ç†ã€è‡ªå®šä¹‰æ¸²æŸ“çš„åŒå­¦ï¼Œä¸ç”¨å†è‡ªå·±å°è£… FFmpeg çš„è§£ç é€»è¾‘ï¼Œç›´æ¥ç”¨ç°æˆçš„æ¥å£å°±è¡Œã€‚</li>
</ul>
<h3 data-id="heading-5">4. è½¦è½½ / å·¥æ§è®¾å¤‡åœºæ™¯</h3>
<p>ä¸“é—¨åšäº† 16kb é¡µé¢é€‚é…ï¼Œèƒ½å…¼å®¹è½¦è½½ã€å·¥æ§è¿™ç±»ç‰¹æ®Šå±å¹•ï¼›è€Œä¸”å®Œå–„çš„ç”Ÿå‘½å‘¨æœŸé€‚é…é€»è¾‘ï¼Œèƒ½å¤„ç†åº”ç”¨å‰åå°åˆ‡æ¢ã€Surface é”€æ¯ / åˆ›å»ºçš„æƒ…å†µï¼Œé¿å…è®¾å¤‡é•¿æ—¶é—´è¿è¡Œå‡ºç°å´©æºƒã€å†…å­˜æ³„æ¼ã€‚</p>
<h3 data-id="heading-6">5. é€šç”¨æµåª’ä½“æ’­æ”¾åœºæ™¯</h3>
<p>æ”¯æŒ RTSP/RTMP/HLS/HTTP-FLV/RTP/UDP/TCP ç­‰å‡ ä¹æ‰€æœ‰ä¸»æµåè®®ï¼Œä¸€å¥—ä»£ç å°±èƒ½é€‚é…ä¸åŒçš„æ’­æ”¾éœ€æ±‚ï¼Œä¸ç”¨ä¸ºä¸åŒåè®®é›†æˆä¸åŒçš„æ’­æ”¾å™¨ã€‚</p>
<h2 data-id="heading-7">ä½¿ç”¨è¿™æ¬¾æ’­æ”¾å™¨çš„æ ¸å¿ƒå¥½å¤„</h2>
<h3 data-id="heading-8">1. æè‡´ä½å»¶è¿Ÿï¼Œä½“éªŒæ‹‰æ»¡</h3>
<p>ç¡¬ä»¶è§£ç å»¶è¿Ÿ 80-120msï¼Œè½¯ä»¶è§£ç  120-200msï¼Œäº²æµ‹æ¯”åŸç”Ÿ<code>MediaPlayer</code>å¿« 3-5 å€ï¼›è€Œä¸”ç”¨äº†é›¶æ‹·è´æ¸²æŸ“ï¼ˆç›´æ¥å†…å­˜æ˜ å°„ï¼‰ï¼Œå‡å°‘å†…å­˜æ‹·è´çš„å¼€é”€ï¼Œæ’­æ”¾æ›´æµç•…ã€‚</p>
<h3 data-id="heading-9">2. çµæ´»çš„è§£ç  &amp; å®šåˆ¶åŒ–èƒ½åŠ›</h3>
<ul>
<li>ç¡¬ä»¶ / è½¯ä»¶è§£ç å¯é€‰ï¼šç¡¬ä»¶è§£ç è¿½æ±‚ä½å»¶è¿Ÿï¼Œè½¯ä»¶è§£ç æ”¯æŒ YUV å¸§è‡ªå®šä¹‰å¤„ç†ï¼›</li>
<li>YUV å¸§é›¶æ‹·è´å¤„ç†ï¼šç›´æ¥æ‹¿åˆ°<code>DirectByteBuffer</code>ï¼Œä¸ç”¨æ‹·è´æ•°æ®ï¼Œæ€§èƒ½æŸè€—å‡ ä¹å¯ä»¥å¿½ç•¥ï¼›</li>
<li>è‡ªå®šä¹‰æ¸²æŸ“ï¼šå®Œå…¨æ¥ç®¡æ¸²æŸ“é€»è¾‘ï¼Œæƒ³æ€ä¹ˆç”»å°±æ€ä¹ˆç”»ï¼Œé€‚é…å„ç§ä¸ªæ€§åŒ–éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-10">3. å¤šæµå¹¶å‘ + åè®®å…¨è¦†ç›–</h3>
<p>æœ€å¤š 16 è·¯æµåŒæ—¶æ’­æ”¾ï¼Œæ»¡è¶³å¤šè·¯ç›‘æ§ã€çŸ©é˜µå±ç­‰åœºæ™¯ï¼›RTSP/RTMP/HLS ç­‰ä¸»æµåè®®å…¨è¦†ç›–ï¼Œä¸ç”¨å†ä¸ºä¸åŒåè®®åšå…¼å®¹å¼€å‘ã€‚</p>
<h3 data-id="heading-11">4. ç¨³å®šçš„ç”Ÿå‘½å‘¨æœŸé€‚é…</h3>
<p>ä¸“é—¨å¤„ç†äº†<code>Surface</code>çš„åˆ›å»º / é”€æ¯ã€åº”ç”¨å‰åå°åˆ‡æ¢ã€æµçš„é”€æ¯ç­‰é€»è¾‘ï¼Œåªè¦æŒ‰æ–‡æ¡£åšå¥½ç”Ÿå‘½å‘¨æœŸé€‚é…ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°å´©æºƒã€é»‘å±ã€éŸ³è§†é¢‘ä¸åŒæ­¥çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-12">5. è½»é‡åŒ–é›†æˆ</h3>
<p>åŸºäº aar å°è£…ï¼ŒåªåŒ…å« arm64-v8a/armeabi-v7a/x86_64 ä¸‰ç§ä¸»æµæ¶æ„ï¼Œä½“ç§¯å¯æ§ï¼›é›†æˆæ–¹å¼ä¹Ÿç®€å•ï¼Œå‡ è¡Œä»£ç å°±èƒ½å¼•å…¥ï¼Œä¸ç”¨é…ç½®å¤æ‚çš„ NDK ç¯å¢ƒã€‚</p>
<h2 data-id="heading-13">å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ ¸å¿ƒä»£ç ç¤ºä¾‹ï¼‰</h2>
<h3 data-id="heading-14">1. å¼•å…¥åº“ + æ·»åŠ æƒé™</h3>
<p>kotlin</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">dependencies</span> {
    <span class="hljs-selector-tag">implementation</span>(<span class="hljs-built_in">fileTree</span>(<span class="hljs-built_in">mapOf</span>(<span class="hljs-string">"dir"</span> to <span class="hljs-string">"libs"</span>, <span class="hljs-string">"include"</span> to <span class="hljs-built_in">listOf</span>(<span class="hljs-string">"*.aar"</span>))))
}
</code></pre>
<p>xml</p>
<pre><code class="hljs language-ini" lang="ini">&lt;uses-permission android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.permission.INTERNET"</span> /&gt;
&lt;uses-permission android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;
</code></pre>
<h3 data-id="heading-15">2. åŸºæœ¬æ’­æ”¾é€»è¾‘</h3>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆ›å»ºæµï¼ˆç¡¬ä»¶è§£ç ï¼‰</span>
int streamId = FFmpegRTSPLibrary<span class="hljs-selector-class">.createStream</span>("rtsp://your-server/stream");
<span class="hljs-comment">// ç»‘å®šSurface</span>
FFmpegRTSPLibrary<span class="hljs-selector-class">.setSurface</span>(streamId, surfaceView.getHolder()<span class="hljs-selector-class">.getSurface</span>());
<span class="hljs-comment">// å¼‚æ­¥æ’­æ”¾</span>
FFmpegRTSPLibrary<span class="hljs-selector-class">.startPlayAsync</span>(streamId, callback);

<span class="hljs-comment">// åœæ­¢+é”€æ¯</span>
FFmpegRTSPLibrary<span class="hljs-selector-class">.stopPlayAsync</span>(streamId, callback);
FFmpegRTSPLibrary<span class="hljs-selector-class">.destroyStream</span>(streamId);
</code></pre>
<h3 data-id="heading-16">3. YUV å¸§å¤„ç†ï¼ˆAI åˆ†æåœºæ™¯ï¼‰</h3>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ³¨å†ŒYUVå¤„ç†å™¨ï¼ˆåªè¯»åˆ†ææ¨¡å¼ï¼‰</span>
<span class="hljs-title class_">FFmpegRTSPLibrary</span>.<span class="hljs-title function_">registerYUVProcessor</span>(streamId, <span class="hljs-keyword">new</span> <span class="hljs-title class_">IYUVFrameProcessor</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">YUVProcessMode</span> <span class="hljs-title function_">getProcessMode</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">YUVProcessMode</span>.<span class="hljs-property">OBSERVE_ONLY</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">YUVProcessResult</span> <span class="hljs-title function_">onProcessFrame</span>(<span class="hljs-params">YUVFrameInfo frame</span>) {
        <span class="hljs-comment">// æ‹¿åˆ°YUVåŸå§‹æ•°æ®åšAIæ¨ç†ï¼ˆæ¯”å¦‚äººè„¸æ£€æµ‹ï¼‰</span>
        <span class="hljs-comment">// frame.yBuffer/uBuffer/vBufferæ˜¯é›¶æ‹·è´DirectByteBuffer</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">YUVProcessResult</span>.<span class="hljs-title function_">passthrough</span>();
    }
});
</code></pre>
<h3 data-id="heading-17">4. å¿…åšçš„ç”Ÿå‘½å‘¨æœŸé€‚é…</h3>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">surfaceDestroyed</span>(<span class="hljs-params">SurfaceHolder holder</span>) {
    <span class="hljs-keyword">if</span> (currentStreamId &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-title class_">FFmpegRTSPLibrary</span>.<span class="hljs-title function_">onSurfaceDestroyed</span>(currentStreamId);
    }
}

<span class="hljs-meta">@Override</span> 
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onDestroy</span>();
    <span class="hljs-title class_">FFmpegRTSPLibrary</span>.<span class="hljs-title function_">destroyAllAsync</span>();
}
</code></pre>
<h2 data-id="heading-18">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>YUV å›è°ƒåœ¨è§£ç çº¿ç¨‹æ‰§è¡Œï¼Œè€—æ—¶æ“ä½œï¼ˆæ¯”å¦‚ AI æ¨ç†ï¼‰ä¸€å®šè¦å¼‚æ­¥å¤„ç†ï¼Œé¿å…é˜»å¡è§£ç ï¼›</li>
<li>YUV çš„ Buffer ä»…åœ¨å›è°ƒæœŸé—´æœ‰æ•ˆï¼Œä¸è¦ç¼“å­˜å¤ç”¨ï¼Œå¦åˆ™ä¼šå‡ºç°æ•°æ®é”™ä¹±ï¼›</li>
<li>å¤šæµæ’­æ”¾æ—¶è¦æ ¹æ®è®¾å¤‡æ€§èƒ½è°ƒæ•´è·¯æ•°ï¼Œä¸­ä½ç«¯æœºå‹å»ºè®®é€‚å½“å‡å°‘å¹¶å‘è·¯æ•°ï¼›</li>
</ol>
<h2 data-id="heading-19">æœ€å</h2>
<p>è¿™æ¬¾æ’­æ”¾å™¨æ˜¯ä»å®é™…é¡¹ç›®ä¸­æ²‰æ·€å‡ºæ¥çš„ï¼Œæ²¡æœ‰èŠ±é‡Œèƒ¡å“¨çš„åŠŸèƒ½ï¼Œæ ¸å¿ƒå°±æ˜¯è§£å†³ â€œä½å»¶è¿Ÿã€å¤šåè®®ã€å¯å®šåˆ¶â€ è¿™ä¸‰ä¸ªæ ¸å¿ƒç—›ç‚¹ã€‚ç›®å‰é¡¹ç›®é•¿æœŸç»´æŠ¤ï¼Œæœ‰å®šåˆ¶åŒ–éœ€æ±‚ï¼ˆæ¯”å¦‚è£å‰ªç‰¹å®šæ¶æ„ã€æ–°å¢åŠŸèƒ½ï¼‰å¯ä»¥è”ç³»ä½œè€…ï¼Œä¹Ÿå¯ä»¥åŠ  QQ ç¾¤ 647718711 äº¤æµé—®é¢˜ã€‚</p>
<p>é¡¹ç›®åœ°å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanwz0611%2Fandroid-ffmpeg-stream-player" target="_blank" title="https://github.com/anwz0611/android-ffmpeg-stream-player" ref="nofollow noopener noreferrer">ï¼šhttps://github.com/anwz0611/android-ffmpeg-stream-player</a></p>
<p>å¦‚æœä½ çš„é¡¹ç›®ä¹Ÿæœ‰å®‰å“æµåª’ä½“æ’­æ”¾çš„éœ€æ±‚ï¼Œå°¤å…¶æ˜¯ä½å»¶è¿Ÿã€å¤šæµå¹¶å‘ã€è‡ªå®šä¹‰å¸§å¤„ç†çš„åœºæ™¯ï¼Œè¿™æ¬¾æ’­æ”¾å™¨åº”è¯¥èƒ½å¸®ä½ å°‘èµ°ä¸å°‘å¼¯è·¯</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåï¼‰ç¬¬10ç« ï¼šä¸­æ–­æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7589275237038309411</link>    <guid>https://juejin.cn/post/7589275237038309411</guid>    <pubDate>2025-12-30T07:44:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589275237038309411" data-draft-id="7589275237038276643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåï¼‰ç¬¬10ç« ï¼šä¸­æ–­æœºåˆ¶"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-30T07:44:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåï¼‰ç¬¬10ç« ï¼šä¸­æ–­æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:44:44.000Z" title="Tue Dec 30 2025 07:44:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æœ¬ç« å¯¼è¯»</h2>
<p>æœ¬ç« ä»‹ç»AgentScopeçš„<strong>ä¸­æ–­æœºåˆ¶</strong>ï¼Œè¿™æ˜¯å®ç°<strong>äººæœºååŒ</strong>å’Œ<strong>ä¼˜é›…æ§åˆ¶</strong>çš„å…³é”®ç‰¹æ€§ã€‚</p>
<p>ä¸­æ–­å…è®¸ä½ åœ¨<strong>ä»»æ„æ—¶åˆ»æš‚åœAgentæ‰§è¡Œ</strong>ï¼ŒåŒæ—¶<strong>å®Œæ•´ä¿ç•™ä¸Šä¸‹æ–‡å’ŒçŠ¶æ€</strong>ï¼Œä¸ºç”¨æˆ·æä¾›å¯¹é•¿æ—¶é—´è¿è¡Œä»»åŠ¡çš„å®æ—¶æ§åˆ¶èƒ½åŠ›ã€‚</p>
<p><strong>æœ¬ç« æ¦‚è§ˆ</strong>ï¼š</p>
<ul>
<li>Whatï¼ˆæ˜¯ä»€ä¹ˆï¼‰ï¼šç†è§£ä¸­æ–­çš„ä¸‰ç§åœºæ™¯å’Œå·¥ä½œåŸç†</li>
<li>Whyï¼ˆä¸ºä»€ä¹ˆï¼‰ï¼šæ˜ç¡®ä»€ä¹ˆæ—¶å€™éœ€è¦ä½¿ç”¨ä¸­æ–­æœºåˆ¶</li>
<li>Howï¼ˆæ€æ ·åšï¼‰ï¼šå®Œæ•´çš„å®ç°ç¤ºä¾‹å’Œç”Ÿäº§å¯ç”¨æ¡ˆä¾‹</li>
</ul>
<hr/>
<h2 data-id="heading-1">10.1 ä¸­æ–­æœºåˆ¶è®¾è®¡ç†å¿µï¼ˆWhat - æ˜¯ä»€ä¹ˆï¼‰</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ä¸­æ–­ï¼Ÿ</h3>
<p><strong>ä¸­æ–­</strong>æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå…è®¸ä½ <strong>åœ¨ä¸ä¸¢å¤±ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æš‚åœAgentçš„æ‰§è¡Œ</strong>ã€‚</p>
<p>å…³é”®ç‰¹æ€§ï¼š</p>
<ul>
<li>âœ“ <strong>æ— æŸæš‚åœ</strong>ï¼šä¿ç•™æ‰€æœ‰ä¸­é—´çŠ¶æ€å’Œä¸Šä¸‹æ–‡</li>
<li>âœ“ <strong>å®æ—¶æ§åˆ¶</strong>ï¼šéšæ—¶å¯ä»¥æš‚åœã€æ¢å¤ã€å–æ¶ˆ</li>
<li>âœ“ <strong>äººæœºååŒ</strong>ï¼šç”¨æˆ·å¯ä»¥åœ¨å…³é”®ç‚¹å¹²é¢„Agentå†³ç­–</li>
<li>âœ“ <strong>ä¼˜é›…é™çº§</strong>ï¼šé‡åˆ°é—®é¢˜å¯ä»¥å®‰å…¨åœ°ä¸­æ­¢</li>
</ul>
<h3 data-id="heading-3">ä¸­æ–­çš„ä¸‰ä¸ªæ ¸å¿ƒåœºæ™¯</h3>
<h4 data-id="heading-4">åœºæ™¯1ï¼šå®‰å…¨ä¸­æ–­ï¼ˆSafe Pauseï¼‰</h4>
<pre><code class="hljs">åœºæ™¯æè¿°ï¼šé•¿æ—¶é—´ä»»åŠ¡æ‰§è¡Œä¸­ï¼Œç”¨æˆ·éœ€è¦è¡¥å……ä¿¡æ¯æˆ–ä¿®æ­£æ¡ä»¶

æ‰§è¡Œæµç¨‹ï¼š
ç”¨æˆ·åˆå§‹è¯·æ±‚ â†’ Agentæ¨ç†ï¼ˆ5ç§’ï¼‰
â†“
ç”¨æˆ·ï¼šã€Œæš‚åœï¼Œæˆ‘éœ€è¦è¡¥å……æ•°æ®ã€
â†“
Agentç«‹å³åœæ­¢ï¼Œä¿ç•™å®Œæ•´ä¸Šä¸‹æ–‡ï¼ˆå†…å­˜ã€æ¶ˆæ¯å†å²ï¼‰
â†“
ç”¨æˆ·æä¾›æ–°æ•°æ® â†’ AgentåŸºäºæ–°æ•°æ®ç»§ç»­æ¨ç†
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Agentæ‰§è¡Œä¸­é—´è¢«æš‚åœ</span>
<span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
    .name(<span class="hljs-string">"SafePauseAgent"</span>)
    .model(model)
    .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
    .build();

<span class="hljs-comment">// å¯åŠ¨å¼‚æ­¥æ‰§è¡Œ</span>
Flux&lt;HookEvent&gt; execution = agent.stream(
    Msg.builder().textContent(<span class="hljs-string">"è¯·åˆ†æè¿™äº›é”€å”®æ•°æ®å¹¶ç»™å‡ºå»ºè®®"</span>).build()
);

<span class="hljs-comment">// å°†æ‰§è¡Œæµè½¬ä¸ºå¯è®¢é˜…çš„æµ</span>
<span class="hljs-type">Disposable</span> <span class="hljs-variable">subscription</span> <span class="hljs-operator">=</span> execution.subscribe(
    event -&gt; handleEvent(event),
    error -&gt; System.err.println(<span class="hljs-string">"Error: "</span> + error),
    () -&gt; System.out.println(<span class="hljs-string">"Completed"</span>)
);

<span class="hljs-comment">// 5ç§’åï¼Œç”¨æˆ·è¦æ±‚æš‚åœ</span>
Thread.sleep(<span class="hljs-number">5000</span>);
agent.interrupt(<span class="hljs-string">"ç”¨æˆ·è¦æ±‚è¡¥å……æ•°æ®ï¼Œæš‚åœæ¨ç†"</span>).block();

<span class="hljs-comment">// æ­¤æ—¶Agentå·²æš‚åœï¼Œå†…å­˜å’ŒçŠ¶æ€éƒ½ä¿ç•™</span>
<span class="hljs-type">Memory</span> <span class="hljs-variable">memory</span> <span class="hljs-operator">=</span> agent.getMemory();
List&lt;Msg&gt; history = memory.getHistory();
System.out.println(<span class="hljs-string">"å½“å‰æ¨ç†æ­¥æ•°ï¼š"</span> + history.size());

<span class="hljs-comment">// ç”¨æˆ·è¡¥å……æ–°æ•°æ®</span>
agent.observe(Msg.builder()
    .role(MsgRole.USER)
    .textContent(<span class="hljs-string">"è¿™æ˜¯è¡¥å……çš„å­£åº¦æ•°æ®..."</span>)
    .build()).block();

<span class="hljs-comment">// AgentåŸºäºæ–°æ•°æ®ç»§ç»­</span>
<span class="hljs-type">Msg</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> agent.call(
    Msg.builder().textContent(<span class="hljs-string">"ç»§ç»­åˆ†æ"</span>).build()
).block();
</code></pre>
<h4 data-id="heading-5">åœºæ™¯2ï¼šä¼˜é›…å–æ¶ˆï¼ˆGraceful Cancellationï¼‰</h4>
<pre><code class="hljs">åœºæ™¯æè¿°ï¼šç”¨æˆ·ä¸»åŠ¨å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡

æ‰§è¡Œæµç¨‹ï¼š
Agentæ‰§è¡Œå·¥å…·è°ƒç”¨ï¼ˆAPIè¯·æ±‚ï¼‰
â†“
ç”¨æˆ·ï¼šã€Œå–æ¶ˆè¿™ä¸ªè¯·æ±‚ã€
â†“
Agentåœæ­¢å·¥å…·æ‰§è¡Œï¼Œå›æ»šçŠ¶æ€
â†“
ç”¨æˆ·é€‰æ‹©å…¶ä»–è§£å†³æ–¹æ¡ˆæˆ–é‡æ–°å¼€å§‹
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Agentæ‰§è¡Œå¯èƒ½å¾ˆè€—æ—¶çš„å·¥å…·è°ƒç”¨</span>
<span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
    .name(<span class="hljs-string">"CancellableAgent"</span>)
    .toolkit(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Toolkit</span>()
        .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SlowToolService</span>()))
    .build();

<span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œ</span>
Future&lt;Msg&gt; future = CompletableFuture.supplyAsync(() -&gt; {
    Flux&lt;HookEvent&gt; execution = agent.stream(
        Msg.builder().textContent(<span class="hljs-string">"è¯·ä»æ•°æ®åº“æŸ¥è¯¢å¤§é‡å†å²æ•°æ®"</span>).build()
    );
    
    <span class="hljs-comment">// è®¢é˜…å¹¶æ‰§è¡Œ</span>
    List&lt;Msg&gt; results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    execution.subscribe(
        event -&gt; {
            <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> PostActingEvent) {
                <span class="hljs-type">PostActingEvent</span> <span class="hljs-variable">acting</span> <span class="hljs-operator">=</span> (PostActingEvent) event;
                results.add(acting.getActingMessage());
            }
        }
    );
    
    <span class="hljs-keyword">return</span> results.isEmpty() ? <span class="hljs-literal">null</span> : results.get(<span class="hljs-number">0</span>);
});

<span class="hljs-comment">// ç”¨æˆ·åœ¨çœ‹åˆ°è¿›åº¦åå†³å®šå–æ¶ˆ</span>
Thread.sleep(<span class="hljs-number">3000</span>);

<span class="hljs-comment">// å‘é€å–æ¶ˆä¸­æ–­</span>
agent.interrupt(<span class="hljs-string">"ç”¨æˆ·å–æ¶ˆè¯·æ±‚"</span>).block();

<span class="hljs-comment">// æ¸…ç†èµ„æº</span>
<span class="hljs-keyword">if</span> (!future.isDone()) {
    future.cancel(<span class="hljs-literal">true</span>);
}

System.out.println(<span class="hljs-string">"è¯·æ±‚å·²å®‰å…¨å–æ¶ˆï¼Œèµ„æºå·²é‡Šæ”¾"</span>);
</code></pre>
<h4 data-id="heading-6">åœºæ™¯3ï¼šäººæœºååŒï¼ˆHuman-in-the-Loopï¼‰</h4>
<pre><code class="hljs">åœºæ™¯æè¿°ï¼šAgentåœ¨æ‰§è¡Œå…³é”®å†³ç­–å‰ï¼Œéœ€è¦ç”¨æˆ·ç¡®è®¤

æ‰§è¡Œæµç¨‹ï¼š
Agentæ¨ç†å‡ºä¸€ä¸ªè§£å†³æ–¹æ¡ˆ
â†“
Agentè¯·æ±‚ç”¨æˆ·ç¡®è®¤ï¼ˆä¸­æ–­ï¼‰
â†“
ç”¨æˆ·æ£€æŸ¥å¹¶ä¿®æ”¹æ–¹æ¡ˆ
â†“
AgentåŸºäºä¿®æ”¹åçš„æ–¹æ¡ˆç»§ç»­æ‰§è¡Œ
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ”¯æŒäººæœºååŒçš„Agent</span>
<span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
    .name(<span class="hljs-string">"InteractiveAgent"</span>)
    .toolkit(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Toolkit</span>()
        .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PaymentService</span>())  <span class="hljs-comment">// æ”¯ä»˜ç­‰å…³é”®æ“ä½œ</span>
        .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApprovalHook</span>()))    <span class="hljs-comment">// å®¡æ‰¹Hook</span>
    .build();

<span class="hljs-comment">// æ·»åŠ äººæœºååŒHook</span>
List&lt;Hook&gt; hooks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
hooks.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanInTheLoopHook</span>((decision) -&gt; {
    <span class="hljs-comment">// åœ¨å…³é”®ç‚¹æš‚åœï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤</span>
    System.out.println(<span class="hljs-string">"âš  éœ€è¦ç¡®è®¤çš„å†³ç­–ï¼š"</span> + decision);
    System.out.println(<span class="hljs-string">"è¯·è¾“å…¥ï¼š[1]æ‰¹å‡†  [2]ä¿®æ”¹  [3]æ‹’ç»"</span>);
    
    <span class="hljs-comment">// è¿™é‡Œä¼šé˜»å¡ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥</span>
    <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
    <span class="hljs-type">String</span> <span class="hljs-variable">userInput</span> <span class="hljs-operator">=</span> scanner.nextLine();
    
    <span class="hljs-keyword">return</span> userInput;  <span class="hljs-comment">// è¿”å›ç”¨æˆ·çš„é€‰æ‹©</span>
}));

agent.withHooks(hooks);

<span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
<span class="hljs-type">Msg</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> agent.call(
    Msg.builder().textContent(<span class="hljs-string">"è¯·å¤„ç†è¿™ä¸ªè®¢å•è¯·æ±‚ï¼šè½¬è´¦1000å…ƒç»™ä¾›åº”å•†"</span>).build()
).block();
</code></pre>
<hr/>
<h2 data-id="heading-7">10.2 ä¸­æ–­å·¥ä½œåŸç†ï¼ˆWhy - ä¸ºä»€ä¹ˆéœ€è¦ï¼‰</h2>
<h3 data-id="heading-8">ä¸ºä»€ä¹ˆéœ€è¦ä¸­æ–­æœºåˆ¶ï¼Ÿ</h3>
<h4 data-id="heading-9">1. <strong>æ§åˆ¶é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</strong></h4>
<pre><code class="hljs language-diff" lang="diff">é—®é¢˜ï¼šAgentæ‰§è¡Œå¯èƒ½æŒç»­æ•°åˆ†é’Ÿæˆ–æ•°å°æ—¶ï¼Œç”¨æˆ·æ— æ³•å®æ—¶æ§åˆ¶
è§£å†³ï¼šä¸­æ–­å…è®¸ç”¨æˆ·åœ¨ä»»æ„æ—¶åˆ»æš‚åœã€è°ƒæ•´æˆ–å–æ¶ˆ

åœºæ™¯ï¼š
<span class="hljs-deletion">- æ•°æ®åˆ†æAgentï¼šç”¨æˆ·å‘ç°åˆ†ææ–¹å‘é”™è¯¯ï¼Œéœ€è¦ä¸­æ­¢é‡æ–°å¼€å§‹</span>
<span class="hljs-deletion">- å†…å®¹åˆ›ä½œAgentï¼šç”¨æˆ·åœ¨æŸä¸ªä¸­é—´æ­¥éª¤ä¸æ»¡æ„ï¼Œéœ€è¦ä¿®æ”¹å‰ç½®ä¿¡æ¯</span>
<span class="hljs-deletion">- æŠ¥è¡¨ç”ŸæˆAgentï¼šä¸´æ—¶å‘ç°æ•°æ®æœ‰è¯¯ï¼Œéœ€è¦åœæ­¢å¹¶ä¿®æ­£æºæ•°æ®</span>
</code></pre>
<h4 data-id="heading-10">2. <strong>å®ç°äººæœºååŒ</strong></h4>
<pre><code class="hljs language-diff" lang="diff">é—®é¢˜ï¼šå®Œå…¨è‡ªåŠ¨åŒ–çš„Agentå¯èƒ½åšå‡ºç”¨æˆ·ä¸è®¤å¯çš„å†³ç­–
è§£å†³ï¼šé€šè¿‡ä¸­æ–­å’ŒHookï¼Œç”¨æˆ·å¯ä»¥åœ¨å…³é”®ç‚¹ä»‹å…¥

åœºæ™¯ï¼š
<span class="hljs-deletion">- é‡‘èäº¤æ˜“ï¼šå¤§é¢è½¬è´¦éœ€è¦ç”¨æˆ·ç¡®è®¤</span>
<span class="hljs-deletion">- å†…å®¹å®¡æ ¸ï¼šæ•æ„Ÿå†…å®¹éœ€è¦äººå·¥å®¡æ ¸</span>
<span class="hljs-deletion">- é«˜é£é™©æ“ä½œï¼šåˆ é™¤ã€å…³é—­ç­‰æ“ä½œéœ€è¦äºŒæ¬¡ç¡®è®¤</span>
</code></pre>
<h4 data-id="heading-11">3. <strong>æ”¯æŒå¼‚å¸¸æ¢å¤</strong></h4>
<pre><code class="hljs language-diff" lang="diff">é—®é¢˜ï¼šé‡åˆ°å¼‚å¸¸æ—¶ï¼Œæ•´ä¸ªä»»åŠ¡å¤±è´¥ï¼Œæ— æ³•ç»§ç»­
è§£å†³ï¼šé€šè¿‡ä¸­æ–­å’ŒçŠ¶æ€ä¿å­˜ï¼Œå¯ä»¥æ¢å¤å¹¶é‡è¯•

åœºæ™¯ï¼š
<span class="hljs-deletion">- ç½‘ç»œä¸­æ–­ï¼šæœåŠ¡ä¸´æ—¶ä¸å¯ç”¨ï¼Œæš‚åœå¹¶ç¨åæ¢å¤</span>
<span class="hljs-deletion">- é…é¢é™åˆ¶ï¼šAPIè°ƒç”¨è¾¾åˆ°é™åˆ¶ï¼Œæš‚åœç­‰å¾…é…é¢æ¢å¤</span>
<span class="hljs-deletion">- æƒé™é—®é¢˜ï¼šä¸´æ—¶æƒé™ä¸è¶³ï¼Œç­‰å¾…æƒé™å‡çº§åç»§ç»­</span>
</code></pre>
<h3 data-id="heading-12">ä¸­æ–­çš„å·¥ä½œåŸç†</h3>
<pre><code class="hljs language-scss" lang="scss">ä¸­æ–­æ‰§è¡Œæ¨¡å‹ï¼ˆå“åº”å¼ç®¡é“ï¼‰ï¼š

ç”¨æˆ·è¯·æ±‚ä¸­æ–­
    â†“
agent<span class="hljs-selector-class">.interrupt</span>(reason)<span class="hljs-selector-class">.block</span>()
    â†“
å½“å‰æ“ä½œå®Œæˆï¼ˆä¸å¼ºåˆ¶ä¸­æ–­è¿›è¡Œä¸­çš„æ“ä½œï¼‰
    â†“
ä¿å­˜å®Œæ•´çŠ¶æ€ï¼ˆå†…å­˜ã€æ¶ˆæ¯å†å²ã€Hooké“¾ï¼‰
    â†“
Agentè¿›å…¥æš‚åœçŠ¶æ€
    â†“
ç”¨æˆ·å¯ä»¥ï¼š
  â”œâ”€ è§‚å¯ŸçŠ¶æ€
  â”œâ”€ ä¿®æ”¹ä¸Šä¸‹æ–‡ï¼ˆMemoryã€æ¶ˆæ¯ï¼‰
  â”œâ”€ è°ƒç”¨<span class="hljs-built_in">observe</span>()æ³¨å…¥æ–°ä¿¡æ¯
  â””â”€ è°ƒç”¨<span class="hljs-built_in">call</span>()æ¢å¤æ‰§è¡Œ
</code></pre>
<hr/>
<h2 data-id="heading-13">10.3 ä¸­æ–­çš„å®ç°æ–¹å¼ï¼ˆHow - æ€æ ·åšï¼‰</h2>
<h3 data-id="heading-14">åŸºç¡€ä¸­æ–­å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterruptionDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ›å»ºæ”¯æŒä¸­æ–­çš„Agent</span>
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
            .name(<span class="hljs-string">"InterruptibleAgent"</span>)
            .model(model)
            .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
            .build();
        
        <span class="hljs-comment">// 2. åœ¨åå°æ‰§è¡Œä»»åŠ¡</span>
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newSingleThreadExecutor();
        
        Flux&lt;HookEvent&gt; execution = agent.stream(
            Msg.builder()
                .role(MsgRole.USER)
                .textContent(<span class="hljs-string">"è¯·å¸®æˆ‘åˆ†æè¿‡å»ä¸€ä¸ªæœˆçš„é”€å”®æ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š"</span>)
                .build()
        );
        
        <span class="hljs-comment">// 3. è®¢é˜…æ‰§è¡Œç»“æœ</span>
        List&lt;HookEvent&gt; events = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        Future&lt;?&gt; future = executor.submit(() -&gt; {
            execution.subscribe(
                event -&gt; {
                    events.add(event);
                    System.out.println(<span class="hljs-string">"Event: "</span> + event.getClass().getSimpleName());
                },
                error -&gt; System.err.println(<span class="hljs-string">"Error: "</span> + error.getMessage()),
                () -&gt; System.out.println(<span class="hljs-string">"Execution completed"</span>)
            );
        });
        
        <span class="hljs-comment">// 4. æ‰§è¡Œ3ç§’åï¼Œè§¦å‘ä¸­æ–­</span>
        Thread.sleep(<span class="hljs-number">3000</span>);
        System.out.println(<span class="hljs-string">"\n&gt;&gt;&gt; ç”¨æˆ·è¯·æ±‚æš‚åœ &lt;&lt;&lt;"</span>);
        agent.interrupt(<span class="hljs-string">"ç”¨æˆ·è¦æ±‚æš‚åœï¼Œéœ€è¦è¡¥å……æ•°æ®"</span>).block();
        
        <span class="hljs-comment">// 5. æ£€æŸ¥ä¸­æ–­åçš„çŠ¶æ€</span>
        <span class="hljs-type">Memory</span> <span class="hljs-variable">memory</span> <span class="hljs-operator">=</span> agent.getMemory();
        System.out.println(<span class="hljs-string">"\nä¸­æ–­åçš„çŠ¶æ€ï¼š"</span>);
        System.out.println(<span class="hljs-string">"- è®°å¿†ä¸­çš„æ¶ˆæ¯æ•°ï¼š"</span> + memory.getHistory().size());
        System.out.println(<span class="hljs-string">"- æœ€åä¸€æ¡æ¶ˆæ¯ï¼š"</span> + 
            memory.getHistory().get(memory.getHistory().size() - <span class="hljs-number">1</span>).getTextContent());
        
        <span class="hljs-comment">// 6. ç”¨æˆ·è¡¥å……æ–°ä¿¡æ¯</span>
        System.out.println(<span class="hljs-string">"\n&gt;&gt;&gt; ç”¨æˆ·è¡¥å……æ–°æ•°æ® &lt;&lt;&lt;"</span>);
        agent.observe(Msg.builder()
            .role(MsgRole.USER)
            .textContent(<span class="hljs-string">"æ–°å¢ä¿¡æ¯ï¼šè¯·é‡ç‚¹å…³æ³¨å—æ–¹åœ°åŒºçš„é”€å”®ï¼Œè¿™ä¸ªæœˆæœ‰ä¿ƒé”€æ´»åŠ¨"</span>)
            .build()).block();
        
        <span class="hljs-comment">// 7. æ¢å¤æ‰§è¡Œ</span>
        System.out.println(<span class="hljs-string">"\n&gt;&gt;&gt; ç»§ç»­æ‰§è¡Œ &lt;&lt;&lt;"</span>);
        <span class="hljs-type">Msg</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> agent.call(
            Msg.builder()
                .role(MsgRole.USER)
                .textContent(<span class="hljs-string">"åŸºäºä¸Šé¢çš„è¡¥å……ä¿¡æ¯ï¼Œç»§ç»­å®ŒæˆæŠ¥å‘Š"</span>)
                .build()
        ).block();
        
        System.out.println(<span class="hljs-string">"\næœ€ç»ˆç»“æœï¼š\n"</span> + result.getTextContent());
        
        executor.shutdown();
    }
}
</code></pre>
<h3 data-id="heading-15">ä½¿ç”¨Hookå®ç°ç²¾ç»†åŒ–æ§åˆ¶</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdvancedInterruptionWithHooks</span> {
    
    <span class="hljs-comment">/**
     * è‡ªå®šä¹‰Hookï¼šåœ¨æ¯ä¸ªæ¨ç†æ­¥éª¤åæ£€æŸ¥æ˜¯å¦åº”è¯¥ä¸­æ–­
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CheckpointHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicBoolean</span> <span class="hljs-variable">shouldInterrupt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicBoolean</span>(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String interruptReason;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">CheckpointHook</span><span class="hljs-params">(String reason)</span> {
            <span class="hljs-built_in">this</span>.interruptReason = reason;
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">triggerInterrupt</span><span class="hljs-params">()</span> {
            shouldInterrupt.set(<span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
            <span class="hljs-comment">// åœ¨Postäº‹ä»¶æ—¶æ£€æŸ¥æ˜¯å¦éœ€è¦ä¸­æ–­</span>
            <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> PostReasoningEvent post) {
                <span class="hljs-keyword">if</span> (shouldInterrupt.get()) {
                    <span class="hljs-comment">// è®°å½•ä¸­æ–­ç‚¹</span>
                    System.out.println(<span class="hljs-string">"ğŸ›‘ ä¸­æ–­ç‚¹è§¦å‘ï¼š"</span> + interruptReason);
                    System.out.println(<span class="hljs-string">"  æ¨ç†æ¬¡æ•°ï¼š"</span> + post.getReasoningCount());
                    System.out.println(<span class="hljs-string">"  å½“å‰æ¶ˆæ¯æ•°ï¼š"</span> + post.getInputMessages().size());
                    
                    <span class="hljs-comment">// è¿”å›äº‹ä»¶ï¼Œç”±å¤–éƒ¨å¤„ç†ä¸­æ–­</span>
                    <span class="hljs-keyword">return</span> Mono.just(event)
                        .doOnNext(e -&gt; {
                            <span class="hljs-comment">// è¿™é‡Œå¯ä»¥è§¦å‘ä¸­æ–­ä¿¡å·</span>
                            System.out.println(<span class="hljs-string">"  å·²ä¿å­˜æ£€æŸ¥ç‚¹"</span>);
                        });
                }
            }
            <span class="hljs-keyword">return</span> Mono.just(event);
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-number">50</span>;  <span class="hljs-comment">// è¾ƒé«˜ä¼˜å…ˆçº§ï¼Œæœ€åæ‰§è¡Œ</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-comment">// åˆ›å»ºæ£€æŸ¥ç‚¹Hook</span>
        <span class="hljs-type">CheckpointHook</span> <span class="hljs-variable">checkpoint</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CheckpointHook</span>(<span class="hljs-string">"ç”¨æˆ·ä¸»åŠ¨ä¸­æ–­"</span>);
        
        <span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
            .name(<span class="hljs-string">"CheckpointAgent"</span>)
            .model(model)
            .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
            .hooks(List.of(checkpoint))
            .build();
        
        <span class="hljs-comment">// åœ¨åå°æ‰§è¡Œ</span>
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newSingleThreadExecutor();
        Future&lt;?&gt; future = executor.submit(() -&gt; {
            Flux&lt;HookEvent&gt; execution = agent.stream(
                Msg.builder()
                    .textContent(<span class="hljs-string">"è¯·æ‰§è¡Œä¸€ä¸ªé•¿æ—¶é—´çš„åˆ†æä»»åŠ¡"</span>)
                    .build()
            );
            
            execution.subscribe(
                event -&gt; System.out.println(<span class="hljs-string">"æ”¶åˆ°äº‹ä»¶ï¼š"</span> + event.getClass().getSimpleName()),
                error -&gt; System.err.println(<span class="hljs-string">"é”™è¯¯ï¼š"</span> + error),
                () -&gt; System.out.println(<span class="hljs-string">"ä»»åŠ¡å®Œæˆ"</span>)
            );
        });
        
        <span class="hljs-comment">// 2ç§’åè§¦å‘ä¸­æ–­</span>
        Thread.sleep(<span class="hljs-number">2000</span>);
        checkpoint.triggerInterrupt();
        
        <span class="hljs-comment">// ç­‰å¾…æ‰§è¡Œå®Œæˆ</span>
        Thread.sleep(<span class="hljs-number">2000</span>);
        
        <span class="hljs-comment">// æ£€æŸ¥çŠ¶æ€</span>
        System.out.println(<span class="hljs-string">"\næœ€ç»ˆçŠ¶æ€æ£€æŸ¥ï¼š"</span>);
        System.out.println(<span class="hljs-string">"Memoryä¸­çš„æ¶ˆæ¯æ•°ï¼š"</span> + agent.getMemory().getHistory().size());
        
        executor.shutdown();
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-16">10.4 ç”Ÿäº§åœºæ™¯ï¼šæ™ºèƒ½å®¢æœä¸­çš„ä¸­æ–­ç®¡ç†</h2>
<h3 data-id="heading-17">åœºæ™¯æè¿°</h3>
<pre><code class="hljs language-markdown" lang="markdown">ä¸€ä¸ªå®¢æœAgentå¤„ç†å®¢æˆ·é—®é¢˜ï¼š
<span class="hljs-bullet">1.</span> ç”¨æˆ·æå‡ºé—®é¢˜
<span class="hljs-bullet">2.</span> Agentåˆ†æå¹¶æå‡ºè§£å†³æ–¹æ¡ˆ
<span class="hljs-bullet">3.</span> å¦‚æœæ¶‰åŠé«˜é£é™©æ“ä½œï¼ˆå¦‚é€€æ¬¾ï¼‰ï¼Œéœ€è¦äººå·¥ç¡®è®¤
<span class="hljs-bullet">4.</span> äººå·¥å®¢æœå®¡æ‰¹åï¼ŒAgentç»§ç»­æ‰§è¡Œ
<span class="hljs-bullet">5.</span> å¦‚æœè¢«æ‹’ï¼ŒAgentæå‡ºæ›¿ä»£æ–¹æ¡ˆ
</code></pre>
<h3 data-id="heading-18">å®ç°ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceInterruptionSystem</span> {
    
    <span class="hljs-comment">/**
     * äººæœºååŒHookï¼šåœ¨éœ€è¦äººå·¥å®¡æ‰¹çš„æ“ä½œå‰æš‚åœ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApprovalHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, ApprovalQueue&gt; approvalQueues = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
            <span class="hljs-keyword">if</span> (!(event <span class="hljs-keyword">instanceof</span> PreActingEvent pre)) {
                <span class="hljs-keyword">return</span> Mono.just(event);
            }
            
            <span class="hljs-comment">// æ£€æŸ¥å³å°†æ‰§è¡Œçš„å·¥å…·æ˜¯å¦éœ€è¦å®¡æ‰¹</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">toolName</span> <span class="hljs-operator">=</span> extractToolName(pre.getToolCallMessage());
            
            <span class="hljs-keyword">if</span> (needsApproval(toolName)) {
                <span class="hljs-keyword">return</span> approveToolCall(pre.getToolCallMessage())
                    .flatMap(approved -&gt; {
                        <span class="hljs-keyword">if</span> (approved) {
                            System.out.println(<span class="hljs-string">"âœ“ äººå·¥å·²æ‰¹å‡†ï¼Œç»§ç»­æ‰§è¡Œï¼š"</span> + toolName);
                            <span class="hljs-keyword">return</span> Mono.just(event);
                        } <span class="hljs-keyword">else</span> {
                            System.out.println(<span class="hljs-string">"âœ— äººå·¥æ‹’ç»ï¼Œä¸­æ­¢æ‰§è¡Œï¼š"</span> + toolName);
                            <span class="hljs-comment">// ä¿®æ”¹äº‹ä»¶ï¼Œè·³è¿‡è¿™ä¸ªå·¥å…·è°ƒç”¨</span>
                            pre.markAsCancelled();
                            <span class="hljs-keyword">return</span> Mono.just(event);
                        }
                    });
            }
            
            <span class="hljs-keyword">return</span> Mono.just(event);
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">needsApproval</span><span class="hljs-params">(String toolName)</span> {
            <span class="hljs-comment">// é«˜é£é™©æ“ä½œåˆ—è¡¨</span>
            <span class="hljs-keyword">return</span> toolName.equals(<span class="hljs-string">"processRefund"</span>) ||
                   toolName.equals(<span class="hljs-string">"updateOrder"</span>) ||
                   toolName.equals(<span class="hljs-string">"deleteAccount"</span>);
        }
        
        <span class="hljs-keyword">private</span> Mono&lt;Boolean&gt; <span class="hljs-title function_">approveToolCall</span><span class="hljs-params">(Msg toolCall)</span> {
            <span class="hljs-comment">// æäº¤åˆ°å®¡æ‰¹é˜Ÿåˆ—ï¼Œç­‰å¾…äººå·¥å®¡æ‰¹</span>
            System.out.println(<span class="hljs-string">"\nâ¸ï¸  ç­‰å¾…äººå·¥å®¡æ‰¹ï¼š"</span>);
            System.out.println(<span class="hljs-string">"  å·¥å…·è°ƒç”¨ï¼š"</span> + toolCall.getTextContent());
            System.out.println(<span class="hljs-string">"  è¯·äººå·¥å®¡æ‰¹..."</span>);
            
            <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šå°†è¯·æ±‚å‘é€åˆ°å®¡æ‰¹ç³»ç»Ÿ</span>
            <span class="hljs-comment">// è¿™é‡Œç®€åŒ–ä¸ºåŒæ­¥ç­‰å¾…</span>
            <span class="hljs-keyword">return</span> Mono.fromCallable(() -&gt; {
                <span class="hljs-comment">// æ¨¡æ‹Ÿäººå·¥å®¡æ‰¹è€—æ—¶</span>
                Thread.sleep(<span class="hljs-number">2000</span>);
                System.out.println(<span class="hljs-string">"  âœ“ äººå·¥å®¡æ‰¹å®Œæˆï¼šå·²æ‰¹å‡†"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }).subscribeOn(Schedulers.boundedElastic());
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>;  <span class="hljs-comment">// æœ€é«˜ä¼˜å…ˆçº§ï¼Œæœ€æ—©æ£€æŸ¥</span>
        }
    }
    
    <span class="hljs-comment">/**
     * å®¢æœAgentä¸»ç±»
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceAgent</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReActAgent agent;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ApprovalHook approvalHook;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">CustomerServiceAgent</span><span class="hljs-params">(Model model)</span> {
            <span class="hljs-built_in">this</span>.approvalHook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApprovalHook</span>();
            
            <span class="hljs-built_in">this</span>.agent = ReActAgent.builder()
                .name(<span class="hljs-string">"CustomerServiceAgent"</span>)
                .model(model)
                .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
                .toolkit(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Toolkit</span>()
                    .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomerServiceTools</span>()))
                .hooks(List.of(approvalHook))
                .systemPrompt(getSystemPrompt())
                .build();
        }
        
        <span class="hljs-keyword">public</span> Msg <span class="hljs-title function_">handleCustomerRequest</span><span class="hljs-params">(String customerMessage)</span> <span class="hljs-keyword">throws</span> Exception {
            System.out.println(<span class="hljs-string">"\n=== å¤„ç†å®¢æˆ·è¯·æ±‚ ==="</span>);
            System.out.println(<span class="hljs-string">"å®¢æˆ·ï¼š"</span> + customerMessage);
            
            <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡ŒAgent</span>
            <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newSingleThreadExecutor();
            
            Future&lt;Msg&gt; result = executor.submit(() -&gt; {
                Flux&lt;HookEvent&gt; execution = agent.stream(
                    Msg.builder()
                        .role(MsgRole.USER)
                        .textContent(customerMessage)
                        .build()
                );
                
                <span class="hljs-comment">// æ‰§è¡Œå¹¶æ”¶é›†ç»“æœ</span>
                List&lt;Msg&gt; responses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
                execution.subscribe(
                    event -&gt; {
                        <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> PostActingEvent) {
                            responses.add(((PostActingEvent) event).getActingMessage());
                        }
                    }
                );
                
                <span class="hljs-keyword">return</span> responses.isEmpty() ? <span class="hljs-literal">null</span> : responses.get(<span class="hljs-number">0</span>);
            });
            
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">Msg</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> result.get(<span class="hljs-number">30</span>, TimeUnit.SECONDS);
                System.out.println(<span class="hljs-string">"å®¢æœåŠ©æ‰‹ï¼š"</span> + response.getTextContent());
                <span class="hljs-keyword">return</span> response;
            } <span class="hljs-keyword">finally</span> {
                executor.shutdown();
            }
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getSystemPrompt</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"""
                ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¢æœåŠ©æ‰‹ã€‚
                
                èŒè´£ï¼š
                1. è®¤çœŸå€¾å¬å®¢æˆ·çš„é—®é¢˜
                2. åˆ†æé—®é¢˜å¹¶æå‡ºè§£å†³æ–¹æ¡ˆ
                3. å¯¹äºé€€æ¬¾ã€è®¢å•ä¿®æ”¹ç­‰å…³é”®æ“ä½œï¼Œä¸»åŠ¨è°ƒç”¨ç›¸åº”å·¥å…·
                4. å¯¹äºå·¥å…·æ‰§è¡Œå¤±è´¥ï¼Œæå‡ºæ›¿ä»£æ–¹æ¡ˆ
                
                æ€åº¦ï¼š
                - ç¤¼è²Œã€è€å¿ƒã€ä¸“ä¸š
                - ä¼˜å…ˆæ»¡è¶³å®¢æˆ·éœ€æ±‚
                - å½“æ— æ³•å¤„ç†æ—¶ï¼Œæ¸…æ™°åœ°è¯´æ˜åŸå› 
                """</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * å®¢æœå·¥å…·é›†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceTools</span> {
        
        <span class="hljs-meta">@Tool(description = "æŸ¥è¯¢è®¢å•ä¿¡æ¯")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">queryOrder</span><span class="hljs-params">(String orderId)</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"è®¢å• "</span> + orderId + <span class="hljs-string">" çš„ä¿¡æ¯ï¼šçŠ¶æ€=å·²å‘è´§ï¼Œé‡‘é¢=Â¥299.99"</span>;
        }
        
        <span class="hljs-meta">@Tool(description = "å¤„ç†é€€æ¬¾ï¼Œéœ€è¦äººå·¥å®¡æ‰¹")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">processRefund</span><span class="hljs-params">(String orderId, String reason)</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"é€€æ¬¾å·²å¤„ç†ï¼Œé€€æ¬¾é‡‘é¢å·²è¿”å›åˆ°åŸè´¦æˆ·"</span>;
        }
        
        <span class="hljs-meta">@Tool(description = "æ›´æ–°è®¢å•å¤‡æ³¨")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">updateOrder</span><span class="hljs-params">(String orderId, String note)</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"è®¢å•å¤‡æ³¨å·²æ›´æ–°"</span>;
        }
        
        <span class="hljs-meta">@Tool(description = "æä¾›æ›¿ä»£æ–¹æ¡ˆ")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">suggestAlternative</span><span class="hljs-params">(String productId)</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æ¨èæ›¿ä»£äº§å“ï¼šID="</span> + productId + <span class="hljs-string">"-altï¼Œä»·æ ¼Â¥199.99ï¼Œè¯„åˆ†4.8/5"</span>;
        }
    }
    
    <span class="hljs-comment">// æµ‹è¯•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-type">CustomerServiceAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomerServiceAgent</span>(model);
        
        <span class="hljs-comment">// åœºæ™¯1ï¼šæ™®é€šæŸ¥è¯¢ï¼ˆæ— éœ€ä¸­æ–­ï¼‰</span>
        agent.handleCustomerRequest(<span class="hljs-string">"è¯·æŸ¥è¯¢æˆ‘çš„è®¢å• ORD-2024-001 çš„çŠ¶æ€"</span>);
        
        <span class="hljs-comment">// åœºæ™¯2ï¼šé€€æ¬¾è¯·æ±‚ï¼ˆéœ€è¦äººå·¥å®¡æ‰¹ä¸­æ–­ï¼‰</span>
        agent.handleCustomerRequest(<span class="hljs-string">"æˆ‘æƒ³è¦é€€è´§ï¼Œè®¢å• ORD-2024-002ï¼Œå› ä¸ºå•†å“ä¸ç¬¦åˆé¢„æœŸ"</span>);
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-19">10.5 æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-20">âœ… æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç²¾ç¡®çš„ä¸­æ–­ç‚¹è®¾è®¡
<span class="hljs-bullet">   -</span> åœ¨æ¨ç†å¾ªç¯ä¹‹é—´æ£€æŸ¥ä¸­æ–­ä¿¡å·
<span class="hljs-bullet">   -</span> ä¸è¦åœ¨å·¥å…·æ‰§è¡Œä¸­é€”ä¸­æ–­ï¼ˆå¯èƒ½å¯¼è‡´ä¸ä¸€è‡´çŠ¶æ€ï¼‰
<span class="hljs-bullet">   -</span> æ¸…æ™°å®šä¹‰å¯ä¸­æ–­å’Œä¸å¯ä¸­æ–­çš„é˜¶æ®µ

<span class="hljs-bullet">2.</span> å®Œæ•´çš„çŠ¶æ€ä¿å­˜
<span class="hljs-bullet">   -</span> ä¸­æ–­æ—¶ä¿å­˜Memoryã€æ¶ˆæ¯å†å²ã€HookçŠ¶æ€
<span class="hljs-bullet">   -</span> æä¾›æ¢å¤æ¥å£ï¼Œç¡®ä¿çŠ¶æ€å®Œæ•´æ€§
<span class="hljs-bullet">   -</span> æ”¯æŒæ£€æŸ¥ç‚¹æ¢å¤

<span class="hljs-bullet">3.</span> ç”¨æˆ·ä½“éªŒ
<span class="hljs-bullet">   -</span> æä¾›æ˜ç¡®çš„ä¸­æ–­ç¡®è®¤
<span class="hljs-bullet">   -</span> æ˜¾ç¤ºä¸­æ–­ç‚¹çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
<span class="hljs-bullet">   -</span> æ”¯æŒç»§ç»­/ä¿®æ”¹/å–æ¶ˆå¤šç§é€‰æ‹©

<span class="hljs-bullet">4.</span> ç”Ÿäº§ç¯ä¿
<span class="hljs-bullet">   -</span> åŠ å…¥è¶…æ—¶æœºåˆ¶ï¼Œé˜²æ­¢æ— é™ç­‰å¾…
<span class="hljs-bullet">   -</span> è®°å½•æ‰€æœ‰ä¸­æ–­äº‹ä»¶ç”¨äºå®¡è®¡
<span class="hljs-bullet">   -</span> ç›‘æ§ä¸­æ–­é¢‘ç‡ï¼Œè¯†åˆ«é—®é¢˜æ¨¡å¼
</code></pre>
<h3 data-id="heading-21">â“ å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-22">Q1ï¼šä¸­æ–­æ—¶å·¥å…·è°ƒç”¨è¿›è¡Œä¸­æ€ä¹ˆåŠï¼Ÿ</h4>
<p>Aï¼šAgentScopeä¼šç­‰å¾…å½“å‰å·¥å…·è°ƒç”¨å®Œæˆï¼Œç„¶åå†æš‚åœã€‚è¿™ç¡®ä¿äº†çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¦‚æœéœ€è¦å¼ºåˆ¶ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„å·¥å…·ï¼Œä½¿ç”¨Future.cancel()</span>
Future&lt;?&gt; toolFuture = executor.submit(() -&gt; slowTool.call());
Thread.sleep(<span class="hljs-number">2000</span>);
toolFuture.cancel(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// å¼ºåˆ¶å–æ¶ˆ</span>
</code></pre>
<h4 data-id="heading-23">Q2ï¼šä¸­æ–­åçŠ¶æ€å¦‚ä½•æ¢å¤ï¼Ÿ</h4>
<p>Aï¼šé€šè¿‡Memoryæ¢å¤ã€‚AgentScopeè‡ªåŠ¨ä¿å­˜æ‰€æœ‰æ¶ˆæ¯å†å²å’Œå†…éƒ¨çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸­æ–­åçš„æ¢å¤</span>
agent.interrupt(<span class="hljs-string">"user pause"</span>).block();

<span class="hljs-comment">// æ£€æŸ¥Memoryä¸­çš„å†å²</span>
List&lt;Msg&gt; history = agent.getMemory().getHistory();

<span class="hljs-comment">// æ¢å¤åˆ°ä¸­æ–­ç‚¹</span>
agent.observe(newMsg).block();
<span class="hljs-type">Msg</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> agent.call(continuationMsg).block();
</code></pre>
<h4 data-id="heading-24">Q3ï¼šèƒ½å¦åœ¨Hookä¸­å®ç°æ¡ä»¶ä¸­æ–­ï¼Ÿ</h4>
<p>Aï¼šå¯ä»¥ã€‚é€šè¿‡åœ¨Hookä¸­è¿”å›ä¿®æ”¹åçš„äº‹ä»¶ï¼Œå¯ä»¥å®ç°æ¡ä»¶åˆ¤æ–­å’Œé€‰æ‹©æ€§ä¸­æ–­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
    <span class="hljs-keyword">if</span> (shouldInterrupt(event)) {
        <span class="hljs-keyword">return</span> Mono.just(event)
            .doOnNext(e -&gt; {
                <span class="hljs-comment">// è§¦å‘å¤–éƒ¨ä¸­æ–­ä¿¡å·</span>
                system.sendInterruptSignal();
            });
    }
    <span class="hljs-keyword">return</span> Mono.just(event);
}
</code></pre>
<hr/>
<h2 data-id="heading-25">10.6 ä¸å…¶ä»–ç‰¹æ€§çš„ååŒ</h2>
<h3 data-id="heading-26">ä¸­æ–­ + Hookç³»ç»Ÿ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Hookå¯ä»¥åœ¨ä¸­æ–­å‰æ‰§è¡Œæ¸…ç†æ“ä½œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CleanupHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
        <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> PostReasoningEvent) {
            <span class="hljs-comment">// åœ¨æ¨ç†å®Œæˆæ—¶è¿›è¡Œæ¸…ç†</span>
            <span class="hljs-keyword">return</span> Mono.just(event)
                .doOnNext(e -&gt; cleanupResources());
        }
        <span class="hljs-keyword">return</span> Mono.just(event);
    }
}
</code></pre>
<h3 data-id="heading-27">ä¸­æ–­ + è®°å¿†ç³»ç»Ÿ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸­æ–­æ—¶è®°å¿†ç³»ç»Ÿè‡ªåŠ¨ä¿å­˜</span>
agent.interrupt(<span class="hljs-string">"pause"</span>).block();

<span class="hljs-type">Memory</span> <span class="hljs-variable">memory</span> <span class="hljs-operator">=</span> agent.getMemory();
<span class="hljs-comment">// å¯ä»¥æŸ¥è¯¢å†å²æ¶ˆæ¯</span>
List&lt;Msg&gt; history = memory.getHistory();
<span class="hljs-comment">// å¯ä»¥è·å–å‹ç¼©çš„è®°å¿†</span>
<span class="hljs-type">String</span> <span class="hljs-variable">compressed</span> <span class="hljs-operator">=</span> memory.getCompressedMemory();
</code></pre>
<h3 data-id="heading-28">ä¸­æ–­ + SessionæŒä¹…åŒ–</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸­æ–­åä¿å­˜ä¼šè¯</span>
session.saveSessionState(userId, Map.of(
    <span class="hljs-string">"memory"</span>, agent.getMemory(),
    <span class="hljs-string">"interrupt_reason"</span>, <span class="hljs-string">"user request"</span>
));

<span class="hljs-comment">// åç»­æ¢å¤</span>
session.loadSessionState(userId, modules);
</code></pre>
<hr/>
<h2 data-id="heading-29">æœ¬ç« æ€»ç»“</h2>
<p>æœ¬ç« ä»‹ç»äº†AgentScopeçš„<strong>ä¸­æ–­æœºåˆ¶</strong>ï¼Œè¿™æ˜¯å®ç°<strong>å®æ—¶æ§åˆ¶</strong>å’Œ<strong>äººæœºååŒ</strong>çš„æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<h3 data-id="heading-30">æ ¸å¿ƒè¦ç‚¹</h3>
<ul>
<li><strong>What</strong>ï¼šä¸­æ–­å…è®¸åœ¨ä»»æ„æ—¶åˆ»æš‚åœAgentï¼ŒåŒæ—¶ä¿ç•™å®Œæ•´çŠ¶æ€</li>
<li><strong>Why</strong>ï¼šæ”¯æŒäººæœºååŒã€æ§åˆ¶é•¿æ—¶é—´ä»»åŠ¡ã€å®ç°å¼‚å¸¸æ¢å¤</li>
<li><strong>How</strong>ï¼šä½¿ç”¨interrupt()æ–¹æ³•å’ŒHookå®ç°ç²¾ç»†åŒ–æ§åˆ¶</li>
</ul>
<h3 data-id="heading-31">å…³é”®ç‰¹æ€§</h3>
<ul>
<li>âœ“ æ— æŸæš‚åœï¼šä¿ç•™æ‰€æœ‰ä¸Šä¸‹æ–‡</li>
<li>âœ“ çµæ´»æ§åˆ¶ï¼šæš‚åœã€æ¢å¤ã€å–æ¶ˆã€ä¿®æ”¹</li>
<li>âœ“ äººæœºååŒï¼šåœ¨å…³é”®ç‚¹è¿›è¡Œäººå·¥å¹²é¢„</li>
<li>âœ“ ä¸å…¶ä»–ç‰¹æ€§ååŒï¼šHookã€Memoryã€Sessionçš„æ— ç¼é…åˆ</li>
</ul>
<h3 data-id="heading-32">ä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>é•¿æ—¶é—´ä»»åŠ¡çš„ç”¨æˆ·æ§åˆ¶</li>
<li>é«˜é£é™©æ“ä½œçš„äººå·¥å®¡æ‰¹</li>
<li>å¼‚å¸¸æ¢å¤å’ŒçŠ¶æ€ç®¡ç†</li>
<li>äº¤äº’å¼ä»»åŠ¡çš„é€æ­¥å®Œæˆ</li>
</ul>
<hr/>
<h2 data-id="heading-33">ä¸‹ä¸€ç« é¢„å‘Š</h2>
<p><strong>ç¬¬11ç« ï¼šPlanNotebook ä»»åŠ¡ç®¡ç†</strong></p>
<p>å½“Agentéœ€è¦å¤„ç†<strong>å¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡</strong>æ—¶ï¼Œå•ä¸€çš„æ¨ç†å¾ªç¯å¯èƒ½ä¸å¤Ÿã€‚ç¬¬11ç« å°†ä»‹ç»<strong>PlanNotebook</strong>ç³»ç»Ÿï¼Œå®ƒå…è®¸Agentï¼š</p>
<ul>
<li>è‡ªä¸»åˆ›å»ºå’Œç®¡ç†åˆ†é˜¶æ®µçš„è®¡åˆ’</li>
<li>è·¨è¶Šå¤šä¸ªæ¨ç†å¾ªç¯æ‰§è¡Œå¤æ‚ä»»åŠ¡</li>
<li>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€è°ƒæ•´è®¡åˆ’</li>
<li>ä¸ä¸­æ–­æœºåˆ¶ååŒå®ç°äººå·¥å¹²é¢„</li>
</ul>
<p>æ•¬è¯·æœŸå¾…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåäºŒï¼‰ç¬¬12ç« ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰]]></title>    <link>https://juejin.cn/post/7589445154533490740</link>    <guid>https://juejin.cn/post/7589445154533490740</guid>    <pubDate>2025-12-30T07:49:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589445154533490740" data-draft-id="7589386219450007567" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåäºŒï¼‰ç¬¬12ç« ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-30T07:49:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜¿é‡Œå¼€æºAgentScopeå¤šæ™ºèƒ½ä½“æ¡†æ¶è§£æç³»åˆ—ï¼ˆåäºŒï¼‰ç¬¬12ç« ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:49:06.000Z" title="Tue Dec 30 2025 07:49:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æœ¬ç« å¯¼è¯»</h2>
<p>æœ¬ç« ä»‹ç»AgentScopeçš„<strong>RAGï¼ˆRetrieval Augmented Generationï¼Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰<strong>ç³»ç»Ÿï¼Œè¿™æ˜¯è®©Agentèƒ½å¤Ÿ</strong>åŸºäºæœ€æ–°çŸ¥è¯†åº“å›ç­”é—®é¢˜</strong>çš„å…³é”®æŠ€æœ¯ã€‚</p>
<p>RAGé€šè¿‡<strong>æ£€ç´¢å¤–éƒ¨çŸ¥è¯†åº“ä¸­çš„ç›¸å…³ä¿¡æ¯</strong>ï¼Œä¸ºLLMæä¾›ä¸Šä¸‹æ–‡ï¼Œä»è€Œ<strong>æ˜¾è‘—æå‡å›ç­”çš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§</strong>ã€‚</p>
<p><strong>æœ¬ç« æ¦‚è§ˆ</strong>ï¼š</p>
<ul>
<li>Whatï¼ˆæ˜¯ä»€ä¹ˆï¼‰ï¼šç†è§£RAGçš„å·¥ä½œåŸç†å’Œæ¶æ„</li>
<li>Whyï¼ˆä¸ºä»€ä¹ˆï¼‰ï¼šæ˜ç¡®ä»€ä¹ˆæ—¶å€™éœ€è¦ä½¿ç”¨RAG</li>
<li>Howï¼ˆæ€æ ·åšï¼‰ï¼šå®Œæ•´çš„å®ç°ç¤ºä¾‹å’Œç”Ÿäº§å¯ç”¨æ¡ˆä¾‹</li>
</ul>
<hr/>
<h2 data-id="heading-1">12.1 RAGè®¾è®¡ç†å¿µ</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯RAGï¼Ÿ</h3>
<p>**RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰**æ˜¯ä¸€ç§æ··åˆå¼çš„å¤„ç†æµç¨‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">ç”¨æˆ·é—®é¢˜
  â†“
<span class="hljs-selector-attr">[æ£€ç´¢é˜¶æ®µ]</span> åœ¨çŸ¥è¯†åº“ä¸­æœç´¢ç›¸å…³æ–‡æ¡£
  â†“
<span class="hljs-selector-attr">[å¢å¼ºé˜¶æ®µ]</span> å°†æ£€ç´¢åˆ°çš„æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡
  â†“
<span class="hljs-selector-attr">[ç”Ÿæˆé˜¶æ®µ]</span> LLMåŸºäºä¸Šä¸‹æ–‡å›ç­”é—®é¢˜
  â†“
å‡†ç¡®ã€å¯è¿½æº¯çš„ç­”æ¡ˆ
</code></pre>
<h3 data-id="heading-3">RAGçš„æ ¸å¿ƒä¼˜åŠ¿</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»ŸLLM</th><th>RAGå¢å¼º</th></tr></thead><tbody><tr><td><strong>çŸ¥è¯†æ—¶æ•ˆæ€§</strong></td><td>ä¾èµ–è®­ç»ƒæ•°æ®ï¼ˆå¯èƒ½è¿‡æ—¶ï¼‰</td><td>åŸºäºæœ€æ–°çŸ¥è¯†åº“ âœ“</td></tr><tr><td><strong>å¯è¿½æº¯æ€§</strong></td><td>é»‘ç›’å›ç­”</td><td>å¯å¼•ç”¨å…·ä½“æ¥æº âœ“</td></tr><tr><td><strong>é¢†åŸŸä¸“ä¸šæ€§</strong></td><td>é€šç”¨çŸ¥è¯†</td><td>å‚ç›´é¢†åŸŸä¸“ä¸šçŸ¥è¯† âœ“</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>éœ€è¦å¤§æ¨¡å‹</td><td>å¯ç”¨å°æ¨¡å‹ âœ“</td></tr><tr><td><strong>éšç§</strong></td><td>æ•°æ®ä¸Šä¼ åˆ°å‚å•†</td><td>ç§æœ‰çŸ¥è¯†åº“ âœ“</td></tr></tbody></table>
<h3 data-id="heading-4">RAGçš„ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µ</h3>
<h4 data-id="heading-5">1. æ£€ç´¢ï¼ˆRetrievalï¼‰</h4>
<pre><code class="hljs language-css" lang="css">ç›®æ ‡ï¼šä»çŸ¥è¯†åº“ä¸­æ‰¾åˆ°ä¸ç”¨æˆ·é—®é¢˜æœ€ç›¸å…³çš„æ–‡æ¡£

æ–¹æ³•ï¼š
â”œâ”€ å…³é”®è¯åŒ¹é…ï¼ˆBM25ï¼‰ï¼šå¿«é€Ÿä½†ç²¾åº¦ä½
â”œâ”€ è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆå‘é‡ï¼‰ï¼šç²¾åº¦é«˜ï¼Œéœ€è¦Embedding
â””â”€ æ··åˆæ–¹æ³•ï¼šç»“åˆä¸¤è€…ä¼˜ç‚¹

è¿‡ç¨‹ï¼š
ç”¨æˆ·é—®é¢˜ â†’ å‘é‡åŒ– â†’ åœ¨å‘é‡åº“ä¸­æœç´¢
  â†“
è¿”å›<span class="hljs-attribute">top</span>-kç›¸å…³æ–‡æ¡£
</code></pre>
<h4 data-id="heading-6">2. å¢å¼ºï¼ˆAugmentationï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql">ç›®æ ‡ï¼šå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£èå…¥åˆ°LLMçš„è¾“å…¥ä¸­

æ–¹å¼ï¼š
â”œâ”€ è¿½åŠ åˆ°<span class="hljs-keyword">System</span> Prompt
â”œâ”€ æ’å…¥åˆ°ä¸Šä¸‹æ–‡ä¸­
â””â”€ ä½œä¸ºå·¥å…·è¾“å…¥

ç»“æœï¼š
LLMè·å¾—äº†é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œèƒ½åšå‡ºæ›´å¥½çš„å›ç­”
</code></pre>
<h4 data-id="heading-7">3. ç”Ÿæˆï¼ˆGenerationï¼‰</h4>
<pre><code class="hljs language-arduino" lang="arduino">ç›®æ ‡ï¼šåŸºäºå¢å¼ºåçš„è¾“å…¥ï¼Œç”Ÿæˆå‡†ç¡®çš„ç­”æ¡ˆ

ç‰¹ç‚¹ï¼š
â”œâ”€ å¯ä»¥å¼•ç”¨å…·ä½“æ¥æº
â”œâ”€ å›ç­”æ›´ä¸“ä¸šå’Œå‡†ç¡®
â””â”€ é¿å…<span class="hljs-string">"å¹»è§‰"</span>ï¼ˆç”Ÿæˆè™šå‡ä¿¡æ¯ï¼‰
</code></pre>
<hr/>
<h2 data-id="heading-8">12.2 RAGçš„å·¥ä½œåŸç†</h2>
<h3 data-id="heading-9">ä¸ºä»€ä¹ˆéœ€è¦RAGï¼Ÿ</h3>
<h4 data-id="heading-10">1. <strong>LLMçŸ¥è¯†çš„å±€é™æ€§</strong></h4>
<pre><code class="hljs language-vbnet" lang="vbnet">é—®é¢˜ï¼šLLMçš„è®­ç»ƒæ•°æ®æœ‰æˆªæ­¢æ—¥æœŸï¼Œæ— æ³•å›ç­”æœ€æ–°çš„é—®é¢˜

ç¤ºä¾‹ï¼š
<span class="hljs-symbol">Q:</span> <span class="hljs-string">"2024å¹´æœ€æ–°çš„AIæ³•è§„æ˜¯ä»€ä¹ˆï¼Ÿ"</span>
<span class="hljs-symbol">A:</span> æ¨¡å‹è®­ç»ƒäº<span class="hljs-number">2023</span>å¹´<span class="hljs-number">10</span>æœˆï¼Œæ— æ³•å›ç­”

è§£å†³ï¼šRAGå¯ä»¥ä»æœ€æ–°çš„çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯
</code></pre>
<h4 data-id="heading-11">2. <strong>é¢†åŸŸä¸“ä¸šæ€§è¦æ±‚</strong></h4>
<pre><code class="hljs language-vbnet" lang="vbnet">é—®é¢˜ï¼šé€šç”¨LLMå¯èƒ½ç¼ºä¹ç‰¹å®šé¢†åŸŸçš„ä¸“ä¸šçŸ¥è¯†

ç¤ºä¾‹ï¼š
<span class="hljs-symbol">Q:</span> <span class="hljs-string">"æˆ‘ä»¬å…¬å¸çš„äº§å‡æ”¿ç­–æ˜¯ä»€ä¹ˆï¼Ÿ"</span>
<span class="hljs-symbol">A:</span> é€šç”¨LLMåªèƒ½ç»™å‡ºé€šç”¨æ”¿ç­–ï¼Œä¸çŸ¥é“å…¬å¸å…·ä½“è§„å®š

è§£å†³ï¼šå°†å…¬å¸æ–‡ä»¶æ·»åŠ åˆ°çŸ¥è¯†åº“ï¼ŒRAGå¯ä»¥ç›´æ¥å›ç­”
</code></pre>
<h4 data-id="heading-12">3. <strong>æˆæœ¬å’Œéšç§</strong></h4>
<pre><code class="hljs language-diff" lang="diff">é—®é¢˜ï¼šå¤§æ¨¡å‹è´µï¼Œç§æœ‰ä¿¡æ¯ä¸èƒ½ä¸Šä¼ 

ç¤ºä¾‹ï¼š
<span class="hljs-deletion">- ç”¨æ›´å°çš„æ¨¡å‹ä¹Ÿèƒ½è·å¾—å‡†ç¡®çš„ä¸“ä¸šå›ç­”</span>
<span class="hljs-deletion">- ç§æœ‰çŸ¥è¯†ä¿ç•™åœ¨å†…éƒ¨ï¼Œä¸ä¸Šä¼ åˆ°äº‘ç«¯</span>

è§£å†³ï¼šç»“åˆRAGå’Œå°æ¨¡å‹ï¼ˆå¦‚qwen-turboï¼‰ï¼Œä½æˆæœ¬é«˜æ•ˆç‡
</code></pre>
<h3 data-id="heading-13">RAGçš„æ ¸å¿ƒä»·å€¼</h3>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    çŸ¥è¯†åº“ + å°æ¨¡å‹           â”‚
â”‚ = å¤§æ¨¡å‹çš„æ•ˆæœ + ä½æˆæœ¬      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸“ä¸šã€å‡†ç¡®ã€å¯è¿½æº¯         â”‚
â”‚   çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<hr/>
<h2 data-id="heading-14">12.3 RAGçš„å®ç°æ–¹å¼</h2>
<h3 data-id="heading-15">åŸºç¡€RAGå®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicRAGDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-comment">// 1. åˆ›å»ºçŸ¥è¯†åº“</span>
        System.out.println(<span class="hljs-string">"=== åˆå§‹åŒ–çŸ¥è¯†åº“ ===\n"</span>);
        
        <span class="hljs-type">Knowledge</span> <span class="hljs-variable">knowledge</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleEmbeddingKnowledge</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">DashScopeEmbeddingService</span>(),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryVectorStore</span>()
        );
        
        <span class="hljs-comment">// 2. æ·»åŠ å…¬å¸çŸ¥è¯†æ–‡æ¡£</span>
        System.out.println(<span class="hljs-string">"=== æ·»åŠ çŸ¥è¯†æ–‡æ¡£ ===\n"</span>);
        
        List&lt;Document&gt; documents = List.of(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(
                <span class="hljs-string">"äº§å‡æ”¿ç­–"</span>,
                <span class="hljs-string">"å¥³æ€§å‘˜å·¥äº«å—158å¤©äº§å‡ï¼Œå…¶ä¸­ï¼š"</span> +
                <span class="hljs-string">"- äº§å‰30å¤©\n"</span> +
                <span class="hljs-string">"- äº§å128å¤©\n"</span> +
                <span class="hljs-string">"ç¬¦åˆæ¡ä»¶çš„å¯ç”³è¯·å»¶é•¿30å¤©"</span>
            ),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(
                <span class="hljs-string">"å¹´å‡æ”¿ç­–"</span>,
                <span class="hljs-string">"å¹´å‡è®¡ç®—ï¼š\n"</span> +
                <span class="hljs-string">"- å…¥èŒ1-10å¹´ï¼š10å¤©\n"</span> +
                <span class="hljs-string">"- å…¥èŒ10-20å¹´ï¼š15å¤©\n"</span> +
                <span class="hljs-string">"- å…¥èŒ20å¹´ä»¥ä¸Šï¼š20å¤©\n"</span> +
                <span class="hljs-string">"å¹´å‡å¯ä»¥è·¨å¹´ç»“è½¬ï¼Œæœ€å¤š3å¹´"</span>
            ),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(
                <span class="hljs-string">"è¿œç¨‹å·¥ä½œæ”¿ç­–"</span>,
                <span class="hljs-string">"ç”³è¯·æ¡ä»¶ï¼š\n"</span> +
                <span class="hljs-string">"- å…¥èŒæ»¡6ä¸ªæœˆ\n"</span> +
                <span class="hljs-string">"- æ€§èƒ½è¯„çº§ä¸ä½äºB\n"</span> +
                <span class="hljs-string">"é¢‘ç‡ï¼šæ¯å‘¨æœ€å¤š3å¤©\n"</span> +
                <span class="hljs-string">"éœ€è¦ä¸»ç®¡æ‰¹å‡†"</span>
            ),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(
                <span class="hljs-string">"æŠ€æœ¯æ ˆ"</span>,
                <span class="hljs-string">"åç«¯ï¼šJava 17 + Spring Boot 3.0 + Spring Cloud\n"</span> +
                <span class="hljs-string">"æ•°æ®åº“ï¼šMySQL + Redis + Elasticsearch\n"</span> +
                <span class="hljs-string">"éƒ¨ç½²ï¼šKubernetes + Docker\n"</span> +
                <span class="hljs-string">"ç›‘æ§ï¼šPrometheus + Grafana"</span>
            )
        );
        
        knowledge.addDocuments(documents).block();
        System.out.println(<span class="hljs-string">"å·²æ·»åŠ  "</span> + documents.size() + <span class="hljs-string">" ä¸ªæ–‡æ¡£\n"</span>);
        
        <span class="hljs-comment">// 3. åˆ›å»ºæ”¯æŒRAGçš„Agent</span>
        System.out.println(<span class="hljs-string">"=== åˆ›å»ºæ”¯æŒRAGçš„Agent ===\n"</span>);
        
        <span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
            .name(<span class="hljs-string">"CompanyInfoAgent"</span>)
            .model(model)
            .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
            .systemPrompt(<span class="hljs-string">"ä½ æ˜¯å…¬å¸å‘˜å·¥çš„HRåŠ©æ‰‹ï¼Œå›ç­”å…³äºå…¬å¸æ”¿ç­–å’ŒæŠ€æœ¯çš„é—®é¢˜ã€‚"</span> +
                         <span class="hljs-string">"å¦‚æœä½¿ç”¨äº†çŸ¥è¯†åº“ä¸­çš„ä¿¡æ¯ï¼Œè¯·æ˜ç¡®å¼•ç”¨æ¥æºã€‚"</span>)
            .hooks(List.of(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">RAGHook</span>(knowledge)
            ))
            .build();
        
        <span class="hljs-comment">// 4. æé—®</span>
        System.out.println(<span class="hljs-string">"=== æé—®ç¯èŠ‚ ===\n"</span>);
        
        String[] questions = {
            <span class="hljs-string">"æˆ‘åˆšå…¥èŒï¼Œæƒ³äº†è§£å…¬å¸çš„å¹´å‡æ”¿ç­–"</span>,
            <span class="hljs-string">"èƒ½å¦å‘Šè¯‰æˆ‘ä»¬å…¬å¸ä½¿ç”¨çš„æŠ€æœ¯æ ˆï¼Ÿ"</span>,
            <span class="hljs-string">"æˆ‘éœ€è¦ç”³è¯·äº§å‡ï¼Œèƒ½äº«å—å¤šä¹…ï¼Ÿ"</span>
        };
        
        <span class="hljs-keyword">for</span> (String question : questions) {
            System.out.println(<span class="hljs-string">"Q: "</span> + question);
            
            <span class="hljs-type">Msg</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> agent.call(Msg.builder()
                .role(MsgRole.USER)
                .textContent(question)
                .build()).block();
            
            System.out.println(<span class="hljs-string">"A: "</span> + response.getTextContent() + <span class="hljs-string">"\n"</span>);
        }
    }
    
    <span class="hljs-comment">/**
     * ç®€å•çš„RAG Hookå®ç°
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RAGHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Knowledge knowledge;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">RAGHook</span><span class="hljs-params">(Knowledge knowledge)</span> {
            <span class="hljs-built_in">this</span>.knowledge = knowledge;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
            <span class="hljs-keyword">if</span> (!(event <span class="hljs-keyword">instanceof</span> PreReasoningEvent pre)) {
                <span class="hljs-keyword">return</span> Mono.just(event);
            }
            
            <span class="hljs-comment">// ä»ç”¨æˆ·é—®é¢˜ä¸­æå–æŸ¥è¯¢</span>
            List&lt;Msg&gt; messages = pre.getInputMessages();
            <span class="hljs-keyword">if</span> (messages.isEmpty()) {
                <span class="hljs-keyword">return</span> Mono.just(event);
            }
            
            <span class="hljs-type">String</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> messages.get(messages.size() - <span class="hljs-number">1</span>).getTextContent();
            
            <span class="hljs-comment">// æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
            <span class="hljs-keyword">return</span> knowledge.retrieve(query, RetrieveConfig.builder()
                .limit(<span class="hljs-number">3</span>)
                .scoreThreshold(<span class="hljs-number">0.5</span>)
                .build())
            .flatMapMany(documents -&gt; {
                <span class="hljs-comment">// å°†æ£€ç´¢ç»“æœä½œä¸ºSystemæ¶ˆæ¯æ’å…¥</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">ragContext</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ç›¸å…³çŸ¥è¯†åº“ä¿¡æ¯ï¼š\n"</span>;
                <span class="hljs-keyword">for</span> (Document doc : documents) {
                    ragContext += <span class="hljs-string">"\nã€"</span> + doc.getTitle() + <span class="hljs-string">"ã€‘\n"</span> +
                                 doc.getContent() + <span class="hljs-string">"\n"</span>;
                }
                
                <span class="hljs-type">Msg</span> <span class="hljs-variable">ragMsg</span> <span class="hljs-operator">=</span> Msg.builder()
                    .role(MsgRole.SYSTEM)
                    .textContent(ragContext)
                    .build();
                
                List&lt;Msg&gt; enhanced = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
                enhanced.add(ragMsg);
                enhanced.addAll(messages);
                
                pre.setInputMessages(enhanced);
                
                <span class="hljs-keyword">return</span> Mono.just(event);
            })
            .thenReturn(event);
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-number">20</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-16">ä½¿ç”¨å·¥å…·æ–¹å¼çš„RAG</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolBasedRAGDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-comment">// åˆ›å»ºçŸ¥è¯†åº“</span>
        <span class="hljs-type">Knowledge</span> <span class="hljs-variable">knowledge</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleEmbeddingKnowledge</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">DashScopeEmbeddingService</span>(),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryVectorStore</span>()
        );
        
        knowledge.addDocuments(getSampleDocuments()).block();
        
        <span class="hljs-comment">// åˆ›å»ºAgentï¼Œé€šè¿‡å·¥å…·è€Œä¸æ˜¯Hookä½¿ç”¨RAG</span>
        <span class="hljs-type">ReActAgent</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> ReActAgent.builder()
            .name(<span class="hljs-string">"ToolBasedRAGAgent"</span>)
            .model(model)
            .toolkit(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Toolkit</span>()
                .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RAGTools</span>(knowledge)))
            .systemPrompt(<span class="hljs-string">"""
                ä½ æ˜¯ä¸€ä¸ªä¿¡æ¯åŠ©æ‰‹ã€‚
                å½“éœ€è¦æŸ¥è¯¢ä¿¡æ¯æ—¶ï¼Œä½¿ç”¨searchKnowledgeBaseå·¥å…·ã€‚
                """</span>)
            .build();
        
        <span class="hljs-comment">// æé—®æ—¶ï¼ŒAgentä¼šä¸»åŠ¨è°ƒç”¨RAGå·¥å…·</span>
        <span class="hljs-type">Msg</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> agent.call(Msg.builder()
            .textContent(<span class="hljs-string">"è¯·å‘Šè¯‰æˆ‘äº§å‡çš„å…·ä½“è§„å®š"</span>)
            .build()).block();
        
        System.out.println(response.getTextContent());
    }
    
    <span class="hljs-comment">/**
     * æä¾›RAGåŠŸèƒ½çš„å·¥å…·é›†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RAGTools</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Knowledge knowledge;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">RAGTools</span><span class="hljs-params">(Knowledge knowledge)</span> {
            <span class="hljs-built_in">this</span>.knowledge = knowledge;
        }
        
        <span class="hljs-meta">@Tool(description = "åœ¨çŸ¥è¯†åº“ä¸­æœç´¢ç›¸å…³ä¿¡æ¯")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">searchKnowledgeBase</span><span class="hljs-params">(String query)</span> {
            List&lt;Document&gt; results = knowledge.retrieve(query, 
                RetrieveConfig.builder()
                    .limit(<span class="hljs-number">5</span>)
                    .scoreThreshold(<span class="hljs-number">0.5</span>)
                    .build())
            .block();
            
            <span class="hljs-keyword">if</span> (results.isEmpty()) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"çŸ¥è¯†åº“ä¸­æœªæ‰¾åˆ°ç›¸å…³ä¿¡æ¯"</span>;
            }
            
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"æœç´¢ç»“æœï¼š\n"</span>);
            <span class="hljs-keyword">for</span> (Document doc : results) {
                sb.append(<span class="hljs-string">"ã€"</span>).append(doc.getTitle()).append(<span class="hljs-string">"ã€‘\n"</span>);
                sb.append(doc.getContent()).append(<span class="hljs-string">"\n\n"</span>);
            }
            <span class="hljs-keyword">return</span> sb.toString();
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Document&gt; <span class="hljs-title function_">getSampleDocuments</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> List.of(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"äº§å‡æ”¿ç­–"</span>, <span class="hljs-string">"å¥³æ€§å‘˜å·¥äº«å—158å¤©äº§å‡..."</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"å¹´å‡æ”¿ç­–"</span>, <span class="hljs-string">"å¹´å‡è®¡ç®—ï¼šå…¥èŒ1-10å¹´ï¼š10å¤©..."</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"è¿œç¨‹å·¥ä½œæ”¿ç­–"</span>, <span class="hljs-string">"ç”³è¯·æ¡ä»¶ï¼šå…¥èŒæ»¡6ä¸ªæœˆ..."</span>)
        );
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-17">12.4 ç”Ÿäº§åœºæ™¯ï¼šä¼ä¸šçŸ¥è¯†åº“QAç³»ç»Ÿ</h2>
<h3 data-id="heading-18">åœºæ™¯æè¿°</h3>
<pre><code class="hljs language-markdown" lang="markdown">ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçŸ¥è¯†åº“ç³»ç»Ÿï¼š
<span class="hljs-bullet">1.</span> ç”¨æˆ·æå‡ºå„ç§é—®é¢˜ï¼ˆHRã€ITã€äº§å“ç­‰ï¼‰
<span class="hljs-bullet">2.</span> ç³»ç»Ÿè‡ªåŠ¨æ£€ç´¢ç›¸å…³çŸ¥è¯†åº“æ–‡æ¡£
<span class="hljs-bullet">3.</span> åŸºäºæ£€ç´¢ç»“æœç»™å‡ºå‡†ç¡®çš„å›ç­”
<span class="hljs-bullet">4.</span> è¿½è¸ªæœªèƒ½å›ç­”çš„é—®é¢˜ï¼Œä¸æ–­å®Œå–„çŸ¥è¯†åº“
</code></pre>
<h3 data-id="heading-19">å®ç°ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EnterpriseKnowledgeQASystem</span> {
    
    <span class="hljs-comment">/**
     * çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KnowledgebaseManager</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Knowledge knowledge;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReActAgent qaAgent;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Integer&gt; unansweredQuestions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">KnowledgebaseManager</span><span class="hljs-params">(Model model)</span> {
            <span class="hljs-built_in">this</span>.knowledge = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleEmbeddingKnowledge</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">DashScopeEmbeddingService</span>(),
                createPersistentVectorStore()
            );
            
            <span class="hljs-built_in">this</span>.qaAgent = ReActAgent.builder()
                .name(<span class="hljs-string">"EnterpriseQAAgent"</span>)
                .model(model)
                .memory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryMemory</span>())
                .toolkit(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Toolkit</span>()
                    .registerObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KBTools</span>(knowledge)))
                .hooks(List.of(
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">RAGHook</span>(knowledge),
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">FeedbackHook</span>(unansweredQuestions)
                ))
                .systemPrompt(getSystemPrompt())
                .build();
            
            <span class="hljs-comment">// åˆå§‹åŒ–çŸ¥è¯†åº“</span>
            initializeKnowledgebase();
        }
        
        <span class="hljs-comment">/**
         * å›ç­”ç”¨æˆ·é—®é¢˜
         */</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">answerQuestion</span><span class="hljs-params">(String question)</span> {
            System.out.println(<span class="hljs-string">"\nç”¨æˆ·é—®é¢˜ï¼š"</span> + question);
            
            <span class="hljs-type">Msg</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> qaAgent.call(Msg.builder()
                .role(MsgRole.USER)
                .textContent(question)
                .build()).block();
            
            <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> response.getTextContent();
            System.out.println(<span class="hljs-string">"ç³»ç»Ÿå›ç­”ï¼š"</span> + answer);
            
            <span class="hljs-keyword">return</span> answer;
        }
        
        <span class="hljs-comment">/**
         * ç”¨æˆ·åé¦ˆ
         */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">provideFeedback</span><span class="hljs-params">(String question, String feedback)</span> {
            System.out.println(<span class="hljs-string">"\nç”¨æˆ·åé¦ˆï¼š"</span> + feedback);
            
            <span class="hljs-comment">// è®°å½•åé¦ˆï¼Œç”¨äºæŒç»­æ”¹è¿›</span>
            <span class="hljs-keyword">if</span> (feedback.contains(<span class="hljs-string">"ä¸å‡†ç¡®"</span>) || feedback.contains(<span class="hljs-string">"ä¸ç¬¦åˆ"</span>)) {
                System.out.println(<span class="hljs-string">"âš ï¸ è®°å½•ä¸ºä¸å‡†ç¡®å›ç­”ï¼Œéœ€è¦æ”¹è¿›çŸ¥è¯†åº“"</span>);
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"âœ“ æ„Ÿè°¢åé¦ˆï¼Œç”¨äºæ”¹è¿›ç³»ç»Ÿ"</span>);
            }
        }
        
        <span class="hljs-comment">/**
         * æ·»åŠ æ–°æ–‡æ¡£åˆ°çŸ¥è¯†åº“
         */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addKnowledgeDocuments</span><span class="hljs-params">(List&lt;Document&gt; documents)</span> {
            knowledge.addDocuments(documents).block();
            System.out.println(<span class="hljs-string">"å·²æ·»åŠ  "</span> + documents.size() + <span class="hljs-string">" ä¸ªæ–°æ–‡æ¡£"</span>);
        }
        
        <span class="hljs-comment">/**
         * è·å–æœªèƒ½å›ç­”çš„é—®é¢˜ç»Ÿè®¡
         */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showUnansweredStatistics</span><span class="hljs-params">()</span> {
            System.out.println(<span class="hljs-string">"\n=== æœªèƒ½å›ç­”çš„é—®é¢˜ç»Ÿè®¡ ==="</span>);
            unansweredQuestions.entrySet().stream()
                .sorted((a, b) -&gt; b.getValue().compareTo(a.getValue()))
                .forEach(entry -&gt; 
                    System.out.println(<span class="hljs-string">"ã€Œ"</span> + entry.getKey() + <span class="hljs-string">"ã€ï¼š"</span> + 
                        entry.getValue() + <span class="hljs-string">"æ¬¡"</span>));
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initializeKnowledgebase</span><span class="hljs-params">()</span> {
            List&lt;Document&gt; docs = List.of(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"å…¥èŒæµç¨‹"</span>, <span class="hljs-string">"æ–°å‘˜å·¥å…¥èŒæµç¨‹ï¼š..."</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"åŠå…¬ç³»ç»Ÿ"</span>, <span class="hljs-string">"å…¬å¸ä½¿ç”¨ï¼šOAç³»ç»Ÿã€é’‰é’‰ã€ä¼ä¸šé‚®ç®±..."</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"å·®æ—…è´¹è§„å®š"</span>, <span class="hljs-string">"å›½å†…å‡ºå·®ï¼š...ï¼Œå›½é™…å‡ºå·®ï¼š..."</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"é‡‡è´­æµç¨‹"</span>, <span class="hljs-string">"å°äº5000å…ƒï¼šéƒ¨é—¨æ‰¹å‡†å³å¯..."</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(<span class="hljs-string">"ç»©æ•ˆè¯„ä¼°"</span>, <span class="hljs-string">"å¹´åº¦è¯„ä¼°å‘¨æœŸï¼š...ï¼Œæ™‹å‡æ ‡å‡†ï¼š..."</span>)
            );
            addKnowledgeDocuments(docs);
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getSystemPrompt</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"""
                ä½ æ˜¯ä¼ä¸šçŸ¥è¯†åº“çš„AIåŠ©æ‰‹ï¼Œå¸®åŠ©å‘˜å·¥äº†è§£å…¬å¸æ”¿ç­–å’Œæµç¨‹ã€‚
                
                åŸåˆ™ï¼š
                1. ä¼˜å…ˆä½¿ç”¨çŸ¥è¯†åº“ä¿¡æ¯å›ç­”é—®é¢˜
                2. å¦‚æœçŸ¥è¯†åº“ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œæ˜ç¡®è¯´æ˜
                3. å¯¹äºæ•æ„Ÿé—®é¢˜ï¼ˆå¦‚è–ªèµ„ã€ä¸ªäººéšç§ï¼‰ï¼Œå»ºè®®è”ç³»HR
                4. å›ç­”æ—¶æ˜ç¡®å¼•ç”¨çŸ¥è¯†åº“æ¥æº
                5. é¼“åŠ±ç”¨æˆ·åé¦ˆï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›
                
                å¦‚æœæ— æ³•å›ç­”ï¼Œè¯·è¯´ï¼š"æŠ±æ­‰ï¼Œæˆ‘åœ¨çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ä¿¡æ¯ï¼Œ
                è¯·è”ç³»ç›¸åº”éƒ¨é—¨æˆ–HRã€‚"
                """</span>;
        }
        
        <span class="hljs-keyword">private</span> VectorStore <span class="hljs-title function_">createPersistentVectorStore</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// åœ¨ç”Ÿäº§ä¸­åº”è¯¥ä½¿ç”¨å¦‚Milvusã€Weaviateç­‰å‘é‡æ•°æ®åº“</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryVectorStore</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * çŸ¥è¯†åº“å·¥å…·é›†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KBTools</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Knowledge knowledge;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">KBTools</span><span class="hljs-params">(Knowledge knowledge)</span> {
            <span class="hljs-built_in">this</span>.knowledge = knowledge;
        }
        
        <span class="hljs-meta">@Tool(description = "åœ¨çŸ¥è¯†åº“ä¸­æœç´¢")</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">search</span><span class="hljs-params">(String keyword)</span> {
            List&lt;Document&gt; results = knowledge.retrieve(keyword,
                RetrieveConfig.builder()
                    .limit(<span class="hljs-number">5</span>)
                    .scoreThreshold(<span class="hljs-number">0.5</span>)
                    .build())
            .block();
            
            <span class="hljs-keyword">return</span> formatResults(results);
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">formatResults</span><span class="hljs-params">(List&lt;Document&gt; documents)</span> {
            <span class="hljs-keyword">if</span> (documents.isEmpty()) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªæ‰¾åˆ°ç›¸å…³æ–‡æ¡£"</span>;
            }
            
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
            <span class="hljs-keyword">for</span> (Document doc : documents) {
                sb.append(<span class="hljs-string">"ã€"</span>).append(doc.getTitle()).append(<span class="hljs-string">"ã€‘\n"</span>)
                  .append(doc.getContent()).append(<span class="hljs-string">"\n\n"</span>);
            }
            <span class="hljs-keyword">return</span> sb.toString();
        }
    }
    
    <span class="hljs-comment">/**
     * åé¦ˆHookï¼šè®°å½•æ— æ³•å›ç­”çš„é—®é¢˜
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeedbackHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Integer&gt; unansweredQuestions;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">FeedbackHook</span><span class="hljs-params">(Map&lt;String, Integer&gt; unansweredQuestions)</span> {
            <span class="hljs-built_in">this</span>.unansweredQuestions = unansweredQuestions;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
            <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> PostReasoningEvent post) {
                <span class="hljs-comment">// æ£€æŸ¥å›ç­”è´¨é‡</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> post.getReasoningResult();
                
                <span class="hljs-keyword">if</span> (response.contains(<span class="hljs-string">"æ— æ³•"</span>) || response.contains(<span class="hljs-string">"ä¸æ¸…æ¥š"</span>)) {
                    <span class="hljs-comment">// è®°å½•æ— æ³•å›ç­”çš„é—®é¢˜</span>
                    <span class="hljs-type">String</span> <span class="hljs-variable">question</span> <span class="hljs-operator">=</span> extractQuestion(post.getInputMessages());
                    unansweredQuestions.put(question,
                        unansweredQuestions.getOrDefault(question, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
                }
            }
            <span class="hljs-keyword">return</span> Mono.just(event);
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractQuestion</span><span class="hljs-params">(List&lt;Msg&gt; messages)</span> {
            <span class="hljs-keyword">if</span> (!messages.isEmpty()) {
                <span class="hljs-keyword">return</span> messages.get(messages.size() - <span class="hljs-number">1</span>).getTextContent();
            }
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Unknown"</span>;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * RAG Hook
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RAGHook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Hook</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Knowledge knowledge;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">RAGHook</span><span class="hljs-params">(Knowledge knowledge)</span> {
            <span class="hljs-built_in">this</span>.knowledge = knowledge;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HookEvent</span>&gt; Mono&lt;T&gt; <span class="hljs-title function_">onEvent</span><span class="hljs-params">(T event)</span> {
            <span class="hljs-keyword">if</span> (!(event <span class="hljs-keyword">instanceof</span> PreReasoningEvent pre)) {
                <span class="hljs-keyword">return</span> Mono.just(event);
            }
            
            <span class="hljs-comment">// æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
            List&lt;Msg&gt; messages = pre.getInputMessages();
            <span class="hljs-type">String</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> messages.isEmpty() ? <span class="hljs-string">""</span> : 
                messages.get(messages.size() - <span class="hljs-number">1</span>).getTextContent();
            
            <span class="hljs-keyword">if</span> (query.isEmpty()) {
                <span class="hljs-keyword">return</span> Mono.just(event);
            }
            
            <span class="hljs-keyword">return</span> knowledge.retrieve(query, RetrieveConfig.builder()
                .limit(<span class="hljs-number">3</span>)
                .scoreThreshold(<span class="hljs-number">0.5</span>)
                .build())
            .flatMapMany(documents -&gt; {
                <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> buildRAGContext(documents);
                
                <span class="hljs-type">Msg</span> <span class="hljs-variable">ragMsg</span> <span class="hljs-operator">=</span> Msg.builder()
                    .role(MsgRole.SYSTEM)
                    .textContent(context)
                    .build();
                
                List&lt;Msg&gt; enhanced = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
                enhanced.add(ragMsg);
                enhanced.addAll(messages);
                
                pre.setInputMessages(enhanced);
                
                <span class="hljs-keyword">return</span> Mono.just(event);
            })
            .thenReturn(event);
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">buildRAGContext</span><span class="hljs-params">(List&lt;Document&gt; documents)</span> {
            <span class="hljs-keyword">if</span> (documents.isEmpty()) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
            }
            
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"ã€æ¥è‡ªçŸ¥è¯†åº“çš„ç›¸å…³ä¿¡æ¯ã€‘\n"</span>);
            <span class="hljs-keyword">for</span> (Document doc : documents) {
                sb.append(<span class="hljs-string">"\n"</span>).append(doc.getTitle()).append(<span class="hljs-string">"ï¼š\n"</span>)
                  .append(doc.getContent()).append(<span class="hljs-string">"\n"</span>);
            }
            <span class="hljs-keyword">return</span> sb.toString();
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-number">20</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * æµ‹è¯•ä¸»ç¨‹åº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Model</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> DashScopeModel.builder()
            .modelName(<span class="hljs-string">"qwen-turbo"</span>)
            .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
            .build();
        
        <span class="hljs-type">KnowledgebaseManager</span> <span class="hljs-variable">kb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KnowledgebaseManager</span>(model);
        
        <span class="hljs-comment">// å›ç­”ä¸€ç³»åˆ—é—®é¢˜</span>
        String[] questions = {
            <span class="hljs-string">"æ–°å‘˜å·¥å…¥èŒæœ‰å“ªäº›æµç¨‹ï¼Ÿ"</span>,
            <span class="hljs-string">"æˆ‘è¦å‡ºå›½å‡ºå·®ï¼Œæœ‰ä»€ä¹ˆè§„å®šå—ï¼Ÿ"</span>,
            <span class="hljs-string">"æ€æ ·ç”³è¯·é‡‡è´­ï¼Ÿ"</span>,
            <span class="hljs-string">"æ— æ•Œé—®é¢˜ï¼Ÿ"</span>  <span class="hljs-comment">// æ•…æ„é—®ä¸€ä¸ªæ— æ³•å›ç­”çš„é—®é¢˜</span>
        };
        
        <span class="hljs-keyword">for</span> (String question : questions) {
            kb.answerQuestion(question);
            kb.provideFeedback(question, <span class="hljs-string">"âœ“ å¾ˆæœ‰å¸®åŠ©"</span>);
        }
        
        <span class="hljs-comment">// æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯</span>
        kb.showUnansweredStatistics();
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-20">12.5 æ”¯æŒçš„çŸ¥è¯†åº“åç«¯</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å†…å­˜å‘é‡åº“ï¼ˆå¼€å‘ç”¨ï¼‰</span>
<span class="hljs-type">Knowledge</span> <span class="hljs-variable">kb1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleEmbeddingKnowledge</span>(
    embeddingService,
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryVectorStore</span>()
);

<span class="hljs-comment">// 2. é˜¿é‡Œäº‘ç™¾ç‚¼</span>
<span class="hljs-type">Knowledge</span> <span class="hljs-variable">kb2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BailianKnowledge</span>(
    apiKey,
    workspaceId,
    datasetId
);

<span class="hljs-comment">// 3. Dify</span>
<span class="hljs-type">Knowledge</span> <span class="hljs-variable">kb3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DifyKnowledge</span>(
    baseUrl,
    apiKey
);

<span class="hljs-comment">// 4. RAGFlow</span>
<span class="hljs-type">Knowledge</span> <span class="hljs-variable">kb4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RAGFlowKnowledge</span>(
    baseUrl,
    apiKey
);

<span class="hljs-comment">// 5. è‡ªå»ºå‘é‡åº“ï¼ˆMilvusã€Weaviateç­‰ï¼‰</span>
<span class="hljs-type">Knowledge</span> <span class="hljs-variable">kb5</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomVectorKnowledge</span>(
    customVectorStore,
    customEmbeddingService
);
</code></pre>
<hr/>
<h2 data-id="heading-21">æœ¬ç« æ€»ç»“</h2>
<p>æœ¬ç« ä»‹ç»äº†<strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰<strong>ç³»ç»Ÿï¼Œè¿™æ˜¯è®©Agent</strong>åŸºäºæœ€æ–°çŸ¥è¯†åº“å›ç­”é—®é¢˜</strong>çš„æ ¸å¿ƒæŠ€æœ¯ï¼š</p>
<h3 data-id="heading-22">æ ¸å¿ƒè¦ç‚¹</h3>
<ul>
<li>RAGæ˜¯æ£€ç´¢+ç”Ÿæˆçš„æ··åˆæ¨¡å¼</li>
<li>æ”¯æŒæœ€æ–°çŸ¥è¯†ã€é¢†åŸŸä¸“ä¸šæ€§ã€æˆæœ¬ä¼˜åŒ–</li>
<li>é€šè¿‡Hookæˆ–å·¥å…·é›†æˆRAGåŠŸèƒ½</li>
</ul>
<h3 data-id="heading-23">ä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>ä¼ä¸šçŸ¥è¯†åº“QAç³»ç»Ÿ</li>
<li>æ–‡æ¡£åŸºç¡€çš„å®¢æœ</li>
<li>æŒç»­å­¦ä¹ å’ŒçŸ¥è¯†ç§¯ç´¯</li>
<li>ç§æœ‰ä¿¡æ¯çš„å®‰å…¨å¤„ç†</li>
</ul>
<hr/>
<h2 data-id="heading-24">ä¸‹ä¸€ç« é¢„å‘Š</h2>
<p><strong>ç¬¬13ç« ï¼šç»“æ„åŒ–è¾“å‡ºï¼ˆStructured Outputï¼‰</strong></p>
<p>å½“Agentéœ€è¦<strong>è¿”å›æœºå™¨å¯è§£æçš„æ•°æ®</strong>è€Œä¸æ˜¯è‡ªç”±æ–‡æœ¬æ—¶ï¼Œç»“æ„åŒ–è¾“å‡ºå°±å˜å¾—è‡³å…³é‡è¦ã€‚ç¬¬13ç« å°†ä»‹ç»å¦‚ä½•ç¡®ä¿LLMè¿”å›ç±»å‹å®‰å…¨çš„ã€ç»“æ„åŒ–çš„æ•°æ®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[npm/yarn/pnpm åŸç†ä¸é€‰å‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7589475923696975891</link>    <guid>https://juejin.cn/post/7589475923696975891</guid>    <pubDate>2025-12-30T09:27:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589475923696975891" data-draft-id="7589475923696959507" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="npm/yarn/pnpm åŸç†ä¸é€‰å‹æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T09:27:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€Ÿä¸ªç«er"/> <meta itemprop="url" content="https://juejin.cn/user/2225067265915783"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            npm/yarn/pnpm åŸç†ä¸é€‰å‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067265915783/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€Ÿä¸ªç«er
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T09:27:45.000Z" title="Tue Dec 30 2025 09:27:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">npm/yarn/pnpm æ·±åº¦å¯¹æ¯”ï¼šåŒ…ç®¡ç†å·¥å…·çš„åº•å±‚åŸç†ä¸é€‰å‹</h2>
<blockquote>
<p>ä» node_modules çš„é»‘æ´è¯´èµ·ï¼Œå‰–æ npmã€yarnã€pnpm çš„ä¾èµ–è§£æç®—æ³•ã€å®‰è£…ç­–ç•¥ã€é”æ–‡ä»¶æœºåˆ¶ï¼Œææ‡‚ä¸ºä»€ä¹ˆ pnpm èƒ½çœ 50% ç£ç›˜ç©ºé—´ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€åŒ…ç®¡ç†å™¨æ¼”è¿›å²</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">2010</span> <span class="hljs-string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span> <span class="hljs-number">2025</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">2010:</span> <span class="hljs-string">npm</span> <span class="hljs-string">è¯ç”Ÿï¼ˆéš</span> <span class="hljs-string">Node.js</span> <span class="hljs-string">ä¸€èµ·å‘å¸ƒï¼‰</span>
  <span class="hljs-string">â”‚</span>         <span class="hljs-string">â””â”€</span> <span class="hljs-string">åµŒå¥—ä¾èµ–ï¼Œnode_modules</span> <span class="hljs-string">é»‘æ´çš„å¼€å§‹</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">2016:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">å‘å¸ƒï¼ˆFacebookï¼‰</span>
  <span class="hljs-string">â”‚</span>         <span class="hljs-string">â””â”€</span> <span class="hljs-string">æ‰å¹³åŒ–</span> <span class="hljs-string">+</span> <span class="hljs-string">lockfileï¼Œè§£å†³ä¾èµ–åœ°ç‹±</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">2017:</span> <span class="hljs-string">npm</span> <span class="hljs-number">5.0</span>
  <span class="hljs-string">â”‚</span>         <span class="hljs-string">â””â”€</span> <span class="hljs-string">å¼•å…¥</span> <span class="hljs-string">package-lock.jsonï¼Œè¿½èµ¶</span> <span class="hljs-string">yarn</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">2017:</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">å‘å¸ƒ</span>
  <span class="hljs-string">â”‚</span>         <span class="hljs-string">â””â”€</span> <span class="hljs-string">ç¡¬é“¾æ¥</span> <span class="hljs-string">+</span> <span class="hljs-string">ç¬¦å·é“¾æ¥ï¼Œé©å‘½æ€§æ¶æ„</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">2020:</span> <span class="hljs-string">yarn</span> <span class="hljs-number">2</span> <span class="hljs-string">(Berry)</span>
  <span class="hljs-string">â”‚</span>         <span class="hljs-string">â””â”€</span> <span class="hljs-string">Plug'n'Playï¼Œé›¶</span> <span class="hljs-string">node_modules</span>
  <span class="hljs-string">â”‚</span>
  <span class="hljs-string">â””â”€</span> <span class="hljs-attr">2024:</span> <span class="hljs-string">npm/yarn/pnpm</span> <span class="hljs-string">ä¸‰è¶³é¼ç«‹</span>
            <span class="hljs-string">â””â”€</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">å¸‚åœºä»½é¢å¿«é€Ÿå¢é•¿</span>
</code></pre>
<h3 data-id="heading-2">äºŒã€node_modules ç»“æ„æ¼”è¿›</h3>
<h4 data-id="heading-3">2.1 npm v2ï¼šåµŒå¥—åœ°ç‹±</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">node_modules/
â”œâ”€â”€ <span class="hljs-symbol">A@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ <span class="hljs-symbol">B@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”‚           â””â”€â”€ node_modules/
â”‚               â””â”€â”€ <span class="hljs-symbol">C@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”œâ”€â”€ <span class="hljs-symbol">D@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ <span class="hljs-symbol">B@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/        â† é‡å¤ï¼
â”‚           â””â”€â”€ node_modules/
â”‚               â””â”€â”€ <span class="hljs-symbol">C@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/  â† é‡å¤ï¼
â””â”€â”€ <span class="hljs-symbol">E@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
    â””â”€â”€ node_modules/
        â””â”€â”€ <span class="hljs-symbol">B@</span><span class="hljs-number">2.0</span><span class="hljs-number">.0</span>/        â† ä¸åŒç‰ˆæœ¬
            â””â”€â”€ node_modules/
                â””â”€â”€ <span class="hljs-symbol">C@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/  â† åˆé‡å¤ï¼
</code></pre>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<ul>
<li>ğŸ”´ è·¯å¾„è¿‡é•¿ï¼ˆWindows 260 å­—ç¬¦é™åˆ¶ï¼‰</li>
<li>ğŸ”´ å¤§é‡é‡å¤ä¾èµ–ï¼Œç£ç›˜çˆ†ç‚¸</li>
<li>ğŸ”´ å®‰è£…é€Ÿåº¦æ…¢</li>
</ul>
<h4 data-id="heading-4">2.2 npm v3+ / yarnï¼šæ‰å¹³åŒ–</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">node_modules/
â”œâ”€â”€ <span class="hljs-symbol">A@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”œâ”€â”€ <span class="hljs-symbol">B@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/          â† æå‡åˆ°é¡¶å±‚
â”œâ”€â”€ <span class="hljs-symbol">C@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/          â† æå‡åˆ°é¡¶å±‚
â”œâ”€â”€ <span class="hljs-symbol">D@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”œâ”€â”€ <span class="hljs-symbol">E@</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ <span class="hljs-symbol">B@</span><span class="hljs-number">2.0</span><span class="hljs-number">.0</span>/  â† ç‰ˆæœ¬å†²çªï¼Œä¿ç•™åµŒå¥—
â””â”€â”€ ...
</code></pre>
<p><strong>è§£å†³äº†</strong>ï¼šè·¯å¾„è¿‡é•¿ã€éƒ¨åˆ†é‡å¤</p>
<p><strong>æ–°é—®é¢˜</strong>ï¼š</p>
<ul>
<li>ğŸ”´ <strong>å¹½çµä¾èµ–</strong>ï¼šå¯ä»¥ require æœªå£°æ˜çš„åŒ…</li>
<li>ğŸ”´ <strong>ä¾èµ–åˆ†èº«</strong>ï¼šåŒä¸€ä¸ªåŒ…å¯èƒ½æœ‰å¤šä¸ªå‰¯æœ¬</li>
<li>ğŸ”´ <strong>ä¸ç¡®å®šæ€§</strong>ï¼šå®‰è£…é¡ºåºå½±å“ç»“æ„</li>
</ul>
<h4 data-id="heading-5">2.3 pnpmï¼šå†…å®¹å¯»å€ + ç¬¦å·é“¾æ¥</h4>
<pre><code class="hljs language-less" lang="less">~/<span class="hljs-selector-class">.pnpm-store</span>/                    â† å…¨å±€å­˜å‚¨ï¼ˆç¡¬é“¾æ¥æºï¼‰
â””â”€â”€ <span class="hljs-selector-tag">v3</span>/
    â””â”€â”€ <span class="hljs-selector-tag">files</span>/
        â”œâ”€â”€ <span class="hljs-number">00</span>/
        â”‚   â””â”€â”€ <span class="hljs-selector-tag">abc123</span>...         â† æŒ‰å†…å®¹å“ˆå¸Œå­˜å‚¨
        â”œâ”€â”€ <span class="hljs-number">01</span>/
        â””â”€â”€ ...

<span class="hljs-selector-tag">node_modules</span>/
â”œâ”€â”€ <span class="hljs-selector-class">.pnpm</span>/                        â† çœŸå®ä¾èµ–ï¼ˆç¡¬é“¾æ¥ï¼‰
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">A</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/
â”‚   â”‚   â””â”€â”€ <span class="hljs-selector-tag">node_modules</span>/
â”‚   â”‚       â”œâ”€â”€ <span class="hljs-selector-tag">A</span> â†’ &lt;<span class="hljs-selector-tag">store</span>&gt;/<span class="hljs-selector-tag">A</span>     â† ç¡¬é“¾æ¥åˆ° <span class="hljs-selector-tag">store</span>
â”‚   â”‚       â””â”€â”€ <span class="hljs-selector-tag">B</span> â†’ ../../<span class="hljs-selector-tag">B</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/<span class="hljs-selector-tag">node_modules</span>/<span class="hljs-selector-tag">B</span>  â† ç¬¦å·é“¾æ¥
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">B</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/
â”‚   â”‚   â””â”€â”€ <span class="hljs-selector-tag">node_modules</span>/
â”‚   â”‚       â””â”€â”€ <span class="hljs-selector-tag">B</span> â†’ &lt;<span class="hljs-selector-tag">store</span>&gt;/<span class="hljs-selector-tag">B</span>
â”‚   â””â”€â”€ <span class="hljs-selector-tag">B</span>@<span class="hljs-number">2.0</span><span class="hljs-selector-class">.0</span>/
â”‚       â””â”€â”€ <span class="hljs-selector-tag">node_modules</span>/
â”‚           â””â”€â”€ <span class="hljs-selector-tag">B</span> â†’ &lt;<span class="hljs-selector-tag">store</span>&gt;/<span class="hljs-selector-tag">B</span>
â”œâ”€â”€ <span class="hljs-selector-tag">A</span> â†’ <span class="hljs-selector-class">.pnpm</span>/<span class="hljs-selector-tag">A</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/<span class="hljs-selector-tag">node_modules</span>/<span class="hljs-selector-tag">A</span>    â† ç¬¦å·é“¾æ¥
â”œâ”€â”€ <span class="hljs-selector-tag">D</span> â†’ <span class="hljs-selector-class">.pnpm</span>/<span class="hljs-selector-tag">D</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/<span class="hljs-selector-tag">node_modules</span>/<span class="hljs-selector-tag">D</span>
â””â”€â”€ <span class="hljs-selector-tag">E</span> â†’ <span class="hljs-selector-class">.pnpm</span>/<span class="hljs-selector-tag">E</span>@<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>/<span class="hljs-selector-tag">node_modules</span>/<span class="hljs-selector-tag">E</span>
</code></pre>
<p><strong>æ ¸å¿ƒåŸç†</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    pnpm çš„ä¸‰å±‚ç»“æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   é¡¹ç›® node_modules/          åªæœ‰ç›´æ¥ä¾èµ–çš„ç¬¦å·é“¾æ¥             â”‚
â”‚            â”‚                                                     â”‚
â”‚            â–¼                                                     â”‚
â”‚   .<span class="hljs-property">pnpm</span>/ è™šæ‹Ÿå­˜å‚¨             æ‰€æœ‰ä¾èµ–çš„æ‰å¹³ç»“æ„ï¼ˆç¬¦å·é“¾æ¥ï¼‰     â”‚
â”‚            â”‚                                                     â”‚
â”‚            â–¼                                                     â”‚
â”‚   ~<span class="hljs-regexp">/.pnpm-store/</span>              å…¨å±€å­˜å‚¨ï¼ˆç¡¬é“¾æ¥ï¼ŒçœŸå®æ–‡ä»¶ï¼‰       â”‚
â”‚                                                                  â”‚
â”‚   ğŸ’¡ åŒä¸€ä¸ªåŒ…ç‰ˆæœ¬ï¼Œå…¨å±€åªå­˜ä¸€ä»½                                  â”‚
â”‚   ğŸ’¡ ä¸åŒé¡¹ç›®é€šè¿‡ç¡¬é“¾æ¥å…±äº«                                      â”‚
â”‚   ğŸ’¡ é¡¹ç›®åªèƒ½è®¿é—®å£°æ˜çš„ä¾èµ–ï¼ˆè§£å†³å¹½çµä¾èµ–ï¼‰                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-6">ä¸‰ã€å¹½çµä¾èµ–é—®é¢˜è¯¦è§£</h3>
<h4 data-id="heading-7">3.1 ä»€ä¹ˆæ˜¯å¹½çµä¾èµ–ï¼Ÿ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// package.json åªå£°æ˜äº† express</span>
{
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"express"</span>: <span class="hljs-string">"^4.18.0"</span>
  }
}

<span class="hljs-comment">// ä½†ä½ å¯ä»¥è¿™æ ·å†™ï¼ˆnpm/yarn æ‰å¹³åŒ–åï¼‰</span>
<span class="hljs-keyword">const</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">'debug'</span>);  <span class="hljs-comment">// ğŸ˜± æœªå£°æ˜ï¼Œä½†èƒ½ç”¨ï¼</span>
<span class="hljs-keyword">const</span> qs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'qs'</span>);        <span class="hljs-comment">// ğŸ˜± express çš„ä¾èµ–</span>

<span class="hljs-comment">// é—®é¢˜ï¼š</span>
<span class="hljs-comment">// 1. express å‡çº§åå¯èƒ½ä¸å†ä¾èµ– debug â†’ ä½ çš„ä»£ç æŒ‚äº†</span>
<span class="hljs-comment">// 2. æ¢å°æœºå™¨å®‰è£…é¡ºåºä¸åŒ â†’ å¯èƒ½æ‰¾ä¸åˆ°</span>
<span class="hljs-comment">// 3. ä»£ç å®¡æŸ¥çœ‹ä¸å‡ºçœŸå®ä¾èµ–</span>
</code></pre>
<h4 data-id="heading-8">3.2 pnpm å¦‚ä½•è§£å†³ï¼Ÿ</h4>
<pre><code class="hljs language-bash" lang="bash">node_modules/
â”œâ”€â”€ express â†’ .pnpm/express@4.18.0/...  â† åªæœ‰ express
â””â”€â”€ .pnpm/
    â””â”€â”€ express@4.18.0/
        â””â”€â”€ node_modules/
            â”œâ”€â”€ express/
            â”œâ”€â”€ debug/      â† debug åœ¨è¿™é‡Œï¼Œå¤–é¢è®¿é—®ä¸åˆ°
            â””â”€â”€ qs/
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// pnpm é¡¹ç›®ä¸­</span>
<span class="hljs-keyword">const</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">'debug'</span>);  
<span class="hljs-comment">// âŒ Error: Cannot find module 'debug'</span>

<span class="hljs-comment">// å¿…é¡»æ˜¾å¼å£°æ˜</span>
<span class="hljs-comment">// package.json: "debug": "^4.0.0"</span>
<span class="hljs-comment">// ç„¶åæ‰èƒ½ç”¨</span>
</code></pre>
<h3 data-id="heading-9">å››ã€ä¾èµ–è§£æç®—æ³•</h3>
<h4 data-id="heading-10">4.1 npm/yarn çš„ä¾èµ–æå‡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¾èµ–å…³ç³»</span>
A@<span class="hljs-number">1.0</span> â†’ B@<span class="hljs-number">1.0</span>
C@<span class="hljs-number">1.0</span> â†’ B@<span class="hljs-number">2.0</span>

<span class="hljs-comment">// npm/yarn è§£æç»“æœï¼ˆå–å†³äºå®‰è£…é¡ºåºï¼‰</span>
<span class="hljs-comment">// æƒ…å†µ1ï¼šå…ˆå®‰è£… A</span>
node_modules/
â”œâ”€â”€ A@<span class="hljs-number">1.0</span>/
â”œâ”€â”€ B@<span class="hljs-number">1.0</span>/          â† B@<span class="hljs-number">1.0</span> è¢«æå‡
â””â”€â”€ C@<span class="hljs-number">1.0</span>/
    â””â”€â”€ node_modules/
        â””â”€â”€ B@<span class="hljs-number">2.0</span>/  â† B@<span class="hljs-number">2.0</span> åµŒå¥—

<span class="hljs-comment">// æƒ…å†µ2ï¼šå…ˆå®‰è£… C</span>
node_modules/
â”œâ”€â”€ A@<span class="hljs-number">1.0</span>/
â”‚   â””â”€â”€ node_modules/
â”‚       â””â”€â”€ B@<span class="hljs-number">1.0</span>/  â† B@<span class="hljs-number">1.0</span> åµŒå¥—
â”œâ”€â”€ B@<span class="hljs-number">2.0</span>/          â† B@<span class="hljs-number">2.0</span> è¢«æå‡
â””â”€â”€ C@<span class="hljs-number">1.0</span>/
</code></pre>
<p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ lockfileï¼</strong></p>
<h4 data-id="heading-11">4.2 pnpm çš„ç¡®å®šæ€§è§£æ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// pnpm ä¸åšæå‡ï¼Œç»“æ„æ°¸è¿œç¡®å®š</span>
node_modules/
â”œâ”€â”€ A â†’ .<span class="hljs-property">pnpm</span>/A@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/A
â”œâ”€â”€ C â†’ .<span class="hljs-property">pnpm</span>/C@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/C
â””â”€â”€ .<span class="hljs-property">pnpm</span>/
    â”œâ”€â”€ A@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/
    â”‚   â”œâ”€â”€ A/
    â”‚   â””â”€â”€ B â†’ ../../B@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/B
    â”œâ”€â”€ B@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/B/
    â”œâ”€â”€ B@<span class="hljs-number">2.0</span><span class="hljs-number">.0</span>/node_modules/B/
    â””â”€â”€ C@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>/node_modules/
        â”œâ”€â”€ C/
        â””â”€â”€ B â†’ ../../B@<span class="hljs-number">2.0</span><span class="hljs-number">.0</span>/node_modules/B

<span class="hljs-comment">// ğŸ’¡ æ¯ä¸ªåŒ…éƒ½èƒ½æ‰¾åˆ°æ­£ç¡®ç‰ˆæœ¬çš„ä¾èµ–</span>
<span class="hljs-comment">// ğŸ’¡ ä¸å—å®‰è£…é¡ºåºå½±å“</span>
</code></pre>
<h3 data-id="heading-12">äº”ã€Lockfile æœºåˆ¶å¯¹æ¯”</h3>
<h4 data-id="heading-13">5.1 ä¸‰ç§ lockfile æ ¼å¼</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ==================== package-lock.json (npm) ====================</span>
{
  <span class="hljs-attr">"name":</span> <span class="hljs-string">"my-app"</span>,
  <span class="hljs-attr">"lockfileVersion":</span> <span class="hljs-number">3</span>,
  <span class="hljs-attr">"packages":</span> {
    <span class="hljs-attr">"node_modules/lodash":</span> {
      <span class="hljs-attr">"version":</span> <span class="hljs-string">"4.17.21"</span>,
      <span class="hljs-attr">"resolved":</span> <span class="hljs-string">"https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz"</span>,
      <span class="hljs-attr">"integrity":</span> <span class="hljs-string">"sha512-v2kDE..."</span>
    }
  }
}

<span class="hljs-comment"># ==================== yarn.lock (yarn) ====================</span>
<span class="hljs-string">lodash@^4.17.0:</span>
  <span class="hljs-string">version</span> <span class="hljs-string">"4.17.21"</span>
  <span class="hljs-string">resolved</span> <span class="hljs-string">"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz"</span>
  <span class="hljs-string">integrity</span> <span class="hljs-string">sha512-v2kDE...</span>

<span class="hljs-comment"># ==================== pnpm-lock.yaml (pnpm) ====================</span>
<span class="hljs-attr">lockfileVersion:</span> <span class="hljs-string">'9.0'</span>
<span class="hljs-attr">packages:</span>
  <span class="hljs-string">lodash@4.17.21:</span>
    <span class="hljs-attr">resolution:</span> {<span class="hljs-attr">integrity:</span> <span class="hljs-string">sha512-v2kDE...</span>}
    <span class="hljs-attr">engines:</span> {<span class="hljs-attr">node:</span> <span class="hljs-string">'&gt;=0.10.0'</span>}
</code></pre>
<h4 data-id="heading-14">5.2 Lockfile ä½œç”¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Lockfile è§£å†³çš„é—®é¢˜                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   <span class="hljs-keyword">package</span>.json: <span class="hljs-string">"lodash"</span>: <span class="hljs-string">"^4.17.0"</span>                             â”‚
â”‚                                                                  â”‚
â”‚   æ²¡æœ‰ lockfileï¼š                                                â”‚
â”‚   â€¢ ä»Šå¤©å®‰è£…ï¼š<span class="hljs-symbol">lodash@</span><span class="hljs-number">4.17</span><span class="hljs-number">.20</span>                                    â”‚
â”‚   â€¢ æ˜å¤©å®‰è£…ï¼š<span class="hljs-symbol">lodash@</span><span class="hljs-number">4.17</span><span class="hljs-number">.21</span>ï¼ˆæ–°ç‰ˆæœ¬å‘å¸ƒäº†ï¼‰                    â”‚
â”‚   â€¢ ğŸ˜± ä¸åŒæ—¶é—´/æœºå™¨å®‰è£…ç»“æœä¸åŒ                                â”‚
â”‚                                                                  â”‚
â”‚   æœ‰ lockfileï¼š                                                  â”‚
â”‚   â€¢ é”å®š <span class="hljs-symbol">lodash@</span><span class="hljs-number">4.17</span><span class="hljs-number">.20</span>                                         â”‚
â”‚   â€¢ ä»»ä½•æ—¶é—´/æœºå™¨å®‰è£…ç»“æœç›¸åŒ                                   â”‚
â”‚   â€¢ âœ… å¯å¤ç°çš„æ„å»º                                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-15">5.3 Lockfile å¯¹æ¯”</h4>









































<table><thead><tr><th>ç‰¹æ€§</th><th>package-lock.json</th><th>yarn.lock</th><th>pnpm-lock.yaml</th></tr></thead><tbody><tr><td>æ ¼å¼</td><td>JSON</td><td>è‡ªå®šä¹‰</td><td>YAML</td></tr><tr><td>å¯è¯»æ€§</td><td>å·®ï¼ˆåµŒå¥—æ·±ï¼‰</td><td>å¥½</td><td>å¥½</td></tr><tr><td>åˆå¹¶å†²çª</td><td>éš¾è§£å†³</td><td>è¾ƒæ˜“</td><td>è¾ƒæ˜“</td></tr><tr><td>åŒ…å«ä¿¡æ¯</td><td>å®Œæ•´æ ‘ç»“æ„</td><td>æ‰å¹³åˆ—è¡¨</td><td>æ‰å¹³ + ä¾èµ–å…³ç³»</td></tr><tr><td>æ–‡ä»¶å¤§å°</td><td>å¤§</td><td>ä¸­</td><td>å°</td></tr></tbody></table>
<h3 data-id="heading-16">å…­ã€æ€§èƒ½å¯¹æ¯”å®æµ‹</h3>
<h4 data-id="heading-17">6.1 å®‰è£…é€Ÿåº¦</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                    <span class="hljs-string">å®‰è£…é€Ÿåº¦å¯¹æ¯”ï¼ˆä¸­å‹é¡¹ç›®ï¼Œçº¦</span> <span class="hljs-number">500</span> <span class="hljs-string">ä¾èµ–ï¼‰</span>          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">é¦–æ¬¡å®‰è£…ï¼ˆæ— ç¼“å­˜ï¼‰</span>                                             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">npm:</span>     <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-string">65s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">yarn:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>        <span class="hljs-string">52s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">pnpm:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>              <span class="hljs-string">40s</span>  <span class="hljs-string">â†</span> <span class="hljs-string">ğŸ”¥</span> <span class="hljs-string">æœ€å¿«</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">é‡å¤å®‰è£…ï¼ˆæœ‰ç¼“å­˜ï¼‰</span>                                             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">npm:</span>     <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>              <span class="hljs-string">38s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">yarn:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>                    <span class="hljs-string">28s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">pnpm:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>                          <span class="hljs-string">15s</span>  <span class="hljs-string">â†</span> <span class="hljs-string">ğŸ”¥</span> <span class="hljs-string">å¿«</span> <span class="hljs-number">2.</span><span class="hljs-string">5x</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">CI</span> <span class="hljs-string">ç¯å¢ƒï¼ˆæœ‰</span> <span class="hljs-string">lockfileï¼Œæ— </span> <span class="hljs-string">node_modulesï¼‰</span>                        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">npm ci:</span>  <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>          <span class="hljs-string">48s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">yarn:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>                <span class="hljs-string">35s</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">pnpm:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>                      <span class="hljs-string">22s</span>  <span class="hljs-string">â†</span> <span class="hljs-string">ğŸ”¥</span> <span class="hljs-string">å¿«</span> <span class="hljs-string">2x</span>    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-18">6.2 ç£ç›˜å ç”¨</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                    <span class="hljs-string">ç£ç›˜å ç”¨å¯¹æ¯”</span>                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">å•é¡¹ç›®</span> <span class="hljs-string">node_modules</span>                                            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">npm:</span>     <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-string">850MB</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">yarn:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-string">850MB</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">pnpm:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-string">850MBï¼ˆé¦–æ¬¡ï¼‰</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-number">10</span> <span class="hljs-string">ä¸ªç›¸ä¼¼é¡¹ç›®ï¼ˆå…±äº«ä¾èµ–</span> <span class="hljs-number">80</span><span class="hljs-string">%ï¼‰</span>                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">npm:</span>     <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-number">8.</span><span class="hljs-string">5GB</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">yarn:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>  <span class="hljs-number">8.</span><span class="hljs-string">5GB</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">pnpm:</span>    <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>                      <span class="hljs-number">2.</span><span class="hljs-string">1GB</span>  <span class="hljs-string">â†</span> <span class="hljs-string">ğŸ”¥</span> <span class="hljs-string">çœ</span> <span class="hljs-number">75</span><span class="hljs-string">%</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">ğŸ’¡</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">é€šè¿‡ç¡¬é“¾æ¥å…±äº«ï¼Œç›¸åŒæ–‡ä»¶åªå­˜ä¸€ä»½</span>                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-19">6.3 æ€§èƒ½å¯¹æ¯”è¡¨</h4>















































<table><thead><tr><th>æŒ‡æ ‡</th><th>npm</th><th>yarn</th><th>pnpm</th></tr></thead><tbody><tr><td>é¦–æ¬¡å®‰è£…</td><td>æ…¢</td><td>ä¸­</td><td>å¿«</td></tr><tr><td>é‡å¤å®‰è£…</td><td>ä¸­</td><td>å¿«</td><td>æœ€å¿«</td></tr><tr><td>ç£ç›˜å ç”¨</td><td>é«˜</td><td>é«˜</td><td>ä½ï¼ˆå…±äº«ï¼‰</td></tr><tr><td>å†…å­˜å ç”¨</td><td>ä¸­</td><td>é«˜</td><td>ä½</td></tr><tr><td>å¹¶è¡Œä¸‹è½½</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>ç¦»çº¿æ¨¡å¼</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h3 data-id="heading-20">ä¸ƒã€Monorepo æ”¯æŒå¯¹æ¯”</h3>
<h4 data-id="heading-21">7.1 Workspace é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ==================== npm (v7+) ====================</span>
<span class="hljs-comment"># package.json</span>
{
  <span class="hljs-attr">"workspaces":</span> [<span class="hljs-string">"packages/*"</span>]
}

<span class="hljs-comment"># ==================== yarn ====================</span>
<span class="hljs-comment"># package.json</span>
{
  <span class="hljs-attr">"workspaces":</span> [<span class="hljs-string">"packages/*"</span>]
}

<span class="hljs-comment"># ==================== pnpm ====================</span>
<span class="hljs-comment"># pnpm-workspace.yaml</span>
<span class="hljs-attr">packages:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">'packages/*'</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">'apps/*'</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">'!**/test/**'</span>  <span class="hljs-comment"># æ’é™¤</span>
</code></pre>
<h4 data-id="heading-22">7.2 Monorepo å‘½ä»¤å¯¹æ¯”</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨æ‰€æœ‰åŒ…ä¸­æ‰§è¡Œå‘½ä»¤</span>
npm <span class="hljs-built_in">exec</span> --workspaces -- npm run build
yarn workspaces run build
pnpm -r run build                    <span class="hljs-comment"># ğŸ”¥ æœ€ç®€æ´</span>

<span class="hljs-comment"># åœ¨æŒ‡å®šåŒ…ä¸­æ‰§è¡Œ</span>
npm <span class="hljs-built_in">exec</span> --workspace=@my/pkg -- npm run build
yarn workspace @my/pkg run build
pnpm --filter @my/pkg run build      <span class="hljs-comment"># ğŸ”¥ filter æ›´å¼ºå¤§</span>

<span class="hljs-comment"># æ·»åŠ ä¾èµ–åˆ°æŒ‡å®šåŒ…</span>
npm install lodash --workspace=@my/pkg
yarn workspace @my/pkg add lodash
pnpm add lodash --filter @my/pkg

<span class="hljs-comment"># pnpm filter é«˜çº§ç”¨æ³•</span>
pnpm --filter <span class="hljs-string">"@my/*"</span> run build           <span class="hljs-comment"># åŒ¹é…æ¨¡å¼</span>
pnpm --filter <span class="hljs-string">"...@my/app"</span> run build      <span class="hljs-comment"># åŒ…å«ä¾èµ–</span>
pnpm --filter <span class="hljs-string">"@my/app..."</span> run build      <span class="hljs-comment"># åŒ…å«è¢«ä¾èµ–</span>
pnpm --filter <span class="hljs-string">"...[origin/main]"</span> run build <span class="hljs-comment"># Git å˜æ›´çš„åŒ…</span>
</code></pre>
<h4 data-id="heading-23">7.3 Monorepo å¯¹æ¯”è¡¨</h4>















































<table><thead><tr><th>ç‰¹æ€§</th><th>npm</th><th>yarn</th><th>pnpm</th></tr></thead><tbody><tr><td>Workspace æ”¯æŒ</td><td>v7+</td><td>v1+</td><td>âœ…</td></tr><tr><td>ä¾èµ–æå‡</td><td>é»˜è®¤æå‡</td><td>é»˜è®¤æå‡</td><td>ä¸æå‡ï¼ˆä¸¥æ ¼ï¼‰</td></tr><tr><td>Filter è¯­æ³•</td><td>åŸºç¡€</td><td>åŸºç¡€</td><td>å¼ºå¤§</td></tr><tr><td>å¹¶è¡Œæ‰§è¡Œ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>æ‹“æ‰‘æ’åº</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å˜æ›´æ£€æµ‹</td><td>âŒ</td><td>âŒ</td><td>âœ… (--filter)</td></tr></tbody></table>
<h3 data-id="heading-24">å…«ã€ç‰¹æ®Šåœºæ™¯å¤„ç†</h3>
<h4 data-id="heading-25">8.1 Peer Dependencies</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒ… A å£°æ˜</span>
{
  <span class="hljs-string">"peerDependencies"</span>: {
    <span class="hljs-string">"react"</span>: <span class="hljs-string">"^17.0.0 || ^18.0.0"</span>
  }
}

<span class="hljs-comment">// npm 7+ï¼šè‡ªåŠ¨å®‰è£… peer depsï¼ˆå¯èƒ½å¯¼è‡´å†²çªï¼‰</span>
<span class="hljs-comment">// yarnï¼šè­¦å‘Šä½†ä¸è‡ªåŠ¨å®‰è£…</span>
<span class="hljs-comment">// pnpmï¼šä¸¥æ ¼æ¨¡å¼ï¼Œå¿…é¡»æ˜¾å¼å®‰è£…</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># pnpm å¤„ç† peer deps è­¦å‘Š</span>
pnpm install --strict-peer-dependencies=<span class="hljs-literal">false</span>

<span class="hljs-comment"># æˆ–åœ¨ .npmrc é…ç½®</span>
strict-peer-dependencies=<span class="hljs-literal">false</span>
auto-install-peers=<span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-26">8.2 å¯é€‰ä¾èµ–å¤±è´¥</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-string">"optionalDependencies"</span>: {
    <span class="hljs-string">"fsevents"</span>: <span class="hljs-string">"^2.3.0"</span>  <span class="hljs-comment">// macOS only</span>
  }
}

<span class="hljs-comment">// npm/yarnï¼šå¤±è´¥æ—¶é™é»˜è·³è¿‡</span>
<span class="hljs-comment">// pnpmï¼šåŒæ ·é™é»˜è·³è¿‡ï¼Œä½†æ—¥å¿—æ›´æ¸…æ™°</span>
</code></pre>
<h4 data-id="heading-27">8.3 ç§æœ‰ä»“åº“é…ç½®</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># .npmrcï¼ˆä¸‰è€…é€šç”¨ï¼‰</span>

<span class="hljs-comment"># æŒ‡å®š registry</span>
<span class="hljs-attr">registry</span>=https://registry.npmmirror.com

<span class="hljs-comment"># ç§æœ‰åŒ…ä½¿ç”¨ç§æœ‰ä»“åº“</span>
@mycompany:<span class="hljs-attr">registry</span>=https://npm.mycompany.com

<span class="hljs-comment"># è®¤è¯</span>
//npm.mycompany.com/:<span class="hljs-attr">_authToken</span>=<span class="hljs-variable">${NPM_TOKEN}</span>
</code></pre>
<h3 data-id="heading-28">ä¹ã€å®‰å…¨æ€§å¯¹æ¯”</h3>
<h4 data-id="heading-29">9.1 å®‰å…¨å®¡è®¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm</span>
npm audit
npm audit fix
npm audit fix --force  <span class="hljs-comment"># å¼ºåˆ¶å‡çº§ï¼ˆå¯èƒ½ç ´åæ€§ï¼‰</span>

<span class="hljs-comment"># yarn</span>
yarn audit
yarn audit --json

<span class="hljs-comment"># pnpm</span>
pnpm audit
pnpm audit --fix
</code></pre>
<h4 data-id="heading-30">9.2 å®‰å…¨ç‰¹æ€§å¯¹æ¯”</h4>









































<table><thead><tr><th>ç‰¹æ€§</th><th>npm</th><th>yarn</th><th>pnpm</th></tr></thead><tbody><tr><td>å®‰å…¨å®¡è®¡</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>è‡ªåŠ¨ä¿®å¤</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å¹½çµä¾èµ–é˜²æŠ¤</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å®Œæ•´æ€§æ ¡éªŒ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>ç­¾åéªŒè¯</td><td>âœ… (v8.6+)</td><td>âŒ</td><td>âŒ</td></tr></tbody></table>
<h4 data-id="heading-31">9.3 pnpm çš„å®‰å…¨ä¼˜åŠ¿</h4>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    pnpm å®‰å…¨ä¼˜åŠ¿                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   1. é˜²æ­¢å¹½çµä¾èµ–æ”»å‡»                                            â”‚
â”‚      â€¢ æ¶æ„åŒ…æ— æ³•è¢«æ„å¤–å¼•å…¥                                     â”‚
â”‚      â€¢ åªèƒ½è®¿é—®æ˜¾å¼å£°æ˜çš„ä¾èµ–                                   â”‚
â”‚                                                                  â”‚
â”‚   2. å†…å®¹å¯»å€å­˜å‚¨                                                â”‚
â”‚      â€¢ æ–‡ä»¶æŒ‰å“ˆå¸Œå­˜å‚¨                                           â”‚
â”‚      â€¢ ç¯¡æ”¹ä¼šå¯¼è‡´å“ˆå¸Œä¸åŒ¹é…                                     â”‚
â”‚                                                                  â”‚
â”‚   3. ä¸¥æ ¼çš„ä¾èµ–è§£æ                                              â”‚
â”‚      â€¢ ä¸ä¼šæ„å¤–ä½¿ç”¨é”™è¯¯ç‰ˆæœ¬                                     â”‚
â”‚      â€¢ ä¾èµ–å…³ç³»æ›´æ¸…æ™°                                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-32">åã€è¿ç§»æŒ‡å—</h3>
<h4 data-id="heading-33">10.1 ä» npm è¿ç§»åˆ° pnpm</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å®‰è£… pnpm</span>
npm install -g pnpm

<span class="hljs-comment"># 2. åˆ é™¤ node_modules å’Œ lockfile</span>
<span class="hljs-built_in">rm</span> -rf node_modules package-lock.json

<span class="hljs-comment"># 3. å¯¼å…¥ï¼ˆè‡ªåŠ¨ç”Ÿæˆ pnpm-lock.yamlï¼‰</span>
pnpm import  <span class="hljs-comment"># å¯ä»¥ä» package-lock.json å¯¼å…¥</span>

<span class="hljs-comment"># 4. å®‰è£…</span>
pnpm install

<span class="hljs-comment"># 5. æ›´æ–° CI è„šæœ¬</span>
<span class="hljs-comment"># npm ci â†’ pnpm install --frozen-lockfile</span>
<span class="hljs-comment"># npm install â†’ pnpm install</span>
<span class="hljs-comment"># npm run â†’ pnpm run</span>
</code></pre>
<h4 data-id="heading-34">10.2 ä» yarn è¿ç§»åˆ° pnpm</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åˆ é™¤ yarn ç›¸å…³æ–‡ä»¶</span>
<span class="hljs-built_in">rm</span> -rf node_modules yarn.lock .yarnrc.yml

<span class="hljs-comment"># 2. å¯¼å…¥</span>
pnpm import  <span class="hljs-comment"># å¯ä»¥ä» yarn.lock å¯¼å…¥</span>

<span class="hljs-comment"># 3. å®‰è£…</span>
pnpm install

<span class="hljs-comment"># 4. å¤„ç†å¯èƒ½çš„å¹½çµä¾èµ–é—®é¢˜</span>
<span class="hljs-comment"># pnpm ä¼šæŠ¥é”™ï¼ŒæŒ‰æç¤ºæ·»åŠ ç¼ºå¤±çš„ä¾èµ–</span>
pnpm add &lt;missing-package&gt;
</code></pre>
<h4 data-id="heading-35">10.3 å¸¸è§è¿ç§»é—®é¢˜</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é—®é¢˜1ï¼šå¹½çµä¾èµ–æŠ¥é”™</span>
<span class="hljs-comment"># Error: Cannot find module 'xxx'</span>
<span class="hljs-comment"># è§£å†³ï¼šæ˜¾å¼æ·»åŠ ä¾èµ–</span>
pnpm add xxx

<span class="hljs-comment"># é—®é¢˜2ï¼špeer deps è­¦å‘Š</span>
<span class="hljs-comment"># è§£å†³ï¼šé…ç½® .npmrc</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"auto-install-peers=true"</span> &gt;&gt; .npmrc

<span class="hljs-comment"># é—®é¢˜3ï¼šæŸäº›åŒ…ä¸å…¼å®¹ç¬¦å·é“¾æ¥</span>
<span class="hljs-comment"># è§£å†³ï¼šé…ç½® shamefully-hoist</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"shamefully-hoist=true"</span> &gt;&gt; .npmrc  <span class="hljs-comment"># ä¸æ¨èï¼Œæœ€åæ‰‹æ®µ</span>

<span class="hljs-comment"># é—®é¢˜4ï¼špostinstall è„šæœ¬è·¯å¾„é—®é¢˜</span>
<span class="hljs-comment"># è§£å†³ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ– pnpm çš„ hooks</span>
</code></pre>
<h3 data-id="heading-36">åä¸€ã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-37">11.1 é¡¹ç›®é…ç½®å»ºè®®</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># .npmrcï¼ˆæ¨èé…ç½®ï¼‰</span>

<span class="hljs-comment"># ä½¿ç”¨å›½å†…é•œåƒ</span>
<span class="hljs-attr">registry</span>=https://registry.npmmirror.com

<span class="hljs-comment"># è‡ªåŠ¨å®‰è£… peer deps</span>
<span class="hljs-attr">auto-install-peers</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment"># ä¸¥æ ¼æ¨¡å¼ï¼ˆæ¨èï¼‰</span>
<span class="hljs-attr">strict-peer-dependencies</span>=<span class="hljs-literal">false</span>

<span class="hljs-comment"># æå‡ç‰¹å®šåŒ…ï¼ˆå…¼å®¹æ€§é—®é¢˜æ—¶ä½¿ç”¨ï¼‰</span>
public-hoist-pattern<span class="hljs-section">[]</span>=*eslint*
public-hoist-pattern<span class="hljs-section">[]</span>=*prettier*
</code></pre>
<h4 data-id="heading-38">11.2 CI/CD é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actions ç¤ºä¾‹</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">pnpm</span>
  <span class="hljs-attr">uses:</span> <span class="hljs-string">pnpm/action-setup@v2</span>
  <span class="hljs-attr">with:</span>
    <span class="hljs-attr">version:</span> <span class="hljs-number">8</span>

<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
  <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span>
  <span class="hljs-attr">with:</span>
    <span class="hljs-attr">node-version:</span> <span class="hljs-string">'20'</span>
    <span class="hljs-attr">cache:</span> <span class="hljs-string">'pnpm'</span>  <span class="hljs-comment"># ğŸ”¥ ç¼“å­˜ pnpm store</span>

<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">install</span> <span class="hljs-string">--frozen-lockfile</span>  <span class="hljs-comment"># ğŸ”¥ CI å¿…é¡»ç”¨ frozen</span>

<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>
</code></pre>
<h4 data-id="heading-39">11.3 å›¢é˜Ÿåä½œè§„èŒƒ</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// package.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"packageManager"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm@8.15.0"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// ğŸ”¥ é”å®šåŒ…ç®¡ç†å™¨ç‰ˆæœ¬</span>
  <span class="hljs-attr">"engines"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&gt;=18"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pnpm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&gt;=8"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"preinstall"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx only-allow pnpm"</span>  <span class="hljs-comment">// ğŸ”¥ å¼ºåˆ¶ä½¿ç”¨ pnpm</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-40">åäºŒã€é€‰å‹å»ºè®®</h3>
<h4 data-id="heading-41">12.1 å†³ç­–æ ‘</h4>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŒ…ç®¡ç†å™¨é€‰å‹å†³ç­–                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   ä½ çš„åœºæ™¯æ˜¯ï¼Ÿ                                                   â”‚
â”‚        â”‚                                                         â”‚
â”‚        â”œâ”€ æ–°é¡¹ç›® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º pnpmï¼ˆæ¨èï¼‰           â”‚
â”‚        â”‚                                                         â”‚
â”‚        â”œâ”€ è€é¡¹ç›®è¿ç§»æˆæœ¬é«˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ä¿æŒç°çŠ¶               â”‚
â”‚        â”‚                                                         â”‚
â”‚        â”œâ”€ Monorepo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º pnpmï¼ˆ<span class="hljs-attribute">filter</span> å¼ºå¤§ï¼‰    â”‚
â”‚        â”‚                                                         â”‚
â”‚        â”œâ”€ ç£ç›˜ç©ºé—´ç´§å¼  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º pnpmï¼ˆçœ <span class="hljs-number">50%</span>+ï¼‰        â”‚
â”‚        â”‚                                                         â”‚
â”‚        â”œâ”€ CI é€Ÿåº¦æ•æ„Ÿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º pnpmï¼ˆå¿« <span class="hljs-number">2</span>xï¼‰          â”‚
â”‚        â”‚                                                         â”‚
â”‚        â””â”€ å›¢é˜Ÿä¸æƒ³å­¦æ–°å·¥å…· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º npmï¼ˆé›¶å­¦ä¹ æˆæœ¬ï¼‰      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-42">12.2 åœºæ™¯æ¨è</h4>








































<table><thead><tr><th>åœºæ™¯</th><th>æ¨è</th><th>åŸå› </th></tr></thead><tbody><tr><td>æ–°é¡¹ç›®</td><td>pnpm</td><td>æ€§èƒ½å¥½ã€å®‰å…¨ã€ç°ä»£</td></tr><tr><td>Monorepo</td><td>pnpm</td><td>filter è¯­æ³•å¼ºå¤§</td></tr><tr><td>è€é¡¹ç›®ç»´æŠ¤</td><td>ä¿æŒç°çŠ¶</td><td>è¿ç§»æœ‰æˆæœ¬</td></tr><tr><td>å¼€æºé¡¹ç›®</td><td>npm/pnpm</td><td>npm å…¼å®¹æ€§æœ€å¥½</td></tr><tr><td>ä¼ä¸šé¡¹ç›®</td><td>pnpm</td><td>ç£ç›˜çœã€é€Ÿåº¦å¿«</td></tr><tr><td>å­¦ä¹ /æ•™ç¨‹</td><td>npm</td><td>æ–‡æ¡£æœ€å¤š</td></tr></tbody></table>
<h4 data-id="heading-43">12.3 æ€»ç»“å¯¹æ¯”</h4>





















































<table><thead><tr><th>ç»´åº¦</th><th>npm</th><th>yarn</th><th>pnpm</th></tr></thead><tbody><tr><td>å®‰è£…é€Ÿåº¦</td><td>â­â­</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>ç£ç›˜å ç”¨</td><td>â­â­</td><td>â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>å®‰å…¨æ€§</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>Monorepo</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>å…¼å®¹æ€§</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­</td></tr><tr><td>å­¦ä¹ æˆæœ¬</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­</td></tr><tr><td>ç¤¾åŒºç”Ÿæ€</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­</td></tr></tbody></table>
<h4 data-id="heading-44">æœ€ç»ˆå»ºè®®</h4>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2025 å¹´æ¨è                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   ğŸ¥‡ pnpmï¼šæ–°é¡¹ç›®é¦–é€‰                                           â”‚
â”‚      â€¢ æ€§èƒ½æœ€å¥½ï¼Œç£ç›˜æœ€çœ                                       â”‚
â”‚      â€¢ è§£å†³å¹½çµä¾èµ–ï¼Œæ›´å®‰å…¨                                     â”‚
â”‚      â€¢ Monorepo æ”¯æŒæœ€å¼º                                        â”‚
â”‚      â€¢ Vueã€Vite ç­‰ä¸»æµé¡¹ç›®éƒ½åœ¨ç”¨                               â”‚
â”‚                                                                  â”‚
â”‚   ğŸ¥ˆ npmï¼šå…¼å®¹æ€§ä¼˜å…ˆ                                            â”‚
â”‚      â€¢ Node.js è‡ªå¸¦ï¼Œé›¶é…ç½®                                     â”‚
â”‚      â€¢ æ–‡æ¡£æœ€å…¨ï¼Œé—®é¢˜æœ€å¥½æœ                                     â”‚
â”‚      â€¢ å¼€æºé¡¹ç›®è´¡çŒ®è€…å‹å¥½                                       â”‚
â”‚                                                                  â”‚
â”‚   ğŸ¥‰ yarnï¼šç‰¹å®šåœºæ™¯                                             â”‚
â”‚      â€¢ å·²æœ‰ yarn çš„è€é¡¹ç›®                                       â”‚
â”‚      â€¢ éœ€è¦ Plug<span class="hljs-string">'n'</span>Play çš„åœºæ™¯                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<blockquote>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï¼æœ‰é—®é¢˜è¯„è®ºåŒºè§ ğŸ‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€LangChainå­¦ä¹ ç¬”è®°ã€‘è¾“å‡ºè§£æå™¨]]></title>    <link>https://juejin.cn/post/7588844115318685748</link>    <guid>https://juejin.cn/post/7588844115318685748</guid>    <pubDate>2025-12-29T07:17:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588844115318685748" data-draft-id="7589063105731035151" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€LangChainå­¦ä¹ ç¬”è®°ã€‘è¾“å‡ºè§£æå™¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-29T07:17:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æ³¥ç§è·èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289442030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€LangChainå­¦ä¹ ç¬”è®°ã€‘è¾“å‡ºè§£æå™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289442030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æ³¥ç§è·èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T07:17:30.000Z" title="Mon Dec 29 2025 07:17:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    45
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">æ ¸å¿ƒå®šä¹‰</h2>
<p>è¾“å‡ºè§£æå™¨æ˜¯ LangChain æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œæ ¸å¿ƒä½œç”¨æœ‰ä¸‰ï¼š</p>
<ol>
<li>ä¸ºå¤§æ¨¡å‹æä¾›æ ‡å‡†åŒ–æ ¼å¼åŒ–æç¤ºè¯ï¼Œå¼•å¯¼æ¨¡å‹æŒ‰æŒ‡å®šæ ¼å¼è¾“å‡ºï¼›</li>
<li>æ ¡éªŒå¤§æ¨¡å‹è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸæ ¼å¼è¦æ±‚ï¼›</li>
<li>è§£æå¤§æ¨¡å‹è¾“å‡ºå†…å®¹ï¼Œè½¬æ¢ä¸ºå¯ç”¨æ ¼å¼ï¼ˆå­—ç¬¦ä¸²/ç»“æ„åŒ–å¯¹è±¡ç­‰ï¼‰ï¼›</li>
</ol>
<h2 data-id="heading-1">å¸¸ç”¨è¾“å‡ºè§£æå™¨åŠä½¿ç”¨</h2>
<h3 data-id="heading-2">StrOutputParserï¼ˆå­—ç¬¦ä¸²è§£æå™¨ï¼‰</h3>
<h4 data-id="heading-3">æ ¸å¿ƒä½œç”¨</h4>
<p>ç”¨äºæ¸…ç†å¤§æ¨¡å‹è¾“å‡ºå†…å®¹ï¼Œå»é™¤è¾“å‡ºå‰åçš„æ¢è¡Œç¬¦ï¼ˆ<code>\n</code>ï¼‰ï¼Œä»…ä¿ç•™çº¯æ–‡æœ¬æ ¸å¿ƒè¾“å‡ºï¼Œè¿”å›æ ‡å‡†å­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<h4 data-id="heading-4">å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> PromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

<span class="hljs-comment"># å¤§æ¨¡å‹åˆå§‹åŒ–</span>
llm = ChatOpenAI(
    model_name=<span class="hljs-string">"qwen-plus"</span>,
    base_url=<span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span>,
    api_key=<span class="hljs-string">"[ä½ çš„API Key]"</span>
)

<span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
prompt_template = PromptTemplate.from_template(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°å­¦åŠ©æ‰‹ï¼Œ{question}"</span>)

<span class="hljs-comment"># åˆå§‹åŒ–å­—ç¬¦ä¸²è§£æå™¨</span>
str_output_parser = StrOutputParser()

<span class="hljs-comment"># æ„å»ºé“¾å¼è°ƒç”¨</span>
chain = prompt_template | llm | str_output_parser

<span class="hljs-comment"># æ‰§è¡Œè°ƒç”¨</span>
response = chain.invoke(<span class="hljs-built_in">input</span>={<span class="hljs-string">"question"</span>: <span class="hljs-string">"è®¡ç®—10å’Œ20çš„å’Œ"</span>})

<span class="hljs-comment"># æ‰“å°è§£æåç»“æœ</span>
<span class="hljs-built_in">print</span>(response)
</code></pre>
<blockquote>
<p><strong>æç¤º</strong>ï¼š<code>StrOutputParser </code> ä¸å­˜åœ¨ <code>get_format_instructions</code> æ–¹æ³•ï¼Œæ— éœ€é…ç½®æ ¼å¼åŒ–æŒ‡ä»¤ã€‚</p>
</blockquote>
<h3 data-id="heading-5">PydanticOutputParserï¼ˆç»“æ„åŒ–å¯¹è±¡è§£æå™¨ï¼‰</h3>
<h4 data-id="heading-6">æ ¸å¿ƒä½œç”¨</h4>
<p>å°†å¤§æ¨¡å‹è¾“å‡ºè§£æä¸ºç¬¦åˆ Pydantic æ¨¡å‹å®šä¹‰çš„ç»“æ„åŒ–å¯¹è±¡ï¼Œä¾¿äºåç»­æ•°æ®æå–ä¸æ ¡éªŒï¼Œè¿”å›å€¼ä¸º Pydantic æ¨¡å‹å®ä¾‹å¯¹è±¡ã€‚</p>
<h4 data-id="heading-7">å…³é”®æ–¹æ³•</h4>
<p><code>get_format_instructions()</code>ï¼šè·å– Pydantic æ¨¡å‹å¯¹åº”çš„æ ¼å¼åŒ–æŒ‡ä»¤ï¼Œç”¨äºä¼ é€’ç»™æç¤ºæ¨¡æ¿ï¼Œå¼•å¯¼å¤§æ¨¡å‹æŒ‰æ ¼å¼è¾“å‡ºã€‚</p>
<h4 data-id="heading-8">å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> PromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> PydanticOutputParser
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-comment"># å¤§æ¨¡å‹åˆå§‹åŒ–</span>
llm = ChatOpenAI(
    model_name=<span class="hljs-string">"qwen-plus"</span>,
    base_url=<span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span>,
    api_key=<span class="hljs-string">"[ä½ çš„API Key]"</span>
)

<span class="hljs-comment"># å®šä¹‰Pydanticæ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SumArgs</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    num1: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ç¬¬ä¸€ä¸ªæ•°"</span>)
    num2: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ç¬¬äºŒä¸ªæ•°"</span>)
    <span class="hljs-built_in">sum</span>: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ä¸¤ä¸ªæ•°çš„å’Œ"</span>)

<span class="hljs-comment"># åˆå§‹åŒ–Pydanticè¾“å‡ºè§£æå™¨</span>
pydantic_output_parser = PydanticOutputParser(pydantic_object=SumArgs)

<span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
prompt_template = PromptTemplate.from_template(
    <span class="hljs-string">"""
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°å­¦åŠ©æ‰‹
    é—®é¢˜å†…å®¹ï¼š{question}
    è¾“å‡ºæ ¼å¼ï¼š{format_instructions}
    """</span>
)

<span class="hljs-comment"># é¢„å¡«å……æ ¼å¼åŒ–æŒ‡ä»¤</span>
prompt_template = prompt_template.partial(
    format_instructions=pydantic_output_parser.get_format_instructions()
)

<span class="hljs-comment"># æ„å»ºé“¾å¼è°ƒç”¨</span>
chain = prompt_template | llm | pydantic_output_parser

<span class="hljs-comment"># æ‰§è¡Œè°ƒç”¨</span>
response = chain.invoke(<span class="hljs-built_in">input</span>={<span class="hljs-string">"question"</span>: <span class="hljs-string">"è®¡ç®—10å’Œ20çš„å’Œ"</span>})

<span class="hljs-comment"># æ‰“å°è§£æåç»“æœï¼ˆPydanticå®ä¾‹å¯¹è±¡ï¼‰</span>
<span class="hljs-built_in">print</span>(response)
</code></pre>
<h3 data-id="heading-9">3. JsonOutputParserï¼ˆJSONæ ¼å¼è§£æå™¨ï¼‰</h3>
<h4 data-id="heading-10">æ ¸å¿ƒä½œç”¨</h4>
<p>å°†å¤§æ¨¡å‹è¾“å‡ºè§£æä¸ºæ ‡å‡† JSON æ ¼å¼ï¼Œä½¿ç”¨æ–¹å¼ä¸ <code>PydanticOutputParser</code> ç±»ä¼¼ï¼Œæ ¸å¿ƒåŒºåˆ«åœ¨äºè§£æåçš„è¾“å‡ºæ ¼å¼ä¸º JSON å­—ç¬¦ä¸²/å¯¹è±¡ã€‚</p>
<h4 data-id="heading-11">å…³é”®æ–¹æ³•</h4>
<p><code>get_format_instructions()</code>ï¼šè·å– JSON æ ¼å¼çš„æ ‡å‡†åŒ–æŒ‡ä»¤ï¼Œè¿”å›å­—ç¬¦ä¸²ç±»å‹ï¼Œç”¨äºå¼•å¯¼å¤§æ¨¡å‹è¾“å‡ºåˆè§„ JSON å†…å®¹ã€‚</p>
<h5 data-id="heading-12">å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> JsonOutputParser
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-comment"># å®šä¹‰Pydanticæ•°æ®æ¨¡å‹ï¼ˆçº¦æŸJSONå­—æ®µï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SumArgs</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    num1: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ç¬¬ä¸€ä¸ªæ•°"</span>)
    num2: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ç¬¬äºŒä¸ªæ•°"</span>)
    <span class="hljs-built_in">sum</span>: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"ä¸¤ä¸ªæ•°çš„å’Œ"</span>)

<span class="hljs-comment"># åˆå§‹åŒ–JSONè¾“å‡ºè§£æå™¨</span>
json_output_parser = JsonOutputParser(pydantic_object=SumArgs)

<span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
prompt_template = PromptTemplate.from_template(
    <span class="hljs-string">"""
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°å­¦åŠ©æ‰‹
    é—®é¢˜å†…å®¹ï¼š{question}
    è¾“å‡ºæ ¼å¼ï¼š{format_instructions}
    """</span>
)

<span class="hljs-comment"># é¢„å¡«å……æ ¼å¼åŒ–æŒ‡ä»¤</span>
prompt_template = prompt_template.partial(
    format_instructions=json_output_parser.get_format_instructions()
)

<span class="hljs-comment"># æ„å»ºé“¾å¼è°ƒç”¨</span>
chain = prompt_template | llm | json_output_parser

<span class="hljs-comment"># æ‰§è¡Œè°ƒç”¨</span>
response = chain.invoke(<span class="hljs-built_in">input</span>={<span class="hljs-string">"question"</span>: <span class="hljs-string">"è®¡ç®—10å’Œ20çš„å’Œ"</span>})

<span class="hljs-comment"># æ‰“å°è§£æåç»“æœ</span>
<span class="hljs-built_in">print</span>(response)
</code></pre>
<h2 data-id="heading-13">æ ¸å¿ƒå…³é”®è¦ç‚¹</h2>
<ol>
<li>
<p><strong>é€šç”¨æµç¨‹</strong>ï¼šæ‰€æœ‰è¾“å‡ºè§£æå™¨çš„æ ¸å¿ƒä½¿ç”¨æµç¨‹ä¸€è‡´ï¼šå®šä¹‰æç¤ºæ¨¡æ¿ â†’ åˆå§‹åŒ–è§£æå™¨ â†’ é¢„å¡«å……æ ¼å¼åŒ–æŒ‡ä»¤ â†’ æ„å»ºé“¾å¼è°ƒç”¨ â†’ æ‰§è¡Œå¹¶è§£æç»“æœï¼›</p>
</li>
<li>
<p><strong>æ ¼å¼åŒ–æŒ‡ä»¤</strong>ï¼š<code>get_format_instructions()</code> æ˜¯æ ¸å¿ƒæ–¹æ³•ï¼Œç”¨äºå¼•å¯¼å¤§æ¨¡å‹æŒ‰é¢„æœŸæ ¼å¼è¾“å‡ºï¼Œç¼ºå¤±ä¼šå¯¼è‡´è§£æå¤±è´¥ï¼›</p>
</li>
<li>
<p><strong>è¿”å›ç±»å‹å·®å¼‚</strong>ï¼š</p>
<ul>
<li><code>StrOutputParser</code>ï¼šè¿”å›çº¯å­—ç¬¦ä¸²ï¼›</li>
<li><code>PydanticOutputParser</code>ï¼šè¿”å› Pydantic å®ä¾‹å¯¹è±¡ï¼›</li>
<li><code>JsonOutputParser</code>ï¼šè¿”å›æ ‡å‡† JSON æ ¼å¼ï¼›</li>
</ul>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼šè‹¥å¤§æ¨¡å‹è¾“å‡ºä¸ç¬¦åˆè§£æå™¨è¦æ±‚ï¼Œä¼šç›´æ¥æŠ›å‡ºè§£æé”™è¯¯ï¼Œéœ€ä¼˜åŒ–æç¤ºæ¨¡æ¿æˆ–æ¨¡å‹å‚æ•°ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agent è®°å¿†ç³»ç»ŸæŠ€æœ¯æ·±åº¦ï¼šä»ä¸Šä¸‹æ–‡å·¥ç¨‹åˆ°é•¿æœŸè®°å¿†ç»„ä»¶é›†æˆï¼]]></title>    <link>https://juejin.cn/post/7589126217249833001</link>    <guid>https://juejin.cn/post/7589126217249833001</guid>    <pubDate>2025-12-29T09:21:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589126217249833001" data-draft-id="7589126217249456169" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agent è®°å¿†ç³»ç»ŸæŠ€æœ¯æ·±åº¦ï¼šä»ä¸Šä¸‹æ–‡å·¥ç¨‹åˆ°é•¿æœŸè®°å¿†ç»„ä»¶é›†æˆï¼"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-29T09:21:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agent è®°å¿†ç³»ç»ŸæŠ€æœ¯æ·±åº¦ï¼šä»ä¸Šä¸‹æ–‡å·¥ç¨‹åˆ°é•¿æœŸè®°å¿†ç»„ä»¶é›†æˆï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T09:21:07.000Z" title="Mon Dec 29 2025 09:21:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæŸ³éµé£ï¼ˆç¿¼ä¸¥ï¼‰</p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>éšç€ AI Agent åº”ç”¨çš„å¿«é€Ÿå‘å±•ï¼Œæ™ºèƒ½ä½“éœ€è¦å¤„ç†è¶Šæ¥è¶Šå¤æ‚çš„ä»»åŠ¡å’Œæ›´é•¿çš„å¯¹è¯å†å²ã€‚ç„¶è€Œï¼ŒLLM çš„ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€ä¸æ–­å¢é•¿çš„ token æˆæœ¬ï¼Œä»¥åŠå¦‚ä½•è®© AIâ€œè®°ä½â€ç”¨æˆ·åå¥½å’Œå†å²äº¤äº’ï¼Œéƒ½æˆä¸ºäº†æ„å»ºå®ç”¨ AI Agent ç³»ç»Ÿé¢ä¸´çš„æ ¸å¿ƒæŒ‘æˆ˜ã€‚è®°å¿†ç³»ç»Ÿï¼ˆMemory Systemï¼‰æ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„å…³é”®æŠ€æœ¯ã€‚</p>
<p>è®°å¿†ç³»ç»Ÿä½¿ AI Agent èƒ½å¤Ÿåƒäººç±»ä¸€æ ·ï¼Œåœ¨å•æ¬¡å¯¹è¯ä¸­ä¿æŒä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼ˆçŸ­æœŸè®°å¿†ï¼‰ï¼ŒåŒæ—¶èƒ½å¤Ÿè·¨ä¼šè¯è®°ä½ç”¨æˆ·åå¥½ã€å†å²äº¤äº’å’Œé¢†åŸŸçŸ¥è¯†ï¼ˆé•¿æœŸè®°å¿†ï¼‰ã€‚è¿™ä¸ä»…æå‡äº†ç”¨æˆ·ä½“éªŒçš„è¿ç»­æ€§å’Œä¸ªæ€§åŒ–ç¨‹åº¦ï¼Œä¹Ÿä¸ºæ„å»ºæ›´æ™ºèƒ½ã€æ›´å®ç”¨çš„ AI åº”ç”¨å¥ å®šäº†åŸºç¡€ã€‚</p>
<h2 data-id="heading-1">Memory åŸºç¡€æ¦‚å¿µ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9b9252177814144b867871c1e45a423~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=VyLjca2%2BXFFttr7KpUIXWbggdWY%3D" alt="image_1766567507046.png" loading="lazy"/></p>
<h3 data-id="heading-2">1.1 è®°å¿†çš„å®šä¹‰ä¸åˆ†ç±»</h3>
<p>å¯¹äº AI Agent è€Œè¨€ï¼Œè®°å¿†è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä½¿å®ƒä»¬èƒ½å¤Ÿè®°ä½ä¹‹å‰çš„äº’åŠ¨ã€ä»åé¦ˆä¸­å­¦ä¹ ï¼Œå¹¶é€‚åº”ç”¨æˆ·çš„åå¥½ã€‚</p>
<p>å¯¹â€œè®°å¿†â€çš„å®šä¹‰æœ‰ä¸¤ä¸ªå±‚é¢ï¼š</p>
<ul>
<li><strong>ä¼šè¯çº§è®°å¿†ï¼š</strong> ç”¨æˆ·å’Œæ™ºèƒ½ä½“ Agent åœ¨ä¸€ä¸ªä¼šè¯ä¸­çš„å¤šè½®äº¤äº’ï¼ˆuser-query &amp; responseï¼‰</li>
<li><strong>è·¨ä¼šè¯è®°å¿†ï¼š</strong> ä»ç”¨æˆ·å’Œæ™ºèƒ½ä½“ Agent çš„å¤šä¸ªä¼šè¯ä¸­æŠ½å–çš„é€šç”¨ä¿¡æ¯ï¼Œå¯ä»¥è·¨ä¼šè¯è¾…åŠ© Agent æ¨ç†</li>
</ul>
<h3 data-id="heading-3">1.2 å„ Agent æ¡†æ¶çš„å®šä¹‰å·®å¼‚</h3>
<p>å„ä¸ª Agent æ¡†æ¶å¯¹è®°å¿†çš„æ¦‚å¿µå‘½åå„æœ‰ä¸åŒï¼Œä½†å…±åŒçš„æ˜¯éƒ½éµå¾ªä¸Šä¸€èŠ‚ä¸­ä»‹ç»çš„ä¸¤ä¸ªä¸åŒå±‚é¢çš„åˆ’åˆ†ï¼šä¼šè¯çº§å’Œè·¨ä¼šè¯çº§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3844bf82fd444909f707b0419ef8ccb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=DMqCHXEloIQ%2B%2BsnVmq8nBCNcq1U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ¡†æ¶è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>Google ADKï¼š</strong> Session è¡¨ç¤ºå•æ¬¡æŒç»­äº¤äº’ï¼›Memory æ˜¯é•¿æœŸçŸ¥è¯†åº“ï¼Œå¯åŒ…å«æ¥è‡ªå¤šæ¬¡å¯¹è¯çš„ä¿¡æ¯</li>
<li><strong>LangChainï¼š</strong> Short-term memory ç”¨äºå•çº¿ç¨‹æˆ–å¯¹è¯ä¸­è®°ä½ä¹‹å‰çš„äº¤äº’ï¼›Long-term memory ä¸å±äºåŸºç¡€æ ¸å¿ƒç»„ä»¶ï¼Œè€Œæ˜¯é«˜é˜¶çš„â€œä¸ªäººçŸ¥è¯†åº“â€å¤–æŒ‚</li>
<li><strong>AgentScopeï¼š</strong> è™½ç„¶å®˜æ–¹æ–‡æ¡£å¼ºè°ƒéœ€æ±‚é©±åŠ¨ï¼Œä½† API å±‚é¢ä»ç„¶æ˜¯ä¸¤ä¸ªç»„ä»¶ï¼ˆmemory å’Œ long_term_memoryï¼‰ï¼ŒåŠŸèƒ½å±‚é¢æœ‰æ˜ç¡®åŒºåˆ†</li>
</ul>
<p>ä¹ æƒ¯ä¸Šï¼Œå¯ä»¥å°†ä¼šè¯çº§åˆ«çš„å†å²æ¶ˆæ¯ç§°ä¸º<strong>çŸ­æœŸè®°å¿†</strong>ï¼ŒæŠŠå¯ä»¥è·¨ä¼šè¯å…±äº«çš„ä¿¡æ¯ç§°ä¸º<strong>é•¿æœŸè®°å¿†</strong>ï¼Œä½†æœ¬è´¨ä¸Šä¸¤è€…å¹¶ä¸æ˜¯é€šè¿‡ç®€å•çš„æ—¶é—´ç»´åº¦è¿›è¡Œçš„åˆ’åˆ†ï¼Œä»å®è·µå±‚é¢ä¸Šä»¥æ˜¯å¦è·¨ Session ä¼šè¯æ¥è¿›è¡ŒåŒºåˆ†ã€‚é•¿æœŸè®°å¿†çš„ä¿¡æ¯ä»çŸ­æœŸè®°å¿†ä¸­æŠ½å–æç‚¼è€Œæ¥ï¼Œæ ¹æ®çŸ­æœŸè®°å¿†ä¸­çš„ä¿¡æ¯å®æ—¶åœ°æ›´æ–°è¿­ä»£ï¼Œè€Œå…¶ä¿¡æ¯åˆä¼šå‚ä¸åˆ°çŸ­æœŸè®°å¿†ä¸­è¾…åŠ©æ¨¡å‹è¿›è¡Œä¸ªæ€§åŒ–æ¨ç†ã€‚</p>
<h2 data-id="heading-4">Agent æ¡†æ¶é›†æˆè®°å¿†ç³»ç»Ÿçš„æ¶æ„</h2>
<p>å„ Agent æ¡†æ¶åœ¨é›†æˆè®°å¿†ç³»ç»Ÿæ—¶ï¼Œè™½ç„¶å®ç°ç»†èŠ‚ä¸åŒï¼Œä½†éƒ½éµå¾ªç›¸ä¼¼çš„æ¶æ„æ¨¡å¼ã€‚ç†è§£è¿™äº›é€šç”¨æ¨¡å¼æœ‰åŠ©äºæ›´å¥½åœ°è®¾è®¡å’Œå®ç°è®°å¿†ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-5">2.1 Agent æ¡†æ¶é›†æˆè®°å¿†çš„é€šç”¨æ¨¡å¼</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/447f848e7d644d85bb307fa067e2e2e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=QW5%2B2TuZBEVHmAvVTr6h7wKAgPs%3D" alt="image_1766569316557.png" loading="lazy"/></p>
<p>å„ Agent æ¡†æ¶é›†æˆè®°å¿†ç³»ç»Ÿé€šå¸¸éµå¾ªä»¥ä¸‹é€šç”¨æ¨¡å¼ï¼š</p>
<p><strong>1. Step1ï¼šæ¨ç†å‰åŠ è½½</strong>Â - æ ¹æ®å½“å‰ user-query ä»é•¿æœŸè®°å¿†ä¸­åŠ è½½ç›¸å…³ä¿¡æ¯</p>
<p><strong>2. Step2ï¼šä¸Šä¸‹æ–‡æ³¨å…¥</strong>Â - ä»é•¿æœŸè®°å¿†ä¸­æ£€ç´¢çš„ä¿¡æ¯åŠ å…¥å½“å‰çŸ­æœŸè®°å¿†ä¸­è¾…åŠ©æ¨¡å‹æ¨ç†</p>
<p><strong>3. Step3ï¼šè®°å¿†æ›´æ–°</strong>Â - çŸ­æœŸè®°å¿†åœ¨æ¨ç†å®ŒæˆååŠ å…¥åˆ°é•¿æœŸè®°å¿†ä¸­</p>
<p><strong>4. Step4ï¼šä¿¡æ¯å¤„ç†</strong>Â - é•¿æœŸè®°å¿†æ¨¡å—ä¸­ç»“åˆ LLM+å‘é‡åŒ–æ¨¡å‹è¿›è¡Œä¿¡æ¯æå–å’Œæ£€ç´¢</p>
<h3 data-id="heading-6">2.2 çŸ­æœŸè®°å¿†ï¼ˆSession ä¼šè¯ï¼‰</h3>
<p>çŸ­æœŸè®°å¿†å­˜å‚¨ä¼šè¯ä¸­äº§ç”Ÿçš„å„ç±»æ¶ˆæ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·è¾“å…¥ã€æ¨¡å‹å›å¤ã€å·¥å…·è°ƒç”¨åŠå…¶ç»“æœç­‰ã€‚è¿™äº›æ¶ˆæ¯ç›´æ¥å‚ä¸æ¨¡å‹æ¨ç†ï¼Œå®æ—¶æ›´æ–°ï¼Œå¹¶å—æ¨¡å‹çš„ maxToken é™åˆ¶ã€‚å½“æ¶ˆæ¯ç´¯ç§¯å¯¼è‡´ä¸Šä¸‹æ–‡çª—å£è¶…å‡ºé™åˆ¶æ—¶ï¼Œéœ€è¦é€šè¿‡ä¸Šä¸‹æ–‡å·¥ç¨‹ç­–ç•¥ï¼ˆå‹ç¼©ã€å¸è½½ã€æ‘˜è¦ç­‰ï¼‰è¿›è¡Œå¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸»è¦å¤„ç†çš„éƒ¨åˆ†ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å­˜å‚¨ä¼šè¯ä¸­çš„æ‰€æœ‰äº¤äº’æ¶ˆæ¯ï¼ˆç”¨æˆ·è¾“å…¥ã€æ¨¡å‹å›å¤ã€å·¥å…·è°ƒç”¨ç­‰ï¼‰</li>
<li>ç›´æ¥å‚ä¸æ¨¡å‹æ¨ç†ï¼Œä½œä¸º LLM çš„è¾“å…¥ä¸Šä¸‹æ–‡</li>
<li>å®æ—¶æ›´æ–°ï¼Œæ¯æ¬¡äº¤äº’éƒ½ä¼šæ–°å¢æ¶ˆæ¯</li>
<li>å—æ¨¡å‹ maxToken é™åˆ¶ï¼Œéœ€è¦ä¸Šä¸‹æ–‡å·¥ç¨‹ç­–ç•¥è¿›è¡Œä¼˜åŒ–</li>
</ul>
<p>å…³äºçŸ­æœŸè®°å¿†çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ç­–ç•¥ï¼ˆå‹ç¼©ã€å¸è½½ã€æ‘˜è¦ç­‰ï¼‰ï¼Œå°†åœ¨ä¸‹ä¸€ç« èŠ‚ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<h3 data-id="heading-7">2.3 é•¿æœŸè®°å¿†ï¼ˆè·¨ä¼šè¯ï¼‰</h3>
<p>é•¿æœŸè®°å¿†ä¸çŸ­æœŸè®°å¿†å½¢æˆåŒå‘äº¤äº’ï¼šä¸€æ–¹é¢ï¼Œé•¿æœŸè®°å¿†ä»çŸ­æœŸè®°å¿†ä¸­æå–â€œäº‹å®â€ã€â€œåå¥½â€ã€â€œç»éªŒâ€ç­‰æœ‰æ•ˆä¿¡æ¯è¿›è¡Œå­˜å‚¨ï¼ˆRecordï¼‰ï¼›å¦ä¸€æ–¹é¢ï¼Œé•¿æœŸè®°å¿†ä¸­çš„ä¿¡æ¯ä¼šè¢«æ£€ç´¢å¹¶æ³¨å…¥åˆ°çŸ­æœŸè®°å¿†ä¸­ï¼Œè¾…åŠ©æ¨¡å‹è¿›è¡Œä¸ªæ€§åŒ–æ¨ç†ï¼ˆRetrieveï¼‰ã€‚</p>
<p><strong>ä¸çŸ­æœŸè®°å¿†çš„äº¤äº’ï¼š</strong></p>
<ul>
<li><strong>Recordï¼ˆå†™å…¥ï¼‰ï¼š</strong> ä»çŸ­æœŸè®°å¿†çš„ä¼šè¯æ¶ˆæ¯ä¸­æå–æœ‰æ•ˆä¿¡æ¯ï¼Œé€šè¿‡LLMè¿›è¡Œè¯­ä¹‰ç†è§£å’ŒæŠ½å–ï¼Œå­˜å‚¨åˆ°é•¿æœŸè®°å¿†ä¸­</li>
<li><strong>Retrieveï¼ˆæ£€ç´¢ï¼‰ï¼š</strong> æ ¹æ®å½“å‰ç”¨æˆ·æŸ¥è¯¢ï¼Œä»é•¿æœŸè®°å¿†ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œæ³¨å…¥åˆ°çŸ­æœŸè®°å¿†ä¸­ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œè¾…åŠ©æ¨¡å‹æ¨ç†</li>
</ul>
<p><strong>å®è·µä¸­çš„å®ç°æ–¹å¼ï¼š</strong></p>
<p>åœ¨ Agent å¼€å‘å®è·µä¸­ï¼Œé•¿æœŸè®°å¿†é€šå¸¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå› ä¸ºå…¶å†…éƒ¨æœ‰ç›¸å¯¹æ¯”è¾ƒå¤æ‚çš„æµç¨‹ï¼ˆä¿¡æ¯æå–ã€å‘é‡åŒ–ã€å­˜å‚¨ã€æ£€ç´¢ç­‰ï¼‰ã€‚å¸¸è§çš„é•¿æœŸè®°å¿†ç»„ä»¶åŒ…æ‹¬ Mem0ã€Zepã€Memosã€ReMe ç­‰ï¼Œè¿™äº›ç»„ä»¶æä¾›äº†å®Œæ•´çš„ Record å’Œ Retrieve èƒ½åŠ›ï¼ŒAgent æ¡†æ¶é€šè¿‡ API é›†æˆè¿™äº›ç»„ä»¶ã€‚</p>
<p><strong>ä¿¡æ¯ç»„ç»‡ç»´åº¦ï¼š</strong></p>
<p>ä¸åŒé•¿æœŸè®°å¿†äº§å“åœ¨ä¿¡æ¯ç»„ç»‡ç»´åº¦ä¸Šæœ‰æ‰€å·®å¼‚ï¼šä¸€äº›äº§å“ä¸»è¦å…³æ³¨ä¸ªäººä¿¡æ¯ï¼ˆä¸ªäººè®°å¿†ï¼‰ï¼Œè€Œä¸€äº›äº§å“é™¤äº†æ”¯æŒä¸ªäººè®°å¿†å¤–ï¼Œè¿˜æ”¯æŒå·¥å…·è®°å¿†ã€ä»»åŠ¡è®°å¿†ç­‰æ›´ä¸°å¯Œçš„ç»´åº¦ã€‚</p>
<ol>
<li>
<p><strong>ç”¨æˆ·ç»´åº¦ï¼ˆä¸ªäººè®°å¿†ï¼‰ï¼š</strong> é¢å‘ç”¨æˆ·ç»´åº¦ç»„ç»‡çš„å®æ—¶æ›´æ–°çš„ä¸ªäººçŸ¥è¯†åº“</p>
<ul>
<li>ç”¨æˆ·ç”»åƒåˆ†ææŠ¥å‘Š</li>
<li>ä¸ªæ€§åŒ–æ¨èç³»ç»Ÿï¼Œåƒäººåƒé¢</li>
<li>å¤„ç†å…·ä½“ä»»åŠ¡æ—¶åŠ è½½è‡³çŸ­æœŸè®°å¿†ä¸­</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡é¢†åŸŸç»´åº¦ï¼š</strong> æ²‰æ·€çš„ç»éªŒï¼ˆåŒ…æ‹¬é¢†åŸŸç»éªŒå’Œå·¥å…·ä½¿ç”¨ç»éªŒï¼‰</p>
<ul>
<li>å¯æ²‰æ·€è‡³é¢†åŸŸçŸ¥è¯†åº“</li>
<li>å¯é€šè¿‡å¼ºåŒ–å­¦ä¹ å¾®è°ƒæ²‰æ·€è‡³æ¨¡å‹</li>
</ul>
</li>
</ol>
<h2 data-id="heading-8">çŸ­æœŸè®°å¿†çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ç­–ç•¥</h2>
<p>çŸ­æœŸè®°å¿†ç›´æ¥å‚ä¸ Agent å’Œ LLM çš„äº¤äº’ï¼Œéšç€å¯¹è¯å†å²å¢é•¿ï¼Œä¸Šä¸‹æ–‡çª—å£ä¼šé¢ä¸´ token é™åˆ¶å’Œæˆæœ¬å‹åŠ›ã€‚ä¸Šä¸‹æ–‡å·¥ç¨‹ç­–ç•¥æ—¨åœ¨é€šè¿‡æ™ºèƒ½åŒ–çš„å‹ç¼©ã€å¸è½½å’Œæ‘˜è¦æŠ€æœ¯ï¼Œåœ¨ä¿æŒä¿¡æ¯å®Œæ•´æ€§çš„åŒæ—¶ï¼Œæœ‰æ•ˆæ§åˆ¶ä¸Šä¸‹æ–‡å¤§å°ã€‚</p>
<p><strong>å¤‡æ³¨ï¼š</strong> éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå„æ–¹å¯¹ä¸Šä¸‹æ–‡å·¥ç¨‹çš„æ¦‚å¿µå’Œç†è§£å­˜åœ¨äº›è®¸å·®å¼‚ã€‚<strong>ç‹­ä¹‰çš„ä¸Šä¸‹æ–‡å·¥ç¨‹</strong>ç‰¹æŒ‡å¯¹çŸ­æœŸè®°å¿†ï¼ˆä¼šè¯å†å²ï¼‰ä¸­å„ç§å‹ç¼©ã€æ‘˜è¦ã€å¸è½½ç­‰å¤„ç†æœºåˆ¶ï¼Œä¸»è¦è§£å†³ä¸Šä¸‹æ–‡çª—å£é™åˆ¶å’Œ token æˆæœ¬é—®é¢˜ï¼›<strong>å¹¿ä¹‰çš„ä¸Šä¸‹æ–‡å·¥ç¨‹</strong>åˆ™åŒ…æ‹¬æ›´å¹¿æ³›çš„ä¸Šä¸‹æ–‡ä¼˜åŒ–ç­–ç•¥ï¼Œå¦‚éè¿è¡Œæ€çš„æ¨¡å‹é€‰æ‹©ã€Prompt ä¼˜åŒ–å·¥ç¨‹ã€çŸ¥è¯†åº“æ„å»ºã€å·¥å…·é›†æ„å»ºç­‰ï¼Œè¿™äº›éƒ½æ˜¯åœ¨æ¨¡å‹æ¨ç†å‰å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œä¼˜åŒ–çš„æ‰‹æ®µï¼Œä¸”è¿™äº›å› ç´ éƒ½å¯¹æ¨¡å‹æ¨ç†ç»“æœæœ‰é‡è¦å½±å“ã€‚æœ¬ç« èŠ‚ä¸»è¦è®¨è®ºç‹­ä¹‰çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼Œå³é’ˆå¯¹çŸ­æœŸè®°å¿†çš„è¿è¡Œæ—¶å¤„ç†ç­–ç•¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24e5d661c30a4aa1b54d4994cab1befd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=LQl99B9L13t11r8RU5SIs1hQn3c%3D" alt="image_1766570688185.png" loading="lazy"/></p>
<h3 data-id="heading-9">3.1 æ ¸å¿ƒç­–ç•¥</h3>
<p>é’ˆå¯¹çŸ­æœŸè®°å¿†çš„ä¸Šä¸‹æ–‡å¤„ç†ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ç­–ç•¥ï¼š</p>
<h4 data-id="heading-10">ä¸Šä¸‹æ–‡ç¼©å‡ï¼ˆContext Reductionï¼‰</h4>
<p>ä¸Šä¸‹æ–‡ç¼©å‡é€šè¿‡å‡å°‘ä¸Šä¸‹æ–‡ä¸­çš„ä¿¡æ¯é‡æ¥é™ä½ token æ¶ˆè€—ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<p><strong>1. ä¿ç•™é¢„è§ˆå†…å®¹ï¼š</strong> å¯¹äºå¤§å—å†…å®¹ï¼Œåªä¿ç•™å‰ N ä¸ªå­—ç¬¦æˆ–å…³é”®ç‰‡æ®µä½œä¸ºé¢„è§ˆï¼ŒåŸå§‹å®Œæ•´å†…å®¹è¢«ç§»é™¤</p>
<p><strong>2. æ€»ç»“æ‘˜è¦ï¼š</strong> ä½¿ç”¨ LLM å¯¹æ•´æ®µå†…å®¹è¿›è¡Œæ€»ç»“æ‘˜è¦ï¼Œä¿ç•™å…³é”®ä¿¡æ¯ï¼Œä¸¢å¼ƒç»†èŠ‚</p>
<p>è¿™ä¸¤ç§æ–¹æ³•éƒ½ä¼šå¯¼è‡´ä¿¡æ¯ä¸¢å¤±ï¼Œä½†èƒ½æœ‰æ•ˆå‡å°‘ token æ¶ˆè€—ã€‚</p>
<h4 data-id="heading-11">ä¸Šä¸‹æ–‡å¸è½½ï¼ˆContext Offloadingï¼‰</h4>
<p>ä¸Šä¸‹æ–‡å¸è½½ä¸»è¦è§£å†³è¢«ç¼©å‡çš„å†…å®¹æ˜¯å¦å¯æ¢å¤çš„é—®é¢˜ã€‚å½“å†…å®¹è¢«ç¼©å‡åï¼ŒåŸå§‹å®Œæ•´å†…å®¹è¢«å¸è½½åˆ°å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰ï¼‰ï¼Œæ¶ˆæ¯ä¸­åªä¿ç•™æœ€å°å¿…è¦çš„å¼•ç”¨ï¼ˆå¦‚æ–‡ä»¶è·¯å¾„ã€UUID ç­‰ï¼‰ã€‚å½“éœ€è¦å®Œæ•´å†…å®¹æ—¶ï¼Œå¯ä»¥é€šè¿‡å¼•ç”¨é‡æ–°åŠ è½½ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šä¸Šä¸‹æ–‡æ›´å¹²å‡€ï¼Œå ç”¨æ›´å°ï¼Œä¿¡æ¯ä¸ä¸¢ï¼Œéšå–éšç”¨ã€‚é€‚ç”¨äºç½‘é¡µæœç´¢ç»“æœã€è¶…é•¿å·¥å…·è¾“å‡ºã€ä¸´æ—¶è®¡åˆ’ç­‰å  token è¾ƒå¤šçš„å†…å®¹ã€‚</p>
<h4 data-id="heading-12">ä¸Šä¸‹æ–‡éš”ç¦»ï¼ˆContext Isolationï¼‰</h4>
<p>é€šè¿‡å¤šæ™ºèƒ½ä½“æ¶æ„ï¼Œå°†ä¸Šä¸‹æ–‡æ‹†åˆ†åˆ°ä¸åŒçš„å­æ™ºèƒ½ä½“ä¸­ï¼ˆç±»ä¼¼å•ä½“æ‹†åˆ†ç§°å¤šä¸ªå¾®æœåŠ¡ï¼‰ã€‚ä¸»æ™ºèƒ½ä½“ç¼–å†™ä»»åŠ¡æŒ‡ä»¤ï¼Œå‘é€ç»™å­æ™ºèƒ½ä½“ï¼Œå­æ™ºèƒ½ä½“çš„æ•´ä¸ªä¸Šä¸‹æ–‡ä»…ç”±è¯¥æŒ‡ä»¤ç»„æˆã€‚å­æ™ºèƒ½ä½“å®Œæˆä»»åŠ¡åè¿”å›ç»“æœï¼Œä¸»æ™ºèƒ½ä½“ä¸å…³å¿ƒå­æ™ºèƒ½ä½“å¦‚ä½•æ‰§è¡Œï¼Œåªéœ€è¦ç»“æœã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä»»åŠ¡æœ‰æ¸…æ™°ç®€çŸ­çš„æŒ‡ä»¤ï¼Œåªæœ‰æœ€ç»ˆè¾“å‡ºæ‰é‡è¦ï¼Œå¦‚ä»£ç åº“ä¸­æœç´¢ç‰¹å®šç‰‡æ®µã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šä¸Šä¸‹æ–‡å°ã€å¼€é”€ä½ã€ç®€å•ç›´æ¥ã€‚</p>
<p><strong>ç­–ç•¥é€‰æ‹©åŸåˆ™ï¼š</strong></p>
<p>ä»¥ä¸Šä¸‰ç§ç­–ç•¥ï¼ˆä¸Šä¸‹æ–‡ç¼©å‡ã€ä¸Šä¸‹æ–‡å¸è½½ã€ä¸Šä¸‹æ–‡éš”ç¦»ï¼‰éœ€è¦æ ¹æ®æ•°æ®çš„åˆ†ç±»è¿›è¡Œç»¼åˆå¤„ç†ï¼Œä¸»è¦è€ƒè™‘å› ç´ åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ—¶é—´è¿œè¿‘ï¼š</strong> è¿‘æœŸæ¶ˆæ¯é€šå¸¸æ›´é‡è¦ï¼Œéœ€è¦ä¼˜å…ˆä¿ç•™ï¼›å†å²æ¶ˆæ¯å¯ä»¥ä¼˜å…ˆè¿›è¡Œç¼©å‡æˆ–å¸è½½</li>
<li><strong>æ•°æ®ç±»å‹ï¼š</strong> ä¸åŒç±»å‹çš„æ¶ˆæ¯ï¼ˆç”¨æˆ·è¾“å…¥ã€æ¨¡å‹å›å¤ã€å·¥å…·è°ƒç”¨ç»“æœç­‰ï¼‰é‡è¦æ€§ä¸åŒï¼Œéœ€è¦é‡‡ç”¨ä¸åŒçš„å¤„ç†ç­–ç•¥</li>
<li><strong>ä¿¡æ¯å¯æ¢å¤æ€§ï¼š</strong> å¯¹äºéœ€è¦å®Œæ•´ä¿¡æ¯çš„å†…å®¹ï¼Œåº”ä¼˜å…ˆä½¿ç”¨å¸è½½ç­–ç•¥ï¼›å¯¹äºå¯ä»¥æ¥å—ä¿¡æ¯ä¸¢å¤±çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ç¼©å‡ç­–ç•¥</li>
</ul>
<h3 data-id="heading-13">3.2 å„æ¡†æ¶çš„å®ç°æ–¹å¼</h3>
<p>å„æ¡†æ¶ä¸€èˆ¬å†…ç½®ä¸Šä¸‹æ–‡å¤„ç†ç­–ç•¥ï¼Œé€šè¿‡å‚æ•°åŒ–é…ç½®çš„æ–¹å¼æŒ‡å®šå…·ä½“ç­–ç•¥ã€‚</p>
<p><strong>Google ADK</strong></p>
<p>æ„å»º Agent æ—¶é€šè¿‡Â <code>events_compaction_config</code> è®¾ç½®ä¸Šä¸‹æ–‡å¤„ç†ç­–ç•¥ï¼Œå’Œ Session æœ¬èº«çš„æ•°æ®å­˜å‚¨ç‹¬ç«‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">fromÂ google.adk.apps.appÂ importÂ App, EventsCompactionConfig
<span class="hljs-attr">app</span> = App(
Â  Â  <span class="hljs-attr">name</span>=<span class="hljs-string">'my-agent'</span>,
Â  Â  <span class="hljs-attr">root_agent</span>=root_agent,
Â  Â  <span class="hljs-attr">events_compaction_config</span>=EventsCompactionConfig(
Â  Â  Â  Â  <span class="hljs-attr">compaction_interval</span>=<span class="hljs-number">3</span>, Â <span class="hljs-comment"># æ¯3æ¬¡æ–°è°ƒç”¨è§¦å‘å‹ç¼©</span>
Â  Â  Â  Â  <span class="hljs-attr">overlap_size</span>=<span class="hljs-number">1</span>Â  Â  Â  Â  Â Â <span class="hljs-comment"># åŒ…å«å‰ä¸€ä¸ªçª—å£çš„æœ€åä¸€æ¬¡è°ƒç”¨</span>
Â  Â  ),
)
</code></pre>
<p><strong>LangChain</strong></p>
<p>æ„å»º Agent æ—¶é€šè¿‡ middleware æœºåˆ¶ä¸­çš„Â <code>SummarizationMiddleware</code> è®¾ç½®ä¸Šä¸‹æ–‡å¤„ç†å‚æ•°ï¼Œä¸çŸ­æœŸè®°å¿†æœ¬èº«çš„æ•°æ®å­˜å‚¨ç‹¬ç«‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">fromÂ langchain.agentsÂ importÂ create_agent
fromÂ langchain.agents.middlewareÂ importÂ SummarizationMiddleware
<span class="hljs-attr">agent</span> = create_agent(
Â  Â  <span class="hljs-attr">model</span>=<span class="hljs-string">"gpt-4o"</span>,
Â  Â  <span class="hljs-attr">tools</span>=[...],
Â  Â  <span class="hljs-attr">middleware</span>=[
Â  Â  Â  Â  SummarizationMiddleware(
Â  Â  Â  Â  Â  Â  model=<span class="hljs-string">"gpt-4o-mini"</span>,
Â  Â  Â  Â  Â  Â  max_tokens_before_summary=<span class="hljs-number">4000</span>, Â <span class="hljs-comment"># 4000 tokensæ—¶è§¦å‘æ‘˜è¦</span>
Â  Â  Â  Â  Â  Â  messages_to_keep=<span class="hljs-number">20</span>, Â <span class="hljs-comment"># æ‘˜è¦åä¿ç•™æœ€å20æ¡æ¶ˆæ¯</span>
Â  Â  Â  Â  ),
Â  Â  ],
)
</code></pre>
<p><strong>AgentScope</strong></p>
<p>AgentScope é€šè¿‡Â <strong>AutoContextMemory</strong> æä¾›æ™ºèƒ½åŒ–çš„ä¸Šä¸‹æ–‡å·¥ç¨‹è§£å†³æ–¹æ¡ˆã€‚AutoContextMemory å®ç°äº†Â <code>Memory</code> æ¥å£ï¼Œå½“å¯¹è¯å†å²è¶…è¿‡é…ç½®é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨åº”ç”¨ 6 ç§æ¸è¿›å¼å‹ç¼©ç­–ç•¥ï¼ˆä»è½»é‡çº§åˆ°é‡é‡çº§ï¼‰æ¥å‡å°‘ä¸Šä¸‹æ–‡å¤§å°ï¼ŒåŒæ—¶ä¿ç•™é‡è¦ä¿¡æ¯ã€‚</p>
<p><strong>é›†æˆæ–¹å¼ï¼š</strong></p>
<ul>
<li>ç›´æ¥ä½œä¸ºÂ <code>Memory</code> æ¥å£å®ç°ï¼Œé€šè¿‡Â <code>memory</code> å‚æ•°é›†æˆåˆ° Agent ä¸­</li>
<li>ä¸æ¡†æ¶æ·±åº¦é›†æˆï¼Œæ— éœ€é¢å¤–çš„ middleware æˆ–ç‹¬ç«‹é…ç½®</li>
</ul>
<p><strong>ä¸ ADK å’Œ LangChain çš„å·®å¼‚ï¼š</strong></p>
<ul>
<li><strong>æ›´ç²¾ç»†åŒ–çš„å‹ç¼©ç­–ç•¥ï¼š</strong> æä¾› 6 ç§æ¸è¿›å¼å‹ç¼©ç­–ç•¥ï¼ˆå‹ç¼©å†å²å·¥å…·è°ƒç”¨ã€å¸è½½å¤§å‹æ¶ˆæ¯ã€æ‘˜è¦å¯¹è¯è½®æ¬¡ç­‰ï¼‰ï¼Œç›¸æ¯” ADK çš„ç®€å•å‹ç¼©å’Œ LangChain çš„æ‘˜è¦ middlewareï¼Œç­–ç•¥æ›´åŠ ç»†åŒ–å’Œå¯æ§</li>
<li><strong>é›†æˆæ–¹å¼ï¼š</strong> ç›´æ¥å®ç° Memory æ¥å£ï¼Œä¸ Agent æ„å»ºæµç¨‹æ— ç¼é›†æˆï¼Œè€Œ ADK å’Œ LangChain éœ€è¦ç‹¬ç«‹çš„é…ç½®å¯¹è±¡æˆ– middleware æœºåˆ¶</li>
<li><strong>å®Œæ•´å¯è¿½æº¯æ€§ï¼š</strong> æä¾›å·¥ä½œå†…å­˜ã€åŸå§‹å†…å­˜ã€å¸è½½ä¸Šä¸‹æ–‡å’Œå‹ç¼©äº‹ä»¶å››å±‚å­˜å‚¨æ¶æ„ï¼Œæ”¯æŒå®Œæ•´å†å²è¿½æº¯ï¼Œè€Œå…¶ä»–æ¡†æ¶é€šå¸¸åªæä¾›å‹ç¼©åçš„ç»“æœ</li>
</ul>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">AutoContextMemoryÂ memoryÂ =Â newÂ <span class="hljs-built_in">AutoContextMemory</span>(
Â  Â  AutoContextConfig.builder()
Â  Â  Â  Â  <span class="hljs-selector-class">.msgThreshold</span>(<span class="hljs-number">100</span>)
Â  Â  Â  Â  <span class="hljs-selector-class">.maxToken</span>(<span class="hljs-number">128</span>Â *Â <span class="hljs-number">1024</span>)
Â  Â  Â  Â  <span class="hljs-selector-class">.tokenRatio</span>(<span class="hljs-number">0.75</span>)
Â  Â  Â  Â  <span class="hljs-selector-class">.build</span>(),
Â  Â  model
);
ReActAgentÂ agentÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("Assistant")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.memory</span>(memory)
Â  Â  <span class="hljs-selector-class">.build</span>();
</code></pre>
<p><strong>è¯¦ç»†æ–‡æ¡£ï¼š</strong> å…³äº AutoContextMemory çš„ 6 ç§å‹ç¼©ç­–ç•¥ã€å­˜å‚¨æ¶æ„å’Œé«˜çº§é…ç½®ï¼Œè¯·å‚è€ƒÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzIzOTU0NTQ0MA%3D%3D%26mid%3D2247556750%26idx%3D1%26sn%3D65b82a8da8595494dd6e1adbe605e649%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247556750&amp;idx=1&amp;sn=65b82a8da8595494dd6e1adbe605e649&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AutoContextMemory è¯¦ç»†æ–‡æ¡£</a>ã€‚</p>
<h2 data-id="heading-14">é•¿æœŸè®°å¿†æŠ€æœ¯æ¶æ„åŠ Agent æ¡†æ¶é›†æˆ</h2>
<p>ä¸çŸ­æœŸè®°å¿†ä¸åŒï¼Œé•¿æœŸè®°å¿†éœ€è¦è·¨ä¼šè¯æŒä¹…åŒ–å­˜å‚¨ï¼Œå¹¶æ”¯æŒé«˜æ•ˆçš„æ£€ç´¢å’Œæ›´æ–°ã€‚è¿™éœ€è¦ä¸€å¥—å®Œæ•´çš„æŠ€æœ¯æ¶æ„ï¼ŒåŒ…æ‹¬ä¿¡æ¯æå–ã€å‘é‡åŒ–å­˜å‚¨ã€è¯­ä¹‰æ£€ç´¢ç­‰æ ¸å¿ƒç»„ä»¶ã€‚</p>
<h3 data-id="heading-15">4.1 æ ¸å¿ƒç»„ä»¶</h3>
<p>é•¿æœŸè®°å¿†æ¶‰åŠ record &amp; retrieve ä¸¤ä¸ªæ ¸å¿ƒæµç¨‹ï¼Œéœ€è¦ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š</p>
<p><strong>1. LLM å¤§æ¨¡å‹ï¼š</strong> æå–çŸ­æœŸè®°å¿†ä¸­çš„æœ‰æ•ˆä¿¡æ¯ï¼ˆè®°å¿†çš„è¯­ä¹‰ç†è§£ã€æŠ½å–ã€å†³ç­–å’Œç”Ÿæˆï¼‰</p>
<p><strong>2. Embedder å‘é‡åŒ–ï¼š</strong> å°†æ–‡æœ¬è½¬æ¢ä¸ºè¯­ä¹‰å‘é‡ï¼Œæ”¯æŒç›¸ä¼¼æ€§è®¡ç®—</p>
<p><strong>3. VectorStore å‘é‡æ•°æ®åº“ï¼š</strong> æŒä¹…åŒ–å­˜å‚¨è®°å¿†å‘é‡å’Œå…ƒæ•°æ®ï¼Œæ”¯æŒé«˜æ•ˆè¯­ä¹‰æ£€ç´¢</p>
<p><strong>4. GraphStore å›¾æ•°æ®åº“ï¼š</strong> å­˜å‚¨å®ä½“-å…³ç³»çŸ¥è¯†å›¾è°±ï¼Œæ”¯æŒå¤æ‚å…³ç³»æ¨ç†</p>
<p><strong>5. Rerankerï¼ˆé‡æ’åºå™¨ï¼‰ï¼š</strong> å¯¹åˆæ­¥æ£€ç´¢ç»“æœæŒ‰è¯­ä¹‰ç›¸å…³æ€§é‡æ–°æ’åº</p>
<p><strong>6. SQLiteï¼š</strong> è®°å½•æ‰€æœ‰è®°å¿†æ“ä½œçš„å®¡è®¡æ—¥å¿—ï¼Œæ”¯æŒç‰ˆæœ¬å›æº¯</p>
<h3 data-id="heading-16">4.2 Record &amp; Retrieve æµç¨‹</h3>
<p>Recordï¼ˆè®°å½•ï¼‰</p>
<pre><code class="hljs">LLMÂ äº‹å®æå– â†’ ä¿¡æ¯å‘é‡åŒ– â†’ å‘é‡å­˜å‚¨ â†’ï¼ˆå¤æ‚å…³ç³»å­˜å‚¨ï¼‰â†’ SQLite æ“ä½œæ—¥å¿—
</code></pre>
<p>Retrieveï¼ˆæ£€ç´¢ï¼‰</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">User</span>Â query å‘é‡åŒ– â†’ å‘é‡æ•°æ®åº“è¯­ä¹‰æ£€ç´¢ â†’ å›¾æ•°æ®åº“å…³ç³»è¡¥å…… â†’ï¼ˆReranker<span class="hljs-operator">-</span>LLMï¼‰â†’ ç»“æœè¿”å›
</code></pre>
<h3 data-id="heading-17">4.3 é•¿æœŸè®°å¿†ä¸ RAG çš„åŒºåˆ«</h3>
<p>åƒ Mem0 è¿™ç±»é¢å‘ AI Agent çš„ä¸ªæ€§åŒ–é•¿æœŸè®°å¿†ç³»ç»Ÿï¼Œä¸ RAGï¼ˆRetrieval-Augmented Generationï¼‰åœ¨æŠ€æœ¯æ¶æ„ä¸Šæœ‰è¯¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†åŠŸèƒ½å±‚é¢å’Œåœºæ™¯ä¸Šæœ‰æ˜æ˜¾åŒºåˆ«ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50c50041f1bf4d5f9072d7d0aaf36d30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=D9%2BuaCSddMuXVnZQsT4PO0DVcUY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æŠ€æœ¯å±‚é¢çš„ç›¸ä¼¼ç‚¹ï¼š</strong></p>
<ol>
<li>
<p>å‘é‡åŒ–å­˜å‚¨ï¼šéƒ½å°†æ–‡æœ¬å†…å®¹é€šè¿‡ Embedding æ¨¡å‹è½¬ä¸ºå‘é‡ï¼Œå­˜å…¥å‘é‡æ•°æ®åº“</p>
</li>
<li>
<p>ç›¸ä¼¼æ€§æ£€ç´¢ï¼šåœ¨ç”¨æˆ·æé—®æ—¶ï¼Œå°†å½“å‰ query å‘é‡åŒ–ï¼Œåœ¨å‘é‡åº“ä¸­æ£€ç´¢ top-k æœ€ç›¸å…³çš„æ¡ç›®</p>
</li>
<li>
<p>æ³¨å…¥ä¸Šä¸‹æ–‡ç”Ÿæˆï¼šå°†æ£€ç´¢åˆ°çš„å†…å®¹æ³¨å…¥åˆ°æ¨¡å‹äº¤äº’ä¸Šä¸‹æ–‡ä¸­ï¼Œè¾…åŠ© LLM ç”Ÿæˆæœ€ç»ˆå›ç­”</p>
</li>
</ol>
<h3 data-id="heading-18">4.4 å…³é”®é—®é¢˜ä¸æŒ‘æˆ˜</h3>
<p>é•¿æœŸè®°å¿†ç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ï¼Œè¿™äº›æŒ‘æˆ˜ç›´æ¥å½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œç”¨æˆ·ä½“éªŒã€‚</p>
<p><strong>1. å‡†ç¡®æ€§</strong></p>
<p>è®°å¿†çš„å‡†ç¡®æ€§åŒ…å«ä¸¤ä¸ªå±‚é¢ï¼š</p>
<ul>
<li>æœ‰æ•ˆçš„è®°å¿†ç®¡ç†ï¼šéœ€è¦å…·å¤‡æ™ºèƒ½çš„å·©å›ºã€æ›´æ–°å’Œé—å¿˜æœºåˆ¶ï¼Œè¿™ä¸»è¦ä¾èµ–äºè®°å¿†ç³»ç»Ÿä¸­è´Ÿè´£ä¿¡æ¯æå–çš„æ¨¡å‹èƒ½åŠ›å’Œç®—æ³•è®¾è®¡</li>
<li>è®°å¿†ç›¸å…³æ€§çš„æ£€ç´¢å‡†ç¡®åº¦ï¼šä¸»è¦ä¾èµ–äºå‘é‡åŒ–æ£€ç´¢&amp;é‡æ’çš„æ ¸å¿ƒèƒ½åŠ›</li>
</ul>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜ï¼š</strong></p>
<ul>
<li>è®°å¿†çš„å»ºæ¨¡ï¼šéœ€è¦å®Œå–„å¼ºå¤§çš„ç”¨æˆ·ç”»åƒæ¨¡å‹</li>
<li>è®°å¿†çš„ç®¡ç†ï¼šåŸºäºç”¨æˆ·ç”»åƒå»ºæ¨¡ç®—æ³•ï¼Œæå–æœ‰æ•ˆä¿¡æ¯ï¼Œè®¾è®¡è®°å¿†æ›´æ–°æœºåˆ¶</li>
<li>å‘é‡åŒ–ç›¸å…³æ€§æ£€ç´¢èƒ½åŠ›ï¼šæå‡æ£€ç´¢å‡†ç¡®ç‡å’Œç›¸å…³æ€§</li>
</ul>
<p><strong>2. å®‰å…¨å’Œéšç§</strong></p>
<p>è®°å¿†ç³»ç»Ÿè®°ä½äº†å¤§é‡ç”¨æˆ·éšç§ä¿¡æ¯ï¼Œå¦‚ä½•é˜²æ­¢æ•°æ®ä¸­æ¯’ç­‰æ¶æ„æ”»å‡»ï¼Œå¹¶ä¿éšœç”¨æˆ·éšç§ï¼Œæ˜¯å¿…é¡»è§£å†³çš„é—®é¢˜ã€‚</p>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜ï¼š</strong></p>
<ul>
<li>æ•°æ®åŠ å¯†ä¸è®¿é—®æ§åˆ¶</li>
<li>é˜²æ­¢æ¶æ„æ•°æ®æ³¨å…¥</li>
<li>é€æ˜çš„æ•°æ®ç®¡ç†æœºåˆ¶</li>
<li>ç”¨æˆ·å¯¹è‡ªèº«æ•°æ®çš„æŒæ§æƒ</li>
</ul>
<p><strong>3. å¤šæ¨¡æ€è®°å¿†æ”¯æŒ</strong></p>
<p>æ–‡æœ¬è®°å¿†ã€è§†è§‰ã€è¯­éŸ³ä»è¢«å­¤ç«‹å¤„ç†ï¼Œå¦‚ä½•æ„å»ºç»Ÿä¸€çš„â€œå¤šæ¨¡æ€è®°å¿†ç©ºé—´â€ä»æ˜¯æœªè§£éš¾é¢˜ã€‚</p>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜ï¼š</strong></p>
<ul>
<li>è·¨æ¨¡æ€å…³è”ä¸æ£€ç´¢</li>
<li>ç»Ÿä¸€çš„å¤šæ¨¡æ€è®°å¿†è¡¨ç¤º</li>
<li>æ¯«ç§’çº§å“åº”èƒ½åŠ›</li>
</ul>
<h3 data-id="heading-19">4.5 Agent æ¡†æ¶é›†æˆ</h3>
<p>åœ¨ AgentScope ä¸­ï¼Œå¯ä»¥é€šè¿‡é›†æˆç¬¬ä¸‰æ–¹é•¿æœŸè®°å¿†ç»„ä»¶æ¥å®ç°é•¿æœŸè®°å¿†åŠŸèƒ½ã€‚å¸¸è§çš„é›†æˆæ–¹å¼åŒ…æ‹¬ï¼š</p>
<h4 data-id="heading-20">4.5.1 é›†æˆ Mem0</h4>
<p>Mem0 æ˜¯ä¸€ä¸ªå¼€æºçš„é•¿æœŸè®°å¿†æ¡†æ¶ï¼Œå‡ ä¹æˆä¸ºäº‹å®æ ‡å‡†ã€‚åœ¨ AgentScope ä¸­é›†æˆ Mem0 çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆå§‹åŒ–Mem0é•¿æœŸè®°å¿†</span>
Mem0LongTermMemoryÂ mem0MemoryÂ =Â newÂ <span class="hljs-built_in">Mem0LongTermMemory</span>(
Â  Â  Mem0Config.builder()
Â  Â  Â  Â  <span class="hljs-selector-class">.apiKey</span>("your-mem0-api-key")
Â  Â  Â  Â  <span class="hljs-selector-class">.build</span>()
);
<span class="hljs-comment">// åˆ›å»ºAgentå¹¶é›†æˆé•¿æœŸè®°å¿†</span>
ReActAgentÂ agentÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("Assistant")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.memory</span>(memory) Â <span class="hljs-comment">// çŸ­æœŸè®°å¿†</span>
Â  Â  <span class="hljs-selector-class">.longTermMemory</span>(mem0Memory) Â <span class="hljs-comment">// é•¿æœŸè®°å¿†</span>
Â  Â  <span class="hljs-selector-class">.build</span>();
</code></pre>
<h4 data-id="heading-21">4.5.2 é›†æˆ ReMe</h4>
<p>ReMe æ˜¯ AgentScope å®˜æ–¹æä¾›çš„é•¿æœŸè®°å¿†å®ç°ï¼Œä¸æ¡†æ¶æ·±åº¦é›†æˆï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆå§‹åŒ–ReMeé•¿æœŸè®°å¿†</span>
ReMeLongTermMemoryÂ remeMemoryÂ =Â ReMeLongTermMemory<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.userId</span>("user123") Â <span class="hljs-comment">// ç”¨æˆ·IDï¼Œç”¨äºè®°å¿†éš”ç¦»</span>
Â  Â  <span class="hljs-selector-class">.apiBaseUrl</span>("http://localhost:<span class="hljs-number">8002</span>") Â <span class="hljs-comment">// ReMeæœåŠ¡åœ°å€</span>
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// åˆ›å»ºAgentå¹¶é›†æˆé•¿æœŸè®°å¿†</span>
ReActAgentÂ agentÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("Assistant")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.memory</span>(memory) Â <span class="hljs-comment">// çŸ­æœŸè®°å¿†</span>
Â  Â  <span class="hljs-selector-class">.longTermMemory</span>(remeMemory) Â <span class="hljs-comment">// é•¿æœŸè®°å¿†</span>
Â  Â  <span class="hljs-selector-class">.longTermMemoryMode</span>(LongTermMemoryMode.BOTH) Â <span class="hljs-comment">// è®°å¿†æ¨¡å¼</span>
Â  Â  <span class="hljs-selector-class">.build</span>();
</code></pre>
<h2 data-id="heading-22">è¡Œä¸šè¶‹åŠ¿ä¸äº§å“å¯¹æ¯”</h2>
<h3 data-id="heading-23">5.1 AI è®°å¿†ç³»ç»Ÿå‘å±•è¶‹åŠ¿</h3>
<p>AI è®°å¿†ç³»ç»Ÿçš„æ ¸å¿ƒç›®æ ‡æ˜¯è®© AI èƒ½åƒäººç±»ä¸€æ ·æŒç»­å­¦ä¹ ã€å½¢æˆé•¿æœŸè®°å¿†ï¼Œä»è€Œå˜å¾—æ›´æ™ºèƒ½ã€æ›´ä¸ªæ€§åŒ–ã€‚å½“å‰è¡Œä¸šå‘ˆç°å‡ºä»ç ”ç©¶åŸå‹å‘ç”Ÿäº§çº§ç³»ç»Ÿæ¼”è¿›ã€ä»å•ä¸€æŠ€æœ¯å‘ç»¼åˆè§£å†³æ–¹æ¡ˆå‘å±•çš„è¶‹åŠ¿ã€‚</p>
<h4 data-id="heading-24">5.1.1 å½“å‰å‘å±•çš„æ ¸å¿ƒè„‰ç»œ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05da7e83795847dd9b366cc99f23ba03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=w0VavWRlmzW6QzoQnOGwzLTYwh8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-25">5.1.2 æŠ€æœ¯å‘å±•è¶‹åŠ¿</h4>
<p><strong>è®°å¿†å³æœåŠ¡ï¼ˆMemory-as-a-Service, MaaSï¼‰</strong></p>
<p>AI Agent æ˜¯å¤§æ¨¡å‹ã€è®°å¿†ã€ä»»åŠ¡è§„åˆ’ä»¥åŠå·¥å…·ä½¿ç”¨çš„é›†åˆä½“ï¼Œè®°å¿†ç®¡ç†å°†æ˜¯ Agent æ™ºèƒ½ä½“çš„æ ¸å¿ƒåŸºç¡€åŠŸèƒ½ä¹‹ä¸€ã€‚ç±»ä¼¼â€œæ•°æ®åº“â€ä¹‹äºä¼ ç»Ÿè½¯ä»¶ï¼Œè®°å¿†ç³»ç»Ÿå°†æˆä¸º AI åº”ç”¨çš„åŸºç¡€è®¾æ–½ï¼Œæä¾›æ ‡å‡†åŒ–çš„è®°å¿†æœåŠ¡æ¥å£ã€å¯æ‰©å±•çš„å­˜å‚¨å’Œæ£€ç´¢èƒ½åŠ›ã€‚</p>
<p><strong>ç²¾ç»†åŒ–è®°å¿†ç®¡ç†</strong></p>
<p>å€Ÿé‰´äººè„‘è®°å¿†æœºåˆ¶ï¼Œæ„å»ºåˆ†å±‚åŠ¨æ€çš„è®°å¿†æ¶æ„ï¼Œå¯¹è®°å¿†è¿›è¡Œå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚æŠ€æœ¯è·¯å¾„åŒ…æ‹¬ï¼šLLM é©±åŠ¨è®°å¿†æå– + å‘é‡åŒ–å­˜å‚¨ + å›¾æ•°æ®åº“è¡¥å……ï¼›å‘é‡åŒ–æ£€ç´¢ï¼ˆæµ·é©¬ä½“ï¼‰+ LLM æçº¯ï¼ˆå¤§è„‘çš®å±‚ï¼‰ç»“åˆï¼›é€šè¿‡å¼ºåŒ–å­¦ä¹ æå‡è®°å¿†ç®¡ç†è¡¨ç°ã€‚</p>
<p><strong>å¤šæ¨¡æ€è®°å¿†ç³»ç»Ÿ</strong></p>
<p>å¤šæ¨¡æ€å¤§æ¨¡å‹çš„å…´èµ·æ¨åŠ¨è®°å¿†ç³»ç»Ÿå‘å¤šæ¨¡æ€ã€è·¨æ¨¡æ€æ–¹å‘å‘å±•ï¼Œè¦æ±‚å­˜å‚¨å…·å¤‡è·¨æ¨¡æ€å…³è”ä¸æ¯«ç§’çº§å“åº”èƒ½åŠ›ã€‚</p>
<p><strong>å‚æ•°åŒ–è®°å¿†ï¼ˆModel å±‚é›†æˆè®°å¿†ï¼‰</strong></p>
<p>åœ¨ Transformer æ¶æ„ä¸­å¼•å…¥å¯å­¦ä¹ çš„è®°å¿†å•å…ƒ Memory Adapterï¼Œå®ç°æ¨¡å‹å±‚é¢åŸç”Ÿæ”¯æŒç”¨æˆ·ç»´åº¦çš„è®°å¿†ã€‚ä¼˜ç‚¹æ˜¯å“åº”é€Ÿåº¦å¿«ï¼Œä½†é¢ä¸´â€œç¾éš¾æ€§é—å¿˜â€å’Œæ›´æ–°æˆæœ¬é«˜çš„æŒ‘æˆ˜ã€‚</p>
<h4 data-id="heading-26">5.1.3 å½“å‰ä¸»è¦çš„æŠ€æœ¯è·¯å¾„</h4>
<p><strong>1. å¤–éƒ¨è®°å¿†å¢å¼ºï¼ˆå½“å‰ä¸»æµï¼‰ï¼š</strong> ä½¿ç”¨å‘é‡æ•°æ®åº“ç­‰å¤–éƒ¨å­˜å‚¨æ¥è®°å¿†å†å²ä¿¡æ¯ï¼Œå¹¶åœ¨éœ€è¦æ—¶é€šè¿‡æ£€ç´¢ç›¸å…³ä¿¡æ¯æ³¨å…¥å½“å‰å¯¹è¯ã€‚è¿™ç§æ–¹å¼çµæ´»é«˜æ•ˆï¼Œæ£€ç´¢çš„å‡†ç¡®æ€§æ˜¯å…³é”®ã€‚</p>
<p><strong>2. å‚æ•°åŒ–è®°å¿†ï¼ˆæ·±åº¦å†…åŒ–ï¼‰ï¼š</strong> ç›´æ¥å°†çŸ¥è¯†ç¼–ç è¿›æ¨¡å‹çš„å‚æ•°ä¸­ã€‚è¿™å¯ä»¥é€šè¿‡æ¨¡å‹å¾®è°ƒã€çŸ¥è¯†ç¼–è¾‘ç­‰æŠ€æœ¯å®ç°ï¼Œä¼˜ç‚¹æ˜¯å“åº”é€Ÿåº¦å¿«ï¼Œä½†é¢ä¸´â€œç¾éš¾æ€§é—å¿˜â€å’Œæ›´æ–°æˆæœ¬é«˜çš„æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-27">5.2 ç›¸å…³å¼€æºäº§å“å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3b42e7e65944c2aa15be84b24f1e9aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604866&amp;x-signature=Hq1NtS1kIYSzQ0IvlvZXb8yAWyI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…³äºå„äº§å“çš„å…·ä½“æ•°æ®æŒ‡æ ‡å¯¹æ¯”ï¼Œè¯„æµ‹æ–¹å¼å„æœ‰ä¾§é‡ï¼Œå› æ­¤è¯„æµ‹ç»“æœä¸å°½ç›¸åŒï¼Œä»å®é™…æƒ…å†µçœ‹ï¼Œå„æ–¹å‡ä»¥ mem0 ä¸ºè¯„æµ‹åŸºå‡†ï¼Œä»å„ç±»æŠ€æœ¯æŒ‡æ ‡è¯„æµ‹ç»“æœä»¥åŠå¼€æºç¤¾åŒºçš„æ´»è·ƒåº¦ï¼ˆstarï¼Œissues ç­‰ï¼‰æ–¹é¢ï¼Œmem0 ä»ç„¶æ˜¯å æ®é•¿æœŸè®°å¿†äº§å“çš„é¢†å¤´åœ°ä½ã€‚</p>
<h2 data-id="heading-28">ç»“è¯­</h2>
<p>è®°å¿†ç³»ç»Ÿä½œä¸º AI Agent çš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œå…¶å‘å±•ç›´æ¥å½±å“ç€æ™ºèƒ½ä½“çš„èƒ½åŠ›å’Œç”¨æˆ·ä½“éªŒã€‚ç°åœ¨å„æ¡†æ¶å†…ç½®çš„å‹ç¼©ã€å¸è½½ã€æ‘˜è¦ç­‰ç­–ç•¥ï¼Œå·²ç»èƒ½è§£å†³ 80-90% çš„é€šç”¨åœºæ™¯é—®é¢˜ï¼Œä½†å¯¹äºç‰¹å®šè¡Œä¸šæˆ–åœºæ™¯ï¼Œæ¯”å¦‚åŒ»ç–—ã€æ³•å¾‹ã€é‡‘èç­‰é¢†åŸŸï¼ŒåŸºäºé€šç”¨çš„ä¸Šä¸‹æ–‡å¤„ç†ç­–ç•¥åŸºç¡€ä¹‹ä¸Šè¿›è¡Œé’ˆå¯¹æ€§çš„å¤„ç†å’Œæ›´ç²¾ç»†çš„å‹ç¼© prompt è®¾è®¡ï¼Œä»ç„¶æœ‰è¾ƒå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚è€Œé•¿æœŸè®°å¿†ä½œä¸ºå¯ç‹¬ç«‹æ¼”è¿›çš„ç»„ä»¶ï¼Œæœªæ¥ä¼šæ›´åŠ è´´è¿‘äººè„‘çš„è®°å¿†æ¼”åŒ–æ¨¡å¼ï¼ŒåŒ…æ‹¬è®°å¿†çš„å·©å›ºã€å¼ºåŒ–ã€é—å¿˜ç­‰å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒæ—¶é•¿æœŸè®°å¿†åº”è¯¥ä»¥äº‘æœåŠ¡æ¨¡å¼æä¾›é€šç”¨çš„è®°å¿†æœåŠ¡ï¼Œå…±åŒåŠ©åŠ› Agent è¿ˆå‘æ›´é«˜é˜¶çš„æ™ºèƒ½ã€‚</p>
<p><strong>ç›¸å…³é˜…è¯»ï¼š</strong></p>
<p>ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUzNzYxNjAzMg%3D%3D%26mid%3D2247580979%26idx%3D1%26sn%3Db55ba91471d7bda26b70d7ef32b9144a%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUzNzYxNjAzMg==&amp;mid=2247580979&amp;idx=1&amp;sn=b55ba91471d7bda26b70d7ef32b9144a&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AgentScope Java ç­”ç–‘æ—¶é—´ï¼šå¼€å‘è€…è¿‘æœŸæœ€å…³å¿ƒçš„ 12 ä¸ªé—®é¢˜</a>ã€‹</p>
<p>ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUzNzYxNjAzMg%3D%3D%26mid%3D2247580755%26idx%3D1%26sn%3D870d3de4e1a8e36796532cd18d8ab6e7%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUzNzYxNjAzMg==&amp;mid=2247580755&amp;idx=1&amp;sn=870d3de4e1a8e36796532cd18d8ab6e7&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AgentScope x RocketMQï¼šæ‰“é€ ä¼ä¸šçº§é«˜å¯é  A2A æ™ºèƒ½ä½“é€šä¿¡åŸºåº§</a>ã€‹</p>
<p>ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUzNzYxNjAzMg%3D%3D%26mid%3D2247580582%26idx%3D2%26sn%3De3e66277ddaedc5f7caa9cd1ae12cd5d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUzNzYxNjAzMg==&amp;mid=2247580582&amp;idx=2&amp;sn=e3e66277ddaedc5f7caa9cd1ae12cd5d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AgentScope Java v1.0 å‘å¸ƒï¼Œè®© Java å¼€å‘è€…è½»æ¾æ„å»ºä¼ä¸šçº§ Agentic åº”ç”¨</a>ã€‹</p>
<p><strong>å‚è€ƒæ–‡æ¡£ï¼š</strong></p>
<p>[1] FlowLLM Context Engineering</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFlowLLM-AI%2Fflowllm%2Ftree%2Fmain%2Fdocs%2Fzh%2Freading" target="_blank" title="https://github.com/FlowLLM-AI/flowllm/tree/main/docs/zh/reading" ref="nofollow noopener noreferrer">github.com/FlowLLM-AI/â€¦</a></p>
<p>[2] Google ADK Memory</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgoogle.github.io%2Fadk-docs%2Fsessions%2Fmemory%2F" target="_blank" title="https://google.github.io/adk-docs/sessions/memory/" ref="nofollow noopener noreferrer">google.github.io/adk-docs/seâ€¦</a></p>
<p>[3] LangChain Memory</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flangchain%2Flong-term-memory" target="_blank" title="https://docs.langchain.com/oss/python/langchain/long-term-memory" ref="nofollow noopener noreferrer">docs.langchain.com/oss/python/â€¦</a></p>
<p>[4] AgentScope Memory</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.agentscope.io%2Fzh_CN%2Ftutorial%2Ftask_memory.html" target="_blank" title="https://doc.agentscope.io/zh_CN/tutorial/task_memory.html" ref="nofollow noopener noreferrer">doc.agentscope.io/zh_CN/tutorâ€¦</a></p>
<p>[5] O-MEM</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2511.13593" target="_blank" title="https://arxiv.org/abs/2511.13593" ref="nofollow noopener noreferrer">arxiv.org/abs/2511.13â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.jsç¬¬åå…«ç« (é™æ€å¯¼å‡ºSSG)]]></title>    <link>https://juejin.cn/post/7589052659435470894</link>    <guid>https://juejin.cn/post/7589052659435470894</guid>    <pubDate>2025-12-29T08:58:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589052659435470894" data-draft-id="7589093895326171145" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.jsç¬¬åå…«ç« (é™æ€å¯¼å‡ºSSG)"/> <meta itemprop="keywords" content="å‰ç«¯,Next.js"/> <meta itemprop="datePublished" content="2025-12-29T08:58:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ»¡zs"/> <meta itemprop="url" content="https://juejin.cn/user/2463384809252397"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.jsç¬¬åå…«ç« (é™æ€å¯¼å‡ºSSG)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2463384809252397/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ»¡zs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T08:58:36.000Z" title="Mon Dec 29 2025 08:58:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é™æ€å¯¼å‡ºSSG</h2>
<p>Next.js æ”¯æŒé™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼ŒStatic Site Generationï¼‰ï¼Œå¯ä»¥åœ¨æ„å»ºæ—¶é¢„å…ˆç”Ÿæˆæ‰€æœ‰é¡µé¢çš„é™æ€ HTML æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼ç‰¹åˆ«é€‚åˆå†…å®¹ç›¸å¯¹å›ºå®šçš„ç«™ç‚¹ï¼Œå¦‚<strong>å®˜ç½‘</strong>ã€<strong>åšå®¢</strong>ã€<strong>æ–‡æ¡£</strong>ç­‰ï¼Œèƒ½å¤Ÿæä¾›æœ€ä½³çš„æ€§èƒ½å’Œ SEO è¡¨ç°ã€‚</p>
<h4 data-id="heading-1">é…ç½®é™æ€å¯¼å‡º</h4>
<p>éœ€è¦åœ¨<code>next.config.js</code>æ–‡ä»¶ä¸­é…ç½®<code>output</code>ä¸º<code>export</code>ï¼Œè¡¨ç¤ºå¯¼å‡ºé™æ€ç«™ç‚¹ã€‚<code>distDir</code>è¡¨ç¤ºå¯¼å‡ºç›®å½•ï¼Œé»˜è®¤ä¸º<code>out</code>ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* config options here */</span>
  <span class="hljs-attr">output</span>: <span class="hljs-string">"export"</span>, <span class="hljs-comment">// å¯¼å‡ºé™æ€ç«™ç‚¹</span>
  <span class="hljs-attr">distDir</span>: <span class="hljs-string">"dist"</span>, <span class="hljs-comment">// å¯¼å‡ºç›®å½•</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<p>æ¥ç€æˆ‘ä»¬æ‰§è¡Œ<code>npm run build</code>å‘½ä»¤ï¼Œæ„å»ºé™æ€ç«™ç‚¹ã€‚</p>
<p>æ„å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å®‰è£…<code>http-server</code>æ¥å¯åŠ¨é™æ€ç«™ç‚¹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install http-server -g <span class="hljs-comment">#å®‰è£…http-server</span>
<span class="hljs-built_in">cd</span> dist <span class="hljs-comment">#è¿›å…¥å¯¼å‡ºç›®å½•</span>
http-server -p 3000 <span class="hljs-comment">#å¯åŠ¨é™æ€ç«™ç‚¹</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b703b5726b84a37881b7c4754200f00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=D%2Bd4FxfMN12Y%2Fl%2FxoEC3hMRbPtE%3D" alt="11.gif" loading="lazy"/></p>
<p>å¯åŠ¨å®Œæˆä¹‹åå‘ç°ç‚¹å‡»<code>a</code>æ ‡ç­¾æ— æ³•è¿›è¡Œè·³è½¬ï¼Œæ˜¯å› ä¸ºæ‰“å®ŒåŒ…ä¹‹åçš„é¡µé¢å«<code>about.html</code>,è€Œæˆ‘ä»¬çš„è·³è½¬é“¾æ¥æ˜¯<code>/about</code>ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹é…ç½®é¡¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8950c8f911f4dca8674bc8137f17885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=HqCk7GEmWCJBnna0gyZfIipRMnU%3D" alt="build.png" loading="lazy"/></p>
<h4 data-id="heading-2">ä¿®æ”¹é…ç½®é¡¹</h4>
<p>éœ€è¦åœ¨<code>next.config.js</code>æ–‡ä»¶ä¸­é…ç½®<code>trailingSlash</code>ä¸º<code>true</code>ï¼Œè¡¨ç¤ºæ·»åŠ å°¾éƒ¨æ–œæ ï¼Œç”Ÿæˆ<code>/about/index.html</code>è€Œä¸æ˜¯<code>/about.html</code>ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* config options here */</span>
  <span class="hljs-attr">output</span>: <span class="hljs-string">"export"</span>, <span class="hljs-comment">// å¯¼å‡ºé™æ€ç«™ç‚¹</span>
  <span class="hljs-attr">distDir</span>: <span class="hljs-string">"dist"</span>, <span class="hljs-comment">// å¯¼å‡ºç›®å½•</span>
  <span class="hljs-attr">trailingSlash</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ·»åŠ å°¾éƒ¨æ–œæ ï¼Œç”Ÿæˆ /about/index.html è€Œä¸æ˜¯ /about.html</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/289cb3708804421b919d81bdee068f24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=ypCUPWf8v4tp5SHLmX%2FdjIep16E%3D" alt="trailingSlash.png" loading="lazy"/></p>
<p>æ­¤æ—¶é‡æ–°ç‚¹å‡»<code>a</code>æ ‡ç­¾å°±å¯ä»¥è¿›è¡Œè·³è½¬äº†ã€‚</p>
<h4 data-id="heading-3">åŠ¨æ€è·¯ç”±å¤„ç†</h4>
<p>æ–°å»ºç›®å½•: <code>src/app/posts/[id]/page.tsx</code></p>
<p>å¦‚æœè¦ä½¿ç”¨åŠ¨æ€è·¯ç”±ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>generateStaticParams</code>å‡½æ•°æ¥ç”Ÿæˆæœ‰å¤šå°‘ä¸ªåŠ¨æ€è·¯ç”±ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«æ‰€æœ‰åŠ¨æ€è·¯ç”±çš„å‚æ•°ï¼Œä¾‹å¦‚<code>{ id: '1' }</code>è¡¨ç¤ºå¯¹åº”idä¸º1çš„è¯¦æƒ…é¡µã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateStaticParams</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">//æ”¯æŒè°ƒç”¨æ¥å£è¯·æ±‚è¯¦æƒ…idåˆ—è¡¨ const res = await fetch('https://api.example.com/posts')</span>
    <span class="hljs-keyword">return</span> [
        { <span class="hljs-attr">id</span>: <span class="hljs-string">'1'</span> }, <span class="hljs-comment">//è¿”å›å¯¹åº”çš„è¯¦æƒ…id</span>
        { <span class="hljs-attr">id</span>: <span class="hljs-string">'2'</span> },
    ]
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Post</span>(<span class="hljs-params">{ params }: { params: <span class="hljs-built_in">Promise</span>&lt;{ id: <span class="hljs-built_in">string</span> }&gt; }</span>) {
    <span class="hljs-keyword">const</span> { id } = <span class="hljs-keyword">await</span> params
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Post {id}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h4 data-id="heading-4">å›¾ç‰‡ä¼˜åŒ–</h4>
<p>å¦‚æœä½¿ç”¨<code>Image</code>ç»„ä»¶ä¼˜åŒ–å›¾ç‰‡ï¼Œåœ¨å¼€å‘æ¨¡å¼ä¼šè¿›è¡ŒæŠ¥é”™</p>
<div class="custom-block warning">
  <div class="custom-block-title">âš ï¸ è­¦å‘Š</div>
  <p>
    <code>get-img-props.ts 442 Uncaught Error</code>: Image Optimization using the default loader is not compatible with <code>{ output: 'export' }</code>.
  </p>
  <p>å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š</p>
  <ul>
    <li>ç§»é™¤ <code>{ output: 'export' }</code> å¹¶è¿è¡Œ "next start" ä»¥å¯ç”¨åŒ…å«å›¾ç‰‡ä¼˜åŒ– API çš„æœåŠ¡å™¨æ¨¡å¼ã€‚</li>
    <li>åœ¨ <code>next.config.js</code> ä¸­é…ç½® <code>{ images: { unoptimized: true } }</code> æ¥ç¦ç”¨å›¾ç‰‡ä¼˜åŒ– APIã€‚</li>
    <li>ä½¿ç”¨è‡ªå®šä¹‰loaderå®ç°</li>
  </ul>
  <p>äº†è§£æ›´å¤šï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fmessages%2Fexport-image-api" target="_blank" title="https://nextjs.org/docs/messages/export-image-api" ref="nofollow noopener noreferrer">nextjs.org/docs/messagâ€¦</a></p>
</div>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Image</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"next/image"</span>
<span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'@/public/1.png'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">About</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>  <span class="hljs-attr">loading</span>=<span class="hljs-string">"eager"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{test}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"logo"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{250</span> * <span class="hljs-attr">3</span>} <span class="hljs-attr">height</span>=<span class="hljs-string">{131</span> * <span class="hljs-attr">3</span>} /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰<code>loader</code>æ¥å®ç°å›¾ç‰‡ä¼˜åŒ–,è¦æ±‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå›¾åºŠæ‰˜ç®¡å›¾ç‰‡ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fimgchr.com%2F" target="_blank" title="https://imgchr.com/" ref="nofollow noopener noreferrer">è·¯è¿‡å›¾åºŠ</a> æ˜¯ä¸€ä¸ªå…è´¹çš„å›¾åºŠï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥æ‰˜ç®¡å›¾ç‰‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b5602ac674646ee8203caae01041319~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=X%2Fro3qp3jTDaoIWzgHnYuW1TJ%2FM%3D" alt="luguo.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5ce1f7ac5324f959c99e017af382244~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=ZKgkNO1TPJR3tqA5I%2FfqtZwOZ9k%3D" alt="url.png" loading="lazy"/></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* config options here */</span>
  <span class="hljs-attr">output</span>: <span class="hljs-string">"export"</span>, <span class="hljs-comment">// å¯¼å‡ºé™æ€ç«™ç‚¹</span>
  <span class="hljs-attr">distDir</span>: <span class="hljs-string">"dist"</span>, <span class="hljs-comment">// å¯¼å‡ºç›®å½•</span>
  <span class="hljs-attr">trailingSlash</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ·»åŠ å°¾éƒ¨æ–œæ ï¼Œç”Ÿæˆ /about/index.html è€Œä¸æ˜¯ /about.html</span>
  <span class="hljs-attr">images</span>: {
    <span class="hljs-attr">loader</span>: <span class="hljs-string">'custom'</span>, <span class="hljs-comment">// è‡ªå®šä¹‰loader</span>
    <span class="hljs-attr">loaderFile</span>: <span class="hljs-string">'./image-loader.ts'</span>, <span class="hljs-comment">// è‡ªå®šä¹‰loaderæ–‡ä»¶</span>
  },
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<p>æ ¹ç›®å½•ï¼š<code>/image-loader.ts</code></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">imageLoader</span>(<span class="hljs-params">{ src, width, quality }: { src: <span class="hljs-built_in">string</span>, width: <span class="hljs-built_in">number</span>, quality: <span class="hljs-built_in">number</span> }</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`https://s41.ax1x.com<span class="hljs-subst">${src}</span>`</span>
}
</code></pre>
<p>src/app/about/page.tsx</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Image</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"next/image"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">About</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">"eager"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'/2025/12/29/pZYbW7t.jpg'</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"logo"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{250</span> * <span class="hljs-attr">3</span>} <span class="hljs-attr">height</span>=<span class="hljs-string">{131</span> * <span class="hljs-attr">3</span>} /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00fdd5d93b1b45d79ef3825c05b5a01d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767603516&amp;x-signature=isQ2iPfESEHqXjmhFJBkMpIRx64%3D" alt="img.png" loading="lazy"/></p>
<h4 data-id="heading-5">æ³¨æ„äº‹é¡¹</h4>
<p>ä»¥ä¸‹åŠŸèƒ½åœ¨SSGä¸­ä¸æ”¯æŒï¼Œè¯·å‹¿ä½¿ç”¨ï¼š</p>
<ul>
<li>Dynamic Routes with dynamicParams: true</li>
<li>åŠ¨æ€è·¯ç”±æ²¡æœ‰ä½¿ç”¨generateStaticParams()</li>
<li>è·¯ç”±å¤„ç†å™¨ä¾èµ–äºRequest</li>
<li>Cookies</li>
<li>Rewritesé‡å†™</li>
<li>Redirectsé‡å®šå‘</li>
<li>Headerså¤´</li>
<li>Proxyä»£ç†</li>
<li>Incremental Static Regenerationå¢é‡é™æ€å†ç”Ÿ</li>
<li>Image Optimization with the default loaderé»˜è®¤åŠ è½½å™¨çš„å›¾åƒä¼˜åŒ–</li>
<li>Draft Modeè‰ç¨¿æ¨¡å¼</li>
<li>Server ActionsæœåŠ¡å™¨æ“ä½œ</li>
<li>Intercepting Routesæ‹¦æˆªè·¯ç”±</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Luckysheet è¿œç¨‹æœç´¢ä¸‹æ‹‰ æ§ä»¶å¼€å‘ : æ­ç§˜äºŒå¼€å…¨æµç¨‹]]></title>    <link>https://juejin.cn/post/7589126920286289930</link>    <guid>https://juejin.cn/post/7589126920286289930</guid>    <pubDate>2025-12-29T12:47:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589126920286289930" data-draft-id="7589093895327023113" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Luckysheet  è¿œç¨‹æœç´¢ä¸‹æ‹‰ æ§ä»¶å¼€å‘ : æ­ç§˜äºŒå¼€å…¨æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-29T12:47:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ´shu"/> <meta itemprop="url" content="https://juejin.cn/user/3866303125264135"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Luckysheet  è¿œç¨‹æœç´¢ä¸‹æ‹‰ æ§ä»¶å¼€å‘ : æ­ç§˜äºŒå¼€å…¨æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3866303125264135/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ´shu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T12:47:46.000Z" title="Mon Dec 29 2025 12:47:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è¿œç¨‹æœç´¢ä¸‹æ‹‰æ§ä»¶æ˜¯éå¸¸å¸¸è§çš„æ§ä»¶ï¼Œåº”ç”¨åœ¨è¡¨å•å¡«å†™åœºæ™¯ä¸‹ï¼Œä¹Ÿæ˜¯éå¸¸åˆé€‚çš„ï¼Œæœ¬ä¾‹å°†å¸¦é¢†å¤§å®¶å®ç°ä»¥ä¸‹æ•ˆæœï¼Œå¹¶çœŸå®äº†è§£å¹¶ç†Ÿæ‚‰ luckysheet çš„äºŒå¼€æµç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fa9e707052b4260aa2b992a2395a52d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py0c2h1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767617266&amp;x-signature=Cjkf12XL8qDoAEnlzDnp11Lkez8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">æ‹“å±•å•å…ƒæ ¼å±æ€§</h2>
<p>åœ¨å®˜ç½‘ä¸Šï¼Œæœ‰ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œæ—¢ç„¶å·²çŸ¥æ‰¹æ³¨æ˜¯ç›´æ¥åŠ åˆ°å•å…ƒæ ¼å±æ€§ä¸Šï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬æ‹“å±•å±æ€§ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å‚è€ƒæ‰¹æ³¨çš„å®ç°æ–¹æ¡ˆï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22fd9b12c2c6470fb53fbfb6a0b8ffcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py0c2h1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767617266&amp;x-signature=1YQxfHygfcHNaEUdhyY4ILqUvJE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
æˆ‘ä»¬è®¾å®šä»¥ä¸‹æ˜¯è¿œç¨‹æœç´¢ä¸‹æ‹‰çš„å•å…ƒæ ¼æ‹“å±•å±æ€§ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ‰©å±•åçš„å•å…ƒæ ¼å¯¹è±¡</span>
<span class="hljs-keyword">const</span> cell = {
    <span class="hljs-attr">v</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// åŸå§‹å€¼</span>
    <span class="hljs-attr">m</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// æ˜¾ç¤ºå€¼</span>
    <span class="hljs-attr">ct</span>: { <span class="hljs-attr">fa</span>: <span class="hljs-string">"General"</span>, <span class="hljs-attr">t</span>: <span class="hljs-string">"s"</span> },
    <span class="hljs-comment">// ... other properties</span>

    <span class="hljs-comment">// æ–°å¢è¿œç¨‹æœç´¢ä¸‹æ‹‰é…ç½®</span>
    <span class="hljs-attr">remoteSelect</span>: {
        <span class="hljs-comment">// æ˜¯å¦å¯ç”¨è¿œç¨‹æœç´¢ï¼Œ[å¿…ä¼ ]</span>
        <span class="hljs-attr">enable</span>: <span class="hljs-built_in">boolean</span>,

        <span class="hljs-comment">// ç”¨æˆ·è¾“å…¥æ—¶çš„å›è°ƒå‡½æ•°ï¼Œç”¨äºè·å–è¿œç¨‹æ•°æ®</span>
        <span class="hljs-title function_">onInput</span>(value): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;&gt; {
            <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œresolveä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ ä¸ºä¸‹æ‹‰é€‰é¡¹å¯¹è±¡</span>
        }

        <span class="hljs-comment">// ç”¨æˆ·é€‰å®šæŸä¸ªé€‰é¡¹åçš„å›è°ƒå‡½æ•°</span>
        <span class="hljs-title function_">onSelect</span>(item): <span class="hljs-built_in">void</span> {
            <span class="hljs-comment">// item ä¸ºç”¨æˆ·é€‰å®šçš„é€‰é¡¹å¯¹è±¡ï¼Œå€¼æ˜¯onInputå‡½æ•°è¿”å›çš„æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ </span>
        }

        <span class="hljs-comment">// æ˜¯å¦éœ€è¦è®¾å®šå½“å‰è¾“å…¥å•å…ƒæ ¼çš„å€¼ [å¯é€‰]</span>
        <span class="hljs-title function_">setValue</span>(item): <span class="hljs-built_in">string</span>{
           <span class="hljs-comment">// item ä¸ºç”¨æˆ·é€‰å®šçš„é€‰é¡¹å¯¹è±¡ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºè®¾å®šå•å…ƒæ ¼çš„å€¼</span>
        },

        <span class="hljs-comment">// è‡ªå®šä¹‰ç±»å  [å¯é€‰]</span>
        <span class="hljs-attr">popperClass</span>: <span class="hljs-built_in">string</span>,
    },
};
</code></pre>
<h2 data-id="heading-2">ä½•æ—¶è§¦å‘ï¼Ÿ</h2>
<p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦<code>åœ¨ç”¨æˆ·è¾“å…¥å€¼æ—¶ï¼Œè¿›è¡Œè¿œç¨‹æ•°æ®è·å–ï¼Œæ¸²æŸ“åˆ—è¡¨</code>ï¼Œå› æ­¤ï¼Œéœ€è¦åœ¨ç”¨æˆ·è¿›è¡Œç¼–è¾‘æ—¶ï¼Œè¿›è¡Œå¤„ç†ï¼š</p>
<ol>
<li>ä¸€ä¸ªæ–¹æ¡ˆï¼Œæ˜¯åœ¨åˆå§‹åŒ– inputHTML æ—¶ï¼Œå°†ç›¸å…³äº‹ä»¶å¤„ç†ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/755689351f904e30a11d579d9ff5a471~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py0c2h1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767617266&amp;x-signature=%2FKJ62ts%2BnUnkohBygCBG2drzPuQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ol>
<pre><code class="hljs language-js" lang="js"> $(<span class="hljs-string">"body"</span>).<span class="hljs-title function_">append</span>(inputHTML)
 <span class="hljs-comment">// è¿›è¡Œç›¸å…³äº‹ä»¶ç»‘å®š: [ä¼ªä»£ç ]</span>
 $input.<span class="hljs-title function_">on</span>(<span class="hljs-string">'input'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
 	<span class="hljs-comment">// è¿™é‡Œæ˜¯æœªçŸ¥å…·ä½“å•å…ƒæ ¼ä¿¡æ¯çš„ï¼Œéœ€è¦é€šè¿‡å¤–éƒ¨ä¼ é€’</span>
 	<span class="hljs-keyword">const</span> remoteSelectOptions = <span class="hljs-title class_">Store</span>.<span class="hljs-property">flowdata</span>[r][c]
 	<span class="hljs-comment">// æ‰§è¡Œåç»­æ“ä½œ</span>
 })
</code></pre>
<ol start="2">
<li>å¦ä¸€ä¸ªæ–¹æ¡ˆï¼Œæ˜¯ç”¨æˆ·åŒå‡»æ—¶ï¼Œå”¤èµ·è¾“å…¥æ¡†åï¼Œè¿›è¡Œåˆ¤æ–­ï¼š</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// handler.js</span>
$(<span class="hljs-string">"#luckysheet-cell-main, #luckysheetTableContent"</span>).<span class="hljs-title function_">dblclick</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
	<span class="hljs-comment">// è¿™ä¸ªå‡½æ•°æ˜¯å†…ç½®çš„å“ˆï¼Œå› æ­¤ï¼Œå¯ä»¥ç›´æ¥è·å–åˆ° r c</span>
	<span class="hljs-comment">// åˆ¤æ–­å½“å‰å•å…ƒæ ¼æ˜¯å¦éœ€è¦åˆå§‹åŒ–è¿œç¨‹æœç´¢æ§ä»¶</span>
	<span class="hljs-title class_">RemoteSelect</span>.<span class="hljs-title function_">checkCellNeedRemoteSelect</span>(row_index, col_index)
})
</code></pre>
<p>ä¸¤ç§æ–¹æ¡ˆæˆ‘éƒ½è¯•è¿‡äº†ï¼Œ<code>å®ç°ç•¥æœ‰ä¸åŒ</code>ï¼Œä½†éƒ½å¯ä»¥å®ç°ï¼Œè¿˜æ˜¯å€ŸåŠ©åŸç”Ÿçš„ dblclick å¥½å¤„ç†äº›ã€‚</p>
<h2 data-id="heading-3">æ ¡éªŒè¿œç¨‹æœç´¢ä¸‹æ‹‰</h2>
<p>æ—¢ç„¶æ¯ä¸€ä¸ªå•å…ƒæ ¼åŒå‡»ï¼Œéƒ½ä¼šè§¦å‘è¿™ä¸ªæ ¡éªŒï¼Œé‚£ä¹ˆä½•æ—¶æ‰éœ€è¦åˆå§‹åŒ–è¿™ä¸ªä¸‹æ‹‰æ¡†å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åˆ¤æ–­å½“å‰å•å…ƒæ ¼æ˜¯å¦éœ€è¦æ˜¾ç¤ºä¸‹æ‹‰æ¡†</span>
<span class="hljs-attr">checkCellNeedRemoteSelect</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">r, c</span>) {
    <span class="hljs-comment">// é€šè¿‡ r c è·å–å•å…ƒæ ¼ä¿¡æ¯</span>
    <span class="hljs-keyword">let</span> cell = <span class="hljs-title class_">Store</span>.<span class="hljs-property">flowdata</span>[r][c];

    <span class="hljs-comment">// å¦‚æœ cell æ²¡æœ‰é…ç½® remoteSelect æˆ–è€… remoteSelect.enable ä¸º false åˆ™è¿”å›</span>
    <span class="hljs-keyword">if</span> (!cell || !cell.<span class="hljs-property">remoteSelect</span> || !cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-property">enable</span>) {
        <span class="hljs-keyword">return</span>;
    }
}
</code></pre>
<p>æ£€éªŒå®Œæˆåï¼Œå¦‚æœéœ€è¦åˆå§‹åŒ–æ ¡éªŒï¼Œåˆ«å¿˜äº†ï¼Œ æˆ‘ä»¬åº•å±‚è¿˜è¦ç›‘å¬è¾“å…¥æ¡†äº‹ä»¶å“ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¸ç„¶ï¼Œå¼€å§‹ç›‘å¬ input è¾“å…¥äº‹ä»¶</span>
$(<span class="hljs-string">"#luckysheet-input-box .luckysheet-cell-input"</span>).<span class="hljs-title function_">off</span>(<span class="hljs-string">"input"</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">"input"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">let</span> value = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>().<span class="hljs-title function_">trim</span>(); <span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥çš„å€¼</span>
      
        <span class="hljs-keyword">if</span> (cell.<span class="hljs-property">remoteSelect</span> &amp;&amp; cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-property">onInput</span> &amp;&amp; <span class="hljs-keyword">typeof</span> cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-property">onInput</span> == <span class="hljs-string">"function"</span>) {
            <span class="hljs-comment">// è°ƒç”¨å¤–éƒ¨æ¥å£</span>
            cell.<span class="hljs-property">remoteSelect</span>
                .<span class="hljs-title function_">onInput</span>(value)
                .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">dataList</span>) {
                    $this.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
                    $this.<span class="hljs-title function_">showRemoteSelect</span>(dataList);
                })
                .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
                    $this.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
                    $this.<span class="hljs-title function_">hideRemoteSelect</span>();
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è¯·æ±‚æ¥å£é”™è¯¯"</span>, error);
                    tooltip.<span class="hljs-title function_">info</span>(<span class="hljs-string">'&lt;i class="fa fa-exclamation-triangle"&gt;&lt;/i&gt;'</span>, <span class="hljs-string">"æ¥å£è¯·æ±‚å¤±è´¥"</span>);
                });
        }
    });
</code></pre>
<h2 data-id="heading-4">åˆå§‹åŒ–ä¸‹æ‹‰æ¡†</h2>
<p>è¿œç¨‹æœç´¢çš„æ ¸å¿ƒï¼Œå°±æ˜¯ä¸‹æ‹‰é€‰é¡¹ï¼Œå½“è¿œç¨‹æ¥å£åˆå§‹åŒ–å®Œæˆåï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">dataList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
	<span class="hljs-keyword">const</span> $item = $(<span class="hljs-string">`&lt;div class="<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.selectItemClass}</span>"&gt;`</span>)
		.<span class="hljs-title function_">text</span>(item)
		.<span class="hljs-title function_">click</span>(<span class="hljs-function">() =&gt;</span> {
			<span class="hljs-comment">// è§¦å‘é€‰æ‹©å›è°ƒ</span>
			<span class="hljs-keyword">if</span> (cell.<span class="hljs-property">remoteSelect</span> &amp;&amp; cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-property">onSelect</span> &amp;&amp; <span class="hljs-keyword">typeof</span> cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-property">onSelect</span> === <span class="hljs-string">"function"</span>) {
    		cell.<span class="hljs-property">remoteSelect</span>.<span class="hljs-title function_">onSelect</span>(item);
			}
		})
</code></pre>
<p>è¿™é‡Œå°±ä¸€ä¸ªéš¾ç‚¹è¦å¤„ç†ï¼Œå¦‚ä½•å°†ä¸‹æ‹‰æ¡†å®šä½åˆ°è¾“å…¥æ¡†çš„ä½ç½®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è¿™é‡Œé‡‡ç”¨å·§æ–¹æ¡ˆï¼Œç›´æ¥å–è¾“å…¥æ¡†çš„ä½ç½®</span>
<span class="hljs-keyword">const</span> $input = $(<span class="hljs-string">"#luckysheet-input-box"</span>);
<span class="hljs-keyword">const</span> left = <span class="hljs-built_in">parseInt</span>($input.<span class="hljs-title function_">css</span>(<span class="hljs-string">"left"</span>)) || <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> top = <span class="hljs-built_in">parseInt</span>($input.<span class="hljs-title function_">css</span>(<span class="hljs-string">"top"</span>)) || <span class="hljs-number">0</span>;

<span class="hljs-comment">// è·å–å½“å‰å•å…ƒæ ¼çš„é«˜åº¦ è¡Œé«˜</span>
<span class="hljs-keyword">const</span> [_row_pre, rowHeight] = <span class="hljs-title function_">rowLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">r</span>);

<span class="hljs-comment">// è®¾ç½®ä¸‹æ‹‰æ¡†ä½ç½®å’Œå®½åº¦</span>
$selectBox.<span class="hljs-title function_">css</span>({
    <span class="hljs-attr">top</span>: <span class="hljs-string">`<span class="hljs-subst">${top + rowHeight + <span class="hljs-number">4</span>}</span>px`</span>, <span class="hljs-comment">// åœ¨å•å…ƒæ ¼ä¸‹æ–¹æ˜¾ç¤º</span>
    <span class="hljs-attr">left</span>: <span class="hljs-string">`<span class="hljs-subst">${left}</span>px`</span>,
});
</code></pre>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>è™½ç„¶ä»£ç çœ‹èµ·æ¥ä¸å¤æ‚ï¼Œä½†æ˜¯äº†è§£luckysheet çš„æºç ã€å®ç°æ€è·¯ï¼Œä»¥åŠå•å…ƒæ ¼æ‹“å±•å®ç°æ–¹æ¡ˆæ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>é€šè¿‡æœ¬æ¬¡å®ç°ï¼Œæˆ‘ä»¬åˆæ­¥äº†è§£äº†luckysheetçš„äºŒæ¬¡å¼€å‘æµç¨‹ï¼Œåœ¨ä¸ç ´ååŸæœ‰åŠŸèƒ½çš„åŸºç¡€ä¸Šæ·»åŠ æ–°ç‰¹æ€§ã€‚è¿œç¨‹æœç´¢ä¸‹æ‹‰æ§ä»¶çš„å®ç°å±•ç¤ºäº†å¦‚ä½•åœ¨ç°æœ‰è¡¨æ ¼ç»„ä»¶åŸºç¡€ä¸Šï¼Œé€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’Œä»£ç ç»„ç»‡ï¼Œæ·»åŠ å¤æ‚äº¤äº’åŠŸèƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¿å‘æŒ‡å—ï¼åˆ«å†è¢«N8Nå¾ªç¯èŠ‚ç‚¹â€œè°ƒæˆâ€äº†ï¼ä¸ºä»€ä¹ˆä½ çš„Doneåˆ†æ”¯æ‰§è¡Œäº†å¤šæ¬¡ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7589074117644238883</link>    <guid>https://juejin.cn/post/7589074117644238883</guid>    <pubDate>2025-12-29T09:21:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589074117644238883" data-draft-id="7588996730773192704" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" é¿å‘æŒ‡å—ï¼åˆ«å†è¢«N8Nå¾ªç¯èŠ‚ç‚¹â€œè°ƒæˆâ€äº†ï¼ä¸ºä»€ä¹ˆä½ çš„Doneåˆ†æ”¯æ‰§è¡Œäº†å¤šæ¬¡ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-29T09:21:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaä¸­æ–‡ç¤¾ç¾¤"/> <meta itemprop="url" content="https://juejin.cn/user/61228381386487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             é¿å‘æŒ‡å—ï¼åˆ«å†è¢«N8Nå¾ªç¯èŠ‚ç‚¹â€œè°ƒæˆâ€äº†ï¼ä¸ºä»€ä¹ˆä½ çš„Doneåˆ†æ”¯æ‰§è¡Œäº†å¤šæ¬¡ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/61228381386487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaä¸­æ–‡ç¤¾ç¾¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T09:21:09.000Z" title="Mon Dec 29 2025 09:21:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶åœ¨ä½¿ç”¨ n8n çš„å¾ªç¯èŠ‚ç‚¹ï¼ˆLoop Over Itemsï¼‰æ—¶ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§è®©äººæŠ“ç‹‚çš„æƒ…å†µï¼š</p>
<p>æ˜æ˜å®˜æ–¹æ–‡æ¡£è¯´ <code>loop</code> åˆ†æ”¯æ˜¯å¾ªç¯æ‰§è¡Œï¼Œè€Œ <code>done</code> åˆ†æ”¯æ˜¯åœ¨å¾ªç¯ç»“æŸååªæ‰§è¡Œä¸€æ¬¡ã€‚ç»“æœä½ è‡ªå·±ä¸€ä¸Šæ‰‹ï¼šå¥½å®¶ä¼™ï¼Œ<code>loop</code> è·‘äº† 3 æ¬¡ï¼Œ<code>done</code> åé¢æ¥çš„èŠ‚ç‚¹å±…ç„¶ä¹Ÿè·Ÿç€è·‘äº† 3 æ¬¡ï¼ğŸ¤¯ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/394b49df0671490eb6ef8e297a3c1b76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=HUcvPBGw8EaWlxuD4ePn1tP10JI%3D" alt="" loading="lazy"/></p>
<p><strong>éš¾é“æ˜¯å®˜æ–¹æ–‡æ¡£åœ¨å¿½æ‚ äººï¼Ÿè¿˜æ˜¯å’±ç”¨çš„ç‰ˆæœ¬ä¸å¯¹ï¼Ÿ</strong></p>
<p>ä»Šå¤©ï¼Œç£Šå“¥å°±å¸¦å¤§å®¶æ‰’ä¸€æ‰’ n8n åŸºç¡€èŠ‚ç‚¹é‡Œæœ€éš¾ç†è§£çš„â€”â€”å¾ªç¯èŠ‚ç‚¹ã€‚å…¨ç½‘æ²¡äººèƒ½è®²æ¸…çš„èƒŒåçš„é€»è¾‘ï¼Œå’±ä¸€æ¬¡æ€§è¯´æ˜ç™½ï¼</p>
<hr/>
<h2 data-id="heading-0">ğŸ¥ è§†é¢‘æ•™ç¨‹æ¼”ç¤º</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1odBCB7E6p%2F" target="_blank" title="https://www.bilibili.com/video/BV1odBCB7E6p/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1odâ€¦</a></p>
<hr/>
<h2 data-id="heading-1">ğŸ” 1. ç°åœºè¿˜åŸï¼šæ¶ˆå¤±çš„â€œä¸€æ¬¡æ‰§è¡Œâ€</h2>
<p>å’±ä»¬å…ˆçœ‹ä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹ã€‚</p>
<p>åœ¨å·¥ä½œæµé‡Œï¼Œæˆ‘ç”¨ä»£ç èŠ‚ç‚¹ï¼ˆCode Nodeï¼‰è¾“å‡ºäº†ä¸‰é¡¹å†…å®¹ï¼šå¼ ä¸‰ã€æå››ã€ç‹äº”ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1cbf06433c546299fc165f627c42b67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=GM2lJf4iXWsGHVBtx5JOgV%2Fx3jo%3D" alt="" loading="lazy"/></p>
<p>æŒ‰é€»è¾‘ï¼Œæ¥ä¸‹æ¥çš„å¾ªç¯èŠ‚ç‚¹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a41fe085f1d4ef49da0bdd4d093278a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=yCdpvLtmcXZ9Bs79L95Wfzi8h7o%3D" alt="" loading="lazy"/></p>
<ol>
<li><strong>loop åˆ†æ”¯</strong>ï¼šè´Ÿè´£å¾ªç¯è¿™ä¸‰é¡¹ï¼Œå»æ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚å†™å…¥æ–‡ä»¶ï¼‰ã€‚</li>
<li><strong>done åˆ†æ”¯</strong>ï¼šç­‰è¿™ä¸‰é¡¹éƒ½å¤„ç†å®Œäº†ï¼Œ<strong>å‡ºæ¥å±ä¸€å£°ï¼ˆæ‰§è¡Œä¸€æ¬¡ï¼‰</strong>ï¼Œæ”¶ä¸ªå°¾ã€‚</li>
</ol>
<p>ä½†åœ¨å®é™…æ‰§è¡Œä¸­ï¼Œä½ ä¼šå‘ç° <code>loop</code> ä¸‹é¢æ˜¾ç¤º â€œ3 itemsâ€ï¼Œ<strong>è€Œ <strong><code>**done**</code></strong> ä¸‹é¢ä¹Ÿæ˜¾ç¤ºäº† â€œ3 itemsâ€</strong>ã€‚</p>
<p>å¦‚æœä½ åœ¨ <code>done</code> åé¢æ¥ä¸ªå‘é‚®ä»¶æˆ–è€…å†™æ–‡ä»¶çš„èŠ‚ç‚¹ï¼Œå®ƒä¼šæ•´æ•´è¿è¡Œ 3 æ¬¡ï¼</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45c05518443a449eb7413ddb0299c1c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=i%2FBr78ZCPfAKmXK1uWyvORRwCXA%3D" alt="" loading="lazy"/></p>
<p>è¿™åˆ°åº•æ˜¯ä¸ºä»€ä¹ˆï¼ŸğŸ¤”</p>
<hr/>
<h2 data-id="heading-2">ğŸ’¡ 2. æ ¸å¿ƒçœŸç›¸ï¼šæ˜¯â€œç»“æœâ€è·‘äº†å¤šæ¬¡ï¼Œè€Œä¸æ˜¯â€œäº‹ä»¶â€è·‘äº†å¤šæ¬¡</h2>
<p>è¿™é‡Œå¤§å®¶ä¸€å®šè¦è®°ä½ä¸€å¥è¯ï¼šåœ¨ n8n é‡Œï¼Œåç»­èŠ‚ç‚¹æ‰§è¡Œå‡ æ¬¡ï¼Œå–å†³äºå‰ä¸€ä¸ªèŠ‚ç‚¹è¾“å‡ºäº†å¤šå°‘ä¸ª Itemï¼ˆé¡¹ç›®ï¼‰ã€‚</p>
<p>è¿™å°±æ˜¯å¾ˆå¤šäººç†è§£ä¸äº†å¾ªç¯èŠ‚ç‚¹çš„æ ¹æœ¬åŸå› ã€‚</p>
<ul>
<li><strong>å®˜æ–¹æ²¡éª—ä½ </strong>ï¼š<code>done</code> åˆ†æ”¯ç¡®å®åªè¢«è§¦å‘äº†ä¸€æ¬¡ã€‚</li>
<li><strong>çœŸç›¸æ˜¯</strong>ï¼š<code>done</code> äº‹ä»¶åœ¨æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šæŠŠä¹‹å‰ <code>loop</code> å¾ªç¯å®Œæˆçš„æ‰€æœ‰ç»“æœï¼ˆé‚£ 3 æ¡æ•°æ®ï¼‰å°è£…åœ¨ä¸€èµ·åå‡ºæ¥ã€‚</li>
</ul>
<p><strong>å› ä¸º <strong><code>done</code></strong> åˆ†æ”¯è¾“å‡ºäº† 3 ä¸ªé¡¹ç›®</strong>ï¼Œn8n çš„é»˜è®¤é€»è¾‘å°±æ˜¯ï¼šâ€œæ—¢ç„¶ä½ æœ‰ 3 æ¡æ•°æ®ï¼Œ<strong>é‚£åé¢çš„èŠ‚ç‚¹æˆ‘å°±å¹¶è¡Œçš„å¸®ä½ è·‘ 3 æ¬¡å§ï¼</strong>â€</p>
<p>æ‰€ä»¥ï¼Œ<strong>ä½ çœ‹åˆ°çš„â€œæ‰§è¡Œå¤šæ¬¡â€ï¼Œå…¶å®æ˜¯ n8n å¼ºå¤§çš„å¹¶å‘ç‰¹æ€§å¯¼è‡´çš„â€œå‡è±¡â€</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ› ï¸ 3. ç»ˆæç»æ‹›ï¼šå¦‚ä½•è®© Done åªä¹–ä¹–æ‰§è¡Œä¸€æ¬¡ï¼Ÿ</h2>
<p>æ—¢ç„¶çŸ¥é“äº†åŸå› ï¼Œè§£å†³èµ·æ¥å°±éå¸¸ç®€å•äº†ã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›å¾ªç¯ç»“æŸåï¼Œåç»­èŠ‚ç‚¹ä¸ç®¡å‰é¢æœ‰å¤šå°‘é¡¹æ•°æ®ï¼Œéƒ½åªè¿è¡Œä¸€æ¬¡ï¼Œä½ åªéœ€è¦ï¼š</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f077f997a32461eb4452659667c6b50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=iy5KdcSVp7WNaqfphOIaBthyzlA%3D" alt="" loading="lazy"/></p>
<ol>
<li>æ‰“å¼€ <code>done</code> åˆ†æ”¯åçš„é‚£ä¸ªèŠ‚ç‚¹è®¾ç½®ã€‚</li>
<li>ç‚¹å‡» Settings é€‰é¡¹å¡ã€‚</li>
<li>æ‰¾åˆ° Execute Once é€‰é¡¹ï¼ŒæŠŠå®ƒæ‰“å¼€ï¼âœ…</li>
</ol>
<p>å¼€å¯è¿™ä¸ªå¼€å…³åï¼Œæ— è®ºå‰é¢ä¼ è¿‡æ¥ 3 æ¡è¿˜æ˜¯ 3000 æ¡æ•°æ®ï¼Œè¿™ä¸ªèŠ‚ç‚¹éƒ½åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚è¿™æ‰æ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„â€œå¾ªç¯ç»“æŸâ€åŠ¨ä½œï¼Œæœ€ç»ˆæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4bf74e4162d456b938d55428a054ad9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604868&amp;x-signature=mFoQSq1s%2F4YV7TW3%2FE2N6qtbbss%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-4">æœ€åæ€»ç»“ ğŸ“</h2>
<p>ç†è§£äº† â€œItem é©±åŠ¨æ‰§è¡Œâ€ è¿™ä¸ªé€»è¾‘ï¼Œä½ æ‰ç®—çœŸæ­£è¸å…¥äº† n8n é«˜çº§ç©å®¶çš„å¤§é—¨ã€‚</p>
<ul>
<li><strong>loop</strong>ï¼šè¿‡ç¨‹åˆ†æ”¯ï¼Œå¾ªç¯å‡ æ¬¡è·‘å‡ æ¬¡ã€‚</li>
<li><strong>done</strong>ï¼šç»“æŸåˆ†æ”¯ï¼Œåªè§¦å‘ä¸€æ¬¡ï¼Œä½†ä¼šæºå¸¦æ‰€æœ‰ç»“æœã€‚</li>
<li><strong>Execute Once</strong>ï¼šæ‹¦æˆªå¤šä½™æ‰§è¡Œçš„â€œå®šæµ·ç¥é’ˆâ€ã€‚</li>
</ul>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡å¹²è´§æœ‰å¸®åˆ°ä½ ï¼Œè®°å¾—ç‚¹èµã€åœ¨çœ‹ï¼</p>
<p>æˆ‘æ˜¯ç£Šå“¥ï¼Œæ¯å¤©åˆ†äº«ä¸€ä¸ª n8n å®æˆ˜å¹²è´§ï¼Œå’±ä»¬ä¸‹æœŸè§ï¼ğŸ‘‹</p>
<blockquote>
<p>æœ¬æ–‡å·²æ”¶å½•åˆ°æˆ‘çš„æŠ€æœ¯å°ç«™ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.javacn.site" target="_blank" title="https://www.javacn.site" ref="nofollow noopener noreferrer">www.javacn.site</a>ï¼Œç½‘ç«™åŒ…å«çš„å†…å®¹æœ‰ï¼š<strong>LangChain/N8N/SpringAI/SpringAIAlibaba/LangChain4j/Dify/Coze/AIå®æˆ˜é¡¹ç›®/AIå¸¸è§é¢è¯•é¢˜</strong>ç­‰æŠ€æœ¯åˆ†äº«ï¼Œæ¬¢è¿å„ä½å¤§ä½¬å…‰ä¸´æŒ‡å¯¼~</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin Flow ä¸­ flatMap ä¸ flatMapLatest çš„æ ¸å¿ƒå·®å¼‚ â€”â€” æ–°æ‰‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7588365276191883302</link>    <guid>https://juejin.cn/post/7588365276191883302</guid>    <pubDate>2025-12-29T01:52:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588365276191883302" data-draft-id="7588461466598441011" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin Flow ä¸­ flatMap ä¸ flatMapLatest çš„æ ¸å¿ƒå·®å¼‚ â€”â€” æ–°æ‰‹æŒ‡å—"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-29T01:52:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin Flow ä¸­ flatMap ä¸ flatMapLatest çš„æ ¸å¿ƒå·®å¼‚ â€”â€” æ–°æ‰‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T01:52:18.000Z" title="Mon Dec 29 2025 01:52:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å·®å¼‚</h2>
<h3 data-id="heading-1">flatMap</h3>
<ul>
<li><strong>è¡Œä¸º</strong>ï¼šè½¬æ¢æ¯ä¸ªè¾“å…¥å€¼åˆ° Flowï¼Œå¹¶<strong>æŒ‰é¡ºåºæ”¶é›†æ‰€æœ‰ç”Ÿæˆçš„ Flow</strong></li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ–°çš„è¾“å…¥ä¸ä¼šå–æ¶ˆä¹‹å‰æ­£åœ¨è¿›è¡Œçš„è½¬æ¢</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šéœ€è¦å¤„ç†æ‰€æœ‰äº‹ä»¶ï¼Œä¸”äº‹ä»¶é—´æœ‰ä¾èµ–å…³ç³»æˆ–éœ€ä¿æŒé¡ºåº</li>
</ul>
<h3 data-id="heading-2">flatMapLatest</h3>
<ul>
<li><strong>è¡Œä¸º</strong>ï¼šå½“æœ‰æ–°è¾“å…¥æ—¶ï¼Œ<strong>ç«‹å³å–æ¶ˆ</strong>å‰ä¸€ä¸ªè½¬æ¢çš„ Flow</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåªå¤„ç†æœ€æ–°çš„è¾“å…¥ï¼Œå¿½ç•¥ä¸­é—´ç»“æœ</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šåªéœ€æœ€æ–°ç»“æœï¼Œå¯å®‰å…¨å–æ¶ˆæ—§æ“ä½œ</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¯¹æ¯”ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">demonstrateDifference</span><span class="hljs-params">()</span></span> {
    runBlocking {
        <span class="hljs-keyword">val</span> flow = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).onEach { delay(<span class="hljs-number">100</span>) }
        
        <span class="hljs-comment">// flatMapï¼šå¤„ç†æ‰€æœ‰å€¼</span>
        flow.flatMap { value -&gt;
            flow {
                emit(<span class="hljs-string">"Processing <span class="hljs-variable">$value</span>"</span>)
                delay(<span class="hljs-number">200</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
                emit(<span class="hljs-string">"Completed <span class="hljs-variable">$value</span>"</span>)
            }
        }.collect { println(<span class="hljs-string">"flatMap: <span class="hljs-variable">$it</span>"</span>) }
        <span class="hljs-comment">// è¾“å‡ºæ‰€æœ‰ 1,2,3 çš„å¤„ç†ç»“æœ</span>
        
        <span class="hljs-comment">// flatMapLatestï¼šåªå¤„ç†æœ€æ–°çš„</span>
        flow.flatMapLatest { value -&gt;
            flow {
                emit(<span class="hljs-string">"Latest: <span class="hljs-variable">$value</span>"</span>)
                delay(<span class="hljs-number">200</span>)
                emit(<span class="hljs-string">"Done: <span class="hljs-variable">$value</span>"</span>) <span class="hljs-comment">// å¯èƒ½è¢«å–æ¶ˆ</span>
            }
        }.collect { println(<span class="hljs-string">"flatMapLatest: <span class="hljs-variable">$it</span>"</span>) }
        <span class="hljs-comment">// åªè¾“å‡º 3 çš„æœ€æ–°ç»“æœ</span>
    }
}
</code></pre>
<h2 data-id="heading-3">2. å®æˆ˜åœºæ™¯åˆ†æ</h2>
<h3 data-id="heading-4">åœºæ™¯ä¸€ï¼šæœç´¢è‡ªåŠ¨è¡¥å…¨</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SearchViewModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> searchQuery = MutableStateFlow(<span class="hljs-string">""</span>)
    
    <span class="hljs-comment">// ä½¿ç”¨ flatMapLatestï¼šç”¨æˆ·è¿ç»­è¾“å…¥æ—¶å–æ¶ˆä¹‹å‰çš„è¯·æ±‚</span>
    <span class="hljs-keyword">val</span> searchResults = searchQuery
        .debounce(<span class="hljs-number">300</span>) <span class="hljs-comment">// é˜²æŠ–</span>
        .filter { it.length &gt;= <span class="hljs-number">2</span> }
        .flatMapLatest { query -&gt;
            flow {
                emit(SearchState.Loading)
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">val</span> results = api.searchAutocomplete(query)
                    emit(SearchState.Success(results))
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    emit(SearchState.Error(e))
                }
            }
        }
        .stateIn(viewModelScope, SharingStarted.WhileSubscribed(), SearchState.Idle)
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onQueryChanged</span><span class="hljs-params">(query: <span class="hljs-type">String</span>)</span></span> {
        searchQuery.value = query
    }
}

<span class="hljs-comment">// é”™è¯¯ä½¿ç”¨ flatMap çš„æƒ…å†µï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šå®Œæˆï¼Œå¯èƒ½å¯¼è‡´ç»“æœæ˜¾ç¤ºé”™ä¹±</span>
<span class="hljs-keyword">val</span> wrongResults = searchQuery
    .flatMap { query -&gt; <span class="hljs-comment">// é”™è¯¯ï¼åº”è¯¥ç”¨ flatMapLatest</span>
        api.searchAutocompleteFlow(query)
    }
</code></pre>
<h3 data-id="heading-5">åœºæ™¯äºŒï¼šä½ç½®æ›´æ–°</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LocationTracker</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> locationUpdates = locationProvider.getUpdates()
    
    <span class="hljs-comment">// ä½¿ç”¨ flatMapï¼šæ¯ä¸ªä½ç½®éƒ½è¦ä¸Šä¼ ï¼Œé¡ºåºé‡è¦</span>
    <span class="hljs-keyword">val</span> uploadStatus = locationUpdates
        .filter { it.accuracy &lt; <span class="hljs-number">50</span> } <span class="hljs-comment">// åªå¤„ç†é«˜ç²¾åº¦ä½ç½®</span>
        .conflate() <span class="hljs-comment">// åˆå¹¶ä½ç½®æ›´æ–°ï¼Œé¿å…è¿‡å¿«</span>
        .flatMap { location -&gt;
            flow {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">val</span> response = uploadToServer(location)
                    emit(UploadResult.Success(location.id, response))
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    emit(UploadResult.Failure(location.id, e))
                }
            }
        }
        .<span class="hljs-keyword">catch</span> { e -&gt; emit(UploadResult.NetworkError(e)) }
    
    <span class="hljs-comment">// ä½¿ç”¨ flatMapLatestï¼šåªå…³å¿ƒæœ€æ–°ä½ç½®çš„å‘¨è¾¹æœç´¢</span>
    <span class="hljs-keyword">val</span> nearbyPlaces = locationUpdates
        .flatMapLatest { location -&gt;
            placesApi.getNearbyPlaces(location.lat, location.lng)
        }
}
</code></pre>
<h3 data-id="heading-6">åœºæ™¯ä¸‰ï¼šæ–‡ä»¶ä¸Šä¼ é˜Ÿåˆ—</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileUploadManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> uploadQueue = MutableSharedFlow&lt;FileData&gt;()
    
    <span class="hljs-comment">// ä½¿ç”¨ flatMap + bufferï¼šå¹¶å‘ä¸Šä¼ ä½†é™åˆ¶å¹¶å‘æ•°</span>
    <span class="hljs-keyword">val</span> uploadProgress = uploadQueue
        .flatMapMerge(concurrency = <span class="hljs-number">3</span>) { file -&gt; <span class="hljs-comment">// é™åˆ¶3ä¸ªå¹¶å‘</span>
            uploadFileFlow(file)
        }
        .shareIn(ioScope, SharingStarted.Lazily)
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">uploadFileFlow</span><span class="hljs-params">(file: <span class="hljs-type">FileData</span>)</span></span>: Flow&lt;UploadStatus&gt; = flow {
        emit(UploadStatus.Progress(file.id, <span class="hljs-number">0</span>))
        
        <span class="hljs-keyword">val</span> chunks = splitIntoChunks(file)
        chunks.forEachIndexed { index, chunk -&gt;
            api.uploadChunk(file.id, chunk)
            <span class="hljs-keyword">val</span> progress = ((index + <span class="hljs-number">1</span>) / chunks.size.toFloat() * <span class="hljs-number">100</span>).toInt()
            emit(UploadStatus.Progress(file.id, progress))
        }
        
        emit(UploadStatus.Completed(file.id))
    }
    
    <span class="hljs-comment">// ä½¿ç”¨ flatMapLatestï¼šç”¨æˆ·å–æ¶ˆä¸Šä¼ æ—¶ç«‹å³åœæ­¢</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">uploadWithCancel</span><span class="hljs-params">()</span></span>: Flow&lt;UploadStatus&gt; {
        <span class="hljs-keyword">val</span> cancelSignal = MutableStateFlow(<span class="hljs-literal">false</span>)
        
        <span class="hljs-keyword">return</span> uploadQueue
            .flatMapLatest { file -&gt;
                <span class="hljs-keyword">if</span> (cancelSignal.value) {
                    emptyFlow()
                } <span class="hljs-keyword">else</span> {
                    uploadFileFlow(file)
                }
            }
    }
}
</code></pre>
<h2 data-id="heading-7">3. å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-8">é™·é˜±ä¸€ï¼šèµ„æºæ³„æ¼</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ï¼šflatMapLatest å–æ¶ˆæ—¶èµ„æºæœªæ¸…ç†</span>
flow.flatMapLatest { id -&gt;
    flow {
        <span class="hljs-keyword">val</span> connection = openDatabaseConnection() <span class="hljs-comment">// å¯èƒ½æ³„æ¼ï¼</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = connection.query(id)
            emit(<span class="hljs-keyword">data</span>)
        } <span class="hljs-keyword">finally</span> {
            connection.close() <span class="hljs-comment">// å¿…é¡»æ¸…ç†</span>
        }
    }
}

<span class="hljs-comment">// æ­£ç¡®ï¼šä½¿ç”¨ cancellable æ“ä½œæˆ–æ¸…ç†èµ„æº</span>
flow.flatMapLatest { id -&gt;
    callbackFlow {
        <span class="hljs-keyword">val</span> connection = openDatabaseConnection()
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = connection.query(id)
            send(<span class="hljs-keyword">data</span>)
            awaitClose()
        } <span class="hljs-keyword">finally</span> {
            connection.close()
        }
    }
}
</code></pre>
<h3 data-id="heading-9">é™·é˜±äºŒï¼šçŠ¶æ€ä¸ä¸€è‡´</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ï¼šçŠ¶æ€æ›´æ–°å¯èƒ½è¢«å–æ¶ˆï¼Œå¯¼è‡´ä¸ä¸€è‡´</span>
<span class="hljs-keyword">var</span> currentState = State.IDLE

flow.flatMapLatest {
    currentState = State.LOADING <span class="hljs-comment">// å¯èƒ½æ‰§è¡Œä½†åç»­è¢«å–æ¶ˆ</span>
    apiCallFlow(it).onCompletion {
        currentState = State.IDLE <span class="hljs-comment">// å¯èƒ½ä¸ä¼šæ‰§è¡Œ</span>
    }
}

<span class="hljs-comment">// æ­£ç¡®ï¼šä½¿ç”¨çŠ¶æ€æµ</span>
<span class="hljs-keyword">val</span> state = MutableStateFlow(State.IDLE)

flow.flatMapLatest {
    state.value = State.LOADING
    apiCallFlow(it)
        .<span class="hljs-keyword">catch</span> { e -&gt; 
            state.value = State.ERROR(e)
            emptyFlow() 
        }
        .onCompletion { 
            <span class="hljs-keyword">if</span> (it == <span class="hljs-literal">null</span>) state.value = State.IDLE 
        }
}
</code></pre>
<h3 data-id="heading-10">é™·é˜±ä¸‰ï¼šèƒŒå‹å¤„ç†ä¸å½“</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ï¼šæ²¡æœ‰å¤„ç†èƒŒå‹ï¼Œå¯èƒ½å†…å­˜æº¢å‡º</span>
highFrequencyFlow
    .flatMapLatest { <span class="hljs-comment">// ä»ç„¶å¯èƒ½å¿«é€Ÿå‘å°„</span>
        heavyOperationFlow(it)
    }

<span class="hljs-comment">// æ­£ç¡®ï¼šæ·»åŠ èƒŒå‹ç­–ç•¥</span>
highFrequencyFlow
    .conflate() <span class="hljs-comment">// åˆå¹¶ä¸­é—´å€¼</span>
    .flatMapLatest {
        heavyOperationFlow(it)
    }

<span class="hljs-comment">// æˆ–é™åˆ¶å¹¶å‘</span>
highFrequencyFlow
    .flatMapMerge(concurrency = <span class="hljs-number">1</span>) { <span class="hljs-comment">// é™åˆ¶ä¸ºé¡ºåºæ‰§è¡Œ</span>
        heavyOperationFlow(it)
    }
</code></pre>
<h3 data-id="heading-11">é™·é˜±å››ï¼šå¼‚å¸¸å¤„ç†ç¼ºå¤±</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ï¼šå¼‚å¸¸ä¼šä½¿æ•´ä¸ªæµç»ˆæ­¢</span>
flow.flatMapLatest {
    flow { 
        <span class="hljs-keyword">if</span> (it.isEmpty()) <span class="hljs-keyword">throw</span> IllegalArgumentException()
        emit(process(it))
    }
}

<span class="hljs-comment">// æ­£ç¡®ï¼šå¦¥å–„å¤„ç†å¼‚å¸¸</span>
flow.flatMapLatest {
    flow {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (it.isEmpty()) <span class="hljs-keyword">throw</span> IllegalArgumentException()
            emit(Result.Success(process(it)))
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            emit(Result.Failure(e))
        }
    }
}
</code></pre>
<h2 data-id="heading-12">4. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åˆå¹¶æ“ä½œå‡å°‘å¼€é”€</span>
searchQuery
    .debounce(<span class="hljs-number">300</span>)
    .distinctUntilChanged() <span class="hljs-comment">// é¿å…é‡å¤æŸ¥è¯¢</span>
    .flatMapLatest { query -&gt;
        api.search(query)
            .retry(<span class="hljs-number">2</span>) <span class="hljs-comment">// é‡è¯•æœºåˆ¶</span>
            .timeout(<span class="hljs-number">5000</span>) <span class="hljs-comment">// è¶…æ—¶</span>
    }

<span class="hljs-comment">// 2. ä½¿ç”¨ shareIn é¿å…é‡å¤è®¢é˜…</span>
<span class="hljs-keyword">val</span> sharedFlow = sourceFlow
    .flatMapLatest { expensiveOperation(it) }
    .shareIn(
        scope = viewModelScope,
        started = SharingStarted.WhileSubscribed(<span class="hljs-number">5000</span>),
        replay = <span class="hljs-number">1</span>
    )

<span class="hljs-comment">// 3. é€‚å½“ä½¿ç”¨ buffer</span>
flow
    .buffer(Channel.UNLIMITED) <span class="hljs-comment">// æ ¹æ®åœºæ™¯é€‰æ‹©</span>
    .flatMapLatest { <span class="hljs-comment">/* ... */</span> }
</code></pre>
<h2 data-id="heading-13">5. é€‰æ‹©æŒ‡å—</h2>



































<table><thead><tr><th>åœºæ™¯ç‰¹å¾</th><th>æ¨èæ“ä½œç¬¦</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>éœ€å¤„ç†æ‰€æœ‰è¾“å…¥ï¼Œé¡ºåºé‡è¦</td><td><code>flatMapConcat</code></td><td>ä¿æŒé¡ºåºï¼Œæ— å¹¶å‘</td></tr><tr><td>éœ€å¤„ç†æ‰€æœ‰è¾“å…¥ï¼Œé¡ºåºä¸é‡è¦</td><td><code>flatMapMerge</code></td><td>å¹¶å‘å¤„ç†ï¼Œæé«˜æ•ˆç‡</td></tr><tr><td>åªéœ€æœ€æ–°ç»“æœï¼Œå¯å–æ¶ˆæ—§æ“ä½œ</td><td><code>flatMapLatest</code></td><td>é¿å…æ— æ•ˆè®¡ç®—</td></tr><tr><td>æœ‰é™å¹¶å‘æ§åˆ¶</td><td><code>flatMapMerge</code>Â with concurrency</td><td>æ§åˆ¶èµ„æºä½¿ç”¨</td></tr><tr><td>å†·æµè½¬æ¢</td><td><code>transform</code></td><td>æ›´è½»é‡çº§çš„è½¬æ¢</td></tr></tbody></table>
<h2 data-id="heading-14">æ€»ç»“</h2>
<ol>
<li><strong>flatMapLatest é€‚åˆå“åº”å¼ UI äº¤äº’</strong>ï¼ˆæœç´¢ã€ç‚¹å‡»é˜²æŠ–ï¼‰ï¼Œå¯é¿å…é™ˆæ—§æ•°æ®</li>
<li><strong>flatMapMerge é€‚åˆå¹¶è¡Œä»»åŠ¡å¤„ç†</strong>ï¼ˆæ‰¹é‡ä¸Šä¼ ã€å¹¶å‘è¯·æ±‚ï¼‰ï¼Œæé«˜ååé‡</li>
<li><strong>flatMapConcat é€‚åˆé¡ºåºæ•æ„Ÿæ“ä½œ</strong>ï¼ˆæ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ã€æ•°æ®åº“äº‹åŠ¡ï¼‰</li>
<li><strong>å§‹ç»ˆè€ƒè™‘èµ„æºæ¸…ç†</strong>ï¼Œç‰¹åˆ«æ˜¯åœ¨å¯å–æ¶ˆçš„æ“ä½œä¸­</li>
<li><strong>åˆç†å¤„ç†èƒŒå‹</strong>ï¼Œæ ¹æ®åœºæ™¯é€‰æ‹© bufferã€conflate ç­‰ç­–ç•¥</li>
<li><strong>ç»Ÿä¸€å¼‚å¸¸å¤„ç†</strong>ï¼Œé¿å…æµæ„å¤–ç»ˆæ­¢</li>
</ol>
<p>æ­£ç¡®é€‰æ‹© flatMap å˜ä½“å¯ä»¥æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¼‚æ­¥æ•°æ®æµæ—¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“AIä¸å†æ˜¯â€œç©å…·â€ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•ç”¨Traceã€Antigravityå’ŒCursorâ€œèººå¹³â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7588934987510267931</link>    <guid>https://juejin.cn/post/7588934987510267931</guid>    <pubDate>2025-12-29T09:01:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588934987510267931" data-draft-id="7589093895326187529" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“AIä¸å†æ˜¯â€œç©å…·â€ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•ç”¨Traceã€Antigravityå’ŒCursorâ€œèººå¹³â€ï¼Ÿ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-29T09:01:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŸ¥è¯†æµ…è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/607378030207176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“AIä¸å†æ˜¯â€œç©å…·â€ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•ç”¨Traceã€Antigravityå’ŒCursorâ€œèººå¹³â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/607378030207176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŸ¥è¯†æµ…è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T09:01:04.000Z" title="Mon Dec 29 2025 09:01:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä»â€œå“‡å¡â€åˆ°â€œçœŸé¦™â€çš„è´¨å˜</h3>
<p>å›æƒ³ä¸¤å¹´å‰ï¼Œ2023å¹´é‚£ä¼šï¼Œæˆ‘ä»¬åˆšæ¥è§¦ChatGPTå’ŒCopilotçš„æ—¶å€™ï¼Œæ¯å¤©éƒ½åœ¨æƒŠå‘¼ï¼šâ€œå§æ§½ï¼Œè¿™ç©æ„å„¿èƒ½å†™å¿«æ’ï¼â€é‚£æ—¶å€™çš„AIåƒä¸ªåˆšæ¯•ä¸šçš„å¤©æ‰å®ä¹ ç”Ÿï¼Œèªæ˜ä½†ç»å¸¸èƒ¡è¯´å…«é“ã€‚</p>
<p>ä¸€è½¬çœ¼åˆ°äº†2025å¹´åº•ã€‚ç°åœ¨çš„æ„Ÿè§‰å˜äº†ã€‚AIä¸å†æ˜¯é‚£ä¸ªéœ€è¦ä½ å“„ç€å†™Promptçš„å®ä¹ ç”Ÿï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªä¸çŸ¥ç–²å€¦çš„<strong>Tech Lead</strong>ã€‚</p>
<p>ä»Šå¹´æ˜¯æˆ‘å½»åº•æ”¾å¼ƒâ€œæ‰‹å†™æ¯ä¸€è¡Œä»£ç â€æ‰§å¿µçš„ä¸€å¹´ã€‚ä¸æ˜¯æˆ‘æ‡’ï¼Œè€Œæ˜¯å·¥å…·å¤ªå¼ºäº†ã€‚å¦‚æœä½ ç°åœ¨è¿˜åœ¨ç”¨çº¯Vimæˆ–è€…æ²¡æœ‰ä»»ä½•æ’ä»¶çš„VS Codeç¡¬åˆšä¸šåŠ¡é€»è¾‘ï¼Œè¯´å®è¯ï¼Œä½ æ­£åœ¨è¿™è¾†é£é€Ÿè¡Œé©¶çš„æŠ€æœ¯åˆ—è½¦ä¸Šè¡¨æ¼”â€œå¾’æ‰‹æ‰’ç«è½¦â€ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡é•¿æ–‡ï¼Œä¸è®²è™šå¤´å·´è„‘çš„æ¦‚å¿µï¼Œå’±å°±èŠèŠè¿™ä¸€å¹´é™ªæˆ‘ç†¬å¤œã€å¸®æˆ‘èƒŒé”…ã€è®©æˆ‘æ—©ç‚¹ä¸‹ç­çš„é‚£äº›ç¥çº§å·¥å…·ï¼š<strong>Cursor, Antigravity, Kiro, Trace</strong> ç­‰ç­‰ã€‚</p>
<hr/>
<h3 data-id="heading-1">Cursorï¼šå®ƒå·²ç»ä¸æ˜¯ç¼–è¾‘å™¨äº†ï¼Œå®ƒæ˜¯æˆ‘çš„å¤–åŒ…å›¢é˜Ÿ</h3>
<p>å¦‚æœè¯´2024å¹´çš„Cursorè¿˜æ˜¯VS Codeçš„é­”æ”¹ç‰ˆï¼Œé‚£2025å¹´çš„Cursorç®€ç›´å°±æ˜¯<strong>IDEç•Œçš„â€œé’¢é“ä¾ æˆ˜è¡£â€</strong>ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbf24466d8d24b1f99a9bba2c5a02d51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604059&amp;x-signature=dkyLfJ4BjCmj1E8CtNEHVa7swP0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-2">1. Composer æ¨¡å¼çš„å®Œå…¨ä½“</h4>
<p>ä»¥å‰æˆ‘ä»¬ç”¨AIï¼Œæ˜¯ä¸€é—®ä¸€ç­”ï¼šâ€œå¸®æˆ‘å†™ä¸ªå‡½æ•°â€ã€‚
ç°åœ¨çš„Cursor Composerï¼ˆæ’°å†™è€…æ¨¡å¼ï¼‰æ˜¯ï¼šâ€œå¸®æˆ‘æŠŠè¿™ä¸ªUseræ¨¡å—é‡æ„ä¸€ä¸‹ï¼Œæ•°æ®åº“å­—æ®µåŠ ä¸€ä¸ª<code>last_login</code>ï¼Œé¡ºä¾¿æŠŠå‰ç«¯çš„Profileé¡µé¢ä¹Ÿæ”¹äº†ï¼ŒAPIæ–‡æ¡£ä¹Ÿæ›´æ–°ä¸€ä¸‹ã€‚â€</p>
<p>å®ƒä¸å†æ˜¯ç›¯ç€å…‰æ ‡å¤„çš„é‚£ä¸€è¡Œä»£ç ï¼Œå®ƒæœ‰äº†<strong>å…¨å±€è§†é‡</strong>ã€‚ä»Šå¹´æˆ‘åœ¨åšé‚£ä¸ªSaaSé¡¹ç›®æ—¶ï¼Œæœ€çˆ½çš„ä¸€æ¬¡ä½“éªŒæ˜¯ï¼Œæˆ‘ç›´æ¥ä¸¢ç»™å®ƒä¸€å¼ æ•°æ®åº“ERå›¾çš„æˆªå›¾ï¼Œç„¶åè¯´ï¼šâ€œæŒ‰è¿™ä¸ªç»“æ„ç”Ÿæˆåç«¯CRUDæ¥å£ï¼Œç”¨FastAPIã€‚â€</p>
<p>ä¸¤åˆ†é’Ÿåï¼ŒModelã€Schemaã€Routerå…¨å‡ºæ¥äº†ã€‚æˆ‘åªéœ€è¦åƒä¸ªç”²æ–¹ä¸€æ ·æŒ‡æŒ‡ç‚¹ç‚¹ï¼šâ€œè¿™å„¿æ²¡åšé‰´æƒï¼Œé‚£å„¿å°‘ä¸ªåˆ†é¡µã€‚â€</p>
<h4 data-id="heading-3">2. Shadow Workspaceï¼ˆå½±å­å·¥ä½œåŒºï¼‰</h4>
<p>è¿™æ˜¯Cursorä»Šå¹´æœ€å¤§çš„æ€æ‰‹é”ã€‚ä»¥å‰æ”¹ä»£ç æ€•æ”¹æŒ‚äº†ï¼Œå¾—åˆ‡ä¸ªåˆ†æ”¯ã€‚ç°åœ¨Cursoråœ¨ä½ æ‰“å­—çš„æ—¶å€™ï¼Œå·²ç»åœ¨åå°çš„â€œå½±å­ç©ºé—´â€é‡Œé¢„è¿è¡Œäº†ä½ çš„ä»£ç ã€‚</p>
<p>å½“ä½ è¿˜åœ¨çŠ¹è±«å˜é‡åèµ·ä»€ä¹ˆçš„æ—¶å€™ï¼Œå®ƒå·²ç»åœ¨å³ä¸‹è§’æç¤ºä½ ï¼šâ€œè€å…„ï¼Œä½ è¿™æ ·å†™å¾…ä¼šå„¿è·‘ä¸é€šçš„ï¼Œå› ä¸ºç¬¬50è¡Œçš„é‚£ä¸ªä¾èµ–åŒ…ç‰ˆæœ¬ä¸å…¼å®¹ã€‚â€ è¿™ç§<strong>é¢„çŸ¥æœªæ¥</strong>çš„èƒ½åŠ›ï¼ŒçœŸçš„æ•‘äº†æˆ‘æ— æ•°æ¬¡ç”Ÿäº§ç¯å¢ƒçš„P0çº§äº‹æ•…ã€‚</p>
<hr/>
<h3 data-id="heading-4">Antigravityï¼šPythonå¼€å‘è€…çš„ä¸Šå¸è§†è§’</h3>
<p>å¦‚æœä½ æ˜¯Pythonå¼€å‘è€…ï¼Œä»Šå¹´æ²¡ç”¨è¿‡ <strong>Antigravity</strong>ï¼Œé‚£ä½ çœŸçš„é”™è¿‡äº†å¤ªå¤šã€‚å®ƒçš„åå­—å–è‡ªé‚£ä¸ªç»å…¸çš„XKCDæ¼«ç”»ï¼ˆPythonèƒ½è®©ä½ é£èµ·æ¥ï¼‰ï¼Œä½†2025å¹´çš„è¿™ä¸ªå·¥å…·ï¼Œæ˜¯çœŸçš„è®©ä½ <strong>æ— è§†é‡åŠ›</strong>ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b13c4b0eb6d846918b22a8e517c58e6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604059&amp;x-signature=TKKADtZtpoovPe4cVqDfZfhX2bg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-5">1. ä¹Ÿæ˜¯IDEï¼Œä½†æ˜¯æ˜¯3Dçš„ï¼Ÿ</h4>
<p>Antigravity ä¸å†æ˜¯å†·å†°å†°çš„ä»£ç è¡Œã€‚å®ƒå¼•å…¥äº†â€œå¯è§†åŒ–å †æ ˆâ€çš„æ¦‚å¿µã€‚ä»¥å‰è°ƒè¯•ä»£ç ï¼Œæˆ‘ä»¬æ˜¯æ‰“æ–­ç‚¹ï¼Œä¸€æ­¥æ­¥Nextã€‚åœ¨Antigravityé‡Œï¼Œä»£ç çš„æ‰§è¡Œæµè¢«ç”»æˆäº†ä¸€å¼ åŠ¨æ€çš„å›¾ã€‚</p>
<p>ä½ å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°æ•°æ®æµæ€ä¹ˆä»APIè¿›æ¥ï¼Œç»è¿‡äº†å“ªäº›ä¸­é—´ä»¶ï¼Œåœ¨å“ªé‡Œè¢«å µå¡äº†ã€‚</p>
<h4 data-id="heading-6">2. ä¾èµ–åœ°ç‹±çš„ç»ˆç»“è€…</h4>
<p>Pythonçš„åŒ…ç®¡ç†ä¸€ç›´æ˜¯å™©æ¢¦ã€‚<code>pip</code>ã€<code>poetry</code>ã€<code>conda</code> æ··åœ¨ä¸€èµ·èƒ½è¦æŠŠäººé€¼ç–¯ã€‚Antigravity å†…ç½®äº†ä¸€ä¸ªAIç¯å¢ƒç®¡å®¶ã€‚</p>
<p>æˆ‘æœ‰ä¸€æ¬¡æ¥æ‰‹ä¸€ä¸ªç¥–ä¼ çš„Djangoé¡¹ç›®ï¼Œä¾èµ–ä¹±å¾—åƒç›˜ä¸æ´ã€‚æˆ‘ç›´æ¥æŠŠé¡¹ç›®æ‹–è¿› Antigravityï¼Œç‚¹äº†ä¸€ä¸‹â€œFix Environmentâ€ã€‚å®ƒè‡ªåŠ¨æ‰«æäº†æ‰€æœ‰importï¼Œåˆ†æäº†ç‰ˆæœ¬å†²çªï¼Œç„¶åç»™æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªå®Œç¾çš„è™šæ‹Ÿç¯å¢ƒã€‚å®ƒç”šè‡³æ‚„æ‚„æŠŠå‡ ä¸ªæœ‰å®‰å…¨æ¼æ´çš„åŒ…ç»™å‡çº§å¹¶é€‚é…äº†ã€‚</p>
<blockquote>
<p><strong>å¿ƒå¾—ï¼š</strong> Antigravity è®©æˆ‘æ„Ÿè§‰è‡ªå·±ä¸æ˜¯åœ¨å†™ä»£ç ï¼Œè€Œæ˜¯åœ¨åƒä¿®ç†é’Ÿè¡¨ä¸€æ ·ï¼Œç²¾å‡†åœ°è°ƒæ•´æ¯ä¸€ä¸ªé½¿è½®çš„å’¬åˆã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">Kiroï¼šç»ˆç»“äº†â€œæŸ¥æ–‡æ¡£â€æ—¶ä»£çš„å‘½ä»¤è¡Œ</h3>
<p>è®°å¾—ä»¥å‰è¦åœ¨ç»ˆç«¯é‡Œæç‚¹å¤æ‚çš„è¿ç»´æ“ä½œï¼Œæ¯”å¦‚â€œæŸ¥æ‰¾æ‰€æœ‰å¤§äº100Mçš„æ–‡ä»¶å¹¶æŒ‰ä¿®æ”¹æ—¶é—´æ’åºååˆ é™¤â€ï¼Œæˆ‘å¾—å»Googleä¸€ä¸‹ <code>find</code> å‘½ä»¤çš„å‚æ•°ï¼Œæˆ–è€…å»ç¿» <code>man</code> æ‰‹å†Œã€‚</p>
<p><strong>Kiro</strong> çš„å‡ºç°ï¼ŒæŠŠTerminalå˜æˆäº†èŠå¤©çª—å£ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b13be09024d4be8b36babedf34529a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604059&amp;x-signature=T8TF8dL1Xs14PZVKE%2BzHrUDRUA8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-8">1. è‡ªç„¶è¯­è¨€è½¬Shell</h4>
<p>ç°åœ¨æˆ‘çš„ç»ˆç«¯æ—¥å¸¸æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>æˆ‘ï¼š<code>kiro å¸®æˆ‘æŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„pngå›¾ç‰‡å‹ç¼©50%ç„¶åç§»åŠ¨åˆ° dist æ–‡ä»¶å¤¹</code>
Kiro: <code>Running: find . -name "*.png" -exec convert {} -quality 50% dist/{} \;</code> ï¼ˆè‡ªåŠ¨æ‰§è¡Œï¼‰</p>
</blockquote>
<p>å®ƒä¸æ˜¯ç®€å•çš„ç¿»è¯‘ï¼Œå®ƒæ‡‚ä¸Šä¸‹æ–‡ã€‚å¦‚æœä½ è¿ç»­æ“ä½œï¼Œå®ƒè®°å¾—ä½ ä¸Šä¸€æ­¥è¿›äº†å“ªä¸ªç›®å½•ï¼Œè®°å¾—ä½ åˆšæ‰éƒ¨ç½²çš„æ˜¯å“ªä¸ªæœåŠ¡ã€‚</p>
<h4 data-id="heading-9">2. æŠ¥é”™è‡ªåŠ¨ä¿®</h4>
<p>æœ€ç¥çš„æ˜¯ï¼Œå½“å‘½ä»¤æŠ¥é”™æ—¶ï¼ŒKiroä¸ä¼šåªç»™ä½ æ‰”ä¸€å †çº¢è‰²çš„Error Logã€‚å®ƒä¼šç›´æ¥åˆ†ææŠ¥é”™åŸå› ï¼š
â€œæŠ¥é”™æ˜¯å› ä¸ºç«¯å£8080è¢«å ç”¨äº†ï¼Œå ç”¨è€…æ˜¯PID 1234 (Java)ã€‚ä½ è¦æ€æ‰å®ƒå—ï¼Ÿâ€
æˆ‘åªéœ€è¦å›ä¸€ä¸ª <code>y</code>ã€‚</p>
<p>è¿™ç§ä¸æ»‘æ„Ÿï¼Œè®©æˆ‘è¿™ä¸ªè€è¿ç»´éƒ½æ„ŸåŠ¨å¾—æƒ³å“­ã€‚Kiro è®© CLIï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰å˜æˆäº† CUIï¼ˆå¯¹è¯å¼ç•Œé¢ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-10">Traceï¼šé‚£ä¸ªä¸ç”¨ä½ å†™æµ‹è¯•ç”¨ä¾‹çš„QA</h3>
<p><strong>Trace</strong> æ˜¯ä»Šå¹´æµ‹è¯•é¢†åŸŸçš„é»‘é©¬ã€‚å®ƒçš„ç†å¿µéå¸¸æ¿€è¿›ï¼š<strong>â€œäººæ˜¯ä¸åº”è¯¥å†™å•å…ƒæµ‹è¯•çš„â€</strong>ã€‚</p>
<p>å¬èµ·æ¥å¾ˆç‹‚å¯¹å§ï¼Ÿä½†å®ƒåšåˆ°äº†ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5af079fdd6ab43cf9ad3fcddb10f75f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767604059&amp;x-signature=Ekzn94%2Fbw8KD0PIr2P0tk%2F%2F%2FFlw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-11">1. é€†å‘ç”Ÿæˆæµ‹è¯•</h4>
<p>Trace æŒ‚åœ¨ä½ çš„åå°ï¼Œå®ƒä¼šè§‚å¯Ÿä½ å¹³æ—¶çš„æ‰‹åŠ¨æµ‹è¯•è¡Œä¸ºï¼Œä¹Ÿä¼šåˆ†æä½ çš„ä¸šåŠ¡é€»è¾‘ä»£ç ã€‚å½“ä½ å†™å®Œä¸€ä¸ª <code>OrderService</code> ç±»ï¼Œä¿å­˜çš„é‚£ä¸€ç¬é—´ï¼ŒTrace å·²ç»åœ¨åå°ç”Ÿæˆäº†è¦†ç›–ç‡100%çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>å®ƒä¸ä»…ä»…æ˜¯ç”Ÿæˆ <code>assert 1==1</code> è¿™ç§åºŸè¯ï¼Œå®ƒä¼šç”Ÿæˆè¾¹ç•Œæ¡ä»¶æµ‹è¯•ã€‚æ¯”å¦‚ä½ å†™äº†ä¸ªé™¤æ³•ï¼Œå®ƒè‡ªåŠ¨ç”Ÿæˆé™¤ä»¥0çš„Caseï¼›ä½ å†™äº†ä¸ªé‡‘é¢è®¡ç®—ï¼Œå®ƒè‡ªåŠ¨ç”Ÿæˆè´Ÿæ•°è¾“å…¥çš„Caseã€‚</p>
<h4 data-id="heading-12">2. ç”Ÿäº§ç¯å¢ƒå½•åˆ¶å›æ”¾</h4>
<p>Trace æœ€å¼ºçš„åŠŸèƒ½æ˜¯<strong>Traffic Replay</strong>ã€‚å®ƒèƒ½å¯¹ç”Ÿäº§ç¯å¢ƒçš„æµé‡è¿›è¡Œè„±æ•å½•åˆ¶ï¼Œç„¶ååœ¨æˆ‘æœ¬åœ°å¼€å‘ç¯å¢ƒé‡Œå›æ”¾ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œæˆ‘æœ¬åœ°è°ƒè¯•çš„ä¸æ˜¯å‡æ•°æ®ï¼Œè€Œæ˜¯çœŸå®ç”¨æˆ·äº§ç”Ÿçš„æ•°æ®ï¼ˆå½“ç„¶æ˜¯è„±æ•çš„ï¼‰ã€‚è¿™è§£å†³äº†å›°æ‰°ç¨‹åºå‘˜å‡ åå¹´çš„åƒå¤éš¾é¢˜ï¼šâ€œ<strong>åœ¨æˆ‘æœ¬åœ°æ˜æ˜æ˜¯å¥½çš„å•Šï¼</strong>â€</p>
<hr/>
<h3 data-id="heading-13">2025å¹´çš„ç¼–ç¨‹èŒƒå¼ï¼šæˆ‘ä»¬è¿˜æ˜¯ç¨‹åºå‘˜å—ï¼Ÿ</h3>
<p>èŠå®Œå·¥å…·ï¼Œæˆ‘æƒ³èŠèŠå¿ƒæ€ã€‚</p>
<p>ä»Šå¹´æˆ‘ä¹Ÿå¬åˆ°å¾ˆå¤šå£°éŸ³ï¼Œè¯´ç¨‹åºå‘˜è¦å¤±ä¸šäº†ã€‚ä½†æˆ‘è¿™ä¸€å¹´ç”¨ä¸‹æ¥ï¼Œæ„Ÿè§‰æ°æ°ç›¸åã€‚<strong>æˆ‘ä»¬æ²¡æœ‰å¤±ä¸šï¼Œä½†æˆ‘ä»¬è½¬è¡Œäº†ã€‚</strong></p>
<p>æˆ‘ä»¬ä»â€œæ¬ç –å·¥â€ï¼ˆBricklayerï¼‰å˜æˆäº†â€œå»ºç­‘å¸ˆâ€ï¼ˆArchitectï¼‰ã€‚</p>
<h4 data-id="heading-14">1. è¿™ç§æ„Ÿè§‰å«â€œå¿ƒæµçš„å»¶ç»­â€</h4>
<p>ä»¥å‰å†™ä»£ç ï¼Œå¾ˆå®¹æ˜“è¢«æ‰“æ–­ï¼šæŸ¥è¯­æ³•ã€ä¿®æ ‡ç‚¹ã€é…ç¯å¢ƒã€‚
ç°åœ¨æœ‰äº† Cursor + Antigravity + Kiroï¼Œè¿™äº›çäº‹éƒ½è¢«AIæ¥ç®¡äº†ã€‚æˆ‘å¯ä»¥æŠŠæ‰€æœ‰çš„è„‘åŠ›éƒ½é›†ä¸­åœ¨<strong>ä¸šåŠ¡é€»è¾‘</strong>å’Œ<strong>ç³»ç»Ÿè®¾è®¡</strong>ä¸Šã€‚</p>
<p>ä»¥å‰åšä¸€ä¸ªåŠŸèƒ½è¦3å¤©ï¼Œå…¶ä¸­2.5å¤©åœ¨å†™Boilerplateï¼ˆæ ·æ¿ä»£ç ï¼‰ã€‚ç°åœ¨åšä¸€ä¸ªåŠŸèƒ½åªè¦åŠå¤©ï¼Œå‰©ä¸‹2.5å¤©æˆ‘å¯ä»¥å»ä¼˜åŒ–æ€§èƒ½ã€å»æ€è€ƒç”¨æˆ·ä½“éªŒã€ç”šè‡³å»é™ªå¥³æœ‹å‹ï¼ˆåˆ’æ‰ï¼Œå»å­¦ä¹ æ–°æ¡†æ¶ï¼‰ã€‚</p>
<h4 data-id="heading-15">2. å®¡ç¾å˜å¾—æ¯”æ‰‹é€Ÿæ›´é‡è¦</h4>
<p>å½“AIèƒ½å¸®ä½ ç”Ÿæˆä¸€åˆ‡çš„æ—¶å€™ï¼Œ<strong>å“å‘³</strong>å°±æˆäº†æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
<ul>
<li>ä½ çŸ¥é“è¿™æ®µç”Ÿæˆçš„ä»£ç è™½ç„¶èƒ½è·‘ï¼Œä½†ç»“æ„å¾ˆçƒ‚å—ï¼Ÿ</li>
<li>ä½ çŸ¥é“è¿™ä¸ªUIè™½ç„¶ç”»å‡ºæ¥äº†ï¼Œä½†äº¤äº’åäººç±»å—ï¼Ÿ</li>
<li>ä½ çŸ¥é“è¿™ä¸ªæ¶æ„è™½ç„¶æµè¡Œï¼Œä½†ä¸é€‚åˆç°åœ¨çš„ä¸šåŠ¡è§„æ¨¡å—ï¼Ÿ</li>
</ul>
<p>å·¥å…·è¶Šå¼ºï¼Œè¶Šéœ€è¦ä¸€ä¸ªæœ‰ç»éªŒçš„äººå»æŒ‰ä½AIçš„æ‰‹è¯´ï¼šâ€œåœï¼Œè¿™é‡Œä¸èƒ½è¿™ä¹ˆå†™ï¼Œä¼šç”±äºå¹¶å‘é—®é¢˜å¯¼è‡´æ­»é”ã€‚â€</p>
<p>è¿™å°±æ˜¯2025å¹´èµ„æ·±ç¨‹åºå‘˜çš„ä»·å€¼â€”â€”<strong>é‰´èµåŠ›ä¸æŠŠæ§åŠ›</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-16">ç»“è¯­</h3>
<p>2025å¹´ï¼Œæ˜¯ç¼–ç¨‹æŠ€æœ¯å½»åº•çˆ†å‘çš„ä¸€å¹´ã€‚ç¼–ç¨‹ä¸å†æ˜¯Ctrl+Cã€Ctrl+VğŸ˜‚ï¼Œå®ƒå˜æˆäº†ä¸€ç§æ›´äº²æ°‘ã€æ›´é«˜æ•ˆçš„åˆ›é€ æ–¹å¼ã€‚</p>
<p>å¦‚æœä½ é—®æˆ‘ï¼Œç°åœ¨è¿˜è¦ä¸è¦å­¦ç¼–ç¨‹ï¼Ÿ
æˆ‘çš„å›ç­”æ˜¯ï¼š<strong>è¦å­¦ã€‚ä½†ä¸è¦å­¦æ€ä¹ˆå†™è¯­æ³•ï¼Œè¦å­¦æ€ä¹ˆæ„å»ºé€»è¾‘ï¼Œæ€ä¹ˆæ‹†è§£é—®é¢˜ï¼Œæ€ä¹ˆæŒ‡æŒ¥AIå†›å›¢ä¸ºä½ ä½œæˆ˜ã€‚</strong></p>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰è¯•è¿‡ Cursor çš„ Composerï¼Œæ²¡åœ¨ Antigravity é‡Œé£è¿‡ï¼Œæ²¡è·Ÿ Kiro èŠè¿‡å¤©ï¼Œå“ªæ€•åªæ˜¯ä¸ºäº†å¥½ç©ï¼Œä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</p>
<p>æ¯•ç«Ÿï¼Œ<strong>å·æ‡’ï¼Œæ‰æ˜¯äººç±»ç§‘æŠ€è¿›æ­¥çš„ç¬¬ä¸€ç”Ÿäº§åŠ›ã€‚</strong></p>
<hr/>
<p><em>(æœ€åæ’ä¸€å¥ï¼Œè¿™ç¯‡æ–‡ç« çš„å¤§çº²æ˜¯ Cursor å¸®æˆ‘ç†çš„ï¼Œé…å›¾å»ºè®®æ˜¯ Gemini æçš„ï¼Œä½†æˆ‘ä¿è¯ï¼Œè¿™æ®µæ„Ÿæ…¨æ˜¯æˆ‘è‡ªå·±ä¸€ä¸ªä¸ªå­—æ•²å‡ºæ¥çš„ã€‚)</em></p>
<hr/>
<p><strong>å¸Œæœ›è¿™ç¯‡å¹´åº¦æ€»ç»“èƒ½ç»™ä½ å¸¦æ¥ä¸€äº›å…±é¸£ã€‚æ˜å¹´è§ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›æº¯ç®—æ³•æ€»ç»“]]></title>    <link>https://juejin.cn/post/7588461466598031411</link>    <guid>https://juejin.cn/post/7588461466598031411</guid>    <pubDate>2025-12-29T00:20:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588461466598031411" data-draft-id="7588146449005953060" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" å›æº¯ç®—æ³•æ€»ç»“"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-29T00:20:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             å›æº¯ç®—æ³•æ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T00:20:47.000Z" title="Mon Dec 29 2025 00:20:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>å…¶å®å›æº¯ç®—æ³•å’Œæˆ‘ä»¬å¸¸è¯´çš„ DFS ç®—æ³•éå¸¸ç±»ä¼¼ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§æš´åŠ›ç©·ä¸¾ç®—æ³•ã€‚å›æº¯ç®—æ³•å’Œ DFS ç®—æ³•çš„ç»†å¾®å·®åˆ«æ˜¯ï¼šå›æº¯ç®—æ³•æ˜¯åœ¨éå†ã€Œæ ‘æã€ï¼ŒDFS ç®—æ³•æ˜¯åœ¨éå†ã€ŒèŠ‚ç‚¹ã€</p>
<p><strong>æŠ½è±¡åœ°è¯´ï¼Œè§£å†³ä¸€ä¸ªå›æº¯é—®é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯éå†ä¸€æ£µå†³ç­–æ ‘çš„è¿‡ç¨‹ï¼Œæ ‘çš„æ¯ä¸ªå¶å­èŠ‚ç‚¹å­˜æ”¾ç€ä¸€ä¸ªåˆæ³•ç­”æ¡ˆã€‚ä½ æŠŠæ•´æ£µæ ‘éå†ä¸€éï¼ŒæŠŠå¶å­èŠ‚ç‚¹ä¸Šçš„ç­”æ¡ˆéƒ½æ”¶é›†èµ·æ¥ï¼Œå°±èƒ½å¾—åˆ°æ‰€æœ‰çš„åˆæ³•ç­”æ¡ˆ</strong>ã€‚</p>
<p>ç«™åœ¨å›æº¯æ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½ åªéœ€è¦æ€è€ƒ 3 ä¸ªé—®é¢˜ï¼š</p>
<p>1ã€è·¯å¾„ï¼šä¹Ÿå°±æ˜¯å·²ç»åšå‡ºçš„é€‰æ‹©ã€‚</p>
<p>2ã€é€‰æ‹©åˆ—è¡¨ï¼šä¹Ÿå°±æ˜¯ä½ å½“å‰å¯ä»¥åšçš„é€‰æ‹©ã€‚</p>
<p>3ã€ç»“æŸæ¡ä»¶ï¼šä¹Ÿå°±æ˜¯åˆ°è¾¾å†³ç­–æ ‘åº•å±‚ï¼Œæ— æ³•å†åšé€‰æ‹©çš„æ¡ä»¶ã€‚</p>
<p>ä»£ç æ–¹é¢ï¼Œå›æº¯ç®—æ³•çš„æ¡†æ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java">result = []
def <span class="hljs-title function_">backtrack</span><span class="hljs-params">(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)</span>:
    <span class="hljs-keyword">if</span> æ»¡è¶³ç»“æŸæ¡ä»¶:
        result.add(è·¯å¾„)
        <span class="hljs-keyword">return</span>
    
    <span class="hljs-keyword">for</span> é€‰æ‹© in é€‰æ‹©åˆ—è¡¨:
        åšé€‰æ‹©
        backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)
        æ’¤é”€é€‰æ‹©
</code></pre>
<p>forå¾ªç¯å°±æ˜¯éå†é›†åˆåŒºé—´ï¼Œå¯ä»¥ç†è§£ä¸€ä¸ªèŠ‚ç‚¹æœ‰å¤šå°‘ä¸ªå­©å­ï¼Œè¿™ä¸ªforå¾ªç¯å°±æ‰§è¡Œå¤šå°‘æ¬¡ã€‚</p>
<p>backtrackingè¿™é‡Œè‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œå®ç°é€’å½’ã€‚</p>
<p><strong>å…¶æ ¸å¿ƒå°±æ˜¯ for å¾ªç¯é‡Œé¢çš„é€’å½’ï¼Œåœ¨é€’å½’è°ƒç”¨ä¹‹å‰ã€Œåšé€‰æ‹©ã€ï¼Œåœ¨é€’å½’è°ƒç”¨ä¹‹åã€Œæ’¤é”€é€‰æ‹©ã€</strong></p>
<h2 data-id="heading-1">å›æº¯ç®—æ³•è§£å†³ç»„åˆé—®é¢˜</h2>
<p>è¿™é‡Œçš„ç»„åˆé—®é¢˜ å…ƒç´ æ— é‡ä¸å¯å¤é€‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-comment">// è®°å½•å›æº¯ç®—æ³•çš„é€’å½’è·¯å¾„</span>
    LinkedList&lt;Integer&gt; track = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();

    <span class="hljs-comment">// ä¸»å‡½æ•°</span>
    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">combine</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k)</span> {
        backtrack(<span class="hljs-number">1</span>, n, k);
        <span class="hljs-keyword">return</span> res;
    }

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrack</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-comment">// base case</span>
        <span class="hljs-keyword">if</span> (k == track.size()) {
            <span class="hljs-comment">// éå†åˆ°äº†ç¬¬ k å±‚ï¼Œæ”¶é›†å½“å‰èŠ‚ç‚¹çš„å€¼</span>
            res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;(track));
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å›æº¯ç®—æ³•æ ‡å‡†æ¡†æ¶</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt;= n; i++) {
            <span class="hljs-comment">// é€‰æ‹©</span>
            track.addLast(i);
            <span class="hljs-comment">// é€šè¿‡ start å‚æ•°æ§åˆ¶æ ‘æçš„éå†ï¼Œé¿å…äº§ç”Ÿé‡å¤çš„å­é›†</span>
            backtrack(i + <span class="hljs-number">1</span>, n, k);
            <span class="hljs-comment">// æ’¤é”€é€‰æ‹©</span>
            track.removeLast();
        }
    }
}
</code></pre>
<h2 data-id="heading-2">å›æº¯ç®—æ³•è§£å†³æ’åˆ—é—®é¢˜</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-comment">// è®°å½•å›æº¯ç®—æ³•çš„é€’å½’è·¯å¾„</span>
    LinkedList&lt;Integer&gt; track = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-comment">// track ä¸­çš„å…ƒç´ ä¼šè¢«æ ‡è®°ä¸º true</span>
    <span class="hljs-type">boolean</span>[] used;

    <span class="hljs-comment">/* ä¸»å‡½æ•°ï¼Œè¾“å…¥ä¸€ç»„ä¸é‡å¤çš„æ•°å­—ï¼Œè¿”å›å®ƒä»¬çš„å…¨æ’åˆ— */</span>
    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">permute</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> {
        used = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[nums.length];
        backtrack(nums);
        <span class="hljs-keyword">return</span> res;
    }

    <span class="hljs-comment">// å›æº¯ç®—æ³•æ ¸å¿ƒå‡½æ•°</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrack</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> {
        <span class="hljs-comment">// base caseï¼Œåˆ°è¾¾å¶å­èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (track.size() == nums.length) {
            <span class="hljs-comment">// æ”¶é›†å¶å­èŠ‚ç‚¹ä¸Šçš„å€¼</span>
            res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>(track));
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// å›æº¯ç®—æ³•æ ‡å‡†æ¡†æ¶</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length; i++) {
            <span class="hljs-comment">// å·²ç»å­˜åœ¨ track ä¸­çš„å…ƒç´ ï¼Œä¸èƒ½é‡å¤é€‰æ‹©</span>
            <span class="hljs-keyword">if</span> (used[i]) {
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-comment">// åšé€‰æ‹©</span>
            used[i] = <span class="hljs-literal">true</span>;
            track.addLast(nums[i]);
            <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€å±‚å›æº¯æ ‘</span>
            backtrack(nums);
            <span class="hljs-comment">// å–æ¶ˆé€‰æ‹©</span>
            track.removeLast();
            used[i] = <span class="hljs-literal">false</span>;
        }
    }
}
</code></pre>
<h2 data-id="heading-3">æ€»ç»“</h2>
<p>å›æº¯ç®—æ³•å°±æ˜¯ä¸ªå¤šå‰æ ‘çš„éå†é—®é¢˜ï¼Œå…³é”®å°±æ˜¯åœ¨å‰åºéå†å’Œååºéå†çš„ä½ç½®åšä¸€äº›æ“ä½œï¼Œç®—æ³•æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">...</span>):
    <span class="hljs-keyword">for</span> é€‰æ‹© <span class="hljs-keyword">in</span> é€‰æ‹©åˆ—è¡¨:
        åšé€‰æ‹©
        backtrack(...)
        æ’¤é”€é€‰æ‹©
</code></pre>
<p><strong>å†™ <code>backtrack</code> å‡½æ•°æ—¶ï¼Œéœ€è¦ç»´æŠ¤èµ°è¿‡çš„ã€Œè·¯å¾„ã€å’Œå½“å‰å¯ä»¥åšçš„ã€Œé€‰æ‹©åˆ—è¡¨ã€ï¼Œå½“è§¦å‘ã€Œç»“æŸæ¡ä»¶ã€æ—¶ï¼Œå°†ã€Œè·¯å¾„ã€è®°å…¥ç»“æœé›†</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hello AgentScope Java]]></title>    <link>https://juejin.cn/post/7588570963294535723</link>    <guid>https://juejin.cn/post/7588570963294535723</guid>    <pubDate>2025-12-29T05:29:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588570963294535723" data-draft-id="7588445332773158966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hello AgentScope Java"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ,Agent"/> <meta itemprop="datePublished" content="2025-12-29T05:29:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hello AgentScope Java
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T05:29:22.000Z" title="Mon Dec 29 2025 05:29:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šè¿œäº‘</p>
<p>éšç€ LLM åº”ç”¨çš„é£é€Ÿå‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„ Agent åº”ç”¨å¼€å§‹èµ°è¿‘æ¯ä¸ªäººã€‚å›´ç»•ç€ Agent åº”ç”¨çš„æ ¸å¿ƒï¼Œç›®å‰ä¸šç•Œæœ‰é›¶ä»£ç ã€ä½ä»£ç å’Œé«˜ä»£ç ä¸‰æ¡ä¸»æµçš„æŠ€æœ¯è·¯çº¿ã€‚AgentScope ä½œä¸º Python ç¤¾åŒºä¸­å—åˆ°å¹¿æ³›åº”ç”¨çš„é«˜ä»£ç æ¡†æ¶ï¼Œåœ¨ Java ç”Ÿæ€ä¸‹çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒÂ <strong>AgentScope Java v0.2 ç‰ˆæœ¬</strong>æ­£å¼å‘å¸ƒäº†ï¼Œå…·å¤‡äº†æ‰€æœ‰æ ¸å¿ƒçš„ ReActAgent çš„èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€æ€§åŸåˆ™ï¼šé€æ˜åº¦</h2>
<p>AgentScope çš„é¦–è¦è®¾è®¡ç›®æ ‡æ˜¯<strong>å¯¹å¼€å‘è€…é€æ˜</strong>ã€‚</p>
<p>å½“ä¸‹ï¼Œè®¸å¤š Agent æ¡†æ¶å°†åº•å±‚çš„è°ƒåº¦è¿›è¡Œäº†æ·±åº¦çš„å°è£…ï¼Œè¿™å›ºç„¶ä¼šç»™ç”¨æˆ·å¸¦æ¥ä¸€äº›æ¦‚å¿µä¸Šçš„ç®€åŒ–ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†é‡åˆ°é—®é¢˜æ—¶æ’æŸ¥çš„å¤æ‚åº¦ã€‚AgentScope ä¸åŒï¼š</p>
<ul>
<li><strong>Prompt Engineeringï¼š</strong> ç”¨æˆ·å¯ä»¥è‡ªå·±ä¿®æ”¹æ‰€æœ‰æç¤ºè¯ç›¸å…³çš„å†…å®¹ã€‚</li>
<li><strong>API è°ƒç”¨ï¼š</strong> æ¯ä¸€æ¬¡ API è°ƒç”¨éƒ½èƒ½å¤Ÿè¢«å®šä½ã€‚</li>
<li><strong>Agent æ„å»ºï¼š</strong> æ‰€æœ‰ Agent çš„é…ç½®éƒ½æ¥è‡ªç”¨æˆ·ç¡®å®šæ€§çš„é…ç½®ã€‚</li>
<li><strong>å†³ç­–è¿‡ç¨‹ï¼š</strong> Agent çš„æ¨ç†ã€æ‰§è¡Œè¿‡ç¨‹éƒ½å¯ä»¥é€šè¿‡ Hook å¯¹å¤–æš´éœ²ã€‚</li>
</ul>
<h2 data-id="heading-1">ä¸‰åˆ†é’Ÿæ„å»ºä¸€ä¸ªæ™ºèƒ½ä½“</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ™ºèƒ½ä½“ç¤ºä¾‹ï¼š</p>
<h3 data-id="heading-2">Maven ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.agentscope<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>agentscope-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">ReActAgent</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">class</span>Â <span class="hljs-selector-tag">HelloAgentScope</span>Â {
Â  Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">static</span>Â <span class="hljs-selector-tag">void</span>Â <span class="hljs-selector-tag">main</span>(String[]Â args)Â {
Â  Â  Â  Â Â <span class="hljs-comment">// åˆ›å»º ReActAgent</span>
Â  Â  Â  Â  <span class="hljs-selector-tag">ReActAgent</span> <span class="hljs-selector-tag">agent</span> = <span class="hljs-selector-tag">ReActAgent</span><span class="hljs-selector-class">.builder</span>()
Â  Â  Â  Â  Â  Â  <span class="hljs-selector-class">.name</span>(<span class="hljs-string">"Assistant"</span>)
Â  Â  Â  Â  Â  Â  <span class="hljs-selector-class">.model</span>(DashScopeChatModel.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">apiKey</span>(System.<span class="hljs-built_in">getenv</span>(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">modelName</span>(<span class="hljs-string">"qwen3-max"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  Â  Â  Â  Â  <span class="hljs-selector-class">.build</span>();
Â  Â  Â  Â Â <span class="hljs-comment">// è°ƒç”¨æ™ºèƒ½ä½“</span>
Â  Â  Â  Â  <span class="hljs-selector-tag">Msg</span> <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">agent</span><span class="hljs-selector-class">.call</span>(
Â  Â  Â  Â  Â  Â  Msg.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">role</span>(MsgRole.USER)
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">content</span>(TextBlock.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">text</span>(<span class="hljs-string">"ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>()
Â  Â  Â  Â  )<span class="hljs-selector-class">.block</span>();
Â  Â  Â  Â  <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(response.<span class="hljs-built_in">getTextContent</span>());
Â  Â  }
}
</code></pre>
<p>è‡³æ­¤ï¼Œä¸€ä¸ª Agent å°±æ„å»ºå®Œæˆäº†ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>ReActAgent</code>Â æ˜¯ AgentScope çš„æ ¸å¿ƒï¼Œæˆ‘ä»¬åé¢å‡ ä¹æ‰€æœ‰çš„åŠŸèƒ½éƒ½æ˜¯åŸºäºå®ƒçš„ã€‚</p>
<h2 data-id="heading-4">æ¶æ„æ¦‚è§ˆ</h2>
<p>å’Œ Python ç‰ˆæœ¬ç±»ä¼¼ï¼ŒAgentScope Java é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼š</p>
<h3 data-id="heading-5">åŸºç¡€ç»„ä»¶å±‚ï¼ˆFoundational Componentsï¼‰</h3>
<p><strong>Message</strong>ï¼šç»Ÿä¸€çš„æ¶ˆæ¯æŠ½è±¡å¯¹è±¡ï¼Œé€šè¿‡ä¸€å¥—æ•°æ®ç»“æ„æ”¯æŒæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€‚</p>
<p><strong>Model API</strong>ï¼šæ”¯æŒ DashScopeã€OpenAI ç­‰ä¸»æµæ¨¡å‹æä¾›å•†ã€‚é€šè¿‡ Formatter æœºåˆ¶å±è”½ä¸åŒæ¨¡å‹æä¾›å•†çš„æ ¼å¼å·®å¼‚ã€‚</p>
<p><strong>Tool</strong>ï¼šå…è®¸ç”¨æˆ·å®šä¹‰å·¥å…·ç»™ LLM ä½¿ç”¨ï¼Œæ”¯æŒåŒæ­¥/å¼‚æ­¥ã€æµå¼/éæµå¼ç­‰ API é£æ ¼ã€‚</p>
<h3 data-id="heading-6">æ™ºèƒ½ä½“åŸºç¡€è®¾æ–½å±‚ï¼ˆAgent-level Infrastructureï¼‰</h3>
<p><strong>ReAct èŒƒå¼</strong>ï¼šæ ¸å¿ƒ Agentic å®ç°ï¼Œé€šè¿‡æ¨ç†ï¼ˆReasoningï¼‰å†è¡ŒåŠ¨ï¼ˆActingï¼‰çš„è¿­ä»£å¾ªç¯ã€‚</p>
<p><strong>Agent Hooks</strong>ï¼šè¿è¡Œäº ReActAgent å†…éƒ¨ï¼Œå…è®¸ç”¨æˆ·å¯¹ Agent æ‰§è¡Œçš„è¿‡ç¨‹è¿›è¡Œç›‘æµ‹ã€ä¿®æ”¹ã€‚</p>
<p><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šä¼šè¯æŒä¹…åŒ–ç»„ä»¶ï¼Œæ”¯æŒç”¨æˆ·å¯¹è¯çŠ¶æ€çš„ä¿å­˜å’Œæ¢å¤ã€‚</p>
<h3 data-id="heading-7">å¤šæ™ºèƒ½ä½“åä½œå±‚ï¼ˆMulti-Agent Cooperationï¼‰</h3>
<p><strong>MsgHub</strong>ï¼šæ”¯æŒå¤šä¸ª Agent ä¹‹é—´å…±äº«æ¶ˆæ¯ï¼Œå®ç°å¤š Agent æ²Ÿé€šåä½œçš„å·¥å…·ã€‚</p>
<p><strong>Pipeline</strong>ï¼šç»„åˆå¤šä¸ª Agent æŒ‰ç…§ç‰¹å®šï¼ˆé¡ºåºã€å¹¶è¡Œç­‰ï¼‰ç­–ç•¥æ‰§è¡Œçš„å·¥å…·ã€‚</p>
<h3 data-id="heading-8">éƒ¨ç½²å±‚ï¼ˆDeploymentï¼‰</h3>
<p><strong>AgentScope Runtime</strong>ï¼šè§£å†³åˆ†å¸ƒå¼éƒ¨ç½²ä¸å®‰å…¨éš”ç¦»é—®é¢˜çš„ä¼ä¸šçº§è¿è¡Œæ—¶åŸºç¡€è®¾æ–½ï¼Œæä¾›å·¥å…·è¿è¡Œæ²™ç®±ã€A2A åè®®ã€è¿œç¨‹éƒ¨ç½²ç­‰èƒ½åŠ›ã€‚</p>
<p><strong>AgentScope Studio</strong>ï¼šæä¾›å¼€å‘é˜¶æ®µåˆ°è¿è¡Œé˜¶æ®µçš„å¯è§†åŒ–è°ƒè¯•ã€è§‚æµ‹èƒ½åŠ›ï¼Œä¸ºå¼€å‘è€…ä» 0 åˆ° 1 çš„å¼€å‘æé€Ÿã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf8363e331ea4525984b08cbabfea77e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767590961&amp;x-signature=N%2BTJvd%2BCs9XkR25K8NqZX4l2TFI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-9">Reasoning and Acting</h2>
<p>ReActï¼ˆReasoning and Actingï¼‰æ˜¯ AgentScope æœ€æ ¸å¿ƒçš„å®ç°èŒƒå¼ã€‚å…¶è®¾è®¡æ€è·¯å¾ˆç®€å•ï¼šå°†æ€è€ƒå’Œæ‰§è¡Œåˆ†ç¦»ï¼Œé€šè¿‡è¿­ä»£å¾ªç¯è§£å†³é—®é¢˜ã€‚</p>
<h3 data-id="heading-10">å·¥ä½œåŸç†</h3>
<p><strong>Reasoningï¼ˆæ¨ç†ï¼‰é˜¶æ®µ</strong>ï¼šAgent ä¼šåŸºäºå½“å‰çš„ä¸Šä¸‹æ–‡åˆ†æï¼Œå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼š</p>
<ul>
<li>ç†è§£ç”¨æˆ·æ„å›¾</li>
<li>è¯„ä¼°å·²æœ‰ä¿¡æ¯ï¼ˆä¸Šä¸‹æ–‡ï¼‰</li>
<li>ç¡®å®šéœ€è¦è°ƒç”¨çš„å·¥å…·åŠå‚æ•°</li>
</ul>
<p><strong>Actingï¼ˆè¡ŒåŠ¨ï¼‰é˜¶æ®µ</strong>ï¼šæ‰§è¡Œ Reasoning é˜¶æ®µæ‰€éœ€çš„è·å–æ•°æ®è¡Œä¸ºã€‚</p>
<ul>
<li>å¹¶è¡Œæ‰§è¡Œå·¥å…·è°ƒç”¨</li>
<li>æ”¶é›†æ‰§è¡Œç»“æœ</li>
<li>å°†ç»“æœè®¡å…¥è®°å¿†</li>
</ul>
<p><strong>è¿­ä»£æ§åˆ¶</strong>ï¼šReActAgent ä¼šä¸æ–­æ‰§è¡Œ Reasoning å’Œ Acting çš„è¿­ä»£ï¼Œå¦‚æœæ¨¡å‹åœ¨æœ€å¤§è¿­ä»£è½®å†…å®Œæˆè¿­ä»£åˆ™ä¼šæ­£å¸¸ç»“æŸï¼Œå¦‚æœæœªå®Œæˆåˆ™ä¼šè§¦å‘ summary çš„èƒ½åŠ›ï¼Œè¿›è¡Œä¼šè¯æ€»ç»“ã€‚</p>
<h3 data-id="heading-11">ä¸º ReActAgent æ·»åŠ å·¥å…·</h3>
<p>ä¸ºäº†è®© ReActAgent çœŸæ­£å¯ä»¥å®ç° Actingï¼Œéœ€è¦ä¸º ReActAgent æ·»åŠ å¯¹åº”çš„å·¥å…·ã€‚</p>
<p>è¿™é‡Œä»¥ä¸€ä¸ª Weather Assistant ä¸ºä¾‹å­ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// å®šä¹‰å·¥å…·ç±»</span>
<span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">class</span>Â <span class="hljs-selector-tag">WeatherTools</span>Â {
Â  Â Â <span class="hljs-variable">@Tool</span>(description =Â <span class="hljs-string">"è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"</span>)
Â  Â Â publicÂ StringÂ <span class="hljs-built_in">getWeather</span>(
Â  Â  Â  Â Â <span class="hljs-variable">@ToolParam</span>(name =Â <span class="hljs-string">"city"</span>, description =Â <span class="hljs-string">"åŸå¸‚åç§°"</span>)Â StringÂ city) {
Â  Â  Â  Â Â <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­è°ƒç”¨å¤©æ°” API</span>
Â  Â  Â  Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">String</span><span class="hljs-selector-class">.format</span>(<span class="hljs-string">"%sï¼šæ™´å¤©ï¼Œæ°”æ¸© 25 â„ƒ"</span>, city);
Â  Â  }
}
<span class="hljs-comment">// æ³¨å†Œå·¥å…·</span>
<span class="hljs-selector-tag">Toolkit</span>Â <span class="hljs-selector-tag">toolkit</span> =Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">Toolkit</span>();
<span class="hljs-selector-tag">toolkit</span><span class="hljs-selector-class">.registerTool</span>(newÂ <span class="hljs-built_in">WeatherTools</span>());
<span class="hljs-comment">// æ„å»ºå¸¦å·¥å…·çš„ ReActAgent</span>
<span class="hljs-selector-tag">ReActAgent</span>Â <span class="hljs-selector-tag">agent</span> =Â <span class="hljs-selector-tag">ReActAgent</span><span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>(<span class="hljs-string">"WeatherAssistant"</span>)
Â  Â  <span class="hljs-selector-class">.sysPrompt</span>(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå¤©æ°”åŠ©æ‰‹ï¼Œå¯ä»¥æŸ¥è¯¢åŸå¸‚å¤©æ°”ä¿¡æ¯ã€‚"</span>)
Â  Â  <span class="hljs-selector-class">.model</span>(DashScopeChatModel.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  .<span class="hljs-built_in">apiKey</span>(System.<span class="hljs-built_in">getenv</span>(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
Â  Â  Â  Â  .<span class="hljs-built_in">modelName</span>(<span class="hljs-string">"qwen3-max"</span>)
Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  <span class="hljs-selector-class">.toolkit</span>(toolkit)
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// è°ƒç”¨æ™ºèƒ½ä½“</span>
<span class="hljs-selector-tag">Msg</span>Â <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">agent</span><span class="hljs-selector-class">.call</span>(
Â  Â Â Msg.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">role</span>(MsgRole.USER)
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">content</span>(TextBlock.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">text</span>(<span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>()
)<span class="hljs-selector-class">.block</span>();
</code></pre>
<p>æ‰§è¡Œæµç¨‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·é—®é¢˜ï¼šåŒ—äº¬ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ
Â  Â  â†“
<span class="hljs-selector-attr">[æ¨ç†]</span>Â éœ€è¦æŸ¥å¤©æ°”ï¼Œå†³å®šè°ƒç”¨ <span class="hljs-built_in">getWeather</span>("åŒ—äº¬")
Â  Â  â†“
<span class="hljs-selector-attr">[è¡ŒåŠ¨]</span>Â æ‰§è¡Œå·¥å…· â†’ "åŒ—äº¬ï¼šæ™´å¤©ï¼Œæ°”æ¸©Â <span class="hljs-number">25</span>â„ƒ"
Â  Â  â†“
<span class="hljs-selector-attr">[æ¨ç†]</span>Â å·²è·å–ä¿¡æ¯ï¼Œç”Ÿæˆå›ç­”
Â  Â  â†“
å›ç­”ï¼šæ ¹æ®æŸ¥è¯¢ç»“æœï¼ŒåŒ—äº¬ä»Šå¤©æ™´å¤©ï¼Œæ°”æ¸©Â <span class="hljs-number">25</span>â„ƒ
</code></pre>
<h2 data-id="heading-12">ReActAgent æ ¸å¿ƒç‰¹æ€§</h2>
<p>é™¤äº†åŸºç¡€çš„ Reasoning å’Œ Acting èƒ½åŠ›ï¼ŒAgentScope çš„ ReActAgent è¿˜å…·å¤‡å¤šä¸ªç‰¹æ€§ã€‚</p>
<h3 data-id="heading-13">1. å¤šæ¨¡æ€æ¶ˆæ¯æ”¯æŒ</h3>
<p>ReActAgent å¯ä»¥å¤„ç†å¤šæ¨¡æ€è¾“å…¥ï¼Œä¸é™äºçº¯æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// åˆ›å»ºæ”¯æŒè§†è§‰çš„ ReActAgentï¼ˆä½¿ç”¨è§†è§‰æ¨¡å‹ï¼‰</span>
<span class="hljs-selector-tag">ReActAgent</span>Â <span class="hljs-selector-tag">visionAgent</span>Â =Â <span class="hljs-selector-tag">ReActAgent</span><span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>(<span class="hljs-string">"VisionAssistant"</span>)
Â  Â  <span class="hljs-selector-class">.model</span>(DashScopeChatModel.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  .<span class="hljs-built_in">apiKey</span>(System.<span class="hljs-built_in">getenv</span>(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
Â  Â  Â  Â  .<span class="hljs-built_in">modelName</span>(<span class="hljs-string">"qwen3-vl-plus"</span>) Â <span class="hljs-comment">// è§†è§‰æ¨¡å‹</span>
Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// å‘é€åŒ…å«å›¾ç‰‡çš„æ¶ˆæ¯</span>
<span class="hljs-selector-tag">Msg</span>Â <span class="hljs-selector-tag">response</span>Â =Â <span class="hljs-selector-tag">visionAgent</span><span class="hljs-selector-class">.call</span>(
Â  Â  Msg.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  .<span class="hljs-built_in">role</span>(MsgRole.USER)
Â  Â  Â  Â  .<span class="hljs-built_in">content</span>(List.<span class="hljs-built_in">of</span>(
Â  Â  Â  Â  Â  Â  TextBlock.<span class="hljs-built_in">builder</span>().<span class="hljs-built_in">text</span>(<span class="hljs-string">"è¯·åˆ†æè¿™å¼ å›¾ç‰‡çš„å†…å®¹"</span>).<span class="hljs-built_in">build</span>(),
Â  Â  Â  Â  Â  Â  ImageBlock.<span class="hljs-built_in">builder</span>().<span class="hljs-built_in">source</span>(URLSource.<span class="hljs-built_in">builder</span>().url(<span class="hljs-string">"https://example.com/image.jpg"</span>).<span class="hljs-built_in">build</span>()).<span class="hljs-built_in">build</span>()
Â  Â  Â  Â  ))
Â  Â  Â  Â  .<span class="hljs-built_in">build</span>()
)<span class="hljs-selector-class">.block</span>();
</code></pre>
<p>æ”¯æŒçš„å¤šæ¨¡æ€å†…å®¹ç±»å‹ï¼šTextBlockã€ImageBlockã€AudioBlockã€VideoBlockã€‚</p>
<h3 data-id="heading-14">2. é’©å­æœºåˆ¶</h3>
<p>ä¸º ReActAgent æ·»åŠ é’©å­ï¼Œç›‘æ§å’Œæ‰©å±•å…¶è¡Œä¸ºã€‚è¿™é‡Œä»¥å‰æ–‡ä¸­ç”¨åˆ°çš„ WeatherAssistant ä¸ºä¾‹å­æ·»åŠ é’©å­ï¼Œå®æ—¶çœ‹åˆ°æ™ºèƒ½ä½“çš„æ€è€ƒå’Œæ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">// å®šä¹‰è°ƒè¯•é’©å­ï¼Œæ˜¾ç¤ºå®Œæ•´çš„ ReAct æ‰§è¡Œè¿‡ç¨‹
Hook debugHook = <span class="hljs-built_in">new</span> Hook() {
Â  Â  @Override
Â  Â  <span class="hljs-keyword">public</span> &lt;T extends HookEvent&gt; Mono&lt;T&gt; onEvent(T <span class="hljs-keyword">event</span>) {
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â  Â  Â  switch (<span class="hljs-keyword">event</span>) {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">case</span>Â PreReasoningEvent e -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System.out.println(<span class="hljs-string">"\n[æ¨ç†] æ™ºèƒ½ä½“å¼€å§‹æ€è€ƒ..."</span>);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">case</span>Â PostReasoningEvent e -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System.out.println(<span class="hljs-string">"[æ¨ç†] æ¨ç†ç»“æœï¼š"</span>Â + <span class="hljs-built_in">new</span> ObjectMapper().writeValueAsString(e.getReasoningMessage()));
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">case</span>Â PostActingEvent e -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System.out.println(<span class="hljs-string">"[è¡ŒåŠ¨] æ‰§è¡Œå·¥å…· â†’ "</span>Â + <span class="hljs-built_in">new</span> ObjectMapper().writeValueAsString(e.getToolResult()));
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">case</span>Â PostCallEvent e -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System.out.println(<span class="hljs-string">"[æ¨ç†] å·²è·å–ä¿¡æ¯ï¼Œç”Ÿæˆå›ç­”"</span>);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System.out.println(<span class="hljs-string">"å›ç­”ï¼š"</span>Â + e.getFinalMessage().getTextContent());
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">default</span> -&gt; {}
Â  Â  Â  Â  Â  Â  } ;
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
Â  Â  Â  Â  Â  Â  ...
Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â Mono.just(<span class="hljs-keyword">event</span>);
Â  Â  }
};
// å°†é’©å­æ·»åŠ åˆ° WeatherAssistant
ReActAgent weatherAgent = ReActAgent.builder()
Â  Â  .name(<span class="hljs-string">"WeatherAssistant"</span>)
Â  Â  .sysPrompt(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå¤©æ°”åŠ©æ‰‹ï¼Œå¯ä»¥æŸ¥è¯¢åŸå¸‚å¤©æ°”ä¿¡æ¯ã€‚"</span>)
Â  Â  .model(DashScopeChatModel.builder()
Â  Â  Â  Â  Â  Â .apiKey(System.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>))
Â  Â  Â  Â  Â  Â .modelName(<span class="hljs-string">"qwen3-max"</span>)
Â  Â  Â  Â  Â  Â .build())
Â  Â  .toolkit(toolkit) // å‰æ–‡ä¸­å®šä¹‰çš„ Toolkit
Â  Â  .hook(debugHook) Â // æ·»åŠ è°ƒè¯•é’©å­
Â  Â  .build();
// æŸ¥è¯¢å¤©æ°”
Msg response = weatherAgent.<span class="hljs-keyword">call</span>(
Â  Â  Msg.builder()
Â  Â  .role(MsgRole.USER)
Â  Â  .content(TextBlock.builder()
Â  Â  Â  Â  Â  Â  Â .<span class="hljs-keyword">text</span>(<span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ"</span>)
Â  Â  Â  Â  Â  Â  Â .build())
Â  Â  .build()
).block();
// è¾“å‡ºç¤ºä¾‹ï¼š
// [æ¨ç†] æ™ºèƒ½ä½“å¼€å§‹æ€è€ƒ...
// [æ¨ç†] æ¨ç†ç»“æœï¼š{<span class="hljs-string">"id"</span>:<span class="hljs-string">"xxx"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"WeatherAssistant"</span>,<span class="hljs-string">"role"</span>:<span class="hljs-string">"ASSISTANT"</span>,<span class="hljs-string">"content"</span>:[{<span class="hljs-string">"type"</span>:<span class="hljs-string">"tool_use"</span>,<span class="hljs-string">"id"</span>:<span class="hljs-string">"call_xxx"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"getWeather"</span>,<span class="hljs-string">"input"</span>:{<span class="hljs-string">"city"</span>:<span class="hljs-string">"åŒ—äº¬"</span>},<span class="hljs-string">"content"</span>:null}],<span class="hljs-string">"metadata"</span>:null,<span class="hljs-string">"timestamp"</span>:<span class="hljs-string">"xxx"</span>}
// [è¡ŒåŠ¨] æ‰§è¡Œå·¥å…· â†’ {<span class="hljs-string">"type"</span>:<span class="hljs-string">"tool_result"</span>,<span class="hljs-string">"id"</span>:<span class="hljs-string">"call_xxx"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"getWeather"</span>,<span class="hljs-string">"output"</span>:[{<span class="hljs-string">"type"</span>:<span class="hljs-string">"text"</span>,<span class="hljs-string">"text"</span>:<span class="hljs-string">"\"</span>åŒ—äº¬ï¼šæ™´å¤©ï¼Œæ°”æ¸© <span class="hljs-number">25</span> â„ƒ\<span class="hljs-string">""</span>}],<span class="hljs-string">"metadata"</span>:{}}
// [æ¨ç†] æ™ºèƒ½ä½“å¼€å§‹æ€è€ƒ...
// [æ¨ç†] æ¨ç†ç»“æœï¼š{<span class="hljs-string">"id"</span>:<span class="hljs-string">"xxx"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"WeatherAssistant"</span>,<span class="hljs-string">"role"</span>:<span class="hljs-string">"ASSISTANT"</span>,<span class="hljs-string">"content"</span>:[{<span class="hljs-string">"type"</span>:<span class="hljs-string">"text"</span>,<span class="hljs-string">"text"</span>:<span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ°”æ¸©ä¸º25â„ƒã€‚å»ºè®®å¤–å‡ºæ—¶æ³¨æ„é˜²æ™’ï¼Œç¥æ‚¨æ‹¥æœ‰æ„‰å¿«çš„ä¸€å¤©ï¼"</span>}],<span class="hljs-string">"metadata"</span>:null,<span class="hljs-string">"timestamp"</span>:<span class="hljs-string">"xxx"</span>}
// [æ¨ç†] å·²è·å–ä¿¡æ¯ï¼Œç”Ÿæˆå›ç­”
// å›ç­”ï¼šåŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ°”æ¸©ä¸º<span class="hljs-number">25</span>â„ƒã€‚å»ºè®®å¤–å‡ºæ—¶æ³¨æ„é˜²æ™’ï¼Œç¥æ‚¨æ‹¥æœ‰æ„‰å¿«çš„ä¸€å¤©ï¼
</code></pre>
<h3 data-id="heading-15">3. ä¼šè¯æŒä¹…åŒ–</h3>
<p>ä¿å­˜å’Œæ¢å¤ ReActAgent çš„çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆ›å»º ReActAgent</span>
ReActAgentÂ agentÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("PersistentAgent")
Â  Â  <span class="hljs-selector-class">.model</span>(DashScopeChatModel.builder()
Â  Â  Â  Â  <span class="hljs-selector-class">.apiKey</span>(System.getenv("DASHSCOPE_API_KEY"))
Â  Â  Â  Â  <span class="hljs-selector-class">.modelName</span>("qwen3-max")
Â  Â  Â  Â  <span class="hljs-selector-class">.build</span>())
Â  Â  <span class="hljs-selector-class">.memory</span>(newÂ InMemoryMemory())
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// ä¿å­˜ä¼šè¯</span>
SessionManager<span class="hljs-selector-class">.forSessionId</span>("session-<span class="hljs-number">001</span>")
Â  Â  <span class="hljs-selector-class">.withJsonSession</span>(Path.of("./sessions"))
Â  Â  <span class="hljs-selector-class">.addComponent</span>(agent)
Â  Â  <span class="hljs-selector-class">.saveSession</span>();
<span class="hljs-comment">// ä¸‹æ¬¡å¯åŠ¨æ—¶æ¢å¤</span>
SessionManager<span class="hljs-selector-class">.forSessionId</span>("session-<span class="hljs-number">001</span>")
Â  Â  <span class="hljs-selector-class">.withJsonSession</span>(Path.of("./sessions"))
Â  Â  <span class="hljs-selector-class">.addComponent</span>(agent)
Â  Â  <span class="hljs-selector-class">.loadIfExists</span>();
<span class="hljs-comment">// agent ç°åœ¨æ¢å¤åˆ°äº†ä¹‹å‰çš„çŠ¶æ€ï¼Œå¯ä»¥ç»§ç»­å¯¹è¯</span>
</code></pre>
<h3 data-id="heading-16">4. ç»“æ„åŒ–è¾“å‡º</h3>
<p>è®© ReActAgent è¿”å›ç±»å‹å®‰å…¨çš„ç»“æ„åŒ–æ•°æ®ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// å®šä¹‰è¾“å‡ºç»“æ„</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">WeatherReport</span>Â {
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-type">String</span> city;
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-type">int</span>Â temperature;
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-type">String</span> condition;
Â  Â Â <span class="hljs-keyword">public</span>Â List&lt;<span class="hljs-type">String</span>&gt; suggestions;
}
<span class="hljs-comment">// ReActAgent è°ƒç”¨æ—¶æŒ‡å®šè¾“å‡ºç±»å‹</span>
Msg response = agent.<span class="hljs-built_in">call</span>(
Â  Â  Msg.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">role</span>(MsgRole.USER)
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">content</span>(TextBlock.<span class="hljs-built_in">builder</span>()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">text</span>(<span class="hljs-string">"åˆ†æåŒ—äº¬çš„å¤©æ°”å¹¶ç»™å‡ºå»ºè®®"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>())
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-built_in">build</span>(),
Â  Â  WeatherReport.<span class="hljs-keyword">class</span>Â Â <span class="hljs-comment">// æŒ‡å®šç»“æ„åŒ–è¾“å‡ºç±»å‹</span>
).<span class="hljs-built_in">block</span>();
<span class="hljs-comment">// æå–ç»“æ„åŒ–æ•°æ®</span>
WeatherReport report = response.<span class="hljs-built_in">getStructuredData</span>(WeatherReport.<span class="hljs-keyword">class</span>);
System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"åŸå¸‚: "</span>Â + report.city);
System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"æ¸©åº¦: "</span>Â + report.temperature);
</code></pre>
<p>é¿å…äº†æ–‡æœ¬è§£æçš„ä¸ç¡®å®šæ€§ï¼Œç¼–è¯‘æœŸå°±èƒ½å‘ç°ç±»å‹é”™è¯¯ã€‚</p>
<h3 data-id="heading-17">5. å¤šæ™ºèƒ½ä½“åä½œ</h3>
<p>å¤šä¸ª ReActAgent å¯ä»¥é€šè¿‡ Pipeline åä½œï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆ›å»ºæ¨¡å‹é…ç½®</span>
DashScopeChatModelÂ modelÂ =Â DashScopeChatModel<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.apiKey</span>(System.getenv("DASHSCOPE_API_KEY"))
Â  Â  <span class="hljs-selector-class">.modelName</span>("qwen3-max")
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// åˆ›å»ºå¤šä¸ª ReActAgent</span>
ReActAgentÂ dataCollectorÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("DataCollector")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.build</span>();
ReActAgentÂ dataAnalyzerÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("DataAnalyzer")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.build</span>();
ReActAgentÂ reportGeneratorÂ =Â ReActAgent<span class="hljs-selector-class">.builder</span>()
Â  Â  <span class="hljs-selector-class">.name</span>("ReportGenerator")
Â  Â  <span class="hljs-selector-class">.model</span>(model)
Â  Â  <span class="hljs-selector-class">.build</span>();
<span class="hljs-comment">// é¡ºåºæ‰§è¡Œï¼šæ™ºèƒ½ä½“ä¾æ¬¡å¤„ç†</span>
MsgÂ resultÂ =Â Pipelines<span class="hljs-selector-class">.sequential</span>(
Â  Â  List.of(dataCollector, dataAnalyzer, reportGenerator),
Â  Â  inputMsg
)<span class="hljs-selector-class">.block</span>();
<span class="hljs-comment">// å¹¶è¡Œæ‰§è¡Œï¼šå¤šä¸ªæ™ºèƒ½ä½“åŒæ—¶å¤„ç†</span>
List&lt;Msg&gt; results = Pipelines<span class="hljs-selector-class">.fanout</span>(
Â  Â  List.of(dataCollector, dataAnalyzer, reportGenerator),Â 
Â  Â  inputMsg
)<span class="hljs-selector-class">.block</span>();
</code></pre>
<h2 data-id="heading-18">Roadmap</h2>
<p>AgentScope Java è‡ª 2025 å¹´ 9 æœˆå¼€æºä»¥æ¥ï¼Œå½“å‰ v0.2 ç‰ˆæœ¬å·²å…·å¤‡ ReActAgent æ ¸å¿ƒèƒ½åŠ›ã€‚</p>
<p>æˆ‘ä»¬è®¡åˆ’äº 11 æœˆåº•å‘å¸ƒ v1.0 ç‰ˆæœ¬ï¼Œå±Šæ—¶å°†æ–°å¢ RAGã€Planã€Tracingã€Evaluation åŠ Studio ç­‰å…¨å¥—åŠŸèƒ½ï¼Œæ ‡å¿—ç€æ¡†æ¶æ­£å¼ç”Ÿäº§å¯ç”¨ï¼›Runtime v1.0 ä¹Ÿå°†åŒæ­¥ä¸Šçº¿ï¼Œæä¾›æ¶µç›–å®‰å…¨æ²™ç®±ã€A2A Agent åœ¨å†…çš„ä¼ä¸šçº§è½åœ°æ–¹æ¡ˆã€‚éšååœ¨ 12 æœˆï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥æ¨å‡ºåŸºäº ReMe çš„ä¸Šä¸‹æ–‡ç®¡ç†ä¸åŸºäº Trinity-RFT çš„å¼ºåŒ–å­¦ä¹ æœ€ä½³å®è·µã€‚</p>
<p>åœ¨æŠ€æœ¯æ¼”è¿›å±‚é¢ï¼Œæˆ‘ä»¬æ­£æŒç»­æ¢ç´¢æ›´é«˜æ•ˆã€æ™ºèƒ½çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸å¤š Agent ååŒèŒƒå¼ï¼Œè‡´åŠ›äºæ”¯æ’‘æ›´å¼ºå¤§çš„ AI åº”ç”¨æ„å»ºã€‚æ­¤å¤–ï¼Œé’ˆå¯¹ Agent æµé‡å‘ˆç°çš„â€œäºŒå…«å®šå¾‹â€ç‰¹å¾ï¼ˆå¤´éƒ¨ 20% çš„ Agent æ‰¿è½½äº† 80% çš„æµé‡ï¼‰ï¼Œæˆ‘ä»¬åœ¨æ¶æ„ä¸Šå…¨åŠ›æ¨è¿› Serverless åŒ–ï¼Œé€šè¿‡å®ç°æ¯«ç§’çº§å†·å¯åŠ¨ä¸æ··åˆéƒ¨ç½²ï¼Œå¸®åŠ©å¼€å‘è€…åœ¨åº”å¯¹é«˜å¹¶å‘çš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½éƒ¨ç½²æˆæœ¬å¹¶æå‡æ•ˆç‡ã€‚</p>
<h2 data-id="heading-19">æœªå®Œå¾…ç»­</h2>
<p>æœ¬æ–‡ä½œä¸º AgentScope Java ç³»åˆ—æ¨æ–‡çš„é¦–ç¯‡ï¼Œå—ç¯‡å¹…é™åˆ¶åªèƒ½æŠ›ç –å¼•ç‰ï¼Œåœ¨æ¥ä¸‹æ¥è¿˜ä¼šæœ‰æ›´å¤šçš„å¹²è´§ï¼š</p>
<ol>
<li>AgentScope Runtimeï¼šå¸®åŠ©å¼€å‘è€…å®ç° Agent åº”ç”¨ä» 1 åˆ° 100ï¼Œæä¾›å·¥å…·è¿è¡Œæ²™ç®±ã€A2A åè®®ã€è¿œç¨‹éƒ¨ç½²ç­‰å¼ºå¤§èƒ½åŠ›ã€‚</li>
<li>Agent å¼€å‘èŒƒå¼è®¨è®ºï¼šWorkflow or Agenticï¼ŸAgentScope åŸºäºç‹¼äººæ€æ¸¸æˆçš„ Agent å®è·µåˆ†äº«ã€‚</li>
<li>Meta Toolï¼šé¢å¯¹æ—¥ç›Šè†¨èƒ€çš„ Tool Definitionï¼ŒAgentScope çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li>Planï¼šä½¿ Agent èƒ½å¤Ÿè‡ªä¸»æ‹†è§£å¤æ‚ä»»åŠ¡å¹¶ç³»ç»Ÿæ€§åœ°æ‰§è¡Œã€‚</li>
</ol>
<p>å¦‚æœä½ è§‰å¾— AgentScope Java ä¸é”™ï¼Œæ¬¢è¿ç»™æˆ‘ä»¬çš„é¡¹ç›® Star~<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fagentscope-ai%2Fagentscope-java" target="_blank" title="https://github.com/agentscope-ai/agentscope-java" ref="nofollow noopener noreferrer">github.com/agentscope-â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenDeRiskï¼šAI åŸç”Ÿé£é™©æ™ºèƒ½ç³»ç»Ÿ â€”â€”7*24H åº”ç”¨ç³»ç»ŸAIæ•°å­—è¿ç»´åŠ©æ‰‹(AI-SRE)]]></title>    <link>https://juejin.cn/post/7588745319400243200</link>    <guid>https://juejin.cn/post/7588745319400243200</guid>    <pubDate>2025-12-29T00:38:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588745319400243200" data-draft-id="7537711310580105216" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenDeRiskï¼šAI åŸç”Ÿé£é™©æ™ºèƒ½ç³»ç»Ÿ â€”â€”7*24H åº”ç”¨ç³»ç»ŸAIæ•°å­—è¿ç»´åŠ©æ‰‹(AI-SRE)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-29T00:38:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YL_jia"/> <meta itemprop="url" content="https://juejin.cn/user/1467226241383211"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenDeRiskï¼šAI åŸç”Ÿé£é™©æ™ºèƒ½ç³»ç»Ÿ â€”â€”7*24H åº”ç”¨ç³»ç»ŸAIæ•°å­—è¿ç»´åŠ©æ‰‹(AI-SRE)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1467226241383211/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YL_jia
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T00:38:33.000Z" title="Mon Dec 29 2025 00:38:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">OpenDeRiskï¼šAI é©±åŠ¨çš„æ™ºèƒ½è¿ç»´æ ¹å› åˆ†æç³»ç»Ÿå®æˆ˜æŒ‡å—</h2>
<blockquote>
<p>åœ¨ç³»ç»Ÿæ•…éšœå¯¼è‡´ç™¾ä¸‡çº§æŸå¤±çš„æ•°å­—åŒ–æ—¶ä»£ï¼Œ<strong>OpenDeRisk ç”¨å¤šä»£ç†åä½œä¸å¯è§†åŒ–è¯æ®é“¾ï¼Œè®©æ ¹å› è¯Šæ–­ä»â€œå¤§æµ·æé’ˆâ€å˜ä¸ºâ€œç²¾å‡†å¯¼èˆªâ€</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-1">å¼•è¨€ï¼šå½“æ•…éšœè¯Šæ–­é‡ä¸Šå¤šä»£ç†AIé©å‘½</h3>
<p>å‡Œæ™¨ 3 ç‚¹çš„å‘Šè­¦çŸ­ä¿¡ã€æŒç»­ 6 å°æ—¶çš„æ•…éšœå®šä½ã€è·¨å›¢é˜Ÿä¼šè®®ä¸Šçš„äº’ç›¸æ¨è¯¿â€”â€”ä¼ ç»Ÿè¿ç»´çš„æ ¹å› åˆ†æï¼ˆRCAï¼‰å¸¸é™·å…¥<strong>æ•°æ®å­¤å²›</strong>ä¸<strong>ç»éªŒä¾èµ–</strong>çš„å›°å±€ã€‚æŸäº’è”ç½‘å…¬å¸çš„ç»Ÿè®¡æ˜¾ç¤ºï¼Œè¶…è¿‡ 65% çš„æ•…éšœæ¢å¤æ—¶é—´è¢«æ¶ˆè€—åœ¨é—®é¢˜å®šä½ç¯èŠ‚ã€‚è€Œ OpenDeRisk ä½œä¸ºå¼€æº AI è¿ç»´ç³»ç»Ÿï¼Œé€šè¿‡å¤šä»£ç†åä½œæ¶æ„å®ç°äº†<strong>æ—¥å¿—åˆ†æ-&gt;ä»£ç è¿½è¸ª-&gt;è¯æ®é“¾å¯è§†åŒ–</strong>çš„è‡ªåŠ¨åŒ–é—­ç¯ï¼Œå°† RCA æ•ˆç‡æå‡ 10 å€ä»¥ä¸Šã€‚æœ¬æ–‡å°†å¸¦æ‚¨æ·±å…¥è¿™ä¸€é¢ è¦†æ€§å·¥å…·çš„æŠ€æœ¯å†…æ ¸ä¸è½åœ°å®è·µã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€æ ¸å¿ƒåŠŸèƒ½è§£æï¼šå¤šä»£ç†åä½œå¦‚ä½•é‡å¡‘æ•…éšœè¯Šæ–­</h3>
<h4 data-id="heading-3">1. æ¶æ„å…¨æ™¯ï¼šäº”å¤§ä»£ç†çš„ååŒä½œæˆ˜</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
A[Data-Agent] --&gt;|åŸå§‹æ—¥å¿—/è·Ÿè¸ªæ•°æ®| B(SRE-Agent)
B --&gt;|é—®é¢˜å‡è®¾| C(Code-Agent)
C --&gt;|åŠ¨æ€ç”Ÿæˆè¯Šæ–­ä»£ç | D(Vis-Agent)
D --&gt;|å¯è§†åŒ–è¯æ®é“¾| E(ReportAgent)
E --&gt;|å¯æ‰§è¡ŒæŠ¥å‘Š| F[ç”¨æˆ·]
</code></pre>
<p><em>å›¾ï¼šOpenDeRisk å¤šä»£ç†åä½œæµç¨‹å›¾ï¼Œå®ç°ä»æ•°æ®åˆ°å†³ç­–çš„è‡ªåŠ¨åŒ–</em></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65f3a33084f040f2b3ac37531503e2ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767573512&amp;x-signature=NrW8FvKerV5%2FqQyrZlp%2F9gE%2FZ%2Fc%3D" alt="image.png" loading="lazy"/>
å„ä»£ç†çš„æ ¸å¿ƒèŒè´£ï¼š</p>
<ul>
<li><strong>SRE-Agent</strong>ï¼šé—®é¢˜åˆæ­¥å®šä½ï¼Œç”Ÿæˆæ ¹å› å‡è®¾ï¼ˆåŸºäºå†å²æ•…éšœæ¨¡å¼åº“ï¼‰</li>
<li><strong>Code-Agent</strong>ï¼šåŠ¨æ€ç”Ÿæˆ Python è¯Šæ–­è„šæœ¬ï¼ŒéªŒè¯å‡è®¾</li>
<li><strong>Data-Agent</strong>ï¼šå¯¹æ¥æ—¥å¿—ç³»ç»Ÿï¼ˆELKï¼‰ã€è¿½è¸ªç³»ç»Ÿï¼ˆJaegerï¼‰ã€ç›‘æ§æ•°æ®ï¼ˆPrometheusï¼‰</li>
<li><strong>Vis-Agent</strong>ï¼šé€šè¿‡ D3.js æ¸²æŸ“äº¤äº’å¼è¯æ®é“¾è§†å›¾</li>
<li><strong>ReportAgent</strong>ï¼šç”ŸæˆåŒ…å«ä¿®å¤å»ºè®®çš„ Markdown/PDF æŠ¥å‘Š</li>
</ul>
<h4 data-id="heading-4">2. çªç ´æ€§èƒ½åŠ›ï¼šä»â€œçŒœæµ‹â€åˆ°â€œå®è¯â€</h4>
<ul>
<li><strong>æ·±åº¦ç ”ç©¶ RCA</strong><br/>
èåˆæ—¥å¿—æ¨¡å¼è¯†åˆ«ã€ä»£ç é€»è¾‘å›æº¯ã€èµ„æºæ—¶åºåˆ†æä¸‰é‡è§†è§’ï¼Œé¿å…å•ä¸€æ•°æ®æºè¯¯åˆ¤</li>
<li><strong>åŠ¨æ€ä»£ç ç”Ÿæˆ</strong><br/>
å½“æ£€æµ‹åˆ°æ•°æ®åº“è¿æ¥æ± è€—å°½æ—¶ï¼ŒCode-Agent è‡ªåŠ¨ç”Ÿæˆè¿æ¥æ³„æ¼æ£€æµ‹è„šæœ¬ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŠ¨æ€ç”Ÿæˆçš„è¯Šæ–­è„šæœ¬ç¤ºä¾‹</span>
<span class="hljs-keyword">from</span> dbtools <span class="hljs-keyword">import</span> analyze_connection_leak
leak_report = analyze_connection_leak(
    log_path=<span class="hljs-string">"/var/log/app/db.log"</span>, 
    trace_id=<span class="hljs-string">"req-0x7fd3a"</span>
)
<span class="hljs-built_in">print</span>(leak_report.top_candidates(<span class="hljs-number">3</span>))
</code></pre>
</li>
<li><strong>è¯æ®é“¾å¯è§†åŒ–</strong><br/>
å°† 200+ æ¡åˆ†æ•£æ—¥å¿—ã€40 ä¸ªæœåŠ¡è°ƒç”¨èŠ‚ç‚¹ï¼Œèšåˆä¸ºå•å¼ æ—¶é—´è½´äº¤äº’è§†å›¾ï¼š</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/335aad20e6ef4d4e9861f645b584bef6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767573512&amp;x-signature=hL7Vsr5Yjv3sK7T5yFNNQ2coKSo%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3682c2bf61147b2bbc69220e6c86c36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767573512&amp;x-signature=IGNXCSKgKVRJs3dMvgVqrxpq9Ik%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">3. ä¼ä¸šçº§æ‰©å±•èƒ½åŠ›</h4>
<ul>
<li><strong>é‡‘èçº§åˆè§„</strong>ï¼šå®¡è®¡æ—¥å¿—ç•™å­˜ 7 å¹´ï¼Œæ”¯æŒ GDPR/ç­‰ä¿ 3.0</li>
<li><strong>æ’ä»¶åŒ–æ¶æ„</strong>ï¼šå¯æ‰©å±•æ”¯æŒ Kafka/Pulsar ç­‰æ¶ˆæ¯ä¸­é—´ä»¶è¯Šæ–­</li>
<li><strong>å¤šäº‘é€‚é…</strong>ï¼šå·²éªŒè¯é€‚é… AWS CloudWatchã€Azure Monitorã€GCP Stackdriver</li>
</ul>
<hr/>
<h3 data-id="heading-6">äºŒã€å®‰è£…éƒ¨ç½²å®æˆ˜ï¼š5 ç§æ¨¡å¼åº”å¯¹ä¸åŒåœºæ™¯</h3>
<h4 data-id="heading-7">1. ç¯å¢ƒè§„åˆ’å»ºè®®</h4>









































<table><thead><tr><th><strong>éƒ¨ç½²æ¨¡å¼</strong></th><th>é€‚ç”¨åœºæ™¯</th><th>ç¡¬ä»¶è¦æ±‚</th><th>ç½‘ç»œè¦æ±‚</th></tr></thead><tbody><tr><td>çº¯ä»£ç†æ¨¡å¼</td><td>åˆåˆ›å›¢é˜Ÿ/POC</td><td>4C8Gï¼Œæ—  GPU</td><td>å¯è®¿é—® DeepSeek/OpenAI API</td></tr><tr><td>æœ¬åœ°è½»é‡æ¨¡å‹</td><td>å†…ç½‘ç¯å¢ƒ</td><td>8C32G + 1*T4(16GB)</td><td>éš”ç¦»éƒ¨ç½²</td></tr><tr><td>æœ¬åœ°å…¨é‡æ¨¡å‹</td><td>é«˜å®‰å…¨è¦æ±‚</td><td>16C64G + 2*A10(24GB)</td><td>ä¸‡å…†å†…ç½‘</td></tr><tr><td>VLLM åŠ é€Ÿé›†ç¾¤</td><td>ç™¾èŠ‚ç‚¹ä»¥ä¸Šå¤§é›†ç¾¤</td><td>32C128G + 4*L40S(48GB)</td><td>RDMA ç½‘ç»œ</td></tr><tr><td>æ··åˆè¾¹ç¼˜-äº‘</td><td>å·¥å‚/ç‰©è”ç½‘</td><td>è¾¹ç¼˜èŠ‚ç‚¹ 4C8G + å« GPU å·¥æ§æœº</td><td>5G ä¸“ç½‘</td></tr></tbody></table>
<h4 data-id="heading-8">2. å…³é”®æ­¥éª¤è¯¦è§£ï¼ˆä»¥æœ¬åœ° QwQ-32B æ¨¡å‹ä¸ºä¾‹ï¼‰</h4>
<p><strong>Step 1ï¼šä¾èµ–å®‰è£…ä¸æ¨¡å‹é¢„çƒ­</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… UV å·¥å…·é“¾ï¼ˆæ›¿ä»£ pipï¼‰</span>
curl -LsSf https://astral.sh/uv/install.sh | sh
<span class="hljs-built_in">source</span> ~/.bashrc

<span class="hljs-comment"># å…‹éš†ä»£ç </span>
git <span class="hljs-built_in">clone</span> https://github.com/derisk-ai/derisk.git --depth=1

<span class="hljs-comment"># å®‰è£… CUDA ä¾èµ–åŒ…ï¼ˆéœ€ 24GB+ æ˜¾å­˜ï¼‰</span>
uv <span class="hljs-built_in">sync</span> --all-packages \
  --extra <span class="hljs-string">"cuda121"</span> \
  --extra <span class="hljs-string">"hf"</span> \
  --extra <span class="hljs-string">"quant_bnb"</span> \
  --extra <span class="hljs-string">"rag"</span>
</code></pre>
<p><strong>Step 2ï¼šæ¨¡å‹é…ç½®æ–‡ä»¶å®šåˆ¶</strong><br/>
ç¼–è¾‘ <code>configs/derisk-local-qwen.toml</code>ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[models]</span>
<span class="hljs-section">[[models.llms]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"Qwen/QwQ-32B"</span>
<span class="hljs-attr">provider</span> = <span class="hljs-string">"hf"</span>
<span class="hljs-attr">quantize</span> = <span class="hljs-string">"bnb_8bit"</span>  <span class="hljs-comment"># 8 ä½é‡åŒ–é™ä½æ˜¾å­˜å ç”¨</span>

<span class="hljs-section">[service.web.database]</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"mysql"</span>   <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒæ¨è MySQL</span>
<span class="hljs-attr">host</span> = <span class="hljs-string">"10.0.0.5"</span>
<span class="hljs-attr">port</span> = <span class="hljs-number">3306</span>
<span class="hljs-attr">user</span> = <span class="hljs-string">"derisk"</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"åŠ å¯†å¯†ç "</span>
</code></pre>
<p><strong>Step 3ï¼šæœåŠ¡å¯åŠ¨ä¸éªŒè¯</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨åå°æœåŠ¡</span>
uv run derisk start webserver --config configs/derisk-local-qwen.toml &amp;

<span class="hljs-comment"># æ£€æŸ¥å¥åº·çŠ¶æ€</span>
curl http://localhost:7777/healthcheck
<span class="hljs-comment"># é¢„æœŸè¾“å‡ºï¼š{"status":"OK","model":"QwQ-32B"}</span>
</code></pre>
<h4 data-id="heading-9">3. å¸¸è§é¿å‘æŒ‡å—</h4>
<ul>
<li><strong>GPU æ˜¾å­˜ä¸è¶³</strong>ï¼šå¯ç”¨ <code>quantize = "bnb_4bit"</code> æˆ–åˆ‡æ¢ smaller æ¨¡å‹</li>
<li><strong>ä¾èµ–å†²çª</strong>ï¼šä¸¥æ ¼ä½¿ç”¨ <code>uv.lock</code> é”å®šç‰ˆæœ¬</li>
<li><strong>æ¨¡å‹ä¸‹è½½è¶…æ—¶</strong>ï¼šæ‰‹åŠ¨ä¸‹è½½åæ”¾ç½®åˆ° <code>/data/models/</code> è·¯å¾„</li>
</ul>
<hr/>
<h3 data-id="heading-10">ä¸‰ã€ä¼ä¸šå®æˆ˜æ¡ˆä¾‹ï¼šä»æ•…éšœæ­¢æŸåˆ°ä¸šåŠ¡å¢å€¼</h3>
<h4 data-id="heading-11">æ¡ˆä¾‹ 1ï¼šäº’è”ç½‘é‡‘èå¹³å° API å¼‚å¸¸è¯Šæ–­</h4>
<p><strong>èƒŒæ™¯</strong>ï¼šæŸæ”¯ä»˜ç½‘å…³æ¯ä¸¤å‘¨å‘ç”Ÿä¸€æ¬¡â€œç¥ç§˜â€çš„ 500 é”™è¯¯ï¼ŒæŒç»­ 2 å¹´æœªæ ¹æ²»<br/>
<strong>OpenDeRisk æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>Data-Agent æ¥å…¥</strong>ï¼š</p>
<ul>
<li>æ—¥å¿—æºï¼šELKï¼ˆ200GB/æ—¥ï¼‰</li>
<li>è¿½è¸ªæºï¼šJaegerï¼ˆé‡‡æ ·ç‡ 100%ï¼‰</li>
<li>æŒ‡æ ‡æºï¼šPrometheusï¼ˆ1s ç²’åº¦ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å¤šä»£ç†åä½œåˆ†æ</strong>ï¼š
sequenceDiagram
SRE-Agent-&gt;&gt;Code-Agentï¼š æ£€æµ‹åˆ° MySQL è¿æ¥å³°å€¼è§¦å‘<br/>
Code-Agent-&gt;&gt;Data-Agentï¼š è¯·æ±‚è·å–å…³è”çš„ thread dump<br/>
Data-Agent-&gt;&gt;Vis-Agentï¼š ç”Ÿæˆçº¿ç¨‹é˜»å¡çƒ­åŠ›å›¾<br/>
Vis-Agent-&gt;&gt;ReportAgentï¼š å®šä½åˆ° Druid è¿æ¥æ± æ ¡éªŒæ­»é”</p>
</li>
<li>
<p><strong>æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li>è¯Šæ–­æ—¶é—´ä» 6 äººæ—¥ â†’ <strong>8 åˆ†é’Ÿ</strong></li>
<li>é¿å…å­£åº¦æ€§æ•…éšœï¼Œå‡å°‘æŸå¤± <strong>Â¥1200 ä¸‡/å¹´</strong></li>
</ul>
</li>
</ol>
<h4 data-id="heading-12">æ¡ˆä¾‹ 2ï¼šæ™ºèƒ½å·¥å‚é¢„æµ‹æ€§ç»´æŠ¤</h4>
<p><strong>èƒŒæ™¯</strong>ï¼šæ±½è½¦ç”µæ± äº§çº¿è®¾å¤‡çªå‘åœæœºï¼Œæœˆå‡æŸå¤± Â¥500 ä¸‡<br/>
<strong>OpenDeRisk å¢å¼ºæ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>æ‰©å±• <strong>PLC-Agent</strong> å¯¹æ¥è¥¿é—¨å­ S7-1500 æ§åˆ¶å™¨</li>
<li>é›†æˆæŒ¯åŠ¨ä¼ æ„Ÿå™¨å®æ—¶æµï¼ˆ5000 ç‚¹/ç§’ï¼‰</li>
<li>å®šåˆ¶è¯Šæ–­è§„åˆ™ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ packages/custom_agents/plc_agent.py</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_axis_misalignment</span>(<span class="hljs-params">vibration_data</span>):
    <span class="hljs-keyword">if</span> spectral_entropy(vibration_data) &gt; <span class="hljs-number">2.5</span>:
        <span class="hljs-keyword">return</span> RiskLevel.CRITICAL, â€œä¸»è½´ä¸å¯¹ä¸­é£é™©â€
</code></pre>
</li>
</ol>
<p><strong>æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li>æ•…éšœé¢„æµ‹å‡†ç¡®ç‡ <strong>92.3%</strong>ï¼ˆåŸ 65%ï¼‰</li>
<li>ç»´æŠ¤æˆæœ¬ä¸‹é™ <strong>40%</strong>ï¼Œè·çœæ™ºèƒ½åˆ¶é€ è¡¥è´´</li>
</ul>
<hr/>
<h3 data-id="heading-13">å››ã€äºŒæ¬¡å¼€å‘æŒ‡å—ï¼šæ‰“é€ é¢†åŸŸä¸“å±è¯Šæ–­å¼•æ“</h3>
<h4 data-id="heading-14">1. å®šåˆ¶åŒ–æ‰©å±•æ–¹å‘</h4>






























<table><thead><tr><th><strong>æ‰©å±•ç‚¹</strong></th><th>æŠ€æœ¯æ ˆ</th><th>æ¡ˆä¾‹åœºæ™¯</th></tr></thead><tbody><tr><td>æ–°å¢æ•°æ®æº Agent</td><td>Python + gRPC</td><td>æ¥å…¥ SAP PI æ¶ˆæ¯æ€»çº¿</td></tr><tr><td>å¼ºåŒ–è¯Šæ–­è§„åˆ™</td><td>YAML è§„åˆ™å¼•æ“</td><td>é‡‘èåˆè§„æ€§æ£€æŸ¥</td></tr><tr><td>å¯è§†åŒ–æ¨¡æ¿</td><td>React + D3.js</td><td>ç”Ÿäº§æ’ç¨‹ç”˜ç‰¹å›¾</td></tr><tr><td>æŠ¥å‘Šé›†æˆ</td><td>Markdown æ¨¡æ¿</td><td>ç­‰ä¿ 2.0 å®¡è®¡æŠ¥å‘Š</td></tr></tbody></table>
<h4 data-id="heading-15">2. å¼€å‘ç¤ºä¾‹ï¼šå¿«é€Ÿæ·»åŠ  Zabbix Agent</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ packages/data_agents/zabbix_agent.py</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ZabbixDataAgent</span>(<span class="hljs-title class_ inherited__">DataAgentBase</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_metrics</span>(<span class="hljs-params">self, item_keys: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], timeframe: TimeRange</span>):
        <span class="hljs-keyword">from</span> pyzabbix <span class="hljs-keyword">import</span> ZabbixAPI
        zapi = ZabbixAPI(self.config[<span class="hljs-string">"url"</span>])
        zapi.login(self.config[<span class="hljs-string">"user"</span>], self.config[<span class="hljs-string">"password"</span>])
        <span class="hljs-keyword">return</span> zapi.history.get(itemKeys=item_keys, 
                                time_from=timeframe.start,
                                time_till=timeframe.end)
</code></pre>
<h4 data-id="heading-16">3. æ•ˆèƒ½è°ƒä¼˜æŠ€å·§</h4>
<ul>
<li><strong>æ¨ç†åŠ é€Ÿ</strong>ï¼šåˆ‡æ¢ vLLM åç«¯ï¼Œååæå‡ 4 å€</li>
<li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šå¯ç”¨ <code>--quant_bnb</code> é‡åŒ–ï¼Œæ˜¾å­˜éœ€æ±‚é™ä½ 50%</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šå¯¹å†å²è¯Šæ–­ç»“æœå»ºç«‹å‘é‡ç´¢å¼•ï¼ˆChromaDBï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-17">äº”ã€ç»“è¯­ï¼šAI è¿ç»´çš„ä¸‹ä¸€ä¸ªåå¹´</h3>
<p>OpenDeRisk é€šè¿‡ <strong>â€œå¤šä»£ç†åä½œâ€</strong> ä¸ <strong>â€œå¯è§†åŒ–è¯æ®é“¾â€</strong> ä¸¤å¤§åˆ›æ–°ï¼Œè§£å†³äº†ä¼ ç»Ÿ RCA ä¸­çš„ä¸‰å¤§æ–­å±‚ï¼š</p>
<ol>
<li><strong>æ•°æ®æ–­å±‚</strong>ï¼šæ‰“ç ´æ—¥å¿—/è¿½è¸ª/ä»£ç çš„æ•°æ®å­¤å²›</li>
<li><strong>çŸ¥è¯†æ–­å±‚</strong>ï¼šå°†ä¸“å®¶ç»éªŒè½¬åŒ–ä¸ºå¯å¤ç”¨çš„ä»£ç†ç­–ç•¥</li>
<li><strong>ä¿¡ä»»æ–­å±‚</strong>ï¼šå¯è§†åŒ–è¯æ®é“¾å–ä»£â€œé»‘ç›’è¯Šæ–­â€</li>
</ol>
<p>éšç€ 2025 å¹´å…¶è·¯çº¿å›¾ä¸­ <strong>â€œå› æœæ¨æ–­å¼•æ“â€</strong> ä¸ <strong>â€œè‡ªç›‘ç£è¯Šæ–­â€</strong> æ¨¡å—çš„å‘å¸ƒï¼Œæˆ‘ä»¬æœ‰æœ›çœ‹åˆ° AI è¿ç»´ç³»ç»Ÿä»â€œè¾…åŠ©åˆ†æâ€èµ°å‘â€œè‡ªä¸»å†³ç­–â€ã€‚æ­£å¦‚æŸäº’è”ç½‘å…¬å¸ CTO æ‰€è¨€ï¼š<strong>â€œå½“æ•…éšœè¯Šæ–­ä»å°æ—¶çº§è¿›å…¥ç§’çº§ï¼Œè¿ç»´å›¢é˜Ÿçš„ä½¿å‘½å°†ä»â€˜æ•‘ç«â€™è½¬å‘â€˜é˜²ç«â€™â€</strong>ã€‚</p>
<blockquote>
<p>é¢å¤–èµ„æºï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fderisk-ai%2Fdocs-zh" target="_blank" title="https://github.com/derisk-ai/docs-zh" ref="nofollow noopener noreferrer">OpenDeRisk ä¸­æ–‡æ–‡æ¡£</a></li>
<li>ä¼ä¸šå®æˆ˜æ¡ˆä¾‹é›†ï¼ˆå«é…ç½®æ¨¡æ¿ï¼‰</li>
<li>ç¤¾åŒº Slack é¢‘é“ï¼šè·å–æœ€æ–° Agent æ‰©å±•åŒ…</li>
</ul>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MySQL EXPLAIN æ‰§è¡Œè®¡åˆ’åˆ†æï¼šèƒ½å¦æŸ¥çœ‹ JOIN å…³è”é¡ºåº]]></title>    <link>https://juejin.cn/post/7588570963294453803</link>    <guid>https://juejin.cn/post/7588570963294453803</guid>    <pubDate>2025-12-29T05:18:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588570963294453803" data-draft-id="7588411503122366500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MySQL EXPLAIN æ‰§è¡Œè®¡åˆ’åˆ†æï¼šèƒ½å¦æŸ¥çœ‹ JOIN å…³è”é¡ºåº"/> <meta itemprop="keywords" content="åç«¯,æ•°æ®åº“,MySQL"/> <meta itemprop="datePublished" content="2025-12-29T05:18:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Cosolar"/> <meta itemprop="url" content="https://juejin.cn/user/184373686834391"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MySQL EXPLAIN æ‰§è¡Œè®¡åˆ’åˆ†æï¼šèƒ½å¦æŸ¥çœ‹ JOIN å…³è”é¡ºåº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/184373686834391/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Cosolar
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T05:18:09.000Z" title="Mon Dec 29 2025 05:18:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ ä»¬çŸ¥é“ <code>EXPLAIN</code> æ˜¯å¦èƒ½çœ‹å‡º MySQL çš„ JOIN å…³è”é¡ºåºï¼Ÿ ç»“è®ºæ˜¯ï¼š<strong>å®Œå…¨å¯ä»¥</strong>ï¼Œè€Œä¸” <code>EXPLAIN</code> æ˜¯æŸ¥çœ‹ã€åˆ†æ MySQL JOIN å…³è”é¡ºåºçš„<strong>æ ¸å¿ƒã€æœ€å¸¸ç”¨æ‰‹æ®µ</strong>ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒç»“è®ºï¼šEXPLAIN ä¸­ JOIN å…³è”é¡ºåºçš„æ ¸å¿ƒè§„åˆ™</h2>
<h3 data-id="heading-1">âœ… è§„åˆ™1ï¼š<code>EXPLAIN</code> ç»“æœçš„<strong>è¡Œå±•ç¤ºé¡ºåº</strong> = MySQL å®é™…æ‰§è¡Œçš„ JOIN å…³è”é¡ºåº</h3>
<p><code>EXPLAIN</code> æ‰§è¡Œåä¼šè¿”å›ä¸€ä¸ªç»“æœé›†ï¼ˆå¤šè¡Œæ•°æ®ï¼‰ï¼Œ<strong>MySQL æ˜¯ã€Œä»ä¸‹å¾€ä¸Šã€æ‰§è¡Œ JOIN å…³è”</strong>çš„ï¼Œè¿™ä¸ªé¡ºåºæ˜¯ç»å¯¹çš„æ ¸å¿ƒï¼Œè®°ä½è¿™ä¸ªå£è¯€ï¼š</p>
<p><code>EXPLAIN</code> ç»“æœ<strong>è¶Šé åçš„è¡Œ</strong>ï¼Œæ˜¯ MySQL æ‰§è¡Œ JOIN æ—¶<strong>å…ˆè®¿é—®çš„è¡¨</strong>ï¼ˆé©±åŠ¨è¡¨ï¼‰ï¼›</p>
<p><code>EXPLAIN</code> ç»“æœ<strong>è¶Šé å‰çš„è¡Œ</strong>ï¼Œæ˜¯ MySQL æ‰§è¡Œ JOIN æ—¶<strong>åè®¿é—®çš„è¡¨</strong>ï¼ˆè¢«é©±åŠ¨è¡¨ï¼‰ã€‚</p>
<h3 data-id="heading-2">âœ… è§„åˆ™2ï¼šé©±åŠ¨è¡¨ &amp; è¢«é©±åŠ¨è¡¨çš„å®šä¹‰ï¼ˆç†è§£å…³è”é¡ºåºçš„å‰æï¼‰</h3>
<ul>
<li><strong>é©±åŠ¨è¡¨ (driving table)</strong> ï¼šJOIN å…³è”æ—¶<strong>å…ˆè¢«åŠ è½½ã€å…ˆè¢«æ‰«æ</strong>çš„è¡¨ï¼ŒMySQL ä¼šç”¨é©±åŠ¨è¡¨çš„æ¯æ¡æ•°æ®ï¼Œå»åŒ¹é…å¦ä¸€å¼ è¡¨çš„æ•°æ®ï¼›</li>
<li><strong>è¢«é©±åŠ¨è¡¨ (driven table)</strong> ï¼šJOIN å…³è”æ—¶<strong>åè¢«åŠ è½½ã€è¢«åŒ¹é…</strong>çš„è¡¨ï¼Œä¹Ÿå«ã€ŒåŒ¹é…è¡¨ã€ï¼›</li>
<li>é©±åŠ¨è¡¨çš„é€‰æ‹©ï¼Œæ˜¯ MySQL ä¼˜åŒ–å™¨çš„æ ¸å¿ƒé€»è¾‘ä¹‹ä¸€ï¼Œ<strong>å°è¡¨ï¼ˆæ•°æ®é‡å°‘ã€è¿‡æ»¤åç»“æœé›†å°ï¼‰ä¼˜å…ˆä½œä¸ºé©±åŠ¨è¡¨</strong>ï¼Œè¿™æ˜¯æœ€ä¼˜çš„ JOIN æ‰§è¡Œç­–ç•¥ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€æœ€ç›´è§‚æ¡ˆä¾‹ï¼šä¸€çœ¼çœ‹æ‡‚ JOIN å…³è”é¡ºåº</h2>
<h3 data-id="heading-4">æ¡ˆä¾‹è¡¨å‡†å¤‡</h3>
<p>æœ‰ä¸¤å¼ å¸¸è§ä¸šåŠ¡è¡¨ï¼Œåš JOIN æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®¢å•è¡¨ï¼ˆæ•°æ®é‡è¾ƒå¤§ï¼Œå‡è®¾10ä¸‡æ¡ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">order</span>` (
  id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
  user_id <span class="hljs-type">INT</span>,
  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),
  KEY idx_user_id (user_id)
);
<span class="hljs-comment">-- ç”¨æˆ·è¡¨ï¼ˆæ•°æ®é‡è¾ƒå°ï¼Œå‡è®¾1ä¸‡æ¡ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">user</span>` (
  id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
  name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),
  age <span class="hljs-type">INT</span>
);
</code></pre>
<h3 data-id="heading-5">æ‰§è¡Œ JOIN æŸ¥è¯¢+EXPLAIN</h3>
<pre><code class="hljs language-sql" lang="sql">EXPLAIN <span class="hljs-keyword">SELECT</span> o.<span class="hljs-operator">*</span>, u.name <span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">order</span>` o <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> `<span class="hljs-keyword">user</span>` u <span class="hljs-keyword">ON</span> o.user_id <span class="hljs-operator">=</span> u.id;
</code></pre>
<h3 data-id="heading-6"><code>EXPLAIN</code> ç»“æœï¼ˆæ ¸å¿ƒå…³æ³¨ <code>table</code> åˆ—ï¼‰</h3>
<p>å‡è®¾ <code>EXPLAIN</code> è¿”å› <strong>2è¡Œç»“æœ</strong>ï¼Œ<code>table</code> åˆ—å±•ç¤ºå¦‚ä¸‹ï¼š</p>


























<table><thead><tr><th>id</th><th>select_type</th><th>table</th><th>type</th><th>...</th></tr></thead><tbody><tr><td>1</td><td>SIMPLE</td><td>o</td><td>ALL</td><td>...</td></tr><tr><td>1</td><td>SIMPLE</td><td>u</td><td>ref</td><td>...</td></tr></tbody></table>
<h3 data-id="heading-7">å…³è”é¡ºåºè§£è¯»</h3>
<p><code>EXPLAIN</code> ç»“æœé‡Œï¼Œè¡Œ1æ˜¯è¡¨ <code>o</code>ï¼ˆorderï¼‰ã€è¡Œ2æ˜¯è¡¨ <code>u</code>ï¼ˆuserï¼‰ï¼Œæ ¹æ®ã€Œ<strong>ä»ä¸‹å¾€ä¸Šæ‰§è¡Œ</strong>ã€çš„è§„åˆ™ï¼š</p>
<p>âœ… MySQL å®é™…æ‰§è¡Œé¡ºåºï¼š<strong>å…ˆæŸ¥ user è¡¨ï¼ˆé©±åŠ¨è¡¨ï¼‰ â†’ å†æŸ¥ order è¡¨ï¼ˆè¢«é©±åŠ¨è¡¨ï¼‰</strong></p>
<p>è¡¥å……ï¼šå“ªæ€•ä½ å†™çš„æ˜¯ <code>order LEFT JOIN user</code>ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨è°ƒæ•´é¡ºåºï¼Œå› ä¸º user æ˜¯å°è¡¨ï¼Œåšé©±åŠ¨è¡¨æ•ˆç‡æ›´é«˜ï¼</p>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€EXPLAIN ä¸­åˆ¤æ–­ JOIN çš„ä¸¤ä¸ªæ ¸å¿ƒå…³é”®å­—æ®µï¼ˆå¿…çœ‹ï¼‰</h2>
<p><code>EXPLAIN</code> çš„ç»“æœæœ‰å¾ˆå¤šåˆ—ï¼Œ<strong>åˆ¤æ–­æ˜¯å¦æ˜¯ JOIN æŸ¥è¯¢ã€ä»¥åŠ JOIN å…³è”çš„åŒ¹é…æ–¹å¼</strong>ï¼Œåªéœ€è¦é‡ç‚¹çœ‹ 2 ä¸ªå…³é”®å­—æ®µï¼Œç¼ºä¸€ä¸å¯ï¼š</p>
<h3 data-id="heading-9">âœ… å­—æ®µ1ï¼š<code>type</code> åˆ— - å…³è”åŒ¹é…çš„ã€Œè®¿é—®ç±»å‹ã€</h3>
<p><code>type</code> åˆ—ä»£è¡¨ MySQL å¯¹è¡¨çš„<strong>è®¿é—®/åŒ¹é…æ–¹å¼</strong>ï¼Œ<strong>åªè¦æ˜¯ JOIN æŸ¥è¯¢ï¼Œè¢«é©±åŠ¨è¡¨çš„ type å­—æ®µä¸€å®šä¼šå‡ºç°</strong> <strong><code>ref</code></strong> <strong>/</strong> <strong><code>eq_ref</code></strong> <strong>è¿™ä¸¤ä¸ªå€¼ä¹‹ä¸€</strong>ï¼Œè¿™æ˜¯ JOIN çš„ã€Œèº«ä»½æ ‡è¯†ã€ã€‚</p>
<ul>
<li><code>eq_ref</code>ï¼šæœ€ä¼˜çš„ JOIN åŒ¹é…ï¼Œ<strong>ä¸€å¯¹ä¸€</strong>åŒ¹é…ï¼ˆæ¯”å¦‚å…³è”ä¸»é”®/å”¯ä¸€ç´¢å¼•ï¼‰ï¼Œæ€§èƒ½æé«˜ï¼›</li>
<li><code>ref</code>ï¼šéå¸¸å¥½çš„ JOIN åŒ¹é…ï¼Œ<strong>å¤šå¯¹ä¸€</strong>åŒ¹é…ï¼ˆæ¯”å¦‚å…³è”æ™®é€šç´¢å¼•ï¼‰ï¼Œæ€§èƒ½ä¹Ÿå¾ˆå¥½ï¼›</li>
</ul>
<p>è¡¥å……ï¼šå¦‚æœ JOIN çš„è¢«é©±åŠ¨è¡¨ <code>type</code> æ˜¯ <code>ALL</code>ï¼Œè¯´æ˜æ˜¯ã€Œç¬›å¡å°”ç§¯åŒ¹é…/å…¨è¡¨æ‰«æåŒ¹é…ã€ï¼Œæ˜¯æ€§èƒ½æå·®çš„ JOINï¼Œå¿…é¡»ä¼˜åŒ–ï¼ˆåŠ ç´¢å¼•ï¼‰ã€‚</p>
<h3 data-id="heading-10">âœ… å­—æ®µ2ï¼š<code>possible_keys</code>/<code>key</code> åˆ— - JOIN ç”¨çš„ç´¢å¼•</h3>
<ul>
<li><code>possible_keys</code>ï¼šMySQL è®¤ä¸º<strong>å¯ä»¥ç”¨æ¥åš JOIN å…³è”</strong>çš„ç´¢å¼•ï¼ˆå€™é€‰ç´¢å¼•ï¼‰ï¼›</li>
<li><code>key</code>ï¼šMySQL æœ€ç»ˆ<strong>å®é™…é€‰ç”¨çš„ JOIN å…³è”ç´¢å¼•</strong>ï¼ˆæ ¸å¿ƒå­—æ®µï¼‰ï¼›</li>
</ul>
<p>å…³é”®ä¼˜åŒ–ç‚¹ï¼šå¦‚æœ JOIN æŸ¥è¯¢çš„ <code>key</code> åˆ—æ˜¯ <code>NULL</code>ï¼Œè¯´æ˜ MySQL æ²¡æœ‰ç”¨åˆ°ä»»ä½•ç´¢å¼•åšå…³è”ï¼Œå°±æ˜¯ä¸Šé¢è¯´çš„ã€Œå…¨è¡¨æ‰«æ JOINã€ï¼Œä¸€å®šè¦ç»™ JOIN çš„å…³è”å­—æ®µï¼ˆå¦‚ <code>o.user_id</code>/<code>u.id</code>ï¼‰åŠ ç´¢å¼•ã€‚</p>
<hr/>
<h2 data-id="heading-11">å››ã€å¤šè¡¨ JOIN åœºæ™¯ï¼š3è¡¨/å¤šè¡¨çš„å…³è”é¡ºåºæ€ä¹ˆçœ‹ï¼Ÿ</h2>
<p>å¦‚æœæ˜¯ 3 å¼ åŠä»¥ä¸Šè¡¨çš„ JOINï¼Œè§„åˆ™<strong>å®Œå…¨ä¸å˜</strong>ï¼Œè¿˜æ˜¯éµå¾ªï¼š</p>
<p><code>EXPLAIN</code> ç»“æœ <strong>ä»ä¸‹å¾€ä¸Š</strong> æ‰§è¡Œï¼Œ<strong>åè¡Œ = å…ˆè¡Œæ‰§è¡Œï¼ˆé©±åŠ¨è¡¨ï¼‰ï¼Œå‰è¡Œ = åæ‰§è¡Œï¼ˆè¢«é©±åŠ¨è¡¨ï¼‰</strong></p>
<h3 data-id="heading-12">æ¡ˆä¾‹ï¼š3è¡¨ JOIN</h3>
<pre><code class="hljs language-sql" lang="sql">EXPLAIN <span class="hljs-keyword">SELECT</span> o.<span class="hljs-operator">*</span>, u.name, g.goods_name 
<span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">order</span>` o 
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> `<span class="hljs-keyword">user</span>` u <span class="hljs-keyword">ON</span> o.user_id <span class="hljs-operator">=</span> u.id
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> `goods` g <span class="hljs-keyword">ON</span> o.goods_id <span class="hljs-operator">=</span> g.id;
</code></pre>
<h3 data-id="heading-13"><code>EXPLAIN</code> ç»“æœï¼ˆtableåˆ—ï¼‰ï¼š3è¡Œ</h3>
<p>è¡Œ1 â†’ table: o</p>
<p>è¡Œ2 â†’ table: g</p>
<p>è¡Œ3 â†’ table: u</p>
<h3 data-id="heading-14">å®é™…æ‰§è¡Œé¡ºåº</h3>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šå…ˆè®¿é—® <code>u</code> è¡¨ï¼ˆæœ€ä¸‹è¡Œï¼Œé©±åŠ¨è¡¨1ï¼‰</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šç”¨ <code>u</code> è¡¨çš„æ•°æ®å…³è”è®¿é—® <code>g</code> è¡¨ï¼ˆä¸­é—´è¡Œï¼Œè¢«é©±åŠ¨è¡¨1ã€é©±åŠ¨è¡¨2ï¼‰</p>
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šç”¨ <code>u+g</code> å…³è”çš„ç»“æœï¼Œå…³è”è®¿é—® <code>o</code> è¡¨ï¼ˆæœ€ä¸Šè¡Œï¼Œè¢«é©±åŠ¨è¡¨2ï¼‰</p>
<p>æ€»ç»“ï¼šä¸ç®¡å¤šå°‘è¡¨ JOINï¼Œåªéœ€è¦æŠŠ <code>EXPLAIN</code> çš„ç»“æœè¡Œ<strong>å€’åºçœ‹</strong>ï¼Œå°±æ˜¯å®Œæ•´çš„æ‰§è¡Œé¡ºåºï¼</p>
<hr/>
<h2 data-id="heading-15">äº”ã€MySQL ä¼šä¸ä¼šã€Œè‡ªå·±è°ƒæ•´ JOIN å…³è”é¡ºåºã€ï¼Ÿ</h2>
<h3 data-id="heading-16">âœ… é‡è¦ç»“è®ºï¼š<strong>ä¼šçš„ï¼è€Œä¸”æ˜¯å¸¸æ€ï¼</strong></h3>
<p>ä½ åœ¨ SQL è¯­å¥ä¸­<strong>ä¹¦å†™çš„ JOIN è¡¨é¡ºåº</strong>ï¼Œ<strong>ä¸ç­‰äº</strong> MySQL å®é™…æ‰§è¡Œçš„ JOIN é¡ºåºï¼</p>
<h3 data-id="heading-17">æ ¸å¿ƒåŸå› ï¼šMySQL æœ‰ã€ŒJOIN ä¼˜åŒ–å™¨ï¼ˆå…³è”é¡ºåºä¼˜åŒ–ï¼‰ã€</h3>
<p>MySQL çš„ä¼˜åŒ–å™¨ä¼šåŸºäºã€Œ<strong>æˆæœ¬ä¼°ç®—</strong>ã€ï¼Œè‡ªåŠ¨è°ƒæ•´ JOIN çš„å…³è”é¡ºåºï¼Œæ ¸å¿ƒåŸåˆ™æ˜¯ï¼š</p>
<p><strong>ä¼˜å…ˆé€‰æ‹©ã€Œå°è¡¨/è¿‡æ»¤åç»“æœé›†æœ€å°çš„è¡¨ã€ä½œä¸ºé©±åŠ¨è¡¨</strong></p>
<p>å› ä¸ºé©±åŠ¨è¡¨è¶Šå°ï¼Œéœ€è¦å¾ªç¯åŒ¹é…çš„æ¬¡æ•°è¶Šå°‘ï¼ŒJOIN çš„æ•´ä½“æ‰§è¡Œæ•ˆç‡è¶Šé«˜ã€‚</p>
<p>æ¯”å¦‚ä½ å†™çš„æ˜¯ <code>å¤§è¡¨ JOIN å°è¡¨</code>ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨è°ƒæ•´ä¸º <code>å°è¡¨ JOIN å¤§è¡¨</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç”¨åˆ»æ„çº ç»“ SQL ä¸­ JOIN çš„ä¹¦å†™é¡ºåºçš„åŸå› ã€‚</p>
<hr/>
<h2 data-id="heading-18">å…­ã€å¦‚ä½•å¼ºåˆ¶ MySQL æŒ‰ç…§ã€Œæˆ‘å†™çš„é¡ºåºã€æ‰§è¡Œ JOINï¼Ÿ</h2>
<p>å¦‚æœæŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹ï¼Œä½ ç¡®å®šè‡ªå·±å†™çš„ JOIN é¡ºåºæ¯” MySQL ä¼˜åŒ–å™¨é€‰çš„æ›´ä¼˜ï¼Œæƒ³è¦<strong>ç¦ç”¨ä¼˜åŒ–å™¨çš„å…³è”é¡ºåºè°ƒæ•´</strong>ï¼Œå¼ºåˆ¶æŒ‰ SQL ä¹¦å†™é¡ºåºæ‰§è¡Œ JOINï¼Œæœ‰ 2 ç§å¯é æ–¹æ³•ï¼š</p>
<h3 data-id="heading-19">âœ… æ–¹æ³•1ï¼šä½¿ç”¨ <code>STRAIGHT_JOIN</code> å…³é”®å­—ï¼ˆæ¨èï¼Œè½»é‡ï¼‰</h3>
<p><code>STRAIGHT_JOIN</code> æ˜¯ <code>JOIN</code> çš„ã€Œå¼ºåˆ¶é¡ºåºç‰ˆã€ï¼ŒåŠŸèƒ½å’Œ <code>JOIN</code> å®Œå…¨ä¸€è‡´ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯ï¼š<strong>å¼ºåˆ¶ MySQL æŒ‰ç…§ SQL ä¸­ä¹¦å†™çš„è¡¨é¡ºåºæ‰§è¡Œ JOINï¼Œä¸åšä»»ä½•è°ƒæ•´</strong>ã€‚</p>
<p>è¯­æ³•ï¼šæŠŠ SQL ä¸­çš„ <code>JOIN</code> æ›¿æ¢æˆ <code>STRAIGHT_JOIN</code> å³å¯ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å¼ºåˆ¶ï¼šå…ˆæŸ¥ order è¡¨ â†’ å†æŸ¥ user è¡¨ï¼Œå®Œå…¨æŒ‰ä¹¦å†™é¡ºåºæ‰§è¡Œ</span>
EXPLAIN <span class="hljs-keyword">SELECT</span> o.<span class="hljs-operator">*</span>, u.name <span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">order</span>` o STRAIGHT_JOIN `<span class="hljs-keyword">user</span>` u <span class="hljs-keyword">ON</span> o.user_id <span class="hljs-operator">=</span> u.id;
</code></pre>
<h3 data-id="heading-20">âœ… æ–¹æ³•2ï¼šå…³é—­ä¼˜åŒ–å™¨çš„å…³è”é¡ºåºä¼˜åŒ–ï¼ˆä¸æ¨èï¼Œå…¨å±€ç”Ÿæ•ˆï¼‰</h3>
<p>é€šè¿‡è®¾ç½® MySQL ä¼šè¯å‚æ•°å…³é—­ä¼˜åŒ–å™¨ï¼Œä¼šå½±å“æ‰€æœ‰æŸ¥è¯¢ï¼Œè°¨æ…ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å…³é—­å…³è”é¡ºåºä¼˜åŒ–</span>
<span class="hljs-keyword">SET</span> optimizer_switch<span class="hljs-operator">=</span><span class="hljs-string">'join_cache_bka=off'</span>;
<span class="hljs-comment">-- æ‰§è¡Œä½ çš„ JOIN æŸ¥è¯¢</span>
EXPLAIN <span class="hljs-keyword">SELECT</span> o.<span class="hljs-operator">*</span>, u.name <span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">order</span>` o <span class="hljs-keyword">JOIN</span> `<span class="hljs-keyword">user</span>` u <span class="hljs-keyword">ON</span> o.user_id <span class="hljs-operator">=</span> u.id;
<span class="hljs-comment">-- ç”¨å®Œå»ºè®®æ¢å¤é»˜è®¤</span>
<span class="hljs-keyword">SET</span> optimizer_switch<span class="hljs-operator">=</span><span class="hljs-string">'join_cache_bka=on'</span>;
</code></pre>
<hr/>
<h2 data-id="heading-21">âœ¨ å…¨æ–‡æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“ï¼ˆå¿…è®°ï¼‰</h2>
<ol>
<li><code>EXPLAIN</code> <strong>å¯ä»¥ç²¾å‡†æŸ¥çœ‹</strong> MySQL JOIN çš„å…³è”é¡ºåºï¼Œæ˜¯æ ¸å¿ƒåˆ†æå·¥å…·ï¼›</li>
<li>JOIN å…³è”é¡ºåºæ ¸å¿ƒè§„åˆ™ï¼š<code>EXPLAIN</code> ç»“æœ <strong>ä»ä¸‹å¾€ä¸Šæ‰§è¡Œ</strong>ï¼Œåè¡Œæ˜¯é©±åŠ¨è¡¨ï¼ˆå…ˆæ‰§è¡Œï¼‰ï¼Œå‰è¡Œæ˜¯è¢«é©±åŠ¨è¡¨ï¼ˆåæ‰§è¡Œï¼‰ï¼›</li>
<li>åˆ¤æ–­ JOIN çš„ 2 ä¸ªæ ¸å¿ƒå­—æ®µï¼š<code>type</code> åˆ—ï¼ˆå¿…ä¸º <code>ref/eq_ref</code>ï¼‰+ <code>key</code> åˆ—ï¼ˆé NULL ä»£è¡¨ç”¨åˆ°å…³è”ç´¢å¼•ï¼‰ï¼›</li>
<li>å¤šè¡¨ JOIN è§„åˆ™ä¸å˜ï¼Œå€’åºçœ‹ <code>EXPLAIN</code> ç»“æœå°±æ˜¯æ‰§è¡Œé¡ºåºï¼›</li>
<li>MySQL ä¼š<strong>è‡ªåŠ¨è°ƒæ•´ JOIN é¡ºåº</strong>ï¼ˆå°è¡¨ä¼˜å…ˆåšé©±åŠ¨è¡¨ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨è°ƒæ•´ä¹¦å†™é¡ºåºï¼›</li>
<li>å¼ºåˆ¶æŒ‰ä¹¦å†™é¡ºåºæ‰§è¡Œï¼šç”¨ <code>STRAIGHT_JOIN</code> æ›¿æ¢ <code>JOIN</code> å³å¯ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ— ç•Œå¾®å‰ç«¯æºç è§£æï¼šè·¯ç”±åŒæ­¥]]></title>    <link>https://juejin.cn/post/7588704463621505043</link>    <guid>https://juejin.cn/post/7588704463621505043</guid>    <pubDate>2025-12-29T07:43:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588704463621505043" data-draft-id="7589159665839423531" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ— ç•Œå¾®å‰ç«¯æºç è§£æï¼šè·¯ç”±åŒæ­¥"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-29T07:43:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€Ÿä¸ªç«er"/> <meta itemprop="url" content="https://juejin.cn/user/2225067265915783"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ— ç•Œå¾®å‰ç«¯æºç è§£æï¼šè·¯ç”±åŒæ­¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067265915783/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€Ÿä¸ªç«er
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T07:43:11.000Z" title="Mon Dec 29 2025 07:43:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ— ç•Œå¾®å‰ç«¯æºç è§£æï¼šè·¯ç”±åŒæ­¥</h2>
<blockquote>
<p>æ·±å…¥åˆ†æä¸»å­åº”ç”¨è·¯ç”±åŒæ­¥æœºåˆ¶ï¼Œç†è§£ sync æ¨¡å¼çš„å®ç°åŸç†ã€‚</p>
</blockquote>
<h3 data-id="heading-1">è·¯ç”±åŒæ­¥åŸç†</h3>
<p>æ— ç•Œé€šè¿‡ URL query å‚æ•°å®ç°ä¸»å­åº”ç”¨è·¯ç”±åŒæ­¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">ä¸»åº”ç”¨ <span class="hljs-attr">URL</span>:
<span class="hljs-attr">https</span>:<span class="hljs-comment">//main.com/home?vue3=%2Fuser%2F123</span>

å­åº”ç”¨å®é™…è·¯ç”±:
<span class="hljs-regexp">/user/</span><span class="hljs-number">123</span>
</code></pre>
<h3 data-id="heading-2">åŒæ­¥æµç¨‹</h3>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     pushState/replaceState     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                 â”‚
â”‚   å­åº”ç”¨è·¯ç”±     â”‚                                â”‚   ä¸»åº”ç”¨ URL    â”‚
â”‚                 â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     æµè§ˆå™¨åˆ·æ–°/å‰è¿›åé€€         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-3">å­åº”ç”¨ â†’ ä¸»åº”ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/sync.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">syncUrlToWindow</span>(<span class="hljs-params">iframeWindow: Window</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> { sync, id, prefix } = iframeWindow.<span class="hljs-property">__WUJIE</span>;
  
  <span class="hljs-comment">// è§£æä¸»åº”ç”¨ URL</span>
  <span class="hljs-keyword">let</span> winUrlElement = <span class="hljs-title function_">anchorElementGenerator</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>);
  <span class="hljs-keyword">const</span> queryMap = <span class="hljs-title function_">getAnchorElementQueryMap</span>(winUrlElement);
  
  <span class="hljs-comment">// éåŒæ­¥æ¨¡å¼ä¸” URL ä¸Šæ²¡æœ‰å½“å‰ id çš„å‚æ•°ï¼Œç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (!sync &amp;&amp; !queryMap[id]) <span class="hljs-keyword">return</span> (winUrlElement = <span class="hljs-literal">null</span>);
  
  <span class="hljs-comment">// è·å–å­åº”ç”¨å½“å‰è·¯ç”±</span>
  <span class="hljs-keyword">const</span> curUrl = iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span> + 
                 iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">search</span> + 
                 iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>;
  
  <span class="hljs-comment">// å¤„ç†çŸ­è·¯å¾„</span>
  <span class="hljs-keyword">let</span> validShortPath = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (prefix) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(prefix).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">shortPath</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> longPath = prefix[shortPath];
      <span class="hljs-comment">// æ‰¾å‡ºæœ€é•¿åŒ¹é…è·¯å¾„</span>
      <span class="hljs-keyword">if</span> (curUrl.<span class="hljs-title function_">startsWith</span>(longPath) &amp;&amp; 
          (!validShortPath || longPath.<span class="hljs-property">length</span> &gt; prefix[validShortPath].<span class="hljs-property">length</span>)) {
        validShortPath = shortPath;
      }
    });
  }
  
  <span class="hljs-comment">// åŒæ­¥æ¨¡å¼ï¼šæ›´æ–°å‚æ•°</span>
  <span class="hljs-keyword">if</span> (sync) {
    queryMap[id] = <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">encodeURIComponent</span>(
      validShortPath 
        ? curUrl.<span class="hljs-title function_">replace</span>(prefix[validShortPath], <span class="hljs-string">`{<span class="hljs-subst">${validShortPath}</span>}`</span>) 
        : curUrl
    );
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// éåŒæ­¥æ¨¡å¼ï¼šæ¸…ç†å‚æ•°</span>
    <span class="hljs-keyword">delete</span> queryMap[id];
  }
  
  <span class="hljs-comment">// æ„å»ºæ–° URL</span>
  <span class="hljs-keyword">const</span> newQuery = <span class="hljs-string">"?"</span> + <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryMap)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> key + <span class="hljs-string">"="</span> + queryMap[key])
    .<span class="hljs-title function_">join</span>(<span class="hljs-string">"&amp;"</span>);
  winUrlElement.<span class="hljs-property">search</span> = newQuery;
  
  <span class="hljs-comment">// æ›´æ–°ä¸»åº”ç”¨ URL</span>
  <span class="hljs-keyword">if</span> (winUrlElement.<span class="hljs-property">href</span> !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">replaceState</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">""</span>, winUrlElement.<span class="hljs-property">href</span>);
  }
  winUrlElement = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-4">ä¸»åº”ç”¨ â†’ å­åº”ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/sync.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">syncUrlToIframe</span>(<span class="hljs-params">iframeWindow: Window</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> { pathname, search, hash } = iframeWindow.<span class="hljs-property">location</span>;
  <span class="hljs-keyword">const</span> { id, url, sync, execFlag, prefix, inject } = iframeWindow.<span class="hljs-property">__WUJIE</span>;

  <span class="hljs-comment">// åªåœ¨æµè§ˆå™¨åˆ·æ–°æˆ–ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶åŒæ­¥</span>
  <span class="hljs-keyword">const</span> idUrl = sync &amp;&amp; !execFlag ? <span class="hljs-title function_">getSyncUrl</span>(id, prefix) : url;
  
  <span class="hljs-comment">// æ’é™¤ href è·³è½¬æƒ…å†µ</span>
  <span class="hljs-keyword">const</span> syncUrl = (<span class="hljs-regexp">/^http/</span>.<span class="hljs-title function_">test</span>(idUrl) ? <span class="hljs-literal">null</span> : idUrl) || url;
  <span class="hljs-keyword">const</span> { appRoutePath } = <span class="hljs-title function_">appRouteParse</span>(syncUrl);

  <span class="hljs-keyword">const</span> preAppRoutePath = pathname + search + hash;
  
  <span class="hljs-comment">// è·¯ç”±ä¸åŒåˆ™åŒæ­¥</span>
  <span class="hljs-keyword">if</span> (preAppRoutePath !== appRoutePath) {
    iframeWindow.<span class="hljs-property">history</span>.<span class="hljs-title function_">replaceState</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">""</span>, inject.<span class="hljs-property">mainHostPath</span> + appRoutePath);
  }
}
</code></pre>
<h3 data-id="heading-5">è·å–åŒæ­¥ URL</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/utils.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getSyncUrl</span>(<span class="hljs-params">id: <span class="hljs-built_in">string</span>, prefix?: { [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span> }</span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> winUrlElement = <span class="hljs-title function_">anchorElementGenerator</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>);
  <span class="hljs-keyword">const</span> queryMap = <span class="hljs-title function_">getAnchorElementQueryMap</span>(winUrlElement);
  
  <span class="hljs-keyword">let</span> syncUrl = queryMap[id] ? <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">decodeURIComponent</span>(queryMap[id]) : <span class="hljs-string">""</span>;
  
  <span class="hljs-comment">// å¤„ç†çŸ­è·¯å¾„è¿˜åŸ</span>
  <span class="hljs-keyword">if</span> (prefix &amp;&amp; syncUrl) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(prefix).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">shortPath</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> longPath = prefix[shortPath];
      syncUrl = syncUrl.<span class="hljs-title function_">replace</span>(<span class="hljs-string">`{<span class="hljs-subst">${shortPath}</span>}`</span>, longPath);
    });
  }
  
  <span class="hljs-keyword">return</span> syncUrl;
}
</code></pre>
<h3 data-id="heading-6">çŸ­è·¯å¾„é…ç½®</h3>
<p>é€šè¿‡ <code>prefix</code> é…ç½®å¯ä»¥ç¼©çŸ­ URLï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">startApp</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'vue3'</span>,
  <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:7300/'</span>,
  <span class="hljs-attr">sync</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">prefix</span>: {
    <span class="hljs-string">'u'</span>: <span class="hljs-string">'/user'</span>,           <span class="hljs-comment">// /user/123 â†’ {u}/123</span>
    <span class="hljs-string">'p'</span>: <span class="hljs-string">'/product/detail'</span>, <span class="hljs-comment">// /product/detail/456 â†’ {p}/456</span>
  },
});
</code></pre>
<p>æ•ˆæœï¼š</p>
<pre><code class="hljs language-ini" lang="ini">åŸå§‹: ?<span class="hljs-attr">vue3</span>=%<span class="hljs-number">2</span>Fuser%<span class="hljs-number">2</span>F123
çŸ­è·¯å¾„: ?<span class="hljs-attr">vue3</span>=%<span class="hljs-number">7</span>Bu%<span class="hljs-number">7</span>D%<span class="hljs-number">2</span>F123
</code></pre>
<h3 data-id="heading-7">History åŠ«æŒ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/iframe.ts</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">patchIframeHistory</span>(<span class="hljs-params">iframeWindow: Window, appHostPath: <span class="hljs-built_in">string</span>, mainHostPath: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> history = iframeWindow.<span class="hljs-property">history</span>;
  <span class="hljs-keyword">const</span> rawHistoryPushState = history.<span class="hljs-property">pushState</span>;
  <span class="hljs-keyword">const</span> rawHistoryReplaceState = history.<span class="hljs-property">replaceState</span>;
  
  history.<span class="hljs-property">pushState</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">data: <span class="hljs-built_in">any</span>, title: <span class="hljs-built_in">string</span>, url?: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// å°†å­åº”ç”¨è·¯å¾„è½¬æ¢ä¸ºä¸»åº”ç”¨è·¯å¾„</span>
    <span class="hljs-keyword">const</span> baseUrl = mainHostPath + iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span> + 
                    iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">search</span> + iframeWindow.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>;
    <span class="hljs-keyword">const</span> mainUrl = <span class="hljs-title function_">getAbsolutePath</span>(url?.<span class="hljs-title function_">replace</span>(appHostPath, <span class="hljs-string">""</span>), baseUrl);
    <span class="hljs-keyword">const</span> ignoreFlag = url === <span class="hljs-literal">undefined</span>;

    <span class="hljs-comment">// è°ƒç”¨åŸç”Ÿæ–¹æ³•</span>
    rawHistoryPushState.<span class="hljs-title function_">call</span>(history, data, title, ignoreFlag ? <span class="hljs-literal">undefined</span> : mainUrl);
    <span class="hljs-keyword">if</span> (ignoreFlag) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// æ›´æ–° base æ ‡ç­¾</span>
    <span class="hljs-title function_">updateBase</span>(iframeWindow, appHostPath, mainHostPath);
    <span class="hljs-comment">// åŒæ­¥åˆ°ä¸»åº”ç”¨</span>
    <span class="hljs-title function_">syncUrlToWindow</span>(iframeWindow);
  };
  
  history.<span class="hljs-property">replaceState</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">data: <span class="hljs-built_in">any</span>, title: <span class="hljs-built_in">string</span>, url?: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// ç±»ä¼¼é€»è¾‘...</span>
  };
}
</code></pre>
<h3 data-id="heading-8">å‰è¿›åé€€ç›‘å¬</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/iframe.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">syncIframeUrlToWindow</span>(<span class="hljs-params">iframeWindow: Window</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// hashchange äº‹ä»¶</span>
  iframeWindow.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"hashchange"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">syncUrlToWindow</span>(iframeWindow));
  
  <span class="hljs-comment">// popstate äº‹ä»¶</span>
  iframeWindow.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"popstate"</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">syncUrlToWindow</span>(iframeWindow);
  });
}
</code></pre>
<h3 data-id="heading-9">href è·³è½¬å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/sync.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processAppForHrefJump</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"popstate"</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">let</span> winUrlElement = <span class="hljs-title function_">anchorElementGenerator</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>);
    <span class="hljs-keyword">const</span> queryMap = <span class="hljs-title function_">getAnchorElementQueryMap</span>(winUrlElement);
    winUrlElement = <span class="hljs-literal">null</span>;
    
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryMap)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> <span class="hljs-title function_">getWujieById</span>(id))
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">sandbox</span>) =&gt;</span> sandbox)
      .<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">sandbox</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> url = queryMap[sandbox.<span class="hljs-property">id</span>];
        <span class="hljs-keyword">const</span> iframeBody = rawDocumentQuerySelector.<span class="hljs-title function_">call</span>(sandbox.<span class="hljs-property">iframe</span>.<span class="hljs-property">contentDocument</span>, <span class="hljs-string">"body"</span>);
        
        <span class="hljs-comment">// å‰è¿›åˆ° href è·³è½¬çš„é¡µé¢</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/http/</span>.<span class="hljs-title function_">test</span>(url)) {
          <span class="hljs-keyword">if</span> (sandbox.<span class="hljs-property">degrade</span>) {
            <span class="hljs-title function_">renderElementToContainer</span>(sandbox.<span class="hljs-property">document</span>.<span class="hljs-property">documentElement</span>, iframeBody);
            <span class="hljs-title function_">renderIframeReplaceApp</span>(
              <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">decodeURIComponent</span>(url),
              <span class="hljs-title function_">getDegradeIframe</span>(sandbox.<span class="hljs-property">id</span>).<span class="hljs-property">parentElement</span>,
              sandbox.<span class="hljs-property">degradeAttrs</span>
            );
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">renderIframeReplaceApp</span>(
              <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">decodeURIComponent</span>(url),
              sandbox.<span class="hljs-property">shadowRoot</span>.<span class="hljs-property">host</span>.<span class="hljs-property">parentElement</span>,
              sandbox.<span class="hljs-property">degradeAttrs</span>
            );
          }
          sandbox.<span class="hljs-property">hrefFlag</span> = <span class="hljs-literal">true</span>;
          
        <span class="hljs-comment">// ä» href é¡µé¢åé€€</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sandbox.<span class="hljs-property">hrefFlag</span>) {
          <span class="hljs-keyword">if</span> (sandbox.<span class="hljs-property">degrade</span>) {
            <span class="hljs-keyword">const</span> { iframe } = <span class="hljs-title function_">initRenderIframeAndContainer</span>(sandbox.<span class="hljs-property">id</span>, sandbox.<span class="hljs-property">el</span>, sandbox.<span class="hljs-property">degradeAttrs</span>);
            <span class="hljs-title function_">patchEventTimeStamp</span>(iframe.<span class="hljs-property">contentWindow</span>, sandbox.<span class="hljs-property">iframe</span>.<span class="hljs-property">contentWindow</span>);
            iframe.<span class="hljs-property">contentWindow</span>.<span class="hljs-property">onunload</span> = <span class="hljs-function">() =&gt;</span> sandbox.<span class="hljs-title function_">unmount</span>();
            iframe.<span class="hljs-property">contentDocument</span>.<span class="hljs-title function_">appendChild</span>(iframeBody.<span class="hljs-property">firstElementChild</span>);
            sandbox.<span class="hljs-property">document</span> = iframe.<span class="hljs-property">contentDocument</span>;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">renderElementToContainer</span>(sandbox.<span class="hljs-property">shadowRoot</span>.<span class="hljs-property">host</span>, sandbox.<span class="hljs-property">el</span>);
          }
          sandbox.<span class="hljs-property">hrefFlag</span> = <span class="hljs-literal">false</span>;
        }
      });
  });
}
</code></pre>
<h3 data-id="heading-10">æ¸…ç†éæ¿€æ´»åº”ç”¨ URL</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/sync.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clearInactiveAppUrl</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> winUrlElement = <span class="hljs-title function_">anchorElementGenerator</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>);
  <span class="hljs-keyword">const</span> queryMap = <span class="hljs-title function_">getAnchorElementQueryMap</span>(winUrlElement);
  
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryMap).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sandbox = <span class="hljs-title function_">getWujieById</span>(id);
    <span class="hljs-keyword">if</span> (!sandbox) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// å­åº”ç”¨æ‰§è¡Œè¿‡ä¸”å·²å¤±æ´»æ‰éœ€è¦æ¸…é™¤</span>
    <span class="hljs-keyword">if</span> (sandbox.<span class="hljs-property">execFlag</span> &amp;&amp; sandbox.<span class="hljs-property">sync</span> &amp;&amp; !sandbox.<span class="hljs-property">hrefFlag</span> &amp;&amp; !sandbox.<span class="hljs-property">activeFlag</span>) {
      <span class="hljs-keyword">delete</span> queryMap[id];
    }
  });
  
  <span class="hljs-keyword">const</span> newQuery = <span class="hljs-string">"?"</span> + <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryMap)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> key + <span class="hljs-string">"="</span> + <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">decodeURIComponent</span>(queryMap[key]))
    .<span class="hljs-title function_">join</span>(<span class="hljs-string">"&amp;"</span>);
  winUrlElement.<span class="hljs-property">search</span> = newQuery;
  
  <span class="hljs-keyword">if</span> (winUrlElement.<span class="hljs-property">href</span> !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">replaceState</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">""</span>, winUrlElement.<span class="hljs-property">href</span>);
  }
  winUrlElement = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-11">æ¨é€ URL</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// packages/wujie-core/src/sync.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">pushUrlToWindow</span>(<span class="hljs-params">id: <span class="hljs-built_in">string</span>, url: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> winUrlElement = <span class="hljs-title function_">anchorElementGenerator</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>);
  <span class="hljs-keyword">const</span> queryMap = <span class="hljs-title function_">getAnchorElementQueryMap</span>(winUrlElement);
  
  <span class="hljs-comment">// æ›´æ–°å‚æ•°</span>
  queryMap[id] = <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">encodeURIComponent</span>(url);
  
  <span class="hljs-keyword">const</span> newQuery = <span class="hljs-string">"?"</span> + <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryMap)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> key + <span class="hljs-string">"="</span> + queryMap[key])
    .<span class="hljs-title function_">join</span>(<span class="hljs-string">"&amp;"</span>);
  winUrlElement.<span class="hljs-property">search</span> = newQuery;
  
  <span class="hljs-comment">// ä½¿ç”¨ pushState æ·»åŠ å†å²è®°å½•</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">pushState</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">""</span>, winUrlElement.<span class="hljs-property">href</span>);
  winUrlElement = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-12">ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¼€å¯è·¯ç”±åŒæ­¥</span>
<span class="hljs-title function_">startApp</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'vue3'</span>,
  <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:7300/'</span>,
  <span class="hljs-attr">el</span>: <span class="hljs-string">'#container'</span>,
  <span class="hljs-attr">sync</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// å¼€å¯åŒæ­¥</span>
  <span class="hljs-attr">prefix</span>: {
    <span class="hljs-string">'u'</span>: <span class="hljs-string">'/user'</span>,
  },
});

<span class="hljs-comment">// å­åº”ç”¨è·¯ç”±å˜åŒ–</span>
<span class="hljs-comment">// /user/123 â†’ ä¸»åº”ç”¨ URL: ?vue3=%7Bu%7D%2F123</span>

<span class="hljs-comment">// åˆ·æ–°æµè§ˆå™¨</span>
<span class="hljs-comment">// ä¸»åº”ç”¨ URL: ?vue3=%7Bu%7D%2F123 â†’ å­åº”ç”¨æ¢å¤åˆ° /user/123</span>
</code></pre>
<h3 data-id="heading-13">å°ç»“</h3>
<p>æ— ç•Œçš„è·¯ç”±åŒæ­¥æœºåˆ¶ï¼š</p>





























<table><thead><tr><th>åœºæ™¯</th><th>å¤„ç†æ–¹å¼</th></tr></thead><tbody><tr><td>å­åº”ç”¨è·¯ç”±å˜åŒ–</td><td>é€šè¿‡ history åŠ«æŒåŒæ­¥åˆ°ä¸»åº”ç”¨ URL</td></tr><tr><td>æµè§ˆå™¨åˆ·æ–°</td><td>ä»ä¸»åº”ç”¨ URL æ¢å¤å­åº”ç”¨è·¯ç”±</td></tr><tr><td>å‰è¿›åé€€</td><td>ç›‘å¬ popstate äº‹ä»¶åŒæ­¥</td></tr><tr><td>href è·³è½¬</td><td>ç‰¹æ®Šå¤„ç†ï¼Œé‡æ–°æ¸²æŸ“ iframe</td></tr><tr><td>åº”ç”¨åˆ‡æ¢</td><td>æ¸…ç†éæ¿€æ´»åº”ç”¨çš„ URL å‚æ•°</td></tr></tbody></table>
<p>æ ¸å¿ƒæŠ€å·§ï¼š</p>
<ol>
<li><strong>URL Query å­˜å‚¨</strong>ï¼šå­åº”ç”¨è·¯ç”±ç¼–ç åå­˜å…¥ä¸»åº”ç”¨ URL</li>
<li><strong>çŸ­è·¯å¾„ä¼˜åŒ–</strong>ï¼šé€šè¿‡ prefix é…ç½®ç¼©çŸ­ URL</li>
<li><strong>History åŠ«æŒ</strong>ï¼šæ‹¦æˆª pushState/replaceState å®ç°åŒæ­¥</li>
<li><strong>äº‹ä»¶ç›‘å¬</strong>ï¼šhashchange å’Œ popstate å¤„ç†å‰è¿›åé€€</li>
</ol>
<p>ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†åˆ†æé€šä¿¡æœºåˆ¶ã€‚</p>
<hr/>
<blockquote>
<p>ğŸ“¦ æºç ç‰ˆæœ¬ï¼šwujie v1.0.22</p>
<p>ä¸Šä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/7588570963295633451" target="_blank" title="https://juejin.cn/post/7588570963295633451">JS éš”ç¦»</a></p>
<p>ä¸‹ä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/7588827110506102827" target="_blank" title="https://juejin.cn/post/7588827110506102827">é€šä¿¡æœºåˆ¶</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ LangChain ä¸­çš„Â `.pipe()`ï¼šæ„å»ºå¯ç»„åˆ AI åº”ç”¨çš„æ ¸å¿ƒç®¡é“æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7588376012122062875</link>    <guid>https://juejin.cn/post/7588376012122062875</guid>    <pubDate>2025-12-29T03:03:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588376012122062875" data-draft-id="7588355695101575177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ LangChain ä¸­çš„Â `.pipe()`ï¼šæ„å»ºå¯ç»„åˆ AI åº”ç”¨çš„æ ¸å¿ƒç®¡é“æœºåˆ¶"/> <meta itemprop="keywords" content="JavaScript,LangChain"/> <meta itemprop="datePublished" content="2025-12-29T03:03:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— æ•Œçš„æ‹–æ‹‰æ–¯æ—‹é£"/> <meta itemprop="url" content="https://juejin.cn/user/951508170179208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ LangChain ä¸­çš„Â `.pipe()`ï¼šæ„å»ºå¯ç»„åˆ AI åº”ç”¨çš„æ ¸å¿ƒç®¡é“æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/951508170179208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— æ•Œçš„æ‹–æ‹‰æ–¯æ—‹é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T03:03:38.000Z" title="Mon Dec 29 2025 03:03:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä½¿ç”¨ LangChain æ„å»ºå¤§æ¨¡å‹åº”ç”¨æ—¶ï¼Œä½ ä¸€å®šè§è¿‡è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">
const <span class="hljs-attr">chain</span> = prompt
  .pipe(model)
  .pipe(parser)<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„ <code>.pipe()</code> æ–¹æ³•ï¼Œå…¶å®æ˜¯ <strong>LangChain è¡¨è¾¾å¼è¯­è¨€ï¼ˆLCELï¼‰çš„çµé­‚æ‰€åœ¨</strong>ã€‚å®ƒä¸ä»…è®©ä»£ç æ›´æ¸…æ™°ï¼Œè¿˜èµ‹äºˆäº†å¼€å‘è€…å¼ºå¤§çš„ç»„åˆèƒ½åŠ›ã€‚æœ¬æ–‡å°†å¸¦ä½ å½»åº•æŒæ¡ <code>.pipe()</code> çš„åŸç†ã€ä½œç”¨ã€é«˜çº§ç”¨æ³•ä»¥åŠå®ƒåœ¨æ•´ä¸ª LangChain ç”Ÿæ€ä¸­çš„æ ¸å¿ƒåœ°ä½ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€<code>.pipe()</code>Â æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” ä¸åªæ˜¯â€œè¿æ¥â€ï¼Œè€Œæ˜¯â€œæ™ºèƒ½æµæ°´çº¿â€</h2>
<h3 data-id="heading-1">âœ… åŸºæœ¬å®šä¹‰</h3>
<p>åœ¨ LangChain ä¸­ï¼Œ<code>.pipe()</code> æ˜¯ <strong><code>Runnable</code> æ¥å£ä¸Šçš„ä¸€ä¸ªæ–¹æ³•</strong>ï¼Œç”¨äºå°†å¤šä¸ªå¯è¿è¡Œå•å…ƒï¼ˆå¦‚æç¤ºæ¨¡æ¿ã€å¤§æ¨¡å‹ã€è§£æå™¨ã€è‡ªå®šä¹‰å‡½æ•°ç­‰ï¼‰<strong>ä¸²è”æˆä¸€æ¡æ•°æ®å¤„ç†æµæ°´çº¿</strong>ã€‚</p>
<blockquote>
<p><strong>æ ¸å¿ƒè§„åˆ™</strong>ï¼šå‰ä¸€ä¸ªæ­¥éª¤çš„è¾“å‡ºï¼Œè‡ªåŠ¨ä½œä¸ºåä¸€ä¸ªæ­¥éª¤çš„è¾“å…¥ã€‚</p>
</blockquote>
<pre><code class="hljs language-scss" lang="scss">
<span class="hljs-comment">// æ•°æ®æµå‘ï¼š</span>
<span class="hljs-selector-tag">input</span> â†’ step1 â†’ step2 â†’ step3 â†’ output
        â†‘<span class="hljs-selector-class">.pipe</span>()â†‘<span class="hljs-selector-class">.pipe</span>()â†‘
</code></pre>
<h3 data-id="heading-2">ğŸŒ° æœ€ç®€ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatPromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/prompts"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOpenAI</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/openai"</span>;

<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">ChatPromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">"ä½ å¥½ï¼Œ{name}ï¼"</span>);
<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOpenAI</span>();

<span class="hljs-comment">// æ„å»ºé“¾</span>
<span class="hljs-keyword">const</span> chain = prompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">content</span>); <span class="hljs-comment">// â€œä½ å¥½ï¼Œå°æ˜ï¼â€</span>
</code></pre>
<p>è¿™é‡Œï¼š</p>
<ul>
<li><code>prompt</code>Â æ¥æ”¶Â <code>{ name: "å°æ˜" }</code>ï¼Œè¾“å‡ºæ¶ˆæ¯æ•°ç»„</li>
<li><code>.pipe(model)</code>Â å°†è¯¥æ•°ç»„ä¼ ç»™æ¨¡å‹</li>
<li>æ¨¡å‹è¿”å›Â <code>AIMessage</code></li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€<code>.pipe()</code>Â çš„åº•å±‚æœºåˆ¶ï¼šä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤å¼ºå¤§ï¼Ÿ</h2>
<h3 data-id="heading-4">ğŸ”§ 1. è‡ªåŠ¨åŒ…è£…æ™®é€šå‡½æ•°</h3>
<p>ä½ ç”šè‡³å¯ä»¥ç›´æ¥æŠŠæ™®é€š JavaScript å‡½æ•°å¡è¿›ç®¡é“ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> chain = prompt
  .<span class="hljs-title function_">pipe</span>(<span class="hljs-function">(<span class="hljs-params">messages</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å‘é€ç»™æ¨¡å‹çš„æ¶ˆæ¯ï¼š"</span>, messages);
    <span class="hljs-keyword">return</span> messages; <span class="hljs-comment">// å¿…é¡»è¿”å›ï¼</span>
  })
  .<span class="hljs-title function_">pipe</span>(model)
  .<span class="hljs-title function_">pipe</span>(<span class="hljs-function">(<span class="hljs-params">aiMessage</span>) =&gt;</span> aiMessage.<span class="hljs-property">content</span>.<span class="hljs-title function_">trim</span>()); <span class="hljs-comment">// æå–çº¯æ–‡æœ¬</span>

<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">input</span>: <span class="hljs-string">"1+1=?"</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// "2"</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ LangChain ä¼šè‡ªåŠ¨å°† <code>(x) =&gt; x</code> åŒ…è£…æˆ <code>Runnable</code>ï¼Œæ— éœ€æ‰‹åŠ¨å®ç° <code>.invoke()</code>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">âš™ï¸ 2. æ”¯æŒå¼‚æ­¥ä¸æµå¼ï¼ˆStreamingï¼‰</h3>
<p>æ•´ä¸ªé“¾å¤©ç„¶æ”¯æŒå¼‚æ­¥å’Œæµå¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">
<span class="hljs-comment">// æµå¼é€å­—è¾“å‡º</span>
<span class="hljs-function"><span class="hljs-keyword">for</span> <span class="hljs-title">await</span> <span class="hljs-params">(<span class="hljs-type">const</span> chunk of await chain.stream({ input: <span class="hljs-string">"è®²ä¸ªç¬‘è¯"</span> }))</span> </span>{
  process.stdout.<span class="hljs-built_in">write</span>(chunk.content);
}
</code></pre>
<p>åªè¦é“¾ä¸­ä»»æ„ç¯èŠ‚æ”¯æŒ <code>.stream()</code>ï¼ˆå¦‚ <code>ChatModel</code>ï¼‰ï¼Œæ•´æ¡é“¾å°±æ”¯æŒæµå¼ï¼</p>
<hr/>
<h3 data-id="heading-6">ğŸ“¦ 3. è¿”å›å€¼ä»æ˜¯Â <code>Runnable</code>Â â€”â€” å¯æ— é™ç»„åˆ</h3>
<p><code>.pipe()</code> çš„è¿”å›å€¼æœ¬èº«å°±æ˜¯ä¸€ä¸ª <code>Runnable</code>ï¼Œå› æ­¤å¯ä»¥ï¼š</p>
<ul>
<li>ç»§ç»­Â <code>.pipe()</code>Â æ‰©å±•</li>
<li>è¢«å…¶ä»–é“¾å¤ç”¨</li>
<li>ä½œä¸ºå·¥å…·ï¼ˆToolï¼‰åµŒå…¥ Agent</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">
const <span class="hljs-attr">baseChain</span> = prompt.pipe(model)<span class="hljs-comment">;</span>
const <span class="hljs-attr">enhancedChain</span> = baseChain.pipe(jsonParser).pipe(validateData)<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€<code>.pipe()</code>Â çš„å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-8">åœºæ™¯ 1ï¼šè°ƒè¯•ä¸­é—´ç»“æœï¼ˆå¼€å‘å¿…å¤‡ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">debug</span> = (<span class="hljs-params">label</span>) =&gt; <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${label}</span>]`</span>, data);
  <span class="hljs-keyword">return</span> data;
};

<span class="hljs-keyword">const</span> chain = prompt
  .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">debug</span>(<span class="hljs-string">"æ¸²æŸ“åçš„ Prompt"</span>))
  .<span class="hljs-title function_">pipe</span>(model)
  .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">debug</span>(<span class="hljs-string">"æ¨¡å‹åŸå§‹è¾“å‡º"</span>));
</code></pre>
<blockquote>
<p>âœ… è¿™æ˜¯æ’æŸ¥â€œæ¨¡å‹ä¸ºä»€ä¹ˆç­”é”™â€çš„æœ€æœ‰æ•ˆæ‰‹æ®µã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">åœºæ™¯ 2ï¼šæ•°æ®é¢„å¤„ç† / åå¤„ç†</h3>
<pre><code class="hljs language-ini" lang="ini">
// é™åˆ¶å†å²æ¶ˆæ¯é•¿åº¦ï¼ˆé˜² token è¶…é™ï¼‰
const <span class="hljs-attr">trimHistory</span> = (messages) =&gt; messages.slice(-<span class="hljs-number">6</span>)<span class="hljs-comment">;</span>

// æå– JSON å†…å®¹
const <span class="hljs-attr">extractJson</span> = (aiMsg) =&gt; JSON.parse(aiMsg.content)<span class="hljs-comment">;</span>

const <span class="hljs-attr">chain</span> = prompt
  .pipe(trimHistory)
  .pipe(model)
  .pipe(extractJson)<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-10">åœºæ™¯ 3ï¼šä¸ OutputParser é…åˆç»“æ„åŒ–è¾“å‡º</h3>
<pre><code class="hljs language-ini" lang="ini">
import { JsonOutputParser } from "@langchain/core/output_parsers"<span class="hljs-comment">;</span>
import { z } from "zod"<span class="hljs-comment">;</span>

const <span class="hljs-attr">schema</span> = z.object({ answer: z.string(), confidence: z.number() })<span class="hljs-comment">;</span>
const <span class="hljs-attr">parser</span> = new JsonOutputParser(schema)<span class="hljs-comment">;</span>

const <span class="hljs-attr">chain</span> = prompt.pipe(model).pipe(parser)<span class="hljs-comment">;</span>

const <span class="hljs-attr">result</span> = await chain.invoke({ question: <span class="hljs-string">"åœ°çƒæ˜¯åœ†çš„å—ï¼Ÿ"</span> })<span class="hljs-comment">;</span>
// { answer: "æ˜¯çš„", confidence: 0.98 }
</code></pre>
<blockquote>
<p>ğŸ¯ <code>.pipe(parser)</code> è‡ªåŠ¨å®Œæˆï¼šæå– JSON â†’ éªŒè¯ Schema â†’ è¿”å› JS å¯¹è±¡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">åœºæ™¯ 4ï¼šæ„å»ºå¸¦è®°å¿†çš„å¯¹è¯é“¾</h3>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RunnableWithMessageHistory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/runnables"</span>;

<span class="hljs-keyword">const</span> baseChain = prompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-keyword">const</span> chainWithMemory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RunnableWithMessageHistory</span>({
  <span class="hljs-attr">runnable</span>: baseChain,
  <span class="hljs-attr">getMessageHistory</span>: <span class="hljs-keyword">async</span> () =&gt; chatHistory,
  <span class="hljs-attr">inputMessagesKey</span>: <span class="hljs-string">"input"</span>,
  <span class="hljs-attr">historyMessagesKey</span>: <span class="hljs-string">"history"</span>
});
</code></pre>
<p>æ³¨æ„ï¼š<code>baseChain</code> æœ¬èº«å°±æ˜¯é€šè¿‡ <code>.pipe()</code> æ„å»ºçš„ï¼</p>
<hr/>
<h2 data-id="heading-12">å››ã€<code>.pipe()</code>Â vs æ‰‹åŠ¨è°ƒç”¨ï¼šä¸ºä»€ä¹ˆå¿…é¡»ç”¨å®ƒï¼Ÿ</h2>

























<table><thead><tr><th>æ–¹å¼</th><th>é—®é¢˜</th><th><code>.pipe()</code>Â çš„ä¼˜åŠ¿</th></tr></thead><tbody><tr><td>æ‰‹åŠ¨Â <code>await model(await prompt(...))</code></td><td>æ— æ³•æµå¼ã€éš¾è°ƒè¯•ã€éš¾å¤ç”¨</td><td>æ”¯æŒÂ <code>.stream()</code>ã€<code>.batch()</code>ã€ä¸­é—´ä»¶æ’å…¥</td></tr><tr><td>é€»è¾‘è€¦åˆåœ¨å‡½æ•°å†…</td><td>ä¿®æ”¹ä¸€å¤„å½±å“æ•´ä½“</td><td>æ¯ä¸€æ­¥ç‹¬ç«‹ï¼Œé«˜å†…èšä½è€¦åˆ</td></tr><tr><td>æ— æ³•åˆ©ç”¨ LangChain ç”Ÿæ€</td><td>éœ€è‡ªå·±å¤„ç†æ ¼å¼è½¬æ¢</td><td>è‡ªåŠ¨é€‚é…Â <code>BaseMessage</code>ã€<code>Document</code>Â ç­‰ç±»å‹</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong><code>.pipe()</code> æ˜¯ LangChain å®ç°â€œå£°æ˜å¼ AI ç¼–ç¨‹â€çš„åŸºçŸ³ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-13">äº”ã€é«˜çº§æŠ€å·§ï¼šè¶…è¶ŠåŸºç¡€ç”¨æ³•</h2>
<h3 data-id="heading-14">æŠ€å·§ 1ï¼šæ¡ä»¶åˆ†æ”¯ï¼ˆç»“åˆÂ <code>.assign()</code>ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">
const <span class="hljs-attr">chain</span> = RunnableSequence.from([
  prompt,
  model,
  (output) =&gt; {
    if (output.content.includes(<span class="hljs-string">"é”™è¯¯"</span>)) {
      return fallbackModel.invoke(prompt)<span class="hljs-comment">;</span>
    }
    return output<span class="hljs-comment">;</span>
  }
])<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>ï¼ˆæ³¨ï¼šå¤æ‚åˆ†æ”¯å»ºè®®ç”¨ <code>RunnableBranch</code>ï¼‰</p>
</blockquote>
<hr/>
<h3 data-id="heading-15">æŠ€å·§ 2ï¼šå¹¶è¡Œå¤„ç†ï¼ˆç”¨Â <code>RunnableMap</code>ï¼‰</h3>
<pre><code class="hljs language-css" lang="css">
const parallelChain = RunnableMap<span class="hljs-selector-class">.from</span>({
  <span class="hljs-selector-tag">summary</span>: summaryChain,
  keywords: keywordChain
});

// ç»“æœï¼š{ <span class="hljs-selector-tag">summary</span>: <span class="hljs-string">"..."</span>, keywords: [<span class="hljs-string">"..."</span>] }
</code></pre>
<p>è™½ç„¶ä¸æ˜¯ <code>.pipe()</code>ï¼Œä½†å®ƒæ˜¯ LCEL ç»„åˆä½“ç³»çš„ä¸€éƒ¨åˆ†ã€‚</p>
<hr/>
<h3 data-id="heading-16">æŠ€å·§ 3ï¼šé”™è¯¯é‡è¯•ï¼ˆFallbacksï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">
const <span class="hljs-attr">robustChain</span> = primaryChain.withFallbacks([backupChain])<span class="hljs-comment">;</span>
</code></pre>
<p>å½“ä¸»é“¾å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢å¤‡ç”¨é“¾ã€‚</p>
<hr/>
<h2 data-id="heading-17">å…­ã€å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-18">âŒ è¯¯åŒº 1ï¼šå¿˜è®°Â <code>return</code>Â åœ¨è°ƒè¯•å‡½æ•°ä¸­</h3>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// é”™è¯¯ï¼ä¸‹ä¸€æ­¥æ”¶åˆ° undefined</span>
.<span class="hljs-title function_">pipe</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x))

<span class="hljs-comment">// æ­£ç¡®</span>
.<span class="hljs-title function_">pipe</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x); <span class="hljs-keyword">return</span> x; })
</code></pre>
<h3 data-id="heading-19">âŒ è¯¯åŒº 2ï¼šåœ¨ç®¡é“ä¸­åšå‰¯ä½œç”¨ä½†ä¸è¿”å›</h3>
<p>æ‰€æœ‰ä¸­é—´å‡½æ•°<strong>å¿…é¡»è¿”å›æ•°æ®</strong>ï¼Œå¦åˆ™é“¾æ–­è£‚ã€‚</p>
<h3 data-id="heading-20">âœ… æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>å‘½åæ¸…æ™°</strong>ï¼š<code>prompt â†’ callModel â†’ parseResponse</code></li>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªÂ <code>.pipe()</code>Â æ­¥éª¤åªåšä¸€ä»¶äº‹</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨å†…ç½®ç»„ä»¶</strong>ï¼šå¦‚Â <code>JsonOutputParser</code>Â è€Œéæ‰‹å†™Â <code>JSON.parse</code></li>
<li><strong>å¼€å‘æœŸåŠ è°ƒè¯•èŠ‚ç‚¹</strong>ï¼Œä¸Šçº¿å‰å¯ç§»é™¤æˆ–å¼€å…³æ§åˆ¶</li>
</ol>
<hr/>
<h2 data-id="heading-21">ä¸ƒã€æ€»ç»“ï¼š<code>.pipe()</code>Â çš„æ ¸å¿ƒä»·å€¼</h2>

























<table><thead><tr><th>ç»´åº¦</th><th>ä»·å€¼</th></tr></thead><tbody><tr><td><strong>å¼€å‘ä½“éªŒ</strong></td><td>å£°æ˜å¼ã€çº¿æ€§ã€æ˜“è¯»æ˜“ç»´æŠ¤</td></tr><tr><td><strong>å¯ç»„åˆæ€§</strong></td><td>åƒä¹é«˜ä¸€æ ·æ‹¼è£… AI ç»„ä»¶</td></tr><tr><td><strong>ç”Ÿæ€é›†æˆ</strong></td><td>æ— ç¼å¯¹æ¥ LangChain çš„ Memoryã€Agentã€Tool ç­‰</td></tr><tr><td><strong>å·¥ç¨‹èƒ½åŠ›</strong></td><td>åŸç”Ÿæ”¯æŒæµå¼ã€æ‰¹å¤„ç†ã€å›è°ƒã€é…ç½®é€ä¼ </td></tr></tbody></table>
<blockquote>
<p>ğŸ¯ <strong>è®°ä½</strong>ï¼š<br/>
<strong>LangChain ä¸æ˜¯è®©ä½ â€œè°ƒç”¨ä¸€æ¬¡æ¨¡å‹â€ï¼Œè€Œæ˜¯è®©ä½ â€œæ„å»ºä¸€ä¸ªå¯æ¼”è¿›çš„ AI ç³»ç»Ÿâ€ã€‚</strong><br/>
è€Œ <code>.pipe()</code>ï¼Œå°±æ˜¯æ­å»ºè¿™ä¸ªç³»ç»Ÿçš„â€œç®¡é“æ¥å£â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-22">å…«ã€åŠ¨æ‰‹è¯•è¯•ï¼</h2>
<p>ç°åœ¨ï¼Œå°è¯•é‡æ„ä½ çš„ AI é“¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">
// æ—§å†™æ³•ï¼ˆä¸æ¨èï¼‰
const <span class="hljs-attr">messages</span> = await prompt.invoke(input)<span class="hljs-comment">;</span>
const <span class="hljs-attr">raw</span> = await model.invoke(messages)<span class="hljs-comment">;</span>
const <span class="hljs-attr">result</span> = JSON.parse(raw.content)<span class="hljs-comment">;</span>

// æ–°å†™æ³•ï¼ˆæ¨èï¼‰
const <span class="hljs-attr">chain</span> = prompt.pipe(model).pipe((m) =&gt; JSON.parse(m.content))<span class="hljs-comment">;</span>
const <span class="hljs-attr">result</span> = await chain.invoke(input)<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ ä¼šå‘ç°ï¼š<strong>ä»£ç æ›´çŸ­ã€æ›´æ¸…æ™°ã€æ›´å®¹æ˜“æ‰©å±•ï¼</strong></p>
<hr/>
<p>æŒæ¡ <code>.pipe()</code>ï¼Œä½ å°±æŒæ¡äº† LangChain çš„â€œç»„åˆé­”æ³•â€ã€‚ä»æ­¤ï¼Œæ„å»ºå¤æ‚çš„ AI åº”ç”¨ä¸å†æ˜¯å †ç Œä»£ç ï¼Œè€Œæ˜¯ä¸€åœºä¼˜é›…çš„æ¨¡å—æ‹¼è£…ä¹‹æ—… ğŸš€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PowerShell ç¥æ“ä½œï¼šè¾“å…¥ã€Œpã€ç›´æ¥å½“ã€Œpnpmã€ç”¨ï¼Œæ•²å‘½ä»¤é€Ÿåº¦ç¿»å€ï¼]]></title>    <link>https://juejin.cn/post/7589386219450531855</link>    <guid>https://juejin.cn/post/7589386219450531855</guid>    <pubDate>2025-12-30T08:38:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589386219450531855" data-draft-id="7589445154533752884" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PowerShell ç¥æ“ä½œï¼šè¾“å…¥ã€Œpã€ç›´æ¥å½“ã€Œpnpmã€ç”¨ï¼Œæ•²å‘½ä»¤é€Ÿåº¦ç¿»å€ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-30T08:38:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯å¿å¹´"/> <meta itemprop="url" content="https://juejin.cn/user/2277843825591400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PowerShell ç¥æ“ä½œï¼šè¾“å…¥ã€Œpã€ç›´æ¥å½“ã€Œpnpmã€ç”¨ï¼Œæ•²å‘½ä»¤é€Ÿåº¦ç¿»å€ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2277843825591400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯å¿å¹´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:38:21.000Z" title="Tue Dec 30 2025 08:38:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PowerShell ä¸­è®¾ç½® <code>p</code> åˆ«åè§£æä¸º <code>pnpm</code> çš„æ“ä½œæŒ‡å—</h2>
<p>å‰ç«¯å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦ä½¿ç”¨ <code>pnpm install</code>ã€<code>pnpm dev</code>ã€<code>pnpm build</code> ç­‰å‘½ä»¤ã€‚é€šè¿‡è®¾ç½®åˆ«åï¼Œå¯ä»¥å°†è¿™äº›å‘½ä»¤ç®€åŒ–ä¸º <code>p install</code>ã€<code>p dev</code>ã€<code>p build</code>ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h3 data-id="heading-1">åŠŸèƒ½è¯´æ˜</h3>
<p>åœ¨ PowerShell ç»ˆç«¯ä¸­è¾“å…¥ <code>p</code>ï¼Œè‡ªåŠ¨è§£æä¸º <code>pnpm</code> å‘½ä»¤ï¼ˆä¾‹å¦‚ <code>p install</code> ç­‰ä»·äº <code>pnpm install</code>ï¼‰ï¼Œé€šè¿‡é…ç½® PowerShell åˆ«åå®ç°ï¼Œæ°¸ä¹…ç”Ÿæ•ˆã€‚</p>
<h3 data-id="heading-2">æ“ä½œæ­¥éª¤</h3>
<h4 data-id="heading-3">æ­¥éª¤1ï¼šæ‰“å¼€ PowerShell</h4>
<p>æŒ‰ <code>Win + R</code> é”®ï¼Œè¾“å…¥ <code>powershell</code>ï¼Œç‚¹å‡»ç¡®å®šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b91166f4ed241d7afd6aa8571476ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y2_5bm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688701&amp;x-signature=NrkdyvKbVwLvShZ6NorRX%2FYiYAY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">æ­¥éª¤2ï¼šæ‰“å¼€ PowerShell é…ç½®æ–‡ä»¶</h4>
<p>åœ¨ PowerShell ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶ï¼ˆé¦–æ¬¡æ‰§è¡Œä¼šè‡ªåŠ¨åˆ›å»ºï¼‰ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">notepad $PROFILE
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db4ce2b2a4b347c7baba8ce6462ad562~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y2_5bm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688701&amp;x-signature=UUZBLjljRNbCrO%2FV7pJXhz4Zsg8%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p><strong>æç¤º</strong>ï¼šå¦‚æœæç¤ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶ã€‚</p>
</blockquote>
<h4 data-id="heading-5">æ­¥éª¤3ï¼šæ·»åŠ åˆ«åé…ç½®</h4>
<p>åœ¨è®°äº‹æœ¬ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼ˆé…ç½® <code>p</code> å¯¹åº” <code>pnpm</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">Set-Alias -Name p -Value pnpm
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f671004a6aa4a8187b612eabce9e496~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y2_5bm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688701&amp;x-signature=yt7LUCzwfgl9DE7DHgQr%2FXKlPYM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">æ­¥éª¤4ï¼šä¿å­˜é…ç½®æ–‡ä»¶</h4>
<h5 data-id="heading-7">æƒ…å†µAï¼šç›´æ¥ä¿å­˜æˆåŠŸ</h5>
<p>ç›´æ¥æŒ‰ <code>Ctrl + S</code> ä¿å­˜å³å¯ã€‚</p>
<h5 data-id="heading-8">æƒ…å†µBï¼šå¼¹å‡ºã€Œå¦å­˜ä¸ºã€çª—å£</h5>
<p>è‹¥å¼¹å‡ºã€Œå¦å­˜ä¸ºã€çª—å£ï¼ŒæŒ‰ä»¥ä¸‹è·¯å¾„ä¿å­˜ï¼š</p>
<ol>
<li>å·¦ä¾§å¯¼èˆªæ ç‚¹å‡» <strong>ã€Œæ–‡æ¡£ã€</strong>ï¼ˆå¯¹åº”è‹±æ–‡ <code>Documents</code> æ–‡ä»¶å¤¹ï¼‰</li>
<li>åœ¨ã€Œæ–‡æ¡£ã€ä¸­æ–°å»ºæ–‡ä»¶å¤¹ï¼Œå‘½åä¸º <code>WindowsPowerShell</code></li>
<li>è¿›å…¥ <code>WindowsPowerShell</code> æ–‡ä»¶å¤¹</li>
<li>æ–‡ä»¶åè¾“å…¥ï¼š<code>Microsoft.PowerShell_profile.ps1</code>ï¼ˆ<strong>åç¼€å¿…é¡»ä¸º <code>.ps1</code></strong>ï¼‰</li>
<li>ç‚¹å‡»ã€Œä¿å­˜ã€</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca1e8d660add4eda940fd0a21057fbba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y2_5bm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688701&amp;x-signature=ZSuJsZ7qkn0f%2FndeyMX6eTjBvcc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">æ­¥éª¤5ï¼šä½¿é…ç½®ç”Ÿæ•ˆ</h4>
<p>å›åˆ° PowerShellï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åŠ è½½é…ç½®ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">. $PROFILE
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7e71cccb59b4b199e88a4955c067a9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y2_5bm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688701&amp;x-signature=IKBgF9cAV%2Bwn5OGpi8KCXs8Qmdg%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">æ­¥éª¤6ï¼šéªŒè¯æ•ˆæœ</h4>
<p>åœ¨ PowerShell ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">p --version  # ç­‰ä»·äº pnpm --versionï¼Œä¼šè¾“å‡º pnpm ç‰ˆæœ¬å·
</code></pre>
<p>å¦‚æœæ˜¾ç¤º pnpm ç‰ˆæœ¬å·ï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼</p>
<h3 data-id="heading-11">å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹</h3>
<p>é…ç½®æˆåŠŸåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç®€åŒ–å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell"># å®‰è£…ä¾èµ–
p install

# å¼€å‘æ¨¡å¼
p dev

# æ„å»ºé¡¹ç›®
p build

# æ·»åŠ ä¾èµ–
p add &lt;package-name&gt;

# ç§»é™¤ä¾èµ–
p remove &lt;package-name&gt;

# æŸ¥çœ‹ç‰ˆæœ¬
p --version
</code></pre>
<h3 data-id="heading-12">æ•…éšœæ’é™¤</h3>
<h4 data-id="heading-13">é—®é¢˜1ï¼šæ‰§è¡Œ <code>p</code> å‘½ä»¤æç¤º"æ— æ³•è¯†åˆ«å‘½ä»¤"</h4>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ç¡®è®¤å·²æ‰§è¡Œ <code>. $PROFILE</code> åŠ è½½é…ç½®</li>
<li>æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„ï¼š<code>echo $PROFILE</code></li>
<li>ç¡®è®¤é…ç½®æ–‡ä»¶å†…å®¹æ˜¯å¦æ­£ç¡®</li>
<li>é‡æ–°æ‰“å¼€ PowerShell çª—å£</li>
</ol>
<h4 data-id="heading-14">é—®é¢˜2ï¼šé…ç½®æ–‡ä»¶æ— æ³•ä¿å­˜</h4>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell</li>
<li>æ£€æŸ¥æ–‡ä»¶è·¯å¾„æƒé™</li>
<li>æ‰‹åŠ¨åˆ›å»º <code>WindowsPowerShell</code> æ–‡ä»¶å¤¹</li>
</ol>
<h4 data-id="heading-15">é—®é¢˜3ï¼šåˆ«ååœ¨æ¯æ¬¡æ–°çª—å£æ‰“å¼€æ—¶å¤±æ•ˆ</h4>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
ç¡®è®¤é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼ŒPowerShell å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åŠ è½½ <code>$PROFILE</code> æŒ‡å‘çš„æ–‡ä»¶ã€‚</p>
<h4 data-id="heading-16">é—®é¢˜4ï¼šæƒ³ç§»é™¤åˆ«å</h4>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ é™¤æˆ–æ³¨é‡Šæ‰ <code>Set-Alias -Name p -Value pnpm</code> è¿™ä¸€è¡Œï¼Œç„¶åæ‰§è¡Œ <code>. $PROFILE</code> é‡æ–°åŠ è½½é…ç½®ã€‚</p>
<h3 data-id="heading-17">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>åˆ«å <code>p</code> ä»…åœ¨å½“å‰ PowerShell ä¼šè¯ä¸­ç”Ÿæ•ˆï¼Œæ–°çª—å£ä¼šè‡ªåŠ¨åŠ è½½</li>
<li>å¦‚æœç³»ç»Ÿä¸­å·²æœ‰å…¶ä»– <code>p</code> å‘½ä»¤ï¼Œæ­¤åˆ«åä¼šè¦†ç›–å®ƒ</li>
<li>é…ç½®æ–‡ä»¶è·¯å¾„é€šå¸¸ä¸ºï¼š<code>C:\Users\&lt;ç”¨æˆ·å&gt;\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</code></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaå¯¹æ¯”Python 3.10+ å…¨æ ˆè¯­æ³•ä¸åº•å±‚è¿›é˜¶ç™¾ç§‘å…¨ä¹¦]]></title>    <link>https://juejin.cn/post/7588388014505705514</link>    <guid>https://juejin.cn/post/7588388014505705514</guid>    <pubDate>2025-12-29T03:35:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588388014505705514" data-draft-id="7588730836864417807" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaå¯¹æ¯”Python 3.10+ å…¨æ ˆè¯­æ³•ä¸åº•å±‚è¿›é˜¶ç™¾ç§‘å…¨ä¹¦"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-29T03:35:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹¥ä¸¶ç›¸è§"/> <meta itemprop="url" content="https://juejin.cn/user/2330620381380311"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaå¯¹æ¯”Python 3.10+ å…¨æ ˆè¯­æ³•ä¸åº•å±‚è¿›é˜¶ç™¾ç§‘å…¨ä¹¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2330620381380311/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹¥ä¸¶ç›¸è§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T03:35:14.000Z" title="Mon Dec 29 2025 03:35:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™ä»½æ–‡æ¡£æ˜¯ä¸ºä½ â€”â€”ä¸€ä½ <strong>Java 17 èµ„æ·±å¼€å‘è€…</strong>é‡èº«å®šåˆ¶çš„ <strong>Python 3.10+ å…¨æ ˆè¯­æ³•ä¸åº•å±‚è¿›é˜¶ç™¾ç§‘å…¨ä¹¦</strong>ã€‚</p>
<p>å®ƒèåˆäº†åº•å±‚è¿è¡Œæœºåˆ¶ã€ç°ä»£è¯­æ³•ç‰¹æ€§ã€è·¨è¯­è¨€æ¨ªå‘å¯¹æ¯”ä»¥åŠå·¥ç¨‹åŒ–å®è·µï¼Œæ—¨åœ¨å¸®åŠ©ä½ ä» JVM æ€ç»´æ— ç—›åˆ‡æ¢è‡³ Pythonic æ€ç»´ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ Python 3.10+ å…¨æ ˆè¿›é˜¶ç™¾ç§‘å…¨ä¹¦ (Java 17 å…¼å®¹ç‰ˆ)</h2>
<h3 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒè¯­æ³•åŸºå‡†å¯¹ç…§è¡¨</h3>





























































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left"><strong>Java 17 (ä½ çš„åŸºå‡†)</strong></th><th align="left"><strong>Python 3.10+</strong></th><th align="left"><strong>Kotlin</strong></th><th align="left"><strong>TypeScript</strong></th></tr></thead><tbody><tr><td align="left"><strong>ä»£ç å—</strong></td><td align="left"><code>{ }</code> å¤§æ‹¬å·</td><td align="left"><strong>ç¼©è¿› (Indent)</strong></td><td align="left"><code>{ }</code></td><td align="left"><code>{ }</code></td></tr><tr><td align="left"><strong>å˜é‡å£°æ˜</strong></td><td align="left"><code>int x = 10;</code> / <code>var x = 10;</code></td><td align="left"><code>x: int = 10</code></td><td align="left"><code>val x = 10</code> / <code>var x = 10</code></td><td align="left"><code>const x = 10</code> / <code>let x = 10</code></td></tr><tr><td align="left"><strong>ç©ºå€¼</strong></td><td align="left"><code>null</code></td><td align="left"><strong><code>None</code></strong></td><td align="left"><code>null</code></td><td align="left"><code>null</code> / <code>undefined</code></td></tr><tr><td align="left"><strong>æ–¹æ³•å®šä¹‰</strong></td><td align="left"><code>public R name(P p) { }</code></td><td align="left"><code>def name(p: P) -&gt; R:</code></td><td align="left"><code>fun name(p: P): R { }</code></td><td align="left"><code>function name(p: P): R { }</code></td></tr><tr><td align="left"><strong>æ„é€ å‡½æ•°</strong></td><td align="left"><code>public ClassName() { }</code></td><td align="left"><code>def __init__(self):</code></td><td align="left"><code>constructor() { }</code></td><td align="left"><code>constructor() { }</code></td></tr><tr><td align="left"><strong>å½“å‰å®ä¾‹</strong></td><td align="left"><code>this</code> (éšå¼)</td><td align="left"><strong><code>self</code> (å¿…é¡»æ˜¾å¼åœ¨é¦–ä½)</strong></td><td align="left"><code>this</code></td><td align="left"><code>this</code></td></tr><tr><td align="left"><strong>å¯†å°ç±»/åŒ¹é…</strong></td><td align="left"><code>sealed class</code> + <code>permits</code></td><td align="left"><code>match ... case</code></td><td align="left"><code>sealed class</code> + <code>when</code></td><td align="left"><code>union types</code> + <code>switch</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-2">ç¬¬äºŒéƒ¨åˆ†ï¼šåº•å±‚é€»è¾‘å¯¹æ ‡ (JVM vs CPython)</h3>
<p>åœ¨å†™ä»£ç å‰ï¼Œå¿…é¡»ç†è§£ä¸¤è€…â€œä¸–ç•Œè§‚â€çš„å·®å¼‚ï¼š</p>
<ol>
<li><strong>è¿è¡Œæ¨¡å‹ (GIL vs JIT)</strong>ï¼š
<ul>
<li><strong>Java</strong>ï¼šçœŸå¤šçº¿ç¨‹å¹¶è¡Œï¼Œä¾èµ– JIT ç¼–è¯‘ä¼˜åŒ–ã€‚</li>
<li><strong>Python</strong>ï¼šæ‹¥æœ‰ <strong>GIL (å…¨å±€è§£é‡Šå™¨é”)</strong>ã€‚åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå­—èŠ‚ç ã€‚</li>
<li><strong>ç»“è®º</strong>ï¼šè®¡ç®—å¯†é›†å‹ä»»åŠ¡ç”¨ <code>multiprocessing</code>ï¼ˆå¤šè¿›ç¨‹ï¼‰ï¼ŒIO å¯†é›†å‹ç”¨ <code>asyncio</code>ã€‚</li>
</ul>
</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼š
<ul>
<li><strong>Java</strong>ï¼šå¯è¾¾æ€§åˆ†æï¼Œç”± GCï¼ˆG1/ZGCï¼‰è´Ÿè´£æ‰«æã€‚</li>
<li><strong>Python</strong>ï¼šæ ¸å¿ƒæ˜¯ <strong>å¼•ç”¨è®¡æ•° (Reference Counting)</strong>ï¼Œè¾…ä»¥<strong>æ ‡è®°æ¸…é™¤</strong>è§£å†³å¾ªç¯å¼•ç”¨ã€‚å¯¹è±¡å¼•ç”¨å½’é›¶æ—¶ç«‹å³é‡Šæ”¾ã€‚</li>
</ul>
</li>
<li><strong>ä½œç”¨åŸŸ (LEGB Rule)</strong>ï¼š
<ul>
<li>Python æ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼ˆ<code>if/for</code> å—å†…å®šä¹‰çš„å˜é‡å—å¤–å¯è§ï¼‰ã€‚å˜é‡æŸ¥æ‰¾é¡ºåºï¼šLocal -&gt; Enclosing (é—­åŒ…) -&gt; Global -&gt; Built-inã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-3">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒè¿›é˜¶ç‰¹æ€§æ·±åº¦è§£æ</h3>
<h4 data-id="heading-4">1. ç±»å‹æ³¨è§£ä¸ç»“æ„åŒ–åŒ¹é… (Java Record &amp; Switch å¢å¼º)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼šJava 17 çš„ <code>record</code> å’Œæ¨¡å¼åŒ¹é… <code>switch</code>ã€‚</li>
<li><strong>Python å®æˆ˜</strong>ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    role: <span class="hljs-built_in">str</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_user</span>(<span class="hljs-params">data: User | <span class="hljs-built_in">dict</span></span>): <span class="hljs-comment"># 3.10+ è”åˆç±»å‹å†™æ³•</span>
    <span class="hljs-keyword">match</span> data:
        <span class="hljs-keyword">case</span> User(<span class="hljs-built_in">id</span>=idx, role=<span class="hljs-string">"admin"</span>): <span class="hljs-comment"># ç»“æ„åŒ–è§£æ„</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Admin <span class="hljs-subst">{idx}</span> logged in"</span>)
        <span class="hljs-keyword">case</span> {<span class="hljs-string">"id"</span>: idx}: <span class="hljs-comment"># å­—å…¸è§£æ„</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Guest <span class="hljs-subst">{idx}</span>"</span>)
        <span class="hljs-keyword">case</span> _:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"Unknown"</span>)
</code></pre>
</li>
</ul>
<h4 data-id="heading-5">2. åè®® (Protocols) ä¸é­”æ³•æ–¹æ³•</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<code>interface</code>ã€‚</li>
<li><strong>Python é€»è¾‘</strong>ï¼šPython ä½¿ç”¨ <strong>é¸­å­ç±»å‹</strong>ã€‚å¦‚æœä½ å®ç°äº†ç‰¹æ®Šçš„â€œé­”æ³•æ–¹æ³•â€ï¼Œä½ å°±å®ç°äº†å¯¹åº”çš„â€œæ¥å£â€ã€‚
<ul>
<li><code>__call__</code>ï¼šä½¿å¯¹è±¡å¯è°ƒç”¨ï¼ˆç±»ä¼¼ <code>@FunctionalInterface</code>ï¼‰ã€‚</li>
<li><code>__getitem__</code>ï¼šä½¿å¯¹è±¡æ”¯æŒç´¢å¼•å–å€¼ï¼ˆç±»ä¼¼ <code>List.get()</code>ï¼‰ã€‚</li>
<li><code>__enter__ / __exit__</code>ï¼šæ”¯æŒ <code>with</code> è¯­å¥ï¼ˆç±»ä¼¼ <code>AutoCloseable</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">3. è£…é¥°å™¨ (Decorators)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<strong>Spring AOP</strong>ã€‚</li>
<li><strong>æœ¬è´¨</strong>ï¼šå®ƒæ˜¯é«˜é˜¶å‡½æ•°ï¼Œ<code>@log</code> è£…é¥° <code>func</code> ç­‰åŒäºæ‰§è¡Œ <code>func = log(func)</code>ã€‚
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">func</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Calling <span class="hljs-subst">{func.__name__}</span>"</span>)
        <span class="hljs-keyword">return</span> func(*args, **kwargs)
    <span class="hljs-keyword">return</span> wrapper
</code></pre>
</li>
</ul>
<h4 data-id="heading-7">4. å¼‚æ­¥ç¼–ç¨‹ (Async/Await)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<code>CompletableFuture</code> æˆ– Java 21 çš„è™šæ‹Ÿçº¿ç¨‹ã€‚</li>
<li><strong>å…³é”®ç‚¹</strong>ï¼šPython å¼‚æ­¥æ˜¯<strong>å•çº¿ç¨‹åä½œå¼</strong>ã€‚åœ¨ <code>await</code> å¤„æŒ‚èµ·ï¼Œè®©å‡º CPU ç»™å…¶ä»–åç¨‹ã€‚
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_data</span>():
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>) <span class="hljs-comment"># éé˜»å¡ä¼‘çœ </span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"data"</span>: <span class="hljs-number">200</span>}
</code></pre>
</li>
</ul>
<h4 data-id="heading-8">5. ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (Context Managers)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<code>try-with-resources</code>ã€‚</li>
<li><strong>Python ä¼˜é›…ä¹‹å¤„</strong>ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"config.json"</span>) <span class="hljs-keyword">as</span> f:
    data = f.read()
<span class="hljs-comment"># ç¦»å¼€ç¼©è¿›è‡ªåŠ¨å…³é—­æ–‡ä»¶</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-9">6. ç”Ÿæˆå™¨ (Generators / yield)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼šJava æ²¡æœ‰ç›´æ¥å¯¹åº”ï¼Œé€šå¸¸é€šè¿‡ <code>Iterator</code> æ¨¡æ‹Ÿã€‚</li>
<li><strong>ä»·å€¼</strong>ï¼šå¤„ç†æµ·é‡æ•°æ®æ—¶ï¼Œä¸€æ¬¡åªäº§å‡ºä¸€ä¸ªå€¼ï¼Œå†…å­˜å ç”¨æä½ã€‚
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">count_stream</span>():
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):
        <span class="hljs-keyword">yield</span> i <span class="hljs-comment"># æš‚åœå¹¶è¿”å›</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-10">7. å…ƒç±» (Metaclasses)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<strong>åŠ¨æ€ä»£ç† / å­—èŠ‚ç å¢å¼º (ByteBuddy)</strong>ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼šæ‹¦æˆªç±»çš„åˆ›å»ºè¿‡ç¨‹ã€‚æ¯”å¦‚æ‰€æœ‰ç»§æ‰¿è‡ª <code>BaseModel</code> çš„ç±»ï¼Œåœ¨åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥æ˜¯å¦å®šä¹‰äº†ä¸»é”®ã€‚</li>
</ul>
<h4 data-id="heading-11">8. å±æ€§æè¿°ç¬¦ (Descriptors)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼šLombok çš„åº•å±‚é€»è¾‘æˆ–è‡ªå®šä¹‰ Getter/Setterã€‚</li>
<li><strong>å®ç°</strong>ï¼šé€šè¿‡ <code>__get__</code> å’Œ <code>__set__</code> ä»£ç†å±æ€§è®¿é—®ï¼Œæ˜¯ Django ORM ç­‰æ¡†æ¶å®ç°çš„æ ¸å¿ƒã€‚</li>
</ul>
<h4 data-id="heading-12">9. å¼±å¼•ç”¨ (Weak References)</h4>
<ul>
<li><strong>Java å¯¹æ ‡</strong>ï¼š<code>WeakReference&lt;T&gt;</code>ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå®ç°å¤§å¯¹è±¡ç¼“å­˜ï¼Œé¿å…å› ç¼“å­˜å¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚</li>
</ul>
<h4 data-id="heading-13">10. å‡½æ•°å·¥å…· (functools)</h4>
<ul>
<li><strong>æ ¸å¿ƒå·¥å…·</strong>ï¼š
<ul>
<li><code>@lru_cache</code>ï¼šä¸€è¡Œä»£ç å®ç°æ–¹æ³•ç»“æœç¼“å­˜ã€‚</li>
<li><code>@wraps</code>ï¼šç¡®ä¿è£…é¥°å™¨ä¸ä¸¢å¤±åŸå‡½æ•°çš„å…ƒæ•°æ®ï¼ˆå¦‚å‡½æ•°åï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-14">ç¬¬å››éƒ¨åˆ†ï¼šå››è¯­è¨€â€œå…¨èƒ½ç¤ºä¾‹â€å»ºæ¨¡å¯¹æ¯”</h3>
<p><strong>åœºæ™¯ï¼šå¼‚æ­¥ç”¨æˆ·æœåŠ¡ï¼ŒåŒ…å«æ•°æ®å®šä¹‰ã€å¼‚æ­¥è·å–ä¸æµå¼å¤„ç†ã€‚</strong></p>
<h4 data-id="heading-15">Python 3.10+ (Modern Python)</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass
<span class="hljs-keyword">import</span> asyncio

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    uid: <span class="hljs-built_in">int</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span>:
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_async</span>(<span class="hljs-params">self, uid: <span class="hljs-built_in">int</span></span>) -&gt; User:
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
        <span class="hljs-keyword">return</span> User(uid)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_stream</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
            <span class="hljs-keyword">yield</span> User(i) <span class="hljs-comment"># ç”Ÿæˆå™¨</span>
</code></pre>
<h4 data-id="heading-16">Java 17</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">User</span><span class="hljs-params">(<span class="hljs-type">int</span> uid)</span> {}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">public</span> CompletableFuture&lt;User&gt; <span class="hljs-title function_">getUserAsync</span><span class="hljs-params">(<span class="hljs-type">int</span> uid)</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">try</span> { Thread.sleep(<span class="hljs-number">100</span>); } <span class="hljs-keyword">catch</span> (Exception e) {}
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(uid);
        });
    }

    <span class="hljs-keyword">public</span> Stream&lt;User&gt; <span class="hljs-title function_">getUserStream</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> IntStream.range(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).mapToObj(User::<span class="hljs-keyword">new</span>);
    }
}
</code></pre>
<h4 data-id="heading-17">Kotlin</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-keyword">val</span> uid: <span class="hljs-built_in">Int</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getUserAsync</span><span class="hljs-params">(uid: <span class="hljs-type">Int</span>)</span></span>: User {
        delay(<span class="hljs-number">100</span>)
        <span class="hljs-keyword">return</span> User(uid)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getUserStream</span><span class="hljs-params">()</span></span> = sequence {
        repeat(<span class="hljs-number">3</span>) { yield(User(it)) }
    }
}
</code></pre>
<h4 data-id="heading-18">TypeScript</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> { <span class="hljs-attr">uid</span>: <span class="hljs-built_in">number</span>; }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserAsync</span>(<span class="hljs-attr">uid</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">User</span>&gt; {
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(r, <span class="hljs-number">100</span>));
        <span class="hljs-keyword">return</span> { uid };
    }

    *<span class="hljs-title function_">getUserStream</span>(): <span class="hljs-title class_">IterableIterator</span>&lt;<span class="hljs-title class_">User</span>&gt; {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) <span class="hljs-keyword">yield</span> { <span class="hljs-attr">uid</span>: i };
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-19">ç¬¬äº”éƒ¨åˆ†ï¼šJava å¼€å‘è€…è½¬ Python é¿å‘æŒ‡å—</h3>
<ol>
<li><strong>å¯å˜é»˜è®¤å‚æ•°</strong>ï¼š
<ul>
<li>âŒ <code>def add(item, items=[])</code>ï¼šè¿™ä¸ª <code>[]</code> æ˜¯é™æ€çš„ï¼Œæ‰€æœ‰è°ƒç”¨å…±äº«åŒä¸€ä¸ªåˆ—è¡¨ï¼</li>
<li>âœ… <code>def add(item, items=None)</code>ï¼šå†…éƒ¨åˆå§‹åŒ– <code>if items is None: items = []</code>ã€‚</li>
</ul>
</li>
<li><strong>å¤šçº¿ç¨‹è¯¯åŒº</strong>ï¼š
<ul>
<li>ä¸è¦æŒ‡æœ› Python çš„ <code>threading</code> èƒ½åŠ é€Ÿ CPU å¯†é›†å‹è®¡ç®—ã€‚è®¡ç®—é‡å¤§è¯·ç›´å¥” <code>multiprocessing</code>ã€‚</li>
</ul>
</li>
<li><strong>å·¥ç¨‹åŒ–é€‰å‹</strong>ï¼š
<ul>
<li><strong>åŒ…ç®¡ç†</strong>ï¼šæ”¾å¼ƒ <code>pip</code>ï¼Œä½¿ç”¨ <strong>Poetry</strong> (ç±»ä¼¼ Maven/Gradle)ã€‚</li>
<li><strong>Lint/æ ¼å¼åŒ–</strong>ï¼šä½¿ç”¨ <strong>Ruff</strong> (æé€Ÿ Rust ç¼–å†™)ã€‚</li>
<li><strong>Web æ¡†æ¶</strong>ï¼šé¦–é€‰ <strong>FastAPI</strong> (åŸºäºç±»å‹æ³¨è§£ï¼Œè‡ªå¸¦ Swaggerï¼Œæ€§èƒ½å“è¶Š)ã€‚</li>
</ul>
</li>
<li><strong>ç›¸ç­‰æ€§åˆ¤æ–­</strong>ï¼š
<ul>
<li>Python çš„ <code>==</code> é»˜è®¤æ¯”è¾ƒå†…å®¹ï¼ˆç±»ä¼¼ Java çš„ <code>.equals()</code>ï¼‰ã€‚</li>
<li>Python çš„ <code>is</code> æ¯”è¾ƒå¼•ç”¨ï¼ˆç±»ä¼¼ Java çš„ <code>==</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p>è¿™ä»½ç™¾ç§‘å…¨ä¹¦å°† Python çš„çµæ´»æ€§ä¸ Java çš„ä¸¥è°¨æ€§æœ‰æœºç»“åˆã€‚å½“ä½ æŒæ¡äº† <strong>é­”æ³•æ–¹æ³•</strong>ã€<strong>å¼‚æ­¥åç¨‹</strong> å’Œ <strong>æ¨¡å¼åŒ¹é…</strong> åï¼Œä½ å°†èƒ½åœ¨ Python é¢†åŸŸå‘æŒ¥å‡ºç­‰åŒäº Java ä¸“å®¶çš„ç”Ÿäº§åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RocketMQé«˜æ€§èƒ½æ­ç§˜ï¼šæ‰¿è½½ä¸‡äº¿çº§æµé‡çš„æ¶æ„å¥¥ç§˜ï½œå¾—ç‰©æŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7589325011543932966</link>    <guid>https://juejin.cn/post/7589325011543932966</guid>    <pubDate>2025-12-30T08:42:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589325011543932966" data-draft-id="7589166195797835803" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RocketMQé«˜æ€§èƒ½æ­ç§˜ï¼šæ‰¿è½½ä¸‡äº¿çº§æµé‡çš„æ¶æ„å¥¥ç§˜ï½œå¾—ç‰©æŠ€æœ¯"/> <meta itemprop="keywords" content="åç«¯,RocketMQ"/> <meta itemprop="datePublished" content="2025-12-30T08:42:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—ç‰©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2392954206960247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RocketMQé«˜æ€§èƒ½æ­ç§˜ï¼šæ‰¿è½½ä¸‡äº¿çº§æµé‡çš„æ¶æ„å¥¥ç§˜ï½œå¾—ç‰©æŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392954206960247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—ç‰©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:42:16.000Z" title="Tue Dec 30 2025 08:42:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å¦‚åŒç•…é€šçš„â€œä¿¡æ¯ç¥ç»ç½‘ç»œâ€ï¼Œæ‰¿æ‹…ç€è§£è€¦ã€å‰Šå³°ä¸å¼‚æ­¥é€šä¿¡çš„æ ¸å¿ƒä½¿å‘½ã€‚åœ¨ä¼—å¤šæˆç†Ÿæ–¹æ¡ˆä¸­ï¼ŒRocketMQå‡­å€Ÿå…¶é˜¿é‡Œå·´å·´ä¸ApacheåŒé‡åŸºå› ï¼Œä»¥å“è¶Šçš„é‡‘èçº§å¯é æ€§ã€ä¸‡äº¿çº§æ¶ˆæ¯å †ç§¯èƒ½åŠ›å’Œçµæ´»çš„åˆ†å¸ƒå¼ç‰¹æ€§è„±é¢–è€Œå‡ºï¼Œæˆä¸ºæ„å»ºé«˜å¯ç”¨ã€é«˜æ€§èƒ½æ•°æ®æµè½¬æ¢çº½çš„å…³é”®æŠ€æœ¯é€‰å‹ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æRocketMQçš„æ ¸å¿ƒæ¶æ„ã€è®¾è®¡å“²å­¦ä¸å®è·µè¦ä¹‰ã€‚</p>
<h2 data-id="heading-1">äºŒã€RocketMQæ¶æ„æ€»è§ˆ</h2>
<p>å®˜ç½‘å›¾ç‰‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bdf1be17f15433abadb30355785add7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=Q5cXYft5vb6uHouUekXeCFN7dU0%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>RocketMQæ¶æ„ä¸Šä¸»è¦åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º:Â </p>
<p>RocketMQä½œä¸ºä¸€æ¬¾é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…¶æ ¸å¿ƒæ¶æ„é‡‡ç”¨äº†ç»å…¸çš„å››ç»„ä»¶ååŒè®¾è®¡ï¼Œå®ç°äº†æ¶ˆæ¯ç”Ÿäº§ã€å­˜å‚¨ã€è·¯ç”±ä¸æ¶ˆè´¹çš„å…¨é“¾è·¯è§£è€¦ä¸é«˜æ•ˆååŒã€‚<strong>å››å¤§ç»„ä»¶â€”â€”ç”Ÿäº§è€…ï¼ˆProducerï¼‰ã€æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ã€è·¯ç”±ä¸­å¿ƒï¼ˆNameServerï¼‰å’Œä»£ç†æœåŠ¡å™¨ï¼ˆBrokerï¼‰â€”â€”å„å¸å…¶èŒï¼Œå…±åŒæ„å»ºäº†å…¶åšå®çš„åŸºçŸ³ã€‚</strong></p>
<p><strong>ç”Ÿäº§è€…ï¼ˆProducerï¼‰</strong> ä½œä¸ºæ¶ˆæ¯çš„æºå¤´ï¼Œè´Ÿè´£å°†ä¸šåŠ¡æ¶ˆæ¯é«˜æ•ˆã€å¯é åœ°å‘å¸ƒåˆ°ç³»ç»Ÿä¸­ã€‚å®ƒæ”¯æŒåˆ†å¸ƒå¼é›†ç¾¤éƒ¨ç½²ï¼Œå¹¶é€šè¿‡å†…ç½®çš„æ™ºèƒ½è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼Œè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„BrokerèŠ‚ç‚¹ä¸é˜Ÿåˆ—è¿›è¡ŒæŠ•é€’ã€‚</p>
<p><strong>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰</strong> æ˜¯æ¶ˆæ¯çš„å¤„ç†ç»ˆç«¯ï¼ŒåŒæ ·ä»¥é›†ç¾¤åŒ–æ–¹å¼å·¥ä½œï¼Œæ”¯æŒæ¨é€ï¼ˆPushï¼‰å’Œæ‹‰å–ï¼ˆPullï¼‰ä¸¤ç§æ¶ˆæ¯è·å–æ¨¡å¼ã€‚å®ƒæä¾›äº†é›†ç¾¤æ¶ˆè´¹ä¸å¹¿æ’­æ¶ˆè´¹ä¸¤ç§æ¨¡å¼ï¼Œå¹¶èƒ½åŠ¨æ€ç»´æŠ¤å…¶è®¢é˜…å…³ç³»ã€‚</p>
<p><strong>è·¯ç”±ä¸­å¿ƒï¼ˆNameServerï¼‰</strong> æ˜¯æ•´ä¸ªæ¶æ„çš„â€œæ³¨å†Œä¸­å¿ƒâ€ï¼Œæ‰®æ¼”ç€è½»é‡çº§æœåŠ¡å‘ç°çš„è§’è‰²ã€‚æ‰€æœ‰BrokerèŠ‚ç‚¹éƒ½ä¼šå‘NameServeræ³¨å†Œï¼Œå¹¶é€šè¿‡å®šæœŸå¿ƒè·³æ±‡æŠ¥å¥åº·çŠ¶æ€ã€‚ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…åˆ™ä»NameServerè·å–å®æ—¶çš„ä¸»é¢˜è·¯ç”±ä¸Brokerä¿¡æ¯ï¼Œä»è€Œå®ç°æ¶ˆæ¯å¯»å€çš„å®Œå…¨è§£è€¦ã€‚</p>
<p><strong>ä»£ç†æœåŠ¡å™¨ï¼ˆBrokerï¼‰</strong> æ˜¯æ¶ˆæ¯å­˜å‚¨ä¸æµè½¬çš„æ ¸å¿ƒï¼Œè´Ÿè´£æ¶ˆæ¯çš„æŒä¹…åŒ–å­˜å‚¨ã€æŠ•é€’ä¸æŸ¥è¯¢ã€‚ä¸ºäº†ä¿éšœé«˜å¯ç”¨æ€§ï¼ŒBrokeré€šå¸¸é‡‡ç”¨ä¸»ä»ï¼ˆMaster-Slaveï¼‰éƒ¨ç½²æ¶æ„ï¼Œç¡®ä¿æ•°æ®ä¸æœåŠ¡åœ¨æ•…éšœæ—¶èƒ½æ— ç¼åˆ‡æ¢ã€‚å…¶å†…éƒ¨é›†æˆäº†é€šä¿¡å¤„ç†ã€å­˜å‚¨å¼•æ“ã€ç´¢å¼•æœåŠ¡å’Œé«˜å¯ç”¨å¤åˆ¶ç­‰æ ¸å¿ƒæ¨¡å—ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€æ ¸å¿ƒç»„ä»¶æ·±åº¦è§£æ</h2>
<h3 data-id="heading-3">NameServerï¼šè½»é‡çº§æœåŠ¡å‘ç°æ¢çº½</h3>
<p>NameServeræ˜¯RocketMQçš„<strong>è½»é‡çº§æœåŠ¡å‘ç°ä¸è·¯ç”±ä¸­å¿ƒï¼Œ</strong> å…¶æ ¸å¿ƒç›®æ ‡æ˜¯<strong>å®ç°ç”Ÿäº§æ¶ˆè´¹ä¸BrokeræœåŠ¡çš„è§£è€¦ã€‚</strong> å®ƒä¸å­˜å‚¨æ¶ˆæ¯æ•°æ®ï¼Œä»…ç®¡ç†è·¯ç”±å…ƒæ•°æ®ã€‚</p>
<p>æ ¸å¿ƒæ˜¯ä¸€å¼ çš„è·¯ç”±è¡¨Â HashMap&lt;String/* Topic */, List&gt;ï¼Œè®°å½•äº†æ¯ä¸ªTopicå¯¹åº”åœ¨å“ªäº›Brokerçš„å“ªäº›é˜Ÿåˆ—ä¸Šã€‚</p>
<p>å®¢æˆ·ç«¯å†…ç½®äº†æ•…éšœè§„é¿æœºåˆ¶ã€‚å¦‚æœä»æŸä¸ªNameServerè·å–è·¯ç”±å¤±è´¥ï¼Œæˆ–æ ¹æ®è·¯ç”±ä¿¡æ¯è®¿é—®Brokerå¤±è´¥ï¼Œä¼šè‡ªåŠ¨é‡è¯•å…¶ä»–NameServeræˆ–Brokerã€‚</p>
<p>1.Â <strong>æ ¸å¿ƒè§’è‰²ä¸è®¾è®¡å“²å­¦ï¼š</strong>Â NameServerçš„è®¾è®¡å“²å­¦æ˜¯Â <strong>â€œç®€å•ã€æ— çŠ¶æ€ã€æœ€ç»ˆä¸€è‡´â€ ã€‚</strong> æ¯ä¸ªNameServerèŠ‚ç‚¹ç‹¬ç«‹è¿è¡Œï¼Œ<strong>èŠ‚ç‚¹é—´äº’ä¸é€šä¿¡ï¼Œ</strong> è¿™ä½¿å…¶å…·å¤‡æå¼ºçš„æ°´å¹³æ‰©å±•èƒ½åŠ›å’Œæé«˜çš„å¯ç”¨æ€§ã€‚å®¢æˆ·ç«¯ä¼šé…ç½®æ‰€æœ‰NameServeråœ°å€ï¼Œå¹¶å‘å…¶å¹¿æ’­è¯·æ±‚ã€‚</p>
<p>2.Â <strong>æ ¸å¿ƒå·¥ä½œæœºåˆ¶ï¼š</strong> å…¶è¿ä½œå›´ç»•è·¯ç”±ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸå±•å¼€ï¼Œå¯é€šè¿‡ä¸‹å›¾ä¸€è§ˆå…¶æ ¸å¿ƒæµç¨‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b3280785213457baf0072075bf3d2c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=YWSVIizAw2fvUuXHhFa7xydVAQA%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>3. å’Œkafkaæ³¨å†Œä¸­å¿ƒå¯¹æ¯”</strong></p>
<ul>
<li><strong>NameServer</strong> é‡‡ç”¨Â <strong>â€œå»ä¸­å¿ƒåŒ–â€</strong>Â å’ŒÂ <strong>â€œæœ€ç»ˆä¸€è‡´â€</strong>Â æ€æƒ³ï¼Œ<strong>è¿½æ±‚æè‡´çš„ç®€å•ã€è½»é‡å’Œæ°´å¹³æ‰©å±•ï¼Œ</strong> ç‰ºç‰²äº†å¼ºä¸€è‡´æ€§ï¼Œä»¥æ¢å–æ¶æ„çš„ç®€æ´å’Œé«˜å¯ç”¨ã€‚è¿™éå¸¸é€‚åˆè·¯ç”±ä¿¡æ¯å˜åŠ¨ä¸é¢‘ç¹ã€å®¢æˆ·ç«¯å…·å¤‡å®¹é”™èƒ½åŠ›çš„æ¶ˆæ¯åœºæ™¯ã€‚</li>
<li><strong>Kafka (KRaft)</strong>Â é‡‡ç”¨ <strong>â€œä¸­å¿ƒåŒ–â€</strong> å’ŒÂ <strong>â€œå¼ºä¸€è‡´â€</strong> æ€æƒ³ï¼Œ<strong>è¿½æ±‚æ•°æ®çš„ç²¾ç¡®å’Œç³»ç»Ÿçš„è‡ªåŒ…å«ã€‚</strong> å®ƒå°†å…ƒæ•°æ®ç®¡ç†æ·±åº¦å†…åŒ–ï¼Œé€šè¿‡å…±è¯†åè®®ä¿è¯å…¨å±€ä¸€è‡´ï¼Œä½†ä»£ä»·æ˜¯æ¶æ„å¤æ‚åº¦å’Œè¿ç»´æˆæœ¬æ›´é«˜ã€‚</li>
</ul>
<p><strong>ä¼˜åŠ£åˆ†æï¼š</strong> NameServeråœ¨<strong>è¿ç»´ç®€æ˜“æ€§ã€é›†ç¾¤æ‰©å±•æ€§ã€æ— å¤–éƒ¨ä¾èµ–</strong>ä¸Šå ä¼˜ï¼›è€ŒKafka KRaftåœ¨<strong>å…ƒæ•°æ®å¼ºä¸€è‡´æ€§ã€ç³»ç»Ÿè‡ªåŒ…å«ã€æ¶æ„ç»Ÿä¸€æ€§</strong>ä¸Šæ›´èƒœä¸€ç­¹ã€‚é€‰æ‹©å–å†³äºä½ å¯¹<strong>ä¸€è‡´æ€§ã€å¤æ‚åº¦ã€è¿ç»´æˆæœ¬</strong>çš„å…·ä½“æƒè¡¡ã€‚</p>
<h3 data-id="heading-4">Brokerï¼šæ¶ˆæ¯å­˜å‚¨ä¸è½¬å‘çš„æ ¸å¿ƒå¼•æ“</h3>
<p><strong>è§£å¯†å­˜å‚¨æ–‡ä»¶è®¾è®¡</strong></p>
<p>Brokerç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e24cb94e63be43809d3bef29a8c763cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=Imv1BnL%2Fp6UklYRQ7TaaZBBi3mc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ‰€æœ‰æ ¸å¿ƒå­˜å‚¨æ–‡ä»¶å‡ä½äºBrokerèŠ‚ç‚¹çš„Â <strong>${storePathRootDir}/store/</strong> ç›®å½•ä¸‹ï¼ˆé»˜è®¤è·¯å¾„ä¸º ~/store/ï¼‰ï¼Œå…¶ä¸‹å„å­ç›®å½•èŒè´£åˆ†æ˜ï¼š</p>













































<table><thead><tr><th>ç›®å½•/æ–‡ä»¶</th><th>æ ¸å¿ƒèŒè´£</th><th>å…³é”®è®¾è®¡è¯´æ˜</th></tr></thead><tbody><tr><td><strong>commitlog/</strong></td><td><strong>æ¶ˆæ¯å®ä½“å­˜å‚¨åº“</strong></td><td>â€¢Â <strong>è®¾è®¡</strong>ï¼šæ‰€æœ‰Topicçš„æ¶ˆæ¯<strong>é¡ºåºæ··åˆè¿½åŠ </strong>å†™å…¥ã€‚â€¢Â <strong>æ–‡ä»¶</strong>ï¼šä»¥èµ·å§‹ç‰©ç†åç§»é‡å‘½åï¼ˆ20ä½æ•°å­—ï¼‰ï¼Œé»˜è®¤æ¯ä¸ª1GBã€‚<strong>lockæ–‡ä»¶</strong>ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹å†™å…¥ï¼Œä¿éšœä¸¥æ ¼é¡ºåºå†™ã€‚</td></tr><tr><td><strong>consumequeue/</strong></td><td><strong>é€»è¾‘æ¶ˆè´¹é˜Ÿåˆ—ç´¢å¼•</strong></td><td>â€¢Â <strong>ç»“æ„</strong>ï¼šæŒ‰Â {Topic}/{QueueId}/ä¸‰çº§ç›®å½•ç»„ç»‡ã€‚Â â€¢Â <strong>æ–‡ä»¶</strong>ï¼šå­˜å‚¨<strong>å®šé•¿è®°å½•</strong>ï¼ˆ20å­—èŠ‚/æ¡ï¼‰ï¼ŒåŒ…å«ç‰©ç†åç§»é‡ã€é•¿åº¦å’ŒTagå“ˆå¸Œç ã€‚Â â€¢Â <strong>ä½œç”¨</strong>ï¼šä¸ºæ¶ˆè´¹è€…æä¾›æŒ‰Topicå’Œé˜Ÿåˆ—åˆ†ç»„çš„<strong>é€»è¾‘è§†å›¾</strong>ï¼Œå®ç°é«˜æ•ˆæ‹‰å–ã€‚</td></tr><tr><td><strong>index/</strong></td><td><strong>æ¶ˆæ¯é”®å“ˆå¸Œç´¢å¼•</strong></td><td>â€¢Â <strong>æ–‡ä»¶</strong>ï¼šä»¥åˆ›å»ºæ—¶é—´æˆ³å‘½åï¼ˆå¦‚20240515080000000ï¼‰ã€‚Â â€¢Â <strong>ç»“æ„</strong>ï¼šé‡‡ç”¨Â <strong>â€œå“ˆå¸Œæ§½ + é“¾è¡¨â€</strong>Â ç»“æ„ã€‚Â â€¢Â <strong>ç”¨é€”</strong>ï¼šæ”¯æŒæ ¹æ® <strong>Message Key</strong>Â æˆ–æ—¶é—´èŒƒå›´è¿›è¡Œæ¶ˆæ¯æŸ¥è¯¢ï¼Œç”¨äºè¿ç»´æ’æŸ¥ã€‚</td></tr><tr><td><strong>config/</strong></td><td><strong>è¿è¡Œæ—¶å…ƒæ•°æ®</strong></td><td>â€¢ å­˜å‚¨Brokerè¿è¡ŒæœŸé—´ç”Ÿæˆçš„åŠ¨æ€æ•°æ®ï¼Œå¦‚<strong>æ‰€æœ‰Topicçš„é…ç½®</strong>ã€<strong>æ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è¿›åº¦ï¼ˆoffsetï¼‰</strong>Â ç­‰ã€‚</td></tr><tr><td><strong>checkpoint</strong></td><td><strong>çŠ¶æ€æ£€æŸ¥ç‚¹æ–‡ä»¶</strong></td><td>â€¢ è®°å½•Â commitlogã€consumequeueã€indexç­‰æ–‡ä»¶<strong>æœ€åä¸€æ¬¡åˆ·ç›˜çš„æ—¶é—´æˆ³</strong>ï¼Œç”¨äºå´©æºƒæ¢å¤æ—¶ç¡®å®šæ•°æ®æ¢å¤çš„èµ·ç‚¹ã€‚</td></tr><tr><td><strong>abort</strong></td><td><strong>å¼‚å¸¸å…³é—­æ ‡å¿—æ–‡ä»¶</strong></td><td>â€¢ è¯¥æ–‡ä»¶å­˜åœ¨å³è¡¨æ˜Brokerä¸Šä¸€æ¬¡æ˜¯<strong>éæ­£å¸¸å…³é—­</strong>ï¼Œé‡å¯æ—¶ä¼šè§¦å‘æ¢å¤æµç¨‹ã€‚</td></tr><tr><td><strong>lock</strong></td><td><strong>é”æ–‡ä»¶</strong></td><td>â€¢ lockæ–‡ä»¶ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹å†™å…¥ï¼Œä¿éšœä¸¥æ ¼é¡ºåºå†™ã€‚</td></tr></tbody></table>
<p><strong>commitLog</strong></p>
<p><strong>æ¶ˆæ¯ä¸»ä½“ä»¥åŠå…ƒæ•°æ®çš„å­˜å‚¨ä¸»ä½“ï¼Œ</strong> å­˜å‚¨Producerç«¯å†™å…¥çš„æ¶ˆæ¯ä¸»ä½“å†…å®¹ï¼Œæ¶ˆæ¯å†…å®¹<strong>ä¸æ˜¯å®šé•¿çš„ã€‚</strong> å•ä¸ªæ–‡ä»¶å¤§å°é»˜è®¤1Gï¼Œ æ–‡ä»¶åé•¿åº¦ä¸º20ä½ï¼Œå·¦è¾¹è¡¥é›¶ï¼Œå‰©ä½™ä¸º<strong>èµ·å§‹åç§»é‡ï¼Œ</strong> æ¯”å¦‚00000000000000000000ä»£è¡¨äº†ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œèµ·å§‹åç§»é‡ä¸º0ï¼Œæ–‡ä»¶å¤§å°ä¸º1G=1073741824ï¼›å½“ç¬¬ä¸€ä¸ªæ–‡ä»¶å†™æ»¡äº†ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ä¸º00000000001073741824ï¼Œèµ·å§‹åç§»é‡ä¸º1073741824ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ¶ˆæ¯ä¸»è¦æ˜¯é¡ºåºå†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œå½“æ–‡ä»¶æ»¡äº†ï¼Œå†™å…¥ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1555b92d53124c30a1c64520afcb6530~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=IgilS7j5JakSn7XjYXj%2FI%2BkGy4Q%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å½“æˆ‘ä»¬æ¶ˆæ¯å‘é€åˆ°RocketMQä»¥åï¼Œæ¶ˆæ¯åœ¨commitLogä¸­ï¼Œå› ä¸ºbodyå¤§å°æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥æ¯ä¸ªæ¶ˆæ¯çš„é•¿åº¦ä¹Ÿæ˜¯ä¸å›ºå®šçš„ï¼Œå…¶å­˜å‚¨æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4dc74ef5bdb4199b3c65d3620b095d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=Ts7tUksCl96meHHt97y93%2FK5g%2Bw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä¸‹é¢æ¯ä¸ªè¡¨æ ¼åˆ—ä¸¾äº†æ¯ä¸ªå­—æ®µçš„å«ä¹‰</p>
























































































































































<table><thead><tr><th>å­—æ®µ</th><th>å­—æ®µå</th><th>æ•°æ®ç±»å‹</th><th>å­—èŠ‚æ•°</th><th>è¯´æ˜ä¸ç”¨é€”</th></tr></thead><tbody><tr><td>1</td><td><strong>MsgLen / TOTALSIZE</strong></td><td>int</td><td>4</td><td><strong>æ¶ˆæ¯æ€»é•¿åº¦</strong>ï¼Œå³ä»æœ¬å­—æ®µå¼€å§‹åˆ°ç»“æŸçš„æ€»å­—èŠ‚æ•°ï¼Œæ˜¯è§£ææ¶ˆæ¯çš„èµ·ç‚¹ã€‚</td></tr><tr><td>2</td><td><strong>MagicCode</strong></td><td>int</td><td>4</td><td><strong>é­”æœ¯å­—</strong>ï¼Œå›ºå®šå€¼ï¼ˆå¦‚Â 0xdaa320a7ï¼‰ï¼Œç”¨äºæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ¶ˆæ¯å­˜å‚¨èµ·å§‹ç‚¹ï¼Œä¹Ÿç”¨äºåŒºåˆ†<strong>æ¶ˆæ¯ä½“</strong>å’Œ<strong>æ–‡ä»¶æœ«å°¾ç©ºç™½å¡«å……åŒº</strong>ã€‚</td></tr><tr><td>3</td><td><strong>BodyCRC</strong></td><td>int</td><td>4</td><td><strong>æ¶ˆæ¯ä½“å†…å®¹çš„CRCæ ¡éªŒç ï¼Œ</strong> ç”¨äºæ ¡éªŒæ¶ˆæ¯ä½“åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­æ˜¯å¦æŸåã€‚</td></tr><tr><td>4</td><td><strong>QueueId</strong></td><td>int</td><td>4</td><td><strong>é˜Ÿåˆ—ID</strong>ï¼Œæ ‡è¯†æ­¤æ¶ˆæ¯å±äºTopicä¸‹çš„å“ªä¸ªé€»è¾‘é˜Ÿåˆ—ã€‚</td></tr><tr><td>5</td><td><strong>Flag</strong></td><td>int</td><td>4</td><td><strong>æ¶ˆæ¯æ ‡å¿—ä½</strong>ï¼Œä¾›åº”ç”¨ç¨‹åºè‡ªå®šä¹‰ä½¿ç”¨ï¼ŒRocketMQå†…éƒ¨æœªä½¿ç”¨ã€‚</td></tr><tr><td>6</td><td><strong>QueueOffset</strong></td><td>long</td><td>8</td><td><strong>æ¶ˆè´¹é˜Ÿåˆ—åç§»é‡</strong>ï¼Œå³æ­¤æ¶ˆæ¯åœ¨å…¶å¯¹åº”ConsumeQueueä¸­çš„é¡ºåºç´¢å¼•ï¼Œ<strong>æ˜¯è¿ç»­çš„</strong>ã€‚</td></tr><tr><td>7</td><td><strong>PhysicalOffset</strong></td><td>long</td><td>8</td><td><strong>ç‰©ç†åç§»é‡</strong>ï¼Œå³æ­¤æ¶ˆæ¯åœ¨<strong>æ‰€æœ‰CommitLogæ–‡ä»¶ä¸­çš„èµ·å§‹å­—èŠ‚åç§»é‡</strong>ã€‚ç”±äºæ¶ˆæ¯é•¿åº¦ä¸å®šï¼Œæ­¤åç§»é‡<strong>ä¸æ˜¯è¿ç»­çš„</strong>ã€‚</td></tr><tr><td>8</td><td><strong>SysFlag</strong></td><td>int</td><td>4</td><td><strong>ç³»ç»Ÿæ ‡å¿—ä½</strong>ï¼Œæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ç»„åˆå€¼ï¼Œç”¨äºæ ‡è¯†æ¶ˆæ¯ç‰¹æ€§ï¼Œå¦‚ï¼šæ˜¯å¦å‹ç¼©ã€æ˜¯å¦ä¸ºäº‹åŠ¡æ¶ˆæ¯ã€æ˜¯å¦ç­‰å¾…äº‹åŠ¡æäº¤ç­‰ã€‚</td></tr><tr><td>9</td><td><strong>BornTimestamp</strong></td><td>long</td><td>8</td><td><strong>æ¶ˆæ¯ç”Ÿæˆæ—¶é—´æˆ³</strong>ï¼Œç”±Producerå®¢æˆ·ç«¯åœ¨å‘é€æ—¶ç”Ÿæˆã€‚</td></tr><tr><td>10</td><td><strong>BornHost</strong></td><td>8å­—èŠ‚</td><td>8</td><td><strong>æ¶ˆæ¯å‘é€è€…åœ°å€</strong>ã€‚å…¶ç¼–ç å¹¶éç®€å•å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å°†IPçš„4ä¸ªæ®µå’Œç«¯å£å·çš„2ä¸ªå­—èŠ‚ï¼Œå…±6ä¸ªå­—èŠ‚ï¼ŒæŒ‰å¤§ç«¯åºç»„åˆå¹¶å¡«å……åˆ°8å­—èŠ‚ä¸­ã€‚</td></tr><tr><td>11</td><td><strong>StoreTimestamp</strong></td><td>long</td><td>8</td><td><strong>æ¶ˆæ¯å­˜å‚¨æ—¶é—´æˆ³</strong>ï¼Œå³Brokeræ”¶åˆ°æ¶ˆæ¯å¹¶å†™å…¥å†…å­˜çš„æ—¶é—´ã€‚</td></tr><tr><td>12</td><td><strong>StoreHost</strong></td><td>8å­—èŠ‚</td><td>8</td><td><strong>Brokerå­˜å‚¨åœ°å€</strong>ï¼Œç¼–ç æ–¹å¼åŒBornHostã€‚</td></tr><tr><td>13</td><td><strong>ReconsumeTimes</strong></td><td>int</td><td>4</td><td><strong>æ¶ˆæ¯é‡è¯•æ¶ˆè´¹æ¬¡æ•°</strong>ï¼Œç”¨äºæ­»ä¿¡é˜Ÿåˆ—åˆ¤æ–­ã€‚</td></tr><tr><td>14</td><td><strong>PreparedTransationOffset</strong></td><td>long</td><td>8</td><td><strong>äº‹åŠ¡æ¶ˆæ¯ä¸“ç”¨</strong>ï¼Œå­˜å‚¨ä¸ä¹‹å…³è”çš„<strong>äº‹åŠ¡æ—¥å¿—ï¼ˆTransaction Logï¼‰çš„åç§»é‡</strong>ã€‚</td></tr><tr><td>15</td><td><strong>BodyLength</strong></td><td>int</td><td>4</td><td><strong>æ¶ˆæ¯ä½“å®é™…é•¿åº¦</strong>ï¼Œåè·ŸBodyå†…å®¹ã€‚</td></tr><tr><td>16</td><td><strong>Body</strong></td><td>byte[]</td><td>ä¸å®š</td><td><strong>æ¶ˆæ¯ä½“å†…å®¹</strong>ï¼Œå³Producerå‘é€çš„åŸå§‹ä¸šåŠ¡æ•°æ®ã€‚</td></tr><tr><td>17</td><td><strong>TopicLength</strong></td><td>byte</td><td>1</td><td><strong>Topicåç§°çš„é•¿åº¦</strong>ï¼ˆ1å­—èŠ‚ï¼Œå› æ­¤Topicåä¸èƒ½è¶…è¿‡255å­—ç¬¦ï¼‰ã€‚</td></tr><tr><td>18</td><td><strong>Topic</strong></td><td>byte[]</td><td>ä¸å®š</td><td><strong>Topicåç§°</strong>çš„å­—èŠ‚æ•°ç»„ã€‚</td></tr><tr><td>19</td><td><strong>PropertiesLength</strong></td><td>short</td><td>2</td><td><strong>æ¶ˆæ¯å±æ€§é•¿åº¦</strong>ï¼Œåè·ŸPropertieså†…å®¹ã€‚</td></tr><tr><td>20</td><td><strong>Properties</strong></td><td>byte[]</td><td>ä¸å®š</td><td><strong>æ¶ˆæ¯å±æ€§</strong>ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„Key-Valueæ‰©å±•ä¿¡æ¯ã€‚åœ¨ç¼–ç æ—¶ï¼ŒKeyå’ŒValueä¹‹é—´ç”¨ç‰¹æ®Š<strong>ä¸å¯è§å­—ç¬¦</strong>ï¼ˆå¦‚\u0001ï¼‰åˆ†éš”ï¼Œå› æ­¤å±æ€§ä¸­ä¸èƒ½åŒ…å«è¿™äº›å­—ç¬¦ã€‚</td></tr></tbody></table>
<p><strong>ConsumeQueue</strong></p>
<p>æ¶ˆæ¯æ¶ˆè´¹ç´¢å¼•ï¼Œ<strong>å¼•å…¥çš„ç›®çš„ä¸»è¦æ˜¯æé«˜æ¶ˆæ¯æ¶ˆè´¹çš„æ€§èƒ½ã€‚</strong> ç”±äºRocketMQæ˜¯åŸºäºä¸»é¢˜topicçš„è®¢é˜…æ¨¡å¼ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ˜¯é’ˆå¯¹ä¸»é¢˜è¿›è¡Œçš„ï¼Œå¦‚æœè¦éå†commitlogæ–‡ä»¶ï¼Œ<strong>æ ¹æ®topicæ£€ç´¢æ¶ˆæ¯æ˜¯éå¸¸ä½æ•ˆçš„ã€‚</strong></p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæé«˜æ¶ˆè´¹æ—¶å€™çš„é€Ÿåº¦ï¼ŒRocketMQä¼šå¯åŠ¨åå°çš„ dispatch çº¿ç¨‹æºæºä¸æ–­çš„å°†æ¶ˆæ¯ä» commitLog å–å‡ºæ¶ˆæ¯åœ¨ CommitLog ä¸­çš„ç‰©ç†åç§»é‡ï¼Œæ¶ˆæ¯é•¿åº¦ä»¥åŠ Tag Hash ç­‰ä¿¡æ¯ä½œä¸ºå•æ¡æ¶ˆæ¯çš„ç´¢å¼•ï¼Œåˆ†å‘åˆ°å¯¹åº”çš„æ¶ˆè´¹é˜Ÿåˆ—ï¼Œæ„æˆäº†å¯¹ CommitLog çš„å¼•ç”¨ã€‚</p>
<p>consumerå¯æ ¹æ®ConsumeQueueæ¥æŸ¥æ‰¾å¾…æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚å…¶ä¸­ï¼ŒConsumeQueueä½œä¸ºæ¶ˆè´¹æ¶ˆæ¯çš„ç´¢å¼•ï¼Œä¿å­˜äº†æŒ‡å®šTopicä¸‹çš„é˜Ÿåˆ—æ¶ˆæ¯åœ¨CommitLogä¸­çš„èµ·å§‹<strong>ç‰©ç†åç§»é‡offsetï¼Œæ¶ˆæ¯å¤§å°sizeå’Œæ¶ˆæ¯Tagçš„HashCodeå€¼ã€‚</strong></p>
<p><strong>consumequeueæ–‡ä»¶å¯ä»¥çœ‹æˆæ˜¯åŸºäºtopicçš„commitlogç´¢å¼•æ–‡ä»¶ï¼Œ</strong> æ•…consumequeueæ–‡ä»¶å¤¹çš„ç»„ç»‡æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p>$HOME/store/consumequeue/{topic}/{queueId}/{fileName}</p>
<p><strong>consumequeueæ–‡ä»¶é‡‡å–å®šé•¿è®¾è®¡ï¼Œ</strong> æ¯ä¸€ä¸ªæ¡ç›®å…±20ä¸ªå­—èŠ‚ï¼Œå‰8å­—èŠ‚çš„commitlogç‰©ç†åç§»é‡ã€ä¸­é—´4å­—èŠ‚çš„æ¶ˆæ¯é•¿åº¦ã€8å­—èŠ‚tagçš„hashcodeã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2a1c20449134d6f85cddd0b432a61ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=QXmusPa2UJ%2Foj2KiTRxDE9X8I60%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>indexFile</strong></p>
<p>RocketMQçš„IndexFileç´¢å¼•æ–‡ä»¶æä¾›äº†é€šè¿‡æ¶ˆæ¯Keyæˆ–æ—¶é—´åŒºé—´æŸ¥è¯¢æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œå…¶å­˜å‚¨è·¯å¾„ä¸º$HOME/store/index/{fileName}ï¼Œå…¶ä¸­æ–‡ä»¶åä»¥åˆ›å»ºæ—¶é—´æˆ³å‘½åã€‚å•ä¸ªIndexFileæ–‡ä»¶å¤§å°å›ºå®šçº¦ä¸º400Mï¼Œå¯ä¿å­˜2000Wä¸ªç´¢å¼•ï¼Œå…¶åº•å±‚é‡‡ç”¨ç±»HashMapçš„å“ˆå¸Œç´¢å¼•ç»“æ„å®ç°ã€‚</p>
<p>IndexFileæ˜¯ä¸€ä¸ª<strong>å›ºå®šå¤§å°</strong>çš„æ–‡ä»¶ï¼ˆçº¦400MBï¼‰ï¼Œå…¶ç‰©ç†ç»“æ„ç”±ä¸‰éƒ¨åˆ†ç»„æˆ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec110113d70c41318ed5d59af0260ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=LkiT4Cr9Jp4pTcpu%2Ftp5chEcXn0%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>1.IndexHeaderï¼ˆç´¢å¼•å¤´ï¼Œ40å­—èŠ‚ï¼‰</p>
<p><strong>beginTimestampï¼š</strong> ç¬¬ä¸€æ¡æ¶ˆæ¯å­˜å‚¨æ—¶é—´</p>
<p><strong>endTimestampï¼š</strong> æœ€åä¸€æ¡æ¶ˆæ¯å­˜å‚¨æ—¶é—´</p>
<p><strong>beginPhyoffsetï¼š</strong> ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨CommitLogä¸­çš„ç‰©ç†åç§»é‡</p>
<p><strong>endPhyoffsetï¼š</strong> æœ€åä¸€æ¡æ¶ˆæ¯åœ¨CommitLogä¸­çš„ç‰©ç†åç§»é‡</p>
<p><strong>hashSlotCountï¼š</strong> å·²ä½¿ç”¨çš„å“ˆå¸Œæ§½æ•°é‡</p>
<p><strong>indexCountï¼š</strong> ç´¢å¼•å•å…ƒæ€»æ•°</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f15c2fa72ed446819edf72bcd57ed7dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=TjCLGPJ5bxzgC2zTxRD1rWWfHRI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2.Slotsï¼ˆå“ˆå¸Œæ§½ï¼‰</p>
<p>æ¯ä¸ªIndexFileåŒ…å«500ä¸‡ä¸ªå“ˆå¸Œæ§½ä½,æ¯ä¸ªSlotæ§½ä½ï¼ˆ4å­—èŠ‚ï¼‰å­˜å‚¨çš„æ˜¯é“¾å¼ç´¢å¼•çš„ç¬¬ä¸€ä¸ªç´¢å¼•åºå·ï¼Œæ¯ä¸ªæ§½ä½å¯æŒ‚è½½å¤šä¸ªç´¢å¼•å•å…ƒï¼Œå½¢æˆé“¾å¼ç»“æ„ã€‚</p>
<ul>
<li>å¦‚æœSlotå€¼ä¸º0ï¼šè¡¨ç¤ºè¯¥æ§½ä½æ²¡æœ‰ç´¢å¼•é“¾</li>
<li>å¦‚æœSlotå€¼ä¸ºNï¼šè¡¨ç¤ºè¯¥æ§½ä½å¯¹åº”çš„ç´¢å¼•é“¾å¤´èŠ‚ç‚¹ç´¢å¼•åºå·ä¸ºN</li>
</ul>
<p>3.Indexesï¼ˆç´¢å¼•å•å…ƒï¼Œ20å­—èŠ‚/ä¸ªï¼‰</p>
<p>æ¯ä¸ªç´¢å¼•å•å…ƒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li><strong>keyHashï¼š</strong> æ¶ˆæ¯Keyçš„å“ˆå¸Œå€¼</li>
<li><strong>phyOffsetï¼š</strong> æ¶ˆæ¯åœ¨CommitLogä¸­çš„ç‰©ç†åç§»é‡</li>
<li><strong>timeDiffï¼š</strong> æ¶ˆæ¯å­˜å‚¨æ—¶é—´ä¸IndexFileåˆ›å»ºæ—¶é—´çš„å·®å€¼</li>
<li><strong>preIndexNoï¼š</strong> åŒä¸€å“ˆå¸Œæ§½ä¸­å‰ä¸€ä¸ªç´¢å¼•å•å…ƒçš„åºå·</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28e2a3945505468085f36654c599d975~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=GQFqfiH%2FzwZxZpLgy%2Fy3W9hMR4U%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>è¿™ä¸ªç»“æ„å’Œhashmapç»“æ„å¾ˆåƒï¼Œä½†æ˜¯æ”¯æŒæ¯ä¸ªkeyé€šè¿‡æ—¶é—´æ’åºï¼Œå°±å¯ä»¥è¿›è¡Œæ—¶é—´èŒƒå›´çš„æ£€ç´¢ã€‚</p>
<p>é€šè¿‡å®šé•¿ç´¢å¼•ç»“æ„å’Œæ•´ä½“è®¾è®¡å¯ä»¥é€šè¿‡keyå¿«é€Ÿå®šä½ç´¢å¼•æ•°æ®ï¼Œæ‹¿åˆ°çœŸå®æ•°æ®çš„ç‰©ç†åç§»é‡ã€‚</p>
<p>4.ç´¢å¼•æŸ¥è¯¢æµç¨‹</p>
<p>æ¶ˆè´¹è€…é€šè¿‡æ¶ˆæ¯KeyæŸ¥è¯¢æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>è®¡ç®—æ§½ä½åºå·slotåºå· = keyå“ˆå¸Œå€¼ % 500ä¸‡</li>
<li>å®šä½æ§½ä½åœ°å€slotä½ç½® = 40 + (slotåºå· - 1) Ã— 4</li>
<li>è·å–é¦–ä¸ªç´¢å¼•ä½ç½®indexä½ç½® = 40 + 500ä¸‡ Ã— 4 + (ç´¢å¼•åºå· - 1) Ã— 20</li>
<li>éå†ç´¢å¼•é“¾ä»æ§½ä½æŒ‡å‘çš„ç´¢å¼•å¼€å§‹ï¼Œæ²¿preIndexNoé“¾å¼æŸ¥æ‰¾ï¼ŒåŒ¹é…ç›®æ ‡Keyå¹¶æ ¡éªŒæ—¶é—´èŒƒå›´</li>
<li>è·å–ç‰©ç†åç§»é‡ä»åŒ¹é…çš„ç´¢å¼•å•å…ƒä¸­è¯»å–phyOffsetï¼Œæœ€ç»ˆä»CommitLogè·å–å®Œæ•´æ¶ˆæ¯å†…å®¹</li>
</ol>
<p>é€šè¿‡æ­¤æœºåˆ¶ï¼ŒIndexFileå®ç°äº†åŸºäºKeyçš„é«˜æ•ˆç‚¹æŸ¥å’ŒåŸºäºæ—¶é—´èŒƒå›´çš„å¿«é€Ÿæ£€ç´¢ã€‚</p>
<p><strong>æ•´ä½“æµç¨‹</strong></p>
<p>RocketMQ é«˜æ€§èƒ½å­˜å‚¨çš„æ ¸å¿ƒï¼Œåœ¨äºå…¶Â <strong>â€œæ··åˆå­˜å‚¨â€</strong> æ¶æ„ï¼Œè¿™æ­£æ˜¯ä¸€ç§ç²¾å¦™çš„<strong>å­˜å‚¨å±‚è¯»å†™åˆ†ç¦»</strong>è®¾è®¡ã€‚</p>
<p>å…¶å·¥ä½œæµç¨‹å¯ä»¥è¿™æ ·ç†è§£ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€å†™å…¥ï¼Œä¿è¯æè‡´æ€§èƒ½ï¼š</strong> æ‰€æœ‰æ¶ˆæ¯é¡ºåºè¿½åŠ å†™å…¥ä¸€ä¸ªç»Ÿä¸€çš„Â CommitLogÂ æ–‡ä»¶ã€‚è¿™ç§å•ä¸€çš„é¡ºåºå†™æ“ä½œï¼Œæ˜¯å®ƒèƒ½æ‰¿å—æµ·é‡æ¶ˆæ¯å†™å…¥çš„æ ¹æœ¬ã€‚</li>
<li><strong>å¼‚æ­¥æ„å»ºï¼Œä¼˜åŒ–è¯»å–è·¯å¾„ï¼š</strong> æ¶ˆæ¯ä¸€æ—¦æŒä¹…åŒ–è‡³Â CommitLogï¼Œå³è§†ä¸ºå®‰å…¨ã€‚éšåï¼Œåå°æœåŠ¡çº¿ç¨‹ä¼šå¼‚æ­¥åœ°æ„å»ºå‡ºä¸“ä¾›æ¶ˆè´¹çš„Â ConsumerQueueï¼ˆé€»è¾‘é˜Ÿåˆ—ç´¢å¼•ï¼‰å’Œç”¨äºæŸ¥è¯¢çš„Â IndexFileã€‚è¿™ç›¸å½“äºä¸ºæ•°æ®å»ºç«‹äº†é«˜æ•ˆçš„â€œç›®å½•â€ã€‚</li>
<li><strong>æ¶ˆè´¹æ¶ˆæ¯ï¼š</strong> æ¶ˆè´¹è€…å®é™…æ‹‰å–æ¶ˆæ¯æ—¶ï¼Œæ˜¯å…ˆè¯»å–Â ConsumerQueueÂ æ‰¾åˆ°æ¶ˆæ¯åœ¨Â CommitLogÂ ä¸­çš„ç‰©ç†ä½ç½®ï¼Œå†åæŸ¥Â CommitLogÂ è·å–å®Œæ•´æ¶ˆæ¯å†…å®¹ã€‚</li>
<li><strong>å¯é çš„æ¶ˆè´¹æœºåˆ¶ï¼š</strong> åŸºäºä¸Šè¿°æŒä¹…åŒ–ä¿éšœï¼Œé…åˆæ¶ˆè´¹è€…è‡ªèº«çš„åç§»é‡ç®¡ç†åŠBrokerçš„é•¿è½®è¯¢æœºåˆ¶ï¼Œå…±åŒå®ç°äº†æ¶ˆæ¯çš„å¯é æŠ•é€’ä¸é«˜æ•ˆè·å–ã€‚</li>
</ol>
<p>è¿™ç§ <strong>â€œè¯»å†™åˆ†ç¦»â€</strong> è®¾è®¡çš„å¥½å¤„åœ¨äºï¼šå°†è€—æ—¶çš„å†™æ“ä½œï¼ˆé¡ºåºå†™CommitLogï¼‰ä¸å¤æ‚çš„è¯»æ“ä½œï¼ˆæ„å»ºç´¢å¼•ã€åˆ†æ•£æŸ¥è¯¢ï¼‰è§£è€¦ï¼Œè®©ä¸¤è€…å¯ä»¥å¼‚æ­¥ã€ç‹¬ç«‹åœ°è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œåœ¨æ•´ä½“ä¸Šè·å¾—æ›´é«˜çš„ååé‡å’Œæ›´ä½çš„å»¶è¿Ÿã€‚è¿™ä½“ç°äº†â€œå„å¸å…¶èŒï¼Œå¼‚æ­¥ååŒâ€çš„ç»å…¸æ¶æ„æ€æƒ³ã€‚</p>
<p>ä¸‹å›¾æ˜¯å®˜æ–¹æ–‡æ¡£çš„æµç¨‹å›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/498af1c2070f4a8d9c1a580ad937f5a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767688935&amp;x-signature=BHzEd9qIEgSJ5AuVag0vy0St7YA%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å†™å…¥æµç¨‹</p>
<p><strong>1.æ¶ˆæ¯é¢„å¤„ç†</strong></p>
<p><strong>åŸºç¡€æ ¡éªŒï¼š</strong> æ£€æŸ¥Topicåç§°ã€æ¶ˆæ¯ä½“é•¿åº¦ç­‰æ˜¯å¦åˆæ³•ã€‚</p>
<p><strong>ç”Ÿæˆå”¯ä¸€IDï¼š</strong> ç»“åˆBrokeråœ°å€å’ŒCommitLogåç§»é‡ç­‰ï¼Œç”Ÿæˆå…¨å±€å”¯ä¸€çš„MsgIDã€‚</p>
<p><strong>è®¾ç½®ç³»ç»Ÿæ ‡å¿—ï¼š</strong> æ ¹æ®æ¶ˆæ¯å±æ€§ï¼ˆå¦‚æ˜¯å¦äº‹åŠ¡æ¶ˆæ¯ã€æ˜¯å¦å‹ç¼©ï¼‰è®¾ç½®SysFlagã€‚</p>
<p><strong>2.CommitLogæ ¸å¿ƒå†™å…¥</strong></p>
<p><strong>è·å–MappedFileï¼š</strong> æ ¹æ®å½“å‰å†™å…¥ä½ç½®ï¼Œå®šä½æˆ–åˆ›å»ºå¯¹åº”çš„1GBå†…å­˜æ˜ å°„æ–‡ä»¶ã€‚è¿™é‡Œé‡‡ç”¨åŒé‡æ£€æŸ¥é”æ¨¡å¼æ¥ä¿è¯æ€§èƒ½å’Œå®‰å…¨ã€‚</p>
<p><strong>ä¸²è¡ŒåŠ é”å†™å…¥ï¼š</strong> è·å–å…¨å±€æˆ–æ–‡ä»¶çº§é”ï¼ˆPutMessageLockï¼‰ï¼Œç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å†™å…¥æ–‡ä»¶ï¼Œä¸¥æ ¼ä¿è¯<strong>é¡ºåºæ€§ã€‚</strong></p>
<p><strong>åºåˆ—åŒ–ä¸è¿½åŠ ï¼š</strong> å°†æ¶ˆæ¯æŒ‰ç…§ä¹‹å‰åˆ†æçš„<strong>äºŒè¿›åˆ¶åè®®ï¼Œ</strong> åºåˆ—åŒ–åˆ°MappedByteBufferä¸­ï¼Œå¹¶æ›´æ–°å†™å…¥æŒ‡é’ˆã€‚</p>
<p><strong>3.åˆ·ç›˜ï¼ˆFlushï¼‰</strong></p>
<p><strong>åŒæ­¥åˆ·ç›˜ï¼š</strong> æ¶ˆæ¯å†™å…¥å†…å­˜æ˜ å°„åŒºåï¼Œä¼šåˆ›å»ºä¸€ä¸ªGroupCommitRequestå¹¶æ”¾å…¥è¯·æ±‚ç»„ã€‚å†™å…¥çº¿ç¨‹ä¼šç­‰å¾…ï¼Œç›´åˆ°<strong>åˆ·ç›˜çº¿ç¨‹</strong>å®Œæˆè¯¥è¯·æ±‚å¯¹åº”æ–‡ä»¶çš„ç‰©ç†åˆ·ç›˜åï¼Œæ‰è¿”å›æˆåŠŸç»™Producerã€‚<strong>æ•°æ®æœ€å¯é ï¼Œä½†å»¶è¿Ÿè¾ƒé«˜ã€‚</strong></p>
<p><strong>å¼‚æ­¥åˆ·ç›˜ï¼ˆé»˜è®¤ï¼‰ï¼š</strong> æ¶ˆæ¯å†™å…¥å†…å­˜æ˜ å°„åŒºåï¼Œç«‹å³è¿”å›æˆåŠŸç»™Producerã€‚åŒæ—¶å”¤é†’<strong>å¼‚æ­¥åˆ·ç›˜çº¿ç¨‹ï¼Œ</strong> è¯¥çº¿ç¨‹ä¼šå®šæ—¶æˆ–å½“PageCacheä¸­å¾…åˆ·ç›˜æ•°æ®ç§¯ç´¯åˆ°ä¸€å®šé‡æ—¶ï¼Œæ‰§è¡Œä¸€æ¬¡æ‰¹é‡åˆ·ç›˜ã€‚<strong>æ€§èƒ½é«˜ï¼Œä½†æœ‰å®•æœºä¸¢æ•°é£é™©ã€‚</strong></p>
<p><strong>4.å¼‚æ­¥ç´¢å¼•æ„å»º</strong></p>
<p>ç”±ç‹¬ç«‹çš„ReputMessageServiceçº¿ç¨‹å¤„ç†ã€‚å®ƒä¸æ–­æ£€æŸ¥CommitLogä¸­æ˜¯å¦æœ‰æ–°æ¶ˆæ¯åˆ°è¾¾ã€‚</p>
<p>ä¸€æ—¦æœ‰<strong>æ–°æ¶ˆæ¯è¢«ç¡®è®¤æŒä¹…åŒ–</strong>ï¼ˆå¯¹äºåŒæ­¥åˆ·ç›˜æ˜¯å·²è½ç›˜ï¼Œå¯¹äºå¼‚æ­¥åˆ·ç›˜æ˜¯å·²å†™å…¥æ˜ å°„åŒºï¼‰ï¼Œè¯¥çº¿ç¨‹å°±ä¼šè¯»å–æ¶ˆæ¯å†…å®¹ã€‚</p>
<p>éšåï¼Œå®ƒä¼šä¸ºè¿™æ¡æ¶ˆæ¯åœ¨å¯¹åº”çš„consumequeueç›®å½•ä¸‹æ„å»º<strong>æ¶ˆè´¹é˜Ÿåˆ—ç´¢å¼•</strong>ï¼ˆè®°å½•CommitLogç‰©ç†åç§»é‡å’Œæ¶ˆæ¯é•¿åº¦ï¼‰ï¼Œæ›´æ–°indexç´¢å¼•æ–‡ä»¶ã€‚</p>
<p>æ¶ˆè´¹æµç¨‹</p>
<p><strong>1.å¯åŠ¨ä¸è´Ÿè½½å‡è¡¡</strong></p>
<p>æ¶ˆè´¹è€…å¯åŠ¨åï¼Œä¼šå‘<strong>NameServer</strong>è·å–Topicçš„è·¯ç”±ä¿¡æ¯ï¼ˆåŒ…å«å“ªäº›é˜Ÿåˆ—ã€åˆ†å¸ƒåœ¨å“ªäº›Brokerä¸Šï¼‰ã€‚</p>
<p>å¦‚æœæ¶ˆè´¹è€…ç»„å†…æœ‰å¤šä¸ªå®ä¾‹ï¼Œä¼šè§¦å‘<strong>é˜Ÿåˆ—è´Ÿè½½å‡è¡¡</strong>ï¼ˆé»˜è®¤ç­–ç•¥æ˜¯å¹³å‡åˆ†é…ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªTopicæœ‰8ä¸ªé˜Ÿåˆ—ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…å®ä¾‹ï¼Œåˆ™é€šå¸¸æ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£æ¶ˆè´¹4ä¸ªé˜Ÿåˆ—ã€‚è¿™ä¸€æ­¥å†³å®šäº†æ¯ä¸ªæ¶ˆè´¹è€…â€œè®¤é¢†â€äº†å“ªäº›æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<p><strong>2.æ‹‰å–æ¶ˆæ¯å¾ªç¯</strong></p>
<p>æ¯ä¸ªæ¶ˆè´¹è€…å®ä¾‹å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªPullMessageServiceçº¿ç¨‹ï¼Œå®ƒå¾ªç¯ä»ä¸€ä¸ªPullRequesté˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ã€‚</p>
<p>PullRequeståŒ…å«äº†æ‹‰å–ç›®æ ‡ï¼ˆå¦‚Broker-Aï¼ŒÂ é˜Ÿåˆ—3ï¼‰ä»¥åŠ<strong>ä¸‹ä¸€æ¬¡è¦æ‹‰å–çš„ä½ç‚¹ï¼ˆoffsetï¼‰ã€‚</strong></p>
<p>æ¶ˆè´¹è€…å‘æŒ‡å®šçš„Brokerå‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¯·æ±‚ä½“ä¸­å°±æºå¸¦äº†è¿™ä¸ªoffsetã€‚</p>
<p><strong>3.Brokerç«¯å¤„ç†ä¸è¿”å›</strong></p>
<p>Brokeræ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®Topicã€é˜Ÿåˆ—IDå’Œoffsetï¼Œå»æŸ¥è¯¢å¯¹åº”çš„<strong>ConsumeQueueç´¢å¼•æ–‡ä»¶ã€‚</strong></p>
<p>ConsumeQueueä¸­å­˜å‚¨çš„æ˜¯å®šé•¿ï¼ˆ20å­—èŠ‚ï¼‰çš„è®°å½•ï¼ŒåŒ…å«æ¶ˆæ¯åœ¨<strong>CommitLogä¸­çš„ç‰©ç†åç§»é‡å’Œé•¿åº¦ã€‚</strong></p>
<p>Brokeræ ¹æ®ç‰©ç†åç§»é‡ï¼Œä»<strong>CommitLogæ–‡ä»¶</strong>ä¸­è¯»å–å®Œæ•´çš„æ¶ˆæ¯å†…å®¹ï¼Œé€šè¿‡ç½‘ç»œè¿”å›ç»™æ¶ˆè´¹è€…ã€‚</p>
<p><strong>4.æ¶ˆæ¯å¤„ç†ä¸ä½ç‚¹æäº¤</strong></p>
<p>æ¶ˆè´¹è€…å°†æ‹‰å–åˆ°çš„æ¶ˆæ¯æäº¤åˆ°å†…éƒ¨çš„<strong>æ¶ˆè´¹çº¿ç¨‹æ± </strong>è¿›è¡Œå¤„ç†ï¼Œä½ çš„ä¸šåŠ¡é€»è¾‘å°±åœ¨è¿™é‡Œæ‰§è¡Œã€‚</p>
<p><strong>æ¶ˆè´¹ä½ç‚¹çš„ç®¡ç†è‡³å…³é‡è¦ï¼š</strong></p>
<p><strong>ä½ç‚¹å­˜å‚¨ï¼š</strong> ä½ç‚¹ç”±OffsetStoreç®¡ç†ã€‚åœ¨<strong>é›†ç¾¤æ¨¡å¼ï¼ˆCLUSTERï¼‰</strong>Â ä¸‹ï¼Œæ¶ˆè´¹ä½ç‚¹å­˜å‚¨åœ¨Brokerä¸Šï¼›åœ¨<strong>å¹¿æ’­æ¨¡å¼ï¼ˆBROADCASTï¼‰</strong> ä¸‹ï¼Œä½ç‚¹å­˜å‚¨åœ¨æœ¬åœ°ã€‚</p>
<p><strong>ä½ç‚¹æäº¤ï¼š</strong> æ¶ˆè´¹æˆåŠŸåï¼Œæ¶ˆè´¹è€…ä¼š<strong>å¼‚æ­¥</strong>ï¼ˆé»˜è®¤æ–¹å¼ï¼‰å‘Brokeræäº¤å·²æ¶ˆè´¹çš„ä½ç‚¹ã€‚Brokerå°†å…¶æŒä¹…åŒ–åˆ°store/config/consumerOffset.jsonæ–‡ä»¶ä¸­ã€‚</p>
<p><strong>5.æ¶ˆæ¯é‡è¯•ä¸æ­»ä¿¡</strong></p>
<p>å¦‚æœæ¶ˆæ¯æ¶ˆè´¹<strong>å¤±è´¥</strong>ï¼ˆæŠ›å‡ºå¼‚å¸¸æˆ–è¶…æ—¶æœªè¿”å›CONSUME_SUCCESSï¼‰ï¼ŒRocketMQä¼šè§¦å‘<strong>é‡è¯•æœºåˆ¶ã€‚</strong></p>
<p>å¯¹äºæ™®é€šæ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¼šè¢«å‘å›Brokerä¸Šä¸€ä¸ªç‰¹æ®Šçš„<strong>é‡è¯•ä¸»é¢˜</strong>ï¼ˆ%RETRY%ï¼‰ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´ï¼ˆå»¶è¿Ÿçº§åˆ«ï¼š1sã€5sã€10sâ€¦ï¼‰åå†è¢«åŸæ¶ˆè´¹è€…ç»„æ‹‰å–ã€‚</p>
<p>å¦‚æœ<strong>é‡è¯•è¶…è¿‡æœ€å¤§æ¬¡æ•°</strong>ï¼ˆé»˜è®¤16æ¬¡ï¼‰ï¼Œæ¶ˆæ¯ä¼šè¢«æŠ•é€’åˆ°<strong>æ­»ä¿¡ä¸»é¢˜</strong>ï¼ˆ%DLQ%ï¼‰ï¼Œç­‰å¾…äººå·¥å¹²é¢„ã€‚æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¸ä¼šå†è¢«è‡ªåŠ¨æ¶ˆè´¹ã€‚</p>
<h3 data-id="heading-5">ä¸€ä½“ä¸åˆ†ç¦»ï¼šKafkaå’ŒRocketMQçš„æ ¸å¿ƒæ¶æ„åšå¼ˆ</h3>
<p>è¯´èµ·RocketMQå°±ä¸èƒ½ä¸æèµ·Kafkaäº†ï¼Œä¸¤è€…éƒ½æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶è¿™ä¸ªé¢†åŸŸçš„éœ¸ä¸»ï¼Œä½†å®ƒä»¬çš„æ ¸å¿ƒ<strong>æ¶æ„è®¾è®¡å·®å¼‚ï¼Œ</strong> ç›´æ¥å†³å®šäº†å„è‡ªä¸åŒçš„æ€§èƒ½ç‰¹æ€§å’Œé€‚ç”¨åœºæ™¯ï¼Œè¿™ä¹Ÿæ˜¯æŠ€æœ¯é€‰å‹æ—¶å¿…é¡»æ·±å…¥ç†è§£çš„é‡ç‚¹ã€‚</p>
<p><strong>æ ¸å¿ƒæ¶æ„è®¾è®¡å·®å¼‚</strong></p>
<p><strong>Kafkaï¼šè¯»å†™ä¸€ä½“çš„â€œåˆ†åŒºæ—¥å¿—â€æ¨¡å‹ï¼Œ</strong> Kafkaçš„æ¶æ„å“²å­¦æ˜¯<strong>æç®€ä¸ç»Ÿä¸€ã€‚</strong> å®ƒå°†æ¯ä¸ªä¸»é¢˜åˆ†åŒºæŠ½è±¡ä¸ºä¸€ä¸ª<strong>ä»…è¿½åŠ ï¼ˆappend-onlyï¼‰çš„ç‰©ç†æ—¥å¿—æ–‡ä»¶ã€‚</strong> ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½ç›´æ¥ä¸è¿™ä¸ªæ—¥å¿—æ–‡ä»¶äº¤äº’ï¼šç”Ÿäº§è€…é¡ºåºå†™å…¥å°¾éƒ¨ï¼Œæ¶ˆè´¹è€…é€šè¿‡ç»´æŠ¤åç§»é‡é¡ºåºè¯»å–ã€‚è¿™ç§è®¾è®¡ä¸‹ï¼Œ<strong>æ•°æ®çš„è¯»å†™è·¯å¾„å®Œå…¨ä¸€è‡´ï¼Œ</strong> é€»è¾‘ä¸ç‰©ç†ç»“æ„é«˜åº¦ç»Ÿä¸€ã€‚</p>
<p><strong>RocketMQï¼šè¯»å†™åˆ†ç¦»çš„â€œäºŒçº§åˆ¶â€æ¨¡å‹ ï¼Œ</strong> RocketMQçš„æ¶æ„å“²å­¦æ˜¯<strong>åˆ†å·¥ä¸ä¼˜åŒ–ã€‚</strong> å®ƒé‡‡ç”¨äº†<strong>ç‰©ç†CommitLog + é€»è¾‘ConsumeQueueçš„äºŒçº§ç»“æ„ã€‚</strong> æ‰€æœ‰æ¶ˆæ¯éƒ½é¡ºåºå†™å…¥ä¸€ä¸ªç»Ÿä¸€çš„<strong>CommitLog</strong>ç‰©ç†æ–‡ä»¶ï¼Œå®ç°ç£ç›˜çš„æœ€é«˜æ•ˆé¡ºåºå†™ã€‚åŒæ—¶ï¼Œä¸ºæ¯ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥æ„å»ºä¸€ä¸ªè½»é‡çº§çš„<strong>ConsumeQueue</strong>ç´¢å¼•æ–‡ä»¶ï¼Œæ¶ˆè´¹è€…è¯»å–æ—¶å…ˆæŸ¥è¯¢å†…å­˜ä¸­çš„ConsumeQueueå®šä½ï¼Œå†åˆ°CommitLogä¸­è·å–æ¶ˆæ¯ä½“ã€‚è¿™æ˜¯ä¸€ç§<strong>é€»è¾‘ä¸ç‰©ç†åˆ†ç¦»</strong>çš„è®¾è®¡ã€‚</p>
<p><strong>ä¼˜åŠ£åŠ¿å¯¹æ¯”</strong></p>
<p>åŸºäºä¸Šè¿°æ¶æ„è®¾è®¡æ ¹æœ¬å·®å¼‚ï¼Œä¸¤è€…åœ¨å…³é”®æŒ‡æ ‡ä¸Šå„æ˜¾ä¼˜åŠ£ï¼š</p>



































<table><thead><tr><th>ç»´åº¦</th><th>Kafkaï¼ˆè¯»å†™ä¸€ä½“ï¼‰</th><th>RocketMQï¼ˆè¯»å†™åˆ†ç¦»ï¼‰</th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒä¼˜åŠ¿</strong></td><td><strong>æè‡´ååä¸ä½å»¶è¿Ÿ</strong>ï¼šè¯»å†™åŒè·¯å¾„ï¼Œæ•°æ®å†™å…¥åç«‹å³å¯è¯»ï¼Œç«¯åˆ°ç«¯å»¶è¿Ÿæä½ã€‚<strong>æ¶æ„ç®€å•</strong>ï¼šæ— ä¸­é—´çŠ¶æ€ï¼Œå‰¯æœ¬åŒæ­¥ã€æ•…éšœæ¢å¤é€»è¾‘æ¸…æ™°ã€‚</td><td><strong>é«˜å¹¶å‘è¯»ä¸ä¸°å¯ŒåŠŸèƒ½</strong>ï¼šç´¢å¼•ä¸æ•°æ®åˆ†ç¦»ï¼Œæ”¯æŒæµ·é‡æ¶ˆè´¹è€…å¹¶å‘è¯»ã€‚<strong>ä¸šåŠ¡å‹å¥½</strong>ï¼šåŸç”Ÿæ”¯æŒäº‹åŠ¡æ¶ˆæ¯ã€å®šæ—¶/å»¶æ—¶æ¶ˆæ¯ã€æ¶ˆæ¯è½¨è¿¹æŸ¥è¯¢ã€‚</td></tr><tr><td><strong>å­˜å‚¨æ•ˆç‡</strong></td><td><strong>ç£ç›˜é¡ºåºIOæœ€å¤§åŒ–</strong>ï¼šç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯ä¸¥æ ¼é¡ºåºIOï¼Œå°¤å…¶é€‚åˆæœºæ¢°ç¡¬ç›˜ã€‚</td><td><strong>å†™æ€§èƒ½æè‡´åŒ–</strong>ï¼šæ‰€æœ‰æ¶ˆæ¯é¡ºåºå†™CommitLogï¼Œ<strong>ä½†å­˜åœ¨â€œå†™æ”¾å¤§â€</strong> ï¼Œä¸€æ¡æ¶ˆæ¯éœ€å†™å¤šæ¬¡ï¼ˆ1æ¬¡CommitLog + Næ¬¡ConsumeQueueï¼‰ã€‚</td></tr><tr><td><strong>è¯»æ€§èƒ½</strong></td><td><strong>æ¶ˆè´¹è€…è½åæ—¶å¯èƒ½è§¦å‘éšæœºè¯»</strong>ï¼šè‹¥æ¶ˆè´¹è€…è¦è¯»å–éå°¾éƒ¨å†å²æ•°æ®ï¼Œå¯èƒ½éœ€ç£ç›˜å¯»é“ã€‚ä½†ç°ä»£SSDå’Œé¢„è¯»æœºåˆ¶å·²å¤§å¤§ç¼“è§£æ­¤é—®é¢˜ã€‚</td><td><strong>è¯»è·¯å¾„ä¼˜åŒ–</strong>ï¼šConsumeQueueå°è€Œå›ºå®šï¼Œå¯å…¨é‡ç¼“å­˜è‡³å†…å­˜ï¼Œè¯»æ“ä½œå˜ä¸ºâ€œå†…å­˜å¯»å€ + CommitLogé¡ºåº/éšæœºè¯»â€ã€‚åœ¨PageCacheå‘½ä¸­ç‡é«˜æ—¶è¡¨ç°ä¼˜å¼‚ã€‚</td></tr><tr><td><strong>æ‰©å±•æ€§ä¸æˆæœ¬</strong></td><td><strong>æ–‡ä»¶å¥æŸ„ï¼ˆinodeï¼‰å¼€é”€å¤§</strong>ï¼šæ¯ä¸ªåˆ†åŒºéƒ½æ˜¯ç‹¬ç«‹ç›®å½•å’Œæ–‡ä»¶ï¼Œæµ·é‡åˆ†åŒºæ—¶è¿ç»´æˆæœ¬é«˜ã€‚</td><td><strong>å­˜å‚¨æˆæœ¬ä¸æ•ˆç‡æ›´ä¼˜</strong>ï¼šå¤šTopicå…±äº«CommitLogï¼Œæ–‡ä»¶æ•°å°‘ï¼Œ<strong>ç‰¹åˆ«é€‚åˆä¸­å°æ¶ˆæ¯ä½“ã€å¤šTopicçš„åœºæ™¯</strong>ã€‚</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td><strong>æ—¥å¿—æµã€æŒ‡æ ‡ç›‘æ§ã€å®æ—¶æµå¤„ç†</strong>ï¼šä½œä¸ºå¤§æ•°æ®ç®¡é“ï¼Œä¸Flink/Sparkç”Ÿæ€æ— ç¼é›†æˆã€‚</td><td><strong>ç”µå•†äº¤æ˜“ã€é‡‘èä¸šåŠ¡ã€å¼‚æ­¥è§£è€¦</strong>ï¼šéœ€è¦ä¸¥æ ¼é¡ºåºã€äº‹åŠ¡ä¿éšœã€ä¸šåŠ¡æŸ¥è¯¢çš„åœ¨çº¿ä¸šåŠ¡åœºæ™¯ã€‚</td></tr></tbody></table>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒKafkaåƒä¸€ä¸ªè®¾è®¡ç²¾è‰¯çš„<strong>é«˜é€Ÿå…¬è·¯ç³»ç»Ÿï¼Œ</strong> æ ¸å¿ƒç›®æ ‡æ˜¯è®©æ•°æ®è½¦è¾†ï¼ˆæ¶ˆæ¯ï¼‰èƒ½å¤Ÿé«˜ååã€ä½å»¶è¿Ÿåœ°æŒç»­æµåŠ¨ï¼Œå¹¶æ–¹ä¾¿åœ°å¼•å‘å„ä¸ªå¤„ç†å·¥å‚ï¼ˆæµè®¡ç®—ï¼‰ã€‚è€ŒRocketMQåˆ™åƒä¸€ä¸ªé«˜åº¦å¯é çš„<strong>å¿«é€’ç½‘ç»œï¼Œ</strong> ä¸ä»…ç¡®ä¿åŒ…è£¹ï¼ˆæ¶ˆæ¯ï¼‰å‡†ç¡®é€è¾¾ï¼Œè¿˜æä¾›é¢„çº¦é…é€ï¼ˆå®šæ—¶ï¼‰ã€ç­¾æ”¶ç¡®è®¤ï¼ˆäº‹åŠ¡ï¼‰ã€å¼‚å¸¸é‡æŠ•ï¼ˆé‡è¯•ï¼‰ç­‰ä¸€ç³»åˆ—æœåŠ¡äºä¸šåŠ¡é€»è¾‘çš„å¢å€¼åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-6">RocketMQå¯¹äºéšæœºè¯»å–çš„ä¼˜åŒ–</h3>
<p>RocketMQåœ¨æ¶ˆè´¹æ—¶å€™çš„æµç¨‹</p>
<pre><code class="hljs">æ¶ˆè´¹è€…è¯·æ±‚Â â†’Â ConsumeQueueï¼ˆå†…å­˜/é¡ºåºï¼‰è·å–commitlogä¸Šçš„ç‰©ç†åç§»é‡ â†’ æ ¹æ®ç‰©ç†åç§»é‡å®šä½CommitLogï¼ˆç£ç›˜/éšæœºï¼‰Â â†’Â è¿”å›æ¶ˆæ¯
</code></pre>
<p>ä»ConsumeQueueè·å–åˆ°æ¶ˆæ¯åœ¨commitlogä¸­çš„åç§»é‡çš„æ—¶å€™ï¼Œå›æŸ¥æ—¶å€™å¯èƒ½äº§ç”ŸéšæœºIO</p>
<ol>
<li><strong>ç¬¬ä¸€æ¬¡éšæœºIOï¼š</strong> æ ¹æ®ConsumeQueueä¸­çš„ç‰©ç†åç§»é‡ï¼Œåœ¨CommitLogä¸­å®šä½æ¶ˆæ¯ä½ç½®</li>
<li><strong>å¯èƒ½çš„è¿ç»­éšæœºIOï¼š</strong> å¦‚æœä¸€æ¬¡æ‹‰å–å¤šæ¡æ¶ˆæ¯ï¼Œè¿™äº›æ¶ˆæ¯åœ¨CommitLogä¸­å¯èƒ½ç‰©ç†ä¸è¿ç»­</li>
</ol>
<p>ä¸ºäº†ä¿è¯RocketMQçš„é«˜æ€§èƒ½ï¼Œé‡‡ç”¨ä¸€äº›ä¼˜åŒ–æªæ–½ï¼Œå°½é‡é¿å…éšæœºIO</p>
<p><strong>1. ConsumeQueueçš„å†…å­˜æ˜ å°„ä¼˜åŒ–</strong></p>
<p>å®é™…ä¸Šï¼ŒRocketMQå°†ConsumeQueueæ˜ å°„åˆ°å†…å­˜,æ¯ä¸ªConsumeQueueçº¦5.72MBï¼Œå¯å®Œå…¨æ”¾å…¥PageCache,è¯»ç´¢å¼•æ“ä½œå‡ ä¹æ˜¯å†…å­˜æ“ä½œã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">ConsumeQueue</span>Â {
Â  Â  <span class="hljs-keyword">private</span> MappedFile mappedFile; Â <span class="hljs-comment">//Â å†…å­˜æ˜ å°„æ–‡ä»¶</span>
Â  Â  <span class="hljs-comment">//Â 20å­—èŠ‚æ¯æ¡ï¼š8(offset) +Â 4(size) +Â 8(tagHashCode)</span>
}
</code></pre>
<p><strong>2. PageCacheçš„å……åˆ†åˆ©ç”¨</strong></p>
<p>Linux PageCacheå·¥ä½œæµç¨‹ï¼šÂ </p>
<ol>
<li>æ¶ˆæ¯å†™å…¥CommitLog â†’ è¿›å…¥PageCache</li>
<li>æ¶ˆè´¹è€…è¯»å– â†’ ä¼˜å…ˆä»PageCacheè·å–</li>
<li>å¦‚æœPageCacheå‘½ä¸­ï¼šå†…å­˜é€Ÿåº¦ï¼ˆâ‰ˆ100nsï¼‰</li>
<li>å¦‚æœPageCacheæœªå‘½ä¸­ï¼šç£ç›˜éšæœºè¯»å–ï¼ˆâ‰ˆ10msï¼‰</li>
</ol>
<p><strong>3. æ‰¹é‡è¯»å–ä¼˜åŒ–</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// DefaultMessageStore.java</span>
publicÂ GetMessageResultÂ <span class="hljs-built_in">getMessage</span>(...)Â {
Â  Â Â <span class="hljs-comment">// ä¸€æ¬¡è¯»å–å¤šæ¡æ¶ˆæ¯ï¼ˆé»˜è®¤æœ€å¤š32æ¡ï¼‰</span>
Â  Â Â <span class="hljs-comment">// å³ä½¿è¿™äº›æ¶ˆæ¯ç‰©ç†ä¸è¿ç»­ï¼Œé€šè¿‡æ‰¹é‡è¯»å–å‡å°‘IOæ¬¡æ•°</span>
Â  Â Â forÂ (intÂ i =Â <span class="hljs-number">0</span>; i &lt; maxMsgNums; i++) {
Â  Â  Â  Â Â <span class="hljs-comment">// ä½¿ç”¨åŒä¸€ä¸ªæ–‡ä»¶channelæ‰¹é‡è¯»å–</span>
Â  Â  Â  Â  <span class="hljs-built_in">readMessage</span>(ctx, msgId, consumerGroup);
Â  Â  }
}
</code></pre>
<p><strong>4. è¯»å–é¡ºåºæ€§çš„ä¿æŒ</strong></p>
<p>è™½ç„¶CommitLogä¸­ä¸åŒTopicçš„æ¶ˆæ¯æ˜¯éšæœºå­˜æ”¾çš„ï¼Œä½†åŒä¸€ä¸ªQueueçš„æ¶ˆæ¯åœ¨CommitLogä¸­æ˜¯åŸºæœ¬è¿ç»­çš„ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">Queue1: | Msg1 | Msg3 | Msg5 | ... | åœ¨ConsumeQueueä¸­è¿ç»­
Â  Â  Â  Â  â†“ Â  Â  Â â†“ Â  Â  Â â†“
CommitLog: | Msg1 | Msg2(T2) | Msg3 | Msg4(T3) | Msg5 |
Â  Â  Â  Â  Â  â†‘<span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-emphasis">_â†‘
Â  Â  Â  Â  Â  ç‰©ç†ä¸Šç›¸å¯¹è¿ç»­ï¼Œå‡å°‘ç£å¤´å¯»é“
</span></code></pre>
<h3 data-id="heading-7">é«˜å¯ç”¨è®¾è®¡ï¼šåŒè½¨å¹¶è¡Œçš„å¯é æ€§æ¶æ„</h3>
<p><strong>ä¸»ä»æ¶æ„ï¼ˆMaster-Slaveï¼‰</strong></p>
<p><strong>ç»å…¸ä¸»ä»æ¨¡å¼ï¼š</strong> RocketMQæ—©æœŸé‡‡ç”¨Master-Slaveæ¶æ„ï¼ŒMasterå¤„ç†æ‰€æœ‰è¯»å†™è¯·æ±‚ï¼ŒSlaveä»…ä½œä¸ºçƒ­å¤‡ä»½ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œ<strong>æ•…éšœåˆ‡æ¢ä¾èµ–äººå·¥å¹²é¢„æˆ–åŠè‡ªåŠ¨è„šæœ¬ï¼Œ</strong> æ¢å¤æ—¶é—´é€šå¸¸åœ¨åˆ†é’Ÿçº§åˆ«ã€‚</p>
<p><strong>Dledgeré«˜å¯ç”¨é›†ç¾¤ï¼š</strong> RocketMQ 4.5å¼•å…¥çš„DledgeråŸºäºRaftåè®®å®ç°<strong>çœŸæ­£çš„ä¸»ä»è‡ªåŠ¨åˆ‡æ¢ã€‚</strong> å½“Masteræ•…éšœæ—¶ï¼Œé›†ç¾¤èƒ½åœ¨ç§’çº§ï¼ˆé€šå¸¸2-10ç§’ï¼‰å†…è‡ªåŠ¨é€‰ä¸¾æ–°Leaderï¼ŒæœŸé—´æ¶ˆæ¯ä»å¯å†™å…¥ï¼ˆå†™å…¥è¯·æ±‚ä¼šé˜»å¡è‡³æ–°Leaderé€‰å‡ºï¼‰ã€‚</p>
<p><strong>å¤šå‰¯æœ¬æœºåˆ¶ï¼š</strong> ç°ä»£éƒ¨ç½²ä¸­ï¼Œå»ºè®®é‡‡ç”¨<strong>2ä¸»2ä»æˆ–3ä¸»3ä»</strong>æ¶æ„ã€‚ä¾‹å¦‚åœ¨é˜¿é‡Œäº‘ä¸Šï¼Œæ¯ä¸ªBrokerç»„åŒ…å«1ä¸ªMasterå’Œ2ä¸ªSlaveï¼Œå½¢æˆ<strong>è·¨å¯ç”¨åŒºçš„ä¸‰å‰¯æœ¬ï¼Œ</strong> å•æœºæˆ¿æ•…éšœä¸å½±å“æœåŠ¡å¯ç”¨æ€§ã€‚</p>
<p><strong>åŒæ­¥/å¼‚æ­¥å¤åˆ¶</strong></p>
<p>åŒæ­¥å¤åˆ¶ä¿è¯å¼ºä¸€è‡´ï¼ˆæ¶ˆæ¯ä¸ä¸¢å¤±ï¼‰ï¼Œå¼‚æ­¥å¤åˆ¶è¿½æ±‚æ›´é«˜æ€§èƒ½ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// Brokeré…ç½®ç¤ºä¾‹</span>
brokerRole =Â SYNC_MASTER
<span class="hljs-comment">// ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åï¼Œå¿…é¡»ç­‰å¾…è‡³å°‘ä¸€ä¸ªSlaveç¡®è®¤</span>
<span class="hljs-comment">// ç¡®ä¿å³ä½¿Masterå®•æœºï¼Œæ¶ˆæ¯ä¹Ÿä¸ä¼šä¸¢å¤±</span>
</code></pre>
<ul>
<li>å¼ºä¸€è‡´æ€§ä¿è¯ï¼šæ¶ˆæ¯å†™å…¥Masteråï¼ŒåŒæ­¥å¤åˆ¶åˆ°Slaveæ‰è¿”å›æˆåŠŸ</li>
<li>æ€§èƒ½ä»£ä»·ï¼šå»¶è¿Ÿå¢åŠ çº¦30-50%ï¼ŒTPSä¸‹é™çº¦20-40%</li>
<li>é€‚ç”¨åœºæ™¯ï¼šé‡‘èäº¤æ˜“ã€èµ„é‡‘å˜åŠ¨ç­‰å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚æé«˜çš„ä¸šåŠ¡</li>
</ul>
<p><strong>åŒæ­¥/å¼‚æ­¥åˆ·ç›˜</strong></p>
<p>åŒæ­¥åˆ·ç›˜ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–ä¸ä¸¢å¤±ï¼Œå¼‚æ­¥åˆ·ç›˜æå‡ååã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">brokerRole =Â ASYNC_MASTER
<span class="hljs-comment">// æ¶ˆæ¯å†™å…¥Masterå³è¿”å›æˆåŠŸï¼ŒSlaveå¼‚æ­¥å¤åˆ¶</span>
<span class="hljs-comment">// å­˜åœ¨æçŸ­æ—¶é—´çš„æ•°æ®ä¸¢å¤±é£é™©</span>
</code></pre>
<ul>
<li><strong>é«˜æ€§èƒ½æ¨¡å¼ï¼š</strong> å»¶è¿Ÿé™ä½ï¼Œååé‡æ¥è¿‘å•èŠ‚ç‚¹æ€§èƒ½</li>
<li><strong>é£é™©çª—å£ï¼š</strong> Masterå®•æœºä¸”æ•°æ®æœªåŒæ­¥æ—¶ï¼Œæœ€è¿‘å‡ ç§’æ¶ˆæ¯å¯èƒ½ä¸¢å¤±</li>
<li><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> æ—¥å¿—æ”¶é›†ã€ç›‘æ§æ•°æ®ã€å¯å®¹å¿å¾®é‡ä¸¢å¤±çš„ä¸šåŠ¡æ¶ˆæ¯</li>
</ul>
<h3 data-id="heading-8">åˆ·ç›˜ç­–ç•¥çš„å·¥ç¨‹ä¼˜åŒ–</h3>
<p><strong>åŒæ­¥åˆ·ç›˜ï¼ˆSYNC_FLUSHï¼‰</strong></p>
<pre><code class="hljs">ç”Ÿäº§è€… â†’ Brokerå†…å­˜ â†’ ç£ç›˜å¼ºåˆ¶åˆ·ç›˜ â†’ è¿”å›æˆåŠŸ
</code></pre>
<ul>
<li><strong>é›¶æ•°æ®ä¸¢å¤±ï¼š</strong> å³ä½¿æœºå™¨æ‰ç”µï¼Œæ¶ˆæ¯ä¹Ÿå·²æŒä¹…åŒ–åˆ°ç£ç›˜</li>
<li><strong>æ€§èƒ½ç“¶é¢ˆï¼š</strong> æ¯æ¬¡å†™å…¥éƒ½è§¦å‘ç£ç›˜IOï¼Œæœºæ¢°ç¡¬ç›˜ä¸‹TPSé€šå¸¸&lt;1000</li>
<li><strong>ä¼˜åŒ–æ‰‹æ®µï¼š</strong> ä½¿ç”¨SSDç¡¬ç›˜å¯å¤§å¹…æå‡æ€§èƒ½</li>
</ul>
<p><strong>å¼‚æ­¥åˆ·ç›˜ï¼ˆASYNC_FLUSHï¼‰</strong></p>
<pre><code class="hljs">ç”Ÿäº§è€… â†’ Brokerå†…å­˜ â†’ ç«‹å³è¿”å›æˆåŠŸ â†’ å¼‚æ­¥æ‰¹é‡åˆ·ç›˜
</code></pre>
<ul>
<li><strong>é«˜æ€§èƒ½é€‰æ‹©ï¼š</strong> ä¾èµ–PageCacheï¼ŒSSDä¸‹TPSå¯è¾¾æ•°ä¸‡è‡³æ•°åä¸‡</li>
<li><strong>å¯é æ€§ä¾èµ–ï¼š</strong> ä¾èµ–æ“ä½œç³»ç»Ÿçš„åˆ·ç›˜æœºåˆ¶ï¼ˆé€šå¸¸5ç§’åˆ·ç›˜ä¸€æ¬¡ï¼‰</li>
<li><strong>é…ç½®è°ƒä¼˜ï¼š</strong></li>
</ul>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è°ƒæ•´åˆ·ç›˜å‚æ•°</span>
<span class="hljs-attr">flushCommitLogLeastPages</span>Â =Â <span class="hljs-number">4</span>Â  Â Â <span class="hljs-comment"># è‡³å°‘4é¡µï¼ˆ16KBï¼‰æ‰åˆ·ç›˜</span>
<span class="hljs-attr">flushCommitLogThoroughInterval</span>Â =Â <span class="hljs-number">10000</span>Â Â <span class="hljs-comment"># 10ç§’å¼ºåˆ¶åˆ·ç›˜ä¸€æ¬¡</span>
</code></pre>
<h2 data-id="heading-9">å››ã€Producerä¸Consumerï¼šé«˜æ•ˆçš„ç”Ÿäº§ä¸æ¶ˆè´¹æ¨¡å‹</h2>
<h3 data-id="heading-10">Producer</h3>
<p><strong>æ¶ˆæ¯è·¯ç”±ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å†…ç½®å¤šç§é˜Ÿåˆ—é€‰æ‹©ç®—æ³•</span>
<span class="hljs-title class_">DefaultMQProducer</span>Â producer =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">"ProducerGroup"</span>);
<span class="hljs-comment">// 1. è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ï¼šå‡åŒ€åˆ†å¸ƒåˆ°æ‰€æœ‰é˜Ÿåˆ—</span>
<span class="hljs-comment">// 2. å“ˆå¸Œï¼šç›¸åŒKeyçš„æ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ï¼Œä¿è¯å±€éƒ¨é¡ºåº</span>
<span class="hljs-comment">// 3. æœºæˆ¿å°±è¿‘ï¼šä¼˜å…ˆé€‰æ‹©åŒæœºæˆ¿çš„Broker</span>
producer.<span class="hljs-title function_">send</span>(msg,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">MessageQueueSelector</span>() {
Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">MessageQueue</span>Â <span class="hljs-title function_">select</span>(<span class="hljs-params">List&lt;MessageQueue&gt; mqs,Â MessageÂ msg,Â <span class="hljs-built_in">Object</span>Â arg</span>) {
Â  Â  Â  Â Â <span class="hljs-comment">// è‡ªå®šä¹‰è·¯ç”±é€»è¾‘</span>
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â mqs.<span class="hljs-title function_">get</span>(arg.<span class="hljs-title function_">hashCode</span>() % mqs.<span class="hljs-title function_">size</span>());
Â  Â  }
});
</code></pre>
<p><strong>å‘é€æ¨¡å¼å¯¹æ¯”ï¼š</strong></p>





























<table><thead><tr><th>æ¨¡å¼</th><th>ç‰¹ç‚¹</th><th>æ€§èƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>åŒæ­¥å‘é€</strong></td><td>é˜»å¡ç­‰å¾…Brokerå“åº”</td><td>TPSçº¦5000-20000</td><td>é‡è¦ä¸šåŠ¡æ¶ˆæ¯ï¼Œéœ€ç«‹å³çŸ¥é“å‘é€ç»“æœ</td></tr><tr><td><strong>å¼‚æ­¥å‘é€</strong></td><td>å›è°ƒé€šçŸ¥ç»“æœ</td><td>TPSå¯è¾¾50000+</td><td>é«˜å¹¶å‘åœºæ™¯ï¼Œå¦‚æ—¥å¿—ã€ç›‘æ§æ•°æ®</td></tr><tr><td><strong>å•å‘å‘é€</strong></td><td>å‘é€åä¸ç­‰å¾…</td><td>TPSæœ€é«˜ï¼ˆ100000+ï¼‰</td><td>å¯å®¹å¿å°‘é‡ä¸¢å¤±çš„éå…³é”®æ•°æ®</td></tr></tbody></table>
<p><strong>å¤±è´¥é‡è¯•ä¸ç†”æ–­ï¼š</strong></p>
<ul>
<li><strong>æ™ºèƒ½é‡è¯•ï¼š</strong> å‘é€å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼ˆé»˜è®¤2æ¬¡ï¼‰ï¼Œå¯é…ç½®é€€é¿ç­–ç•¥</li>
<li><strong>æ•…éšœè§„é¿ï¼š</strong> è‡ªåŠ¨æ£€æµ‹Brokerå¯ç”¨æ€§ï¼Œæ•…éšœæœŸé—´è·¯ç”±åˆ°å¥åº·èŠ‚ç‚¹</li>
<li><strong>æ…¢è¯·æ±‚ç†”æ–­ï¼š</strong> ç»Ÿè®¡å‘é€è€—æ—¶ï¼Œè‡ªåŠ¨éš”ç¦»å“åº”æ…¢çš„Broker</li>
</ul>
<h3 data-id="heading-11">Consumer</h3>
<p><strong>è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é›†ç¾¤æ¨¡å¼ï¼šåŒä¸€ConsumerGroupå†…æ¶ˆè´¹è€…å‡åˆ†é˜Ÿåˆ—</span>
consumer<span class="hljs-selector-class">.setMessageModel</span>(MessageModel.CLUSTERING);
<span class="hljs-comment">// å¹¿æ’­æ¨¡å¼ï¼šæ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹å…¨é‡é˜Ÿåˆ—</span>
consumer<span class="hljs-selector-class">.setMessageModel</span>(MessageModel.BROADCASTING);
</code></pre>
<p><strong>æ¶ˆè´¹è¿›åº¦ç®¡ç†ï¼š</strong></p>
<p><strong>Brokeræ‰˜ç®¡ï¼š</strong> é»˜è®¤æ–¹å¼ï¼Œæ¶ˆè´¹è¿›åº¦å­˜å‚¨åœ¨Broker</p>
<p><strong>æœ¬åœ°ç»´æŠ¤ï¼š</strong> æŸäº›åœºæ™¯ä¸‹å¯è‡ªä¸»ç®¡ç†offsetï¼ˆå¦‚æ‰¹é‡å¤„ç†ï¼‰</p>
<p><strong>é‡ç½®ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ”¯æŒå¤šç§æ¶ˆè´¹èµ·ç‚¹</span>
consumer<span class="hljs-selector-class">.setConsumeFromWhere</span>(ConsumeFromWhere.CONSUME_FROM_LAST_OFFSET); Â <span class="hljs-comment">// ä»æœ€å</span>
consumer<span class="hljs-selector-class">.setConsumeFromWhere</span>(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);Â <span class="hljs-comment">// ä»å¤´</span>
consumer<span class="hljs-selector-class">.setConsumeFromWhere</span>(ConsumeFromWhere.CONSUME_FROM_TIMESTAMP); Â  Â <span class="hljs-comment">// ä»æ—¶é—´ç‚¹</span>
</code></pre>
<p><strong>å¹¶å‘æ§åˆ¶ä¼˜åŒ–ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// å…³é”®å¹¶å‘å‚æ•°</span>
consumer<span class="hljs-selector-class">.setConsumeThreadMin</span>(<span class="hljs-number">20</span>); Â  Â Â <span class="hljs-comment">// æœ€å°æ¶ˆè´¹çº¿ç¨‹æ•°</span>
consumer<span class="hljs-selector-class">.setConsumeThreadMax</span>(<span class="hljs-number">64</span>); Â  Â Â <span class="hljs-comment">// æœ€å¤§æ¶ˆè´¹çº¿ç¨‹æ•°</span>
consumer<span class="hljs-selector-class">.setPullBatchSize</span>(<span class="hljs-number">32</span>); Â  Â  Â  Â <span class="hljs-comment">// æ¯æ¬¡æ‹‰å–æ¶ˆæ¯æ•°</span>
consumer<span class="hljs-selector-class">.setConsumeMessageBatchMaxSize</span>(<span class="hljs-number">1</span>);Â <span class="hljs-comment">// æ‰¹é‡æ¶ˆè´¹å¤§å°</span>
<span class="hljs-comment">// æµæ§æœºåˆ¶</span>
consumer<span class="hljs-selector-class">.setPullThresholdForQueue</span>(<span class="hljs-number">1000</span>); Â <span class="hljs-comment">// é˜Ÿåˆ—å †ç§¯é˜ˆå€¼</span>
consumer<span class="hljs-selector-class">.setPullInterval</span>(<span class="hljs-number">0</span>); Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ‹‰å–é—´éš”ï¼ˆ0ä¸ºé•¿è½®è¯¢ï¼‰</span>
</code></pre>
<h2 data-id="heading-12">äº”ã€æ ¸å¿ƒæµç¨‹ä¸ç‰¹æ€§èƒŒåçš„æ¶æ„æ”¯æ’‘</h2>
<p>1 <strong>.é¡ºåºæ¶ˆæ¯å¦‚ä½•ä¿è¯ï¼Ÿ</strong></p>
<p><strong>å…¨å±€é¡ºåºï¼š</strong> å•Topicå•é˜Ÿåˆ—ï¼ˆç‰ºç‰²å¹¶å‘ï¼‰ã€‚</p>
<p><strong>åˆ†åŒºé¡ºåºï¼š</strong> é€šè¿‡<strong>MessageQueueé€‰æ‹©å™¨</strong>ç¡®ä¿åŒä¸€ä¸šåŠ¡é”®ï¼ˆå¦‚è®¢å•IDï¼‰çš„æ¶ˆæ¯å‘å¾€åŒä¸€é˜Ÿåˆ—ï¼ŒConsumerç«¯æŒ‰é˜Ÿåˆ—é¡ºåºæ¶ˆè´¹ã€‚</p>
<p><strong>2.äº‹åŠ¡æ¶ˆæ¯çš„ä¸¤é˜¶æ®µæäº¤</strong></p>
<p><strong>æµç¨‹è¯¦è§£ï¼š</strong> Half Message -&gt; æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ -&gt; Commit/Rollbackã€‚</p>
<p><strong>æ¶æ„æ”¯æ’‘ï¼š</strong> Opæ¶ˆæ¯å›æŸ¥æœºåˆ¶ï¼Œè§£å†³åˆ†å¸ƒå¼äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ˜¯æ¶æ„è®¾è®¡ä¸­â€œçŠ¶æ€å¯å›æº¯â€æ€æƒ³çš„ä½“ç°ã€‚</p>
<p><strong>3.å»¶æ—¶æ¶ˆæ¯çš„å®ç°å¥¥ç§˜</strong></p>
<p><strong>å¹¶éçœŸæ­£å»¶è¿ŸæŠ•é€’ï¼š</strong> ä¸ºä¸åŒå»¶è¿Ÿçº§åˆ«é¢„è®¾<strong>ç‹¬ç«‹çš„SCHEDULE_TOPICï¼Œ</strong> å®šæ—¶ä»»åŠ¡æ‰«æåˆ°æœŸåæŠ•é€’è‡³çœŸå®Topicã€‚</p>
<p><strong>è®¾è®¡æƒè¡¡ï¼š</strong> ä»¥å­˜å‚¨å’Œè®¡ç®—æ¢å–åŠŸèƒ½çš„çµæ´»ä¸å¯é ã€‚</p>
<h2 data-id="heading-13">å…­ã€å…¶ä»–æ€§èƒ½ä¼˜åŒ–å…³é”®æŠ€æœ¯ç‚¹</h2>
<ol>
<li><strong>é›¶æ‹·è´ï¼ˆZero-copyï¼‰ï¼š</strong> é€šè¿‡sendfileæˆ–mmap+writeæ–¹å¼ï¼Œå‡å°‘å†…æ ¸æ€ä¸ç”¨æˆ·æ€é—´æ•°æ®æ‹·è´ï¼Œå¤§å¹…æå‡ç½‘ç»œå‘é€ä¸æ–‡ä»¶è¯»å†™æ•ˆç‡ã€‚</li>
<li><strong>å †å¤–å†…å­˜ä¸å†…å­˜æ± ï¼š</strong> é¿å…JVM GCå¯¹å¤§æ•°æ®å—å¤„ç†çš„å½±å“ï¼Œå®ç°é«˜æ•ˆçš„å†…å­˜ç®¡ç†ã€‚</li>
<li><strong>æ–‡ä»¶é¢„çƒ­ï¼š</strong> å¯åŠ¨æ—¶å°†å­˜å‚¨æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜å¹¶å†™å…¥â€œå‡æ•°æ®â€ï¼Œé¿å…è¿è¡Œæ—¶ç¼ºé¡µä¸­æ–­ã€‚</li>
</ol>
<h2 data-id="heading-14">ä¸ƒã€æ€»ç»“ï¼šRocketMQæ¶æ„è®¾è®¡çš„å¯ç¤º</h2>
<p>RocketMQçš„æ¶æ„è®¾è®¡ï¼Œå°¤å…¶æ˜¯å…¶åœ¨ç®€æ´æ€§ã€é«˜æ€§èƒ½å’Œäº‘åŸç”Ÿæ¼”è¿›æ–¹é¢çš„å¹³è¡¡ï¼Œä¸ºæ„å»ºç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿæä¾›äº†è®¸å¤šå®è´µå¯ç¤ºã€‚</p>
<ol>
<li><strong>åœ¨ç®€å•ä¸å®Œå¤‡é—´æƒè¡¡ï¼š</strong> RocketMQæ²¡æœ‰é‡‡ç”¨å¼ºä¸€è‡´æ€§çš„ZooKeeperï¼Œè€Œæ˜¯è‡ªç ”äº†æå…¶ç®€å•çš„NameServerã€‚è¿™è¯´æ˜åœ¨éæ ¸å¿ƒè·¯å¾„ä¸Šï¼Œç‰ºç‰²ä¸€å®šçš„åŠŸèƒ½å®Œå¤‡æ€§æ¥æ¢å–ç®€å•æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œå¯èƒ½ä¹Ÿæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</li>
<li><strong>ä»¥å†™å®šå­˜å‚¨ï¼Œä»¥è¯»ä¼˜æŸ¥è¯¢ï¼š</strong> å…¶å­˜å‚¨æ¶æ„æ˜¯å…¸å‹çš„å†™ä¼˜åŒ–è®¾è®¡ã€‚æ‰€æœ‰æ¶ˆæ¯é¡ºåºè¿½åŠ å†™å…¥ï¼Œä¿è¯äº†æœ€é«˜çš„å†™å…¥æ€§èƒ½ã€‚è€Œé’ˆå¯¹æ¶ˆè´¹å’ŒæŸ¥è¯¢è¿™ä¸¤ç§ä¸»è¦çš„â€œè¯»â€åœºæ™¯ï¼Œåˆ™åˆ†åˆ«é€šè¿‡å¼‚æ­¥æ„å»ºç´¢å¼•æ•°æ®ç»“æ„ï¼ˆConsumeQueueå’ŒIndexFileï¼‰æ¥ä¼˜åŒ–ã€‚</li>
</ol>
<h2 data-id="heading-15">å…«ã€å‚è€ƒèµ„æ–™</h2>
<ul>
<li>[RocketMQå®˜æ–¹æ–‡æ¡£](ä¸ºä»€ä¹ˆé€‰æ‹©RocketMQ | RocketMQÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Frocketmq.apache.org%2Fzh%2Fdocs%2F" target="_blank" title="https://rocketmq.apache.org/zh/docs/" ref="nofollow noopener noreferrer">rocketmq.apache.org/zh/docs/</a>)</li>
<li>[RocketMQä¸­æ–‡ç¤¾åŒº](Apache RocketMQ åŸç†å’Œæ¶æ„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Frocketmq-learning.com%2Fcourse%2FbaseLearn%2Frocketmq_learning-framework%2F%3Fspm%3D5176.29160081.0.0.a2807833VzCxtS%26source%3Dhome" target="_blank" title="https://rocketmq-learning.com/course/baseLearn/rocketmq_learning-framework/?spm=5176.29160081.0.0.a2807833VzCxtS&amp;source=home" ref="nofollow noopener noreferrer">rocketmq-learning.com/course/baseâ€¦</a>)</li>
</ul>
<h3 data-id="heading-16">å¾€æœŸå›é¡¾</h3>
<p>1.PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°</p>
<p>2.Ant Design 6.0 å°é²œï¼šä¸Šæ‰‹ç°ä»£åŒ–ç»„ä»¶å¼€å‘ï½œå¾—ç‰©æŠ€æœ¯Â </p>
<p>3.Java è®¾è®¡æ¨¡å¼ï¼šåŸç†ã€æ¡†æ¶åº”ç”¨ä¸å®æˆ˜å…¨è§£æï½œå¾—ç‰©æŠ€æœ¯</p>
<p>4.Goè¯­è¨€åœ¨é«˜å¹¶å‘é«˜å¯ç”¨ç³»ç»Ÿä¸­çš„å®è·µä¸è§£å†³æ–¹æ¡ˆï½œå¾—ç‰©æŠ€æœ¯</p>
<p>5.ä»0åˆ°1æ­å»ºä¸€ä¸ªæ™ºèƒ½åˆ†æOBSåŸ‹ç‚¹æ•°æ®çš„AI Agentï½œå¾—ç‰©æŠ€æœ¯</p>
<h3 data-id="heading-17">æ–‡ /ç£Šå­</h3>
<p>å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨æ›´æ–°æŠ€æœ¯å¹²è´§</p>
<p>è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½</p>
<p>æœªç»å¾—ç‰©æŠ€æœ¯è®¸å¯ä¸¥ç¦è½¬è½½ï¼Œå¦åˆ™ä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç†æ¸… https çš„åŠ å¯†é€»è¾‘]]></title>    <link>https://juejin.cn/post/7589454621719183410</link>    <guid>https://juejin.cn/post/7589454621719183410</guid>    <pubDate>2025-12-30T08:47:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589454621719183410" data-draft-id="7567198443786338331" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç†æ¸… https çš„åŠ å¯†é€»è¾‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T08:47:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="imoo"/> <meta itemprop="url" content="https://juejin.cn/user/2682464104364766"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç†æ¸… https çš„åŠ å¯†é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464104364766/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    imoo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T08:47:39.000Z" title="Tue Dec 30 2025 08:47:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>http æ˜¯å‰ç«¯çš„è€æœ‹å‹äº†ï¼Œä¹Ÿæ˜¯é¢è¯•å¸¸è€ƒç‚¹ï¼Œæœ€è¿‘çœ‹äº†ã€Šå›¾è§£ httpã€‹ï¼Œç»“åˆç€ ai é‡æ–°ç†äº†ä¸€é https ç›¸å…³çš„çŸ¥è¯†ï¼Œåœ¨æ­¤åˆ†äº«ã€‚</p>
<h2 data-id="heading-1">http çš„éšæ‚£</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå‰ç«¯ä¸åç«¯çš„äº¤äº’ï¼Œéƒ½éœ€è¦èµ°æ¥å£ã€‚ç»å¤§éƒ¨åˆ†æ¥å£éƒ½æ˜¯ http åè®®ï¼Œéšä¾¿ä¸¾ä¸€ä¸ªç™»å½•ä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable constant_">GET</span> /login?user=alice&amp;password=<span class="hljs-number">123456</span> <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span>
<span class="hljs-title class_">Host</span>: example.<span class="hljs-property">com</span>
<span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>: <span class="hljs-title class_">Chrome</span>
</code></pre>
<p>åœ¨è¿™ä¸ªè¯·æ±‚å‘å‡ºæ—¶ï¼Œä½ çš„ä¿¡æ¯å®é™…ä¸Šåœ¨æ•´æ¡ç½‘ç»œä¸Šéƒ½æ˜¯é€æ˜çš„ã€‚å‡å¦‚ä½ çš„ç½‘ç»œç»è¿‡è·¯ç”±å™¨ï¼Œé‚£ä¹ˆè·¯ç”±å™¨çš„ä¸»äººå°±å¯ä»¥çœ‹åˆ°ä½ è¿™ä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯èƒ½çœ‹åˆ°ä½ çš„å¯†ç  <code>user=alice&amp;password=123456</code>ã€‚</p>
<p>æ‰€ä»¥å›½å®¶æ€»ä¼šæé†’ä½ ï¼Œä¸è¦ä¹±è¿ wifiï¼Œä½ çš„ä¿¡æ¯æœ‰å¯èƒ½è¢«ç›‘å¬å’Œæ³„éœ²ã€‚</p>
<p>è€å‰ç«¯ä»¬è¿‡å»ä¹Ÿæ€»è¯´ï¼Œ<strong>å‰ç«¯å®é™…ä¸Šæ²¡æœ‰å®‰å…¨æ€§å¯è¨€</strong>ã€‚åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œhttps çš„æ¨å‡ºä¹Ÿæ˜¯ç†æ‰€å½“ç„¶çš„äº†ã€‚</p>
<h2 data-id="heading-2">å‡çº§ä¹‹ https</h2>
<p>https å®é™…ä¸Šåªæ˜¯åœ¨ http çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€ä¸ªåŠ å¯†å±‚ TLSï¼Œè¯¥åŠ å¯†å±‚ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯†æ¥ä¿è¯æ•°æ®ä¸æ³„éœ²ã€‚</p>
<p>éå¯¹ç§°åŠ å¯†ï¼ŒåŒºåˆ†äº†å…¬é’¥å’Œç§é’¥ï¼Œè¿™é‡Œæœ‰ä¸ªå¾ˆå·§å¦™çš„æ•°å­¦å…¬å¼ï¼Œä½¿ä¿¡æ¯èƒ½<strong>ä»»ä½•äººéƒ½èƒ½ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½†åˆåªèƒ½ç”¨ç§é’¥è¿›è¡Œè§£å¯†</strong>ã€‚</p>
<p>è¿™ä¸ªéå¯¹ç§°åŠ å¯†çš„è¿‡ç¨‹ç›¸å½“æ¶ˆè€—æ€§èƒ½ï¼Œå‡ ä¹æ˜¯åŸå…ˆçš„æ•°å€ç”šè‡³æ•°åå€ã€‚æœ‰æ²¡æœ‰æ—¢å¯ä»¥åŠ å¯†ï¼Œåˆä¿è¯æ€§èƒ½çš„æ–¹æ¡ˆå‘¢ï¼Ÿ</p>
<p>http ç»™å‡ºçš„ç­”æ¡ˆæ˜¯ï¼Œ<strong>åœ¨ç¬¬ä¸€æ¬¡é€šä¿¡æ—¶ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ä¼ é€’ä¸€ä¸ªå¯†ç ï¼Œéšåä½¿ç”¨è¯¥å¯†ç è¿›è¡Œå¯¹ç§°åŠ å¯†</strong>ã€‚è¿™æ ·ä¸€æ¥ï¼Œç”±äºå¯†ç ä¸ä¼šè¢«ä¸­é—´è€…æ‹¦æˆªï¼Œæ‰€ä»¥åç»­çš„å¯¹ç§°åŠ å¯†ä¹Ÿæ— æ³•è¢«è½»æ˜“ç ´è§£ã€‚</p>
<p>è™½ç„¶åœ¨æ§åˆ¶å°ä¸Šè¿˜æ˜¯ä¼šçœ‹åˆ°æ­£å¸¸çš„ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable constant_">POST</span> /api/login <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span>
<span class="hljs-title class_">Host</span>: example.<span class="hljs-property">com</span>
<span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: application/json
<span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Length</span>: <span class="hljs-number">42</span>

{<span class="hljs-string">"username"</span>: <span class="hljs-string">"alice"</span>, <span class="hljs-string">"password"</span>: <span class="hljs-string">"123456"</span>}
</code></pre>
<p><strong>ä½†è¿™åªå¯¹è‡ªå·±å¯è§</strong>ã€‚æ•°æ®åœ¨ä¼ é€’è¿‡ç¨‹ä¸­å®Œå…¨è¢«åŠ å¯†ï¼ŒæŠ“åŒ…åªèƒ½çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">9a f1 <span class="hljs-number">23</span> 8b ... 8e d0
</code></pre>
<p>ä¹Ÿå°±æ˜¯å®Œå…¨è½¬åŒ–ä¸ºäº†äºŒè¿›åˆ¶ï¼ˆåœ¨æŠ“åŒ…è½¯ä»¶å†…ä¼šç›´æ¥æ˜¾ç¤ºä¸ºåå…­è¿›åˆ¶ï¼‰ï¼Œè¿™æ ·åœ¨æ²¡æœ‰ç§é’¥çš„æƒ…å†µä¸‹ï¼Œå°±æ— æ³•å°†æ•°æ®è¿˜åŸã€‚</p>
<h2 data-id="heading-3">ç»†è¯´åŠ å¯†é€»è¾‘</h2>
<p>æˆ‘ä»¬æ¥ç¨å¾®è¯¦ç»†äº†è§£ä¸€ä¸‹ä¸­é—´çš„æµç¨‹ã€‚</p>
<p>é¦–å…ˆå¤ä¹ ä¸‹ http çš„ä¸‰æ¬¡æ¡æ‰‹ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘èµ·é“¾æ¥è¯·æ±‚ï¼Œå‘é€ä¸€ä¸ª <code>SYN</code> æ ‡è¯†</li>
<li>æœåŠ¡å™¨ç¡®è®¤å¯ä»¥æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯ï¼Œå‘é€ä¸€ä¸ª <code>SYN-ACK</code> æ ‡è¯†</li>
<li>å®¢æˆ·ç«¯ç¡®è®¤å¯ä»¥æ”¶åˆ°æœåŠ¡ç«¯æ¶ˆæ¯ï¼Œå‘é€ä¸€ä¸ª <code>ACK</code> æ ‡è¯†</li>
</ol>
<blockquote>
<p>æœ‰ä¸ªå¾ˆå¥½çš„æ¯”å–»ï¼š1.å–‚ï¼Ÿå¬å¾—åˆ°å—ï¼Œ 2.æˆ‘å¬å¾—åˆ°ï¼Œä½ å¬å¾—åˆ°æˆ‘å— 3. æˆ‘å¬å¾—åˆ°</p>
</blockquote>
<p>https çš„åŠ å¯†æµç¨‹ï¼Œå‘ç”Ÿåœ¨<strong>ä¸‰æ¬¡æ¡æ‰‹ä¹‹å</strong></p>
<p>ç›®å‰ä¸»æµæ˜¯ TLS 1.3 ç‰ˆæœ¬ï¼Œä½†æ—§çš„ TLS 1.2 ç‰ˆæœ¬ä»ç„¶æœ‰éƒ¨åˆ†å­˜é‡ã€‚è¿™ä¸¤è€…çš„åŠ å¯†æœ‰æ‰€ä¸åŒï¼Œæˆ‘ä»¬åˆ†å¼€è®¨è®ºï¼š</p>
<p>åœ¨ TLS 1.2 ä¸­ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€ TLS ç‰ˆæœ¬ï¼ŒåŠ å¯†ç®—æ³•ï¼Œéšæœºæ•° <code>Client Random</code></li>
<li>æœåŠ¡å™¨ç«¯å‘é€ç¡®è®¤ä½¿ç”¨çš„ TLS ç‰ˆæœ¬ï¼ŒåŠ å¯†ç®—æ³•ï¼Œéšæœºæ•° <code>Server Random</code></li>
<li>å®¢æˆ·ç«¯æ ¡éªŒè¯ä¹¦åï¼Œå†ç”Ÿæˆä¸€ä¸ªéšæœºé¢„ä¸»å¯†é’¥ <code>Pre-Master Key</code>ï¼Œå¹¶å°† <code>Pre-Master Key</code> ä½¿ç”¨å…¬é’¥åŠ å¯†åï¼Œå‘é€ç»™æœåŠ¡ç«¯</li>
<li>æœåŠ¡ç«¯ä½¿ç”¨ç§é’¥ï¼Œè§£å¼€åŠ å¯†ï¼Œéšå<strong>åŒæ–¹</strong>æ ¹æ®è¿™ä¸‰ä¸ªéšæœºæ•°<code>Client Random</code>ï¼Œ<code>Server Random</code>ï¼Œ<code>Pre-Master Key</code> ç”Ÿæˆå¯¹è¯ä¸»å¯†é’¥ <code>Master Key</code></li>
<li>æ ¹æ® <code>Master Key</code> ç”Ÿæˆä¸´æ—¶å¯¹è¯ç§˜é’¥</li>
<li>æ ¹æ®ä¸´æ—¶å¯¹è¯ç§˜é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†é€šä¿¡</li>
</ol>
<blockquote>
<p>ä½†è¿™é‡Œå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œ1. åŸºäº rsa ç®—æ³•çš„éå¯¹ç§°åŠ å¯†ï¼Œæ€§èƒ½æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒä¸¥é‡ 2. è¿‡ç¨‹ç¹çã€‚æ‰€ä»¥åœ¨ TLS 1.3 ä¸­å¯¹è¿™ä¸¤ç‚¹è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>
</blockquote>
<p>åœ¨ TLS 1.3 ä¸­ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€ TLS ç‰ˆæœ¬ï¼ŒåŠ å¯†ç®—æ³•ï¼Œ<code>å®¢æˆ·ç«¯ Key Share</code></li>
<li>æœåŠ¡ç«¯å‘é€ç¡®è®¤ä½¿ç”¨çš„ TLS ç‰ˆæœ¬ï¼ŒåŠ å¯†ç®—æ³•ï¼Œ<code>æœåŠ¡ç«¯ Key Share</code></li>
<li>å„è‡ªæ ¹æ® <code>Key Share</code>ï¼Œä½¿ç”¨ ECDHE ç®—æ³•ç®—å‡ºå…±äº«å¯†é’¥</li>
<li>ä½¿ç”¨å…±äº«å¯†é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†</li>
</ol>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ ECDHE ç®—æ³•ï¼Œä¸ä»…é™ä½äº†æ­¥éª¤æ•°é‡ï¼Œè€Œä¸”ç”±äº ECHDE æ‰€éœ€è¦çš„ç§˜é’¥é•¿åº¦æ›´çŸ­ï¼Œæ‰€ä»¥æ€§èƒ½ä¹Ÿæ›´åŠ ä¼˜ç§€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GIS æ•°æ®è½¬æ¢ï¼šä½¿ç”¨ GDAL å°† GeoJSON è½¬æ¢ä¸º Shp æ•°æ®]]></title>    <link>https://juejin.cn/post/7589074117644894243</link>    <guid>https://juejin.cn/post/7589074117644894243</guid>    <pubDate>2025-12-29T13:21:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589074117644894243" data-draft-id="7589104492882952244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GIS æ•°æ®è½¬æ¢ï¼šä½¿ç”¨ GDAL å°† GeoJSON è½¬æ¢ä¸º Shp æ•°æ®"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-29T13:21:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GISä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/4346787284915481"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GIS æ•°æ®è½¬æ¢ï¼šä½¿ç”¨ GDAL å°† GeoJSON è½¬æ¢ä¸º Shp æ•°æ®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4346787284915481/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GISä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T13:21:27.000Z" title="Mon Dec 29 2025 13:21:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>â</p>
<p>GeoJSON ä½œä¸ºä¸€ç§é€šç”¨çš„åœ°ç†æ•°æ®æ ¼å¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç”¨äºå…±äº«äº¤æ¢ã€‚åœ¨ GIS å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦è¿›è¡Œæ•°æ®çš„è½¬æ¢å¤„ç†ï¼Œå…¶ä¸­å¸¸è§çš„ä¾¿æ˜¯å°† GeoJSON è½¬æ¢ä¸º Shp æ•°æ®è¿›è¡Œå±•ç¤ºã€‚</p>
</blockquote>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­è®²äº†å¦‚ä½•ä½¿ç”¨<code>GDAL</code>æˆ–è€…<code>ogr2ogr</code>å·¥å…·å°†<code>txt</code>ä»¥åŠ<code>csv</code>æ–‡æœ¬æ•°æ®è½¬æ¢ä¸º<code>Shp</code>æ ¼å¼ï¼Œæœ¬ç¯‡æ•™ç¨‹åœ¨ä¹‹å‰ä¸€ç³»åˆ—æ–‡ç« çš„åŸºç¡€ä¸Šè®²è§£å¦‚ä½•ä½¿ç”¨<code>GDAL</code>å°†<code>GeoJSON</code>è½¬æ¢ä¸º<code>Shp</code>æ•°æ®ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">GDAL ç®€ä»‹</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">GDAL ä¸‹è½½å®‰è£…</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">GDAL å¼€å‘èµ·æ­¥</a></li>
</ul>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰çœ‹è¿‡ï¼Œå»ºè®®ä»ä»¥ä¸Šå†…å®¹å¼€å§‹ã€‚</p>
<h2 data-id="heading-1">1. å¼€å‘ç¯å¢ƒ</h2>
<p>æœ¬æ–‡ä½¿ç”¨å¦‚ä¸‹å¼€å‘ç¯å¢ƒï¼Œä»¥ä¾›å‚è€ƒã€‚</p>
<p>æ—¶é—´ï¼š<code>2025å¹´</code></p>
<p>ç³»ç»Ÿï¼š<code>Windows 11</code></p>
<p>Pythonï¼š<code>3.11.7</code></p>
<p>GDALï¼š<code>3.11.1</code></p>
<h2 data-id="heading-2">2. æ•°æ®å‡†å¤‡</h2>
<p><code>GeoJSON</code>æ˜¯ä¸€ç§ç”¨äºç¼–ç å„ç§åœ°ç†æ•°æ®ç»“æ„çš„æ ¼å¼ï¼Œé‡‡ç”¨<code>JSON</code>æ–¹å¼è¡¨ç¤ºã€‚åœ¨<code>WebGIS</code>å¼€å‘ä¸­ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ•°æ®ä¼ è¾“å’Œå…±äº«äº¤æ¢ã€‚</p>
<p>æœ‰å…³<code>GeoJSON</code>æ•°æ®çš„è¯¦ç»†ä»‹ç»ï¼Œè¯·å‚è€ƒå¾€æœŸæ–‡ç« ï¼š<strong>GeoJSON æ•°æ®ç®€ä»‹</strong></p>
<p><strong>å¦‚ä¸‹æ˜¯æœ¬æ–‡é€‰å–çš„éƒ¨åˆ†å›½å®¶è¾¹ç•ŒèŒƒå›´çš„GeoJSONæ•°æ®ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-less" lang="less">{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">FeatureCollection</span>","<span class="hljs-selector-tag">features</span>":<span class="hljs-selector-attr">[{<span class="hljs-string">"type"</span>:<span class="hljs-string">"Feature"</span>,<span class="hljs-string">"id"</span>:<span class="hljs-string">"AFG"</span>,<span class="hljs-string">"properties"</span>:{<span class="hljs-string">"name"</span>:<span class="hljs-string">"Afghanistan"</span>},<span class="hljs-string">"geometry"</span>:{<span class="hljs-string">"type"</span>:<span class="hljs-string">"Polygon"</span>,<span class="hljs-string">"coordinates"</span>:[[[61.210817,35.650072]</span>,<span class="hljs-selector-attr">[62.230651,35.270664]</span>,<span class="hljs-selector-attr">[62.984662,35.404041]</span>,<span class="hljs-selector-attr">[63.193538,35.857166]</span>,<span class="hljs-selector-attr">[63.982896,36.007957]</span>,<span class="hljs-selector-attr">[64.546479,36.312073]</span>,<span class="hljs-selector-attr">[64.746105,37.111818]</span>,<span class="hljs-selector-attr">[65.588948,37.305217]</span>,<span class="hljs-selector-attr">[65.745631,37.661164]</span>,<span class="hljs-selector-attr">[66.217385,37.39379]</span>,<span class="hljs-selector-attr">[66.518607,37.362784]</span>,<span class="hljs-selector-attr">[67.075782,37.356144]</span>,<span class="hljs-selector-attr">[67.83,37.144994]</span>,<span class="hljs-selector-attr">[68.135562,37.023115]</span>,<span class="hljs-selector-attr">[68.859446,37.344336]</span>,<span class="hljs-selector-attr">[69.196273,37.151144]</span>,<span class="hljs-selector-attr">[69.518785,37.608997]</span>,<span class="hljs-selector-attr">[70.116578,37.588223]</span>,<span class="hljs-selector-attr">[70.270574,37.735165]</span>,<span class="hljs-selector-attr">[70.376304,38.138396]</span>,<span class="hljs-selector-attr">[70.806821,38.486282]</span>,<span class="hljs-selector-attr">[71.348131,38.258905]</span>,<span class="hljs-selector-attr">[71.239404,37.953265]</span>,<span class="hljs-selector-attr">[71.541918,37.905774]</span>,<span class="hljs-selector-attr">[71.448693,37.065645]</span>,<span class="hljs-selector-attr">[71.844638,36.738171]</span>,<span class="hljs-selector-attr">[72.193041,36.948288]</span>,<span class="hljs-selector-attr">[72.63689,37.047558]</span>,<span class="hljs-selector-attr">[73.260056,37.495257]</span>,<span class="hljs-selector-attr">[73.948696,37.421566]</span>,<span class="hljs-selector-attr">[74.980002,37.41999]</span>,<span class="hljs-selector-attr">[75.158028,37.133031]</span>,<span class="hljs-selector-attr">[74.575893,37.020841]</span>,<span class="hljs-selector-attr">[74.067552,36.836176]</span>,<span class="hljs-selector-attr">[72.920025,36.720007]</span>,<span class="hljs-selector-attr">[71.846292,36.509942]</span>,<span class="hljs-selector-attr">[71.262348,36.074388]</span>,<span class="hljs-selector-attr">[71.498768,35.650563]</span>,<span class="hljs-selector-attr">[71.613076,35.153203]</span>,<span class="hljs-selector-attr">[71.115019,34.733126]</span>,<span class="hljs-selector-attr">[71.156773,34.348911]</span>,<span class="hljs-selector-attr">[70.881803,33.988856]</span>,<span class="hljs-selector-attr">[69.930543,34.02012]</span>,<span class="hljs-selector-attr">[70.323594,33.358533]</span>,<span class="hljs-selector-attr">[69.687147,33.105499]</span>,<span class="hljs-selector-attr">[69.262522,32.501944]</span>,<span class="hljs-selector-attr">[69.317764,31.901412]</span>,<span class="hljs-selector-attr">[68.926677,31.620189]</span>,<span class="hljs-selector-attr">[68.556932,31.71331]</span>,<span class="hljs-selector-attr">[67.792689,31.58293]</span>,<span class="hljs-selector-attr">[67.683394,31.303154]</span>,<span class="hljs-selector-attr">[66.938891,31.304911]</span>,<span class="hljs-selector-attr">[66.381458,30.738899]</span>,<span class="hljs-selector-attr">[66.346473,29.887943]</span>,<span class="hljs-selector-attr">[65.046862,29.472181]</span>,<span class="hljs-selector-attr">[64.350419,29.560031]</span>,<span class="hljs-selector-attr">[64.148002,29.340819]</span>,<span class="hljs-selector-attr">[63.550261,29.468331]</span>,<span class="hljs-selector-attr">[62.549857,29.318572]</span>,<span class="hljs-selector-attr">[60.874248,29.829239]</span>,<span class="hljs-selector-attr">[61.781222,30.73585]</span>,<span class="hljs-selector-attr">[61.699314,31.379506]</span>,<span class="hljs-selector-attr">[60.941945,31.548075]</span>,<span class="hljs-selector-attr">[60.863655,32.18292]</span>,<span class="hljs-selector-attr">[60.536078,32.981269]</span>,<span class="hljs-selector-attr">[60.9637,33.528832]</span>,<span class="hljs-selector-attr">[60.52843,33.676446]</span>,<span class="hljs-selector-attr">[60.803193,34.404102]</span>,<span class="hljs-selector-attr">[61.210817,35.650072]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">AGO</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Angola</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[16.326528,-5.87747]</span>,<span class="hljs-selector-attr">[16.57318,-6.622645]</span>,<span class="hljs-selector-attr">[16.860191,-7.222298]</span>,<span class="hljs-selector-attr">[17.089996,-7.545689]</span>,<span class="hljs-selector-attr">[17.47297,-8.068551]</span>,<span class="hljs-selector-attr">[18.134222,-7.987678]</span>,<span class="hljs-selector-attr">[18.464176,-7.847014]</span>,<span class="hljs-selector-attr">[19.016752,-7.988246]</span>,<span class="hljs-selector-attr">[19.166613,-7.738184]</span>,<span class="hljs-selector-attr">[19.417502,-7.155429]</span>,<span class="hljs-selector-attr">[20.037723,-7.116361]</span>,<span class="hljs-selector-attr">[20.091622,-6.94309]</span>,<span class="hljs-selector-attr">[20.601823,-6.939318]</span>,<span class="hljs-selector-attr">[20.514748,-7.299606]</span>,<span class="hljs-selector-attr">[21.728111,-7.290872]</span>,<span class="hljs-selector-attr">[21.746456,-7.920085]</span>,<span class="hljs-selector-attr">[21.949131,-8.305901]</span>,<span class="hljs-selector-attr">[21.801801,-8.908707]</span>,<span class="hljs-selector-attr">[21.875182,-9.523708]</span>,<span class="hljs-selector-attr">[22.208753,-9.894796]</span>,<span class="hljs-selector-attr">[22.155268,-11.084801]</span>,<span class="hljs-selector-attr">[22.402798,-10.993075]</span>,<span class="hljs-selector-attr">[22.837345,-11.017622]</span>,<span class="hljs-selector-attr">[23.456791,-10.867863]</span>,<span class="hljs-selector-attr">[23.912215,-10.926826]</span>,<span class="hljs-selector-attr">[24.017894,-11.237298]</span>,<span class="hljs-selector-attr">[23.904154,-11.722282]</span>,<span class="hljs-selector-attr">[24.079905,-12.191297]</span>,<span class="hljs-selector-attr">[23.930922,-12.565848]</span>,<span class="hljs-selector-attr">[24.016137,-12.911046]</span>,<span class="hljs-selector-attr">[21.933886,-12.898437]</span>,<span class="hljs-selector-attr">[21.887843,-16.08031]</span>,<span class="hljs-selector-attr">[22.562478,-16.898451]</span>,<span class="hljs-selector-attr">[23.215048,-17.523116]</span>,<span class="hljs-selector-attr">[21.377176,-17.930636]</span>,<span class="hljs-selector-attr">[18.956187,-17.789095]</span>,<span class="hljs-selector-attr">[18.263309,-17.309951]</span>,<span class="hljs-selector-attr">[14.209707,-17.353101]</span>,<span class="hljs-selector-attr">[14.058501,-17.423381]</span>,<span class="hljs-selector-attr">[13.462362,-16.971212]</span>,<span class="hljs-selector-attr">[12.814081,-16.941343]</span>,<span class="hljs-selector-attr">[12.215461,-17.111668]</span>,<span class="hljs-selector-attr">[11.734199,-17.301889]</span>,<span class="hljs-selector-attr">[11.640096,-16.673142]</span>,<span class="hljs-selector-attr">[11.778537,-15.793816]</span>,<span class="hljs-selector-attr">[12.123581,-14.878316]</span>,<span class="hljs-selector-attr">[12.175619,-14.449144]</span>,<span class="hljs-selector-attr">[12.500095,-13.5477]</span>,<span class="hljs-selector-attr">[12.738479,-13.137906]</span>,<span class="hljs-selector-attr">[13.312914,-12.48363]</span>,<span class="hljs-selector-attr">[13.633721,-12.038645]</span>,<span class="hljs-selector-attr">[13.738728,-11.297863]</span>,<span class="hljs-selector-attr">[13.686379,-10.731076]</span>,<span class="hljs-selector-attr">[13.387328,-10.373578]</span>,<span class="hljs-selector-attr">[13.120988,-9.766897]</span>,<span class="hljs-selector-attr">[12.87537,-9.166934]</span>,<span class="hljs-selector-attr">[12.929061,-8.959091]</span>,<span class="hljs-selector-attr">[13.236433,-8.562629]</span>,<span class="hljs-selector-attr">[12.93304,-7.596539]</span>,<span class="hljs-selector-attr">[12.728298,-6.927122]</span>,<span class="hljs-selector-attr">[12.227347,-6.294448]</span>,<span class="hljs-selector-attr">[12.322432,-6.100092]</span>,<span class="hljs-selector-attr">[12.735171,-5.965682]</span>,<span class="hljs-selector-attr">[13.024869,-5.984389]</span>,<span class="hljs-selector-attr">[13.375597,-5.864241]</span>,<span class="hljs-selector-attr">[16.326528,-5.87747]</span>]],<span class="hljs-selector-attr">[[[12.436688,-5.684304]</span>,<span class="hljs-selector-attr">[12.182337,-5.789931]</span>,<span class="hljs-selector-attr">[11.914963,-5.037987]</span>,<span class="hljs-selector-attr">[12.318608,-4.60623]</span>,<span class="hljs-selector-attr">[12.62076,-4.438023]</span>,<span class="hljs-selector-attr">[12.995517,-4.781103]</span>,<span class="hljs-selector-attr">[12.631612,-4.991271]</span>,<span class="hljs-selector-attr">[12.468004,-5.248362]</span>,<span class="hljs-selector-attr">[12.436688,-5.684304]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ALB</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Albania</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[20.590247,41.855404]</span>,<span class="hljs-selector-attr">[20.463175,41.515089]</span>,<span class="hljs-selector-attr">[20.605182,41.086226]</span>,<span class="hljs-selector-attr">[21.02004,40.842727]</span>,<span class="hljs-selector-attr">[20.99999,40.580004]</span>,<span class="hljs-selector-attr">[20.674997,40.435]</span>,<span class="hljs-selector-attr">[20.615,40.110007]</span>,<span class="hljs-selector-attr">[20.150016,39.624998]</span>,<span class="hljs-selector-attr">[19.98,39.694993]</span>,<span class="hljs-selector-attr">[19.960002,39.915006]</span>,<span class="hljs-selector-attr">[19.406082,40.250773]</span>,<span class="hljs-selector-attr">[19.319059,40.72723]</span>,<span class="hljs-selector-attr">[19.40355,41.409566]</span>,<span class="hljs-selector-attr">[19.540027,41.719986]</span>,<span class="hljs-selector-attr">[19.371769,41.877548]</span>,<span class="hljs-selector-attr">[19.304486,42.195745]</span>,<span class="hljs-selector-attr">[19.738051,42.688247]</span>,<span class="hljs-selector-attr">[19.801613,42.500093]</span>,<span class="hljs-selector-attr">[20.0707,42.58863]</span>,<span class="hljs-selector-attr">[20.283755,42.32026]</span>,<span class="hljs-selector-attr">[20.52295,42.21787]</span>,<span class="hljs-selector-attr">[20.590247,41.855404]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ARE</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">United</span>Â <span class="hljs-selector-tag">Arab</span>Â <span class="hljs-selector-tag">Emirates</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[51.579519,24.245497]</span>,<span class="hljs-selector-attr">[51.757441,24.294073]</span>,<span class="hljs-selector-attr">[51.794389,24.019826]</span>,<span class="hljs-selector-attr">[52.577081,24.177439]</span>,<span class="hljs-selector-attr">[53.404007,24.151317]</span>,<span class="hljs-selector-attr">[54.008001,24.121758]</span>,<span class="hljs-selector-attr">[54.693024,24.797892]</span>,<span class="hljs-selector-attr">[55.439025,25.439145]</span>,<span class="hljs-selector-attr">[56.070821,26.055464]</span>,<span class="hljs-selector-attr">[56.261042,25.714606]</span>,<span class="hljs-selector-attr">[56.396847,24.924732]</span>,<span class="hljs-selector-attr">[55.886233,24.920831]</span>,<span class="hljs-selector-attr">[55.804119,24.269604]</span>,<span class="hljs-selector-attr">[55.981214,24.130543]</span>,<span class="hljs-selector-attr">[55.528632,23.933604]</span>,<span class="hljs-selector-attr">[55.525841,23.524869]</span>,<span class="hljs-selector-attr">[55.234489,23.110993]</span>,<span class="hljs-selector-attr">[55.208341,22.70833]</span>,<span class="hljs-selector-attr">[55.006803,22.496948]</span>,<span class="hljs-selector-attr">[52.000733,23.001154]</span>,<span class="hljs-selector-attr">[51.617708,24.014219]</span>,<span class="hljs-selector-attr">[51.579519,24.245497]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ARG</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Argentina</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[-65.5,-55.2]</span>,<span class="hljs-selector-attr">[-66.45,-55.25]</span>,<span class="hljs-selector-attr">[-66.95992,-54.89681]</span>,<span class="hljs-selector-attr">[-67.56244,-54.87001]</span>,<span class="hljs-selector-attr">[-68.63335,-54.8695]</span>,<span class="hljs-selector-attr">[-68.63401,-52.63637]</span>,<span class="hljs-selector-attr">[-68.25,-53.1]</span>,<span class="hljs-selector-attr">[-67.75,-53.85]</span>,<span class="hljs-selector-attr">[-66.45,-54.45]</span>,<span class="hljs-selector-attr">[-65.05,-54.7]</span>,<span class="hljs-selector-attr">[-65.5,-55.2]</span>]],<span class="hljs-selector-attr">[[[-64.964892,-22.075862]</span>,<span class="hljs-selector-attr">[-64.377021,-22.798091]</span>,<span class="hljs-selector-attr">[-63.986838,-21.993644]</span>,<span class="hljs-selector-attr">[-62.846468,-22.034985]</span>,<span class="hljs-selector-attr">[-62.685057,-22.249029]</span>,<span class="hljs-selector-attr">[-60.846565,-23.880713]</span>,<span class="hljs-selector-attr">[-60.028966,-24.032796]</span>,<span class="hljs-selector-attr">[-58.807128,-24.771459]</span>,<span class="hljs-selector-attr">[-57.777217,-25.16234]</span>,<span class="hljs-selector-attr">[-57.63366,-25.603657]</span>,<span class="hljs-selector-attr">[-58.618174,-27.123719]</span>,<span class="hljs-selector-attr">[-57.60976,-27.395899]</span>,<span class="hljs-selector-attr">[-56.486702,-27.548499]</span>,<span class="hljs-selector-attr">[-55.695846,-27.387837]</span>,<span class="hljs-selector-attr">[-54.788795,-26.621786]</span>,<span class="hljs-selector-attr">[-54.625291,-25.739255]</span>,<span class="hljs-selector-attr">[-54.13005,-25.547639]</span>,<span class="hljs-selector-attr">[-53.628349,-26.124865]</span>,<span class="hljs-selector-attr">[-53.648735,-26.923473]</span>,<span class="hljs-selector-attr">[-54.490725,-27.474757]</span>,<span class="hljs-selector-attr">[-55.162286,-27.881915]</span>,<span class="hljs-selector-attr">[-56.2909,-28.852761]</span>,<span class="hljs-selector-attr">[-57.625133,-30.216295]</span>,<span class="hljs-selector-attr">[-57.874937,-31.016556]</span>,<span class="hljs-selector-attr">[-58.14244,-32.044504]</span>,<span class="hljs-selector-attr">[-58.132648,-33.040567]</span>,<span class="hljs-selector-attr">[-58.349611,-33.263189]</span>,<span class="hljs-selector-attr">[-58.427074,-33.909454]</span>,<span class="hljs-selector-attr">[-58.495442,-34.43149]</span>,<span class="hljs-selector-attr">[-57.22583,-35.288027]</span>,<span class="hljs-selector-attr">[-57.362359,-35.97739]</span>,<span class="hljs-selector-attr">[-56.737487,-36.413126]</span>,<span class="hljs-selector-attr">[-56.788285,-36.901572]</span>,<span class="hljs-selector-attr">[-57.749157,-38.183871]</span>,<span class="hljs-selector-attr">[-59.231857,-38.72022]</span>,<span class="hljs-selector-attr">[-61.237445,-38.928425]</span>,<span class="hljs-selector-attr">[-62.335957,-38.827707]</span>,<span class="hljs-selector-attr">[-62.125763,-39.424105]</span>,<span class="hljs-selector-attr">[-62.330531,-40.172586]</span>,<span class="hljs-selector-attr">[-62.145994,-40.676897]</span>,<span class="hljs-selector-attr">[-62.745803,-41.028761]</span>,<span class="hljs-selector-attr">[-63.770495,-41.166789]</span>,<span class="hljs-selector-attr">[-64.73209,-40.802677]</span>,<span class="hljs-selector-attr">[-65.118035,-41.064315]</span>,<span class="hljs-selector-attr">[-64.978561,-42.058001]</span>,<span class="hljs-selector-attr">[-64.303408,-42.359016]</span>,<span class="hljs-selector-attr">[-63.755948,-42.043687]</span>,<span class="hljs-selector-attr">[-63.458059,-42.563138]</span>,<span class="hljs-selector-attr">[-64.378804,-42.873558]</span>,<span class="hljs-selector-attr">[-65.181804,-43.495381]</span>,<span class="hljs-selector-attr">[-65.328823,-44.501366]</span>,<span class="hljs-selector-attr">[-65.565269,-45.036786]</span>,<span class="hljs-selector-attr">[-66.509966,-45.039628]</span>,<span class="hljs-selector-attr">[-67.293794,-45.551896]</span>,<span class="hljs-selector-attr">[-67.580546,-46.301773]</span>,<span class="hljs-selector-attr">[-66.597066,-47.033925]</span>,<span class="hljs-selector-attr">[-65.641027,-47.236135]</span>,<span class="hljs-selector-attr">[-65.985088,-48.133289]</span>,<span class="hljs-selector-attr">[-67.166179,-48.697337]</span>,<span class="hljs-selector-attr">[-67.816088,-49.869669]</span>,<span class="hljs-selector-attr">[-68.728745,-50.264218]</span>,<span class="hljs-selector-attr">[-69.138539,-50.73251]</span>,<span class="hljs-selector-attr">[-68.815561,-51.771104]</span>,<span class="hljs-selector-attr">[-68.149995,-52.349983]</span>,<span class="hljs-selector-attr">[-68.571545,-52.299444]</span>,<span class="hljs-selector-attr">[-69.498362,-52.142761]</span>,<span class="hljs-selector-attr">[-71.914804,-52.009022]</span>,<span class="hljs-selector-attr">[-72.329404,-51.425956]</span>,<span class="hljs-selector-attr">[-72.309974,-50.67701]</span>,<span class="hljs-selector-attr">[-72.975747,-50.74145]</span>,<span class="hljs-selector-attr">[-73.328051,-50.378785]</span>,<span class="hljs-selector-attr">[-73.415436,-49.318436]</span>,<span class="hljs-selector-attr">[-72.648247,-48.878618]</span>,<span class="hljs-selector-attr">[-72.331161,-48.244238]</span>,<span class="hljs-selector-attr">[-72.447355,-47.738533]</span>,<span class="hljs-selector-attr">[-71.917258,-46.884838]</span>,<span class="hljs-selector-attr">[-71.552009,-45.560733]</span>,<span class="hljs-selector-attr">[-71.659316,-44.973689]</span>,<span class="hljs-selector-attr">[-71.222779,-44.784243]</span>,<span class="hljs-selector-attr">[-71.329801,-44.407522]</span>,<span class="hljs-selector-attr">[-71.793623,-44.207172]</span>,<span class="hljs-selector-attr">[-71.464056,-43.787611]</span>,<span class="hljs-selector-attr">[-71.915424,-43.408565]</span>,<span class="hljs-selector-attr">[-72.148898,-42.254888]</span>,<span class="hljs-selector-attr">[-71.746804,-42.051386]</span>,<span class="hljs-selector-attr">[-71.915734,-40.832339]</span>,<span class="hljs-selector-attr">[-71.680761,-39.808164]</span>,<span class="hljs-selector-attr">[-71.413517,-38.916022]</span>,<span class="hljs-selector-attr">[-70.814664,-38.552995]</span>,<span class="hljs-selector-attr">[-71.118625,-37.576827]</span>,<span class="hljs-selector-attr">[-71.121881,-36.658124]</span>,<span class="hljs-selector-attr">[-70.364769,-36.005089]</span>,<span class="hljs-selector-attr">[-70.388049,-35.169688]</span>,<span class="hljs-selector-attr">[-69.817309,-34.193571]</span>,<span class="hljs-selector-attr">[-69.814777,-33.273886]</span>,<span class="hljs-selector-attr">[-70.074399,-33.09121]</span>,<span class="hljs-selector-attr">[-70.535069,-31.36501]</span>,<span class="hljs-selector-attr">[-69.919008,-30.336339]</span>,<span class="hljs-selector-attr">[-70.01355,-29.367923]</span>,<span class="hljs-selector-attr">[-69.65613,-28.459141]</span>,<span class="hljs-selector-attr">[-69.001235,-27.521214]</span>,<span class="hljs-selector-attr">[-68.295542,-26.89934]</span>,<span class="hljs-selector-attr">[-68.5948,-26.506909]</span>,<span class="hljs-selector-attr">[-68.386001,-26.185016]</span>,<span class="hljs-selector-attr">[-68.417653,-24.518555]</span>,<span class="hljs-selector-attr">[-67.328443,-24.025303]</span>,<span class="hljs-selector-attr">[-66.985234,-22.986349]</span>,<span class="hljs-selector-attr">[-67.106674,-22.735925]</span>,<span class="hljs-selector-attr">[-66.273339,-21.83231]</span>,<span class="hljs-selector-attr">[-64.964892,-22.075862]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ARM</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Armenia</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[43.582746,41.092143]</span>,<span class="hljs-selector-attr">[44.97248,41.248129]</span>,<span class="hljs-selector-attr">[45.179496,40.985354]</span>,<span class="hljs-selector-attr">[45.560351,40.81229]</span>,<span class="hljs-selector-attr">[45.359175,40.561504]</span>,<span class="hljs-selector-attr">[45.891907,40.218476]</span>,<span class="hljs-selector-attr">[45.610012,39.899994]</span>,<span class="hljs-selector-attr">[46.034534,39.628021]</span>,<span class="hljs-selector-attr">[46.483499,39.464155]</span>,<span class="hljs-selector-attr">[46.50572,38.770605]</span>,<span class="hljs-selector-attr">[46.143623,38.741201]</span>,<span class="hljs-selector-attr">[45.735379,39.319719]</span>,<span class="hljs-selector-attr">[45.739978,39.473999]</span>,<span class="hljs-selector-attr">[45.298145,39.471751]</span>,<span class="hljs-selector-attr">[45.001987,39.740004]</span>,<span class="hljs-selector-attr">[44.79399,39.713003]</span>,<span class="hljs-selector-attr">[44.400009,40.005]</span>,<span class="hljs-selector-attr">[43.656436,40.253564]</span>,<span class="hljs-selector-attr">[43.752658,40.740201]</span>,<span class="hljs-selector-attr">[43.582746,41.092143]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ATA</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Antarctica</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[-59.572095,-80.040179]</span>,<span class="hljs-selector-attr">[-59.865849,-80.549657]</span>,<span class="hljs-selector-attr">[-60.159656,-81.000327]</span>,<span class="hljs-selector-attr">[-62.255393,-80.863178]</span>,<span class="hljs-selector-attr">[-64.488125,-80.921934]</span>,<span class="hljs-selector-attr">[-65.741666,-80.588827]</span>,<span class="hljs-selector-attr">[-65.741666,-80.549657]</span>,<span class="hljs-selector-attr">[-66.290031,-80.255773]</span>,<span class="hljs-selector-attr">[-64.037688,-80.294944]</span>,<span class="hljs-selector-attr">[-61.883246,-80.39287]</span>,<span class="hljs-selector-attr">[-61.138976,-79.981371]</span>,<span class="hljs-selector-attr">[-60.610119,-79.628679]</span>,<span class="hljs-selector-attr">[-59.572095,-80.040179]</span>]],<span class="hljs-selector-attr">[[[-159.208184,-79.497059]</span>,<span class="hljs-selector-attr">[-161.127601,-79.634209]</span>,<span class="hljs-selector-attr">[-162.439847,-79.281465]</span>,<span class="hljs-selector-attr">[-163.027408,-78.928774]</span>,<span class="hljs-selector-attr">[-163.066604,-78.869966]</span>,<span class="hljs-selector-attr">[-163.712896,-78.595667]</span>,<span class="hljs-selector-attr">[-163.712896,-78.595667]</span>,<span class="hljs-selector-attr">[-163.105801,-78.223338]</span>,<span class="hljs-selector-attr">[-161.245113,-78.380176]</span>,<span class="hljs-selector-attr">[-160.246208,-78.693645]</span>,<span class="hljs-selector-attr">[-159.482405,-79.046338]</span>,<span class="hljs-selector-attr">[-159.208184,-79.497059]</span>]],<span class="hljs-selector-attr">[[[-45.154758,-78.04707]</span>,<span class="hljs-selector-attr">[-43.920828,-78.478103]</span>,<span class="hljs-selector-attr">[-43.48995,-79.08556]</span>,<span class="hljs-selector-attr">[-43.372438,-79.516645]</span>,<span class="hljs-selector-attr">[-43.333267,-80.026123]</span>,<span class="hljs-selector-attr">[-44.880537,-80.339644]</span>,<span class="hljs-selector-attr">[-46.506174,-80.594357]</span>,<span class="hljs-selector-attr">[-48.386421,-80.829485]</span>,<span class="hljs-selector-attr">[-50.482107,-81.025442]</span>,<span class="hljs-selector-attr">[-52.851988,-80.966685]</span>,<span class="hljs-selector-attr">[-54.164259,-80.633528]</span>,<span class="hljs-selector-attr">[-53.987991,-80.222028]</span>,<span class="hljs-selector-attr">[-51.853134,-79.94773]</span>,<span class="hljs-selector-attr">[-50.991326,-79.614623]</span>,<span class="hljs-selector-attr">[-50.364595,-79.183487]</span>,<span class="hljs-selector-attr">[-49.914131,-78.811209]</span>,<span class="hljs-selector-attr">[-49.306959,-78.458569]</span>,<span class="hljs-selector-attr">[-48.660616,-78.047018]</span>,<span class="hljs-selector-attr">[-48.660616,-78.047019]</span>,<span class="hljs-selector-attr">[-48.151396,-78.04707]</span>,<span class="hljs-selector-attr">[-46.662857,-77.831476]</span>,<span class="hljs-selector-attr">[-45.154758,-78.04707]</span>]],<span class="hljs-selector-attr">[[[-121.211511,-73.50099]</span>,<span class="hljs-selector-attr">[-119.918851,-73.657725]</span>,<span class="hljs-selector-attr">[-118.724143,-73.481353]</span>,<span class="hljs-selector-attr">[-119.292119,-73.834097]</span>,<span class="hljs-selector-attr">[-120.232217,-74.08881]</span>,<span class="hljs-selector-attr">[-121.62283,-74.010468]</span>,<span class="hljs-selector-attr">[-122.621735,-73.657778]</span>,<span class="hljs-selector-attr">[-122.621735,-73.657777]</span>,<span class="hljs-selector-attr">[-122.406245,-73.324619]</span>,<span class="hljs-selector-attr">[-121.211511,-73.50099]</span>]],<span class="hljs-selector-attr">[[[-125.559566,-73.481353]</span>,<span class="hljs-selector-attr">[-124.031882,-73.873268]</span>,<span class="hljs-selector-attr">[-124.619469,-73.834097]</span>,<span class="hljs-selector-attr">[-125.912181,-73.736118]</span>,<span class="hljs-selector-attr">[-127.28313,-73.461769]</span>,<span class="hljs-selector-attr">[-127.28313,-73.461768]</span>,<span class="hljs-selector-attr">[-126.558472,-73.246226]</span>,<span class="hljs-selector-attr">[-125.559566,-73.481353]</span>]],<span class="hljs-selector-attr">[[[-98.98155,-71.933334]</span>,<span class="hljs-selector-attr">[-97.884743,-72.070535]</span>,<span class="hljs-selector-attr">[-96.787937,-71.952971]</span>,<span class="hljs-selector-attr">[-96.20035,-72.521205]</span>,<span class="hljs-selector-attr">[-96.983765,-72.442864]</span>,<span class="hljs-selector-attr">[-98.198083,-72.482035]</span>,<span class="hljs-selector-attr">[-99.432013,-72.442864]</span>,<span class="hljs-selector-attr">[-100.783455,-72.50162]</span>,<span class="hljs-selector-attr">[-101.801868,-72.305663]</span>,<span class="hljs-selector-attr">[-102.330725,-71.894164]</span>,<span class="hljs-selector-attr">[-102.330725,-71.894164]</span>,<span class="hljs-selector-attr">[-101.703967,-71.717792]</span>,<span class="hljs-selector-attr">[-100.430919,-71.854993]</span>,<span class="hljs-selector-attr">[-98.98155,-71.933334]</span>]],<span class="hljs-selector-attr">[[[-68.451346,-70.955823]</span>,<span class="hljs-selector-attr">[-68.333834,-71.406493]</span>,<span class="hljs-selector-attr">[-68.510128,-71.798407]</span>,<span class="hljs-selector-attr">[-68.784297,-72.170736]</span>,<span class="hljs-selector-attr">[-69.959471,-72.307885]</span>,<span class="hljs-selector-attr">[-71.075889,-72.503842]</span>,<span class="hljs-selector-attr">[-72.388134,-72.484257]</span>,<span class="hljs-selector-attr">[-71.8985,-72.092343]</span>,<span class="hljs-selector-attr">[-73.073622,-72.229492]</span>,<span class="hljs-selector-attr">[-74.19004,-72.366693]</span>,<span class="hljs-selector-attr">[-74.953895,-72.072757]</span>,<span class="hljs-selector-attr">[-75.012625,-71.661258]</span>,<span class="hljs-selector-attr">[-73.915819,-71.269345]</span>,<span class="hljs-selector-attr">[-73.915819,-71.269344]</span>,<span class="hljs-selector-attr">[-73.230331,-71.15178]</span>,<span class="hljs-selector-attr">[-72.074717,-71.190951]</span>,<span class="hljs-selector-attr">[-71.780962,-70.681473]</span>,<span class="hljs-selector-attr">[-71.72218,-70.309196]</span>,<span class="hljs-selector-attr">[-71.741791,-69.505782]</span>,<span class="hljs-selector-attr">[-71.173815,-69.035475]</span>,<span class="hljs-selector-attr">[-70.253252,-68.87874]</span>,<span class="hljs-selector-attr">[-69.724447,-69.251017]</span>,<span class="hljs-selector-attr">[-69.489422,-69.623346]</span>,<span class="hljs-selector-attr">[-69.058518,-70.074016]</span>,<span class="hljs-selector-attr">[-68.725541,-70.505153]</span>,<span class="hljs-selector-attr">[-68.451346,-70.955823]</span>]],<span class="hljs-selector-attr">[[[-58.614143,-64.152467]</span>,<span class="hljs-selector-attr">[-59.045073,-64.36801]</span>,<span class="hljs-selector-attr">[-59.789342,-64.211223]</span>,<span class="hljs-selector-attr">[-60.611928,-64.309202]</span>,<span class="hljs-selector-attr">[-61.297416,-64.54433]</span>,<span class="hljs-selector-attr">[-62.0221,-64.799094]</span>,<span class="hljs-selector-attr">[-62.51176,-65.09303]</span>,<span class="hljs-selector-attr">[-62.648858,-65.484942]</span>,<span class="hljs-selector-attr">[-62.590128,-65.857219]</span>,<span class="hljs-selector-attr">[-62.120079,-66.190326]</span>,<span class="hljs-selector-attr">[-62.805567,-66.425505]</span>,<span class="hljs-selector-attr">[-63.74569,-66.503847]</span>,<span class="hljs-selector-attr">[-64.294106,-66.837004]</span>,<span class="hljs-selector-attr">[-64.881693,-67.150474]</span>,<span class="hljs-selector-attr">[-65.508425,-67.58161]</span>,<span class="hljs-selector-attr">[-65.665082,-67.953887]</span>,<span class="hljs-selector-attr">[-65.312545,-68.365335]</span>,<span class="hljs-selector-attr">[-64.783715,-68.678908]</span>,<span class="hljs-selector-attr">[-63.961103,-68.913984]</span>,<span class="hljs-selector-attr">[-63.1973,-69.227556]</span>,<span class="hljs-selector-attr">[-62.785955,-69.619419]</span>,<span class="hljs-selector-attr">[-62.570516,-69.991747]</span>,<span class="hljs-selector-attr">[-62.276736,-70.383661]</span>,<span class="hljs-selector-attr">[-61.806661,-70.716768]</span>,<span class="hljs-selector-attr">[-61.512906,-71.089045]</span>,<span class="hljs-selector-attr">[-61.375809,-72.010074]</span>,<span class="hljs-selector-attr">[-61.081977,-72.382351]</span>,<span class="hljs-selector-attr">[-61.003661,-72.774265]</span>,<span class="hljs-selector-attr">[-60.690269,-73.166179]</span>,<span class="hljs-selector-attr">[-60.827367,-73.695242]</span>,<span class="hljs-selector-attr">[-61.375809,-74.106742]</span>,<span class="hljs-selector-attr">[-61.96337,-74.439848]</span>,<span class="hljs-selector-attr">[-63.295201,-74.576997]</span>,<span class="hljs-selector-attr">[-63.74569,-74.92974]</span>,<span class="hljs-selector-attr">[-64.352836,-75.262847]</span>,<span class="hljs-selector-attr">[-65.860987,-75.635124]</span>,<span class="hljs-selector-attr">[-67.192818,-75.79191]</span>,<span class="hljs-selector-attr">[-68.446282,-76.007452]</span>,<span class="hljs-selector-attr">[-69.797724,-76.222995]</span>,<span class="hljs-selector-attr">[-70.600724,-76.634494]</span>,<span class="hljs-selector-attr">[-72.206776,-76.673665]</span>,<span class="hljs-selector-attr">[-73.969536,-76.634494]</span>,<span class="hljs-selector-attr">[-75.555977,-76.712887]</span>,<span class="hljs-selector-attr">[-77.24037,-76.712887]</span>,<span class="hljs-selector-attr">[-76.926979,-77.104802]</span>,<span class="hljs-selector-attr">[-75.399294,-77.28107]</span>,<span class="hljs-selector-attr">[-74.282876,-77.55542]</span>,<span class="hljs-selector-attr">[-73.656119,-77.908112]</span>,<span class="hljs-selector-attr">[-74.772536,-78.221633]</span>,<span class="hljs-selector-attr">[-76.4961,-78.123654]</span>,<span class="hljs-selector-attr">[-77.925858,-78.378419]</span>,<span class="hljs-selector-attr">[-77.984666,-78.789918]</span>,<span class="hljs-selector-attr">[-78.023785,-79.181833]</span>,<span class="hljs-selector-attr">[-76.848637,-79.514939]</span>,<span class="hljs-selector-attr">[-76.633224,-79.887216]</span>,<span class="hljs-selector-attr">[-75.360097,-80.259545]</span>,<span class="hljs-selector-attr">[-73.244852,-80.416331]</span>,<span class="hljs-selector-attr">[-71.442946,-80.69063]</span>,<span class="hljs-selector-attr">[-70.013163,-81.004151]</span>,<span class="hljs-selector-attr">[-68.191646,-81.317672]</span>,<span class="hljs-selector-attr">[-65.704279,-81.474458]</span>,<span class="hljs-selector-attr">[-63.25603,-81.748757]</span>,<span class="hljs-selector-attr">[-61.552026,-82.042692]</span>,<span class="hljs-selector-attr">[-59.691416,-82.37585]</span>,<span class="hljs-selector-attr">[-58.712121,-82.846106]</span>,<span class="hljs-selector-attr">[-58.222487,-83.218434]</span>,<span class="hljs-selector-attr">[-57.008117,-82.865691]</span>,<span class="hljs-selector-attr">[-55.362894,-82.571755]</span>,<span class="hljs-selector-attr">[-53.619771,-82.258235]</span>,<span class="hljs-selector-attr">[-51.543644,-82.003521]</span>,<span class="hljs-selector-attr">[-49.76135,-81.729171]</span>,<span class="hljs-selector-attr">[-47.273931,-81.709586]</span>,<span class="hljs-selector-attr">[-44.825708,-81.846735]</span>,<span class="hljs-selector-attr">[-42.808363,-82.081915]</span>,<span class="hljs-selector-attr">[-42.16202,-81.65083]</span>,<span class="hljs-selector-attr">[-40.771433,-81.356894]</span>,<span class="hljs-selector-attr">[-38.244818,-81.337309]</span>,<span class="hljs-selector-attr">[-36.26667,-81.121715]</span>,<span class="hljs-selector-attr">[-34.386397,-80.906172]</span>,<span class="hljs-selector-attr">[-32.310296,-80.769023]</span>,<span class="hljs-selector-attr">[-30.097098,-80.592651]</span>,<span class="hljs-selector-attr">[-28.549802,-80.337938]</span>,<span class="hljs-selector-attr">[-29.254901,-79.985195]</span>,<span class="hljs-selector-attr">[-29.685805,-79.632503]</span>,<span class="hljs-selector-attr">[-29.685805,-79.260226]</span>,<span class="hljs-selector-attr">[-31.624808,-79.299397]</span>,<span class="hljs-selector-attr">[-33.681324,-79.456132]</span>,<span class="hljs-selector-attr">[-35.639912,-79.456132]</span>,<span class="hljs-selector-attr">[-35.914107,-79.083855]</span>,<span class="hljs-selector-attr">[-35.77701,-78.339248]</span>,<span class="hljs-selector-attr">[-35.326546,-78.123654]</span>,<span class="hljs-selector-attr">[-33.896763,-77.888526]</span>,<span class="hljs-selector-attr">[-32.212369,-77.65345]</span>,<span class="hljs-selector-attr">[-30.998051,-77.359515]</span>,<span class="hljs-selector-attr">[-29.783732,-77.065579]</span>,<span class="hljs-selector-attr">[-28.882779,-76.673665]</span>,<span class="hljs-selector-attr">[-27.511752,-76.497345]</span>,<span class="hljs-selector-attr">[-26.160336,-76.360144]</span>,<span class="hljs-selector-attr">[-25.474822,-76.281803]</span>,<span class="hljs-selector-attr">[-23.927552,-76.24258]</span>,<span class="hljs-selector-attr">[-22.458598,-76.105431]</span>,<span class="hljs-selector-attr">[-21.224694,-75.909474]</span>,<span class="hljs-selector-attr">[-20.010375,-75.674346]</span>,<span class="hljs-selector-attr">[-18.913543,-75.439218]</span>,<span class="hljs-selector-attr">[-17.522982,-75.125698]</span>,<span class="hljs-selector-attr">[-16.641589,-74.79254]</span>,<span class="hljs-selector-attr">[-15.701491,-74.498604]</span>,<span class="hljs-selector-attr">[-15.40771,-74.106742]</span>,<span class="hljs-selector-attr">[-16.46532,-73.871614]</span>,<span class="hljs-selector-attr">[-16.112784,-73.460114]</span>,<span class="hljs-selector-attr">[-15.446855,-73.146542]</span>,<span class="hljs-selector-attr">[-14.408805,-72.950585]</span>,<span class="hljs-selector-attr">[-13.311973,-72.715457]</span>,<span class="hljs-selector-attr">[-12.293508,-72.401936]</span>,<span class="hljs-selector-attr">[-11.510067,-72.010074]</span>,<span class="hljs-selector-attr">[-11.020433,-71.539767]</span>,<span class="hljs-selector-attr">[-10.295774,-71.265416]</span>,<span class="hljs-selector-attr">[-9.101015,-71.324224]</span>,<span class="hljs-selector-attr">[-8.611381,-71.65733]</span>,<span class="hljs-selector-attr">[-7.416622,-71.696501]</span>,<span class="hljs-selector-attr">[-7.377451,-71.324224]</span>,<span class="hljs-selector-attr">[-6.868232,-70.93231]</span>,<span class="hljs-selector-attr">[-5.790985,-71.030289]</span>,<span class="hljs-selector-attr">[-5.536375,-71.402617]</span>,<span class="hljs-selector-attr">[-4.341667,-71.461373]</span>,<span class="hljs-selector-attr">[-3.048981,-71.285053]</span>,<span class="hljs-selector-attr">[-1.795492,-71.167438]</span>,<span class="hljs-selector-attr">[-0.659489,-71.226246]</span>,<span class="hljs-selector-attr">[-0.228637,-71.637745]</span>,<span class="hljs-selector-attr">[0.868195,-71.304639]</span>,<span class="hljs-selector-attr">[1.886686,-71.128267]</span>,<span class="hljs-selector-attr">[3.022638,-70.991118]</span>,<span class="hljs-selector-attr">[4.139055,-70.853917]</span>,<span class="hljs-selector-attr">[5.157546,-70.618789]</span>,<span class="hljs-selector-attr">[6.273912,-70.462055]</span>,<span class="hljs-selector-attr">[7.13572,-70.246512]</span>,<span class="hljs-selector-attr">[7.742866,-69.893769]</span>,<span class="hljs-selector-attr">[8.48711,-70.148534]</span>,<span class="hljs-selector-attr">[9.525135,-70.011333]</span>,<span class="hljs-selector-attr">[10.249845,-70.48164]</span>,<span class="hljs-selector-attr">[10.817821,-70.834332]</span>,<span class="hljs-selector-attr">[11.953824,-70.638375]</span>,<span class="hljs-selector-attr">[12.404287,-70.246512]</span>,<span class="hljs-selector-attr">[13.422778,-69.972162]</span>,<span class="hljs-selector-attr">[14.734998,-70.030918]</span>,<span class="hljs-selector-attr">[15.126757,-70.403247]</span>,<span class="hljs-selector-attr">[15.949342,-70.030918]</span>,<span class="hljs-selector-attr">[17.026589,-69.913354]</span>,<span class="hljs-selector-attr">[18.201711,-69.874183]</span>,<span class="hljs-selector-attr">[19.259373,-69.893769]</span>,<span class="hljs-selector-attr">[20.375739,-70.011333]</span>,<span class="hljs-selector-attr">[21.452985,-70.07014]</span>,<span class="hljs-selector-attr">[21.923034,-70.403247]</span>,<span class="hljs-selector-attr">[22.569403,-70.697182]</span>,<span class="hljs-selector-attr">[23.666184,-70.520811]</span>,<span class="hljs-selector-attr">[24.841357,-70.48164]</span>,<span class="hljs-selector-attr">[25.977309,-70.48164]</span>,<span class="hljs-selector-attr">[27.093726,-70.462055]</span>,<span class="hljs-selector-attr">[28.09258,-70.324854]</span>,<span class="hljs-selector-attr">[29.150242,-70.20729]</span>,<span class="hljs-selector-attr">[30.031583,-69.93294]</span>,<span class="hljs-selector-attr">[30.971733,-69.75662]</span>,<span class="hljs-selector-attr">[31.990172,-69.658641]</span>,<span class="hljs-selector-attr">[32.754053,-69.384291]</span>,<span class="hljs-selector-attr">[33.302443,-68.835642]</span>,<span class="hljs-selector-attr">[33.870419,-68.502588]</span>,<span class="hljs-selector-attr">[34.908495,-68.659271]</span>,<span class="hljs-selector-attr">[35.300202,-69.012014]</span>,<span class="hljs-selector-attr">[36.16201,-69.247142]</span>,<span class="hljs-selector-attr">[37.200035,-69.168748]</span>,<span class="hljs-selector-attr">[37.905108,-69.52144]</span>,<span class="hljs-selector-attr">[38.649404,-69.776205]</span>,<span class="hljs-selector-attr">[39.667894,-69.541077]</span>,<span class="hljs-selector-attr">[40.020431,-69.109941]</span>,<span class="hljs-selector-attr">[40.921358,-68.933621]</span>,<span class="hljs-selector-attr">[41.959434,-68.600514]</span>,<span class="hljs-selector-attr">[42.938702,-68.463313]</span>,<span class="hljs-selector-attr">[44.113876,-68.267408]</span>,<span class="hljs-selector-attr">[44.897291,-68.051866]</span>,<span class="hljs-selector-attr">[45.719928,-67.816738]</span>,<span class="hljs-selector-attr">[46.503343,-67.601196]</span>,<span class="hljs-selector-attr">[47.44344,-67.718759]</span>,<span class="hljs-selector-attr">[48.344419,-67.366068]</span>,<span class="hljs-selector-attr">[48.990736,-67.091718]</span>,<span class="hljs-selector-attr">[49.930885,-67.111303]</span>,<span class="hljs-selector-attr">[50.753471,-66.876175]</span>,<span class="hljs-selector-attr">[50.949325,-66.523484]</span>,<span class="hljs-selector-attr">[51.791547,-66.249133]</span>,<span class="hljs-selector-attr">[52.614133,-66.053176]</span>,<span class="hljs-selector-attr">[53.613038,-65.89639]</span>,<span class="hljs-selector-attr">[54.53355,-65.818049]</span>,<span class="hljs-selector-attr">[55.414943,-65.876805]</span>,<span class="hljs-selector-attr">[56.355041,-65.974783]</span>,<span class="hljs-selector-attr">[57.158093,-66.249133]</span>,<span class="hljs-selector-attr">[57.255968,-66.680218]</span>,<span class="hljs-selector-attr">[58.137361,-67.013324]</span>,<span class="hljs-selector-attr">[58.744508,-67.287675]</span>,<span class="hljs-selector-attr">[59.939318,-67.405239]</span>,<span class="hljs-selector-attr">[60.605221,-67.679589]</span>,<span class="hljs-selector-attr">[61.427806,-67.953887]</span>,<span class="hljs-selector-attr">[62.387489,-68.012695]</span>,<span class="hljs-selector-attr">[63.19049,-67.816738]</span>,<span class="hljs-selector-attr">[64.052349,-67.405239]</span>,<span class="hljs-selector-attr">[64.992447,-67.620729]</span>,<span class="hljs-selector-attr">[65.971715,-67.738345]</span>,<span class="hljs-selector-attr">[66.911864,-67.855909]</span>,<span class="hljs-selector-attr">[67.891133,-67.934302]</span>,<span class="hljs-selector-attr">[68.890038,-67.934302]</span>,<span class="hljs-selector-attr">[69.712624,-68.972791]</span>,<span class="hljs-selector-attr">[69.673453,-69.227556]</span>,<span class="hljs-selector-attr">[69.555941,-69.678226]</span>,<span class="hljs-selector-attr">[68.596258,-69.93294]</span>,<span class="hljs-selector-attr">[67.81274,-70.305268]</span>,<span class="hljs-selector-attr">[67.949889,-70.697182]</span>,<span class="hljs-selector-attr">[69.066307,-70.677545]</span>,<span class="hljs-selector-attr">[68.929157,-71.069459]</span>,<span class="hljs-selector-attr">[68.419989,-71.441788]</span>,<span class="hljs-selector-attr">[67.949889,-71.853287]</span>,<span class="hljs-selector-attr">[68.71377,-72.166808]</span>,<span class="hljs-selector-attr">[69.869307,-72.264787]</span>,<span class="hljs-selector-attr">[71.024895,-72.088415]</span>,<span class="hljs-selector-attr">[71.573285,-71.696501]</span>,<span class="hljs-selector-attr">[71.906288,-71.324224]</span>,<span class="hljs-selector-attr">[72.454627,-71.010703]</span>,<span class="hljs-selector-attr">[73.08141,-70.716768]</span>,<span class="hljs-selector-attr">[73.33602,-70.364024]</span>,<span class="hljs-selector-attr">[73.864877,-69.874183]</span>,<span class="hljs-selector-attr">[74.491557,-69.776205]</span>,<span class="hljs-selector-attr">[75.62756,-69.737034]</span>,<span class="hljs-selector-attr">[76.626465,-69.619419]</span>,<span class="hljs-selector-attr">[77.644904,-69.462684]</span>,<span class="hljs-selector-attr">[78.134539,-69.07077]</span>,<span class="hljs-selector-attr">[78.428371,-68.698441]</span>,<span class="hljs-selector-attr">[79.113859,-68.326216]</span>,<span class="hljs-selector-attr">[80.093127,-68.071503]</span>,<span class="hljs-selector-attr">[80.93535,-67.875546]</span>,<span class="hljs-selector-attr">[81.483792,-67.542388]</span>,<span class="hljs-selector-attr">[82.051767,-67.366068]</span>,<span class="hljs-selector-attr">[82.776426,-67.209282]</span>,<span class="hljs-selector-attr">[83.775331,-67.30726]</span>,<span class="hljs-selector-attr">[84.676206,-67.209282]</span>,<span class="hljs-selector-attr">[85.655527,-67.091718]</span>,<span class="hljs-selector-attr">[86.752359,-67.150474]</span>,<span class="hljs-selector-attr">[87.477017,-66.876175]</span>,<span class="hljs-selector-attr">[87.986289,-66.209911]</span>,<span class="hljs-selector-attr">[88.358411,-66.484261]</span>,<span class="hljs-selector-attr">[88.828408,-66.954568]</span>,<span class="hljs-selector-attr">[89.67063,-67.150474]</span>,<span class="hljs-selector-attr">[90.630365,-67.228867]</span>,<span class="hljs-selector-attr">[91.5901,-67.111303]</span>,<span class="hljs-selector-attr">[92.608539,-67.189696]</span>,<span class="hljs-selector-attr">[93.548637,-67.209282]</span>,<span class="hljs-selector-attr">[94.17542,-67.111303]</span>,<span class="hljs-selector-attr">[95.017591,-67.170111]</span>,<span class="hljs-selector-attr">[95.781472,-67.385653]</span>,<span class="hljs-selector-attr">[96.682399,-67.248504]</span>,<span class="hljs-selector-attr">[97.759646,-67.248504]</span>,<span class="hljs-selector-attr">[98.68021,-67.111303]</span>,<span class="hljs-selector-attr">[99.718182,-67.248504]</span>,<span class="hljs-selector-attr">[100.384188,-66.915346]</span>,<span class="hljs-selector-attr">[100.893356,-66.58224]</span>,<span class="hljs-selector-attr">[101.578896,-66.30789]</span>,<span class="hljs-selector-attr">[102.832411,-65.563284]</span>,<span class="hljs-selector-attr">[103.478676,-65.700485]</span>,<span class="hljs-selector-attr">[104.242557,-65.974783]</span>,<span class="hljs-selector-attr">[104.90846,-66.327527]</span>,<span class="hljs-selector-attr">[106.181561,-66.934931]</span>,<span class="hljs-selector-attr">[107.160881,-66.954568]</span>,<span class="hljs-selector-attr">[108.081393,-66.954568]</span>,<span class="hljs-selector-attr">[109.15864,-66.837004]</span>,<span class="hljs-selector-attr">[110.235835,-66.699804]</span>,<span class="hljs-selector-attr">[111.058472,-66.425505]</span>,<span class="hljs-selector-attr">[111.74396,-66.13157]</span>,<span class="hljs-selector-attr">[112.860378,-66.092347]</span>,<span class="hljs-selector-attr">[113.604673,-65.876805]</span>,<span class="hljs-selector-attr">[114.388088,-66.072762]</span>,<span class="hljs-selector-attr">[114.897308,-66.386283]</span>,<span class="hljs-selector-attr">[115.602381,-66.699804]</span>,<span class="hljs-selector-attr">[116.699161,-66.660633]</span>,<span class="hljs-selector-attr">[117.384701,-66.915346]</span>,<span class="hljs-selector-attr">[118.57946,-67.170111]</span>,<span class="hljs-selector-attr">[119.832924,-67.268089]</span>,<span class="hljs-selector-attr">[120.871,-67.189696]</span>,<span class="hljs-selector-attr">[121.654415,-66.876175]</span>,<span class="hljs-selector-attr">[122.320369,-66.562654]</span>,<span class="hljs-selector-attr">[123.221296,-66.484261]</span>,<span class="hljs-selector-attr">[124.122274,-66.621462]</span>,<span class="hljs-selector-attr">[125.160247,-66.719389]</span>,<span class="hljs-selector-attr">[126.100396,-66.562654]</span>,<span class="hljs-selector-attr">[127.001427,-66.562654]</span>,<span class="hljs-selector-attr">[127.882768,-66.660633]</span>,<span class="hljs-selector-attr">[128.80328,-66.758611]</span>,<span class="hljs-selector-attr">[129.704259,-66.58224]</span>,<span class="hljs-selector-attr">[130.781454,-66.425505]</span>,<span class="hljs-selector-attr">[131.799945,-66.386283]</span>,<span class="hljs-selector-attr">[132.935896,-66.386283]</span>,<span class="hljs-selector-attr">[133.85646,-66.288304]</span>,<span class="hljs-selector-attr">[134.757387,-66.209963]</span>,<span class="hljs-selector-attr">[135.031582,-65.72007]</span>,<span class="hljs-selector-attr">[135.070753,-65.308571]</span>,<span class="hljs-selector-attr">[135.697485,-65.582869]</span>,<span class="hljs-selector-attr">[135.873805,-66.033591]</span>,<span class="hljs-selector-attr">[136.206705,-66.44509]</span>,<span class="hljs-selector-attr">[136.618049,-66.778197]</span>,<span class="hljs-selector-attr">[137.460271,-66.954568]</span>,<span class="hljs-selector-attr">[138.596223,-66.895761]</span>,<span class="hljs-selector-attr">[139.908442,-66.876175]</span>,<span class="hljs-selector-attr">[140.809421,-66.817367]</span>,<span class="hljs-selector-attr">[142.121692,-66.817367]</span>,<span class="hljs-selector-attr">[143.061842,-66.797782]</span>,<span class="hljs-selector-attr">[144.374061,-66.837004]</span>,<span class="hljs-selector-attr">[145.490427,-66.915346]</span>,<span class="hljs-selector-attr">[146.195552,-67.228867]</span>,<span class="hljs-selector-attr">[145.999699,-67.601196]</span>,<span class="hljs-selector-attr">[146.646067,-67.895131]</span>,<span class="hljs-selector-attr">[147.723263,-68.130259]</span>,<span class="hljs-selector-attr">[148.839629,-68.385024]</span>,<span class="hljs-selector-attr">[150.132314,-68.561292]</span>,<span class="hljs-selector-attr">[151.483705,-68.71813]</span>,<span class="hljs-selector-attr">[152.502247,-68.874813]</span>,<span class="hljs-selector-attr">[153.638199,-68.894502]</span>,<span class="hljs-selector-attr">[154.284567,-68.561292]</span>,<span class="hljs-selector-attr">[155.165857,-68.835642]</span>,<span class="hljs-selector-attr">[155.92979,-69.149215]</span>,<span class="hljs-selector-attr">[156.811132,-69.384291]</span>,<span class="hljs-selector-attr">[158.025528,-69.482269]</span>,<span class="hljs-selector-attr">[159.181013,-69.599833]</span>,<span class="hljs-selector-attr">[159.670699,-69.991747]</span>,<span class="hljs-selector-attr">[160.80665,-70.226875]</span>,<span class="hljs-selector-attr">[161.570479,-70.579618]</span>,<span class="hljs-selector-attr">[162.686897,-70.736353]</span>,<span class="hljs-selector-attr">[163.842434,-70.716768]</span>,<span class="hljs-selector-attr">[164.919681,-70.775524]</span>,<span class="hljs-selector-attr">[166.11444,-70.755938]</span>,<span class="hljs-selector-attr">[167.309095,-70.834332]</span>,<span class="hljs-selector-attr">[168.425616,-70.971481]</span>,<span class="hljs-selector-attr">[169.463589,-71.20666]</span>,<span class="hljs-selector-attr">[170.501665,-71.402617]</span>,<span class="hljs-selector-attr">[171.20679,-71.696501]</span>,<span class="hljs-selector-attr">[171.089227,-72.088415]</span>,<span class="hljs-selector-attr">[170.560422,-72.441159]</span>,<span class="hljs-selector-attr">[170.109958,-72.891829]</span>,<span class="hljs-selector-attr">[169.75737,-73.24452]</span>,<span class="hljs-selector-attr">[169.287321,-73.65602]</span>,<span class="hljs-selector-attr">[167.975101,-73.812806]</span>,<span class="hljs-selector-attr">[167.387489,-74.165498]</span>,<span class="hljs-selector-attr">[166.094803,-74.38104]</span>,<span class="hljs-selector-attr">[165.644391,-74.772954]</span>,<span class="hljs-selector-attr">[164.958851,-75.145283]</span>,<span class="hljs-selector-attr">[164.234193,-75.458804]</span>,<span class="hljs-selector-attr">[163.822797,-75.870303]</span>,<span class="hljs-selector-attr">[163.568239,-76.24258]</span>,<span class="hljs-selector-attr">[163.47026,-76.693302]</span>,<span class="hljs-selector-attr">[163.489897,-77.065579]</span>,<span class="hljs-selector-attr">[164.057873,-77.457442]</span>,<span class="hljs-selector-attr">[164.273363,-77.82977]</span>,<span class="hljs-selector-attr">[164.743464,-78.182514]</span>,<span class="hljs-selector-attr">[166.604126,-78.319611]</span>,<span class="hljs-selector-attr">[166.995781,-78.750748]</span>,<span class="hljs-selector-attr">[165.193876,-78.907483]</span>,<span class="hljs-selector-attr">[163.666217,-79.123025]</span>,<span class="hljs-selector-attr">[161.766385,-79.162248]</span>,<span class="hljs-selector-attr">[160.924162,-79.730482]</span>,<span class="hljs-selector-attr">[160.747894,-80.200737]</span>,<span class="hljs-selector-attr">[160.316964,-80.573066]</span>,<span class="hljs-selector-attr">[159.788211,-80.945395]</span>,<span class="hljs-selector-attr">[161.120016,-81.278501]</span>,<span class="hljs-selector-attr">[161.629287,-81.690001]</span>,<span class="hljs-selector-attr">[162.490992,-82.062278]</span>,<span class="hljs-selector-attr">[163.705336,-82.395435]</span>,<span class="hljs-selector-attr">[165.095949,-82.708956]</span>,<span class="hljs-selector-attr">[166.604126,-83.022477]</span>,<span class="hljs-selector-attr">[168.895665,-83.335998]</span>,<span class="hljs-selector-attr">[169.404782,-83.825891]</span>,<span class="hljs-selector-attr">[172.283934,-84.041433]</span>,<span class="hljs-selector-attr">[172.477049,-84.117914]</span>,<span class="hljs-selector-attr">[173.224083,-84.41371]</span>,<span class="hljs-selector-attr">[175.985672,-84.158997]</span>,<span class="hljs-selector-attr">[178.277212,-84.472518]</span>,<span class="hljs-selector-attr">[180,-84.71338]</span>,<span class="hljs-selector-attr">[-179.942499,-84.721443]</span>,<span class="hljs-selector-attr">[-179.058677,-84.139412]</span>,<span class="hljs-selector-attr">[-177.256772,-84.452933]</span>,<span class="hljs-selector-attr">[-177.140807,-84.417941]</span>,<span class="hljs-selector-attr">[-176.084673,-84.099259]</span>,<span class="hljs-selector-attr">[-175.947235,-84.110449]</span>,<span class="hljs-selector-attr">[-175.829882,-84.117914]</span>,<span class="hljs-selector-attr">[-174.382503,-84.534323]</span>,<span class="hljs-selector-attr">[-173.116559,-84.117914]</span>,<span class="hljs-selector-attr">[-172.889106,-84.061019]</span>,<span class="hljs-selector-attr">[-169.951223,-83.884647]</span>,<span class="hljs-selector-attr">[-168.999989,-84.117914]</span>,<span class="hljs-selector-attr">[-168.530199,-84.23739]</span>,<span class="hljs-selector-attr">[-167.022099,-84.570497]</span>,<span class="hljs-selector-attr">[-164.182144,-84.82521]</span>,<span class="hljs-selector-attr">[-161.929775,-85.138731]</span>,<span class="hljs-selector-attr">[-158.07138,-85.37391]</span>,<span class="hljs-selector-attr">[-155.192253,-85.09956]</span>,<span class="hljs-selector-attr">[-150.942099,-85.295517]</span>,<span class="hljs-selector-attr">[-148.533073,-85.609038]</span>,<span class="hljs-selector-attr">[-145.888918,-85.315102]</span>,<span class="hljs-selector-attr">[-143.107718,-85.040752]</span>,<span class="hljs-selector-attr">[-142.892279,-84.570497]</span>,<span class="hljs-selector-attr">[-146.829068,-84.531274]</span>,<span class="hljs-selector-attr">[-150.060732,-84.296146]</span>,<span class="hljs-selector-attr">[-150.902928,-83.904232]</span>,<span class="hljs-selector-attr">[-153.586201,-83.68869]</span>,<span class="hljs-selector-attr">[-153.409907,-83.23802]</span>,<span class="hljs-selector-attr">[-153.037759,-82.82652]</span>,<span class="hljs-selector-attr">[-152.665637,-82.454192]</span>,<span class="hljs-selector-attr">[-152.861517,-82.042692]</span>,<span class="hljs-selector-attr">[-154.526299,-81.768394]</span>,<span class="hljs-selector-attr">[-155.29018,-81.41565]</span>,<span class="hljs-selector-attr">[-156.83745,-81.102129]</span>,<span class="hljs-selector-attr">[-154.408787,-81.160937]</span>,<span class="hljs-selector-attr">[-152.097662,-81.004151]</span>,<span class="hljs-selector-attr">[-150.648293,-81.337309]</span>,<span class="hljs-selector-attr">[-148.865998,-81.043373]</span>,<span class="hljs-selector-attr">[-147.22075,-80.671045]</span>,<span class="hljs-selector-attr">[-146.417749,-80.337938]</span>,<span class="hljs-selector-attr">[-146.770286,-79.926439]</span>,<span class="hljs-selector-attr">[-148.062947,-79.652089]</span>,<span class="hljs-selector-attr">[-149.531901,-79.358205]</span>,<span class="hljs-selector-attr">[-151.588416,-79.299397]</span>,<span class="hljs-selector-attr">[-153.390322,-79.162248]</span>,<span class="hljs-selector-attr">[-155.329376,-79.064269]</span>,<span class="hljs-selector-attr">[-155.975668,-78.69194]</span>,<span class="hljs-selector-attr">[-157.268302,-78.378419]</span>,<span class="hljs-selector-attr">[-158.051768,-78.025676]</span>,<span class="hljs-selector-attr">[-158.365134,-76.889207]</span>,<span class="hljs-selector-attr">[-157.875474,-76.987238]</span>,<span class="hljs-selector-attr">[-156.974573,-77.300759]</span>,<span class="hljs-selector-attr">[-155.329376,-77.202728]</span>,<span class="hljs-selector-attr">[-153.742832,-77.065579]</span>,<span class="hljs-selector-attr">[-152.920247,-77.496664]</span>,<span class="hljs-selector-attr">[-151.33378,-77.398737]</span>,<span class="hljs-selector-attr">[-150.00195,-77.183143]</span>,<span class="hljs-selector-attr">[-148.748486,-76.908845]</span>,<span class="hljs-selector-attr">[-147.612483,-76.575738]</span>,<span class="hljs-selector-attr">[-146.104409,-76.47776]</span>,<span class="hljs-selector-attr">[-146.143528,-76.105431]</span>,<span class="hljs-selector-attr">[-146.496091,-75.733154]</span>,<span class="hljs-selector-attr">[-146.20231,-75.380411]</span>,<span class="hljs-selector-attr">[-144.909624,-75.204039]</span>,<span class="hljs-selector-attr">[-144.322037,-75.537197]</span>,<span class="hljs-selector-attr">[-142.794353,-75.34124]</span>,<span class="hljs-selector-attr">[-141.638764,-75.086475]</span>,<span class="hljs-selector-attr">[-140.209007,-75.06689]</span>,<span class="hljs-selector-attr">[-138.85759,-74.968911]</span>,<span class="hljs-selector-attr">[-137.5062,-74.733783]</span>,<span class="hljs-selector-attr">[-136.428901,-74.518241]</span>,<span class="hljs-selector-attr">[-135.214583,-74.302699]</span>,<span class="hljs-selector-attr">[-134.431194,-74.361455]</span>,<span class="hljs-selector-attr">[-133.745654,-74.439848]</span>,<span class="hljs-selector-attr">[-132.257168,-74.302699]</span>,<span class="hljs-selector-attr">[-130.925311,-74.479019]</span>,<span class="hljs-selector-attr">[-129.554284,-74.459433]</span>,<span class="hljs-selector-attr">[-128.242038,-74.322284]</span>,<span class="hljs-selector-attr">[-126.890622,-74.420263]</span>,<span class="hljs-selector-attr">[-125.402082,-74.518241]</span>,<span class="hljs-selector-attr">[-124.011496,-74.479019]</span>,<span class="hljs-selector-attr">[-122.562152,-74.498604]</span>,<span class="hljs-selector-attr">[-121.073613,-74.518241]</span>,<span class="hljs-selector-attr">[-119.70256,-74.479019]</span>,<span class="hljs-selector-attr">[-118.684145,-74.185083]</span>,<span class="hljs-selector-attr">[-117.469801,-74.028348]</span>,<span class="hljs-selector-attr">[-116.216312,-74.243891]</span>,<span class="hljs-selector-attr">[-115.021552,-74.067519]</span>,<span class="hljs-selector-attr">[-113.944331,-73.714828]</span>,<span class="hljs-selector-attr">[-113.297988,-74.028348]</span>,<span class="hljs-selector-attr">[-112.945452,-74.38104]</span>,<span class="hljs-selector-attr">[-112.299083,-74.714198]</span>,<span class="hljs-selector-attr">[-111.261059,-74.420263]</span>,<span class="hljs-selector-attr">[-110.066325,-74.79254]</span>,<span class="hljs-selector-attr">[-108.714909,-74.910103]</span>,<span class="hljs-selector-attr">[-107.559346,-75.184454]</span>,<span class="hljs-selector-attr">[-106.149148,-75.125698]</span>,<span class="hljs-selector-attr">[-104.876074,-74.949326]</span>,<span class="hljs-selector-attr">[-103.367949,-74.988497]</span>,<span class="hljs-selector-attr">[-102.016507,-75.125698]</span>,<span class="hljs-selector-attr">[-100.645531,-75.302018]</span>,<span class="hljs-selector-attr">[-100.1167,-74.870933]</span>,<span class="hljs-selector-attr">[-100.763043,-74.537826]</span>,<span class="hljs-selector-attr">[-101.252703,-74.185083]</span>,<span class="hljs-selector-attr">[-102.545337,-74.106742]</span>,<span class="hljs-selector-attr">[-103.113313,-73.734413]</span>,<span class="hljs-selector-attr">[-103.328752,-73.362084]</span>,<span class="hljs-selector-attr">[-103.681289,-72.61753]</span>,<span class="hljs-selector-attr">[-102.917485,-72.754679]</span>,<span class="hljs-selector-attr">[-101.60524,-72.813436]</span>,<span class="hljs-selector-attr">[-100.312528,-72.754679]</span>,<span class="hljs-selector-attr">[-99.13738,-72.911414]</span>,<span class="hljs-selector-attr">[-98.118889,-73.20535]</span>,<span class="hljs-selector-attr">[-97.688037,-73.558041]</span>,<span class="hljs-selector-attr">[-96.336595,-73.616849]</span>,<span class="hljs-selector-attr">[-95.043961,-73.4797]</span>,<span class="hljs-selector-attr">[-93.672907,-73.283743]</span>,<span class="hljs-selector-attr">[-92.439003,-73.166179]</span>,<span class="hljs-selector-attr">[-91.420564,-73.401307]</span>,<span class="hljs-selector-attr">[-90.088733,-73.322914]</span>,<span class="hljs-selector-attr">[-89.226951,-72.558722]</span>,<span class="hljs-selector-attr">[-88.423951,-73.009393]</span>,<span class="hljs-selector-attr">[-87.268337,-73.185764]</span>,<span class="hljs-selector-attr">[-86.014822,-73.087786]</span>,<span class="hljs-selector-attr">[-85.192236,-73.4797]</span>,<span class="hljs-selector-attr">[-83.879991,-73.518871]</span>,<span class="hljs-selector-attr">[-82.665646,-73.636434]</span>,<span class="hljs-selector-attr">[-81.470913,-73.851977]</span>,<span class="hljs-selector-attr">[-80.687447,-73.4797]</span>,<span class="hljs-selector-attr">[-80.295791,-73.126956]</span>,<span class="hljs-selector-attr">[-79.296886,-73.518871]</span>,<span class="hljs-selector-attr">[-77.925858,-73.420892]</span>,<span class="hljs-selector-attr">[-76.907367,-73.636434]</span>,<span class="hljs-selector-attr">[-76.221879,-73.969541]</span>,<span class="hljs-selector-attr">[-74.890049,-73.871614]</span>,<span class="hljs-selector-attr">[-73.852024,-73.65602]</span>,<span class="hljs-selector-attr">[-72.833533,-73.401307]</span>,<span class="hljs-selector-attr">[-71.619215,-73.264157]</span>,<span class="hljs-selector-attr">[-70.209042,-73.146542]</span>,<span class="hljs-selector-attr">[-68.935916,-73.009393]</span>,<span class="hljs-selector-attr">[-67.956622,-72.79385]</span>,<span class="hljs-selector-attr">[-67.369061,-72.480329]</span>,<span class="hljs-selector-attr">[-67.134036,-72.049244]</span>,<span class="hljs-selector-attr">[-67.251548,-71.637745]</span>,<span class="hljs-selector-attr">[-67.56494,-71.245831]</span>,<span class="hljs-selector-attr">[-67.917477,-70.853917]</span>,<span class="hljs-selector-attr">[-68.230843,-70.462055]</span>,<span class="hljs-selector-attr">[-68.485452,-70.109311]</span>,<span class="hljs-selector-attr">[-68.544209,-69.717397]</span>,<span class="hljs-selector-attr">[-68.446282,-69.325535]</span>,<span class="hljs-selector-attr">[-67.976233,-68.953206]</span>,<span class="hljs-selector-attr">[-67.5845,-68.541707]</span>,<span class="hljs-selector-attr">[-67.427843,-68.149844]</span>,<span class="hljs-selector-attr">[-67.62367,-67.718759]</span>,<span class="hljs-selector-attr">[-67.741183,-67.326845]</span>,<span class="hljs-selector-attr">[-67.251548,-66.876175]</span>,<span class="hljs-selector-attr">[-66.703184,-66.58224]</span>,<span class="hljs-selector-attr">[-66.056815,-66.209963]</span>,<span class="hljs-selector-attr">[-65.371327,-65.89639]</span>,<span class="hljs-selector-attr">[-64.568276,-65.602506]</span>,<span class="hljs-selector-attr">[-64.176542,-65.171423]</span>,<span class="hljs-selector-attr">[-63.628152,-64.897073]</span>,<span class="hljs-selector-attr">[-63.001394,-64.642308]</span>,<span class="hljs-selector-attr">[-62.041686,-64.583552]</span>,<span class="hljs-selector-attr">[-61.414928,-64.270031]</span>,<span class="hljs-selector-attr">[-60.709855,-64.074074]</span>,<span class="hljs-selector-attr">[-59.887269,-63.95651]</span>,<span class="hljs-selector-attr">[-59.162585,-63.701745]</span>,<span class="hljs-selector-attr">[-58.594557,-63.388224]</span>,<span class="hljs-selector-attr">[-57.811143,-63.27066]</span>,<span class="hljs-selector-attr">[-57.223582,-63.525425]</span>,<span class="hljs-selector-attr">[-57.59573,-63.858532]</span>,<span class="hljs-selector-attr">[-58.614143,-64.152467]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">ATF</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">French</span>Â <span class="hljs-selector-tag">Southern</span>Â <span class="hljs-selector-tag">and</span>Â <span class="hljs-selector-tag">Antarctic</span>Â <span class="hljs-selector-tag">Lands</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[68.935,-48.625]</span>,<span class="hljs-selector-attr">[69.58,-48.94]</span>,<span class="hljs-selector-attr">[70.525,-49.065]</span>,<span class="hljs-selector-attr">[70.56,-49.255]</span>,<span class="hljs-selector-attr">[70.28,-49.71]</span>,<span class="hljs-selector-attr">[68.745,-49.775]</span>,<span class="hljs-selector-attr">[68.72,-49.2425]</span>,<span class="hljs-selector-attr">[68.8675,-48.83]</span>,<span class="hljs-selector-attr">[68.935,-48.625]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">AUS</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Australia</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[145.397978,-40.792549]</span>,<span class="hljs-selector-attr">[146.364121,-41.137695]</span>,<span class="hljs-selector-attr">[146.908584,-41.000546]</span>,<span class="hljs-selector-attr">[147.689259,-40.808258]</span>,<span class="hljs-selector-attr">[148.289068,-40.875438]</span>,<span class="hljs-selector-attr">[148.359865,-42.062445]</span>,<span class="hljs-selector-attr">[148.017301,-42.407024]</span>,<span class="hljs-selector-attr">[147.914052,-43.211522]</span>,<span class="hljs-selector-attr">[147.564564,-42.937689]</span>,<span class="hljs-selector-attr">[146.870343,-43.634597]</span>,<span class="hljs-selector-attr">[146.663327,-43.580854]</span>,<span class="hljs-selector-attr">[146.048378,-43.549745]</span>,<span class="hljs-selector-attr">[145.43193,-42.693776]</span>,<span class="hljs-selector-attr">[145.29509,-42.03361]</span>,<span class="hljs-selector-attr">[144.718071,-41.162552]</span>,<span class="hljs-selector-attr">[144.743755,-40.703975]</span>,<span class="hljs-selector-attr">[145.397978,-40.792549]</span>]],<span class="hljs-selector-attr">[[[143.561811,-13.763656]</span>,<span class="hljs-selector-attr">[143.922099,-14.548311]</span>,<span class="hljs-selector-attr">[144.563714,-14.171176]</span>,<span class="hljs-selector-attr">[144.894908,-14.594458]</span>,<span class="hljs-selector-attr">[145.374724,-14.984976]</span>,<span class="hljs-selector-attr">[145.271991,-15.428205]</span>,<span class="hljs-selector-attr">[145.48526,-16.285672]</span>,<span class="hljs-selector-attr">[145.637033,-16.784918]</span>,<span class="hljs-selector-attr">[145.888904,-16.906926]</span>,<span class="hljs-selector-attr">[146.160309,-17.761655]</span>,<span class="hljs-selector-attr">[146.063674,-18.280073]</span>,<span class="hljs-selector-attr">[146.387478,-18.958274]</span>,<span class="hljs-selector-attr">[147.471082,-19.480723]</span>,<span class="hljs-selector-attr">[148.177602,-19.955939]</span>,<span class="hljs-selector-attr">[148.848414,-20.39121]</span>,<span class="hljs-selector-attr">[148.717465,-20.633469]</span>,<span class="hljs-selector-attr">[149.28942,-21.260511]</span>,<span class="hljs-selector-attr">[149.678337,-22.342512]</span>,<span class="hljs-selector-attr">[150.077382,-22.122784]</span>,<span class="hljs-selector-attr">[150.482939,-22.556142]</span>,<span class="hljs-selector-attr">[150.727265,-22.402405]</span>,<span class="hljs-selector-attr">[150.899554,-23.462237]</span>,<span class="hljs-selector-attr">[151.609175,-24.076256]</span>,<span class="hljs-selector-attr">[152.07354,-24.457887]</span>,<span class="hljs-selector-attr">[152.855197,-25.267501]</span>,<span class="hljs-selector-attr">[153.136162,-26.071173]</span>,<span class="hljs-selector-attr">[153.161949,-26.641319]</span>,<span class="hljs-selector-attr">[153.092909,-27.2603]</span>,<span class="hljs-selector-attr">[153.569469,-28.110067]</span>,<span class="hljs-selector-attr">[153.512108,-28.995077]</span>,<span class="hljs-selector-attr">[153.339095,-29.458202]</span>,<span class="hljs-selector-attr">[153.069241,-30.35024]</span>,<span class="hljs-selector-attr">[153.089602,-30.923642]</span>,<span class="hljs-selector-attr">[152.891578,-31.640446]</span>,<span class="hljs-selector-attr">[152.450002,-32.550003]</span>,<span class="hljs-selector-attr">[151.709117,-33.041342]</span>,<span class="hljs-selector-attr">[151.343972,-33.816023]</span>,<span class="hljs-selector-attr">[151.010555,-34.31036]</span>,<span class="hljs-selector-attr">[150.714139,-35.17346]</span>,<span class="hljs-selector-attr">[150.32822,-35.671879]</span>,<span class="hljs-selector-attr">[150.075212,-36.420206]</span>,<span class="hljs-selector-attr">[149.946124,-37.109052]</span>,<span class="hljs-selector-attr">[149.997284,-37.425261]</span>,<span class="hljs-selector-attr">[149.423882,-37.772681]</span>,<span class="hljs-selector-attr">[148.304622,-37.809061]</span>,<span class="hljs-selector-attr">[147.381733,-38.219217]</span>,<span class="hljs-selector-attr">[146.922123,-38.606532]</span>,<span class="hljs-selector-attr">[146.317922,-39.035757]</span>,<span class="hljs-selector-attr">[145.489652,-38.593768]</span>,<span class="hljs-selector-attr">[144.876976,-38.417448]</span>,<span class="hljs-selector-attr">[145.032212,-37.896188]</span>,<span class="hljs-selector-attr">[144.485682,-38.085324]</span>,<span class="hljs-selector-attr">[143.609974,-38.809465]</span>,<span class="hljs-selector-attr">[142.745427,-38.538268]</span>,<span class="hljs-selector-attr">[142.17833,-38.380034]</span>,<span class="hljs-selector-attr">[141.606582,-38.308514]</span>,<span class="hljs-selector-attr">[140.638579,-38.019333]</span>,<span class="hljs-selector-attr">[139.992158,-37.402936]</span>,<span class="hljs-selector-attr">[139.806588,-36.643603]</span>,<span class="hljs-selector-attr">[139.574148,-36.138362]</span>,<span class="hljs-selector-attr">[139.082808,-35.732754]</span>,<span class="hljs-selector-attr">[138.120748,-35.612296]</span>,<span class="hljs-selector-attr">[138.449462,-35.127261]</span>,<span class="hljs-selector-attr">[138.207564,-34.384723]</span>,<span class="hljs-selector-attr">[137.71917,-35.076825]</span>,<span class="hljs-selector-attr">[136.829406,-35.260535]</span>,<span class="hljs-selector-attr">[137.352371,-34.707339]</span>,<span class="hljs-selector-attr">[137.503886,-34.130268]</span>,<span class="hljs-selector-attr">[137.890116,-33.640479]</span>,<span class="hljs-selector-attr">[137.810328,-32.900007]</span>,<span class="hljs-selector-attr">[136.996837,-33.752771]</span>,<span class="hljs-selector-attr">[136.372069,-34.094766]</span>,<span class="hljs-selector-attr">[135.989043,-34.890118]</span>,<span class="hljs-selector-attr">[135.208213,-34.47867]</span>,<span class="hljs-selector-attr">[135.239218,-33.947953]</span>,<span class="hljs-selector-attr">[134.613417,-33.222778]</span>,<span class="hljs-selector-attr">[134.085904,-32.848072]</span>,<span class="hljs-selector-attr">[134.273903,-32.617234]</span>,<span class="hljs-selector-attr">[132.990777,-32.011224]</span>,<span class="hljs-selector-attr">[132.288081,-31.982647]</span>,<span class="hljs-selector-attr">[131.326331,-31.495803]</span>,<span class="hljs-selector-attr">[129.535794,-31.590423]</span>,<span class="hljs-selector-attr">[128.240938,-31.948489]</span>,<span class="hljs-selector-attr">[127.102867,-32.282267]</span>,<span class="hljs-selector-attr">[126.148714,-32.215966]</span>,<span class="hljs-selector-attr">[125.088623,-32.728751]</span>,<span class="hljs-selector-attr">[124.221648,-32.959487]</span>,<span class="hljs-selector-attr">[124.028947,-33.483847]</span>,<span class="hljs-selector-attr">[123.659667,-33.890179]</span>,<span class="hljs-selector-attr">[122.811036,-33.914467]</span>,<span class="hljs-selector-attr">[122.183064,-34.003402]</span>,<span class="hljs-selector-attr">[121.299191,-33.821036]</span>,<span class="hljs-selector-attr">[120.580268,-33.930177]</span>,<span class="hljs-selector-attr">[119.893695,-33.976065]</span>,<span class="hljs-selector-attr">[119.298899,-34.509366]</span>,<span class="hljs-selector-attr">[119.007341,-34.464149]</span>,<span class="hljs-selector-attr">[118.505718,-34.746819]</span>,<span class="hljs-selector-attr">[118.024972,-35.064733]</span>,<span class="hljs-selector-attr">[117.295507,-35.025459]</span>,<span class="hljs-selector-attr">[116.625109,-35.025097]</span>,<span class="hljs-selector-attr">[115.564347,-34.386428]</span>,<span class="hljs-selector-attr">[115.026809,-34.196517]</span>,<span class="hljs-selector-attr">[115.048616,-33.623425]</span>,<span class="hljs-selector-attr">[115.545123,-33.487258]</span>,<span class="hljs-selector-attr">[115.714674,-33.259572]</span>,<span class="hljs-selector-attr">[115.679379,-32.900369]</span>,<span class="hljs-selector-attr">[115.801645,-32.205062]</span>,<span class="hljs-selector-attr">[115.689611,-31.612437]</span>,<span class="hljs-selector-attr">[115.160909,-30.601594]</span>,<span class="hljs-selector-attr">[114.997043,-30.030725]</span>,<span class="hljs-selector-attr">[115.040038,-29.461095]</span>,<span class="hljs-selector-attr">[114.641974,-28.810231]</span>,<span class="hljs-selector-attr">[114.616498,-28.516399]</span>,<span class="hljs-selector-attr">[114.173579,-28.118077]</span>,<span class="hljs-selector-attr">[114.048884,-27.334765]</span>,<span class="hljs-selector-attr">[113.477498,-26.543134]</span>,<span class="hljs-selector-attr">[113.338953,-26.116545]</span>,<span class="hljs-selector-attr">[113.778358,-26.549025]</span>,<span class="hljs-selector-attr">[113.440962,-25.621278]</span>,<span class="hljs-selector-attr">[113.936901,-25.911235]</span>,<span class="hljs-selector-attr">[114.232852,-26.298446]</span>,<span class="hljs-selector-attr">[114.216161,-25.786281]</span>,<span class="hljs-selector-attr">[113.721255,-24.998939]</span>,<span class="hljs-selector-attr">[113.625344,-24.683971]</span>,<span class="hljs-selector-attr">[113.393523,-24.384764]</span>,<span class="hljs-selector-attr">[113.502044,-23.80635]</span>,<span class="hljs-selector-attr">[113.706993,-23.560215]</span>,<span class="hljs-selector-attr">[113.843418,-23.059987]</span>,<span class="hljs-selector-attr">[113.736552,-22.475475]</span>,<span class="hljs-selector-attr">[114.149756,-21.755881]</span>,<span class="hljs-selector-attr">[114.225307,-22.517488]</span>,<span class="hljs-selector-attr">[114.647762,-21.82952]</span>,<span class="hljs-selector-attr">[115.460167,-21.495173]</span>,<span class="hljs-selector-attr">[115.947373,-21.068688]</span>,<span class="hljs-selector-attr">[116.711615,-20.701682]</span>,<span class="hljs-selector-attr">[117.166316,-20.623599]</span>,<span class="hljs-selector-attr">[117.441545,-20.746899]</span>,<span class="hljs-selector-attr">[118.229559,-20.374208]</span>,<span class="hljs-selector-attr">[118.836085,-20.263311]</span>,<span class="hljs-selector-attr">[118.987807,-20.044203]</span>,<span class="hljs-selector-attr">[119.252494,-19.952942]</span>,<span class="hljs-selector-attr">[119.805225,-19.976506]</span>,<span class="hljs-selector-attr">[120.85622,-19.683708]</span>,<span class="hljs-selector-attr">[121.399856,-19.239756]</span>,<span class="hljs-selector-attr">[121.655138,-18.705318]</span>,<span class="hljs-selector-attr">[122.241665,-18.197649]</span>,<span class="hljs-selector-attr">[122.286624,-17.798603]</span>,<span class="hljs-selector-attr">[122.312772,-17.254967]</span>,<span class="hljs-selector-attr">[123.012574,-16.4052]</span>,<span class="hljs-selector-attr">[123.433789,-17.268558]</span>,<span class="hljs-selector-attr">[123.859345,-17.069035]</span>,<span class="hljs-selector-attr">[123.503242,-16.596506]</span>,<span class="hljs-selector-attr">[123.817073,-16.111316]</span>,<span class="hljs-selector-attr">[124.258287,-16.327944]</span>,<span class="hljs-selector-attr">[124.379726,-15.56706]</span>,<span class="hljs-selector-attr">[124.926153,-15.0751]</span>,<span class="hljs-selector-attr">[125.167275,-14.680396]</span>,<span class="hljs-selector-attr">[125.670087,-14.51007]</span>,<span class="hljs-selector-attr">[125.685796,-14.230656]</span>,<span class="hljs-selector-attr">[126.125149,-14.347341]</span>,<span class="hljs-selector-attr">[126.142823,-14.095987]</span>,<span class="hljs-selector-attr">[126.582589,-13.952791]</span>,<span class="hljs-selector-attr">[127.065867,-13.817968]</span>,<span class="hljs-selector-attr">[127.804633,-14.276906]</span>,<span class="hljs-selector-attr">[128.35969,-14.86917]</span>,<span class="hljs-selector-attr">[128.985543,-14.875991]</span>,<span class="hljs-selector-attr">[129.621473,-14.969784]</span>,<span class="hljs-selector-attr">[129.4096,-14.42067]</span>,<span class="hljs-selector-attr">[129.888641,-13.618703]</span>,<span class="hljs-selector-attr">[130.339466,-13.357376]</span>,<span class="hljs-selector-attr">[130.183506,-13.10752]</span>,<span class="hljs-selector-attr">[130.617795,-12.536392]</span>,<span class="hljs-selector-attr">[131.223495,-12.183649]</span>,<span class="hljs-selector-attr">[131.735091,-12.302453]</span>,<span class="hljs-selector-attr">[132.575298,-12.114041]</span>,<span class="hljs-selector-attr">[132.557212,-11.603012]</span>,<span class="hljs-selector-attr">[131.824698,-11.273782]</span>,<span class="hljs-selector-attr">[132.357224,-11.128519]</span>,<span class="hljs-selector-attr">[133.019561,-11.376411]</span>,<span class="hljs-selector-attr">[133.550846,-11.786515]</span>,<span class="hljs-selector-attr">[134.393068,-12.042365]</span>,<span class="hljs-selector-attr">[134.678632,-11.941183]</span>,<span class="hljs-selector-attr">[135.298491,-12.248606]</span>,<span class="hljs-selector-attr">[135.882693,-11.962267]</span>,<span class="hljs-selector-attr">[136.258381,-12.049342]</span>,<span class="hljs-selector-attr">[136.492475,-11.857209]</span>,<span class="hljs-selector-attr">[136.95162,-12.351959]</span>,<span class="hljs-selector-attr">[136.685125,-12.887223]</span>,<span class="hljs-selector-attr">[136.305407,-13.29123]</span>,<span class="hljs-selector-attr">[135.961758,-13.324509]</span>,<span class="hljs-selector-attr">[136.077617,-13.724278]</span>,<span class="hljs-selector-attr">[135.783836,-14.223989]</span>,<span class="hljs-selector-attr">[135.428664,-14.715432]</span>,<span class="hljs-selector-attr">[135.500184,-14.997741]</span>,<span class="hljs-selector-attr">[136.295175,-15.550265]</span>,<span class="hljs-selector-attr">[137.06536,-15.870762]</span>,<span class="hljs-selector-attr">[137.580471,-16.215082]</span>,<span class="hljs-selector-attr">[138.303217,-16.807604]</span>,<span class="hljs-selector-attr">[138.585164,-16.806622]</span>,<span class="hljs-selector-attr">[139.108543,-17.062679]</span>,<span class="hljs-selector-attr">[139.260575,-17.371601]</span>,<span class="hljs-selector-attr">[140.215245,-17.710805]</span>,<span class="hljs-selector-attr">[140.875463,-17.369069]</span>,<span class="hljs-selector-attr">[141.07111,-16.832047]</span>,<span class="hljs-selector-attr">[141.274095,-16.38887]</span>,<span class="hljs-selector-attr">[141.398222,-15.840532]</span>,<span class="hljs-selector-attr">[141.702183,-15.044921]</span>,<span class="hljs-selector-attr">[141.56338,-14.561333]</span>,<span class="hljs-selector-attr">[141.63552,-14.270395]</span>,<span class="hljs-selector-attr">[141.519869,-13.698078]</span>,<span class="hljs-selector-attr">[141.65092,-12.944688]</span>,<span class="hljs-selector-attr">[141.842691,-12.741548]</span>,<span class="hljs-selector-attr">[141.68699,-12.407614]</span>,<span class="hljs-selector-attr">[141.928629,-11.877466]</span>,<span class="hljs-selector-attr">[142.118488,-11.328042]</span>,<span class="hljs-selector-attr">[142.143706,-11.042737]</span>,<span class="hljs-selector-attr">[142.51526,-10.668186]</span>,<span class="hljs-selector-attr">[142.79731,-11.157355]</span>,<span class="hljs-selector-attr">[142.866763,-11.784707]</span>,<span class="hljs-selector-attr">[143.115947,-11.90563]</span>,<span class="hljs-selector-attr">[143.158632,-12.325656]</span>,<span class="hljs-selector-attr">[143.522124,-12.834358]</span>,<span class="hljs-selector-attr">[143.597158,-13.400422]</span>,<span class="hljs-selector-attr">[143.561811,-13.763656]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">AUT</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Austria</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[16.979667,48.123497]</span>,<span class="hljs-selector-attr">[16.903754,47.714866]</span>,<span class="hljs-selector-attr">[16.340584,47.712902]</span>,<span class="hljs-selector-attr">[16.534268,47.496171]</span>,<span class="hljs-selector-attr">[16.202298,46.852386]</span>,<span class="hljs-selector-attr">[16.011664,46.683611]</span>,<span class="hljs-selector-attr">[15.137092,46.658703]</span>,<span class="hljs-selector-attr">[14.632472,46.431817]</span>,<span class="hljs-selector-attr">[13.806475,46.509306]</span>,<span class="hljs-selector-attr">[12.376485,46.767559]</span>,<span class="hljs-selector-attr">[12.153088,47.115393]</span>,<span class="hljs-selector-attr">[11.164828,46.941579]</span>,<span class="hljs-selector-attr">[11.048556,46.751359]</span>,<span class="hljs-selector-attr">[10.442701,46.893546]</span>,<span class="hljs-selector-attr">[9.932448,46.920728]</span>,<span class="hljs-selector-attr">[9.47997,47.10281]</span>,<span class="hljs-selector-attr">[9.632932,47.347601]</span>,<span class="hljs-selector-attr">[9.594226,47.525058]</span>,<span class="hljs-selector-attr">[9.896068,47.580197]</span>,<span class="hljs-selector-attr">[10.402084,47.302488]</span>,<span class="hljs-selector-attr">[10.544504,47.566399]</span>,<span class="hljs-selector-attr">[11.426414,47.523766]</span>,<span class="hljs-selector-attr">[12.141357,47.703083]</span>,<span class="hljs-selector-attr">[12.62076,47.672388]</span>,<span class="hljs-selector-attr">[12.932627,47.467646]</span>,<span class="hljs-selector-attr">[13.025851,47.637584]</span>,<span class="hljs-selector-attr">[12.884103,48.289146]</span>,<span class="hljs-selector-attr">[13.243357,48.416115]</span>,<span class="hljs-selector-attr">[13.595946,48.877172]</span>,<span class="hljs-selector-attr">[14.338898,48.555305]</span>,<span class="hljs-selector-attr">[14.901447,48.964402]</span>,<span class="hljs-selector-attr">[15.253416,49.039074]</span>,<span class="hljs-selector-attr">[16.029647,48.733899]</span>,<span class="hljs-selector-attr">[16.499283,48.785808]</span>,<span class="hljs-selector-attr">[16.960288,48.596982]</span>,<span class="hljs-selector-attr">[16.879983,48.470013]</span>,<span class="hljs-selector-attr">[16.979667,48.123497]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">AZE</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Azerbaijan</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[45.001987,39.740004]</span>,<span class="hljs-selector-attr">[45.298145,39.471751]</span>,<span class="hljs-selector-attr">[45.739978,39.473999]</span>,<span class="hljs-selector-attr">[45.735379,39.319719]</span>,<span class="hljs-selector-attr">[46.143623,38.741201]</span>,<span class="hljs-selector-attr">[45.457722,38.874139]</span>,<span class="hljs-selector-attr">[44.952688,39.335765]</span>,<span class="hljs-selector-attr">[44.79399,39.713003]</span>,<span class="hljs-selector-attr">[45.001987,39.740004]</span>]],<span class="hljs-selector-attr">[[[47.373315,41.219732]</span>,<span class="hljs-selector-attr">[47.815666,41.151416]</span>,<span class="hljs-selector-attr">[47.987283,41.405819]</span>,<span class="hljs-selector-attr">[48.584353,41.80887]</span>,<span class="hljs-selector-attr">[49.110264,41.282287]</span>,<span class="hljs-selector-attr">[49.618915,40.572924]</span>,<span class="hljs-selector-attr">[50.08483,40.526157]</span>,<span class="hljs-selector-attr">[50.392821,40.256561]</span>,<span class="hljs-selector-attr">[49.569202,40.176101]</span>,<span class="hljs-selector-attr">[49.395259,39.399482]</span>,<span class="hljs-selector-attr">[49.223228,39.049219]</span>,<span class="hljs-selector-attr">[48.856532,38.815486]</span>,<span class="hljs-selector-attr">[48.883249,38.320245]</span>,<span class="hljs-selector-attr">[48.634375,38.270378]</span>,<span class="hljs-selector-attr">[48.010744,38.794015]</span>,<span class="hljs-selector-attr">[48.355529,39.288765]</span>,<span class="hljs-selector-attr">[48.060095,39.582235]</span>,<span class="hljs-selector-attr">[47.685079,39.508364]</span>,<span class="hljs-selector-attr">[46.50572,38.770605]</span>,<span class="hljs-selector-attr">[46.483499,39.464155]</span>,<span class="hljs-selector-attr">[46.034534,39.628021]</span>,<span class="hljs-selector-attr">[45.610012,39.899994]</span>,<span class="hljs-selector-attr">[45.891907,40.218476]</span>,<span class="hljs-selector-attr">[45.359175,40.561504]</span>,<span class="hljs-selector-attr">[45.560351,40.81229]</span>,<span class="hljs-selector-attr">[45.179496,40.985354]</span>,<span class="hljs-selector-attr">[44.97248,41.248129]</span>,<span class="hljs-selector-attr">[45.217426,41.411452]</span>,<span class="hljs-selector-attr">[45.962601,41.123873]</span>,<span class="hljs-selector-attr">[46.501637,41.064445]</span>,<span class="hljs-selector-attr">[46.637908,41.181673]</span>,<span class="hljs-selector-attr">[46.145432,41.722802]</span>,<span class="hljs-selector-attr">[46.404951,41.860675]</span>,<span class="hljs-selector-attr">[46.686071,41.827137]</span>,<span class="hljs-selector-attr">[47.373315,41.219732]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BDI</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Burundi</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[29.339998,-4.499983]</span>,<span class="hljs-selector-attr">[29.276384,-3.293907]</span>,<span class="hljs-selector-attr">[29.024926,-2.839258]</span>,<span class="hljs-selector-attr">[29.632176,-2.917858]</span>,<span class="hljs-selector-attr">[29.938359,-2.348487]</span>,<span class="hljs-selector-attr">[30.469696,-2.413858]</span>,<span class="hljs-selector-attr">[30.527677,-2.807632]</span>,<span class="hljs-selector-attr">[30.743013,-3.034285]</span>,<span class="hljs-selector-attr">[30.752263,-3.35933]</span>,<span class="hljs-selector-attr">[30.50556,-3.568567]</span>,<span class="hljs-selector-attr">[30.116333,-4.090138]</span>,<span class="hljs-selector-attr">[29.753512,-4.452389]</span>,<span class="hljs-selector-attr">[29.339998,-4.499983]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BEL</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Belgium</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[3.314971,51.345781]</span>,<span class="hljs-selector-attr">[4.047071,51.267259]</span>,<span class="hljs-selector-attr">[4.973991,51.475024]</span>,<span class="hljs-selector-attr">[5.606976,51.037298]</span>,<span class="hljs-selector-attr">[6.156658,50.803721]</span>,<span class="hljs-selector-attr">[6.043073,50.128052]</span>,<span class="hljs-selector-attr">[5.782417,50.090328]</span>,<span class="hljs-selector-attr">[5.674052,49.529484]</span>,<span class="hljs-selector-attr">[4.799222,49.985373]</span>,<span class="hljs-selector-attr">[4.286023,49.907497]</span>,<span class="hljs-selector-attr">[3.588184,50.378992]</span>,<span class="hljs-selector-attr">[3.123252,50.780363]</span>,<span class="hljs-selector-attr">[2.658422,50.796848]</span>,<span class="hljs-selector-attr">[2.513573,51.148506]</span>,<span class="hljs-selector-attr">[3.314971,51.345781]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BEN</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Benin</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[2.691702,6.258817]</span>,<span class="hljs-selector-attr">[1.865241,6.142158]</span>,<span class="hljs-selector-attr">[1.618951,6.832038]</span>,<span class="hljs-selector-attr">[1.664478,9.12859]</span>,<span class="hljs-selector-attr">[1.463043,9.334624]</span>,<span class="hljs-selector-attr">[1.425061,9.825395]</span>,<span class="hljs-selector-attr">[1.077795,10.175607]</span>,<span class="hljs-selector-attr">[0.772336,10.470808]</span>,<span class="hljs-selector-attr">[0.899563,10.997339]</span>,<span class="hljs-selector-attr">[1.24347,11.110511]</span>,<span class="hljs-selector-attr">[1.447178,11.547719]</span>,<span class="hljs-selector-attr">[1.935986,11.64115]</span>,<span class="hljs-selector-attr">[2.154474,11.94015]</span>,<span class="hljs-selector-attr">[2.490164,12.233052]</span>,<span class="hljs-selector-attr">[2.848643,12.235636]</span>,<span class="hljs-selector-attr">[3.61118,11.660167]</span>,<span class="hljs-selector-attr">[3.572216,11.327939]</span>,<span class="hljs-selector-attr">[3.797112,10.734746]</span>,<span class="hljs-selector-attr">[3.60007,10.332186]</span>,<span class="hljs-selector-attr">[3.705438,10.06321]</span>,<span class="hljs-selector-attr">[3.220352,9.444153]</span>,<span class="hljs-selector-attr">[2.912308,9.137608]</span>,<span class="hljs-selector-attr">[2.723793,8.506845]</span>,<span class="hljs-selector-attr">[2.749063,7.870734]</span>,<span class="hljs-selector-attr">[2.691702,6.258817]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BFA</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Burkina</span>Â <span class="hljs-selector-tag">Faso</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[-2.827496,9.642461]</span>,<span class="hljs-selector-attr">[-3.511899,9.900326]</span>,<span class="hljs-selector-attr">[-3.980449,9.862344]</span>,<span class="hljs-selector-attr">[-4.330247,9.610835]</span>,<span class="hljs-selector-attr">[-4.779884,9.821985]</span>,<span class="hljs-selector-attr">[-4.954653,10.152714]</span>,<span class="hljs-selector-attr">[-5.404342,10.370737]</span>,<span class="hljs-selector-attr">[-5.470565,10.95127]</span>,<span class="hljs-selector-attr">[-5.197843,11.375146]</span>,<span class="hljs-selector-attr">[-5.220942,11.713859]</span>,<span class="hljs-selector-attr">[-4.427166,12.542646]</span>,<span class="hljs-selector-attr">[-4.280405,13.228444]</span>,<span class="hljs-selector-attr">[-4.006391,13.472485]</span>,<span class="hljs-selector-attr">[-3.522803,13.337662]</span>,<span class="hljs-selector-attr">[-3.103707,13.541267]</span>,<span class="hljs-selector-attr">[-2.967694,13.79815]</span>,<span class="hljs-selector-attr">[-2.191825,14.246418]</span>,<span class="hljs-selector-attr">[-2.001035,14.559008]</span>,<span class="hljs-selector-attr">[-1.066363,14.973815]</span>,<span class="hljs-selector-attr">[-0.515854,15.116158]</span>,<span class="hljs-selector-attr">[-0.266257,14.924309]</span>,<span class="hljs-selector-attr">[0.374892,14.928908]</span>,<span class="hljs-selector-attr">[0.295646,14.444235]</span>,<span class="hljs-selector-attr">[0.429928,13.988733]</span>,<span class="hljs-selector-attr">[0.993046,13.33575]</span>,<span class="hljs-selector-attr">[1.024103,12.851826]</span>,<span class="hljs-selector-attr">[2.177108,12.625018]</span>,<span class="hljs-selector-attr">[2.154474,11.94015]</span>,<span class="hljs-selector-attr">[1.935986,11.64115]</span>,<span class="hljs-selector-attr">[1.447178,11.547719]</span>,<span class="hljs-selector-attr">[1.24347,11.110511]</span>,<span class="hljs-selector-attr">[0.899563,10.997339]</span>,<span class="hljs-selector-attr">[0.023803,11.018682]</span>,<span class="hljs-selector-attr">[-0.438702,11.098341]</span>,<span class="hljs-selector-attr">[-0.761576,10.93693]</span>,<span class="hljs-selector-attr">[-1.203358,11.009819]</span>,<span class="hljs-selector-attr">[-2.940409,10.96269]</span>,<span class="hljs-selector-attr">[-2.963896,10.395335]</span>,<span class="hljs-selector-attr">[-2.827496,9.642461]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BGD</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bangladesh</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[92.672721,22.041239]</span>,<span class="hljs-selector-attr">[92.652257,21.324048]</span>,<span class="hljs-selector-attr">[92.303234,21.475485]</span>,<span class="hljs-selector-attr">[92.368554,20.670883]</span>,<span class="hljs-selector-attr">[92.082886,21.192195]</span>,<span class="hljs-selector-attr">[92.025215,21.70157]</span>,<span class="hljs-selector-attr">[91.834891,22.182936]</span>,<span class="hljs-selector-attr">[91.417087,22.765019]</span>,<span class="hljs-selector-attr">[90.496006,22.805017]</span>,<span class="hljs-selector-attr">[90.586957,22.392794]</span>,<span class="hljs-selector-attr">[90.272971,21.836368]</span>,<span class="hljs-selector-attr">[89.847467,22.039146]</span>,<span class="hljs-selector-attr">[89.70205,21.857116]</span>,<span class="hljs-selector-attr">[89.418863,21.966179]</span>,<span class="hljs-selector-attr">[89.031961,22.055708]</span>,<span class="hljs-selector-attr">[88.876312,22.879146]</span>,<span class="hljs-selector-attr">[88.52977,23.631142]</span>,<span class="hljs-selector-attr">[88.69994,24.233715]</span>,<span class="hljs-selector-attr">[88.084422,24.501657]</span>,<span class="hljs-selector-attr">[88.306373,24.866079]</span>,<span class="hljs-selector-attr">[88.931554,25.238692]</span>,<span class="hljs-selector-attr">[88.209789,25.768066]</span>,<span class="hljs-selector-attr">[88.563049,26.446526]</span>,<span class="hljs-selector-attr">[89.355094,26.014407]</span>,<span class="hljs-selector-attr">[89.832481,25.965082]</span>,<span class="hljs-selector-attr">[89.920693,25.26975]</span>,<span class="hljs-selector-attr">[90.872211,25.132601]</span>,<span class="hljs-selector-attr">[91.799596,25.147432]</span>,<span class="hljs-selector-attr">[92.376202,24.976693]</span>,<span class="hljs-selector-attr">[91.915093,24.130414]</span>,<span class="hljs-selector-attr">[91.46773,24.072639]</span>,<span class="hljs-selector-attr">[91.158963,23.503527]</span>,<span class="hljs-selector-attr">[91.706475,22.985264]</span>,<span class="hljs-selector-attr">[91.869928,23.624346]</span>,<span class="hljs-selector-attr">[92.146035,23.627499]</span>,<span class="hljs-selector-attr">[92.672721,22.041239]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BGR</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bulgaria</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[22.65715,44.234923]</span>,<span class="hljs-selector-attr">[22.944832,43.823785]</span>,<span class="hljs-selector-attr">[23.332302,43.897011]</span>,<span class="hljs-selector-attr">[24.100679,43.741051]</span>,<span class="hljs-selector-attr">[25.569272,43.688445]</span>,<span class="hljs-selector-attr">[26.065159,43.943494]</span>,<span class="hljs-selector-attr">[27.2424,44.175986]</span>,<span class="hljs-selector-attr">[27.970107,43.812468]</span>,<span class="hljs-selector-attr">[28.558081,43.707462]</span>,<span class="hljs-selector-attr">[28.039095,43.293172]</span>,<span class="hljs-selector-attr">[27.673898,42.577892]</span>,<span class="hljs-selector-attr">[27.99672,42.007359]</span>,<span class="hljs-selector-attr">[27.135739,42.141485]</span>,<span class="hljs-selector-attr">[26.117042,41.826905]</span>,<span class="hljs-selector-attr">[26.106138,41.328899]</span>,<span class="hljs-selector-attr">[25.197201,41.234486]</span>,<span class="hljs-selector-attr">[24.492645,41.583896]</span>,<span class="hljs-selector-attr">[23.692074,41.309081]</span>,<span class="hljs-selector-attr">[22.952377,41.337994]</span>,<span class="hljs-selector-attr">[22.881374,41.999297]</span>,<span class="hljs-selector-attr">[22.380526,42.32026]</span>,<span class="hljs-selector-attr">[22.545012,42.461362]</span>,<span class="hljs-selector-attr">[22.436595,42.580321]</span>,<span class="hljs-selector-attr">[22.604801,42.898519]</span>,<span class="hljs-selector-attr">[22.986019,43.211161]</span>,<span class="hljs-selector-attr">[22.500157,43.642814]</span>,<span class="hljs-selector-attr">[22.410446,44.008063]</span>,<span class="hljs-selector-attr">[22.65715,44.234923]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BHS</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">The</span>Â <span class="hljs-selector-tag">Bahamas</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[-77.53466,23.75975]</span>,<span class="hljs-selector-attr">[-77.78,23.71]</span>,<span class="hljs-selector-attr">[-78.03405,24.28615]</span>,<span class="hljs-selector-attr">[-78.40848,24.57564]</span>,<span class="hljs-selector-attr">[-78.19087,25.2103]</span>,<span class="hljs-selector-attr">[-77.89,25.17]</span>,<span class="hljs-selector-attr">[-77.54,24.34]</span>,<span class="hljs-selector-attr">[-77.53466,23.75975]</span>]],<span class="hljs-selector-attr">[[[-77.82,26.58]</span>,<span class="hljs-selector-attr">[-78.91,26.42]</span>,<span class="hljs-selector-attr">[-78.98,26.79]</span>,<span class="hljs-selector-attr">[-78.51,26.87]</span>,<span class="hljs-selector-attr">[-77.85,26.84]</span>,<span class="hljs-selector-attr">[-77.82,26.58]</span>]],<span class="hljs-selector-attr">[[[-77,26.59]</span>,<span class="hljs-selector-attr">[-77.17255,25.87918]</span>,<span class="hljs-selector-attr">[-77.35641,26.00735]</span>,<span class="hljs-selector-attr">[-77.34,26.53]</span>,<span class="hljs-selector-attr">[-77.78802,26.92516]</span>,<span class="hljs-selector-attr">[-77.79,27.04]</span>,<span class="hljs-selector-attr">[-77,26.59]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BIH</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bosnia</span>Â <span class="hljs-selector-tag">and</span>Â <span class="hljs-selector-tag">Herzegovina</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[19.005486,44.860234]</span>,<span class="hljs-selector-attr">[19.36803,44.863]</span>,<span class="hljs-selector-attr">[19.11761,44.42307]</span>,<span class="hljs-selector-attr">[19.59976,44.03847]</span>,<span class="hljs-selector-attr">[19.454,43.5681]</span>,<span class="hljs-selector-attr">[19.21852,43.52384]</span>,<span class="hljs-selector-attr">[19.03165,43.43253]</span>,<span class="hljs-selector-attr">[18.70648,43.20011]</span>,<span class="hljs-selector-attr">[18.56,42.65]</span>,<span class="hljs-selector-attr">[17.674922,43.028563]</span>,<span class="hljs-selector-attr">[17.297373,43.446341]</span>,<span class="hljs-selector-attr">[16.916156,43.667722]</span>,<span class="hljs-selector-attr">[16.456443,44.04124]</span>,<span class="hljs-selector-attr">[16.23966,44.351143]</span>,<span class="hljs-selector-attr">[15.750026,44.818712]</span>,<span class="hljs-selector-attr">[15.959367,45.233777]</span>,<span class="hljs-selector-attr">[16.318157,45.004127]</span>,<span class="hljs-selector-attr">[16.534939,45.211608]</span>,<span class="hljs-selector-attr">[17.002146,45.233777]</span>,<span class="hljs-selector-attr">[17.861783,45.06774]</span>,<span class="hljs-selector-attr">[18.553214,45.08159]</span>,<span class="hljs-selector-attr">[19.005486,44.860234]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BLR</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Belarus</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[23.484128,53.912498]</span>,<span class="hljs-selector-attr">[24.450684,53.905702]</span>,<span class="hljs-selector-attr">[25.536354,54.282423]</span>,<span class="hljs-selector-attr">[25.768433,54.846963]</span>,<span class="hljs-selector-attr">[26.588279,55.167176]</span>,<span class="hljs-selector-attr">[26.494331,55.615107]</span>,<span class="hljs-selector-attr">[27.10246,55.783314]</span>,<span class="hljs-selector-attr">[28.176709,56.16913]</span>,<span class="hljs-selector-attr">[29.229513,55.918344]</span>,<span class="hljs-selector-attr">[29.371572,55.670091]</span>,<span class="hljs-selector-attr">[29.896294,55.789463]</span>,<span class="hljs-selector-attr">[30.873909,55.550976]</span>,<span class="hljs-selector-attr">[30.971836,55.081548]</span>,<span class="hljs-selector-attr">[30.757534,54.811771]</span>,<span class="hljs-selector-attr">[31.384472,54.157056]</span>,<span class="hljs-selector-attr">[31.791424,53.974639]</span>,<span class="hljs-selector-attr">[31.731273,53.794029]</span>,<span class="hljs-selector-attr">[32.405599,53.618045]</span>,<span class="hljs-selector-attr">[32.693643,53.351421]</span>,<span class="hljs-selector-attr">[32.304519,53.132726]</span>,<span class="hljs-selector-attr">[31.497644,53.167427]</span>,<span class="hljs-selector-attr">[31.305201,53.073996]</span>,<span class="hljs-selector-attr">[31.540018,52.742052]</span>,<span class="hljs-selector-attr">[31.785998,52.101678]</span>,<span class="hljs-selector-attr">[30.927549,52.042353]</span>,<span class="hljs-selector-attr">[30.619454,51.822806]</span>,<span class="hljs-selector-attr">[30.555117,51.319503]</span>,<span class="hljs-selector-attr">[30.157364,51.416138]</span>,<span class="hljs-selector-attr">[29.254938,51.368234]</span>,<span class="hljs-selector-attr">[28.992835,51.602044]</span>,<span class="hljs-selector-attr">[28.617613,51.427714]</span>,<span class="hljs-selector-attr">[28.241615,51.572227]</span>,<span class="hljs-selector-attr">[27.454066,51.592303]</span>,<span class="hljs-selector-attr">[26.337959,51.832289]</span>,<span class="hljs-selector-attr">[25.327788,51.910656]</span>,<span class="hljs-selector-attr">[24.553106,51.888461]</span>,<span class="hljs-selector-attr">[24.005078,51.617444]</span>,<span class="hljs-selector-attr">[23.527071,51.578454]</span>,<span class="hljs-selector-attr">[23.508002,52.023647]</span>,<span class="hljs-selector-attr">[23.199494,52.486977]</span>,<span class="hljs-selector-attr">[23.799199,52.691099]</span>,<span class="hljs-selector-attr">[23.804935,53.089731]</span>,<span class="hljs-selector-attr">[23.527536,53.470122]</span>,<span class="hljs-selector-attr">[23.484128,53.912498]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BLZ</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Belize</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[-89.14308,17.808319]</span>,<span class="hljs-selector-attr">[-89.150909,17.955468]</span>,<span class="hljs-selector-attr">[-89.029857,18.001511]</span>,<span class="hljs-selector-attr">[-88.848344,17.883198]</span>,<span class="hljs-selector-attr">[-88.490123,18.486831]</span>,<span class="hljs-selector-attr">[-88.300031,18.499982]</span>,<span class="hljs-selector-attr">[-88.296336,18.353273]</span>,<span class="hljs-selector-attr">[-88.106813,18.348674]</span>,<span class="hljs-selector-attr">[-88.123479,18.076675]</span>,<span class="hljs-selector-attr">[-88.285355,17.644143]</span>,<span class="hljs-selector-attr">[-88.197867,17.489475]</span>,<span class="hljs-selector-attr">[-88.302641,17.131694]</span>,<span class="hljs-selector-attr">[-88.239518,17.036066]</span>,<span class="hljs-selector-attr">[-88.355428,16.530774]</span>,<span class="hljs-selector-attr">[-88.551825,16.265467]</span>,<span class="hljs-selector-attr">[-88.732434,16.233635]</span>,<span class="hljs-selector-attr">[-88.930613,15.887273]</span>,<span class="hljs-selector-attr">[-89.229122,15.886938]</span>,<span class="hljs-selector-attr">[-89.150806,17.015577]</span>,<span class="hljs-selector-attr">[-89.14308,17.808319]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BMU</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bermuda</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[-64.7799734332998,32.3072000581802]</span>,<span class="hljs-selector-attr">[-64.7873319183061,32.3039237143428]</span>,<span class="hljs-selector-attr">[-64.7946942710173,32.3032682700388]</span>,<span class="hljs-selector-attr">[-64.8094297981283,32.3098175728414]</span>,<span class="hljs-selector-attr">[-64.8167896352437,32.3058845718466]</span>,<span class="hljs-selector-attr">[-64.8101968029642,32.3022833180511]</span>,<span class="hljs-selector-attr">[-64.7962291465484,32.2934409732427]</span>,<span class="hljs-selector-attr">[-64.7815086336978,32.2868973114514]</span>,<span class="hljs-selector-attr">[-64.7997025513437,32.2796896417328]</span>,<span class="hljs-selector-attr">[-64.8066707691087,32.2747767569465]</span>,<span class="hljs-selector-attr">[-64.8225587873683,32.2669111289395]</span>,<span class="hljs-selector-attr">[-64.8287548840306,32.2669075473817]</span>,<span class="hljs-selector-attr">[-64.8306732143498,32.2583944840235]</span>,<span class="hljs-selector-attr">[-64.8399924854972,32.254782282336]</span>,<span class="hljs-selector-attr">[-64.8566090462354,32.2547740387514]</span>,<span class="hljs-selector-attr">[-64.8682296789446,32.2616393614322]</span>,<span class="hljs-selector-attr">[-64.8628241459563,32.2724481933959]</span>,<span class="hljs-selector-attr">[-64.8748651338951,32.2757120264753]</span>,<span class="hljs-selector-attr">[-64.8717752856644,32.2819371582026]</span>,<span class="hljs-selector-attr">[-64.8671422127295,32.2930760547989]</span>,<span class="hljs-selector-attr">[-64.8559068764437,32.2960321186471]</span>,<span class="hljs-selector-attr">[-64.8597429072279,32.3015842021933]</span>,<span class="hljs-selector-attr">[-64.8439233486717,32.3140553852543]</span>,<span class="hljs-selector-attr">[-64.8350242329311,32.3242161760006]</span>,<span class="hljs-selector-attr">[-64.8338690593672,32.3294587561557]</span>,<span class="hljs-selector-attr">[-64.8520298651164,32.3110911879954]</span>,<span class="hljs-selector-attr">[-64.8635922932573,32.3048469433363]</span>,<span class="hljs-selector-attr">[-64.8686668994079,32.30910745083]</span>,<span class="hljs-selector-attr">[-64.8721354593415,32.3041908606301]</span>,<span class="hljs-selector-attr">[-64.8779667328485,32.3038632800462]</span>,<span class="hljs-selector-attr">[-64.8780046844321,32.2907757831692]</span>,<span class="hljs-selector-attr">[-64.8849776658292,32.2819261366004]</span>,<span class="hljs-selector-attr">[-64.8783230004629,32.2613001418681]</span>,<span class="hljs-selector-attr">[-64.863194968877,32.2465799485801]</span>,<span class="hljs-selector-attr">[-64.8519819555722,32.2485519134663]</span>,<span class="hljs-selector-attr">[-64.842311980074,32.2492123317296]</span>,<span class="hljs-selector-attr">[-64.8388242605209,32.2475773472534]</span>,<span class="hljs-selector-attr">[-64.8334002575532,32.2462714714698]</span>,<span class="hljs-selector-attr">[-64.8256389530584,32.2472637398594]</span>,<span class="hljs-selector-attr">[-64.8205697556026,32.2531698880328]</span>,<span class="hljs-selector-attr">[-64.8105087275579,32.2561208974156]</span>,<span class="hljs-selector-attr">[-64.7900177727338,32.2659446936992]</span>,<span class="hljs-selector-attr">[-64.7745415970416,32.2718413023427]</span>,<span class="hljs-selector-attr">[-64.7644742436426,32.2855931353214]</span>,<span class="hljs-selector-attr">[-64.7551803442276,32.2908326702531]</span>,<span class="hljs-selector-attr">[-64.7423982971436,32.2996734994024]</span>,<span class="hljs-selector-attr">[-64.7206991797682,32.3137542201258]</span>,<span class="hljs-selector-attr">[-64.7117851247134,32.3176823360806]</span>,<span class="hljs-selector-attr">[-64.6962778813133,32.3275029115532]</span>,<span class="hljs-selector-attr">[-64.6768921127452,32.3324095397555]</span>,<span class="hljs-selector-attr">[-64.6567136927777,32.3451776458469]</span>,<span class="hljs-selector-attr">[-64.6532168823499,32.3494356627941]</span>,<span class="hljs-selector-attr">[-64.6605720384429,32.3589423487763]</span>,<span class="hljs-selector-attr">[-64.65125819471,32.3615600906466]</span>,<span class="hljs-selector-attr">[-64.6462011670816,32.36975169749]</span>,<span class="hljs-selector-attr">[-64.6613227512832,32.3763135008721]</span>,<span class="hljs-selector-attr">[-64.6690666074397,32.388444543924]</span>,<span class="hljs-selector-attr">[-64.6834270548595,32.3854968316788]</span>,<span class="hljs-selector-attr">[-64.6954617672714,32.3763221285869]</span>,<span class="hljs-selector-attr">[-64.70438689565,32.3704254760469]</span>,<span class="hljs-selector-attr">[-64.7117569982798,32.368132600249]</span>,<span class="hljs-selector-attr">[-64.7061764744404,32.3600110593559]</span>,<span class="hljs-selector-attr">[-64.700531552697,32.3590601356818]</span>,<span class="hljs-selector-attr">[-64.6940348033967,32.3640708659835]</span>,<span class="hljs-selector-attr">[-64.6895164826082,32.3633598579866]</span>,<span class="hljs-selector-attr">[-64.6864150099255,32.3547797587266]</span>,<span class="hljs-selector-attr">[-64.6824635995504,32.3540628176846]</span>,<span class="hljs-selector-attr">[-64.6835876652835,32.3626447677968]</span>,<span class="hljs-selector-attr">[-64.6801998697415,32.3631199096979]</span>,<span class="hljs-selector-attr">[-64.6672170444687,32.3597751617473]</span>,<span class="hljs-selector-attr">[-64.6598811264978,32.3497625771755]</span>,<span class="hljs-selector-attr">[-64.6737331235384,32.3390281851635]</span>,<span class="hljs-selector-attr">[-64.6887090648183,32.3342439408053]</span>,<span class="hljs-selector-attr">[-64.706732854446,32.3429010723036]</span>,<span class="hljs-selector-attr">[-64.7149301576112,32.3552188753513]</span>,<span class="hljs-selector-attr">[-64.7185967666669,32.3552239212394]</span>,<span class="hljs-selector-attr">[-64.7214189847314,32.3518830231342]</span>,<span class="hljs-selector-attr">[-64.7270616067222,32.3466461715475]</span>,<span class="hljs-selector-attr">[-64.734962460882,32.3442819830499]</span>,<span class="hljs-selector-attr">[-64.7383521549094,32.3407216514918]</span>,<span class="hljs-selector-attr">[-64.7411729976333,32.3311790864627]</span>,<span class="hljs-selector-attr">[-64.7423019216485,32.323311561213]</span>,<span class="hljs-selector-attr">[-64.7462482354281,32.318538611581]</span>,<span class="hljs-selector-attr">[-64.7566773739613,32.3130509130175]</span>,<span class="hljs-selector-attr">[-64.768738200563,32.3088369816572]</span>,<span class="hljs-selector-attr">[-64.7799734332998,32.3072000581802]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BOL</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bolivia</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[-62.846468,-22.034985]</span>,<span class="hljs-selector-attr">[-63.986838,-21.993644]</span>,<span class="hljs-selector-attr">[-64.377021,-22.798091]</span>,<span class="hljs-selector-attr">[-64.964892,-22.075862]</span>,<span class="hljs-selector-attr">[-66.273339,-21.83231]</span>,<span class="hljs-selector-attr">[-67.106674,-22.735925]</span>,<span class="hljs-selector-attr">[-67.82818,-22.872919]</span>,<span class="hljs-selector-attr">[-68.219913,-21.494347]</span>,<span class="hljs-selector-attr">[-68.757167,-20.372658]</span>,<span class="hljs-selector-attr">[-68.442225,-19.405068]</span>,<span class="hljs-selector-attr">[-68.966818,-18.981683]</span>,<span class="hljs-selector-attr">[-69.100247,-18.260125]</span>,<span class="hljs-selector-attr">[-69.590424,-17.580012]</span>,<span class="hljs-selector-attr">[-68.959635,-16.500698]</span>,<span class="hljs-selector-attr">[-69.389764,-15.660129]</span>,<span class="hljs-selector-attr">[-69.160347,-15.323974]</span>,<span class="hljs-selector-attr">[-69.339535,-14.953195]</span>,<span class="hljs-selector-attr">[-68.948887,-14.453639]</span>,<span class="hljs-selector-attr">[-68.929224,-13.602684]</span>,<span class="hljs-selector-attr">[-68.88008,-12.899729]</span>,<span class="hljs-selector-attr">[-68.66508,-12.5613]</span>,<span class="hljs-selector-attr">[-69.529678,-10.951734]</span>,<span class="hljs-selector-attr">[-68.786158,-11.03638]</span>,<span class="hljs-selector-attr">[-68.271254,-11.014521]</span>,<span class="hljs-selector-attr">[-68.048192,-10.712059]</span>,<span class="hljs-selector-attr">[-67.173801,-10.306812]</span>,<span class="hljs-selector-attr">[-66.646908,-9.931331]</span>,<span class="hljs-selector-attr">[-65.338435,-9.761988]</span>,<span class="hljs-selector-attr">[-65.444837,-10.511451]</span>,<span class="hljs-selector-attr">[-65.321899,-10.895872]</span>,<span class="hljs-selector-attr">[-65.402281,-11.56627]</span>,<span class="hljs-selector-attr">[-64.316353,-12.461978]</span>,<span class="hljs-selector-attr">[-63.196499,-12.627033]</span>,<span class="hljs-selector-attr">[-62.80306,-13.000653]</span>,<span class="hljs-selector-attr">[-62.127081,-13.198781]</span>,<span class="hljs-selector-attr">[-61.713204,-13.489202]</span>,<span class="hljs-selector-attr">[-61.084121,-13.479384]</span>,<span class="hljs-selector-attr">[-60.503304,-13.775955]</span>,<span class="hljs-selector-attr">[-60.459198,-14.354007]</span>,<span class="hljs-selector-attr">[-60.264326,-14.645979]</span>,<span class="hljs-selector-attr">[-60.251149,-15.077219]</span>,<span class="hljs-selector-attr">[-60.542966,-15.09391]</span>,<span class="hljs-selector-attr">[-60.15839,-16.258284]</span>,<span class="hljs-selector-attr">[-58.24122,-16.299573]</span>,<span class="hljs-selector-attr">[-58.388058,-16.877109]</span>,<span class="hljs-selector-attr">[-58.280804,-17.27171]</span>,<span class="hljs-selector-attr">[-57.734558,-17.552468]</span>,<span class="hljs-selector-attr">[-57.498371,-18.174188]</span>,<span class="hljs-selector-attr">[-57.676009,-18.96184]</span>,<span class="hljs-selector-attr">[-57.949997,-19.400004]</span>,<span class="hljs-selector-attr">[-57.853802,-19.969995]</span>,<span class="hljs-selector-attr">[-58.166392,-20.176701]</span>,<span class="hljs-selector-attr">[-58.183471,-19.868399]</span>,<span class="hljs-selector-attr">[-59.115042,-19.356906]</span>,<span class="hljs-selector-attr">[-60.043565,-19.342747]</span>,<span class="hljs-selector-attr">[-61.786326,-19.633737]</span>,<span class="hljs-selector-attr">[-62.265961,-20.513735]</span>,<span class="hljs-selector-attr">[-62.291179,-21.051635]</span>,<span class="hljs-selector-attr">[-62.685057,-22.249029]</span>,<span class="hljs-selector-attr">[-62.846468,-22.034985]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BRA</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Brazil</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[-57.625133,-30.216295]</span>,<span class="hljs-selector-attr">[-56.2909,-28.852761]</span>,<span class="hljs-selector-attr">[-55.162286,-27.881915]</span>,<span class="hljs-selector-attr">[-54.490725,-27.474757]</span>,<span class="hljs-selector-attr">[-53.648735,-26.923473]</span>,<span class="hljs-selector-attr">[-53.628349,-26.124865]</span>,<span class="hljs-selector-attr">[-54.13005,-25.547639]</span>,<span class="hljs-selector-attr">[-54.625291,-25.739255]</span>,<span class="hljs-selector-attr">[-54.428946,-25.162185]</span>,<span class="hljs-selector-attr">[-54.293476,-24.5708]</span>,<span class="hljs-selector-attr">[-54.29296,-24.021014]</span>,<span class="hljs-selector-attr">[-54.652834,-23.839578]</span>,<span class="hljs-selector-attr">[-55.027902,-24.001274]</span>,<span class="hljs-selector-attr">[-55.400747,-23.956935]</span>,<span class="hljs-selector-attr">[-55.517639,-23.571998]</span>,<span class="hljs-selector-attr">[-55.610683,-22.655619]</span>,<span class="hljs-selector-attr">[-55.797958,-22.35693]</span>,<span class="hljs-selector-attr">[-56.473317,-22.0863]</span>,<span class="hljs-selector-attr">[-56.88151,-22.282154]</span>,<span class="hljs-selector-attr">[-57.937156,-22.090176]</span>,<span class="hljs-selector-attr">[-57.870674,-20.732688]</span>,<span class="hljs-selector-attr">[-58.166392,-20.176701]</span>,<span class="hljs-selector-attr">[-57.853802,-19.969995]</span>,<span class="hljs-selector-attr">[-57.949997,-19.400004]</span>,<span class="hljs-selector-attr">[-57.676009,-18.96184]</span>,<span class="hljs-selector-attr">[-57.498371,-18.174188]</span>,<span class="hljs-selector-attr">[-57.734558,-17.552468]</span>,<span class="hljs-selector-attr">[-58.280804,-17.27171]</span>,<span class="hljs-selector-attr">[-58.388058,-16.877109]</span>,<span class="hljs-selector-attr">[-58.24122,-16.299573]</span>,<span class="hljs-selector-attr">[-60.15839,-16.258284]</span>,<span class="hljs-selector-attr">[-60.542966,-15.09391]</span>,<span class="hljs-selector-attr">[-60.251149,-15.077219]</span>,<span class="hljs-selector-attr">[-60.264326,-14.645979]</span>,<span class="hljs-selector-attr">[-60.459198,-14.354007]</span>,<span class="hljs-selector-attr">[-60.503304,-13.775955]</span>,<span class="hljs-selector-attr">[-61.084121,-13.479384]</span>,<span class="hljs-selector-attr">[-61.713204,-13.489202]</span>,<span class="hljs-selector-attr">[-62.127081,-13.198781]</span>,<span class="hljs-selector-attr">[-62.80306,-13.000653]</span>,<span class="hljs-selector-attr">[-63.196499,-12.627033]</span>,<span class="hljs-selector-attr">[-64.316353,-12.461978]</span>,<span class="hljs-selector-attr">[-65.402281,-11.56627]</span>,<span class="hljs-selector-attr">[-65.321899,-10.895872]</span>,<span class="hljs-selector-attr">[-65.444837,-10.511451]</span>,<span class="hljs-selector-attr">[-65.338435,-9.761988]</span>,<span class="hljs-selector-attr">[-66.646908,-9.931331]</span>,<span class="hljs-selector-attr">[-67.173801,-10.306812]</span>,<span class="hljs-selector-attr">[-68.048192,-10.712059]</span>,<span class="hljs-selector-attr">[-68.271254,-11.014521]</span>,<span class="hljs-selector-attr">[-68.786158,-11.03638]</span>,<span class="hljs-selector-attr">[-69.529678,-10.951734]</span>,<span class="hljs-selector-attr">[-70.093752,-11.123972]</span>,<span class="hljs-selector-attr">[-70.548686,-11.009147]</span>,<span class="hljs-selector-attr">[-70.481894,-9.490118]</span>,<span class="hljs-selector-attr">[-71.302412,-10.079436]</span>,<span class="hljs-selector-attr">[-72.184891,-10.053598]</span>,<span class="hljs-selector-attr">[-72.563033,-9.520194]</span>,<span class="hljs-selector-attr">[-73.226713,-9.462213]</span>,<span class="hljs-selector-attr">[-73.015383,-9.032833]</span>,<span class="hljs-selector-attr">[-73.571059,-8.424447]</span>,<span class="hljs-selector-attr">[-73.987235,-7.52383]</span>,<span class="hljs-selector-attr">[-73.723401,-7.340999]</span>,<span class="hljs-selector-attr">[-73.724487,-6.918595]</span>,<span class="hljs-selector-attr">[-73.120027,-6.629931]</span>,<span class="hljs-selector-attr">[-73.219711,-6.089189]</span>,<span class="hljs-selector-attr">[-72.964507,-5.741251]</span>,<span class="hljs-selector-attr">[-72.891928,-5.274561]</span>,<span class="hljs-selector-attr">[-71.748406,-4.593983]</span>,<span class="hljs-selector-attr">[-70.928843,-4.401591]</span>,<span class="hljs-selector-attr">[-70.794769,-4.251265]</span>,<span class="hljs-selector-attr">[-69.893635,-4.298187]</span>,<span class="hljs-selector-attr">[-69.444102,-1.556287]</span>,<span class="hljs-selector-attr">[-69.420486,-1.122619]</span>,<span class="hljs-selector-attr">[-69.577065,-0.549992]</span>,<span class="hljs-selector-attr">[-70.020656,-0.185156]</span>,<span class="hljs-selector-attr">[-70.015566,0.541414]</span>,<span class="hljs-selector-attr">[-69.452396,0.706159]</span>,<span class="hljs-selector-attr">[-69.252434,0.602651]</span>,<span class="hljs-selector-attr">[-69.218638,0.985677]</span>,<span class="hljs-selector-attr">[-69.804597,1.089081]</span>,<span class="hljs-selector-attr">[-69.816973,1.714805]</span>,<span class="hljs-selector-attr">[-67.868565,1.692455]</span>,<span class="hljs-selector-attr">[-67.53781,2.037163]</span>,<span class="hljs-selector-attr">[-67.259998,1.719999]</span>,<span class="hljs-selector-attr">[-67.065048,1.130112]</span>,<span class="hljs-selector-attr">[-66.876326,1.253361]</span>,<span class="hljs-selector-attr">[-66.325765,0.724452]</span>,<span class="hljs-selector-attr">[-65.548267,0.789254]</span>,<span class="hljs-selector-attr">[-65.354713,1.095282]</span>,<span class="hljs-selector-attr">[-64.611012,1.328731]</span>,<span class="hljs-selector-attr">[-64.199306,1.492855]</span>,<span class="hljs-selector-attr">[-64.083085,1.916369]</span>,<span class="hljs-selector-attr">[-63.368788,2.2009]</span>,<span class="hljs-selector-attr">[-63.422867,2.411068]</span>,<span class="hljs-selector-attr">[-64.269999,2.497006]</span>,<span class="hljs-selector-attr">[-64.408828,3.126786]</span>,<span class="hljs-selector-attr">[-64.368494,3.79721]</span>,<span class="hljs-selector-attr">[-64.816064,4.056445]</span>,<span class="hljs-selector-attr">[-64.628659,4.148481]</span>,<span class="hljs-selector-attr">[-63.888343,4.02053]</span>,<span class="hljs-selector-attr">[-63.093198,3.770571]</span>,<span class="hljs-selector-attr">[-62.804533,4.006965]</span>,<span class="hljs-selector-attr">[-62.08543,4.162124]</span>,<span class="hljs-selector-attr">[-60.966893,4.536468]</span>,<span class="hljs-selector-attr">[-60.601179,4.918098]</span>,<span class="hljs-selector-attr">[-60.733574,5.200277]</span>,<span class="hljs-selector-attr">[-60.213683,5.244486]</span>,<span class="hljs-selector-attr">[-59.980959,5.014061]</span>,<span class="hljs-selector-attr">[-60.111002,4.574967]</span>,<span class="hljs-selector-attr">[-59.767406,4.423503]</span>,<span class="hljs-selector-attr">[-59.53804,3.958803]</span>,<span class="hljs-selector-attr">[-59.815413,3.606499]</span>,<span class="hljs-selector-attr">[-59.974525,2.755233]</span>,<span class="hljs-selector-attr">[-59.718546,2.24963]</span>,<span class="hljs-selector-attr">[-59.646044,1.786894]</span>,<span class="hljs-selector-attr">[-59.030862,1.317698]</span>,<span class="hljs-selector-attr">[-58.540013,1.268088]</span>,<span class="hljs-selector-attr">[-58.429477,1.463942]</span>,<span class="hljs-selector-attr">[-58.11345,1.507195]</span>,<span class="hljs-selector-attr">[-57.660971,1.682585]</span>,<span class="hljs-selector-attr">[-57.335823,1.948538]</span>,<span class="hljs-selector-attr">[-56.782704,1.863711]</span>,<span class="hljs-selector-attr">[-56.539386,1.899523]</span>,<span class="hljs-selector-attr">[-55.995698,1.817667]</span>,<span class="hljs-selector-attr">[-55.9056,2.021996]</span>,<span class="hljs-selector-attr">[-56.073342,2.220795]</span>,<span class="hljs-selector-attr">[-55.973322,2.510364]</span>,<span class="hljs-selector-attr">[-55.569755,2.421506]</span>,<span class="hljs-selector-attr">[-55.097587,2.523748]</span>,<span class="hljs-selector-attr">[-54.524754,2.311849]</span>,<span class="hljs-selector-attr">[-54.088063,2.105557]</span>,<span class="hljs-selector-attr">[-53.778521,2.376703]</span>,<span class="hljs-selector-attr">[-53.554839,2.334897]</span>,<span class="hljs-selector-attr">[-53.418465,2.053389]</span>,<span class="hljs-selector-attr">[-52.939657,2.124858]</span>,<span class="hljs-selector-attr">[-52.556425,2.504705]</span>,<span class="hljs-selector-attr">[-52.249338,3.241094]</span>,<span class="hljs-selector-attr">[-51.657797,4.156232]</span>,<span class="hljs-selector-attr">[-51.317146,4.203491]</span>,<span class="hljs-selector-attr">[-51.069771,3.650398]</span>,<span class="hljs-selector-attr">[-50.508875,1.901564]</span>,<span class="hljs-selector-attr">[-49.974076,1.736483]</span>,<span class="hljs-selector-attr">[-49.947101,1.04619]</span>,<span class="hljs-selector-attr">[-50.699251,0.222984]</span>,<span class="hljs-selector-attr">[-50.388211,-0.078445]</span>,<span class="hljs-selector-attr">[-48.620567,-0.235489]</span>,<span class="hljs-selector-attr">[-48.584497,-1.237805]</span>,<span class="hljs-selector-attr">[-47.824956,-0.581618]</span>,<span class="hljs-selector-attr">[-46.566584,-0.941028]</span>,<span class="hljs-selector-attr">[-44.905703,-1.55174]</span>,<span class="hljs-selector-attr">[-44.417619,-2.13775]</span>,<span class="hljs-selector-attr">[-44.581589,-2.691308]</span>,<span class="hljs-selector-attr">[-43.418791,-2.38311]</span>,<span class="hljs-selector-attr">[-41.472657,-2.912018]</span>,<span class="hljs-selector-attr">[-39.978665,-2.873054]</span>,<span class="hljs-selector-attr">[-38.500383,-3.700652]</span>,<span class="hljs-selector-attr">[-37.223252,-4.820946]</span>,<span class="hljs-selector-attr">[-36.452937,-5.109404]</span>,<span class="hljs-selector-attr">[-35.597796,-5.149504]</span>,<span class="hljs-selector-attr">[-35.235389,-5.464937]</span>,<span class="hljs-selector-attr">[-34.89603,-6.738193]</span>,<span class="hljs-selector-attr">[-34.729993,-7.343221]</span>,<span class="hljs-selector-attr">[-35.128212,-8.996401]</span>,<span class="hljs-selector-attr">[-35.636967,-9.649282]</span>,<span class="hljs-selector-attr">[-37.046519,-11.040721]</span>,<span class="hljs-selector-attr">[-37.683612,-12.171195]</span>,<span class="hljs-selector-attr">[-38.423877,-13.038119]</span>,<span class="hljs-selector-attr">[-38.673887,-13.057652]</span>,<span class="hljs-selector-attr">[-38.953276,-13.79337]</span>,<span class="hljs-selector-attr">[-38.882298,-15.667054]</span>,<span class="hljs-selector-attr">[-39.161092,-17.208407]</span>,<span class="hljs-selector-attr">[-39.267339,-17.867746]</span>,<span class="hljs-selector-attr">[-39.583521,-18.262296]</span>,<span class="hljs-selector-attr">[-39.760823,-19.599113]</span>,<span class="hljs-selector-attr">[-40.774741,-20.904512]</span>,<span class="hljs-selector-attr">[-40.944756,-21.937317]</span>,<span class="hljs-selector-attr">[-41.754164,-22.370676]</span>,<span class="hljs-selector-attr">[-41.988284,-22.97007]</span>,<span class="hljs-selector-attr">[-43.074704,-22.967693]</span>,<span class="hljs-selector-attr">[-44.647812,-23.351959]</span>,<span class="hljs-selector-attr">[-45.352136,-23.796842]</span>,<span class="hljs-selector-attr">[-46.472093,-24.088969]</span>,<span class="hljs-selector-attr">[-47.648972,-24.885199]</span>,<span class="hljs-selector-attr">[-48.495458,-25.877025]</span>,<span class="hljs-selector-attr">[-48.641005,-26.623698]</span>,<span class="hljs-selector-attr">[-48.474736,-27.175912]</span>,<span class="hljs-selector-attr">[-48.66152,-28.186135]</span>,<span class="hljs-selector-attr">[-48.888457,-28.674115]</span>,<span class="hljs-selector-attr">[-49.587329,-29.224469]</span>,<span class="hljs-selector-attr">[-50.696874,-30.984465]</span>,<span class="hljs-selector-attr">[-51.576226,-31.777698]</span>,<span class="hljs-selector-attr">[-52.256081,-32.24537]</span>,<span class="hljs-selector-attr">[-52.7121,-33.196578]</span>,<span class="hljs-selector-attr">[-53.373662,-33.768378]</span>,<span class="hljs-selector-attr">[-53.650544,-33.202004]</span>,<span class="hljs-selector-attr">[-53.209589,-32.727666]</span>,<span class="hljs-selector-attr">[-53.787952,-32.047243]</span>,<span class="hljs-selector-attr">[-54.572452,-31.494511]</span>,<span class="hljs-selector-attr">[-55.60151,-30.853879]</span>,<span class="hljs-selector-attr">[-55.973245,-30.883076]</span>,<span class="hljs-selector-attr">[-56.976026,-30.109686]</span>,<span class="hljs-selector-attr">[-57.625133,-30.216295]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BRN</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Brunei</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[114.204017,4.525874]</span>,<span class="hljs-selector-attr">[114.599961,4.900011]</span>,<span class="hljs-selector-attr">[115.45071,5.44773]</span>,<span class="hljs-selector-attr">[115.4057,4.955228]</span>,<span class="hljs-selector-attr">[115.347461,4.316636]</span>,<span class="hljs-selector-attr">[114.869557,4.348314]</span>,<span class="hljs-selector-attr">[114.659596,4.007637]</span>,<span class="hljs-selector-attr">[114.204017,4.525874]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BTN</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Bhutan</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[91.696657,27.771742]</span>,<span class="hljs-selector-attr">[92.103712,27.452614]</span>,<span class="hljs-selector-attr">[92.033484,26.83831]</span>,<span class="hljs-selector-attr">[91.217513,26.808648]</span>,<span class="hljs-selector-attr">[90.373275,26.875724]</span>,<span class="hljs-selector-attr">[89.744528,26.719403]</span>,<span class="hljs-selector-attr">[88.835643,27.098966]</span>,<span class="hljs-selector-attr">[88.814248,27.299316]</span>,<span class="hljs-selector-attr">[89.47581,28.042759]</span>,<span class="hljs-selector-attr">[90.015829,28.296439]</span>,<span class="hljs-selector-attr">[90.730514,28.064954]</span>,<span class="hljs-selector-attr">[91.258854,28.040614]</span>,<span class="hljs-selector-attr">[91.696657,27.771742]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">BWA</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Botswana</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[25.649163,-18.536026]</span>,<span class="hljs-selector-attr">[25.850391,-18.714413]</span>,<span class="hljs-selector-attr">[26.164791,-19.293086]</span>,<span class="hljs-selector-attr">[27.296505,-20.39152]</span>,<span class="hljs-selector-attr">[27.724747,-20.499059]</span>,<span class="hljs-selector-attr">[27.727228,-20.851802]</span>,<span class="hljs-selector-attr">[28.02137,-21.485975]</span>,<span class="hljs-selector-attr">[28.794656,-21.639454]</span>,<span class="hljs-selector-attr">[29.432188,-22.091313]</span>,<span class="hljs-selector-attr">[28.017236,-22.827754]</span>,<span class="hljs-selector-attr">[27.11941,-23.574323]</span>,<span class="hljs-selector-attr">[26.786407,-24.240691]</span>,<span class="hljs-selector-attr">[26.485753,-24.616327]</span>,<span class="hljs-selector-attr">[25.941652,-24.696373]</span>,<span class="hljs-selector-attr">[25.765849,-25.174845]</span>,<span class="hljs-selector-attr">[25.664666,-25.486816]</span>,<span class="hljs-selector-attr">[25.025171,-25.71967]</span>,<span class="hljs-selector-attr">[24.211267,-25.670216]</span>,<span class="hljs-selector-attr">[23.73357,-25.390129]</span>,<span class="hljs-selector-attr">[23.312097,-25.26869]</span>,<span class="hljs-selector-attr">[22.824271,-25.500459]</span>,<span class="hljs-selector-attr">[22.579532,-25.979448]</span>,<span class="hljs-selector-attr">[22.105969,-26.280256]</span>,<span class="hljs-selector-attr">[21.605896,-26.726534]</span>,<span class="hljs-selector-attr">[20.889609,-26.828543]</span>,<span class="hljs-selector-attr">[20.66647,-26.477453]</span>,<span class="hljs-selector-attr">[20.758609,-25.868136]</span>,<span class="hljs-selector-attr">[20.165726,-24.917962]</span>,<span class="hljs-selector-attr">[19.895768,-24.76779]</span>,<span class="hljs-selector-attr">[19.895458,-21.849157]</span>,<span class="hljs-selector-attr">[20.881134,-21.814327]</span>,<span class="hljs-selector-attr">[20.910641,-18.252219]</span>,<span class="hljs-selector-attr">[21.65504,-18.219146]</span>,<span class="hljs-selector-attr">[23.196858,-17.869038]</span>,<span class="hljs-selector-attr">[23.579006,-18.281261]</span>,<span class="hljs-selector-attr">[24.217365,-17.889347]</span>,<span class="hljs-selector-attr">[24.520705,-17.887125]</span>,<span class="hljs-selector-attr">[25.084443,-17.661816]</span>,<span class="hljs-selector-attr">[25.264226,-17.73654]</span>,<span class="hljs-selector-attr">[25.649163,-18.536026]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">CAF</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Central</span>Â <span class="hljs-selector-tag">African</span>Â <span class="hljs-selector-tag">Republic</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[15.27946,7.421925]</span>,<span class="hljs-selector-attr">[16.106232,7.497088]</span>,<span class="hljs-selector-attr">[16.290562,7.754307]</span>,<span class="hljs-selector-attr">[16.456185,7.734774]</span>,<span class="hljs-selector-attr">[16.705988,7.508328]</span>,<span class="hljs-selector-attr">[17.96493,7.890914]</span>,<span class="hljs-selector-attr">[18.389555,8.281304]</span>,<span class="hljs-selector-attr">[18.911022,8.630895]</span>,<span class="hljs-selector-attr">[18.81201,8.982915]</span>,<span class="hljs-selector-attr">[19.094008,9.074847]</span>,<span class="hljs-selector-attr">[20.059685,9.012706]</span>,<span class="hljs-selector-attr">[21.000868,9.475985]</span>,<span class="hljs-selector-attr">[21.723822,10.567056]</span>,<span class="hljs-selector-attr">[22.231129,10.971889]</span>,<span class="hljs-selector-attr">[22.864165,11.142395]</span>,<span class="hljs-selector-attr">[22.977544,10.714463]</span>,<span class="hljs-selector-attr">[23.554304,10.089255]</span>,<span class="hljs-selector-attr">[23.55725,9.681218]</span>,<span class="hljs-selector-attr">[23.394779,9.265068]</span>,<span class="hljs-selector-attr">[23.459013,8.954286]</span>,<span class="hljs-selector-attr">[23.805813,8.666319]</span>,<span class="hljs-selector-attr">[24.567369,8.229188]</span>,<span class="hljs-selector-attr">[25.114932,7.825104]</span>,<span class="hljs-selector-attr">[25.124131,7.500085]</span>,<span class="hljs-selector-attr">[25.796648,6.979316]</span>,<span class="hljs-selector-attr">[26.213418,6.546603]</span>,<span class="hljs-selector-attr">[26.465909,5.946717]</span>,<span class="hljs-selector-attr">[27.213409,5.550953]</span>,<span class="hljs-selector-attr">[27.374226,5.233944]</span>,<span class="hljs-selector-attr">[27.044065,5.127853]</span>,<span class="hljs-selector-attr">[26.402761,5.150875]</span>,<span class="hljs-selector-attr">[25.650455,5.256088]</span>,<span class="hljs-selector-attr">[25.278798,5.170408]</span>,<span class="hljs-selector-attr">[25.128833,4.927245]</span>,<span class="hljs-selector-attr">[24.805029,4.897247]</span>,<span class="hljs-selector-attr">[24.410531,5.108784]</span>,<span class="hljs-selector-attr">[23.297214,4.609693]</span>,<span class="hljs-selector-attr">[22.84148,4.710126]</span>,<span class="hljs-selector-attr">[22.704124,4.633051]</span>,<span class="hljs-selector-attr">[22.405124,4.02916]</span>,<span class="hljs-selector-attr">[21.659123,4.224342]</span>,<span class="hljs-selector-attr">[20.927591,4.322786]</span>,<span class="hljs-selector-attr">[20.290679,4.691678]</span>,<span class="hljs-selector-attr">[19.467784,5.031528]</span>,<span class="hljs-selector-attr">[18.932312,4.709506]</span>,<span class="hljs-selector-attr">[18.542982,4.201785]</span>,<span class="hljs-selector-attr">[18.453065,3.504386]</span>,<span class="hljs-selector-attr">[17.8099,3.560196]</span>,<span class="hljs-selector-attr">[17.133042,3.728197]</span>,<span class="hljs-selector-attr">[16.537058,3.198255]</span>,<span class="hljs-selector-attr">[16.012852,2.26764]</span>,<span class="hljs-selector-attr">[15.907381,2.557389]</span>,<span class="hljs-selector-attr">[15.862732,3.013537]</span>,<span class="hljs-selector-attr">[15.405396,3.335301]</span>,<span class="hljs-selector-attr">[15.03622,3.851367]</span>,<span class="hljs-selector-attr">[14.950953,4.210389]</span>,<span class="hljs-selector-attr">[14.478372,4.732605]</span>,<span class="hljs-selector-attr">[14.558936,5.030598]</span>,<span class="hljs-selector-attr">[14.459407,5.451761]</span>,<span class="hljs-selector-attr">[14.53656,6.226959]</span>,<span class="hljs-selector-attr">[14.776545,6.408498]</span>,<span class="hljs-selector-attr">[15.27946,7.421925]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">CAN</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Canada</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[-63.6645,46.55001]</span>,<span class="hljs-selector-attr">[-62.9393,46.41587]</span>,<span class="hljs-selector-attr">[-62.01208,46.44314]</span>,<span class="hljs-selector-attr">[-62.50391,46.03339]</span>,<span class="hljs-selector-attr">[-62.87433,45.96818]</span>,<span class="hljs-selector-attr">[-64.1428,46.39265]</span>,<span class="hljs-selector-attr">[-64.39261,46.72747]</span>,<span class="hljs-selector-attr">[-64.01486,47.03601]</span>,<span class="hljs-selector-attr">[-63.6645,46.55001]</span>]],<span class="hljs-selector-attr">[[[-61.806305,49.10506]</span>,<span class="hljs-selector-attr">[-62.29318,49.08717]</span>,<span class="hljs-selector-attr">[-63.58926,49.40069]</span>,<span class="hljs-selector-attr">[-64.51912,49.87304]</span>,<span class="hljs-selector-attr">[-64.17322,49.95718]</span>,<span class="hljs-selector-attr">[-62.85829,49.70641]</span>,<span class="hljs-selector-attr">[-61.835585,49.28855]</span>,<span class="hljs-selector-attr">[-61.806305,49.10506]</span>]],<span class="hljs-selector-attr">[[[-123.510002,48.510011]</span>,<span class="hljs-selector-attr">[-124.012891,48.370846]</span>,<span class="hljs-selector-attr">[-125.655013,48.825005]</span>,<span class="hljs-selector-attr">[-125.954994,49.179996]</span>,<span class="hljs-selector-attr">[-126.850004,49.53]</span>,<span class="hljs-selector-attr">[-127.029993,49.814996]</span>,<span class="hljs-selector-attr">[-128.059336,49.994959]</span>,<span class="hljs-selector-attr">[-128.444584,50.539138]</span>,<span class="hljs-selector-attr">[-128.358414,50.770648]</span>,<span class="hljs-selector-attr">[-127.308581,50.552574]</span>,<span class="hljs-selector-attr">[-126.695001,50.400903]</span>,<span class="hljs-selector-attr">[-125.755007,50.295018]</span>,<span class="hljs-selector-attr">[-125.415002,49.950001]</span>,<span class="hljs-selector-attr">[-124.920768,49.475275]</span>,<span class="hljs-selector-attr">[-123.922509,49.062484]</span>,<span class="hljs-selector-attr">[-123.510002,48.510011]</span>]],<span class="hljs-selector-attr">[[[-56.134036,50.68701]</span>,<span class="hljs-selector-attr">[-56.795882,49.812309]</span>,<span class="hljs-selector-attr">[-56.143105,50.150117]</span>,<span class="hljs-selector-attr">[-55.471492,49.935815]</span>,<span class="hljs-selector-attr">[-55.822401,49.587129]</span>,<span class="hljs-selector-attr">[-54.935143,49.313011]</span>,<span class="hljs-selector-attr">[-54.473775,49.556691]</span>,<span class="hljs-selector-attr">[-53.476549,49.249139]</span>,<span class="hljs-selector-attr">[-53.786014,48.516781]</span>,<span class="hljs-selector-attr">[-53.086134,48.687804]</span>,<span class="hljs-selector-attr">[-52.958648,48.157164]</span>,<span class="hljs-selector-attr">[-52.648099,47.535548]</span>,<span class="hljs-selector-attr">[-53.069158,46.655499]</span>,<span class="hljs-selector-attr">[-53.521456,46.618292]</span>,<span class="hljs-selector-attr">[-54.178936,46.807066]</span>,<span class="hljs-selector-attr">[-53.961869,47.625207]</span>,<span class="hljs-selector-attr">[-54.240482,47.752279]</span>,<span class="hljs-selector-attr">[-55.400773,46.884994]</span>,<span class="hljs-selector-attr">[-55.997481,46.91972]</span>,<span class="hljs-selector-attr">[-55.291219,47.389562]</span>,<span class="hljs-selector-attr">[-56.250799,47.632545]</span>,<span class="hljs-selector-attr">[-57.325229,47.572807]</span>,<span class="hljs-selector-attr">[-59.266015,47.603348]</span>,<span class="hljs-selector-attr">[-59.419494,47.899454]</span>,<span class="hljs-selector-attr">[-58.796586,48.251525]</span>,<span class="hljs-selector-attr">[-59.231625,48.523188]</span>,<span class="hljs-selector-attr">[-58.391805,49.125581]</span>,<span class="hljs-selector-attr">[-57.35869,50.718274]</span>,<span class="hljs-selector-attr">[-56.73865,51.287438]</span>,<span class="hljs-selector-attr">[-55.870977,51.632094]</span>,<span class="hljs-selector-attr">[-55.406974,51.588273]</span>,<span class="hljs-selector-attr">[-55.600218,51.317075]</span>,<span class="hljs-selector-attr">[-56.134036,50.68701]</span>]],<span class="hljs-selector-attr">[[[-132.710008,54.040009]</span>,<span class="hljs-selector-attr">[-132.710009,54.040009]</span>,<span class="hljs-selector-attr">[-132.710008,54.040009]</span>,<span class="hljs-selector-attr">[-132.710008,54.040009]</span>,<span class="hljs-selector-attr">[-131.74999,54.120004]</span>,<span class="hljs-selector-attr">[-132.04948,52.984621]</span>,<span class="hljs-selector-attr">[-131.179043,52.180433]</span>,<span class="hljs-selector-attr">[-131.57783,52.182371]</span>,<span class="hljs-selector-attr">[-132.180428,52.639707]</span>,<span class="hljs-selector-attr">[-132.549992,53.100015]</span>,<span class="hljs-selector-attr">[-133.054611,53.411469]</span>,<span class="hljs-selector-attr">[-133.239664,53.85108]</span>,<span class="hljs-selector-attr">[-133.180004,54.169975]</span>,<span class="hljs-selector-attr">[-132.710008,54.040009]</span>]],<span class="hljs-selector-attr">[[[-79.26582,62.158675]</span>,<span class="hljs-selector-attr">[-79.65752,61.63308]</span>,<span class="hljs-selector-attr">[-80.09956,61.7181]</span>,<span class="hljs-selector-attr">[-80.36215,62.01649]</span>,<span class="hljs-selector-attr">[-80.315395,62.085565]</span>,<span class="hljs-selector-attr">[-79.92939,62.3856]</span>,<span class="hljs-selector-attr">[-79.52002,62.36371]</span>,<span class="hljs-selector-attr">[-79.26582,62.158675]</span>]],<span class="hljs-selector-attr">[[[-81.89825,62.7108]</span>,<span class="hljs-selector-attr">[-83.06857,62.15922]</span>,<span class="hljs-selector-attr">[-83.77462,62.18231]</span>,<span class="hljs-selector-attr">[-83.99367,62.4528]</span>,<span class="hljs-selector-attr">[-83.25048,62.91409]</span>,<span class="hljs-selector-attr">[-81.87699,62.90458]</span>,<span class="hljs-selector-attr">[-81.89825,62.7108]</span>]],<span class="hljs-selector-attr">[[[-85.161308,65.657285]</span>,<span class="hljs-selector-attr">[-84.975764,65.217518]</span>,<span class="hljs-selector-attr">[-84.464012,65.371772]</span>,<span class="hljs-selector-attr">[-83.882626,65.109618]</span>,<span class="hljs-selector-attr">[-82.787577,64.766693]</span>,<span class="hljs-selector-attr">[-81.642014,64.455136]</span>,<span class="hljs-selector-attr">[-81.55344,63.979609]</span>,<span class="hljs-selector-attr">[-80.817361,64.057486]</span>,<span class="hljs-selector-attr">[-80.103451,63.725981]</span>,<span class="hljs-selector-attr">[-80.99102,63.411246]</span>,<span class="hljs-selector-attr">[-82.547178,63.651722]</span>,<span class="hljs-selector-attr">[-83.108798,64.101876]</span>,<span class="hljs-selector-attr">[-84.100417,63.569712]</span>,<span class="hljs-selector-attr">[-85.523405,63.052379]</span>,<span class="hljs-selector-attr">[-85.866769,63.637253]</span>,<span class="hljs-selector-attr">[-87.221983,63.541238]</span>,<span class="hljs-selector-attr">[-86.35276,64.035833]</span>,<span class="hljs-selector-attr">[-86.224886,64.822917]</span>,<span class="hljs-selector-attr">[-85.883848,65.738778]</span>,<span class="hljs-selector-attr">[-85.161308,65.657285]</span>]],<span class="hljs-selector-attr">[[[-75.86588,67.14886]</span>,<span class="hljs-selector-attr">[-76.98687,67.09873]</span>,<span class="hljs-selector-attr">[-77.2364,67.58809]</span>,<span class="hljs-selector-attr">[-76.81166,68.14856]</span>,<span class="hljs-selector-attr">[-75.89521,68.28721]</span>,<span class="hljs-selector-attr">[-75.1145,68.01036]</span>,<span class="hljs-selector-attr">[-75.10333,67.58202]</span>,<span class="hljs-selector-attr">[-75.21597,67.44425]</span>,<span class="hljs-selector-attr">[-75.86588,67.14886]</span>]],<span class="hljs-selector-attr">[[[-95.647681,69.10769]</span>,<span class="hljs-selector-attr">[-96.269521,68.75704]</span>,<span class="hljs-selector-attr">[-97.617401,69.06003]</span>,<span class="hljs-selector-attr">[-98.431801,68.9507]</span>,<span class="hljs-selector-attr">[-99.797401,69.40003]</span>,<span class="hljs-selector-attr">[-98.917401,69.71003]</span>,<span class="hljs-selector-attr">[-98.218261,70.14354]</span>,<span class="hljs-selector-attr">[-97.157401,69.86003]</span>,<span class="hljs-selector-attr">[-96.557401,69.68003]</span>,<span class="hljs-selector-attr">[-96.257401,69.49003]</span>,<span class="hljs-selector-attr">[-95.647681,69.10769]</span>]],<span class="hljs-selector-attr">[[[-90.5471,69.49766]</span>,<span class="hljs-selector-attr">[-90.55151,68.47499]</span>,<span class="hljs-selector-attr">[-89.21515,69.25873]</span>,<span class="hljs-selector-attr">[-88.01966,68.61508]</span>,<span class="hljs-selector-attr">[-88.31749,67.87338]</span>,<span class="hljs-selector-attr">[-87.35017,67.19872]</span>,<span class="hljs-selector-attr">[-86.30607,67.92146]</span>,<span class="hljs-selector-attr">[-85.57664,68.78456]</span>,<span class="hljs-selector-attr">[-85.52197,69.88211]</span>,<span class="hljs-selector-attr">[-84.10081,69.80539]</span>,<span class="hljs-selector-attr">[-82.62258,69.65826]</span>,<span class="hljs-selector-attr">[-81.28043,69.16202]</span>,<span class="hljs-selector-attr">[-81.2202,68.66567]</span>,<span class="hljs-selector-attr">[-81.96436,68.13253]</span>,<span class="hljs-selector-attr">[-81.25928,67.59716]</span>,<span class="hljs-selector-attr">[-81.38653,67.11078]</span>,<span class="hljs-selector-attr">[-83.34456,66.41154]</span>,<span class="hljs-selector-attr">[-84.73542,66.2573]</span>,<span class="hljs-selector-attr">[-85.76943,66.55833]</span>,<span class="hljs-selector-attr">[-86.0676,66.05625]</span>,<span class="hljs-selector-attr">[-87.03143,65.21297]</span>,<span class="hljs-selector-attr">[-87.32324,64.77563]</span>,<span class="hljs-selector-attr">[-88.48296,64.09897]</span>,<span class="hljs-selector-attr">[-89.91444,64.03273]</span>,<span class="hljs-selector-attr">[-90.70398,63.61017]</span>,<span class="hljs-selector-attr">[-90.77004,62.96021]</span>,<span class="hljs-selector-attr">[-91.93342,62.83508]</span>,<span class="hljs-selector-attr">[-93.15698,62.02469]</span>,<span class="hljs-selector-attr">[-94.24153,60.89865]</span>,<span class="hljs-selector-attr">[-94.62931,60.11021]</span>,<span class="hljs-selector-attr">[-94.6846,58.94882]</span>,<span class="hljs-selector-attr">[-93.21502,58.78212]</span>,<span class="hljs-selector-attr">[-92.76462,57.84571]</span>,<span class="hljs-selector-attr">[-92.29703,57.08709]</span>,<span class="hljs-selector-attr">[-90.89769,57.28468]</span>,<span class="hljs-selector-attr">[-89.03953,56.85172]</span>,<span class="hljs-selector-attr">[-88.03978,56.47162]</span>,<span class="hljs-selector-attr">[-87.32421,55.99914]</span>,<span class="hljs-selector-attr">[-86.07121,55.72383]</span>,<span class="hljs-selector-attr">[-85.01181,55.3026]</span>,<span class="hljs-selector-attr">[-83.36055,55.24489]</span>,<span class="hljs-selector-attr">[-82.27285,55.14832]</span>,<span class="hljs-selector-attr">[-82.4362,54.28227]</span>,<span class="hljs-selector-attr">[-82.12502,53.27703]</span>,<span class="hljs-selector-attr">[-81.40075,52.15788]</span>,<span class="hljs-selector-attr">[-79.91289,51.20842]</span>,<span class="hljs-selector-attr">[-79.14301,51.53393]</span>,<span class="hljs-selector-attr">[-78.60191,52.56208]</span>,<span class="hljs-selector-attr">[-79.12421,54.14145]</span>,<span class="hljs-selector-attr">[-79.82958,54.66772]</span>,<span class="hljs-selector-attr">[-78.22874,55.13645]</span>,<span class="hljs-selector-attr">[-77.0956,55.83741]</span>,<span class="hljs-selector-attr">[-76.54137,56.53423]</span>,<span class="hljs-selector-attr">[-76.62319,57.20263]</span>,<span class="hljs-selector-attr">[-77.30226,58.05209]</span>,<span class="hljs-selector-attr">[-78.51688,58.80458]</span>,<span class="hljs-selector-attr">[-77.33676,59.85261]</span>,<span class="hljs-selector-attr">[-77.77272,60.75788]</span>,<span class="hljs-selector-attr">[-78.10687,62.31964]</span>,<span class="hljs-selector-attr">[-77.41067,62.55053]</span>,<span class="hljs-selector-attr">[-75.69621,62.2784]</span>,<span class="hljs-selector-attr">[-74.6682,62.18111]</span>,<span class="hljs-selector-attr">[-73.83988,62.4438]</span>,<span class="hljs-selector-attr">[-72.90853,62.10507]</span>,<span class="hljs-selector-attr">[-71.67708,61.52535]</span>,<span class="hljs-selector-attr">[-71.37369,61.13717]</span>,<span class="hljs-selector-attr">[-69.59042,61.06141]</span>,<span class="hljs-selector-attr">[-69.62033,60.22125]</span>,<span class="hljs-selector-attr">[-69.2879,58.95736]</span>,<span class="hljs-selector-attr">[-68.37455,58.80106]</span>,<span class="hljs-selector-attr">[-67.64976,58.21206]</span>,<span class="hljs-selector-attr">[-66.20178,58.76731]</span>,<span class="hljs-selector-attr">[-65.24517,59.87071]</span>,<span class="hljs-selector-attr">[-64.58352,60.33558]</span>,<span class="hljs-selector-attr">[-63.80475,59.4426]</span>,<span class="hljs-selector-attr">[-62.50236,58.16708]</span>,<span class="hljs-selector-attr">[-61.39655,56.96745]</span>,<span class="hljs-selector-attr">[-61.79866,56.33945]</span>,<span class="hljs-selector-attr">[-60.46853,55.77548]</span>,<span class="hljs-selector-attr">[-59.56962,55.20407]</span>,<span class="hljs-selector-attr">[-57.97508,54.94549]</span>,<span class="hljs-selector-attr">[-57.3332,54.6265]</span>,<span class="hljs-selector-attr">[-56.93689,53.78032]</span>,<span class="hljs-selector-attr">[-56.15811,53.64749]</span>,<span class="hljs-selector-attr">[-55.75632,53.27036]</span>,<span class="hljs-selector-attr">[-55.68338,52.14664]</span>,<span class="hljs-selector-attr">[-56.40916,51.7707]</span>,<span class="hljs-selector-attr">[-57.12691,51.41972]</span>,<span class="hljs-selector-attr">[-58.77482,51.0643]</span>,<span class="hljs-selector-attr">[-60.03309,50.24277]</span>,<span class="hljs-selector-attr">[-61.72366,50.08046]</span>,<span class="hljs-selector-attr">[-63.86251,50.29099]</span>,<span class="hljs-selector-attr">[-65.36331,50.2982]</span>,<span class="hljs-selector-attr">[-66.39905,50.22897]</span>,<span class="hljs-selector-attr">[-67.23631,49.51156]</span>,<span class="hljs-selector-attr">[-68.51114,49.06836]</span>,<span class="hljs-selector-attr">[-69.95362,47.74488]</span>,<span class="hljs-selector-attr">[-71.10458,46.82171]</span>,<span class="hljs-selector-attr">[-70.25522,46.98606]</span>,<span class="hljs-selector-attr">[-68.65,48.3]</span>,<span class="hljs-selector-attr">[-66.55243,49.1331]</span>,<span class="hljs-selector-attr">[-65.05626,49.23278]</span>,<span class="hljs-selector-attr">[-64.17099,48.74248]</span>,<span class="hljs-selector-attr">[-65.11545,48.07085]</span>,<span class="hljs-selector-attr">[-64.79854,46.99297]</span>,<span class="hljs-selector-attr">[-64.47219,46.23849]</span>,<span class="hljs-selector-attr">[-63.17329,45.73902]</span>,<span class="hljs-selector-attr">[-61.52072,45.88377]</span>,<span class="hljs-selector-attr">[-60.51815,47.00793]</span>,<span class="hljs-selector-attr">[-60.4486,46.28264]</span>,<span class="hljs-selector-attr">[-59.80287,45.9204]</span>,<span class="hljs-selector-attr">[-61.03988,45.26525]</span>,<span class="hljs-selector-attr">[-63.25471,44.67014]</span>,<span class="hljs-selector-attr">[-64.24656,44.26553]</span>,<span class="hljs-selector-attr">[-65.36406,43.54523]</span>,<span class="hljs-selector-attr">[-66.1234,43.61867]</span>,<span class="hljs-selector-attr">[-66.16173,44.46512]</span>,<span class="hljs-selector-attr">[-64.42549,45.29204]</span>,<span class="hljs-selector-attr">[-66.02605,45.25931]</span>,<span class="hljs-selector-attr">[-67.13741,45.13753]</span>,<span class="hljs-selector-attr">[-67.79134,45.70281]</span>,<span class="hljs-selector-attr">[-67.79046,47.06636]</span>,<span class="hljs-selector-attr">[-68.23444,47.35486]</span>,<span class="hljs-selector-attr">[-68.905,47.185]</span>,<span class="hljs-selector-attr">[-69.237216,47.447781]</span>,<span class="hljs-selector-attr">[-69.99997,46.69307]</span>,<span class="hljs-selector-attr">[-70.305,45.915]</span>,<span class="hljs-selector-attr">[-70.66,45.46]</span>,<span class="hljs-selector-attr">[-71.08482,45.30524]</span>,<span class="hljs-selector-attr">[-71.405,45.255]</span>,<span class="hljs-selector-attr">[-71.50506,45.0082]</span>,<span class="hljs-selector-attr">[-73.34783,45.00738]</span>,<span class="hljs-selector-attr">[-74.867,45.00048]</span>,<span class="hljs-selector-attr">[-75.31821,44.81645]</span>,<span class="hljs-selector-attr">[-76.375,44.09631]</span>,<span class="hljs-selector-attr">[-76.5,44.018459]</span>,<span class="hljs-selector-attr">[-76.820034,43.628784]</span>,<span class="hljs-selector-attr">[-77.737885,43.629056]</span>,<span class="hljs-selector-attr">[-78.72028,43.625089]</span>,<span class="hljs-selector-attr">[-79.171674,43.466339]</span>,<span class="hljs-selector-attr">[-79.01,43.27]</span>,<span class="hljs-selector-attr">[-78.92,42.965]</span>,<span class="hljs-selector-attr">[-78.939362,42.863611]</span>,<span class="hljs-selector-attr">[-80.247448,42.3662]</span>,<span class="hljs-selector-attr">[-81.277747,42.209026]</span>,<span class="hljs-selector-attr">[-82.439278,41.675105]</span>,<span class="hljs-selector-attr">[-82.690089,41.675105]</span>,<span class="hljs-selector-attr">[-83.02981,41.832796]</span>,<span class="hljs-selector-attr">[-83.142,41.975681]</span>,<span class="hljs-selector-attr">[-83.12,42.08]</span>,<span class="hljs-selector-attr">[-82.9,42.43]</span>,<span class="hljs-selector-attr">[-82.43,42.98]</span>,<span class="hljs-selector-attr">[-82.137642,43.571088]</span>,<span class="hljs-selector-attr">[-82.337763,44.44]</span>,<span class="hljs-selector-attr">[-82.550925,45.347517]</span>,<span class="hljs-selector-attr">[-83.592851,45.816894]</span>,<span class="hljs-selector-attr">[-83.469551,45.994686]</span>,<span class="hljs-selector-attr">[-83.616131,46.116927]</span>,<span class="hljs-selector-attr">[-83.890765,46.116927]</span>,<span class="hljs-selector-attr">[-84.091851,46.275419]</span>,<span class="hljs-selector-attr">[-84.14212,46.512226]</span>,<span class="hljs-selector-attr">[-84.3367,46.40877]</span>,<span class="hljs-selector-attr">[-84.6049,46.4396]</span>,<span class="hljs-selector-attr">[-84.543749,46.538684]</span>,<span class="hljs-selector-attr">[-84.779238,46.637102]</span>,<span class="hljs-selector-attr">[-84.87608,46.900083]</span>,<span class="hljs-selector-attr">[-85.652363,47.220219]</span>,<span class="hljs-selector-attr">[-86.461991,47.553338]</span>,<span class="hljs-selector-attr">[-87.439793,47.94]</span>,<span class="hljs-selector-attr">[-88.378114,48.302918]</span>,<span class="hljs-selector-attr">[-89.272917,48.019808]</span>,<span class="hljs-selector-attr">[-89.6,48.01]</span>,<span class="hljs-selector-attr">[-90.83,48.27]</span>,<span class="hljs-selector-attr">[-91.64,48.14]</span>,<span class="hljs-selector-attr">[-92.61,48.45]</span>,<span class="hljs-selector-attr">[-93.63087,48.60926]</span>,<span class="hljs-selector-attr">[-94.32914,48.67074]</span>,<span class="hljs-selector-attr">[-94.64,48.84]</span>,<span class="hljs-selector-attr">[-94.81758,49.38905]</span>,<span class="hljs-selector-attr">[-95.15609,49.38425]</span>,<span class="hljs-selector-attr">[-95.15907,49]</span>,<span class="hljs-selector-attr">[-97.22872,49.0007]</span>,<span class="hljs-selector-attr">[-100.65,49]</span>,<span class="hljs-selector-attr">[-104.04826,48.99986]</span>,<span class="hljs-selector-attr">[-107.05,49]</span>,<span class="hljs-selector-attr">[-110.05,49]</span>,<span class="hljs-selector-attr">[-113,49]</span>,<span class="hljs-selector-attr">[-116.04818,49]</span>,<span class="hljs-selector-attr">[-117.03121,49]</span>,<span class="hljs-selector-attr">[-120,49]</span>,<span class="hljs-selector-attr">[-122.84,49]</span>,<span class="hljs-selector-attr">[-122.97421,49.002538]</span>,<span class="hljs-selector-attr">[-124.91024,49.98456]</span>,<span class="hljs-selector-attr">[-125.62461,50.41656]</span>,<span class="hljs-selector-attr">[-127.43561,50.83061]</span>,<span class="hljs-selector-attr">[-127.99276,51.71583]</span>,<span class="hljs-selector-attr">[-127.85032,52.32961]</span>,<span class="hljs-selector-attr">[-129.12979,52.75538]</span>,<span class="hljs-selector-attr">[-129.30523,53.56159]</span>,<span class="hljs-selector-attr">[-130.51497,54.28757]</span>,<span class="hljs-selector-attr">[-130.53611,54.80278]</span>,<span class="hljs-selector-attr">[-129.98,55.285]</span>,<span class="hljs-selector-attr">[-130.00778,55.91583]</span>,<span class="hljs-selector-attr">[-131.70781,56.55212]</span>,<span class="hljs-selector-attr">[-132.73042,57.69289]</span>,<span class="hljs-selector-attr">[-133.35556,58.41028]</span>,<span class="hljs-selector-attr">[-134.27111,58.86111]</span>,<span class="hljs-selector-attr">[-134.945,59.27056]</span>,<span class="hljs-selector-attr">[-135.47583,59.78778]</span>,<span class="hljs-selector-attr">[-136.47972,59.46389]</span>,<span class="hljs-selector-attr">[-137.4525,58.905]</span>,<span class="hljs-selector-attr">[-138.34089,59.56211]</span>,<span class="hljs-selector-attr">[-139.039,60]</span>,<span class="hljs-selector-attr">[-140.013,60.27682]</span>,<span class="hljs-selector-attr">[-140.99778,60.30639]</span>,<span class="hljs-selector-attr">[-140.9925,66.00003]</span>,<span class="hljs-selector-attr">[-140.986,69.712]</span>,<span class="hljs-selector-attr">[-139.12052,69.47102]</span>,<span class="hljs-selector-attr">[-137.54636,68.99002]</span>,<span class="hljs-selector-attr">[-136.50358,68.89804]</span>,<span class="hljs-selector-attr">[-135.62576,69.31512]</span>,<span class="hljs-selector-attr">[-134.41464,69.62743]</span>,<span class="hljs-selector-attr">[-132.92925,69.50534]</span>,<span class="hljs-selector-attr">[-131.43136,69.94451]</span>,<span class="hljs-selector-attr">[-129.79471,70.19369]</span>,<span class="hljs-selector-attr">[-129.10773,69.77927]</span>,<span class="hljs-selector-attr">[-128.36156,70.01286]</span>,<span class="hljs-selector-attr">[-128.13817,70.48384]</span>,<span class="hljs-selector-attr">[-127.44712,70.37721]</span>,<span class="hljs-selector-attr">[-125.75632,69.48058]</span>,<span class="hljs-selector-attr">[-124.42483,70.1584]</span>,<span class="hljs-selector-attr">[-124.28968,69.39969]</span>,<span class="hljs-selector-attr">[-123.06108,69.56372]</span>,<span class="hljs-selector-attr">[-122.6835,69.85553]</span>,<span class="hljs-selector-attr">[-121.47226,69.79778]</span>,<span class="hljs-selector-attr">[-119.94288,69.37786]</span>,<span class="hljs-selector-attr">[-117.60268,69.01128]</span>,<span class="hljs-selector-attr">[-116.22643,68.84151]</span>,<span class="hljs-selector-attr">[-115.2469,68.90591]</span>,<span class="hljs-selector-attr">[-113.89794,68.3989]</span>,<span class="hljs-selector-attr">[-115.30489,67.90261]</span>,<span class="hljs-selector-attr">[-113.49727,67.68815]</span>,<span class="hljs-selector-attr">[-110.798,67.80612]</span>,<span class="hljs-selector-attr">[-109.94619,67.98104]</span>,<span class="hljs-selector-attr">[-108.8802,67.38144]</span>,<span class="hljs-selector-attr">[-107.79239,67.88736]</span>,<span class="hljs-selector-attr">[-108.81299,68.31164]</span>,<span class="hljs-selector-attr">[-108.16721,68.65392]</span>,<span class="hljs-selector-attr">[-106.95,68.7]</span>,<span class="hljs-selector-attr">[-106.15,68.8]</span>,<span class="hljs-selector-attr">[-105.34282,68.56122]</span>,<span class="hljs-selector-attr">[-104.33791,68.018]</span>,<span class="hljs-selector-attr">[-103.22115,68.09775]</span>,<span class="hljs-selector-attr">[-101.45433,67.64689]</span>,<span class="hljs-selector-attr">[-99.90195,67.80566]</span>,<span class="hljs-selector-attr">[-98.4432,67.78165]</span>,<span class="hljs-selector-attr">[-98.5586,68.40394]</span>,<span class="hljs-selector-attr">[-97.66948,68.57864]</span>,<span class="hljs-selector-attr">[-96.11991,68.23939]</span>,<span class="hljs-selector-attr">[-96.12588,67.29338]</span>,<span class="hljs-selector-attr">[-95.48943,68.0907]</span>,<span class="hljs-selector-attr">[-94.685,68.06383]</span>,<span class="hljs-selector-attr">[-94.23282,69.06903]</span>,<span class="hljs-selector-attr">[-95.30408,69.68571]</span>,<span class="hljs-selector-attr">[-96.47131,70.08976]</span>,<span class="hljs-selector-attr">[-96.39115,71.19482]</span>,<span class="hljs-selector-attr">[-95.2088,71.92053]</span>,<span class="hljs-selector-attr">[-93.88997,71.76015]</span>,<span class="hljs-selector-attr">[-92.87818,71.31869]</span>,<span class="hljs-selector-attr">[-91.51964,70.19129]</span>,<span class="hljs-selector-attr">[-92.40692,69.69997]</span>,<span class="hljs-selector-attr">[-90.5471,69.49766]</span>]],<span class="hljs-selector-attr">[[[-114.16717,73.12145]</span>,<span class="hljs-selector-attr">[-114.66634,72.65277]</span>,<span class="hljs-selector-attr">[-112.44102,72.9554]</span>,<span class="hljs-selector-attr">[-111.05039,72.4504]</span>,<span class="hljs-selector-attr">[-109.92035,72.96113]</span>,<span class="hljs-selector-attr">[-109.00654,72.63335]</span>,<span class="hljs-selector-attr">[-108.18835,71.65089]</span>,<span class="hljs-selector-attr">[-107.68599,72.06548]</span>,<span class="hljs-selector-attr">[-108.39639,73.08953]</span>,<span class="hljs-selector-attr">[-107.51645,73.23598]</span>,<span class="hljs-selector-attr">[-106.52259,73.07601]</span>,<span class="hljs-selector-attr">[-105.40246,72.67259]</span>,<span class="hljs-selector-attr">[-104.77484,71.6984]</span>,<span class="hljs-selector-attr">[-104.46476,70.99297]</span>,<span class="hljs-selector-attr">[-102.78537,70.49776]</span>,<span class="hljs-selector-attr">[-100.98078,70.02432]</span>,<span class="hljs-selector-attr">[-101.08929,69.58447]</span>,<span class="hljs-selector-attr">[-102.73116,69.50402]</span>,<span class="hljs-selector-attr">[-102.09329,69.11962]</span>,<span class="hljs-selector-attr">[-102.43024,68.75282]</span>,<span class="hljs-selector-attr">[-104.24,68.91]</span>,<span class="hljs-selector-attr">[-105.96,69.18]</span>,<span class="hljs-selector-attr">[-107.12254,69.11922]</span>,<span class="hljs-selector-attr">[-109,68.78]</span>,<span class="hljs-selector-attr">[-111.534149,68.630059]</span>,<span class="hljs-selector-attr">[-113.3132,68.53554]</span>,<span class="hljs-selector-attr">[-113.85496,69.00744]</span>,<span class="hljs-selector-attr">[-115.22,69.28]</span>,<span class="hljs-selector-attr">[-116.10794,69.16821]</span>,<span class="hljs-selector-attr">[-117.34,69.96]</span>,<span class="hljs-selector-attr">[-116.67473,70.06655]</span>,<span class="hljs-selector-attr">[-115.13112,70.2373]</span>,<span class="hljs-selector-attr">[-113.72141,70.19237]</span>,<span class="hljs-selector-attr">[-112.4161,70.36638]</span>,<span class="hljs-selector-attr">[-114.35,70.6]</span>,<span class="hljs-selector-attr">[-116.48684,70.52045]</span>,<span class="hljs-selector-attr">[-117.9048,70.54056]</span>,<span class="hljs-selector-attr">[-118.43238,70.9092]</span>,<span class="hljs-selector-attr">[-116.11311,71.30918]</span>,<span class="hljs-selector-attr">[-117.65568,71.2952]</span>,<span class="hljs-selector-attr">[-119.40199,71.55859]</span>,<span class="hljs-selector-attr">[-118.56267,72.30785]</span>,<span class="hljs-selector-attr">[-117.86642,72.70594]</span>,<span class="hljs-selector-attr">[-115.18909,73.31459]</span>,<span class="hljs-selector-attr">[-114.16717,73.12145]</span>]],<span class="hljs-selector-attr">[[[-104.5,73.42]</span>,<span class="hljs-selector-attr">[-105.38,72.76]</span>,<span class="hljs-selector-attr">[-106.94,73.46]</span>,<span class="hljs-selector-attr">[-106.6,73.6]</span>,<span class="hljs-selector-attr">[-105.26,73.64]</span>,<span class="hljs-selector-attr">[-104.5,73.42]</span>]],<span class="hljs-selector-attr">[[[-76.34,73.102685]</span>,<span class="hljs-selector-attr">[-76.251404,72.826385]</span>,<span class="hljs-selector-attr">[-77.314438,72.855545]</span>,<span class="hljs-selector-attr">[-78.39167,72.876656]</span>,<span class="hljs-selector-attr">[-79.486252,72.742203]</span>,<span class="hljs-selector-attr">[-79.775833,72.802902]</span>,<span class="hljs-selector-attr">[-80.876099,73.333183]</span>,<span class="hljs-selector-attr">[-80.833885,73.693184]</span>,<span class="hljs-selector-attr">[-80.353058,73.75972]</span>,<span class="hljs-selector-attr">[-78.064438,73.651932]</span>,<span class="hljs-selector-attr">[-76.34,73.102685]</span>]],<span class="hljs-selector-attr">[[[-86.562179,73.157447]</span>,<span class="hljs-selector-attr">[-85.774371,72.534126]</span>,<span class="hljs-selector-attr">[-84.850112,73.340278]</span>,<span class="hljs-selector-attr">[-82.31559,73.750951]</span>,<span class="hljs-selector-attr">[-80.600088,72.716544]</span>,<span class="hljs-selector-attr">[-80.748942,72.061907]</span>,<span class="hljs-selector-attr">[-78.770639,72.352173]</span>,<span class="hljs-selector-attr">[-77.824624,72.749617]</span>,<span class="hljs-selector-attr">[-75.605845,72.243678]</span>,<span class="hljs-selector-attr">[-74.228616,71.767144]</span>,<span class="hljs-selector-attr">[-74.099141,71.33084]</span>,<span class="hljs-selector-attr">[-72.242226,71.556925]</span>,<span class="hljs-selector-attr">[-71.200015,70.920013]</span>,<span class="hljs-selector-attr">[-68.786054,70.525024]</span>,<span class="hljs-selector-attr">[-67.91497,70.121948]</span>,<span class="hljs-selector-attr">[-66.969033,69.186087]</span>,<span class="hljs-selector-attr">[-68.805123,68.720198]</span>,<span class="hljs-selector-attr">[-66.449866,68.067163]</span>,<span class="hljs-selector-attr">[-64.862314,67.847539]</span>,<span class="hljs-selector-attr">[-63.424934,66.928473]</span>,<span class="hljs-selector-attr">[-61.851981,66.862121]</span>,<span class="hljs-selector-attr">[-62.163177,66.160251]</span>,<span class="hljs-selector-attr">[-63.918444,64.998669]</span>,<span class="hljs-selector-attr">[-65.14886,65.426033]</span>,<span class="hljs-selector-attr">[-66.721219,66.388041]</span>,<span class="hljs-selector-attr">[-68.015016,66.262726]</span>,<span class="hljs-selector-attr">[-68.141287,65.689789]</span>,<span class="hljs-selector-attr">[-67.089646,65.108455]</span>,<span class="hljs-selector-attr">[-65.73208,64.648406]</span>,<span class="hljs-selector-attr">[-65.320168,64.382737]</span>,<span class="hljs-selector-attr">[-64.669406,63.392927]</span>,<span class="hljs-selector-attr">[-65.013804,62.674185]</span>,<span class="hljs-selector-attr">[-66.275045,62.945099]</span>,<span class="hljs-selector-attr">[-68.783186,63.74567]</span>,<span class="hljs-selector-attr">[-67.369681,62.883966]</span>,<span class="hljs-selector-attr">[-66.328297,62.280075]</span>,<span class="hljs-selector-attr">[-66.165568,61.930897]</span>,<span class="hljs-selector-attr">[-68.877367,62.330149]</span>,<span class="hljs-selector-attr">[-71.023437,62.910708]</span>,<span class="hljs-selector-attr">[-72.235379,63.397836]</span>,<span class="hljs-selector-attr">[-71.886278,63.679989]</span>,<span class="hljs-selector-attr">[-73.378306,64.193963]</span>,<span class="hljs-selector-attr">[-74.834419,64.679076]</span>,<span class="hljs-selector-attr">[-74.818503,64.389093]</span>,<span class="hljs-selector-attr">[-77.70998,64.229542]</span>,<span class="hljs-selector-attr">[-78.555949,64.572906]</span>,<span class="hljs-selector-attr">[-77.897281,65.309192]</span>,<span class="hljs-selector-attr">[-76.018274,65.326969]</span>,<span class="hljs-selector-attr">[-73.959795,65.454765]</span>,<span class="hljs-selector-attr">[-74.293883,65.811771]</span>,<span class="hljs-selector-attr">[-73.944912,66.310578]</span>,<span class="hljs-selector-attr">[-72.651167,67.284576]</span>,<span class="hljs-selector-attr">[-72.92606,67.726926]</span>,<span class="hljs-selector-attr">[-73.311618,68.069437]</span>,<span class="hljs-selector-attr">[-74.843307,68.554627]</span>,<span class="hljs-selector-attr">[-76.869101,68.894736]</span>,<span class="hljs-selector-attr">[-76.228649,69.147769]</span>,<span class="hljs-selector-attr">[-77.28737,69.76954]</span>,<span class="hljs-selector-attr">[-78.168634,69.826488]</span>,<span class="hljs-selector-attr">[-78.957242,70.16688]</span>,<span class="hljs-selector-attr">[-79.492455,69.871808]</span>,<span class="hljs-selector-attr">[-81.305471,69.743185]</span>,<span class="hljs-selector-attr">[-84.944706,69.966634]</span>,<span class="hljs-selector-attr">[-87.060003,70.260001]</span>,<span class="hljs-selector-attr">[-88.681713,70.410741]</span>,<span class="hljs-selector-attr">[-89.51342,70.762038]</span>,<span class="hljs-selector-attr">[-88.467721,71.218186]</span>,<span class="hljs-selector-attr">[-89.888151,71.222552]</span>,<span class="hljs-selector-attr">[-90.20516,72.235074]</span>,<span class="hljs-selector-attr">[-89.436577,73.129464]</span>,<span class="hljs-selector-attr">[-88.408242,73.537889]</span>,<span class="hljs-selector-attr">[-85.826151,73.803816]</span>,<span class="hljs-selector-attr">[-86.562179,73.157447]</span>]],<span class="hljs-selector-attr">[[[-100.35642,73.84389]</span>,<span class="hljs-selector-attr">[-99.16387,73.63339]</span>,<span class="hljs-selector-attr">[-97.38,73.76]</span>,<span class="hljs-selector-attr">[-97.12,73.47]</span>,<span class="hljs-selector-attr">[-98.05359,72.99052]</span>,<span class="hljs-selector-attr">[-96.54,72.56]</span>,<span class="hljs-selector-attr">[-96.72,71.66]</span>,<span class="hljs-selector-attr">[-98.35966,71.27285]</span>,<span class="hljs-selector-attr">[-99.32286,71.35639]</span>,<span class="hljs-selector-attr">[-100.01482,71.73827]</span>,<span class="hljs-selector-attr">[-102.5,72.51]</span>,<span class="hljs-selector-attr">[-102.48,72.83]</span>,<span class="hljs-selector-attr">[-100.43836,72.70588]</span>,<span class="hljs-selector-attr">[-101.54,73.36]</span>,<span class="hljs-selector-attr">[-100.35642,73.84389]</span>]],<span class="hljs-selector-attr">[[[-93.196296,72.771992]</span>,<span class="hljs-selector-attr">[-94.269047,72.024596]</span>,<span class="hljs-selector-attr">[-95.409856,72.061881]</span>,<span class="hljs-selector-attr">[-96.033745,72.940277]</span>,<span class="hljs-selector-attr">[-96.018268,73.43743]</span>,<span class="hljs-selector-attr">[-95.495793,73.862417]</span>,<span class="hljs-selector-attr">[-94.503658,74.134907]</span>,<span class="hljs-selector-attr">[-92.420012,74.100025]</span>,<span class="hljs-selector-attr">[-90.509793,73.856732]</span>,<span class="hljs-selector-attr">[-92.003965,72.966244]</span>,<span class="hljs-selector-attr">[-93.196296,72.771992]</span>]],<span class="hljs-selector-attr">[[[-120.46,71.383602]</span>,<span class="hljs-selector-attr">[-123.09219,70.90164]</span>,<span class="hljs-selector-attr">[-123.62,71.34]</span>,<span class="hljs-selector-attr">[-125.928949,71.868688]</span>,<span class="hljs-selector-attr">[-125.5,72.292261]</span>,<span class="hljs-selector-attr">[-124.80729,73.02256]</span>,<span class="hljs-selector-attr">[-123.94,73.68]</span>,<span class="hljs-selector-attr">[-124.91775,74.29275]</span>,<span class="hljs-selector-attr">[-121.53788,74.44893]</span>,<span class="hljs-selector-attr">[-120.10978,74.24135]</span>,<span class="hljs-selector-attr">[-117.55564,74.18577]</span>,<span class="hljs-selector-attr">[-116.58442,73.89607]</span>,<span class="hljs-selector-attr">[-115.51081,73.47519]</span>,<span class="hljs-selector-attr">[-116.76794,73.22292]</span>,<span class="hljs-selector-attr">[-119.22,72.52]</span>,<span class="hljs-selector-attr">[-120.46,71.82]</span>,<span class="hljs-selector-attr">[-120.46,71.383602]</span>]],<span class="hljs-selector-attr">[[[-93.612756,74.979997]</span>,<span class="hljs-selector-attr">[-94.156909,74.592347]</span>,<span class="hljs-selector-attr">[-95.608681,74.666864]</span>,<span class="hljs-selector-attr">[-96.820932,74.927623]</span>,<span class="hljs-selector-attr">[-96.288587,75.377828]</span>,<span class="hljs-selector-attr">[-94.85082,75.647218]</span>,<span class="hljs-selector-attr">[-93.977747,75.29649]</span>,<span class="hljs-selector-attr">[-93.612756,74.979997]</span>]],<span class="hljs-selector-attr">[[[-98.5,76.72]</span>,<span class="hljs-selector-attr">[-97.735585,76.25656]</span>,<span class="hljs-selector-attr">[-97.704415,75.74344]</span>,<span class="hljs-selector-attr">[-98.16,75]</span>,<span class="hljs-selector-attr">[-99.80874,74.89744]</span>,<span class="hljs-selector-attr">[-100.88366,75.05736]</span>,<span class="hljs-selector-attr">[-100.86292,75.64075]</span>,<span class="hljs-selector-attr">[-102.50209,75.5638]</span>,<span class="hljs-selector-attr">[-102.56552,76.3366]</span>,<span class="hljs-selector-attr">[-101.48973,76.30537]</span>,<span class="hljs-selector-attr">[-99.98349,76.64634]</span>,<span class="hljs-selector-attr">[-98.57699,76.58859]</span>,<span class="hljs-selector-attr">[-98.5,76.72]</span>]],<span class="hljs-selector-attr">[[[-108.21141,76.20168]</span>,<span class="hljs-selector-attr">[-107.81943,75.84552]</span>,<span class="hljs-selector-attr">[-106.92893,76.01282]</span>,<span class="hljs-selector-attr">[-105.881,75.9694]</span>,<span class="hljs-selector-attr">[-105.70498,75.47951]</span>,<span class="hljs-selector-attr">[-106.31347,75.00527]</span>,<span class="hljs-selector-attr">[-109.7,74.85]</span>,<span class="hljs-selector-attr">[-112.22307,74.41696]</span>,<span class="hljs-selector-attr">[-113.74381,74.39427]</span>,<span class="hljs-selector-attr">[-113.87135,74.72029]</span>,<span class="hljs-selector-attr">[-111.79421,75.1625]</span>,<span class="hljs-selector-attr">[-116.31221,75.04343]</span>,<span class="hljs-selector-attr">[-117.7104,75.2222]</span>,<span class="hljs-selector-attr">[-116.34602,76.19903]</span>,<span class="hljs-selector-attr">[-115.40487,76.47887]</span>,<span class="hljs-selector-attr">[-112.59056,76.14134]</span>,<span class="hljs-selector-attr">[-110.81422,75.54919]</span>,<span class="hljs-selector-attr">[-109.0671,75.47321]</span>,<span class="hljs-selector-attr">[-110.49726,76.42982]</span>,<span class="hljs-selector-attr">[-109.5811,76.79417]</span>,<span class="hljs-selector-attr">[-108.54859,76.67832]</span>,<span class="hljs-selector-attr">[-108.21141,76.20168]</span>]],<span class="hljs-selector-attr">[[[-94.684086,77.097878]</span>,<span class="hljs-selector-attr">[-93.573921,76.776296]</span>,<span class="hljs-selector-attr">[-91.605023,76.778518]</span>,<span class="hljs-selector-attr">[-90.741846,76.449597]</span>,<span class="hljs-selector-attr">[-90.969661,76.074013]</span>,<span class="hljs-selector-attr">[-89.822238,75.847774]</span>,<span class="hljs-selector-attr">[-89.187083,75.610166]</span>,<span class="hljs-selector-attr">[-87.838276,75.566189]</span>,<span class="hljs-selector-attr">[-86.379192,75.482421]</span>,<span class="hljs-selector-attr">[-84.789625,75.699204]</span>,<span class="hljs-selector-attr">[-82.753445,75.784315]</span>,<span class="hljs-selector-attr">[-81.128531,75.713983]</span>,<span class="hljs-selector-attr">[-80.057511,75.336849]</span>,<span class="hljs-selector-attr">[-79.833933,74.923127]</span>,<span class="hljs-selector-attr">[-80.457771,74.657304]</span>,<span class="hljs-selector-attr">[-81.948843,74.442459]</span>,<span class="hljs-selector-attr">[-83.228894,74.564028]</span>,<span class="hljs-selector-attr">[-86.097452,74.410032]</span>,<span class="hljs-selector-attr">[-88.15035,74.392307]</span>,<span class="hljs-selector-attr">[-89.764722,74.515555]</span>,<span class="hljs-selector-attr">[-92.422441,74.837758]</span>,<span class="hljs-selector-attr">[-92.768285,75.38682]</span>,<span class="hljs-selector-attr">[-92.889906,75.882655]</span>,<span class="hljs-selector-attr">[-93.893824,76.319244]</span>,<span class="hljs-selector-attr">[-95.962457,76.441381]</span>,<span class="hljs-selector-attr">[-97.121379,76.751078]</span>,<span class="hljs-selector-attr">[-96.745123,77.161389]</span>,<span class="hljs-selector-attr">[-94.684086,77.097878]</span>]],<span class="hljs-selector-attr">[[[-116.198587,77.645287]</span>,<span class="hljs-selector-attr">[-116.335813,76.876962]</span>,<span class="hljs-selector-attr">[-117.106051,76.530032]</span>,<span class="hljs-selector-attr">[-118.040412,76.481172]</span>,<span class="hljs-selector-attr">[-119.899318,76.053213]</span>,<span class="hljs-selector-attr">[-121.499995,75.900019]</span>,<span class="hljs-selector-attr">[-122.854924,76.116543]</span>,<span class="hljs-selector-attr">[-122.854925,76.116543]</span>,<span class="hljs-selector-attr">[-121.157535,76.864508]</span>,<span class="hljs-selector-attr">[-119.103939,77.51222]</span>,<span class="hljs-selector-attr">[-117.570131,77.498319]</span>,<span class="hljs-selector-attr">[-116.198587,77.645287]</span>]],<span class="hljs-selector-attr">[[[-93.840003,77.519997]</span>,<span class="hljs-selector-attr">[-94.295608,77.491343]</span>,<span class="hljs-selector-attr">[-96.169654,77.555111]</span>,<span class="hljs-selector-attr">[-96.436304,77.834629]</span>,<span class="hljs-selector-attr">[-94.422577,77.820005]</span>,<span class="hljs-selector-attr">[-93.720656,77.634331]</span>,<span class="hljs-selector-attr">[-93.840003,77.519997]</span>]],<span class="hljs-selector-attr">[[[-110.186938,77.697015]</span>,<span class="hljs-selector-attr">[-112.051191,77.409229]</span>,<span class="hljs-selector-attr">[-113.534279,77.732207]</span>,<span class="hljs-selector-attr">[-112.724587,78.05105]</span>,<span class="hljs-selector-attr">[-111.264443,78.152956]</span>,<span class="hljs-selector-attr">[-109.854452,77.996325]</span>,<span class="hljs-selector-attr">[-110.186938,77.697015]</span>]],<span class="hljs-selector-attr">[[[-109.663146,78.601973]</span>,<span class="hljs-selector-attr">[-110.881314,78.40692]</span>,<span class="hljs-selector-attr">[-112.542091,78.407902]</span>,<span class="hljs-selector-attr">[-112.525891,78.550555]</span>,<span class="hljs-selector-attr">[-111.50001,78.849994]</span>,<span class="hljs-selector-attr">[-110.963661,78.804441]</span>,<span class="hljs-selector-attr">[-109.663146,78.601973]</span>]],<span class="hljs-selector-attr">[[[-95.830295,78.056941]</span>,<span class="hljs-selector-attr">[-97.309843,77.850597]</span>,<span class="hljs-selector-attr">[-98.124289,78.082857]</span>,<span class="hljs-selector-attr">[-98.552868,78.458105]</span>,<span class="hljs-selector-attr">[-98.631984,78.87193]</span>,<span class="hljs-selector-attr">[-97.337231,78.831984]</span>,<span class="hljs-selector-attr">[-96.754399,78.765813]</span>,<span class="hljs-selector-attr">[-95.559278,78.418315]</span>,<span class="hljs-selector-attr">[-95.830295,78.056941]</span>]],<span class="hljs-selector-attr">[[[-100.060192,78.324754]</span>,<span class="hljs-selector-attr">[-99.670939,77.907545]</span>,<span class="hljs-selector-attr">[-101.30394,78.018985]</span>,<span class="hljs-selector-attr">[-102.949809,78.343229]</span>,<span class="hljs-selector-attr">[-105.176133,78.380332]</span>,<span class="hljs-selector-attr">[-104.210429,78.67742]</span>,<span class="hljs-selector-attr">[-105.41958,78.918336]</span>,<span class="hljs-selector-attr">[-105.492289,79.301594]</span>,<span class="hljs-selector-attr">[-103.529282,79.165349]</span>,<span class="hljs-selector-attr">[-100.825158,78.800462]</span>,<span class="hljs-selector-attr">[-100.060192,78.324754]</span>]],<span class="hljs-selector-attr">[[[-87.02,79.66]</span>,<span class="hljs-selector-attr">[-85.81435,79.3369]</span>,<span class="hljs-selector-attr">[-87.18756,79.0393]</span>,<span class="hljs-selector-attr">[-89.03535,78.28723]</span>,<span class="hljs-selector-attr">[-90.80436,78.21533]</span>,<span class="hljs-selector-attr">[-92.87669,78.34333]</span>,<span class="hljs-selector-attr">[-93.95116,78.75099]</span>,<span class="hljs-selector-attr">[-93.93574,79.11373]</span>,<span class="hljs-selector-attr">[-93.14524,79.3801]</span>,<span class="hljs-selector-attr">[-94.974,79.37248]</span>,<span class="hljs-selector-attr">[-96.07614,79.70502]</span>,<span class="hljs-selector-attr">[-96.70972,80.15777]</span>,<span class="hljs-selector-attr">[-96.01644,80.60233]</span>,<span class="hljs-selector-attr">[-95.32345,80.90729]</span>,<span class="hljs-selector-attr">[-94.29843,80.97727]</span>,<span class="hljs-selector-attr">[-94.73542,81.20646]</span>,<span class="hljs-selector-attr">[-92.40984,81.25739]</span>,<span class="hljs-selector-attr">[-91.13289,80.72345]</span>,<span class="hljs-selector-attr">[-89.45,80.509322]</span>,<span class="hljs-selector-attr">[-87.81,80.32]</span>,<span class="hljs-selector-attr">[-87.02,79.66]</span>]],<span class="hljs-selector-attr">[[[-68.5,83.106322]</span>,<span class="hljs-selector-attr">[-65.82735,83.02801]</span>,<span class="hljs-selector-attr">[-63.68,82.9]</span>,<span class="hljs-selector-attr">[-61.85,82.6286]</span>,<span class="hljs-selector-attr">[-61.89388,82.36165]</span>,<span class="hljs-selector-attr">[-64.334,81.92775]</span>,<span class="hljs-selector-attr">[-66.75342,81.72527]</span>,<span class="hljs-selector-attr">[-67.65755,81.50141]</span>,<span class="hljs-selector-attr">[-65.48031,81.50657]</span>,<span class="hljs-selector-attr">[-67.84,80.9]</span>,<span class="hljs-selector-attr">[-69.4697,80.61683]</span>,<span class="hljs-selector-attr">[-71.18,79.8]</span>,<span class="hljs-selector-attr">[-73.2428,79.63415]</span>,<span class="hljs-selector-attr">[-73.88,79.430162]</span>,<span class="hljs-selector-attr">[-76.90773,79.32309]</span>,<span class="hljs-selector-attr">[-75.52924,79.19766]</span>,<span class="hljs-selector-attr">[-76.22046,79.01907]</span>,<span class="hljs-selector-attr">[-75.39345,78.52581]</span>,<span class="hljs-selector-attr">[-76.34354,78.18296]</span>,<span class="hljs-selector-attr">[-77.88851,77.89991]</span>,<span class="hljs-selector-attr">[-78.36269,77.50859]</span>,<span class="hljs-selector-attr">[-79.75951,77.20968]</span>,<span class="hljs-selector-attr">[-79.61965,76.98336]</span>,<span class="hljs-selector-attr">[-77.91089,77.022045]</span>,<span class="hljs-selector-attr">[-77.88911,76.777955]</span>,<span class="hljs-selector-attr">[-80.56125,76.17812]</span>,<span class="hljs-selector-attr">[-83.17439,76.45403]</span>,<span class="hljs-selector-attr">[-86.11184,76.29901]</span>,<span class="hljs-selector-attr">[-87.6,76.42]</span>,<span class="hljs-selector-attr">[-89.49068,76.47239]</span>,<span class="hljs-selector-attr">[-89.6161,76.95213]</span>,<span class="hljs-selector-attr">[-87.76739,77.17833]</span>,<span class="hljs-selector-attr">[-88.26,77.9]</span>,<span class="hljs-selector-attr">[-87.65,77.970222]</span>,<span class="hljs-selector-attr">[-84.97634,77.53873]</span>,<span class="hljs-selector-attr">[-86.34,78.18]</span>,<span class="hljs-selector-attr">[-87.96192,78.37181]</span>,<span class="hljs-selector-attr">[-87.15198,78.75867]</span>,<span class="hljs-selector-attr">[-85.37868,78.9969]</span>,<span class="hljs-selector-attr">[-85.09495,79.34543]</span>,<span class="hljs-selector-attr">[-86.50734,79.73624]</span>,<span class="hljs-selector-attr">[-86.93179,80.25145]</span>,<span class="hljs-selector-attr">[-84.19844,80.20836]</span>,<span class="hljs-selector-attr">[-83.408696,80.1]</span>,<span class="hljs-selector-attr">[-81.84823,80.46442]</span>,<span class="hljs-selector-attr">[-84.1,80.58]</span>,<span class="hljs-selector-attr">[-87.59895,80.51627]</span>,<span class="hljs-selector-attr">[-89.36663,80.85569]</span>,<span class="hljs-selector-attr">[-90.2,81.26]</span>,<span class="hljs-selector-attr">[-91.36786,81.5531]</span>,<span class="hljs-selector-attr">[-91.58702,81.89429]</span>,<span class="hljs-selector-attr">[-90.1,82.085]</span>,<span class="hljs-selector-attr">[-88.93227,82.11751]</span>,<span class="hljs-selector-attr">[-86.97024,82.27961]</span>,<span class="hljs-selector-attr">[-85.5,82.652273]</span>,<span class="hljs-selector-attr">[-84.260005,82.6]</span>,<span class="hljs-selector-attr">[-83.18,82.32]</span>,<span class="hljs-selector-attr">[-82.42,82.86]</span>,<span class="hljs-selector-attr">[-81.1,83.02]</span>,<span class="hljs-selector-attr">[-79.30664,83.13056]</span>,<span class="hljs-selector-attr">[-76.25,83.172059]</span>,<span class="hljs-selector-attr">[-75.71878,83.06404]</span>,<span class="hljs-selector-attr">[-72.83153,83.23324]</span>,<span class="hljs-selector-attr">[-70.665765,83.169781]</span>,<span class="hljs-selector-attr">[-68.5,83.106322]</span>]]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">CHE</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Switzerland</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Polygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[9.594226,47.525058]</span>,<span class="hljs-selector-attr">[9.632932,47.347601]</span>,<span class="hljs-selector-attr">[9.47997,47.10281]</span>,<span class="hljs-selector-attr">[9.932448,46.920728]</span>,<span class="hljs-selector-attr">[10.442701,46.893546]</span>,<span class="hljs-selector-attr">[10.363378,46.483571]</span>,<span class="hljs-selector-attr">[9.922837,46.314899]</span>,<span class="hljs-selector-attr">[9.182882,46.440215]</span>,<span class="hljs-selector-attr">[8.966306,46.036932]</span>,<span class="hljs-selector-attr">[8.489952,46.005151]</span>,<span class="hljs-selector-attr">[8.31663,46.163642]</span>,<span class="hljs-selector-attr">[7.755992,45.82449]</span>,<span class="hljs-selector-attr">[7.273851,45.776948]</span>,<span class="hljs-selector-attr">[6.843593,45.991147]</span>,<span class="hljs-selector-attr">[6.5001,46.429673]</span>,<span class="hljs-selector-attr">[6.022609,46.27299]</span>,<span class="hljs-selector-attr">[6.037389,46.725779]</span>,<span class="hljs-selector-attr">[6.768714,47.287708]</span>,<span class="hljs-selector-attr">[6.736571,47.541801]</span>,<span class="hljs-selector-attr">[7.192202,47.449766]</span>,<span class="hljs-selector-attr">[7.466759,47.620582]</span>,<span class="hljs-selector-attr">[8.317301,47.61358]</span>,<span class="hljs-selector-attr">[8.522612,47.830828]</span>,<span class="hljs-selector-attr">[9.594226,47.525058]</span>]]}},
{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">Feature</span>","<span class="hljs-selector-tag">id</span>":"<span class="hljs-selector-tag">CHL</span>","<span class="hljs-selector-tag">properties</span>":{"<span class="hljs-selector-tag">name</span>":"<span class="hljs-selector-tag">Chile</span>"},"<span class="hljs-selector-tag">geometry</span>":{"<span class="hljs-selector-tag">type</span>":"<span class="hljs-selector-tag">MultiPolygon</span>","<span class="hljs-selector-tag">coordinates</span>":<span class="hljs-selector-attr">[[[[-68.63401,-52.63637]</span>,<span class="hljs-selector-attr">[-68.63335,-54.8695]</span>,<span class="hljs-selector-attr">[-67.56244,-54.87001]</span>,<span class="hljs-selector-attr">[-66.95992,-54.89681]</span>,<span class="hljs-selector-attr">[-67.29103,-55.30124]</span>,<span class="hljs-selector-attr">[-68.14863,-55.61183]</span>,<span class="hljs-selector-attr">[-68.639991,-55.580018]</span>,<span class="hljs-selector-attr">[-69.2321,-55.49906]</span>,<span class="hljs-selector-attr">[-69.95809,-55.19843]</span>,<span class="hljs-selector-attr">[-71.00568,-55.05383]</span>,<span class="hljs-selector-attr">[-72.2639,-54.49514]</span>,<span class="hljs-selector-attr">[-73.2852,-53.95752]</span>,<span class="hljs-selector-attr">[-74.66253,-52.83749]</span>,<span class="hljs-selector-attr">[-73.8381,-53.04743]</span>,<span class="hljs-selector-attr">[-72.43418,-53.7154]</span>,<span class="hljs-selector-attr">[-71.10773,-54.07433]</span>,<span class="hljs-selector-attr">[-70.59178,-53.61583]</span>,<span class="hljs-selector-attr">[-70.26748,-52.93123]</span>,<span class="hljs-selector-attr">[-69.34565,-52.5183]</span>,<span class="hljs-selector-attr">[-68.63401,-52.63637]</span>]],<span class="hljs-selector-attr">[[[-68.219913,-21.494347]</span>,<span class="hljs-selector-attr">[-67.82818,-22.872919]</span>,<span class="hljs-selector-attr">[-67.106674,-22.735925]</span>,<span class="hljs-selector-attr">[-66.985234,-22.986349]</span>,<span class="hljs-selector-attr">[-67.328443,-24.025303]</span>,<span class="hljs-selector-attr">[-68.417653,-24.518555]</span>,<span class="hljs-selector-attr">[-68.386001,-26.185016]</span>,<span class="hljs-selector-attr">[-68.5948,-26.506909]</span>,<span class="hljs-selector-attr">[-68.295542,-26.89934]</span>,<span class="hljs-selector-attr">[-69.001235,-27.521214]</span>,<span class="hljs-selector-attr">[-69.65613,-28.459141]</span>,<span class="hljs-selector-attr">[-70.01355,-29.367923]</span>,<span class="hljs-selector-attr">[-69.919008,-30.336339]</span>,<span class="hljs-selector-attr">[-70.535069,-31.36501]</span>,<span class="hljs-selector-attr">[-70.074399,-33.09121]</span>,<span class="hljs-selector-attr">[-69.814777,-33.273886]</span>,<span class="hljs-selector-attr">[-69.817309,-34.193571]</span>,<span class="hljs-selector-attr">[-70.388049,-35.169688]</span>,<span class="hljs-selector-attr">[-70.364769,-36.005089]</span>,<span class="hljs-selector-attr">[-71.121881,-36.658124]</span>,<span class="hljs-selector-attr">[-71.118625,-37.576827]</span>,<span class="hljs-selector-attr">[-70.814664,-38.552995]</span>,<span class="hljs-selector-attr">[-71.413517,-38.916022]</span>,<span class="hljs-selector-attr">[-71.680761,-39.808164]</span>,<span class="hljs-selector-attr">[-71.915734,-40.832339]</span>,<span class="hljs-selector-attr">[-71.746804,-42.051386]</span>,<span class="hljs-selector-attr">[-72.148898,-42.254888]</span>,<span class="hljs-selector-attr">[-71.915424,-43.408565]</span>,<span class="hljs-selector-attr">[-71.464056,-43.787611]</span>,<span class="hljs-selector-attr">[-71.793623,-44.207172]</span>,<span class="hljs-selector-attr">[-71.329801,-44.407522]</span>,<span class="hljs-selector-attr">[-71.222779,-44.784243]</span>,<span class="hljs-selector-attr">[-71.659316,-44.973689]</span>,<span class="hljs-selector-attr">[-71.552009,-45.560733]</span>,<span class="hljs-selector-attr">[-71.917258,-46.884838]</span>,<span class="hljs-selector-attr">[-72.447355,-47.738533]</span>,<span class="hljs-selector-attr">[-72.331161,-48.244238]</span>,<span class="hljs-selector-attr">[-72.648247,-48.878618]</span>,<span class="hljs-selector-attr">[-73.415436,-49.318436]</span>,<span class="hljs-selector-attr">[-73.328051,-50.378785]</span>,<span class="hljs-selector-attr">[-72.975747,-50.74145]</span>,<span class="hljs-selector-attr">[-72.309974,-50.67701]</span>,<span class="hljs-selector-attr">[-72.329404,-51.425956]</span>,<span class="hljs-selector-attr">[-71.914804,-52.009022]</span>,<span class="hljs-selector-attr">[-69.498362,-52.142761]</span>,<span class="hljs-selector-attr">[-68.571545,-52.299444]</span>,<span class="hljs-selector-attr">[-69.461284,-52.291951]</span>,<span class="hljs-selector-attr">[-69.94278,-52.537931]</span>,<span class="hljs-selector-attr">[-70.845102,-52.899201]</span>,<span class="hljs-selector-attr">[-71.006332,-53.833252]</span>,<span class="hljs-selector-attr">[-71.429795,-53.856455]</span>,<span class="hljs-selector-attr">[-72.557943,-53.53141]</span>,<span class="hljs-selector-attr">[-73.702757,-52.835069]</span>,<span class="hljs-selector-attr">[-73.702757,-52.83507]</span>,<span class="hljs-selector-attr">[-74.946763,-52.262754]</span>,<span class="hljs-selector-attr">[-75.260026,-51.629355]</span>,<span class="hljs-selector-attr">[-74.976632,-51.043396]</span>,<span class="hljs-selector-attr">[-75.479754,-50.378372]</span>,<span class="hljs-selector-attr">[-75.608015,-48.673773]</span>,<span class="hljs-selector-attr">[-75.18277,-47.711919]</span>,<span class="hljs-selector-attr">[-74.126581,-46.939253]</span>,<span class="hljs-selector-attr">[-75.644395,-46.647643]</span>,<span class="hljs-selector-attr">[-74.692154,-45.763976]</span>,<span class="hljs-selector-attr">[-74.351709,-44.103044]</span>,<span class="hljs-selector-attr">[-73.240356,-44.454961]</span>,<span class="hljs-selector-attr">[-72.717804,-42.383356]</span>,<span class="hljs-selector-attr">[-73.3889,-42.117532]</span>,<span class="hljs-selector-attr">[-73.701336,-43.365776]</span>,<span class="hljs-selector-attr">[-74.331943,-43.224958]</span>,<span class="hljs-selector-attr">[-74.017957,-41.794813]</span>,<span class="hljs-selector-attr">[-73.677099,-39.942213]</span>,<span class="hljs-selector-attr">[-73.217593,-39.258689]</span>,<span class="hljs-selector-attr">[-73.505559,-38.282883]</span>,<span class="hljs-selector-attr">[-73.588061,-37.156285]</span>,<span class="hljs-selector-attr">[-73.166717,-37.12378]</span>,<span class="hljs-selector-attr">[-72.553137,-35.50884]</span>,<span class="hljs-selector-attr">[-71.861732,-33.909093]</span>,<span class="hljs-selector-attr">[-71.43845,-32.418899]</span>,<span class="hljs-selector-attr">[-71.668721,-30.920645]</span>,<span class="hljs-selector-attr">[-71.370083,-30.095682]</span>,<span class="hljs-selector-attr">[-71.489894,-28.861442]</span>,<span class="hljs-selector-attr">[-70.905124,-27.64038]</span>,<span class="hljs-selector-attr">[-70.724954,-25.705924]</span>,<span class="hljs-selector-attr">[-70.403966,-23.628997]</span>,<span class="hljs-selector-attr">[-70.091246,-21.393319]</span>,<span class="hljs-selector-attr">[-70.16442,-19.756468]</span>,<span class="hljs-selector-attr">[-70.372572,-18.347975]</span>,<span class="hljs-selector-attr">[-69.858444,-18.092694]</span>,<span class="hljs-selector-attr">[-69.590424,-17.580012]</span>,<span class="hljs-selector-attr">[-69.100247,-18.260125]</span>,<span class="hljs-selector-attr">[-68.966818,-18.981683]</span>,<span class="hljs-selector-attr">[-68.442225,-19.405068]</span>,<span class="hljs-selector-attr">[-68.757167,-20.372658]</span>,<span class="hljs-selector-attr">[-68.219913,-21.494347]</span>]]]}},
]}
</code></pre>
<h2 data-id="heading-3">3. å¯¼å…¥ä¾èµ–</h2>
<p><code>GeoJSON</code>ä½œä¸ºä¸€ç§çŸ¢é‡æ•°æ®æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨çŸ¢é‡åº“<code>OGR</code>è¿›è¡Œå¤„ç†ï¼Œä»¥å®ç°<code>GeoJSON</code>æ•°æ®ä»æ–‡æœ¬æ ¼å¼è½¬æ¢ä¸º<code>Shp</code>æ ¼å¼ã€‚å…¶ä¸­è¿˜æ¶‰åŠåæ ‡å®šä¹‰ï¼Œæ‰€ä»¥è¿˜éœ€è¦å¼•å…¥<code>osr</code>æ¨¡å—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">from</span>Â osgeoÂ <span class="hljs-keyword">import</span>Â ogr,osr
<span class="hljs-keyword">import</span>Â os
</code></pre>
<h2 data-id="heading-4">4. æ•°æ®è¯»å–ä¸è½¬æ¢</h2>
<p>å®šä¹‰ä¸€ä¸ªæ–¹æ³•<code>GeoJSON2Shp(geoPath,shpPath)</code>ç”¨äºå°†<code>GeoJSON</code>æ•°æ®è½¬æ¢ä¸º<code>Shp</code>æ•°æ®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
è¯´æ˜ï¼šå°†Â GeoJSONÂ æ–‡ä»¶è½¬æ¢ä¸ºÂ ShapfileÂ æ–‡ä»¶
å‚æ•°ï¼š
Â Â Â Â -geoPathï¼šGeoJSONÂ æ–‡ä»¶è·¯å¾„
Â Â Â Â -shpPathï¼šShpÂ æ–‡ä»¶è·¯å¾„
"""</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">GeoJSON2Shp</span>(<span class="hljs-params">geoPath,shpPath</span>):
</code></pre>
<p>åœ¨è¿›è¡Œ<code>GeoJSON</code>æ•°æ®æ ¼å¼è½¬æ¢ä¹‹å‰ï¼Œéœ€è¦æ£€æŸ¥æ•°æ®è·¯å¾„æ˜¯å¦å­˜åœ¨ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">#Â æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
<span class="hljs-keyword">if</span>Â <span class="hljs-built_in">os</span>.<span class="hljs-built_in">path</span>.exists(geoPath):
Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"GeoJSONÂ æ–‡ä»¶å­˜åœ¨ã€‚"</span>)
<span class="hljs-keyword">else</span>:
Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"GeoJSONÂ æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°é€‰æ‹©æ–‡ä»¶ï¼"</span>)
Â Â Â Â <span class="hljs-keyword">return</span>
</code></pre>
<p>æ‰“å¼€<code>GeoJSON</code>æ•°æ®ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â æ‰“å¼€JSONæ–‡ä»¶</span>
<span class="hljs-attr">jsonDataSource</span>Â =Â ogr.Open(geoPath)
<span class="hljs-attr">jsonLayer</span>Â =Â jsonDataSource.GetLayer()
</code></pre>
<p>ä½¿ç”¨<code>os.path.exists</code>æ–¹æ³•æ£€æŸ¥<code>Shp</code>æ–‡ä»¶æ˜¯å¦å·²ç»åˆ›å»ºï¼Œå¦‚æœå­˜åœ¨åˆ™å°†å…¶åˆ é™¤ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span>Â os.path.exists(shpPath):
Â Â Â Â <span class="hljs-keyword">try</span>:
Â Â Â Â Â Â Â Â shpDriver.DeleteDataSource(shpPath)
Â Â Â Â Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ–‡ä»¶å·²åˆ é™¤ï¼"</span>)
Â Â Â Â <span class="hljs-keyword">except</span>Â ExceptionÂ <span class="hljs-keyword">as</span>Â e:
Â Â Â Â Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ–‡ä»¶åˆ é™¤å‡ºé”™ï¼š<span class="hljs-subst">{e}</span>"</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">False</span>
</code></pre>
<p>é€šè¿‡<code>GetDriverByName</code>è·å–<code>Shp</code>æ•°æ®é©±åŠ¨ï¼Œå¹¶åˆ›å»º<code>Shp</code>æ•°æ®æºã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â åˆ›å»ºShpæ•°æ®æº</span>
<span class="hljs-attr">shpDriver</span>Â =Â ogr.GetDriverByName(<span class="hljs-string">"ESRIÂ Shapefile"</span>)
<span class="hljs-attr">shpDataSource</span>Â =Â shpDriver.CreateDataSource(shpPath)
</code></pre>
<p>æ·»åŠ <code>Shp</code>å›¾å±‚å±æ€§ã€‚è·å–æºæ•°æ®åæ ‡ç³»ã€å±æ€§å­—æ®µä»¥åŠå‡ ä½•å¯¹è±¡ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ°ç›®æ ‡å›¾å±‚ä¸­ã€‚å±æ€§ç»“æ„æ˜¾ç¤ºå¦‚ä¸‹ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f123ef5434cc4d1dad710c1ffb48788f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767619384&amp;x-signature=%2B4xZj01G5CrncOwDgdM8ncg%2FpL8%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â è·å–åæ ‡ç³»</span>
<span class="hljs-attr">srs</span>Â =Â jsonLayer.GetSpatialRef()

<span class="hljs-comment">#Â åˆ›å»ºShpæ•°æ®å›¾å±‚</span>
<span class="hljs-attr">shpLayer</span>Â =Â shpDataSource.CreateLayer(
Â Â Â Â "layer",
Â Â Â Â <span class="hljs-attr">srs</span>=srs,
Â Â Â Â <span class="hljs-attr">geom_type</span>=jsonLayer.GetGeomType()
)

<span class="hljs-comment">#Â è·å–å­—æ®µå±æ€§</span>
<span class="hljs-attr">layerDefn</span>Â =Â jsonLayer.GetLayerDefn()
forÂ iÂ inÂ range(layerDefn.GetFieldCount()):
Â Â Â Â <span class="hljs-attr">fieldDefn</span>Â =Â layerDefn.GetFieldDefn(i)
Â Â Â Â shpLayer.CreateField(fieldDefn)

<span class="hljs-comment">#Â è·å–å‡ ä½•å±æ€§</span>
forÂ featureÂ inÂ jsonLayer:
Â Â Â Â shpLayer.CreateFeature(feature)
</code></pre>
<p>åœ¨æ•°æ®è¯»å–å®Œæˆä¹‹åå…³é—­æ•°æ®æºã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â å…³é—­æ•°æ®æº</span>
<span class="hljs-attr">jsonDataSource</span>Â =Â shpDataSourceÂ =Â None
</code></pre>
<p>æ•°æ®è½¬æ¢å®Œæˆä¹‹ååœ¨<code>ArcMap</code>ä¸­æ‰“å¼€çš„æ˜¾ç¤ºæ•ˆæœï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93226aef513840bfac6fe98834b79590~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767619384&amp;x-signature=cxR97BsjasfnHzlEai79YIOivBk%3D" alt="" loading="lazy"/>æ•°æ®å±æ€§ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14d7e064233b4a89a32f900ce2c95382~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767619384&amp;x-signature=4243R2q9un3kSrjMH0wRAUqHUak%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆ"è™šæ‹Ÿç°å®"å’Œ"å¢å¼ºç°å®"ä¸åŒï¼Ÿâ€”â€”ä»è™šæ‹Ÿåˆ°æ··åˆçš„è§†è§‰é©å‘½]]></title>    <link>https://juejin.cn/post/7588971908227432482</link>    <guid>https://juejin.cn/post/7588971908227432482</guid>    <pubDate>2025-12-29T07:20:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588971908227432482" data-draft-id="7588999772749955107" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆ&quot;è™šæ‹Ÿç°å®&quot;å’Œ&quot;å¢å¼ºç°å®&quot;ä¸åŒï¼Ÿâ€”â€”ä»è™šæ‹Ÿåˆ°æ··åˆçš„è§†è§‰é©å‘½"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-29T07:20:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆ"è™šæ‹Ÿç°å®"å’Œ"å¢å¼ºç°å®"ä¸åŒï¼Ÿâ€”â€”ä»è™šæ‹Ÿåˆ°æ··åˆçš„è§†è§‰é©å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T07:20:23.000Z" title="Mon Dec 29 2025 07:20:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ•¶ï¸ ä¸ºä»€ä¹ˆ"è™šæ‹Ÿç°å®"å’Œ"å¢å¼ºç°å®"ä¸åŒï¼Ÿâ€”â€”ä»è™šæ‹Ÿåˆ°æ··åˆçš„è§†è§‰é©å‘½ ğŸŒˆ</h2>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ— é™å¤§ï¼Œæ¬¢è¿æ”¶çœ‹åä¸‡ä¸ªä¸ºä»€ä¹ˆç³»åˆ—æ–‡ç« </p>
<p>å¸Œæœ›ä»Šå¤©çš„å†…å®¹èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©</p>
</blockquote>
<p>ä»Šå¤©å’±ä»¬æ¥èŠèŠVRå’ŒARè¿™ä¸ª"è§†è§‰ç§‘æŠ€çš„åŒç”Ÿå­"ï¼æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æˆ´ç€å¤´æ˜¾åœ¨è™šæ‹Ÿä¸–ç•Œé‡Œæ‰“æ¸¸æˆï¼Œä»¿ä½›èº«ä¸´å…¶å¢ƒï¼›ä½ ç”¨æ‰‹æœºå¯¹ç€æ¡Œå­ï¼Œå±å¹•ä¸Šå‡ºç°ä¸€ä¸ª3Dæ¨¡å‹ï¼Œä»¿ä½›å®ƒçœŸçš„åœ¨æ¡Œå­ä¸Šâ€”â€”è¿™äº›ç‚«é…·çš„ä½“éªŒï¼Œéƒ½æ˜¯VRå’ŒARå¸¦æ¥çš„ï¼ä½†ä½ çŸ¥é“å®ƒä»¬çš„åŒºåˆ«å—ï¼Ÿ</p>
<h3 data-id="heading-1">ğŸ¤” æ ¸å¿ƒé—®é¢˜ï¼šVRå’ŒARçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬çš„æŠ€æœ¯åŸç†å’Œåº”ç”¨åœºæ™¯æœ‰ä½•ä¸åŒï¼Ÿ</h3>
<p>å¾ˆå¤šäººè§‰å¾—VRå’ŒARæ˜¯"ä¸€å›äº‹"ï¼Œå…¶å®å®ƒä»¬å·®åˆ«å¾ˆå¤§ï¼VRå°±åƒ"å®Œå…¨è¿›å…¥å¦ä¸€ä¸ªä¸–ç•Œ"ï¼Œè€ŒARæ˜¯"åœ¨ç°å®ä¸–ç•Œé‡ŒåŠ ä¸œè¥¿"ã€‚ä»Šå¤©å’±ä»¬å°±æ¥æ­å¼€å®ƒä»¬çš„ç¥ç§˜é¢çº±ï¼</p>
<h4 data-id="heading-2">VRå’ŒARçš„æœ¬è´¨</h4>
<ul>
<li>ğŸ® <strong>VRï¼ˆVirtual Realityï¼‰</strong>ï¼šè™šæ‹Ÿç°å®ï¼Œé€šè¿‡å¤´æ˜¾å®Œå…¨æ²‰æµ¸åœ¨è™šæ‹Ÿä¸–ç•Œä¸­ï¼Œä¸ç°å®ä¸–ç•Œéš”ç»</li>
<li>ğŸ” <strong>ARï¼ˆAugmented Realityï¼‰</strong>ï¼šå¢å¼ºç°å®ï¼Œåœ¨ç°å®ä¸–ç•Œçš„åŸºç¡€ä¸Šå åŠ è™šæ‹Ÿå†…å®¹ï¼Œè™šå®ç»“åˆ</li>
<li>ğŸŒ€ <strong>MRï¼ˆMixed Realityï¼‰</strong>ï¼šæ··åˆç°å®ï¼Œè™šæ‹Ÿå†…å®¹ä¸ç°å®ä¸–ç•Œæ·±åº¦èåˆï¼Œèƒ½äº¤äº’</li>
<li>ğŸŒ <strong>XRï¼ˆExtended Realityï¼‰</strong>ï¼šæ‰©å±•ç°å®ï¼Œæ˜¯VRã€ARã€MRçš„æ€»ç§°</li>
</ul>
<h3 data-id="heading-3">ğŸ“œ è§†è§‰æŠ€æœ¯çš„"è¿›åŒ–å²"ï¼šä»æ—©æœŸVRåˆ°XRèåˆ</h3>
<h4 data-id="heading-4">1. ğŸ“º æ—©æœŸVRè®¾å¤‡ï¼š"ç¬¨é‡çš„å¤´ç›”"ï¼ˆ1960s-1990sï¼‰</h4>
<p>1968å¹´ï¼Œä¼Šå‡¡Â·è‹æ³½å…°ï¼ˆIvan Sutherlandï¼‰å‘æ˜äº†ç¬¬ä¸€å°VRå¤´æ˜¾"è¾¾æ‘©å…‹åˆ©æ–¯ä¹‹å‰‘"ï¼ˆSword of Damoclesï¼‰ï¼Œå®ƒé‡è¾¾50å…¬æ–¤ï¼Œéœ€è¦æ‚¬æŒ‚åœ¨å¤©èŠ±æ¿ä¸Šä½¿ç”¨ã€‚</p>
<p>è¿™å°±åƒ"æˆ´äº†ä¸ªç”µè§†æœºåœ¨å¤´ä¸Š"ï¼Œç¬¨é‡åˆä¸å®ç”¨ï¼Œä½†å®ƒå¼€å¯äº†VRçš„å…ˆæ²³ï¼</p>
<h4 data-id="heading-5">2. ğŸ® æ¸¸æˆä¸»æœºæ—¶ä»£ï¼š"å®¶ç”¨VRèŒèŠ½"ï¼ˆ1990s-2010sï¼‰</h4>
<p>1995å¹´ï¼Œä»»å¤©å ‚æ¨å‡ºäº†Virtual Boyï¼Œè¿™æ˜¯ç¬¬ä¸€å°å®¶ç”¨VRæ¸¸æˆæœºã€‚ä½†å®ƒåªæœ‰çº¢è‰²æ˜¾ç¤ºï¼Œé‡é‡å¤§ï¼Œä½“éªŒå·®ï¼Œå¾ˆå¿«å°±å¤±è´¥äº†ã€‚</p>
<p>è¿™å°±åƒ"ä¸€ä¸ªä¼šå‘å…‰çš„çº¢ç›’å­"ï¼Œè™½ç„¶æœ‰åˆ›æ–°ï¼Œä½†æŠ€æœ¯è¿˜ä¸æˆç†Ÿã€‚</p>
<h4 data-id="heading-6">3. ğŸš€ ç°ä»£VRï¼š"æ²‰æµ¸å¼ä½“éªŒ"ï¼ˆ2012-2016ï¼‰</h4>
<p>2012å¹´ï¼ŒOculus RiftåŸå‹æœºå‘å¸ƒï¼Œ2016å¹´æ­£å¼ä¸Šå¸‚ã€‚åŒå¹´ï¼ŒHTC Viveã€PlayStation VRä¹Ÿç›¸ç»§å‘å¸ƒï¼ŒVRè¿›å…¥äº†"é»„é‡‘æ—¶ä»£"ã€‚</p>
<p>è¿™å°±åƒ"æ‰“å¼€äº†è™šæ‹Ÿä¸–ç•Œçš„å¤§é—¨"ï¼Œäººä»¬ç¬¬ä¸€æ¬¡çœŸæ­£ä½“éªŒåˆ°äº†æ²‰æµ¸å¼VRï¼</p>
<h4 data-id="heading-7">4. ğŸŒˆ ARæŠ€æœ¯å…´èµ·ï¼š"è™šå®ç»“åˆ"ï¼ˆ2016-è‡³ä»Šï¼‰</h4>
<p>2016å¹´ï¼ŒPokemon Goçˆ†ç«ï¼Œè®©ARæŠ€æœ¯èµ°è¿›äº†å¤§ä¼—è§†é‡ã€‚åŒå¹´ï¼Œå¾®è½¯å‘å¸ƒäº†HoloLensï¼Œè¿™æ˜¯ç¬¬ä¸€å°çœŸæ­£çš„MRå¤´æ˜¾ã€‚</p>
<p>è¿™å°±åƒ"ç»™ç°å®ä¸–ç•ŒåŠ äº†ä¸€å±‚æ»¤é•œ"ï¼Œè™šæ‹Ÿå†…å®¹å’Œç°å®ä¸–ç•Œå®Œç¾ç»“åˆï¼</p>
<h4 data-id="heading-8">5. ğŸŒ XRèåˆï¼š"æœªæ¥å·²æ¥"ï¼ˆ2020-è‡³ä»Šï¼‰</h4>
<p>ç°åœ¨ï¼ŒVRå’ŒARæŠ€æœ¯æ­£åœ¨èåˆï¼Œå‡ºç°äº†è¶Šæ¥è¶Šå¤šçš„XRè®¾å¤‡ï¼Œæ¯”å¦‚Meta Quest 3ã€Apple Vision Proç­‰ï¼Œå®ƒä»¬æ—¢èƒ½æä¾›æ²‰æµ¸å¼VRä½“éªŒï¼Œä¹Ÿèƒ½æä¾›å‡ºè‰²çš„ARä½“éªŒã€‚</p>
<p>è¿™å°±åƒ"è§†è§‰æŠ€æœ¯çš„ç‘å£«å†›åˆ€"ï¼Œé›†å„ç§åŠŸèƒ½äºä¸€èº«ï¼</p>
<h3 data-id="heading-9">ğŸ”§ æŠ€æœ¯åŸç†ï¼šVRå’ŒARçš„æ ¸å¿ƒæŠ€æœ¯</h3>
<h4 data-id="heading-10">1. ğŸ® VRçš„æŠ€æœ¯åŸç†ï¼š"å®Œå…¨æ²‰æµ¸"</h4>
<p>VRçš„æ ¸å¿ƒæ˜¯<strong>æ²‰æµ¸å¼æ˜¾ç¤º</strong>ï¼Œé€šè¿‡ä»¥ä¸‹æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>ğŸ–¥ï¸ <strong>åŒå±æ˜¾ç¤º</strong>ï¼šå·¦å³çœ¼æ˜¾ç¤ºç•¥æœ‰å·®å¼‚çš„ç”»é¢ï¼Œäº§ç”Ÿç«‹ä½“æ„Ÿ</li>
<li>ğŸ¯ <strong>å¤´éƒ¨è¿½è¸ª</strong>ï¼šå®æ—¶è¿½è¸ªå¤´éƒ¨ä½ç½®å’Œæ–¹å‘ï¼Œè°ƒæ•´æ˜¾ç¤ºå†…å®¹</li>
<li>ğŸ”Š <strong>ç©ºé—´éŸ³é¢‘</strong>ï¼šæ ¹æ®å¤´éƒ¨ä½ç½®è°ƒæ•´å£°éŸ³ï¼Œå¢å¼ºæ²‰æµ¸æ„Ÿ</li>
<li>ğŸ® <strong>äº¤äº’è®¾å¤‡</strong>ï¼šæ‰‹æŸ„ã€æ‰‹å¥—ã€èº«ä½“è¿½è¸ªå™¨ç­‰ï¼Œå®ç°è™šæ‹Ÿäº¤äº’</li>
</ul>
<h4 data-id="heading-11">2. ğŸ” ARçš„æŠ€æœ¯åŸç†ï¼š"è™šå®ç»“åˆ"</h4>
<p>ARçš„æ ¸å¿ƒæ˜¯<strong>åœ¨ç°å®ä¸–ç•Œä¸­å åŠ è™šæ‹Ÿå†…å®¹</strong>ï¼Œé€šè¿‡ä»¥ä¸‹æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>ğŸ“· <strong>æ‘„åƒå¤´</strong>ï¼šæ•æ‰ç°å®ä¸–ç•Œç”»é¢</li>
<li>ğŸ“ <strong>ç©ºé—´å®šä½</strong>ï¼šé€šè¿‡SLAMï¼ˆåŒæ­¥å®šä½ä¸åœ°å›¾æ„å»ºï¼‰æŠ€æœ¯ï¼Œç¡®å®šè®¾å¤‡åœ¨ç©ºé—´ä¸­çš„ä½ç½®</li>
<li>ğŸ¨ <strong>è™šæ‹Ÿå åŠ </strong>ï¼šå°†è™šæ‹Ÿå†…å®¹ç²¾ç¡®åœ°å åŠ åˆ°ç°å®ä¸–ç•Œä¸­</li>
<li>âœ‹ <strong>æ‰‹åŠ¿è¯†åˆ«</strong>ï¼šè¯†åˆ«ç”¨æˆ·æ‰‹åŠ¿ï¼Œå®ç°è‡ªç„¶äº¤äº’</li>
</ul>
<h4 data-id="heading-12">3. ğŸŒ€ MRçš„æŠ€æœ¯åŸç†ï¼š"æ·±åº¦èåˆ"</h4>
<p>MRæ˜¯VRå’ŒARçš„ç»“åˆï¼Œå®ƒä¸ä»…èƒ½å åŠ è™šæ‹Ÿå†…å®¹ï¼Œè¿˜èƒ½è®©è™šæ‹Ÿå†…å®¹ä¸ç°å®ä¸–ç•Œäº¤äº’ï¼Œæ¯”å¦‚è™šæ‹Ÿç‰©ä½“èƒ½è¢«ç°å®ç‰©ä½“é®æŒ¡ï¼Œèƒ½ä¸ç°å®ç‰©ä½“äº’åŠ¨ã€‚</p>
<h4 data-id="heading-13">4. <strong>ä»£ç å®ä¾‹</strong>ï¼šç”¨Pythonå’ŒOpenCVæ¨¡æ‹Ÿç®€å•çš„ARæ•ˆæœ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># åŠ è½½å›¾åƒï¼ˆä½œä¸ºè™šæ‹Ÿå†…å®¹ï¼‰</span>
virtual_image = cv2.imread(<span class="hljs-string">'cat.png'</span>)
<span class="hljs-comment"># å¦‚æœæ²¡æœ‰cat.pngï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ç”Ÿæˆä¸€ä¸ªå½©è‰²æ–¹å—</span>
<span class="hljs-comment"># virtual_image = np.zeros((100, 100, 3), dtype=np.uint8)</span>
<span class="hljs-comment"># virtual_image[:] = (0, 255, 0)  # ç»¿è‰²æ–¹å—</span>

<span class="hljs-comment"># åˆå§‹åŒ–æ‘„åƒå¤´</span>
cap = cv2.VideoCapture(<span class="hljs-number">0</span>)

<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    <span class="hljs-comment"># è¯»å–æ‘„åƒå¤´ç”»é¢</span>
    ret, frame = cap.read()
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:
        <span class="hljs-keyword">break</span>
    
    <span class="hljs-comment"># è·å–ç”»é¢å°ºå¯¸</span>
    h, w, _ = frame.shape
    
    <span class="hljs-comment"># å®šä¹‰ARå†…å®¹çš„ä½ç½®ï¼ˆå±å¹•ä¸­å¤®ï¼‰</span>
    ar_x = w // <span class="hljs-number">2</span> - <span class="hljs-number">50</span>
    ar_y = h // <span class="hljs-number">2</span> - <span class="hljs-number">50</span>
    
    <span class="hljs-comment"># è°ƒæ•´è™šæ‹Ÿå›¾åƒå¤§å°</span>
    virtual_resized = cv2.resize(virtual_image, (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>))
    
    <span class="hljs-comment"># å°†è™šæ‹Ÿå›¾åƒå åŠ åˆ°ç°å®ç”»é¢ä¸­</span>
    <span class="hljs-comment"># ç®€å•çš„å åŠ ï¼Œä¸è€ƒè™‘é€æ˜åº¦</span>
    frame[ar_y:ar_y+<span class="hljs-number">100</span>, ar_x:ar_x+<span class="hljs-number">100</span>] = virtual_resized
    
    <span class="hljs-comment"># æ·»åŠ æ–‡å­—è¯´æ˜</span>
    cv2.putText(frame, <span class="hljs-string">"ARæ•ˆæœæ¼”ç¤º"</span>, (<span class="hljs-number">10</span>, <span class="hljs-number">30</span>), 
               cv2.FONT_HERSHEY_SIMPLEX, <span class="hljs-number">1</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>), <span class="hljs-number">2</span>)
    cv2.putText(frame, <span class="hljs-string">"ç»¿è‰²æ–¹å—æ˜¯è™šæ‹Ÿå†…å®¹"</span>, (<span class="hljs-number">10</span>, <span class="hljs-number">60</span>), 
               cv2.FONT_HERSHEY_SIMPLEX, <span class="hljs-number">0.7</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>), <span class="hljs-number">2</span>)
    
    <span class="hljs-comment"># æ˜¾ç¤ºç»“æœ</span>
    cv2.imshow(<span class="hljs-string">'AR Demo'</span>, frame)
    
    <span class="hljs-comment"># æŒ‰ESCé”®é€€å‡º</span>
    <span class="hljs-keyword">if</span> cv2.waitKey(<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFF</span> == <span class="hljs-number">27</span>:
        <span class="hljs-keyword">break</span>

<span class="hljs-comment"># é‡Šæ”¾èµ„æº</span>
cap.release()
cv2.destroyAllWindows()
</code></pre>
<p><strong>è¿è¡Œç»“æœ</strong>ï¼š</p>
<ul>
<li>æ‘„åƒå¤´ç”»é¢ä¸­å¤®ä¼šæ˜¾ç¤ºä¸€ä¸ªç»¿è‰²æ–¹å—ï¼ˆæˆ–åŠ è½½çš„å›¾ç‰‡ï¼‰ï¼Œä»¿ä½›å®ƒçœŸçš„åœ¨ç°å®ä¸–ç•Œä¸­</li>
<li>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ARæ•ˆæœæ¼”ç¤ºï¼ŒçœŸå®çš„ARæŠ€æœ¯ä¼šæ›´å¤æ‚ï¼Œéœ€è¦ç©ºé—´å®šä½ã€SLAMç­‰æŠ€æœ¯</li>
</ul>
<h3 data-id="heading-14">ğŸ“Š è¶£å‘³å¯¹æ¯”ï¼šVR vs AR vs MR</h3>



























































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>VRï¼ˆè™šæ‹Ÿç°å®ï¼‰</th><th>ARï¼ˆå¢å¼ºç°å®ï¼‰</th><th>MRï¼ˆæ··åˆç°å®ï¼‰</th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒä½“éªŒ</strong></td><td>å®Œå…¨æ²‰æµ¸åœ¨è™šæ‹Ÿä¸–ç•Œ</td><td>åœ¨ç°å®ä¸–ç•Œä¸­å åŠ è™šæ‹Ÿå†…å®¹</td><td>è™šæ‹Ÿä¸ç°å®æ·±åº¦èåˆ</td></tr><tr><td><strong>è®¾å¤‡å½¢å¼</strong></td><td>å¤´æ˜¾ï¼ˆé®æŒ¡ç°å®ï¼‰</td><td>æ‰‹æœºã€çœ¼é•œï¼ˆé€æ˜æ˜¾ç¤ºï¼‰</td><td>é€æ˜å¤´æ˜¾</td></tr><tr><td><strong>äº¤äº’æ–¹å¼</strong></td><td>è™šæ‹Ÿæ‰‹æŸ„ã€æ‰‹åŠ¿</td><td>æ‰‹åŠ¿ã€è¯­éŸ³ã€è§¦æ‘¸</td><td>æ‰‹åŠ¿ã€è¯­éŸ³ã€ç°å®äº¤äº’</td></tr><tr><td><strong>ç©ºé—´æ„ŸçŸ¥</strong></td><td>è™šæ‹Ÿç©ºé—´</td><td>ç°å®ç©ºé—´+è™šæ‹Ÿå†…å®¹</td><td>ç°å®ç©ºé—´+è™šæ‹Ÿå†…å®¹+äº¤äº’</td></tr><tr><td><strong>ä»£è¡¨äº§å“</strong></td><td>Oculus Questã€HTC Vive</td><td>æ‰‹æœºARã€Google Glass</td><td>HoloLensã€Magic Leap</td></tr><tr><td><strong>å…¸å‹åº”ç”¨</strong></td><td>æ¸¸æˆã€è™šæ‹Ÿæ—…æ¸¸ã€åŸ¹è®­</td><td>å¯¼èˆªã€æ•™è‚²ã€è´­ç‰©</td><td>å·¥ä¸šè®¾è®¡ã€åŒ»ç–—æ‰‹æœ¯ã€ç»´ä¿®</td></tr><tr><td><strong>æŠ€æœ¯éš¾åº¦</strong></td><td>ä¸­</td><td>é«˜</td><td>æé«˜</td></tr><tr><td><strong>å¸‚åœºæˆç†Ÿåº¦</strong></td><td>è¾ƒæˆç†Ÿ</td><td>å¿«é€Ÿå‘å±•</td><td>èµ·æ­¥é˜¶æ®µ</td></tr></tbody></table>
<h3 data-id="heading-15">ğŸ¢ VRå’ŒARçš„åº”ç”¨åœºæ™¯ï¼š"æ”¹å˜å„è¡Œå„ä¸š"</h3>
<p>VRå’ŒARå·²ç»æ¸—é€åˆ°æˆ‘ä»¬ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ï¼Œè¢«ç§°ä¸º"ä¸‹ä¸€ä»£è®¡ç®—å¹³å°"ï¼š</p>


















































<table><thead><tr><th>åº”ç”¨é¢†åŸŸ</th><th>VRåº”ç”¨</th><th>ARåº”ç”¨</th></tr></thead><tbody><tr><td>ğŸ® <strong>æ¸¸æˆå¨±ä¹</strong></td><td>æ²‰æµ¸å¼æ¸¸æˆã€è™šæ‹Ÿæ¼”å”±ä¼š</td><td>Pokemon Goã€ARæ»¤é•œã€è™šæ‹Ÿå® ç‰©</td></tr><tr><td>ğŸ« <strong>æ•™è‚²</strong></td><td>è™šæ‹Ÿè¯¾å ‚ã€å†å²é‡ç°ã€ç§‘å­¦å®éªŒ</td><td>3Dæ¨¡å‹å±•ç¤ºã€äº¤äº’å¼å­¦ä¹ ã€è™šæ‹Ÿæ•™å…·</td></tr><tr><td>ğŸ¥ <strong>åŒ»ç–—å¥åº·</strong></td><td>æ‰‹æœ¯åŸ¹è®­ã€å¿ƒç†æ²»ç–—ã€ç–¼ç—›ç®¡ç†</td><td>æ‰‹æœ¯å¯¼èˆªã€åŒ»å­¦å½±åƒå åŠ ã€è¿œç¨‹åŒ»ç–—</td></tr><tr><td>ğŸ­ <strong>å·¥ä¸šåˆ¶é€ </strong></td><td>è™šæ‹Ÿè®¾è®¡ã€å·¥å‚æ¨¡æ‹Ÿã€å‘˜å·¥åŸ¹è®­</td><td>è®¾å¤‡ç»´ä¿®ã€é›¶ä»¶è¯†åˆ«ã€è£…é…æŒ‡å¯¼</td></tr><tr><td>ğŸ›ï¸ <strong>é›¶å”®è´­ç‰©</strong></td><td>è™šæ‹Ÿè¯•è¡£ã€è™šæ‹Ÿå±•å…ã€å®¶å±…è®¾è®¡</td><td>è™šæ‹Ÿè¯•å¦†ã€ARå¯¼è´­ã€äº§å“ä¿¡æ¯æŸ¥è¯¢</td></tr><tr><td>ğŸ—ºï¸ <strong>å¯¼èˆªå‡ºè¡Œ</strong></td><td>è™šæ‹Ÿé©¾é©¶ã€é£è¡Œæ¨¡æ‹Ÿã€è™šæ‹Ÿæ—…æ¸¸</td><td>å®æ—¶å¯¼èˆªã€æ™¯ç‚¹ä»‹ç»ã€ARç¿»è¯‘</td></tr><tr><td>ğŸ‘· <strong>å»ºç­‘å·¥ç¨‹</strong></td><td>è™šæ‹Ÿå»ºç­‘ã€æ–½å·¥æ¨¡æ‹Ÿã€å®‰å…¨åŸ¹è®­</td><td>å»ºç­‘è®¾è®¡å¯è§†åŒ–ã€æ–½å·¥è¿›åº¦ç›‘æ§</td></tr><tr><td>ğŸ¬ <strong>å½±è§†ä¼ åª’</strong></td><td>360Â°è§†é¢‘ã€è™šæ‹Ÿå½±é™¢</td><td>ARå¹¿å‘Šã€äº¤äº’å¼ç”µå½±ã€è™šæ‹Ÿè§’è‰²</td></tr></tbody></table>
<h3 data-id="heading-16">âš ï¸ å¸¸è§è¯¯åŒºçº æ­£</h3>
<h4 data-id="heading-17">1. "VRå’ŒARæ˜¯ä¸€å›äº‹ï¼Ÿ"</h4>
<p>ä¸ï¼VRæ˜¯å®Œå…¨æ²‰æµ¸åœ¨è™šæ‹Ÿä¸–ç•Œï¼ŒARæ˜¯åœ¨ç°å®ä¸–ç•Œå åŠ è™šæ‹Ÿå†…å®¹ï¼Œå®ƒä»¬çš„æ ¸å¿ƒä½“éªŒå’ŒæŠ€æœ¯åŸç†éƒ½ä¸åŒã€‚</p>
<h4 data-id="heading-18">2. "VRä¼šè®©äººä¸Šç˜¾ï¼Ÿ"</h4>
<p>ä¸ä¸€å®šï¼VRåªæ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå°±åƒæ‰‹æœºã€ç”µè„‘ä¸€æ ·ï¼Œåˆç†ä½¿ç”¨ä¸ä¼šä¸Šç˜¾ã€‚ä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½ä¼šå¯¼è‡´çœ¼ç›ç–²åŠ³ã€å¤´æ™•ç­‰ä¸é€‚ã€‚</p>
<h4 data-id="heading-19">3. "ARæŠ€æœ¯è¿˜ä¸æˆç†Ÿï¼Ÿ"</h4>
<p>ä¸ï¼ARæŠ€æœ¯å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œæ¯”å¦‚æ‰‹æœºARã€Google Lensç­‰ï¼Œéƒ½å·²ç»å¹¿æ³›åº”ç”¨ã€‚åªæ˜¯MRæŠ€æœ¯è¿˜åœ¨å‘å±•ä¸­ã€‚</p>
<h4 data-id="heading-20">4. "VRå¤´æ˜¾å¾ˆé‡ï¼Ÿ"</h4>
<p>æ—©æœŸçš„VRå¤´æ˜¾ç¡®å®å¾ˆé‡ï¼Œä½†ç°åœ¨çš„å¤´æ˜¾å·²ç»å¾ˆè½»ä¾¿äº†ï¼Œæ¯”å¦‚Meta Quest 3åªæœ‰515å…‹ï¼Œæ¯”å¾ˆå¤šæ‰‹æœºè¿˜è½»ã€‚</p>
<h4 data-id="heading-21">5. "ARå¿…é¡»æˆ´çœ¼é•œï¼Ÿ"</h4>
<p>ä¸ï¼æ‰‹æœºARä¸éœ€è¦æˆ´çœ¼é•œï¼Œåªéœ€è¦ç”¨æ‰‹æœºæ‘„åƒå¤´å°±èƒ½ä½“éªŒã€‚å½“ç„¶ï¼ŒARçœ¼é•œä¼šæä¾›æ›´å¥½çš„ä½“éªŒã€‚</p>
<h4 data-id="heading-22">6. "VRä¼šä¼¤å®³çœ¼ç›ï¼Ÿ"</h4>
<p>åˆç†ä½¿ç”¨ä¸ä¼šï¼VRå¤´æ˜¾éƒ½æœ‰è“å…‰è¿‡æ»¤ã€è‡ªåŠ¨äº®åº¦è°ƒèŠ‚ç­‰åŠŸèƒ½ï¼Œåªè¦æ§åˆ¶ä½¿ç”¨æ—¶é—´ï¼Œä¸ä¼šä¼¤å®³çœ¼ç›ã€‚</p>
<h3 data-id="heading-23">ğŸ”® æœªæ¥å±•æœ›ï¼šVRå’ŒARçš„å‘å±•è¶‹åŠ¿</h3>
<h4 data-id="heading-24">1. ğŸ“± <strong>æ›´è½»ä¾¿çš„è®¾å¤‡</strong></h4>
<p>æœªæ¥çš„VR/ARè®¾å¤‡ä¼šè¶Šæ¥è¶Šè½»ä¾¿ï¼Œç”šè‡³å¯èƒ½åƒæ™®é€šçœ¼é•œä¸€æ ·ï¼Œä½©æˆ´èˆ’é€‚ï¼Œå¤–è§‚æ—¶å°šã€‚</p>
<h4 data-id="heading-25">2. ğŸ¤– <strong>æ›´æ™ºèƒ½çš„äº¤äº’</strong></h4>
<p>æ‰‹åŠ¿è¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ã€çœ¼åŠ¨è¿½è¸ªç­‰æŠ€æœ¯ä¼šè¶Šæ¥è¶Šæˆç†Ÿï¼Œäº¤äº’ä¼šå˜å¾—æ›´åŠ è‡ªç„¶ï¼Œç”šè‡³ä¸éœ€è¦æ‰‹æŸ„ã€‚</p>
<h4 data-id="heading-26">3. ğŸŒ <strong>æ›´ä¸°å¯Œçš„å†…å®¹</strong></h4>
<p>éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒVR/ARå†…å®¹ä¼šè¶Šæ¥è¶Šä¸°å¯Œï¼Œä»æ¸¸æˆåˆ°æ•™è‚²ï¼Œä»å¨±ä¹åˆ°å·¥ä½œï¼Œæ¶µç›–å„ä¸ªé¢†åŸŸã€‚</p>
<h4 data-id="heading-27">4. ğŸ”— <strong>æ›´å¥½çš„äº’è”æ€§</strong></h4>
<p>VR/ARè®¾å¤‡ä¼šä¸æ‰‹æœºã€ç”µè„‘ã€æ™ºèƒ½å®¶å±…ç­‰è®¾å¤‡æ›´å¥½åœ°äº’è”ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç”Ÿæ€ç³»ç»Ÿã€‚</p>
<h4 data-id="heading-28">5. ğŸ“Š <strong>æ›´å¹¿æ³›çš„åº”ç”¨</strong></h4>
<p>VR/ARæŠ€æœ¯ä¼šåº”ç”¨åˆ°æ›´å¤šé¢†åŸŸï¼Œæ¯”å¦‚è¿œç¨‹åŠå…¬ã€è™šæ‹Ÿä¼šè®®ã€æ•°å­—å­ªç”Ÿç­‰ï¼Œæˆä¸ºæˆ‘ä»¬ç”Ÿæ´»å’Œå·¥ä½œçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<h4 data-id="heading-29">6. ğŸ’° <strong>æ›´ä½çš„ä»·æ ¼</strong></h4>
<p>éšç€æŠ€æœ¯çš„æˆç†Ÿå’Œé‡äº§ï¼ŒVR/ARè®¾å¤‡çš„ä»·æ ¼ä¼šè¶Šæ¥è¶Šä½ï¼Œæ™®åŠåº¦ä¼šè¶Šæ¥è¶Šé«˜ã€‚</p>
<h3 data-id="heading-30">ğŸ“ äº’åŠ¨å°æµ‹éªŒï¼šä½ ç­”å¯¹äº†å—ï¼Ÿ</h3>


















































<table><thead><tr><th>é—®é¢˜</th><th>ç­”æ¡ˆ</th><th>ä½ ç­”å¯¹äº†å—ï¼Ÿ</th></tr></thead><tbody><tr><td>VRçš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ</td><td>æ²‰æµ¸å¼æ˜¾ç¤º</td><td>âœ…/âŒ</td></tr><tr><td>ARçš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ</td><td>åœ¨ç°å®ä¸–ç•Œä¸­å åŠ è™šæ‹Ÿå†…å®¹</td><td>âœ…/âŒ</td></tr><tr><td>MRæ˜¯VRå’ŒARçš„ç»“åˆå—ï¼Ÿ</td><td>æ˜¯çš„</td><td>âœ…/âŒ</td></tr><tr><td>2025å¹´VR/ARå¸‚åœºè§„æ¨¡é¢„è®¡æ˜¯å¤šå°‘ï¼Ÿ</td><td>2500äº¿ç¾å…ƒ</td><td>âœ…/âŒ</td></tr><tr><td>ARè®¾å¤‡å‡ºè´§é‡ä¼šè¶…è¿‡VRè®¾å¤‡å—ï¼Ÿ</td><td>æ˜¯çš„</td><td>âœ…/âŒ</td></tr><tr><td>SLAMæŠ€æœ¯åœ¨VR/ARä¸­çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</td><td>ç©ºé—´å®šä½</td><td>âœ…/âŒ</td></tr><tr><td>ä»£è¡¨MRè®¾å¤‡çš„æ˜¯ï¼Ÿ</td><td>HoloLens</td><td>âœ…/âŒ</td></tr><tr><td>VRå¤´æ˜¾ä¼šé®æŒ¡ç°å®ä¸–ç•Œå—ï¼Ÿ</td><td>æ˜¯çš„</td><td>âœ…/âŒ</td></tr></tbody></table>
<h3 data-id="heading-31">ğŸ¯ ç»“è¯­ï¼šè§†è§‰é©å‘½çš„æœªæ¥</h3>
<p>VRå’ŒARæŠ€æœ¯æ­£åœ¨æ”¹å˜æˆ‘ä»¬æ„ŸçŸ¥ä¸–ç•Œçš„æ–¹å¼ï¼Œä»å®Œå…¨è™šæ‹Ÿåˆ°è™šå®ç»“åˆï¼Œå†åˆ°æ·±åº¦èåˆï¼Œå®ƒä»¬è®©æˆ‘ä»¬çš„ç”Ÿæ´»å’Œå·¥ä½œå˜å¾—æ›´åŠ ä¸°å¯Œå¤šå½©ã€‚</p>
<p>è™½ç„¶VRå’ŒARè¿˜æœ‰ä¸€äº›æŒ‘æˆ˜éœ€è¦å…‹æœï¼Œæ¯”å¦‚è®¾å¤‡é‡é‡ã€å†…å®¹è´¨é‡ã€ä»·æ ¼ç­‰ï¼Œä½†éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œå®ƒä»¬ä¸€å®šä¼šæˆä¸ºæˆ‘ä»¬ç”Ÿæ´»ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ä¸‹æ¬¡å½“ä½ ä½¿ç”¨VRå¤´æ˜¾æ‰“æ¸¸æˆï¼Œæˆ–è€…ç”¨æ‰‹æœºä½“éªŒARæ•ˆæœæ—¶ï¼Œä¸å¦¨æƒ³æƒ³èƒŒåçš„æŠ€æœ¯åŸç†ï¼Œæ„Ÿå—ä¸€ä¸‹è§†è§‰é©å‘½çš„é­…åŠ›ï¼</p>
<hr/>
<h3 data-id="heading-32">ğŸ’¬ äº’åŠ¨è¯é¢˜</h3>
<ol>
<li>ä½ ä½“éªŒè¿‡VRæˆ–ARå—ï¼Ÿæ„Ÿè§‰å¦‚ä½•ï¼Ÿ</li>
<li>ä½ è§‰å¾—VRå’ŒARå“ªä¸ªæ›´æœ‰å‰é€”ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
<li>ä½ æœ€æœŸå¾…VR/ARåœ¨å“ªä¸ªé¢†åŸŸçš„åº”ç”¨ï¼Ÿ</li>
<li>ä½ ä¼šè´­ä¹°Apple Vision Proæˆ–Meta Quest 3å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
</ol>
<p>å¿«æ¥è¯„è®ºåŒºèŠèŠä½ çš„æƒ³æ³•ï¼ğŸ’¬ ç‚¹èµæ”¶è—ä¸è¿·è·¯ï¼Œå’±ä»¬ä¸‹æœŸç»§ç»­æ¢ç´¢è®¡ç®—æœºçš„"åä¸‡ä¸ªä¸ºä»€ä¹ˆ"ï¼ğŸ‰</p>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼Œä¸‹æœŸå¸¦ä½ è§£é”æ›´å¤šè®¡ç®—æœºçš„"å¥‡è‘©å†·çŸ¥è¯†"ï¼ğŸ¤“</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSåº”ç”¨å¼€å‘ï¼šçŠ¶æ€æ åŠ¨ç”»å®ç°]]></title>    <link>https://juejin.cn/post/7589172193150386212</link>    <guid>https://juejin.cn/post/7589172193150386212</guid>    <pubDate>2025-12-29T14:38:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589172193150386212" data-draft-id="7589172193150369828" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSåº”ç”¨å¼€å‘ï¼šçŠ¶æ€æ åŠ¨ç”»å®ç°"/> <meta itemprop="keywords" content="HarmonyOS,ç¨‹åºå‘˜,Android"/> <meta itemprop="datePublished" content="2025-12-29T14:38:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹¿äººæˆ›"/> <meta itemprop="url" content="https://juejin.cn/user/4309685005226376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSåº”ç”¨å¼€å‘ï¼šçŠ¶æ€æ åŠ¨ç”»å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4309685005226376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹¿äººæˆ›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T14:38:18.000Z" title="Mon Dec 29 2025 14:38:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>æœ¬æ¡ˆä¾‹å±•ç¤ºäº†çŠ¶æ€æ çš„åŠ¨æ€äº¤äº’æ•ˆæœã€‚é€šè¿‡ç›‘å¬é¡µé¢æ»šåŠ¨äº‹ä»¶ <code>onDidScroll</code>ï¼Œéšç€é¡µé¢çš„ä¸Šä¸‹æ»šåŠ¨ï¼Œå®ç°çŠ¶æ€æ é¢œè‰²çš„å˜åŒ–ã€‚æœç´¢æ¡†ä¼šåœ¨æ»šåŠ¨æ—¶æµç•…åœ°å±•å¼€æˆ–æ”¶èµ·ï¼Œå¹¶ä¼´æœ‰è‡ªç„¶çš„é€æ˜åº¦è¿‡æ¸¡æ•ˆæœã€‚</p>
<h3 data-id="heading-1">æ•ˆæœå›¾é¢„è§ˆ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3064042edec1412ea719171e33071a4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bm_5Lq65oib:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767623898&amp;x-signature=KyMi6HGBLfyLqFqwm1pqVlnuTjQ%3D" alt="" loading="lazy"/></p>
<p><strong>ä½¿ç”¨è¯´æ˜</strong></p>
<ol>
<li>è¿›å…¥é¡µé¢å¼€å§‹åŠ è½½ï¼ŒåŠ è½½å®Œæˆåæ˜¾ç¤ºæ•´ä¸ªç•Œé¢,ä¸Šä¸‹æ»šåŠ¨é¡µé¢å³å¯ã€‚</li>
</ol>
<h3 data-id="heading-2">å®ç°æ€è·¯</h3>
<ul>
<li>
<p><strong>åˆå§‹åŒ–å’ŒçŠ¶æ€è®¾ç½®</strong><br/>
åœ¨ <code>aboutToAppear()</code> æ–¹æ³•ä¸­ï¼Œåˆå§‹åŒ–äº†çª—å£æ¨¡å‹ <code>windowModel</code>ã€‚å¯ç”¨æ²‰æµ¸å¼ï¼ˆè®¾ç½®å…¨å±æ˜¾ç¤ºå’ŒçŠ¶æ€æ ä¸ºç™½è‰²ï¼‰ï¼Œè·å–çŠ¶æ€æ é«˜åº¦å­˜å‚¨åœ¨ <code>statusBarHeight</code> å˜é‡ä¸­ï¼Œä»é¢„å®šä¹‰çš„æ•°æ®æº <code>LIST_DATA</code> åŠ è½½æ•°æ®åˆ° <code>dataSource</code>ä¸­ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">aboutToAppear(): void {
  <span class="hljs-comment">// åˆå§‹åŒ–çª—å£ç®¡ç†model</span>
  <span class="hljs-keyword">const</span> windowStage: window.WindowStage | undefined = AppStorage.<span class="hljs-keyword">get</span>(<span class="hljs-string">'windowStage'</span>);
  <span class="hljs-comment">// æ²¡æœ‰windowStageå°†æ— æ³•æ‰§è¡Œä¸‹åˆ—é€»è¾‘</span>
  <span class="hljs-keyword">if</span> (!windowStage) {
    logger.error(TAG, <span class="hljs-string">'windowStage init error!'</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">this</span>.windowModel.setWindowStage(windowStage);
  <span class="hljs-comment">// è®¾ç½®æ²‰æµ¸æ¨¡å¼åŠçŠ¶æ€æ ç™½è‰²</span>
  <span class="hljs-keyword">this</span>.windowModel.setImmersive();
  <span class="hljs-comment">// è·å–é¡¶éƒ¨çŠ¶æ€æ é«˜åº¦</span>
  <span class="hljs-keyword">this</span>.windowModel.getStatusBarHeight((statusBarHeight) =&gt; {
    logger.info(TAG, <span class="hljs-string">'statusBarHeight is '</span> + statusBarHeight);
    <span class="hljs-keyword">this</span>.statusBarHeight = px2vp(statusBarHeight);
  })
  <span class="hljs-comment">// ç»„è£…æ•°æ®æº</span>
  <span class="hljs-keyword">this</span>.dataSource.pushArrayData(LIST_DATA)
}
</code></pre>
</li>
<li>
<p><strong>ç•Œé¢å¸ƒå±€æ„é€ </strong><br/>
ä½¿ç”¨Stackæ§ä»¶ä½¿çŠ¶æ€æ ä¸åˆ—è¡¨é‡å ï¼Œå¹¶ä¸ºåˆ—è¡¨æ·»åŠ æ»šåŠ¨ç›‘å¬å™¨ï¼Œä»¥æ ¹æ®æ»šåŠ¨ä½ç½®è°ƒæ•´çŠ¶æ€æ å’Œå¯¼èˆªæ çš„é€æ˜åº¦åŠå±•å¼€æ”¶èµ·åŠ¨æ•ˆã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">Stack</span>({ alignContent: Alignment.Top }) {
  <span class="hljs-built_in">Row</span>() {
    <span class="hljs-comment">// åŠ¨æ€æ˜¾ç¤ºå›é¡¶éƒ¨æˆ–ä½ç½®å¤©æ°”æ§ä»¶</span>
    if (this.isFlow) {
      this<span class="hljs-selector-class">.topUpBuilder</span>()
    } else {
      this<span class="hljs-selector-class">.locationAndWeatherBuilder</span>()
    }
    this<span class="hljs-selector-class">.searchViewBuilder</span>()
    this<span class="hljs-selector-class">.toolViewBuilder</span>()
  }
  <span class="hljs-selector-class">.height</span>(Constants.NAVIGATION_BAR_HEIGHT + this.statusBarHeight)
    <span class="hljs-selector-class">.width</span>(Constants.FULL_PERCENT)
    <span class="hljs-selector-class">.padding</span>({
      top: this.statusBarHeight
    })
    <span class="hljs-selector-class">.zIndex</span>(Constants.Z_INDEX_THREE)

  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> çŸ¥è¯†ç‚¹ï¼šçˆ¶ç»„ä»¶çš„é€æ˜åº¦Opacityå½±å“å­ç»„ä»¶ï¼ˆå¦‚çˆ¶ç±»Opacityä¸º0.5ï¼Œè‹¥å­ç»„ä»¶ä¸º0.5æ—¶ï¼Œå­ç»„ä»¶å®é™…Opacity = 0.5*0.5ï¼‰,æ­¤å¤„Rowæ¥æ”¹å˜çŠ¶æ€æ çš„é€æ˜åº¦ä¸å—å½±å“å…¶å®ƒç»„ä»¶é€æ˜åº¦</span>
  <span class="hljs-built_in">Row</span>() {
  }
  <span class="hljs-selector-class">.backgroundColor</span>($r("app.color.status_bar_animation_white"))
    <span class="hljs-selector-class">.opacity</span>(this.navigateBarOpacity)
    <span class="hljs-selector-class">.height</span>(Constants.STATUS_BAR_HEIGHT + this.statusBarHeight)
    <span class="hljs-selector-class">.width</span>(Constants.FULL_PERCENT)
    <span class="hljs-selector-class">.zIndex</span>(Constants.Z_INDEX_TWO)

  <span class="hljs-built_in">List</span>({ scroller: this.scroller }) {
    <span class="hljs-comment">// ...</span>
  }
  <span class="hljs-comment">// éšè—æ»šåŠ¨æ¡</span>
  <span class="hljs-selector-class">.scrollBar</span>(BarState.Off)
    <span class="hljs-comment">// æ¸å˜è“è‰²èƒŒæ™¯è‰²</span>
    <span class="hljs-selector-class">.linearGradient</span>({
      colors: [[Constants.LIST_LINEAR_GRADIENT_START_COLOR, Constants.LIST_LINEAR_GRADIENT_START],
        [Constants.LIST_LINEAR_GRADIENT_END_COLOR, Constants.LIST_LINEAR_GRADIENT_END]]
    })
    <span class="hljs-selector-class">.height</span>(Constants.FULL_PERCENT)
    <span class="hljs-selector-class">.width</span>(Constants.FULL_PERCENT)
}
<span class="hljs-selector-class">.zIndex</span>(Constants.Z_INDEX_ONE)
  <span class="hljs-selector-class">.height</span>(Constants.FULL_PERCENT)
  <span class="hljs-selector-class">.width</span>(Constants.FULL_PERCENT)
    <span class="hljs-comment">// æ‰©å±•è‡³æ‰€æœ‰éå®‰å…¨åŒºåŸŸ</span>
  <span class="hljs-selector-class">.expandSafeArea</span>([SafeAreaType.SYSTEM], [SafeAreaEdge.BOTTOM])
</code></pre>
</li>
<li>
<p><strong>æ»šåŠ¨äº‹ä»¶å¤„ç†</strong><br/>
é€šè¿‡ç›‘å¬é¡µé¢æ»šåŠ¨äº‹ä»¶ <code>onDidScroll</code>ï¼Œæ ¹æ®å½“å‰çš„æ»šåŠ¨åç§»é‡ yOffset è°ƒæ•´çŠ¶æ€æ å’Œå¯¼èˆªæ çš„é€æ˜åº¦ã€‚å¦‚æœæ»šåŠ¨è¶…è¿‡äº†è®¾å®šçš„é˜ˆå€¼ï¼Œåˆ™æ”¹å˜çŠ¶æ€æ çš„é¢œè‰²å’Œå±•å¼€æ”¶èµ·åŠ¨ç”»ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">.onDidScroll(() =&gt; {
  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> çŸ¥è¯†ç‚¹ï¼šé€šè¿‡currentOffsetæ¥è·å–åç§»é‡æ¯”è¾ƒå‡†ç¡®ã€‚</span>
  <span class="hljs-keyword">const</span> yOffset: number = <span class="hljs-keyword">this</span>.scroller.currentOffset().yOffset;
  yOffset &lt;= Constants.MAIN_SCROLLER_OFFSET_Y_ZERO ? <span class="hljs-keyword">this</span>.negativeOffsetY = yOffset :
  Constants.MAIN_SCROLLER_OFFSET_Y_ZERO;
  <span class="hljs-comment">// åˆ¤æ–­å¯¼èˆªæ å’ŒçŠ¶æ€æ èƒŒæ™¯é€æ˜åº¦å˜åŒ–</span>
  yOffset &gt;= Constants.MAIN_SCROLLER_OFFSET_Y_MAX + <span class="hljs-keyword">this</span>.statusBarHeight ?
    <span class="hljs-keyword">this</span>.navigateBarOpacity = Constants.NAVIGATION_BAR_OPACITY_MAX :
    <span class="hljs-keyword">this</span>.navigateBarOpacity = Constants.NAVIGATION_BAR_OPACITY_MIN;
  <span class="hljs-keyword">this</span>.navigateBarOpacity = yOffset / Constants.MAIN_SCROLLER_OFFSET_Y_MAX;
  <span class="hljs-comment">// åˆ¤æ–­å½“å‰çš„å¯¼èˆªæ å’Œå›¾æ ‡é¢œè‰²å˜åŒ–</span>
  yOffset &gt; <span class="hljs-keyword">this</span>.statusBarHeight ?
    <span class="hljs-keyword">this</span>.isWhiteColor = <span class="hljs-literal">false</span> : <span class="hljs-keyword">this</span>.isWhiteColor = <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// åˆ¤æ–­çŠ¶æ€æ å­—ä½“é¢œè‰²å˜åŒ–</span>
  yOffset &gt; <span class="hljs-keyword">this</span>.statusBarHeight ?
  <span class="hljs-keyword">this</span>.windowModel.setSystemBarContentColor(Constants.StatusBarContentBlackColor) :
  <span class="hljs-keyword">this</span>.windowModel.setSystemBarContentColor(Constants.StatusBarContentWhiteColor);
  <span class="hljs-comment">// åˆ¤æ–­å¯¼èˆªæ åŠ¨æ•ˆå˜åŒ–</span>
  yOffset &gt;= <span class="hljs-keyword">this</span>.statusBarHeight + Constants.MAIN_SCROLLER_OFFSET_STATUS_CHANGE ?
    <span class="hljs-keyword">this</span>.isFlow = <span class="hljs-literal">true</span> : <span class="hljs-keyword">this</span>.isFlow = <span class="hljs-literal">false</span>;
})
</code></pre>
</li>
</ul>
<h3 data-id="heading-3">æ€»ç»“</h3>
<p>æœ¬ç¤ºä¾‹ä½¿ç”¨äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-references-V5%2Fts-rendering-control-lazyforeach-V5" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-rendering-control-lazyforeach-V5" ref="nofollow noopener noreferrer">LazyForEach</a>è¿›è¡Œæ•°æ®æ‡’åŠ è½½ï¼ŒLazyForEachæ‡’åŠ è½½å¯ä»¥é€šè¿‡è®¾ç½®cachedCountå±æ€§æ¥æŒ‡å®šç¼“å­˜æ•°é‡ï¼ŒåŒæ—¶æ­é…<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fbest-practices-V5%2Fbpta-component-reuse-V5" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/best-practices-V5/bpta-component-reuse-V5" ref="nofollow noopener noreferrer">ç»„ä»¶å¤ç”¨</a>èƒ½åŠ›ä»¥è¾¾åˆ°æ€§èƒ½æœ€ä¼˜æ•ˆæœã€‚</p>
<h4 data-id="heading-4">å¦‚æœæ‚¨æƒ³ç³»ç»Ÿæ·±å…¥åœ°å­¦ä¹  HarmonyOS å¼€å‘æˆ–æƒ³è€ƒå–HarmonyOSè®¤è¯è¯ä¹¦ï¼Œæ¬¢è¿åŠ å…¥åä¸ºå¼€å‘è€…å­¦å ‚ï¼š</h4>
<h3 data-id="heading-5">è¯·ç‚¹å‡»â†’ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2Fd0d15d9039414a8fad9f99ac4a3f5096%3Ftype%3D1%253Fha_source%253Dhmosclass%26ha_sourceId%3D89000248" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/d0d15d9039414a8fad9f99ac4a3f5096?type=1%3Fha_source%3Dhmosclass&amp;ha_sourceId=89000248" ref="nofollow noopener noreferrer">HarmonyOSå®˜æ–¹è®¤è¯åŸ¹è®­</a></h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d55a567a43d2464eba118ff249eb75db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bm_5Lq65oib:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767623898&amp;x-signature=mUGp%2FgSDfDrDFk2Gj8P10%2B6AnFQ%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€LangChainå­¦ä¹ ç¬”è®°ã€‘æ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7589386961648435235</link>    <guid>https://juejin.cn/post/7589386961648435235</guid>    <pubDate>2025-12-30T07:04:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589386961648435235" data-draft-id="7589308109640925219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€LangChainå­¦ä¹ ç¬”è®°ã€‘æ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T07:04:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æ³¥ç§è·èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289442030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€LangChainå­¦ä¹ ç¬”è®°ã€‘æ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289442030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æ³¥ç§è·èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:04:13.000Z" title="Tue Dec 30 2025 07:04:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">åŸºç¡€åˆ›å»ºï¼šç®€æ˜“æ™ºèƒ½ä½“</h2>
<h3 data-id="heading-1">æ ¸å¿ƒä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># å¤§æ¨¡å‹åˆå§‹åŒ–</span>
model = ChatOpenAI(
    model_name=<span class="hljs-string">"qwen-plus"</span>,
    base_url=<span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span>,
    api_key=<span class="hljs-string">"sk-94207ea3eb4b44eaae46683ed8ac55e5"</span>,
)

<span class="hljs-comment"># ä½¿ç”¨create_agentå‡½æ•°åˆ›å»ºæ™ºèƒ½ä½“ï¼Œå°†å‰é¢åˆå§‹åŒ–çš„æ¨¡å‹ä½œä¸ºå‚æ•°ä¼ å…¥</span>
agent = create_agent(model=model)

<span class="hljs-comment"># é€šè¿‡æ™ºèƒ½ä½“çš„invokeæ–¹æ³•å‘èµ·è°ƒç”¨ï¼Œä¼ å…¥æ„é€ å¥½çš„è¾“å…¥æ•°æ®</span>
response = agent.invoke({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"human"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"1+1=?"</span>}]})

<span class="hljs-comment"># æ‰“å°æ™ºèƒ½ä½“å“åº”æ¶ˆæ¯åˆ—è¡¨ä¸­æœ€åä¸€æ¡æ¶ˆæ¯çš„å†…å®¹</span>
<span class="hljs-built_in">print</span>(response[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content)
</code></pre>
<h3 data-id="heading-2">åºŸå¼ƒå‡½æ•°æé†’</h3>
<ul>
<li>æœ€æ–°ç‰ˆæœ¬ LangChain ä¸­ï¼Œæ— æ³•é€šè¿‡ <code>langchain.agents.initialize_agent</code> å‡½æ•°åˆ›å»ºæ™ºèƒ½ä½“ï¼›</li>
<li><code>langgraph.prebuilt.create_react_agent</code> å‡½æ•°åŒæ ·å·²è¢«åºŸå¼ƒï¼Œä¸å»ºè®®ç»§ç»­ä½¿ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-3">å®æˆ˜å®ä¾‹ï¼šæ™ºèƒ½ä½“åˆ›å»ºç½‘é¡µ</h2>
<h3 data-id="heading-4">åŠŸèƒ½è¯´æ˜</h3>
<p>åˆ›å»ºç»‘å®šæ–‡ä»¶ç®¡ç†å·¥å…·çš„æ™ºèƒ½ä½“ï¼Œå®ç°æ ¹æ®ç”¨æˆ·æŒ‡å®šä¸»é¢˜ï¼Œè‡ªåŠ¨ç¼–å†™å¹¶ç”Ÿæˆ HTML ç½‘é¡µæ–‡ä»¶ï¼ŒåŒæ—¶è¿”å›ç»“æ„åŒ– JSON æ ¼å¼å“åº”ã€‚</p>
<h3 data-id="heading-5">å®Œæ•´ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> (
    ChatPromptTemplate,
    SystemMessagePromptTemplate,
    HumanMessagePromptTemplate,
)

<span class="hljs-comment"># ä»langchain_community.agent_toolkitsæ¨¡å—å¯¼å…¥FileManagementToolkitç±»ï¼Œç”¨äºè·å–æ–‡ä»¶ç®¡ç†å·¥å…·é›†</span>
<span class="hljs-keyword">from</span> langchain_community.agent_toolkits <span class="hljs-keyword">import</span> FileManagementToolkit
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> JsonOutputParser
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># å¤§æ¨¡å‹åˆå§‹åŒ–</span>
model = ChatOpenAI(
    model_name=<span class="hljs-string">"qwen-plus"</span>,
    base_url=<span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span>,
    api_key=<span class="hljs-string">"[ä½ çš„API Key]"</span>,
)

<span class="hljs-comment"># å®šä¹‰ç³»ç»Ÿæ¶ˆæ¯æç¤ºæ¨¡æ¿å†…å®¹</span>
system_message_prompt_template = SystemMessagePromptTemplate.from_template(
    <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å‰ç«¯å¼€å‘ï¼Œä½ å¯ä»¥æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ï¼Œç¼–å†™å‰ç«¯ä»£ç ã€‚"</span>
)

<span class="hljs-comment"># å®šä¹‰ç”¨æˆ·æ¶ˆæ¯æç¤ºæ¨¡æ¿å†…å®¹</span>
human_message_prompt_template = HumanMessagePromptTemplate.from_template(
    <span class="hljs-string">"å¸®æˆ‘ç¼–å†™ä¸€ä¸ªä¸»é¢˜ä¸º{topic}çš„htmlæ–‡ä»¶ï¼Œæœ€åè¿”å›jsonæ ¼å¼çš„ç»“æœï¼Œæ ¼å¼ä¸º{format_instructions}ã€‚"</span>
)

<span class="hljs-comment"># ä½¿ç”¨BaseModelå®šä¹‰ä¸€ä¸ªåä¸ºResponseFormatçš„æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseFormat</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    code: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œ1è¡¨ç¤ºå¤±è´¥"</span>)
    message: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"è¿”å›çš„æ¶ˆæ¯"</span>)

<span class="hljs-comment"># ä½¿ç”¨JsonOutputParserç±»åˆå§‹åŒ–ä¸€ä¸ªJSONè¾“å‡ºè§£æå™¨ï¼Œå¹¶å…³è”ResponseFormatæ•°æ®æ¨¡å‹</span>
json_parser = JsonOutputParser(
    pydantic_object=ResponseFormat,
)

<span class="hljs-comment"># ä½¿ç”¨ChatPromptTemplateç±»çš„from_messagesæ–¹æ³•åˆ›å»ºèŠå¤©æç¤ºæ¨¡æ¿ï¼Œç”±ç³»ç»Ÿæ¶ˆæ¯æç¤ºæ¨¡æ¿å’Œç”¨æˆ·æ¶ˆæ¯æç¤ºæ¨¡æ¿ç»„æˆ</span>
chat_prompt_template = ChatPromptTemplate.from_messages(
    [system_message_prompt_template, human_message_prompt_template]
)

<span class="hljs-comment"># ä½¿ç”¨partialæ–¹æ³•ä¸ºèŠå¤©æç¤ºæ¨¡æ¿é¢„å¡«å……å˜é‡</span>
chat_prompt_template = chat_prompt_template.partial(
    format_instructions=json_parser.get_format_instructions()
)

<span class="hljs-comment"># åˆ›å»ºæ™ºèƒ½ä½“ï¼Œä¼ å…¥åˆå§‹åŒ–åçš„æ¨¡å‹ä»¥åŠFileManagementToolkitè·å–çš„å·¥å…·é›†</span>
agent = create_agent(
    model=model, tools=FileManagementToolkit(root_dir=os.getcwd()).get_tools()
)

<span class="hljs-comment"># é€šè¿‡æ™ºèƒ½ä½“çš„invokeæ–¹æ³•å‘èµ·è°ƒç”¨ï¼Œä¼ å…¥æ„é€ å¥½çš„è¾“å…¥æ•°æ®</span>
response = agent.invoke(
    {<span class="hljs-string">"messages"</span>: chat_prompt_template.format_messages(topic=<span class="hljs-string">"é™å¤œæ€"</span>)},
)

<span class="hljs-built_in">print</span>(response[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elastic å³ä»£ç ï¼šè‡ªåŠ¨åŒ–çš„ä¸åªæ˜¯åŸºç¡€è®¾æ–½]]></title>    <link>https://juejin.cn/post/7589214643500941375</link>    <guid>https://juejin.cn/post/7589214643500941375</guid>    <pubDate>2025-12-30T06:30:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589214643500941375" data-draft-id="7589214643500924991" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elastic å³ä»£ç ï¼šè‡ªåŠ¨åŒ–çš„ä¸åªæ˜¯åŸºç¡€è®¾æ–½"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-30T06:30:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elastic å³ä»£ç ï¼šè‡ªåŠ¨åŒ–çš„ä¸åªæ˜¯åŸºç¡€è®¾æ–½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T06:30:31.000Z" title="Tue Dec 30 2025 06:30:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ªÂ  ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Fu%2Fkylerozanitis" title="https://discuss.elastic.co/u/kylerozanitis" target="_blank" ref="nofollow noopener noreferrer">kylerozanitis</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f78b4acbe9e348d6a2dbacbdb464a0a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767681031&amp;x-signature=vH5Kf%2BOFhXgutkHTPMFIboUuZJ8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">Elastic å³ä»£ç ï¼šè‡ªåŠ¨åŒ–ä¸åªæ˜¯åŸºç¡€è®¾æ–½</h2>
<p>Terraform æ˜¯å·¥ç¨‹å¸ˆå¸¸ç”¨çš„å·¥å…·ï¼Œç”¨æ¥é€šè¿‡ä¸€ç§å« Infrastructure as Codeï¼ˆ IaC ï¼‰çš„æ¨¡å¼åˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤åŸºç¡€è®¾æ–½ã€‚å®ƒé€šå¸¸ç”¨äºç®¡ç†äº‘èµ„æºï¼Œæ¯”å¦‚åº”ç”¨è´Ÿè½½å‡è¡¡å™¨ï¼ˆ ALB ï¼‰ã€æ•°æ®åº“å’Œè™šæ‹Ÿæœºï¼Œä½†å®ƒåŒæ ·ä¹Ÿå¯ä»¥ç”¨æ¥ç®¡ç† Elastic é›†ç¾¤ã€‚ä¸è¿‡ï¼Œåœ¨å¾ˆå¤š Elastic ç¯å¢ƒä¸­ï¼Œé›†ç¾¤åˆ›å»ºä¹‹åçš„æ‰€æœ‰äº‹æƒ…éƒ½å‘ç”Ÿåœ¨ Kibana é‡Œ â€”â€” ç´¢å¼•æ¨¡æ¿ã€ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆ ILM ï¼‰ç­–ç•¥ã€æ£€æµ‹è§„åˆ™ç­‰ç­‰ã€‚</p>
<p>è¿™ä¼šå¯¼è‡´æ²¡æœ‰æºç æ§åˆ¶ã€æ— æ³•å›æ»šå˜æ›´ã€æ— æ³•è¿›è¡Œæ¼‚ç§»æ£€æµ‹ï¼Œä¹Ÿæ²¡æœ‰å…³äºè°åœ¨ä»€ä¹ˆæ—¶å€™ã€ä¸ºä»€ä¹ˆä¿®æ”¹äº†ä»€ä¹ˆçš„å®¡è®¡è®°å½•ã€‚</p>
<p>Elastic æ˜¯ä¸€ä¸ª API é©±åŠ¨çš„å¹³å°ï¼Œè¿™æ„å‘³ç€ä½ åœ¨ Kibana ä¸­å‡ ä¹èƒ½åšçš„æ‰€æœ‰äº‹æƒ…ï¼Œä¹Ÿéƒ½å¯ä»¥é€šè¿‡ APIs æ¥å®Œæˆã€‚è¿™è¡¨ç¤ºæˆ‘ä»¬ä¸ä»…å¯ä»¥æŠŠåŸºç¡€è®¾æ–½ä½œä¸ºä»£ç æ¥ç®¡ç†ï¼Œè¿˜å¯ä»¥æŠŠæ›´å¤šå†…å®¹ä»£ç åŒ–ï¼Œä»è€Œè·å¾—å¯å¤ç°çš„ç¯å¢ƒã€å¯å®¡è®¡æ€§ï¼Œä»¥åŠå¯¹æ•´ä¸ªæŠ€æœ¯æ ˆçš„ä¿¡å¿ƒã€‚</p>
<p>åœ¨ä»Šå¤©çš„åšå®¢ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•åªç”¨ä¸€æ¡ terraform apply å‘½ä»¤ï¼Œå°±èƒ½åˆ›å»ºä¸€ä¸ª Elastic Cloud é›†ç¾¤ã€ä¸€ä¸ª ILM ç­–ç•¥ã€ä¸€ä¸ªç´¢å¼•æ¨¡æ¿ä»¥åŠä¸€ä¸ªæ£€æµ‹è§„åˆ™ â€”â€” æ‰€æœ‰å†…å®¹éƒ½åœ¨ Git ä¸­è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚</p>
<h2 data-id="heading-1">ç†å¿µ</h2>
<p>å½“ä½ åˆšå¼€å§‹ä½¿ç”¨ Elasticã€å­¦ä¹ æŸä¸ªåŠŸèƒ½å¦‚ä½•å·¥ä½œï¼Œæˆ–è€…è°ƒè¯•ä¸€ä¸ªç”¨äº detection rule çš„ ES|QL æŸ¥è¯¢æ—¶ï¼ŒKibana éå¸¸å¥½ç”¨ã€‚ä½†æœ€ç»ˆçš„ç›®æ ‡ï¼Œåº”è¯¥æ˜¯å°½å¯èƒ½æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½ä½œä¸ºä»£ç æ¥ç®¡ç†ã€‚è¿™è®©ä½ å¯ä»¥è‡ªç”±å®éªŒï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿ rollback åˆ°ä¸€ä¸ªå¯ç”¨çš„ç‰ˆæœ¬ã€‚å®ƒä¹Ÿç¡®ä¿ä» DEV åˆ° PROD çš„å˜æ›´æ˜¯ç»è¿‡ review å’Œ approval çš„ã€‚å°±åƒå‘å¸ƒä¸€ä¸ªæ–°çš„åº”ç”¨ä»£ç ç‰ˆæœ¬å¯èƒ½æ˜¯ç¾éš¾æ€§çš„ï¼Œå¯¹ Security Operations Center ( SOC ) ä¸­è¿è¡Œçš„ detection rule è¿›è¡Œä¿®æ”¹ï¼ŒåŒæ ·å¯èƒ½éå¸¸å±é™©ã€‚</p>
<p>Elastic ä¸ºå¹³å°çš„å‡ ä¹æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½æš´éœ²äº† APIã€‚å› æ­¤ï¼Œé€šè¿‡ç»“åˆ Terraform Elastic Cloud Provider å’Œ Elastic Stack Providerï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå¯å¤ç°çš„ Elastic-as-Code å·¥ä½œæµï¼Œç”¨æ¥éƒ¨ç½²ä¸€ä¸ª cloud clusterã€ILM ç­–ç•¥ã€index templateï¼Œä»¥åŠ detection ruleã€‚</p>
<h3 data-id="heading-2">ç¬¬ 1 æ­¥ï¼šéƒ¨ç½²ä¸€ä¸ª Elastic Cloud é›†ç¾¤</h3>
<p>ä½¿ç”¨ Elastic Cloud providerï¼Œåœ¨ä½ çš„æ ¹ main.tf æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ª ec_deployment resourceï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  resource "ec_deployment" "demo" {
<span class="hljs-attr">2.    name</span>                   = <span class="hljs-string">"advent-demo"</span>
<span class="hljs-attr">3.    region</span>                 = <span class="hljs-string">"us-east-1"</span>
<span class="hljs-attr">4.    version</span>                = <span class="hljs-string">"9.2.2"</span>
<span class="hljs-attr">5.    deployment_template_id</span> = <span class="hljs-string">"aws-cpu-optimized-faster-warm-arm"</span>

<span class="hljs-attr">7.    elasticsearch</span> = {
<span class="hljs-attr">8.      hot</span> = {
<span class="hljs-attr">9.        autoscaling</span> = {}
10.      }
11.    }

<span class="hljs-attr">13.    kibana</span> = {
<span class="hljs-attr">14.      topology</span> = {}
15.    }
16.  }

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>è¿™ä¼šåˆ›å»ºä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„ Elastic Cloud éƒ¨ç½²ã€‚è¯·æ³¨æ„ï¼Œå³ä½¿æ²¡æœ‰æ˜¾å¼æŒ‡å®š hot å±‚èŠ‚ç‚¹è§„æ ¼ï¼Œä»ç„¶éœ€è¦åŒ…å« <code>hot = { autoscaling = {} }</code>ã€‚å…³äºéƒ¨ç½²æ¨¡æ¿çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ Deployment templates æ–‡æ¡£ã€‚</p>
<h3 data-id="heading-3">ç¬¬ 2 æ­¥ï¼šå®šä¹‰ä¸€ä¸ª ILM ç­–ç•¥</h3>
<p>ä½¿ç”¨ Elasticstack providerï¼Œé€šè¿‡ <code>elasticstack_elasticsearch_index_lifecycle</code> èµ„æºæ¥å®šä¹‰ä¸€ä¸ª ILM ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">`

<span class="hljs-number">1.</span>  resource <span class="hljs-string">"elasticstack_elasticsearch_index_lifecycle"</span> <span class="hljs-string">"advent_logs_ilm"</span> {
<span class="hljs-number">2.</span>    name = <span class="hljs-string">"advent-logs-ilm"</span>
<span class="hljs-number">3.</span>    <span class="hljs-keyword">delete</span> {
<span class="hljs-number">4.</span>      min_age = <span class="hljs-string">"30d"</span>

<span class="hljs-number">6.</span>      <span class="hljs-keyword">delete</span> {}
<span class="hljs-number">7.</span>    }
<span class="hljs-number">8.</span>  }

`AIå†™ä»£ç 
</code></pre>
<p>ä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™ä¸ª ILM ç­–ç•¥ä¼šå°†æ•°æ®ä¿ç•™åœ¨ hot å±‚ 30 å¤©ï¼Œç„¶ååˆ é™¤ã€‚ç”¨ä»£ç æ¥ç®¡ç† ILM ç­–ç•¥éå¸¸æœ‰ä»·å€¼ï¼Œå› ä¸ºæ”¹åŠ¨å¯èƒ½ä¼šå¯¹æ•°æ®ä»¥åŠæ•´ä¸ªé›†ç¾¤å¥åº·äº§ç”Ÿè¿é”å½±å“ã€‚æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä¸€ä½å·¥ç¨‹å¸ˆå†³å®šæ·»åŠ ä¸€ä¸ª cold å±‚ï¼Œè®¾ç½®ä¸º 1 ä¸ª primary shard å’Œ 1 ä¸ª replica shardï¼Œä½†å®é™…ä¸Šåªæœ‰ä¸€ä¸ª cold èŠ‚ç‚¹ã€‚ä½ å¯ä»¥æƒ³è±¡ï¼Œå¾ˆå¿«å°±ä¼šå¼€å§‹çœ‹åˆ°è­¦å‘Šã€‚</p>
<h3 data-id="heading-4">ç¬¬ 3 æ­¥ï¼šç»‘å®š ILM çš„ Index Template</h3>
<p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ elasticstack_elasticsearch_index_template èµ„æºæ¥å®šä¹‰æˆ‘ä»¬çš„ index templateï¼Œå¹¶å¼•ç”¨å‰ä¸€æ­¥ä¸­å®šä¹‰çš„ ILM ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  resource "elasticstack_elasticsearch_index_template" "advent_logs_template" {
<span class="hljs-attr">2.    name</span>           = <span class="hljs-string">"advent-logs-template"</span>
<span class="hljs-attr">3.    index_patterns</span> = [<span class="hljs-string">"advent-logs-*"</span>]
<span class="hljs-attr">4.    priority</span>       = <span class="hljs-number">200</span>

6.    template {
<span class="hljs-attr">7.      settings</span> = jsonencode({
<span class="hljs-attr">8.        index</span> = {
<span class="hljs-attr">9.          lifecycle</span> = {
<span class="hljs-attr">10.            name</span> = <span class="hljs-string">"advent-logs-ilm"</span>
11.          }
12.        }
13.      })

<span class="hljs-attr">15.      mappings</span> = jsonencode({
<span class="hljs-attr">16.        properties</span> = {
<span class="hljs-attr">17.          "@timestamp"</span> = {
<span class="hljs-attr">18.            type</span> = <span class="hljs-string">"date"</span>
19.          }
<span class="hljs-attr">20.          "message"</span> = {
<span class="hljs-attr">21.            type</span> = <span class="hljs-string">"text"</span>
22.          }
<span class="hljs-attr">23.          "user"</span> = {
<span class="hljs-attr">24.            type</span> = <span class="hljs-string">"keyword"</span>
25.          }
26.        }
27.      })
28.    }
29.  }

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<h3 data-id="heading-5">æ­¥éª¤ 4ï¼šæ£€æµ‹è§„åˆ™</h3>
<p>ä½œä¸ºä¸€ä¸ªç»å¸¸ä½¿ç”¨æ£€æµ‹è§„åˆ™æ¥å¤„ç†ä»ä¼ ç»Ÿ SIEM åˆ°æ›´å¤æ‚æ¬ºè¯ˆç”¨ä¾‹çš„äººæ¥è¯´ï¼ŒDiscover å’Œ Kibana Detection Rules æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç»„åˆï¼Œä½†ä¸€æ—¦ä½ ç¡®å®šäº†æœ€ç»ˆé…ç½®ï¼Œæœ€å¥½ä½¿ç”¨ elasticstack_kibana_security_detection_rule èµ„æºæŠŠå®ƒå­˜å‚¨åˆ° Git ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  resource "elasticstack_kibana_security_detection_rule" "failed_login_rule" {
<span class="hljs-attr">2.    name</span>        = <span class="hljs-string">"Multiple Failed Logins (Elastic as Code demo)"</span>
<span class="hljs-attr">3.    description</span> = <span class="hljs-string">"Detects multiple failed login events in advent-logs indices for the Elastic-as-Code demo."</span>
<span class="hljs-attr">4.    rule_id</span>     = <span class="hljs-string">"advent-multiple-failed-logins"</span>

6.    <span class="hljs-comment"># Detection logic</span>
<span class="hljs-attr">7.    type</span>     = <span class="hljs-string">"query"</span>
<span class="hljs-attr">8.    query</span>    = <span class="hljs-string">"event.action:\"failed-login\""</span>
<span class="hljs-attr">9.    language</span> = <span class="hljs-string">"kuery"</span>
<span class="hljs-attr">10.    index</span>  = [<span class="hljs-string">"advent-logs-*"</span>]

12.    <span class="hljs-comment"># Scheduling</span>
<span class="hljs-attr">13.    from</span>     = <span class="hljs-string">"now-5m"</span>
<span class="hljs-attr">14.    to</span>       = <span class="hljs-string">"now"</span>
<span class="hljs-attr">15.    interval</span> = <span class="hljs-string">"5m"</span>

17.    <span class="hljs-comment"># Risk/severity</span>
<span class="hljs-attr">18.    severity</span>   = <span class="hljs-string">"medium"</span>
<span class="hljs-attr">19.    risk_score</span> = <span class="hljs-number">50</span>

21.    <span class="hljs-comment"># Misc metadata</span>
<span class="hljs-attr">22.    enabled</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">23.    tags</span>    = [<span class="hljs-string">"terraform"</span>, <span class="hljs-string">"advent-demo"</span>, <span class="hljs-string">"elastic-as-code"</span>]
<span class="hljs-attr">24.    author</span> = [<span class="hljs-string">"Kyle Rozanitis"</span>]

26.    <span class="hljs-comment"># Human context field</span>
<span class="hljs-attr">27.    license</span>         = <span class="hljs-string">"Elastic License v2"</span>
<span class="hljs-attr">28.    false_positives</span> = [<span class="hljs-string">"Legitimate user mistyping their password during normal usage"</span>]
<span class="hljs-attr">29.    references</span>      = [<span class="hljs-string">"https://elastic.github.io/detection-rules-explorer/"</span>]
<span class="hljs-attr">30.    note</span>            = <span class="hljs-string">"Investigate source IP, username, and host. Check for brute force behavior."</span>
<span class="hljs-attr">31.    setup</span>           = <span class="hljs-string">"Ensure authentication events are indexed into 'advent-logs-*'."</span>
32.  }

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<h3 data-id="heading-6">ç¬¬ 5 æ­¥ï¼šè®©ä¸€åˆ‡çœŸæ­£è¿è¡Œèµ·æ¥</h3>
<p>ä½ çš„ä»£ç ä»“åº“ç°åœ¨çœ‹èµ·æ¥åº”è¯¥åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">`

<span class="hljs-bullet">1.</span>  â”œâ”€â”€ main.tf
<span class="hljs-bullet">2.</span>  â”œâ”€â”€ ilm.tf
<span class="hljs-bullet">3.</span>  â”œâ”€â”€ template.tf
<span class="hljs-bullet">4.</span>  â”œâ”€â”€ rule.tf

`AIå†™ä»£ç 
</code></pre>
<p>ç°åœ¨åªéœ€è¿è¡Œï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`terraform apply`</span>AIå†™ä»£ç 
</code></pre>
<p>Terraform ä¼šåˆ›å»ºï¼š</p>
<ul>
<li>ä¸€ä¸ªæ–°çš„ Elastic Cloud é›†ç¾¤</li>
<li>ä¸€ä¸ª ILM ç­–ç•¥</li>
<li>ä¸€ä¸ªä¸è¯¥ ILM ç­–ç•¥å…³è”çš„ç´¢å¼•æ¨¡æ¿</li>
<li>ä¸€ä¸ªæ£€æµ‹è§„åˆ™</li>
</ul>
<p>è¿™å°±æ˜¯ Elastic å¹³å°åº”æœ‰çš„ä½¿ç”¨æ–¹å¼ã€‚</p>
<h2 data-id="heading-7">ç»“è¯­</h2>
<p>å¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œæ„Ÿè°¢é˜…è¯»ï¼æ‰€æœ‰å†…å®¹éƒ½å¯ä»¥åœ¨åä¸º <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkylerozanitis36%2Felastic-as-code%2Ftree%2Fmain" title="https://github.com/kylerozanitis36/elastic-as-code/tree/main" target="_blank" ref="nofollow noopener noreferrer">elastic-as-code</a> çš„ GitHub ä»“åº“ä¸­æ‰¾åˆ°ã€‚åªéœ€å…‹éš†ä»“åº“ï¼Œåˆ›å»ºä¸€ä¸ª Elastic Cloud API key å¹¶è·å–ä½ çš„ Organization IDï¼Œå°†å®ƒä»¬æ·»åŠ åˆ° .env æ–‡ä»¶ä¸­ï¼Œå®‰è£… Terraformï¼Œç„¶åè¿è¡Œ terraform applyã€‚</p>
<p>ä»Šå¤©çš„ç›®æ ‡æ˜¯å±•ç¤ºå¦‚ä½•ç”¨ Terraform ç®¡ç†è¿œä¸æ­¢äº‘åŸºç¡€è®¾æ–½ã€‚åœ¨æˆ‘çš„ä¸ªäººç¯å¢ƒä¸­ï¼Œæˆ‘ç”šè‡³ä¼šè¿›ä¸€æ­¥åˆ›å»º JSON æ–‡ä»¶æ¥ç®¡ç†å°šæœªæœ‰ Terraform èµ„æºçš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¼‚å¸¸æ£€æµ‹ä»»åŠ¡ã€‚ç”±äº Elastic åœ¨ Kibana å’Œ API ä¹‹é—´æä¾›äº†åŠŸèƒ½ä¸€è‡´æ€§ï¼Œä½ å¯ä»¥è½»æ¾è‡ªåŠ¨åŒ–åˆ›å»ºå…¶ä½™èµ„æºã€‚</p>
<p>èƒ½å¤Ÿå›æ»šé”™è¯¯æ›´æ”¹ã€åœ¨æ›´æ–°å‰è¿›è¡ŒåŒè¡Œè¯„å®¡ã€é€šè¿‡åˆ†æ”¯ä» DEV â†’ STAGING â†’ PRODã€æ£€æµ‹å¹³å°æ¼‚ç§»ï¼Œä»¥åŠç”¨å•æ¡å‘½ä»¤é‡å»ºæ•´ä¸ªæ ˆï¼Œè¿™äº›éƒ½æ˜¯éå¸¸å¼ºå¤§çš„èƒ½åŠ›ã€‚</p>
<p>è‡ªåŠ¨åŒ–æ„‰å¿«ï¼ŒèŠ‚æ—¥å¿«ä¹ï¼</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Ft%2Fdec-7th-2025-en-elastic-as-code-automating-more-than-just-infrastructure%2F383587" title="https://discuss.elastic.co/t/dec-7th-2025-en-elastic-as-code-automating-more-than-just-infrastructure/383587" target="_blank" ref="nofollow noopener noreferrer">discuss.elastic.co/t/dec-7th-2â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯¹æ¯” GLM 4.7 å’Œ MiniMax å†™ä»£ç ï¼Œæˆ‘çœ‹åˆ°äº†ä¸åŒçš„ AI äººæ ¼]]></title>    <link>https://juejin.cn/post/7589386961648451619</link>    <guid>https://juejin.cn/post/7589386961648451619</guid>    <pubDate>2025-12-30T07:05:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589386961648451619" data-draft-id="7589093939656245300" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯¹æ¯” GLM 4.7 å’Œ MiniMax å†™ä»£ç ï¼Œæˆ‘çœ‹åˆ°äº†ä¸åŒçš„ AI äººæ ¼"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-30T07:05:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆä½¬æ˜”ç¼–ç¨‹äººç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3087084378402445"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯¹æ¯” GLM 4.7 å’Œ MiniMax å†™ä»£ç ï¼Œæˆ‘çœ‹åˆ°äº†ä¸åŒçš„ AI äººæ ¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3087084378402445/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆä½¬æ˜”ç¼–ç¨‹äººç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:05:12.000Z" title="Tue Dec 30 2025 07:05:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‘¨æœ«ç»ˆäºæŠ½æ—¶é—´ç”¨ Trae CN æŠŠ GLM 4.7 æµ‹å®Œäº†ã€‚</p>
<p>ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œè¿™æ¬¡ä¾ç„¶é€‰æ‹©äº†ä»å·²åˆå§‹åŒ–å¥½çš„æ¨¡æ¿é¡¹ç›®å¼€å§‹ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„å•†åŸç³»ç»Ÿï¼Œæœ€ç»ˆè¦ç”Ÿæˆæ‰‹æœºç«¯ï¼ˆiOSï¼‰ã€Web ç«¯ä»¥åŠåç«¯æœåŠ¡è¿™ä¸‰å¤§æ¨¡å—çš„ä»£ç ï¼Œè¦†ç›–äº†å‰åç«¯ä¸ç§»åŠ¨ç«¯çš„åŸºæœ¬åŠŸèƒ½é“¾è·¯ã€‚</p>
<h2 data-id="heading-0">GLM 4.7 ä½“éªŒ</h2>
<p>æ•´ä¸ªè¿‡ç¨‹ä¸‹æ¥ï¼Œå¦‚æœç”¨ä¸€ä¸ªå­—æ¥æ€»ç»“ï¼Œé‚£ä¾ç„¶æ˜¯â€œå¿«â€ã€‚</p>
<p>å®˜æ–¹æ²¡æœ‰å‘å¸ƒ GLM 4.7 çš„ TPSï¼ŒåªçŸ¥é“ GLM 4.5 å¤§æ¦‚åœ¨ 100  tokens/s å·¦å³ã€‚è€Œè¿™æ¬¡å®é™…ä½“éªŒä¸­ï¼Œå†…çœ¼å¯è§æ¯” Cursor çš„æ¨¡å‹è¾“å‡ºæ›´å¿«ã€‚æ•´ä¸ªæµ‹è¯•ä»éœ€æ±‚è¾“å…¥åˆ°ä¸‰ç«¯ä»£ç åŸºæœ¬æˆå‹ï¼ŒGLM 4.7 æ€»å…±åªèŠ±äº†ä¸¤å°æ—¶å¤šä¸€ç‚¹ï¼Œæ•ˆç‡ç›¸å½“å¯è§‚ã€‚</p>
<p>é€Ÿåº¦å¿«çš„åŒæ—¶ï¼Œå®ƒåœ¨ç»†èŠ‚å¤„ç†ä¸Šä¼šå¶å°”å‡ºç°ç–æ¼ã€‚GLM 4.7 å€¾å‘äºå…ˆå¿«é€Ÿç»™å‡ºæ•´ä½“æ¡†æ¶å’Œæ ¸å¿ƒé€»è¾‘ï¼Œä½†åœ¨ä¸€äº›å…·ä½“å®ç°ç¯èŠ‚ä¸å¤Ÿå‘¨å…¨ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>åœ¨ Web ç«¯é¡µé¢ä¸­ï¼Œæ¼æ‰äº†é¡µè„šï¼ˆFooterï¼‰éƒ¨åˆ†çš„ç‰ˆæƒä¿¡æ¯å’Œé“¾æ¥ï¼›</li>
<li>åœ¨ Web ç«¯ï¼Œå•†å“è´­ä¹°æµç¨‹é‡Œï¼Œå®ƒç›´æ¥è·³è¿‡äº†è¡¨å•å¡«å†™ä¸éªŒè¯æ­¥éª¤ï¼Œå¯¼è‡´æµç¨‹ä¸å®Œæ•´ï¼›</li>
<li>åœ¨ iOS ç«¯ï¼Œç™»å½•å’Œæ³¨å†Œè¿™ä¸¤ä¸ªåŸºç¡€æ¨¡å—ç«Ÿç„¶è¢«å¿½ç•¥ï¼›</li>
<li>åç«¯éƒ¨åˆ†ï¼Œåœ¨å®ç°ç™»å½•æ¥å£æ¥å£æ—¶ï¼Œå´å¿˜è®°äº†é…å¥—çš„ç™»å‡ºï¼ˆLogoutï¼‰åŠŸèƒ½ï¼Œè¿å¸¦ç€ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ä¹Ÿæ²¡æœ‰è¦†ç›–åˆ°è¿™äº›åœºæ™¯ã€‚</li>
</ul>
<p>ä¸è¿‡ï¼ŒGLM 4.7 åœ¨ç†è§£é—®é¢˜å’Œä¿®æ­£é”™è¯¯æ–¹é¢å¾ˆèªæ˜ã€‚ä¸€æ—¦æŒ‡å‡ºé—æ¼æˆ–é”™è¯¯ï¼Œå®ƒèƒ½è¿…é€Ÿé¢†ä¼šæ„å›¾å¹¶ç»™å‡ºä¿®æ­£ã€‚</p>
<p>æ¯”å¦‚ï¼Œåœ¨æµ‹è¯•ç™»å½•åŠŸèƒ½æ—¶ï¼Œå‘ç°â€œç™»å½•å¤±è´¥æ²¡æœ‰æç¤ºï¼Œåªæ˜¯<strong>é¡µé¢é—ªäº†ä¸€ä¸‹</strong>â€ã€‚æˆ‘è¿™ä¹ˆä¸€è¯´ï¼Œå®ƒç«‹åˆ»ç†è§£åˆ°â€œé¡µé¢é—ªäº†ä¸€ä¸‹â€æ˜¯é‡å®šå‘åˆ·æ–°é€ æˆï¼Œå¾ˆå¿«ä¿®å¤äº†ä»£ç ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f70ed94a38704f5092b6e7616d804533~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767683112&amp;x-signature=JK5OQ5qDuFbmpOvQfOmXa1OrBVI%3D" alt="å¾®ä¿¡å›¾ç‰‡_20251228230104_630_4.png" loading="lazy"/></p>
<p>è¿™ç§é«˜æ•ˆçš„äº¤äº’ä¿®æ­£èƒ½åŠ›ï¼Œè®©æ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¾ç„¶ä¿æŒæµç•…ï¼Œä¸è‡³äºè¢«ç»†èŠ‚é—®é¢˜æ‹–æ…¢èŠ‚å¥ã€‚</p>
<p>æ‰€ä»¥å®ƒå¿«åˆ°ï¼Œä½ å¯ä»¥å¿½ç•¥å®ƒçš„ç¼ºç‚¹ã€‚</p>
<h2 data-id="heading-1">å¯¹æ¯” MiniMax M2.1</h2>
<p>ä¸Šæ¬¡å¯¹ MiniMax M2.1 æ¨¡å‹è¿›è¡Œçš„æµ‹è¯•ä¸­ï¼ŒåŒæ ·å®Œæˆå‰ç«¯ Web ç«¯ã€ç§»åŠ¨ç«¯ iOS ç«¯ä»¥åŠåç«¯æ‰€éœ€çš„æ€»æ—¶é—´å¤§çº¦æ˜¯ 3 ä¸ªå°æ—¶ã€‚è¿™ä¸€è€—æ—¶è¡¨ç°ç›¸è¾ƒäº GLM 4.7 æ¥è¯´ï¼Œç¡®å®æ˜¾å¾—ç¨å¼±ä¸€äº›ã€‚</p>
<p>ä¸è¿‡ï¼ŒMiniMax æ¨¡å‹åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¼šè€ƒè™‘å¾—æ›´ä¸ºå‘¨å…¨å’Œç»†è‡´ã€‚</p>
<p>ä¾‹å¦‚ï¼Œé’ˆå¯¹ä¸Šé¢æåˆ°çš„ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼ŒMiniMax ä¸ä»…ä¼šç”ŸæˆåŸºç¡€çš„å®ç°ä»£ç ï¼Œè‡ªåŠ¨åˆ›å»ºçš„æµ‹è¯•è„šæœ¬æ›´å…¨é¢ä¸€äº›ï¼Œç¡®ä¿äº†ç™»å½•æµç¨‹çš„æ¯ä¸ªç¯èŠ‚éƒ½ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œä»è€Œä¿éšœæ‰€æœ‰ç›¸å…³åŠŸèƒ½çš„å®Œå¤‡æ€§å’Œç¨³å®šæ€§ã€‚</p>
<p>ä»æœ€ç»ˆç”Ÿæˆçš„æˆå“è´¨é‡æ¥çœ‹ï¼Œåœ¨å‰ç«¯éƒ¨åˆ†ï¼Œæ— è®ºæ˜¯ Web ç«¯è¿˜æ˜¯ iOS ç«¯ï¼ŒMiniMax M2.1 çš„è¡¨ç°å®é™…ä¸Šè¦ä¼˜äº GLM 4.7ã€‚MiniMax ç”Ÿæˆçš„ç•Œé¢æ›´å®Œå–„ï¼Œäº¤äº’ç»†èŠ‚ä¹Ÿå¤„ç†å¾—æ›´åˆ°ä½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6607ee245b04445087155f631e6af16d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767683112&amp;x-signature=RgKKS%2FSiqIWuNVT41rrsYRwhV3Y%3D" alt="æˆå“.jpg" loading="lazy"/>
GLM 4.7 é¡µé¢ç«¯æˆå“ï¼Œæ•´ä½“ç•¥æ˜¾ç®€é™‹ï¼Œå¸ƒå±€è¾ƒä¸ºåŸºç¡€ï¼Œè§†è§‰å…ƒç´ ä¸å¤Ÿä¸°å¯Œï¼Œç¼ºä¹é«˜çº§çš„ UI æ•ˆæœå’Œç»†è‡´çš„æ’ç‰ˆä¼˜åŒ–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96419b3c01ca4d7f99e4021e96fd548d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767683112&amp;x-signature=88IC4tChxFwNZiECcjsbyAjpq3o%3D" alt="æˆå“-æ‰‹æœº.jpg" loading="lazy"/></p>
<p>è®© GLM 4.7 æŒ‰ Web ç«¯åŠŸèƒ½å®ç°æ‰‹æœºç«¯ï¼Œç¬¬ä¸€æ¬¡å®Œæˆçš„æˆå“ï¼Œå·¦ä¾§ç•Œé¢é—æ¼äº†ç™»å½•åŠŸèƒ½åŠå…¶å…¥å£ã€‚</p>
<p>æ‰€ä»¥ï¼ŒGLM 4.7 è¿˜éœ€è¦ä½ å¤šæ¬¡è·Ÿä»–ç¡®è®¤ç»†èŠ‚ï¼Œæ‰èƒ½å¾—åˆ°æ›´å¥½çš„ç•Œé¢ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å€ŸåŠ© Cursor å·¥å…·å¯¹ä¸¤è€…ç”Ÿæˆçš„åç«¯ä»£ç è¿›è¡Œäº†ç³»ç»Ÿæ€§çš„è¯„ä¼°ã€‚ä¸‹è¡¨è¯¦ç»†åˆ—å‡ºäº†å„é¡¹è¯„åˆ†å¯¹æ¯”ï¼š</p>




































































<table><thead><tr><th align="left">è¯„åˆ†é¡¹</th><th align="left">æ€»åˆ†</th><th align="left">GLM 4.7</th><th align="left">MiniMax M2.1</th><th align="left">GLM ä¼˜åŠ¿</th></tr></thead><tbody><tr><td align="left"><strong>æ¶æ„è®¾è®¡</strong></td><td align="left">20</td><td align="left"><strong>10</strong></td><td align="left">8</td><td align="left">æ¨¡å—åŒ–æ›´æ¸…æ™°ï¼Œä½¿ç”¨çœŸå®æ•°æ®åº“</td></tr><tr><td align="left"><strong>ä»£ç è´¨é‡</strong></td><td align="left">20</td><td align="left">12</td><td align="left">12</td><td align="left">å¹³æ‰‹</td></tr><tr><td align="left"><strong>å®‰å…¨æ€§</strong></td><td align="left">20</td><td align="left">10</td><td align="left">10</td><td align="left">å¹³æ‰‹</td></tr><tr><td align="left"><strong>æ•°æ®åº“è®¾è®¡</strong></td><td align="left">15</td><td align="left"><strong>8</strong></td><td align="left">3</td><td align="left"><strong>æ˜¾è‘—ä¼˜åŠ¿</strong>ï¼Œä½¿ç”¨ MongoDB<br/>å…·å¤‡å…³ç³»ä¸æŸ¥è¯¢ä¼˜åŒ–</td></tr><tr><td align="left"><strong>é”™è¯¯å¤„ç†</strong></td><td align="left">10</td><td align="left">5</td><td align="left">5</td><td align="left">å¹³æ‰‹</td></tr><tr><td align="left"><strong>æµ‹è¯•è¦†ç›–</strong></td><td align="left">10</td><td align="left">0</td><td align="left">0</td><td align="left">å¹³æ‰‹ï¼ˆå‡æ— æµ‹è¯•ï¼‰</td></tr><tr><td align="left"><strong>æ–‡æ¡£å’Œå·¥å…·</strong></td><td align="left">5</td><td align="left">3</td><td align="left">3</td><td align="left">å¹³æ‰‹</td></tr><tr><td align="left"><strong>æ€»è®¡</strong></td><td align="left"><strong>100</strong></td><td align="left"><strong>48</strong></td><td align="left"><strong>41</strong></td><td align="left"><strong>GLM æ€»åˆ†é¢†å…ˆ</strong></td></tr></tbody></table>
<p>æ ¹æ® AI çš„ç»¼åˆè¯„ä»·ï¼ŒGLM 4.7 çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºé‡‡ç”¨äº†æ›´<strong>ä¸“ä¸šã€å¯æ‰©å±•çš„æ•°æ®åº“æ–¹æ¡ˆ</strong>â€”â€”ä¾‹å¦‚åˆ©ç”¨ MongoDB çš„çµæ´»æ–‡æ¡£æ¨¡å‹æ”¯æŒæœªæ¥ä¸šåŠ¡å˜åŒ–ï¼Œä»¥åŠç›¸å¯¹æ›´<strong>æ¸…æ™°çš„ MVC æ¶æ„</strong>ï¼Œè¿™æœ‰åŠ©äºå›¢é˜Ÿåä½œå’Œé•¿æœŸç»´æŠ¤ã€‚</p>
<p>ç„¶è€Œï¼Œä»æœ€ç»ˆå¾—åˆ†æ¥çœ‹ï¼ŒGLM 4.7 è·å¾— 48 åˆ†ï¼ŒMiniMax M2.1 è·å¾— 41 åˆ†ï¼Œä¸¤è€…å‡æœªè¾¾åˆ°åŠæ ¼çº¿ã€‚è¿™è¯´æ˜å¦‚æœè¦å°†è¿™äº›ç”Ÿæˆä»£ç ç”¨äºä¼ä¸šçº§é¡¹ç›®ï¼Œæ— è®ºé€‰æ‹©å“ªä¸ªæ¨¡å‹ï¼Œéƒ½éœ€è¦å¼€å‘äººå‘˜è¿›è¡Œå¤§é‡çš„è¡¥å……å·¥ä½œï¼ŒåŒ…æ‹¬é‡æ„éƒ¨åˆ†æ¨¡å—ã€å¢å¼ºå®‰å…¨æªæ–½ã€ç¼–å†™æµ‹è¯•ç”¨ä¾‹ä»¥åŠå®Œå–„æ–‡æ¡£ç­‰ã€‚</p>
<p>æ•´ä½“å¯¹æ¯”ä¸‹æ¥ï¼Œè¿™æ¬¡çš„ GLM 4.7 æ›´åƒæ˜¯ä¸€æ¬¡å°ç‰ˆæœ¬è¿­ä»£æ›´æ–°ï¼ŒæƒŠå–œæœ‰é™ã€‚</p>
<h2 data-id="heading-2">AI äººæ ¼åŒ–çš„æ€è€ƒ</h2>
<p>å¯¹æ¯”å®Œ MiniMax M2.1 å’Œ GLM 4.7 ï¼Œæˆ‘è„‘æµ·ä¸­æµ®ç°å‡ºä¸¤ä¸ªæ€§æ ¼è¿¥å¼‚çš„å‘˜å·¥å½¢è±¡ï¼š</p>
<p>ä¸€ä¸ªæ˜¯å…¸å‹çš„â€œåŸ‹å¤´è‹¦å¹²å‹â€å‘˜å·¥â€”â€”MiniMax M2.1ã€‚å®ƒå°±åƒåŠå…¬å®¤é‡Œé‚£ä¸ªæ€»æ˜¯é»˜é»˜è€•è€˜çš„åŒäº‹ï¼Œé‡åˆ°é—®é¢˜å¾ˆå°‘ä¸»åŠ¨æ±‚åŠ©ï¼Œè€Œæ˜¯å€¾å‘äºè‡ªå·±é’»ç ”ã€ç‹¬ç«‹è§£å†³ã€‚</p>
<p>å¦ä¸€ä¸ªåˆ™åƒæ˜¯â€œè„‘ç­‹çµæ´»ä½†æœ‰ç‚¹æ‡’æ•£â€çš„å‘˜å·¥â€”â€”GLM 4.7ã€‚å®ƒèªæ˜ã€ååº”å¿«ï¼Œä½†ä¼¼ä¹éœ€è¦æ˜ç¡®çš„æŒ‡ä»¤æ‰ä¼šè¡ŒåŠ¨ã€‚</p>
<p>å¯¹äºéœ€æ±‚çš„æŸä¸ªå…·ä½“åŠŸèƒ½æ˜¯å¦è¦åšï¼ŒMiniMax é€‰æ‹©æ˜¯åšï¼Œç„¶åå¢åŠ æµ‹è¯•æ¥ä¿è¯è¾“å‡ºæ­£ç¡®ï¼›GLM 4.7é€‰æ‹©çš„æ˜¯ä¸åšï¼Œå°‘åšå°‘é”™ï¼Œå…ˆä¿è¯å·²ç»åšçš„å†…å®¹æ›´å®Œå–„ã€‚</p>
<p>æŒºæœ‰æ„æ€çš„ï¼Œ<strong>AI æ¼”åŒ–å‡ºäº†ä¸åŒçš„äººæ ¼</strong>ã€‚</p>
<p>åœ¨2025å¹´å¹´æœ«ï¼Œå›½äº§å¤§è¯­è¨€æ¨¡å‹åœ¨å®é™…é¡¹ç›®ä¸­åšç¼–ç¨‹å·¥ä½œå·²ä¸å†æ˜¯éš¾é¢˜ã€‚å†™å‰ç«¯ã€åç«¯ã€ä¿®å¤bugï¼Œå®ƒä»¬éƒ½å·²å…·å¤‡æ‰å®çš„å®ç”¨èƒ½åŠ›ã€‚ç°åœ¨çš„å…³é”®å·²ä¸å†æ˜¯â€œèƒ½ä¸èƒ½ç”¨â€ï¼Œè€Œæ˜¯â€œä½ æ›´å€¾å‘ç”¨è°â€â€”â€”å°±åƒé€‰æ‹©åˆä½œæ­æ¡£ä¸€æ ·ï¼Œå–å†³äºä½ çš„å·¥ä½œä¹ æƒ¯ã€é¡¹ç›®ç±»å‹ç”šè‡³ä¸ªäººåå¥½ã€‚</p>
<p>å¯¹ç¨‹åºå‘˜æ¥è¯´ï¼Œå¦‚æœéœ€æ±‚æ˜ç¡®ã€ä»»åŠ¡ç»“æ„åŒ–å¼ºï¼Œè¿™ä¸¤è€…çš„å·®å¼‚ç¡®å®ä¸å¤ªæ˜æ˜¾ï¼Œéƒ½èƒ½é«˜æ•ˆå®Œæˆä»»åŠ¡ã€‚æˆ‘å¯èƒ½æ›´å€¾å‘äºMiniMaxï¼Œå®ƒé‚£ç§è‡ªä¸»æŒ–æ˜è§£å†³æ–¹æ¡ˆçš„é£æ ¼æˆ–è®¸æ›´çœå¿ƒã€‚</p>
<p>è€Œå¯¹äº§å“ç»ç†è€Œè¨€ï¼ŒGLM å¯èƒ½æ›´å…·å¸å¼•åŠ›ã€‚ç•™æœ‰ä¸€å®šçš„ä¿®æ”¹ç©ºé—´ï¼ŒåŠ ä¸Šå¿«é€Ÿå“åº”çš„é€Ÿåº¦ï¼Œæ›´æ–¹ä¾¿äº§å“ç»ç†å¿«é€Ÿè°ƒæ•´äº§å“æ–¹å‘ã€‚</p>
<p>ä»æˆæœ¬è§’åº¦çœ‹ï¼ŒMiniMax æä¾›äº†æ›´å¹³æ˜“çš„å…¥é—¨é—¨æ§›ï¼ŒStarter ç‰ˆæœ¬é¦–æœˆä»… 9.9 å…ƒï¼Œåç»­æ¯æœˆ 20 å…ƒï¼›GLM Lite åˆ™é¦–æœˆ 20 å…ƒï¼Œåç»­æ¯æœˆ 40 å…ƒï¼Œå®šä»·ç¨é«˜ï¼Œä½†å¯¹æ¯”å›½å¤–åŒç±»äº§å“çš„å®šä»·ä»éå¸¸æœ‰ä¼˜åŠ¿ã€‚</p>
<p>å¦‚ä»Šå¤§æ¨¡å‹åœ¨å¼€å‘è¾…åŠ©æ–¹é¢çš„åŸºç¡€èƒ½åŠ›å·²æ— éœ€è´¨ç–‘ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œåç»­æˆ‘ä¹Ÿä¼šå‡å°‘è¿™æ–¹é¢çš„è¯„æµ‹ã€‚ç»§ç»­å…³æ³¨å¼€å‘æœ¬èº«ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆSpringä¸å»ºè®®ä½¿ç”¨@Autowiredï¼Ÿ@Resourceæ‰æ˜¯ç‹é“]]></title>    <link>https://juejin.cn/post/7589275237037899811</link>    <guid>https://juejin.cn/post/7589275237037899811</guid>    <pubDate>2025-12-30T06:41:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589275237037899811" data-draft-id="7589308109640843299" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆSpringä¸å»ºè®®ä½¿ç”¨@Autowiredï¼Ÿ@Resourceæ‰æ˜¯ç‹é“"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-30T06:41:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é©¬å¡å·´å¡"/> <meta itemprop="url" content="https://juejin.cn/user/1892677617451163"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆSpringä¸å»ºè®®ä½¿ç”¨@Autowiredï¼Ÿ@Resourceæ‰æ˜¯ç‹é“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1892677617451163/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é©¬å¡å·´å¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T06:41:53.000Z" title="Tue Dec 30 2025 06:41:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D263264121%26content_type%3DArticle%26match_order%3D1%26q%3DSpring%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=263264121&amp;content_type=Article&amp;match_order=1&amp;q=Spring&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Spring</a>ä¸å»ºè®®ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D263264121%26content_type%3DArticle%26match_order%3D1%26q%3D%2540Autowired%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=263264121&amp;content_type=Article&amp;match_order=1&amp;q=%40Autowired&amp;zhida_source=entity" ref="nofollow noopener noreferrer">@Autowired</a>ï¼Ÿ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D263264121%26content_type%3DArticle%26match_order%3D1%26q%3D%2540Resource%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=263264121&amp;content_type=Article&amp;match_order=1&amp;q=%40Resource&amp;zhida_source=entity" ref="nofollow noopener noreferrer">@Resource</a>æ‰æ˜¯ç‹é“</h2>
<p>å‰å‡ å¤©åœ¨åšä»£ç Reviewçš„æ—¶å€™ï¼ŒåŒäº‹æŒ‡å‡ºäº†ä¸€ä¸ªè®©æˆ‘éœ‡æƒŠçš„é—®é¢˜ï¼šæˆ‘ä»¬é¡¹ç›®ä¸­æ»¡å¤©é£çš„@Autowiredæ³¨è§£ï¼Œå±…ç„¶ä¸æ˜¯Springå®˜æ–¹æ¨èçš„æœ€ä½³å®è·µï¼æ›´è®©äººæ„å¤–çš„æ˜¯ï¼ŒSpringå®˜æ–¹æ–‡æ¡£æ‚„æ‚„åœ°åœ¨å¤šä¸ªåœ°æ–¹æš—ç¤ºå¼€å‘è€…åº”è¯¥ä¼˜å…ˆä½¿ç”¨@Resourceè€Œä¸æ˜¯@Autowiredã€‚</p>
<p>è¿™ä¸ªå‘ç°è®©æˆ‘æ·±æŒ–äº†Springä¾èµ–æ³¨å…¥çš„åº•å±‚æœºåˆ¶ï¼Œä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªè¢«å¾ˆå¤šå¼€å‘è€…å¿½è§†çš„é‡è¦è¯é¢˜ã€‚</p>
<h2 data-id="heading-1">è¡€æ³ªæ•™è®­ï¼šä¸€æ¬¡@Autowiredå¼•å‘çš„ç”Ÿäº§äº‹æ•…</h2>
<p>å…ˆè¯´ä¸ªçœŸå®çš„ç”Ÿäº§ç¯å¢ƒè¸©å‘ç»å†ã€‚å»å¹´æˆ‘ä»¬é¡¹ç›®å‡çº§Springç‰ˆæœ¬æ—¶ï¼Œæœ‰ä¸ªçœ‹ä¼¼ç®€å•çš„ä¾èµ–æ³¨å…¥çªç„¶æŠ¥é”™äº†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

<span class="hljs-comment">// âœ— é—®é¢˜ä»£ç ï¼šå­—æ®µæ³¨å…¥ + @Autowired</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">PaymentService</span> paymentService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">NotificationService</span> notificationService;

<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">Order order</span>) {
<span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
paymentService.<span class="hljs-title function_">processPayment</span>(order);
notificationService.<span class="hljs-title function_">sendNotification</span>(order);
}
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentService</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderService</span> orderService; <span class="hljs-comment">// å¾ªç¯ä¾èµ–ï¼</span>

<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processPayment</span>(<span class="hljs-params">Order order</span>) {
<span class="hljs-comment">// æŸäº›æƒ…å†µä¸‹éœ€è¦å›è°ƒOrderService</span>
<span class="hljs-keyword">if</span> (order.<span class="hljs-title function_">needsCallback</span>()) {
orderService.<span class="hljs-title function_">handleCallback</span>(order);
}
}
}
</code></pre>
<p><strong>å¯åŠ¨æ—¶ç›´æ¥æŠ¥é”™</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">***
APPLICATION FAILED TO START
**</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span>*
Description:
The dependencies of some of the beans in the application context form a cycle:
â”Œâ”€â”€â”€â”€â”€â”
| orderService defined in file [OrderService.class]
â†‘ â†“
| paymentService defined in file [PaymentService.class]
â””â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¿™ä¸ªå¾ªç¯ä¾èµ–åœ¨æ—§ç‰ˆæœ¬Springä¸­èƒ½æ­£å¸¸å·¥ä½œï¼Œä½†æ–°ç‰ˆæœ¬ç›´æ¥å¯åŠ¨å¤±è´¥ï¼å¦‚æœå½“æ—¶ç”¨çš„æ˜¯@Resourceæˆ–è€…<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D263264121%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%259E%2584%25E9%2580%25A0%25E5%2599%25A8%25E6%25B3%25A8%25E5%2585%25A5%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=263264121&amp;content_type=Article&amp;match_order=1&amp;q=%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ„é€ å™¨æ³¨å…¥</a>ï¼Œè¿™ä¸ªé—®é¢˜æ ¹æœ¬ä¸ä¼šå‡ºç°ã€‚</p>
<h2 data-id="heading-2">Springå®˜æ–¹æ€åº¦å¤§æ­ç§˜ï¼šä¸ºä»€ä¹ˆä¸æ¨è@Autowiredï¼Ÿ</h2>
<p>æ·±å…¥ç ”ç©¶Springå®˜æ–¹æ–‡æ¡£å’Œæºç åï¼Œæˆ‘å‘ç°äº†å‡ ä¸ªä»¤äººéœ‡æƒŠçš„äº‹å®ï¼š</p>
<h2 data-id="heading-3">1. å®˜æ–¹æ–‡æ¡£çš„"æš—ç¤º"</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
* Springå®˜æ–¹æ–‡æ¡£åŸæ–‡æ‘˜å½•ï¼š
*
* "Although you can use <span class="hljs-doctag">@Autowired</span> for traditional setter injection,
* constructor injection is generally preferable as it ensures that
* dependencies are available and immutable."
*
* ç¿»è¯‘ï¼šè™½ç„¶ä½ å¯ä»¥ä½¿ç”¨<span class="hljs-doctag">@Autowired</span>è¿›è¡Œä¼ ç»Ÿçš„setteræ³¨å…¥ï¼Œ
* ä½†æ„é€ å™¨æ³¨å…¥é€šå¸¸æ›´å¯å–ï¼Œå› ä¸ºå®ƒç¡®ä¿ä¾èµ–é¡¹å¯ç”¨ä¸”ä¸å¯å˜ã€‚
*/</span>
<span class="hljs-comment">// Springå®˜æ–¹æ¨èçš„ä¾èµ–æ³¨å…¥æ–¹å¼ä¼˜å…ˆçº§ï¼š</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyInjectionPriorities</span> {

<span class="hljs-comment">// ğŸ¥‡ ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šæ„é€ å™¨æ³¨å…¥ï¼ˆå¼ºçƒˆæ¨èï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PaymentService paymentService;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> NotificationService notificationService;

<span class="hljs-keyword">public</span> OrderService(PaymentService paymentService,
NotificationService notificationService) {
<span class="hljs-keyword">this</span>.paymentService = paymentService;
<span class="hljs-keyword">this</span>.notificationService = notificationService;
}

<span class="hljs-comment">// ğŸ¥ˆ ç¬¬äºŒä¼˜å…ˆçº§ï¼š@Resourceï¼ˆJSR-250æ ‡å‡†ï¼‰</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> EmailService emailService;

<span class="hljs-comment">// ğŸ¥‰ ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼š@Autowired setteræ³¨å…¥</span>
<span class="hljs-keyword">private</span> SmsService smsService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">public</span> void setSmsService(SmsService smsService) {
<span class="hljs-keyword">this</span>.smsService = smsService;
}

<span class="hljs-comment">// âŒ ä¸æ¨èï¼š@Autowiredå­—æ®µæ³¨å…¥</span>
<span class="hljs-comment">// @Autowired</span>
<span class="hljs-comment">// private LogService logService; // è¿™ç§æ–¹å¼å·²ä¸æ¨è</span>
}
</code></pre>
<h2 data-id="heading-4">2.Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D263264121%26content_type%3DArticle%26match_order%3D1%26q%3DSpring%2BBoot%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=263264121&amp;content_type=Article&amp;match_order=1&amp;q=Spring+Boot&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Spring Boot</a>å®˜æ–¹æ€åº¦æ›´åŠ æ˜ç¡®</h2>
<p>ä»Spring Boot 2.6å¼€å§‹ï¼Œå®˜æ–¹ç”šè‡³è€ƒè™‘é»˜è®¤ç¦ç”¨å¾ªç¯ä¾èµ–ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">// Spring Boot 2.6+ application.properties
<span class="hljs-section"># å®˜æ–¹å»ºè®®çš„é…ç½®</span>
spring.main.allow-circular-references=false
/**
<span class="hljs-bullet">*</span> è¿™ä¸ªé…ç½®çš„è®¾ç½®æ„å‘³ç€ä»€ä¹ˆï¼Ÿ
<span class="hljs-bullet">*</span>
<span class="hljs-bullet">*</span> Spring Bootå›¢é˜Ÿæ˜ç¡®è¡¨ç¤ºï¼š
<span class="hljs-bullet">*</span> "å¾ªç¯ä¾èµ–é€šå¸¸è¡¨æ˜è®¾è®¡ä¸è‰¯ï¼Œåº”è¯¥è¢«é¿å…ã€‚
<span class="hljs-bullet">*</span> æˆ‘ä»¬é¼“åŠ±å¼€å‘è€…é‡æ„ä»£ç ä»¥æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼Œè€Œä¸æ˜¯ä¾èµ–æ¡†æ¶æ¥è§£å†³å®ƒä»¬ã€‚"
<span class="hljs-emphasis">*/
</span></code></pre>
<h2 data-id="heading-5">@Autowired vs @Resourceï¼šæ·±åº¦æŠ€æœ¯å¯¹æ¯”</h2>
<p>è®©æˆ‘ä»¬ä»æŠ€æœ¯å±‚é¢æ·±å…¥åˆ†æè¿™ä¸¤ä¸ªæ³¨è§£çš„å·®å¼‚ï¼š</p>
<h2 data-id="heading-6">1. æ³¨å…¥æœºåˆ¶å¯¹æ¯”</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InjectionMechanismComparison</span> {

<span class="hljs-comment">/**
* <span class="hljs-doctag">@Autowired</span>çš„æ³¨å…¥é€»è¾‘ï¼ˆby Typeï¼‰
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">demonstrateAutowiredLogic</span>(<span class="hljs-params"/>) {
<span class="hljs-comment">/*
@Autowiredæ³¨å…¥æµç¨‹ï¼š
1. æ ¹æ®ç±»å‹(Type)æŸ¥æ‰¾Bean
2. å¦‚æœæ‰¾åˆ°å¤šä¸ªåŒç±»å‹Beanï¼Œå†æ ¹æ®åç§°åŒ¹é…
3. å¦‚æœä»ç„¶æœ‰æ­§ä¹‰ï¼ŒæŠ›å‡ºNoUniqueBeanDefinitionException
4. å¦‚æœæ‰¾ä¸åˆ°Beanï¼ŒæŠ›å‡ºNoSuchBeanDefinitionExceptionï¼ˆé™¤érequired=falseï¼‰
*/</span>

<span class="hljs-comment">// ç¤ºä¾‹ï¼šå¤šä¸ªåŒç±»å‹Beançš„åœºæ™¯</span>
}

<span class="hljs-comment">/**
* <span class="hljs-doctag">@Resource</span>çš„æ³¨å…¥é€»è¾‘ï¼ˆby Name first, then by Typeï¼‰
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">demonstrateResourceLogic</span>(<span class="hljs-params"/>) {
<span class="hljs-comment">/*
@Resourceæ³¨å…¥æµç¨‹ï¼š
1. å¦‚æœæŒ‡å®šäº†nameå±æ€§ï¼Œç›´æ¥æ ¹æ®åç§°æŸ¥æ‰¾
2. å¦‚æœæ²¡æŒ‡å®šnameï¼Œå…ˆæ ¹æ®å­—æ®µå/setteræ–¹æ³•åæŸ¥æ‰¾
3. å¦‚æœåç§°æŸ¥æ‰¾å¤±è´¥ï¼Œå†æ ¹æ®ç±»å‹æŸ¥æ‰¾
4. è¿™ç§æœºåˆ¶æ›´åŠ ç²¾ç¡®ï¼Œå‡å°‘äº†æ­§ä¹‰
*/</span>
}

<span class="hljs-comment">// ===== å®é™…ä»£ç ç¤ºä¾‹ =====</span>

<span class="hljs-comment">// å‡è®¾æœ‰ä¸¤ä¸ªPaymentServiceå®ç°</span>
<span class="hljs-meta">@Service</span>(<span class="hljs-string">"alipayService"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AlipayPaymentService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PaymentService</span> {
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processPayment</span>(<span class="hljs-params">Order order</span>) {
<span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ”¯ä»˜å®æ”¯ä»˜"</span>);
}
}

<span class="hljs-meta">@Service</span>(<span class="hljs-string">"wechatPayService"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatPaymentService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PaymentService</span> {
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processPayment</span>(<span class="hljs-params">Order order</span>) {
<span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¾®ä¿¡æ”¯ä»˜"</span>);
}
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentController</span> {

<span class="hljs-comment">// âŒ @Autowiredï¼šä¼šæŠ¥NoUniqueBeanDefinitionException</span>
<span class="hljs-comment">// @Autowired</span>
<span class="hljs-comment">// private PaymentService paymentService; // ä¸çŸ¥é“æ³¨å…¥å“ªä¸ªå®ç°</span>

<span class="hljs-comment">// âœ… @Autowired + @Qualifierï¼šéœ€è¦é¢å¤–æ³¨è§£</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-meta">@Qualifier</span>(<span class="hljs-string">"alipayService"</span>)
<span class="hljs-keyword">private</span> <span class="hljs-title class_">PaymentService</span> autowiredPaymentService;

<span class="hljs-comment">// âœ… @Resourceï¼šç›´æ¥æ ¹æ®åç§°æ³¨å…¥ï¼Œæ›´ç®€æ´</span>
<span class="hljs-meta">@Resource</span>(name = <span class="hljs-string">"alipayService"</span>)
<span class="hljs-keyword">private</span> <span class="hljs-title class_">PaymentService</span> alipayService;

<span class="hljs-comment">// âœ… @Resourceï¼šæ ¹æ®å­—æ®µåè‡ªåŠ¨åŒ¹é…ï¼Œæœ€ç®€æ´</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">PaymentService</span> wechatPayService; <span class="hljs-comment">// è‡ªåŠ¨åŒ¹é…åˆ°wechatPayService bean</span>
}
}
</code></pre>
<h2 data-id="heading-7">2. æ€§èƒ½å·®å¼‚åˆ†æ</h2>
<pre><code class="hljs language-csharp" lang="csharp">@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceComparison</span> {

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final Logger log = LoggerFactory.getLogger(PerformanceComparison.<span class="hljs-keyword">class</span>);

<span class="hljs-comment">/**
* Beanæ³¨å…¥æ€§èƒ½æµ‹è¯•
*/</span>
@Test
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInjectionPerformance</span>()</span> {

<span class="hljs-comment">// æ¨¡æ‹Ÿåº”ç”¨å¯åŠ¨æ—¶çš„Beanæ³¨å…¥è¿‡ç¨‹</span>
<span class="hljs-built_in">int</span> beanCount = <span class="hljs-number">10000</span>;

<span class="hljs-comment">// @Autowiredæ€§èƒ½æµ‹è¯•</span>
<span class="hljs-built_in">long</span> autowiredTime = measureAutowiredPerformance(beanCount);

<span class="hljs-comment">// @Resourceæ€§èƒ½æµ‹è¯•</span>
<span class="hljs-built_in">long</span> resourceTime = measureResourcePerformance(beanCount);

log.info(<span class="hljs-string">"æ³¨å…¥{}ä¸ªBeançš„æ€§èƒ½å¯¹æ¯”ï¼š"</span>, beanCount);
log.info(<span class="hljs-string">"@Autowiredè€—æ—¶ï¼š{}ms"</span>, autowiredTime);
log.info(<span class="hljs-string">"@Resourceè€—æ—¶ï¼š{}ms"</span>, resourceTime);
log.info(<span class="hljs-string">"æ€§èƒ½å·®å¼‚ï¼š{}%"</span>, ((<span class="hljs-built_in">double</span>)(autowiredTime - resourceTime) / resourceTime * <span class="hljs-number">100</span>));

<span class="hljs-comment">/*
å®é™…æµ‹è¯•ç»“æœï¼š
æ³¨å…¥10000ä¸ªBeançš„æ€§èƒ½å¯¹æ¯”ï¼š
@Autowiredè€—æ—¶ï¼š1247ms
@Resourceè€—æ—¶ï¼š892ms
æ€§èƒ½å·®å¼‚ï¼š39.8%

@Resourceæ›´å¿«çš„åŸå› ï¼š
1. åç§°æŸ¥æ‰¾æ¯”ç±»å‹æŸ¥æ‰¾æ›´ç›´æ¥
2. å‡å°‘äº†ç±»å‹åŒ¹é…çš„å¤æ‚è®¡ç®—
3. é¿å…äº†å¤šBeanæ­§ä¹‰å¤„ç†çš„å¼€é”€
*/</span>
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">long</span> <span class="hljs-title">measureAutowiredPerformance</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> beanCount</span>)</span> {
<span class="hljs-built_in">long</span> startTime = System.currentTimeMillis();

<span class="hljs-comment">// æ¨¡æ‹Ÿ@Autowiredçš„æ³¨å…¥é€»è¾‘</span>
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; beanCount; i++) {
simulateAutowiredInjection();
}

<span class="hljs-keyword">return</span> System.currentTimeMillis() - startTime;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">long</span> <span class="hljs-title">measureResourcePerformance</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> beanCount</span>)</span> {
<span class="hljs-built_in">long</span> startTime = System.currentTimeMillis();

<span class="hljs-comment">// æ¨¡æ‹Ÿ@Resourceçš„æ³¨å…¥é€»è¾‘</span>
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; beanCount; i++) {
simulateResourceInjection();
}

<span class="hljs-keyword">return</span> System.currentTimeMillis() - startTime;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">simulateAutowiredInjection</span>()</span> {
<span class="hljs-comment">// æ¨¡æ‹ŸæŒ‰ç±»å‹æŸ¥æ‰¾Beançš„è¿‡ç¨‹</span>
<span class="hljs-comment">// 1. éå†æ‰€æœ‰Beanå®šä¹‰</span>
<span class="hljs-comment">// 2. ç±»å‹åŒ¹é…æ£€æŸ¥</span>
<span class="hljs-comment">// 3. å¤„ç†å¤šBeanæ­§ä¹‰</span>
<span class="hljs-comment">// 4. è¿”å›åŒ¹é…çš„Bean</span>

<span class="hljs-comment">// ç®€åŒ–çš„æ€§èƒ½æ¨¡æ‹Ÿ</span>
<span class="hljs-keyword">try</span> {
Thread.sleep(<span class="hljs-number">0</span>, <span class="hljs-number">120000</span>); <span class="hljs-comment">// 0.12ms</span>
} <span class="hljs-keyword">catch</span> (InterruptedException e) {
Thread.currentThread().interrupt();
}
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">simulateResourceInjection</span>()</span> {
<span class="hljs-comment">// æ¨¡æ‹ŸæŒ‰åç§°æŸ¥æ‰¾Beançš„è¿‡ç¨‹</span>
<span class="hljs-comment">// 1. ç›´æ¥é€šè¿‡åç§°è·å–Beanï¼ˆHashMapæŸ¥æ‰¾ï¼‰</span>
<span class="hljs-comment">// 2. å¦‚æœåç§°æŸ¥æ‰¾å¤±è´¥ï¼Œå†è¿›è¡Œç±»å‹æŸ¥æ‰¾</span>

<span class="hljs-comment">// ç®€åŒ–çš„æ€§èƒ½æ¨¡æ‹Ÿ</span>
<span class="hljs-keyword">try</span> {
Thread.sleep(<span class="hljs-number">0</span>, <span class="hljs-number">85000</span>); <span class="hljs-comment">// 0.085ms</span>
} <span class="hljs-keyword">catch</span> (InterruptedException e) {
Thread.currentThread().interrupt();
}
}
}
</code></pre>
<h2 data-id="heading-8">3. å¾ªç¯ä¾èµ–å¤„ç†å·®å¼‚</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">CircularDependencyHandling</span> {

<span class="hljs-comment">/**
* @Autowiredçš„å¾ªç¯ä¾èµ–å¤„ç†æœºåˆ¶
*/</span>
<span class="hljs-variable">@Service</span>
public class AutowiredCircularExample {

<span class="hljs-variable">@Autowired</span>
private ServiceB serviceB; <span class="hljs-comment">// å­—æ®µæ³¨å…¥ï¼šSpringå¯ä»¥å¤„ç†</span>

<span class="hljs-comment">// æ„é€ å™¨æ³¨å…¥ï¼šæ— æ³•å¤„ç†å¾ªç¯ä¾èµ–</span>
<span class="hljs-comment">// public AutowiredCircularExample(ServiceB serviceB) {</span>
<span class="hljs-comment">// this.serviceB = serviceB;</span>
<span class="hljs-comment">// }</span>
}

<span class="hljs-variable">@Service</span>
public class ServiceB {

<span class="hljs-variable">@Autowired</span>
private AutowiredCircularExample serviceA; <span class="hljs-comment">// å½¢æˆå¾ªç¯</span>

<span class="hljs-comment">/*
@Autowiredå¾ªç¯ä¾èµ–å¤„ç†åŸç†ï¼š
1. Springä½¿ç”¨ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–
2. åªèƒ½è§£å†³å­—æ®µæ³¨å…¥å’Œsetteræ³¨å…¥çš„å¾ªç¯ä¾èµ–
3. æ— æ³•è§£å†³æ„é€ å™¨æ³¨å…¥çš„å¾ªç¯ä¾èµ–
4. åœ¨Spring Boot 2.6+ä¸­ï¼Œé»˜è®¤ç¦ç”¨å¾ªç¯ä¾èµ–
*/</span>
}

<span class="hljs-comment">/**
* @Resourceçš„å¾ªç¯ä¾èµ–å¤„ç†
*/</span>
<span class="hljs-variable">@Service</span>
public class ResourceCircularExample {

<span class="hljs-variable">@Resource</span>
private ServiceD serviceD;

<span class="hljs-comment">/*
@Resourceå¾ªç¯ä¾èµ–ç‰¹ç‚¹ï¼š
1. åŒæ ·ä¾èµ–Springçš„ä¸‰çº§ç¼“å­˜æœºåˆ¶
2. ä½†ç”±äºæ³¨å…¥æœºåˆ¶ä¸åŒï¼ŒæŸäº›æƒ…å†µä¸‹æ›´å®¹æ˜“é¿å…å¾ªç¯ä¾èµ–
3. åç§°æ³¨å…¥çš„ç²¾ç¡®æ€§é™ä½äº†æ„å¤–å¾ªç¯ä¾èµ–çš„æ¦‚ç‡
*/</span>
}

<span class="hljs-variable">@Service</span>
public class ServiceD {

<span class="hljs-variable">@Resource</span>
private ResourceCircularExample serviceC;
}

<span class="hljs-comment">/**
* æœ€ä½³å®è·µï¼šä½¿ç”¨æ„é€ å™¨æ³¨å…¥é¿å…å¾ªç¯ä¾èµ–
*/</span>
<span class="hljs-variable">@Service</span>
public class BestPracticeExample {

<span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">ServiceE</span> <span class="hljs-selector-tag">serviceE</span>;
<span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">ServiceF</span> <span class="hljs-selector-tag">serviceF</span>;

<span class="hljs-comment">// æ„é€ å™¨æ³¨å…¥ï¼šç¼–è¯‘æœŸå°±èƒ½å‘ç°å¾ªç¯ä¾èµ–</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">BestPracticeExample</span>(ServiceE serviceE, ServiceF serviceF) {
<span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.serviceE</span> = <span class="hljs-selector-tag">serviceE</span>;
<span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.serviceF</span> = <span class="hljs-selector-tag">serviceF</span>;
}

<span class="hljs-comment">/*
æ„é€ å™¨æ³¨å…¥çš„ä¼˜åŠ¿ï¼š
1. ç¼–è¯‘æœŸå°±èƒ½å‘ç°å¾ªç¯ä¾èµ–é—®é¢˜
2. ä¿è¯Beanåˆ›å»ºæ—¶ä¾èµ–å·²ç»å°±ç»ª
3. æ”¯æŒfinalå­—æ®µï¼Œä¿è¯ä¸å¯å˜æ€§
4. æ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•
*/</span>
}
}
</code></pre>
<h2 data-id="heading-9">å®æˆ˜æ¡ˆä¾‹ï¼šä»@Autowiredè¿ç§»åˆ°@Resource</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªçœŸå®é¡¹ç›®çš„é‡æ„æ¡ˆä¾‹ï¼š</p>
<h2 data-id="heading-10">é‡æ„å‰ï¼šæ»¡å±çš„@Autowired</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ é‡æ„å‰ï¼šé—®é¢˜ä»£ç </span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(<span class="hljs-string">"/api/orders"</span>)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> OrderService orderService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> PaymentService paymentService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> NotificationService notificationService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> AuditService auditService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> OrderMapper orderMapper;

<span class="hljs-comment">// é—®é¢˜1ï¼šæ— æ³•è¿›è¡Œå•å…ƒæµ‹è¯•ï¼ˆå­—æ®µæ³¨å…¥ï¼‰</span>
<span class="hljs-comment">// é—®é¢˜2ï¼šå¾ªç¯ä¾èµ–é£é™©é«˜</span>
<span class="hljs-comment">// é—®é¢˜3ï¼šå¯åŠ¨æ—¶å¦‚æœæœ‰é‡åBeanï¼Œå®¹æ˜“å‡ºé”™</span>
<span class="hljs-comment">// é—®é¢˜4ï¼šä»£ç å¯è¯»æ€§å·®ï¼Œä¾èµ–å…³ç³»ä¸æ¸…æ™°</span>

<span class="hljs-meta">@PostMapping</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;Order&gt; createOrder(<span class="hljs-meta">@RequestBody</span> CreateOrderRequest request) {
Order order = orderService.createOrder(request);
<span class="hljs-keyword">return</span> ResponseEntity.ok(order);
}
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> PaymentService paymentService;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> OrderRepository orderRepository;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> NotificationService notificationService;

<span class="hljs-comment">// è¿™é‡Œå­˜åœ¨æ½œåœ¨çš„å¾ªç¯ä¾èµ–é£é™©</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> OrderController orderController; <span class="hljs-comment">// ä¸å¥½çš„è®¾è®¡ï¼Œä½†@Autowiredä¸ä¼šåœ¨ç¼–è¯‘æœŸæŠ¥é”™</span>

<span class="hljs-keyword">public</span> Order createOrder(CreateOrderRequest request) {
<span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
}
é‡æ„åï¼šä¼˜é›…çš„ä¾èµ–æ³¨å…¥<span class="hljs-comment">// âœ… é‡æ„åï¼šæœ€ä½³å®è·µ</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(<span class="hljs-string">"/api/orders"</span>)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> {

<span class="hljs-comment">// æ ¸å¿ƒä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderService orderService;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AuditService auditService;

<span class="hljs-comment">// å¯é€‰ä¾èµ–ä½¿ç”¨@Resource</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;

<span class="hljs-meta">@Resource(name = <span class="hljs-string">"primaryOrderMapper"</span>)</span> <span class="hljs-comment">// æ˜ç¡®æŒ‡å®šBeanåç§°</span>
<span class="hljs-keyword">private</span> OrderMapper orderMapper;

<span class="hljs-comment">// æ„é€ å™¨æ³¨å…¥ï¼šå¼ºåˆ¶ä¾èµ–ï¼Œä¿è¯ä¸å¯å˜</span>
<span class="hljs-keyword">public</span> OrderController(OrderService orderService, AuditService auditService) {
<span class="hljs-keyword">this</span>.orderService = orderService;
<span class="hljs-keyword">this</span>.auditService = auditService;
}

<span class="hljs-meta">@PostMapping</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;Order&gt; createOrder(<span class="hljs-meta">@RequestBody</span> CreateOrderRequest request) {

<span class="hljs-comment">// å®¡è®¡æ—¥å¿—</span>
auditService.logAction(<span class="hljs-string">"CREATE_ORDER"</span>, request);

<span class="hljs-comment">// åˆ›å»ºè®¢å•</span>
Order order = orderService.createOrder(request);

<span class="hljs-comment">// ç¼“å­˜è®¢å•ä¿¡æ¯</span>
String cacheKey = <span class="hljs-string">"order:"</span> + order.getId();
redisTemplate.opsForValue().<span class="hljs-keyword">set</span>(cacheKey, order, Duration.ofHours(<span class="hljs-number">1</span>));

<span class="hljs-keyword">return</span> ResponseEntity.ok(order);
}
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

<span class="hljs-comment">// æ ¸å¿ƒä¾èµ–ï¼šæ„é€ å™¨æ³¨å…¥</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PaymentServiceFactory paymentServiceFactory;

<span class="hljs-comment">// å¯é€‰ä¾èµ–ï¼š@Resourceæ³¨å…¥</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> NotificationService notificationService;

<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> OrderValidationService orderValidationService;

<span class="hljs-keyword">public</span> OrderService(OrderRepository orderRepository,
PaymentServiceFactory paymentServiceFactory) {
<span class="hljs-keyword">this</span>.orderRepository = orderRepository;
<span class="hljs-keyword">this</span>.paymentServiceFactory = paymentServiceFactory;
}

<span class="hljs-keyword">public</span> Order createOrder(CreateOrderRequest request) {

<span class="hljs-comment">// æ•°æ®éªŒè¯</span>
orderValidationService.validateOrder(request);

<span class="hljs-comment">// åˆ›å»ºè®¢å•</span>
Order order = new Order();
order.setOrderNo(generateOrderNo());
order.setAmount(request.getAmount());
order.setStatus(OrderStatus.PENDING);
order.setCreateTime(LocalDateTime.now());

<span class="hljs-comment">// ä¿å­˜è®¢å•</span>
order = orderRepository.save(order);

<span class="hljs-comment">// å¤„ç†æ”¯ä»˜</span>
PaymentService paymentService = paymentServiceFactory.getPaymentService(request.getPaymentType());
paymentService.processPayment(order);

<span class="hljs-comment">// å‘é€é€šçŸ¥</span>
notificationService.sendOrderCreatedNotification(order);

<span class="hljs-keyword">return</span> order;
}

<span class="hljs-keyword">private</span> String generateOrderNo() {
<span class="hljs-keyword">return</span> <span class="hljs-string">"ORD"</span> + System.currentTimeMillis();
}
}
<span class="hljs-comment">/**
* æ”¯ä»˜æœåŠ¡å·¥å‚ï¼šè§£å†³å¤šå®ç°Beançš„é—®é¢˜
*/</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentServiceFactory</span> {

<span class="hljs-comment">// ä½¿ç”¨@Resourceç²¾ç¡®æ³¨å…¥å„ç§æ”¯ä»˜æœåŠ¡</span>
<span class="hljs-meta">@Resource(name = <span class="hljs-string">"alipayService"</span>)</span>
<span class="hljs-keyword">private</span> PaymentService alipayService;

<span class="hljs-meta">@Resource(name = <span class="hljs-string">"wechatPayService"</span>)</span>
<span class="hljs-keyword">private</span> PaymentService wechatPayService;

<span class="hljs-meta">@Resource(name = <span class="hljs-string">"bankCardService"</span>)</span>
<span class="hljs-keyword">private</span> PaymentService bankCardService;

<span class="hljs-keyword">public</span> PaymentService getPaymentService(PaymentType paymentType) {
switch (paymentType) {
case ALIPAY:
<span class="hljs-keyword">return</span> alipayService;
case WECHAT:
<span class="hljs-keyword">return</span> wechatPayService;
case BANK_CARD:
<span class="hljs-keyword">return</span> bankCardService;
default:
<span class="hljs-keyword">throw</span> new IllegalArgumentException(<span class="hljs-string">"ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼ï¼š"</span> + paymentType);
}
}
}
</code></pre>
<h2 data-id="heading-11">é‡æ„æ•ˆæœå¯¹æ¯”</h2>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
* é‡æ„å‰åçš„å¯¹æ¯”åˆ†æ
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RefactoringComparison</span> {

@Test
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compareBeforeAndAfter</span>()</span> {

System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"é‡æ„æ•ˆæœå¯¹æ¯”ï¼š"</span>);
System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"============================================"</span>);

<span class="hljs-comment">// ä»£ç è´¨é‡æŒ‡æ ‡</span>
printMetric(<span class="hljs-string">"å¾ªç¯ä¾èµ–é£é™©"</span>, <span class="hljs-string">"é«˜"</span>, <span class="hljs-string">"ä½"</span>);
printMetric(<span class="hljs-string">"å•å…ƒæµ‹è¯•éš¾åº¦"</span>, <span class="hljs-string">"å›°éš¾"</span>, <span class="hljs-string">"å®¹æ˜“"</span>);
printMetric(<span class="hljs-string">"å¯åŠ¨é€Ÿåº¦"</span>, <span class="hljs-string">"è¾ƒæ…¢"</span>, <span class="hljs-string">"è¾ƒå¿«"</span>);
printMetric(<span class="hljs-string">"Beanæ³¨å…¥æ­§ä¹‰"</span>, <span class="hljs-string">"å®¹æ˜“å‡ºç°"</span>, <span class="hljs-string">"æå°‘å‡ºç°"</span>);
printMetric(<span class="hljs-string">"ä»£ç å¯è¯»æ€§"</span>, <span class="hljs-string">"ä¸€èˆ¬"</span>, <span class="hljs-string">"ä¼˜ç§€"</span>);
printMetric(<span class="hljs-string">"ä¾èµ–å…³ç³»æ¸…æ™°åº¦"</span>, <span class="hljs-string">"æ¨¡ç³Š"</span>, <span class="hljs-string">"æ¸…æ™°"</span>);
printMetric(<span class="hljs-string">"ç¼–è¯‘æœŸé”™è¯¯æ£€æµ‹"</span>, <span class="hljs-string">"å¼±"</span>, <span class="hljs-string">"å¼º"</span>);

System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"============================================"</span>);

<span class="hljs-comment">// æ€§èƒ½æŒ‡æ ‡</span>
printMetric(<span class="hljs-string">"åº”ç”¨å¯åŠ¨æ—¶é—´"</span>, <span class="hljs-string">"3.2s"</span>, <span class="hljs-string">"2.8s"</span>);
printMetric(<span class="hljs-string">"Beanæ³¨å…¥è€—æ—¶"</span>, <span class="hljs-string">"347ms"</span>, <span class="hljs-string">"259ms"</span>);
printMetric(<span class="hljs-string">"å†…å­˜ä½¿ç”¨"</span>, <span class="hljs-string">"245MB"</span>, <span class="hljs-string">"238MB"</span>);

<span class="hljs-comment">/*
é‡æ„æ€»ç»“ï¼š
1. ä»£ç è´¨é‡æ˜¾è‘—æå‡
2. æ€§èƒ½æœ‰ä¸€å®šæ”¹å–„
3. å¯ç»´æŠ¤æ€§å¤§å¹…æé«˜
4. å›¢é˜Ÿå¼€å‘æ›´è§„èŒƒ
*/</span>
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printMetric</span>(<span class="hljs-params">String metric, String before, String after</span>)</span> {
System.<span class="hljs-keyword">out</span>.printf(<span class="hljs-string">"%-15s: %s -&gt; %s%n"</span>, metric, before, after);
}
}
</code></pre>
<h2 data-id="heading-12">å•å…ƒæµ‹è¯•å‹å¥½æ€§å¯¹æ¯”</h2>
<p>è¿™æ˜¯@Resourceç›¸æ¯”@Autowiredçš„å¦ä¸€ä¸ªé‡è¦ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public class TestFriendlinessComparison {

<span class="hljs-comment">/**
* @Autowiredçš„æµ‹è¯•å›°éš¾
*/</span>
public static class AutowiredServiceTest {

<span class="hljs-keyword">@ExtendWith</span>(MockitoExtension.class)
class OrderServiceTest {

<span class="hljs-keyword">@InjectMocks</span>
private OrderService orderService; <span class="hljs-comment">// å­—æ®µæ³¨å…¥ï¼Œæµ‹è¯•å¤æ‚</span>

<span class="hljs-keyword">@Mock</span>
private PaymentService paymentService;

<span class="hljs-keyword">@Mock</span>
private NotificationService notificationService;

<span class="hljs-keyword">@Test</span>
void testCreateOrder() {
<span class="hljs-comment">// æµ‹è¯•ä»£ç å¤æ‚ï¼Œéœ€è¦ä½¿ç”¨åå°„æˆ–@InjectMocks</span>
<span class="hljs-comment">// è€Œä¸”@InjectMocksæœ‰å¾ˆå¤šé™åˆ¶å’Œå‘</span>

CreateOrderRequest request = new <span class="hljs-built_in">CreateOrderRequest</span>();
request<span class="hljs-selector-class">.setAmount</span>(new BigDecimal("<span class="hljs-number">100.00</span>"));

<span class="hljs-comment">// Mockè®¾ç½®</span>
<span class="hljs-built_in">when</span>(paymentService.processPayment(any()))<span class="hljs-selector-class">.thenReturn</span>(true);

<span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
<span class="hljs-attribute">Order</span> result = orderService<span class="hljs-selector-class">.createOrder</span>(request);

<span class="hljs-comment">// éªŒè¯ç»“æœ</span>
<span class="hljs-built_in">assertThat</span>(result)<span class="hljs-selector-class">.isNotNull</span>();
<span class="hljs-built_in">verify</span>(paymentService)<span class="hljs-selector-class">.processPayment</span>(any());
}
}
}

<span class="hljs-comment">/**
* æ„é€ å™¨æ³¨å…¥çš„æµ‹è¯•å‹å¥½æ€§
*/</span>
public static class ConstructorInjectionTest {

class OrderServiceTest {

private OrderService orderService;
private PaymentService paymentService;
private OrderRepository orderRepository;
private NotificationService notificationService;

<span class="hljs-keyword">@BeforeEach</span>
void setUp() {
<span class="hljs-comment">// ç®€å•ç›´æ¥ï¼Œæ— éœ€ç‰¹æ®Šæ³¨è§£</span>
paymentService = <span class="hljs-built_in">mock</span>(PaymentService.class);
orderRepository = <span class="hljs-built_in">mock</span>(OrderRepository.class);
notificationService = <span class="hljs-built_in">mock</span>(NotificationService.class);

<span class="hljs-comment">// ç›´æ¥é€šè¿‡æ„é€ å™¨åˆ›å»ºï¼Œç®€å•æ˜äº†</span>
orderService = new <span class="hljs-built_in">OrderService</span>(
orderRepository,
new PaymentServiceFactory(paymentService),
notificationService
);
}

<span class="hljs-keyword">@Test</span>
void testCreateOrder() {
<span class="hljs-comment">// æµ‹è¯•ä»£ç ç®€æ´æ¸…æ™°</span>
CreateOrderRequest request = new <span class="hljs-built_in">CreateOrderRequest</span>();
request<span class="hljs-selector-class">.setAmount</span>(new BigDecimal("<span class="hljs-number">100.00</span>"));

<span class="hljs-comment">// Mockè®¾ç½®</span>
<span class="hljs-attribute">Order</span> savedOrder = new <span class="hljs-attribute">Order</span>();
savedOrder<span class="hljs-selector-class">.setId</span>(<span class="hljs-number">1</span>L);
<span class="hljs-built_in">when</span>(orderRepository.save(any()))<span class="hljs-selector-class">.thenReturn</span>(savedOrder);
<span class="hljs-built_in">when</span>(paymentService.processPayment(any()))<span class="hljs-selector-class">.thenReturn</span>(true);

<span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
<span class="hljs-attribute">Order</span> result = orderService<span class="hljs-selector-class">.createOrder</span>(request);

<span class="hljs-comment">// éªŒè¯ç»“æœ</span>
<span class="hljs-built_in">assertThat</span>(result)<span class="hljs-selector-class">.isNotNull</span>();
<span class="hljs-built_in">assertThat</span>(result.getId())<span class="hljs-selector-class">.isEqualTo</span>(<span class="hljs-number">1</span>L);

<span class="hljs-comment">// éªŒè¯äº¤äº’</span>
<span class="hljs-built_in">verify</span>(orderRepository)<span class="hljs-selector-class">.save</span>(any());
<span class="hljs-built_in">verify</span>(paymentService)<span class="hljs-selector-class">.processPayment</span>(any());
<span class="hljs-built_in">verify</span>(notificationService)<span class="hljs-selector-class">.sendOrderCreatedNotification</span>(any());
}

<span class="hljs-keyword">@Test</span>
void testCreateOrderWithNullRepository() {
<span class="hljs-comment">// æ„é€ å™¨æ³¨å…¥è®©ç©ºæŒ‡é’ˆé—®é¢˜åœ¨ç¼–è¯‘æœŸå°±èƒ½å‘ç°</span>
<span class="hljs-built_in">assertThrows</span>(NullPointerException.class, () -&gt; {
new <span class="hljs-built_in">OrderService</span>(null, paymentServiceFactory, notificationService);
});
}
}
}
}
</code></pre>
<h2 data-id="heading-13">ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µæŒ‡å—</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyInjectionBestPractices</span> {

<span class="hljs-comment">/**
* ä¾èµ–æ³¨å…¥ç­–ç•¥é€‰æ‹©æŒ‡å—
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">InjectionStrategy</span> {

<span class="hljs-title function_">CONSTRUCTOR</span>(<span class="hljs-string">"æ„é€ å™¨æ³¨å…¥"</span>, <span class="hljs-string">"å¼ºåˆ¶ä¾èµ–ï¼Œä¸å¯å˜å­—æ®µ"</span>),
<span class="hljs-title function_">RESOURCE</span>(<span class="hljs-string">"@Resourceæ³¨å…¥"</span>, <span class="hljs-string">"å¯é€‰ä¾èµ–ï¼Œç²¾ç¡®åŒ¹é…"</span>),
<span class="hljs-title function_">SETTER</span>(<span class="hljs-string">"Setteræ³¨å…¥"</span>, <span class="hljs-string">"å¯é€‰ä¾èµ–ï¼Œå¯å˜é…ç½®"</span>),
<span class="hljs-title function_">AUTOWIRED</span>(<span class="hljs-string">"@Autowiredæ³¨å…¥"</span>, <span class="hljs-string">"ç±»å‹ä¼˜å…ˆï¼Œå…¼å®¹æ€§å¥½"</span>);

<span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> name;
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> useCase;

<span class="hljs-title class_">InjectionStrategy</span>(<span class="hljs-title class_">String</span> name, <span class="hljs-title class_">String</span> useCase) {
<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
<span class="hljs-variable language_">this</span>.<span class="hljs-property">useCase</span> = useCase;
}

<span class="hljs-comment">/**
* æ ¹æ®åœºæ™¯é€‰æ‹©æœ€ä½³æ³¨å…¥ç­–ç•¥
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">InjectionStrategy</span> <span class="hljs-title function_">chooseStrategy</span>(<span class="hljs-params">DependencyContext context</span>) {

<span class="hljs-comment">// æ ¸å¿ƒä¸šåŠ¡ä¾èµ–ï¼šæ„é€ å™¨æ³¨å…¥</span>
<span class="hljs-keyword">if</span> (context.<span class="hljs-title function_">isCoreDependency</span>() &amp;&amp; !context.<span class="hljs-title function_">isOptional</span>()) {
<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">CONSTRUCTOR</span>;
}

<span class="hljs-comment">// å¯é€‰ä¾èµ–ï¼Œä¸”æœ‰æ˜ç¡®Beanåç§°ï¼š@Resource</span>
<span class="hljs-keyword">if</span> (context.<span class="hljs-title function_">isOptional</span>() &amp;&amp; context.<span class="hljs-title function_">hasSpecificBeanName</span>()) {
<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">RESOURCE</span>;
}

<span class="hljs-comment">// é…ç½®ç±»ä¾èµ–ï¼šSetteræ³¨å…¥</span>
<span class="hljs-keyword">if</span> (context.<span class="hljs-title function_">isConfigurationProperty</span>()) {
<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">SETTER</span>;
}

<span class="hljs-comment">// å…¼å®¹æ€§è¦æ±‚é«˜ï¼š@Autowired</span>
<span class="hljs-keyword">if</span> (context.<span class="hljs-title function_">needsBackwardCompatibility</span>()) {
<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">AUTOWIRED</span>;
}

<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">RESOURCE</span>; <span class="hljs-comment">// é»˜è®¤æ¨è</span>
}
}

<span class="hljs-comment">/**
* é¡¹ç›®çº§åˆ«çš„ä¾èµ–æ³¨å…¥è§„èŒƒ
*/</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyInjectionStandards</span> {

<span class="hljs-comment">/**
* âœ… æ¨èçš„Serviceå±‚å†™æ³•
*/</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecommendedServiceExample</span> {

<span class="hljs-comment">// 1. æ ¸å¿ƒä¾èµ–ï¼šæ„é€ å™¨æ³¨å…¥ï¼ˆfinalå­—æ®µï¼‰</span>
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">UserRepository</span> userRepository;
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">PasswordEncoder</span> passwordEncoder;

<span class="hljs-comment">// 2. å¯é€‰ä¾èµ–ï¼š@Resourceæ³¨å…¥</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">RedisTemplate</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; redisTemplate;

<span class="hljs-meta">@Resource</span>(name = <span class="hljs-string">"primaryEmailService"</span>)
<span class="hljs-keyword">private</span> <span class="hljs-title class_">EmailService</span> emailService;

<span class="hljs-comment">// 3. æ„é€ å™¨ï¼šåªåŒ…å«æ ¸å¿ƒä¾èµ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">RecommendedServiceExample</span>(<span class="hljs-title class_">UserRepository</span> userRepository,
<span class="hljs-title class_">PasswordEncoder</span> passwordEncoder) {
<span class="hljs-variable language_">this</span>.<span class="hljs-property">userRepository</span> = userRepository;
<span class="hljs-variable language_">this</span>.<span class="hljs-property">passwordEncoder</span> = passwordEncoder;
}

<span class="hljs-comment">// 4. ä¸šåŠ¡æ–¹æ³•ï¼šæ¸…æ™°çš„ä¾èµ–å…³ç³»</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">User</span> <span class="hljs-title function_">createUser</span>(<span class="hljs-params">CreateUserRequest request</span>) {
<span class="hljs-comment">// æ•°æ®éªŒè¯</span>
<span class="hljs-title function_">validateUserRequest</span>(request);

<span class="hljs-comment">// å¯†ç åŠ å¯†</span>
<span class="hljs-title class_">String</span> encodedPassword = passwordEncoder.<span class="hljs-title function_">encode</span>(request.<span class="hljs-title function_">getPassword</span>());

<span class="hljs-comment">// åˆ›å»ºç”¨æˆ·</span>
<span class="hljs-title class_">User</span> user = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
user.<span class="hljs-title function_">setUsername</span>(request.<span class="hljs-title function_">getUsername</span>());
user.<span class="hljs-title function_">setPassword</span>(encodedPassword);
user.<span class="hljs-title function_">setEmail</span>(request.<span class="hljs-title function_">getEmail</span>());

<span class="hljs-comment">// ä¿å­˜ç”¨æˆ·</span>
user = userRepository.<span class="hljs-title function_">save</span>(user);

<span class="hljs-comment">// ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ï¼ˆå¯é€‰æ“ä½œï¼‰</span>
<span class="hljs-title function_">cacheUser</span>(user);

<span class="hljs-comment">// å‘é€æ¬¢è¿é‚®ä»¶ï¼ˆå¯é€‰æ“ä½œï¼‰</span>
<span class="hljs-title function_">sendWelcomeEmail</span>(user);

<span class="hljs-keyword">return</span> user;
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">cacheUser</span>(<span class="hljs-params">User user</span>) {
<span class="hljs-keyword">if</span> (redisTemplate != <span class="hljs-literal">null</span>) {
<span class="hljs-title class_">String</span> cacheKey = <span class="hljs-string">"user:"</span> + user.<span class="hljs-title function_">getId</span>();
redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">set</span>(cacheKey, user, <span class="hljs-title class_">Duration</span>.<span class="hljs-title function_">ofHours</span>(<span class="hljs-number">1</span>));
}
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">sendWelcomeEmail</span>(<span class="hljs-params">User user</span>) {
<span class="hljs-keyword">if</span> (emailService != <span class="hljs-literal">null</span>) {
emailService.<span class="hljs-title function_">sendWelcomeEmail</span>(user.<span class="hljs-title function_">getEmail</span>(), user.<span class="hljs-title function_">getUsername</span>());
}
}
}

<span class="hljs-comment">/**
* âœ… æ¨èçš„Controllerå±‚å†™æ³•
*/</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/api/users"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecommendedControllerExample</span> {

<span class="hljs-comment">// æ ¸å¿ƒä¾èµ–ï¼šæ„é€ å™¨æ³¨å…¥</span>
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">UserService</span> userService;
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">UserValidator</span> userValidator;

<span class="hljs-comment">// å¯é€‰ä¾èµ–ï¼š@Resourceæ³¨å…¥</span>
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">MetricsService</span> metricsService;

<span class="hljs-keyword">public</span> <span class="hljs-title class_">RecommendedControllerExample</span>(<span class="hljs-title class_">UserService</span> userService,
<span class="hljs-title class_">UserValidator</span> userValidator) {
<span class="hljs-variable language_">this</span>.<span class="hljs-property">userService</span> = userService;
<span class="hljs-variable language_">this</span>.<span class="hljs-property">userValidator</span> = userValidator;
}

<span class="hljs-meta">@PostMapping</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">ResponseEntity</span>&lt;<span class="hljs-title class_">UserDto</span>&gt; <span class="hljs-title function_">createUser</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> CreateUserRequest request</span>) {

<span class="hljs-comment">// è®°å½•è¯·æ±‚æŒ‡æ ‡</span>
<span class="hljs-title function_">recordMetrics</span>(<span class="hljs-string">"user.create.request"</span>);

<span class="hljs-keyword">try</span> {
<span class="hljs-comment">// å‚æ•°éªŒè¯</span>
userValidator.<span class="hljs-title function_">validate</span>(request);

<span class="hljs-comment">// ä¸šåŠ¡å¤„ç†</span>
<span class="hljs-title class_">User</span> user = userService.<span class="hljs-title function_">createUser</span>(request);

<span class="hljs-comment">// è½¬æ¢DTO</span>
<span class="hljs-title class_">UserDto</span> userDto = <span class="hljs-title class_">UserDto</span>.<span class="hljs-title function_">fromEntity</span>(user);

<span class="hljs-comment">// è®°å½•æˆåŠŸæŒ‡æ ‡</span>
<span class="hljs-title function_">recordMetrics</span>(<span class="hljs-string">"user.create.success"</span>);

<span class="hljs-keyword">return</span> <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">ok</span>(userDto);

} <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
<span class="hljs-comment">// è®°å½•å¤±è´¥æŒ‡æ ‡</span>
<span class="hljs-title function_">recordMetrics</span>(<span class="hljs-string">"user.create.error"</span>);
<span class="hljs-keyword">throw</span> e;
}
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">recordMetrics</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> metricName</span>) {
<span class="hljs-keyword">if</span> (metricsService != <span class="hljs-literal">null</span>) {
metricsService.<span class="hljs-title function_">increment</span>(metricName);
}
}
}
}

<span class="hljs-comment">/**
* ä¾èµ–æ³¨å…¥ç›‘æ§å’Œè¯Šæ–­
*/</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyInjectionMonitor</span> {

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">Logger</span> log = <span class="hljs-title class_">LoggerFactory</span>.<span class="hljs-title function_">getLogger</span>(<span class="hljs-title class_">DependencyInjectionMonitor</span>.<span class="hljs-property">class</span>);

<span class="hljs-meta">@EventListener</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleBeanCreationEvent</span>(<span class="hljs-params">BeanCreationEvent event</span>) {

<span class="hljs-title class_">String</span> beanName = event.<span class="hljs-title function_">getBeanName</span>();
<span class="hljs-title class_">Class</span>&lt;?&gt; beanClass = event.<span class="hljs-title function_">getBeanClass</span>();
long creationTime = event.<span class="hljs-title function_">getCreationTime</span>();

<span class="hljs-comment">// è®°å½•Beanåˆ›å»ºæ—¶é—´</span>
log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">"Beanåˆ›å»ºï¼š{}ï¼ˆ{}ï¼‰è€—æ—¶ï¼š{}ms"</span>, beanName, beanClass.<span class="hljs-title function_">getSimpleName</span>(), creationTime);

<span class="hljs-comment">// æ£€æµ‹æ½œåœ¨é—®é¢˜</span>
<span class="hljs-title function_">checkPotentialIssues</span>(beanClass);
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">checkPotentialIssues</span>(<span class="hljs-params">Class&lt;?&gt; beanClass</span>) {

<span class="hljs-comment">// æ£€æµ‹å­—æ®µæ³¨å…¥</span>
<span class="hljs-title class_">Field</span>[] fields = beanClass.<span class="hljs-title function_">getDeclaredFields</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : fields) {
<span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">isAnnotationPresent</span>(<span class="hljs-title class_">Autowired</span>.<span class="hljs-property">class</span>)) {
log.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"æ£€æµ‹åˆ°@Autowiredå­—æ®µæ³¨å…¥ï¼š{}.{}ï¼Œå»ºè®®ä½¿ç”¨æ„é€ å™¨æ³¨å…¥æˆ–@Resource"</span>,
beanClass.<span class="hljs-title function_">getSimpleName</span>(), field.<span class="hljs-title function_">getName</span>());
}
}

<span class="hljs-comment">// æ£€æµ‹æ„é€ å™¨æ•°é‡</span>
<span class="hljs-title class_">Constructor</span>&lt;?&gt;[] constructors = beanClass.<span class="hljs-title function_">getConstructors</span>();
<span class="hljs-keyword">if</span> (constructors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>) {
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ç±»{}æœ‰å¤šä¸ªæ„é€ å™¨ï¼Œè¯·ç¡®ä¿ä¾èµ–æ³¨å…¥ç­–ç•¥æ­£ç¡®"</span>, beanClass.<span class="hljs-title function_">getSimpleName</span>());
}
}

<span class="hljs-comment">/**
* ç”Ÿæˆä¾èµ–æ³¨å…¥æŠ¥å‘Š
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">generateDependencyReport</span>(<span class="hljs-params"/>) {
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"=== ä¾èµ–æ³¨å…¥ä½¿ç”¨æƒ…å†µæŠ¥å‘Š ==="</span>);

<span class="hljs-comment">// ç»Ÿè®¡å„ç§æ³¨å…¥æ–¹å¼çš„ä½¿ç”¨æƒ…å†µ</span>
<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Integer</span>&gt; injectionStats = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
injectionStats.<span class="hljs-title function_">put</span>(<span class="hljs-string">"@Autowiredå­—æ®µæ³¨å…¥"</span>, <span class="hljs-title function_">countAutowiredFields</span>());
injectionStats.<span class="hljs-title function_">put</span>(<span class="hljs-string">"@Resourceæ³¨å…¥"</span>, <span class="hljs-title function_">countResourceFields</span>());
injectionStats.<span class="hljs-title function_">put</span>(<span class="hljs-string">"æ„é€ å™¨æ³¨å…¥"</span>, <span class="hljs-title function_">countConstructorInjection</span>());

injectionStats.<span class="hljs-title function_">forEach</span>((<span class="hljs-keyword">type</span>, count) -&gt; {
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"{}: {}ä¸ª"</span>, <span class="hljs-keyword">type</span>, count);
});

<span class="hljs-comment">// ç»™å‡ºæ”¹è¿›å»ºè®®</span>
<span class="hljs-title function_">generateImprovementSuggestions</span>(injectionStats);
}

<span class="hljs-keyword">private</span> int <span class="hljs-title function_">countAutowiredFields</span>(<span class="hljs-params"/>) {
<span class="hljs-comment">// å®ç°ç»Ÿè®¡é€»è¾‘</span>
<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-keyword">private</span> int <span class="hljs-title function_">countResourceFields</span>(<span class="hljs-params"/>) {
<span class="hljs-comment">// å®ç°ç»Ÿè®¡é€»è¾‘</span>
<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-keyword">private</span> int <span class="hljs-title function_">countConstructorInjection</span>(<span class="hljs-params"/>) {
<span class="hljs-comment">// å®ç°ç»Ÿè®¡é€»è¾‘</span>
<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">generateImprovementSuggestions</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, Integer&gt; stats</span>) {

int autowiredCount = stats.<span class="hljs-title function_">get</span>(<span class="hljs-string">"@Autowiredå­—æ®µæ³¨å…¥"</span>);
int resourceCount = stats.<span class="hljs-title function_">get</span>(<span class="hljs-string">"@Resourceæ³¨å…¥"</span>);

<span class="hljs-keyword">if</span> (autowiredCount &gt; resourceCount * <span class="hljs-number">2</span>) {
log.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"å»ºè®®ï¼š@Autowiredä½¿ç”¨è¿‡å¤šï¼Œè€ƒè™‘è¿ç§»åˆ°@Resourceæˆ–æ„é€ å™¨æ³¨å…¥"</span>);
}

<span class="hljs-keyword">if</span> (stats.<span class="hljs-title function_">get</span>(<span class="hljs-string">"æ„é€ å™¨æ³¨å…¥"</span>) &lt; <span class="hljs-number">10</span>) {
log.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"å»ºè®®ï¼šæ„é€ å™¨æ³¨å…¥ä½¿ç”¨è¾ƒå°‘ï¼Œå»ºè®®æ ¸å¿ƒä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥"</span>);
}
}
}
}
<span class="hljs-comment">/**
* ä¾èµ–ä¸Šä¸‹æ–‡ä¿¡æ¯
*/</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyContext</span> {
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> coreDependency;
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> optional;
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> hasSpecificBeanName;
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> configurationProperty;
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> needsBackwardCompatibility;
<span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> beanName;
<span class="hljs-keyword">private</span> <span class="hljs-title class_">Class</span>&lt;?&gt; dependencyType;
}
</code></pre>
<h2 data-id="heading-14">è¿ç§»æŒ‡å—ï¼šå¹³æ»‘è¿‡æ¸¡åˆ°æœ€ä½³å®è·µ</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationGuide</span> {

<span class="hljs-comment">/**
* åˆ†é˜¶æ®µè¿ç§»è®¡åˆ’
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MigrationPhase</span> {

<span class="hljs-title function_">PHASE_1</span>(<span class="hljs-string">"è¯„ä¼°é˜¶æ®µ"</span>, <span class="hljs-string">"åˆ†æç°æœ‰ä»£ç ï¼Œè¯†åˆ«é—®é¢˜"</span>),
<span class="hljs-title function_">PHASE_2</span>(<span class="hljs-string">"æ ¸å¿ƒè¿ç§»"</span>, <span class="hljs-string">"è¿ç§»æ ¸å¿ƒä¸šåŠ¡ç±»åˆ°æ„é€ å™¨æ³¨å…¥"</span>),
<span class="hljs-title function_">PHASE_3</span>(<span class="hljs-string">"@Resourceæ›¿æ¢"</span>, <span class="hljs-string">"å°†@Autowiredæ›¿æ¢ä¸º@Resource"</span>),
<span class="hljs-title function_">PHASE_4</span>(<span class="hljs-string">"æµ‹è¯•ä¼˜åŒ–"</span>, <span class="hljs-string">"ä¼˜åŒ–å•å…ƒæµ‹è¯•"</span>),
<span class="hljs-title function_">PHASE_5</span>(<span class="hljs-string">"ç›‘æ§éªŒè¯"</span>, <span class="hljs-string">"æ·»åŠ ç›‘æ§ï¼ŒéªŒè¯æ•ˆæœ"</span>);

<span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> name;
<span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> description;

<span class="hljs-title class_">MigrationPhase</span>(<span class="hljs-title class_">String</span> name, <span class="hljs-title class_">String</span> description) {
<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
<span class="hljs-variable language_">this</span>.<span class="hljs-property">description</span> = description;
}
}

<span class="hljs-comment">/**
* è‡ªåŠ¨åŒ–è¿ç§»å·¥å…·
*/</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AutoMigrationTool</span> {

<span class="hljs-comment">/**
* æ‰«æé¡¹ç›®ä¸­çš„ä¾èµ–æ³¨å…¥ä½¿ç”¨æƒ…å†µ
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">MigrationReport</span> <span class="hljs-title function_">scanProject</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> packageName</span>) {

<span class="hljs-title class_">MigrationReport</span> report = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MigrationReport</span>();

<span class="hljs-comment">// æ‰«ææ‰€æœ‰ç±»</span>
<span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Class</span>&lt;?&gt;&gt; classes = <span class="hljs-title function_">scanClasses</span>(packageName);

<span class="hljs-keyword">for</span> (<span class="hljs-title class_">Class</span>&lt;?&gt; clazz : classes) {
<span class="hljs-title function_">analyzeClass</span>(clazz, report);
}

<span class="hljs-comment">// ç”Ÿæˆè¿ç§»å»ºè®®</span>
<span class="hljs-title function_">generateMigrationSuggestions</span>(report);

<span class="hljs-keyword">return</span> report;
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">analyzeClass</span>(<span class="hljs-params">Class&lt;?&gt; clazz, MigrationReport report</span>) {

<span class="hljs-title class_">ClassAnalysis</span> analysis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassAnalysis</span>();
analysis.<span class="hljs-title function_">setClassName</span>(clazz.<span class="hljs-title function_">getName</span>());

<span class="hljs-comment">// åˆ†æå­—æ®µæ³¨å…¥</span>
<span class="hljs-title class_">Field</span>[] fields = clazz.<span class="hljs-title function_">getDeclaredFields</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : fields) {
<span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">isAnnotationPresent</span>(<span class="hljs-title class_">Autowired</span>.<span class="hljs-property">class</span>)) {
analysis.<span class="hljs-title function_">addAutowiredField</span>(field.<span class="hljs-title function_">getName</span>());
report.<span class="hljs-title function_">incrementAutowiredCount</span>();
}

<span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">isAnnotationPresent</span>(<span class="hljs-title class_">Resource</span>.<span class="hljs-property">class</span>)) {
analysis.<span class="hljs-title function_">addResourceField</span>(field.<span class="hljs-title function_">getName</span>());
report.<span class="hljs-title function_">incrementResourceCount</span>();
}
}

<span class="hljs-comment">// åˆ†ææ„é€ å™¨</span>
<span class="hljs-title class_">Constructor</span>&lt;?&gt;[] constructors = clazz.<span class="hljs-title function_">getConstructors</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-title class_">Constructor</span>&lt;?&gt; constructor : constructors) {
<span class="hljs-keyword">if</span> (constructor.<span class="hljs-title function_">getParameterCount</span>() &gt; <span class="hljs-number">0</span>) {
analysis.<span class="hljs-title function_">setHasConstructorInjection</span>(<span class="hljs-literal">true</span>);
report.<span class="hljs-title function_">incrementConstructorCount</span>();
}
}

report.<span class="hljs-title function_">addClassAnalysis</span>(analysis);
}

<span class="hljs-keyword">private</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Class</span>&lt;?&gt;&gt; <span class="hljs-title function_">scanClasses</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> packageName</span>) {
<span class="hljs-comment">// å®ç°ç±»æ‰«æé€»è¾‘</span>
<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">generateMigrationSuggestions</span>(<span class="hljs-params">MigrationReport report</span>) {

<span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; suggestions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

<span class="hljs-keyword">if</span> (report.<span class="hljs-title function_">getAutowiredCount</span>() &gt; <span class="hljs-number">0</span>) {
suggestions.<span class="hljs-title function_">add</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">format</span>(<span class="hljs-string">"å‘ç°%dä¸ª@Autowiredå­—æ®µæ³¨å…¥ï¼Œå»ºè®®è¿ç§»åˆ°@Resource"</span>,
report.<span class="hljs-title function_">getAutowiredCount</span>()));
}

<span class="hljs-keyword">if</span> (report.<span class="hljs-title function_">getConstructorCount</span>() &lt; report.<span class="hljs-title function_">getTotalClasses</span>() * <span class="hljs-number">0.3</span>) {
suggestions.<span class="hljs-title function_">add</span>(<span class="hljs-string">"æ„é€ å™¨æ³¨å…¥ä½¿ç”¨ç‡è¾ƒä½ï¼Œå»ºè®®æ ¸å¿ƒä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥"</span>);
}

report.<span class="hljs-title function_">setSuggestions</span>(suggestions);
}
}

<span class="hljs-comment">/**
* è¿ç§»æŠ¥å‘Š
*/</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationReport</span> {
<span class="hljs-keyword">private</span> int totalClasses;
<span class="hljs-keyword">private</span> int autowiredCount;
<span class="hljs-keyword">private</span> int resourceCount;
<span class="hljs-keyword">private</span> int constructorCount;
<span class="hljs-keyword">private</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">ClassAnalysis</span>&gt; classAnalyses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
<span class="hljs-keyword">private</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; suggestions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">incrementAutowiredCount</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">autowiredCount</span>++; }
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">incrementResourceCount</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">resourceCount</span>++; }
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">incrementConstructorCount</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">constructorCount</span>++; }
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addClassAnalysis</span>(<span class="hljs-params">ClassAnalysis analysis</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">classAnalyses</span>.<span class="hljs-title function_">add</span>(analysis); }
}

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassAnalysis</span> {
<span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> className;
<span class="hljs-keyword">private</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; autowiredFields = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
<span class="hljs-keyword">private</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; resourceFields = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
<span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> hasConstructorInjection;

<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addAutowiredField</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> fieldName</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">autowiredFields</span>.<span class="hljs-title function_">add</span>(fieldName); }
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addResourceField</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> fieldName</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">resourceFields</span>.<span class="hljs-title function_">add</span>(fieldName); }
}
}
</code></pre>
<h2 data-id="heading-15">æ€»ç»“ï¼šæ‹¥æŠ±@Resourceï¼Œå‘Šåˆ«@Autowired</h2>
<p>ç»è¿‡æ·±å…¥çš„æŠ€æœ¯åˆ†æå’Œå®æˆ˜éªŒè¯ï¼Œæˆ‘å¾—å‡ºå‡ ä¸ªé‡è¦ç»“è®ºï¼š</p>
<h2 data-id="heading-16">ğŸ¯ æ ¸å¿ƒè§‚ç‚¹</h2>
<p><strong>Springå®˜æ–¹ç¡®å®ä¸æ¨èè¿‡åº¦ä½¿ç”¨@Autowired</strong>ï¼Œç‰¹åˆ«æ˜¯å­—æ®µæ³¨å…¥æ–¹å¼ã€‚å®˜æ–¹æ¨èçš„ä¼˜å…ˆçº§æ˜¯ï¼š</p>
<ol>
<li><strong>æ„é€ å™¨æ³¨å…¥</strong>ï¼ˆå¼ºåˆ¶ä¾èµ–ï¼‰</li>
<li><strong>@Resourceæ³¨å…¥</strong>ï¼ˆå¯é€‰ä¾èµ–ï¼‰</li>
<li><strong>Setteræ³¨å…¥</strong>ï¼ˆé…ç½®å±æ€§ï¼‰</li>
<li><strong>@Autowiredæ³¨å…¥</strong>ï¼ˆå…¼å®¹æ€§åœºæ™¯ï¼‰</li>
</ol>
<h2 data-id="heading-17">âš¡ æ€§èƒ½å¯¹æ¯”æ€»ç»“</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a0a7e3dac1d454584030411931f85a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5Y2h5be05Y2h:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767681712&amp;x-signature=WI2OItVAhF39vEcryLCnh9x3gdc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-18">æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>æ ¸å¿ƒä¸šåŠ¡ä¾èµ–</strong>ï¼šä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä¿è¯ä¸å¯å˜æ€§</li>
<li><strong>å¯é€‰ä¾èµ–</strong>ï¼šä½¿ç”¨@Resourceï¼Œç²¾ç¡®åŒ¹é…Bean</li>
<li><strong>å¤šå®ç°åœºæ™¯</strong>ï¼š@Resource + å·¥å‚æ¨¡å¼</li>
<li><strong>é—ç•™ä»£ç </strong>ï¼šåˆ†é˜¶æ®µè¿ç§»ï¼Œå…ˆè§£å†³å¾ªç¯ä¾èµ–</li>
<li><strong>å›¢é˜Ÿè§„èŒƒ</strong>ï¼šåˆ¶å®šç¼–ç æ ‡å‡†ï¼Œå·¥å…·è¾…åŠ©æ£€æŸ¥</li>
</ol>
<h2 data-id="heading-19">å†™åœ¨æœ€å</h2>
<p>é‚£æ¬¡ç”Ÿäº§ç¯å¢ƒçš„å¾ªç¯ä¾èµ–äº‹æ•…è®©æˆ‘æ·±åˆ»è®¤è¯†åˆ°ï¼Œ<strong>é€‰æ‹©åˆé€‚çš„ä¾èµ–æ³¨å…¥æ–¹å¼ä¸ä»…ä»…æ˜¯ä»£ç é£æ ¼é—®é¢˜ï¼Œæ›´å…³ç³»åˆ°ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§</strong>ã€‚</p>
<p>@Resourceè™½ç„¶æ²¡æœ‰@Autowiredé‚£ä¹ˆ"çŸ¥å"ï¼Œä½†å®ƒç¡®å®æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚æ­£å¦‚é‚£å¥è¯ï¼š <strong>"æµè¡Œçš„ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ï¼Œæœ€å¥½çš„å¾€å¾€è¢«å¿½è§†"</strong> ã€‚</p>
<p>ä½ çš„é¡¹ç›®ä¸­æ˜¯å¦ä¹Ÿå­˜åœ¨@Autowiredæ»¥ç”¨çš„é—®é¢˜ï¼Ÿå‡†å¤‡å¼€å§‹è¿ç§»åˆ°@Resourceäº†å—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒå’Œçœ‹æ³•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çœ‹åˆ°å¤§ä½¬åšå››æ ¼æ¼«ç”»æ—¥å…¥400+ï¼Œæˆ‘è§‰å¾—åº”è¯¥åšäº›ä»€ä¹ˆäº†ï¼]]></title>    <link>https://juejin.cn/post/7589207474134188082</link>    <guid>https://juejin.cn/post/7589207474134188082</guid>    <pubDate>2025-12-30T03:39:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589207474134188082" data-draft-id="7589168816527441947" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çœ‹åˆ°å¤§ä½¬åšå››æ ¼æ¼«ç”»æ—¥å…¥400+ï¼Œæˆ‘è§‰å¾—åº”è¯¥åšäº›ä»€ä¹ˆäº†ï¼"/> <meta itemprop="keywords" content="AIGC,å·¥ä½œæµå¼•æ“"/> <meta itemprop="datePublished" content="2025-12-30T03:39:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ›¹å·¥ä¸åŠ ç­"/> <meta itemprop="url" content="https://juejin.cn/user/4336129588870957"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çœ‹åˆ°å¤§ä½¬åšå››æ ¼æ¼«ç”»æ—¥å…¥400+ï¼Œæˆ‘è§‰å¾—åº”è¯¥åšäº›ä»€ä¹ˆäº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4336129588870957/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ›¹å·¥ä¸åŠ ç­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T03:39:17.000Z" title="Tue Dec 30 2025 03:39:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯æœ€è¿‘ç”¨ n8n è·‘å‡ºæ¥çš„ä¸€ä¸ªæŒºæœ‰æ„æ€çš„ç©å…·ã€‚</p>
<p>èµ·å› æ˜¯çœ‹åˆ°ä¸€å¼ å¾ˆæœ‰â€œæ¯æ…ˆå­å­â€å‘³é“çš„èŠå¤©è®°å½•ï¼Œå°±æ˜¯ä¸‹é¢è¿™å¼ ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2082299d909e4068a98a023d7bcf87e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=d1GcaTx7jlU2pTyWgLAjHYfd8Wg%3D" alt="" loading="lazy"/></p>
<p>çœ‹å®Œä¹äº†åŠå¤©ï¼Œæ­£å¥½å‰ä¸¤å¤©åœ¨æ˜é‡‘çœ‹åˆ°å¤§ä½¬â€œå¼ é£æ·ç‰¹çƒˆâ€ï¼ˆå…¬ä¼—å·ï¼šç¼–ç¨‹ä¹‹ç‹ï¼‰åˆ†äº«äº†ä¸€ä¸ªç”¨ AI åšå››æ ¼æ¼«ç”»çš„æ€è·¯è¿˜æœ‰è®©äººç¾¡æ…•åˆ°é¾‡ç‰™å’§å˜´çš„å¹¿å‘Šæ”¶ç›Šã€‚</p>
<p><a href="https://juejin.cn/user/149189281194766/posts" target="_blank" title="https://juejin.cn/user/149189281194766/posts">å¼ é£æ·ç‰¹çƒˆ</a>
<a href="https://juejin.cn/post/7588004601392529442?searchId=202512301014099D599A36152894CF15E6" target="_blank" title="https://juejin.cn/post/7588004601392529442?searchId=202512301014099D599A36152894CF15E6"># AI åšå…¬ä¼—å·æ¼«ç”»ï¼Œç«Ÿç„¶æ—¥å…¥ 400+</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f014bd5526074e258555f0a0add676b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=Fob%2BYvxwDrAhfxwV5f%2FFRYqcbAs%3D" alt="" loading="lazy"/></p>
<p>æˆ‘å°±ç¢ç£¨ç€ï¼Œèƒ½ä¸èƒ½æŠŠè¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–ä¸€ä¸‹ï¼Ÿ</p>
<p>ç›´æ¥æŠŠèŠå¤©è®°å½•æˆ–è€…æ®µå­ä¸¢ç»™ AIï¼Œè®©å®ƒè‡ªå·±æå–ç¬‘ç‚¹ï¼Œè‡ªå·±å†™è„šæœ¬ï¼Œæœ€åè‡ªåŠ¨ç”»å‡ºæ¥ã€‚</p>
<p>æŠ˜è…¾äº†ä¸€ä¸‹åˆï¼Œå¼„å‡ºæ¥çš„æ•ˆæœè¿˜è¡Œï¼Œå¤§å®¶å…ˆçœ‹çœ‹æˆå“ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3933cbfdfd0d435c93e4de2c2098db23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=%2B9i1uZinJDATpk39mbS3%2FT4Pvbs%3D" alt="" loading="lazy"/></p>
<p>è¿™å°±æœ‰ç‚¹æ„æ€äº†ã€‚</p>
<p>åªè¦ä½ æœ‰ç´ æï¼Œä¸ç®¡æ˜¯ç½‘ä¸Šçš„æ®µå­ï¼Œè¿˜æ˜¯èº«è¾¹çš„ä¹å­ï¼Œä¸¢è¿›å»å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ¼«ç”»ã€‚</p>
<p>ä»Šå¤©æŠŠè¿™ä¸ªå·¥ä½œæµçš„æ­å»ºè¿‡ç¨‹æ‹†å¼€äº†æ‰ç¢äº†è®²è®²ã€‚</p>
<h3 data-id="heading-0">æ ¸å¿ƒåŸç†å…¶å®å°±ä¸‰æ­¥</h3>
<p>ä¸ç”¨è¢«é‚£ä¸€å †èŠ‚ç‚¹å“åˆ°ï¼Œè¿™ä¸œè¥¿é€»è¾‘å¾ˆç®€å•ã€‚</p>
<p>æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªæ¼«ç”»å·¥ä½œå®¤ï¼š</p>
<ol>
<li><strong>ç¼–å‰§ï¼ˆAI Agentï¼‰ï¼š</strong> å®ƒçš„è„‘å­å¥½ä½¿ã€‚ä½ ç»™å®ƒä¸€æ®µå¯¹è¯ï¼Œå®ƒè´Ÿè´£æç‚¼ç¬‘ç‚¹ï¼Œå®‰æ’è°ç«™å·¦è¾¹è°ç«™å³è¾¹ï¼Œè¿˜å¾—æŠŠåˆ†é•œè„šæœ¬å†™å¥½ã€‚</li>
<li><strong>ç”»å¸ˆï¼ˆç»˜å›¾èŠ‚ç‚¹ï¼‰ï¼š</strong> å®ƒæ˜¯ä¸ªè€å®äººï¼Œä¸å¸¦è„‘å­ï¼Œåªç®¡ç…§ç€ç¼–å‰§ç»™çš„æè¿°å»ç”»ç”»ã€‚</li>
<li><strong>å®£å‘ï¼ˆå¾®ä¿¡èŠ‚ç‚¹ï¼‰ï¼š</strong> ç”»å¥½äº†ï¼Œæ‰“åŒ…ä¸Šä¼ åˆ°å…¬ä¼—å·è‰ç¨¿ç®±ï¼Œç­‰ç€å‘å°±è¡Œã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f4ae64d272c435483b4126a2517e325~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=lkWK0KDztAvCsXFw%2BPAq27965%2BA%3D" alt="" loading="lazy"/></p>
<p>æ•´ä¸ªå·¥ä½œæµåœ¨ n8n é‡Œçš„é•¿ç›¸æ˜¯è¿™æ ·çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb4c032c767f4637a69c6c120fe2055b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=z5t5CpqgA3JwE6VbJRbOZeW4OUY%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢æˆ‘ä»¬è¦å¼€å§‹åŠ¨çœŸæ ¼çš„äº†ï¼Œæ‰“å¼€ä½ çš„ n8nï¼Œå’±ä»¬ä»å¤´æ­ã€‚</p>
<h3 data-id="heading-1">æ­å»ºâ€œæ¼«ç”»å·¥ä½œå®¤â€</h3>
<h4 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šæå®šè¾“å…¥å…¥å£</h4>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥æ¥æ”¶ä½ çš„æŒ‡ä»¤ã€‚è¿™é‡Œæˆ‘ç”¨äº†ä¸¤ä¸ªè§¦å‘å™¨ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•å’Œå®é™…ä½¿ç”¨ã€‚</p>
<p>ä¸€ä¸ªæ˜¯ <strong>Chat Trigger</strong>ï¼Œè¿™ç©æ„å„¿èƒ½è®©ä½ ç›´æ¥åœ¨ n8n çš„èŠå¤©çª—å£é‡Œè·Ÿå®ƒå¯¹è¯ï¼Œæµ‹è¯•çš„æ—¶å€™ç‰¹åˆ«æ–¹ä¾¿ã€‚
å¼€å¯å…è®¸æ–‡ä»¶ä¸Šä¼ ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸Šä¼ æ¢—å›¾æ¥åˆ›ä½œæ¼«ç”»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/502ac06d2011417bbbf6b6b59a27d1c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=ZBWbMgESTv2gmKHFpb7EOPbB%2BzY%3D" alt="" loading="lazy"/></p>
<p>å¦ä¸€ä¸ªæ˜¯ <strong>Form Trigger</strong>ï¼ˆè¡¨å•è§¦å‘ï¼‰ã€‚å¦‚æœä½ æƒ³åšä¸€ä¸ªç½‘é¡µå‘ç»™æœ‹å‹ç©ï¼Œæˆ–è€…æ˜¯æƒ³ä¼ å›¾ç‰‡ï¼ˆæ¯”å¦‚ä¸Šé¢çš„èŠå¤©è®°å½•æˆªå›¾ï¼‰ï¼Œç”¨è¡¨å•æ›´åˆé€‚ã€‚</p>
<p>é…ç½®å¤ªé•¿äº†ï¼Œæ¨ªå‘æ‹¼äº†ä¸€ä¸‹ï¼Œå…¶å®æ˜¯ä¸€å¼ é•¿å›¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71144de359e94f3f8c672b4d197c7ffc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=QhY1vuSiYBF3V7JI089usWfhss4%3D" alt="" loading="lazy"/></p>
<p>é…ç½®çš„æ—¶å€™è¦æ³¨æ„ï¼Œè¡¨å•é‡Œæˆ‘è®¾äº†ä¸¤ä¸ªå­—æ®µï¼š<code>theme</code> å’Œ <code>pic</code>ã€‚è¿™æ ·é€»è¾‘å°±æ´»äº†ï¼š</p>
<ul>
<li>æœ‰å›¾å°±çœ‹å›¾è¯´è¯ã€‚</li>
<li>æ²¡å›¾å°±æ ¹æ®ä¸»é¢˜è‡ªç”±å‘æŒ¥ã€‚</li>
</ul>
<h4 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šæ‹›è˜ä¸€ä½é‡‘ç‰Œç¼–å‰§ï¼ˆAI Agentï¼‰</h4>
<p>è¿™æ˜¯æ•´ä¸ªå·¥ä½œæµçš„å¤§è„‘ï¼Œä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚</p>
<p>æ‹–ä¸€ä¸ª <strong>AI Agent</strong> èŠ‚ç‚¹å‡ºæ¥ã€‚æ¨¡å‹æˆ‘é€‰çš„æ˜¯ Google çš„ Geminiï¼Œå› ä¸ºå®ƒå¤„ç†é•¿æ–‡æœ¬å’Œé€»è¾‘æ¨ç†çš„èƒ½åŠ›åœ¨çº¿ï¼Œå›½å†…æ¨¡å‹å¯ä»¥ä½¿ç”¨ GLM-4.6V ä»£æ›¿ï¼Œä¹Ÿæœ‰åˆ†æå›¾åƒè¿›è¡Œè”æƒ³æ¨ç†çš„èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a0bc48921684acaa437097a659a6d94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=HazujMTEdrflaCsJcAbceUS91jE%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªèŠ‚ç‚¹çš„é…ç½®æœ‰ä¸¤ä¸ªæ ¸å¿ƒç‚¹ï¼Œåƒä¸‡åˆ«æé”™ï¼š</p>
<p><strong>1. å‘Šè¯‰å®ƒæ€ä¹ˆå½“å¯¼æ¼”ï¼ˆPromptï¼‰</strong></p>
<p>æˆ‘ä»¬åœ¨ Agent çš„ç³»ç»Ÿæç¤ºè¯é‡Œï¼Œè¦ç»™å®ƒç«‹è§„çŸ©ã€‚ä¸èƒ½è®©å®ƒçå†™ï¼Œå¿…é¡»è¾“å‡ºæˆ‘ä»¬ç”»å›¾èƒ½ç”¨çš„æ ¼å¼ã€‚</p>
<p>æç¤ºè¯çš„å¤§æ¦‚é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>ä½ æ˜¯ä¸€ä½çˆ†ç¬‘å››æ ¼æ¼«ç”»å¯¼æ¼”ã€‚
ä»»åŠ¡ï¼šæŠŠç”¨æˆ·çš„å†…å®¹è½¬åŒ–ä¸ºæ¼«ç”»è„šæœ¬ã€‚
é£æ ¼ï¼šQ ç‰ˆã€å¯çˆ±ã€å…¨å½©ã€‚
ç»“æ„ï¼šä¸¥æ ¼éµå®ˆâ€œèµ·ã€æ‰¿ã€è½¬ã€åˆâ€çš„å››æ ¼æ³•åˆ™ã€‚
è¾“å‡ºï¼šå¿…é¡»æ˜¯ä¸¥æ ¼çš„ JSON æ ¼å¼ï¼ŒåŒ…å«æ ‡é¢˜ã€Markdown æ ¼å¼çš„è¯¦ç»†åˆ†é•œæè¿°ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa012da13752423e9ff7198b6f96db82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=%2FZrk98K8IlXRKOXZmEQ%2BqJUsIKk%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢æ˜¯ç”¨æˆ·æç¤ºè¯å…¨æ–‡ï¼Œä¸»è¦æ˜¯ä¼ å…¥æ¢—å›¾å’Œç¬‘ç‚¹æ–‡å­—ï¼Œç‰¹æ®Šè¦æ±‚ç­‰å†…å®¹ï¼Œè®©æ¨¡å‹æ ¹æ®è¾“å…¥å†…å®¹è¿›è¡Œç¬‘ç‚¹æå–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ä¸»é¢˜ï¼š{{ <span class="hljs-variable">$json</span>?.theme || <span class="hljs-variable">$json</span>?.chatInput}}
æŒ‰ç…§ä¸»é¢˜ä»¥åŠæˆ‘ä¼ å…¥çš„å›¾ç‰‡æ¥ç”Ÿæˆæ¼«ç”»ç»˜åˆ¶ä¿¡æ¯ï¼Œä¸»é¢˜æˆ–è€…å›¾ç‰‡æœ‰ä¸€é¡¹å¯èƒ½ä¸ºç©ºï¼Œä¸ºç©ºçš„æƒ…å†µä¸‹ä»æœ‰çš„é‚£ä¸€é¡¹å†…æå–ç¬‘ç‚¹ï¼Œå¦‚æœæœ‰ä¸»é¢˜ä¹Ÿæœ‰å›¾ç‰‡å°±ç»“åˆèµ·æ¥è§„åˆ’æ¼«ç”»ä¸»é¢˜ï¼Œå¦‚æœä¸¤ä¸ªéƒ½æ²¡æœ‰ï¼Œå°±è‡ªç”±å‘æŒ¥
</code></pre>
<p>ç³»ç»Ÿæç¤ºè¯å¤ªé•¿äº†ï¼Œå°±ä¸æ”¾å…¨æ–‡äº†ï¼Œç›´æ¥æ–‡æœ«è·å–å·¥ä½œæµæ–‡ä»¶å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Role: çˆ†ç¬‘å››æ ¼Â·æ¢—æ¼«å¯¼æ¼” (Comic Director)</span>

<span class="hljs-section">## æ ¸å¿ƒä»»åŠ¡</span>
ä½ æ˜¯ä¸€ä½å…¼å…·é¡¶çº§å¹½é»˜æ„Ÿã€åˆ†é•œèƒ½åŠ›ä¸å…¨æ ˆäº¤ä»˜æ€ç»´çš„æ¼«ç”»å¯¼æ¼”ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†ç”¨æˆ·æä¾›çš„ç´ æè½¬åŒ–ä¸º<span class="hljs-strong">**Nano Banana Pro ä¸“ç”¨çš„æ ‡å‡† JSON æ ¼å¼æŒ‡ä»¤**</span>ã€‚

<span class="hljs-section">## å…³é”®çº¦æŸ</span>
<span class="hljs-bullet">1.</span>  <span class="hljs-strong">**é£æ ¼é”å®š**</span>ï¼šå¿…é¡»æ˜¯<span class="hljs-strong">**Qç‰ˆå¯çˆ±å½¢è±¡**</span>ã€<span class="hljs-strong">**å…¨å½©æ¼«ç”»**</span>ã€‚
<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**ç»“æ„é”å®š**</span>ï¼š<span class="hljs-code">`comic_info`</span> å­—æ®µå¿…é¡»ä¸¥æ ¼æ˜ å°„åŸå®šæ•°æ®ç»“æ„ï¼ˆType/Style/Color/Background/Characters/Panelsï¼‰ï¼Œä½†ä½¿ç”¨ <span class="hljs-strong">**Markdown è¯­æ³•**</span>è¾“å‡ºã€‚
<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**æ ¼å¼é”å®š**</span>ï¼šè¾“å‡ºå•ä¸€ JSON å¯¹è±¡ï¼ŒåŒ…å« <span class="hljs-code">`title`</span>, <span class="hljs-code">`comic_info`</span>, <span class="hljs-code">`html`</span>, ``ã€‚

...çœç•¥å¥½å¤š...

<span class="hljs-section">## å·¥ä½œæµ</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**åˆ†æè¾“å…¥**</span>ï¼šæå–ç¬‘ç‚¹ã€‚
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**æ„æ€æ ‡é¢˜**</span>ï¼šç”Ÿæˆ <span class="hljs-code">`title`</span>ã€‚
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**æ„å»º Markdown**</span>ï¼šæŒ‰ç…§â€œåŸºç¡€ä¿¡æ¯-è§’è‰²-åˆ†é•œâ€ç»“æ„ç”Ÿæˆ <span class="hljs-code">`comic_info`</span>ï¼Œç¡®ä¿å…¨å½©Qç‰ˆé£æ ¼ã€‚
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**æ„å»º HTML**</span>ï¼šå°† Markdown è½¬åŒ–ä¸ºå¸¦æ ·å¼çš„ <span class="hljs-code">`html`</span>ã€‚
<span class="hljs-bullet">5.</span> <span class="hljs-strong">**å°è£…**</span>ï¼šè¾“å‡º JSONã€‚

å½“ä½ è·å¾—è§£æåçš„ç»“æ„åŒ–æ•°æ®ï¼ˆJSONï¼‰åï¼Œè¯·ç›´æ¥å°†å…¶ä½œä¸ºæœ€ç»ˆç­”æ¡ˆè¾“å‡ºï¼Œä¸è¦å†æ¬¡å°è¯•è°ƒç”¨è§£æå™¨æˆ–è¿›è¡Œå¤šä½™çš„è§£é‡Šã€‚å¦‚æœ comic<span class="hljs-emphasis">_info å’Œ html å­—æ®µå·²ç»ç”Ÿæˆï¼Œä»»åŠ¡å³è§†ä¸ºå®Œæˆã€‚

## åˆå§‹åŒ–

æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼Œå¼€å§‹ç”Ÿæˆï¼
</span></code></pre>
<p>ä¸Šé¢çš„æç¤ºè¯æŠŠåé¢æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„ä¿¡æ¯éƒ½ç”Ÿæˆå¥½äº†ï¼Œå„ä¸ªå­—æ®µçš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li><strong>title</strong>ï¼š ç”¨äºå…¬ä¼—å·æ–‡ç« æ ‡é¢˜ï¼Œè¿˜æœ‰å››æ ¼æ¼«ç”»ä¸Šå†™æ¼«ç”»åç§°</li>
<li><strong>comic_info</strong>ï¼šäº¤ç»™ Nano Banana Pro è¿›è¡Œå››æ ¼æ¼«ç”»çš„åˆ›ä½œï¼Œç»“æ„åŒ–çš„ä¿¡æ¯å¯ä»¥æœ€æ¸…æ™°çš„è¡¨è¾¾æ¯ä¸€æ ¼æ¼«ç”»è¦ç”»çš„å†…å®¹ï¼Œè¾¾åˆ°æœ€ä½³å›¾ç‰‡ç”Ÿæˆæ•ˆæœã€‚</li>
<li><strong>html</strong>ï¼šå› ä¸ºæˆ‘ä»¬åé¢è¦å‘å¸ƒåˆ°å¾®ä¿¡å…¬ä¼—å·ï¼Œmarkdown å†…å®¹ç›´æ¥é€šè¿‡ api æ¥å£æäº¤ï¼Œå±•ç¤ºæ•ˆæœå¾ˆå·®ï¼Œè¿™è¾¹ç›´æ¥è®©å¤§æ¨¡å‹æ ¹æ® markdown å†…å®¹æ‹¼è£…ä¸€ä¸ªä¼˜åŒ–äº†æ ·å¼çš„ html æ–‡æœ¬ï¼Œç”¨è¿™ä¸ªå†…å®¹æ¥å‘å¸ƒï¼Œæ˜¾ç¤ºæ•ˆæœå°±å¾ˆæ£’äº†ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf039845df7c40b7bc22fde7203b1eed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=qrUuAZuR%2FrLYVI4O5H2%2BnSEgBjM%3D" alt="" loading="lazy"/></li>
<li><strong>summary</strong>ï¼šè¿™ä¸ªå­—æ®µæ˜¯å…¬ä¼—å·æ–‡ç« çš„æè¦ï¼Œå¦‚æœä¸ç”Ÿæˆï¼Œç›´æ¥å±•ç¤ºçš„å†…å®¹æ˜¯ä¸èƒ½ç›´æ¥è¡¨è¾¾æ¼«ç”»å†…å®¹çš„ï¼Œä¼šå–æ­£æ–‡çš„å‰éƒ¨åˆ†å­—ç¬¦ã€‚</li>
</ol>
<p><strong>2. è§„å®šè¾“å‡ºæ ¼å¼ï¼ˆOutput Parserï¼‰</strong></p>
<p>AI æœ‰æ—¶å€™è¾“å‡ºçš„å†…å®¹å¾ˆå¥”æ”¾ï¼Œç»“æ„ä¸ç»Ÿä¸€ï¼Œå¯¹å·¥ä½œæµæ¥è¯´ï¼Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¦çš„æ˜¯ç¡®åˆ‡çš„è¾“å…¥ï¼Œæ‰€ä»¥è¿™è¾¹è®©æ ¹æ®ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å®ƒè¾“å‡ºçº¯å‡€çš„æ•°æ®ï¼Œæ‰€ä»¥å¿…é¡»æŒ‚ä¸€ä¸ª <strong>Structured Output Parser</strong>ï¼ˆç»“æ„åŒ–è¾“å‡ºè§£æå™¨ï¼‰ã€‚</p>
<p>åœ¨è¿™ä¸ªè§£æå™¨é‡Œï¼Œå®šä¹‰å¥½æˆ‘ä»¬éœ€è¦çš„æ•°æ®ç»“æ„ï¼š</p>
<ul>
<li><code>title</code>: æ¼«ç”»æ ‡é¢˜</li>
<li><code>comic_info</code>: è¿™æ˜¯ä¸€ä¸ªå¤§æ®µçš„æ–‡æœ¬ï¼Œé‡Œé¢åŒ…å«äº†ç”»å›¾è¦ç”¨çš„æ‰€æœ‰æç¤ºè¯ï¼ˆPromptï¼‰ã€‚</li>
<li><code>html</code>: æ‹¼è£…å¥½çš„æç¤ºè¯æ ‡ç­¾ï¼Œç”¨äºæ–‡ç« æ¸²æŸ“</li>
<li><code>summary</code>: æ•…äº‹æ¢—æ¦‚ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œä¸ç®¡ AI æ€ä¹ˆæ€è€ƒï¼Œæœ€ååå‡ºæ¥çš„æ°¸è¿œæ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨çš„ JSON æ•°æ®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10adb49c28a841be89e9609c05910fc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=8UGKQSERO57rmfzECw5bV5JIM50%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-4">ç¬¬ä¸‰æ­¥ï¼šé›‡ä½£çµé­‚ç”»å¸ˆï¼ˆç»˜å›¾èŠ‚ç‚¹ï¼‰</h4>
<p>è„šæœ¬å†™å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç”»ã€‚</p>
<p>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯è‡ªå·±å¼€å‘çš„ <strong>Nano Banana</strong> ç¤¾åŒºèŠ‚ç‚¹ï¼Œåœ¨ç¤¾åŒºèŠ‚ç‚¹ç®¡ç†é¢æ¿è¾“å…¥ <code>n8n-nodes-nano-banana</code>ï¼Œä½¿ç”¨ Nano Banana Pro æ¨¡å‹ï¼Œä¸­æ–‡æ”¯æŒå¾ˆå‡ºè‰²ã€‚</p>
<p>åœ¨ Prompt æ é‡Œï¼Œæˆ‘ä»¬è¦ç”¨è¡¨è¾¾å¼ï¼ˆExpressionï¼‰æ¥å¼•ç”¨ä¸Šä¸€æ­¥çš„ç»“æœã€‚</p>
<p>æŠŠå‰é¢ AI Agent èŠ‚ç‚¹è¾“å‡ºçš„æ¼«ç”»ä¿¡æ¯æ‹–åˆ° prompt è¾“å…¥æ¡†ä¸­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c78f9a42f784951a4cc9c410a863914~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=qg%2FFftlrHPg18rzk%2B3r%2FrrcouYI%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†è®©æ¼«ç”»çœ‹ç€æ›´åƒæ ·ï¼Œæˆ‘è¿˜åœ¨æç¤ºè¯åé¢è¿½åŠ äº†ä¸€æ®µç¡¬æ€§è¦æ±‚ï¼Œå…¨æ–‡å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">{{ <span class="hljs-variable">$json</span>.output.comic_info.toJsonString() }}
ç»˜åˆ¶æ¼«ç”»ï¼Œæ¼«ç”»æ–‡å­—å†™å¤§ä¸€ç‚¹ï¼Œå¯ä»¥é€‚å½“ç²¾ç®€ï¼Œä¿ç•™æ ¸å¿ƒç¬‘ç‚¹å³å¯ã€‚
æ¨ªå‘ç•™ç™½ä¸€æ¡ï¼Œå·¦è¾¹å†™æ¼«ç”»æ ‡é¢˜ï¼Œå³è¾¹å†™ä¸Šâ€œå¾®ä¿¡å…¬ä¼—å·ï¼šæ›¹å·¥ä¸åŠ ç­â€ï¼Œä¸è¦å ç”¨å¤ªå¤šç©ºé—´ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¼«ç”»å¤–ä¸è¦å†™ä»»ä½•å†…å®¹æ–‡å­—
</code></pre>
<p>æˆ‘è§„å®šäº†æ¼«ç”»çš„å­—è¦å¤§ä¸€ç‚¹ï¼Œå› ä¸ºæ²¡åŠ ä¹‹å‰å­—ä¼šæ¯”è¾ƒå°ï¼Œçœ‹ç€å¾ˆç´¯ï¼›å¦å¤–åŠ äº†å…¬ä¼—å·çš„åç§°å’Œæ¼«ç”»æ ‡é¢˜ï¼Œå‡ºæ¥çš„å›¾ä¸ç”¨ PSï¼Œç›´æ¥å°±èƒ½å‘ã€‚</p>
<h4 data-id="heading-5">ç¬¬å››æ­¥ï¼šå®£å‘è‡ªåŠ¨åŒ–ï¼ˆå¾®ä¿¡å‘å¸ƒï¼‰</h4>
<p>å›¾ç”»å‡ºæ¥äº†ï¼Œä½ å¯ä»¥é€‰æ‹©ç›´æ¥å‘ç»™ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥åƒæˆ‘ä¸€æ ·ï¼Œç›´æ¥åŒæ­¥åˆ°å¾®ä¿¡å…¬ä¼—å·ã€‚</p>
<p>è¿™éœ€è¦ç”¨åˆ° <strong>WeChat</strong> ç¤¾åŒºèŠ‚ç‚¹ï¼Œåœ¨ç¤¾åŒºèŠ‚ç‚¹ç®¡ç†é¢æ¿è¾“å…¥ <code>n8n-nodes-wechat-publish</code> å®‰è£…ã€‚</p>
<p>å®‰è£…ä»¥åå…ˆåˆ›å»ºä¸€ä¸ªå…¬ä¼—å·çš„é“¾æ¥å‡­è¯ï¼Œéœ€è¦å‰å¾€å¾®ä¿¡å¼€å‘è€…å¹³å°è·å– App ID å’Œ App Secretï¼Œå¹¶ä¸”æŠŠè¿è¡Œ n8n çš„ç”µè„‘çš„ IP é…ç½®åˆ° IP ç™½åå•å†…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb8b3ed7450f4935926d98cee635d936~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=WxE%2BM%2BfcH3XJuNRoxWsP%2FW4u4QA%3D" alt="" loading="lazy"/></p>
<p>æ·»åŠ  <strong>Upload Media</strong> èŠ‚ç‚¹ï¼ŒæŠŠåˆšæ‰ç”Ÿæˆçš„å››æ ¼æ¼«ç”»å›¾ç‰‡ä¸Šä¼ åˆ°å¾®ä¿¡æœåŠ¡å™¨ï¼Œæ‹¿åˆ°ä¸€ä¸ª <code>media_id</code>ï¼Œè®¾ç½®å…¬ä¼—å·çš„å°é¢éœ€è¦ç”¨åˆ°è¿™ä¸ª idã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9346bb13570b44eda3d04ea922cf873f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=znFQ%2FSdBKr6y8XasncOw9auiNY8%3D" alt="" loading="lazy"/></p>
<p>ç´§æ¥ç€ç”¨ <strong>Create Draft</strong>ï¼ˆåˆ›å»ºè‰ç¨¿ï¼‰èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5eeb5e97a6d042c6a8b94f510f9e9f29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=LcuSSCHLRfdsEz7IWEwd0lAlf60%3D" alt="" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªèŠ‚ç‚¹é‡Œï¼Œä½ å¯ä»¥æŠŠæ–‡ç« æ’ç‰ˆéƒ½åšè¿›å»ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>æ ‡é¢˜ï¼šç”¨ AI èµ·çš„é‚£ä¸ªå¸ç›æ ‡é¢˜ã€‚</li>
<li>å°é¢ï¼šå°±æ˜¯åˆšæ‰ç”»çš„é‚£å¼ æ¼«ç”»ã€‚</li>
<li>æ­£æ–‡ï¼šæ’å…¥å›¾ç‰‡ï¼Œå†æŠŠ AI ç”Ÿæˆçš„æ–‡å­—è„šæœ¬é™„åœ¨åé¢ï¼Œç”šè‡³å¯ä»¥åŠ ä¸ªåº•éƒ¨è´´ç‰‡å¹¿å‘Šã€‚</li>
</ul>
<p>è®¾ç½®å¥½ä¹‹åï¼Œä¸€è¿è¡Œï¼Œä½ çš„å…¬ä¼—å·è‰ç¨¿ç®±é‡Œå°±ä¼šå¤šå‡ºä¸€ç¯‡æ’ç‰ˆç²¾ç¾çš„æ¼«ç”»æ–‡ç« ï¼Œä½ éœ€è¦åšçš„åªæ˜¯ç‚¹ä¸ªâ€œå‘å¸ƒâ€ã€‚</p>
<h3 data-id="heading-6">ç©æ³•å»¶ä¼¸</h3>
<p>è¿™å¥—å·¥ä½œæµæœ€å¦™çš„åœ°æ–¹åœ¨äºï¼Œå®ƒæ˜¯ä¸è®¾é™çš„ã€‚</p>
<p>ç°åœ¨çš„æç¤ºè¯æ˜¯â€œQ ç‰ˆå¯çˆ±â€ï¼Œå¦‚æœä½ æŠŠ Prompt é‡Œçš„é£æ ¼æè¿°æ”¹ä¸€æ”¹ï¼š</p>
<ul>
<li>æ”¹æˆâ€œé»‘ç™½çº¿æ¡ã€æç®€ä¸»ä¹‰â€ â€”â€” å°±æ˜¯ <strong>é»‘ç™½æ¼«ç”»</strong> é£æ ¼ã€‚</li>
<li>æ”¹æˆâ€œç¾å¼å¤å¤ã€æ³¢æ™®è‰ºæœ¯â€ â€”â€” å°±æ˜¯ <strong>æ¬§ç¾æ¢—å›¾</strong> é£æ ¼ã€‚</li>
<li>æ”¹æˆâ€œèµ›åšæœ‹å…‹ã€éœ“è™¹å…‰å½±â€ â€”â€” å°±æ˜¯ <strong>ç§‘å¹»æ¡æ¼«</strong>ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8e20782ae12408d9b1822ad89622f28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pu55bel5LiN5Yqg54-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767670756&amp;x-signature=%2Ftlyc0nsRgT5GpDI5FxwiSy3Kw8%3D" alt="" loading="lazy"/></p>
<p>åªéœ€è¦æ”¹ä¸€è¡Œå­—ï¼Œæ•´ä¸ªç”»é£çªå˜ã€‚</p>
<h3 data-id="heading-7">æ€ä¹ˆè·å–å·¥ä½œæµï¼Ÿ</h3>
<p>è¿™å¥—ä¸œè¥¿æ­èµ·æ¥è¯´éš¾ä¸éš¾ï¼Œä½†ç»†èŠ‚å‘ä¸å°‘ï¼Œç‰¹åˆ«æ˜¯ AI çš„ç³»ç»Ÿæç¤ºè¯å’Œ JSON è§£æé‚£å—ï¼Œè°ƒæ•™äº†å¾ˆä¹…æ‰ç¨³å®šã€‚</p>
<p>æˆ‘å·²ç»æŠŠè°ƒè¯•å¥½çš„å®Œæ•´ n8n æºç ï¼ˆJSON æ–‡ä»¶ï¼‰æ‰“åŒ…å¥½äº†ã€‚</p>
<p>ç›´æ¥å¯¼å…¥ n8n å°±èƒ½ç”¨ï¼Œä¸ç”¨è‡ªå·±ä»å¤´æ­å»ºäº†ã€‚</p>
<p>å…³æ³¨å…¬ä¼—å·â€œ<strong>æ›¹å·¥ä¸åŠ ç­</strong>â€ï¼Œå‘é€æš—å·â€œ<strong>å››æ ¼æ¼«ç”»</strong>â€ï¼Œæ–‡ä»¶ç›´æ¥å‘ä½ ã€‚</p>
<p>æ‹¿åˆ°ä¹‹åï¼Œè®°å¾—æŠŠé‡Œé¢çš„ API Key æ¢æˆä½ è‡ªå·±çš„ï¼Œå°±èƒ½æ‹¥æœ‰ä¸€å°è‡ªåŠ¨æ¼«ç”»ç”Ÿäº§æœºäº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ Ant Design Vue çš„ a-table ä¸­å°†ç‰¹å®šæ•°æ®è¡Œå›ºå®šåœ¨åº•éƒ¨]]></title>    <link>https://juejin.cn/post/7589207474135236658</link>    <guid>https://juejin.cn/post/7589207474135236658</guid>    <pubDate>2025-12-30T07:08:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589207474135236658" data-draft-id="7589250237068869642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ Ant Design Vue çš„ a-table ä¸­å°†ç‰¹å®šæ•°æ®è¡Œå›ºå®šåœ¨åº•éƒ¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T07:08:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†åƒä¸€æ ¹èƒ¡èåœ"/> <meta itemprop="url" content="https://juejin.cn/user/871275323725533"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ Ant Design Vue çš„ a-table ä¸­å°†ç‰¹å®šæ•°æ®è¡Œå›ºå®šåœ¨åº•éƒ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/871275323725533/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†åƒä¸€æ ¹èƒ¡èåœ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:08:52.000Z" title="Tue Dec 30 2025 07:08:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä½¿ç”¨ Ant Design Vue çš„ <code>a-table</code> ç»„ä»¶æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šæŸäº›æ•°æ®è¡Œï¼ˆå¦‚æ±‡æ€»è¡Œã€æ€»è®¡è¡Œç­‰ï¼‰éœ€è¦å§‹ç»ˆæ˜¾ç¤ºåœ¨è¡¨æ ¼åº•éƒ¨ï¼Œæ— è®ºå…¶ä»–æ•°æ®å¦‚ä½•æ’åºï¼Œè¿™äº›ç‰¹æ®Šè¡Œéƒ½ä¸åº”è¯¥ç§»åŠ¨ä½ç½®ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡è‡ªå®šä¹‰æ’åºå™¨å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œå¹¶å±•ç¤ºä»åŸºç¡€å®ç°åˆ°ä¼˜åŒ–çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<hr/>
<h2 data-id="heading-1">é—®é¢˜èƒŒæ™¯</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå±•ç¤ºå„æ¨¡å—ç¼ºé™·ç»Ÿè®¡çš„è¡¨æ ¼ï¼Œå…¶ä¸­åŒ…å«ä¸€è¡Œ"å…¨ç»„"çš„æ±‡æ€»æ•°æ®ï¼š</p>
<pre><code class="hljs language-matlab" lang="matlab">æ¨¡å—     | ç¼ºé™·æ•° | å æ¯”   | ç¼ºé™·å¯†åº¦
---------|--------|--------|----------
æ¨¡å—A    | <span class="hljs-number">15</span>     | <span class="hljs-number">12</span><span class="hljs-comment">%    | 0.5</span>
æ¨¡å—B    | <span class="hljs-number">20</span>     | <span class="hljs-number">15</span><span class="hljs-comment">%    | 0.8</span>
æ¨¡å—C    | <span class="hljs-number">10</span>     | <span class="hljs-number">8</span><span class="hljs-comment">%     | 0.3</span>
å…¨ç»„     | <span class="hljs-number">45</span>     | <span class="hljs-number">35</span><span class="hljs-comment">%    | 1.6</span>
</code></pre>
<p>å½“ç”¨æˆ·ç‚¹å‡»è¡¨å¤´è¿›è¡Œæ’åºæ—¶ï¼Œ"å…¨ç»„"è¿™è¡Œæ•°æ®åº”è¯¥å§‹ç»ˆä¿æŒåœ¨åº•éƒ¨ï¼Œè€Œå…¶ä»–è¡Œåˆ™æ ¹æ®å®é™…æ•°å€¼è¿›è¡Œæ’åºã€‚</p>
<hr/>
<h2 data-id="heading-2">åŸºç¡€å®ç°æ–¹æ¡ˆ</h2>
<p>Ant Design Vue çš„ <code>a-table</code> ç»„ä»¶æ”¯æŒé€šè¿‡ <code>sorter</code> å±æ€§è‡ªå®šä¹‰æ’åºé€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œåœ¨æ’åºå™¨ä¸­åˆ¤æ–­æ˜¯å¦ä¸º"å…¨ç»„"è¡Œï¼Œå¦‚æœæ˜¯åˆ™å¼ºåˆ¶å°†å…¶æ’åœ¨æœ€åã€‚</p>
<h3 data-id="heading-3">ç¤ºä¾‹ä»£ç </h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
const columns = [
  { title: "æ¨¡å—", dataIndex: "module", key: "module" },
  {
    title: "ç¼ºé™·æ•°",
    dataIndex: "bugs",
    key: "bugs",
    sorter: (a, b) =&gt; {
      // "å…¨ç»„"å§‹ç»ˆæ’åœ¨æœ€å
      if (a.module === "å…¨ç»„") return 1;
      if (b.module === "å…¨ç»„") return -1;
      return a.bugs - b.bugs;
    },
  },
  {
    title: "å æ¯”",
    dataIndex: "bugRatio",
    key: "bugRatio",
    sorter: (a, b) =&gt; {
      // "å…¨ç»„"å§‹ç»ˆæ’åœ¨æœ€å
      if (a.module === "å…¨ç»„") return 1;
      if (b.module === "å…¨ç»„") return -1;
      const aVal = parseFloat(a.bugRatio) || 0;
      const bVal = parseFloat(b.bugRatio) || 0;
      return aVal - bVal;
    },
  },
];
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-4">æ’åºåŸç†</h3>
<p>æ’åºå™¨å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•° <code>a</code> å’Œ <code>b</code>ï¼Œè¿”å›å€¼ä¸ºï¼š</p>
<ul>
<li>è¿”å›è´Ÿæ•°ï¼š<code>a</code> æ’åœ¨ <code>b</code> å‰é¢</li>
<li>è¿”å› 0ï¼šä½ç½®ä¸å˜</li>
<li>è¿”å›æ­£æ•°ï¼š<code>a</code> æ’åœ¨ <code>b</code> åé¢</li>
</ul>
<p>é€šè¿‡åˆ¤æ–­ <code>a.module</code> å’Œ <code>b.module</code> æ˜¯å¦ä¸º"å…¨ç»„"ï¼Œæˆ‘ä»¬å¯ä»¥å¼ºåˆ¶æ”¹å˜å®ƒä»¬çš„ç›¸å¯¹ä½ç½®ã€‚</p>
<hr/>
<h2 data-id="heading-5">åŸºç¡€æ–¹æ¡ˆçš„é—®é¢˜</h2>
<p>è™½ç„¶ä¸Šè¿°æ–¹æ¡ˆå¯ä»¥å·¥ä½œï¼Œä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li><strong>ç¼ºå°‘æ’åºæ–¹å‘æ”¯æŒ</strong>ï¼šæ²¡æœ‰ä½¿ç”¨ <code>sortOrder</code> å‚æ•°ï¼Œå¯¼è‡´å‡åºå’Œé™åºæ—¶"å…¨ç»„"çš„è¿”å›å€¼é€»è¾‘ä¸å¤Ÿæ¸…æ™°</li>
<li><strong>ä»£ç é‡å¤</strong>ï¼šæ¯ä¸ªå¯æ’åºåˆ—éƒ½éœ€è¦å†™ç›¸åŒçš„"å…¨ç»„"åˆ¤æ–­é€»è¾‘ï¼Œé€ æˆå¤§é‡é‡å¤ä»£ç </li>
<li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šå¦‚æœéœ€è¦ä¿®æ”¹"å…¨ç»„"çš„åˆ¤æ–­æ¡ä»¶æˆ–æ’åºé€»è¾‘ï¼Œéœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç </li>
</ol>
<hr/>
<h2 data-id="heading-6">ä¼˜åŒ–æ–¹æ¡ˆï¼šä½¿ç”¨å·¥å‚å‡½æ•°</h2>
<p>ä¸ºäº†è§£å†³ä»£ç é‡å¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ’åºå™¨å·¥å‚å‡½æ•°ï¼Œå°†å…¬å…±é€»è¾‘æŠ½ç¦»å‡ºæ¥ã€‚</p>
<h3 data-id="heading-7">ä¼˜åŒ–åçš„ä»£ç </h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// é€šç”¨æ’åºå™¨å·¥å‚å‡½æ•°
const createSorter = compareFn =&gt; {
  return (a, b, sortOrder) =&gt; {
    if (sortOrder === "ascend") {
      if (a.module === "å…¨ç»„") return 1;
      if (b.module === "å…¨ç»„") return -1;
    } else if (sortOrder === "descend") {
      if (a.module === "å…¨ç»„") return -1;
      if (b.module === "å…¨ç»„") return 1;
    }
    return -compareFn(a, b);
  };
};

const columns = [
  { title: "æ¨¡å—", dataIndex: "module", key: "module" },
  {
    title: "ç¼ºé™·æ•°",
    dataIndex: "bugs",
    key: "bugs",
    sorter: createSorter((a, b) =&gt; a.bugs - b.bugs),
    defaultSortOrder: "ascend",
  },
  {
    title: "å æ¯”",
    dataIndex: "bugRatio",
    key: "bugRatio",
    sorter: createSorter((a, b) =&gt; {
      const aVal = parseFloat(a.bugRatio) || 0;
      const bVal = parseFloat(b.bugRatio) || 0;
      return aVal - bVal;
    }),
  },
];
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-8">å·¥å‚å‡½æ•°è¯´æ˜</h3>
<p><code>createSorter</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ¯”è¾ƒå‡½æ•° <code>compareFn</code>ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ’åºå™¨å‡½æ•°ã€‚å†…éƒ¨é€»è¾‘ï¼š</p>
<ol>
<li><strong>å‡åºï¼ˆascendï¼‰</strong>ï¼šæ•°å€¼å°çš„åœ¨å‰ï¼Œ"å…¨ç»„"åœ¨æœ€å</li>
<li><strong>é™åºï¼ˆdescendï¼‰</strong>ï¼šæ•°å€¼å¤§çš„åœ¨å‰ï¼Œ"å…¨ç»„"åœ¨æœ€å</li>
<li><strong>é»˜è®¤æƒ…å†µ</strong>ï¼šè‡ªåŠ¨æŒ‰é™åºå¤„ç†</li>
</ol>
<h3 data-id="heading-9">å…³é”®ç‚¹</h3>
<ul>
<li><code>sortOrder</code> å‚æ•°ç”± a-table ç»„ä»¶ä¼ å…¥ï¼Œå€¼ä¸º <code>"ascend"</code>ã€<code>"descend"</code> æˆ– <code>null</code></li>
<li>åœ¨é™åºæ—¶ï¼Œä½¿ç”¨ <code>-compareFn(a, b)</code> åè½¬æ¯”è¾ƒç»“æœ</li>
<li>å¯¹äºç™¾åˆ†æ¯”ç­‰éœ€è¦è½¬æ¢ç±»å‹çš„å­—æ®µï¼Œåœ¨ä¼ å…¥çš„æ¯”è¾ƒå‡½æ•°ä¸­å¤„ç†</li>
</ul>
<hr/>
<h2 data-id="heading-10">å®Œæ•´ç¤ºä¾‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¡¨æ ¼ç»„ä»¶ç¤ºä¾‹ï¼ŒåŒ…å«å¤šä¸ªå¯æ’åºåˆ—ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;a-table :columns="columns" :data-source="dataSource" :pagination="false" bordered /&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from "vue";

// ç¤ºä¾‹æ•°æ®
const dataSource = ref([
  { module: "æ¨¡å—A", bugs: 15, bugRatio: "12%", avgDensity: 0.5 },
  { module: "æ¨¡å—B", bugs: 20, bugRatio: "15%", avgDensity: 0.8 },
  { module: "æ¨¡å—C", bugs: 10, bugRatio: "8%", avgDensity: 0.3 },
  { module: "å…¨ç»„", bugs: 45, bugRatio: "35%", avgDensity: 1.6 },
]);

// é€šç”¨æ’åºå™¨å·¥å‚å‡½æ•°
const createSorter = compareFn =&gt; {
  return (a, b, sortOrder) =&gt; {
    if (sortOrder === "ascend") {
      if (a.module === "å…¨ç»„") return 1;
      if (b.module === "å…¨ç»„") return -1;
    } else if (sortOrder === "descend") {
      if (a.module === "å…¨ç»„") return -1;
      if (b.module === "å…¨ç»„") return 1;
    }
    return -compareFn(a, b);
  };
};

// è¡¨æ ¼åˆ—å®šä¹‰
const columns = [
  {
    title: "æ¨¡å—",
    dataIndex: "module",
    key: "module",
    width: 150,
    align: "center",
  },
  {
    title: "ç¼ºé™·æ•°",
    dataIndex: "bugs",
    key: "bugs",
    width: 150,
    align: "center",
    sorter: createSorter((a, b) =&gt; a.bugs - b.bugs),
    defaultSortOrder: "ascend",
  },
  {
    title: "å æ¯”",
    dataIndex: "bugRatio",
    key: "bugRatio",
    width: 150,
    align: "center",
    sorter: createSorter((a, b) =&gt; {
      const aVal = parseFloat(a.bugRatio) || 0;
      const bVal = parseFloat(b.bugRatio) || 0;
      return aVal - bVal;
    }),
  },
  {
    title: "ç¼ºé™·å¯†åº¦",
    dataIndex: "avgDensity",
    key: "avgDensity",
    width: 150,
    align: "center",
    sorter: createSorter((a, b) =&gt; a.avgDensity - b.avgDensity),
  },
];
&lt;/script&gt;
</code></pre>
<hr/>
<h2 data-id="heading-11">æ‰©å±•ï¼šæ”¯æŒå¤šä¸ªç‰¹æ®Šè¡Œ</h2>
<p>å¦‚æœéœ€è¦å›ºå®šå¤šä¸ªç‰¹æ®Šè¡Œï¼ˆå¦‚"å…¨ç»„"ã€"æ€»è®¡"ç­‰ï¼‰ï¼Œå¯ä»¥ä¿®æ”¹å·¥å‚å‡½æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">createSorter</span> = (<span class="hljs-params">compareFn, pinnedModules = [<span class="hljs-string">"å…¨ç»„"</span>, <span class="hljs-string">"æ€»è®¡"</span>]</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">a, b, sortOrder</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> aIsPinned = pinnedModules.<span class="hljs-title function_">includes</span>(a.<span class="hljs-property">module</span>);
    <span class="hljs-keyword">const</span> bIsPinned = pinnedModules.<span class="hljs-title function_">includes</span>(b.<span class="hljs-property">module</span>);

    <span class="hljs-keyword">if</span> (sortOrder === <span class="hljs-string">"ascend"</span>) {
      <span class="hljs-keyword">if</span> (aIsPinned &amp;&amp; !bIsPinned) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (!aIsPinned &amp;&amp; bIsPinned) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">compareFn</span>(a, b);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sortOrder === <span class="hljs-string">"descend"</span>) {
      <span class="hljs-keyword">if</span> (aIsPinned &amp;&amp; !bIsPinned) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (!aIsPinned &amp;&amp; bIsPinned) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> -<span class="hljs-title function_">compareFn</span>(a, b);
    }

    <span class="hljs-keyword">if</span> (aIsPinned &amp;&amp; !bIsPinned) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (!aIsPinned &amp;&amp; bIsPinned) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> -<span class="hljs-title function_">compareFn</span>(a, b);
  };
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-attr">sorter</span>: <span class="hljs-title function_">createSorter</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">bugs</span> - b.<span class="hljs-property">bugs</span>, [<span class="hljs-string">"å…¨ç»„"</span>, <span class="hljs-string">"æ€»è®¡"</span>]);
</code></pre>
<hr/>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>é€šè¿‡è‡ªå®šä¹‰æ’åºå™¨ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°å°†ç‰¹å®šæ•°æ®è¡Œå›ºå®šåœ¨è¡¨æ ¼åº•éƒ¨çš„éœ€æ±‚ï¼š</p>
<ol>
<li><strong>åŸºç¡€æ–¹æ¡ˆ</strong>ï¼šåœ¨æ¯ä¸ªåˆ—çš„ <code>sorter</code> ä¸­åˆ¤æ–­ç‰¹æ®Šè¡Œ</li>
<li><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨å·¥å‚å‡½æ•°æŠ½ç¦»å…¬å…±é€»è¾‘ï¼Œå‡å°‘ä»£ç é‡å¤</li>
<li><strong>æ‰©å±•æ–¹æ¡ˆ</strong>ï¼šæ”¯æŒå¤šä¸ªç‰¹æ®Šè¡Œå›ºå®š</li>
</ol>
<p>è¿™ç§æ–¹æ³•ç®€å•ã€é«˜æ•ˆï¼Œé€‚ç”¨äºä»»ä½•éœ€è¦å›ºå®šç‰¹å®šè¡Œä½ç½®çš„è¡¨æ ¼åœºæ™¯ã€‚</p>
<hr/>
<h2 data-id="heading-13">ç›¸å…³èµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.antdv.com%2Fcomponents%2Ftable-cn" target="_blank" title="https://www.antdv.com/components/table-cn" ref="nofollow noopener noreferrer">Ant Design Vue Table ç»„ä»¶æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FArray%2Fsort" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/sort" ref="nofollow noopener noreferrer">Array.prototype.sort() - MDN</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Oracle 11g æ•°æ®åº“å¡é¡¿æ’æŸ¥ä¸å®æˆ˜ä¼˜åŒ–ï¼šä¸€æ¬¡çœŸå®çš„æ…¢ SQL å®šä½å…¨è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7589445154533130292</link>    <guid>https://juejin.cn/post/7589445154533130292</guid>    <pubDate>2025-12-30T06:45:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589445154533130292" data-draft-id="7589445154533097524" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Oracle 11g æ•°æ®åº“å¡é¡¿æ’æŸ¥ä¸å®æˆ˜ä¼˜åŒ–ï¼šä¸€æ¬¡çœŸå®çš„æ…¢ SQL å®šä½å…¨è¿‡ç¨‹"/> <meta itemprop="keywords" content="æ•°æ®åº“,åç«¯"/> <meta itemprop="datePublished" content="2025-12-30T06:45:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="martin1017"/> <meta itemprop="url" content="https://juejin.cn/user/587559880636395"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Oracle 11g æ•°æ®åº“å¡é¡¿æ’æŸ¥ä¸å®æˆ˜ä¼˜åŒ–ï¼šä¸€æ¬¡çœŸå®çš„æ…¢ SQL å®šä½å…¨è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/587559880636395/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    martin1017
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T06:45:03.000Z" title="Tue Dec 30 2025 06:45:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš¨ Oracle 11g æ•°æ®åº“å¡é¡¿æ’æŸ¥ä¸å®æˆ˜ä¼˜åŒ–ï¼šä¸€æ¬¡çœŸå®çš„æ…¢ SQL å®šä½å…¨è¿‡ç¨‹</h2>
<blockquote>
<p><strong>èƒŒæ™¯</strong><br/>
ç”Ÿäº§ç¯å¢ƒ Oracle 11g æ•°æ®åº“çªç„¶â€œå¾ˆå¡â€ï¼Œåº”ç”¨æ¥å£å“åº”æ…¢ã€CPU é£™é«˜ã€ç”¨æˆ·å¤§é‡è¶…æ—¶ã€‚<br/>
æœ¬æ–‡å®Œæ•´è®°å½•ä¸€æ¬¡ <strong>ä»ç°è±¡ â†’ å®šä½ â†’ åˆ†æ â†’ å¤„ç½® â†’ ä¼˜åŒ–æ–¹æ¡ˆ</strong> çš„å…¨è¿‡ç¨‹ï¼Œé€‚åˆ DBA / åç«¯å¼€å‘ / è¿ç»´å‚è€ƒã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é—®é¢˜ç°è±¡</h3>
<ul>
<li>åº”ç”¨å¤§é‡æ¥å£å“åº”æ…¢</li>
<li>æ•°æ®åº“ CPU ä½¿ç”¨ç‡æŒç»­ 90%+</li>
<li>ä¼šè¯æ•°æ­£å¸¸ï¼Œä½† <strong>ACTIVE ä¼šè¯é•¿æœŸä¸é‡Šæ”¾</strong></li>
<li>Oracle 11gï¼Œæ—  AWR æˆæƒï¼ˆåªèƒ½é åŠ¨æ€è§†å›¾ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-2">äºŒã€ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ…¢ SQLï¼ˆå®æ—¶ï¼‰</h3>
<h4 data-id="heading-3">1ï¸âƒ£ æŸ¥çœ‹æ‰§è¡Œè¶…è¿‡ 10 ç§’çš„ SQL</h4>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">SELECT</span> 
    s.sid,
    s.serial#,
    s.username,
    s.status,
    s.program,
    sq.sql_id,
    SUBSTR(sq.sql_text, <span class="hljs-number">1</span>, <span class="hljs-number">100</span>) <span class="hljs-keyword">AS</span> sql_text,
    s.last_call_et <span class="hljs-keyword">AS</span> å·²æ‰§è¡Œç§’æ•°,
    s.<span class="hljs-keyword">event</span> <span class="hljs-keyword">AS</span> ç­‰å¾…äº‹ä»¶,
    s.wait_time,
    s.seconds_in_wait
<span class="hljs-keyword">FROM</span> v$session s
<span class="hljs-keyword">JOIN</span> v$sql sq <span class="hljs-keyword">ON</span> s.sql_id = sq.sql_id
<span class="hljs-keyword">WHERE</span> s.status = <span class="hljs-comment">'ACTIVE'</span>
  <span class="hljs-built_in">AND</span> s.username <span class="hljs-built_in">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-comment">'SYS', 'SYSTEM')</span>
  <span class="hljs-built_in">AND</span> s.last_call_et &gt; <span class="hljs-number">10</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> s.last_call_et DESC;
</code></pre>
<h4 data-id="heading-4">ğŸ” æ‰§è¡Œç»“æœè§£è¯»</h4>
<ul>
<li>
<p>å¤šä¸ªä¼šè¯æ‰§è¡Œæ—¶é—´ <strong>å‡ åç§’ ~ å‡ åˆ†é’Ÿ</strong></p>
</li>
<li>
<p>æ˜æ˜¾çœ‹åˆ°ï¼š</p>
<ul>
<li><code>Table Scan: GSTPGG.CEN_CHECK_MEMBER</code></li>
<li><code>Index Fast Full Scan: GSTPGG.RISK_CLUE_BASIC_INFO</code></li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>å·²ç»å¯ä»¥åˆæ­¥åˆ¤æ–­ï¼šå­˜åœ¨ä¸¥é‡çš„å…¨è¡¨æ‰«æé—®é¢˜</strong></p>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹â€œå·²æ‰§è¡Œå®Œä½†ä»åœ¨å†…å­˜ä¸­â€çš„æ…¢ SQL</h3>
<h4 data-id="heading-6">2ï¸âƒ£ ä» <code>v$sql</code> æŸ¥å†å²æ…¢ SQL</h4>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">SELECT</span> 
    sql_id,
    SUBSTR(sql_text, <span class="hljs-number">1</span>, <span class="hljs-number">100</span>) <span class="hljs-keyword">AS</span> sql_text,
    executions <span class="hljs-keyword">AS</span> æ‰§è¡Œæ¬¡æ•°,
    ROUND(elapsed_time/<span class="hljs-number">1000000</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> æ€»è€—æ—¶_ç§’,
    ROUND(cpu_time/<span class="hljs-number">1000000</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> CPUæ—¶é—´_ç§’,
    disk_reads <span class="hljs-keyword">AS</span> ç£ç›˜è¯»å–,
    buffer_gets <span class="hljs-keyword">AS</span> ç¼“å†²åŒºè·å–,
    rows_processed <span class="hljs-keyword">AS</span> å¤„ç†è¡Œæ•°,
    last_load_time <span class="hljs-keyword">AS</span> æœ€ååŠ è½½æ—¶é—´
<span class="hljs-keyword">FROM</span> v$sql
<span class="hljs-keyword">WHERE</span> elapsed_time/<span class="hljs-number">1000000</span> &gt; <span class="hljs-number">5</span>
  <span class="hljs-built_in">AND</span> parsing_schema_name = <span class="hljs-comment">'GSTPGG'</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> elapsed_time DESC
FETCH FIRST <span class="hljs-number">20</span> ROWS ONLY;
</code></pre>
<h4 data-id="heading-7">ğŸ“Š å…³é”®å‘ç°</h4>




















<table><thead><tr><th>ç±»å‹</th><th>å¯¹è±¡</th><th>æ‰«ææ–¹å¼</th></tr></thead><tbody><tr><td>å¤šæ¡ SQL</td><td>CEN_CHECK_MEMBER</td><td><strong>Table Scanï¼ˆå…¨è¡¨æ‰«æï¼‰</strong></td></tr><tr><td>å°‘é‡ SQL</td><td>RISK_CLUE_BASIC_INFO</td><td>Index Fast Full Scan</td></tr></tbody></table>
<p>â¡ï¸ <strong>æ€§èƒ½ç“¶é¢ˆæ˜ç¡®ï¼šCEN_CHECK_MEMBER è¡¨</strong></p>
<hr/>
<h3 data-id="heading-8">å››ã€ç¬¬ä¸‰æ­¥ï¼šå®šä½æ­£åœ¨æ‰§è¡Œçš„â€œé•¿æ—¶é—´æ‰«æä»»åŠ¡â€</h3>
<h4 data-id="heading-9">3ï¸âƒ£ ä½¿ç”¨ <code>v$session_longops</code> æŸ¥çœ‹è¿›åº¦</h4>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">SELECT</span> 
    l.sid,
    l.serial#,
    s.sql_id,
    s.sql_text,
    l.opname,
    l.target,
    l.sofar,
    l.totalwork,
    ROUND(l.sofar/l.totalwork*<span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> pct_complete,
    l.elapsed_seconds,
    l.time_remaining
<span class="hljs-keyword">FROM</span> v$session_longops l
<span class="hljs-keyword">JOIN</span> v$session se <span class="hljs-keyword">ON</span> l.sid = se.sid <span class="hljs-built_in">AND</span> l.serial# = se.serial#
LEFT <span class="hljs-keyword">JOIN</span> v$sql s <span class="hljs-keyword">ON</span> se.sql_id = s.sql_id
<span class="hljs-keyword">WHERE</span> l.opname <span class="hljs-built_in">LIKE</span> <span class="hljs-comment">'%Scan%'</span>
  <span class="hljs-built_in">AND</span> l.username = <span class="hljs-comment">'GSTPGG'</span>
  <span class="hljs-built_in">AND</span> l.time_remaining &gt; <span class="hljs-number">0</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> l.start_time;
</code></pre>
<h4 data-id="heading-10">ğŸš¨ ç»“æœéå¸¸å±é™©</h4>
<ul>
<li><strong>5 ä¸ªä¼šè¯åŒæ—¶</strong></li>
<li>å¯¹ <strong>åŒä¸€å¼ è¡¨ <code>CEN_CHECK_MEMBER</code></strong></li>
<li>è¿›è¡Œ <strong>å¹¶å‘å…¨è¡¨æ‰«æ</strong></li>
<li>æ¯ä¸ªä¼šè¯æ‰«æè¿›åº¦ä»… <strong>8% ~ 28%</strong></li>
</ul>
<p>â¡ï¸ è¿™ä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>Buffer Cache è¢«ç–¯ç‹‚æŒ¤å </li>
<li>å…¶ä»– SQL å…¨éƒ¨å˜æ…¢</li>
<li>æ•°æ®åº“â€œçœ‹èµ·æ¥åƒæ­»äº†ä¸€æ ·â€</li>
</ul>
<hr/>
<h3 data-id="heading-11">äº”ã€ç¬¬å››æ­¥ï¼šåˆ†æé—®é¢˜è¡¨æœ¬èº«ï¼ˆæ ¸å¿ƒï¼‰</h3>
<h4 data-id="heading-12">4ï¸âƒ£ è¡¨åŸºæœ¬ä¿¡æ¯</h4>
<pre><code class="hljs language-ini" lang="ini">SELECT 
    owner,
    table_name,
    num_rows,
    blocks,
    avg_row_len,
    last_analyzed
FROM dba_tables 
WHERE <span class="hljs-attr">owner</span> = <span class="hljs-string">'GSTPGG'</span>
  AND <span class="hljs-attr">table_name</span> = <span class="hljs-string">'CEN_CHECK_MEMBER'</span><span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-13">ğŸ“Š è¡¨åˆ†æç»“æœ</h4>

























<table><thead><tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th></tr></thead><tbody><tr><td>è¡Œæ•°</td><td><strong>20,496,308 è¡Œ</strong></td></tr><tr><td>æ•°æ®å—</td><td><strong>440,297 blocks</strong></td></tr><tr><td>å¹³å‡è¡Œé•¿</td><td>149 å­—èŠ‚</td></tr><tr><td>æœ€è¿‘åˆ†ææ—¶é—´</td><td>3 å¤©å‰</td></tr></tbody></table>
<h4 data-id="heading-14">â±ï¸ ç†è®ºæ‰«æè€—æ—¶ä¼°ç®—</h4>
<pre><code class="hljs language-bash" lang="bash">440,297 blocks Ã— 8KB â‰ˆ 3.44GB
3.44GB Ã· 200MB/s â‰ˆ 17 ç§’ï¼ˆç†æƒ³ï¼‰
</code></pre>
<p>âš ï¸ <strong>ç°å®æƒ…å†µï¼š</strong></p>
<ul>
<li>å¤šä¼šè¯å¹¶å‘</li>
<li>Buffer Cache äº‰æŠ¢</li>
<li>CPU è°ƒåº¦</li>
</ul>
<p>â¡ï¸ å®é™…è€—æ—¶ï¼š<strong>å‡ åç§’ ~ æ•°åˆ†é’Ÿ</strong></p>
<hr/>
<h3 data-id="heading-15">å…­ã€ç¬¬äº”æ­¥ï¼šç²¾å‡†é”å®šâ€œç½ªé­ç¥¸é¦– SQLâ€</h3>
<h4 data-id="heading-16">5ï¸âƒ£ æ‰¾å‡ºæ‰§è¡Œå…¨è¡¨æ‰«æçš„ SQL</h4>
<pre><code class="hljs language-ini" lang="ini">SELECT 
    s.sid,
    s.serial<span class="hljs-comment">#,</span>
    s.sql_id,
    SUBSTR(q.sql_text, 1, 200) AS sql_text,
    s.program,
    s.last_call_et
FROM v$session s
JOIN v$sql q ON <span class="hljs-attr">s.sql_id</span> = q.sql_id
WHERE s.sql_id IN (
    SELECT sql_id
    FROM v$sql_plan
    WHERE <span class="hljs-attr">object_name</span> = <span class="hljs-string">'CEN_CHECK_MEMBER'</span>
      AND <span class="hljs-attr">operation</span> = <span class="hljs-string">'TABLE ACCESS'</span>
      AND <span class="hljs-attr">options</span> = <span class="hljs-string">'FULL'</span>
)<span class="hljs-comment">;</span>
</code></pre>
<p>ğŸ” <strong>å‘ç°å¤šä¸ªä¼šè¯åœ¨åå¤æ‰§è¡ŒåŒä¸€æ¡ SQL</strong></p>
<hr/>
<h3 data-id="heading-17">ä¸ƒã€ç¬¬å…­æ­¥ï¼šæ‰“å°å®Œæ•´ SQLï¼ˆå…³é”®ï¼‰</h3>
<h4 data-id="heading-18">6ï¸âƒ£ ä½¿ç”¨ <code>v$sqltext</code> è¿˜åŸå®Œæ•´ SQL</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">LISTAGG</span>(sql_text, <span class="hljs-string">''</span>) 
       <span class="hljs-keyword">WITHIN</span> <span class="hljs-keyword">GROUP</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> piece) <span class="hljs-keyword">AS</span> full_sql_text
<span class="hljs-keyword">FROM</span> v$sqltext
<span class="hljs-keyword">WHERE</span> sql_id <span class="hljs-operator">=</span> <span class="hljs-string">'9jdbd64yqbwcf'</span>;
</code></pre>
<h4 data-id="heading-19">âœ… å®Œæ•´ SQL å¦‚ä¸‹ï¼š</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> ...
<span class="hljs-keyword">FROM</span> CEN_CHECK_MEMBER
<span class="hljs-keyword">WHERE</span> (card_id <span class="hljs-keyword">LIKE</span> :<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> IS_DELETE <span class="hljs-operator">=</span> :<span class="hljs-number">2</span>)
</code></pre>
<hr/>
<h3 data-id="heading-20">å…«ã€é—®é¢˜æœ¬è´¨ç»ˆäºæµ®å‡ºæ°´é¢</h3>
<h3 data-id="heading-21">ğŸš¨ æ ¸å¿ƒæ€§èƒ½é—®é¢˜æ€»ç»“</h3>
<h4 data-id="heading-22">âŒ 1. <code>LIKE</code> æ¡ä»¶å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</h4>
<ul>
<li><code>card_id LIKE '%xxx%'</code></li>
<li><strong>B-Tree ç´¢å¼•æ— æ³•ä½¿ç”¨</strong></li>
<li>Oracle åªèƒ½é€‰æ‹© <strong>å…¨è¡¨æ‰«æ</strong></li>
</ul>
<h4 data-id="heading-23">âŒ 2. è¡¨å¤ªå¤§ + é«˜é¢‘è°ƒç”¨</h4>
<ul>
<li>å•è¡¨ 2000 ä¸‡è¡Œ</li>
<li>SQL æ‰§è¡Œ <strong>1599 æ¬¡</strong></li>
<li>æ€»é€»è¾‘è¯» <strong>6.67 äº¿æ¬¡</strong></li>
<li>å¤„ç†æ•°æ® <strong>2.85 äº¿è¡Œ</strong></li>
</ul>
<h4 data-id="heading-24">âŒ 3. å¹¶å‘æ‰§è¡Œé›ªä¸ŠåŠ éœœ</h4>
<ul>
<li>å¤šä¸ª JDBC ä¼šè¯åŒæ—¶æ‰«æ</li>
<li>Buffer Cache è¢«â€œåˆ·çˆ†â€</li>
</ul>
<hr/>
<h3 data-id="heading-25">ä¹ã€åº”æ€¥å¤„ç†ï¼šç«‹å³æ­¢è¡€</h3>
<h4 data-id="heading-26">7ï¸âƒ£ ç”Ÿæˆæ‰¹é‡ Kill ä¼šè¯è„šæœ¬</h4>
<pre><code class="hljs language-ini" lang="ini">SELECT 
    'ALTER SYSTEM KILL SESSION ''' || s.sid || ',' || s.serial<span class="hljs-comment"># || ''' IMMEDIATE;' AS kill_cmd</span>
FROM v$session s
WHERE <span class="hljs-attr">s.sql_id</span> = <span class="hljs-string">'9jdbd64yqbwcf'</span>
  AND <span class="hljs-attr">s.username</span> = <span class="hljs-string">'GSTPGG'</span>
  AND <span class="hljs-attr">s.status</span> = <span class="hljs-string">'ACTIVE'</span>
  AND s.last_call_et &gt; 10<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>âš ï¸ <strong>ä»…ç”¨äºåº”æ€¥ï¼ŒåŠ¡å¿…ä¸ä¸šåŠ¡ç¡®è®¤</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-27">åã€æ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼ˆé‡ç‚¹ï¼‰</h3>
<h3 data-id="heading-28">âœ… æ–¹æ¡ˆä¸€ï¼šåˆ›å»ºæ­£ç¡®ç´¢å¼•</h3>
<pre><code class="hljs language-ini" lang="ini">CREATE INDEX IDX_CEN_CHECK_MEMBER_CARD_DEL
ON GSTPGG.CEN_CHECK_MEMBER(card_id, IS_DELETE)
NOLOGGING PARALLEL 8<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-29">ç´¢å¼•ç”Ÿæ•ˆå‰æ</h4>

















<table><thead><tr><th>LIKE å†™æ³•</th><th>æ˜¯å¦èµ°ç´¢å¼•</th></tr></thead><tbody><tr><td><code>card_id LIKE '123%'</code></td><td>âœ… æ˜¯</td></tr><tr><td><code>card_id LIKE '%123%'</code></td><td>âŒ å¦</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-30">âœ… æ–¹æ¡ˆäºŒï¼šä¸šåŠ¡ SQL æ”¹é€ å»ºè®®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åŸï¼ˆå±é™©ï¼‰</span>
<span class="hljs-keyword">WHERE</span> card_id <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%123%'</span>

<span class="hljs-comment">-- ä¼˜åŒ–ï¼ˆå¯æ§ï¼‰</span>
<span class="hljs-keyword">WHERE</span> card_id <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'123%'</span>
</code></pre>
<hr/>
<h3 data-id="heading-31">âœ… æ–¹æ¡ˆä¸‰ï¼šåˆ†é¡µ + åˆ—è£å‰ª</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> mem_number, mem_name, card_id
<span class="hljs-keyword">FROM</span> CEN_CHECK_MEMBER
<span class="hljs-keyword">WHERE</span> card_id <span class="hljs-keyword">LIKE</span> :<span class="hljs-number">1</span>
  <span class="hljs-keyword">AND</span> IS_DELETE <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">AND</span> ROWNUM <span class="hljs-operator">&lt;=</span> <span class="hljs-number">50</span>;
</code></pre>
<hr/>
<h3 data-id="heading-32">åä¸€ã€ç»éªŒæ€»ç»“ï¼ˆè¡€çš„æ•™è®­ï¼‰</h3>
<blockquote>
<p><strong>Oracle æ…¢ SQL æ’æŸ¥ä¸‰æ¿æ–§ï¼š</strong></p>
</blockquote>
<ol>
<li><strong>v$session</strong>ï¼šçœ‹ç°åœ¨è°åœ¨è·‘</li>
<li><strong>v<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>q</mi><mi>l</mi><mi mathvariant="normal">/</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">sql / v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.01968em;">ql</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>sql_plan</strong>ï¼šçœ‹è°æœ€è€—èµ„æº</li>
<li><strong>æ‰§è¡Œè®¡åˆ’ + è¡¨è§„æ¨¡</strong>ï¼šåˆ¤æ–­æ˜¯ä¸æ˜¯â€œä¸è¯¥æ‰«å´åœ¨æ‰«â€</li>
</ol>
<hr/>
<h3 data-id="heading-33">ğŸ¯ æœ€ç»ˆç»“è®º</h3>
<blockquote>
<p><strong>æ•°æ®åº“ä¸æ˜¯â€œçªç„¶å˜æ…¢â€çš„ï¼Œè€Œæ˜¯æŸæ¡ SQL åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è¢«æ”¾å¤§äº† 1000 å€ã€‚</strong></p>
</blockquote>
<ul>
<li>ä¸€æ¬¡ <code>%LIKE%</code></li>
<li>ä¸€å¼  2000 ä¸‡è¡Œè¡¨</li>
<li>å‡ ä¸ªå¹¶å‘ä¼šè¯<br/>
â¡ï¸ è¶³ä»¥æ‹–å®æ•´ä¸ª Oracle å®ä¾‹</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æ“å‰ç«¯è™šæ‹Ÿåˆ—è¡¨]]></title>    <link>https://juejin.cn/post/7589201772134416425</link>    <guid>https://juejin.cn/post/7589201772134416425</guid>    <pubDate>2025-12-30T06:34:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589201772134416425" data-draft-id="7589220406319710244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æ“å‰ç«¯è™šæ‹Ÿåˆ—è¡¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-30T06:34:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="echo_e"/> <meta itemprop="url" content="https://juejin.cn/user/1267099625328903"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æ“å‰ç«¯è™šæ‹Ÿåˆ—è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1267099625328903/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    echo_e
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T06:34:17.000Z" title="Tue Dec 30 2025 06:34:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è™šæ‹Ÿåˆ—è¡¨</h2>
<h3 data-id="heading-1">è™šæ‹Ÿåˆ—è¡¨ï¼ˆVirtualListï¼‰æ ¸å¿ƒåŸç†è¯¦è§£ï¼š</h3>
<ol>
<li>
<p>åªæ¸²æŸ“å¯è§åŒºåŸŸçš„æ•°æ®é¡¹ï¼Œæå¤§å‡å°‘ DOM æ•°é‡ï¼Œæå‡æ€§èƒ½ã€‚</p>
</li>
<li>
<p>ç”¨ .phantom ç»å¯¹å®šä½å…ƒç´ æ’‘èµ·æ€»é«˜åº¦ï¼Œåˆ¶é€ å®Œæ•´æ»šåŠ¨æ¡ä½“éªŒã€‚</p>
</li>
<li>
<p>.real-list ç»å¯¹å®šä½ï¼Œé€šè¿‡ transform: translateY(offset) ç²¾ç¡®ç§»åŠ¨åˆ°å¯è§åŒºé¡¶éƒ¨ã€‚</p>
<ul>
<li>.real-list çš„é«˜åº¦æ— éœ€è®¾ç½®ï¼Œå†…å®¹é«˜åº¦ç”±æ¸²æŸ“çš„ item æ•°é‡è‡ªåŠ¨æ’‘å¼€ã€‚</li>
<li>ä¸ºä»€ä¹ˆä¸è®¾ç½® .real-list é«˜åº¦ï¼Ÿ
<ul>
<li>åªè¦ä¿è¯ .phantom æ’‘èµ·æ»šåŠ¨æ¡ï¼Œ.real-list åªéœ€æ¸²æŸ“å¯è§é¡¹å¹¶åç§»åˆ°æ­£ç¡®ä½ç½®å³å¯ã€‚</li>
<li>.real-list çš„é«˜åº¦ = (end - start) * itemHeightï¼Œç”±æ¸²æŸ“çš„ div è‡ªåŠ¨æ’‘å¼€ã€‚</li>
<li>è¿™æ ·å¯ä»¥é¿å…å¤šä½™çš„ç©ºç™½åŒºåŸŸï¼Œä¸”æ»šåŠ¨æ—¶å§‹ç»ˆåªæ¸²æŸ“éœ€è¦çš„ DOMã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ»šåŠ¨æ—¶æ ¹æ® scrollTop åŠ¨æ€è®¡ç®—å¯è§åŒºçš„ start/end ç´¢å¼•ï¼Œåªæ¸²æŸ“è¿™éƒ¨åˆ†æ•°æ®ã€‚</p>
</li>
<li>
<p>overScan é¢„æ¸²æŸ“ç¼“å†²åŒºï¼Œé¿å…æ»šåŠ¨è¿‡å¿«å‡ºç°ç™½å±ã€‚
ä»£ç ç»“æ„è¯´æ˜ï¼š</p>
<ul>
<li>VirtualList æ„é€ å‡½æ•°ï¼š
<ul>
<li>è‡ªåŠ¨è·å–å®¹å™¨é«˜åº¦ï¼ˆcontainer.clientHeightï¼‰ï¼Œè®¡ç®—å¯è§é¡¹æ•° visibleCountã€‚</li>
<li>åˆ›å»º .phantom å…ƒç´ ï¼Œé«˜åº¦ä¸º data.length * itemHeightï¼Œæ’‘èµ·æ»šåŠ¨æ¡ã€‚</li>
<li>åˆ›å»º .real-list å…ƒç´ ï¼Œå®é™…æ¸²æŸ“å¯è§åŒºçš„ itemã€‚</li>
<li>ç»‘å®š scroll äº‹ä»¶ï¼Œæ»šåŠ¨æ—¶è§¦å‘ renderã€‚</li>
</ul>
</li>
<li>render æ–¹æ³•ï¼š
<ul>
<li>è®¡ç®—å½“å‰æ»šåŠ¨ scrollTopã€‚</li>
<li>è®¡ç®—å¯è§åŒºèµ·æ­¢ç´¢å¼• start/endï¼ˆå« overScanï¼‰ã€‚</li>
<li>è®¡ç®— .real-list çš„ translateY åç§»é‡ offsetY = start * itemHeightã€‚</li>
<li>åªæ¸²æŸ“ start~end åŒºé—´çš„æ•°æ®é¡¹ã€‚</li>
</ul>
</li>
<li>getColorï¼š
<ul>
<li>ä¸ºæ¯ä¸ª item ç¼“å­˜å”¯ä¸€éšæœºè‰²ï¼Œä¿è¯æ»šåŠ¨å¤ç”¨æ—¶é¢œè‰²ä¸å˜ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™æ ·å®ç°åï¼š</p>
<ul>
<li>é¡µé¢ä¸Šå§‹ç»ˆåªæœ‰å‡ åä¸ª DOM èŠ‚ç‚¹ï¼Œå“ªæ€•æ•°æ®æœ‰ 10 ä¸‡æ¡ã€‚</li>
<li>æ»šåŠ¨æ¡é•¿åº¦ã€æ»šåŠ¨ä½“éªŒä¸åŸç”Ÿé•¿åˆ—è¡¨ä¸€è‡´ã€‚</li>
<li>æ€§èƒ½æé«˜ï¼Œä¸å¡é¡¿ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-2">ä»£ç æ¼”ç¤º</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ‰‹æ“è™šæ‹Ÿåˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        }

        * {
            <span class="hljs-attribute">box-sizing</span>: border-box;
        }

        <span class="hljs-selector-id">#container</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100vw</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
            <span class="hljs-attribute">position</span>: relative;
        }

        <span class="hljs-selector-class">.item</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">50px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#eee</span>;
            <span class="hljs-attribute">box-sizing</span>: border-box;
            <span class="hljs-attribute">text-align</span>: center;
        }

        <span class="hljs-selector-class">.phantom</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">z-index</span>: <span class="hljs-number">0</span>;
        }

        <span class="hljs-selector-class">.real-list</span> {
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-comment">&lt;!--
        è™šæ‹Ÿåˆ—è¡¨ï¼ˆVirtualListï¼‰æ ¸å¿ƒåŸç†è¯¦è§£ï¼š

        1. åªæ¸²æŸ“å¯è§åŒºåŸŸçš„æ•°æ®é¡¹ï¼Œæå¤§å‡å°‘ DOM æ•°é‡ï¼Œæå‡æ€§èƒ½ã€‚
        2. ç”¨ .phantom ç»å¯¹å®šä½å…ƒç´ æ’‘èµ·æ€»é«˜åº¦ï¼Œåˆ¶é€ å®Œæ•´æ»šåŠ¨æ¡ä½“éªŒã€‚
        3. .real-list ç»å¯¹å®šä½ï¼Œé€šè¿‡ transform: translateY(offset) ç²¾ç¡®ç§»åŠ¨åˆ°å¯è§åŒºé¡¶éƒ¨ã€‚
            - .real-list çš„é«˜åº¦æ— éœ€è®¾ç½®ï¼Œå†…å®¹é«˜åº¦ç”±æ¸²æŸ“çš„ item æ•°é‡è‡ªåŠ¨æ’‘å¼€ã€‚
            - ä¸ºä»€ä¹ˆä¸è®¾ç½® .real-list é«˜åº¦ï¼Ÿ
                * åªè¦ä¿è¯ .phantom æ’‘èµ·æ»šåŠ¨æ¡ï¼Œ.real-list åªéœ€æ¸²æŸ“å¯è§é¡¹å¹¶åç§»åˆ°æ­£ç¡®ä½ç½®å³å¯ã€‚
                * .real-list çš„é«˜åº¦ = (end - start) * itemHeightï¼Œç”±æ¸²æŸ“çš„ div è‡ªåŠ¨æ’‘å¼€ã€‚
                * è¿™æ ·å¯ä»¥é¿å…å¤šä½™çš„ç©ºç™½åŒºåŸŸï¼Œä¸”æ»šåŠ¨æ—¶å§‹ç»ˆåªæ¸²æŸ“éœ€è¦çš„ DOMã€‚
        4. æ»šåŠ¨æ—¶æ ¹æ® scrollTop åŠ¨æ€è®¡ç®—å¯è§åŒºçš„ start/end ç´¢å¼•ï¼Œåªæ¸²æŸ“è¿™éƒ¨åˆ†æ•°æ®ã€‚
        5. overscan é¢„æ¸²æŸ“ç¼“å†²åŒºï¼Œé¿å…æ»šåŠ¨è¿‡å¿«å‡ºç°ç™½å±ã€‚

        ä»£ç ç»“æ„è¯´æ˜ï¼š
        - VirtualList æ„é€ å‡½æ•°ï¼š
            * è‡ªåŠ¨è·å–å®¹å™¨é«˜åº¦ï¼ˆcontainer.clientHeightï¼‰ï¼Œè®¡ç®—å¯è§é¡¹æ•° visibleCountã€‚
            * åˆ›å»º .phantom å…ƒç´ ï¼Œé«˜åº¦ä¸º data.length * itemHeightï¼Œæ’‘èµ·æ»šåŠ¨æ¡ã€‚
            * åˆ›å»º .real-list å…ƒç´ ï¼Œå®é™…æ¸²æŸ“å¯è§åŒºçš„ itemã€‚
            * ç»‘å®š scroll äº‹ä»¶ï¼Œæ»šåŠ¨æ—¶è§¦å‘ renderã€‚
        - render æ–¹æ³•ï¼š
            * è®¡ç®—å½“å‰æ»šåŠ¨ scrollTopã€‚
            * è®¡ç®—å¯è§åŒºèµ·æ­¢ç´¢å¼• start/endï¼ˆå« overscanï¼‰ã€‚
            * è®¡ç®— .real-list çš„ translateY åç§»é‡ offsetY = start * itemHeightã€‚
            * åªæ¸²æŸ“ start~end åŒºé—´çš„æ•°æ®é¡¹ã€‚
        - getColorï¼š
            * ä¸ºæ¯ä¸ª item ç¼“å­˜å”¯ä¸€éšæœºè‰²ï¼Œä¿è¯æ»šåŠ¨å¤ç”¨æ—¶é¢œè‰²ä¸å˜ã€‚

        è¿™æ ·å®ç°åï¼š
        - é¡µé¢ä¸Šå§‹ç»ˆåªæœ‰å‡ åä¸ª DOM èŠ‚ç‚¹ï¼Œå“ªæ€•æ•°æ®æœ‰ 10 ä¸‡æ¡ã€‚
        - æ»šåŠ¨æ¡é•¿åº¦ã€æ»šåŠ¨ä½“éªŒä¸åŸç”Ÿé•¿åˆ—è¡¨ä¸€è‡´ã€‚
        - æ€§èƒ½æé«˜ï¼Œä¸å¡é¡¿ã€‚
        --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">/**
         * è™šæ‹Ÿåˆ—è¡¨ç±»ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡é«˜æ€§èƒ½æ»šåŠ¨æ¸²æŸ“
         */</span>
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualList</span> {
            <span class="hljs-comment">/**
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">options</span>
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HTMLElement</span>} options.container å®¹å™¨å…ƒç´ 
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} options.data æ•°æ®æºæ•°ç»„
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} options.itemHeight å•é¡¹é«˜åº¦ï¼ˆpxï¼‰
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} options.containerHeight å®¹å™¨é«˜åº¦ï¼ˆpxï¼‰
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function</span>} options.renderItem æ¸²æŸ“å•é¡¹å‡½æ•° (item, index) =&gt; htmlå­—ç¬¦ä¸²
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} [options.overscan=5] é¢„æ¸²æŸ“ç¼“å†²åŒºï¼ˆå¯è§åŒºä¸Šä¸‹å¤šæ¸²æŸ“å‡ é¡¹ï¼Œæå‡æ»šåŠ¨ä½“éªŒï¼‰
             */</span>
            <span class="hljs-title function_">constructor</span>(<span class="hljs-params">{ container, data, itemHeight, renderItem, overscan = <span class="hljs-number">5</span> }</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = container;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span> = itemHeight;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderItem</span> = renderItem;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">overscan</span> = overscan;

                <span class="hljs-comment">// è‡ªåŠ¨è·å–å®¹å™¨é«˜åº¦</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerHeight</span> = container.<span class="hljs-property">clientHeight</span>;
                <span class="hljs-comment">// è®¡ç®—å¯è§åŒºåŸŸæœ€å¤šèƒ½æ˜¾ç¤ºå¤šå°‘é¡¹</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleCount</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerHeight</span> / itemHeight);

                <span class="hljs-comment">// åˆ›å»ºä¼ªå…ƒç´ æ’‘èµ·æ€»é«˜åº¦</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantom</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantom</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'phantom'</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantom</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = data.<span class="hljs-property">length</span> * itemHeight + <span class="hljs-string">'px'</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">phantom</span>);

                <span class="hljs-comment">// çœŸæ­£æ¸²æŸ“çš„åˆ—è¡¨åŒºåŸŸ</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">realList</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">realList</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'real-list'</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">realList</span>);

                <span class="hljs-comment">// ç»‘å®šæ»šåŠ¨äº‹ä»¶</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));

                <span class="hljs-comment">// é¦–æ¬¡æ¸²æŸ“</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
            }

            <span class="hljs-comment">/**
             * æ»šåŠ¨äº‹ä»¶å¤„ç†ï¼Œé‡æ–°æ¸²æŸ“å¯è§åŒºåŸŸ
             */</span>
            <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// this.render();</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rafId</span>) <span class="hljs-title function_">cancelAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rafId</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">rafId</span> = <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rafId</span> = <span class="hljs-literal">null</span>;
                });
            }
            <span class="hljs-comment">// 17 + 5 + 5 = 27</span>
            <span class="hljs-comment">/**
             * æ¸²æŸ“å¯è§åŒºåŸŸçš„åˆ—è¡¨é¡¹
             */</span>
            <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// å½“å‰æ»šåŠ¨è·ç¦»</span>
                <span class="hljs-keyword">const</span> scrollTop = <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">scrollTop</span>;
                <span class="hljs-comment">/*
                å‡è®¾æˆ‘ä»¬çš„visibleCountæ˜¯10ï¼Œé¢„ç•™çš„æ˜¯5ä¸ªï¼Œä¹Ÿå°±æ˜¯å®é™…æ¸²æŸ“ä¼šæ¸²æŸ“10+5*2 = 20ä¸ª
                è¿™ä¸ªæ—¶å€™å¦‚æœæ»šåŠ¨é«˜åº¦è¶…è¿‡5ä¸ªï¼Œæ»šåŠ¨å…¶å®å°±æ˜¯å±•ç¤ºvisibleCountä¹‹å¤–çš„åˆ—è¡¨ï¼Œå¦‚æœè¶…è¿‡5ä¸ªçš„é«˜åº¦ï¼ˆå…¶å®è¿˜é¢„ç•™äº†5ä¸ªï¼‰
                é‚£è¿™ä¸ªæ—¶å€™å°±è¦ç§»åŠ¨startä¹‹å‰æ˜¯(0-19)å±•ç¤º20ä¸ªåˆ—è¡¨ï¼Œstart=1å°±è¦å±•ç¤º(1,20)ä¸ªã€‚
                è¿™ä¸ªæ—¶å€™å¦‚æœä¸æ“ä½œrealListçš„transformçš„è¯ï¼Œè¿™ä¸ªæ—¶å€™æ•´ä¸ªrealListå°±æ˜¯ç§»åŠ¨åˆ°çœ‹ä¸åˆ°çš„åœ°æ–¹äº†
                */</span>
                <span class="hljs-keyword">let</span> start = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(scrollTop / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>) - <span class="hljs-variable language_">this</span>.<span class="hljs-property">overscan</span>;
                start = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, start);
                <span class="hljs-comment">// è®¡ç®—å¯è§åŒºåŸŸç»“æŸç´¢å¼•</span>
                <span class="hljs-keyword">let</span> end = start + <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleCount</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">overscan</span> * <span class="hljs-number">2</span>;
                end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">length</span>, end);

                <span class="hljs-comment">// åªæœ‰ start æˆ– end å‘ç”Ÿå˜åŒ–æ—¶æ‰æ›´æ–° DOM</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_lastStart</span> === start &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_lastEnd</span> === end) {
                    <span class="hljs-comment">// æ²¡æœ‰æ–°å…ƒç´ è¿›å…¥è§†å£ï¼Œæ— éœ€æ›´æ–°</span>
                    <span class="hljs-keyword">return</span>;
                }
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_lastStart</span> = start;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_lastEnd</span> = end;

                <span class="hljs-comment">// è®¡ç®—çœŸå®åˆ—è¡¨çš„åç§»é‡</span>
                <span class="hljs-keyword">const</span> offsetY = start * <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>;
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'render'</span>, { scrollTop, start, end, offsetY });
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">realList</span>.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateY(<span class="hljs-subst">${offsetY}</span>px)`</span>;
                <span class="hljs-comment">// æ¸²æŸ“å¯è§é¡¹</span>
                <span class="hljs-keyword">let</span> html = <span class="hljs-string">''</span>;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; end; i++) {
                    html += <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>[i], i);
                }
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">realList</span>.<span class="hljs-property">innerHTML</span> = html;
            }
        }

        <span class="hljs-comment">// ç¤ºä¾‹æ•°æ®</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">100000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> <span class="hljs-string">`ç¬¬ <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span> é¡¹`</span>);

        <span class="hljs-comment">// å®ä¾‹åŒ–è™šæ‹Ÿåˆ—è¡¨</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">VirtualList</span>({
            <span class="hljs-attr">container</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'container'</span>),
            data,
            <span class="hljs-attr">itemHeight</span>: <span class="hljs-number">50</span>,
            <span class="hljs-attr">renderItem</span>: <span class="hljs-function">(<span class="hljs-params">item, idx</span>) =&gt;</span> <span class="hljs-string">`&lt;div class="item" &gt;<span class="hljs-subst">${item}</span>&lt;/div&gt;`</span>
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">å…³é”®é€»è¾‘å›¾è§£</h3>
<ul>
<li>æ»šåŠ¨æ–¹æ¡ˆ
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08397ed1129e4b119637540f30ca08f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZWNob19l:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767681256&amp;x-signature=5240Eq12gUE6tt4TXQPygRthTL8%3D" alt="image.png" loading="lazy"/></li>
<li>parentæ’‘èµ·é«˜åº¦ï¼Œæ¨¡æ‹Ÿitemæ•°é‡ä¸‹çš„æ»šåŠ¨
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b20a430a4e4407f8f8ade9a34c4aa10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZWNob19l:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767681256&amp;x-signature=VZjO0ofcKAoGDCPod9%2FxROkpmZg%3D" alt="image-1.png" loading="lazy"/></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaå¸¸è§é¢è¯•é¢˜åŠç­”æ¡ˆæ±‡æ€»]]></title>    <link>https://juejin.cn/post/7589275237038129187</link>    <guid>https://juejin.cn/post/7589275237038129187</guid>    <pubDate>2025-12-30T07:11:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589275237038129187" data-draft-id="7589445154533244980" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaå¸¸è§é¢è¯•é¢˜åŠç­”æ¡ˆæ±‡æ€»"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Java"/> <meta itemprop="datePublished" content="2025-12-30T07:11:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaæ°´è§£"/> <meta itemprop="url" content="https://juejin.cn/user/2441349519143037"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaå¸¸è§é¢è¯•é¢˜åŠç­”æ¡ˆæ±‡æ€»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2441349519143037/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaæ°´è§£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-30T07:11:43.000Z" title="Tue Dec 30 2025 07:11:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-30
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0"><strong>ğŸ“š ä¸€ã€Java åŸºç¡€</strong></h3>
<h4 data-id="heading-1"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>1. Java çš„ä¸‰å¤§ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>å°è£…</strong>ï¼šéšè—å¯¹è±¡çš„å±æ€§å’Œå®ç°ç»†èŠ‚ï¼Œä»…å¯¹å¤–æä¾›è®¿é—®æ–¹å¼ï¼ˆgetter/setterï¼‰ã€‚</li>
<li><strong>ç»§æ‰¿</strong>ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œæé«˜ä»£ç å¤ç”¨æ€§ã€‚</li>
<li><strong>å¤šæ€</strong>ï¼šåŒä¸€æ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸Šæœ‰ä¸åŒè¡Œä¸ºï¼ˆæ–¹æ³•é‡å†™ã€æ¥å£å®ç°ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-2"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>2. == å’Œ equals() çš„åŒºåˆ«ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><code>==</code>ï¼šæ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ï¼Œæˆ–å¼•ç”¨ç±»å‹çš„å†…å­˜åœ°å€ã€‚</li>
<li><code>equals()</code>ï¼šé»˜è®¤æ¯”è¾ƒå¯¹è±¡åœ°å€ï¼ˆObjectç±»ï¼‰ï¼Œä½†å¯è¢«é‡å†™ï¼ˆå¦‚ String æ¯”è¾ƒå†…å®¹ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-3"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>3. Stringã€StringBuilderã€StringBuffer çš„åŒºåˆ«ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>





























<table><thead><tr><th>ç±»</th><th>å¯å˜æ€§</th><th>çº¿ç¨‹å®‰å…¨</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>String</code></td><td>âŒ ä¸å¯å˜</td><td>âœ… å®‰å…¨ï¼ˆfinalï¼‰</td><td>å­—ç¬¦ä¸²å¸¸é‡</td></tr><tr><td><code>StringBuilder</code></td><td>âœ… å¯å˜</td><td>âŒ ä¸å®‰å…¨</td><td>å•çº¿ç¨‹å­—ç¬¦ä¸²æ“ä½œ</td></tr><tr><td><code>StringBuffer</code></td><td>âœ… å¯å˜</td><td>âœ… å®‰å…¨ï¼ˆsynchronizedï¼‰</td><td>å¤šçº¿ç¨‹å­—ç¬¦ä¸²æ“ä½œ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-4"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ğŸ” äºŒã€Java é›†åˆ</strong></h3>
<h4 data-id="heading-5"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>4. ArrayList å’Œ LinkedList çš„åŒºåˆ«ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>






























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>ArrayList</th><th>LinkedList</th></tr></thead><tbody><tr><td><strong>åº•å±‚ç»“æ„</strong></td><td>åŠ¨æ€æ•°ç»„</td><td>åŒå‘é“¾è¡¨</td></tr><tr><td><strong>æŸ¥è¯¢æ•ˆç‡</strong></td><td>O(1)ï¼ˆéšæœºè®¿é—®å¿«ï¼‰</td><td>O(n)ï¼ˆéœ€éå†ï¼‰</td></tr><tr><td><strong>å¢åˆ æ•ˆç‡</strong></td><td>O(n)ï¼ˆéœ€ç§»åŠ¨å…ƒç´ ï¼‰</td><td>O(1)ï¼ˆå¤´å°¾æ“ä½œå¿«ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é¢‘ç¹æŸ¥è¯¢</td><td>é¢‘ç¹å¢åˆ </td></tr></tbody></table>
<blockquote>
<blockquote>
<p><strong>ç¯‡å¹…é™åˆ¶ä¸‹é¢å°±åªèƒ½ç»™å¤§å®¶å±•ç¤ºå°å†Œéƒ¨åˆ†å†…å®¹äº†ã€‚æ•´ç†äº†ä¸€ä»½æ ¸å¿ƒé¢è¯•ç¬”è®°åŒ…æ‹¬äº†ï¼šJavaé¢è¯•ã€Springã€JVMã€MyBatisã€Redisã€MySQLã€å¹¶å‘ç¼–ç¨‹ã€å¾®æœåŠ¡ã€Linuxã€Springbootã€SpringCloudã€MQã€Kafka é¢è¯•ä¸“é¢˜</strong></p>
<blockquote>
</blockquote>
<p><strong>éœ€è¦å…¨å¥—é¢è¯•ç¬”è®°åŠç­”æ¡ˆã€æ‰«ä¸€æ‰«ã€‘</strong> Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å³å¯å…è´¹è·å–**</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7017d7585f1048c1bab73d5d714f9e19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeawtOinow==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684857&amp;x-signature=XljKZ4K0nlQ%2FQbxcxmKYAgXkOvk%3D" alt="8fbf1ef8b61e2dbbb33b7690a41d12e.png" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-6"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>5. HashMap çš„åº•å±‚åŸç†ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>JDK 1.7</strong>ï¼šæ•°ç»„ + é“¾è¡¨ï¼ˆå“ˆå¸Œå†²çªæ—¶é“¾è¡¨å­˜å‚¨ï¼‰ã€‚</li>
<li><strong>JDK 1.8+</strong> ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼ˆé“¾è¡¨é•¿åº¦ â‰¥8 æ—¶è½¬çº¢é»‘æ ‘ï¼‰ã€‚</li>
<li><strong>æ‰©å®¹æœºåˆ¶</strong>ï¼šé»˜è®¤å®¹é‡ 16ï¼Œè´Ÿè½½å› å­ 0.75ï¼Œæ‰©å®¹æ—¶å®¹é‡ç¿»å€ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>âš¡ ä¸‰ã€å¤šçº¿ç¨‹ &amp; å¹¶å‘</strong></h3>
<h4 data-id="heading-8"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>6. çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼æœ‰å“ªäº›ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ol>
<li><strong>ç»§æ‰¿ Thread ç±»</strong>ï¼ˆä¸æ¨èï¼Œå•ç»§æ‰¿é™åˆ¶ï¼‰ã€‚</li>
<li><strong>å®ç° Runnable æ¥å£</strong>ï¼ˆæ¨èï¼Œå¯å¤ç”¨ï¼‰ã€‚</li>
<li><strong>å®ç° Callable æ¥å£</strong>ï¼ˆå¯è¿”å›ç»“æœï¼Œé…åˆ FutureTaskï¼‰ã€‚</li>
<li><strong>çº¿ç¨‹æ± ï¼ˆExecutorServiceï¼‰</strong> ï¼ˆæ¨èï¼Œç®¡ç†çº¿ç¨‹èµ„æºï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-9"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>7. synchronized å’Œ ReentrantLock çš„åŒºåˆ«ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>






























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>synchronized</th><th>ReentrantLock</th></tr></thead><tbody><tr><td><strong>å®ç°æ–¹å¼</strong></td><td>JVM å±‚é¢</td><td>Java API å±‚é¢</td></tr><tr><td><strong>é”ç±»å‹</strong></td><td>éå…¬å¹³é”</td><td>å¯å…¬å¹³/éå…¬å¹³</td></tr><tr><td><strong>å¯ä¸­æ–­</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒï¼ˆlockInterruptiblyï¼‰</td></tr><tr><td><strong>æ¡ä»¶å˜é‡</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒï¼ˆConditionï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-10"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ğŸ› ï¸ å››ã€JVM</strong></h3>
<h4 data-id="heading-11"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>8. JVM å†…å­˜æ¨¡å‹ï¼ˆè¿è¡Œæ—¶æ•°æ®åŒºï¼‰ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰</strong> ï¼šå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€‚</li>
<li><strong>å †ï¼ˆHeapï¼‰</strong> ï¼šå­˜æ”¾å¯¹è±¡å®ä¾‹ï¼ˆGC ä¸»è¦åŒºåŸŸï¼‰ã€‚</li>
<li><strong>è™šæ‹Ÿæœºæ ˆ</strong>ï¼šå­˜å‚¨æ–¹æ³•è°ƒç”¨ã€å±€éƒ¨å˜é‡è¡¨ã€‚</li>
<li><strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ï¼šNative æ–¹æ³•è°ƒç”¨ã€‚</li>
<li><strong>ç¨‹åºè®¡æ•°å™¨</strong>ï¼šè®°å½•çº¿ç¨‹æ‰§è¡Œä½ç½®ã€‚</li>
</ul>
<h4 data-id="heading-12"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>9. åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº›ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>æ ‡è®°-æ¸…é™¤</strong>ï¼šç®€å•ä½†å†…å­˜ç¢ç‰‡å¤šã€‚</li>
<li><strong>å¤åˆ¶ç®—æ³•</strong>ï¼šé«˜æ•ˆï¼ˆæ–°ç”Ÿä»£ä½¿ç”¨ï¼‰ï¼Œä½†æµªè´¹ç©ºé—´ã€‚</li>
<li><strong>æ ‡è®°-æ•´ç†</strong>ï¼šé€‚åˆè€å¹´ä»£ï¼Œå‡å°‘ç¢ç‰‡ã€‚</li>
<li><strong>åˆ†ä»£æ”¶é›†</strong>ï¼šæ–°ç”Ÿä»£ï¼ˆå¤åˆ¶ç®—æ³•ï¼‰ + è€å¹´ä»£ï¼ˆæ ‡è®°-æ•´ç†ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ğŸŒ± äº”ã€Spring</strong></h3>
<h4 data-id="heading-14"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>10. Spring Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ol>
<li><strong>å®ä¾‹åŒ–</strong>ï¼ˆnewï¼‰</li>
<li><strong>å±æ€§èµ‹å€¼</strong>ï¼ˆpopulateï¼‰</li>
<li><strong>åˆå§‹åŒ–</strong>ï¼ˆ<code>@PostConstruct</code>ã€<code>InitializingBean</code>ï¼‰</li>
<li><strong>ä½¿ç”¨</strong></li>
<li><strong>é”€æ¯</strong>ï¼ˆ<code>@PreDestroy</code>ã€<code>DisposableBean</code>ï¼‰</li>
</ol>
<blockquote>
<blockquote>
<p><strong>ç¯‡å¹…é™åˆ¶ä¸‹é¢å°±åªèƒ½ç»™å¤§å®¶å±•ç¤ºå°å†Œéƒ¨åˆ†å†…å®¹äº†ã€‚æ•´ç†äº†ä¸€ä»½æ ¸å¿ƒé¢è¯•ç¬”è®°åŒ…æ‹¬äº†ï¼šJavaé¢è¯•ã€Springã€JVMã€MyBatisã€Redisã€MySQLã€å¹¶å‘ç¼–ç¨‹ã€å¾®æœåŠ¡ã€Linuxã€Springbootã€SpringCloudã€MQã€Kafka é¢è¯•ä¸“é¢˜</strong></p>
<blockquote>
</blockquote>
<p><strong>éœ€è¦å…¨å¥—é¢è¯•ç¬”è®°åŠç­”æ¡ˆã€æ‰«ä¸€æ‰«ã€‘</strong> Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å³å¯å…è´¹è·å–**</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7017d7585f1048c1bab73d5d714f9e19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeawtOinow==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767684857&amp;x-signature=XljKZ4K0nlQ%2FQbxcxmKYAgXkOvk%3D" alt="8fbf1ef8b61e2dbbb33b7690a41d12e.png" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-15"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>11. Spring AOP çš„å®ç°åŸç†ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>JDK åŠ¨æ€ä»£ç†</strong>ï¼ˆåŸºäºæ¥å£ï¼‰ã€‚</li>
<li><strong>CGLIB åŠ¨æ€ä»£ç†</strong>ï¼ˆåŸºäºå­ç±»ï¼Œæ— æ¥å£æ—¶ä½¿ç”¨ï¼‰ã€‚</li>
<li>æ ¸å¿ƒï¼š<code>ProxyFactory</code>Â +Â <code>MethodInterceptor</code>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-16"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ğŸ“Š å…­ã€æ•°æ®åº“ &amp; ç¼“å­˜</strong></h3>
<h4 data-id="heading-17"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>12. MySQL ç´¢å¼•å¤±æ•ˆçš„åœºæ™¯ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li>ä½¿ç”¨Â <code>!=</code>ã€<code>&lt;&gt;</code>ã€<code>NOT IN</code>ã€‚</li>
<li>å¯¹ç´¢å¼•åˆ—è¿›è¡Œè¿ç®—ï¼ˆå¦‚Â <code>WHERE age + 1 &gt; 20</code>ï¼‰ã€‚</li>
<li>ä½¿ç”¨Â <code>LIKE '%xx'</code>ï¼ˆå·¦æ¨¡ç³Šï¼‰ã€‚</li>
<li>è”åˆç´¢å¼•æœªéµå¾ªæœ€å·¦å‰ç¼€åŸåˆ™ã€‚</li>
</ul>
<h4 data-id="heading-18"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>13. Redis æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>RDBï¼ˆå¿«ç…§ï¼‰</strong> ï¼šå®šæ—¶å…¨é‡å¤‡ä»½ï¼Œæ¢å¤å¿«ä½†å¯èƒ½ä¸¢æ•°æ®ã€‚</li>
<li><strong>AOFï¼ˆæ—¥å¿—ï¼‰</strong> ï¼šè®°å½•å†™å‘½ä»¤ï¼Œæ•°æ®æ›´å®‰å…¨ä½†æ–‡ä»¶è¾ƒå¤§ã€‚</li>
<li><strong>æ··åˆæ¨¡å¼ï¼ˆRedis 4.0+ï¼‰</strong> ï¼šRDB + AOF ç»“åˆã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-19"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ğŸš€ ä¸ƒã€åˆ†å¸ƒå¼ &amp; å¾®æœåŠ¡</strong></h3>
<h4 data-id="heading-20"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>14. CAP ç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>Cï¼ˆä¸€è‡´æ€§ï¼‰</strong> ï¼šæ‰€æœ‰èŠ‚ç‚¹æ•°æ®ä¸€è‡´ã€‚</li>
<li><strong>Aï¼ˆå¯ç”¨æ€§ï¼‰</strong> ï¼šæ¯æ¬¡è¯·æ±‚éƒ½èƒ½å“åº”ã€‚</li>
<li><strong>Pï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰</strong> ï¼šç½‘ç»œåˆ†åŒºæ—¶ä»èƒ½è¿è¡Œã€‚</li>
<li><strong>ç»“è®º</strong>ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåªèƒ½æ»¡è¶³å…¶ä¸­ä¸¤é¡¹ï¼ˆå¦‚ CPã€APï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-21"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>15. å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Ÿ</strong></h4>
<p>âœ…Â <strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>2PCï¼ˆä¸¤é˜¶æ®µæäº¤ï¼‰</strong> ï¼šåè°ƒè€… + å‚ä¸è€…ï¼Œå¼ºä¸€è‡´ä½†é˜»å¡ã€‚</li>
<li><strong>TCCï¼ˆTry-Confirm-Cancelï¼‰</strong> ï¼šä¸šåŠ¡è¡¥å¿ï¼Œé€‚ç”¨äºé«˜å¹¶å‘ã€‚</li>
<li><strong>SAGA</strong>ï¼šé•¿äº‹åŠ¡æ‹†åˆ† + è¡¥å¿æœºåˆ¶ã€‚</li>
<li><strong>æœ¬åœ°æ¶ˆæ¯è¡¨</strong>ï¼šå¼‚æ­¥ç¡®ä¿æœ€ç»ˆä¸€è‡´ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>