<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ç”¨å‡½æ•°å¼æ¥å£@FunctionalInterfaceå†™å‡ºå¯ç»„åˆçš„éªŒè¯é€»è¾‘ï¼šä» Lambda åˆ°è´£ä»»é“¾]]></title>    <link>https://juejin.cn/post/7598818096729309222</link>    <guid>https://juejin.cn/post/7598818096729309222</guid>    <pubDate>2026-01-24T11:09:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598818096729309222" data-draft-id="7598818096729292838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å‡½æ•°å¼æ¥å£@FunctionalInterfaceå†™å‡ºå¯ç»„åˆçš„éªŒè¯é€»è¾‘ï¼šä» Lambda åˆ°è´£ä»»é“¾"/> <meta itemprop="keywords" content="åç«¯,Java,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-24T11:09:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹æ¸¡è‹‡"/> <meta itemprop="url" content="https://juejin.cn/user/729731453429159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å‡½æ•°å¼æ¥å£@FunctionalInterfaceå†™å‡ºå¯ç»„åˆçš„éªŒè¯é€»è¾‘ï¼šä» Lambda åˆ°è´£ä»»é“¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731453429159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹æ¸¡è‹‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T11:09:19.000Z" title="Sat Jan 24 2026 11:09:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>ä¸€å¥è¯æ€»ç»“</strong>ï¼šå½“ä½ å¼€å§‹ç”¨æ¥å£æ¥â€œæè¿°è¡Œä¸ºâ€è€Œä¸æ˜¯â€œå®šä¹‰ç±»â€æ—¶ï¼Œä½ å°±çœŸæ­£ç†è§£äº†å‡½æ•°å¼ç¼–ç¨‹åœ¨ Java ä¸­çš„æ„ä¹‰ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€é—®é¢˜å¼•å…¥ï¼šä¸ºä»€ä¹ˆæˆ‘çš„éªŒè¯è§„åˆ™è¦å†™æˆä¸€ä¸ªç±»ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ã€‚ä½ éœ€è¦éªŒè¯ç”¨æˆ·åä¸èƒ½æ˜¯ç©ºç™½ã€é•¿åº¦è¦åœ¨4-20ä¹‹é—´ã€è¿˜è¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼â€¦â€¦</p>
<p>ä¼ ç»Ÿåšæ³•å¯èƒ½æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (username == <span class="hljs-literal">null</span> || username.trim().isEmpty()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>);
}
<span class="hljs-keyword">if</span> (username.length() &lt; <span class="hljs-number">4</span> || username.length() &gt; <span class="hljs-number">20</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ç”¨æˆ·åé•¿åº¦åº”åœ¨4-20ä¹‹é—´"</span>);
}
<span class="hljs-keyword">if</span> (!Pattern.matches(<span class="hljs-string">"[a-zA-Z0-9_]+"</span>, username)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿"</span>);
}
</code></pre>
<p>æ˜¯ä¸æ˜¯çœ‹ç€å°±å¤´å¤§ï¼Ÿæ›´åˆ«è¯´ä»¥åè¦åŠ æ–°è§„åˆ™äº†â€”â€”æ¯æ¬¡éƒ½è¦å¤åˆ¶ç²˜è´´ä¸€å † if-elseã€‚</p>
<p>äºæ˜¯ï¼Œèªæ˜çš„ä½ å¯èƒ½ä¼šæƒ³åˆ°ï¼š<strong>èƒ½ä¸èƒ½æŠŠæ¯ä¸ªéªŒè¯é€»è¾‘å°è£…æˆä¸€ä¸ªâ€œå¯å¤ç”¨çš„å°å•å…ƒâ€ï¼Ÿ</strong></p>
<p>è¿™æ—¶å€™ï¼Œä½ å¯èƒ½å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NotBlankRule</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidationRule</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(String value)</span> { ... }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getErrorMessage</span><span class="hljs-params">()</span> { ... }
}
</code></pre>
<p>ä½†ç­‰ç­‰â€¦â€¦ä¸ºäº†ä¸€ä¸ªå°å°çš„éªŒè¯é€»è¾‘ï¼Œå°±è¦æ–°å»ºä¸€ä¸ª <code>.java</code> æ–‡ä»¶ï¼Ÿè¿™ä¸å°±æ˜¯â€œä¸ºäº†å°è£…è€Œå°è£…â€å—ï¼Ÿ</p>
<p><strong>æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼ï¼Œèƒ½è®©æˆ‘åƒä¼ é€’å‚æ•°ä¸€æ ·ï¼Œä¼ é€’ä¸€æ®µâ€œéªŒè¯é€»è¾‘â€ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>æœ‰ï¼è€Œä¸” Java 8 å°±ç»™äº†æˆ‘ä»¬è¿™ä¸ªèƒ½åŠ› â€”â€” å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰</strong>ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»€ä¹ˆæ˜¯ @FunctionalInterfaceï¼Ÿ</h2>
<p>ç®€å•è¯´ï¼Œ<strong>å‡½æ•°å¼æ¥å£å°±æ˜¯ä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£</strong>ã€‚Java 8 å¼•å…¥äº† <code>@FunctionalInterface</code> æ³¨è§£æ¥æ˜ç¡®æ ‡è¯†è¿™ä¸€ç‚¹ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ValidationRule</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(String value)</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•ä¸ç®—æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> String <span class="hljs-title function_">getErrorMessage</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Validation failed"</span>;
    }
}
</code></pre>
<p>è¿™ä¸ªæ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• <code>validate</code>ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p>
<p>è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ <strong>Lambda è¡¨è¾¾å¼</strong> æ¥å®ç°å®ƒï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ValidationRule</span> <span class="hljs-variable">notBlank</span> <span class="hljs-operator">=</span> value -&gt; value != <span class="hljs-literal">null</span> &amp;&amp; !value.trim().isEmpty();
</code></pre>
<p>çœ‹ï¼<strong>ä¸€è¡Œä»£ç ï¼Œå°±å®šä¹‰äº†ä¸€ä¸ªå®Œæ•´çš„éªŒè¯è§„åˆ™</strong>ã€‚ä¸éœ€è¦æ–°å»ºç±»ï¼Œä¸éœ€è¦ç»§æ‰¿ï¼Œå¹²å‡€åˆ©è½ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€StringButler å®æˆ˜ï¼šå‡½æ•°å¼æ¥å£å¦‚ä½•æ”¹å˜ API è®¾è®¡ï¼Ÿ</h2>
<p>åœ¨ StringButler ä¸­ï¼Œå‡½æ•°å¼æ¥å£çš„åŠ›é‡é¦–å…ˆä½“ç°åœ¨å…¶<strong>å†…éƒ¨æ¶æ„çš„ä¼˜é›…æ€§</strong>ä¸Šã€‚</p>
<p>æ¥ï¼Œçœ‹çœ‹ä¸¤ä¸ªæ ¸å¿ƒæ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// éªŒè¯è§„åˆ™</span>
<span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ValidationRule</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(String value)</span>;
    <span class="hljs-keyword">default</span> String <span class="hljs-title function_">getErrorMessage</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"Validation failed"</span>; }
}

<span class="hljs-comment">// è½¬æ¢è§„åˆ™</span>
<span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TransformationRule</span> {
    String <span class="hljs-title function_">transform</span><span class="hljs-params">(String value)</span>;
}
</code></pre>
<p>æ‰€æœ‰çš„å†…ç½®åŠŸèƒ½ï¼Œå¦‚é‚®ç®±éªŒè¯ã€é•¿åº¦æ£€æŸ¥ã€å¤§å°å†™è½¬æ¢ã€å­—ç¬¦ä¸²æ›¿æ¢ç­‰ï¼Œéƒ½æ˜¯è¿™ä¸¤ä¸ªæ¥å£çš„å…·ä½“å®ç°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ <code>AdvancedValidationTest.java</code> ä¸­ï¼Œå¯¹é‚®ç®±éªŒè¯çš„æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-java" lang="java">assertTrue(StringButler.of(<span class="hljs-string">"test@example.com"</span>)
    .validate()
    .email() <span class="hljs-comment">// â† è¿™ä¸ªæ–¹æ³•å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ª EmailRule å®ä¾‹</span>
    .validate()
    .isValid());
</code></pre>
<p>è€Œ <code>EmailRule</code> çš„å®ç°ç®€æ´æ˜äº†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailRule</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidationRule</span> {
    <span class="hljs-comment">// ... </span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(String value)</span> {
        <span class="hljs-comment">// æ ¸å¿ƒéªŒè¯é€»è¾‘</span>
        <span class="hljs-keyword">return</span> EMAIL_PATTERN.matcher(value.trim()).matches();
    }
}
</code></pre>
<p><strong>è¿™ç§è®¾è®¡å¸¦æ¥äº†å·¨å¤§çš„å¥½å¤„</strong>ï¼š</p>
<ul>
<li><strong>æ–°å¢åŠŸèƒ½æˆæœ¬æä½</strong>ï¼šæƒ³åŠ ä¸€ä¸ª URL éªŒè¯ï¼Ÿå†™ä¸€ä¸ª <code>UrlRule implements ValidationRule</code> å³å¯ã€‚</li>
<li><strong>é€»è¾‘é«˜åº¦è§£è€¦</strong>ï¼šéªŒè¯é€»è¾‘ã€è½¬æ¢é€»è¾‘ã€é“¾å¼è°ƒç”¨å™¨ (<code>ValidationChain</code>) å½¼æ­¤ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ã€‚</li>
<li><strong>å¤©ç„¶æ”¯æŒç»„åˆ</strong>ï¼šè´£ä»»é“¾æ¨¡å¼ (<code>ValidationChain</code>) å¯ä»¥è½»æ¾åœ°å°†ä»»æ„æ•°é‡çš„ <code>ValidationRule</code> ç»„åˆåœ¨ä¸€èµ·æ‰§è¡Œã€‚</li>
</ul>
<h2 data-id="heading-3">å››ã€å‡½æ•°å¼æ¥å£å¦‚ä½•èå…¥è´£ä»»é“¾ï¼Ÿ</h2>
<p>æ¥çœ‹ä¸€ä¸‹ StringButler çš„éªŒè¯é“¾æ¶æ„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efa1c6164b6b4e4781646d3d6109cc93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769857759&amp;x-signature=jH62QnrX048umFFpyRhiyDQkeYc%3D" alt="" loading="lazy"/></p>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>ValidationChain</code> å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª <code>List&lt;ValidationRule&gt;</code></li>
<li>æ¯æ¬¡è°ƒç”¨ <code>.notBlank()</code>ã€<code>.lengthBetween()</code> ç­‰æ–¹æ³•ï¼Œéƒ½æ˜¯å¾€åˆ—è¡¨é‡Œæ·»åŠ ä¸€ä¸ªå®ç°äº† <code>ValidationRule</code> çš„å¯¹è±¡</li>
<li>æœ€ç»ˆæ‰§è¡Œæ—¶ï¼Œéå†åˆ—è¡¨ï¼Œé€ä¸ªè°ƒç”¨ <code>rule.validate(value)</code></li>
</ul>
<p>è€Œå› ä¸º <code>ValidationRule</code> æ˜¯å‡½æ•°å¼æ¥å£ï¼Œ<strong>ä½ æ—¢å¯ä»¥ä¼ å…¥é¢„å®šä¹‰çš„è§„åˆ™ç±»ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ Lambda è¡¨è¾¾å¼</strong>ï¼</p>
<h2 data-id="heading-4">äº”ã€ä¼˜ç§€æ¡†æ¶ä¸­çš„å‡½æ•°å¼è®¾è®¡</h2>
<h3 data-id="heading-5">1. Spring Framework</h3>
<p>Spring çš„ <code>Predicate&lt;T&gt;</code>ã€<code>Function&lt;T, R&gt;</code> è¢«å¹¿æ³›ç”¨äº WebFluxã€Stream å¤„ç†ä¸­ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FunctionalWebConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="hljs-title function_">routerFunction</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®šä¹‰å¤„ç†å‡½æ•° (Handler Function)</span>
        <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å‡½æ•°ï¼šæ¥å—ServerRequestï¼Œè¿”å›Mono&lt;ServerResponse&gt;</span>
        <span class="hljs-comment">// å®ƒåº”è¯¥æ˜¯æ— å‰¯ä½œç”¨çš„ï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼‰</span>
        Mono&lt;ServerResponse&gt; <span class="hljs-title function_">helloHandler</span><span class="hljs-params">(ServerRequest request)</span> {
            <span class="hljs-keyword">return</span> ServerResponse.ok().bodyValue(<span class="hljs-string">"Hello, "</span> + request.queryParam(<span class="hljs-string">"name"</span>).orElse(<span class="hljs-string">"World"</span>));
        }

        <span class="hljs-comment">// å®šä¹‰è·¯ç”±è§„åˆ™</span>
        <span class="hljs-comment">// RouterFunctions.route æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªè°“è¯ï¼ˆPredicateï¼‰å’Œä¸€ä¸ªå¤„ç†å‡½æ•°</span>
        <span class="hljs-comment">// è¿”å›ä¸€ä¸ªRouterFunction</span>
        <span class="hljs-keyword">return</span> route(GET(<span class="hljs-string">"/hello"</span>), <span class="hljs-built_in">this</span>::helloHandler) <span class="hljs-comment">// ä½¿ç”¨æ–¹æ³•å¼•ç”¨</span>
               .andRoute(GET(<span class="hljs-string">"/greeting/{id}"</span>), <span class="hljs-built_in">this</span>::getGreetingById);
    }

    <span class="hljs-keyword">private</span> Mono&lt;ServerResponse&gt; <span class="hljs-title function_">getGreetingById</span><span class="hljs-params">(ServerRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> request.pathVariable(<span class="hljs-string">"id"</span>);
        <span class="hljs-comment">// æ¨¡æ‹Ÿä»æ•°æ®åº“æˆ–å…¶ä»–æœåŠ¡è·å–æ•°æ®</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">greeting</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Greeting for ID: "</span> + id;
        <span class="hljs-keyword">return</span> ServerResponse.ok().bodyValue(greeting);
    }
}
</code></pre>
<p>é€šè¿‡ç»„åˆ<code>route</code>å‡½æ•°ï¼Œå£°æ˜äº†â€œå½“æ”¶åˆ°GET /helloè¯·æ±‚æ—¶ï¼Œç”¨<code>helloHandler</code>å‡½æ•°å¤„ç†â€è¿™æ ·çš„è§„åˆ™ã€‚ä»£ç éå¸¸æ¸…æ™°ï¼Œå…³æ³¨ç‚¹åœ¨äºâ€œè·¯ç”±è§„åˆ™æ˜¯ä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œå¦‚ä½•å®ç°è·¯ç”±åŒ¹é…çš„é€»è¾‘â€ã€‚</p>
<h3 data-id="heading-6">2. Guavaï¼šå‡½æ•°å¼å·¥å…·åº“çš„å…¸èŒƒ</h3>
<p>Guavaæ˜¯Googleå¼€æºçš„Javaæ ¸å¿ƒåº“ï¼Œå…¶ä¸­<code>com.google.common.base.Function</code>æ¥å£ï¼ˆåœ¨Java 8ä¹‹å‰ï¼‰å’Œå¤§é‡å·¥å…·ç±»éƒ½ä½“ç°äº†å‡½æ•°å¼æ€æƒ³ã€‚è™½ç„¶Java 8ä¹‹å<code>java.util.function</code>æˆä¸ºäº†æ ‡å‡†ï¼Œä½†Guavaçš„è®¾è®¡ç†å¿µä¾ç„¶æå…·å‚è€ƒä»·å€¼ã€‚</p>
<p>ç¤ºä¾‹1ï¼š<code>Functions</code>å·¥å…·ç±»ä¸å‡½æ•°ç»„åˆ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.google.common.base.Function;
<span class="hljs-keyword">import</span> com.google.common.base.Functions;

<span class="hljs-comment">// å®šä¹‰ä¸¤ä¸ªç®€å•çš„Function</span>
<span class="hljs-comment">// 1. å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™</span>
Function&lt;String, String&gt; toUpperCase = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>&lt;String, String&gt;() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">apply</span><span class="hljs-params">(String input)</span> {
        <span class="hljs-keyword">return</span> input.toUpperCase();
    }
};

<span class="hljs-comment">// 2. è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</span>
Function&lt;String, Integer&gt; getLength = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>&lt;String, Integer&gt;() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">apply</span><span class="hljs-params">(String input)</span> {
        <span class="hljs-keyword">return</span> input.length();
    }
};

<span class="hljs-comment">// ä½¿ç”¨Functions.composeè¿›è¡Œå‡½æ•°ç»„åˆ</span>
<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„Function: å…ˆæ‰§è¡ŒgetLengthï¼Œå†å¯¹ç»“æœæ‰§è¡ŒtoUpperCase</span>
<span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å‡è®¾getLengthè¿”å›çš„æ˜¯Stringï¼ˆå®é™…æ˜¯Integerï¼‰ï¼Œè¿™é‡Œç”¨äº†ä¸€ä¸ªè½¬æ¢</span>
<span class="hljs-comment">// å®é™…ä¸Šï¼Œcomposeè¦æ±‚gçš„è¾“å‡ºæ˜¯fçš„è¾“å…¥ç±»å‹</span>
Function&lt;String, String&gt; composedFunction = 
    Functions.compose(toUpperCase, getLength.andThen(Object::toString)); <span class="hljs-comment">// è¿™é‡Œç”¨andThené€‚åº”ç±»å‹</span>

<span class="hljs-comment">// åº”ç”¨ç»„åˆå‡½æ•°</span>
<span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> composedFunction.apply(<span class="hljs-string">"hello world"</span>);
System.out.println(result); <span class="hljs-comment">// è¾“å‡º: "11" (å…ˆæ±‚é•¿åº¦11ï¼Œå†è½¬æˆå­—ç¬¦ä¸²"11"ï¼Œç„¶åè½¬æˆå¤§å†™"11")</span>
</code></pre>
<ul>
<li><strong>å‡½æ•°ç»„åˆ</strong>ï¼šè¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€ã€‚é€šè¿‡ç»„åˆç®€å•çš„çº¯å‡½æ•°ï¼Œå¯ä»¥æ„å»ºå‡ºå¤æ‚çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€ç¼–å†™å†—é•¿çš„è¿‡ç¨‹å¼ä»£ç ã€‚</li>
<li><strong>å£°æ˜å¼ç¼–ç¨‹</strong>ï¼šé€šè¿‡å£°æ˜â€œå…ˆæ±‚é•¿åº¦ï¼Œå†è½¬å¤§å†™â€çš„ç»„åˆå…³ç³»æ¥å®šä¹‰é€»è¾‘ï¼Œè€Œä¸æ˜¯ä¸€æ­¥æ­¥å†™å‡ºå¦‚ä½•éå†å­—ç¬¦ä¸²ã€è®¡ç®—é•¿åº¦ã€å†è½¬æ¢å¤§å°å†™çš„æŒ‡ä»¤ã€‚</li>
</ul>
<p>ç¤ºä¾‹2ï¼š<strong><code>Optional</code>ç±»çš„å‡½æ•°å¼ä½¿ç”¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.google.common.base.Optional;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptionalExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        Optional&lt;String&gt; maybeName = Optional.of(<span class="hljs-string">"Alice"</span>);
        
        <span class="hljs-comment">// å‡½æ•°å¼åœ°å¤„ç†Optionalå€¼</span>
        <span class="hljs-comment">// transformæ–¹æ³•æ¥å—ä¸€ä¸ªFunctionï¼Œå¯¹Optionalä¸­çš„å€¼è¿›è¡Œè½¬æ¢</span>
        Optional&lt;Integer&gt; nameLength = maybeName.transform(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>&lt;String, Integer&gt;() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">apply</span><span class="hljs-params">(String input)</span> {
                <span class="hljs-keyword">return</span> input.length();
            }
        });
        
        <span class="hljs-comment">// å¦‚æœå€¼å­˜åœ¨ï¼Œæ‰“å°é•¿åº¦</span>
        <span class="hljs-keyword">if</span> (nameLength.isPresent()) {
            System.out.println(nameLength.get()); <span class="hljs-comment">// è¾“å‡º: 5</span>
        }
        
        <span class="hljs-comment">// æ›´å‡½æ•°å¼çš„å†™æ³•ï¼šä½¿ç”¨or/ orNull</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> maybeName.transform(String::toUpperCase).or(<span class="hljs-string">"DEFAULT"</span>);
        System.out.println(result); <span class="hljs-comment">// è¾“å‡º: ALICE</span>
    }
}
</code></pre>
<p>Optional.transformæ–¹æ³•æ¥å—ä¸€ä¸ªFunctionä½œä¸ºå‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£çš„åº”ç”¨ã€‚</p>
<p><strong>é¿å…å‰¯ä½œç”¨</strong>ï¼š<code>Optional</code>é¼“åŠ±ä»¥æ— å‰¯ä½œç”¨çš„æ–¹å¼å¤„ç†å¯èƒ½ç¼ºå¤±çš„æƒ…å†µï¼Œè€Œä¸æ˜¯é€šè¿‡<code>if (obj != null)</code>è¿™ç§å‘½ä»¤å¼æ£€æŸ¥ï¼Œåè€…å®¹æ˜“é—æ¼æˆ–äº§ç”Ÿå‰¯ä½œç”¨ã€‚</p>
<p><strong>é“¾å¼è°ƒç”¨</strong>ï¼š<code>transform</code>çš„è¿”å›å€¼ä»æ˜¯<code>Optional</code>ï¼Œè¿™ä½¿å¾—å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨ï¼Œå½¢æˆæµç•…çš„APIï¼Œéå¸¸ç¬¦åˆå‡½æ•°å¼é£æ ¼ã€‚</p>
<h2 data-id="heading-7">å…­ã€æ³¨æ„ï¼šåˆ«æ»¥ç”¨ Lambdaï¼</h2>
<p>å‡½æ•°å¼æ¥å£è™½å¥½ï¼Œä½†ä¹Ÿæœ‰å‘ï¼š</p>
<h3 data-id="heading-8">è¯¯åŒº1ï¼šæ•è·å¤–éƒ¨å¯å˜çŠ¶æ€</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ å±é™©çš„Lambdaï¼šæ•è·å¯å˜çŠ¶æ€</span>
List&lt;String&gt; results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
List&lt;String&gt; inputs = Arrays.asList(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>);

inputs.stream()
    .map(input -&gt; {
        results.add(input.toUpperCase()); <span class="hljs-comment">// ä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼</span>
        <span class="hljs-keyword">return</span> input.length();
    })
    .count();

<span class="hljs-comment">// âœ… å‡½æ•°å¼åšæ³•ï¼šæ— å‰¯ä½œç”¨</span>
List&lt;String&gt; results = inputs.stream()
    .map(String::toUpperCase)
    .collect(Collectors.toList()); <span class="hljs-comment">// æ˜¾å¼æ”¶é›†ç»“æœ</span>
</code></pre>
<h3 data-id="heading-9">è¯¯åŒº2ï¼šæŠŠå¤æ‚é€»è¾‘å¡è¿› Lambda</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Bad! Lambda ä¸æ˜¯ä¸‡èƒ½èƒ¶æ°´</span>
value -&gt; {
    <span class="hljs-comment">// 20è¡Œä¸šåŠ¡é€»è¾‘...</span>
}
</code></pre>
<p><strong>å»ºè®®</strong>ï¼šå¤æ‚é€»è¾‘ä»åº”å°è£…æˆå‘½åç±»ï¼Œä¿æŒå¯è¯»æ€§å’Œå¯æµ‹è¯•æ€§ã€‚</p>
<h3 data-id="heading-10">è¯¯åŒº3ï¼šè¿‡åº¦ç®€æ´ï¼Œä¸§å¤±å¯è¯»æ€§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿‡äº"èªæ˜"çš„å†™æ³•</span>
Function&lt;String, Function&lt;String, Function&lt;String, String&gt;&gt;&gt; 
    tripleReplace = s1 -&gt; s2 -&gt; s3 -&gt; s -&gt; s.replace(s1, s2).replace(s3, <span class="hljs-string">""</span>);

<span class="hljs-comment">// StringButlerçš„åšæ³•ï¼šæ¸…æ™°çš„é“¾å¼è°ƒç”¨</span>
StringButler.of(str)
    .transform()
    .replace(<span class="hljs-string">"old1"</span>, <span class="hljs-string">"new1"</span>)
    .replace(<span class="hljs-string">"old2"</span>, <span class="hljs-string">"new2"</span>)
    .replace(<span class="hljs-string">"old3"</span>, <span class="hljs-string">"new3"</span>)
    .transform();
</code></pre>
<h3 data-id="heading-11">è¯¯åŒº4ï¼šå¼‚å¸¸å¤„ç†é»‘æ´</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ Lambdaä¸­çš„å¼‚å¸¸è¢«åæ²¡äº†</span>
list.stream()
    .map(str -&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> Integer.parseInt(str);
        } <span class="hljs-keyword">catch</span> (NumberFormatException e) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// é™é»˜å¤„ç†å¼‚å¸¸</span>
        }
    });

<span class="hljs-comment">// âœ… StringButlerçš„éªŒè¯é“¾ï¼šæ˜¾å¼çš„é”™è¯¯æ”¶é›†</span>
StringButler.of(input)
    .validate()
    .numeric(<span class="hljs-literal">false</span>, <span class="hljs-string">"å¿…é¡»ä¸ºæ•´æ•°"</span>) <span class="hljs-comment">// éªŒè¯å¤±è´¥ä¼šè®°å½•é”™è¯¯</span>
    .validate();
    
<span class="hljs-keyword">if</span> (!butler.isValid()) {
    <span class="hljs-type">String</span> <span class="hljs-variable">errors</span> <span class="hljs-operator">=</span> butler.getValidationErrors(); <span class="hljs-comment">// è·å–æ‰€æœ‰é”™è¯¯</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValidationException</span>(errors);
}
</code></pre>
<h3 data-id="heading-12">æ­£ç¡®å§¿åŠ¿ï¼šå‡½æ•°å¼æ¥å£çš„â€œä¸‰è¦ç´ â€</h3>
<ol>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šä¸€ä¸ªæ¥å£åªåšä¸€ä»¶äº‹ï¼ˆå¦‚éªŒè¯ or è½¬æ¢ï¼‰</li>
<li><strong>æ— å‰¯ä½œç”¨</strong>ï¼š<code>validate()</code> ä¸åº”è¯¥ä¿®æ”¹å¤–éƒ¨çŠ¶æ€</li>
<li><strong>å¯ç»„åˆ</strong>ï¼šå¤šä¸ªè§„åˆ™å¯ä»¥ä¸²è”æ‰§è¡Œï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰</li>
</ol>
<h2 data-id="heading-13">ä¸ƒã€å®æˆ˜æŠ€å·§ï¼šä½•æ—¶è¯¥ç”¨@FunctionalInterfaceï¼Ÿ</h2>
<h3 data-id="heading-14">åœºæ™¯1ï¼šç­–ç•¥æ¨¡å¼ï¼ˆé¦–é€‰åœºæ™¯ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// StringButlerä¸­çš„BlankStrategyå¤„ç†</span>
<span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">ifBlank</span><span class="hljs-params">(String defaultValue, BlankStrategy strategy)</span> {
    <span class="hljs-keyword">if</span> (isBlank(currentValue)) {
        <span class="hljs-keyword">switch</span> (strategy) {
            <span class="hljs-keyword">case</span> USE_DEFAULT: <span class="hljs-built_in">this</span>.currentValue = defaultValue; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> THROW_EXCEPTION: <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(...);
            <span class="hljs-comment">// ...</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
}

<span class="hljs-comment">// ğŸš€ å¯ä»¥æ”¹é€ æˆå‡½æ•°å¼ç‰ˆæœ¬ï¼</span>
<span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BlankHandler</span> {
    String <span class="hljs-title function_">handle</span><span class="hljs-params">(String originalValue)</span>;
}

<span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">ifBlank</span><span class="hljs-params">(BlankHandler handler)</span> {
    <span class="hljs-keyword">if</span> (isBlank(currentValue)) {
        <span class="hljs-built_in">this</span>.currentValue = handler.handle(currentValue);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
}

<span class="hljs-comment">// ä½¿ç”¨æ›´çµæ´»ï¼</span>
StringButler.of(maybeBlank)
    .ifBlank(original -&gt; <span class="hljs-string">"default"</span>)  <span class="hljs-comment">// Lambdaè¡¨è¾¾å¼</span>
    .ifBlank(String::toUpperCase)    <span class="hljs-comment">// æ–¹æ³•å¼•ç”¨</span>
    .ifBlank(<span class="hljs-built_in">this</span>::customHandler);   <span class="hljs-comment">// å®ä¾‹æ–¹æ³•å¼•ç”¨</span>
</code></pre>
<h3 data-id="heading-15">åœºæ™¯2ï¼šå›è°ƒæœºåˆ¶</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// PatternCacheä¸­çš„ç¼“å­˜æœºåˆ¶ï¼ˆå®é™…ä»£ç ç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PatternCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, Pattern&gt; CACHE = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">// å¦‚æœéœ€è¦è‡ªå®šä¹‰ç¼“å­˜é€»è¾‘ï¼Œå¯ä»¥ä¼ å…¥å‡½æ•°å¼æ¥å£</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Pattern <span class="hljs-title function_">getPattern</span><span class="hljs-params">(String regex, 
                                     Function&lt;String, Pattern&gt; compiler)</span> {
        <span class="hljs-keyword">return</span> CACHE.computeIfAbsent(regex, compiler);
    }
}
</code></pre>
<h3 data-id="heading-16">åœºæ™¯3ï¼šæ¡ä»¶æ‰§è¡Œ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœ¨ValidationChainä¸­çš„å®é™…åº”ç”¨</span>
<span class="hljs-keyword">public</span> ValidationChain <span class="hljs-title function_">stopOnFirstFailure</span><span class="hljs-params">(<span class="hljs-type">boolean</span> stopOnFirstFailure)</span> {
    <span class="hljs-built_in">this</span>.stopOnFirstFailure = stopOnFirstFailure;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
}

<span class="hljs-comment">// ğŸš€ å¯ä»¥æ‰©å±•ä¸ºæ›´çµæ´»çš„æ¡ä»¶æ§åˆ¶</span>
<span class="hljs-keyword">public</span> ValidationChain <span class="hljs-title function_">validateIf</span><span class="hljs-params">(Predicate&lt;String&gt; condition, 
                                  ValidationRule rule)</span> {
    <span class="hljs-keyword">if</span> (condition.test(currentValue)) {
        addRule(rule);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
StringButler.of(input)
    .validate()
    .validateIf(str -&gt; str.length() &gt; <span class="hljs-number">10</span>, 
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthRule</span>(<span class="hljs-number">5</span>, <span class="hljs-number">20</span>))  <span class="hljs-comment">// åªæœ‰é•¿åº¦&gt;10æ—¶æ‰éªŒè¯5-20</span>
    .validate();
</code></pre>
<h2 data-id="heading-17">å…«ã€ä»â€œé¢å‘å¯¹è±¡â€åˆ°â€œé¢å‘è¡Œä¸ºâ€</h2>
<p>ä¼ ç»Ÿ OOP å¼ºè°ƒâ€œ<strong>æ˜¯ä»€ä¹ˆ</strong>â€ï¼ˆis-aï¼‰ï¼Œè€Œå‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒâ€œ<strong>åšä»€ä¹ˆ</strong>â€ï¼ˆdoes-aï¼‰ã€‚</p>
<ul>
<li><code>NotBlankRule</code> æ˜¯ä¸€ä¸ªç±» â†’ å®ƒâ€œæ˜¯ä¸€ä¸ªâ€éç©ºéªŒè¯å™¨</li>
<li><code>value -&gt; value != null</code> æ˜¯ä¸€ä¸ªè¡Œä¸º â†’ å®ƒâ€œåšâ€çš„æ˜¯éç©ºåˆ¤æ–­</li>
</ul>
<p><strong>StringButler çš„è®¾è®¡å“²å­¦æ˜¯ï¼šä¼˜å…ˆæš´éœ²â€œè¡Œä¸ºâ€ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶ç”¨æˆ·ç»§æ‰¿ç±»ã€‚</strong></p>
<p>è¿™æ­£æ˜¯ç°ä»£ API è®¾è®¡çš„è¶‹åŠ¿ï¼š<strong>çµæ´»ã€è½»é‡ã€ç»„åˆä¼˜äºç»§æ‰¿</strong>ã€‚</p>
<h2 data-id="heading-18">ä¹ã€ç»“è¯­</h2>
<p>é€šè¿‡ <code>@FunctionalInterface</code>ï¼ŒStringButler å®ç°äº† <strong>é«˜å†…èšã€ä½è€¦åˆã€æ˜“æ‰©å±•</strong> çš„å­—ç¬¦ä¸²å¤„ç†å¼•æ“ã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªå·¥å…·åº“ï¼Œæ›´æ˜¯ä¸€å¥—<strong>è®¾è®¡æ€æƒ³çš„å®è·µ</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-19">å¦‚æœä½ å–œæ¬¢è¿™ç§â€œä»ä»£ç çœ‹è®¾è®¡â€çš„é£æ ¼ï¼š</h3>
<ul>
<li><strong>GitHub é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiweidujiang%2Fstring-butler" target="_blank" title="https://github.com/iweidujiang/string-butler" ref="nofollow noopener noreferrer">github.com/iweidujiangâ€¦</a></li>
<li><strong>å…³æ³¨å…¬ä¼—å·ã€è‹æ¸¡è‹‡ã€‘</strong>ï¼šè·å–æœ€æ–°æŠ€æœ¯åšæ–‡ã€æºç è§£è¯»ã€è®¾è®¡æ¨¡å¼å®æˆ˜</li>
<li><strong>Star é¡¹ç›®</strong>ï¼šä½ çš„æ”¯æŒæ˜¯æˆ‘çš„åŠ¨åŠ›ï¼</li>
</ul>
<hr/>
<p><em>æœ¬æ–‡æ˜¯ã€ŠStringButlerè®¾è®¡å“²å­¦ä¸å®æˆ˜ã€‹ç³»åˆ—çš„ç¬¬äºŒç¯‡ã€‚</em></p>
<p><em>å¦‚æœä½ å¯¹è¿™ä¸ªç³»åˆ—æ„Ÿå…´è¶£ï¼Œè®°å¾—å…³æ³¨æˆ‘çš„åšå®¢æ›´æ–°å“¦ï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»Mybatisæºç å­¦ä¼šäº†ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7598477092197220390</link>    <guid>https://juejin.cn/post/7598477092197220390</guid>    <pubDate>2026-01-24T11:24:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598477092197220390" data-draft-id="7598818096729325606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»Mybatisæºç å­¦ä¼šäº†ä»€ä¹ˆ"/> <meta itemprop="keywords" content="MyBatis,æºç é˜…è¯»,Java"/> <meta itemprop="datePublished" content="2026-01-24T11:24:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜ä¾ å®¢è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/556801719828361"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»Mybatisæºç å­¦ä¼šäº†ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/556801719828361/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜ä¾ å®¢è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T11:24:46.000Z" title="Sat Jan 24 2026 11:24:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ‘˜è¦ï¼šMyBatisæºç å±•ç°äº†ä¼˜ç§€çš„è®¾è®¡æ¨¡å¼å’Œæ¶æ„æ€æƒ³ã€‚å…¶è¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¤æ‚å¯¹è±¡ï¼ŒåŠ¨æ€ä»£ç†å®ç°Mapperæ¥å£ï¼Œè£…é¥°å™¨åŠ¨æ€æ‰©å±•åŠŸèƒ½ç­‰ã€‚æ¶æ„ä¸Šé‡‡ç”¨æ¸…æ™°åˆ†å±‚è®¾è®¡ï¼Œæ’ä»¶åŒ–æ‰©å±•æœºåˆ¶å®ç°å¼€é—­åŸåˆ™ï¼Œå¤šçº§ç¼“å­˜æå‡æ€§èƒ½ï¼Œé¢å‘æ¥å£ç¼–ç¨‹é™ä½è€¦åˆã€‚è¿™äº›è®¾è®¡ç†å¿µå¯¹æ—¥å¸¸ä¸šåŠ¡å¼€å‘ä¹Ÿæœ‰å¾ˆå¤§å€Ÿé‰´ä»·å€¼ã€‚</p>
</blockquote>
<p>é€šè¿‡ä»¥ä¸‹ç³»åˆ—åšæ–‡ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰äº†Mybatisæºç å®ç°çš„è¯¸å¤šç»†èŠ‚ï¼Œå¦‚Executoræ¥å£åŠå…¶å®ç°ã€ç¼“å­˜ä½“ç³»ã€è‡ªå®šä¹‰æ’ä»¶ç­‰ã€‚</p>
<ol>
<li>Mybatiså…¥é—¨åˆ°ç²¾é€š ä¸€</li>
<li>Mybatisçš„Executorå’Œç¼“å­˜ä½“ç³»</li>
<li>MybatisäºŒçº§ç¼“å­˜å®ç°è¯¦è§£</li>
<li>Mybatisæ‰§è¡ŒMapperè¿‡ç¨‹è¯¦è§£</li>
<li>Mybatisæ’ä»¶åŸç†åŠåˆ†é¡µæ’ä»¶</li>
<li>Springé›†æˆMybatisåŸç†è¯¦è§£</li>
</ol>
<p>è¿™æ¬¡ï¼Œè®©æˆ‘ä»¬è·³å‡ºå±€éƒ¨ï¼Œçœ‹çœ‹Mybatisåœ¨è®¾è®¡å’Œæ¶æ„ä¸Šï¼Œæœ‰å“ªäº›å€¼å¾—æˆ‘ä»¬å­¦ä¹ çš„åœ°æ–¹ã€‚</p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡ä¸­æºç æ¥è‡ªmybatis 3.4.xç‰ˆæœ¬ï¼Œåœ°å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmybatis%2Fmybatis-3.git" target="_blank" title="https://github.com/mybatis/mybatis-3.git" ref="nofollow noopener noreferrer">github.com/mybatis/mybâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ è®¾è®¡æ¨¡å¼</h2>
<h3 data-id="heading-1">1.1 å»ºé€ è€…æ¨¡å¼</h3>
<p>MyBatis å¤§é‡ä½¿ç”¨å»ºé€ è€…æ¨¡å¼è§£å†³ã€Œå¤æ‚å¯¹è±¡åˆå§‹åŒ–ã€é—®é¢˜ï¼Œæ¯”å¦‚ <code>SqlSessionFactoryBuilder</code>ã€<code>XMLConfigBuilder</code>ã€<code>MapperBuilderAssistant</code> ç­‰ã€‚</p>
<p>ä»¥<code>SqlSessionFactoryBuilder</code>ä¸ºä¾‹ï¼Œåœ¨åˆ›å»ºSqlSessionFactoryå‰éœ€è¦å…ˆè§£æä¸»é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸ç¹çã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼š</p>
<ul>
<li>åˆ†ç¦»ã€Œå¯¹è±¡æ„å»ºé€»è¾‘ã€å’Œã€Œå¯¹è±¡ä½¿ç”¨é€»è¾‘ã€ï¼Œè®©å¤æ‚å¯¹è±¡åˆ›å»ºæµç¨‹æ¸…æ™°ï¼›</li>
<li>å»ºé€ è€…å¯ä»¥åˆ†æ­¥éª¤æ ¡éªŒé…ç½®æ­£ç¡®æ€§ï¼Œé¿å…æ— æ•ˆå¯¹è±¡äº§ç”Ÿï¼›</li>
<li>å¤šé‡è½½çš„ build æ–¹æ³•ï¼Œ é€‚é…ä¸åŒå…¥å‚åœºæ™¯ ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span> {

  <span class="hljs-keyword">public</span> SqlSessionFactory <span class="hljs-title function_">build</span><span class="hljs-params">(Reader reader)</span> {
    <span class="hljs-keyword">return</span> build(reader, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
  }

  <span class="hljs-comment">// ç®€åŒ–ä»£ç ï¼šreaderå°±æ˜¯é…ç½®æ–‡ä»¶çš„è¯»å–æµ</span>
  <span class="hljs-keyword">public</span> SqlSessionFactory <span class="hljs-title function_">build</span><span class="hljs-params">(Reader reader, String environment, Properties properties)</span> {
      <span class="hljs-type">XMLConfigBuilder</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLConfigBuilder</span>(reader, environment, properties);
      <span class="hljs-keyword">return</span> build(parser.parse());
    }
  }
</code></pre>
<h3 data-id="heading-2">1.2 å·¥å‚æ¨¡å¼</h3>
<p>å·¥å‚æ¨¡å¼éšè—å¯¹è±¡åˆ›å»ºç»†èŠ‚ï¼Œä¸Šå±‚æ— éœ€å…³å¿ƒã€Œå…·ä½“å®ç°ç±»ã€ï¼Œåªä¾èµ–æ¥å£ã€‚ä¾‹å¦‚</p>
<ul>
<li><code>SqlSessionFactory</code> è´Ÿè´£åˆ›å»º <code>SqlSession</code>ï¼Œæä¾›äº†å¤šä¸ªé‡è½½å®ç°ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e1589661165422bbeaacfcd3622cf5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=NgCQtOwAejTKgiA1riuBz7yQDG8%3D" alt="" loading="lazy"/></li>
<li>Executorã€StatementHandlerã€ResultSetHandlerã€ParameterHandleråªèƒ½ç”± <code>Configuration</code> ä¸­çš„ <code>newExecutor</code> ç­‰æ–¹æ³•åˆ›å»ºï¼Œæ ¹æ®é…ç½®é€‰æ‹©ä¸åŒå®ç°ç±»ï¼›åŒæ—¶åº”ç”¨è‡ªå®šä¹‰æ’ä»¶ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67e0b2f646c541b98507f7392dfe3264~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=FLCMuf%2Bm%2FZK8igsvYxDKN%2B%2Fb48w%3D" alt="" loading="lazy"/></li>
</ul>
<h3 data-id="heading-3">1.3 åŠ¨æ€ä»£ç†</h3>
<p>MyBatis æ ¸å¿ƒçš„ç‰¹æ€§ä¹‹ä¸€æ˜¯ã€ŒMapper æ¥å£æ— éœ€å®ç°ç±»ã€ï¼Œåº•å±‚é€šè¿‡ JDK åŠ¨æ€ä»£ç†ï¼Œå®ç°æ¥å£æ–¹æ³•è°ƒç”¨è§¦å‘SQLæ‰§è¡Œã€‚è¯¦è§ MapperProxyFactoryï¼Œç¼“å­˜æ–¹æ³•å…ƒæ•°æ®ï¼Œé¿å…é‡å¤è§£æã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¼“å­˜mapperæ–¹æ³•å…ƒæ•°æ®ï¼Œé¿å…é‡å¤è§£æ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Method, MapperMethod&gt; methodCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;Method, MapperMethod&gt;();
</code></pre>
<p>æ­¤å¤–ï¼Œæ’ä»¶åŸç†ä¹Ÿæ˜¯åŠ¨æ€ä»£ç†ï¼Œå®šä¹‰Interceptoræ¥å£å£°æ˜ä»£ç†é€»è¾‘ã€ä»£ç†å¯¹è±¡åˆ›å»ºç­‰ã€‚ä½¿ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ’ä»¶å®ç°ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/528b1ca4573e463b953910ff59835bbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=358hDpLBnMMbzIFpISHErQd536c%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">1.4 æ¨¡æ¿æ–¹æ³•</h3>
<ul>
<li>æ¨¡æ¿æ–¹æ³•å°†ã€Œä¸å˜çš„é€šç”¨é€»è¾‘ã€æŠ½ç¦»åˆ°çˆ¶ç±»ï¼Œã€Œå¯å˜çš„å·®å¼‚åŒ–é€»è¾‘ã€äº¤ç»™å­ç±»å®ç°ï¼›</li>
<li>é¿å…å­ç±»é‡å¤ç¼–å†™é€šç”¨ä»£ç ï¼ˆå¦‚ç¼“å­˜æ£€æŸ¥ã€å‚æ•°æ ¡éªŒï¼‰ï¼Œé™ä½ä»£ç å†—ä½™ï¼›</li>
<li>çˆ¶ç±»æ§åˆ¶æµç¨‹ï¼Œå­ç±»åªå…³æ³¨æ ¸å¿ƒé€»è¾‘ï¼Œç¬¦åˆã€Œå¼€é—­åŸåˆ™ã€ã€‚</li>
</ul>
<p><code>BaseExecutor</code> å®ç°äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°† Executor çš„é€šç”¨æµç¨‹ï¼ˆå¦‚å‚æ•°å¤„ç†ã€SQL æ‰§è¡Œã€ç»“æœé›†å¤„ç†ï¼‰æŠ½è±¡ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œå…·ä½“å­ç±»ï¼ˆSimpleExecutor/BatchExecutor/ReuseExecutorï¼‰åªéœ€å®ç°å·®å¼‚åŒ–é€»è¾‘ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¨¡æ¿æ–¹æ³•ï¼Œä¸€çº§ç¼“å­˜ä½¿ç”¨é€»è¾‘</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">query</span><span class="hljs-params">(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql)</span> <span class="hljs-keyword">throws</span> SQLException {
<span class="hljs-comment">// ...ï¼Œä¼šè°ƒç”¨doQuer()</span>
    
}

<span class="hljs-comment">// ç”±å­ç±»å®ç°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">doQuery</span><span class="hljs-params">(...)</span>
</code></pre>
<h3 data-id="heading-5">1.5 è£…é¥°æ¨¡å¼</h3>
<p>ç”¨è£…é¥°æ¨¡å¼æ›¿ä»£ç»§æ‰¿ï¼Œæ— éœ€å®šä¹‰å­ç±»ï¼Œå°±èƒ½ç»™å¯¹è±¡åŠ¨æ€å¢åŠ èŒè´£ã€‚</p>
<p>å¦‚é€šè¿‡CachingExecutorè£…é¥°ï¼Œç»™BaseExecutorå¢åŠ äºŒçº§ç¼“å­˜èƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> Executor <span class="hljs-title function_">newExecutor</span><span class="hljs-params">(Transaction transaction, ExecutorType executorType)</span> {
    <span class="hljs-comment">// å¯¹BaseExecutorå­ç±»è¿›è¡Œè£…é¥°</span>
    <span class="hljs-keyword">if</span> (cacheEnabled) {
        executor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CachingExecutor</span>(executor);
    }
    <span class="hljs-comment">// çœç•¥...</span>
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55436ee6561e4086a6f22ab0f99fe184~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=2ViPQW%2Be3Bj%2FA3eJBYIUsVLynlE%3D" alt="" loading="lazy"/>
å¦‚Cacheæ¥å£ä½“ç³»ï¼Œå®šä¹‰äº†å¾ˆå¤šè£…é¥°å™¨ï¼Œæ ¹æ®ç”¨æˆ·é…ç½®ï¼Œå®ç°åŠŸèƒ½ç‰¹æ€§è‡ªç”±ç»„åˆã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4370c1549594655bf4cd6588979fa90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=iisVJgb9y%2B0ITqMmYVtgw9RcpYI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">1.6 ç­–ç•¥æ¨¡å¼</h3>
<p>Executoræ¥å£å¯æ ¹æ®ç”¨æˆ·é…ç½®ï¼Œè¿è¡Œæ—¶å¯åˆ‡æ¢SimpleExecutorã€ReuseExecutoræˆ–BatchExecutorï¼Œå®ç°ä¸åŒçš„SQLæ‰§è¡Œç­–ç•¥ã€‚</p>
<p>RoutingStatementHandler æ ¹æ®é…ç½®è·¯ç”±åˆ°ä¸åŒçš„ StatementHandlerå®ç°ã€‚</p>
<h3 data-id="heading-7">1.7 æ³¨å†Œä¸­å¿ƒ</h3>
<p>æºç ä¸­å¤§é‡ä½¿ç”¨ Registry æ¨¡å¼æ¥ç®¡ç†å¯æ‰©å±•ç»„ä»¶ï¼Œ å¯ä»¥ç»Ÿä¸€åˆå§‹åŒ–ã€ç»Ÿä¸€æŸ¥æ‰¾ã€ç»Ÿä¸€ç”Ÿå‘½å‘¨æœŸï¼›ä¾‹å¦‚ï¼š</p>
<ul>
<li>TypeHandlerRegistry</li>
<li>MapperRegistry</li>
<li>LanguageDriverRegistry</li>
<li>CacheRegistry</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4501d4f189b746e4ac18bcf82e70135c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=7hIqQH6GVL4WzTFCprSyyqcO2RQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">äºŒ æ¶æ„æ€ç»´</h2>
<h3 data-id="heading-9">2.1 åˆ†å±‚è®¾è®¡</h3>
<p>MyBatisçš„æ ¸å¿ƒåˆ†å±‚éå¸¸æ¸…æ™°ï¼Œæ¯å±‚åªåšä¸€ä»¶äº‹ï¼Œç¬¦åˆã€Œå•ä¸€èŒè´£åŸåˆ™ã€ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1018beec274e49498aa8eaa2b6947590~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=NPmTEDNJDAPB78OdGE9BpRwaQpw%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>å„å±‚èŒè´£</strong>ï¼š
<ul>
<li>Mapper å±‚ï¼šç”¨æˆ·æ¥å£ï¼Œå®šä¹‰ SQL æ“ä½œï¼›</li>
<li>SqlSession å±‚ï¼šä¼šè¯å…¥å£ï¼Œå°è£… Executor è°ƒç”¨ï¼›</li>
<li>Executor å±‚ï¼šæ‰§è¡Œå™¨ï¼Œå¤„ç†ç¼“å­˜ã€äº‹åŠ¡ã€SQL æ‰§è¡Œæµç¨‹ï¼›</li>
<li>StatementHandler å±‚ï¼šå¤„ç† SQL æ‹¼æ¥ã€Statement åˆ›å»ºï¼›</li>
<li>Parameter/ResultSetHandler å±‚ï¼šå‚æ•°ç»‘å®šã€ç»“æœé›†æ˜ å°„ï¼›</li>
</ul>
</li>
<li><strong>æ¶æ„æ€ç»´</strong>ï¼š
<ul>
<li>åˆ†å±‚é™ä½è€¦åˆï¼šä¿®æ”¹ç»“æœé›†æ˜ å°„é€»è¾‘ï¼Œä¸ä¼šå½±å“ Executor å±‚ï¼›</li>
<li>æ¯å±‚ä¾èµ–ã€Œæ¥å£ã€è€Œéã€Œå®ç°ã€ï¼šæ¯”å¦‚ Executor æ˜¯æ¥å£ï¼Œå…·ä½“å®ç°å¯æ›¿æ¢ï¼›</li>
<li>åˆ†å±‚ä¾¿äºæµ‹è¯•ï¼šå¯å•ç‹¬æµ‹è¯• ParameterHandler çš„å‚æ•°ç»‘å®šé€»è¾‘ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-10">2.2 æ’ä»¶åŒ–è®¾è®¡</h3>
<p>MyBatis æä¾›äº†æ’ä»¶æ‰©å±•æœºåˆ¶ï¼ˆInterceptorï¼‰ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡æ‹¦æˆªå™¨å¢å¼ºæ ¸å¿ƒç»„ä»¶ï¼ˆExecutorã€StatementHandlerã€ParameterHandlerã€ResultSetHandlerï¼‰çš„åŠŸèƒ½ï¼Œå®ç°å¦‚åˆ†é¡µã€æ—¥å¿—ã€åŠ å¯†ç­‰ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒè®¾è®¡</strong>ï¼š
<ul>
<li>å®šä¹‰ <code>Interceptor</code> æ¥å£ï¼Œå¼€å‘è€…å®ç° <code>intercept</code> æ–¹æ³•å³å¯æ‹¦æˆªç›®æ ‡æ–¹æ³•ï¼›</li>
<li>é€šè¿‡ <code>@Intercepts</code> æ³¨è§£æŒ‡å®šæ‹¦æˆªçš„ç±»å’Œæ–¹æ³•ï¼Œæ— éœ€ä¿®æ”¹æºç ï¼›</li>
<li>æ‹¦æˆªå™¨é“¾ï¼ˆInterceptorChainï¼‰é€šè¿‡åŠ¨æ€ä»£ç†å±‚å±‚åŒ…è£…ç›®æ ‡å¯¹è±¡ï¼Œä¿è¯æ’ä»¶çš„æœ‰åºæ‰§è¡Œï¼›</li>
</ul>
</li>
<li><strong>æ¶æ„æ€ç»´</strong>ï¼š
<ul>
<li>ã€Œå¼€é—­åŸåˆ™ã€çš„è‰¯å¥½ä½“ç°ï¼šæ¡†æ¶æ ¸å¿ƒåŠŸèƒ½å›ºå®šï¼Œæ‰©å±•åŠŸèƒ½é€šè¿‡æ’ä»¶å®ç°ï¼Œæ— éœ€ä¿®æ”¹æºç ï¼›</li>
<li>ã€Œè´£ä»»é“¾æ¨¡å¼ã€ï¼šå¤šä¸ªæ’ä»¶æŒ‰é¡ºåºæ‰§è¡Œï¼Œæ¯ä¸ªæ’ä»¶åªå¤„ç†è‡ªå·±çš„é€»è¾‘ï¼Œäº’ä¸å¹²æ‰°ï¼›</li>
<li>æ‰©å±•ç‚¹è®¾è®¡è¦ã€Œæœ€å°åŒ–ã€ï¼šåªå¼€æ”¾æ ¸å¿ƒç»„ä»¶çš„å…³é”®æ–¹æ³•ï¼Œé¿å…è¿‡åº¦æš´éœ²å†…éƒ¨é€»è¾‘ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-11">2.3 å¤šçº§ç¼“å­˜</h3>
<p>MyBatis å®ç°äº†ã€Œä¸€çº§ç¼“å­˜ï¼ˆSqlSession çº§åˆ«ï¼‰+ äºŒçº§ç¼“å­˜ï¼ˆMapper çº§åˆ«ï¼‰ã€çš„å¤šçº§ç¼“å­˜ï¼š</p>
<ul>
<li>ä¸€çº§ç¼“å­˜ï¼šBaseExecutor ä¸­çš„ <code>localCache</code>ï¼ˆPerpetualCacheï¼‰ï¼Œé»˜è®¤å¼€å¯ï¼ŒSqlSession å…³é—­åå¤±æ•ˆï¼›</li>
<li>äºŒçº§ç¼“å­˜ï¼šCachingExecutor åŒ…è£…æ™®é€š Executorï¼Œç¼“å­˜æ•°æ®å­˜å…¥ Mapper å¯¹åº”çš„ Cache å¯¹è±¡ï¼Œè·¨ SqlSession å…±äº«ï¼›</li>
</ul>
<p>åŒæ—¶æ”¯æŒé›†æˆ Redis/Ehcache ç­‰ç¬¬ä¸‰æ–¹ç¼“å­˜ ã€‚</p>
<h3 data-id="heading-12">2.4 é¢å‘æ¥å£ç¼–ç¨‹</h3>
<p>MyBatis å…¨ç¨‹è´¯å½»ã€Œä¾èµ–å€’ç½®åŸåˆ™ã€ï¼Œå®Œå…¨é¢å‘æ¥å£ç¼–ç¨‹ï¼šæ¥å£å®šä¹‰ã€Œåšä»€ä¹ˆã€ï¼Œå®ç°ç±»å®šä¹‰ã€Œæ€ä¹ˆåšã€ï¼Œæ›¿æ¢å®ç°ç±»ä¸å½±å“ä¸Šå±‚é€»è¾‘ï¼›</p>
<ul>
<li>æ ¸å¿ƒç»„ä»¶éƒ½æ˜¯æ¥å£ï¼š<code>Executor</code>ã€<code>StatementHandler</code>ã€<code>ParameterHandler</code>ã€<code>ResultSetHandler</code>ã€<code>SqlSession</code> ç­‰ï¼›</li>
<li>ä¸Šå±‚ä»£ç åªä¾èµ–æ¥å£ï¼šæ¯”å¦‚ <code>SqlSession</code> çš„ <code>selectList</code> æ–¹æ³•ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯ <code>Executor</code> æ¥å£çš„ <code>query</code> æ–¹æ³•ï¼Œæ— éœ€å…³å¿ƒå…·ä½“æ˜¯ SimpleExecutor è¿˜æ˜¯ BatchExecutorã€‚</li>
</ul>
<h3 data-id="heading-13">2.5 çº¦å®šä¼˜äºé…ç½®</h3>
<p>MyBatis å¤§é‡ä½¿ç”¨çº¦å®šæ¥å‡å°‘é…ç½®ï¼Œé€šè¿‡çº¦å®šå¯ä»¥æ˜¾è‘—é™ä½é…ç½®é‡ï¼Œæå‡å¼€å‘ä½“éªŒã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>Mapper æ¥å£ä¸ XML æ–‡ä»¶åŒååŒåŒ…ï¼›</li>
<li>æ–¹æ³•åä¸ SQL ID ä¸€è‡´ï¼›</li>
<li>ç»“æœé›†å­—æ®µä¸ JavaBean å±æ€§è‡ªåŠ¨æ˜ å°„ï¼›</li>
<li><code>StatementHandler</code>æ¥å£é»˜è®¤ä½¿ç”¨PreparedStatementHandler<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83667e2d1a8a40a4acf15f4a45aacf7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769858685&amp;x-signature=T50SsnLSHPkJvRQ8cbF46vRwAbo%3D" alt="" loading="lazy"/></li>
</ul>
<h3 data-id="heading-14">2.6 æ¶æ„æ€ç»´æ€»ç»“</h3>
<p>MyBatisæºç ä½“ç°äº†<strong>ç®€å•è€Œä¸ç®€é™‹</strong>çš„è®¾è®¡å“²å­¦ï¼š</p>
<ol>
<li>é«˜å†…èšä½è€¦åˆ - æ¨¡å—èŒè´£æ¸…æ™°ï¼Œä¾èµ–æŠ½è±¡</li>
<li>å¼€é—­åŸåˆ™ - å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</li>
<li>ç»„åˆä¼˜äºç»§æ‰¿ - è£…é¥°å™¨ã€ä»£ç†æ¨¡å¼çš„åº”ç”¨</li>
<li>å…³æ³¨ç‚¹åˆ†ç¦» - SQLã€æ˜ å°„ã€æ‰§è¡Œé€»è¾‘åˆ†ç¦»</li>
<li>æ€§èƒ½ä¼˜åŒ– - ç¼“å­˜ã€å»¶è¿ŸåŠ è½½ã€è¿æ¥å¤ç”¨</li>
</ol>
<p>ä¸Šè¿°æŠ€å·§å’Œæ€ç»´ä¸ä»…é€‚ç”¨äºæ¡†æ¶å¼€å‘ï¼Œåœ¨æ—¥å¸¸ä¸šåŠ¡å¼€å‘ä¸­ä¹Ÿèƒ½ç›´æ¥è½åœ°ã€‚</p>
<ol>
<li>å°å‹é¡¹ç›®ï¼šå­¦ä¹ å…¶ç®€æ´çš„APIè®¾è®¡</li>
<li>ä¸­å‹é¡¹ç›®ï¼šå€Ÿé‰´å…¶åˆ†å±‚æ¶æ„å’Œæ¨¡å¼åº”ç”¨</li>
<li>å¤§å‹é¡¹ç›®ï¼šå‚è€ƒå…¶æ‰©å±•æœºåˆ¶å’Œæ’ä»¶ä½“ç³»</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è…¾è®¯CodeBuddy 2.0ï¼šä»â€œå‰¯é©¾é©¶â€åˆ°â€œå…¨æ ˆåˆä¼™äººâ€çš„è¿›åŒ–]]></title>    <link>https://juejin.cn/post/7598447519824379945</link>    <guid>https://juejin.cn/post/7598447519824379945</guid>    <pubDate>2026-01-24T11:43:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598447519824379945" data-draft-id="7598587406706769961" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è…¾è®¯CodeBuddy 2.0ï¼šä»â€œå‰¯é©¾é©¶â€åˆ°â€œå…¨æ ˆåˆä¼™äººâ€çš„è¿›åŒ–"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-24T11:43:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è…¾è®¯CodeBuddy 2.0ï¼šä»â€œå‰¯é©¾é©¶â€åˆ°â€œå…¨æ ˆåˆä¼™äººâ€çš„è¿›åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T11:43:03.000Z" title="Sat Jan 24 2026 11:43:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœè¯´å»å¹´çš„AIç¼–ç¨‹å·¥å…·è¿˜åœ¨æ¯”æ‹¼è°çš„è¡¥å…¨é€Ÿåº¦æ›´å¿«ã€è°çŒœä½ çš„ä¸‹ä¸€è¡Œä»£ç æ›´å‡†ï¼Œé‚£ä¹ˆä»Šå¹´ï¼Œè…¾è®¯äº‘å‘å¸ƒçš„ <strong>CodeBuddy Code 2.0</strong> æ˜¾ç„¶æƒ³æŠŠè¿™åœºæ¸¸æˆæå‡åˆ°ä¸€ä¸ªæ–°çš„ç»´åº¦ï¼šå®ƒä¸æƒ³å†åªåšä½ çš„å‰¯é©¾é©¶ï¼ˆCopilotï¼‰ï¼Œå®ƒæƒ³åšä½ çš„å·¥ç¨‹åˆä¼™äººã€‚</p>
<p>æœ€è¿‘ç§‘æŠ€åœˆé‡Œæµä¼ ç€ä¸€ç»„æ¥è‡ªè…¾è®¯å†…éƒ¨çš„æ•°æ®ï¼Œç›¸å½“è€äººå¯»å‘³ã€‚CodeBuddyå›¢é˜Ÿè‡ªå·±ç”¨è¿™å¥—å·¥å…·ï¼Œåœ¨çŸ­çŸ­58å¤©å†…å®Œæˆäº†79ä¸ªç‰ˆæœ¬çš„è¿­ä»£ã€‚è€Œåœ¨è¿™äº›è¿­ä»£ä¸­ï¼Œ<strong>90%çš„æ–°å¢ä»£ç å®Œå…¨ç”±AIç”Ÿæˆ</strong>ã€‚è¿™æ„å‘³ç€ï¼ŒåŸæœ¬ä½œä¸ºè¾…åŠ©è§’è‰²çš„AIï¼Œå·²ç»å¼€å§‹åå®¢ä¸ºä¸»ï¼Œæ‰¿æ‹…èµ·äº†ç»å¤§éƒ¨åˆ†çš„æ¬ç –å·¥ä½œï¼Œè®©4åäººç±»å¼€å‘è€…çœŸæ­£å›å½’åˆ°äº†æ¶æ„è®¾è®¡å’Œå†³ç­–è€…çš„è§’è‰²ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-24_19.11.29.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-24_19.11.29.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69be59ca7c2c4caaa2d029acd9295b62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769859783&amp;x-signature=%2BHKKDsY5EGQ2ll3uvhvFgx7FOqY%3D" alt="iShot_2026-01-24_19.11.29" loading="lazy"/></a></p>
<p>è¿™å¬èµ·æ¥å¾ˆæ€§æ„Ÿï¼Œä½†CodeBuddy 2.0åˆ°åº•å‡­ä»€ä¹ˆèƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿç»†çœ‹è¿™æ¬¡çš„æ›´æ–°æ–‡æ¡£ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡ ä¸ªéå¸¸æœ‰æ„æ€çš„æŠ€æœ¯çªç ´ã€‚</p>
<h3 data-id="heading-0">ä¸å†ç›²çŒœï¼Œå…ˆæœ‰â€œè®¡åˆ’â€</h3>
<p>ä»¥å‰æˆ‘ä»¬ç”¨AIå†™ä»£ç ï¼Œæœ€å¤´ç–¼çš„æ˜¯â€œä¸Šä¸‹æ–‡ä¸¢å¤±â€å’Œâ€œé€»è¾‘æ–­å±‚â€ã€‚ä½ è®©å®ƒå†™ä¸ªå¤æ‚åŠŸèƒ½ï¼Œå®ƒå¾€å¾€å†™ç€å†™ç€å°±è·‘åäº†ã€‚</p>
<p>CodeBuddy 2.0 æ‹¿å‡ºçš„æ€æ‰‹é”æ˜¯ <strong>Planæ¨¡å¼ï¼ˆè®¡åˆ’æ¨¡å¼ï¼‰</strong>ã€‚è¿™å°±å¥½æ¯”ä½ åœ¨å¸¦å®ä¹ ç”Ÿï¼Œä¸ä¼šä¸Šæ¥å°±è®©ä»–å†™æ ¸å¿ƒé€»è¾‘ï¼Œè€Œæ˜¯å…ˆè®©ä»–æŠŠä»»åŠ¡æ‹†è§£æ¸…æ¥šã€‚åœ¨Planæ¨¡å¼ä¸‹ï¼ŒAIä¼šå…ˆé€šè¿‡è‡ªç„¶è¯­è¨€è§„åˆ’ä»»åŠ¡ï¼ŒæŠŠä¸€ä¸ªåºå¤§çš„éœ€æ±‚æ‹†è§£æˆä¸€ä¸ªä¸ªåŸå­æ“ä½œã€‚åªæœ‰å½“è§„åˆ’è·¯å¾„è¢«ç¡®è®¤åï¼Œå®ƒæ‰ä¼šåŠ¨æ‰‹ã€‚è¿™ç§â€œå…ˆæ€è€ƒï¼Œåè¡ŒåŠ¨â€çš„é€»è¾‘ï¼Œè®©å®ƒåœ¨å¤„ç†å¤æ‚å·¥ç¨‹ä»»åŠ¡æ—¶çš„å¯ç”¨æ€§æœ‰äº†è´¨çš„é£è·ƒã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-24_19.11.34-1024x856.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-24_19.11.34-1024x856.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f009a7870d924e7b8473a5d058669b59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769859783&amp;x-signature=y%2BMVrj3gadNP30rTpFjBZpls%2BLU%3D" alt="iShot_2026-01-24_19.11.34" loading="lazy"/></a></p>
<p>é…åˆè¿™ä¸€æ¨¡å¼çš„æ˜¯ <strong>ACPåè®®</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„æ¥å£åè®®ï¼Œå®ƒæŠŠæ ¸å¿ƒçš„æ™ºèƒ½ä½“èƒ½åŠ›ä¸ç¼–è¾‘å™¨è§£è€¦äº†ã€‚è¿™æ„å‘³ç€CodeBuddyä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„å¤§è„‘ï¼Œå¯ä»¥çµæ´»åœ°æ¥å…¥Zedç­‰å„ç§ç°ä»£ç¼–è¾‘å™¨ã€‚</p>
<h3 data-id="heading-1">ç»™AIè£…ä¸Šâ€œå®‰å…¨æ°”å›Šâ€</h3>
<p>è®©AIæ¥ç®¡å‘½ä»¤è¡Œå’Œæ–‡ä»¶ç³»ç»Ÿï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªæœ‰ç»éªŒçš„è¿ç»´æˆ–æ¶æ„å¸ˆæ¥è¯´ï¼Œå¬èµ·æ¥éƒ½æœ‰ç‚¹å¿ƒæƒŠè‚‰è·³ã€‚ä¸‡ä¸€AIâ€œå‘ç–¯â€åˆ åº“æ€ä¹ˆåŠï¼Ÿ</p>
<p>è…¾è®¯æ˜¾ç„¶å¾ˆæ¸…æ¥šä¼ä¸šçš„ç—›ç‚¹ã€‚ä»–ä»¬åœ¨2.0ç‰ˆæœ¬ä¸­å¼•å…¥äº†åŸºäº <strong>TencentOS</strong> çš„å®¹å™¨åŒ–å®‰å…¨æ²™ç®±ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç»™AIåˆ’å®šäº†ä¸€ä¸ªç»å¯¹éš”ç¦»çš„è™šæ‹Ÿæ¸¸ä¹åœºã€‚</p>
<p>åœ¨è¿™ä¸ªæ²™ç®±é‡Œï¼Œæ–‡ä»¶ç³»ç»Ÿçš„è¯»å†™ã€ç½‘ç»œè¯·æ±‚çš„å‘å‡ºï¼Œéƒ½å—åˆ°ä¸¥æ ¼çš„ç®¡æ§ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯â€œåªè¯»â€çš„ï¼Œä»»ä½•æ¶‰åŠä¿®æ”¹ä»£ç æˆ–æ‰§è¡Œæ•æ„Ÿå‘½ä»¤çš„æ“ä½œï¼Œéƒ½éœ€è¦ç»è¿‡æƒé™æ ¡éªŒã€‚è¿™ç§â€œæœ€å°æƒé™åŸåˆ™â€çš„è®¾è®¡ï¼Œå®é™…ä¸Šæ˜¯ç»™AIæˆ´ä¸Šäº†é•£é“ï¼Œè®©å®ƒåœ¨æ‹¥æœ‰å¼ºå¤§æ‰§è¡ŒåŠ›çš„åŒæ—¶ï¼Œä¸å…·å¤‡ç ´åç”Ÿäº§ç¯å¢ƒçš„èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-2">æ‰“å¼€é»‘ç›’ï¼Œæ‹¥æŠ±ç”Ÿæ€</h3>
<p>è¿™å¯èƒ½æ˜¯CodeBuddy 2.0æœ€åƒâ€œæå®¢â€çš„ä¸€é¢ã€‚ä¸åŒäºå¸‚é¢ä¸Šå¾ˆå¤šå°è£…å¾—ä¸¥ä¸¥å®å®çš„AIå·¥å…·ï¼ŒCodeBuddyé€‰æ‹©äº†æåº¦å¼€æ”¾ã€‚</p>
<p>é¦–å…ˆæ˜¯ <strong>SDKçš„å¼€æ”¾</strong>ã€‚å®ƒå…è®¸å¼€å‘è€…é€šè¿‡ <code>CodeBuddyAgent SDK</code> å’Œ API Keyï¼Œç›´æ¥æŠŠè¿™ç§æ™ºèƒ½ä½“èƒ½åŠ›é›†æˆåˆ°è‡ªå·±çš„ä¸šåŠ¡ç³»ç»Ÿä¸­ã€‚å¦‚æœä½ è§‰å¾—å®˜æ–¹çš„åŠŸèƒ½ä¸å¤Ÿç”¨ï¼Œä½ ç”šè‡³å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªâ€œå­æ™ºèƒ½ä½“ï¼ˆSubagentï¼‰â€æ¥ä¸“é—¨å¤„ç†ä½ ä»¬å›¢é˜Ÿç‰¹æ®Šçš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-24_19.11.43.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-24_19.11.43.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a65ab7c57584c03be1da04984ff3f35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769859783&amp;x-signature=f29H64dDlL%2F%2F80vJWt1uSjzPnrU%3D" alt="iShot_2026-01-24_19.11.43" loading="lazy"/></a></p>
<p>å…¶æ¬¡æ˜¯ <strong>å¤šæ¨¡å‹æ”¯æŒ</strong>ã€‚å®ƒä¸å¼ºåˆ¶ä½ ç»‘å®šæŸä¸€ä¸ªæ¨¡å‹ï¼Œè€Œæ˜¯æ”¯æŒGLM-4.7ã€GPT-5.2 Codexç­‰å›½å†…å¤–ä¸»æµæ¨¡å‹ã€‚è¿™ç§â€œæ¨¡å‹ä¸­ç«‹â€çš„æ€åº¦ï¼Œåœ¨å¦‚ä»Šçš„å¤§å‚äº§å“ä¸­å¹¶ä¸å¤šè§ã€‚</p>
<h3 data-id="heading-3">å†™åœ¨æœ€å</h3>
<p>ä»å•çº¯çš„ä»£ç è¡¥å…¨ï¼Œåˆ°æ”¯æŒCLIï¼ˆå‘½ä»¤è¡Œï¼‰ã€IDEå’Œæ’ä»¶ä¸‰ç«¯è”åŠ¨ï¼Œå†åˆ°å¼€æ”¾SDKè®©ä¼ä¸šè‡ªå·±å®šåˆ¶ï¼Œè…¾è®¯CodeBuddy 2.0çš„é‡å¿ƒå¾ˆæ˜æ˜¾ï¼šå®ƒä¸ä»…ä»…æƒ³åšä¸€ä¸ªå·¥å…·ï¼Œè€Œæ˜¯æƒ³æˆä¸ºAIåŸç”Ÿå¼€å‘æ—¶ä»£çš„â€œåŸºç¡€è®¾æ–½â€ã€‚</p>
<p>å½“ä¸€ä¸ªå·¥å…·å¼€å§‹èƒ½å¤Ÿç†è§£å·¥ç¨‹å…¨è²Œã€èƒ½å¤Ÿè‡ªæˆ‘è§„åˆ’ä»»åŠ¡ã€å¹¶ä¸”åœ¨å®‰å…¨å¯æ§çš„å‰æä¸‹è‡ªä¸»æ‰§è¡Œæ—¶ï¼Œè½¯ä»¶å¼€å‘çš„é—¨æ§›æ­£åœ¨è¢«é‡æ–°å®šä¹‰ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œä¹Ÿè®¸æ˜¯æ—¶å€™æ”¹å˜ä¸€ä¸‹å·¥ä½œæµï¼Œè¯•ç€å­¦ä¼šå¦‚ä½•ç®¡ç†ä¸€ä¸ªâ€œç¡…åŸºåŒäº‹â€äº†ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ TypeScript + React Hooks æ„å»ºä¸€ä¸ªå¥å£®çš„ Todo åº”ç”¨]]></title>    <link>https://juejin.cn/post/7598827845965185050</link>    <guid>https://juejin.cn/post/7598827845965185050</guid>    <pubDate>2026-01-24T09:45:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598827845965185050" data-draft-id="7598818096729112614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ TypeScript + React Hooks æ„å»ºä¸€ä¸ªå¥å£®çš„ Todo åº”ç”¨"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-24T09:45:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Zyx2007"/> <meta itemprop="url" content="https://juejin.cn/user/3924597867554890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ TypeScript + React Hooks æ„å»ºä¸€ä¸ªå¥å£®çš„ Todo åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3924597867554890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Zyx2007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:45:50.000Z" title="Sat Jan 24 2026 09:45:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘æˆ‘ç”¨ React å’Œ TypeScript ä»é›¶å†™äº†ä¸€ä¸ª Todo åº”ç”¨ï¼Œæ•´ä¸ªè¿‡ç¨‹è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼š<strong>ç±»å‹ç³»ç»Ÿä¸æ˜¯æŸç¼šï¼Œè€Œæ˜¯ä¿æŠ¤</strong>ã€‚å®ƒè®©ç»„ä»¶ä¹‹é—´çš„åä½œæ›´æ¸…æ™°ï¼ŒçŠ¶æ€ç®¡ç†æ›´å¯é ï¼Œè¿ localStorage çš„è¯»å†™éƒ½å˜å¾—å®‰å…¨å¯æ§ã€‚ä¸‹é¢åˆ†äº«æˆ‘æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥æ­å»ºè¿™ä¸ªå°é¡¹ç›®çš„ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ€è·¯ï¼šçŠ¶æ€é›†ä¸­ + ç±»å‹çº¦æŸ</h2>
<p>æˆ‘æŠŠæ‰€æœ‰ todo æ•°æ®å’Œæ“ä½œé€»è¾‘å°è£…åœ¨ä¸€ä¸ªè‡ªå®šä¹‰ Hook <code>useTodos</code> é‡Œï¼Œè¿™æ ·ç»„ä»¶åªéœ€è¦â€œæ¶ˆè´¹â€çŠ¶æ€å’Œæ–¹æ³•ï¼Œä¸ç”¨å…³å¿ƒå®ç°ç»†èŠ‚ã€‚åŒæ—¶ï¼Œç”¨ TypeScript æ¥å£æ˜ç¡®çº¦å®šæ•°æ®ç»“æ„ï¼Œé¿å…ä¼ é”™å‚æ•°æˆ–è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ã€‚</p>
<p>é¦–å…ˆå®šä¹‰ Todo çš„ç»“æ„ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// types/todo.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>;
}
</code></pre>
<p>è¿™ä¸ªæ¥å£å°±åƒä¸€ä»½å¥‘çº¦â€”â€”ä»»ä½•åœ°æ–¹ä½¿ç”¨ Todo æ•°æ®ï¼Œéƒ½å¿…é¡»åŒ…å«è¿™ä¸‰ä¸ªå­—æ®µï¼Œä¸”ç±»å‹å›ºå®šã€‚</p>
<h2 data-id="heading-1">è‡ªå®šä¹‰ Hookï¼šuseTodos</h2>
<p>è¿™æ˜¯æ•´ä¸ªåº”ç”¨çš„æ ¸å¿ƒã€‚å®ƒç”¨ <code>useState</code> ç®¡ç†çŠ¶æ€ï¼Œå¹¶é€šè¿‡ <code>useEffect</code> åŒæ­¥åˆ° localStorageï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// hooks/useTodos.ts
export function useTodos() {
  const <span class="hljs-section">[todos, setTodos]</span> = useState&lt;Todo<span class="hljs-section">[]</span>&gt;(() =&gt; 
    getStorage&lt;Todo<span class="hljs-section">[]</span>&gt;(STORAGE_KEY, <span class="hljs-section">[]</span>)
  )<span class="hljs-comment">;</span>

  useEffect(() =&gt; {
    setStorage&lt;Todo<span class="hljs-section">[]</span>&gt;(STORAGE_KEY, todos)<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[todos]</span>)<span class="hljs-comment">;</span>

  const <span class="hljs-attr">addTodo</span> = (title: string) =&gt; {
    const newTodo: <span class="hljs-attr">Todo</span> = {
      id: +new Date(),
      title,
      completed: false
    }<span class="hljs-comment">;</span>
    setTodos(<span class="hljs-section">[...todos, newTodo]</span>)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  // toggleTodo å’Œ removeTodo ç•¥...

  return { todos, addTodo, toggleTodo, removeTodo }<span class="hljs-comment">;</span>
}
</code></pre>
<p>æ³¨æ„è¿™é‡Œç”¨äº†æ³›å‹å‡½æ•° <code>getStorage&lt;T&gt;</code> å’Œ <code>setStorage&lt;T&gt;</code>ï¼Œç¡®ä¿è¯»å†™ localStorage æ—¶ç±»å‹å®‰å…¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// utils/storages.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> getStorage&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">defaultValue</span>: T): T {
  <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
  <span class="hljs-keyword">return</span> item ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(item) : defaultValue;
}
</code></pre>
<p>è¿™æ ·ï¼Œå³ä½¿ä» localStorage è¯»å‡ºæ¥çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²ï¼ŒTS ä¹Ÿèƒ½æ­£ç¡®æ¨æ–­ä¸º <code>Todo[]</code> ç±»å‹ã€‚</p>
<h2 data-id="heading-2">ç»„ä»¶é€šä¿¡ï¼šé  Props æ¥å£å¯¹é½</h2>
<p>çˆ¶ç»„ä»¶ <code>App</code> åªè´Ÿè´£ç»„åˆï¼Œä¸å¤„ç†é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// App.tsx</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { todos, addTodo, toggleTodo, removeTodo } = <span class="hljs-title function_">useTodos</span>();
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>TodoList<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoInput</span> <span class="hljs-attr">onAdd</span>=<span class="hljs-string">{addTodo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoList</span> <span class="hljs-attr">todos</span>=<span class="hljs-string">{todos}</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{toggleTodo}</span> <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{removeTodo}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>å­ç»„ä»¶é€šè¿‡ Props æ¥å£æ˜ç¡®å£°æ˜è‡ªå·±éœ€è¦ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// components/TodoList.tsx</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Props</span> {
  <span class="hljs-attr">todos</span>: <span class="hljs-title class_">Todo</span>[];
  <span class="hljs-attr">onToggle</span>: <span class="hljs-function">(<span class="hljs-params">id: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">onRemove</span>: <span class="hljs-function">(<span class="hljs-params">id: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">TodoList</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">Props</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{ todos, onToggle, onRemove }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
      {todos.map(todo =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{onToggle}</span> <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{onRemove}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
  );
};
</code></pre>
<p>è¿™æ ·ï¼Œå¦‚æœæˆ‘åœ¨ <code>App</code> é‡Œä¸å°å¿ƒä¼ äº†é”™è¯¯ç±»å‹çš„ <code>onToggle</code>ï¼ŒTypeScript ä¼šç«‹åˆ»æŠ¥é”™ï¼Œè€Œä¸æ˜¯ç­‰åˆ°è¿è¡Œæ—¶æ‰å‘ç°æŒ‰é’®ç‚¹ä¸åŠ¨ã€‚</p>
<h2 data-id="heading-3">å•ä¸ª Todo é¡¹ï¼šç»†èŠ‚å¤„ç†</h2>
<p>åœ¨ <code>TodoItem</code> ä¸­ï¼Œæ ¹æ® <code>completed</code> çŠ¶æ€åŠ¨æ€è®¾ç½®æ ·å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">span</span> style={{ textDecoration: todo.completed ? <span class="hljs-string">'line-through'</span> : <span class="hljs-string">'none'</span> }}&gt;
  {todo<span class="hljs-selector-class">.title</span>}
&lt;/<span class="hljs-selector-tag">span</span>&gt;
</code></pre>
<p>å› ä¸º <code>todo</code> çš„ç±»å‹æ˜¯ <code>Todo</code>ï¼Œæ‰€ä»¥ <code>todo.completed</code> ä¸€å®šæ˜¯å¸ƒå°”å€¼ï¼Œä¸ä¼šå‡ºç° <code>undefined</code> å¯¼è‡´æ ·å¼å¼‚å¸¸ã€‚</p>
<h2 data-id="heading-4">è¾“å…¥æ¡†ï¼šé˜²é”™å¤„ç†</h2>
<p><code>TodoInput</code> è¿˜åšäº†ç©ºå€¼æ ¡éªŒï¼š</p>
<pre><code class="hljs language-scss" lang="scss">const handleAdd = () =&gt; {
  if (!value.trim()) return; <span class="hljs-comment">// é˜²æ­¢æ·»åŠ ç©ºä»»åŠ¡</span>
  <span class="hljs-built_in">onAdd</span>(value);
  <span class="hljs-built_in">setValue</span>('');
};
</code></pre>
<p>é…åˆ TS çš„ <code>string</code> ç±»å‹ï¼Œç¡®ä¿ä¼ ç»™ <code>onAdd</code> çš„ä¸€å®šæ˜¯å­—ç¬¦ä¸²ï¼Œä¸ä¼šæ„å¤–ä¼ å…¥æ•°å­—æˆ– nullã€‚</p>
<h2 data-id="heading-5">æ€»ç»“ï¼šä¸ºä»€ä¹ˆå€¼å¾—ç”¨ TSï¼Ÿ</h2>
<ul>
<li><strong>æå‰æš´éœ²é—®é¢˜</strong>ï¼šå†™ä»£ç æ—¶å°±çŸ¥é“å“ªé‡Œä¼ å‚é”™äº†ï¼›</li>
<li><strong>è‡ªåŠ¨æ–‡æ¡£</strong>ï¼šé¼ æ ‡æ‚¬åœå°±èƒ½çœ‹åˆ°å‡½æ•°ç­¾åå’Œå­—æ®µè¯´æ˜ï¼›</li>
<li><strong>é‡æ„å®‰å…¨</strong>ï¼šæ”¹ä¸€ä¸ªæ¥å£ï¼Œæ‰€æœ‰ç”¨åˆ°çš„åœ°æ–¹éƒ½ä¼šæç¤ºæ›´æ–°ï¼›</li>
<li><strong>å›¢é˜Ÿåä½œå‹å¥½</strong>ï¼šåˆ«äººçœ‹ä½ çš„ç»„ä»¶ï¼Œä¸€çœ¼å°±çŸ¥é“è¦ä¼ ä»€ä¹ˆã€‚</li>
</ul>
<p>è¿™ä¸ª Todo åº”ç”¨è™½ç„¶ç®€å•ï¼Œä½†ç”¨ TS å†™å®Œåï¼Œæ„Ÿè§‰æ•´ä¸ªé¡¹ç›®â€œç¨³â€äº†å¾ˆå¤šã€‚ä»¥åå†åšå¤§é¡¹ç›®ï¼Œæˆ‘è‚¯å®šä¼šé¦–é€‰ TypeScript â€”â€” å®ƒä¸æ˜¯å¢åŠ è´Ÿæ‹…ï¼Œè€Œæ˜¯å¸®æˆ‘ä»¬å†™å‡ºæ›´å¹²å‡€ã€æ›´å¯é çš„ä»£ç ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ URL åï¼Œé¡µé¢æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥æ˜¾ç¤ºå‡ºæ¥çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598480267217993762</link>    <guid>https://juejin.cn/post/7598480267217993762</guid>    <pubDate>2026-01-24T10:05:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480267217993762" data-draft-id="7598490039488806947" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ URL åï¼Œé¡µé¢æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥æ˜¾ç¤ºå‡ºæ¥çš„ï¼Ÿ"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-24T10:05:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="swipe"/> <meta itemprop="url" content="https://juejin.cn/user/858052674727959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ URL åï¼Œé¡µé¢æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥æ˜¾ç¤ºå‡ºæ¥çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/858052674727959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    swipe
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:05:32.000Z" title="Sat Jan 24 2026 10:05:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>å‰ç«¯é¢è¯• 100% ä¼šè¢«é—®åˆ°çš„é—®é¢˜</strong>ï¼Œ<br/>
ä½†ä¹Ÿæ˜¯ä¸€ä¸ª<strong>90% çš„äººç­”ä¸å®Œæ•´çš„é—®é¢˜</strong>ã€‚</p>
</blockquote>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼š</p>
<ul>
<li>â€œDNS è§£æâ€</li>
<li>â€œè¯·æ±‚ HTMLâ€</li>
<li>â€œè§£æ DOMâ€</li>
<li>â€œæ¸²æŸ“é¡µé¢â€</li>
</ul>
<p>ğŸ‘‰ <strong>ä½†å¦‚æœç»§ç»­è¿½é—®ï¼š</strong></p>
<ul>
<li>CSS ä¸ºä»€ä¹ˆä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ</li>
<li>JS ä¸ºä»€ä¹ˆä¼šå¡ä½é¡µé¢ï¼Ÿ</li>
<li>å›æµå’Œé‡ç»˜åˆ°åº•å·®åœ¨å“ªï¼Ÿ</li>
<li>æµè§ˆå™¨å†…æ ¸åˆ°åº•åœ¨å¹²å˜›ï¼Ÿ</li>
</ul>
<p>å¾ˆå¤šäººå°±å¼€å§‹â€œå‡­æ„Ÿè§‰å›ç­”äº†â€ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šç”¨<strong>å°½é‡é€šä¿—ã€ä¸å †æœ¯è¯­çš„æ–¹å¼</strong>ï¼Œå¸¦ä½ å®Œæ•´èµ°ä¸€éï¼š</p>
<blockquote>
<p><strong>ä»ä½ æ•²ä¸‹å›è½¦ï¼Œåˆ°é¡µé¢çœŸæ­£å‡ºç°åœ¨å±å¹•ä¸Šï¼Œä¸­é—´åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å…ˆç»™ç»“è®ºï¼šæµè§ˆå™¨åšäº†å“ªå‡ ä»¶å¤§äº‹ï¼Ÿ</h2>
<p>ä¸è®²ç»†èŠ‚ï¼Œ<strong>å…ˆç»™ä½ ä¸€æ¡å®Œæ•´ä¸»çº¿</strong>ğŸ‘‡</p>
<p><strong>è¾“å…¥ URL â†’ é¡µé¢å±•ç¤ºï¼Œå¤§è‡´åˆ† 9 æ­¥ï¼š</strong></p>
<ol>
<li>è§£æ URLï¼ˆåŸŸå / IPï¼‰</li>
<li>DNS è§£æï¼ˆåŸŸå â†’ IPï¼‰</li>
<li>å‘æœåŠ¡å™¨è¯·æ±‚ HTMLï¼ˆé€šå¸¸æ˜¯ index.htmlï¼‰</li>
<li>è§£æ HTMLï¼Œç”Ÿæˆ DOM Tree</li>
<li>è§£æ CSSï¼Œç”Ÿæˆ CSSOM Tree</li>
<li>DOM + CSSOM â†’ Render Tree</li>
<li>Layoutï¼ˆè®¡ç®—ä½ç½®å’Œå¤§å°ï¼‰</li>
<li>Paintï¼ˆç»˜åˆ¶åƒç´ ï¼‰</li>
<li>Compositeï¼ˆå›¾å±‚åˆæˆï¼ŒGPU åŠ é€Ÿï¼‰</li>
</ol>
<p>ä½ ç°åœ¨åªéœ€è¦è®°ä½ä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>æµè§ˆå™¨åšçš„äº‹æƒ…ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ï¼š<br/>
æŠŠâ€œä»£ç â€ä¸€æ­¥æ­¥å˜æˆâ€œåƒç´ â€ã€‚</strong></p>
</blockquote>
<p>åé¢æˆ‘ä»¬é€ä¸ªæ‹†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8f04bae5442453b88f3edc9b05019c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=J1qkoKVQw92FPLG04C%2F6rZpTGb8%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">äºŒã€URLã€åŸŸåã€IPã€DNSï¼šæµè§ˆå™¨æ˜¯æ€ä¹ˆæ‰¾åˆ°æœåŠ¡å™¨çš„ï¼Ÿ</h2>
<h3 data-id="heading-2">1ï¸âƒ£ IP æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>IP åœ°å€ = æœåŠ¡å™¨åœ¨äº’è”ç½‘ä¸Šçš„é—¨ç‰Œå·</strong></p>
</blockquote>
<p>æ¯”å¦‚ï¼š<br/>
<code>101.34.243.124</code></p>
<ul>
<li>å…¬ç½‘ IP åœ¨æ•´ä¸ªäº’è”ç½‘ä¸­æ˜¯å”¯ä¸€çš„</li>
<li>åªè¦ä½ çŸ¥é“ IPï¼Œå°±èƒ½ç›´æ¥è®¿é—®æœåŠ¡å™¨</li>
</ul>
<hr/>
<h3 data-id="heading-3">2ï¸âƒ£ é‚£ä¸ºä»€ä¹ˆè¿˜è¦åŸŸåï¼Ÿ</h3>
<p>å› ä¸º IPï¼š</p>
<ul>
<li>éš¾è®°</li>
<li>ä¸ç¬¦åˆäººç±»ç›´è§‰</li>
</ul>
<p>æ‰€ä»¥å°±æœ‰äº†ï¼š</p>
<ul>
<li><code>google.com</code></li>
<li><code>baidu.com</code></li>
<li><code>juejin.cn</code></li>
</ul>
<p>ğŸ‘‰ <strong>åŸŸåï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ IP çš„â€œåˆ«åâ€</strong></p>
<hr/>
<h3 data-id="heading-4">3ï¸âƒ£ DNS åˆ°åº•åœ¨å¹²å˜›ï¼Ÿ</h3>
<p>DNS åªå¹²ä¸€ä»¶äº‹ï¼š</p>
<blockquote>
<p><strong>æŠŠã€Œå¥½è®°çš„åŸŸåã€ç¿»è¯‘æˆã€ŒçœŸå®çš„ IP åœ°å€ã€</strong></p>
</blockquote>
<p>æµç¨‹éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs">ä½ è¾“å…¥ juejin.cn
â†“
DNS æŸ¥è¯¢
â†“
å¾—åˆ°ä¸€ä¸ª IP
â†“
æµè§ˆå™¨å»è¿™ä¸ª IP å¯¹åº”çš„æœåŠ¡å™¨è¯·æ±‚èµ„æº
</code></pre>
<hr/>
<h3 data-id="heading-5">4ï¸âƒ£ å…¬ç½‘ IP å’Œç§æœ‰ IP çš„åŒºåˆ«</h3>
<ul>
<li>
<p><strong>å…¬ç½‘ IP</strong></p>
<ul>
<li>å…¨ç½‘å”¯ä¸€</li>
<li>èƒ½è¢«å¤–éƒ¨è®¿é—®</li>
</ul>
</li>
<li>
<p><strong>ç§æœ‰ IP</strong></p>
<ul>
<li>åªåœ¨å±€åŸŸç½‘å†…æœ‰æ•ˆ</li>
<li>å­¦æ ¡ / å…¬å¸ / å®¶åº­å¸¸è§</li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85e52b58adfb4981974c82e59ffcb605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=PXe1%2BJwbunYuc5lP8RkfJOe07Po%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ä¸ºä»€ä¹ˆæµè§ˆå™¨ä¸€ä¸Šæ¥å°±è¯·æ±‚ index.htmlï¼Ÿ</h2>
<p>ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p><strong>æˆ‘æ˜æ˜åªè¾“å…¥äº†åŸŸåï¼Œ<br/>
ä¸ºä»€ä¹ˆæœåŠ¡å™¨çŸ¥é“è¦è¿”å› index.htmlï¼Ÿ</strong></p>
</blockquote>
<p>åŸå› å¾ˆç®€å•ï¼š</p>
<ul>
<li>æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨å</li>
<li><strong>é»˜è®¤è¯·æ±‚ä¸€ä¸ªå…¥å£æ–‡ä»¶</strong></li>
<li>è¿™ä¸ªæ–‡ä»¶å‡ ä¹æ°¸è¿œå«ï¼š<code>index.html</code></li>
</ul>
<p>æ‰€ä»¥ä½ ä¼šå‘ç°ï¼š</p>
<ul>
<li>Vue / React é¡¹ç›®æœ€ç»ˆéƒ½ä¼šæ‰“åŒ…å‡º <code>index.html</code></li>
<li>æœåŠ¡å™¨éƒ¨ç½²çš„ï¼Œå…¶å®æ˜¯ä¸€å †<strong>é™æ€èµ„æº</strong></li>
<li><strong>HTML æ˜¯ä¸€åˆ‡æ¸²æŸ“çš„èµ·ç‚¹</strong></li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€æµè§ˆå™¨å†…æ ¸åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè€çˆ±è¢«é—®ï¼Ÿ</h2>
<p>å¾ˆå¤šäººä¼šè¯´ï¼š</p>
<ul>
<li>Chrome æ˜¯ Blink å†…æ ¸</li>
<li>Firefox æ˜¯ Gecko</li>
<li>Safari æ˜¯ WebKit</li>
</ul>
<p>é‚£<strong>å†…æ ¸åˆ°åº•æ˜¯å•¥ï¼Ÿ</strong></p>
<p>ä¸€å¥è¯è§£é‡Šï¼š</p>
<blockquote>
<p><strong>æµè§ˆå™¨å†…æ ¸ = è´Ÿè´£è§£æ HTML / CSS / JSï¼Œå¹¶æŠŠé¡µé¢æ¸²æŸ“å‡ºæ¥çš„æ ¸å¿ƒæ¨¡å—</strong></p>
</blockquote>
<p>ä¹Ÿå«ï¼š<strong>æ¸²æŸ“å¼•æ“ï¼ˆRendering Engineï¼‰</strong></p>
<p>å¸¸è§å…³ç³»ğŸ‘‡</p>

























<table><thead><tr><th>æµè§ˆå™¨</th><th>å†…æ ¸</th></tr></thead><tbody><tr><td>Chrome / Edge / Opera</td><td>Blink</td></tr><tr><td>Safari</td><td>WebKit</td></tr><tr><td>Firefox</td><td>Gecko</td></tr><tr><td>IE</td><td>Tridentï¼ˆå·²æ·˜æ±°ï¼‰</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c440a761a034de9969cac51f6993c38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=av670HMlg8J%2Fu0Y78iKonDBiUjU%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-8">äº”ã€æµè§ˆå™¨æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥æŠŠé¡µé¢â€œç”»â€å‡ºæ¥çš„ï¼Ÿ</h2>
<p>è¿™ä¸€éƒ¨åˆ†æ˜¯<strong>æ•´ä¸ªé—®é¢˜çš„æ ¸å¿ƒ</strong>ã€‚</p>
<h3 data-id="heading-9">1ï¸âƒ£ è§£æ HTML â†’ DOM Tree</h3>
<ul>
<li>HTML ä¼šè¢«æ‹†æˆä¸€ä¸ªä¸ªæ ‡ç­¾</li>
<li>æ ‡ç­¾ä¼šè¢«è½¬æ¢æˆèŠ‚ç‚¹</li>
<li>æœ€ç»ˆå½¢æˆä¸€æ£µ <strong>DOM æ ‘</strong></li>
</ul>
<p>ğŸ‘‰ DOM æ ‘æè¿°çš„æ˜¯ï¼š<strong>é¡µé¢çš„ç»“æ„</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a04f12e9a5bf46639563f2ed78e01ac9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=t6ZCS7IuHq%2BXN6WrD49%2FLOT08iw%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-10">2ï¸âƒ£ è§£æ CSS â†’ CSSOM Tree</h3>
<ul>
<li>é‡åˆ° <code>&lt;link&gt;</code>ï¼Œæµè§ˆå™¨ä¼šä¸‹è½½ CSS</li>
<li>CSS ä¼šè¢«è§£ææˆ <strong>CSSOM æ ‘</strong></li>
</ul>
<p>âš ï¸ <strong>é‡ç‚¹æ¥äº†ï¼š</strong></p>
<blockquote>
<p>CSS <strong>ä¸ä¼šé˜»å¡ DOM çš„è§£æ</strong><br/>
ä½† <strong>ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“</strong></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/378c447f89024015a6e40b7fceac7c96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=JnT263Cl6QPKUveRMuKxB7Exp7k%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-11">3ï¸âƒ£ DOM + CSSOM â†’ Render Tree</h3>
<ul>
<li>Render Tree åªåŒ…å«<strong>éœ€è¦æ˜¾ç¤ºçš„èŠ‚ç‚¹</strong></li>
<li><code>display: none</code> çš„å…ƒç´ ä¸ä¼šè¿›å…¥æ¸²æŸ“æ ‘</li>
</ul>
<p>ğŸ‘‰ Render Tree æè¿°çš„æ˜¯ï¼š<strong>é¡µé¢çœŸæ­£è¦ç”»ä»€ä¹ˆ</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cf580ed72314737b8147df11bca4fba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=MqZtx1Suv2uDZR2bAuM0izzZDII%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-12">4ï¸âƒ£ Layoutï¼šè®¡ç®—ä½ç½®å’Œå¤§å°</h3>
<blockquote>
<p><strong>Layout é˜¶æ®µï¼Œæµè§ˆå™¨ä¼šè®¡ç®—ï¼š<br/>
æ¯ä¸ªå…ƒç´ åœ¨å“ªï¼Ÿå¤šå¤§ï¼Ÿ</strong></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c35bf2c18ba4d799214a92f2279491a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=aKN3YvkFo7TheBHKvL7zoGpYLKM%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-13">5ï¸âƒ£ Paintï¼šçœŸæ­£å¼€å§‹ç”»äº†</h3>
<blockquote>
<p>æŠŠå¸ƒå±€ç»“æœï¼Œè½¬æ¢ä¸ºå±å¹•ä¸Šçš„åƒç´ </p>
</blockquote>
<hr/>
<h3 data-id="heading-14">6ï¸âƒ£ Compositeï¼šå›¾å±‚åˆæˆï¼ˆæ€§èƒ½å…³é”®ï¼‰</h3>
<ul>
<li>é¡µé¢ä¼šè¢«æ‹†æˆå¤šä¸ªå›¾å±‚</li>
<li>GPU å‚ä¸åˆæˆ</li>
<li>transform / opacity / video ç­‰ä¼šåˆ›å»ºæ–°å›¾å±‚</li>
</ul>
<p>ğŸ‘‰ <strong>åˆç†ä½¿ç”¨èƒ½æå‡æ€§èƒ½ï¼Œæ»¥ç”¨ä¼šåƒå†…å­˜</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/839ac5204f8f49b3aaf3d4f51c5fbf59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769853932&amp;x-signature=xEQiWB9PtEt9Oyo975Wy2i7XFWE%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-15">å…­ã€å›æµ &amp; é‡ç»˜ï¼šä¸ºä»€ä¹ˆé¡µé¢ä¼šå¡ï¼Ÿ</h2>
<h3 data-id="heading-16">ğŸ” å›æµï¼ˆReflowï¼‰</h3>
<p>ä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>å…ƒç´ çš„ä½ç½®æˆ–å°ºå¯¸å‘ç”Ÿå˜åŒ–</strong></p>
</blockquote>
<p>å¸¸è§è§¦å‘åœºæ™¯ï¼š</p>
<ul>
<li>æ”¹ width / height</li>
<li>æ”¹ position / display</li>
<li>DOM ç»“æ„å˜åŒ–</li>
<li>è¯»å–å¸ƒå±€ä¿¡æ¯ï¼ˆå¦‚ <code>getComputedStyle</code>ï¼‰</li>
</ul>
<p>âš ï¸ <strong>å›æµä¸€å®šä¼šè§¦å‘é‡ç»˜</strong></p>
<hr/>
<h3 data-id="heading-17">ğŸ¨ é‡ç»˜ï¼ˆRepaintï¼‰</h3>
<p>ä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>åªæ”¹å¤–è§‚ï¼Œä¸æ”¹å¸ƒå±€</strong></p>
</blockquote>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>color</li>
<li>background-color</li>
<li>box-shadow</li>
<li>opacity</li>
</ul>
<p>ğŸ‘‰ æˆæœ¬æ¯”å›æµå°å¾—å¤š</p>
<hr/>
<h3 data-id="heading-18">ğŸš€ å¸¸è§æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ul>
<li>ä¸€æ¬¡æ€§ä¿®æ”¹æ ·å¼ï¼ˆclass / cssTextï¼‰</li>
<li>å‡å°‘ DOM æ“ä½œ</li>
<li>é¿å…é¢‘ç¹è¯»å–å¸ƒå±€ä¿¡æ¯</li>
<li>åˆç†ä½¿ç”¨ <code>position: absolute / fixed</code></li>
<li>è°¨æ…åˆ›å»ºåˆæˆå±‚</li>
</ul>
<hr/>
<h2 data-id="heading-19">ä¸ƒã€æœ€åç”¨ä¸€å¥è¯æ€»ç»“</h2>
<blockquote>
<p><strong>æµè§ˆå™¨æ¸²æŸ“çš„æœ¬è´¨å°±æ˜¯ï¼š</strong><br/>
<strong>HTML â†’ DOM â†’ CSSOM â†’ Render Tree â†’ Layout â†’ Paint â†’ Composite</strong></p>
</blockquote>
<p>å¦‚æœä½ çœŸæ­£ç†è§£äº†è¿™æ¡é“¾è·¯ï¼š</p>
<ul>
<li>ç™½å±é—®é¢˜</li>
<li>é¡µé¢å¡é¡¿</li>
<li>åŠ¨ç”»æ‰å¸§</li>
<li>script / link é˜»å¡</li>
<li>å›æµ &amp; é‡ç»˜ä¼˜åŒ–</li>
</ul>
<p>éƒ½ä¼šå˜å¾—<strong>éå¸¸æ¸…æ™°</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-20">ä¸‹ç¯‡é¢„å‘Š</h2>
<p>è¿™ç¯‡æˆ‘ä»¬è®²çš„æ˜¯ï¼š</p>
<blockquote>
<p><strong>æµè§ˆå™¨ &amp; æ¸²æŸ“å¼•æ“</strong></p>
</blockquote>
<p>ä½†è¿˜æœ‰ä¸€ä¸ªä¸»è§’æ²¡ç™»åœºï¼š</p>
<blockquote>
<p>ğŸ‘‰ <strong>JavaScript å¼•æ“ï¼ˆV8ï¼‰</strong></p>
</blockquote>
<p>ä¸‹ç¯‡ä¼šèŠï¼š</p>
<ul>
<li>JS æ˜¯è°æ‰§è¡Œçš„ï¼Ÿ</li>
<li>JS ä¸ºä»€ä¹ˆä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ</li>
<li>æµè§ˆå™¨å†…æ ¸å’Œ JS å¼•æ“çš„å…³ç³»ï¼Ÿ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScriptï¼šä¸º JavaScript æ³¨å…¥ç±»å‹å®‰å…¨çš„å·¥ç¨‹åŒ–åŠ›é‡]]></title>    <link>https://juejin.cn/post/7598499504171073574</link>    <guid>https://juejin.cn/post/7598499504171073574</guid>    <pubDate>2026-01-24T09:46:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598499504171073574" data-draft-id="7598499504171057190" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScriptï¼šä¸º JavaScript æ³¨å…¥ç±»å‹å®‰å…¨çš„å·¥ç¨‹åŒ–åŠ›é‡"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-24T09:46:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Zyx2007"/> <meta itemprop="url" content="https://juejin.cn/user/3924597867554890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScriptï¼šä¸º JavaScript æ³¨å…¥ç±»å‹å®‰å…¨çš„å·¥ç¨‹åŒ–åŠ›é‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3924597867554890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Zyx2007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:46:14.000Z" title="Sat Jan 24 2026 09:46:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>JavaScript ä»¥å…¶çµæ´»ã€åŠ¨æ€çš„ç‰¹æ€§æˆä¸º Web å¼€å‘çš„åŸºçŸ³ï¼Œä½†è¿™ç§â€œè‡ªç”±â€åœ¨å¤§å‹é¡¹ç›®ä¸­å¾€å¾€æ¼”å˜ä¸ºéšæ‚£ã€‚å½“å‡½æ•°å‚æ•°ç±»å‹ä¸æ˜ã€å¯¹è±¡ç»“æ„éšæ„æ‰©å±•ã€å˜é‡ç”¨é€”æ¨¡ç³Šä¸æ¸…æ—¶ï¼Œä»£ç ä¾¿å¦‚åŒæ²¡æœ‰æŠ¤æ çš„æ‚¬å´–â€”â€”çœ‹ä¼¼ç•…é€šæ— é˜»ï¼Œå®åˆ™å±æœºå››ä¼ã€‚TypeScriptï¼ˆTSï¼‰ä½œä¸º JavaScript çš„è¶…é›†ï¼Œé€šè¿‡å¼•å…¥<strong>é™æ€ç±»å‹ç³»ç»Ÿ</strong>ï¼Œåœ¨ä¿ç•™ JS çµæ´»æ€§çš„åŒæ—¶ï¼Œä¸ºå¼€å‘è€…æ„å»ºèµ·ä¸€é“åšå›ºçš„è´¨é‡é˜²çº¿ã€‚</p>
<h2 data-id="heading-0">å¼±ç±»å‹çš„ä»£ä»·ï¼šéšè—åœ¨â€œç®€å•â€èƒŒåçš„é™·é˜±</h2>
<p>JavaScript æ˜¯åŠ¨æ€å¼±ç±»å‹è¯­è¨€ï¼Œå˜é‡ç±»å‹åœ¨è¿è¡Œæ—¶æ‰ç¡®å®šã€‚è¿™ä½¿å¾—ä»¥ä¸‹ä»£ç åˆæ³•å´å±é™©ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">function</span> <span class="hljs-keyword">add</span>(a, b) {
  <span class="hljs-keyword">return</span> a <span class="hljs-operator">+</span> b;
}
const <span class="hljs-keyword">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">add</span>(<span class="hljs-number">10</span>, <span class="hljs-string">'10'</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> "1010"ï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰
</code></pre>
<p>å¼€å‘è€…æœ¬æ„æ˜¯æ•°å€¼ç›¸åŠ ï¼Œå´å› ä¼ å…¥å­—ç¬¦ä¸²å¯¼è‡´éšå¼ç±»å‹è½¬æ¢ï¼Œç»“æœå‡ºä¹æ„æ–™ã€‚è¿™ç±»â€œäºŒä¹‰æ€§â€é”™è¯¯åœ¨å°å‹è„šæœ¬ä¸­æˆ–è®¸æ— ä¼¤å¤§é›…ï¼Œä½†åœ¨å¤æ‚ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œå¯èƒ½å¼•å‘éš¾ä»¥è¿½è¸ªçš„ bugã€‚</p>
<h2 data-id="heading-1">TypeScript çš„è§£æ³•ï¼šç¼–è¯‘æœŸç±»å‹æ£€æŸ¥</h2>
<p>TypeScript é€šè¿‡ç±»å‹æ³¨è§£ï¼Œåœ¨<strong>ä»£ç ç¼–å†™å’Œç¼–è¯‘é˜¶æ®µ</strong>å°±æ•è·æ½œåœ¨é”™è¯¯ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addTs</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a + b;
}
<span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">addTs</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>); <span class="hljs-comment">// æ­£ç¡®</span>
<span class="hljs-comment">// addTs(10, '10'); // ç¼–è¯‘æŠ¥é”™ï¼šArgument of type 'string' is not assignable to parameter of type 'number'.</span>
</code></pre>
<p>ç±»å‹ç­¾å <code>a: number</code> æ˜ç¡®çº¦æŸäº†å‚æ•°ç±»å‹ï¼Œç¼–è¾‘å™¨ä¼šç«‹å³æç¤ºé”™è¯¯ï¼Œæ— éœ€ç­‰åˆ°è¿è¡Œæ—¶æ‰å‘ç°é—®é¢˜ã€‚è¿™ç§â€œæ—©å‘ç°ã€æ—©ä¿®å¤â€çš„æœºåˆ¶ï¼Œæå¤§æå‡äº†ä»£ç å¥å£®æ€§ã€‚</p>
<h2 data-id="heading-2">åŸºç¡€ç±»å‹ä¸ç±»å‹æ¨å¯¼</h2>
<p>TS æä¾›ä¸°å¯Œçš„å†…ç½®ç±»å‹ï¼Œå¹¶æ”¯æŒç±»å‹è‡ªåŠ¨æ¨å¯¼ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'hello'</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> <span class="hljs-attr">user</span>: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>, <span class="hljs-built_in">boolean</span>] = [<span class="hljs-number">1</span>, <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-literal">true</span>]; <span class="hljs-comment">// å…ƒç»„</span>
</code></pre>
<p>å³ä½¿çœç•¥æ˜¾å¼æ³¨è§£ï¼ŒTS ä¹Ÿèƒ½æ ¹æ®åˆå§‹å€¼æ¨æ–­ç±»å‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">count</span> = <span class="hljs-number">100</span><span class="hljs-comment">; // è‡ªåŠ¨æ¨å¯¼ä¸º number</span>
// <span class="hljs-attr">count</span> = <span class="hljs-string">'100'</span><span class="hljs-comment">; // é”™è¯¯ï¼ä¸èƒ½å°† string èµ‹å€¼ç»™ number</span>
</code></pre>
<p>è¿™ç§â€œå†™å¾—å°‘ï¼Œæ£€æŸ¥å¤šâ€çš„ä½“éªŒï¼Œè®©å¼€å‘è€…æ—¢èƒ½äº«å—ç®€æ´è¯­æ³•ï¼Œåˆä¸å¤±ç±»å‹å®‰å…¨ã€‚</p>
<h2 data-id="heading-3">æ¥å£ä¸è‡ªå®šä¹‰ç±»å‹ï¼šæè¿°å¤æ‚ç»“æ„</h2>
<p>å¯¹äºå¯¹è±¡ï¼ŒTS æä¾› <code>interface</code> å’Œ <code>type</code> æ¥å®šä¹‰ç»“æ„å¥‘çº¦ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUser</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// åªè¯»å±æ€§</span>
  hobby?: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// å¯é€‰å±æ€§</span>
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">user3</span>: <span class="hljs-title class_">IUser</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">id</span>: <span class="hljs-number">1001</span>
};
<span class="hljs-comment">// user3.id = 1002; // é”™è¯¯ï¼id æ˜¯åªè¯»çš„</span>
</code></pre>
<p>æ¥å£æ¸…æ™°è¡¨è¾¾äº†å¯¹è±¡åº”å…·å¤‡çš„å­—æ®µåŠå…¶çº¦æŸï¼Œä¸ä»…é˜²æ­¢éæ³•èµ‹å€¼ï¼Œè¿˜ä¸º IDE æä¾›ç²¾å‡†çš„æ™ºèƒ½æç¤ºå’Œæ–‡æ¡£æŸ¥çœ‹èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-4">è”åˆç±»å‹ä¸æ³›å‹ï¼šåº”å¯¹å¤šæ ·æ€§ä¸å¤ç”¨</h2>
<p>TS æ”¯æŒè”åˆç±»å‹å¤„ç†å¤šå¯èƒ½æ€§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">type <span class="hljs-attr">ID</span> = string | number<span class="hljs-comment">;</span>
let id: <span class="hljs-attr">ID</span> = <span class="hljs-number">1001</span><span class="hljs-comment">;</span>
<span class="hljs-attr">id</span> = <span class="hljs-string">'user_001'</span><span class="hljs-comment">; // åˆæ³•</span>
</code></pre>
<p>è€Œæ³›å‹åˆ™å®ç°ç±»å‹çº§åˆ«çš„å‚æ•°åŒ–ï¼Œæå‡ç»„ä»¶å¤ç”¨æ€§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">arr2</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>];
<span class="hljs-comment">// æˆ–ç®€å†™ä¸º string[]</span>
</code></pre>
<p>æ³›å‹è®©å‡½æ•°ã€ç±»ã€æ¥å£èƒ½é€‚ç”¨äºå¤šç§ç±»å‹ï¼ŒåŒæ—¶ä¿æŒç±»å‹å®‰å…¨ï¼Œæ˜¯æ„å»ºé€šç”¨åº“çš„æ ¸å¿ƒå·¥å…·ã€‚</p>
<h2 data-id="heading-5">å®‰å…¨çš„æœªçŸ¥ç±»å‹ï¼šunknown vs any</h2>
<p>é¢å¯¹ä¸ç¡®å®šçš„ç±»å‹ï¼ŒTS æä¾› <code>unknown</code> ä½œä¸ºæ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let bb: <span class="hljs-attr">unknown</span> = <span class="hljs-number">10</span><span class="hljs-comment">;</span>
<span class="hljs-attr">bb</span> = <span class="hljs-string">'hello'</span><span class="hljs-comment">;</span>
// bb.toUpperCase()<span class="hljs-comment">; // é”™è¯¯ï¼éœ€å…ˆç±»å‹æ£€æŸ¥</span>
if (typeof <span class="hljs-attr">bb</span> === <span class="hljs-string">'string'</span>) {
  console.log(bb.toUpperCase())<span class="hljs-comment">; // å®‰å…¨è°ƒç”¨</span>
}
</code></pre>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>any</code> ä¼šå®Œå…¨ç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè™½å¯ä½œä¸ºè¿ç§»æ—§ä»£ç çš„â€œæ•‘å‘½ç¨»è‰â€ï¼Œä½†åº”å°½é‡é¿å…åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-6">å·¥ç¨‹ä»·å€¼ï¼šä¸æ­¢äºé˜²é”™</h2>
<p>TypeScript çš„ä¼˜åŠ¿è¿œè¶…é”™è¯¯é¢„é˜²ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½æç¤º</strong>ï¼šè¾“å…¥å¯¹è±¡å±æ€§æ—¶è‡ªåŠ¨è¡¥å…¨ï¼›</li>
<li><strong>é‡æ„å®‰å…¨</strong>ï¼šé‡å‘½åå˜é‡æˆ–å‡½æ•°æ—¶ï¼Œæ‰€æœ‰å¼•ç”¨åŒæ­¥æ›´æ–°ï¼›</li>
<li><strong>ä»£ç å¯¼èˆª</strong>ï¼šä¸€é”®è·³è½¬åˆ°ç±»å‹å®šä¹‰æˆ–å®ç°ï¼›</li>
<li><strong>æ–‡æ¡£å†…åµŒ</strong>ï¼šç±»å‹æœ¬èº«å°±æ˜¯æœ€å¥½çš„æ–‡æ¡£ï¼›</li>
<li><strong>åƒåœ¾æ¸…ç†</strong>ï¼šæœªä½¿ç”¨çš„å˜é‡ã€å¯¼å…¥ä¼šé«˜äº®æç¤ºã€‚</li>
</ul>
<p>è¿™äº›ç‰¹æ€§æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡ï¼Œå°¤å…¶åœ¨å›¢é˜Ÿåä½œå’Œé•¿æœŸç»´æŠ¤ä¸­ï¼Œä»·å€¼å€å¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elpis é¡¹ç›® Webpack é…ç½®è¯¦è§£]]></title>    <link>https://juejin.cn/post/7598477092197105702</link>    <guid>https://juejin.cn/post/7598477092197105702</guid>    <pubDate>2026-01-24T09:52:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598477092197105702" data-draft-id="7598477092197089318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elpis é¡¹ç›® Webpack é…ç½®è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:52:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å±…673"/> <meta itemprop="url" content="https://juejin.cn/user/64206909220720"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elpis é¡¹ç›® Webpack é…ç½®è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/64206909220720/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å±…673
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:52:07.000Z" title="Sat Jan 24 2026 09:52:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Elpis é¡¹ç›® Webpack é…ç½®è¯¦è§£</h2>
<p>æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»äº† Elpis é¡¹ç›®çš„ Webpack 5 æ„å»ºç³»ç»Ÿè®¾ç½®ï¼Œæ¶µç›–äº†ä»åŸºç¡€é…ç½®åˆ°ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<h3 data-id="heading-1">ğŸ—ï¸ 1. æ ¸å¿ƒæ¶æ„</h3>
<p>é¡¹ç›®é‡‡ç”¨ åˆ†å±‚é…ç½® æ¨¡å¼ï¼Œé€šè¿‡ webpack-merge ç»„åˆé…ç½®ï¼š</p>
<p>webpack.base.js: åŸºç¡€é…ç½®ï¼ŒåŒ…å«å…¥å£ã€è§£æè·¯å¾„ã€å…¬ç”¨ Loader å’Œæ’ä»¶ã€‚</p>
<p>webpack.prod.js: ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼Œä¾§é‡äºæ€§èƒ½ä¼˜åŒ–ã€ä»£ç åˆ†å‰²å’Œèµ„æºå‹ç¼©ã€‚</p>
<p>webpack.dev.js: å¼€å‘ç¯å¢ƒé…ç½®ï¼Œä¾§é‡äºå¼€å‘ä½“éªŒã€çƒ­æ›´æ–°å’Œè°ƒè¯•æ”¯æŒã€‚</p>
<h3 data-id="heading-2">ğŸ“¦ 2. åŸºç¡€é…ç½®è¯´æ˜ (webpack.base.js)</h3>
<h5 data-id="heading-3">2.1 åŠ¨æ€å¤šå…¥å£ (Multi-Entry)</h5>
<p>é¡¹ç›®é€šè¿‡ glob è‡ªåŠ¨æ‰«æ app/pages/ *<em>/entry.</em> .jsï¼š</p>
<p>è‡ªåŠ¨åŒ–: æ¯å¢åŠ ä¸€ä¸ªé¡µé¢åªéœ€æŒ‰ç…§å‘½åè§„èŒƒåˆ›å»ºå…¥å£æ–‡ä»¶ï¼ŒWebpack ä¼šè‡ªåŠ¨è¯†åˆ«ã€‚</p>
<p>æ¨¡æ¿å…³è”: åˆ©ç”¨ HtmlWebpackPlugin ä¸ºæ¯ä¸ªå…¥å£ç”Ÿæˆå¯¹åº”çš„ .tpl æ¨¡æ¿æ–‡ä»¶ã€‚</p>
<h5 data-id="heading-4">2.2 æ ¸å¿ƒ Loader è§„åˆ™</h5>
<p>Vue æ”¯æŒ: ä½¿ç”¨ vue-loader å¤„ç† .vue æ–‡ä»¶ã€‚</p>
<p>JS è½¬è¯‘: babel-loader å¤„ç† ES6+ è¯­æ³•ï¼ŒèŒƒå›´é”å®šåœ¨ ./app/pages ä»¥æå‡é€Ÿåº¦ã€‚</p>
<p>æ ·å¼å¤„ç†:</p>
<p>æ”¯æŒ css å’Œ lessã€‚</p>
<p>ç”Ÿäº§ç¯å¢ƒä¸‹æ ·å¼ä¼šè¢«æå–åˆ°ç‹¬ç«‹æ–‡ä»¶ï¼Œå¼€å‘ç¯å¢ƒä¸‹é€šè¿‡ style-loader å†…è”ã€‚</p>
<p>èµ„äº§æ¨¡å— (Asset Modules):</p>
<p>ä½¿ç”¨ Webpack 5 çš„ asset ç±»å‹ï¼ˆæ›¿ä»£ url-loaderï¼‰ã€‚</p>
<p>å†…è”ç­–ç•¥: å°äº 8KB çš„å›¾ç‰‡è‡ªåŠ¨è½¬ä¸º Base64 ä»¥å‡å°‘ HTTP è¯·æ±‚ã€‚</p>
<h5 data-id="heading-5">2.3 è§£æä¸å¿«æ·è·¯å¾„ (Resolve)</h5>
<p>åˆ«åé…ç½®: @pages: app/pages</p>
<p>@common: app/pages/common</p>
<p>@widgets: app/pages/widgets</p>
<p>@store: app/pages/store</p>
<h4 data-id="heading-6">ğŸš€ 3. ç”Ÿäº§ç¯å¢ƒä¼˜åŒ– (webpack.prod.js)</h4>
<h5 data-id="heading-7">3.1 æ„å»ºåŠ é€Ÿ (Speed)</h5>
<p>å¤šè¿›ç¨‹æ‰“åŒ… (HappyPack): åˆ©ç”¨å¤šæ ¸ CPU å¹¶è¡Œå¤„ç† JS å’Œ CSS è½¬è¯‘ã€‚</p>
<p>ä»£ç å‹ç¼©: TerserWebpackPlugin å¼€å¯å¹¶è¡Œå‹ç¼©ï¼Œå¹¶ç§»é™¤ç”Ÿäº§ç¯å¢ƒçš„ console.logã€‚</p>
<h5 data-id="heading-8">3.2 èµ„æºä¼˜åŒ– (Asset Optimization)</h5>
<p>ä»£ç åˆ†å‰² (Code Splitting):</p>
<p>vendor: ç‹¬ç«‹æ‰“åŒ…ç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆaxios, lodash ç­‰ï¼‰ã€‚</p>
<p>common: æå–è¢«å¤šæ¬¡å¼•ç”¨çš„ä¸šåŠ¡å…¬å…±æ¨¡å—ã€‚</p>
<p>runtimeChunk: æå– Webpack è¿è¡Œæ—¶ä»£ç ï¼Œç¡®ä¿é•¿æ•ˆç¼“å­˜ã€‚</p>
<p>CSS æå–: ä½¿ç”¨ MiniCssExtractPlugin æå–æ ·å¼ï¼Œé…åˆ CSSMinimizerPlugin è¿›è¡Œå‹ç¼©ã€‚</p>
<h5 data-id="heading-9">3.3 ç›®å½•æ¸…ç†</h5>
<p>é…ç½®äº† CleanWebpackPluginï¼Œä¿è¯æ¯æ¬¡ build äº§ç‰©ç›®å½•éƒ½æ˜¯å¹²å‡€çš„ã€‚</p>
<h4 data-id="heading-10">ğŸŒ— 4. å¼€å‘ç¯å¢ƒ vs ç”Ÿäº§ç¯å¢ƒæ·±åº¦å¯¹æ¯”</h4>
<p>ç‰¹æ€§ å¼€å‘ç¯å¢ƒ (Development) ç”Ÿäº§ç¯å¢ƒ (Production)</p>
<p>æ ¸å¿ƒç›®æ ‡ æè‡´çš„å¼€å‘ä½“éªŒä¸è°ƒè¯•æ•ˆç‡ æè‡´çš„æ€§èƒ½åŠ è½½ä¸çº¿ä¸Šç¨³å®šæ€§</p>
<p>Mode mode: "development" (ä¸å‹ç¼©ï¼ŒåŸå§‹å) mode: "production" (Tree Shakingï¼Œä»£ç æ··æ·†)</p>
<p>Source Map eval-cheap-module-source-map (ä»£ç æ˜ å°„ï¼Œæ–¹ä¾¿å®šä½) é€šå¸¸ç¦ç”¨æˆ–ä½¿ç”¨ç‹¬ç«‹æ–‡ä»¶ (ä¿æŠ¤æºç ï¼Œå‡å°ä½“ç§¯)</p>
<p>HMR çƒ­æ›´æ–° å¼€å¯ã€‚ä»£ç ä¿å­˜å³ç”Ÿæ•ˆï¼Œä¸åˆ·æ–°é¡µé¢ä¸”ä¿æŒçŠ¶æ€ å…³é—­ã€‚ä»£ç å…¨é‡æ‰“åŒ…ï¼Œç”Ÿæˆç‰ˆæœ¬åŒ–é™æ€èµ„æº</p>
<p>æ ·å¼å¤„ç† å†…è”æ³¨å…¥ ï¼Œæ„å»ºé€Ÿåº¦å¿« æå–ç‹¬ç«‹ CSS æ–‡ä»¶ï¼Œå¹¶è¡Œä¸‹è½½å¹¶åˆ©ç”¨ç¼“å­˜
</p><p>æ–‡ä»¶æŒ‡çº¹ é€šå¸¸ä¸å¸¦ Hashï¼Œæˆ–ä»…å¸¦ç®€å•çš„ contenthash å¼ºç¼“å­˜ç­–ç•¥ï¼š[chunkhash:8] ç¡®ä¿ç‰ˆæœ¬ç®¡ç†ç¨³å®š</p>
<p>è°ƒè¯•ä¿¡æ¯ ä¿ç•™æ‰€æœ‰çš„ console.log å’Œæ³¨é‡Š è‡ªåŠ¨æ¸…ç†ï¼šTerser æ’ä»¶ç§»é™¤æ‰€æœ‰è°ƒè¯•è¾“å‡º</p>
<p>ç½‘ç»œè¯·æ±‚ æŒ‡å‘æœ¬åœ° DevServer (<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9002" target="_blank" title="http://localhost:9002" ref="nofollow noopener noreferrer">http://localhost:9002</a>) æŒ‡å‘ CDN æˆ–ç”Ÿäº§é™æ€èµ„æºè·¯å¾„</p>
<h4 data-id="heading-11">ğŸ› ï¸ 5. å¼€å‘ç¯å¢ƒé…ç½® (webpack.dev.js) æ·±åº¦è§£æ</h4>
<p>è¯¥æ–‡ä»¶æ˜¯å¼€å‘é˜¶æ®µçš„æ ¸å¿ƒï¼Œå…¶æ ¸å¿ƒé€»è¾‘åœ¨äºå»ºç«‹æµè§ˆå™¨ä¸æœ¬åœ°æœåŠ¡å™¨çš„é€šä¿¡å®æ—¶é“¾è·¯ã€‚</p>
<h5 data-id="heading-12">5.1 æ ¸å¿ƒä»£ç é€»è¾‘æ‹†è§£</h5>
<ol>
<li>
<h6 data-id="heading-13">åŠ¨æ€æ³¨å…¥ HMR å®¢æˆ·ç«¯</h6>
</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">Object.keys(baseConfig.entry).forEach((v) =&gt; {
 Â if (v !== "vendor") {
 Â  Â const { HOST, PORT, HMR_PATH, TIMEOUT } = DEV_SERVER_CONFIG<span class="hljs-comment">;</span>
 Â  Â baseConfig.entry<span class="hljs-section">[v]</span> = <span class="hljs-section">[
 Â  Â  Â baseConfig.entry[v]</span>,
 Â  Â  Â // å…³é”®ï¼šå‘æ¯ä¸ªä¸šåŠ¡å…¥å£æ³¨å…¥ HMR è¿è¡Œæ—¶çš„å®¢æˆ·ç«¯ä»£ç 
 Â  Â  Â `webpack-hot-middleware/client?<span class="hljs-attr">path</span>=http://<span class="hljs-variable">${HOST}</span>:<span class="hljs-variable">${PORT}</span>/<span class="hljs-variable">${HMR_PATH}</span>?timeout=<span class="hljs-variable">${TIMEOUT}</span>&amp;reload=<span class="hljs-literal">true</span>`,
 Â   ]<span class="hljs-comment">;</span>
  }
})<span class="hljs-comment">;</span>
</code></pre>
<p>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸€æ­¥ï¼Ÿ Webpack é»˜è®¤æ‰“åŒ…å‡ºæ¥çš„ JS æ˜¯é™æ€çš„ã€‚ä¸ºäº†å®ç°çƒ­æ›´æ–°ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æµè§ˆå™¨é‡Œè¿è¡Œä¸€æ®µâ€œç›‘å¬ä»£ç â€ï¼Œè¿™æ®µä»£ç é€šè¿‡ EventSource è¿æ¥åˆ°å¼€å‘æœåŠ¡å™¨ã€‚æ³¨å…¥åï¼Œæµè§ˆå™¨å°±çŸ¥é“å¦‚ä½•æ¥æ”¶æœåŠ¡å™¨å‘æ¥çš„æ›´æ–°ä¿¡å·ã€‚</p>
<ol start="2">
<li>
<h6 data-id="heading-14">è°ƒè¯•åˆ©å™¨ï¼šSource Map</h6>
</li>
</ol>
<p>devtool: "eval-cheap-module-source-map", åŸç†ï¼ševal å°†æ¯ä¸ªæ¨¡å—åŒ…è£¹åœ¨ eval å­—ç¬¦ä¸²ä¸­ï¼Œæ„å»ºæå¿«ï¼›cheap å¿½ç•¥åˆ—ä¿¡æ¯åªä¿ç•™è¡Œä¿¡æ¯ï¼›module è´Ÿè´£æŠŠ Loaderï¼ˆå¦‚ vue-loaderï¼‰å¤„ç†å‰çš„æºä»£ç æ˜ å°„å‡ºæ¥ã€‚ æ•ˆæœï¼šä½ åœ¨æµè§ˆå™¨ F12 çœ‹åˆ°çš„æ˜¯åŸæ±åŸå‘³çš„ .vue æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç¼–è¯‘åçš„ JSã€‚</p>
<ol start="3">
<li>
<h6 data-id="heading-15">HMR æ ¸å¿ƒæ’ä»¶</h6>
</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino">plugins: [
 Â <span class="hljs-keyword">new</span> <span class="hljs-built_in">HotModuleReplacementPlugin</span>(), <span class="hljs-comment">// å¼€å¯ HMR API</span>
]
</code></pre>
<p>è¿™ä¸ªæ’ä»¶ä¼šåœ¨å…¨å±€æ³¨å…¥ module.hot å¯¹è±¡ã€‚åªæœ‰æœ‰äº†è¿™ä¸ªå¯¹è±¡ï¼Œvue-loader ç­‰ç¨‹åºæ‰èƒ½è°ƒç”¨ module.hot.accept() æ¥å£æ¥å®ç°å±€éƒ¨æ›¿æ¢ã€‚</p>
<h5 data-id="heading-16">ğŸ”¥ 6. çƒ­æ›´æ–° (HMR) æ ¸å¿ƒåŸç†æ·±åº¦é˜è¿°</h5>
<p>HMR çš„æ ¸å¿ƒä¸æ˜¯â€œåˆ·æ–°â€ï¼Œè€Œæ˜¯â€œè¡¥ä¸å¼æ›¿æ¢â€ã€‚</p>
<h6 data-id="heading-17">6.1 åº•å±‚é€šä¿¡æµç¨‹</h6>
<p>Server ç«¯ (ç›‘è§†è€…): Webpack ä»¥ watch æ¨¡å¼å¯åŠ¨ã€‚å½“ä½ ä¿å­˜æ–‡ä»¶ï¼ŒWebpack é‡æ–°ç¼–è¯‘ã€‚</p>
<p>å®ƒä¸ä¼šç”Ÿæˆæ–°çš„å¤§æ–‡ä»¶ï¼Œè€Œæ˜¯ç”Ÿæˆä¸¤ä¸ªå°è¡¥ä¸ï¼šä¸€ä¸ª [hash].hot-update.jsonï¼ˆæè¿°å“ªäº›æ¨¡å—å˜äº†ï¼‰å’Œä¸€ä¸ª [chunk].[hash].hot-update.jsï¼ˆå…·ä½“çš„å˜åŒ–ä»£ç ï¼‰ã€‚</p>
<p>Middleware (å¿«é€’å‘˜): webpack-hot-middleware é€šè¿‡ä¸€æ¡é•¿è¿æ¥ï¼ˆEventSource/WebSocketï¼‰æ¨é€ä¸€ä¸ªæ¶ˆæ¯ç»™æµè§ˆå™¨ï¼šâ€œæ–°ç‰ˆæœ¬ Hash æ˜¯ XXXâ€ã€‚</p>
<p>Client ç«¯ (æ¥æ”¶è€…): æµè§ˆå™¨é‡Œçš„ HMR Runtime æ”¶åˆ° Hashã€‚</p>
<p>æ¯”å¯¹ï¼šå‘ç°å’Œå½“å‰ Hash ä¸åŒã€‚</p>
<p>ä¸‹è½½æ¸…å•ï¼šå…ˆä¸‹ .json æ–‡ä»¶ç¡®è®¤æœ‰å“ªäº›æ¨¡å—æ›´æ–°äº†ã€‚</p>
<p>è½½å…¥è¡¥ä¸ï¼šåŠ¨æ€åˆ›å»º 
</p><p>Runtime (æ–½å·¥å‘˜):</p>
<p>æŸ¥æ‰¾æ¥å£ï¼šWebpack è¿è¡Œç¯å¢ƒä¼šæŸ¥æ‰¾ä»£ç ä¸­æ˜¯å¦å®šä¹‰äº† module.hot.acceptã€‚</p>
<p>ä»£ç æ›¿æ¢ï¼šå¦‚æœå®šä¹‰äº†ï¼ˆVue å’Œ React çš„ Loader éƒ½ä¼šè‡ªåŠ¨å¸®ä½ åŠ ä¸Šï¼‰ï¼Œå®ƒä¼šæŠŠå†…å­˜ä¸­æ—§çš„æ¨¡å—å®šä¹‰åˆ æ‰ï¼Œæ¢æˆè¡¥ä¸é‡Œçš„æ–°å®šä¹‰ï¼Œå¹¶é‡æ–°æ‰§è¡Œè¯¥æ¨¡å—ã€‚</p>
<h5 data-id="heading-18">ğŸ• 7. ä»£ç åˆ†å‰²</h5>
<p>ä»£ç åˆ†å‰²æ˜¯ Webpack ä¼˜åŒ–ä¸­æœ€å…³é”®çš„ä¸€ç¯ã€‚æ ¸å¿ƒç›®æ ‡æ˜¯ï¼šä¸è¦è®©ç”¨æˆ·ä¸€æ¬¡æ€§ä¸‹è½½ä¸€ä¸ªè¶…å¤§çš„ JS æ–‡ä»¶ï¼Œè€Œæ˜¯å°†å…¶æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ï¼ŒæŒ‰éœ€åŠ è½½æˆ–åˆ©ç”¨å¹¶å‘ä¸‹è½½ã€‚</p>
<h6 data-id="heading-19">7.1 ä¸ºä»€ä¹ˆè¦è¿›è¡Œä»£ç åˆ†å‰²ï¼Ÿ</h6>
<p>åˆ©ç”¨å¹¶å‘ä¸‹è½½ï¼šæµè§ˆå™¨å¯ä»¥åŒæ—¶ä¸‹è½½å¤šä¸ªå°æ–‡ä»¶ï¼Œæ¯”ä¸‹è½½ä¸€ä¸ªå¤§æ–‡ä»¶å¿«ã€‚</p>
<p>ç¼“å­˜ï¼šå°†å‡ ä¹ä¸åŠ¨çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆVue, Lodashï¼‰å’Œç»å¸¸å˜åŠ¨çš„ä¸šåŠ¡ä»£ç åˆ†å¼€ã€‚å½“ä½ æ”¹äº†ä¸šåŠ¡ä»£ç ï¼Œç”¨æˆ·åªéœ€è¦é‡æ–°ä¸‹è½½å‡  KB çš„ä¸šåŠ¡åŒ…ï¼Œè€Œå‡ å MB çš„ç¬¬ä¸‰æ–¹åº“ä¾</p>
<p>ç„¶ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚</p>
<p>æŒ‰éœ€åŠ è½½ï¼šåªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç ï¼Œå‡å°‘é¦–å±è´Ÿæ‹…ã€‚</p>
<h6 data-id="heading-20">7.2 é¡¹ç›®ä¸­çš„ SplitChunks é…ç½®æ‹†è§£</h6>
<p>åœ¨ webpack.base.js çš„ optimization ä¸­ï¼Œé…ç½®äº†ä¸‰ä¸ªå…³é”®éƒ¨åˆ†ï¼š</p>
<ol>
<li>
<h6 data-id="heading-21">vendor (ç¬¬ä¸‰æ–¹åº“)</h6>
</li>
</ol>
<p>é…ç½®: test: /[/]node_modules[/]/ ä½œç”¨: ä¸“é—¨æŠŠä» node_modules å¼•å…¥çš„æ‰€æœ‰åº“æ‰“åŒ…è¿› vendor.jsã€‚ ç­–ç•¥: è¿™äº›åº“ï¼ˆå¦‚ Element Plus, Axiosï¼‰ç‰ˆæœ¬é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œé€‚åˆè®¾ç½®å¼ºç¼“å­˜ï¼ˆMax-Age ä¸€å¹´ï¼‰ã€‚</p>
<ol start="2">
<li>
<h6 data-id="heading-22">common (å…¬ç”¨ä¸šåŠ¡ä»£ç )</h6>
</li>
</ol>
<p>é…ç½®: minChunks: 2, minSize: 1 ä½œç”¨: å¦‚æœä½ å†™äº†ä¸€ä¸ª utils.js å·¥å…·å‡½æ•°ï¼Œä¸”è¢«ä¸¤ä¸ªä»¥ä¸Šçš„é¡µé¢å…¥å£ import äº†ï¼Œå®ƒå°±ä¼šè¢«è‡ªåŠ¨æå–åˆ° common.js ä¸­ã€‚ ä¼˜ç‚¹: é˜²æ­¢é‡å¤æ‰“åŒ…ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥ï¼Œæ¯ä¸ªé¡µé¢çš„ bundle é‡Œéƒ½ä¼šåŒ…å«ä¸€ä»½ä¸€æ¨¡ä¸€æ ·çš„å·¥å…·å‡½æ•°ã€‚</p>
<ol start="3">
<li>
<h6 data-id="heading-23">runtimeChunk: true (è¿è¡Œæ—¶ä»£ç )</h6>
</li>
</ol>
<p>ä½œç”¨: è¿™ä¼šç”Ÿæˆä¸€ä¸ªç±»ä¼¼ runtime~main.js çš„å¾®å‹æ–‡ä»¶ã€‚ æ·±åº¦åŸç†è§£æ: Webpack æ‰“åŒ…æ—¶ä¼šç»™æ¯ä¸ªæ¨¡å—åˆ†é… IDã€‚æ¨¡å— A å¼•ç”¨æ¨¡å— B æ—¶ï¼Œå†…éƒ¨è®°å½•çš„æ˜¯ IDã€‚ é—®é¢˜: å¦‚æœä¸æå– runtimeï¼Œæ¨¡å— B å˜äº†ï¼Œæ¨¡å— A é‡Œçš„ ID æ˜ å°„ä¹Ÿä¼šå˜ï¼Œå¯¼è‡´æ¨¡å— A çš„ Hash ä¹Ÿå¤±æ•ˆã€‚ è§£å†³: æå– runtime åï¼Œæ‰€æœ‰çš„æ¨¡å—æ˜ å°„å…³ç³»éƒ½å­˜åœ¨è¿™ä¸ªå°æ–‡ä»¶é‡Œã€‚å“ªæ€•ä¸šåŠ¡ä»£ç å˜äº†ï¼Œåªè¦æ¨¡å—ä¾èµ–å…³ç³»æ²¡å˜ï¼Œå…¶ä»–æ–‡ä»¶çš„ Hash å°±èƒ½ä¿æŒç¨³å®šã€‚</p>
<h6 data-id="heading-24">7.3 ä»£ç åˆ†å‰²ç¤ºæ„å›¾ (å‰åå¯¹æ¯”)</h6>
<p>æ‰“åŒ…æ–¹å¼ äº§ç‰©ç»“æ„ æµè§ˆå™¨è¡Œä¸º</p>
<p>ä¸åˆ†å‰² main.js (2MB) æ”¹ä¸€è¡Œä»£ç ï¼Œç”¨æˆ·å¾—é‡ä¸‹ 2MBã€‚</p>
<p>åˆ†å‰²å vendor.js (1.8MB) + common.js (100KB) + page.js (10KB) æ”¹ä¸€è¡Œä»£ç ï¼Œç”¨æˆ·åªé‡ä¸‹ 10KBã€‚</p>
<h5 data-id="heading-25">âš¡ 8. å»ºè®®ä¼˜åŒ–æ–¹å‘</h5>
<p>æ›´æ¢ç°ä»£åŒ– Loader: å°† HappyPack è¿ç§»è‡³ thread-loaderã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlinåç¨‹è¿›é˜¶ç‹ç‚¸ä¹‹ä½œ-Kotlinçš„åç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7598499504171139110</link>    <guid>https://juejin.cn/post/7598499504171139110</guid>    <pubDate>2026-01-24T10:03:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598499504171139110" data-draft-id="7598435950411415562" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlinåç¨‹è¿›é˜¶ç‹ç‚¸ä¹‹ä½œ-Kotlinçš„åç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="Android,Kotlin"/> <meta itemprop="datePublished" content="2026-01-24T10:03:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/4469974689386972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlinåç¨‹è¿›é˜¶ç‹ç‚¸ä¹‹ä½œ-Kotlinçš„åç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4469974689386972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:03:38.000Z" title="Sat Jan 24 2026 10:03:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>kotlin</code>åç¨‹æ¨å‡ºè‡³ä»Šå·²æˆä¸º Android å¼€å‘äººå‘˜çš„å¿…å¤‡æŠ€èƒ½ï¼Œä½†ç›´åˆ°ä»Šå¤©ä»ç„¶æœ‰å¾ˆå¤šå…³äºkotlinåç¨‹åº•å±‚çš„äº‰è®®ã€‚æœ¬ç¯‡æ–‡ç« å›´ç»•kotlinåç¨‹åº•å±‚ç»“åˆç€ä¸€äº›åŸºç¡€è®²è§£ï¼Œå¸Œæœ›å¯ä»¥æ¢ç©¶æ˜ç™½kotlinåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå½“ç„¶ï¼Œç¬”è€…çŸ¥è¯†æœ‰é™è€Œå¦‚æœæœ‰ä¸å‘¨é”™è¯¯ä¹‹å¤„å¸Œæœ›å¤§å®¶æŒ‡å‡ºã€‚</p>
<p>å¾ˆå¤šè¯­è¨€ä¸­éƒ½æœ‰åç¨‹è¿™ä¸€æ¦‚å¿µï¼Œå¾ˆå¤šäººæŠŠè¿™äº›ä¸åŒè¯­è¨€çš„åç¨‹æ··ä¸ºä¸€è°ˆï¼Œç»Ÿç§°åç¨‹æ˜¯ â€œ<strong>è½»é‡çº§çº¿ç¨‹</strong>â€ ã€‚ä½†æ·±ç©¶å…¶ç†ï¼Œ<strong>åƒ Go é‚£æ ·å…·æœ‰ç‹¬ç«‹æ ˆçš„åç¨‹çœŸæ­£ä½œä¸ºä»£ç è¿è¡Œå•å…ƒçš„</strong>åç¨‹æ‰èƒ½è¯´æ˜¯è½»é‡çº§çº¿ç¨‹ï¼Œåƒkotlinè¿™ç§è¯­è¨€å±‚é¢å®ç°çš„æ— æ ˆåç¨‹ï¼Œåªèƒ½è¯´æ˜¯<strong>è½»é‡çº§ä»»åŠ¡</strong>ï¼Œkotlinåç¨‹æ˜¯ä¾é <strong>çŠ¶æ€æœºæ¨¡æ‹Ÿæ ˆ</strong>å®ç°çš„ï¼Œå®Œå…¨ä¸ç¬¦åˆè½»é‡çº§çº¿ç¨‹çš„å®šä¹‰ï¼Œä¸‹é¢ä¼šè¯¦ç»†è¯´åˆ°ã€‚</p>
<h2 data-id="heading-0">åç¨‹çš„å¯åŠ¨</h2>
<p>åç¨‹æœ¬è´¨ä¸Š = Context + Job + Dispatcher + Continuationã€‚å…¶ä¸­<code>Job</code>å’Œ<code>Dispatcher</code>æ˜¯<code>Context</code>çš„æ ¸å¿ƒå…ƒç´ ï¼Œè¿™éƒ¨åˆ†å’Œåç¨‹ä½œç”¨åŸŸå¯†åˆ‡ç›¸å…³ï¼Œæ”¾åœ¨<strong>ä½œç”¨åŸŸ</strong>çš„å†…å®¹ä¸­ã€‚<code>Continuation</code>(ç»­ä½“)æ˜¯è§£å†³å›è°ƒåœ°ç‹±çš„é‡è¦å…ƒç´ ï¼Œæ”¾åœ¨è§£å†³<strong>å›è°ƒåœ°ç‹±</strong>çš„å†…å®¹ä¸­ã€‚è¿™é‡Œå…ˆçœ‹ä¸€ä¸‹åç¨‹çš„ä¸‰ç§å¯åŠ¨æ–¹å¼</p>
<ol start="0">
<li><code>runBlockingï¼š</code> å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹å¹¶é˜»å¡è°ƒç”¨å®ƒçš„çº¿ç¨‹ï¼Œç›´åˆ°é‡Œé¢çš„ä»£ç æ‰§è¡Œå®Œæ¯•,è¿”å›å€¼æ˜¯åç¨‹ä½“ä¸­çš„æœ€åä¸€è¡Œã€‚<strong>ä½†æ˜¯åªèƒ½åœ¨å½“å‰çº¿ç¨‹è¿è¡Œäº‹ä»¶å¾ªç¯</strong>ï¼Œä¸€èˆ¬ä»…ç”¨åœ¨è°ƒè¯•é˜¶æ®µï¼Œä¸ä¼šç”¨äºå®é™…å¼€å‘ã€‚</li>
<li><code>launchï¼š</code> å¯åŠ¨ä¸€ä¸ªåç¨‹ä½†ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹,å¿…é¡»è¦åœ¨åç¨‹ä½œç”¨åŸŸ(<code>CoroutineScope</code>)ä¸­æ‰èƒ½è°ƒç”¨ã€‚æ— ä¸šåŠ¡è¿”å›å€¼(ä¸šåŠ¡è¿”å›å€¼çš„å®šä¹‰æ˜¯<strong>å‡½æ•°æˆ–åç¨‹æ‰§è¡Œå®Œæˆåï¼Œå‘è°ƒç”¨æ–¹è¿”å›çš„ã€ä¸å…·ä½“ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ç»“æœæ•°æ®</strong>)ï¼Œ<code>launch</code>è¿”å›çš„<code>Job</code>æ˜¯ä¸€ä¸ªåç¨‹çš„å¥æŸ„ï¼Œä¸‹é¢åç¨‹ä½œç”¨åŸŸä¼šè¯¦ç»†è¯´ã€‚</li>
<li><code>async:Deferred&lt;T&gt;</code> å¯åŠ¨ä¸€ä¸ªåç¨‹ä½†ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹,å¿…é¡»è¦åœ¨åç¨‹ä½œç”¨åŸŸ(<code>CoroutineScope</code>)ä¸­æ‰èƒ½è°ƒç”¨ã€‚ä»¥<code>Deferred</code>å¯¹è±¡çš„å½¢å¼è¿”å›åç¨‹ä»»åŠ¡ã€‚<code>Deferred</code>æ˜¯<code>Job</code>çš„å­æ¥å£ï¼Œå¯ä»¥é€šè¿‡<code>await</code>æ–¹æ³•å¾—åˆ°åç¨‹ä½“ä¸­æœ€åä¸€è¡Œçš„ä¸šåŠ¡è¿”å›å€¼ã€‚</li>
</ol>
<h2 data-id="heading-1">åç¨‹ä½œç”¨åŸŸ</h2>
<p>åç¨‹ä½œç”¨åŸŸæœ¬è´¨æ˜¯ä¸€ä¸ª<strong>ç®¡ç†åç¨‹çš„å®¹å™¨</strong>ï¼Œ<strong>æ ¸å¿ƒä½œç”¨å°±æ˜¯è§„å®šå…¶æ‰€ç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œé¿å…å†…å­˜æ³„æ¼æˆ–ç¨‹åºå´©æºƒã€‚é€šè¿‡<code>runBlocking</code>ã€<code>launch</code>å’Œ<code>async</code>å¯åŠ¨çš„åç¨‹ä½“ç­‰åŒäºåç¨‹ä½œç”¨åŸŸï¼Œæ”¯æŒåµŒå¥—å¯åŠ¨ä»»æ„å¤šçš„å­åç¨‹ï¼Œè¿™ä¹Ÿå°±æ˜¯<strong>ç»“æ„åŒ–å¹¶å‘</strong>ï¼Œå½“çˆ¶ä»»åŠ¡å®Œæˆæˆ–è€…å¼‚å¸¸ç»ˆæ­¢æ—¶ï¼Œå­ä»»åŠ¡ä¹Ÿä¼šç›¸åº”åœ°è¢«å¤„ç†ã€‚</p>
<h3 data-id="heading-2">å†…ç½®ä½œç”¨åŸŸ</h3>
<p>å®‰å“å¼€å‘æœ‰å¦‚ä¸‹å†…ç½®çš„ä½œç”¨åŸŸ</p>
<ul>
<li>
<ol start="0">
<li><code>runBlocking</code>ï¼šé˜»å¡å¼ä½œç”¨åŸŸï¼ˆæµ‹è¯• / ä¸»çº¿ç¨‹ä¸´æ—¶é˜»å¡ï¼‰</li>
</ol>
</li>
</ul>
<p><code>runBlocking</code> ä¸æ˜¯æ™®é€šçš„ <code>CoroutineScope</code>ï¼Œä½†å®ƒä¼šåˆ›å»ºä¸€ä¸ª<strong>é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ</strong>ï¼Œç›´åˆ°ä½œç”¨åŸŸå†…æ‰€æœ‰åç¨‹æ‰§è¡Œå®Œæ¯•ã€‚å› æ­¤ä»…ç”¨äº<strong>æµ‹è¯•ä»£ç </strong>æˆ– <code>main</code> å‡½æ•°ï¼Œä¸¥ç¦åœ¨å®‰å“ä¸»çº¿ç¨‹ / ç”Ÿäº§ä»£ç ä¸­ä½¿ç”¨ï¼ˆä¼šé˜»å¡çº¿ç¨‹ï¼‰ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// runBlocking æ„å»ºçš„ä½œç”¨åŸŸï¼Œé˜»å¡å½“å‰çº¿ç¨‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testRunBlockingScope</span><span class="hljs-params">()</span></span> = runBlocking {
 Â  Â launch { <span class="hljs-comment">// ç»§æ‰¿ runBlocking çš„ä½œç”¨åŸŸ</span>
 Â  Â  Â  Â delay(<span class="hljs-number">1000</span>)
 Â  Â  Â  Â Log.d(<span class="hljs-string">"scope"</span>, <span class="hljs-string">"runBlocking å†…çš„åç¨‹"</span>)
 Â   }
}
</code></pre>
<ul>
<li>
<ol start="2">
<li><code>GlobalScope</code>ï¼šå…¨å±€ä½œç”¨åŸŸ</li>
</ol>
</li>
</ul>
<p><code>GlobalScope</code> æ˜¯ Kotlin æä¾›çš„<strong>å…¨å±€é™æ€ä½œç”¨åŸŸ</strong>ï¼Œç”Ÿå‘½å‘¨æœŸä¸åº”ç”¨è¿›ç¨‹ç»‘å®šï¼Œæ— æ³•è‡ªåŠ¨å–æ¶ˆï¼Œå®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼ã€‚å¯åŠ¨çš„åç¨‹ä¸å—ä»»ä½•ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå³ä½¿é¡µé¢é”€æ¯ï¼Œåç¨‹ä»ä¼šè¿è¡Œã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testGlobalScope</span><span class="hljs-params">()</span></span> {
 Â  Â GlobalScope.launch { <span class="hljs-comment">// å…¨å±€ä½œç”¨åŸŸçš„åç¨‹</span>
 Â  Â  Â  Â delay(<span class="hljs-number">1000</span>)
 Â  Â  Â  Â Log.d(<span class="hljs-string">"scope"</span>, <span class="hljs-string">"GlobalScope åç¨‹"</span>)
 Â   }
}
</code></pre>
<ul>
<li>
<ol start="3">
<li>å®‰å“å®˜æ–¹åº“æä¾›çš„ä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„ä½œç”¨åŸŸï¼Œ<strong>åç¨‹ä¼šéšç»„ä»¶é”€æ¯è‡ªåŠ¨å–æ¶ˆ</strong>ï¼Œæ˜¯å®‰å“å¼€å‘çš„é¦–é€‰</li>
</ol>
</li>
</ul>




















<table><thead><tr><th>ä½œç”¨åŸŸ</th><th>ç»‘å®šçš„ç»„ä»¶</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>lifecycleScope</code></td><td><code>Activity</code>/<code>Fragment</code></td><td>æ‰§è¡Œä¸é¡µé¢ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„åç¨‹ï¼ˆæ¯”å¦‚è¯·æ±‚æ•°æ®ã€æ›´æ–° UIï¼‰</td></tr><tr><td><code>viewModelScope</code></td><td><code>ViewModel</code></td><td>æ‰§è¡Œä¸ <code>ViewModel</code> ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„åç¨‹ï¼ˆæ¯”å¦‚æ•°æ®è¯·æ±‚ï¼Œé¡µé¢é”€æ¯å <code>ViewModel</code> ä»å­˜æ´»æ—¶åç¨‹ç»§ç»­ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-3">è‡ªå®šä¹‰ä½œç”¨åŸŸ</h3>
<p>é™¤äº†ç³»ç»Ÿå†…ç½®çš„ä½œç”¨åŸŸå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰åç¨‹ä½œç”¨åŸŸã€‚æˆ‘ä»¬å¯ä»¥ç†è§£åç¨‹ä½œç”¨åŸŸæ˜¯ä¸ºåç¨‹åˆ¶å®š<strong>ç»Ÿä¸€çš„è¿è¡Œè§„åˆ™</strong>ï¼ˆæ¯”å¦‚é»˜è®¤è·‘åœ¨å“ªä¸ªçº¿ç¨‹ã€å¼‚å¸¸æ€ä¹ˆå¤„ç†ã€ä»€ä¹ˆæ—¶å€™å…¨éƒ¨å–æ¶ˆï¼‰ï¼Œè€Œ â€œè‡ªå®šä¹‰ä½œç”¨åŸŸâ€ å°±æ˜¯æˆ‘ä»¬è‡ªå·±æ¥åˆ¶å®šè¿™äº›è§„åˆ™ï¼Œæƒ³è¦è‡ªå·±åˆ¶å®šè§„åˆ™ï¼Œæˆ‘ä»¬æœ‰å¿…è¦ç»§ç»­æ·±æŒ–ä¸€ä¸‹<strong>åç¨‹ä½œç”¨åŸŸ</strong></p>
<p>åç¨‹ä½œç”¨åŸŸ<code>CoroutineScope</code>æœ¬èº«æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæºç æå…¶ç®€æ´ã€‚<code>CoroutineScope</code>çš„æ ¸å¿ƒåªæœ‰ä¸€ä¸ªå±æ€§<code>coroutineContext</code>ã€‚å› æ­¤ï¼Œ<code>CoroutineScope</code>åŒ…å«çš„â€œå†…å®¹â€æœ¬è´¨ä¸Šæ˜¯ <code>coroutineContext</code>æ‰€å°è£…çš„åç¨‹ä¸Šä¸‹æ–‡å…ƒç´ ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CoroutineScope</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext
}
</code></pre>
<p><code>CoroutineContext</code>ï¼ˆåç¨‹ä¸Šä¸‹æ–‡ï¼‰æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œä¸»è¦ç”±å¦‚ä¸‹å‡ ä¸ªå…ƒç´ ç»„æˆã€‚</p>
<ul>
<li>
<ol start="0">
<li><strong>Jobï¼ˆä½œä¸šï¼‰ï¼šåç¨‹ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†è€…</strong></li>
</ol>
</li>
</ul>
<p><code>Job</code>æ˜¯ <code>CoroutineContext</code>çš„æ ¸å¿ƒå…ƒç´ ä¹‹ä¸€ï¼Œæä¾›äº†<strong>æ§åˆ¶åç¨‹ç”Ÿå‘½å‘¨æœŸï¼ˆå¯åŠ¨ã€å–æ¶ˆã€ç­‰å¾…å®Œæˆï¼‰ã€æŸ¥è¯¢çŠ¶æ€ï¼ˆæ˜¯å¦æ´»è·ƒ / å®Œæˆ / å–æ¶ˆï¼‰çš„æ‰€æœ‰æ¥å£</strong>ï¼Œåç¨‹æ„å»ºå™¨ï¼ˆ<code>launch</code>/<code>async</code>ï¼‰éƒ½ä¼šè¿”å› <code>Job</code> ç›¸å…³å¯¹è±¡ï¼ŒJobçš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ã€‚</p>








































<table><thead><tr><th>çŠ¶æ€</th><th>è¯´æ˜</th><th>å¯¹åº”å±æ€§</th></tr></thead><tbody><tr><td>Newï¼ˆæ–°å»ºï¼‰</td><td>åç¨‹å·²åˆ›å»ºä½†æœªå¯åŠ¨ï¼ˆä»…æ‰‹åŠ¨åˆ›å»º Job æ—¶ä¼šå‡ºç°ï¼Œ<code>launch</code> ä¼šè‡ªåŠ¨å¯åŠ¨ï¼‰</td><td><code>isActive = false</code></td></tr><tr><td>Activeï¼ˆæ´»è·ƒï¼‰</td><td>åç¨‹æ­£åœ¨æ‰§è¡Œ</td><td><code>isActive = true</code></td></tr><tr><td>Completing</td><td>åç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä½†å­ Job è¿˜æœªå®Œæˆï¼ˆå†…éƒ¨çŠ¶æ€ï¼Œå¯¹å¤–è¡¨ç°ä¸º Activeï¼‰</td><td>-</td></tr><tr><td>Cancelling</td><td>åç¨‹è¢«å–æ¶ˆï¼Œæ­£åœ¨æ‰§è¡Œæ”¶å°¾é€»è¾‘ï¼ˆå¦‚ <code>finally</code>ï¼‰</td><td><code>isCancelled = true</code></td></tr><tr><td>Cancelled</td><td>åç¨‹å·²å–æ¶ˆä¸”æ”¶å°¾å®Œæˆ</td><td><code>isCompleted = true</code> + <code>isCancelled = true</code></td></tr><tr><td>Completed</td><td>åç¨‹æ­£å¸¸æ‰§è¡Œå®Œæ¯•ï¼ˆæ— å–æ¶ˆã€æ— å¼‚å¸¸ï¼‰</td><td><code>isCompleted = true</code> + <code>isCancelled = false</code></td></tr></tbody></table>
<p>å¯¹äº<strong>å¯å–æ¶ˆçš„<code>Job</code></strong>(æœ‰æŒ‚èµ·ç‚¹ï¼Œå¦‚ <code>delay()</code>ã€<code>withContext()</code> )ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨<code>job.cancel()</code>å–æ¶ˆï¼Œç»ˆæ­¢æ•´ä¸ªåç¨‹ã€‚</p>
<p>æ¯ä¸ªåç¨‹å¯¹åº”ä¸€ä¸ª <code>Job</code>ï¼Œä½œç”¨åŸŸçš„ <code>Job</code>é€šå¸¸ä½œä¸ºâ€œçˆ¶ Jobâ€ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å­åç¨‹ï¼ˆé€šè¿‡ä½œç”¨åŸŸå¯åŠ¨çš„åç¨‹ï¼‰ä¼šå½¢æˆ<strong>çˆ¶å­ Job æ ‘</strong>ï¼Œçˆ¶ Job å–æ¶ˆæ—¶æ‰€æœ‰å­ Job ä¼šè¢«çº§è”å–æ¶ˆï¼ˆç»“æ„åŒ–å¹¶å‘çš„æ ¸å¿ƒï¼‰ï¼Œå¹¶ä¸”<strong>æ™®é€š<code>Job</code>ä¼šå› å­åç¨‹å¼‚å¸¸å¯¼è‡´çˆ¶çº§å¤±æ•ˆ</strong>ï¼Œå‰è€…æ˜¯ä¸ºäº†é¿å…èµ„æºæ³„æ¼ç¨‹åºå´©æºƒçš„æœ‰åˆ©è®¾è®¡ï¼Œåè€…åˆ™å®Œå…¨ä¸ç¬¦åˆä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>å› æ­¤åœ¨<code>Job</code>çš„åŸºç¡€ä¸Šè¯ç”Ÿäº†ä¸€ä¸ªç‰¹æ®Šçš„å­ç±»<code>SupervisorJob</code>ï¼Œé‡å†™äº†å¼‚å¸¸ä¼ æ’­é€»è¾‘ï¼šå½“å­åç¨‹æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸ä»…ç»ˆæ­¢å½“å‰å­åç¨‹ï¼Œä¸ä¼šä¼ æ’­åˆ°çˆ¶ <code>SupervisorJob</code>ï¼Œçˆ¶çº§å’Œå…¶ä»–å­åç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>
<p>åƒä¸Šé¢å®‰å“å†…ç½®çš„**<code>lifecycleScope</code>å’Œ<code>viewModelScope</code>å°±ç”¨çš„æ˜¯<code>SupervisorJob</code>**</p>
<ul>
<li>
<ol start="2">
<li><strong>Dispatcherï¼ˆè°ƒåº¦å™¨ï¼‰ï¼šåç¨‹è¿è¡Œçš„çº¿ç¨‹/çº¿ç¨‹æ± </strong></li>
</ol>
</li>
<li>
<p><code>Dispatcher</code>ï¼ˆè°ƒåº¦å™¨ï¼‰å†³å®šäº†åç¨‹<strong>è¿è¡Œçš„çº¿ç¨‹æˆ–çº¿ç¨‹æ± </strong>ã€‚å®ƒæ˜¯ <code>CoroutineContext</code>ä¸­æœ€å¸¸ç”¨çš„å…ƒç´ ä¹‹ä¸€ï¼Œé€šè¿‡ <code>Dispatchers</code>å·¥å‚ç±»åˆ›å»ºã€‚å¸¸è§è°ƒåº¦å™¨å¦‚ä¸‹</p>
<ul>
<li><code>Dispatchers.Main</code>ï¼šä¸»çº¿ç¨‹ï¼ˆé€‚ç”¨äº Android UI æ›´æ–°ã€iOS ä¸»çº¿ç¨‹ç­‰ï¼‰ï¼›</li>
<li><code>Dispatchers.IO</code>ï¼šIO çº¿ç¨‹æ± ï¼ˆé€‚ç”¨äºç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æ“ä½œç­‰é˜»å¡ IO ä»»åŠ¡ï¼‰ï¼›</li>
<li><code>Dispatchers.Default</code>ï¼šCPU å¯†é›†å‹çº¿ç¨‹æ± ï¼ˆé€‚ç”¨äºå¤æ‚è®¡ç®—ã€æ’åºã€è§£æç­‰ CPU å¯†é›†å‹ä»»åŠ¡ï¼‰ï¼›</li>
<li><code>Dispatchers.Unconfined</code>ï¼šæ— å›ºå®šè°ƒåº¦å™¨ï¼ˆåç¨‹åœ¨å½“å‰çº¿ç¨‹å¯åŠ¨ï¼ŒæŒ‚èµ·åæ¢å¤æ—¶å¯èƒ½åˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹ï¼Œæ…ç”¨ï¼‰ã€‚</li>
</ul>
</li>
<li>
<ol start="3">
<li><strong>CoroutineExceptionHandlerå¼‚å¸¸å¤„ç†æœºåˆ¶</strong></li>
</ol>
</li>
</ul>
<p><code>CoroutineExceptionHandler</code>ç”¨äº<strong>å¤„ç†ä½œç”¨åŸŸå†…æœªtry-catchæ•è·çš„å¼‚å¸¸</strong>ï¼ˆä»…å¯¹â€œæ ¹åç¨‹â€æœ‰æ•ˆï¼Œå­åç¨‹çš„å¼‚å¸¸éœ€é€šè¿‡å…¶ä»–æ–¹å¼å¤„ç†ï¼‰ã€‚å½“åç¨‹æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸ï¼ˆå¦‚ <code>RuntimeException</code>ï¼‰æ—¶ï¼Œå¼‚å¸¸å¤„ç†å™¨ä¼šè¢«è§¦å‘ï¼Œä¸€èˆ¬å°±ç”¨ä½œæ—¥å¿—è®°å½•ã€‚æ³¨æ„ï¼Œ<strong>å¯¹äºtry-catchæ•è·äº†çš„å¼‚å¸¸ï¼Œæ˜¯ä¸ä¼šè§¦å‘<code>CoroutineExceptionHandler</code>çš„ã€‚</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> handler = CoroutineExceptionHandler { _, e -&gt;
 Â  Â println(<span class="hljs-string">"æ•è·å¼‚å¸¸: <span class="hljs-variable">$e</span>"</span>)
}
â€‹
<span class="hljs-keyword">val</span> scope = CoroutineScope(
 Â  Â SupervisorJob() +
 Â  Â Dispatchers.IO +
 Â  Â handler
)
<span class="hljs-comment">//ä¼šè§¦å‘CoroutineExceptionHandler</span>
scope.launch {
 Â  Â <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Oops!"</span>) <span class="hljs-comment">// æœªè¢«æ•è·çš„å¼‚å¸¸</span>
}
</code></pre>
<p>ç”¨<code>launch</code>å¯åŠ¨åç¨‹é‡åˆ°æœªæ•æ‰çš„å¼‚å¸¸ç›´æ¥å°±è§¦å‘<code>CoroutineExceptionHandler</code>äº†ï¼Œä½†æ˜¯å¯¹äº<code>async</code>å¯åŠ¨çš„åç¨‹ï¼Œ<code>async</code> ä¼š<strong>æš‚å­˜å¼‚å¸¸</strong>ï¼Œç›´åˆ°è°ƒç”¨ <code>.await()</code> æ—¶æ‰æŠ›å‡ºã€‚å¦‚æœä¸<code>await</code>ä»ç„¶ä¸ä¼šè§¦å‘<code>CoroutineExceptionHandler</code>ã€‚</p>
<pre><code class="hljs language-dart" lang="dart">val <span class="hljs-keyword">deferred</span> = <span class="hljs-keyword">async</span> { 
 Â  Â <span class="hljs-keyword">throw</span> IOException() 
}
<span class="hljs-comment">//å¼‚å¸¸è¢«æš‚å­˜ï¼Œä¸ä¼šè§¦å‘ CoroutineExceptionHandler</span>
â€‹
<span class="hljs-comment">// å¿…é¡»await</span>
<span class="hljs-keyword">deferred</span>.<span class="hljs-keyword">await</span>() <span class="hljs-comment">// å¼‚å¸¸æœªè¢«æ•è·ï¼Œå‘ä¸Šä¼ æ’­</span>
</code></pre>
<ul>
<li>4.å–æ¶ˆæ¨¡å‹</li>
</ul>
<p>æ™®é€šå­åç¨‹çš„ Job æ‰§è¡Œå®Œä»»åŠ¡æ‰ä¼šè‡ªåŠ¨ç»“æŸï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰çš„åç¨‹ä½œç”¨åŸŸå¹¶ä¸èƒ½å…³è”é¡µé¢çš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“ç”¨æˆ·é€€å‡ºæŸä¸ªè€—æ—¶é¡µé¢ä¸å¸Œæœ›å†è¿›è¡Œæ—¶ï¼Œå¦‚æœä¸æ‰‹åŠ¨å–æ¶ˆè¯¥åç¨‹ä»ç„¶ä¼šè¿›è¡Œä¸‹å»ï¼Œå› æ­¤ä¸€èˆ¬è¡¥å……ä¸€ä¸ªå–æ¶ˆçš„æ–¹æ³•</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â job.cancel()
 Â   }
</code></pre>
<p>ç»¼åˆä»¥ä¸Šå‡ ç‚¹ï¼Œæˆ‘ä»¬æŠŠä»¥ä¸Šçš„å‡ ä¸ªè¦ç‚¹å…¨éƒ¨ç»„è£…ä¸€èµ·ï¼Œå°±å†™å‡ºä¸€ä¸ªæ ‡å‡†çš„Scopeäº†</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UseCaseScope</span>(
 Â  Â dispatcher: CoroutineDispatcher
) : CoroutineScope {
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> job = SupervisorJob()
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> coroutineContext =
 Â  Â  Â  Â job +
 Â  Â  Â  Â dispatcher +
 Â  Â  Â  Â CoroutineName(<span class="hljs-string">"UseCaseScope"</span>)
â€‹
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â job.cancel()
 Â   }
}
</code></pre>
<h2 data-id="heading-4">è§£å†³å›è°ƒåœ°ç‹±</h2>
<p>å›è°ƒåœ°ç‹±ï¼Œå³å¤šå±‚å›è°ƒåµŒå¥—çš„é—®é¢˜ï¼Œä¾‹å¦‚è·å–ç”¨æˆ·ä¿¡æ¯ â†’ æ ¹æ®ç”¨æˆ· ID è·å–è®¢å• â†’ æ ¹æ®è®¢å• ID è·å–å•†å“è¯¦æƒ…ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸‹æ¸¸å‡½æ•°åµŒå¥—åœ¨ä¸Šæ¸¸å‡½æ•°çš„å›è°ƒä¸­ã€‚å¯¹è¿™æ ·çš„ä»£ç å¾ˆå®¹æ˜“ç‰µä¸€å‘åŠ¨å…¨èº«ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ã€‚Kotlinä¸ºè§£å†³è¿™ä¸ªé—®é¢˜é‡‡ç”¨äº†<strong>åº•å±‚æ„å»ºå‡½æ•°</strong><code>suspendCancellableCoroutine</code>ï¼Œç”¨äº<strong>å°†åŸºäºå›è°ƒï¼ˆCallbackï¼‰æˆ– Future çš„å¼‚æ­¥ API å°è£…æˆ <code>suspend</code> å‡½æ•°</strong>ï¼Œä»è€Œè®©ä¼ ç»Ÿå¼‚æ­¥ä»£ç èƒ½æ— ç¼èå…¥åç¨‹ä¸–ç•Œã€‚</p>
<p>è¦äº†è§£å›è°ƒåœ°ç‹±çš„åº•å±‚é€»è¾‘ï¼Œè¿˜éœ€è¦å­¦ä¹ åç¨‹çš„åº•å±‚é€»è¾‘ï¼Œæ·±å…¥çŠ¶æ€æœºå’Œ<code>continuation</code>ç»­ä½“ã€‚ç®€å•æ¥è¯´ï¼ŒçŠ¶æ€æœºå°±æ˜¯æŠŠä»£ç æ‹†æˆâ€œçŠ¶æ€â€ï¼ŒæŒ‰é¡ºåºä¸€æ­¥æ­¥èµ°ã€‚è€Œ<code>continuation</code>å†…éƒ¨1.<strong>åŒ…è£…äº†è·¨æŒ‚èµ·ç‚¹ä»ç„¶å­˜æ´»çš„å±€éƒ¨å˜é‡</strong>å’Œ<strong>å½“å‰æ‰§è¡Œä½ç½®</strong>çš„å¯¹è±¡ï¼Œ2.<strong>åç¨‹ä¸Šä¸‹æ–‡ï¼ˆCoroutineContextï¼‰</strong> 3.<strong>æ¢å¤æ‰§è¡Œçš„é€»è¾‘ï¼ˆ<code>resumeWith</code>æ–¹æ³•ï¼‰</strong> ã€‚å…·ä½“çœ‹ä¸‹é¢ä¾‹å­</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åŸå§‹æŒ‚èµ·å‡½æ•°</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span>: String {
 Â  Â <span class="hljs-keyword">val</span> data1 = loadFromNetwork() <span class="hljs-comment">// æŒ‚èµ·ç‚¹1ï¼ˆå‡è®¾ loadFromNetwork æ˜¯æŒ‚èµ·å‡½æ•°ï¼‰</span>
 Â  Â <span class="hljs-keyword">val</span> data2 = process(data1) Â  Â <span class="hljs-comment">// æ™®é€šä»£ç ï¼ˆéæŒ‚èµ·ï¼‰</span>
 Â  Â <span class="hljs-keyword">val</span> data3 = loadFromDb(data2) <span class="hljs-comment">// æŒ‚èµ·ç‚¹2ï¼ˆå‡è®¾ loadFromDb æ˜¯æŒ‚èµ·å‡½æ•°ï¼‰</span>
 Â  Â <span class="hljs-keyword">return</span> data3
}
â€‹
<span class="hljs-comment">//ä¸šåŠ¡ä»£ç </span>
<span class="hljs-keyword">object</span> UserRepositoryCoroutine {
 Â  Â <span class="hljs-comment">// 1. å°è£…éªŒè¯è¾“å…¥ä¸ºæŒ‚èµ·å‡½æ•°</span>
 Â  Â <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadFromNetwork</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span>: String {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> suspendCancellableCoroutine { continuation -&gt;
 Â  Â  Â  Â  Â  Â UserRepository.loadFromNetwork(input, <span class="hljs-keyword">object</span> : ValidateCallback {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoadFromNetworkSuccess</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â continuation.resume(input) <span class="hljs-comment">// æˆåŠŸäº†ï¼Œæ¢å¤åç¨‹ï¼Œè¿”å›ç»“æœ</span>
 Â  Â  Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoadFromNetwork</span><span class="hljs-params">(msg: <span class="hljs-type">String</span>)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â continuation.resumeWithException(IllegalArgumentException(msg))
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   })
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadFromDb</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: UserInfo {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> suspendCancellableCoroutine { continuation -&gt;
 Â  Â  Â  Â  Â  Â UserRepository.loadFromDb(token, <span class="hljs-keyword">object</span> : UserInfoCallback {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoadFromDbSuccess</span><span class="hljs-params">(userInfo: <span class="hljs-type">UserInfo</span>)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â continuation.resume(userInfo)
 Â  Â  Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoadFromDbError</span><span class="hljs-params">(msg: <span class="hljs-type">String</span>)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â continuation.resumeWithException(SecurityException(msg))
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   })
 Â  Â  Â   }
 Â   }
â€‹
}
</code></pre>
<p>ä¸Šé¢æŒ‚èµ·å‡½æ•°ä»£ç å’Œä¸šåŠ¡ä»£ç ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åä¼šè½¬æ¢ä¸ºç±»ä¼¼å¦‚ä¸‹çš„çŠ¶æ€æœºé€»è¾‘ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FetchDataStateMachine</span>(
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> completion: Continuation&lt;String&gt;
) : Continuation&lt;String&gt; {
 Â  Â <span class="hljs-keyword">var</span> state = <span class="hljs-number">0</span>
 Â  Â <span class="hljs-keyword">var</span> data1: String? = <span class="hljs-literal">null</span>
 Â  Â <span class="hljs-keyword">var</span> data2: String? = <span class="hljs-literal">null</span>
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeWith</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> {
 Â  Â  Â  Â <span class="hljs-keyword">val</span> outcome = invokeSuspend(result) <span class="hljs-comment">// å®é™…ç¼–è¯‘å™¨ç”Ÿæˆçš„å…¥å£æ–¹æ³•</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (outcome === COROUTINE_SUSPENDED) <span class="hljs-keyword">return</span> <span class="hljs-comment">// æŒ‚èµ·æ—¶ç›´æ¥è¿”å›</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// éæŒ‚èµ·æƒ…å†µå¤„ç†ç»“æœ</span>
 Â  Â  Â  Â completion.resumeWith(outcome)
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">invokeSuspend</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: Any? {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">when</span> (state) {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-number">0</span> -&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â state = <span class="hljs-number">1</span> 
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">val</span> r = loadFromNetwork(<span class="hljs-keyword">this</span>) <span class="hljs-comment">//ä¼ å…¥å½“å‰çŠ¶æ€æœºçŠ¶æ€ï¼Œæ£€æŸ¥æ˜¯å¦æŒ‚èµ·</span>
 Â                   <span class="hljs-keyword">if</span> (r === COROUTINE_SUSPENDED) {
 Â  Â  Â                   <span class="hljs-keyword">return</span> COROUTINE_SUSPENDED 
 Â                   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// è°ƒç”¨æŒ‚èµ·å‡½æ•°è¿”å› COROUTINE_SUSPENDED,è¿™é‡Œæš‚åœæ‰§è¡Œé‡Šæ”¾çº¿ç¨‹ï¼Œå½“å‰åç¨‹çš„ Â  Â  Â  Â  Â                  Continuation è¢«ä¿å­˜èµ·æ¥ï¼Œç›´åˆ°è¯¥æŒ‚èµ·å‡½æ•°è°ƒç”¨resume()ï¼Œç„¶åç»§ç»­ä»¥                              Dispatcheré€‰æ‹©çš„çº¿ç¨‹æ¥æ‰§è¡Œå®ƒ</span>
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-number">1</span> -&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â data1 = result.getOrThrow()
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â data2 = process(data1!!)<span class="hljs-comment">//éæŒ‚èµ·å‡½æ•°ï¼Œç»§ç»­æ‰§è¡Œ</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â state = <span class="hljs-number">2</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â loadFromDb(data2!!, <span class="hljs-keyword">this</span>)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (r === COROUTINE_SUSPENDED) {
 Â  Â  Â                   <span class="hljs-keyword">return</span> COROUTINE_SUSPENDED Â 
 Â                   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// loadFromDb æŒ‚èµ·ï¼ŒåŒä¸Š</span>
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span> -&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">val</span> data3 = result.getOrThrow()
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æœ€ç»ˆè¿”å›ç»“æœï¼Œä¸å†æŒ‚èµ·</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â data3 
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">else</span> -&gt; error(<span class="hljs-string">"Invalid state"</span>)
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (e: Throwable) {
 Â  Â  Â  Â  Â  Â CoroutineSingletons.RESUME_WITH_EXCEPTION
 Â  Â  Â   }
 Â   }
}
â€‹
<span class="hljs-comment">//ä¸šåŠ¡ä»£ç çš„çŠ¶æ€æœºä¼ªä»£ç ï¼Œä»¥loadFromNetworkä¸ºä¾‹</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoadFromNetworkStateMachine</span>(
 Â  Â initialValue: String,
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> completion: Continuation&lt;String&gt; <span class="hljs-comment">// è¿™ä¸ª completion æ˜¯å¤–å±‚ fetchData çš„ continuation</span>
) : ContinuationImpl {
 Â  Â <span class="hljs-keyword">var</span> state = <span class="hljs-number">0</span>
 Â  Â <span class="hljs-keyword">var</span> input: String? = <span class="hljs-literal">null</span>
 Â  Â <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> continuationFromSuspendCancellable: Continuation&lt;String&gt; <span class="hljs-comment">//ä»£ç é‡Œçš„é‚£ä¸ª continuation</span>
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">invokeSuspend</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: Any? {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">when</span> (state) {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-number">0</span> -&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">this</span>.input = initialValue
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â state = <span class="hljs-number">1</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª Continuation ç»™ suspendCancellableCoroutine çš„ lambda</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">val</span> myLocalContinuation = <span class="hljs-keyword">object</span> : Continuation&lt;String&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeWith</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 2. å½“è¿™ä¸ª myLocalContinuation.resumeWith è¢«è°ƒç”¨æ—¶</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">//å…¶å®å°±æ˜¯ä½ åœ¨å¤–å±‚å›è°ƒé‡Œè°ƒç”¨ continuation.resume(input) è§¦å‘çš„                                   è¿™ä¼šå†æ¬¡è¿›å…¥ invokeSuspendï¼Œä½† state å·²ç»æ˜¯ 1 äº†</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â invokeSuspend(result)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 3. æŠŠ myLocalContinuation ä¼ ç»™ validateInput çš„å›è°ƒ</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â UserRepository.validateInput(<span class="hljs-keyword">this</span>.input, <span class="hljs-keyword">object</span> : ValidateCallback {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoadFromNetworkSuccess</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span> {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ‰‹åŠ¨è°ƒç”¨ï¼Œå®ƒå®é™…ä¸Šè°ƒç”¨çš„æ˜¯ myLocalContinuation.resume(input)</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â myLocalContinuation.resume(input)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ...</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â   })
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> COROUTINE_SUSPENDED
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-number">1</span> -&gt; {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 5. å½“ myLocalContinuation.resume(input) è¢«è°ƒç”¨åï¼Œç¨‹åºä¼šè·³åˆ°è¿™é‡Œ</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">val</span> result = result.getOrThrow()
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 6. å°†ç»“æœè¿”å›ç»™æœ€åˆè°ƒç”¨ loadFromNetwork çš„åœ°æ–¹ï¼ˆä¹Ÿå°±æ˜¯ fetchData å‡½æ•°ï¼‰</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â completion.resume(result)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> result
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">else</span> -&gt; error(<span class="hljs-string">"..."</span>)
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (e: Throwable) {
 Â  Â  Â  Â  Â  Â completion.resumeWithException(e)
 Â  Â  Â   }
 Â   }
}
</code></pre>
<p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒKotlin åç¨‹çš„æœ¬è´¨æ˜¯<strong>ç¼–è¯‘å™¨çš„è¯­æ³•ç³–</strong>â€”â€” ç¼–è¯‘å™¨ä¼šæŠŠåŒ…å«æŒ‚èµ·æ“ä½œçš„ <code>suspend</code> å‡½æ•°è‡ªåŠ¨ç¼–è¯‘æˆä¸€ä¸ª<strong>æœ‰é™çŠ¶æ€æœº</strong>ï¼Œæ¯ä¸ªæŒ‚èµ·ç‚¹éƒ½å¯¹åº”ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p><strong>å› ä¸ºJVM ä¸å…è®¸ä¹Ÿæ— æ³•å®‰å…¨åœ°æ•è·å’Œæ¢å¤çº¿ç¨‹è°ƒç”¨æ ˆï¼Œæ‰€ä»¥ç¼–è¯‘å™¨æŠŠ suspend å‡½æ•°è½¬æ¢æˆçŠ¶æ€æœºï¼Œç”¨ Continuation å¯¹è±¡æ¨¡æ‹Ÿæ ˆå¸§ã€‚</strong> ä¸Šé¢çš„ä»£ç å®Œå…¨æ˜¯æ ˆå¸§çš„æ“ä½œï¼Œä¿å­˜æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆå±€éƒ¨å˜é‡ + æ‰§è¡Œä½ç½®ï¼‰+ æ§åˆ¶æ‰§è¡Œæµç¨‹çš„åŠŸèƒ½å¦‚å‡ºä¸€è¾™ã€‚</p>
<p>è€Œæ•´ä¸ªå›è°ƒçš„è¿‡ç¨‹çš„æ ¸å¿ƒå°±æ˜¯æŒ‚èµ·å‡½æ•°è¿”å›<code>COROUTINE_SUSPENDED</code>ï¼Œ<code>if (outcome === COROUTINE_SUSPENDED) return</code>æ­¤æ—¶ <code>if</code>æ¡ä»¶ä¸ºçœŸï¼Œäºæ˜¯ <code>resumeWith</code>è‡ªå·±ä¹Ÿ <code>return</code>äº†ã€‚è‡³æ­¤ï¼Œæ•´ä¸ªåç¨‹çš„æœ¬æ¬¡æ‰§è¡Œå‘¨æœŸç»“æŸäº†ã€‚çº¿ç¨‹è¢«é‡Šæ”¾ï¼Œå¯ä»¥å»æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼ˆæ¯”å¦‚æ¸²æŸ“UIã€å¤„ç†åˆ«çš„åç¨‹ï¼‰ã€‚<strong>ä½†æ˜¯ <code>FetchDataStateMachine</code>å¯¹è±¡å¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œ</strong> å®ƒä½œä¸ºä¸€ä¸ª <code>Continuation</code>å¯¹è±¡ï¼Œå…¶å†…éƒ¨çš„çŠ¶æ€ï¼ˆ<code>state=1</code>, <code>data1=null</code>ç­‰ï¼‰éƒ½è¢«å®Œæ•´åœ°ä¿ç•™äº†ä¸‹æ¥ã€‚</p>
<p>å½“æŒ‚èµ·çš„å›è°ƒå‡½æ•°æˆåŠŸæ—¶è°ƒç”¨<code>continuation.resume(input)</code>ï¼Œå®é™…ä¸Šæ˜¯é‡æ–°è°ƒç”¨ <code>invokeSuspend(result)</code>ä»¥å›åˆ°åŸæ¥çš„åç¨‹åŸŸé‡Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™å°±æ˜¯åç¨‹å›è°ƒå°†å¼‚æ­¥ä»£ç  â€œä¼ªè£…â€ æˆåŒæ­¥ä»£ç çš„åº•å±‚é€»è¾‘ã€‚</p>
<h2 data-id="heading-5">Kotlinçš„åç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆ</h2>
<p>åœ¨çœ‹å®Œä¸Šé¢çš„å†…å®¹åŸºæœ¬äº†è§£äº†kotlinåç¨‹çš„åº•å±‚é€»è¾‘åï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“kotlinåç¨‹çš„åŸç†ã€‚å¼€ç¯‡è¯´äº†ï¼Œkotlinå®ç°çš„æ˜¯è¯­è¨€å±‚é¢çš„æ— æ ˆåç¨‹ï¼Œå› æ­¤è½»é‡çº§çº¿ç¨‹å®Œå…¨ä¸é€‚ç”¨äºkotlinçš„åç¨‹ï¼Œåªèƒ½è¯´æ˜¯<strong>è½»é‡çº§ä»»åŠ¡</strong>ã€‚Kotlin åç¨‹çš„<strong>æŒ‚èµ·ã€æ¢å¤ã€è°ƒåº¦</strong>éƒ½æ˜¯ä»¥<strong>å‡½æ•°</strong>ï¼ˆæŒ‚èµ·å‡½æ•° <code>suspend fun</code>ï¼‰ä¸ºåŸºæœ¬å•ä½çš„ï¼Œåç¨‹çš„æ‰§è¡Œæµç¨‹è¢«æ‹†è§£ä¸ºå¤šä¸ªæŒ‚èµ·å‡½æ•°çš„è°ƒç”¨é“¾ï¼Œè€Œéåƒçº¿ç¨‹é‚£æ ·ä»¥ â€œæ•´ä¸ªæ‰§è¡Œä½“â€ ä¸ºå•ä½è°ƒåº¦ï¼Œå®ƒçœŸæ­£çš„å¹¶å‘èƒ½åŠ›æ¥è‡ªâ€œæŒ‚èµ·ä¸å çº¿ç¨‹â€ï¼Œè€Œä¸æ˜¯çº¿ç¨‹æ± æœ¬èº«ã€‚</p>
<p><strong>ä½†æ˜¯ï¼ä¸Šé¢ä¸€åˆ‡éƒ½å›´ç»•ç€æŒ‚èµ·å‡½æ•°æ¥è¯´çš„ï¼Œå¦‚æœæœ‰ 10,000 ä¸ªåç¨‹ä»»åŠ¡ï¼Œè€Œä¸”é‡Œé¢å®Œå…¨æ²¡æœ‰ä»»ä½•æŒ‚èµ·ç‚¹ï¼ˆçº¯ CPU è®¡ç®—ï¼‰ï¼Œ Kotlin åç¨‹è¿˜èƒ½å¦åƒ Go åç¨‹ä¸€æ ·é«˜æ•ˆè°ƒåº¦ï¼Ÿ</strong> ç­”æ¡ˆæ˜¯<strong>ä¸èƒ½ã€‚</strong> æ­¤æ—¶10,000 ä¸ªä»»åŠ¡ä¼šè¢«æ”¾å…¥çº¿ç¨‹æ± é˜Ÿåˆ—ç”±N ä¸ªå·¥ä½œçº¿ç¨‹ï¼ˆâ‰ˆ CPU æ ¸å¿ƒæ•°ï¼‰æ‰§è¡Œï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡è·‘ä¸€ä¸ªä»»åŠ¡ï¼Œè·‘å®Œæ‰èƒ½æ¢ä¸‹ä¸€ä¸ªã€‚è¿™æ­£æ˜¯ Kotlin åç¨‹ä¸æ˜¯è½»é‡çº§çº¿ç¨‹çš„é“è¯ã€‚</p>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼ŒKotlin å¹¶æ²¡æœ‰æ”¹å˜ JVM çš„çº¿ç¨‹æ¨¡å‹ï¼Œå®ƒåªæ˜¯é€šè¿‡è¯­è¨€å±‚é¢çš„çªç ´ï¼Œè®©å‡½æ•°å¯ä»¥ä¸­é€”è¿”å›å¹¶åœ¨æœªæ¥æ¢å¤æ‰§è¡Œï¼Œä»è€Œå®ç°â€œæŒ‚èµ·ä¸å çº¿ç¨‹â€ï¼Œç”¨å°‘é‡çº¿ç¨‹å¤ç”¨å¤§é‡ I/O ä»»åŠ¡ã€‚ä¸€æ—¦åç¨‹å†…éƒ¨æ²¡æœ‰æŒ‚èµ·ç‚¹ï¼Œå®ƒå°±ä¼šé€€åŒ–ä¸ºæ™®é€šçº¿ç¨‹æ± ä»»åŠ¡ï¼Œ è¿™ä¹Ÿæ˜¯ Kotlin åç¨‹æ— æ³•è¢«è§†ä¸ºâ€œè½»é‡çº§çº¿ç¨‹â€çš„æ ¹æœ¬åŸå› ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾é¢„å¤„ç†]]></title>    <link>https://juejin.cn/post/7598477092197056550</link>    <guid>https://juejin.cn/post/7598477092197056550</guid>    <pubDate>2026-01-24T09:16:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598477092197056550" data-draft-id="7598532592455680027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾é¢„å¤„ç†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-24T09:16:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é”‹java1234"/> <meta itemprop="url" content="https://juejin.cn/user/4152222342709933"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾é¢„å¤„ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4152222342709933/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é”‹java1234
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:16:15.000Z" title="Sat Jan 24 2026 09:16:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é”‹å“¥ã€‚æœ€è¿‘è¿è½½æ›´æ–°ã€ŠScikit-learn Pythonæœºå™¨å­¦ä¹ ã€‹æŠ€æœ¯ä¸“é¢˜ã€‚ <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80fb5634d09745f6a8806c075a4416fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769850975&amp;x-signature=g%2BZ8pbJJ668Sr3dn9qOEKasZsX4%3D" alt="image.png" loading="lazy"/> æœ¬è¯¾ç¨‹ä¸»è¦è®²è§£åŸºäºScikit-learnçš„Pythonæœºå™¨å­¦ä¹ çŸ¥è¯†ï¼ŒåŒ…æ‹¬æœºå™¨å­¦ä¹ æ¦‚è¿°ï¼Œç‰¹å¾å·¥ç¨‹(æ•°æ®é›†ï¼Œç‰¹å¾æŠ½å–ï¼Œç‰¹å¾é¢„å¤„ç†ï¼Œç‰¹å¾é™ç»´ç­‰)ï¼Œåˆ†ç±»ç®—æ³•(K-ä¸´è¿‘ç®—æ³•ï¼Œæœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œå†³ç­–æ ‘ç­‰)ï¼Œå›å½’ä¸èšç±»ç®—æ³•(çº¿æ€§å›å½’ï¼Œæ¬ æ‹Ÿåˆï¼Œé€»è¾‘å›å½’ä¸äºŒåˆ†ç±»ï¼ŒK-meansç®—æ³•)ç­‰ã€‚ åŒæ—¶ä¹Ÿé…å¥—è§†é¢‘æ•™ç¨‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" target="_blank">ã€ŠScikit-learn Pythonæœºå™¨å­¦ä¹  è§†é¢‘æ•™ç¨‹ã€‹</a></p>
<p>ç‰¹å¾é¢„å¤„ç†å°±æ˜¯å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºä¸€ç»„æ›´å…·ä»£è¡¨æ€§ã€æ›´é€‚åˆæ¨¡å‹è®­ç»ƒçš„ç‰¹å¾çš„è¿‡ç¨‹ã€‚</p>
<p>çœŸå®ä¸–ç•Œçš„æ•°æ®é€šå¸¸å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œç›´æ¥å½±å“æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ï¼š</p>
<ol start="0">
<li><strong>é‡çº²ä¸åŒ</strong>ï¼šç‰¹å¾çš„å•ä½å’Œå°ºåº¦å·®å¼‚å·¨å¤§ï¼ˆå¦‚å¹´é¾„èŒƒå›´ 0-100 vs. è–ªèµ„èŒƒå›´ 0-100000ï¼‰ã€‚å¾ˆå¤šæ¨¡å‹ï¼ˆå¦‚ SVMã€KNNã€çº¿æ€§å›å½’ï¼‰åŸºäºè·ç¦»è®¡ç®—ï¼Œé‡çº²ä¸ç»Ÿä¸€ä¼šä½¿å¾—å¤§å°ºåº¦çš„ç‰¹å¾ä¸»å¯¼æ¨¡å‹ï¼Œå¯¼è‡´å°å°ºåº¦çš„ç‰¹å¾å¤±æ•ˆã€‚</li>
<li><strong>åˆ†å¸ƒå¼‚å¸¸</strong>ï¼šæ•°æ®å¯èƒ½å­˜åœ¨åå·®ï¼ˆSkewï¼‰ï¼Œä¸ç¬¦åˆæ¨¡å‹å‡è®¾çš„æ­£æ€åˆ†å¸ƒï¼Œå½±å“æ¨¡å‹æ€§èƒ½ã€‚</li>
<li><strong>ä¿¡æ¯å†—ä½™</strong>ï¼šå®šæ€§ç‰¹å¾ï¼ˆå¦‚å›½å®¶ã€å“ç‰Œï¼‰æ— æ³•ç›´æ¥è¢«æ¨¡å‹ä½¿ç”¨ï¼Œéœ€è¦è½¬æ¢ä¸ºæ•°å€¼ã€‚</li>
<li><strong>å­˜åœ¨ç¼ºå¤±å€¼</strong>ï¼šæ•°æ®é›†ä¸­æŸäº›ç‰¹å¾çš„å€¼å¯èƒ½ç¼ºå¤±ï¼Œéœ€è¦å¤„ç†ã€‚</li>
</ol>
<h2 data-id="heading-0">å¤„ç†ç¼ºå¤±å€¼ï¼šSimpleImputer</h2>
<p>æˆ‘ä»¬å¤„ç†ç¼ºå¤±å€¼ï¼Œå»ºè®®ä½¿ç”¨pandasã€‚</p>
<pre><code class="hljs language-ini" lang="ini">pip install <span class="hljs-attr">pandas</span>==<span class="hljs-number">2.2</span>.<span class="hljs-number">3</span> -i https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>
<p>æ¨èå­¦ä¹ ä¸‹é”‹å“¥çš„è¯¾ç¨‹ã€‚pythonæ•°æ®å¤„ç†ä¸åˆ†æPandas2ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1wNZ1YnEvp%2F" target="_blank" title="https://www.bilibili.com/video/BV1wNZ1YnEvp/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1wNâ€¦</a></p>
<p>Scikit-learnä¹Ÿæä¾›äº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„æ–¹æ¡ˆã€‚æ¯”å¦‚SimpleImputer</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> preprocessing
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.impute <span class="hljs-keyword">import</span> SimpleImputer
â€‹
<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ŒåŒ…å«ä¸åŒç±»å‹çš„é—®é¢˜</span>
data = {
 Â  Â <span class="hljs-string">'age'</span>: [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, np.nan, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">30</span>, <span class="hljs-number">15</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'salary'</span>: [<span class="hljs-number">50000</span>, <span class="hljs-number">54000</span>, <span class="hljs-number">60000</span>, np.nan, <span class="hljs-number">100000</span>, <span class="hljs-number">40000</span>, <span class="hljs-number">20000</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå°ºåº¦å¤§ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'country'</span>: [<span class="hljs-string">'USA'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'USA'</span>, <span class="hljs-string">'India'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'UK'</span>], Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
 Â  Â <span class="hljs-string">'gender'</span>: [<span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>] Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
}
â€‹
df = pd.DataFrame(data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"åŸå§‹æ•°æ®ï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
â€‹
<span class="hljs-comment"># ç­–ç•¥é€šå¸¸ä¸º meanï¼ˆå‡å€¼ï¼‰, medianï¼ˆä¸­ä½æ•°ï¼‰, most_frequentï¼ˆä¼—æ•°ï¼‰, constantï¼ˆå›ºå®šå€¼ï¼‰</span>
imputer = SimpleImputer(strategy=<span class="hljs-string">'mean'</span>)
â€‹
<span class="hljs-comment"># æˆ‘ä»¬åªå¯¹æ•°å€¼åˆ—è¿›è¡Œå¡«å……</span>
numeric_features = [<span class="hljs-string">'age'</span>, <span class="hljs-string">'salary'</span>]
df_numeric = df[numeric_features]
â€‹
<span class="hljs-comment"># fit è®¡ç®—ç”¨äºå¡«å……çš„å€¼ï¼ˆè¿™é‡Œæ˜¯å‡å€¼ï¼‰ï¼Œtransform åº”ç”¨å¡«å……</span>
imputer.fit(df_numeric)
df[numeric_features] = imputer.transform(df_numeric)
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå¤„ç†ç¼ºå¤±å€¼åï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-r" lang="r">åŸå§‹æ•°æ®ï¼š
 Â   age Â   salary country gender
<span class="hljs-number">0</span>  <span class="hljs-number">25.0</span> Â  <span class="hljs-number">50000.0</span> Â  Â  USA Â  Â   M
<span class="hljs-number">1</span>  <span class="hljs-number">30.0</span> Â  <span class="hljs-number">54000.0</span> Â  Â   UK Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">2</span> Â  <span class="hljs-literal">NaN</span> Â  <span class="hljs-number">60000.0</span> Â  China Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">3</span>  <span class="hljs-number">45.0</span> Â  Â  Â  <span class="hljs-literal">NaN</span> Â  Â  USA Â  Â   M
<span class="hljs-number">4</span>  <span class="hljs-number">60.0</span>  <span class="hljs-number">100000.0</span> Â  India Â  Â   M
<span class="hljs-number">5</span>  <span class="hljs-number">30.0</span> Â  <span class="hljs-number">40000.0</span> Â  China Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">6</span>  <span class="hljs-number">15.0</span> Â  <span class="hljs-number">20000.0</span> Â  Â   UK Â  Â   <span class="hljs-built_in">F</span>
â€‹
å¤„ç†ç¼ºå¤±å€¼åï¼š
 Â  Â  Â  Â  age Â   salary country gender
<span class="hljs-number">0</span>  <span class="hljs-number">25.000000</span> Â  <span class="hljs-number">50000.0</span> Â  Â  USA Â  Â   M
<span class="hljs-number">1</span>  <span class="hljs-number">30.000000</span> Â  <span class="hljs-number">54000.0</span> Â  Â   UK Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">2</span>  <span class="hljs-number">34.166667</span> Â  <span class="hljs-number">60000.0</span> Â  China Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">3</span>  <span class="hljs-number">45.000000</span> Â  <span class="hljs-number">54000.0</span> Â  Â  USA Â  Â   M
<span class="hljs-number">4</span>  <span class="hljs-number">60.000000</span>  <span class="hljs-number">100000.0</span> Â  India Â  Â   M
<span class="hljs-number">5</span>  <span class="hljs-number">30.000000</span> Â  <span class="hljs-number">40000.0</span> Â  China Â  Â   <span class="hljs-built_in">F</span>
<span class="hljs-number">6</span>  <span class="hljs-number">15.000000</span> Â  <span class="hljs-number">20000.0</span> Â  Â   UK Â  Â   <span class="hljs-built_in">F</span>
â€‹
Process finished with exit code <span class="hljs-number">0</span>
</code></pre>
<h2 data-id="heading-1">å½’ä¸€åŒ– (Normalization)ï¼šMinMaxScaler</h2>
<p>ä¸åŒç‰¹å¾å¯èƒ½æœ‰ä¸åŒçš„é‡çº²å’ŒèŒƒå›´ï¼ˆå¦‚èº«é«˜ã€ä½“é‡ã€å¹´é¾„ï¼‰ï¼Œå½’ä¸€åŒ–ä½¿å„ç‰¹å¾åœ¨ç›¸åŒå°ºåº¦ä¸Šè¿›è¡Œæ¯”è¾ƒï¼Œé¿å…æŸäº›ç‰¹å¾å› æ•°å€¼è¾ƒå¤§è€Œä¸»å¯¼æ¨¡å‹ã€‚</p>
<p>æˆ‘ä»¬å°†ç‰¹å¾ç¼©æ”¾è‡³ä¸€ä¸ªç‰¹å®šçš„èŒƒå›´ï¼ˆé»˜è®¤æ˜¯ [0, 1]ï¼‰ã€‚</p>
<p>å½’ä¸€åŒ–ï¼ˆNormalizationï¼‰å…¬å¼ï¼Œä¹Ÿç§°ä¸ºæœ€å°-æœ€å¤§å½’ä¸€åŒ–ï¼ˆMin-Max Normalization)</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86b5e488cc4149e581dec8b2fb4c7f2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769850975&amp;x-signature=3ir0c38yWr6GcocxbonwcAOkdbo%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å…¬å¼å«ä¹‰</strong> è¿™ä¸ªå…¬å¼å°†åŸå§‹æ•°æ® X ä»å…¶åŸå§‹èŒƒå›´è½¬æ¢åˆ° [ 0,1] çš„èŒƒå›´å†…ã€‚</p>
<p>å…¬å¼å„éƒ¨åˆ†è§£é‡Š</p>
<p><img src="" alt="" loading="lazy"/> å·¥ä½œåŸç† <img src="" alt="" loading="lazy"/> ç‰¹ç‚¹ <img src="" alt="" loading="lazy"/> åº”ç”¨åœºæ™¯ å½’ä¸€åŒ–åœ¨æœºå™¨å­¦ä¹ å’Œæ•°æ®æŒ–æ˜ä¸­éå¸¸å¸¸ç”¨ï¼Œç‰¹åˆ«æ˜¯ï¼š</p>
<ul>
<li>ç‰¹å¾ç¼©æ”¾ï¼Œä½¿ä¸åŒé‡çº²çš„ç‰¹å¾å¯æ¯”è¾ƒ</li>
<li>æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­åŠ é€Ÿæ”¶æ•›</li>
<li>ç¥ç»ç½‘ç»œä¸­é˜²æ­¢æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸</li>
<li>å›¾åƒå¤„ç†ä¸­çš„åƒç´ å€¼æ ‡å‡†åŒ–</li>
</ul>
<p>åœ¨Scikit-learnä¸­ï¼Œä½¿ç”¨<code>MinMaxScaler</code>è¿›è¡Œå½’ä¸€åŒ–æ“ä½œã€‚åœ¨åˆå§‹åŒ– <code>MinMaxScaler</code> å¯¹è±¡æ—¶ï¼Œæœ€é‡è¦çš„å‚æ•°æ˜¯ï¼š</p>
<ul>
<li>
<p><code>feature_range</code>: tuple <code>(min, max)</code>, é»˜è®¤=(0, 1)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šæŒ‡å®šä½ æƒ³è¦å°†æ•°æ®ç¼©æ”¾åˆ°çš„ç›®æ ‡èŒƒå›´ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼šå¦‚æœæƒ³ç¼©æ”¾åˆ° [-1, 1]ï¼Œåˆ™è®¾ç½® <code>feature_range=(-1, 1)</code>ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.impute <span class="hljs-keyword">import</span> SimpleImputer
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler
â€‹
<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ŒåŒ…å«ä¸åŒç±»å‹çš„é—®é¢˜</span>
data = {
 Â  Â <span class="hljs-string">'age'</span>: [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, np.nan, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">30</span>, <span class="hljs-number">15</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'salary'</span>: [<span class="hljs-number">50000</span>, <span class="hljs-number">54000</span>, <span class="hljs-number">60000</span>, np.nan, <span class="hljs-number">100000</span>, <span class="hljs-number">40000</span>, <span class="hljs-number">20000</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå°ºåº¦å¤§ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'country'</span>: [<span class="hljs-string">'USA'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'USA'</span>, <span class="hljs-string">'India'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'UK'</span>], Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
 Â  Â <span class="hljs-string">'gender'</span>: [<span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>] Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
}
â€‹
df = pd.DataFrame(data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"åŸå§‹æ•°æ®ï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
â€‹
<span class="hljs-comment"># ç­–ç•¥é€šå¸¸ä¸º meanï¼ˆå‡å€¼ï¼‰, medianï¼ˆä¸­ä½æ•°ï¼‰, most_frequentï¼ˆä¼—æ•°ï¼‰, constantï¼ˆå›ºå®šå€¼ï¼‰</span>
imputer = SimpleImputer(strategy=<span class="hljs-string">'mean'</span>)
â€‹
<span class="hljs-comment"># æˆ‘ä»¬åªå¯¹æ•°å€¼åˆ—è¿›è¡Œå¡«å……</span>
numeric_features = [<span class="hljs-string">'age'</span>, <span class="hljs-string">'salary'</span>]
df_numeric = df[numeric_features]
â€‹
<span class="hljs-comment"># fit è®¡ç®—ç”¨äºå¡«å……çš„å€¼ï¼ˆè¿™é‡Œæ˜¯å‡å€¼ï¼‰ï¼Œtransform åº”ç”¨å¡«å……</span>
imputer.fit(df_numeric)
df[numeric_features] = imputer.transform(df_numeric)
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå¤„ç†ç¼ºå¤±å€¼åï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
â€‹
minmax_scaler = MinMaxScaler()
â€‹
df_numeric = df[[<span class="hljs-string">'age'</span>, <span class="hljs-string">'salary'</span>]]
<span class="hljs-comment"># æ ¹æ®æ•°æ®è®­ç»ƒç”Ÿæˆæ¨¡å‹</span>
minmax_scaler.fit(df_numeric)
<span class="hljs-comment"># æ ¹æ®æ¨¡å‹è®­ç»ƒæ•°æ®</span>
df_normalized = minmax_scaler.transform(df_numeric)
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå½’ä¸€åŒ–åçš„æ•°å€¼ç‰¹å¾ï¼ˆèŒƒå›´[0,1]ï¼‰ï¼š"</span>)
<span class="hljs-built_in">print</span>(df_normalized)
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-css" lang="css">å½’ä¸€åŒ–åçš„æ•°å€¼ç‰¹å¾ï¼ˆèŒƒå›´<span class="hljs-selector-attr">[0,1]</span>ï¼‰ï¼š
<span class="hljs-selector-attr">[[0.22222222 0.375 Â  Â  ]</span>
 <span class="hljs-selector-attr">[0.33333333 0.425 Â  Â  ]</span>
 <span class="hljs-selector-attr">[0.42592593 0.5 Â  Â  Â  ]</span>
 <span class="hljs-selector-attr">[0.66666667 0.425 Â  Â  ]</span>
 <span class="hljs-selector-attr">[1. Â  Â  Â  Â  1. Â  Â  Â   ]</span>
 <span class="hljs-selector-attr">[0.33333333 0.25 Â  Â   ]</span>
 <span class="hljs-selector-attr">[0. Â  Â  Â  Â  0. Â  Â  Â   ]</span>]
</code></pre>
<h2 data-id="heading-2">æ ‡å‡†åŒ– (Standardization)ï¼šStandardScaler</h2>
<p>å½’ä¸€åŒ–æ˜¯åŸºäºæœ€å¤§å€¼å’Œæœ€å°å€¼çš„ï¼Œå› æ­¤å¼‚å¸¸å€¼ï¼ˆoutliersï¼‰ä¼šå¯¹å½’ä¸€åŒ–çš„ç»“æœäº§ç”Ÿè¾ƒå¤§å½±å“ã€‚æç«¯æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¼‚å¸¸å€¼å¯èƒ½ä¼šå°†æ•´ä¸ªç‰¹å¾çš„èŒƒå›´å‹ç¼©åˆ°å¾ˆå°çš„èŒƒå›´ï¼Œä»è€Œå¯¼è‡´å…¶ä»–æ­£å¸¸æ•°æ®çš„è¡¨ç¤ºèƒ½åŠ›ä¸‹é™ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¼•å…¥èƒ½å¤Ÿå°½å¯èƒ½é™ä½å¼‚å¸¸å€¼å¯¹æ•°æ®å¤„ç†ç»“æœå½±å“çš„æ ‡å‡†åŒ–è®¡ç®—æ“ä½œã€‚å°†ç‰¹å¾ç¼©æ”¾ä¸º<strong>å‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1</strong> çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚</p>
<p>æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰å…¬å¼æ˜¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a202aa0230a4cf6957f423fbc88dd92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769850975&amp;x-signature=aWUAGZdpqRquY80SSWkY5S0MnUQ%3D" alt="image.png" loading="lazy"/></p>
<p>å…¬å¼å„éƒ¨åˆ†è¯¦è§£</p>
<p><img src="" alt="" loading="lazy"/></p>
<p>å·¥ä½œåŸç†</p>
<p>æ ‡å‡†åŒ–å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º1çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚å…·ä½“æ¥è¯´ï¼š</p>
<p><img src="" alt="" loading="lazy"/></p>
<p>æ ‡å‡†åŒ–çš„æ„ä¹‰</p>
<ol start="0">
<li>
<p><strong>ç»Ÿä¸€é‡çº²</strong>ï¼šå°†ä¸åŒé‡çº²ã€ä¸åŒèŒƒå›´çš„ç‰¹å¾è½¬æ¢åˆ°åŒä¸€å°ºåº¦ä¸Š</p>
</li>
<li>
<p><strong>ä¸­å¿ƒåŒ–</strong>ï¼šè½¬æ¢ååˆ†å¸ƒçš„ä¸­å¿ƒåœ¨0ç‚¹</p>
</li>
<li>
<p>æ ‡å‡†åŒ–å°ºåº¦</p>
<p>ï¼šè½¬æ¢åçš„å€¼è¡¨ç¤º"åç¦»å¹³å‡å€¼å¤šå°‘ä¸ªæ ‡å‡†å·®"</p>
<ul>
<li>Z = 0ï¼šè¡¨ç¤ºè¯¥æ•°æ®ç‚¹æ°å¥½ç­‰äºå‡å€¼</li>
<li>Z = 1ï¼šè¡¨ç¤ºè¯¥æ•°æ®ç‚¹æ¯”å‡å€¼é«˜å‡ºä¸€ä¸ªæ ‡å‡†å·®</li>
<li>Z = -2ï¼šè¡¨ç¤ºè¯¥æ•°æ®ç‚¹æ¯”å‡å€¼ä½ä¸¤ä¸ªæ ‡å‡†å·®</li>
</ul>
</li>
</ol>
<p>åœ¨Scikit-learnä¸­ï¼Œä½¿ç”¨<code>StandardScaler</code>è¿›è¡Œæ ‡å‡†åŒ–æ“ä½œã€‚</p>
<p>åˆå§‹åŒ– <code>StandardScaler</code> å¯¹è±¡æ—¶ï¼Œæœ‰ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>
<p><code>with_mean</code>: boolean, é»˜è®¤ä¸º True</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šæ˜¯å¦å¯¹æ•°æ®å±…ä¸­ï¼ˆå‡å»å‡å€¼ï¼‰ã€‚å¦‚æœè®¾ç½®ä¸º Falseï¼Œåˆ™ä¸ä¼šå‡å»å‡å€¼ï¼Œè®¡ç®—è¿‡ç¨‹å˜ä¸º <code>x / Ïƒ</code>ã€‚å¯¹äºç¨€ç–çŸ©é˜µï¼Œè®¾ç½® <code>with_mean=False</code> æ˜¯æ¨èä¸”é»˜è®¤çš„ï¼Œå› ä¸ºå±…ä¸­ä¼šç ´åçŸ©é˜µçš„ç¨€ç–æ€§ã€‚</li>
</ul>
</li>
<li>
<p><code>with_std</code>: boolean, é»˜è®¤ä¸º True</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šæ˜¯å¦å°†æ•°æ®ç¼©æ”¾åˆ°å•ä½æ–¹å·®ï¼ˆé™¤ä»¥æ ‡å‡†å·®ï¼‰ã€‚å¦‚æœè®¾ç½®ä¸º Falseï¼Œåˆ™è®¡ç®—è¿‡ç¨‹å˜ä¸º <code>x - Î¼</code>ï¼Œåªè¿›è¡Œå±…ä¸­å¤„ç†ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨è°ƒç”¨ <code>fit</code> æˆ– <code>fit_transform</code> ä¹‹åï¼Œ<code>StandardScaler</code> å¯¹è±¡ä¼šè·å¾—ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li><code>mean_</code>ï¼šæ¯ä¸ªç‰¹å¾ï¼ˆåˆ—ï¼‰åœ¨è®­ç»ƒæ•°æ®ä¸­çš„å‡å€¼ï¼ˆÎ¼ï¼‰ã€‚</li>
<li><code>var_</code>ï¼šæ¯ä¸ªç‰¹å¾ï¼ˆåˆ—ï¼‰åœ¨è®­ç»ƒæ•°æ®ä¸­çš„æ–¹å·®ã€‚</li>
<li><code>scale_</code>ï¼šæ¯ä¸ªç‰¹å¾ï¼ˆåˆ—ï¼‰åœ¨è®­ç»ƒæ•°æ®ä¸­çš„æ ‡å‡†å·®ï¼ˆÏƒï¼‰ã€‚è¿™æ˜¯å®é™…åº”ç”¨äº <code>transform</code> çš„ç¼©æ”¾æ¯”ä¾‹ã€‚</li>
<li><code>n_samples_seen_</code>ï¼šå¤„ç†å™¨åœ¨æ¯ä¸ªç‰¹å¾ä¸­å¤„ç†çš„æ ·æœ¬æ•°ï¼ˆç”¨äºåœ¨çº¿è®¡ç®—å‡å€¼/æ–¹å·®ï¼‰ã€‚</li>
<li><code>n_features_in_</code>ï¼šè®­ç»ƒæ—¶ä½¿ç”¨çš„ç‰¹å¾æ•°é‡ã€‚</li>
<li><code>feature_names_in_</code>ï¼šè®­ç»ƒæ—¶ä½¿ç”¨çš„ç‰¹å¾åç§°ï¼ˆå¦‚æœè¾“å…¥çš„æ˜¯ Pandas DataFrameï¼‰ã€‚</li>
</ul>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.impute <span class="hljs-keyword">import</span> SimpleImputer
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
â€‹
<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ŒåŒ…å«ä¸åŒç±»å‹çš„é—®é¢˜</span>
data = {
 Â  Â <span class="hljs-string">'age'</span>: [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, np.nan, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">30</span>, <span class="hljs-number">15</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'salary'</span>: [<span class="hljs-number">50000</span>, <span class="hljs-number">54000</span>, <span class="hljs-number">60000</span>, np.nan, <span class="hljs-number">100000</span>, <span class="hljs-number">40000</span>, <span class="hljs-number">20000</span>], Â <span class="hljs-comment"># æ•°å€¼ï¼Œå°ºåº¦å¤§ï¼Œå«ç¼ºå¤±å€¼</span>
 Â  Â <span class="hljs-string">'country'</span>: [<span class="hljs-string">'USA'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'USA'</span>, <span class="hljs-string">'India'</span>, <span class="hljs-string">'China'</span>, <span class="hljs-string">'UK'</span>], Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
 Â  Â <span class="hljs-string">'gender'</span>: [<span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'F'</span>] Â <span class="hljs-comment"># åˆ†ç±»å‹</span>
}
â€‹
df = pd.DataFrame(data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"åŸå§‹æ•°æ®ï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
â€‹
<span class="hljs-comment"># ç­–ç•¥é€šå¸¸ä¸º meanï¼ˆå‡å€¼ï¼‰, medianï¼ˆä¸­ä½æ•°ï¼‰, most_frequentï¼ˆä¼—æ•°ï¼‰, constantï¼ˆå›ºå®šå€¼ï¼‰</span>
imputer = SimpleImputer(strategy=<span class="hljs-string">'mean'</span>)
â€‹
<span class="hljs-comment"># æˆ‘ä»¬åªå¯¹æ•°å€¼åˆ—è¿›è¡Œå¡«å……</span>
numeric_features = [<span class="hljs-string">'age'</span>, <span class="hljs-string">'salary'</span>]
df_numeric = df[numeric_features]
â€‹
<span class="hljs-comment"># fit è®¡ç®—ç”¨äºå¡«å……çš„å€¼ï¼ˆè¿™é‡Œæ˜¯å‡å€¼ï¼‰ï¼Œtransform åº”ç”¨å¡«å……</span>
imputer.fit(df_numeric)
df[numeric_features] = imputer.transform(df_numeric)
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå¤„ç†ç¼ºå¤±å€¼åï¼š"</span>)
<span class="hljs-built_in">print</span>(df)
â€‹
standard_scaler = StandardScaler()
â€‹
df_numeric = df[[<span class="hljs-string">'age'</span>, <span class="hljs-string">'salary'</span>]]
<span class="hljs-comment"># æ ¹æ®æ•°æ®è®­ç»ƒç”Ÿæˆæ¨¡å‹</span>
standard_scaler.fit(df_numeric)
<span class="hljs-comment"># æ ¹æ®æ¨¡å‹è®­ç»ƒæ•°æ®</span>
df_standardized = standard_scaler.transform(df_numeric)
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ ‡å‡†åŒ–åçš„æ•°å€¼ç‰¹å¾ï¼š"</span>)
<span class="hljs-built_in">print</span>(df_standardized)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ‡å‡†åŒ–åçš„æ–¹å·®ï¼š<span class="hljs-subst">{df_standardized.std()}</span>"</span>)
</code></pre>
<p>è¿è¡Œè¾“å‡ºï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[[-0.68032458 -0.17837652]</span>
 <span class="hljs-selector-attr">[-0.30923844  0. Â  Â  Â   ]</span>
 <span class="hljs-selector-attr">[ 0. Â  Â  Â  Â   0.26756478]</span>
 <span class="hljs-selector-attr">[ 0.80401995  0. Â  Â  Â   ]</span>
 <span class="hljs-selector-attr">[ 1.91727835  2.05132995]</span>
 <span class="hljs-selector-attr">[-0.30923844 -0.62431781]</span>
 <span class="hljs-selector-attr">[-1.42249684 -1.51620039]</span>]
</code></pre>
<p>æ•°å­¦çŸ¥è¯†ï¼Œä»€ä¹ˆæ˜¯æ ‡å‡†æ­£å¤ªåˆ†å¸ƒï¼š</p>
<p>æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¾ç¤ºä¸ºå…¸å‹çš„é’Ÿå½¢æ›²çº¿ï¼Œè¿™ä¸€å½¢çŠ¶ç±»ä¼¼äºå¯ºåº™ä¸­çš„å¤§é’Ÿï¼Œå› æ­¤ä¹Ÿå¸¸è¢«ç§°ä¸ºé’Ÿå½¢æ›²çº¿ã€‚ä½œä¸ºä¸€ç§è¿ç»­åˆ†å¸ƒï¼Œæ­£æ€åˆ†å¸ƒæ‹¥æœ‰å®Œå¤‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€çŸ©ç”Ÿæˆå‡½æ•°å’Œç‰¹å¾å‡½æ•°ç­‰è¡¨è¾¾å½¢å¼ï¼Œå¹¶ä¸”å…·å¤‡æ˜ç¡®çš„æœŸæœ›ï¼ˆå³å‡å€¼ï¼‰ã€æ–¹å·®ã€ååº¦å’Œå³°åº¦ç­‰æ•°å€¼ç‰¹å¾ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æŠ˜çº¿å›¾çš„å¥‡å¦™å˜å¥ï¼šå››ç§åˆ›æ„å¯è§†åŒ–æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7598465042968592424</link>    <guid>https://juejin.cn/post/7598465042968592424</guid>    <pubDate>2026-01-24T10:07:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598465042968592424" data-draft-id="7598480267218010146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æŠ˜çº¿å›¾çš„å¥‡å¦™å˜å¥ï¼šå››ç§åˆ›æ„å¯è§†åŒ–æ–¹æ³•"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–,æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2026-01-24T10:07:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æŠ˜çº¿å›¾çš„å¥‡å¦™å˜å¥ï¼šå››ç§åˆ›æ„å¯è§†åŒ–æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:07:50.000Z" title="Sat Jan 24 2026 10:07:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æƒ³è±¡ä¸€ä¸‹æŠ˜çº¿å›¾å°±åƒä¸€æ¡æ™®é€šçš„å…¬è·¯ï¼Œå®ƒèƒ½å¸¦æˆ‘ä»¬ä»Aç‚¹åˆ°è¾¾Bç‚¹ã€‚</p>
<p>ä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›´ç‰¹åˆ«çš„è·¯çº¿ï¼š<strong>ç¯å²›</strong>ã€<strong>ç›˜å±±å…¬è·¯</strong>ã€<strong>æ³¢æµªå½¢èµ›é“</strong>æˆ–<strong>èºæ—‹ä¸Šå‡</strong>çš„é€šé“ã€‚</p>
<p>åœ¨æ•°æ®å¯è§†åŒ–ä¸­ï¼Œæ ‡å‡†çš„æŠ˜çº¿å›¾æœ‰æ—¶æ— æ³•å……åˆ†å±•ç¤ºæ•°æ®çš„ç‰¹æ€§ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä¸€äº›åˆ›æ„å˜ç§ã€‚</p>
<p>ä»Šå¤©å°†ä»‹ç»å››ç§ç‰¹åˆ«çš„æŠ˜çº¿å›¾å˜ä½“ï¼Œå®ƒä»¬å„æœ‰æ‰€é•¿ï¼Œèƒ½è®©ä½ çš„æ•°æ®æ•…äº‹æ›´åŠ ç”ŸåŠ¨ã€‚</p>
<h2 data-id="heading-0">1. åœ†å½¢æŠ˜çº¿å›¾ï¼šæ—¶é—´çš„è½®å›</h2>
<p>å¦‚æœæŠŠæ™®é€šçš„æŠ˜çº¿å›¾é¦–å°¾ç›¸è¿ï¼Œæ”¾åœ¨åœ†å½¢åæ ‡ç³»ä¸­ï¼Œå°±å¾—åˆ°äº†åœ†å½¢æŠ˜çº¿å›¾ã€‚</p>
<p>å®ƒç‰¹åˆ«é€‚åˆå±•ç¤º<strong>å‘¨æœŸæ€§æ•°æ®</strong>ï¼Œæ¯”å¦‚ä¸€å¤©24å°æ—¶çš„æ¸©åº¦å˜åŒ–ã€ä¸€å‘¨ä¸ƒå¤©çš„é”€å”®æ•°æ®ï¼Œæˆ–è€…ä¸€å¹´å››å­£çš„æ°”å€™æ¨¡å¼ã€‚</p>
<p>å®ƒçš„<strong>å®ç°åŸç†</strong>æ˜¯ï¼šä½¿ç”¨<strong>æåæ ‡</strong>ç³»ç»Ÿï¼Œå°†è§’åº¦ä»£è¡¨æ—¶é—´æˆ–ç±»åˆ«ï¼ŒåŠå¾„ä»£è¡¨æ•°å€¼å¤§å°ã€‚</p>
<p>åœ¨<code>matplotlib</code>ä¸­ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªæåæ ‡å­å›¾ï¼Œç„¶ååƒæ™®é€šæŠ˜çº¿å›¾ä¸€æ ·ç»˜åˆ¶å³å¯ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ†å½¢æŠ˜çº¿å›¾</span>
<span class="hljs-comment"># æ•°æ®å‡†å¤‡</span>
hours = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">2</span> * np.pi, <span class="hljs-number">24</span>, endpoint=<span class="hljs-literal">False</span>)
values = [] <span class="hljs-comment"># ....</span>
<span class="hljs-comment"># é—­åˆæ•°æ®</span>
values_cycle = np.concatenate((values, [values[<span class="hljs-number">0</span>]]))
hours_cycle = np.concatenate((hours, [hours[<span class="hljs-number">0</span>]]))
hour_labels = [<span class="hljs-string">f"<span class="hljs-subst">{h}</span>ç‚¹"</span> <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>)]

fig = plt.figure(figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># --- å·¦å›¾ï¼šæ™®é€šæŠ˜çº¿å›¾ ---</span>
ax1 = fig.add_subplot(<span class="hljs-number">121</span>)
ax1.plot(<span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>), values, marker=<span class="hljs-string">"o"</span>, color=<span class="hljs-string">"#FF6B6B"</span>)
<span class="hljs-comment"># çœç•¥...</span>

<span class="hljs-comment"># --- å³å›¾ï¼šåœ†å½¢æŠ˜çº¿å›¾ ---</span>
ax2 = fig.add_subplot(<span class="hljs-number">122</span>, projection=<span class="hljs-string">"polar"</span>)
ax2.plot(hours_cycle, values_cycle, linewidth=<span class="hljs-number">2</span>, color=<span class="hljs-string">"#FF6B6B"</span>)
<span class="hljs-comment"># çœç•¥...</span>

plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2d09494c6a34965b87ebc8f9c565532~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769854070&amp;x-signature=vnNZTd0sfA2b9grSk73IrKMfJuc%3D" alt="" loading="lazy"/></p>
<p><strong>åœ†å½¢æŠ˜çº¿å›¾</strong>åœ¨è¿™ç§åœºæ™¯ä¸‹çš„ä¼˜åŠ¿åœ¨äº <strong>å‘¨æœŸæ€§çš„é—­ç¯æ„Ÿ</strong>ã€‚</p>
<ul>
<li><strong>å·¦å›¾</strong>ï¼ˆæ™®é€šï¼‰ï¼š åƒæŠŠè¿™ä¸€å¤©çš„æ—¶é—´åˆ‡æ–­äº†ï¼Œ23:00 å’Œ 00:00 åˆ†éš”åœ¨ä¸¤ç«¯ï¼Œçœ‹ä¸å‡ºå®ƒä»¬å…¶å®ç´§æŒ¨ç€ã€‚</li>
<li><strong>å³å›¾</strong>ï¼ˆåœ†å½¢ï¼‰ï¼š å®Œç¾é—­åˆã€‚ä½ èƒ½ç›´è§‚åœ°æ„Ÿå—åˆ°â€œæ·±å¤œâ€æ˜¯ä¸€ä¸ªè¿ç»­çš„æ—¶é—´æ®µã€‚</li>
</ul>
<h2 data-id="heading-1">2. æ–œç‡å›¾ï¼šå˜åŒ–çš„å¿«ç…§</h2>
<p>æƒ³è±¡ä¸€ä¸‹æ¯”è¾ƒä¸¤ä¸ªäººä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·‘æ­¥é€Ÿåº¦ã€‚</p>
<p><strong>æ–œç‡å›¾</strong>å°±åƒä¸¤å¼ å¿«ç…§ï¼šä¸€å¼ åœ¨èµ·ç‚¹ï¼Œä¸€å¼ åœ¨ç»ˆç‚¹ï¼Œä¸­é—´ç”¨ç›´çº¿è¿æ¥ã€‚</p>
<p>çº¿çš„æ–œç‡ä»£è¡¨äº†å˜åŒ–çš„é€Ÿç‡ï¼Œé™¡å³­çš„ä¸Šå¡è¡¨ç¤ºå¤§å¹…å¢é•¿ï¼Œå¹³ç¼“çš„çº¿è¡¨ç¤ºå˜åŒ–ä¸å¤§ï¼Œä¸‹å¡åˆ™è¡¨ç¤ºä¸‹é™ã€‚</p>
<p>å®ƒçš„<strong>å®ç°åŸç†</strong>ï¼šé€šå¸¸åœ¨ä¸¤ä¾§æ˜¾ç¤ºä¸¤ä¸ªæ—¶é—´ç‚¹æˆ–ä¸¤ç§çŠ¶æ€çš„æ•°æ®ï¼Œç„¶åç”¨ç›´çº¿è¿æ¥å¯¹åº”çš„æ•°æ®ç‚¹ã€‚</p>
<p>çº¿çš„<strong>æ–œç‡</strong>ç›´è§‚å±•ç¤ºäº†å˜åŒ–çš„<strong>å¤§å°å’Œæ–¹å‘</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–œç‡å›¾</span>
<span class="hljs-comment"># æ•°æ®</span>
depts = [<span class="hljs-string">'é”€å”®éƒ¨'</span>, <span class="hljs-string">'äººäº‹éƒ¨'</span>, <span class="hljs-string">'æŠ€æœ¯éƒ¨'</span>, <span class="hljs-string">'ç ”å‘éƒ¨'</span>, <span class="hljs-string">'å¸‚åœºéƒ¨'</span>]
score_before = [<span class="hljs-number">65</span>, <span class="hljs-number">70</span>, <span class="hljs-number">88</span>, <span class="hljs-number">85</span>, <span class="hljs-number">60</span>]
score_after = [<span class="hljs-number">85</span>, <span class="hljs-number">68</span>, <span class="hljs-number">92</span>, <span class="hljs-number">80</span>, <span class="hljs-number">90</span>]

fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># --- å·¦å›¾ï¼šæ™®é€šæŠ˜çº¿å›¾ ---</span>
x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] <span class="hljs-comment"># ä»£è¡¨å‰åä¸¤ä¸ªæ—¶é—´ç‚¹</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(depts)):
    ax1.plot(x, [score_before[i], score_after[i]], marker=<span class="hljs-string">'o'</span>, label=depts[i])
<span class="hljs-comment"># çœç•¥ ...</span>

<span class="hljs-comment"># --- å³å›¾ï¼šæ–œç‡å›¾ ---</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(depts)):
    color = <span class="hljs-string">'green'</span> <span class="hljs-keyword">if</span> score_after[i] &gt; score_before[i] <span class="hljs-keyword">else</span> <span class="hljs-string">'red'</span>
    <span class="hljs-comment"># ç»˜åˆ¶çº¿æ¡</span>
    ax2.plot([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [score_before[i], score_after[i]], color=color, marker=<span class="hljs-string">'o'</span>, linewidth=<span class="hljs-number">2</span>)
    <span class="hljs-comment"># ç›´æ¥åœ¨ç‚¹æ—è¾¹æ ‡æ³¨æ–‡å­—ï¼Œå»é™¤å›¾ä¾‹æŸ¥æ‰¾çš„è´Ÿæ‹…</span>
    ax2.text(-<span class="hljs-number">0.05</span>, score_before[i], <span class="hljs-string">f"<span class="hljs-subst">{depts[i]}</span> <span class="hljs-subst">{score_before[i]}</span>"</span>, ha=<span class="hljs-string">'right'</span>, va=<span class="hljs-string">'center'</span>)
    ax2.text(<span class="hljs-number">1.05</span>, score_after[i], <span class="hljs-string">f"<span class="hljs-subst">{score_after[i]}</span>"</span>, ha=<span class="hljs-string">'left'</span>, va=<span class="hljs-string">'center'</span>)

<span class="hljs-comment"># çœç•¥ ...</span>

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59346670e0c84b9b924039e0cfe9876f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769854070&amp;x-signature=UAZtkxlX7viqsEPQCU0nSkhCe3k%3D" alt="" loading="lazy"/></p>
<p><strong>æ–œç‡å›¾</strong>åœ¨è¿™ç§åœºæ™¯ä¸‹çš„ä¼˜åŠ¿åœ¨äº <strong>æç®€çš„å˜åŒ–è¶‹åŠ¿</strong>ã€‚</p>
<ul>
<li><strong>å·¦å›¾</strong>ï¼ˆæ™®é€šï¼‰ï¼š è™½ç„¶ä¹Ÿèƒ½çœ‹ï¼Œä½†åœ¨åæ ‡è½´çš„å¹²æ‰°ä¸‹ï¼Œä½ éœ€è¦ç›¯ç€è¯»æ•°çœ‹ã€‚</li>
<li><strong>å³å›¾</strong>ï¼ˆæ–œç‡ï¼‰ï¼š å»æ‰äº†å¤šä½™çš„åˆ»åº¦çº¿ï¼Œåªä¿ç•™é¦–å°¾ã€‚çº¿æ¡è¶Šé™¡å³­ï¼Œä»£è¡¨å˜åŒ–è¶Šå‰§çƒˆã€‚è¿™å°±åƒæ˜¯ä»â€œé˜…è¯»è¯´æ˜ä¹¦â€å˜æˆäº†â€œçœ‹çº¢ç»¿ç¯â€ï¼Œä¸€ç›®äº†ç„¶ã€‚</li>
</ul>
<h2 data-id="heading-2">3. å‡¹å‡¸å›¾ï¼šæ’åçš„èˆè¹ˆ</h2>
<p>æƒ³è±¡ä¸€ä¸‹èµ›è·‘ä¸­çš„åæ¬¡å˜åŒ–ï¼šèµ·è·‘æ—¶Aé¢†å…ˆï¼Œä¸­é€”Båè¶…ï¼Œæœ€åCå†²åˆºå¤ºå† ã€‚</p>
<p><strong>å‡¹å‡¸å›¾</strong>å°±åƒè®°å½•è¿™åœºæ¯”èµ›çš„åæ¬¡å˜åŒ–è¡¨ï¼Œæ¯ä¸ªæ—¶é—´ç‚¹è°åœ¨å‰è°åœ¨åä¸€ç›®äº†ç„¶ã€‚</p>
<p>å®ƒçš„<strong>å®ç°åŸç†</strong>ï¼šé€šå¸¸å±•ç¤ºå¤šä¸ªé¡¹ç›®åœ¨ä¸åŒæ—¶é—´ç‚¹çš„æ’åå˜åŒ–ã€‚</p>
<p>æ¯ä¸ªé¡¹ç›®æœ‰ä¸€æ¡çº¿ï¼Œçº¿çš„ä¸Šä¸‹ä½ç½®ä»£è¡¨æ’åé«˜ä½ã€‚ç”±äºæ’åæ˜¯ç›¸å¯¹çš„ï¼Œæ‰€ä»¥è¿™äº›çº¿æ€»ä¼šäº¤å‰ï¼Œå½¢æˆæœ‰è¶£çš„æ³¢æµªå½¢ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‡¹å‡¸å›¾</span>
years = [<span class="hljs-number">2019</span>, <span class="hljs-number">2020</span>, <span class="hljs-number">2021</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">2023</span>]
<span class="hljs-comment"># æ’åæ•°æ®</span>
ranks = {
    <span class="hljs-string">'å“ç‰ŒA'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
    <span class="hljs-string">'å“ç‰ŒB'</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    <span class="hljs-string">'å“ç‰ŒC'</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],
    <span class="hljs-string">'å“ç‰ŒD'</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>]
}
colors = [<span class="hljs-string">'#1f77b4'</span>, <span class="hljs-string">'#ff7f0e'</span>, <span class="hljs-string">'#2ca02c'</span>, <span class="hljs-string">'#d62728'</span>]

fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># --- å·¦å›¾ï¼šæ™®é€šæŠ˜çº¿å›¾ (æ¨¡æ‹Ÿæ•°å€¼éå¸¸æ¥è¿‘çš„æƒ…å†µ) ---</span>
<span class="hljs-comment"># å‡è®¾æ’åå¯¹åº”çš„æ•°å€¼å¾ˆæ¥è¿‘ï¼Œå¾ˆéš¾çœ‹æ¸…</span>
values_simulated = {
    <span class="hljs-string">'å“ç‰ŒA'</span>: [<span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">25</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>],
    <span class="hljs-string">'å“ç‰ŒB'</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>, <span class="hljs-number">32</span>, <span class="hljs-number">28</span>],
    <span class="hljs-string">'å“ç‰ŒC'</span>: [<span class="hljs-number">25</span>, <span class="hljs-number">12</span>, <span class="hljs-number">22</span>, <span class="hljs-number">28</span>, <span class="hljs-number">35</span>],
    <span class="hljs-string">'å“ç‰ŒD'</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">22</span>, <span class="hljs-number">18</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>]
}

<span class="hljs-keyword">for</span> brand, val_list <span class="hljs-keyword">in</span> values_simulated.items():
    ax1.plot(years, val_list, marker=<span class="hljs-string">'o'</span>, label=brand)

<span class="hljs-comment"># çœç•¥ ...</span>

<span class="hljs-comment"># --- å³å›¾ï¼šå‡¹å‡¸å›¾ ---</span>
<span class="hljs-keyword">for</span> idx, (brand, rank_list) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ranks.items()):
    ax2.plot(years, rank_list, marker=<span class="hljs-string">'o'</span>, markersize=<span class="hljs-number">15</span>, linewidth=<span class="hljs-number">4</span>, label=brand, color=colors[idx])
    <span class="hljs-comment"># åœ¨åœ†ç‚¹ä¸­å†™ä¸Šåæ¬¡</span>
    <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(years, rank_list):
        ax2.text(x, y, <span class="hljs-built_in">str</span>(y), color=<span class="hljs-string">'white'</span>, ha=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'center'</span>, fontweight=<span class="hljs-string">'bold'</span>)

ax2.invert_yaxis() <span class="hljs-comment"># å…³é”®ï¼šå€’è½¬Yè½´ï¼Œè®©ç¬¬1ååœ¨æœ€ä¸Šé¢</span>
<span class="hljs-comment"># çœç•¥ ...</span>

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62b2a2137aa04b0ebb1c482599116031~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769854070&amp;x-signature=EjJjqCP3sDpGhked3Fzirlx%2FQbI%3D" alt="" loading="lazy"/></p>
<p><strong>å‡¹å‡¸å›¾</strong>åœ¨è¿™ç§åœºæ™¯ä¸‹çš„ä¼˜åŠ¿åœ¨äº <strong>æ’åçš„æ›´æ›¿</strong>ã€‚</p>
<ul>
<li><strong>å·¦å›¾</strong>ï¼ˆæ™®é€šï¼‰ï¼š æˆ‘ä»¬é€šå¸¸ç”»çš„æ˜¯â€œæ•°å€¼â€ã€‚å¦‚æœå››ä¸ªå“ç‰Œçš„å¸‚åœºä»½é¢å¾ˆæ¥è¿‘ï¼ˆæ¯”å¦‚20%å’Œ21%ï¼‰ï¼Œçº¿æ¡ä¼šç²˜è¿åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾çœ‹æ¸…è°ç¬¬ä¸€è°ç¬¬äºŒã€‚</li>
<li><strong>å³å›¾</strong>ï¼ˆå‡¹å‡¸ï¼‰ï¼š Yè½´ä¸å†æ˜¯æ•°å€¼ï¼Œè€Œæ˜¯â€œåæ¬¡â€ã€‚è¿™é‡Œå°†æ’åå‡åŒ€æ‹‰å¼€ï¼Œä½ å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°å“ç‰ŒCæ˜¯å¦‚ä½•åƒé»‘é©¬ä¸€æ ·ä»æœ€åä¸€åæ€åˆ°ç¬¬ä¸€åçš„ã€‚</li>
</ul>
<h2 data-id="heading-3">4. å‘¨æœŸå›¾ï¼šæ¨¡å¼çš„æ”¾å¤§é•œ</h2>
<p>æƒ³è±¡ä¸€ä¸‹è§‚å¯Ÿä¸€å¹´çš„æ¸©åº¦å˜åŒ–ã€‚</p>
<p>æ™®é€šæŠ˜çº¿å›¾ä¼šæ˜¾ç¤ºä¸€æ¡æœ‰365ä¸ªç‚¹çš„æ³¢æµªçº¿ï¼Œ<strong>å‘¨æœŸå›¾</strong>åˆ™æŠŠè¿™365å¤©åˆ†æˆ12ä¸ªæœˆï¼ŒæŠŠæ¯ä¸ªæœˆçš„31å¤©å åŠ åœ¨ä¸€èµ·æ¯”è¾ƒï¼Œå°±åƒæŠŠä¸€å¹´çš„æ¸©åº¦æ›²çº¿åˆ‡æˆ12æ®µï¼Œç„¶åå¹¶æ’æ”¾åœ¨ä¸€èµ·ã€‚</p>
<p>å®ƒçš„å®ç°åŸç†ï¼šå°†æ—¶é—´åºåˆ—æ•°æ®æŒ‰ç…§å‘¨æœŸï¼ˆå¤©ã€å‘¨ã€æœˆã€å¹´ç­‰ï¼‰åˆ‡åˆ†ï¼Œç„¶åå°†æ¯ä¸ªå‘¨æœŸé‡å ç»˜åˆ¶ã€‚</p>
<p>è¿™æ ·å¯ä»¥ç›´è§‚æ¯”è¾ƒä¸åŒå‘¨æœŸå†…çš„æ¨¡å¼æ˜¯å¦ç›¸ä¼¼ï¼Œä»¥åŠæ¯ä¸ªå‘¨æœŸç›¸å¯¹äºæ•´ä½“çš„è¡¨ç°ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‘¨æœŸå›¾</span>
months = [<span class="hljs-string">'1æœˆ'</span>, <span class="hljs-string">'2æœˆ'</span>, <span class="hljs-string">'3æœˆ'</span>, <span class="hljs-string">'4æœˆ'</span>, <span class="hljs-string">'5æœˆ'</span>, <span class="hljs-string">'6æœˆ'</span>, <span class="hljs-string">'7æœˆ'</span>, <span class="hljs-string">'8æœˆ'</span>, <span class="hljs-string">'9æœˆ'</span>, <span class="hljs-string">'10æœˆ'</span>, <span class="hljs-string">'11æœˆ'</span>, <span class="hljs-string">'12æœˆ'</span>]
<span class="hljs-comment"># æ¨¡æ‹Ÿé•¿æ•°æ®</span>
sales_2021 = [<span class="hljs-number">20</span>, <span class="hljs-number">25</span>, <span class="hljs-number">35</span>, <span class="hljs-number">50</span>, <span class="hljs-number">80</span>, <span class="hljs-number">100</span>, <span class="hljs-number">110</span>, <span class="hljs-number">105</span>, <span class="hljs-number">70</span>, <span class="hljs-number">50</span>, <span class="hljs-number">30</span>, <span class="hljs-number">25</span>]
sales_2022 = [<span class="hljs-number">22</span>, <span class="hljs-number">28</span>, <span class="hljs-number">40</span>, <span class="hljs-number">55</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">115</span>, <span class="hljs-number">100</span>, <span class="hljs-number">75</span>, <span class="hljs-number">55</span>, <span class="hljs-number">35</span>, <span class="hljs-number">28</span>]
sales_2023 = [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">95</span>, <span class="hljs-number">120</span>, <span class="hljs-number">130</span>, <span class="hljs-number">115</span>, <span class="hljs-number">80</span>, <span class="hljs-number">60</span>, <span class="hljs-number">40</span>, <span class="hljs-number">35</span>]

fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># --- å·¦å›¾ï¼šæ™®é€šæŠ˜çº¿å›¾ (çº¿æ€§æ—¶é—´è½´) ---</span>
<span class="hljs-comment"># æŠŠæ‰€æœ‰æ•°æ®æ‹¼æˆä¸€æ¡é•¿çº¿</span>
all_sales = sales_2021 + sales_2022 + sales_2023
all_months_idx = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(all_sales))

ax1.plot(all_months_idx, all_sales, color=<span class="hljs-string">'#3498db'</span>, linewidth=<span class="hljs-number">2</span>)
<span class="hljs-comment"># çœç•¥ ...</span>

<span class="hljs-comment"># --- å³å›¾ï¼šå‘¨æœŸå›¾ (å åŠ æ—¶é—´è½´) ---</span>
ax2.plot(months, sales_2021, marker=<span class="hljs-string">'.'</span>, label=<span class="hljs-string">'2021å¹´'</span>, color=<span class="hljs-string">'lightgrey'</span>, linewidth=<span class="hljs-number">2</span>, linestyle=<span class="hljs-string">'--'</span>)
ax2.plot(months, sales_2022, marker=<span class="hljs-string">'.'</span>, label=<span class="hljs-string">'2022å¹´'</span>, color=<span class="hljs-string">'grey'</span>, linewidth=<span class="hljs-number">2</span>, linestyle=<span class="hljs-string">'--'</span>)
ax2.plot(months, sales_2023, marker=<span class="hljs-string">'o'</span>, label=<span class="hljs-string">'2023å¹´'</span>, color=<span class="hljs-string">'#3498db'</span>, linewidth=<span class="hljs-number">3</span>)
<span class="hljs-comment"># çœç•¥ ...</span>

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b52a1c7bf5794b26a51995308fe4f4fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769854070&amp;x-signature=dPDaYKtuoZkRTsbBLi76VZ%2BUi54%3D" alt="" loading="lazy"/></p>
<p><strong>å‘¨æœŸå›¾</strong>åœ¨è¿™ç§åœºæ™¯ä¸‹çš„ä¼˜åŠ¿åœ¨äº <strong>å­£èŠ‚æ€§æ¨¡å¼çš„è¯†åˆ«</strong>ã€‚</p>
<ul>
<li><strong>å·¦å›¾</strong>ï¼ˆæ™®é€šï¼‰ï¼š ä¸€æ¡é•¿çº¿è¿ç»µä¸æ–­ã€‚æƒ³è¦å¯¹æ¯”2021å¹´7æœˆå’Œ2023å¹´7æœˆçš„æ•°æ®ï¼Œçœ¼ç›éœ€è¦åœ¨å›¾è¡¨å·¦å³ä¸¤ç«¯æ¥å›æ¨ªè·³ï¼Œéå¸¸ç´¯ã€‚</li>
<li><strong>å³å›¾</strong>ï¼ˆå‘¨æœŸï¼‰ï¼š å°±åƒæŠŠæ¯å¹´çš„æ•°æ®â€œå â€åœ¨äº†ä¸€èµ·ã€‚ä½ å¯ä»¥ç›´æ¥çœ‹åˆ°ï¼Œæ— è®ºå“ªä¸€å¹´ï¼Œ7æœˆéƒ½æ˜¯æœ€é«˜å³°ï¼Œè€Œ12æœˆéƒ½æ˜¯ä½è°·ã€‚è§„å¾‹ä¸€ç›®äº†ç„¶ã€‚</li>
</ul>
<h2 data-id="heading-4">5. æ€»ç»“</h2>
<p>æ¯ç§æŠ˜çº¿å›¾å˜ä½“éƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä»·å€¼ï¼š</p>
<ul>
<li><strong>åœ†å½¢æŠ˜çº¿å›¾</strong>ï¼šé€‚åˆå±•ç¤ºå‘¨æœŸæ€§æ•°æ®ï¼Œé¦–å°¾ç›¸æ¥çš„è®¾è®¡å¼ºè°ƒå¾ªç¯</li>
<li><strong>æ–œç‡å›¾</strong>ï¼šé€‚åˆæ¯”è¾ƒä¸¤ä¸ªæ—¶é—´ç‚¹çš„å˜åŒ–ï¼Œç›´è§‚å±•ç¤ºå˜åŒ–å¹…åº¦</li>
<li><strong>å‡¹å‡¸å›¾</strong>ï¼šé€‚åˆå±•ç¤ºæ’åæˆ–ç›¸å¯¹ä½ç½®çš„å˜åŒ–ï¼Œç«äº‰å…³ç³»ä¸€ç›®äº†ç„¶</li>
<li><strong>å‘¨æœŸå›¾</strong>ï¼šé€‚åˆæ¯”è¾ƒå¤šä¸ªå‘¨æœŸçš„æ¨¡å¼ï¼Œå‘ç°å­£èŠ‚æ€§è§„å¾‹</li>
</ul>
<p>å®é™…æƒ…å†µä¸‹ï¼Œé€‰æ‹©å“ªç§å˜ä½“å–å†³äºä½ çš„æ•°æ®ç‰¹ç‚¹å’Œæƒ³è¦ä¼ è¾¾çš„ä¿¡æ¯ã€‚</p>
<p><strong>å…³é”®</strong>æ˜¯è¦è®°ä½ï¼šå¯è§†åŒ–ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œè€Œæ˜¯ä¸ºäº†æ›´å¥½åœ°è®²è¿°æ•°æ®æ•…äº‹ã€‚ä¸‹æ¬¡å½“æˆ‘ä»¬é¢å¯¹æ•°æ®æ—¶ï¼Œä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼Œå“ªç§"å˜å½¢"çš„æŠ˜çº¿å›¾èƒ½è®©ä½ çš„æ•…äº‹æ›´åŠ åŠ¨äººã€‚</p>
<p>å®Œæ•´çš„ä»£ç å…±äº«åœ¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Furl11.ctfile.com%2Ff%2F45455611-8634430461-e0154d%3Fp%3D6872" target="_blank" title="https://url11.ctfile.com/f/45455611-8634430461-e0154d?p=6872" ref="nofollow noopener noreferrer">æŠ˜çº¿å›¾çš„4ä¸ªå˜ç§.ipynb</a> (è®¿é—®å¯†ç : 6872)</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Traeçš„è¿‡å»ä¸ç°åœ¨]]></title>    <link>https://juejin.cn/post/7598472744480997395</link>    <guid>https://juejin.cn/post/7598472744480997395</guid>    <pubDate>2026-01-24T09:42:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598472744480997395" data-draft-id="7598472744480882707" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Traeçš„è¿‡å»ä¸ç°åœ¨"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2026-01-24T09:42:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="arriettyandray"/> <meta itemprop="url" content="https://juejin.cn/user/3353942203304611"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Traeçš„è¿‡å»ä¸ç°åœ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3353942203304611/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    arriettyandray
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:42:24.000Z" title="Sat Jan 24 2026 09:42:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘å’ŒTraeçš„æ¥è§¦æ˜¯åœ¨25å¹´5æœˆï¼Œä¸šä½™æ—¶é—´æƒ³å­¦ä¹ ä¸€ä¸‹å¤§æ¨¡å‹ï¼Œåˆšå¥½æ˜é‡‘åœ¨æ¨å¹¿Traeï¼Œæƒ³ç€ä¹Ÿæ˜¯å­¦ä¹ ï¼Œä¸‹ç€å­¦ä¹ ä¸€ä¸‹ã€‚äºæ˜¯åœ¨ä¸ºæ•°ä¸å¤šçš„æ—¶é—´é‡Œï¼Œæœ‰ä¸€æ®µå¯†é›†çš„ä½¿ç”¨æ—¶é—´ï¼Œæ™šä¸Šå°±ç ”ç©¶å¤§æ¨¡å‹å’ŒTraeçš„ä½¿ç”¨ï¼Œä¹Ÿç•™ä¸‹äº†å‡ ç¯‡å’ŒTraeç›¸å…³çš„æ–‡ç« ã€‚</p>
<h2 data-id="heading-0">Traeçš„è¿‡å»</h2>
<ul>
<li>Traeæ­å»ºäº†æˆ‘çš„å°å°Transformeræ¨¡å‹</li>
<li>ç”¨è´ªåƒè›‡æ¸¸æˆæ¥ä½“éªŒä¸€ä¸‹Trae</li>
</ul>
<p>æˆ‘å°è¯•ä½¿ç”¨Traeæ¥æ­å»ºäº†å°å°Transformeræ¨¡å‹ä»¥åŠä½¿ç”¨Traeæ¥å®Œæˆè´ªåƒè›‡çš„æ¸¸æˆã€‚åœ¨æ­å»ºTransformeræ¨¡å‹æ—¶ï¼Œç®€å•çš„ä¸¤å¥è¯ï¼Œå°±è®©Traeå®Œæˆäº†ç®€å•çš„æ¨¡å‹æ­å»ºï¼Œé€Ÿåº¦çš„æä¾›ä»£ç ä¾›æˆ‘å­¦ä¹ ã€‚è€Œè´ªåƒè›‡çš„æ¸¸æˆæ›´æ˜¯å¯ä»¥å»ºç«‹æ–°æ–‡ä»¶ï¼Œç›´æ¥å†™å¥½ç®€å•Demoè¿›è¡Œè¿è¡Œçš„å°æ¸¸æˆã€‚
è€Œåœ¨è´ªåƒè›‡å°æ¸¸æˆçš„æµ‹è¯„æ—¶ï¼Œæˆ‘å°è±¡æœ€æ·±æ—¶å®ƒæ¨å‡ºæ¥çš„æ–°åŠŸèƒ½ï¼Œå¯ä»¥<strong>MCPè¿›è¡Œç¬¬ä¸‰æ–¹æœåŠ¡ä½¿ç”¨</strong>ã€‚æˆ‘çœ‹è¿‡åˆ«äººæ–‡ç« ä¸­åœ¨ä¸åŒè½¯ä»¶ä¸­æ·»åŠ MCPï¼Œç”Ÿæˆå¾ˆæœ‰æ„æ€çš„æˆæœã€‚ä¾‹å¦‚æ—…æ¸¸è®¡åˆ’ï¼Œç¬é—´å°†Traeçš„ä½¿ç”¨æå‡äº†ä¸€ä¸ªLevelã€‚</p>
<h2 data-id="heading-1">Traeçš„ç°åœ¨</h2>
<p>å¦‚ä»Šï¼Œæ—¶éš”8ä¸ªæœˆè¿‡å»äº†ï¼Œæˆ‘å†æ¬¡ä¸‹è½½Traeï¼Œå®ƒå·²ç»ä¸æ˜¯å°è±¡ä¸­ç®€å•çš„ç™½çº¢çš„å°å›¾æ ‡ï¼Œè€Œæ˜¯ä¸€ä¸ªç‚«é…·çš„é»‘ç»¿çš„ä¸€ç§è¿­ä»£ã€‚æˆ‘æƒ³å†ä¸€æ¬¡ç”¨è´ªåƒè›‡æ¸¸æˆæ¥ä½“éªŒä¸€ä¸‹Traeï¼Œçœ‹çœ‹è¿™æ¬¡æ˜¯å¦æœ‰ä¸ä¸€æ ·çš„æƒŠå–œã€‚
ä¸‹è½½æ‰“å¼€ï¼Œæ²¡æƒ³åˆ°åŠ äº†ä¸€ä¸ª<strong>SOLO</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06ed6c60aff84ce7b8335dc97a3e6b8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=cjOKgBU2w8YiSMYPnS3zQiNYQUk%3D" alt="image.png" loading="lazy"/>
ä¸€ç§å…¨æ–°çš„é¢è²Œåœ¨å‘æˆ‘ä»‹ç»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e88bafe1a3124f79b3d534bdb202d9fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=EVWAh7BQCwlgNuDvK%2FAr3f1gE0g%3D" alt="image.png" loading="lazy"/>
è€Œå·¦ä¸Šè§’è¿˜åœç•™åœ¨æˆ‘5æœˆä»½çš„ç¼–ç ç¨‹åºè®°å½•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44f342a1227c4994a9ca9327d68a40e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=bXujSNmzVcTnr4Wba6w%2FBF2yeos%3D" alt="image.png" loading="lazy"/>
ç™»å½•å®Œæˆï¼Œæ¬¢è¿ä½¿ç”¨å…¨æ–°SOLOæ¨¡å¼ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe57e49d046c4a3e81c3c45357fbd0bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=UNVi%2F%2FPAh0MUiE80s1Du22cT7xI%3D" alt="image.png" loading="lazy"/>
å®ƒçš„ä»»åŠ¡æ é‡Œè¿˜æ˜¯æˆ‘5æœˆçš„ä½¿ç”¨è®°å½•ã€‚</p>
<p>ç°åœ¨å¯ä»¥å¼€å§‹ä¸SOLO CoderèŠå¤©äº†ï¼</p>
<ul>
<li>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œåˆè¢«æƒŠè‰³åˆ°äº†ã€‚ç›´æ¥åˆ†è§£ä»»åŠ¡ï¼Œè¿›è¡Œä»»åŠ¡åˆ†è§£ï¼Œç„¶åå®Œæˆæ¯é¡¹ä»»åŠ¡ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7459c040775a4dc39faab42a82612366~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=6QnOW2%2F6J6Y%2FH%2FadPNbYuk3nMW0%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>åœ¨æˆ‘åªæ˜¯ç®€å•çš„ç¼–è¾‘è¿™ç¯‡æ–‡ç« çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒå·²ç»å®Œæˆè´ªåƒè›‡çš„æ¸¸æˆçš„åˆ¶ä½œã€‚ç”šè‡³å­˜æ”¾æ–‡ä»¶çš„ä½ç½®è¿˜æ˜¯å»å¹´5æœˆä»½ä½¿ç”¨å®ƒæ—¶ç”¨çš„ä½ç½®ã€‚å¹¶ä¸”åœ¨å®Œæˆåï¼Œå®ƒä¸»åŠ¨ç»™æˆ‘æ‰“å¼€äº†æµè§ˆå™¨ï¼Œæ¸¸æˆå·²ç»è·‘èµ·æ¥äº†ã€‚ç”»é¢æ¯”ä¹‹å‰çš„ç”»é¢ä¸æ¸¸æˆæ„Ÿè§‰æ›´å¥½äº†ï¼</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3730430b5670416db0fe0cb7b86867dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=ErCqUQLTRWquqQmDnBgKy3jtxuE%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>æ¥çœ‹ä¸€ä¸‹æœ€åçš„æˆå“å¯¹æ¯”å§ï¼</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd1aecef4f914b08b5011c60922706a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYXJyaWV0dHlhbmRyYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769852544&amp;x-signature=gGQ618kv4oFPCXSIs6VRahX3h1A%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">Traeçš„æœªæ¥</h2>
<p>é€šè¿‡ä¸¤æ¬¡ä½¿ç”¨è´ªåƒè›‡æ¸¸æˆæ¥åšå¯¹æ¯”ï¼Œæˆ‘æ„Ÿè§‰æ•´ä¸ªä½¿ç”¨è¶…çº§ä¸æ»‘ï¼Œæˆå“å‡ºæ¥çš„æ•ˆæœæœ‰äº†è´¨çš„æå‡ã€‚è™½ç„¶2025å¹´ä»…æœ‰å°‘æ•°æ—¶é—´æ¥ç”¨åˆ°Traeï¼Œä½†æ˜¯æˆ‘æƒ³æœªæ¥ä½¿ç”¨Traeçš„æ—¶é—´ä¼šæ›´å¤šï¼ŒæœŸå¾…å®ƒçš„æ¯ä¸€æ¬¡å‡çº§æ”¹å˜ã€‚
æœªæ¥ä¹Ÿè®¸Traeä¼šæœ‰å¾ˆå¤šå˜åŒ–ï¼Œæˆ‘å¸Œæœ›æˆ‘çš„26ä¹Ÿèƒ½è·ŸéšTraeæœ‰ä¸åŒçš„æ”¹å˜ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€æºä¸€ä¸ª markdown-it æ’ä»¶ï¼šè®©ä½ çš„åšå®¢æ”¯æŒ GitHub ç”¨æˆ·æ‚¬æµ®å¡ç‰‡]]></title>    <link>https://juejin.cn/post/7598480413803757610</link>    <guid>https://juejin.cn/post/7598480413803757610</guid>    <pubDate>2026-01-24T10:20:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480413803757610" data-draft-id="7598480413803741226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€æºä¸€ä¸ª markdown-it æ’ä»¶ï¼šè®©ä½ çš„åšå®¢æ”¯æŒ GitHub ç”¨æˆ·æ‚¬æµ®å¡ç‰‡"/> <meta itemprop="keywords" content="Markdown,å¼€æº,GitHub"/> <meta itemprop="datePublished" content="2026-01-24T10:20:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Joie"/> <meta itemprop="url" content="https://juejin.cn/user/3265984436383947"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€æºä¸€ä¸ª markdown-it æ’ä»¶ï¼šè®©ä½ çš„åšå®¢æ”¯æŒ GitHub ç”¨æˆ·æ‚¬æµ®å¡ç‰‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3265984436383947/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Joie
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:20:52.000Z" title="Sat Jan 24 2026 10:20:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€æºä¸€ä¸ª markdown-it æ’ä»¶ï¼šè®©ä½ çš„åšå®¢æ”¯æŒ GitHub ç”¨æˆ·æ‚¬æµ®å¡ç‰‡</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨å†™æŠ€æœ¯åšå®¢æˆ–æ–‡æ¡£æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æåˆ° GitHub ä¸Šçš„å¼€å‘è€…ï¼Œæ¯”å¦‚ã€Œè¿™ä¸ªæ–¹æ¡ˆå‚è€ƒäº† @antfu çš„å®ç°ã€ã€‚ä½†è¯»è€…çœ‹åˆ°è¿™ä¸ª @ æ—¶ï¼Œå¾€å¾€éœ€è¦ç‚¹å‡»è·³è½¬æ‰èƒ½äº†è§£è¿™ä¸ªäººæ˜¯è°ã€‚</p>
<p>èƒ½ä¸èƒ½åƒ GitHub é‚£æ ·ï¼Œé¼ æ ‡æ‚¬åœå°±èƒ½çœ‹åˆ°ç”¨æˆ·ä¿¡æ¯å‘¢ï¼Ÿ</p>
<p>äºæ˜¯æˆ‘å¼€å‘äº†è¿™ä¸ªæ’ä»¶ï¼š<strong>markdown-it-github-mention-card</strong></p>
<h3 data-id="heading-2">æ•ˆæœé¢„è§ˆ</h3>
<p>åœ¨ Markdown ä¸­å†™å…¥ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">è¿™ä¸ªé¡¹ç›®çš„çµæ„Ÿæ¥è‡ª {@antfu} çš„å¼€æºä½œå“ã€‚
</code></pre>
<p>æ¸²æŸ“åï¼Œé¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªç²¾ç¾çš„ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>ç”¨æˆ·å¤´åƒ</li>
<li>ç”¨æˆ·åå’Œç®€ä»‹</li>
<li>åœ°ç†ä½ç½®ã€å…¬å¸ä¿¡æ¯</li>
<li>ç²‰ä¸æ•°ã€å…³æ³¨æ•°ã€å…¬å¼€ä»“åº“æ•°</li>
</ul>
<p>æ— éœ€è·³è½¬é¡µé¢ï¼Œä¿¡æ¯ä¸€ç›®äº†ç„¶ã€‚</p>
<h3 data-id="heading-3">ç‰¹æ€§</h3>
<ul>
<li><strong>è¯­æ³•ç®€æ´</strong>ï¼š<code>{@username}</code> å³å¯ï¼Œæ”¯æŒè‡ªå®šä¹‰æ˜¾ç¤ºæ–‡æœ¬</li>
<li><strong>æ‚¬æµ®å¡ç‰‡</strong>ï¼šè°ƒç”¨ GitHub API å®æ—¶è·å–ç”¨æˆ·ä¿¡æ¯</li>
<li><strong>æš—è‰²æ¨¡å¼</strong>ï¼šè‡ªåŠ¨é€‚é… <code>.dark</code> ä¸»é¢˜ç±»</li>
<li><strong>SSR/SSG å‹å¥½</strong>ï¼šå®Œç¾æ”¯æŒ VitePressã€Nuxtã€Next.js ç­‰æ¡†æ¶</li>
<li><strong>TypeScript</strong>ï¼šå®Œæ•´çš„ç±»å‹å®šä¹‰</li>
<li><strong>è½»é‡æ— ä¾èµ–</strong>ï¼šæ ¸å¿ƒä»£ç ä»…ä¾èµ– markdown-it</li>
</ul>
<h3 data-id="heading-4">å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm</span>
npm install markdown-it-github-mention-card

<span class="hljs-comment"># pnpm</span>
pnpm add markdown-it-github-mention-card

<span class="hljs-comment"># yarn</span>
yarn add markdown-it-github-mention-card
</code></pre>
<h3 data-id="heading-5">åŸºç¡€ä½¿ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MarkdownIt</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MarkdownItGitHubMentionCard</span>, { initHoverCard } <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it-github-mention-card'</span>

<span class="hljs-keyword">const</span> md = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MarkdownIt</span>()
md.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MarkdownItGitHubMentionCard</span>, {
  <span class="hljs-comment">// å¯é€‰ï¼šæé«˜ GitHub API é€Ÿç‡é™åˆ¶</span>
  <span class="hljs-attr">githubToken</span>: <span class="hljs-string">'YOUR_GITHUB_TOKEN'</span>,
})

<span class="hljs-comment">// æ¸²æŸ“ Markdown</span>
<span class="hljs-keyword">const</span> html = md.<span class="hljs-title function_">render</span>(<span class="hljs-string">'{@antfu} æ˜¯ Vue æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜'</span>)
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#app'</span>).<span class="hljs-property">innerHTML</span> = html

<span class="hljs-comment">// åˆå§‹åŒ–æ‚¬æµ®å¡ç‰‡ï¼ˆæµè§ˆå™¨ç«¯è°ƒç”¨ï¼‰</span>
<span class="hljs-title function_">initHoverCard</span>()
</code></pre>
<h3 data-id="heading-6">è¯­æ³•è¯´æ˜</h3>
<p>æ’ä»¶æ”¯æŒä¸‰ç§å†™æ³•ï¼š</p>

























<table><thead><tr><th>è¯­æ³•</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>{@username}</code></td><td>åŸºç¡€ç”¨æ³•</td><td><code>{@antfu}</code> â†’ æ˜¾ç¤º "antfu"</td></tr><tr><td><code>{@username|æ˜¾ç¤ºæ–‡æœ¬}</code></td><td>è‡ªå®šä¹‰æ–‡æœ¬</td><td><code>{@antfu|Anthony Fu}</code> â†’ æ˜¾ç¤º "Anthony Fu"</td></tr><tr><td><code>{@username|æ˜¾ç¤ºæ–‡æœ¬|é“¾æ¥}</code></td><td>è‡ªå®šä¹‰é“¾æ¥</td><td><code>{@antfu|åšå®¢|https://antfu.me}</code></td></tr></tbody></table>
<h3 data-id="heading-7">SSR/SSG åœºæ™¯æœ€ä½³å®è·µ</h3>
<p>åœ¨æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ä¸‹ï¼Œæ„å»ºæ—¶å’Œæµè§ˆå™¨ç«¯ç¯å¢ƒåˆ†ç¦»ï¼Œæ¨èä»¥ä¸‹æ–¹å¼ï¼š</p>
<p><strong>æœåŠ¡ç«¯ï¼ˆæ„å»ºæ—¶ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MarkdownIt</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MarkdownItGitHubMentionCard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it-github-mention-card'</span>

<span class="hljs-keyword">const</span> md = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MarkdownIt</span>()
md.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MarkdownItGitHubMentionCard</span>)
<span class="hljs-comment">// æœåŠ¡ç«¯ä¸ä¼  tokenï¼Œé¿å…æš´éœ²</span>

<span class="hljs-keyword">const</span> html = md.<span class="hljs-title function_">render</span>(<span class="hljs-string">'{@antfu}'</span>)
</code></pre>
<p><strong>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { initHoverCard } <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it-github-mention-card'</span>

<span class="hljs-comment">// VitePress / Vite</span>
<span class="hljs-title function_">initHoverCard</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_GITHUB_TOKEN</span>)

<span class="hljs-comment">// Next.js</span>
<span class="hljs-title function_">initHoverCard</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">NEXT_PUBLIC_GITHUB_TOKEN</span>)
</code></pre>
<h3 data-id="heading-8">æš—è‰²æ¨¡å¼</h3>
<p>æ’ä»¶å†…ç½®æš—è‰²æ¨¡å¼æ”¯æŒï¼Œå½“é¡µé¢æˆ–çˆ¶å…ƒç´ åŒ…å« <code>.dark</code> ç±»æ—¶ï¼Œå¡ç‰‡è‡ªåŠ¨åˆ‡æ¢æš—è‰²ä¸»é¢˜ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dark"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¡ç‰‡è‡ªåŠ¨é€‚é…æš—è‰² --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>ä¸ VitePressã€Tailwind CSS ç­‰ä¸»æµæ–¹æ¡ˆå®Œç¾å…¼å®¹ã€‚</p>
<h3 data-id="heading-9">åœ¨ VitePress ä¸­ä½¿ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// .vitepress/config.ts</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MarkdownItGitHubMentionCard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it-github-mention-card'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">markdown</span>: {
    <span class="hljs-attr">config</span>: <span class="hljs-function">(<span class="hljs-params">md</span>) =&gt;</span> {
      md.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MarkdownItGitHubMentionCard</span>)
    }
  }
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// .vitepress/theme/index.ts</span>
<span class="hljs-keyword">import</span> { initHoverCard } <span class="hljs-keyword">from</span> <span class="hljs-string">'markdown-it-github-mention-card'</span>
<span class="hljs-keyword">import</span> { onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">enhanceApp</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">initHoverCard</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_GITHUB_TOKEN</span>)
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-10">å®ç°åŸç†</h3>
<p>ç®€å•ä»‹ç»ä¸€ä¸‹æ ¸å¿ƒå®ç°ï¼š</p>
<ol>
<li>
<p><strong>Markdown è§£æ</strong>ï¼šé€šè¿‡ markdown-it çš„ inline ruleï¼ŒåŒ¹é… <code>{@...}</code> è¯­æ³•ï¼Œç”Ÿæˆå¸¦æœ‰ <code>data-github-user</code> å±æ€§çš„ <code>&lt;a&gt;</code> æ ‡ç­¾</p>
</li>
<li>
<p><strong>æ‚¬æµ®å¡ç‰‡</strong>ï¼š<code>initHoverCard()</code> åœ¨æµè§ˆå™¨ç«¯ç›‘å¬é¼ æ ‡äº‹ä»¶ï¼Œå½“æ‚¬åœåœ¨ç›®æ ‡é“¾æ¥ä¸Šæ—¶ï¼š</p>
<ul>
<li>è°ƒç”¨ GitHub REST API è·å–ç”¨æˆ·ä¿¡æ¯</li>
<li>åŠ¨æ€åˆ›å»ºå¡ç‰‡ DOM å¹¶å®šä½æ˜¾ç¤º</li>
<li>å†…ç½®è¯·æ±‚ç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚</li>
</ul>
</li>
<li>
<p><strong>æ ·å¼æ³¨å…¥</strong>ï¼šé¦–æ¬¡è°ƒç”¨æ—¶è‡ªåŠ¨æ³¨å…¥ CSSï¼Œæ”¯æŒäº®/æš—ä¸¤å¥—ä¸»é¢˜</p>
</li>
</ol>
<h3 data-id="heading-11">ä¸ºä»€ä¹ˆä¸ç”¨ GitHub å®˜æ–¹çš„ Hover Cardï¼Ÿ</h3>
<p>GitHub çš„ Hover Card ä»…åœ¨ github.com åŸŸåä¸‹ç”Ÿæ•ˆï¼Œä¸”éœ€è¦ç™»å½•çŠ¶æ€ã€‚æœ¬æ’ä»¶ï¼š</p>
<ul>
<li>å¯åœ¨ä»»æ„ç½‘ç«™ä½¿ç”¨</li>
<li>æ— éœ€ç”¨æˆ·ç™»å½• GitHub</li>
<li>å¯è‡ªå®šä¹‰æ ·å¼å’Œè¡Œä¸º</li>
<li>é€‚é…å„ç§ SSR/SSG æ¡†æ¶</li>
</ul>
<h3 data-id="heading-12">é¡¹ç›®åœ°å€</h3>
<ul>
<li><strong>GitHub</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcassie-ye%2Fmarkdown-it-github-mention-card" target="_blank" title="https://github.com/cassie-ye/markdown-it-github-mention-card" ref="nofollow noopener noreferrer">cassie-ye/markdown-it-github-mention-card</a></li>
<li><strong>npm</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fmarkdown-it-github-mention-card" target="_blank" title="https://www.npmjs.com/package/markdown-it-github-mention-card" ref="nofollow noopener noreferrer">markdown-it-github-mention-card</a></li>
</ul>
<h3 data-id="heading-13">å†™åœ¨æœ€å</h3>
<p>è¿™æ˜¯æˆ‘å¼€æºçš„ä¸€ä¸ªå°å·¥å…·ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°æœ‰ç±»ä¼¼éœ€æ±‚çš„åŒå­¦ã€‚</p>
<p>å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ï¼š</p>
<ul>
<li>ç»™é¡¹ç›®ç‚¹ä¸ª â­ Star</li>
<li>æ Issue åé¦ˆé—®é¢˜æˆ–å»ºè®®</li>
<li>æ PR ä¸€èµ·å®Œå–„</li>
</ul>
<p>æœ‰ä»»ä½•é—®é¢˜æ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOSå®¢æˆ·ç«¯å¼€å‘åŸºç¡€çŸ¥è¯†â€”â€”å†™æ–‡ä»¶é¿â€œå‘â€æŒ‡å—ï¼ˆäºŒï¼‰]]></title>    <link>https://juejin.cn/post/7598818096729260070</link>    <guid>https://juejin.cn/post/7598818096729260070</guid>    <pubDate>2026-01-24T10:37:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598818096729260070" data-draft-id="7597588000613941311" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOSå®¢æˆ·ç«¯å¼€å‘åŸºç¡€çŸ¥è¯†â€”â€”å†™æ–‡ä»¶é¿â€œå‘â€æŒ‡å—ï¼ˆäºŒï¼‰"/> <meta itemprop="keywords" content="iOS,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-24T10:37:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="zhangjiezhi_"/> <meta itemprop="url" content="https://juejin.cn/user/2955079655922125"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOSå®¢æˆ·ç«¯å¼€å‘åŸºç¡€çŸ¥è¯†â€”â€”å†™æ–‡ä»¶é¿â€œå‘â€æŒ‡å—ï¼ˆäºŒï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2955079655922125/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    zhangjiezhi_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:37:57.000Z" title="Sat Jan 24 2026 10:37:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ›´å¤šç²¾å½©æ–‡ç« ï¼Œæ¬¢è¿å…³æ³¨ä½œè€…å¾®ä¿¡å…¬ä¼—å·ï¼š<strong>ç å·¥ç¬”è®°</strong></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ &amp; é—®é¢˜</h2>
<p><a href="https://juejin.cn/post/6885630755805626375" target="_blank" title="https://juejin.cn/post/6885630755805626375">ä¸Šä¸€ç¯‡æ–‡ç« </a>è®²è¿‡ï¼Œåœ¨iOSã€macOSå¹³å°ä¸Šï¼Œè¦ä¿è¯æ–°å†™å…¥çš„æ–‡ä»¶å†…å®¹æˆåŠŸè½ç›˜ï¼Œéœ€è¦è°ƒç”¨<code>fcntl(fd, FULL_SYNC)</code>ï¼ˆæ³¨ï¼šå¼€æºchromiumé‡Œä¹Ÿæ˜¯è¿™ä¹ˆåšçš„[1]ï¼‰ï¼š</p>
<blockquote>
<p><strong>FULL_SYNC</strong></p>
<p>Does the same thing as fsync(2) then asks the drive to flush all buffered data to the
permanent storage device (arg is ignored).  As this drains the entire queue of the device
and acts as a barrier, data that had been fsync'd on the same device before is guaranteed to
be persisted when this call returns.  This is currently implemented on HFS, MS-DOS (FAT),
Universal Disk Format (UDF) and APFS file systems.  The operation may take quite a while to
complete.  Certain FireWire drives have also been known to ignore the request to flush their
buffered data.</p>
</blockquote>
<p>ä»ä¸Šé¢man pageçš„æè¿°å¯ä»¥çœ‹å‡ºï¼Œ<code>FULL_SYNC</code>æ˜¯å°†è®¾å¤‡<code>unified buffer</code>é‡Œçš„æ•°æ®å…¨éƒ¨å¼ºåˆ¶è½ç›˜ï¼Œå› ä¸ºbufferä¸­çš„æ•°æ®å¯èƒ½ä¸åªåŒ…å«åˆšåˆšå†™å…¥çš„ï¼Œå¯èƒ½è¿˜åŒ…å«äº†ä¹‹å‰å†™å…¥çš„æ•°æ®ï¼Œè™½ç„¶è¾¾åˆ°äº†æŒä¹…åŒ–çš„ç›®çš„ï¼Œä½†æ—¶é—´ä¸å¯æ§ï¼Œå¯èƒ½ä¼šè€—æ—¶å¾ˆé•¿ï¼Œä¸¥é‡å½±å“åº”ç”¨æ€§èƒ½ã€‚</p>
<p>æœ‰æ²¡æœ‰ä»€ä¹ˆä¼˜åŒ–æ–¹å¼å‘¢ï¼Ÿ</p>
<h2 data-id="heading-1">äºŒã€F_BARRIERFSYNC</h2>
<p>ä»åº”ç”¨å¼€å‘è€…çš„è§’åº¦ï¼Œå¾ˆå¤šåœºæ™¯ä¸‹å¹¶ä¸éœ€è¦è¿™ä¹ˆå¼ºçš„è½ç›˜ä¿è¯ï¼Œå¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œå¦‚æœèƒ½ä¿è¯å†™å…¥é¡ºåºï¼Œä¹Ÿå³å…ˆå†™å…¥æ•°æ®Aï¼Œåå†™å…¥æ•°æ®Bï¼Œå¦‚æœåç»­è¯»æ•°æ®æ—¶è¯»åˆ°äº†æ•°æ®Bï¼Œåˆ™Aä¹Ÿä¸€å®šå­˜åœ¨ï¼Œåº”ç”¨ä¾§å°±å¯ä»¥è‡ªå·±åšæ•°æ®å®Œæ•´æ€§æ£€æŸ¥äº†ï¼Œä»è€Œå¯ä»¥åšå…œåº•é€»è¾‘ã€‚è¿™æ ·ä¸€æ¥æ—¢èƒ½å‡å°‘å¼ºåˆ¶è½ç›˜å¯¹æ€§èƒ½çš„å½±å“ï¼Œåˆèƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p>
<p><code>fcntl</code>çš„<code>F_BARRIERFSYNC</code>è¿™ä¸ªé€‰é¡¹å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å…ˆçœ‹ä¸€ä¸‹man pageè¯´æ˜ï¼š</p>
<blockquote>
<p><strong>F_BARRIERFSYNC</strong></p>
<p>Does the same thing as fsync(2) then issues a barrier command to the drive (arg is ignored).
The barrier applies to I/O that have been flushed with fsync(2) on the same device before.
These operations are guaranteed to be persisted before any other I/O that would follow the
barrier, although no assumption should be made on what has been persisted or not when this
call returns.  After the barrier has been issued, operations on other FDs that have been
fsync'd before can still be re-ordered by the device, but not after the barrier.  This is
typically useful to guarantee valid state on disk when ordering is a concern but durability
is not.  A barrier can be used to order two phases of operations on a set of file
descriptors and ensure that no file can possibly get persisted with the effect of the second
phase without the effect of the first one. To do so, execute operations of phase one, then
fsync(2) each FD and issue a single barrier.  Finally execute operations of phase two.  This
is currently implemented on HFS and APFS. It requires hardware support, which Apple SSDs are
guaranteed to provide.</p>
</blockquote>
<p>è°ƒç”¨æ­¤æ–¹æ³•åï¼Œç³»ç»Ÿè™½ä¸èƒ½ä¿è¯æ•°æ®æ˜¯å¦çœŸæ­£è½ç›˜æˆåŠŸï¼Œä½†èƒ½ä¿è¯å†™å…¥çš„é¡ºåºï¼Œä¹Ÿå³å¦‚æœåå†™å…¥çš„æ•°æ®æˆåŠŸè½ç›˜ï¼Œåˆ™å…ˆå†™å…¥çš„æ•°æ®ä¸€å®šå·²ç»è½ç›˜ã€‚</p>
<blockquote>
<p>æ³¨ï¼šAppleçš„SSDéƒ½æ”¯æŒã€‚</p>
</blockquote>
<p>Appleçš„å®˜æ–¹å»ºè®®[2]æ˜¯ï¼šå¦‚æœæœ‰å¼ºè½ç›˜éœ€æ±‚ï¼Œå¯ä»¥ç”¨FULL_SYNCï¼Œä½†è¿™ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™åŠè®¾å¤‡æŸè€—ï¼Œå¦‚æœåªéœ€è¦ä¿è¯å†™å…¥é¡ºåºï¼Œåˆ™å»ºè®®ç”¨F_BARRIERFSYNCã€‚</p>
<blockquote>
<p><strong>Minimize explicit storage synchronization</strong></p>
<p>Writing data on iOS adds the data to a unified buffer cache that the system then writes to file storage. Forcing iOS to flush pending filesystem changes from the unified buffer can result in unnecessary writes to the disk, degrading performance and increasing wear on the device. When possible, avoid callingÂ <code>fsync(_:)</code>, or using theÂ <code>fcntl(_:_:)</code>Â <code>F_FULLFSYNC</code>Â operation to force a flush.</p>
<p>Some apps require aÂ <em>write barrier</em>Â to ensure data persistence before subsequent operations can proceed. Most apps can use theÂ <code>fcntl(_:_:)</code>Â <code>F_BARRIERFSYNC</code>Â for this.</p>
<p>Only useÂ <code>F_FULLFSYNC</code>Â when your app requires a strong expectation of data persistence. Note thatÂ <code>F_FULLFSYNC</code>Â represents a best-effort guarantee that iOS writes data to the disk, but data can still be lost in the case of sudden power loss.</p>
</blockquote>
<h3 data-id="heading-2">ä¸‰ã€ä¾‹å­ï¼šSQLiteä¸»çº¿çš„é—®é¢˜å’Œè‹¹æœçš„ä¼˜åŒ–</h3>
<p>SQLiteæ˜¯ç§»åŠ¨ç«¯æœ€å¸¸ç”¨çš„æ–‡ä»¶æ•°æ®åº“ï¼Œè¯»å†™æ–‡ä»¶æ˜¯å…¶åŠŸèƒ½çš„åŸºçŸ³ã€‚SQLiteæ˜¯å¦‚ä½•å®ç°è½ç›˜çš„å‘¢ï¼Ÿçœ‹çœ‹SQLiteä»“åº“ä¸»çº¿é€»è¾‘[3]ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-id">#elif</span> HAVE_FULLFSYNC
  <span class="hljs-built_in">if</span>( fullSync ){
    rc = <span class="hljs-built_in">osFcntl</span>(fd, F_FULLFSYNC, <span class="hljs-number">0</span>);
  }else{
    rc = <span class="hljs-number">1</span>;
  }
  <span class="hljs-comment">/* If the FULLFSYNC failed, fall back to attempting an fsync().
  ** It shouldn't be possible for fullfsync to fail on the local
  ** file system (on OSX), so failure indicates that FULLFSYNC
  ** isn't supported for this file system. So, attempt an fsync
  ** and (for now) ignore the overhead of a superfluous fcntl call.
  ** It'd be better to detect fullfsync support once and avoid
  ** the fcntl call every time sync is called.
  */</span>
  <span class="hljs-built_in">if</span>( rc ) rc = <span class="hljs-built_in">fsync</span>(fd);

<span class="hljs-selector-id">#elif</span> <span class="hljs-built_in">defined</span>(__APPLE__)
  <span class="hljs-comment">/* fdatasync() on HFS+ doesn't yet flush the file size if it changed correctly
  ** so currently we default to the macro that redefines fdatasync to fsync
  */</span>
  rc = <span class="hljs-built_in">fsync</span>(fd);
</code></pre>
<p>å¦‚æœå¼€äº†<code>PRAGMA fullsync = ON</code>ï¼Œä¹Ÿæ˜¯ä½¿ç”¨äº†<code>F_FULLSYNC</code>æ¥ä¿è¯å†™å…¥æˆåŠŸã€‚æ²¡å¼€çš„è¯æ˜¯ä½¿ç”¨fsyncï¼Œè¿™é‡Œåº”è¯¥æ˜¯æœ‰é—®é¢˜çš„ã€‚</p>
<p>é‚£iOSçš„<code>libsqlite</code>æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿè¿™ä¸ªåº“è‹¹æœæ²¡æœ‰å¼€æºï¼Œåªèƒ½é€†å‘çœ‹ä¸€ä¸‹ï¼Œæœæœç›¸å…³çš„å‡ ä¸ªæ–¹æ³•ï¼Œåº”è¯¥åœ¨è¿™ä¸€æ®µæ±‡ç¼–è¿™é‡Œï¼š</p>
<pre><code class="hljs language-ini" lang="ini">                                    loc_1b0d62f40:
00000001b0d62f40 682240F9               ldr        x8, <span class="hljs-section">[x19, #0x40]</span>             <span class="hljs-comment">; CODE XREF=sub_1b0d62d34+444</span>
00000001b0d62f44 880000B4               cbz        x8, loc_1b0d62f54

00000001b0d62f48 080140F9               ldr        x8, <span class="hljs-section">[x8]</span>
00000001b0d62f4c 08A940B9               ldr        w8, <span class="hljs-section">[x8, #0xa8]</span>
00000001b0d62f50 28FDFF35               cbnz       w8, loc_1b0d62ef4

                                    loc_1b0d62f54:
00000001b0d62f54 280C0012               and        w8, w1, <span class="hljs-comment">#0xf                 ; CODE XREF=sub_1b0d62d34+528</span>
00000001b0d62f58 1F0D0071               cmp        w8, <span class="hljs-comment">#0x3</span>
00000001b0d62f5c A80A8052               mov        w8, <span class="hljs-comment">#0x55</span>
00000001b0d62f60 08019F1A               csel       w8, w8, wzr, eq
00000001b0d62f64 69024239               ldrb       w9, <span class="hljs-section">[x19, #0x80]</span>
00000001b0d62f68 3F011F72               tst        w9, <span class="hljs-comment">#0x2</span>
00000001b0d62f6c 69068052               mov        w9, <span class="hljs-comment">#0x33</span>
00000001b0d62f70 0101891A               csel       w1, w8, w9, eq
00000001b0d62f74 741A40B9               ldr        w20, <span class="hljs-section">[x19, #0x18]</span>
00000001b0d62f78 A1000034               cbz        w1, loc_1b0d62f8c

00000001b0d62f7c FF0300F9               str        xzr, <span class="hljs-section">[sp, #0x170 + var_170]</span>
00000001b0d62f80 E00314AA               mov        x0, x20
00000001b0d62f84 7B93C794               bl         0x1b3f47d70
00000001b0d62f88 60040034               cbz        w0, loc_1b0d63014

                                    loc_1b0d62f8c:
00000001b0d62f8c E00314AA               mov        x0, x20                      <span class="hljs-comment">; argument "fildes" for method imp___auth_stubs__fsync, CODE XREF=sub_1b0d62d34+580</span>
00000001b0d62f90 9C7A0494               bl         imp___auth_stubs__fsync      <span class="hljs-comment">; fsync</span>
00000001b0d62f94 00040034               cbz        w0, loc_1b0d63014
</code></pre>
<p>ç¿»è¯‘æˆCè¯­è¨€ä¼ªä»£ç ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// x19 is the context pointer (self/this)</span>
<span class="hljs-comment">// w1 is an input argument (flags)</span>

<span class="hljs-comment">// 1. Pre-check</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SubObject</span>* <span class="hljs-title">obj</span> =</span> self-&gt;ptr_40;
<span class="hljs-keyword">if</span> (obj) {
    <span class="hljs-keyword">if</span> (obj-&gt;ptr_0-&gt;status_a8 != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">goto</span> loc_1b0d62ef4; <span class="hljs-comment">// Busy/Error path</span>
    }
}

<span class="hljs-comment">// 2. Determine Sync Command</span>
<span class="hljs-type">int</span> fd = self-&gt;file_descriptor; <span class="hljs-comment">// offset 0x18</span>
<span class="hljs-type">int</span> command = <span class="hljs-number">0</span>;

<span class="hljs-comment">// Check config flag at offset 0x80</span>
<span class="hljs-keyword">if</span> (self-&gt;flags_80 &amp; <span class="hljs-number">0x02</span>) {
    command = <span class="hljs-number">0x33</span>; <span class="hljs-comment">// F_FULLFSYNC (51)</span>
} 
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((w1 &amp; <span class="hljs-number">0x0F</span>) == <span class="hljs-number">3</span>) {
    command = <span class="hljs-number">0x55</span>; <span class="hljs-comment">// F_BARRIERFSYNC (85)</span>
}

<span class="hljs-comment">// 3. Try Specialized Sync</span>
<span class="hljs-type">int</span> result = <span class="hljs-number">-1</span>;
<span class="hljs-keyword">if</span> (command != <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// Likely fcntl(fd, command, 0)</span>
    result = unknown_func_1b3f47d70(fd, command, <span class="hljs-number">0</span>); 
    
    <span class="hljs-keyword">if</span> (result == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">goto</span> success; <span class="hljs-comment">// loc_1b0d63014</span>
    }
}

<span class="hljs-comment">// 4. Fallback to standard fsync</span>
<span class="hljs-comment">// Reached if command was 0 OR if specialized sync failed</span>
result = fsync(fd);

<span class="hljs-keyword">if</span> (result == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">goto</span> success;
}

<span class="hljs-comment">// ... handle error ...</span>
</code></pre>
<p>å¯ä»¥çœ‹å‡ºè¿™ä¸ªé€»è¾‘ä¸­æ—¢æœ‰<code>F_FULLSYNC</code>åˆæœ‰<code>F_BARRIERFSYNC</code>ã€‚å†™äº†ä¸ªç®€å•demoéªŒè¯äº†ä¸€ä¸‹ï¼Œ<code>PRAGMA fullsync = ON</code>ä¼šç”¨<code>F_FULLSYNC</code>ï¼Œ<code>PRAGMA fullsync = OFF</code>ç”¨çš„æ˜¯<code>F_BARRIERFSYNC</code>ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœåœ¨è‹¹æœç³»ç»Ÿä¸Šä½¿ç”¨è‡ªå·±ç¼–è¯‘çš„sqliteåº“æ—¶ï¼Œéœ€è¦æ³¨æ„æŠŠè¿™ä¸ªé€»è¾‘åŠ ä¸Šã€‚</p>
<p>*<em>æ€»ä¹‹ï¼Œåœ¨iOS/macOSå¹³å°å†™æ–‡ä»¶çš„åœºæ™¯ï¼Œéœ€è¦è€ƒè™‘å¥½å¯¹æ€§èƒ½ã€ç¨³å®šæ€§çš„éœ€æ±‚ï¼Œé€‰ç”¨åˆé€‚çš„ç³»ç»Ÿæœºåˆ¶ã€‚</em></p>
<h3 data-id="heading-3">å‚è€ƒèµ„æ–™</h3>
<ul>
<li>[1] <a href="https://link.juejin.cn?target=https%3A%2F%2Fchromium-review.googlesource.com%2Fc%2Fchromium%2Fsrc%2F%2B%2F1400159" target="_blank" title="https://chromium-review.googlesource.com/c/chromium/src/+/1400159" ref="nofollow noopener noreferrer">chromium-review.googlesource.com/c/chromium/â€¦</a></li>
<li>[2] <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fxcode%2Freducing-disk-writes" target="_blank" title="https://developer.apple.com/documentation/xcode/reducing-disk-writes" ref="nofollow noopener noreferrer">developer.apple.com/documentatiâ€¦</a></li>
<li>[3] <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsqlite%2Fsqlite%2Fblob%2Fmaster%2Fsrc%2Fos_unix.c%23L3817" target="_blank" title="https://github.com/sqlite/sqlite/blob/master/src/os_unix.c#L3817" ref="nofollow noopener noreferrer">github.com/sqlite/sqliâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Windows ç³»ç»Ÿä¸­ fnm å®‰è£…ä¸é…ç½®æŒ‡å—]]></title>    <link>https://juejin.cn/post/7598465042968625192</link>    <guid>https://juejin.cn/post/7598465042968625192</guid>    <pubDate>2026-01-24T10:42:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598465042968625192" data-draft-id="7598480267218075682" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Windows ç³»ç»Ÿä¸­ fnm å®‰è£…ä¸é…ç½®æŒ‡å—"/> <meta itemprop="keywords" content="Node.js"/> <meta itemprop="datePublished" content="2026-01-24T10:42:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿è™å„¿"/> <meta itemprop="url" content="https://juejin.cn/user/3394908210857901"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Windows ç³»ç»Ÿä¸­ fnm å®‰è£…ä¸é…ç½®æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3394908210857901/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿è™å„¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:42:31.000Z" title="Sat Jan 24 2026 10:42:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Windows ç³»ç»Ÿä¸­ fnm å®‰è£…ä¸é…ç½®æŒ‡å—</h2>
<p>æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸­å®‰è£… fnm (Fast Node Manager) å¹¶é…ç½® CMDã€PowerShell å’Œ PowerShell 7 ç»ˆç«¯ä»¥è‡ªåŠ¨åŠ è½½ Node.js ç¯å¢ƒã€‚</p>
<h3 data-id="heading-1">å‰ææ¡ä»¶</h3>
<ul>
<li>Windows 10 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
<li>å·²å®‰è£… WinGetï¼ˆWindows åŒ…ç®¡ç†å™¨ï¼‰</li>
</ul>
<h3 data-id="heading-2">å®‰è£… fnm</h3>
<p>ä½¿ç”¨ WinGet å®‰è£… fnmï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">winget install Schniz.fnm
</code></pre>
<h3 data-id="heading-3">é…ç½®ç»ˆç«¯</h3>
<h4 data-id="heading-4">1. é…ç½® PowerShell 7</h4>
<p>PowerShell 7 ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶è·¯å¾„ã€‚éœ€è¦åˆ›å»ºä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell"># åˆ›å»º PowerShell 7 é…ç½®ç›®å½•
New-Item -ItemType Directory -Path "$env:USERPROFILE\Documents\PowerShell" -Force

# åˆ›å»ºé…ç½®æ–‡ä»¶
New-Item -ItemType File -Path "$env:USERPROFILE\Documents\PowerShell\Microsoft.PowerShell_profile.ps1" -Force
</code></pre>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">fnm env --use-on-cd | Out-String | Invoke-Expression
</code></pre>
<p>å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¸€æ¬¡æ€§å®Œæˆï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">New-Item -ItemType Directory -Path 'C:\Users\leehoo\Documents\PowerShell' -Force
Set-Content -Path 'C:\Users\leehoo\Documents\PowerShell\Microsoft.PowerShell_profile.ps1' -Value 'fnm env --use-on-cd | Out-String | Invoke-Expression'
</code></pre>
<h4 data-id="heading-5">2. é…ç½® Windows PowerShell</h4>
<p>Windows PowerShell ä½¿ç”¨ä»¥ä¸‹é…ç½®æ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">C:\Users\leehoo\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</span>
</code></pre>
<p>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">fnm env --use-on-cd | Out-String | Invoke-Expression
</code></pre>
<h4 data-id="heading-6">3. é…ç½® CMD</h4>
<p>CMD æ²¡æœ‰é…ç½®æ–‡ä»¶æœºåˆ¶ï¼Œéœ€è¦é€šè¿‡æ³¨å†Œè¡¨è®¾ç½® AutoRunã€‚</p>
<h5 data-id="heading-7">æ­¥éª¤ 1ï¼šç”Ÿæˆ fnm åˆå§‹åŒ–è„šæœ¬</h5>
<pre><code class="hljs language-powershell" lang="powershell">fnm env --use-on-cd --shell cmd | ForEach-Object { '@' + $_ } | Out-File -FilePath "$env:APPDATA\fnm\fnm-init.cmd" -Encoding ASCII
</code></pre>
<h5 data-id="heading-8">æ­¥éª¤ 2ï¼šè®¾ç½®æ³¨å†Œè¡¨ AutoRun</h5>
<pre><code class="hljs language-powershell" lang="powershell">reg add 'HKCU\Software\Microsoft\Command Processor' /v AutoRun /t REG_SZ /d "call $env:APPDATA\fnm\fnm-init.cmd" /f
</code></pre>
<h3 data-id="heading-9">éªŒè¯é…ç½®</h3>
<h4 data-id="heading-10">PowerShell 7 / Windows PowerShell</h4>
<p>é‡æ–°æ‰“å¼€ PowerShell ç»ˆç«¯ï¼Œè¿è¡Œï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">node --version
npm --version
</code></pre>
<h4 data-id="heading-11">CMD</h4>
<p>é‡æ–°æ‰“å¼€ CMD ç»ˆç«¯ï¼Œè¿è¡Œï¼š</p>
<pre><code class="hljs language-cmd" lang="cmd">node -v
npm -v
</code></pre>
<h3 data-id="heading-12">å¸¸ç”¨ fnm å‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ—å‡ºå·²å®‰è£…çš„ Node.js ç‰ˆæœ¬</span>
fnm list

<span class="hljs-comment"># å®‰è£… Node.js ç‰ˆæœ¬</span>
fnm install 20.10.0

<span class="hljs-comment"># åˆ‡æ¢ Node.js ç‰ˆæœ¬</span>
fnm use 20.10.0

<span class="hljs-comment"># è®¾ç½®é»˜è®¤ç‰ˆæœ¬</span>
fnm default 20.10.0

<span class="hljs-comment"># å¸è½½ç‰ˆæœ¬</span>
fnm uninstall 20.10.0
</code></pre>
<h3 data-id="heading-13">æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>æ¯æ¬¡ä¿®æ”¹é…ç½®åï¼Œéœ€è¦é‡æ–°æ‰“å¼€ç»ˆç«¯æ‰èƒ½ç”Ÿæ•ˆ</li>
<li><code>--use-on-cd</code> é€‰é¡¹ä¼šåœ¨åˆ‡æ¢ç›®å½•æ—¶è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨å¯¹åº”çš„ Node.js ç‰ˆæœ¬ï¼ˆåŸºäº .nvmrc æˆ– package.jsonï¼‰</li>
<li>CMD çš„ AutoRun è®¾ç½®ä¼šå½±å“æ‰€æœ‰ CMD çª—å£</li>
<li>å¦‚æœéœ€è¦ç§»é™¤ CMD çš„ AutoRun è®¾ç½®ï¼Œè¿è¡Œï¼š</li>
</ol>
<pre><code class="hljs language-powershell" lang="powershell">reg delete 'HKCU\Software\Microsoft\Command Processor' /v AutoRun /f
</code></pre>
<h3 data-id="heading-14">é…ç½®æ–‡ä»¶ä½ç½®æ€»ç»“</h3>

























<table><thead><tr><th>ç»ˆç«¯</th><th>é…ç½®æ–‡ä»¶è·¯å¾„</th></tr></thead><tbody><tr><td>PowerShell 7</td><td><code>C:\Users\leehoo\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</code></td></tr><tr><td>Windows PowerShell</td><td><code>C:\Users\leehoo\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</code></td></tr><tr><td>CMD</td><td>æ³¨å†Œè¡¨ï¼š<code>HKEY_CURRENT_USER\Software\Microsoft\Command Processor\AutoRun</code></td></tr><tr><td>fnm åˆå§‹åŒ–è„šæœ¬</td><td><code>C:\Users\leehoo\AppData\Roaming\fnm\fnm-init.cmd</code></td></tr></tbody></table>
<h3 data-id="heading-15">æ•…éšœæ’é™¤</h3>
<h4 data-id="heading-16">CMD ä¸­æ˜¾ç¤ºå‘½ä»¤è¾“å‡º</h4>
<p>å¦‚æœ CMD å¯åŠ¨æ—¶æ˜¾ç¤º SET å‘½ä»¤ï¼Œç¡®ä¿ fnm-init.cmd æ–‡ä»¶æ¯è¡Œéƒ½ä»¥ <code>@</code> å¼€å¤´ï¼š</p>
<pre><code class="hljs language-cmd" lang="cmd">@SET PATH=...
@SET FNM_MULTISHELL_PATH=...
</code></pre>
<h4 data-id="heading-17">Node.js å‘½ä»¤ä¸å¯ç”¨</h4>
<ol>
<li>ç¡®è®¤ fnm å·²æ­£ç¡®å®‰è£…ï¼š<code>fnm --version</code></li>
<li>ç¡®è®¤å·²å®‰è£… Node.js ç‰ˆæœ¬ï¼š<code>fnm list</code></li>
<li>æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®</li>
<li>é‡æ–°æ‰“å¼€ç»ˆç«¯</li>
</ol>
<h4 data-id="heading-18">PowerShell é…ç½®ä¸ç”Ÿæ•ˆ</h4>
<ol>
<li>æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>
<li>è¿è¡Œ <code>$PROFILE</code> æŸ¥çœ‹å½“å‰é…ç½®æ–‡ä»¶è·¯å¾„</li>
<li>æ‰‹åŠ¨åŠ è½½é…ç½®ï¼š<code>. $PROFILE</code></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—â€”â€”JSyncQueue]]></title>    <link>https://juejin.cn/post/7598490039488872483</link>    <guid>https://juejin.cn/post/7598490039488872483</guid>    <pubDate>2026-01-24T10:52:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598490039488872483" data-draft-id="7598464972912279592" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—â€”â€”JSyncQueue"/> <meta itemprop="keywords" content="HarmonyOS,TypeScript,Android"/> <meta itemprop="datePublished" content="2026-01-24T10:52:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±Ÿæ¾æ¶Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1820446986338504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—â€”â€”JSyncQueue
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446986338504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±Ÿæ¾æ¶Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:52:18.000Z" title="Sat Jan 24 2026 10:52:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç®€ä»‹</h2>
<p>åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œå¼‚æ­¥ä»»åŠ¡çš„é¡ºåºæ‰§è¡Œæ˜¯ä¸€ä¸ªå¸¸è§éœ€æ±‚ã€‚å½“å¤šä¸ªå¼‚æ­¥ä»»åŠ¡éœ€è¦æŒ‰ç…§ç‰¹å®šé¡ºåºæ‰§è¡Œæ—¶ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‰§è¡Œé¡ºåºæ··ä¹±ã€‚</p>
<blockquote>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FzincPower%2FJSyncQueue" target="_blank" title="https://github.com/zincPower/JSyncQueue" ref="nofollow noopener noreferrer">github.com/zincPower/Jâ€¦</a></p>
</blockquote>
<p>JSyncQueue æä¾›äº†ä¸€ä¸ªç®€æ´çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>é¡ºåºæ‰§è¡Œä¿è¯</strong>ï¼šæ‰€æœ‰ä»»åŠ¡ä¸¥æ ¼æŒ‰ç…§å…¥é˜Ÿé¡ºåºæ‰§è¡Œï¼Œå³ä½¿ä»»åŠ¡å†…éƒ¨æœ‰å¼‚æ­¥æ“ä½œä¹Ÿèƒ½ä¿è¯é¡ºåº</li>
<li><strong>åŒæ¨¡å¼æ”¯æŒ</strong>ï¼šæ”¯æŒ "ç«‹å³æ‰§è¡Œ" å’Œ "å»¶æ—¶æ‰§è¡Œ"ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚</li>
<li><strong>åŒä»»åŠ¡æ¨¡å¼</strong>ï¼šæ”¯æŒ "Message æ¶ˆæ¯æ¨¡å¼" å’Œ "Runnable é—­åŒ…æ¨¡å¼"</li>
<li><strong>ä»»åŠ¡å–æ¶ˆå’Œç®¡ç†</strong>ï¼šå¯éšæ—¶å–æ¶ˆæŒ‡å®šä»»åŠ¡æˆ–æ¸…ç©ºæ•´ä¸ªé˜Ÿåˆ—</li>
<li><strong>ä»»åŠ¡ç»“æœ</strong>ï¼šé€šè¿‡ <code>getResult()</code> è·å–ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œæ”¯æŒ <code>then/catch/finally</code></li>
<li><strong>å¯ç»§æ‰¿æ‰©å±•</strong>ï¼šé€šè¿‡ç»§æ‰¿ JSyncQueue å¹¶é‡å†™ <code>onHandleMessage</code> æ–¹æ³•ï¼Œå®ç°è‡ªå®šä¹‰æ¶ˆæ¯å¤„ç†é€»è¾‘</li>
</ul>
<p>é¡¹ç›®æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3eb3539905d4a429dd6b7d2e6abbda2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769856738&amp;x-signature=R44uEHq%2BG5KYwgJOix0uUPZHg4o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€å®‰è£…</h2>
<pre><code class="hljs language-bash" lang="bash">ohpm install jsyncqueue
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-3">3-1ã€åŸºç¡€ä½¿ç”¨</h3>
<p>å¯ä»¥ç›´æ¥ä½¿ç”¨ JSyncQueue æ— éœ€ç»§æ‰¿ï¼Œä½†ä»…æ”¯æŒ Runnable æ¨¡å¼ï¼ˆpost/postDelayï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-comment">// åˆ›å»ºé˜Ÿåˆ—</span>
<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSyncQueue</span>(<span class="hljs-string">"MyQueue"</span>)

<span class="hljs-comment">// æ·»åŠ ä»»åŠ¡</span>
queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
  <span class="hljs-comment">// æ‰§è¡Œå¼‚æ­¥æ“ä½œ</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">someAsyncOperation</span>()
  <span class="hljs-keyword">return</span> result
}).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä»»åŠ¡å®Œæˆ: <span class="hljs-subst">${result}</span>`</span>)
}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ä»»åŠ¡å¤±è´¥: <span class="hljs-subst">${error}</span>`</span>)
})
</code></pre>
<h3 data-id="heading-4">3-2ã€ç»§æ‰¿ä½¿ç”¨</h3>
<p>ç»§æ‰¿ JSyncQueue åï¼Œæ—¢å¯ä»¥ä½¿ç”¨ Message æ¨¡å¼ï¼ˆsendMessage/sendMessageDelayï¼‰å¤„ç†æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Runnable æ¨¡å¼ï¼ˆpost/postDelayï¼‰æ‰§è¡Œé—­åŒ…ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span>, <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">Any</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">JSyncQueue</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onHandleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>, <span class="hljs-attr">taskId</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (message.<span class="hljs-property">what</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"say_hello"</span>:
        <span class="hljs-keyword">const</span> name = message.<span class="hljs-property">data</span>[<span class="hljs-string">"name"</span>]
        <span class="hljs-keyword">return</span> <span class="hljs-string">`ä½ å¥½ï¼Œ<span class="hljs-subst">${name}</span>ï¼`</span>
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰é˜Ÿåˆ—</span>
<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyQueue</span>(<span class="hljs-string">"MyQueue"</span>)
queue.<span class="hljs-title function_">sendMessage</span>({
  <span class="hljs-attr">what</span>: <span class="hljs-string">"say_hello"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span> }
}).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result) <span class="hljs-comment">// è¾“å‡º: ä½ å¥½ï¼Œå°æ˜ï¼</span>
})
</code></pre>
<h2 data-id="heading-5">å››ã€æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-6">4-1ã€â€œç«‹å³æ‰§è¡Œâ€ å’Œ â€œå»¶æ—¶æ‰§è¡Œâ€</h3>

























<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>post(runnable)</code></td><td>ç«‹å³å°†é—­åŒ…åŠ å…¥é˜Ÿåˆ—æ‰§è¡Œ</td></tr><tr><td><code>postDelay(runnable, delay)</code></td><td>å»¶æ—¶æŒ‡å®šæ¯«ç§’åå°†é—­åŒ…åŠ å…¥é˜Ÿåˆ—æ‰§è¡Œ</td></tr><tr><td><code>sendMessage(message)</code></td><td>ç«‹å³å°†æ¶ˆæ¯åŠ å…¥é˜Ÿåˆ—æ‰§è¡Œ</td></tr><tr><td><code>sendMessageDelay(message, delay)</code></td><td>å»¶æ—¶æŒ‡å®šæ¯«ç§’åå°†æ¶ˆæ¯åŠ å…¥é˜Ÿåˆ—æ‰§è¡Œ</td></tr></tbody></table>
<h3 data-id="heading-7">4-2ã€â€œMessage æ¨¡å¼â€ å’Œ â€œRunnable æ¨¡å¼â€</h3>
<p><strong>Runnable æ¨¡å¼</strong>ï¼šç›´æ¥ä¼ å…¥ä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼Œé€‚åˆç®€å•çš„ä¸€æ¬¡æ€§ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
  <span class="hljs-comment">// ç›´æ¥åœ¨é—­åŒ…ä¸­ç¼–å†™æ‰§è¡Œé€»è¾‘</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">"ä»»åŠ¡ç»“æœ"</span>
})
</code></pre>
<p><strong>Message æ¨¡å¼</strong>ï¼šå‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œç”± <code>onHandleMessage</code> æ–¹æ³•å¤„ç†ï¼Œé€‚åˆéœ€è¦é›†ä¸­ç®¡ç†ä¸šåŠ¡é€»è¾‘çš„åœºæ™¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">queue.<span class="hljs-title function_">sendMessage</span>({
  <span class="hljs-attr">what</span>: <span class="hljs-string">"action_type"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">key</span>: <span class="hljs-string">"value"</span> }
})
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šç›´æ¥ä½¿ç”¨ JSyncQueue å®ä¾‹æ—¶ï¼ŒMessage æ¨¡å¼çš„æ¶ˆæ¯ä¸ä¼šè¢«å¤„ç†ï¼ˆ<code>onHandleMessage</code> é»˜è®¤è¿”å› <code>undefined</code>ï¼‰ã€‚éœ€è¦ç»§æ‰¿ JSyncQueue å¹¶é‡å†™ <code>onHandleMessage</code> æ–¹æ³•æ‰èƒ½å¤„ç†æ¶ˆæ¯ã€‚</p>
</blockquote>
<h2 data-id="heading-8">äº”ã€API æ–‡æ¡£</h2>
<h3 data-id="heading-9">5-1ã€JSyncQueue ç±»</h3>
<h4 data-id="heading-10">æ„é€ å‡½æ•°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">constructor</span>(<span class="hljs-params">queueName: <span class="hljs-built_in">string</span></span>)
</code></pre>
<p>åˆ›å»ºä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å®ä¾‹ã€‚</p>
<ul>
<li><code>queueName</code>: é˜Ÿåˆ—åç§°ï¼Œç”¨äºæ ‡è¯†å’Œè°ƒè¯•</li>
</ul>
<h4 data-id="heading-11">æ–¹æ³•</h4>



























































<table><thead><tr><th>æ–¹æ³•</th><th>å‚æ•°</th><th>è¿”å›å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>post(runnable)</code></td><td><code>runnable: (taskId: number) =&gt; Promise&lt;Any&gt;</code></td><td><code>Task</code></td><td>ç«‹å³æ‰§è¡Œé—­åŒ…</td></tr><tr><td><code>postDelay(runnable, delay)</code></td><td><code>runnable: (taskId: number) =&gt; Promise&lt;Any&gt;</code>, <code>delay: number</code></td><td><code>Task</code></td><td>å»¶æ—¶æ‰§è¡Œé—­åŒ…ï¼Œdelay å•ä½ä¸ºæ¯«ç§’</td></tr><tr><td><code>sendMessage(message)</code></td><td><code>message: Message</code></td><td><code>Task</code></td><td>ç«‹å³å‘é€æ¶ˆæ¯</td></tr><tr><td><code>sendMessageDelay(message, delay)</code></td><td><code>message: Message</code>, <code>delay: number</code></td><td><code>Task</code></td><td>å»¶æ—¶å‘é€æ¶ˆæ¯ï¼Œdelay å•ä½ä¸ºæ¯«ç§’</td></tr><tr><td><code>cancel(taskId)</code></td><td><code>taskId: number</code></td><td><code>void</code></td><td>å–æ¶ˆæŒ‡å®šä»»åŠ¡</td></tr><tr><td><code>clear()</code></td><td>-</td><td><code>void</code></td><td>æ¸…ç©ºé˜Ÿåˆ—ä¸­æ‰€æœ‰ç­‰å¾…çš„ä»»åŠ¡</td></tr><tr><td><code>dumpInfo()</code></td><td>-</td><td><code>string</code></td><td>è·å–é˜Ÿåˆ—è°ƒè¯•ä¿¡æ¯</td></tr><tr><td><code>onHandleMessage(message, taskId)</code></td><td><code>message: Message</code>, <code>taskId: number</code></td><td><code>Promise&lt;Any&gt;</code></td><td>æ¶ˆæ¯å¤„ç†æ–¹æ³•ï¼Œå­ç±»å¯é‡å†™</td></tr></tbody></table>
<h4 data-id="heading-12">å±æ€§</h4>




















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>queueName</code></td><td><code>string</code></td><td>é˜Ÿåˆ—åç§°ï¼ˆåªè¯»ï¼‰</td></tr><tr><td><code>length</code></td><td><code>number</code></td><td>å½“å‰é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ•°é‡ï¼ˆåªè¯»ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-13">5-2ã€Message æ¥å£</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">what</span>: <span class="hljs-built_in">string</span>   <span class="hljs-comment">// æ¶ˆæ¯ç±»å‹</span>
  <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>      <span class="hljs-comment">// æ¶ˆæ¯æ•°æ®</span>
}
</code></pre>
<h3 data-id="heading-14">5-3ã€Task æ¥å£</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Task</span> {
  <span class="hljs-title function_">cancel</span>(): <span class="hljs-built_in">void</span>                  <span class="hljs-comment">// å–æ¶ˆä»»åŠ¡</span>
  <span class="hljs-title function_">getResult</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt;       <span class="hljs-comment">// è·å–ä»»åŠ¡ç»“æœ</span>
  <span class="hljs-title function_">getTaskId</span>(): <span class="hljs-built_in">number</span>            <span class="hljs-comment">// è·å–ä»»åŠ¡ ID</span>
}
</code></pre>
<h3 data-id="heading-15">5-4ã€å¼‚å¸¸ç±»å‹</h3>
<h4 data-id="heading-16">JSyncQueueCancelException</h4>
<p>ä»»åŠ¡è¢«å–æ¶ˆæ—¶æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">JSyncQueueCancelException</span> {
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}
</code></pre>
<h4 data-id="heading-17">JSyncQueueException</h4>
<p>é˜Ÿåˆ—å†…éƒ¨é”™è¯¯æ—¶æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">JSyncQueueException</span> {
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}
</code></pre>
<h2 data-id="heading-18">å…­ã€ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-19">6-1ã€ç›´æ¥ä½¿ç”¨ JSyncQueue + post()</h3>
<p>é€‚ç”¨äºç®€å•åœºæ™¯ï¼Œç›´æ¥ä½¿ç”¨é—­åŒ…å¤„ç†ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSyncQueue</span>(<span class="hljs-string">"SimpleQueue"</span>)

<span class="hljs-comment">// æ·»åŠ å¤šä¸ªä»»åŠ¡ï¼Œå®ƒä»¬ä¼šæŒ‰é¡ºåºæ‰§è¡Œ</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
  queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¼€å§‹æ‰§è¡Œä»»åŠ¡ <span class="hljs-subst">${i}</span>`</span>)
    <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>))
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å®Œæˆä»»åŠ¡ <span class="hljs-subst">${i}</span>`</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">`ç»“æœ <span class="hljs-subst">${i}</span>`</span>
  }).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä»»åŠ¡ <span class="hljs-subst">${i}</span> è¿”å›: <span class="hljs-subst">${result}</span>`</span>)
  })
}
</code></pre>
<h3 data-id="heading-20">6-2ã€ç»§æ‰¿ JSyncQueue è‡ªå®šä¹‰é˜Ÿåˆ—</h3>
<p>é€‚ç”¨äºéœ€è¦é›†ä¸­ç®¡ç†ä¸šåŠ¡é€»è¾‘çš„åœºæ™¯ï¼Œç»§æ‰¿ååŒæ ·æ”¯æŒ Runnable æ¨¡å¼ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span>, <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">Any</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">JSyncQueue</span> {
  <span class="hljs-keyword">private</span> userCount = <span class="hljs-number">0</span>

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onHandleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>, <span class="hljs-attr">taskId</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (message.<span class="hljs-property">what</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"register"</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">userCount</span>++
        <span class="hljs-keyword">const</span> name = message.<span class="hljs-property">data</span>[<span class="hljs-string">"name"</span>]
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ³¨å†Œæ“ä½œ</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">simulateAsyncOperation</span>()
        <span class="hljs-keyword">return</span> <span class="hljs-string">`ç”¨æˆ· <span class="hljs-subst">${name}</span> æ³¨å†ŒæˆåŠŸï¼Œå½“å‰ç”¨æˆ·æ•°: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.userCount}</span>`</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">"login"</span>:
        <span class="hljs-keyword">const</span> username = message.<span class="hljs-property">data</span>[<span class="hljs-string">"username"</span>]
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">simulateAsyncOperation</span>()
        <span class="hljs-keyword">return</span> <span class="hljs-string">`ç”¨æˆ· <span class="hljs-subst">${username}</span> ç™»å½•æˆåŠŸ`</span>

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
    }
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">simulateAsyncOperation</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>))
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> userQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserQueue</span>(<span class="hljs-string">"UserQueue"</span>)

userQueue.<span class="hljs-title function_">sendMessage</span>({
  <span class="hljs-attr">what</span>: <span class="hljs-string">"register"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span> }
}).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>)

userQueue.<span class="hljs-title function_">sendMessage</span>({
  <span class="hljs-attr">what</span>: <span class="hljs-string">"login"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">username</span>: <span class="hljs-string">"å¼ ä¸‰"</span> }
}).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>)

<span class="hljs-comment">// ç»§æ‰¿ååŒæ ·å¯ä»¥ä½¿ç”¨ post()</span>
userQueue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰§è¡Œè‡ªå®šä¹‰é—­åŒ…ä»»åŠ¡"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-string">"é—­åŒ…ä»»åŠ¡å®Œæˆ"</span>
}).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>)
</code></pre>
<h3 data-id="heading-21">6-3ã€å»¶æ—¶æ‰§è¡Œç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSyncQueue</span>(<span class="hljs-string">"DelayQueue"</span>)

<span class="hljs-comment">// å»¶æ—¶ 1 ç§’åæ‰§è¡Œ</span>
queue.<span class="hljs-title function_">postDelay</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å»¶æ—¶ä»»åŠ¡æ‰§è¡Œäº†"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-string">"å»¶æ—¶ä»»åŠ¡ç»“æœ"</span>
}, <span class="hljs-number">1000</span>).<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å»¶æ—¶ä»»åŠ¡è¿”å›: <span class="hljs-subst">${result}</span>`</span>)
})

<span class="hljs-comment">// å»¶æ—¶å‘é€æ¶ˆæ¯ï¼ˆéœ€è¦ç»§æ‰¿å®ç° onHandleMessageï¼‰</span>
queue.<span class="hljs-title function_">sendMessageDelay</span>({
  <span class="hljs-attr">what</span>: <span class="hljs-string">"delayed_action"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">info</span>: <span class="hljs-string">"å»¶æ—¶æ¶ˆæ¯"</span> }
}, <span class="hljs-number">2000</span>)
</code></pre>
<h3 data-id="heading-22">6-4ã€ä»»åŠ¡å–æ¶ˆç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span>, <span class="hljs-title class_">Task</span>, <span class="hljs-title class_">JSyncQueueCancelException</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSyncQueue</span>(<span class="hljs-string">"CancelQueue"</span>)

<span class="hljs-comment">// æ·»åŠ ä»»åŠ¡å¹¶ä¿å­˜å¼•ç”¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">task</span>: <span class="hljs-title class_">Task</span> = queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> (taskId) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ä»»åŠ¡å¼€å§‹æ‰§è¡Œ"</span>)
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">5000</span>))
  <span class="hljs-keyword">return</span> <span class="hljs-string">"ä»»åŠ¡å®Œæˆ"</span>
})

<span class="hljs-comment">// ç›‘å¬ä»»åŠ¡ç»“æœ</span>
task.<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä»»åŠ¡æˆåŠŸ: <span class="hljs-subst">${result}</span>`</span>)
}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: JSyncQueueCancelException</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä»»åŠ¡è¢«å–æ¶ˆ: <span class="hljs-subst">${error.message}</span>`</span>)
})

<span class="hljs-comment">// å–æ¶ˆä»»åŠ¡ï¼ˆä¸¤ç§æ–¹å¼ï¼‰</span>
task.<span class="hljs-title function_">cancel</span>()                    <span class="hljs-comment">// æ–¹å¼1ï¼šé€šè¿‡ Task å¯¹è±¡å–æ¶ˆ</span>
<span class="hljs-comment">// queue.cancel(task.getTaskId()) // æ–¹å¼2ï¼šé€šè¿‡é˜Ÿåˆ—å’Œä»»åŠ¡IDå–æ¶ˆ</span>

<span class="hljs-comment">// æ¸…ç©ºæ‰€æœ‰ä»»åŠ¡</span>
<span class="hljs-comment">// queue.clear()</span>
</code></pre>
<h3 data-id="heading-23">6-5ã€æ··åˆä½¿ç”¨ç¤ºä¾‹</h3>
<p>Message å’Œ Runnable å¯ä»¥æ··åˆä½¿ç”¨ï¼Œå®ƒä»¬éƒ½ä¼šæŒ‰å…¥é˜Ÿé¡ºåºæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSyncQueue</span>, <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">Any</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jsyncqueue'</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MixedQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">JSyncQueue</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onHandleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>, <span class="hljs-attr">taskId</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¤„ç†æ¶ˆæ¯: <span class="hljs-subst">${message.what}</span>`</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">`æ¶ˆæ¯ <span class="hljs-subst">${message.what}</span> å¤„ç†å®Œæˆ`</span>
  }
}

<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MixedQueue</span>(<span class="hljs-string">"MixedQueue"</span>)

<span class="hljs-comment">// æ··åˆæ·»åŠ ä»»åŠ¡</span>
queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Runnable 1"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-string">"R1"</span>
})

queue.<span class="hljs-title function_">sendMessage</span>({ <span class="hljs-attr">what</span>: <span class="hljs-string">"msg1"</span>, <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span> })

queue.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Runnable 2"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-string">"R2"</span>
})

queue.<span class="hljs-title function_">sendMessage</span>({ <span class="hljs-attr">what</span>: <span class="hljs-string">"msg2"</span>, <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span> })

<span class="hljs-comment">// æ‰§è¡Œé¡ºåºï¼šRunnable 1 -&gt; msg1 -&gt; Runnable 2 -&gt; msg2</span>
</code></pre>
<h2 data-id="heading-24">ä¸ƒã€ä½œè€…ç®€ä»‹</h2>
<p>æ˜é‡‘ï¼š<a href="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts" target="_blank" title="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts">juejin.im/user/5c3033â€¦</a></p>
<p>csdnï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_37625173" target="_blank" title="https://blog.csdn.net/weixin_37625173" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_3762â€¦</a></p>
<p>å…¬ä¼—å·ï¼šå¾®ä¿¡æœç´¢ "æ±Ÿæ¾æ¶Œ"</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[25 åˆ†é’ŸæŠŠ IPv6â€œå¸¦åâ€å…¨ç½‘ï¼šCloudflareè¿™æ¬¡ç©å¤§äº†ï¼]]></title>    <link>https://juejin.cn/post/7598480413803823146</link>    <guid>https://juejin.cn/post/7598480413803823146</guid>    <pubDate>2026-01-24T11:00:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480413803823146" data-draft-id="7598480413803806762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="25 åˆ†é’ŸæŠŠ IPv6â€œå¸¦åâ€å…¨ç½‘ï¼šCloudflareè¿™æ¬¡ç©å¤§äº†ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-24T11:00:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Dcs"/> <meta itemprop="url" content="https://juejin.cn/user/3679404422861902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            25 åˆ†é’ŸæŠŠ IPv6â€œå¸¦åâ€å…¨ç½‘ï¼šCloudflareè¿™æ¬¡ç©å¤§äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3679404422861902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Dcs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T11:00:45.000Z" title="Sat Jan 24 2026 11:00:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€åœº**å…¸å‹çš„â€œçœ‹èµ·æ¥åªæ˜¯åˆ äº†å‡ è¡Œé…ç½®ï¼Œå®é™…æŠŠé—¸é—¨æ‹†äº†â€**çš„äº‹æ•…ã€‚</p>
<p>2026 å¹´ 1 æœˆ 22 æ—¥ï¼ŒCloudflare åœ¨ç¾å›½è¿ˆé˜¿å¯†ï¼ˆMiamiï¼‰çš„ä¸€ä¸ªæ•°æ®ä¸­å¿ƒè·¯ç”±å™¨ä¸Šï¼Œå› ä¸º<strong>è‡ªåŠ¨åŒ–è·¯ç”±ç­–ç•¥é…ç½®é”™è¯¯</strong>ï¼ŒæŠŠä¸€éƒ¨åˆ†åŸæœ¬åªè¯¥åœ¨å†…éƒ¨ä¼ æ’­çš„ <strong>IPv6 BGP å‰ç¼€</strong>æ„å¤–å¯¹å¤–å®£å‘Šäº†å‡ºå»ï¼Œå½¢æˆ <strong>BGP Route Leakï¼ˆè·¯ç”±æ³„æ¼ï¼‰</strong>ã€‚äº‹æ•…æŒç»­ <strong>25 åˆ†é’Ÿ</strong>ï¼Œå¯¼è‡´è¿ˆé˜¿å¯†éª¨å¹²é“¾è·¯æ‹¥å¡ã€éƒ¨åˆ†å®¢æˆ·æµé‡ä¸¢åŒ…/å»¶è¿Ÿå‡é«˜ï¼ŒåŒæ—¶è¿˜æŠŠä¸€äº›å¤–éƒ¨ç½‘ç»œçš„æµé‡â€œè¯¯å¯¼â€è¿›è¿ˆé˜¿å¯†ï¼Œæœ€ç»ˆè¢« Cloudflare çš„é˜²ç«å¢™è¿‡æ»¤è§„åˆ™ä¸¢å¼ƒï¼ˆå³°å€¼ä¸¢äº†çº¦ 12Gbps å…¥å£æµé‡ï¼‰ã€‚</p>
<p>å¬èµ·æ¥åƒç½‘ç»œåœˆçš„â€œè´è¶æ•ˆåº”â€ï¼šä½ åªæ˜¯åœ¨è·¯ç”±ç­–ç•¥é‡ŒæŒªäº†ä¸€å—ç –ï¼Œç»“æœåŠä¸ªè¡—åŒºçš„è½¦æµéƒ½æ”¹é“äº†ğŸš§ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ Route Leakï¼š</h2>
<p>ä¸æ˜¯â€œæ–­ç½‘â€ï¼Œæ˜¯â€œæŒ‡é”™è·¯â€</p>
<p>è·¯ç”±æ³„æ¼çš„æœ¬è´¨éå¸¸ç›´ç™½ï¼š<strong>æŸä¸ª AS å‘Šè¯‰æ•´ä¸ªäº’è”ç½‘ï¼šæ¥æˆ‘è¿™èµ°ï¼Œæˆ‘èƒ½å¸¦ä½ åˆ°ç»ˆç‚¹</strong>â€”â€”ä½†å®ƒå…¶å®ä¸è¯¥è¿™ä¹ˆè¯´ã€‚</p>
<p>BGP é‡Œæœ‰ä¸ªâ€œæ½œè§„åˆ™â€ï¼š<strong>ä»ä¸Šæ¸¸ï¼ˆproviderï¼‰å’Œå¯¹ç­‰ï¼ˆpeerï¼‰å­¦åˆ°çš„è·¯ç”±ï¼Œä¸èƒ½å†è½¬å‘ç»™å¦ä¸€ä¸ª peer æˆ– provider</strong>ï¼Œå¦åˆ™å°±è¿åæ‰€è°“çš„ <em>valley-free routing</em>ã€‚ä¸€æ—¦è¿åï¼Œæµé‡ä¼šè¢«å¸åˆ°ä¸è¯¥æ‰¿è½½å®ƒçš„ç½‘ç»œä¸Šï¼Œè½»åˆ™æ‹¥å¡ã€æŠ–åŠ¨ï¼Œé‡åˆ™å¤§èŒƒå›´ä¸å¯è¾¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7171b214005482fa8a71c10b708fa31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769857245&amp;x-signature=%2FIvBJi4saYsQF4P0hPTTUvgoqXo%3D" alt="image.png" loading="lazy"/>
è¿™æ¬¡äº‹æ•…å°±æ˜¯ç±»ä¼¼çš„â€œæŒ‡è·¯ç‰Œæ‘†åäº†â€ï¼šCloudflare åœ¨è¿ˆé˜¿å¯†æŠŠ<strong>ä»ä¸€äº› peer å­¦åˆ°çš„è·¯ç”±</strong>ï¼Œåˆè½¬æ‰‹â€œæ¨é”€â€ç»™äº†<strong>å…¶ä»– peer å’Œ transit provider</strong>ï¼Œå±äº RFC7908 é‡Œæåˆ°çš„å¤šç§ route leak ç±»å‹æ··åˆä½“ï¼ˆç®€å•ç†è§£ï¼šè¯¥å¾€ä¸‹æ¸¸èµ°çš„è·¯ï¼Œè¢«é”™è¯¯åœ°å¾€ä¸Š/å¹³è¡Œæ‰©æ•£äº†ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-1">æ—¶é—´çº¿ï¼šä»åˆå¹¶ä»£ç åˆ°æ­¢è¡€ï¼ŒåªèŠ±äº† 25 åˆ†é’Ÿï¼ˆä½†è¶³å¤Ÿéš¾å—ï¼‰</h2>
<p>è¿™æ¬¡èŠ‚å¥å¾ˆâ€œç°ä»£å·¥ç¨‹åŒ–â€ï¼šä»£ç åˆå¹¶ â†’ è‡ªåŠ¨åŒ–è·‘é…ç½® â†’ çº¿ä¸Šç«‹åˆ»å‡ºäº‹ â†’ äººè‚‰å›æ»šæ­¢è¡€ â†’ å†å›æ»šä»£ç ã€‚</p>









































<table><thead><tr><th><strong>Time (UTC)</strong></th><th><strong>Event</strong></th></tr></thead><tbody><tr><td>2026-01-22 19:52 UTC</td><td>è§¦å‘è·¯ç”±ç­–ç•¥ bug çš„å˜æ›´åˆå¹¶è¿›ç½‘ç»œè‡ªåŠ¨åŒ–ä»£ç ä»“åº“</td></tr><tr><td>2026-01-22 20:25 UTC</td><td>è‡ªåŠ¨åŒ–åœ¨è¿ˆé˜¿å¯†å•å°è¾¹ç¼˜è·¯ç”±å™¨è¿è¡Œï¼Œå¼€å§‹å‘ transit/peer å¼‚å¸¸å®£å‘Šï¼ˆIMPACT STARTï¼‰</td></tr><tr><td>2026-01-22 20:40 UTC</td><td>ç½‘ç»œå›¢é˜Ÿå¼€å§‹æ’æŸ¥è¿ˆé˜¿å¯†çš„å¼‚å¸¸ BGP å¹¿å‘Š</td></tr><tr><td>2026-01-22 20:44 UTC</td><td>äº‹æ•…å‡çº§ï¼Œå¼€å§‹ååŒå¤„ç½®</td></tr><tr><td>2026-01-22 20:50 UTC</td><td>æ“ä½œå‘˜æ‰‹åŠ¨å›æ»šåé…ç½®ï¼Œå¹¶æš‚åœè¯¥è·¯ç”±å™¨çš„è‡ªåŠ¨åŒ–ï¼ˆIMPACT STOPï¼‰</td></tr><tr><td>2026-01-22 21:47 UTC</td><td>è§¦å‘æ³„æ¼çš„ä»£ç æäº¤è¢«å›æ»š</td></tr><tr><td>2026-01-22 22:07 UTC</td><td>ç¡®è®¤è‡ªåŠ¨åŒ–æ¢å¤å¥åº·ï¼Œå¯é‡æ–°åœ¨è¿ˆé˜¿å¯†è·¯ç”±å™¨è¿è¡Œ</td></tr><tr><td>2026-01-22 22:40 UTC</td><td>è¿ˆé˜¿å¯†å•å°è·¯ç”±å™¨è§£é™¤è‡ªåŠ¨åŒ–æš‚åœ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">â€œåˆ æ‰ BogotÃ¡ çš„å‰ç¼€â€æ€ä¹ˆåˆ æˆäº†â€œå…¨éƒ½æ”¾è¡Œâ€ï¼Ÿ</h2>
<p>äº‹æ•…èµ·ç‚¹å…¶å®å¾ˆåˆç†ï¼šCloudflare ä¹‹å‰ä¼šæŠŠä¸€éƒ¨åˆ† IPv6 æµé‡ç»è¿ˆé˜¿å¯†è½¬å‘åˆ°å“¥ä¼¦æ¯”äºšæ³¢å“¥å¤§ï¼ˆBogotÃ¡ï¼‰æ•°æ®ä¸­å¿ƒï¼Œä½†éšç€åŸºç¡€è®¾æ–½å‡çº§ï¼Œè¿™ä¸ªç»•è·¯ä¸éœ€è¦äº†ï¼Œäºæ˜¯è¦æŠŠ BogotÃ¡ ç›¸å…³å‰ç¼€ä»è¿ˆé˜¿å¯†æ’¤æ‰ã€‚</p>
<p>å˜æ›´ diff å¤§æ¦‚é•¿è¿™æ ·ï¼ˆçœ‹ç€å¾ˆâ€œæ— å®³â€å¯¹å§ï¼Ÿï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[edit policy-options policy-statement 6-COGENT-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-COMCAST-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-GTT-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-LEVEL3-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-PRIVATE-PEER-ANYCAST-OUT term ADV-SITELOCAL from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-PUBLIC-PEER-ANYCAST-OUT term ADV-SITELOCAL from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-PUBLIC-PEER-OUT term ADV-SITELOCAL from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-TELEFONICA-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
<span class="hljs-section">[edit policy-options policy-statement 6-TELIA-ACCEPT-EXPORT term ADV-SITELOCAL-GRE-RECEIVER from]</span>
-      prefix-list 6-BOG04-SITE-LOCAL<span class="hljs-comment">;</span>
</code></pre>
<p>é—®é¢˜å°±å‡ºåœ¨ï¼š<strong>æŠŠ prefix-list æ¡ä»¶åˆ æ‰åï¼Œç­–ç•¥é¡¹çš„åŒ¹é…æ¡ä»¶å˜å¾—è¿‡äºå®½æ¾</strong>ï¼Œç›´æ¥å˜æˆäº†â€œåªè¦æ˜¯ internal route-typeï¼Œæˆ‘å°± acceptï¼Œç„¶åå¯¹å¤– exportâ€ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">policy<span class="hljs-operator">-</span>options policy<span class="hljs-operator">-</span>statement <span class="hljs-number">6</span><span class="hljs-operator">-</span>TELIA<span class="hljs-operator">-</span>ACCEPT<span class="hljs-operator">-</span>EXPORT {
    term ADV<span class="hljs-operator">-</span>SITELOCAL<span class="hljs-operator">-</span>GRE<span class="hljs-operator">-</span>RECEIVER {
        <span class="hljs-keyword">from</span> route<span class="hljs-operator">-</span>type internal;
        <span class="hljs-keyword">then</span> {
            community <span class="hljs-keyword">add</span> <span class="hljs-keyword">STATIC</span><span class="hljs-operator">-</span>ROUTE;
            community <span class="hljs-keyword">add</span> SITE<span class="hljs-operator">-</span><span class="hljs-keyword">LOCAL</span><span class="hljs-operator">-</span>ROUTE;
            community <span class="hljs-keyword">add</span> MIA01;
            community <span class="hljs-keyword">add</span> NORTH<span class="hljs-operator">-</span>AMERICA;
            accept;
        }
    }
}
</code></pre>
<p>è¿™é‡Œæœ‰ä¸ª JunOS/JunOS EVO çš„å‘ç‚¹ï¼š<code>route-type internal</code> ä¼šåŒ¹é…<strong>æ‰€æœ‰é external çš„è·¯ç”±ç±»å‹</strong>ï¼ŒåŒ…æ‹¬ IBGP å­¦åˆ°çš„å†…éƒ¨è·¯ç”±ã€‚äºæ˜¯æœ¬æ¥åªæƒ³â€œå†…éƒ¨å¯è§â€çš„ IPv6 å‰ç¼€ï¼Œè¢«è¿™æ¡ export policy ç›´æ¥æ”¾è¡Œå¯¹å¤–å¹¿æ’­äº†ã€‚</p>
<p>ä¸€å¥è¯ï¼š<strong>åŸæ¥é  prefix-list å½“â€œé—¨ç¦â€ï¼Œåˆ äº†é—¨ç¦åï¼Œå‰©ä¸‹çš„æ¡ä»¶ç›¸å½“äºâ€œåªè¦ä½ æ˜¯å°åŒºä½æˆ·ï¼Œå°±èƒ½æŠŠå¿«é€’ç«™é‡Œçš„æ‰€æœ‰åŒ…è£¹æ¬å‡ºå»â€</strong>â€”â€”ç­–ç•¥å†™å¾—å†â€œä¼˜é›…â€ï¼Œ<code>accept</code> ä¸€è½åœ°å°±æˆäº†äº‹æ•…å¼€å…³ğŸ”˜ã€‚</p>
<hr/>
<h2 data-id="heading-3">å½±å“é¢ï¼šæ‹¥å¡ã€ä¸¢åŒ…ã€å»¶è¿Ÿä¸Šå‡ï¼Œè¿˜é¡ºå¸¦â€œè¯¯ä¼¤â€å¤–éƒ¨ç½‘ç»œ</h2>
<p>å½“è¿ˆé˜¿å¯†å¼€å§‹å¯¹å¤–å®£å‘Šè¿™äº›ä¸è¯¥å®£å‘Šçš„ IPv6 å‰ç¼€åï¼Œäº’è”ç½‘è·¯ç”±æ”¶æ•›ä¼šè®©éƒ¨åˆ†æµé‡<strong>è¢«å¸åˆ°è¿ˆé˜¿å¯†</strong>ã€‚ç»“æœå°±æ˜¯ï¼š</p>
<ul>
<li>è¿ˆé˜¿å¯†â€”äºšç‰¹å…°å¤§éª¨å¹²é“¾è·¯å‡ºç°æ‹¥å¡ï¼Œå¯¼è‡´ä¸€äº› Cloudflare å®¢æˆ·æµé‡å‡ºç°æ›´é«˜çš„å»¶è¿Ÿ/ä¸¢åŒ…</li>
<li>è¢«æ³„æ¼çš„å‰ç¼€æ‰€å±ç½‘ç»œï¼ˆå¤–éƒ¨ç½‘ç»œï¼‰çš„ä¸€éƒ¨åˆ†æµé‡ä¹Ÿè¢«å¼•å‘è¿ˆé˜¿å¯†ï¼Œä½† Cloudflare è·¯ç”±å™¨çš„é˜²ç«å¢™è¿‡æ»¤å™¨åªå…è®¸ Cloudflare/å®¢æˆ·ç›¸å…³å‰ç¼€çš„æµé‡ï¼Œå¯¼è‡´è¿™éƒ¨åˆ†æµé‡è¢«ä¸¢å¼ƒï¼ˆå³°å€¼çº¦ 12Gbpsï¼‰</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/962bbee0635c49b0b1bda64d680c21f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769857245&amp;x-signature=scBsrJ%2FJmNTgzZ%2FyLWPwKgfD%2Ffs%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b7aa229da4a45a6b753d0c3b19524fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769857245&amp;x-signature=TpUYoXL4dozUk3%2F8x7%2BEej6zYcs%3D" alt="image.png" loading="lazy"/></p>
<p>åŒæ—¶ï¼Œè·¯ç”±æ³„æ¼çš„è¯æ®ä¹Ÿèƒ½åœ¨è·¯ç”±æ”¶é›†å™¨çš„å†å²æ•°æ®é‡Œçœ‹åˆ°ï¼Œæ¯”å¦‚è¿™æ®µ monocle æ£€ç´¢ç»“æœï¼ˆæ³¨æ„ AS path ä¸­ Cloudflare AS13335 å‡ºç°åœ¨ä¸è¯¥å‡ºç°çš„ä½ç½®ä¸Šï¼‰ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">âœ  ~ monocle search --start-ts <span class="hljs-number">2026</span>-<span class="hljs-number">01</span>-22<span class="hljs-symbol">T20:</span><span class="hljs-number">24</span><span class="hljs-symbol">:</span>00Z --<span class="hljs-keyword">end</span>-ts <span class="hljs-number">2026</span>-<span class="hljs-number">01</span>-22<span class="hljs-symbol">T20:</span><span class="hljs-number">30</span><span class="hljs-symbol">:</span>00Z --as-path <span class="hljs-string">".*13335[ d$]32934$*"</span>
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f077</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f091</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f16f</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f17c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f26f</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f27c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113609.854028</span>|<span class="hljs-number">2801</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">9000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">4112</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">64112</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f33f</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">64112 22850 174 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2801:14:9000::6:4112:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">22850</span><span class="hljs-symbol">:</span><span class="hljs-number">65151</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|pit.scl
A|<span class="hljs-params">1769113583.095278</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">:</span><span class="hljs-number">9544</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">49544</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f17c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">49544 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:504:d::4:9544:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25000</span> <span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25800</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16000</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16106</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
A|<span class="hljs-params">1769113583.095278</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">:</span><span class="hljs-number">9544</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">49544</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f27c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">49544 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:504:d::4:9544:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25000</span> <span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25800</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16000</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16106</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
A|<span class="hljs-params">1769113583.095278</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">:</span><span class="hljs-number">9544</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">49544</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f091</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">49544 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:504:d::4:9544:1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>|<span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25000</span> <span class="hljs-number">1299</span><span class="hljs-symbol">:</span><span class="hljs-number">25800</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16000</span> <span class="hljs-number">49544</span><span class="hljs-symbol">:</span><span class="hljs-number">16106</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
A|<span class="hljs-params">1769113584.324483</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span><span class="hljs-symbol">:</span><span class="hljs-number">9524</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">199524</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f091</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">199524 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:2035:0:2bfd::1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>||<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
A|<span class="hljs-params">1769113584.324483</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span><span class="hljs-symbol">:</span><span class="hljs-number">9524</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">199524</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f17c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">199524 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:2035:0:2bfd::1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>||<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
A|<span class="hljs-params">1769113584.324483</span>|<span class="hljs-number">2001</span><span class="hljs-symbol">:</span><span class="hljs-number">504</span><span class="hljs-symbol">:d</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span><span class="hljs-symbol">:</span><span class="hljs-number">9524</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>|<span class="hljs-params">199524</span>|2<span class="hljs-symbol">a03:</span><span class="hljs-number">2880</span><span class="hljs-symbol">:f27c</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-number">48</span>|<span class="hljs-params">199524 1299 3356 13335 32934</span>|<span class="hljs-variable constant_">IGP</span>|<span class="hljs-params">2001:2035:0:2bfd::1</span>|<span class="hljs-number">0</span>|<span class="hljs-params">0</span>||<span class="hljs-params"><span class="hljs-literal">false</span></span>||<span class="hljs-params"/>|route-views.isc
{trimmed}
</code></pre>
<hr/>
<h2 data-id="heading-4">åˆ«å†è¿·ä¿¡â€œè‡ªåŠ¨åŒ–=ä¸ä¼šé”™â€</h2>
<p>è¿™æ¬¡äº‹æ•…æœ€æ‰å¿ƒçš„ä¸€ç‚¹æ˜¯ï¼š<strong>è‡ªåŠ¨åŒ–æ²¡æœ‰åï¼Œåçš„æ˜¯ç­–ç•¥ç”Ÿæˆé€»è¾‘é‡Œé‚£ä¸ªâ€œç©ºæ¡ä»¶â€ç¼ºå£</strong>ã€‚è‡ªåŠ¨åŒ–æŠŠé”™è¯¯æ”¾å¤§å¾—æ›´å¿«ã€æ›´ä¸€è‡´ã€æ›´â€œå…¨è‡ªåŠ¨â€ï¼Œæ‰€ä»¥ä¹Ÿæ›´éœ€è¦â€œåˆ¹è½¦ç³»ç»Ÿâ€ã€‚</p>
<p>Cloudflare çš„æ”¹è¿›æ–¹å‘å¾ˆæœ‰ä»£è¡¨æ€§ï¼ŒåŸºæœ¬å¯ä»¥å½“æˆç½‘ç»œè‡ªåŠ¨åŒ–å›¢é˜Ÿçš„â€œå®‰å…¨ checklistâ€ï¼š</p>
<ul>
<li><strong>ç«‹åˆ»ä¿®è¡¥</strong>è·¯ç”±ç­–ç•¥è‡ªåŠ¨åŒ–é‡Œå¯¼è‡´é”™è¯¯æ”¾è¡Œçš„ç¼ºé™·ï¼Œå¹¶åœ¨åŒç±»é£é™©ç‚¹ä¸Šè¡¥æ´</li>
<li>åœ¨è·¯ç”±ç­–ç•¥é‡ŒåŠ æ›´å¼ºçš„<strong>åŸºäº BGP community çš„é˜²æŠ¤</strong>ï¼šå¯¹å¤– export policy ä¸Šæ˜ç¡®æ‹’ç»â€œæ¥è‡ª peer/provider çš„è·¯ç”±â€</li>
<li>åœ¨ CI/CD é‡Œåš<strong>è‡ªåŠ¨åŒ–ç­–ç•¥è¯„ä¼°</strong>ï¼šé‡ç‚¹æŠ“â€œç©º/é”™è¯¯çš„ policy termâ€ï¼ˆåƒè¿™æ¬¡å°±æ˜¯åˆ  prefix-list å term è¿˜ acceptï¼‰</li>
<li>æå‰å‘Šè­¦ï¼šæ›´æ—©å‘ç°é…ç½®å¼‚å¸¸ä¸è‡ªåŠ¨åŒ–å˜æ›´çš„è´Ÿé¢æ•ˆåº”</li>
<li>æ›´é•¿æœŸçš„è·¯ç”±å®‰å…¨ï¼šéªŒè¯å¹¶æ¨è¿› **RFC9234ï¼ˆBGP Roles / Only-to-Customerï¼‰**ç­‰æœºåˆ¶ï¼Œä»â€œåè®®èƒ½åŠ›â€å±‚é¢é™ä½æœ¬åœ° AS route leak çš„æ¦‚ç‡</li>
<li>ä¿ƒè¿› <strong>RPKI ASPA</strong> ä¹‹ç±»èƒ½åŠ›çš„é‡‡ç”¨ï¼Œè®©å¼‚å¸¸ AS path æ›´å®¹æ˜“è¢«è‡ªåŠ¨æ‹’ç»</li>
</ul>
<hr/>
<h2 data-id="heading-5">ç»“è¯­</h2>
<p>ç½‘ç»œä¸–ç•Œæœ€æ€•çš„ä¸æ˜¯â€œæ”¹é…ç½®â€ï¼Œæ˜¯â€œæ”¹é…ç½®è¿˜ä»¥ä¸ºæ²¡äº‹â€ğŸ˜…</p>
<p>è¿™åœº 25 åˆ†é’Ÿçš„æ³„æ¼ï¼Œæ€ä¼¤åŠ›å¹¶ä¸é æŒç»­æ—¶é—´ï¼Œè€Œé  <strong>BGP çš„ä¼ æ’­é€Ÿåº¦ + æµé‡çš„æƒ¯æ€§</strong>ã€‚æ›´ç°å®çš„æ˜¯ï¼šåªè¦ç³»ç»Ÿå…è®¸â€œå†…éƒ¨è·¯ç”±è¢« accept å¹¶ exportâ€ï¼Œé‚£å°±ç­‰äºæŠŠâ€œå†…éƒ¨è½¦é“â€ç›´æ¥è¿åˆ°äº†é«˜é€Ÿå…¥å£â€”â€”è¿Ÿæ—©ä¼šå µã€‚</p>
<p>çœŸæ­£èƒ½è®©ç³»ç»Ÿæ›´ç¨³çš„ï¼Œä¸æ˜¯â€œä»¥åå°å¿ƒç‚¹â€ï¼Œè€Œæ˜¯å·¥ç¨‹åŒ–åœ°æŠŠé£é™©é’‰æ­»ï¼š</p>
<ul>
<li>å…³é”®ç­–ç•¥é¡¹ä¸èƒ½å‡ºç°â€œæ¡ä»¶è¢«åˆ ç©ºä½†ä» acceptâ€</li>
<li>å¯¹å¤– export å¿…é¡»èƒ½è¯†åˆ«å¹¶æ‹’ç»æ¥è‡ª peer/provider çš„è·¯ç”±</li>
<li>è‡ªåŠ¨åŒ–è¦é…â€œç­–ç•¥å•æµ‹ + å˜æ›´è¯„ä¼° + å®¡è®¡ä¸å›æ»šâ€ä¸‰ä»¶å¥—</li>
</ul>
<p>æ¯•ç«Ÿï¼Œäº’è”ç½‘çš„è·¯ç”±ä¸æ˜¯ä½ å®¶è·¯å£çš„æŒ‡ç¤ºç‰Œï¼Œæ‘†æ­ªäº†ï¼Œæ•´åº§åŸå¸‚éƒ½å¯èƒ½è·Ÿç€ç»•è·¯ã€‚ğŸ˜µâ€ğŸ’«</p>
<hr/>
<p><strong>å–œæ¬¢å°±å¥–åŠ±ä¸€ä¸ªâ€œğŸ‘â€å’Œâ€œåœ¨çœ‹â€å‘—~</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d74923daef14367b4a55b374fbd6168~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769857245&amp;x-signature=gbh6%2BpE3%2FQbTEF2hQ4qW36hB284%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ ä¸çŸ¥é“çš„ TypeScriptï¼šè”åˆç±»å‹ä¸åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹]]></title>    <link>https://juejin.cn/post/7598532592456007707</link>    <guid>https://juejin.cn/post/7598532592456007707</guid>    <pubDate>2026-01-24T11:02:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592456007707" data-draft-id="7598020609281867810" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ ä¸çŸ¥é“çš„ TypeScriptï¼šè”åˆç±»å‹ä¸åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹"/> <meta itemprop="keywords" content="å‰ç«¯,TypeScript"/> <meta itemprop="datePublished" content="2026-01-24T11:02:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘ä¸åƒé¥¼å¹²"/> <meta itemprop="url" content="https://juejin.cn/user/3263006241480605"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ ä¸çŸ¥é“çš„ TypeScriptï¼šè”åˆç±»å‹ä¸åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006241480605/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘ä¸åƒé¥¼å¹²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T11:02:47.000Z" title="Sat Jan 24 2026 11:02:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ TypeScript ä¸­ï¼Œè”åˆç±»å‹æ˜¯éå¸¸å¸¸ç”¨çš„ç±»å‹å·¥å…·ï¼Œä½†è”åˆç±»å‹åœ¨æ¡ä»¶ç±»å‹ä¸­çš„åˆ†å¸ƒå¼ç‰¹æ€§ï¼Œä¼°è®¡ä¼šå›°æ‰°å¾ˆå¤šäººï¼Œå› ä¸ºå®ƒçš„è¡Œä¸ºéå¸¸çš„â€¦ä¸ç›´è§‚ã€‚</p>
<p>æ‰€ä»¥æœ¬æ–‡å°½é‡ç”¨ç®€å•çš„è¯­è¨€å’Œä¸°å¯Œçš„ä¾‹å­æ¥è®©å¤§å®¶å½»åº•ææ‡‚è”åˆç±»å‹ä¸åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œæä¸æ‡‚ä¹Ÿåˆ«æ‰“æˆ‘ã€‚</p>
<h2 data-id="heading-0">è”åˆç±»å‹</h2>
<p><strong>è”åˆç±»å‹ï¼ˆUnion Typesï¼‰</strong> è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä»¥æ˜¯å‡ ç§ç±»å‹ä¹‹ä¸€ã€‚ç”¨ç«–çº¿ <code>|</code> æ¥åˆ†éš”æ¯ä¸ªç±»å‹ï¼Œä¾‹å¦‚ <code>string | number</code> è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä»¥æ˜¯ <code>string</code> æˆ– <code>number</code>ã€‚</p>
<p>è”åˆç±»å‹çš„åŸºç¡€ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è¡¨ç¤ºç±»å‹å¯ä»¥ä¸º string æˆ– number</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">StringOrNumber</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">StringOrNumber</span>;
value = <span class="hljs-string">"hello"</span>;  <span class="hljs-comment">// âœ…</span>
value = <span class="hljs-number">42</span>;       <span class="hljs-comment">// âœ…</span>
value = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// âŒ ä¸èƒ½å°†ç±»å‹â€œbooleanâ€åˆ†é…ç»™ç±»å‹â€œStringOrNumberâ€</span>

<span class="hljs-comment">// å¤šä¸ªç±»å‹çš„è”åˆ</span>
<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">ID</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">symbol</span>;

<span class="hljs-comment">// å­—é¢é‡ç±»å‹çš„è”åˆ</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Status</span> = <span class="hljs-string">"pending"</span> | <span class="hljs-string">"success"</span> | <span class="hljs-string">"error"</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">StyleType</span> = <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span>;
</code></pre>
<h2 data-id="heading-1">åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯æ¡ä»¶ç±»å‹ï¼Ÿ</h3>
<p>æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰çš„è¯­æ³•ç±»ä¼¼äº JavaScript ä¸­çš„ä¸‰å…ƒè¿ç®—ç¬¦ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">SomeType</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">OtherType</span> ? <span class="hljs-title class_">TrueType</span> : <span class="hljs-title class_">FalseType</span>;
</code></pre>
<p>å®ƒè¡¨ç¤ºï¼šå½“ <code>extends</code> å·¦è¾¹çš„ç±»å‹ <code>SomeType</code> å¯ä»¥èµ‹å€¼ç»™å³ä¾§çš„ç±»å‹ <code>OtherType</code> æ—¶ï¼Œè¿”å› <code>TrueType</code>ï¼Œå¦åˆ™è¿”å› <code>FalseType</code>ã€‚</p>
<p>ç”¨æ³•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> A = <span class="hljs-built_in">string</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">'string'</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span> <span class="hljs-comment">// false</span>
<span class="hljs-keyword">type</span> B = <span class="hljs-string">'string'</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span> <span class="hljs-comment">// true</span>
<span class="hljs-keyword">type</span> C = <span class="hljs-built_in">number</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">number</span> ? <span class="hljs-built_in">boolean</span> : <span class="hljs-built_in">string</span> <span class="hljs-comment">// boolean</span>
</code></pre>
<p>å®é™…åº”ç”¨ä¸­ï¼Œæ¡ä»¶ç±»å‹å¸¸é…åˆæ³›å‹ä¸€èµ·ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆ¤æ–­ä¸€ä¸ªç±»å‹æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ç±»å‹</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">IsString</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
<span class="hljs-keyword">type</span> A = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-built_in">string</span>&gt;;   <span class="hljs-comment">// true</span>
<span class="hljs-keyword">type</span> B = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-built_in">number</span>&gt;;   <span class="hljs-comment">// false</span>

<span class="hljs-comment">// æå–å‡½æ•°çš„è¿”å›ç±»å‹</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">MyReturnType</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]) =&gt; infer R ? R : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> R = <span class="hljs-title class_">MyReturnType</span>&lt;<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span>&gt;;  <span class="hljs-comment">// string</span>
</code></pre>
<h3 data-id="heading-3">ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Ÿ</h3>
<blockquote>
<p>When conditional types act on a generic type, they become <em>distributive</em> when given a union type.</p>
</blockquote>
<p><strong>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼ˆDistributive Conditional Typesï¼‰</strong> æ˜¯æŒ‡ï¼šå½“æ¡ä»¶ç±»å‹ä½œç”¨äºæ³›å‹ç±»å‹æ—¶ï¼Œå¦‚æœè¯¥æ³›å‹ç±»å‹ä¸ºè”åˆç±»å‹ï¼Œåˆ™æ¡ä»¶ç±»å‹å°†å…·æœ‰ <em>åˆ†å¸ƒæ€§</em>ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ¡ä»¶ç±»å‹ä¼šåˆ†åˆ«å¯¹è”åˆç±»å‹çš„æ¯ä¸ªæˆå‘˜è¿›è¡Œåˆ¤æ–­å’Œå¤„ç†ï¼Œç„¶åå°†æ‰€æœ‰ç»“æœé‡æ–°ç»„åˆæˆä¸€ä¸ªè”åˆç±»å‹ã€‚æˆ‘æ„¿æ„æŠŠè¿™ç†è§£ä¸º <strong>TypeScript ç±»å‹ç³»ç»Ÿä¸­çš„ "forEach"</strong>ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢çš„ç±»å‹ <code>ToArray</code>ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä¼šæŠŠè”åˆç±»å‹æ³›å‹å½“åšä¸€ä¸ªæ•´ä½“å¤„ç†ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ToArray</span>&lt;T&gt; = T[]
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result</span> = <span class="hljs-title class_">ToArray</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>&gt;; <span class="hljs-comment">// (string | number)[]</span>
</code></pre>
<p>è€Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨æ¡ä»¶ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶è”åˆç±»å‹çš„æ¯ä¸€ä¸ªæˆå‘˜ä¼šåˆ†åˆ«åº”ç”¨äºæ¡ä»¶ç±»å‹ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ToArray</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span> ? T[] : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// å½“ T æ˜¯è”åˆç±»å‹æ—¶</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result</span> = <span class="hljs-title class_">ToArray</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>&gt;; <span class="hljs-comment">// string[] | number[]</span>

<span class="hljs-comment">// åˆ†å¸ƒè¿‡ç¨‹ï¼š</span>
<span class="hljs-comment">// ToArray&lt;string | number&gt;</span>
<span class="hljs-comment">// =&gt;  ToArray&lt;string&gt; | ToArray&lt;number&gt;</span>
<span class="hljs-comment">// =&gt; (string extends any ? string[] : never) | (number extends any ? number[] : never)</span>
<span class="hljs-comment">// =&gt; string[] | number[]</span>
</code></pre>
<p>è¿™é‡Œ <code>T extends any</code> å‡ ä¹æ°¸è¿œä¸ºçœŸï¼ˆé™¤äº† <code>T</code> ä¸º <code>never</code> çš„ç‰¹æ®Šæƒ…å†µï¼‰ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯è§¦å‘åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆ <code>T extends unknown</code> æˆ– <code>T extends T</code> ç­‰å½¢å¼æ¥ä¿è¯æ¡ä»¶ä¸ºçœŸã€‚</p>
<p>ä½†æ˜¯å¿…é¡»è¦æ³¨æ„ä¸€ç‚¹ï¼š<code>extends</code> çš„å·¦è¾¹å¿…é¡»ä¸ºå•ç‹¬çš„ <code>T</code>ã€‚</p>
<h3 data-id="heading-4">é˜»æ­¢åˆ†å¸ƒå¼è¡Œä¸º</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ¡ä»¶ç±»å‹ä¸­ä½¿ç”¨è”åˆç±»å‹ï¼Œä½†ä¸å¸Œæœ›è§¦å‘åˆ†å¸ƒå¼è¡Œä¸ºï¼Œæ­¤æ—¶å¯ä»¥ç”¨æ–¹æ‹¬å· <code>[]</code> å°† <code>extends</code> å…³é”®å­—ä¸¤ä¾§çš„ç±»å‹åŒ…è£¹èµ·æ¥ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ToArrayNonDist</span>&lt;<span class="hljs-title class_">Type</span>&gt; = [<span class="hljs-title class_">Type</span>] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">any</span>] ? <span class="hljs-title class_">Type</span>[] : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// æ­¤æ—¶ ArrOfStrOrNum ä¸å†æ˜¯ä¸€ä¸ªè”åˆç±»å‹</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">ArrOfStrOrNum</span> = <span class="hljs-title class_">ToArrayNonDist</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>&gt;; <span class="hljs-comment">// (string | number)[]</span>
</code></pre>
<p>æˆ‘ä»¬å°† <code>extends</code> å·¦è¾¹å•ç‹¬çš„ç±»å‹å‚æ•°ï¼ˆæ¯”å¦‚å‰é¢çš„ <code>T</code>ï¼‰ç§°ä¸º <strong>Naked Type</strong> (è£¸ç±»å‹ï¼Œä¸€èˆ¬æŒ‡æ²¡æœ‰è¢«åŒ…è£…çš„ç±»å‹)ã€‚åªæœ‰ Naked Type æ‰ä¼šè§¦å‘åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œå½“å®ƒä¸å†æ˜¯ <code>Naked Type</code> å°±ä¸ä¼šè§¦å‘åˆ†å¸ƒå¼ã€‚</p>
<p>äº‹å®ä¸Šï¼Œä»»ä½•å½¢å¼çš„åŒ…è£…éƒ½å¯ä»¥é˜»æ­¢åˆ†å¸ƒå¼ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>[T] extends [any]</code> - ç”¨å…ƒç»„åŒ…è£…</li>
<li><code>Array&lt;T&gt; extends Array&lt;any&gt;</code> - ç”¨æ³›å‹åŒ…è£…</li>
<li><code>{ value: T } extends { value: any }</code> - ç”¨å¯¹è±¡ç±»å‹åŒ…è£…</li>
</ul>
<p>åªè¦ <code>extends</code> å·¦è¾¹ä¸æ˜¯å•ç‹¬çš„è”åˆç±»å‹ï¼Œå°±ä¸ä¼šè§¦å‘åˆ†å¸ƒå¼è¡Œä¸ºã€‚</p>
<h2 data-id="heading-5">åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ç®€å•å®ä¾‹</h2>
<h3 data-id="heading-6">Exclude</h3>
<p>å®ç° TypeScript å†…ç½®çš„ <code>Exclude&lt;T, U&gt;</code> ç±»å‹ï¼šä»è”åˆç±»å‹ <code>T</code> ä¸­æ’é™¤ <code>U</code> ä¸­çš„ç±»å‹ï¼Œæ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ã€‚</p>
<p>åˆ©ç”¨åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹çš„ç‰¹æ€§ï¼Œä¾æ¬¡åˆ¤æ–­è”åˆç±»å‹ <code>T</code> çš„æ¯ä¸ªæˆå‘˜æ˜¯å¦å¯ä»¥èµ‹å€¼ç»™ <code>U</code>ã€‚å¦‚æœå¯ä»¥èµ‹å€¼ï¼Œåˆ™è¿”å› <code>never</code>ï¼ˆå°†å…¶ä»ç»“æœä¸­å‰”é™¤ï¼‰ï¼›å¦åˆ™è¿”å›è¯¥æˆå‘˜æœ¬èº«ï¼ˆå°†å…¶ä¿ç•™ï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyExclude</span>&lt;T, U&gt; = T <span class="hljs-keyword">extends</span> U ? <span class="hljs-built_in">never</span> : T;

<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">T1</span> = <span class="hljs-title class_">MyExclude</span>&lt;<span class="hljs-string">"a"</span> | <span class="hljs-string">"b"</span> | <span class="hljs-string">"c"</span>, <span class="hljs-string">"a"</span>&gt;; <span class="hljs-comment">// "b" | "c"</span>
<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">T2</span> = <span class="hljs-title class_">MyExclude</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>, <span class="hljs-built_in">string</span>&gt;; <span class="hljs-comment">// number | boolean</span>
</code></pre>
<h3 data-id="heading-7">Extract</h3>
<p>å®ç° TypeScript å†…ç½®çš„ <code>Extract&lt;T, U&gt;</code> ç±»å‹ï¼šä»è”åˆç±»å‹ <code>T</code> ä¸­æå– <code>U</code> ä¸­çš„ç±»å‹ï¼Œæ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ã€‚</p>
<p>ä¸ <code>Exclude</code> çš„é€»è¾‘å®Œå…¨ç›¸åï¼šå¦‚æœå¯ä»¥èµ‹å€¼ç»™ <code>U</code>ï¼Œåˆ™ä¿ç•™è¯¥æˆå‘˜ï¼›å¦åˆ™è¿”å› <code>never</code> å°†å…¶å‰”é™¤ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyExtract</span>&lt;T, U&gt; = T <span class="hljs-keyword">extends</span> U ? T : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">T3</span> = <span class="hljs-title class_">MyExtract</span>&lt;<span class="hljs-string">"a"</span> | <span class="hljs-string">"b"</span> | <span class="hljs-string">"c"</span>, <span class="hljs-string">"a"</span> | <span class="hljs-string">"b"</span>&gt;; <span class="hljs-comment">// "a" | "b"</span>
<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">T4</span> = <span class="hljs-title class_">MyExtract</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>, <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>&gt;; <span class="hljs-comment">// number | boolean</span>
</code></pre>
<h3 data-id="heading-8">Flatten</h3>
<p>æŠŠè”åˆç±»å‹ä¸­çš„æ¯ä¸ªæ•°ç»„å…ƒç´ éƒ½å±•å¹³ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Flatten</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> (infer U)[] ? U : T;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Nested</span> = <span class="hljs-built_in">string</span>[] | <span class="hljs-built_in">number</span>[];
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Flattened</span> = <span class="hljs-title class_">Flatten</span>&lt;<span class="hljs-title class_">Nested</span>&gt;; <span class="hljs-comment">// string | number</span>
</code></pre>
<h2 data-id="heading-9">å®æˆ˜ï¼šå®ç° Permutationï¼ˆå…¨æ’åˆ—ï¼‰</h2>
<p>okï¼Œå­¦å®Œ 1+1ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å­¦å¾®ç§¯åˆ†äº†ï¼Œç¬‘ï¼šï¼‰</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftype-challenges%2Ftype-challenges%2Fblob%2Fmain%2Fquestions%2F00296-medium-permutation%2FREADME.zh-CN.md" target="_blank" title="https://github.com/type-challenges/type-challenges/blob/main/questions/00296-medium-permutation/README.zh-CN.md" ref="nofollow noopener noreferrer">Type Challenges - Permutation</a></p>
<p>å®ç°è”åˆç±»å‹çš„å…¨æ’åˆ—ï¼Œå°†è”åˆç±»å‹è½¬æ¢æˆæ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—æ•°ç»„çš„è”åˆç±»å‹ã€‚</p>
<p><code>type perm = Permutation&lt;'A' | 'B' | 'C'&gt;; // ['A', 'B', 'C'] | ['A', 'C', 'B'] | ['B', 'A', 'C'] | ['B', 'C', 'A'] | ['C', 'A', 'B'] | ['C', 'B', 'A']</code></p>
</blockquote>
<p>è¿™æ˜¯ä¸€é“å…¸å‹çš„åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹åº”ç”¨é¢˜ã€‚ï¼ˆè°ä¼šçŸ¥é“æˆ‘ä¸ºäº†è¿™é“é†‹åŒ…äº†è¿™ç¯‡é¥ºå­ï¼‰ã€‚</p>
<p>å…¨æ’åˆ—é—®é¢˜çš„æ ¸å¿ƒæ€è·¯æ˜¯é€’å½’ï¼ˆå»ºè®®å…ˆç†è§£ JavaScript ä¸­çš„å…¨æ’åˆ—å®ç°ï¼‰ã€‚</p>
<p>ä»¥ <code>'A' | 'B' | 'C'</code> ä¸ºä¾‹ï¼Œé€’å½’çš„æ€è·¯æ˜¯ï¼š</p>
<ol>
<li>æšä¸¾ç¬¬ä¸€ä¸ªä½ç½®çš„å…ƒç´ ï¼ˆ<code>A</code>ã€<code>B</code> æˆ– <code>C</code>ï¼‰</li>
<li>å¯¹å‰©ä½™å…ƒç´ é€’å½’æ±‚å…¨æ’åˆ—</li>
<li>å°†å½“å‰å…ƒç´ ä¸å‰©ä½™å…ƒç´ çš„å…¨æ’åˆ—ç»„åˆ</li>
</ol>
<p>å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li>å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º <code>A</code> æ—¶ï¼Œå‰©ä½™å…ƒç´ ä¸º <code>B | C</code>ï¼Œé€’å½’è®¡ç®— <code>Permutation&lt;'B' | 'C'&gt;</code></li>
<li>å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º <code>B</code> æ—¶ï¼Œå‰©ä½™å…ƒç´ ä¸º <code>A | C</code>ï¼Œé€’å½’è®¡ç®— <code>Permutation&lt;'A' | 'C'&gt;</code></li>
<li>å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º <code>C</code> æ—¶ï¼Œå‰©ä½™å…ƒç´ ä¸º <code>A | B</code>ï¼Œé€’å½’è®¡ç®— <code>Permutation&lt;'A' | 'B'&gt;</code></li>
</ul>
<p>è¿™é‡Œçš„é‡ç‚¹æ˜¯ï¼š<strong>åˆ©ç”¨åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ä¼šè‡ªåŠ¨éå†è”åˆç±»å‹çš„æ¯ä¸ªæˆå‘˜çš„ç‰¹ç‚¹ï¼Œæšä¸¾é¦–å…ƒç´ </strong>ã€‚</p>
<p>éš¾ç‚¹åœ¨äºï¼šå¦‚ä½•è·å–"é™¤å½“å‰å…ƒç´ å¤–çš„å‰©ä½™å…ƒç´ "ï¼Ÿæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ³›å‹å‚æ•° <code>U</code> æ¥ä¿å­˜å®Œæ•´çš„è”åˆç±»å‹ã€‚å½“åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹éå†æ—¶ï¼Œ<code>T</code> æ˜¯å½“å‰å…ƒç´ ï¼Œ<code>U</code> æ˜¯å®Œæ•´çš„è”åˆç±»å‹ï¼Œæ­¤æ—¶ä½¿ç”¨ <code>Exclude&lt;U, T&gt;</code> å°±èƒ½å¾—åˆ°å‰©ä½™å…ƒç´ ã€‚</p>
<p>åˆæ­¥å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Permutation</span>&lt;T, U = T&gt; = 
  T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>
  ? [T, ...<span class="hljs-title class_">Permutation</span>&lt;<span class="hljs-title class_">Exclude</span>&lt;U, T&gt;&gt;]
  : []

<span class="hljs-keyword">type</span> R = <span class="hljs-title class_">Permutation</span>&lt;<span class="hljs-string">'A'</span> | <span class="hljs-string">'B'</span> | <span class="hljs-string">'C'</span>&gt;;
</code></pre>
<p>ä¸å¹¸çš„æ˜¯ï¼Œä¸Šé¢çš„å®ç°ä¼šå¾—åˆ° <code>never</code>ã€‚åŸå› æ˜¯<strong>é€’å½’ç¼ºå°‘ç»ˆæ­¢æ¡ä»¶</strong>ã€‚</p>
<p>å½“é€’å½’åˆ°æœ€åï¼Œ<code>T</code> ä¼šå˜æˆç©ºçš„è”åˆç±»å‹ï¼ˆå³ <code>never</code>ï¼‰ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰ç‰¹æ®Šå¤„ç†ç»ˆæ­¢æ¡ä»¶ï¼Œåªèƒ½å¾—åˆ° <code>never</code>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªç»ˆæ­¢æ¡ä»¶åˆ¤æ–­ï¼šå½“ <code>T</code> ä¸ºç©ºé›†æ—¶ï¼Œä¸éœ€è¦å†å¤„ç†ç›´æ¥è¿”å› <code>[]</code>ã€‚</p>
<p>åˆ¤æ–­ç©ºé›†çš„æ¡ä»¶æ˜¯ <code>[T] extends [never]</code>ã€‚è¿™é‡Œå°† <code>T</code> åŒ…è£¹åœ¨å…ƒç»„ä¸­ï¼Œé˜»æ­¢äº†åˆ†å¸ƒå¼è¡Œä¸ºï¼Œä½¿å…¶å˜æˆæ™®é€šçš„ç±»å‹æ£€æŸ¥ã€‚åªæœ‰å½“ <code>T</code> ä¸ºç©ºé›†æ—¶ï¼Œè¿™ä¸ªæ¡ä»¶æ‰ä¸ºçœŸã€‚</p>
<p>æ­£ç¡®ç­”æ¡ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç”Ÿæˆè”åˆç±»å‹çš„æ‰€æœ‰æ’åˆ—ç»„åˆ
 */</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Permutation</span>&lt;T, U = T&gt; = 
  [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">never</span>]
    ? []
    : T <span class="hljs-keyword">extends</span> U
      ? [T, ...<span class="hljs-title class_">Permutation</span>&lt;<span class="hljs-title class_">Exclude</span>&lt;U, T&gt;&gt;]
      : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-variable constant_">P1</span> = <span class="hljs-title class_">Permutation</span>&lt;<span class="hljs-string">"a"</span> | <span class="hljs-string">"b"</span> | <span class="hljs-string">"c"</span>&gt;;
<span class="hljs-comment">// =&gt; ["a", "b", "c"] | ["a", "c", "b"] | ["b", "a", "c"] | ["b", "c", "a"] | ["c", "a", "b"] | ["c", "b", "a"]</span>
</code></pre>
<h2 data-id="heading-10">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fdocs%2Fhandbook%2F2%2Feveryday-types.html%23union-types" target="_blank" title="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#union-types" ref="nofollow noopener noreferrer">TypeScript è”åˆç±»å‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fdocs%2Fhandbook%2F2%2Fconditional-types.html" target="_blank" title="https://www.typescriptlang.org/docs/handbook/2/conditional-types.html" ref="nofollow noopener noreferrer">TypeScript æ¡ä»¶ç±»å‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftype-challenges%2Ftype-challenges" target="_blank" title="https://github.com/type-challenges/type-challenges" ref="nofollow noopener noreferrer">Type Challenges</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµè§ˆå™¨æŒ‡çº¹ç®¡ç†ï¼šå¦‚ä½•åœ¨ Electron åº”ç”¨ä¸­å®ç°å¤šè´¦å·éš”ç¦»]]></title>    <link>https://juejin.cn/post/7598818096729079846</link>    <guid>https://juejin.cn/post/7598818096729079846</guid>    <pubDate>2026-01-24T08:53:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598818096729079846" data-draft-id="7598435950411235338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµè§ˆå™¨æŒ‡çº¹ç®¡ç†ï¼šå¦‚ä½•åœ¨ Electron åº”ç”¨ä¸­å®ç°å¤šè´¦å·éš”ç¦»"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2026-01-24T08:53:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘èˆŸå–"/> <meta itemprop="url" content="https://juejin.cn/user/360295546233959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµè§ˆå™¨æŒ‡çº¹ç®¡ç†ï¼šå¦‚ä½•åœ¨ Electron åº”ç”¨ä¸­å®ç°å¤šè´¦å·éš”ç¦»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546233959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘èˆŸå–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:53:16.000Z" title="Sat Jan 24 2026 08:53:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Electron åº”ç”¨ä¸­å®ç°æµè§ˆå™¨æŒ‡çº¹ç®¡ç†ï¼Œæ¶µç›–æŠ€æœ¯é€‰å‹ã€æ¶æ„è®¾è®¡ã€æ ¸å¿ƒå®ç°åˆ°è¸©å‘ç»éªŒã€‚é€‚åˆå¯¹æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€æŒ‡çº¹æŠ€æœ¯æ„Ÿå…´è¶£çš„å¼€å‘è€…é˜…è¯»ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦æµè§ˆå™¨æŒ‡çº¹ç®¡ç†</h2>
<p>åœ¨ RPAï¼ˆRobotic Process Automationï¼‰è‡ªåŠ¨åŒ–åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åŒæ—¶ç®¡ç†å¤šä¸ªè´¦å·ã€‚ç„¶è€Œï¼Œç°ä»£ç½‘ç«™å·²ç»å‘å±•å‡ºè¶Šæ¥è¶Šå¤æ‚çš„åçˆ¬è™«å’Œåè‡ªåŠ¨åŒ–æ£€æµ‹æœºåˆ¶ï¼š</p>
<h3 data-id="heading-1">ğŸ” å¸¸è§çš„æ£€æµ‹æ‰‹æ®µ</h3>






























<table><thead><tr><th>æ£€æµ‹ç±»å‹</th><th>æ£€æµ‹æ–¹å¼</th><th>é£é™©ç­‰çº§</th></tr></thead><tbody><tr><td><strong>æµè§ˆå™¨æŒ‡çº¹</strong></td><td>Canvasã€WebGLã€éŸ³é¢‘æŒ‡çº¹ç­‰è·¨ä¼šè¯è¿½è¸ª</td><td>ğŸ”´ é«˜</td></tr><tr><td><strong>è‡ªåŠ¨åŒ–æ£€æµ‹</strong></td><td><code>navigator.webdriver</code>ã€CDP ç—•è¿¹æ£€æµ‹</td><td>ğŸ”´ é«˜</td></tr><tr><td><strong>è´¦å·å…³è”</strong></td><td>é€šè¿‡æŒ‡çº¹è¯†åˆ«åŒä¸€è®¾å¤‡ä¸Šçš„å¤šä¸ªè´¦å·</td><td>ğŸ”´ é«˜</td></tr><tr><td><strong>ä¼šè¯æ±¡æŸ“</strong></td><td>å¤šè´¦å·å…±äº« Cookie/LocalStorage</td><td>ğŸŸ¡ ä¸­</td></tr></tbody></table>
<h3 data-id="heading-2">ğŸ’¡ ä¸šåŠ¡ç—›ç‚¹</h3>
<pre><code class="hljs language-markdown" lang="markdown">åŒä¸€å°ç”µè„‘ + å¤šä¸ªè´¦å· = è´¦å·å…³è”é£é™©
<span class="hljs-code">         â†“
ç½‘ç«™æ£€æµ‹åˆ°ç›¸åŒæŒ‡çº¹
         â†“
è´¦å·è¢«å°ç¦/é™åˆ¶
</span></code></pre>
<p>æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼š<strong>åœ¨åŒä¸€å°ç”µè„‘ä¸Šè¿è¡Œå¤šä¸ªå…·æœ‰å®Œå…¨ç‹¬ç«‹æŒ‡çº¹çš„æµè§ˆå™¨å®ä¾‹</strong>ï¼Œæ¯ä¸ªå®ä¾‹çœ‹èµ·æ¥å°±åƒæ¥è‡ªä¸åŒçš„è®¾å¤‡ã€‚</p>
<hr/>
<h2 data-id="heading-3">æŠ€æœ¯é€‰å‹ï¼šä¸ºä»€ä¹ˆé€‰æ‹©å®šåˆ¶ Chromium</h2>
<h3 data-id="heading-4">æ–¹æ¡ˆå¯¹æ¯”</h3>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>ç»“è®º</th></tr></thead><tbody><tr><td><strong>Puppeteer Stealth</strong></td><td>æ˜“é›†æˆã€è½»é‡</td><td>æŒ‡çº¹ä¿®æ”¹æœ‰é™ã€æ˜“è¢«æ£€æµ‹</td><td>âŒ ä¸å¤Ÿå½»åº•</td></tr><tr><td><strong>Playwright</strong></td><td>è·¨æµè§ˆå™¨ã€åŠŸèƒ½ä¸°å¯Œ</td><td>æ— åŸç”ŸæŒ‡çº¹ä¿®æ”¹èƒ½åŠ›</td><td>âŒ èƒ½åŠ›ä¸è¶³</td></tr><tr><td><strong>fingerprint-chromium</strong></td><td>æ·±åº¦æŒ‡çº¹ä¿®æ”¹ã€å¼€æºå…è´¹</td><td>éœ€å®šåˆ¶æµè§ˆå™¨</td><td>âœ… æœ€ä½³é€‰æ‹©</td></tr><tr><td><strong>å•†ä¸šæŒ‡çº¹æµè§ˆå™¨</strong></td><td>åŠŸèƒ½å®Œå–„</td><td>æˆæœ¬é«˜ã€ä¾èµ–ç¬¬ä¸‰æ–¹</td><td>âŒ æˆæœ¬è€ƒé‡</td></tr></tbody></table>
<h3 data-id="heading-5">é€‰æ‹© fingerprint-chromium çš„ç†ç”±</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fadryfish%2Ffingerprint-chromium" target="_blank" title="https://github.com/adryfish/fingerprint-chromium" ref="nofollow noopener noreferrer">fingerprint-chromium</a> æ˜¯åŸºäº Ungoogled Chromium çš„å®šåˆ¶ç‰ˆæœ¬ï¼Œå®ƒåœ¨æµè§ˆå™¨åº•å±‚å®ç°äº†æŒ‡çº¹ä¿®æ”¹èƒ½åŠ›ï¼š</p>
<ol>
<li><strong>Canvas/WebGL/éŸ³é¢‘æŒ‡çº¹è‡ªåŠ¨ä¿®æ”¹</strong> - æ— éœ€ JavaScript æ³¨å…¥</li>
<li><strong>navigator.webdriver è‡ªåŠ¨éšè—</strong> - å†…ç½®åè‡ªåŠ¨åŒ–æ£€æµ‹</li>
<li><strong>CDP æ£€æµ‹è§„é¿</strong> - è°ƒç”¨ <code>Runtime.enable</code> ä¸è§¦å‘æ£€æµ‹</li>
<li><strong>é€šè¿‡å‘½ä»¤è¡Œå‚æ•°é…ç½®</strong> - çµæ´»çš„æŒ‡çº¹å®šåˆ¶èƒ½åŠ›</li>
</ol>
<hr/>
<h2 data-id="heading-6">ç³»ç»Ÿæ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-7">æ•´ä½“æ¶æ„</h3>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           RPA å·¥ä½œæµå¼•æ“                               â”‚
â”‚                    ï¼ˆä»»åŠ¡è°ƒåº¦ã€æ­¥éª¤æ‰§è¡Œã€çŠ¶æ€ç®¡ç†ï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          BrowserManager                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ æµè§ˆå™¨å®ä¾‹ç”Ÿå‘½å‘¨æœŸç®¡ç†                                          â”‚  â”‚
â”‚  â”‚  â€¢ å¤šå®ä¾‹åè°ƒä¸èµ„æºæ§åˆ¶                                            â”‚  â”‚
â”‚  â”‚  â€¢ Storage State æŒä¹…åŒ–ï¼ˆç™»å½•çŠ¶æ€ä¿å­˜ï¼‰                            â”‚  â”‚
â”‚  â”‚  â€¢ æŒ‡çº¹é…ç½®è§£æä¸è¦†ç›–                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LocalFingerprintService                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ æŒ‡çº¹ç”Ÿæˆï¼ˆåŸºäºç§å­çš„ç¡®å®šæ€§ç®—æ³•ï¼‰                                  â”‚  â”‚
â”‚  â”‚  â€¢ Chromium è¿›ç¨‹ç®¡ç†                                             â”‚  â”‚
â”‚  â”‚  â€¢ CDP è¿æ¥ç®¡ç†                                                  â”‚  â”‚
â”‚  â”‚  â€¢ ç«¯å£åŠ¨æ€åˆ†é…                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Fingerprint Chromium (å®šåˆ¶æµè§ˆå™¨)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ¥æ”¶æŒ‡çº¹é…ç½®                                      â”‚  â”‚
â”‚  â”‚  â€¢ <span class="hljs-selector-tag">Canvas</span>/WebGL/éŸ³é¢‘æŒ‡çº¹è‡ªåŠ¨ä¿®æ”¹                                  â”‚  â”‚
â”‚  â”‚  â€¢ navigator<span class="hljs-selector-class">.webdriver</span> éšè—                                     â”‚  â”‚
â”‚  â”‚  â€¢ CDP æ£€æµ‹è§„é¿                                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-8">æ ¸å¿ƒæ¨¡å—èŒè´£</h3>

























<table><thead><tr><th>æ¨¡å—</th><th>èŒè´£</th><th>å…³é”®èƒ½åŠ›</th></tr></thead><tbody><tr><td><strong>BrowserManager</strong></td><td>é«˜å±‚å°è£…</td><td>ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€é…ç½®è§£æã€ä¼šè¯æŒä¹…åŒ–</td></tr><tr><td><strong>LocalFingerprintService</strong></td><td>æ ¸å¿ƒå®ç°</td><td>æŒ‡çº¹ç”Ÿæˆã€è¿›ç¨‹ç®¡ç†ã€ç«¯å£åˆ†é…</td></tr><tr><td><strong>FingerprintConfigValidator</strong></td><td>é…ç½®éªŒè¯</td><td>å‚æ•°æ ¡éªŒã€GPU/å¹³å°åŒ¹é…ã€ç‰ˆæœ¬è¿ç§»</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-9">æ ¸å¿ƒå®ç°è¯¦è§£</h2>
<h3 data-id="heading-10">1. æŒ‡çº¹ç§å­æœºåˆ¶</h3>
<p>æˆ‘ä»¬ä½¿ç”¨<strong>ç§å­ï¼ˆSeedï¼‰æœºåˆ¶</strong>ç¡®ä¿æŒ‡çº¹çš„ç¡®å®šæ€§å’Œä¸€è‡´æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸºäº profileId ç”Ÿæˆç¡®å®šæ€§ç§å­</span>
<span class="hljs-keyword">const</span> fingerprintSeed = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(<span class="hljs-title function_">hashCode</span>(profileId)) % <span class="hljs-number">2147483647</span>

<span class="hljs-comment">// ä½¿ç”¨ç§å­ç¡®å®šæ€§é€‰æ‹©å„é¡¹é…ç½®</span>
<span class="hljs-keyword">const</span> fingerprint = {
  <span class="hljs-attr">userAgent</span>: userAgents[fingerprintSeed % userAgents.<span class="hljs-property">length</span>],
  <span class="hljs-attr">viewport</span>: viewports[fingerprintSeed % viewports.<span class="hljs-property">length</span>],
  <span class="hljs-attr">language</span>: languages[fingerprintSeed % languages.<span class="hljs-property">length</span>],
  <span class="hljs-attr">timezone</span>: timezones[fingerprintSeed % timezones.<span class="hljs-property">length</span>],
  <span class="hljs-attr">gpu</span>: gpuConfigs[fingerprintSeed % gpuConfigs.<span class="hljs-property">length</span>],
  <span class="hljs-attr">cores</span>: coreOptions[fingerprintSeed % coreOptions.<span class="hljs-property">length</span>]
}
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… ç›¸åŒ profileId å§‹ç»ˆç”Ÿæˆç›¸åŒæŒ‡çº¹</li>
<li>âœ… æ”¯æŒè‡ªå®šä¹‰ç§å­å®ç°è·¨è®¾å¤‡ä¸€è‡´æ€§</li>
<li>âœ… å¯é€šè¿‡é…ç½®è¦†ç›–ä»»æ„æŒ‡çº¹é¡¹</li>
</ul>
<h3 data-id="heading-11">2. æŒ‡çº¹è¦†ç›–æœºåˆ¶</h3>
<p>ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®è¦†ç›–è‡ªåŠ¨ç”Ÿæˆçš„ä»»æ„æŒ‡çº¹é¡¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// BrowserManager._extractFingerprintOverrides()</span>
<span class="hljs-title function_">_extractFingerprintOverrides</span>(<span class="hljs-params">rawConfig</span>) {
  <span class="hljs-keyword">const</span> cfg = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_normalizeFingerprintConfig</span>(rawConfig)
  <span class="hljs-keyword">const</span> overrides = { <span class="hljs-attr">rawConfig</span>: cfg }

  <span class="hljs-comment">// User Agent é…ç½®</span>
  <span class="hljs-keyword">if</span> (cfg.<span class="hljs-property">uaMode</span> === <span class="hljs-string">'custom'</span> &amp;&amp; cfg.<span class="hljs-property">userAgent</span>?.<span class="hljs-title function_">trim</span>()) {
    overrides.<span class="hljs-property">userAgent</span> = cfg.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">trim</span>()
  }

  <span class="hljs-comment">// è¯­è¨€é…ç½®ï¼ˆéè‡ªåŠ¨æ¨¡å¼æ—¶ç”Ÿæ•ˆï¼‰</span>
  <span class="hljs-keyword">if</span> (cfg.<span class="hljs-property">languageAuto</span> === <span class="hljs-literal">false</span> &amp;&amp; cfg.<span class="hljs-property">language</span>?.<span class="hljs-title function_">trim</span>()) {
    overrides.<span class="hljs-property">language</span> = cfg.<span class="hljs-property">language</span>.<span class="hljs-title function_">trim</span>()
  }

  <span class="hljs-comment">// æ—¶åŒºé…ç½®</span>
  <span class="hljs-keyword">if</span> (cfg.<span class="hljs-property">timezoneAuto</span> === <span class="hljs-literal">false</span> &amp;&amp; cfg.<span class="hljs-property">timezone</span>?.<span class="hljs-title function_">trim</span>()) {
    overrides.<span class="hljs-property">timezone</span> = cfg.<span class="hljs-property">timezone</span>.<span class="hljs-title function_">trim</span>()
  }

  <span class="hljs-comment">// GPU é…ç½®è¦†ç›–</span>
  <span class="hljs-keyword">if</span> (cfg.<span class="hljs-property">gpuVendor</span> || cfg.<span class="hljs-property">gpuRenderer</span>) {
    overrides.<span class="hljs-property">gpuVendor</span> = cfg.<span class="hljs-property">gpuVendor</span>
    overrides.<span class="hljs-property">gpuRenderer</span> = cfg.<span class="hljs-property">gpuRenderer</span>
  }

  <span class="hljs-comment">// CPU æ ¸å¿ƒæ•°è¦†ç›–</span>
  <span class="hljs-keyword">if</span> (cfg.<span class="hljs-property">hardwareConcurrency</span> &gt; <span class="hljs-number">0</span>) {
    overrides.<span class="hljs-property">hardwareConcurrency</span> = cfg.<span class="hljs-property">hardwareConcurrency</span>
  }

  <span class="hljs-keyword">return</span> overrides
}
</code></pre>
<h3 data-id="heading-12">3. åŠ¨æ€ User-Agent ç”Ÿæˆ</h3>
<p>æ ¹æ®å¹³å°ã€å“ç‰Œã€ç‰ˆæœ¬åŠ¨æ€ç”Ÿæˆä¸€è‡´çš„ User-Agentï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// LocalFingerprintService._generateUserAgent()</span>
<span class="hljs-title function_">_generateUserAgent</span>(<span class="hljs-params">platform, brand, brandVersion, platformVersion</span>) {
  <span class="hljs-comment">// Windows NT ç‰ˆæœ¬æ˜ å°„</span>
  <span class="hljs-keyword">const</span> ntVersion = <span class="hljs-variable constant_">WINDOWS_NT_VERSION_MAP</span>[platformVersion] || <span class="hljs-string">'10.0'</span>

  <span class="hljs-comment">// åŸºç¡€ UA æ¨¡æ¿</span>
  <span class="hljs-keyword">let</span> ua
  <span class="hljs-keyword">if</span> (platform === <span class="hljs-string">'windows'</span>) {
    ua = <span class="hljs-string">`Mozilla/5.0 (Windows NT <span class="hljs-subst">${ntVersion}</span>; Win64; x64) `</span> +
         <span class="hljs-string">`AppleWebKit/537.36 (KHTML, like Gecko) `</span> +
         <span class="hljs-string">`Chrome/<span class="hljs-subst">${brandVersion}</span> Safari/537.36`</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (platform === <span class="hljs-string">'macos'</span>) {
    ua = <span class="hljs-string">`Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) `</span> +
         <span class="hljs-string">`AppleWebKit/537.36 (KHTML, like Gecko) `</span> +
         <span class="hljs-string">`Chrome/<span class="hljs-subst">${brandVersion}</span> Safari/537.36`</span>
  }

  <span class="hljs-comment">// æ·»åŠ å“ç‰Œåç¼€</span>
  <span class="hljs-keyword">if</span> (brand === <span class="hljs-string">'Edge'</span>) {
    ua += <span class="hljs-string">` Edg/<span class="hljs-subst">${brandVersion}</span>`</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (brand === <span class="hljs-string">'Opera'</span>) {
    ua += <span class="hljs-string">` OPR/<span class="hljs-subst">${brandVersion}</span>`</span>
  }

  <span class="hljs-keyword">return</span> ua
}
</code></pre>
<h3 data-id="heading-13">4. å‘½ä»¤è¡Œå‚æ•°æ„å»º</h3>
<p>æœ€ç»ˆç”Ÿæˆçš„æŒ‡çº¹é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ Chromiumï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// LocalFingerprintService.launch()</span>
<span class="hljs-keyword">const</span> chromiumArgs = [
  <span class="hljs-comment">// è°ƒè¯•ç«¯å£</span>
  <span class="hljs-string">`--remote-debugging-port=<span class="hljs-subst">${debuggingPort}</span>`</span>,

  <span class="hljs-comment">// ç”¨æˆ·æ•°æ®ç›®å½•ï¼ˆå®ç°ä¼šè¯éš”ç¦»ï¼‰</span>
  <span class="hljs-string">`--user-data-dir=<span class="hljs-subst">${userDataDir}</span>`</span>,

  <span class="hljs-comment">// æŒ‡çº¹æ ¸å¿ƒå‚æ•°</span>
  <span class="hljs-string">`--fingerprint=<span class="hljs-subst">${fingerprintSeed}</span>`</span>,
  <span class="hljs-string">`--fingerprint-platform=<span class="hljs-subst">${platform}</span>`</span>,
  <span class="hljs-string">`--fingerprint-platform-version=<span class="hljs-subst">${platformVersion}</span>`</span>,
  <span class="hljs-string">`--fingerprint-brand=<span class="hljs-subst">${brand}</span>`</span>,
  <span class="hljs-string">`--fingerprint-brand-version=<span class="hljs-subst">${brandVersion}</span>`</span>,
  <span class="hljs-string">`--fingerprint-hardware-concurrency=<span class="hljs-subst">${cores}</span>`</span>,
  <span class="hljs-string">`--fingerprint-gpu-vendor=<span class="hljs-subst">${gpuVendor}</span>`</span>,
  <span class="hljs-string">`--fingerprint-gpu-renderer=<span class="hljs-subst">${gpuRenderer}</span>`</span>,

  <span class="hljs-comment">// åŸºæœ¬è®¾ç½®</span>
  <span class="hljs-string">`--lang=<span class="hljs-subst">${language}</span>`</span>,
  <span class="hljs-string">`--accept-lang=<span class="hljs-subst">${acceptLanguage}</span>`</span>,
  <span class="hljs-string">`--timezone=<span class="hljs-subst">${timezone}</span>`</span>,
  <span class="hljs-string">`--user-agent=<span class="hljs-subst">${userAgent}</span>`</span>,

  <span class="hljs-comment">// çª—å£è®¾ç½®</span>
  <span class="hljs-string">`--window-size=<span class="hljs-subst">${viewport.width}</span>,<span class="hljs-subst">${viewport.height}</span>`</span>,

  <span class="hljs-comment">// ä»£ç†è®¾ç½®ï¼ˆå¯é€‰ï¼‰</span>
  ...(proxyServer ? [<span class="hljs-string">`--proxy-server=<span class="hljs-subst">${proxyServer}</span>`</span>] : [])
]
</code></pre>
<hr/>
<h2 data-id="heading-14">æŒ‡çº¹é…ç½®èƒ½åŠ›çŸ©é˜µ</h2>
<h3 data-id="heading-15">å¯é…ç½®çš„æŒ‡çº¹ç±»å‹</h3>



















































































<table><thead><tr><th>æŒ‡çº¹ç±»å‹</th><th>å‘½ä»¤è¡Œå‚æ•°</th><th>é…ç½®æ–¹å¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æŒ‡çº¹ç§å­</strong></td><td><code>--fingerprint</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>æ ¸å¿ƒå‚æ•°ï¼Œå¯ç”¨åå¤§éƒ¨åˆ†æŒ‡çº¹åŠŸèƒ½ç”Ÿæ•ˆ</td></tr><tr><td><strong>User Agent</strong></td><td><code>--user-agent</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>ä¿®æ”¹ navigator.userAgent åŠç›¸å…³ API</td></tr><tr><td><strong>æ“ä½œç³»ç»Ÿ</strong></td><td><code>--fingerprint-platform</code></td><td>æ‰‹åŠ¨</td><td>windows / linux / macos</td></tr><tr><td><strong>å¹³å°ç‰ˆæœ¬</strong></td><td><code>--fingerprint-platform-version</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>å¦‚ 10.0 (Win10)ã€14.0 (macOS 14)</td></tr><tr><td><strong>æµè§ˆå™¨å“ç‰Œ</strong></td><td><code>--fingerprint-brand</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>Chrome / Edge / Opera / Vivaldi / Brave</td></tr><tr><td><strong>æµè§ˆå™¨ç‰ˆæœ¬</strong></td><td><code>--fingerprint-brand-version</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>å¦‚ 139.0.0.0</td></tr><tr><td><strong>CPUæ ¸å¿ƒæ•°</strong></td><td><code>--fingerprint-hardware-concurrency</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>2 / 4 / 6 / 8 / 12 / 16</td></tr><tr><td><strong>GPUå‚å•†</strong></td><td><code>--fingerprint-gpu-vendor</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>NVIDIA / AMD / Intel / Apple</td></tr><tr><td><strong>GPUæ¸²æŸ“å™¨</strong></td><td><code>--fingerprint-gpu-renderer</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>å…·ä½“ GPU å‹å·</td></tr><tr><td><strong>è¯­è¨€</strong></td><td><code>--lang</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>zh-CN / en-US ç­‰</td></tr><tr><td><strong>æ—¶åŒº</strong></td><td><code>--timezone</code></td><td>è‡ªåŠ¨/æ‰‹åŠ¨</td><td>Asia/Shanghai ç­‰</td></tr><tr><td><strong>ä»£ç†æœåŠ¡å™¨</strong></td><td><code>--proxy-server</code></td><td>æ‰‹åŠ¨</td><td>æ”¯æŒ HTTP/SOCKS5 åè®®</td></tr></tbody></table>
<h3 data-id="heading-16">è‡ªåŠ¨å¤„ç†çš„æŒ‡çº¹</h3>
<p>ä»¥ä¸‹æŒ‡çº¹ç”± fingerprint-chromium è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€é…ç½®ï¼š</p>

































<table><thead><tr><th>æŒ‡çº¹ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Canvas å›¾åƒ</strong></td><td>è‡ªåŠ¨ä¿®æ”¹ Canvas 2D æ¸²æŸ“è¾“å‡º</td></tr><tr><td><strong>WebGL å›¾åƒ</strong></td><td>è‡ªåŠ¨ä¿®æ”¹ WebGL æ¸²æŸ“è¾“å‡º</td></tr><tr><td><strong>éŸ³é¢‘æŒ‡çº¹</strong></td><td>è‡ªåŠ¨ä¿®æ”¹ AudioContext è¾“å‡º</td></tr><tr><td><strong>å­—ä½“æŒ‡çº¹</strong></td><td>ä¿®æ”¹ç³»ç»Ÿå­—ä½“åˆ—è¡¨</td></tr><tr><td><strong>ClientRects</strong></td><td>ä¿®æ”¹å…ƒç´ è¾¹ç•ŒçŸ©å½¢</td></tr><tr><td><strong>WebRTC</strong></td><td>ä¿®æ”¹ WebRTC ç›¸å…³æŒ‡çº¹</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-17">å®æˆ˜ï¼šä»é…ç½®åˆ°å¯åŠ¨çš„å®Œæ•´æµç¨‹</h2>
<h3 data-id="heading-18">æµç¨‹å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯é…ç½®é¡µ   â”‚â”€â”€â”€&gt;â”‚ BrowserManager  â”‚â”€â”€â”€&gt;â”‚ LocalFingerprint  â”‚
â”‚  (Vue ç»„ä»¶)  â”‚    â”‚  <span class="hljs-selector-class">.openBrowser</span>() â”‚    â”‚   Service<span class="hljs-selector-class">.launch</span>()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                       â”‚
                           â–¼                       â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ è§£ææŒ‡çº¹é…ç½®      â”‚    â”‚ ç”ŸæˆæŒ‡çº¹å‚æ•°        â”‚
                  â”‚ æå–è¦†ç›–å€¼        â”‚    â”‚ æ„å»ºå‘½ä»¤è¡Œå‚æ•°      â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                       â”‚
                           â–¼                       â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ åŠ è½½ StorageStateâ”‚   â”‚ å¯åŠ¨ Chromium è¿›ç¨‹  â”‚
                  â”‚ (æ¢å¤ç™»å½•çŠ¶æ€)    â”‚    â”‚ ç­‰å¾…ç«¯å£å°±ç»ª        â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                       â”‚
                           â–¼                       â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚     CDP è¿æ¥å»ºç«‹ï¼Œè¿”å› page å¯¹è±¡           â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-19">ä»£ç ç¤ºä¾‹ï¼šæ‰“å¼€æµè§ˆå™¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. è°ƒç”¨ BrowserManager æ‰“å¼€æµè§ˆå™¨</span>
<span class="hljs-keyword">const</span> { browser, context, page } = <span class="hljs-keyword">await</span> browserManager.<span class="hljs-title function_">openBrowser</span>({
  <span class="hljs-attr">profileId</span>: <span class="hljs-string">'profile-1'</span>,
  <span class="hljs-attr">fingerprintConfig</span>: {
    <span class="hljs-attr">os</span>: <span class="hljs-string">'win10'</span>,
    <span class="hljs-attr">uaMode</span>: <span class="hljs-string">'auto'</span>,
    <span class="hljs-attr">languageAuto</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">'en-US'</span>,
    <span class="hljs-attr">gpuAuto</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">gpuVendor</span>: <span class="hljs-string">'NVIDIA Corporation'</span>,
    <span class="hljs-attr">gpuRenderer</span>: <span class="hljs-string">'NVIDIA GeForce RTX 3060'</span>
  }
})

<span class="hljs-comment">// 2. ä½¿ç”¨é¡µé¢</span>
<span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">'https://example.com'</span>)

<span class="hljs-comment">// 3. ä¿å­˜ç™»å½•çŠ¶æ€ï¼ˆå¯é€‰ï¼‰</span>
<span class="hljs-keyword">await</span> browserManager.<span class="hljs-title function_">saveStorageState</span>(<span class="hljs-string">'profile-1'</span>, browserId)

<span class="hljs-comment">// 4. å…³é—­æµè§ˆå™¨</span>
<span class="hljs-keyword">await</span> browserManager.<span class="hljs-title function_">closeBrowser</span>(browserId)
</code></pre>
<hr/>
<h2 data-id="heading-20">è¸©å‘è®°å½•ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-21">è¸©å‘ 1ï¼šå¹³å°è¦†ç›–ä¸ç”Ÿæ•ˆ</h3>
<p><strong>é—®é¢˜</strong>ï¼šé…ç½® <code>os: "win8"</code> åï¼Œæµè§ˆå™¨ä»ä½¿ç”¨æœ¬æœºå¹³å° (macOS)ã€‚</p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š</p>
<ul>
<li><code>BrowserManager</code> æœªæ­£ç¡®æå– <code>platform</code> å­—æ®µ</li>
<li><code>LocalFingerprintService</code> åªä½¿ç”¨äº† <code>process.platform</code></li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ·»åŠ  os åˆ° platform çš„æ˜ å°„</span>
<span class="hljs-title function_">_mapPlatform</span>(<span class="hljs-params">osCode</span>) {
  <span class="hljs-keyword">const</span> mapping = {
    <span class="hljs-attr">win7</span>: <span class="hljs-string">'windows'</span>, <span class="hljs-attr">win8</span>: <span class="hljs-string">'windows'</span>, <span class="hljs-attr">win10</span>: <span class="hljs-string">'windows'</span>, <span class="hljs-attr">win11</span>: <span class="hljs-string">'windows'</span>,
    <span class="hljs-attr">mac13</span>: <span class="hljs-string">'macos'</span>, <span class="hljs-attr">mac14</span>: <span class="hljs-string">'macos'</span>, <span class="hljs-attr">mac15</span>: <span class="hljs-string">'macos'</span>,
    <span class="hljs-attr">linux</span>: <span class="hljs-string">'linux'</span>
  }
  <span class="hljs-keyword">return</span> mapping[osCode] || process.<span class="hljs-property">platform</span>
}

<span class="hljs-comment">// ä¿®æ”¹ launch() ä¸­è°ƒç”¨é¡ºåºï¼Œå…ˆè®¡ç®— targetPlatform</span>
<span class="hljs-keyword">const</span> targetPlatform = fingerprintOverrides?.<span class="hljs-property">platform</span> ||
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_mapPlatform</span>(fingerprintOverrides?.<span class="hljs-property">rawConfig</span>?.<span class="hljs-property">os</span>)
</code></pre>
<h3 data-id="heading-22">è¸©å‘ 2ï¼šUser-Agent ä¸å“ç‰Œä¸ä¸€è‡´</h3>
<p><strong>é—®é¢˜</strong>ï¼šé…ç½® Edge å“ç‰Œæ—¶ï¼ŒUser-Agent ä»ä¸º Chrome æ ¼å¼ã€‚</p>
<p><strong>åŸå› </strong>ï¼š<code>generateFingerprint()</code> ä½¿ç”¨é™æ€ User-Agent åˆ—è¡¨ï¼Œä¸è€ƒè™‘å“ç‰Œé…ç½®ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ–°å¢ <code>_generateUserAgent()</code> æ–¹æ³•ï¼Œæ ¹æ®å¹³å°ã€å“ç‰Œã€ç‰ˆæœ¬åŠ¨æ€ç”Ÿæˆã€‚</p>
<h3 data-id="heading-23">è¸©å‘ 3ï¼šGPU ä¸å¹³å°ä¸åŒ¹é…</h3>
<p><strong>é—®é¢˜</strong>ï¼šç”¨æˆ·å¯èƒ½é…ç½®ä¸åŒ¹é…çš„ GPUï¼ˆå¦‚ Windows å¹³å°é…ç½® Apple GPUï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå®ç° GPU/å¹³å°è‡ªåŠ¨ä¿®å¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// fingerprintConfigValidator.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">autoFixGpuPlatformMismatch</span>(<span class="hljs-params">config</span>) {
  <span class="hljs-keyword">const</span> platform = <span class="hljs-title function_">mapOsToPlatform</span>(config.<span class="hljs-property">os</span>)
  <span class="hljs-keyword">const</span> compatibility = <span class="hljs-variable constant_">GPU_PLATFORM_COMPATIBILITY</span>[platform]

  <span class="hljs-comment">// æ£€æŸ¥ GPU å‚å•†æ˜¯å¦ä¸å¹³å°å…¼å®¹</span>
  <span class="hljs-keyword">if</span> (!compatibility.<span class="hljs-property">vendors</span>.<span class="hljs-title function_">includes</span>(config.<span class="hljs-property">gpuVendor</span>)) {
    <span class="hljs-keyword">return</span> {
      ...config,
      <span class="hljs-attr">gpuVendor</span>: compatibility.<span class="hljs-property">defaultGpu</span>.<span class="hljs-property">vendor</span>,
      <span class="hljs-attr">gpuRenderer</span>: compatibility.<span class="hljs-property">defaultGpu</span>.<span class="hljs-property">renderer</span>,
      <span class="hljs-attr">_autoFixed</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">_fixReason</span>: <span class="hljs-string">`GPU å‚å•† "<span class="hljs-subst">${config.gpuVendor}</span>" ä¸ <span class="hljs-subst">${platform}</span> å¹³å°ä¸åŒ¹é…`</span>
    }
  }

  <span class="hljs-keyword">return</span> config
}
</code></pre>
<h3 data-id="heading-24">è¸©å‘ 4ï¼šä»£ç†è®¤è¯é—®é¢˜</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¸¦ç”¨æˆ·åå¯†ç çš„ä»£ç† URL æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå®ç°ä»£ç† URL è§£æå’Œè®¤è¯å¤„ç†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// proxyAuthHelper.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseProxyUrl</span>(<span class="hljs-params">proxyUrl</span>) {
  <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(proxyUrl)
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">server</span>: <span class="hljs-string">`<span class="hljs-subst">${url.protocol}</span>//<span class="hljs-subst">${url.host}</span>`</span>,
    <span class="hljs-attr">protocol</span>: url.<span class="hljs-property">protocol</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">':'</span>, <span class="hljs-string">''</span>),
    <span class="hljs-attr">host</span>: url.<span class="hljs-property">hostname</span>,
    <span class="hljs-attr">port</span>: url.<span class="hljs-property">port</span>,
    <span class="hljs-attr">username</span>: <span class="hljs-built_in">decodeURIComponent</span>(url.<span class="hljs-property">username</span>),
    <span class="hljs-attr">password</span>: <span class="hljs-built_in">decodeURIComponent</span>(url.<span class="hljs-property">password</span>)
  }
}

<span class="hljs-comment">// ä½¿ç”¨ CDP è®¾ç½®ä»£ç†è®¤è¯</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setupProxyAuth</span>(<span class="hljs-params">context, proxyConfig</span>) {
  <span class="hljs-keyword">if</span> (proxyConfig.<span class="hljs-property">username</span> &amp;&amp; proxyConfig.<span class="hljs-property">password</span>) {
    <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">route</span>(<span class="hljs-string">'**/*'</span>, <span class="hljs-keyword">async</span> (route) =&gt; {
      <span class="hljs-keyword">await</span> route.<span class="hljs-title function_">continue</span>({
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Proxy-Authorization'</span>: <span class="hljs-string">`Basic <span class="hljs-subst">${btoa(
            <span class="hljs-string">`<span class="hljs-subst">${proxyConfig.username}</span>:<span class="hljs-subst">${proxyConfig.password}</span>`</span>
          )}</span>`</span>
        }
      })
    })
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-25">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-26">1. ä½å†…å­˜æ¨¡å¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOW_MEMORY_CONFIG</span> = {
  <span class="hljs-attr">lowMemoryMode</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">mediaCacheSizeMB</span>: <span class="hljs-number">128</span>,
  <span class="hljs-attr">mediaCacheDiskSizeMB</span>: <span class="hljs-number">512</span>,
  <span class="hljs-attr">enableVideoOptimizations</span>: <span class="hljs-literal">false</span>
}

<span class="hljs-comment">// ç¦ç”¨é‡é‡çº§è§†é¢‘ç®¡é“æ ‡å¿—</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">HEAVY_VIDEO_PIPELINE_FLAGS</span> = [
  <span class="hljs-string">'--enable-av1-decoder'</span>,
  <span class="hljs-string">'--enable-video-decoding-multiple-threads'</span>,
  <span class="hljs-string">'--enable-features=VaapiVideoDecoder,PlatformVideoDecoder'</span>
]
</code></pre>
<h3 data-id="heading-27">2. ä¼šè¯éš”ç¦»æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¯ä¸ªå®ä¾‹ä½¿ç”¨ç‹¬ç«‹çš„ç”¨æˆ·æ•°æ®ç›®å½•</span>
<span class="hljs-keyword">const</span> userDataDir = path.<span class="hljs-title function_">join</span>(
  profilesDir,
  <span class="hljs-string">`profile-<span class="hljs-subst">${profileId}</span>-<span class="hljs-subst">${uniqueId}</span>`</span>
)

<span class="hljs-comment">// ç™»å½•æ•°æ®ç™½åå•ï¼ˆä»…æŒä¹…åŒ–å¿…è¦æ–‡ä»¶ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOGIN_WHITELIST</span> = [
  <span class="hljs-string">'Default/Cookies'</span>,
  <span class="hljs-string">'Default/Login Data'</span>,
  <span class="hljs-string">'Default/Local Storage'</span>,
  <span class="hljs-string">'Default/Session Storage'</span>
]
</code></pre>
<h3 data-id="heading-28">3. æŒ‡çº¹ä¸€è‡´æ€§æ£€æŸ¥</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¡®ä¿æŒ‡çº¹å‚æ•°ä¹‹é—´çš„ä¸€è‡´æ€§</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">validateFingerprintConsistency</span>(<span class="hljs-params">config</span>) {
  <span class="hljs-keyword">const</span> warnings = []

  <span class="hljs-comment">// Windows å¹³å°åº”ä½¿ç”¨ Windows GPU</span>
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">platform</span> === <span class="hljs-string">'windows'</span> &amp;&amp;
      config.<span class="hljs-property">gpuVendor</span> === <span class="hljs-string">'Apple Inc.'</span>) {
    warnings.<span class="hljs-title function_">push</span>(<span class="hljs-string">'Windows å¹³å°ä¸åº”ä½¿ç”¨ Apple GPU'</span>)
  }

  <span class="hljs-comment">// è¯­è¨€å’Œæ—¶åŒºåº”åœ°ç†ä½ç½®ä¸€è‡´</span>
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">language</span> === <span class="hljs-string">'zh-CN'</span> &amp;&amp;
      config.<span class="hljs-property">timezone</span> === <span class="hljs-string">'America/New_York'</span>) {
    warnings.<span class="hljs-title function_">push</span>(<span class="hljs-string">'è¯­è¨€å’Œæ—¶åŒºåœ°ç†ä½ç½®ä¸ä¸€è‡´'</span>)
  }

  <span class="hljs-keyword">return</span> { <span class="hljs-attr">valid</span>: warnings.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>, warnings }
}
</code></pre>
<h3 data-id="heading-29">4. æŒ‡çº¹éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¿«é€ŸéªŒè¯æŒ‡çº¹æ˜¯å¦ç”Ÿæ•ˆ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">quickVerify</span>(<span class="hljs-params">page</span>) {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> page.evaluate(<span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">webdriver</span>: navigator.<span class="hljs-property">webdriver</span>,
    <span class="hljs-attr">platform</span>: navigator.<span class="hljs-property">platform</span>,
    <span class="hljs-attr">userAgent</span>: navigator.<span class="hljs-property">userAgent</span>,
    <span class="hljs-attr">hardwareConcurrency</span>: navigator.<span class="hljs-property">hardwareConcurrency</span>,
    <span class="hljs-attr">languages</span>: navigator.<span class="hljs-property">languages</span>
  }))

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">passed</span>: result.<span class="hljs-property">webdriver</span> === <span class="hljs-literal">false</span>,
    <span class="hljs-attr">details</span>: result
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-30">æ€»ç»“</h2>
<h3 data-id="heading-31">æ ¸å¿ƒèƒ½åŠ›å›é¡¾</h3>
<p>é€šè¿‡æœ¬æ–‡ä»‹ç»çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬å®ç°äº†ä»¥ä¸‹èƒ½åŠ›ï¼š</p>

































<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¤šæŒ‡çº¹å®ä¾‹</strong></td><td>åŒæ—¶è¿è¡Œå¤šä¸ªå…·æœ‰ç‹¬ç«‹æŒ‡çº¹çš„æµè§ˆå™¨</td></tr><tr><td><strong>æŒ‡çº¹è‡ªå®šä¹‰</strong></td><td>æ”¯æŒè‡ªå®šä¹‰ UAã€GPUã€CPUã€æ—¶åŒºã€å¹³å°ç­‰</td></tr><tr><td><strong>ä¼šè¯éš”ç¦»</strong></td><td>æ¯ä¸ªå®ä¾‹ç‹¬ç«‹çš„ Cookie å’Œ LocalStorage</td></tr><tr><td><strong>æŒ‡çº¹ä¸€è‡´æ€§</strong></td><td>ç›¸åŒé…ç½® ID ç”Ÿæˆç›¸åŒæŒ‡çº¹</td></tr><tr><td><strong>ç™»å½•æŒä¹…åŒ–</strong></td><td>Storage State æœºåˆ¶ä¿å­˜ç™»å½•çŠ¶æ€</td></tr><tr><td><strong>é…ç½®éªŒè¯</strong></td><td>è‡ªåŠ¨éªŒè¯å’Œä¿®å¤é…ç½®é—®é¢˜</td></tr></tbody></table>
<h3 data-id="heading-32">æŠ€æœ¯è¦ç‚¹æ€»ç»“</h3>
<ol>
<li><strong>ç§å­æœºåˆ¶</strong> æ˜¯å®ç°æŒ‡çº¹ç¡®å®šæ€§å’Œä¸€è‡´æ€§çš„å…³é”®</li>
<li><strong>åˆ†å±‚æ¶æ„</strong>ï¼ˆBrowserManager â†’ LocalFingerprintService â†’ Chromiumï¼‰ä¾¿äºç»´æŠ¤å’Œæ‰©å±•</li>
<li><strong>é…ç½®è¦†ç›–æœºåˆ¶</strong> å…è®¸ç”¨æˆ·çµæ´»å®šåˆ¶ä»»æ„æŒ‡çº¹é¡¹</li>
<li><strong>GPU/å¹³å°åŒ¹é…éªŒè¯</strong> å¯ä»¥é¿å…ä¸åˆç†çš„é…ç½®ç»„åˆ</li>
<li><strong>ä»£ç†è®¤è¯å¤„ç†</strong> éœ€è¦å•ç‹¬è§£æ URL å¹¶è®¾ç½®è®¤è¯å¤´</li>
</ol>
<h3 data-id="heading-33">å»¶ä¼¸é˜…è¯»</h3>
<p>å¦‚æœä½ å¯¹æµè§ˆå™¨æŒ‡çº¹æŠ€æœ¯æ„Ÿå…´è¶£ï¼Œå¯ä»¥è¿›ä¸€æ­¥äº†è§£ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fadryfish%2Ffingerprint-chromium" target="_blank" title="https://github.com/adryfish/fingerprint-chromium" ref="nofollow noopener noreferrer">fingerprint-chromium GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fadryfish%2Ffingerprint-chromium%2Fblob%2Fmain%2FREADME-ZH.md" target="_blank" title="https://github.com/adryfish/fingerprint-chromium/blob/main/README-ZH.md" ref="nofollow noopener noreferrer">fingerprint-chromium ä¸­æ–‡æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fungoogled-software%2Fungoogled-chromium" target="_blank" title="https://github.com/ungoogled-software/ungoogled-chromium" ref="nofollow noopener noreferrer">Ungoogled Chromium</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fchromedevtools.github.io%2Fdevtools-protocol%2F" target="_blank" title="https://chromedevtools.github.io/devtools-protocol/" ref="nofollow noopener noreferrer">Chrome DevTools Protocol</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbrowserscan.net%2F" target="_blank" title="https://browserscan.net/" ref="nofollow noopener noreferrer">BrowserScan æŒ‡çº¹æ£€æµ‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fpixelscan.net%2F" target="_blank" title="https://pixelscan.net/" ref="nofollow noopener noreferrer">PixelScan æŒ‡çº¹æ£€æµ‹</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å†…å·æ—¶ä»£ï¼Œèº«ä½“æ‰æ˜¯æœ€å¤§çš„çº¢åˆ©]]></title>    <link>https://juejin.cn/post/7598480413803593770</link>    <guid>https://juejin.cn/post/7598480413803593770</guid>    <pubDate>2026-01-24T09:16:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480413803593770" data-draft-id="7598480413803577386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å†…å·æ—¶ä»£ï¼Œèº«ä½“æ‰æ˜¯æœ€å¤§çš„çº¢åˆ©"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-24T09:16:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å·«debugæ—¥è®°"/> <meta itemprop="url" content="https://juejin.cn/user/2875978145863901"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å†…å·æ—¶ä»£ï¼Œèº«ä½“æ‰æ˜¯æœ€å¤§çš„çº¢åˆ©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978145863901/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å·«debugæ—¥è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:16:34.000Z" title="Sat Jan 24 2026 09:16:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»¤äººå”å˜˜çš„çŒæ­»æ–°é—»</h2>
<p>è¿™å‡ å¤©ITåœˆå‘é…µäº†ä¸€ä»¶äº‹å¼•å‘å¤§å®¶å¹¿æ³›è®¨è®ºï¼Œç½‘å‹ä¹Ÿæ¢³ç†äº†<strong>32å²ç¨‹åºå‘˜å‘¨æœ«çŒæ­»æ—¶é—´çº¿</strong>ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œçœ‹å¾—è®©äººå”å˜˜ï¼Œå°¤å…¶æ˜¯ä»–çš„çˆ±äººè¿ç»­å‡ å¤©æ™šä¸Šå‚¬ä¿ƒä»–å›å®¶çš„æ¶ˆæ¯ï¼ŒæŠ¢æ•‘è¿‡ç¨‹ä¸­è¿˜æœ‰å·¥ä½œæ¶ˆæ¯è‰¾ç‰¹...</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c796b98ba476499b91dfc115b99ec069~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5berZGVidWfml6XorrA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851575&amp;x-signature=U38FH9hCy00OVy5ROPB6UO25A7E%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">ç¨‹åºå‘˜æ˜¯ä¸€ä»½æåº¦åŠ³ç´¯çš„èŒä¸š</h2>
<p>ç¨‹åºå‘˜çŒæ­»çš„æ–°é—»åœ¨æˆ‘ä»ä¸šåä½™å¹´æœŸé—´å¬è¿‡ä¸å°‘ï¼Œæ›¾ç»githubè¿˜æœ‰ä¸ªå¼€æºé¡¹ç›®â€”â€”<strong>996.ICUï¼Œå€¡è®®ä¼—ITä»ä¸šè€…ç»´æŠ¤è‡ªèº«åŠ³åŠ¨æƒç›Šã€‚</strong></p>
<blockquote>
<p>996.ICU æ˜¯æŒ‡ å·¥ä½œ 996ï¼Œ ç”Ÿç—… ICUâ€ ã€‚è¿™æ˜¯ä¸­å›½ç¨‹åºå‘˜ä¹‹é—´çš„ä¸€ç§è‡ªå˜²è¯´æ³•ï¼Œæ„æ€æ˜¯å¦‚æœæŒ‰ç…§ 996 çš„æ¨¡å¼å·¥ä½œï¼Œé‚£ä»¥åå°±å¾—è¿› ICU äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F996icu%2F996.ICU" target="_blank" title="https://github.com/996icu/996.ICU" ref="nofollow noopener noreferrer">github.com/996icu/996.â€¦</a></p>
</blockquote>
<p>å¤–è¡Œäººå¯èƒ½ä¼šå¾ˆè¯§å¼‚ï¼Œä¸ºä»€ä¹ˆäº’è”ç½‘å‘å±•è¿™ä¹ˆå¤šå¹´äº†ï¼Œè¿˜æ˜¯ä¼šæ—¶å¸¸ä¼šå¬åˆ°ç¨‹åºå‘˜çŒæ­»çš„æ–°é—»ï¼Œç¨‹åºå‘˜çš„å·¥ä½œå¼ºåº¦æœ‰è¿™ä¹ˆå¤§å—ï¼Ÿ</p>
<p>ä»¥æˆ‘è‡ªèº«ç»å†æ¥è°ˆè°ˆç¨‹åºå‘˜å·¥ä½œå¼ºåº¦çš„æƒ…å†µï¼Œä¸ºä»€ä¹ˆè¯´ç¨‹åºå‘˜æ˜¯ä¸€ä»½<strong>æåº¦åŠ³ç´¯</strong>çš„èŒä¸šï¼Œä½ ä»¥ä¸ºç¨‹åºå‘˜çš„å·¥ä½œå°±æ˜¯ç®€å•å†™å†™ä»£ç ï¼Œé‚£å°±æ˜¯<strong>too youngï¼Œtoo simple</strong>ã€‚ç¨‹åºå‘˜è¿™ä»½èŒä¸šè¡¨é¢çœ‹èµ·æ¥é«˜è–ªï¼Œä½†ä»ä¸šè€…åº”è¯¥çŸ¥é“è¿™ä¸è¿‡æ˜¯å¤–äººçœ‹èµ·æ¥å…‰é²œç½¢äº†ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/647358bf7cda419b9e777348a28b9db5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5berZGVidWfml6XorrA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851575&amp;x-signature=q7NMb3vsQnACVJbXUYvQyiCqaNw%3D" alt="" loading="lazy"/></p>
<ol>
<li><strong>å·¥ä½œæ—¶é—´é•¿ä¸ç´§æ€¥å“åº”</strong>ï¼š996åŠ ç­æ–‡åŒ–ã€éšæ—¶å¾…å‘½æ¨¡ç³Šå·¥ä½œå’Œç”Ÿæ´»çš„è¾¹ç•Œã€‚</li>
<li><strong>é«˜å¼ºåº¦è„‘åŠ›æ¶ˆè€—ä¸å‹åŠ›</strong>ï¼šè®¤çŸ¥å¯†é›†å‹å·¥ä½œï¼Œå¤šä»»åŠ¡é¢‘ç¹æ‰“æ–­ï¼ˆæ¯”å¦‚ï¼šå¤§éƒ¨åˆ†æ—¶é—´æµªè´¹åœ¨æ— æ„ä¹‰ä¼šè®®å’Œæ²Ÿé€šå¯¹é½ï¼‰</li>
<li><strong>æŠ€æœ¯ä¸çŸ¥è¯†çš„å¿«é€Ÿè¿­ä»£</strong>ï¼šæŠ€æœ¯æ ˆã€æ¡†æ¶ã€å·¥å…·æ›´æ–°æå¿«ï¼Œä¸ºäº†ä¿æŒâ€œç«äº‰åŠ›â€ï¼Œéœ€è¦æŒç»­å­¦ä¹ æ–°çŸ¥è¯†ï¼Œæ— å½¢ä¸­åŠ å‰§äº†æŠ€æœ¯ç„¦è™‘ã€‚</li>
<li><strong>å·¥ä½œæµç¨‹ä¸ç®¡ç†é—®é¢˜</strong>ï¼šâ€œè‰å°ç­å­â€é€ æˆçš„<strong>éœ€æ±‚è¾¹ç•Œä¸æ¸…</strong>ï¼Œç®¡ç†å±‚ä¸Šä¼ ä¸‹è¾¾çš„ä¸€å‘³**â€œæ±‚å¿«â€æ–‡åŒ–**ï¼Œé€ æˆåæœŸç»´æŠ¤å‹åŠ›å’Œé£é™©ã€‚å¤§é‡æ— æ•ˆåŠ³åŠ¨å’Œè¿”å·¥ï¼Œé™·å…¥â€œ<strong>å¿™ã€ä¹±ã€ç´¯</strong>â€æ¶æ€§å¾ªç¯ã€‚</li>
<li><strong>ä¹…åä¸å¥åº·é£é™©</strong>ï¼šé•¿æ—¶é—´é¢å¯¹ç”µè„‘ï¼Œä¿æŒå›ºå®šå§¿åŠ¿ï¼Œå¯¼è‡´é¢ˆæ¤ã€è…°æ¤å’Œè§†åŠ›é—®é¢˜ï¼›ä¸è‰¯ä½œæ¯å’Œç¼ºå°‘è¿åŠ¨ä¹ æƒ¯å¼•å‘äºšå¥åº·é—®é¢˜ï¼ˆè„‚è‚ªè‚ã€ä¸‰é«˜ç­‰ï¼‰ã€‚</li>
</ol>
<p>çŒæ­»è·ŸèŒä¸šä¸ä¸€å®šæœ‰å¼ºå…³è”å…³ç³»ï¼Œå·¥ä½œæ›¾æœ‰ä¸€æ®µæ—¶é—´é«˜å¼ºåº¦å·¥ä½œï¼Œç¡çœ æ—¶é•¿å’Œè´¨é‡ä¸è¶³ï¼Œå¿ƒè„å°±ä¼šå—ä¸äº†ï¼Œåé¢æˆ‘å°±æ”¾å¼ƒäº†æ— è°“çš„å·ã€‚æŒ‰å…»ç”Ÿçš„è§’åº¦æ¥çœ‹ï¼Œé•¿æœŸæŸè€—ï¼Œç²¾æ°”ç¥å°±ä¼šä¸è¶³ï¼Œæˆ‘æ²¡è§åˆ°è¿‡æœ‰å“ªä¸ªäººä¸€ç›´éƒ½æ˜¯ç²¾åŠ›å……æ²›çš„ï¼Œå¦‚æœæœ‰ä¸€å®šæ˜¯ä»–/å¥¹æœ‰è‰¯å¥½çš„ä½œæ¯ä¹ æƒ¯ï¼ŒåšæŒè¿åŠ¨å’Œå…»ç”Ÿã€‚</p>
<h2 data-id="heading-2">å†™åœ¨æœ€å</h2>
<p>å†…å·æ—¶ä»£ï¼Œå•é ä¸ªä½“åŠªåŠ›å·²ç»å¾ˆéš¾è·å¾—é£è·ƒå¼çš„æ™‹å‡ï¼Œæ—¶ä»£çº¢åˆ©çš„çª—å£ä¸€è¿‡å¾ˆå¤šäº‹æƒ…åšèµ·æ¥åªä¼šæ›´éš¾å¹¶ä¸ä»£è¡¨æ­£ç¡®ï¼Œå°±åƒå½“å¹´ä¹°æˆ¿é‚£æ‰¹äººï¼Œå¯èƒ½ä¸æ˜¯å› ä¸ºä»–ä»¬æœ‰å¤šåŠªåŠ›å¤šä¹ˆæœ‰çœ¼å…‰ï¼Œè€Œæ˜¯åšå¯¹äº†â€œé€‰æ‹©â€ï¼Œæˆ–è®¸æˆ‘ä»¬ä¹Ÿè¦å®¢è§‚åœ°çœ‹å¾…äººç”Ÿå½“ä¸­çš„â€œå¾—ä¸å¤±â€ã€‚</p>
<p>æˆ‘ä»¬ç»ƒæ­¦ä¸­æœ‰å¥è¯å«åš<strong>è·Ÿè‡ªå·±èº«ä½“æ²Ÿé€š</strong>ï¼Œè·Ÿ<strong>è‡ªæˆ‘è§‰å¯Ÿ</strong>æœ‰ç±»ä¼¼ç‚¹ï¼Œèº«ä½“æå‰é¢„è­¦å°±ä¸€å®šè¦å…³æ³¨ï¼Œå¾ˆå¤šäººæ‹¼åˆ°æœ€åè‚¯å®šä¹Ÿåœ¨æ‹¼ä½“åŠ›ï¼Œæ‰€ä»¥å…ˆç…§é¡¾å¥½è‡ªå·±ï¼Œè¯¥æ”¾æ¾çš„æ—¶å€™å°±æ”¾æ¾ï¼Œå¯¹è‡ªå·±å¯¹å®¶äººéƒ½æ˜¯è´Ÿè´£ä»»çš„ã€‚</p>
<p>æœ€åï¼Œå¼•ç”¨å‰‘æ¥é˜¿è‰¯çš„ä¸€å¥è¯ï¼š<strong>æ´»ç€ï¼Œå°±æœ‰å¸Œæœ›</strong>ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5713752efef242f28d66708258d1f576~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5berZGVidWfml6XorrA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851575&amp;x-signature=3myPWkWZv9ca9zIRvSwTkLtvwkQ%3D" alt="" loading="lazy"/></p>
<p/>
<p/>
<p/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vibe Coding ä¸€å‘¨ï¼Œæˆ‘åšäº†ä¸ªæ¡Œé¢ Agent]]></title>    <link>https://juejin.cn/post/7598465042968477736</link>    <guid>https://juejin.cn/post/7598465042968477736</guid>    <pubDate>2026-01-24T09:19:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598465042968477736" data-draft-id="7598464972912590888" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vibe Coding ä¸€å‘¨ï¼Œæˆ‘åšäº†ä¸ªæ¡Œé¢ Agent"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:19:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾é€—ç¬”"/> <meta itemprop="url" content="https://juejin.cn/user/2682464100687230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vibe Coding ä¸€å‘¨ï¼Œæˆ‘åšäº†ä¸ªæ¡Œé¢ Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464100687230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾é€—ç¬”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:19:53.000Z" title="Sat Jan 24 2026 09:19:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤ç›˜ä¸€ä¸‹æˆ‘vibe coding ä¸€å‘¨ï¼Œå¼€å‘ WorkAny çš„è¿‡ç¨‹ï¼Œå¾ˆæœ‰æ„æ€ã€‚ğŸ˜‚</p>
<h2 data-id="heading-0">å¼€å‘è¿‡ç¨‹</h2>
<ol>
<li>
<p>ä¸Šå‘¨ä¸‰åœ¨é¦™æ¸¯åŠå¡ï¼Œä¸´æ—¶èµ·æ„æƒ³åšä¸ªæ¡Œé¢ Agent é¡¹ç›®ï¼Œå¯¹æ ‡ coworkï¼Œæ™šä¸Šå›åˆ°å¹¿å·å¼€å§‹å†™ä»£ç </p>
</li>
<li>
<p>åˆæœŸç›®æ ‡æ˜¯å¿«é€Ÿå‘å¸ƒï¼Œæ²¡æ—¶é—´å»ç ”ç©¶å“ªä¸ª Agent æ¡†æ¶å¥½ç”¨äº†ï¼Œçœ‹å¾ˆå¤šäººåœ¨ç”¨ claude agent sdkï¼Œå…ˆç”¨è¿™ä¸ªå§</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6638cb4bb6047f9b704201c62ae3e50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=twU06G5cn6F9gF7Um5YEB85SkxE%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>
<p>ç¬¬ä¸€æ—¶é—´æƒ³åˆ°ç”¨ tauriï¼Œå–œæ¬¢å°è€Œç¾ï¼Œæ€»è§‰å¾— electron å¾ˆé‡ï¼Œä¸æƒ³ç”¨</p>
</li>
<li>
<p>ä¸æƒ³è‡ªå·±å†™ä»£ç äº†ï¼Œå†³å®šè®© claude code æ¥å†™ã€‚ä¹‹å‰çš„ claude è´¦å·éƒ½è¢«å°äº†ï¼Œç”¨ä¸ä¸ŠåŸç‰ˆ ccï¼Œè£…äº†ä¸ª cc-switchï¼Œæ¥ä¸Š OpenRouter çš„ API å¼€å§‹å†™</p>
</li>
<li>
<p>æˆªäº†ä¸ª chatbot çš„äº¤äº’æˆªå›¾ï¼Œè®© cc å‚è€ƒç€å…ˆæŠŠåŸºæœ¬çš„å¯¹è¯æµç¨‹è·‘é€šï¼Œç”¨ claude agent sdkï¼Œæ¥ä¸Š OpenRouterï¼Œcc å¾ˆå¿«å†™å®Œäº†ç¬¬ä¸€ç‰ˆ</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d40f912af6048938b6c24d8b0e9d04a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=cNvyLxjsZ3MH81jp2x9lj1nHYyQ%3D" alt="" loading="lazy"/></p>
<ol start="6">
<li>tauri æœ¬è´¨æ˜¯ç”¨ rust çš„å£³å­å¥—äº†ä¸ªå‰ç«¯ç•Œé¢ï¼Œä¸ç†Ÿæ‚‰ rustï¼Œè®© cc ç”¨ hono å†™APIï¼Œrust åªåšå£³å­ï¼Œä¸åšä¸šåŠ¡åŠŸèƒ½ã€‚API ä½œä¸º sidecar æ‰“åŒ…è¿› app</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42bcbb34123943d7a370c427f8a3f02e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=mCeWv%2FlkhgYJTJeUEyCllpvNcj8%3D" alt="" loading="lazy"/></p>
<ol start="7">
<li>
<p>è®© cc åœ¨ API å¼•å…¥ sqlite å®ç°æœ¬åœ°å­˜å‚¨ï¼ŒæŒä¹…åŒ–ä»»åŠ¡æ•°æ®ï¼Œåˆ›å»ºæœ¬åœ°å·¥ä½œç›®å½•ï¼Œä¿å­˜ä»»åŠ¡è¾“å‡ºæ–‡ä»¶</p>
</li>
<li>
<p>å†™äº†åŠå¤©ï¼Œçœ‹ OpenRouter æ¶ˆè€—äº† 110 åˆ€ï¼Œæœ‰ç‚¹è‚‰ç–¼ã€‚ä¹°äº†ä¸ªç¾å›½ä½å®… ipï¼Œä»˜è´¹ä¸Šäº†åŸç‰ˆ claude pro</p>
</li>
<li>
<p>æˆªäº†ä¸ª Manus çš„ä»»åŠ¡è¯¦æƒ…å›¾ï¼Œè®© cc å‚è€ƒå†™å®Œå·¥å…·è°ƒç”¨çš„é€»è¾‘ï¼Œä¸­é—´æ˜¯ chatbot å¯¹è¯ï¼Œå³è¾¹ç”¨ä¸€ä¸ªè™šæ‹Ÿè®¡ç®—æœºçš„å®¹å™¨å±•ç¤ºè¾“å…¥è¾“å‡º</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f659b49ba9d4069a565fd8c49e81e7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=KuCYbRKETYxXYA9JZtLl5DOPXMA%3D" alt="" loading="lazy"/></p>
<ol start="10">
<li>è®© cc æ¥å…¥ shadcn/uiï¼ŒæŠŠæ ·å¼åšå¾—å¥½çœ‹ä¸€ç‚¹ï¼Œæ”¯æŒåˆ‡æ¢çš®è‚¤</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71722d5fd61045fea186b2b47117f5d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=l0qj52LJxdYjsve8hhqXbIAn6eQ%3D" alt="" loading="lazy"/></p>
<ol start="11">
<li>
<p>åˆå†™äº†ä¸€å¤©ï¼Œå…³é”®æ—¶å€™ claude pro é™é¢‘äº†ï¼Œå¾ˆå½±å“å¿ƒæƒ…ï¼Œè¡¥å·®ä»·ä¸Šäº† claude max é¡¶é…ç‰ˆ</p>
</li>
<li>
<p>è®© cc æŠŠè‡ªå®šä¹‰æ¨¡å‹é…ç½®ï¼Œmcpã€skills è°ƒç”¨çš„é€»è¾‘éƒ½å®ç°äº†ï¼Œè·‘äº†å‡ ä¸ªç”Ÿæˆ PPTã€Excelã€Docã€ ç½‘é¡µçš„ caseï¼Œæ•ˆæœä¸é”™</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e97af301a7d841929dc5d65a6cf455e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=jTZ45ZnICl8En5Ci1KmTZx%2B5hho%3D" alt="" loading="lazy"/></p>
<ol start="13">
<li>è®© cc æŠŠè¾“å‡ºæ–‡ä»¶å¤¹å’Œä¸­é—´è¿‡ç¨‹çš„ artifacts éƒ½åœ¨å³è¾¹å±•ç¤ºå‡ºæ¥ï¼Œå†™äº†ä¸ª artifact preview å®¹å™¨ï¼Œæ¸²æŸ“å„ç§ç±»å‹çš„æ–‡ä»¶ï¼Œå¯è§†åŒ–é¢„è§ˆ</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74a2bfa14d3a40c6b60b88d20d6701e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=h%2FPXsExTE%2BIRFGAYeR6ktWfjs6o%3D" alt="" loading="lazy"/></p>
<ol start="14">
<li>æœ‰äº›ä»»åŠ¡éœ€è¦è·‘è„šæœ¬å®Œæˆï¼Œè€ƒè™‘åˆ°ç”¨æˆ·ç”µè„‘å¯èƒ½æ²¡è£…ä»£ç è¿è¡Œç¯å¢ƒï¼Œè®© cc å¼•å…¥ sandbox æ¥è¿è¡Œä»£ç </li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/811d03960c6043c68495da51d07e4492~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=F22XoHYbuDG9NdF1e%2FFhIf6wC4M%3D" alt="" loading="lazy"/></p>
<ol start="15">
<li>è€ƒè™‘åˆ°æ‰©å±•æ€§ï¼Œéœ€è¦æ”¯æŒä¸åŒç±»å‹çš„ Agent runtime å’Œ sandboxï¼Œè®© cc å†™äº†ä¸¤ä¸ªæŠ½è±¡ç±»ï¼Œç»Ÿä¸€æ¥å£è°ƒç”¨ã€‚Agent runtime æ”¯æŒ claude codeã€codexã€deepagentsï¼Œsandbox æ”¯æŒ boxliteã€codex-sandboxã€claude-sandbox</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/708c2f2504cf4327a5ee3b543816e26d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=M8FGZZHJSIJaPqqZLMaw8dB%2BK1I%3D" alt="" loading="lazy"/></p>
<ol start="16">
<li>è§‰å¾— cc å†™çš„ä»£ç æœ‰ç‚¹ä¹±ï¼Œè®© cc å¼•å…¥ eslint å’Œ prettier åšäº†ä¸‹æ ¼å¼åŒ–ï¼ŒæŠŠé€»è¾‘å¤ªå¤šçš„æ–‡ä»¶åšæ¨¡å—åŒ–æ‹†åˆ†ã€‚å†å‚è€ƒ ShipAny çš„ç›®å½•ç»“æ„ï¼Œè°ƒæ•´äº†ä¸€ä¸‹é¡¹ç›®ç»“æ„</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7d317c0f2f5454c9c04ae388af01f91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=Qgzjeq50lD63syn6vcNWykLDQrs%3D" alt="" loading="lazy"/></p>
<ol start="17">
<li>è®© cc å†™æ‰“åŒ…è„šæœ¬ï¼Œæ„å»ºä¸åŒæ“ä½œç³»ç»Ÿçš„å®‰è£…åŒ…ã€‚æŠŠå®‰è£…åŒ…å‘ç»™ä¸€äº›æœ‹å‹ï¼Œå¼€å§‹å†…æµ‹äº†ã€‚æ ¹æ®å†…æµ‹ç”¨æˆ·çš„åé¦ˆï¼Œå†è®© cc ç»§ç»­ä¼˜åŒ–é€»è¾‘ï¼Œè§£å†³é—®é¢˜ï¼Œè¿­ä»£åŠŸèƒ½</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5da0190b1724df1bdabb1ab39244608~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=X95HZi%2F0To8vUabtElEckAjjOps%3D" alt="" loading="lazy"/></p>
<ol start="18">
<li>
<p>æœ‰äº›ç”¨æˆ·ç”µè„‘æ²¡è£… nodeï¼Œæ²¡æœ‰ claude codeï¼Œå®‰è£…è½¯ä»¶åè·‘ä¸èµ·æ¥ï¼Œè®© cc åœ¨æ„å»ºè„šæœ¬æ”¯æŒ flag å‚æ•°ï¼ŒæŠŠ node å’Œ cc ä½œä¸º sidecar æ‰“åŒ…è¿› appï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå¼€ç®±å³ç”¨</p>
</li>
<li>
<p>Mac ç”¨æˆ·å®‰è£… app åæç¤ºæ–‡ä»¶æŸåæˆ–æœ‰å®‰å…¨æç¤ºï¼Œè®© cc åœ¨æ„å»ºè„šæœ¬é‡Œé¢åŠ ä¸Šç­¾åå¤„ç†ï¼Œç”¨æˆ‘çš„ Apple å¼€å‘è€…è´¦æˆ·å¯¹æ‰“åŒ…çš„ Mac app åšç­¾å</p>
</li>
<li>
<p>node å’Œ cc éƒ½æ‰“åŒ…è¿› app çš„ç‰ˆæœ¬ï¼Œå®‰è£…åŒ… 100 å¤š mï¼Œæœ‰ç‚¹é‡ã€‚è®© cc åœ¨æ„å»ºè„šæœ¬å®ç°é»˜è®¤ä¸æ‰“åŒ…ï¼Œåœ¨ç”¨æˆ·å¯åŠ¨ app çš„æ—¶å€™å¼•å¯¼å®‰è£… node å’Œ ccï¼Œç²¾ç®€ç‰ˆå®‰è£…åŒ…æ‰ 20 å¤š mï¼Œå°å·§ç²¾è‡´</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8e99a9ff9544c87b874018539f66c97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=KF4HEfIKOkMN4a4XtTKetdb6lWk%3D" alt="" loading="lazy"/></p>
<ol start="21">
<li>app åŸºæœ¬åŠŸèƒ½å®ç°å¾—å·®ä¸å¤šäº†ï¼Œè®© cc åœ¨ ShipAny æ¨¡æ¿åŸºç¡€ä¸Šå†™ä¸€ä¸ª WorkAny çš„å®˜ç½‘ï¼Œæ”¾ä¸Šæ¼”ç¤ºå›¾ï¼Œéƒ¨ç½²ä¸Šçº¿</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ee57d70102b4b13b3d3a515b6c29f34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=CjmI9cmNXPHyD%2FuV1gx9kvrgtUE%3D" alt="" loading="lazy"/></p>
<ol start="22">
<li>WorkAny å¼€æºå‘å¸ƒï¼ŒMVP ç‰ˆæœ¬ä¸Šçº¿ï¼Œç”¨æˆ·æ‹‰æºç æœ¬åœ°æ„å»ºï¼Œé…ä¸ª API ç›´æ¥ç”¨</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34802ec98531460c9f90a37c8e5e672c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=Hz10Ady75tV2J1hJtL17LulUffo%3D" alt="" loading="lazy"/></p>
<ol start="23">
<li>è®© cc å†™äº†ä¸ª github æ„å»ºè„šæœ¬ï¼Œåœ¨ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶ï¼Œè‡ªåŠ¨è§¦å‘ github action æ„å»ºï¼Œä¸€æ¬¡æ€§æ‰“åŒ… Windowsã€Linuxã€Mac ä¸‰å¤§å¹³å°çš„å®‰è£…åŒ…ï¼Œè‡ªåŠ¨å‘å¸ƒåˆ° releaseï¼Œç”¨æˆ·æ— éœ€è‡ªè¡Œæ„å»ºäº†</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/875ea5654cf0440a99411114e7500739~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=o1MVFAKL6rojqV69qtgVm0S7n%2Fk%3D" alt="" loading="lazy"/></p>
<ol start="24">
<li>æ ¹æ®ç”¨æˆ·çš„åé¦ˆï¼Œé—®é¢˜ä¸¢ç»™ cc å»ä¿®ï¼Œæƒ³åˆ°ä»€ä¹ˆæ–°åŠŸèƒ½ä¹Ÿå‘Šè¯‰ cc åŠ ä¸Šï¼Œè‡ªå·±åªåšæµ‹è¯•ï¼Œä¸å†™ä»£ç ï¼Œçœ‹éƒ½ä¸çœ‹ä¸€çœ¼ã€‚ğŸŒš</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e68039517e54390a685a2850efe394e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=kzfb2Ui7VrDj2NWGWs%2BD%2FN%2B0nLA%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">å‡ ç‚¹æ„Ÿæ‚Ÿ</h2>
<ol>
<li>ç¬¬ä¸€æ¬¡å°è¯•å…¨è‡ªåŠ¨é©¾é©¶ vibe coding åšé¡¹ç›®ï¼Œçˆ½æ„Ÿéå¸¸å¼ºçƒˆï¼ŒWorkAny çš„ä»£ç  100% ç”± cc è€å¼Ÿå®Œæˆï¼Œæˆ‘åªè´Ÿè´£æŒ‡æŒ¥ï¼Œæ—¥å¸¸å¼€ä¸‰ä¸ªçª—å£ï¼Œè®©ä¸‰ä¸ª cc è€å¼ŸåŒæ—¶å¹²æ´»ï¼Œæ•ˆç‡æ‹‰æ»¡</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f65c44ce406422bac53effa8da87ff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=Jv4jeqybt1kQ7LxuVIw%2BL6OfZIU%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>AI æ—¶ä»£æŠ€æœ¯å¹³æƒï¼Œäººäººéƒ½æ˜¯å»ºç­‘å¸ˆï¼Œç†è§£ç”¨æˆ·éœ€æ±‚ã€å¥½çš„äº§å“ sense å’Œå®¡ç¾æ˜¯åšå‡ºå¥½äº§å“çš„å…³é”®</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/916b74cae2474ec9bb563a822ff21c6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=EtAg5iOc%2FgI0vnKj4e5%2BAfyUdqM%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>
<p>æŠ€æœ¯å¹¿åº¦å’Œå…¨å±€è§†é‡æ˜¯æœ€å¤§çš„ä¼˜åŠ¿ï¼Œå¯ä»¥ç²¾å‡†æéœ€æ±‚ï¼ŒæŒ‡å“ªæ‰“å“ªï¼Œé‡åˆ°é—®é¢˜èƒ½å¿«é€Ÿå®šä½ï¼Œé˜²æ­¢ AI èµ°åå¤±æ§</p>
</li>
<li>
<p>ä»¥å‰æ€»è§‰å¾—æ‰‹æ´—çš„è¡£æœæ¯”æ´—è¡£æœºæ´—çš„å¹²å‡€ï¼Œç°åœ¨å¯ä»¥æ”¾å¿ƒäº¤ç»™æ´—è¡£æœºäº†ï¼Œåˆå¹²å‡€åˆå¿«ï¼Œèƒ½ç©¿å°±è¡Œ</p>
</li>
<li>
<p>ä¼˜ç§€çš„ç¨‹åºå‘˜ä¸ä¼šè¢« AI æ·˜æ±°ï¼Œæ³•æ‹‰åˆ©è€äº†è¿˜æ˜¯æ³•æ‹‰åˆ©ã€‚ğŸŒ</p>
</li>
</ol>
<p>æ¬¢è¿è¯•ç”¨ WorkAnyï¼Œæ„Ÿè°¢åé¦ˆä¸æ”¯æŒã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fworkany.ai" target="_blank" title="https://workany.ai" ref="nofollow noopener noreferrer">workany.ai</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/473bd81c6fe44fb5a4410778625065a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YCX56yU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851193&amp;x-signature=ZOLyD%2Bp9oO%2F%2BiqJdFH4wmuSKCGQ%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LlamaIndex å­¦ä¹ æ•™ç¨‹-æ¦‚å¿µç¯‡]]></title>    <link>https://juejin.cn/post/7598587406706556969</link>    <guid>https://juejin.cn/post/7598587406706556969</guid>    <pubDate>2026-01-24T09:23:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598587406706556969" data-draft-id="7598480413803642922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LlamaIndex å­¦ä¹ æ•™ç¨‹-æ¦‚å¿µç¯‡"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Python,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:23:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åªä¸æ˜æœˆå¬"/> <meta itemprop="url" content="https://juejin.cn/user/386661153249102"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LlamaIndex å­¦ä¹ æ•™ç¨‹-æ¦‚å¿µç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/386661153249102/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åªä¸æ˜æœˆå¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:23:40.000Z" title="Sat Jan 24 2026 09:23:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€. å¼•è¨€ï¼šä¸ºä»€ä¹ˆé€‰æ‹© LlamaIndexï¼Ÿ</h2>
<p>æœ‰ä¸€å¥è¯æ<code>RAG</code>éå¸¸åˆ°ä½ï¼š ä»æœ¬è´¨ä¸Šè®²ï¼ŒRAGï¼ˆRetrieval-Augmented Generationï¼‰æ˜¯ä¸€ç§æ—¨åœ¨è§£å†³å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰â€œçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶â€é—®é¢˜çš„æŠ€æœ¯èŒƒå¼ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯å°†æ¨¡å‹å†…éƒ¨å­¦åˆ°çš„â€œ<strong>å‚æ•°åŒ–çŸ¥è¯†</strong>â€ï¼ˆæ¨¡å‹æƒé‡ä¸­å›ºåŒ–çš„ã€æ¨¡ç³Šçš„â€œè®°å¿†â€ï¼‰ï¼Œä¸æ¥è‡ªå¤–éƒ¨çŸ¥è¯†åº“çš„â€œ<strong>éå‚æ•°åŒ–çŸ¥è¯†</strong>â€ï¼ˆç²¾å‡†ã€å¯éšæ—¶æ›´æ–°çš„å¤–éƒ¨æ•°æ®ï¼‰ç›¸ç»“åˆã€‚</p>
<p>åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸä¸Šæœ‰ä¸ªä¸“ä¸šåå­—å«åšï¼š<code>Trade-off</code>ï¼Œå°±æ˜¯æˆ‘ä»¬æ²¡æœ‰åŠæ³•æ—¢è¦åˆè¦ï¼Œæ²¡æœ‰æœ€ä½³æ–¹æ¡ˆï¼Œåªæœ‰æœ€é€‚åˆçš„ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨é€‚åˆçš„åœºæ™¯ï¼Œé€‰æ‹©å‡ºæœ€è´´åˆä¸šåŠ¡çš„æ–¹æ¡ˆã€‚æ¯”å¦‚åœ¨llmåº”ç”¨å¼€å‘ä¸­ï¼Œå¦‚ä½•é¿å…å¤§æ¨¡å‹ä¹±å›ç­”ï¼Œæˆæœ¬æœ€å°çš„å°±æ˜¯promptå·¥ç¨‹ï¼Œé€‰æ‹©åˆé€‚çš„æç¤ºå­—è®©ä»–å›ç­”å‡ºæˆ‘ä»¬æƒ³è¦çš„å›ç­”ï¼Œè€Œä¸ä¸€ä¸Šæ¥å°±æ¢æ¨¡å‹ï¼Œpromptåšä¸åˆ°ï¼Œå°±å›å»ä½¿ç”¨<code>RAG</code>ï¼Œç»™ä»–å¤–æŒ‚ä¸€ä¸ªçŸ¥è¯†åº“ï¼Œå½“å‰ä¸¤è€…éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œå¾®è°ƒæ‰ä¼šæˆä¸ºä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰é¡¹ã€‚</p>
<p><code>LlamaIndex</code>æ˜¯ä¸€ä¸ªä¸“æ³¨æ•°æ®å±‚çš„llmåº”ç”¨æ¡†æ¶ï¼Œå…¶åˆè¡·å°±æ˜¯ä¸ºäº†ç®€åŒ–<code>RAG</code>æµç¨‹ï¼Œæ›´åŠ ä¸“æ³¨äºæ•°æ®å¦‚ä½•è¢«ç»„ç»‡ã€ç´¢å¼•å’Œæ£€ç´¢ï¼Œå¼ºè°ƒæ•°æ®æ¥å…¥ã€ç´¢å¼•ç»“æ„å’ŒæŸ¥è¯¢è´¨é‡ã€‚</p>
<p>å…¶å®llmåº”ç”¨å¼€å‘é¦–é€‰å®é™…ä¸Šæ˜¯<code>langchain</code>ï¼Œå°¤å…¶æ˜¯ç¤¾åŒºæˆç†Ÿåº¦æ–¹é¢ï¼Œ<code>langchain</code>éƒ½ä¸å¯é¿å…çš„æˆä¸ºé¦–é€‰ï¼Œä½†æ˜¯åš<code>RAG</code>çš„å…³é”®ä¸æ˜¯æœ‰æ²¡æœ‰æ¥å‘é‡æ•°æ®åº“ï¼Œè€Œæ˜¯æ£€ç´¢æ˜¯å¦çœŸçš„ä¸ºæ¨¡å‹æä¾›äº†æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ã€‚<code>LlamaIndex</code>å°†<code>RAG</code>çš„å¤æ‚æ€§å‰ç§»åˆ°æ•°æ®ä¸æ£€ç´¢å±‚è¿›è¡Œç³»ç»ŸåŒ–æŠ½è±¡å¤„ç†ï¼Œå› æ­¤<code>RAG</code>åœºæ™¯ä¸‹<code>LlamaIndex</code>æ¯”langchainæ›´è‡ªç„¶å’Œé«˜æ•ˆã€‚</p>
<h3 data-id="heading-1">1.1 æ¦‚è§ˆ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.llamaindex.ai%2Fpython%2Fframework%2Fgetting_started%2Fconcepts%2F" target="_blank" title="https://developers.llamaindex.ai/python/framework/getting_started/concepts/" ref="nofollow noopener noreferrer">æ–‡æ¡£å…¥å£åœ°å€</a></p>
<p>ä¸€ä¸ªå®Œå–„çš„<code>RAG</code>ç³»ç»Ÿå¯ä»¥è¢«ç®€åŒ–ä¸ºä¸‹é¢è¿™ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol start="0">
<li>
<p>æ•°æ®å‡†å¤‡ä¸æ¸…æ´—</p>
<p>å½“æ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ—¶ï¼Œä¸ä¼šç«‹é©¬æŠ›ç»™llmï¼Œè€Œæ˜¯å°†æ”¶é›†åˆ°çš„ä¿¡æ¯ï¼Œæ¯”å¦‚PDFã€wordå’Œç½‘é¡µç­‰ï¼Œè½¬æ¢æˆæ ‡å‡†åŒ–æ–‡æœ¬ï¼ŒæŒ‰ç…§è¯­ä¹‰æ®µè½æˆ–è€…å¥å­åˆ‡åˆ†ï¼Œç”Ÿæˆ<code>Document</code>æˆ–è€…<code>Node</code>ï¼Œè¿™é‡Œçš„<code>Document</code>æ˜¯<code>LlamaIndex</code>ä¸­çš„ä¸€ä¸ªé€šç”¨å®¹å™¨ï¼Œç”¨æ¥å°è£…å„ç§æ•°æ®æºçš„æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®å•å…ƒã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">from llama_index.core <span class="hljs-keyword">import</span> Document
documents = [<span class="hljs-built_in">Document</span>(text=<span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£çš„æ–‡æœ¬ã€‚"</span>, metadata={<span class="hljs-string">"source"</span>: <span class="hljs-string">"file1.pdf"</span>})]
</code></pre>
<p>å®é™…ä¸Šå°±æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥æ„å»ºæˆä¸€ä¸ª<code>LlamaIndex</code>å¯ä»¥å¤„ç†çš„å¯¹è±¡</p>
<p>è€Œ<code>Node</code>æ˜¯ä»<code>Document</code>ä¸­æŠ½å‡ºæ¥çš„å—ï¼Œæ¯”å¦‚ä¸€ä¸ªæ®µè½ã€å¥å­ç­‰ã€‚</p>
</li>
<li>
<p>ç´¢å¼•æ„å»º</p>
<p>ä½¿ç”¨åµŒå…¥æ¨¡å‹å°†æ–‡æœ¬<code>Node</code>è½¬ä¸ºå‘é‡ï¼Œé»˜è®¤å°±æ˜¯<code>text-embedding-ada-002</code>ï¼Œè½¬åŒ–ä¸ºå‘é‡åï¼Œå°±å¯ä»¥ä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦æ¥åˆ¤æ–­è¯­ä¹‰ç›¸å…³æ€§ï¼Œè€Œä¸æ˜¯é å…³é”®è¯å»åŒ¹é…ã€‚</p>
<p>æœ‰äº†å‘é‡åï¼Œå°±å¯ä»¥å°†å‘é‡å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼Œè¿™æ˜¯ä¸ºäº†å¢åŠ æ£€ç´¢æ•ˆç‡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½å»éå†å…¨éƒ¨æ–‡æœ¬</p>
</li>
<li>
<p>æ£€ç´¢ä¸å¢å¼º</p>
<p>ç”¨æˆ·åœ¨ç³»ç»Ÿè¾“å…¥é—®é¢˜ï¼Œ<code>LlamaIndex</code>ä½¿ç”¨åŒæ ·çš„æ¨¡å‹å°†é—®é¢˜è½¬åŒ–ä¸ºå‘é‡ï¼Œç„¶åç”¨ä¹‹å‰æ„å»ºå¥½çš„ç´¢å¼•æ‰¾å‡ºä¸æŸ¥è¯¢å‘é‡æœ€ç›¸ä¼¼çš„Kä¸ª<code>Node</code>ï¼›ç„¶åå¯¹ Top-K çš„ç»“æœå†ç”¨è½»é‡ LLM æˆ– BERT ç±»æ¨¡å‹é‡æ–°æ’åº ï¼Œæ¥æé«˜æ£€ç´¢çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚</p>
<p>æœ‰äº†ç›¸å…³çš„<code>Node</code>åï¼Œç»“åˆç”¨æˆ·çš„é—®é¢˜å’Œç³»ç»Ÿæç¤ºæ¥æ‹¼æ¥æˆä¸€ä¸ªå¢å¼ºçš„promptï¼Œé€ç»™llm</p>
</li>
<li>
<p>ç”Ÿæˆä¸æç¤ºå·¥ç¨‹</p>
<p>é—®é¢˜ç»è¿‡æ£€ç´¢å’Œå¢å¼ºæç¤ºåï¼Œå¾—åˆ°çš„promptåŒ…å«åŸå§‹é—®é¢˜ã€æ£€ç´¢å¾—åˆ°çš„top-kå’Œç³»ç»Ÿè§’è‰²æç¤ºï¼Œllmæ¥æ”¶åˆ°è¿™ä¸ªå¢å¼ºçš„æç¤ºè¯ï¼Œåœ¨ä¸Šä¸‹æ–‡çš„åŸºç¡€ä¸Šç”Ÿæˆå›ç­”ã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">äºŒ. LlamaIndex å¿«é€Ÿå…¥é—¨ä¸å®æˆ˜</h2>
<h3 data-id="heading-3">2.1 ç¯å¢ƒå‡†å¤‡</h3>
<ul>
<li>
<p>å®‰è£…å‘½ä»¤ï¼š<code>pip install llama-index</code></p>
</li>
<li>
<p>API Key é…ç½®ã€‚</p>
<p>æ–°å»º<code>.env</code>æ–‡ä»¶åœ¨æ ¹ç›®å½•ï¼Œç„¶åå†™ä¸Šä½ çš„key</p>
<p><code>DEEPSEEK_API_KEY=xxx</code></p>
</li>
</ul>
<h3 data-id="heading-4">2.2 æœ€å°åŒ– RAG ç¤ºä¾‹</h3>
<pre><code class="hljs language-ini" lang="ini">from dotenv import load_dotenv
from llama_index.core import Document, VectorStoreIndex, Settings
from llama_index.embeddings.huggingface import HuggingFaceEmbedding
from llama_index.llms.deepseek import DeepSeek
â€‹
â€‹
<span class="hljs-comment"># è¯»å– .env ä¸­çš„ç¯å¢ƒå˜é‡ï¼ˆä¾‹å¦‚ DEEPSEEK_API_KEYï¼‰</span>
load_dotenv()
â€‹
<span class="hljs-comment"># æ˜¾å¼æŒ‡å®š LLM å’Œ Embeddingï¼Œé¿å…ä½¿ç”¨é»˜è®¤çš„ OpenAI</span>
<span class="hljs-attr">Settings.llm</span> = DeepSeek(
 Â  Â <span class="hljs-attr">model</span>=<span class="hljs-string">"deepseek-chat"</span>, Â <span class="hljs-comment"># å¦‚æœ‰éœ€è¦å¯æ”¹æˆå…¶å®ƒ DeepSeek æ¨¡å‹</span>
)
â€‹
<span class="hljs-attr">Settings.embed_model</span> = HuggingFaceEmbedding(
 Â  Â <span class="hljs-attr">model_name</span>=<span class="hljs-string">"BAAI/bge-small-zh-v1.5"</span> Â <span class="hljs-comment"># é€‚åˆä¸­æ–‡çš„å‘é‡æ¨¡å‹</span>
)
â€‹
<span class="hljs-attr">documents</span> = [
 Â  Â Document(
 Â  Â  Â  Â text=<span class="hljs-string">"LlamaIndex æ˜¯ä¸€ä¸ªç”¨äºæ„å»º RAG åº”ç”¨çš„æ•°æ®æ¡†æ¶ã€‚"</span>,
 Â  Â  Â  Â metadata={<span class="hljs-string">"source"</span>: <span class="hljs-string">"intro"</span>},
 Â   ),
 Â  Â Document(
 Â  Â  Â  Â text=<span class="hljs-string">"RAG çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ£€ç´¢å¤–éƒ¨çŸ¥è¯†æ¥å¢å¼º LLM çš„å›ç­”èƒ½åŠ›ã€‚"</span>,
 Â  Â  Â  Â metadata={<span class="hljs-string">"source"</span>: <span class="hljs-string">"rag"</span>},
 Â   ),
]
â€‹
â€‹
<span class="hljs-attr">index</span> = VectorStoreIndex.from_documents(documents)
<span class="hljs-attr">query_engine</span> = index.as_query_engine()
â€‹
<span class="hljs-attr">response</span> = query_engine.query(<span class="hljs-string">"ä»€ä¹ˆæ˜¯ RAGï¼Ÿ"</span>)
â€‹
print(response)
</code></pre>
<p>è¿™é‡Œå…ˆåŠ è½½å®šä¹‰åœ¨ç¯å¢ƒå˜é‡ä¸­çš„keyï¼Œæ˜¾ç¤ºçš„æŒ‡å®šæ¨¡å‹ã€‚ç„¶åå®šä¹‰äº†æ–‡æ¡£æ•°æ®æ•°ç»„ï¼Œç”±<code>Document</code>å¯¹è±¡æ„æˆï¼Œå‰é¢ä¹Ÿä»‹ç»è¿‡ï¼Œ<code>Document</code>å¯¹è±¡å°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ•°æ®å•å…ƒã€‚<code>VectorStoreIndex.from_documents(documents)</code>è¿™è¡Œä»£ç å°±æ˜¯æ„å»ºå‘é‡ç´¢å¼•ï¼Œå’Œç”¨æˆ·çš„è¾“å…¥åšç›¸ä¼¼åº¦æ£€æµ‹ã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºå°†æ–‡æœ¬è½¬åŒ–æˆå‘é‡ï¼Œæ˜¯ä¸€ä¸ªæœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ ‡å‡†ï¼Œåæ¥äº†è§£æ‰å‘ç°ä¸æ˜¯è¿™æ ·çš„ï¼Œå°†æ–‡æœ¬è½¬åŒ–æˆå‘é‡ï¼Œè¿™æ˜¯ä¸€ç§é€šç”¨çš„æ€æƒ³ï¼Œç”¨ä¸€ä¸ªå¤šç»´æ•°å­—å‘é‡æ¥è¡¨ç¤ºè¿™æ®µæ–‡å­—ï¼Œä½†æ˜¯å…·ä½“ä½¿ç”¨å¤šå°‘ç»´åº¦çš„å‘é‡ã€é‚£äº›è¯­ä¹‰æ›´åŠ æ¥è¿‘ï¼Œè¿™éƒ½æ˜¯å‘é‡æ¨¡å‹æ¥å†³å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªå®ä¾‹ä¸­é€‰ç”¨çš„å°±æ˜¯<code>model_name="BAAI/bge-small-zh-v1.5"</code>ï¼Œè¿˜æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼šè¿™é‡Œçš„æ¨¡å‹å’Œæˆ‘ä»¬æœ€åçš„llmæ¨¡å‹æ˜¯ä¸¤ç äº‹ï¼Œ<code>BAAI/bge-small-zh-v1.5</code>æ¨¡å‹æ˜¯<code>embedding</code>æ¨¡å‹ï¼Œå°†æˆ‘ä»¬çš„ç”¨æˆ·è¾“å…¥å’Œæ–‡æ¡£è½¬æ¢æˆå‘é‡ï¼Œåšç›¸ä¼¼åº¦åŒ¹é…çš„ï¼Œè€Œllmæ¨¡å‹æ‰æ˜¯æœ€ç»ˆçš„æ¨ç†æ¨¡å‹ã€‚</p>
<p>æ„å»ºå¥½å‘é‡ç´¢å¼•åï¼Œå°±å¯ä»¥å€Ÿæ­¤æ¥æ„å»ºæŸ¥è¯¢å¼•æ“ï¼Œ<code>index.as_query_engine()</code>ï¼Œ<code>query_engine</code>çš„èŒè´£å°±æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥æ„å»ºæˆå‘é‡æ¥å’Œæ–‡æ¡£å‘é‡åšç›¸ä¼¼åº¦åŒ¹é…ï¼Œå°†æ£€ç´¢åˆ°çš„å†…å®¹å’Œé—®é¢˜ä¸€èµ·ç»™llmæ€»ç»“å›ç­”ã€‚</p>
<p>æœ€åè°ƒç”¨<code>query_engine.query</code>æ¥å‘èµ·æŸ¥è¯¢ã€‚</p>
<h2 data-id="heading-5">ä¸‰. RAG æµç¨‹çš„äº”å¤§é˜¶æ®µ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.llamaindex.ai%2Fpython%2Fframework%2Funderstanding%2Frag%2F" target="_blank" title="https://developers.llamaindex.ai/python/framework/understanding/rag/" ref="nofollow noopener noreferrer">æ–‡æ¡£åœ°å€</a></p>
<h3 data-id="heading-6">3.1 é˜¶æ®µä¸€ï¼šåŠ è½½ (Loading)</h3>
<p>åŠ è½½é˜¶æ®µæ˜¯æ•´ä¸ªRAGæµç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®å¼•å…¥ç³»ç»Ÿï¼Œè½¬åŒ–ä¸º<code>LlamaIndex</code>å¯ä»¥ç†è§£å’Œå¤„ç†çš„ç»“æ„ã€‚è¿™é‡Œä¸»è¦æœ‰ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µ</p>
<ul>
<li>
<p><strong>Document / Node</strong>ï¼šæ•°æ®å®¹å™¨å’ŒåŸå­æ•°æ®å—çš„æŠ½è±¡ã€‚</p>
<p>è¿™é‡Œå‰é¢å·²ç»ä»‹ç»è¿‡äº†ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.llamaindex.ai%2Fpython%2Fframework%2Fmodule_guides%2Floading%2Fdocuments_and_nodes%2F" target="_blank" title="https://developers.llamaindex.ai/python/framework/module_guides/loading/documents_and_nodes/" ref="nofollow noopener noreferrer">æ–‡æ¡£</a>ä¹Ÿå¾ˆæ¸…æ™°ï¼Œ<code>Document</code>æœ¬èº«å°±æ˜¯ä¸€ä¸ªåŸå§‹çš„æ•°æ®å®¹å™¨ï¼Œç”¨äºå­˜å‚¨åŠ è½½çš„æ–‡æœ¬å’Œå†…å®¹ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index import Document
â€‹
<span class="hljs-attr">doc</span> = Document(
 Â  Â <span class="hljs-attr">text</span>=<span class="hljs-string">"LlamaIndex æ˜¯ä¸€ä¸ªè¿æ¥ LLM ä¸å¤–éƒ¨æ•°æ®çš„æ¡†æ¶ã€‚"</span>,
 Â  Â <span class="hljs-attr">metadata</span>={<span class="hljs-string">"source"</span>: <span class="hljs-string">"å®˜æ–¹æ–‡æ¡£"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"tutorial"</span>}
)
â€‹
</code></pre>
<p>è€Œ<code>Node</code>æ˜¯ä»<code>Document</code>åˆ‡åˆ†å‡ºæ¥çš„æœ€å°å•å…ƒä¿¡æ¯ï¼Œé€šå¸¸æ˜¯æŒ‰ç…§æ®µè½ã€å¥å­æˆ–è€…è¯­ä¹‰è¿›è¡Œåˆ‡åˆ†çš„ï¼Œæ˜¯å‘é‡åŒ–å’Œç´¢å¼•çš„åŸºæœ¬ç²’åº¦ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index.node_parser import SimpleNodeParser
â€‹
<span class="hljs-attr">parser</span> = SimpleNodeParser()
<span class="hljs-attr">nodes</span> = parser.get_nodes_from_documents([doc])
</code></pre>
<p>è¿™é‡Œå°±æ˜¯å°†<code>Document</code> åˆ‡åˆ†æˆçš„å¤šä¸ª <code>Node</code></p>
</li>
<li>
<p><strong>Data Connectors (LlamaHub)</strong> ï¼šæ•°æ®æºè¿æ¥å™¨é›†åˆã€‚</p>
<p>å°±æ˜¯ä¸€ä¸ªç±»ä¼¼äºæ•°æ®æ¥å£åº“ï¼Œå¯ä»¥å¿«é€Ÿä»å„ç§å¤–éƒ¨æ•°æ®æºåŠ è½½æ–‡æ¡£ã€‚æœ‰ä¸€ä¸ªè¯´æ³•å°±æ˜¯ï¼šLlamaHubçš„è®¾è®¡æ˜¯<code>LlamaIndex</code>å¯ä»¥å·¥ç¨‹åŒ–çš„æ ¸å¿ƒè®¾è®¡ä¹‹ä¸€ï¼Œå°±æ˜¯å› ä¸ºä»–å®ç°äº†æ‰€æœ‰çš„<code>Reader</code>éƒ½éµå¾ªç»Ÿä¸€æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">reader</span> = SomeReader(...)
<span class="hljs-attr">documents</span> = reader.load_data()
<span class="hljs-comment"># -&gt; List[Document]</span>
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡è¯»å–ä»»ä½•æ•°æ®ï¼Œæœ€ç»ˆéƒ½ä¼šè¾“å‡ºä¸€ä¸ªç»Ÿä¸€çš„<code>Document</code>çš„åˆ—è¡¨ã€‚</p>
<p>è¯»å–<code>Notion</code>æ•°æ®åº“</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index.readers.notion import NotionReader
â€‹
<span class="hljs-attr">reader</span> = NotionReader(
 Â  Â <span class="hljs-attr">notion_token</span>=<span class="hljs-string">"YOUR_TOKEN"</span>,
 Â  Â <span class="hljs-attr">database_id</span>=<span class="hljs-string">"DATABASE_ID"</span>
)
â€‹
<span class="hljs-attr">documents</span> = reader.load_data()
</code></pre>
<p>è¯»å–word/PDF</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index import SimpleDirectoryReader
â€‹
<span class="hljs-attr">reader</span> = SimpleDirectoryReader(
 Â  Â <span class="hljs-attr">input_files</span>=[<span class="hljs-string">"design.pdf"</span>, <span class="hljs-string">"api.docx"</span>]
)
â€‹
<span class="hljs-attr">documents</span> = reader.load_data()
</code></pre>
<p>è¯»å–github</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index.readers.github import GithubRepositoryReader
â€‹
<span class="hljs-attr">reader</span> = GithubRepositoryReader(
 Â  Â <span class="hljs-attr">owner</span>=<span class="hljs-string">"openai"</span>,
 Â  Â <span class="hljs-attr">repo</span>=<span class="hljs-string">"openai-python"</span>,
 Â  Â <span class="hljs-attr">use_parser</span>=<span class="hljs-literal">True</span>
)
â€‹
<span class="hljs-attr">documents</span> = reader.load_data()
</code></pre>
<p><code>LlamaIndex</code>ç”¨è¿‡è¿™ç§è®¾è®¡ï¼Œæ˜¯çš„æ‰€æœ‰çš„<code>Reader</code>ç»Ÿä¸€è¿”å›<code>Document</code>æ•°ç»„ï¼Œä½¿å¾—ä¸åŒçš„æ•°æ®æºèƒ½å¤Ÿä»¥é›¶é€‚é…æˆæœ¬æ¥å…¥åŒä¸€RAGä¸Agentç®¡é“</p>
</li>
</ul>
<h3 data-id="heading-7">3.2 é˜¶æ®µäºŒï¼šç´¢å¼• (Indexing)</h3>
<p>ç´¢å¼•çš„ç›®æ ‡åªæœ‰ä¸€ä¸ªï¼Œå³å°†ä¸å¯æ£€ç´¢çš„åŸå§‹æ–‡æœ¬ï¼Œè½¬æ¢ä¸ºå¯é«˜æ•ˆæ£€ç´¢çš„ç»“æ„åŒ–è¡¨ç¤ºï¼Œè¿™ä¸€æ­¥ç”±ä¸‰ä¸ªæ ¸å¿ƒæŠ½è±¡ç±»æ¥åä½œå®Œæˆï¼š</p>
<ul>
<li>
<p><strong>NodeParser</strong>ï¼šè´Ÿè´£å°† <code>Document</code> åˆ‡åˆ†ä¸º Node çš„å·¥å…·ã€‚</p>
<p>ä»–çš„èŒè´£ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªï¼šè´Ÿè´£åˆ‡åˆ†<code>Document</code>ï¼Œæ§åˆ¶chunkçš„å¤§å°ï¼Œä¿ç•™ä¸Šä¸‹çº§å…³ç³»å’Œç»´æŠ¤metadataä¸­çš„ç»§æ‰¿å…³ç³»ã€‚</p>
<p>çœ‹ä¸‹è¿™ä¸ªå®ä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index.core.node_parser import SentenceSplitter
â€‹
<span class="hljs-attr">parser</span> = SentenceSplitter(
 Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">512</span>,
 Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">50</span>
)
â€‹
<span class="hljs-attr">nodes</span> = parser.get_nodes_from_documents(documents)
</code></pre>
<p><code>SentenceSplitter</code>æ˜¯<code>LlamaIndex</code>æ ¸å¿ƒåº“ä¸­æä¾›åŸºäºè¯­ä¹‰ã€å¥å­è¾¹ç•Œçš„æ–‡æ¡£åˆ†å‰²å™¨ï¼Œè€Œä¸æ˜¯ç®€å•çš„æŒ‰ç…§å­—ç¬¦æ•°ç¡¬åˆ‡å‰²ï¼Œä»–çš„æ ¸å¿ƒç‰¹ç‚¹å°±æ˜¯ä¼˜å…ˆä»¥è‡ªç„¶å¥å­ä¸ºåˆ†å‰²è¾¹ç•Œï¼Œæ¯”å¦‚æ®µè½ä¸­çš„åˆ†éš”ç¬¦ï¼Œå¥å·ã€é€—å·å’Œæ„Ÿå¹å·ç­‰ï¼Œé¿å…åˆ‡å‰²åˆ°å¥å­ä¸­é—´å¯¼è‡´è¯­ä¹‰æ–­è£‚ï¼›åŒæ—¶è¿˜å…¼é¡¾é¢„è®¾çš„åˆ†å—å¤§å°é™åˆ¶ï¼Œåœ¨è¯­ä¹‰å®Œæ•´å’Œåˆ†å—å°ºå¯¸ä¹‹é—´åšå¹³è¡¡ï¼Œè¿™ä¸ªä¹Ÿæ˜¯<code>LlamaIndex</code>ä¸­æœ€å¸¸ç”¨ã€æœ€æ¨èçš„æ–‡æ¡£åˆ†å‰²å™¨ã€‚</p>
<p><code>SentenceSplitter</code>çš„ä¸¤ä¸ªå‚æ•°ï¼Œ<code>chunk_size</code>å°±æ˜¯å†™ä¸ªæ–‡æœ¬å—(chunk)çš„æœ€å¤§ä»¤ç‰Œæ•°é™åˆ¶ï¼Œé€šå¸¸æ ¹æ®llmä¸Šä¸‹æ–‡çª—å£çš„å¤§å°è®¾å®šçš„ï¼›<code>chunk_overlap</code>æ˜¯ç›¸é‚»ä¸¤ä¸ªæ–‡æœ¬å—ä¹‹é—´çš„é‡å ä»¤ç‰Œæ•°é‡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†ä¿æŒæ–‡æœ¬ä¸Šä¸‹æ–‡çš„è¿ç»­æ€§ï¼Œé¿å…å› ä¸ºåˆ†å—å¯¼è‡´çš„è¯­ä¹‰æ–­å±‚ã€‚</p>
<p>æœ€ç»ˆè¾“å‡ºçš„<code>nodes</code>å°±æ˜¯ä¸€ä¸ª<code>Node</code>çš„åˆ—è¡¨</p>
</li>
<li>
<p><strong>Embeddings</strong>ï¼šå°†æ–‡æœ¬è½¬åŒ–ä¸ºå‘é‡è¡¨ç¤ºã€‚</p>
<p>è¿™é‡Œå°±æ˜¯ä½¿ç”¨æ¨¡å‹å°†<code>Node</code>æ•°ç»„è½¬æ¢ä¸ºå‘é‡ï¼Œæ¯”å¦‚ä¹‹å‰çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">Settings.embed_model</span> = HuggingFaceEmbedding(
 Â  Â <span class="hljs-attr">model_name</span>=<span class="hljs-string">"BAAI/bge-small-zh-v1.5"</span> Â <span class="hljs-comment"># é€‚åˆä¸­æ–‡çš„å‘é‡æ¨¡å‹</span>
)
</code></pre>
</li>
<li>
<p><strong>Index</strong>ï¼šå¯æŸ¥è¯¢çš„æ•°æ®ç»“æ„ã€‚</p>
<p>è¿™é‡Œçš„<code>Index</code>æ˜¯ä¸€ç§å°†<code>Node</code>ç»„ç»‡ä¸ºå¯æŸ¥è¯¢ç»“æ„çš„æ•°æ®ç»“æ„ï¼Œ<code>LlamaIndex</code>æä¾›äº†å¾ˆå¤šç§ç´¢å¼•ç±»å‹ï¼Œ</p>
<ul>
<li><code>VectorStoreIndex</code> å°†æ–‡æœ¬å—è½¬ä¸ºé«˜ç»´ç¨ å¯†å‘é‡ï¼ˆEmbeddingï¼‰ï¼ŒåŸºäºè¯­ä¹‰ç›¸ä¼¼æ€§æ£€ç´¢ï¼Œè¿™é‡Œçš„è¯­ä¹‰ç›¸ä¼¼åº¦æ£€ç´¢å°±æ˜¯ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ï¼Œé€šè¿‡è®¡ç®—å‘é‡çš„å¤¹è§’æ¥å¯¹æ¯”åŒ¹é…çš„ç›¸å…³å†…å®¹ï¼Œå®ç°æ‡‚æ„å›¾çš„è¯­ä¹‰æ£€ç´¢ã€‚è¿™ä¸ªé€‚åˆç»å¤§å¤šæ•°çš„<code>RAG</code>åœºæ™¯ï¼Œä¹Ÿæ˜¯æœ€é€šç”¨çš„ä¸€ä¸ª<code>Index</code>ç´¢å¼•ç±»å‹</li>
<li><code>SummaryIndex</code> æ— å¤æ‚æ£€ç´¢é€»è¾‘ï¼Œç›´æ¥å°†å…¨é‡æ–‡æ¡£ / Node è¾“å…¥ LLM è¿›è¡Œæ€»ç»“æˆ–é—®ç­” ï¼Œé…ç½®æç®€ã€æ— éœ€åµŒå…¥æ¨¡å‹ã€ä¿ç•™æ–‡æœ¬å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œé€‚åˆè¶…çŸ­æ–‡æ¡£ï¼ˆå‡ ç™¾å­—å†…ï¼‰çš„åœºæ™¯ã€‚</li>
<li><code>KeywordTableIndex</code> ä»æ–‡æ¡£ä¸­æå–æ ¸å¿ƒå…³é”®è¯ï¼Œæ„å»ºã€Œå…³é”®è¯ - æ–‡æ¡£å—ã€æ˜ å°„è¡¨ï¼ŒåŸºäºå­—é¢å…³é”®è¯åŒ¹é…æ£€ç´¢ ï¼Œ é€‚åˆå…³é”®è¯æ˜ç¡®çš„çŸ­æ–‡æ¡£æ£€ç´¢ ï¼Œæ¯”å¦‚åŸºäºäº§å“ç¼–å·ã€è®¢å•å·æŸ¥è¯¢</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">3.3 é˜¶æ®µä¸‰ï¼šå­˜å‚¨ (Storing)</h3>
<p>å­˜å‚¨é˜¶æ®µæ˜¯å°†æ„å»ºå¥½çš„ç´¢å¼•æ•°æ®æŒä¹…åŒ–çš„ç¯èŠ‚ï¼Œä¸»è¦åŸºäºè¿™ä¸¤ä¸ªç±»æ¥å®ç°çš„ï¼š</p>
<ul>
<li>
<p><strong>StorageContext</strong>ï¼šæŒä¹…åŒ–ç´¢å¼•çš„æœºåˆ¶ã€‚</p>
<p><code>StorageContext</code>æ˜¯ä¸“é—¨ç”¨äºå°è£…ã€ç®¡ç†æ‰€æœ‰ç´¢å¼•ç›¸å…³å­˜å‚¨ç»„ä»¶çš„ä¸Šä¸‹æ–‡å®¹å™¨ï¼Œä¹Ÿæ˜¯å®ç°ç´¢å¼•æŒä¹…åŒ–ã€ä»å­˜å‚¨ä¸­åŠ è½½ç´¢å¼•çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<p>çœ‹ä¸‹æ–‡æ¡£ä¸­ç»™çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from llama_index.storage.storage_context import StorageContext
from llama_index.vector_stores import ChromaVectorStore
from llama_index import VectorStoreIndex
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡å­˜å‚¨ï¼ˆChromaï¼‰</span>
<span class="hljs-attr">vector_store</span> = ChromaVectorStore(collection_name=<span class="hljs-string">"my_docs"</span>)
â€‹
<span class="hljs-comment"># åˆ›å»º StorageContext</span>
<span class="hljs-attr">storage_context</span> = StorageContext.from_defaults(vector_store=vector_store)
â€‹
<span class="hljs-comment"># ä½¿ç”¨ StorageContext æ„å»º Index</span>
<span class="hljs-attr">index</span> = VectorStoreIndex.from_documents(
 Â  Â documents,
 Â  Â <span class="hljs-attr">storage_context</span>=storage_context
)
â€‹
<span class="hljs-comment"># æŒä¹…åŒ– Index</span>
index.storage_context.persist()
</code></pre>
<p><code>ChromaVectorStore</code>æ˜¯<code>LlamaIndex</code>å¯¹å¼€æºå‘é‡åº“<code>Chroma</code>çš„å°è£…ï¼Œ<code>ChromaVectorStore(collection_name="my_docs")</code>å°±æ˜¯åˆ›å»ºä¸€ä¸ªåå­—å«åš<code>my_docs</code>çš„é›†åˆï¼Œç”¨æ¥å­˜å‚¨å‘é‡ï¼›<code>StorageContext.from_defaults(vector_store=vector_store)</code>å°±æ˜¯å¿«é€Ÿåˆ›å»ºä¸€ä¸ª<code>StorageContext</code>ï¼Œåç»­åœ¨æ„å»ºç´¢å¼•çš„æ—¶å€™ï¼Œä¼ å…¥åˆ›å»ºçš„<code>storage_context</code>ï¼Œè¿™æ ·å°±çŸ¥é“å‘é‡è¦å­˜å‚¨çš„åœ°æ–¹ï¼›è€Œ<code>VectorStoreIndex</code>å°±æ˜¯å‰é¢ä»‹ç»çš„å°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡çš„<code>Index</code>ç±»å‹ï¼Œ æœ€ç»ˆè¿”å›çš„<code>index</code> æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥ <code>as_query_engine()</code> / <code>as_retriever()</code> çš„ç´¢å¼•å¯¹è±¡ ï¼›<code>index.storage_context</code>å°±æ˜¯å‰é¢ä¼ é€’çš„<code>storage_context</code>ï¼Œ<code>persist()</code>æ–¹æ³•å°±æ˜¯å°†å‘é‡å­˜å‚¨åˆ°ç£ç›˜ä¸­ï¼›è¿™æ ·ä¸‹æ¬¡ç¨‹åºå¯åŠ¨æ—¶ï¼Œå¯ä»¥é‡æ–°åˆ›å»ºåŒæ ·çš„<code>ChromaVectorStore</code>ï¼Œå°±ä¸ç”¨åœ¨ä»åŸå§‹çš„<code>Document</code>ä¸­é‡æ–°åˆ›å»ºç´¢å¼•ã€‚</p>
</li>
<li>
<p><strong>Vector Store</strong>ï¼šå‘é‡æ•°æ®åº“</p>
<p>å‘é‡æ•°æ®åº“å°±æ˜¯ç”¨æ¥åšå‘é‡çš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œç„¶åæŒä¹…åŒ–å­˜å‚¨å‘é‡ï¼Œåç»­é¿å…é‡å¤åˆ›å»ºï¼ŒåŒæ—¶ä¹Ÿä¼šåšç›¸é€Ÿåº¦æœç´¢ã€‚</p>
<p>å¸¸è§çš„æœ‰</p>
<ul>
<li>Chroma ä¸€ä¸ªå¼€æºçš„å‘é‡æ•°æ®åº“ï¼Œæ”¯æŒæœ¬åœ°åµŒå…¥ï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²</li>
<li>Pinecone è¿è¡Œé‡æ•°æ®åº“ï¼Œæ”¯æŒé«˜æ€§èƒ½æ£€ç´¢å’Œè‡ªåŠ¨æ‰©å®¹</li>
<li>FAISS æœ¬åœ°å‘é‡æ•°æ®åº“ï¼Œé€‚åˆå¤§è§„æ¨¡å¿«é€Ÿè®¡ç®—</li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">3.4 é˜¶æ®µå››ï¼šæŸ¥è¯¢ (Querying)</h3>
<p>è¿™ä¸ªæ˜¯å¯¹ç”¨æˆ·çœŸæ­£äº§ç”Ÿä»·å€¼çš„é˜¶æ®µï¼Œå°±æ˜¯åœ¨å·²æœ‰ç´¢å¼•çš„åŸºç¡€ä¸Šï¼Œæ£€ç´¢æœ€ç›¸å…³çš„ä¸Šä¸‹æ–‡ï¼Œç»“åˆç”¨æˆ·é—®é¢˜ï¼Œç”Ÿæˆå¯æ§ã€å¯è¿½æº¯çš„å›ç­”ã€‚</p>
<ul>
<li>
<p><strong>Retriever</strong></p>
<p>æ ¹æ®ä¸€äº›æŒ‡å®šçš„ç­–ç•¥æ¥æ£€ç´¢ç›¸å…³çš„<code>Node</code>ï¼Œä¸»è¦æœ‰è¿™æ ·ä¸€äº›ç­–ç•¥</p>
<ul>
<li>Similarity Search åŸºäºå‘é‡ç›¸é€Ÿåº¦</li>
<li>Top-K è¿”å›æœ€ç›¸ä¼¼çš„Kä¸ªNode</li>
<li>Metadata Filter æŒ‰ç…§metadataè¿‡æ»¤</li>
<li>Hybrid Search å‘é‡åŠ å…³é”®å­—</li>
</ul>
</li>
<li>
<p><strong>Response Synthesizer</strong></p>
<p>å°†æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å’ŒæŸ¥è¯¢ç»“åˆï¼Œç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚å®ƒå…³æ³¨çš„é—®é¢˜æ˜¯å¦‚ä½•ç»„ç»‡ä¸Šä¸‹æ–‡ï¼Œå¦‚ä½•è°ƒç”¨llmå’Œå¦‚ä½•é¿å…å¹»è§‰ã€‚</p>
<p>åœ¨ LlamaIndex ä¸­ï¼ŒæŸ¥è¯¢é˜¶æ®µé€šè¿‡ Retriever ç²¾å‡†å¬å›ç›¸å…³ Nodeï¼Œå†ç”± Response Synthesizer ç»„ç»‡ä¸Šä¸‹æ–‡å¹¶ç”Ÿæˆå›ç­”ï¼Œå®ç°äº†æ£€ç´¢ä¸ç”Ÿæˆçš„æ¸…æ™°è§£è€¦ï¼Œæ˜¯ RAG ç³»ç»Ÿå¯æ§æ€§ä¸è´¨é‡çš„æ ¸å¿ƒä¿éšœã€‚</p>
</li>
</ul>
<h3 data-id="heading-10">3.5 é˜¶æ®µäº”ï¼šè¯„ä¼° (Evaluation)</h3>
<p>å½“æ„å»ºä¸€ä¸ª<code>RAG</code>ç³»ç»Ÿåï¼Œä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜å°±æ˜¯å¦‚ä½•ç§‘å­¦çš„è¯„ä¼°å®ƒçš„è¡¨ç°ï¼Œå¦‚ä½•é‡åŒ–çš„è¿½è¸ªã€è¿­ä»£å¹¶æå‡<code>RAG</code>åº”ç”¨çš„æ€§èƒ½ï¼Œå½“ç³»ç»Ÿå‡ºç°å¹»è§‰æ—¶å¦‚ä½•å¿«é€Ÿçš„å®šä½é—®é¢˜ï¼Œè¿™éƒ½æ˜¯å¯¹äºå¼€å‘è€…æ¥è¯´éå¸¸å…³é”®çš„ã€‚</p>
<p>æ–‡æ¡£å¯¹äº<code>RAG</code>ç³»ç»Ÿçš„è¯„ä¼°ä¸»è¦èšç„¦äºè§£å†³ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>
<ul>
<li>
<p>æ£€ç´¢è´¨é‡</p>
<p>æ£€ç´¢æ˜¯å¦æŠŠä¸é—®é¢˜æœ€ç›¸å…³çš„ä¿¡æ¯æ‰¾å‡ºæ¥ï¼Œæœ‰æ²¡æœ‰é—æ¼å…³é”®ä¿¡æ¯ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªè¡¡é‡æŒ‡æ ‡ï¼šRecall@Kï¼Œåœ¨æ£€ç´¢è¿”å›çš„å‰<code>k</code>ä¸ªæ–‡æ¡£å—ä¸­æ˜¯å¦åŒ…å«è‡³å°‘ä¸€ä¸ªäºqueryç›¸å…³çš„æ­£ç¡®æ–‡æ¡£ï¼Œè¡¡é‡æ£€ç´¢çš„å¬å›èƒ½åŠ›</p>
</li>
<li>
<p>ç”Ÿæˆè´¨é‡</p>
<p>ç”Ÿæˆè´¨é‡ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªè¯„ä¼°ç»´åº¦ï¼šå›ç­”äº‹å®ä¸€è‡´æ€§ï¼Œä¸»è¦çœ‹ç”Ÿæˆçš„å†…å®¹æ˜¯å¦ä¸¥æ ¼åŸºäºæ£€ç´¢ä¸Šä¸‹æ–‡ï¼Œè€Œéæ¨¡å‹è‡ªèº«çš„å¹»è§‰è¡¥å…¨ï¼›å›ç­”ç›¸å…³æ€§ï¼šçœ‹å›ç­”æ˜¯å¦çœŸæ­£è§£å†³äº†ç”¨æˆ·çš„é—®é¢˜ï¼Œæ˜¯å¦å­˜åœ¨çœ‹ä¼¼åˆç†ä½†ç­”éæ‰€é—®çš„æƒ…å†µï¼›è¦†ç›–åº¦ä¸ç®€æ´æ€§ï¼šæ˜¯å¦é—æ¼ç›¸å…³ä¿¡æ¯ï¼Œæˆ–è€…å¼•å…¥ä¸é—®é¢˜æ— å…³çš„å†—ä½™å†…å®¹</p>
</li>
<li>
<p>ç«¯åˆ°ç«¯RAGæ€§èƒ½</p>
<p>ç«¯åˆ°ç«¯å…³æ³¨çš„é—®é¢˜æ˜¯ï¼šä»ç”¨æˆ·æé—®åˆ°æœ€ç»ˆç­”æ¡ˆï¼Œç³»ç»Ÿæ•´ä½“æ˜¯å¦çœ‹èµ·æ¥åƒä¸€ä¸ªå¯é çš„ä¸“å®¶ï¼Œè¿™é‡Œéœ€è¦å…³æ³¨ä¸€äº›æœ€ç»ˆç­”æ¡ˆçš„æ­£ç¡®ç‡ã€å¯ç”¨æ€§ï¼Œé”™è¯¯ç±»å‹åˆ†å¸ƒå’Œå“åº”æ—¶é—´ä¸æˆæœ¬ç­‰ã€‚å½“ç³»ç»Ÿå‡ºç°å¹»è§‰æˆ–è€…é”™è¯¯æ—¶ï¼Œå¯ä»¥åå‘æ‹†è§£å®šä½é—®é¢˜ç©¶ç«Ÿå‡ºç°åœ¨æ£€ç´¢å±‚ã€ç”Ÿæˆå±‚ï¼Œè¿˜æ˜¯ä¸¤è€…çš„ååŒç­–ç•¥ä¸Šï¼Œä»è€ŒæŒ‡å¯¼ä¸‹ä¸€è½®çš„ä¼˜åŒ–ã€‚</p>
</li>
</ul>
<p>è¿™é‡Œéƒ½æ˜¯ä¸€äº›æ¦‚å¿µæ€§çš„ä¸œè¥¿ï¼Œè‡ªå·±çœ‹çš„æ—¶å€™ä¹Ÿæ˜¯æ··ä¸ªçœ¼ç†Ÿï¼Œç»ˆå½’è¿˜æ˜¯è¦è½åˆ°ä»£ç ç¯èŠ‚ã€‚åé¢åšä¸€ä¸ªèœè°±çš„æ™ºèƒ½é—®é¢˜ç³»ç»Ÿå®æˆ˜ï¼Œåº”è¯¥å¯¹RAGæœ‰ä¸ªæ›´åŠ æ·±å…¥çš„ç†è§£ã€‚è¿™é‡Œæ¨èä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fdatawhalechina.github.io%2Fall-in-rag%2F%23%2F" target="_blank" title="https://datawhalechina.github.io/all-in-rag/#/" ref="nofollow noopener noreferrer">æ•™ç¨‹</a>ï¼Œæˆ‘ä¹Ÿæ˜¯é€šè¯»äº†ä¸€éï¼Œä½†æ˜¯è¿™ç§å¥½æ–‡ç« çœ‹å‡ ééƒ½ä¸ä¸ºè¿‡ï¼Œåº”è¯¥æ˜¯é˜¿é‡Œæå¾—ç¤¾åŒºï¼Œå¾ˆä¸é”™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Wiresharkã€Fiddlerã€CharlesæŠ“åŒ…å·¥å…·è¯¦ç»†ä½¿ç”¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7598464972912623656</link>    <guid>https://juejin.cn/post/7598464972912623656</guid>    <pubDate>2026-01-24T09:25:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598464972912623656" data-draft-id="7598464972912607272" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Wiresharkã€Fiddlerã€CharlesæŠ“åŒ…å·¥å…·è¯¦ç»†ä½¿ç”¨æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:25:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2390811467846089"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Wiresharkã€Fiddlerã€CharlesæŠ“åŒ…å·¥å…·è¯¦ç»†ä½¿ç”¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2390811467846089/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:25:35.000Z" title="Sat Jan 24 2026 09:25:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æŠ“åŒ…å·¥å…·</strong></p>
<h2 data-id="heading-0">1.1Â Â Â Â Â  å¸¸ç”¨æŠ“åŒ…å·¥å…·</h2>
<p>å¸¸ç”¨çš„æŠ“åŒ…å·¥å…·æœ‰ï¼šWiresharkã€Fiddlerã€Charlesã€‚æ­¤å¤–ï¼ŒSniffmasterä½œä¸ºä¸€æ¬¾å…¨å¹³å°æŠ“åŒ…å·¥å…·ï¼Œæ”¯æŒHTTPSã€TCPå’ŒUDPåè®®ï¼Œå¯åœ¨iOS/Android/Mac/Windowsè®¾å¤‡ä¸Šå®ç°æ— éœ€ä»£ç†ã€è¶Šç‹±æˆ–rootçš„æŠ“åŒ…æ“ä½œã€‚</p>
<p>Wiresharkã€Fiddlerã€Charlesçš„ä¼˜ç¼ºç‚¹ï¼š</p>
<p>â‘ Wiresharkæ˜¯ä¸€ç§åœ¨ç½‘ç»œå±‚ä¸Šå·¥ä½œçš„æŠ“åŒ…å·¥å…·ï¼Œä¸ä»…è‡ªå¸¦å¤§é‡çš„åè®®åˆ†æå™¨ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡ç¼–å†™Wiresharkæ’ä»¶æ¥è¯†åˆ«è‡ªå®šä¹‰çš„åè®®ã€‚è™½ç„¶WiresharkåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å´å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰çš„æŠ“åŒ…é—®é¢˜ï¼Œå…¶åŸå› åœ¨äºï¼šWiresharkå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼›å¦‚æœè®¡ç®—æœºé…ç½®äº†IPSecä¼ è¾“å±‚åŠ å¯†ï¼Œåˆ™åœ¨ç½‘ç»œå±‚çš„æµé‡éƒ½å·²ç»è¢«åŠ å¯†ï¼Œä»€ä¹ˆä¹Ÿçœ‹ä¸åˆ°ã€‚å½“ä»Šå¤§é‡ç½‘ç»œæ¥å£ä½¿ç”¨HTTPSåŠ å¯†ï¼ŒWiresharkä¸èƒ½æŠ“å–åˆ°HTTPSæµé‡çš„æ˜æ–‡å†…å®¹ã€‚</p>
<p>â‘¡Fiddlerå’ŒCharleså·¥ä½œåœ¨åº”ç”¨å±‚ä¸Šï¼Œä½œä¸ºå…¶ä»–ç¨‹åºçš„HTTPä»£ç†æœåŠ¡å™¨ã€‚å®ƒå¯ä»¥ç›´æ¥æŠ“å–å¹¶åˆ†æHTTPæµé‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºâ€œä¸­é—´äººâ€æŠ“å–å¹¶åˆ†æHTTPSæµé‡ã€‚</p>
<h2 data-id="heading-1">1.2Â Â Â Â Â  å‚è€ƒèµ„æ–™</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fkristin%2Fp%2F8445141.html" target="_blank" title="https://www.cnblogs.com/kristin/p/8445141.html" ref="nofollow noopener noreferrer">www.cnblogs.com/kristin/p/8â€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fsb%255C%255C_%255C%255C_%255C%255C_itfk%2Farticle%2Fdetails%2F45250771" target="_blank" title="https://blog.csdn.net/sb%5C%5C_%5C%5C_%5C%5C_itfk/article/details/45250771" ref="nofollow noopener noreferrer">blog.csdn.net/sb\\_\\_\\_â€¦</a></p>
<h2 data-id="heading-2">2.1Â Â Â Â Â  wiresharkä½¿ç”¨</h2>
<h2 data-id="heading-3">2.1.1 Â æŠ“å–æ•°æ®åŒ…</h2>
<ol>
<li>é€‰æ‹©æŠ“åŒ…ç½‘å£ï¼Œé€‰æ‹©æŠ“åŒ…ç½‘å£æœ‰ä¸¤ç§æ–¹å¼</li>
</ol>
<p>lÂ  ç¬¬ä¸€ç§ï¼Œå¯åŠ¨wiresharkåï¼Œç›´æ¥åŒå‡»ä»¥å¤ªç½‘ï¼Œå°±ä¼šå¼€å§‹æŠ“åŒ…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edd30c3b78ee4bedb24e1e84abe245ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=hdQy4%2BKSqIpAyAvngExoOC9I%2B54%3D" alt="" loading="lazy"/></p>
<p>lÂ  ç¬¬äºŒç§ï¼Œå¯åŠ¨wiresharkåï¼Œç‚¹å‡»æ•è·â€”&gt;&gt;é€‰é¡¹ã€‚åœ¨å¼¹å‡ºæ¡†ä¸­é€‰æ‹©ç½‘å¡ä»¥åŠé…ç½®è¿‡æ»¤æ¡ä»¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0739fec9620469fbde20b2f7616ce09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=%2BZwbQ2MPEx9efEt9TmTv9GGo3CU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6babb79bea514dbaa77310ba073ff48c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=8vzFN6mgrFKyEAcXz7l6nK2OyAg%3D" alt="" loading="lazy"/></p>
<ol>
<li>åœæ­¢æŠ“åŒ…ï¼Œç‚¹å‡»åœæ­¢åï¼Œå¯ä»¥å°†æ•è·çš„æ•°æ®åŒ…ä¿å­˜ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82292e776a2c4288a61460b54c078923~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=8JSOVqM3%2FFfsn%2BkpkTVq9Arkuww%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4843c120792449a88a93ec4624a112ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=NYvvB1poutTj4oLilLJUOd4HaYs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">2.1.2 Â å¸¸ç”¨è¿‡æ»¤ã€åˆ†æ</h2>
<p>æ•è·çš„æ•°æ®åŒ…æ¯”è¾ƒå¤šï¼Œå¯ä»¥é€šè¿‡ä¸€äº›è¯­æ³•è¿›è¡Œç­›é€‰ã€‚</p>
<ol>
<li>æ ¹æ®ipåœ°å€è¿›è¡Œç­›é€‰ï¼Œè¯­æ³•å¦‚ä¸‹ip.addr==192.168.0.121ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78e84a52fa79405fac476cd4515dc7b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=NAaC3agc5130gtuLg7nlKixUK9M%3D" alt="" loading="lazy"/></p>
<ol>
<li>æ ¹æ®http.requestè¿‡æ»¤æ‰€æœ‰httpè¯·æ±‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d21768103a74b0abb8250c81b7fdd86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=judQyl1wPT3FGFc3w1GCT2rDDlw%3D" alt="" loading="lazy"/></p>
<ol>
<li>æ ¹æ®å…³é”®å­—æŸ¥è¯¢</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95374a42daa748d7a35b849077b5ccc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=0W3HFqRDGWLYanaLPtZWTJnPvuQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">2.1.3 æŸ¥çœ‹æ•è·çš„æ•°æ®</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/562deb583fa44814be662fc07540029e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=g0GtfsOmd0zWaIwshSjKK%2BPuRbo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">2.2Â Â Â Â Â  Fiddlerä½¿ç”¨</h2>
<h2 data-id="heading-7">2.2.1 Â æŠ“å–æ•°æ®åŒ…</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab4f8e38c14c482ebc68a8a242628967~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=UxQY8U0A3dnZTNvI0YSuN5p4c%2Bc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">2.2.2 Â æœç´¢ä¼šè¯</h2>
<p>æŒ‰ä½ctrl+F,è¾“å…¥å…³é”®å­—ï¼Œç‚¹å‡»find sessionï¼Œè¿›è¡Œæœç´¢</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6aa9b1158ff64b64b1926bf19c318e14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=NN%2BB0xBTeNemHvImfxTOjlCyB5I%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">2.2.3 Â æŸ¥çœ‹ä¼šè¯</h2>
<p>é€‰æ‹©ä¸€ä¸ªä¼šè¯ï¼Œæ ¹æ®ç»“æœçš„è¯·æ±‚/å“åº”çš„ä¸åŒæ•°æ®ç±»å‹ï¼Œæ˜¾ç¤ºä¼šè¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce7b04e25f1e428fa5fa500079aae0e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=%2FQ3EjL4SnyS3Znk%2FKujhPj1TRMs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">2.2.4 Â è®¾ç½®ä»£ç†</h2>
<ol>
<li>Tools-&gt; Fiddler Options</li>
</ol>
<p>é€‰ä¸­"Allow remote computers to connect". æ˜¯å…è®¸åˆ«çš„æœºå™¨æŠŠHTTP/HTTPSè¯·æ±‚å‘é€åˆ°Fiddlerä¸Šæ¥</p>
<p>è®°ä½è¿™ä¸ªç«¯å£å·æ˜¯:8888ï¼Œé€šè¿‡ipconfigæŸ¥çœ‹æœ¬æœºçš„ipï¼Œå¦‚æœ¬æœºipä¸º192.168.2.11</p>
<ol>
<li>åœ¨æ‰‹æœºä¸Šè¿›è¡Œä»£ç†è®¾ç½®</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51f6f245c75b4478a02334501e870b50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=WtVddGOwjqey30fIxcipm6kTgqg%3D" alt="" loading="lazy"/></p>
<ol>
<li>ä¸‹è½½Fiddlerçš„å®‰å…¨è¯ä¹¦</li>
</ol>
<p>ä½¿ç”¨androidæ‰‹æœºçš„æµè§ˆå™¨æ‰“å¼€ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.2.11%3A8888%25EF%25BC%258C" target="_blank" title="http://192.168.2.11:8888%EF%BC%8C" ref="nofollow noopener noreferrer">http://192.168.2.11:8888ï¼Œ</a> ç‚¹"FiddlerRoot certificate"ï¼Œç„¶åå®‰è£…è¯ä¹¦ã€‚</p>
<p>å®‰è£…å®Œæˆåï¼Œå°±å¯ä»¥åœ¨fiddlerä¸Šçœ‹åˆ°æ‰‹æœºçš„HTTPè¯·æ±‚</p>
<h2 data-id="heading-11">2.2.5 Â æŠ“å–HTTPSæ•°æ®åŒ…</h2>
<p>lÂ  FiddleræŠ“å–HTTPSæ•°æ®åŒ…è¿‡ç¨‹åŸç†ï¼š</p>
<p>lÂ  fiddleræ¥åˆ°å®¢æˆ·ç«¯çš„httpsè¯·æ±‚ï¼Œfiddlerå°†è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨</p>
<p>lÂ  æœåŠ¡å™¨ç”Ÿæˆå…¬é’¥è¯ä¹¦ï¼Œè¿”å›ç»™fiddlerï¼›fiddleræ‹¦æˆªä¸‹çœŸçš„å…¬é’¥è¯ä¹¦ï¼Œå¹¶ç”Ÿæˆä¼ªé€ çš„å…¬é’¥è¯ä¹¦ç»™å®¢æˆ·ç«¯ï¼›</p>
<p>lÂ  å®¢æˆ·ç«¯ä½¿ç”¨ä¼ªé€ çš„å…¬é’¥è¯ä¹¦åŠ å¯†å…±äº«å¯†é’¥å‘é€ç»™fiddlerï¼Œfiddlerä½¿ç”¨ä¼ªé€ çš„ç§é’¥è§£å¯†è·å–å…±äº«å¯†é’¥</p>
<p>lÂ  fiddlerå°†è§£å¯†åçš„å…±äº«å¯†é’¥ï¼Œä½¿ç”¨çœŸæ­£çš„å…¬é’¥åŠ å¯†å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ä½¿ç”¨å…±äº«å¯†é’¥ä¸fiddleré€šä¿¡</p>
<p>lÂ  fiddlerä½¿ç”¨å…±äº«å¯†é’¥ä¸å®¢æˆ·ç«¯é€šä¿¡</p>
<ol>
<li>è®¾ç½®æŠ“å–HTTPSï¼ŒPCæœºå®‰è£…æ ¹è¯ä¹¦ï¼š</li>
</ol>
<p>Tools-&gt;options-&gt;HTTPS-&gt;capture https connects-&gt;decrypt https traffic-&gt;ignore server certificate errors(unsafe)-&gt;actions-&gt;trust root certificate-&gt;ç¡®å®š-&gt;OK</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd09bcb28794422595e6621010ee9a98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=0SYYQUgA3v3WlLwkMYbyLCDP2BQ%3D" alt="" loading="lazy"/></p>
<ol>
<li>å®‰è£…æ ¹è¯ä¹¦åï¼Œå¯ä»¥ç‚¹å‡»Actions-&gt;open windows certificate manageræŸ¥çœ‹å®‰è£…åˆ°ç³»ç»Ÿçš„æ ¹è¯ä¹¦</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9a5dbda63fb4b95810198411714a0dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769851535&amp;x-signature=Xe06AzrHK9b7JxtS%2BXxSRzXIduM%3D" alt="" loading="lazy"/></p>
<p>å¯¹äºéœ€è¦æ— éœ€ä»£ç†çš„HTTPSæŠ“åŒ…ï¼ŒSniffmasteræä¾›äº†æš´åŠ›æŠ“åŒ…æ¨¡å¼ï¼Œç›´æ¥è§£å¯†HTTPSæµé‡ï¼Œæ”¯æŒæŒ‡å®šAPPè¿‡æ»¤å’ŒåŒå‘éªŒè¯çˆ†ç ´ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‹¹æœiOSåº”ç”¨ä¸Šæ¶App Storeå®Œæ•´æµç¨‹ä¸æ³¨æ„äº‹é¡¹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7598827845965201434</link>    <guid>https://juejin.cn/post/7598827845965201434</guid>    <pubDate>2026-01-24T09:52:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598827845965201434" data-draft-id="7598532592455860251" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‹¹æœiOSåº”ç”¨ä¸Šæ¶App Storeå®Œæ•´æµç¨‹ä¸æ³¨æ„äº‹é¡¹æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:52:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2390811467846089"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‹¹æœiOSåº”ç”¨ä¸Šæ¶App Storeå®Œæ•´æµç¨‹ä¸æ³¨æ„äº‹é¡¹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2390811467846089/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:52:01.000Z" title="Sat Jan 24 2026 09:52:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è‹¹æœiOSä¸Šæ¶æ˜¯æŒ‡å°†å¼€å‘è€…å¼€å‘çš„åº”ç”¨ç¨‹åºæäº¤åˆ°è‹¹æœå…¬å¸çš„App Storeä¸­ï¼Œç»è¿‡å®¡æ ¸åä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨App Storeä¸­æ­£å¼ä¸Šæ¶å¹¶ä¾›ç”¨æˆ·ä¸‹è½½ä½¿ç”¨ã€‚ä¸‹é¢å°†è¯¦ç»†ä»‹ç»iOSä¸Šæ¶çš„æµç¨‹å’Œæ³¨æ„äº‹é¡¹ã€‚</p>
<p>ä¸€ã€å¼€å‘é˜¶æ®µ</p>
<p>åœ¨å¼€å‘é˜¶æ®µï¼Œå¼€å‘è€…éœ€è¦éµå¾ªè‹¹æœå…¬å¸çš„ç›¸å…³è§„å®šå’Œè¦æ±‚è¿›è¡Œå¼€å‘ã€‚å…·ä½“åŒ…æ‹¬ï¼š</p>
<p>1.ä½¿ç”¨Appleå®˜æ–¹æä¾›çš„å¼€å‘å·¥å…·Xcodeè¿›è¡Œå¼€å‘ã€‚</p>
<p>2.éµå¾ªè‹¹æœå…¬å¸çš„äººæœºäº¤äº’è®¾è®¡æŒ‡å—ï¼Œè®¾è®¡ç¬¦åˆç”¨æˆ·ä½“éªŒçš„åº”ç”¨ç¨‹åºã€‚</p>
<p>3.éµå¾ªè‹¹æœå…¬å¸çš„ç¼–ç è§„èŒƒï¼Œç¼–å†™ç¬¦åˆè§„èŒƒçš„ä»£ç ã€‚</p>
<p>4.éµå¾ªè‹¹æœå…¬å¸çš„éšç§æ”¿ç­–å’Œæ•°æ®ä¿æŠ¤è¦æ±‚ï¼Œä¿æŠ¤ç”¨æˆ·éšç§ã€‚</p>
<p>5.åœ¨åº”ç”¨ç¨‹åºä¸­é›†æˆAppleæä¾›çš„æ”¯ä»˜å’Œå¹¿å‘ŠæœåŠ¡ã€‚</p>
<p>äºŒã€æäº¤åº”ç”¨ç¨‹åº</p>
<p>åœ¨å¼€å‘å®Œæˆåï¼Œå¼€å‘è€…éœ€è¦å°†åº”ç”¨ç¨‹åºæäº¤åˆ°è‹¹æœå…¬å¸çš„App Storeä¸­è¿›è¡Œå®¡æ ¸ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<p>1.æ³¨å†Œæˆä¸ºè‹¹æœå¼€å‘è€…ã€‚</p>
<p>2.åœ¨Appleå¼€å‘è€…ç½‘ç«™ä¸­åˆ›å»ºApp IDï¼Œå¹¶ä¸ºåº”ç”¨ç¨‹åºç”³è¯·è¯ä¹¦å’Œæè¿°æ–‡ä»¶ã€‚å¼€å‘è€…ä¹Ÿå¯ä»¥ä½¿ç”¨AppUploaderå·¥å…·è¿›è¡ŒiOSè¯ä¹¦çš„ç”³è¯·å’Œç®¡ç†ï¼Œç®€åŒ–è¯ä¹¦åˆ›å»ºæµç¨‹ã€‚</p>
<p>3.åœ¨Xcodeä¸­æ‰“åŒ…åº”ç”¨ç¨‹åºå¹¶ç”ŸæˆIPAæ–‡ä»¶ã€‚æ­¤å¤–ï¼ŒAppUploaderæ”¯æŒåœ¨Windowsã€Linuxæˆ–Macç³»ç»Ÿä¸­ç›´æ¥ä¸Šä¼ IPAæ–‡ä»¶åˆ°App Storeï¼Œæ— éœ€Macç”µè„‘ï¼Œæ“ä½œæ›´ä¾¿æ·ã€‚</p>
<p>4.åœ¨Appleå¼€å‘è€…ç½‘ç«™ä¸­åˆ›å»ºApp Store Connectè®°å½•ï¼Œå¹¶ä¸Šä¼ IPAæ–‡ä»¶ã€‚</p>
<p>5.å¡«å†™åº”ç”¨ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬åç§°ã€æè¿°ã€å›¾æ ‡ã€æˆªå›¾ã€ä»·æ ¼ç­‰ã€‚</p>
<p>6.æäº¤åº”ç”¨ç¨‹åºè¿›è¡Œå®¡æ ¸ã€‚</p>
<p>ä¸‰ã€å®¡æ ¸é˜¶æ®µ</p>
<p>è‹¹æœå…¬å¸çš„å®¡æ ¸è¿‡ç¨‹é€šå¸¸éœ€è¦1-2å‘¨æ—¶é—´ï¼Œå®¡æ ¸è¿‡ç¨‹ä¸­å¼€å‘è€…éœ€è¦æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š</p>
<p>1.éµå¾ªè‹¹æœå…¬å¸çš„å®¡æ ¸æŒ‡å—ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºç¬¦åˆè§„å®šå’Œè¦æ±‚ã€‚</p>
<p>2.é¿å…ä½¿ç”¨æœªç»æˆæƒçš„ç¬¬ä¸‰æ–¹åº“å’Œæ’ä»¶ã€‚</p>
<p>3.é¿å…ä½¿ç”¨æœªç»æˆæƒçš„å•†æ ‡å’Œç‰ˆæƒå†…å®¹ã€‚</p>
<p>4.é¿å…åº”ç”¨ç¨‹åºä¸­å­˜åœ¨åŠŸèƒ½ç¼ºé™·å’Œå®‰å…¨æ¼æ´ã€‚</p>
<p>5.é¿å…åº”ç”¨ç¨‹åºä¸­å­˜åœ¨æ¬ºè¯ˆå’Œè¯ˆéª—è¡Œä¸ºã€‚</p>
<p>å››ã€ä¸Šæ¶é˜¶æ®µ</p>
<p>è‹¥åº”ç”¨ç¨‹åºå®¡æ ¸é€šè¿‡ï¼Œå¼€å‘è€…å¯ä»¥åœ¨App Storeä¸­æ­£å¼ä¸Šæ¶åº”ç”¨ç¨‹åºã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<p>1.åœ¨App Store Connectä¸­è®¾ç½®åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸ºâ€œå·²ä¸Šæ¶â€ã€‚</p>
<p>2.åœ¨App Storeä¸­æœç´¢åº”ç”¨ç¨‹åºå¹¶ç¡®è®¤åº”ç”¨ç¨‹åºçš„ä¿¡æ¯å’Œä»·æ ¼ã€‚</p>
<p>3.ç”¨æˆ·å¯ä»¥ä¸‹è½½å’Œä½¿ç”¨åº”ç”¨ç¨‹åºï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡App Store ConnectæŸ¥çœ‹åº”ç”¨ç¨‹åºçš„ä¸‹è½½é‡å’Œæ”¶ç›Šã€‚</p>
<p>æ€»ä¹‹ï¼Œè‹¹æœiOSä¸Šæ¶æ˜¯ä¸€ä¸ªéœ€è¦éµå¾ªè‹¹æœå…¬å¸ç›¸å…³è§„å®šå’Œè¦æ±‚çš„è¿‡ç¨‹ï¼Œå¼€å‘è€…éœ€è¦ä¿è¯åº”ç”¨ç¨‹åºçš„å“è´¨å’Œå®‰å…¨æ€§ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿè·å¾—è‰¯å¥½çš„ä½¿ç”¨ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueä½¿ç”¨<Suspense/>å®ç°å›¾ç‰‡åŠ è½½ç»„ä»¶]]></title>    <link>https://juejin.cn/post/7598532592455761947</link>    <guid>https://juejin.cn/post/7598532592455761947</guid>    <pubDate>2026-01-24T09:10:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592455761947" data-draft-id="7598641282324480027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueä½¿ç”¨&lt;Suspense/&gt;å®ç°å›¾ç‰‡åŠ è½½ç»„ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-24T09:10:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å’¸é±¼ç¿»èº«æ›´å…¥å‘³"/> <meta itemprop="url" content="https://juejin.cn/user/1031760609546968"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueä½¿ç”¨&lt;Suspense/&gt;å®ç°å›¾ç‰‡åŠ è½½ç»„ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1031760609546968/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å’¸é±¼ç¿»èº«æ›´å…¥å‘³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T09:10:50.000Z" title="Sat Jan 24 2026 09:10:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»€ä¹ˆæ˜¯Suspenseï¼Ÿ</h2>
<p><strong>Suspense</strong>æ˜¯<strong>Vue</strong>çš„å†…ç½®ç»„ä»¶ï¼Œèƒ½è®©ä½ ç®¡ç†ç»„ä»¶åŠ è½½æ—¶çš„ç­‰å¾…ã€å‡ºé”™å’Œæœ€ç»ˆæ¸²æŸ“é€»è¾‘ã€‚</p>
<p>ä¸»è¦é…åˆ<strong>å¼‚æ­¥ç»„ä»¶</strong>ã€<code>async/await</code> ç‰ˆçš„ <code>setup()</code> ä½¿ç”¨ã€‚</p>
<p>å®ƒæä¾›ä¸¤ä¸ªæ’æ§½ï¼š</p>
<ul>
<li><code>default</code>ï¼ˆé»˜è®¤æ’æ§½ï¼‰ï¼šè¦æ¸²æŸ“çš„å¼‚æ­¥å†…å®¹</li>
<li><code>fallback</code>ï¼šç­‰å¾…å¼‚æ­¥å†…å®¹åŠ è½½æ—¶æ˜¾ç¤ºçš„å…œåº•å†…å®¹</li>
</ul>
<h2 data-id="heading-1">è¯ä¸å¤šè¯´ï¼Œä¸Šä»£ç ï¼š</h2>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼Œå®ç°å›¾ç‰‡å¼‚æ­¥ç»„ä»¶</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
    &lt;img 
    :src="props.src" 
    :alt="props.alt" 
    :style="{ 
      width: setWidth, 
      height: setHeight, 
      borderRadius: rounded, 
      objectFit: 'cover'
    }"
    /&gt;
&lt;/template&gt;
// =================================== æ­¤å¤„ä¸ºè®¡ç®—å±æ€§é€»è¾‘ ================================
&lt;script setup lang="ts"&gt;
import { computed, ref } from "vue";

// å›¾ç‰‡å½¢çŠ¶å¯é€‰é¡¹
type ShapeOption = "circle" | "square" | "roundRect";

interface ILazyImage {
  src: string;
  width:string|number;
  height:string|number;
  delay?:number;//å»¶è¿Ÿæ‰§è¡Œï¼Ÿ
  timeout?:number;//è¶…æ—¶æ—¶é—´ï¼Ÿ
  shape?:ShapeOption;//å›¾ç‰‡å½¢çŠ¶
  alt?:string;
}

const props = defineProps&lt;ILazyImage&gt;();

//è®¡ç®—è¶…æ—¶
const timeoutSet = computed(() =&gt; {
    let time = Number(props.timeout) || 5;
    return time * 1000;
});

//è®¡ç®—å»¶è¿Ÿ
const delayTime = computed(() =&gt; {
    let time = Number(props.delay) || 0.1;
    return time * 1000;
});


//è®¡ç®—å®½åº¦
const setWidth = computed(() =&gt; {
    const val = parseFloat(props.width)
    if(!val) return '100px'
    return val  + "px";
});

//è®¡ç®—é«˜åº¦
const setHeight = computed(() =&gt; {
    const val = parseFloat(props.Height)
    if(!val) return '100px'
    return val  + "px";
});

// è®¡ç®—åœ†è§’
const rounded = computed(() =&gt; {
    switch (props.shape) {
        case "circle":
            return "50%";
        case "square":
            return "0";
        case "roundRect":
            return "10px";
        default:
            return "10px";
    }
});

//========================å®ç°å¼‚æ­¥åŠ è½½å›¾ç‰‡==================================

const loadImage = (src: string) =&gt; {
    return new Promise((resolve, reject) =&gt; {
    // åˆ›å»ºä¸€ä¸ªAbortControllerï¼Œç”¨äºå–æ¶ˆè¯·æ±‚
        const controller = new AbortController();
        const signal = controller.signal;

        const timeoutId = setTimeout(() =&gt; {
        // è¶…æ—¶æ—¶å–æ¶ˆè¯·æ±‚
            controller.abort();
            reject(new Error("å›¾ç‰‡åŠ è½½è¶…æ—¶"));
        }, timeoutSet.value);

        setTimeout(() =&gt; {
            const image = new Image();
            image.src = src;
            image.onload = () =&gt; {
                clearTimeout(timeoutId);
                resolve(src);
            };
            image.onerror = () =&gt; {
                clearTimeout(timeoutId);
                reject(new Error("å›¾ç‰‡åŠ è½½å¤±è´¥"));
            };
        }, delayTime.value);
    });
};

// æ‰§è¡Œå›¾ç‰‡åŠ è½½ï¼ˆasync/await è§¦å‘ Suspense ç­‰å¾…ï¼‰
await loadImage(props.src);

&lt;/script&gt;
</code></pre>
<h3 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šå®ç°æ‡’åŠ è½½ç»„ä»¶</h3>
<ul>
<li><code>default</code>ï¼ˆé»˜è®¤æ’æ§½ï¼‰ï¼šè¦æ¸²æŸ“çš„å¼‚æ­¥å†…å®¹</li>
<li><code>fallback</code>ï¼šç­‰å¾…å¼‚æ­¥å†…å®¹åŠ è½½æ—¶æ˜¾ç¤ºçš„å…œåº•å†…å®¹</li>
<li>ä½¿ç”¨<code>v-bind()</code>ç»‘å®šå±æ€§</li>
</ul>
<p>åœ¨ <code>&lt;Suspense&gt;&lt;/Suspense&gt;</code>ä¸­ç›´æ¥ä½¿ç”¨å¼‚æ­¥ç»„ä»¶å³å¯ï¼Œ<code>&lt;template #fallback&gt;&lt;/template&gt;</code>åˆ™æ˜¯åŠ è½½æ—¶æ˜¾ç¤º</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
    &lt;div&gt;
        &lt;Suspense&gt;
            &lt;template #default&gt;
                &lt;div class="image"&gt;
                    &lt;Image v-bind="{ ...props }"&gt;&lt;/Image&gt;
                &lt;/div&gt;
            &lt;/template&gt;
            &lt;template #fallback&gt;
                &lt;div class="skeleton"&gt;&lt;/div&gt;
            &lt;/template&gt;
        &lt;/Suspense&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { computed } from "vue";
import Image from "./Image.vue";
// å›¾ç‰‡å½¢çŠ¶å¯é€‰é¡¹
type ShapeOption = "circle" | "square" | "roundRect";

interface ILazyImage {
  src: string;
  width:string|number;
  height:string|number;
  delay?:number;//å»¶è¿Ÿæ‰§è¡Œï¼Ÿ
  timeout?:number;//è¶…æ—¶æ—¶é—´ï¼Ÿ
  shape?:ShapeOption;//å›¾ç‰‡å½¢çŠ¶
  alt?:string;
}

const props = defineProps&lt;ILazyImage&gt;();

//è®¡ç®—è¶…æ—¶
const timeoutSet = computed(() =&gt; {
    let time = Number(props.timeout) || 5;
    return time * 1000;
});

//è®¡ç®—å»¶è¿Ÿ
const delayTime = computed(() =&gt; {
    let time = Number(props.delay) || 0.1;
    return time * 1000;
});


//è®¡ç®—å®½åº¦
const setWidth = computed(() =&gt; {
    const val = parseFloat(props.width)
    if(!val) return '100px'
    return val  + "px";
});

//è®¡ç®—é«˜åº¦
const setHeight = computed(() =&gt; {
    const val = parseFloat(props.Height)
    if(!val) return '100px'
    return val  + "px";
});

// è®¡ç®—éª¨æ¶å±åŠ¨ç”»ï¼šé®ç½©å®½åº¦ï¼ˆå–å®¹å™¨å®½åº¦çš„ 40%ï¼‰ 
const setSeletonWidth = computed(() =&gt; { 
    // æå–å®½åº¦æ•°å€¼ï¼ˆå…¼å®¹ px å•ä½ï¼‰ 
    const widthNum = parseFloat(setWidth.value) || 100; 
    return `${widthNum * 0.4}px`;
}); 


// éª¨æ¶å±åŠ¨ç”»èµ·å§‹ä½ç½®ï¼ˆä»å®¹å™¨å·¦ä¾§å¤– 30% å¼€å§‹ï¼‰
const setSeletonStartRight = computed(() =&gt; { 
    const widthNum = parseFloat(setWidth.value) || 100; 
    return `-${widthNum * 1.3}px`;  // èµ·å§‹åœ¨å®¹å™¨å·¦ä¾§å¤–
});

// éª¨æ¶å±åŠ¨ç”»ç»“æŸä½ç½®ï¼ˆåˆ°å®¹å™¨å³ä¾§å¤– 30%ï¼‰ 
const setSeletonEndRight = computed(() =&gt; { 
    const widthNum = parseFloat(setWidth.value) || 100; return `${widthNum * 1.3}px`;
    // ç»“æŸåœ¨å®¹å™¨å³ä¾§å¤–
});

// è®¡ç®—åœ†è§’
const rounded = computed(() =&gt; {
    switch (props.shape) {
        case "circle":
            return "50%";
        case "square":
            return "0";
        case "roundRect":
            return "10px";
        default:
            return "10px";
    }
});
&lt;/script&gt;

&lt;style scoped&gt;
.image {
    overflow: hidden;
}

.skeleton {
    width: v-bind(setWidth);
    height: v-bind(setHeight);
    background-color: #dfe4ea;
    overflow: hidden;
    position: relative;

    border-radius: v-bind(rounded);
}

.skeleton::before {
    content: "";
    display: block;
    background-color: #ced6e0;
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
    position: absolute;
    top: 0;
    right: v-bind(setSeletonStartRight);
    width: v-bind(setSeletonWidth);
    height: v-bind(setHeight);
    transform: skewX(-30deg);
    animation: ping 1s infinite ease-out;
    filter: blur(10px);
}

@keyframes ping {
    from {
        right: v-bind(setSeletonStartRight);
    }

    to {
        right: v-bind(setSeletonEndRight);
    }
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-4">è¡¥å……</h3>
<ul>
<li>
<p>ä»£ç å†…æœ‰äº›é‡å¤çš„å†…å®¹ï¼Œå¯ä½¿ç”¨å¦å¤–çš„<code>ts</code>æ¥å£°æ˜æˆ–å®ç°ã€‚</p>
</li>
<li>
<p>å…¶ä¸­å¯èƒ½æœ‰äº›å˜é‡æˆ–å®ç°è¿‡ç¨‹æœ‰è¯¯ï¼Œæ­¤æ–‡ç« ä»…ä¾›å‚è€ƒã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[loadtest-è‡ªåŠ¨è·å–ç½‘ç«™æ€§èƒ½æé™]]></title>    <link>https://juejin.cn/post/7598480413803724842</link>    <guid>https://juejin.cn/post/7598480413803724842</guid>    <pubDate>2026-01-24T10:02:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480413803724842" data-draft-id="7598447519824232489" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="loadtest-è‡ªåŠ¨è·å–ç½‘ç«™æ€§èƒ½æé™"/> <meta itemprop="keywords" content="è¿ç»´"/> <meta itemprop="datePublished" content="2026-01-24T10:02:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®çš®å¼ºæ˜¯åªçš®çš®è™¾"/> <meta itemprop="url" content="https://juejin.cn/user/2623854603679966"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            loadtest-è‡ªåŠ¨è·å–ç½‘ç«™æ€§èƒ½æé™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2623854603679966/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®çš®å¼ºæ˜¯åªçš®çš®è™¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T10:02:29.000Z" title="Sat Jan 24 2026 10:02:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¼ ç»Ÿå‹åŠ›æµ‹è¯•å·¥å…·æ“ä½œå¤æ‚ï¼Œå¯¹äºä¸€äº›ç®€å•çš„åœºæ™¯æƒ³è¦å¿«é€ŸçŸ¥é“æœåŠ¡å™¨çš„æ€§èƒ½æé™ï¼Œä¸ºæ‰©å®¹æˆ–è€…é€‰è´­æœåŠ¡å™¨æä¾›ä¸€äº›æ•°æ®å‚è€ƒæˆ‘å¼€å‘äº†è¿™æ¬¾å·¥å…·ã€‚è¿™ä¸ªå·¥å…·å·²ç»åœ¨ä»¥å¾€çš„å¾ˆå¤šå°é¡¹ç›®ä¸­ä¸ºæˆ‘å¿«é€Ÿå®šä½ç³»ç»Ÿç“¶é¢ˆæä¾›äº†ä¸å°‘å¸®åŠ©ã€‚ç°åœ¨æˆ‘å°†å®ƒå¼€æºå‡ºæ¥ï¼Œå¸Œæœ›ä¹Ÿèƒ½å¸®åŠ©åˆ°åœ¨æ¥å•åšå¤–åŒ…çš„å°ä¼™ä¼´ã€‚</p>
</blockquote>
<h2 data-id="heading-0">é¡¹ç›®ç®€ä»‹</h2>
<p>loadtest æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€ç¼–å†™çš„è½»é‡çº§è´Ÿè½½æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä»¥æ ¹æ®ç›®æ ‡ URL çš„å“åº”æ—¶é—´è‡ªåŠ¨è°ƒæ•´å¹¶å‘æ•°ï¼Œå¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œé«˜æ•ˆçš„å‹åŠ›æµ‹è¯•ã€‚</p>
<h2 data-id="heading-1">åŠŸèƒ½ç‰¹ç‚¹</h2>
<ul>
<li><strong>è‡ªåŠ¨è°ƒæ•´å¹¶å‘æ•°</strong>ï¼šæ ¹æ®ç›®æ ‡ URL çš„å“åº”æ—¶é—´è‡ªåŠ¨å¢åŠ æˆ–å‡å°‘å¹¶å‘æ•°ï¼Œç¡®ä¿æµ‹è¯•ç»“æœæ›´åŠ å‡†ç¡®ã€‚</li>
<li><strong>å®æ—¶ç»Ÿè®¡ç›‘æ§</strong>ï¼šæ¯ 5 ç§’è¾“å‡ºä¸€æ¬¡æµ‹è¯•ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯·æ±‚æ•°ã€æˆåŠŸæ•°ã€å¤±è´¥æ•°å’Œå¹³å‡å“åº”æ—¶é—´ã€‚</li>
<li><strong>çµæ´»çš„é…ç½®é€‰é¡¹</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰åˆå§‹å¹¶å‘æ•°ã€æœ€å¤§å¹¶å‘æ•°å’Œç›®æ ‡å»¶è¿Ÿæ—¶é—´ã€‚</li>
<li><strong>å¤šå¹³å°æ”¯æŒ</strong>ï¼šæä¾›äº† Windowsã€macOS å’Œ Linux ç­‰å¤šä¸ªå¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li><strong>è¯¦ç»†çš„æ—¥å¿—è®°å½•</strong>ï¼šæ‰€æœ‰æµ‹è¯•æ•°æ®éƒ½ä¼šè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åç»­åˆ†æã€‚</li>
</ul>
<h2 data-id="heading-2">å®‰è£…æ–¹æ³•</h2>
<h3 data-id="heading-3">ä»é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…</h3>
<p>å¯ä»¥ä»é¡¹ç›®çš„ <code>release</code>  é¡µé¢ç›´æ¥ä¸‹è½½å¯¹åº”å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<ul>
<li>Windows: <code>loadtest-windows-amd64.exe</code> æˆ– <code>loadtest-windows-arm64.exe</code></li>
<li>macOS: <code>loadtest-darwin-amd64</code> æˆ– <code>loadtest-darwin-arm64</code></li>
<li>Linux: <code>loadtest-linux-amd64</code>ã€<code>loadtest-linux-arm64</code> æˆ– <code>loadtest-linux-armv7</code></li>
</ul>
<h3 data-id="heading-4">ä»æºä»£ç ç¼–è¯‘</h3>
<ol>
<li>ç¡®ä¿å·²å®‰è£… Go 1.16 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
<li>å…‹éš†ä»£ç ä»“åº“</li>
<li>æ‰§è¡Œ <code>make</code> å‘½ä»¤ç¼–è¯‘</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> &lt;ä»“åº“åœ°å€&gt;
<span class="hljs-built_in">cd</span> loadtest
make
</code></pre>
<h2 data-id="heading-5">ä½¿ç”¨æ–¹æ³•</h2>
<h3 data-id="heading-6">åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-bash" lang="bash">./loadtest -url=&lt;ç›®æ ‡URL&gt; [é€‰é¡¹]
</code></pre>
<h3 data-id="heading-7">å‘½ä»¤è¡Œå‚æ•°è¯´æ˜</h3>









































<table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>-url</code></td><td>string</td><td>ç©º</td><td>ç›®æ ‡ URLï¼ˆå¿…å¡«ï¼‰</td></tr><tr><td><code>-initial-concurrency</code></td><td>int</td><td>10</td><td>åˆå§‹å¹¶å‘æ•°</td></tr><tr><td><code>-max-concurrency</code></td><td>int</td><td>1000</td><td>æœ€å¤§å¹¶å‘æ•°</td></tr><tr><td><code>-target-latency</code></td><td>duration</td><td>100ms</td><td>ç›®æ ‡å»¶è¿Ÿæ—¶é—´</td></tr><tr><td><code>-log</code></td><td>string</td><td>loadtest.log</td><td>æ—¥å¿—æ–‡ä»¶è·¯å¾„</td></tr></tbody></table>
<h3 data-id="heading-8">ç¤ºä¾‹</h3>
<ol>
<li>åŸºæœ¬æµ‹è¯•</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">./loadtest -url=https://www.baidu.com
</code></pre>
<ol start="2">
<li>è‡ªå®šä¹‰é…ç½®</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">./loadtest -url=https://www.baidu.com -initial-concurrency=20 -max-concurrency=500 -target-latency=200ms
</code></pre>
<ol start="3">
<li>è‡ªå®šä¹‰æ—¥å¿—æ–‡ä»¶</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">./loadtest -url=https://www.baidu.com -<span class="hljs-built_in">log</span>=my_test.log
</code></pre>
<h2 data-id="heading-9">æµ‹è¯•è¾“å‡º</h2>
<p>è¿è¡Œæµ‹è¯•åï¼Œä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">Load</span> <span class="hljs-string">testing</span> <span class="hljs-string">started.</span> <span class="hljs-string">Logs</span> <span class="hljs-string">are</span> <span class="hljs-string">written</span> <span class="hljs-string">to</span> <span class="hljs-string">loadtest.log</span>
<span class="hljs-attr">Initial concurrency:</span> <span class="hljs-number">10</span><span class="hljs-string">,</span> <span class="hljs-attr">Max concurrency:</span> <span class="hljs-number">1000</span><span class="hljs-string">,</span> <span class="hljs-attr">Target latency:</span> <span class="hljs-string">100ms</span>
<span class="hljs-string">Press</span> <span class="hljs-string">Ctrl+C</span> <span class="hljs-string">to</span> <span class="hljs-string">stop</span>
</code></pre>
<p>æŒ‰ä¸‹ Ctrl+C åœæ­¢æµ‹è¯•åï¼Œä¼šè¾“å‡ºæœ€ç»ˆç»Ÿè®¡ç»“æœï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Final Results:</span>
<span class="hljs-attr">Total Requests:</span> <span class="hljs-number">12345</span>
<span class="hljs-attr">Successful:</span> <span class="hljs-number">12300</span>
<span class="hljs-attr">Failed:</span> <span class="hljs-number">45</span>
<span class="hljs-attr">Average Response Time:</span> <span class="hljs-number">85.</span><span class="hljs-string">23ms</span>
<span class="hljs-attr">Success Rate:</span> <span class="hljs-number">99.63</span><span class="hljs-string">%</span>
<span class="hljs-attr">Final Concurrency Level:</span> <span class="hljs-number">150</span>
</code></pre>
<h2 data-id="heading-10">æ—¥å¿—æ–‡ä»¶</h2>
<p>æ‰€æœ‰æµ‹è¯•æ•°æ®éƒ½ä¼šè®°å½•åˆ°æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ¯ 5 ç§’è¾“å‡ºä¸€æ¬¡ç»Ÿè®¡ä¿¡æ¯ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">2023/01/01 12:00:00 Total - Requests:</span> <span class="hljs-number">1000</span><span class="hljs-string">,</span> <span class="hljs-attr">Success:</span> <span class="hljs-number">995</span><span class="hljs-string">,</span> <span class="hljs-attr">Failures:</span> <span class="hljs-number">5</span><span class="hljs-string">,</span> <span class="hljs-attr">Avg Time:</span> <span class="hljs-string">80ms</span>
<span class="hljs-attr">2023/01/01 12:00:00 Recent - Requests:</span> <span class="hljs-number">200</span><span class="hljs-string">,</span> <span class="hljs-attr">Success:</span> <span class="hljs-number">199</span><span class="hljs-string">,</span> <span class="hljs-attr">Failures:</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-attr">Avg Time:</span> <span class="hljs-string">78ms</span>
</code></pre>
<h2 data-id="heading-11">æŠ€æœ¯å®ç°</h2>
<h3 data-id="heading-12">æ ¸å¿ƒæ¶æ„</h3>
<ul>
<li>é‡‡ç”¨å·¥ä½œåç¨‹æ± çš„è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡è°ƒæ•´åç¨‹æ•°é‡æ¥æ§åˆ¶å¹¶å‘æ•°</li>
<li>ä½¿ç”¨ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰æ¥ç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li>ä½¿ç”¨è¯»å†™é”ä¿è¯ç»Ÿè®¡æ•°æ®çš„å‡†ç¡®æ€§</li>
</ul>
<h3 data-id="heading-13">è‡ªåŠ¨è°ƒæ•´ç®—æ³•</h3>
<ul>
<li>å¦‚æœå“åº”æ—¶é—´ä½äºç›®æ ‡å»¶è¿Ÿçš„ä¸€åŠï¼Œå°±ä¼šå¢åŠ  10% çš„å¹¶å‘æ•°</li>
<li>å¦‚æœå“åº”æ—¶é—´è¿‡é«˜ï¼Œå°±ä¼šä¿æŒå½“å‰å¹¶å‘æ•°ï¼ˆæœªæ¥å¯ä»¥æ‰©å±•ä¸ºå‡å°‘å¹¶å‘æ•°ï¼‰</li>
<li>å¹¶å‘æ•°ä¸ä¼šè¶…è¿‡è®¾å®šçš„æœ€å¤§å€¼</li>
</ul>
<h2 data-id="heading-14">GitHub</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fycq3%2Floadtest%2Freleases" target="_blank" title="https://github.com/ycq3/loadtest/releases" ref="nofollow noopener noreferrer">github.com/ycq3/loadteâ€¦</a>
å›½å†…é•œåƒ
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2Fpipiqiang%2Floadtest" target="_blank" title="https://gitcode.com/pipiqiang/loadtest" ref="nofollow noopener noreferrer">gitcode.com/pipiqiang/lâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ Vue3 å®ç°è¶…ä¸æ»‘æ‰“å­—æœºæ•ˆæœç»„ä»¶ï¼ˆå¯å¤ç”¨ã€é«˜å®šåˆ¶ï¼‰]]></title>    <link>https://juejin.cn/post/7598532592455516187</link>    <guid>https://juejin.cn/post/7598532592455516187</guid>    <pubDate>2026-01-24T07:04:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592455516187" data-draft-id="7598499504170614822" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ Vue3 å®ç°è¶…ä¸æ»‘æ‰“å­—æœºæ•ˆæœç»„ä»¶ï¼ˆå¯å¤ç”¨ã€é«˜å®šåˆ¶ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-24T07:04:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é©¬_xiaoen"/> <meta itemprop="url" content="https://juejin.cn/user/4438063859920414"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ Vue3 å®ç°è¶…ä¸æ»‘æ‰“å­—æœºæ•ˆæœç»„ä»¶ï¼ˆå¯å¤ç”¨ã€é«˜å®šåˆ¶ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4438063859920414/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é©¬_xiaoen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:04:17.000Z" title="Sat Jan 24 2026 07:04:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ‰“å­—æœºæ•ˆæœèƒ½æå¤§æå‡é¡µé¢çš„äº¤äº’è¶£å‘³æ€§å’Œè§†è§‰ä½“éªŒï¼Œæ¯”å¦‚ AI èŠå¤©å›å¤ã€ä¸ªæ€§åŒ–ä»‹ç»é¡µç­‰åœºæ™¯éƒ½éå¸¸é€‚ç”¨ã€‚æœ¬æ–‡å°†åˆ†äº«ä¸€ä¸ªåŸºäº Vue3 + Composition API å¼€å‘çš„<strong>é«˜æ€§èƒ½ã€é«˜å®šåˆ¶åŒ–</strong>æ‰“å­—æœºç»„ä»¶ï¼Œæ”¯æŒæ‰“å­—/åˆ é™¤å¾ªç¯ã€å…‰æ ‡é—ªçƒã€è‡ªå®šä¹‰æ ·å¼ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸”ä»£ç ç»“æ„æ¸…æ™°ã€æ˜“äºæ‰©å±•ã€‚</p>
<h2 data-id="heading-0">ğŸ¯ ç»„ä»¶ç‰¹æ€§</h2>
<ul>
<li>âœ… è‡ªå®šä¹‰æ‰“å­—é€Ÿåº¦ã€åˆ é™¤é€Ÿåº¦ã€å¾ªç¯å»¶è¿Ÿ</li>
<li>âœ… æ”¯æŒå…‰æ ‡æ˜¾ç¤º/éšè—ã€é—ªçƒæ•ˆæœå¼€å…³</li>
<li>âœ… æ‰“å­—å®Œæˆåè‡ªåŠ¨åˆ é™¤ï¼ˆå¯é€‰ï¼‰+ å¾ªç¯æ’­æ”¾</li>
<li>âœ… å®Œå…¨è‡ªå®šä¹‰æ ·å¼ï¼ˆå­—ä½“ã€é¢œè‰²ã€å¤§å°ç­‰ï¼‰</li>
<li>âœ… æš´éœ²æ§åˆ¶æ–¹æ³•ï¼ˆå¼€å§‹/æš‚åœï¼‰ï¼Œæ”¯æŒæ‰‹åŠ¨å¹²é¢„</li>
<li>âœ… æ— ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œçº¯åŸç”Ÿ Vue3 å®ç°</li>
<li>âœ… æ€§èƒ½ä¼˜åŒ–ï¼šç»„ä»¶å¸è½½è‡ªåŠ¨æ¸…ç†å®šæ—¶å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/430e5abc5ccf4784b4debc3857893d87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6amsX3hpYW9lbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769843056&amp;x-signature=3g31BSS0j3jO4WQZhc%2Fz50kXXjI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ul>
<h2 data-id="heading-1">ğŸ“ å®Œæ•´ç»„ä»¶ä»£ç </h2>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"typewriter-container"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"fontsConStyle"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ‰“å­—æ–‡æœ¬ - é€å­—ç¬¦æ¸²æŸ“ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"typewriter-text"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(char, index) in displayedText"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span> 
        <span class="hljs-attr">class</span>=<span class="hljs-string">"character"</span>
        <span class="hljs-attr">:data-index</span>=<span class="hljs-string">"index"</span>
      &gt;</span>
        {{ char }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å…‰æ ‡ - ç²¾å‡†æ§åˆ¶æ˜¾ç¤º/é—ªçƒ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> 
      <span class="hljs-attr">v-if</span>=<span class="hljs-string">"showCursor &amp;&amp; isCursorVisible"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"cursor"</span>
      <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ 'blink': showBlinkCursor }"</span>
      <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted, onBeforeUnmount, computed, watch, watchEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-comment">// ç»„ä»¶ Props å®šä¹‰ï¼ˆå¸¦å®Œæ•´æ ¡éªŒï¼‰</span>
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-comment">// è¦æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹</span>
  <span class="hljs-attr">text</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">""</span>
  },
  <span class="hljs-comment">// æ‰“å­—é€Ÿåº¦ï¼ˆms/å­—ç¬¦ï¼‰</span>
  <span class="hljs-attr">speed</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value &gt; <span class="hljs-number">0</span>
  },
  <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºå…‰æ ‡</span>
  <span class="hljs-attr">showCursor</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">// å…‰æ ‡æ˜¯å¦é—ªçƒ</span>
  <span class="hljs-attr">blinkCursor</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">// æ˜¯å¦è‡ªåŠ¨å¼€å§‹æ‰“å­—</span>
  <span class="hljs-attr">autoStart</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">// æ˜¯å¦å¾ªç¯æ’­æ”¾</span>
  <span class="hljs-attr">loop</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>
  },
  <span class="hljs-comment">// å¾ªç¯å»¶è¿Ÿï¼ˆæ‰“å­—å®Œæˆåç­‰å¾…æ—¶é—´ï¼‰</span>
  <span class="hljs-attr">loopDelay</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value &gt;= <span class="hljs-number">0</span>
  },
  <span class="hljs-comment">// å®¹å™¨æ ·å¼ï¼ˆè‡ªå®šä¹‰å­—ä½“ã€é¢œè‰²ç­‰ï¼‰</span>
  <span class="hljs-attr">fontsConStyle</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({
      <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"2rem"</span>,
      <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">"'Courier New', monospace"</span>,
      <span class="hljs-attr">color</span>: <span class="hljs-string">"#333"</span>,
      <span class="hljs-attr">lineHeight</span>: <span class="hljs-string">"1.5"</span>
    })
  },
  <span class="hljs-comment">// æ˜¯å¦å¼€å¯åˆ é™¤æ•ˆæœ</span>
  <span class="hljs-attr">deleteEffect</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>
  },
  <span class="hljs-comment">// åˆ é™¤é€Ÿåº¦ï¼ˆms/å­—ç¬¦ï¼‰</span>
  <span class="hljs-attr">deleteSpeed</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value &gt; <span class="hljs-number">0</span>
  },
  <span class="hljs-comment">// å­—ç¬¦å…¥åœºåŠ¨ç”»å¼€å…³</span>
  <span class="hljs-attr">charAnimation</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  }
});

<span class="hljs-comment">// å“åº”å¼çŠ¶æ€</span>
<span class="hljs-keyword">const</span> displayedText = <span class="hljs-title function_">ref</span>(<span class="hljs-string">""</span>);    <span class="hljs-comment">// å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬</span>
<span class="hljs-keyword">const</span> currentIndex = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);      <span class="hljs-comment">// å½“å‰å­—ç¬¦ç´¢å¼•</span>
<span class="hljs-keyword">const</span> isPlaying = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);     <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨æ’­æ”¾</span>
<span class="hljs-keyword">const</span> isDeleting = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);    <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨åˆ é™¤</span>
<span class="hljs-keyword">const</span> isCursorVisible = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>);<span class="hljs-comment">// å…‰æ ‡æ˜¯å¦æ˜¾ç¤º</span>

<span class="hljs-comment">// å®šæ—¶å™¨æ ‡è¯†ï¼ˆç”¨äºæ¸…ç†ï¼‰</span>
<span class="hljs-keyword">let</span> intervalId = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> timeoutId = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> cursorTimer = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// è®¡ç®—å±æ€§ï¼šæ§åˆ¶å…‰æ ‡é—ªçƒçŠ¶æ€</span>
<span class="hljs-keyword">const</span> showBlinkCursor = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">blinkCursor</span> &amp;&amp; 
         !isDeleting.<span class="hljs-property">value</span> &amp;&amp;
         (displayedText.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> === props.<span class="hljs-property">text</span>.<span class="hljs-property">length</span> || displayedText.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>);
});

<span class="hljs-comment">// å·¥å…·å‡½æ•°ï¼šæ¸…é™¤æ‰€æœ‰å®šæ—¶å™¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">clearAllTimers</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (intervalId) <span class="hljs-built_in">clearInterval</span>(intervalId);
  <span class="hljs-keyword">if</span> (timeoutId) <span class="hljs-built_in">clearTimeout</span>(timeoutId);
  <span class="hljs-keyword">if</span> (cursorTimer) <span class="hljs-built_in">clearInterval</span>(cursorTimer);
  intervalId = <span class="hljs-literal">null</span>;
  timeoutId = <span class="hljs-literal">null</span>;
  cursorTimer = <span class="hljs-literal">null</span>;
};

<span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•ï¼šå¼€å§‹æ‰“å­—</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">startTyping</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// é‡ç½®çŠ¶æ€</span>
  <span class="hljs-title function_">clearAllTimers</span>();
  isPlaying.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
  isDeleting.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
  currentIndex.<span class="hljs-property">value</span> = <span class="hljs-number">0</span>;
  displayedText.<span class="hljs-property">value</span> = <span class="hljs-string">""</span>;
  isCursorVisible.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
  
  <span class="hljs-comment">// æ‰“å­—é€»è¾‘</span>
  intervalId = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentIndex.<span class="hljs-property">value</span> &lt; props.<span class="hljs-property">text</span>.<span class="hljs-property">length</span>) {
      displayedText.<span class="hljs-property">value</span> = props.<span class="hljs-property">text</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, currentIndex.<span class="hljs-property">value</span> + <span class="hljs-number">1</span>);
      currentIndex.<span class="hljs-property">value</span>++;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ‰“å­—å®Œæˆ</span>
      <span class="hljs-built_in">clearInterval</span>(intervalId);
      isPlaying.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
      
      <span class="hljs-comment">// å¾ªç¯é€»è¾‘</span>
      <span class="hljs-keyword">if</span> (props.<span class="hljs-property">loop</span>) {
        <span class="hljs-keyword">if</span> (props.<span class="hljs-property">deleteEffect</span>) {
          timeoutId = <span class="hljs-built_in">setTimeout</span>(startDeleting, props.<span class="hljs-property">loopDelay</span>);
        } <span class="hljs-keyword">else</span> {
          timeoutId = <span class="hljs-built_in">setTimeout</span>(startTyping, props.<span class="hljs-property">loopDelay</span>);
        }
      }
    }
  }, props.<span class="hljs-property">speed</span>);
};

<span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•ï¼šå¼€å§‹åˆ é™¤</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">startDeleting</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">clearAllTimers</span>();
  isDeleting.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
  
  intervalId = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentIndex.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0</span>) {
      currentIndex.<span class="hljs-property">value</span>--;
      displayedText.<span class="hljs-property">value</span> = props.<span class="hljs-property">text</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, currentIndex.<span class="hljs-property">value</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// åˆ é™¤å®Œæˆ</span>
      <span class="hljs-built_in">clearInterval</span>(intervalId);
      isDeleting.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
      
      <span class="hljs-comment">// å¾ªç¯æ‰“å­—</span>
      <span class="hljs-keyword">if</span> (props.<span class="hljs-property">loop</span>) {
        timeoutId = <span class="hljs-built_in">setTimeout</span>(startTyping, props.<span class="hljs-property">loopDelay</span>);
      } <span class="hljs-keyword">else</span> {
        isCursorVisible.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// éå¾ªç¯æ¨¡å¼ä¸‹åˆ é™¤å®Œæˆéšè—å…‰æ ‡</span>
      }
    }
  }, props.<span class="hljs-property">deleteSpeed</span>);
};

<span class="hljs-comment">// ç›‘å¬æ–‡æœ¬å˜åŒ–ï¼šè‡ªåŠ¨é‡å¯æ‰“å­—ï¼ˆé€‚é…åŠ¨æ€æ–‡æœ¬åœºæ™¯ï¼‰</span>
<span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">text</span>, <span class="hljs-function">(<span class="hljs-params">newText</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (newText &amp;&amp; props.<span class="hljs-property">autoStart</span>) {
    <span class="hljs-title function_">startTyping</span>();
  }
}, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// åˆå§‹åŒ–å…‰æ ‡é—ªçƒï¼ˆéé—ªçƒæ¨¡å¼ä¸‹å›ºå®šæ˜¾ç¤ºï¼‰</span>
<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">showCursor</span> &amp;&amp; !cursorTimer) {
    cursorTimer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (!showBlinkCursor.<span class="hljs-property">value</span>) {
        isCursorVisible.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">else</span> {
        isCursorVisible.<span class="hljs-property">value</span> = !isCursorVisible.<span class="hljs-property">value</span>;
      }
    }, <span class="hljs-number">500</span>);
  }
});

<span class="hljs-comment">// ç»„ä»¶æŒ‚è½½ï¼šè‡ªåŠ¨å¼€å§‹æ‰“å­—</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">autoStart</span> &amp;&amp; props.<span class="hljs-property">text</span>) {
    <span class="hljs-title function_">startTyping</span>();
  }
});

<span class="hljs-comment">// ç»„ä»¶å¸è½½ï¼šæ¸…ç†æ‰€æœ‰å®šæ—¶å™¨ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰</span>
<span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">clearAllTimers</span>();
});

<span class="hljs-comment">// æš´éœ²ç»„ä»¶æ–¹æ³•ï¼ˆä¾›çˆ¶ç»„ä»¶è°ƒç”¨ï¼‰</span>
<span class="hljs-title function_">defineExpose</span>({
  <span class="hljs-attr">start</span>: startTyping,        <span class="hljs-comment">// æ‰‹åŠ¨å¼€å§‹</span>
  <span class="hljs-attr">pause</span>: clearAllTimers,     <span class="hljs-comment">// æš‚åœ</span>
  <span class="hljs-attr">restart</span>: <span class="hljs-function">() =&gt;</span> {           <span class="hljs-comment">// é‡å¯</span>
    <span class="hljs-title function_">clearAllTimers</span>();
    <span class="hljs-title function_">startTyping</span>();
  },
  isPlaying,                 <span class="hljs-comment">// å½“å‰æ’­æ”¾çŠ¶æ€</span>
  isDeleting                 <span class="hljs-comment">// å½“å‰åˆ é™¤çŠ¶æ€</span>
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* å®¹å™¨æ ·å¼ - é€‚é…è¡Œå†…/å—çº§æ˜¾ç¤º */</span>
<span class="hljs-selector-class">.typewriter-container</span> {
  <span class="hljs-attribute">display</span>: inline-flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">font-size</span>: inherit;
  <span class="hljs-attribute">line-height</span>: inherit;
  <span class="hljs-attribute">font-family</span>: inherit;
  <span class="hljs-attribute">white-space</span>: pre-wrap; <span class="hljs-comment">/* æ”¯æŒæ¢è¡Œç¬¦ */</span>
  <span class="hljs-attribute">word-break</span>: break-all; <span class="hljs-comment">/* é˜²æ­¢é•¿æ–‡æœ¬æº¢å‡º */</span>
}

<span class="hljs-comment">/* æ–‡æœ¬å®¹å™¨ */</span>
<span class="hljs-selector-class">.typewriter-text</span> {
  <span class="hljs-attribute">display</span>: inline;
  <span class="hljs-attribute">font-size</span>: inherit;
  <span class="hljs-attribute">line-height</span>: inherit;
  <span class="hljs-attribute">font-family</span>: inherit;
  <span class="hljs-attribute">color</span>: inherit;
}

<span class="hljs-comment">/* å­—ç¬¦æ ·å¼ - å…¥åœºåŠ¨ç”» */</span>
<span class="hljs-selector-class">.character</span> {
  <span class="hljs-attribute">display</span>: inline-block;
  <span class="hljs-attribute">animation</span>: typeIn <span class="hljs-number">0.1s</span> ease-out forwards;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* å­—ç¬¦å…¥åœºåŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> typeIn {
  <span class="hljs-number">0%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">5px</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  }
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
  }
}

<span class="hljs-comment">/* å…‰æ ‡æ ·å¼ - å‚ç›´å±…ä¸­ä¼˜åŒ– */</span>
<span class="hljs-selector-class">.cursor</span> {
  <span class="hljs-attribute">display</span>: inline-block;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">2px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">1.2em</span>; <span class="hljs-comment">/* åŒ¹é…å­—ä½“é«˜åº¦ */</span>
  <span class="hljs-attribute">background-color</span>: currentColor;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">2px</span>;
  <span class="hljs-attribute">vertical-align</span>: middle;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
}

<span class="hljs-comment">/* å…‰æ ‡é—ªçƒåŠ¨ç”» */</span>
<span class="hljs-selector-class">.cursor</span><span class="hljs-selector-class">.blink</span> {
  <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1s</span> infinite step-end;
}

<span class="hljs-keyword">@keyframes</span> blink {
  <span class="hljs-number">0%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
  <span class="hljs-number">50%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
}

<span class="hljs-comment">/* ç¦ç”¨å­—ç¬¦åŠ¨ç”»çš„æ ·å¼ */</span>
:<span class="hljs-built_in">deep</span>(.character) {
  <span class="hljs-attribute">animation</span>: none <span class="hljs-meta">!important</span>;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span> <span class="hljs-meta">!important</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-2">ğŸš€ æ ¸å¿ƒä¼˜åŒ–ç‚¹è¯´æ˜</h2>
<h3 data-id="heading-3">1. åŠŸèƒ½å¢å¼º</h3>
<ul>
<li>æ–°å¢ <code>charAnimation</code> å±æ€§ï¼šå¯å¼€å…³å­—ç¬¦å…¥åœºåŠ¨ç”»ï¼Œé€‚é…ä¸åŒåœºæ™¯</li>
<li>æ”¯æŒåŠ¨æ€æ–‡æœ¬ï¼šç›‘å¬ <code>text</code> å±æ€§å˜åŒ–ï¼Œæ–‡æœ¬æ›´æ–°è‡ªåŠ¨é‡å¯æ‰“å­—</li>
<li>ä¼˜åŒ–å…‰æ ‡é€»è¾‘ï¼šéé—ªçƒæ¨¡å¼ä¸‹å…‰æ ‡å›ºå®šæ˜¾ç¤ºï¼Œé¿å…é—ªçƒå¹²æ‰°</li>
<li>æ–°å¢ <code>restart</code> æ–¹æ³•ï¼šæ”¯æŒæ‰‹åŠ¨é‡å¯æ‰“å­—æ•ˆæœ</li>
<li>æ–‡æœ¬æ¢è¡Œæ”¯æŒï¼šæ·»åŠ  <code>white-space: pre-wrap</code>ï¼Œå…¼å®¹å¸¦æ¢è¡Œç¬¦çš„æ–‡æœ¬</li>
</ul>
<h3 data-id="heading-4">2. æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>å®šæ—¶å™¨ç»Ÿä¸€ç®¡ç†ï¼šæ‰€æœ‰å®šæ—¶å™¨é›†ä¸­æ¸…ç†ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
<li>å‡å°‘ä¸å¿…è¦æ¸²æŸ“ï¼šé€šè¿‡ <code>watchEffect</code> ç²¾å‡†æ§åˆ¶å…‰æ ‡å®šæ—¶å™¨åˆ›å»º/é”€æ¯</li>
<li>æ ·å¼ä¼˜åŒ–ï¼šä½¿ç”¨ <code>currentColor</code> ç»§æ‰¿æ–‡æœ¬é¢œè‰²ï¼Œå…‰æ ‡é¢œè‰²ä¸æ–‡æœ¬ä¸€è‡´</li>
<li>è¾¹ç•Œå¤„ç†ï¼šæ·»åŠ  <code>word-break: break-all</code>ï¼Œé˜²æ­¢é•¿æ–‡æœ¬æº¢å‡º</li>
</ul>
<h3 data-id="heading-5">3. ä»£ç å¥å£®æ€§</h3>
<ul>
<li>å®Œå–„ Prop æ ¡éªŒï¼šæ‰€æœ‰æ•°å€¼ç±»å‹æ·»åŠ èŒƒå›´æ ¡éªŒï¼Œé¿å…éæ³•å€¼</li>
<li>çŠ¶æ€é‡ç½®ï¼šæ¯æ¬¡å¼€å§‹æ‰“å­—å‰é‡ç½®æ‰€æœ‰çŠ¶æ€ï¼Œé¿å…å¤šè½®æ‰§è¡Œå†²çª</li>
<li>æ³¨é‡Šå®Œå–„ï¼šå…³é”®é€»è¾‘æ·»åŠ æ³¨é‡Šï¼Œæå‡ä»£ç å¯è¯»æ€§</li>
</ul>
<h2 data-id="heading-6">ğŸ“– ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-7">åŸºç¡€ä½¿ç”¨</h3>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Typewriter</span> 
    <span class="hljs-attr">text</span>=<span class="hljs-string">"Hello Vue3! è¿™æ˜¯ä¸€ä¸ªè¶…ä¸æ»‘çš„æ‰“å­—æœºæ•ˆæœç»„ä»¶âœ¨"</span>
    <span class="hljs-attr">speed</span>=<span class="hljs-string">"50"</span>
  /&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Typewriter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Typewriter.vue'</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-8">é«˜çº§ä½¿ç”¨ï¼ˆå¾ªç¯+åˆ é™¤æ•ˆæœï¼‰</h3>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Typewriter</span> 
      <span class="hljs-attr">ref</span>=<span class="hljs-string">"typewriterRef"</span>
      <span class="hljs-attr">text</span>=<span class="hljs-string">"Vue3 æ‰“å­—æœºç»„ä»¶ | æ”¯æŒå¾ªç¯åˆ é™¤ | è‡ªå®šä¹‰æ ·å¼"</span>
      <span class="hljs-attr">:speed</span>=<span class="hljs-string">"60"</span>
      <span class="hljs-attr">:deleteSpeed</span>=<span class="hljs-string">"40"</span>
      <span class="hljs-attr">:loop</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">:deleteEffect</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">:loopDelay</span>=<span class="hljs-string">"1500"</span>
      <span class="hljs-attr">:fontsConStyle</span>=<span class="hljs-string">"{
        fontSize: '1.5rem',
        color: '#409eff',
        fontFamily: 'å¾®è½¯é›…é»‘'
      }"</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleRestart"</span>&gt;</span>é‡å¯æ‰“å­—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Typewriter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Typewriter.vue'</span>;

<span class="hljs-keyword">const</span> typewriterRef = <span class="hljs-title function_">ref</span>();

<span class="hljs-comment">// æ‰‹åŠ¨é‡å¯æ‰“å­—</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleRestart</span> = (<span class="hljs-params"/>) =&gt; {
  typewriterRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">restart</span>();
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-9">ğŸ¨ æ ·å¼è‡ªå®šä¹‰è¯´æ˜</h2>






























<table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>fontSize</td><td>å­—ä½“å¤§å°</td><td>2rem</td></tr><tr><td>fontFamily</td><td>å­—ä½“</td><td>'Courier New', monospace</td></tr><tr><td>color</td><td>æ–‡æœ¬é¢œè‰²</td><td>#333</td></tr><tr><td>lineHeight</td><td>è¡Œé«˜</td><td>1.5</td></tr></tbody></table>
<p>ä½ å¯ä»¥é€šè¿‡ <code>fontsConStyle</code> å±æ€§å®Œå…¨è‡ªå®šä¹‰ç»„ä»¶æ ·å¼ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">fontsConStyle</span>: {
  <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"18px"</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">"#e6a23c"</span>,
  <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">"bold"</span>,
  <span class="hljs-attr">background</span>: <span class="hljs-string">"#f5f7fa"</span>,
  <span class="hljs-attr">padding</span>: <span class="hljs-string">"10px 15px"</span>,
  <span class="hljs-attr">borderRadius</span>: <span class="hljs-string">"8px"</span>
}
</code></pre>
<h2 data-id="heading-10">ğŸ› ï¸ æ‰©å±•æ–¹å‘</h2>
<ol>
<li><strong>è‡ªå®šä¹‰å­—ç¬¦åŠ¨ç”»</strong>ï¼šé€šè¿‡ Prop ä¼ å…¥åŠ¨ç”»ç±»åï¼Œæ”¯æŒä¸åŒçš„å­—ç¬¦å…¥åœºæ•ˆæœ</li>
<li><strong>åˆ†æ®µæ‰“å­—</strong>ï¼šæ”¯æŒæ•°ç»„å½¢å¼çš„æ–‡æœ¬ï¼Œåˆ†æ®µæ‰“å­—+é—´éš”</li>
<li><strong>é€Ÿåº¦æ¸å˜</strong>ï¼šå®ç°æ‰“å­—é€Ÿåº¦ç”±å¿«åˆ°æ…¢/ç”±æ…¢åˆ°å¿«çš„æ•ˆæœ</li>
<li><strong>æš‚åœ/ç»§ç»­</strong>ï¼šæ‰©å±•æš‚åœåç»§ç»­æ‰“å­—çš„åŠŸèƒ½ï¼ˆè®°å½•å½“å‰ç´¢å¼•ï¼‰</li>
<li><strong>ç»“åˆ AI æµå¼å“åº”</strong>ï¼šå¯¹æ¥ AI æ¥å£çš„æµå¼è¿”å›ï¼Œå®æ—¶æ›´æ–°æ‰“å­—æ–‡æœ¬</li>
</ol>
<h2 data-id="heading-11">ğŸ“Œ æ€»ç»“</h2>
<p>è¿™ä¸ªæ‰“å­—æœºç»„ä»¶åŸºäº Vue3 Composition API å¼€å‘ï¼Œå…·å¤‡<strong>é«˜å¤ç”¨æ€§ã€é«˜å®šåˆ¶æ€§</strong>çš„ç‰¹ç‚¹ï¼Œæ ¸å¿ƒä¼˜åŒ–ç‚¹å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®Œå–„çš„å®šæ—¶å™¨ç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
<li>ç²¾å‡†çš„çŠ¶æ€æ§åˆ¶ï¼Œæ”¯æŒæ‰“å­—/åˆ é™¤/å¾ªç¯å…¨æµç¨‹</li>
<li>çµæ´»çš„æ ·å¼è‡ªå®šä¹‰ï¼Œé€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯</li>
<li>æš´éœ²æ§åˆ¶æ–¹æ³•ï¼Œæ”¯æŒçˆ¶ç»„ä»¶æ‰‹åŠ¨å¹²é¢„</li>
</ol>
<p>ç»„ä»¶å¯ç›´æ¥é›†æˆåˆ° Vue3 é¡¹ç›®ä¸­ï¼Œé€‚ç”¨äº AI èŠå¤©ã€ä¸ªäººä¸»é¡µã€äº§å“ä»‹ç»ç­‰éœ€è¦æ‰“å­—æœºæ•ˆæœçš„åœºæ™¯ï¼Œå¼€ç®±å³ç”¨ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue2 çš„å“åº”å¼åŸç†]]></title>    <link>https://juejin.cn/post/7598459769238749218</link>    <guid>https://juejin.cn/post/7598459769238749218</guid>    <pubDate>2026-01-24T07:38:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598459769238749218" data-draft-id="7598465042968117288" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue2 çš„å“åº”å¼åŸç†"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-01-24T07:38:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·10063310408"/> <meta itemprop="url" content="https://juejin.cn/user/2103809314920539"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue2 çš„å“åº”å¼åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2103809314920539/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·10063310408
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:38:28.000Z" title="Sat Jan 24 2026 07:38:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue2 çš„å“åº”å¼åŸç†</h2>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4ed082d9906441ba83afeb720cb4552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MTAwNjMzMTA0MDg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845458&amp;x-signature=hmrnTglCoUxxl2vkDQrLyVzPR%2Bg%3D" alt="1.png" width="100%" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4cf6543721648579871f5d6f8935ba3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MTAwNjMzMTA0MDg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845458&amp;x-signature=GdWyigDgLiINj6aM5wIYO5QFgdE%3D" alt="Vue2 ç”Ÿå‘½å‘¨æœŸ.png" width="100%" loading="lazy"/>
<h2 data-id="heading-1">Object.defineProperty</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, prop, descriptor)
  objï¼šå¿…éœ€ã€‚è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„å¯¹è±¡ã€‚
  propï¼šå¿…éœ€ã€‚è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„å±æ€§åã€‚
  descriptorï¼šå¿…éœ€ã€‚è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°ç¬¦ã€‚
</code></pre>
<p><strong>å­˜å–å™¨ getter/setter</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> obj = {}
<span class="hljs-keyword">var</span> value = <span class="hljs-string">'hello'</span>

<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">'key'</span>, {
  <span class="hljs-comment">// å½“è·å– obj['key'] å€¼çš„æ—¶å€™è§¦å‘è¯¥å‡½æ•°ã€‚</span>
  <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> value
  },
  <span class="hljs-comment">// å½“è®¾ç½® obj['key'] å€¼çš„æ—¶å€™è§¦å‘è¯¥å‡½æ•°ã€‚</span>
  <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">newValue</span>) {
    value = newValue
  }
})
</code></pre>
<p>â€‹		æ³¨æ„ï¼šä¸è¦åœ¨ getter ä¸­è·å–è¯¥å±æ€§çš„å€¼ï¼Œä¹Ÿä¸è¦åœ¨ setter ä¸­è®¾ç½®è¯¥å±æ€§çš„å€¼ï¼Œå¦åˆ™ä¼šå‘ç”Ÿæ ˆæº¢å‡ºã€‚</p>
<h2 data-id="heading-2">å®ç°æ•°æ®ä»£ç†å’ŒåŠ«æŒ</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
      <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
      <span class="hljs-keyword">let</span> value = data[keys[i]]
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è·å–äº† data çš„ <span class="hljs-subst">${keys[i]}</span> å€¼ã€‚`</span>)
          <span class="hljs-keyword">return</span> value
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è®¾ç½®äº† data çš„ <span class="hljs-subst">${keys[i]}</span> å€¼ã€‚`</span>)
          value = newValue
        }
      })
    }
  }
}
</code></pre>
<h2 data-id="heading-3">å®ç°æ•°æ®ä»£ç†å’Œé€’å½’åŠ«æŒ</h2>
<p>â€‹		é¦–å…ˆå°†æ•°æ®é€’å½’åŠ«æŒé€»è¾‘æŠ½ç¦»åˆ° observe å·¥å‚å‡½æ•°ä¸­ï¼›ç„¶åæ–°å®šä¹‰ä¸€ä¸ª Observer ç±»ï¼Œä¸ºåç»­çš„å·¥ä½œåšé“ºå«ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-comment">// TODOï¼šæ•°ç»„çš„è§‚å¯Ÿé€»è¾‘æš‚æ—¶è¿˜æ²¡å®ç°ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è·å–äº† <span class="hljs-subst">${key}</span> å€¼ã€‚`</span>)
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è®¾ç½®äº† <span class="hljs-subst">${key}</span> å€¼ã€‚`</span>)
      <span class="hljs-title function_">observe</span>(newValue)
      value = newValue
    }
  })
}
</code></pre>
<h2 data-id="heading-4">å®ç° watch ç›‘å¬</h2>
<p>â€‹		ä¸‹é¢æ˜¯ Vue ä¸­çš„ watch é€‰é¡¹ä¸ $watch æ–¹æ³•çš„å®ç°åŸç†ã€‚ï¼ˆæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚ï¼‰</p>
<p>â€‹		æ¯ä¸ªå“åº”å¼å±æ€§éƒ½æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„â€œç­â€ã€‚åœ¨è¯¥å“åº”å¼å±æ€§è¢«å…¶ä»–å›è°ƒå‡½æ•°ä¾èµ–çš„æ—¶å€™ï¼ŒVue ä¼šé€šè¿‡è¿™ä¸ªâ€œç­â€çš„ depend æ–¹æ³•æŠŠè¿™äº›å›è°ƒå‡½æ•°æ·»åŠ åˆ°è¿™ä¸ªâ€œç­â€çš„ subs å±æ€§ä¸­ã€‚åœ¨è¯¥å“åº”å¼å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒVue ä¼šé€šè¿‡è¿™ä¸ªâ€œç­â€çš„ notify æ–¹æ³•æŠŠè¿™ä¸ªâ€œç­â€çš„ subs å±æ€§ä¸­çš„è¿™äº›å›è°ƒå‡½æ•°å–å‡ºæ¥å…¨éƒ¨æ‰§è¡Œã€‚</p>
<p>â€‹		åœ¨ Vue ä¸­ï¼Œâ€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ï¼Œå›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-comment">// TODOï¼šæ•°ç»„çš„è§‚å¯Ÿé€»è¾‘æš‚æ—¶è¿˜æ²¡å®ç°ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-title function_">observe</span>(newValue)
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>)
    }
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">run</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
  }
}
</code></pre>
<p>â€‹		åœ¨ Vue ä¸­ï¼š1ã€è¢«åŒ…è£…æˆ Watcher å®ä¾‹çš„å›è°ƒå‡½æ•°æ˜¯è¢«å¼‚æ­¥è°ƒç”¨çš„ï¼›2ã€åœ¨è¯¥å›è°ƒå‡½æ•°è¢«å¼‚æ­¥è°ƒç”¨ä¹‹åå’Œå®é™…æ‰§è¡Œä¹‹å‰çš„è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœè§¦å‘è¯¥å›è°ƒå‡½æ•°çš„å“åº”å¼å±æ€§çš„å€¼åˆè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆè¿™äº›åç»­çš„ä¿®æ”¹æ“ä½œå°†æ— æ³•å†æ¬¡è§¦å‘è¯¥å›è°ƒå‡½æ•°çš„è°ƒç”¨ã€‚æ‰€ä»¥ Watcher ç±»çš„å®ç°åŸç†ï¼Œå®é™…å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}
</code></pre>
<h2 data-id="heading-5">ä»ç„¶å­˜åœ¨çš„é—®é¢˜</h2>
<p>â€‹		è‡³æ­¤ï¼ŒåŸºæœ¬å®ç°äº† Vue ä¸­åŸºäºå‘å¸ƒè®¢é˜…çš„ watch ç›‘å¬é€»è¾‘ã€‚ä½†ç›®å‰ä»ç„¶å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š1ã€<strong>å¯¹è±¡çš„æ–°å¢å±æ€§</strong>æ²¡æœ‰è¢«æ·»åŠ æ•°æ®åŠ«æŒé€»è¾‘ï¼›2ã€<strong>æ•°ç»„å…ƒç´ </strong>çš„æ•°æ®åŠ«æŒé€»è¾‘è¿˜å­˜åœ¨é—®é¢˜ã€‚å› æ­¤åœ¨å¯¹å¯¹è±¡çš„æ–°å¢å±æ€§å’Œæ•°ç»„å…ƒç´ æ·»åŠ ç›‘å¬é€»è¾‘æ—¶ä¹Ÿä¼šå­˜åœ¨é—®é¢˜ã€‚</p>
<h2 data-id="heading-6">å®ç° $set æ–¹æ³•</h2>
<p>â€‹		åœ¨ Vue ä¸­ï¼Œå¦‚æœå“åº”å¼å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬æ•°ç»„ï¼‰ï¼Œé‚£ä¹ˆåœ¨è¯¥å“åº”å¼å±æ€§ä¸Šå°±ä¼šè¢«æŒ‚è½½ä¸€ä¸ª _ ob _ å±æ€§ï¼Œè¯¥ _ ob _ å±æ€§çš„å€¼æ˜¯ä¸€ä¸ª Observer å®ä¾‹ï¼Œè¯¥ Observer å®ä¾‹çš„ dep å±æ€§çš„å€¼æ˜¯ä¸€ä¸ª Dep å®ä¾‹ï¼Œè¯¥ Dep å®ä¾‹æ˜¯å’Œ defineReactive æ–¹æ³•çš„é—­åŒ…ä¸­çš„ Dep å®ä¾‹ä¸åŒçš„ä¸è¯¥å“åº”å¼å±æ€§ç»‘å®šçš„å¦å¤–ä¸€ä¸ªâ€œç­â€ã€‚</p>
<p>â€‹		å½“å“åº”å¼å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬æ•°ç»„ï¼‰æ—¶ï¼ŒVue ä¼šæŠŠè§¦å‘è¯¥å“åº”å¼å±æ€§çš„ getter çš„ watchers é¢å¤–æ”¶é›†ä¸€ä»½åœ¨è¯¥å“åº”å¼å±æ€§çš„ _ ob _ å±æ€§çš„ dep å±æ€§çš„ subs å±æ€§ä¸­ã€‚è¿™æ ·å¼€å‘è€…å°±å¯ä»¥é€šè¿‡ä»£ç <strong>å‘½ä»¤å¼</strong>åœ°å»è§¦å‘è¿™ä¸ªå“åº”å¼å±æ€§çš„ watchers äº†ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8574cad12415492f9c8c28397d6197ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MTAwNjMzMTA0MDg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845458&amp;x-signature=1nJlxfUZ7RgKeXJnED%2FuQjKbOZ8%3D" alt="2.png" width="100%" loading="lazy"/>
<p><strong>$set æ–¹æ³•çš„å®ç°æ€è·¯åŸºæœ¬å¦‚ä¸‹ï¼š</strong></p>
<p>â€‹		1ã€åœ¨åˆ›å»º Observer å¯¹è±¡çš„å®ä¾‹å»è§‚å¯Ÿå“åº”å¼å±æ€§æ—¶ï¼ŒåŒæ—¶ä¹Ÿåˆ›å»ºä¸€ä¸ª Dep å¯¹è±¡çš„å®ä¾‹ã€‚å…ˆå°†è¯¥ Dep å¯¹è±¡çš„å®ä¾‹æŒ‚è½½åˆ°è¯¥ Observer å¯¹è±¡çš„å®ä¾‹ä¸Šï¼Œç„¶åæŠŠè¯¥ Observer å¯¹è±¡çš„å®ä¾‹æŒ‚è½½åˆ°å®ƒè‡ªå·±è§‚å¯Ÿçš„å“åº”å¼å±æ€§ä¸Šã€‚</p>
<p>â€‹		2ã€å½“å“åº”å¼å±æ€§çš„ getter è¢«è§¦å‘æ—¶ï¼ŒæŠŠä¸è¯¥å“åº”å¼å±æ€§ç»‘å®šçš„â€œç­â€çš„ depend æ–¹æ³•è°ƒç”¨ä¸€éã€‚å“åº”å¼å±æ€§çš„å€¼ä¸ºå¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œæœ‰ä¸¤ä¸ªç­ï¼›å“åº”å¼å±æ€§çš„å€¼ä¸ä¸ºå¯¹è±¡å’Œæ•°ç»„æ—¶ï¼Œæœ‰ä¸€ä¸ªç­ã€‚</p>
<p>â€‹		3ã€å½“ç”¨æˆ·è°ƒç”¨ $set æ–¹æ³•æ—¶ï¼Œå¦‚æœ target ä¸ºå¯¹è±¡ï¼Œåˆ™ Vue å…ˆè°ƒç”¨ defineReactive æ–¹æ³•æŠŠè®¾ç½®çš„å±æ€§ä¹Ÿå®šä¹‰ä¸ºå“åº”å¼ï¼Œç„¶åè°ƒç”¨ target._ ob _.dep.notify æ–¹æ³•è§¦å‘ target çš„ watchersã€‚ï¼ˆtarget ä¸ºæ•°ç»„çš„æƒ…å†µæš‚æ—¶æœªå®ç°ã€‚ï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  <span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº† target ä¸ºå¯¹è±¡çš„æƒ…å†µï¼Œtarget ä¸ºæ•°ç»„çš„æƒ…å†µè¿˜æœªå®ç°ã€‚</span>
  $set(target, key, value) {
    <span class="hljs-title function_">defineReactive</span>(target, key, value)
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-comment">// TODOï¼šæ•°ç»„çš„è§‚å¯Ÿé€»è¾‘æš‚æ—¶è¿˜æ²¡å®ç°ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>)
    }
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">run</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}
</code></pre>
<h2 data-id="heading-7">å®ç°æ•°ç»„æ–¹æ³•çš„é‡å†™</h2>
<p><strong>Vue å¯¹æ•°ç»„çš„å¤„ç†æ€è·¯åŸºæœ¬å¦‚ä¸‹ï¼š</strong></p>
<p>â€‹		1ã€å¯¹æ•°ç»„æœ¬èº«ä¸ä½¿ç”¨ Object.defineProperty æ–¹æ³•è¿›è¡Œæ•°æ®åŠ«æŒï¼Œå¯¹æ•°ç»„å…ƒç´ ä¾æ¬¡ä½¿ç”¨ observe æ–¹æ³•è¿›è¡Œæ•°æ®è§‚å¯Ÿã€‚å› æ­¤ï¼Œ<strong>æ•°ç»„å…ƒç´ ä¸å…·æœ‰å“åº”æ€§ï¼Œæ•°ç»„å…ƒç´ çš„å±æ€§ä»ç„¶å…·æœ‰å“åº”æ€§</strong>ã€‚</p>
<p>â€‹		2ã€å¯¹æ•°ç»„çš„ pushã€popã€shiftã€unshiftã€spliceã€sortã€reverse å®ä¾‹æ–¹æ³•è¿›è¡Œé‡å†™ã€‚åœ¨è¿™äº›é‡å†™çš„å®ä¾‹æ–¹æ³•ä¸­ï¼ŒVue å…ˆè°ƒç”¨æ•°ç»„çš„åŸå§‹åŒåå®ä¾‹æ–¹æ³•ï¼Œç„¶åå†è°ƒç”¨ this._ ob _.dep.notify æ–¹æ³•å»è§¦å‘è¯¥æ•°ç»„çš„ watchersã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  $set(target, key, value) {
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target)
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">const</span> arratProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
      <span class="hljs-title function_">observe</span>(value)
      arratProto.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(target, key, <span class="hljs-number">1</span>, value)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-title function_">defineReactive</span>(target, key, value)
    }
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      data.<span class="hljs-property">__proto__</span> = arrayMethods
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(data)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
    }
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }

  <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">array</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">observe</span>(array[i])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>)
    }
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">run</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}

<span class="hljs-keyword">const</span> mutationMethods = [<span class="hljs-string">'push'</span>, <span class="hljs-string">'pop'</span>, <span class="hljs-string">'shift'</span>, <span class="hljs-string">'unshift'</span>, <span class="hljs-string">'splice'</span>, <span class="hljs-string">'sort'</span>, <span class="hljs-string">'reverse'</span>]
<span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
<span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)
mutationMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  arrayMethods[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (method === <span class="hljs-string">'push'</span> || method === <span class="hljs-string">'unshift'</span> || method === <span class="hljs-string">'splice'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-title function_">observeArray</span>(args)
    }
    <span class="hljs-keyword">const</span> result = arrayProto[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
    <span class="hljs-keyword">return</span> result
  }
})
</code></pre>
<h2 data-id="heading-8">å®ç° computed è®¡ç®—å±æ€§</h2>
<p><strong>Vue ä¸­ computed è®¡ç®—å±æ€§çš„ç‰¹æ€§ï¼š</strong></p>
<p>â€‹		1ã€è®¡ç®—å±æ€§ä¸å­˜åœ¨äº data é€‰é¡¹ä¸­ï¼Œå› æ­¤è®¡ç®—å±æ€§éœ€è¦å•ç‹¬è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<p>â€‹		2ã€è®¡ç®—å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•°è¿è¡Œä¹‹åçš„è¿”å›å€¼ã€‚</p>
<p>â€‹		3ã€è®¡ç®—å±æ€§çš„å€¼â€œåªèƒ½å–ï¼Œä¸èƒ½å­˜â€ï¼Œå³è®¡ç®—å±æ€§çš„ setter æ— æ•ˆã€‚</p>
<p>â€‹		4ã€è®¡ç®—å±æ€§æ‰€ä¾èµ–çš„å“åº”å¼å±æ€§çš„å€¼ï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œä¾¿ä¼šå¼•èµ·è¯¥è®¡ç®—å±æ€§çš„å€¼ï¼Œä¸€åŒå‘ç”Ÿå˜åŒ–ã€‚</p>
<p>â€‹		5ã€è®¡ç®—å±æ€§æ˜¯<strong>æƒ°æ€§</strong>çš„ï¼šè®¡ç®—å±æ€§æ‰€ä¾èµ–çš„å“åº”å¼å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¸ä¼šç«‹å³å¼•èµ·è¯¥è®¡ç®—å±æ€§çš„å€¼ä¸€åŒå‘ç”Ÿå˜åŒ–ï¼Œè€Œæ˜¯ç­‰åˆ°è¯¥è®¡ç®—å±æ€§çš„å€¼è¢«è·å–æ—¶æ‰ä¼šä½¿å¾— Vue å¯¹å®ƒçš„å€¼è¿›è¡Œé‡æ–°è®¡ç®—ã€‚</p>
<p>â€‹		6ã€è®¡ç®—å±æ€§æ˜¯<strong>ç¼“å­˜</strong>çš„ï¼šå¦‚æœè®¡ç®—å±æ€§æ‰€ä¾èµ–çš„å“åº”å¼å±æ€§çš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå³ä½¿å¤šæ¬¡è·å–è¯¥è®¡ç®—å±æ€§çš„å€¼ï¼ŒVue ä¹Ÿä¸ä¼šå¯¹è¯¥è®¡ç®—å±æ€§çš„å€¼è¿›è¡Œé‡æ–°è®¡ç®—ã€‚</p>
<p><strong>æ³¨ï¼šå¯¹äºè®¡ç®—å±æ€§ A ä¾èµ–è®¡ç®—å±æ€§ B çš„æƒ…å†µï¼Œä¸‹é¢çš„ä»£ç å¥½åƒå·²ç»å®ç°äº†ï¼Œä½†è¿˜éœ€è¿›ä¸€æ­¥çš„æµ‹è¯•éªŒè¯ã€‚</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initComputed</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initComputed</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> computed = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">computed</span>
    <span class="hljs-keyword">if</span> (computed) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(computed)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> watcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, computed[keys[i]], <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}, { <span class="hljs-attr">lazy</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
          <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedGetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (watcher.<span class="hljs-property">dirty</span>) {
              watcher.<span class="hljs-title function_">get</span>()
              watcher.<span class="hljs-property">dirty</span> = <span class="hljs-literal">false</span>
            }
            watcher.<span class="hljs-property">deps</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">dep</span> =&gt;</span> {
              dep.<span class="hljs-title function_">depend</span>()
            })
            <span class="hljs-keyword">return</span> watcher.<span class="hljs-property">value</span>
          },
          <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedSetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'è¯·ä¸è¦ç»™è®¡ç®—å±æ€§èµ‹å€¼!'</span>)
          }
        })
      }
    }
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  $set(target, key, value) {
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target)
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">const</span> arratProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
      <span class="hljs-title function_">observe</span>(value)
      arratProto.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(target, key, <span class="hljs-number">1</span>, value)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-title function_">defineReactive</span>(target, key, value)
    }
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      data.<span class="hljs-property">__proto__</span> = arrayMethods
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(data)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
    }
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }

  <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">array</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">observe</span>(array[i])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)
    }
  }

  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">watcher</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(watcher) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(watcher)
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">update</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> targetStack = []
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = !!options.<span class="hljs-property">lazy</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
    }
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    targetStack.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    }
    targetStack.<span class="hljs-title function_">pop</span>()
    <span class="hljs-keyword">if</span> (targetStack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = targetStack[targetStack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
    }
  }

  <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">indexOf</span>(dep) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">push</span>(dep)
    dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)
  }

  <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()
    }
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æ›´æ–° this.value(watcher.value) çš„å€¼ã€‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}

<span class="hljs-keyword">const</span> mutationMethods = [<span class="hljs-string">'push'</span>, <span class="hljs-string">'pop'</span>, <span class="hljs-string">'shift'</span>, <span class="hljs-string">'unshift'</span>, <span class="hljs-string">'splice'</span>, <span class="hljs-string">'sort'</span>, <span class="hljs-string">'reverse'</span>]
<span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
<span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)
mutationMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  arrayMethods[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (method === <span class="hljs-string">'push'</span> || method === <span class="hljs-string">'unshift'</span> || method === <span class="hljs-string">'splice'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-title function_">observeArray</span>(args)
    }
    <span class="hljs-keyword">const</span> result = arrayProto[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
    <span class="hljs-keyword">return</span> result
  }
})
</code></pre>
<h2 data-id="heading-9">Vue æ¨¡æ¿å“åº”å¼æ›´æ–°çš„åŸç†</h2>
<p>â€‹		Vue å¯¹æ¨¡æ¿çš„å“åº”å¼æ›´æ–°ï¼Œå°±æ˜¯å¦‚åŒä»£ç ä¸­çš„ initRenderWatch æ–¹æ³•è¿™æ ·åšçš„ã€‚åœ¨ Vue ä¸­ï¼Œå“åº”å¼æ›´æ–°æ¨¡æ¿çš„ watcher è¢«ç§°ä¸º render watcherï¼Œè¯¥ watcher çš„æ±‚å€¼å‡½æ•°æ¯”ä»£ç ä¸­çš„ initRenderWatch æ–¹æ³•ä¸­çš„ watcher çš„æ±‚å€¼å‡½æ•°å¤æ‚çš„å¤šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initComputed</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRenderWatch</span>()
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initComputed</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> computed = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">computed</span>
    <span class="hljs-keyword">if</span> (computed) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(computed)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> watcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, computed[keys[i]], <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}, { <span class="hljs-attr">lazy</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
          <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedGetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (watcher.<span class="hljs-property">dirty</span>) {
              watcher.<span class="hljs-title function_">get</span>()
              watcher.<span class="hljs-property">dirty</span> = <span class="hljs-literal">false</span>
            }
            watcher.<span class="hljs-property">deps</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">dep</span> =&gt;</span> {
              dep.<span class="hljs-title function_">depend</span>()
            })
            <span class="hljs-keyword">return</span> watcher.<span class="hljs-property">value</span>
          },
          <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedSetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'è¯·ä¸è¦ç»™è®¡ç®—å±æ€§èµ‹å€¼!'</span>)
          }
        })
      }
    }
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  <span class="hljs-title function_">initRenderWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(
      <span class="hljs-variable language_">this</span>,
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#app'</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`&lt;p&gt;<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>&lt;/p&gt;`</span>
      },
      <span class="hljs-function">() =&gt;</span> {}
    )
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  $set(target, key, value) {
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target)
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
      <span class="hljs-title function_">observe</span>(value)
      arrayProto.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(target, key, <span class="hljs-number">1</span>, value)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-title function_">defineReactive</span>(target, key, value)
    }
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      data.<span class="hljs-property">__proto__</span> = arrayMethods
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(data)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
    }
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }

  <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">array</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">observe</span>(array[i])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)
    }
  }

  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">watcher</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(watcher) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(watcher)
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">update</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> targetStack = []
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = !!options.<span class="hljs-property">lazy</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
    }
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    targetStack.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    }
    targetStack.<span class="hljs-title function_">pop</span>()
    <span class="hljs-keyword">if</span> (targetStack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = targetStack[targetStack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
    }
  }

  <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">indexOf</span>(dep) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">push</span>(dep)
    dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)
  }

  <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()
    }
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æ›´æ–° this.value(watcher.value) çš„å€¼ã€‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}

<span class="hljs-keyword">const</span> mutationMethods = [<span class="hljs-string">'push'</span>, <span class="hljs-string">'pop'</span>, <span class="hljs-string">'shift'</span>, <span class="hljs-string">'unshift'</span>, <span class="hljs-string">'splice'</span>, <span class="hljs-string">'sort'</span>, <span class="hljs-string">'reverse'</span>]
<span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
<span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)
mutationMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  arrayMethods[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (method === <span class="hljs-string">'push'</span> || method === <span class="hljs-string">'unshift'</span> || method === <span class="hljs-string">'splice'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-title function_">observeArray</span>(args)
    }
    <span class="hljs-keyword">const</span> result = arrayProto[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
    <span class="hljs-keyword">return</span> result
  }
})
</code></pre>
<p><strong>Vue å¯¹æ¨¡æ¿å“åº”å¼æ›´æ–°çš„å¤„ç†æ€è·¯åŸºæœ¬å¦‚ä¸‹ï¼š</strong></p>
<p>â€‹		1ã€**æ¨¡æ¿ç¼–è¯‘ï¼š**å¦‚æœä¼ å…¥äº† template æˆ–è€… DOMï¼Œé‚£ä¹ˆåœ¨ Vue å®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒVue é¦–å…ˆä¼šæŠŠæ¨¡æ¿å­—ç¬¦ä¸²è½¬åŒ–æˆæ¸²æŸ“å‡½æ•°ï¼ˆvm.$options.renderï¼‰ã€‚</p>
<p>â€‹		2ã€**è™šæ‹Ÿ DOMï¼š**Vue å€ŸåŠ©è¿™ä¸ªæ¸²æŸ“å‡½æ•°å»å“åº”å¼æ›´æ–°æ¨¡æ¿çš„æ—¶å€™ï¼Œå¦‚æœ Vue ç›´æ¥å»æ“ä½œ DOMï¼Œé‚£ä¹ˆä¼šæå¤§çš„æ¶ˆè€—æµè§ˆå™¨çš„æ€§èƒ½ã€‚äºæ˜¯ Vue å¼•å…¥ Virtual-DOM (è™šæ‹Ÿ DOMï¼‰ï¼Œå€ŸåŠ©å®ƒæ¥å®ç°å¯¹ DOM çš„æŒ‰éœ€æ›´æ–°ã€‚</p>
<h2 data-id="heading-10">å®ç°æ¨¡æ¿ç¼–è¯‘</h2>
<p>â€‹		å¦‚æœä¼ å…¥äº† template æˆ–è€… DOMï¼Œé‚£ä¹ˆåœ¨ Vue å®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒVue é¦–å…ˆä¼šæŠŠæ¨¡æ¿å­—ç¬¦ä¸²è½¬åŒ–æˆæ¸²æŸ“å‡½æ•°ï¼ˆvm.$options.renderï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ Vue çš„<strong>æ¨¡æ¿ç¼–è¯‘</strong>ã€‚</p>
<p>â€‹		Vue æ¨¡æ¿ç¼–è¯‘çš„æ•´ä½“é€»è¾‘ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š1ã€<strong>è§£æå™¨ï¼š<strong>å°†</strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong>è½¬æ¢æˆ <strong>AST</strong>ã€‚2ã€**ä¼˜åŒ–å™¨ï¼š**å¯¹ <strong>AST</strong> è¿›è¡Œé™æ€èŠ‚ç‚¹æ ‡è®°ã€‚ä¸»è¦æ˜¯ä¸ºäº†ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ã€‚ï¼ˆè¿™é‡Œä¸åšä»‹ç»ï¼‰3ã€**ä»£ç ç”Ÿæˆå™¨ï¼š**å°† <strong>AST</strong> è½¬æ¢æˆ <strong>render</strong> å‡½æ•°ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/669c30a84927493da076d122abfcb96b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MTAwNjMzMTA0MDg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845458&amp;x-signature=xg0tLK%2Fl2Rn13BQiwckuL9Kht1s%3D" alt="5.png" width="100%" loading="lazy"/>
<h3 data-id="heading-11"><strong>AST</strong></h3>
<p>â€‹		ASTï¼Œå³æŠ½è±¡è¯­æ³•æ ‘ï¼Œæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„æŠ½è±¡è¡¨ç¤ºã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fastexplorer.net%2F" target="_blank" title="https://astexplorer.net/" ref="nofollow noopener noreferrer">JS AST åœ¨çº¿ç”Ÿæˆ</a></p>
<p>â€‹		Vue ä¸­ AST çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-attr">children</span>: [{â€¦}], <span class="hljs-comment">// å¶å­èŠ‚ç‚¹æ²¡æœ‰ children å±æ€§ã€‚</span>
  <span class="hljs-attr">parent</span>: {}, <span class="hljs-comment">// æ ¹èŠ‚ç‚¹çš„ parent å±æ€§çš„å€¼ä¸º undefinedã€‚</span>
  <span class="hljs-attr">tag</span>: <span class="hljs-string">"div"</span>, <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹çš„ä¸“å±å±æ€§ã€‚</span>
  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// 1ï¼šå…ƒç´ èŠ‚ç‚¹ã€‚2ï¼šå¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚3ï¼šçº¯æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-attr">expression</span>:<span class="hljs-string">'"å§“åï¼š" + _s(name)'</span>, <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹çš„ä¸“å±å±æ€§ã€‚å¦‚æœ type å€¼æ˜¯ 3ï¼Œåˆ™ expression å€¼ä¸º ''ã€‚</span>
  <span class="hljs-attr">text</span>:<span class="hljs-string">'å§“åï¼š{{name}}'</span> <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹çš„ä¸“å±å±æ€§ã€‚text å€¼ä¸ºæ–‡æœ¬èŠ‚ç‚¹ç¼–è¯‘å‰çš„å­—ç¬¦ä¸²ã€‚</span>
}
</code></pre>
<h3 data-id="heading-12"><strong>è§£æå™¨ï¼ˆparserï¼‰</strong></h3>
<p>â€‹		æºä»£ç è¢«è§£ææˆ AST çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼šè¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/824e21f1c88f4557b2834a36a61baafe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MTAwNjMzMTA0MDg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845458&amp;x-signature=IVeFpVM4K6V3h91piHvEpQJaIgE%3D" alt="6.png" width="100%" loading="lazy"/>
<p>â€‹		Vue ä¸­çš„è§£æå™¨å¯¹æ¨¡æ¿å­—ç¬¦ä¸²è¿›è¡Œè§£ææ—¶ï¼Œæ˜¯æ¯äº§ç”Ÿä¸€ä¸ª token ä¾¿ä¼šç«‹å³å¯¹è¯¥ token è¿›è¡Œå¤„ç†ï¼Œå³è¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æåŒæ—¶è¿›è¡Œï¼Œæˆ–è€…è¯´æ²¡æœ‰è¯æ³•åˆ†æåªæœ‰è¯­æ³•åˆ†æã€‚</p>
<p>â€‹		ä¸‹é¢ä»¥æœ€å•çº¯çš„ HTML æ¨¡æ¿ä¸ºä¾‹ï¼Œé˜è¿° Vue ä¸­çš„è§£æå™¨å°†æ¨¡æ¿å­—ç¬¦ä¸²è½¬æ¢æˆ AST çš„åŸç†ã€‚ï¼ˆv-modelã€v-bindã€v-ifã€v-forã€@click ä»¥åŠ HTML ä¸­çš„å•æ ‡ç­¾å…ƒç´ ã€DOM å±æ€§ã€HTML æ³¨é‡Šç­‰æƒ…å†µéƒ½ä¸äºˆä»¥è€ƒè™‘ã€‚ï¼‰</p>
<p>â€‹		**è§£ææ€è·¯ï¼š**ä»¥ &lt; ä¸ºæ ‡è¯†ç¬¦ï¼Œä»£è¡¨å¼€å§‹æ ‡ç­¾æˆ–ç»“æŸæ ‡ç­¾ã€‚ä½¿ç”¨æ ˆç»“æ„å»ç»´æŠ¤å½“å‰æ¨¡æ¿è¢«è§£æåˆ°çš„å±‚çº§ã€‚å¦‚æœæ˜¯å¼€å§‹æ ‡ç­¾ï¼Œä»£è¡¨ AST çš„å±‚çº§ push äº†ä¸€å±‚ï¼›å¦‚æœæ˜¯ç»“æŸæ ‡ç­¾ï¼Œä»£è¡¨  AST  çš„å±‚çº§ pop äº†ä¸€å±‚ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">template</span>) {
  <span class="hljs-keyword">let</span> root = <span class="hljs-literal">null</span>
  <span class="hljs-keyword">let</span> currentParent
  <span class="hljs-keyword">const</span> stack = []

  <span class="hljs-comment">// è·³è¿‡ç©ºç™½å­—ç¬¦ä¸²ã€‚</span>
  template = template.<span class="hljs-title function_">trim</span>()

  <span class="hljs-keyword">while</span> (template) {
    <span class="hljs-keyword">const</span> ltIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&lt;'</span>)
    <span class="hljs-comment">// ltIndex === -1 çš„æƒ…å†µä¸ä¼šå‡ºç°ã€‚</span>
    <span class="hljs-comment">// ltIndex &gt; 0 æ ‡ç­¾å‰é¢æœ‰æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
    <span class="hljs-comment">// ltIndex === 0 &amp;&amp; template[ltIndex + 1] !== '/' å¼€å§‹æ ‡ç­¾ã€‚</span>
    <span class="hljs-comment">// ltIndex === 0 &amp;&amp; template[ltIndex + 1] === '/' ç»“æŸæ ‡ç­¾ã€‚</span>
    <span class="hljs-keyword">if</span> (ltIndex &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-comment">// typeï¼š1-å…ƒç´ èŠ‚ç‚¹ï¼›2-å¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ï¼›3-çº¯æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
      <span class="hljs-keyword">const</span> text = template.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, ltIndex)
      <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">parseText</span>(text)
      element.<span class="hljs-property">parent</span> = currentParent
      <span class="hljs-keyword">if</span> (!currentParent.<span class="hljs-property">children</span>) {
        currentParent.<span class="hljs-property">children</span> = []
      }
      currentParent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(element)
      template = template.<span class="hljs-title function_">slice</span>(ltIndex)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ltIndex === <span class="hljs-number">0</span> &amp;&amp; template[ltIndex + <span class="hljs-number">1</span>] !== <span class="hljs-string">'/'</span>) {
      <span class="hljs-keyword">const</span> gtIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&gt;'</span>)
      <span class="hljs-keyword">const</span> element = {
        <span class="hljs-attr">parent</span>: currentParent, <span class="hljs-comment">// æ ¹èŠ‚ç‚¹çš„ parent å±æ€§å€¼ä¸º undefinedã€‚</span>
        <span class="hljs-attr">tag</span>: template.<span class="hljs-title function_">slice</span>(ltIndex + <span class="hljs-number">1</span>, gtIndex), <span class="hljs-comment">// åªè€ƒè™‘å¼€å§‹æ ‡ç­¾ä¸­æ²¡æœ‰ä»»ä½•å±æ€§çš„æƒ…å†µã€‚</span>
        <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>
      }
      <span class="hljs-keyword">if</span> (currentParent) {
        <span class="hljs-keyword">if</span> (!currentParent.<span class="hljs-property">children</span>) {
          currentParent.<span class="hljs-property">children</span> = []
        }
        currentParent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(element)
      } <span class="hljs-keyword">else</span> {
        root = element
      }
      currentParent = element
      stack.<span class="hljs-title function_">push</span>(element)
      template = template.<span class="hljs-title function_">slice</span>(gtIndex + <span class="hljs-number">1</span>)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ltIndex === <span class="hljs-number">0</span> &amp;&amp; template[ltIndex + <span class="hljs-number">1</span>] === <span class="hljs-string">'/'</span>) {
      <span class="hljs-keyword">const</span> gtIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&gt;'</span>)
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å stack å€¼è¢«è®¾ç½®ä¸º []ã€‚</span>
      stack.<span class="hljs-title function_">pop</span>()
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å currentParent å€¼è¢«è®¾ç½®ä¸º undefinedã€‚</span>
      currentParent = stack[stack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å template å€¼è¢«è®¾ç½®ä¸º ''ã€‚</span>
      template = template.<span class="hljs-title function_">slice</span>(gtIndex + <span class="hljs-number">1</span>)
    }
  }

  <span class="hljs-keyword">return</span> root
}

<span class="hljs-comment">// ä»¥ {{ å’Œ }} ä¸ºæ ‡è¯†ç¬¦ï¼ŒæŠŠ text ä¸­çš„ 'å§“åï¼š{{name}}' è½¬æ¢æˆ '"å§“åï¼š" + _s(name)'ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseText</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-keyword">const</span> originText = text
  <span class="hljs-keyword">const</span> tokens = []
  <span class="hljs-comment">// typeï¼š2-å¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ï¼›3-çº¯æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">let</span> type = <span class="hljs-number">3</span>

  <span class="hljs-keyword">while</span> (text) {
    <span class="hljs-keyword">const</span> start = text.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'{{'</span>)
    <span class="hljs-keyword">const</span> end = text.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'}}'</span>)
    <span class="hljs-keyword">if</span> (start !== -<span class="hljs-number">1</span>) {
      type = <span class="hljs-number">2</span>
      <span class="hljs-keyword">if</span> (start &gt; <span class="hljs-number">0</span>) {
        tokens.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(text.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, start)))
      }
      <span class="hljs-keyword">const</span> exp = text.<span class="hljs-title function_">slice</span>(start + <span class="hljs-number">2</span>, end)
      tokens.<span class="hljs-title function_">push</span>(<span class="hljs-string">`_s(<span class="hljs-subst">${exp}</span>)`</span>)
      text = text.<span class="hljs-title function_">slice</span>(end + <span class="hljs-number">2</span>)
    } <span class="hljs-keyword">else</span> {
      tokens.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(text))
      text = <span class="hljs-string">''</span>
    }
  }

  <span class="hljs-keyword">const</span> element = {
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    type,
    <span class="hljs-attr">expression</span>: type === <span class="hljs-number">2</span> ? tokens.<span class="hljs-title function_">join</span>(<span class="hljs-string">' + '</span>) : <span class="hljs-string">''</span>,
    <span class="hljs-attr">text</span>: originText
  }

  <span class="hljs-keyword">return</span> element
}
</code></pre>
<h3 data-id="heading-13">render</h3>
<p>â€‹		æœ¬å°ç»“ç”Ÿæˆçš„ render å‡½æ•°çš„å‡½æ•°ä½“å­—ç¬¦ä¸²æ˜¯è¿™æ ·çš„ï¼š</p>
<p>â€‹				<strong>'with (this) { return _c("div", {}, [_c("p", {}, [_v("å§“åï¼š" + _s(name))])]) }'ã€‚</strong></p>
<p>â€‹		å…¶ä¸­ _c å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„ç©ºå€¼æ˜¯ []ï¼Œä¸æ˜¯ undefinedã€‚</p>
<h3 data-id="heading-14"><strong>ä»£ç ç”Ÿæˆå™¨ï¼ˆcodegeneratorï¼‰</strong></h3>
<p>â€‹		**ç”Ÿæˆæ€è·¯ï¼š**1ã€éå† ASTï¼Œå¯¹ AST ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå¤„ç†ã€‚2ã€é‡åˆ°å…ƒç´ èŠ‚ç‚¹ç”Ÿæˆ <strong>_c("æ ‡ç­¾å", å±æ€§å¯¹è±¡, åä»£æ•°ç»„)</strong> æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ï¼ˆåä»£æ•°ç»„ä¸ºç©ºæ—¶ä¸º []ï¼Œè€Œä¸æ˜¯ undefinedã€‚ï¼‰3ã€é‡åˆ°çº¯æ–‡æœ¬èŠ‚ç‚¹ç”Ÿæˆ <strong>_v("æ–‡æœ¬å­—ç¬¦ä¸²")</strong> æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚4ã€é‡åˆ°å¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ç”Ÿæˆ <strong>_v(_s(å˜é‡å))</strong> æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚5ã€ä¸ºäº†è®©å­—ç¬¦ä¸²ä¸­çš„å˜é‡èƒ½å¤Ÿåœ¨ render å‡½æ•°ä¸­è¢«æ­£å¸¸å–å€¼ï¼Œåœ¨éå†å®Œ AST åï¼Œ å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²æ•´ä½“å¤–åŒ…ä¸€å±‚ <strong>with(this)</strong>ã€‚6ã€å°†ç»è¿‡ with(this) åŒ…è£…å¤„ç†åçš„å­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°ä½“ï¼Œç”Ÿæˆä¸€ä¸ª <strong>render å‡½æ•°</strong>ï¼Œå¹¶å°†è¿™ä¸ª render å‡½æ•°æŒ‚è½½åˆ° <strong>vm.$options</strong> ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°† AST è½¬æ¢ä¸º render å‡½æ•°çš„å‡½æ•°ä½“çš„å­—ç¬¦ä¸²ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">ast</span>) {
  <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">genNode</span>(ast)
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">render</span>: <span class="hljs-string">`with (this) { return <span class="hljs-subst">${code}</span> }`</span>
  }
}

<span class="hljs-comment">// è½¬æ¢èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genNode</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genElement</span>(node)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genText</span>(node)
  }
}

<span class="hljs-comment">// è½¬æ¢å…ƒç´ èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genElement</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">const</span> children = <span class="hljs-title function_">genChildren</span>(node)
  <span class="hljs-comment">// children çš„ç©ºå€¼æ˜¯ '[]'ï¼Œä¸æ˜¯ 'undefined'ã€‚</span>
  <span class="hljs-keyword">const</span> code = <span class="hljs-string">`_c(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(node.tag)}</span>, {}, <span class="hljs-subst">${children}</span>)`</span>
  <span class="hljs-keyword">return</span> code
}

<span class="hljs-comment">// è½¬æ¢æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genText</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`_v(<span class="hljs-subst">${node.expression}</span>)`</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">3</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`_v(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(node.text)}</span>)`</span>
  }
}

<span class="hljs-comment">// è½¬æ¢å…ƒç´ èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ—è¡¨ä¸­çš„å­èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genChildren</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-comment">// node.children çš„ç©ºå€¼ä¸º undefinedã€‚</span>
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'['</span> + node.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">genNode</span>(child)).<span class="hljs-title function_">join</span>(<span class="hljs-string">', '</span>) + <span class="hljs-string">']'</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'[]'</span>
  }
}
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initComputed</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRenderFunction</span>()
    <span class="hljs-comment">// this.initRenderWatch()</span>
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initComputed</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> computed = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">computed</span>
    <span class="hljs-keyword">if</span> (computed) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(computed)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> watcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, computed[keys[i]], <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}, { <span class="hljs-attr">lazy</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
          <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedGetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (watcher.<span class="hljs-property">dirty</span>) {
              watcher.<span class="hljs-title function_">get</span>()
              watcher.<span class="hljs-property">dirty</span> = <span class="hljs-literal">false</span>
            }
            watcher.<span class="hljs-property">deps</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">dep</span> =&gt;</span> {
              dep.<span class="hljs-title function_">depend</span>()
            })
            <span class="hljs-keyword">return</span> watcher.<span class="hljs-property">value</span>
          },
          <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedSetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'è¯·ä¸è¦ç»™è®¡ç®—å±æ€§èµ‹å€¼!'</span>)
          }
        })
      }
    }
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  <span class="hljs-title function_">initRenderFunction</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> template
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>) {
      template = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>
    } <span class="hljs-keyword">else</span> {
      template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">el</span>).<span class="hljs-property">outerHtml</span>
    }
    <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(template)
    <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">generate</span>(ast).<span class="hljs-property">render</span>
    <span class="hljs-comment">// eslint-disable-next-line no-new-func</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(code)
  }

  <span class="hljs-title function_">initRenderWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(
      <span class="hljs-variable language_">this</span>,
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#app'</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`&lt;p&gt;<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>&lt;/p&gt;`</span>
      },
      <span class="hljs-function">() =&gt;</span> {}
    )
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  $set(target, key, value) {
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target)
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">const</span> arratProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
      <span class="hljs-title function_">observe</span>(value)
      arratProto.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(target, key, <span class="hljs-number">1</span>, value)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-title function_">defineReactive</span>(target, key, value)
    }
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      data.<span class="hljs-property">__proto__</span> = arrayMethods
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(data)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
    }
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }

  <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">array</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">observe</span>(array[i])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)
    }
  }

  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">watcher</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(watcher) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(watcher)
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">update</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> targetStack = []
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = !!options.<span class="hljs-property">lazy</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
    }
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    targetStack.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    }
    targetStack.<span class="hljs-title function_">pop</span>()
    <span class="hljs-keyword">if</span> (targetStack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = targetStack[targetStack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
    }
  }

  <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">indexOf</span>(dep) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">push</span>(dep)
    dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)
  }

  <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()
    }
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æ›´æ–° this.value(watcher.value) çš„å€¼ã€‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}

<span class="hljs-keyword">const</span> mutationMethods = [<span class="hljs-string">'push'</span>, <span class="hljs-string">'pop'</span>, <span class="hljs-string">'shift'</span>, <span class="hljs-string">'unshift'</span>, <span class="hljs-string">'splice'</span>, <span class="hljs-string">'sort'</span>, <span class="hljs-string">'reverse'</span>]
<span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
<span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)
mutationMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  arrayMethods[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (method === <span class="hljs-string">'push'</span> || method === <span class="hljs-string">'unshift'</span> || method === <span class="hljs-string">'splice'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-title function_">observeArray</span>(args)
    }
    <span class="hljs-keyword">const</span> result = arrayProto[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
    <span class="hljs-keyword">return</span> result
  }
})
</code></pre>
<h2 data-id="heading-15">å®ç°è™šæ‹Ÿ DOM</h2>
<h3 data-id="heading-16"><strong>ä»€ä¹ˆæ˜¯è™šæ‹Ÿ DOMï¼Ÿ</strong></h3>
<p>â€‹		çœŸå® DOMã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<p>â€‹		è™šæ‹Ÿ DOMã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-attr">tag</span>: <span class="hljs-string">'ul'</span>,
  <span class="hljs-attr">attrs</span>: {},
  <span class="hljs-attr">children</span>: [
    {
      <span class="hljs-attr">tag</span>: <span class="hljs-string">'li'</span>,
      <span class="hljs-attr">attrs</span>: {},
      <span class="hljs-attr">children</span>: [
        {
          <span class="hljs-attr">tag</span>: <span class="hljs-literal">null</span>,
          <span class="hljs-attr">attrs</span>: {},
          <span class="hljs-attr">children</span>: [], <span class="hljs-comment">// children çš„ç©ºå€¼ä¸º []ã€‚</span>
          <span class="hljs-attr">text</span>: <span class="hljs-string">'1'</span>
        }
      ]
    },
    ......
  ]
}
</code></pre>
<h3 data-id="heading-17"><strong>è™šæ‹Ÿ DOM æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</strong></h3>
<p>â€‹		1ã€**æ€§èƒ½ä¼˜åŒ–ï¼š**å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒVue ä¼šå…ˆåœ¨å†…å­˜ä¸­æ„å»ºè™šæ‹Ÿ DOM æ ‘ï¼Œç„¶åé€šè¿‡æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOM æ ‘çš„å·®å¼‚ï¼Œæœ€ç»ˆåªæ›´æ–°å¿…è¦çš„éƒ¨åˆ†åˆ°çœŸå® DOM æ ‘ä¸­ã€‚è™šæ‹Ÿ DOM çš„ä½¿ç”¨å‡å°‘äº† Vue æ“ä½œçœŸå® DOM çš„æ¬¡æ•°ï¼Œä»è€Œæé«˜äº† Vue æ¸²æŸ“é¡µé¢çš„æ€§èƒ½ã€‚</p>
<p>â€‹		2ã€**è·¨å¹³å°èƒ½åŠ›ï¼š**è™šæ‹Ÿ DOM æ˜¯ä¸€ä¸ªä¸å¹³å°æ— å…³çš„æŠ½è±¡å±‚ï¼Œå®ƒçš„ä½¿ç”¨ä½¿å¾— Vue å¯ä»¥åœ¨æµè§ˆå™¨ã€ç§»åŠ¨ç«¯å’ŒæœåŠ¡ç«¯ï¼ˆä¾‹å¦‚æœåŠ¡ç«¯æ¸²æŸ“æ—¶ï¼‰ç­‰å¤šä¸ªç¯å¢ƒä¸­è¿è¡Œã€‚</p>
<h3 data-id="heading-18"><strong>ç”±æ¸²æŸ“å‡½æ•°ç”Ÿæˆè™šæ‹Ÿ DOM</strong></h3>
<p>â€‹		å®šä¹‰ä¸€ä¸ªç®€å•çš„ VNode ç±»ï¼Œå¹¶å®ç°æ¸²æŸ“å‡½æ•°ä¸­çš„ _cã€_vã€_s å‡½æ•°ã€‚ç„¶åè¿è¡Œ vm.$options.render.call(vm) å³å¯å¾—åˆ°è™šæ‹Ÿ DOMã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">tag, attrs, children, text</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tag</span> = tag
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">attrs</span> = attrs
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = children <span class="hljs-comment">// children çš„ç©ºå€¼ä¸º []ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elm</span> = <span class="hljs-literal">undefined</span>
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  ......

  <span class="hljs-title function_">_c</span>(<span class="hljs-params">tag, attrs, children</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(tag, attrs, children)
  }

  <span class="hljs-title function_">_v</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(undefind, undefind, undefind, text)
  }

  <span class="hljs-title function_">_s</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span> || value === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(value)
    }
  }

  ......
}
</code></pre>
<h3 data-id="heading-19"><strong>å®ç° Diff å’Œ Patch</strong></h3>
<p>â€‹		åœ¨ Vue2 ä¸­ï¼ŒDiff å’Œ Patch æ˜¯è™šæ‹Ÿ DOM ç®—æ³•çš„ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼š1ã€**Diffï¼ˆå·®å¼‚è®¡ç®—ï¼‰ï¼š**Diff æ˜¯æŒ‡å°†æ–°æ—§è™šæ‹Ÿ DOM æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè¿›è€Œæ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„å·®å¼‚ï¼›2ã€**Patchï¼ˆè¡¥ä¸åº”ç”¨ï¼‰ï¼š**Patch æ˜¯æŒ‡å°†è¿™äº›å·®å¼‚æ˜ å°„åˆ°çœŸå® DOM æ ‘ä¸Šï¼Œä½¿å¾—çœŸå® DOM æ ‘ä¸æ–°çš„è™šæ‹Ÿ DOM æ ‘ä¿æŒä¸€è‡´ã€‚</p>
<p>â€‹		é€šè¿‡ Diff å’Œ Patch çš„é…åˆï¼ŒVue å¯ä»¥å‡­å€Ÿè¾ƒå°‘æ¬¡æ•°çš„çœŸå® DOM æ“ä½œæ¥å®ç°é«˜æ•ˆåœ°é¡µé¢æ›´æ–°ã€‚</p>
<p>â€‹		æ³¨æ„ï¼ŒVue2 ä¸­çš„è™šæ‹Ÿ DOM ç®—æ³•æ˜¯åŸºäºå…¨é‡æ¯”è¾ƒçš„ï¼Œå³æ¯æ¬¡é¡µé¢æ›´æ–°éƒ½ä¼šå¯¹æ•´ä¸ªè™šæ‹Ÿ DOM æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè¿™åœ¨å¤§å‹åº”ç”¨ä¸­å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVue3 å¼•å…¥äº†åŸºäºé™æ€åˆ†æçš„ç¼–è¯‘ä¼˜åŒ–ï¼Œä½¿ç”¨äº†æ›´é«˜æ•ˆçš„å¢é‡æ›´æ–°ç®—æ³•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_watcher</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initComputed</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRenderFunction</span>()
    <span class="hljs-variable language_">this</span>.$mount(options.<span class="hljs-property">el</span>)
  }

  ......

  <span class="hljs-title function_">initRenderFunction</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> template
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>) {
      template = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>
    } <span class="hljs-keyword">else</span> {
      template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">el</span>).<span class="hljs-property">outerHtml</span>
    }
    <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(template)
    <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">generate</span>(ast).<span class="hljs-property">render</span>
    <span class="hljs-comment">// eslint-disable-next-line no-new-func</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(code)
  }

  ......

  $mount(el) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(el)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_watcher</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(
      <span class="hljs-variable language_">this</span>,
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_update</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>))
      },
      <span class="hljs-function">() =&gt;</span> {}
    )
  }

  ......

  <span class="hljs-title function_">_update</span>(<span class="hljs-params">vnode</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span>) {
      <span class="hljs-title function_">patch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span>, vnode)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">patch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span>, vnode)
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span> = vnode
  }

  ......
}
</code></pre>
<p>â€‹		Vue å¯¹è™šæ‹Ÿ DOM è¿›è¡Œ patch çš„é€»è¾‘åŸºäº <strong>snabbdom</strong> ç®—æ³•ã€‚patch å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šæ—§çš„è™šæ‹Ÿ DOM å’Œæ–°çš„è™šæ‹Ÿ DOMã€‚ï¼ˆä»¥ä¸‹ä»£ç ä¸è€ƒè™‘èŠ‚ç‚¹çš„å±æ€§å’ŒèŠ‚ç‚¹çš„ keyã€‚ï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">oldVnode, newVnode</span>) {
  <span class="hljs-keyword">const</span> el = oldVnode.<span class="hljs-property">elm</span>
  <span class="hljs-keyword">const</span> parent = el.<span class="hljs-property">parentNode</span>

  <span class="hljs-keyword">const</span> isRealElement = oldVnode.<span class="hljs-property">nodeType</span>
  <span class="hljs-keyword">if</span> (isRealElement) {
    parent.<span class="hljs-title function_">replaceChild</span>(<span class="hljs-title function_">createElement</span>(newVnode), oldVnode)
    <span class="hljs-keyword">return</span>
  }

  <span class="hljs-keyword">if</span> (!newVnode) {
    parent.<span class="hljs-title function_">removeChild</span>(el)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isChange</span>(newVnode, oldVnode)) {
    newVnode.<span class="hljs-property">elm</span> = <span class="hljs-title function_">createElement</span>(newVnode)
    parent.<span class="hljs-title function_">replaceChild</span>(newVnode.<span class="hljs-property">elm</span>, el)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isChange</span>(newVnode, oldVnode)) {
    <span class="hljs-comment">// æ¸²æŸ“æ€§èƒ½çš„æå‡å°±åœ¨è¿™é‡Œã€‚</span>
    newVnode.<span class="hljs-property">elm</span> = el
    <span class="hljs-keyword">const</span> newLength = newVnode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>
    <span class="hljs-keyword">const</span> oldLength = oldVnode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; newLength || i &lt; oldLength; i++) {
      <span class="hljs-keyword">if</span> (i &gt;= oldLength) {
        el.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">createElement</span>(newVnode.<span class="hljs-property">children</span>[i]))
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">patch</span>(oldVnode.<span class="hljs-property">children</span>[i], newVnode.<span class="hljs-property">children</span>[i])
      }
    }
  }
}

<span class="hljs-comment">// ç”±è™šæ‹Ÿ DOM åˆ›å»ºçœŸå® DOMã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-params">vnode</span>) {
  <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">if</span> (!vnode.<span class="hljs-property">tag</span>) {
    <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(vnode.<span class="hljs-property">text</span>)
    vnode.<span class="hljs-property">elm</span> = el
    <span class="hljs-keyword">return</span> el
  }

  <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(vnode.<span class="hljs-property">tag</span>)
  vnode.<span class="hljs-property">elm</span> = el
  <span class="hljs-comment">// åœ¨çˆ¶å­çœŸå® DOM ä¹‹é—´å»ºç«‹å…³ç³»ã€‚</span>
  vnode.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(createElement).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">subEl</span> =&gt;</span> {
    el.<span class="hljs-title function_">appendChild</span>(subEl)
  })
  <span class="hljs-keyword">return</span> el
}

<span class="hljs-comment">// åˆ¤æ–­æ–°çš„è™šæ‹Ÿ DOM ç›¸å¯¹äºæ—§çš„è™šæ‹Ÿ DOM æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isChange</span>(<span class="hljs-params">newVnode, oldVnode</span>) {
  <span class="hljs-keyword">return</span> newVnode.<span class="hljs-property">tag</span> !== oldVnode.<span class="hljs-property">tag</span> || newVnode.<span class="hljs-property">text</span> !== oldVnode.<span class="hljs-property">text</span>
}
</code></pre>
<h3 data-id="heading-20"><strong>è™šæ‹Ÿ DOM ä»£ç æ€»ç»“</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_watcher</span> = <span class="hljs-literal">undefined</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initComputed</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWatch</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRenderFunction</span>()
    <span class="hljs-variable language_">this</span>.$mount(options.<span class="hljs-property">el</span>)
  }

  <span class="hljs-title function_">initData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// TODOï¼šthis.$options.data è¿˜å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</span>
    <span class="hljs-keyword">const</span> data = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ•°æ®ä»£ç†é€»è¾‘ã€‚</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxyGetter</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">return</span> data[keys[i]]
        },
        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxySetter</span>(<span class="hljs-params">newValue</span>) {
          data[keys[i]] = newValue
        }
      })
    }

    <span class="hljs-title function_">observe</span>(data)
  }

  <span class="hljs-title function_">initComputed</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> computed = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">computed</span>
    <span class="hljs-keyword">if</span> (computed) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(computed)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> watcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, computed[keys[i]], <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}, { <span class="hljs-attr">lazy</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>, keys[i], {
          <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedGetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (watcher.<span class="hljs-property">dirty</span>) {
              watcher.<span class="hljs-title function_">get</span>()
              watcher.<span class="hljs-property">dirty</span> = <span class="hljs-literal">false</span>
            }
            watcher.<span class="hljs-property">deps</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">dep</span> =&gt;</span> {
              dep.<span class="hljs-title function_">depend</span>()
            })
            <span class="hljs-keyword">return</span> watcher.<span class="hljs-property">value</span>
          },
          <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">computedSetter</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'è¯·ä¸è¦ç»™è®¡ç®—å±æ€§èµ‹å€¼!'</span>)
          }
        })
      }
    }
  }

  <span class="hljs-title function_">initWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> watch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">watch</span>
    <span class="hljs-keyword">if</span> (watch) {
      <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(watch)
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">this</span>.$watch(keys[i], watch[keys[i]])
      }
    }
  }

  <span class="hljs-title function_">initRenderFunction</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> template
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>) {
      template = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">template</span>
    } <span class="hljs-keyword">else</span> {
      template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">el</span>).<span class="hljs-property">outerHtml</span>
    }
    <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(template)
    <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">generate</span>(ast).<span class="hljs-property">render</span>
    <span class="hljs-comment">// eslint-disable-next-line no-new-func</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(code)
  }

  $watch(exp, cb) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(<span class="hljs-variable language_">this</span>, exp, cb)
  }

  $set(target, key, value) {
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target)
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      <span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
      <span class="hljs-title function_">observe</span>(value)
      arrayProto.<span class="hljs-property">splice</span>.<span class="hljs-title function_">call</span>(target, key, <span class="hljs-number">1</span>, value)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-title function_">defineReactive</span>(target, key, value)
    }
    <span class="hljs-comment">// è§¦å‘ä¾èµ– target çš„ watchersã€‚</span>
    target.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
  }

  $mount(el) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(el)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_watcher</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(
      <span class="hljs-variable language_">this</span>,
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_update</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>))
      },
      <span class="hljs-function">() =&gt;</span> {}
    )
  }

  <span class="hljs-title function_">_update</span>(<span class="hljs-params">vnode</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span>) {
      <span class="hljs-title function_">patch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span>, vnode)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">patch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span>, vnode)
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_vnode</span> = vnode
  }

  <span class="hljs-title function_">_c</span>(<span class="hljs-params">tag, attrs, children</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(tag, attrs, children)
  }

  <span class="hljs-title function_">_v</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(undefind, undefind, undefind, text)
  }

  <span class="hljs-title function_">_s</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span> || value === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(value)
    }
  }
}

<span class="hljs-comment">// è§‚å¯Ÿ data æ•°æ®ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
  <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'[object Object]'</span> &amp;&amp; type !== <span class="hljs-string">'[object Array]'</span>) {
    <span class="hljs-keyword">return</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">'__ob__'</span>, {
      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
    })
    <span class="hljs-keyword">const</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(data)
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Array]'</span>) {
      data.<span class="hljs-property">__proto__</span> = arrayMethods
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(data)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'[object Object]'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(data)
    }
  }

  <span class="hljs-title function_">walk</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">defineReactive</span>(data, keys[i], data[keys[i]])
    }
  }

  <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">array</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-title function_">observe</span>(array[i])
    }
  }
}

<span class="hljs-comment">// å®šä¹‰ obj å¯¹è±¡çš„ key å±æ€§çš„å“åº”å¼ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…ï¼Œä½¿å¾— value å˜é‡ å’Œ dep å¸¸é‡ä¸€ç›´æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, value</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()

  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ã€‚</span>
  <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(value)

  <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
    objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
  }

  <span class="hljs-comment">// æ•°æ®åŠ«æŒé€»è¾‘ã€‚</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è®¢é˜…é€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">depend</span>()
      <span class="hljs-keyword">if</span> (objKeyOb) {
        objKeyOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()
      }
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newValue</span>) {
      <span class="hljs-keyword">if</span> (value === newValue) {
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-comment">// å‘å¸ƒé€»è¾‘ã€‚</span>
      dep.<span class="hljs-title function_">notify</span>()
      <span class="hljs-keyword">const</span> objKeyOb = <span class="hljs-title function_">observe</span>(newValue)
      <span class="hljs-keyword">if</span> (objKeyOb &amp;&amp; obj[key] &amp;&amp; obj[key].<span class="hljs-property">__ob__</span>) {
        objKeyOb.<span class="hljs-property">dep</span> = obj[key].<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>
      }
      value = newValue
    }
  })
}

<span class="hljs-comment">// â€œç­â€è¢«æŠ½è±¡æˆäº† Dep å®ä¾‹ã€‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-comment">// å“åº”å¼å±æ€§å½“å‰è¦è®¢é˜…çš„ watcherã€‚</span>
  <span class="hljs-keyword">static</span> target = <span class="hljs-literal">null</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å“åº”å¼å±æ€§å·²è®¢é˜…çš„ watcher åˆ—è¡¨ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }

  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)
    }
  }

  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">watcher</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(watcher) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(watcher)
  }

  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">watcher</span> =&gt;</span> {
      watcher.<span class="hljs-title function_">update</span>()
    })
  }
}

<span class="hljs-comment">// å›è°ƒå‡½æ•°è¢«åŒ…è£…æˆäº† Watcher å®ä¾‹ã€‚</span>
<span class="hljs-comment">// TODOï¼šæš‚æ—¶åªå®ç°äº†å¯¹ vm.$options.data å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§çš„ç›‘å¬ã€‚</span>
<span class="hljs-keyword">const</span> watcherQueue = []
<span class="hljs-keyword">let</span> watcherId = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> targetStack = []
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, exp, cb, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++watcherId
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> = exp
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = !!options.<span class="hljs-property">lazy</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
    }
  }

  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>
    targetStack.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">exp</span>]
    }
    targetStack.<span class="hljs-title function_">pop</span>()
    <span class="hljs-keyword">if</span> (targetStack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = targetStack[targetStack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>
    }
  }

  <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">indexOf</span>(dep) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">push</span>(dep)
    dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)
  }

  <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()
    }
  }

  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (watcherQueue.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>) !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// ç±»ä¼¼äº JavaScript ä¸­çš„é˜²æŠ–é€»è¾‘ã€‚</span>
      <span class="hljs-keyword">return</span>
    }
    watcherQueue.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    <span class="hljs-keyword">const</span> index = watcherQueue.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æ›´æ–° this.value(watcher.value) çš„å€¼ã€‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)
      watcherQueue.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    })
  }
}

<span class="hljs-keyword">const</span> mutationMethods = [<span class="hljs-string">'push'</span>, <span class="hljs-string">'pop'</span>, <span class="hljs-string">'shift'</span>, <span class="hljs-string">'unshift'</span>, <span class="hljs-string">'splice'</span>, <span class="hljs-string">'sort'</span>, <span class="hljs-string">'reverse'</span>]
<span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
<span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)
mutationMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  arrayMethods[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (method === <span class="hljs-string">'push'</span> || method === <span class="hljs-string">'unshift'</span> || method === <span class="hljs-string">'splice'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-title function_">observeArray</span>(args)
    }
    <span class="hljs-keyword">const</span> result = arrayProto[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()
    <span class="hljs-keyword">return</span> result
  }
})

<span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">template</span>) {
  <span class="hljs-keyword">let</span> root = <span class="hljs-literal">null</span>
  <span class="hljs-keyword">let</span> currentParent
  <span class="hljs-keyword">const</span> stack = []

  <span class="hljs-comment">// è·³è¿‡ç©ºç™½å­—ç¬¦ä¸²ã€‚</span>
  template = template.<span class="hljs-title function_">trim</span>()

  <span class="hljs-keyword">while</span> (template) {
    <span class="hljs-keyword">const</span> ltIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&lt;'</span>)
    <span class="hljs-comment">// ltIndex === -1 çš„æƒ…å†µä¸ä¼šå‡ºç°ã€‚</span>
    <span class="hljs-comment">// ltIndex &gt; 0 æ ‡ç­¾å‰é¢æœ‰æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
    <span class="hljs-comment">// ltIndex === 0 &amp;&amp; template[ltIndex + 1] !== '/' å¼€å§‹æ ‡ç­¾ã€‚</span>
    <span class="hljs-comment">// ltIndex === 0 &amp;&amp; template[ltIndex + 1] === '/' ç»“æŸæ ‡ç­¾ã€‚</span>
    <span class="hljs-keyword">if</span> (ltIndex &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-comment">// typeï¼š1-å…ƒç´ èŠ‚ç‚¹ï¼›2-å¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ï¼›3-çº¯æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
      <span class="hljs-keyword">const</span> text = template.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, ltIndex)
      <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">parseText</span>(text)
      element.<span class="hljs-property">parent</span> = currentParent
      <span class="hljs-keyword">if</span> (!currentParent.<span class="hljs-property">children</span>) {
        currentParent.<span class="hljs-property">children</span> = []
      }
      currentParent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(element)
      template = template.<span class="hljs-title function_">slice</span>(ltIndex)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ltIndex === <span class="hljs-number">0</span> &amp;&amp; template[ltIndex + <span class="hljs-number">1</span>] !== <span class="hljs-string">'/'</span>) {
      <span class="hljs-keyword">const</span> gtIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&gt;'</span>)
      <span class="hljs-keyword">const</span> element = {
        <span class="hljs-attr">parent</span>: currentParent, <span class="hljs-comment">// æ ¹èŠ‚ç‚¹çš„ parent å±æ€§å€¼ä¸º undefinedã€‚</span>
        <span class="hljs-attr">tag</span>: template.<span class="hljs-title function_">slice</span>(ltIndex + <span class="hljs-number">1</span>, gtIndex), <span class="hljs-comment">// åªè€ƒè™‘å¼€å§‹æ ‡ç­¾ä¸­æ²¡æœ‰ä»»ä½•å±æ€§çš„æƒ…å†µã€‚</span>
        <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>
      }
      <span class="hljs-keyword">if</span> (currentParent) {
        <span class="hljs-keyword">if</span> (!currentParent.<span class="hljs-property">children</span>) {
          currentParent.<span class="hljs-property">children</span> = []
        }
        currentParent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(element)
      } <span class="hljs-keyword">else</span> {
        root = element
      }
      currentParent = element
      stack.<span class="hljs-title function_">push</span>(element)
      template = template.<span class="hljs-title function_">slice</span>(gtIndex + <span class="hljs-number">1</span>)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ltIndex === <span class="hljs-number">0</span> &amp;&amp; template[ltIndex + <span class="hljs-number">1</span>] === <span class="hljs-string">'/'</span>) {
      <span class="hljs-keyword">const</span> gtIndex = template.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'&gt;'</span>)
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å stack å€¼è¢«è®¾ç½®ä¸º []ã€‚</span>
      stack.<span class="hljs-title function_">pop</span>()
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å currentParent å€¼è¢«è®¾ç½®ä¸º undefinedã€‚</span>
      currentParent = stack[stack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
      <span class="hljs-comment">// parse å‡½æ•°æ‰§è¡Œå®Œæ¯•å template å€¼è¢«è®¾ç½®ä¸º ''ã€‚</span>
      template = template.<span class="hljs-title function_">slice</span>(gtIndex + <span class="hljs-number">1</span>)
    }
  }

  <span class="hljs-keyword">return</span> root
}

<span class="hljs-comment">// ä»¥ {{ å’Œ }} ä¸ºæ ‡è¯†ç¬¦ï¼ŒæŠŠ text ä¸­çš„ 'å§“åï¼š{{name}}' è½¬æ¢æˆ '"å§“åï¼š" + _s(name)'ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseText</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-keyword">const</span> originText = text
  <span class="hljs-keyword">const</span> tokens = []
  <span class="hljs-comment">// typeï¼š2-å¸¦å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹ï¼›3-çº¯æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">let</span> type = <span class="hljs-number">3</span>

  <span class="hljs-keyword">while</span> (text) {
    <span class="hljs-keyword">const</span> start = text.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'{{'</span>)
    <span class="hljs-keyword">const</span> end = text.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'}}'</span>)
    <span class="hljs-keyword">if</span> (start !== -<span class="hljs-number">1</span>) {
      type = <span class="hljs-number">2</span>
      <span class="hljs-keyword">if</span> (start &gt; <span class="hljs-number">0</span>) {
        tokens.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(text.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, start)))
      }
      <span class="hljs-keyword">const</span> exp = text.<span class="hljs-title function_">slice</span>(start + <span class="hljs-number">2</span>, end)
      tokens.<span class="hljs-title function_">push</span>(<span class="hljs-string">`_s(<span class="hljs-subst">${exp}</span>)`</span>)
      text = text.<span class="hljs-title function_">slice</span>(end + <span class="hljs-number">2</span>)
    } <span class="hljs-keyword">else</span> {
      tokens.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(text))
      text = <span class="hljs-string">''</span>
    }
  }

  <span class="hljs-keyword">const</span> element = {
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    type,
    <span class="hljs-attr">expression</span>: type === <span class="hljs-number">2</span> ? tokens.<span class="hljs-title function_">join</span>(<span class="hljs-string">' + '</span>) : <span class="hljs-string">''</span>,
    <span class="hljs-attr">text</span>: originText
  }

  <span class="hljs-keyword">return</span> element
}

<span class="hljs-comment">// å°† AST è½¬æ¢ä¸º render å‡½æ•°çš„å‡½æ•°ä½“çš„å­—ç¬¦ä¸²ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">ast</span>) {
  <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">genNode</span>(ast)
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">render</span>: <span class="hljs-string">`with (this) { return <span class="hljs-subst">${code}</span> }`</span>
  }
}

<span class="hljs-comment">// è½¬æ¢èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genNode</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genElement</span>(node)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genText</span>(node)
  }
}

<span class="hljs-comment">// è½¬æ¢å…ƒç´ èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genElement</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">const</span> children = <span class="hljs-title function_">genChildren</span>(node)
  <span class="hljs-comment">// children çš„ç©ºå€¼æ˜¯ '[]'ï¼Œä¸æ˜¯ 'undefined'ã€‚</span>
  <span class="hljs-keyword">const</span> code = <span class="hljs-string">`_c(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(node.tag)}</span>, {}, <span class="hljs-subst">${children}</span>)`</span>
  <span class="hljs-keyword">return</span> code
}

<span class="hljs-comment">// è½¬æ¢æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genText</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`_v(<span class="hljs-subst">${node.expression}</span>)`</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">3</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`_v(<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(node.text)}</span>)`</span>
  }
}

<span class="hljs-comment">// è½¬æ¢å…ƒç´ èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ—è¡¨ä¸­çš„å­èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genChildren</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-comment">// node.children çš„ç©ºå€¼ä¸º undefinedã€‚</span>
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'['</span> + node.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">genNode</span>(child)).<span class="hljs-title function_">join</span>(<span class="hljs-string">', '</span>) + <span class="hljs-string">']'</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'[]'</span>
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">VNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">tag, attrs, children, text</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tag</span> = tag
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">attrs</span> = attrs
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = children <span class="hljs-comment">// children çš„ç©ºå€¼ä¸º []ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elm</span> = <span class="hljs-literal">undefined</span>
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">oldVnode, newVnode</span>) {
  <span class="hljs-keyword">const</span> el = oldVnode.<span class="hljs-property">elm</span>
  <span class="hljs-keyword">const</span> parent = el.<span class="hljs-property">parentNode</span>

  <span class="hljs-keyword">const</span> isRealElement = oldVnode.<span class="hljs-property">nodeType</span>
  <span class="hljs-keyword">if</span> (isRealElement) {
    parent.<span class="hljs-title function_">replaceChild</span>(<span class="hljs-title function_">createElement</span>(newVnode), oldVnode)
    <span class="hljs-keyword">return</span>
  }

  <span class="hljs-keyword">if</span> (!newVnode) {
    parent.<span class="hljs-title function_">removeChild</span>(el)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isChange</span>(newVnode, oldVnode)) {
    newVnode.<span class="hljs-property">elm</span> = <span class="hljs-title function_">createElement</span>(newVnode)
    parent.<span class="hljs-title function_">replaceChild</span>(newVnode.<span class="hljs-property">elm</span>, el)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isChange</span>(newVnode, oldVnode)) {
    <span class="hljs-comment">// æ¸²æŸ“æ€§èƒ½çš„æå‡å°±åœ¨è¿™é‡Œã€‚</span>
    newVnode.<span class="hljs-property">elm</span> = el
    <span class="hljs-keyword">const</span> newLength = newVnode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>
    <span class="hljs-keyword">const</span> oldLength = oldVnode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; newLength || i &lt; oldLength; i++) {
      <span class="hljs-keyword">if</span> (i &gt;= oldLength) {
        el.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">createElement</span>(newVnode.<span class="hljs-property">children</span>[i]))
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">patch</span>(oldVnode.<span class="hljs-property">children</span>[i], newVnode.<span class="hljs-property">children</span>[i])
      }
    }
  }
}

<span class="hljs-comment">// ç”±è™šæ‹Ÿ DOM åˆ›å»ºçœŸå® DOMã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-params">vnode</span>) {
  <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">if</span> (!vnode.<span class="hljs-property">tag</span>) {
    <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(vnode.<span class="hljs-property">text</span>)
    vnode.<span class="hljs-property">elm</span> = el
    <span class="hljs-keyword">return</span> el
  }

  <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(vnode.<span class="hljs-property">tag</span>)
  vnode.<span class="hljs-property">elm</span> = el
  <span class="hljs-comment">// åœ¨çˆ¶å­çœŸå® DOM ä¹‹é—´å»ºç«‹å…³ç³»ã€‚</span>
  vnode.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(createElement).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">subEl</span> =&gt;</span> {
    el.<span class="hljs-title function_">appendChild</span>(subEl)
  })
  <span class="hljs-keyword">return</span> el
}

<span class="hljs-comment">// åˆ¤æ–­æ–°çš„è™šæ‹Ÿ DOM ç›¸å¯¹äºæ—§çš„è™šæ‹Ÿ DOM æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isChange</span>(<span class="hljs-params">newVnode, oldVnode</span>) {
  <span class="hljs-keyword">return</span> newVnode.<span class="hljs-property">tag</span> !== oldVnode.<span class="hljs-property">tag</span> || newVnode.<span class="hljs-property">text</span> !== oldVnode.<span class="hljs-property">text</span>
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ macOS ä¸Šåš OCRï¼šä»æˆªå±åˆ°å¯ç‚¹è¯çš„å®è·µç¬”è®°]]></title>    <link>https://juejin.cn/post/7598435950411104266</link>    <guid>https://juejin.cn/post/7598435950411104266</guid>    <pubDate>2026-01-24T07:38:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598435950411104266" data-draft-id="7598477092196859942" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ macOS ä¸Šåš OCRï¼šä»æˆªå±åˆ°å¯ç‚¹è¯çš„å®è·µç¬”è®°"/> <meta itemprop="keywords" content="å‰ç«¯,Swift,macOS"/> <meta itemprop="datePublished" content="2026-01-24T07:38:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶è½é˜ä¸»"/> <meta itemprop="url" content="https://juejin.cn/user/2189882891714206"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ macOS ä¸Šåš OCRï¼šä»æˆªå±åˆ°å¯ç‚¹è¯çš„å®è·µç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2189882891714206/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶è½é˜ä¸»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:38:57.000Z" title="Sat Jan 24 2026 07:38:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d8cd3b852604356a96eadaa418e61b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-26JC96ZiB5Li7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769847467&amp;x-signature=uQbt8ybj06GKRFQ%2FadI%2FOtsfDfw%3D" alt="Screenshot 2026-01-24 at 15.37.26.png" loading="lazy"/></p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘åœ¨å†™ä¸€ä¸ª macOS å¹³å°çš„å¿«é€Ÿç¿»è¯‘è½¯ä»¶ SnapTra Translatorï¼Œæ ¸å¿ƒä½“éªŒæ˜¯â€œæŒ‰ä½å¿«æ·é”®ï¼ŒæŠŠé¼ æ ‡æ‚¬åœåœ¨æ–‡å­—ä¸Šå°±èƒ½çœ‹åˆ°ç¿»è¯‘æ°”æ³¡â€ã€‚è¿™èƒŒåç¦»ä¸å¼€ OCRï¼šå…ˆæŠŠå±å¹•ä¸Šä¸€å°å—åŒºåŸŸæˆªä¸‹æ¥ï¼Œå†ç”¨ Vision æŠŠæ–‡å­—è¯†åˆ«å‡ºæ¥ï¼Œæœ€åæ ¹æ®å…‰æ ‡ä½ç½®é€‰ä¸­æœ€æ¥è¿‘çš„å•è¯ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æŠŠæˆ‘åœ¨é¡¹ç›®é‡Œçš„å®è·µæ•´ç†æˆä¸€ä»½â€œå¯è½åœ°â€çš„ macOS OCR æŒ‡å—ï¼šæ—¢è®²æ€è·¯ï¼Œä¹Ÿç»™å…³é”®ä»£ç å’Œé¿å‘ç‚¹ã€‚</p>
<h3 data-id="heading-1">ä½ èƒ½å¾—åˆ°ä»€ä¹ˆ</h3>
<ul>
<li>ä¸€ä¸ª macOS OCR çš„å®Œæ•´é“¾è·¯ï¼šæˆªå± â†’ è¯†åˆ« â†’ é€‰è¯ â†’ è°ƒè¯•</li>
<li>å¯ç›´æ¥å¤ç”¨çš„å…³é”®ä»£ç æ®µï¼ˆVision + ScreenCaptureKitï¼‰</li>
<li>çœŸå®é¡¹ç›®é‡Œçš„è®¾è®¡å–èˆä¸å‘ä½</li>
</ul>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹© Vision + ScreenCaptureKit</h3>
<p>åœ¨ macOS ä¸Šåš OCRï¼Œæœ¬è´¨æ˜¯ï¼š</p>
<ol>
<li>æ‹¿åˆ°å±å¹•å›¾åƒï¼ˆéœ€è¦å±å¹•å½•åˆ¶æƒé™ï¼‰</li>
<li>æŠŠå›¾åƒå–‚ç»™ Vision çš„æ–‡æœ¬è¯†åˆ«</li>
<li>æ ¹æ®è¯†åˆ«ç»“æœçš„ bounding box åšäº¤äº’ï¼ˆæ¯”å¦‚â€œå…‰æ ‡é™„è¿‘å–è¯â€ï¼‰</li>
</ol>
<p>Vision æ˜¯ç³»ç»Ÿçº§ OCRï¼Œç¨³å®šã€è½»é‡ã€æ— éœ€é¢å¤–æ¨¡å‹ï¼›ScreenCaptureKit æ˜¯æ›´ç°ä»£çš„æˆªå±æ–¹å¼ï¼Œèƒ½æ›´å¥½æ§åˆ¶é‡‡æ ·åŒºåŸŸä¸æ€§èƒ½ã€‚</p>
<h3 data-id="heading-3">SnapTra çš„ OCR é“¾è·¯æ¦‚è§ˆ</h3>
<p>æˆ‘åœ¨ SnapTra Translator é‡Œé‡‡ç”¨äº†â€œå…‰æ ‡å‘¨å›´å°èŒƒå›´æˆªå±â€çš„ç­–ç•¥ï¼š</p>
<ul>
<li>æ¯æ¬¡ç¿»è¯‘åªæˆªå–é¼ æ ‡é™„è¿‘ä¸€å—å›ºå®šå¤§å°åŒºåŸŸï¼ˆé»˜è®¤ 520x140ï¼‰</li>
<li>OCR ç»“æœè¿”å›æ¯è¡Œæ–‡æœ¬ï¼Œå†è¿›ä¸€æ­¥åˆ‡æˆæ›´ç»†çš„å•è¯ token</li>
<li>å°† token çš„ bounding box ä¸é¼ æ ‡ä½ç½®æ¯”å¯¹ï¼Œé€‰ä¸­æœ€æ¥è¿‘çš„è¯</li>
</ul>
<p>è¿™å¥—é“¾è·¯è®©å®ƒèƒ½åšåˆ°â€œç‚¹å“ªç¿»å“ªâ€ï¼Œè€Œä¸æ˜¯æ•´å± OCRã€‚</p>
<h3 data-id="heading-4">å…³é”®å®ç°ï¼šæˆªå±</h3>
<p>ä¸‹é¢æ˜¯é¡¹ç›®é‡Œæˆªå–å…‰æ ‡å‘¨å›´ç”»é¢çš„æ ¸å¿ƒé€»è¾‘ï¼Œä½¿ç”¨ <code>ScreenCaptureKit</code> è·å–ä¸€å¼  <code>CGImage</code>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ScreenCaptureService</span> {
    <span class="hljs-keyword">let</span> captureSize <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: <span class="hljs-number">520</span>, height: <span class="hljs-number">140</span>)

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">captureAroundCursor</span>() <span class="hljs-keyword">async</span> -&gt; (image: <span class="hljs-type">CGImage</span>, region: <span class="hljs-type">CaptureRegion</span>)<span class="hljs-operator">?</span> {
        <span class="hljs-keyword">let</span> mouseLocation <span class="hljs-operator">=</span> <span class="hljs-type">NSEvent</span>.mouseLocation
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> screen <span class="hljs-operator">=</span> <span class="hljs-type">NSScreen</span>.screens.first(where: { <span class="hljs-type">NSMouseInRect</span>(mouseLocation, <span class="hljs-variable">$0</span>.frame, <span class="hljs-literal">false</span>) }) <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
        }
        <span class="hljs-keyword">let</span> rectInScreen <span class="hljs-operator">=</span> captureRect(for: mouseLocation, in: screen.frame, size: captureSize)
        <span class="hljs-keyword">let</span> cgRect <span class="hljs-operator">=</span> convertToDisplayLocalCoordinates(rectInScreen, screen: screen)

        <span class="hljs-keyword">let</span> display <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> getDisplay(for: displayID)
        <span class="hljs-keyword">let</span> filter <span class="hljs-operator">=</span> <span class="hljs-type">SCContentFilter</span>(display: display, excludingWindows: [])
        <span class="hljs-keyword">let</span> configuration <span class="hljs-operator">=</span> makeConfiguration(for: cgRect, scaleFactor: screen.backingScaleFactor)
        <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">SCScreenshotManager</span>.captureImage(contentFilter: filter, configuration: configuration)
        <span class="hljs-keyword">return</span> (image, <span class="hljs-type">CaptureRegion</span>(rect: rectInScreen, screen: screen, displayID: displayID, scaleFactor: scaleFactor))
    }
}
</code></pre>
<p>è¿™æ®µä»£ç çš„é‡ç‚¹æ˜¯ï¼šåªæŠ“ä¸€ä¸ªå°çŸ©å½¢åŒºåŸŸï¼Œä¸åšæ•´å±æˆªå›¾ï¼Œæ€§èƒ½ä¼šå¥½å¾ˆå¤šã€‚</p>
<h3 data-id="heading-5">å…³é”®å®ç°ï¼šOCR è¯†åˆ«</h3>
<p>Vision çš„è¯†åˆ«éƒ¨åˆ†éå¸¸ç›´æ¥ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OCRService</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">recognizeWords</span>(<span class="hljs-params">in</span> <span class="hljs-params">image</span>: <span class="hljs-type">CGImage</span>, <span class="hljs-params">language</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; [<span class="hljs-type">RecognizedWord</span>] {
        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.detached(priority: .userInitiated) {
            <span class="hljs-keyword">let</span> request <span class="hljs-operator">=</span> <span class="hljs-type">VNRecognizeTextRequest</span>()
            request.recognitionLevel <span class="hljs-operator">=</span> .accurate
            request.usesLanguageCorrection <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">macOS</span> <span class="hljs-number">13.0</span>, <span class="hljs-operator">*</span>) {
                request.revision <span class="hljs-operator">=</span> <span class="hljs-type">VNRecognizeTextRequestRevision3</span>
                request.automaticallyDetectsLanguage <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
            } <span class="hljs-keyword">else</span> {
                request.recognitionLanguages <span class="hljs-operator">=</span> [language]
            }

            <span class="hljs-keyword">let</span> handler <span class="hljs-operator">=</span> <span class="hljs-type">VNImageRequestHandler</span>(cgImage: image)
            <span class="hljs-keyword">try</span> handler.perform([request])
            <span class="hljs-keyword">return</span> <span class="hljs-type">OCRService</span>.extractWords(from: request.results <span class="hljs-operator">??</span> [])
        }.value
    }
}
</code></pre>
<p>å‡ ä¸ªå°ç‚¹ï¼š</p>
<ul>
<li><code>recognitionLevel = .accurate</code> é€‚åˆéœ€è¦é«˜ç²¾åº¦çš„ç¿»è¯‘åœºæ™¯</li>
<li>å¼€å¯ <code>usesLanguageCorrection</code> èƒ½æå‡è‹±æ–‡è¯†åˆ«çš„å¯è¯»æ€§</li>
<li>åœ¨ macOS 13+ ç”¨ <code>automaticallyDetectsLanguage</code>ï¼Œå¯ä»¥æ›´è‡ªç„¶åœ°è¯†åˆ«æ··åˆæ–‡æœ¬</li>
</ul>
<h3 data-id="heading-6">å…³é”®å®ç°ï¼šä»è¡Œåˆ°â€œè¯â€</h3>
<p>Vision è¿”å›çš„é€šå¸¸æ˜¯â€œæ–‡æœ¬è¡Œâ€ï¼Œä½†ç¿»è¯‘åœºæ™¯éœ€è¦æ›´ç»†ç²’åº¦ã€‚</p>
<p>SnapTra é‡Œæˆ‘åšäº†ä¸¤æ­¥ï¼š</p>
<ol>
<li>å…ˆæŒ‰è‹±æ–‡å­—ç¬¦æ‹†åˆ† token</li>
<li>å¯¹ CamelCase åšè¿›ä¸€æ­¥åˆ‡åˆ†ï¼ˆæ¯”å¦‚ <code>ApplePay</code> â†’ <code>Apple</code> + <code>Pay</code>ï¼‰</li>
</ol>
<p>åŒæ—¶ï¼Œæˆ‘æ²¡æœ‰ç›´æ¥ä½¿ç”¨ Vision çš„ <code>boundingBox(for:)</code>ï¼Œå› ä¸ºå®ƒå¯¹è‡ªå®šä¹‰åˆ†è¯å¹¶ä¸ç¨³å®šï¼Œè€Œæ˜¯ç”¨â€œå­—ç¬¦æ¯”ä¾‹â€è®¡ç®— boxï¼Œä¿è¯ç¨³å®šæ€§ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å§‹ç»ˆä½¿ç”¨å­—ç¬¦æ¯”ä¾‹è®¡ç®—è¾¹ç•Œæ¡†ï¼Œç¡®ä¿ç¨³å®šæ€§</span>
<span class="hljs-comment">// Vision çš„ boundingBox(for:) å¯¹è‡ªå®šä¹‰åˆ†è¯ï¼ˆCamelCaseï¼‰æ”¯æŒä¸ç¨³å®š</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">boundingBoxByCharacterRatio</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">textBox</span>: <span class="hljs-type">CGRect</span>, <span class="hljs-params">text</span>: <span class="hljs-type">String</span>, <span class="hljs-params">for</span> <span class="hljs-params">range</span>: <span class="hljs-type">Range</span>&lt;<span class="hljs-type">String</span>.<span class="hljs-type">Index</span>&gt;) -&gt; <span class="hljs-type">CGRect</span>? {
    <span class="hljs-keyword">let</span> totalCount <span class="hljs-operator">=</span> text.count
    <span class="hljs-keyword">let</span> startOffset <span class="hljs-operator">=</span> text.distance(from: text.startIndex, to: range.lowerBound)
    <span class="hljs-keyword">let</span> endOffset <span class="hljs-operator">=</span> text.distance(from: text.startIndex, to: range.upperBound)
    <span class="hljs-keyword">let</span> startFraction <span class="hljs-operator">=</span> <span class="hljs-type">CGFloat</span>(startOffset) <span class="hljs-operator">/</span> <span class="hljs-type">CGFloat</span>(totalCount)
    <span class="hljs-keyword">let</span> endFraction <span class="hljs-operator">=</span> <span class="hljs-type">CGFloat</span>(endOffset) <span class="hljs-operator">/</span> <span class="hljs-type">CGFloat</span>(totalCount)
    <span class="hljs-keyword">let</span> x <span class="hljs-operator">=</span> textBox.minX <span class="hljs-operator">+</span> textBox.width <span class="hljs-operator">*</span> startFraction
    <span class="hljs-keyword">let</span> width <span class="hljs-operator">=</span> textBox.width <span class="hljs-operator">*</span> (endFraction <span class="hljs-operator">-</span> startFraction)
    <span class="hljs-keyword">return</span> <span class="hljs-type">CGRect</span>(x: x, y: textBox.minY, width: width, height: textBox.height)
}
</code></pre>
<h3 data-id="heading-7">å¦‚ä½•â€œç‚¹è¯â€ï¼šç”¨é¼ æ ‡ä½ç½®é€‰ä¸­æœ€ç›¸å…³çš„è¯</h3>
<p>OCR çš„è¾“å‡ºæ˜¯å¤šä¸ªå•è¯åŠ  bounding boxã€‚ä¸ºäº†å®ç°â€œé¼ æ ‡æŒ‡å“ªç¿»å“ªâ€ï¼Œæˆ‘åšäº†ä¸¤ä»¶äº‹ï¼š</p>
<ul>
<li>åªä¿ç•™ bounding box åŒ…å«é¼ æ ‡ä½ç½®çš„è¯</li>
<li>å¦‚æœæœ‰å¤šä¸ªå€™é€‰ï¼Œå–ä¸­å¿ƒç‚¹ç¦»é¼ æ ‡æœ€è¿‘çš„</li>
</ul>
<p>è¿™æ ·å¯ä»¥åœ¨å¯†é›†æ–‡æœ¬é‡Œä¹Ÿä¿æŒç¨³å®šä½“éªŒã€‚</p>
<h3 data-id="heading-8">æƒé™ä¸ç³»ç»Ÿè®¾ç½®ï¼šå±å¹•å½•åˆ¶æ˜¯å‰ç½®æ¡ä»¶</h3>
<p>åªè¦æ¶‰åŠå±å¹•æˆªå›¾ï¼Œå°±éœ€è¦ Screen Recording æƒé™ã€‚é¡¹ç›®é‡Œé€šè¿‡ <code>CGPreflightScreenCaptureAccess()</code> åˆ¤æ–­å½“å‰æƒé™ï¼Œå¹¶æä¾›å¿«æ·è·³è½¬ç³»ç»Ÿè®¾ç½®ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">requestAndOpenScreenRecording</span>() {
    <span class="hljs-type">CGRequestScreenCaptureAccess</span>()
    openPrivacyPane(anchor: <span class="hljs-string">"Privacy_ScreenCapture"</span>)
}
</code></pre>
<p>ä½“éªŒä¸Šï¼Œæˆ‘ä¼šåœ¨æƒé™çŠ¶æ€å˜åŒ–åè‡ªåŠ¨åˆ·æ–°ï¼Œå¹¶åœ¨æœªæˆæƒæ—¶æç¤ºç”¨æˆ·ã€‚</p>
<h3 data-id="heading-9">è°ƒè¯•æ‰‹æ®µï¼šæŠŠ OCR åŒºåŸŸç”»å‡ºæ¥</h3>
<p>â€œçœ‹ä¸åˆ°â€æ˜¯ OCR è°ƒè¯•æœ€å¤§çš„é˜»åŠ›ã€‚SnapTra é‡Œåšäº†ä¸€ä¸ª Debug OCR Region å¼€å…³ï¼š</p>
<ul>
<li>çº¢æ¡†æ˜¾ç¤ºå½“å‰æˆªå±åŒºåŸŸ</li>
<li>ç»¿æ¡†æ˜¾ç¤ºæ¯ä¸ªè¯†åˆ«å‡ºæ¥çš„å•è¯è¾¹ç•Œ</li>
</ul>
<p>è¿™å¯ä»¥ç›´è§‚è§‚å¯Ÿâ€œæˆªå±åŒºåŸŸæ˜¯å¦å¯¹é½â€ã€â€œè¯†åˆ«ç»“æœæ˜¯å¦åç§»â€ï¼Œéå¸¸æ¨èåœ¨æ—©æœŸå°±åŠ ä¸Šã€‚</p>
<h3 data-id="heading-10">å¸¸è§å‘ä½ä¸å»ºè®®</h3>
<ol>
<li>ä¸è¦æ•´å± OCRï¼šæ€§èƒ½ä¼šå¾ˆå·®ï¼Œä½“éªŒä¼šå¡</li>
<li>è¯†åˆ«ç»“æœçš„åæ ‡ç³»æ˜¯å½’ä¸€åŒ–åæ ‡ï¼Œè½¬åˆ°å±å¹•åæ ‡è¦æ³¨æ„ y è½´ç¿»è½¬</li>
<li>è¯­è¨€è®¾ç½®ä¸è¦æ­»æ¿ï¼šæ··åˆè¯­è¨€åœºæ™¯å¾ˆå¸¸è§</li>
<li>åˆ†è¯ç­–ç•¥æ¯”ä½ æƒ³è±¡çš„é‡è¦ï¼šç¿»è¯‘å·¥å…·å¯¹è¯ç²’åº¦å¾ˆæ•æ„Ÿ</li>
</ol>
<h3 data-id="heading-11">è½åœ°å°ç»“</h3>
<p>å¦‚æœä½ è¦åšä¸€ä¸ªâ€œå±å¹•å–è¯ + ç¿»è¯‘â€çš„ macOS å·¥å…·ï¼Œæ¨èçš„æœ€å°é“¾è·¯æ˜¯ï¼š</p>
<ol>
<li>ç”¨ ScreenCaptureKit æˆªå–é¼ æ ‡é™„è¿‘å°åŒºåŸŸ</li>
<li>ç”¨ Vision è¯†åˆ«æ–‡æœ¬</li>
<li>è‡ªå·±åšåˆ†è¯ä¸ box ç»†åŒ–</li>
<li>ç”¨é¼ æ ‡ä½ç½®é€‰è¯</li>
<li>åŠ ä¸€ä¸ª Debug OCR Region è§†å›¾ï¼Œè°ƒè¯•æ•ˆç‡ç›´æ¥ç¿»å€</li>
</ol>
<h3 data-id="heading-12">æœ€å</h3>
<p>æˆ‘åœ¨ SnapTra Translator é‡Œè¸©è¿‡çš„å‘ã€åšè¿‡çš„å–èˆï¼Œéƒ½å°½é‡å†™åœ¨ä¸Šé¢äº†ã€‚OCR çœ‹ä¼¼ç®€å•ï¼Œä½†çœŸæ­£è½åœ°åˆ°â€œæ‰‹æ„Ÿå¾ˆå¥½â€çš„äº§å“ï¼Œç»†èŠ‚çœŸçš„å¾ˆå¤šã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨åš macOS OCR æˆ–ç¿»è¯‘å·¥å…·ï¼Œæ¬¢è¿äº¤æµæƒ³æ³•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nuxté…ç½®ä»£ç† å’Œ è¯·æ±‚æ¥å£]]></title>    <link>https://juejin.cn/post/7598532592455598107</link>    <guid>https://juejin.cn/post/7598532592455598107</guid>    <pubDate>2026-01-24T07:45:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592455598107" data-draft-id="7598021984300564507" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nuxté…ç½®ä»£ç† å’Œ è¯·æ±‚æ¥å£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-24T07:45:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±Ÿæ¹–æ–‡äºº"/> <meta itemprop="url" content="https://juejin.cn/user/3044986347066480"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nuxté…ç½®ä»£ç† å’Œ è¯·æ±‚æ¥å£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3044986347066480/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±Ÿæ¹–æ–‡äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:45:07.000Z" title="Sat Jan 24 2026 07:45:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><pre><code class="hljs language-md" lang="md">ä¸€ã€å®‰è£…

npm install @nuxtjs/axios @nuxtjs/proxy -S


// nuxt.config.js
{
  ...
  modules: [
<span class="hljs-code">    '@nuxtjs/axios',
    '@nuxtjs/proxy'
  ],
  axios: {
    // æ˜¯å¦å¯ä»¥è·¨åŸŸ
    proxy: true,
    // retry: { retries: 3 },
    // baseUrl: process.env._ENV == 'production' ? 'xxx' : 'xxx'
  },
  proxy: {
    '/api': {
      target: 'http://localhost:4000',
      pathRewrite: {
        '^/api': ''
      }
    }
  }
}
</span></code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98cd743e377f40e5a93881b1cfe4db13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5rmW5paH5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845507&amp;x-signature=PBKKKb9%2FmIDChl2Sf1im1oRX2Xc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">ç™»å½•&amp;è·å–ä¸ªäººä¿¡æ¯</h2>
<p>axiaosåœ¨é¡¹ç›®ä¸­ä¸€å®šä¼šè¿›è¡ŒäºŒæ¬¡å°è£…çš„ã€‚å°è£…çš„å†…å®¹å¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p>
<pre><code class="hljs language-ts" lang="ts">ç™»å½• æˆ‘çš„ æ–°é—»
</code></pre>
<p>ç‚¹å‡»ç™»å½•ï¼Œå®ƒå°±è·³è½¬åˆ°ç™»å½•é¡µï¼Œé‚£åœ¨ç™»å½•é¡µæˆ‘å°±å¯ä»¥è¾“å…¥è´¦å·æˆ–è€…å¯†ç ã€‚å½“ç„¶ï¼Œåœ¨æ­£å„¿å…«ç»çš„é¡¹ç›®é‡Œé¢ï¼Œå¯èƒ½ä¼šæœ‰æ‰«ç ç™»å½•æˆ–è€…éªŒè¯ç ç­‰ç­‰ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆåšä¸ªç®€æ˜“ç‰ˆçš„ï¼Œå…ˆæŠŠé€»è¾‘èµ°é€šå…ˆã€‚å°±æ˜¯ç”¨æˆ·åå’Œå¯†ç ç™»å½•ã€‚å¦‚æœè¯´å®ƒè¾“å…¥å†…å®¹ç™»å½•ä¸Šäº†ä»¥åï¼Œå°±éœ€è¦æŠŠtokenè®°å½•ä¸Šã€‚</p>
<p>å­˜å‚¨ä¹‹åï¼Œå¦‚æœè¯´ä»–å·²ç»ç™»å½•äº†ï¼Œé‚£ç‚¹å‡»åˆ°æˆ‘çš„ï¼Œå®ƒå¯ä»¥å±•ç¤ºè¿™ä¸ªç™»å½•è´¦å·çš„ä¸€ä¸ªå¤´åƒæˆ–è€…æ˜µç§°ç­‰ç­‰ä¿¡æ¯ã€‚å¦‚æœè¯´æ²¡æœ‰ç™»å½•ï¼Œç‚¹åˆ°æˆ‘çš„ï¼Œå®ƒä¼šè·³è½¬åˆ°ç™»å½•é¡µï¼Œ</p>
<p>å½“ç„¶æ–°é—»çš„è¯å‘¢ï¼Œæ˜¯ä¸éœ€è¦ç™»å½•çš„ã€‚å°±æ˜¯ç™»å½•æ²¡é‚“æ—’éƒ½å¯ä»¥è¿›å…¥åˆ°æ–°é—»é¡µã€‚</p>
<pre><code class="hljs language-html" lang="html">/pages/index.vue

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/my"</span>&gt;</span>æˆ‘çš„<span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/news"</span>&gt;</span>æ–°é—»<span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'IndexPage'</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>ç™»å½•é¡µ</p>
<pre><code class="hljs language-html" lang="html">// login.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userName"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userPwd"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"login"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">userName</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">userPwd</span>: <span class="hljs-string">''</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">login</span>(<span class="hljs-params"/>) {
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>ç„¶åå®‰è£…åŒ…</p>
<pre><code class="hljs language-ts" lang="ts">cnpm install <span class="hljs-meta">@nuxtjs</span>/axios <span class="hljs-meta">@nuxtjs</span>/proxy -<span class="hljs-title class_">Ss</span>
</code></pre>
<p>åˆ°configé‡Œé¢å»é…ç½®ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// nuxt.config.js</span>

{
  ...
  <span class="hljs-attr">modules</span>: [
    <span class="hljs-string">'@nuxtjs/axios'</span>,
    <span class="hljs-string">'@nuxtjs/proxy'</span>
  ],
  <span class="hljs-attr">axios</span>: {
    <span class="hljs-attr">proxy</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">// ä»£ç†çš„åœ°å€</span>
  <span class="hljs-attr">proxy</span>: {
    <span class="hljs-string">'/api'</span>: {
      <span class="hljs-comment">// ä¸€èˆ¬è¿™é‡Œå¡«åŸŸå </span>
      <span class="hljs-attr">target</span>: <span class="hljs-string">'http://testapi.xxx.cn/'</span>
    }
  }
}
</code></pre>
<p>ç„¶åå°±å¯ä»¥å†™æ¥å£äº†ï¼š</p>
<pre><code class="hljs language-html" lang="html">// login.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userName"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userPwd"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"login"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">userName</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">userPwd</span>: <span class="hljs-string">''</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">login</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.$axios({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/u/loginByJson'</span>,
        <span class="hljs-attr">method</span>: <span class="hljs-string">'post'</span>
      })
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œéœ€è¦<code>qs</code>ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">cnpm install qs -S
</code></pre>
<pre><code class="hljs language-html" lang="html">// login.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userName"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"userPwd"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"login"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">userName</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">userPwd</span>: <span class="hljs-string">''</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">login</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">let</span> data = qs.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">username</span>:  <span class="hljs-variable language_">this</span>.<span class="hljs-property">userName</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userPwd</span>
      })
      <span class="hljs-variable language_">this</span>.$axios({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/u/loginByJson'</span>,
        <span class="hljs-attr">method</span>: <span class="hljs-string">'post'</span>,
        data
      }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
      })
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>qs</code>ç”¨æ¥å¤„ç†<code>url</code>æŸ¥è¯¢å­—ç¬¦ä¸²çš„åºåˆ—åŒ–å’Œè§£æã€‚</p>
<h2 data-id="heading-1">è§£æ</h2>
<p>å°†urlæŸ¥è¯¢å­—ç¬¦ä¸²è½¬ä¸ºjså¯¹è±¡ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> qs <span class="hljs-keyword">from</span> <span class="hljs-string">'qs'</span>;

<span class="hljs-keyword">const</span> query = <span class="hljs-string">'?name=å¼ ä¸‰&amp;age=21'</span>;
<span class="hljs-keyword">const</span> result = qs.<span class="hljs-title function_">parse</span>(query, { <span class="hljs-attr">ignoreQueryPrefix</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// ç»“æœï¼š{ name: 'å¼ ä¸‰', age: '21' }</span>
</code></pre>
<h2 data-id="heading-2">åºåˆ—åŒ–</h2>
<p>å°†jså¯¹è±¡è½¬æ¢ä¸ºurlæŸ¥è¯¢å­—ç¬¦ä¸²</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">21</span>,
  <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">'1'</span>, <span class="hljs-string">'2'</span>]
}
<span class="hljs-keyword">const</span> queryString = qs.<span class="hljs-title function_">stringify</span>(obj);
<span class="hljs-comment">// ç»“æœ 'name=å¼ ä¸‰&amp;age=21$hobbies=1$hobbies=2'</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åµŒå¥—å¯¹è±¡</span>
qs.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-string">'value'</span> } } });
<span class="hljs-comment">// ç»“æœï¼š'a[b][c]=value'</span>

<span class="hljs-comment">// æ”¯æŒæ•°ç»„ç´¢å¼•</span>
qs.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] });
<span class="hljs-comment">// ç»“æœï¼š'a[0]=1&amp;a[1]=2&amp;a[2]=3'</span>
</code></pre>
<pre><code class="hljs language-js" lang="js">qs.<span class="hljs-title function_">stringify</span>(obj, {
  <span class="hljs-attr">encode</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// æ˜¯å¦ç¼–ç ï¼ˆé»˜è®¤trueï¼‰</span>
  <span class="hljs-attr">arrayFormat</span>: <span class="hljs-string">'brackets'</span>,  <span class="hljs-comment">// æ•°ç»„æ ¼å¼ï¼šindices/brackets/repeat</span>
  <span class="hljs-attr">skipNulls</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// è·³è¿‡nullå€¼</span>
  <span class="hljs-attr">allowDots</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// ä½¿ç”¨ç‚¹å·è¡¨ç¤ºåµŒå¥—ï¼ša.b.c=value</span>
});
</code></pre>
<p>åœ¨è¯·æ±‚ä¸­ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ä¸€ä¸‹<code>qs.stringify()</code>ä¸ºäº†å°†å¯¹è±¡æ­£ç¡®åœ°æ ¼å¼åŒ–ä¸º<code>application/x-www-form-urlencoded</code>æ ¼å¼ã€‚</p>
<p>è§£å†³axiosé»˜è®¤è¡Œä¸ºé—®é¢˜ã€‚</p>
<p>axiosé»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li>
<p>å½“dataæ˜¯å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨åºåˆ—åŒ–ä¸º<code>application/json</code>ï¼ˆjsonæ ¼å¼ï¼‰ã€‚</p>
</li>
<li>
<p>æœ‰äº›åç«¯æ¥å£è¦æ±‚<code>application/x-www-form-urlencoded</code>æ ¼å¼ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-ts" lang="ts">qs.<span class="hljs-title function_">stringfy</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'123'</span>
})

<span class="hljs-comment">// ç»“æœ 'username=%E5%BC%A0%E4%B8%89&amp;password=123456'</span>
</code></pre>
<p>è¯·æ±‚å¤´: <code>Content-Type: application/x-www-form-urlencoded</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe768935ba6d4a9899712e363259e175~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5rmW5paH5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845507&amp;x-signature=0chyQXy2On6ti7NL7MP6xv0nK2A%3D" alt="image.png" loading="lazy"/></p>
<p>ç™»å½•æˆåŠŸåæœ‰ä¸€ä¸ªtoken:</p>
<p>ç„¶åå°±éœ€è¦æŠŠtokenç»™å­˜å‚¨èµ·æ¥ã€‚ä¸‹ä¸€æ­¥åšçš„äº‹å°±æ˜¯å¦‚æœæˆ‘ç™»å½•æˆåŠŸäº†ï¼Œè‚¯å®šè¦æŠŠtokenå­˜è¿›å»ï¼Œå­˜åˆ°vuexé‡Œé¢ï¼Œå¹¶ä¸”åšåˆ°æŒä¹…åŒ–å­˜å‚¨ã€‚</p>
<p>ç‚¹å‡»æˆ‘çš„ï¼Œä¼šæ˜¾ç¤ºä¸ªäººä¿¡æ¯åœ¨é‡Œè¾¹ã€‚è·å–ä¸ªäººä¿¡æ¯ã€‚è·å–ä¸ªäººä¿¡æ¯ï¼Œéœ€è¦æŠŠtokenæºå¸¦è¿‡å»ã€‚å°±æœ‰è¿™æ ·ä¸€ä¸ªå‚æ•°ã€‚è¿™ä¸ªæ—¶å€™å°±è¦é’ˆå¯¹axiosè¿›è¡ŒäºŒæ¬¡å°è£…äº†ã€‚</p>
<p>é‚£ä¹ˆå°è£…çš„å†…å®¹å°±è¦åœ¨pluginsé‡Œé¢ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// nuxt.config.ts</span>

{
  ...
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-string">'~/plugins/axios'</span>
  ],
  ...
}
</code></pre>
<p><code>plugins/axios.js</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// axios.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ $axios, store }) =&gt; {
  <span class="hljs-comment">// Requestæ‹¦æˆªå™¨ï¼Œè®¾ç½®token</span>
  $axios.<span class="hljs-title function_">onRequest</span>(<span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    
  })
  $axios.<span class="hljs-title function_">onRequest</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    
  })
  $axios.<span class="hljs-title function_">onResponse</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
  })
}
</code></pre>
<p>äºŒæ¬¡å°è£…å°è£…çš„ç‚¹ç‰¹åˆ«å¤šï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥å°è£…å®ƒçš„ä¸€ä¸ª<code>request</code>æ‹¦æˆªå™¨å»è®¾ç½®ä¸€ä¸ª<code>token</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51ea19431e6b4507a7eab5416861f344~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5rmW5paH5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845507&amp;x-signature=7w91I4SUDcFkOEhoI%2FB84jryV94%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨storeä¸‹é¢è®¾ç½®vuexï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> state = {
  <span class="hljs-attr">token</span>: <span class="hljs-string">''</span>
}

<span class="hljs-comment">// å› ä¸ºè¦åšæœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å› ä¸ºæ²¡æœ‰localstorage\cookieç­‰,æ‰€ä»¥éœ€è¦å®‰è£… cnpm install cookie-universal-nuxt -S</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mutations = {
  <span class="hljs-title function_">setToken</span>(<span class="hljs-params">state, token</span>) {
    state.<span class="hljs-property">token</span> = token
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$cookies</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'token'</span>, token);
  },
  <span class="hljs-title function_">getToken</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-comment">// è¿™é‡Œç”¨ä¸­é—´ä»¶è¯»å–åˆ°tokenï¼Œç„¶ååœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢å»è®¾ç½®token</span>
    state.<span class="hljs-property">token</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$cookies</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'token'</span>);
  }
}
</code></pre>
<p>å¹¶ä¸”è¦æŠŠcookie-universal-nuxté…ç½®åˆ°modulesé‡Œé¢ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// nuxt.config.js</span>
{
  ...
  <span class="hljs-attr">modules</span>: [
   <span class="hljs-string">'cookie-universal-nuxt'</span>
  ]
}
</code></pre>
<p>è®¾ç½®å®Œæˆåï¼Œå›åˆ°ä»»ä½•ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒéƒ½æœ‰ã€‚ç„¶åæˆ‘ä»¬éœ€è¦è®¤è¯å®ˆå«ã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠä¸­é—´ä»¶åˆ›å»ºä¸€ä¸‹ï¼Œå…ˆåœ¨æ ¹ç›®å½•åˆ›å»º<code>middleware</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨è¿™ä¸‹é¢åˆ›å»ºä¸€ä¸ª<code>auth.js</code>æ–‡ä»¶ï¼Œ</p>
<pre><code class="hljs language-js" lang="js"/></pre>
<p>åœ¨myé¡µé¢åšmiddlewareï¼š</p>
<pre><code class="hljs language-html" lang="html">// my.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æˆ‘çš„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span>{
  <span class="hljs-attr">middleware</span>: <span class="hljs-string">'auth'</span>
}
&lt;/scirpt&gt;
</span></code></pre>
<p><code>middleware</code>åœ¨<code>my</code>é¡µé¢ç”Ÿæ•ˆã€‚è¿™æ˜¯æˆ‘ä»¬è¯»å–å‡ºæ¥çš„<code>store</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// middleware/auth.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ store }) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(store.<span class="hljs-property">state</span>);
}
</code></pre>
<p>ç„¶åè·å–tokençš„å€¼ï¼Œæˆ‘ä»¬å·²ç»æŒä¹…åŒ–å­˜åˆ°cookieäº†ï¼Œå¯ä»¥commitå»æäº¤é‚£ä¸ª<code>getToken</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// middleware/auth.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ store }) =&gt; {
  store.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'getToken'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(store.<span class="hljs-property">state</span>);
}
</code></pre>
<p>ç„¶åå°±å¯ä»¥è¯»å–å¾—åˆ°<code>token</code>äº†ã€‚</p>
<p>å¦‚æœæ²¡æœ‰tokençš„ï¼Œå°±è®©ä»–è·³è½¬åˆ°ç™»å½•é¡µï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// middleware/auth.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ store, redirect }) =&gt; {
  store.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'getToken'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(store.<span class="hljs-property">state</span>);
  <span class="hljs-keyword">if</span> (!store.<span class="hljs-property">state</span>.<span class="hljs-property">token</span>) {
    <span class="hljs-title function_">redirect</span>(<span class="hljs-string">'/login'</span>)
  }
}
</code></pre>
<pre><code class="hljs language-html" lang="html">// login.vue

methods: {
  ...mapMutations(['setToken']),
  login() {
    let data = qs.stringify({
      username: this.userName,
      password: this.userPwd
    });
    
    this.$axios({
      url: '/api/u/loginByJson',
      method: 'post',
      data
    }).then(res =&gt; {
      this.setToken(res.data.accessToken)
      this.$router.push({
        name: 'index'
      })
    })
  }
}
</code></pre>
<p>å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œé‚£ä¹ˆç‚¹å‡»æˆ‘çš„å°±ä¼šè¿›å…¥ç™»å½•é¡µï¼Œç™»å½•ä¹Ÿå¡«å…¥è´¦å·å’Œå¯†ç ï¼Œç‚¹å‡»ç™»å½•ï¼Œå°±ä¼šè¯·æ±‚ç™»å½•æ¥å£ï¼Œç„¶åè·å¾—tokenï¼Œtokenå°±ä¼šè®¾ç½®åˆ°cookieé‡Œé¢ï¼Œå†ç‚¹å‡»æˆ‘çš„ï¼Œå°±ä¼šå¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯äº†ï¼Œç„¶åstate.tokenä¼šåœ¨ä¸­é—´ä»¶é‡ŒåˆæŠŠæœ¬åœ°cookieé‡Œé¢çš„tokenè®¾ç½®å›å»ç»™å®ƒï¼ˆå®ŒæˆæŒä¹…æ€§ï¼‰ã€‚</p>
<p>åšå®Œä¹‹åï¼Œåœ¨æˆ‘çš„é¡µé¢ï¼Œæƒ³è¦è·å¾—åˆ°ä¸ªäººä¿¡æ¯ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨<code>my.vue</code>å°±å¯ä»¥åšæ–‡ç« äº†ï¼š</p>
<pre><code class="hljs language-html" lang="html">// my.vue

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æˆ‘çš„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">middleware</span>: <span class="hljs-string">'auth'</span>,
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">asyncData</span>(<span class="hljs-params">{ $axios }</span>) {
    <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> $axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/member/getInfo'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>è¯·æ±‚çš„axiosè¦å…¨å±€å°è£…ï¼Œä¸€å®šè¦å¸¦tokenï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// axios.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ $axios }) =&gt; {
  <span class="hljs-comment">// Requestæ‹¦æˆªå™¨ï¼Œè®¾ç½®token</span>
  $axios.<span class="hljs-title function_">onRequest</span>(<span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    config.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>] = store.<span class="hljs-property">state</span>.<span class="hljs-property">token</span>;
  })
  <span class="hljs-comment">// Erroræ‹¦æˆªå™¨ï¼šå‡ºç°é”™è¯¯çš„æ—¶å€™è¢«è°ƒç”¨</span>
  $axios.<span class="hljs-title function_">onRequest</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-title function_">consolelog</span>(<span class="hljs-number">222</span>, error);
  })
  $axios.<span class="hljs-title function_">onResponse</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">333</span>, response)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  })
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ReentrantLockå’ŒAQSæºç è§£æ]]></title>    <link>https://juejin.cn/post/7598465042968199208</link>    <guid>https://juejin.cn/post/7598465042968199208</guid>    <pubDate>2026-01-24T07:51:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598465042968199208" data-draft-id="7596186565270290447" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ReentrantLockå’ŒAQSæºç è§£æ"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-24T07:51:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ReentrantLockå’ŒAQSæºç è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:51:46.000Z" title="Sat Jan 24 2026 07:51:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡æºç åŸºäºJDK 1.8</p>
<p>åœ¨ Java ä¸­ï¼ŒDong Lea å¤§å¸ˆä¸ºæˆ‘ä»¬æä¾›äº†å¤§é‡å¹¶å‘ç¼–ç¨‹å·¥å…·ç±»ï¼Œå®ƒä»¬éƒ½åœ¨ JDK çš„ java.util.concurrent åŒ…ä¸‹ï¼Œå…¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec594e8d6f5f4d75a4f5eec212cebcaa~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=580&amp;h=648&amp;s=81240&amp;e=png&amp;b=fefee6" alt="image.png" width="50%" loading="lazy"/>
<p>current åŒ…ä¸­åŒ…å«å¾ˆå¤šæˆ‘ä»¬å¸¸ç”¨çš„å¹¶å‘å·¥å…·ç±»ï¼Œå¦‚ï¼šConcurrentHashMapã€CopyOnWriteArrayListã€ArrayBlockingQueueã€LinkedBlockingQueueã€ThreadPoolExecutor ç­‰ã€‚</p>
<p>å…¶ä¸­è¿˜åŒ…å«äº† 2 ä¸ªå­åŒ…ï¼š atomic å’Œ locks ã€‚atomic åŒ…ä¸‹æœ‰ AtomicBooleanã€AtomicIntegerã€atomicReference ç­‰ CAS åŸå­å˜é‡ç±»ï¼Œ locks åŒ…ä¸‹æœ‰ ReentrantLockã€ReentrantReadWriteLockã€AbstractQueuedSynchronizer ç­‰é”åŠé”çš„åº•å±‚å®ç°åŸºç¡€æ¡†æ¶ã€‚è¿™äº›ç±»çš„å®ç°ä¸»è¦æ˜¯ä¾èµ–äº volatile åŠ CAS ï¼Œä»æ•´ä½“ä¸Šæ¥çœ‹ concurrent åŒ…çš„æ•´ä½“å®ç°å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec7cb609de1c454f84a53677d1d7db7b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=822&amp;h=480&amp;s=42818&amp;e=png&amp;b=fdfdfd" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-0">Lock</h4>
<p>é”èƒ½å¤Ÿè§£å†³å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºé€ æˆçš„åŒæ­¥é—®é¢˜ï¼Œåœ¨ Lock æ¥å£å‡ºç°ä¹‹å‰ï¼Œ Java ä¸»è¦æ˜¯é  synchronized å…³é”®å­—æ¥å®ç°é”åŠŸèƒ½ï¼Œ Java SE5 ä¹‹åå¹¶å‘åŒ…ä¸­å¢åŠ äº† Lock æ¥å£ï¼Œå®ƒæä¾›äº†ä¸ synchronized ä¸€æ ·çš„é”åŠŸèƒ½ã€‚å®ƒè™½ç„¶æ²¡æœ‰ä½¿ç”¨ synchronize å…³é”®å­—é‚£ä¹ˆä¾¿æ·ï¼Œä½†æ˜¯å®ƒæ‹¥æœ‰è·å–å’Œé‡Šæ”¾é”çš„å¯æ“ä½œæ€§ï¼Œè¿˜æœ‰å¯ä¸­æ–­åœ°è·å–é”ä»¥åŠè¶…æ—¶è·å–é”ç­‰å¤šç§ synchronized å…³é”®å­—æ‰€ä¸å…·å¤‡çš„åŒæ­¥ç‰¹æ€§ã€‚</p>
<p>Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢æœ‰ 6 ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lock</span> {

    <span class="hljs-comment">// è·å–é”ï¼Œæ— è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æ‹¿åˆ°é”å°†æ— æ³•è¿›è¡Œçº¿ç¨‹è°ƒåº¦å¹¶å¤„äºä¼‘çœ çŠ¶æ€ç›´åˆ°æ‹¿åˆ°é”</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">// å’Œä¸Šé¢ä¸åŒçš„åœ°æ–¹æ˜¯è·å–é”çš„è¿‡ç¨‹èƒ½å¤Ÿå“åº”ä¸­æ–­</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;

    <span class="hljs-comment">// è·å–é”ï¼Œæœ‰è¿”å›å€¼ï¼Œèƒ½æ‹¿åˆ°é”ç«‹å³è¿”å› true ï¼›å¦åˆ™è¿”å› false ;</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">// åœ¨è¶…æ—¶æ—¶é—´å†…å¹¶ä¸”æ²¡æœ‰è¢«ä¸­æ–­çš„æƒ…å†µä¸‹å¦‚æœé”æ˜¯ç©ºé—²çš„å°±èƒ½æ‹¿åˆ°é”</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;

    <span class="hljs-comment">// é‡Šæ”¾é”</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">// è¿”å›è·Ÿé”å®ä¾‹ç»‘å®šçš„Conditionå®ä¾‹</span>
    Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span>;
}
</code></pre>
<h4 data-id="heading-1">ReentrantLock</h4>
<p>ReentrantLock å®ç°äº† Lock æ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">()</span> {
        sync = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">(<span class="hljs-type">boolean</span> fair)</span> {
        sync = fair ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">FairSync</span>() : <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        sync.lock();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        sync.acquireInterruptibly(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.nonfairTryAcquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span>
            <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">return</span> sync.tryAcquireNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.newCondition();
    }

}
</code></pre>
<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°é‡Œé¢çš„æ–¹æ³•éƒ½æ˜¯é€šè¿‡ sync æ¥å®ç°çš„ï¼Œå¦‚æœè°ƒç”¨ ReentrantLock æ— å‚çš„æ„é€ æ–¹æ³•ï¼Œsync å°±æ˜¯ NonfairSync çš„å®ä¾‹ï¼›å¦‚æœä½¿ç”¨ new ReentrantLock(true) ï¼Œåˆ™ sync å°±æ˜¯ FairSync çš„å®ä¾‹ã€‚</p>
<p>ä»–ä»¬ä¿©åˆ†åˆ«æ˜¯éå…¬å¹³é”å’Œå…¬å¹³é”ï¼Œç”±æ­¤å¯çŸ¥ ReentrantLock é»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œ NonfairSync å’Œ FairSync çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable {

    <span class="hljs-comment">/**
     * Sync object for non-fair locks
     */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">7316153563782823691L</span>;

        <span class="hljs-comment">/**
         * Performs lock. Try immediate barge, backing up to normal
         * acquire on failure.
         */</span>
        <span class="hljs-comment">// Android-removed: @ReservedStackAccess from OpenJDK 9, not available on Android.</span>
        <span class="hljs-comment">// @ReservedStackAccess</span>
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))
                setExclusiveOwnerThread(Thread.currentThread());
            <span class="hljs-keyword">else</span>
                acquire(<span class="hljs-number">1</span>);
        }

        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-comment">// è°ƒç”¨ nonfairTryAcquire() æ–¹æ³•</span>
            <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);
        }
    }

    <span class="hljs-comment">/**
     * Sync object for fair locks
     */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3000897897090466540L</span>;

        <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
            acquire(<span class="hljs-number">1</span>);
        }

        <span class="hljs-comment">/**
         * Fair version of tryAcquire. Don't grant access unless
         * recursive call or no waiters or is first.
         */</span>
        <span class="hljs-comment">// Android-removed: @ReservedStackAccess from OpenJDK 9, not available on Android.</span>
        <span class="hljs-comment">// @ReservedStackAccess</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
            <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
            <span class="hljs-comment">// é”æ²¡æœ‰è¢«çº¿ç¨‹æŒæœ‰</span>
            <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// ç­‰å¾…é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹</span>
                <span class="hljs-keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;
                        compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                    setExclusiveOwnerThread(current);
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                }
            }
            <span class="hljs-comment">// é”å·²ç»è¢«æŸä¸ªçº¿ç¨‹æŒæœ‰ï¼Œåˆ™åˆ¤æ–­è¯¥çº¿ç¨‹æ˜¯å¦æ˜¯å½“å‰çº¿ç¨‹</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
                <span class="hljs-comment">// å†æ¬¡è·å–ï¼Œè®¡æ•°åŠ  1</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
                <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
                setState(nextc);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }


    <span class="hljs-comment">/**
     * Base of synchronization control for this lock. Subclassed
     * into fair and nonfair versions below. Uses AQS state to
     * represent the number of holds on the lock.
     */</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> -<span class="hljs-number">5179523762034025860L</span>;

        <span class="hljs-comment">/**
         * Performs {<span class="hljs-doctag">@link</span> Lock#lock}. The main reason for subclassing
         * is to allow fast path for nonfair version.
         */</span>
        <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;

        <span class="hljs-comment">/**
         * Performs non-fair tryLock. tryAcquire is implemented in
         * subclasses, but both need nonfair try for trylock method.
         */</span>
        <span class="hljs-comment">// Android-removed: @ReservedStackAccess from OpenJDK 9, not available on Android.</span>
        <span class="hljs-comment">// @ReservedStackAccess</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
            <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
            <span class="hljs-comment">// é”æ²¡æœ‰è¢«çº¿ç¨‹æŒæœ‰ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹å¯ä»¥å»è·å–é”</span>
            <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                    setExclusiveOwnerThread(current);
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                }
            }
            <span class="hljs-comment">// é”å·²ç»è¢«æŸä¸ªçº¿ç¨‹æŒæœ‰ï¼Œåˆ™åˆ¤æ–­è¯¥çº¿ç¨‹æ˜¯å¦æ˜¯å½“å‰çº¿ç¨‹</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
                <span class="hljs-comment">// å†æ¬¡è·å–ï¼Œè®¡æ•°åŠ 1</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
                <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span>
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
                setState(nextc);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// Android-removed: @ReservedStackAccess from OpenJDK 9, not available on Android.</span>
        <span class="hljs-comment">// @ReservedStackAccess</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
            <span class="hljs-comment">//è®¡æ•°å‡1</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;
            <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
            <span class="hljs-comment">//è®¡æ•°ä¸º0æ—¶ï¼Œå½“å‰çº¿ç¨‹é‡Šæ”¾é”</span>
            <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
                free = <span class="hljs-literal">true</span>;
                setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            }
            setState(c);
            <span class="hljs-comment">//è®¡æ•°ä¸ä¸º0æ—¶ï¼Œè¿”å›false</span>
            <span class="hljs-keyword">return</span> free;
        }

        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// While we must in general read state before owner,</span>
            <span class="hljs-comment">// we don't need to do so to check if current thread is owner</span>
            <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();
        }

        <span class="hljs-keyword">final</span> ConditionObject <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionObject</span>();
        }

        <span class="hljs-comment">// Methods relayed from outer class</span>

        <span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : getExclusiveOwnerThread();
        }

        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> isHeldExclusively() ? getState() : <span class="hljs-number">0</span>;
        }

        <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getState() != <span class="hljs-number">0</span>;
        }

        <span class="hljs-comment">/**
         * Reconstitutes the instance from a stream (that is, deserializes it).
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream s)</span>
                <span class="hljs-keyword">throws</span> java.io.IOException, ClassNotFoundException {
            s.defaultReadObject();
            setState(<span class="hljs-number">0</span>); <span class="hljs-comment">// reset to unlocked state</span>
        }
    }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ° NonfairSync å’Œ FairSync å‡ç»§æ‰¿è‡ª Sync ç±»ï¼ŒSync ç±»æ˜¯ ReentrantLock ç±»ä¸­çš„æŠ½è±¡é™æ€å†…éƒ¨ç±»ï¼Œ Sync ç±»ç»§æ‰¿è‡ª AbstractQueuedSynchronizer ç±»ï¼ŒSync ç±»ä¸­çš„ lock() æ–¹æ³•æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»é‡å†™ã€‚ NonfairSync å’Œ FairSync ç±»ä¸­åˆ†åˆ«å¯¹ lock() æ–¹æ³•è¿›è¡Œäº†ä¸åŒçš„é‡å†™å®ç°ã€‚å…¶åŒºåˆ«æ˜¯ NonfairSync ä¸­çš„ lock() æ–¹æ³•ä¼šå…ˆä½¿ç”¨ CAS å°è¯•è·å–é”ï¼Œå¦‚æœæˆåŠŸäº†ï¼Œè®¾ç½®å½“å‰çº¿ç¨‹ä¸ºæ‹¥æœ‰ç‹¬å è®¿é—®æƒé™çš„çº¿ç¨‹ï¼Œå¦‚æœ CAS ä¸æˆåŠŸï¼Œå†è°ƒç”¨ AQS ä¸­çš„ acquire(1) ï¼Œè€Œ FairSync ä¸­çš„ lock() æ–¹æ³•ç›´æ¥è°ƒç”¨äº† acquire(1) ï¼Œ acquire() æ–¹æ³•æ¥è‡ª AbstractQueuedSynchronizer ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
        <span class="hljs-comment">// å…ˆä½¿ç”¨ tryAcquire(arg) è·å–é”ï¼Œå…¬å¹³é”å’Œéå…¬å¹³é”åˆ†åˆ«å¯¹</span>
        <span class="hljs-comment">// tryAcquire() è¿›è¡Œäº†ä¸åŒçš„é‡å†™ï¼ŒaddWaiter() ä¼šå°†å½“å‰çº¿ç¨‹</span>
        <span class="hljs-comment">// å¯¹åº”çš„ Node åŠ å…¥ç­‰å¾…åŒå‘é“¾è¡¨ï¼ŒacquireQueued()å¯ä»¥å¯¹æ’é˜Ÿ</span>
        <span class="hljs-comment">// ä¸­çš„çº¿ç¨‹è¿›è¡Œè·å–é”çš„æ“ä½œ</span>
        <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
                acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
            selfInterrupt();
    }
}
</code></pre>
<p>å…¶ä¸­ tryAcquire() æ–¹æ³•åœ¨ NonfairSync å’Œ FairSync ç±»ä¸­ä¹Ÿæœ‰ä¸åŒçš„é‡å†™å®ç°ï¼Œä¸»è¦åŒºåˆ«æ˜¯ FairSync ä¸­ä¼šå…ˆåˆ¤æ–­ç­‰å¾…é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰å‰é©±èŠ‚ç‚¹è¯´æ˜æœ‰çº¿ç¨‹æ¯”å½“å‰çº¿ç¨‹æ›´æ—©è·å–é”ï¼Œæ ¹æ®å…¬å¹³æ€§ï¼Œå½“å‰çº¿ç¨‹è·å–é”å¤±è´¥ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯ ReentrantLock ä¸­å…¬å¹³é”ä¸éå…¬å¹³é”çš„åŒºåˆ«ã€‚</p>
<p>ç›´æ¥ä»åå­—å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œ ReentrantLock æ˜¯å¯é‡å…¥é”ã€‚ä»ä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒtryAcquire() å’Œ nonfairTryAcquire() æ–¹æ³•ä¸­åˆ¤æ–­å¦‚æœå½“å‰çº¿ç¨‹å·²ç»æŒæœ‰äº†é”ï¼Œè®¡æ•°åŠ  1 ã€‚åœ¨ tryRelease() ä¸­è®¡æ•°å‡1ï¼Œç›´åˆ°è®¡æ•°ä¸º 0 æ‰é‡Šæ”¾é”ï¼Œæ‰€ä»¥ä½¿ç”¨ ReentrantLock é‡å¤å¯¹ä¸€ä¸ªçº¿ç¨‹åŠ é”å¹¶ä¸ä¼šå¯¼è‡´æ­»é”ã€‚</p>
<h4 data-id="heading-2">AbstractQueuedSynchronizer</h4>
<p>Sync ç±»ç»§æ‰¿è‡ª AbstractQueuedSynchronizer ç±»ï¼ŒAbstractQueuedSynchronizer æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæºç ä¸­æœ‰ååˆ†å…·ä½“çš„è§£é‡Šï¼š</p>
<pre><code class="hljs language-java" lang="java">Provides a framework <span class="hljs-keyword">for</span> implementing blocking locks and related <span class="hljs-title function_">synchronizers</span> <span class="hljs-params">(semaphores, events, etc)</span> that
rely on first-in-first-out (FIFO) wait queues. This <span class="hljs-keyword">class</span> <span class="hljs-title class_">is</span> designed to be a useful basis <span class="hljs-keyword">for</span> most kinds of
synchronizers that rely on a single atomic <span class="hljs-type">int</span> value to represent state. Subclasses must define the <span class="hljs-keyword">protected</span>
methods that change <span class="hljs-built_in">this</span> state, and which define what that state means in terms of <span class="hljs-built_in">this</span> object being acquired
or released. Given these, the other methods in <span class="hljs-built_in">this</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">carry</span> out all queuing and blocking mechanics.
Subclasses can maintain other state fields, but only the atomically updated <span class="hljs-type">int</span> value manipulated using
methods getState, setState and compareAndSetState is tracked with respect to synchronization

Subclasses should be defined as non-<span class="hljs-keyword">public</span> internal helper classes that are used to implement the
synchronization properties of their enclosing class. Class AbstractQueuedSynchronizer does not implement
any synchronization interface. Instead it defines methods such as acquireInterruptibly that can be invoked
as appropriate by concrete locks and related synchronizers to implement their <span class="hljs-keyword">public</span> methods.

This <span class="hljs-keyword">class</span> <span class="hljs-title class_">supports</span> either or both a <span class="hljs-keyword">default</span> exclusive mode and a shared mode. When acquired in exclusive
mode, attempted acquires by other threads cannot succeed. Shared mode acquires by multiple threads <span class="hljs-title function_">may</span>
<span class="hljs-params">(but need not)</span> succeed. This <span class="hljs-keyword">class</span> <span class="hljs-title class_">does</span> not <span class="hljs-string">"understand"</span> these differences except in the mechanical sense
that when a shared mode acquire succeeds, the next waiting <span class="hljs-title function_">thread</span> <span class="hljs-params">(<span class="hljs-keyword">if</span> one exists)</span> must also determine whether
it can acquire as well. Threads waiting in the different modes share the same FIFO queue. Usually,
implementation subclasses support only one of these modes, but both can come into play <span class="hljs-keyword">for</span> example in a
ReadWriteLock. Subclasses that support only exclusive or only shared modes need not define the methods supporting the unused mode.
</code></pre>
<p>AbstractQueuedSynchronizer æ˜¯ç”¨æ¥å®ç°é”å’Œç›¸å…³åŒæ­¥å™¨ï¼ˆä¿¡å·é‡ã€äº‹ä»¶ç­‰ï¼‰çš„åŸºç¡€æ¡†æ¶ï¼Œå®ƒçš„å®ç°ä¸»è¦ä¾èµ–ä¸€ä¸ª atomic int æˆå‘˜å˜é‡è¡¨ç¤ºçš„åŒæ­¥çŠ¶æ€å’Œä¸€ä¸ª FIFO é˜Ÿåˆ—æ„æˆçš„ç­‰å¾…é˜Ÿåˆ—ã€‚å­ç±»å¿…é¡»é‡å†™ AQS çš„ protected ä¿®é¥°çš„ç”¨æ¥æ”¹å˜åŒæ­¥çŠ¶æ€çš„æ–¹æ³•ï¼Œ AQS çš„å…¶ä»–å‡ ä¸ªæ–¹æ³•å®ç°äº†æ’é˜Ÿå’Œé˜»å¡æœºåˆ¶ã€‚å­ç±»å¯ä»¥ç»´æŠ¤å…¶ä»–çŠ¶æ€å­—æ®µï¼Œä½†æ˜¯å»ºè®®æ›´æ–°åŒæ­¥çŠ¶æ€ä½¿ç”¨ getState() ã€ setState() ä»¥åŠ compareAndSetState() è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<p>å­ç±»åº”å®šä¹‰ä¸ºéå…¬å…±å†…éƒ¨å¸®åŠ©ç±»ç”¨äºå®ç°å…¶å°é—­ç±»çš„åŒæ­¥å±æ€§ï¼ŒAQS è‡ªèº«æ²¡æœ‰å®ç°ä»»ä½•åŒæ­¥æ¥å£ï¼Œå®ƒå®šä¹‰äº† acquireInterruptibly() è¿™ç±»æ–¹æ³•ï¼Œå®ƒå¯ä»¥è¢«å…·ä½“çš„é”å’Œç›¸å…³åŒæ­¥å™¨é‡Œé¢çš„å…¬å…±æ–¹æ³•è°ƒç”¨ã€‚</p>
<p>è¯¥ç±»æ”¯æŒé»˜è®¤çš„ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€å’Œå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„ä¸¤è€…æˆ–è€…ä¹‹ä¸€ï¼Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿çš„å®ç°ä¸åŒç±»å‹çš„åŒæ­¥ç»„ä»¶ã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯ç‹¬å é”ï¼Ÿä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ</strong><br/>
ç‹¬å é”ä¹Ÿå«æ’å®ƒé”ï¼Œæ˜¯æŒ‡è¯¥é”ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œå¦‚æœåˆ«çš„çº¿ç¨‹æƒ³è¦è·å–é”ï¼Œåªæœ‰ç­‰åˆ°æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ã€‚<strong>è·å¾—æ’å®ƒé”çš„çº¿ç¨‹æ—¢èƒ½è¯»å–æ•°æ®åˆèƒ½ä¿®æ”¹æ•°æ®</strong>ï¼Œä¸ä¹‹å¯¹ç«‹çš„å°±æ˜¯å…±äº«é”ã€‚å…±äº«é”æ˜¯æŒ‡è¯¥é”å¯è¢«å¤šä¸ªçº¿ç¨‹æ‰€æŒæœ‰ã€‚å¦‚æœçº¿ç¨‹Tå¯¹æ•°æ®AåŠ ä¸Šå…±äº«é”åï¼Œåˆ™å…¶ä»–çº¿ç¨‹åªèƒ½å¯¹Aå†åŠ å…±äº«é”ï¼Œä¸èƒ½åŠ æ’å®ƒé”ã€‚<strong>è·å¾—å…±äº«é”çš„çº¿ç¨‹åªèƒ½è¯»æ•°æ®ï¼Œä¸èƒ½ä¿®æ”¹æ•°æ®</strong>ã€‚</p>
<p>AQS ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ï¼Œå­ç±»å¿…é¡»é‡å†™ AQS çš„ protected ä¿®é¥°çš„ç”¨æ¥æ”¹å˜åŒæ­¥çŠ¶æ€çš„æ–¹æ³•ï¼Œè¿˜è¦åœ¨è‡ªå·±çš„ public æ–¹æ³•ä¸­è°ƒç”¨ acquireInterruptibly() è¿™ç±»æ¨¡æ¿æ–¹æ³•ã€‚ä¾‹å¦‚ AQS ä¸­çš„tryAcquire(int arg)æ–¹æ³•å°±æ˜¯ä¸€ä¸ªè¢« protected ä¿®é¥°çš„ç”¨æ¥æ”¹å˜åŒæ­¥çŠ¶æ€çš„æ–¹æ³•ï¼Œåœ¨å‰é¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ° ReentrantLock çš„ FairSync å’Œ NonfairSync å¯¹ tryAcquire(int arg) æ–¹æ³•è¿›è¡Œäº†å¯¹ä¸åŒçš„é‡å†™ï¼Œè€Œ acquireInterruptibly(int arg) åˆ™è¢« ReentrantLock ä¸­çš„ lockInterruptibly() çš„ public æ–¹æ³•è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    sync.acquireInterruptibly(<span class="hljs-number">1</span>);
}
</code></pre>
<p>å…¶ä¸­ AQS å¯ä»¥é‡å†™çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Attempts to acquire in exclusive mode. This method should query
 * if the state of the object permits it to be acquired in the
 * exclusive mode, and if so to acquire it.
 * ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ã€‚è¯¥æ–¹æ³•åº”è¯¥æŸ¥è¯¢æ˜¯å¦å…è®¸ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœå¯ä»¥å°±ä½¿ç”¨CASè·å–åŒæ­¥çŠ¶æ€
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}

<span class="hljs-comment">/**
 * Attempts to set the state to reflect a release in exclusive
 * mode.
 *
 * &lt;p&gt;This method is always invoked by the thread performing release.
 * ç‹¬å å¼é‡Šæ”¾é”ï¼Œç­‰å¾…è·å–åŒæ­¥çŠ¶æ€çš„çº¿ç¨‹å°†æœ‰æœºä¼šè·å–åŒæ­¥çŠ¶æ€
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}

<span class="hljs-comment">/**
 * Attempts to acquire in shared mode. This method should query if
 * the state of the object permits it to be acquired in the shared
 * mode, and if so to acquire it.
 *
 * &lt;p&gt;This method is always invoked by the thread performing
 * acquire. If this method reports failure, the acquire method
 * may queue the thread, if it is not already queued, until it is
 * signalled by a release from some other thread.
 *
 * &lt;p&gt;The default implementation throws {<span class="hljs-doctag">@link</span>
 * UnsupportedOperationException}.
 * å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œè¿”å›å€¼å¤§äºç­‰äº0è¡¨ç¤ºè·å–æˆåŠŸï¼Œåä¹‹è·å–å¤±è´¥
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}

<span class="hljs-comment">/**
 * Attempts to set the state to reflect a release in shared mode.
 *
 * &lt;p&gt;This method is always invoked by the thread performing release.
 *
 * &lt;p&gt;The default implementation throws
 * {<span class="hljs-doctag">@link</span> UnsupportedOperationException}.
 * å…±äº«å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}

<span class="hljs-comment">/**
 * Returns {<span class="hljs-doctag">@code</span> true} if synchronization is held exclusively with
 * respect to the current (calling) thread. This method is invoked
 * upon each call to a non-waiting {<span class="hljs-doctag">@link</span> ConditionObject} method.
 * (Waiting methods instead invoke {<span class="hljs-doctag">@link</span> #release}.)
 * åŒæ­¥å™¨æ˜¯å¦è¢«å½“å‰çº¿ç¨‹ç‹¬å 
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p>AQS æä¾›çš„æ¨¡æ¿æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Acquires in exclusive mode, ignoring interrupts. Implemented
 * by invoking at least once {<span class="hljs-doctag">@link</span> #tryAcquire},
 * returning on success. Otherwise the thread is queued, possibly
 * repeatedly blocking and unblocking, invoking {<span class="hljs-doctag">@link</span>
 * #tryAcquire} until success. This method can be used
 * to implement method {<span class="hljs-doctag">@link</span> Lock#lock}.
 * ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸç›´æ¥ç»“æŸï¼Œå¦‚æœå¤±è´¥çº¿ç¨‹å°†ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨é‡å†™çš„
 * tryAcquire()æ–¹æ³•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
            acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        selfInterrupt();
}

<span class="hljs-comment">/**
 * Acquires in exclusive mode, aborting if interrupted.
 * Implemented by first checking interrupt status, then invoking
 * at least once {<span class="hljs-doctag">@link</span> #tryAcquire}, returning on
 * success. Otherwise the thread is queued, possibly repeatedly
 * blocking and unblocking, invoking {<span class="hljs-doctag">@link</span> #tryAcquire}
 * until success or the thread is interrupted. This method can be
 * used to implement method {<span class="hljs-doctag">@link</span> Lock#lockInterruptibly}.
 * ä¸acquire(int arg)ç›¸åŒï¼Œä½†è¯¥æ–¹æ³•å¯ä»¥å“åº”ä¸­æ–­ï¼Œè¢«ä¸­æ–­æ—¶æŠ›å‡ºInterruptedException
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquireInterruptibly</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span>
        <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-keyword">if</span> (Thread.interrupted())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();
    <span class="hljs-keyword">if</span> (!tryAcquire(arg))
        doAcquireInterruptibly(arg);
}

<span class="hljs-comment">/**
 * Attempts to acquire in exclusive mode, aborting if interrupted,
 * and failing if the given timeout elapses. Implemented by first
 * checking interrupt status, then invoking at least once {<span class="hljs-doctag">@link</span>
 * #tryAcquire}, returning on success. Otherwise, the thread is
 * queued, possibly repeatedly blocking and unblocking, invoking
 * {<span class="hljs-doctag">@link</span> #tryAcquire} until success or the thread is interrupted
 * or the timeout elapses. This method can be used to implement
 * method {<span class="hljs-doctag">@link</span> Lock#tryLock(long, TimeUnit)}.
 * åœ¨InterruptedException(int arg)åŸºç¡€ä¸Šå¢åŠ äº†è¶…æ—¶é™åˆ¶ï¼Œå¦‚æœå½“å‰çº¿ç¨‹åœ¨è¶…æ—¶æ—¶é—´å†…
 * æ²¡æœ‰è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œå°†ä¼šè¿”å›falseï¼Œè·å–åˆ°äº†è¿”å›true
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquireNanos</span><span class="hljs-params">(<span class="hljs-type">int</span> arg, <span class="hljs-type">long</span> nanosTimeout)</span>
        <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-keyword">if</span> (Thread.interrupted())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();
    <span class="hljs-keyword">return</span> tryAcquire(arg) ||
            doAcquireNanos(arg, nanosTimeout);
}


<span class="hljs-comment">/**
 * Acquires in shared mode, ignoring interrupts. Implemented by
 * first invoking at least once {<span class="hljs-doctag">@link</span> #tryAcquireShared},
 * returning on success. Otherwise the thread is queued, possibly
 * repeatedly blocking and unblocking, invoking {<span class="hljs-doctag">@link</span>
 * #tryAcquireShared} until success.
 * å…±äº«å¼çš„è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œå°†ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ä¸­
 * ç­‰å¾…ï¼Œä¸ç‹¬å å¼è·å–çš„ä¸»è¦åŒºåˆ«æ˜¯åœ¨åŒä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryAcquireShared(arg) &lt; <span class="hljs-number">0</span>)
        doAcquireShared(arg);
}

<span class="hljs-comment">/**
 * Acquires in shared mode, aborting if interrupted. Implemented
 * by first checking interrupt status, then invoking at least once
 * {<span class="hljs-doctag">@link</span> #tryAcquireShared}, returning on success. Otherwise the
 * thread is queued, possibly repeatedly blocking and unblocking,
 * invoking {<span class="hljs-doctag">@link</span> #tryAcquireShared} until success or the thread
 * is interrupted.
 * ä¸acquireShared(int arg)ç›¸åŒï¼Œè¯¥æ–¹æ³•å“åº”ä¸­æ–­
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquireSharedInterruptibly</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span>
        <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-keyword">if</span> (Thread.interrupted())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();
    <span class="hljs-keyword">if</span> (tryAcquireShared(arg) &lt; <span class="hljs-number">0</span>)
        doAcquireSharedInterruptibly(arg);
}

<span class="hljs-comment">/**
 * Attempts to acquire in shared mode, aborting if interrupted, and
 * failing if the given timeout elapses. Implemented by first
 * checking interrupt status, then invoking at least once {<span class="hljs-doctag">@link</span>
 * #tryAcquireShared}, returning on success. Otherwise, the
 * thread is queued, possibly repeatedly blocking and unblocking,
 * invoking {<span class="hljs-doctag">@link</span> #tryAcquireShared} until success or the thread
 * is interrupted or the timeout elapses.
 * åœ¨acquireSharedInterruptibly(int arg)åŸºç¡€ä¸Šå¢åŠ äº†è¶…æ—¶é™åˆ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquireSharedNanos</span><span class="hljs-params">(<span class="hljs-type">int</span> arg, <span class="hljs-type">long</span> nanosTimeout)</span>
        <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-keyword">if</span> (Thread.interrupted())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();
    <span class="hljs-keyword">return</span> tryAcquireShared(arg) &gt;= <span class="hljs-number">0</span> ||
            doAcquireSharedNanos(arg, nanosTimeout);
}

<span class="hljs-comment">/**
 * Releases in exclusive mode. Implemented by unblocking one or
 * more threads if {<span class="hljs-doctag">@link</span> #tryRelease} returns true.
 * This method can be used to implement method {<span class="hljs-doctag">@link</span> Lock#unlock}.
 * ç‹¬å å¼çš„é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€ä¹‹åï¼Œå°†é˜Ÿå¤´èŠ‚ç‚¹
 * çš„çº¿ç¨‹å”¤é†’
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * Releases in shared mode. Implemented by unblocking one or more
 * threads if {<span class="hljs-doctag">@link</span> #tryReleaseShared} returns true.
 * å…±äº«å¼çš„é‡Šæ”¾åŒæ­¥çŠ¶æ€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">releaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryReleaseShared(arg)) {
        doReleaseShared();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * Returns the first (longest-waiting) thread in the queue, or
 * {<span class="hljs-doctag">@code</span> null} if no threads are currently queued.
 *
 * &lt;p&gt;In this implementation, this operation normally returns in
 * constant time, but may iterate upon contention if other threads are
 * concurrently modifying the queue.
 * è·å–ç­‰å¾…åœ¨åŒæ­¥é˜Ÿåˆ—ä¸Šçš„çº¿ç¨‹é›†åˆ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getFirstQueuedThread</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// handle only fast path, else relay</span>
    <span class="hljs-keyword">return</span> (head == tail) ? <span class="hljs-literal">null</span> : fullGetFirstQueuedThread();
}
</code></pre>
<p>AQS æä¾›çš„æ¨¡æ¿æ–¹æ³•å¯ä»¥åˆ†ä¸º3ç±»ï¼š</p>
<ol>
<li>ç‹¬å å¼è·å–ä¸é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼›</li>
<li>å…±äº«å¼è·å–ä¸é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼›</li>
<li>æŸ¥è¯¢åŒæ­¥é˜Ÿåˆ—ä¸­ç­‰å¾…çº¿ç¨‹æƒ…å†µï¼›</li>
</ol>
<p>æºç ä¸­æœ‰ä¸€ä¸ªä¾‹å­å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£å¦‚ä½•ä½¿ç”¨ AQS å®ç°è‡ªå·±çš„åŒæ­¥é”ï¼Œè¿™ä¸ªä¾‹å­æ˜¯ä¸€ä¸ªä¸å¯é‡å…¥äº’æ–¥é”ç±»ï¼Œç”¨ 0 è¡¨ç¤ºè§£é”çŠ¶æ€ï¼Œ1 è¡¨ç¤ºè¡¨ç¤ºé”å®šçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Mutex</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable {

    <span class="hljs-comment">// Our internal helper class</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-comment">// Reports whether in locked state</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">1</span>;
        }

        <span class="hljs-comment">// Acquires the lock if state is zero</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-keyword">assert</span> acquires == <span class="hljs-number">1</span>; <span class="hljs-comment">// Otherwise unused</span>
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
                setExclusiveOwnerThread(Thread.currentThread());
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// Releases the lock by setting state to zero</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
            <span class="hljs-keyword">assert</span> releases == <span class="hljs-number">1</span>; <span class="hljs-comment">// Otherwise unused</span>
            <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            setState(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-comment">// Provides a Condition</span>
        Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionObject</span>();
        }

        <span class="hljs-comment">// Deserializes properly</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream s)</span>
                <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
            s.defaultReadObject();
            setState(<span class="hljs-number">0</span>); <span class="hljs-comment">// reset to unlocked state</span>
        }
    }

    <span class="hljs-comment">// The sync object does all the hard work. We just forward to it.</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> <span class="hljs-variable">sync</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        sync.acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.tryAcquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.newCondition();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.isHeldExclusively();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasQueuedThreads</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.hasQueuedThreads();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        sync.acquireInterruptibly(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span>
            <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">return</span> sync.tryAcquireNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));
    }

}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MutexDemo</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Mutex</span> <span class="hljs-variable">mutex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mutex</span>();

    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increase</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10000</span>; j++) {
            count++; <span class="hljs-comment">//count++ä¸å…·å¤‡åŸå­æ€§</span>
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            mutex.lock();
            <span class="hljs-keyword">try</span> {
                increase();
            } <span class="hljs-keyword">finally</span> {
                mutex.unlock();
            }

        });
        thread1.start();


        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            mutex.lock();
            <span class="hljs-keyword">try</span> {
                increase();
            } <span class="hljs-keyword">finally</span> {
                mutex.unlock();
            }

        });
        thread2.start();

        <span class="hljs-keyword">try</span> {
            thread1.join();
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }

        <span class="hljs-keyword">try</span> {
            thread2.join();
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }

        System.out.println(<span class="hljs-string">"the count isï¼š "</span> + count);
    }

}
</code></pre>
<p>æ‰“å°ç»“æœä¸ºï¼š</p>
<pre><code class="hljs language-java" lang="java">the count isï¼š <span class="hljs-number">20000</span>
</code></pre>
<p>ç”±äº count++ ä¸å…·å¤‡åŸå­æ€§ï¼Œå®ƒæ˜¯å…ˆæŠŠ count åŠ  1 ç„¶åå†å†™å…¥æ–°çš„ count å€¼ã€‚å¦‚æœä¸æ·»åŠ é”ï¼Œæ‰“å°å‡ºæ¥çš„å€¼å¾ˆå¤§å¯èƒ½å°äº20000ã€‚</p>
<p>ä»è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨AQSå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°åŒæ­¥ç»„ä»¶ã€‚</p>
<h4 data-id="heading-3">ReentrantLock çš„ä¼˜åŠ¿</h4>
<p><code>ReentrantLock</code> æä¾›äº†æ¯” <code>synchronized</code> å…³é”®å­—æ›´çµæ´»çš„é”å®šæœºåˆ¶ï¼Œå¯ä»¥åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼˜å…ˆäº <code>synchronized</code> ä½¿ç”¨ï¼š</p>
<ol>
<li><strong>éœ€è¦æ˜¾å¼çš„é”å®šå’Œè§£é”</strong>ï¼š <code>ReentrantLock</code> å…è®¸ä½ æ˜¾å¼åœ°è·å–å’Œé‡Šæ”¾é”ï¼Œæä¾›äº†æ¯” <code>synchronized</code> æ›´ç»†ç²’åº¦çš„æ§åˆ¶ã€‚<strong>ä½ å¯ä»¥åœ¨ä¸åŒçš„æ–¹æ³•æˆ–ä»£ç å—ä¸­è·å–å’Œé‡Šæ”¾åŒä¸€ä¸ªé”ï¼Œè€Œä¸åƒ <code>synchronized</code> å¿…é¡»åœ¨åŒä¸€ä¸ªä»£ç å—ä¸­é‡Šæ”¾</strong>ã€‚</li>
<li><strong>éœ€è¦å°è¯•é”å®š</strong>ï¼š ä½¿ç”¨ <code>ReentrantLock</code> æ—¶å¯ä»¥è°ƒç”¨ <code>tryLock()</code> æ–¹æ³•ï¼Œå°è¯•è·å–é”è€Œä¸ä¼šä¸€ç›´é˜»å¡ã€‚å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œ<code>tryLock()</code> å¯ä»¥è¿”å› <code>false</code>ï¼Œå…è®¸ä½ æ ¹æ®æƒ…å†µé‡‡å–å…¶ä»–æ“ä½œã€‚</li>
<li><strong>éœ€è¦å¯ä¸­æ–­çš„é”</strong>ï¼š <code>ReentrantLock</code> æä¾›äº† <code>lockInterruptibly()</code> æ–¹æ³•ï¼Œä½¿å¾—çº¿ç¨‹å¯ä»¥åœ¨ç­‰å¾…è·å–é”æ—¶å“åº”ä¸­æ–­è¯·æ±‚ã€‚<code>synchronized</code> åˆ™æ— æ³•å“åº”ä¸­æ–­ï¼Œçº¿ç¨‹åªèƒ½ä¸€ç›´é˜»å¡ï¼Œç›´åˆ°è·å–é”ã€‚</li>
<li><strong>éœ€è¦å…¬å¹³é”</strong>ï¼š <code>ReentrantLock</code> æä¾›äº†å…¬å¹³é”çš„æœºåˆ¶ï¼ˆé€šè¿‡æ„é€ æ–¹æ³• <code>new ReentrantLock(true)</code>ï¼‰ï¼Œè¿™æ„å‘³ç€é”å°†æŒ‰ç…§çº¿ç¨‹è¯·æ±‚çš„é¡ºåºè¿›è¡Œåˆ†é…ï¼Œè€Œ <code>synchronized</code> æ˜¯éå…¬å¹³çš„ï¼Œçº¿ç¨‹è·å–é”çš„é¡ºåºå¯èƒ½æ— æ³•é¢„æµ‹ã€‚</li>
<li><strong>éœ€è¦å¤šæ¡ä»¶ç­‰å¾…</strong>ï¼š <code>ReentrantLock</code> æ”¯æŒå¤šä¸ª <code>Condition</code> å¯¹è±¡ï¼Œå…è®¸çº¿ç¨‹åŸºäºä¸åŒçš„æ¡ä»¶æ¥ç­‰å¾…å’Œé€šçŸ¥ï¼Œå¢å¼ºäº†çµæ´»æ€§ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>synchronized</code> åªèƒ½ä½¿ç”¨å•ä¸ª <code>wait()</code> å’Œ <code>notify()</code> æœºåˆ¶æ¥è¿›è¡Œçº¿ç¨‹é—´çš„é€šä¿¡ã€‚</li>
<li><strong>æ€§èƒ½éœ€æ±‚</strong>ï¼š åœ¨æŸäº›é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œ<code>ReentrantLock</code> çš„æ€§èƒ½å¯èƒ½ä¼šä¼˜äº <code>synchronized</code>ã€‚å®ƒçš„å®ç°æ›´åŠ ä¼˜åŒ–ï¼Œå‡å°‘äº†é”äº‰ç”¨çš„å¼€é”€ã€‚</li>
</ol>
<p>æ€»çš„æ¥è¯´ï¼Œ<code>ReentrantLock</code> é€‚ç”¨äºéœ€è¦æ›´çµæ´»é”å®šæœºåˆ¶ã€æ›´å¤šæ§åˆ¶æƒæˆ–è€…æ›´å¤æ‚å¹¶å‘æ§åˆ¶åœºæ™¯çš„æƒ…å†µã€‚å¯¹äºç®€å•çš„åŒæ­¥éœ€æ±‚ï¼Œ<code>synchronized</code> å…³é”®å­—ä¾ç„¶æ˜¯é¦–é€‰ï¼Œå› ä¸ºå®ƒæ›´ç®€æ´ï¼Œä¸”åœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸­æ€§èƒ½è¡¨ç°è‰¯å¥½ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä»»åŠ¡ç³»ç»Ÿï¼Œå…¶ä¸­å¤šä¸ªçº¿ç¨‹å°è¯•æ‰§è¡Œä¸€é¡¹å…³é”®ä»»åŠ¡ã€‚æˆ‘ä»¬å¸Œæœ›ï¼š</p>
<ol>
<li>çº¿ç¨‹åœ¨ç­‰å¾…è·å–é”æ—¶æœ‰ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´æœªèƒ½è·å–é”ï¼Œåˆ™æ‰§è¡Œå…¶ä»–æ“ä½œæˆ–é€€å‡ºã€‚</li>
<li>çº¿ç¨‹åœ¨ç­‰å¾…é”æ—¶å¯ä»¥è¢«ä¸­æ–­ï¼Œè€Œä¸å¿…ä¸€ç›´ç­‰å¾…ã€‚</li>
</ol>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>synchronized</code> æ— æ³•æä¾›è¿™æ ·çš„çµæ´»æ€§ï¼Œä½† <code>ReentrantLock</code> å¯ä»¥é€šè¿‡ <code>tryLock()</code> å’Œ <code>lockInterruptibly()</code> æ–¹æ³•æ¥å®ç°ã€‚</p>
<p>çœ‹å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼šä½¿ç”¨ <code>ReentrantLock</code> å®ç°è¶…æ—¶å’Œå“åº”ä¸­æ–­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CriticalTask</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

    <span class="hljs-comment">// ä»»åŠ¡æ–¹æ³•ï¼Œå°è¯•åœ¨è¶…æ—¶å†…è·å–é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performTask</span><span class="hljs-params">(String threadName)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•åœ¨ 2 ç§’å†…è·å–é”ï¼Œè¶…æ—¶åˆ™è¿”å› false</span>
            <span class="hljs-keyword">if</span> (lock.tryLock(<span class="hljs-number">2</span>, TimeUnit.SECONDS)) {
                <span class="hljs-keyword">try</span> {
                    System.out.println(threadName + <span class="hljs-string">" æˆåŠŸè·å–é”ï¼Œæ­£åœ¨æ‰§è¡Œä»»åŠ¡..."</span>);
                    <span class="hljs-comment">// æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ</span>
                    Thread.sleep(<span class="hljs-number">1000</span>);
                    System.out.println(threadName + <span class="hljs-string">" ä»»åŠ¡å®Œæˆ"</span>);
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock(); <span class="hljs-comment">// é‡Šæ”¾é”</span>
                    System.out.println(threadName + <span class="hljs-string">" å·²é‡Šæ”¾é”"</span>);
                }
            } <span class="hljs-keyword">else</span> {
                System.out.println(threadName + <span class="hljs-string">" è·å–é”è¶…æ—¶ï¼Œæ— æ³•æ‰§è¡Œä»»åŠ¡"</span>);
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            System.out.println(threadName + <span class="hljs-string">" è¢«ä¸­æ–­ï¼Œä»»åŠ¡ä¸­æ­¢"</span>);
        }
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">CriticalTask</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CriticalTask</span>();

        <span class="hljs-comment">// åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¨¡æ‹Ÿå¹¶å‘ä»»åŠ¡æ‰§è¡Œ</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; task.performTask(<span class="hljs-string">"çº¿ç¨‹1"</span>));
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; task.performTask(<span class="hljs-string">"çº¿ç¨‹2"</span>));

        t1.start();
        t2.start();

        <span class="hljs-comment">// ä¸­æ–­çº¿ç¨‹t1ä»¥æ¨¡æ‹Ÿä¸­æ–­æƒ…å†µ</span>
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">500</span>);
            t1.interrupt(); <span class="hljs-comment">// ä¸­æ–­t1</span>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>è¿™é‡Œ tryLock(2, TimeUnit.SECONDS) çº¿ç¨‹å°è¯•è·å–é”ï¼Œä½†å¦‚æœåœ¨ 2 ç§’å†…æœªèƒ½è·å–é”ï¼Œåˆ™ä¼šè¿”å› falseï¼Œä»è€Œé¿å…çº¿ç¨‹æ°¸ä¹…ç­‰å¾…é”çš„æƒ…å†µã€‚synchronized æ— æ³•å®ç°è¿™ç§è¶…æ—¶æœºåˆ¶ã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨ä»£ç ä¸­æ¨¡æ‹Ÿäº†çº¿ç¨‹ t1 è¢«ä¸­æ–­çš„æƒ…å†µã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…é”æ—¶è¢«ä¸­æ–­ï¼ŒReentrantLock çš„ lockInterruptibly() æ–¹æ³•å¯ä»¥æ•è· InterruptedExceptionï¼Œä»è€Œä¸­æ­¢æ“ä½œå¹¶åŠæ—¶å“åº”ã€‚synchronized æ— æ³•å“åº”ä¸­æ–­ï¼Œçº¿ç¨‹åªèƒ½ä¸€ç›´é˜»å¡ç›´åˆ°é”è¢«é‡Šæ”¾ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®¹å™¨è¿ç»´ï¼šä¸åŒå¹³å°ä¸‹ Docker/Podman ç½‘é—®é¢˜é…ç½®é€ŸæŸ¥]]></title>    <link>https://juejin.cn/post/7598472744480686099</link>    <guid>https://juejin.cn/post/7598472744480686099</guid>    <pubDate>2026-01-24T08:02:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598472744480686099" data-draft-id="7598480413803446314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®¹å™¨è¿ç»´ï¼šä¸åŒå¹³å°ä¸‹ Docker/Podman ç½‘é—®é¢˜é…ç½®é€ŸæŸ¥"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-24T08:02:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«è½¦å¼ä½"/> <meta itemprop="url" content="https://juejin.cn/user/1345457960792808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®¹å™¨è¿ç»´ï¼šä¸åŒå¹³å°ä¸‹ Docker/Podman ç½‘é—®é¢˜é…ç½®é€ŸæŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1345457960792808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«è½¦å¼ä½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:02:45.000Z" title="Sat Jan 24 2026 08:02:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å‰è¨€ä¸æ ¸å¿ƒæ¦‚å¿µ</h2>
<p>åœ¨ç‰¹å®šçš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œé…ç½® Registry Mirrorï¼ˆé•œåƒåŠ é€Ÿï¼‰ä¸ HTTP/HTTPS Proxyï¼ˆç½‘ç»œä»£ç†ï¼‰æ˜¯ä¿éšœå®¹å™¨æœåŠ¡ç¨³å®šè¿è¡Œçš„åŸºç¡€å·¥ä½œã€‚æœ¬æ‰‹å†Œæ—¨åœ¨æä¾›ä¸€å¥—æ ‡å‡†åŒ–çš„æ“ä½œæµç¨‹ï¼Œè¦†ç›–ä¸»æµæ“ä½œç³»ç»ŸåŠç‰¹æ®Šç½‘ç»œè®¾å¤‡ã€‚</p>
<h3 data-id="heading-1">1.1 èŒƒå›´ä¸åˆ†ç»„åŸåˆ™</h3>
<p>æˆ‘ä»¬å°†é…ç½®åœºæ™¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li><strong>é•œåƒåŠ é€Ÿ (Registry Mirror)</strong>ï¼šä»…é’ˆå¯¹ <code>docker pull</code> æ“ä½œï¼Œä½œç”¨äº Daemon å±‚é¢ï¼Œé€šå¸¸ä¸æ¶‰åŠé‰´æƒã€‚</li>
<li><strong>é€šç”¨ä»£ç† (HTTP Proxy)</strong>ï¼šå½±å“ <code>docker build</code>ã€<code>docker push</code> åŠå®¹å™¨è¿è¡Œæ—¶çš„å¤–ç½‘è®¿é—®ã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 å®‰å…¨ä¸åˆè§„æç¤º</h3>
<blockquote>
<p><strong>âš ï¸ è­¦å‘Š</strong></p>
<ul>
<li>
<p><strong>è¯ä¹¦ä¿¡ä»»</strong>ï¼šé…ç½®ç§æœ‰æºæˆ–å…¬å¸ä»£ç†æ—¶ï¼Œå¿…é¡»ç¡®ä¿ CA è¯ä¹¦å·²å¯¼å…¥å®¿ä¸»æœºåŠ Docker ä¿¡ä»»åŒºã€‚</p>
</li>
<li>
<p><strong>å‡­è¯æ³„éœ²</strong>ï¼šä¸¥ç¦å°†åŒ…å«è´¦å·å¯†ç çš„ä»£ç† URLï¼ˆå¦‚ <code>user:pass@proxy</code>ï¼‰æäº¤åˆ°å…¬å…±ä»£ç ä»“åº“ã€‚</p>
</li>
<li>
<p><strong>NO_PROXY</strong>ï¼šåŠ¡å¿…æ’é™¤ <code>localhost</code>ã€<code>127.0.0.1</code> åŠå†…éƒ¨åŸŸåï¼Œé˜²æ­¢å†…éƒ¨æµé‡è¯¯èµ°ä»£ç†å¯¼è‡´æœåŠ¡ä¸å¯è¾¾ã€‚</p>
</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-3">2. Linux (Systemd) å®˜æ–¹ Docker Engine</h2>
<blockquote>
<p><strong>é€‚ç”¨èŒƒå›´</strong>ï¼šUbuntu, Debian, CentOS, Fedora, RHEL, Arch Linux ç­‰æ ‡å‡†ç”Ÿäº§ç¯å¢ƒã€‚</p>
</blockquote>
<h3 data-id="heading-4">2.1 é…ç½® Registry Mirror (daemon.json)</h3>
<p>é•œåƒæºé…ç½®ä½äº <code>/etc/docker/daemon.json</code>ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·æ–°å»ºã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"registry-mirrors"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"https://mirror.example.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.company-mirror.com"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"insecure-registries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"debug"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>

</code></pre>
<h3 data-id="heading-5">2.2 é…ç½® HTTP/HTTPS ä»£ç† (Systemd Override)</h3>
<p>ä¸ºäº†è®© Docker Daemon èƒ½å¤Ÿé€šè¿‡ä»£ç†æ‹‰å–é•œåƒæˆ–æ‰§è¡Œæ„å»ºï¼Œ<strong>åˆ‡å‹¿ç›´æ¥ä¿®æ”¹</strong> <code>/lib/systemd/system/docker.service</code>ï¼Œåº”ä½¿ç”¨ Systemd Drop-in æœºåˆ¶ã€‚</p>
<ol>
<li><strong>åˆ›å»ºé…ç½®ç›®å½•</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> -p /etc/systemd/system/docker.service.d

</code></pre>
<ol start="2">
<li><strong>åˆ›å»ºä»£ç†é…ç½®æ–‡ä»¶</strong>
ç¼–è¾‘ <code>/etc/systemd/system/docker.service.d/proxy.conf</code>ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Service]</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTP_PROXY=http://192.168.1.100:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTPS_PROXY=http://192.168.1.100:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"NO_PROXY=localhost,127.0.0.1,docker-registry.somecorporation.com"</span>

</code></pre>
<ol start="3">
<li><strong>é‡è½½å¹¶é‡å¯</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl daemon-reload &amp;&amp; sudo systemctl restart docker

</code></pre>
<ol start="4">
<li><strong>éªŒè¯é…ç½®</strong>
è¿è¡Œ <code>docker info</code>ï¼Œæ£€æŸ¥è¾“å‡ºä¸­çš„ "Registry Mirrors" å’Œ "HTTP Proxy" å­—æ®µã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-6">3. Podman é…ç½®å·®å¼‚</h2>
<p>Podman é‡‡ç”¨æ— å®ˆæŠ¤è¿›ç¨‹ï¼ˆDaemonlessï¼‰æ¶æ„ï¼Œå…¶é…ç½®é€»è¾‘ä¸ Docker æœ‰æ˜¾è‘—ä¸åŒã€‚</p>
<h3 data-id="heading-7">3.1 Docker vs Podman é…ç½®å¯¹æ¯”</h3>






























<table><thead><tr><th>é…ç½®é¡¹</th><th>Docker</th><th>Podman</th></tr></thead><tbody><tr><td><strong>é…ç½®æ–‡ä»¶æ ¼å¼</strong></td><td>JSON (<code>daemon.json</code>)</td><td>TOML (<code>registries.conf</code>)</td></tr><tr><td><strong>ç³»ç»Ÿçº§è·¯å¾„</strong></td><td><code>/etc/docker/daemon.json</code></td><td><code>/etc/containers/registries.conf</code></td></tr><tr><td><strong>ç”¨æˆ·çº§è·¯å¾„</strong></td><td>ä¸æ”¯æŒ (ä¾èµ– Daemon)</td><td><code>~/.config/containers/registries.conf</code></td></tr><tr><td><strong>ä»£ç†ç”Ÿæ•ˆæ–¹å¼</strong></td><td>Systemd Service æ³¨å…¥</td><td>ç›´æ¥è¯»å– Shell ç¯å¢ƒå˜é‡ (CLI)</td></tr></tbody></table>
<h3 data-id="heading-8">3.2 Podman é•œåƒæºé…ç½®</h3>
<p>ç¼–è¾‘ <code>registries.conf</code>ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># é…ç½® docker.io çš„é•œåƒåŠ é€Ÿ</span>
<span class="hljs-section">[[registry]]</span>
<span class="hljs-attr">prefix</span> = <span class="hljs-string">"docker.io"</span>
<span class="hljs-attr">location</span> = <span class="hljs-string">"docker.io"</span>

<span class="hljs-section">[[registry.mirror]]</span>
<span class="hljs-attr">location</span> = <span class="hljs-string">"mirror.example.com"</span>

<span class="hljs-section">[[registry.mirror]]</span>
<span class="hljs-attr">location</span> = <span class="hljs-string">"docker.mirrors.ustc.edu.cn"</span>

<span class="hljs-comment"># å…è®¸çŸ­åç§°æœç´¢ (å¦‚ podman pull alpine)</span>
<span class="hljs-attr">unqualified-search-registries</span> = [<span class="hljs-string">"docker.io"</span>]

</code></pre>
<hr/>
<h2 data-id="heading-9">4. Windows (Docker Desktop) &amp; WSL2</h2>
<h3 data-id="heading-10">4.1 Docker Desktop (GUI)</h3>
<p>Docker Desktop å±è”½äº†åº•å±‚å¤æ‚æ€§ï¼Œæ¨èä¼˜å…ˆé€šè¿‡ GUI é…ç½®ã€‚</p>
<ol>
<li><strong>è®¾ç½®ä»£ç† (Proxy)</strong>ï¼š</li>
</ol>
<ul>
<li>è¿›å…¥ <strong>Settings</strong> -&gt; <strong>Resources</strong> -&gt; <strong>Proxies</strong>ã€‚</li>
<li>å¼€å¯ "Manual proxy configuration"ã€‚</li>
<li>å¡«å…¥ <code>http://127.0.0.1:7890</code> (å‡è®¾ä½¿ç”¨æœ¬æœº Windows ä»£ç†è½¯ä»¶)ã€‚</li>
</ul>
<ol start="2">
<li><strong>è®¾ç½®é•œåƒ (Docker Engine)</strong>ï¼š</li>
</ol>
<ul>
<li>è¿›å…¥ <strong>Settings</strong> -&gt; <strong>Docker Engine</strong>ã€‚</li>
<li>åœ¨ JSON ç¼–è¾‘å™¨ä¸­æ·»åŠ  <code>"registry-mirrors"</code> å­—æ®µï¼Œå†…å®¹åŒ Linux ç»„é…ç½®ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå¦‚æœåœ¨ WSL2 å‘½ä»¤è¡Œç›´æ¥ä½¿ç”¨ <code>docker</code> å‘½ä»¤ï¼ˆè¿æ¥ Desktop åç«¯ï¼‰ï¼Œä¸Šè¿° GUI é…ç½®ä¼šè‡ªåŠ¨ç”Ÿæ•ˆã€‚</p>
</blockquote>
<h3 data-id="heading-11">4.2 WSL2 åŸç”Ÿå‘è¡Œç‰ˆ (é Desktop)</h3>
<p>å¦‚æœä½ åœ¨ WSL2 (Ubuntu/Debian) å†…ç‹¬ç«‹å®‰è£…äº† Docker Engineï¼Œéœ€æ³¨æ„ç½‘ç»œäº’é€šé—®é¢˜ã€‚</p>
<ul>
<li><strong>ç½‘ç»œä»£ç†æŒ‡å‘</strong>ï¼šWSL2 æ— æ³•ç›´æ¥é€šè¿‡ <code>127.0.0.1</code> è®¿é—® Windows ä¸Šçš„ä»£ç†ã€‚å¿…é¡»ä½¿ç”¨ <code>host.docker.internal</code>ã€‚</li>
<li><strong>Systemd æ”¯æŒ</strong>ï¼šç¡®ä¿ <code>/etc/wsl.conf</code> ä¸­å·²å¯ç”¨ <code>systemd=true</code>ã€‚</li>
</ul>
<p>é…ç½®ç¤ºä¾‹ (<code>/etc/systemd/system/docker.service.d/proxy.conf</code>)ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Service]</span>
<span class="hljs-comment"># æ³¨æ„ï¼šhost.docker.internal éœ€è¦ WSL2 ç‰ˆæœ¬æ”¯æŒæˆ–æ‰‹åŠ¨é…ç½® hosts</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTP_PROXY=http://host.docker.internal:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTPS_PROXY=http://host.docker.internal:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"NO_PROXY=localhost,127.0.0.1,*.internal,172.16.0.0/12"</span>

</code></pre>
<hr/>
<h2 data-id="heading-12">5. ç‰¹æ®Šç¯å¢ƒï¼šNAS ä¸ è·¯ç”±å™¨</h2>
<h3 data-id="heading-13">5.1 Synology ç¾¤æ™– (DSM)</h3>
<p>ç¾¤æ™– DSM å¯¹ Docker è·¯å¾„è¿›è¡Œäº†å®šåˆ¶ï¼Œä¸”å‡çº§å¯èƒ½é‡ç½®é…ç½®ã€‚</p>
<ul>
<li>
<p><strong>å›¾å½¢ç•Œé¢é…ç½® (æ¨è)</strong>ï¼š</p>
</li>
<li>
<p>æ‰“å¼€ <strong>Container Manager</strong> (DSM 7.2+) æˆ– Docker å¥—ä»¶ã€‚</p>
</li>
<li>
<p><strong>Registry</strong>ï¼šåœ¨è®¾ç½®ä¸­é€‰ä¸­ Docker Hub -&gt; Editï¼Œå¯ç”¨ "Registry Mirrors" å¹¶å¡«å…¥ URLã€‚</p>
</li>
<li>
<p><strong>Proxy</strong>ï¼šé€šå¸¸éœ€åœ¨æ§åˆ¶é¢æ¿çš„ç½‘ç»œè®¾ç½®ä¸­å…¨å±€é…ç½®ã€‚</p>
</li>
<li>
<p><strong>é…ç½®æ–‡ä»¶è·¯å¾„ (SSH)</strong>ï¼š</p>
</li>
<li>
<p>æ ‡å‡†è·¯å¾„ (DSM 7.2+)ï¼š<code>/var/packages/ContainerManager/etc/dockerd.json</code></p>
</li>
<li>
<p>æ—§ç‰ˆè·¯å¾„ï¼š<code>/var/packages/Docker/etc/dockerd.json</code></p>
</li>
<li>
<p>*ä¿®æ”¹åéœ€é‡å¯å¥—ä»¶ï¼š<code>synopkg restart ContainerManager*</code></p>
</li>
</ul>
<h3 data-id="heading-14">5.2 OpenWrt</h3>
<p>OpenWrt ä½¿ç”¨ <code>procd</code> ç®¡ç†æœåŠ¡ã€‚éœ€ä¿®æ”¹ <code>/etc/init.d/dockerd</code> è„šæœ¬ã€‚</p>
<p><strong>æ³¨å…¥ä»£ç†ç¯å¢ƒå˜é‡ï¼š</strong>
åœ¨ <code>start_service()</code> å‡½æ•°ä¸­æ·»åŠ  <code>procd_set_param env</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-function"><span class="hljs-title">start_service</span></span>() {
    procd_open_instance
    procd_set_param <span class="hljs-built_in">command</span> /usr/bin/dockerd
    
    <span class="hljs-comment"># æ·»åŠ ä»¥ä¸‹è¡Œé…ç½®ä»£ç†</span>
    procd_set_param <span class="hljs-built_in">env</span> HTTP_PROXY=http://192.168.1.5:7890
    procd_set_param <span class="hljs-built_in">env</span> HTTPS_PROXY=http://192.168.1.5:7890
    procd_set_param <span class="hljs-built_in">env</span> NO_PROXY=localhost,127.0.0.1
    
    procd_close_instance
}

</code></pre>
<p>*é…ç½®å®Œæˆåé‡å¯æœåŠ¡ï¼š<code>/etc/init.d/dockerd restart*</code></p>
<hr/>
<h2 data-id="heading-15">6. éªŒè¯è„šæœ¬ä¸æ•…éšœæ’æŸ¥</h2>
<h3 data-id="heading-16">6.1 è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬ (Ubuntu/Linux)</h3>
<p>ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ£€æµ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt; æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€..."</span>
systemctl is-active docker || { <span class="hljs-built_in">echo</span> <span class="hljs-string">"Docker æœªè¿è¡Œ"</span>; <span class="hljs-built_in">exit</span> 1; }

<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt; æ£€æŸ¥ Proxy ç¯å¢ƒå˜é‡..."</span>
<span class="hljs-comment"># è·å– dockerd è¿›ç¨‹çš„ç¯å¢ƒå˜é‡</span>
PID=$(pgrep -n dockerd)
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$PID</span>"</span> ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ— æ³•æ‰¾åˆ° dockerd è¿›ç¨‹"</span>; <span class="hljs-built_in">exit</span> 1; <span class="hljs-keyword">fi</span>
sudo <span class="hljs-built_in">cat</span> /proc/<span class="hljs-variable">$PID</span>/environ | <span class="hljs-built_in">tr</span> <span class="hljs-string">'\0'</span> <span class="hljs-string">'\n'</span> | grep -E <span class="hljs-string">'HTTP_PROXY|HTTPS_PROXY|NO_PROXY'</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt; æ£€æŸ¥ Registry Mirrors..."</span>
docker info --format <span class="hljs-string">'{{json .RegistryConfig.Mirrors}}'</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt; ç½‘ç»œè¿é€šæ€§æµ‹è¯•..."</span>
docker pull hello-world

</code></pre>
<h3 data-id="heading-17">6.2 å¸¸è§æ•…éšœæ’æŸ¥</h3>
<ol>
<li><strong>JSON è¯­æ³•é”™è¯¯</strong>ï¼š</li>
</ol>
<ul>
<li>ç°è±¡ï¼šDocker æ— æ³•å¯åŠ¨ã€‚</li>
<li>è§£å†³ï¼šä½¿ç”¨ <code>jq . /etc/docker/daemon.json</code> éªŒè¯è¯­æ³•ï¼Œæ³¨æ„æœ«å°¾é€—å·ã€‚</li>
</ul>
<ol start="2">
<li><strong>ä»£ç†ä¸å¯è¾¾</strong>ï¼š</li>
</ol>
<ul>
<li>ç°è±¡ï¼šPull è¶…æ—¶ã€‚</li>
<li>è§£å†³ï¼šç¡®ä¿å®¿ä¸»æœºèƒ½ <code>ping</code> é€šä»£ç† IPã€‚æ£€æŸ¥é˜²ç«å¢™ï¼ˆufw/iptablesï¼‰æ˜¯å¦æ‹¦æˆªã€‚</li>
</ul>
<ol start="3">
<li><strong>DNS è§£æå¤±è´¥</strong>ï¼š</li>
</ol>
<ul>
<li>ç°è±¡ï¼šæŠ¥é”™ <code>lookup ... no such host</code>ã€‚</li>
<li>è§£å†³ï¼šæ£€æŸ¥ <code>/etc/resolv.conf</code> æˆ–åœ¨ <code>daemon.json</code> ä¸­æ·»åŠ  <code>"dns": ["8.8.8.8"]</code>ã€‚</li>
</ul>
<h3 data-id="heading-18">6.3 é…ç½®æ–‡ä»¶è·¯å¾„é€ŸæŸ¥è¡¨</h3>





























<table><thead><tr><th>æ–‡ä»¶ç”¨é€”</th><th>å…¸å‹è·¯å¾„</th></tr></thead><tbody><tr><td><strong>Docker é•œåƒé…ç½®</strong></td><td><code>/etc/docker/daemon.json</code></td></tr><tr><td><strong>Docker ä»£ç†é…ç½®</strong></td><td><code>/etc/systemd/system/docker.service.d/proxy.conf</code></td></tr><tr><td><strong>Podman ç³»ç»Ÿé…ç½®</strong></td><td><code>/etc/containers/registries.conf</code></td></tr><tr><td><strong>Podman ç”¨æˆ·é…ç½®</strong></td><td><code>~/.config/containers/registries.conf</code></td></tr><tr><td><strong>TLS è¯ä¹¦ç›®å½•</strong></td><td><code>/etc/docker/certs.d/&lt;domain&gt;/ca.crt</code></td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GitHub Issues é›†æˆ]]></title>    <link>https://juejin.cn/post/7598532592455630875</link>    <guid>https://juejin.cn/post/7598532592455630875</guid>    <pubDate>2026-01-24T07:55:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592455630875" data-draft-id="7598827845964988442" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GitHub Issues é›†æˆ"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-24T07:55:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="newbe36524"/> <meta itemprop="url" content="https://juejin.cn/user/2682464104098654"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GitHub Issues é›†æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464104098654/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    newbe36524
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:55:22.000Z" title="Sat Jan 24 2026 07:55:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶æ„å»º GitHub Issues é›†æˆï¼šHagiCode çš„å‰ç«¯ç›´è¿å®è·µ</h2>
<blockquote>
<p>æœ¬æ–‡è®°å½•äº†åœ¨ HagiCode å¹³å°ä¸­é›†æˆ GitHub Issues çš„å…¨è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•é€šè¿‡"å‰ç«¯ç›´è¿ + åç«¯æœ€å°åŒ–"çš„æ¶æ„ï¼Œåœ¨ä¿æŒåç«¯è½»é‡çš„åŒæ—¶ï¼Œå®ç°å®‰å…¨çš„ OAuth è®¤è¯ä¸é«˜æ•ˆçš„ Issues åŒæ­¥ã€‚</p>
</blockquote>
<h3 data-id="heading-1">èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆè¦é›†æˆ GitHubï¼Ÿ</h3>
<p>HagiCode ä½œä¸ºä¸€ä¸ª AI è¾…åŠ©å¼€å‘å¹³å°ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºè¿æ¥æƒ³æ³•ä¸å®ç°ã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å‘ç°ç”¨æˆ·åœ¨ HagiCode ä¸­å®Œæˆäº† Proposalï¼ˆææ¡ˆï¼‰åï¼Œå¾€å¾€éœ€è¦æ‰‹åŠ¨å°†å†…å®¹å¤åˆ¶åˆ° GitHub Issues ä¸­è¿›è¡Œé¡¹ç›®è·Ÿè¸ªã€‚</p>
<p>è¿™å¸¦æ¥äº†å‡ ä¸ªæ˜æ˜¾çš„ç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å·¥ä½œæµå‰²è£‚</strong>ï¼šç”¨æˆ·éœ€è¦åœ¨ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œä½“éªŒä¸ä»…ä¸æµç•…ï¼Œè¿˜å®¹æ˜“å¯¼è‡´å…³é”®ä¿¡æ¯åœ¨å¤åˆ¶ç²˜è´´çš„è¿‡ç¨‹ä¸­ä¸¢å¤±ã€‚</li>
<li><strong>åä½œä¸ä¾¿</strong>ï¼šå›¢é˜Ÿå…¶ä»–æˆå‘˜ä¹ æƒ¯åœ¨ GitHub ä¸ŠæŸ¥çœ‹ä»»åŠ¡ï¼Œæ— æ³•ç›´æ¥çœ‹åˆ° HagiCode ä¸­çš„ææ¡ˆè¿›å±•ã€‚</li>
<li><strong>é‡å¤åŠ³åŠ¨</strong>ï¼šæ¯å½“ææ¡ˆæ›´æ–°ï¼Œå°±è¦äººå·¥å» GitHub æ›´æ–°å¯¹åº”çš„ Issueï¼Œå¢åŠ ä¸å¿…è¦çš„ç»´æŠ¤æˆæœ¬ã€‚</li>
</ol>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†³å®šå¼•å…¥ <strong>GitHub Issues Integration</strong> åŠŸèƒ½ï¼Œæ‰“é€š HagiCode ä¼šè¯ä¸ GitHub ä»“åº“çš„è¿æ¥ï¼Œå®ç°"ä¸€é”®åŒæ­¥"ã€‚</p>
<h3 data-id="heading-2">å…³äº HagiCode</h3>
<blockquote>
<p>å˜¿ï¼Œä»‹ç»ä¸€ä¸‹æˆ‘ä»¬æ­£åœ¨åšçš„ä¸œè¥¿</p>
</blockquote>
<p>æˆ‘ä»¬æ­£åœ¨å¼€å‘ <strong>HagiCode</strong> â€”â€” ä¸€æ¬¾ AI é©±åŠ¨çš„ä»£ç æ™ºèƒ½åŠ©æ‰‹ï¼Œè®©å¼€å‘ä½“éªŒå˜å¾—æ›´æ™ºèƒ½ã€æ›´ä¾¿æ·ã€æ›´æœ‰è¶£ã€‚</p>
<p><strong>æ™ºèƒ½</strong> â€”â€” AI å…¨ç¨‹è¾…åŠ©ï¼Œä»æƒ³æ³•åˆ°ä»£ç ï¼Œè®©ç¼–ç æ•ˆç‡æå‡æ•°å€ã€‚<strong>ä¾¿æ·</strong> â€”â€” å¤šçº¿ç¨‹å¹¶å‘æ“ä½œï¼Œå……åˆ†åˆ©ç”¨èµ„æºï¼Œå¼€å‘æµç¨‹é¡ºç•…æ— é˜»ã€‚<strong>æœ‰è¶£</strong> â€”â€” æ¸¸æˆåŒ–æœºåˆ¶å’Œæˆå°±ç³»ç»Ÿï¼Œè®©ç¼–ç ä¸å†æ¯ç‡¥ï¼Œå……æ»¡æˆå°±æ„Ÿã€‚</p>
<p>é¡¹ç›®æ­£åœ¨å¿«é€Ÿè¿­ä»£ä¸­ï¼Œå¦‚æœä½ å¯¹æŠ€æœ¯å†™ä½œã€çŸ¥è¯†ç®¡ç†æˆ–è€… AI è¾…åŠ©å¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿æ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHagiCode-org%2Fsite" target="_blank" title="https://github.com/HagiCode-org/site" ref="nofollow noopener noreferrer">GitHub</a> çœ‹çœ‹ï½</p>
<hr/>
<h3 data-id="heading-3">æŠ€æœ¯é€‰å‹ï¼šå‰ç«¯ç›´è¿ vs åç«¯ä»£ç†</h3>
<p>åœ¨è®¾è®¡é›†æˆæ–¹æ¡ˆæ—¶ï¼Œæ‘†åœ¨æˆ‘ä»¬é¢å‰çš„æœ‰ä¸¤æ¡è·¯ï¼šä¼ ç»Ÿçš„"åç«¯ä»£ç†æ¨¡å¼"å’Œæ›´æ¿€è¿›çš„"å‰ç«¯ç›´è¿æ¨¡å¼"ã€‚</p>
<h4 data-id="heading-4">æ–¹æ¡ˆå¯¹æ¯”</h4>
<p>åœ¨ä¼ ç»Ÿçš„<strong>åç«¯ä»£ç†æ¨¡å¼</strong>ä¸­ï¼Œå‰ç«¯æ‰€æœ‰çš„è¯·æ±‚éƒ½è¦å…ˆç»è¿‡æˆ‘ä»¬çš„åç«¯ï¼Œå†ç”±åç«¯å»è°ƒç”¨ GitHub APIã€‚è¿™è™½ç„¶é€»è¾‘é›†ä¸­ï¼Œä½†ç»™åç«¯å¸¦æ¥äº†ä¸å°çš„è´Ÿæ‹…ï¼š</p>
<ol>
<li><strong>åç«¯è‡ƒè‚¿</strong>ï¼šéœ€è¦ç¼–å†™ä¸“é—¨çš„ GitHub API å®¢æˆ·ç«¯å°è£…ï¼Œè¿˜è¦å¤„ç† OAuth çš„å¤æ‚çŠ¶æ€æœºã€‚</li>
<li><strong>Token é£é™©</strong>ï¼šç”¨æˆ·çš„ GitHub Token å¿…é¡»å­˜å‚¨åœ¨åç«¯æ•°æ®åº“ä¸­ï¼Œè™½ç„¶å¯ä»¥åŠ å¯†ï¼Œä½†æ¯•ç«Ÿå¢åŠ äº†å®‰å…¨é£é™©é¢ã€‚</li>
<li><strong>å¼€å‘æˆæœ¬</strong>ï¼šéœ€è¦æ•°æ®åº“è¿ç§»æ¥å­˜å‚¨ Tokenï¼Œè¿˜éœ€è¦ç»´æŠ¤ä¸€å¥—é¢å¤–çš„åŒæ­¥æœåŠ¡ã€‚</li>
</ol>
<p>è€Œ<strong>å‰ç«¯ç›´è¿æ¨¡å¼</strong>åˆ™è¦è½»é‡å¾—å¤šã€‚åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬åªåˆ©ç”¨åç«¯æ¥å¤„ç†æœ€æ•æ„Ÿçš„"å¯†é’¥äº¤æ¢"ç¯èŠ‚ï¼ˆOAuth callbackï¼‰ï¼Œè·å–åˆ° Token åï¼Œç›´æ¥å­˜åœ¨æµè§ˆå™¨çš„ localStorage é‡Œã€‚åç»­åˆ›å»º Issueã€æ›´æ–°è¯„è®ºç­‰æ“ä½œï¼Œç›´æ¥ç”±å‰ç«¯å‘ HTTP è¯·æ±‚åˆ° GitHubã€‚</p>






























<table><thead><tr><th align="left">å¯¹æ¯”ç»´åº¦</th><th align="left">åç«¯ä»£ç†æ¨¡å¼</th><th align="left">å‰ç«¯ç›´è¿æ¨¡å¼</th></tr></thead><tbody><tr><td align="left"><strong>åç«¯å¤æ‚åº¦</strong></td><td align="left">éœ€è¦å®Œæ•´çš„ OAuth æœåŠ¡å’Œ GitHub API å®¢æˆ·ç«¯</td><td align="left">ä»…éœ€ä¸€ä¸ª OAuth å›è°ƒç«¯ç‚¹</td></tr><tr><td align="left"><strong>Token ç®¡ç†</strong></td><td align="left">éœ€åŠ å¯†å­˜å‚¨åœ¨æ•°æ®åº“ï¼Œæœ‰æ³„éœ²é£é™©</td><td align="left">å­˜å‚¨åœ¨æµè§ˆå™¨ï¼Œä»…ç”¨æˆ·è‡ªå·±å¯è§</td></tr><tr><td align="left"><strong>å®æ–½æˆæœ¬</strong></td><td align="left">éœ€æ•°æ®åº“è¿ç§»ã€å¤šæœåŠ¡å¼€å‘</td><td align="left">ä¸»è¦æ˜¯å‰ç«¯å·¥ä½œé‡</td></tr><tr><td align="left"><strong>ç”¨æˆ·ä½“éªŒ</strong></td><td align="left">é€»è¾‘ç»Ÿä¸€ï¼Œä½†æœåŠ¡å™¨å»¶è¿Ÿå¯èƒ½ç¨é«˜</td><td align="left">å“åº”æå¿«ï¼Œç›´æ¥ä¸ GitHub äº¤äº’</td></tr></tbody></table>
<p>è€ƒè™‘åˆ°æˆ‘ä»¬è¦çš„æ˜¯å¿«é€Ÿé›†æˆå’Œæœ€å°åŒ–åç«¯æ”¹åŠ¨ï¼Œ<strong>æœ€ç»ˆæˆ‘ä»¬é‡‡ç”¨äº†"å‰ç«¯ç›´è¿æ¨¡å¼"</strong>ã€‚è¿™å°±åƒç»™æµè§ˆå™¨å‘äº†ä¸€å¼ "ä¸´æ—¶é€šè¡Œè¯"ï¼Œæ‹¿åˆ°è¯ä¹‹åï¼Œæµè§ˆå™¨å°±å¯ä»¥è‡ªå·±å» GitHub åŠäº‹äº†ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½æ‰¾åç«¯ç®¡ç†å‘˜æ‰¹å‡†ã€‚</p>
<hr/>
<h3 data-id="heading-5">æ ¸å¿ƒè®¾è®¡ï¼šæ•°æ®æµä¸å®‰å…¨</h3>
<p>åœ¨ç¡®å®šæ¶æ„åï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡å…·ä½“çš„æ•°æ®æµã€‚æ•´ä¸ªåŒæ­¥æµç¨‹çš„æ ¸å¿ƒåœ¨äºå¦‚ä½•å®‰å…¨åœ°è·å– Token å¹¶é«˜æ•ˆåœ°åˆ©ç”¨å®ƒã€‚</p>
<h4 data-id="heading-6">æ•´ä½“æ¶æ„å›¾</h4>
<p>æ•´ä¸ªç³»ç»Ÿå¯ä»¥æŠ½è±¡ä¸ºä¸‰ä¸ªè§’è‰²ï¼šæµè§ˆå™¨ï¼ˆå‰ç«¯ï¼‰ã€HagiCode åç«¯ã€GitHubã€‚</p>
<pre><code class="hljs language-text" lang="text">+--------------+        +--------------+        +--------------+
|  å‰ç«¯ React  |        |    åç«¯      |        |    GitHub    |
|              |        |   ASP.NET    |        |    REST API  |
|  +--------+  |        |              |        |              |
|  |  OAuth |--+--------&gt; /callback    |        |              |
|  |  æµç¨‹  |  |        |              |        |              |
|  +--------+  |        |              |        |              |
|              |        |              |        |              |
|  +--------+  |        |  +--------+  |        |  +--------+  |
|  |GitHub  |  +------------&gt;Session |  +----------&gt; Issues |  |
|  |API     |  |        |  |Metadata|  |        |  |        |  |
|  |ç›´è¿    |  |        |  +--------+  |        |  +--------+  |
|  +--------+  |        |              |        |              |
+--------------+        +--------------+        +--------------+
</code></pre>
<p><strong>å…³é”®ç‚¹åœ¨äº</strong>ï¼šåªæœ‰ OAuth çš„ä¸€å°æ­¥ï¼ˆè·å– code æ¢ tokenï¼‰éœ€è¦ç»è¿‡åç«¯ï¼Œä¹‹åçš„ç²—æ´»ç´¯æ´»ï¼ˆåˆ›å»º Issueï¼‰éƒ½æ˜¯å‰ç«¯ç›´æ¥è·Ÿ GitHub æ‰“äº¤é“ã€‚</p>
<h4 data-id="heading-7">åŒæ­¥æ•°æ®æµè¯¦è§£</h4>
<p>å½“ç”¨æˆ·ç‚¹å‡» HagiCode ç•Œé¢ä¸Šçš„"Sync to GitHub"æŒ‰é’®æ—¶ï¼Œä¼šå‘ç”Ÿä¸€ç³»åˆ—å¤æ‚çš„åŠ¨ä½œï¼š</p>
<pre><code class="hljs language-text" lang="text">ç”¨æˆ·ç‚¹å‡» "Sync to GitHub"
         â”‚
         â–¼
1. å‰ç«¯æ£€æŸ¥ localStorage è·å– GitHub Token
         â”‚
         â–¼
2. æ ¼å¼åŒ– Issue å†…å®¹ï¼ˆå°† Proposal è½¬æ¢ä¸º Markdownï¼‰
         â”‚
         â–¼
3. å‰ç«¯ç›´æ¥è°ƒç”¨ GitHub API åˆ›å»º/æ›´æ–° Issue
         â”‚
         â–¼
4. è°ƒç”¨ HagiCode åç«¯ API æ›´æ–° Session.metadata (å­˜å‚¨ Issue URL ç­‰ä¿¡æ¯)
         â”‚
         â–¼
5. åç«¯é€šè¿‡ SignalR å¹¿æ’­ SessionUpdated äº‹ä»¶
         â”‚
         â–¼
6. å‰ç«¯æ¥æ”¶äº‹ä»¶ï¼Œæ›´æ–° UI æ˜¾ç¤º"å·²åŒæ­¥"çŠ¶æ€
</code></pre>
<h4 data-id="heading-8">å®‰å…¨è®¾è®¡</h4>
<p>å®‰å…¨é—®é¢˜å§‹ç»ˆæ˜¯é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡çš„é‡ä¸­ä¹‹é‡ã€‚æˆ‘ä»¬åšäº†ä»¥ä¸‹è€ƒé‡ï¼š</p>
<ol>
<li><strong>é˜² CSRF æ”»å‡»</strong>ï¼šåœ¨ OAuth è·³è½¬æ—¶ï¼Œç”Ÿæˆéšæœºçš„ <code>state</code> å‚æ•°å¹¶å­˜å…¥ sessionStorageã€‚å›è°ƒæ—¶ä¸¥æ ¼éªŒè¯ stateï¼Œé˜²æ­¢è¯·æ±‚è¢«ä¼ªé€ ã€‚</li>
<li><strong>Token å­˜å‚¨éš”ç¦»</strong>ï¼šToken ä»…å­˜å‚¨åœ¨æµè§ˆå™¨çš„ <code>localStorage</code> ä¸­ï¼Œåˆ©ç”¨åŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰ï¼Œåªæœ‰ HagiCode çš„è„šæœ¬æ‰èƒ½è¯»å–ï¼Œé¿å…äº†æœåŠ¡å™¨ç«¯æ•°æ®åº“æ³„éœ²æ³¢åŠç”¨æˆ·ã€‚</li>
<li><strong>é”™è¯¯è¾¹ç•Œ</strong>ï¼šé’ˆå¯¹ GitHub API å¸¸è§çš„é”™è¯¯ï¼ˆå¦‚ 401 Token è¿‡æœŸã€422 éªŒè¯å¤±è´¥ã€429 é€Ÿç‡é™åˆ¶ï¼‰ï¼Œè®¾è®¡äº†ä¸“é—¨çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œç»™ç”¨æˆ·ä»¥å‹å¥½çš„æç¤ºã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-9">å®è·µï¼šä»£ç å®ç°ç»†èŠ‚</h3>
<p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œå’±ä»¬æ¥çœ‹çœ‹å…·ä½“çš„ä»£ç æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p>
<h4 data-id="heading-10">1. åç«¯æœ€å°åŒ–æ”¹åŠ¨</h4>
<p>åç«¯åªéœ€è¦åšä¸¤ä»¶äº‹ï¼šå­˜å‚¨åŒæ­¥ä¿¡æ¯ã€å¤„ç† OAuth å›è°ƒã€‚</p>
<p><strong>æ•°æ®åº“å˜æ›´</strong>
æˆ‘ä»¬åªéœ€è¦åœ¨ <code>Sessions</code> è¡¨å¢åŠ ä¸€ä¸ª <code>Metadata</code> åˆ—ï¼Œç”¨æ¥å­˜å‚¨ JSON æ ¼å¼çš„æ‰©å±•ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ·»åŠ  metadata åˆ—åˆ° Sessions è¡¨</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "Sessions" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> "Metadata" text <span class="hljs-keyword">NULL</span>;
</code></pre>
<p><strong>å®ä½“ä¸ DTO å®šä¹‰</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// src/HagiCode.DomainServices.Contracts/Entities/Session.cs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Session</span> : <span class="hljs-title">AuditedAggregateRoot</span>&lt;<span class="hljs-title">SessionId</span>&gt;
{
    <span class="hljs-comment">// ... å…¶ä»–å±æ€§ ...</span>

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> JSON metadata for storing extension data like GitHub integration</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Metadata { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// DTO å®šä¹‰ï¼Œæ–¹ä¾¿å‰ç«¯åºåˆ—åŒ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GitHubIssueMetadata</span>
{
    <span class="hljs-keyword">public</span> required <span class="hljs-built_in">string</span> Owner { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> required <span class="hljs-built_in">string</span> Repo { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> IssueNumber { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> required <span class="hljs-built_in">string</span> IssueUrl { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> DateTime SyncedAt { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> LastSyncStatus { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-string">"success"</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SessionMetadata</span>
{
    <span class="hljs-keyword">public</span> GitHubIssueMetadata? GitHubIssue { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
</code></pre>
<h4 data-id="heading-11">2. å‰ç«¯ OAuth æµç¨‹</h4>
<p>è¿™æ˜¯è¿æ¥çš„å…¥å£ã€‚æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„ Authorization Code Flowã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/HagiCode.Client/src/services/githubOAuth.ts</span>

<span class="hljs-comment">// ç”Ÿæˆæˆæƒ URL å¹¶è·³è½¬</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateAuthUrl</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">generateRandomString</span>(); <span class="hljs-comment">// ç”Ÿæˆé˜² CSRF çš„éšæœºä¸²</span>
  sessionStorage.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'hagicode_github_state'</span>, state);
  
  <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>({
    <span class="hljs-attr">client_id</span>: clientId,
    <span class="hljs-attr">redirect_uri</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> + <span class="hljs-string">'/settings?tab=github&amp;oauth=callback'</span>,
    <span class="hljs-attr">scope</span>: [<span class="hljs-string">'repo'</span>, <span class="hljs-string">'public_repo'</span>].<span class="hljs-title function_">join</span>(<span class="hljs-string">' '</span>),
    <span class="hljs-attr">state</span>: state,
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-string">`https://github.com/login/oauth/authorize?<span class="hljs-subst">${params.toString()}</span>`</span>;
}

<span class="hljs-comment">// åœ¨å›è°ƒé¡µé¢å¤„ç† Code æ¢å– Token</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">exchangeCodeForToken</span>(<span class="hljs-params">code: <span class="hljs-built_in">string</span>, state: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GitHubToken</span>&gt; {
  <span class="hljs-comment">// 1. éªŒè¯ State é˜²æ­¢ CSRF</span>
  <span class="hljs-keyword">const</span> savedState = sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'hagicode_github_state'</span>);
  <span class="hljs-keyword">if</span> (state !== savedState) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Invalid state parameter'</span>);

  <span class="hljs-comment">// 2. è°ƒç”¨åç«¯ API è¿›è¡Œ Token äº¤æ¢</span>
  <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»ç»è¿‡åç«¯ï¼Œå› ä¸ºéœ€è¦ ClientSecretï¼Œä¸èƒ½æš´éœ²åœ¨å‰ç«¯</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/GitHubOAuth/callback'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ code, state, <span class="hljs-attr">redirectUri</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> + <span class="hljs-string">'/settings?tab=github&amp;oauth=callback'</span> }),
  });

  <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Failed to exchange token'</span>);
  
  <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
  
  <span class="hljs-comment">// 3. å­˜å…¥ LocalStorage</span>
  <span class="hljs-title function_">saveToken</span>(token);
  <span class="hljs-keyword">return</span> token;
}
</code></pre>
<h4 data-id="heading-12">3. GitHub API å®¢æˆ·ç«¯å°è£…</h4>
<p>æœ‰äº† Token ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å·¥å…·æ¥è°ƒ GitHub APIã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/HagiCode.Client/src/services/githubApiClient.ts</span>

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GITHUB_API_BASE</span> = <span class="hljs-string">'https://api.github.com'</span>;

<span class="hljs-comment">// æ ¸å¿ƒè¯·æ±‚å°è£…</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> githubApi&lt;T&gt;(<span class="hljs-attr">endpoint</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">options</span>: <span class="hljs-title class_">RequestInit</span> = {}): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'gh_token'</span>);
  <span class="hljs-keyword">if</span> (!token) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Not connected to GitHub'</span>);
  
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`<span class="hljs-subst">${GITHUB_API_BASE}</span><span class="hljs-subst">${endpoint}</span>`</span>, {
    ...options,
    <span class="hljs-attr">headers</span>: {
      ...options.<span class="hljs-property">headers</span>,
      <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>,
      <span class="hljs-title class_">Accept</span>: <span class="hljs-string">'application/vnd.github.v3+json'</span>, <span class="hljs-comment">// æŒ‡å®š API ç‰ˆæœ¬</span>
    },
  });
  
  <span class="hljs-comment">// é”™è¯¯å¤„ç†é€»è¾‘</span>
  <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">401</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'GitHub Token å¤±æ•ˆï¼Œè¯·é‡æ–°è¿æ¥'</span>);
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">403</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ— æƒè®¿é—®è¯¥ä»“åº“æˆ–è¶…å‡ºé€Ÿç‡é™åˆ¶'</span>);
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">422</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Issue éªŒè¯å¤±è´¥ï¼Œå¯èƒ½æ ‡é¢˜é‡å¤'</span>);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`GitHub API Error: <span class="hljs-subst">${response.statusText}</span>`</span>);
  }
  
  <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// åˆ›å»º Issue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createIssue</span>(<span class="hljs-params">owner: <span class="hljs-built_in">string</span>, repo: <span class="hljs-built_in">string</span>, data: { title: <span class="hljs-built_in">string</span>, body: <span class="hljs-built_in">string</span>, labels: <span class="hljs-built_in">string</span>[] }</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">githubApi</span>(<span class="hljs-string">`/repos/<span class="hljs-subst">${owner}</span>/<span class="hljs-subst">${repo}</span>/issues`</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data),
  });
}
</code></pre>
<h4 data-id="heading-13">4. å†…å®¹æ ¼å¼åŒ–ä¸åŒæ­¥</h4>
<p>æœ€åä¸€æ­¥ï¼Œå°±æ˜¯æŠŠ HagiCode çš„ Session æ•°æ®è½¬æ¢æˆ GitHub Issue çš„æ ¼å¼ã€‚è¿™æœ‰ç‚¹åƒ"ç¿»è¯‘"å·¥ä½œã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å°† Session å¯¹è±¡è½¬æ¢ä¸º Markdown å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatIssueForSession</span>(<span class="hljs-params">session: Session</span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">let</span> content = <span class="hljs-string">`# <span class="hljs-subst">${session.title}</span>\n\n`</span>;
  content += <span class="hljs-string">`**&gt; HagiCode Session:** #<span class="hljs-subst">${session.code}</span>\n`</span>;
  content += <span class="hljs-string">`**&gt; Status:** <span class="hljs-subst">${session.status}</span>\n\n`</span>;
  content += <span class="hljs-string">`## Description\n\n<span class="hljs-subst">${session.description || <span class="hljs-string">'No description provided.'</span>}</span>\n\n`</span>;
  
  <span class="hljs-comment">// å¦‚æœæ˜¯ Proposal ç±»å‹ï¼Œæ·»åŠ é¢å¤–å­—æ®µ</span>
  <span class="hljs-keyword">if</span> (session.<span class="hljs-property">type</span> === <span class="hljs-string">'proposal'</span>) {
    content += <span class="hljs-string">`## Chief Complaint\n\n<span class="hljs-subst">${session.chiefComplaint || <span class="hljs-string">''</span>}</span>\n\n`</span>;
    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªæ·±é“¾æ¥ï¼Œæ–¹ä¾¿ä» GitHub è·³å› HagiCode</span>
    content += <span class="hljs-string">`---\n\n**[View in HagiCode](hagicode://sessions/<span class="hljs-subst">${session.id}</span>)**\n`</span>;
  }
  
  <span class="hljs-keyword">return</span> content;
}

<span class="hljs-comment">// ç‚¹å‡»åŒæ­¥æŒ‰é’®çš„ä¸»é€»è¾‘</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSync</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">session: Session</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> repoInfo = <span class="hljs-title function_">parseRepositoryFromUrl</span>(session.<span class="hljs-property">repoUrl</span>); <span class="hljs-comment">// è§£æä»“åº“ URL</span>
    <span class="hljs-keyword">if</span> (!repoInfo) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Invalid repository URL'</span>);

    toast.<span class="hljs-title function_">loading</span>(<span class="hljs-string">'æ­£åœ¨åŒæ­¥åˆ° GitHub...'</span>);
    
    <span class="hljs-comment">// 1. æ ¼å¼åŒ–å†…å®¹</span>
    <span class="hljs-keyword">const</span> issueBody = <span class="hljs-title function_">formatIssueForSession</span>(session);
    
    <span class="hljs-comment">// 2. è°ƒç”¨ API</span>
    <span class="hljs-keyword">const</span> issue = <span class="hljs-keyword">await</span> githubApiClient.<span class="hljs-title function_">createIssue</span>(repoInfo.<span class="hljs-property">owner</span>, repoInfo.<span class="hljs-property">repo</span>, {
      <span class="hljs-attr">title</span>: <span class="hljs-string">`[HagiCode] <span class="hljs-subst">${session.title}</span>`</span>,
      <span class="hljs-attr">body</span>: issueBody,
      <span class="hljs-attr">labels</span>: [<span class="hljs-string">'hagicode'</span>, <span class="hljs-string">'proposal'</span>, <span class="hljs-string">`status:<span class="hljs-subst">${session.status}</span>`</span>],
    });
    
    <span class="hljs-comment">// 3. æ›´æ–° Session Metadata (ä¿å­˜ Issue é“¾æ¥)</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">SessionsService</span>.<span class="hljs-title function_">patchApiSessionsSessionId</span>(session.<span class="hljs-property">id</span>, {
      <span class="hljs-attr">metadata</span>: {
        <span class="hljs-attr">githubIssue</span>: {
          <span class="hljs-attr">owner</span>: repoInfo.<span class="hljs-property">owner</span>,
          <span class="hljs-attr">repo</span>: repoInfo.<span class="hljs-property">repo</span>,
          <span class="hljs-attr">issueNumber</span>: issue.<span class="hljs-property">number</span>,
          <span class="hljs-attr">issueUrl</span>: issue.<span class="hljs-property">html_url</span>,
          <span class="hljs-attr">syncedAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
        }
      }
    });

    toast.<span class="hljs-title function_">success</span>(<span class="hljs-string">'åŒæ­¥æˆåŠŸï¼'</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
    toast.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ Token æˆ–ç½‘ç»œ'</span>);
  }
};
</code></pre>
<hr/>
<h3 data-id="heading-14">æ€»ç»“ä¸å±•æœ›</h3>
<p>é€šè¿‡è¿™å¥—"å‰ç«¯ç›´è¿"æ–¹æ¡ˆï¼Œæˆ‘ä»¬ç”¨æœ€å°‘çš„åç«¯ä»£ç å®ç°äº† GitHub Issues çš„æ— ç¼é›†æˆã€‚</p>
<h4 data-id="heading-15">æ”¶è·</h4>
<ol>
<li><strong>å¼€å‘æ•ˆç‡é«˜</strong>ï¼šåç«¯æ”¹åŠ¨æå°ï¼Œä¸»è¦æ˜¯æ•°æ®åº“åŠ ä¸€ä¸ªå­—æ®µå’Œä¸€ä¸ªç®€å•çš„ OAuth å›è°ƒæ¥å£ï¼Œå¤§éƒ¨åˆ†é€»è¾‘éƒ½åœ¨å‰ç«¯å®Œæˆã€‚</li>
<li><strong>å®‰å…¨æ€§å¥½</strong>ï¼šToken ä¸ç»è¿‡æœåŠ¡å™¨æ•°æ®åº“ï¼Œé™ä½äº†æ³„éœ²é£é™©ã€‚</li>
<li><strong>ç”¨æˆ·ä½“éªŒä½³</strong>ï¼šç›´æ¥ä»å‰ç«¯å‘èµ·è¯·æ±‚ï¼Œå“åº”é€Ÿåº¦å¿«ï¼Œä¸éœ€è¦ç»è¿‡åç«¯ä¸­è½¬ã€‚</li>
</ol>
<h4 data-id="heading-16">æ³¨æ„äº‹é¡¹</h4>
<p>åœ¨å®é™…éƒ¨ç½²æ—¶ï¼Œæœ‰å‡ ä¸ªå‘å¤§å®¶è¦æ³¨æ„ï¼š</p>
<ul>
<li><strong>OAuth App è®¾ç½®</strong>ï¼šè®°å¾—åœ¨ GitHub OAuth App è®¾ç½®é‡Œå¡«æ­£ç¡®çš„ <code>Authorization callback URL</code>ï¼ˆé€šå¸¸æ˜¯ <code>http://localhost:3000/settings?tab=github&amp;oauth=callback</code>ï¼‰ã€‚</li>
<li><strong>é€Ÿç‡é™åˆ¶</strong>ï¼šGitHub API å¯¹æœªè®¤è¯è¯·æ±‚é™åˆ¶è¾ƒä¸¥ï¼Œä½†ç”¨ Token åé€šå¸¸è¶³å¤Ÿï¼ˆ5000æ¬¡/å°æ—¶ï¼‰ã€‚</li>
<li><strong>URL è§£æ</strong>ï¼šç”¨æˆ·è¾“å…¥çš„ Repo URL åƒå¥‡ç™¾æ€ªï¼Œè®°å¾—æ­£åˆ™è¦åŒ¹é… <code>.git</code> åç¼€ã€SSH æ ¼å¼ç­‰æƒ…å†µã€‚</li>
</ul>
<h4 data-id="heading-17">åç»­å¢å¼º</h4>
<p>ç›®å‰çš„åŠŸèƒ½è¿˜æ˜¯å•å‘åŒæ­¥ï¼ˆHagiCode -&gt; GitHubï¼‰ã€‚æœªæ¥æˆ‘ä»¬è®¡åˆ’é€šè¿‡ GitHub Webhooks å®ç°åŒå‘åŒæ­¥ï¼Œæ¯”å¦‚åœ¨ GitHub é‡Œå…³é—­ Issueï¼ŒHagiCode è¿™è¾¹çš„ä¼šè¯çŠ¶æ€ä¹Ÿèƒ½è‡ªåŠ¨æ›´æ–°ã€‚è¿™éœ€è¦æˆ‘ä»¬åœ¨åç«¯æš´éœ²ä¸€ä¸ª Webhook æ¥æ”¶ç«¯ç‚¹ï¼Œè¿™ä¹Ÿæ˜¯ä¸‹ä¸€æ­¥è¦åšçš„æœ‰è¶£å·¥ä½œã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™ä½ çš„ç¬¬ä¸‰æ–¹é›†æˆå¼€å‘å¸¦æ¥ä¸€ç‚¹çµæ„Ÿï¼å¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHagiCode-org%2Fsite" target="_blank" title="https://github.com/HagiCode-org/site" ref="nofollow noopener noreferrer">HagiCode GitHub</a> ä¸Šæ Issue è®¨è®ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Post Listã€mockjsä¸axioså®æˆ˜å­¦ä¹ ç¬”è®°]]></title>    <link>https://juejin.cn/post/7598472744480653331</link>    <guid>https://juejin.cn/post/7598472744480653331</guid>    <pubDate>2026-01-24T07:57:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598472744480653331" data-draft-id="7598472744480636947" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Post Listã€mockjsä¸axioså®æˆ˜å­¦ä¹ ç¬”è®°"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,axios"/> <meta itemprop="datePublished" content="2026-01-24T07:57:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="UIUV"/> <meta itemprop="url" content="https://juejin.cn/user/1036168457093483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Post Listã€mockjsä¸axioså®æˆ˜å­¦ä¹ ç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1036168457093483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    UIUV
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:57:31.000Z" title="Sat Jan 24 2026 07:57:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Post Listã€mockjsä¸axioså®æˆ˜å­¦ä¹ ç¬”è®°</h2>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œæ•°æ®è¯·æ±‚ã€æ¨¡æ‹Ÿæ•°æ®ä¸çŠ¶æ€ç®¡ç†æ˜¯æ ¸å¿ƒç¯èŠ‚ã€‚æœ¬æ–‡åŸºäºReact+ViteæŠ€æœ¯æ ˆï¼Œç»“åˆå®æˆ˜ä»£ç ï¼Œç³»ç»Ÿæ¢³ç†Post Listæ•°æ®æ¸²æŸ“ã€axiosè¯·æ±‚å°è£…ã€mockjsæ¨¡æ‹Ÿæ¥å£ä¸‰å¤§æ¨¡å—çš„ç›¸å…³çŸ¥è¯†ï¼Œå‰–æå…¶æŠ€æœ¯åŸç†ã€å®ç°é€»è¾‘ä¸å¼€å‘è§„èŒƒï¼Œä¸ºå‰ç«¯é¡¹ç›®çš„æ•°æ®å±‚æ­å»ºæä¾›å‚è€ƒã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•´ä½“æŠ€æœ¯èƒŒæ™¯ä¸æ ¸å¿ƒæµç¨‹</h2>
<p>æœ¬æ–‡å®æˆ˜åœºæ™¯ä¸ºç§»åŠ¨ç«¯Reacté¡¹ç›®çš„é¦–é¡µå¸–å­åˆ—è¡¨ï¼ˆPost Listï¼‰åŠŸèƒ½ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯å®ç°â€œå‰ç«¯è¯·æ±‚-æ¨¡æ‹Ÿæ•°æ®-çŠ¶æ€ç®¡ç†-é¡µé¢æ¸²æŸ“â€çš„å®Œæ•´é—­ç¯ã€‚åœ¨å‰åç«¯åˆ†ç¦»æ¶æ„ä¸‹ï¼Œåç«¯æ¥å£å¼€å‘å¾€å¾€æ»åäºå‰ç«¯é¡µé¢å¼€å‘ï¼Œæ­¤æ—¶éœ€é€šè¿‡mockjsæ¨¡æ‹Ÿæ¥å£è¿”å›æ•°æ®ï¼ŒåŒæ—¶å€ŸåŠ©axioså°è£…ç»Ÿä¸€çš„è¯·æ±‚é€»è¾‘ï¼Œå†é€šè¿‡Zustandç®¡ç†å…¨å±€çŠ¶æ€ï¼Œæœ€ç»ˆå°†æ•°æ®æ¸²æŸ“è‡³é¡µé¢ã€‚</p>
<p>æ ¸å¿ƒæŠ€æœ¯æ ˆï¼šReact 18+Vite 5+TypeScript+axios+mockjs+Zustand+TailwindCSSï¼Œå„æŠ€æœ¯åˆ†å·¥å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>axios</strong>ï¼šè´Ÿè´£å‘èµ·HTTPè¯·æ±‚ï¼Œå¤„ç†è¯·æ±‚æ‹¦æˆªã€å“åº”æ‹¦æˆªã€é”™è¯¯æ•è·ç­‰é€»è¾‘ï¼›</li>
<li><strong>mockjs</strong>ï¼šåœ¨å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿåç«¯æ¥å£ï¼Œç”Ÿæˆéšæœºæµ‹è¯•æ•°æ®ï¼Œå®ç°å‰ç«¯ç‹¬ç«‹å¼€å‘ï¼›</li>
<li><strong>Zustand</strong>ï¼šè½»é‡çº§å…¨å±€çŠ¶æ€ç®¡ç†åº“ï¼Œå­˜å‚¨å¸–å­åˆ—è¡¨æ•°æ®ä¸åŠ è½½æ–¹æ³•ï¼Œå®ç°ç»„ä»¶é—´æ•°æ®å…±äº«ï¼›</li>
<li><strong>Vite</strong>ï¼šé€šè¿‡æ’ä»¶é›†æˆmockæœåŠ¡ï¼Œé…ç½®è·¯å¾„åˆ«åï¼Œä¼˜åŒ–å¼€å‘ä½“éªŒï¼›</li>
<li><strong>TypeScript</strong>ï¼šå®šä¹‰æ¥å£ç±»å‹ï¼ˆPostã€Userï¼‰ï¼Œå®ç°ç±»å‹å®‰å…¨ï¼Œé¿å…æ•°æ®å¼‚å¸¸ã€‚</li>
</ul>
<p>å®Œæ•´æ•°æ®æµè½¬æµç¨‹ï¼šé¡µé¢åŠ è½½æ—¶è§¦å‘useEffectè°ƒç”¨loadMoreæ–¹æ³• â†’ Zustandè°ƒç”¨å°è£…å¥½çš„fetchPostsæ¥å£ â†’ axioså‘èµ·GETè¯·æ±‚ â†’ mockjsæ‹¦æˆªè¯·æ±‚å¹¶è¿”å›æ¨¡æ‹Ÿæ•°æ® â†’ axiosæ¥æ”¶å“åº”å¹¶å¤„ç† â†’ Zustandæ›´æ–°postsçŠ¶æ€ â†’ é¡µé¢ä»çŠ¶æ€ä¸­è¯»å–æ•°æ®å¹¶æ¸²æŸ“ã€‚</p>
<h2 data-id="heading-2">äºŒã€axiosï¼šHTTPè¯·æ±‚å°è£…ä¸å®æˆ˜</h2>
<h3 data-id="heading-3">2.1 axiosæ ¸å¿ƒç‰¹æ€§</h3>
<p>axiosæ˜¯ä¸€æ¬¾åŸºäºPromiseçš„HTTPå®¢æˆ·ç«¯ï¼Œæ”¯æŒæµè§ˆå™¨ç«¯ä¸Node.jsç¯å¢ƒï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li>æ”¯æŒè¯·æ±‚/å“åº”æ‹¦æˆªå™¨ï¼Œå¯ç»Ÿä¸€å¤„ç†è¯·æ±‚å¤´ã€tokenéªŒè¯ã€é”™è¯¯æç¤ºç­‰ï¼›</li>
<li>è‡ªåŠ¨è½¬æ¢JSONæ•°æ®ï¼Œæ— éœ€æ‰‹åŠ¨è§£æå“åº”ä½“ï¼›</li>
<li>æ”¯æŒå–æ¶ˆè¯·æ±‚ã€è¶…æ—¶è®¾ç½®ã€è¯·æ±‚é‡è¯•ç­‰é«˜çº§åŠŸèƒ½ï¼›</li>
<li>å…¼å®¹æ€§è‰¯å¥½ï¼Œå¯é€‚é…ä¸åŒæµè§ˆå™¨ä¸Node.jsç‰ˆæœ¬ï¼›</li>
<li>æ”¯æŒTypeScriptç±»å‹æ¨å¯¼ï¼Œä¸TSé¡¹ç›®æ— ç¼é›†æˆã€‚</li>
</ul>
<h3 data-id="heading-4">2.2 åŸºç¡€é…ç½®ä¸å°è£…è§„èŒƒ</h3>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéœ€å¯¹axiosè¿›è¡Œç»Ÿä¸€å°è£…ï¼Œé¿å…é‡å¤ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚æ ¸å¿ƒå°è£…è¦ç‚¹åŒ…æ‹¬ï¼šåŸºç¡€è·¯å¾„è®¾ç½®ã€è¯·æ±‚å¤´é…ç½®ã€é”™è¯¯ç»Ÿä¸€å¤„ç†ã€ç±»å‹å®šä¹‰ç­‰ã€‚</p>
<h4 data-id="heading-5">2.2.1 åŸºç¡€é…ç½®å®ç°</h4>
<p>ä»£ç ä¸­å¯¹axiosçš„åŸºç¡€é…ç½®å¦‚ä¸‹ï¼Œä½äº<code>src/api/config.ts</code>ï¼ˆæˆ–å¯¹åº”æ–‡ä»¶ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-comment">// æ¥å£åœ°å€éƒ½ä»¥/apiå¼€å§‹</span>
axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">'http://localhost:5173/api'</span>
<span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒå¯åˆ‡æ¢ä¸ºçœŸå®åç«¯åœ°å€</span>
<span class="hljs-comment">// axios.defaults.baseURL = 'http://douyin.com:5173/api'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> axios;
</code></pre>
<p>å…³é”®é…ç½®è¯´æ˜ï¼š</p>
<ul>
<li><code>baseURL</code>ï¼šè®¾ç½®è¯·æ±‚åŸºç¡€è·¯å¾„ï¼Œåç»­è¯·æ±‚URLå¯çœç•¥åŸºç¡€éƒ¨åˆ†ï¼Œç®€åŒ–ä»£ç ã€‚å¼€å‘ç¯å¢ƒæŒ‡å‘æœ¬åœ°ViteæœåŠ¡ï¼ˆé…åˆmockjsï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒåˆ‡æ¢ä¸ºåç«¯çœŸå®æ¥å£åœ°å€ï¼›</li>
<li>å¯æ‰©å±•é…ç½®ï¼šå¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆ<code>timeout: 5000</code>ï¼‰ã€é»˜è®¤è¯·æ±‚å¤´ï¼ˆ<code>headers: {'Content-Type': 'application/json'}</code>ï¼‰ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-6">2.2.2 æ¥å£å‡½æ•°å°è£…</h4>
<p>é’ˆå¯¹å…·ä½“ä¸šåŠ¡æ¥å£ï¼Œå°è£…ç‹¬ç«‹çš„è¯·æ±‚å‡½æ•°ï¼Œä¾¿äºå¤ç”¨ä¸ç»´æŠ¤ã€‚ä»¥å¸–å­åˆ—è¡¨è¯·æ±‚ä¸ºä¾‹ï¼Œä»£ç ä½äº<code>src/api/posts.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'./config'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Post</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/types'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchPosts</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
    page: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>,
    limit: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>,
</span>) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/posts'</span>, {
            <span class="hljs-attr">params</span>: {
                page,
                limit,
            }
        });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è·å–å¸–å­åˆ—è¡¨æˆåŠŸ'</span>, response);
        <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–å¸–å­åˆ—è¡¨å¤±è´¥'</span>, error);
        <span class="hljs-keyword">throw</span> error;
    }
};
</code></pre>
<p>å°è£…è¦ç‚¹ä¸æœ€ä½³å®è·µï¼š</p>
<ul>
<li><strong>TypeScriptç±»å‹çº¦æŸ</strong>ï¼šå¯¼å…¥Postç±»å‹ï¼Œæ˜ç¡®è¿”å›æ•°æ®ç»“æ„ï¼Œå®ç°ç±»å‹å®‰å…¨ã€‚å‚æ•°pageã€limitè®¾ç½®é»˜è®¤å€¼ï¼Œé¿å…è°ƒç”¨æ—¶ä¼ å‚é—æ¼ï¼›</li>
<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šä½¿ç”¨async/awaitè¯­æ³•ï¼Œæ›¿ä»£Promise.then()ï¼Œä»£ç æ›´ç®€æ´æ˜“è¯»ï¼›</li>
<li><strong>é”™è¯¯æ•è·</strong>ï¼šé€šè¿‡try/catchæ•è·è¯·æ±‚å¼‚å¸¸ï¼Œæ‰“å°é”™è¯¯æ—¥å¿—ä¾¿äºæ’æŸ¥é—®é¢˜ï¼ŒåŒæ—¶é€šè¿‡throw errorå‘ä¸Šå±‚æŠ›å‡ºå¼‚å¸¸ï¼Œç”±è°ƒç”¨æ–¹å†³å®šåç»­å¤„ç†ï¼ˆå¦‚æç¤ºç”¨æˆ·ï¼‰ï¼›</li>
<li><strong>å‚æ•°ä¼ é€’</strong>ï¼šGETè¯·æ±‚é€šè¿‡paramså±æ€§ä¼ é€’æŸ¥è¯¢å‚æ•°ï¼ˆpageã€limitï¼‰ï¼Œaxiosä¼šè‡ªåŠ¨å°†å…¶æ‹¼æ¥ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå¦‚<code>/api/posts?page=1&amp;limit=10</code>ï¼‰ï¼›POSTè¯·æ±‚å¯é€šè¿‡dataå±æ€§ä¼ é€’è¯·æ±‚ä½“ã€‚</li>
</ul>
<h4 data-id="heading-7">2.3 è¿›é˜¶æ‰©å±•ï¼šè¯·æ±‚/å“åº”æ‹¦æˆªå™¨</h4>
<p>å®é™…é¡¹ç›®ä¸­ï¼Œéœ€é€šè¿‡æ‹¦æˆªå™¨å®ç°å…¨å±€ç»Ÿä¸€é€»è¾‘ï¼Œä¾‹å¦‚è¯·æ±‚æ—¶æ·»åŠ tokenã€å“åº”æ—¶ç»Ÿä¸€å¤„ç†é”™è¯¯çŠ¶æ€ç ç­‰ã€‚ä»¥ä¸‹ä¸ºå¸¸è§æ‹¦æˆªå™¨é…ç½®ç¤ºä¾‹ï¼Œå¯é›†æˆåˆ°axiosåŸºç¡€é…ç½®ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨</span>
axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
    <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
        <span class="hljs-comment">// ç»™æ¯ä¸ªè¯·æ±‚æ·»åŠ token</span>
        <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>);
        <span class="hljs-keyword">if</span> (token) {
            config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
        }
        <span class="hljs-keyword">return</span> config;
    },
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-comment">// è¯·æ±‚å‘èµ·å‰çš„é”™è¯¯å¤„ç†ï¼ˆå¦‚å‚æ•°éªŒè¯å¤±è´¥ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
    }
);

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨</span>
axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
    <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-comment">// ç»Ÿä¸€å¤„ç†å“åº”æ•°æ®ï¼Œåªè¿”å›dataéƒ¨åˆ†</span>
        <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
    },
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-comment">// ç»Ÿä¸€å¤„ç†é”™è¯¯çŠ¶æ€ç </span>
        <span class="hljs-keyword">const</span> status = error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span>;
        <span class="hljs-keyword">switch</span> (status) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">401</span>:
                <span class="hljs-comment">// æœªæˆæƒï¼Œè·³è½¬ç™»å½•é¡µ</span>
                <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/login'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">404</span>:
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¥å£ä¸å­˜åœ¨'</span>);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">500</span>:
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>);
                <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
    }
);
</code></pre>
<p>æ‹¦æˆªå™¨çš„æ ¸å¿ƒä»·å€¼åœ¨äºâ€œé›†ä¸­å¤„ç†â€ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œæå‡é¡¹ç›®å¯ç»´æŠ¤æ€§ã€‚</p>
<h2 data-id="heading-8">ä¸‰ã€mockjsï¼šå‰ç«¯æ¨¡æ‹Ÿæ¥å£ä¸æµ‹è¯•æ•°æ®ç”Ÿæˆ</h2>
<h3 data-id="heading-9">3.1 mockjsçš„æ ¸å¿ƒä½œç”¨</h3>
<p>åœ¨å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼ä¸­ï¼Œå‰ç«¯å¼€å‘å¸¸ä¾èµ–åç«¯æ¥å£ï¼Œä½†åç«¯æ¥å£å¼€å‘ã€è”è°ƒå¾€å¾€éœ€è¦ä¸€å®šæ—¶é—´ã€‚æ­¤æ—¶mockjså¯å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>æ¨¡æ‹Ÿåç«¯æ¥å£ï¼Œæ‹¦æˆªå‰ç«¯è¯·æ±‚ï¼Œè¿”å›è‡ªå®šä¹‰æ¨¡æ‹Ÿæ•°æ®ï¼Œä½¿å‰ç«¯æ— éœ€ç­‰å¾…åç«¯æ¥å£å®Œæˆå³å¯ç‹¬ç«‹å¼€å‘ï¼›</li>
<li>ç”Ÿæˆå¤§é‡éšæœºæµ‹è¯•æ•°æ®ï¼Œè¦†ç›–ä¸åŒåœºæ™¯ï¼ˆå¦‚åˆ†é¡µã€å¼‚å¸¸çŠ¶æ€ï¼‰ï¼Œä¾¿äºæµ‹è¯•é¡µé¢æ¸²æŸ“æ•ˆæœï¼›</li>
<li>ä¸çœŸå®æ¥å£æ ¼å¼ä¸€è‡´ï¼Œå¼€å‘å®Œæˆååªéœ€åˆ‡æ¢baseURLå³å¯æ— ç¼å¯¹æ¥åç«¯ï¼Œæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ã€‚</li>
</ul>
<h3 data-id="heading-10">3.2 Viteé›†æˆmockæœåŠ¡</h3>
<p>Viteé€šè¿‡<code>vite-plugin-mock</code>æ’ä»¶é›†æˆmockæœåŠ¡ï¼Œå®ç°å¼€å‘ç¯å¢ƒä¸‹çš„æ¥å£æ¨¡æ‹Ÿã€‚é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-11">3.2.1 å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-css" lang="css">npm install mockjs vite-plugin-mock <span class="hljs-attr">--save-dev</span>
</code></pre>
<h4 data-id="heading-12">3.2.2 Viteé…ç½®æ–‡ä»¶ä¿®æ”¹</h4>
<p>åœ¨<code>vite.config.ts</code>ä¸­é…ç½®mockæœåŠ¡ï¼ŒæŒ‡å®šmockæ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-react'</span>
<span class="hljs-keyword">import</span> tailwindcss <span class="hljs-keyword">from</span> <span class="hljs-string">'@tailwindcss/vite'</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
<span class="hljs-keyword">import</span> { viteMockServe } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-mock'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">react</span>(), 
    <span class="hljs-title function_">tailwindcss</span>(), 
    <span class="hljs-title function_">viteMockServe</span>({
      <span class="hljs-attr">mockPath</span>: <span class="hljs-string">'mock'</span>, <span class="hljs-comment">// æŒ‡å®šmockæ–‡ä»¶å­˜æ”¾ç›®å½•</span>
      <span class="hljs-attr">localEnabled</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¼€å‘ç¯å¢ƒå¯ç”¨mock</span>
      <span class="hljs-attr">prodEnabled</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒç¦ç”¨mock</span>
    })
  ],
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">'@'</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'src'</span>), <span class="hljs-comment">// è·¯å¾„åˆ«åï¼Œç®€åŒ–å¯¼å…¥</span>
    }
  }
});
</code></pre>
<p>å…³é”®é…ç½®è¯´æ˜ï¼š</p>
<ul>
<li><code>mockPath</code>ï¼šæŒ‡å®šmocké…ç½®æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ï¼ˆæœ¬æ–‡ä¸ºé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„mockæ–‡ä»¶å¤¹ï¼‰ï¼›</li>
<li><code>localEnabled</code>ï¼šæ§åˆ¶å¼€å‘ç¯å¢ƒæ˜¯å¦å¯ç”¨mockæœåŠ¡ï¼Œè®¾ä¸ºtrueå³å¯åœ¨å¼€å‘æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ¥å£ï¼›</li>
<li><code>prodEnabled</code>ï¼šç”Ÿäº§ç¯å¢ƒéœ€ç¦ç”¨mockï¼Œé¿å…æ¨¡æ‹Ÿæ•°æ®å¹²æ‰°çœŸå®æ¥å£ã€‚</li>
</ul>
<h3 data-id="heading-13">3.3 mockjsè¯­æ³•ä¸æ¥å£æ¨¡æ‹Ÿå®ç°</h3>
<h4 data-id="heading-14">3.3.1 mockæ–‡ä»¶ç»“æ„è§„èŒƒ</h4>
<p>åœ¨mockç›®å½•ä¸‹åˆ›å»º<code>posts.js</code>æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰å¸–å­åˆ—è¡¨æ¥å£çš„æ¨¡æ‹Ÿè§„åˆ™ã€‚mockjsçš„æ ¸å¿ƒè¯­æ³•åŒ…æ‹¬â€œæ•°æ®æ¨¡æ¿å®šä¹‰â€ä¸â€œæ¥å£é…ç½®â€ä¸¤éƒ¨åˆ†ã€‚</p>
<h4 data-id="heading-15">3.3.2 æ•°æ®æ¨¡æ¿å®šä¹‰ï¼šç”Ÿæˆéšæœºæµ‹è¯•æ•°æ®</h4>
<p>mockjsé€šè¿‡ç‰¹å®šè¯­æ³•ç”Ÿæˆéšæœºæ•°æ®ï¼Œæ”¯æŒä¸­æ–‡ã€æ•°å­—ã€æ—¥æœŸã€å›¾ç‰‡ç­‰å¤šç§ç±»å‹ï¼Œæ ¸å¿ƒè¯­æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>'å±æ€§å|è§„åˆ™': å€¼</code>ï¼šå®šä¹‰æ•°æ®ç”Ÿæˆè§„åˆ™ï¼Œå¦‚<code>'list|45': []</code>è¡¨ç¤ºç”Ÿæˆé•¿åº¦ä¸º45çš„listæ•°ç»„ï¼›</li>
<li>å ä½ç¬¦<code>@xxx</code>ï¼šç”Ÿæˆéšæœºæ•°æ®ï¼Œå¦‚<code>@ctitle(8,20)</code>ç”Ÿæˆ8-20å­—çš„ä¸­æ–‡æ ‡é¢˜ï¼Œ<code>@integer(1,30)</code>ç”Ÿæˆ1-30çš„éšæœºæ•´æ•°ï¼›</li>
<li>è‡ªå®šä¹‰å‡½æ•°ï¼šå¯é€šè¿‡å‡½æ•°è¿”å›åŠ¨æ€æ•°æ®ï¼Œå¦‚tagså­—æ®µé€šè¿‡<code>() =&gt; Mock.Random.pick(tags,2)</code>ä»æ ‡ç­¾æ•°ç»„ä¸­éšæœºé€‰å–2ä¸ªã€‚</li>
</ul>
<p>å¸–å­åˆ—è¡¨æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Mock</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'mockjs'</span>
<span class="hljs-keyword">const</span> tags = [<span class="hljs-string">'å‰ç«¯'</span>,<span class="hljs-string">'åç«¯'</span>,<span class="hljs-string">'èŒåœº'</span>,<span class="hljs-string">'AI'</span>,<span class="hljs-string">'å‰¯ä¸š'</span>,<span class="hljs-string">'é¢ç»'</span>,<span class="hljs-string">'ç®—æ³•'</span>];
<span class="hljs-keyword">const</span> posts = <span class="hljs-title class_">Mock</span>.<span class="hljs-title function_">mock</span>({
    <span class="hljs-string">'list|45'</span>:[ <span class="hljs-comment">// ç”Ÿæˆ45æ¡å¸–å­æ•°æ®</span>
        {
            <span class="hljs-attr">title</span>: <span class="hljs-string">'@ctitle(8,20)'</span>, <span class="hljs-comment">// ä¸­æ–‡æ ‡é¢˜ï¼ˆ8-20å­—ï¼‰</span>
            <span class="hljs-attr">brief</span>: <span class="hljs-string">'@ctitle(20,100)'</span>, <span class="hljs-comment">// ä¸­æ–‡æ‘˜è¦ï¼ˆ20-100å­—ï¼‰</span>
            <span class="hljs-attr">totalComments</span>: <span class="hljs-string">'@integer(1,30)'</span>, <span class="hljs-comment">// è¯„è®ºæ•°ï¼ˆ1-30ï¼‰</span>
            <span class="hljs-attr">totalLikes</span>: <span class="hljs-string">'@integer(0,500)'</span>, <span class="hljs-comment">// ç‚¹èµæ•°ï¼ˆ0-500ï¼‰</span>
            <span class="hljs-attr">publishedAt</span>: <span class="hljs-string">'@datetime("yyyy-MM-dd HH:mm:ss")'</span>, <span class="hljs-comment">// å‘å¸ƒæ—¶é—´</span>
            <span class="hljs-attr">user</span>: {
                <span class="hljs-attr">id</span>: <span class="hljs-string">'@integer(1,100)'</span>,
                <span class="hljs-attr">name</span>: <span class="hljs-string">'@cname()'</span>, <span class="hljs-comment">// ä¸­æ–‡å§“å</span>
                <span class="hljs-attr">avatar</span>: <span class="hljs-string">'@image(300x200)'</span> <span class="hljs-comment">// éšæœºå›¾ç‰‡ï¼ˆ300x200ï¼‰</span>
            },
            <span class="hljs-attr">tags</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Mock</span>.<span class="hljs-property">Random</span>.<span class="hljs-title function_">pick</span>(tags,<span class="hljs-number">2</span>), <span class="hljs-comment">// éšæœº2ä¸ªæ ‡ç­¾</span>
            <span class="hljs-attr">thumbnail</span>: <span class="hljs-string">'@image(300x200)'</span>, <span class="hljs-comment">// ç¼©ç•¥å›¾</span>
            <span class="hljs-attr">pics</span>: [
                <span class="hljs-string">'@image(300x200)'</span>,
                <span class="hljs-string">'@image(300x200)'</span>,
                <span class="hljs-string">'@image(300x200)'</span>,
            ],
            <span class="hljs-attr">id</span>: <span class="hljs-string">'@integer(1,1000000)'</span>, <span class="hljs-comment">// å”¯ä¸€ID</span>
        }
    ]
}).<span class="hljs-property">list</span>; <span class="hljs-comment">// æå–listæ•°ç»„</span>
</code></pre>
<h4 data-id="heading-16">3.3.3 æ¥å£é…ç½®ï¼šæ‹¦æˆªè¯·æ±‚å¹¶è¿”å›æ•°æ®</h4>
<p>é€šè¿‡é…ç½®urlã€methodã€responseï¼Œå®ç°å¯¹æŒ‡å®šæ¥å£çš„æ‹¦æˆªä¸å“åº”ã€‚æ ¸å¿ƒé€»è¾‘åŒ…æ‹¬è¯·æ±‚å‚æ•°è§£æã€åˆ†é¡µå¤„ç†ã€å“åº”æ ¼å¼è¿”å›ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
    {
        url: <span class="hljs-string">'/api/posts'</span>, <span class="hljs-comment">// åŒ¹é…å‰ç«¯è¯·æ±‚çš„URLï¼ˆéœ€ä¸axiosè¯·æ±‚è·¯å¾„ä¸€è‡´ï¼‰</span>
        method: <span class="hljs-string">'get'</span>, <span class="hljs-comment">// è¯·æ±‚æ–¹æ³•ï¼ˆGET/POSTç­‰ï¼‰</span>
        <span class="hljs-comment">// responseå‡½æ•°ï¼šå¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”æ•°æ®</span>
        response: ({ query }, res) =&gt; {
            console.<span class="hljs-built_in">log</span>(query); <span class="hljs-comment">// æ‰“å°è¯·æ±‚å‚æ•°ï¼ˆpageã€limitï¼‰</span>
            <span class="hljs-type">const</span> { page = <span class="hljs-string">'1'</span> , limit = <span class="hljs-string">'10'</span> } = query;
            <span class="hljs-comment">// å°†å­—ç¬¦ä¸²å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼ˆå‰ç«¯ä¼ å‚å¯èƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œéœ€å¤„ç†ç±»å‹ï¼‰</span>
            <span class="hljs-type">const</span> currentPage = <span class="hljs-built_in">Number</span>(page, <span class="hljs-number">10</span>);
            <span class="hljs-type">const</span> size = <span class="hljs-built_in">parseInt</span>(limit, <span class="hljs-number">10</span>);
            
            <span class="hljs-comment">// å‚æ•°åˆæ³•æ€§æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isNaN</span>(currentPage) || <span class="hljs-built_in">isNaN</span>(size) || currentPage &lt; <span class="hljs-number">1</span> || size &lt; <span class="hljs-number">1</span>){
                <span class="hljs-keyword">return</span> {
                    code: <span class="hljs-number">400</span>,
                    msg: <span class="hljs-string">'Invalid page or pageSize'</span>,
                    data: null
                };
            }

            <span class="hljs-comment">// åˆ†é¡µé€»è¾‘è®¡ç®—</span>
            <span class="hljs-type">const</span> total = posts.length; <span class="hljs-comment">// æ€»æ•°æ®é‡</span>
            <span class="hljs-type">const</span> start = (currentPage - <span class="hljs-number">1</span>) * size; <span class="hljs-comment">// èµ·å§‹ç´¢å¼•</span>
            <span class="hljs-type">const</span> end = start + size; <span class="hljs-comment">// ç»“æŸç´¢å¼•</span>
            <span class="hljs-type">const</span> paginatedData = posts.<span class="hljs-built_in">slice</span>(start, end); <span class="hljs-comment">// æˆªå–å½“å‰é¡µæ•°æ®</span>

            <span class="hljs-comment">// è¿”å›å“åº”ç»“æœï¼ˆä¸åç«¯æ¥å£æ ¼å¼ä¸€è‡´ï¼‰</span>
            <span class="hljs-keyword">return</span> {
                code: <span class="hljs-number">200</span>,
                msg: <span class="hljs-string">'success'</span>,
                items: paginatedData,
                pagination: {
                    current: currentPage,
                    limit: size,
                    total,
                    totalPages: Math.<span class="hljs-built_in">ceil</span>(total / size), <span class="hljs-comment">// æ€»é¡µæ•°</span>
                }
            };
        }
    }
];
</code></pre>
<p>æ¥å£æ¨¡æ‹Ÿå…³é”®è¦ç‚¹ï¼š</p>
<ul>
<li><strong>URLåŒ¹é…</strong>ï¼šurléœ€ä¸axiosè¯·æ±‚çš„URLå®Œå…¨ä¸€è‡´ï¼ˆå«baseURLå‰ç¼€ï¼‰ï¼Œç¡®ä¿è¯·æ±‚è¢«æ­£ç¡®æ‹¦æˆªï¼›</li>
<li><strong>å‚æ•°å¤„ç†</strong>ï¼šGETè¯·æ±‚å‚æ•°ä»queryä¸­è·å–ï¼Œéœ€æ³¨æ„ç±»å‹è½¬æ¢ï¼ˆå‰ç«¯ä¼ å‚å¯èƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œéœ€è½¬ä¸ºæ•°å­—ï¼‰ï¼ŒåŒæ—¶è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œè¿”å›å¯¹åº”é”™è¯¯ä¿¡æ¯ï¼›</li>
<li><strong>åˆ†é¡µé€»è¾‘</strong>ï¼šé€šè¿‡sliceæ–¹æ³•æˆªå–å½“å‰é¡µæ•°æ®ï¼Œè®¡ç®—æ€»é¡µæ•°ï¼Œè¿”å›åˆ†é¡µä¿¡æ¯ï¼Œä¾¿äºå‰ç«¯å®ç°åˆ†é¡µåŠ è½½ï¼›</li>
<li><strong>å“åº”æ ¼å¼ç»Ÿä¸€</strong>ï¼šä¸åç«¯çº¦å®šå¥½å“åº”æ ¼å¼ï¼ˆcodeã€msgã€data/itemsã€paginationï¼‰ï¼Œç¡®ä¿åˆ‡æ¢çœŸå®æ¥å£æ—¶æ— éœ€ä¿®æ”¹å‰ç«¯é€»è¾‘ã€‚</li>
</ul>
<h3 data-id="heading-17">3.4 mockjsè¿›é˜¶ç”¨æ³•æ‰©å±•</h3>
<ul>
<li><strong>å¤šç§è¯·æ±‚æ–¹æ³•æ”¯æŒ</strong>ï¼šå¯é…ç½®POSTã€PUTã€DELETEç­‰æ–¹æ³•çš„æ¥å£ï¼ŒPOSTè¯·æ±‚å‚æ•°ä»bodyä¸­è·å–ï¼ˆ<code>({ body }, res) =&gt; {}</code>ï¼‰ï¼›</li>
<li><strong>åŠ¨æ€æ•°æ®ç”Ÿæˆ</strong>ï¼šå¯æ ¹æ®è¯·æ±‚å‚æ•°åŠ¨æ€ç”Ÿæˆæ•°æ®ï¼Œå¦‚æ ¹æ®ç”¨æˆ·IDè¿”å›å¯¹åº”ç”¨æˆ·çš„å¸–å­ï¼›</li>
<li><strong>å¼‚å¸¸åœºæ™¯æ¨¡æ‹Ÿ</strong>ï¼šé™¤äº†æ­£å¸¸å“åº”ï¼Œè¿˜å¯æ¨¡æ‹Ÿ401ï¼ˆæœªæˆæƒï¼‰ã€404ï¼ˆæ¥å£ä¸å­˜åœ¨ï¼‰ã€500ï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰ç­‰çŠ¶æ€ï¼Œæµ‹è¯•å‰ç«¯é”™è¯¯å¤„ç†é€»è¾‘ã€‚</li>
</ul>
<h2 data-id="heading-18">å››ã€Post Listï¼šæ•°æ®çŠ¶æ€ç®¡ç†ä¸é¡µé¢æ¸²æŸ“</h2>
<h3 data-id="heading-19">4.1 TypeScriptç±»å‹å®šä¹‰</h3>
<p>ä¸ºå®ç°ç±»å‹å®‰å…¨ï¼Œéœ€å®šä¹‰Postã€Useræ¥å£ï¼Œæ˜ç¡®æ•°æ®ç»“æ„ã€‚ä»£ç ä½äº<code>src/types/index.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span>{
    <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
    avatar?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å¯é€‰å±æ€§ï¼ˆ?è¡¨ç¤ºï¼‰</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Post</span>{
    <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">brief</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ç®€ä»‹</span>
    <span class="hljs-attr">publishedAt</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å‘å¸ƒæ—¶é—´</span>
    totalLikes?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ç‚¹èµæ•°ï¼ˆå¯é€‰ï¼‰</span>
    totalComments?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// è¯„è®ºæ•°ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-attr">user</span>: <span class="hljs-title class_">User</span>; <span class="hljs-comment">// å…³è”Useræ¥å£</span>
    <span class="hljs-attr">tags</span>: <span class="hljs-built_in">string</span>[]; <span class="hljs-comment">// æ ‡ç­¾æ•°ç»„</span>
    thumbnail?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ç¼©ç•¥å›¾ï¼ˆå¯é€‰ï¼‰</span>
    pics?: <span class="hljs-built_in">string</span>[]; <span class="hljs-comment">// å›¾ç‰‡æ•°ç»„ï¼ˆå¯é€‰ï¼‰</span>
}
</code></pre>
<p>ç±»å‹å®šä¹‰è¦ç‚¹ï¼š</p>
<ul>
<li>å¿…å¡«å±æ€§ç›´æ¥å®šä¹‰ç±»å‹ï¼Œå¯é€‰å±æ€§æ·»åŠ <code>?</code>ï¼›</li>
<li>å…³è”æ¥å£ï¼ˆå¦‚Postä¸­çš„userå±æ€§å…³è”Userï¼‰ï¼Œå®ç°æ•°æ®ç»“æ„çš„åµŒå¥—çº¦æŸï¼›</li>
<li>æ‰€æœ‰æ¥å£ç±»å‹éœ€ä¸mockæ•°æ®ã€åç«¯æ¥å£è¿”å›æ•°æ®ä¿æŒä¸€è‡´ï¼Œé¿å…ç±»å‹ä¸åŒ¹é…é”™è¯¯ã€‚</li>
</ul>
<h3 data-id="heading-20">4.2 Zustandå…¨å±€çŠ¶æ€ç®¡ç†</h3>
<p>Zustandæ˜¯ä¸€æ¬¾è½»é‡çº§çŠ¶æ€ç®¡ç†åº“ï¼Œç›¸æ¯”Reduxæ›´ç®€æ´ï¼Œæ— éœ€ProvideråŒ…è£¹ï¼Œé€‚åˆä¸­å°å‹é¡¹ç›®ã€‚æœ¬æ–‡ç”¨å…¶å­˜å‚¨å¸–å­åˆ—è¡¨æ•°æ®ã€è½®æ’­å›¾æ•°æ®åŠåŠ è½½æ–¹æ³•ã€‚</p>
<h4 data-id="heading-21">4.2.1 çŠ¶æ€å®šä¹‰ä¸å®ç°</h4>
<p>ä»£ç ä½äº<code>src/store/home.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">"zustand"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">SlideData</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/SlideShow"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Post</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/types"</span>;
<span class="hljs-keyword">import</span> { fetchPosts } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/api/posts"</span>;

<span class="hljs-comment">// å®šä¹‰çŠ¶æ€æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">HomeState</span> {
    <span class="hljs-attr">banners</span>: <span class="hljs-title class_">SlideData</span>[]; <span class="hljs-comment">// è½®æ’­å›¾æ•°æ®</span>
    <span class="hljs-attr">posts</span>: <span class="hljs-title class_">Post</span>[]; <span class="hljs-comment">// å¸–å­åˆ—è¡¨æ•°æ®</span>
    <span class="hljs-attr">loadMore</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;; <span class="hljs-comment">// åŠ è½½æ›´å¤šæ–¹æ³•ï¼ˆåˆ†é¡µåŠ è½½ï¼‰</span>
}

<span class="hljs-comment">// åˆ›å»ºçŠ¶æ€ç®¡ç†å®ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useHomeStore = create&lt;<span class="hljs-title class_">HomeState</span>&gt;(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
    <span class="hljs-comment">// åˆå§‹è½®æ’­å›¾æ•°æ®</span>
    <span class="hljs-attr">banners</span>: [{
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"React ç”Ÿæ€ç³»ç»Ÿ"</span>,
      <span class="hljs-attr">image</span>: <span class="hljs-string">"https://images.unsplash.com/photo-1633356122544-f134324a6cee?q=80&amp;w=2070&amp;auto=format&amp;fit=crop"</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"ç§»åŠ¨ç«¯å¼€å‘æœ€ä½³å®è·µ"</span>,
      <span class="hljs-attr">image</span>: <span class="hljs-string">"https://img.36krcdn.com/hsossms/20260114/v2_1ddcc36679304d3390dd9b8545eaa57f@5091053@ai_oswg1012730oswg1053oswg495_img_png~tplv-1marlgjv7f-ai-v3:600:400:600:400:q70.jpg?x-oss-process=image/format,webp"</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"ç™¾åº¦ä¸Šçº¿ä¸ƒçŒ«æ¼«å‰§ï¼Œæ‰“çš„ä»€ä¹ˆä¸»æ„ï¼Ÿ"</span>,
      <span class="hljs-attr">image</span>: <span class="hljs-string">"https://img.36krcdn.com/hsossms/20260114/v2_8dc528b02ded4f73b29b7c1019f8963a@5091053@ai_oswg1137571oswg1053oswg495_img_png~tplv-1marlgjv7f-ai-v3:600:400:600:400:q70.jpg?x-oss-process=image/format,webp"</span>,
    }],
    <span class="hljs-comment">// åˆå§‹å¸–å­åˆ—è¡¨ä¸ºç©º</span>
    <span class="hljs-attr">posts</span>: [],
    <span class="hljs-comment">// åŠ è½½æ›´å¤šæ–¹æ³•ï¼ˆå¼‚æ­¥ï¼‰</span>
    <span class="hljs-attr">loadMore</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> { items } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPosts</span>();
      <span class="hljs-comment">// æ›´æ–°çŠ¶æ€ï¼šå°†æ–°è·å–çš„å¸–å­æ•°æ®è¿½åŠ åˆ°postsä¸­ï¼ˆåˆ†é¡µåŠ è½½é€»è¾‘ï¼‰</span>
      <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">posts</span>: [...state.<span class="hljs-property">posts</span>, ...items] }));
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(items);
    }
}));
</code></pre>
<p>çŠ¶æ€ç®¡ç†æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li><strong>çŠ¶æ€æ¥å£å®šä¹‰</strong>ï¼šé€šè¿‡HomeStateæ¥å£çº¦æŸçŠ¶æ€çš„ç»“æ„ä¸ç±»å‹ï¼Œç¡®ä¿çŠ¶æ€æ•°æ®åˆè§„ï¼›</li>
<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼šbannersè®¾ç½®åˆå§‹è½®æ’­å›¾æ•°æ®ï¼Œpostsåˆå§‹ä¸ºç©ºæ•°ç»„ï¼›</li>
<li><strong>å¼‚æ­¥æ–¹æ³•</strong>ï¼šloadMoreä¸ºå¼‚æ­¥æ–¹æ³•ï¼Œè°ƒç”¨fetchPostsè·å–å¸–å­æ•°æ®ï¼Œé€šè¿‡setæ–¹æ³•æ›´æ–°çŠ¶æ€ã€‚setæ–¹æ³•æ”¯æŒå‡½æ•°å‚æ•°ï¼Œå¯è·å–å½“å‰çŠ¶æ€ï¼Œå®ç°æ•°æ®è¿½åŠ ï¼ˆåˆ†é¡µåŠ è½½æ ¸å¿ƒé€»è¾‘ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-22">4.3 é¡µé¢æ¸²æŸ“ä¸æ•°æ®è”åŠ¨</h3>
<p>é¦–é¡µç»„ä»¶ï¼ˆ<code>src/pages/Home.tsx</code>ï¼‰ä»çŠ¶æ€ä¸­è¯»å–æ•°æ®ï¼Œæ¸²æŸ“è½®æ’­å›¾ã€å¸–å­åˆ—è¡¨ï¼Œå¹¶åœ¨ç»„ä»¶åŠ è½½æ—¶è§¦å‘æ•°æ®åŠ è½½ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Header</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/Header"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SlideShow</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/SlideShow"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Card</span>, <span class="hljs-title class_">CardHeader</span>, <span class="hljs-title class_">CardTitle</span>, <span class="hljs-title class_">CardContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/card"</span>;
<span class="hljs-keyword">import</span> { useHomeStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/home"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä»çŠ¶æ€ä¸­è§£æ„æ•°æ®ä¸æ–¹æ³•</span>
    <span class="hljs-keyword">const</span> { banners, posts, loadMore } = <span class="hljs-title function_">useHomeStore</span>();
    
    <span class="hljs-comment">// ç»„ä»¶æŒ‚è½½æ—¶è§¦å‘åŠ è½½æ›´å¤šï¼ˆè·å–ç¬¬ä¸€é¡µæ•°æ®ï¼‰</span>
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">loadMore</span>();
    }, []); <span class="hljs-comment">// ç©ºä¾èµ–æ•°ç»„ï¼Œä»…åœ¨ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡</span>
    
    <span class="hljs-keyword">return</span> ( 
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"é¦–é¡µ"</span> <span class="hljs-attr">showBackButton</span>=<span class="hljs-string">{true}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"p-4 space-y-4 "</span>&gt;</span>
            {/* è½®æ’­å›¾ç»„ä»¶ï¼Œä¼ å…¥bannersæ•°æ® */}
            <span class="hljs-tag">&lt;<span class="hljs-name">SlideShow</span> <span class="hljs-attr">slides</span>=<span class="hljs-string">{banners}</span> /&gt;</span>
            {/* æ¬¢è¿å¡ç‰‡ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">Card</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">CardHeader</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">CardTitle</span>&gt;</span>æ¬¢è¿æ¥åˆ°React Mobile<span class="hljs-tag">&lt;/<span class="hljs-name">CardTitle</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">CardHeader</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">CardContent</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-muted-foreground"</span>&gt;</span>è¿™æ˜¯å†…å®¹åŒºåŸŸ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">CardContent</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
            {/* å¸–å­åˆ—è¡¨ç½‘æ ¼å¸ƒå±€ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid grid-cols-2 gap-4"</span>&gt;</span>
                {/* éå†postsæ•°æ®æ¸²æŸ“å¸–å­å¡ç‰‡ï¼ˆå½“å‰ä¸ºå ä½ï¼Œå¯æ›¿æ¢ä¸ºçœŸå®å¸–å­ç»„ä»¶ï¼‰ */}
                {posts.map((post) =&gt; (
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{post.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"h-32 bg-white rounded-lg shadow-sm flex items-center justify-center border "</span>&gt;</span>
                        {post.title}
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                ))}
                {/* åŸå ä½æ•°æ®ï¼Œå¯åˆ é™¤ï¼Œæ›¿æ¢ä¸ºçœŸå®æ•°æ®æ¸²æŸ“ */}
                {/* {[1,2,...,25].map((i,index) =&gt; (...))} */}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
    );
}
</code></pre>
<p>é¡µé¢æ¸²æŸ“å…³é”®è¦ç‚¹ï¼š</p>
<ul>
<li><strong>çŠ¶æ€è®¢é˜…</strong>ï¼šé€šè¿‡useHomeStoreé’©å­è®¢é˜…çŠ¶æ€ï¼Œå½“postsã€bannerså‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ï¼›</li>
<li><strong>æ•°æ®åŠ è½½æ—¶æœº</strong>ï¼šé€šè¿‡useEffectåœ¨ç»„ä»¶æŒ‚è½½æ—¶è°ƒç”¨loadMoreï¼Œè·å–ç¬¬ä¸€é¡µå¸–å­æ•°æ®ï¼›</li>
<li><strong>åˆ—è¡¨æ¸²æŸ“</strong>ï¼šä½¿ç”¨mapéå†postsæ•°ç»„æ¸²æŸ“åˆ—è¡¨ï¼Œéœ€æŒ‡å®šå”¯ä¸€keyï¼ˆpost.idï¼‰ï¼Œé¿å…Reactæ¸²æŸ“è­¦å‘Šã€‚åŸä»£ç ä¸­çš„å ä½æ•°æ®å¯æ›¿æ¢ä¸ºçœŸå®å¸–å­ç»„ä»¶ï¼Œå±•ç¤ºå¸–å­æ ‡é¢˜ã€ç¼©ç•¥å›¾ç­‰ä¿¡æ¯ï¼›</li>
<li><strong>æ ·å¼ä¸å¸ƒå±€</strong>ï¼šé€šè¿‡TailwindCSSå®ç°ç½‘æ ¼å¸ƒå±€ï¼ˆgrid-cols-2ï¼‰ã€é—´è·æ§åˆ¶ï¼ˆspace-y-4ã€gap-4ï¼‰ï¼Œé€‚é…ç§»åŠ¨ç«¯å±•ç¤ºã€‚</li>
</ul>
<h2 data-id="heading-23">äº”ã€æ ¸å¿ƒæŠ€æœ¯æ•´åˆä¸å®æˆ˜æ€»ç»“</h2>
<h3 data-id="heading-24">5.1 æŠ€æœ¯æ•´åˆå…³é”®ç‚¹</h3>
<ul>
<li><strong>æ¥å£ä¸€è‡´æ€§</strong>ï¼šmockæ•°æ®æ ¼å¼ã€TypeScriptæ¥å£ã€åç«¯æ¥å£æ–‡æ¡£ä¸‰è€…å¿…é¡»ä¿æŒä¸€è‡´ï¼Œè¿™æ˜¯å®ç°â€œæ— ç¼åˆ‡æ¢â€çš„æ ¸å¿ƒå‰æï¼›</li>
<li><strong>åˆ†å±‚è®¾è®¡</strong>ï¼šè¯·æ±‚å±‚ï¼ˆaxiosï¼‰ã€æ¨¡æ‹Ÿæ•°æ®å±‚ï¼ˆmockjsï¼‰ã€çŠ¶æ€å±‚ï¼ˆZustandï¼‰ã€è§†å›¾å±‚ï¼ˆé¡µé¢ç»„ä»¶ï¼‰åˆ†å±‚æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤ä¸æ‰©å±•ï¼›</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå…¨ç¨‹ä½¿ç”¨TypeScriptå®šä¹‰ç±»å‹ï¼Œä»è¯·æ±‚å‚æ•°ã€å“åº”æ•°æ®åˆ°çŠ¶æ€ç®¡ç†ã€ç»„ä»¶Propsï¼Œé¿å…æ•°æ®å¼‚å¸¸å¯¼è‡´çš„bugï¼›</li>
<li><strong>å¼€å‘æ•ˆç‡</strong>ï¼šmockjsä½¿å‰ç«¯ç‹¬ç«‹å¼€å‘ï¼Œæ— éœ€ä¾èµ–åç«¯ï¼ŒViteæ’ä»¶é›†æˆç®€åŒ–é…ç½®ï¼ŒZustandå‡å°‘çŠ¶æ€ç®¡ç†å†—ä½™ä»£ç ï¼Œæ•´ä½“æå‡å¼€å‘æ•ˆç‡ã€‚</li>
</ul>
<h3 data-id="heading-25">5.2 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>mockè¯·æ±‚æ‹¦æˆªå¤±è´¥</strong>ï¼šæ£€æŸ¥mockæ–‡ä»¶è·¯å¾„æ˜¯å¦ä¸vite.config.tsä¸­mockPathé…ç½®ä¸€è‡´ï¼ŒURLæ˜¯å¦ä¸axiosè¯·æ±‚è·¯å¾„å®Œå…¨åŒ¹é…ï¼Œç¡®ä¿localEnabledè®¾ä¸ºtrueï¼›</li>
<li><strong>ç±»å‹ä¸åŒ¹é…é”™è¯¯</strong>ï¼šæ£€æŸ¥TypeScriptæ¥å£å®šä¹‰ä¸mockæ•°æ®ã€å“åº”æ•°æ®æ˜¯å¦ä¸€è‡´ï¼Œç¡®ä¿å¯é€‰å±æ€§ã€åµŒå¥—ç»“æ„æ­£ç¡®ï¼›</li>
<li><strong>åˆ†é¡µé€»è¾‘å¼‚å¸¸</strong>ï¼šç¡®è®¤pageã€limitå‚æ•°ç±»å‹è½¬æ¢æ­£ç¡®ï¼Œåˆ†é¡µè®¡ç®—å…¬å¼ï¼ˆstart = (currentPage-1)*sizeï¼‰æ— è¯¯ï¼Œsliceæ–¹æ³•æˆªå–èŒƒå›´æ­£ç¡®ï¼›</li>
<li><strong>çŠ¶æ€æ›´æ–°åç»„ä»¶ä¸æ¸²æŸ“</strong>ï¼šç¡®ä¿é€šè¿‡Zustandçš„setæ–¹æ³•æ›´æ–°çŠ¶æ€ï¼Œä¸”ç»„ä»¶æ­£ç¡®è®¢é˜…çŠ¶æ€ï¼ˆä½¿ç”¨useHomeStoreé’©å­è§£æ„æ•°æ®ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-26">5.3 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>åˆ‡æ¢axiosçš„baseURLä¸ºåç«¯çœŸå®æ¥å£åœ°å€ï¼Œç¦ç”¨mockæœåŠ¡ï¼ˆprodEnabled: falseï¼‰ï¼›</li>
<li>å®Œå–„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œæ·»åŠ ç”¨æˆ·å¯æ„ŸçŸ¥çš„é”™è¯¯æç¤ºï¼ˆå¦‚Toastç»„ä»¶ï¼‰ï¼Œæ›¿ä»£æ§åˆ¶å°æ‰“å°ï¼›</li>
<li>ä¼˜åŒ–è¯·æ±‚æ€§èƒ½ï¼Œå¦‚æ·»åŠ è¯·æ±‚ç¼“å­˜ã€é˜²æŠ–èŠ‚æµï¼ˆé’ˆå¯¹ä¸‹æ‹‰åŠ è½½æ›´å¤šï¼‰ã€è¶…æ—¶é‡è¿ç­‰ï¼›</li>
<li>æ ¡éªŒåç«¯æ¥å£è¿”å›æ•°æ®ï¼Œå¤„ç†å¼‚å¸¸çŠ¶æ€ç ï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒæ•°æ®ç¨³å®šæ€§ã€‚</li>
</ul>
<h2 data-id="heading-27">å…­ã€æ‰©å±•å­¦ä¹ ä¸è¿›é˜¶æ–¹å‘</h2>
<ul>
<li><strong>axiosè¿›é˜¶</strong>ï¼šå­¦ä¹ è¯·æ±‚å–æ¶ˆï¼ˆå¦‚é¡µé¢å¸è½½æ—¶å–æ¶ˆæœªå®Œæˆè¯·æ±‚ï¼‰ã€è¯·æ±‚é‡è¯•ã€ä¸Šä¼ ä¸‹è½½è¿›åº¦ç›‘æ§ç­‰é«˜çº§åŠŸèƒ½ï¼›</li>
<li><strong>mockjsæ‰©å±•</strong>ï¼šä½¿ç”¨mockjsç»“åˆJSON5è¯­æ³•ç¼–å†™æ›´å¤æ‚çš„æ¨¡æ‹Ÿè§„åˆ™ï¼Œé›†æˆmockæ•°æ®æŒä¹…åŒ–ï¼ˆå¦‚localStorageï¼‰ï¼›</li>
<li><strong>çŠ¶æ€ç®¡ç†æ·±åŒ–</strong>ï¼šå­¦ä¹ Zustandçš„ä¸­é—´ä»¶ï¼ˆå¦‚æ—¥å¿—ã€æŒä¹…åŒ–ï¼‰ï¼Œå¯¹æ¯”Reduxã€Piniaç­‰çŠ¶æ€ç®¡ç†åº“çš„é€‚ç”¨åœºæ™¯ï¼›</li>
<li><strong>åˆ†é¡µä¸æ— é™æ»šåŠ¨</strong>ï¼šåŸºäºå½“å‰åˆ†é¡µé€»è¾‘ï¼Œå®ç°ä¸‹æ‹‰åŠ è½½æ›´å¤šã€ä¸Šæ‹‰åˆ·æ–°åŠŸèƒ½ï¼Œé›†æˆç¬¬ä¸‰æ–¹ç»„ä»¶ï¼ˆå¦‚react-infinite-scroll-componentï¼‰ï¼›</li>
<li><strong>æ¥å£è”è°ƒä¸æµ‹è¯•</strong>ï¼šå­¦ä¹ ä½¿ç”¨Postmanã€Swaggerç­‰å·¥å…·æµ‹è¯•åç«¯æ¥å£ï¼Œå®ç°å‰ç«¯ä¸åç«¯çš„é«˜æ•ˆè”è°ƒã€‚</li>
</ul>
<p>æœ¬æ–‡é€šè¿‡å®æˆ˜ä»£ç æ‹†è§£ï¼Œç³»ç»Ÿè®²è§£äº†Post ListåŠŸèƒ½å¼€å‘ä¸­axiosã€mockjsçš„æ ¸å¿ƒç”¨æ³•åŠçŠ¶æ€ç®¡ç†ã€é¡µé¢æ¸²æŸ“çš„å®Œæ•´æµç¨‹ã€‚æŒæ¡è¿™äº›çŸ¥è¯†ï¼Œå¯å¿«é€Ÿæ­å»ºå‰ç«¯é¡¹ç›®çš„æ•°æ®å±‚æ¶æ„ï¼Œå®ç°å‰åç«¯åˆ†ç¦»æ¨¡å¼ä¸‹çš„é«˜æ•ˆå¼€å‘ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéœ€ç»“åˆä¸šåŠ¡éœ€æ±‚çµæ´»æ‰©å±•ï¼Œä¸æ–­ä¼˜åŒ–ä»£ç è´¨é‡ä¸ç”¨æˆ·ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[pythontutor - ä»£ç å¯è§†åŒ–æ¢ç´¢ï¼šé“¾è¡¨ã€å¼‚å¸¸ä¸æ§åˆ¶æµçš„åŠ¨æ€æ¼”ç¤º]]></title>    <link>https://juejin.cn/post/7598499504170893350</link>    <guid>https://juejin.cn/post/7598499504170893350</guid>    <pubDate>2026-01-24T08:12:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598499504170893350" data-draft-id="7598818096728866854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="pythontutor - ä»£ç å¯è§†åŒ–æ¢ç´¢ï¼šé“¾è¡¨ã€å¼‚å¸¸ä¸æ§åˆ¶æµçš„åŠ¨æ€æ¼”ç¤º"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-24T08:12:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="pe7er"/> <meta itemprop="url" content="https://juejin.cn/user/905653310988445"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            pythontutor - ä»£ç å¯è§†åŒ–æ¢ç´¢ï¼šé“¾è¡¨ã€å¼‚å¸¸ä¸æ§åˆ¶æµçš„åŠ¨æ€æ¼”ç¤º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653310988445/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    pe7er
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:12:21.000Z" title="Sat Jan 24 2026 08:12:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PythonTutor æ˜¯ä»€ä¹ˆ</h2>
<p>PythonTutor æ˜¯ä¸€ä¸ªç”¨äºå±•ç¤ºä»£ç æ‰§è¡Œè¿‡ç¨‹çš„å¯è§†åŒ–å­¦ä¹ å·¥å…·ã€‚å®ƒå…³æ³¨çš„ä¸æ˜¯ç¨‹åºæœ€ç»ˆè¾“å‡ºçš„ç»“æœï¼Œè€Œæ˜¯ä»£ç åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ¯ä¸€æ­¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€å˜é‡å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­å¦‚ä½•å˜åŒ–ã€‚</p>
<hr/>
<h3 data-id="heading-1">PythonTutor çš„æ ¸å¿ƒä»·å€¼</h3>
<p>PythonTutor ä¼šé€è¡Œæ‰§è¡Œä»£ç ï¼Œå¹¶å®æ—¶å±•ç¤ºï¼š</p>
<ul>
<li>å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç è¡Œ</li>
<li>å˜é‡åœ¨ä¸åŒé˜¶æ®µçš„å–å€¼å˜åŒ–</li>
<li>å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†é…æƒ…å†µ</li>
<li>å¼•ç”¨å…³ç³»ã€æŒ‡é’ˆæŒ‡å‘å’Œè°ƒç”¨æ ˆç»“æ„</li>
</ul>
<p>è¿™ç§æ–¹å¼å¯ä»¥å¸®åŠ©å¼€å‘è€…çœŸæ­£ç†è§£ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ï¼Œè€Œä¸ä»…ä»…æ˜¯â€œè·‘é€šä»£ç â€ã€‚</p>
<hr/>
<h3 data-id="heading-2">å¯è§†åŒ–å˜é‡å’Œå†…å­˜ç»“æ„</h3>
<p>åœ¨å¾ˆå¤šè¯­è¨€ä¸­ï¼Œå˜é‡æœ¬è´¨ä¸Šæ˜¯å¯¹å¯¹è±¡çš„å¼•ç”¨ã€‚ä»…é€šè¿‡æ—¥å¿—æˆ–æ‰“å°è¾“å‡ºï¼Œå¾ˆéš¾ç›´è§‚ç†è§£å¤šä¸ªå˜é‡æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>PythonTutor ä¼šå°†è¿™äº›å…³ç³»ä»¥å›¾å½¢å½¢å¼å±•ç¤ºå‡ºæ¥ï¼Œå°¤å…¶é€‚åˆç†è§£ä»¥ä¸‹æ¦‚å¿µï¼š</p>
<ul>
<li>å¼•ç”¨ä¸å¯¹è±¡çš„å…³ç³»</li>
<li>é“¾è¡¨å’ŒæŒ‡é’ˆç»“æ„</li>
<li>å¯¹è±¡å…±äº«ä¸å‰¯ä½œç”¨</li>
<li>æ ˆä¸å †å†…å­˜çš„å˜åŒ–</li>
</ul>
<hr/>
<h3 data-id="heading-3">Java é“¾è¡¨ç¤ºä¾‹</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´ã€å¯ç›´æ¥è¿è¡Œçš„ Java å•å‘é“¾è¡¨ç¤ºä¾‹ï¼Œé€‚åˆæ”¾å…¥ PythonTutor çš„ Java æ¨¡å¼ä¸­è§‚å¯ŸæŒ‡é’ˆå’Œå¯¹è±¡çš„å˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2765da14261b4fabbfb1dd97a3dd4005~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGU3ZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769847968&amp;x-signature=vyg7qoH%2FTmKLIYXokTHMZz1AXeo%3D" alt="é“¾è¡¨è™šæ‹ŸåŒ–.gif" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span>Â java.util.Objects;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkedListDemo</span> {

    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
        <span class="hljs-type">int</span> value;
        Node next;

        Node(<span class="hljs-type">int</span> value) {
            <span class="hljs-built_in">this</span>.value = value;
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">head</span> <span class="hljs-operator">=</span> buildList();
        printList(head);

        head = delete(head, <span class="hljs-number">2</span>);
        printList(head);

        System.out.println(<span class="hljs-string">"æ˜¯å¦åŒ…å« 3: "</span> + contains(head, <span class="hljs-number">3</span>));
        System.out.println(<span class="hljs-string">"æ˜¯å¦åŒ…å« 5: "</span> + contains(head, <span class="hljs-number">5</span>));

        head = reverse(head);
        printList(head);
    }

    <span class="hljs-keyword">static</span> Node <span class="hljs-title function_">buildList</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">n1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">1</span>);
        <span class="hljs-type">Node</span> <span class="hljs-variable">n2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">2</span>);
        <span class="hljs-type">Node</span> <span class="hljs-variable">n3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">3</span>);
        <span class="hljs-type">Node</span> <span class="hljs-variable">n4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">4</span>);

        n1.next = n2;
        n2.next = n3;
        n3.next = n4;

        <span class="hljs-keyword">return</span> n1;
    }

    <span class="hljs-keyword">static</span> Node <span class="hljs-title function_">delete</span><span class="hljs-params">(Node head, <span class="hljs-type">int</span> target)</span> {
        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">if</span> (head.value == target) {
            <span class="hljs-keyword">return</span> head.next;
        }

        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">while</span> (current.next != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (current.next.value == target) {
                current.next = current.next.next;
                <span class="hljs-keyword">break</span>;
            }
            current = current.next;
        }
        <span class="hljs-keyword">return</span> head;
    }

    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(Node head, <span class="hljs-type">int</span> target)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (current.value == target) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            current = current.next;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">static</span> Node <span class="hljs-title function_">reverse</span><span class="hljs-params">(Node head)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> head;

        <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">Node</span> <span class="hljs-variable">nextTemp</span> <span class="hljs-operator">=</span> current.next;
            current.next = prev;
            prev = current;
            current = nextTemp;
        }
        <span class="hljs-keyword">return</span> prev;
    }

    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printList</span><span class="hljs-params">(Node head)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span>) {
            System.out.print(current.value + <span class="hljs-string">" -&gt; "</span>);
            current = current.next;
        }
        System.out.println(<span class="hljs-string">"null"</span>);
    }
}
</code></pre>
<p>å¤åˆ¶ä¸‹é¢çš„å†…å®¹åœ¨æµè§ˆå™¨åœ°å€è®¿é—®</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">https:</span>//pythontutor.com/render.html#code=import%<span class="hljs-number">20</span>java.util.Objects%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>Apublic%<span class="hljs-number">20</span><span class="hljs-keyword">class</span>%<span class="hljs-number">20L</span>inkedListDemo%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E5%<span class="hljs-number">8</span>D%<span class="hljs-number">95%</span>E9%<span class="hljs-number">93%</span>BE%E8%A1%A8%E8%<span class="hljs-number">8</span>A%<span class="hljs-number">82%</span>E7%<span class="hljs-number">82%</span>B9%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20s</span>tatic%<span class="hljs-number">20</span><span class="hljs-keyword">class</span>%<span class="hljs-number">20</span>Node%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>nt%<span class="hljs-number">20</span>value%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span><span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">28i</span>nt%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>this.value%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>value%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">private</span>%<span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E5%B0%BE%E6%<span class="hljs-number">8</span>F%<span class="hljs-number">92%</span>E6%B3%<span class="hljs-number">95%</span>E6%B7%BB%E5%<span class="hljs-number">8</span>A%A0%E8%<span class="hljs-number">8</span>A%<span class="hljs-number">82%</span>E7%<span class="hljs-number">82%</span>B9%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>add%<span class="hljs-number">28i</span>nt%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>newNode%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span><span class="hljs-built_in">new</span>%<span class="hljs-number">20</span>Node%<span class="hljs-number">28</span>value%<span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28</span>head%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>head%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>newNode%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">20</span>!%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>newNode%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E5%<span class="hljs-number">88%</span>A0%E9%<span class="hljs-number">99%</span>A4%E6%<span class="hljs-number">8</span>C%<span class="hljs-number">87%</span>E5%AE%<span class="hljs-number">9</span>A%E5%<span class="hljs-number">80%</span>BC%E7%<span class="hljs-number">9</span>A%<span class="hljs-number">84%</span>E8%<span class="hljs-number">8</span>A%<span class="hljs-number">82%</span>E7%<span class="hljs-number">82%</span>B9%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>remove%<span class="hljs-number">28i</span>nt%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28</span>head%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28</span>head.value%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>head%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">20</span>!%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur.<span class="hljs-keyword">next</span>.value%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E5%<span class="hljs-number">88%</span>A4%E6%<span class="hljs-number">96%</span>AD%E6%<span class="hljs-number">98%</span>AF%E5%<span class="hljs-number">90%</span>A6%E5%<span class="hljs-number">8</span>C%<span class="hljs-number">85%</span>E5%<span class="hljs-number">90%</span>AB%E6%<span class="hljs-number">9</span>F%<span class="hljs-number">90%</span>E4%B8%AA%E5%<span class="hljs-number">80%</span>BC%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20</span><span class="hljs-type">boolean</span>%<span class="hljs-number">20</span>contains%<span class="hljs-number">28i</span>nt%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur%<span class="hljs-number">20</span>!%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28</span>Objects.<span class="hljs-keyword">equals</span>%<span class="hljs-number">28</span>cur.value,%<span class="hljs-number">20</span>value%<span class="hljs-number">29%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">20</span><span class="hljs-literal">true</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">return</span>%<span class="hljs-number">20</span><span class="hljs-literal">false</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E6%<span class="hljs-number">89%</span><span class="hljs-number">93%</span>E5%<span class="hljs-number">8</span>D%B0%E9%<span class="hljs-number">93%</span>BE%E8%A1%A8%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>print%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur%<span class="hljs-number">20</span>!%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.print%<span class="hljs-number">28</span>cur.value%<span class="hljs-number">20%</span><span class="hljs-number">2</span>B%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">20</span>-%<span class="hljs-number">3</span>E%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22</span>null%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E5%<span class="hljs-number">8</span>F%<span class="hljs-number">8</span>D%E8%BD%AC%E9%<span class="hljs-number">93%</span>BE%E8%A1%A8%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>reverse%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>prev%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>head%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>cur%<span class="hljs-number">20</span>!%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span>null%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>Node%<span class="hljs-number">20</span>nextTemp%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur.<span class="hljs-keyword">next</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>prev%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>prev%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>cur%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>cur%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>nextTemp%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>head%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>prev%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E6%B5%<span class="hljs-number">8</span>B%E8%AF%<span class="hljs-number">95%</span>E5%<span class="hljs-number">85%</span>A5%E5%<span class="hljs-number">8</span>F%A3%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20s</span>tatic%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>main%<span class="hljs-number">28S</span>tring%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">20</span>args%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20L</span>inkedListDemo%<span class="hljs-number">20l</span>ist%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span><span class="hljs-built_in">new</span>%<span class="hljs-number">20L</span>inkedListDemo%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.add%<span class="hljs-number">281%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.add%<span class="hljs-number">282%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.add%<span class="hljs-number">283%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.add%<span class="hljs-number">284%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E5%<span class="hljs-number">8</span>E%<span class="hljs-number">9</span>F%E5%A7%<span class="hljs-number">8</span>B%E9%<span class="hljs-number">93%</span>BE%E8%A1%A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.print%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E5%<span class="hljs-number">88%</span>A0%E9%<span class="hljs-number">99%</span>A4%<span class="hljs-number">202%</span><span class="hljs-number">3</span>A%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.remove%<span class="hljs-number">282%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.print%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E6%<span class="hljs-number">98%</span>AF%E5%<span class="hljs-number">90%</span>A6%E5%<span class="hljs-number">8</span>C%<span class="hljs-number">85%</span>E5%<span class="hljs-number">90%</span>AB%<span class="hljs-number">203%</span><span class="hljs-number">3</span>A%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">20%</span><span class="hljs-number">2</span>B%<span class="hljs-number">20l</span>ist.contains%<span class="hljs-number">283%</span><span class="hljs-number">29%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E6%<span class="hljs-number">98%</span>AF%E5%<span class="hljs-number">90%</span>A6%E5%<span class="hljs-number">8</span>C%<span class="hljs-number">85%</span>E5%<span class="hljs-number">90%</span>AB%<span class="hljs-number">205%</span><span class="hljs-number">3</span>A%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">20%</span><span class="hljs-number">2</span>B%<span class="hljs-number">20l</span>ist.contains%<span class="hljs-number">285%</span><span class="hljs-number">29%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E5%<span class="hljs-number">8</span>F%<span class="hljs-number">8</span>D%E8%BD%AC%E9%<span class="hljs-number">93%</span>BE%E8%A1%A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.reverse%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20l</span>ist.print%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D&amp;cumulative=<span class="hljs-literal">false</span>&amp;curInstr=<span class="hljs-number">0&amp;</span>heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=java&amp;rawInputLstJSON=%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D&amp;textReferences=<span class="hljs-literal">false</span>
</code></pre>
<h3 data-id="heading-4">Java ä¸­çš„ try catch finally ç¤ºä¾‹</h3>
<p>è¿™ä¸ªç¤ºä¾‹é€‚åˆç”¨æ¥è§‚å¯Ÿå¼‚å¸¸å‘ç”Ÿæ—¶æ§åˆ¶æµçš„å˜åŒ–ï¼Œä»¥åŠ finally ä»£ç å—ä¸€å®šä¼šè¢«æ‰§è¡Œçš„ç‰¹æ€§ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TryCatchDemo</span> {

    <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªéœ€è¦æ‰‹åŠ¨é‡Šæ”¾çš„èµ„æº</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FakeResource</span> {
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">open</span>()</span> {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"èµ„æºå·²æ‰“å¼€"</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">use</span>()</span> {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ­£åœ¨ä½¿ç”¨èµ„æº"</span>);
            <span class="hljs-comment">// äººä¸ºåˆ¶é€ å¼‚å¸¸</span>
            <span class="hljs-built_in">int</span> x = <span class="hljs-number">10</span> / <span class="hljs-number">0</span>;
        }

        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">close</span>()</span> {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"èµ„æºå·²é‡Šæ”¾"</span>);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        FakeResource resource = <span class="hljs-keyword">new</span> FakeResource();

        <span class="hljs-keyword">try</span> {
            resource.open();
            resource.use();
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è¿™è¡Œä»£ç ä¸ä¼šè¢«æ‰§è¡Œ"</span>);
        } <span class="hljs-keyword">catch</span> (ArithmeticException e) {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ•è·åˆ°å¼‚å¸¸: "</span> + e.getMessage());
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œ</span>
            resource.close();
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"finally å—æ‰§è¡Œå®Œæˆ"</span>);
        }
    }
}
</code></pre>
<p>åœ¨ PythonTutor ä¸­å¯ä»¥æ¸…æ¥šçœ‹åˆ°ï¼š</p>
<ul>
<li>å¼‚å¸¸å‘ç”Ÿåç›´æ¥è·³è½¬åˆ° catch</li>
<li>try ä¸­å‰©ä½™ä»£ç ä¸å†æ‰§è¡Œ</li>
<li>finally å§‹ç»ˆä¼šè¢«æ‰§è¡Œ</li>
</ul>
<p>å¤åˆ¶ä¸‹é¢çš„å†…å®¹åœ¨æµè§ˆå™¨åœ°å€è®¿é—®</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">https:</span>//pythontutor.com/render.html#code=<span class="hljs-keyword">public</span>%<span class="hljs-number">20</span><span class="hljs-keyword">class</span>%<span class="hljs-number">20</span>TryCatchDemo%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E6%A8%A1%E6%<span class="hljs-number">8</span>B%<span class="hljs-number">9</span>F%E4%B8%<span class="hljs-number">80%</span>E4%B8%AA%E9%<span class="hljs-number">9</span>C%<span class="hljs-number">80%</span>E8%A6%<span class="hljs-number">81%</span>E6%<span class="hljs-number">89%</span><span class="hljs-number">8</span>B%E5%<span class="hljs-number">8</span>A%A8%E9%<span class="hljs-number">87%</span><span class="hljs-number">8</span>A%E6%<span class="hljs-number">94%</span>BE%E7%<span class="hljs-number">9</span>A%<span class="hljs-number">84%</span>E8%B5%<span class="hljs-number">84%</span>E6%BA%<span class="hljs-number">90%</span><span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20s</span>tatic%<span class="hljs-number">20</span><span class="hljs-keyword">class</span>%<span class="hljs-number">20</span>FakeResource%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>void%<span class="hljs-number">20</span>open%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E8%B5%<span class="hljs-number">84%</span>E6%BA%<span class="hljs-number">90%</span>E5%B7%B2%E6%<span class="hljs-number">89%</span><span class="hljs-number">93%</span>E5%BC%<span class="hljs-number">80%</span><span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>void%<span class="hljs-number">20us</span>e%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E6%AD%A3%E5%<span class="hljs-number">9</span>C%A8%E4%BD%BF%E7%<span class="hljs-number">94%</span>A8%E8%B5%<span class="hljs-number">84%</span>E6%BA%<span class="hljs-number">90%</span><span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E4%BA%BA%E4%B8%BA%E5%<span class="hljs-number">88%</span>B6%E9%<span class="hljs-number">80%</span>A0%E5%BC%<span class="hljs-number">82%</span>E5%B8%B8%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>nt%<span class="hljs-number">20</span>x%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">2010%</span><span class="hljs-number">20</span>/%<span class="hljs-number">200%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>void%<span class="hljs-number">20</span>close%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E8%B5%<span class="hljs-number">84%</span>E6%BA%<span class="hljs-number">90%</span>E5%B7%B2%E9%<span class="hljs-number">87%</span><span class="hljs-number">8</span>A%E6%<span class="hljs-number">94%</span>BE%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20s</span>tatic%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>main%<span class="hljs-number">28S</span>tring%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">20</span>args%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>FakeResource%<span class="hljs-number">20</span>resource%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span><span class="hljs-built_in">new</span>%<span class="hljs-number">20</span>FakeResource%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">try</span>%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>resource.open%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>resource.use%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E8%BF%<span class="hljs-number">99%</span>E8%A1%<span class="hljs-number">8</span>C%E4%BB%A3%E7%A0%<span class="hljs-number">81%</span>E4%B8%<span class="hljs-number">8</span>D%E4%BC%<span class="hljs-number">9</span>A%E8%A2%AB%E6%<span class="hljs-number">89%</span>A7%E8%A1%<span class="hljs-number">8</span>C%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">20</span><span class="hljs-keyword">catch</span>%<span class="hljs-number">20%</span><span class="hljs-number">28</span>ArithmeticException%<span class="hljs-number">20</span>e%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E6%<span class="hljs-number">8</span>D%<span class="hljs-number">95%</span>E8%<span class="hljs-number">8</span>E%B7%E5%<span class="hljs-number">88%</span>B0%E5%BC%<span class="hljs-number">82%</span>E5%B8%B8%<span class="hljs-number">3</span>A%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">20%</span><span class="hljs-number">2</span>B%<span class="hljs-number">20</span>e.getMessage%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">20</span><span class="hljs-keyword">finally</span>%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>//%<span class="hljs-number">20%</span>E6%<span class="hljs-number">97%</span>A0%E8%AE%BA%E6%<span class="hljs-number">98%</span>AF%E5%<span class="hljs-number">90%</span>A6%E5%<span class="hljs-number">8</span>F%<span class="hljs-number">91%</span>E7%<span class="hljs-number">94%</span><span class="hljs-number">9</span>F%E5%BC%<span class="hljs-number">82%</span>E5%B8%B8%EF%BC%<span class="hljs-number">8</span>C%E9%<span class="hljs-number">83%</span>BD%E4%BC%<span class="hljs-number">9</span>A%E6%<span class="hljs-number">89%</span>A7%E8%A1%<span class="hljs-number">8</span>C%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>resource.close%<span class="hljs-number">28%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22</span><span class="hljs-keyword">finally</span>%<span class="hljs-number">20%</span>E5%<span class="hljs-number">9</span>D%<span class="hljs-number">97%</span>E6%<span class="hljs-number">89%</span>A7%E8%A1%<span class="hljs-number">8</span>C%E5%AE%<span class="hljs-number">8</span>C%E6%<span class="hljs-number">88%</span><span class="hljs-number">90%</span><span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D&amp;cumulative=<span class="hljs-literal">false</span>&amp;curInstr=<span class="hljs-number">0&amp;</span>heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=java&amp;rawInputLstJSON=%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D&amp;textReferences=<span class="hljs-literal">false</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">Java ä¸­çš„ switch case ï¼ˆå‘½ä¸­ç©¿é€ï¼‰ç¤ºä¾‹</h3>
<p>ä¸‹é¢è¿™ä¸ªç¤ºä¾‹å°† break åˆ é™¤äº†ï¼Œé€‚åˆè§‚å¯Ÿåˆ†æ”¯åŒ¹é…å’Œ break å¯¹æµç¨‹çš„å½±å“ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SwitchDemo</span> {

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
            <span class="hljs-built_in">int</span> day = <span class="hljs-number">1</span>;

            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"day = "</span> + day);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¼€å§‹æ‰§è¡Œ switch"</span>);

            <span class="hljs-keyword">switch</span> (day) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å‘½ä¸­ case 1ï¼šæ˜ŸæœŸä¸€"</span>);
                    <span class="hljs-comment">// break;</span>
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å‘½ä¸­ case 2ï¼šæ˜ŸæœŸäºŒ"</span>);
                    <span class="hljs-comment">// break;</span>
                <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å‘½ä¸­ case 3ï¼šæ˜ŸæœŸä¸‰"</span>);
                    <span class="hljs-comment">// break;</span>
                <span class="hljs-literal">default</span>:
                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å‘½ä¸­ defaultï¼šæœªçŸ¥æ—¥æœŸ"</span>);
                    <span class="hljs-comment">// break;</span>
            }

            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"switch æ‰§è¡Œç»“æŸ"</span>);
        }
    }
</code></pre>
<p>é€šè¿‡å¯è§†åŒ–å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>switch è¡¨è¾¾å¼åªè®¡ç®—ä¸€æ¬¡</li>
<li>ç¬¬ä¸€ä¸ªåŒ¹é…çš„ case å°±ä¼šè¢«æ‰§è¡Œ</li>
<li>ç¼ºå°‘break ä¼šå¯¼è‡´å‘½ä¸­ç©¿é€ã€‚</li>
</ul>
<p>å¤åˆ¶ä¸‹é¢çš„å†…å®¹åœ¨æµè§ˆå™¨åœ°å€è®¿é—®</p>
<pre><code class="hljs language-sql" lang="sql">https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>pythontutor.com<span class="hljs-operator">/</span>render.html#code<span class="hljs-operator">=</span>public<span class="hljs-operator">%</span><span class="hljs-number">20</span>class<span class="hljs-operator">%</span><span class="hljs-number">20</span>SwitchDemo<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">7</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>public<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">static</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>void<span class="hljs-operator">%</span><span class="hljs-number">20</span>main<span class="hljs-operator">%</span><span class="hljs-number">28</span>String<span class="hljs-operator">%</span><span class="hljs-number">5</span>B<span class="hljs-operator">%</span><span class="hljs-number">5</span>D<span class="hljs-operator">%</span><span class="hljs-number">20</span>args<span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">7</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-type">int</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">day</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>D<span class="hljs-operator">%</span><span class="hljs-number">201</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-keyword">day</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>D<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">2</span>B<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">day</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span>BC<span class="hljs-operator">%</span><span class="hljs-number">80</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span>A7<span class="hljs-operator">%</span><span class="hljs-number">8</span>B<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">89</span><span class="hljs-operator">%</span>A7<span class="hljs-operator">%</span>E8<span class="hljs-operator">%</span>A1<span class="hljs-operator">%</span><span class="hljs-number">8</span>C<span class="hljs-operator">%</span><span class="hljs-number">20</span>switch<span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>switch<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-keyword">day</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">7</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">201</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span><span class="hljs-number">91</span><span class="hljs-operator">%</span>BD<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span>AD<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">201</span><span class="hljs-operator">%</span>EF<span class="hljs-operator">%</span>BC<span class="hljs-operator">%</span><span class="hljs-number">9</span>A<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">98</span><span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>C<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span><span class="hljs-number">80</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>break<span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">202</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span><span class="hljs-number">91</span><span class="hljs-operator">%</span>BD<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span>AD<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">202</span><span class="hljs-operator">%</span>EF<span class="hljs-operator">%</span>BC<span class="hljs-operator">%</span><span class="hljs-number">9</span>A<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">98</span><span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>C<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>BA<span class="hljs-operator">%</span><span class="hljs-number">8</span>C<span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>break<span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">203</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span><span class="hljs-number">91</span><span class="hljs-operator">%</span>BD<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span>AD<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">case</span><span class="hljs-operator">%</span><span class="hljs-number">203</span><span class="hljs-operator">%</span>EF<span class="hljs-operator">%</span>BC<span class="hljs-operator">%</span><span class="hljs-number">9</span>A<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">98</span><span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>C<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span><span class="hljs-number">89</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>break<span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">default</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span>E5<span class="hljs-operator">%</span><span class="hljs-number">91</span><span class="hljs-operator">%</span>BD<span class="hljs-operator">%</span>E4<span class="hljs-operator">%</span>B8<span class="hljs-operator">%</span>AD<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">default</span><span class="hljs-operator">%</span>EF<span class="hljs-operator">%</span>BC<span class="hljs-operator">%</span><span class="hljs-number">9</span>A<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>C<span class="hljs-operator">%</span>AA<span class="hljs-operator">%</span>E7<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span>A5<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">97</span><span class="hljs-operator">%</span>A5<span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>C<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>break<span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">7</span>D<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>System.out.println<span class="hljs-operator">%</span><span class="hljs-number">28</span><span class="hljs-operator">%</span><span class="hljs-number">22</span>switch<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">89</span><span class="hljs-operator">%</span>A7<span class="hljs-operator">%</span>E8<span class="hljs-operator">%</span>A1<span class="hljs-operator">%</span><span class="hljs-number">8</span>C<span class="hljs-operator">%</span>E7<span class="hljs-operator">%</span>BB<span class="hljs-operator">%</span><span class="hljs-number">93</span><span class="hljs-operator">%</span>E6<span class="hljs-operator">%</span><span class="hljs-number">9</span>D<span class="hljs-operator">%</span><span class="hljs-number">9</span>F<span class="hljs-operator">%</span><span class="hljs-number">22</span><span class="hljs-operator">%</span><span class="hljs-number">29</span><span class="hljs-operator">%</span><span class="hljs-number">3</span>B<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">%</span><span class="hljs-number">7</span>D<span class="hljs-operator">%</span><span class="hljs-number">0</span>A<span class="hljs-operator">%</span><span class="hljs-number">7</span>D<span class="hljs-operator">&amp;</span>cumulative<span class="hljs-operator">=</span><span class="hljs-literal">false</span><span class="hljs-operator">&amp;</span>curInstr<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-operator">&amp;</span>heapPrimitives<span class="hljs-operator">=</span>nevernest<span class="hljs-operator">&amp;</span>mode<span class="hljs-operator">=</span>display<span class="hljs-operator">&amp;</span>origin<span class="hljs-operator">=</span>opt<span class="hljs-operator">-</span>frontend.js<span class="hljs-operator">&amp;</span>py<span class="hljs-operator">=</span>java<span class="hljs-operator">&amp;</span>rawInputLstJSON<span class="hljs-operator">=</span><span class="hljs-operator">%</span><span class="hljs-number">5</span>B<span class="hljs-operator">%</span><span class="hljs-number">5</span>D<span class="hljs-operator">&amp;</span>textReferences<span class="hljs-operator">=</span><span class="hljs-literal">false</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">while å¾ªç¯ä¸ continueã€break ç¤ºä¾‹</h3>
<p>è¿™ä¸ªç¤ºä¾‹éå¸¸é€‚åˆåœ¨ PythonTutor ä¸­è§‚å¯Ÿå¾ªç¯å˜é‡çš„å˜åŒ–ï¼Œä»¥åŠ continue å’Œ break å¯¹æµç¨‹çš„å½±å“ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WhileDemo</span> {

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[] args)</span> </span>{
            <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;

            <span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">5</span>) {
                i++;

                <span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span>) {
                    <span class="hljs-keyword">continue</span>;
                }

                <span class="hljs-keyword">if</span> (i == <span class="hljs-number">4</span>) {
                    <span class="hljs-keyword">break</span>;
                }

                System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"å½“å‰ i = "</span> + i);
            }
        }
    }
</code></pre>
<p>åœ¨å¯è§†åŒ–è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>continue ä¼šè·³è¿‡æœ¬è½®å¾ªç¯å‰©ä½™ä»£ç </li>
<li>break ä¼šç›´æ¥è·³å‡ºæ•´ä¸ªå¾ªç¯</li>
<li>i çš„å˜åŒ–è¿‡ç¨‹æ¸…æ™°å¯è§</li>
</ul>

<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">https:</span>//pythontutor.com/render.html#code=<span class="hljs-keyword">public</span>%<span class="hljs-number">20</span><span class="hljs-keyword">class</span>%<span class="hljs-number">20</span>WhileDemo%<span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">public</span>%<span class="hljs-number">20s</span>tatic%<span class="hljs-number">20</span>void%<span class="hljs-number">20</span>main%<span class="hljs-number">28S</span>tring%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">20</span>args%<span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>nt%<span class="hljs-number">20i</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">200%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">while</span>%<span class="hljs-number">20%</span><span class="hljs-number">28i</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>C%<span class="hljs-number">205%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>%<span class="hljs-number">2</span>B%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28i</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">202%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span><span class="hljs-keyword">continue</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20i</span>f%<span class="hljs-number">20%</span><span class="hljs-number">28i</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">204%</span><span class="hljs-number">29%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20</span>break%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20S</span>ystem.out.println%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E5%BD%<span class="hljs-number">93%</span>E5%<span class="hljs-number">89%</span><span class="hljs-number">8</span>D%<span class="hljs-number">20i</span>%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20%</span><span class="hljs-number">22%</span><span class="hljs-number">20%</span><span class="hljs-number">2</span>B%<span class="hljs-number">20i</span>%<span class="hljs-number">29%</span><span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">20%</span><span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D&amp;cumulative=<span class="hljs-literal">false</span>&amp;curInstr=<span class="hljs-number">0&amp;</span>heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=java&amp;rawInputLstJSON=%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D&amp;textReferences=<span class="hljs-literal">false</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">Python ä¸­çš„å˜é‡å¼•ç”¨ç¤ºä¾‹</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯ä»¥ç›´æ¥è¿è¡Œçš„ Python ç¤ºä¾‹ï¼Œç”¨äºç†è§£å˜é‡å’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1fd3fb4232544e19b72e4ae4e82f81f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGU3ZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769847968&amp;x-signature=vIOfQFqi5nAE9%2F2VPiQAgpDPA5Q%3D" alt="python è™šæ‹ŸåŒ–.gif" loading="lazy"/></p>
<pre><code class="hljs language-scss" lang="scss">    <span class="hljs-selector-tag">a</span> = <span class="hljs-selector-attr">[1, 2, 3]</span>
    <span class="hljs-selector-tag">b</span> = <span class="hljs-selector-tag">a</span>

    <span class="hljs-built_in">print</span>("a:", a)
    <span class="hljs-built_in">print</span>("b:", b)

    <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.append</span>(<span class="hljs-number">4</span>)

    <span class="hljs-built_in">print</span>("ä¿®æ”¹ b ä¹‹å")
    <span class="hljs-built_in">print</span>("a:", a)
    <span class="hljs-built_in">print</span>("b:", b)
</code></pre>
<p>åœ¨ PythonTutor ä¸­å¯ä»¥ç›´è§‚çœ‹åˆ°ï¼š</p>
<ul>
<li>a å’Œ b æŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡</li>
<li>å¯¹ b çš„ä¿®æ”¹ä¼šåŒæ­¥å½±å“ a</li>
<li>å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªåˆ—è¡¨å®ä¾‹</li>
</ul>
<p>å¤åˆ¶ä¸‹é¢çš„å†…å®¹åœ¨æµè§ˆå™¨åœ°å€è®¿é—®</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">https:</span>//pythontutor.com/render.html#code=a%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20%</span><span class="hljs-number">5</span>B1,%<span class="hljs-number">202</span>,%<span class="hljs-number">203%</span><span class="hljs-number">5</span>D%<span class="hljs-number">0</span>Ab%<span class="hljs-number">20%</span><span class="hljs-number">3</span>D%<span class="hljs-number">20</span>a%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>Aprint%<span class="hljs-number">28%</span><span class="hljs-number">22</span>a%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>,%<span class="hljs-number">20</span>a%<span class="hljs-number">29%</span><span class="hljs-number">0</span>Aprint%<span class="hljs-number">28%</span><span class="hljs-number">22</span>b%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>,%<span class="hljs-number">20</span>b%<span class="hljs-number">29%</span><span class="hljs-number">0</span>A%<span class="hljs-number">0</span>Ab.append%<span class="hljs-number">284%</span><span class="hljs-number">29%</span><span class="hljs-number">0</span>A%<span class="hljs-number">0</span>Aprint%<span class="hljs-number">28%</span><span class="hljs-number">22%</span>E4%BF%AE%E6%<span class="hljs-number">94%</span>B9%<span class="hljs-number">20</span>b%<span class="hljs-number">20%</span>E4%B9%<span class="hljs-number">8</span>B%E5%<span class="hljs-number">90%</span><span class="hljs-number">8</span>E%<span class="hljs-number">22%</span><span class="hljs-number">29%</span><span class="hljs-number">0</span>Aprint%<span class="hljs-number">28%</span><span class="hljs-number">22</span>a%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>,%<span class="hljs-number">20</span>a%<span class="hljs-number">29%</span><span class="hljs-number">0</span>Aprint%<span class="hljs-number">28%</span><span class="hljs-number">22</span>b%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>,%<span class="hljs-number">20</span>b%<span class="hljs-number">29&amp;</span>cumulative=<span class="hljs-literal">false</span>&amp;curInstr=<span class="hljs-number">0&amp;</span>heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=<span class="hljs-number">311&amp;</span>rawInputLstJSON=%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D&amp;textReferences=<span class="hljs-literal">false</span>
</code></pre>
<hr/>
<h3 data-id="heading-8">é€‚åˆä½¿ç”¨ PythonTutor çš„åœºæ™¯</h3>
<p>PythonTutor ç‰¹åˆ«é€‚åˆç”¨äºï¼š</p>
<ul>
<li>å­¦ä¹ åŸºç¡€è¯­æ³•å’Œæ§åˆ¶æµç¨‹</li>
<li>ç†è§£å¼‚å¸¸å¤„ç†é€»è¾‘</li>
<li>æŒæ¡å¾ªç¯ä¸åˆ†æ”¯çš„æ‰§è¡Œç»†èŠ‚</li>
<li>å­¦ä¹ æ•°æ®ç»“æ„å’Œå¼•ç”¨æ¨¡å‹</li>
</ul>
<p>å®ƒå¹¶ä¸æ˜¯è°ƒè¯•å¤§å‹é¡¹ç›®çš„å·¥å…·ï¼Œè€Œæ˜¯å¸®åŠ©å»ºç«‹æ­£ç¡®æ‰§è¡Œè®¤çŸ¥çš„å­¦ä¹ è¾…åŠ©å·¥å…·ã€‚</p>
<hr/>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>PythonTutor é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼ï¼ŒæŠŠéšè—åœ¨è¿è¡Œæ—¶å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹å®Œæ•´å‘ˆç°å‡ºæ¥ã€‚æ— è®ºæ˜¯é“¾è¡¨ã€å¼‚å¸¸å¤„ç†ã€åˆ†æ”¯åˆ¤æ–­è¿˜æ˜¯å¾ªç¯æ§åˆ¶ï¼Œéƒ½å¯ä»¥é€šè¿‡å›¾å½¢åŒ–çš„æ–¹å¼è¢«æ¸…æ™°ç†è§£ï¼Œæ˜¯å­¦ä¹ å’Œæ•™å­¦ä¸­éå¸¸æœ‰ä»·å€¼çš„å·¥å…·ã€‚</p>
<h3 data-id="heading-10">æ‰©å±•</h3>
<p>IDEA æ’ä»¶ç¤¾åŒºé‡Œæœ‰ä¸€ä¸ªæ’ä»¶<code>Java Visualizer</code>å¯ä»¥åœ¨ IDEA é‡Œè°ƒè¯•æ—¶ä½¿ç”¨ç±»ä¼¼çš„æ•ˆæœï¼Œå•åªèƒ½ä¸‹ä¸€æ­¥ï¼Œä¸èƒ½å¾€å›èµ°ï¼Œéå¸¸å¥½ç”¨ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3345f9fcf3014fa3b4f0cad9211466c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGU3ZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769847968&amp;x-signature=TU%2FOMtKSZ73XRM1yia3E%2FCjljNM%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.jsï¼šé¢ è¦†ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤å—æ¬¢è¿ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598499504170926118</link>    <guid>https://juejin.cn/post/7598499504170926118</guid>    <pubDate>2026-01-24T08:21:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598499504170926118" data-draft-id="7598532592455647259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.jsï¼šé¢ è¦†ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤å—æ¬¢è¿ï¼Ÿ"/> <meta itemprop="keywords" content="Next.js"/> <meta itemprop="datePublished" content="2026-01-24T08:21:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.jsï¼šé¢ è¦†ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤å—æ¬¢è¿ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:21:09.000Z" title="Sat Jan 24 2026 08:21:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Next.jsï¼šé¢ è¦†ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤å—æ¬¢è¿ï¼Ÿ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d39a6ea809db47fa9d84f22b0f1b411d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YyX6L6wYWxr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769847669&amp;x-signature=9llCTBmsrjB84G5%2FC7usxDOeHwM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€Next.jsåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>Next.js æ˜¯ä¸€ä¸ªåŸºäº React çš„<strong>å…¨æ ˆæ¡†æ¶</strong>ï¼Œç”±Vercelå…¬å¸å¼€å‘å¹¶ç»´æŠ¤ã€‚å®ƒä¸æ˜¯ç®€å•çš„UIåº“ï¼Œè€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„Webåº”ç”¨å¼€å‘è§£å†³æ–¹æ¡ˆï¼Œè®©ä½ èƒ½å¤Ÿè½»æ¾æ„å»ºé«˜æ€§èƒ½çš„Reactåº”ç”¨ç¨‹åºã€‚</p>
<p>ç®€å•æ¥è¯´ï¼ŒNext.js = React + è·¯ç”±ç³»ç»Ÿ + æœåŠ¡ç«¯æ¸²æŸ“ + æ„å»ºä¼˜åŒ– + APIè·¯ç”± + æ›´å¤šå¼€ç®±å³ç”¨çš„åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-2">äºŒã€Next.jsçš„å…«å¤§æ ¸å¿ƒç‰¹ç‚¹</h3>
<h4 data-id="heading-3">1.Â <strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ä¸é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰</strong></h4>
<p>è¿™æ˜¯Next.jsæœ€äº®çœ¼çš„ç‰¹æ€§ä¹‹ä¸€ï¼ä¼ ç»ŸReactåº”ç”¨åªåœ¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè€ŒNext.jsæ”¯æŒï¼š</p>
<ul>
<li>â€¢ æœåŠ¡ç«¯æ¸²æŸ“ï¼šé¡µé¢åœ¨æœåŠ¡å™¨ä¸Šç”ŸæˆHTMLï¼Œç„¶åå‘é€ç»™å®¢æˆ·ç«¯</li>
<li>â€¢ é™æ€ç”Ÿæˆï¼šæ„å»ºæ—¶é¢„æ¸²æŸ“é¡µé¢ï¼Œé€‚åˆå†…å®¹å˜åŒ–ä¸å¤§çš„é¡µé¢</li>
<li>â€¢ å¢é‡é™æ€å†ç”Ÿï¼šä¿æŒé™æ€é¡µé¢çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶æ”¯æŒå†…å®¹æ›´æ–°</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â ç®€å•çš„é™æ€é¡µé¢ç”Ÿæˆç¤ºä¾‹</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">getStaticProps</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">const</span>Â dataÂ =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/data'</span>);
Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â <span class="hljs-attr">props</span>:Â {Â dataÂ },
Â Â };
}
</code></pre>
<h4 data-id="heading-4">2.Â <strong>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±</strong></h4>
<p>ä¸éœ€è¦å¤æ‚é…ç½®ï¼Œç›´æ¥åœ¨<code>pages</code>ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å³å¯å®šä¹‰è·¯ç”±ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pages/
Â Â index.jsÂ Â Â Â Â Â Â Â â†’Â Â /
Â Â about.jsÂ Â Â Â Â Â Â Â â†’Â Â /about
Â Â blog/
Â Â Â Â [slug].jsÂ Â Â Â Â â†’Â Â /blog/:slugÂ (åŠ¨æ€è·¯ç”±)
</code></pre>
<h4 data-id="heading-5">3.Â <strong>APIè·¯ç”±</strong></h4>
<p>æ— éœ€å•ç‹¬çš„åç«¯æœåŠ¡å™¨ï¼Œåœ¨<code>pages/api</code>ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å³å¯ç¼–å†™APIæ¥å£ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â pages/api/user.js</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">handler</span>(<span class="hljs-params">req,Â res</span>)Â {
Â Â res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'JohnÂ Doe'</span>Â });
}
</code></pre>
<h4 data-id="heading-6">4.Â <strong>å†…ç½®CSSå’ŒSassæ”¯æŒ</strong></h4>
<p>æ”¯æŒCSS Modulesã€Styled JSXã€Sassç­‰ï¼Œå¼€ç®±å³ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</p>
<h4 data-id="heading-7">5.Â <strong>è‡ªåŠ¨ä»£ç åˆ†å‰²</strong></h4>
<p>Next.jsä¼šè‡ªåŠ¨å°†ä»£ç æ‹†åˆ†æˆå°å—ï¼ŒåªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç ï¼Œå¤§å¹…æå‡é¦–å±åŠ è½½é€Ÿåº¦ã€‚</p>
<h4 data-id="heading-8">6.Â <strong>å›¾åƒä¼˜åŒ–ç»„ä»¶</strong></h4>
<p><code>&lt;Image /&gt;</code>ç»„ä»¶è‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡ï¼š</p>
<ul>
<li>â€¢ è‡ªåŠ¨è°ƒæ•´å°ºå¯¸</li>
<li>â€¢ è½¬æ¢ä¸ºç°ä»£æ ¼å¼ï¼ˆWebPï¼‰</li>
<li>â€¢ å»¶è¿ŸåŠ è½½</li>
<li>â€¢ é˜²æ­¢å¸ƒå±€åç§»</li>
</ul>
<h4 data-id="heading-9">7.Â <strong>TypeScriptåŸç”Ÿæ”¯æŒ</strong></h4>
<p>åªéœ€åˆ›å»ºä¸€ä¸ª<code>tsconfig.json</code>æ–‡ä»¶ï¼ŒNext.jsä¼šè‡ªåŠ¨é…ç½®TypeScriptæ”¯æŒã€‚</p>
<h4 data-id="heading-10">8.Â <strong>å¿«é€Ÿåˆ·æ–°ï¼ˆFast Refreshï¼‰</strong></h4>
<p>å¼€å‘æ¨¡å¼ä¸‹ï¼Œä¿å­˜æ–‡ä»¶å³å¯å®æ—¶çœ‹åˆ°æ›´æ”¹ï¼Œä¿æŒç»„ä»¶çŠ¶æ€ä¸å˜ã€‚</p>
<h3 data-id="heading-11">ä¸‰ã€Next.jsçš„äº”å¤§ä¼˜åŠ¿</h3>
<h4 data-id="heading-12">1.Â <strong>æè‡´çš„æ€§èƒ½ä¼˜åŒ–</strong></h4>
<p>Next.jsçš„é¢„æ¸²æŸ“ç­–ç•¥æ˜¾è‘—æ”¹å–„äº†ï¼š</p>
<ul>
<li>â€¢Â <strong>é¦–å±åŠ è½½æ—¶é—´</strong>ï¼šæœåŠ¡å™¨è¿”å›å®Œæ•´çš„HTMLï¼Œç”¨æˆ·ç«‹å³çœ‹åˆ°å†…å®¹</li>
<li>â€¢Â <strong>SEOä¼˜åŒ–</strong>ï¼šæœç´¢å¼•æ“å¯ä»¥è½»æ¾æŠ“å–é¡µé¢å†…å®¹</li>
<li>â€¢Â <strong>æ ¸å¿ƒWebæŒ‡æ ‡</strong>ï¼šåœ¨LCPã€FIDã€CLSç­‰å…³é”®æŒ‡æ ‡ä¸Šè¡¨ç°ä¼˜å¼‚</li>
</ul>
<h4 data-id="heading-13">2.Â <strong>å¼€å‘ä½“éªŒæä½³</strong></h4>
<ul>
<li>â€¢ é›¶é…ç½®èµ·æ­¥</li>
<li>â€¢ ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ</li>
<li>â€¢ ä¼˜ç§€çš„é”™è¯¯æŠ¥å‘Šå’Œè°ƒè¯•å·¥å…·</li>
<li>â€¢ å®Œæ•´çš„æ–‡æ¡£å’Œæ´»è·ƒçš„ç¤¾åŒº</li>
</ul>
<h4 data-id="heading-14">3.Â <strong>å…¨æ ˆèƒ½åŠ›</strong></h4>
<p>ä»å‰ç«¯åˆ°åç«¯APIï¼Œä¸€ä¸ªæ¡†æ¶æå®šæ‰€æœ‰ï¼š</p>
<ul>
<li>â€¢ å‰ç«¯é¡µé¢æ¸²æŸ“</li>
<li>â€¢ APIæ¥å£å¼€å‘</li>
<li>â€¢ ä¸­é—´ä»¶å¤„ç†</li>
<li>â€¢ æ•°æ®åº“è¿æ¥</li>
</ul>
<h4 data-id="heading-15">4.Â <strong>å¼ºå¤§çš„éƒ¨ç½²èƒ½åŠ›</strong></h4>
<p>ä¸Vercelå¹³å°æ— ç¼é›†æˆï¼š</p>
<ul>
<li>â€¢ ä¸€é”®éƒ¨ç½²</li>
<li>â€¢ è‡ªåŠ¨HTTPS</li>
<li>â€¢ å…¨çƒCDN</li>
<li>â€¢ é¢„è§ˆéƒ¨ç½²</li>
<li>â€¢ è‡ªåŠ¨æ€§èƒ½ä¼˜åŒ–</li>
</ul>
<h4 data-id="heading-16">5.Â <strong>ä¼ä¸šçº§ç‰¹æ€§</strong></h4>
<ul>
<li>â€¢ å›½é™…åŒ–è·¯ç”±</li>
<li>â€¢ æŒ‰éœ€åˆ†æ</li>
<li>â€¢ é¢„è§ˆæ¨¡å¼</li>
<li>â€¢ ä¸­é—´ä»¶æ”¯æŒ</li>
<li>â€¢ å®‰å…¨å¤´éƒ¨è‡ªåŠ¨é…ç½®</li>
</ul>
<h3 data-id="heading-17">å››ã€Next.jsé€‚åˆå“ªäº›é¡¹ç›®ï¼Ÿ</h3>
<p>âœ…Â <strong>é€‚åˆåœºæ™¯</strong>ï¼š</p>
<ul>
<li>â€¢ éœ€è¦SEOä¼˜åŒ–çš„å†…å®¹å‹ç½‘ç«™ï¼ˆåšå®¢ã€æ–°é—»ã€ç”µå•†ï¼‰</li>
<li>â€¢ éœ€è¦è‰¯å¥½æ€§èƒ½çš„Webåº”ç”¨</li>
<li>â€¢ éœ€è¦æœåŠ¡ç«¯æ¸²æŸ“çš„åº”ç”¨ç¨‹åº</li>
<li>â€¢ å…¨æ ˆé¡¹ç›®ï¼Œå‰åç«¯ç»Ÿä¸€æŠ€æœ¯æ ˆ</li>
</ul>
<p>âŒÂ <strong>ä¸å¤ªé€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ çº¯é™æ€çš„æ— äº¤äº’é¡µé¢ï¼ˆç®€å•çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨å¯èƒ½æ›´è½»é‡ï¼‰</li>
<li>â€¢ è¶…å¤§å‹ä¼ä¸šåº”ç”¨ï¼ˆå¯èƒ½éœ€è¦æ›´å®šåˆ¶çš„æ¶æ„ï¼‰</li>
</ul>
<h3 data-id="heading-18">äº”ã€å¿«é€Ÿå¼€å§‹Next.js</h3>
<p>åˆ›å»ºNext.jsé¡¹ç›®åªéœ€è¦ä¸€è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">npxÂ create-<span class="hljs-keyword">next</span>-app@latestÂ <span class="hljs-keyword">my</span>-app
cdÂ <span class="hljs-keyword">my</span>-app
npmÂ runÂ dev
</code></pre>
<p>å‡ ç§’é’Ÿåï¼Œä½ çš„å¼€å‘æœåŠ¡å™¨å°±ä¼šåœ¨ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3000" target="_blank" title="http://localhost:3000" ref="nofollow noopener noreferrer">http://localhost:3000</a> å¯åŠ¨ï¼</p>
<h3 data-id="heading-19">å…­ã€æˆåŠŸæ¡ˆä¾‹</h3>
<p>è®¸å¤šçŸ¥åå…¬å¸éƒ½åœ¨ä½¿ç”¨Next.jsï¼š</p>
<ul>
<li>â€¢Â <strong>Twitch</strong>Â - ç›´æ’­å¹³å°</li>
<li>â€¢Â <strong>Netflix</strong>Â - éƒ¨åˆ†é¡µé¢</li>
<li>â€¢Â <strong>TikTok</strong>Â - å®˜ç½‘</li>
<li>â€¢Â <strong>Notion</strong>Â - æ–‡æ¡£å·¥å…·</li>
<li>â€¢Â <strong>Hulu</strong>Â - è§†é¢‘æµåª’ä½“</li>
</ul>
<h3 data-id="heading-20">ä¸ƒã€å­¦ä¹ èµ„æºæ¨è</h3>
<ol>
<li>1.Â <strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼ˆå¼ºçƒˆæ¨èï¼‰ï¼šnextjs.org/docs</li>
<li>2.Â <strong>Next.jså­¦ä¹ è¯¾ç¨‹</strong>ï¼šå®˜æ–¹å…è´¹äº’åŠ¨æ•™ç¨‹</li>
<li>3.Â <strong>GitHubç¤ºä¾‹</strong>ï¼šå®˜æ–¹ç¤ºä¾‹ä»“åº“</li>
<li>4.Â <strong>ç¤¾åŒº</strong>ï¼šGitHub Discussionsã€Redditã€Discord</li>
</ol>
<h3 data-id="heading-21">ç»“è¯­</h3>
<p>Next.jsæ­£åœ¨æ”¹å˜æˆ‘ä»¬æ„å»ºWebåº”ç”¨çš„æ–¹å¼ã€‚å®ƒå°†Reactçš„çµæ´»æ€§ä¸ç”Ÿäº§å°±ç»ªçš„åŠŸèƒ½ç›¸ç»“åˆï¼Œæä¾›äº†ä¸€ä¸ªæ—¢é€‚åˆåˆå­¦è€…å…¥é—¨ï¼Œåˆèƒ½æ»¡è¶³ä¼ä¸šçº§éœ€æ±‚çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ— è®ºä½ æ˜¯æƒ³æå‡ç°æœ‰é¡¹ç›®çš„æ€§èƒ½ï¼Œè¿˜æ˜¯å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼ŒNext.jséƒ½å€¼å¾—ä½ æ·±å…¥äº†è§£å’Œå°è¯•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaä¸­çš„å„ç§Oï¼šä»Big Oåˆ°POJOï¼Œä¸€æ¬¡ææ‡‚æ‰€æœ‰"O"]]></title>    <link>https://juejin.cn/post/7598480267217846306</link>    <guid>https://juejin.cn/post/7598480267217846306</guid>    <pubDate>2026-01-24T08:21:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480267217846306" data-draft-id="7598490039488708643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaä¸­çš„å„ç§Oï¼šä»Big Oåˆ°POJOï¼Œä¸€æ¬¡ææ‡‚æ‰€æœ‰&quot;O&quot;"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-24T08:21:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯2çš„10æ¬¡æ–¹å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/987803531871175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaä¸­çš„å„ç§Oï¼šä»Big Oåˆ°POJOï¼Œä¸€æ¬¡ææ‡‚æ‰€æœ‰"O"
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/987803531871175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯2çš„10æ¬¡æ–¹å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:21:26.000Z" title="Sat Jan 24 2026 08:21:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Javaä¸­çš„å„ç§Oï¼šä»Big Oåˆ°POJOï¼Œä¸€æ¬¡ææ‡‚æ‰€æœ‰"O"</h2>
<p>å‰å‡ å¤©é¢è¯•ä¸€ä¸ªJavaå¼€å‘ï¼Œæˆ‘é—®ä»–ï¼š"ä½ çŸ¥é“Javaä¸­æœ‰å“ªäº›'O'å—ï¼Ÿ"</p>
<p>ä»–æƒ³äº†æƒ³è¯´ï¼š"Objectï¼Ÿè¿˜æœ‰...Optionalï¼Ÿ"</p>
<p>æˆ‘ç¬‘äº†ç¬‘ï¼š"è¿˜æœ‰Big Oã€OOPã€POJOã€VOã€BOã€DTOã€DOã€DAO..."</p>
<p>ä»–ä¸€è„¸æ‡µé€¼ï¼š"è¿™ä¹ˆå¤š'O'ï¼Ÿéƒ½æ˜¯å•¥å•Šï¼Ÿ"</p>
<p>å…¶å®ï¼ŒåšJavaå¼€å‘ä¹…äº†ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªå­—æ¯"O"åœ¨Javaä¸–ç•Œé‡Œæ— å¤„ä¸åœ¨ã€‚ä»ç®—æ³•åˆ†æçš„Big Oï¼Œåˆ°ç¼–ç¨‹èŒƒå¼çš„OOPï¼Œå†åˆ°å„ç§å¯¹è±¡ç±»å‹ï¼Œæ¯ä¸€ä¸ª"O"èƒŒåéƒ½æœ‰å®ƒçš„æ•…äº‹ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°±æ¥èŠèŠè¿™äº›"O"çš„å‰ä¸–ä»Šç”Ÿï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯æ€ä¹ˆä»æ•°å­¦ç¬¦å·ã€ç¼–ç¨‹æ€æƒ³ï¼Œä¸€æ­¥æ­¥å˜æˆæˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­çš„å·¥å…·çš„ã€‚</p>
<hr/>
<h3 data-id="heading-1">Big Oï¼šé¢è¯•å®˜æœ€çˆ±é—®çš„é—®é¢˜</h3>
<h4 data-id="heading-2">ç¬¬ä¸€æ¬¡è¢«é—®æ‡µçš„ç»å†</h4>
<p>è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜é—®æˆ‘ï¼š"è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ"</p>
<p>æˆ‘ä¸€è„¸æ‡µé€¼ï¼š"æ—¶é—´å¤æ‚åº¦ï¼Ÿé‚£æ˜¯ä»€ä¹ˆï¼Ÿ"</p>
<p>ç»“æœ...ä½ æ‡‚çš„ï¼Œé¢è¯•å‡‰äº†ã€‚</p>
<p>åæ¥æˆ‘æ‰çŸ¥é“ï¼ŒåŸæ¥è¿™å°±æ˜¯<strong>å¤§Oè¡¨ç¤ºæ³•</strong>â€”â€”ç”¨æ¥æè¿°ç®—æ³•æ€§èƒ½çš„æ•°å­¦ç¬¦å·ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯å‘Šè¯‰æˆ‘ä»¬ï¼šå½“æ•°æ®é‡å˜å¤§æ—¶ï¼Œç®—æ³•ä¼šå˜æ…¢å¤šå°‘ã€‚</p>
<h4 data-id="heading-3">å¤§Oæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ</h4>
<p>ä½ å¯èƒ½æƒ³ä¸åˆ°ï¼Œå¤§Oå…¶å®ä¸æ˜¯è®¡ç®—æœºç§‘å­¦å®¶å‘æ˜çš„ï¼Œè€Œæ˜¯æ•°å­¦å®¶ã€‚</p>
<p><strong>1894å¹´</strong>ï¼Œå¾·å›½æ•°å­¦å®¶<strong>ä¿ç½—Â·å·´èµ«æ›¼</strong>åœ¨ç ”ç©¶ç´ æ•°åˆ†å¸ƒçš„æ—¶å€™ï¼Œå‘ç°æŸäº›å‡½æ•°çš„å¢é•¿é€Ÿåº¦å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„ç¬¦å·è¡¨ç¤ºï¼Œè¿™å°±æ˜¯å¤§Oçš„é›å½¢ã€‚</p>
<p><strong>1909å¹´</strong>ï¼Œå¦ä¸€ä½æ•°å­¦å®¶<strong>åŸƒå¾·è’™Â·æœ—é“</strong>è¿›ä¸€æ­¥æ¨å¹¿äº†è¿™ä¸ªç¬¦å·ï¼Œè®©å®ƒæˆä¸ºæ•°å­¦åˆ†æçš„æ ‡å‡†å·¥å…·ã€‚</p>
<p>ç›´åˆ°<strong>1968å¹´</strong>ï¼Œè®¡ç®—æœºç§‘å­¦å®¶<strong>å”çº³å¾·Â·å…‹åŠªç‰¹</strong>ï¼ˆå°±æ˜¯å†™ã€Šè®¡ç®—æœºç¨‹åºè®¾è®¡è‰ºæœ¯ã€‹é‚£ä½å¤§ç¥ï¼‰æŠŠå¤§Oå¼•å…¥è®¡ç®—æœºç§‘å­¦ï¼Œç”¨æ¥åˆ†æç®—æ³•å¤æ‚åº¦ã€‚</p>
<p>ä¸ºä»€ä¹ˆå«"å¤§O"ï¼Ÿå…¶å®"O"æ¥è‡ªå¾·è¯­å•è¯"Ordnung"ï¼ˆç§©åºã€é˜¶ï¼‰ï¼Œè¡¨ç¤ºå‡½æ•°çš„"é˜¶"æˆ–"æ•°é‡çº§"ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯çœ‹å‡½æ•°å¢é•¿æœ‰å¤šå¿«ã€‚</p>
<h4 data-id="heading-4">Javaä¸­å¸¸è§çš„æ—¶é—´å¤æ‚åº¦</h4>
<p>é¢è¯•çš„æ—¶å€™ï¼Œè¿™å‡ ä¸ªæ˜¯æœ€å¸¸é—®çš„ï¼š</p>
<p><strong>O(1)</strong> - å¸¸æ•°æ—¶é—´ï¼Œæœ€å¿«</p>
<pre><code class="hljs language-arduino" lang="arduino">arr[index];Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ•°ç»„è®¿é—®ï¼Œæ— è®ºæ•°ç»„å¤šå¤§éƒ½æ˜¯O(1)</span>
map.<span class="hljs-built_in">get</span>(<span class="hljs-string">"key"</span>);Â Â Â Â <span class="hljs-comment">//Â HashMapæŸ¥æ‰¾ï¼Œå¹³å‡ä¹Ÿæ˜¯O(1)</span>
</code></pre>
<p><strong>O(log n)</strong> - å¯¹æ•°æ—¶é—´ï¼Œå¾ˆå¿«</p>
<pre><code class="hljs language-css" lang="css">//Â äºŒåˆ†æŸ¥æ‰¾ï¼šæ¯æ¬¡æ’é™¤ä¸€åŠæ•°æ®
whileÂ (<span class="hljs-attribute">left</span>Â &lt;=Â <span class="hljs-attribute">right</span>)Â {
Â Â Â Â midÂ =Â (<span class="hljs-attribute">left</span>Â +Â <span class="hljs-attribute">right</span>)Â /Â <span class="hljs-number">2</span>;
Â Â Â Â ifÂ (arr<span class="hljs-selector-attr">[mid]</span>Â ==Â target)Â returnÂ mid;
}
</code></pre>
<p><strong>O(n)</strong> - çº¿æ€§æ—¶é—´ï¼Œè¿˜è¡Œ</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â éå†æ•°ç»„ï¼šéœ€è¦æ£€æŸ¥æ¯ä¸ªå…ƒç´ </span>
<span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span>Â iÂ =Â <span class="hljs-number">0</span>;Â iÂ &lt;Â arr.length;Â i++)Â {
Â Â Â Â <span class="hljs-comment">//Â å¤„ç†</span>
}
</code></pre>
<p><strong>O(n log n)</strong> - çº¿æ€§å¯¹æ•°æ—¶é—´ï¼Œæ’åºç®—æ³•å¸¸ç”¨</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â å½’å¹¶æ’åºï¼šåˆ†æ²»Â +Â åˆå¹¶</span>
<span class="hljs-built_in">mergeSort</span>(arr,Â left,Â mid);
<span class="hljs-built_in">mergeSort</span>(arr,Â midÂ +Â <span class="hljs-number">1</span>,Â right);
</code></pre>
<p><strong>O(nÂ²)</strong> - å¹³æ–¹æ—¶é—´ï¼Œæœ‰ç‚¹æ…¢</p>
<pre><code class="hljs language-ini" lang="ini">//Â åµŒå¥—å¾ªç¯ï¼šå¤–å±‚næ¬¡ï¼Œå†…å±‚næ¬¡
forÂ (intÂ <span class="hljs-attr">i</span>Â =Â <span class="hljs-number">0</span><span class="hljs-comment">;Â iÂ &lt;Â n;Â i++)Â {</span>
Â Â Â Â forÂ (intÂ <span class="hljs-attr">j</span>Â =Â <span class="hljs-number">0</span><span class="hljs-comment">;Â jÂ &lt;Â n;Â j++)Â {</span>
Â Â Â Â Â Â Â Â //Â å¤„ç†
Â Â Â Â }
}
</code></pre>
<p>è¯´å®è¯ï¼Œåˆšå¼€å§‹æˆ‘ä¹Ÿåˆ†ä¸æ¸…è¿™äº›ï¼Œåæ¥åˆ·LeetCodeåˆ·å¤šäº†ï¼Œæ‰æ…¢æ…¢æœ‰æ„Ÿè§‰ã€‚</p>
<h4 data-id="heading-5">Javaé›†åˆæ¡†æ¶ä¸­çš„æ—¶é—´å¤æ‚åº¦</h4>









































<table><thead><tr><th>æ•°æ®ç»“æ„</th><th>æ“ä½œ</th><th>æ—¶é—´å¤æ‚åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ArrayList</td><td>get(index)</td><td>O(1)</td><td>æ•°ç»„éšæœºè®¿é—®</td></tr><tr><td>ArrayList</td><td>contains(element)</td><td>O(n)</td><td>éœ€è¦éå†æŸ¥æ‰¾</td></tr><tr><td>HashMap</td><td>get(key)</td><td>O(1) å¹³å‡</td><td>å“ˆå¸Œè¡¨æŸ¥æ‰¾</td></tr><tr><td>TreeMap</td><td>get(key)</td><td>O(log n)</td><td>çº¢é»‘æ ‘æŸ¥æ‰¾</td></tr><tr><td>HashSet</td><td>add(element)</td><td>O(1) å¹³å‡</td><td>åŸºäºHashMapå®ç°</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-6">OOPï¼šJavaçš„ç¼–ç¨‹å“²å­¦</h3>
<h4 data-id="heading-7">ä»é¢å‘è¿‡ç¨‹åˆ°é¢å‘å¯¹è±¡</h4>
<p>åˆšå­¦Javaçš„æ—¶å€™ï¼Œè€å¸ˆä¸€ç›´å¼ºè°ƒ"é¢å‘å¯¹è±¡"ï¼Œæˆ‘é‚£æ—¶å€™å°±æƒ³ï¼šé¢å‘å¯¹è±¡åˆ°åº•æ˜¯ä¸ªå•¥ï¼Ÿ</p>
<p>åæ¥å†™å¤šäº†ä»£ç æ‰å‘ç°ï¼ŒåŸæ¥å°±æ˜¯æŠŠæ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•"æ‰“åŒ…"åœ¨ä¸€èµ·ã€‚å°±åƒç°å®ä¸­çš„ç‰©ä½“ä¸€æ ·ï¼Œæœ‰å±æ€§ï¼ˆæ¯”å¦‚äººçš„å§“åã€å¹´é¾„ï¼‰ï¼Œæœ‰è¡Œä¸ºï¼ˆæ¯”å¦‚äººä¼šåƒé¥­ã€ä¼šèµ°è·¯ï¼‰ã€‚</p>
<h4 data-id="heading-8">OOPæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ</h4>
<p><strong>1960å¹´ä»£</strong>ï¼ŒæŒªå¨çš„ä¸¤ä½ç¨‹åºå‘˜å¼€å‘äº†<strong>Simulaè¯­è¨€</strong>ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒç±»å’Œå¯¹è±¡æ¦‚å¿µçš„è¯­è¨€ã€‚ä»–ä»¬å½“æ—¶æ˜¯ä¸ºäº†æ¨¡æ‹Ÿç³»ç»Ÿï¼Œæ²¡æƒ³åˆ°è¿™ä¸ªæƒ³æ³•åæ¥æˆäº†ç¼–ç¨‹èŒƒå¼çš„é©å‘½ã€‚</p>
<p><strong>1970å¹´ä»£</strong>ï¼Œ<strong>Alan Kay</strong>åœ¨æ–½ä¹å…¬å¸å¼€å‘äº†<strong>Smalltalk</strong>ï¼Œè¿›ä¸€æ­¥å®Œå–„äº†OOPã€‚ä»–æå‡ºäº†"ä¸‡ç‰©çš†å¯¹è±¡"çš„ç†å¿µï¼Œè¿˜åˆ›é€ äº†"é¢å‘å¯¹è±¡ç¼–ç¨‹"è¿™ä¸ªè¯ã€‚</p>
<p><strong>1983å¹´</strong>ï¼Œ<strong>Bjarne Stroustrup</strong>å¼€å‘äº†<strong>C++</strong> ï¼ŒæŠŠOOPå¸¦å…¥äº†ä¸»æµã€‚</p>
<p><strong>1995å¹´</strong>ï¼Œ<strong>James Gosling</strong>å¼€å‘äº†Javaï¼ŒæŠŠOOPæ¨å‘äº†æ–°é«˜åº¦ã€‚Javaçš„"ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ"ï¼ŒOOPå°±æ˜¯æ ¸å¿ƒã€‚</p>
<h4 data-id="heading-9">Javaä¸­çš„OOPï¼šå››å¤§ç‰¹æ€§</h4>
<p>OOPæœ‰å››å¤§ç‰¹æ€§ï¼Œæˆ‘åˆšå¼€å§‹ä¹Ÿè®°ä¸ä½ï¼Œåæ¥ç”¨å¤šäº†æ‰ç†è§£ï¼š</p>
<p><strong>1. å°è£…</strong> - æŠŠæ•°æ®è—èµ·æ¥ï¼Œåªæš´éœ²å¿…è¦çš„æ–¹æ³•</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â å°±åƒé“¶è¡Œè´¦æˆ·ï¼Œä½™é¢ä¸èƒ½éšä¾¿æ”¹</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">BankAccount</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-type">double</span>Â balance;Â Â <span class="hljs-comment">//Â ç§æœ‰ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span>Â amount)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (amountÂ &gt;Â <span class="hljs-number">0</span>)Â balanceÂ +=Â amount;Â Â <span class="hljs-comment">//Â åªèƒ½é€šè¿‡æ–¹æ³•æ“ä½œ</span>
Â Â Â Â }
}
</code></pre>
<p><strong>2. ç»§æ‰¿</strong> - ä»£ç å¤ç”¨ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Animal</span>Â {
Â Â Â Â <span class="hljs-keyword">protected</span>Â <span class="hljs-title class_">String</span>Â name;
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>)Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Dog</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_ inherited__">Animal</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">bark</span>(<span class="hljs-params"/>)Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }Â Â <span class="hljs-comment">//Â ç»§æ‰¿äº†eat()ï¼Œè¿˜æœ‰è‡ªå·±çš„bark()</span>
}
</code></pre>
<p><strong>3. å¤šæ€</strong> - åŒä¸€æ¥å£ï¼Œä¸åŒå®ç°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">Shape</span>Â {
Â Â Â Â <span class="hljs-type">double</span>Â <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Circle</span>Â <span class="hljs-keyword">implements</span>Â <span class="hljs-title class_">Shape</span>Â {
Â Â Â Â <span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-type">double</span>Â <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Math.PIÂ *Â radiusÂ *Â radius;
Â Â Â Â }
}

<span class="hljs-comment">//Â å¤šæ€ï¼šåŒä¸€ä¸ªæ¥å£ï¼Œä¸åŒçš„å®ç°</span>
<span class="hljs-type">Shape</span>Â <span class="hljs-variable">shape</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5</span>);
shape.calculateArea();Â Â <span class="hljs-comment">//Â è°ƒç”¨Circleçš„å®ç°</span>
</code></pre>
<p><strong>4. æŠ½è±¡</strong> - éšè—å¤æ‚æ€§ï¼Œåªæš´éœ²å¿…è¦çš„</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">abstract</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">Vehicle</span>Â {
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">abstract</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">start</span>()</span>;Â Â <span class="hljs-comment">//Â æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°</span>
}

<span class="hljs-keyword">class</span>Â <span class="hljs-title">Car</span>Â <span class="hljs-title">extends</span>Â <span class="hljs-title">Vehicle</span>Â {
Â Â Â Â @Override
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">start</span>()</span>Â {Â <span class="hljs-comment">/*Â å…·ä½“å®ç°Â */</span>Â }
}
</code></pre>
<h4 data-id="heading-10">SOLIDåŸåˆ™ï¼šOOPçš„è®¾è®¡åŸåˆ™</h4>
<p>è¯´åˆ°OOPï¼Œå°±ä¸å¾—ä¸æ<strong>SOLIDåŸåˆ™</strong>ã€‚è¿™äº”ä¸ªåŸåˆ™åˆšå¼€å§‹æˆ‘ä¹Ÿè®°ä¸ä½ï¼Œåæ¥è¸©äº†æ— æ•°å‘æ‰æ˜ç™½ï¼š</p>
<ul>
<li><strong>S</strong> - å•ä¸€èŒè´£ï¼šä¸€ä¸ªç±»åªåšä¸€ä»¶äº‹</li>
<li><strong>O</strong> - å¼€é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</li>
<li><strong>L</strong> - é‡Œæ°æ›¿æ¢ï¼šå­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»</li>
<li><strong>I</strong> - æ¥å£éš”ç¦»ï¼šæ¥å£è¦å°è€Œä¸“</li>
<li><strong>D</strong> - ä¾èµ–å€’ç½®ï¼šä¾èµ–æŠ½è±¡ï¼Œä¸ä¾èµ–å…·ä½“</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¼€é—­åŸåˆ™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//Â æ–°å¢æ”¯ä»˜æ–¹å¼ï¼Œä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç </span>
<span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">PaymentMethod</span>Â {
Â Â Â Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">pay</span><span class="hljs-params">(<span class="hljs-type">double</span>Â amount)</span>;
}

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AlipayPayment</span>Â <span class="hljs-keyword">implements</span>Â <span class="hljs-title class_">PaymentMethod</span>Â {
Â Â Â Â <span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">pay</span><span class="hljs-params">(<span class="hljs-type">double</span>Â amount)</span>Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}

<span class="hljs-comment">//Â è¦åŠ å¾®ä¿¡æ”¯ä»˜ï¼Ÿç›´æ¥å®ç°æ¥å£å°±è¡Œï¼Œä¸ç”¨æ”¹å…¶ä»–ä»£ç </span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">WeChatPayment</span>Â <span class="hljs-keyword">implements</span>Â <span class="hljs-title class_">PaymentMethod</span>Â {
Â Â Â Â <span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">pay</span><span class="hljs-params">(<span class="hljs-type">double</span>Â amount)</span>Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}
</code></pre>
<p>è¿™å°±æ˜¯"å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­"ã€‚</p>
<hr/>
<h3 data-id="heading-11">Optionalï¼šå‘Šåˆ«NullPointerException</h3>
<h4 data-id="heading-12">è¢«nullæŠ˜ç£¨çš„æ—¥å­</h4>
<p>è¯´å®è¯ï¼ŒåšJavaå¼€å‘æœ€æ€•çš„å°±æ˜¯<code>NullPointerException</code>ã€‚æˆ‘åˆšå¼€å§‹å†™ä»£ç çš„æ—¶å€™ï¼Œç»å¸¸é‡åˆ°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//Â è¿™ç§åµŒå¥—çš„nullæ£€æŸ¥ï¼Œå†™å¤šäº†çœŸçš„æƒ³å“­</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">getUserName</span>(<span class="hljs-params">UserÂ user</span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Profile</span>Â profileÂ =Â user.<span class="hljs-title function_">getProfile</span>();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (profileÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â profile.<span class="hljs-title function_">getName</span>();
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"Unknown"</span>;
}
</code></pre>
<p>ä»£ç åˆä¸‘åˆå®¹æ˜“å‡ºé”™ï¼Œä¸€ä¸å°å¿ƒå°±æ¼æ‰ä¸€ä¸ªnullæ£€æŸ¥ã€‚</p>
<h4 data-id="heading-13">nullçš„"é»‘å†å²"</h4>
<p><strong>1965å¹´</strong>ï¼Œ<strong>Tony Hoare</strong>åœ¨è®¾è®¡ALGOL Wè¯­è¨€æ—¶å¼•å…¥äº†nullå¼•ç”¨ã€‚ä»–åæ¥æ‰¿è®¤è¿™æ˜¯"ä¸€ä¸ªä»·å€¼åäº¿ç¾å…ƒçš„é”™è¯¯"ã€‚</p>
<p>ç¡®å®ï¼Œnullå¼•ç”¨å¯¼è‡´äº†æ— æ•°bugã€‚å…¶ä»–è¯­è¨€æ—©å°±æƒ³åŠæ³•è§£å†³äº†ï¼š</p>
<ul>
<li><strong>Scala</strong>ç”¨<code>Option[T]</code></li>
<li><strong>Haskell</strong>ç”¨<code>Maybe</code></li>
<li><strong>Kotlin</strong>ç”¨å¯ç©ºç±»å‹<code>String?</code></li>
</ul>
<h4 data-id="heading-14">Java 8çš„æ•‘æ˜Ÿï¼šOptional</h4>
<p><strong>2014å¹´</strong>ï¼ŒJava 8ç»ˆäºå¼•å…¥äº†<code>Optional</code>ï¼Œå€Ÿé‰´äº†å‡½æ•°å¼ç¼–ç¨‹çš„ç»éªŒã€‚</p>
<p>ç°åœ¨å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â ä¼˜é›…å¤šäº†ï¼</span>
publicÂ StringÂ <span class="hljs-built_in">getUserName</span>(UserÂ user)Â {
Â Â Â Â returnÂ Optional<span class="hljs-selector-class">.ofNullable</span>(user)
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(User::getProfile)
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(Profile::getName)
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.orElse</span>("Unknown");
}
</code></pre>
<p>é“¾å¼è°ƒç”¨ï¼Œä¸€è¡Œæå®šï¼Œå†ä¹Ÿä¸ç”¨å†™ä¸€å †ifäº†ã€‚</p>
<p>åŸºæœ¬ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Optional&lt;String&gt;Â optÂ =Â Optional<span class="hljs-selector-class">.ofNullable</span>(value);
opt<span class="hljs-selector-class">.orElse</span>("é»˜è®¤å€¼");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å®‰å…¨è·å–å€¼</span>
opt<span class="hljs-selector-class">.ifPresent</span>(System.out::println);Â Â Â Â Â Â <span class="hljs-comment">//Â å­˜åœ¨æ‰æ‰§è¡Œ</span>
opt<span class="hljs-selector-class">.orElseThrow</span>(()Â -&gt;Â newÂ <span class="hljs-built_in">Exception</span>());Â <span class="hljs-comment">//Â ä¸å­˜åœ¨æŠ›å¼‚å¸¸</span>
</code></pre>
<p>ä¸è¿‡è¯´å®è¯ï¼ŒOptionalä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œç”¨ä¸å¥½åè€Œä¼šè®©ä»£ç å˜å¤æ‚ã€‚å…³é”®æ˜¯è¦ç†è§£å®ƒçš„è®¾è®¡æ€æƒ³ã€‚</p>
<hr/>
<h3 data-id="heading-15">Objectï¼šJavaçš„ä¸‡ç‰©ä¹‹æº</h3>
<h4 data-id="heading-16">æ‰€æœ‰ç±»çš„ç¥–å®—</h4>
<p>åœ¨Javaé‡Œï¼Œ<code>Object</code>æ˜¯æ‰€æœ‰ç±»çš„æ ¹ç±»ã€‚ä¸ç®¡ä½ å†™ä»€ä¹ˆç±»ï¼Œæœ€ç»ˆéƒ½ç»§æ‰¿è‡ªObjectã€‚</p>
<p>è¿™ä¸ªè®¾è®¡æ˜¯Javaåœ¨<strong>1995å¹´</strong>å‘å¸ƒæ—¶å°±å®šä¸‹çš„ï¼Œå½±å“äº†æ•´ä¸ªJavaç±»å‹ç³»ç»Ÿã€‚</p>
<h4 data-id="heading-17">Objectçš„æ ¸å¿ƒæ–¹æ³•</h4>
<p>Objectç±»æœ‰å‡ ä¸ªé‡è¦æ–¹æ³•ï¼Œé¢è¯•ç»å¸¸é—®ï¼š</p>
<p><strong>toString()</strong> - å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">toString</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"Person{name='"</span>Â +Â nameÂ +Â <span class="hljs-string">"',Â age="</span>Â +Â ageÂ +Â <span class="hljs-string">"}"</span>;
}
</code></pre>
<p><strong>equals() å’Œ hashCode()</strong> - è¿™ä¸¤ä¸ªå¿…é¡»ä¸€èµ·é‡å†™</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-built_in">boolean</span>Â <span class="hljs-title function_">equals</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>Â obj</span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>Â ==Â obj)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">true</span>;
Â Â Â Â <span class="hljs-keyword">if</span>Â (objÂ ==Â <span class="hljs-literal">null</span>Â ||Â <span class="hljs-title function_">getClass</span>()Â !=Â obj.<span class="hljs-title function_">getClass</span>())Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>;
Â Â Â Â <span class="hljs-title class_">Student</span>Â studentÂ =Â (<span class="hljs-title class_">Student</span>)Â obj;
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Objects</span>.<span class="hljs-title function_">equals</span>(id,Â student.<span class="hljs-property">id</span>);
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span>Â intÂ <span class="hljs-title function_">hashCode</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Objects</span>.<span class="hljs-title function_">hash</span>(id);
}
</code></pre>
<p><strong>é‡è¦</strong>ï¼šé‡å†™equals()å¿…é¡»é‡å†™hashCode()ï¼Œä¸ç„¶ç”¨HashMapã€HashSetä¼šå‡ºé—®é¢˜ã€‚æˆ‘å½“å¹´å°±å› ä¸ºè¿™ä¸ªè¸©è¿‡å‘ã€‚</p>
<p><strong>getClass()</strong> - è·å–å¯¹è±¡çš„ç±»ï¼ˆåå°„ç”¨ï¼‰</p>
<p><strong>clone()</strong> - å¯¹è±¡å…‹éš†ï¼ˆä¸æ¨èç”¨ï¼Œå»ºè®®ç”¨æ‹·è´æ„é€ å‡½æ•°ï¼‰</p>
<p><strong>wait()ã€notify()ã€notifyAll()</strong> - çº¿ç¨‹é€šä¿¡ï¼ˆJava 5åæ¨èç”¨<code>java.util.concurrent</code>åŒ…ï¼‰</p>
<p><strong>finalize()</strong> - å¯¹è±¡ç»ˆç»“ï¼ˆJava 9å·²åºŸå¼ƒï¼Œç”¨try-with-resourcesï¼‰</p>
<hr/>
<h3 data-id="heading-18">å„ç§å¯¹è±¡ç±»å‹ï¼šPOJOã€VOã€BOã€DTOã€DOã€DAO</h3>
<h4 data-id="heading-19">åˆšå¼€å§‹æˆ‘ä¹Ÿåˆ†ä¸æ¸…</h4>
<p>åšJavaä¼ä¸šçº§å¼€å‘ï¼Œä½ ä¼šå‘ç°åˆ°å¤„éƒ½æ˜¯"O"ï¼šPOJOã€VOã€BOã€DTOã€DOã€DAO...</p>
<p>åˆšå¼€å§‹æˆ‘ä¹Ÿåˆ†ä¸æ¸…ï¼Œåæ¥è¸©äº†æ— æ•°å‘æ‰æ˜ç™½ã€‚</p>
<h4 data-id="heading-20">ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤š"O"ï¼Ÿ</h4>
<p><strong>1990å¹´ä»£</strong>ï¼Œä¸‰å±‚æ¶æ„å…´èµ·ï¼š</p>
<ul>
<li>è¡¨ç¤ºå±‚ï¼ˆç”¨æˆ·ç•Œé¢ï¼‰</li>
<li>ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆä¸šåŠ¡å¤„ç†ï¼‰</li>
<li>æ•°æ®è®¿é—®å±‚ï¼ˆæ•°æ®æŒä¹…åŒ–ï¼‰</li>
</ul>
<p>ä¸åŒå±‚éœ€è¦ä¸åŒçš„å¯¹è±¡ç±»å‹æ¥æ‰¿è½½æ•°æ®ï¼Œäºæ˜¯å„ç§"O"å°±å‡ºç°äº†ã€‚</p>
<p><strong>2000å¹´ä»£</strong>ï¼ŒJava EEæ ‡å‡†åŒ–äº†è¿™äº›å‘½åï¼Œå½¢æˆäº†ä»Šå¤©æˆ‘ä»¬çœ‹åˆ°çš„å„ç§"O"ã€‚</p>
<h4 data-id="heading-21">å„ç§"O"éƒ½æ˜¯å•¥ï¼Ÿ</h4>
<p><strong>1. POJO</strong> - æœ€åŸºç¡€çš„å¯¹è±¡ï¼Œä¸ä¾èµ–ä»»ä½•æ¡†æ¶</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â çº¯ç²¹çš„Javaå¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½•æ¡†æ¶ä¾èµ–</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">User</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-built_in">Long</span>Â id;
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ username;
Â Â Â Â <span class="hljs-comment">//Â getter/setter</span>
}
</code></pre>
<p><strong>2. DO</strong> - æ•°æ®å¯¹è±¡ï¼Œå¯¹åº”æ•°æ®åº“è¡¨</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â å¯¹åº”æ•°æ®åº“è¡¨ç»“æ„</span>
<span class="hljs-meta">@Table(nameÂ =Â <span class="hljs-string">"t_user"</span>)</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserDO</span>Â {
Â Â Â Â <span class="hljs-meta">@Id</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-built_in">Long</span>Â id;
Â Â Â Â <span class="hljs-meta">@Column(nameÂ =Â <span class="hljs-string">"username"</span>)</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ username;
}
</code></pre>
<p><strong>3. DTO</strong> - æ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œç”¨äºAPIæ¥å£</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â ç”¨äºAPIæ¥å£çš„æ•°æ®ä¼ è¾“ï¼Œå¯èƒ½ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserDTO</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-built_in">Long</span>Â id;
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ username;
Â Â Â Â <span class="hljs-comment">//Â æ²¡æœ‰passwordå­—æ®µ</span>
}
</code></pre>
<p><strong>4. VO</strong> - å€¼å¯¹è±¡ï¼Œç”¨äºå‰ç«¯å±•ç¤º</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â ç”¨äºå‰ç«¯å±•ç¤ºï¼Œå¯èƒ½åŒ…å«æ ¼å¼åŒ–åçš„æ•°æ®</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserVO</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â LongÂ id;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-type">String</span>Â username;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-type">String</span>Â ageGroup;Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â "é’å¹´"ã€"ä¸­å¹´"ç­‰</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-type">String</span>Â formattedTime;Â Â Â <span class="hljs-comment">//Â æ ¼å¼åŒ–åçš„æ—¶é—´</span>
}
</code></pre>
<p><strong>5. BO</strong> - ä¸šåŠ¡å¯¹è±¡ï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//Â åŒ…å«ä¸šåŠ¡é€»è¾‘å’Œä¸šåŠ¡è§„åˆ™</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserBO</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Long</span>Â id;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">OrderBO</span>&gt;Â orders;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ä¸šåŠ¡æ–¹æ³•</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">boolean</span>Â <span class="hljs-title function_">isAdult</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â ageÂ !=Â <span class="hljs-literal">null</span>Â &amp;&amp;Â ageÂ &gt;=Â <span class="hljs-number">18</span>;
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">boolean</span>Â <span class="hljs-title function_">canPlaceOrder</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">isAdult</span>()Â &amp;&amp;Â orders.<span class="hljs-title function_">size</span>()Â &lt;Â <span class="hljs-number">100</span>;
Â Â Â Â }
}
</code></pre>
<p><strong>6. DAO</strong> - æ•°æ®è®¿é—®å¯¹è±¡ï¼Œå°è£…æ•°æ®åº“æ“ä½œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//Â æ•°æ®è®¿é—®å±‚</span>
<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">UserDAO</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_">BaseMapper</span>&lt;UserDO&gt;Â {
Â Â Â Â UserDOÂ <span class="hljs-title function_">findByUsername</span><span class="hljs-params">(StringÂ username)</span>;
}
</code></pre>
<p>è¯´å®è¯ï¼Œå°é¡¹ç›®ä¸ä¸€å®šéœ€è¦è¿™ä¹ˆå¤šç±»å‹ï¼Œä½†å¤§é¡¹ç›®ç¡®å®éœ€è¦åŒºåˆ†æ¸…æ¥šï¼Œä¸ç„¶ä»£ç ä¼šä¹±æˆä¸€å›¢ã€‚</p>
<h4 data-id="heading-22">å¯¹è±¡ç±»å‹ä¹‹é—´çš„è½¬æ¢</h4>
<p>å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦åœ¨ä¸åŒå¯¹è±¡ç±»å‹ä¹‹é—´è½¬æ¢ã€‚å¯ä»¥æ‰‹åŠ¨å†™è½¬æ¢æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨MapStructè‡ªåŠ¨ç”Ÿæˆï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â æ‰‹åŠ¨è½¬æ¢ï¼ˆå†™å¤šäº†å¾ˆçƒ¦ï¼‰</span>
publicÂ staticÂ UserDTOÂ <span class="hljs-built_in">toDTO</span>(UserDOÂ userDO)Â {
Â Â Â Â UserDTOÂ dtoÂ =Â newÂ <span class="hljs-built_in">UserDTO</span>();
Â Â Â Â dto<span class="hljs-selector-class">.setId</span>(userDO.getId());
Â Â Â Â dto<span class="hljs-selector-class">.setUsername</span>(userDO.getUsername());
Â Â Â Â returnÂ dto;
}

<span class="hljs-comment">//Â ç”¨MapStructè‡ªåŠ¨ç”Ÿæˆï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">@Mapper</span>(componentModelÂ =Â <span class="hljs-string">"spring"</span>)
publicÂ interfaceÂ UserMapperÂ {
Â Â Â Â UserDTOÂ <span class="hljs-built_in">toDTO</span>(UserDOÂ userDO);
Â Â Â Â UserVOÂ <span class="hljs-built_in">toVO</span>(UserDOÂ userDO);
}
</code></pre>
<h4 data-id="heading-23">å®é™…åº”ç”¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â Controllerå±‚ï¼šæ¥æ”¶DTOï¼Œè¿”å›VO</span>
<span class="hljs-meta">@GetMapping(<span class="hljs-string">"/{id}"</span>)</span>
<span class="hljs-keyword">public</span>Â UserVOÂ getUser(<span class="hljs-meta">@PathVariable</span>Â <span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â UserBOÂ boÂ =Â userService.getUserById(id);
Â Â Â Â <span class="hljs-keyword">return</span>Â UserConverter.toVO(bo);
}

<span class="hljs-comment">//Â Serviceå±‚ï¼šä½¿ç”¨BOå¤„ç†ä¸šåŠ¡é€»è¾‘</span>
<span class="hljs-keyword">public</span>Â UserBOÂ getUserById(<span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â UserDOÂ <span class="hljs-keyword">do</span>Â =Â userDAO.selectById(id);
Â Â Â Â UserBOÂ boÂ =Â UserConverter.toBO(<span class="hljs-keyword">do</span>);
Â Â Â Â <span class="hljs-comment">//Â ä¸šåŠ¡é€»è¾‘å¤„ç†</span>
Â Â Â Â <span class="hljs-keyword">return</span>Â bo;
}
</code></pre>
<h4 data-id="heading-24">å¯¹è±¡ç±»å‹çš„å¯¹æ¯”æ€»ç»“</h4>






















































<table><thead><tr><th>å¯¹è±¡ç±»å‹</th><th>å…¨ç§°</th><th>ç”¨é€”</th><th>ç‰¹ç‚¹</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>POJO</td><td>Plain Old Java Object</td><td>åŸºç¡€å¯¹è±¡</td><td>æ— æ¡†æ¶ä¾èµ–</td><td>æ‰€æœ‰åœºæ™¯çš„åŸºç¡€</td></tr><tr><td>DO</td><td>Data Object</td><td>æ•°æ®æŒä¹…åŒ–</td><td>å¯¹åº”æ•°æ®åº“è¡¨</td><td>æ•°æ®è®¿é—®å±‚</td></tr><tr><td>DTO</td><td>Data Transfer Object</td><td>æ•°æ®ä¼ è¾“</td><td>è·¨å±‚/è·¨æœåŠ¡ä¼ è¾“</td><td>APIæ¥å£ã€æœåŠ¡é—´é€šä¿¡</td></tr><tr><td>VO</td><td>Value Object</td><td>å€¼å¯¹è±¡</td><td>å±•ç¤ºæ•°æ®</td><td>å‰ç«¯å±•ç¤º</td></tr><tr><td>BO</td><td>Business Object</td><td>ä¸šåŠ¡å¯¹è±¡</td><td>åŒ…å«ä¸šåŠ¡é€»è¾‘</td><td>ä¸šåŠ¡é€»è¾‘å±‚</td></tr><tr><td>DAO</td><td>Data Access Object</td><td>æ•°æ®è®¿é—®</td><td>å°è£…æ•°æ®åº“æ“ä½œ</td><td>æ•°æ®è®¿é—®å±‚</td></tr></tbody></table>
<h4 data-id="heading-25">æœ€ä½³å®è·µ</h4>
<ol>
<li><strong>æ˜ç¡®èŒè´£</strong>ï¼šæ¯ä¸ªå¯¹è±¡ç±»å‹éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼Œä¸è¦æ··ç”¨</li>
<li><strong>é¿å…è¿‡åº¦è®¾è®¡</strong>ï¼šå°é¡¹ç›®å¯ä»¥ç®€åŒ–ï¼Œä¸ä¸€å®šéœ€è¦æ‰€æœ‰å¯¹è±¡ç±»å‹</li>
<li><strong>ä½¿ç”¨å·¥å…·</strong>ï¼šä½¿ç”¨MapStructã€BeanUtilsç­‰å·¥å…·ç®€åŒ–è½¬æ¢</li>
<li><strong>ä¿æŒä¸€è‡´æ€§</strong>ï¼šå›¢é˜Ÿå†…éƒ¨ç»Ÿä¸€å‘½åå’ŒèŒè´£å®šä¹‰</li>
<li><strong>æ–‡æ¡£è¯´æ˜</strong>ï¼šåœ¨é¡¹ç›®æ–‡æ¡£ä¸­æ˜ç¡®å„ç§å¯¹è±¡ç±»å‹çš„å®šä¹‰å’Œä½¿ç”¨åœºæ™¯</li>
</ol>
<hr/>
<h3 data-id="heading-26">å…¶ä»–é‡è¦çš„"O"</h3>
<h4 data-id="heading-27">Observeræ¨¡å¼ - è§‚å¯Ÿè€…æ¨¡å¼</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">Observer</span>Â {
Â Â Â Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">update</span>(<span class="hljs-title class_">String</span>Â message);
}

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Subject</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Observer</span>&gt;Â observersÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">notifyObservers</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â message</span>)Â {
Â Â Â Â Â Â Â Â observers.<span class="hljs-title function_">forEach</span>(obsÂ -&gt;Â obs.<span class="hljs-title function_">update</span>(message));
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-28">Overrideæ³¨è§£ - æ–¹æ³•é‡å†™æ ‡è®°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Child</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_">Parent</span>Â {
Â Â Â Â <span class="hljs-meta">@Override</span>Â Â <span class="hljs-comment">//Â æ˜ç¡®æ ‡è®°è¿™æ˜¯é‡å†™æ–¹æ³•</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">method</span><span class="hljs-params">()</span>Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}
</code></pre>
<p>Java 5å¼•å…¥æ³¨è§£åï¼Œ@Overrideå¸®åŠ©é¿å…æ‹¼å†™é”™è¯¯ã€‚</p>
<h4 data-id="heading-29">Overload - æ–¹æ³•é‡è½½</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â åŒåæ–¹æ³•ï¼Œä¸åŒå‚æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">int</span>Â <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span>Â a,Â <span class="hljs-type">int</span>Â b)</span>Â </span>{Â <span class="hljs-keyword">return</span>Â aÂ +Â b;Â }
<span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">double</span>Â <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">double</span>Â a,Â <span class="hljs-type">double</span>Â b)</span>Â </span>{Â <span class="hljs-keyword">return</span>Â aÂ +Â b;Â }
</code></pre>
<hr/>
<h3 data-id="heading-30">æ€»ç»“</h3>
<h4 data-id="heading-31">æ—¶é—´çº¿å›é¡¾</h4>





































<table><thead><tr><th>æ—¶é—´</th><th>äº‹ä»¶</th></tr></thead><tbody><tr><td>1894å¹´</td><td>å·´èµ«æ›¼å¼•å…¥å¤§Oç¬¦å·</td></tr><tr><td>1960å¹´ä»£</td><td>Simulaå¼•å…¥OOPæ¦‚å¿µ</td></tr><tr><td>1965å¹´</td><td>nullå¼•ç”¨çš„è¯ç”Ÿï¼ˆ"åäº¿ç¾å…ƒçš„é”™è¯¯"ï¼‰</td></tr><tr><td>1968å¹´</td><td>å…‹åŠªç‰¹å°†å¤§Oå¼•å…¥è®¡ç®—æœºç§‘å­¦</td></tr><tr><td>1995å¹´</td><td>Javaå‘å¸ƒï¼ŒObjectç±»è¯ç”Ÿ</td></tr><tr><td>2000å¹´</td><td>POJOæ¦‚å¿µæå‡º</td></tr><tr><td>2014å¹´</td><td>Java 8å‘å¸ƒï¼Œå¼•å…¥Optional</td></tr></tbody></table>
<h4 data-id="heading-32">æ ¸å¿ƒè¦ç‚¹</h4>
<ol>
<li><strong>Big O</strong> - ç†è§£ç®—æ³•æ€§èƒ½ï¼Œé¢è¯•å¿…å¤‡</li>
<li><strong>OOP</strong> - Javaçš„ç¼–ç¨‹å“²å­¦ï¼Œå¿…é¡»æŒæ¡</li>
<li><strong>Optional</strong> - ä¼˜é›…å¤„ç†nullï¼Œå‘Šåˆ«NullPointerException</li>
<li><strong>Object</strong> - æ‰€æœ‰ç±»çš„æ ¹åŸºï¼Œç†è§£Javaçš„åŸºç¡€</li>
<li><strong>å„ç§å¯¹è±¡ç±»å‹</strong> - åˆ†å±‚æ¶æ„çš„ä½“ç°ï¼Œå¤§é¡¹ç›®å¿…é¡»åŒºåˆ†æ¸…æ¥š</li>
</ol>
<h4 data-id="heading-33">å­¦ä¹ å»ºè®®</h4>
<ol>
<li><strong>Big O</strong> - å¤šåˆ·LeetCodeï¼ŒåŸ¹å…»å¤æ‚åº¦åˆ†æçš„ç›´è§‰</li>
<li><strong>OOP</strong> - å¤šå†™ä»£ç ï¼Œç†è§£å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€æŠ½è±¡</li>
<li><strong>Optional</strong> - åœ¨é¡¹ç›®ä¸­å¤šç”¨ï¼Œä½†åˆ«è¿‡åº¦ä½¿ç”¨</li>
<li><strong>Object</strong> - ç†è§£equals/hashCodeçš„å…³ç³»ï¼Œè¿™æ˜¯åŸºç¡€</li>
<li><strong>å¯¹è±¡ç±»å‹</strong> - å°é¡¹ç›®å¯ä»¥ç®€åŒ–ï¼Œå¤§é¡¹ç›®å¿…é¡»åŒºåˆ†æ¸…æ¥š</li>
</ol>
<hr/>
<h3 data-id="heading-34">å»¶ä¼¸é˜…è¯»</h3>
<ul>
<li>ã€Šç®—æ³•å¯¼è®ºã€‹- å¤§Oè¡¨ç¤ºæ³•çš„æ•°å­¦åŸºç¡€</li>
<li>ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹- OOPçš„è®¾è®¡æ¨¡å¼</li>
<li>ã€ŠEffective Javaã€‹- Javaæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬Optionalçš„ä½¿ç”¨</li>
<li>ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹- Objectçš„wait/notifyæœºåˆ¶</li>
<li>ã€Šä¼ä¸šåº”ç”¨æ¶æ„æ¨¡å¼ã€‹- Martin Fowlerï¼ŒDTOæ¨¡å¼çš„æå‡ºè€…</li>
<li>ã€Šé¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹- Eric Evansï¼ŒVOå’ŒBOçš„ç†è®ºåŸºç¡€</li>
<li>ã€Šé‡æ„ï¼šæ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹- Martin Fowlerï¼ŒPOJOçš„æœ€ä½³å®è·µ</li>
</ul>
<hr/>
<p><strong>å†™åœ¨æœ€å</strong>ï¼š</p>
<p>è¯´å®è¯ï¼Œåˆšå¼€å§‹å­¦Javaçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿè¢«è¿™äº›"O"ææ‡µè¿‡ã€‚ä½†å†™å¤šäº†ä»£ç ï¼Œè¸©äº†æ— æ•°å‘ä¹‹åï¼Œæ‰æ…¢æ…¢ç†è§£å®ƒä»¬èƒŒåçš„æ€æƒ³ã€‚</p>
<p>ä»æ•°å­¦ç¬¦å·åˆ°ç¼–ç¨‹èŒƒå¼ï¼Œä»ç©ºå€¼å¤„ç†åˆ°ç±»å‹ç³»ç»Ÿï¼Œæ¯ä¸€ä¸ª"O"éƒ½æ‰¿è½½ç€è®¡ç®—æœºç§‘å­¦çš„å‘å±•å†ç¨‹ã€‚</p>
<p>ç†è§£è¿™äº›"O"çš„å‰ä¸–ä»Šç”Ÿï¼Œä¸ä»…èƒ½å¸®æˆ‘ä»¬å†™å‡ºæ›´å¥½çš„ä»£ç ï¼Œæ›´èƒ½è®©æˆ‘ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œçœ‹åˆ°ç¼–ç¨‹è¯­è¨€è®¾è®¡çš„æ™ºæ…§ã€‚</p>
<p>è®°ä½ï¼š<strong>æŠ€æœ¯ä¼šå˜ï¼Œä½†æ€æƒ³æ°¸æ’ã€‚æŒæ¡è¿™äº›"O"èƒŒåçš„æ€æƒ³ï¼Œæ¯”è®°ä½è¯­æ³•æ›´é‡è¦ã€‚</strong></p>
<p>æœ¬æ–‡ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> æ’ç‰ˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆæ¢ollamaåˆ©ç”¨dockeræç®€éƒ¨ç½²å±äºè‡ªå·±çš„å¤§æ¨¡å‹]]></title>    <link>https://juejin.cn/post/7598818096728850470</link>    <guid>https://juejin.cn/post/7598818096728850470</guid>    <pubDate>2026-01-24T07:32:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598818096728850470" data-draft-id="7598218938758627366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆæ¢ollamaåˆ©ç”¨dockeræç®€éƒ¨ç½²å±äºè‡ªå·±çš„å¤§æ¨¡å‹"/> <meta itemprop="keywords" content="Ollama"/> <meta itemprop="datePublished" content="2026-01-24T07:32:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yezannnnnn"/> <meta itemprop="url" content="https://juejin.cn/user/958429869908247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆæ¢ollamaåˆ©ç”¨dockeræç®€éƒ¨ç½²å±äºè‡ªå·±çš„å¤§æ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/958429869908247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yezannnnnn
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:32:35.000Z" title="Sat Jan 24 2026 07:32:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-sulphurpool-light">.hljs-comment,.hljs-quote{color:#6b7394}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#c94922}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#c76b29}.hljs-bullet,.hljs-string,.hljs-symbol{color:#ac9739}.hljs-section,.hljs-title{color:#3d8fd1}.hljs-keyword,.hljs-selector-tag{color:#6679cc}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#f5f7ff;color:#5e6687}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å¸Œæœ›åœ¨æœ¬åœ°æˆ–ç§æœ‰ç¯å¢ƒä¸­å¿«é€Ÿæ„å»ºå±äºè‡ªå·±çš„æ¨¡å‹æœåŠ¡ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨Â <code>Ollama</code>Â è¿™ä¸€å¼€æºå·¥å…·ï¼Œåœ¨ Docker ç¯å¢ƒä¸‹å¿«é€Ÿæ­å»ºå¤§æ¨¡å‹æœåŠ¡ã€‚</p>
<p>æœ¬æ–‡å°†ä»¥ <code>macOS</code> ç¯å¢ƒä¸ºä¾‹ï¼Œä»é›¶å¼€å§‹è®°å½•éƒ¨ç½²å…¨è¿‡ç¨‹ï¼Œå¹¶é’ˆå¯¹è¿‡ç¨‹ä¸­é‡åˆ°çš„ç½‘ç»œã€å†…å­˜é…ç½®ç­‰å¸¸è§é—®é¢˜æä¾›è§£å†³æ–¹æ¡ˆï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>
<p><code>æ°´å¹³æœ‰é™åªæ˜¯åˆ†äº«ï¼Œå¤§å®¶å–å…¶ç²¾åï¼Œå»å…¶ç³Ÿç²•</code></p>
<h3 data-id="heading-1">ä»‹ç»Ollama</h3>
<p>Ollama æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œæ—¨åœ¨ç®€åŒ–å¤§è¯­è¨€æ¨¡å‹åœ¨æœ¬åœ°è®¾å¤‡çš„éƒ¨ç½²å’Œè¿è¡Œã€‚å®ƒæ”¯æŒä¸€é”®ä¸‹è½½å’Œè¿è¡Œ<code>Llama 3</code>ã€<code>Qwen</code> ç­‰ä¸»æµå¼€æºæ¨¡å‹ï¼Œæ— éœ€å¤æ‚çš„é…ç½®ã€‚åŒæ—¶ï¼Œå®ƒæä¾›æœ¬åœ° <code>API</code> æœåŠ¡ï¼Œèƒ½æ–¹ä¾¿åœ°é›†æˆåˆ°å„ç±»åº”ç”¨ä¸­ï¼Œä¿æŠ¤æ•°æ®éšç§ä¸”é›¶æˆæœ¬ã€‚</p>
<h3 data-id="heading-2">éƒ¨ç½²å®‰è£…åŠè¿è¡Œ</h3>
<h4 data-id="heading-3">ä¸€ã€å®‰è£…docker</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">brewæ¥å®‰è£…docker</span>
brewÂ installÂ --cask docker
<span class="hljs-meta prompt_"># </span><span class="bash">æ£€éªŒæ˜¯å¦dockerå®‰è£…å¹¶è¿è¡ŒæˆåŠŸ</span>
docker ps
</code></pre>
<p>å‡ºç°ä»¥ä¸‹æˆªå›¾åˆ™è¡¨ç¤º<code>docker</code>å·²ç»æˆåŠŸè¿è¡Œåœ¨åå°ä¸­</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00eabfab8d1d4c93b7ddc2bb388e2c41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=BYzoKWQ4oViKKNMzHQjY0F63qL8%3D" alt="dockerç›®å½•è¿è¡ŒæˆåŠŸ.png" loading="lazy"/></p>
<h4 data-id="heading-4">äºŒã€dockerä¸‹è¿è¡ŒOllama</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æ‹‰å–å®˜æ–¹dockeræº</span>
docker pull ollama/ollama
<span class="hljs-meta prompt_"># </span><span class="bash">æŒ‡å®šå·ç¬¦ç›®å½•è¿è¡Œæ¨¡å‹ï¼ˆè¿™æ ·æ¨¡å‹ä¸‹è½½åä¸‹æ¬¡è¿è¡Œä¸ç”¨å†ä¸‹è½½ï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  `-d`ï¼šåœ¨åå°è¿è¡Œå®¹å™¨ã€‚</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  `--name my-ollama`ï¼šä¸ºä½ çš„å®¹å™¨æŒ‡å®šçš„åç§°ã€‚</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  `-p 11434:11434`ï¼šå°† Ollama çš„é»˜è®¤ç«¯å£æ˜ å°„åˆ°ä½ çš„å®¿ä¸»æœºå™¨ã€‚</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  `-v ollama:/root/.ollama`ï¼šä¸ºä¸‹è½½çš„æ¨¡å‹åˆ›å»ºäº†ä¸€ä¸ªæŒä¹…åŒ–å·ï¼ˆvolumeï¼‰ã€‚</span>
docker run -d -v ollama:/root/.ollama -p 11434:11434 --name my-ollama ollama/ollama
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># æ£€æŸ¥æŒ‡å®šå·ç¬¦ä¸‹æ˜¯å¦åˆ›å»ºollamaå®¹å™¨</span></span>
docker ps -a 
</code></pre>
<p>å‡ºç°ä»¥ä¸‹æˆªå›¾åˆ™è¡¨ç¤ºåˆ›å»ºå®¹å™¨æˆåŠŸ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d079ca94e2af4dd590da0dc96b0c656b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=9h%2BsZ1aXyJrOU7u7r9aN0CF%2F6IQ%3D" alt="image.png" loading="lazy"/></p>
<p>å¹¶ä¸”çœ‹çœ‹ <strong>localhost:11434</strong>æ˜¯å¦å·²ç»æˆåŠŸç›‘å¬è¿è¡ŒæˆåŠŸ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/546f5715898c4838b5e64a92e620b763~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=beDGyEWyqRXzs5nLlE4fe2zO43s%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">ä¸‰ã€Ollamaè¿è¡Œæ¨¡å‹</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æŒ‰ç…§ollamaçš„å®˜æ–¹æ–‡æ¡£ä¸‹è½½gemma3æ¨¡å‹</span>
docker exec -it my-ollama ollama pull gemma3
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e2cc8ea18894474aec2fe4e5d92750b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=EuoHST%2B98klX5l1XiNyE6L%2BKg%2B4%3D" alt="image.png" loading="lazy"/></p>
<p>å¥½äº†ä¸€åˆ‡éƒ½å·²ç»å‡†å¤‡å°±ç»ªäº† é‚£æœ¬åœ°æ¨¡å‹å·²ç»æˆåŠŸè¿è¡Œäº†ï¼Œèµ¶ç´§è¯•è¯•æ•ˆæœæ€ä¹ˆæ ·ã€‚</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æŒ‰ç…§ollamaçš„å®˜æ–¹æ–‡æ¡£ç›´æ¥æµ‹è¯•ä¸€ä¸‹å§</span>
curl http://localhost:11434/api/chat -d '{
  "model": "gemma3",
  "messages": [{
    "role": "user",
    "content": "ollamaæ˜¯ä»€ä¹ˆæœ‰ä»€ä¹ˆç”¨"
  }],
  "stream": false
}'
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4358c7ce2fb4fd9bbf4626c8e91b0fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=EfZ%2Ff8yjoBap3fZcHenjPV5RMUw%3D" alt="image.png" loading="lazy"/>
åŸºæœ¬ä¸Š<code>ollama</code>æœ¬åœ°éƒ¨ç½²è‡ªå·±çš„å¤§æ¨¡å‹å°±å®Œæˆäº†ï¼Œè‡ªå·±æ…¢æ…¢æŠŠç©å§</p>
<h3 data-id="heading-6">éƒ¨ç½²è¿‡ç¨‹é—®é¢˜åŠè§£å†³</h3>
<blockquote>
<ul>
<li><strong>é—®é¢˜: æ‰§è¡Œdocker pullæŠ¥é”™å¦‚ä¸‹<code>context deadline exceeded</code></strong></li>
<li><strong>è§£å†³æ–¹æ³•ï¼šé—®é¢˜å‡ºåœ¨dockeré»˜è®¤æºdockerhubæ‹‰ä¸åˆ°æ¢æºå³å¯</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/028859584b60445b89e8daa93f278dc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=vGQSNJbKQ%2F14%2BWmiLqC%2Ft5K3kFg%3D" alt="image.png" loading="lazy"/></li>
</ul>
</blockquote>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// é…ç½®æ¢æºå³æœ‰æ•ˆ</span>
<span class="hljs-attr">"registry-mirrors"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"https://docker.registry.cyou"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker-cf.registry.cyou"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://dockercf.jsdelivr.fyi"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.jsdelivr.fyi"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://dockertest.jsdelivr.fyi"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://mirror.aliyuncs.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://dockerproxy.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://mirror.baidubce.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.m.daocloud.io"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.nju.edu.cn"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.mirrors.sjtug.sjtu.edu.cn"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.mirrors.ustc.edu.cn"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://mirror.iscas.ac.cn"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://docker.rainbond.cc"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://do.nark.eu.org"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://dc.j8.work"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://dockerproxy.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://gst6rzl9.mirror.aliyuncs.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://registry.docker-cn.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"http://hub-mirror.c.163.com"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"http://mirrors.ustc.edu.cn/"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://mirrors.tuna.tsinghua.edu.cn/"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"http://mirrors.sohu.com/"</span>
  <span class="hljs-punctuation">]</span>
</code></pre>
<blockquote>
<ul>
<li><strong>é—®é¢˜: æ‰§è¡Œcurl <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A11434%2Fapi%2Fchat" target="_blank" title="http://localhost:11434/api/chat" ref="nofollow noopener noreferrer">http://localhost:11434/api/chat</a> -d æŠ¥é”™å¦‚ä¸‹</strong></li>
<li><strong>è§£å†³ï¼šé—®é¢˜å‡ºåœ¨æœ¬åœ°å¼€å¯ä»£ç†ï¼Œè¯·å…³é—­ä»£ç†å³å¯æ­£å¸¸</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08d9f0d9ac5146acac243afdc550260f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=tQe7%2BACQIoH3kX7hkaOmGhlYA7g%3D" alt="image.png" loading="lazy"/></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><strong>é—®é¢˜: æ‰§è¡Œcurl <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A11434%2Fapi%2Fchat" target="_blank" title="http://localhost:11434/api/chat" ref="nofollow noopener noreferrer">http://localhost:11434/api/chat</a> -d æŠ¥é”™è¿”å›å†…å®¹</strong></li>
<li><code>{"error":"model requires more system memory (4.8 GiB) than is available (3.8 GiB)"}</code></li>
<li><strong>è§£å†³ï¼šè°ƒæ•´dockeråˆ†é…çš„å†…å­˜å¤§å°å¦‚ä¸‹å›¾</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64b12a32f2bf447a81f3f1c369ef4edc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWV6YW5ubm5ubg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845147&amp;x-signature=50BeSiuNI1CTSMQPmcl0KItN7GA%3D" alt="image.png" loading="lazy"/></li>
</ul>
</blockquote>
<h3 data-id="heading-7">ç»“è¯­</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²æˆåŠŸåœ¨æœ¬åœ°éƒ¨ç½²äº†å¤§æ¨¡å‹æœåŠ¡ï¼Œå¹¶å®ç°äº†æµå¼è¾“å‡ºï¼ˆstreamï¼‰ã€‚åç»­åªéœ€é€šè¿‡åç«¯è¿›è¡Œç®€å•å°è£…ï¼Œå³å¯æ‰“é€ ä¸“å±çš„ AI UI ç•Œé¢ã€‚ç„¶è€Œï¼Œå—é™äºæœ¬åœ°ç¡¬ä»¶ç®—åŠ›ï¼Œæ¨¡å‹ç”Ÿæˆå›ç­”å¹³å‡è€—æ—¶ 20-30 ç§’ï¼Œè¿™è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼š<strong>åœ¨ AI æ—¶ä»£ï¼Œç®—åŠ›ç¡®å®æ˜¯å†³å®šä½“éªŒçš„æ ¸å¿ƒç”Ÿäº§åŠ›ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Git Submoduleï¼šä¸“æ²»é¡¹ç›®åˆå¹¶ â€œå¤§ä¹±ç‚–â€]]></title>    <link>https://juejin.cn/post/7598418891401248822</link>    <guid>https://juejin.cn/post/7598418891401248822</guid>    <pubDate>2026-01-24T03:39:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598418891401248822" data-draft-id="7598099064443502655" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Git Submoduleï¼šä¸“æ²»é¡¹ç›®åˆå¹¶ â€œå¤§ä¹±ç‚–â€"/> <meta itemprop="keywords" content="è¿ç»´,æ•æ·å¼€å‘,Git"/> <meta itemprop="datePublished" content="2026-01-24T03:39:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€å®å·´äº¤çš„éº»åŒª"/> <meta itemprop="url" content="https://juejin.cn/user/4218156332615384"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Git Submoduleï¼šä¸“æ²»é¡¹ç›®åˆå¹¶ â€œå¤§ä¹±ç‚–â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4218156332615384/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€å®å·´äº¤çš„éº»åŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T03:39:31.000Z" title="Sat Jan 24 2026 03:39:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘åœ¨å¾®ä¿¡å…¬ä¼—å·ä¸Šå·²ç»å®ç°äº†æ¡Œæ¸¸â€œè°æ˜¯å§åº•â€å‘ç‰Œå™¨ï¼Œç‹¬ç«‹äºæ­¤é¡¹ç›®ï¼Œåˆå¼€å‘äº†æ¡Œæ¸¸â€œé˜¿ç“¦éš†â€ã€‚ç°åœ¨æˆ‘æƒ³å°†è¿™ä¸¤ä¸ªæ¡Œæ¸¸å‘ç‰Œå™¨åŒæ—¶åœ¨å¾®ä¿¡å…¬ä¼—å·ä¸­æ”¯æŒï¼Œè¯¥å¦‚ä½•è¿›è¡Œé¡¹ç›®ç®¡ç†ï¼Ÿ</p>
<p>å¦ä¸€ä¸ªåœºæ™¯ï¼Œç‹¬ç«‹å¼€å‘å‰åç«¯é¡¹ç›® backend å’Œ frontendï¼Œæƒ³è¦å°†å®ƒä»¬æ•´åˆåœ¨ä¸€èµ·å®ç°<strong>ä¸€é”®éƒ¨ç½²</strong>ï¼Œè¯¥å¦‚ä½•åšï¼Ÿ</p>
<p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œæ˜¯é€‰æ‹©ç®¡ç†å¤šä¸ªå­æ¨¡å—ï¼Œè¿˜æ˜¯åœ¨å¤šä¸ªå­é¡¹ç›®åŸºç¡€ä¸ŠæŠ½è±¡å‡ºçˆ¶é¡¹ç›®ï¼Ÿä»æ¶æ„è®¾è®¡è§’åº¦è€ƒè™‘ï¼Œéµå¾ª<strong>é«˜å†…èšä½è€¦åˆ</strong>çš„åŸåˆ™ï¼Œåè€…æ˜¾ç„¶æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œèƒ½å¤Ÿä¿è¯å„é¡¹ç›®ç‹¬ç«‹å¼€å‘ã€äº’ä¸å¹²æ‰°ï¼Œè€Œçˆ¶é¡¹ç›®åˆ™è´Ÿè´£åè°ƒå„å­é¡¹ç›®çš„æ•´åˆã€‚</p>
<p>æˆ‘å¼•å…¥äº† <code>git submodule</code> æ¥ç®¡ç†å­é¡¹ç›®ï¼Œå®Œç¾å®ç°â€œç‰©ç†éš”ç¦»ï¼Œé€»è¾‘ç»Ÿä¸€â€ã€‚è¿™æ˜¯ä¸€ä¸ªä¸€èˆ¬ç”¨æˆ·æ¥è§¦ä¸åˆ°çš„ git æ¨¡å—ï¼Œä½†å¯¹äºç³»ç»Ÿæ¶æ„è®¾è®¡å¸ˆè€Œè¨€ï¼Œäº†è§£å®ƒçš„å­˜åœ¨å¹¶åœ¨å…·ä½“é¡¹ç›®è§„åˆ’ä¸­åº”ç”¨ï¼Œå°†å‘æŒ¥é‡è¦ä½œç”¨ã€‚</p>
<h2 data-id="heading-0">è™šæ‹Ÿæ¡ˆä¾‹ï¼šç¾å›¢â€œæœ¬åœ°ç”Ÿæ´»â€çš„è¿›åŒ–ä¹‹è·¯</h2>
<p>ä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªâ€œç¾å›¢ç‰ˆâ€çš„åœºæ™¯ã€‚</p>
<p>æ—©æœŸçš„ç¾å›¢ï¼Œå›¢è´­ (tuangou) å’Œ å¤–å– (waimai) æ˜¯ä¸¤å¥—äººé©¬ï¼Œç‹¬ç«‹å¼€å‘å’Œè¿è¥ã€‚éšç€ä¸šåŠ¡ç‰ˆå›¾æ‰©å¼ ï¼Œå…¬å¸æˆç«‹äº† local-life (æœ¬åœ°ç”Ÿæ´») å›¢é˜Ÿï¼Œç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªç»Ÿä¸€é—¨æˆ·ï¼Œæ±‡èšæˆä¸ºé¡¶æµAppï¼Œå æ®åº”ç”¨å•†åº—æ’è¡Œæ¦œã€‚</p>
<p>æ ¸å¿ƒè¯‰æ±‚ï¼š</p>
<ul>
<li>ç»Ÿä¸€å…¥å£ï¼šç”¨æˆ·ç™»å½•ä¸€ä¸ª Appï¼Œå°±èƒ½åˆ‡æ¢å›¢è´­å’Œå¤–å–ã€‚</li>
<li>ç»Ÿä¸€é‰´æƒï¼šåˆ«è®©ç”¨æˆ·åœ¨å¤–å–é‡Œç™»å½•ä¸€æ¬¡ï¼Œè¿›å›¢è´­è¿˜å¾—å†ç™»ä¸€æ¬¡ã€‚</li>
<li>ç‹¬ç«‹æ€§ï¼šå¤–å–å›¢é˜Ÿä»Šå¤©æƒ³å‘ç‰ˆï¼Œä¸èƒ½å› ä¸ºå›¢è´­å›¢é˜Ÿçš„ä»£ç æ²¡å†™å®Œå°±è¢«å¡ä½ã€‚</li>
</ul>
<p>ç ´å±€æ–¹æ¡ˆï¼šæˆç«‹æ–°çš„çˆ¶é¡¹ç›® local-lifeã€‚å®ƒä¸ç”Ÿäº§ä¸šåŠ¡ä»£ç ï¼Œå®ƒåªæ˜¯ä¸šåŠ¡çš„â€œæ¬è¿å·¥â€ã€‚é€šè¿‡ git submodule å°† tuangou å’Œ waimai å¼•å…¥ï¼Œå˜æˆè‡ªå·±çš„å­æ–‡ä»¶å¤¹ã€‚</p>
<h2 data-id="heading-1">Git Submodule å®æˆ˜æŒ‡ä»¤</h2>
<blockquote>
<p>æ›´å¤šå‘½ä»¤å­—å…¸ï¼Œæ¨èèœé¸Ÿæ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.runoob.com%2Fgit%2Fgit-submodule.html" target="_blank" title="https://www.runoob.com/git/git-submodule.html" ref="nofollow noopener noreferrer">www.runoob.com/git/git-subâ€¦</a></p>
</blockquote>
<p>å…ˆå¿«é€ŸæŸ¥çœ‹<code>git submodule</code>çš„æŒ‡ä»¤æ‰‹å†Œ<code>git submodule --help</code></p>
<pre><code class="hljs language-css" lang="css">git submodule <span class="hljs-selector-attr">[--quiet]</span> <span class="hljs-selector-attr">[--cached]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> add <span class="hljs-selector-attr">[&lt;options&gt;]</span> <span class="hljs-selector-attr">[--]</span> &lt;repository&gt; <span class="hljs-selector-attr">[&lt;path&gt;]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> status <span class="hljs-selector-attr">[--cached]</span> <span class="hljs-selector-attr">[--recursive]</span> <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> init <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> deinit <span class="hljs-selector-attr">[-f|--force]</span> (<span class="hljs-attr">--all</span>|<span class="hljs-selector-attr">[--]</span> &lt;path&gt;...)
git submodule <span class="hljs-selector-attr">[--quiet]</span> update <span class="hljs-selector-attr">[&lt;options&gt;]</span> <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> set-branch <span class="hljs-selector-attr">[&lt;options&gt;]</span> <span class="hljs-selector-attr">[--]</span> &lt;path&gt;
git submodule <span class="hljs-selector-attr">[--quiet]</span> set-url <span class="hljs-selector-attr">[--]</span> &lt;path&gt; &lt;newurl&gt;
git submodule <span class="hljs-selector-attr">[--quiet]</span> <span class="hljs-selector-tag">summary</span> <span class="hljs-selector-attr">[&lt;options&gt;]</span> <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> foreach <span class="hljs-selector-attr">[--recursive]</span> &lt;command&gt;
git submodule <span class="hljs-selector-attr">[--quiet]</span> sync <span class="hljs-selector-attr">[--recursive]</span> <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
git submodule <span class="hljs-selector-attr">[--quiet]</span> absorbgitdirs <span class="hljs-selector-attr">[--]</span> <span class="hljs-selector-attr">[&lt;path&gt;...]</span>
</code></pre>
<p>ä¸å¤æ‚çš„<code>git</code>æŒ‡ä»¤ä¸€æ ·ï¼Œèµ·æ­¥é˜¶æ®µåªéœ€è¦å…³æ³¨è¿™å‡ æ¡â€œç‘å£«å†›åˆ€â€å‘½ä»¤ï¼š</p>
<p><strong>æ·»åŠ å­æ¨¡å—</strong></p>
<p><code>git submodule add https://github.com/meituan/tuangou.git</code></p>
<p>è¿™ä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª .gitmodules æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç›¸å½“äºçˆ¶é¡¹ç›®çš„â€œæˆ·å£æœ¬â€ï¼Œè®°å½•äº†å­æ¨¡å—æ˜¯è°ã€åœ¨å“ªã€‚</p>
<p><strong>ä¸€é”®æ‹‰å–</strong></p>
<p>å…‹éš†æ•´ä¸ªçˆ¶é¡¹ç›®ï¼Œå­æ¨¡å—é»˜è®¤æ˜¯ç©ºçš„ï¼Œå¯ä»¥ä½¿ç”¨<code>--recursive</code>é€’å½’æ‹‰å–å­é¡¹ç›®</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> --recursive https://github.com/meituan/meituan.git`
</code></pre>
<p>å¦‚æœåœ¨å…‹éš†çˆ¶é¡¹ç›®æ—¶ï¼Œæ²¡æœ‰æŒ‡å®š<code>--recursive</code>ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡ä»¤</p>
<pre><code class="hljs language-css" lang="css">git submodule update <span class="hljs-attr">--init</span> <span class="hljs-attr">--recursive</span>
</code></pre>
<p><strong>åŒæ­¥æ›´æ–°</strong></p>
<p>å½“å­é¡¹ç›®å›¢é˜Ÿæ›´æ–°äº†ä»£ç ï¼Œçˆ¶é¡¹ç›®æƒ³å¼•ç”¨æœ€æ–°çš„ç‰ˆæœ¬ï¼š</p>
<p><code>git submodule update --remote</code></p>
<p>å½“ç„¶ï¼Œçˆ¶é¡¹ç›®ä¸­ä¹Ÿå¯ä»¥æäº¤å¯¹å­ä»£ç çš„æ›´æ–°ï¼Œåœ¨ JetBrains æˆ– VSCode ç­‰ IDE ä¸­çš„ git æ’ä»¶æ¨¡å—ï¼Œé»˜è®¤å…è®¸ç®¡ç†æ‰€æœ‰çš„ git ä»“åº“ã€‚</p>
<p><em>åœ¨çˆ¶é¡¹ç›®ä¸­ç›´æ¥ä¿®æ”¹å­æ¨¡å—ä»£ç ï¼Œæ˜¯ä¸è¢«æ¨èçš„ï¼Œè¿™ä¸åˆ©äºçˆ¶å­é¡¹ç›®æ²»ç†ã€‚</em></p>
<h2 data-id="heading-2">å›¢é˜Ÿæ²»ç†</h2>
<p>é¡¹ç›®å¤šäº†ï¼Œç®¡ç†ä¸èƒ½ä¹±ã€‚åœ¨çˆ¶å­é¡¹ç›®æ¶æ„ä¸‹ï¼ŒèŒè´£åˆ’åˆ†è¦åƒåˆ‡èœä¸€æ ·æ¸…æ™°ï¼š</p>
<h3 data-id="heading-3">çˆ¶é¡¹ç›®å›¢é˜Ÿï¼ˆç‰©ä¸šå…¬å¸ï¼‰</h3>
<p>ä¸å…³å¿ƒå¤–å–é‡Œå–çš„æ˜¯ç‚¸é¸¡è¿˜æ˜¯æ±‰å ¡ï¼Œä»–ä»¬è´Ÿè´£ï¼š</p>
<ul>
<li>ç¨³å®šæ€§ä¸è¿è¥ï¼Œç¡®ä¿ App å¹³ç¨³è¿è¡Œã€‚</li>
<li>å…¬å…±èµ„æºï¼šç»Ÿä¸€çš„é‰´æƒé€»è¾‘ã€ç»Ÿä¸€çš„ UI ç»„ä»¶åº“ã€‚</li>
<li>æµç¨‹çº¦æŸï¼šåˆ¶å®šå­é¡¹ç›®å…¥é©»çš„è§„èŒƒï¼ˆæ¯”å¦‚æ¥å£æ–‡æ¡£æ€ä¹ˆå†™ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-4">å­é¡¹ç›®å›¢é˜Ÿï¼ˆä¸šä¸»/å•†æˆ·ï¼‰</h3>
<p>ä¸šåŠ¡ä¸“å®¶ï¼Œè´Ÿè´£ï¼š</p>
<ul>
<li>å¿«é€Ÿè¿­ä»£ï¼šä»Šå¤©åŠ ä¸ªä¼˜æƒ åˆ¸ï¼Œæ˜å¤©æ”¹ä¸ªæ’ç‰ˆï¼Œåªè¦åœ¨å­ä»“åº“æŠ˜è…¾å°±è¡Œï¼Œä¸å½±å“åˆ«äººã€‚</li>
<li>è´¨é‡è´Ÿè´£ï¼šè‡ªå·±è´Ÿè´£çš„ä¸šåŠ¡æ¨¡å—ï¼Œå‡ºäº† Bug è‡ªå·±ä¿®ã€‚</li>
</ul>
<h3 data-id="heading-5">æ²»ç†æ‰‹æ®µ</h3>
<p>ç‰ˆæœ¬é”šå®šï¼šçˆ¶é¡¹ç›®å§‹ç»ˆè®°å½•å­é¡¹ç›®çš„ä¸€ä¸ªâ€œç‰¹å®šç‰ˆæœ¬ï¼ˆCommit IDï¼‰â€ï¼Œåªæœ‰ç»è¿‡æµ‹è¯•çš„å­é¡¹ç›®ç‰ˆæœ¬ï¼Œæ‰ä¼šè¢«çˆ¶é¡¹ç›®â€œè½¬æ­£â€æ›´æ–°ã€‚</p>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>Submodule æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºè§£è€¦ï¼Œå®ƒå…è®¸å„å›¢é˜Ÿä¿ç•™ç‹¬ç«‹çš„ Git æƒé™å’Œä¸åŒçš„å¼€å‘èŠ‚å¥ã€‚å¦‚æœä½ ä¹Ÿé¢ä¸´å¤šå›¢é˜Ÿåä½œã€ç»Ÿä¸€å¹³å°æ„å»ºçš„éš¾é¢˜ï¼Œä¸å¦¨è¯•è¯• Git Submoduleã€‚å®ƒæ˜¯ç›®å‰è¿ç»´æ¶æ„ä¸­ï¼Œæ€§ä»·æ¯”æé«˜çš„â€œé™ç†µâ€å·¥å…·ã€‚</p>
<h2 data-id="heading-7">å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œè·å–è¿ç»´èµ„è®¯</h2>
<p>å¦‚æœæ­¤ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ„Ÿè°¢ä½ çš„<strong>ç‚¹èµ</strong>ä¸<strong>æ”¶è—</strong>ï¼Œä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºå‹å¥½äº¤æµã€‚</p>
<p>å¾®ä¿¡æœç´¢å…³æ³¨å…¬ä¼—å·ï¼š<strong>æŒç»­è¿ç»´</strong></p>
<h2 data-id="heading-8">å‚è€ƒ</h2>
<ol>
<li>èœé¸Ÿæ•™ç¨‹ git submoduleï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.runoob.com%2Fgit%2Fgit-submodule.html" target="_blank" title="https://www.runoob.com/git/git-submodule.html" ref="nofollow noopener noreferrer">www.runoob.com/git/git-subâ€¦</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[WSL2 åœ¨ TUN æ¨¡å¼ä¸‹å¯¼è‡´ Supabase è¿æ¥è¶…æ—¶ (P1001) çš„æ’æŸ¥ä¸è§£å†³]]></title>    <link>https://juejin.cn/post/7598447519823314985</link>    <guid>https://juejin.cn/post/7598447519823314985</guid>    <pubDate>2026-01-24T04:46:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598447519823314985" data-draft-id="7598587406694858795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="WSL2 åœ¨ TUN æ¨¡å¼ä¸‹å¯¼è‡´ Supabase è¿æ¥è¶…æ—¶ (P1001) çš„æ’æŸ¥ä¸è§£å†³"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,Linux"/> <meta itemprop="datePublished" content="2026-01-24T04:46:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘æ˜æœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2928754707930126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            WSL2 åœ¨ TUN æ¨¡å¼ä¸‹å¯¼è‡´ Supabase è¿æ¥è¶…æ—¶ (P1001) çš„æ’æŸ¥ä¸è§£å†³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754707930126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘æ˜æœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T04:46:42.000Z" title="Sat Jan 24 2026 04:46:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ <strong>WSL2 (Manjaro)</strong> ç¯å¢ƒä¸‹è¿›è¡Œå…¨æ ˆå¼€å‘æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªç½‘ç»œå†²çªé—®é¢˜ã€‚æˆ‘çš„é¡¹ç›®è¿æ¥äº‘ç«¯æ•°æ®åº“ï¼ˆPostgreSQLï¼‰ï¼ŒåŒæ—¶ä¾èµ– <strong>Github Copilot / Antigravity</strong> ç­‰æµ·å¤–å¼€å‘æœåŠ¡ã€‚</p>
<p>ä¸ºäº†è®© <strong>Github Copilot / Antigravity çš„ AI</strong> æ­£å¸¸ç¨³å®šè¿è¡Œï¼Œæˆ‘å¼€å¯äº†æœ¬åœ°ç½‘ç»œè°ƒè¯•å·¥å…·çš„ <strong>TUN (è™šæ‹Ÿç½‘å¡) æ¨¡å¼</strong>ã€‚ä½†å¼€å¯åå‘ç°ï¼šPrisma è¿æ¥æ•°æ®åº“ä¼šæŠ¥é”™è¶…æ—¶ï¼›å…³é—­ TUN æ¨¡å¼æ•°æ®åº“æ¢å¤ï¼Œä½†æˆ‘çš„ AI åˆæ— æ³•è¿æ¥äº†ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« è®°å½•äº†è¯¥é—®é¢˜çš„æ’æŸ¥è¿‡ç¨‹ï¼Œæ¶‰åŠ <strong>Fake-IP æœºåˆ¶</strong> ä¸ <strong>DNS åŠ«æŒ</strong> çš„å†²çªè§£å†³ã€‚</p>
<h2 data-id="heading-0">é—®é¢˜ç°è±¡</h2>
<p><strong>ç¯å¢ƒä¿¡æ¯ï¼š</strong></p>
<ul>
<li><strong>OS:</strong> Windows 11 + WSL2</li>
<li><strong>ç½‘ç»œç¯å¢ƒ:</strong> å¼€å¯äº†æœ¬åœ°ä»£ç†å·¥å…·çš„ TUN æ¨¡å¼</li>
<li><strong>æ•°æ®åº“:</strong> äº‘ç«¯ PostgreSQL (AWS)</li>
<li><strong>ORM:</strong> Prisma</li>
</ul>
<p><strong>å…·ä½“è¡¨ç°ï¼š</strong></p>
<p>å½“å¼€å¯ TUN æ¨¡å¼æ¥ç®¡ç³»ç»Ÿæµé‡æ—¶ï¼Œè¿è¡Œ <code>npx prisma db pull</code>ï¼ŒæŠ›å‡ºä»¥ä¸‹é”™è¯¯ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">Error: P1001
Can<span class="hljs-string">'t reach database server at `xxx.pooler.supabase.com:5432`
Please make sure your database server is running...
</span></code></pre>
<p>ä¸æ­¤åŒæ—¶ï¼Œéƒ¨åˆ† OAuth å›è°ƒå¯èƒ½ä¹Ÿä¼šå‡ºç°è¿æ¥è¶…æ—¶ã€‚å…³é—­ TUN æ¨¡å¼åï¼Œæ•°æ®åº“è¿æ¥æ¢å¤æ­£å¸¸ã€‚</p>
<h2 data-id="heading-1">æ’æŸ¥è¿‡ç¨‹</h2>
<h3 data-id="heading-2">1. æ£€æŸ¥ DNS è§£æï¼ˆå‘ç°ç«¯å€ªï¼‰</h3>
<p>ä¸ºäº†ææ¸…æ¥šç½‘ç»œå±‚å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘åœ¨ WSL2 ç»ˆç«¯é‡Œ <code>ping</code> äº†ä¸€ä¸‹æ•°æ®åº“åŸŸåï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">ping aws-1-ap-northeast-2.pooler.supabase.com
</code></pre>
<p>è¿”å›çš„ç»“æœæ˜¾ç¤ºè§£æåˆ°äº†ä¸€ä¸ªç‰¹æ®Šçš„ IP æ®µï¼š</p>
<pre><code class="hljs language-python" lang="python">PING xxx.supabase.com (<span class="hljs-number">198.18</span><span class="hljs-number">.0</span><span class="hljs-number">.18</span>) <span class="hljs-number">56</span>(<span class="hljs-number">84</span>) <span class="hljs-built_in">bytes</span> of data.
<span class="hljs-number">64</span> <span class="hljs-built_in">bytes</span> <span class="hljs-keyword">from</span> <span class="hljs-number">198.18</span><span class="hljs-number">.0</span><span class="hljs-number">.18</span>: icmp_seq=<span class="hljs-number">1</span> ttl=<span class="hljs-number">64</span> time=<span class="hljs-number">0.297</span> ms
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong> è§£æç»“æœæ˜¯ <code>198.18.0.18</code>ã€‚</p>
<p><code>198.18.0.0/15</code> æ˜¯ç½‘ç»œåŸºå‡†æµ‹è¯•ä¿ç•™ç½‘æ®µï¼Œå¸¸è¢«å„ç±»ç½‘ç»œè°ƒè¯•å·¥å…·ç”¨äº <strong>Fake-IP (è™šå‡IP)</strong> æ¨¡å¼ã€‚è¿™è¯´æ˜ DNS è§£æå·²ç»è¢«å·¥å…·åŠ«æŒï¼Œè¿”å›äº†è™šæ‹Ÿ IP ä»¥ä¾¿æ¥ç®¡æµé‡ã€‚</p>
<p><strong>åŸå› åˆ†æï¼š</strong></p>
<p>å¯¹äº HTTP åè®®ï¼ŒFake-IP æ¨¡å¼é€šå¸¸å·¥ä½œè‰¯å¥½ã€‚ä½†å¯¹äºæ•°æ®åº“è¿æ¥ï¼ˆTCP ç«¯å£ 5432ï¼‰ï¼Œåœ¨è¿™ä¸ªè™šæ‹Ÿ IP çš„æ˜ å°„å’Œæµé‡è½¬å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å‡ºç°äº†è§„åˆ™åŒ¹é…å¤±è´¥æˆ–é“¾è·¯ä¸¢å¤±ï¼Œå¯¼è‡´ ORM æ— æ³•é€šè¿‡è¿™ä¸ªâ€œå‡ IPâ€å»ºç«‹çœŸå®çš„ TCP è¿æ¥ã€‚</p>
<h2 data-id="heading-3">è§£å†³æ–¹æ¡ˆ</h2>
<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»é…ç½®ç½‘ç»œå·¥å…·ï¼Œè®©ç‰¹å®šæ•°æ®åº“åŸŸå<strong>ç»•è¿‡ Fake-IP æœºåˆ¶</strong>ï¼Œç›´æ¥è§£æå‡ºçœŸå®çš„å…¬ç½‘ IPã€‚</p>
<h3 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šå¼€å¯ DNS è¦†å†™/æ¥ç®¡</h3>
<p>åœ¨ä½ çš„ç½‘ç»œå·¥å…·è®¾ç½®ä¸­ï¼ˆé€šå¸¸åœ¨ DNS è®¾ç½®æ¿å—ï¼‰ï¼Œç¡®ä¿ <strong>DNS è¦†å†™ (DNS Override)</strong> æˆ–ç±»ä¼¼åŠŸèƒ½å·²å¼€å¯ã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬æ¥ä¸‹æ¥çš„è¿‡æ»¤è§„åˆ™èƒ½ç”Ÿæ•ˆã€‚</p>
<h3 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šé…ç½® Fake-IP è¿‡æ»¤ (å…³é”®)</h3>
<p>æˆ‘ä»¬éœ€è¦å°†æ•°æ®åº“åŸŸåæ·»åŠ åˆ° <strong>Fake-IP è¿‡æ»¤åˆ—è¡¨ (Fake-IP Filter)</strong> ä¸­ã€‚è¿™ä¸ªåˆ—è¡¨çš„ä½œç”¨æ˜¯å‘Šè¯‰å·¥å…·ï¼šâ€œé‡åˆ°è¿™äº›åŸŸåæ—¶ï¼Œä¸è¦è¿”å› 198.18.x.xï¼Œè¯·å»æŸ¥è¯¢å¹¶è¿”å›çœŸå®çš„å…¬ç½‘ IPâ€ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶çš„ <code>dns</code> -&gt; <code>fake-ip-filter</code> å­—æ®µï¼Œæˆ–è€…è½¯ä»¶ç•Œé¢çš„â€œFake IP è¿‡æ»¤â€è¾“å…¥æ¡†ä¸­ï¼Œè¿½åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">, *.supabase.com, *.supabase.co, *.supabase.in
</code></pre>
<blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc80c86e98244c338618690d8f4f96e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCR5piO5pyI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769835952&amp;x-signature=pwNUolvahB02E0xSS7ZdCKYzpFk%3D" alt="image.png" loading="lazy"/></p>
</blockquote>
<h3 data-id="heading-6">ç¬¬ä¸‰æ­¥ï¼šéªŒè¯</h3>
<p>ä¿å­˜é…ç½®å¹¶<strong>é‡å¯ç½‘ç»œå·¥å…·</strong>åï¼Œå†æ¬¡å›åˆ° WSL2 ç»ˆç«¯æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">ping aws-1-ap-northeast-2.pooler.supabase.com
</code></pre>
<p>æ­¤æ—¶è¿”å›çš„åº”è¯¥æ˜¯çœŸå®çš„å…¬ç½‘ IP åœ°å€ï¼ˆä¾‹å¦‚ <code>52.x.x.x</code>ï¼‰ï¼Œè€Œä¸å†æ˜¯ <code>198.18.x.x</code>ã€‚</p>
<p>å†æ¬¡è¿è¡Œ <code>npx prisma db pull</code>ï¼Œæ•°æ®åº“è¿æ¥æˆåŠŸã€‚</p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>åœ¨ WSL2 å¼€å‘ç¯å¢ƒä¸­ï¼Œå¦‚æœå¼€å¯äº†ç½‘ç»œå·¥å…·çš„å…¨å±€/TUN æ¨¡å¼ï¼Œé‡åˆ°é HTTP åè®®ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€è‡ªå®šä¹‰ TCP æœåŠ¡ï¼‰è¿æ¥è¶…æ—¶ï¼Œå¯ä»¥ä¼˜å…ˆæ’æŸ¥ DNS è§£æç»“æœã€‚</p>
<p>å¦‚æœå‘ç°è§£æ IP ä¸º <code>198.18.x.x</code>ï¼Œè¯´æ˜èµ°äº† Fake-IP æ¨¡å¼ã€‚æ­¤æ—¶æ— éœ€å…³é—­ TUN æ¨¡å¼ï¼Œåªéœ€åœ¨å·¥å…·çš„ <strong>Fake-IP Filter</strong> ä¸­æ’é™¤ç›¸å…³åŸŸåï¼Œè·å–çœŸå® IP å³å¯è§£å†³å†²çªã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaåŸºç¡€-3ï¼šJava AQS æŠ€æœ¯ä»‹ç»å’Œä»£ç å®ç°è¯¦ç»†å‰–æ]]></title>    <link>https://juejin.cn/post/7598818096729047078</link>    <guid>https://juejin.cn/post/7598818096729047078</guid>    <pubDate>2026-01-24T08:45:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598818096729047078" data-draft-id="7598435950411186186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaåŸºç¡€-3ï¼šJava AQS æŠ€æœ¯ä»‹ç»å’Œä»£ç å®ç°è¯¦ç»†å‰–æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-24T08:45:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="beata"/> <meta itemprop="url" content="https://juejin.cn/user/1839900247461280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaåŸºç¡€-3ï¼šJava AQS æŠ€æœ¯ä»‹ç»å’Œä»£ç å®ç°è¯¦ç»†å‰–æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1839900247461280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    beata
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:45:35.000Z" title="Sat Jan 24 2026 08:45:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AQSæŠ€æœ¯å…¨é¢å­¦ä¹ åªçœ‹è¿™ç¯‡</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ Java å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œ<code>AbstractQueuedSynchronizer</code>ï¼ˆç®€ç§° <strong>AQS</strong>ï¼‰æ˜¯ <code>java.util.concurrent</code> åŒ…çš„åŸºçŸ³ã€‚å‡ ä¹æ‰€æœ‰é«˜çº§åŒæ­¥å·¥å…·ï¼ˆå¦‚ <code>ReentrantLock</code>ã€<code>Semaphore</code>ã€<code>CountDownLatch</code> ç­‰ï¼‰éƒ½åŸºäº AQS æ„å»ºã€‚å®ƒé€šè¿‡â€œçŠ¶æ€ + é˜Ÿåˆ—â€æ¨¡å‹ï¼Œå°†çº¿ç¨‹æ’é˜Ÿã€é˜»å¡ã€å”¤é†’ç­‰å¤æ‚é€»è¾‘å°è£…èµ·æ¥ï¼Œè®©å¼€å‘è€…åªéœ€å…³æ³¨<strong>èµ„æºè·å–/é‡Šæ”¾çš„è§„åˆ™</strong>ã€‚</p>
<p>æœ¬æ–‡å°†ä»æºç çº§æ·±å…¥å‰–æ AQS çš„å®ç°æœºåˆ¶ï¼Œå¹¶ä»‹ç»å…¶åœ¨ JDK ä¸­çš„æ ¸å¿ƒåº”ç”¨ï¼Œæœ€åæ‰‹å†™ä¸€ä¸ªåŸºäº AQS çš„è‡ªå®šä¹‰é”ï¼ŒåŠ©ä½ å½»åº•æŒæ¡è¿™ä¸€å¹¶å‘æ ¸å¿ƒç»„ä»¶ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸€ã€AQS æ ¸å¿ƒæœºåˆ¶ä¸æºç å®ç°è¯¦è§£</h2>
<p>AQS çš„è®¾è®¡å“²å­¦æ˜¯ï¼š<strong>æ¨¡æ¿æ–¹æ³• + CAS + CLH é˜Ÿåˆ—</strong>ã€‚æˆ‘ä»¬é€å±‚æ‹†è§£å…¶å†…éƒ¨ç»“æ„ã€‚</p>
<h3 data-id="heading-3">1.1 æ ¸å¿ƒå­—æ®µ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span>
    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractOwnableSynchronizer</span> {

    <span class="hljs-comment">// åŒæ­¥çŠ¶æ€ï¼šç”±å­ç±»å®šä¹‰è¯­ä¹‰ï¼ˆå¦‚ 0=ç©ºé—², &gt;0=å ç”¨ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;

    <span class="hljs-comment">// FIFO åŒå‘åŒæ­¥é˜Ÿåˆ—çš„å¤´å°¾æŒ‡é’ˆ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;

    <span class="hljs-comment">// è·å–/è®¾ç½® state çš„åŸå­æ“ä½œ</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> state; }
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> { state = newState; }
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetState</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
        <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, stateOffset, expect, update);
    }
}
</code></pre>
<blockquote>
<p>âœ… <code>state</code> æ˜¯æ‰€æœ‰ç«äº‰çš„ç„¦ç‚¹ï¼Œå¿…é¡»é€šè¿‡ CAS æ“ä½œä¿è¯åŸå­æ€§ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">1.2 Node èŠ‚ç‚¹ç»“æ„</h3>
<p>åŒæ­¥é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª <code>Node</code>ï¼Œä»£è¡¨ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">SHARED</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>();   <span class="hljs-comment">// å…±äº«æ¨¡å¼æ ‡è®°</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">EXCLUSIVE</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;      <span class="hljs-comment">// ç‹¬å æ¨¡å¼æ ‡è®°</span>

    <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>;  <span class="hljs-comment">// å·²å–æ¶ˆ</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SIGNAL</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;  <span class="hljs-comment">// å‰é©±éœ€å”¤é†’åç»§</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>;  <span class="hljs-comment">// åœ¨ Condition é˜Ÿåˆ—ä¸­</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROPAGATE</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3</span>;  <span class="hljs-comment">// å…±äº«æ¨¡å¼éœ€ä¼ æ’­</span>

    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;
    <span class="hljs-keyword">volatile</span> Node prev;     <span class="hljs-comment">// å‰é©±</span>
    <span class="hljs-keyword">volatile</span> Node next;     <span class="hljs-comment">// åç»§</span>
    <span class="hljs-keyword">volatile</span> Thread thread; <span class="hljs-comment">// å…³è”çº¿ç¨‹</span>
    Node nextWaiter;        <span class="hljs-comment">// æ¨¡å¼æ ‡è®°ï¼ˆSHARED æˆ– nullï¼‰</span>
}
</code></pre>
<blockquote>
<p>ğŸ”‘ <strong>å…³é”®åŒºåˆ«</strong>ï¼š<code>nextWaiter == SHARED</code> è¡¨ç¤ºå…±äº«æ¨¡å¼ï¼Œ<code>== null</code> è¡¨ç¤ºç‹¬å æ¨¡å¼ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">1.3 ç‹¬å æ¨¡å¼ï¼šè·å–èµ„æºæµç¨‹ï¼ˆ<code>acquire</code>ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;                     <span class="hljs-comment">// 1. å°è¯•è·å–ï¼ˆå­ç±»å®ç°ï¼‰</span>
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) <span class="hljs-comment">// 2. å¤±è´¥åˆ™å…¥é˜Ÿé˜»å¡</span>
        selfInterrupt(); <span class="hljs-comment">// æ¢å¤ä¸­æ–­çŠ¶æ€</span>
}
</code></pre>
<h4 data-id="heading-6">æ­¥éª¤åˆ†è§£ï¼š</h4>
<p><strong>â‘  å…¥é˜Ÿï¼š<code>addWaiter</code></strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addWaiter</span><span class="hljs-params">(Node mode)</span> {
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(Thread.currentThread(), mode);
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> tail;
    <span class="hljs-keyword">if</span> (pred != <span class="hljs-literal">null</span>) {
        node.prev = pred;
        <span class="hljs-keyword">if</span> (compareAndSetTail(pred, node)) { <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„</span>
            pred.next = node;
            <span class="hljs-keyword">return</span> node;
        }
    }
    enq(node); <span class="hljs-comment">// è‡ªæ—‹å…¥é˜Ÿï¼ˆæ…¢è·¯å¾„ï¼‰</span>
    <span class="hljs-keyword">return</span> node;
}
</code></pre>
<p><strong>â‘¡ é˜»å¡ç­‰å¾…ï¼š<code>acquireQueued</code></strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();
        <span class="hljs-comment">// ä»…å½“å‰é©±æ˜¯ head æ—¶æ‰å°è¯•è·å–</span>
        <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
            setHead(node); <span class="hljs-comment">// æˆåŠŸï¼Œè®¾ä¸ºæ–° head</span>
            p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// help GC</span>
            <span class="hljs-keyword">return</span> interrupted;
        }
        <span class="hljs-comment">// å†³å®šæ˜¯å¦é˜»å¡</span>
        <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
            parkAndCheckInterrupt())
            interrupted = <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p><strong>â‘¢ æ˜¯å¦é˜»å¡ï¼š<code>shouldParkAfterFailedAcquire</code></strong></p>
<ul>
<li>è‹¥å‰é©± <code>waitStatus == SIGNAL</code> â†’ å®‰å…¨é˜»å¡</li>
<li>è‹¥å‰é©±å·²å–æ¶ˆ â†’ è·³è¿‡å¹¶æ¸…ç†</li>
<li>å¦åˆ™ â†’ å°†å‰é©±è®¾ä¸º <code>SIGNAL</code>ï¼Œä¸‹æ¬¡å†è¯•</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>ç²¾å¦™ä¹‹å¤„</strong>ï¼šåªæœ‰å‰é©±æ‰¿è¯ºå”¤é†’ï¼ˆ<code>SIGNAL</code>ï¼‰ï¼Œå½“å‰çº¿ç¨‹æ‰ä¼šè°ƒç”¨ <code>LockSupport.park()</code> é˜»å¡ï¼Œé¿å…æ— æ•ˆå”¤é†’ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">1.4 é‡Šæ”¾èµ„æºï¼š<code>release</code></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) { <span class="hljs-comment">// å­ç±»å®ç°é‡Šæ”¾é€»è¾‘</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h); <span class="hljs-comment">// å”¤é†’åç»§</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unparkSuccessor</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-comment">// æ¸…é™¤ SIGNAL</span>
    compareAndSetWaitStatus(node, ws, <span class="hljs-number">0</span>);
    
    <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;
    <span class="hljs-comment">// ä» tail å‘å‰æ‰¾ç¬¬ä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹ï¼ˆè§£å†³ next æœªè®¾ç½®é—®é¢˜ï¼‰</span>
    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.waitStatus &gt; <span class="hljs-number">0</span>) {
        s = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail; t != <span class="hljs-literal">null</span> &amp;&amp; t != node; t = t.prev)
            <span class="hljs-keyword">if</span> (t.waitStatus &lt;= <span class="hljs-number">0</span>) s = t;
    }
    <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>)
        LockSupport.unpark(s.thread);
}
</code></pre>
<blockquote>
<p>ğŸŒŸ <strong>ä¸ºä»€ä¹ˆä» tail å‘å‰éå†ï¼Ÿ</strong><br/>
å› ä¸º <code>enq</code> ä¸­è®¾ç½® <code>prev</code> åœ¨ CAS ä¹‹å‰ï¼Œä½† <code>next</code> åœ¨ CAS ä¹‹åï¼Œå¯èƒ½å¯¼è‡´ <code>next</code> ä¸º nullã€‚ä» tail å‘å‰æ›´å®‰å…¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">1.5 å…±äº«æ¨¡å¼ vs ç‹¬å æ¨¡å¼</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>ç‹¬å æ¨¡å¼</th><th>å…±äº«æ¨¡å¼</th></tr></thead><tbody><tr><td>API</td><td><code>acquire/release</code></td><td><code>acquireShared/releaseShared</code></td></tr><tr><td>Node æ ‡è®°</td><td><code>EXCLUSIVE (null)</code></td><td><code>SHARED</code></td></tr><tr><td>å”¤é†’è¡Œä¸º</td><td>ä»…å”¤é†’ä¸€ä¸ªåç»§</td><td><strong>ä¼ æ’­å”¤é†’</strong>å¤šä¸ªå…±äº«èŠ‚ç‚¹</td></tr><tr><td>æ ¸å¿ƒæ–¹æ³•</td><td><code>tryAcquire/tryRelease</code></td><td><code>tryAcquireShared/tryReleaseShared</code></td></tr></tbody></table>
<p><strong>å…±äº«æ¨¡å¼çš„å…³é”®ï¼š<code>setHeadAndPropagate</code></strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHeadAndPropagate</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> propagate)</span> {
    setHead(node);
    <span class="hljs-comment">// å¦‚æœè¿˜æœ‰èµ„æºï¼ˆpropagate &gt; 0ï¼‰æˆ–å¤´èŠ‚ç‚¹çŠ¶æ€ä¸º PROPAGATE</span>
    <span class="hljs-keyword">if</span> (propagate &gt; <span class="hljs-number">0</span> || h.waitStatus &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;
        <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.isShared())
            doReleaseShared(); <span class="hljs-comment">// ç»§ç»­å”¤é†’åç»§å…±äº«èŠ‚ç‚¹ï¼</span>
    }
}
</code></pre>
<blockquote>
<p>âœ… è¿™å°±æ˜¯ <code>Semaphore</code> èƒ½åŒæ—¶å”¤é†’å¤šä¸ªçº¿ç¨‹çš„åŸå› ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">äºŒã€JDK ä¸­åŸºäº AQS çš„æ ¸å¿ƒç±»åŠå…¶å®ç°å·®å¼‚</h2>















































<table><thead><tr><th>ç±»</th><th>æ¨¡å¼</th><th><code>state</code> å«ä¹‰</th><th>æ ¸å¿ƒç”¨é€”</th></tr></thead><tbody><tr><td><code>ReentrantLock</code></td><td>ç‹¬å </td><td>é”é‡å…¥æ¬¡æ•°</td><td>å¯é‡å…¥äº’æ–¥é”</td></tr><tr><td><code>ReentrantReadWriteLock.ReadLock</code></td><td>å…±äº«</td><td>é«˜16ä½ï¼šè¯»é”è®¡æ•°</td><td>è¯»å¤šå†™å°‘åœºæ™¯</td></tr><tr><td><code>ReentrantReadWriteLock.WriteLock</code></td><td>ç‹¬å </td><td>ä½16ä½ï¼šå†™é”é‡å…¥æ¬¡æ•°</td><td>å†™æ“ä½œäº’æ–¥</td></tr><tr><td><code>Semaphore</code></td><td>å…±äº«</td><td>å‰©ä½™è®¸å¯æ•°é‡</td><td>æ§åˆ¶å¹¶å‘è®¿é—®æ•°</td></tr><tr><td><code>CountDownLatch</code></td><td>å…±äº«</td><td>å€’è®¡æ•°å™¨å€¼</td><td>ç­‰å¾… N ä¸ªä»»åŠ¡å®Œæˆ</td></tr><tr><td><code>FutureTask</code></td><td>ç‹¬å </td><td>æ‰§è¡ŒçŠ¶æ€ï¼ˆNEW/RUNNING/DONEï¼‰</td><td>å¼‚æ­¥è®¡ç®—ç»“æœ</td></tr></tbody></table>
<h3 data-id="heading-10">å®ç°å·®å¼‚ä¸¾ä¾‹ï¼š</h3>
<ul>
<li><strong><code>ReentrantLock</code></strong>ï¼š<code>state=0</code> è¡¨ç¤ºç©ºé—²ï¼›<code>&gt;0</code> è¡¨ç¤ºè¢«å ç”¨ï¼Œå€¼ä¸ºé‡å…¥æ¬¡æ•°ã€‚</li>
<li><strong><code>Semaphore</code></strong>ï¼š<code>state</code> åˆå§‹ä¸ºè®¸å¯æ•°ï¼Œæ¯æ¬¡ <code>acquire</code> å‡ 1ï¼Œ<code>release</code> åŠ  1ã€‚</li>
<li><strong><code>CountDownLatch</code></strong>ï¼š<code>state</code> åˆå§‹ä¸º Nï¼Œæ¯æ¬¡ <code>countDown</code> å‡ 1ï¼Œå½’é›¶æ—¶å”¤é†’æ‰€æœ‰ç­‰å¾…è€…ã€‚</li>
</ul>
<blockquote>
<p>ğŸ“Œ æ‰€æœ‰è¿™äº›ç±»éƒ½<strong>åªé‡å†™äº† AQS çš„ <code>tryXxx</code> æ–¹æ³•</strong>ï¼Œæ’é˜Ÿé€»è¾‘å®Œå…¨ç”± AQS æä¾›ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€æ‰‹å†™ä¸€ä¸ªåŸºäº AQS çš„ä¸å¯é‡å…¥äº’æ–¥é”</h2>
<p>ä¸‹é¢å®ç°ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ <code>Mutex</code> é”ï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨ AQS æ„å»ºè‡ªå®šä¹‰åŒæ­¥å™¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.locks.AbstractQueuedSynchronizer;
<span class="hljs-keyword">import</span> java.util.concurrent.locks.Lock;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleMutex</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> ignored)</span> {
            <span class="hljs-comment">// CAS å°† state ä» 0 â†’ 1</span>
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
                setExclusiveOwnerThread(Thread.currentThread());
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> ignored)</span> {
            <span class="hljs-keyword">if</span> (getExclusiveOwnerThread() != Thread.currentThread()) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            }
            setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            setState(<span class="hljs-number">0</span>); <span class="hljs-comment">// é‡Šæ”¾é”</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> <span class="hljs-variable">sync</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>();

    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> { sync.acquire(<span class="hljs-number">1</span>); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> { sync.release(<span class="hljs-number">1</span>); }
    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> sync.tryAcquire(<span class="hljs-number">1</span>); }
    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³•ç•¥</span>
}
</code></pre>
<h3 data-id="heading-12">æµ‹è¯•éªŒè¯äº’æ–¥æ€§ï¼š</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MutexTest</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">static</span> <span class="hljs-type">SimpleMutex</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleMutex</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                lock.lock();
                <span class="hljs-keyword">try</span> { count++; } <span class="hljs-keyword">finally</span> { lock.unlock(); }
            }
        });
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                lock.lock();
                <span class="hljs-keyword">try</span> { count++; } <span class="hljs-keyword">finally</span> { lock.unlock(); }
            }
        });
        t1.start(); t2.start();
        t1.join(); t2.join();
        System.out.println(<span class="hljs-string">"Final count: "</span> + count); <span class="hljs-comment">// å¿…ä¸º 20000</span>
    }
}
</code></pre>
<blockquote>
<p>âœ… è¯¥é”è™½ç®€å•ï¼Œä½†å·²å…·å¤‡å®Œæ•´çš„ AQS èƒ½åŠ›ï¼šçº¿ç¨‹æ’é˜Ÿã€é˜»å¡ã€å”¤é†’ã€å¼‚å¸¸å¤„ç†ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-13">å››ã€æ€»ç»“</h2>
<p>AQS æ˜¯ Java å¹¶å‘åŒ…ä¸­æœ€ç²¾å¦™çš„è®¾è®¡ä¹‹ä¸€ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ol>
<li><strong>è§£è€¦</strong>ï¼šå°†â€œèµ„æºç«äº‰è§„åˆ™â€ä¸â€œçº¿ç¨‹æ’é˜Ÿç®¡ç†â€åˆ†ç¦»ã€‚</li>
<li><strong>é«˜æ•ˆ</strong>ï¼šåŸºäº CAS + <code>LockSupport</code> å®ç°æ— é”é˜Ÿåˆ—å’Œä½å¼€é”€é˜»å¡ã€‚</li>
<li><strong>çµæ´»</strong>ï¼šé€šè¿‡ç‹¬å /å…±äº«æ¨¡å¼æ”¯æŒå„ç§åŒæ­¥è¯­ä¹‰ã€‚</li>
<li><strong>å¯é </strong>ï¼šå¤„ç†äº†ä¸­æ–­ã€è¶…æ—¶ã€å–æ¶ˆç­‰å¤æ‚è¾¹ç•Œæƒ…å†µã€‚</li>
</ol>
<p>æŒæ¡ AQSï¼Œä¸ä»…èƒ½è®©ä½ æ·±å…¥ç†è§£ <code>ReentrantLock</code>ã€<code>Semaphore</code> ç­‰å·¥å…·çš„åŸç†ï¼Œæ›´èƒ½èµ‹äºˆä½ <strong>æ„å»ºé«˜æ€§èƒ½è‡ªå®šä¹‰åŒæ­¥ç»„ä»¶çš„èƒ½åŠ›</strong>ã€‚</p>
<blockquote>
<p>ğŸ“š <strong>å»ºè®®</strong>ï¼šç»“åˆ OpenJDK æºç é˜…è¯»ï¼ˆå¦‚ <code>ReentrantLock.Sync</code>ã€<code>Semaphore.Sync</code>ï¼‰ï¼Œä½“ä¼šå¤§å¸ˆçº§å·¥ç¨‹è®¾è®¡ã€‚</p>
</blockquote>
<hr/>
<p><strong>é™„ï¼šAQS æ ¸å¿ƒæµç¨‹å›¾ï¼ˆç®€åŒ–ç‰ˆï¼‰</strong></p>
<pre><code class="hljs language-scss" lang="scss">                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ <span class="hljs-built_in">tryAcquire</span>() â”‚
                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                â–¼                 â”‚
       â”‚         æˆåŠŸï¼Ÿ(true)              â”‚
       â”‚                â”‚                 â”‚
       â”‚                â–¼                 â”‚
       â”‚           æ‰§è¡Œä¸´ç•ŒåŒº              â”‚
       â”‚                â”‚                 â”‚
       â”‚                â–¼                 â”‚
       â”‚          <span class="hljs-built_in">tryRelease</span>()            â”‚
       â”‚                â”‚                 â”‚
       â”‚                â–¼                 â”‚
       â”‚        å”¤é†’ head<span class="hljs-selector-class">.next</span> çº¿ç¨‹        â”‚
       â”‚                                  â”‚
       â–¼ (false)                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-built_in">addWaiter</span>() â”‚                â”‚   <span class="hljs-built_in">release</span>(arg)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                 â”‚
       â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚acquireQueuedâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ <span class="hljs-built_in">unparkSuccessor</span>()â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  (è¢«å”¤é†’é‡è¯•)   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”€â”
â”‚shouldParkAfterFailed...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”€â”˜
            â”‚
            â–¼
    LockSupport<span class="hljs-selector-class">.park</span>()
            â”‚
            â–¼
      (è¢« unpark å”¤é†’)
</code></pre>
<blockquote>
<p>æŒæ¡ AQSï¼Œä½ å°±æŒæ¡äº† Java å¹¶å‘çš„â€œä»»ç£äºŒè„‰â€ã€‚</p>
</blockquote>
<blockquote>
<p>ä½œè€…ï¼šæ¶æ„å¸ˆBeata<br/>
æ—¥æœŸï¼š2026å¹´1æœˆ24æ—¥<br/>
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡å¯è‡ªç”±è½¬è½½ï¼Œä½†è¯·ä¿ç•™å‡ºå¤„ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡º LSDï¼šåŸºäº Solidity 0.8.24 ä¸ OpenZeppelin V5 æ„å»ºæµåŠ¨æ€§è´¨æŠ¼åè®®]]></title>    <link>https://juejin.cn/post/7598490039488774179</link>    <guid>https://juejin.cn/post/7598490039488774179</guid>    <pubDate>2026-01-24T08:46:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598490039488774179" data-draft-id="7598480267217731618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡º LSDï¼šåŸºäº Solidity 0.8.24 ä¸ OpenZeppelin V5 æ„å»ºæµåŠ¨æ€§è´¨æŠ¼åè®®"/> <meta itemprop="keywords" content="æ™ºèƒ½åˆçº¦,Solidity,web3"/> <meta itemprop="datePublished" content="2026-01-24T08:46:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨è¥¿"/> <meta itemprop="url" content="https://juejin.cn/user/2436173496845549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡º LSDï¼šåŸºäº Solidity 0.8.24 ä¸ OpenZeppelin V5 æ„å»ºæµåŠ¨æ€§è´¨æŠ¼åè®®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173496845549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨è¥¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:46:04.000Z" title="Sat Jan 24 2026 08:46:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>æœ¬æ–‡ä¸»è¦æ¢³ç†æµåŠ¨æ€§è´¨æŠ¼åè®®çš„ç†è®ºçŸ¥è¯†ï¼Œæ¶µç›–æ¦‚å¿µæœºåˆ¶ã€æ ¸å¿ƒåŠŸèƒ½ã€è¡Œä¸šç—›ç‚¹åŠåº”ç”¨ä¼˜åŠ£åŠ¿åˆ†æã€‚åŒæ—¶ï¼Œå°†å€ŸåŠ© Solidity 0.8.24 ä¸ OpenZeppelin V5ï¼Œä» 0 åˆ° 1 å®ç°ä¸€ä¸ªæµåŠ¨æ€§è´¨æŠ¼åè®®ï¼Œå®Œæ•´å±•ç¤ºå¼€å‘ã€æµ‹è¯•ä¸éƒ¨ç½²çš„å…¨æµç¨‹ã€‚</p>
</blockquote>
<h2 data-id="heading-1">æµåŠ¨æ€§è´¨æŠ¼ï¼ˆLSDï¼‰ç†è®ºæ¢³ç†</h2>
<h4 data-id="heading-2">ä¸€ã€ä¸»è¦æ¦‚å¿µä¸æ ¸å¿ƒæœºåˆ¶</h4>
<p><strong>å®šä¹‰</strong>ï¼šPoSé“¾ä¸­ï¼Œç”¨æˆ·è´¨æŠ¼ETHã€SOLç­‰åŸç”Ÿèµ„äº§è‡³åè®®ï¼Œæ™ºèƒ½åˆçº¦å³æ—¶å‘æ”¾1:1æŒ‚é’©çš„LSTï¼ˆæµåŠ¨æ€§è´¨æŠ¼ä»£å¸ï¼‰ï¼Œä»£è¡¨è´¨æŠ¼æƒç›Šä¸æ”¶ç›Šï¼ŒLSTå¯åœ¨DeFiç”Ÿæ€è‡ªç”±æµè½¬ï¼Œå®ç°â€œè´¨æŠ¼ä¸é”ä»“â€ã€‚</p>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼šç”¨æˆ·å­˜å…¥èµ„äº§â†’åè®®èšåˆèµ„é‡‘å¹¶å§”æ‰˜éªŒè¯èŠ‚ç‚¹æŒ–çŸ¿â†’å‘æ”¾LSTï¼ˆä»·å€¼éšæ”¶ç›Šå¢é•¿ï¼‰â†’ç”¨æˆ·å¯äº¤æ˜“ã€ä½¿ç”¨LSTæˆ–èµå›åŸç”Ÿèµ„äº§ï¼ˆéƒ¨åˆ†æœ‰é”å®šæœŸ/æ»‘ç‚¹ï¼‰ã€‚</p>
<p><strong>å…³é”®è§’è‰²</strong>ï¼šåè®®å±‚ï¼ˆæ™ºèƒ½åˆçº¦ç®¡æ§èµ„äº§ä¸åˆ†é…ï¼‰ã€éªŒè¯èŠ‚ç‚¹ï¼ˆä¿éšœç½‘ç»œå®‰å…¨ä¸æ”¶ç›Šï¼‰ã€ç”¨æˆ·ï¼ˆè·å–LSTå…¼é¡¾æµåŠ¨æ€§ä¸æ”¶ç›Šï¼‰ã€‚</p>
<h4 data-id="heading-3">äºŒã€æ ¸å¿ƒåŠŸèƒ½</h4>
<ul>
<li>è´¨æŠ¼ä¸æµåŠ¨æ€§å…¼å¾—ï¼ŒLSTå¯å‚ä¸DeFiå®ç°æ”¶ç›Šå åŠ ï¼›</li>
<li>é™ä½é—¨æ§›ï¼Œå°é¢èµ„é‡‘å¯é€šè¿‡åè®®èšåˆå‚ä¸ï¼Œæ— éœ€è‡ªå»ºèŠ‚ç‚¹ï¼›</li>
<li>èµ„äº§å¤ç”¨å¢å€¼ï¼ŒLSTå¯å€Ÿè´·æŠµæŠ¼ã€DEXæä¾›æµåŠ¨æ€§ï¼Œæˆ–å‚ä¸å†è´¨æŠ¼æå‡å¹´åŒ–ï¼›</li>
<li>çµæ´»é€€å‡ºï¼Œé€šè¿‡äºŒçº§å¸‚åœºäº¤æ˜“æˆ–åè®®èµå›å¿«é€Ÿæ­¢æŸã€‚</li>
</ul>
<h4 data-id="heading-4">ä¸‰ã€è§£å†³çš„è¡Œä¸šç—›ç‚¹</h4>



































<table><thead><tr><th>ç—›ç‚¹</th><th>ä¼ ç»Ÿè´¨æŠ¼</th><th>æµåŠ¨æ€§è´¨æŠ¼è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æµåŠ¨æ€§ç¼ºå¤±</td><td>èµ„äº§é•¿æœŸé”å®šï¼Œæ— æ³•å†æŠ•èµ„</td><td>LSTå¯è‡ªç”±äº¤æ˜“ã€å€Ÿè´·ï¼Œé‡Šæ”¾æµåŠ¨æ€§</td></tr><tr><td>é«˜é—¨æ§›</td><td>éœ€å¤§é¢èµ„é‡‘+æŠ€æœ¯è¿ç»´èƒ½åŠ›</td><td>ä¸€é”®è´¨æŠ¼ï¼Œåè®®èšåˆå°é¢èµ„é‡‘ï¼Œé›¶æŠ€æœ¯è¦æ±‚</td></tr><tr><td>èµ„æœ¬æ•ˆç‡ä½</td><td>ä»…è·åŸºç¡€è´¨æŠ¼æ”¶ç›Šï¼Œæœºä¼šæˆæœ¬é«˜</td><td>åŒä¸€èµ„äº§å åŠ è´¨æŠ¼ä¸DeFiåŒé‡æ”¶ç›Š</td></tr><tr><td>é€€å‡ºå›°éš¾</td><td>è§£é”å‘¨æœŸé•¿ï¼Œéš¾ä»¥åŠæ—¶æ­¢æŸ</td><td>äºŒçº§å¸‚åœºå³æ—¶äº¤æ˜“æˆ–å¿«é€Ÿèµå›é€šé“</td></tr><tr><td>ä¸­å¿ƒåŒ–é£é™©</td><td>èŠ‚ç‚¹è¿è¥å•†å„æ–­ï¼Œå»ä¸­å¿ƒåŒ–ä¸è¶³</td><td>å¤šèŠ‚ç‚¹ç«äº‰ï¼Œç”¨æˆ·å¯è‡ªé€‰èŠ‚ç‚¹ï¼Œåˆ†æ•£æƒåŠ›</td></tr></tbody></table>
<h4 data-id="heading-5">å››ã€è¡Œä¸šåº”ç”¨åœºæ™¯</h4>
<ol>
<li>å»ä¸­å¿ƒåŒ–å€Ÿè´·ï¼šLSTä½œä¸ºæŠµæŠ¼å“å€Ÿæ¬¾ï¼Œå®ç°â€œè´¨æŠ¼+å€Ÿè´·â€æ æ†ï¼›</li>
<li>DEXæµåŠ¨æ€§ï¼šæä¾›LST/åŸç”Ÿèµ„äº§äº¤æ˜“å¯¹ï¼Œèµšå–æ‰‹ç»­è´¹ä¸æŒ–çŸ¿å¥–åŠ±ï¼›</li>
<li>å†è´¨æŠ¼ï¼šå­˜å…¥EigenLayerç­‰å¹³å°ï¼Œå¹´åŒ–æ”¶ç›Šå¯ä»8%æå‡è‡³15%-20%ï¼›</li>
<li>èµ„äº§ç®¡ç†ï¼šæ„å»ºä½é£é™©ã€é«˜æµåŠ¨æ€§ç†è´¢ç»„åˆï¼›</li>
<li>è¡ç”Ÿå“ç”Ÿæ€ï¼šåŸºäºLSTå‘è¡Œç¨³å®šå¸æˆ–å¼€å‘æœŸè´§ã€æœŸæƒã€‚</li>
</ol>
<h3 data-id="heading-6">äº”ã€ä¼˜åŠ¿ä¸åŠ£åŠ¿åˆ†æ</h3>
<p><strong>ä¼˜åŠ¿</strong>ï¼šèµ„æœ¬æ•ˆç‡é«˜ï¼Œæ”¶ç›Šå åŠ ï¼›é—¨æ§›ä½ã€æ“ä½œä¾¿æ·ï¼›é€€å‡ºçµæ´»ï¼›åŠ©åŠ›ç½‘ç»œå»ä¸­å¿ƒåŒ–ã€‚</p>
<p><strong>åŠ£åŠ¿</strong>ï¼šå­˜åœ¨æ™ºèƒ½åˆçº¦å®‰å…¨é£é™©ï¼›æç«¯å¸‚åœºä¸‹LSTå¯èƒ½ä¸åŸç”Ÿèµ„äº§è„±é’©ï¼›å¤´éƒ¨åè®®æœ‰èŠ‚ç‚¹é›†ä¸­éšæ‚£ï¼›éƒ¨åˆ†åè®®èµå›å—é™ï¼›LSTç›‘ç®¡æ€§è´¨å°šä¸æ˜ç¡®ã€‚</p>
<h2 data-id="heading-7">æ™ºèƒ½åˆçº¦å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²</h2>
<h4 data-id="heading-8">æ™ºèƒ½åˆçº¦</h4>
<p><strong>æµåŠ¨æ€§è´¨æŠ¼æ™ºèƒ½åˆçº¦</strong>ï¼šå®ƒçš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šç”¨æˆ·è´¨æŠ¼ ETHï¼Œåˆçº¦æŒ‰ 1:1 çš„æ¯”ä¾‹é“¸é€ ä»£å¸ï¼ˆstETHï¼‰ç»™ç”¨æˆ·ï¼›å½“ç”¨æˆ·é”€æ¯ stETH æ—¶ï¼Œè¿”è¿˜ç­‰é‡çš„ ETH</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.24</span>;

<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/ERC20.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">Ownable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/access/Ownable.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ReentrancyGuard</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/utils/ReentrancyGuard.sol"</span>;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@title</span> <span class="hljs-variable">SimpleLiquidStaking</span>
 * <span class="hljs-doctag">@dev</span> å®ç°åŸºç¡€çš„ ETH è´¨æŠ¼å¹¶è·å¾— LSD ä»£å¸ (stETH)
 */</span>
contract <span class="hljs-title class_">SimpleLiquidStaking</span> is <span class="hljs-title class_">ERC20</span>, <span class="hljs-title class_">Ownable</span>, <span class="hljs-title class_">ReentrancyGuard</span> {
    
    event <span class="hljs-title class_">Staked</span>(address indexed user, uint256 amount);
    event <span class="hljs-title class_">Withdrawn</span>(address indexed user, uint256 amount);

    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶è®¾ç½®ä»£å¸åç§°å’Œç¬¦å·ï¼Œå¹¶å°†æ‰€æœ‰æƒç§»äº¤ç»™éƒ¨ç½²è€…</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) <span class="hljs-title class_">ERC20</span>(<span class="hljs-string">"Liquid Staked ETH"</span>, <span class="hljs-string">"stETH"</span>) <span class="hljs-title class_">Ownable</span>(msg.<span class="hljs-property">sender</span>) {}

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@notice</span> ç”¨æˆ·è´¨æŠ¼ ETHï¼Œè·å¾—ç­‰é¢ stETH
     * <span class="hljs-doctag">@dev</span> ä½¿ç”¨ nonReentrant é˜²æ­¢é‡å…¥æ”»å‡»
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">stake</span>(<span class="hljs-params"/>) external payable nonReentrant {
        <span class="hljs-built_in">require</span>(msg.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0</span>, <span class="hljs-string">"Amount must be greater than 0"</span>);
        
        <span class="hljs-comment">// 1:1 é“¸é€ ä»£å¸ç»™ç”¨æˆ·</span>
        <span class="hljs-title function_">_mint</span>(msg.<span class="hljs-property">sender</span>, msg.<span class="hljs-property">value</span>);
        
        emit <span class="hljs-title class_">Staked</span>(msg.<span class="hljs-property">sender</span>, msg.<span class="hljs-property">value</span>);
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@notice</span> ç”¨æˆ·é”€æ¯ stETHï¼Œå–å›ç­‰é¢ ETH
     * <span class="hljs-doctag">@param</span> amount æƒ³è¦æå–çš„é‡‘é¢
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">withdraw</span>(<span class="hljs-params">uint256 amount</span>) external nonReentrant {
        <span class="hljs-built_in">require</span>(amount &gt; <span class="hljs-number">0</span>, <span class="hljs-string">"Amount must be greater than 0"</span>);
        <span class="hljs-built_in">require</span>(<span class="hljs-title function_">balanceOf</span>(msg.<span class="hljs-property">sender</span>) &gt;= amount, <span class="hljs-string">"Insufficient stETH balance"</span>);

        <span class="hljs-comment">// å…ˆé”€æ¯ç”¨æˆ·çš„ stETH å‡­è¯</span>
        <span class="hljs-title function_">_burn</span>(msg.<span class="hljs-property">sender</span>, amount);
        
        <span class="hljs-comment">// å‘é€ ETH ç»™ç”¨æˆ·</span>
        (bool success, ) = <span class="hljs-title function_">payable</span>(msg.<span class="hljs-property">sender</span>).<span class="hljs-property">call</span>{<span class="hljs-attr">value</span>: amount}(<span class="hljs-string">""</span>);
        <span class="hljs-built_in">require</span>(success, <span class="hljs-string">"ETH transfer failed"</span>);

        emit <span class="hljs-title class_">Withdrawn</span>(msg.<span class="hljs-property">sender</span>, amount);
    }

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@dev</span> å…è®¸åˆçº¦æ¥æ”¶ ETH (ä¾‹å¦‚éªŒè¯è€…èŠ‚ç‚¹çš„å¥–åŠ±è¿”è¿˜)
     */</span>
    <span class="hljs-title function_">receive</span>() external payable {}
}

</code></pre>
<h4 data-id="heading-9">éƒ¨ç½²è„šæœ¬</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// scripts/deploy.js</span>
<span class="hljs-keyword">import</span> { network, artifacts } <span class="hljs-keyword">from</span> <span class="hljs-string">"hardhat"</span>;
<span class="hljs-keyword">import</span> { parseUnits } <span class="hljs-keyword">from</span> <span class="hljs-string">"viem"</span>;
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// è¿æ¥ç½‘ç»œ</span>
  <span class="hljs-keyword">const</span> { viem } = <span class="hljs-keyword">await</span> network.<span class="hljs-title function_">connect</span>({ <span class="hljs-attr">network</span>: network.<span class="hljs-property">name</span> });<span class="hljs-comment">//æŒ‡å®šç½‘ç»œè¿›è¡Œé“¾æ¥</span>
  
  <span class="hljs-comment">// è·å–å®¢æˆ·ç«¯</span>
  <span class="hljs-keyword">const</span> [deployer, investor] = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getWalletClients</span>();
  <span class="hljs-keyword">const</span> publicClient = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getPublicClient</span>();
 
  <span class="hljs-keyword">const</span> deployerAddress = deployer.<span class="hljs-property">account</span>.<span class="hljs-property">address</span>;
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"éƒ¨ç½²è€…çš„åœ°å€:"</span>, deployerAddress);
  
  <span class="hljs-comment">// éƒ¨ç½²SimpleLiquidStakingåˆçº¦</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">SimpleLiquidStakingArtifact</span> = <span class="hljs-keyword">await</span> artifacts.<span class="hljs-title function_">readArtifact</span>(<span class="hljs-string">"SimpleLiquidStaking"</span>);
  <span class="hljs-comment">// 1. éƒ¨ç½²åˆçº¦å¹¶è·å–äº¤æ˜“å“ˆå¸Œ</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">SimpleLiquidStakingHash</span> = <span class="hljs-keyword">await</span> deployer.<span class="hljs-title function_">deployContract</span>({
    <span class="hljs-attr">abi</span>: <span class="hljs-title class_">SimpleLiquidStakingArtifact</span>.<span class="hljs-property">abi</span>,
    <span class="hljs-attr">bytecode</span>: <span class="hljs-title class_">SimpleLiquidStakingArtifact</span>.<span class="hljs-property">bytecode</span>,
    <span class="hljs-attr">args</span>: [],
  });
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">SimpleLiquidStakingReceipt</span> = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ 
     <span class="hljs-attr">hash</span>: <span class="hljs-title class_">SimpleLiquidStakingHash</span> 
   });
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"SimpleLiquidStakingåˆçº¦åœ°å€:"</span>, <span class="hljs-title class_">SimpleLiquidStakingReceipt</span>.<span class="hljs-property">contractAddress</span>);
}

<span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
</code></pre>
<h4 data-id="heading-10">æµ‹è¯•è„šæœ¬</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> assert <span class="hljs-keyword">from</span> <span class="hljs-string">"node:assert/strict"</span>;
<span class="hljs-keyword">import</span> { describe, it, beforeEach } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:test"</span>;
<span class="hljs-keyword">import</span> { parseEther } <span class="hljs-keyword">from</span> <span class="hljs-string">'viem'</span>;
<span class="hljs-comment">// æ³¨æ„ï¼šåœ¨ Hardhat ç¯å¢ƒä¸­é€šå¸¸é€šè¿‡ hre è·å– viem</span>
<span class="hljs-keyword">import</span> hre <span class="hljs-keyword">from</span> <span class="hljs-string">"hardhat"</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">"SimpleLiquidStaking æµ‹è¯•"</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { viem } = <span class="hljs-keyword">await</span> hre.<span class="hljs-property">network</span>.<span class="hljs-title function_">connect</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-attr">simpleLiquidStaking</span>: <span class="hljs-built_in">any</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">publicClient</span>: <span class="hljs-built_in">any</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">owner</span>: <span class="hljs-built_in">any</span>, <span class="hljs-attr">user1</span>: <span class="hljs-built_in">any</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">deployerAddress</span>: <span class="hljs-built_in">string</span>;

    <span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
        
        <span class="hljs-comment">// è·å– clients</span>
        publicClient = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getPublicClient</span>();
        [owner, user1] = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getWalletClients</span>();
        deployerAddress = owner.<span class="hljs-property">account</span>.<span class="hljs-property">address</span>;

        <span class="hljs-comment">// éƒ¨ç½²åˆçº¦ï¼Œæ³¨æ„ OpenZeppelin V5 çš„ Ownable éœ€è¦æ„é€ å‚æ•°ï¼ˆå¯é€‰ï¼Œå–å†³äºä½ åˆçº¦å…·ä½“å®ç°ï¼‰</span>
        <span class="hljs-comment">// å¦‚æœä½ çš„åˆçº¦æ„é€ å‡½æ•°æ˜¯ constructor() ERC20(...) Ownable(msg.sender) {}</span>
        simpleLiquidStaking = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">deployContract</span>(<span class="hljs-string">"SimpleLiquidStaking"</span>, []);
    });

    <span class="hljs-title function_">it</span>(<span class="hljs-string">"ç”¨æˆ·åº”è¯¥èƒ½å¤ŸæˆåŠŸè´¨æŠ¼ ETH å¹¶è·å¾— stETH"</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> stakeAmount = <span class="hljs-title function_">parseEther</span>(<span class="hljs-string">"10"</span>);

        <span class="hljs-comment">// 1. æ‰§è¡Œè´¨æŠ¼æ“ä½œ</span>
        <span class="hljs-keyword">const</span> hash = <span class="hljs-keyword">await</span> user1.<span class="hljs-title function_">writeContract</span>({
            <span class="hljs-attr">address</span>: simpleLiquidStaking.<span class="hljs-property">address</span>,
            <span class="hljs-attr">abi</span>: simpleLiquidStaking.<span class="hljs-property">abi</span>,
            <span class="hljs-attr">functionName</span>: <span class="hljs-string">"stake"</span>,
            <span class="hljs-attr">value</span>: stakeAmount,
        });

        <span class="hljs-comment">// 2. ç­‰å¾…äº¤æ˜“ç¡®è®¤</span>
        <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ hash });

        <span class="hljs-comment">// 3. éªŒè¯åˆçº¦ä¸­çš„ ETH ä½™é¢</span>
        <span class="hljs-keyword">const</span> contractEthBalance = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">getBalance</span>({
            <span class="hljs-attr">address</span>: simpleLiquidStaking.<span class="hljs-property">address</span>,
        });
        assert.<span class="hljs-title function_">equal</span>(contractEthBalance, stakeAmount, <span class="hljs-string">"åˆçº¦æ”¶åˆ°çš„ ETH æ•°é‡ä¸æ­£ç¡®"</span>);

        <span class="hljs-comment">// 4. éªŒè¯ç”¨æˆ·æ”¶åˆ°çš„ stETH å‡­è¯æ•°é‡</span>
        <span class="hljs-keyword">const</span> userStEthBalance = <span class="hljs-keyword">await</span> simpleLiquidStaking.<span class="hljs-property">read</span>.<span class="hljs-title function_">balanceOf</span>([user1.<span class="hljs-property">account</span>.<span class="hljs-property">address</span>]);
        assert.<span class="hljs-title function_">equal</span>(userStEthBalance, stakeAmount, <span class="hljs-string">"ç”¨æˆ·è·å¾—çš„ stETH æ•°é‡ä¸æ­£ç¡®"</span>);
    });

    <span class="hljs-title function_">it</span>(<span class="hljs-string">"ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿé€šè¿‡é”€æ¯ stETH èµå› ETH"</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> amount = <span class="hljs-title function_">parseEther</span>(<span class="hljs-string">"5"</span>);

        <span class="hljs-comment">// 1. å…ˆè´¨æŠ¼</span>
        <span class="hljs-keyword">await</span> user1.<span class="hljs-title function_">writeContract</span>({
            <span class="hljs-attr">address</span>: simpleLiquidStaking.<span class="hljs-property">address</span>,
            <span class="hljs-attr">abi</span>: simpleLiquidStaking.<span class="hljs-property">abi</span>,
            <span class="hljs-attr">functionName</span>: <span class="hljs-string">"stake"</span>,
            <span class="hljs-attr">value</span>: amount,
        });

        <span class="hljs-keyword">const</span> ethBalanceBefore = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">getBalance</span>({ <span class="hljs-attr">address</span>: user1.<span class="hljs-property">account</span>.<span class="hljs-property">address</span> });

        <span class="hljs-comment">// 2. æ‰§è¡Œèµå›</span>
        <span class="hljs-keyword">const</span> hash = <span class="hljs-keyword">await</span> user1.<span class="hljs-title function_">writeContract</span>({
            <span class="hljs-attr">address</span>: simpleLiquidStaking.<span class="hljs-property">address</span>,
            <span class="hljs-attr">abi</span>: simpleLiquidStaking.<span class="hljs-property">abi</span>,
            <span class="hljs-attr">functionName</span>: <span class="hljs-string">"withdraw"</span>,
            <span class="hljs-attr">args</span>: [amount],
        });
        <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ hash });
        <span class="hljs-comment">// console.log(receipt);</span>
        <span class="hljs-comment">// 3. éªŒè¯ stETH æ˜¯å¦å·²é”€æ¯</span>
        <span class="hljs-keyword">const</span> stEthBalanceAfter = <span class="hljs-keyword">await</span> simpleLiquidStaking.<span class="hljs-property">read</span>.<span class="hljs-title function_">balanceOf</span>([user1.<span class="hljs-property">account</span>.<span class="hljs-property">address</span>]);
        assert.<span class="hljs-title function_">equal</span>(stEthBalanceAfter, <span class="hljs-number">0n</span>, <span class="hljs-string">"stETH åº”è¯¥å·²è¢«é”€æ¯"</span>);

        <span class="hljs-comment">// 4. éªŒè¯ç”¨æˆ· ETH ä½™é¢æ˜¯å¦å¢åŠ  (è€ƒè™‘ Gas è´¹ï¼Œä½™é¢åº”å¤§äºèµå›å‰)</span>
        <span class="hljs-keyword">const</span> ethBalanceAfter = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">getBalance</span>({ <span class="hljs-attr">address</span>: user1.<span class="hljs-property">account</span>.<span class="hljs-property">address</span> });
        assert.<span class="hljs-title function_">ok</span>(ethBalanceAfter &gt; ethBalanceBefore, <span class="hljs-string">"ç”¨æˆ·æœªæ”¶åˆ°èµå›çš„ ETH"</span>);
    }); 
});
</code></pre>
<h2 data-id="heading-11">ç»“è¯­</h2>
<p>è‡³æ­¤ï¼ŒæµåŠ¨æ€§è´¨æŠ¼åè®®çš„ç†è®ºæ¢³ç†ä¸ä»£ç å®ç°å·²å…¨éƒ¨è½åœ°ã€‚æœ¬æ–‡æ—¢å¤¯å®äº†ç†è®ºè®¤çŸ¥ï¼Œåˆé€šè¿‡Solidity 0.8.24ä¸OpenZeppelin V5å®Œæˆäº†ä»å¼€å‘åˆ°éƒ¨ç½²çš„å…¨æµç¨‹å®è·µï¼Œå½¢æˆç†è®ºä¸å®æ“çš„é—­ç¯ã€‚
æœ¬æ¬¡è½åœ°æ¡ˆä¾‹ä¸ºç›¸å…³å¼€å‘è€…æä¾›äº†å¯å‚è€ƒçš„å®è·µèŒƒå¼ï¼Œä¹Ÿå°è¯äº†æµåŠ¨æ€§è´¨æŠ¼åœ¨åŒºå—é“¾ç”Ÿæ€ä¸­çš„åº”ç”¨ä»·å€¼ã€‚æœªæ¥å¯åŸºäºæ­¤è¿›ä¸€æ­¥ä¼˜åŒ–åè®®æ€§èƒ½ã€åº”å¯¹è¡Œä¸šæŒ‘æˆ˜ï¼ŒåŠ©åŠ›DeFiç”Ÿæ€æŒç»­è¿­ä»£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¡Œä¸šé¢†å…ˆçš„æœç´¢æŠ€æœ¯è¿›å±•åˆ†æ]]></title>    <link>https://juejin.cn/post/7598532592455745563</link>    <guid>https://juejin.cn/post/7598532592455745563</guid>    <pubDate>2026-01-24T08:48:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598532592455745563" data-draft-id="7598499504170975270" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¡Œä¸šé¢†å…ˆçš„æœç´¢æŠ€æœ¯è¿›å±•åˆ†æ"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-24T08:48:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¡Œä¸šé¢†å…ˆçš„æœç´¢æŠ€æœ¯è¿›å±•åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:48:10.000Z" title="Sat Jan 24 2026 08:48:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è¡Œä¸šé¢†å…ˆçš„æœç´¢æŠ€æœ¯è¿›å±•åˆ†æ</h2>
<p>æ ¹æ®æœ€æ–°è¡Œä¸šåŠ¨æ€ï¼Œæœç´¢æŠ€æœ¯æ­£ç»å†å‰æ‰€æœªæœ‰çš„å˜é©ï¼Œä¸»è¦é›†ä¸­åœ¨AIé©±åŠ¨çš„å¤šæ¨¡æ€æœç´¢ã€å¯¹è¯å¼äº¤äº’å’Œå®æ—¶äº‹å®æ ¸æŸ¥ç­‰æ–¹å‘ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸»è¦æœç´¢å¼•æ“å…¬å¸çš„æŠ€æœ¯è¿›å±•ï¼š</p>
<h3 data-id="heading-1">è°·æ­Œæœç´¢ï¼ˆGoogle Searchï¼‰</h3>
<p><strong>2025å¹´æŠ€æœ¯çªç ´ï¼š</strong></p>
<ul>
<li><strong>AIæ¨¡å¼å…¨çƒé“ºå¼€</strong>ï¼š2025å¹´5æœˆåœ¨ç¾å›½å¸‚åœºæ¨å‡ºé›†æˆGemini 2.5æ¨¡å‹çš„AIæ¨¡å¼ï¼Œæ”¯æŒå¤šæ¨¡æ€æœç´¢å’Œå¯¹è¯æ¨¡å¼ï¼Œ2025å¹´10æœˆå·²è¦†ç›–å…¨çƒ200ä½™ä¸ªå›½å®¶å’Œåœ°åŒº</li>
<li><strong>AIæ¦‚è§ˆä¸éŸ³é¢‘åŠŸèƒ½</strong>ï¼š2025å¹´6æœˆä¸Šçº¿éŸ³é¢‘æ¦‚è§ˆåŠŸèƒ½ï¼Œç”ŸæˆåŒ…å«ä¸¤ä½è™šæ‹Ÿä¸»æŒäººäº’åŠ¨å¯¹è¯çš„æ’­å®¢å¼AIè¯­éŸ³æ€»ç»“</li>
<li><strong>æ¨¡å‹å‡çº§</strong>ï¼š2025å¹´9æœˆé›†æˆGemini 3äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œæå‡äº‹å®å‡†ç¡®æ€§å¹¶å¼ºåŒ–å®‰å…¨é˜²æŠ¤èƒ½åŠ›</li>
<li><strong>å¤šæ¨¡æ€èƒ½åŠ›</strong>ï¼šæ”¯æŒé€šè¿‡è¯­éŸ³ã€æ–‡å­—ã€å›¾ç‰‡è¾“å…¥åŠå®æ—¶è§†é¢‘äº¤äº’è¿›è¡Œæ·±åº¦æœç´¢ï¼Œèƒ½è‡ªåŠ¨å‘èµ·ä¸Šç™¾æ¬¡è·¨é¢†åŸŸæœç´¢ç”Ÿæˆä¸“å®¶çº§æŠ¥å‘Š</li>
<li><strong>å›¾åƒå¤„ç†</strong>ï¼š2025å¹´10æœˆå¼•å…¥å›¾åƒç¼–è¾‘æ¨¡å‹Nano Bananaï¼Œå¹¶è®¡åˆ’æ•´åˆC2PA 2.1æ ‡å‡†æ ‡æ³¨AIç”Ÿæˆå†…å®¹</li>
</ul>
<p><strong>æŠ€æœ¯å½±å“</strong>ï¼šAIæ¨¡å¼ä½¿å¹³å‡æŸ¥è¯¢æ¬¡æ•°å‡å°‘40%ï¼Œç”¨æˆ·åœç•™åœ¨æœç´¢é¡µé¢çš„æ—¶é—´å¢åŠ 25%ï¼Œåœ¨åŒ»ç–—å’¨è¯¢ã€å­¦æœ¯ç ”ç©¶ç­‰å¤æ‚åœºæ™¯ä¸­æ•ˆç‡æå‡æ˜¾è‘—ã€‚</p>
<h3 data-id="heading-2">å¾®è½¯å¿…åº”ï¼ˆBingï¼‰</h3>
<p><strong>AIæ•´åˆè¿›å±•ï¼š</strong></p>
<ul>
<li>2023å¹´2æœˆï¼šæ¨å‡ºæ•´åˆChatGPTæŠ€æœ¯çš„æ–°ç‰ˆæœç´¢å¼•æ“ï¼ŒåˆæœŸé‡‡ç”¨GPT-3.5å‡çº§ç‰ˆ</li>
<li>2023å¹´3æœˆï¼šå‡çº§è‡³GPT-4æ¨¡å‹ï¼Œæ–°å¢AIèŠå¤©ã€è§†è§‰æœç´¢åŠå›¾åƒç”ŸæˆåŠŸèƒ½</li>
<li>2025å¹´8æœˆï¼šæ¥å…¥OpenAIçš„GPT-4oå›¾åƒç”Ÿæˆæ¨¡å‹</li>
<li>2024å¹´10æœˆï¼šä¸Šçº¿AIç”Ÿæˆæ‘˜è¦åŠŸèƒ½</li>
</ul>
<p><strong>å¸‚åœºè¡¨ç°</strong>ï¼š2025å¹´6æœˆä¸­å›½å¸‚åœºä»½é¢è¾¾40.23%ï¼Œè¿ç»­12ä¸ªæœˆå±…é¦–ï¼Œæˆä¸ºä¸­å›½å¸‚åœºçš„é‡è¦ç«äº‰è€…ã€‚</p>
<h3 data-id="heading-3">ç”µå•†æœç´¢é¢†åŸŸ</h3>
<p><strong>æ·˜å®æœç´¢ï¼š</strong></p>
<ul>
<li>2025å¹´å¯åŠ¨AIé©±åŠ¨çš„å‡çº§ï¼Œæ„å»ºè¦†ç›–20äº¿å•†å“çš„åºå¤§çŸ¥è¯†å›¾è°±</li>
<li>2025å¹´8æœˆï¼šåŸºäºAI Agentè¾…åŠ©ç”Ÿæˆæ ‡ç­¾çš„æ–°å•†å“åº“å®Œæˆï¼Œé€šè¿‡å°èŒƒå›´æµ‹è¯•éªŒè¯</li>
<li>2025å¹´10æœˆï¼šå‘å•†å®¶å¼€æ”¾æœç´¢æ¡†è‡ªå®šä¹‰è¿è¥æƒé™ï¼Œæ”¯æŒå•†å®¶åœ¨ç‰¹å®šåœºæ™¯ä¸‹è®¾ç½®æœç´¢åº•çº¹è¯ã€å®æ—¶çƒ­æœç­‰</li>
</ul>
<p><strong>æŠ€æœ¯è¶‹åŠ¿</strong>ï¼šä»"å…³é”®è¯åŒ¹é…"å‘"éœ€æ±‚ç†è§£"è½¬å˜ï¼Œæ‰“é€šæœç´¢ä¸æ¨èä½“ç³»ï¼Œå®ç°ç”¨æˆ·æœç´¢å†…å®¹ä¸é¦–é¡µæ¨èçš„è”åŠ¨ã€‚</p>
<h3 data-id="heading-4">çŸ­è§†é¢‘æœç´¢åˆ›æ–°</h3>
<p><strong>å¿«æ‰‹CroPSæ£€ç´¢å¼•æ“ï¼š</strong></p>
<ul>
<li>2026å¹´åˆæ¨å‡ºï¼Œæ—¨åœ¨æ‰“ç ´æœç´¢ä¿¡æ¯èŒ§æˆ¿ï¼Œä¼˜åŒ–çŸ­è§†é¢‘æœç´¢é€»è¾‘</li>
<li>æ ¸å¿ƒåˆ›æ–°ï¼šå¼•å…¥"è·¨è§†è§’æ­£æ ·æœ¬å¢å¼º"æœºåˆ¶ï¼Œé€šè¿‡å¤šç»´åº¦æ­£æ ·æœ¬å¢å¼ºï¼Œä»æ ¹æºä¸Šæ‰“ç ´æ•°æ®é—­ç¯</li>
<li>è§£å†³é—®é¢˜ï¼šä¼ ç»Ÿå‘é‡æ£€ç´¢æ¨¡å‹å› ä¾èµ–å†å²æ›å…‰æ•°æ®å¯¼è‡´çš„æ ·æœ¬åå·®å’Œä¿¡æ¯èŒ§æˆ¿é—®é¢˜</li>
</ul>
<h3 data-id="heading-5">è¡Œä¸šå…±åŒè¶‹åŠ¿</h3>
<ol>
<li><strong>ä»å…³é”®è¯åˆ°å¯¹è¯å¼æœç´¢</strong>ï¼šè°·æ­Œã€å¾®è½¯ç­‰å…¬å¸æ­£æ¨åŠ¨æœç´¢ä»"å…³é”®è¯-é“¾æ¥åˆ—è¡¨"å‘"å¤šè½®å¤æ‚å¯¹è¯"è½¬å˜</li>
<li><strong>å¤šæ¨¡æ€èƒ½åŠ›æ•´åˆ</strong>ï¼šæœç´¢ç³»ç»Ÿä¸ä»…èƒ½å¤„ç†æ–‡æœ¬ï¼Œè¿˜èƒ½ç†è§£å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ä¸­çš„å†…å®¹</li>
<li><strong>å®æ—¶äº‹å®æ ¸æŸ¥</strong>ï¼šAIå¼•æ“èƒ½å¯¹æ£€ç´¢ä¿¡æ¯è¿›è¡Œå¯ä¿¡åº¦è¯„ä¼°ï¼Œæ ‡æ³¨å¯èƒ½å­˜åœ¨çš„é”™è¯¯æˆ–äº‰è®®</li>
<li><strong>çŸ¥è¯†å›¾è°±æ„å»º</strong>ï¼šæ„å»ºå¤§è§„æ¨¡çŸ¥è¯†å›¾è°±ï¼Œè®©AIèƒ½æ›´æ·±å…¥ç†è§£å†…å®¹ï¼Œå¦‚æ·˜å®æ„å»ºçš„20äº¿å•†å“çŸ¥è¯†å›¾è°±</li>
<li><strong>ä¸ªæ€§åŒ–ä¸éœ€æ±‚ç†è§£</strong>ï¼šé€šè¿‡æŒç»­å¯¹è¯æœºåˆ¶ç²¾å‡†æ•æ‰ç”¨æˆ·æ·±å±‚éœ€æ±‚ï¼Œå®ç°"éœ€æ±‚ç†è§£-èµ„æºåŒ¹é…"é—­ç¯</li>
</ol>
<h3 data-id="heading-6">æŒ‘æˆ˜ä¸å±•æœ›</h3>
<p>å°½ç®¡æŠ€æœ¯è¿›å±•æ˜¾è‘—ï¼Œè¡Œä¸šä»é¢ä¸´æŒ‘æˆ˜ï¼š</p>
<ul>
<li>ä¿¡æ¯å‡†ç¡®æ€§é—®é¢˜ï¼šAIç”Ÿæˆçš„æ‘˜è¦å¯èƒ½å­˜åœ¨åå·®</li>
<li>ç®—æ³•åè§ï¼šå¯èƒ½å¯¼è‡´æœç´¢ç»“æœçš„ä¸å…¬å¹³</li>
<li>éšç§ä¿æŠ¤ï¼šAIéœ€è¦æ”¶é›†åˆ†æç”¨æˆ·è¡Œä¸º</li>
<li>è™šå‡ä¿¡æ¯ï¼šAIå¯èƒ½è¢«ç”¨äºä¼ æ’­è™šå‡å†…å®¹</li>
</ul>
<p>æœªæ¥æœç´¢å°†è¶…è¶Šä¿¡æ¯æœ¬èº«ï¼Œæ¼”è¿›ä¸ºæ›´æ™ºèƒ½çš„çŸ¥è¯†æœåŠ¡ï¼ŒAIå°†èƒ½å¤Ÿç†è§£ç”¨æˆ·çš„çœŸå®æ„å›¾ï¼Œæä¾›æ›´åŠ ä¸ªæ€§åŒ–å’Œå®šåˆ¶åŒ–çš„ç­”æ¡ˆï¼Œç”¨æˆ·å‚ä¸åº¦å°†æˆä¸ºè¡¡é‡æœç´¢è´¨é‡çš„é‡è¦æŒ‡æ ‡ã€‚</p>
<p>å½“å‰ï¼Œè°·æ­Œã€å¾®è½¯ç­‰å·¨å¤´çš„AIæœç´¢æŠ€æœ¯å·²è¿›å…¥å®è´¨æ€§åº”ç”¨é˜¶æ®µï¼Œè€Œå¿«æ‰‹ã€æ·˜å®ç­‰å¹³å°åˆ™åœ¨å‚ç›´é¢†åŸŸæ¢ç´¢AIæœç´¢çš„ç‹¬ç‰¹ä»·å€¼ï¼Œè¡Œä¸šæ­£æœç€æ›´æ™ºèƒ½ã€æ›´äº¤äº’ã€æ›´å¯ä¿¡çš„æ–¹å‘å‘å±•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GOä¸­çš„sync.Mapæºç è§£æ]]></title>    <link>https://juejin.cn/post/7598447519824019497</link>    <guid>https://juejin.cn/post/7598447519824019497</guid>    <pubDate>2026-01-24T08:49:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598447519824019497" data-draft-id="7598587406695415851" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GOä¸­çš„sync.Mapæºç è§£æ"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2026-01-24T08:49:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Vecray"/> <meta itemprop="url" content="https://juejin.cn/user/3702810895739134"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GOä¸­çš„sync.Mapæºç è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810895739134/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Vecray
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T08:49:39.000Z" title="Sat Jan 24 2026 08:49:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Mapçš„æºç è§£æï¼Œè¿˜æ˜¯æœ‰ç‚¹ç»•çš„</p>
<p>ä¸»è¦ä¸¤ä¸ªå­—æ®µï¼šreadå’Œdirty</p>
<p>æˆ‘çš„ç†è§£æ˜¯readç›¸å½“äºredisï¼Œdirtyç›¸å½“äºdbï¼š</p>
<p>è¯»ï¼š</p>
<ol>
<li>è¯»éƒ½ä»readä¸­è¯»å–ï¼Œä¸åŠ é”ï¼Œå¾ˆå¿«</li>
<li>å¦‚æœreadä¸­æ²¡æœ‰ï¼Œé‚£å°±ä» dirty ä¸­è¯»å–ï¼Œè¿™æ—¶å°±ä¼šåŠ é”è¯»å–äº†</li>
<li>å¦‚æœdirtyä¸­æœ‰å€¼ï¼Œè¿”å›å€¼ï¼Œè¦ä¸è¦æ›´æ–°readå‘¢ï¼Ÿçœ‹missesç»Ÿè®¡æ•°é‡ï¼Œåªæœ‰è¾¾åˆ°æŸä¸ªé˜ˆå€¼misses &gt; len(dirty)ï¼Œæ‰ä¼šæ›´æ–°readï¼ˆæ­£å¸¸æˆ‘ä»¬ä»dirtyä¸­è¯»å–ä¹‹åä¼šé‡æ–°è®¾ç½®åˆ°readä¸­ï¼Œä½†æ˜¯ä½œè€…é€‰æ‹©æä¸ªé˜ˆå€¼æ¥æ§åˆ¶ï¼Œè¿™æ ·å‡å°‘æ‹·è´å€¼ï¼Œå› ä¸ºæ‹·è´å€¼ä¹Ÿæ˜¯æ¯”è¾ƒè€—æ—¶çš„äº‹æƒ…ï¼‰</li>
</ol>
<p>å†™ï¼š</p>
<ol>
<li>å†™çš„æ—¶å€™ï¼Œä¼˜å…ˆæ›´æ–°readä¸­çš„keyï¼Œå› ä¸ºè¿™æ—¶å€™ä¸éœ€è¦åŠ é”ï¼Œé€šè¿‡åŸå­æ“ä½œCompareAndSwap()ï¼Œå¦‚æœèƒ½æ›´æ–°æˆåŠŸï¼Œé‚£å°±èµšåˆ°äº†</li>
<li>å¦‚æœreadä¸­æ²¡æœ‰keyï¼Œé‚£å°±å¼€å§‹åŠ é”äº†ï¼Œå› ä¸ºå¯èƒ½è¦æ“ä½œdirtyäº†
<ul>
<li>è¿™æ—¶å€™è¿˜æ˜¯ä¼šå…ˆçœ‹readä¸­æœ‰æ²¡æœ‰å€¼ï¼Œæœ‰å°±æ›´æ–°readé‡Œçš„æ•°æ®ï¼ˆåŒé‡æ ¡éªŒreadï¼Œå› ä¸ºå¯èƒ½å…¶ä»–çº¿ç¨‹æŠŠreadç»™æ›´æ–°äº†ï¼Œè¿™æ—¶å€™readä¸­åˆæœ‰å€¼äº†ï¼Œæ¡æ¼ï¼‰</li>
</ul>
</li>
<li>å¦‚æœreadè¿˜æ˜¯æ²¡æœ‰keyï¼Œé‚£å°±è¦çœ‹è¿™ä¸ªkeyåœ¨ä¸åœ¨dirtyä¸­äº†ï¼Œå¦‚æœåœ¨dirtyä¸­ï¼Œç›´æ¥æ›´æ–°dirtyä¸­çš„å€¼</li>
<li>å¦‚æœéƒ½ä¸åœ¨ï¼Œé‚£å°±æ˜¯æ–°keyï¼Œæ’å…¥åˆ°dirtyä¸­ï¼Œreadè¿™æ—¶å€™å¹¶æ²¡æœ‰æ–°keyï¼Œæ‰€ä»¥readçš„amendè¦ä¸ºtrueï¼Œè¡¨ç¤ºreadå’Œdirtyæ•°æ®ä¸ä¸€è‡´</li>
</ol>
<p>åˆ ï¼š</p>
<ol>
<li>åˆ é™¤ä¹Ÿæ˜¯å…ˆåˆ¤æ–­readä¸­æœ‰æ²¡æœ‰è¯¥keyï¼Œå¦‚æœæœ‰çš„è¯ï¼Œç›´æ¥å°†è¯¥keyå¯¹åº”çš„entryå¤åˆ¶ä¸ºnilï¼Œæ ‡è®°è¯¥keyåˆ é™¤äº†ï¼ˆè™½ç„¶è¯¥keyè¿˜åœ¨readä¸­ï¼Œä½†æ˜¯entry=nilï¼‰</li>
<li>å¦‚æœreadä¸­æ²¡æœ‰ï¼Œä¸”readå’Œdirtyæ•°æ®ä¸ä¸€è‡´ï¼Œé‚£å°±è¦åŠ é”æ“ä½œäº†</li>
<li>åŒæ ·çš„åŒé‡æ ¡éªŒï¼Œåˆ¤æ–­keyåœ¨ä¸åœ¨readä¸­ï¼Œå¦‚æœåœ¨çš„è¯ï¼ŒåŒ1æ ‡è®°è¯¥keyä¸ºåˆ é™¤ï¼ˆentry=nilï¼‰</li>
<li>å¦‚æœè¿˜æ˜¯ä¸åœ¨ï¼Œé‚£å°±ä»dirtyä¸­è¯»å–è¯¥keyï¼Œå¦‚æœkeyåœ¨dirtyä¸­å­˜åœ¨ï¼ŒåŒæ ·å°†è¯¥keyçš„entry=nilï¼ŒåŒæ—¶å°†dirtyä¸­çš„keyçœŸæ­£åˆ é™¤ï¼ˆè¦ä¿è¯dirtyçš„æ•°æ®éƒ½æ˜¯æœªè¢«åˆ é™¤çš„æ•°æ®ï¼‰ï¼ŒåŒæ—¶misses+1</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"sync"</span>
    <span class="hljs-string">"sync/atomic"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    m := &amp;MapSync{}
    k := <span class="hljs-string">"a"</span>
    v := <span class="hljs-string">"hello"</span>
    k1 := <span class="hljs-string">"b"</span>
    v1 := <span class="hljs-string">"world"</span>

    m.Store(k, v) <span class="hljs-comment">// dirtyä¸­æœ‰kï¼Œreadä¸­æ²¡æœ‰ï¼Œreadçš„amend=true</span>
    fmt.Printf(<span class="hljs-string">"m=%+v\n"</span>, m)
    fmt.Println(<span class="hljs-string">"------"</span>)

    m.Load(k) <span class="hljs-comment">// misses=1</span>
    m.Load(k) <span class="hljs-comment">// misses=2, misses &gt; len(dirty)äº†ï¼Œ æŠŠdirtyçš„å€¼copyç»™readï¼Œreadä¸­å°±æœ‰å€¼käº†ï¼Œdirtyä¸ºnil</span>

    <span class="hljs-comment">// è¿™æ—¶å€™readçš„amend=falseï¼Œè¡¨ç¤ºreadå’Œdirtyæ˜¯ä¸€è‡´çš„</span>
    m.Store(k1, v1) <span class="hljs-comment">// !amendæ¡ä»¶æˆç«‹ï¼ŒæŠŠreadæœªåˆ é™¤çš„kåŒæ­¥ç»™dirtyï¼Œè¿™æ—¶å€™dirtyæœ‰kå’Œk1ï¼Œreadåªæœ‰kï¼Œamend=true</span>

    r, _ := m.dirty[k].load()
    r1, _ := m.loadReadOnly().m[k].load() <span class="hljs-comment">// ä»readä¸­è¯»å–çš„</span>
    <span class="hljs-comment">//r2, _ := m.loadReadOnly().m[k1].load() // ä»readä¸­è¯»å–çš„, readä¸­æ²¡æœ‰ï¼Œä¸€å®šä¼šæŠ¥é”™</span>
    r2 := m.loadReadOnly().m[k1] <span class="hljs-comment">// è¿™é‡Œä¸€å®šæ˜¯nil</span>
    fmt.Printf(<span class="hljs-string">"r=%+v\n"</span>, r)     <span class="hljs-comment">// hello</span>
    fmt.Printf(<span class="hljs-string">"r1=%+v\n"</span>, r1)   <span class="hljs-comment">// hello</span>
    fmt.Printf(<span class="hljs-string">"r2=%+v\n"</span>, r2)   <span class="hljs-comment">// nil</span>

    m.Load(<span class="hljs-string">"c"</span>) <span class="hljs-comment">// misses=1</span>
    m.Load(<span class="hljs-string">"c"</span>) <span class="hljs-comment">// misses=2</span>
    m.Load(<span class="hljs-string">"c"</span>) <span class="hljs-comment">// misses=3 missesæ¡ä»¶è¾¾åˆ°äº†ï¼ŒæŠŠdirtyçš„å€¼èµ‹å€¼ç»™readäº†ï¼Œè¿™æ—¶å€™readå°±æœ‰kå’Œk1äº†ï¼Œdirty=nil</span>

    r1, _ = m.loadReadOnly().m[k].load()   <span class="hljs-comment">// ä»readä¸­è¯»å–çš„</span>
    r3, _ := m.loadReadOnly().m[k1].load() <span class="hljs-comment">// ä»readä¸­è¯»å–çš„</span>
    fmt.Printf(<span class="hljs-string">"r1=%+v\n"</span>, r1)             <span class="hljs-comment">// hello</span>
    fmt.Printf(<span class="hljs-string">"r2=%+v\n"</span>, r3)             <span class="hljs-comment">// world</span>
}

<span class="hljs-keyword">type</span> MapSyncInterface <span class="hljs-keyword">interface</span> {
    Load(key any) (value any, ok <span class="hljs-type">bool</span>)
    Store(key, value any) (previous any, ok <span class="hljs-type">bool</span>)
    Delete(key any) (old any, ok <span class="hljs-type">bool</span>)
}

<span class="hljs-comment">// new è¿”å›çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯´æ˜expungedåªæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œç”¨äºæ ‡è®°æŸä¸ªå…ƒç´ æ˜¯å¦è¢«åˆ é™¤</span>
<span class="hljs-keyword">var</span> expunged = <span class="hljs-built_in">new</span>(any)

<span class="hljs-keyword">type</span> entry <span class="hljs-keyword">struct</span> {
    p atomic.Pointer[any]
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newEntry</span><span class="hljs-params">(i any)</span></span> *entry {
    e := &amp;entry{}
    e.p.Store(&amp;i)
    <span class="hljs-keyword">return</span> e
}

<span class="hljs-comment">// load è·å–mapä¸­valueçš„å€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> load() (value any, ok <span class="hljs-type">bool</span>) {
    p := e.p.Load()
    <span class="hljs-keyword">if</span> p == <span class="hljs-literal">nil</span> || p == expunged {
       <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
    }

    <span class="hljs-keyword">return</span> *p, <span class="hljs-literal">true</span>
}

<span class="hljs-comment">// trySwap å°è¯•æ›´æ–°readä¸­çš„å€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> trySwap(value *any) (*any, <span class="hljs-type">bool</span>) {
    <span class="hljs-comment">// è¿™é‡Œæä¸ªæ­»å¾ªç¯ï¼Œé‚£å°±æ˜¯å¦‚æœå€¼æ²¡æ ‡è®°åˆ é™¤ï¼Œé‚£å°±æ˜¯è¦å¿…æ›´æ–°æˆåŠŸçš„èŠ‚å¥å•Š</span>
    <span class="hljs-keyword">for</span> {
       p := e.p.Load()
       <span class="hljs-comment">// å¦‚æœreadä¸­çš„å€¼å·²ç»æ˜¯æ ‡è®°ä¸ºåˆ é™¤çŠ¶æ€ï¼Œé‚£è¯¥å€¼ä¹Ÿä¸ä¼šå­˜åœ¨äºdirtyä¸­</span>
       <span class="hljs-comment">// æ‰€ä»¥ä¸èƒ½ç›´æ¥æ›´æ–°ï¼Œä¸ç„¶ä¼šå‡ºç°readä¸­æœ‰å€¼ï¼Œä½†æ˜¯dirtyä¸­æ²¡æœ‰</span>
       <span class="hljs-keyword">if</span> p == expunged {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
       }
       <span class="hljs-comment">// ç›´åˆ°æ›´æ–°æˆåŠŸ</span>
       <span class="hljs-keyword">if</span> ok := e.p.CompareAndSwap(p, value); ok {
          <span class="hljs-keyword">return</span> p, <span class="hljs-literal">true</span>
       }
    }
}

<span class="hljs-comment">// delete æ ‡è®°åˆ é™¤</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> <span class="hljs-built_in">delete</span>() (old any, ok <span class="hljs-type">bool</span>) {
    <span class="hljs-comment">// å¾ªç¯æ›´æ–°</span>
    <span class="hljs-keyword">for</span> {
       p := e.p.Load()
       <span class="hljs-comment">// å¦‚æœentryçš„å€¼å·²ç»åˆ é™¤æˆ–è¢«æ ‡è®°ä¸ºåˆ é™¤äº†ï¼Œå°±ä¸å­˜åœ¨åˆ é™¤äº†</span>
       <span class="hljs-keyword">if</span> p == <span class="hljs-literal">nil</span> || p == expunged {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
       }
       <span class="hljs-comment">// æ ‡è®°åˆ é™¤ï¼Œè®¾ç½®ä¸ºnil</span>
       <span class="hljs-keyword">if</span> e.p.CompareAndSwap(p, <span class="hljs-literal">nil</span>) {
          <span class="hljs-keyword">return</span> *p, <span class="hljs-literal">true</span>
       }
    }
}

<span class="hljs-comment">// unexpungeLocked å¦‚æœæ—§çš„å€¼è¢«æ ‡è®°ä¸ºåˆ é™¤äº†ï¼Œé‡æ–°ä¿®æ”¹ä¸ºnil</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> unexpungeLocked() <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">return</span> e.p.CompareAndSwap(expunged, <span class="hljs-literal">nil</span>)
}

<span class="hljs-comment">// swapLocked è®¾ç½®æ–°å€¼ï¼ŒåŒæ—¶æŠŠæ—§å€¼è¿”å›</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> swapLocked(value *any) *any {
    <span class="hljs-keyword">return</span> e.p.Swap(value)
}

<span class="hljs-keyword">type</span> readOnly <span class="hljs-keyword">struct</span> {
    m <span class="hljs-keyword">map</span>[any]*entry <span class="hljs-comment">// readä¸­å­˜å‚¨key-value</span>

    amend <span class="hljs-type">bool</span> <span class="hljs-comment">// å¦‚æœä¸ºtrueï¼Œé‚£è¯´æ˜readä¸­çš„æ•°æ®å’Œdirtyçš„ä¸ä¸€è‡´</span>
}

<span class="hljs-comment">// MapSync å¹¶å‘å®‰å…¨Map</span>
<span class="hljs-keyword">type</span> MapSync <span class="hljs-keyword">struct</span> {
    mu sync.Mutex

    <span class="hljs-comment">// è¯»å†…å®¹ï¼Œç±»ä¼¼äºredisçš„ä½œç”¨ï¼Œç”¨äºå¿«é€ŸæŸ¥è¯¢æ•°æ®ï¼Œä¸éœ€è¦åŠ é”</span>
    <span class="hljs-comment">// å¦‚æœè¯»ä¸­æ²¡æœ‰ï¼Œé‚£å°±éœ€è¦åŠ é”å»dirtyä¸­æŸ¥è¯¢</span>
    <span class="hljs-comment">// å¾€å¾€ä¼šè¿›è¡ŒåŒé‡è¯»ï¼Œç¬¬ä¸€éä¸åŠ é”å»è¯»æ•°æ®ï¼Œå¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œå†åŠ é”å»å–dirtyæ•°æ®ä¹‹å‰ï¼Œå†ä»readä¸­å–ä¸€æ¬¡</span>
    read atomic.Pointer[readOnly]

    <span class="hljs-comment">// ç±»ä¼¼äºDBçš„ä½œç”¨ï¼Œè®°å½•å†™çš„å†…å®¹ï¼Œå¾€å¾€éƒ½æ˜¯æœ€æ–°æœ€å‡†ç¡®çš„æ•°æ®</span>
    <span class="hljs-comment">// æ–°å¢çš„keyéƒ½æ˜¯å†™åˆ°dirtyä¸­</span>
    dirty <span class="hljs-keyword">map</span>[any]*entry

    <span class="hljs-comment">// misses, æŒ‡readå’Œdirtyä¸­æ•°æ®ä¸ä¸€è‡´çš„æ¬¡æ•°</span>
    <span class="hljs-comment">// å¦‚æœmissesæ•°å¤§äºç­‰äºdirtyçš„é•¿åº¦ï¼Œåˆ™è¡¨ç¤ºç©¿é€åˆ°dirtyçš„æƒ…å†µæ¯”è¾ƒå¤šï¼Œ</span>
    <span class="hljs-comment">// è¿™æ—¶å€™éœ€è¦æŠŠdirtyä¸­çš„æ•°æ®æ”¾åˆ°readä¸­ï¼Œæ–¹ä¾¿åç»­åªéœ€è¦ä»readä¸­è¯»å–ï¼Œå‡å°‘åŠ å‡é”çš„æ€§èƒ½</span>
    misses <span class="hljs-type">int</span>
}

<span class="hljs-comment">// loadReadOnly åŠ è½½readOnly</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> loadReadOnly() readOnly {
    <span class="hljs-keyword">if</span> p := m.read.Load(); p != <span class="hljs-literal">nil</span> {
       <span class="hljs-keyword">return</span> *p
    }

    <span class="hljs-keyword">return</span> readOnly{}
}

<span class="hljs-comment">// Load æ ¹æ®keyæŸ¥è¯¢valueå€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> Load(key any) (value any, ok <span class="hljs-type">bool</span>) {
    <span class="hljs-comment">// è¯»å–read</span>
    read := m.loadReadOnly()
    <span class="hljs-comment">// å…ˆä»readä¸­è·å–keyæ˜¯å¦å­˜åœ¨</span>
    e, ok := read.m[key]
    <span class="hljs-comment">// å¦‚æœkeyä¸å­˜åœ¨readä¸­ï¼Œä¸”readå’Œdirtyä¸­çš„æ•°æ®ä¸ä¸€è‡´äº†ï¼Œå†å»dirtyä¸­è¯»å–</span>
    <span class="hljs-comment">// ä¸ç„¶å¦‚æœreadå’Œdirtyä¸€è‡´ï¼Œreadä¸­æ²¡æœ‰ï¼Œdirtyä¸€æ ·æ²¡æœ‰ï¼Œä¹Ÿæ²¡å¿…è¦å»dirtyä¸­è¯»å–äº†</span>
    <span class="hljs-keyword">if</span> !ok &amp;&amp; read.amend {
       <span class="hljs-comment">// å‡†å¤‡ä»dirtyä¸­è¯»å–ï¼Œå…ˆé”ä½</span>
       m.mu.Lock()

       <span class="hljs-comment">// åŒé‡æ ¡éªŒ</span>
       read = m.loadReadOnly()
       e, ok = read.m[key]
       <span class="hljs-keyword">if</span> !ok &amp;&amp; read.amend {
          <span class="hljs-comment">// åŒé‡æ ¡éªŒè¿˜æ˜¯æ²¡æœ‰ï¼Œä¸”readå’Œdirtyä¸ä¸€æ ·ï¼Œé‚£å°±ä»dirtyä¸­è¯»å–</span>
          e, ok = m.dirty[key]
          m.missLocked()
       }
       m.mu.Unlock()
    }

    <span class="hljs-comment">// æœ€åæ£€æŸ¥ä¸€æ¬¡ï¼Œä¸ç®¡æ˜¯ä»readä¸­ï¼Œè¿˜æ˜¯ä»dirtyä¸­ï¼Œå¦‚æœèƒ½è¯»åˆ°ï¼Œokéƒ½æœ‰å€¼</span>
    <span class="hljs-keyword">if</span> !ok {
       <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
    }

    <span class="hljs-comment">// è¿”å›mapä¸­valueçš„å€¼</span>
    <span class="hljs-keyword">return</span> e.load()
}

<span class="hljs-comment">// Store æ›´æ–°/æ’å…¥æ–°çš„å€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> Store(key, value any) (previous any, loaded <span class="hljs-type">bool</span>) {
    <span class="hljs-comment">// å…ˆä»readä¸­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨è¯¥key</span>
    read := m.loadReadOnly()
    <span class="hljs-keyword">if</span> e, ok := read.m[key]; ok {
       <span class="hljs-comment">// readä¸­æœ‰æ•°æ®ï¼Œé‚£å°±å°è¯•åœ¨readä¸­æ›´æ–°è¯¥å€¼ï¼Œ</span>
       <span class="hljs-comment">// ä¸ºå•¥å°è¯•åœ¨readä¸­æ›´æ–°ï¼Ÿé€šè¿‡åŸå­æ“ä½œå‡å°‘åŠ é”å¸¦æ¥çš„æ¶ˆè€—</span>
       <span class="hljs-comment">// å› ä¸ºreadä¸­å’Œdirtyä¸­æŒ‡å‘çš„åº•å±‚æ˜¯ä¸€æ ·ï¼Œreadä¸­æ›´æ–°äº†ï¼Œdirtyä¸­çš„å€¼ä¹Ÿä¼šç›¸åº”æ›´æ–°ï¼Œå¦‚æœdirtyæœ‰è¯¥keyçš„è¯</span>
       <span class="hljs-keyword">if</span> v, ok := e.trySwap(&amp;value); ok {
          <span class="hljs-comment">// æ—§å€¼æ˜¯nilï¼Œè¯´æ˜æ—§å€¼è¢«åˆ é™¤äº†</span>
          <span class="hljs-comment">// è¿™é‡Œå…¶å®å·²ç»æ›´æ–°æˆåŠŸäº†ï¼Œåªæ˜¯æ—§å€¼è¢«åˆ é™¤äº†ï¼Œè¿™é‡Œè¿”å›nilå’Œæ— æ³•è·å–æ—§å€¼</span>
          <span class="hljs-keyword">if</span> v == <span class="hljs-literal">nil</span> {
             <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
          }
          <span class="hljs-comment">// è¿”å›æ—§å€¼çš„å€¼å’Œæ ‡è¯†æ—§å€¼å­˜åœ¨</span>
          <span class="hljs-keyword">return</span> *v, <span class="hljs-literal">true</span>
       }
    }

    <span class="hljs-comment">// å¦‚æœreadä¸­æ²¡æœ‰æ•°æ®ï¼Œé‚£å°±éœ€è¦åŠ é”å†™å…¥äº†</span>
    m.mu.Lock()

    <span class="hljs-comment">// åŒé‡æ ¡éªŒ</span>
    read = m.loadReadOnly()
    <span class="hljs-keyword">if</span> e, ok := read.m[key]; ok {
       <span class="hljs-keyword">if</span> e.unexpungeLocked() {
          <span class="hljs-comment">// å¦‚æœæ—§å€¼è¢«æ ‡è®°ä¸ºåˆ é™¤çŠ¶æ€ï¼Œé‚£è¯´æ˜å‘ç”Ÿäº†readä¸­çš„æœªè¢«åˆ é™¤çš„å€¼é‡æ–°å†™åˆ°äº†dirtyä¸­ï¼Œä¸”è¯¥å€¼å°±ä¸ä¼šå­˜åœ¨äºdirtyä¸­</span>
          <span class="hljs-comment">// é‚£å°±éœ€è¦æŠŠè¯¥keyï¼Œå†™å…¥åˆ°dirtyä¸­, ä¿è¯dirtyä¸­ä¸€å®šæœ‰readä¸­æœªè¢«åˆ é™¤çš„å€¼</span>
          m.dirty[key] = e
       }
       <span class="hljs-comment">// æŠŠreadä¸­çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ï¼Œè¿™ä¸€æ­¥å’Œä¸Šé¢çš„trySwapä¸åŒ</span>
       <span class="hljs-comment">// ä¸Šé¢çš„æ˜¯æ²¡åŠ é”çš„ï¼Œæ‰€ä»¥éœ€è¦ä¸æ–­é‡è¯•æ›´æ–°</span>
       <span class="hljs-comment">// è¿™é‡Œå‰é¢å·²ç»åŠ é”äº†ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¤„ç†ï¼Œç›´æ¥æ›´æ–°å€¼å³å¯</span>
       <span class="hljs-comment">// åˆ°è¿™ä¸€æ­¥å…¶å®å°±æ›´æ–°æˆåŠŸäº†ï¼Œè¿™ä¸ªv != nilçš„åˆ¤æ–­åªæ˜¯åˆ¤æ–­è¿”å›æ—§å€¼æœ‰æ²¡æœ‰å€¼</span>
       <span class="hljs-comment">// è¿™ä¸€æ­¥æ›´æ–°æˆåŠŸï¼Œå¯¹åº”dirtyä¸­eçš„å€¼ä¹ŸæˆåŠŸäº†ï¼Œå› ä¸ºeçš„åº•å±‚æ˜¯ä¸€æ ·çš„</span>
       <span class="hljs-keyword">if</span> v := e.swapLocked(&amp;value); v != <span class="hljs-literal">nil</span> {
          loaded = <span class="hljs-literal">true</span>
          previous = *v
       }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> e, ok := m.dirty[key]; ok { <span class="hljs-comment">// readä¸­æ²¡æœ‰å€¼ï¼Œå¦‚æœdirtyä¸­æœ‰ï¼Œé‚£å°±æ›´æ–°dirtyçš„å€¼</span>
       <span class="hljs-comment">// ä»€ä¹ˆæƒ…å†µä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œé‚£å°±æ˜¯æ’å…¥ä¹‹åæ¥ç€æ›´æ–°çš„æƒ…å†µï¼Œè¿™æ—¶å€™readæ˜¯æ²¡æœ‰å€¼çš„</span>
       <span class="hljs-comment">// ä¸‹é¢è¿™ä¸ªæ–¹æ³•æ˜¯æ¯”æˆåŠŸçš„ï¼Œå› ä¸ºåŠ é”äº†ï¼Œv != nilåˆ¤æ–­åªæ˜¯åˆ¤æ–­è¿”å›æ—§å€¼æœ‰æ²¡æœ‰å€¼</span>
       <span class="hljs-keyword">if</span> v := e.swapLocked(&amp;value); v != <span class="hljs-literal">nil</span> {
          loaded = <span class="hljs-literal">true</span>
          previous = *v
       }
    } <span class="hljs-keyword">else</span> { <span class="hljs-comment">// å¦‚æœread å’Œ dirtyä¸­éƒ½æ²¡æœ‰ï¼Œé‚£å°±æ˜¯æ–°çš„keyæ’å…¥åœºæ™¯</span>
       <span class="hljs-comment">// å¦‚æœreadå’Œdirtyä¸­æ˜¯ä¸€è‡´çš„ï¼Œé‚£å°±éœ€è¦æ›´æ–°readçš„amendå€¼ä¸ºtrueï¼Œæ ‡è®°ä¸ºä¸ä¸€è‡´</span>
       <span class="hljs-comment">// ä»€ä¹ˆæƒ…å†µä¸‹æ˜¯ä¸€è‡´çš„å‘¢ï¼Ÿ</span>
       <span class="hljs-comment">// 1ã€åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç¬¬ä¸€æ¬¡æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œamend=false</span>
       <span class="hljs-comment">// 2ã€missesæ•°é‡è¶…è¿‡äº†é˜ˆå€¼ï¼Œé‡æ–°æŠŠdirtyèµ‹å€¼ç»™readï¼Œè¿™æ—¶å€™amendæ˜¯false</span>
       <span class="hljs-keyword">if</span> !read.amend {
          <span class="hljs-comment">// åŒæ—¶å¦‚æœreadä¸­æœ‰æœªåˆ é™¤çš„å€¼ï¼Œä¹ŸåŒæ­¥ç»™dirty</span>
          m.dirtyLocked()
          <span class="hljs-comment">// å› ä¸ºåªå†™åˆ°dirtyï¼Œä¸å†™readï¼Œæ‰€ä»¥ä¸¤è€…ä¸€å®šæ˜¯ä¸ä¸€è‡´çš„ï¼Œamend=true</span>
          m.read.Store(&amp;readOnly{m: read.m, amend: <span class="hljs-literal">true</span>})
       }
       <span class="hljs-comment">// ç›´æ¥å†™åˆ°dirtyä¸­ï¼Œè¿™æ—¶readä¸­æ˜¯æ²¡æœ‰è¯¥keyçš„ï¼Œå› ä¸ºæ–°æ’å…¥çš„keyéƒ½æ˜¯åœ¨dirtyä¸­</span>
       m.dirty[key] = newEntry(value)
    }

    m.mu.Unlock()

    <span class="hljs-keyword">return</span> previous, loaded
}

<span class="hljs-comment">// Delete åˆ é™¤æŸä¸ªkey</span>
<span class="hljs-comment">// æ ‡è®°åˆ é™¤æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> Delete(key any) (value any, loaded <span class="hljs-type">bool</span>) {
    <span class="hljs-comment">// ä»readæ€»è¯»å–è¯¥å€¼</span>
    read := m.loadReadOnly()
    e, ok := read.m[key]
    <span class="hljs-keyword">if</span> !ok &amp;&amp; read.amend {
       m.mu.Lock()
       read = m.loadReadOnly()
       e, ok = read.m[key]
       <span class="hljs-keyword">if</span> !ok &amp;&amp; read.amend {
          <span class="hljs-comment">// ä»dirtyè·å–</span>
          e, ok = m.dirty[key]
          <span class="hljs-comment">// ç›´æ¥åˆ é™¤ï¼Œè¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œå¹¶ä¸ä¼šçœŸæ­£åˆ é™¤</span>
          <span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•æ˜¯çœŸæ­£åˆ é™¤ï¼Œå› ä¸ºè¦ä¿è¯dirtyçš„æ•°æ®éƒ½æ˜¯æœªè¢«åˆ é™¤çš„æ­£å¸¸çš„æ•°æ®</span>
          <span class="hljs-built_in">delete</span>(m.dirty, key)
          <span class="hljs-comment">// è®°ä¸€æ¬¡ç©¿é€</span>
          m.missLocked()
       }
       m.mu.Unlock()
    }

    <span class="hljs-keyword">if</span> ok {
       <span class="hljs-keyword">return</span> e.<span class="hljs-built_in">delete</span>() <span class="hljs-comment">// èµ‹å€¼ä¸ºnilï¼Œè¡¨ç¤ºåˆ é™¤äº†</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>
}

<span class="hljs-comment">// missLocked å¯¹missesè®¡æ•°ï¼Œè¶…è¿‡ä¸€å®šé˜ˆå€¼åï¼ŒæŠŠdirtyçš„å€¼èµ‹å€¼åˆ°readä¸­</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> missLocked() {
    m.misses++
    <span class="hljs-comment">// è¿™é‡Œä¸ºå•¥æ˜¯dirtyé•¿åº¦å‘¢ï¼Ÿ</span>
    <span class="hljs-comment">// å› ä¸ºdirtyä»£è¡¨å†™å…¥çš„æ•°æ®ï¼Œç­‰äºdirtyé•¿åº¦ï¼Œç›¸å½“äºå…è®¸æ¯ä¸ªæ–°keyéƒ½ç©¿é€ä¸€æ¬¡ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œé‚£å°±è¯´æ˜ç©¿é€æ¦‚ç‡å¾ˆé«˜äº†</span>
    <span class="hljs-keyword">if</span> m.misses &lt; <span class="hljs-built_in">len</span>(m.dirty) {
       <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// è¶…è¿‡é˜ˆå€¼äº†, æŠŠdirtyç»™åˆ°readï¼ŒæŠŠdirtyè®¾ç½®ä¸ºnil</span>
    <span class="hljs-comment">// ä¸ºå•¥è¦æŠŠdirtyç»™readï¼Œå› ä¸ºè¿›å…¥åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯readä¸­æ²¡æœ‰ï¼Œæ‰åˆ°dirtyä¸­çš„ï¼Œéƒ½å·²ç»ç©¿é€äº†</span>
    <span class="hljs-comment">// æ‰€ä»¥å°±æŠŠreadçš„æ¢æˆdirtyçš„ï¼Œè¿™æ ·å°±å‡å°‘ç©¿é€äº†</span>
    m.read.Store(&amp;readOnly{m: m.dirty})
    <span class="hljs-comment">// ä¸ºå•¥è¦æŠŠdirtyè®¾ç½®ä¸ºnilå‘¢ï¼Ÿ</span>
    <span class="hljs-comment">// æˆ‘çš„ç†è§£æ˜¯ï¼Œæ—¢ç„¶æŠŠdirtyç»™åˆ°readäº†ï¼Œé‚£å¤§éƒ¨åˆ†çš„è¯»åœ¨readä¸­å°±èƒ½è·å–åˆ°äº†ï¼Œå°±ä¸éœ€è¦åˆ°dirtyä¸­æŸ¥è¯¢äº†</span>
    <span class="hljs-comment">// å¯¹äºæ–°æ’å…¥çš„keyï¼Œæ˜¯å†™åˆ°dirtyä¸­çš„ï¼Œä½†æ˜¯å†™å…¥dirtyä¹‹å‰ï¼Œä¼šæŠŠreadä¸­çš„å€¼åŒæ­¥å›dirty</span>
    m.dirty = <span class="hljs-literal">nil</span>
    m.misses = <span class="hljs-number">0</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MapSync)</span></span> dirtyLocked() {
    <span class="hljs-comment">// å¦‚æœdirtyä¸ä¸ºç©ºï¼Œç›´æ¥è¿”å›</span>
    <span class="hljs-keyword">if</span> m.dirty != <span class="hljs-literal">nil</span> {
       <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// ä»€ä¹ˆæƒ…å†µä¸‹dirtyæ˜¯nilï¼Ÿ</span>
    <span class="hljs-comment">// 1ã€åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç¬¬ä¸€æ¬¡æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œdirtyæ˜¯nil</span>
    <span class="hljs-comment">// 2ã€missesæ•°é‡è¶…è¿‡äº†é˜ˆå€¼ï¼Œé‡æ–°æŠŠdirtyèµ‹å€¼ç»™readï¼Œè¿™æ—¶å€™amendæ˜¯falseï¼Œdirtyæ˜¯nil</span>
    read := m.loadReadOnly()

    <span class="hljs-comment">// æŠŠreadä¸­ä½nilçš„æ ‡è®°ä¸ºå·²åˆ é™¤çš„åŒæ—¶ï¼ŒæŠŠæœªåˆ é™¤çš„æ•°æ®èµ‹å€¼ç»™dirty</span>
    m.dirty = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[any]*entry, <span class="hljs-built_in">len</span>(read.m))
    <span class="hljs-keyword">for</span> k, e := <span class="hljs-keyword">range</span> read.m {
       <span class="hljs-keyword">if</span> !e.tryExpungeLocked() {
          <span class="hljs-comment">// èƒ½ä¸èƒ½ä¸åŒæ­¥readçš„æ•°æ®ç»™dirtyå‘¢ï¼Ÿ</span>
          <span class="hljs-comment">// æˆ‘ç†è§£æ˜¯ä¸èƒ½çš„ï¼Œå› ä¸ºå¦‚æœä¸åŒæ­¥readçš„æ•°æ®ç»™dirtyï¼Œåç»­missesè¶…è¿‡äº†ï¼Œdirtyç›´æ¥è¦†ç›–readçš„å€¼</span>
          <span class="hljs-comment">// dirtyå˜ä¸ºnilï¼Œé‚£ä¹‹å‰readä¸­çš„é‚£éƒ¨åˆ†æ•°æ®æ˜¯ä¸æ˜¯å°±ä¸¢äº†ï¼Ÿ</span>
          m.dirty[k] = e
       }
    }
}

<span class="hljs-comment">// tryExpungeLocked æ ‡è®°ä¸ºåˆ é™¤</span>
<span class="hljs-comment">// deleteæ–¹æ³•åªæ˜¯æŠŠentryè®¾ç½®ä¸ºnil</span>
<span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•å°±æ˜¯æŠŠæ ‡è®°ä¸ºnilçš„entryæ ‡è®°ä¸ºexpunged</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *entry)</span></span> tryExpungeLocked() <span class="hljs-type">bool</span> {
    p := e.p.Load()
    <span class="hljs-comment">// ä¸æ–­å¾ªç¯ï¼Œç›´åˆ°æ ‡è®°æˆåŠŸä¸ºæ­¢</span>
    <span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•å°±æ˜¯æŠŠæ ‡è®°ä¸ºnilçš„entryæ ‡è®°ä¸ºexpungedï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ä¸ºnilçš„æ‰ä¼šè¿›å…¥å¾ªç¯å¤„ç†</span>
    <span class="hljs-keyword">for</span> p == <span class="hljs-literal">nil</span> {
       <span class="hljs-comment">// æ ‡è®°ä¸ºåˆ é™¤</span>
       <span class="hljs-keyword">if</span> e.p.CompareAndSwap(<span class="hljs-literal">nil</span>, expunged) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
       }
       p = e.p.Load()
    }

    <span class="hljs-comment">// å¦‚æœpä¸ä¸ºnilï¼Œå°±ä¸ä¼šè¿›å…¥ä¸Šé¢çš„å¾ªç¯ï¼Œé‚£å°±è¦åˆ¤æ–­æ˜¯å¦å·²è¢«æ ‡è®°ä¸ºåˆ é™¤</span>
    <span class="hljs-keyword">return</span> p == expunged
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[From Nand to Tetris é‡Œçš„ Project 5 (CPU éƒ¨åˆ†)]]></title>    <link>https://juejin.cn/post/7598499504170713126</link>    <guid>https://juejin.cn/post/7598499504170713126</guid>    <pubDate>2026-01-24T07:25:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598499504170713126" data-draft-id="7598011274686775296" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="From Nand to Tetris é‡Œçš„ Project 5 (CPU éƒ¨åˆ†)"/> <meta itemprop="keywords" content="è®¾è®¡"/> <meta itemprop="datePublished" content="2026-01-24T07:25:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é‡‘éŠ€éŠ…éµ"/> <meta itemprop="url" content="https://juejin.cn/user/747323638159757"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            From Nand to Tetris é‡Œçš„ Project 5 (CPU éƒ¨åˆ†)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323638159757/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é‡‘éŠ€éŠ…éµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:25:51.000Z" title="Sat Jan 24 2026 07:25:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>è®©æˆ‘ä»¬æŒ‰ç…§Â <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">From Nand to Tetris</a>Â é‡ŒÂ <code>Project 5</code>Â çš„è¦æ±‚ï¼Œæ¥å®Œæˆä¸‹åˆ—çš„è®¾è®¡ã€‚</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> 1. <code>Memory</code> (å·²å®Œæˆï¼Œå¯ä»¥å‚è€ƒ <a href="https://juejin.cn/spost/7592531796039925794" target="_blank" title="https://juejin.cn/spost/7592531796039925794">From Nand to Tetris é‡Œçš„ Project 5 (Memory éƒ¨åˆ†)</a> ä¸€æ–‡)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 2.  <code>CPU</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 3.  <code>Computer</code></li>
</ul>
<p><strong>æœ¬æ–‡åªæ¶‰åŠÂ <code>CPU</code>Â çš„å®ç°</strong></p>
<h2 data-id="heading-0">è¯´æ˜</h2>
<p>æˆ‘æ˜¯é˜…è¯»äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a>Â ç¬¬ 5 ç« çš„å†…å®¹åæ‰å»å®ŒæˆÂ <code>Project 5</code>Â çš„ã€‚è¯»è€…æœ‹å‹åœ¨å®ŒæˆÂ <code>Project 5</code>Â æ—¶ï¼Œå¦‚æœé‡åˆ°ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œå¯ä»¥å‚è€ƒä¹¦ä¸­çš„æè¿°ã€‚ä¹¦ä¸­ç¬¬ <code>66</code> é¡µå’Œç¬¬ <code>67</code> é¡µæœ‰å¦‚ä¸‹å†…å®¹ï¼Œå¯ä¾›å‚è€ƒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d3c7749e0c14c5e842624aec2a7b399~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=XHMVPSVmF3CKubx0aBQKftPFV5Q%3D" alt="p66.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d4316bec9b452eb27e758a2a5be939~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=GhbRfWloHDKaT85Jt43OLisHbkA%3D" alt="p67_temp.png" loading="lazy"/></p>
<h2 data-id="heading-1">æ­£æ–‡</h2>
<p>å‰å¾€Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fnand2tetris.github.io%2Fweb-ide%2Fchip%2F" target="_blank" title="https://nand2tetris.github.io/web-ide/chip/" ref="nofollow noopener noreferrer">Nand to Tetris Online IDE</a>ï¼Œé€‰æ‹©Â <code>Project 5</code>Â é‡Œçš„Â <code>CPU</code>Â â¬‡ï¸</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç°Â <code>CPU</code>Â (ä¸­å¤®å¤„ç†å•å…ƒ)ï¼Œæ³¨é‡Šä¸­çš„ç›¸å…³æè¿°å¦‚ä¸‹ â¬‡ï¸</p>
<pre><code class="hljs language-text" lang="text">/**
 * The Hack Central Processing unit (CPU).
 * Parses the binary code in the instruction input and executes it according to the
 * Hack machine language specification. In the case of a C-instruction, computes the
 * function specified by the instruction. If the instruction specifies to read a memory
 * value, the inM input is expected to contain this value. If the instruction specifies
 * to write a value to the memory, sets the outM output to this value, sets the addressM
 * output to the target address, and asserts the writeM output (when writeM = 0, any
 * value may appear in outM).
 * If the reset input is 0, computes the address of the next instruction and sets the
 * pc output to that value. If the reset input is 1, sets pc to 0.
 * Note: The outM and writeM outputs are combinational: they are affected by the
 * instruction's execution during the current cycle. The addressM and pc outputs are
 * clocked: although they are affected by the instruction's execution, they commit to
 * their new values only in the next cycle.
 */
</code></pre>
<ul>
<li>è¾“å…¥æ˜¯
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>inM[16]</mtext></mrow><annotation encoding="application/x-tex">\text{inM[16]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">inM[16]</span></span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[16]</mtext></mrow><annotation encoding="application/x-tex">\text{instruction[16]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[16]</span></span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>reset</mtext></mrow><annotation encoding="application/x-tex">\text{reset}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord text"><span class="mord">reset</span></span></span></span></span></span></li>
</ul>
</li>
<li>è¾“å‡ºæ˜¯
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>outM[16]</mtext></mrow><annotation encoding="application/x-tex">\text{outM[16]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">outM[16]</span></span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>writeM</mtext></mrow><annotation encoding="application/x-tex">\text{writeM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">writeM</span></span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>addressM[15]</mtext></mrow><annotation encoding="application/x-tex">\text{addressM[15]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">addressM[15]</span></span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pc[15]</mtext></mrow><annotation encoding="application/x-tex">\text{pc[15]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">pc[15]</span></span></span></span></span></span></li>
</ul>
</li>
</ul>
<p>å®ç° <code>CPU</code> éœ€è¦å¤„ç†ä»¥ä¸‹ <code>3</code> éƒ¨åˆ†çš„é€»è¾‘</p>
<ol>
<li>æŒ‡ä»¤è¯‘ç </li>
<li>æŒ‡ä»¤çš„æ‰§è¡Œ</li>
<li>å–æŒ‡ä»¤</li>
</ol>
<h3 data-id="heading-2">1 æŒ‡ä»¤è¯‘ç </h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>67</code> é¡µå¯¹ <strong>æŒ‡ä»¤è¯‘ç </strong> æœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cccb39ef6bbb42178d5cff8bbfd5c823~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=hLKDrehsCICO9Y0rTs%2FwI%2F0t%2FvE%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[15]</mtext><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{instruction[15]}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[15]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼Œåˆ™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> è¡¨ç¤ºä¸€æ¡ <code>A</code> æŒ‡ä»¤ã€‚<code>A</code> æŒ‡ä»¤æ»¡è¶³ä»¥ä¸‹æ¨¡å¼(<code>?</code> è¡¨ç¤ºå¯¹è¿™ä¸€ä½çš„å€¼æ²¡æœ‰é™åˆ¶)</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19cff3cb74924681a58efc859b60de95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=kfBYD2KwjL6Eiekw1UlLPwk57VA%3D" alt="mermaid-diagram-2026-01-24-120551.png" loading="lazy"/></p>
<p>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[15]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[15]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[15]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> è¡¨ç¤ºä¸€æ¡ <code>C</code> æŒ‡ä»¤ã€‚<code>C</code> æŒ‡ä»¤çš„æ ¼å¼å¦‚ä¸‹ â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00bb7b620448470e9c13bda1e9f1d6ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=Qorl1yAty%2FxtlH4WU17EIBYB%2FtI%3D" alt="mermaid-diagram-2026-01-24-150022.png" loading="lazy"/></p>
<h3 data-id="heading-3">2 æŒ‡ä»¤çš„æ‰§è¡Œ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>67</code> é¡µå¯¹ <strong>æŒ‡ä»¤çš„æ‰§è¡Œ</strong> æœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f757fed8207404fa1163540c202e6c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=tGhlYM6uKWJkXQZRth0wFfqBH4E%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span>: ç¡®å®š <code>ALU</code> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥æ¥è‡ª <code>A</code> å¯„å­˜å™¨çš„å€¼è¿˜æ˜¯æ¥è‡ªè¾“å…¥çš„ <code>M</code> å€¼
<ul>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼Œåˆ™ <code>ALU</code> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥æ¥è‡ª <code>A</code> å¯„å­˜å™¨</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™ <code>ALU</code> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥æ¥è‡ªè¾“å…¥çš„ <code>M</code> å€¼</li>
</ul>
</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">cccccc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">cccccc</span></span></span></span></span>: è¿™äº›ä½ç”¨äºç¡®å®š <code>ALU</code> æ‰§è¡Œæ€æ ·çš„è®¡ç®—</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dest</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span></span></span></span></span>): è¿™äº›ä½ç”¨äºç¡®å®šç”±å“ªäº›å¯„å­˜å™¨æ¥æ”¶ <code>ALU</code> çš„è¾“å‡º</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>j</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">jjj</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">jjj</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>u</mi><mi>m</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">jump</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span></span></span></span></span>): è¿™äº›ä½ç”¨äºç¡®å®šä¸‹ä¸€æ¡è¦å–å‡ºçš„æŒ‡ä»¤</li>
</ul>
<h4 data-id="heading-4">åˆ¤æ–­ <code>instruction</code> æ˜¯ <code>A</code> æŒ‡ä»¤è¿˜æ˜¯ <code>C</code> æŒ‡ä»¤</h4>
<ul>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[15]</mtext><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{instruction[15]}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[15]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼Œåˆ™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> è¡¨ç¤ºä¸€æ¡ <code>A</code> æŒ‡ä»¤</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[15]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[15]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[15]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> è¡¨ç¤ºä¸€æ¡ <code>C</code> æŒ‡ä»¤</li>
</ul>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// instruction type
DMux(in= true, sel= instruction[15], a= aType, b= cType);
</code></pre>
<h4 data-id="heading-5">å¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span> ä½çš„åˆ¤æ–­</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>49</code> é¡µæœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce5d168fbb26413dac781b1ad132ca5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=KVS%2F79jt4FwLQCGHt%2BJ83WfyhdQ%3D" alt="image.png" loading="lazy"/>
å¦‚æœ <code>instruction</code> æ˜¯ <code>C</code> æŒ‡ä»¤ï¼Œé‚£ä¹ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[12]</mtext></mrow><annotation encoding="application/x-tex">\text{instruction[12]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[12]</span></span></span></span></span></span> å°±æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span>ï¼Œå®ƒçš„å€¼å†³å®šäº† <code>ALU</code> çš„  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>  è¾“å…¥æ¥è‡ªå“ªé‡Œ</p>
<ul>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼Œåˆ™ <code>ALU</code> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥æ¥è‡ª <code>A</code> å¯„å­˜å™¨</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™ <code>ALU</code> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥æ¥è‡ªè¾“å…¥çš„ <code>M</code> å€¼</li>
</ul>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸ (<strong><code>aRegister</code> è¡¨ç¤º <code>A</code> å¯„å­˜å™¨çš„è¾“å‡ºï¼Œä¸‹æ–‡ä¼šæåˆ°</strong>)</p>
<pre><code class="hljs language-hdl" lang="hdl">Mux16(a= aRegisterOut, b= inM, sel= instruction[12], out= yOfAlu);
</code></pre>
<h4 data-id="heading-6">å¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">cccccc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">cccccc</span></span></span></span></span> ä½çš„åˆ¤æ–­</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>49</code> é¡µæœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/988fbdc28987480dbf483618c0988c29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=ov6%2FF9C6lPCj%2B47vpAl4F8rgrNM%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹ <code>ALU</code> è€Œè¨€ï¼Œ</p>
<ul>
<li>å®ƒçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span> è¾“å…¥æ€»æ˜¯æ¥è‡ª <code>D</code> å¯„å­˜å™¨çš„è¾“å‡º</li>
<li>å®ƒçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> è¾“å…¥ç”± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[12]</mtext></mrow><annotation encoding="application/x-tex">\text{instruction[12]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[12]</span></span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span> ä½) æ¥å†³å®š(ä¸Šæ–‡å·²æåˆ°ï¼Œè¿™é‡Œä¸èµ˜è¿°)</li>
</ul>
<p>è¿™æ ·å¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸ (<strong><code>dRegister</code> è¡¨ç¤º <code>D</code> å¯„å­˜å™¨çš„è¾“å‡ºï¼Œä¸‹æ–‡ä¼šæåˆ°</strong>)</p>
<pre><code class="hljs language-hdl" lang="hdl">ALU(x= dRegisterOut, y= yOfAlu, 
    zx= instruction[11], 
    nx= instruction[10],
    zy= instruction[9], 
    ny= instruction[8], 
    f= instruction[7], 
    no= instruction[6], 
    out= aluOut, zr= zr, ng= ng);
</code></pre>
<h4 data-id="heading-7">å¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dest</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span></span></span></span></span>) ä½çš„åˆ¤æ–­</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>49</code> é¡µæœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa9bf24231d4484cb09512129b0352e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=7Q4RbA2fywQHgTq0MOCIMZxedwA%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœ <code>instruction</code> æ˜¯ <code>C</code> æŒ‡ä»¤ï¼Œé‚£ä¹ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[3..5]</mtext></mrow><annotation encoding="application/x-tex">\text{instruction[3..5]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[3..5]</span></span></span></span></span></span> è¡¨ç¤º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dest</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span></span></span></span></span>)</p>
<ul>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[3]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[3]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[3]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RAM[A]</mtext></mrow><annotation encoding="application/x-tex">\text{RAM[A]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">RAM[A]</span></span></span></span></span></span> ä¸­</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[4]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[4]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[4]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>D</mtext></mrow><annotation encoding="application/x-tex">\text{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">D</span></span></span></span></span></span> å¯„å­˜å™¨ä¸­</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[5]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[5]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[5]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>A</mtext></mrow><annotation encoding="application/x-tex">\text{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">A</span></span></span></span></span></span> å¯„å­˜å™¨ä¸­</li>
</ul>
<p><strong>è¯·æ³¨æ„ï¼Œä»¥ä¸Šä¸‰ä¸ªåˆ¤æ–­å¹¶ä¸æ˜¯äº’æ–¥çš„ã€‚</strong></p>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// dest
And(a= cType, b= instruction[3], out= toM, out= writeM);
And(a= cType, b= instruction[4], out= toD);
And(a= cType, b= instruction[5], out= toA);
</code></pre>
<h4 data-id="heading-8">å¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>j</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">jjj</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">jjj</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>u</mi><mi>m</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">jump</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span></span></span></span></span>) ä½çš„åˆ¤æ–­</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>49</code> é¡µæœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/313237ac7d6d411983e695fae189fa7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=ox9HMSROQrf4ZO5BwXBf9El0r1E%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœ <code>instruction</code> æ˜¯ <code>C</code> æŒ‡ä»¤ï¼Œé‚£ä¹ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[0..2]</mtext></mrow><annotation encoding="application/x-tex">\text{instruction[0..2]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[0..2]</span></span></span></span></span></span> è¡¨ç¤º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>j</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">jjj</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">jjj</span></span></span></span></span> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mi>u</mi><mi>m</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">jump</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span></span></span></span></span>)</p>
<ul>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[0]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[0]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[0]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å½“è®¡ç®—ç»“æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gt 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span> æ—¶ï¼Œè¦è·³è½¬</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[1]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[1]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[1]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å½“è®¡ç®—ç»“æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">= 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span> æ—¶ï¼Œè¦è·³è½¬</li>
<li>å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[2]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[2]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[2]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œåˆ™å½“è®¡ç®—ç»“æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lt 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"/><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span> æ—¶ï¼Œè¦è·³è½¬</li>
</ul>
<p><strong>è¯·æ³¨æ„ï¼Œä»¥ä¸Šä¸‰ä¸ªåˆ¤æ–­å¹¶ä¸æ˜¯äº’æ–¥çš„ã€‚</strong> (ä¾‹å¦‚ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[0]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[0]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[0]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction[1]</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{instruction[1]}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">instruction[1]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span> å¯ä»¥åŒæ—¶æˆç«‹)</p>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">Or(a= zr, b= ng, out= compNonPositive);
Not(in= compNonPositive, out= compIsPositive);

And(a= instruction[0], b= compIsPositive, out= gtZero);
And(a= instruction[1], b= zr, out= eqZero);
And(a= instruction[2], b= ng , out= ltZero);
Or(a= gtZero, b= eqZero, out= geZero);
Or(a= geZero, b= ltZero, out= rawJump);
And(a= cType, b= rawJump, out= jump);
</code></pre>
<h4 data-id="heading-9">å¯¹ <code>A</code> å¯„å­˜å™¨çš„å¤„ç†</h4>
<p>å½“ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¸­çš„æŸä¸€ä¸ªæˆç«‹æ—¶(è¿™ä¸¤ä¸ªæ¡ä»¶ä¸ä¼šåŒæ—¶æˆç«‹)ï¼Œéœ€è¦å°† <code>A</code> å¯„å­˜å™¨çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">load</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span></span> è®¾ç½®ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord text"><span class="mord">true</span></span></span></span></span></span>ã€‚</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> æ˜¯ <code>A</code> æŒ‡ä»¤</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> æ˜¯ <code>C</code> æŒ‡ä»¤å¹¶ä¸”ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> ä¸­å¯ä»¥åˆ¤æ–­å‡ºéœ€è¦å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <code>A</code> å¯„å­˜å™¨ä¸­</li>
</ul>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// We set "load" in A register to true,
// when either of the following condition is satisfied
// 1. instruction is A type, or
// 2. instruction is C type and we need to send the result to A
Mux16(a= aluOut, b= instruction, sel= aType, out= aRegisterInput);
Or(a= aType, b= toA, out= loadA);
ARegister(in= aRegisterInput, load= loadA, out= aRegisterOut, out[0..14]= addressM);
</code></pre>
<h4 data-id="heading-10">å¯¹ <code>D</code> å¯„å­˜å™¨çš„å¤„ç†</h4>
<p>å½“ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶éƒ½æˆç«‹æ—¶ï¼Œéœ€è¦å°† <code>D</code> å¯„å­˜å™¨çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">load</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span></span> è®¾ç½®ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord text"><span class="mord">true</span></span></span></span></span></span>ã€‚</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> æ˜¯ <code>C</code> æŒ‡ä»¤</li>
<li>ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> ä¸­å¯ä»¥åˆ¤æ–­å‡ºéœ€è¦å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <code>D</code> å¯„å­˜å™¨ä¸­</li>
</ul>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// When both of the following conditions are satisfied, we set "load" in D register to true
// 1. instruction is C type, and
// 2. we need to send the result to D
DRegister(in= aluOut, load= toD, out= dRegisterOut);
</code></pre>
<h4 data-id="heading-11">å¯¹ <code>M</code> çš„å¤„ç†</h4>
<p>å½“ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶éƒ½æˆç«‹æ—¶ï¼Œéœ€è¦å¯¹ <code>M</code> (å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RAM[A]</mtext></mrow><annotation encoding="application/x-tex">\text{RAM[A]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">RAM[A]</span></span></span></span></span></span>) è¿›è¡Œå†™æ“ä½œã€‚</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>instruction</mtext></mrow><annotation encoding="application/x-tex">\text{instruction}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"/><span class="mord text"><span class="mord">instruction</span></span></span></span></span></span> æ˜¯ <code>C</code> æŒ‡ä»¤</li>
<li>ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ddd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">ddd</span></span></span></span></span> ä¸­å¯ä»¥åˆ¤æ–­å‡ºéœ€è¦å°†è®¡ç®—ç»“æœå­˜å‚¨åœ¨ <code>M</code> ä¸­</li>
</ul>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// When both of the following conditions are satisfied, we write M
// 1. instruction is C type, and
// 2. we need to send the result to M
Mux16(a= false, b= aluOut, sel= toM, out= outM);
</code></pre>
<h3 data-id="heading-12">3 å–æŒ‡ä»¤</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a> ä¸€ä¹¦ç¬¬ <code>68</code> é¡µå¯¹ <strong>å–æŒ‡ä»¤</strong> æœ‰å¦‚ä¸‹æè¿° â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2adce2af0ff431386c3d84ce9fb716d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=WkzgE5rqZQknUxQzX2HWf8LzhTc%3D" alt="image.png" loading="lazy"/></p>
<p>åŸºäºä»¥ä¸Šé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºå¯¹åº”çš„ <code>hdl</code> ä»£ç  â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">Or(a= reset, b= jump, out= noInc);
Not(in= noInc, out= toInc);

PC(in= aRegisterOut, load= jump, inc= toInc, reset= reset, out[0..14]= pc);
</code></pre>
<h2 data-id="heading-13">éªŒè¯</h2>
<p>å°†ä¸Šæ–‡æåˆ°çš„å„éƒ¨åˆ† <code>hdl</code> ç»„è£…åœ¨ä¸€èµ·ï¼Œå¯ä»¥å¾—å‡ºå®Œæ•´çš„ç¨‹åº â¬‡ï¸</p>
<pre><code class="hljs language-hdl" lang="hdl">// This file is part of www.nand2tetris.org
// and the book "The Elements of Computing Systems"
// by Nisan and Schocken, MIT Press.
// File name: projects/5/CPU.hdl
/**
 * The Hack Central Processing unit (CPU).
 * Parses the binary code in the instruction input and executes it according to the
 * Hack machine language specification. In the case of a C-instruction, computes the
 * function specified by the instruction. If the instruction specifies to read a memory
 * value, the inM input is expected to contain this value. If the instruction specifies
 * to write a value to the memory, sets the outM output to this value, sets the addressM
 * output to the target address, and asserts the writeM output (when writeM = 0, any
 * value may appear in outM).
 * If the reset input is 0, computes the address of the next instruction and sets the
 * pc output to that value. If the reset input is 1, sets pc to 0.
 * Note: The outM and writeM outputs are combinational: they are affected by the
 * instruction's execution during the current cycle. The addressM and pc outputs are
 * clocked: although they are affected by the instruction's execution, they commit to
 * their new values only in the next cycle.
 */
CHIP CPU {

    IN  inM[16],         // M value input  (M = contents of RAM[A])
        instruction[16], // Instruction for execution
        reset;           // Signals whether to re-start the current
                         // program (reset==1) or continue executing
                         // the current program (reset==0).

    OUT outM[16],        // M value output
        writeM,          // Write to M? 
        addressM[15],    // Address in data memory (of M)
        pc[15];          // address of next instruction

    PARTS:
    // instruction type
    DMux(in= true, sel= instruction[15], a= aType, b= cType);

    // dest
    And(a= cType, b= instruction[3], out= toM, out= writeM);
    And(a= cType, b= instruction[4], out= toD);
    And(a= cType, b= instruction[5], out= toA);

    // We set "load" in A register to true,
    // when either of the following condition is satisfied
    // 1. instruction is A type, or
    // 2. instruction is C type and we need to send the result to A
    Mux16(a= aluOut, b= instruction, sel= aType, out= aRegisterInput);
    Or(a= aType, b= toA, out= loadA);
    ARegister(in= aRegisterInput, load= loadA, out= aRegisterOut, out[0..14]= addressM);

    // When both of the following conditions are satisfied, we set "load" in D register to true
    // 1. instruction is C type, and
    // 2. we need to send the result to D
    DRegister(in= aluOut, load= toD, out= dRegisterOut);

    // When both of the following conditions are satisfied, we write M
    // 1. instruction is C type, and
    // 2. we need to send the result to M
    Mux16(a= false, b= aluOut, sel= toM, out= outM);

    Mux16(a= aRegisterOut, b= inM, sel= instruction[12], out= yOfAlu);
    ALU(x= dRegisterOut, y= yOfAlu, 
        zx= instruction[11], 
        nx= instruction[10],
        zy= instruction[9], 
        ny= instruction[8], 
        f= instruction[7], 
        no= instruction[6], 
        out= aluOut, zr= zr, ng= ng);

    Or(a= zr, b= ng, out= compNonPositive);
    Not(in= compNonPositive, out= compIsPositive);
    
    And(a= instruction[0], b= compIsPositive, out= gtZero);
    And(a= instruction[1], b= zr, out= eqZero);
    And(a= instruction[2], b= ng , out= ltZero);
    Or(a= gtZero, b= eqZero, out= geZero);
    Or(a= geZero, b= ltZero, out= rawJump);
    And(a= cType, b= rawJump, out= jump);

    Or(a= reset, b= jump, out= noInc);
    Not(in= noInc, out= toInc);

    PC(in= aRegisterOut, load= jump, inc= toInc, reset= reset, out[0..14]= pc);
}
</code></pre>
<p>è¿™æ ·çš„ä»£ç å¯ä»¥é€šè¿‡ä»¿çœŸæµ‹è¯•ã€‚åœ¨æµ‹è¯•å‰ï¼Œå¯ä»¥æŠŠé€Ÿåº¦æŒ‰é’®ç§»åŠ¨åˆ°æ¯”è¾ƒæ¥è¿‘ <code>Fast</code> çš„ä½ç½®</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c9e28e31404fb0a18957ad99f95e89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=iOt6tUPfH5bMIDXqJm8mHp0IN6A%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹å‡» <code>Run</code> æŒ‰é’®ï¼Œå°±å¯ä»¥å¼€å§‹æµ‹è¯•äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/579e77244b9b4cd3be73266ec475bce1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=fOBeK7AFc4IOub7rUj2w2qhACW0%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæµ‹è¯•é€šè¿‡ â¬‡ï¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6643cd8725af4a039e37c1bf95c91658~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=ysaTiWOELRAgUkqB7%2BVDJOUBTtg%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-14">å…¶ä»–</h2>
<h3 data-id="heading-15">ç”¨äºå±•ç¤º <code>A</code> æŒ‡ä»¤å’Œ <code>C</code> æŒ‡ä»¤çš„æ¨¡å¼çš„å›¾æ˜¯å¦‚ä½•ç”»å‡ºæ¥çš„ï¼Ÿ</h3>
<p>æˆ‘æ˜¯é€šè¿‡Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.live" target="_blank" title="https://mermaid.live" ref="nofollow noopener noreferrer">mermaid.live</a>Â é¡µé¢æ¥ç»˜åˆ¶çš„ã€‚ä»¥ <code>C</code> æŒ‡ä»¤ä¸ºä¾‹ï¼Œå¯¹åº”çš„ä»£ç å¦‚ä¸‹ â¬‡ï¸</p>
<pre><code class="hljs language-text" lang="text">block
    columns 1
    title["C æŒ‡ä»¤"]
    block
        columns 16
        p15["[15]"] p14["[14]"] p13["[13]"] p12["[12]"] p11["[11]"] p10["[10]"]
        p9["[9]"] p8["[8]"] p7["[7]"] p6["[6]"] p5["[5]"]
        p4["[4]"] p3["[3]"] p2["[2]"] p1["[1]"] p0["[0]"]
        
        b15["1"] b14["x"] b13["x"] b12["a"] b11["c"] b10["c"]
        b9["c"] b8["c"] b7["c"] b6["c"] b5["d"]
        b4["d"] b3["d"] b2["j"] b1["j"] b0["j"]
    end

style title fill:#fff,stroke:#fff;

style p15 fill:#fff,stroke:#fff;
style p14 fill:#fff,stroke:#fff;
style p13 fill:#fff,stroke:#fff;
style p12 fill:#fff,stroke:#fff;
style p11 fill:#fff,stroke:#fff;
style p10 fill:#fff,stroke:#fff;
style p9 fill:#fff,stroke:#fff;
style p8 fill:#fff,stroke:#fff;
style p7 fill:#fff,stroke:#fff;
style p6 fill:#fff,stroke:#fff;
style p5 fill:#fff,stroke:#fff;
style p4 fill:#fff,stroke:#fff;
style p3 fill:#fff,stroke:#fff;
style p2 fill:#fff,stroke:#fff;
style p1 fill:#fff,stroke:#fff;
style p0 fill:#fff,stroke:#fff;

style b15 fill:#0f0;
style b14 fill:#fff;
style b13 fill:#fff;
style b12 fill:#f08;
style b11 fill:#088;
style b10 fill:#088;
style b9 fill:#088;
style b8 fill:#088;
style b7 fill:#088;
style b6 fill:#088;
style b5 fill:#f88;
style b4 fill:#f88;
style b3 fill:#f88;
style b2 fill:#0ff;
style b1 fill:#0ff;
style b0 fill:#0ff;

</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbc253b542134cb59b889c3095a4b12a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeR6YqA6YqF6ZC1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769845758&amp;x-signature=yS2WSLw8JWgjuChWNkqhTc1O5%2B4%3D" alt="image.png" loading="lazy"/></p>
<p>å…·ä½“çš„è¯­æ³•è¯·å‚è€ƒÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.js.org%2Fsyntax%2Fblock.html" target="_blank" title="https://mermaid.js.org/syntax/block.html" ref="nofollow noopener noreferrer">Block Diagrams Documentation</a></p>
<h2 data-id="heading-16">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.douban.com%2Fsubject%2F37354204%2F" target="_blank" title="https://book.douban.com/subject/37354204/" ref="nofollow noopener noreferrer">ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´  (ç¬¬2ç‰ˆ)ã€‹</a>Â </li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnand2tetris.github.io%2Fweb-ide%2Fchip%2F" target="_blank" title="https://nand2tetris.github.io/web-ide/chip/" ref="nofollow noopener noreferrer">Nand to Tetris Online IDE</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.js.org%2Fsyntax%2Fblock.html" target="_blank" title="https://mermaid.js.org/syntax/block.html" ref="nofollow noopener noreferrer">Block Diagrams Documentation</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘å’ŒTRAEçš„è¿™ä¸€å¹´]]></title>    <link>https://juejin.cn/post/7598403436699582498</link>    <guid>https://juejin.cn/post/7598403436699582498</guid>    <pubDate>2026-01-24T02:38:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436699582498" data-draft-id="7598450302615715886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘å’ŒTRAEçš„è¿™ä¸€å¹´"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2026-01-24T02:38:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çº±é›¾13"/> <meta itemprop="url" content="https://juejin.cn/user/3419926705742091"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘å’ŒTRAEçš„è¿™ä¸€å¹´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3419926705742091/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çº±é›¾13
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T02:38:45.000Z" title="Sat Jan 24 2026 02:38:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æˆ‘å’ŒTRAEçš„è¿™ä¸€å¹´</h2>
<p>ä¹Ÿæ˜¯å’ŒTraeèµ°è¿‡ä¸€å¹´äº†ï¼ä¹Ÿä½¿ç”¨äº†Traeåšå‡ºäº†å¤§å¤§å°å°çš„é¡¹ç›®ï¼Œä¹Ÿå­¦ä¼šäº†å¾ˆå¤šæŠ€æœ¯æ ˆï¼Œä¹Ÿä½¿ç”¨Traeå‚åŠ äº†ä¸€äº›æ¯”èµ›éƒ½è·å¾—ä¸é”™çš„ä½³ç»©äº†ï¼Œæ¥çœ‹çœ‹æˆ‘å’ŒTraeçš„2025å§</p>
<p><strong>ç›¸é‡</strong></p>
<p>ç›¸é‡å³åœ¨printf("MarsCode"),æˆ‘è¿˜è®°å¾—é‚£æ˜¯2024å¹´6æœˆä»½,æˆ‘åœ¨æ•™å®¤çœ‹è‰åªå‘å¸ƒä¼š,æˆ‘è¿˜è®°å¾—<strong>æµ·å»º</strong>å’Œ<strong>æ—­ä¸œ</strong>è€å¸ˆåœ¨è‰åªä¸Šæ¼”ç¤ºMarscodeçš„èƒ½åŠ›,é‚£ä¸ªæ—¶å€™å°±æ·±æ·±çš„çˆ±ä¸Šäº†è¿™ä¸ªæ’ä»¶,åœ¨æ—¥å¸¸çš„å­¦ä¹ è¿˜æœ‰ä¸€äº›é¡¹ç›®çš„ç”Ÿæˆéƒ½æ˜¯å¾ˆä¸é”™çš„!é‚£ä¸ªæ—¶å€™åªèƒ½ä½¿ç”¨ChatGPTè±†åŒ…è¿™ç±»çš„ç”Ÿæˆåä»£ç ç„¶åCV,å‡ºé”™å†æ¥ä¸€é,ç°åœ¨ä¸éœ€è¦äº†!çœŸçš„å¾ˆæƒŠè‰³~ç„¶åå°±åˆ°2025å¹´çš„å‡æœŸçš„æ—¶å€™è¿˜æœ‰è¶…å¤šç”±æœæ˜”æœˆè€å¸ˆçš„å…±å­¦è¯¾ç¨‹,åœ¨ç›´æ’­é—´å’Œå¥¹çš„å°åŠ©ç†ä¸€èµ·ä½¿ç”¨Marscodeç”Ÿæˆä¸€äº›ä»£ç ,é‚£ä¸ªæ—¶å€™å°±è®¤å®šäº†,è§‰å¾—è¿™ä¸ªç¤¾åŒºå¾ˆä¸é”™,èƒ½å­¦åˆ°å¥½å¤šå¼€å‘çš„æŠ€æœ¯!ä¹Ÿè·å¾—äº†å¾ˆå¤šå‘¨è¾¹!
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/575637b9768b4e289c330be82ce4b431~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=TPu5S8scp%2FWQGPH7kdqwhyghY5w%3D" alt="img_v3_02tf_594afca5-d3aa-4606-a881-ff2367ee2d0g.jpg" loading="lazy"/></p>
<p><strong>Trae ç¤¾åŒºæ´»åŠ¨çœŸçš„å¥½å¤š!</strong></p>
<p>8æœˆä»½è¿›å…¥åˆ°äº†é£ä¹¦çš„ç¤¾ç¾¤,è¿™é‡Œæ´»åŠ¨æ›´åŠ ä¸°å¯Œäº†,ä¸”ç¤¾ç¾¤æ¯”ä¹‹å‰å¤§äº†å¥½å¤š!æœ‰å¥½å¤šå¤§ä½¬è¿›å…¥åˆ°è¿™ä¸ªç¾¤é‡Œ,åœ¨è¿™é‡ŒçœŸçš„å­¦åˆ°äº†ç‰¹åˆ«å¤š!
ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™,è§‰å¾—æ˜¯æˆ‘å­¦ç”Ÿæ—¶ä»£å†™çš„ä»£ç å’Œå¼€å‘é¡¹ç›®çš„å·…å³°äº†,åœ¨è¿™é‡Œå‚åŠ äº†å„ç§ç§ç±»çš„æ´»åŠ¨
ä¾‹å¦‚å‘è¡¨åˆ°Traeå…¬ä¼—å·çš„å€Ÿç”¨å¤§æ¨¡å‹çš„èƒ½åŠ›å»è¿›è¡Œè§„èŒƒäº‹åŠ¡çš„ä¸€ä¸ªé¡¹ç›®
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3W2wmNS8NpzReUn5ifSsMQ" target="_blank" title="https://mp.weixin.qq.com/s/3W2wmNS8NpzReUn5ifSsMQ" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/3W2wmNS8Nâ€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8409f118b20341248a6b100d624deb98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=rnE2So5Q89o4p5MqcqHzCh6SFyw%3D" alt="img_v3_02tf_4ec1b381-bb29-4387-b0cb-9b6f9a14689g.jpg" loading="lazy"/>
<img src="" alt="" loading="lazy"/></p>
<p>å½“ç„¶è¿˜æœ‰åœ¨1024ç¨‹åºå‘˜èŠ‚çš„æ—¶å€™,æ¼”ç¤ºè¿‡çš„é¡¹ç›®ç­‰ç­‰ç­‰ç­‰è¶…å¤š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70c4d4f4ba384336b74988d6a84ca439~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=MPvIyJ%2BhkFwsIvTLsYSvbCoU6fY%3D" alt="img_v3_02tf_f4ce8d62-bd58-4b9a-8c7c-13962f1ab33g.png" loading="lazy"/></p>
<p>å½“ç„¶å› ä¸ºæˆ‘è¿˜æ˜¯ä¸€ä¸ªå­¦ç”Ÿ,ä½¿ç”¨Traeå‚åŠ äº†ä¸€äº›äº’è”ç½‘å¼€å‘çš„æ¯”èµ›å‡è·å¾—äº†çœé‡Œä¸é”™çš„æˆç»©!</p>
<p><strong>Traeçš„çº¿ä¸‹æ´»åŠ¨!</strong></p>
<p>ä¸å¾—ä¸è¯´,æˆ‘çš„ç¬¬ä¸€æ¬¡çº¿ä¸‹å‚åŠ å…³äºç¼–ç¨‹ç±»çš„æ´»åŠ¨å°±æ˜¯Trae,çœŸçš„å‚åŠ ç¬¬ä¸€æ¬¡,å°±æƒ³å‚åŠ ç¬¬äºŒæ¬¡,å­¦åˆ°äº†å¾ˆå¤šæœ‰å¹²æ–™çš„å¼€å‘æŠ€å·§!</p>
<p>ç¬¬ä¸€æ¬¡å‚åŠ çš„Traeçš„æ´»åŠ¨!(lunaè«æ€ªæˆ‘æ‹çš„ä¸å¥½çœ‹)
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7aa63c6df9724399a9ffac8cf3bc4423~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=qOFQa9WtFCrk7jLLWT2A2qKB8Ko%3D" alt="img_v3_02tf_c9ace577-1c7f-4c3e-a45d-a2189d0b3ceg.png" loading="lazy"/>
ç¬¬ä¸€æ¬¡å‚åŠ Hackathon,å°±è·å¾—äº†ä¸€ç­‰å¥–!ä¸”æˆ‘çš„åŒå­¦ä»¬ä¹Ÿéƒ½è·å–äº†ä½³ç»©!çœŸçš„å¾ˆä¸é”™çš„çº¿ä¸‹ä½“éªŒ!
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c196da2aa6104a93831761340497faf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=sMuNUoHGQTgZoRkbfgZUK9KjLvE%3D" alt="img_v3_02tf_0add46fe-f608-4a5f-a12e-e968fc864b6g.jpg" loading="lazy"/>
<strong>Traeå‘¨è¾¹!</strong></p>
<p>å½“ç„¶è¿™ä¸€å¹´ä¹Ÿè·å¾—äº†è¶…å¤šçš„å‘¨è¾¹!(ä¸å®Œå…¨ç»Ÿè®¡)
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da676d6bb54d4a40978b2d58248bb05e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=BrsX4s7vdvza83M0j6Uh9OyIvJQ%3D" alt="img_v3_02tf_fee564d7-7fa0-4a5c-93ae-06f3b743207g.jpg" loading="lazy"/></p>
<p><strong>ä½¿ç”¨ Trae å¼€æºè‡ªå·±çš„ skill</strong></p>
<p>æœ€ä½³ skill æ¦‚å¿µç‰¹åˆ«å¥½ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ Trae å»åšå‡ºè‡ªå·±çš„ä¸€å¥— skillæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwcn1msagbpwc.feishu.cn%2Fwiki%2FP7VPw22RfinnVHk2FeXcvtFfn7b%3Ffrom%3Dfrom_copylink" target="_blank" title="https://wcn1msagbpwc.feishu.cn/wiki/P7VPw22RfinnVHk2FeXcvtFfn7b?from=from_copylink" ref="nofollow noopener noreferrer">Trae Skills å¼€å‘æŠ€å·§</a>
è‡ªå·±æ£€ç´¢äº†ç°åœ¨æ¯”è¾ƒæµè¡Œçš„ anthropics/skillsã€vercel-labs/agent-skills åŠComposioHQ/awesome-claude-skills è¿™3 ä¸ªåº“çš„ç²¾åï¼Œè‡ªå·±æ•´åˆæ„å»ºå‡ºè¿™ä¸ªskills åº“
çœæµç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p>ä¸€å¥è¯å¼€å‘ï¼Œå°±æœ‰ä¸“é—¨çš„ skill å»è‡ªåŠ¨åˆ†é…ä»»åŠ¡</p>
<pre><code class="hljs">æˆ‘æƒ³å¼€å‘ä¸€ä¸ª ç®€å•çš„ todolist é¡¹ç›®ï¼Œè¯·å¸¦æˆ‘èµ°ä¸€éå…¨æµç¨‹ã€‚
</code></pre>
<p>å°±ä¼šè‡ªåŠ¨çš„å»åˆ’åˆ†ä»»åŠ¡å‡ºæ¥ï¼Œé…åˆ Trae çš„ todolist å®ç°é«˜æ•ˆå¼€å‘
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5aeea57884fa46979bffba972d64688d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57qx6Zu-MTM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769827125&amp;x-signature=9eJkN%2BUuHsVL9ZoqqajJwf0Kom0%3D" alt="img_v3_02u6_21f61828-5395-470a-92d4-a8720f61749g.jpg" loading="lazy"/></p>
<p><strong>æœ€å!</strong></p>
<p>é‚£æœ€åå‘¢,å¸Œæœ›Traeè¶Šæ¥è¶Šå¥½,åœ¨2026å®ç°æ›´å¤šè·¨æ—¶ä»£çš„ä¸€äº›åŠŸèƒ½,æƒŠè‰³çš„åŠŸèƒ½,è®© <strong>The Real AI Engineer</strong> æ›´åŠ ä¼Ÿå¤§!â€Œ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¦–å±åŠ è½½ç»Ÿè®¡çš„å‡ ä¸ªé—®é¢˜æ¢³ç†]]></title>    <link>https://juejin.cn/post/7598447519823724585</link>    <guid>https://juejin.cn/post/7598447519823724585</guid>    <pubDate>2026-01-24T07:11:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598447519823724585" data-draft-id="7597905961664413702" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¦–å±åŠ è½½ç»Ÿè®¡çš„å‡ ä¸ªé—®é¢˜æ¢³ç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Webpack"/> <meta itemprop="datePublished" content="2026-01-24T07:11:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹‰ä¸åŠ¨çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/1429793504759630"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¦–å±åŠ è½½ç»Ÿè®¡çš„å‡ ä¸ªé—®é¢˜æ¢³ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1429793504759630/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹‰ä¸åŠ¨çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:11:01.000Z" title="Sat Jan 24 2026 07:11:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="atelier-forest-light">.hljs-comment,.hljs-quote{color:#766e6b}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#f22c40}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#df5320}.hljs-bullet,.hljs-string,.hljs-symbol{color:#7b9726}.hljs-section,.hljs-title{color:#407ee7}.hljs-keyword,.hljs-selector-tag{color:#6666ea}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#f1efee;color:#68615e}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹é¢ç¦»ä¸å¼€ç™½å±çš„é—®é¢˜ï¼Œä»Šå¤©åªæ˜¯ä¾§é‡å¤ä¹ ä¸‹ç™½å±çš„è®¡ç®—æ–¹å¼ä¸ç³»ç»Ÿæ€§çš„è®°å½•æ–¹å¼ã€‚å…³äºç™½å±çš„æ€§èƒ½ä¼˜åŒ–æ–¹é¢æœ‰å¾ˆå¤šï¼Œå¤§å®¶å¯ä»¥å…ˆçœ‹çœ‹ä¸‹é¢è¿™ä½è€å“¥å†™çš„<a href="https://juejin.cn/post/7188894691356573754?searchId=202601221819101CC951314B91B268988F" target="_blank" title="https://juejin.cn/post/7188894691356573754?searchId=202601221819101CC951314B91B268988F">æ€§èƒ½ä¼˜åŒ–çš„å‡ ç§æ–¹å¼</a></p>
<h2 data-id="heading-1">å…³äºç™½å±</h2>
<p>åŸºæœ¬å®šä¹‰ï¼š<strong>ç™½å±æ—¶é—´ï¼ˆFPï¼‰æ˜¯ç”¨æˆ·ä»å‘èµ·è¯·æ±‚åˆ°æµè§ˆå™¨é¦–æ¬¡æ¸²æŸ“å‡ºåƒç´ ï¼ˆç»“æŸç™½å±ï¼‰çš„è€—æ—¶ã€‚</strong></p>
<p>æ‰€ä»¥æŒ‰ç…§ä¸Šé¢çš„å®šä¹‰ï¼Œç™½å±ä¼šç»å†ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>
<p><strong>DNSè§£æ</strong>ï¼šæµè§ˆå™¨å°†åŸŸåè§£æä¸ºIPåœ°å€ã€‚</p>
</li>
<li>
<p><strong>å»ºç«‹TCPè¿æ¥</strong>ï¼šæµè§ˆå™¨ä¸æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å‘èµ·HTTPè¯·æ±‚</strong>ï¼šæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€HTTPè¯·æ±‚ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡å™¨å“åº”</strong>ï¼šæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”æ•°æ®ã€‚</p>
</li>
<li>
<p><strong>æµè§ˆå™¨è§£æHTML</strong>ï¼šæµè§ˆå™¨è§£æHTMLæ–‡æ¡£å¹¶æ„å»ºDOMæ ‘ã€‚</p>
</li>
<li>
<p><strong>æµè§ˆå™¨æ¸²æŸ“é¡µé¢</strong>ï¼šæµè§ˆå™¨æ ¹æ®DOMæ ‘å’ŒCSSOMæ ‘ç”Ÿæˆæ¸²æŸ“æ ‘ï¼Œå¹¶å¼€å§‹æ¸²æŸ“é¡µé¢ã€‚</p>
</li>
<li>
<p><strong>é¡µé¢å±•ç¤ºhtmlå…ƒç´ </strong>ï¼šæµè§ˆå™¨é¦–æ¬¡å°†é¡µé¢å†…å®¹æ¸²æŸ“åˆ°å±å¹•ä¸Šã€‚</p>
</li>
</ul>
<h2 data-id="heading-2">å…³äºç™½å±çš„åˆç†è®¡ç®—</h2>
<p>ç™½å±çš„è®¡ç®—å§‹äºæµè§ˆå™¨ï¼Œæ‰€ä»¥è®¡ç®—çš„ä¾æ®ä¹Ÿæ˜¯æµè§ˆå™¨æä¾›ï¼Œæµè§ˆå™¨Â <strong>Performance API</strong>Â ä¸­æä¾›äº†è®¡ç®—ä¾æ®ã€‚</p>
<h3 data-id="heading-3">ä¸€ã€Performance API æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>Performance API</strong>Â æ˜¯æµè§ˆå™¨æä¾›çš„ä¸€å¥—åŸç”Ÿæ¥å£ï¼Œä¸“é—¨ç”¨äºç²¾ç¡®æµ‹é‡ã€ç›‘æ§å’Œåˆ†æç½‘é¡µçš„æ€§èƒ½æ•°æ®ï¼ˆæ¯”å¦‚é¡µé¢åŠ è½½æ—¶é—´ã€èµ„æºåŠ è½½è€—æ—¶ã€è‡ªå®šä¹‰ä»£ç æ‰§è¡Œè€—æ—¶ç­‰ï¼‰ï¼Œæ˜¯å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-4">äºŒã€åˆ©ç”¨Performance APIæä¾›çš„æ–¹æ³•ï¼šperformance.timing å¸¸è§„çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</h3>
<p>ä¸‹é¢æ˜¯Â <code>performance.timing</code>Â é‡Œæœ€å¸¸ç”¨çš„æ—¶é—´æˆ³ï¼Œä»¥åŠå®ƒä»¬çš„å«ä¹‰ï¼š</p>

















































<table><thead><tr><th>æ—¶é—´æˆ³å±æ€§</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>navigationStart</code></td><td>é¡µé¢å¼€å§‹å¯¼èˆªçš„æ—¶é—´ï¼ˆæ¯”å¦‚ç”¨æˆ·è¾“å…¥ç½‘å€å›è½¦ã€ç‚¹å‡»é“¾æ¥ï¼‰ï¼Œæ˜¯æ•´ä¸ªæµç¨‹çš„èµ·ç‚¹</td></tr><tr><td><code>domainLookupStart</code></td><td>å¼€å§‹ DNS åŸŸåè§£æçš„æ—¶é—´</td></tr><tr><td><code>domainLookupEnd</code></td><td>DNS åŸŸåè§£æå®Œæˆçš„æ—¶é—´</td></tr><tr><td><code>connectStart</code></td><td>å¼€å§‹å»ºç«‹ TCP è¿æ¥çš„æ—¶é—´</td></tr><tr><td><code>connectEnd</code></td><td>TCP è¿æ¥å»ºç«‹å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚æœæ˜¯ HTTPSï¼ŒåŒ…å« SSL æ¡æ‰‹ï¼‰</td></tr><tr><td><code>requestStart</code></td><td>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶é—´</td></tr><tr><td><code>responseStart</code></td><td>æµè§ˆå™¨æ”¶åˆ°æœåŠ¡å™¨ç¬¬ä¸€ä¸ªå­—èŠ‚å“åº”çš„æ—¶é—´ï¼ˆé¦–å­—èŠ‚æ—¶é—´ï¼ŒTTFBï¼‰</td></tr><tr><td><code>responseEnd</code></td><td>æµè§ˆå™¨æ¥æ”¶å®ŒæœåŠ¡å™¨å“åº”æ•°æ®çš„æ—¶é—´</td></tr><tr><td><code>domContentLoadedEventEnd</code></td><td>DOM è§£æå®Œæˆï¼Œä¸”æ‰€æœ‰ DOMContentLoaded äº‹ä»¶å›è°ƒæ‰§è¡Œå®Œæ¯•çš„æ—¶é—´</td></tr><tr><td><code>loadEventEnd</code></td><td>é¡µé¢ load äº‹ä»¶è§¦å‘ä¸”æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæ¯•çš„æ—¶é—´ï¼ˆé¡µé¢å®Œå…¨åŠ è½½å®Œæˆï¼‰</td></tr></tbody></table>
<h3 data-id="heading-5">ä¸‰ã€ç®€å•ç”¨æ³•ï¼šè®¡ç®—å„é˜¶æ®µè€—æ—¶</h3>
<p>é€šè¿‡è®¡ç®—ä¸åŒæ—¶é—´æˆ³çš„å·®å€¼ï¼Œåˆ©ç”¨æ—¶é—´å·®å¾—å‡ºé¡µé¢åŠ è½½å„é˜¶æ®µçš„è€—æ—¶ï¼Œç®€å•ç”¨æ³•å¦‚ä¸‹ï¼š
ï¼ˆåŸºäº<code>performance.timing</code>ï¼‰ï¼š</p>



































<table><thead><tr><th>æ€§èƒ½æŒ‡æ ‡</th><th>è®¡ç®—æ–¹å¼ï¼ˆç›¸å¯¹è€—æ—¶ï¼‰</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>DNS è§£æè€—æ—¶</td><td>domainLookupEnd - domainLookupStart</td><td>åŸŸåè§£æçš„æ€»è€—æ—¶</td></tr><tr><td>TCP è¿æ¥è€—æ—¶</td><td>connectEnd - connectStart</td><td>å»ºç«‹ TCP æ¡æ‰‹çš„è€—æ—¶</td></tr><tr><td>é¦–å­—èŠ‚è€—æ—¶ (TTFB)</td><td>responseStart - navigationStart</td><td>ä»å¯¼èˆªåˆ°æœåŠ¡å™¨è¿”å›é¦–å­—èŠ‚</td></tr><tr><td>é¡µé¢åŠ è½½å®Œæˆ</td><td>loadEventEnd - navigationStart</td><td>æ•´ä¸ªé¡µé¢åŠ è½½å®Œæˆçš„æ€»è€—æ—¶</td></tr><tr><td>DOM è§£æå®Œæˆ</td><td>domContentLoadedEventEnd - navigationStart</td><td>DOM æ ‘æ„å»ºå®Œæˆçš„è€—æ—¶</td></tr></tbody></table>
<p><strong>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å– timing å¯¹è±¡</span>
<span class="hljs-keyword">const</span> timing = performance.<span class="hljs-property">timing</span>;

<span class="hljs-comment">// 1. DNSè§£æè€—æ—¶</span>
<span class="hljs-keyword">const</span> dnsTime = timing.<span class="hljs-property">domainLookupEnd</span> - timing.<span class="hljs-property">domainLookupStart</span>;
<span class="hljs-comment">// 2. TCPè¿æ¥è€—æ—¶ï¼ˆå«HTTPSæ¡æ‰‹ï¼‰</span>
<span class="hljs-keyword">const</span> tcpTime = timing.<span class="hljs-property">connectEnd</span> - timing.<span class="hljs-property">connectStart</span>;
<span class="hljs-comment">// 3. é¦–å­—èŠ‚æ—¶é—´ï¼ˆTTFBï¼‰ï¼šè¯·æ±‚å‘é€åˆ°æ”¶åˆ°ç¬¬ä¸€ä¸ªå“åº”å­—èŠ‚çš„æ—¶é—´</span>
<span class="hljs-keyword">const</span> ttfb = timing.<span class="hljs-property">responseStart</span> - timing.<span class="hljs-property">requestStart</span>;
<span class="hljs-comment">// 4. ç™½å±æ—¶é—´ï¼šå¯¼èˆªå¼€å§‹åˆ°é¦–å­—èŠ‚è¿”å›çš„æ—¶é—´ï¼ˆæ ¸å¿ƒä½“éªŒæŒ‡æ ‡ï¼‰</span>
<span class="hljs-keyword">const</span> blankScreenTime = timing.<span class="hljs-property">responseStart</span> - timing.<span class="hljs-property">navigationStart</span>;
<span class="hljs-comment">// 5. DOMè§£æå®Œæˆè€—æ—¶</span>
<span class="hljs-keyword">const</span> domParseTime = timing.<span class="hljs-property">domContentLoadedEventEnd</span> - timing.<span class="hljs-property">responseEnd</span>;
<span class="hljs-comment">// 6. é¡µé¢å®Œå…¨åŠ è½½æ€»è€—æ—¶</span>
<span class="hljs-keyword">const</span> totalLoadTime = timing.<span class="hljs-property">loadEventEnd</span> - timing.<span class="hljs-property">navigationStart</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({
  <span class="hljs-variable constant_">DNS</span>è§£æè€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${dnsTime}</span>ms`</span>,
  <span class="hljs-variable constant_">TCP</span>è¿æ¥è€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${tcpTime}</span>ms`</span>,
  é¦–å­—èŠ‚æ—¶é—´(<span class="hljs-variable constant_">TTFB</span>): <span class="hljs-string">`<span class="hljs-subst">${ttfb}</span>ms`</span>,
  ç™½å±æ—¶é—´: <span class="hljs-string">`<span class="hljs-subst">${blankScreenTime}</span>ms`</span>,
  <span class="hljs-variable constant_">DOM</span>è§£æè€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${domParseTime}</span>ms`</span>,
  é¡µé¢æ€»åŠ è½½è€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${totalLoadTime}</span>ms`</span>
});
</code></pre>
<p><strong>å½“ç„¶è¿˜æœ‰æ–°ç‰ˆæœ¬çš„è®¡ç®—æ–¹å¼ï¼šperformance.getEntriesByType('navigation')</strong></p>
<p>æ¯”å¦‚è¿™æ ·ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">navEntry</span> = performance.getEntriesByType(<span class="hljs-string">'navigation'</span>)[<span class="hljs-number">0</span>]<span class="hljs-comment">; </span>
// ç­‰ä»·äº timing çš„æ ¸å¿ƒè®¡ç®—
const <span class="hljs-attr">dnsTime</span> = navEntry.domainLookupEnd - navEntry.domainLookupStart<span class="hljs-comment">; </span>
const <span class="hljs-attr">ttfb</span> = navEntry.responseStart - navEntry.requestStart<span class="hljs-comment">; </span>
const <span class="hljs-attr">totalLoadTime</span> = navEntry.loadEventEnd - navEntry.navigationStart<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-6">navigationStartè§¦å‘æ—¶æœº</h3>
<p><code>navigationStart</code>Â çš„æ—¶é—´æˆ³åœ¨<strong>æµè§ˆå™¨æ¥æ”¶åˆ°å¯¼èˆªæŒ‡ä»¤çš„ç¬é—´</strong>è¢«è®°å½•ï¼Œå…·ä½“åˆ†åœºæ™¯ï¼š</p>
<ol>
<li>æ™®é€šè·³è½¬ï¼ˆç‚¹å‡»é“¾æ¥ã€è¾“å…¥ URL å›è½¦ï¼‰ï¼šæµè§ˆå™¨å¼€å§‹å‘èµ·è¯·æ±‚å‰çš„ç¬é—´ï¼›</li>
<li>é¡µé¢åˆ·æ–°ï¼šæµè§ˆå™¨æ¸…ç©ºå½“å‰é¡µé¢ã€å‡†å¤‡é‡æ–°è¯·æ±‚èµ„æºçš„ç¬é—´ï¼›</li>
<li>å‰è¿› / åé€€ï¼ˆæµè§ˆå™¨ç¼“å­˜ï¼‰ï¼šæµè§ˆå™¨å¼€å§‹ä»ç¼“å­˜åŠ è½½é¡µé¢çš„ç¬é—´ã€‚</li>
</ol>
<h3 data-id="heading-7">å¸¸è§„æœ¬åœ°æµ‹è¯•å¯ä»¥è¿™æ ·ï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js </span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculatePerformance</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å…ˆåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ Performance API</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span> || !<span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">timing</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ Performance.timing API'</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">const</span> timing = performance.<span class="hljs-property">timing</span>;
  <span class="hljs-comment">// æ ¸å¿ƒï¼šå…ˆåˆ¤æ–­ loadEventEnd æ˜¯å¦å·²å®Œæˆï¼ˆå€¼å¤§äº 0ï¼‰</span>
  <span class="hljs-keyword">if</span> (timing.<span class="hljs-property">loadEventEnd</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'é¡µé¢ load äº‹ä»¶è¿˜æœªå®Œæˆï¼Œæš‚æ— æ³•ç»Ÿè®¡å®Œæ•´æ€§èƒ½æ•°æ®'</span>);
    <span class="hljs-comment">// é€€è€Œæ±‚å…¶æ¬¡ï¼Œç»Ÿè®¡å·²å®Œæˆçš„é˜¶æ®µï¼ˆæ¯”å¦‚ DOM è§£æå®Œæˆï¼‰</span>
    <span class="hljs-keyword">const</span> partialTotalTime = timing.<span class="hljs-property">domContentLoadedEventEnd</span> - timing.<span class="hljs-property">navigationStart</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å·²å®Œæˆçš„æ€§èƒ½æ•°æ®ï¼ˆéå®Œæ•´ï¼‰ï¼š'</span>, {
      ç™½å±æ—¶é—´: <span class="hljs-string">`<span class="hljs-subst">${timing.responseStart - timing.navigationStart}</span>ms`</span>,
      <span class="hljs-variable constant_">DOM</span>è§£æå®Œæˆè€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${timing.domContentLoadedEventEnd - timing.responseEnd}</span>ms`</span>,
      æˆªè‡³<span class="hljs-variable constant_">DOM</span>å®Œæˆæ€»è€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${partialTotalTime}</span>ms`</span>
    });
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// è®¡ç®—å„é˜¶æ®µè€—æ—¶ï¼ˆå¢åŠ å¼‚å¸¸å€¼è¿‡æ»¤ï¼‰</span>
  <span class="hljs-keyword">const</span> dnsTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">domainLookupEnd</span> - timing.<span class="hljs-property">domainLookupStart</span>);
  <span class="hljs-keyword">const</span> tcpTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">connectEnd</span> - timing.<span class="hljs-property">connectStart</span>);
  <span class="hljs-keyword">const</span> ttfb = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">responseStart</span> - timing.<span class="hljs-property">requestStart</span>);
  <span class="hljs-keyword">const</span> blankScreenTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">responseStart</span> - timing.<span class="hljs-property">navigationStart</span>);
  <span class="hljs-keyword">const</span> domParseTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">domContentLoadedEventEnd</span> - timing.<span class="hljs-property">responseEnd</span>);
  <span class="hljs-keyword">const</span> totalLoadTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, timing.<span class="hljs-property">loadEventEnd</span> - timing.<span class="hljs-property">navigationStart</span>);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®Œæ•´æ€§èƒ½ç»Ÿè®¡æ•°æ®ï¼š'</span>, {
    <span class="hljs-variable constant_">DNS</span>è§£æè€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${dnsTime}</span>ms<span class="hljs-subst">${dnsTime === <span class="hljs-number">0</span> ? <span class="hljs-string">'ï¼ˆDNSç¼“å­˜å‘½ä¸­ï¼‰'</span> : <span class="hljs-string">''</span>}</span>`</span>,
    <span class="hljs-variable constant_">TCP</span>è¿æ¥è€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${tcpTime}</span>ms`</span>,
    é¦–å­—èŠ‚æ—¶é—´(<span class="hljs-variable constant_">TTFB</span>): <span class="hljs-string">`<span class="hljs-subst">${ttfb}</span>ms`</span>,
    ç™½å±æ—¶é—´: <span class="hljs-string">`<span class="hljs-subst">${blankScreenTime}</span>ms`</span>,
    <span class="hljs-variable constant_">DOM</span>è§£æå®Œæˆè€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${domParseTime}</span>ms`</span>,
    é¡µé¢æ€»åŠ è½½è€—æ—¶: <span class="hljs-string">`<span class="hljs-subst">${totalLoadTime}</span>ms`</span>
  });
}

<span class="hljs-comment">// æ–¹æ¡ˆ1ï¼šä¼˜å…ˆç­‰å¾… load äº‹ä»¶ï¼ˆæœ€å‡†ç¡®ï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'complete'</span>) {
  <span class="hljs-comment">// é¡µé¢å·²ç»åŠ è½½å®Œæˆï¼Œç›´æ¥æ‰§è¡Œ</span>
  <span class="hljs-title function_">calculatePerformance</span>();
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// é¡µé¢è¿˜åœ¨åŠ è½½ï¼Œç›‘å¬ load äº‹ä»¶</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, calculatePerformance);
}

<span class="hljs-comment">// åˆå§‹åŒ– Vue åº”ç”¨ï¼ˆæ”¾åœ¨ç»Ÿè®¡é€»è¾‘ä¹‹åä¸å½±å“ï¼Œå› ä¸ºç»Ÿè®¡å·²å¼‚æ­¥ç­‰å¾… load äº‹ä»¶ï¼‰</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p><strong>è·¯ç”±åˆ‡æ¢æ—¶çš„ç®€å•å¤„ç†</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Vue3 + Vue Router è·¯ç”±åˆ‡æ¢åŸ‹ç‚¹</span>
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();

router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-keyword">const</span> threshold = <span class="hljs-number">2000</span>;
  <span class="hljs-comment">// è·¯ç”±åˆ‡æ¢åï¼Œå»¶è¿Ÿé˜ˆå€¼æ—¶é—´æ£€æµ‹é¦–å±</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> keyNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`#<span class="hljs-subst">${to.name}</span>-container`</span>); <span class="hljs-comment">// è·¯ç”±å¯¹åº”å®¹å™¨</span>
    <span class="hljs-keyword">const</span> isBlank = !keyNode || keyNode.<span class="hljs-property">offsetHeight</span> === <span class="hljs-number">0</span>;
    <span class="hljs-title function_">report</span>({
      isBlank,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'route-change'</span>, <span class="hljs-comment">// æ ‡è®°æ˜¯è·¯ç”±åˆ‡æ¢é¦–å±</span>
      <span class="hljs-attr">from</span>: <span class="hljs-keyword">from</span>.<span class="hljs-property">path</span>,
      <span class="hljs-attr">to</span>: to.<span class="hljs-property">path</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime
    });
  }, threshold);
});
</code></pre>
<h2 data-id="heading-8">ä»ç”¨æˆ·çš„æ„ŸçŸ¥è§’åº¦è¿›è¡Œè®¡ç®—</h2>
<p><code>responseStart - navigationStart</code> æ˜¯<strong>ä¼ ç»Ÿç™½å±æ—¶é—´è®¡ç®—æ–¹å¼</strong>ï¼Œä½†ä»ç”¨æˆ·ä½“éªŒè§’åº¦ï¼Œæ›´ç²¾å‡†çš„ç™½å±ç»“æŸæ ‡å¿—æ˜¯ã€Œé¦–æ¬¡ç»˜åˆ¶ï¼ˆFPï¼‰ã€æˆ–ã€Œé¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼ˆFCPï¼‰ã€ï¼Œè¿™ä¸¤ä¸ªæŒ‡æ ‡å¯ä»¥é€šè¿‡ <code>performance.getEntriesByType('paint')</code> è·å–ï¼Œæ¯”ä»…ç”¨ <code>responseStart</code> æ›´è´´åˆå®é™…è§†è§‰ä½“éªŒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è·å–æ›´ç²¾å‡†çš„ç™½å±æ—¶é—´ï¼ˆFP/FCPï¼‰
function getAccurateBlankScreenTime() {
  // å…¼å®¹å¤„ç†ï¼šå…ˆåˆ¤æ–­æ˜¯å¦æ”¯æŒ Paint Timing API
  if (!window.performance || !window.performance.getEntriesByType) {
    // é™çº§ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼
    const <span class="hljs-attr">timing</span> = performance.timing<span class="hljs-comment">;</span>
    return Math.max(0, timing.responseStart - timing.navigationStart)<span class="hljs-comment">;</span>
  }

  // è·å– Paint ç±»å‹çš„æ€§èƒ½æŒ‡æ ‡
  const <span class="hljs-attr">paintEntries</span> = performance.getEntriesByType(<span class="hljs-string">'paint'</span>)<span class="hljs-comment">;</span>
  let <span class="hljs-attr">fpTime</span> = <span class="hljs-number">0</span><span class="hljs-comment">; // é¦–æ¬¡ç»˜åˆ¶ï¼ˆFirst Paintï¼‰</span>
  let <span class="hljs-attr">fcpTime</span> = <span class="hljs-number">0</span><span class="hljs-comment">; // é¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼ˆFirst Contentful Paintï¼‰</span>

  for (const entry of paintEntries) {
    if (<span class="hljs-attr">entry.name</span> === <span class="hljs-string">'first-paint'</span>) {
      <span class="hljs-attr">fpTime</span> = entry.startTime<span class="hljs-comment">;</span>
    } else if (<span class="hljs-attr">entry.name</span> === <span class="hljs-string">'first-contentful-paint'</span>) {
      <span class="hljs-attr">fcpTime</span> = entry.startTime<span class="hljs-comment">;</span>
    }
  }

  // ä¼˜å…ˆçº§ï¼šFCP &gt; FP &gt; ä¼ ç»Ÿæ–¹å¼
  if (fcpTime) return fcpTime<span class="hljs-comment">;</span>
  if (fpTime) return fpTime<span class="hljs-comment">;</span>
  
  // æœ€ç»ˆé™çº§
  const <span class="hljs-attr">timing</span> = performance.timing<span class="hljs-comment">;</span>
  return Math.max(0, timing.responseStart - timing.navigationStart)<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-9">åŒºåˆ«ï¼š</h3>
<ul>
<li><code>responseStart</code>ï¼šæœåŠ¡å™¨è¿”å›ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´ï¼ˆä»…ä»£è¡¨æ•°æ®å¼€å§‹ä¼ è¾“ï¼Œé¡µé¢æœªå¿…æ¸²æŸ“ï¼‰ï¼›</li>
<li><code>first-paint (FP)</code>ï¼šæµè§ˆå™¨é¦–æ¬¡æ¸²æŸ“åƒç´ ï¼ˆå“ªæ€•æ˜¯èƒŒæ™¯è‰²ï¼Œç»“æŸçº¯é»‘ / çº¯ç™½å±ï¼‰ï¼›</li>
<li><code>first-contentful-paint (FCP)</code>ï¼šæµè§ˆå™¨é¦–æ¬¡æ¸²æŸ“æœ‰æ„ä¹‰çš„å†…å®¹ï¼ˆæ–‡å­—ã€å›¾ç‰‡ã€æŒ‰é’®ç­‰ï¼‰ï¼Œæ›´è´´è¿‘ç”¨æˆ·æ„ŸçŸ¥çš„ã€Œç™½å±ç»“æŸã€ã€‚</li>
</ul>
<h2 data-id="heading-10">å®Œæ•´çš„å¸¸è§„æ€§èƒ½ç»Ÿè®¡å·¥å…·ç¤ºä¾‹</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPagePerformance</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// åŸºç¡€æ ¡éªŒ</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ Performance API'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// 1. åˆå§‹åŒ–åŸºç¡€æ•°æ®</span>
  <span class="hljs-keyword">const</span> timing = performance.<span class="hljs-property">timing</span>;
  <span class="hljs-keyword">const</span> navEntry = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'navigation'</span>)[<span class="hljs-number">0</span>] || {};
  <span class="hljs-keyword">const</span> paintEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'paint'</span>) || [];

  <span class="hljs-comment">// 2. æ ¸å¿ƒæŒ‡æ ‡è®¡ç®—ï¼ˆå…¼å®¹æ–°æ—§APIï¼‰</span>
  <span class="hljs-keyword">const</span> performanceData = {
    <span class="hljs-comment">// åŸºç¡€å¯¼èˆªæ—¶é—´ï¼ˆå…¼å®¹ navEntry å’Œ timingï¼‰</span>
    <span class="hljs-attr">navigationStart</span>: navEntry.<span class="hljs-property">navigationStart</span> || timing.<span class="hljs-property">navigationStart</span> || <span class="hljs-number">0</span>,
    
    <span class="hljs-comment">// DNS è§£æè€—æ—¶</span>
    <span class="hljs-attr">dnsTime</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, 
      (navEntry.<span class="hljs-property">domainLookupEnd</span> || timing.<span class="hljs-property">domainLookupEnd</span>) - 
      (navEntry.<span class="hljs-property">domainLookupStart</span> || timing.<span class="hljs-property">domainLookupStart</span>)
    ),

    <span class="hljs-comment">// TCP è¿æ¥è€—æ—¶ï¼ˆå«HTTPSæ¡æ‰‹ï¼‰</span>
    <span class="hljs-attr">tcpTime</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>,
      (navEntry.<span class="hljs-property">connectEnd</span> || timing.<span class="hljs-property">connectEnd</span>) -
      (navEntry.<span class="hljs-property">connectStart</span> || timing.<span class="hljs-property">connectStart</span>)
    ),

    <span class="hljs-comment">// é¦–å­—èŠ‚æ—¶é—´ TTFB</span>
    <span class="hljs-attr">ttfb</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>,
      (navEntry.<span class="hljs-property">responseStart</span> || timing.<span class="hljs-property">responseStart</span>) -
      (navEntry.<span class="hljs-property">requestStart</span> || timing.<span class="hljs-property">requestStart</span>)
    ),

    <span class="hljs-comment">// ä¼ ç»Ÿç™½å±æ—¶é—´ï¼ˆå…¼å®¹ï¼‰</span>
    <span class="hljs-attr">blankScreenTime_legacy</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>,
      (navEntry.<span class="hljs-property">responseStart</span> || timing.<span class="hljs-property">responseStart</span>) -
      (navEntry.<span class="hljs-property">navigationStart</span> || timing.<span class="hljs-property">navigationStart</span>)
    ),

    <span class="hljs-comment">// ç²¾å‡†ç™½å±æ—¶é—´ï¼ˆFP/FCPï¼‰</span>
    <span class="hljs-attr">firstPaint</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¦–æ¬¡ç»˜åˆ¶</span>
    <span class="hljs-attr">firstContentfulPaint</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¦–æ¬¡å†…å®¹ç»˜åˆ¶</span>

    <span class="hljs-comment">// DOM è§£æè€—æ—¶</span>
    <span class="hljs-attr">domParseTime</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>,
      timing.<span class="hljs-property">domContentLoadedEventEnd</span> - timing.<span class="hljs-property">responseEnd</span>
    ),

    <span class="hljs-comment">// é¡µé¢æ€»åŠ è½½è€—æ—¶</span>
    <span class="hljs-attr">totalLoadTime</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>,
      (navEntry.<span class="hljs-property">loadEventEnd</span> || timing.<span class="hljs-property">loadEventEnd</span>) -
      (navEntry.<span class="hljs-property">navigationStart</span> || timing.<span class="hljs-property">navigationStart</span>)
    )
  };

  <span class="hljs-comment">// 3. è¡¥å…… FP/FCP æ•°æ®</span>
  paintEntries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-paint'</span>) {
      performanceData.<span class="hljs-property">firstPaint</span> = entry.<span class="hljs-property">startTime</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-contentful-paint'</span>) {
      performanceData.<span class="hljs-property">firstContentfulPaint</span> = entry.<span class="hljs-property">startTime</span>;
    }
  });

  <span class="hljs-comment">// 4. æœ€ç»ˆæ¨èçš„ç™½å±æ—¶é—´ï¼ˆä¼˜å…ˆçº§ï¼šFCP &gt; FP &gt; ä¼ ç»Ÿæ–¹å¼ï¼‰ï¼Œé€‚é…æ€§é€‰æ‹©</span>
  performanceData.<span class="hljs-property">blankScreenTime</span> = performanceData.<span class="hljs-property">firstContentfulPaint</span> || 
                                    performanceData.<span class="hljs-property">firstPaint</span> || 
                                    performanceData.<span class="hljs-property">blankScreenTime_legacy</span>;

  <span class="hljs-comment">// 5. è¡¥å……å‹å¥½çš„æ ¼å¼åŒ–æ•°æ®</span>
  performanceData.<span class="hljs-property">formatted</span> = {
    <span class="hljs-attr">dnsTime</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.dnsTime}</span>ms<span class="hljs-subst">${performanceData.dnsTime === <span class="hljs-number">0</span> ? <span class="hljs-string">'ï¼ˆDNSç¼“å­˜å‘½ä¸­ï¼‰'</span> : <span class="hljs-string">''</span>}</span>`</span>,
    <span class="hljs-attr">tcpTime</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.tcpTime}</span>ms`</span>,
    <span class="hljs-attr">ttfb</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.ttfb}</span>ms`</span>,
    <span class="hljs-attr">blankScreenTime</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.blankScreenTime.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>, <span class="hljs-comment">// ä¿ç•™ä¸¤ä½å°æ•°</span>
    <span class="hljs-attr">domParseTime</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.domParseTime}</span>ms`</span>,
    <span class="hljs-attr">totalLoadTime</span>: <span class="hljs-string">`<span class="hljs-subst">${performanceData.totalLoadTime}</span>ms`</span>
  };

  <span class="hljs-keyword">return</span> performanceData;
}

<span class="hljs-comment">//  åˆå§‹åŒ–æ€§èƒ½ç»Ÿè®¡ï¼ˆç¡®ä¿åœ¨é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initPerformanceMonitor</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç›‘å¬é¡µé¢åŠ è½½å®Œæˆäº‹ä»¶</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleLoad</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> perfData = <span class="hljs-title function_">getPagePerformance</span>();
    <span class="hljs-keyword">if</span> (perfData) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¡µé¢æ€§èƒ½ç»Ÿè®¡æ•°æ®ï¼š'</span>, perfData.<span class="hljs-property">formatted</span>);
      <span class="hljs-comment">// å¯é€‰ï¼šä¸ŠæŠ¥æ€§èƒ½æ•°æ®åˆ°åç«¯/ç›‘æ§å¹³å°</span>
      <span class="hljs-comment">// reportPerformanceToServer(perfData);</span>
    }
  }

  <span class="hljs-comment">// é¡µé¢å·²åŠ è½½å®Œæˆåˆ™ç›´æ¥æ‰§è¡Œï¼Œå¦åˆ™ç›‘å¬ load äº‹ä»¶</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'complete'</span>) {
    <span class="hljs-built_in">setTimeout</span>(handleLoad, <span class="hljs-number">0</span>); <span class="hljs-comment">// å¾®ä»»åŠ¡å»¶è¿Ÿï¼Œç¡®ä¿æ‰€æœ‰èµ„æºåŠ è½½å®Œæ¯•</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, handleLoad);
    <span class="hljs-comment">// å…œåº•ï¼šå¦‚æœ load äº‹ä»¶è¿Ÿè¿Ÿä¸è§¦å‘ï¼Œ5ç§’åå¼ºåˆ¶ç»Ÿè®¡</span>
    <span class="hljs-built_in">setTimeout</span>(handleLoad, <span class="hljs-number">5000</span>);
  }
}

<span class="hljs-comment">// ========== ä¸šåŠ¡é›†æˆç¤ºä¾‹ï¼ˆVue/React é€šç”¨ï¼‰ ==========</span>
<span class="hljs-comment">// Vue é¡¹ç›®ï¼šåœ¨ main.js ä¸­è°ƒç”¨</span>
<span class="hljs-comment">// import { createApp } from 'vue'</span>
<span class="hljs-comment">// import App from './App.vue'</span>

<span class="hljs-comment">// // å…ˆåˆå§‹åŒ–æ€§èƒ½ç›‘æ§</span>
<span class="hljs-comment">// initPerformanceMonitor();</span>

<span class="hljs-comment">// // å†æŒ‚è½½åº”ç”¨</span>
<span class="hljs-comment">// createApp(App).mount('#app');</span>

<span class="hljs-comment">// React é¡¹ç›®ï¼šåœ¨ index.js ä¸­è°ƒç”¨</span>
<span class="hljs-comment">// import React from 'react';</span>
<span class="hljs-comment">// import ReactDOM from 'react-dom/client';</span>
<span class="hljs-comment">// import App from './App';</span>

<span class="hljs-comment">// // å…ˆåˆå§‹åŒ–æ€§èƒ½ç›‘æ§</span>
<span class="hljs-comment">// initPerformanceMonitor();</span>

<span class="hljs-comment">// // å†æ¸²æŸ“åº”ç”¨</span>
<span class="hljs-comment">// const root = ReactDOM.createRoot(document.getElementById('root'));</span>
<span class="hljs-comment">// root.render(&lt;App /&gt;);</span>
</code></pre>
<h2 data-id="heading-11">æ³¨æ„</h2>
<ol>
<li>
<p><strong>è·¨åŸŸèµ„æºçš„æ€§èƒ½æ•°æ®</strong>ï¼šå¦‚æœé¡µé¢åŠ è½½äº†è·¨åŸŸçš„ JS/CSS/ å›¾ç‰‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ <code>performance</code> æ— æ³•è·å–è¿™äº›èµ„æºçš„è¯¦ç»†è€—æ—¶ï¼Œéœ€è¦åœ¨æœåŠ¡ç«¯é…ç½® <code>Timing-Allow-Origin</code> å“åº”å¤´ã€‚</p>
</li>
<li>
<p><strong>SPA åº”ç”¨çš„é€‚é…</strong>ï¼šå•é¡µåº”ç”¨çš„è·¯ç”±è·³è½¬ä¸ä¼šè§¦å‘ <code>navigationStart</code>ï¼Œéœ€è¦æ‰‹åŠ¨æ ‡è®°è·¯ç”±åˆ‡æ¢çš„å¼€å§‹æ—¶é—´ï¼Œç»“åˆ <code>performance.mark()</code> è‡ªå®šä¹‰ç»Ÿè®¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// SPA è·¯ç”±åˆ‡æ¢æ—¶æ ‡è®°å¼€å§‹æ—¶é—´</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">markRouteStart</span>(<span class="hljs-params">routeName</span>) {
  performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">`route_<span class="hljs-subst">${routeName}</span>_start`</span>);
}

<span class="hljs-comment">// è·¯ç”±æ¸²æŸ“å®Œæˆåè®¡ç®—è€—æ—¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateRouteTime</span>(<span class="hljs-params">routeName</span>) {
  performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">`route_<span class="hljs-subst">${routeName}</span>_end`</span>);
  <span class="hljs-keyword">const</span> measure = performance.<span class="hljs-title function_">measure</span>(<span class="hljs-string">`route_<span class="hljs-subst">${routeName}</span>_duration`</span>, 
    <span class="hljs-string">`route_<span class="hljs-subst">${routeName}</span>_start`</span>, 
    <span class="hljs-string">`route_<span class="hljs-subst">${routeName}</span>_end`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${routeName}</span> è·¯ç”±æ¸²æŸ“è€—æ—¶ï¼š`</span>, measure.<span class="hljs-property">duration</span>);
}
</code></pre>
</li>
</ol>
<h2 data-id="heading-12">å…³äºDOM æ ‘æ„å»ºå®Œæˆçš„è€—æ—¶é—®é¢˜ï¼š</h2>
<p>DOM æ£€æµ‹å¯èƒ½å­˜åœ¨ <strong>â€œDOM å­˜åœ¨ä½†æ ·å¼å¼‚å¸¸å¯¼è‡´ä¸å¯è§â€</strong> çš„è¯¯åˆ¤ï¼ˆå¦‚ <code>z-index: -1</code>ã€èƒŒæ™¯è‰²ä¸å†…å®¹è‰²ä¸€è‡´ï¼‰ï¼Œå¤§å‚ä¼šåœ¨æ ¸å¿ƒé¡µé¢å¢åŠ  <strong>Canvas è§†è§‰æ£€æµ‹</strong> ä½œä¸ºå…œåº•ï¼š</p>
<ol>
<li>
<p>åœ¨é˜ˆå€¼æ—¶é—´åï¼Œç”¨ <code>html2canvas</code> å¯¹é¦–å±åŒºåŸŸæˆªå›¾ã€‚</p>
</li>
<li>
<p>è®¡ç®—æˆªå›¾çš„ <strong>åƒç´ ç°åº¦æ–¹å·®</strong>ï¼š</p>
<ul>
<li>ç™½å±æ—¶ï¼Œåƒç´ å€¼è¶‹äºä¸€è‡´ï¼Œæ–¹å·®è¶‹è¿‘äº 0ï¼›</li>
<li>éç™½å±æ—¶ï¼Œåƒç´ å€¼å·®å¼‚å¤§ï¼Œæ–¹å·®é«˜äºé˜ˆå€¼ï¼ˆå¦‚ 50ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>åŒé‡éªŒè¯</strong>ï¼šåªæœ‰ DOM æ£€æµ‹å’Œè§†è§‰æ£€æµ‹å‡åˆ¤å®šä¸º â€œç™½å±â€ï¼Œæ‰è®¡å…¥ç™½å±æ¬¡æ•°ã€‚</p>
</li>
</ol>
<h3 data-id="heading-13">æ€»ç»“</h3>
<ol>
<li><strong>ç™½å±æ—¶é—´è®¡ç®—</strong>ï¼šä¼˜å…ˆä½¿ç”¨ <code>first-contentful-paint (FCP)</code>ï¼Œé™çº§ä½¿ç”¨ <code>first-paint (FP)</code>ï¼Œæœ€ç»ˆå…œåº•ç”¨ <code>responseStart - navigationStart</code>ï¼Œæ›´è´´åˆç”¨æˆ·å®é™…æ„ŸçŸ¥ï¼›</li>
<li><strong>æ€§èƒ½ç»Ÿè®¡æ—¶æœº</strong>ï¼šå¿…é¡»åœ¨ <code>load</code> äº‹ä»¶è§¦å‘åæ‰§è¡Œï¼Œæˆ–åˆ¤æ–­ <code>document.readyState === 'complete'</code>ï¼Œå¦åˆ™æ•°æ®ä¸å®Œæ•´ï¼›</li>
<li><strong>å…¼å®¹æ€§å¤„ç†</strong>ï¼šå…¼é¡¾æ–°æ—§ Performance APIï¼ˆ<code>timing</code> å’Œ <code>getEntriesByType</code>ï¼‰ï¼Œå¹¶å¯¹å¼‚å¸¸å€¼åš <code>Math.max(0, ...)</code> è¿‡æ»¤ï¼Œé¿å…è´Ÿæ•°ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C#ä¸­åŸºäºWord COMç»„ä»¶çš„æ•°å­¦å…¬å¼æ’ç‰ˆå®è·µ]]></title>    <link>https://juejin.cn/post/7598459769238667298</link>    <guid>https://juejin.cn/post/7598459769238667298</guid>    <pubDate>2026-01-24T07:05:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598459769238667298" data-draft-id="7598465042968100904" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C#ä¸­åŸºäºWord COMç»„ä»¶çš„æ•°å­¦å…¬å¼æ’ç‰ˆå®è·µ"/> <meta itemprop="keywords" content="åç«¯,C#,.NET"/> <meta itemprop="datePublished" content="2026-01-24T07:05:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mudtools"/> <meta itemprop="url" content="https://juejin.cn/user/2112621078650964"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C#ä¸­åŸºäºWord COMç»„ä»¶çš„æ•°å­¦å…¬å¼æ’ç‰ˆå®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2112621078650964/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mudtools
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T07:05:54.000Z" title="Sat Jan 24 2026 07:05:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<h3 data-id="heading-1">èƒŒæ™¯ä¸éœ€æ±‚</h3>
<p>åœ¨ç§‘æŠ€æ–‡æ¡£å¼€å‘ã€å­¦æœ¯è®ºæ–‡æ’°å†™å’Œå·¥ç¨‹è®¡ç®—æ–‡æ¡£ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæ•°å­¦å…¬å¼çš„è‡ªåŠ¨åŒ–æ’ç‰ˆä¸€ç›´æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„æŠ€æœ¯éš¾é¢˜ã€‚ä¼ ç»Ÿçš„æ‰‹å·¥æ’ç‰ˆæ–¹å¼ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”éš¾ä»¥ä¿è¯æ ¼å¼çš„ä¸€è‡´æ€§å’Œä¸“ä¸šæ€§ã€‚Word COMç»„ä»¶ä½œä¸ºMicrosoft Officeçš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„å…¬å¼å¤„ç†èƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°å­¦å…¬å¼çš„ç»“æ„åŒ–æ’ç‰ˆæ–¹é¢å…·æœ‰ç‹¬ç‰¹ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-2">å¼€å‘ç¯å¢ƒä¸å·¥å…·</h3>
<p>æœ¬æ–‡åŸºäº <strong>MudTools.OfficeInterop.Word</strong> é¡¹ç›®ï¼Œè¯¥é¡¹ç›®æä¾›äº†å®Œæ•´çš„Word COMç»„ä»¶.NETå°è£…ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨C#è¯­è¨€é«˜æ•ˆåœ°æ“ä½œWordæ–‡æ¡£ä¸­çš„æ•°å­¦å…¬å¼ã€‚æ ¸å¿ƒå¼€å‘ç¯å¢ƒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>C# (.NET Framework/.NET Core)</strong> - ä¸»è¦ç¼–ç¨‹è¯­è¨€</li>
<li><strong>Microsoft Office Interop Library</strong> - åº•å±‚COMäº¤äº’æ”¯æŒ</li>
<li><strong>MudTools.OfficeInterop.Word</strong> - å°è£…çš„Wordå¯¹è±¡æ¨¡å‹ (æºç ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fmudtools%2FOfficeInterop" target="_blank" title="https://gitee.com/mudtools/OfficeInterop" ref="nofollow noopener noreferrer">Gitee</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmudtools%2FOfficeInterop" target="_blank" title="https://github.com/mudtools/OfficeInterop" ref="nofollow noopener noreferrer">Github</a>)</li>
<li><strong>Wordå¯¹è±¡æ¨¡å‹</strong> - æä¾›å±‚æ¬¡åŒ–çš„æ–‡æ¡£å’Œå…¬å¼æ“ä½œæ¥å£</li>
</ul>
<h2 data-id="heading-3">Word COMå¯¹è±¡æ¨¡å‹ä¸­çš„å…¬å¼ç›¸å…³å¯¹è±¡</h2>
<h3 data-id="heading-4">æ ¸å¿ƒå¯¹è±¡å±‚æ¬¡ç»“æ„</h3>
<p>Word COMå¯¹è±¡æ¨¡å‹é‡‡ç”¨å±‚æ¬¡åŒ–è®¾è®¡ï¼Œæ•°å­¦å…¬å¼ç›¸å…³çš„å¯¹è±¡æ„æˆäº†å®Œæ•´çš„æ“ä½œä½“ç³»ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">IWordApplication application = <span class="hljs-keyword">new</span> WordApplication();        <span class="hljs-comment">// Wordåº”ç”¨ç¨‹åºå®ä¾‹</span>
IWordDocument document = application.Documents.Add();         <span class="hljs-comment">// æ–‡æ¡£å¯¹è±¡</span>
IWordRange range = document.Content;                         <span class="hljs-comment">// æ–‡æœ¬æ“ä½œèŒƒå›´</span>
IWordOMaths oMaths = range.OMaths;                           <span class="hljs-comment">// æ•°å­¦å…¬å¼é›†åˆ</span>
IWordOMath oMath = oMaths.Add(range);                        <span class="hljs-comment">// å•ä¸ªæ•°å­¦å…¬å¼</span>
</code></pre>
<p>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰æ˜ç¡®çš„èŒè´£åˆ†å·¥ï¼š</p>
<ul>
<li><strong>IWordApplication</strong>ï¼šWordåº”ç”¨ç¨‹åºçš„é¡¶çº§æ§åˆ¶æ¥å£ï¼Œç®¡ç†æ–‡æ¡£ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>IWordDocument</strong>ï¼šæ–‡æ¡£å¯¹è±¡ï¼Œé€šè¿‡<code>IWordDocuments</code>é›†åˆç®¡ç†å¤šä¸ªæ–‡æ¡£</li>
<li><strong>IWordRange</strong> å’Œ <strong>IWordSelection</strong>ï¼šæä¾›æ–‡æœ¬èŒƒå›´çš„ç²¾ç¡®å®šä½å’Œæ“ä½œèƒ½åŠ›</li>
<li><strong>IWordOMath</strong>ã€<strong>IWordOMathPara</strong>ã€<strong>IWordOMathRange</strong>ï¼šä¸“é—¨ç”¨äºæ•°å­¦å…¬å¼æ“ä½œçš„å¯¹è±¡æ¨¡å‹</li>
</ul>
<h4 data-id="heading-5">Word COMå¯¹è±¡å±‚æ¬¡ç»“æ„å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[IWordApplication] --&gt; B[IWordDocuments]
    B --&gt; C[IWordDocument]
    C --&gt; D[IWordRange]
    C --&gt; E[IWordSelection]
    C --&gt; F[IWordContent]
    D --&gt; G[IWordOMaths]
    E --&gt; G
    F --&gt; G
    G --&gt; H[IWordOMath]
    H --&gt; I[IWordOMathFunctions]
    I --&gt; J[IWordOMathFunction]
    J --&gt; K[IWordOMathFrac]
    J --&gt; L[IWordOMathMat]
    J --&gt; M[IWordOMathNary]
    J --&gt; N[IWordOMathRad]
    J --&gt; O[IWordOMathScrSubSup]
    J --&gt; P[...å…¶ä»–22ç§å‡½æ•°ç±»å‹]
    
    style A fill:#e1f5fe
    style C fill:#f3e5f5
    style G fill:#e8f5e8
    style H fill:#fff3e0
</code></pre>
<h4 data-id="heading-6">æ ¸å¿ƒç»„ä»¶å…³ç³»è¯¦è§£</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class IWordApplication {
        +Documents: IWordDocuments
        +Quit()
        +Visible: bool
    }
    
    class IWordDocuments {
        +Add(): IWordDocument
        +Open(string): IWordDocument
        +Count: int
    }
    
    class IWordDocument {
        +Content: IWordRange
        +OMaths: IWordOMaths
        +SaveAs(string)
        +Close()
    }
    
    class IWordRange {
        +Text: string
        +OMaths: IWordOMaths
        +Font: IWordFont
        +ParagraphFormat: IWordParagraphFormat
    }
    
    class IWordOMaths {
        +Add(IWordRange): IWordRange
        +Count: int
        +Item(int): IWordOMath
        +BuildUp()
        +Linearize()
    }
    
    class IWordOMath {
        +Range: IWordRange
        +Functions: IWordOMathFunctions
        +Type: WdOMathType
        +Justification: WdOMathJc
        +BuildUp()
        +Remove()
    }
    
    class IWordOMathFunctions {
        +Add(IWordRange, WdOMathFunctionType): IWordOMathFunction
        +Count: int
        +Item(int): IWordOMathFunction
    }
    
    class IWordOMathFunction {
        +Frac: IWordOMathFrac
        +Mat: IWordOMathMat
        +Nary: IWordOMathNary
        +Rad: IWordOMathRad
        +ScrSubSup: IWordOMathScrSubSup
    }
    
    IWordApplication --&gt; IWordDocuments
    IWordDocuments --&gt; IWordDocument
    IWordDocument --&gt; IWordRange
    IWordDocument --&gt; IWordOMaths
    IWordRange --&gt; IWordOMaths
    IWordOMaths --&gt; IWordOMath
    IWordOMath --&gt; IWordOMathFunctions
    IWordOMathFunctions --&gt; IWordOMathFunction
</code></pre>
<h3 data-id="heading-7">æ•°å­¦å…¬å¼ç›¸å…³æ¥å£</h3>
<p>MudTools.OfficeInterop.Wordé¡¹ç›®æä¾›äº†å®Œæ•´çš„æ•°å­¦å…¬å¼æ¥å£ä½“ç³»ï¼š</p>






























<table><thead><tr><th>æ¥å£</th><th>åŠŸèƒ½æè¿°</th><th>æ ¸å¿ƒç‰¹æ€§</th></tr></thead><tbody><tr><td><strong>IWordOMath</strong></td><td>æ•°å­¦å¯¹è±¡çš„æ ¸å¿ƒæ¥å£</td><td>å…¬å¼æ„å»ºã€æ ¼å¼è½¬æ¢ã€å¯¹é½æ§åˆ¶</td></tr><tr><td><strong>IWordOMathFunction</strong></td><td>æ•°å­¦å‡½æ•°æ¥å£</td><td>åŒ…å«22ç§æ•°å­¦å‡½æ•°ç±»å‹çš„ç»Ÿä¸€è®¿é—®</td></tr><tr><td><strong>IWordOMathMatrix</strong></td><td>çŸ©é˜µæ’ç‰ˆæ”¯æŒ</td><td>å•å…ƒæ ¼æ“ä½œã€è¡Œåˆ—é—´è·ã€å¯¹é½æ–¹å¼</td></tr><tr><td><strong>IWordOMathSupSub</strong></td><td>ä¸Šä¸‹æ ‡æ§åˆ¶</td><td>ä¸Šæ ‡ã€ä¸‹æ ‡ã€ä¸Šä¸‹æ ‡ç»„åˆ</td></tr></tbody></table>
<p>è¿™äº›æ¥å£æ„æˆäº†å®Œæ•´çš„æ•°å­¦å…¬å¼æ“ä½œä½“ç³»ï¼Œæ”¯æŒä»ç®€å•çš„åˆ†æ•°è¿ç®—åˆ°å¤æ‚çš„çŸ©é˜µå˜æ¢ã€‚</p>
<h4 data-id="heading-8">æ•°å­¦å…¬å¼å‡½æ•°ç±»å‹å…³ç³»å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[IWordOMathFunction] --&gt; B[åŸºç¡€æ•°å­¦ç»“æ„]
    A --&gt; C[è„šæœ¬ç³»ç»Ÿ]
    A --&gt; D[ä¿®é¥°ç¬¦å·]
    A --&gt; E[ç‰¹æ®ŠåŠŸèƒ½]
    
    B --&gt; B1[IWordOMathFrac - åˆ†æ•°]
    B --&gt; B2[IWordOMathRad - æ ¹å¼]
    B --&gt; B3[IWordOMat - çŸ©é˜µ]
    B --&gt; B4[IWordOMathDelim - åˆ†éš”ç¬¦]
    
    C --&gt; C1[IWordOMathScrSub - ä¸‹æ ‡]
    C --&gt; C2[IWordOMathScrSup - ä¸Šæ ‡]
    C --&gt; C3[IWordOMathScrSubSup - ä¸Šä¸‹æ ‡]
    C --&gt; C4[IWordOMathScrPre - å‰ç½®è„šæœ¬]
    
    D --&gt; D1[IWordOMathAcc - é‡éŸ³ç¬¦å·]
    D --&gt; D2[IWordOMathBar - ä¸Š/ä¸‹åˆ’çº¿]
    D --&gt; D3[IWordOMathGroupChar - åˆ†ç»„å­—ç¬¦]
    
    E --&gt; E1[IWordOMathNary - nå…ƒè¿ç®—ç¬¦]
    E --&gt; E2[IWordOMathLimLow/LimUpp - æé™]
    E --&gt; E3[IWordOMathPhantom - å¹»å½±å¯¹è±¡]
    E --&gt; E4[IWordOMathEqArray - ç­‰å¼æ•°ç»„]
    
    style A fill:#ffecb3
    style B fill:#c8e6c9
    style C fill:#bbdefb
    style D fill:#f8bbd0
    style E fill:#d1c4e9
</code></pre>
<h4 data-id="heading-9">çŸ©é˜µå¯¹è±¡è¯¦ç»†ç»“æ„å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class IWordOMathMat {
        +Rows: IWordOMathMatRows
        +Cols: IWordOMathMatCols
        +Cell(int, int): IWordOMath
        +Align: WdOMathVertAlignType
        +RowSpacing: int
        +ColSpacing: int
    }
    
    class IWordOMathMatRows {
        +Add(): IWordOMathMatRow
        +Count: int
        +Item(int): IWordOMathMatRow
    }
    
    class IWordOMathMatCols {
        +Add(): IWordOMathMatCol
        +Count: int
        +Item(int): IWordOMathMatCol
    }
    
    class IWordOMathMatRow {
        +Cells: IWordOMathMatCells
        +Height: int
    }
    
    class IWordOMathMatCol {
        +Cells: IWordOMathMatCells
        +Width: int
    }
    
    IWordOMathMat --&gt; IWordOMathMatRows
    IWordOMathMat --&gt; IWordOMathMatCols
    IWordOMathMatRows --&gt; IWordOMathMatRow
    IWordOMathMatCols --&gt; IWordOMathMatCol
    IWordOMathMat --&gt; IWordOMath : "Cell(row, col)"
</code></pre>
<h2 data-id="heading-10">åŸºç¡€æ•°å­¦å…¬å¼æ’ç‰ˆåŠŸèƒ½å®ç°</h2>
<h3 data-id="heading-11">å…¬å¼æ’å…¥ä¸åŸºç¡€æ“ä½œ</h3>
<p>é€šè¿‡MudTools.OfficeInterop.Wordï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åˆ›å»ºå’Œæ’å…¥æ•°å­¦å…¬å¼ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºWordåº”ç”¨ç¨‹åºå’Œæ–‡æ¡£</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> application = <span class="hljs-keyword">new</span> WordApplication();
IWordDocument document = application.Documents.Add();
IWordRange range = document.Content;

<span class="hljs-comment">// æ’å…¥æ•°å­¦å…¬å¼</span>
IWordOMaths oMaths = range.OMaths;
IWordRange formulaRange = oMaths.Add(range);

<span class="hljs-comment">// è®¾ç½®å…¬å¼å†…å®¹</span>
IWordOMath oMath = formulaRange.OMaths[<span class="hljs-number">0</span>];
oMath.Range.Text = <span class="hljs-string">"x^2 + y^2 = z^2"</span>;

<span class="hljs-comment">// æ„å»ºä¸“ä¸šæ ¼å¼æ˜¾ç¤º</span>
oMath.BuildUp();
</code></pre>
<p><strong>æ ¸å¿ƒæ“ä½œæ–¹æ³•è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>oMaths.Add(range)</code> - åœ¨æŒ‡å®šèŒƒå›´æ·»åŠ æ–°çš„æ•°å­¦å…¬å¼</li>
<li><code>oMath.BuildUp()</code> - å°†çº¿æ€§æ ¼å¼è½¬æ¢ä¸ºä¸“ä¸šæ˜¾ç¤ºæ ¼å¼</li>
<li><code>oMath.Linearize()</code> - å°†ä¸“ä¸šæ ¼å¼è½¬æ¢ä¸ºçº¿æ€§æ ¼å¼</li>
<li><code>oMath.Type = WdOMathType.wdOMathDisplay</code> - è®¾ç½®ä¸ºç‹¬ç«‹è¡Œæ˜¾ç¤º</li>
</ul>
<h3 data-id="heading-12">å¸¸è§å…¬å¼å…ƒç´ æ“ä½œ</h3>
<h4 data-id="heading-13">åˆ†æ•°æ“ä½œï¼ˆIWordOMathFracï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºåˆ†æ•°</span>
<span class="hljs-keyword">var</span> fractionFunction = oMath.Functions.Add(range, WdOMathFunctionType.wdOMathFunctionFrac);
<span class="hljs-keyword">var</span> fraction = fractionFunction.Frac;

<span class="hljs-comment">// è®¾ç½®åˆ†å­å’Œåˆ†æ¯</span>
fraction.Num.Range.Text = <span class="hljs-string">"a^2 + b^2"</span>;
fraction.Den.Range.Text = <span class="hljs-string">"c^2"</span>;

<span class="hljs-comment">// è®¾ç½®åˆ†æ•°ç±»å‹</span>
fraction.Type = WdOMathFracType.wdOMathFracBar;  <span class="hljs-comment">// å¸¸è§„åˆ†æ•°çº¿</span>
<span class="hljs-comment">// fraction.Type = WdOMathFracType.wdOMathFracSkw;  // æ–œåˆ†æ•°çº¿</span>
</code></pre>
<h4 data-id="heading-14">ç§¯åˆ†ä¸æ±‚å’Œç¬¦å·ï¼ˆIWordOMathNaryï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºç§¯åˆ†ç¬¦å·</span>
<span class="hljs-keyword">var</span> naryFunction = oMath.Functions.Add(range, WdOMathFunctionType.wdOMathFunctionNary);
<span class="hljs-keyword">var</span> nary = naryFunction.Nary;

<span class="hljs-comment">// è®¾ç½®ç§¯åˆ†è¡¨è¾¾å¼</span>
nary.E.Range.Text = <span class="hljs-string">"f(x)dx"</span>;
nary.Sub.Range.Text = <span class="hljs-string">"0"</span>;
nary.Sub.Range.Text = <span class="hljs-string">"âˆ"</span>;

<span class="hljs-comment">// è®¾ç½®è¿ç®—ç¬¦ç±»å‹</span>
nary.Char = <span class="hljs-string">"âˆ«"</span>;  <span class="hljs-comment">// ç§¯åˆ†ç¬¦å·</span>
<span class="hljs-comment">// nary.Char = "âˆ‘";  // æ±‚å’Œç¬¦å·</span>
</code></pre>
<h2 data-id="heading-15">é«˜çº§æ•°å­¦å…¬å¼æ’ç‰ˆåŠŸèƒ½</h2>
<h3 data-id="heading-16">å¤æ‚å…¬å¼ç»“æ„</h3>
<h4 data-id="heading-17">çŸ©é˜µæ’ç‰ˆï¼ˆIWordOMathMatrixï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºçŸ©é˜µ</span>
<span class="hljs-keyword">var</span> matrixFunction = oMath.Functions.Add(range, WdOMathFunctionType.wdOMathFunctionMat);
<span class="hljs-keyword">var</span> matrix = matrixFunction.Mat;

<span class="hljs-comment">// æ·»åŠ è¡Œå’Œåˆ—</span>
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> row = <span class="hljs-number">0</span>; row &lt; <span class="hljs-number">3</span>; row++)
{
    matrix.Rows.Add(<span class="hljs-literal">null</span>);
}
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> col = <span class="hljs-number">0</span>; col &lt; <span class="hljs-number">3</span>; col++)
{
    matrix.Cols.Add(<span class="hljs-literal">null</span>);
}

<span class="hljs-comment">// è®¾ç½®çŸ©é˜µå…ƒç´ </span>
matrix.Cell(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).Range.Text = <span class="hljs-string">"a"</span>;
matrix.Cell(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).Range.Text = <span class="hljs-string">"b"</span>;
matrix.Cell(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>).Range.Text = <span class="hljs-string">"c"</span>;
matrix.Cell(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>).Range.Text = <span class="hljs-string">"d"</span>;
matrix.Cell(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>).Range.Text = <span class="hljs-string">"e"</span>;
matrix.Cell(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>).Range.Text = <span class="hljs-string">"f"</span>;
matrix.Cell(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>).Range.Text = <span class="hljs-string">"g"</span>;
matrix.Cell(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>).Range.Text = <span class="hljs-string">"h"</span>;
matrix.Cell(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>).Range.Text = <span class="hljs-string">"i"</span>;

<span class="hljs-comment">// è®¾ç½®çŸ©é˜µæ ¼å¼</span>
matrix.Align = WdOMathVertAlignType.wdOMathVertAlignCenter;
matrix.RowSpacing = <span class="hljs-number">20</span>;
matrix.ColSpacing = <span class="hljs-number">15</span>;
</code></pre>
<h4 data-id="heading-18">å¤šè¡Œæ–¹ç¨‹ç»„ï¼ˆIWordOMathEqArrayï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºæ–¹ç¨‹ç»„æ•°ç»„</span>
<span class="hljs-keyword">var</span> eqArrayFunction = oMath.Functions.Add(range, WdOMathFunctionType.wdOMathFunctionEqArray);
<span class="hljs-keyword">var</span> eqArray = eqArrayFunction.EqArray;

<span class="hljs-comment">// æ·»åŠ å¤šè¡Œæ–¹ç¨‹</span>
eqArray.Add(<span class="hljs-string">"x + y = 5"</span>);
eqArray.Add(<span class="hljs-string">"x - y = 1"</span>);

<span class="hljs-comment">// è®¾ç½®å¯¹é½æ–¹å¼</span>
eqArray.Align = WdOMathEqArrayAlign.wdOMathEqArrayAlignAlignAt;
eqArray.RowSpacing = <span class="hljs-number">10</span>;
</code></pre>
<h3 data-id="heading-19">å…¬å¼ç¼–å·ä¸å¼•ç”¨</h3>
<p>å®ç°å…¬å¼çš„è‡ªåŠ¨ç¼–å·å’Œäº¤å‰å¼•ç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å…¬å¼ç¼–å·å®ç°</span>
<span class="hljs-built_in">int</span> equationNumber = <span class="hljs-number">1</span>;
<span class="hljs-keyword">foreach</span> (IWordOMath oMath <span class="hljs-keyword">in</span> document.OMaths)
{
    <span class="hljs-comment">// å±…ä¸­å¯¹é½å…¬å¼</span>
    oMath.Range.ParagraphFormat.Alignment = WdAlignment.wdAlignParagraphCenter;
    
    <span class="hljs-comment">// åœ¨å…¬å¼åæ·»åŠ ç¼–å·</span>
    IWordRange endRange = oMath.Range.Duplicate;
    endRange.Collapse(WdCollapseDirection.wdCollapseEnd);
    endRange.Text = <span class="hljs-string">$"    (<span class="hljs-subst">{equationNumber}</span>)"</span>;
    
    <span class="hljs-comment">// æ·»åŠ ä¹¦ç­¾ç”¨äºå¼•ç”¨</span>
    <span class="hljs-built_in">string</span> bookmarkName = <span class="hljs-string">$"Equation_<span class="hljs-subst">{equationNumber}</span>"</span>;
    document.Bookmarks.Add(bookmarkName, oMath.Range);
    
    equationNumber++;
}
</code></pre>
<h3 data-id="heading-20">æ ·å¼ç»§æ‰¿ä¸åµŒå¥—å…¬å¼</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ›å»ºåµŒå¥—å…¬å¼ç»“æ„</span>
<span class="hljs-keyword">var</span> outerFraction = oMath.Functions.Add(range, WdOMathFunctionType.wdOMathFunctionFrac).Frac;

<span class="hljs-comment">// åœ¨åˆ†å­ä¸­åˆ›å»ºåµŒå¥—çš„å¹³æ–¹æ ¹</span>
<span class="hljs-keyword">var</span> innerRadical = outerFraction.Num.Functions.Add(outerFraction.Num.Range, 
    WdOMathFunctionType.wdOMathFunctionRad).Rad;
innerRadical.E.Range.Text = <span class="hljs-string">"x^2 + y^2"</span>;

<span class="hljs-comment">// è®¾ç½®åˆ†æ¯</span>
outerFraction.Den.Range.Text = <span class="hljs-string">"2"</span>;
</code></pre>
<h3 data-id="heading-21">å…¬å¼æ ·å¼ä¸æ ¼å¼æ§åˆ¶</h3>
<h3 data-id="heading-22">å­—ä½“ä¸å¤§å°è°ƒæ•´</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// è®¾ç½®å…¬å¼å­—ä½“å’Œå¤§å°</span>
oMath.Range.Font.Name = <span class="hljs-string">"Times New Roman"</span>;
oMath.Range.Font.Size = <span class="hljs-number">14</span>;
oMath.Range.Font.Bold = <span class="hljs-number">0</span>;  <span class="hljs-comment">// æ­£å¸¸å­—é‡</span>

<span class="hljs-comment">// è®¾ç½®ç‰¹æ®Šå…ƒç´ çš„å­—ä½“æ ·å¼</span>
<span class="hljs-keyword">if</span> (oMath.Functions.Count &gt; <span class="hljs-number">0</span>)
{
    <span class="hljs-keyword">var</span> function = oMath.Functions[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">if</span> (function.Frac != <span class="hljs-literal">null</span>)
    {
        <span class="hljs-comment">// åˆ†æ•°çº¿ç‰¹æ®Šå¤„ç†</span>
        function.Frac.Num.Range.Font.Color = WdColor.wdColorBlue;
        function.Frac.Den.Range.Font.Color = WdColor.wdColorRed;
    }
}
</code></pre>
<h3 data-id="heading-23">å¯¹é½ä¸å¸ƒå±€ä¼˜åŒ–</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å±…ä¸­å¯¹é½å…¬å¼</span>
oMath.Range.ParagraphFormat.Alignment = WdAlignment.wdAlignParagraphCenter;

<span class="hljs-comment">// è®¾ç½®åˆ¶è¡¨ä½ï¼Œæ§åˆ¶å…¬å¼ä¸ç¼–å·é—´è·</span>
oMath.Range.ParagraphFormat.TabStops.Add(<span class="hljs-number">200</span>, WdTabAlignment.wdAlignTabCenter);

<span class="hljs-comment">// å…¬å¼å†…å…ƒç´ å¯¹é½</span>
oMath.Justification = WdOMathJc.wdOMathJcCenter;
oMath.AlignPoint = <span class="hljs-number">100</span>;  <span class="hljs-comment">// å¯¹é½ç‚¹ä½ç½®</span>
</code></pre>
<h3 data-id="heading-24">é¢œè‰²ä¸é«˜äº®</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å…¬å¼å…ƒç´ é«˜äº®</span>
oMath.Range.Shading.BackgroundPatternColor = WdColor.wdColorLightYellow;

<span class="hljs-comment">// é”™è¯¯å…¬å¼æ ‡è®°</span>
<span class="hljs-keyword">if</span> (!IsValidEquation(oMath))
{
    oMath.Range.Font.Color = WdColor.wdColorRed;
    oMath.Range.Font.Italic = <span class="hljs-number">1</span>;
}

<span class="hljs-comment">// ç‰¹æ®Šç¬¦å·é¢œè‰²æ ‡è®°</span>
<span class="hljs-keyword">var</span> naryFunctions = oMath.Functions.Cast&lt;IWordOMathFunction&gt;()
    .Where(f =&gt; f.Nary != <span class="hljs-literal">null</span>);
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> func <span class="hljs-keyword">in</span> naryFunctions)
{
    func.Nary.Char.Range.Font.Color = WdColor.wdColorDarkBlue;
}
</code></pre>
<h2 data-id="heading-25">å®é™…åº”ç”¨æ¡ˆä¾‹ï¼šç§‘æŠ€è®ºæ–‡å…¬å¼è‡ªåŠ¨åŒ–æ’ç‰ˆ</h2>
<h3 data-id="heading-26">éœ€æ±‚åˆ†æ</h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸ºå­¦æœ¯è®ºæ–‡å¼€å‘ä¸€ä¸ªå…¬å¼è‡ªåŠ¨åŒ–æ’ç‰ˆå·¥å…·ï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ‰¹é‡æ’å…¥é¢„å®šä¹‰çš„æ•°å­¦å…¬å¼</li>
<li>è‡ªåŠ¨æ·»åŠ å…¬å¼ç¼–å·å’Œäº¤å‰å¼•ç”¨</li>
<li>ç»Ÿä¸€è°ƒæ•´å…¬å¼æ ·å¼ä»¥ç¬¦åˆæœŸåˆŠè¦æ±‚</li>
<li>æ”¯æŒLaTeXæ ¼å¼å…¬å¼çš„è½¬æ¢</li>
</ul>
<h4 data-id="heading-27">ç³»ç»Ÿæ¶æ„è®¾è®¡å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "è¾“å…¥å±‚"
        A1[LaTeXå…¬å¼æ–‡ä»¶]
        A2[Wordæ¨¡æ¿æ–‡æ¡£]
        A3[æœŸåˆŠæ ·å¼é…ç½®]
    end
    
    subgraph "å¤„ç†å±‚"
        B1[LaTeXè§£æå™¨]
        B2[å…¬å¼è½¬æ¢å¼•æ“]
        B3[æ ·å¼ç®¡ç†å™¨]
        B4[ç¼–å·ç”Ÿæˆå™¨]
    end
    
    subgraph "Word COMäº¤äº’å±‚"
        C1[IWordApplication]
        C2[IWordDocument]
        C3[IWordOMath]
        C4[IWordStyle]
    end
    
    subgraph "è¾“å‡ºå±‚"
        D1[æ ¼å¼åŒ–Wordæ–‡æ¡£]
        D2[å…¬å¼ç¼–å·]
        D3[äº¤å‰å¼•ç”¨]
    end
    
    A1 --&gt; B1
    A2 --&gt; C2
    A3 --&gt; B3
    
    B1 --&gt; B2
    B2 --&gt; C3
    B3 --&gt; C4
    B4 --&gt; D2
    
    C1 --&gt; C2
    C2 --&gt; C3
    C2 --&gt; C4
    
    C3 --&gt; D1
    C4 --&gt; D1
    D2 --&gt; D3
    
    style B1 fill:#e1f5fe
    style B2 fill:#fff3e0
    style B3 fill:#e8f5e8
    style B4 fill:#fce4ec
</code></pre>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸ºå­¦æœ¯è®ºæ–‡å¼€å‘ä¸€ä¸ªå…¬å¼è‡ªåŠ¨åŒ–æ’ç‰ˆå·¥å…·ï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ‰¹é‡æ’å…¥é¢„å®šä¹‰çš„æ•°å­¦å…¬å¼</li>
<li>è‡ªåŠ¨æ·»åŠ å…¬å¼ç¼–å·å’Œäº¤å‰å¼•ç”¨</li>
<li>ç»Ÿä¸€è°ƒæ•´å…¬å¼æ ·å¼ä»¥ç¬¦åˆæœŸåˆŠè¦æ±‚</li>
<li>æ”¯æŒLaTeXæ ¼å¼å…¬å¼çš„è½¬æ¢</li>
</ul>
<h3 data-id="heading-28">å®ç°æ­¥éª¤</h3>
<h4 data-id="heading-29">ç¬¬ä¸€æ­¥ï¼šLaTeXå…¬å¼è§£æä¸è½¬æ¢</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LaTeXToWordConverter</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> IWordOMath <span class="hljs-title">ConvertLaTeXToWordFormula</span>(<span class="hljs-params">IWordRange range, <span class="hljs-built_in">string</span> latexFormula</span>)</span>
    {
        <span class="hljs-comment">// è§£æLaTeXå…¬å¼</span>
        <span class="hljs-keyword">var</span> parsedFormula = ParseLaTeX(latexFormula);
        
        <span class="hljs-comment">// åˆ›å»ºWordå…¬å¼</span>
        IWordOMaths oMaths = range.OMaths;
        IWordRange formulaRange = oMaths.Add(range);
        IWordOMath oMath = formulaRange.OMaths[<span class="hljs-number">0</span>];
        
        <span class="hljs-comment">// é€’å½’æ„å»ºå…¬å¼ç»“æ„</span>
        BuildFormulaStructure(oMath, parsedFormula);
        
        <span class="hljs-keyword">return</span> oMath;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildFormulaStructure</span>(<span class="hljs-params">IWordOMath oMath, LaTeXElement element</span>)</span>
    {
        <span class="hljs-keyword">switch</span> (element.Type)
        {
            <span class="hljs-keyword">case</span> LaTeXType.Fraction:
                CreateFraction(oMath, element);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> LaTeXType.Matrix:
                CreateMatrix(oMath, element);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> LaTeXType.Integral:
                CreateIntegral(oMath, element);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// å…¶ä»–ç±»å‹å¤„ç†...</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-30">ç¬¬äºŒæ­¥ï¼šæ‰¹é‡å…¬å¼å¤„ç†</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EquationProcessor</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> LaTeXToWordConverter _converter;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _equationCounter = <span class="hljs-number">0</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ProcessEquations</span>(<span class="hljs-params">IWordDocument document, List&lt;<span class="hljs-built_in">string</span>&gt; latexEquations</span>)</span>
    {
        <span class="hljs-comment">// åˆ›å»ºå…¬å¼æ ·å¼</span>
        IWordStyle equationStyle = CreateEquationStyle(document);
        
        <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> latexEquation <span class="hljs-keyword">in</span> latexEquations)
        {
            <span class="hljs-comment">// æ’å…¥æ–°æ®µè½</span>
            IWordRange insertRange = document.Range(document.Content.End - <span class="hljs-number">1</span>, document.Content.End);
            insertRange.InsertParagraphAfter();
            insertRange.Collapse(WdCollapseDirection.wdCollapseEnd);
            
            <span class="hljs-comment">// è½¬æ¢å¹¶æ’å…¥å…¬å¼</span>
            IWordOMath oMath = _converter.ConvertLaTeXToWordFormula(insertRange, latexEquation);
            
            <span class="hljs-comment">// åº”ç”¨æ ·å¼å’Œç¼–å·</span>
            ApplyEquationFormatting(oMath, equationStyle);
            AddEquationNumber(oMath, ++_equationCounter);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> IWordStyle <span class="hljs-title">CreateEquationStyle</span>(<span class="hljs-params">IWordDocument document</span>)</span>
    {
        IWordStyle equationStyle = document.Styles.Add(<span class="hljs-string">"Equation"</span>, WdStyleType.wdStyleTypeParagraph);
        equationStyle.ParagraphFormat.Alignment = WdAlignment.wdAlignParagraphCenter;
        equationStyle.ParagraphFormat.SpaceAfter = <span class="hljs-number">12</span>;
        equationStyle.Font.Name = <span class="hljs-string">"Times New Roman"</span>;
        equationStyle.Font.Size = <span class="hljs-number">12</span>;
        <span class="hljs-keyword">return</span> equationStyle;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ApplyEquationFormatting</span>(<span class="hljs-params">IWordOMath oMath, IWordStyle style</span>)</span>
    {
        <span class="hljs-comment">// åº”ç”¨æ®µè½æ ·å¼</span>
        oMath.Range.set_Style(style);
        
        <span class="hljs-comment">// è®¾ç½®å…¬å¼ç±»å‹ä¸ºä¸“ä¸šæ˜¾ç¤ºæ ¼å¼</span>
        oMath.Type = WdOMathType.wdOMathDisplay;
        oMath.Justification = WdOMathJc.wdOMathJcCenter;
        
        <span class="hljs-comment">// æ„å»ºä¸“ä¸šæ ¼å¼</span>
        oMath.BuildUp();
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddEquationNumber</span>(<span class="hljs-params">IWordOMath oMath, <span class="hljs-built_in">int</span> number</span>)</span>
    {
        <span class="hljs-comment">// åœ¨å…¬å¼åæ·»åŠ ç¼–å·</span>
        IWordRange endRange = oMath.Range.Duplicate;
        endRange.Collapse(WdCollapseDirection.wdCollapseEnd);
        endRange.Text = <span class="hljs-string">$"    (<span class="hljs-subst">{number}</span>)"</span>;
        
        <span class="hljs-comment">// åˆ›å»ºä¹¦ç­¾</span>
        <span class="hljs-built_in">string</span> bookmarkName = <span class="hljs-string">$"EQ_<span class="hljs-subst">{number}</span>"</span>;
        oMath.Range.Document.Bookmarks.Add(bookmarkName, oMath.Range);
    }
}
</code></pre>
<h4 data-id="heading-31">ç¬¬ä¸‰æ­¥ï¼šæ ·å¼æ¨¡æ¿åº”ç”¨</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">JournalStyleManager</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ApplyJournalTemplate</span>(<span class="hljs-params">IWordDocument document, <span class="hljs-built_in">string</span> journalName</span>)</span>
    {
        <span class="hljs-keyword">switch</span> (journalName.ToLower())
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"ieee"</span>:
                ApplyIEEEStyle(document);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"nature"</span>:
                ApplyNatureStyle(document);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"science"</span>:
                ApplyScienceStyle(document);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-literal">default</span>:
                ApplyDefaultStyle(document);
                <span class="hljs-keyword">break</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ApplyIEEEStyle</span>(<span class="hljs-params">IWordDocument document</span>)</span>
    {
        <span class="hljs-comment">// IEEEæœŸåˆŠçš„å…¬å¼æ ·å¼è¦æ±‚</span>
        <span class="hljs-keyword">foreach</span> (IWordOMath oMath <span class="hljs-keyword">in</span> document.OMaths)
        {
            oMath.Range.Font.Name = <span class="hljs-string">"Times New Roman"</span>;
            oMath.Range.Font.Size = <span class="hljs-number">10</span>;  <span class="hljs-comment">// IEEEè¦æ±‚è¾ƒå°å­—å·</span>
            oMath.Range.ParagraphFormat.SpaceAfter = <span class="hljs-number">6</span>;
            oMath.Range.ParagraphFormat.SpaceBefore = <span class="hljs-number">6</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-32">ä»£ç ç‰‡æ®µä¸æ•ˆæœå±•ç¤º</h3>
<h4 data-id="heading-33">å…¬å¼å¤„ç†æµç¨‹å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start([å¼€å§‹]) --&gt; LoadTemplate[åŠ è½½Wordæ¨¡æ¿]
    LoadTemplate --&gt; ParseLaTeX[è§£æLaTeXå…¬å¼]
    ParseLaTeX --&gt; CheckType{æ£€æŸ¥å…¬å¼ç±»å‹}
    
    CheckType --&gt;|åˆ†æ•°| CreateFraction[åˆ›å»ºåˆ†æ•°å¯¹è±¡]
    CheckType --&gt;|çŸ©é˜µ| CreateMatrix[åˆ›å»ºçŸ©é˜µå¯¹è±¡]
    CheckType --&gt;|ç§¯åˆ†| CreateIntegral[åˆ›å»ºç§¯åˆ†å¯¹è±¡]
    CheckType --&gt;|å…¶ä»–| CreateGeneric[åˆ›å»ºé€šç”¨å…¬å¼]
    
    CreateFraction --&gt; BuildStructure[æ„å»ºå…¬å¼ç»“æ„]
    CreateMatrix --&gt; BuildStructure
    CreateIntegral --&gt; BuildStructure
    CreateGeneric --&gt; BuildStructure
    
    BuildStructure --&gt; ApplyStyle[åº”ç”¨æ ·å¼æ¨¡æ¿]
    ApplyStyle --&gt; AddNumber[æ·»åŠ å…¬å¼ç¼–å·]
    AddNumber --&gt; CreateBookmark[åˆ›å»ºä¹¦ç­¾å¼•ç”¨]
    CreateBookmark --&gt; SaveDocument[ä¿å­˜æ–‡æ¡£]
    SaveDocument --&gt; End([ç»“æŸ])
    
    Start --&gt; Error[é”™è¯¯å¤„ç†]
    BuildStructure --&gt; Error
    SaveDocument --&gt; Error
    Error --&gt; End
    
    style Start fill:#4caf50,color:#fff
    style End fill:#f44336,color:#fff
    style Error fill:#ff9800,color:#fff
    style BuildStructure fill:#2196f3,color:#fff
</code></pre>
<h4 data-id="heading-34">å®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼š</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ScientificPaperFormatter</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FormatScientificPaper</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> templatePath, List&lt;<span class="hljs-built_in">string</span>&gt; equations, <span class="hljs-built_in">string</span> outputPath</span>)</span>
    {
        <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> application = <span class="hljs-keyword">new</span> WordApplication();
        IWordDocument document = application.Documents.Open(templatePath);
        
        <span class="hljs-comment">// åˆå§‹åŒ–å¤„ç†å™¨</span>
        <span class="hljs-keyword">var</span> processor = <span class="hljs-keyword">new</span> EquationProcessor();
        <span class="hljs-keyword">var</span> styleManager = <span class="hljs-keyword">new</span> JournalStyleManager();
        
        <span class="hljs-comment">// å¤„ç†æ‰€æœ‰å…¬å¼</span>
        processor.ProcessEquations(document, equations);
        
        <span class="hljs-comment">// åº”ç”¨æœŸåˆŠæ ·å¼</span>
        styleManager.ApplyJournalTemplate(document, <span class="hljs-string">"IEEE"</span>);
        
        <span class="hljs-comment">// ä¿å­˜æ–‡æ¡£</span>
        document.SaveAs2(outputPath);
        document.Close();
        application.Quit();
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> formatter = <span class="hljs-keyword">new</span> ScientificPaperFormatter();
<span class="hljs-keyword">var</span> equations = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-built_in">string</span>&gt;
{
    <span class="hljs-string">"\\frac{d^2y}{dx^2} + \\omega^2 y = 0"</span>,  <span class="hljs-comment">// å¾®åˆ†æ–¹ç¨‹</span>
    <span class="hljs-string">"\\int_{0}^{\\infty} e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}"</span>,  <span class="hljs-comment">// ç§¯åˆ†å…¬å¼</span>
    <span class="hljs-string">"\\begin{pmatrix} a &amp; b \\\\ c &amp; d \\end{pmatrix}"</span>  <span class="hljs-comment">// çŸ©é˜µ</span>
};

formatter.FormatScientificPaper(<span class="hljs-string">@"C:\Templates\PaperTemplate.docx"</span>, 
                                equations, 
                                <span class="hljs-string">@"C:\Output\FormattedPaper.docx"</span>);
</code></pre>
<h2 data-id="heading-35">æ€»ç»“</h2>
<p>é€šè¿‡MudTools.OfficeInterop.Wordé¡¹ç›®ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†ä¸€å¥—å®Œæ•´çš„C# Wordæ•°å­¦å…¬å¼æ’ç‰ˆè§£å†³æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<h3 data-id="heading-36">æŠ€æœ¯ä¼˜åŠ¿</h3>
<ol>
<li><strong>å®Œæ•´çš„æ¥å£è¦†ç›–</strong> - æ”¯æŒ22ç§æ•°å­¦å‡½æ•°ç±»å‹ï¼Œæ¶µç›–æ‰€æœ‰å¸¸ç”¨æ•°å­¦ç¬¦å·</li>
<li><strong>å±‚æ¬¡åŒ–å¯¹è±¡æ¨¡å‹</strong> - æ¸…æ™°çš„æ¥å£è®¾è®¡ï¼Œä¾¿äºç†è§£å’Œæ‰©å±•</li>
<li><strong>è‡ªåŠ¨åŒ–èƒ½åŠ›å¼º</strong> - æ”¯æŒæ‰¹é‡å¤„ç†ã€æ ·å¼ç»Ÿä¸€ã€ç¼–å·ç®¡ç†</li>
<li><strong>æ ¼å¼è½¬æ¢æ”¯æŒ</strong> - LaTeXåˆ°Wordå…¬å¼çš„æ— ç¼è½¬æ¢</li>
</ol>
<h3 data-id="heading-37">åº”ç”¨ä»·å€¼</h3>
<ol>
<li><strong>æé«˜ç”Ÿäº§æ•ˆç‡</strong> - ä»æ‰‹å·¥æ’ç‰ˆè½¬å‘è‡ªåŠ¨åŒ–ç”Ÿæˆï¼Œæ•ˆç‡æå‡æ•°åå€</li>
<li><strong>ä¿è¯æ ¼å¼ä¸€è‡´æ€§</strong> - ç»Ÿä¸€çš„æ ·å¼ç®¡ç†ï¼Œç¡®ä¿æ–‡æ¡£ä¸“ä¸šæ€§</li>
<li><strong>é™ä½æŠ€æœ¯é—¨æ§›</strong> - å°è£…å¤æ‚çš„COMæ“ä½œï¼Œæä¾›ç®€æ´çš„C#æ¥å£</li>
<li><strong>æ”¯æŒæ‰¹é‡å¤„ç†</strong> - ç‰¹åˆ«é€‚åˆå¤§è§„æ¨¡æ–‡æ¡£å’Œå­¦æœ¯è®ºæ–‡çš„æ ¼å¼åŒ–</li>
</ol>
<p>MudTools.OfficeInterop.Wordé¡¹ç›®ä¸ºC#å¼€å‘è€…æä¾›äº†å¼ºå¤§çš„Wordæ–‡æ¡£æ“ä½œèƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°å­¦å…¬å¼æ’ç‰ˆé¢†åŸŸï¼Œä¸ºç§‘æŠ€æ–‡æ¡£çš„è‡ªåŠ¨åŒ–ç”Ÿäº§å¥ å®šäº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚</p>
<h2 data-id="heading-38">ç›¸å…³èµ„æº</h2>
<h3 data-id="heading-39">é¡¹ç›®åœ°å€</h3>
<ul>
<li><strong>Gitee ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fmudtools%2FOfficeInterop" target="_blank" title="https://gitee.com/mudtools/OfficeInterop" ref="nofollow noopener noreferrer">gitee.com/mudtools/Ofâ€¦</a></li>
<li><strong>GitHub ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmudtools%2FMudOfficeInterop" target="_blank" title="https://github.com/mudtools/MudOfficeInterop" ref="nofollow noopener noreferrer">github.com/mudtools/Muâ€¦</a></li>
</ul>
<h3 data-id="heading-40">Office APIå‚è€ƒ</h3>
<ul>
<li>Microsoft Excelå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Foffice%2Fvba%2Fapi%2Foverview%2Fexcel" target="_blank" title="https://docs.microsoft.com/zh-cn/office/vba/api/overview/excel" ref="nofollow noopener noreferrer">docs.microsoft.com/zh-cn/officâ€¦</a></li>
<li>.NET COMäº’æ“ä½œæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fdotnet%2Fframework%2Finterop%2F" target="_blank" title="https://docs.microsoft.com/zh-cn/dotnet/framework/interop/" ref="nofollow noopener noreferrer">docs.microsoft.com/zh-cn/dotneâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[goä½¿ç”¨Cronå®šæ—¶ï¼Œå®ç°recoveræœºåˆ¶ã€‚]]></title>    <link>https://juejin.cn/post/7598587406695022635</link>    <guid>https://juejin.cn/post/7598587406695022635</guid>    <pubDate>2026-01-24T06:01:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598587406695022635" data-draft-id="7598587406694924331" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="goä½¿ç”¨Cronå®šæ—¶ï¼Œå®ç°recoveræœºåˆ¶ã€‚"/> <meta itemprop="keywords" content="Go,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-24T06:01:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="maoæ¯›"/> <meta itemprop="url" content="https://juejin.cn/user/1146138854949790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            goä½¿ç”¨Cronå®šæ—¶ï¼Œå®ç°recoveræœºåˆ¶ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1146138854949790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    maoæ¯›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T06:01:41.000Z" title="Sat Jan 24 2026 06:01:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">robfig/cron v3 æœªå®ç°recover</h2>
<p>å®šæ—¶ä»»åŠ¡paincä¼šå¯¼è‡´ç¨‹åºå†…å­˜æ•°æ®ä¸¢å¤±ï¼Œå‘ç”Ÿé‡å¯ï¼Œæœ¬æ•™ç¨‹æ˜¯å®ç°cronçš„recoveræœºåˆ¶ã€‚åŒæ ·ä¹Ÿé€‚ç”¨äºé•¿è¿æ¥åœºæ™¯ï¼Œæ¯”å¦‚tcpé“¾æ¥åï¼Œç”¨æˆ·å‘ç”Ÿè¡Œä¸ºè°ƒç”¨rpcæœåŠ¡ï¼Œä½†æ˜¯åœ¨è°ƒç”¨å‰çš„æŸäº›æ“ä½œï¼Œè¢«æŠ½è±¡å‡ºæ¥äº†ï¼Œç¼–ç¨‹ä¸åˆç†ç­‰åœºæ™¯ï¼Œå‘ç”Ÿpaincï¼Œä¼šå¯¼è‡´å½“å‰ç”¨æˆ·æ–­å¼€é“¾æ¥ï¼Œæ•°æ®ä¸¢å¤±ã€‚</p>
<h2 data-id="heading-1">ç»´æŠ¤handlerï¼Œdefer å¤„ç†recover</h2>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> CornDesc <span class="hljs-keyword">struct</span> {
    Name    <span class="hljs-type">string</span>
    Spec    <span class="hljs-type">string</span>
    NewFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CornDesc)</span></span> Handle() {
    <span class="hljs-keyword">defer</span> c.final()
    c.NewFunc()
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CornDesc)</span></span> final() {
    <span class="hljs-keyword">if</span> err := <span class="hljs-built_in">recover</span>(); err != <span class="hljs-literal">nil</span> {
       fmt.Printf(<span class="hljs-string">"%s æ•è·è¿è¡Œå¼‚å¸¸! err :%v stack %s\n"</span>, c.Name, err, debug.Stack())
    }
}

</code></pre>
<h2 data-id="heading-2">cmd å¯¼å…¥åŸåˆ™ï¼Œæ­¤éƒ¨åˆ†å¯ä»¥ä¿®æ”¹</h2>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> _Machine *Machine

<span class="hljs-keyword">type</span> Machine <span class="hljs-keyword">struct</span> {
    *cron.Cron
    exist <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitMachine</span><span class="hljs-params">(c *cron.Cron)</span></span> *Machine {
    <span class="hljs-keyword">if</span> _Machine == <span class="hljs-literal">nil</span> {
       _Machine = &amp;Machine{
          Cron:  c,
          exist: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>),
       }
    }
    <span class="hljs-keyword">return</span> _Machine
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BaseMachine</span><span class="hljs-params">()</span></span> *Machine {
    <span class="hljs-keyword">return</span> _Machine
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *Machine)</span></span> Run() {
    m.Cron.Run()
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *Machine)</span></span> verify(cronDesc *CornDesc) <span class="hljs-type">error</span> {
    <span class="hljs-keyword">if</span> id, ok := m.exist[cronDesc.Name]; ok {
       <span class="hljs-keyword">return</span> fmt.Errorf(<span class="hljs-string">"ä»»åŠ¡å·²å­˜åœ¨,name %s id %d"</span>, cronDesc.Name, id)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *Machine)</span></span> Register(cornDesc *CornDesc) <span class="hljs-type">error</span> {
    <span class="hljs-keyword">if</span> err := m.verify(cornDesc); err != <span class="hljs-literal">nil</span> {
       <span class="hljs-keyword">return</span> err
    }
    id, err := m.Cron.AddFunc(cornDesc.Spec, cornDesc.Handle)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
       <span class="hljs-keyword">return</span> err
    }
    m.exist[cornDesc.Name] = <span class="hljs-type">int</span>(id)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DOM-æ·±åº¦æŒæ¡ HTMLElementï¼šä»åŸºç¡€æ“ä½œåˆ°é«˜æ€§èƒ½äº¤äº’]]></title>    <link>https://juejin.cn/post/7598389448147664906</link>    <guid>https://juejin.cn/post/7598389448147664906</guid>    <pubDate>2026-01-24T03:17:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598389448147664906" data-draft-id="7598445152158171187" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DOM-æ·±åº¦æŒæ¡ HTMLElementï¼šä»åŸºç¡€æ“ä½œåˆ°é«˜æ€§èƒ½äº¤äº’"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-24T03:17:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DOM-æ·±åº¦æŒæ¡ HTMLElementï¼šä»åŸºç¡€æ“ä½œåˆ°é«˜æ€§èƒ½äº¤äº’
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T03:17:45.000Z" title="Sat Jan 24 2026 03:17:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨ DOM æ ‘ä¸­ï¼Œ<code>Element</code> ç±»å‹æ˜¯æˆ‘ä»¬äº¤äº’æœ€é¢‘ç¹çš„èŠ‚ç‚¹ã€‚æ— è®ºæ˜¯ä¿®æ”¹æ ·å¼ã€ç›‘å¬ç„¦ç‚¹ï¼Œè¿˜æ˜¯åŠ¨æ€æ’å…¥å†…å®¹ï¼Œéƒ½ç¦»ä¸å¼€å®ƒã€‚æœ¬æ–‡å°†å¸¦ä½ ç³»ç»Ÿå¤ä¹  <code>Element</code> çš„æ ¸å¿ƒ APIï¼Œå¹¶æ­ç¤ºä¸€äº›åœ¨å®é™…å¼€å‘ä¸­å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚ä¸é™·é˜±ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ Element èŠ‚ç‚¹åŸºç¡€</h2>
<p><code>Element</code> è¡¨ç¤º HTML ä¸­çš„å…ƒç´ èŠ‚ç‚¹ã€‚é€šè¿‡ <code>document.createElement()</code> å¯ä»¥åŠ¨æ€åˆ›å»ºã€‚</p>
<ul>
<li><strong><code>nodeType</code></strong>: <strong>1</strong></li>
<li><strong><code>nodeName</code></strong>: è¿”å›å¤§å†™æ ‡ç­¾åï¼ˆå¦‚ <code>"DIV"</code>ï¼‰ã€‚</li>
<li><strong><code>nodeValue</code></strong>: å§‹ç»ˆä¸º <code>null</code>ã€‚</li>
</ul>
<h3 data-id="heading-2">1. æ ‡å‡†å±æ€§</h3>
<p>å¯ä»¥ç›´æ¥é€šè¿‡ç‚¹è¯­æ³•ï¼ˆ<code>.</code>ï¼‰è®¿é—®çš„å¸¸è§å±æ€§ï¼š<code>id</code>ã€<code>title</code>ã€<code>lang</code>ã€<code>dir</code>è¯­è¨€çš„ä¹¦å†™æ–¹å‘ï¼ˆ"ltr"è¡¨ç¤ºä»å·¦åˆ°å³ï¼Œ"rtl"è¡¨ç¤ºä»å³åˆ°å·¦)ã€‚</p>
<ul>
<li><strong><code>className</code></strong>: å¯¹åº” HTML çš„ <code>class</code> å±æ€§ã€‚ç”±äº <code>class</code> æ˜¯ JS å…³é”®å­—ï¼Œæ•…å±æ€§ååšäº†è½¬æ¢ã€‚</li>
</ul>
<h3 data-id="heading-3">2. è‡ªå®šä¹‰å±æ€§ï¼šdataset</h3>
<p>HTML5 è§„èŒƒäº† <code>data-</code> å‰ç¼€çš„è‡ªå®šä¹‰å±æ€§ï¼Œé€šè¿‡ <code>dataset</code> å¯¹è±¡å¯ä»¥ä¼˜é›…åœ°è¯»å†™ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">&lt;div id=<span class="hljs-string">"myDiv"</span> data-app-id=<span class="hljs-string">"12345"</span>&gt;&lt;/div&gt;

<span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"myDiv"</span>);

<span class="hljs-comment">// è·å–ï¼šæ³¨æ„ camelCase è½¬æ¢ï¼ˆdata-app-id -&gt; appIdï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>.<span class="hljs-property">appId</span>); 

<span class="hljs-comment">// è®¾ç½®</span>
div.<span class="hljs-property">dataset</span>.<span class="hljs-property">userName</span> = <span class="hljs-string">"Nicholas"</span>; <span class="hljs-comment">// è‡ªåŠ¨å˜ä¸º data-user-name="Nicholas"</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">äºŒã€ å±æ€§æ“ä½œï¼šAttribute vs Property</h2>
<p>è¿™æ˜¯æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ï¼š<code>getAttribute</code> æ“ä½œçš„æ˜¯ HTML æ–‡æ¡£ä¸­çš„<strong>ç‰¹æ€§</strong>ï¼Œè€Œç›´æ¥èµ‹å€¼æ“ä½œçš„æ˜¯ JS å¯¹è±¡çš„<strong>å±æ€§</strong>ã€‚</p>

























<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æè¿°</strong></th><th><strong>ç‰¹ç‚¹</strong></th></tr></thead><tbody><tr><td><strong><code>getAttribute(name)</code></strong></td><td>è·å– HTML ç‰¹æ€§</td><td>å§‹ç»ˆè¿”å›å­—ç¬¦ä¸²ï¼›è·å–ç±»åéœ€ä¼  <code>"class"</code></td></tr><tr><td><strong><code>setAttribute(name, v)</code></strong></td><td>è®¾ç½® HTML ç‰¹æ€§</td><td>ä¼šåŒæ­¥åˆ° HTML ç»“æ„ä¸­</td></tr><tr><td><strong><code>removeAttribute(name)</code></strong></td><td>å½»åº•åˆ é™¤ç‰¹æ€§</td><td>ä¸ä»…ä»…æ˜¯æ¸…ç©ºå€¼</td></tr></tbody></table>
<blockquote>
<p><strong>ğŸ’¡ å»ºè®®ï¼š</strong> å¯¹äº <code>id</code>ã€<code>className</code> ç­‰æ ‡å‡†å±æ€§ï¼Œç›´æ¥ä½¿ç”¨ç‚¹è¯­æ³•æ€§èƒ½æ›´å¥½ï¼›å¯¹äºéæ ‡å‡†çš„è‡ªå®šä¹‰å±æ€§ï¼Œä½¿ç”¨ <code>dataset</code>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ å†…å®¹æ“æ§ï¼šå®‰å…¨ä¸æ€§èƒ½</h2>
<h3 data-id="heading-6">1. innerHTML vs textContent</h3>
<ul>
<li><strong><code>innerHTML</code></strong>: è¯»å†™ HTMLï¼Œä¼šè§£ææ ‡ç­¾ã€‚<strong>æ³¨æ„ï¼š</strong> å­˜åœ¨ XSS æ”»å‡»é£é™©ã€‚</li>
<li><strong><code>textContent</code></strong>: è¯»å†™çº¯æ–‡æœ¬ã€‚æ€§èƒ½æ›´å¥½ä¸”æ›´å®‰å…¨ã€‚</li>
</ul>
<h3 data-id="heading-7">2. é«˜æ€§èƒ½æ’å…¥ï¼šinsertAdjacentHTML</h3>
<ul>
<li>è¯­æ³•ï¼š<code>insertAdjacentText(first,sencond)</code>
<ul>
<li><code>second</code>ï¼šæ’å…¥å†…å®¹</li>
<li><code>first</code>ï¼šè¦æ’å…¥çš„ä½ç½®
<ul>
<li><code>beforebegin</code>ï¼šæ’å…¥å½“å‰å…ƒç´ å‰é¢ï¼Œä½œä¸ºå‰ä¸€ä¸ªåŒèƒèŠ‚ç‚¹</li>
<li><code>afterbegin</code>ï¼šæ’å…¥å½“å‰å…ƒç´ å†…éƒ¨ï¼Œä½œä¸ºæ–°çš„å­èŠ‚ç‚¹æˆ–æ”¾åœ¨ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹å‰é¢</li>
<li><code>beforeend</code>ï¼šæ’å…¥å½“å‰å…ƒç´ å†…éƒ¨ï¼Œä½œä¸ºæ–°çš„å­èŠ‚ç‚¹æˆ–æ”¾åœ¨æœ€åä¸€ä¸ªå­èŠ‚ç‚¹åé¢</li>
<li><code>afterend</code>ï¼šæ’å…¥å½“å‰å…ƒç´ åé¢ï¼Œä½œä¸ºä¸‹ä¸€ä¸ªåŒèƒèŠ‚ç‚¹</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ç›¸æ¯”äº <code>innerHTML += '...'</code>ï¼ˆä¼šå¯¼è‡´æ•´ä¸ªå­æ ‘é‡æ–°æ¸²æŸ“ï¼‰ï¼Œ<code>insertAdjacentHTML</code> å¯ä»¥å°†å­—ç¬¦ä¸²è§£æä¸º DOM å¹¶ç²¾ç¡®æ’å…¥ï¼Œæ€§èƒ½æé«˜ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// è¯­æ³•ï¼šelement.insertAdjacentHTML(position, html)</span>
element.<span class="hljs-title function_">insertAdjacentHTML</span>(<span class="hljs-string">"afterbegin"</span>, <span class="hljs-string">"&lt;span&gt;New Content&lt;/span&gt;"</span>);
</code></pre>
<hr/>
<h2 data-id="heading-8">å››ã€ ç±»åç®¡ç†ï¼šclassList API</h2>
<p>ä»¥å‰æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ“ä½œ <code>className</code> å­—ç¬¦ä¸²ï¼Œç°åœ¨æœ‰äº† <code>classList</code> è¿™ä¸ªç¥å™¨ã€‚</p>
<ul>
<li><strong><code>add(value)</code></strong> : æ·»åŠ ç±»åã€‚</li>
<li><strong><code>remove(value)</code></strong> : åˆ é™¤ç±»åã€‚</li>
<li><strong><code>contains(value)</code></strong> : åˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚</li>
<li><strong><code>toggle(value)</code></strong> : åˆ‡æ¢ï¼ˆæœ‰åˆ™åˆ ï¼Œæ— åˆ™åŠ ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">äº”ã€ å‡ ä½•å°ºå¯¸ï¼šå½»åº•ææ‡‚å„ç§ Height/Width</h2>
<p>åœ¨å¤„ç†æ»šåŠ¨å’Œå¸ƒå±€æ—¶ï¼Œè¿™äº›å±æ€§éå¸¸å…³é”®ã€‚</p>





















<table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>åŒ…å«èŒƒå›´</strong></th></tr></thead><tbody><tr><td><strong><code>clientWidth / clientHeight</code></strong></td><td>å†…å®¹ + å†…è¾¹è· (Padding)</td></tr><tr><td><strong><code>offsetWidth / offsetHeight</code></strong></td><td>å†…å®¹ + å†…è¾¹è· + <strong>è¾¹æ¡† (Border)</strong></td></tr><tr><td><strong><code>scrollWidth / scrollHeight</code></strong></td><td>åŒ…å«æ»šåŠ¨æ¡æ»šå‡ºçš„<strong>éšè—éƒ¨åˆ†</strong>çš„å®Œæ•´å°ºå¯¸</td></tr></tbody></table>
<p><strong>è¿›é˜¶ï¼šè·å–ç²¾ç¡®ä½ç½®</strong></p>
<p><code>getBoundingClientRect()</code> è¿”å›å…ƒç´ ç›¸å¯¹äº<strong>æµè§ˆå™¨è§†å£</strong>çš„ <code>top</code>, <code>left</code>, <code>right</code>, <code>bottom</code>, <code>width</code>, <code>height</code>ã€‚</p>
<hr/>
<h2 data-id="heading-10">å…­ã€ ç„¦ç‚¹ç®¡ç†</h2>
<ul>
<li><strong><code>document.activeElement</code></strong>: æŒ‡å‘å½“å‰è·å¾—ç„¦ç‚¹çš„å…ƒç´ ï¼ˆå¦‚æ­£å¤„åœ¨è¾“å…¥çŠ¶æ€çš„ <code>input</code>ï¼‰ã€‚</li>
<li><strong><code>element.focus()</code></strong> : å¼ºåˆ¶è®©å…ƒç´ è·å¾—ç„¦ç‚¹ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">let</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"myButton"</span>);
button.<span class="hljs-title function_">focus</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">activeElement</span> === button); <span class="hljs-comment">// true </span>
</code></pre>
<hr/>
<h2 data-id="heading-11">ä¸ƒã€ é¢è¯•æ¨¡æ‹Ÿé¢˜</h2>
<h3 data-id="heading-12">Q1ï¼š<code>isSameNode()</code> å’Œ <code>isEqualNode()</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong></p>
<ul>
<li><code>isSameNode()</code> (ç­‰åŒäº <code>===</code>): æ£€æŸ¥ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨<strong>åŒä¸€ä¸ª</strong> DOM å®ä¾‹ã€‚</li>
<li><code>isEqualNode()</code>: æ£€æŸ¥ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦<strong>é•¿å¾—ä¸€æ ·</strong>ï¼ˆç±»å‹ç›¸åŒã€å±æ€§ç›¸åŒã€å­èŠ‚ç‚¹ç»“æ„ä¹Ÿç›¸åŒï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-13">Q2ï¼šä¸ºä»€ä¹ˆé€šè¿‡ <code>innerHTML</code> æ’å…¥çš„ <code>&lt;script&gt;</code> ä¸ä¼šæ‰§è¡Œï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong></p>
<p>è¿™æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ã€‚å¦‚æœéœ€è¦æ‰§è¡Œè„šæœ¬ï¼Œå¿…é¡»é€šè¿‡ <code>document.createElement('script')</code> æ‰‹åŠ¨åˆ›å»ºå¹¶æ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>