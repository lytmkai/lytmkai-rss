<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[æ™ºè°±GLM-4.6Vå¼€æºï¼šä¸ä»…ä»…æ˜¯â€œçœ‹æ‡‚â€ï¼Œå®ƒç»ˆäºé•¿å‡ºäº†â€œåŒæ‰‹â€]]></title>    <link>https://juejin.cn/post/7581363652780441610</link>    <guid>https://juejin.cn/post/7581363652780441610</guid>    <pubDate>2025-12-08T15:07:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581363652780441610" data-draft-id="7581359420391964699" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºè°±GLM-4.6Vå¼€æºï¼šä¸ä»…ä»…æ˜¯â€œçœ‹æ‡‚â€ï¼Œå®ƒç»ˆäºé•¿å‡ºäº†â€œåŒæ‰‹â€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-08T15:07:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºè°±GLM-4.6Vå¼€æºï¼šä¸ä»…ä»…æ˜¯â€œçœ‹æ‡‚â€ï¼Œå®ƒç»ˆäºé•¿å‡ºäº†â€œåŒæ‰‹â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:07:20.000Z" title="Mon Dec 08 2025 15:07:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025å¹´12æœˆ8æ—¥ï¼Œæ™ºè°±AIæ²¡æœ‰é¢„å‘Šï¼Œç›´æ¥ç”©å‡ºäº†ä¸€å¼ ç‹ç‚¸ï¼šGLM-4.6Vç³»åˆ—å¤šæ¨¡æ€å¤§æ¨¡å‹æ­£å¼ä¸Šçº¿å¹¶å…¨é‡å¼€æºã€‚</p>
<p>å¦‚æœä½ è¿˜åœ¨å…³æ³¨é‚£äº›åªä¼šâ€œçœ‹å›¾è¯´è¯â€çš„æ¨¡å‹ï¼Œé‚£è¿™æ¬¡ä½ å¯èƒ½è¦åˆ·æ–°ä¸€ä¸‹è®¤çŸ¥äº†ã€‚æ™ºè°±è¿™æ¬¡çš„æ›´æ–°ï¼Œä¸æ˜¯ç®€å•çš„å‚æ•°å †å ï¼Œè€Œæ˜¯è¯•å›¾è§£å†³å¤šæ¨¡æ€é¢†åŸŸä¸€ä¸ªæœ€å°´å°¬çš„ç—›ç‚¹â€”â€”å¤§æ¨¡å‹ä¸ä»…è¦æœ‰çœ¼ç›ï¼Œè¿˜å¾—æœ‰æ‰‹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-08_22.58.46-1024x740.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-08_22.58.46-1024x740.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23d48ec132e845e1841214f172134df2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811240&amp;x-signature=ZHxvajg8Poxghqn7ufzK%2BCYORhk%3D" alt="iShot_2025-12-08_22.58.46" loading="lazy"/></a></p>
<p><strong>ä»â€œè§£è¯´å‘˜â€è¿›åŒ–ä¸ºâ€œæ“ä½œå‘˜â€</strong></p>
<p>è¿‡å»æˆ‘ä»¬ç”¨è§†è§‰æ¨¡å‹ï¼ˆVLMï¼‰ï¼Œæµç¨‹é€šå¸¸æ˜¯è¿™æ ·çš„ï¼šæ‰”ä¸€å¼ å›¾ç»™æ¨¡å‹ï¼Œé—®å®ƒâ€œè¿™æ˜¯ä»€ä¹ˆâ€ï¼Œæ¨¡å‹å›ç­”â€œè¿™æ˜¯ä¸€ä¸ªç½‘é¡µæŠ¥é”™â€ã€‚ç„¶åå‘¢ï¼Ÿç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ä½ å¾—è‡ªå·±å»å†™ä»£ç ä¿®å¤ã€‚</p>
<p>GLM-4.6Vçš„æ ¸å¿ƒçªç ´åœ¨äºâ€œåŸç”Ÿå¤šæ¨¡æ€å·¥å…·è°ƒç”¨â€ã€‚è¿™æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Ÿæ„å‘³ç€å›¾åƒã€è§†é¢‘ä¸å†ä»…ä»…æ˜¯éœ€è¦è¢«â€œç¿»è¯‘â€æˆæ–‡å­—çš„ç´¯èµ˜ï¼Œå®ƒä»¬ç›´æ¥æˆä¸ºäº†å‡½æ•°è°ƒç”¨çš„å‚æ•°ã€‚</p>
<p>æ¨¡å‹å¯ä»¥ç›´æ¥è¯»å–ä½ çš„å±å¹•æˆªå›¾ï¼Œç†è§£UIå¸ƒå±€ï¼Œç„¶åè°ƒç”¨å·¥å…·å»ç‚¹å‡»ã€è¾“å…¥ã€ç”šè‡³ç›´æ¥ç”Ÿæˆå‰ç«¯ä»£ç å¹¶è¿›è¡Œè§†è§‰ä¿®æ­£ã€‚å®ƒä¸å†æ˜¯ä¸€ä¸ªç«™åœ¨æ—è¾¹æŒ‡æŒ‡ç‚¹ç‚¹çš„è§£è¯´å‘˜ï¼Œè€Œæ˜¯ä¸€ä¸ªèƒ½çœŸæ­£ä¸‹åœºå¹²æ´»çš„æ“ä½œå‘˜ã€‚å¯¹äºæƒ³åšå¤šæ¨¡æ€Agentï¼ˆæ™ºèƒ½ä½“ï¼‰çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ç®€ç›´æ˜¯æ¢¦å¯ä»¥æ±‚çš„åŸºç¡€è®¾æ–½ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-08_22.58.38-1024x838.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-08_22.58.38-1024x838.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da36ea79f99845cc9c07571ab2cf6278~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811240&amp;x-signature=pi9FB7pRnT%2FTQgpiCepMEw9xbnw%3D" alt="iShot_2025-12-08_22.58.38" loading="lazy"/></a></p>
<p><strong>ä¸¤æ¬¾æ¨¡å‹ï¼Œä¸°ä¿­ç”±äºº</strong></p>
<p>è¿™æ¬¡æ™ºè°±çš„åˆ€æ³•ä¾æ—§ç²¾å‡†ï¼Œæ¨å‡ºäº†ä¸¤æ¬¾å®šä½æˆªç„¶ä¸åŒçš„æ¨¡å‹ï¼š</p>
<p><strong>GLM-4.6V (106B)</strong>ï¼šè¿™æ˜¯ç»™è¿½æ±‚æè‡´æ€§èƒ½çš„ç©å®¶å‡†å¤‡çš„ã€‚è™½ç„¶å‚æ•°é‡é«˜è¾¾106Bï¼Œä½†æ¿€æ´»å‚æ•°æ§åˆ¶åœ¨12Bï¼ˆMoEæ¶æ„ï¼‰ï¼Œåœ¨äº‘ç«¯é«˜æ€§èƒ½é›†ç¾¤ä¸Šï¼Œå®ƒèƒ½å¤„ç†å¤æ‚çš„é•¿æ–‡æ¡£å’Œæ·±åº¦æ¨ç†ä»»åŠ¡ã€‚æ ¹æ®å®˜æ–¹æ•°æ®ï¼Œå®ƒçš„è¡¨ç°ç›´æ¥å¯¹æ ‡è¡Œä¸šé¡¶å°–é—­æºæ¨¡å‹ã€‚</p>
<p><strong>GLM-4.6V-Flash (9B)</strong>ï¼šè¿™æ˜¯ç»™åŠ¡å®æ´¾å‡†å¤‡çš„æƒŠå–œã€‚9Bçš„ä½“é‡æ„å‘³ç€å®ƒå¯ä»¥è½»æ¾éƒ¨ç½²åœ¨æœ¬åœ°ï¼Œç”šè‡³æ˜¯ä¸€äº›ç«¯ä¾§è®¾å¤‡ä¸Šã€‚è™½ç„¶æ˜¯è½»é‡ç‰ˆï¼Œä½†å®ƒåœ¨OCRã€è§†é¢‘ç†è§£ç­‰é«˜é¢‘åœºæ™¯ä¸‹çš„è¡¨ç°å¹¶ä¸å«ç³Šï¼Œç”šè‡³åœ¨è¿™ä¸ªå°ºå¯¸ä¸‹å‡»è´¥äº†Qwen3-VL-8Bç­‰ç«å“ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œå…¨ç³»æ¨¡å‹æ”¯æŒ<strong>128kçš„è¶…é•¿ä¸Šä¸‹æ–‡</strong>ã€‚ä»€ä¹ˆæ¦‚å¿µï¼Ÿä½ å¯ä»¥ä¸€æ¬¡æ€§æ‰”ç»™å®ƒä¸€æœ¬150é¡µçš„æŠ€æœ¯æ–‡æ¡£ï¼Œæˆ–è€…ä¸€æ®µ1å°æ—¶çš„è§†é¢‘ï¼Œå®ƒä¸ä»…èƒ½è¯»å®Œï¼Œè¿˜èƒ½åœ¨é‡Œé¢ç²¾å‡†åœ°æ‰¾åˆ°ä½ éœ€è¦çš„ç»†èŠ‚ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-08_22.58.11-1024x355.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-08_22.58.11-1024x355.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc858a6d5835417ca295a6638a9c978d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811240&amp;x-signature=bGDI16uQhIcaYfUutWcZI4eBiuU%3D" alt="iShot_2025-12-08_22.58.11" loading="lazy"/></a></p>
<p><strong>ä»·æ ¼å± å¤«ä¸å¼€æºè¯šæ„</strong></p>
<p>æŠ€æœ¯å†å¥½ï¼Œç”¨ä¸èµ·ä¹Ÿæ˜¯ç™½æ­ã€‚æ™ºè°±è¿™æ¬¡æ˜¾ç„¶æ˜¯æƒ³å¿«é€ŸæŠ¢å å¸‚åœºã€‚</p>
<p>ç›¸æ¯”ä¸Šä¸€ä»£GLM-4.5Vï¼Œæ–°ç‰ˆAPIçš„ä»·æ ¼ç›´æ¥è…°æ–©äº†50%ã€‚è¾“å…¥1å…ƒ/ç™¾ä¸‡tokensï¼Œè¾“å‡º3å…ƒ/ç™¾ä¸‡tokensã€‚è€Œé‚£ä¸ªå¯ä»¥åœ¨æœ¬åœ°è·‘å¾—é£èµ·çš„Flashç‰ˆæœ¬ï¼Œæ™ºè°±ç›´æ¥å®£å¸ƒï¼š<strong>å…è´¹</strong>ã€‚</p>
<p>åœ¨å¼€æºç­–ç•¥ä¸Šï¼Œæ™ºè°±ä¹Ÿæ²¡æœ‰è—ç€æ–ç€ã€‚æƒé‡ã€æ¨ç†ä»£ç ã€ç¤ºä¾‹å·¥ç¨‹å…¨éƒ¨æ¨ä¸Šäº†GitHubå’ŒHugging Faceã€‚MITåè®®ï¼Œå…è®¸å•†ä¸šä½¿ç”¨ã€‚è¿™æ„å‘³ç€ï¼Œæ˜å¤©ä½ å¯èƒ½å°±ä¼šçœ‹åˆ°ä¸€å¤§æ³¢åŸºäºGLM-4.6Vçš„å‚ç›´åº”ç”¨å¦‚é›¨åæ˜¥ç¬‹èˆ¬å†’å‡ºæ¥ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-08_22.57.16-1024x601.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-08_22.57.16-1024x601.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0e75bd61b2247b9b944575f5c379ff8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811240&amp;x-signature=Hh6Tm%2BxiQQxhpoJiVH4OnxxZPjo%3D" alt="iShot_2025-12-08_22.57.16" loading="lazy"/></a></p>
<p><strong>å†™åœ¨æœ€å</strong></p>
<p>åœ¨2025å¹´è¿™ä¸ªèŠ‚ç‚¹ï¼Œå•çº¯æ¯”æ‹¼OCRå‡†ç¡®ç‡æˆ–è€…è¯†å›¾èƒ½åŠ›çš„æ—¶ä»£å·²ç»è¿‡å»äº†ã€‚GLM-4.6Vçš„å‡ºç°ï¼Œæ ‡å¿—ç€å¤šæ¨¡æ€æ¨¡å‹å¼€å§‹å‘â€œè¡ŒåŠ¨æ´¾â€è½¬å‹ã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œç°åœ¨æœ€å¤§çš„é—®é¢˜ä¸å†æ˜¯â€œæ¨¡å‹èƒ½ä¸èƒ½çœ‹æ‡‚è¿™å¼ å›¾â€ï¼Œè€Œæ˜¯â€œæ—¢ç„¶å®ƒèƒ½çœ‹æ‡‚ä¹Ÿèƒ½æ“ä½œï¼Œæˆ‘ä»¬èƒ½ç”¨å®ƒåˆ›é€ å‡ºä»€ä¹ˆæ ·çš„æ–°ç‰©ç§ï¼Ÿâ€</p>
<p>å¤§æ¨¡å‹çš„ä¸‹åŠåœºï¼Œæ‹¼çš„æ˜¯è½åœ°ï¼Œè€ŒGLM-4.6Vï¼Œæ˜¾ç„¶å·²ç»æŠŠæ¢¯å­æ¶å¥½äº†ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¶Šæ¥è¶Šå¯¹ AI åšçš„ PPT æ•¬ä½©äº†ï¼ï¼ˆé™„7å¤§ç”¨æ³•ï¼‰]]></title>    <link>https://juejin.cn/post/7581314241410793507</link>    <guid>https://juejin.cn/post/7581314241410793507</guid>    <pubDate>2025-12-08T15:06:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581314241410793507" data-draft-id="7581299982671740962" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¶Šæ¥è¶Šå¯¹ AI åšçš„ PPT æ•¬ä½©äº†ï¼ï¼ˆé™„7å¤§ç”¨æ³•ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T15:06:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä½•"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¶Šæ¥è¶Šå¯¹ AI åšçš„ PPT æ•¬ä½©äº†ï¼ï¼ˆé™„7å¤§ç”¨æ³•ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä½•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:06:08.000Z" title="Mon Dec 08 2025 15:06:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯è‹ä½•çš„ç¬¬ 455 ç¯‡åŸåˆ›ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å¿™ç€åš PPT çš„è‹ä½•ã€‚</p>
<p>å¹´åº•äº†ï¼Œåˆåˆ°äº† PPT æ•´æ´»çš„æ—¶å€™äº†ã€‚</p>
<p>æˆ‘å°è±¡å¾ˆæ·±åˆ»ï¼Œå½“å¹´æˆ‘çš„å¸ˆå…„ä¸ºäº†æ•™è‚²æˆ‘è¿™ä¸ªæ–°å…µè›‹å­ï¼Œè®©æˆ‘æ”¹äº† 2 ä¸ªæ˜ŸæœŸçš„ PPTã€‚</p>
<p>è¯´çœŸçš„ï¼Œå½“æ—¶æ˜¯éå¸¸æƒ³æ¶ç‹ ç‹ çš„æœç€ä»–æ”¾ä¸ªæ¯’å±ï¼Œç„¶åæ‹æ‹å±è‚¡èµ°äººã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e48677c90824a889e4ed0d71d386a1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=7g%2FdxlXTzy538Y%2BRogPBranupBE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½†æœ€åæˆ‘å´éå¸¸æ„Ÿæ¿€ä»–ï¼Œè®©æˆ‘è¿™ä¸ªè€ç™»ç”¨ä¸€ä»½ä¼˜ç§€çš„ PPT åˆåœ¨å¤§å‚è‹Ÿæ´»äº†å¥½ä¸€é˜µå­ã€‚</p>
<p>ç°åœ¨å¥½äº†ï¼Œæœ‰äº† AI åš PPTï¼Œå†ä¹Ÿä¸ç”¨çæŠ˜è…¾äº†ã€‚è€Œä¸”ç°åœ¨æ•ˆæœæ˜¯è¶Šæ¥è¶Šå¥½ï¼Œå¥½åˆ°æˆ‘éƒ½ä¸å¾—ä¸æ•¬ä½©çš„ç¨‹åº¦ã€‚</p>
<p>æˆ‘å…ˆæ”¾å‡ ä¸ªä¾‹å­ï¼Œå¤§å®¶å…ˆæµ…æµ…æ„Ÿå—ä¸€ä¸‹ã€‚</p>
<p>å…ˆæ¥ä¸ªå¹´ç»ˆæ±‡æŠ¥å§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03a0bca2db644f3c9b4547d71ca118d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=2hU5cE0iFqjK4RWOs3aDYAlOSek%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å†æ¥ä¸ªæœ‰æ·±åº¦çš„ï¼Œè¶³è¶³æœ‰ 53 é¡µï¼Œå…¨æ˜¯ AI åšçš„ğŸ˜„</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd9cee32189a411093031a121c899f35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=1ojaUixqoABncnzBGA6OGS6brJg%3D" alt="wxv_4279470519826776071" loading="lazy"/></p>
<p>è§‰å¾—å¤ªæ¯ç‡¥ï¼Œè¿˜æœ‰å¥½ç©çš„ç‰ˆæœ¬ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83560926e27d45b794cde6922df4493e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=niQHrrErfmuQb8FWxiNvi%2B1ARb4%3D" alt="wxv_4279471289430966274" loading="lazy"/></p>
<p>æ¥å§ï¼Œç»§ç»­æ•´æ´»ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce780abfab784f0fa31cc38d217feed5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=6qzJkXcv0NTT5uevROIbDmkqcBY%3D" alt="wxv_4279472035279323141" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bc7b9f15ba64cfc81c8403a45de433b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=2wg9xHovjfoND%2BtM6%2FkuGRKQ5%2BI%3D" alt="wxv_4279473040351559682" loading="lazy"/></p>
<p>æƒ³ç”¨ PPT ç»“åˆçƒ­ç‚¹ï¼Ÿé‚£å°±æ¥ä¸ªç–¯ç‹‚åŠ¨ç‰©åŸç‰ˆæœ¬çš„ PPTï¼Œä¸€æ¬¡æ¥ä¸ªè¿‡ç˜¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad0b29533fc1493e8c7d1a9772a35d27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=Fwj13i2tR4kFKwo20UpOJNb1DIo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç°åœ¨èƒ½åš PPT çš„ AI å·¥å…·æ•°ä¸èƒœæ•°äº†ï¼Œæ•ˆæœä¹Ÿå¤§ä¸ç›¸åŒï¼Œè¿™ä¸€ç¯‡å°±ç»™å¤§å®¶åˆ†äº«ä¸€æ³¢æˆ‘è®¤ä¸ºè¿˜ä¸é”™çš„ AI PPT å·¥å…·ã€‚</p>
<blockquote>
<p>åŸåˆ›ä¸æ˜“ï¼Œè·ªæ±‚ä¸‰è¿ï¼Œå¹¶åˆ†äº«ç»™æœ‰éœ€è¦åš PPT çš„æœ‹å‹å­ã€‚</p>
</blockquote>
<p>æˆ‘å°±å…ˆæŒ‰ç…§æ—¶é—´å€’åºå§ï¼Œå…ˆä»¥æœ€è¿‘ä½¿ç”¨æœ€å¤šçš„å¼€å§‹å§ã€‚</p>
<h2 data-id="heading-0">NotebookLM</h2>
<p>NotebookLM æ˜¯è°·æ­Œæ¨å‡ºçš„çŸ¥è¯†åº“å·¥å…·ï¼Œèƒ½å¤Ÿä¸Šä¼ ä»»æ„æ–‡æ¡£ç”šè‡³æ˜¯è§†é¢‘ URLï¼ŒåŸºäºçŸ¥è¯†åº“å¯ä»¥ AI é—®ç­”ï¼Œå¯ä»¥åšæ€ç»´å¯¼å›¾ï¼Œä¿¡æ¯å›¾ã€é—ªå¡ã€æ’­å®¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da47209d9c92480bb41e8682a3448101~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=WSv5SvTgeqPwFF0HwHopMJf%2B%2F84%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>NotebookLM çš„åº•åº§ç”¨çš„å°±æ˜¯è°·æ­Œè‡ªå·±çš„ Geminiï¼Œç°åœ¨é›†æˆäº† Nano Banana Proï¼Œå¯ä»¥è¯´æ˜¯ç›´æ¥åŸåœ°èµ·é£ï¼ŒåŸºäºçŸ¥è¯†åº“ç›´æ¥åš PPTã€‚</p>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸€ä»½ä¼˜è´¨çš„ PPT ä¸€å®šæ˜¯åŸºäºå¤šç§æ•°æ®æºçš„ï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬çš„å·¥ä½œæˆæœï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ç½‘ä¸Šä¼˜è´¨çš„èµ„æ–™ã€‚</p>
<p>æ‰€ä»¥ï¼ŒNotebookLM åšå‡ºæ¥çš„ PPT æ˜¯åŸºäºçŸ¥è¯†åº“çš„ï¼Œé…åˆ Nano Banana Proï¼Œå¯ä»¥è‡ªå®šä¹‰å„ç§é£æ ¼ã€‚</p>
<p>æˆ‘å½•äº†ä¸ªæ“ä½œè§†é¢‘ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸‹ï¼Œå…¶å®éå¸¸ç®€å•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c7d98c7bc784d059c5960cb558fe8c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=eDWysBELGe9DNfrgn%2FNCPK%2Fun1o%3D" alt="wxv_4279474055037943813" loading="lazy"/></p>
<p>åœ¨æ¼”ç¤ºæ–‡ç¨¿è¿™é‡Œç‚¹å‡»ç¼–è¾‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91d0bb51810146359a5b7e0cfc7cfdaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=mwcdwpqbpxGEHvnBq44OjJS8ABc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è‡ªå®šä¹‰æ¼”ç¤ºæ–‡ç¨¿ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fece482530db4c6587c63ee586bd7f64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=oTjiqRUX6ljHbzHgaI%2BEDIQNlv4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤šè¯­è¨€ä¹Ÿæ˜¯ä¸åœ¨è¯ä¸‹ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©ç®€ä½“ä¸­æ–‡ï¼Œå‡ºæ¥çš„å°±æ˜¯ä¸­æ–‡ç‰ˆæœ¬çš„ PPT äº†ã€‚</p>
<p>æ ¼å¼çš„è¯ä¸€å…±åˆ† 2 ç§ï¼Œåˆ†åˆ«æ˜¯è¯¦ç»†æ¼”ç¤ºæ–‡æ¡£å’Œæ¼”ç¤ºè€…å¹»ç¯ç‰‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e9fc3d08586473f9eb15a9c9d6479df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=qxu1JS4dcb6iKllzy%2BLOa9liNGA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä¸€èˆ¬é€‰æ‹©è¯¦ç»†æ¼”ç¤ºæ–‡æ¡£ï¼Œå‡ºæ¥çš„ä¼šæ›´å…¨ä¸€äº›ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">åœ°å€ï¼šhttps:<span class="hljs-comment">//notebooklm.google.com/</span>
</code></pre>
<h2 data-id="heading-1">Kimi å›½é™…ç‰ˆ</h2>
<p>ä¸ç’ä½ è¯´ï¼Œæœ€è¿‘åˆ· Xï¼Œçœ‹åˆ° Kimi åœ¨å›½é™…ç‰ˆå·å·ä¸Šçº¿äº†åŸºäº Nano Banana Pro çš„ PPT æ¨¡å¼ï¼Œè¿˜èƒ½ç›´æ¥åœ¨çº¿ç¼–è¾‘ã€‚</p>
<p>äºæ˜¯æˆ‘ä½“éªŒä¸€æ³¢åï¼Œéå¸¸å…´å¥‹çš„åœ¨ X åšäº†åˆ†äº«ï¼Œå–å¾—äº† 3.2 ä¸‡çš„é˜…è¯»å’Œ 464 çš„å–œæ¬¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/570b94d4eab544c8a2a18c7793a40380~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=YsTG3%2FEKthzkTrdRTnAcfrZP%2FRY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘æŠŠåŸè§†é¢‘ä¹ŸåŒæ­¥ç»™æˆ‘äº²çˆ±çš„å…¬ä¼—å·è¯»è€…æœ‹å‹ä»¬ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84c81201f97a47ea8e6c99d1e0e52615~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=C6RY3JhEgXYFiF4Yunrg6bU%2BTXs%3D" alt="wxv_4279474953054846987" loading="lazy"/></p>
<p>è¿™é‡Œæƒ³åæ§½ä¸‹ï¼Œè¿™ä¸ªå›½é™…ç‰ˆçš„ä½“éªŒï¼Œå¾€å¾€å¡åœ¨äº†ç¬¬ä¸€æ­¥ï¼Œå› ä¸ºï¼Œå¦‚æœä¸è¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œä½ å¤§æ¦‚ç‡æ°¸è¿œè¿›çš„æ˜¯å›½å†…ç‰ˆï¼Œè€Œå›½å†…ç‰ˆè¿˜æ²¡ä¸Šçº¿è¿™ä¸ªæ¨¡å¼ã€‚</p>
<p>ä¸€å®šè¦å¼€å¯å…¨å±€ä»£ç†ï¼Œç„¶åé€šè¿‡è°·æ­Œæœç´¢ kimiï¼Œè¿›å…¥å®˜ç½‘ï¼Œå°±å¯ä»¥çœ‹åˆ° PPT æ¨¡å¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c501ead8bca449a9ffa812536e37e1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=Ky%2BgEXMHd%2FaExTIlBVOVvy9mfOQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŒæ ·æ”¯æŒé€šè¿‡é™„ä»¶æ¥è½¬ PPTï¼Œæ¯”å¦‚æˆ‘ä¸Šä¼ äº†æˆ‘åˆ†äº«çš„ã€Šå…¬ä¼—å·æµé‡ç„å­¦ã€‹è¿™ä¸ª pdf èµ„æ–™ï¼Œç„¶åæ·¡å®šçš„è¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼š</p>
<pre><code class="hljs">ä½¿ç”¨æ‹‰å¸ƒå¸ƒé£æ ¼çš„ä¸»é¢˜æ¥ç”Ÿæˆè¯¥é™„ä»¶ä¸­çš„PPTå†…å®¹ï¼Œè§£æé™„ä»¶å†…å®¹ï¼Œè®¾è®¡æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼šÂ 
1ã€ä¸“ä¸šåº¦é«˜
2ã€æ’ç‰ˆç²¾è‡´Â 
3ã€é…å›¾å’Œä¿¡æ¯å›¾è¦åˆç†æ­é…Â 
4ã€å®¡ç¾åœ¨çº¿Â 
5ã€PPTå†…å®¹ç”¨ä¸­æ–‡ï¼Œæ–‡å­—ä¸å®œå¤ªå¤šï¼Œé€‚åˆä¸ºä¸»ã€
</code></pre>
<p>å…ˆæ˜¯ç”Ÿæˆå¤§çº²ï¼Œç„¶åé€‰æ‹©é¦™è•‰æ¨¡å¼ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4a695c637d54a618c7ce55d14b6a447~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=9moMhz9ABCI%2Bf%2FxiplzWk%2FJVsjI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€åå‡ºæ¥å°±æ˜¯ä½ çœ‹åˆ°çš„è¿™ä¸ªæ•ˆæœäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0273bca6ba494b6f8eba3f09dd7cd3f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=P4jB90I7SHLDmj3k5bUK1VINwww%3D" alt="wxv_4279472035279323141" loading="lazy"/></p>
<p>ç„¶åå¯ä»¥ç›´æ¥åœ¨çº¿ç¼–è¾‘è¿™ä¸ªæ ·å¼å’Œæ–‡å­—ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79ae3d0f419b4f1e8102a91f3d689010~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=Qhml3lH7FZDl6m9LHfPyQHMb2rg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸è¿‡è¿™é‡Œæ•´ä½“å­—ä½“å’Œæ’ç‰ˆä¼šæœ‰è½»å¾®å˜åŒ–ã€‚</p>
<p>ç„¶åä¹Ÿå¯ä»¥å¯¼å‡º PPT æ ¼å¼ï¼Œå¯æƒœæ²¡æ³•æœ¬åœ°æ‰“å¼€ç¼–è¾‘æ–‡å­—ï¼Œè¿™è¦æ˜¯ okï¼Œé‚£ PPT çš„å¤©çœŸçš„å®Œå…¨è¢«æ…äº†ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">åœ°å€ï¼šhttps:<span class="hljs-comment">//www.kimi.com/slides</span>
</code></pre>
<h2 data-id="heading-2">Skywork</h2>
<p>Skywork æ˜¯ä¸“é—¨ä¸º office è€Œç”Ÿçš„åŠå…¬ç±» Agentï¼Œä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡è¯„æµ‹æ–‡ç« ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆç»™åŠ›çš„ã€‚</p>
<p>åœ¨è¿™ä¸ªåœ°æ–¹æ‰“å¼€ PPT æ¨¡å¼ï¼Œç„¶åè¾“å…¥è‡ªå·±çš„éœ€æ±‚ï¼Œç­‰å¾…ç€ç”Ÿæˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9bb2604110440b4ab7fad6b7ba5f07f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=n53CIKm0NQiJkJsKj8L62ELMeq0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸è¿‡ Skywork è¦ç”Ÿæˆå¤šå¼  PPT ä¼šæ˜¾å¾—æœ‰äº›æ…¢ï¼Œä½†æ•´ä¸ªæ·±åº¦éå¸¸ä¸é”™ï¼Œè¿˜å¯ä»¥ç”¨å„ç§ MCP å·¥å…·ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dc61599a07a47948bf1e37a1dd8dddb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=mCMgUUv%2BleGlkUKAGED0C5fdzus%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Skywork æ˜¯å¤©å·¥ AI æ——ä¸‹çš„ï¼Œåœ¨è¿™æ–¹é¢ç¡®å®åšäº†éå¸¸å¤šçš„ç»†èŠ‚ï¼Œç°åœ¨ç”šè‡³å·²ç»èƒ½æ”¯æŒ YouTube è§†é¢‘é“¾æ¥ç›´æ¥è½¬æ–‡æ¡£ã€PPTã€æ’­å®¢äº†ã€‚</p>
<p>ä¹‹å‰ä¹Ÿå†™è¿‡æ•™ç¨‹ï¼Œå¤§å®¶å¯ä»¥å»çœ‹çœ‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">åœ°å€ï¼šhttps://skywork.ai/?<span class="hljs-attr">skill_id</span>=<span class="hljs-number">106</span>
</code></pre>
<h2 data-id="heading-3">Genspark</h2>
<p>å’Œ Skywork ç±»ä¼¼ï¼ŒGenspark ä¹Ÿæ˜¯åŠå…¬ç±»çš„ Agentï¼Œä½†å…¶ä»¥ä¼˜è´¨çš„ PPT äº§å‡ºèƒ½åŠ›è€Œå‡ºåã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0a719d0875f476384fb08f03870519c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=L7nvvYsRVcTMo3C2Oj4cvUlYeTs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æŠ›å»åˆ«çš„ä¸è¯´ï¼Œå…¶å‡ºæ¥çš„æ•ˆæœæ˜¯çœŸçš„å¥½å•Šï¼Œä½ åœ¨æ–‡é¦–çœ‹åˆ°çš„å‡ ä¸ªæƒŠè‰³çš„ PPT å°±æ˜¯ Genspark ç”Ÿæˆçš„ï¼Œæ˜¯è¶³è¶³ 53 é¡µå•Šï¼Œä¸€æ¬¡ç”Ÿæˆï¼Œæˆ‘çš„å¤©ã€‚</p>
<p>ä½†é¡µæ•°å¤šäº†ï¼Œå…è´¹ç§¯åˆ†å°±ä¸å¤Ÿç”¨äº†ï¼Œå°±å¾—èŠ±é’±ã€‚</p>
<p>ä¹Ÿæ˜¯ï¼Œä¸ºæˆæœä¹°å•å˜›ï¼Œåªæ˜¯æ„Ÿè§‰è‡ªå·±å…‰èŠ±åœ¨æ¯ä¸ªæœˆçš„è®¢é˜…ä¸Šå°±ä¸å°‘äº†ï¼Œå“ˆå“ˆå“ˆã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">åœ°å€ï¼šhttps:<span class="hljs-comment">//www.genspark.ai/</span>
</code></pre>
<h2 data-id="heading-4">GenFlow</h2>
<p>æ¥è‡ªç™¾åº¦æ–‡åº“çš„ GenFlow äº§å“ï¼Œæˆ‘çš„æ„Ÿå—æ˜¯ï¼šå¿«ã€‚</p>
<p>æ˜¯çœŸçš„è¶…çº§å¿«ï¼Œåœ¨æ‰‹æœºä¸Šå°±å¯ä»¥åŠ¨åŠ¨æ‰‹ï¼Œä¸€ä¸‹å­å°±å‡ºæ¥äº† PPTã€‚ç„¶åå¯ä»¥é€‰æ‹©è‡ªå®šä¹‰é£æ ¼ã€‚</p>
<p>æ¯”è¾ƒé€‚åˆå‡ºé—¨åœ¨å¤–ï¼Œæ€¥éœ€ PPT åº”ä»˜çš„åœºæ™¯ã€‚</p>
<p>å¯¼å‡ºçš„è¯ä¹Ÿä¸ä¼šä¹±ç ï¼Œè¿™æ˜¯æ¯”è¾ƒé‡è¦çš„ã€‚</p>
<p>ä¹‹å‰åšçš„åœ¨ 1.0 ç‰ˆæœ¬ PPTï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84d4c827f4514cfd8406d7784a7e7d9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=TPjJc2VdHI95HDhoZnLqM0KsVIw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ°å€çš„è¯ç›´æ¥æ‰‹æœºç”¨æœ€æ–°ç‰ˆçš„ç™¾åº¦æ–‡åº“å°±å¯ä»¥æ‰“å¼€äº†ã€‚</p>
<h2 data-id="heading-5">Agnes</h2>
<p>Agnes ä¹‹å‰æˆ‘ä¹Ÿæ¨èè¿‡ï¼ŒPPT å‡ºæ¥çš„æ•ˆæœå¾ˆå¥½ï¼Œæœ€å‰å®³çš„æ˜¯å¯ä»¥åšåˆ°è·¨ç«¯ä»»åŠ¡åŒæ­¥ã€‚</p>
<p>å°±æ˜¯æˆ‘åœ¨ web ç«¯å‘å¸ƒä¸€ä¸ª PPT ä»»åŠ¡ï¼Œç”šè‡³å¯ä»¥åœ¨æ‰‹æœº APP ç«¯éšæ—¶ä¿®æ”¹å’Œå–æ¶ˆã€‚</p>
<p>ç®€ç›´æ˜¯ä¸ºæˆ‘è¿™ç§é¡¶çº§ç‰›é©¬é‡èº«å®šåˆ¶ï¼Œè¿™ä¸‹å¥½äº†ï¼Œæ‹‰å±ä¹Ÿå¯ä»¥åš PPT äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a562a62ca2d5465cab626ec6ac92e439~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=EKsM%2BoltPMzxIDTgeck571dSYrs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ•ˆæœå¾ˆå¥½ï¼Œé¢œå€¼ä¹Ÿåœ¨çº¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0357acad485346778bb5e5d1f29a439f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=PFwXaZsKD8IKn0CkiwL720zMsJ4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥ç›´æ¥ç”Ÿæˆ PPT éœ€è¦çš„å›¾ç‰‡ç´ æï¼Œç„¶ååœ¨ Agnes é‡Œé¢åŸºäºå›¾ç‰‡ç´ æåˆæˆæƒ³è¦çš„ PPTã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9cd22d00ebd64d82b9fe8d875082840b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=PH5stNMVPAeUxY%2FmAQixp%2Fwz%2BAs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹è‹ä½•ä¹‹å‰çš„æ–‡ç« ï¼Œæœ‰ä¸€äº›ä½¿ç”¨ï¼Œè¿˜æ˜¯è§‰å¾—å¾ˆä¸é”™çš„ï¼Œç„¶åæœ‰ä¸å°‘å°ä¼™ä¼´åé¦ˆä¹Ÿæ˜¯ï¼ŒAgnes èƒ½è¾¾åˆ°åš PPT çš„è¦æ±‚ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">åœ°å€ï¼šhttps:<span class="hljs-comment">//app.agnes-ai.com/</span>
</code></pre>
<h2 data-id="heading-6">æ‰£å­ç©ºé—´</h2>
<p>å­—èŠ‚æ——ä¸‹çš„é€šç”¨ Agent äº§å“ï¼Œåœ¨ PPT åˆ›ä½œä¸Šä¹Ÿæœ‰ä¸¤æŠŠåˆ·å­ã€‚ç›´æ¥æ‰“å¼€ PPT æ¨¡å¼ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e199f17c99c4cd28f9a8d9a4edfe484~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=b5u0QTcmNYvH1K%2FL%2FPfFiZpheLQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŒæ ·æ”¯æŒä¸Šä¼ æ–‡æ¡£ï¼Œç”Ÿæˆæ¨¡å¼å¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚</p>
<p>æœ‰ä¸€ä¸ªäº®ç‚¹çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥åŸºäº PPT é£æ ¼åšå‚è€ƒï¼Œè¿™ä¸ªå°±å¾ˆå¼ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b54b815055aa4f21ba7c800e1b598cf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811168&amp;x-signature=wjhj3bdOwMWn2KC5c3hpfC7llg4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å› ä¸ºå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬æ˜æ˜è„‘è¢‹é‡Œé¢æƒ³è¦çš„æ•ˆæœå’Œå®é™…äº§å‡ºä¸åŒï¼Œå¤§æ¦‚ç‡æ˜¯é£æ ¼ä¸å¯¹äº†ã€‚</p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸Šä¼ å–œæ¬¢çš„é£æ ¼æ¨¡æ¿ï¼Œç„¶åä¸Šä¼ è‡ªå·±çš„æ–‡ä»¶ï¼Œè¾“å…¥ä¸»é¢˜ï¼Œé€‰æ‹©ç”Ÿæˆçš„æ¨¡å¼ã€‚</p>
<p>æ‰£å­ç©ºé—´å°±èƒ½ç»™ä½ ä¸€ä¸ªä¸é”™çš„æ•ˆæœã€‚</p>
<p>å½“ç„¶äº†ï¼Œç°åœ¨ AI PPT å·¥å…·è¿œä¸æ­¢è¿™äº›ï¼Œæœ‰å¯èƒ½ä¾æ—§æœ‰ä¸å°‘æ˜¯å¾ˆäº®çœ¼ä½†æ²¡è¢«æ”¾è¿›æ¥çš„ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶è¯„è®ºåŒºè¡¥å……ã€‚</p>
<p>å·¥å…·è¿™ä¹ˆå¤šï¼Œæ¯ä¸€ä¸ªéƒ½å»ä½¿ç”¨ï¼Œæ˜¯ä¸ç°å®çš„ã€‚</p>
<p>æŒ‘ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ã€æ•ˆæœ nice çš„ï¼Œå»ä½¿ç”¨ï¼Œæˆ‘è§‰å¾—æ˜¯æ›´å¥½çš„ã€‚</p>
<p>æ¯•ç«Ÿå·¥å…·åªèƒ½è§£å†³ä½ äº§å‡ºçš„é—®é¢˜ï¼Œä½†æ— æ³•è§£å†³æƒ³è¦ä»€ä¹ˆçš„é—®é¢˜ã€‚</p>
<p>å®šä¹‰é‚£ä¸ªé—®é¢˜çš„äººï¼Œæ¯” AI å·¥å…·æœ¬èº«æ›´é‡è¦ã€‚</p>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è‹ä½•ï¼Œæ„Ÿè°¢å…³æ³¨ï¼Œæˆ‘ä»¬ä¸‹ä¸€æœŸè§å•¦ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini 3 åˆšåˆ·å±ï¼Œèš‚èšçµå…‰åˆæ•´æ´»ï¼šä¸€å¥è¯ç”Ÿæˆã€Œé—ªæ¸¸æˆã€]]></title>    <link>https://juejin.cn/post/7581348660823670784</link>    <guid>https://juejin.cn/post/7581348660823670784</guid>    <pubDate>2025-12-08T15:13:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581348660823670784" data-draft-id="7581348660823654400" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini 3 åˆšåˆ·å±ï¼Œèš‚èšçµå…‰åˆæ•´æ´»ï¼šä¸€å¥è¯ç”Ÿæˆã€Œé—ªæ¸¸æˆã€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T15:13:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä½•"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini 3 åˆšåˆ·å±ï¼Œèš‚èšçµå…‰åˆæ•´æ´»ï¼šä¸€å¥è¯ç”Ÿæˆã€Œé—ªæ¸¸æˆã€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä½•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:13:32.000Z" title="Mon Dec 08 2025 15:13:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯è‹ä½•çš„ç¬¬ 456 ç¯‡åŸåˆ›ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åˆå†æ¬¡ç©ç–¯äº†çš„è‹ä½•ã€‚</p>
<p>å…¶å®ï¼Œä¸Šå‘¨çµå…‰åˆ·å±æœ‹å‹åœˆçš„äº‹ï¼Œæˆ‘æŒºæ„§ç–šçš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e904544b8caa4187b1652a0ff1389879~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=xgIqhl3ocEuKW%2FN%2FvbnDACVnCDE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½œä¸ºè€ä¸œå®¶åœ¨ AI è‡ªåª’ä½“æœ€ä¼˜ç§€çš„åŒå­¦ï¼ˆå‘¸ï¼Œä¸è¦è„¸ï¼‰ï¼Œæˆ‘å±…ç„¶ä¸å‡‘çƒ­é—¹ï¼Œç”šè‡³ï¼Œæˆ‘çš„ä¸å°‘èš‚èšåŒå­¦æ‹¿ç€çš®é­å­æ¥é—®æˆ‘ï¼šä¸ºå•¥ä¸å†™çµå…‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4faa921f6ff4d8b87722009e0f82cfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=6bTpqss078RiJvj94gEC%2FF%2BBILU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è®²çœŸï¼Œè¿˜æŒºè¿‡æ„ä¸å»çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘å¿…é¡»æ¥å¥½å¥½å†™ä¸€ç¯‡èš‚èšçš„çµå…‰ã€‚</p>
<p>åˆšå¥½çœ‹åˆ°åˆä¸Šçº¿äº†ä¸ªå¥½ç©çš„åŠŸèƒ½ï¼Œä¸€å¥è¯ç”Ÿæˆå¯ä¿®æ”¹çš„å°æ¸¸æˆï¼Œä½“éªŒä¸‹æ¥ï¼Œå¾ˆä¸Šå¤´ã€‚ä½ ä¸€å®šè¦çœ‹åˆ°æœ€åã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹çµå…‰ç©¶ç«Ÿæ˜¯ä¸ªå•¥å§ã€‚</p>
<p>çµå…‰æ˜¯èš‚èšé›†å›¢æ¨å‡ºçš„<strong>å…¨æ¨¡æ€é€šç”¨ AI åŠ©æ‰‹</strong>ï¼Œæ”¯æŒå…¨æ¨¡æ€äº¤äº’ï¼Œæ”¯æŒæ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€3Dæ¨¡å‹ç­‰å¤šç§ä¿¡æ¯è¾“å‡ºå½¢å¼ã€‚è¿˜å¯ä»¥æœ€å¿« 30 ç§’ç”Ÿæˆå°åº”ç”¨å’Œå°æ¸¸æˆã€‚</p>
<p>11æœˆ18æ—¥åŒæ—¶ä¸Šçº¿å®‰å“å’Œè‹¹æœåº”ç”¨å•†åº—ï¼Œæ®å®˜æ–¹æ¶ˆæ¯ï¼Œä¸Šçº¿å³ç«çˆ†ï¼Œ6 å¤©ä¸‹è½½é‡è¶… 200 ä¸‡ï¼Œé€Ÿåº¦è¶…è¿‡ ChatGPT å’Œ Sora2ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/499cec94ce5a41c0a6bdd8b688372b89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=i8TkaEkSN6Cg8leD5sbjSxf0GhI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘éª„å‚²äº†ï¼Œè™½ç„¶ä¸å…³æˆ‘é¸Ÿäº‹ã€‚</p>
<p>å…¶ä¸­æ®è¯´çµå…‰çš„é—ªåº”ç”¨åŠŸèƒ½å¤‡å—ç”¨æˆ·å–œçˆ±ï¼Œæœ¬æ¬¡æ¨å‡ºçš„é—ªæ¸¸æˆä¹Ÿæ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½ï¼ˆçµå…‰é—ªåº”ç”¨ï¼‰é‡Œçš„åœºæ™¯åŠŸèƒ½å‡çº§ã€‚</p>
<p>è€Œä¸”æˆ‘çœ‹åˆ° AI ç¾¤é‡Œçš„æ—©æŠ¥æ¶ˆæ¯è¯´çµå…‰ä¸Šçº¿ä¸¤å‘¨ï¼Œç”¨æˆ·åˆ›å»ºäº† 330 ä¸‡ä¸ªé—ªåº”ç”¨ï¼Œä¸æ˜¯ï¼Œåˆç€ï¼Œè¿™ä¹ˆçŒ›å•Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d220152b9ed9460990e9dc89da34e7e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=XToU%2FzItWg8uphQnVHqvLTU0nyU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ææ€•æ˜¯ç»§ Gemini3 å’Œé¦™è•‰ä¹‹ååˆä¸€ç‚¸åœºçš„ AI åº”ç”¨ã€‚æ‰€ä»¥æˆ‘ä¸èƒ½å¤©å¤©ä¸åŠ¡æ­£ä¸šç©é¦™è•‰äº†ï¼Œæˆ‘ä¹Ÿè¦å¥½å¥½æ¥ç©ä¸‹çµå…‰ã€‚</p>
<p>æ‰‹æœº APP Store ä¸‹è½½çµå…‰åï¼Œæ”¯ä»˜å®ç™»å½•ï¼Œæ‰“å¼€å³ä¸Šè§’çš„ã€Œé—ªåº”ç”¨ã€ï¼Œç‚¹å‡»é»˜è®¤çš„æ”¾ä¸ªçƒŸç«ç»™æˆ‘çœ‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bcfc22c12b94393a47568444e4725e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=%2BHMxYgfVRMwDBiBkD3dYzic1Ohc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å‡ºæ¥çš„è¿™ä¸ªåº”ç”¨çœŸçš„å¾ˆå¥½ï¼Œè¿˜å¸¦äº†éŸ³æ•ˆï¼Œè¿‡å¹´çš„æ°›å›´å°±æœ‰äº†ï¼Œä½ æ„Ÿå—ä¸€ä¸‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a87a414ef9f4471b9610f7687ac357cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=TpPNmjfJNYmv%2BfVH%2FPiQWqS%2Foqg%3D" alt="wxv_4281228201873227779" loading="lazy"/></p>
<p>è€Œè¿™ä¸ªå°åº”ç”¨çš„æç¤ºè¯æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs">åšä¸€ä¸ªæ”¾çƒŸèŠ±çš„åº”ç”¨ï¼Œè¦æ±‚ï¼š Â 
è¯·ä»¥æµªæ¼«æ²‰æµ¸å¼å¤œç©ºå¥‡è§‚é£æ ¼ç”Ÿæˆå¯äº’åŠ¨çš„çƒŸèŠ±æ•ˆæœï¼Œè‰²å½©ç»½æ”¾éœ€çµåŠ¨å¤šå±‚ã€æœ‰éšæœºæƒŠå–œï¼›åŠ å…¥è½»ç›ˆç‚¸è£‚éŸ³æ•ˆä¸å›å“ã€‚
æ•´ä½“ç”»é¢éœ€æ¢¦å¹»ã€ç¾è§‚ã€å¯Œæœ‰èŠ‚å¥æ„Ÿï¼Œæ¯æ¬¡æ”¾çƒŸèŠ±éƒ½æœ‰ä¸€å¥è±¡å¾ç¥ç¦æˆ–å¥½è¿çš„çŸ­å¥ï¼ˆä¸è¶…è¿‡15å­—ï¼‰Â 
</code></pre>
<p>ä¸ºäº†é˜²æ­¢æ˜¯åå°ä½œå¼Šï¼Œæˆ‘å†³å®šä¾æ¬¡ä¸Šéš¾åº¦ï¼Œæ¥æ•´ç‚¹æ´»ã€‚</p>
<p>å…ˆæ•´ä¸ªç»å…¸å¼€å¿ƒæ¶ˆæ¶ˆä¹å°æ¸¸æˆå§ã€‚</p>
<blockquote>
<p>æç¤ºè¯ï¼šåšä¸€ä¸ªå¼€å¿ƒæ¶ˆæ¶ˆä¹æ¸¸æˆ</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œçµå…‰æ¥å—åˆ°è¯·æ±‚åï¼Œå¼€å§‹è®¾è®¡ã€æ„å»ºæ¸¸æˆç•Œé¢æ¡†æ¶ã€å¼€å‘ï¼Œç”šè‡³æœ€åç›´æ¥åº”ç”¨éƒ¨ç½²ï¼Œ30 ç§’å°±å‡ºæ¥äº†ä¸€ä¸ªå¯ä»¥ç›´æ¥ç©çš„å¼€å¿ƒæ¶ˆæ¶ˆä¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfb6d925dc3049a582ad052c367fd82c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=lBXKH%2B3swwiqVeNxo1KNs29%2BWHE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”šè‡³è¿˜å¯ä»¥å¤åˆ¶é“¾æ¥åˆ†äº«ç»™å¥½å‹æ¥ç©ã€‚å¥½å®¶ä¼™ï¼Œä½†ä¾æ—§æœ‰ä¸€äº›å°é—®é¢˜ï¼Œæ¯”å¦‚ç›¸é‚»çš„æ»‘å—ä¹‹é—´ç†è®ºä¸Šæ˜¯äº’ç›¸æ»‘åŠ¨ï¼Œè€Œä¸æ˜¯äº¤æ¢ã€‚</p>
<p>äºæ˜¯æˆ‘åˆç»§ç»­ä¿®æ”¹ï¼š</p>
<pre><code class="hljs">ä¿®æ”¹ä¸¤ä¸ªé—®é¢˜ï¼šÂ 
1ã€å¿ƒå½¢æ»‘å—æ”¹ä¸ºå°åŠ¨ç‰©å¤´åƒæ»‘å—ï¼›Â 
2ã€ç›¸é‚»çš„æ»‘å—çš„ä¹‹é—´å¯ä»¥äº’ç›¸æ»‘åŠ¨ï¼Œè€Œä¸æ˜¯äº¤æ¢Â 
</code></pre>
<p>æ•ˆæœç«‹é©¬å‡ºæ¥äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/103aee16329749bcaac69e983e2f9bae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=13Ygv8TQ6EBlTIhDbRaO1kGH6IQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åç»§ç»­ç”¨æ–‡å­—è¿½åŠ åŠŸèƒ½ï¼Œæ¥ç‚¹å…³å¡å§ï¼Œæç¤ºè¯ï¼š</p>
<pre><code class="hljs">ä»¥å…³å¡çš„å½¢å¼è®¾ç½®ï¼Œæ¯è¾¾åˆ°ä¸€ä¸ªå…³å¡çš„è¦æ±‚ï¼Œå¼¹å‡ºâ€œå“¥å“¥çœŸæ£’â€æˆ–è€…â€œå§å§çœŸæ£’â€æ¥é¼“åŠ±ç©å®¶ï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ°å…³å¡è¦æ±‚ï¼Œ
å¼¹å‡ºâ€œå“¥å“¥ç»§ç»­åŠ æ²¹å“¦ï¼Œå†è¯•ä¸€æ¬¡å§â€æˆ–è€…â€œå§å§ç»§ç»­åŠ æ²¹å“¦ï¼Œå†è¯•ä¸€æ¬¡å§â€Â 
</code></pre>
<p>ç©ç‚¹æ´»å„¿ï¼Œå“ˆå“ˆå“ˆï¼Œç”šè‡³å¤±è´¥ï¼Œè¿˜èƒ½å¼¹çª—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a8e5c7d2cf34f38a13a0984421a8b44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=K%2Fzsy1I1zDNbvi1%2FZ1vaxDoDlBA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¥½ï¼Œå¼€å¿ƒæ¶ˆæ¶ˆä¹è¿™æ³¢æ•´çš„å¾ˆè¿‡ç˜¾ï¼Œçµå…‰ç”Ÿæˆé€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä¸”æŒ‡å“ªæ”¹å“ªï¼Œè®©å°æ¸¸æˆåˆ›ä½œå˜å¾—å¦‚æ­¤ç®€å•ã€‚</p>
<p>é‚£è¿™å°±æœ‰æ„æ€äº†ï¼Œæˆ‘å®¶æœ‰ä¸ª 2 å²å¤šçš„å®å®ï¼Œæ¯æ¬¡æ•™ä»–æ•°å­—ï¼Œå¯ç—›è‹¦äº†ï¼Œç‰¹åˆ«æƒ³åšä¸ªå°æ¸¸æˆæ¥è¾…å¯¼ä»–å­¦æ•°å­—ã€‚</p>
<p>äºæ˜¯è¾“å…¥éœ€æ±‚ï¼š</p>
<blockquote>
<p>å¸®æˆ‘åšä¸€ä¸ªè®¤è¯†æ•°å­— 1-10 çš„æ¸¸æˆ</p>
</blockquote>
<p>å‡ºæ¥æ•ˆæœè¿˜ä¸é”™ï¼ŒåŒæ ·è‡ªå¸¦éŸ³æ•ˆå’Œä¸‰ç§ä¸åŒç©æ³•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac17d17a6eb744578226082e3378412b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=cIV6WBdvvgHrnTvIZkMP2CCExes%3D" alt="wxv_4281229022916624390" loading="lazy"/></p>
<p>ä½†ä¾æ—§æœ‰ä¸€äº›å°ç»†èŠ‚éœ€è¦è°ƒæ•´ï¼Œäºæ˜¯ç»§ç»­è¾“å…¥ï¼š</p>
<pre><code class="hljs">æ•°å­—å¡ç‰‡çš„ç•Œé¢è®¾è®¡çš„ä¸å¤ªåˆç†ï¼Œæ¯”å¦‚æ•°å­—10æ²¡æœ‰å®Œå…¨æ˜¾ç¤ºå‡ºæ¥ï¼›åœ¨æ•°å­—é¡ºåºæœ‰ä¸€ç§ï¼Œç‚¹å‡»1ä¼šåŒæ—¶å‡ºç°1å’Œ10éƒ½è¢«é€‰ä¸­çš„æƒ…å†µï¼Œä¿®å¤ä¸€ä¸‹
</code></pre>
<p>å¾ˆå¿«ï¼Œå°±è°ƒæ•´å¥½äº†ï¼Œè¿™å›æ•ˆæœæ›´å¥½äº†ï¼Œä½ æ„Ÿå—ä¸‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87a27a87c0564f37b0b948e216a7c841~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=OVea%2Bj1oUaKIjdqtgjwFoNLpOX0%3D" alt="wxv_4281229505697857545" loading="lazy"/></p>
<p>ç„¶åå¯¹äºä¸¤å²å¤šçš„å®å®ï¼Œå¯èƒ½è¿é¢˜ç›®éƒ½ä¸è®¤è¯†å¥½å§ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥è®©æ¸¸æˆè¿›é˜¶ä¸€äº›éš¾åº¦ï¼Œè®©ä»–è¯»å‡ºæ¥ï¼Œæ•ˆæœä¼šæ›´å¥½ä¸€äº›ã€‚æ¥å§ï¼š</p>
<pre><code class="hljs">å°æœ‹å‹ä¸è®¤è¯†å­—ï¼Œåœ¨æ¯ä¸€ä¸ªå…³å¡ï¼Œè¯·è¯»å‡ºæ¥é¢˜ç›®ï¼Œ è€Œä¸”å¯¹äºå°æœ‹å‹æ­£ç¡®çš„ç‚¹å‡»ï¼Œè¯·äºˆä»¥è‚¯å®šâ€œç­”å¯¹äº†ï¼Œä½ çœŸæ£’â€ï¼ŒÂ 
å¯¹äºé”™è¯¯çš„ç‚¹å‡»è¯·äºˆä»¥é¼“åŠ±â€œç­”é”™äº†ï¼Œå†è¯•ä¸€æ¬¡â€ï¼Œç”¨ä¸Šå¯çˆ±èŒè¶£çš„å£°éŸ³Â 
</code></pre>
<p>æ•ˆæœçœŸæ˜¯ç»äº†ï¼Œå¾ˆæ£’ï¼ŒçœŸçš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46468dd3e0c941d7bc64d916b62c9903~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=b9JN8g00KIkJVDXPofRyPeYFRq8%3D" alt="wxv_4281230125565575177" loading="lazy"/></p>
<p>ç„¶åæˆ‘åˆç»§ç»­ç©ï¼Œè®©çµå…‰æ¥åšä¸ªè·³ä¸€è·³å°æ¸¸æˆå§ï¼Œç„¶åæŠŠè·³ä¸€è·³çš„è§’è‰²æ¢ä¸ºå¡çš®å·´æ‹‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a902439572304448a2431f3f2b0e41e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=L25D91gBOsozC7Bx4HwRUCmBnC0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å“ˆå“ˆå“ˆï¼Œæœ‰é‚£ä¸ªæ„Ÿè§‰äº†ï¼Œè¿™ç§å°æ¸¸æˆï¼ŒåŸºæœ¬å°±æ˜¯åˆ†åˆ†é’Ÿæ‰‹æ“ä¸€ä¸ªäº†ã€‚</p>
<p>å†æ¥ä¸€ä¸ªå°æ—¶å€™æœ€çˆ±ç©çš„ç©ºæˆ˜ 1942 å°æ¸¸æˆå§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dba4a524258344dfa9072b746d993f83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=zIKYX6y%2BxlzEaENeVzfWD0Hmuh0%3D" alt="wxv_4281230722918252548" loading="lazy"/></p>
<p>æ—¢ç„¶è¿™ä¹ˆå¼ºï¼Œé‚£å°±å†æ¥ä¸ªå¸¸ç©çš„é»„é‡‘çŸ¿å·¥æ¸¸æˆå§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff68fa597bb64553b28959a560b51141~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=QV8ELoo0fUlRjJkSxmEzFrhT76Y%3D" alt="wxv_4281231272841838595" loading="lazy"/></p>
<p>å¤ªå¥½ç©äº†ï¼Œæˆ‘è¿˜åšäº†ä¸ª 24 ç‚¹æ¸¸æˆå’Œè¿è¿çœ‹å°æ¸¸æˆï¼Œéƒ½éå¸¸ç›Šæ™ºå¥½ç©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fb46ee1313849c39cb1413b7ff9e386~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811612&amp;x-signature=o154UOJRhOncly3mMdgSP4kWaVE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸€å£æ°”æ“äº†ä¸ƒå…«ä¸ªæ¸¸æˆï¼Œè¯´å®è¯ï¼Œæˆ‘å³ä½¿ä½œä¸ºå†™äº†è¿™ä¹ˆä¹…ä»£ç çš„å‰ç¨‹åºå‘˜ï¼Œè¿™ç§éœ‡æ’¼æ„Ÿä¾ç„¶å¾ˆå¼ºã€‚</p>
<p>å¿…é¡»è¦è¯´æ¸…æ¥šçš„æ˜¯ï¼Œ<strong>å¤§å®¶åƒä¸‡åˆ«æ‹¿çµå…‰ç”Ÿæˆçš„è¿™äº›æ¸¸æˆå»è·Ÿã€Šé»‘ç¥è¯ã€‹è¿™ç§ 3A å¤§ä½œæ¯”ï¼Œé‚£æ²¡æœ‰å¯æ¯”æ€§ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªç»´åº¦çš„ä¸œè¥¿ã€‚</strong></p>
<p>çµå…‰è¿™æ¬¡æ›´æ–°ï¼ŒçœŸæ­£è®©æˆ‘è§‰å¾—ã€Œç‚¸è£‚ã€çš„åœ°æ–¹åœ¨äºï¼Œå®ƒå±•ç¤ºäº† AI çš„ä¸€ç§æ–°èƒ½åŠ›â€”â€”<strong>å¯¹é€»è¾‘å’Œè§„åˆ™çš„æ·±åº¦ç†è§£ä¸ç”Ÿæˆ</strong>ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ AIï¼Œæ˜¯è®©å®ƒç”Ÿæˆä¸€æ®µæ–‡æ¡ˆã€ä¸€å¼ å›¾ï¼Œé‚£æ˜¯é™æ€çš„ã€‚ä½†ä»Šå¤©ï¼Œæˆ‘åœ¨çµå…‰é‡Œè¯´ã€ŒæŠŠæ»‘å—æ¢æˆå°åŠ¨ç‰©ã€ã€ã€Œç›¸é‚»æ»‘å—ä¸èƒ½äº¤æ¢ã€ï¼ŒAI æ˜¯å¬æ‡‚äº†æ¸¸æˆè§„åˆ™ï¼Œå¹¶å®æ—¶é‡å†™äº†èƒŒåçš„é€»è¾‘ä»£ç ã€‚</p>
<p>è¿˜è®°å¾— OpenAI çš„ Ilya æ›¾ç»è¯´è¿‡çš„ Scaling Law å—ï¼Ÿå½“æ¨¡å‹å¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œå®ƒä¸ä»…æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ï¼Œå®ƒæ˜¯åœ¨æ„å»ºä¸–ç•Œæ¨¡å‹ã€‚</p>
<p>çµå…‰ç”Ÿæˆçš„æ¯ä¸€ä¸ªå°æ¸¸æˆï¼Œå…¶å®éƒ½æ˜¯ä¸€æ¬¡å¾®å‹çš„ã€Œä¸–ç•Œæ¨¡æ‹Ÿã€**ã€‚å®ƒçŸ¥é“é‡åŠ›æ€ä¹ˆç®—ï¼ˆè·³ä¸€è·³ï¼‰ï¼ŒçŸ¥é“ç¢°æ’æ€ä¹ˆç®—ï¼ˆæ¶ˆæ¶ˆä¹ï¼‰ï¼Œä¹ŸçŸ¥é“æ€ä¹ˆå“„å°æœ‹å‹ï¼ˆç»™æˆ‘å„¿å­åšçš„é‚£ä¸ªè¯†å­—æ¸¸æˆï¼‰ã€‚</p>
<p><strong>è¿™å°±æ˜¯æˆ‘ä»¬ä¸€ç›´æœŸå¾…çš„ã€Œç”Ÿæˆæ¶Œç°ã€ã€‚</strong></p>
<p>å¯¹äºæ™®é€šäººæ¥è¯´ï¼Œè¿™æ›´æ˜¯ä¸€æ¬¡å½»åº•çš„å¹³æƒã€‚</p>
<p>ä»¥å‰ä½ æƒ³åšä¸ªæ¸¸æˆå“„å­©å­å¼€å¿ƒï¼Œä½ å¾—å­¦ Pythonï¼Œå¾—æ‰¾ç´ æï¼Œå¾—è°ƒè¯•åŠå¤©ã€‚ç°åœ¨åœ¨çµå…‰è¿™é‡Œï¼Œ<strong>ä½ çš„æƒ³è±¡åŠ›ï¼Œå°±æ˜¯å”¯ä¸€çš„ç¼–ç¨‹è¯­è¨€ã€‚</strong></p>
<p>ä¸ç®¡ä½ æ˜¯æƒ³åšä¸€ä¸ªä¸“å±çš„çºªå¿µæ—¥å°æ¸¸æˆï¼Œè¿˜æ˜¯åƒæˆ‘ä¸€æ ·ä¸ºäº†å“„ã€Œå°æ©˜å­ã€å­¦æ•°å­¦ï¼Œç”šè‡³åªæ˜¯ä¸ºäº†æ•´æ´»æ¶æä¸€ä¸‹æœ‹å‹ï¼Œé—¨æ§›éƒ½å·²ç»é™åˆ°äº† 0ã€‚</p>
<p>åªèƒ½è¯´ï¼Œèš‚èšè¿™æ³¢ï¼Œç¡®å®æŠŠç© AI çš„ä¸Šé™åˆæ¨é«˜äº†ä¸€æˆªã€‚</p>
<p><strong>æœ€åï¼Œåˆ«å…‰çœ‹æˆ‘ç©ã€‚</strong></p>
<p>å¼ºçƒˆå»ºè®®å¤§å®¶å»ä¸‹è½½çµå…‰ APPï¼Œç‚¹å¼€ã€Œé—ªåº”ç”¨ã€ï¼Œåœ¨å¯¹è¯æ¡†é‡Œè¾“ä¸€å¥ã€Œåšä¸€ä¸ª xxx æ¸¸æˆã€ã€‚</p>
<p>å“ªæ€•æ˜¯æœ€ç®€å•çš„ã€Œåšä¸€ä¸ªçŸ³å¤´å‰ªåˆ€å¸ƒã€ï¼Œè¯•ç€å»æ”¹æ”¹å®ƒçš„è§„åˆ™ï¼Œæ„Ÿå—ä¸€ä¸‹é‚£ç§ã€Œè¨€å‡ºæ³•éšã€çš„å¿«ä¹ã€‚</p>
<p>åšå‡ºæ¥äº†è®°å¾—åœ¨è¯„è®ºåŒºäº¤ä¸ªä½œä¸šï¼Œæˆ–è€…æŠŠé“¾æ¥ç”©å‡ºæ¥ï¼Œè®©æˆ‘çœ‹çœ‹è°çš„è„‘æ´æœ€å¤§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€äººæ‰‹æ“ï¼AI æ¼«å‰§ä»0åˆ°1è¯¦ç»†æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7581297335315349556</link>    <guid>https://juejin.cn/post/7581297335315349556</guid>    <pubDate>2025-12-08T15:18:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581297335315349556" data-draft-id="7581297335315333172" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€äººæ‰‹æ“ï¼AI æ¼«å‰§ä»0åˆ°1è¯¦ç»†æ•™ç¨‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T15:18:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä½•"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€äººæ‰‹æ“ï¼AI æ¼«å‰§ä»0åˆ°1è¯¦ç»†æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä½•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:18:28.000Z" title="Mon Dec 08 2025 15:18:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯è‹ä½•çš„ç¬¬ 457 ç¯‡åŸåˆ›ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å–œæ¬¢çœ‹åŠ¨æ¼«çš„è‹ä½•ã€‚</p>
<p>ç›¸ä¿¡ä¸ç”¨è¯´ä½ ä¹ŸçŸ¥é“ï¼Œæˆ‘è¿™ä¸‡å¹´æ²¡å˜çš„å¤´åƒï¼Œèƒ½çœ‹å‡ºæˆ‘æ˜¯ä¸ªäºŒæ¬¡å…ƒå§ï¼Ÿ</p>
<p>æœ€è¿‘çœ‹åˆ° AI æ¼«å‰§è¶…çº§ç«ï¼ŒåŠ ä¸Šå‰äº›å¤©æœ‹å‹æ¥å…¬å¸ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨äº† AI æ¼«å‰§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5755f03e665943bba1df9e49199dd01d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=z%2BgPTF2UXNIB84KvohMZ0aTUIhY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¯ä»¥å­¦ä¹ å•Šï¼Œæ‰€ä»¥è¿™ä¸€ç¯‡æ–‡ç« å…¶å®ç†è®ºä¸Šæ˜¯æˆ‘å­¦ä¹ çš„ä¸€äº›æˆæœå’Œä¸€äº›ç»éªŒï¼Œç®—æ˜¯ä» 0 å…¥é—¨å¦‚ä½•åˆ¶ä½œ AI æ¼«å‰§äº†ã€‚</p>
<p>ç°åœ¨çš„ AI æ¼«å‰§å¸‚åœºï¼Œè¯´ç™½äº†å°±æ˜¯é‡è›®ç”Ÿé•¿çš„çˆ†å‘æœŸã€‚ä½†è¿™ä¸ªé˜¶æ®µå¾ˆå¿«å°±ä¼šè¿‡å»ï¼Œä½œå“ç§¯ç´¯åˆ°ä¸€å®šé‡çº§åï¼Œæ‹¼çš„å°±ä¸æ˜¯è°åšå¾—å¿«äº†ã€‚</p>
<p>æœªæ¥çš„é€»è¾‘å¾ˆç®€å•ï¼šåªæœ‰ç²¾å“æ‰èƒ½è·‘å‡ºæ¥ã€‚è°èƒ½æ²‰ä¸‹å¿ƒåšå“è´¨ï¼Œè°æ‰èƒ½çœŸæ­£æå®šå®¢æˆ·ã€‚</p>
<p>å¥”ç€è¿™ä¸ªç›®æ ‡ï¼Œä¸‹é¢è¿™ä¸ªè§†é¢‘æ˜¯æˆ‘è¿™ä¸ªå­¦ä¹ é˜¶æ®µçš„äº§ç‰©ï¼Œå“ˆå“ˆå“ˆï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æŒºä¸é”™çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ae740dacec14992b05634cbdf928262~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=CtbBbHJX2QYXjnziZVzQY%2B0a3zw%3D" alt="wxv_4286323050523836421" loading="lazy"/></p>
<p>ç„¶åè¿˜åšäº†ä¸€ä¸ªå¸¦ç©¿è¶Šçš„è§†é¢‘ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc028b2085b841418aa8ec9e4778010b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=Q2L9BKBnRz9TzfqlzJNbmE7fs0U%3D" alt="wxv_4283644191911182358" loading="lazy"/></p>
<p>ç¬¬ä¸€ä¸ªä½œä¸ºAIæ¼«å‰§çš„å­¦ä¹ ä½œå“ï¼Œæˆ‘è¿˜æ˜¯éå¸¸æ»¡æ„çš„ã€‚</p>
<p>ä½†å…¶å®ï¼Œè¦æƒ³å®Œæˆè¿™æ ·ä¸€ä¸ªAIæ¼«å‰§ä½œå“ï¼Œéœ€è¦ç”¨åˆ°AIç”Ÿå›¾ã€AIè§†é¢‘èƒ½åŠ›ï¼Œéœ€è¦æœ‰ä¸€ä¸ªå¥½çš„å·¥å…·ä¸æ»‘å®Œæˆã€‚</p>
<p>äºæ˜¯å¼€å§‹ç¿»å„å®¶AIå·¥å…·å®˜ç½‘ï¼Œå‘ç°æœ‰å®¶AIå‚å•†æ¥å…¥äº†ğŸŒProæ¨¡å‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6ee34827bb64f28ad581d00d1d652f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=66EorPVVO4PoKfM9ZRfBr9grqzg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>çœ‹äº†ä¸‹æ˜¯å›½å†…AIå…­å°é¾™ä¹‹ä¸€MiniMaxæ——ä¸‹çš„æµ·èºAIï¼Œ</p>
<p>ä»¥å‰æˆ‘çš„å°è±¡é‡Œï¼Œæµ·èºåªæœ‰è‡ªå®¶çš„æ¨¡å‹ï¼Œç°åœ¨è¿˜å¼•å…¥äº†å…¶ä»–æ¨¡å‹äº†ï¼Ÿ</p>
<p>é™¤äº†ğŸŒProï¼Œè¿˜æœ‰ Sora 2.0ã€Veo 3.1éƒ½åŠ è¿›æ¥äº†ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2973d7efa2d4f5eab5d040aa0cda9a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=VRi3%2FlPNF%2FTyDreGeNmY3kv2Mrs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†æµ·èºè‡ªå®¶çš„æ¨¡å‹å…¨å®¶æ¡¶ä¹‹å¤–ï¼Œè¿˜èƒ½ç”¨ä¸Šå…¶ä»–èƒ½åŠ›äº’è¡¥çš„é¡¶çº§æ¨¡å‹ï¼Œéå¸¸æ–¹ä¾¿ä¸€ç«™å¼åšç²¾å“AIæ¼«å‰§ã€‚ï¼ˆè¿˜æœ‰ä¸»è¦æ˜¯çœ‹åˆ°é©¬å…‹å¼ è€å¸ˆç­‰å¤§ä½¬ä¹Ÿåœ¨æ¨èï¼‰</p>
<p>äºæ˜¯å°±å°è¯•ç€ç”¨æµ·èºAIæ¥åˆ›ä½œæˆ‘çš„ç¬¬ä¸€ä¸ªAIæ¼«å‰§ã€‚</p>
<p>æœ¬ç¯‡æˆ‘ä¼šä»å­¦ä¹ æ–¹æ³•åˆ°åˆ¶ä½œæ•™ç¨‹ï¼Œå†åˆ°æœ€åçš„æˆæœå±•ç¤ºï¼Œå¯¹ AI æ¼«å‰§ç®—æ˜¯æµ…æµ…å…¥ä¸€ä¸ªé—¨åˆ†äº«ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab50a4c5788d47edbd9c4c96179b0b32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=Sb5owapCWh9svy%2FOZRKwnkWgJaE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<blockquote>
<p>å†…å®¹ä¼šæœ‰äº›é•¿ï¼Œå»ºè®®å…ˆç‚¹èµæ”¶è—å“ˆå“ˆå“ˆã€‚ä¸è¿‡æ¨èä½ ä¸€å®šè¦çœ‹åˆ°æœ€åã€‚</p>
</blockquote>
<h2 data-id="heading-0">å­¦ä¹ æ–¹æ³•</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12adb4e790994a28a91535cd78149573~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=SoJVHaMkfdfFV5OEb9ln4QHFMFE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ ¹æ®é©¬å…‹å¼ è€å¸ˆçš„AIæ¼«å‰§æ–¹æ³•è®ºä»¥åŠNotebookLMå­¦ä¹ çŸ¥è¯†åº“ï¼Œå¯ä»¥æç‚¼ç›¸å…³æ­¥éª¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b32cd77bfe774be284b2b3adcceb2a9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=jORCKVcDHn38TfdzGzQGejrNmRI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”šè‡³è¿˜å¯ä»¥ç”Ÿæˆä¿¡æ¯å›¾æ¥è¾…åŠ©å­¦ä¹ ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5e6712b24f343d7aad715944a23eb72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=BOMRpkWb5B8M1BaQxkVfrWbMFqo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">åˆ¶ä½œè¿‡ç¨‹</h2>
<p>æ•´ä½“æ€è·¯å…¶å®åŒ…å«ä¸¤ç§ä¸åŒçš„æ€è·¯ï¼Œä¸€ç§æ˜¯è¿™æ ·å­çš„ï¼š</p>
<pre><code class="hljs">æ€è·¯ä¸€ï¼š
1ã€åˆ©ç”¨é¦™è•‰proç”Ÿæˆäººç‰© Â IP å›¾ç‰‡
2ã€ç”Ÿæˆåˆ†é•œè„šæœ¬
3ã€åœ¨æµ·èºagentæ ¹æ®äººç‰©å‚è€ƒå›¾å’Œåˆ†é•œè„šæœ¬é‡Œé¢ç”Ÿæˆåˆ†é•œå›¾ç‰‡
4ã€æ ¹æ®æµ·èºAIé¦–å°¾å¸§ç”Ÿè§†é¢‘ä»¥åŠæ–‡ç”Ÿè§†é¢‘åŠŸèƒ½å°†åˆ†é•œå›¾ç‰‡ç”Ÿæˆè§†é¢‘
5ã€è½¬åœºæ ¹æ®æ”¶å°¾å¸§æ¥åšä¸æ»‘è½¬åœº
6ã€å‰ªæ˜ æˆ–è€…PRé‡Œé¢å»åˆæˆ
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/587e8f75373f41529f1b8c7430b2defd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=9Y1Wzys31yodsjqWvIYQsUzfD1Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿˜æœ‰ä¸€ç§æ›´æš´åŠ›çš„å°±æ˜¯è¿™æ ·å­çš„ï¼š</p>
<pre><code class="hljs">1ã€åˆ©ç”¨é¦™è•‰proç”Ÿæˆäººç‰© Â IP å›¾ç‰‡
2ã€ç”Ÿæˆäººç‰©åœºæ™¯å›¾å’Œéœ€è¦çš„å…¶ä»–åœºæ™¯å›¾
4ã€æ ¹æ®å›¾ç‰‡åˆ©ç”¨æµ·èºAIé¦–å°¾å¸§ç”Ÿè§†é¢‘
5ã€æˆªå–åä¸€ä¸ªè§†é¢‘çš„å°¾å¸§å’Œä¸Šä¸€ä¸ªè§†é¢‘çš„é¦–å¸§ï¼Œç”Ÿæˆè¿‡åº¦è½¬åœºè§†é¢‘
6ã€å‰ªæ˜ æˆ–è€…PRé‡Œé¢å»åˆæˆ
</code></pre>
<p>ä¸¤ç§æ–¹æ³•æˆ‘éƒ½è¯•äº†ï¼Œä½†å› ä¸ºç›®å‰å¯¹åˆ†é•œè„šæœ¬çš„ä½¿ç”¨è¿˜éœ€è¦å†å­¦ä¹ ï¼Œå¯¼è‡´ä¼šæœ‰ä¸€äº›å°å°ç‘•ç–µï¼Œè¿™é‡Œå°±ä»¥æ–¹æ³•äºŒæ¥å±•å¼€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc56f8e7694b4266b4e90567392ada82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=0xXS68%2FEmhzMgklU3J5GRyzZcPc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä»¬å…ˆæ‰“å¼€æµ·èº AIï¼Œåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhailuoai.video" target="_blank" title="https://hailuoai.video" ref="nofollow noopener noreferrer">hailuoai.video</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aeafc3dcc8654952aabc20ee3c0f64d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=bzr6CpnB7i0TOl9cxsGbRi4pvg8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…ˆç”Ÿæˆ IP äººç‰©å›¾ç‰‡ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ç”¨é¦™è•‰ Proï¼Œåæ­£ç°åœ¨å¯¹ä¼šå‘˜æ¥è¯´æ˜¯å…è´¹çš„ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šäººç‰© IP å›¾ç‰‡</strong></p>
<p>å¯ä»¥åœ¨ NotebookLM ä¸­ï¼Œå¾—åˆ°ç”Ÿæˆäººç‰©çš„æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ä¸€ä½è‹±æŒºçš„ç”·æ€§ä¾ å®¢ï¼Œèº«ç€ä¸­å¼å¤è£…ï¼Œç„é»‘è‰²ï¼Œé£˜é€¸é•¿è¢ï¼Œæœé¥°ç»†èŠ‚ä¸Šå¸¦æœ‰ä¸­å›½ä¼ ç»Ÿçº¹é¥°å’Œé‡‘å±æŠ¤ç”²ã€‚
è…¾ç©ºäºå±±å·…ä¹‹ä¸Šï¼ŒèƒŒæ™¯æ˜¯äº‘é›¾ç¼­ç»•çš„é™©å³»å±±å³°å’Œå¤è€çš„ç€‘å¸ƒã€‚
é¢éƒ¨ç‰¹å¾ï¼šå¹´è½»ä¿Šæœ—ï¼Œçœ¼ç¥åšå®šä¸”æ·±é‚ƒï¼ŒèƒŒåèƒŒç€ä¸€æŸ„å¤æœ´å®å‰‘ã€‚
è§†è§‰é£æ ¼ï¼š**æ­¦ä¾ å›½æ¼«é£æ ¼ (Wuxia Guoman style)**ï¼Œ**ç±»ä¼¼ã€Šå‡¡äººä¿®ä»™ä¼ ã€‹åŠ¨ç”»ç‰ˆçš„é«˜çº§æ¸²æŸ“å’Œå…‰å½±æ•ˆæœ**ï¼Œæ•°å­—ç»˜ç”» (Digital Painting)ï¼Œé«˜ç»†èŠ‚åº¦ (High Detail)ï¼Œæ¦‚å¿µè‰ºæœ¯ (Concept Art)ï¼Œç”µå½±çº§å…‰ç…§ (Cinematic Lighting)ã€‚
æ„å›¾ä¸è§†è§’ï¼šå…¨èº«åƒï¼Œé£å¹æ‹‚ç€è¡£è¢‚ï¼Œè¥é€ å‡ºå¼ºçƒˆçš„åŠ¨æ€æ„Ÿå’Œä»™ä¾ æ„å¢ƒã€‚
</code></pre>
<p>æŠŠè¿™ä¸ªæç¤ºè¯æ”¾åˆ°æµ·èºAIçš„ç”Ÿå›¾è¿™é‡Œï¼Œé€‰æ‹©ğŸŒProæ¨¡å‹ï¼Œå¯ä»¥ä¸€æ¬¡ç”Ÿæˆæœ€å¤š 4 å¼ å›¾ï¼Œ4K åˆ†è¾¨ç‡çš„ï¼Œè€Œä¸”ç°åœ¨è¿˜ä¸éœ€è¦èŠ±è´¹ç§¯åˆ†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2a8a3603f064222a28fc022b8bbff64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=ey%2Bk7e0LsxlqWJBpEU8aFRfnNls%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é€‰æ‹©ä¸€å¼ è‡ªå·±å–œæ¬¢çš„ï¼Œè¿™é‡Œæˆ‘æ„Ÿè§‰è¿™ä¸ªè¿˜è›®å¸…çš„ï¼Œå°±è¿™å§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db8c36dbbc9c4aa7bdc47705c16b6eb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=eqB2qv3x2BVQS2aJXqz8uav9vuc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æµ·èºAIä¸­å¯ä»¥æ— æ°´å°ä¸‹è½½åçš„å›¾ç‰‡æ•ˆæœï¼Œä¸å¾—ä¸è¯´ï¼ŒçœŸå¸…å•Šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e8edce8afee41ee97edcc3a0a8610d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=e69mv7AtwdsVU90nG%2Bf%2Bu%2Ftix%2Fc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ç¬¬äºŒæ­¥ï¼Œç”Ÿæˆäººç‰©åœºæ™¯å›¾</strong></p>
<p>æˆ‘å’Œ NotebookLM ä¸€èµ·æ„æ€çš„åœºæ™¯æ˜¯äººç‰©å’Œé¾™æ‰“æ–—çš„åœºæ™¯ï¼Œä¸ºäº†è¾¾åˆ°å¾ˆ nice çš„æ•ˆæœï¼Œè¿™é‡Œä¹Ÿå‚è€ƒäº† 7 å…ˆç”Ÿçš„æç¤ºè¯è¿›è¡Œäº†ä¿®æ”¹ï¼ŒåŒæ ·åœ¨æµ·èºä¸­è¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼Œå¹¶ä¸Šä¼ ç¬¬ä¸€æ­¥ç”Ÿæˆçš„å‚è€ƒå›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db3cb67051d7491a96bae2b2208f278a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=DXje404e3QbbCVWK5mO3EvBjFBc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æç¤ºè¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">ä¸€ä½è‹±æŒºçš„ç”·æ€§ä¾ å®¢ï¼Œèº«ç€ä¸­å¼å¤è£…ï¼Œç„é»‘è‰²ï¼Œé£˜é€¸é•¿è¢ï¼Œæœé¥°ç»†èŠ‚ä¸Šå¸¦æœ‰ä¸­å›½ä¼ ç»Ÿçº¹é¥°å’Œé‡‘å±æŠ¤ç”²ã€‚
<span class="hljs-section">èƒŒæ™¯:é»„æ˜ï¼Œè½æ—¥ï¼Œå®ä¼Ÿçš„ä¸­å¼å®«æ®¿ï¼Œé£æªç¿˜è§’ã€‚</span>
<span class="hljs-section">å…‰å½±:ç”µå½±æ„Ÿä¾§é€†å…‰ï¼Œè½®å»“å…‰ï¼Œæš–è‰²è°ƒï¼Œæ©™çº¢è‰²å¤©ç©ºï¼Œé•¿é•¿çš„å½±å­ã€‚</span>
<span class="hljs-section">ç»†èŠ‚:è…°é—´æœ‰é‡‘è‰²å…‰èŠ’ï¼Œæ²§æ¡‘æ„Ÿã€‚</span>
<span class="hljs-section">æ„å›¾ä¸é£æ ¼:ä¸­æ™¯ï¼Œå¹³è§†è§†è§’ï¼Œå†™å®CGï¼Œé«˜ç»†èŠ‚ï¼Œæ°›å›´æ„Ÿï¼Œ8Kã€‚</span>
</code></pre>
<p>ç”Ÿæˆäº†å¥½å‡ å¼ ï¼Œé€‰æ‹©ä¸€å¼ æ•ˆæœæœ€å¥½çš„ã€‚ï¼ˆå¦‚æœä¸æ»¡æ„é‡æ–°å¤šç”Ÿæˆå‡ æ¬¡å°±å¥½äº†ï¼‰è¿™é‡Œçš„äººç‰©ä¸€è‡´æ€§ä¿æŒçš„éå¸¸å¥½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be2f236882d944679fea25bef26c597b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=OQMqbKBksvW2xwLPi07Q2l55gPQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åæ˜¯äººç‰©å†²é”‹å›¾ï¼ŒåŒæ ·å‚è€ƒ 7 å…ˆç”Ÿè§†é¢‘ä¸­çš„éƒ¨åˆ†æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">ä¸€ç¾¤ä¸­å›½å¤ä»£æ­¦å£«åœ¨ç©ºä¸­ï¼Œå‰æ™¯ä¸€äººæŒç«ç„°å‰‘å‘å‰å†²é”‹ï¼ŒèƒŒæ™¯å…¶ä»–äººæŒç«ç„°æ­¦å™¨é£èˆï¼Œèº«å¤„çƒˆç„°äº‘ä¸é»‘æš—
stormy å¤©ç©ºä¸­ï¼Œè¶…å†™å®<span class="hljs-type">CGï¼Œå²è¯—å¥‡å¹»æˆ˜æ–—ï¼Œå¼ºçƒˆåŠ¨æ„Ÿï¼Œæˆå‰§åŒ–å…‰å½±ï¼Œé²œæ˜çš„æ©™é»‘é…è‰²</span><span class="hljs-operator">ã€‚</span>
</code></pre>
<p>åŒæ ·åœ¨æµ·èºé‡Œé¢è¾“å…¥æç¤ºè¯å’Œå‚è€ƒå›¾ï¼Œè¿™é‡Œæ³¨æ„æˆ‘é€‰æ‹©çš„ä¾æ—§æ˜¯æœ€æ–°çš„é¦™è•‰Proã€‚<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f27aaba42cd643bcbad1623c726878ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=IIOB2hRC%2BvmuS1oD86BFhVdbE0A%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥ä¸€æ¬¡æœ€å¤šç”Ÿæˆ 4 å¼ ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†è¿™å¼ ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04c1a8d811cb42d88d597f81c6f484e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=NS0K%2FVwJi9NtjGmNXlj7KxKgWGo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€åéœ€è¦ä¸€å¼ å·¨é¾™å›¾ï¼Œè¿™é‡Œæˆ‘è¾“å…¥ç®€å•çš„æç¤ºè¯æ˜¯æ²¡æ³•è¾¾åˆ°æ•ˆæœçš„ï¼Œæœ‰ 2 ç§åŠæ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨å‚è€ƒå›¾çš„æ–¹å¼æ¥ç”Ÿæˆï¼Œä¸€ç§å°±æ˜¯åˆ©ç”¨è¶…çº§ä¸“ä¸šä¸”å¤æ‚çš„æç¤ºè¯ï¼Œè¿™é‡Œ NotebookLM å¸®æˆ‘æç‚¼äº† 7 å…ˆç”Ÿçš„ç”Ÿæˆå·¨é¾™æç¤ºè¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">å¢¨è‰²ä¹Œäº‘åƒæµ“å¢¨æ³¼è¿›æ·±æ¸Šï¼Œé›·ç”µåœ¨äº‘ç¼é‡Œç–¯çªœï¼Œç‚¸å¼€åˆºç›®ç™½å…‰å’Œéœ‡è€³é›·é¸£ã€‚é•œå¤´"å—–â€åœ°å¾€å‰çŒ›å†²ï¼Œç©¿å±‚å±‚

æ¹¿å†·äº‘å±‚æ—¶ï¼Œæ°´æ±½è¢«çƒ­æµªçƒ¤å¾—æ³›ç»¯çº¢ï¼Œäº‘å±‚åƒåœ¨â€ç‡ƒçƒ§â€!çº¢æµå…‰åœ¨äº‘æµ·é‡Œå·¦æ‰­å³æ‹ï¼Œè—ç€é¾™å¤´é¾™å°¾å‹¾äººè§†çº¿ã€‚

çªç„¶ç¥é¾™ä»äº‘ä¸­å†²å‡ºæ¥ï¼Œé¾™å¤´æœç€é•œå¤´é£ï¼Œä»ç”»é¢ä¸Šæ–¹æ èµ°ï¼Œå‘¨èº«ç«ç„°â€è½°â€åœ°ç‚¸å¼€!æœ€åç¥é¾™ä»äº‘å±‚ä¸‹é’»å‡ºæ¥ã€‚å®šæ ¼ç¥é¾™ç‰¹å†™ç›˜åœ¨äº‘æ¶›é‡Œï¼Œç«ç„°å’Œé›·äº‘ä¸€å—ç‹‚èˆçš„å¨éœ¸æ°”æ€ï¼Œè§†è§‰å†²å‡»ç›´æ¥æŠŠå¿ƒç‚¸å¼€!
</code></pre>
<p>æµ·èºä¸­ç”Ÿæˆä¸æ»¡æ„çš„è¿˜å¯ä»¥ç›´æ¥é‡æ–°ç”Ÿæˆï¼Œæˆ‘é€‰æ‹©äº†ä¸€å¼ ç‚«é…·çš„ï¼Œå“ˆå“ˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32ef57d301c141e79aa40dae9e3f05e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=A%2B3eVWpBuQZsNEEsvSch6KDWOh8%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼Œç”Ÿæˆå·¨é¾™å–·ç«çš„è§†é¢‘</strong></p>
<p>åœ¨æµ·èºä¸­é€‰æ‹© Video è§†é¢‘ç”Ÿæˆï¼Œè¾“å…¥ç¬¬äºŒæ­¥ç”Ÿæˆçš„å·¨é¾™ï¼Œé…åˆä¸Šè¿™æ ·ä¸€æ®µæç¤ºè¯ï¼ˆåœ¨ 7 å…ˆç”Ÿçš„è§†é¢‘æç¤ºè¯åŸºç¡€ä¸Šåšäº†æ”¹åŠ¨ï¼‰</p>
<pre><code class="hljs">è¯—å¥‡å¹»é£æ ¼ï¼Œä»¥å›¾ä¸­ä¸œæ–¹é¾™ä¸ºæ ¸å¿ƒï¼Œå‘¨èº«çƒˆç„°ç‡ƒçƒ§ï¼Œé³ç‰‡å…·æœ‰é‡‘å±å…‰æ³½ï¼Œé¾™é¡»é£˜åŠ¨ï¼Œçº¢çœ¼å‡Œå‰ã€‚å®ƒåœ¨ä¹Œäº‘ç¿»æ¶Œã€é—ªç”µè‚†æ çš„å¤©ç©ºä¸‹ç¼“ç¼“æ¸¸åŠ¨ï¼Œå¤´éƒ¨è½¬åŠ¨ï¼Œ
å£ä¸­æŒç»­å–·åç«æŸ±å€¾æ³»è€Œä¸‹ã€‚é—ªç”µæ—¶é•œå¤´è½»å¾®æŠ–åŠ¨ã€‚ä¿æŒä¸œæ–¹é¾™çš„ä¸»ä½“ç‰¹å¾ä¸å˜ï¼Œæ²¡æœ‰é¾™çˆª ï¼Œæ²¡æœ‰ç¿…è†€ã€‚
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a42505a32980413eba74b2b9e43b7047~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=3BBHCYP5yvk5t0KLVUjxli13ndw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”Ÿæˆè§†é¢‘è¿™é‡Œï¼Œå¯ä»¥ç”¨ä¸åŒçš„æ¨¡å‹éƒ½è¯•ä¸€ä¸‹ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªæ•ˆæœæœ€å¥½çš„å°±å¥½äº†ã€‚æˆ‘è·‘äº†å‡ ä¸ªåï¼Œé€‰æ‹©äº†è¿™ä¸ªè§†é¢‘ç‰‡æ®µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1ededc3189f45a782f82b7bd4c9c403~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=j9dPWmlwEWtFlcRqjRMdpIvKUjc%3D" alt="wxv_4283642744943591431" loading="lazy"/></p>
<p>ä½ å¯ä»¥çœ‹åˆ°æ•´ä¸ªç”»é¢éƒ½æ˜¯éå¸¸æœ‰éœ‡æ’¼æ„Ÿçš„ï¼Œè€Œä¸”ä½¿ç”¨Veo3.1æ˜¯èƒ½ç›´æ¥ç”ŸæˆéŸ³æ•ˆçš„ï¼Œæ•ˆæœå¾ˆèµã€‚</p>
<p>è¿™é‡Œå†è¡¥å……ä¸€äº›åœºæ™¯ï¼Œé¾™å–·ç«å®Œåï¼Œç«çƒä¼šè½åˆ°åœ°é¢ï¼Œæ‰€ä»¥å†æ ¹æ®å‚è€ƒå›¾è¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼š</p>
<pre><code class="hljs">å²è¯—å¥‡å¹»é£æ ¼ï¼Œä»¥å›¾ä¸­ä¸œæ–¹é¾™ä¸ºæ ¸å¿ƒï¼Œ
å‘¨èº«çƒˆç„°ç‡ƒçƒ§ï¼Œé³ç‰‡å…·æœ‰é‡‘å±å…‰æ³½ï¼Œé¾™é¡»é£˜åŠ¨ï¼Œçº¢çœ¼å‡Œå‰ã€‚å®ƒåœ¨ä¹Œäº‘ç¿»æ¶Œã€é—ªç”µè‚†æ çš„å¤©ç©ºä¸‹ç¼“ç¼“æ¸¸åŠ¨ï¼Œå®ƒå£ä¸­æŒç»­å–·åç«æŸ±å€¾æ³»è€Œä¸‹ã€‚
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d90a81d2ef2443ba76673d17d831da6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=KCdo5It%2F8lmIPXHZIDTy53xjn60%3D" alt="wxv_4283643742365777930" loading="lazy"/><br/>
è¿™é‡Œé¾™ä¿æŒäº†å®Œç¾çš„ä¸€è‡´æ€§ï¼Œè€Œä¸”æ•´ä¸ªè§†é¢‘å¾ˆè‡ªç„¶ï¼Œåœºæ™¯ä¹Ÿæ¯”è¾ƒéœ‡æ’¼ã€‚åŒæ ·è‡ªå¸¦äº†éŸ³æ•ˆã€‚</p>
<p>åœ¨æµ·èºä½¿ç”¨Veo3.1 / Sora2 èƒ½ç›´å‡ºå¸¦æœ‰åŸç”ŸéŸ³æ•ˆçš„è§†é¢‘ç‰‡æ®µï¼Œ</p>
<p>å®Œç¾åœ°è·Ÿæµ·èºAIäº§å“è¿›è¡Œç»“åˆï¼Œè¡¥é½â€œéŸ³ç”»â€è¿™ä¸€éƒ¨åˆ†çš„æ‹¼å›¾~</p>
<p>è¿™ï¼Œæˆ–è®¸å°±æ˜¯å¼•å…¥å¤šæ¨¡å‹çš„æ„ä¹‰ã€‚</p>
<p><strong>ç¬¬å››æ­¥ï¼Œç”Ÿæˆå…¶ä»–åœºæ™¯éœ€è¦çš„è§†é¢‘ã€‚</strong></p>
<p>ä¸»è¦åŒ…å«ç«çƒè½åˆ°åœ°é¢ï¼Œäººç‰©å¼€å§‹å»å’Œé¾™æ‰“æ–—çš„åœºæ™¯ç­‰ï¼ŒåŒæ ·çš„æ–¹æ³•è¿™é‡Œå°±ä¸å¤šæ”¾äº†ï¼Œæç¤ºè¯éœ€è¦çš„è¯ä¸‰è¿è¯„è®ºåŒºç•™è¨€å°±å¥½ã€‚</p>
<p>ç„¶åæ ¹æ®å‰æ®µè§†é¢‘çš„é¦–å¸§å’Œåç«¯è§†é¢‘çš„å°¾å¸§ï¼Œåšè½¬åœºè§†é¢‘ï¼Œæ–¹æ³•ä¹Ÿç±»ä¼¼ã€‚</p>
<p><strong>ç¬¬äº”æ­¥ï¼Œå»å‰ªæ˜ é‡Œé¢åšåˆæˆã€‚</strong></p>
<p>æŠŠæ‰€æœ‰çš„ç´ æå»å‰ªæ˜ åšä¸‹ç®€å•çš„å‰ªè¾‘åˆæˆå°±å®Œæˆå•¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcaab48f614944228543c94512790d72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=lyvIfkPnVbmV4%2BB%2BRFCjFWGVUq8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€ç»ˆå¾—åˆ°å¦‚ä¸‹æˆå“è§†é¢‘ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c00187680b15483cb949c6ed3d4a1103~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=8qIHNpvrnJIHrDLHrhy0e5Stg3w%3D" alt="wxv_4283644794347192339" loading="lazy"/></p>
<p>é™¤äº†è¿™ä¸ªæˆ‘è¿˜åšäº†ä¸€ä¸ªæœ‰å‰§æƒ…ç©¿è¶Šæ„Ÿçš„è§†é¢‘ï¼Œå“ˆå“ˆå“ˆï¼Œå¤§å®¶å¯ä»¥æ„Ÿå—ä¸€ä¸‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63aab5dc341348d58184b5e547416fd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=k%2FXJ18jEsdMUAgznSQH4%2Fv1Zkmk%3D" alt="wxv_4283644191911182358" loading="lazy"/></p>
<p>ç°åœ¨æµ·èºAIï¼Œä¸å†åªæœ‰è‡ªå®¶æ¨¡å‹ï¼Œè€Œæ˜¯æ±‡é›†äº†ä¸åŒé¢†åŸŸçš„SOTAæ¨¡å‹ï¼Œ</p>
<p>è€Œä¸”è°ƒç”¨è°·æ­ŒVeo3.1çš„ä»·æ ¼ï¼Œå¤§æ¦‚æ˜¯å®˜æ–¹ä»·æ ¼çš„3.7æŠ˜ï¼Œç°åœ¨å¹´å¡æœ‰4æŠ˜ä¼˜æƒ æ´»åŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f945052359e4164b288308d7fd23147~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765811908&amp;x-signature=Oz7zetGZomXLXYoohAMiSsSMyDY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€å…³é”®çš„æ˜¯åªè¦æ˜¯æµ·èºçš„ä»»æ„æ¡£ä¼šå‘˜ï¼Œä»Šå¹´éƒ½èƒ½æ— é™ä½¿ç”¨Nano Banana Pro æ¥ç”Ÿå›¾ï¼Œç›´åˆ°2025å¹´12æœˆ31æ—¥ã€‚</p>
<p>å¯ä»¥æ”¾å¿ƒé£Ÿç”¨äº†ï¼Œå“ˆå“ˆå“ˆã€‚</p>
<p>å¥½äº†ï¼Œæ•™ç¨‹å’Œæ–¹æ³•è®ºå·²ç»åˆ†äº«å®Œäº†ã€‚</p>
<p>çœ‹ç€å±å¹•é‡Œå‘¼å•¸è€Œè¿‡çš„å·¨é¾™å’Œä»—å‰‘å¤©æ¶¯çš„ä¾ å®¢ï¼Œè¯´å®è¯ï¼Œé‚£ä¸€åˆ»æˆ‘å¿ƒé‡ŒæŒºæ„Ÿæ…¨çš„ã€‚ä½œä¸ºä¸€ä¸ªä»å°çœ‹åŠ¨æ¼«é•¿å¤§çš„è€äºŒæ¬¡å…ƒï¼Œèƒ½äº²æ‰‹æŠŠè„‘æµ·é‡Œé‚£äº›å¤©é©¬è¡Œç©ºçš„ç”»é¢ã€Œå…·è±¡åŒ–ã€ï¼Œè¿™ç§æ„Ÿè§‰çœŸçš„å¾ˆå¥‡å¦™ã€‚ä»¥å‰è§‰å¾—é¥ä¸å¯åŠçš„åŠ¨ç”»åˆ¶ä½œï¼ŒåŠ¨è¾„éœ€è¦ä¸“ä¸šå›¢é˜Ÿè€—æ—¶æ•°æœˆï¼Œç°åœ¨å±…ç„¶åœ¨ä¸€ä¸ªç½‘é¡µé‡Œå°±èƒ½è·‘é€šå…¨æµç¨‹ã€‚è¿™ä¸ä»…ä»…æ˜¯æˆ‘ä¸ªäººçš„å°è¯•ï¼Œæ›´æ˜¯æŠ€æœ¯å¸¦æ¥çš„å¹³æƒã€‚è¿™ä¹Ÿæ­£æ˜¯æµ·èº AI è®©æˆ‘æƒŠå–œçš„åœ°æ–¹ã€‚å®ƒä¸åªæ˜¯ç®€å•åœ°æ¥å…¥äº†ğŸŒPro æˆ–è€… Veo 3.1 è¿™ä¹ˆå¤šé¡¶å°–æ¨¡å‹ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ‰“ç ´äº†æ¨¡å‹ä¹‹é—´çš„ã€Œé«˜å¢™ã€ï¼Œæ¶ˆé™¤äº†ä¸åŒå·¥å…·é—´çš„å‰²è£‚æ„Ÿã€‚å®ƒæŠŠå½“ä»Šæœ€é¡¶çº§çš„ç”»è´¨ã€æœ€ä¸æ»‘çš„è§†é¢‘ç”Ÿæˆèƒ½åŠ›æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸ä»…æŠŠä»·æ ¼æ‰“äº†ä¸‹æ¥ï¼Œæ›´æŠŠé—¨æ§›é™äº†ä¸‹æ¥ã€‚æµ·èº AI æ­£åœ¨ç”¨æŠ€æœ¯å¡«è¡¥æ™®é€šäººä¸ä¸“ä¸šåˆ›ä½œè€…ä¹‹é—´çš„é¸¿æ²Ÿï¼ŒæŠŠåˆ›ä½œçš„é—¨æ§›æ— é™æ‹‰ä½ï¼Œç›´åˆ°ä¸ä½ çš„æƒ³è±¡åŠ›å¹³é½ã€‚åªè¦ä½ æœ‰æ•…äº‹ï¼Œæµ·èº AI å°±èƒ½è¿˜ç»™ä½ ä¸€ä¸ªä¸–ç•Œã€‚åˆ«è®©ä½ çš„æƒ³è±¡åŠ›ï¼Œåªåœç•™åœ¨è„‘æµ·é‡Œã€‚å»è¯•è¯•å§ï¼Œç”¨ AI è®²å‡ºå±äºä½ çš„æ•…äº‹ã€‚æˆ‘æ˜¯è‹ä½•ï¼Œæˆ‘ä»¬ä¸‹æœŸè§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç†è§£iOSä¸­Protobufï¼šä¸€ä¸ªæ¯”JSONæ›´å¥½ï¼Œä½†ä¸æ˜¯æ›¿ä»£]]></title>    <link>https://juejin.cn/post/7581306080435634227</link>    <guid>https://juejin.cn/post/7581306080435634227</guid>    <pubDate>2025-12-08T15:35:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581306080435634227" data-draft-id="7580564126402871346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç†è§£iOSä¸­Protobufï¼šä¸€ä¸ªæ¯”JSONæ›´å¥½ï¼Œä½†ä¸æ˜¯æ›¿ä»£"/> <meta itemprop="keywords" content="iOS,æ¶æ„,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-08T15:35:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sweetä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/3227821869921646"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç†è§£iOSä¸­Protobufï¼šä¸€ä¸ªæ¯”JSONæ›´å¥½ï¼Œä½†ä¸æ˜¯æ›¿ä»£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821869921646/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sweetä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:35:58.000Z" title="Mon Dec 08 2025 15:35:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨iOSå¼€å‘ä¸­ï¼ŒJSONå‡­å€Ÿå…¶å“è¶Šçš„å¯è¯»æ€§å’Œè·¨å¹³å°å…¼å®¹æ€§ï¼Œé•¿æœŸä»¥æ¥éƒ½æ˜¯ç½‘ç»œäº¤äº’å’Œæœ¬åœ°å­˜å‚¨çš„é¦–é€‰ã€‚ä½†ä½ æ˜¯å¦é‡åˆ°è¿‡å› ç½‘ç»œè¯·æ±‚è¿‡æ…¢å¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ï¼Œæˆ–æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶åº”ç”¨å“åº”è¿Ÿç¼“çš„æƒ…å†µï¼Ÿé—®é¢˜çš„æ ¹æºæœ‰æ—¶å°±å‡ºåœ¨æ•°æ®äº¤æ¢çš„æ ¼å¼ä¸Šã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ <strong>Protocol Buffersï¼ˆç®€ç§°Protobufï¼‰</strong> â€”â€”ä¸€ç§ç”±Googleè®¾è®¡çš„ç»“æ„åŒ–æ•°æ®åºåˆ—åŒ–æœºåˆ¶ã€‚è¿™ç¯‡åšå®¢å°†æ¾„æ¸…ä¸€ä¸ªå¸¸è§çš„è¯¯è§£ï¼šå¼•å…¥Protobuf<strong>å¹¶éä¸ºäº†å…¨ç›˜å–ä»£JSON</strong>ï¼Œè€Œæ˜¯ä¸ºäº†åœ¨ä½ å·¥å…·ç®±ä¸­å¢åŠ ä¸€ä¸ªå¼ºæœ‰åŠ›çš„é€‰é¡¹ã€‚æˆ‘ä»¬å°†é‡ç‚¹å‰–æå®ƒç›¸æ¯”JSONçš„æ ¸å¿ƒä¼˜åŠ¿ã€ç‹¬ç‰¹çš„å·¥ä½œåŸç†ã€æœ€é€‚ç”¨çš„åœºæ™¯ï¼Œå¹¶çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•åœ¨ç°å®ä¸­è¢«å¤§å‚ä»¬å¹¿æ³›åº”ç”¨çš„ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€ä¸æ˜¯æ›¿ä»£ï¼Œè€Œæ˜¯è¡¥å……ï¼šProtobufä¸JSONçš„æ ¸å¿ƒå·®å¼‚</h3>
<p>è¦åšå‡ºæ˜æ™ºçš„æŠ€æœ¯é€‰å‹ï¼Œé¦–å…ˆè¦ç†è§£å®ƒä»¬çš„æœ¬è´¨åŒºåˆ«ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„æ¯”å–»ï¼šJSONå¥½æ¯”ä¸€å°ä¿¡ä»¶ï¼Œæ‰€æœ‰äººéƒ½èƒ½è½»æ¾é˜…è¯»ï¼›è€ŒProtobufæ›´åƒä¸€å°å¯†ç ç”µæŠ¥ï¼Œä½“ç§¯å°ã€ä¼ è¾“å¿«ï¼Œä½†éœ€è¦å¯†ç æœ¬ï¼ˆå³<code>.proto</code>å®šä¹‰æ–‡ä»¶ï¼‰æ‰èƒ½è§£è¯»ã€‚</p>
<p>ä¸ºäº†æ›´ç›´è§‚ï¼Œè¯·çœ‹ä¸‹è¡¨å¯¹ä¸¤è€…å…³é”®ç‰¹æ€§çš„å¯¹æ¯”ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§ç»´åº¦</th><th align="left">JSON (æ–‡æœ¬æ ¼å¼)</th><th align="left">Protobuf (äºŒè¿›åˆ¶æ ¼å¼)</th></tr></thead><tbody><tr><td align="left"><strong>å¯è¯»æ€§</strong></td><td align="left"><strong>æé«˜</strong>ï¼Œæ•°æ®æœ¬èº«å°±æ˜¯æ–‡æœ¬ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</td><td align="left"><strong>æä½</strong>ï¼ŒäºŒè¿›åˆ¶æ ¼å¼éš¾ä»¥è‚‰çœ¼è¯†åˆ«ã€‚</td></tr><tr><td align="left"><strong>æ•°æ®ä½“ç§¯</strong></td><td align="left"><strong>è¾ƒå¤§</strong>ã€‚åŒ…å«é‡å¤çš„å­—æ®µåã€å¼•å·ã€æ‹¬å·ç­‰å†—ä½™ä¿¡æ¯ã€‚</td><td align="left"><strong>æå°</strong>ã€‚ç”¨å­—æ®µç¼–å·æ›¿ä»£å­—æ®µåï¼Œç¼–ç ç´§å‡‘ã€‚</td></tr><tr><td align="left"><strong>åºåˆ—åŒ–/ååºåˆ—åŒ–é€Ÿåº¦</strong></td><td align="left">è¾ƒæ…¢ã€‚éœ€è§£ææ–‡æœ¬å­—ç¬¦ä¸²ï¼Œè¿›è¡Œç±»å‹è½¬æ¢ã€‚</td><td align="left"><strong>æå¿«</strong>ã€‚ç›´æ¥å¤„ç†äºŒè¿›åˆ¶æµï¼Œç¼–ç /è§£ç å‡ ä¹ç­‰åŒäºå†…å­˜æ‹·è´ã€‚</td></tr><tr><td align="left"><strong>å¼ºç±»å‹ä¸Schema</strong></td><td align="left">æ— ã€‚ä¾èµ–çº¦å®šï¼Œå®¹æ˜“å‡ºé”™ï¼Œéœ€é¢å¤–æ ¡éªŒå·¥å…·ï¼ˆå¦‚JSON Schemaï¼‰ã€‚</td><td align="left"><strong>æœ‰</strong>ã€‚é€šè¿‡<code>.proto</code>æ–‡ä»¶æ˜ç¡®å®šä¹‰ï¼Œç”Ÿæˆç±»å‹å®‰å…¨çš„ä»£ç ã€‚</td></tr><tr><td align="left"><strong>è·¨ç‰ˆæœ¬å…¼å®¹æ€§</strong></td><td align="left">å¼±ã€‚å¢åˆ å­—æ®µæ˜“å¯¼è‡´å®¢æˆ·ç«¯å´©æºƒï¼Œéœ€è¦ä¸¥æ ¼åè°ƒã€‚</td><td align="left"><strong>å¼º</strong>ã€‚è®¾è®¡ä¸Šå°±æ”¯æŒå‘å‰/å‘åå…¼å®¹ï¼Œæ–°å¢å¯é€‰å­—æ®µæ—§ä»£ç è‡ªåŠ¨å¿½ç•¥ã€‚</td></tr></tbody></table>
<p>ä¸€ä¸ªå…¸å‹ä¾‹å­æ˜¯ï¼ŒåŒæ ·ä¸€æ¡åŒ…å«<code>id</code>, <code>name</code>, <code>email</code>ä¸‰ä¸ªå­—æ®µçš„ç”¨æˆ·ä¿¡æ¯ï¼ŒJSONæ ¼å¼çš„æ–‡æœ¬å¯èƒ½é•¿è¾¾ä¸Šç™¾å­—èŠ‚ï¼Œè€ŒProtobufç¼–ç åå¯èƒ½åªæœ‰åå‡ ä¸ªå­—èŠ‚ï¼Œåœ¨å¼±ç½‘ç¯å¢ƒä¸‹ï¼Œè¿™ç§å·®å¼‚ä¼šç›´æ¥å½±å“Appçš„å“åº”é€Ÿåº¦ã€‚</p>
<p>å› æ­¤ï¼Œ<strong>é€‰å‹çš„å…³é”®åœ¨äºåœºæ™¯</strong>ï¼š</p>
<ul>
<li><strong>å¯¹å¤–APIã€é…ç½®æ–‡ä»¶ã€éœ€è¦æµè§ˆå™¨ç›´æ¥è§£æçš„æ•°æ®</strong>ï¼š<strong>JSONæ˜¯ä¸äºŒä¹‹é€‰</strong>ã€‚</li>
<li><strong>å¯¹å†…çš„å¾®æœåŠ¡é€šä¿¡ã€é«˜é¢‘ç‡RPCè°ƒç”¨ã€ç§»åŠ¨ç«¯å¼±ç½‘ä¼˜åŒ–</strong>ï¼š<strong>Protobufçš„ä¼˜åŠ¿å°†éå¸¸çªå‡º</strong>ã€‚</li>
</ul>
<h3 data-id="heading-1">äºŒã€æ€§èƒ½ä¹‹è°œï¼šProtobufä¸ºä½•å¦‚æ­¤é«˜æ•ˆï¼Ÿ</h3>
<p>Protobufçš„é«˜æ€§èƒ½å¹¶éé­”æ³•ï¼Œè€Œæ˜¯æºäºå…¶ç²¾å·§çš„ç¼–ç è®¾è®¡ã€‚ä¸‹é¢è¿™å¼ å›¾æ¸…æ™°åœ°å±•ç¤ºäº†å®ƒçš„å·¥ä½œåŸç†ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[.proto æ¶ˆæ¯å®šä¹‰æ–‡ä»¶] --&gt; B[protoc ç¼–è¯‘å™¨]
    
    B --&gt; C[ç›®æ ‡è¯­è¨€ä»£ç &lt;br&gt;å¦‚ Swift Class]
    C --&gt; D[åŒ…å«åºåˆ—åŒ–ä¸&lt;br&gt;ååºåˆ—åŒ–æ–¹æ³•]
    
    A --&gt; E[Protobuf ç¼–ç è§„åˆ™]
    
    subgraph E[ç¼–ç è§„åˆ™]
        F[å­—æ®µ: Tag-Length-Value&lt;br&gt;ç¼–ç &lt;br&gt;ç”¨æ•°å­—ç¼–å·ä»£æ›¿å­—æ®µå]
        G[æ•´æ•°: Varint å˜é•¿ç¼–ç &lt;br&gt;å°æ•°å­—èŠ‚æ•°æ›´å°‘]
        H[æœ‰ç¬¦å·æ•´æ•°: ZigZag ç¼–ç &lt;br&gt;ä¼˜åŒ–è´Ÿæ•°å­˜å‚¨]
    end
    
    D -- åºåˆ—åŒ– --&gt; I[ç´§å‡‘çš„äºŒè¿›åˆ¶æ•°æ®]
    I -- ç½‘ç»œä¼ è¾“æˆ–å­˜å‚¨ --&gt; J
    J -- ååºåˆ—åŒ– --&gt; D
</code></pre>
<ul>
<li>
<p><strong>æ ¸å¿ƒ1ï¼šT-L-Vç¼–ç ä¸å­—æ®µç¼–å·</strong>
ProtobufæŠ›å¼ƒäº†å­—æ®µåï¼Œè½¬è€Œä¸ºæ¯ä¸ªå­—æ®µåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„<strong>æ•°å­—ç¼–å·ï¼ˆTagï¼‰</strong>ã€‚åºåˆ—åŒ–æ—¶ï¼Œä¸€ä¸ªå­—æ®µè¢«ç¼–ç ä¸º <code>(Tag, Type, Value)</code> çš„ç»„åˆã€‚æ¥æ”¶æ–¹é€šè¿‡åŒæ ·çš„ <code>.proto</code> æ–‡ä»¶ï¼Œå°±èƒ½å°†ç¼–å·æ˜ å°„å›æ­£ç¡®çš„å­—æ®µåã€‚è¿™ä»æ ¹æœ¬ä¸Šæ¶ˆé™¤äº†JSONä¸­é‡å¤çš„å­—æ®µåå¼€é”€ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒ2ï¼šVarintä¸ZigZagç¼–ç </strong></p>
<ul>
<li><strong>Varintå˜é•¿ç¼–ç </strong>ï¼šå¯¹äºæ•´æ•°ï¼Œå°æ•°å€¼å ç”¨æ›´å°‘çš„å­—èŠ‚ã€‚æ¯ä¸ªå­—èŠ‚çš„æœ€é«˜ä½æ˜¯æ ‡å¿—ä½ï¼Œè¡¨ç¤ºæ˜¯å¦è¿˜æœ‰åç»­å­—èŠ‚ï¼ŒçœŸæ­£æœ‰æ•ˆçš„åªæœ‰ä½7ä½ã€‚è¿™æ„å‘³ç€æ•°å€¼<code>1</code>åªéœ€1ä¸ªå­—èŠ‚ï¼Œè€Œéå›ºå®šçš„4ä¸ªå­—èŠ‚ã€‚</li>
<li><strong>ZigZagç¼–ç </strong>ï¼šä¸“ä¸ºæœ‰ç¬¦å·æ•´æ•°ä¼˜åŒ–ã€‚å®ƒå°†è´Ÿæ•°â€œæ›²æŠ˜â€æ˜ å°„ä¸ºä¸€ç³»åˆ—æ­£æ•°ï¼ˆå¦‚-1æ˜ å°„ä¸º1ï¼Œ1æ˜ å°„ä¸º2ï¼‰ï¼Œä½¿è´Ÿæ•°ä¹Ÿèƒ½åˆ©ç”¨Varintç¼–ç ç´§å‡‘å­˜å‚¨ã€‚</li>
</ul>
</li>
</ul>
<p>æ­£æ˜¯è¿™äº›åº•å±‚è®¾è®¡ï¼Œä½¿å¾—Protobufèƒ½åœ¨æ•°æ®å¤§å°å’Œè§£æé€Ÿåº¦ä¸Šå®ç°æ•°é‡çº§çš„æå‡ã€‚æ ¹æ®Googleçš„æ•°æ®ï¼ŒProtobufç›¸æ¯”XMLï¼Œè§£æé€Ÿåº¦å¯ä»¥æé«˜20åˆ°100å€ï¼Œæ•°æ®ä½“ç§¯å¯å‡å°åˆ°åŸæ¥çš„1/10åˆ°1/3ã€‚</p>
<h3 data-id="heading-2">ä¸‰ã€iOSå¼€å‘ä¸­ï¼Œä½•æ—¶åº”è¯¥è€ƒè™‘Protobufï¼Ÿ</h3>
<p>åŸºäºä»¥ä¸Šç‰¹æ€§ï¼Œåœ¨iOSå¼€å‘ä¸­ï¼Œä»¥ä¸‹å‡ ç§åœºæ™¯ç‰¹åˆ«é€‚åˆå¼•å…¥Protobufï¼š</p>
<ol>
<li><strong>å¾®æœåŠ¡/åç«¯é«˜é¢‘ç‡é€šä¿¡</strong>ï¼šå½“ä½ çš„Appéœ€è¦ä¸åç«¯è¿›è¡Œå¤§é‡ã€å¯†é›†çš„RPCå¼æ•°æ®äº¤æ¢æ—¶ï¼ˆä¾‹å¦‚å³æ—¶é€šè®¯çš„æ¶ˆæ¯æ¨é€ã€å®æ—¶æ¸¸æˆçŠ¶æ€åŒæ­¥ï¼‰ï¼ŒProtobufå‡å°‘çš„æ¯ä¸€ç‚¹å»¶è¿Ÿå’Œæµé‡éƒ½å°†æ±‡èšæˆæ˜¾è‘—çš„ä½“éªŒä¼˜åŠ¿ã€‚</li>
<li><strong>å¼±ç½‘ç¯å¢ƒä¼˜åŒ–</strong>ï¼šå¯¹äºéœ€è¦å…³æ³¨ç§»åŠ¨ç½‘ç»œä¸‹ç”¨æˆ·ä½“éªŒå’Œç”¨æˆ·æµé‡çš„åº”ç”¨ï¼Œæ›´å°çš„æ•°æ®åŒ…æ„å‘³ç€æ›´å¿«çš„åŠ è½½é€Ÿåº¦å’Œæ›´ä½çš„è¯·æ±‚å¤±è´¥ç‡ã€‚</li>
<li><strong>å®¢æˆ·ç«¯æœ¬åœ°æ•°æ®å­˜å‚¨</strong>ï¼šå¯¹äºéœ€è¦ç¼“å­˜å¤§é‡ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚æ–°é—»èµ„è®¯ã€äº§å“ç›®å½•ï¼‰çš„åœºæ™¯ï¼Œä½¿ç”¨Protobufåºåˆ—åŒ–åå­˜å‚¨ï¼Œå¯ä»¥èŠ‚çœå¯è§‚çš„ç£ç›˜ç©ºé—´ï¼Œå¹¶åŠ å¿«è¯»å–é€Ÿåº¦ã€‚</li>
<li><strong>å¼ºç±»å‹ä¸å›¢é˜Ÿåä½œ</strong>ï¼šåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œ<code>.proto</code>æ–‡ä»¶ä½œä¸ºä¸€ä»½æ˜ç¡®çš„ã€è·¨å¹³å°ï¼ˆiOS, Android, åç«¯ï¼‰çš„æ•°æ®åˆåŒï¼Œèƒ½æœ‰æ•ˆå‡å°‘å‰åç«¯è”è°ƒæ—¶çš„ç±»å‹é”™è¯¯å’Œæ²Ÿé€šæˆæœ¬ã€‚</li>
</ol>
<h3 data-id="heading-3">å››ã€ä¸åªæ˜¯ç†è®ºï¼šå¤§å‚ä»¬çš„å®è·µ</h3>
<p>Protobufå¹¶éå®éªŒå®¤æŠ€æœ¯ï¼Œå®ƒå·²ç»åœ¨ä¸šç•Œè¢«å¹¿æ³›é‡‡ç”¨ï¼Œå¹¶æ„æˆäº†ç°ä»£äº‘åŸç”Ÿå’Œå¾®æœåŠ¡æ¶æ„çš„åŸºçŸ³ã€‚</p>
<ul>
<li><strong>Googleçš„â€œäº²å„¿å­â€</strong>ï¼šProtobufè‡ª2001å¹´èµ·åœ¨Googleå†…éƒ¨ç”¨äºå‡ ä¹æ‰€æœ‰RPCé€šä¿¡å’Œæ•°æ®å­˜å‚¨ï¼Œåäº2008å¹´å¼€æºã€‚å®ƒä¹Ÿæ˜¯gRPCæ¡†æ¶é»˜è®¤çš„åºåˆ—åŒ–åè®®ã€‚å¯ä»¥è¯´ï¼ŒGoogleçš„æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿéƒ½æ„å»ºåœ¨Protobufä¹‹ä¸Šã€‚</li>
<li><strong>å­—èŠ‚è·³åŠ¨çš„é€‰æ‹©</strong>ï¼šåœ¨å…¶å¼€æºçš„<strong>Kitex</strong>é«˜æ€§èƒ½Goå¾®æœåŠ¡RPCæ¡†æ¶ä¸­ï¼Œé™¤äº†æ”¯æŒThriftï¼Œä¹Ÿæ·±åº¦æ”¯æŒ<strong>Kitex Protobuf</strong>å’Œ<strong>gRPC</strong>åè®®ï¼Œä»¥åº”å¯¹å…¶æµ·é‡ã€é«˜å¹¶å‘çš„å†…éƒ¨æœåŠ¡é€šä¿¡éœ€æ±‚ã€‚</li>
<li><strong>äº‘åŸç”Ÿç”Ÿæ€çš„æ ‡å‡†</strong>ï¼šåœ¨CNCFï¼ˆäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰ç”Ÿæ€ä¸­ï¼ŒProtobufæ˜¯è®¸å¤šæ ¸å¿ƒé¡¹ç›®çš„é»˜è®¤æˆ–é‡è¦é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œåœ¨æœåŠ¡ç½‘æ ¼<strong>Istio</strong>ã€åˆ†å¸ƒå¼è¿½è¸ªç­‰ç³»ç»Ÿä¸­ï¼Œéƒ½å¹¿æ³›ä½¿ç”¨Protobufè¿›è¡Œé«˜æ•ˆçš„æ•°æ®äº¤æ¢ã€‚</li>
<li>å¼€æºæ¡†æ¶MMKVï¼ŒåŸºäºProtobufè¿›è¡Œåºåˆ—åŒ–å­˜å‚¨æå‡äº†æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-4">äº”ã€åœ¨iOSé¡¹ç›®ä¸­å¦‚ä½•å¼€å§‹ï¼Ÿ</h3>
<p>åœ¨iOSé¡¹ç›®ä¸­ä½¿ç”¨Protobufçš„æµç¨‹éå¸¸æ ‡å‡†åŒ–ï¼š</p>
<ol>
<li><strong>å®šä¹‰å¥‘çº¦</strong>ï¼šç¼–å†™ <code>.proto</code> æ–‡ä»¶ï¼Œå®šä¹‰ä½ çš„è¯·æ±‚å’Œå“åº”æ•°æ®ç»“æ„ã€‚
<pre><code class="hljs language-protobuf" lang="protobuf">syntax = "proto3";
message UserRequest {
  int32 user_id = 1;
}
message UserProfile {
  string name = 1;
  string email = 2;
  int32 age = 3;
}
</code></pre>
</li>
<li><strong>ç”Ÿæˆä»£ç </strong>ï¼šä½¿ç”¨ <code>protoc</code> ç¼–è¯‘å™¨é…åˆ Swift æ’ä»¶ï¼Œå°† <code>.proto</code> æ–‡ä»¶ç¼–è¯‘ä¸º Swift ç±»ã€‚
<pre><code class="hljs language-bash" lang="bash">protoc --swift_out=. your_proto_file.proto
</code></pre>
</li>
<li><strong>é›†æˆä¸ä½¿ç”¨</strong>ï¼šå°†ç”Ÿæˆçš„Swiftæ–‡ä»¶åŠ å…¥é¡¹ç›®ã€‚ç„¶åï¼Œä½ å°±å¯ä»¥åƒä½¿ç”¨æ™®é€šå¯¹è±¡ä¸€æ ·è¿›è¡Œåºåˆ—åŒ–ï¼ˆ<code>serializeToData()</code>ï¼‰å’Œååºåˆ—åŒ–ï¼ˆ<code>init(serializedData:)</code>ï¼‰ã€‚</li>
<li><strong>ç½‘ç»œå±‚æ•´åˆ</strong>ï¼šé€šå¸¸éœ€è¦å°†ç½‘ç»œå±‚ä»åŸºäºJSONçš„<code>URLSession</code>é€‚é…ä¸ºæ”¯æŒProtobufäºŒè¿›åˆ¶æµçš„æ ¼å¼ï¼Œæˆ–ç›´æ¥ä½¿ç”¨åŸºäºProtobufçš„gRPCæ¡†æ¶ã€‚</li>
</ol>
<h3 data-id="heading-5">æ€»ç»“ä¸æœ€ä½³å®è·µ</h3>
<p>å›åˆ°æœ€åˆçš„è§‚ç‚¹ï¼š<strong>Protobufä¸æ˜¯JSONçš„æ›¿ä»£å“ï¼Œè€Œæ˜¯åœ¨ç‰¹å®šé—®é¢˜åŸŸæ›´ä¼˜çš„è§£å†³æ–¹æ¡ˆ</strong>ã€‚</p>
<p>ä¸€ä¸ªç°ä»£ã€å¥å£®çš„æ¶æ„å¾€å¾€æ˜¯æ··åˆå¼çš„ï¼š</p>
<ul>
<li>å¯¹<strong>å¤–</strong>é¢å‘æµè§ˆå™¨ã€ç§»åŠ¨ç«¯æˆ–ç¬¬ä¸‰æ–¹å¼€å‘è€…çš„APIï¼Œç»§ç»­ä½¿ç”¨<strong>JSON</strong>ï¼Œä¿è¯æœ€å¤§çš„å…¼å®¹æ€§å’Œå¯è°ƒè¯•æ€§ã€‚</li>
<li>åœ¨<strong>å†…</strong>éƒ¨æœåŠ¡é—´ã€å¯¹æ€§èƒ½æœ‰æè‡´è¦æ±‚çš„ç§»åŠ¨ç«¯æ•°æ®é€šé“ï¼Œé‡‡ç”¨<strong>Protobuf</strong>ï¼Œè¿½æ±‚æè‡´çš„æ•ˆç‡å’Œç±»å‹å®‰å…¨ã€‚</li>
</ul>
<p>ä½œä¸ºiOSå¼€å‘è€…ï¼Œç†è§£Protobufçš„åŸç†å’Œä¼˜åŠ¿ï¼Œèƒ½è®©ä½ åœ¨é¢ä¸´æ€§èƒ½ç“¶é¢ˆã€æ€è€ƒæ¶æ„ä¼˜åŒ–æ—¶ï¼Œå¤šä¸€ä¸ªå¼ºå¤§è€Œæˆç†Ÿçš„é€‰æ‹©ã€‚æŠ€æœ¯å†³ç­–æ²¡æœ‰é“¶å¼¹ï¼Œåªæœ‰å¯¹åœºæ™¯æœ€åˆé€‚çš„æƒè¡¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿™5ä¸ªAIæ–‡æœ¬å¯è§†åŒ–å·¥å…·å¤ªå¼ºäº†ï¼ä¸€é”®æŠŠæ–‡æœ¬è½¬ä¿¡æ¯å›¾ã€æµç¨‹å›¾ç­‰å¤šç§å¯è§†åŒ–å½¢å¼ï¼PPTç§’å˜é«˜çº§ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰]]></title>    <link>https://juejin.cn/post/7581297335315464244</link>    <guid>https://juejin.cn/post/7581297335315464244</guid>    <pubDate>2025-12-08T15:47:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581297335315464244" data-draft-id="7581354812860825652" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿™5ä¸ªAIæ–‡æœ¬å¯è§†åŒ–å·¥å…·å¤ªå¼ºäº†ï¼ä¸€é”®æŠŠæ–‡æœ¬è½¬ä¿¡æ¯å›¾ã€æµç¨‹å›¾ç­‰å¤šç§å¯è§†åŒ–å½¢å¼ï¼PPTç§’å˜é«˜çº§ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-08T15:47:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Xå°é¹¿"/> <meta itemprop="url" content="https://juejin.cn/user/2928754709505608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿™5ä¸ªAIæ–‡æœ¬å¯è§†åŒ–å·¥å…·å¤ªå¼ºäº†ï¼ä¸€é”®æŠŠæ–‡æœ¬è½¬ä¿¡æ¯å›¾ã€æµç¨‹å›¾ç­‰å¤šç§å¯è§†åŒ–å½¢å¼ï¼PPTç§’å˜é«˜çº§ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754709505608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Xå°é¹¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:47:58.000Z" title="Mon Dec 08 2025 15:47:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Xå°é¹¿ã€‚</p>
<p>å‰å‡ å¤©è¢«è¯»è€…é—®åˆ°äº†ã€Œæ–‡æœ¬å¯è§†åŒ–ã€å·¥å…·ï¼Œè¶ç€å‘¨æœ«ï¼Œæ•´ç†äº†ä¸‹ä¹‹å‰ä½“éªŒè¿‡çš„å‡ æ¬¾è¿˜ä¸é”™çš„ AI å·¥å…·ã€‚</p>
<p>è¿™äº› AI å·¥å…·éƒ½å¯ä»¥<strong>ä¸€é”®å°†æ¯ç‡¥çš„æ–‡æœ¬ï¼Œè½¬åŒ–ä¸ºç²¾ç¾ä¿¡æ¯å›¾ã€æ•°æ®å›¾ã€å¡ç‰‡ç­‰å½¢å¼</strong>ã€‚</p>
<p>ä¸ç®¡æ˜¯åœ¨é¡¹ç›®æ±‡æŠ¥ä¸­æ’å…¥ï¼Œè¿˜æ˜¯ç”¨äº PPT é…å›¾ã€æ–‡ç« é…å›¾ã€ç”Ÿæˆç§‘æ™®å›¾æ–‡ã€è¯»ä¹¦ç¬”è®°å¡ç‰‡ã€è‡ªåª’ä½“å›¾æ–‡åˆ›ä½œç­‰åœºæ™¯ï¼Œéƒ½æ˜¯å¯ä»¥çš„ã€‚</p>
<p><strong>ä¸‹é¢åˆ†äº« 5 ä¸ªç›®å‰å›½å†…å¤–ç”¨å¾—è¾ƒå¤šã€Œæ–‡æœ¬å¯è§†åŒ–ã€å·¥å…·ã€‚</strong></p>
<p>æœ‰éœ€è¦çš„å¯ä»¥ä¿å­˜ä¸‹ï¼Œæ—©æ™šç”¨å¾—ä¸Šï½</p>
<h2 data-id="heading-0">ä¸€ã€Seede AI</h2>
<p>ç¬¬ä¸€ä¸ªï¼ŒSeede AIï¼Œä¸€æ¬¾é€‚åˆæ™®é€šäººä¸Šæ‰‹çš„ AI è®¾è®¡å·¥å…·ï¼Œå›½å†…å¯ç”¨ã€‚</p>
<p>åªéœ€è¦æŠŠæ–‡æ¡ˆè¾“è¿›å»ï¼Œå®ƒå°±èƒ½è‡ªåŠ¨å®Œæˆéœ€æ±‚åˆ†æã€å¸ƒå±€ã€è®¾è®¡ã€å›¾åƒå¤„ç†ç­‰ï¼Œè¾“å‡ºè§†è§‰é£æ ¼ä¸é”™çš„å›¾ç‰‡ã€‚</p>
<p>Seede AI ä¹Ÿæ˜¯Xå°é¹¿æœ€è¿‘ä¸€ç›´åœ¨ç”¨çš„ä¸€æ¬¾ AI å·¥å…·ï¼Œå°¤å…¶æ˜¯å®ƒåœ¨æ¥å…¥äº†è°·æ­Œçš„Â <strong>Gemini 3 Pro</strong>Â åï¼Œå‡ºå›¾æ•ˆæœæ›´å¼ºäº†ã€‚</p>
<p>ä¸ç®¡æ˜¯åœ¨å¸ƒå±€æ’ç‰ˆä¸Šï¼Œè¿˜æ˜¯é…è‰²å’Œæ•´ä½“è´¨æ„Ÿä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfbbcae1b2b94e8a8478914c2ced579b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=pjUJYu8nyc3oc%2BmkFWGzzL%2FkUyo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¾ˆå–œæ¬¢ Seede AI é‡Œé¢çš„ã€Œé•¿å›¾ã€ç”ŸæˆåŠŸèƒ½ï¼Œå¾ˆé€‚åˆæ¥ç”Ÿæˆç§‘æ™®å›¾æ–‡ã€‚</p>
<p>æ¯”å¦‚è¾“å…¥ï¼š<code>ç”Ÿæˆä¸€ä¸ªå…³äºxxçš„ç§‘æ™®å›¾æ–‡ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼š[è¾“å…¥æ–‡æ¡ˆ]</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/393d667c0c2548599492999a10a1a665~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=Shmfgpnh7JkiN1N1c6yBa1IfQ5g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Seede AI å°±ä¼šæ ¹æ®æˆ‘ä»¬è¾“å…¥çš„æ–‡æ¡ˆå†…å®¹ï¼Œå°†æ–‡æœ¬è½¬åŒ–ä¸ºä¸€å¼ ç²¾ç¾é•¿å›¾ï¼Œä¸‹é¢æ˜¯ç”Ÿæˆçš„æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96e01e62db614a7b8f6c729a4e16ed43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=xXLNyGKOYcp8spoZb27MuPm%2Bzcw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è€Œä¸” Seede AI è¿˜ä¼šå°†ç”Ÿæˆçš„å›¾ç‰‡æ‹†åˆ†ä¸ºå„ä¸ªå›¾å±‚å’Œå…ƒç´ ï¼Œç”»é¢ä¸Šçš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œå°±å¾ˆæ–¹ä¾¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0be13b8b47d94a05bfb625864fff02af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=sJMcVf7uYf3o%2BFpFD%2FU9EGS8B5g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é™¤äº†åšç§‘æ™®å›¾æ–‡ï¼Œè¿˜å¯ä»¥ç”¨ Seede AI æ¥ç”Ÿæˆ<code>çŸ¥è¯†å¡ç‰‡</code>ã€<code>ç¤¾ç¾¤æ—©æŠ¥</code>ã€<code>è¯»ä¹¦ç¬”è®°æ‘˜è¦</code>ã€<code>æµ·æŠ¥</code>ã€<code>æµç¨‹å›¾</code>ã€<code>ç¤¾åª’å›¾æ–‡æˆ–å°é¢</code>ç­‰ã€‚</p>
<p>æ›´è¯¦ç»†çš„ä»‹ç»åŠæ•™ç¨‹ï¼Œå¯ä»¥çœ‹ä¹‹å‰çš„æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7577958825342795795" target="_blank" title="https://juejin.cn/post/7577958825342795795">è¿™æ¬¾AIå·¥å…·å¤ªæƒŠå–œäº†ï¼1åˆ†é’Ÿç”Ÿæˆç²¾ç¾é•¿å›¾ï¼Œè‡ªç”±ç¼–è¾‘åƒPPTï¼è¿˜å…è´¹å¯ç”¨ï¼ï¼ˆé™„ä¿å§†çº§æ•™ç¨‹ï¼‰</a></p>
<p><strong>Seede</strong> <strong>AI</strong> <strong>ç½‘å€ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fseede.ai%2Fsign-up%3FinviteCode%3DA34LNT" target="_blank" title="https://seede.ai/sign-up?inviteCode=A34LNT" ref="nofollow noopener noreferrer">seede.ai/sign-up?invâ€¦</a></p>
<p>psï¼šSeede AI ç›®å‰æ¯å¤©éƒ½æœ‰å…è´¹ä½¿ç”¨æ¬¡æ•°ã€‚ï¼ˆæ³¨å†Œæ—¶é‚€è¯·ç å¡«Â <strong>A34LNT</strong>ï¼Œè¿˜å¯ä»¥è·å¾—é¢å¤–çš„ä½¿ç”¨é¢åº¦ï¼‰</p>
<h2 data-id="heading-1">äºŒã€Napkin</h2>
<p>ç¬¬äºŒä¸ªï¼ŒNapkinï¼Œä¸€æ¬¾ AI é©±åŠ¨çš„æ–‡æœ¬è§†è§‰åŒ–å·¥å…·ã€‚</p>
<p>Napkin èƒ½æ™ºèƒ½ç†è§£æ–‡æœ¬å†…å®¹ã€è‡ªåŠ¨æ€»ç»“é‡ç‚¹å’Œåˆ’åˆ†å±‚çº§ã€‚</p>
<p>æ¯”å¦‚ï¼Œåœ¨ Napkin é‡Œé€‰ä¸­æˆ‘ä»¬æƒ³ç”Ÿæˆå¯è§†åŒ–è§†å›¾çš„æ–‡æœ¬ï¼Œç‚¹å·¦ä¾§çš„æŒ‰é’®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f85136db03154d62aa327d40efb2c2e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=dJvgd45XXNv9wnFmeynwJBa%2FQAQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Napkin å°±ä¼šæ ¹æ®æ–‡æœ¬å†…å®¹ï¼Œç”ŸæˆåŒ…æ‹¬æ€ç»´å¯¼å›¾ã€æµç¨‹å›¾ã€å¯¹æ¯”å›¾ã€æ•°æ®å›¾ã€æ—¶é—´çº¿å›¾ç­‰å‡ åç§è§†è§‰æ•ˆæœä¾›æˆ‘ä»¬é€‰æ‹©ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5a29e53e8844374b907323c0e37aeb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=m%2Bd5l8Lq4sskO9Es4Xg6p0xZKsY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿˜å¯ä»¥å¯¹ç”Ÿæˆå¥½çš„è§†å›¾è¿›è¡Œå†æ¬¡ç¼–è¾‘ã€‚</p>
<p>åŒ…æ‹¬æ–‡æœ¬å†…å®¹ã€å­—ä½“ã€é¢œè‰²ã€å½¢çŠ¶ã€æ·»åŠ å°å›¾æ ‡ã€æ·»åŠ æ–‡æœ¬ã€æ·»åŠ è¿çº¿ã€æ·»åŠ å¤–éƒ¨å›¾ç‰‡ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96f3dc234a604a7a96f6594212f6d418~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=ki5Z98w8yc5VqafAo2BR92YOjoo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ›´è¯¦ç»†çš„ä»‹ç»åŠæ•™ç¨‹ï¼Œå¯ä»¥çœ‹ä¹‹å‰çš„æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7478280656586424361" target="_blank" title="https://juejin.cn/post/7478280656586424361">DeepSeek+Napkinç»äº†ï¼1åˆ†é’Ÿæå®šé«˜é¢œå€¼å›¾è¡¨ï¼ŒPPTæ•‘æ˜Ÿï¼åªéœ€2æ­¥ï¼Œ90%çš„äººéƒ½ä¸çŸ¥é“ï¼ï¼ˆé™„ä¿å§†çº§æ•™ç¨‹ï¼‰</a></p>
<p><strong>Napkin ç½‘å€ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.napkin.ai%2F" target="_blank" title="https://www.napkin.ai/" ref="nofollow noopener noreferrer">www.napkin.ai/</a></p>
<p>psï¼šç›®å‰ Napkin æ¯å‘¨æœ‰ 500 ç§¯åˆ†å¯å…è´¹ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€PicDoc</h2>
<p>ç¬¬ä¸‰ä¸ªï¼ŒPicDocï¼Œä¹Ÿæ˜¯ä¸€æ¬¾ AI é©±åŠ¨çš„æ–‡æœ¬è½¬è§†è§‰å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f84f4b86c60545fdac4c355941f9a62e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=mrOFt9qThsQAwzjxXjWrM1uuZNc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å’Œ Napkin çš„ç”¨æ³•å¾ˆåƒï¼Œä¹Ÿæ˜¯é€‰ä¸­æƒ³å¯è§†åŒ–çš„æ–‡æœ¬ï¼Œå®ƒå°±èƒ½ç”ŸæˆåŒ…æ‹¬ç»“æ„å›¾ã€å¾ªç¯å›¾ã€é±¼éª¨å›¾ç­‰è¿‘ç™¾ç§ä¿¡æ¯å›¾å’Œæ•°æ®å›¾ã€‚</p>
<p>ä½†å’Œ Napkin ç›¸æ¯”ï¼ŒPicDoc æ˜¯å…¨ä¸­æ–‡çš„ç•Œé¢ï¼Œå¯¹å›½å†…ç”¨æˆ·æ›´å‹å¥½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/265cfb989c374f199e4fe6ac46faa2ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=jidrIRC6opBD2rMoMRDNg9tAr9k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4f232b14d9041d884b3f1f715ab8605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=6znIAa9PzBU2Y4bImcCyKTPauLw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>PicDoc ç”Ÿæˆåçš„å›¾ç‰‡ï¼Œä¹Ÿæ˜¯æ”¯æŒå†æ¬¡ç¼–è¾‘çš„ã€‚</p>
<p>æ›´è¯¦ç»†çš„ä»‹ç»åŠæ•™ç¨‹ï¼Œå¯ä»¥çœ‹ä¹‹å‰çš„æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7518696088652906523" target="_blank" title="https://juejin.cn/post/7518696088652906523">å®Œå…¨å…è´¹ï¼åˆ«å·Napkinäº†ï¼Œè¿™æ¬¾å›½äº§çš„æ–‡æœ¬è½¬è§†å›¾ç¥å™¨æ€ç–¯äº†ï¼2æ­¥æå®šé«˜é¢œå€¼å›¾è¡¨ï¼Œæ•ˆç‡é£™å‡80%ï¼ˆå»ºè®®æ”¶è—ï¼‰</a></p>
<p><strong>PicDoc ç½‘å€ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.picdoc.cn%2F" target="_blank" title="https://www.picdoc.cn/" ref="nofollow noopener noreferrer">www.picdoc.cn/</a></p>
<p>psï¼šPicDoc ç›®å‰æ¯å‘¨æœ‰ 1000 ç§¯åˆ†ã€‚</p>
<h2 data-id="heading-3">å››ã€å¯èµAi</h2>
<p>ç¬¬å››ä¸ªï¼Œå¯èµAiï¼Œä¸€æ¬¾ AI åŠå…¬å¯è§†åŒ–å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac2aaa072f7049978d45c6c93eb7e5da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=lP3bAu1vyTnw5bNMMQZ9aTVYg3Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å’Œ Napkinã€PicDoc ç›¸æ¯”ï¼Œã€Œå¯èµAiã€æ”¯æŒæ›´å¤šçš„å¯è§†åŒ–å½¢å¼ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å›¾ä¾‹</strong></li>
<li><strong>å›¾è¡¨</strong>ï¼ˆè¡¨æ ¼ã€æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ã€é›·è¾¾å›¾ã€é¥¼å›¾ï¼‰</li>
<li><strong>å¡ç‰‡</strong></li>
<li><strong>æ€ç»´å¯¼å›¾</strong>ï¼ˆè„‘å›¾ï¼‰</li>
<li><strong>å¤šå›¾æ’ç‰ˆ</strong>ï¼ˆé€‚åˆå‘å¸ƒå°çº¢ä¹¦ã€å°ç»¿ä¹¦ã€æŠ–éŸ³ç­‰å¤šç§åœºæ™¯ï¼‰</li>
<li><strong>é•¿å›¾æ’ç‰ˆ</strong>ï¼ˆé€‚åˆå‘å¸ƒå…¬ä¼—å·ã€è¥é”€å±•ç¤ºã€å®£ä¼ ç­‰å¤šç§åœºæ™¯ï¼‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26effcebc2d742ba852772df9387c119~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=qNAvXOUofOWuMay6FakNwcKXetk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å›¾ä¾‹å½¢å¼ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55240263ff9a4c16beecfe38c27c80fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=ogKpsrsAlCiDVGOXbZ0WmwN%2Bz%2Bc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å›¾è¡¨å½¢å¼ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36bc7150bc5a4051a180d76cd26c11f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=JOH7aX%2BHHQV9dzzIEhIHT7tnwGg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å¡ç‰‡å½¢å¼ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c555ce7c903d44fcbfdc01879c000a26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=6ed2WoM0VRw2XEvRrrv%2FCUT4Qro%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ€ç»´å¯¼å›¾å½¢å¼ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dddebc1898d4e72878e94a04c0eb139~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=G9Lc0lG2xQmSgVIuSNxcHJEaalM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å°çº¢ä¹¦å½¢å¼ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30596c88fc4846fe9af20eaa3f7c940d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=W2Ihy29Mpfosd4z2wsxvcQCZNWU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ›´è¯¦ç»†çš„ä»‹ç»åŠæ•™ç¨‹ï¼Œå¯ä»¥çœ‹ä¹‹å‰çš„æ–‡ç« ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FVQa3ePlILdRLVgmXM99MVQ" target="_blank" title="https://mp.weixin.qq.com/s/VQa3ePlILdRLVgmXM99MVQ" ref="nofollow noopener noreferrer">è¿™æ¬¾AIåŠå…¬å¯è§†åŒ–å·¥å…·ç»äº†ï¼åªéœ€2æ­¥ï¼Œæ–‡æœ¬è½»æ¾è½¬æ€ç»´å¯¼å›¾ã€å›¾è¡¨ã€é•¿å›¾ã€å°çº¢ä¹¦å›¾æ–‡ã€å¡ç‰‡ç­‰ï¼Œæ‰“å·¥äººé€Ÿå­˜ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰</a></p>
<p><strong>ã€Œå¯èµ<strong><strong>Ai</strong></strong>ã€ ç½‘å€ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fkezign.cn" target="_blank" title="https://kezign.cn" ref="nofollow noopener noreferrer">kezign.cn</a></p>
<p>psï¼šã€Œå¯èµAiã€ç›®å‰ä¹Ÿæ˜¯æ¯å¤©éƒ½æœ‰å…è´¹ä½¿ç”¨æ¬¡æ•°ã€‚</p>
<h2 data-id="heading-4">äº”ã€Infograghy</h2>
<p>ç¬¬äº”ä¸ªï¼ŒInfograghyï¼Œå¯ä»¥æŠŠä»»æ„æ–‡æœ¬è½¬åŒ–ä¸ºä¿¡æ¯å›¾è¡¨çš„å½¢å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc9057e646d649dabe4f0da421f3efe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=hCNkvO5%2FQHNSNs5yi4RAktDkZQk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åªéœ€è¦æŠŠæ–‡æœ¬ç²˜è´´è¿‡å»ï¼Œè®¾ç½®å¥½ã€Œæ¯”ä¾‹ã€ï¼Œå®ƒå°±å¯ä»¥ç”Ÿæˆå¤šå¼ ç²¾ç¾çš„ä¿¡æ¯å›¾è¡¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11c725f3a2454bc0bf1110ff7919365f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=GQ4pCNICRboDRdiGrUYE2MUrGaU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥ä¸¢ä¸€ä¸ªé“¾æ¥ã€ä¸€ä¸ª PDFã€æˆ–è¾“å…¥ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>ç”Ÿæˆå¥½çš„å›¾è¡¨ï¼Œä¹Ÿå¯ä»¥å†æ¬¡ç¼–è¾‘ã€‚</p>
<p>æ¯”å¦‚ä¿®æ”¹æ–‡å­—å†…å®¹ã€å­—ä½“ã€å­—å·å¤§å°ã€é¢œè‰²ï¼Œç”šè‡³æ›¿æ¢ã€æ·»åŠ å›¾ç‰‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f377c896d2f14b18b23af30ee3d404b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=BcKbLobdLtQRdx5RMyRwjBci%2Bf4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½ è¿˜å¯ä»¥ç›´æ¥ä»å®ƒæä¾›çš„æ¨¡æ¿ä¸­é€‰æ‹©å–œæ¬¢çš„é£æ ¼ï¼Œç„¶åæ‰‹åŠ¨æ›¿æ¢æˆä½ çš„æ–‡æœ¬æˆ–å›¾ç‰‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3be8f1cb03742678ed8873488727292~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765813677&amp;x-signature=ZNGHO0FodPcCu42qCdL5S%2FRQv%2BI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>Infograghy ç½‘å€ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Finfography.in%2F" target="_blank" title="https://infography.in/" ref="nofollow noopener noreferrer">infography.in/</a></p>
<p>psï¼šå…è´¹ä½“éªŒé¢åº¦è¾ƒå°‘ï¼ˆç›®å‰æ˜¯ 5 æ¬¡ï¼‰</p>
<h2 data-id="heading-5">å…­ã€å†™åœ¨æœ€å</h2>
<p>è¿™ 5 æ¬¾éƒ½æ˜¯å¾ˆå¥½ç”¨çš„æ–‡æœ¬å¯è§†åŒ–å·¥å…·ã€‚</p>
<p>é™¤äº†ç¬¬ 5 ä¸ªå·¥å…· Infography çš„å…è´¹é¢åº¦æ¯”è¾ƒå°‘å¤–ï¼Œå…¶ä»– 4 ä¸ªç›®å‰æ¯å‘¨ã€æ¯å¤©éƒ½èƒ½é¢†å…è´¹ä½¿ç”¨æ¬¡æ•°ã€‚</p>
<p>å¯ä»¥ç”¨äºé¡¹ç›®æ±‡æŠ¥ä¸­ï¼ˆæ’å…¥ PPT / Word ç­‰æ–‡æ¡£ï¼‰ï¼Œæˆ–è€…ç»™æ–‡ç« é…å›¾ã€ç”Ÿæˆè‡ªåª’ä½“å›¾æ–‡ç­‰å¤šç§åœºæ™¯ã€‚</p>
<p>æœ‰éœ€è¦çš„å¯ä»¥æ”¶è—ä¸€ä¸‹ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯ä»Šå¤©çš„åˆ†äº«ï¼Œæ„Ÿå…´è¶£çš„å¿«é€Ÿè¯•è¯•å§~</p>
<hr/>
<blockquote>
<p>æˆ‘æ˜¯<a href="https://juejin.cn/user/2928754709505608/posts" title="https://juejin.cn/user/2928754709505608/posts" target="_blank">ç¨‹åºå‘˜Xå°é¹¿</a>ï¼Œå‰äº’è”ç½‘å¤§å‚ç¨‹åºå‘˜ï¼Œä¹Ÿæ˜¯ä¸€å AIGC çˆ±å¥½è€…ï¼ŒæŒç»­åˆ†äº«æ›´å¤šå¥½ç”¨çš„ AI å·¥å…·ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµ~</p>
</blockquote>
<p><strong>æ¨èé˜…è¯»</strong></p>
<p><a href="https://juejin.cn/post/7454501732203610131" title="https://juejin.cn/post/7454501732203610131" target="_blank">2024å¹´ç»ˆAIå·¥å…·æ±‡æ€»ï¼š9å¤§AIé¢†åŸŸï¼Œ70+ç²¾é€‰AIå·¥å…·ï¼Œå…¨éƒ½åœ¨è¿™äº†ï¼(å»ºè®®æ”¶è—)</a></p>
<p>æ›´å¤š AI å·¥å…·è§<a href="https://juejin.cn/column/7284164153576947724" title="https://juejin.cn/column/7284164153576947724" target="_blank">ã€AIå·¥å…·ã€‘</a>ä¸“æ ï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®¡ç®—æœºåä¸‡ä¸ªä¸ºä»€ä¹ˆ--æ•°æ®åº“ç´¢å¼•]]></title>    <link>https://juejin.cn/post/7581292270962114570</link>    <guid>https://juejin.cn/post/7581292270962114570</guid>    <pubDate>2025-12-08T15:57:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581292270962114570" data-draft-id="7581292270962081802" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®¡ç®—æœºåä¸‡ä¸ªä¸ºä»€ä¹ˆ--æ•°æ®åº“ç´¢å¼•"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T15:57:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®¡ç®—æœºåä¸‡ä¸ªä¸ºä»€ä¹ˆ--æ•°æ®åº“ç´¢å¼•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T15:57:08.000Z" title="Mon Dec 08 2025 15:57:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è®¡ç®—æœºåä¸‡ä¸ªä¸ºä»€ä¹ˆ--æ•°æ®åº“ç´¢å¼•</h2>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæ¬¢è¿æ¥åˆ°æœ€æ–°ä¸€æœŸçš„æ— é™å¤§åšå®¢ã€‚</p>
<p>çªç„¶å‘ç°è‡ªå·±å¯¹æ•°æ®åº“ç›¸å…³çš„å†…å®¹æŒæ¡ä¸å¤Ÿæ‰å®ï¼Œäºæ˜¯å°±å»å­¦ä¹ äº†ä¸€ä¸‹ï¼Œé¡ºä¾¿ä¹Ÿå°†è‡ªå·±çš„ç†è§£å†™æˆäº†ä¸€ç¯‡åšå®¢ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©</p>
</blockquote>
<h3 data-id="heading-1">æ•°æ®åº“ç´¢å¼•ï¼šç»™æ•°æ®ä»“åº“è£…ä¸ª"æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ" ğŸ§­</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ èµ°è¿›ä¸€ä¸ªå åœ° 1000 å¹³æ–¹ç±³çš„è¶…çº§å›¾ä¹¦é¦† ğŸ“šï¼Œé‡Œé¢å¡æ»¡äº†å‡ åä¸‡æœ¬ä¹¦ï¼Œå´è¿ä¸ªåˆ†ç±»ç‰Œéƒ½æ²¡æœ‰ã€‚è€æ¿å¿½ç„¶å–Šä½ æ‰¾ä¸€æœ¬ã€Šæ•°æ®åº“ä»å…¥é—¨åˆ°æ”¾å¼ƒã€‹ï¼Œä½ æ˜¯ä¸æ˜¯å½“åœºæƒ³è¡¨æ¼”ä¸€ä¸ªåŸåœ°æ¶ˆå¤±æœ¯ï¼ŸğŸ˜±</p>
<p>è¿™å°±æ˜¯<strong>æ²¡æœ‰ç´¢å¼•çš„æ•°æ®åº“</strong>çš„æ—¥å¸¸ï¼æ¯æ¬¡æŸ¥è¯¢éƒ½åƒè’™çœ¼æ‰¾ä¹¦ï¼Œå…¨è¡¨æ‰«æå°±æ˜¯é‚£ä¸ªè¢«è’™ä½çœ¼ç›çš„å€’éœ‰è›‹ï¼Œåªèƒ½ä¸€æœ¬æœ¬æ‘¸è¿‡å»ã€‚è€Œä»Šå¤©æˆ‘ä»¬è¦èŠçš„ <strong>æ•°æ®åº“ç´¢å¼•</strong> ï¼Œå°±æ˜¯ç»™è¿™ä¸ªæ··ä¹±å›¾ä¹¦é¦†è£…ä¸Šçš„æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ ğŸ§­ï¼Œè®©ä½ ç§’å˜å›¾ä¹¦é¦†é¦†é•¿ï¼Œæƒ³æ‰¾å“ªæœ¬ä¹¦å°±æ‰¾å“ªæœ¬ä¹¦ï¼</p>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆ"like '%å…³é”®è¯%'"ä¼šè®©ç´¢å¼•å½“åœºç½¢å·¥ï¼Ÿ</h3>
<p>å…ˆçœ‹ä¸ªçµé­‚æ‹·é—®ï¼šä¸‹é¢ä¸¤æ¡ SQLï¼Œæ€§èƒ½å¯èƒ½å·® 1000 å€ï¼ä½ çŒœå“ªä¸ªå¿«ï¼Ÿ</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¯­å¥ A</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> books <span class="hljs-keyword">WHERE</span> title <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'æ•°æ®åº“%'</span>;

<span class="hljs-comment">-- è¯­å¥ B</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> books <span class="hljs-keyword">WHERE</span> title <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%æ•°æ®åº“%'</span>;
</code></pre>
<p>ç­”æ¡ˆæ˜¯<strong>è¯­å¥ A å¯èƒ½å¿«åˆ°é£èµ·ï¼Œè¯­å¥ B å¯èƒ½æ…¢åˆ°æƒ³ç ¸é”®ç›˜</strong> ï¼</p>
<p>åŸå› å°±è—åœ¨é‚£ä¸ªå°å°çš„ç™¾åˆ†å·é‡Œã€‚</p>
<h4 data-id="heading-3">ğŸŒ° è’™çœ¼æ‰¾ä¹¦ç°åœºè¿˜åŸ</h4>
<p>å‡è®¾æˆ‘ä»¬ç»™ title å­—æ®µå»ºäº†ç´¢å¼•ï¼Œå°±åƒå›¾ä¹¦é¦†æŒ‰ä¹¦åé¦–å­—æ¯æ’åºçš„åˆ†ç±»æ¶ã€‚å½“ä½ æ‰§è¡Œ LIKE 'æ•°æ®åº“%' æ—¶ï¼Œç´¢å¼•ä¼šå¼€å¿ƒåœ°å¸¦ä½ ç›´å¥” "æ•°" å­—åŒºï¼Œä» "æ•°æ®åº“å…¥é—¨" æ‰¾åˆ° "æ•°æ®åº“åŸç†"ï¼Œä¸€æ°”å‘µæˆ ğŸš€ã€‚</p>
<p>ä½†å¦‚æœå†™æˆ LIKE '%æ•°æ®åº“%'ï¼Œç›¸å½“äºä½ å‘Šè¯‰å›¾ä¹¦ç®¡ç†å‘˜ï¼š"æˆ‘è¦æ‰¾æ‰€æœ‰ä¹¦åé‡ŒåŒ…å«'æ•°æ®åº“'çš„ä¹¦ï¼Œä½†æˆ‘ä¸å‘Šè¯‰ä½ å®ƒåœ¨å¼€å¤´è¿˜æ˜¯ç»“å°¾"ã€‚è¿™æ—¶å€™ç´¢å¼•ç›´æ¥æ‡µäº† ğŸ˜µï¼Œå› ä¸ºå®ƒçš„æ’åºè§„åˆ™æ˜¯æŒ‰é¦–å­—æ¯æ¥çš„ï¼Œç°åœ¨å…³é”®è¯å¯èƒ½å‡ºç°åœ¨ä»»ä½•ä½ç½®ï¼Œå°±åƒè®©ä½ åœ¨æ‰€æœ‰ä¹¦é‡Œæ‰¾ "åŒ…å«'çš„'å­—çš„ä¹¦" ä¸€æ ·â€”â€”ç´¢å¼•å®Œå…¨å¸®ä¸ä¸Šå¿™ï¼</p>
<p><strong>å…¨è¡¨æ‰«æè­¦å‘Š</strong> âš ï¸ï¼šæ•°æ®åº“åªèƒ½å¼€å¯"è’™çœ¼æ‘¸ä¹¦"æ¨¡å¼ï¼Œé€è¡Œæ£€æŸ¥æ¯æ¡è®°å½•ã€‚å¦‚æœè¡¨ä¸­æœ‰ 100 ä¸‡æ¡æ•°æ®ï¼Œå°±åƒè®©ä½ åœ¨ 100 ä¸‡æœ¬ä¹¦é‡Œä¸€æœ¬æœ¬ç¿»å¼€æ‰¾ï¼Œç”»é¢å¤ªç¾æˆ‘ä¸æ•¢çœ‹ ğŸ¥¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af55f14a116a4b07925841af1a6aff5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg6ZmQ5aSnNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765814227&amp;x-signature=vbbg0wk6GxgqkD2gRB1WNG7uPFE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">é¿å‘æŒ‡å—ï¼š3 ä¸ªè®©ç´¢å¼•å¤±æ•ˆçš„ç»å…¸æ“ä½œ</h4>

























<table><thead><tr><th>é”™è¯¯å†™æ³• ğŸ”´</th><th>æ­£ç¡®å§¿åŠ¿ ğŸŸ¢</th><th>æ€§èƒ½å·®è·</th></tr></thead><tbody><tr><td>LIKE '%å…³é”®è¯%'</td><td>LIKE 'å…³é”®è¯%' æˆ–ä½¿ç”¨å…¨æ–‡ç´¢å¼•</td><td>å¯èƒ½å·® 100~1000 å€</td></tr><tr><td>WHERE age + 1 = 25</td><td>WHERE age = 24</td><td>ç´¢å¼•ç›´æ¥å¤±æ•ˆ</td></tr><tr><td>WHERE SUBSTR(title, 3) = 'æ•°æ®åº“'</td><td>WHERE title LIKE '__æ•°æ®åº“%'</td><td>å‡½æ•°æ“ä½œå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</td></tr></tbody></table>
<h3 data-id="heading-5">B+æ ‘ç´¢å¼• vs å“ˆå¸Œç´¢å¼•ï¼šæ–°åå­—å…¸ vs å¿«é€’æŸœ</h3>
<p>ç°åœ¨ä½ å†³å®šç»™å›¾ä¹¦é¦†è£…å¯¼èˆªç³»ç»Ÿäº†ï¼Œä½†å¸‚åœºä¸Šæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>æ–¹æ¡ˆ A</strong> ï¼šåƒã€Šæ–°åå­—å…¸ã€‹é‚£æ ·çš„ç›®å½• ğŸ“–ï¼ˆB+æ ‘ç´¢å¼•ï¼‰</li>
<li><strong>æ–¹æ¡ˆ B</strong> ï¼šåƒå¿«é€’æŸœé‚£æ ·çš„ç¼–å·ç³»ç»Ÿ ğŸ“¦ï¼ˆå“ˆå¸Œç´¢å¼•ï¼‰</li>
</ul>
<p>åˆ°åº•é€‰å“ªä¸ªï¼Ÿè¿™å¾—çœ‹ä½ å¹³æ—¶æ€ä¹ˆæ‰¾ä¹¦ï¼</p>
<h4 data-id="heading-6">ğŸ“– B+æ ‘ç´¢å¼•ï¼šæ–°åå­—å…¸çš„æ™ºæ…§</h4>
<p>ç¿»å¼€ä½ çš„æ–°åå­—å…¸ï¼Œä¼šå‘ç°å®ƒæœ‰ä¸¤ç§ç›®å½•ï¼šæ‹¼éŸ³ç´¢å¼•å’Œéƒ¨é¦–ç´¢å¼•ã€‚B+æ ‘ç´¢å¼•å°±åƒæ‹¼éŸ³ç´¢å¼•ï¼Œå®ƒæŠŠæ•°æ®æŒ‰é¡ºåºæ’å¥½ï¼Œå¹¶ä¸”åªåœ¨å¶å­èŠ‚ç‚¹å­˜å‚¨å®Œæ•´æ•°æ®ï¼Œä¸­é—´èŠ‚ç‚¹éƒ½æ˜¯"æŒ‡è·¯ç‰Œ"ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[æ ¹èŠ‚ç‚¹] --&gt;|1-100| B[ä¸­é—´èŠ‚ç‚¹]
    A --&gt;|101-200| C[ä¸­é—´èŠ‚ç‚¹]
    
    B --&gt;|1-50| D[å¶å­èŠ‚ç‚¹: 1,3,5...50]
    B --&gt;|51-100| E[å¶å­èŠ‚ç‚¹: 51,53...100]
    
    C --&gt;|101-150| F[å¶å­èŠ‚ç‚¹: 101...150]
    C --&gt;|151-200| G[å¶å­èŠ‚ç‚¹: 151...200]
    
    D --&gt;|é“¾è¡¨æŒ‡é’ˆ| E
    E --&gt;|é“¾è¡¨æŒ‡é’ˆ| F
    F --&gt;|é“¾è¡¨æŒ‡é’ˆ| G
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c4470d9e5c644a58ad6358b273413f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg6ZmQ5aSnNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765814227&amp;x-signature=6fOfWkEI4yZeG6CLAhZfpaK0H9A%3D" alt="image.png" loading="lazy"/>
<strong>é€‚ç”¨åœºæ™¯</strong> ï¼š</p>
<ul>
<li>èŒƒå›´æŸ¥è¯¢ï¼ˆæ¯”å¦‚æ‰¾ "ä»·æ ¼åœ¨ 10-50 å…ƒçš„ä¹¦"ï¼‰ğŸ“Š</li>
<li>æ’åºæ“ä½œï¼ˆæ¯”å¦‚ "æŒ‰å‡ºç‰ˆæ—¥æœŸå€’åºæ’åˆ—"ï¼‰ğŸ”„</li>
<li>å‰ç¼€åŒ¹é…ï¼ˆæ¯”å¦‚ LIKE 'æ•°æ®åº“%'ï¼‰ğŸ¯</li>
</ul>
<h4 data-id="heading-7">ğŸ“¦ å“ˆå¸Œç´¢å¼•ï¼šå¿«é€’æŸœçš„æš´åŠ›ç¾å­¦</h4>
<p>å“ˆå¸Œç´¢å¼•å°±åƒå¿«é€’æŸœï¼Œæ¯ä¸ª key éƒ½é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºä¸€ä¸ªå”¯ä¸€ç¼–å·ï¼Œç›´æ¥å®šä½åˆ°å­˜å‚¨ä½ç½®ã€‚æ¯”å¦‚æŸ¥è¯¢ id=100 çš„æ•°æ®ï¼Œå“ˆå¸Œå‡½æ•°ç®—å‡ºæ¥æ˜¯ 8 å·æŸœï¼Œç›´æ¥æ‹‰å¼€ 8 å·æŸœå°±èƒ½æ‰¾åˆ°ï¼</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong> ï¼š</p>
<ul>
<li>ç­‰å€¼æŸ¥è¯¢ï¼ˆæ¯”å¦‚ WHERE id=100ï¼‰âš¡</li>
<li>é”®å€¼å¯¹æ•°æ®åº“ï¼ˆå¦‚ Redisï¼‰ğŸš€</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28c5e3b67a8741c4b9d580703ab13f31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg6ZmQ5aSnNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765814227&amp;x-signature=Pk%2BnRltKlaxkySqYMv40zm4px7s%3D" alt="image.png" loading="lazy"/></p>
<p><strong>çµé­‚å¯¹æ¯”è¡¨æ ¼</strong> ğŸ‘‡</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>B+æ ‘ç´¢å¼•</th><th>å“ˆå¸Œç´¢å¼•</th></tr></thead><tbody><tr><td>æŸ¥æ‰¾é€Ÿåº¦</td><td>O(log n) ç¨³å®š</td><td>O(1) ä½†æœ‰å“ˆå¸Œå†²çªé£é™©</td></tr><tr><td>èŒƒå›´æŸ¥è¯¢</td><td>âœ… å¤©ç”Ÿæ”¯æŒ</td><td>âŒ å®Œå…¨ä¸æ”¯æŒ</td></tr><tr><td>æ’åº</td><td>âœ… å¶å­èŠ‚ç‚¹é“¾è¡¨å¤©ç„¶æœ‰åº</td><td>âŒ æ— åºå­˜å‚¨</td></tr><tr><td>å†…å­˜å ç”¨</td><td>ä¸­ç­‰ï¼ˆå¯å­˜ç£ç›˜ï¼‰</td><td>è¾ƒé«˜ï¼ˆé€šå¸¸å†…å­˜å­˜å‚¨ï¼‰</td></tr><tr><td>ç»å…¸åº”ç”¨</td><td>MySQL InnoDB ä¸»é”®ç´¢å¼•</td><td>Redisã€Memcached é”®å€¼å­˜å‚¨</td></tr></tbody></table>
<p>MySQL InnoDB èšç°‡ç´¢å¼•ï¼šå¶å­èŠ‚ç‚¹é‡Œè—ç€å¤§ç§˜å¯†ï¼</p>
<blockquote>
<p>å¦‚æœä½ ç”¨ MySQL çš„ InnoDB å¼•æ“ï¼Œé‚£ä½ å¿…é¡»çŸ¥é“è¿™ä¸ª<strong>æƒŠå¤©å¤§ç§˜å¯†</strong> ğŸ’£ï¼š</p>
<p>å®ƒçš„ä¸»é”®ç´¢å¼•å¶å­èŠ‚ç‚¹ç›´æ¥å­˜ç€æ•´è¡Œæ•°æ®ï¼å°±åƒä½ æŸ¥æ–°åå­—å…¸æ—¶ï¼Œç¿»åˆ° "æ•°" å­—ä¸ä»…èƒ½çœ‹åˆ°æ‹¼éŸ³ï¼Œè¿˜èƒ½ç›´æ¥æŠŠæ•´é¡µå­—å…¸æ’•ä¸‹æ¥å¸¦èµ° ğŸ“„ã€‚</p>
</blockquote>
<h4 data-id="heading-8">èšç°‡ç´¢å¼• vs éèšç°‡ç´¢å¼•ï¼šå†°ç®± vs å‚¨ç‰©æŸœ</h4>
<ul>
<li><strong>èšç°‡ç´¢å¼•</strong> ï¼ˆä¸»é”®ç´¢å¼•ï¼‰ï¼šå°±åƒå®¶é‡Œçš„å†°ç®± ğŸ§Šï¼Œé—¨ï¼ˆç´¢å¼•ï¼‰æ‰“å¼€ç›´æ¥çœ‹åˆ°é£Ÿç‰©ï¼ˆæ•°æ®ï¼‰ï¼Œä¸ç”¨å†è·‘ä¸€è¶Ÿã€‚</li>
<li><strong>éèšç°‡ç´¢å¼•</strong> ï¼ˆäºŒçº§ç´¢å¼•ï¼‰ï¼šå°±åƒå‚¨ç‰©æŸœçš„æ ‡ç­¾ ğŸ·ï¸ï¼Œä¸Šé¢å†™ç€"é›¶é£Ÿåœ¨å†°ç®±ç¬¬ä¸‰å±‚"ï¼Œä½ è¿˜å¾—å†å»å†°ç®±æ‹¿ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    subgraph èšç°‡ç´¢å¼• B+æ ‘
        A[æ ¹èŠ‚ç‚¹: ä¸»é”®èŒƒå›´ 1-1000]
        B[ä¸­é—´èŠ‚ç‚¹: 1-500]
        C[ä¸­é—´èŠ‚ç‚¹: 501-1000]
        D[å¶å­èŠ‚ç‚¹: 1-100, åŒ…å«æ•´è¡Œæ•°æ®]
        E[å¶å­èŠ‚ç‚¹: 101-200, åŒ…å«æ•´è¡Œæ•°æ®]
    end
    A --&gt; B
    A --&gt; C
    B --&gt; D
    B --&gt; E
    D --&gt; E --&gt; F[...æ›´å¤šå¶å­èŠ‚ç‚¹]
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/160a9dcbc0064816ba3dbe2cb8b65cb7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg6ZmQ5aSnNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765814227&amp;x-signature=8G4oOm2f5U2TqZ8aavypp%2FnmZqc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">å®æˆ˜ï¼šå¦‚ä½•æ£€æµ‹ç´¢å¼•å¤±æ•ˆï¼Ÿ</h4>
<p>ç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªæˆ‘å‹ç®±åº•çš„<strong>ç´¢å¼•å¤±æ•ˆæ£€æµ‹ SQL</strong> ğŸ•µï¸â€â™‚ï¸ï¼Œæ‰§è¡Œå®ƒå°±èƒ½çŸ¥é“æŸ¥è¯¢æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">EXPLAIN
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> books
<span class="hljs-keyword">WHERE</span> title <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%æ•°æ®åº“%'</span>  <span class="hljs-comment">-- è¿™ä¸ªä¼šå¤±æ•ˆ</span>
  <span class="hljs-keyword">AND</span> price <span class="hljs-operator">&gt;</span> <span class="hljs-number">50</span>;           <span class="hljs-comment">-- è¿™ä¸ªå¯èƒ½æœ‰æ•ˆ</span>
</code></pre>
<p><strong>ç»“æœè§£è¯»</strong> ğŸ‘‡ï¼š
-- é‡ç‚¹çœ‹ type åˆ—ï¼š
-- âœ… ref/range/indexï¼šç´¢å¼•æœ‰ç”¨
-- âŒ ALLï¼šå…¨è¡¨æ‰«æï¼Œç´¢å¼•å¤±æ•ˆï¼</p>
<p><strong>é¿å‘ç¥æŠ€</strong> âœ¨ï¼šå¦‚æœå¿…é¡»ç”¨ %å…³é”®è¯% æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå¯ä»¥è€ƒè™‘ç”¨  <strong>å…¨æ–‡ç´¢å¼•</strong> ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºå…¨æ–‡ç´¢å¼•</span>
<span class="hljs-keyword">CREATE</span> FULLTEXT INDEX idx_title_ft <span class="hljs-keyword">ON</span> books(title);

<span class="hljs-comment">-- é«˜æ•ˆæŸ¥è¯¢åŒ…å«å…³é”®è¯çš„è®°å½•</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> books
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">MATCH</span>(title) AGAINST(<span class="hljs-string">'æ•°æ®åº“'</span> <span class="hljs-keyword">IN</span> <span class="hljs-keyword">NATURAL</span> <span class="hljs-keyword">LANGUAGE</span> MODE);
</code></pre>
<hr/>
<blockquote>
<h3 data-id="heading-10">ç´¢å¼•è®¾è®¡çš„ä¸‰å¤§çµé­‚æ‹·é—®</h3>
<ol>
<li><strong>æ˜¯ä¸æ˜¯ç´¢å¼•è¶Šå¤šè¶Šå¥½ï¼Ÿ</strong></li>
</ol>
<p>ç­”ï¼šNOï¼ç´¢å¼•åƒå›¾ä¹¦é¦†çš„åˆ†ç±»æ¶ï¼Œå¤ªå¤šäº†åè€Œéš¾æ‰¾ï¼Œè€Œä¸”æ¯æ¬¡å¢åˆ æ”¹æ•°æ®éƒ½è¦ç»´æŠ¤ç´¢å¼•ï¼Œå°±åƒæ¯æ¬¡æ–°ä¹¦å…¥åº“éƒ½è¦é‡æ–°è´´æ ‡ç­¾ è´´åˆ°å´©æºƒã€‚</p>
<ol start="2">
<li><strong>ä¸»é”®ä¸ºä»€ä¹ˆæœ€å¥½æ˜¯è‡ªå¢ IDï¼Ÿ</strong></li>
</ol>
<p>ç­”ï¼šInnoDB èšç°‡ç´¢å¼•å¦‚æœç”¨éšæœº IDï¼Œä¼šå¯¼è‡´å¶å­èŠ‚ç‚¹é¢‘ç¹åˆ†è£‚ï¼Œå°±åƒä½ æ•´ç†å¥½çš„ä¹¦æ¶å¿½ç„¶æ’è¿›æ–°ä¹¦ï¼Œæ•´ä¸ªæ¶å­éƒ½è¦é‡æ’ ğŸ—„ï¸ã€‚</p>
<ol start="3">
<li><strong>ä¸ºä»€ä¹ˆä¸å»ºè®®ç”¨ UUID åšä¸»é”®ï¼Ÿ</strong></li>
</ol>
<p>ç­”ï¼šUUID æ˜¯éšæœºå­—ç¬¦ä¸²ï¼Œç´¢å¼•æ ‘ä¼šå˜æˆ"æ­ªè„–å­æ ‘" ğŸŒ³ï¼ŒæŸ¥è¯¢æ•ˆç‡æš´è·Œï¼ä¸ä¿¡ä½ è¯•è¯•ç»™å›¾ä¹¦é¦†çš„ä¹¦æŒ‰ UUID æ’åºï¼Ÿ</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">ç»“è¯­ï¼šç´¢å¼•ä¸æ˜¯é“¶å¼¹ï¼Œä½†æ²¡æœ‰ç´¢å¼•æ˜¯çœŸçš„å®Œè›‹</h3>
<p>æœ€åé€å¤§å®¶ä¸€å¥æˆ‘å¥¶å¥¶éƒ½èƒ½å¬æ‡‚çš„è¯ï¼š<strong>ç´¢å¼•å°±åƒç»™è‡ªè¡Œè½¦è£…å˜é€Ÿå™¨</strong> ğŸš²ï¼Œå¹³æ—¶é€šå‹¤ï¼ˆç®€å•æŸ¥è¯¢ï¼‰å¯èƒ½æ„Ÿè§‰ä¸åˆ°ï¼Œä½†é‡åˆ°çˆ¬å¡ï¼ˆå¤æ‚æŸ¥è¯¢ï¼‰æ—¶ï¼Œæœ‰æ²¡æœ‰å˜é€Ÿå™¨ç›´æ¥æ˜¯ä¸¤ä¸ªç‰©ç§ï¼</p>
<p>ä½†è®°ä½ï¼Œæ²¡æœ‰ä¸‡èƒ½çš„ç´¢å¼•è®¾è®¡ï¼Œæœ€å¥½çš„å®è·µæ˜¯ï¼š<strong>ç”¨ EXPLAIN åˆ†æ SQLï¼Œç”¨ç›‘æ§å·¥å…·è§‚å¯Ÿæ…¢æŸ¥è¯¢ï¼Œè®©æ•°æ®å‘Šè¯‰ä½ ç­”æ¡ˆ</strong> ğŸ“Šã€‚</p>
<p>ç¥å¤§å®¶éƒ½èƒ½å†™å‡ºé£ä¸€èˆ¬çš„ SQLï¼Œå†ä¹Ÿä¸ç”¨å¯¹ç€å…¨è¡¨æ‰«ææ‰å¤´å‘ï¼ğŸ’‡â€â™‚ï¸ğŸ’¨</p>
<p>ï¼ˆå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œè®°å¾—ç‚¹èµæ”¶è—å“¦~ ğŸ‘‡ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA["è®²è®²åŸå‹é“¾" â€”â€” é¢è¯•å®˜æœ€çˆ±é—®çš„ JavaScript åŸºç¡€]]></title>    <link>https://juejin.cn/post/7581324171398479918</link>    <guid>https://juejin.cn/post/7581324171398479918</guid>    <pubDate>2025-12-08T14:25:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581324171398479918" data-draft-id="7581292270961754122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="&quot;è®²è®²åŸå‹é“¾&quot; â€”â€” é¢è¯•å®˜æœ€çˆ±é—®çš„ JavaScript åŸºç¡€"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-08T14:25:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            "è®²è®²åŸå‹é“¾" â€”â€” é¢è¯•å®˜æœ€çˆ±é—®çš„ JavaScript åŸºç¡€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T14:25:25.000Z" title="Mon Dec 08 2025 14:25:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScript åŸå‹ä¸åŸå‹é“¾ï¼šä»å›°æƒ‘åˆ°å®Œå…¨ç†è§£</h2>
<p>ä»¥å‰åœ¨çœ‹ JavaScript ä»£ç çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
arr.<span class="hljs-title function_">push</span>(<span class="hljs-number">4</span>);      <span class="hljs-comment">// 4</span>
arr.<span class="hljs-title function_">join</span>(<span class="hljs-string">','</span>);    <span class="hljs-comment">// "1,2,3,4"</span>
arr.<span class="hljs-title function_">toString</span>();   <span class="hljs-comment">// "1,2,3,4"</span>
</code></pre>
<p>æˆ‘æ˜æ˜åªåˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œä¸ºä»€ä¹ˆå®ƒèƒ½è°ƒç”¨ <code>push</code>ã€<code>join</code>ã€<code>toString</code> è¿™äº›æ–¹æ³•ï¼Ÿè¿™äº›æ–¹æ³•æ˜¯ä»å“ªæ¥çš„ï¼Ÿ</p>
<p>å†çœ‹è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>);
person.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// "Hello, I'm å¼ ä¸‰"</span>
</code></pre>
<p><code>person</code> å¯¹è±¡æœ¬èº«æ²¡æœ‰ <code>sayHello</code> æ–¹æ³•ï¼Œä½†å´èƒ½è°ƒç”¨å®ƒã€‚è¿™èƒŒåçš„æœºåˆ¶å°±æ˜¯åŸå‹é“¾ã€‚</p>
<hr/>
<h3 data-id="heading-1">å…ˆææ¸…æ¥šå‡ ä¸ªæ¦‚å¿µ</h3>
<p>åœ¨æ·±å…¥ä¹‹å‰ï¼Œå…ˆæŠŠå‡ ä¸ªå®¹æ˜“æ··æ·†çš„æ¦‚å¿µç†æ¸…æ¥šï¼š</p>
<h4 data-id="heading-2"><code>[[Prototype]]</code>ã€<code>__proto__</code>ã€<code>prototype</code> çš„åŒºåˆ«</h4>





























<table><thead><tr><th>æ¦‚å¿µ</th><th>æ˜¯ä»€ä¹ˆ</th><th>å±äºè°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>[[Prototype]]</code></td><td>å†…éƒ¨å±æ€§</td><td>æ‰€æœ‰å¯¹è±¡</td><td>æŒ‡å‘å¯¹è±¡çš„åŸå‹ï¼Œéšè—å±æ€§</td></tr><tr><td><code>__proto__</code></td><td>è®¿é—®å™¨å±æ€§</td><td>æ‰€æœ‰å¯¹è±¡</td><td>æš´éœ² <code>[[Prototype]]</code>ï¼Œéæ ‡å‡†ä½†å¹¿æ³›æ”¯æŒ</td></tr><tr><td><code>prototype</code></td><td>æ™®é€šå±æ€§</td><td>å‡½æ•°</td><td>å­˜æ”¾ç»™å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•</td></tr></tbody></table>
<p>ç®€å•è¯´ï¼š</p>
<ul>
<li><strong><code>prototype</code></strong> æ˜¯<strong>å‡½æ•°</strong>æ‰æœ‰çš„å±æ€§ï¼Œç”¨æ¥å­˜æ”¾å…±äº«æ–¹æ³•</li>
<li><strong><code>__proto__</code></strong> æ˜¯<strong>æ‰€æœ‰å¯¹è±¡</strong>éƒ½æœ‰çš„å±æ€§ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡</li>
<li><strong><code>[[Prototype]]</code></strong> æ˜¯ <code>__proto__</code> çš„å†…éƒ¨å®ç°</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>();

<span class="hljs-comment">// prototype åªæœ‰å‡½æ•°æ‰æœ‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);      <span class="hljs-comment">// {constructor: Æ’}</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);      <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// __proto__ æ‰€æœ‰å¯¹è±¡éƒ½æœ‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);  <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-3">ç°ä»£å†™æ³•ï¼šObject.getPrototypeOf()</h4>
<p><code>__proto__</code> è™½ç„¶å¥½ç”¨ï¼Œä½†å®ƒä¸æ˜¯ ECMAScript æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œåªæ˜¯å„æµè§ˆå™¨éƒ½å®ç°äº†ã€‚æ¨èç”¨æ ‡å‡†æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å–åŸå‹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(foo) === <span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// è®¾ç½®åŸå‹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, prototype)

<span class="hljs-comment">// åˆ›å»ºæ—¶æŒ‡å®šåŸå‹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(prototype)
</code></pre>
<hr/>
<h3 data-id="heading-4">åŸå‹æ˜¯ä»€ä¹ˆ</h3>
<p>JavaScript é‡Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª <code>prototype</code> å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å«åš<strong>åŸå‹å¯¹è±¡</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®©è¯¥å‡½æ•°åˆ›å»ºçš„æ‰€æœ‰å®ä¾‹å…±äº«å±æ€§å’Œæ–¹æ³•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">brand</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
}

<span class="hljs-comment">// æ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Šï¼Œæ‰€æœ‰å®ä¾‹å…±äº«</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">start</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.brand}</span> å¯åŠ¨äº†`</span>);
};

<span class="hljs-keyword">const</span> car1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'ä¸°ç”°'</span>);
<span class="hljs-keyword">const</span> car2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'æœ¬ç”°'</span>);

car1.<span class="hljs-title function_">start</span>(); <span class="hljs-comment">// ä¸°ç”° å¯åŠ¨äº†</span>
car2.<span class="hljs-title function_">start</span>(); <span class="hljs-comment">// æœ¬ç”° å¯åŠ¨äº†</span>

<span class="hljs-comment">// ä¸¤ä¸ªå®ä¾‹ç”¨çš„æ˜¯åŒä¸€ä¸ªæ–¹æ³•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car1.<span class="hljs-property">start</span> === car2.<span class="hljs-property">start</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>è¿™å°±æ˜¯åŸå‹çš„æ ¸å¿ƒä»·å€¼ï¼š<strong>æ–¹æ³•åªéœ€è¦å®šä¹‰ä¸€æ¬¡ï¼Œæ‰€æœ‰å®ä¾‹éƒ½èƒ½ç”¨</strong>ã€‚</p>
<p>å¦‚æœæŠŠæ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°é‡Œï¼Œæ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹å°±ä¼šæ–°å»ºä¸€ä¸ªå‡½æ•°ï¼Œæµªè´¹å†…å­˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸æ¨èçš„å†™æ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">BadCar</span>(<span class="hljs-params">brand</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {  <span class="hljs-comment">// æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä»½</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.brand}</span> å¯åŠ¨äº†`</span>);
  };
}

<span class="hljs-keyword">const</span> bad1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadCar</span>(<span class="hljs-string">'ä¸°ç”°'</span>);
<span class="hljs-keyword">const</span> bad2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadCar</span>(<span class="hljs-string">'æœ¬ç”°'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bad1.<span class="hljs-property">start</span> === bad2.<span class="hljs-property">start</span>); <span class="hljs-comment">// falseï¼Œä¸¤ä¸ªä¸åŒçš„å‡½æ•°</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">new å…³é”®å­—åˆ°åº•åšäº†ä»€ä¹ˆ</h3>
<p>ç†è§£åŸå‹é“¾ä¹‹å‰ï¼Œå¾—å…ˆææ¸…æ¥š <code>new</code> çš„å·¥ä½œåŸç†ã€‚å½“ä½ å†™ <code>new Foo()</code> æ—¶ï¼ŒJavaScript å¼•æ“ä¼šæ‰§è¡Œä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    A['1. åˆ›å»ºç©ºå¯¹è±¡']:::step --&gt; B['2. è®¾ç½®åŸå‹é“¾']:::step
    B --&gt; C['3. æ‰§è¡Œæ„é€ å‡½æ•°']:::step
    C --&gt; D['4. è¿”å›å¯¹è±¡']:::success

    classDef step fill:#cce5ff,stroke:#0d6efd,color:#004085
    classDef success fill:#d4edda,stroke:#28a745,color:#155724
</code></pre>
<h4 data-id="heading-6">è¯¦ç»†æ­¥éª¤</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">greet</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-keyword">const</span> john = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'John'</span>);
</code></pre>
<p><strong>Step 1ï¼šåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†…éƒ¨åˆ›å»ºï¼š{}</span>
</code></pre>
<p><strong>Step 2ï¼šå°†ç©ºå¯¹è±¡çš„ <code>[[Prototype]]</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code></strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†…éƒ¨æ“ä½œï¼šnewObj.__proto__ = Person.prototype</span>
</code></pre>
<p><strong>Step 3ï¼šç”¨è¿™ä¸ªç©ºå¯¹è±¡ä½œä¸º <code>this</code> æ‰§è¡Œæ„é€ å‡½æ•°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†…éƒ¨æ“ä½œï¼šPerson.call(newObj, 'John')</span>
<span class="hljs-comment">// æ‰§è¡Œå newObj å˜æˆ { name: 'John' }</span>
</code></pre>
<p><strong>Step 4ï¼šè¿”å›å¯¹è±¡</strong></p>
<ul>
<li>å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ç”¨é‚£ä¸ªå¯¹è±¡</li>
<li>å¦åˆ™è¿”å› Step 1 åˆ›å»ºçš„å¯¹è±¡</li>
</ul>
<h4 data-id="heading-7">æ‰‹å†™ä¸€ä¸ª new</h4>
<p>ç†è§£äº†åŸç†ï¼Œå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºç©ºå¯¹è±¡ï¼ŒåŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype</span>
  <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);

  <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œthis ç»‘å®šåˆ°æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);

  <span class="hljs-comment">// 3. å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œå°±ç”¨å®ƒï¼›å¦åˆ™ç”¨æ–°åˆ›å»ºçš„å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> ? result : obj;
}

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> p = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'Alice'</span>);
p.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// Hi, I'm Alice</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
</code></pre>
<hr/>
<h3 data-id="heading-8">åŸå‹é“¾çš„æŸ¥æ‰¾æœºåˆ¶</h3>
<p>å½“è®¿é—®å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼ŒJavaScript ä¼šæŒ‰ç…§è¿™ä¸ªé¡ºåºæŸ¥æ‰¾ï¼š</p>
<ol>
<li>å…ˆåœ¨å¯¹è±¡è‡ªèº«æ‰¾</li>
<li>æ‰¾ä¸åˆ°ï¼Œå»å¯¹è±¡çš„åŸå‹ (<code>__proto__</code>) ä¸Šæ‰¾</li>
<li>è¿˜æ‰¾ä¸åˆ°ï¼Œç»§ç»­å¾€ä¸Šä¸€çº§åŸå‹æ‰¾</li>
<li>ç›´åˆ° <code>Object.prototype</code>ï¼Œå†å¾€ä¸Šå°±æ˜¯ <code>null</code> äº†</li>
</ol>
<p>è¿™æ¡æŸ¥æ‰¾é“¾è·¯å°±æ˜¯<strong>åŸå‹é“¾</strong>ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    A["dog å®ä¾‹&lt;br/&gt;{ name: 'Buddy' }"]:::instance --&gt;|__proto__| B["Dog.prototype&lt;br/&gt;{ bark: Æ’ }"]:::proto
    B --&gt;|__proto__| C["Animal.prototype&lt;br/&gt;{ speak: Æ’ }"]:::proto
    C --&gt;|__proto__| D["Object.prototype&lt;br/&gt;{ toString: Æ’, ... }"]:::rootProto
    D --&gt;|__proto__| E["null"]:::endNode

    classDef instance fill:#cce5ff,stroke:#0d6efd,color:#004085
    classDef proto fill:#d4edda,stroke:#28a745,color:#155724
    classDef rootProto fill:#fff3cd,stroke:#ffc107,color:#856404
    classDef endNode fill:#f8d7da,stroke:#dc3545,color:#721c24
</code></pre>
<h4 data-id="heading-9">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">speak</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> makes a sound`</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);
}

<span class="hljs-comment">// å»ºç«‹åŸå‹é“¾ï¼šDog.prototype -&gt; Animal.prototype</span>
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">bark</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Woof!'</span>);
};

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Buddy'</span>);

<span class="hljs-comment">// æŸ¥æ‰¾è¿‡ç¨‹ï¼š</span>
dog.<span class="hljs-property">name</span>;    <span class="hljs-comment">// åœ¨ dog è‡ªèº«æ‰¾åˆ°</span>
dog.<span class="hljs-title function_">bark</span>();  <span class="hljs-comment">// åœ¨ Dog.prototype æ‰¾åˆ°</span>
dog.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">// åœ¨ Animal.prototype æ‰¾åˆ°</span>
dog.<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">// åœ¨ Object.prototype æ‰¾åˆ°</span>
</code></pre>
<p>ç”¨ä»£ç éªŒè¯è¿™æ¡é“¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);                 <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);    <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>);             <span class="hljs-comment">// true</span>
</code></pre>
<p>è¿™å°±è§£é‡Šäº†å¼€å¤´çš„é—®é¢˜ã€‚æ•°ç»„èƒ½è°ƒç”¨ <code>push</code>ã€<code>join</code>ï¼Œæ˜¯å› ä¸ºè¿™äº›æ–¹æ³•å®šä¹‰åœ¨ <code>Array.prototype</code> ä¸Šã€‚èƒ½è°ƒç”¨ <code>toString</code>ï¼Œæ˜¯å› ä¸ºé¡ºç€åŸå‹é“¾èƒ½æ‰¾åˆ° <code>Object.prototype.toString</code>ï¼ˆè™½ç„¶ Array é‡å†™äº†è¿™ä¸ªæ–¹æ³•ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-10">å®Œæ•´çš„åŸå‹é“¾å›¾è°±</h3>
<p>JavaScript çš„åŸå‹é“¾æ¯”æƒ³è±¡ä¸­æ›´å¤æ‚ï¼Œå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¹Ÿæœ‰è‡ªå·±çš„åŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph IL[å®ä¾‹å±‚]
        foo["foo å®ä¾‹"]:::instance
    end

    subgraph PL[åŸå‹å±‚]
        FooP["Foo.prototype"]:::proto
        ObjP["Object.prototype"]:::rootProto
    end

    subgraph FL[å‡½æ•°å±‚]
        Foo["Foo å‡½æ•°"]:::func
        Obj["Object å‡½æ•°"]:::func
        Func["Function å‡½æ•°"]:::func
    end

    subgraph FPL[å‡½æ•°åŸå‹å±‚]
        FuncP["Function.prototype"]:::funcProto
    end

    foo --&gt;|__proto__| FooP
    FooP --&gt;|__proto__| ObjP
    ObjP --&gt;|__proto__| NULL["null"]:::endNode

    Foo --&gt;|prototype| FooP
    Foo --&gt;|__proto__| FuncP

    Obj --&gt;|prototype| ObjP
    Obj --&gt;|__proto__| FuncP

    Func --&gt;|prototype| FuncP
    Func --&gt;|__proto__| FuncP

    FuncP --&gt;|__proto__| ObjP

    classDef instance fill:#cce5ff,stroke:#0d6efd,color:#004085
    classDef proto fill:#d4edda,stroke:#28a745,color:#155724
    classDef rootProto fill:#fff3cd,stroke:#ffc107,color:#856404
    classDef func fill:#e2d9f3,stroke:#6f42c1,color:#432874
    classDef funcProto fill:#fce4ec,stroke:#e91e63,color:#880e4f
    classDef endNode fill:#f8d7da,stroke:#dc3545,color:#721c24

    style IL fill:#e8f4fc,stroke:#0d6efd
    style PL fill:#e8f5e9,stroke:#28a745
    style FL fill:#f3e5f5,stroke:#6f42c1
    style FPL fill:#fce4ec,stroke:#e91e63
</code></pre>
<h4 data-id="heading-11">å‡ ä¸ªå…³é”®ç‚¹</h4>
<p><strong>1. æ‰€æœ‰å‡½æ•°éƒ½æ˜¯ Function çš„å®ä¾‹</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Foo</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);    <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// trueï¼ˆè‡ªå·±åˆ›å»ºè‡ªå·±ï¼‰</span>
</code></pre>
<p><strong>2. Function.prototype ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå®ƒçš„åŸå‹æ˜¯ Object.prototype</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>3. Object.prototype æ˜¯åŸå‹é“¾çš„ç»ˆç‚¹</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>4. ä¸€ä¸ªæœ‰è¶£çš„å¾ªç¯</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Object æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥å®ƒçš„ __proto__ æ˜¯ Function.prototype</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Function.prototype æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒçš„ __proto__ æ˜¯ Object.prototype</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// è¿™å½¢æˆäº†ä¸€ä¸ªæœ‰è¶£çš„"é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡"çš„å…³ç³»</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">å±æ€§é®è”½ï¼ˆProperty Shadowingï¼‰</h3>
<p>å¦‚æœå¯¹è±¡è‡ªèº«å’ŒåŸå‹ä¸Šæœ‰åŒåå±æ€§ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Default'</span>;
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">greet</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-keyword">const</span> john = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'John'</span>);

<span class="hljs-comment">// è‡ªèº«å±æ€§é®è”½åŸå‹å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-property">name</span>); <span class="hljs-comment">// 'John'ï¼Œä¸æ˜¯ 'Default'</span>

<span class="hljs-comment">// åˆ é™¤è‡ªèº«å±æ€§åï¼ŒåŸå‹å±æ€§å°±éœ²å‡ºæ¥äº†</span>
<span class="hljs-keyword">delete</span> john.<span class="hljs-property">name</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-property">name</span>); <span class="hljs-comment">// 'Default'</span>
</code></pre>
<p>è¿™å°±æ˜¯<strong>å±æ€§é®è”½</strong>ï¼šè‡ªèº«å±æ€§ä¼š"é®ä½"åŸå‹é“¾ä¸Šçš„åŒåå±æ€§ã€‚</p>
<h4 data-id="heading-13">æ£€æŸ¥å±æ€§æ¥æº</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> john = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'John'</span>);

<span class="hljs-comment">// hasOwnProperty åªæ£€æŸ¥è‡ªèº«å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'name'</span>));  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'greet'</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// in æ“ä½œç¬¦æ£€æŸ¥æ•´ä¸ªåŸå‹é“¾</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'name'</span> <span class="hljs-keyword">in</span> john);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'greet'</span> <span class="hljs-keyword">in</span> john); <span class="hljs-comment">// true</span>
</code></pre>
<hr/>
<h3 data-id="heading-14">å®ç°ç»§æ‰¿</h3>
<p>ç†è§£äº†åŸå‹é“¾ï¼Œç»§æ‰¿å°±å¥½åŠäº†ã€‚æ ¸å¿ƒå°±ä¸¤æ­¥ï¼š</p>
<ol>
<li>è°ƒç”¨çˆ¶æ„é€ å‡½æ•°ï¼Œç»§æ‰¿å®ä¾‹å±æ€§</li>
<li>è®¾ç½®åŸå‹é“¾ï¼Œç»§æ‰¿åŸå‹æ–¹æ³•</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Vehicle</span>(<span class="hljs-params">type</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = type;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">speed</span> = <span class="hljs-number">0</span>;
}

<span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">accelerate</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">amount</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">speed</span> += amount;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.type}</span> åŠ é€Ÿåˆ° <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.speed}</span> km/h`</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">brand</span>) {
  <span class="hljs-title class_">Vehicle</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">'æ±½è½¦'</span>);  <span class="hljs-comment">// ç»§æ‰¿å®ä¾‹å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
}

<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);  <span class="hljs-comment">// ç»§æ‰¿åŸå‹æ–¹æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Car</span>;

<span class="hljs-comment">// æ·»åŠ å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">honk</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.brand}</span> é¸£ç¬›`</span>);
};

<span class="hljs-comment">// é‡å†™çˆ¶ç±»æ–¹æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">accelerate</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">amount</span>) {
  <span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">accelerate</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, amount);
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">speed</span> &gt; <span class="hljs-number">120</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¶…é€Ÿè­¦å‘Š'</span>);
  }
};

<span class="hljs-keyword">const</span> myCar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'ä¸°ç”°'</span>);
myCar.<span class="hljs-title function_">accelerate</span>(<span class="hljs-number">50</span>);   <span class="hljs-comment">// æ±½è½¦ åŠ é€Ÿåˆ° 50 km/h</span>
myCar.<span class="hljs-title function_">accelerate</span>(<span class="hljs-number">80</span>);   <span class="hljs-comment">// æ±½è½¦ åŠ é€Ÿåˆ° 130 km/h</span>
                        <span class="hljs-comment">// è¶…é€Ÿè­¦å‘Š</span>
myCar.<span class="hljs-title function_">honk</span>();           <span class="hljs-comment">// ä¸°ç”° é¸£ç¬›</span>
</code></pre>
<h4 data-id="heading-15">ä¸ºä»€ä¹ˆç”¨ Object.create() è€Œä¸æ˜¯ç›´æ¥èµ‹å€¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯å†™æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-comment">// é—®é¢˜ï¼šä¿®æ”¹ Car.prototype ä¼šå½±å“ Vehicle.prototype</span>

<span class="hljs-comment">// é”™è¯¯å†™æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vehicle</span>();
<span class="hljs-comment">// é—®é¢˜ï¼šä¼šæ‰§è¡Œ Vehicle æ„é€ å‡½æ•°ï¼Œå¯èƒ½æœ‰å‰¯ä½œç”¨</span>

<span class="hljs-comment">// æ­£ç¡®å†™æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŸå‹æŒ‡å‘ Vehicle.prototype</span>
</code></pre>
<hr/>
<h3 data-id="heading-16">ES6 çš„ class è¯­æ³•</h3>
<p>ES6 å¼•å…¥äº† <code>class</code> å…³é”®å­—ï¼Œå†™èµ·æ¥æ›´æ¸…çˆ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> makes a sound`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, breed</span>) {
    <span class="hljs-variable language_">super</span>(name);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">breed</span> = breed;
  }

  <span class="hljs-title function_">bark</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Woof!'</span>);
  }
}

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Buddy'</span>, <span class="hljs-string">'Labrador'</span>);
dog.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">// Buddy makes a sound</span>
dog.<span class="hljs-title function_">bark</span>();  <span class="hljs-comment">// Woof!</span>
</code></pre>
<p>ä½†è¦æ¸…æ¥šï¼Œ<code>class</code> åªæ˜¯è¯­æ³•ç³–ï¼Œåº•å±‚è¿˜æ˜¯åŸå‹é“¾é‚£å¥—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Dog</span>); <span class="hljs-comment">// "function"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-17">class çš„ä¸€äº›ç‰¹æ€§</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> {
  <span class="hljs-comment">// å®ä¾‹å±æ€§ï¼ˆES2022+ï¼‰</span>
  instanceProp = <span class="hljs-string">'instance'</span>;

  <span class="hljs-comment">// ç§æœ‰å±æ€§ï¼ˆES2022+ï¼‰</span>
  #privateProp = <span class="hljs-string">'private'</span>;

  <span class="hljs-comment">// é™æ€å±æ€§</span>
  <span class="hljs-keyword">static</span> staticProp = <span class="hljs-string">'static'</span>;

  <span class="hljs-comment">// é™æ€æ–¹æ³•</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">staticMethod</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'static method'</span>;
  }

  <span class="hljs-comment">// getter/setter</span>
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.#privateProp;
  }
}
</code></pre>
<hr/>
<h3 data-id="heading-18">å‡ ä¸ªå®¹æ˜“è¸©çš„å‘</h3>
<h4 data-id="heading-19">1. å¼•ç”¨ç±»å‹æ”¾åŸå‹ä¸Šä¼šå…±äº«</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hobbies</span> = [];  <span class="hljs-comment">// æ‰€æœ‰å®ä¾‹å…±äº«è¿™ä¸ªæ•°ç»„</span>

<span class="hljs-keyword">const</span> s1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">'å¼ ä¸‰'</span>);
<span class="hljs-keyword">const</span> s2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">'æå››'</span>);

s1.<span class="hljs-property">hobbies</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'reading'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s2.<span class="hljs-property">hobbies</span>); <span class="hljs-comment">// ['reading']  // s2 ä¹Ÿæœ‰äº†ï¼Œå‡ºé—®é¢˜äº†</span>
</code></pre>
<p>å¼•ç”¨ç±»å‹ï¼ˆæ•°ç»„ã€å¯¹è±¡ï¼‰åº”è¯¥æ”¾åœ¨æ„é€ å‡½æ•°é‡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">hobbies</span> = [];  <span class="hljs-comment">// æ¯ä¸ªå®ä¾‹ç‹¬ç«‹</span>
}
</code></pre>
<h4 data-id="heading-20">2. åˆ«ç›´æ¥æ›¿æ¢ prototype å¯¹è±¡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"/>) {}

<span class="hljs-comment">// ç›´æ¥æ›¿æ¢ prototype ä¼šä¸¢å¤± constructor</span>
<span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">method</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}
};

<span class="hljs-keyword">const</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Foo</span>); <span class="hljs-comment">// falseï¼Œå˜æˆ Object äº†</span>
</code></pre>
<p>è¦ä¹ˆè®°å¾—è¡¥ä¸Š constructorï¼Œè¦ä¹ˆç”¨å±æ€§æ·»åŠ çš„æ–¹å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹å¼ä¸€ï¼šè¡¥ä¸Š constructor</span>
<span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Foo</span>,
  <span class="hljs-attr">method</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}
};

<span class="hljs-comment">// æ–¹å¼äºŒï¼šç›´æ¥æ·»åŠ å±æ€§ï¼ˆæ¨èï¼‰</span>
<span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">method</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
</code></pre>
<h4 data-id="heading-21">3. ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Foo</span> = (<span class="hljs-params"/>) =&gt; {};
<span class="hljs-keyword">const</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>(); <span class="hljs-comment">// TypeError: Foo is not a constructor</span>
</code></pre>
<p>ç®­å¤´å‡½æ•°æ²¡æœ‰ <code>prototype</code> å±æ€§ï¼Œä¹Ÿæ²¡æœ‰è‡ªå·±çš„ <code>this</code>ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ <code>new</code>ã€‚</p>
<h4 data-id="heading-22">4. instanceof çš„å±€é™æ€§</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// instanceof æ£€æŸ¥çš„æ˜¯åŸå‹é“¾</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// è·¨ iframe/realm æ—¶ä¼šå¤±æ•ˆ</span>
<span class="hljs-comment">// iframe é‡Œçš„ Array å’Œä¸»é¡µé¢çš„ Array ä¸æ˜¯åŒä¸€ä¸ª</span>
</code></pre>
<p>æ›´å¯é çš„ç±»å‹æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>([]);  <span class="hljs-comment">// "[object Array]"</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>([]);  <span class="hljs-comment">// true</span>
</code></pre>
<hr/>
<h3 data-id="heading-23">æ€§èƒ½è€ƒè™‘</h3>
<h4 data-id="heading-24">åŸå‹é“¾æŸ¥æ‰¾æœ‰å¼€é”€</h4>
<p>å±æ€§æŸ¥æ‰¾ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸Šï¼Œé“¾è¶Šé•¿å¼€é”€è¶Šå¤§ã€‚è™½ç„¶ç°ä»£å¼•æ“æœ‰ä¼˜åŒ–ï¼Œä½†è¿˜æ˜¯è¦æ³¨æ„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¦‚æœé¢‘ç¹è®¿é—®åŸå‹é“¾ä¸Šçš„å±æ€§ï¼Œå¯ä»¥ç¼“å­˜</span>
<span class="hljs-keyword">const</span> method = obj.<span class="hljs-property">someMethod</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
  method.<span class="hljs-title function_">call</span>(obj);  <span class="hljs-comment">// æ¯” obj.someMethod() å¿«</span>
}
</code></pre>
<h4 data-id="heading-25">Object.create(null) åˆ›å»ºçº¯å‡€å¯¹è±¡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ™®é€šå¯¹è±¡ä¼šç»§æ‰¿ Object.prototype</span>
<span class="hljs-keyword">const</span> obj = {};
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">toString</span>); <span class="hljs-comment">// Æ’ toString() { [native code] }</span>

<span class="hljs-comment">// çº¯å‡€å¯¹è±¡æ²¡æœ‰åŸå‹é“¾</span>
<span class="hljs-keyword">const</span> pureObj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pureObj.<span class="hljs-property">toString</span>); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// é€‚åˆç”¨ä½œå­—å…¸/å“ˆå¸Œè¡¨ï¼Œä¸ç”¨æ‹…å¿ƒé”®åå†²çª</span>
<span class="hljs-keyword">const</span> dict = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
dict[<span class="hljs-string">'hasOwnProperty'</span>] = <span class="hljs-string">'safe'</span>;  <span class="hljs-comment">// ä¸ä¼šè¦†ç›–åŸå‹æ–¹æ³•</span>
</code></pre>
<hr/>
<h3 data-id="heading-26">å°ç»“</h3>
<p>åŸå‹é“¾è¯´ç©¿äº†å°±æ˜¯ä¸€æ¡æŸ¥æ‰¾é“¾ï¼šæ‰¾å±æ€§æ—¶ä»å¯¹è±¡è‡ªèº«å¼€å§‹ï¼Œé¡ºç€ <code>__proto__</code> ä¸€è·¯å¾€ä¸Šæ‰¾ï¼Œç›´åˆ° <code>null</code>ã€‚</p>
<p>å‡ ä¸ªè¦ç‚¹ï¼š</p>
<ul>
<li><code>prototype</code> æ˜¯å‡½æ•°çš„å±æ€§ï¼Œç”¨äºå­˜æ”¾å…±äº«çš„æ–¹æ³•</li>
<li><code>__proto__</code>ï¼ˆæˆ– <code>[[Prototype]]</code>ï¼‰æ˜¯å¯¹è±¡çš„å±æ€§ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹</li>
<li>æ¨èç”¨ <code>Object.getPrototypeOf()</code> ä»£æ›¿ <code>__proto__</code></li>
<li><code>new</code> å…³é”®å­—åšäº†å››ä»¶äº‹ï¼šåˆ›å»ºå¯¹è±¡ã€è®¾ç½®åŸå‹ã€æ‰§è¡Œæ„é€ å‡½æ•°ã€è¿”å›å¯¹è±¡</li>
<li>æ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Šï¼Œçœå†…å­˜</li>
<li><code>class</code> æ˜¯è¯­æ³•ç³–ï¼Œåº•å±‚è¿˜æ˜¯åŸå‹é“¾</li>
<li><code>Object.prototype</code> æ˜¯åŸå‹é“¾çš„ç»ˆç‚¹ï¼Œå®ƒçš„ <code>__proto__</code> æ˜¯ <code>null</code></li>
</ul>
<p>ç†è§£äº†è¿™ä¸ªæœºåˆ¶ï¼Œå†çœ‹ JavaScript çš„é¢å‘å¯¹è±¡å°±æ¸…æ™°å¤šäº†ã€‚æ¡†æ¶æºç é‡Œå¤§é‡ä½¿ç”¨åŸå‹é“¾ï¼Œæ¯”å¦‚ Vue 2 çš„å“åº”å¼ç³»ç»Ÿã€å„ç§æ’ä»¶çš„ mixin å®ç°ï¼Œéƒ½æ˜¯åŸºäºè¿™å¥—æœºåˆ¶ã€‚</p>
<hr/>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›å¼€æºé¡¹ç›®ï¼š</p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul>
<hr/>
<h3 data-id="heading-27">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FGuide%2FInheritance_and_the_prototype_chain" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain" ref="nofollow noopener noreferrer">MDN - Inheritance and the prototype chain</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FLearn_web_development%2FExtensions%2FAdvanced_JavaScript_objects%2FObject_prototypes" target="_blank" title="https://developer.mozilla.org/en-US/docs/Learn_web_development/Extensions/Advanced_JavaScript_objects/Object_prototypes" ref="nofollow noopener noreferrer">MDN - Object prototypes</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Fnew" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new" ref="nofollow noopener noreferrer">MDN - new operator</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fjavascript.info%2Fprototype-inheritance" target="_blank" title="https://javascript.info/prototype-inheritance" ref="nofollow noopener noreferrer">JavaScript.info - Prototypal inheritance</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025 å¹´ TC39 éƒ½åœ¨å¿™ä»€ä¹ˆï¼ŸImport Bytesã€Iterator Chunking æ¥äº†]]></title>    <link>https://juejin.cn/post/7581306080435322931</link>    <guid>https://juejin.cn/post/7581306080435322931</guid>    <pubDate>2025-12-08T14:27:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581306080435322931" data-draft-id="7581359420391800859" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 å¹´ TC39 éƒ½åœ¨å¿™ä»€ä¹ˆï¼ŸImport Bytesã€Iterator Chunking æ¥äº†"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-08T14:27:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 å¹´ TC39 éƒ½åœ¨å¿™ä»€ä¹ˆï¼ŸImport Bytesã€Iterator Chunking æ¥äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T14:27:59.000Z" title="Mon Dec 08 2025 14:27:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TC39 2025ï¼šImport Bytesã€Iterator Chunking å’Œé‚£äº›å³å°†è½åœ°çš„æ–°ç‰¹æ€§</h2>
<p>å†™è·¨å¹³å°çš„ JS ä»£ç æ—¶ï¼Œè¯»ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶éƒ½å¾—å†™ä¸‰å¥—é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµè§ˆå™¨</span>
<span class="hljs-keyword">const</span> bytes = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'./photo.png'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">arrayBuffer</span>());

<span class="hljs-comment">// Node.js</span>
<span class="hljs-keyword">const</span> bytes = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>).<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'./photo.png'</span>);

<span class="hljs-comment">// Deno</span>
<span class="hljs-keyword">const</span> bytes = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Deno</span>.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'./photo.png'</span>);
</code></pre>
<p>åŒæ ·çš„éœ€æ±‚ï¼Œä¸‰ç§å†™æ³•ã€‚æƒ³å†™ä¸ªåŒæ„çš„å›¾ç‰‡å¤„ç†åº“ï¼Ÿå…ˆæŠŠè¿™ä¸‰å¥— API é€‚é…ä¸€éå†è¯´ã€‚</p>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼ŒTC39 åœ¨ 2025 å¹´æ¨è¿›äº†å¥½å‡ ä¸ªææ¡ˆæ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« èŠèŠå…¶ä¸­æœ€å€¼å¾—å…³æ³¨çš„å‡ ä¸ªï¼šImport Bytesã€Iterator Chunkingï¼Œä»¥åŠä»Šå¹´å·²ç»è¿›å…¥ Stage 4 çš„æ–°ç‰¹æ€§ã€‚</p>
<h3 data-id="heading-1">Import Bytesï¼šä¸€è¡Œä»£ç æå®šäºŒè¿›åˆ¶å¯¼å…¥</h3>
<h4 data-id="heading-2">ç°åœ¨æ˜¯ä»€ä¹ˆçŠ¶æ€</h4>
<p><strong>Stage 2.7</strong>ï¼ˆæˆªè‡³ 2025 å¹´ 9 æœˆï¼‰ï¼Œç¦»æ­£å¼æ ‡å‡†å°±å·®ä¸´é—¨ä¸€è„šäº†ã€‚ææ¡ˆè´Ÿè´£äººæ˜¯ Steven Salatï¼ŒGuy Bedford æ˜¯å…±åŒä½œè€…ã€‚</p>
<h4 data-id="heading-3">æ ¸å¿ƒè¯­æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> bytes <span class="hljs-keyword">from</span> <span class="hljs-string">"./photo.png"</span> <span class="hljs-keyword">with</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"bytes"</span> };
<span class="hljs-comment">// bytes æ˜¯ Uint8Arrayï¼Œåº•å±‚æ˜¯ä¸å¯å˜çš„ ArrayBuffer</span>
</code></pre>
<p>åŠ¨æ€å¯¼å…¥ä¹Ÿæ”¯æŒï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> bytes = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./photo.png"</span>, { <span class="hljs-attr">with</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"bytes"</span> } });
</code></pre>
<p>å°±è¿™ä¹ˆç®€å•ã€‚ä¸ç®¡ä½ åœ¨æµè§ˆå™¨ã€Node.js è¿˜æ˜¯ Denoï¼ŒåŒä¸€è¡Œä»£ç ï¼ŒåŒæ ·çš„ç»“æœã€‚</p>
<h4 data-id="heading-4">ä¸ºä»€ä¹ˆè¿”å› Uint8Array è€Œä¸æ˜¯ ArrayBuffer</h4>
<p>ææ¡ˆé€‰æ‹©è¿”å› <code>Uint8Array</code> è€Œä¸æ˜¯è£¸çš„ <code>ArrayBuffer</code>ï¼Œç†ç”±æŒºå®åœ¨çš„ï¼š</p>
<ol>
<li><strong>å°‘ä¸€æ­¥æ“ä½œ</strong> - æ‹¿åˆ° ArrayBuffer ä½ è¿˜å¾—è‡ªå·±åˆ›å»º TypedViewï¼ŒUint8Array ç›´æ¥å°±èƒ½ç”¨</li>
<li><strong>è·Ÿç°æœ‰ API ä¿æŒä¸€è‡´</strong> - <code>Response.bytes()</code> å’Œ <code>Blob.bytes()</code> éƒ½è¿”å› Uint8Array</li>
<li><strong>Node.js Buffer å…¼å®¹</strong> - Buffer æœ¬èº«å°±æ˜¯ Uint8Array çš„å­ç±»</li>
</ol>
<h4 data-id="heading-5">ä¸ºä»€ä¹ˆåº•å±‚æ˜¯ä¸å¯å˜çš„ ArrayBuffer</h4>
<p>è¿™ä¸ªè®¾è®¡å†³å®šæŒºæœ‰æ„æ€çš„ã€‚åº•å±‚ ArrayBuffer è¢«è®¾è®¡æˆä¸å¯å˜çš„ï¼ŒåŸå› æœ‰ä¸‰ï¼š</p>
<ol>
<li><strong>é¿å…å…±äº«å¯å˜çŠ¶æ€</strong> - å¤šä¸ªæ¨¡å—å¯¼å…¥åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæ‹¿åˆ°çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¯å˜ï¼Œä¸€ä¸ªæ¨¡å—æ”¹äº†æ•°æ®ï¼Œå…¶ä»–æ¨¡å—å…¨å—å½±å“</li>
<li><strong>åµŒå…¥å¼åœºæ™¯</strong> - ä¸å¯å˜æ•°æ®å¯ä»¥ç›´æ¥æ”¾ ROM é‡Œ</li>
<li><strong>å®‰å…¨æ€§è€ƒè™‘</strong> - é˜²æ­¢æ¨¡å—é—´é€šè¿‡å…±äº« buffer å»ºç«‹éšè”½é€šä¿¡é€šé“</li>
</ol>
<h4 data-id="heading-6">å®é™…èƒ½å¹²ä»€ä¹ˆ</h4>
<p><strong>å›¾ç‰‡å¤„ç†</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> imageBytes <span class="hljs-keyword">from</span> <span class="hljs-string">"./logo.png"</span> <span class="hljs-keyword">with</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"bytes"</span> };
<span class="hljs-comment">// ç”¨ satori ä¹‹ç±»çš„åŒæ„åº“å¤„ç†</span>
<span class="hljs-title function_">processImage</span>(imageBytes);
</code></pre>
<p><strong>åŠ è½½å­—ä½“</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> fontBytes <span class="hljs-keyword">from</span> <span class="hljs-string">"./custom.woff"</span> <span class="hljs-keyword">with</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"bytes"</span> };
<span class="hljs-comment">// Canvas æˆ– PDF ç”Ÿæˆæ—¶ç”¨</span>
<span class="hljs-title function_">registerFont</span>(fontBytes);
</code></pre>
<p><strong>æœºå™¨å­¦ä¹ æ¨¡å‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> modelBytes <span class="hljs-keyword">from</span> <span class="hljs-string">"./model.bin"</span> <span class="hljs-keyword">with</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"bytes"</span> };
<span class="hljs-title function_">loadModel</span>(modelBytes);
</code></pre>
<h4 data-id="heading-7">å·¥å…·é“¾æ”¯æŒ</h4>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼Œä¸»æµå·¥å…·å·²ç»åœ¨è·Ÿè¿›äº†ã€‚Deno 2.4ã€Bun 1.1.7 éƒ½æœ‰ç±»ä¼¼å®ç°ï¼ŒWebpackã€esbuildã€Parcel ä¹Ÿæ”¯æŒç±»ä¼¼çš„äºŒè¿›åˆ¶å¯¼å…¥æœºåˆ¶ã€‚ç­‰ææ¡ˆæ­£å¼è½åœ°ï¼Œç»Ÿä¸€è¯­æ³•åªæ˜¯æ—¶é—´é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">Iterator Chunkingï¼šè¿­ä»£å™¨åˆ†å—ç»ˆäºæœ‰åŸç”Ÿæ–¹æ¡ˆäº†</h3>
<h4 data-id="heading-9">ç°åœ¨æ˜¯ä»€ä¹ˆçŠ¶æ€</h4>
<p><strong>Stage 2.7</strong>ï¼ˆæˆªè‡³ 2025 å¹´ 9 æœˆï¼‰ï¼Œç”± Michael Ficarra ä¸»å¯¼ã€‚</p>
<h4 data-id="heading-10">ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•</h4>
<p><strong>chunks(size) - éé‡å åˆ†å—</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>].<span class="hljs-title function_">values</span>();
<span class="hljs-keyword">const</span> chunked = numbers.<span class="hljs-title function_">chunks</span>(<span class="hljs-number">3</span>);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> chunked) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chunk);
}
<span class="hljs-comment">// [1, 2, 3]</span>
<span class="hljs-comment">// [4, 5, 6]</span>
<span class="hljs-comment">// [7]</span>
</code></pre>
<p><strong>windows(size) - æ»‘åŠ¨çª—å£</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>].<span class="hljs-title function_">values</span>();
<span class="hljs-keyword">const</span> windowed = numbers.<span class="hljs-title function_">windows</span>(<span class="hljs-number">2</span>);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-variable language_">window</span> <span class="hljs-keyword">of</span> windowed) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>);
}
<span class="hljs-comment">// [1, 2]</span>
<span class="hljs-comment">// [2, 3]</span>
<span class="hljs-comment">// [3, 4]</span>
</code></pre>
<p>åŒºåˆ«å¾ˆç›´è§‚ï¼šchunks æ˜¯åˆ‡æˆä¸€å—ä¸€å—äº’ä¸é‡å ï¼Œwindows æ˜¯æ»‘åŠ¨çª—å£æ¯æ¬¡ç§»åŠ¨ä¸€æ ¼ã€‚</p>
<h4 data-id="heading-11">è§£å†³ä»€ä¹ˆé—®é¢˜</h4>
<p>ä»¥å‰æƒ³åšåˆ†å—æ“ä½œï¼Œè¦ä¹ˆè‡ªå·±å†™ï¼Œè¦ä¹ˆå¼•å…¥ lodashï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// lodash æ–¹æ¡ˆ</span>
<span class="hljs-keyword">import</span> chunk <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash/chunk'</span>;
<span class="hljs-keyword">const</span> chunks = <span class="hljs-title function_">chunk</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], <span class="hljs-number">2</span>);

<span class="hljs-comment">// åŸç”Ÿæ–¹æ¡ˆ</span>
<span class="hljs-keyword">const</span> chunks = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>].<span class="hljs-title function_">values</span>().<span class="hljs-title function_">chunks</span>(<span class="hljs-number">2</span>);
</code></pre>
<p>åŸç”Ÿæ–¹æ¡ˆçš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ä¸ç”¨è£…ä¾èµ–</li>
<li>æƒ°æ€§æ±‚å€¼ï¼Œå†…å­˜å‹å¥½</li>
<li>è·Ÿæ•´ä¸ªè¿­ä»£å™¨ç”Ÿæ€æ— ç¼è¡”æ¥</li>
<li>æ”¯æŒå¼‚æ­¥è¿­ä»£å™¨</li>
</ul>
<h4 data-id="heading-12">å®é™…åœºæ™¯</h4>
<p><strong>æ‰¹é‡ API è¯·æ±‚</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">batchProcess</span>(<span class="hljs-params">items</span>) {
  <span class="hljs-keyword">const</span> batches = items.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">chunks</span>(<span class="hljs-number">50</span>);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> batch <span class="hljs-keyword">of</span> batches) {
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(batch.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> api.<span class="hljs-title function_">process</span>(item)));
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">1000</span>); <span class="hljs-comment">// é¿å…è§¦å‘é™æµ</span>
  }
}
</code></pre>
<p><strong>ç§»åŠ¨å¹³å‡è®¡ç®—</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">movingAverage</span>(<span class="hljs-params">numbers, windowSize</span>) {
  <span class="hljs-keyword">return</span> numbers
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">windows</span>(windowSize)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b) / windowSize)
    .<span class="hljs-title function_">toArray</span>();
}

<span class="hljs-keyword">const</span> prices = [<span class="hljs-number">100</span>, <span class="hljs-number">102</span>, <span class="hljs-number">98</span>, <span class="hljs-number">105</span>, <span class="hljs-number">103</span>, <span class="hljs-number">107</span>];
<span class="hljs-keyword">const</span> ma3 = <span class="hljs-title function_">movingAverage</span>(prices, <span class="hljs-number">3</span>);
<span class="hljs-comment">// 3æ—¥ç§»åŠ¨å¹³å‡</span>
</code></pre>
<p><strong>N-gram ç”Ÿæˆ</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generateNGrams</span>(<span class="hljs-params">text, n</span>) {
  <span class="hljs-keyword">const</span> words = text.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>);
  <span class="hljs-keyword">return</span> words.<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">windows</span>(n)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-title function_">join</span>(<span class="hljs-string">' '</span>))
    .<span class="hljs-title function_">toArray</span>();
}

<span class="hljs-keyword">const</span> bigrams = <span class="hljs-title function_">generateNGrams</span>(<span class="hljs-string">"The quick brown fox"</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// ["The quick", "quick brown", "brown fox"]</span>
</code></pre>
<h4 data-id="heading-13">è¾¹ç•Œæƒ…å†µçš„è®¨è®º</h4>
<p>è¿™ä¸ªææ¡ˆåœ¨æ¨è¿›è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜ï¼š<strong>å¦‚æœè¿­ä»£å™¨å…ƒç´ å°‘äºçª—å£å¤§å°ï¼Œwindows() åº”è¯¥è¿”å›ä»€ä¹ˆï¼Ÿ</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> small = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>].<span class="hljs-title function_">values</span>();
<span class="hljs-keyword">const</span> result = small.<span class="hljs-title function_">windows</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// åªæœ‰2ä¸ªå…ƒç´ ï¼Œè¯·æ±‚3ä¸ªçš„çª—å£</span>

<span class="hljs-comment">// é€‰é¡¹1ï¼šä¸è¿”å›ä»»ä½•çª—å£</span>
<span class="hljs-comment">// é€‰é¡¹2ï¼šè¿”å› [1, 2] ä½œä¸ºä¸å®Œæ•´çª—å£</span>
</code></pre>
<p>å§”å‘˜ä¼šè®¨è®ºåè®¤ä¸ºä¸¤ç§åœºæ™¯éƒ½æœ‰åˆç†çš„ä½¿ç”¨éœ€æ±‚ï¼Œæ‰€ä»¥å†³å®šæŠŠ <code>windows()</code> æ‹†åˆ†æˆå¤šä¸ªæ–¹æ³•æ¥åˆ†åˆ«å¤„ç†è¿™ä¸¤ç§æƒ…å†µã€‚è¿™ä¹Ÿæ˜¯ææ¡ˆä» Stage 2 åˆ° Stage 2.7 èŠ±äº†ç‚¹æ—¶é—´çš„åŸå› ã€‚</p>
<h3 data-id="heading-14">2025 å¹´è¿›å…¥ Stage 4 çš„ç‰¹æ€§</h3>
<p>é™¤äº†ä¸Šé¢ä¸¤ä¸ªè¿˜åœ¨æ¨è¿›çš„ææ¡ˆï¼Œ2025 å¹´è¿˜æœ‰å¥½å‡ ä¸ªç‰¹æ€§å·²ç»æ­£å¼"æ¯•ä¸š"äº†ï¼š</p>
<h4 data-id="heading-15">RegExp.escapeï¼ˆ2 æœˆï¼‰</h4>
<p>å®‰å…¨è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œé˜²æ­¢æ³¨å…¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> userInput = <span class="hljs-string">"user@example.com (admin)"</span>;
<span class="hljs-keyword">const</span> safePattern = <span class="hljs-title class_">RegExp</span>.<span class="hljs-built_in">escape</span>(userInput);
<span class="hljs-keyword">const</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(safePattern);
<span class="hljs-comment">// ä¸ç”¨æ‹…å¿ƒæ‹¬å·è¢«è§£ææˆåˆ†ç»„äº†</span>
</code></pre>
<p>è¿™ä¸ªéœ€æ±‚å¤ªå¸¸è§äº†ï¼Œä»¥å‰éƒ½å¾—è‡ªå·±å†™è½¬ä¹‰å‡½æ•°æˆ–è€…ç”¨ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<h4 data-id="heading-16">Float16Arrayï¼ˆ2 æœˆï¼‰</h4>
<p>åŠç²¾åº¦æµ®ç‚¹æ•°çš„ TypedArrayï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> f16Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float16Array</span>([<span class="hljs-number">1.5</span>, <span class="hljs-number">2.7</span>, <span class="hljs-number">3.1</span>]);
</code></pre>
<p>ä¸»è¦é¢å‘æœºå™¨å­¦ä¹ å’Œå›¾å½¢å¤„ç†åœºæ™¯ã€‚æ¨¡å‹æƒé‡ç»å¸¸ç”¨ fp16 å­˜å‚¨ï¼Œæœ‰äº†åŸç”Ÿæ”¯æŒå°±ä¸ç”¨è‡ªå·±åšè½¬æ¢äº†ã€‚</p>
<h4 data-id="heading-17">Error.isErrorï¼ˆ5 æœˆï¼‰</h4>
<p>å¯é åœ°åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯ Errorï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-title class_">Error</span>.<span class="hljs-title function_">isError</span>(value)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-property">message</span>);
}
</code></pre>
<p>ä¸ºä»€ä¹ˆä¸ç”¨ <code>instanceof Error</code>ï¼Ÿå› ä¸ºè·¨ realmï¼ˆæ¯”å¦‚ iframe æˆ– Node.js çš„ vm æ¨¡å—ï¼‰çš„ Error å®ä¾‹ä¼šè¢«åˆ¤æˆ falseã€‚è¿™ä¸ªæ–¹æ³•è§£å†³äº†è¿™ä¸ªå†å²é—®é¢˜ã€‚</p>
<h4 data-id="heading-18">Math.sumPreciseï¼ˆ7 æœˆï¼‰</h4>
<p>é«˜ç²¾åº¦æ±‚å’Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> sum = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sumPrecise</span>([<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>]);
<span class="hljs-comment">// æ¯”æ™®é€šç´¯åŠ æ›´ç²¾ç¡®ï¼Œå‡å°‘æµ®ç‚¹è¯¯å·®ç´¯ç§¯</span>
</code></pre>
<p>åšé‡‘èè®¡ç®—æˆ–ç§‘å­¦è®¡ç®—çš„åº”è¯¥ä¼šå–œæ¬¢è¿™ä¸ªã€‚</p>
<h4 data-id="heading-19">Uint8Array Base64 ç¼–è§£ç ï¼ˆ7 æœˆï¼‰</h4>
<p>åŸç”Ÿçš„ Base64 ç¼–è§£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> bytes = <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-title function_">fromBase64</span>(<span class="hljs-string">'SGVsbG8='</span>);
<span class="hljs-keyword">const</span> base64 = bytes.<span class="hljs-title function_">toBase64</span>();
<span class="hljs-comment">// è¿˜æœ‰ fromHex() å’Œ toHex()</span>
</code></pre>
<p>ç»ˆäºä¸ç”¨ä¸ºäº† Base64 è½¬æ¢å»æ‰¾ç¬¬ä¸‰æ–¹åº“äº†ã€‚</p>
<h4 data-id="heading-20">Explicit Resource Managementï¼ˆå·² Stage 4ï¼‰</h4>
<p><code>using</code> å…³é”®å­—ï¼Œè‡ªåŠ¨èµ„æºæ¸…ç†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">using file = <span class="hljs-keyword">await</span> <span class="hljs-title function_">openFile</span>(<span class="hljs-string">'data.txt'</span>);
<span class="hljs-comment">// ç¦»å¼€ä½œç”¨åŸŸè‡ªåŠ¨å…³é—­ï¼Œä¸ç”¨æ‰‹åŠ¨ finally</span>
</code></pre>
<p>å€Ÿé‰´äº† Python çš„ with å’Œ C# çš„ usingï¼Œè§£å†³äº† JS é‡Œèµ„æºç®¡ç†ä¸€ç›´å¾ˆæ··ä¹±çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-21">è¿˜æœ‰å‡ ä¸ªå€¼å¾—å…³æ³¨çš„ Stage 2 ææ¡ˆ</h3>
<h4 data-id="heading-22">Seeded PRNGï¼ˆ5 æœˆè¿›å…¥ Stage 2ï¼‰</h4>
<p>å¯ç§å­åŒ–çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> random = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>(<span class="hljs-number">12345</span>); <span class="hljs-comment">// ç§å­</span>
<span class="hljs-keyword">const</span> value = random.<span class="hljs-title function_">next</span>();
<span class="hljs-comment">// åŒæ ·çš„ç§å­ï¼ŒåŒæ ·çš„åºåˆ—</span>
</code></pre>
<p>æ¸¸æˆå¼€å‘ã€æµ‹è¯•ã€ä»¿çœŸè¿™äº›åœºæ™¯ç»å¸¸éœ€è¦å¯é‡ç°çš„éšæœºåºåˆ—ã€‚</p>
<h4 data-id="heading-23">Error Stack Accessorï¼ˆ5 æœˆè¿›å…¥ Stage 2ï¼‰</h4>
<p>æ ‡å‡†åŒ–é”™è¯¯å †æ ˆçš„è®¿é—®æ–¹å¼ã€‚ç°åœ¨å„ä¸ªå¼•æ“çš„ <code>error.stack</code> æ ¼å¼éƒ½ä¸ä¸€æ ·ï¼Œè¿™ä¸ªææ¡ˆè¦ç»Ÿä¸€å®ƒã€‚</p>
<h3 data-id="heading-24">ææ¡ˆæµç¨‹ç®€å•å›é¡¾</h3>
<p>TC39 çš„ææ¡ˆåˆ† 5 ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li><strong>Stage 0</strong>ï¼šæƒ³æ³•</li>
<li><strong>Stage 1</strong>ï¼šæ­£å¼ææ¡ˆï¼Œå¼€å§‹è®¨è®º</li>
<li><strong>Stage 2</strong>ï¼šè§„èŒƒè‰æ¡ˆï¼ŒAPI åŸºæœ¬ç¨³å®š</li>
<li><strong>Stage 2.7</strong>ï¼šè§„èŒƒæ–‡æœ¬æ¥è¿‘å®Œæˆï¼Œå‡†å¤‡å†™æµ‹è¯•</li>
<li><strong>Stage 3</strong>ï¼šç­‰å¾…å®ç°åé¦ˆ</li>
<li><strong>Stage 4</strong>ï¼šæ­£å¼çº³å…¥æ ‡å‡†</li>
</ul>
<p>Import Bytes å’Œ Iterator Chunking éƒ½åˆ°äº† Stage 2.7ï¼Œç¦» Stage 3 å°±å·® test262 æµ‹è¯•å’Œæµè§ˆå™¨å®ç°æ‰¿è¯ºäº†ã€‚</p>
<h3 data-id="heading-25">æ€»ç»“</h3>
<p>2025 å¹´ TC39 çš„è¿›å±•è¿˜æ˜¯æŒºç»™åŠ›çš„ï¼š</p>
<ul>
<li><strong>Import Bytes</strong> è§£å†³äº†è·¨å¹³å°äºŒè¿›åˆ¶å¯¼å…¥çš„è€å¤§éš¾é—®é¢˜ï¼ŒåŒæ„åº“å¼€å‘ç»ˆäºèƒ½çœå¿ƒäº†</li>
<li><strong>Iterator Chunking</strong> è¡¥ä¸Šäº†è¿­ä»£å™¨å·¥å…·é“¾çš„ç©ºç™½ï¼Œchunks å’Œ windows è¦†ç›–äº†å¤§éƒ¨åˆ†åˆ†å—åœºæ™¯</li>
<li><strong>ä¸€å †ç‰¹æ€§è¿›å…¥ Stage 4</strong>ï¼šRegExp.escapeã€Float16Arrayã€Math.sumPreciseã€Base64 ç¼–è§£ç ã€èµ„æºç®¡ç†...</li>
</ul>
<p>è¿™äº›ç‰¹æ€§æœ‰çš„å·²ç»å¯ä»¥é€šè¿‡ Babel æˆ– TypeScript æå‰å°é²œäº†ã€‚å¦‚æœä½ åœ¨ç”¨ Deno æˆ– Bunï¼ŒImport Bytes ç±»ä¼¼çš„åŠŸèƒ½ç°åœ¨å°±èƒ½ç”¨ã€‚</p>
<hr/>
<p><strong>é¡ºæ‰‹å®‰åˆ©å‡ ä¸ªæˆ‘çš„å¼€æºé¡¹ç›®ï¼š</strong></p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul>
<hr/>
<h3 data-id="heading-26">å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposals" target="_blank" title="https://github.com/tc39/proposals" ref="nofollow noopener noreferrer">TC39 Proposals Repository</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftc39%2Fproposal-import-bytes" target="_blank" title="https://github.com/tc39/proposal-import-bytes" ref="nofollow noopener noreferrer">Import Bytes Proposal</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftc39.es%2Fproposal-iterator-chunking%2F" target="_blank" title="https://tc39.es/proposal-iterator-chunking/" ref="nofollow noopener noreferrer">Iterator Chunking Specification</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblogs.igalia.com%2Fcompilers%2F2025%2F03%2F27%2Fsummary-of-the-february-2025-tc39-plenary%2F" target="_blank" title="https://blogs.igalia.com/compilers/2025/03/27/summary-of-the-february-2025-tc39-plenary/" ref="nofollow noopener noreferrer">February 2025 TC39 Meeting Summary</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblogs.igalia.com%2Fcompilers%2F2025%2F07%2F03%2Fsummary-of-the-may-2025-tc39-plenary%2F" target="_blank" title="https://blogs.igalia.com/compilers/2025/07/03/summary-of-the-may-2025-tc39-plenary/" ref="nofollow noopener noreferrer">May 2025 TC39 Meeting Summary</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.infoq.com%2Fnews%2F2025%2F06%2Ftc39-stage-4-2025%2F" target="_blank" title="https://www.infoq.com/news/2025/06/tc39-stage-4-2025/" ref="nofollow noopener noreferrer">TC39 Stage 4 Proposals 2025</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¶…å…¨Nano Banana Pro æç¤ºè¯æ¡ˆä¾‹åº“æ¥å•¦ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹]]></title>    <link>https://juejin.cn/post/7581348660823638016</link>    <guid>https://juejin.cn/post/7581348660823638016</guid>    <pubDate>2025-12-08T14:53:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581348660823638016" data-draft-id="7581299982671675426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¶…å…¨Nano Banana Pro æç¤ºè¯æ¡ˆä¾‹åº“æ¥å•¦ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T14:53:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä½•"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¶…å…¨Nano Banana Pro æç¤ºè¯æ¡ˆä¾‹åº“æ¥å•¦ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä½•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T14:53:39.000Z" title="Mon Dec 08 2025 14:53:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯è‹ä½•çš„ç¬¬ 454 ç¯‡åŸåˆ›ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åœ¨ç æµ·ç© Nano Banana Pro çš„è‹ä½•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df1d3429c12b43a1a37f7b8f68d1470d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=swjgWtC%2FlXEOlAs6G1SMskMf%2FPI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç¬‘æ­»ï¼Œæˆ‘çœŸæ˜¯ç–¯äº†ã€‚</p>
<p>èŠ±äº†äº›æ—¶é—´ï¼Œæ•´ç†äº† Nano Banana Pro çš„è¶…å¤šç©æ³•åŠæç¤ºè¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/028acaa9c5a94954915dd8d5d2e52c20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=vA6NxxQRZVYJp%2FU4d8%2BYFrEZBfk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä¹Ÿå½•äº†ä¸ªè§†é¢‘ï¼Œå¤§å®¶å¯ä»¥æµ…æµ…æ„Ÿå—ä¸€ä¸‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19e86cbc62f54185822e10cd276bc181~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=7aIhop0cKjSd3gk4UV%2F278v6sHs%3D" alt="wxv_4271684942264188930" loading="lazy"/></p>
<blockquote>
<p>â</p>
<p>ps:æˆ‘æŠŠè¿™ä¸ªå¼€æºæ–‡æ¡£æ”¾åœ¨è¯„è®ºåŒºäº†ï¼Œæç¤ºè¯å¯ä»¥ç›´æ¥å¤åˆ¶ï¼Œä¹Ÿæ¬¢è¿ç»™ğŸ¶bè‹ä½•ç‚¹ä¸ªå‘è´¢çš„èµï¼Œè·ªäº†ã€‚</p>
<p>â</p>
</blockquote>
<p>ç©ç€ç©ç€åˆå‘ç°äº†ä¸å°‘æœ‰æ„æ€çš„ï¼Œæˆ‘è®¤ä¸ºæ¯”è¾ƒéªšçš„ç©æ³•ï¼Œæ‰€ä»¥ä»Šå¤©è¿™ç¯‡æ–‡ç« æ¥åšä¸ªåˆ†äº«ã€‚</p>
<p>å…ˆè¯´ä¸‹ï¼Œæˆ‘ä¾æ—§æ˜¯åœ¨æˆ‘ä»¬è€æœ‹å‹ Lovart ä¸Šç©çš„ï¼ˆåˆ«æµªè´¹äº†æˆ‘å°Šè´µçš„å¹´ä¼šå‘˜èº«ä»½ğŸ¶ï¼‰ï¼Œé…åˆæ— é™ç”»å¸ƒï¼Œä»¥åŠæ–°å‡ºçš„ Touch-edit æ¨¡å¼ï¼Œå¯æ§æ”¹å›¾ï¼ŒæŒ‡å“ªæ‰“å“ªï¼Œä¸è¦å¤ªçˆ½ã€‚</p>
<p>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lovart.ai" target="_blank" title="https://www.lovart.ai" ref="nofollow noopener noreferrer">www.lovart.ai</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/192bc7e0faa64a3b96fcafc56e0fd365~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=1SGYfR8QrTQuxzlS4y4OpTtTd0Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬æ¥çœ‹ä¿º Nano Banana Pro ä¸€äº›æœ‰æ„æ€çš„ç©æ³•ã€‚</p>
<h2 data-id="heading-0">äººç‰©ç»†èŠ‚æ‹†è§£</h2>
<p>è¦è¯´è¿™2å¤©æœ€ç«çš„ï¼Œè¿˜å¾—æ˜¯æˆ‘ç¥ä½¬çš„è¿™ä¸ªç»†èŠ‚æ‹†è§£å›¾ï¼Œåœ¨ X ä¸Šä¸€åº¦ç–¯ä¼ ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5701dc806ea440d92d957eb3243b18f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=7yjRrY8MsVhXNmVTBOwGZKj%2BBog%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä¸çŸ¥é“ä¸ºå•¥ç«ï¼Œå•çº¯è§‰å¾—æŒºæœ‰æ„æ€ï¼Œåœ¨ç¥ä½¬çš„åŸºç¡€ä¸Šç¨åŠ æ”¹åŠ¨ï¼Œçœ‹æˆ‘å‡ºçš„å›¾ã€‚</p>
<p>è¿™ä¸ªæ˜¯åŸå›¾ï¼Œä¹Ÿæ˜¯ Nano Banana Pro ç”»çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a763c32bb7af458aab19ddf97de88a8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=jatJ4cDCoUbyFQnaYVE2L%2FkJ7fg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æç¤ºè¯æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">ä¸€å¼ é«˜è´¨é‡çš„å¥³æ€§è§’è‰²ç«‹ç»˜ï¼Œç²¾è‡´çš„éŸ©æ¼«åšæ¶‚é£æ ¼ã€‚ç”»é¢ä¸­æ˜¯ä¸€ä½å¹²ç»ƒè‡ªä¿¡çš„èŒåœºå¾¡å§ï¼Œå¥¹æœ‰ç€æ·±æ£•è‰²çš„å¤§æ³¢æµªé•¿å·å‘ï¼Œç•™ç€ç©ºæ°”åˆ˜æµ·ï¼Œ
æˆ´ç€ä¸€å‰¯ç²¾è‡´çš„é‡‘å±ç»†æ¡†çœ¼é•œï¼Œçœ¼ç¥çŸ¥æ€§ä¸”è¿·äººï¼Œå˜´è§’å¸¦ç€è‡ªä¿¡çš„å¾®ç¬‘ã€‚å¥¹èº«ç©¿å‰ªè£åˆä½“çš„é»‘è‰²ä¿®èº«è¥¿è£…å¤–å¥—ï¼Œå†…æ­é²œçº¢è‰²çš„ç¿»é¢†è¡¬è¡«ï¼Œä¸‹èº«æ˜¯é»‘è‰²åŒ…è‡€çŸ­è£™æ­é…é»‘è‰²é€è‚‰ä¸è¢œï¼Œè„šè¸©é»‘è‰²å°–å¤´çº¢åº•é«˜è·Ÿé‹ã€‚å¥¹å•æ‰‹æ’åœ¨è¥¿è£…å£è¢‹é‡Œï¼Œ
è‚©ä¸ŠæŒç€ä¸€ä¸ªå¤å¤æ£•è‰²çš„çš®é©é‚®å·®åŒ…ï¼Œç«™å§¿ä¼˜é›…æŒºæ‹”ã€‚èƒŒæ™¯ä¸ºç±³é»„è‰²çš„çº¸è´¨çº¹ç†ï¼Œ
<span class="hljs-section">å…‰å½±æŸ”å’Œï¼Œé«˜åˆ†è¾¨ç‡ï¼Œç»†èŠ‚ä¸°å¯Œï¼Œå°ºå¯¸ï¼š9:16ï¼Œç”»è´¨4k</span>
</code></pre>
<p>ä½†æˆ‘å‘ç°å’Œç¥ä½¬çš„æ¯”ï¼Œç¼ºå°‘äº†ä¸€äº›æ€§æ„Ÿå…ƒç´ ã€‚</p>
<p>äºæ˜¯æˆ‘åœ¨ Lovart ç”¨ Touch edit æ ‡è®°æˆ‘è¦ä¿®æ”¹çš„è£™å­ï¼Œç›´æ¥è®©å®ƒç”Ÿæˆæ›´çŸ­äº›çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2b3d7f569584af69fdfc030ce19a69d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=x6ptfGPjCG0enzdGSfQyGIqg68I%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤šè¯´ä¸€å˜´ï¼Œè¿™ä¸ªåŠŸèƒ½ä½¿ç”¨ç›´æ¥åœ¨è¿™é‡Œé€‰æ‹©ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d734260b2a3e41d2a898468e65b0d8b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=gecpEnP17p%2BlMxXyEeGGrvmsU2k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åç‚¹æˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„å±€éƒ¨å…ƒç´ ï¼Œå°±å¯ä»¥å±€éƒ¨ä¿®æ”¹ç»†èŠ‚ï¼Œåšåˆ°ç²¾å‡†å±€éƒ¨æ”¹åŠ¨ã€‚</p>
<p>ä¿—ç§°æŒ‡å“ªæ‰“å“ªã€‚</p>
<p>ç„¶åæ”¹å®Œåï¼Œå›¾æ˜¯è¿™æ ·å­çš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17865217ac0b47bfac1101c076ae53f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=wC%2BFUBNiVtiidydm%2F4xU1nHiQC4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½ åˆ«è¯´ï¼Œæ•ˆæœæ„Ÿè§‰å°±ä¸Šæ¥äº†ã€‚</p>
<p>å¥½ï¼Œç„¶åè¾“å…¥è¿™æ ·ä¸€ä¸²æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Role (è§’è‰²è®¾å®š)
ä½ æ˜¯ä¸€ä½é¡¶å°–çš„æ¸¸æˆä¸åŠ¨æ¼«æ¦‚å¿µç¾æœ¯è®¾è®¡å¤§å¸ˆ (Concept Artist)ï¼Œæ“…é•¿åˆ¶ä½œè¯¦å°½çš„è§’è‰²è®¾å®šå›¾ï¼ˆCharacter Sheetï¼‰ã€‚ä½ å…·å¤‡â€œåƒç´ çº§æ‹†è§£â€çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿé€è§†è§’è‰²çš„ç©¿ç€å±‚çº§ã€æ•æ‰å¾®è¡¨æƒ…å˜åŒ–ï¼Œå¹¶å°†ä¸å…¶ç›¸å…³çš„ç‰©å“è¿›è¡Œå…·è±¡åŒ–è¿˜åŸã€‚ä½ ç‰¹åˆ«æ“…é•¿é€šè¿‡å¥³æ€§è§’è‰²çš„ç§å¯†ç‰©å“ã€éšèº«ç‰©ä»¶å’Œç”Ÿæ´»ç»†èŠ‚æ¥ä¾§é¢ä¸°æ»¡äººç‰©æ€§æ ¼ä¸èƒŒæ™¯æ•…äº‹ã€‚
Task (ä»»åŠ¡ç›®æ ‡)
æ ¹æ®ç”¨æˆ·ä¸Šä¼ æˆ–æè¿°çš„ä¸»ä½“å½¢è±¡ï¼Œç”Ÿæˆä¸€å¼ çºµå‘ï¼ˆ<span class="hljs-number">9</span>:<span class="hljs-number">16</span>æ¯”ä¾‹ï¼‰çš„â€œå…¨æ™¯å¼è§’è‰²æ·±åº¦æ¦‚å¿µåˆ†è§£å›¾â€ã€‚è¯¥å›¾ç‰‡å¿…é¡»åŒ…å«ä¸­å¿ƒäººç‰©å…¨èº«ç«‹ç»˜ï¼Œå¹¶åœ¨å…¶å‘¨å›´ç¯ç»•å±•ç¤ºè¯¥äººç‰©çš„æœè£…åˆ†å±‚ã€ä¸åŒè¡¨æƒ…ã€æ ¸å¿ƒé“å…·ã€æè´¨ç‰¹å†™ï¼Œä»¥åŠæå…·ç”Ÿæ´»æ°”æ¯çš„ç§å¯†ä¸éšèº«ç‰©å“å±•ç¤ºã€‚
VisualÂ GuidelinesÂ (è§†è§‰è§„èŒƒ)
Â * æ„å›¾å¸ƒå±€Â (Layout):
Â  Â â€¢ æ•´ä½“ç”»å¸ƒÂ (Canvas): å¿…é¡»é‡‡ç”¨ <span class="hljs-number">9</span>:<span class="hljs-number">16</span> çš„çºµå‘æ„å›¾ã€‚
Â  Â â€¢ ä¸­å¿ƒä½Â (Center): æ”¾ç½®è§’è‰²çš„å…¨èº«ç«‹ç»˜æˆ–ä¸»è¦åŠ¨æ€å§¿åŠ¿ï¼Œä½œä¸ºè§†è§‰é”šç‚¹ã€‚
Â  Â â€¢ ç¯ç»•ä½Â (Surroundings): åœ¨ä¸­å¿ƒäººç‰©å››å‘¨ç©ºç™½å¤„ï¼Œå……åˆ†åˆ©ç”¨çºµå‘ç©ºé—´æœ‰åºæ’åˆ—æ‹†è§£åçš„å…ƒç´ ã€‚
Â  Â â€¢ è§†è§‰å¼•å¯¼Â (Connectors): ä½¿ç”¨æ‰‹ç»˜ç®­å¤´æˆ–å¼•å¯¼çº¿ï¼Œå°†å‘¨è¾¹çš„æ‹†è§£ç‰©å“ä¸ä¸­å¿ƒäººç‰©çš„å¯¹åº”éƒ¨ä½æˆ–æ‰€å±åŒºåŸŸï¼ˆå¦‚åŒ…åŒ…è¿æ¥æ‰‹éƒ¨ï¼‰è¿æ¥èµ·æ¥ã€‚
Â * æ‹†è§£å†…å®¹Â (Deconstruction Details)Â â€”â€” æ ¸å¿ƒè¿­ä»£åŒºåŸŸ:
Â  Â â€¢ æœè£…åˆ†å±‚Â (Clothing Layers)Â [åŠ å¼ºç‰ˆ]:
Â  Â â€¢ å°†è§’è‰²çš„æœè£…æ‹†åˆ†ä¸ºå•å“å±•ç¤ºã€‚å¦‚æœæ˜¯å¤šå±‚ç©¿æ­ï¼Œéœ€å±•ç¤ºè„±ä¸‹å¤–å¥—åçš„å†…å±‚çŠ¶æ€ã€‚
Â  Â â€¢ æ–°å¢ï¼šç§å¯†å†…ç€æ‹†è§£Â (Intimate Apparel): ç‹¬ç«‹å±•ç¤ºè§’è‰²çš„å†…å±‚è¡£ç‰©ï¼Œé‡ç‚¹çªå‡ºè®¾è®¡æ„Ÿä¸æè´¨ã€‚ä¾‹å¦‚ï¼šæˆå¥—çš„è•¾ä¸å†…è¡£è£¤ï¼ˆå±•ç¤ºè•¾ä¸èŠ±çº¹ç»†èŠ‚ï¼‰ã€ä¸å­—è£¤ï¼ˆå±•ç¤ºå‰ªè£ï¼‰ã€ä¸è¢œï¼ˆå±•ç¤ºé€è‚‰æ„Ÿä¸è¢œå£è®¾è®¡ï¼‰ã€å¡‘èº«è¡£æˆ–å®‰å…¨è£¤ç­‰ã€‚
Â  Â â€¢ è¡¨æƒ…é›†Â (Expression Sheet):
Â  Â â€¢ åœ¨è§’è½ç»˜åˆ¶ <span class="hljs-number">3</span>-<span class="hljs-number">4</span> ä¸ªä¸åŒçš„å¤´éƒ¨ç‰¹å†™ï¼Œå±•ç¤ºä¸åŒçš„æƒ…ç»ªï¼ˆå¦‚ï¼šå†·æ¼ ã€å®³ç¾ã€æƒŠè®¶ã€å¤±ç¥ã€æˆ–æ¶‚å£çº¢æ—¶çš„ä¸“æ³¨ç¥æ€ï¼‰ã€‚
Â  Â â€¢ æè´¨ç‰¹å†™Â (Texture &amp; Zoom)Â [åŠ å¼ºç‰ˆ]:
Â  Â â€¢ é€‰å– <span class="hljs-number">1</span>-<span class="hljs-number">2</span> ä¸ªå…³é”®éƒ¨ä½è¿›è¡Œæ”¾å¤§ç‰¹å†™ã€‚ä¾‹å¦‚ï¼šå¸ƒæ–™çš„è¤¶çš±ã€çš®è‚¤çš„çº¹ç†ã€æ‰‹éƒ¨ç»†èŠ‚ã€‚
Â  Â â€¢ æ–°å¢ï¼šç‰©å“è´¨æ„Ÿç‰¹å†™: å¢åŠ å¯¹å°ç‰©ä»¶æè´¨çš„æç»˜ï¼Œä¾‹å¦‚ï¼šå£çº¢è†ä½“çš„æ¶¦æ³½æ„Ÿã€çš®é©åŒ…åŒ…çš„é¢—ç²’çº¹ç†ã€åŒ–å¦†å“ç²‰è´¨çš„ç»†è…»æ„Ÿã€‚
Â  Â â€¢ å…³è”ç‰©å“Â (Related Items)Â [æ·±åº¦è¿­ä»£ç‰ˆ]:
Â  Â â€¢ æ­¤å¤„ä¸å†å±€é™äºå¤§å‹é“å…·ï¼Œéœ€å¢åŠ å±•ç¤ºè§’è‰²çš„â€œç”Ÿæ´»åˆ‡ç‰‡â€ã€‚
Â  Â â€¢ éšèº«åŒ…è¢‹ä¸å†…å®¹ç‰©Â (Bag &amp; Contents): ç»˜åˆ¶è§’è‰²çš„æ—¥å¸¸é€šå‹¤åŒ…æˆ–æ‰‹æ‹¿åŒ…ï¼Œå¹¶å°†å…¶â€œæ‰“å¼€â€ï¼Œå±•ç¤ºæ•£è½åœ¨æ—çš„ç‰©å“ã€‚
Â  Â â€¢ ç¾å¦†ä¸æŠ¤ç†Â (Beauty &amp; Grooming): å±•ç¤ºå…¶å¸¸ç”¨çš„åŒ–å¦†å“ç»„åˆï¼ˆå¦‚ï¼šç‰¹å®šè‰²å·çš„å£çº¢/å”‡é‡‰ç‰¹å†™ã€å¸¦é•œå­çš„ç²‰é¥¼ç›’ã€é¦™æ°´ç“¶è®¾è®¡ã€æŠ¤æ‰‹éœœï¼‰ã€‚
Â  Â â€¢ ç§å¯†ç”Ÿæ´»ç‰©ä»¶Â (Lifestyle &amp; Intimate Items): å…·è±¡åŒ–è§’è‰²éšè—é¢çš„ç‰©å“ã€‚æ ¹æ®è§’è‰²æ€§æ ¼å¯èƒ½åŒ…æ‹¬ï¼šç§å¯†æ—¥è®°æœ¬ã€å¸¸ç”¨è¯ç‰©/è¡¥å‰‚ç›’ã€ç”µå­çƒŸã€æˆ–è€…æ›´ç§äººçš„ç‰©ä»¶ï¼ˆå¦‚ç”¨æˆ·æåˆ°çš„é£æœºæ¯/æƒ…è¶£ç”¨å“ï¼Œéœ€ä»¥ä¸€ç§è®¾è®¡å›¾çš„å®¢è§‚è§†è§’å‘ˆç°ï¼Œæ³¨æ˜å‹å·æˆ–è®¾è®¡ç‰¹ç‚¹ï¼‰ã€‚
Â * é£æ ¼ä¸æ³¨é‡ŠÂ (Style &amp; Annotations):
Â  Â â€¢ ç”»é£: ä¿æŒé«˜è´¨é‡çš„ <span class="hljs-number">2</span>D æ’ç”»é£æ ¼æˆ–æ¦‚å¿µè®¾è®¡è‰å›¾é£æ ¼ï¼Œçº¿æ¡å¹²å‡€åˆ©è½ã€‚
Â  Â â€¢ èƒŒæ™¯: ä½¿ç”¨ç±³é»„è‰²ã€ç¾Šçš®çº¸æˆ–æµ…ç°è‰²çº¹ç†èƒŒæ™¯ï¼Œè¥é€ è®¾è®¡æ‰‹ç¨¿çš„æ°›å›´ã€‚
Â  Â â€¢ æ–‡å­—è¯´æ˜: åœ¨æ¯ä¸ªæ‹†è§£å…ƒç´ æ—æ¨¡æ‹Ÿæ‰‹å†™æ³¨é‡Šï¼Œç®€è¦è¯´æ˜æè´¨ï¼ˆå¦‚â€œæŸ”è½¯è•¾ä¸â€ã€â€œç£¨ç ‚çš®é©â€ï¼‰æˆ–å“ç‰Œ/å‹å·æš—ç¤ºï¼ˆå¦‚â€œå¸¸ç”¨è‰²å·<span class="hljs-number">#520</span>â€ã€â€œå®šåˆ¶æ¬¾â€ï¼‰ã€‚
<span class="hljs-built_in">Workflow</span>(æ‰§è¡Œé€»è¾‘)
å½“ç”¨æˆ·æä¾›ä¸€å¼ å›¾ç‰‡æˆ–æè¿°æ—¶ï¼š
Â * åˆ†æä¸»ä½“çš„æ ¸å¿ƒç‰¹å¾ã€ç©¿ç€é£æ ¼åŠæ½œåœ¨æ€§æ ¼ã€‚
Â * æå–å¯æ‹†è§£çš„ä¸€çº§å…ƒç´ ï¼ˆå¤–å¥—ã€é‹å­ã€å¤§è¡¨æƒ…ï¼‰ã€‚
Â * è„‘è¡¥å¹¶è®¾è®¡äºŒçº§æ·±åº¦å…ƒç´ ï¼ˆå¥¹å†…è¡£ç©¿ä»€ä¹ˆé£æ ¼ï¼Ÿå¥¹åŒ…é‡Œä¼šè£…ä»€ä¹ˆå£çº¢ï¼Ÿå¥¹ç‹¬å¤„æ—¶ä¼šç”¨ä»€ä¹ˆç‰©å“ï¼Ÿï¼‰ã€‚
Â * ç”Ÿæˆä¸€å¼ åŒ…å«æ‰€æœ‰è¿™äº›å…ƒç´ çš„ç»„åˆå›¾ï¼Œç¡®ä¿é€è§†å‡†ç¡®ï¼Œå…‰å½±ç»Ÿä¸€ï¼Œæ³¨é‡Šæ¸…æ™°ã€‚
Â * ä½¿ç”¨ä¸­æ–‡ï¼šè‹±æ–‡æ ‡è®°ï¼Œé«˜æ¸…<span class="hljs-number">4</span>K HD è¾“å‡ºï¼Œç¡®ä¿å›¾ç‰‡ä¸¥æ ¼ç¬¦åˆ <span class="hljs-number">9</span>:<span class="hljs-number">16</span> çºµå‘æ¯”ä¾‹ã€‚(æˆ–è€…<span class="hljs-number">16</span>ï¼š<span class="hljs-number">9</span>å¯æ ¹æ®é¡µé¢è‡ªè¡Œé€‰æ‹©)
</code></pre>
<p>å°±å‡ºæ¥äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœäº†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e37a72b404ab470db40f8d13babe7234~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=sUxxfEawZoBB6I%2FAfi8i%2FTgIibg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å—¯ï¼Œä¸é”™ã€‚</p>
<p>è¿˜å¯ä»¥ç»™å¨œç¾ä¹Ÿæ¥ä¸ªï¼Œç¾ä¸ç¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/646d40aa9769409aa78ad87a7ac6cb58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=2u%2BXxaoTb5b53i7sKdCv2CUcLyw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">åŒä¸€ä¸ªäººç‰©åœ¨ä¸åŒå¹´ä»£é£æ ¼</h2>
<p>æ¥ä¸€ä¸ªæˆ‘è®¾è®¡çš„æç¤ºè¯å§ï¼Œç”¨æ¥å±•ç°åŒä¸€ä¸ªäººç‰©åœ¨ä¸åŒå¹´ä»£é£æ ¼ã€‚</p>
<p>æ•ˆæœæ˜¯è¿™æ ·å­çš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c50c6631e23a455e83e5c2f1b1172aa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=mulIBL2Uw6QTxeGEUU2BsGayq5M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå›¾çš„æç¤ºè¯æ˜¯è¿™æ ·å­çš„ï¼š</p>
<pre><code class="hljs">åˆ¶ä½œä¸€ä¸ª4Ã—4çš„ç½‘æ ¼ï¼Œä»19ä¸–çºª80å¹´ä»£å¼€å§‹ã€‚åœ¨æ¯ä¸ªåŒºåŸŸä¸­ï¼Œæˆ‘çš„å½¢è±¡éƒ½åº”è¯¥ç¬¦åˆè¯¥å¹´ä»£çš„é£æ ¼ï¼ˆæœè£…ã€å‘å‹ã€èƒ¡é¡»ã€é…é¥°ï¼‰ã€‚

é¢œè‰²ã€èƒŒæ™¯å’Œç”µå½±é£æ ¼ä¹Ÿè¦ç›¸åº”è¿ç”¨ã€‚

æˆ‘æ˜¯ç‰¹æœ—æ™®
</code></pre>
<p>ä½ åˆ«è¯´ï¼Œ2020å¹´çš„æ‡‚ç‹è¿˜è‡ªåŠ¨ç»™å¸¦äº†ä¸ªå£ç½©ï¼Œæœ‰ç‚¹æ„æ€ã€‚</p>
<p>ç„¶åæˆ‘è§‰å¾—1950sçš„é¢†å¸¦æœ‰äº›ä¸ç¬¦ï¼Œè¦ä¸æ¢ä¸ªï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f9fd0509b9b4f74879343c3206f91de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=WmXDXLbReuUvzFmprL6RQUOxm1A%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŒæ · Lovart é‡Œé¢ Touch ä¸€ä¸‹ï¼Œé¢†å¸¦ç«‹é©¬æ¢äº†ã€‚æˆ‘æ”¾å¤§ä¸€ä¸‹ä½ çœ‹çœ‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90911485cbe24adfb8f2ab913e901b5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=Lri1z%2F36cF63BQlB65iWMsO7h4A%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">ç”µå•†äº§å“ä¿ƒé”€å›¾</h2>
<p>æ¥ç‚¹å®é™…åœ¨ç”µå•†åœºæ™¯ä¸‹æ›´æœ‰ç”¨çš„ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨å…ˆè®© Nano Banana Pro ç”Ÿæˆä¸€ä¸ªå°ç¯äº§å“ã€‚</p>
<blockquote>
<p>â</p>
<p>æç¤ºè¯ï¼šå°ç¯ï¼Œ4k</p>
<p>â</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/137fddea0447407bb09b576beb63ba28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=gli80ZDCc%2Fh44MRJg%2Fx5AQNZntI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åæˆªå›¾ç”µå•†çš„ä¸€å¼ å‚è€ƒå›¾ï¼Œç›´æ¥è®©å®ƒå‚è€ƒå‡ºä¸ªç±»ä¼¼çš„ã€‚</p>
<p>æç¤ºè¯ï¼šæŠŠã€å›¾1ã€‘æŒ‰ç…§ã€å›¾2ã€‘çš„ä»‹ç»ï¼Œç”Ÿæˆäº§å“ä¿ƒé”€å›¾ï¼Œæ–‡å­—éœ€è¦ç¬¦åˆå°ç¯è¿™ä¸ªäº§å“æè¿°ï¼Œä¸­æ–‡æè¿°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69ec6c5980204d56bf89711efb75735c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=x06NuX7dG6T5cZjstJUZvnq1MlA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å°±ç›´æ¥å‡ºæ¥äº†ï¼Œä¸­æ–‡ä¹Ÿå¾ˆå‡†ç¡®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aee5a7c8bb3745d486131c562afa4fc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=9%2FiVaYVwR5dwcC0dVnFovXh9FbE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åç”¨æœ‹å‹é˜¿çœŸçš„ç”µå•†æ‹“å±•å›¾æç¤ºè¯ï¼Œç”Ÿæˆä¸€å¥—å¯å¤ç”¨çš„ç”µå•†å›¾ã€‚</p>
<pre><code class="hljs">åŸºäºæˆ‘ä¸Šä¼ çš„ä¸»å›¾ï¼Œä¸ºè¯¥å•†å“ç”Ÿæˆä¸€å¥—å®Œæ•´ç”µå•†å»¶å±•å›¾ï¼šæ¡Œé¢å¹³é“ºå›¾ã€å¤šä»¶ç»„åˆå›¾ã€ç»†èŠ‚æ”¾å¤§å›¾ã€å°ºå¯¸çº¿ç¨¿å›¾ã€ä½¿ç”¨åœºæ™¯å›¾ã€åŠŸèƒ½äº®ç‚¹å›¾ã€

ä½¿ç”¨å‰åå¯¹æ¯”å›¾ã€å¤šè§’åº¦å±•ç¤ºå›¾ã€æ‹†è§£å›¾ã€åŠ¨æ€ç§‘æŠ€æ„å›¾å›¾ã€æ­é…ç»„åˆå›¾ã€æè´¨å±•ç¤ºå›¾ã€æ¨¡ç‰¹å±•ç¤ºå›¾ã€

2Ã—2ç½‘æ ¼å¸ƒå±€å¤šè§’åº¦å±•ç¤ºå›¾ï¼Œå…¨éƒ¨å•å¼ è¾“å‡ºã€é£æ ¼ç»Ÿä¸€ã€ç”»é¢å¹²å‡€ä¸“ä¸šã€‚æ™ºèƒ½æ¯”ä¾‹ã€‚ä¸­æ–‡æ ‡æ³¨ã€‚
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1694372527d47e180592d5bf7f69785~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=Y%2FMeV8MROanmZLhVnrZ5l%2FHocCg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é™¤æ­¤è¿˜æœ‰è¿™ä¸ªå›¾ä¹Ÿå¾ˆç»™åŠ›ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/401dcb1d9361425ebe4ea44b69671c36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=IDx8DjBEHFYw1E0iUs%2BMVvVZvZM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-3">å„ç§èº«ä»½è§’è‰²çš„EDCå›¾</h2>
<p>åŒæ ·æ˜¯ä¼Ÿå¤§çš„ç¥ä½¬çš„è®¾è®¡ï¼Œæˆ‘ä»¬æ¥è‡ªå·±å–œæ¬¢çš„é£æ ¼çš„EDCå›¾ã€‚</p>
<p>æ¯”å¦‚äºŒæ¬¡å…ƒçˆ±å¥½è€…çš„è¡Œæï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10c4a9808668485a8f7d2deb9725f11d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=GAJZRoXpDbJ4qA4qYm2dyP5tjMM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¾¡å§çš„æ—¥å¸¸è¡Œæï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27a09b261db477f9f9fce425b6c90a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=slvQx6qlC0lo%2FI1FCmPQy%2FIPJac%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç¨‹åºå‘˜çš„æ—¥ç¨‹è¡Œæï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8864e9af086541788df4282e2df0631a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=poZ%2B0oVPTp3ovCx8DQfVvMSr0kU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æƒ³ç”Ÿæˆä»€ä¹ˆæ ·å­çš„å°±ç”¨ç¥ä½¬ï¼ˆBerryxia.AIï¼‰è¿™ä¸ªæç¤ºè¯å°±å¥½ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">[Art Style &amp; Viewpoint]:
Hyper-realisticÂ <span class="hljs-number">8</span>k product photography, macro lens perspective, <span class="hljs-keyword">strict</span>Â <span class="hljs-number">90</span>-degree overhead flat-lay (knolling).
[Aesthetic Philosophy]:Â <span class="hljs-string">"Sublime Micro-Engineering Narratives"</span>. A blend <span class="hljs-keyword">of</span> surgical precision <span class="hljs-built_in">and</span> artistic interpretation <span class="hljs-keyword">of</span> technical components.
[Subject Input]:
Target <span class="hljs-type">Object</span>: [ç”Ÿæˆhackerçš„èƒŒåŒ…ï¼ŒäºŒæ¬¡å…ƒçˆ±å¥½è€…çš„è¡Œæ
[INTELLIGENT SCENE GENERATION WORKFLOW]:
&gt;&gt;&gt; <span class="hljs-keyword">OPTION</span> A: <span class="hljs-keyword">IF</span> Subject <span class="hljs-built_in">is</span> Mechanical / Tech / Masculine (Industrial Precision Mode)
[Action]: Forensic Technical Exploded View. Disassemble <span class="hljs-keyword">into</span>Â <span class="hljs-number">8</span>-<span class="hljs-number">12</span>Â primary components, but <span class="hljs-keyword">with</span> an emphasis <span class="hljs-keyword">on</span> secondary <span class="hljs-built_in">and</span> tertiary <span class="hljs-keyword">sub</span>-components (e.g., individual gears within a gearbox, micro-switches <span class="hljs-keyword">on</span> a circuit board, specific spring types, internal wiring harnesses).
[Detail Emphasis]: <span class="hljs-keyword">Each</span> component <span class="hljs-built_in">is</span> meticulously rendered.
<span class="hljs-symbol">Metals:</span> Highlight brushed grains, polished edges, anodic oxidation sheen, laser-etched serial numbers <span class="hljs-built_in">or</span> specific alloy markings. Show microscopic tolerances between parts.
<span class="hljs-symbol">Plastics:</span> Reveal injection molding marks, precise seam lines, <span class="hljs-built_in">and</span> subtle textural variations.
<span class="hljs-symbol">Circuitry:</span> Emphasize the solder joints, traces, tiny capacitors, <span class="hljs-built_in">and</span> integrated chip details.
Glass/Optics: Render reflections, anti-reflective coatings, <span class="hljs-built_in">and</span> subtle refractions.
[Background]: Premium matte cool-grey workbench surface.
[Interactive Schematics]: Ultra-fine Cyan/Tech-Blue vector lines. Include cross-sectional views,Â exploded <span class="hljs-keyword">assembly</span> sequenceÂ linesÂ (dashed arrows), <span class="hljs-built_in">and</span> material <span class="hljs-keyword">call</span>-outs(e.g.,Â <span class="hljs-string">"Alloy 7075"</span>,Â <span class="hljs-string">"Carbon Fiber Weave"</span>).
[Artistic Title Style]: <span class="hljs-string">"Industrial Stencil"</span> Aesthetic. Large, bold, semi-transparentÂ <span class="hljs-keyword">text</span>(e.g.,Â <span class="hljs-string">"PROJECT: ALPHA"</span>Â <span class="hljs-built_in">or</span>Â <span class="hljs-string">"ENGINE MODEL: X9"</span>)Â laser-etched onto the background surface.
&gt;&gt;&gt; <span class="hljs-keyword">OPTION</span> B: <span class="hljs-keyword">IF</span> Subject <span class="hljs-built_in">is</span> Feminine / Fashion /Â Lifestyle(Luxury Narrative Mode)
[Action]: Curated <span class="hljs-string">"Magic Blind Box"</span> Knolling. Spilled contents are arranged <span class="hljs-keyword">with</span> obsessive attention <span class="hljs-keyword">to</span> detailÂ <span class="hljs-keyword">for</span>Â <span class="hljs-keyword">each</span> item.
[Detail Emphasis]: <span class="hljs-keyword">Each</span> item, whether essential <span class="hljs-built_in">or</span> <span class="hljs-string">"secret,"</span> <span class="hljs-built_in">is</span> presented <span class="hljs-keyword">with</span> luxurious verisimilitude.
<span class="hljs-symbol">Fabrics:</span> Reveal intricate stitching <span class="hljs-keyword">on</span> leather, delicate lace patterns, silk<span class="hljs-comment">'s natural sheen, and fine thread counts.</span>
<span class="hljs-symbol">Cosmetics:</span> Show the micro-pearls <span class="hljs-keyword">in</span> a compact, the smooth texture <span class="hljs-keyword">of</span> a lipstick bullet, the subtle viscosity <span class="hljs-keyword">of</span> a serum.
<span class="hljs-symbol">Jewelry:</span> Highlight facets <span class="hljs-keyword">of</span> gemstones, polished metal reflections, <span class="hljs-built_in">and</span> delicate clasps.
<span class="hljs-string">"Secrets"</span>: Render silicone textures, subtle glow <span class="hljs-keyword">of</span> LED indicators <span class="hljs-keyword">on</span> personal wellness devices, <span class="hljs-built_in">or</span> the elegant folds <span class="hljs-keyword">of</span> intimate garments <span class="hljs-keyword">with</span> tasteful artistry.
[Background]: Iconic TiffanyÂ Blue(Robin-egg blue)Â matte surface.
[Interactive Schematics]: Delicate White <span class="hljs-built_in">or</span> Silver fine lines. Include fashion pattern diagrams, stylistic flowÂ lines(emphasizing elegance), <span class="hljs-built_in">and</span> <span class="hljs-string">"signature"</span>Â curves(e.g., golden ratio spirals)Â across the composition.
[Artistic Title Style]: <span class="hljs-string">"Vogue Editorial"</span> Aesthetic. Elegant, oversized SerifÂ Typography(e.g.,Â <span class="hljs-string">"THE ENSEMBLE"</span>Â <span class="hljs-built_in">or</span>Â <span class="hljs-string">"FEMME FATALE"</span>)Â <span class="hljs-keyword">in</span> shimmering silver foil <span class="hljs-built_in">or</span> embossed white ink <span class="hljs-keyword">on</span> the blue surface.
[Universal Composition]:
Mathematical grid alignment <span class="hljs-keyword">with</span> micro-gapsÂ <span class="hljs-keyword">for</span>Â hyper-precision. All parts are displayed <span class="hljs-keyword">with</span> zero tolerance spacing, creating an illusion <span class="hljs-keyword">of</span> effortless engineering.
[Universal Lighting]:
Micro-detailed, multi-point studio lighting. Emphasize specular highlights <span class="hljs-keyword">on</span> metal, subtle subsurface scattering <span class="hljs-keyword">on</span> plastics, <span class="hljs-built_in">and</span> volumetric <span class="hljs-keyword">shadows</span> that define component depth. Neutral color balance.
[Graphic Elements - The <span class="hljs-string">"Call-out"</span> System]Â (Enhanced):
<span class="hljs-symbol">Style:</span> Ultra-fine HairlineÂ Pointers(Leader Lines).
<span class="hljs-keyword">Text</span> Detail: [Bold Main Label - e.g., <span class="hljs-string">"Cylinder Block"</span>] / [Tiny <span class="hljs-keyword">Sub</span>-Label - e.g., <span class="hljs-string">"Aluminium Alloy 7075, Forged"</span>] / [Micro-Spec - e.g., <span class="hljs-string">"Tolerance +/-0.005mm"</span>]. This creates tiered information.
<span class="hljs-symbol">Font:</span> Swiss-style minimalist sans-serifÂ <span class="hljs-keyword">for</span>Â clarity. <span class="hljs-keyword">Text</span> appears digitally superimposed, razor-sharp.
[Artisan Signature Plaque]Â (Universal):
<span class="hljs-keyword">In</span> the bottom-left corner: A small, highly realistic, rectangular golden metallic plaque.
<span class="hljs-symbol">Text:</span> <span class="hljs-string">"canghe"</span> <span class="hljs-keyword">in</span> natural, elegant handwritten cursive script.
<span class="hljs-symbol">Effect:</span> Deeply engraved/debossed look <span class="hljs-keyword">with</span> complex metallic sheen <span class="hljs-built_in">and</span> subtle light traps, contrasting <span class="hljs-keyword">with</span> the technical precision.
--ar <span class="hljs-number">16</span>:<span class="hljs-number">9</span> --q <span class="hljs-number">2</span> --stylize <span class="hljs-number">450</span> --v <span class="hljs-number">6.1</span> Â 
</code></pre>
<h2 data-id="heading-4">é«˜ç«¯å•†ä¸šæµ·æŠ¥</h2>
<p>è¿™ä¸ªæœ€è¿‘ä¹Ÿè¶…çº§ç«ï¼Œå…ˆæ¥çœ‹çœ‹æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b9ece37eaae4aa1b861f75e48fa2a47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=mBXyUc5PqDZ79fSBX1hjoKlrsj4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªçš„æç¤ºè¯æ˜¯è¿™æ ·å­çš„ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">At</span> the very top center <span class="hljs-keyword">of</span> the composition, floating prominently above the ingredient layers, <span class="hljs-keyword">is</span> a luxurious title label. The text <span class="hljs-keyword">reads</span>Â "çƒ­å¹²é¢ HOT DRY NOODLES"Â rendered <span class="hljs-keyword">in</span> expressive,Â handwritten Chinese brushÂ calligraphyÂ (æ¯›ç¬”å­—)Â style. The lettering possesses a heavy, three<span class="hljs-operator">-</span>dimensional sculpted gold metal texture <span class="hljs-keyword">with</span> a brushed finish, warm golden sheen, <span class="hljs-keyword">and</span> realistic metallic reflections catching the dramatic studio lighting.
Premium Wuhan street food poster featuring deconstructed layers <span class="hljs-keyword">of</span> Hot Dry Noodles floating <span class="hljs-keyword">in</span> vertical stack <span class="hljs-keyword">on</span> pure blackÂ backgroundÂ (#<span class="hljs-number">000000</span>). <span class="hljs-keyword">Distinct</span> layers <span class="hljs-keyword">from</span> top <span class="hljs-keyword">to</span>Â bottomÂ (below the main gold title):
<span class="hljs-number">1.</span> Top layer: A vibrant mix <span class="hljs-keyword">of</span> orange crunchy pickled radishÂ cubesÂ (spicy diced radish)Â <span class="hljs-keyword">and</span> bright green chopped scallions, scattered dynamically. <span class="hljs-number">2.</span> <span class="hljs-keyword">Second</span> layer: Rich, thick brown sesameÂ pasteÂ (Sesame <span class="hljs-operator">&amp;</span> Peanut Sauce)Â floating <span class="hljs-keyword">in</span> mid<span class="hljs-operator">-</span>air, looking creamy, dense, <span class="hljs-keyword">and</span> glossy, <span class="hljs-keyword">with</span> a few drops <span class="hljs-keyword">of</span> dark soy sauce swirling <span class="hljs-keyword">within</span> it. <span class="hljs-number">3.</span> Third layer: Deep red spicy chili oil splashing, <span class="hljs-keyword">with</span> visible chili flakes <span class="hljs-keyword">and</span> floating sesame seeds, creating a sharp color contrast. <span class="hljs-number">4.</span> Fourth layer: Thick yellow alkalineÂ noodlesÂ (oil<span class="hljs-operator">-</span>coated noodles), coiled <span class="hljs-keyword">and</span> suspended, showing a firm, chewy texture <span class="hljs-keyword">and</span> oily sheen. <span class="hljs-number">5.</span> FifthÂ layerÂ (Transition): <span class="hljs-keyword">EMPTY</span> SPACE <span class="hljs-operator">-</span> a larger gap <span class="hljs-keyword">with</span> <span class="hljs-keyword">only</span> subtle rising steam, floating sesame seeds, <span class="hljs-keyword">and</span> tiny oil droplets creating breathing room. <span class="hljs-number">6.</span> Bottom<span class="hljs-operator">/</span><span class="hljs-keyword">Final</span> layer: A complete finished Hot Dry Noodles dish <span class="hljs-keyword">in</span> a classic paper bowl <span class="hljs-keyword">or</span> retro ceramic bowl, viewed <span class="hljs-keyword">from</span> the same <span class="hljs-number">45</span><span class="hljs-operator">-</span>degree angle. The noodles <span class="hljs-keyword">are</span> thoroughly coated <span class="hljs-keyword">in</span> the thick brown sesame sauce, topped generously <span class="hljs-keyword">with</span> the pickled radish <span class="hljs-keyword">and</span> scallions. The texture looks sticky, rich, <span class="hljs-keyword">and</span>Â dryÂ (<span class="hljs-keyword">not</span> soupy), <span class="hljs-keyword">with</span> steam rising.
<span class="hljs-keyword">Each</span> layer separated <span class="hljs-keyword">with</span> gaps revealing textures. Chinese <span class="hljs-keyword">and</span> English bilingual labels <span class="hljs-keyword">with</span> elegant arrows pointing <span class="hljs-keyword">to</span> <span class="hljs-keyword">each</span> component: "é…¸è±†è§’/èåœä¸ Pickled Radish &amp; Beans", "ç§˜åˆ¶èŠéº»é…± Secret Sesame Paste", "çº¢æ²¹è¾£æ¤’ Spicy Chili Oil", "åŠ²é“ç¢±é¢ Alkaline Noodles", "ç»å…¸é£å‘³ Classic Taste", "æˆå“ Finished Dish".
<span class="hljs-keyword">NO</span> white pedestal. <span class="hljs-keyword">All</span> layersÂ <span class="hljs-type">float</span>Â freely <span class="hljs-keyword">in</span> space. Dramatic studio lighting <span class="hljs-keyword">from</span> <span class="hljs-number">45</span><span class="hljs-operator">-</span>degree angle, rim lighting highlighting the gloss <span class="hljs-keyword">of</span> the sesame paste <span class="hljs-keyword">and</span> the texture <span class="hljs-keyword">of</span> noodles. Ultra<span class="hljs-operator">-</span>realistic, <span class="hljs-number">8</span>k resolution, commercial food photography, appetizing, <span class="hljs-number">9</span>:<span class="hljs-number">16</span> vertical format.
</code></pre>
<p>çœŸæœ‰æƒ³åƒçš„æ„Ÿè§‰äº†ï¼Œæ·±å¤œæ”¾æ¯’ï¼Œå“ˆå“ˆå“ˆã€‚</p>
<p>é™¤äº†ç”Ÿæˆçƒ­å¹²é¢ï¼Œè¿˜å¯ä»¥ç”Ÿæˆä»»æ„é£Ÿç‰©ï¼ŒæŠŠä»–ä¸¢ç»™Lovartï¼Œç„¶åç›´æ¥è·Ÿä»–è¯´å°±å¥½äº†ã€‚</p>
<h2 data-id="heading-5">ä¿¡æ¯å›¾</h2>
<p>å¯ä»¥ç”Ÿæˆä»»æ„ä¿¡æ¯å›¾ï¼Œæ¶æ„å›¾ã€ç»“æ„å›¾ç­‰ï¼Œä¹Ÿä¸éœ€è¦å¤ªè¿‡å¤æ‚æç¤ºè¯ï¼Œåœ¨Lovartç›´æ¥è¯´å°±è¡Œï¼ŒAgentä¼šè‡ªè¡Œå¸®ç”Ÿæˆå¥½ã€‚</p>
<p>æ¯”å¦‚è¿™ä¸ªä¿¡æ¯å›¾çš„æç¤ºè¯å°±å¾ˆç®€å•ï¼š</p>
<p>å¸®æˆ‘æŠŠä¸€ä¸‹å†…å®¹ç”Ÿæˆä¿¡æ¯å›¾ï¼Œæˆ‘è¦åˆ†äº«åˆ°Xçš„ï¼Œå°½é‡ç‚«é…·å¥½çœ‹äº›ã€‚â€œä½ çš„å†…å®¹â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d73d2420c62546bbade4c2f7cef8782f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=RTvzr0EwQqWKzrzn80SFfj5IWAo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-6">æ¡æ¼«</h2>
<p>ä¹‹å‰ä¹Ÿç»™å¤§å®¶ä»‹ç»è¿‡æ¡æ¼«çš„ç©æ³•ï¼Œå¯¹äºä¸€äº›å°ç»†èŠ‚è¿˜æ˜¯éœ€è¦å±€éƒ¨ä¿®æ”¹ï¼Œç°åœ¨æœ‰ Lovart çš„ Touch edit å¯ä»¥å±€éƒ¨ä¿®æ”¹å°±æ–¹ä¾¿å¤šäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed9efd3309ae46368a509c7aec34b394~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765810418&amp;x-signature=3WgLQW1IwJow2hgGPmfJh7yj2Jg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…¶ä»–çš„å¤§å®¶ä¹Ÿå¯ä»¥å¤šå»å°è¯•ä¸€ä¸‹ã€‚</p>
<p>ç„¶åå…¶ä»–æ›´å¤šçš„æç¤ºè¯å’Œä¾‹å­ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ç›´æ¥å»æç¤ºè¯æ¡ˆä¾‹åº“é‡Œé¢çœ‹ï¼Œæˆ‘å¼€äº†ç¼–è¾‘æƒé™ï¼Œå¯ç›´æ¥å¤åˆ¶ä»¥åŠæ–°å¢ä½ å¥½ç©çš„caseã€‚</p>
<p>Nano Banana Pro çš„ç”Ÿå›¾ä¸€è‡´æ€§å’Œå®¡ç¾è®¾è®¡èƒ½åŠ›éƒ½éå¸¸åœ¨çº¿ï¼Œè€Œä¸”å‡ ä¹ä¸ç”¨æŠ½å¡ã€‚</p>
<p>é…åˆ Lovart ï¼Œåˆ©ç”¨ Agent å’Œ Touch edit å±€éƒ¨ä¿®æ”¹ç»†èŠ‚ï¼Œç²¾å‡†æ§åˆ¶ï¼Œå¯ç©çš„å¤ªå¤šäº†ï¼Œ</p>
<p>é¡ºå¸¦å¤šè¯´ä¸€å˜´ï¼Œæœ€è¿‘ Lovart æ­£åœ¨åšæ´»åŠ¨ï¼Œ11æœˆ21å·åˆ°11æœˆ30å·è®¢é˜… Basic+ å¯äº« 365 å¤© Nano Banana Pro æ— é™é‡ä½¿ç”¨ï¼Œè€ä¼šå‘˜ä¹Ÿä¼šè‡ªåŠ¨è·å¾—ã€‚è®¢é˜…Basic+ é™¤äº† Nano Banana Pro ï¼ŒNano Banana 1ã€Seedream 4ã€Midjourney V7 ä¹Ÿæ˜¯ä¸€èµ·çš„ä¸€å¹´ 0 ç§¯åˆ†ã€‚</p>
<p>æ„Ÿå…´è¶£å¯ä»¥å»çœ‹çœ‹ï¼Œé“¾æ¥åœ¨è¿™é‡Œ ğŸ‘‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Flovart.ai" target="_blank" title="https://lovart.ai" ref="nofollow noopener noreferrer">lovart.ai</a></p>
<p>å¥½å•¦ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œè¿˜æ²¡è·å¾—Nano Banana Pro æç¤ºè¯æ¡ˆä¾‹åº“çš„å¯ä»¥è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç§å‘ä½ ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeWords:è®©è‹±è¯­å­¦ä¹ æ›´é«˜æ•ˆçš„æ‰“å­—ç»ƒä¹ ç¥å™¨]]></title>    <link>https://juejin.cn/post/7581406561685176366</link>    <guid>https://juejin.cn/post/7581406561685176366</guid>    <pubDate>2025-12-08T13:11:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581406561685176366" data-draft-id="7581324171398332462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeWords:è®©è‹±è¯­å­¦ä¹ æ›´é«˜æ•ˆçš„æ‰“å­—ç»ƒä¹ ç¥å™¨"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2025-12-08T13:11:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeWords:è®©è‹±è¯­å­¦ä¹ æ›´é«˜æ•ˆçš„æ‰“å­—ç»ƒä¹ ç¥å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T13:11:48.000Z" title="Mon Dec 08 2025 13:11:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸å·¥ä½œå’Œç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ç”¨åˆ°è‹±æ–‡ï¼Œå°¤å…¶æ˜¯åœ¨æŸ¥é˜…æŠ€æœ¯æ–‡æ¡£ç­‰åœºåˆã€‚å°½ç®¡ç›®å‰ç¿»è¯‘å·¥å…·ç›¸å½“ä¾¿æ·ï¼Œä½†å¦‚æœèƒ½å¤Ÿè‡ªå·±æµç•…é˜…è¯»ï¼Œæ•ˆç‡ä¼šå¤§å¤§æé«˜ã€‚ç„¶è€Œï¼Œæƒ³è¦å­¦å¥½ã€è¯´å¥½è‹±è¯­é€šå¸¸å¹¶ä¸å®¹æ˜“ï¼Œå¾€å¾€éœ€è¦æŠ•å…¥å¤§é‡çš„æ—¶é—´å’Œé‡‘é’±å»æŠ¥ç­å­¦ä¹ ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ›´åŠ è½»æ¾æœ‰æ•ˆçš„æ–¹æ³•æ¥æå‡è‹±è¯­é˜…è¯»èƒ½åŠ›å‘¢ï¼Ÿ</p>
<p>åœ¨è‹±è¯­å­¦ä¹ è¿‡ç¨‹ä¸­ï¼ŒèƒŒå•è¯å¸¸å¸¸æˆä¸ºä»¤äººæœ›è€Œå´æ­¥çš„ä¸€å…³ã€‚ä¼ ç»Ÿçš„è®°å¿†æ–¹å¼å®¹æ˜“æ˜¾å¾—æ¯ç‡¥ï¼Œæ•ˆæœä¹Ÿæœªå¿…ç†æƒ³ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å‘å¤§å®¶æ¨èä¸€æ¬¾æ‰“ç ´å¸¸è§„çš„å¼€æºå­¦ä¹ å·¥å…·â€”â€”TypeWordsã€‚å®ƒå·§å¦™åœ°å°†æ‰“å­—ç»ƒä¹ ä¸è‹±è¯­å­¦ä¹ èä¸ºä¸€ä½“ï¼Œè®©ä½ åœ¨æ•²å‡»é”®ç›˜çš„è¿‡ç¨‹ä¸­ï¼Œä¸çŸ¥ä¸è§‰åœ°æå‡è‹±è¯­æ°´å¹³ã€‚</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Fchevereto.xiuji.mynatapp.cc%2Fimage%2FHHVX" target="_blank" title="http://chevereto.xiuji.mynatapp.cc/image/HHVX" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d08036a6fe84815a65a23445f62d72b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804308&amp;x-signature=ZolqEqK0LOlE%2B3CKqUoLjQsKhPQ%3D" alt="favicon.md.png" loading="lazy"/></a></p>
<p>favicon.md.png</p>
<h2 data-id="heading-0">é¡¹ç›®ç®€ä»‹</h2>
<p>TypeWords æ˜¯ä¸€ä¸ªåŸºäº Vue å¼€å‘çš„ç°ä»£åŒ–è‹±è¯­å­¦ä¹ å·¥å…·ï¼Œå®ƒé€šè¿‡<strong>æ‰“å­—è¾“å…¥</strong>çš„æ–¹å¼å¸®åŠ©ä½ è®°å¿†å•è¯å’ŒèƒŒè¯µæ–‡ç« ã€‚é¡¹ç›®çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼šâ€œå­¦ä¹ è‹±è¯­ï¼Œä¸€æ¬¡æ•²å‡»ï¼Œä¸€ç‚¹è¿›æ­¥ï¼›è®°å¿†ä¸å†ç›²ç›®ï¼Œå­¦ä¹ æ›´é«˜æ•ˆâ€ã€‚</p>
<p>è¯¥é¡¹ç›®å†github ä¸Šå·²æœ‰ 5.9k star</p>
<p>githubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzyronon%2FTypeWords" target="_blank" title="https://github.com/zyronon/TypeWords" ref="nofollow noopener noreferrer">github.com/zyronon/Typâ€¦</a></p>
<p>åœ¨çº¿ä½¿ç”¨åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftypewords.cc%2F" target="_blank" title="https://typewords.cc/" ref="nofollow noopener noreferrer">typewords.cc/</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f81506f50cf44d7aeafc6835a783c1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804308&amp;x-signature=xJNVU5%2BCvpXdH2efYIKBu92IiHk%3D" alt="_20251208_070501.png" loading="lazy"/></p>
<p>_20251208_070501.png</p>
<h2 data-id="heading-1">ä¸»è¦ç‰¹è‰²åŠŸèƒ½</h2>
<h3 data-id="heading-2">ğŸ¯ æ™ºèƒ½å•è¯ç»ƒä¹ </h3>
<ul>
<li>
<p><strong>å››ç§å­¦ä¹ æ¨¡å¼</strong>ï¼š</p>
<ul>
<li>è·Ÿæ‰“æ¨¡å¼ï¼šçœ‹ç€å•è¯å’Œé‡Šä¹‰æ‰“å­—</li>
<li>è¾¨è®¤æ¨¡å¼ï¼šæ ¹æ®é‡Šä¹‰æ‰“å‡ºæ­£ç¡®å•è¯</li>
<li>å¤ä¹ æ¨¡å¼ï¼šå·©å›ºè®°å¿†</li>
<li>é»˜å†™æ¨¡å¼ï¼šæŒ‘æˆ˜è‡ªæˆ‘è®°å¿†</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½è®°å¿†æ›²çº¿</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨è®¡ç®—æœ€ä½³å¤ä¹ æ—¶é—´</p>
</li>
<li>
<p><strong>ä¸°å¯Œèµ„æº</strong>ï¼šæ¯ä¸ªå•è¯éƒ½é…æœ‰éŸ³æ ‡ã€ç¾è‹±å‘éŸ³ã€ä¾‹å¥ã€çŸ­è¯­ã€è¿‘ä¹‰è¯ã€è¯æºç­‰</p>
</li>
</ul>
<h3 data-id="heading-3">ğŸ“š é«˜æ•ˆæ–‡ç« èƒŒè¯µ</h3>
<ul>
<li><strong>å†…ç½®ç»å…¸æ•™æ</strong>ï¼šåŒ…å«å¤šç§è‹±è¯­å­¦ä¹ ææ–™</li>
<li><strong>è‡ªå®šä¹‰å¯¼å…¥</strong>ï¼šæ”¯æŒæ·»åŠ ä¸ªäººæ–‡ç« </li>
<li><strong>æ™ºèƒ½è¾…åŠ©</strong>ï¼šä¸€é”®ç¿»è¯‘ã€è¯‘æ–‡å¯¹ç…§ã€é€å¥è¾“å…¥ã€è‡ªåŠ¨å‘éŸ³</li>
<li><strong>å¬åŠ›å¼ºåŒ–</strong>ï¼šæ”¯æŒè¾¹å¬è¾¹é»˜å†™</li>
</ul>
<h3 data-id="heading-4">ğŸ“Š å­¦ä¹ ç®¡ç†</h3>
<ul>
<li><strong>é”™è¯æœ¬</strong>ï¼šè‡ªåŠ¨è®°å½•è¾“å…¥é”™è¯¯çš„å•è¯</li>
<li><strong>æ”¶è—å¤¹</strong>ï¼šä¸»åŠ¨æ”¶è—é‡ç‚¹å•è¯</li>
<li><strong>å·²æŒæ¡</strong>ï¼šæ ‡è®°å·²å­¦ä¼šçš„å•è¯</li>
</ul>
<h2 data-id="heading-5">ğŸ“¦ å®‰è£…ä¸éƒ¨ç½²</h2>
<p>TypeWords ä½œä¸ºä¸€æ¬¾ Web åº”ç”¨ï¼Œéƒ¨ç½²å’Œä½¿ç”¨éƒ½éå¸¸ç®€å•ã€‚</p>
<h3 data-id="heading-6">æ–¹æ³•ä¸€ï¼šç›´æ¥è®¿é—®åœ¨çº¿ç‰ˆæœ¬</h3>
<p>æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥è®¿é—®é¡¹ç›®çš„åœ¨çº¿ä½¿ç”¨åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftypewords.cc%2F" target="_blank" title="https://typewords.cc/" ref="nofollow noopener noreferrer">typewords.cc/</a></p>
<h3 data-id="heading-7">æ–¹æ³•äºŒï¼šæœ¬åœ°å¯åŠ¨</h3>
<p>æ­¤é¡¹ç›®å¯å•ç‹¬è¿è¡Œï¼Œæ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œæ¢è®¾å¤‡éœ€æ‰‹åŠ¨å¤‡ä»½æ•°æ®ï¼Œä¸å½±å“æ­£å¸¸ä½¿ç”¨ï¼› æ­¤é¡¹ç›®æ˜¯åŸºäºVueå¼€å‘çš„ï¼Œéœ€è¦ node ç¯å¢ƒæ¥è¿è¡Œã€‚ æˆ‘ä½¿ç”¨nodeç‰ˆæœ¬æ˜¯<code>v22.12.0</code></p>
<p>ä»githubä¸‹è½½æ­¤é¡¹ç›®æºç ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œ<code>npm install</code>æ¥ä¸‹è½½ä¾èµ–ã€‚ æ‰§è¡Œ<code>npm run dev</code>æ¥å¯åŠ¨é¡¹ç›®ï¼Œé¡¹ç›®é»˜è®¤åœ°å€ä¸º<code>http://localhost:3000</code> åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<code>http://localhost:3000</code> æ¥è®¿é—®é¡¹ç›®ã€‚ æ‰§è¡Œ<code>npm run build</code>æ‰“åŒ…é¡¹ç›®æ–‡ä»¶</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8280a15d6884acebb3f8ada0e37b0df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804308&amp;x-signature=75jCRkTj%2FsqKiRa84wOwO%2FzraRE%3D" alt="_20251208_162522.png" loading="lazy"/></p>
<p>_20251208_162522.png</p>
<h3 data-id="heading-8">æ–¹æ³•ä¸‰ï¼šDockeréƒ¨ç½²</h3>
<ul>
<li>æ‰“åŒ…æœåŠ¡</li>
</ul>
<p>ä¸‹è½½é¡¹ç›®ä¹‹åä½¿ç”¨<code>npm run build</code> æ‰“åŒ…é¡¹ç›®</p>
<ul>
<li>æ„å»ºé•œåƒ</li>
</ul>
<p>åˆ›å»º<code>Dockerfile</code>æ–‡ä»¶,å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨å®˜æ–¹ nginx 1.21.5 é•œåƒä½œä¸ºåŸºç¡€é•œåƒ</span>
FROM nginx:1.21.5
<span class="hljs-comment"># è®¾ç½®ç»´æŠ¤è€…ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰</span>
LABEL maintainer=<span class="hljs-string">"xj"</span>
<span class="hljs-comment"># è®¾ç½®å·¥ä½œç›®å½•</span>
WORKDIR /usr/share/nginx/html

<span class="hljs-comment"># å¤åˆ¶å‰ç«¯æ„å»ºæ–‡ä»¶åˆ°nginxç›®å½•</span>
COPY ./dist/ ./

<span class="hljs-comment"># è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™</span>
RUN  <span class="hljs-built_in">chmod</span> -R 755 /usr/share/nginx/html


<span class="hljs-comment"># æš´éœ²ç«¯å£</span>
EXPOSE 80

<span class="hljs-comment"># nginxå®¹å™¨é»˜è®¤å¯åŠ¨nginxï¼Œä¿æŒå‰å°è¿è¡Œ</span>
CMD [<span class="hljs-string">"nginx"</span>, <span class="hljs-string">"-g"</span>, <span class="hljs-string">"daemon off;"</span>]
</code></pre>
<p>å°†æ„å»ºä¹‹åçš„<code>dist</code>æ–‡ä»¶å¤¹å¤åˆ¶åˆ°åŒçº§ç›®å½•ä¸‹,ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»ºé•œåƒ</p>
<pre><code class="hljs language-bash" lang="bash">docker build -t xj/typewords:v2.0 .
</code></pre>
<ul>
<li>docker-composeéƒ¨ç½²</li>
</ul>
<p>åˆ›å»ºéƒ¨ç½²ç›®å½•<code>typewords</code>,åœ¨æ­¤ç›®å½•ä¸‹æ„å»ºdocker-compose.ymlæ–‡ä»¶</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">typewords:</span>
    <span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨åšä¸»æ„å»ºçš„é•œåƒ registry.cn-hangzhou.aliyuncs.com/xj_lew/typewords:v2.0</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">xj/typewords:v2.0</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">typewords</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>
    <span class="hljs-attr">logging:</span>
      <span class="hljs-attr">driver:</span> <span class="hljs-string">'json-file'</span>
      <span class="hljs-attr">options:</span>
        <span class="hljs-attr">max-size:</span> <span class="hljs-string">'5g'</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NGINX_PORT=80</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-number">8090</span><span class="hljs-string">:80</span>
</code></pre>
<p>åœ¨æ­¤ç›®å½•ä¸‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡</p>
<pre><code class="hljs">docker-compose up -d 
</code></pre>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬æœåŠ¡å°±éƒ¨ç½²å®Œäº†</p>
<h2 data-id="heading-9">ä½¿ç”¨</h2>
<p>éƒ¨ç½²å®Œä¹‹ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æœåŠ¡ï¼Œé€‰æ‹©æˆ‘ä»¬éœ€è¦å­¦ä¹ çš„å•è¯æˆ–è€…æ–‡ç« å°±å¯ä»¥å¼€å§‹å­¦ä¹ äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/634004d769ad4b4985596d9480bb5aea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804308&amp;x-signature=Uit4ODR2gTluI4zyzfAANdlT7KE%3D" alt="_20251208_162423.png" loading="lazy"/></p>
<p>_20251208_162423.png</p>
<h3 data-id="heading-10">ç¼ºç‚¹</h3>
<ul>
<li>æ•°æ®åœ¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œå¤šç«¯æ•°æ®ä¸åŒæ­¥</li>
<li>å†…ç½®è¯å…¸é€‰æ‹©æœ‰é™</li>
</ul>
<h2 data-id="heading-11">ç»“è¯­</h2>
<p>TypeWords ä¸ä»…ä»…æ˜¯ä¸€ä¸ªèƒŒå•è¯å·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…¨æ–°çš„è‹±è¯­å­¦ä¹ ä½“éªŒã€‚å®ƒå°†æ¯ç‡¥çš„è®°å¿†è¿‡ç¨‹è½¬åŒ–ä¸ºæœ‰è¶£çš„äº’åŠ¨ç»ƒä¹ ï¼Œè®©å­¦ä¹ è‹±è¯­å˜å¾—æ›´åŠ è½»æ¾é«˜æ•ˆã€‚</p>
<p>æ— è®ºä½ æ˜¯è‹±è¯­å­¦ä¹ è€…ï¼Œè¿˜æ˜¯å¯¹å¼€æºé¡¹ç›®æ„Ÿå…´è¶£çš„å¼€å‘è€…ï¼ŒTypeWords éƒ½å€¼å¾—ä½ å°è¯•å’Œå…³æ³¨ã€‚ç°åœ¨å°±è®¿é—® typewords.cc å¼€å§‹ä½ çš„é«˜æ•ˆè‹±è¯­å­¦ä¹ ä¹‹æ—…å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Virtual World 04ã€‘æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ— é™å®‡å®™ï¼ï¼]]></title>    <link>https://juejin.cn/post/7581210455827759140</link>    <guid>https://juejin.cn/post/7581210455827759140</guid>    <pubDate>2025-12-08T13:22:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581210455827759140" data-draft-id="7577914902431268910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Virtual World  04ã€‘æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ— é™å®‡å®™ï¼ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-08T13:22:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ€ªv"/> <meta itemprop="url" content="https://juejin.cn/user/4391901700043284"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Virtual World  04ã€‘æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ— é™å®‡å®™ï¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4391901700043284/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ€ªv
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T13:22:09.000Z" title="Mon Dec 08 2025 13:22:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯<strong>çº¯å‰ç«¯æ‰‹æ“è™šæ‹Ÿä¸–ç•Œ</strong>ç¬¬å››ç¯‡ã€‚</p>
<p>å‰ç«¯ä½¬ä»¬ï¼Œå‰ä¸‰ç¯‡çš„åŸºç¡€æ‰“å¥½ï¼ŒåŸºæœ¬åˆ›å»ºä¸€ä¸ªå•ä½“çš„åº”ç”¨æ²¡å•¥é—®é¢˜äº†ã€‚ä½†å‰ç«¯ä½¬è‚¯å®šå‘ç°ä¸€ä¸ªå¾ˆå°´å°¬çš„é—®é¢˜!</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbf44cf051754ed997114b41a5817644~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=%2Bqr4wyetPaIm%2BhteO659ayWLL2k%3D" alt="93B1A00879A9B67271080936B8A2D89CE1D69417_size242_w423_h220.gif" loading="lazy"/></p>
<p>é‚£å°±æ˜¯æˆ‘ä»¬çš„ Canvas åªæœ‰ 600x600ã€‚</p>
<p>å¦‚æœä½ æƒ³ç›´æ¥æä¸€å¹…ã€Šæ¸…æ˜ä¸Šæ²³å›¾ã€‹ï¼Œé‚£ç”»ç€ç”»ç€ï¼Œå°±ä¼šå‘ç°â€”â€”<strong>æ²¡åœ°å„¿äº†</strong>ã€‚</p>
<h2 data-id="heading-0">ç«‹Flag</h2>
<p>æŒ‰ç…§æœ€ç®€å•çš„æ–¹æ³•ï¼ŒæŠŠcanvasåŠ å¤§ï¼ŒæŠŠå±å¹•åŠ å¤§ï¼Œè¿™æ ·å°±ä¸åª600x600äº†ã€‚</p>
<p>But!!!!</p>
<p>è£…Xè£…åˆ°å¤´,æŠ æŠ æœæœåŠ é‚£ç‚¹èµ„æºï¼Œè¿˜æ˜¯ä¸å¤Ÿç”¨ã€‚æ—¢ç„¶æ˜¯è™šæ‹Ÿä¸–ç•Œï¼Œæˆ‘ä»¬çš„ç›®å‰ï¼Œå°±åº”è¯¥æ— é™å®‡å®™ï¼</p>
<p>è¿™ç¯‡ï¼Œå°±æ˜¯è¦æŠŠæƒ³æ³•å˜æˆç°å®ï¼Œä¸€ä¸ªé€šå‘æ— é™ä¸–ç•Œçš„â€œçª—å£â€ï¼Œå®ç°ä¸€ä¸ª<strong>è™šæ‹Ÿæ‘„åƒæœºï¼ˆVirtual Cameraï¼‰</strong> ã€‚ä½ çœ‹åˆ°çš„åªæ˜¯æ‘„åƒæœºæ‹åˆ°çš„ç”»é¢ï¼Œè€Œä¸–ç•Œæœ¬èº«ï¼Œä½ çš„æ¢¦æƒ³æœ‰å¤šå¤§ï¼Œé‚£ä¹ˆå°±æœ‰å¤šå¤§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a49cca0e7b564cb281faaa3c0fdcf0c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=xdE884%2BrsSsB9OkRz0dFYPl1%2BvY%3D" alt="timg (1).gif" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">æˆ˜ç•¥æ€è€ƒ</h2>
<p>ä¸Šäº†<code>class</code>çš„è´¼èˆ¹ï¼Œé¦–å…ˆæƒ³æ³•å°±æ˜¯æŠ½è±¡ä¸€ä¸ªç±»ï¼Œæ¥ç®¡ç†è¿™ä¸ªã€‚<strong><code>Viewport</code>ï¼ˆè§†å£ï¼‰</strong> ï¼Œä¸“é—¨å¤„ç†è¿™äº›äº‹æƒ…ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒåŠŸèƒ½åªæœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li><strong>åæ ‡è½¬æ¢</strong>ï¼šææ¸…æ¥šâ€œé¼ æ ‡ç‚¹åœ¨å±å¹•ä¸Šçš„ (100,100)â€åˆ°åº•å¯¹åº”â€œè™šæ‹Ÿä¸–ç•Œé‡Œçš„å“ªä¸€ä¸ªåæ ‡â€ã€‚</li>
<li><strong>å¹³ç§»äº¤äº’ï¼ˆPanï¼‰</strong> ï¼šæŒ‰ä½ <strong>ç©ºæ ¼é”®</strong> + <strong>é¼ æ ‡å·¦é”®æ‹–æ‹½</strong>ï¼Œç§»åŠ¨æ‘„åƒæœºï¼Œæµè§ˆä¸–ç•Œçš„å…¶ä»–è§’è½ã€‚</li>
</ol>
<p>å—¯ï¼Œå¤Ÿé€¼æ ¼äº†ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/005f50687bbc4db19e6a4a00a958d4be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=S4L5c3mCtL%2BweXT%2FRqH88NjDdXk%3D" alt="timg (25).gif" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">åŸºç¡€åŸç†</h2>
<p>è¦ä¸ªæ— é™ç©ºé—´å…¶å®æ˜¯ä¸€ä¸ªè§†è§‰å°æŠŠæˆï¼Œé¦–å…ˆæˆ‘ä»¬å¾—ç¡®è®¤æµè§ˆå™¨æ˜¯ä¸ä¼šå…è®¸ä½ åˆ›å»ºä¸€ä¸ª width: 99999999px çš„ Canvas çš„ï¼Œè¿™æ ·æµè§ˆå™¨çš„å†…å­˜ä¼šç›´æ¥å—å±ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ç§»åŠ¨é¼ æ ‡ä½ç½®æ˜¯å›ºå®šä¸å˜çš„ï¼Œå¤§è‡´ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf384cb275334ac98641600718908118~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=zcEdd2%2BV1fkqrjVSh4SndGNbpmk%3D" alt="image.png" loading="lazy"/></p>
<p>è™šæ‹Ÿå±‚å°±æ˜¯åœ¨æ•°å­¦å±‚é¢ä¸Šçš„æ¨¡æ‹Ÿå±‚ï¼Œæ‰€æœ‰çš„ç§»åŠ¨ï¼Œæ·»åŠ éƒ½æ˜¯æ”¾åˆ°è™šæ‹Ÿå±‚ä¸Šã€‚</p>
<p>æˆ‘ä»¬è„‘å­é‡Œå§‹ç»ˆè¦è®°å¾—ä¸¤å¥—åæ ‡ç³»ï¼š</p>
<ul>
<li>
<p><strong>å±å¹•åæ ‡ç³» (Screen Space)</strong> ï¼š</p>
<ul>
<li>è¿™æ˜¯<strong>ç‰©ç†ç°å®</strong>ã€‚</li>
<li>åŸç‚¹ <code>(0,0)</code> æ°¸è¿œåœ¨ Canvas çš„å·¦ä¸Šè§’ã€‚</li>
<li>èŒƒå›´æœ‰é™ï¼Œæ¯”å¦‚ <code>600x600</code>ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼šæ¥æ”¶é¼ æ ‡äº‹ä»¶ (<code>evt.offsetX</code>, <code>evt.offsetY</code>)ï¼Œæœ€ç»ˆæ¸²æŸ“å›¾åƒã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸–ç•Œåæ ‡ç³» (World Space)</strong> ï¼š</p>
<ul>
<li>è¿™æ˜¯<strong>è™šæ‹Ÿæ•°æ®</strong>ã€‚</li>
<li>åŸç‚¹ <code>(0,0)</code> æ˜¯ä¸–ç•Œçš„ä¸­å¿ƒã€‚</li>
<li>èŒƒå›´æ— é™ï¼Œä½ çš„ç‚¹å¯ä»¥æ˜¯ <code>(-5000, 99999)</code>ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼šå­˜å‚¨ <code>Point</code> å’Œ <code>Segment</code> çš„çœŸå®ä½ç½®ã€‚</li>
</ul>
</li>
</ul>
<p>è§†å£å˜æ¢çš„åŸç†ï¼Œå¹¶ä¸æ˜¯çœŸçš„æŠŠ Canvas çš„ DOM å…ƒç´ æ‹–èµ°äº†ï¼Œè€Œæ˜¯æˆ‘ä»¬åœ¨<strong>ç»˜åˆ¶ä¹‹å‰</strong>ï¼Œå¯¹æ‰€æœ‰çš„åæ ‡åšäº†ä¸€æ¬¡æ•°å­¦åç§»ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ æ‹¿ç€ä¸€ä¸ªç›¸æœºï¼ˆè§†å£ï¼‰åœ¨æ‹é£æ™¯ï¼Œå¦‚æœä½ æƒ³çœ‹<strong>å³è¾¹</strong>çš„æ ‘ï¼Œä½ éœ€è¦æŠŠç›¸æœºå‘<strong>å³</strong>ç§»ï¼Œä½†åœ¨ç›¸æœºå–æ™¯æ¡†é‡Œï¼Œé‚£æ£µæ ‘çœ‹èµ·æ¥æ˜¯å‘<strong>å·¦</strong>ç§»äº†ã€‚</p>
<p>å—¯ï¼Œå¤§æ¦‚å°±æ˜¯è¿™æ ·äº†ã€‚</p>
<hr/>
<h2 data-id="heading-3">ä¸Šä»£ç </h2>
<p>å¬ä¸æ‡‚ï¼Ÿï¼Ÿç›´æ¥ä¸Šä»£ç ï¼ï¼ï¼ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b4cf224f65f4e91abf45116ea5d3b2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=QzTsg5Sd33LopXV6wOrPN5LeTDY%3D" alt="0.gif" loading="lazy"/></p>
<h3 data-id="heading-4">è§†å£æ§åˆ¶å™¨ï¼š<code>Viewport</code></h3>
<p>åœ¨ <code>src</code> ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ <code>view</code>ï¼Œç„¶ååˆ›å»º <code>viewport.js</code>ã€‚</p>
<p>è¿™ç©æ„çš„æ•°å­¦åŸç†å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„å‡æ³•ï¼š</p>
<blockquote>
<p><strong>ä¸–ç•Œåæ ‡ = å±å¹•åæ ‡ - è§†å£ä¸­å¿ƒåç§»é‡</strong></p>
</blockquote>
<p>å¦‚æœæˆ‘æŠŠè§†å£å¾€å³ç§» 100pxï¼Œé‚£åŸæœ¬çš„ä¸–ç•ŒåŸç‚¹ (0,0) ç°åœ¨å°±åœ¨å±å¹•çš„ (100,0) ä½ç½®ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// src/view/viewport.js</span>
<span class="hljs-keyword">import</span> Point2D from <span class="hljs-string">"../primitives/point2D.js"</span>;

export default <span class="hljs-keyword">class</span> <span class="hljs-title class_">Viewport</span> {
  <span class="hljs-keyword">constructor</span>(canvas) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);

    <span class="hljs-comment">// è§†å£çš„åˆå§‹ç¼©æ”¾çº§åˆ«ï¼ˆä¸ºä¸‹ä¸€ç¯‡åšé“ºå«ï¼‰</span>
    <span class="hljs-keyword">this</span>.zoom = <span class="hljs-number">1</span>;
    <span class="hljs-comment">// è§†å£çš„ä¸­å¿ƒåç§»é‡ï¼ˆç›¸å½“äºæ‘„åƒæœºçš„ä½ç½®ï¼‰</span>
    <span class="hljs-comment">// é»˜è®¤è®© (0,0) åœ¨ç”»å¸ƒä¸­å¿ƒï¼Œè¿™æ ·æ›´ç¬¦åˆæ•°å­¦ç›´è§‰</span>
    <span class="hljs-keyword">this</span>.center = new Point2D(canvas.width / <span class="hljs-number">2</span>, canvas.height / <span class="hljs-number">2</span>);
    <span class="hljs-comment">// å¦ä¸€ç§æ›´é€šç”¨çš„åšæ³•æ˜¯è®°å½• offsetï¼Œä¹Ÿå°±æ˜¯ panning çš„è·ç¦»</span>
    <span class="hljs-keyword">this</span>.offset = new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);

    <span class="hljs-comment">// æ‹–æ‹½çŠ¶æ€ç®¡ç†</span>
    <span class="hljs-keyword">this</span>.drag = {
      start: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-comment">// é¼ æ ‡æŒ‰ä¸‹çš„èµ·å§‹ç‚¹</span>
      end: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),   <span class="hljs-comment">// é¼ æ ‡å½“å‰çš„ç»“æŸç‚¹</span>
      offset: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),<span class="hljs-comment">// è¿™ä¸€ç¬é—´æ‹–äº†å¤šè¿œ</span>
      active: <span class="hljs-literal">false</span>             <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨æ‹–æ‹½</span>
    };

    <span class="hljs-keyword">this</span>.#addEventListeners();
  }

  <span class="hljs-comment">// æ ¸å¿ƒæ•°å­¦é¢˜ï¼šå±å¹•åæ ‡ -&gt; ä¸–ç•Œåæ ‡</span>
  getMouse(evt) {
    <span class="hljs-comment">// ç°åœ¨çš„è®¡ç®—é€»è¾‘ï¼š(é¼ æ ‡ä½ç½® - ä¸­å¿ƒç‚¹) * ç¼©æ”¾ç³»æ•° - åç§»é‡</span>
    <span class="hljs-comment">// æš‚æ—¶å…ˆä¸åŠ ç¼©æ”¾ï¼Œåªå¤„ç†å¹³ç§»</span>
    <span class="hljs-keyword">return</span> new Point2D(
      (evt.offsetX - <span class="hljs-keyword">this</span>.center.x) - <span class="hljs-keyword">this</span>.offset.x,
      (evt.offsetY - <span class="hljs-keyword">this</span>.center.y) - <span class="hljs-keyword">this</span>.offset.y
    );
  }

  <span class="hljs-comment">// è·å–å½“å‰çš„åç§»é‡ï¼Œç»™ Canvas ç”¨</span>
  getOffset() {
     <span class="hljs-keyword">return</span> new Point2D(
         <span class="hljs-keyword">this</span>.center.x + <span class="hljs-keyword">this</span>.offset.x, 
         <span class="hljs-keyword">this</span>.center.y + <span class="hljs-keyword">this</span>.offset.y
     );
  }

  #addEventListeners() {
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousedown"</span>, (evt) =&gt; {
      <span class="hljs-comment">// åªæœ‰æŒ‰ä½ç©ºæ ¼(Space)ä¸”ç‚¹å‡»å·¦é”®(0)æ—¶ï¼Œæ‰è§¦å‘å¹³ç§»</span>
      <span class="hljs-comment">// è¿™é‡Œçš„ evt.button == 0 æ˜¯å·¦é”®</span>
      <span class="hljs-comment">// è¿™é‡Œçš„ evt.ctrlKey / shiftKey ç­‰ä¹Ÿå¯ä»¥åˆ¤æ–­ï¼Œä½†æˆ‘ä»¬è¦åˆ¤æ–­ç©ºæ ¼é”®çŠ¶æ€</span>
      <span class="hljs-comment">// ç”±äº mousedown é‡Œæ‹¿ä¸åˆ°é”®ç›˜æŒç»­çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¤–éƒ¨å˜é‡æˆ–è€…åœ¨ window ä¸Šç›‘å¬é”®ç›˜</span>
      <span class="hljs-comment">// ç®€å•çš„åšæ³•ï¼šæ£€æŸ¥ evt é‡Œæ˜¯å¦åŒ…å«æŒ‰é”®ä¿¡æ¯ï¼Ÿä¸åŒ…å«ã€‚</span>
      <span class="hljs-comment">// æ‰€ä»¥æˆ‘ä»¬é€šå¸¸å•ç‹¬å­˜ä¸€ä¸ªé”®ç›˜çŠ¶æ€ï¼Œæˆ–è€…ç›´æ¥åˆ©ç”¨ "wheel" åšç¼©æ”¾ï¼Œç”¨ "middle" åšå¹³ç§»</span>
      <span class="hljs-comment">// ä½†æ—¢ç„¶éœ€æ±‚æ˜¯ "ç©ºæ ¼+å·¦é”®"ï¼Œæˆ‘ä»¬éœ€è¦é…åˆ keydown/keyup</span>
    });
  }
}
</code></pre>
<p>è¿™é‡Œæ­‡ä¸€æ­‡ï¼Œç†ç†ä»£ç æ€è·¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3baa123b358e41f5ab5aac330d9d7478~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=7ayzXH6NCNU2GDyA%2Fafa%2BR7HgZk%3D" alt="9.gif" loading="lazy"/></p>
<p>**â€œæŒ‰ä½ç©ºæ ¼â€**è¿™ä¸ªé€»è¾‘åœ¨ DOM äº‹ä»¶é‡Œç¨å¾®æœ‰ç‚¹éº»çƒ¦ã€‚å› ä¸º <code>mousedown</code> äº‹ä»¶å¯¹è±¡é‡Œä¸ç›´æ¥å‘Šè¯‰ä½ â€œç©ºæ ¼é”®æ˜¯ä¸æ˜¯æ­£è¢«æŒ‰ç€â€ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç»™ <code>Viewport</code> å¢åŠ é”®ç›˜ç›‘å¬ã€‚</p>
<p><strong>ä¿®æ­£åçš„å®Œæ•´ <code>src/view/viewport.js</code>ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> Point2D from <span class="hljs-string">"../primitives/point2D.js"</span>;

export default <span class="hljs-keyword">class</span> <span class="hljs-title class_">Viewport</span> {
  <span class="hljs-keyword">constructor</span>(canvas) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);

    <span class="hljs-keyword">this</span>.zoom = <span class="hljs-number">1</span>;
    <span class="hljs-comment">// è¿™é‡Œçš„ offset å°±æ˜¯æˆ‘ä»¬ä¸€å…±å¹³ç§»äº†å¤šå°‘è·ç¦»</span>
    <span class="hljs-keyword">this</span>.offset = new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>); 
    
    <span class="hljs-comment">// æ‹–æ‹½è®¡ç®—ç”¨çš„ä¸´æ—¶å˜é‡</span>
    <span class="hljs-keyword">this</span>.drag = {
      start: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),
      end: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),
      offset: new Point2D(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),
      active: <span class="hljs-literal">false</span>
    };

    <span class="hljs-keyword">this</span>.#addEventListeners();
  }

  <span class="hljs-comment">// è®¡ç®—ï¼šé¼ æ ‡åœ¨å±å¹•ä¸Šçš„ç‚¹ï¼Œå¯¹åº”çš„çœŸå®ä¸–ç•Œåæ ‡åœ¨å“ªé‡Œ</span>
  getMouse(evt, subtractDragOffset = <span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">const</span> p = new Point2D(
      (evt.offsetX - <span class="hljs-keyword">this</span>.canvas.width / <span class="hljs-number">2</span>) * <span class="hljs-keyword">this</span>.zoom - <span class="hljs-keyword">this</span>.offset.x,
      (evt.offsetY - <span class="hljs-keyword">this</span>.canvas.height / <span class="hljs-number">2</span>) * <span class="hljs-keyword">this</span>.zoom - <span class="hljs-keyword">this</span>.offset.y
    );
    <span class="hljs-keyword">return</span> p;
  }
  
  <span class="hljs-comment">// ç»™ Canvas æ¸²æŸ“ç”¨çš„ï¼Œå‘Šè¯‰å®ƒè¯¥å¹³ç§»å¤šå°‘</span>
  getOffset() {
      <span class="hljs-keyword">return</span> new Point2D(
          <span class="hljs-keyword">this</span>.offset.x + <span class="hljs-keyword">this</span>.canvas.width / <span class="hljs-number">2</span>,
          <span class="hljs-keyword">this</span>.offset.y + <span class="hljs-keyword">this</span>.canvas.height / <span class="hljs-number">2</span>
      );
  }

  #addEventListeners() {
    <span class="hljs-comment">// è®°å½•ç©ºæ ¼é”®çŠ¶æ€</span>
    <span class="hljs-keyword">this</span>.isSpacePressed = <span class="hljs-literal">false</span>;

    window.addEventListener(<span class="hljs-string">"keydown"</span>, (evt) =&gt; {
       <span class="hljs-keyword">if</span> (evt.code === <span class="hljs-string">"Space"</span>) {
           <span class="hljs-keyword">this</span>.isSpacePressed = <span class="hljs-literal">true</span>;
       }
    });

    window.addEventListener(<span class="hljs-string">"keyup"</span>, (evt) =&gt; {
       <span class="hljs-keyword">if</span> (evt.code === <span class="hljs-string">"Space"</span>) {
           <span class="hljs-keyword">this</span>.isSpacePressed = <span class="hljs-literal">false</span>;
       }
    });

    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousedown"</span>, (evt) =&gt; {
      <span class="hljs-comment">// åªæœ‰æŒ‰ä½ç©ºæ ¼ + å·¦é”®ï¼Œæ‰å¼€å§‹æ‹–æ‹½è§†å£</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isSpacePressed &amp;&amp; evt.button === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.drag.start = <span class="hljs-keyword">this</span>.getMouse(evt);
        <span class="hljs-keyword">this</span>.drag.active = <span class="hljs-literal">true</span>;
      }
    });

    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousemove"</span>, (evt) =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.drag.active) {
        <span class="hljs-keyword">this</span>.drag.end = <span class="hljs-keyword">this</span>.getMouse(evt);
        <span class="hljs-comment">// è®¡ç®—è¿™ä¸€ç¬é—´ç§»åŠ¨äº†å¤šå°‘</span>
        <span class="hljs-keyword">this</span>.drag.offset = new Point2D(
            <span class="hljs-keyword">this</span>.drag.end.x - <span class="hljs-keyword">this</span>.drag.start.x,
            <span class="hljs-keyword">this</span>.drag.end.y - <span class="hljs-keyword">this</span>.drag.start.y
        );
        <span class="hljs-comment">// ç´¯åŠ åˆ°æ€»åç§»é‡é‡Œ</span>
        <span class="hljs-keyword">this</span>.offset.x += <span class="hljs-keyword">this</span>.drag.offset.x;
        <span class="hljs-keyword">this</span>.offset.y += <span class="hljs-keyword">this</span>.drag.offset.y;
        
        <span class="hljs-comment">// é‡è¦ï¼šé‡ç½® startï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å¤„ç†äº†è¿™æ®µä½ç§»</span>
        <span class="hljs-comment">// å¦‚æœä¸é‡ç½®ï¼Œä½ ä¼šå‘ç°ç”»é¢é£å¾—è¶Šæ¥è¶Šå¿«</span>
        <span class="hljs-keyword">this</span>.drag.start = <span class="hljs-keyword">this</span>.getMouse(evt); 
      }
    });

    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mouseup"</span>, () =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.drag.active) {
        <span class="hljs-keyword">this</span>.drag.active = <span class="hljs-literal">false</span>;
      }
    });
  }
}
</code></pre>
<h3 data-id="heading-5">ä¿®æ”¹ <code>GraphEditor</code></h3>
<p>è¿™å°±æ˜¯ä¸Šç¯‡åŸ‹çš„å‘ã€‚ä¹‹å‰æˆ‘ä»¬åœ¨ <code>GraphEditor</code> é‡Œç›´æ¥ç”¨äº† <code>evt.offsetX</code>ã€‚ç°åœ¨ä¸è¡Œäº†ï¼Œå¿…é¡»é€šè¿‡ <code>viewport.getMouse(evt)</code> æ¥è·å–åæ ‡ã€‚</p>
<p>ä¿®æ”¹ <code>src/editors/graphEditor.js</code>ï¼š</p>
<ol>
<li><strong>æ„é€ å‡½æ•°</strong>æ¥æ”¶ <code>viewport</code>ã€‚</li>
<li><strong>äº‹ä»¶ç›‘å¬</strong>æ”¹ç”¨ <code>viewport.getMouse(evt)</code>ã€‚</li>
<li><strong>å†²çªè§£å†³</strong>ï¼šå¦‚æœæŒ‰ä½äº†ç©ºæ ¼ï¼ˆæ­£åœ¨æ‹–æ‹½è§†å›¾ï¼‰ï¼Œå°±ä¸è¦è§¦å‘â€œç”»ç‚¹â€çš„é€»è¾‘ã€‚</li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// src/editors/graphEditor.js</span>
<span class="hljs-keyword">import</span> Point2D from <span class="hljs-string">"../primitives/point2D.js"</span>;
<span class="hljs-keyword">import</span> Segment from <span class="hljs-string">"../primitives/segment.js"</span>;

export default <span class="hljs-keyword">class</span> <span class="hljs-title class_">GraphEditor</span> {
  <span class="hljs-keyword">constructor</span>(canvas, graph, viewport) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.graph = graph;
    <span class="hljs-keyword">this</span>.viewport = viewport;

    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);

    <span class="hljs-comment">// çŠ¶æ€æœº</span>
    <span class="hljs-keyword">this</span>.selected = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å½“å‰é€‰ä¸­çš„ç‚¹ï¼ˆç”¨äºè¿çº¿èµ·ç‚¹ï¼‰</span>
    <span class="hljs-keyword">this</span>.hovered = <span class="hljs-literal">null</span>; <span class="hljs-comment">// é¼ æ ‡æ‚¬åœçš„ç‚¹</span>
    <span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">false</span>; <span class="hljs-comment">// é¢„ç•™ç»™æœªæ¥æ‹–æ‹½ç”¨</span>
    <span class="hljs-keyword">this</span>.mouse = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å½“å‰é¼ æ ‡ä½ç½®</span>

    <span class="hljs-comment">// å¯åŠ¨ç›‘å¬</span>
    <span class="hljs-keyword">this</span>.#addEventListeners();
  }

  #addEventListeners() {
    <span class="hljs-comment">// 1. é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span>
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousedown"</span>, (evt) =&gt; {
      <span class="hljs-comment">// åªæœ‰å·¦é”®(0)å’Œå³é”®(2)æ‰å¤„ç†</span>
      <span class="hljs-keyword">if</span> (evt.button == <span class="hljs-number">2</span>) {
        <span class="hljs-comment">// å³é”®é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selected) {
          <span class="hljs-keyword">this</span>.selected = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å–æ¶ˆå½“å‰é€‰ä¸­ï¼Œåœæ­¢è¿çº¿</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hovered) {
          <span class="hljs-keyword">this</span>.#removePoint(<span class="hljs-keyword">this</span>.hovered); <span class="hljs-comment">// åˆ é™¤ç‚¹</span>
        }
      }

      <span class="hljs-keyword">if</span> (evt.button == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// [æ–°å¢] å¦‚æœè§†å£æ­£åœ¨è¢«æ‹–æ‹½ï¼Œæˆ–è€…æ˜¯ç©ºæ ¼æŒ‰ä¸‹çŠ¶æ€ï¼Œä¸è¦ç”»ç‚¹</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.viewport.drag.active || <span class="hljs-keyword">this</span>.viewport.isSpacePressed) <span class="hljs-keyword">return</span>;

        <span class="hljs-comment">// å·¦é”®é€»è¾‘</span>
        <span class="hljs-comment">// å¦‚æœé¼ æ ‡åœ¨æŸä¸ªç‚¹ä¸Šï¼Œå°±é€‰ä¸­å®ƒï¼›å¦‚æœä¸åœ¨ï¼Œå°±æ–°å»ºä¸€ä¸ªç‚¹å¹¶é€‰ä¸­å®ƒ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hovered) {
          <span class="hljs-keyword">this</span>.#select(<span class="hljs-keyword">this</span>.hovered);
          <span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">this</span>.graph.tryAddPoint(<span class="hljs-keyword">this</span>.mouse);
        <span class="hljs-keyword">this</span>.#select(<span class="hljs-keyword">this</span>.mouse); <span class="hljs-comment">// è‡ªåŠ¨é€‰ä¸­æ–°ç‚¹ï¼Œæ–¹ä¾¿è¿ç»­ç”»çº¿</span>
        <span class="hljs-keyword">this</span>.hovered = <span class="hljs-keyword">this</span>.mouse;
        <span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">true</span>;
      }
    });

    <span class="hljs-comment">// 2. é¼ æ ‡ç§»åŠ¨äº‹ä»¶</span>
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousemove"</span>, (evt) =&gt; {
      <span class="hljs-comment">// è·å–é¼ æ ‡åœ¨ Canvas é‡Œçš„åæ ‡ï¼ˆå³ä½¿ Canvas ç¼©æ”¾æˆ–åç§»ä¹Ÿèƒ½ç”¨ï¼‰</span>
      <span class="hljs-comment">// è¿™é‡Œå…ˆç®€åŒ–å¤„ç†ï¼Œå‡è®¾ Canvas é“ºæ»¡æˆ–è€…æ— åç§»</span>
      <span class="hljs-comment">// å®é™…ä¸Šæˆ‘ä»¬åº”è¯¥å†™ä¸ª getViewportPointï¼Œä½†æš‚æ—¶å…ˆç›´æ¥è¯»å– offsetX/Y</span>
      <span class="hljs-keyword">this</span>.mouse = <span class="hljs-keyword">this</span>.viewport.getMouse(evt);

      <span class="hljs-comment">// æ£€æŸ¥é¼ æ ‡æœ‰æ²¡æœ‰æ‚¬åœåœ¨æŸä¸ªç‚¹ä¸Š</span>
      <span class="hljs-keyword">this</span>.hovered = <span class="hljs-keyword">this</span>.#getNearestPoint(<span class="hljs-keyword">this</span>.mouse);

      <span class="hljs-comment">// ç§»åŠ¨çš„æ—¶å€™ä¸éœ€è¦é‡ç»˜å—ï¼Ÿéœ€è¦çš„ï¼Œä½†æˆ‘ä»¬ä¼šåœ¨ World é‡Œç»Ÿä¸€é©±åŠ¨åŠ¨ç”»å¾ªç¯</span>
    });

    <span class="hljs-comment">// 3. ç¦æ­¢å³é”®èœå•å¼¹å‡º</span>
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"contextmenu"</span>, (evt) =&gt; evt.preventDefault());

    <span class="hljs-comment">// 4. é¼ æ ‡æŠ¬èµ·ï¼ˆç»“æŸæ‹–æ‹½çŠ¶æ€ï¼‰</span>
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mouseup"</span>, () =&gt; (<span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">false</span>));
  }

  #select(point) {
    <span class="hljs-comment">// å¦‚æœä¹‹å‰å·²ç»é€‰ä¸­äº†ä¸€ä¸ªç‚¹ï¼Œç°åœ¨åˆé€‰äº†ä¸€ä¸ªç‚¹ï¼Œè¯´æ˜è¦è¿çº¿</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selected) {
      <span class="hljs-comment">// å°è¯•æ·»åŠ çº¿æ®µ</span>
      <span class="hljs-keyword">this</span>.graph.tryAddSegment(new Segment(<span class="hljs-keyword">this</span>.selected, point));
    }
    <span class="hljs-keyword">this</span>.selected = point;
  }

  #removePoint(point) {
    <span class="hljs-keyword">this</span>.graph.removePoint(point);
    <span class="hljs-keyword">this</span>.hovered = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selected == point) {
      <span class="hljs-keyword">this</span>.selected = <span class="hljs-literal">null</span>;
    }
  }

  <span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šæ‰¾ç¦»é¼ æ ‡æœ€è¿‘çš„ç‚¹</span>
  #getNearestPoint(point, minThreshold = <span class="hljs-number">15</span>) {
    let nearest = <span class="hljs-literal">null</span>;
    let minDist = Number.MAX_SAFE_INTEGER;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p of <span class="hljs-keyword">this</span>.graph.points) {
      <span class="hljs-keyword">const</span> dist = Math.hypot(p.x - point.x, p.y - point.y);
      <span class="hljs-keyword">if</span> (dist &lt; minThreshold &amp;&amp; dist &lt; minDist) {
        minDist = dist;
        nearest = p;
      }
    }
    <span class="hljs-keyword">return</span> nearest;
  }

  <span class="hljs-comment">// ä¸“é—¨è´Ÿè´£ç”»ç¼–è¾‘å™¨ç›¸å…³çš„ UIï¼ˆæ¯”å¦‚é«˜äº®ã€è™šçº¿ï¼‰</span>
  display() {
    <span class="hljs-keyword">this</span>.graph.draw(<span class="hljs-keyword">this</span>.ctx);

    <span class="hljs-comment">// å¦‚æœæœ‰æ‚¬åœçš„ç‚¹ï¼Œç”»ä¸ªç‰¹æ®Šçš„æ ·å¼</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hovered) {
      <span class="hljs-keyword">this</span>.hovered.draw(<span class="hljs-keyword">this</span>.ctx, { outline: <span class="hljs-literal">true</span> });
    }

    <span class="hljs-comment">// å¦‚æœæœ‰é€‰ä¸­çš„ç‚¹ï¼Œä¹Ÿé«˜äº®ä¸€ä¸‹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.selected) {
      <span class="hljs-comment">// è·å–é¼ æ ‡ä½ç½®ä½œä¸ºæ„å›¾ç»ˆç‚¹</span>
      <span class="hljs-keyword">const</span> intent = <span class="hljs-keyword">this</span>.hovered ? <span class="hljs-keyword">this</span>.hovered : <span class="hljs-keyword">this</span>.mouse;
      <span class="hljs-comment">// ç”»å‡ºâ€œè™šæ‹Ÿçº¿æ¡â€ï¼šä»é€‰ä¸­ç‚¹ -&gt; é¼ æ ‡ä½ç½®</span>
      new Segment(<span class="hljs-keyword">this</span>.selected, intent).draw(<span class="hljs-keyword">this</span>.ctx, {
        color: <span class="hljs-string">"rgba(0,0,0,0.5)"</span>,
        width: <span class="hljs-number">1</span>,
        dash: [<span class="hljs-number">3</span>, <span class="hljs-number">3</span>],
      });
      <span class="hljs-keyword">this</span>.selected.draw(<span class="hljs-keyword">this</span>.ctx, { outline: <span class="hljs-literal">true</span>, outlineColor: <span class="hljs-string">"blue"</span> });
    }
  }
}

</code></pre>
<h3 data-id="heading-6">4.3. é‡æ„ <code>World</code>ï¼šåº”ç”¨è§†å£å˜æ¢</h3>
<p>æœ€åï¼Œå» <code>index.js</code> æŠŠè¿™ä¸€åˆ‡ä¸²èµ·æ¥ã€‚Canvas çš„å˜æ¢ï¼ˆTranslateï¼‰éœ€è¦åŒ…è£¹åœ¨ <code>save()</code> å’Œ <code>restore()</code> ä¹‹é—´ï¼Œå¦åˆ™ä½ çš„ UIï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¹Ÿä¼šè·Ÿç€ä¸€èµ·è·‘ã€‚</p>
<p>ä¿®æ”¹ <code>src/index.js</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> Point2D from <span class="hljs-string">"./primitives/point2D.js"</span>;
<span class="hljs-keyword">import</span> Segment from <span class="hljs-string">"./primitives/segment.js"</span>;
<span class="hljs-keyword">import</span> Graph from <span class="hljs-string">"./math/graph.js"</span>;
<span class="hljs-keyword">import</span> GraphEditor from <span class="hljs-string">"./editors/graphEditor.js"</span>;
<span class="hljs-keyword">import</span> Viewport from <span class="hljs-string">"./view/viewport.js"</span>; <span class="hljs-comment">// å¼•å…¥æ–°æˆå‘˜</span>

export default <span class="hljs-keyword">class</span> <span class="hljs-title class_">World</span> {
  <span class="hljs-keyword">constructor</span>(canvas, width = <span class="hljs-number">600</span>, height = <span class="hljs-number">600</span>) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
    <span class="hljs-keyword">this</span>.canvas.width = width;
    <span class="hljs-keyword">this</span>.canvas.height = height;

    <span class="hljs-keyword">this</span>.graph = new Graph();
    <span class="hljs-comment">// 1. å…ˆåˆå§‹åŒ–è§†å£</span>
    <span class="hljs-keyword">this</span>.viewport = new Viewport(<span class="hljs-keyword">this</span>.canvas);
    <span class="hljs-comment">// 2. æŠŠè§†å£ä¼ ç»™ç¼–è¾‘å™¨</span>
    <span class="hljs-keyword">this</span>.editor = new GraphEditor(<span class="hljs-keyword">this</span>.canvas, <span class="hljs-keyword">this</span>.graph, <span class="hljs-keyword">this</span>.viewport);

    <span class="hljs-keyword">this</span>.animate();
  }

  animate() {
    <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);

    <span class="hljs-comment">// [æ ¸å¿ƒæ­¥éª¤] ä¿å­˜å½“å‰çŠ¶æ€ -&gt; ç§»åŠ¨ç”»å¸ƒ -&gt; ç”»ç”» -&gt; æ¢å¤çŠ¶æ€</span>
    <span class="hljs-keyword">this</span>.ctx.save();
    
    <span class="hljs-comment">// è·å–è§†å£å½“å‰çš„åç§»ï¼Œå¹¶åº”ç”¨å¹³ç§»å˜æ¢</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ç”¨ scale(1/zoom) æ˜¯ä¸ºäº†é…åˆé¼ æ ‡è®¡ç®—ï¼Œæš‚æ—¶è¿˜æ²¡åšç¼©æ”¾ï¼Œ</span>
    <span class="hljs-comment">// ä½†æˆ‘ä»¬å¯ä»¥æŠŠ translate å…ˆå†™å¥½</span>
    <span class="hljs-keyword">const</span> offset = <span class="hljs-keyword">this</span>.viewport.getOffset();
    <span class="hljs-keyword">this</span>.ctx.translate(offset.x, offset.y);
    
    <span class="hljs-comment">// æ‰€æœ‰çš„ç»˜åˆ¶ç°åœ¨éƒ½åœ¨"ç§»åŠ¨å"çš„åæ ‡ç³»é‡Œè¿›è¡Œäº†</span>
    <span class="hljs-keyword">this</span>.editor.display();
    
    <span class="hljs-keyword">this</span>.ctx.restore();

    requestAnimationFrame(() =&gt; <span class="hljs-keyword">this</span>.animate());
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-7">å¤§æ¦‚ç¤ºæ„å›¾</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7198ab4ff5444e18ac2bf805b5122f5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5oCqdg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765804929&amp;x-signature=j9FCEAPUwUNYv0tr0I8EtGlYFeA%3D" alt="image.png" loading="lazy"/></p>
<p>å—¯....NICEï¼</p>
<p>ä»Šå¤©å°±è¿™æ ·äº†ã€‚</p>
<p>å®Œæ•´ä»£ç æˆ³è¿™é‡Œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFloat-none%2FJS-Genesis%2Ftree%2Fmain%2F04" target="_blank" title="https://github.com/Float-none/JS-Genesis/tree/main/04" ref="nofollow noopener noreferrer">github.com/Float-none/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é•¿ä¸Šä¸‹æ–‡ã€Agentè®°å¿†ã€Text2SQLä¸­ï¼Œè°ä¼šå–ä»£RAGï¼Ÿ]]></title>    <link>https://juejin.cn/post/7581359420391686171</link>    <guid>https://juejin.cn/post/7581359420391686171</guid>    <pubDate>2025-12-08T13:42:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581359420391686171" data-draft-id="7581406561685372974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é•¿ä¸Šä¸‹æ–‡ã€Agentè®°å¿†ã€Text2SQLä¸­ï¼Œè°ä¼šå–ä»£RAGï¼Ÿ"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-12-08T13:42:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™ºæ³ŠAI"/> <meta itemprop="url" content="https://juejin.cn/user/3572727470361578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é•¿ä¸Šä¸‹æ–‡ã€Agentè®°å¿†ã€Text2SQLä¸­ï¼Œè°ä¼šå–ä»£RAGï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3572727470361578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™ºæ³ŠAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T13:42:31.000Z" title="Mon Dec 08 2025 13:42:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é•¿ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›ã€Agentçš„è®°å¿†æœºåˆ¶ã€Text2SQLæŠ€æœ¯çš„æ¼”è¿›ï¼Œæ˜¯å¦ç»ˆå°†å–ä»£RAGï¼Ÿ</p>
<p>æ¢å¥è¯æ¥è¯´ï¼šRAGæ˜¯å¦ä»…æ˜¯æŠ€æœ¯æ¼”è¿›ä¸­çš„"é˜¶æ®µæ€§æ–¹æ¡ˆ"ï¼Ÿ</p>
<p>è¿‘ä¸¤å¹´ï¼Œä¸šç•Œå¯¹æ­¤çš„äº‰è®®æŒç»­ä¸æ–­ã€‚æ”¯æŒæ›¿ä»£çš„ä¸€æ–¹è®¤ä¸ºï¼Œéšç€ä¸Šä¸‹æ–‡å®¹é‡æ‰©å±•ã€Agentæ™ºèƒ½æ°´å¹³æå‡ã€æ•°æ®åº“äº¤äº’æ•ˆç‡ä¼˜åŒ–ï¼ŒRAGçš„æ·˜æ±°å·²æˆå¿…ç„¶ï¼›è€Œåå¯¹è€…åˆ™ä¸»å¼ ï¼ŒRAGå°†å¦‚åŒæœç´¢å¼•æ“èˆ¬ï¼Œæˆä¸ºAIåŸºç¡€è®¾æ–½çš„æ ¸å¿ƒæ”¯æŸ±ã€‚</p>
<p>è®©æˆ‘ä»¬ç³»ç»Ÿæ€§åœ°å¯¹æ¯”åˆ†æï¼šå°†é•¿ä¸Šä¸‹æ–‡ã€Agentè®°å¿†ã€Text2SQLä¸RAGç½®äºåŒä¸€æ¡†æ¶ä¸‹ï¼Œé€ä¸€è¯„ä¼°å…¶æŠ€æœ¯ç‰¹æ€§ä¸é€‚ç”¨åœºæ™¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a4b6d49f52d4bac8801379508331e80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765806151&amp;x-signature=czet9JfNqC2JGZgnt%2BCCele5baE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</strong></p>
<p><strong>ä¸€ã€å…ˆæ‰¿è®¤ä¸€ä¸ªå‰æï¼šLLM æœ‰â€œåŸç½ªâ€</strong></p>
<p>æ‰€æœ‰åç»­çš„æŠ€æœ¯ï¼Œæœ¬è´¨ä¸Šéƒ½åœ¨ä¸ºå¤§æ¨¡å‹"æŸ¥æ¼è¡¥ç¼º"ã€‚</p>
<p>å°½ç®¡LLMèƒ½åŠ›å“è¶Šï¼Œä»å­˜åœ¨ä¸‰ä¸ªå›ºæœ‰ç¼ºé™·ï¼š</p>
<p><strong>â€Œ1.å¹»è§‰é—®é¢˜â€Œ</strong></p>
<p>è¡¨ç°ä¸ºé«˜åº¦ç¡®ä¿¡å´è¾“å‡ºè™šæ„å†…å®¹ã€‚</p>
<p>æœ¬è´¨å®šä¹‰ï¼šç”Ÿæˆå†…å®¹ä¸äº‹å®å­˜åœ¨åå·®ï¼Œæˆ–ç¼ºä¹å¯ä¿¡ä¾æ®æ”¯æ’‘ã€‚</p>
<p><strong>â€Œ2.ä¸Šä¸‹æ–‡å®¹é‡ç“¶é¢ˆ</strong>ï¼ˆæ³¨æ„åŠ›è¡°å‡ï¼‰â€Œ</p>
<p>ä»ç†è®ºçœ‹ï¼Œæ‰©å±•ä¸Šä¸‹æ–‡æœ¬åº”å¢å¼ºè®°å¿†èƒ½åŠ›ï¼Œä½†å®é™…å­˜åœ¨ä¸´ç•Œç‚¹ï¼š</p>
<p>å½“æ–‡æœ¬è¿‡é•¿æ—¶ï¼Œæ¨¡å‹æ³¨æ„åŠ›ä¼šæ˜¾è‘—åˆ†æ•£ï¼Œå¯¼è‡´åç»­å†…å®¹å¯¹å‰æ–‡çš„ç†è§£é€æ¸æ·¡åŒ–ã€‚</p>
<p>æ‰©å±•ä¸Šä¸‹æ–‡ä¸ç­‰äº"æ°¸ä¹…è®°å¿†"ï¼Œè€Œæ˜¯"å®¹é‡å¢åŠ ä½†æµ“åº¦é™ä½çš„è®°å¿†ä½“"ã€‚</p>
<p><strong>â€Œ3.çŸ¥è¯†è¾¹ç•Œå›ºåŒ–â€Œ</strong></p>
<p>æ¨¡å‹çš„çŸ¥è¯†ä½“ç³»æºè‡ªè®­ç»ƒæ•°æ®ï¼šå…¬å¼€ç½‘ç»œä¿¡æ¯+å¼€æ”¾æ•°æ®é›†ã€‚</p>
<p>ç”±æ­¤è¡ç”Ÿä¸¤å¤§å±€é™ï¼š</p>
<p>æœªæ¶µç›–éå…¬å¼€æ•°æ®ï¼ˆä¼ä¸šä¸“æœ‰çŸ¥è¯†åº“ã€å†…éƒ¨æ–‡æ¡£ç­‰ï¼‰</p>
<p>æ—¶æ•ˆæ€§æ»åï¼šè®­ç»ƒæˆªæ­¢æ—¥æœŸåçš„æ–°äº‹ä»¶å®Œå…¨è¶…å‡ºè®¤çŸ¥èŒƒå›´</p>
<p>å› æ­¤ï¼Œæ ¸å¿ƒæŒ‘æˆ˜å§‹ç»ˆæ˜¯ï¼š</p>
<p>å¦‚ä½•åœ¨ä¸å…¨é‡é‡è®­çš„æ¡ä»¶ä¸‹ï¼Œä½¿æ¨¡å‹å…·å¤‡"å®æ—¶æ›´æ–°çš„"ã€"ä¸“å±é¢†åŸŸçš„"ã€"ç³»ç»ŸåŒ–çš„"çŸ¥è¯†ï¼ŒåŒæ—¶æœ€å¤§é™åº¦å‡å°‘è™šæ„è¾“å‡ºï¼Ÿ</p>
<p>RAGæŠ€æœ¯ã€æ‰©å±•ä¸Šä¸‹æ–‡ã€æ™ºèƒ½ä½“è®°å¿†æœºåˆ¶ã€Text2SQLç­‰ï¼Œå‡ä¸ºè¯¥é—®é¢˜æä¾›äº†å·®å¼‚åŒ–è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>äºŒã€RAG åˆ°åº•åœ¨è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64cc9eccc68e416990c37b7d0153c76e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765806151&amp;x-signature=Saiz7tkXTh8pVmgYrXEsPAYK9RM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ä¸€å¥è¯æ¦‚æ‹¬</strong>ï¼šâ€Œ</p>
<p>RAGï¼ˆRetrieval-Augmented Generationï¼‰= æ£€ç´¢ + ç”Ÿæˆï¼Œå³åœ¨å‘æ¨¡å‹æé—®å‰ï¼Œå…ˆä»æ•°æ®ä¸­ç­›é€‰ç›¸å…³å†…å®¹ï¼Œå†åŸºäºè¿™äº›ä¿¡æ¯ç”Ÿæˆå›ç­”ã€‚</p>
<p>â€Œè¯¦ç»†è¯´æ˜ï¼šâ€Œ</p>
<p>â€Œ1.<strong>å®šä½ä¸ä½œç”¨â€Œ</strong></p>
<p>RAGæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„è¡¥å……è€Œéæ›¿ä»£ï¼Œå…¶æ ¸å¿ƒæ˜¯ä¸ºæ¨¡å‹æä¾›â€Œä¸Šä¸‹æ–‡æ”¯æŒâ€Œï¼Œç¡®ä¿å›ç­”åŸºäºå¯ä¿¡èµ„æ–™ã€‚</p>
<p>æ–¹æ³•è®ºå±æ€§ï¼šå±äºæŠ€æœ¯æ¶æ„è®¾è®¡ï¼Œéç‰¹å®šæ¨¡å‹æˆ–äº§å“ã€‚</p>
<p>ç¤ºä¾‹ç±»æ¯”ï¼šæé—®æ—¶ï¼Œå…ˆæ£€ç´¢â€œåœ°çƒè‡ªè½¬â€çš„ç™¾ç§‘æ®µè½ä½œä¸ºPromptèƒŒæ™¯ï¼Œå†è¦æ±‚æ¨¡å‹ç»“åˆå†…å®¹ä½œç­”ã€‚</p>
<p><strong>2â€Œ.æŠ€æœ¯ä¼˜åŠ¿â€Œ</strong></p>
<p>â€Œå‡å°‘å¹»è§‰â€Œï¼šæ¨¡å‹ä¼˜å…ˆå‚è€ƒç”¨æˆ·æä¾›çš„æ–‡æ¡£ï¼Œè€Œéä¾èµ–è‡ªèº«çŸ¥è¯†åº“ï¼ˆå¯è®¾å®šâ€œä¸¥æ ¼åŸºäºæ–‡æ¡£å›ç­”â€è§„åˆ™ï¼‰ã€‚</p>
<p>â€Œæ‰©å±•çŸ¥è¯†æºâ€Œï¼šæ”¯æŒä¼ä¸šæ–‡æ¡£ã€æ•°æ®åº“ã€PDFç­‰å¤–éƒ¨æ•°æ®æ¥å…¥ã€‚</p>
<p>â€ŒåŠ¨æ€æ›´æ–°â€Œï¼šæ•°æ®æ›´æ–°åé€šè¿‡é‡æ–°ç´¢å¼•å³æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡æ–°è®­ç»ƒæ¨¡å‹ã€‚</p>
<p>â€Œé€æ˜å¯å®¡è®¡â€Œï¼šå¯è¿½æº¯å›ç­”çš„åŸå§‹æ–‡æ¡£åŠæ®µè½ï¼Œæ»¡è¶³ä¼ä¸šåˆè§„éœ€æ±‚ã€‚</p>
<p>â€Œä½æˆæœ¬éƒ¨ç½²â€Œï¼šä»…éœ€åœ¨ç°æœ‰æ¨¡å‹å¤–å åŠ æ£€ç´¢é€»è¾‘ï¼Œæ— éœ€å¾®è°ƒæˆ–å†è®­ç»ƒã€‚</p>
<p><strong>ä¸‰ã€RAG vs å¾®è°ƒï¼šå®ƒä»¬ä¸æ˜¯å¯¹ç«‹é¢</strong></p>
<p>è®¸å¤šå›¢é˜ŸåˆæœŸæœ€å¸¸æå‡ºçš„ç–‘é—®æ˜¯ï¼šâ€Œ"ç©¶ç«Ÿè¯¥é€‰æ‹©RAGï¼Œè¿˜æ˜¯ç›´æ¥å¯¹ç°æœ‰æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Ÿ"â€Œ</p>
<p>æ ¸å¿ƒç»“è®ºï¼šRAGä¸å¾®è°ƒæœ¬è´¨ä¸Šæ˜¯ååŒè€Œéå¯¹ç«‹çš„å…³ç³»ï¼Œç»å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¼šä¼˜å…ˆéƒ¨ç½²RAGæ–¹æ¡ˆã€‚</p>
<p>ä»å¤šç»´åº¦å¯¹æ¯”åˆ†æï¼š</p>
<p>â€Œ1.<strong>å¹»è§‰æ§åˆ¶â€Œ</strong></p>
<p>å¾®è°ƒï¼šè™½èƒ½ç¼“è§£å¹»è§‰é—®é¢˜ï¼Œä½†å­˜åœ¨è¿‡æ‹Ÿåˆé£é™©ï¼›åœ¨äº‹å®æ€§é—®ç­”ä¸­è¡¨ç°ä¸ç¨³å®šã€‚</p>
<p>RAGï¼šé€šè¿‡ç›´æ¥å¼•ç”¨"åŸå§‹èµ„æ–™"å®ç°æ›´ç¨³å®šçš„å¹»è§‰æŠ‘åˆ¶ã€‚</p>
<p><strong>â€Œ2.çŸ¥è¯†æ•´åˆæœºåˆ¶â€Œ</strong></p>
<p>å¾®è°ƒï¼šå°†çŸ¥è¯†å›ºåŒ–è‡³æ¨¡å‹å‚æ•°å†…éƒ¨ã€‚</p>
<p>RAGï¼šæ„å»ºå¤–éƒ¨çŸ¥è¯†åº“å®ç°åŠ¨æ€æ£€ç´¢è°ƒç”¨ã€‚</p>
<p><strong>â€Œ3.æ›´æ–°æ•ˆç‡â€Œ</strong></p>
<p>å¾®è°ƒï¼šæ¯æ¬¡çŸ¥è¯†æ›´æ–°éƒ½éœ€é‡æ–°è®­ç»ƒæˆ–å¢é‡è®­ç»ƒã€‚</p>
<p>RAGï¼šä»…éœ€æ›´æ–°ç´¢å¼•åº“ï¼Œè€—æ—¶é€šå¸¸ä¸ºåˆ†é’Ÿçº§è‡³ç§’çº§ã€‚</p>
<p><strong>â€Œ4.ä¸ªæ€§åŒ–é€‚é…â€Œ</strong></p>
<p>å¾®è°ƒï¼šæ›´é€‚ç”¨äºè°ƒæ•´è¾“å‡ºé£æ ¼ï¼ˆå¦‚ç¼–ç¨‹è§„èŒƒã€å®¢æœè¯æœ¯ç­‰ï¼‰ã€‚</p>
<p>RAGï¼šæ›´é«˜æ•ˆæ•´åˆä¸šåŠ¡é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚</p>
<p><strong>5â€Œ.å†³ç­–é€æ˜åº¦â€Œ</strong></p>
<p>å¾®è°ƒï¼šæ¨¡å‹å†…éƒ¨å†³ç­–è¿‡ç¨‹ä¸å¯è§ã€‚</p>
<p>RAGï¼šå¯è¿½æº¯å¼•ç”¨æ–‡æ¡£çš„å…·ä½“å†…å®¹ç‰‡æ®µã€‚</p>
<p><strong>6â€Œ.èµ„æºæ¶ˆè€—â€Œ</strong></p>
<p>å¾®è°ƒï¼šè®­ç»ƒæˆæœ¬é«˜æ˜‚ï¼Œæ¨ç†å»¶è¿Ÿä¸åŸæ¨¡å‹ç›¸å½“ã€‚</p>
<p>RAGï¼šå› å¢åŠ æ£€ç´¢-æ’åºæµç¨‹ä¼šç•¥å¾®æå‡ç«¯åˆ°ç«¯å»¶è¿Ÿã€‚</p>
<p>è¡Œä¸šå®è·µå»ºè®®ï¼š</p>
<p>"â€Œå…ˆå®æ–½RAGéªŒè¯æ•ˆæœï¼Œå¾…ç³»ç»Ÿç¨³å®šè¿è¡Œåï¼Œå†é€šè¿‡å¾®è°ƒä¼˜åŒ–è¾“å‡ºé£æ ¼ä¸æ ¼å¼â€Œ"çš„æ¸è¿›å¼ç­–ç•¥æœ€ä¸ºå¸¸è§ã€‚</p>
<p><strong>å››ã€RAG çš„åŸºæœ¬æ¨¡å‹ï¼š5 ä¸ªé˜¶æ®µè®²æ¸…æ¥š</strong></p>
<p>RAGç³»ç»Ÿçš„äº”ä¸ªæ ¸å¿ƒé˜¶æ®µâ€Œ</p>
<p><strong>1.æ•°æ®åŠ è½½</strong>ï¼ˆLoadingï¼‰</p>
<p>åŠŸèƒ½ï¼šæ•´åˆå¤šæºæ•°æ®è¾“å…¥</p>
<p>æ”¯æŒæ ¼å¼ï¼šPDF/Wordæ–‡æ¡£ã€ç½‘é¡µå†…å®¹ã€æ•°æ®åº“è®°å½•ã€APIæ¥å£æ•°æ®ç­‰</p>
<p>æ ¸å¿ƒç»„ä»¶ï¼š</p>
<p>èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼šæ–‡æœ¬åˆ†å—åçš„æœ€å°å¤„ç†å•å…ƒ</p>
<p>è¿æ¥å™¨ï¼ˆConnectorï¼‰ï¼šå®ç°ä¸åŒæ•°æ®æºçš„æ ‡å‡†æ¥å…¥</p>
<p><strong>2.ç´¢å¼•æ„å»º</strong>ï¼ˆIndexingï¼‰</p>
<p>ç›®æ ‡ï¼šå»ºç«‹é«˜æ•ˆæ£€ç´¢æœºåˆ¶</p>
<p>å…³é”®æŠ€æœ¯ï¼š</p>
<p>ç´¢å¼•ï¼ˆIndexï¼‰ï¼šç»“æ„åŒ–æ£€ç´¢ç›®å½•</p>
<p>åµŒå…¥ï¼ˆEmbeddingï¼‰ï¼šæ–‡æœ¬å‘é‡åŒ–è½¬æ¢</p>
<p><strong>3.æ•°æ®å­˜å‚¨</strong>ï¼ˆStorageï¼‰</p>
<p>å­˜å‚¨å†…å®¹ï¼šæ–‡æœ¬èŠ‚ç‚¹ã€å‘é‡è¡¨ç¤ºã€å…ƒæ•°æ®</p>
<p>å…¸å‹æ–¹æ¡ˆï¼šElasticsearchã€OpenSearchã€Pineconeã€Chromaç­‰</p>
<p><strong>4.æŸ¥è¯¢å¤„ç†</strong>ï¼ˆQueryingï¼‰</p>
<p>æ‰§è¡Œæµç¨‹ï¼š</p>
<p>æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ï¼šå‘é‡åº“åŒ¹é…å€™é€‰èŠ‚ç‚¹</p>
<p>è·¯ç”±å™¨ï¼ˆRouterï¼‰ï¼šç¡®å®šæ£€ç´¢ç­–ç•¥ã€åˆ¤æ–­æ˜¯å¦éœ€è¦ç»“æ„åŒ–æŸ¥è¯¢ã€å†³å®šæ˜¯å¦è°ƒç”¨ç‰¹å®šAgent</p>
<p>èŠ‚ç‚¹åå¤„ç†å™¨ï¼ˆNode Post-Processorï¼‰ï¼šç»“æœå»é‡ã€å†…å®¹åˆå¹¶ã€ä¿¡æ¯æ‰©å±•</p>
<p>å“åº”åˆæˆå™¨ï¼ˆResponse Synthesizerï¼‰ï¼šç»„åˆæ£€ç´¢ç»“æœä¸ç”¨æˆ·é—®é¢˜ã€ç”ŸæˆLLMè¾“å…¥Prompt</p>
<p><strong>5.ç³»ç»Ÿè¯„ä¼°</strong>ï¼ˆEvaluationï¼‰</p>
<p>æ–¹æ³•ï¼šæ„å»ºæ ‡å‡†é—®ç­”æµ‹è¯•é›†</p>
<p>è¯„ä¼°ç»´åº¦ï¼šæ£€ç´¢å‡†ç¡®ç‡ã€åˆ†å—åˆç†æ€§ã€Promptæœ‰æ•ˆæ€§</p>
<p>è¿­ä»£ä¼˜åŒ–ï¼šæŒç»­è°ƒæ•´ç³»ç»Ÿå‚æ•°</p>
<p><strong>äº”ã€RAG çš„æŠ€æœ¯ä½“ç³»å’Œè¯„ä¼°æŒ‡æ ‡</strong></p>
<p>æ£€ç´¢éƒ¨åˆ†è¯„ä¼°</p>
<p>åŸºç¡€æ£€ç´¢æŒ‡æ ‡ï¼ˆè¡¡é‡"æ£€ç´¢å‡†ç¡®åº¦"ï¼‰ï¼š</p>
<p>â€ŒPrecisionï¼ˆç²¾å‡†ç‡ï¼‰â€Œï¼šç³»ç»Ÿè¿”å›ç»“æœä¸­æ­£ç¡®ç­”æ¡ˆçš„å æ¯”ã€‚</p>
<p>â€ŒRecallï¼ˆå¬å›ç‡ï¼‰â€Œï¼šæ‰€æœ‰æ­£ç¡®ç­”æ¡ˆä¸­è¢«ç³»ç»Ÿæ£€ç´¢åˆ°çš„æ¯”ä¾‹ã€‚</p>
<p>â€ŒF1 Scoreâ€Œï¼šç»¼åˆç²¾å‡†ç‡ä¸å¬å›ç‡çš„å¹³è¡¡æŒ‡æ ‡ã€‚</p>
<p>æ’åºä¼˜åŒ–æŒ‡æ ‡ï¼ˆè¡¡é‡"ç»“æœæ’åºè´¨é‡"ï¼‰ï¼š</p>
<p>â€ŒMRRï¼ˆMean Reciprocal Rankï¼‰â€Œï¼šæ­£ç¡®ç­”æ¡ˆæ’åè¶Šé å‰å¾—åˆ†è¶Šé«˜ã€‚</p>
<p>â€ŒMAPï¼ˆMean Average Precisionï¼‰â€Œï¼šå¤šæŸ¥è¯¢åœºæ™¯ä¸‹çš„å¹³å‡ç²¾ç¡®ç‡å‡å€¼ã€‚</p>
<p>â€ŒNDCGâ€Œï¼šå¯¹æ’åé å‰çš„ç›¸å…³æ–‡æ¡£èµ‹äºˆæ›´é«˜æƒé‡ã€‚</p>
<p>æ ¸å¿ƒè¯„ä¼°ç»´åº¦ï¼š</p>
<p>"æ£€ç´¢å†…å®¹å¯¹åç»­å›ç­”çš„æ”¯æ’‘ä½œç”¨å¦‚ä½•ï¼Ÿ"</p>
<p>ç”Ÿæˆç»“æœè¯„ä¼°ï¼ˆå¤§æ¨¡å‹å›ç­”è´¨é‡ï¼‰</p>
<p>â€ŒCorrectnessâ€Œï¼šä¸æ ‡å‡†ç­”æ¡ˆçš„ç¬¦åˆåº¦</p>
<p>â€ŒRelevanceâ€Œï¼šå¯¹ç”¨æˆ·é—®é¢˜çš„è´´åˆç¨‹åº¦</p>
<p>â€ŒLogicâ€Œï¼šè®ºè¯ç»“æ„çš„ä¸¥è°¨æ€§</p>
<p>â€ŒStyleâ€Œï¼šæ–‡æœ¬é•¿åº¦ã€è¯­æ°”ä¸å“ç‰Œè°ƒæ€§çš„åŒ¹é…</p>
<p>ç”Ÿæˆè¿‡ç¨‹è¯„ä¼°ï¼ˆç»†ç²’åº¦æŒ‡æ ‡ï¼‰</p>
<p>â€ŒFaithfulnessâ€Œï¼šå›ç­”ä¸¥æ ¼åŸºäºæ£€ç´¢å†…å®¹</p>
<p>â€ŒNoise Robustnessâ€Œï¼šè¿‡æ»¤æ— å…³ä¿¡æ¯çš„èƒ½åŠ›</p>
<p>â€ŒNegative Rejectionâ€Œï¼šå¯¹æœªçŸ¥é—®é¢˜çš„å¦è¯šå“åº”</p>
<p>â€ŒInfo Integrationâ€Œï¼šå¤šæºä¿¡æ¯æ•´åˆèƒ½åŠ›</p>
<p>â€ŒCounterfactual Robustnessâ€Œï¼šæŠµå¾¡é”™è¯¯å‡è®¾å¹²æ‰°</p>
<p>è¿™äº›æŒ‡æ ‡å…±åŒå®šä¹‰äº†RAGç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­çš„å¯é æ€§æ°´å¹³ã€‚</p>
<p><strong>å…­ã€é•¿ä¸Šä¸‹æ–‡ã€Agent è®°å¿†ã€Text2SQL å„è‡ªçš„å®šä½</strong></p>
<p>æ ¸å¿ƒé—®é¢˜å›å½’ï¼šâ€Œ</p>
<p>è¿™äº›æŠ€æœ¯èƒ½å¦çœŸæ­£å–ä»£RAGï¼Ÿæˆ‘ä»¬é€ä¸€åˆ†æã€‚</p>
<p><strong>1â€Œ.é•¿ä¸Šä¸‹æ–‡æŠ€æœ¯</strong>ï¼ˆLong Contextï¼‰â€Œ</p>
<p>â€Œæ ¸å¿ƒä»·å€¼ï¼šâ€Œæ‰©å±•æ¨¡å‹å•æ¬¡å¯¹è¯çš„ä¿¡æ¯æ‰¿è½½é‡ï¼Œä¾‹å¦‚å®Œæ•´è§£æå¤šé¡µæ–‡æ¡£æˆ–å¤æ‚åˆåŒã€‚</p>
<p>â€Œæ›¿ä»£RAGçš„å¯èƒ½æ€§ï¼šâ€Œ</p>
<p>æœ‰é™ï¼Œä¸»è¦å—åˆ¶äºä¸‰ç‚¹ï¼š</p>
<p>â€Œæ³¨æ„åŠ›è¡°å‡â€Œï¼šå½“ä¸Šä¸‹æ–‡æ‰©å±•è‡³æ•°åä¸‡tokenæ—¶ï¼Œæ¨¡å‹å¯¹è¿œç«¯å†…å®¹çš„æ•æ„Ÿåº¦ä¼šæ˜¾è‘—é™ä½ã€‚</p>
<p>â€Œéæ™ºèƒ½ç­›é€‰â€Œï¼šè¯¥æŠ€æœ¯ä»…æä¾›"å®¹é‡æ‰©å±•"åŠŸèƒ½ï¼Œå…³é”®å†…å®¹ç­›é€‰ä»éœ€äººå·¥å†³ç­–â€”â€”åŒ…æ‹¬è¾“å…¥å†…å®¹çš„é€‰æ‹©ä¸æ’åºé€»è¾‘ï¼Œè¿™æœ¬è´¨ä¸Šä»æ˜¯æ£€ç´¢éœ€æ±‚çš„è½¬ç§»ã€‚</p>
<p>â€Œç»æµæ€§é™åˆ¶â€Œï¼šå¤§è§„æ¨¡ä¸Šä¸‹æ–‡æ¨ç†æˆæœ¬é«˜æ˜‚ï¼Œå¤šæ•°ä¸šåŠ¡åœºæ™¯éš¾ä»¥æ‰¿æ‹…ã€‚</p>
<p>â€Œå®é™…åº”ç”¨å®šä½ï¼šâ€Œ</p>
<p>æ›´é€‚åˆä½œä¸ºRAGçš„è¡¥å……æ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p>
<p>å¯¹RAGé¢„ç­›é€‰çš„æ–‡æ¡£è¿›è¡Œæ·±åº¦åˆ†æï¼ˆå¦‚é•¿æŠ¥å‘Šæ‘˜è¦ã€ä»£ç åº“è§£æï¼‰ã€‚</p>
<p>ä½œä¸º"å¢å¼ºç»„ä»¶"è¾…åŠ©RAGå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<p><strong>â€Œ2.Agentè®°å¿†ç³»ç»Ÿâ€Œ</strong></p>
<p>â€Œæ ¸å¿ƒä»·å€¼ï¼šâ€Œç»´æŠ¤å¯¹è¯è¿ç»­æ€§ï¼Œä¿ç•™ç”¨æˆ·åå¥½ä¸ä»»åŠ¡çŠ¶æ€ï¼ˆå¦‚å†™ä½œé£æ ¼ã€å·²ç¡®è®¤ä¿¡æ¯ï¼‰ã€‚</p>
<p>â€Œæ›¿ä»£RAGçš„ä¸å¯è¡Œæ€§ï¼šâ€Œ</p>
<p>ä¸¤è€…åŠŸèƒ½ç»´åº¦æˆªç„¶ä¸åŒï¼š</p>
<p>â€ŒAgentè®°å¿†â€Œï¼šèšç„¦å¯¹è¯è¿›ç¨‹ç®¡ç†ï¼ˆå¦‚å·²ä¸Šä¼ æ–‡ä»¶ã€ç”¨æˆ·é€‰æ‹©æ–¹æ¡ˆï¼‰ã€‚</p>
<p>â€ŒRAGâ€Œï¼šä¸“æ³¨å¤–éƒ¨çŸ¥è¯†åº“çš„æ¥å…¥ä¸æ£€ç´¢ï¼ˆå¦‚ä¼ä¸šåˆ¶åº¦ã€äº§å“æ–‡æ¡£ï¼‰ã€‚</p>
<p>â€ŒååŒåº”ç”¨åœºæ™¯ï¼šâ€Œ</p>
<p>Agentå°†å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆå¦‚æŸ¥è¯¢é¡¹ç›®/å®¢æˆ·ï¼‰ä½œä¸ºæ£€ç´¢æ¡ä»¶ï¼Œé©±åŠ¨RAGè·å–ç²¾å‡†æ•°æ®ã€‚</p>
<p>åœ¨å¤šè½®å¯¹è¯ä¸­è‡ªåŠ¨è¡¥å…¨èƒŒæ™¯ä¿¡æ¯ï¼Œé¿å…é‡å¤æè¿°ã€‚</p>
<p><strong>3â€Œ.Text2SQLæŠ€æœ¯â€Œ</strong></p>
<p>â€Œæ ¸å¿ƒä»·å€¼ï¼šâ€Œå°†è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºç»“æ„åŒ–æ•°æ®åº“æ“ä½œï¼ˆå¦‚"æŸ¥è¯¢2024å¹´10æœˆè®¢å•æ€»é¢"â†’è‡ªåŠ¨ç”ŸæˆSQLâ†’è¿”å›ç²¾ç¡®ç»“æœï¼‰ã€‚</p>
<p>â€Œæ›¿ä»£RAGçš„è¾¹ç•Œï¼šâ€Œ</p>
<p>åœ¨ç»“æ„åŒ–æ•°æ®æŸ¥è¯¢åœºæ™¯ä¸­ï¼Œå…¶æ•ˆæœä¼˜äº"æ–‡æœ¬æ£€ç´¢+ç”Ÿæˆ"æ¨¡å¼ã€‚</p>
<p>ä½†æ— æ³•è¦†ç›–éç»“æ„åŒ–çŸ¥è¯†ï¼ˆå¦‚è§„ç« åˆ¶åº¦ã€æŠ€æœ¯æ–‡æ¡£ï¼‰çš„å¤„ç†éœ€æ±‚ã€‚</p>
<p>â€Œç³»ç»Ÿé›†æˆè§†è§’ï¼šâ€Œ</p>
<p>å¯ä½œä¸ºRAGä½“ç³»çš„ä¸“ç”¨æ£€ç´¢åç«¯ï¼Œç”±è·¯ç”±æœºåˆ¶åˆ¤æ–­ä¼˜å…ˆè°ƒç”¨çŸ¥è¯†åº“ï¼ˆå‘é‡æ£€ç´¢ï¼‰æˆ–æ•°æ®åº“ï¼ˆText2SQLï¼‰ï¼Œæœ€ç»ˆç»¼åˆè¾“å‡ºç»“æœã€‚</p>
<p><strong>ä¸ƒã€å›åˆ°å¼€å¤´çš„é—®é¢˜ï¼šRAG ä¼šè¢«æ›¿ä»£å—ï¼Ÿ</strong></p>
<p>è‹¥æ‹†è§£å„é¡¹æŠ€æœ¯çš„æ ¸å¿ƒå®šä½ï¼Œå¯æ¸…æ™°è¯†åˆ«å…¶å·®å¼‚åŒ–ä»·å€¼ï¼š</p>
<p>â€Œé•¿ä¸Šä¸‹æ–‡â€Œï¼šçªç ´"å•æ¬¡äº¤äº’çš„ä¿¡æ¯å®¹é‡é™åˆ¶"</p>
<p>â€ŒAgentè®°å¿†â€Œï¼šå®ç°"è·¨å¯¹è¯è½®æ¬¡çš„ä¸Šä¸‹æ–‡å»¶ç»­"</p>
<p>â€ŒText2SQLâ€Œï¼šæ„å»º"è‡ªç„¶è¯­è¨€ä¸ç»“æ„åŒ–æ•°æ®çš„æ¡¥æ¢"</p>
<p>â€ŒRAGâ€Œï¼šå®Œæˆ"å¤šæºå¼‚æ„çŸ¥è¯†çš„æ™ºèƒ½ç­›é€‰ä¸æ•´åˆ"</p>
<p>è¿™äº›èƒ½åŠ›å‘ˆæ­£äº¤å…³ç³»ï¼Œå…±åŒæ„æˆæŠ€æœ¯çŸ©é˜µè€Œéæ›¿ä»£é€‰é¡¹ã€‚</p>
<p>é¢å‘å®é™…è½åœ°çš„ç³»ç»Ÿæ¶æ„å°†å‘ˆç°ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<p>çŸ¥è¯†å¢å¼ºæ¨¡å—ï¼ˆå‘é‡æ£€ç´¢+æ–‡æœ¬RAGï¼‰ã€è¶…é•¿æ–‡æœ¬è§£æèƒ½åŠ›ã€å¯¹è¯çŠ¶æ€ç®¡ç†æœºåˆ¶ã€ç»“æ„åŒ–æŸ¥è¯¢æ¥å£ï¼ˆText2SQL+APIè”åŠ¨ï¼‰ã€å¯é€‰çš„ç‰¹å¾å¾®è°ƒå±‚</p>
<p>ç”±æ­¤å¯æ¨å¯¼ï¼šRAGä½œä¸ºåŸºç¡€è®¾æ–½å±‚çš„åœ°ä½ä¸ä¼šåŠ¨æ‘‡ï¼Œå…¶æ¼”è¿›å°†èšç„¦äºï¼š</p>
<p>æŠ€æœ¯å®ç°è·¯å¾„åˆ›æ–°ã€æ•ˆæœè¯„ä¼°æ ‡å‡†ä¼˜åŒ–ã€ä¸å…¶ä»–ç»„ä»¶çš„ååŒèŒƒå¼</p>
<p><strong>å…«ã€å¦‚æœä½ åœ¨å›¢é˜Ÿé‡Œè½åœ° RAGï¼Œå¯ä»¥ä»å“ªå‡ æ­¥å¼€å§‹ï¼Ÿ</strong></p>
<p>å®æ“å»ºè®®æ¨è¿›æ­¥éª¤ï¼šâ€Œ</p>
<p><strong>1â€Œ.ä¼˜å…ˆç¡®å®šåº”ç”¨åœºæ™¯â€Œ</strong></p>
<p>æ˜ç¡®éœ€æ±‚ç±»å‹ï¼šæ˜¯å¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQï¼‰ã€ä¼ä¸šçŸ¥è¯†åº“æ£€ç´¢ï¼Œè¿˜æ˜¯å†…éƒ¨æ–‡æ¡£æ™ºèƒ½åŠ©æ‰‹ï¼Ÿä¸åŒåœºæ™¯éœ€åŒ¹é…å·®å¼‚åŒ–çš„æ£€ç´¢ç­–ç•¥ä¸è¯„ä¼°æ ‡å‡†ã€‚</p>
<p><strong>2â€Œ.å¿«é€Ÿæ„å»ºæœ€å°å¯è¡Œäº§å“</strong>ï¼ˆMVPï¼‰â€Œ</p>
<p>å·¥å…·é€‰æ‹©ï¼š</p>
<p>ç›´æ¥é‡‡ç”¨å¯è§†åŒ–å¹³å°ï¼ˆå¦‚QAnythingã€Difyã€Ragflowï¼‰é™ä½å¼€å‘é—¨æ§›</p>
<p>æˆ–é€šè¿‡LlamaIndex/LangChainæ¡†æ¶ç»“åˆFastAPI/Gradioæ­å»ºè½»é‡Demo</p>
<p>æ ¸å¿ƒéªŒè¯ç›®æ ‡ï¼š</p>
<p>æ•°æ®å¯ç”¨æ€§ã€æ£€ç´¢å‡†ç¡®ç‡ã€ç»ˆç«¯ç”¨æˆ·æ“ä½œå‹å¥½æ€§ã€å»ºç«‹æ—©æœŸè¯„ä¼°æœºåˆ¶â€Œ</p>
<p>åˆ›å»ºæ ‡å‡†åŒ–æµ‹è¯•é—®é¢˜é›†ï¼Œå®šæœŸè¿›è¡Œæ•ˆæœå›æº¯</p>
<p>å…³é”®æŒ‡æ ‡ç›‘æ§ï¼š</p>
<p>æ–‡æ¡£å¬å›ç‡ä¸ç²¾ç¡®åº¦ï¼ˆRecall/Precisionã€NDCGï¼‰</p>
<p>å›ç­”ä¸åŸæ–‡ä¸€è‡´æ€§ï¼ˆFaithfulnessï¼‰åŠå¹»è§‰æ§åˆ¶ï¼ˆCorrectnessï¼‰</p>
<p><strong>3â€Œ.æ¸è¿›å¼åŠŸèƒ½æ‰©å±•â€Œ</strong></p>
<p>å½“åœºæ™¯å¤æ‚åº¦æå‡æ—¶ï¼Œé€æ­¥é›†æˆï¼š</p>
<p>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰è‡ªåŠ¨åŒ–æµç¨‹ã€Text2SQLæ•°æ®æŸ¥è¯¢èƒ½åŠ›ã€é•¿ä¸Šä¸‹æ–‡ç†è§£æŠ€æœ¯</p>
<p>ç¤ºä¾‹åº”ç”¨ï¼šç”¨æˆ·è¯·æ±‚"åˆ†ææŸäº§å“è¿‘ä¸‰æœˆé”€å”®æ•°æ®å¹¶ç»“åˆç­–ç•¥æ–‡æ¡£è¾“å‡ºå»ºè®®"æ—¶ï¼Œå¯ç»„åˆText2SQLæ•°æ®æå–+RAGæ–‡æ¡£æ£€ç´¢+LLMç»¼åˆåˆ†æèƒ½åŠ›ã€‚</p>
<p><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[npmå‡ ä¸ªå®ç”¨å‘½ä»¤]]></title>    <link>https://juejin.cn/post/7581306080434667571</link>    <guid>https://juejin.cn/post/7581306080434667571</guid>    <pubDate>2025-12-08T12:17:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581306080434667571" data-draft-id="7581004702945132571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="npmå‡ ä¸ªå®ç”¨å‘½ä»¤"/> <meta itemprop="keywords" content="NPM,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T12:17:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="168169"/> <meta itemprop="url" content="https://juejin.cn/user/2541726614191528"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            npmå‡ ä¸ªå®ç”¨å‘½ä»¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726614191528/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    168169
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T12:17:24.000Z" title="Mon Dec 08 2025 12:17:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘æ¥åˆ°å…¬å¸å®‰å…¨å›¢é˜Ÿçš„é¡¹ç›®é£é™©è¡¨æ ¼ï¼Œåˆ—å‡ºäº†å½“å‰å‰ç«¯é¡¹ç›®çš„ä¸€äº›å®‰å…¨é£é™©ï¼Œå¤§æ¦‚æœ‰190å¤šé¡¹ï¼Œç¬¬ä¸€ä¸ªå¤§å¨æ˜¯XSSçš„ï¼Œç¬¬äºŒå¤§å¨å°±æ˜¯npmåŒ…éœ€è¦å‡çº§çš„ï¼Œçœ‹äº†ä¸‹ï¼Œéœ€è¦å‡çº§çš„å¤§æ¦‚æœ‰55ä¸ªåŒ…ï¼Œæœ€è¿‘åœ¨åšè¿™äº›åŒ…å‡çº§çš„æ—¶å€™å‘ç°äº†NPMä»¥å‰å¾ˆå°‘ç”¨ï¼Œä½†æ˜¯ç¡®æ˜¯å¾ˆå®ç”¨çš„å‡ ä¸ªå‘½ä»¤ï¼Œç‰¹è®°å½•åˆ†äº«</p>
<h2 data-id="heading-1">å®ç”¨å‘½ä»¤</h2>
<h3 data-id="heading-2">npm install package@version</h3>
<p>æ­¤å‘½ä»¤ç›¸å¯¹å…¶å®ƒè¦ä»‹ç»çš„å‡ ä¸ªå‘½ä»¤åº”è¯¥æ˜¯ä½¿ç”¨ç‡ç®—é«˜çš„ï¼Œå®ƒçš„åŠŸèƒ½å°±æ˜¯æŒ‡å®šå®‰è£…ç‰¹å®šçš„ç‰ˆæœ¬
å…ˆæ¥çœ‹ä¸€ä¸‹package.jsonç‰ˆæœ¬è§„åˆ™ç¬¦å·å¯¹æ¯”è¡¨ï¼š</p>















































<table><thead><tr><th>ç¬¦å·</th><th>ç¤ºä¾‹</th><th>å…è®¸çš„ç‰ˆæœ¬èŒƒå›´</th><th>æ ¸å¿ƒåœºæ™¯</th></tr></thead><tbody><tr><td>æ— ç¬¦å·</td><td><code>1.4.2</code></td><td>ä»… <code>1.4.2</code></td><td>ç‰ˆæœ¬æ•æ„Ÿï¼Œç¦æ­¢ä»»ä½•æ›´æ–°</td></tr><tr><td>^ï¼ˆæ’å…¥å·ï¼‰</td><td><code>^1.4.2</code></td><td>1.4.2 â†’ 1.9.9ï¼ˆä¸»ç‰ˆæœ¬ä¸å˜ï¼‰</td><td>æ—¥å¸¸ä¾èµ–ï¼Œè‡ªåŠ¨æ›´åŠŸèƒ½/ä¿®å¤</td></tr><tr><td>~ï¼ˆæ³¢æµªå·ï¼‰</td><td><code>~1.4.2</code></td><td>1.4.2 â†’ 1.4.9ï¼ˆä»…ä¿®è®¢å·æ›´æ–°ï¼‰</td><td>ä¿å®ˆæ›´æ–°ï¼Œä»…æ¥å— bug ä¿®å¤</td></tr><tr><td>&gt;/&lt;</td><td><code>&gt;=1.4.2 &lt;3.0.0</code></td><td>1.4.2 â†’ 2.9.9</td><td>ç²¾ç¡®æ§åˆ¶ç‰ˆæœ¬åŒºé—´</td></tr><tr><td>*ï¼ˆæ˜Ÿå·ï¼‰</td><td><code>1.*</code></td><td>1.0.0 â†’ 1.999.999</td><td>æ— ç‰ˆæœ¬ä¾èµ–ï¼ˆæå°‘ç”¨ï¼‰</td></tr><tr><td>!ï¼ˆæ„Ÿå¹å·ï¼‰</td><td><code>&gt;=1.4.0 !1.4.2</code></td><td>1.4.0ã€1.4.1ã€1.4.3+ï¼ˆæ’é™¤ 1.4.2ï¼‰</td><td>ç¦æ­¢æœ‰é—®é¢˜çš„ç‰ˆæœ¬</td></tr></tbody></table>
<p>å¦‚æœä½ ä½¿ç”¨æ™®é€šçš„npm install packageï¼Œé‚£å®ƒåœ¨package.jsoné‡Œå†™å…¥çš„ç‰ˆæœ¬è§„åˆ™æ˜¯ç¬¬äºŒé¡¹ï¼Œå¦‚é¡¹ç›®æœ‰lockæ–‡ä»¶çš„æ—¶å€™é—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯æ²¡æœ‰çš„æ—¶å€™ï¼Œä½ æ‰§è¡Œnpm iï¼Œå®ƒä¼šåœ¨å¯å…è®¸çš„èŒƒå›´å†…ä¸»åŠ¨æ›´æ–°ç‰ˆæœ¬ï¼Œå¦‚æœä½ ä½¿ç”¨npm install package@versionï¼Œé‚£å†™å…¥package.jsonçš„ç‰ˆæœ¬è§„åˆ™ä¼šæ˜¯ç¬¬ä¸€ç§ï¼Œæ­¤æ¬¡å®‰å…¨å›¢é˜Ÿç»™å‡ºäº†è¦æ›´æ–°åˆ°çš„æŒ‡å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥åœ¨æ­¤å¤„æˆ‘é€‰æ‹©çš„é€šè¿‡npm install package@versionæ¥å®ç°å®‰è£…æŒ‡å®šç‰ˆæœ¬å¹¶é”æ­»ç‰ˆæœ¬å·
ä½¿ç”¨ç¤ºä¾‹:</p>
<pre><code class="hljs language-css" lang="css">npm install sass<span class="hljs-keyword">@1</span>.94.2
</code></pre>
<h3 data-id="heading-3">npm ls package [--depth=0]</h3>
<p>æ­¤å‘½ä»¤ç”¨äºæŸ¥çœ‹ä½ å½“å‰é¡¹ç›®å®‰è£…çš„packageç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Œå®ƒä¼šåˆ—å‡ºå®‰è£…çš„æ‰€æœ‰çš„ç‰ˆæœ¬ï¼Œæ­¤å¤„æˆ‘ä»¬ä»¥vueåŒ…ä¸ºä¾‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-bash" lang="bash">npm <span class="hljs-built_in">ls</span> vue
</code></pre>
<p>æ§åˆ¶å°ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3263a6b1d2dd406fa3002a81d36a7844~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=w1isBF9XzT6jo3NabVLJQmShd1g%3D" alt="image.png" loading="lazy"/></p>
<p>ä»ä¸Šå›¾æˆ‘ä»¬è¿˜çœ‹åˆ°éƒ¨åˆ†åŒ…åè¿˜å¸¦æœ‰dedupedçš„ç°è‰²å­—ï¼Œè¿™ä¸ªçš„æ„æ€æ˜¯â€œå»é‡â€ çš„æ„æ€ï¼Œæ˜¯ de-duplicated çš„ç¼©å†™ï¼Œä»£è¡¨è¿™ä¸ªåŒ…æ˜¯ â€œé‡å¤ä¾èµ–è¢«åˆå¹¶åï¼Œå¤ç”¨äº†å·²å®‰è£…çš„ç‰ˆæœ¬â€ï¼Œæ ¸å¿ƒæ˜¯ npm ä¼˜åŒ–ä¾èµ–æ ‘çš„ä¸€ç§æœºåˆ¶ï¼Œå½“é¡¹ç›®ä¸­å¤šä¸ªä¾èµ–åŒæ—¶éœ€è¦åŒä¸€ä¸ªåŒ…ï¼ˆä¸”ç‰ˆæœ¬å…¼å®¹ï¼‰æ—¶ï¼Œnpm ä¼šè‡ªåŠ¨æŠŠé‡å¤çš„åŒ…åˆå¹¶åˆ°ä¾èµ–æ ‘çš„æ›´ä¸Šå±‚ï¼ˆæ¯”å¦‚æ ¹ç›®å½•çš„ node_modulesï¼‰ï¼Œé¿å…é‡å¤å®‰è£…ã€‚æ­¤æ—¶åœ¨ npm ls ä¸­ï¼Œè¢«åˆå¹¶çš„é‡å¤åŒ…å°±ä¼šæ ‡æ³¨ dedupedï¼Œè¡¨ç¤º â€œè¿™ä¸ªåŒ…æ²¡å•ç‹¬è£…ï¼Œè€Œæ˜¯å¤ç”¨äº†å…¶ä»–åœ°æ–¹å·²æœ‰çš„ç‰ˆæœ¬â€
ä¸Šé¢å‘½ä»¤è¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°å°±æ˜¯--depthï¼Œæ§åˆ¶ä¾èµ–æ ‘çš„æ˜¾ç¤ºå±‚çº§ï¼Œé¿å…é»˜è®¤npm lsè¾“å‡ºè¿‡äºå†—é•¿ï¼Œç”¨çš„ä¸å¤šï¼Œçœ‹äºŒä¸ªä¾‹å­:</p>
<ul>
<li>npm ls vue --depth=0 åªæ˜¾ç¤ºé¡¹ç›®ç›´æ¥ä¾èµ–ï¼ˆä¸æ˜¾ç¤ºå­ä¾èµ–ï¼‰</li>
<li>npm ls vue --depth=1 æ˜¾ç¤ºç›´æ¥ä¾èµ– + ä¸€çº§å­ä¾èµ–</li>
</ul>
<h3 data-id="heading-4">npm explain package</h3>
<p>ç²¾å‡†è§£é‡ŠæŸä¸ªåŒ…è¢«å®‰è£…çš„åŸå› ï¼ˆè°ä¾èµ–å®ƒã€ä¾èµ–ç‰ˆæœ¬èŒƒå›´ã€å®‰è£…è·¯å¾„ï¼‰ï¼Œè§£å†³ã€Œæ˜æ˜æ²¡æ‰‹åŠ¨å®‰è£…ï¼Œå´å‡ºç°åœ¨node_modulesã€çš„å›°æƒ‘ï¼Œä¸ªäººæ„Ÿè§‰è¿™ä¸ªå‘½ä»¤å’Œä¸Šé¢lsæœ‰ä¸€ç‚¹ç›¸ä¼¼ï¼Œéƒ½å¯ä»¥æŸ¥çœ‹å½“å‰åŒ…å®‰è£…äº†ä»€ä¹ˆç‰ˆæœ¬ï¼Œå“ªä¸€ä¸ªç‰ˆæœ¬è¢«å®‰è£…æ˜¯å› ä¸ºå“ªä¸€ä¸ªä¾èµ–ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥vueåŒ…æ¥ä¾‹</p>
<pre><code class="hljs">npm explain vue
</code></pre>
<p>åœ¨å‘½ä»¤è¡Œçœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf2fbe6f705d461f888f45462e4ab6ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=CMAirSEB3xBk0UZtjcQe3D7IsOc%3D" alt="image1.png" loading="lazy"/></p>
<h3 data-id="heading-5">npm view package [version[s]]</h3>
<p>æ­¤å‘½ä»¤å°±æ˜¯æŸ¥çœ‹packageåŒ…çº¿ä¸Šå¯ç”¨çš„ç‰ˆæœ¬,åˆ†å¸¦versiontå’Œä¸å¸¦versionï¼Œversionåˆæœ‰åˆ†å¸¦ä¸å¸¦sï¼Œ</p>
<ul>
<li>ä¸å¸¦version,ä»npmå®˜æ–¹ä»“åº“ï¼ˆæˆ–å½“å‰é…ç½®çš„é•œåƒæºï¼‰ä¸­æŸ¥è¯¢vueåŒ…çš„å…¬å¼€ä¿¡æ¯</li>
<li>å¸¦versionï¼Œå¹¶ä¸”å¸¦så°±æ˜¯åˆ—å‡ºæ‰€æœ‰å¯ç”¨å†å²ç‰ˆæœ¬</li>
<li>å¸¦versionï¼Œä¸å¸¦så°±æ˜¯å½“å‰æœ€æ–°çš„ç¨³å®šå¯ç”¨ç‰ˆæœ¬
æ­¤å¤„æˆ‘ä»¬è¿˜æ˜¯ä»¥vueåŒ…ä¸ºä¾‹ï¼š</li>
</ul>

<pre><code class="hljs language-sql" lang="sql">npm <span class="hljs-keyword">view</span> vue
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30e1d98a707a4d3891d2cdfc53d506ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=aWOXRRjIVZn3NlIuHZnIdh2R9Nc%3D" alt="image2.png" loading="lazy"/></p>
<p>æ­¤å‘½ä»¤è¿˜å¯ä»¥æŒ‡å®šç‰ˆæœ¬å·ï¼Œä½¿ç”¨æ–¹å¼æ˜¯npm view vue@versionï¼Œå°±æ˜¯æŸ¥çœ‹æŒ‡å®šç‰ˆæœ¬çš„å…¬å¼€ä¿¡æ¯ï¼Œè¿™ä¸ªå‘½ä»¤ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯åœ¨å‘½ä»¤è¡Œä¸­æ‰“å¼€vueåŒ…çš„npmç®€ç‰ˆè¯¦æƒ…é¡µ</p>
<pre><code class="hljs language-sql" lang="sql">npm <span class="hljs-keyword">view</span> vue versions
</code></pre>
<p>æ§åˆ¶å°ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/035b66367b03477d9291856eb03f8021~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=eNN4aWAfHbUsNi6m5TKx5%2Fzse24%3D" alt="image3.png" loading="lazy"/></p>
<p>å¦‚æœä¸å¸¦s,æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc5508b76ed44c06a5c9a06aef98fd81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=jvEfLTbhDd5yUJGy6voe%2FOOgkGE%3D" alt="image4.png" loading="lazy"/></p>
<h3 data-id="heading-6">npm view package[@version] dependencies [--json]</h3>
<p>æ­¤å‘½ä»¤å°±æ˜¯ä¸Šé¢npm viewçš„å¦ä¸€ç§ç”¨æ³•ï¼Œå®ƒå¯ä»¥æŸ¥çœ‹å½“å‰åŒ…å½“æŒ‡ç‰ˆæœ¬çš„ç”Ÿäº§ä¾èµ–å’Œå¼€å‘ä¾èµ–ï¼Œä¸ºä»€ä¹ˆå•æå‡ºæ¥è¯´äº†ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯æˆ‘è¿™ä¸€æ¬¡ç”¨çš„æœ€å¤šçš„å‘½ä»¤ï¼Œå› ä¸ºå®‰å…¨å›¢é˜Ÿç»™çš„éœ€è¦ä½ åšå‡çº§çš„åŒ…é‡Œï¼Œå®ƒå¹¶ä¸æ˜¯å½“å‰é¡¹ç›®çš„ç›´æ¥ä¾èµ–ï¼Œå¾ˆå¤šéƒ½æ˜¯äºŒçº§æˆ–è€…ä¸‰çº§ä¾èµ–ï¼Œå¦‚æœä½ è¦å‡ä¸‰çº§ä¾èµ–ï¼Œé‚£ä½ å°±å¾—å»æŸ¥çœ‹ç¥–å…ˆçº§åŒ…å“ªä¸€ä¸ªç‰ˆæœ¬å¯ä»¥è®©ä½ è¿™ä¸ªä¾èµ–å‡çº§ï¼Œå•æå‡ºæ¥çš„å¦ä¸€ä¸ªåŸå› æ˜¯å®ƒè¿˜æœ‰ä¸€ä¸ªåœ¨çº¿webå·¥å…·
æ­¤å¤„æˆ‘ä»¬è¿˜æ˜¯ä»¥vueåŒ…ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">npm <span class="hljs-keyword">view</span> vue dependencies <span class="hljs-comment">--json</span>
</code></pre>
<p>å‘½ä»¤è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64002b044c1043488946ef7428947ce0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=4Ho8Moa1aKmKhQ2HFKqomd2FUNM%3D" alt="image5.png" loading="lazy"/></p>
<p>å®ƒæœ‰åœ¨çº¿ç‰ˆæœ¬ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnpmgraph.js.org%2F" target="_blank" title="https://npmgraph.js.org/" ref="nofollow noopener noreferrer">npmgraph.js.org/</a>
ä½¿ç”¨ä½“éªŒå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc8c666eb5b940e284c4306b9ab22879~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801044&amp;x-signature=nHeujxPXjIOQtjCbyZgToKIWzFE%3D" alt="image6.png" loading="lazy"/></p>
<p>ä¸€å¼€å§‹æˆ‘æ˜¯ä½¿ç”¨ä¸Šåœ¨å‘½ä»¤è¡ŒæŸ¥çœ‹çš„ï¼Œåé¢å‘ç°è¿™ä¸ªåœ¨çº¿çš„å·¥å…·åï¼Œå°±ä½¿ç”¨çš„éƒ½æ˜¯è¿™ä¸ªåœ¨çº¿çš„å·¥å…·äº†ï¼Œé¡ºä¾¿è¯´ä¸ªé¢˜å¤–è¯ï¼Œå¦‚æœåŒæ ·çš„åŠŸèƒ½å¯ä»¥é€šè¿‡cliæ¥ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡GUIæ¥ç”¨ï¼Œä½ é€šå¸¸ä¼šé€‰æ‹©å“ªä¸€ä¸ªæ¥ç”¨äº†ï¼Ÿå½“ç„¶ï¼Œæˆ‘æ˜¯åè€…ï¼Œä½ äº†ï¼Ÿ</p>
<h2 data-id="heading-7">å°ç»“</h2>
<p>å¯¹äºåšå‰ç«¯å¼€å‘çš„æˆ‘ä»¬åŸºæœ¬æ¯å¤©éƒ½æœ‰åœ¨ç”¨NPMå‘½ä»¤ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šå¥½ç”¨çš„åŠŸèƒ½æ˜¯æ²¡æœ‰å‘ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´éƒ½å¾ˆæ•¬ç•æŠ€æœ¯ï¼Œå°±åƒæˆ‘å†™ä¸ªäººç®€å†æˆ‘è§‰å¾—æˆ‘è‡ªå·±æŒæ¡äº†çš„æŠ€æœ¯æˆ‘æ•¢ç”¨çš„äºŒä¸ªå­—å°±æ˜¯ç†Ÿç»ƒï¼Œä»æ¥ä¸æ•¢ç”¨ç²¾é€šï¼Œå› ä¸ºç²¾é€šä¸€ä¸ªä¸œè¥¿çœŸçš„ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„
ä¸ªäººçš„çŸ¥è¯†å’Œèƒ½åŠ›æ˜¯æœ‰é™åº¦ï¼Œä½ åœ¨ä½¿ç”¨npmçš„æ—¶å€™æœ‰æ²¡æœ‰å‘ç°å…¶å®ƒçš„ä¸€äº›å¥½ç”¨çš„ä½†æ˜¯ä½¿ç”¨ä¸å¤ªé«˜é¢‘çš„åŠŸèƒ½ï¼ŒæœŸå¾…ä½ çš„ç•™è¨€åˆ†äº«ï¼Œä¸€èµ·å­¦ä¹ ä¸€èµ·è¿›æ­¥</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®ä¼šè¯´è°ï¼Ÿä¸‰å¤§æ¨æ–­æ–¹æ³•å¸®ä½ â€œå®¡é—®â€æ•°æ®çœŸç›¸]]></title>    <link>https://juejin.cn/post/7581097111896571958</link>    <guid>https://juejin.cn/post/7581097111896571958</guid>    <pubDate>2025-12-08T12:26:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097111896571958" data-draft-id="7581117416811610155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" æ•°æ®ä¼šè¯´è°ï¼Ÿä¸‰å¤§æ¨æ–­æ–¹æ³•å¸®ä½ â€œå®¡é—®â€æ•°æ®çœŸç›¸"/> <meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ,åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T12:26:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             æ•°æ®ä¼šè¯´è°ï¼Ÿä¸‰å¤§æ¨æ–­æ–¹æ³•å¸®ä½ â€œå®¡é—®â€æ•°æ®çœŸç›¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T12:26:42.000Z" title="Mon Dec 08 2025 12:26:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¤šåˆšå…¥è¡Œç”šè‡³æƒ³å…¥è¡Œæ•°æ®åˆ†æçš„æœ‹å‹ï¼Œå¾€å¾€ä¼šé™·å…¥ä¸€ä¸ª<strong>è¯¯åŒº</strong>ï¼šä»¥ä¸ºæ•°æ®åˆ†æå°±æ˜¯ä¸åœåœ°<strong>åšæŠ¥è¡¨</strong>ã€<strong>ç”»é¥¼å›¾</strong>ã€‚</p>
<p>å…¶å®ï¼Œæ•°æ®åˆ†æçš„æ ¸å¿ƒé­…åŠ›åœ¨äº <strong>â€œæ¨æ–­â€â€”â€”å³è§å¾®çŸ¥è‘—</strong>ã€‚</p>
<p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾è·å–â€œå…¨é‡æ•°æ®â€ï¼ˆæ¯”å¦‚ä½ ä¸å¯èƒ½è°ƒæŸ¥å…¨å›½æ¯ä¸€ä¸ªäººçš„èº«é«˜ï¼‰ï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•é€šè¿‡æ‰‹ä¸­çš„â€œå°æ ·æœ¬â€å»æ¨æµ‹â€œå¤§æ€»ä½“â€çš„è§„å¾‹ï¼Ÿ</p>
<p>è¿™å°±éœ€è¦ç”¨åˆ°ç»Ÿè®¡å­¦ä¸­çš„<strong>æ¨æ–­åˆ†æ</strong>ã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆä»£ç æ¥ä»‹ç»<strong>æ¨æ–­åˆ†æ</strong>ä¸­æœ€å¸¸ç”¨çš„ä¸‰å¤§æ–¹æ³•ï¼š<strong>å‚æ•°ä¼°è®¡</strong>ã€<strong>å‡è®¾æ£€éªŒ</strong>ã€<strong>éå‚æ•°æ£€éªŒ</strong>ã€‚</p>
<h2 data-id="heading-0">1. å‚æ•°ä¼°è®¡</h2>
<p>æƒ³è±¡ä½ åœ¨ç…®ä¸€é”…æ’éª¨æ±¤ã€‚ä½ æƒ³çŸ¥é“æ±¤å’¸ä¸å’¸ï¼Œä½ ä¸ä¼šæŠŠæ•´é”…æ±¤éƒ½å–å®Œï¼Œè€Œæ˜¯èˆ€èµ·ä¸€å‹ºå°ä¸€å°ã€‚</p>
<ul>
<li>é‚£ä¸€å‹ºæ±¤å°±æ˜¯<strong>æ ·æœ¬</strong>ã€‚</li>
<li>é‚£ä¸€å‹ºçš„å’¸åº¦å°±æ˜¯<strong>æ ·æœ¬ç»Ÿè®¡é‡</strong>ã€‚</li>
<li>æ•´é”…æ±¤çš„å’¸åº¦å°±æ˜¯æˆ‘ä»¬è¦çŒœçš„<strong>æ€»ä½“å‚æ•°</strong>ã€‚</li>
</ul>
<p><strong>å‚æ•°ä¼°è®¡</strong>å°±æ˜¯ï¼šæ ¹æ®æ ·æœ¬çš„ç‰¹å¾ï¼ˆæ¯”å¦‚<strong>æ ·æœ¬å‡å€¼</strong>ï¼‰ï¼Œå»ä¼°è®¡æ€»ä½“çš„ç‰¹å¾ï¼ˆæ¯”å¦‚<strong>æ€»ä½“å‡å€¼</strong>ï¼‰ã€‚</p>
<p>å®ƒé€šå¸¸åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li><strong>ç‚¹ä¼°è®¡</strong>ï¼šç›´æ¥è¯´â€œè¿™é”…æ±¤æ˜¯1.5%çš„ç›åº¦â€ã€‚ï¼ˆä½†è¿™å¾ˆå®¹æ˜“è¢«æ‰“è„¸ï¼Œå› ä¸ºå¤ªç»å¯¹ï¼‰</li>
<li><strong>åŒºé—´ä¼°è®¡</strong>ï¼šè¯´â€œè¿™é”…æ±¤çš„ç›åº¦åœ¨1.4%åˆ°1.6%ä¹‹é—´ï¼Œæˆ‘æœ‰95%çš„æŠŠæ¡â€ã€‚ï¼ˆè¿™å°±æ˜¯ç½®ä¿¡åŒºé—´ï¼Œæ›´ç§‘å­¦ï¼‰</li>
</ul>
<p><strong>åŒºé—´ä¼°è®¡</strong>æ˜¯æœ€å¸¸ä½¿ç”¨çš„æ–¹å¼ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥æ¼”ç¤º<strong>å‚æ•°ä¼°è®¡</strong>çš„å…·ä½“ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> stats

<span class="hljs-comment"># 1. æ¨¡æ‹Ÿæ•°æ®</span>
np.random.seed(<span class="hljs-number">42</span>)
true_mean = <span class="hljs-number">15</span>  <span class="hljs-comment"># ä¸Šå¸è§†è§’çš„çœŸå®å‡å€¼</span>
sample_salaries = np.random.normal(loc=true_mean, scale=<span class="hljs-number">3</span>, size=<span class="hljs-number">100</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿ100ä¸ªæ ·æœ¬</span>

<span class="hljs-comment"># 2. è®¡ç®—ç»Ÿè®¡é‡</span>
sample_mean = np.mean(sample_salaries)
sample_std = np.std(sample_salaries, ddof=<span class="hljs-number">1</span>)
n = <span class="hljs-built_in">len</span>(sample_salaries)

<span class="hljs-comment"># è®¡ç®—95%ç½®ä¿¡åŒºé—´</span>
<span class="hljs-comment"># è¿™é‡Œçš„ scale ä½¿ç”¨çš„æ˜¯æ ‡å‡†è¯¯ (Standard Error) = æ ·æœ¬æ ‡å‡†å·® / sqrt(n)</span>
conf_int = stats.t.interval(
    confidence=<span class="hljs-number">0.95</span>, df=n - <span class="hljs-number">1</span>, loc=sample_mean, scale=sample_std / np.sqrt(n)
)
lower_bound, upper_bound = conf_int

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ·æœ¬å‡å€¼: <span class="hljs-subst">{sample_mean:<span class="hljs-number">.2</span>f}</span>k"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"95%ç½®ä¿¡åŒºé—´: [<span class="hljs-subst">{lower_bound:<span class="hljs-number">.2</span>f}</span>k, <span class="hljs-subst">{upper_bound:<span class="hljs-number">.2</span>f}</span>k]"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ ·æœ¬å‡å€¼: 14.69k
95%ç½®ä¿¡åŒºé—´: [14.15k, 15.23k]
'''</span>
</code></pre>
<p>å›¾å½¢åŒ–ä¹‹åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2485481dfd374b6f958cd86bf1d60464~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801601&amp;x-signature=jHE5ZnE12Qk9cAi9MC1r1J64vjU%3D" alt="" loading="lazy"/></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼š</p>
<ol>
<li><strong>ç°è‰²çš„æ•£ç‚¹</strong>ï¼šæ˜¯ä½ è°ƒç ”çš„é‚£100ä¸ªæ•°æ®åˆ†æå¸ˆçš„å·¥èµ„ã€‚ä½ ä¼šå‘ç°æœ‰çš„é«˜æœ‰çš„ä½ï¼Œæ•£è½åœ¨å„åœ°ã€‚</li>
<li><strong>è“è‰²çš„ç‚¹å’Œæ¨ªçº¿</strong>ï¼š</li>
</ol>
<ul>
<li><strong>è“ç‚¹</strong>æ˜¯ä½ ç®—å‡ºæ¥çš„æ ·æœ¬å‡å€¼ï¼ˆçº¦14.67kï¼‰ï¼Œè™½ç„¶ä¸å®Œå…¨ç­‰äºçœŸå®çš„15kï¼Œä½†å¾ˆæ¥è¿‘ã€‚</li>
<li><strong>è“è‰²çš„æ¨ªçº¿</strong>å°±æ˜¯ç½®ä¿¡åŒºé—´ã€‚å®ƒçš„å«ä¹‰æ˜¯ï¼šâ€œè™½ç„¶æˆ‘ä¸çŸ¥é“ç¡®åˆ‡æ•°å­—ï¼Œä½†æˆ‘æ•¢æ‰“èµŒï¼ŒçœŸå®æ•°å­—å°±åœ¨è¿™æ ¹è“çº¿çš„èŒƒå›´å†…ã€‚â€</li>
</ul>
<ol start="3">
<li><strong>çº¢è‰²çš„è™šçº¿</strong>ï¼šè¿™æ˜¯çœŸå®çš„æ€»ä½“å‡å€¼ï¼ˆ15kï¼‰ã€‚</li>
<li><strong>ç»“è®º</strong>ï¼šä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œçº¢è‰²çš„è™šçº¿ç¡®å®ç©¿è¿‡äº†è“è‰²çš„æ¨ªçº¿ã€‚æ­å–œä½ ï¼è¿™æ¬¡â€œå‚æ•°ä¼°è®¡â€æˆåŠŸæ•è·äº†çœŸç†ï¼</li>
</ol>
<p>æ•°æ®åˆ†æä¸æ˜¯ç®—å‘½ï¼Œç®—å‡ºæ¥çš„ä¸æ˜¯ä¸€ä¸ªæ­»çš„æ•°å­—ï¼Œè€Œæ˜¯ä¸€ä¸ªç§‘å­¦çš„èŒƒå›´ã€‚</p>
<p>æˆ‘ä»¬å°±æ˜¯ç”¨<strong>å‚æ•°ä¼°è®¡</strong>çš„æ–¹æ³•ï¼Œåœ¨ä¸ç¡®å®šæ€§ä¸­å¯»æ‰¾ç¡®å®šæ€§ã€‚</p>
<h2 data-id="heading-1">2. å‡è®¾æ£€éªŒ</h2>
<p><strong>å‡è®¾æ£€éªŒ</strong>æ˜¯æ•°æ®åˆ†æä¸­æœ€å¸¸ç”¨çš„å†³ç­–å·¥å…·ã€‚å®ƒçš„é€»è¾‘æ˜¯ï¼š<strong>å…ˆç«‹ä¸€ä¸ªFlagï¼ˆå‡è®¾ï¼‰ï¼Œç„¶åçœ‹è¯æ®ï¼ˆæ•°æ®ï¼‰æ˜¯å¦æ‰“è„¸</strong>ã€‚</p>
<ul>
<li><strong>åŸå‡è®¾</strong> ï¼šé€šå¸¸ä»£è¡¨â€œæ— äº‹å‘ç”Ÿâ€ã€â€œæ²¡æœ‰å˜åŒ–â€ã€â€œè¿æ°”å¥½â€ã€‚</li>
<li><strong>å¤‡æ‹©å‡è®¾</strong>ï¼šé€šå¸¸ä»£è¡¨â€œæœ‰äº‹å‘ç”Ÿâ€ã€â€œçœŸçš„æœ‰æ•ˆæœâ€ã€‚</li>
<li><strong>På€¼</strong>ï¼šè¡¨ç¤ºåŸå‡è®¾æˆç«‹æ—¶ï¼Œå‡ºç°å½“å‰æ•°æ®çš„æ¦‚ç‡ã€‚På€¼è¶Šå°ï¼Œè¯´æ˜åŸå‡è®¾è¶Šä¸é è°±ï¼ˆé€šå¸¸ä»¥0.05ä¸ºç•Œé™ï¼‰ã€‚</li>
</ul>
<p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªç”µå•†APPçš„A/Bæµ‹è¯•åœºæ™¯ï¼Œæ¥æ¼”ç¤º<strong>å‡è®¾æ£€éªŒ</strong>çš„ä½¿ç”¨ã€‚</p>
<p>å‡è®¾æŸç”µå•†APPæƒ³æŠŠ <strong>â€œè´­ä¹°â€</strong> æŒ‰é’®ä» <strong>è“è‰²</strong> æ”¹æˆ <strong>çº¢è‰²</strong> ã€‚</p>
<ul>
<li><strong>åŸå‡è®¾</strong>ï¼šçº¢è‰²æŒ‰é’®å’Œè“è‰²æŒ‰é’®çš„è½¬åŒ–ç‡æ²¡åŒºåˆ«ï¼ˆå·®åˆ«çº¯å±å¶ç„¶ï¼‰ã€‚</li>
<li><strong>å¤‡æ‹©å‡è®¾</strong>ï¼šçº¢è‰²æŒ‰é’®çš„è½¬åŒ–ç‡æ˜¾è‘—é«˜äºè“è‰²æŒ‰é’®ã€‚</li>
</ul>
<p>æˆ‘ä»¬é‡‡é›†äº†ä¸¤ç»„ç”¨æˆ·çš„æ¶ˆè´¹é‡‘é¢æ•°æ®æ¥è¿›è¡ŒTæ£€éªŒã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. æ¨¡æ‹ŸABæµ‹è¯•æ•°æ®</span>
<span class="hljs-comment"># è“è‰²æŒ‰é’®ç»„ï¼ˆå¯¹ç…§ç»„ï¼‰ï¼šå¹³å‡æ¶ˆè´¹ 100å…ƒ</span>
group_blue = np.random.normal(loc=<span class="hljs-number">100</span>, scale=<span class="hljs-number">20</span>, size=<span class="hljs-number">1000</span>)
<span class="hljs-comment"># çº¢è‰²æŒ‰é’®ç»„ï¼ˆå®éªŒç»„ï¼‰ï¼šå¹³å‡æ¶ˆè´¹ 105å…ƒ (æˆ‘ä»¬è¦æ£€éªŒè¿™ä¸ªæå‡æ˜¯å¦æ˜¾è‘—)</span>
group_red = np.random.normal(loc=<span class="hljs-number">105</span>, scale=<span class="hljs-number">25</span>, size=<span class="hljs-number">1000</span>)

<span class="hljs-comment"># 2. è¿›è¡Œç‹¬ç«‹æ ·æœ¬Tæ£€éªŒ (T-test)</span>
t_stat, p_val = stats.ttest_ind(group_blue, group_red)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"På€¼: <span class="hljs-subst">{p_val:<span class="hljs-number">.5</span>f}</span>"</span>)

<span class="hljs-comment"># 3. åˆ¤æ–­ç»“è®º</span>
alpha = <span class="hljs-number">0.05</span>
<span class="hljs-keyword">if</span> p_val &lt; alpha:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç»“è®ºï¼šæ‹’ç»åŸå‡è®¾ã€‚çº¢è‰²æŒ‰é’®å¸¦æ¥çš„æ¶ˆè´¹æå‡æ˜¯ã€ç»Ÿè®¡æ˜¾è‘—ã€‘çš„ï¼Œå»ºè®®å…¨é‡ä¸Šçº¿ï¼"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç»“è®ºï¼šæ— æ³•æ‹’ç»åŸå‡è®¾ã€‚ä¸¤ç»„å·®å¼‚å¯èƒ½æ˜¯è¯¯å·®å¯¼è‡´çš„ï¼Œå»ºè®®ç»´æŒåŸçŠ¶ã€‚"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
På€¼: 0.00000
ç»“è®ºï¼šæ‹’ç»åŸå‡è®¾ã€‚çº¢è‰²æŒ‰é’®å¸¦æ¥çš„æ¶ˆè´¹æå‡æ˜¯ã€ç»Ÿè®¡æ˜¾è‘—ã€‘çš„ï¼Œå»ºè®®å…¨é‡ä¸Šçº¿ï¼
'''</span>
</code></pre>
<p>å›¾å½¢åŒ–ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/007a998a5b334cc1983d927a81d5cb52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801601&amp;x-signature=m5GveoNuTzkuYjkksK1WM8NmpFY%3D" alt="" loading="lazy"/></p>
<p>ä»å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä¸¤æ¡æ›²çº¿ï¼ˆçº¢è‰²å’Œè“è‰²ï¼‰å…¶å®é‡å åº¦å¾ˆé«˜ã€‚</p>
<p>å¯¹äºæ–°æ‰‹ï¼Œçœ‹åˆ°è¿™ä¸ªå›¾ï¼Œå¯èƒ½ä¼šé™·å…¥ä¸€ä¸ªè¯¯åŒºï¼Œè§‰å¾—â€œè¿™ä¸¤åº§å±±å³°çœ‹èµ·æ¥å·®ä¸å¤šå˜›ï¼Œæ²¡å•¥åŒºåˆ«â€ã€‚</p>
<p>ä½†åœ¨ç»Ÿè®¡å­¦ä¸Šï¼Œä¸¤åº§å±±å³°çš„ <strong>â€œé‡å¿ƒâ€</strong> ï¼ˆå‡å€¼ï¼‰å‘ç”Ÿäº† <strong>æ˜¾è‘—åç§»</strong> ã€‚è¿™å°±æ˜¯å‡è®¾æ£€éªŒçš„å¨åŠ›--åœ¨é‡å çš„å™ªå£°ä¸­è¯†åˆ«å‡ºåç§»çš„ä¿¡å·ã€‚</p>
<h2 data-id="heading-2">3. éå‚æ•°ä¼°è®¡</h2>
<p>å‰é¢çš„ <strong>â€œå‚æ•°ä¼°è®¡â€</strong> å’Œ <strong>â€œTæ£€éªŒâ€</strong> éƒ½æœ‰ä¸€ä¸ªå¨‡æ°”çš„è„¾æ°”ï¼šå®ƒä»¬é€šå¸¸å‡è®¾æ•°æ®æ˜¯æœä» <strong>â€œæ­£æ€åˆ†å¸ƒâ€</strong> çš„ï¼ˆä¹Ÿå°±æ˜¯æ¼‚äº®çš„é’Ÿå½¢æ›²çº¿ï¼‰ã€‚</p>
<p>ä½†åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¾ˆå¤šæ•°æ®å¹¶ä¸æ­£æ€ï¼Œæˆ–è€…æ•°æ®ç”šè‡³æ˜¯å®šåºçš„ï¼ˆæ¯”å¦‚ï¼šéå¸¸æ»¡æ„ã€æ»¡æ„ã€ä¸€èˆ¬ã€ä¸æ»¡æ„ï¼‰ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œä¼ ç»Ÿçš„ <strong>Tæ£€éªŒ</strong> å°±å¤±æ•ˆäº†ï¼Œæˆ‘ä»¬éœ€è¦è¯·å‡º <strong>éå‚æ•°æ£€éªŒ</strong> ã€‚</p>
<p>å®ƒä¸ä¾èµ–æ•°æ®çš„åˆ†å¸ƒå½¢çŠ¶ï¼Œéå¸¸æŠ—é€ ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦å¯¹æ¯”ä¸¤æ¬¾æ‰‹æ¸¸ã€Šç‹è€…è£è€€ã€‹å’Œã€ŠåŸç¥ã€‹ç©å®¶æ¯å¤©çš„æ¸¸ç©æ—¶é•¿ã€‚</p>
<p>ç”±äºã€ŠåŸç¥ã€‹ç©å®¶å¯èƒ½å­˜åœ¨å¤§é‡çš„â€œé•¿å°¾â€ç”¨æˆ·ï¼ˆç©ç‰¹åˆ«ä¹…ï¼‰ï¼Œæ•°æ®å¾€å¾€æ˜¯ä¸¥é‡å³åçš„ï¼Œä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚</p>
<p>è¿™æ—¶å€™å¯¹æ¯”ä¸¤ç»„æ•°æ®å·®å¼‚ï¼Œå°±ä¸èƒ½ç”¨<strong>Tæ£€éªŒ</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>éå‚æ•°ä¼°è®¡</strong>ä¸­çš„ä¸€ç§æ–¹å¼ï¼šæ›¼-æƒ ç‰¹å°¼Uæ£€éªŒ (Mann-Whitney U test)ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. æ¨¡æ‹Ÿéæ­£æ€åˆ†å¸ƒæ•°æ® (ä½¿ç”¨æŒ‡æ•°åˆ†å¸ƒæ¨¡æ‹Ÿç”±åæ•°æ®)</span>
<span class="hljs-comment"># æ¸¸æˆAï¼šå¹³å‡æ—¶é•¿è¾ƒçŸ­</span>
game_a_hours = np.random.exponential(scale=<span class="hljs-number">1.0</span>, size=<span class="hljs-number">100</span>)
<span class="hljs-comment"># æ¸¸æˆBï¼šå¹³å‡æ—¶é•¿è¾ƒé•¿</span>
game_b_hours = np.random.exponential(scale=<span class="hljs-number">1.5</span>, size=<span class="hljs-number">100</span>)

<span class="hljs-comment"># 2. é¦–å…ˆï¼Œæ£€æŸ¥ä¸€ä¸‹æ­£æ€æ€§ (Shapiro-Wilkæ£€éªŒ)</span>
<span class="hljs-comment"># å¦‚æœP &lt; 0.05ï¼Œè¯´æ˜ä¸æ˜¯æ­£æ€åˆ†å¸ƒ</span>
_, p_norm_a = stats.shapiro(game_a_hours)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¸¸æˆAæ­£æ€æ€§æ£€éªŒPå€¼: <span class="hljs-subst">{p_norm_a:<span class="hljs-number">.4</span>f}</span> (å°äº0.05åˆ™éæ­£æ€)"</span>)

<span class="hljs-comment"># 3. ä½¿ç”¨éå‚æ•°æ£€éªŒï¼šMann-Whitney Uæ£€éªŒ</span>
<span class="hljs-comment"># å®ƒå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬çš„åˆ†å¸ƒæ˜¯å¦å­˜åœ¨å·®å¼‚ï¼ˆä¾§é‡äºä¸­ä½æ•°/ç§©æ¬¡çš„æ¯”è¾ƒï¼‰</span>
u_stat, p_val_nonparam = stats.mannwhitneyu(game_a_hours, game_b_hours, alternative=<span class="hljs-string">'two-sided'</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Mann-Whitney Uæ£€éªŒ På€¼: <span class="hljs-subst">{p_val_nonparam:<span class="hljs-number">.5</span>f}</span>"</span>)

<span class="hljs-keyword">if</span> p_val_nonparam &lt; <span class="hljs-number">0.05</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç»“è®ºï¼šä¸¤æ¬¾æ¸¸æˆçš„ç©å®¶æ¸¸ç©æ—¶é•¿åˆ†å¸ƒå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç»“è®ºï¼šä¸¤æ¬¾æ¸¸æˆç©å®¶æ¸¸ç©æ—¶é•¿æ— æ˜¾è‘—å·®å¼‚ã€‚"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ¸¸æˆAæ­£æ€æ€§æ£€éªŒPå€¼: 0.0000 (å°äº0.05åˆ™éæ­£æ€)
Mann-Whitney Uæ£€éªŒ På€¼: 0.00003
ç»“è®ºï¼šä¸¤æ¬¾æ¸¸æˆçš„ç©å®¶æ¸¸ç©æ—¶é•¿åˆ†å¸ƒå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚
'''</span>
</code></pre>
<p>å¯è§†åŒ–ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93946f2319514f0799b428ff9ce98157~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801601&amp;x-signature=YIoZEwYKr5SHRNZpgn1OoZhSI24%3D" alt="" loading="lazy"/></p>
<p>å°½ç®¡æ•°æ®é•¿å¾—æ­ªç“œè£‚æ£ï¼ˆä¸¥é‡å³åï¼‰ï¼Œ<strong>Uæ£€éªŒ</strong>ä¾ç„¶ç¨³å¥åœ°å‘Šè¯‰æˆ‘ä»¬ï¼š<strong>è¿™ä¸¤ç»„æ•°æ®ä¸ä¸€æ ·</strong>ã€‚</p>
<p><strong>Uæ£€éªŒ</strong>æ¯”è¾ƒçš„ä¸ä»…ä»…æ˜¯å¹³å‡å€¼ï¼Œå®ƒæ›´å¤šæ˜¯åœ¨æ¯”è¾ƒ <strong>â€œç§©æ¬¡â€</strong>ï¼ˆ<code>Ranking</code>ï¼‰ã€‚</p>
<p>é€šä¿—ç‚¹è¯´ï¼Œå®ƒå‘ç°å¦‚æœæˆ‘ä»¬æŠŠä¸¤ç»„ç©å®¶æ··åœ¨ä¸€èµ·æ’åï¼Œ<code>Game B</code>çš„ç©å®¶å³ä½¿ä¸çœ‹å…·ä½“æ—¶é•¿ï¼Œæ’åä¹Ÿæ™®éæ¯”<code>Game A</code>çš„ç©å®¶é å‰ã€‚</p>
<p>ä»å›¾ä¸­æ¥çœ‹ï¼Œä½ ä¼šçœ‹åˆ°æ©™è‰²ï¼ˆ<code>Game B</code>ï¼‰çš„å°¾å·´æ˜æ˜¾æ¯”è“è‰²ï¼ˆ<code>Game A</code>ï¼‰æ‹–å¾—æ›´é•¿ã€æ›´åšå®ã€‚</p>
<p>è¿™è¯´æ˜<code>Game B</code>ï¼ˆæ¯”å¦‚ã€ŠåŸç¥ã€‹ï¼‰æ›´å®¹æ˜“è®©ç©å®¶æ²‰æµ¸æ›´ä¹…ï¼Œæˆ–è€…æ‹¥æœ‰æ›´å¤šçš„é‡åº¦ç©å®¶ã€‚</p>
<h2 data-id="heading-3">4. æ€»ç»“</h2>
<p>æ­å–œä½ ï¼ä½ å·²ç»æŒæ¡äº†æ•°æ®<strong>æ¨æ–­åˆ†æ</strong>çš„æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ol>
<li><strong>å‚æ•°ä¼°è®¡</strong>ï¼šå½“ä½ åªæœ‰æ ·æœ¬ï¼Œæƒ³çŸ¥é“æ€»ä½“çš„æ•°å€¼èŒƒå›´æ—¶ä½¿ç”¨ã€‚ï¼ˆæ¯”å¦‚ä¼°ç®—å¹³å‡è–ªèµ„ï¼‰</li>
<li><strong>å‡è®¾æ£€éªŒ</strong>ï¼šå½“ä½ æ•°æ®æ¯”è¾ƒâ€œå®Œç¾â€ï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ï¼Œæƒ³åˆ¤æ–­å·®å¼‚æ˜¯ä¸æ˜¯çœŸçš„æ—¶ä½¿ç”¨ã€‚ï¼ˆæ¯”å¦‚A/Bæµ‹è¯•ï¼‰</li>
<li><strong>éå‚æ•°æ£€éªŒ</strong>ï¼šå½“ä½ æ•°æ®åˆ†å¸ƒå¥‡æ€ªã€æˆ–è€…åªæœ‰æ’å/ç­‰çº§æ•°æ®æ—¶ä½¿ç”¨ã€‚ï¼ˆæ¯”å¦‚è¯„åˆ†å¯¹æ¯”ã€é•¿å°¾æ•°æ®åˆ†æï¼‰</li>
</ol>
<p>è¿™<strong>ä¸‰æ¿æ–§</strong>æ˜¯æ•°æ®åˆ†æå¸ˆè¡Œèµ°æ±Ÿæ¹–çš„å¿…å¤‡æŠ€èƒ½ã€‚æŒæ¡äº†å®ƒä»¬ï¼Œä½ å°±ä¸ä»…ä»…æ˜¯ä¸€ä¸ªâ€œåšè¡¨çš„â€ï¼Œè€Œæ˜¯ä¸€ä¸ªèƒ½ä»æ•°æ®ä¸­æŒ–æ˜çœŸç›¸çš„â€œä¾¦æ¢â€ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Agentã€‘MemOS æºç ç¬”è®°---(3)---æœç´¢]]></title>    <link>https://juejin.cn/post/7581312433529733163</link>    <guid>https://juejin.cn/post/7581312433529733163</guid>    <pubDate>2025-12-08T12:31:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581312433529733163" data-draft-id="7577647745110425600" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Agentã€‘MemOS æºç ç¬”è®°---(3)---æœç´¢"/> <meta itemprop="keywords" content="ç®—æ³•,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-08T12:31:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç½—è¥¿çš„æ€è€ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/351470467691175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Agentã€‘MemOS æºç ç¬”è®°---(3)---æœç´¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/351470467691175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç½—è¥¿çš„æ€è€ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T12:31:41.000Z" title="Mon Dec 08 2025 12:31:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€Agentã€‘MemOS æºç ç¬”è®°---(3)---æœç´¢</h2>
<h3 data-id="heading-1">0x00 æ‘˜è¦</h3>
<p>TreeTextMemory æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è®°å¿†ç®¡ç†ç³»ç»Ÿï¼Œèƒ½å­˜å‚¨ã€ç»„ç»‡ã€æ£€ç´¢å’Œç»´æŠ¤å„ç§ç±»å‹çš„æ–‡æœ¬è®°å¿†ã€é€‚ç”¨éœ€è¦å¤æ‚è®°å¿†ç®¡ç†çš„AIç³»ç»Ÿã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäºå›¾çš„ã€æ ‘å½¢æ˜æ–‡è®°å¿†ï¼Œæ”¯æŒä»¥ç»“æ„åŒ–æ–¹å¼ç»„ç»‡ã€å…³è”å¹¶æ£€ç´¢è®°å¿†ï¼ŒåŒæ—¶ä¿ç•™ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸è‰¯å¥½çš„å¯è§£é‡Šæ€§ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªTreeTextMemory å¯¹è±¡ä¸åºå¤§çš„çŸ¥è¯†åº“è¿›è¡Œäº¤äº’ï¼Œä¸ºAIèµ‹äºˆä¸“ä¸šçš„é¢†åŸŸè®°å¿†ã€‚å½“å‰ä½¿ç”¨Neo4jä½œä¸ºåç«¯ï¼Œæœªæ¥è®¡åˆ’æ”¯æŒæ›´å¤šå›¾æ•°æ®åº“ã€‚</p>
<p>å› ä¸ºå­—æ•°å¤ªå¤šï¼Œå› æ­¤æŠŠTreeTextMemoryæ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸Šä¸€ç¯‡ä»‹ç»åŸºæœ¬æ¦‚å¿µå’Œå¦‚ä½•ç®¡ç†ï¼Œæœ¬ç¯‡ä»‹ç»å¦‚ä½•æœç´¢ã€‚</p>
<h3 data-id="heading-2">0x01 åˆ†ç±»</h3>
<p>TreeTextMemory ä¸»è¦æ”¯æŒå‡ ç§æœç´¢ï¼ˆæ³¨ï¼Œæœ‰äº›æ˜¯ä»å…¶ä»–é€”å¾„é€å‡ºï¼‰ï¼š</p>
<ul>
<li>
<p>æ··åˆæœç´¢ï¼ˆHybrid Searchï¼‰ï¼Œé€šè¿‡ Searcher.search æ–¹æ³•å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ•´åˆå¤šç§æ£€ç´¢ç­–ç•¥çš„ç»“æœï¼Œå…·ä½“ç­–ç•¥å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç»“åˆå‘é‡ç›¸ä¼¼åº¦æœç´¢å’Œå›¾éå†ï¼šåœ¨ GraphMemoryRetrieverä¸­åˆ©ç”¨å›¾ç»“æ„å’Œå‘é‡ä¿¡æ¯</li>
<li>å…¨æ–‡æ£€ç´¢ï¼šè™½ç„¶æ²¡æœ‰æ˜¾å¼çš„å…¨æ–‡æœç´¢APIï¼Œä½†å¯ä»¥é€šè¿‡äº’è”ç½‘æ£€ç´¢å™¨ä»æœç´¢å¼•æ“è·å–ç›¸å…³å†…å®¹ InternetRetriever ç»„ä»¶å…è®¸é›†æˆå¤–éƒ¨æœç´¢æœåŠ¡ï¼ˆå¦‚Googleã€Bingã€Bochaï¼‰</li>
</ul>
</li>
<li>
<p>å­å›¾æ£€ç´¢ï¼ˆSubgraph Retrievalï¼‰ï¼Œé€šè¿‡ get_relevant_subgraph æ–¹æ³•å¯ä»¥ç›´æ¥è¿›è¡Œå­å›¾æœç´¢</p>
<ul>
<li>ä½¿ç”¨ graph_store.search_by_embedding æ–¹æ³•è·å–æŒ‡å®šèŠ‚ç‚¹å‘¨å›´çš„å±€éƒ¨å­å›¾ç»“æ„</li>
<li>æ”¯æŒè®¾ç½®éå†æ·±åº¦å’Œä¸­å¿ƒèŠ‚ç‚¹çŠ¶æ€æ¡ä»¶</li>
<li>è¿”å›åŒ…å«æ ¸å¿ƒèŠ‚ç‚¹ã€é‚»å±…èŠ‚ç‚¹å’Œè¾¹çš„å®Œæ•´å­å›¾ä¿¡æ¯</li>
</ul>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯å›¾æ•°æ®åº“çš„APIï¼Œæ¯”å¦‚ä½äºMemOS-main\src\memos\graph_dbs\nebular.pyä¸­ï¼Œåœ¨ä¸€äº›ç¤ºä¾‹ä¸­ä¹Ÿç›´æ¥ä½¿ç”¨ï¼š</p>
<ul>
<li>
<p>åŸºäºå…ƒæ•°æ®çš„ç»“æ„åŒ–æŸ¥è¯¢ï¼ˆMetadata-based Structured Queryï¼‰</p>
<ul>
<li>é€šè¿‡ get_by_metadataæ–¹æ³•æ ¹æ®èŠ‚ç‚¹å…ƒæ•°æ®å­—æ®µè¿›è¡Œç²¾ç¡®åŒ¹é…æˆ–æ¡ä»¶æŸ¥è¯¢</li>
<li>æ”¯æŒå¤šç§æ“ä½œç¬¦ï¼šç­‰äºï¼ˆ=ï¼‰ã€åŒ…å«ï¼ˆcontainsï¼‰ã€åœ¨åˆ—è¡¨ä¸­ï¼ˆinï¼‰ç­‰</li>
<li>å¯ä»¥ç»„åˆå¤šä¸ªæ¡ä»¶è¿›è¡Œå¤æ‚æŸ¥è¯¢</li>
</ul>
</li>
</ul>

<ul>
<li>
<p>æ ‡ç­¾é‡å æŸ¥è¯¢ï¼ˆTag Overlap Queryï¼‰</p>
<ul>
<li>ä½¿ç”¨ get_neighbors_by_tagæ–¹æ³•æŸ¥æ‰¾å…·æœ‰ç›¸ä¼¼æ ‡ç­¾çš„ç›¸é‚»èŠ‚ç‚¹</li>
<li>é€šè¿‡è®¡ç®—æ ‡ç­¾äº¤é›†å¤§å°æ¥ç¡®å®šç›¸å…³æ€§</li>
<li>æ”¯æŒè®¾ç½®æœ€å°æ ‡ç­¾é‡å æ•°è¦æ±‚</li>
</ul>
</li>
<li>
<p>å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼ˆVector Similarity Searchï¼‰</p>
<ul>
<li>åŸºäºåµŒå…¥ï¼ˆembeddingï¼‰çš„è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢</li>
<li>ä½¿ç”¨ search_by_embedding æ–¹æ³•æ ¹æ®æŸ¥è¯¢å‘é‡æ‰¾åˆ°æœ€ç›¸ä¼¼çš„è®°å¿†èŠ‚ç‚¹</li>
<li>æ”¯æŒè®¾ç½®ç›¸ä¼¼åº¦é˜ˆå€¼å’Œè¿”å›ç»“æœæ•°é‡é™åˆ¶</li>
</ul>
</li>
</ul>
<p>å…¶ä¸­æœ€ä¸»è¦çš„æŸ¥è¯¢æ¥å£æ˜¯ searchæ–¹æ³•ï¼Œå®ƒå†…éƒ¨æ•´åˆäº†å¤šç§æ£€ç´¢ç­–ç•¥æ¥æä¾›æœ€ä¼˜çš„æœç´¢ç»“æœã€‚</p>
<h3 data-id="heading-3">0x02 ## æ··åˆæœç´¢ï¼ˆHybrid Searchï¼‰--- Searcher</h3>
<p>Searcher ç”± TreeTextMemory åˆ›å»ºå¹¶ä½œä¸ºä¸»è¦çš„æœç´¢æ¥å£ä½¿ç”¨ï¼ŒSearcher æ˜¯æ•´ä¸ªè®°å¿†æ£€ç´¢ç³»ç»Ÿçš„æ ¸å¿ƒåè°ƒè€…ï¼Œè´Ÿè´£æ•´åˆå„ç§æ£€ç´¢æºå¹¶æä¾›é«˜è´¨é‡çš„æ£€ç´¢ç»“æœã€‚Searcher ç±»çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰§è¡Œè®°å¿†æ£€ç´¢ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒèŒè´£å’Œå·¥ä½œæµç¨‹ï¼š</p>
<ul>
<li>
<p>å¤šè·¯å¾„å¹¶è¡Œæ£€ç´¢ï¼ŒåŒæ—¶ä»å¤šä¸ªæ¥æºæ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼š</p>
<ul>
<li>å·¥ä½œè®°å¿†ï¼ˆWorkingMemoryï¼‰</li>
<li>é•¿æœŸè®°å¿†ï¼ˆLongTermMemoryï¼‰</li>
<li>ç”¨æˆ·è®°å¿†ï¼ˆUserMemoryï¼‰</li>
<li>äº’è”ç½‘æ£€ç´¢å™¨ï¼ˆå¯é€‰ï¼‰</li>
<li>MemCubesï¼ˆå¯é€‰ï¼‰</li>
</ul>
</li>
<li>
<p>ä»»åŠ¡è§£æä¸æŸ¥è¯¢ä¼˜åŒ–</p>
<ul>
<li>ä½¿ç”¨ TaskGoalParser è§£æç”¨æˆ·æŸ¥è¯¢æ„å›¾</li>
<li>æ ¹æ®ä¸åŒæ¨¡å¼ï¼ˆfast/fineï¼‰é‡‡ç”¨ä¸åŒçš„æ£€ç´¢ç­–ç•¥</li>
<li>åœ¨ç²¾ç»†æ¨¡å¼ä¸‹å…ˆè¿›è¡ŒåµŒå…¥æœç´¢è·å–ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p>ç»“æœé‡æ’åºä¸å»é‡</p>
<ul>
<li>ä½¿ç”¨ reranker å¯¹æ£€ç´¢ç»“æœè¿›è¡Œé‡æ–°æ’åº</li>
<li>å»é™¤é‡å¤çš„è®°å¿†é¡¹</li>
<li>ä¿ç•™æœ€ç›¸å…³çš„ç»“æœ</li>
</ul>
</li>
<li>
<p>é«˜çº§æ¨ç†å¤„ç†</p>
<ul>
<li>åˆ©ç”¨ MemoryReasoner å¯¹æ£€ç´¢åˆ°çš„è®°å¿†è¿›è¡Œæ¨ç†å’ŒçŸ¥è¯†ç»¼åˆ</li>
<li>æå–æœ€æœ‰ä»·å€¼çš„ä¿¡æ¯ç‰‡æ®µ</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨å†å²è¿½è¸ª</p>
<ul>
<li>æ›´æ–°è®°å¿†é¡¹çš„ä½¿ç”¨å†å²è®°å½•</li>
<li>å¹¶å‘å¤„ç†ä½¿ç”¨ç»Ÿè®¡æ›´æ–°</li>
</ul>
</li>
</ul>
<h4 data-id="heading-4">2.1 å®šä¹‰</h4>
<pre><code class="hljs language-ini" lang="ini">class Searcher:
 Â  Â def __init__(
 Â  Â  Â  Â self,
 Â  Â  Â  Â dispatcher_llm: OpenAILLM | OllamaLLM | AzureLLM,
 Â  Â  Â  Â graph_store: Neo4jGraphDB,
 Â  Â  Â  Â embedder: OllamaEmbedder,
 Â  Â  Â  Â reranker: BaseReranker,
 Â  Â  Â  Â internet_retriever: InternetRetrieverFactory | <span class="hljs-attr">None</span> = None,
 Â  Â  Â  Â moscube: <span class="hljs-attr">bool</span> = <span class="hljs-literal">False</span>,
 Â   ):
 Â  Â  Â  Â <span class="hljs-attr">self.graph_store</span> = graph_store
 Â  Â  Â  Â <span class="hljs-attr">self.embedder</span> = embedder
â€‹
 Â  Â  Â  Â <span class="hljs-attr">self.task_goal_parser</span> = TaskGoalParser(dispatcher_llm)
 Â  Â  Â  Â <span class="hljs-attr">self.graph_retriever</span> = GraphMemoryRetriever(self.graph_store, self.embedder)
 Â  Â  Â  Â <span class="hljs-attr">self.reranker</span> = reranker
 Â  Â  Â  Â <span class="hljs-attr">self.reasoner</span> = MemoryReasoner(dispatcher_llm)
â€‹
 Â  Â  Â  Â <span class="hljs-comment"># Create internet retriever from config if provided</span>
 Â  Â  Â  Â <span class="hljs-attr">self.internet_retriever</span> = internet_retriever
 Â  Â  Â  Â <span class="hljs-attr">self.moscube</span> = moscube
â€‹
 Â  Â  Â  Â <span class="hljs-attr">self._usage_executor</span> = ContextThreadPoolExecutor(max_workers=<span class="hljs-number">4</span>, thread_name_prefix=<span class="hljs-string">"usage"</span>)
</code></pre>
<h4 data-id="heading-5">2.2 æ ¸å¿ƒå‡½æ•°</h4>
<p>å…¶æ ¸å¿ƒæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>search()ï¼šä¸»å…¥å£ï¼Œåè°ƒæ•´ä¸ªæ£€ç´¢è¿‡ç¨‹</li>
<li>_parse_task()ï¼šè§£æä»»åŠ¡å’ŒæŸ¥è¯¢</li>
<li>_retrieve_paths()ï¼šæ‰§è¡Œå¤šè·¯å¾„æ£€ç´¢</li>
<li>_deduplicate_results()ï¼šç»“æœå»é‡</li>
<li>_sort_and_trim()ï¼šæ’åºå’Œæˆªæ–­ç»“æœ</li>
<li>update_usage_history()ï¼šæ›´æ–°ä½¿ç”¨å†å²</li>
</ul>
<p>ä¸»å…¥å£å¦‚ä¸‹ï¼Œæˆ–è€…è¯´Searcher ç¼–æ’æœç´¢æµæ°´çº¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>æŸ¥è¯¢è§£æå’Œç†è§£</li>
<li>ä»å¤šä¸ªæ¥æºå¹¶è¡Œæ£€ç´¢</li>
<li>ç»“æœé‡æ–°æ’åº</li>
<li>å»é‡å¤„ç†</li>
<li>å¯¹ç»“æœè¿›è¡Œæ¨ç†</li>
<li>ä½¿ç”¨æƒ…å†µè·Ÿè¸ª</li>
</ul>

<pre><code class="hljs language-python" lang="python"> Â  Â @timed
 Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">
 Â  Â  Â  Â self,
 Â  Â  Â  Â query: <span class="hljs-built_in">str</span>,
 Â  Â  Â  Â top_k: <span class="hljs-built_in">int</span>,
 Â  Â  Â  Â info=<span class="hljs-literal">None</span>,
 Â  Â  Â  Â mode=<span class="hljs-string">"fast"</span>,
 Â  Â  Â  Â memory_type=<span class="hljs-string">"All"</span>,
 Â  Â  Â  Â search_filter: <span class="hljs-built_in">dict</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
 Â   </span>) -&gt; <span class="hljs-built_in">list</span>[TextualMemoryItem]:
 Â  Â  Â  Â <span class="hljs-string">"""
 Â  Â  Â   Search for memories based on a query.
 Â  Â  Â   User query -&gt; TaskGoalParser -&gt; GraphMemoryRetriever -&gt;
 Â  Â  Â   MemoryReranker -&gt; MemoryReasoner -&gt; Final output
 Â  Â  Â   Args:
 Â  Â  Â  Â  Â   query (str): The query to search for.
 Â  Â  Â  Â  Â   top_k (int): The number of top results to return.
 Â  Â  Â  Â  Â   info (dict): Leave a record of memory consumption.
 Â  Â  Â  Â  Â   mode (str, optional): The mode of the search.
 Â  Â  Â  Â  Â   - 'fast': Uses a faster search process, sacrificing some precision for speed.
 Â  Â  Â  Â  Â   - 'fine': Uses a more detailed search process, invoking large models for higher precision, but slower performance.
 Â  Â  Â  Â  Â   memory_type (str): Type restriction for search.
 Â  Â  Â  Â  Â   ['All', 'WorkingMemory', 'LongTermMemory', 'UserMemory']
 Â  Â  Â  Â  Â   search_filter (dict, optional): Optional metadata filters for search results.
 Â  Â  Â   Returns:
 Â  Â  Â  Â  Â   list[TextualMemoryItem]: List of matching memories.
 Â  Â  Â   """</span>
 Â  Â  Â  Â logger.info(
 Â  Â  Â  Â  Â  Â <span class="hljs-string">f"[SEARCH] Start query='<span class="hljs-subst">{query}</span>', top_k=<span class="hljs-subst">{top_k}</span>, mode=<span class="hljs-subst">{mode}</span>, memory_type=<span class="hljs-subst">{memory_type}</span>"</span>
 Â  Â  Â   )
 Â  Â  Â  Â <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> info:
 Â  Â  Â  Â  Â  Â logger.warning(
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">"Please input 'info' when use tree.search so that "</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">"the database would store the consume history."</span>
 Â  Â  Â  Â  Â   )
 Â  Â  Â  Â  Â  Â info = {<span class="hljs-string">"user_id"</span>: <span class="hljs-string">""</span>, <span class="hljs-string">"session_id"</span>: <span class="hljs-string">""</span>}
 Â  Â  Â  Â <span class="hljs-keyword">else</span>:
 Â  Â  Â  Â  Â  Â logger.debug(<span class="hljs-string">f"[SEARCH] Received info dict: <span class="hljs-subst">{info}</span>"</span>)
â€‹
 Â  Â  Â  Â parsed_goal, query_embedding, context, query = self._parse_task(
 Â  Â  Â  Â  Â  Â query, info, mode, search_filter=search_filter
 Â  Â  Â   )
 Â  Â  Â  Â results = self._retrieve_paths(
 Â  Â  Â  Â  Â  Â query, parsed_goal, query_embedding, info, top_k, mode, memory_type, search_filter
 Â  Â  Â   )
 Â  Â  Â  Â deduped = self._deduplicate_results(results)
 Â  Â  Â  Â final_results = self._sort_and_trim(deduped, top_k)
 Â  Â  Â  Â self._update_usage_history(final_results, info)
â€‹
 Â  Â  Â  Â logger.info(<span class="hljs-string">f"[SEARCH] Done. Total <span class="hljs-subst">{<span class="hljs-built_in">len</span>(final_results)}</span> results."</span>)
 Â  Â  Â  Â res_results = <span class="hljs-string">""</span>
 Â  Â  Â  Â <span class="hljs-keyword">for</span> _num_i, result <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(final_results):
 Â  Â  Â  Â  Â  Â res_results += <span class="hljs-string">"\n"</span> + (
 Â  Â  Â  Â  Â  Â  Â  Â result.<span class="hljs-built_in">id</span> + <span class="hljs-string">"|"</span> + result.metadata.memory_type + <span class="hljs-string">"|"</span> + result.memory
 Â  Â  Â  Â  Â   )
 Â  Â  Â  Â logger.info(<span class="hljs-string">f"[SEARCH] Results. <span class="hljs-subst">{res_results}</span>"</span>)
 Â  Â  Â  Â <span class="hljs-keyword">return</span> final_results
</code></pre>
<h4 data-id="heading-6">2.3 ä¾èµ–å…³ç³»å’Œå…³è”å…³ç³»</h4>
<h5 data-id="heading-7">2.3.1 ä¾èµ–é¡¹ï¼ˆSearcher ä¾èµ–çš„ç»„ä»¶ï¼‰</h5>
<p>Searcher ä¾èµ–çš„ç»„ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>å¤§è¯­è¨€æ¨¡å‹ç»„ä»¶ï¼š</p>
<ul>
<li>dispatcher_llm â€“ ç”¨äºä»»åŠ¡è§£æå’Œæ¨ç†</li>
<li>TaskGoalParser â€“ å°†ç”¨æˆ·æŸ¥è¯¢è§£æä¸ºç»“æ„åŒ–ç›®æ ‡</li>
</ul>
</li>
<li>
<p>å­˜å‚¨ç»„ä»¶ï¼š</p>
<ul>
<li>graph_store â€“ Neo4j å›¾æ•°æ®åº“ç”¨äºå­˜å‚¨è®°å¿†</li>
<li>GraphMemoryRetriever â€“ ä»å›¾å­˜å‚¨ä¸­æ£€ç´¢è®°å¿†</li>
</ul>
</li>
<li>
<p>å¤„ç†ç»„ä»¶ï¼š</p>
<ul>
<li>embedder â€“ ä¸ºæŸ¥è¯¢å’Œè®°å¿†åˆ›å»ºåµŒå…¥å‘é‡</li>
<li>reranker â€“ å¯¹æ£€ç´¢ç»“æœè¿›è¡Œé‡æ–°æ’åº</li>
<li>MemoryReasoner â€“ å¯¹æ£€ç´¢åˆ°çš„è®°å¿†è¿›è¡Œæ¨ç†</li>
<li>internet_retriever â€“ å¯é€‰çš„äº’è”ç½‘æœç´¢åŠŸèƒ½</li>
</ul>
</li>
</ul>
<h5 data-id="heading-8">2.3.2 ä¾èµ– Searcher çš„ç»„ä»¶</h5>
<p>ä¾èµ– Searcher çš„ç»„ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>TreeTextMemory â€“ åœ¨å…¶ search æ–¹æ³•ä¸­ä½¿ç”¨ Searcher</li>
<li>GeneralScheduler â€“ é€šè¿‡æ£€ç´¢å™¨åœ¨ process_session_turn ä¸­ä½¿ç”¨ Searcher</li>
</ul>
<h4 data-id="heading-9">2.4 å›¾ä¾‹</h4>
<p>Searcher è¢«è°ƒåº¦å™¨ç³»ç»Ÿç”¨äºåœ¨æŸ¥è¯¢å¤„ç†è¿‡ç¨‹ä¸­æ£€ç´¢ç›¸å…³è®°å¿†ï¼Œæ€»çš„æ¥è¯´ï¼ŒSearcher å……å½“ä¸€ä¸ªä¸­å¤®åè°ƒè€…ï¼Œå°†å„ç§ç»„ä»¶æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸ºè·¨ä¸åŒè®°å¿†æºå’Œå¤–éƒ¨æ•°æ®æä¾›å…¨é¢çš„æ£€ç´¢èƒ½åŠ›ã€‚</p>
<h5 data-id="heading-10">2.4.1 Searcher ç»„ä»¶å…³ç³»æµç¨‹å›¾</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4d979d43803436495c2d5112601d62b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801901&amp;x-signature=ASPi6KA1T8DHkJmZVPlKSM71oLY%3D" alt="Searcher ç»„ä»¶å…³ç³»æµç¨‹å›¾" loading="lazy"/></p>
<h5 data-id="heading-11">2.4.2 Searcher è¯¦ç»†æœç´¢è¿‡ç¨‹æµç¨‹</h5>
<p>ç”¨æˆ·æŸ¥è¯¢ â†’ TaskGoalParser è§£æ â†’ å¤šè·¯å¾„å¹¶è¡Œæ£€ç´¢ â†’ ç»“æœé‡æ’åº â†’ å»é‡å¤„ç† â†’ æ¨ç†ä¼˜åŒ– â†’ è¿”å›æœ€ç»ˆç»“æœã€‚</p>
<p>å„ç»„ä»¶è¯¦ç»†è¯´æ˜</p>
<p><strong>ä¸»è¦é˜¶æ®µ</strong></p>
<ul>
<li>ä»»åŠ¡è§£æï¼šä½¿ç”¨ TaskGoalParser è§£ææŸ¥è¯¢ï¼Œæ ¹æ®æ¨¡å¼å†³å®šæ˜¯å¦ä½¿ç”¨ LLM</li>
<li>å¹¶è¡Œæ£€ç´¢ï¼šåŒæ—¶æ‰§è¡Œå¤šä¸ªæ£€ç´¢è·¯å¾„</li>
<li>ç»“æœé‡æ’ï¼šä½¿ç”¨ Reranker å¯¹å„è·¯å¾„çš„ç»“æœè¿›è¡Œé‡æ’</li>
<li>åˆå¹¶å»é‡ï¼šåˆå¹¶æ‰€æœ‰è·¯å¾„çš„ç»“æœå¹¶å»é™¤é‡å¤é¡¹</li>
<li>æ’åºæˆªå–ï¼šæŒ‰åˆ†æ•°æ’åºå¹¶æˆªå–å‰ K ä¸ªç»“æœ</li>
<li>æ›´æ–°è®°å½•ï¼šæ›´æ–°ä½¿ç”¨å†å²è®°å½•</li>
</ul>
<p><strong>å¹¶è¡Œæ£€ç´¢è·¯å¾„</strong></p>
<ul>
<li>è·¯å¾„ Aï¼šå·¥ä½œå†…å­˜æ£€ç´¢ (WorkingMemory)</li>
<li>è·¯å¾„ Bï¼šé•¿æœŸå’Œç”¨æˆ·å†…å­˜æ£€ç´¢ (LongTermMemory, UserMemory)</li>
<li>è·¯å¾„ Cï¼šäº’è”ç½‘æ£€ç´¢ï¼ˆå¯é€‰ï¼‰</li>
<li>è·¯å¾„ Dï¼šMemCubes æ£€ç´¢ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p><strong>æ•°æ®æµå‘</strong>ï¼šè¾“å…¥æŸ¥è¯¢ç»è¿‡è§£æåï¼Œè¢«åˆ†å‘åˆ°å¤šä¸ªæ£€ç´¢è·¯å¾„å¹¶è¡Œå¤„ç†ï¼Œæ¯ä¸ªè·¯å¾„éƒ½ä¼šäº§ç”Ÿä¸€æ‰¹å€™é€‰ç»“æœã€‚è¿™äº›ç»“æœç»è¿‡é‡æ’ã€åˆå¹¶ï¼Œæœ€åç»è¿‡å»é‡ã€æ’åºå’Œæˆªå–å¾—åˆ°æœ€ç»ˆç»“æœã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­è¿˜ä¼šæ›´æ–°ä½¿ç”¨å†å²è®°å½•ä»¥ä¾¿åç»­ä¼˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01aba941f206483ebb9f8f10fe53633e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801901&amp;x-signature=rNFzz9A6wN2jeY0MUyhnQVm5i%2Fg%3D" alt="Searcher è¯¦ç»†æœç´¢è¿‡ç¨‹æµç¨‹" loading="lazy"/></p>
<p>ç”¨æˆ·æœç´¢æµç¨‹å¦‚ä¸‹ï¼šç”¨æˆ·æŸ¥è¯¢ â†’ TaskGoalParser è§£æ â†’ å¤šè·¯å¾„å¹¶è¡Œæ£€ç´¢ â†’ ç»“æœé‡æ’åº â†’ å»é‡å¤„ç† â†’ æ¨ç†ä¼˜åŒ– â†’ è¿”å›æœ€ç»ˆç»“æœã€‚</p>
<p>å…¶ä¸­æ¶‰åŠåˆ°å¦‚ä¸‹ç»„ä»¶ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f081aae6b54641a4b2bfad88d3a3de0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765801901&amp;x-signature=DgjU47dG3RRzhr9mIOuKkwe15Nc%3D" alt="æœç´¢æµç¨‹" loading="lazy"/></p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹æµç¨‹è¿›è¡Œåˆ†æã€‚</p>
<h4 data-id="heading-12">2.5 TaskGoalParser</h4>
<p>_parse_task æ–¹æ³•ä¸»è¦æ˜¯ä½¿ç”¨ TaskGoalParser æ¥åˆ†æqueryã€‚</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â <span class="hljs-attr">parsed_goal</span> = self.task_goal_parser.parse(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">task_description</span>=query,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">context</span>=<span class="hljs-string">"\n"</span>.join(context),
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">conversation</span>=info.get(<span class="hljs-string">"chat_history"</span>, []),
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">mode</span>=mode,
 Â  Â  Â   )
</code></pre>
<p>TaskGoalParser æ˜¯ä¸€ä¸ªä»»åŠ¡ç›®æ ‡è§£æå™¨ï¼Œè´Ÿè´£å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢è§£æä¸ºç»“æ„åŒ–çš„è¯­ä¹‰å±‚è¡¨ç¤ºï¼Œä»¥ä¾¿åç»­çš„æ£€ç´¢ç³»ç»Ÿèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°ç†è§£å’Œå¤„ç†æŸ¥è¯¢ã€‚</p>
<h5 data-id="heading-13">2.5.1 ä¸»è¦åŠŸèƒ½</h5>
<p>TaskGoalParser ä¸»è¦åŠŸèƒ½ä¸ºï¼š</p>
<ul>
<li>
<p>æŸ¥è¯¢è§£æã€‚</p>
<ul>
<li>å°†ç”¨æˆ·è¾“å…¥çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºç»“æ„åŒ–çš„æŸ¥è¯¢è¡¨ç¤º</li>
<li>æä¾›ä¸¤ç§è§£ææ¨¡å¼ï¼šå¿«é€Ÿæ¨¡å¼ï¼ˆfastï¼‰å’Œç²¾ç»†æ¨¡å¼ï¼ˆfineï¼‰</li>
</ul>
</li>
<li>
<p>ç»“æ„åŒ–è¯­ä¹‰è¡¨ç¤º</p>
<ul>
<li>å°†æŸ¥è¯¢åˆ†è§£ä¸ºå¤šä¸ªè¯­ä¹‰å±‚æ¬¡ï¼šä¸»é¢˜ï¼ˆtopicï¼‰ã€å…³é”®è¯ï¼ˆkeysï¼‰ã€æ ‡ç­¾ï¼ˆtagsï¼‰ç­‰ æå–æŸ¥è¯¢çš„æ ¸å¿ƒæ„å›¾å’Œç›¸å…³ä¿¡æ¯</li>
</ul>
</li>
</ul>
<h5 data-id="heading-14">2.5.2 å·¥ä½œæ¨¡å¼</h5>
<h6 data-id="heading-15">Fast æ¨¡å¼</h6>
<pre><code class="hljs language-ini" lang="ini">def _parse_fast(self, task_description: str, limit_num: <span class="hljs-attr">int</span> = <span class="hljs-number">5</span>) -&gt; ParsedTaskGoal:
 Â  Â <span class="hljs-comment"># å¿«é€Ÿæ¨¡å¼ï¼šç®€å•çš„åˆ†è¯å¤„ç†</span>
 Â  Â return ParsedTaskGoal(
 Â  Â  Â  Â <span class="hljs-attr">memories</span>=[task_description],
 Â  Â  Â  Â <span class="hljs-attr">keys</span>=[task_description],
 Â  Â  Â  Â <span class="hljs-attr">tags</span>=[],
 Â  Â  Â  Â <span class="hljs-attr">goal_type</span>=<span class="hljs-string">"default"</span>,
 Â  Â  Â  Â <span class="hljs-attr">rephrased_query</span>=task_description,
 Â  Â  Â  Â <span class="hljs-attr">internet_search</span>=<span class="hljs-literal">False</span>,
</code></pre>
<h6 data-id="heading-16">Fine æ¨¡å¼</h6>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_parse_fine</span>(<span class="hljs-params">
 Â  Â self, query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, conversation: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">dict</span>] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
</span>) -&gt; ParsedTaskGoal:
 Â  Â <span class="hljs-comment"># ç²¾ç»†æ¨¡å¼ï¼šä½¿ç”¨ LLM è¿›è¡Œç»“æ„åŒ–è§£æ</span>
 Â  Â <span class="hljs-comment"># æ„å»ºæç¤ºè¯å¹¶è°ƒç”¨ LLM è¿›è¡Œè§£æ</span>
 Â  Â prompt = Template(TASK_PARSE_PROMPT).substitute(
 Â  Â  Â  Â task=query.strip(), context=context, conversation=conversation_prompt
 Â   )
 Â  Â response = self.llm.generate(messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}])
 Â  Â <span class="hljs-keyword">return</span> self._parse_response(response)
</code></pre>
<h5 data-id="heading-17">2.5.3 è¾“å‡ºç»“æ„</h5>
<p>TaskGoalParser è§£æåçš„ç»“æœå­˜å‚¨åœ¨ ParsedTaskGoal å¯¹è±¡ä¸­ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li>memoriesï¼šç›¸å…³è®°å¿†é¡¹åˆ—è¡¨</li>
<li>keysï¼šå…³é”®è¯åˆ—è¡¨</li>
<li>tagsï¼šæ ‡ç­¾åˆ—è¡¨</li>
<li>rephrased_queryï¼šé‡è¿°çš„æŸ¥è¯¢ï¼ˆæ›´æ¸…æ™°çš„è¡¨è¾¾ï¼‰</li>
<li>internet_searchï¼šæ˜¯å¦éœ€è¦è”ç½‘æœç´¢</li>
<li>goal_typeï¼šç›®æ ‡ç±»å‹</li>
</ul>
<h5 data-id="heading-18">2.5.4 prompt</h5>
<pre><code class="hljs language-python" lang="python">TASK_PARSE_PROMPT = <span class="hljs-string">"""
You are a task parsing expert. Given a user task instruction, optional former conversation and optional related memory context,extract the following structured information:
1. Keys: the high-level keywords directly relevant to the userâ€™s task.
2. Tags: thematic tags to help categorize and retrieve related memories.
3. Goal Type: retrieval | qa | generation
4. Rephrased instruction: Give a rephrased task instruction based on the former conversation to make it less confusing to look alone. If you think the task instruction is easy enough to understand, or there is no former conversation, set "rephrased_instruction" to an empty string.
5. Need for internet search: If the user's task instruction only involves objective facts or can be completed without introducing external knowledge, set "internet_search" to False. Otherwise, set it to True.
6. Memories: Provide 2â€“5 short semantic expansions or rephrasings of the rephrased/original user task instruction. These are used for improved embedding search coverage. Each should be clear, concise, and meaningful for retrieval.
â€‹
Former conversation (if any):
"""</span>
$conversation
<span class="hljs-string">"""
â€‹
Task description(User Question):
"""</span>$task<span class="hljs-string">"""
â€‹
Context (if any):
"""</span>$context<span class="hljs-string">"""
â€‹
Return strictly in this JSON format, note that the
keys/tags/rephrased_instruction/memories should use the same language as the
input query:
{
  "keys": [...],
  "tags": [...],
  "goal_type": "retrieval | qa | generation",
  "rephrased_instruction": "...", # return an empty string if the original instruction is easy enough to understand
  "internet_search": True/False,
  "memories": ["...", "...", ...]
}
"""</span>
</code></pre>
<h5 data-id="heading-19">2.5.5 ä¼˜åŠ¿</h5>
<p>æ€»çš„æ¥è¯´ï¼ŒTaskGoalParser åœ¨è®°å¿†æ£€ç´¢ç³»ç»Ÿä¸­æ‰®æ¼”ç€â€œæŸ¥è¯¢ç†è§£å™¨â€çš„è§’è‰²ï¼Œé€šè¿‡è§£æç”¨æˆ·æŸ¥è¯¢ä¸ºç»“æ„åŒ–è¡¨ç¤ºï¼Œä¸ºåç»­çš„æ£€ç´¢å’Œæ¨ç†è¿‡ç¨‹æä¾›æ›´ç²¾ç¡®çš„è¾“å…¥ã€‚å…¶ä¼˜åŠ¿ä¸ºï¼š</p>
<ul>
<li>çµæ´»æ€§ï¼šæ”¯æŒä¸¤ç§è§£ææ¨¡å¼ï¼Œé€‚åº”ä¸åŒæ€§èƒ½å’Œç²¾åº¦éœ€æ±‚</li>
<li>ç»“æ„åŒ–ï¼šå°†è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºç»“æ„åŒ–è¡¨ç¤ºï¼Œä¾¿äºåç»­å¤„ç†</li>
<li>ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šåœ¨ç²¾ç»†æ¨¡å¼ä¸‹å¯ä»¥è€ƒè™‘ä¸Šä¸‹æ–‡å’Œå¯¹è¯å†å²</li>
<li>é”™è¯¯å¤„ç†ï¼šå½“ç²¾ç»†æ¨¡å¼å¤±è´¥æ—¶ä¼šå›é€€åˆ°å¿«é€Ÿæ¨¡å¼</li>
</ul>
<h4 data-id="heading-20">2.6 GraphMemoryRetriever</h4>
<p>GraphMemoryRetriever æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„è®°å¿†æ£€ç´¢å™¨ï¼Œç»“åˆäº†å›¾ç»“æ„æ£€ç´¢å’Œå‘é‡ç›¸ä¼¼æ€§æ£€ç´¢ä¸¤ç§æ–¹å¼ï¼Œç”¨äºä»çŸ¥è¯†å›¾è°±ä¸­æ£€ç´¢ç›¸å…³è®°å¿†é¡¹ã€‚</p>
<h5 data-id="heading-21">2.6.1 ä¸»è¦åŠŸèƒ½</h5>
<p>GraphMemoryRetriever å®ç°æ··åˆæ£€ç´¢ï¼Œè¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿæ—¢èƒ½åˆ©ç”¨ç»“æ„åŒ–ä¿¡æ¯è¿›è¡Œç²¾ç¡®æ£€ç´¢ï¼Œåˆèƒ½é€šè¿‡å‘é‡ç›¸ä¼¼æ€§æ•è·è¯­ä¹‰ç›¸å…³çš„å†…å®¹ï¼Œä»è€Œæé«˜äº†æ£€ç´¢çš„å‡†ç¡®æ€§å’Œå¬å›ç‡ã€‚</p>
<ul>
<li>
<p>æ··åˆæ£€ç´¢æœºåˆ¶</p>
<ul>
<li>ç»“æ„åŒ–å›¾æ£€ç´¢ï¼šåŸºäºè§£æåçš„ä»»åŠ¡ç›®æ ‡ï¼ˆkeys/tagsï¼‰è¿›è¡Œç²¾ç¡®åŒ¹é…</li>
<li>å‘é‡ç›¸ä¼¼æ€§æ£€ç´¢ï¼šåŸºäºæŸ¥è¯¢åµŒå…¥è¿›è¡Œè¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢</li>
<li>åˆå¹¶ä¸¤ç§æ£€ç´¢ç»“æœå¹¶å»é‡</li>
</ul>
</li>
<li>
<p>å¤šèŒƒå›´è®°å¿†æ£€ç´¢</p>
<ul>
<li>æ”¯æŒä¸åŒç±»å‹çš„è®°å¿†èŒƒå›´ï¼šWorkingMemoryã€LongTermMemoryã€UserMemory</li>
<li>é’ˆå¯¹ä¸åŒèŒƒå›´é‡‡ç”¨ä¸åŒçš„æ£€ç´¢ç­–ç•¥</li>
</ul>
</li>
</ul>
<h5 data-id="heading-22">2.6.2 æ ¸å¿ƒæ–¹æ³•</h5>
<ul>
<li>
<p>retrieve æ–¹æ³•ï¼šè¿™æ˜¯ä¸»è¦çš„æ£€ç´¢å…¥å£ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>å¯¹äº WorkingMemoryï¼Œç›´æ¥è·å–æ‰€æœ‰æ¡ç›®ï¼›</li>
<li>å¯¹äºå…¶ä»–è®°å¿†ç±»å‹ï¼ŒåŒæ—¶æ‰§è¡Œ _graph_recall å’Œ _vector_recallï¼›</li>
<li>åˆå¹¶ç»“æœå¹¶å»é™¤é‡å¤é¡¹ã€‚</li>
</ul>
</li>
<li>
<p>_graph_recall æ–¹æ³•ï¼šæ‰§è¡ŒåŸºäºå›¾ç»“æ„çš„æ£€ç´¢ï¼š</p>
<ul>
<li>åŸºäº keys è¿›è¡Œç²¾ç¡®åŒ¹é…æ£€ç´¢ï¼›</li>
<li>åŸºäº tags è¿›è¡ŒåŒ…å«åŒ¹é…æ£€ç´¢ï¼›</li>
<li>å¯¹å€™é€‰ç»“æœè¿›è¡Œåè¿‡æ»¤ï¼Œç¡®ä¿è‡³å°‘æœ‰ 2 ä¸ªæ ‡ç­¾é‡å ã€‚</li>
</ul>
</li>
<li>
<p>_vector_recall æ–¹æ³•ï¼šæ‰§è¡ŒåŸºäºå‘é‡çš„ç›¸ä¼¼æ€§æ£€ç´¢ï¼š</p>
<ul>
<li>ä½¿ç”¨æŸ¥è¯¢åµŒå…¥åœ¨å›¾æ•°æ®åº“ä¸­æœç´¢æœ€ç›¸ä¼¼çš„è®°å¿†é¡¹ï¼›</li>
<li>æ”¯æŒå¸¦è¿‡æ»¤æ¡ä»¶çš„æœç´¢å’Œä¸å¸¦è¿‡æ»¤æ¡ä»¶çš„æœç´¢è·¯å¾„ï¼›</li>
<li>å¹¶å‘æ‰§è¡Œå¤šä¸ªæœç´¢ä»»åŠ¡ä»¥æé«˜æ•ˆç‡ã€‚</li>
</ul>
</li>
<li>
<p>retrieve_from_cube æ–¹æ³•ï¼šä¸“é—¨ç”¨äºä»ç‰¹å®šçš„ cube ä¸­æ£€ç´¢è®°å¿†é¡¹ï¼Œè¿™åœ¨å¤šç§Ÿæˆ·æˆ–åˆ†ç‰‡åœºæ™¯ä¸­å¾ˆæœ‰ç”¨ã€‚</p>
</li>
</ul>
<h5 data-id="heading-23">2.6.3 å·¥ä½œæµç¨‹æ€»ç»“</h5>
<ul>
<li>æ¥æ”¶ç”¨æˆ·æŸ¥è¯¢å’Œè§£æåçš„ä»»åŠ¡ç›®æ ‡</li>
<li>å¹¶è¡Œæ‰§è¡Œå›¾ç»“æ„æ£€ç´¢å’Œå‘é‡æ£€ç´¢</li>
<li>åˆå¹¶ä¸¤ç§æ£€ç´¢ç»“æœ</li>
<li>å»é™¤é‡å¤é¡¹å¹¶è¿”å›æœ€ç»ˆç»“æœ</li>
</ul>
<h4 data-id="heading-24">2.7 Reranker</h4>
<p>ä½¿ç”¨ CosineLocalReranker åšè§£æã€‚CosineLocalReranker æ˜¯ä¸€ä¸ªæœ¬åœ°å®ç°çš„é‡æ’åºå™¨ï¼Œå®ƒä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ç®—æ³•å¯¹æ£€ç´¢åˆ°çš„è®°å¿†é¡¹è¿›è¡Œé‡æ–°æ’åºï¼Œä»¥æé«˜æ£€ç´¢ç»“æœçš„ç›¸å…³æ€§ã€‚</p>
<h5 data-id="heading-25">2.7.1 ä¸»è¦åŠŸèƒ½</h5>
<p>ä¸»è¦åŠŸèƒ½æ˜¯ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—</p>
<ul>
<li>è®¡ç®—æŸ¥è¯¢å‘é‡ä¸å€™é€‰è®°å¿†é¡¹å‘é‡ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦</li>
<li>æ”¯æŒå•ä¸ªæŸ¥è¯¢å‘é‡ä¸å¤šä¸ªå€™é€‰å‘é‡çš„åŒæ—¶è®¡ç®—</li>
</ul>
<h5 data-id="heading-26">2.7.2 å·¥ä½œæµç¨‹æ€»ç»“</h5>
<ul>
<li>æ¥æ”¶æ¥è‡ª GraphMemoryRetriever çš„åˆæ­¥æ£€ç´¢ç»“æœ</li>
<li>è·å–æŸ¥è¯¢çš„åµŒå…¥å‘é‡å’Œå€™é€‰è®°å¿†é¡¹çš„åµŒå…¥å‘é‡</li>
<li>è®¡ç®—æŸ¥è¯¢å‘é‡ä¸æ¯ä¸ªå€™é€‰å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦</li>
<li>æ ¹æ®è®°å¿†é¡¹çš„å±‚çº§ç±»å‹åº”ç”¨ç›¸åº”æƒé‡</li>
<li>æŒ‰ç…§åŠ æƒç›¸ä¼¼åº¦åˆ†æ•°å¯¹ç»“æœè¿›è¡Œæ’åº</li>
<li>è¿”å›å‰ K ä¸ªæœ€ç›¸å…³çš„ç»“æœç»™ä¸‹ä¸€ä¸ªå¤„ç†é˜¶æ®µ</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿåœ¨æœ¬åœ°å¿«é€Ÿå®Œæˆé‡æ’åºæ“ä½œï¼Œè€Œæ— éœ€ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼ŒåŒæ—¶é€šè¿‡å±‚çº§æƒé‡æœºåˆ¶å¯ä»¥ä¼˜å…ˆè€ƒè™‘æŸäº›ç±»å‹çš„è®°å¿†é¡¹ï¼Œä»è€Œæé«˜æ£€ç´¢ç»“æœçš„è´¨é‡ã€‚</p>
<h4 data-id="heading-27">2.8 MemoryReasoner</h4>
<p>MemoryReasoner æ˜¯ä¸€ä¸ªä¸“é—¨è´Ÿè´£å¯¹æ£€ç´¢åˆ°çš„è®°å¿†é¡¹è¿›è¡Œæ¨ç†å’ŒçŸ¥è¯†ç»¼åˆçš„ç»„ä»¶ã€‚å®ƒçš„ä¸»è¦èŒè´£æ˜¯å¯¹ä»ä¸åŒæ¥æºæ£€ç´¢åˆ°çš„è®°å¿†è¿›è¡Œåˆ†æã€ç­›é€‰å’Œä¼˜åŒ–ï¼Œä»è€Œæä¾›æ›´ç²¾ç¡®å’Œç›¸å…³çš„è®°å¿†ç»“æœã€‚</p>
<h5 data-id="heading-28">2.8.1 ä¸»è¦åŠŸèƒ½</h5>
<ul>
<li>
<p>è®°å¿†æ¨ç†ä¸ç»¼åˆ</p>
<ul>
<li>æ¥æ”¶åŸå§‹æŸ¥è¯¢å’Œå·²æ£€ç´¢çš„ç›¸å…³è®°å¿†é¡¹</li>
<li>åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹åˆ†æå¤šä¸ªæ£€ç´¢åˆ°çš„è®°å¿†é¡¹</li>
<li>æ ¹æ®ç”¨æˆ·çš„æŸ¥è¯¢ç›®æ ‡ç»¼åˆç›¸å…³ä¿¡æ¯</li>
<li>ç”Ÿæˆæ›´åŠ ç²¾ç¡®å’Œç›¸å…³çš„è®°å¿†å“åº”</li>
</ul>
</li>
</ul>

<ul>
<li>
<p>æ™ºèƒ½ç­›é€‰</p>
<ul>
<li>é€šè¿‡ LLM åˆ¤æ–­å“ªäº›è®°å¿†é¡¹ä¸å½“å‰æŸ¥è¯¢æœ€ç›¸å…³</li>
<li>åªè¿”å›ç»è¿‡ç­›é€‰çš„ç›¸å…³è®°å¿†é¡¹</li>
</ul>
</li>
</ul>
<h5 data-id="heading-29">2.8.2 æ ¸å¿ƒæ–¹æ³•</h5>
<p>reason æ˜¯ä¸»è¦çš„æ¨ç†æ–¹æ³•ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>
<p>æ„å»ºæç¤ºè¯ï¼š</p>
<ul>
<li>ä½¿ç”¨æ¨¡æ¿ REASON_PROMPT æ„å»ºæ¨ç†æç¤ºè¯</li>
<li>å°†æ£€ç´¢åˆ°çš„è®°å¿†é¡¹æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²åˆ—è¡¨</li>
</ul>
</li>
<li>
<p>è°ƒç”¨ LLMï¼š</p>
<ul>
<li>å°†æ„å»ºå¥½çš„æç¤ºè¯å‘é€ç»™è¯­è¨€æ¨¡å‹ç”Ÿæˆå“åº”</li>
</ul>
</li>
<li>
<p>è§£æå“åº”ï¼š</p>
<ul>
<li>æå–æ¨¡å‹é€‰æ‹©çš„è®°å¿†é¡¹ ID</li>
<li>è¿”å›å¯¹åº”çš„è®°å¿†é¡¹åˆ—è¡¨</li>
</ul>
</li>
</ul>
<p>parse_selected_ids æ–¹æ³•è´Ÿè´£ä»æ¨¡å‹å“åº”ä¸­æå–é€‰å®šçš„è®°å¿†é¡¹ IDï¼š</p>
<ul>
<li>JSON è§£æï¼šé¦–å…ˆå°è¯•å°†å“åº”è§£æä¸º JSON æ ¼å¼</li>
<li>æ­£åˆ™è¡¨è¾¾å¼å›é€€ï¼šå¦‚æœ JSON è§£æå¤±è´¥ï¼Œåˆ™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… UUID æ ¼å¼çš„ ID</li>
</ul>
<h5 data-id="heading-30">2.8.3 æç¤ºè¯</h5>
<pre><code class="hljs language-css" lang="css">REASON_PROMPT = """
You are <span class="hljs-selector-tag">a</span> reasoning agent working with <span class="hljs-selector-tag">a</span> memory system. You will synthesize knowledge <span class="hljs-selector-tag">from</span> multiple memory cards <span class="hljs-selector-tag">to</span> construct <span class="hljs-selector-tag">a</span> meaningful response <span class="hljs-selector-tag">to</span> the task below.
â€‹
Task: ${task}
â€‹
Memory cards (with metadata):
${detailed_memory_list}
â€‹
Please perform:
<span class="hljs-number">1</span>. Clustering by theme (topic/concept/fact)
<span class="hljs-number">2</span>. Identify useful chains or connections
<span class="hljs-number">3</span>. Return a curated list of memory card IDs with reasons.
â€‹
Output in JSON:
{
  "selected_ids": [...],
  <span class="hljs-string">"explanation"</span>: <span class="hljs-string">"..."</span>
}
"""
</code></pre>
<h5 data-id="heading-31">2.8.4 å·¥ä½œæµç¨‹æ€»ç»“</h5>
<ul>
<li>
<p>æ¥æ”¶æ¥è‡ªä¸Šä¸€é˜¶æ®µçš„æ£€ç´¢å’Œé‡æ’åºç»“æœ</p>
</li>
<li>
<p>æ„å»ºæ¨ç†æç¤ºè¯ï¼š</p>
<ul>
<li>å°†ç”¨æˆ·çš„æŸ¥è¯¢ã€è§£æåçš„ä»»åŠ¡ç›®æ ‡ä»¥åŠæ£€ç´¢åˆ°çš„è®°å¿†é¡¹ç»„åˆæˆä¸€ä¸ªç»“æ„åŒ–çš„æç¤ºè¯</li>
<li>ä½¿ç”¨é¢„å®šä¹‰çš„ REASON_PROMPT æ¨¡æ¿</li>
</ul>
</li>
<li>
<p>è°ƒç”¨ LLM è¿›è¡Œæ¨ç†ï¼š</p>
<ul>
<li>å°†æ„å»ºå¥½çš„æç¤ºè¯å‘é€ç»™å¤§å‹è¯­è¨€æ¨¡å‹</li>
<li>ä½¿ç”¨ LLM è¿›ä¸€æ­¥åˆ†æå’Œæ¨ç†è¿™äº›è®°å¿†é¡¹çš„ç›¸å…³æ€§</li>
<li>è·å–æ¨¡å‹çš„å“åº”ï¼Œè¯¥å“åº”åŒ…å«å¯¹è®°å¿†é¡¹çš„ç›¸å…³æ€§åˆ¤æ–­</li>
</ul>
</li>
<li>
<p>è§£æå’Œç­›é€‰ç»“æœï¼š</p>
<ul>
<li>
<p>è§£æ LLM çš„å“åº”ï¼Œæå–è¢«é€‰ä¸­çš„è®°å¿†é¡¹ ID</p>
</li>
<li>
<p>æ”¯æŒä¸¤ç§è§£ææ–¹å¼ï¼š</p>
<ul>
<li>JSON æ ¼å¼ï¼šç›´æ¥æå– selected_ids å­—æ®µ</li>
<li>æ–‡æœ¬æ ¼å¼ï¼šé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… UUID æ¨¡å¼</li>
</ul>
</li>
</ul>
</li>
<li>
<p>è¿”å›ç²¾é€‰è®°å¿†ï¼š</p>
<ul>
<li>æ ¹æ®è§£æå‡ºçš„ ID åˆ—è¡¨ç­›é€‰åŸå§‹è®°å¿†é¡¹</li>
<li>è¿”å›æœ€ç›¸å…³çš„ç»“æœå­é›†</li>
</ul>
</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿåˆ©ç”¨ LLM çš„ç†è§£å’Œæ¨ç†èƒ½åŠ›ï¼Œä»å¤§é‡æ£€ç´¢åˆ°çš„è®°å¿†ä¸­é€‰å‡ºæœ€ç¬¦åˆç”¨æˆ·éœ€æ±‚çš„éƒ¨åˆ†ï¼Œæé«˜äº†ç³»ç»Ÿçš„å‡†ç¡®æ€§å’Œæ™ºèƒ½åŒ–æ°´å¹³ã€‚</p>
<h5 data-id="heading-32">2.8.5 ä¼˜åŠ¿</h5>
<ul>
<li>æ™ºèƒ½åŒ–å¤„ç†ï¼šåˆ©ç”¨ LLM çš„ç†è§£èƒ½åŠ›å¯¹è®°å¿†é¡¹è¿›è¡Œè¯­ä¹‰å±‚é¢çš„åˆ†æ</li>
<li>çµæ´»æ€§ï¼šæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼çš„è§£æ</li>
<li>ç²¾å‡†æ€§ï¼šèƒ½å¤Ÿè¿›ä¸€æ­¥æå‡æ£€ç´¢ç»“æœçš„ç›¸å…³æ€§å’Œè´¨é‡</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼ŒMemoryReasoner åœ¨æ•´ä¸ªè®°å¿†æ£€ç´¢ç³»ç»Ÿä¸­æ‰®æ¼”ç€â€œæ™ºèƒ½ç­›é€‰å™¨â€çš„è§’è‰²ï¼Œé€šè¿‡å¼•å…¥ LLM çš„æ¨ç†èƒ½åŠ›ï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿæ›´å‡†ç¡®åœ°ç†è§£ç”¨æˆ·éœ€æ±‚å¹¶è¿”å›æœ€ç›¸å…³çš„è®°å¿†é¡¹ã€‚</p>
<h4 data-id="heading-33">2.9 Reranker å’Œ Reasoner</h4>
<p>åœ¨ç³»ç»Ÿä¸­åŒæ—¶ä½¿ç”¨ Reranker å’Œ Reasoner æ˜¯ä¸ºäº†å®ç°ä¸åŒå±‚æ¬¡çš„æ£€ç´¢ç»“æœå¤„ç†å’Œä¼˜åŒ–ï¼Œå®ƒä»¬å„è‡ªæ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚</p>
<h5 data-id="heading-34">2.9.1 Reranker çš„ä½œç”¨</h5>
<p>Rerankerï¼ˆé‡æ’åºå™¨ï¼‰ä¸»è¦è´Ÿè´£å¯¹åˆæ­¥æ£€ç´¢ç»“æœè¿›è¡Œç›¸å…³æ€§é‡æ–°æ’åºï¼š</p>
<ul>
<li>åŠŸèƒ½ï¼šåŸºäºæŸ¥è¯¢å’Œå€™é€‰ç»“æœçš„ç›¸ä¼¼åº¦è®¡ç®—ï¼Œå¯¹æ£€ç´¢ç»“æœè¿›è¡Œé‡æ–°æ’åº</li>
<li>æ–¹æ³•ï¼šé€šå¸¸ä½¿ç”¨æ•°å­¦è®¡ç®—ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰æ¥è¯„ä¼°ç›¸å…³æ€§</li>
<li>è¾“å‡ºï¼šè¿”å›æŒ‰ç›¸å…³æ€§å¾—åˆ†æ’åºçš„è®°å¿†é¡¹åˆ—è¡¨</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">def rerank(self, query, graph_results, top_k, **kwargs):
 Â  Â <span class="hljs-comment"># è®¡ç®—ç›¸ä¼¼åº¦</span>
 Â  Â <span class="hljs-attr">sims</span> = _cosine_one_to_many(query_embedding, cand_vecs)
 Â  Â <span class="hljs-comment"># åº”ç”¨æƒé‡è°ƒæ•´</span>
 Â  Â <span class="hljs-attr">weighted</span> = [sim * get_weight(it) for sim, it in zip(sims, items_with_emb)]
 Â  Â <span class="hljs-comment"># æ’åºå¹¶è¿”å›å‰ K ä¸ªç»“æœ</span>
 Â  Â scored_pairs.sort(<span class="hljs-attr">key</span>=lambda x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
 Â  Â return scored_pairs<span class="hljs-section">[:top_k]</span>
</code></pre>
<h5 data-id="heading-35">2.9.2 Reasoner çš„ä½œç”¨</h5>
<p>Reasonerï¼ˆæ¨ç†å™¨ï¼‰ä¸»è¦è´Ÿè´£å¯¹æ’åºåçš„ç»“æœè¿›è¡Œè¯­ä¹‰ç†è§£å’Œæ¨ç†ï¼š</p>
<ul>
<li>åŠŸèƒ½ï¼šåŸºäºè¯­è¨€æ¨¡å‹å¯¹æ£€ç´¢åˆ°çš„è®°å¿†é¡¹è¿›è¡Œè¯­ä¹‰ç†è§£å’Œæ¨ç†</li>
<li>æ–¹æ³•ï¼šä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹åˆ†ææŸ¥è¯¢å’Œè®°å¿†é¡¹ä¹‹é—´çš„æ·±å±‚è¯­ä¹‰å…³ç³»</li>
<li>è¾“å‡ºï¼šè¿”å›ç»è¿‡è¯­ä¹‰æ¨ç†ç­›é€‰åçš„æœ€ç»ˆè®°å¿†é¡¹</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">def reason(self, query, ranked_memories, parsed_goal):
 Â  Â <span class="hljs-comment"># æ„å»ºæ¨ç†æç¤º</span>
 Â  Â <span class="hljs-attr">prompt</span> = prompt_template.substitute(task=query, detailed_memory_list=memory_detailed_str)
 Â  Â <span class="hljs-comment"># ä½¿ç”¨ LLM è¿›è¡Œæ¨ç†</span>
 Â  Â <span class="hljs-attr">response</span> = self.llm.generate([{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}])
 Â  Â <span class="hljs-comment"># è§£æå¹¶è¿”å›æ¨ç†ç»“æœ</span>
 Â  Â <span class="hljs-attr">selected_ids</span> = self._parse_selected_ids(content)
 Â  Â return <span class="hljs-section">[m for m in ranked_memories if m.id in id_set]</span>
</code></pre>
<h5 data-id="heading-36">2.9.3 ä¸ºä»€ä¹ˆéœ€è¦ä¸¤è€…ç»“åˆï¼Ÿ</h5>
<ol start="0">
<li>ä¸åŒçš„å¤„ç†å±‚æ¬¡</li>
</ol>
<p>Rerankerï¼šåœ¨æ•°å­¦å‘é‡ç©ºé—´ä¸­è¿›è¡Œå¿«é€Ÿç›¸å…³æ€§è®¡ç®—</p>
<p>Reasonerï¼šåœ¨è¯­ä¹‰å±‚é¢è¿›è¡Œæ·±åº¦ç†è§£å’Œæ¨ç†</p>
<ol start="2">
<li>
<p>äº’è¡¥çš„ä¼˜åŠ¿</p>
<p>æ•ˆç‡ vs ç²¾åº¦ï¼šReranker å¿«é€Ÿç­›é€‰ï¼ŒReasoner ç²¾ç¡®æ¨ç†</p>
<p>å®šé‡ vs å®šæ€§ï¼šReranker åŸºäºæ•°å€¼è®¡ç®—ï¼ŒReasoner åŸºäºè¯­ä¹‰ç†è§£</p>
</li>
</ol>
<p>ç³»ç»Ÿè®¾è®¡ä¼˜åŠ¿</p>
<ul>
<li>
<p>æ€§èƒ½ä¼˜åŒ–ï¼šé¿å…ç›´æ¥å¯¹å¤§é‡å€™é€‰ç»“æœä½¿ç”¨æ˜‚è´µçš„ LLM æ¨ç†</p>
</li>
<li>
<p>ç²¾åº¦æå‡ï¼šå…ˆç”¨æ•°å­¦æ–¹æ³•ç²—ç­›ï¼Œå†ç”¨è¯­ä¹‰æ–¹æ³•ç²¾ç­›</p>
</li>
<li>
<p>æ¨¡å—åŒ–è®¾è®¡ï¼šä¸¤ä¸ªç»„ä»¶èŒè´£åˆ†æ˜ï¼Œä¾¿äºç‹¬ç«‹ä¼˜åŒ–å’Œæ›¿æ¢</p>
</li>
<li>
<p>é€‚åº”ä¸åŒåœºæ™¯ï¼š</p>
<ul>
<li>å¿«é€Ÿæ¨¡å¼ï¼šå¯èƒ½åªä½¿ç”¨ Reranker</li>
<li>ç²¾ç»†æ¨¡å¼ï¼šä¸¤è€…éƒ½ä½¿ç”¨ä»¥è·å¾—æœ€ä½³ç»“æœ</li>
</ul>
</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿæ—¢èƒ½åœ¨ä¿è¯æ£€ç´¢è´¨é‡çš„åŒæ—¶æ§åˆ¶è®¡ç®—æˆæœ¬ï¼Œåˆèƒ½æ ¹æ®ä¸åŒçš„åº”ç”¨åœºæ™¯çµæ´»è°ƒæ•´å¤„ç†æµç¨‹ã€‚</p>
<h5 data-id="heading-37">2.9.4 å…·ä½“ç¤ºä¾‹</h5>
<p>å‡è®¾ç”¨æˆ·æŸ¥è¯¢ï¼šâ€œæœºå™¨å­¦ä¹ ä¸­çš„æ¢¯åº¦ä¸‹é™ç®—æ³•å¦‚ä½•å·¥ä½œï¼Ÿâ€</p>
<ul>
<li>
<p>åˆå§‹æ£€ç´¢ï¼šç³»ç»Ÿå¯èƒ½æ£€ç´¢åˆ° 100 ä¸ªç›¸å…³è®°å¿†é¡¹</p>
</li>
<li>
<p>Reranker å¤„ç†ï¼š</p>
<ul>
<li>è®¡ç®—æŸ¥è¯¢ä¸æ¯ä¸ªè®°å¿†é¡¹çš„ä½™å¼¦ç›¸ä¼¼åº¦</li>
<li>æ ¹æ®å±‚çº§æƒé‡ï¼ˆtopic/concept/factï¼‰è°ƒæ•´å¾—åˆ†</li>
<li>è¿”å›å‰ 20 ä¸ªæœ€ç›¸å…³çš„è®°å¿†é¡¹</li>
</ul>
</li>
<li>
<p>Reasoner å¤„ç†ï¼š</p>
<ul>
<li>å°†å‰ 20 ä¸ªè®°å¿†é¡¹å’ŒæŸ¥è¯¢ä¸€èµ·äº¤ç»™ LLM</li>
<li>LLM åˆ†æå“ªäº›è®°å¿†é¡¹çœŸæ­£å›ç­”äº†ç”¨æˆ·çš„é—®é¢˜</li>
<li>å¯èƒ½å‘ç°åªæœ‰å…¶ä¸­ 5 ä¸ªè®°å¿†é¡¹çœŸæ­£ç›¸å…³ä¸”äº’è¡¥</li>
<li>è¿”å›è¿™ 5 ä¸ªæœ€åˆé€‚çš„è®°å¿†é¡¹</li>
</ul>
</li>
</ul>
<h3 data-id="heading-38">0x03 å­å›¾æ£€ç´¢</h3>
<h4 data-id="heading-39">3.1 åŠŸèƒ½</h4>
<p>get_relevant_subgraphæ–¹æ³•çš„åŠŸèƒ½æ˜¯ï¼š</p>
<ul>
<li>
<p>æŸ¥æ‰¾ä¸æŸ¥è¯¢ç›¸å…³çš„å±€éƒ¨å­å›¾ï¼ˆFind Relevant Local Subgraphï¼‰</p>
<ul>
<li>æ¥æ”¶ç”¨æˆ·æŸ¥è¯¢å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥</li>
<li>é€šè¿‡åµŒå…¥æ¨¡å‹å°†æŸ¥è¯¢è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º</li>
<li>åœ¨å›¾æ•°æ®åº“ä¸­æœç´¢ä¸æŸ¥è¯¢å‘é‡æœ€ç›¸ä¼¼çš„å‰kä¸ªèŠ‚ç‚¹</li>
</ul>
</li>
</ul>

<ul>
<li>
<p>æ„å»ºé‚»åŸŸå­å›¾ï¼ˆBuild Neighborhood Subgraphsï¼‰ï¼Œå¯¹æ¯ä¸ªç›¸ä¼¼èŠ‚ç‚¹ï¼š</p>
<ul>
<li>ç¡®ä¿å…¶çŠ¶æ€ç¬¦åˆæŒ‡å®šæ¡ä»¶ï¼ˆé»˜è®¤ä¸º"activated"ï¼‰</li>
<li>è·å–ä»¥è¯¥èŠ‚ç‚¹ä¸ºä¸­å¿ƒã€æŒ‡å®šæ·±åº¦ï¼ˆé»˜è®¤2è·³ï¼‰çš„å±€éƒ¨å­å›¾</li>
<li>æ”¶é›†ä¸­å¿ƒèŠ‚ç‚¹ã€é‚»å±…èŠ‚ç‚¹å’Œè¿æ¥è¾¹</li>
</ul>
</li>
</ul>

<ul>
<li>
<p>åˆå¹¶å¤šä¸ªå­å›¾ä¸ºç»Ÿä¸€ç»“æ„ï¼ˆMerge Subgraphsï¼‰</p>
<ul>
<li>
<p>å°†æ‰€æœ‰æ£€ç´¢åˆ°çš„å±€éƒ¨å­å›¾åˆå¹¶æˆä¸€ä¸ªè¿é€šçš„å­å›¾</p>
</li>
<li>
<p>å»é™¤é‡å¤èŠ‚ç‚¹å’Œè¾¹</p>
</li>
<li>
<p>è¿”å›åŒ…å«ä»¥ä¸‹ä¿¡æ¯çš„å­—å…¸ç»“æ„ï¼š</p>
<ul>
<li>core_id: æœ€åŒ¹é…çš„æ ¸å¿ƒèŠ‚ç‚¹ID</li>
<li>nodes: åˆå¹¶åçš„å”¯ä¸€èŠ‚ç‚¹åˆ—è¡¨</li>
<li>edges: åˆå¹¶åçš„å”¯ä¸€è¾¹åˆ—è¡¨</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºéœ€è¦ç†è§£å¤æ‚å…³ç³»å’Œä¸Šä¸‹æ–‡çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æŸ¥æ‰¾ä¸ç‰¹å®šä¸»é¢˜ç›¸å…³çš„çŸ¥è¯†ç½‘ç»œç‰‡æ®µ</li>
<li>è¿›è¡Œå¤šè·³æ¨ç†ä»¥å‘ç°é—´æ¥å…³è”</li>
<li>æä¾›å¯è§£é‡Šçš„è®°å¿†æ£€ç´¢ç»“æœï¼Œå±•ç¤ºèŠ‚ç‚¹é—´çš„å…³ç³»è·¯å¾„</li>
</ul>
<p>ä¸»è¦ä¼˜åŠ¿åœ¨äºå®ƒä¸ä»…è¿”å›ç›¸å…³èŠ‚ç‚¹ï¼Œè¿˜ä¿ç•™äº†å®ƒä»¬ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ç»“æ„ï¼Œè¿™å¯¹äºé«˜çº§æ¨ç†ä»»åŠ¡éå¸¸æœ‰ç”¨ã€‚</p>
<h4 data-id="heading-40">3.2 ä»£ç </h4>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"> Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_relevant_subgraph</span>(<span class="hljs-params">
 Â  Â  Â  Â self, query: <span class="hljs-built_in">str</span>, top_k: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span>, depth: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>, center_status: <span class="hljs-built_in">str</span> = <span class="hljs-string">"activated"</span>
 Â   </span>) -&gt; <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]:
 Â  Â  Â  Â <span class="hljs-string">"""
 Â  Â  Â   Find and merge the local neighborhood sub-graphs of the top-k
 Â  Â  Â   nodes most relevant to the query.
 Â  Â  Â  Â  Process:
 Â  Â  Â  Â  Â  Â  1. Embed the user query into a vector representation.
 Â  Â  Â  Â  Â  Â  2. Use vector similarity search to find the top-k similar nodes.
 Â  Â  Â  Â  Â  Â  3. For each similar node:
 Â  Â  Â  Â  Â  Â  Â  Â  - Ensure its status matches `center_status` (e.g., 'active').
 Â  Â  Â  Â  Â  Â  Â  Â  - Retrieve its local subgraph up to `depth` hops.
 Â  Â  Â  Â  Â  Â  Â  Â  - Collect the center node, its neighbors, and connecting edges.
 Â  Â  Â  Â  Â  Â  4. Merge all retrieved subgraphs into a single unified subgraph.
 Â  Â  Â  Â  Â  Â  5. Return the merged subgraph structure.
â€‹
 Â  Â  Â  Â  Args:
 Â  Â  Â  Â  Â  Â  query (str): The user input or concept to find relevant memories for.
 Â  Â  Â  Â  Â  Â  top_k (int, optional): How many top similar nodes to retrieve. Default is 5.
 Â  Â  Â  Â  Â  Â  depth (int, optional): The neighborhood depth (number of hops). Default is 2.
 Â  Â  Â  Â  Â  Â  center_status (str, optional): Status condition the center node must satisfy (e.g., 'active').
â€‹
 Â  Â  Â  Â  Returns:
 Â  Â  Â  Â  Â  Â  dict[str, Any]: A subgraph dict with:
 Â  Â  Â  Â  Â  Â  Â  Â  - 'core_id': ID of the top matching core node, or None if none found.
 Â  Â  Â  Â  Â  Â  Â  Â  - 'nodes': List of unique nodes (core + neighbors) in the merged subgraph.
 Â  Â  Â  Â  Â  Â  Â  Â  - 'edges': List of unique edges (as dicts with 'from', 'to', 'type') in the merged subgraph.
 Â  Â  Â   """</span>
 Â  Â  Â  Â <span class="hljs-comment"># Step 1: Embed query</span>
 Â  Â  Â  Â query_embedding = self.embedder.embed([query])[<span class="hljs-number">0</span>]
â€‹
 Â  Â  Â  Â <span class="hljs-comment"># Step 2: Get top-1 similar node</span>
 Â  Â  Â  Â similar_nodes = self.graph_store.search_by_embedding(query_embedding, top_k=top_k)
 Â  Â  Â  Â <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> similar_nodes:
 Â  Â  Â  Â  Â  Â logger.info(<span class="hljs-string">"No similar nodes found for query embedding."</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> {<span class="hljs-string">"core_id"</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">"nodes"</span>: [], <span class="hljs-string">"edges"</span>: []}
â€‹
 Â  Â  Â  Â <span class="hljs-comment"># Step 3: Fetch neighborhood</span>
 Â  Â  Â  Â all_nodes = {}
 Â  Â  Â  Â all_edges = <span class="hljs-built_in">set</span>()
 Â  Â  Â  Â cores = []
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> similar_nodes:
 Â  Â  Â  Â  Â  Â core_id = node[<span class="hljs-string">"id"</span>]
 Â  Â  Â  Â  Â  Â score = node[<span class="hljs-string">"score"</span>]
â€‹
 Â  Â  Â  Â  Â  Â subgraph = self.graph_store.get_subgraph(
 Â  Â  Â  Â  Â  Â  Â  Â center_id=core_id, depth=depth, center_status=center_status
 Â  Â  Â  Â  Â   )
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> subgraph[<span class="hljs-string">"core_node"</span>]:
 Â  Â  Â  Â  Â  Â  Â  Â logger.info(<span class="hljs-string">f"Skipping node <span class="hljs-subst">{core_id}</span> (inactive or not found)."</span>)
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">continue</span>
â€‹
 Â  Â  Â  Â  Â  Â core_node = subgraph[<span class="hljs-string">"core_node"</span>]
 Â  Â  Â  Â  Â  Â neighbors = subgraph[<span class="hljs-string">"neighbors"</span>]
 Â  Â  Â  Â  Â  Â edges = subgraph[<span class="hljs-string">"edges"</span>]
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Collect nodes</span>
 Â  Â  Â  Â  Â  Â all_nodes[core_node[<span class="hljs-string">"id"</span>]] = core_node
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> neighbors:
 Â  Â  Â  Â  Â  Â  Â  Â all_nodes[n[<span class="hljs-string">"id"</span>]] = n
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Collect edges</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> edges:
 Â  Â  Â  Â  Â  Â  Â  Â all_edges.add((e[<span class="hljs-string">"source"</span>], e[<span class="hljs-string">"target"</span>], e[<span class="hljs-string">"type"</span>]))
â€‹
 Â  Â  Â  Â  Â  Â cores.append(
 Â  Â  Â  Â  Â  Â  Â   {<span class="hljs-string">"id"</span>: core_id, <span class="hljs-string">"score"</span>: score, <span class="hljs-string">"core_node"</span>: core_node, <span class="hljs-string">"neighbors"</span>: neighbors}
 Â  Â  Â  Â  Â   )
â€‹
 Â  Â  Â  Â top_core = cores[<span class="hljs-number">0</span>]
 Â  Â  Â  Â <span class="hljs-keyword">return</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"core_id"</span>: top_core[<span class="hljs-string">"id"</span>],
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"nodes"</span>: <span class="hljs-built_in">list</span>(all_nodes.values()),
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"edges"</span>: [{<span class="hljs-string">"source"</span>: f, <span class="hljs-string">"target"</span>: t, <span class="hljs-string">"type"</span>: ty} <span class="hljs-keyword">for</span> (f, t, ty) <span class="hljs-keyword">in</span> all_edges],
 Â  Â  Â   }
</code></pre>
<h3 data-id="heading-41">0x04 å›¾æ•°æ®åº“</h3>
<p>å› ä¸ºå›¾æ•°æ®åº“æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬é€šè¿‡ç¤ºä¾‹æ¥è¿›è¡Œå­¦ä¹ ï¼Œä»¥ç®¡çª¥è±¹ã€‚</p>
<h4 data-id="heading-42">4.1 ç¤ºä¾‹</h4>
<p>run_user_session å‡½æ•°ä¸­ä¾¿æœ‰æœç´¢å†…å®¹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_user_session</span>(<span class="hljs-params">
 Â  Â user_name: <span class="hljs-built_in">str</span>,
 Â  Â db_name: <span class="hljs-built_in">str</span>,
 Â  Â topic_text: <span class="hljs-built_in">str</span>,
 Â  Â concept_texts: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>],
 Â  Â fact_texts: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>],
</span>):
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n=== <span class="hljs-subst">{user_name}</span> starts building their memory graph ==="</span>)
â€‹
 Â  Â <span class="hljs-comment"># Manually initialize correct GraphDB class</span>
 Â  Â config = GraphDBConfigFactory(
 Â  Â  Â  Â backend=<span class="hljs-string">"nebular"</span>,
 Â  Â  Â  Â config={
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"uri"</span>: json.loads(os.getenv(<span class="hljs-string">"NEBULAR_HOSTS"</span>, <span class="hljs-string">"localhost"</span>)),
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"user"</span>: os.getenv(<span class="hljs-string">"NEBULAR_USER"</span>, <span class="hljs-string">"root"</span>),
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"password"</span>: os.getenv(<span class="hljs-string">"NEBULAR_PASSWORD"</span>, <span class="hljs-string">"xxxxxx"</span>),
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"space"</span>: db_name,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"user_name"</span>: user_name,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"use_multi_db"</span>: <span class="hljs-literal">False</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"auto_create"</span>: <span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"embedding_dimension"</span>: embedder_dimension,
 Â  Â  Â   },
 Â   )
 Â  Â graph = GraphStoreFactory.from_config(config)
â€‹
 Â  Â <span class="hljs-comment"># Start with a clean slate for this user</span>
 Â  Â graph.clear()
â€‹
 Â  Â now = datetime.now(timezone.utc).isoformat()
â€‹
 Â  Â <span class="hljs-comment"># === Step 1: Create a root topic node (e.g., user's research focus) ===</span>
 Â  Â topic = TextualMemoryItem(
 Â  Â  Â  Â memory=topic_text,
 Â  Â  Â  Â metadata=TreeNodeTextualMemoryMetadata(
 Â  Â  Â  Â  Â  Â memory_type=<span class="hljs-string">"LongTermMemory"</span>,
 Â  Â  Â  Â  Â  Â key=<span class="hljs-string">"Research Topic"</span>,
 Â  Â  Â  Â  Â  Â hierarchy_level=<span class="hljs-string">"topic"</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-built_in">type</span>=<span class="hljs-string">"fact"</span>,
 Â  Â  Â  Â  Â  Â memory_time=<span class="hljs-string">"2024-01-01"</span>,
 Â  Â  Â  Â  Â  Â status=<span class="hljs-string">"activated"</span>,
 Â  Â  Â  Â  Â  Â visibility=<span class="hljs-string">"public"</span>,
 Â  Â  Â  Â  Â  Â tags=[<span class="hljs-string">"research"</span>, <span class="hljs-string">"rl"</span>],
 Â  Â  Â  Â  Â  Â updated_at=now,
 Â  Â  Â  Â  Â  Â embedding=embed_memory_item(topic_text),
 Â  Â  Â   ),
 Â   )
 Â  Â graph.add_node(topic.<span class="hljs-built_in">id</span>, topic.memory, topic.metadata.model_dump(exclude_none=<span class="hljs-literal">True</span>))
â€‹
 Â  Â <span class="hljs-comment"># === Step 2: Create two concept nodes linked to the topic ===</span>
 Â  Â concept_items = []
 Â  Â <span class="hljs-keyword">for</span> i, text <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(concept_texts):
 Â  Â  Â  Â concept = TextualMemoryItem(
 Â  Â  Â  Â  Â  Â memory=text,
 Â  Â  Â  Â  Â  Â metadata=TreeNodeTextualMemoryMetadata(
 Â  Â  Â  Â  Â  Â  Â  Â memory_type=<span class="hljs-string">"LongTermMemory"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â key=<span class="hljs-string">f"Concept <span class="hljs-subst">{i + <span class="hljs-number">1</span>}</span>"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â hierarchy_level=<span class="hljs-string">"concept"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">type</span>=<span class="hljs-string">"fact"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â memory_time=<span class="hljs-string">"2024-01-01"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â status=<span class="hljs-string">"activated"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â visibility=<span class="hljs-string">"public"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â updated_at=now,
 Â  Â  Â  Â  Â  Â  Â  Â embedding=embed_memory_item(text),
 Â  Â  Â  Â  Â  Â  Â  Â tags=[<span class="hljs-string">"concept"</span>],
 Â  Â  Â  Â  Â  Â  Â  Â confidence=<span class="hljs-number">90</span> + i,
 Â  Â  Â  Â  Â   ),
 Â  Â  Â   )
 Â  Â  Â  Â graph.add_node(concept.<span class="hljs-built_in">id</span>, concept.memory, concept.metadata.model_dump(exclude_none=<span class="hljs-literal">True</span>))
 Â  Â  Â  Â graph.add_edge(topic.<span class="hljs-built_in">id</span>, concept.<span class="hljs-built_in">id</span>, <span class="hljs-built_in">type</span>=<span class="hljs-string">"PARENT"</span>)
 Â  Â  Â  Â concept_items.append(concept)
â€‹
 Â  Â <span class="hljs-comment"># === Step 3: Create supporting facts under each concept ===</span>
 Â  Â <span class="hljs-keyword">for</span> i, text <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(fact_texts):
 Â  Â  Â  Â fact = TextualMemoryItem(
 Â  Â  Â  Â  Â  Â memory=text,
 Â  Â  Â  Â  Â  Â metadata=TreeNodeTextualMemoryMetadata(
 Â  Â  Â  Â  Â  Â  Â  Â memory_type=<span class="hljs-string">"WorkingMemory"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â key=<span class="hljs-string">f"Fact <span class="hljs-subst">{i + <span class="hljs-number">1</span>}</span>"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â hierarchy_level=<span class="hljs-string">"fact"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">type</span>=<span class="hljs-string">"fact"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â memory_time=<span class="hljs-string">"2024-01-01"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â status=<span class="hljs-string">"activated"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â visibility=<span class="hljs-string">"public"</span>,
 Â  Â  Â  Â  Â  Â  Â  Â updated_at=now,
 Â  Â  Â  Â  Â  Â  Â  Â embedding=embed_memory_item(text),
 Â  Â  Â  Â  Â  Â  Â  Â confidence=<span class="hljs-number">85.0</span>,
 Â  Â  Â  Â  Â  Â  Â  Â tags=[<span class="hljs-string">"fact"</span>],
 Â  Â  Â  Â  Â   ),
 Â  Â  Â   )
 Â  Â  Â  Â graph.add_node(fact.<span class="hljs-built_in">id</span>, fact.memory, fact.metadata.model_dump(exclude_none=<span class="hljs-literal">True</span>))
 Â  Â  Â  Â graph.add_edge(concept_items[i % <span class="hljs-built_in">len</span>(concept_items)].<span class="hljs-built_in">id</span>, fact.<span class="hljs-built_in">id</span>, <span class="hljs-built_in">type</span>=<span class="hljs-string">"PARENT"</span>)
â€‹
 Â  Â <span class="hljs-comment"># === Step 4: Retrieve memory using semantic search ===</span>
 Â  Â vector = embed_memory_item(<span class="hljs-string">"How is memory retrieved?"</span>)
 Â  Â search_result = graph.search_by_embedding(vector, top_k=<span class="hljs-number">2</span>)
 Â  Â <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> search_result:
 Â  Â  Â  Â node = graph.get_node(r[<span class="hljs-string">"id"</span>])
 Â  Â  Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ” Search result:"</span>, node[<span class="hljs-string">"memory"</span>])
â€‹
 Â  Â <span class="hljs-comment"># === Step 5: Tag-based neighborhood discovery ===</span>
 Â  Â neighbors = graph.get_neighbors_by_tag([<span class="hljs-string">"concept"</span>], exclude_ids=[], top_k=<span class="hljs-number">2</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“ Tag-related nodes:"</span>, [neighbor[<span class="hljs-string">"memory"</span>] <span class="hljs-keyword">for</span> neighbor <span class="hljs-keyword">in</span> neighbors])
â€‹
 Â  Â <span class="hljs-comment"># === Step 6: Retrieve children (facts) of first concept ===</span>
 Â  Â children = graph.get_children_with_embeddings(concept_items[<span class="hljs-number">0</span>].<span class="hljs-built_in">id</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“ Children of concept:"</span>, [child[<span class="hljs-string">"memory"</span>] <span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> children])
â€‹
 Â  Â <span class="hljs-comment"># === Step 7: Export a local subgraph and grouped statistics ===</span>
 Â  Â subgraph = graph.get_subgraph(topic.<span class="hljs-built_in">id</span>, depth=<span class="hljs-number">2</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“Œ Subgraph node count:"</span>, <span class="hljs-built_in">len</span>(subgraph[<span class="hljs-string">"neighbors"</span>]))
â€‹
 Â  Â stats = graph.get_grouped_counts([<span class="hljs-string">"memory_type"</span>, <span class="hljs-string">"status"</span>])
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“Š Grouped counts:"</span>, stats)
â€‹
 Â  Â <span class="hljs-comment"># === Step 8: Demonstrate updates and cleanup ===</span>
 Â  Â graph.update_node(
 Â  Â  Â  Â concept_items[<span class="hljs-number">0</span>].<span class="hljs-built_in">id</span>, {<span class="hljs-string">"confidence"</span>: <span class="hljs-number">99.0</span>, <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2025-07-24T20:11:56.375687"</span>}
 Â   )
 Â  Â graph.remove_oldest_memory(<span class="hljs-string">"WorkingMemory"</span>, keep_latest=<span class="hljs-number">1</span>)
 Â  Â graph.delete_edge(topic.<span class="hljs-built_in">id</span>, concept_items[<span class="hljs-number">0</span>].<span class="hljs-built_in">id</span>, <span class="hljs-built_in">type</span>=<span class="hljs-string">"PARENT"</span>)
 Â  Â graph.delete_node(concept_items[<span class="hljs-number">1</span>].<span class="hljs-built_in">id</span>)
â€‹
 Â  Â <span class="hljs-comment"># === Step 9: Export and re-import the entire graph structure ===</span>
 Â  Â exported = graph.export_graph()
 Â  Â graph.import_graph(exported)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“¦ Graph exported and re-imported, total nodes:"</span>, <span class="hljs-built_in">len</span>(exported[<span class="hljs-string">"nodes"</span>]))
â€‹
 Â  Â <span class="hljs-comment"># ====================================</span>
 Â  Â <span class="hljs-comment"># ğŸ” Step 10: extra function</span>
 Â  Â <span class="hljs-comment"># ====================================</span>
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n=== ğŸ” Extra Tests for user: <span class="hljs-subst">{user_name}</span> ==="</span>)
â€‹
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - Memory count:"</span>, graph.get_memory_count(<span class="hljs-string">"LongTermMemory"</span>))
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - Node count:"</span>, graph.count_nodes(<span class="hljs-string">"LongTermMemory"</span>))
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - All LongTermMemory items:"</span>, graph.get_all_memory_items(<span class="hljs-string">"LongTermMemory"</span>))
â€‹
 Â  Â <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(exported[<span class="hljs-string">"edges"</span>]) &gt; <span class="hljs-number">0</span>:
 Â  Â  Â  Â n1, n2 = exported[<span class="hljs-string">"edges"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"source"</span>], exported[<span class="hljs-string">"edges"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"target"</span>]
 Â  Â  Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - Edge exists?"</span>, graph.edge_exists(n1, n2, exported[<span class="hljs-string">"edges"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"type"</span>]))
 Â  Â  Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - Edges for node:"</span>, graph.get_edges(n1))
â€‹
 Â  Â filters = [{<span class="hljs-string">"field"</span>: <span class="hljs-string">"memory_type"</span>, <span class="hljs-string">"op"</span>: <span class="hljs-string">"="</span>, <span class="hljs-string">"value"</span>: <span class="hljs-string">"LongTermMemory"</span>}]
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - Metadata query result:"</span>, graph.get_by_metadata(filters))
 Â  Â <span class="hljs-built_in">print</span>(
 Â  Â  Â  Â <span class="hljs-string">" - Optimization candidates:"</span>, graph.get_structure_optimization_candidates(<span class="hljs-string">"LongTermMemory"</span>)
 Â   )
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â graph.drop_database()
 Â  Â <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">" - drop_database raised ValueError as expected:"</span>, e)
</code></pre>
<h4 data-id="heading-43">4.2 get_neighbors_by_tag</h4>
<p>get_neighbors_by_tag åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ï¼š</p>
<h5 data-id="heading-44">4.2.1 åŠŸèƒ½æ¦‚è¿°</h5>
<p>get_neighbors_by_tag æ˜¯åŸºäºæ ‡ç­¾çš„é‚»å±…èŠ‚ç‚¹æ£€ç´¢æ–¹æ³•ï¼Œç”¨äºåœ¨å›¾æ•°æ®åº“ä¸­æŸ¥æ‰¾ä¸ç»™å®šèŠ‚ç‚¹å…·æœ‰ç›¸ä¼¼æ ‡ç­¾çš„ç›¸é‚»èŠ‚ç‚¹ã€‚é€šè¿‡è®¡ç®—æ ‡ç­¾é‡å åº¦è¯†åˆ«è¯­ä¹‰ç›¸å…³èŠ‚ç‚¹ï¼Œæ”¯æŒåŸºäºæ ‡ç­¾çš„å›¾éå†ä¸æ¨èã€‚</p>
<h5 data-id="heading-45">4.2.2 åº”ç”¨åœºæ™¯</h5>
<p>è®°å¿†é‡ç»„é˜¶æ®µå‘ç°å…·æœ‰å…±åŒä¸»é¢˜æˆ–æ¦‚å¿µçš„ç›¸å…³è®°å¿†èŠ‚ç‚¹ã€‚</p>
<p>æ”¯æŒæ¨ç†ä¸å…³è”åˆ†æï¼Œæ„å»ºè®°å¿†ä¹‹é—´çš„è¯­ä¹‰è¿æ¥ã€‚</p>
<p>ç”¨äºèšç±»åˆ†æï¼Œè¯†åˆ«æ ‡ç­¾ç»„åˆç›¸ä¼¼çš„èŠ‚ç‚¹ç¾¤ç»„ã€‚</p>
<h5 data-id="heading-46">4.2.3 å‚æ•°è¯´æ˜</h5>
<ul>
<li>tags (list[str])ï¼šç›®æ ‡æ ‡ç­¾åˆ—è¡¨ï¼Œç”¨äºåŒ¹é…ç›¸ä¼¼èŠ‚ç‚¹ã€‚</li>
<li>_exclude_ids (list[str])ï¼šéœ€æ’é™¤çš„èŠ‚ç‚¹ ID åˆ—è¡¨ï¼Œé¿å…è¿”å›è‡ªèº«æˆ–å·²çŸ¥èŠ‚ç‚¹ã€‚</li>
<li>top_k (int)ï¼šè¿”å›ç»“æœæ•°é‡ä¸Šé™ï¼Œé»˜è®¤é€šå¸¸ä¸º 5ã€‚</li>
<li>min_overlap (int)ï¼šæœ€å°æ ‡ç­¾é‡å æ•°ï¼Œä»…è¿”å›æ»¡è¶³è¯¥æ¡ä»¶çš„èŠ‚ç‚¹ã€‚</li>
</ul>
<h5 data-id="heading-47">4.2.4 ç­›é€‰æœºåˆ¶</h5>
<ul>
<li>æ ‡ç­¾äº¤é›†è®¡ç®—ï¼šæ¯”è¾ƒç›®æ ‡æ ‡ç­¾ä¸å€™é€‰èŠ‚ç‚¹æ ‡ç­¾çš„äº¤é›†å¤§å°ç¡®å®šç›¸å…³æ€§ã€‚</li>
<li>æœ€å°é‡å é˜ˆå€¼ï¼šä»…è¿”å›æ ‡ç­¾é‡å æ•°â‰¥min_overlap çš„èŠ‚ç‚¹ã€‚</li>
<li>æ’é™¤æœºåˆ¶ï¼šè¿‡æ»¤ _exclude_ids æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œé˜²æ­¢å¾ªç¯å¼•ç”¨ã€‚</li>
</ul>
<h5 data-id="heading-48">4.2.5 æ£€ç´¢æµç¨‹</h5>
<ul>
<li>æ ¹æ®è¾“å…¥æ ‡ç­¾åœ¨å›¾æ•°æ®åº“ä¸­æŸ¥æ‰¾åŒ…å«è¿™äº›æ ‡ç­¾çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</li>
<li>è®¡ç®—æ¯ä¸ªå€™é€‰èŠ‚ç‚¹ä¸ç›®æ ‡æ ‡ç­¾é›†åˆçš„äº¤é›†å¤§å°ã€‚</li>
<li>è¿‡æ»¤ä¸æ»¡è¶³æœ€å°é‡å è¦æ±‚çš„èŠ‚ç‚¹ã€‚</li>
<li>æŒ‰æ ‡ç­¾é‡å ç¨‹åº¦æ’åºå¹¶æˆªå–å‰ k ä¸ªèŠ‚ç‚¹ã€‚</li>
</ul>
<h5 data-id="heading-49">4.2.6 æ€§èƒ½ä¼˜åŒ–</h5>
<ul>
<li>åˆ©ç”¨å›¾æ•°æ®åº“ç´¢å¼•åŠ é€Ÿæ ‡ç­¾æŸ¥è¯¢ã€‚</li>
<li>é€šè¿‡æ‰¹é‡æ“ä½œå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ã€‚</li>
<li>æ”¯æŒå¹¶å‘æ‰§è¡Œï¼Œæé«˜å¤§è§„æ¨¡å›¾æ£€ç´¢æ•ˆç‡ã€‚</li>
</ul>
<p>MemOS-main\src\memos\graph_dbs\nebular.py ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"> Â  Â <span class="hljs-variable">@timed</span>
 Â  Â def <span class="hljs-built_in">get_neighbors_by_tag</span>(
 Â  Â  Â  Â self,
 Â  Â  Â  Â <span class="hljs-attribute">tags</span>: list[str],
 Â  Â  Â  Â <span class="hljs-attribute">exclude_ids</span>: list[str],
 Â  Â  Â  Â <span class="hljs-attribute">top_k</span>: int = <span class="hljs-number">5</span>,
 Â  Â  Â  Â <span class="hljs-attribute">min_overlap</span>: int = <span class="hljs-number">1</span>,
 Â  Â  Â  Â <span class="hljs-attribute">include_embedding</span>: bool = False,
 Â   ) -&gt; list[dict[str, Any]]:
 Â  Â  Â  Â <span class="hljs-string">""</span>"
 Â  Â  Â   Find top-K neighbor nodes with maximum tag overlap.
â€‹
 Â  Â  Â   <span class="hljs-attribute">Args</span>:
 Â  Â  Â  Â  Â   <span class="hljs-attribute">tags</span>: The list of tags to match.
 Â  Â  Â  Â  Â   <span class="hljs-attribute">exclude_ids</span>: Node IDs to exclude (e.g., local cluster).
 Â  Â  Â  Â  Â   <span class="hljs-attribute">top_k</span>: Max number of neighbors to return.
 Â  Â  Â  Â  Â   <span class="hljs-attribute">min_overlap</span>: Minimum number of overlapping tags required.
 Â  Â  Â  Â  Â   <span class="hljs-attribute">include_embedding</span>: with/without embedding
â€‹
 Â  Â  Â   <span class="hljs-attribute">Returns</span>:
 Â  Â  Â  Â  Â   List of dicts with node details <span class="hljs-keyword">and</span> overlap count.
 Â  Â  Â   <span class="hljs-string">""</span>"
 Â  Â  Â  Â if <span class="hljs-keyword">not</span> <span class="hljs-attribute">tags</span>:
 Â  Â  Â  Â  Â  Â return []
â€‹
 Â  Â  Â  Â where_clauses = [
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'n.status = "activated"'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'NOT (n.node_type = "reasoning")'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'NOT (n.memory_type = "WorkingMemory")'</span>,
 Â  Â  Â   ]
 Â  Â  Â  Â if <span class="hljs-attribute">exclude_ids</span>:
 Â  Â  Â  Â  Â  Â where_clauses.<span class="hljs-built_in">append</span>(f<span class="hljs-string">"NOT (n.id IN {exclude_ids})"</span>)
â€‹
 Â  Â  Â  Â where_clauses.<span class="hljs-built_in">append</span>(f<span class="hljs-string">'n.user_name = "{self.config.user_name}"'</span>)
â€‹
 Â  Â  Â  Â where_clause = <span class="hljs-string">" AND "</span>.<span class="hljs-built_in">join</span>(where_clauses)
 Â  Â  Â  Â tag_list_literal = <span class="hljs-string">"["</span> + <span class="hljs-string">", "</span>.<span class="hljs-built_in">join</span>(f<span class="hljs-string">'"{_escape_str(t)}"'</span> for t in tags) + <span class="hljs-string">"]"</span>
â€‹
 Â  Â  Â  Â return_fields = self.<span class="hljs-built_in">_build_return_fields</span>(include_embedding)
 Â  Â  Â  Â query = f<span class="hljs-string">""</span>"
 Â  Â  Â  Â  Â   LET tag_list = {<span class="hljs-selector-tag">tag_list_literal</span>}
â€‹
 Â  Â  Â  Â  Â   <span class="hljs-selector-tag">MATCH</span> (n<span class="hljs-variable">@Memory</span> <span class="hljs-comment">/*+ INDEX(idx_memory_user_name) */</span>)
 Â  Â  Â  Â  Â   <span class="hljs-selector-tag">WHERE</span> {<span class="hljs-selector-tag">where_clause</span>}
 Â  Â  Â  Â  Â   <span class="hljs-selector-tag">RETURN</span> {<span class="hljs-selector-tag">return_fields</span>},
 Â  Â  Â  Â  Â  Â  Â  <span class="hljs-selector-tag">size</span>( <span class="hljs-built_in">filter</span>( n.tags, t -&gt; t IN tag_list ) ) <span class="hljs-selector-tag">AS</span> <span class="hljs-selector-tag">overlap_count</span>
 Â  Â  Â  Â  Â   <span class="hljs-selector-tag">ORDER</span> <span class="hljs-selector-tag">BY</span> <span class="hljs-selector-tag">overlap_count</span> <span class="hljs-selector-tag">DESC</span>
 Â  Â  Â  Â  Â   <span class="hljs-selector-tag">LIMIT</span> {<span class="hljs-selector-tag">top_k</span>}
 Â  Â  Â  Â  Â   """
â€‹
 Â  Â  Â  Â <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">self</span><span class="hljs-selector-class">.execute_query</span>(query)
 Â  Â  Â  Â <span class="hljs-selector-tag">neighbors</span>: <span class="hljs-selector-tag">list</span><span class="hljs-selector-attr">[dict[str, Any]</span>] = <span class="hljs-selector-attr">[]</span>
 Â  Â  Â  Â <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">r</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">result</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">props</span> = {k: v.value for k, v in r.items() if k != "overlap_count"}
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">parsed</span> = <span class="hljs-selector-tag">self</span><span class="hljs-selector-class">._parse_node</span>(props)
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">parsed</span><span class="hljs-selector-attr">[<span class="hljs-string">"overlap_count"</span>]</span> = <span class="hljs-selector-tag">r</span><span class="hljs-selector-attr">[<span class="hljs-string">"overlap_count"</span>]</span><span class="hljs-selector-class">.value</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">neighbors</span><span class="hljs-selector-class">.append</span>(parsed)
â€‹
 Â  Â  Â  Â <span class="hljs-selector-tag">neighbors</span><span class="hljs-selector-class">.sort</span>(key=lambda <span class="hljs-attribute">x</span>: x[<span class="hljs-string">"overlap_count"</span>], reverse=True)
 Â  Â  Â  Â <span class="hljs-selector-tag">neighbors</span> = <span class="hljs-selector-tag">neighbors</span><span class="hljs-selector-attr">[:top_k]</span>
 Â  Â  Â  Â <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-attr">[]</span>
 Â  Â  Â  Â <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">neighbor</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">neighbors</span><span class="hljs-selector-attr">[:top_k]</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">neighbor</span><span class="hljs-selector-class">.pop</span>(<span class="hljs-string">"overlap_count"</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(neighbor)
 Â  Â  Â  Â <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸è°ˆæŠ€æœ¯ï¼Œæç‚¹æ–‡åŒ– ğŸ§€ â€”â€” ä»å¤æ´»ä¸€å¥æ˜ä»£æ®‹è¯—ç ´å±€äº§å“è¿­ä»£]]></title>    <link>https://juejin.cn/post/7581299982671069218</link>    <guid>https://juejin.cn/post/7581299982671069218</guid>    <pubDate>2025-12-08T12:54:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581299982671069218" data-draft-id="7581306080434618419" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸è°ˆæŠ€æœ¯ï¼Œæç‚¹æ–‡åŒ– ğŸ§€  â€”â€”  ä»å¤æ´»ä¸€å¥æ˜ä»£æ®‹è¯—ç ´å±€äº§å“è¿­ä»£"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T12:54:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HiStewie"/> <meta itemprop="url" content="https://juejin.cn/user/1591748568038823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸è°ˆæŠ€æœ¯ï¼Œæç‚¹æ–‡åŒ– ğŸ§€  â€”â€”  ä»å¤æ´»ä¸€å¥æ˜ä»£æ®‹è¯—ç ´å±€äº§å“è¿­ä»£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748568038823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HiStewie
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T12:54:02.000Z" title="Mon Dec 08 2025 12:54:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>ä¸Šä¸€ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/7577653509862654002" target="_blank" title="https://juejin.cn/post/7577653509862654002">3å¤©ï¼Œ1äººï¼Œä»0åˆ°ä»˜è´¹äº§å“ï¼šAIæ—¶ä»£ä¸ªäººå¼€å‘è€…çš„ç”Ÿå­˜æŒ‡å—</a>ï¼Œè®²è§£äº†å¦‚ä½•ä»æŠ€æœ¯å±‚é¢ï¼Œä¸ªäººå¼€å‘ä»å‰åˆ°åï¼Œä»äº§å“åˆ°è®¾è®¡ï¼Œä»ä¼šè®¡åˆ°ä¿å®‰çš„å¼€å‘é—­ç¯å•†ä¸šäº§å“ã€‚è¿™ç¯‡ä¸»è¦è®²å¦‚ä½•è¿­ä»£é¡¹ç›®ï¼Œä¸°å¯Œå†…æ ¸ï¼Œæ­å»º <strong>Content is King</strong> äº§å“æ€è·¯</p>
<h2 data-id="heading-0">00ï½œå¼•è¨€ï¼šå½“ç¨‹åºå‘˜å¼€å§‹å†™è¯—</h2>
<p>æœ€è¿‘åœ¨åšç”Ÿå›¾äº§å“ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nthme.org%2F" target="_blank" title="https://www.nthme.org/" ref="nofollow noopener noreferrer">The Nth Me</a></strong> çš„è¿­ä»£æ„æ€æ—¶ï¼Œæˆ‘é™·å…¥äº†ä¸€ä¸ªæ€è€ƒï¼š</p>
<ul>
<li><strong>æˆ‘åš AI äº§å“çš„ç»ˆæç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></li>
</ul>
<p>æ˜¯æ›´å¿«çš„æ¨ç†é€Ÿåº¦ï¼Ÿè¿˜æ˜¯æ›´ä½çš„æ˜¾å­˜å ç”¨ï¼Ÿæ›´ä¾¿å®œçš„å®šä»·ï¼Ÿæ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Ÿ</p>
<p>é‚£å¦‚ä½•æ‰èƒ½åœ¨åŒè´¨åŒ–çš„å¥—å£³äº§å“ä¸­è„±é¢–è€Œå‡ºï¼Ÿ</p>
<ul>
<li>æ˜¯ï¼š<strong>â€œèµ‹èƒ½è¡¨è¾¾ï¼ï¼ï¼â€</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8fb892c7aa546c79fd335f7b0ee8ed5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=pNr31RJzwjrReJTyFXDMf0IyanA%3D" alt="æˆªå±2025-12-08 19.26.09.png" loading="lazy"/></p>
<p>å¶ç„¶è¯»åˆ°æ˜ä»£å¼ ç©†çš„ä¸€å¥è¯—ï¼š</p>
<blockquote>
<p>â€œä¸‡é‡Œç‹¬åŸè¿é›ªå»ï¼Œå¹³ç”Ÿä¸€å‰‘å¸¦éœœæºã€‚â€</p>
</blockquote>
<p>é‚£ç§å­¤ç‹¬ä¸å‚²éª¨ç¬é—´å‡»ä¸­äº†æˆ‘ã€‚æˆ‘å†³å®šæš‚æ—¶æ”¾ä¸‹ä»£ç ï¼Œç”¨ç°æœ‰çš„AIå·¥å…·é“¾ï¼Œè¯•å›¾å¤æ´»è¿™ä½300å¹´å‰çš„å‰‘å®¢ã€‚
åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘æ‘¸ç´¢å‡ºäº†ä¸€å¥— <strong>â€œæ–‡åŒ–é©±åŠ¨â€çš„å·¥ä½œæµ</strong>ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ã€‚</p>
<p>è€Œè¿™äº›â€œå‘â€ï¼Œæ­£æ˜¯æˆ‘ä¸‹ä¸€æ­¥äº§å“è¿­ä»£çš„æ–¹å‘ã€‚</p>
<hr/>
<h2 data-id="heading-1">01ï½œå®Œæ•´å·¥ä½œæµæ‹†è§£ (SOP)</h2>
<h3 data-id="heading-2">1. ç‚¼å­—ï¼šå…ˆæœ‰éª¨ï¼Œå†æœ‰çš®</h3>
<p>AIç»˜ç”»æœ€æ€•â€œè¯ä¸è¾¾æ„â€ã€‚åœ¨ç”Ÿæˆç”»é¢å‰ï¼Œå¿…é¡»å…ˆæ‰“ç£¨æ„å¢ƒã€‚
åŸå¥è™½å¥½ï¼Œä½†ä¸ºäº†é…åˆç”»é¢å¼ åŠ›ï¼Œæˆ‘è·Ÿ <strong>Gemini3 Pro</strong> è¿›è¡Œäº†å¤šè½®çš„æ¬¡å¯¹è¯ï¼Œæ²Ÿé€šè®¨è®º<strong>æ„å¢ƒã€å¹³ä»„ï¼Œå¿ƒå¢ƒ</strong>å†™äº†ä¸€é¦–æµŠè¯—ï¼Œä¸‹é™„æœ€ç»ˆä½œå“çš„è¯—è¯å“è¯„ï¼Œå¦‚æœæ²¡å…¥æ³•çœ¼ï¼Œè¯·å¤§å®¶å¤šåšè‡ªæˆ‘æ‰¹è¯„ï¼ˆé®è„¸é€ƒğŸ’¨ï¼‰</p>
<blockquote>
<p>åŸå¥ï¼šä¸‡é‡Œç‹¬åŸè¿é›ªå»ï¼Œå¹³ç”Ÿä¸€å‰‘å¸¦éœœæºã€‚</p>
</blockquote>
<h3 data-id="heading-3">ã€Šè›°é¾™åŸã€‹â€”â€” å‰‘æ°”è—é”‹ï¼Œå¤–å†·å†…çƒ­</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7aaba326376485384cf9bccf33f0868~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=O%2F58YJJGejHfiZgSKZYONMzyGgE%3D" alt="æˆªå±2025-12-08 20.20.44.png" loading="lazy"/></p>
<h4 data-id="heading-4">ã€æ°”è±¡ï¼šå¦‚å¤å‰‘å…¥é˜ã€‘</h4>
<p>æ•´é¦–è¯—çš„å¼ åŠ›ï¼Œæºäº <strong>â€œå†·â€ä¸â€œçƒ­â€çš„æè‡´åå·®</strong>ã€‚
è¡¨è±¡æ˜¯å†°é›ªã€é£éœœã€å°˜æ³¥çš„æå¯’ä½å‹ï¼›
å†…æ ¸å´æ˜¯å‚²éª¨ã€æ°”è±¡ã€é£é›·çš„æ»šçƒ«é‡å¿ƒã€‚
å‹å¾—è¶Šä½ï¼Œå¼¹èµ·æ—¶ä¾¿è¶Šæ˜¯ä¸‡é’§é›·éœ†ã€‚</p>
<h4 data-id="heading-5">ã€ç‚¼å­—ï¼šå››å­—ç ´å±€ã€‘</h4>
<ul>
<li><strong>èµ·äºâ€œè¿â€</strong>ï¼šå‡¡äººé¿é›ªï¼Œä¾ å®¢ç‹¬è¿ã€‚ä¸€å­—ç«‹èµ·é€†æµè€Œä¸Šçš„å§¿æ€ã€‚</li>
<li><strong>æ‰¿äºâ€œä»»â€</strong>ï¼šè§†éœœé›ªä¸ºé›•åˆ»ä¹‹åˆ€ã€‚è¿™æ˜¯â€œä»–å¼ºä»»ä»–å¼ºâ€çš„é¡¶çº§å‚²æ°”ã€‚</li>
<li><strong>è½¬äºâ€œè—â€</strong>ï¼šå…¨è¯—ä¹‹çœ¼ã€‚å˜â€œè¢«åŠ¨è½é­„â€ä¸ºâ€œä¸»åŠ¨è›°ä¼â€ã€‚èº«åœ¨æ³¥æ¶‚ï¼Œå¿ƒåœ¨ä¹éœ„ã€‚</li>
<li><strong>åˆäºâ€œå·â€</strong>ï¼šé£é›·ä¸€åŠ¨ï¼Œä¹¾å¤å€’è½¬ã€‚æ‰€æœ‰çš„éšå¿ï¼Œåªä¸ºè¿™ä¸€åˆ»çš„çˆ†å‘ã€‚</li>
</ul>
<h4 data-id="heading-6">ã€å“²æ€ï¼šå¼ºè€…çš„å®£è¨€ã€‘</h4>
<p>è¿™é¦–è¯—æˆåŠŸåœ°åˆ»ç”»äº†ä¸€ä½ <strong>â€œå—å¾—äº†å§”å±ˆï¼Œæ’‘å¾—èµ·é‡å¿ƒâ€</strong> çš„äººç‰©å½¢è±¡</p>
<ul>
<li>å›å­å½“æœ‰é¾™è›‡ä¹‹å˜ï¼Œé¾™è›‡ä¹‹å˜ï¼Œåœ¨äºèƒ½å¤§èƒ½å°ï¼Œèƒ½å‡èƒ½éšã€‚èº«åœ¨çƒ‚æ³¥ï¼Œå¿ƒæ€€æ°”è±¡ï¼Œè¿™æ˜¯æ­é›„å¿ƒæ€§ã€‚</li>
<li>å®ƒä¸å†æ˜¯å•çº¯çš„æŠ±æ€¨æ€€æ‰ä¸é‡ï¼Œè€Œæ˜¯ä¸€ç§è—å™¨äºèº«ï¼Œå¾…æ—¶è€ŒåŠ¨çš„ç”Ÿæ´»æ€åº¦ã€‚</li>
</ul>
<h3 data-id="heading-7">2. ç”»éª¨ï¼šè§†è§‰å¼ åŠ›</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ec995deb611439a8d85842bc2b172ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=9cjhANQMdeTQNfNL7%2BVMupURFsc%3D" alt="nthme-1765190372526.png" loading="lazy"/></p>
<ul>
<li><strong>å·¥å…·</strong>ï¼šNano Banana æ™®é€šæ¨¡å‹</li>
<li><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼š
å¾ˆå¤šæ¨¡å‹å–œæ¬¢æŠŠç”»é¢å¡«æ»¡ï¼Œä½†å›½é£æ°´å¢¨è®²ç©¶çš„æ˜¯ <strong>â€œç•™ç™½â€</strong>ã€‚
æˆ‘åˆ»æ„å¼•å¯¼æ¨¡å‹ç”Ÿæˆâ€œ<strong>ç–å¯èµ°é©¬ï¼Œå¯†ä¸é€é£</strong>â€çš„æ„å›¾ã€‚
<ul>
<li><strong>å…³é”®Prompt</strong>ï¼š<code>negative space</code> (ç•™ç™½), <code>minimalism</code>, <code>dragon in clouds</code>, <code>swordsman back view</code>.</li>
<li><strong>ç›®çš„</strong>ï¼šè¿™é‡Œçš„ç•™ç™½ä¸æ˜¯ç©ºï¼Œè€Œæ˜¯ä¸ºäº†ç»™åç»­çš„â€œé¢˜å­—â€ç•™å‡ºç”Ÿæ€ä½ï¼Œè¥é€ â€œå‹æŠ‘æ„Ÿâ€çš„å¼ åŠ›ã€‚</li>
</ul>
</li>
</ul>
<p>å®Œæ•´æç¤ºè¯</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> æƒ³è¦ä¸€ç§å¤é£ã€è‹å‡‰ã€ç•™ç™½ã€æ„å¢ƒæ·±è¿œçš„ç”»é¢ã€‚</p>
<p><strong>ç”»é¢æè¿°ï¼š</strong> å·¨å¤§çš„ç•™ç™½é›ªæ™¯ï¼Œä¸€ä¸ªæ¸ºå°çš„å¢¨è‰²èƒŒå½±ï¼Œè„šä¸‹æ˜¯æ³¥æ³ï¼Œå¤©è¾¹éšçº¦æœ‰é¾™å½¢çš„äº‘æ°”å’Œé›·å…‰ã€‚</p>
<p>Prompt (è‹±æ–‡æç¤ºè¯):</p>
<pre><code class="hljs language-text" lang="text">masterpiece, best quality, traditional chinese ink wash painting, shuimo, a vast snowy landscape, heavy blizzard, one solitary swordsman walking away, back view, wearing tattered long robes, holding a sword, frost on clothes, standing in mud and snow, subtle dragon-shaped clouds in the dark stormy sky, lightning breaking through the clouds, strong contrast between black ink and white paper, epic atmosphere, lonely, majestic, calligraphy brush strokes.
</code></pre>
<h3 data-id="heading-8">3. ç‚¹ç›ï¼šå­—æ˜¯ç”»çš„èƒ†</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef8b64ec0ec840a5a2a2444343fd94f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=QvCyj4G3qXR5pfw%2BiOT0w%2BikhEs%3D" alt="æˆªå±2025-12-08 20.16.51.png" loading="lazy"/></p>
<ul>
<li><strong>å·¥å…·</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.hellofont.cn%2F" target="_blank" title="https://www.hellofont.cn/" ref="nofollow noopener noreferrer">å­—ç”± (HelloFont)</a></li>
<li><strong>ç—›ç‚¹</strong>ï¼šç›®å‰çš„AIç”Ÿå›¾æ¨¡å‹ï¼ˆå¦‚SD, MJï¼‰ç”Ÿæˆçš„æ±‰å­—åŸºæœ¬æ˜¯â€œé¬¼ç”»ç¬¦â€ï¼Œä¸å¯ç”¨ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
ä¸è¦è¿·ä¿¡å…¨è‡ªåŠ¨ã€‚æˆ‘é€‰æ‹©åæœŸåˆæˆã€‚
ä½¿ç”¨ <strong>å­—ç”±</strong> æŒ‘é€‰äº†å…è´¹å•†ç”¨çš„ä¹¦æ³•å­—ä½“ï¼ˆæ¨èè¡Œæ¥·æˆ–ç˜¦é‡‘ä½“é£æ ¼ï¼‰ã€‚
<ul>
<li><strong>æ’ç‰ˆæŠ€å·§</strong>ï¼šé‡‡ç”¨å¤ç±ç«–æ’ï¼Œå³èµ·ã€‚æ–‡å­—é¢œè‰²å¸å–ç”»é¢æ·±å¢¨è‰²ï¼Œè®©å­—â€œé•¿â€åœ¨ç”»ä¸Šã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">4. æ³¨é­‚ï¼šè®©ç”»é¢æµåŠ¨</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b63a93515d864adab5df833acb9ffd9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=%2B02JEo2KaTjVqI3Wc%2B8UABTwgvM%3D" alt="IMG_1776.PNG" loading="lazy"/></p>
<ul>
<li><strong>å·¥å…·</strong>ï¼šè±†åŒ… (Doubao)</li>
<li><strong>æ“ä½œ</strong>ï¼šå›¾ç”Ÿè§†é¢‘ (Image-to-Video)ã€‚</li>
<li><strong>æ•ˆæœ</strong>ï¼šæç¤ºè¯æ§åˆ¶â€œé£é›ªå‰§çƒˆé£˜åŠ¨â€ã€â€œé›·é¾™åœ¨äº‘å±‚éšç°â€ï¼Œä½†äººç‰©ä¿æŒç›¸å¯¹é™æ­¢ã€‚åŠ¨é™ç»“åˆï¼Œå‹è¿«æ„Ÿæ‹‰æ»¡ã€‚</li>
<li><strong>âŒ é‡åˆ°çš„ç—›ç‚¹</strong>ï¼š
è™½ç„¶è±†åŒ…ç”Ÿæˆçš„åŠ¨æ€æ•ˆæœä¸é”™ï¼Œä½†<strong>æ°´å°</strong>é—®é¢˜éå¸¸å½±å“æˆç‰‡çš„æ²‰æµ¸æ„Ÿã€‚å¯¹äºè¿½æ±‚æè‡´å®¡ç¾çš„åˆ›ä½œè€…æ¥è¯´ï¼Œè¿™æ˜¯æ— æ³•å¿å—çš„ç‘•ç–µã€‚è¿˜æœ‰ä¸€äº›å¼±æ™ºç”»é¢çªç„¶è·³å‡ºæ¥ï¼Œè‡ªå·±è¦è£å‡ã€‚</li>
</ul>
<h3 data-id="heading-10">5. éŸ³æºï¼šæ°›å›´è¥é€ </h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6555d5dfefa744729adba6ad69df2f8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=YPBNY%2F7iE8bFK4OGaz1Y57qCgv8%3D" alt="æˆªå±2025-12-08 20.24.23.png" loading="lazy"/>
å•çº¯çš„ç”»é¢æ˜¯ä¸å¤Ÿçš„ï¼Œå£°éŸ³æ˜¯æƒ…ç»ªçš„æ”¾å¤§å™¨ã€‚</p>
<ul>
<li><strong>éŸ³æºè·å–</strong>ï¼šåœ¨Bç«™æ‰¾åˆ°ä¸€æ®µæå…·å¤é£å‹è¿«æ„Ÿçš„è§†é¢‘ç´ æã€‚
<ul>
<li>ğŸ“¥ <strong>è§†é¢‘ä¸‹è½½</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsnapany.com%2Fzh%2Fbilibili" target="_blank" title="https://snapany.com/zh/bilibili" ref="nofollow noopener noreferrer">SnapAny</a> (æ”¯æŒBç«™è§†é¢‘è§£æä¸‹è½½)</li>
</ul>
</li>
<li><strong>éŸ³é¢‘æå–</strong>ï¼š
<ul>
<li>ğŸµ <strong>éŸ³è½¨åˆ†ç¦»</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.fineshare.com%2Fcn%2Faudio-extractor%2F" target="_blank" title="https://www.fineshare.com/cn/audio-extractor/" ref="nofollow noopener noreferrer">FineShare Audio Extractor</a></li>
</ul>
</li>
<li><strong>åæœŸå‰ªè¾‘</strong>ï¼š
<ul>
<li>ä½¿ç”¨å‰ªæ˜ å°†ç”»é¢ä¸éŸ³é¢‘å¯¹é½ï¼Œåˆ¶ä½œæˆ<strong>å¾ªç¯æ’­æ”¾çš„çŸ­è§†é¢‘ï¼ˆLoop Videoï¼‰</strong>ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-11">02ï½œä»ç—›ç‚¹åˆ°äº§å“è¿­ä»£ï¼šThe Nth Me çš„ä¸‹ä¸€æ­¥</h2>
<p>èµ°å®Œè¿™ä¸€æ•´å¥—æµç¨‹ï¼Œæˆ‘æœ€å¤§çš„æ„Ÿå—æ˜¯ï¼š<strong>å‰²è£‚</strong>ã€‚</p>
<p>æˆ‘éœ€è¦åˆ‡æ¢5ä¸ªå·¥å…·ï¼ˆNano Banana -&gt; Keynote/å­—ç”± -&gt; è±†åŒ… -&gt; SnapAny -&gt; å‰ªæ˜ ï¼‰ï¼Œè¿˜è¦å¿å—æ°´å°ï¼Œæ‰èƒ½å‹‰å¼ºé€šè¿‡â€œæ‹¼å‡‘â€å®Œæˆä¸€ä¸ªä½œå“ã€‚</p>
<p>è¿™è®©æˆ‘é‡æ–°å®¡è§†æˆ‘æ­£åœ¨åšçš„äº§å“ â€”â€” <strong>The Nth Me</strong>ã€‚</p>
<h3 data-id="heading-12">ğŸ’¡ ä¸ºä»€ä¹ˆè¦åš The Nth Meï¼Ÿ</h3>
<p>â€œThe Nth Meâ€æ„ä¸ºâ€œç¬¬Nä¸ªæˆ‘â€ã€‚æˆ‘ä»¬æ¯ä¸ªäººåœ¨å¹³è¡Œæ—¶ç©ºé‡Œï¼Œéƒ½å¯èƒ½æ˜¯é‚£ä¸ªâ€œä¸‡é‡Œç‹¬åŸâ€çš„å‰‘å®¢ã€‚
æˆ‘å¸Œæœ›å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç½‘ç«™ï¼Œè€Œæ˜¯ä¸€ä¸ª <strong>â€œå®¡ç¾å®¹å™¨â€</strong>ã€‚</p>
<h3 data-id="heading-13">ğŸš€ è¿­ä»£ Roadmap</h3>
<p>åŸºäºè¿™æ¬¡åˆ›ä½œçš„ç—›ç‚¹ï¼Œæˆ‘å†³å®šåœ¨ <strong>The Nth Me</strong> çš„åç»­ç‰ˆæœ¬ä¸­é‡ç‚¹è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li><strong>å…¨æµç¨‹é—­ç¯</strong>ï¼š
è®¡åˆ’æ¥å…¥å›¾ç”Ÿè§†é¢‘æ¨¡å‹ï¼Œç”¨æˆ·åœ¨ç«™å†…ç”Ÿæˆå›¾ç‰‡åï¼Œå¯ä»¥ç›´æ¥ä¸€é”®â€œæ³¨é­‚â€ç”Ÿæˆè§†é¢‘ï¼Œæ— éœ€è·³è½¬ã€‚ä½†æ˜¯éŸ³æºè·å–è¿˜æ˜¯ä¸ªé—®é¢˜ï¼Œæ€»æ˜¯è¦å‰ç½®å¤„ç†ã€‚å¦‚æœç½‘ç«™å†…åšå¯èƒ½ä¼šæŠŠåŠŸèƒ½å†™æˆã€Œå‰ªæ˜ ã€ï¼Œæˆ‘åˆæƒ³ä¸å˜æˆå‰ªè¾‘è½¯ä»¶ã€‚
<ul>
<li>æœ‰äº›å›°æ‰°ï¼Œå¦‚æœæœ‰å¥½å»ºè®®çš„ jym å¯ä»¥å‘åœ¨è¯„è®ºåŒºï¼Œ<strong>è‹¥é‡‡çº³ï¼Œé€ä½ ä½“éªŒç§¯åˆ†å…‘æ¢ç </strong></li>
</ul>
</li>
<li><strong>å»æ°´å°åŒ–</strong>ï¼š
ä½œä¸ºç‹¬ç«‹å¼€å‘è€…ï¼Œæˆ‘æ·±çŸ¥ç‰ˆæƒå’Œçº¯å‡€åº¦çš„é‡è¦æ€§ã€‚æœªæ¥çš„è§†é¢‘ç”ŸæˆåŠŸèƒ½å°†ä¸»æ‰“<strong>é«˜æ¸…ã€æ— æ°´å°</strong>ï¼ŒæŠŠç”»é¢è¿˜ç»™åˆ›ä½œè€…ã€‚</li>
<li><strong>æ–‡åŒ–èµ„äº§æ²‰æ·€</strong>ï¼š
ä¸ä»…ä»…æ˜¯ç”Ÿæˆï¼Œè¿˜è¦èƒ½åˆ†äº«ã€‚å…¨æµåª’ä½“/ç¤¾äº¤è½¯ä»¶å¦‚ä½•è®¾è®¡åˆ†äº«é€”å¾„ï¼Œéƒ½è¦å¤„ç†ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-14">03ï½œç»“è¯­</h2>
<h3 data-id="heading-15">1.æ˜é‡‘çš„è§†é¢‘åˆ°åº•æ€ä¹ˆä¸Šä¼ ï¼Ÿ</h3>
<p>æˆ‘æœ¬æ¥æƒ³æŠŠè§†é¢‘æ”¾ä¸Šæ¥ç»™å¤§å®¶çœ‹çœ‹ï¼Œä½†æ˜¯ç¼–è¾‘å™¨æœ‰ç‚¹é—®é¢˜ã€‚ä¸æ¸…æ¥šæ€ä¹ˆä¸Šä¼ ï¼Œç‰¹åˆ«æ˜¯æ–‡æ¡ˆè¿˜è¯´åªæ”¯æŒè¥¿ç“œè§†é¢‘ï¼Œç°åœ¨è¿›è¥¿ç“œè§†é¢‘å®˜ç½‘ç›´æ¥è·³åˆ°æŠ–éŸ³å»äº†ï¼Œè¿™ä¸ªä¸Šä¼ é€»è¾‘éƒ½åºŸäº†ã€‚@æ˜é‡‘æŠ€æœ¯ï¼Œéº»çƒ¦æœ‰ç©ºè·Ÿè¿›ä¸€ä¸‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1a1b01cf3764b6895e4c24ad8f27db6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765803242&amp;x-signature=s2h2mR3Y1C%2FHtaa5Tyid1Mqb%2FEE%3D" alt="æˆªå±2025-12-08 20.36.48.png" loading="lazy"/></p>
<p>æ”¾ä¸ªå°çº¢ä¹¦çš„ï¼š</p>
<p>æ˜Â·å¼ ç©† x AIï¼šè·¨è¶Šæ—¶ç©ºçš„â€œè›°é¾™â€å¯¹è¯ â€œä¸‡é‡Œç‹¬åŸè¿... <a href="https://link.juejin.cn?target=http%3A%2F%2Fxhslink.com%2Fo%2F4AqiRBWgFbf" target="_blank" title="http://xhslink.com/o/4AqiRBWgFbf" ref="nofollow noopener noreferrer">xhslink.com/o/4AqiRBWgFâ€¦</a>
å¤åˆ¶åæ‰“å¼€ã€å°çº¢ä¹¦ã€‘æŸ¥çœ‹ç¬”è®°ï¼</p>
<h3 data-id="heading-16">2.å…³äºçµæ„Ÿ</h3>
<p>å¾ˆå¤šäººé—®æˆ‘ï¼Œä¸ºä»€ä¹ˆè¦åšè¿™ç§â€œæ— ç”¨â€çš„ä¸œè¥¿ï¼Ÿ</p>
<p>å…¶å®ï¼Œæˆ‘ä»¬æ¯ä¸ªäººèº«ä½“é‡Œéƒ½ä½ç€æ— æ•°ä¸ªè‡ªå·±ã€‚ ä¹Ÿè®¸æ˜¯é‚£ä¸ªæƒ³ä»—å‰‘å¤©æ¶¯çš„å°‘å¹´ï¼Œä¹Ÿè®¸æ˜¯é‚£ä¸ªæƒ³åœ¨é£é›ªä¸­å¤§å–Šçš„ç–¯å­ã€‚åœ¨è¿™ä¸ªåä¸º The Nth Me çš„æ¦‚å¿µé‡Œï¼Œæˆ‘æ‰¾åˆ°äº†ç¬¬Nä¸ªè‡ªå·±ã€‚ å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªåå­—ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªå­˜æ”¾æˆ‘ä»¬â€œæœªç«Ÿä¹‹æ¢¦â€çš„èµ›åšç©ºé—´ã€‚</p>
<ul>
<li>åœ¨è¿™é‡Œï¼Œæ‰€æœ‰çš„æ„å¿—å’Œæƒ³è±¡ï¼Œéƒ½èƒ½è¢«çœ‹è§ã€‚</li>
<li>å¦‚æœä½ ä¹Ÿæƒ³æ‰¾åˆ°ä½ çš„ç¬¬ N ç§å¯èƒ½ï¼Œä¸å¦¨å»æœæœçœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nthme.org%2F" target="_blank" title="https://www.nthme.org/" ref="nofollow noopener noreferrer"><strong>The Nth Me</strong></a>ã€‚ æˆ–è®¸ï¼Œé‚£é‡Œä¹Ÿæœ‰ä½ çš„å½±å­ã€‚</li>
<li>å¦‚æœä½ ä¹Ÿæƒ³æ‰“ç ´æ¬¡å…ƒå£ï¼Œå»æ¢ç´¢AIç§‘æŠ€ä¸å¤ä»£è¯—è¯æ–‡åŒ–çš„äº¤èï¼Œä¸å¦¨æŒ‰ç…§æˆ‘è¿™ä¸ªè·¯å¾„å›¾è‡ªå·±å°è¯•ä¸€ä¸‹</li>
</ul>
<blockquote>
<p>æ„¿ä½ ä¸€èº«å‚²éª¨ï¼Œç»ˆé‡é£é›·ã€‚</p>
</blockquote>
<p>å¦‚æœä½ ä¹Ÿå¯¹è¿™ç§ <strong>â€œæŠ€æœ¯+äººæ–‡â€</strong> çš„æ¢ç´¢æ„Ÿå…´è¶£ï¼Œæˆ–è€…æƒ³ä½“éªŒæœªæ¥çš„æ— æ°´å°å·¥ä½œæµï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„é¡¹ç›®ï¼š</p>
<p>ğŸ‘‰ <strong>The Nth Me</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nthme.org%2F" target="_blank" title="https://www.nthme.org/" ref="nofollow noopener noreferrer">www.nthme.org/</a></p>
<p>è®©æˆ‘ä»¬ä¸€èµ·ï¼Œåœ¨èµ›åšä¸–ç•Œé‡Œï¼Œå¤æ´»å¿ƒä¸­çš„é‚£æ¡â€œè›°é¾™â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆç¬¬ä¸€æ€§åŸç†æ€ç»´å¯ä»¥æ”¹å˜ä½ è§£å†³é—®é¢˜çš„æ–¹å¼]]></title>    <link>https://juejin.cn/post/7581097111896457270</link>    <guid>https://juejin.cn/post/7581097111896457270</guid>    <pubDate>2025-12-08T11:44:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097111896457270" data-draft-id="7581117416811479083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆç¬¬ä¸€æ€§åŸç†æ€ç»´å¯ä»¥æ”¹å˜ä½ è§£å†³é—®é¢˜çš„æ–¹å¼"/> <meta itemprop="keywords" content="æ¶æ„,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2025-12-08T11:44:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MobotStone"/> <meta itemprop="url" content="https://juejin.cn/user/3839909554568840"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆç¬¬ä¸€æ€§åŸç†æ€ç»´å¯ä»¥æ”¹å˜ä½ è§£å†³é—®é¢˜çš„æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3839909554568840/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MobotStone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T11:44:31.000Z" title="Mon Dec 08 2025 11:44:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»ç„¶è®°å¾—å‰ä¸ä¹…çš„ä¸€æ®µå°ç»å†ã€‚é‚£æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ä¸ºä¸€ä¸ªæ–°çš„ä¸šåŠ¡éœ€æ±‚æ‰¾æŠ€æœ¯æ–¹æ¡ˆï¼Œå¤§å®¶å¼€äº†å¥½å‡ æ¬¡ä¼šï¼Œå´å§‹ç»ˆæ‹¿ä¸å®šä¸»æ„ã€‚æ¯æ¬¡è®¨è®ºéƒ½åƒæ˜¯åœ¨ä¿®ä¸€å°ç‰¹åˆ«å¤æ‚çš„å¤§æœºå™¨â€”â€”æ–¹æ¡ˆä¸€ä¸ªæ¯”ä¸€ä¸ªâ€œé«˜çº§â€ï¼Œä½†ä¸€è°ˆåˆ°å…·ä½“å®ç°ï¼Œå°±é™·è¿›ç»†èŠ‚é‡Œå‡ºä¸æ¥ã€‚</p>
<p>é‚£å¤©ä¸‹åˆï¼Œæˆ‘ç´¢æ€§æ”¾ä¸‹æ‰‹å¤´çš„æ´»å„¿ï¼Œé—®äº†è‡ªå·±ä¸€ä¸ªç‰¹åˆ«ç®€å•çš„é—®é¢˜ï¼šä¸šåŠ¡åˆ°åº•æœ€åœ¨ä¹çš„æ˜¯ä»€ä¹ˆï¼Ÿå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘é‡æ–°æŠŠæ•´ä¸ªä¸šåŠ¡æµç¨‹æ¢³ç†äº†ä¸€éï¼Œæ‰çªç„¶å‘ç°ï¼šæˆ‘ä»¬ä¹‹å‰ä¸€ç›´å¿½ç•¥äº†ä¸€ä¸ªå…³é”®ç‚¹â€”â€”çœŸæ­£è¦è§£å†³çš„é—®é¢˜ï¼Œå…¶å®éå¸¸ç®€å•ï¼Œæ˜¯æˆ‘ä»¬è‡ªå·±æŠŠå®ƒæå¤æ‚äº†ã€‚</p>
<p>æƒ³é€šè¿™ä¸€ç‚¹ä¹‹åï¼Œæˆ‘ä»¬é‡æ–°å®¡è§†äº†éœ€æ±‚ï¼Œä¸å†è¿½æ±‚â€œåˆå¤§åˆå…¨â€çš„æ–¹æ¡ˆï¼Œè€Œæ˜¯é€‰æ‹©äº†ä¸€ä¸ªæç®€ã€ç›´æ¥ã€å¥½è½åœ°çš„åšæ³•ã€‚ç»“æœä¸ä»…çœä¸‹äº†ä¸å°‘å¼€å‘èµ„æºï¼Œä¸šåŠ¡çš„ä½“éªŒä¹Ÿæ›´å¥½äº†ã€‚</p>
<p>è¿™æ¬¡ç»å†è®©æˆ‘æ˜ç™½ï¼šè§£å†³é—®é¢˜çš„å…³é”®ï¼Œä¸åœ¨äºæ–¹æ¡ˆæœ‰å¤šå…ˆè¿›ï¼Œç®—æ³•å¤šç‰›ï¼Œè€Œåœ¨äºæœ‰æ²¡æœ‰çœŸæ­£æ»¡è¶³ä¸šåŠ¡å½“å‰çš„éœ€æ±‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/088e214bf5a74ba1aa156bc947b3c4e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9ib3RTdG9uZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765799070&amp;x-signature=2SuC7jhfI%2BMsQT4esmV%2B9bbtxrM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Ÿ</h2>
<p>ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œå°±æ˜¯æŠŠé—®é¢˜æ‹†è§£åˆ°æœ€åŸºæœ¬çš„çœŸç›¸ï¼Œç„¶åä»è¿™äº›çœŸç›¸å‡ºå‘ä¸€æ­¥æ­¥æ¨ç†ï¼Œè€Œä¸æ˜¯è·Ÿç€â€œå¤§å®¶éƒ½çŸ¥é“â€çš„è€è¯´æ³•èµ°ã€‚å®ƒä¸æ˜¯è¦ä½ ä»å¤´å‘æ˜è½®å­ï¼Œè€Œæ˜¯ææ¸…æ¥šè½®å­ä¸ºä»€ä¹ˆæ˜¯åœ†çš„ã€å®ƒæ€ä¹ˆæ»šçš„ï¼Œä»¥åŠèƒ½ä¸èƒ½ç”¨å…¶ä»–å½¢çŠ¶æ»šå¾—æ›´å¥½ã€‚</p>
<p>é€šè¿‡æ‰¾å‡ºé—®é¢˜çš„æ ¸å¿ƒâ€œç –å—â€ï¼Œä½ å°±é¿å¼€äº†é‚£ç§å°ä¿®å°è¡¥çš„æ­»èƒ¡åŒã€‚ä½ ä¼šé€ä¸€å®¡è§†æ¯ä¸€æ­¥ï¼šå“ªäº›æ˜¯é“æ¿é’‰é’‰çš„ã€å“ªäº›èƒ½å˜ã€å“ªäº›å˜ä¸äº†ã€‚è¿™ç§æ–¹æ³•ï¼Œèƒ½æŠŠè¶…çº§å¤æ‚çš„éš¾é¢˜ï¼Œå˜æˆç®€å•æ˜äº†çš„â€œå°å„¿ç§‘â€é—®é¢˜ï¼Œä¸€ä¸‹å­å°±æå®šã€‚</p>
<h2 data-id="heading-1">è¿™ç§æ€ç»´æ–¹å¼çš„å¼ºå¤§ä¹‹å¤„åœ¨å“ª</h2>
<p>ç¬¬ä¸€æ€§åŸç†æ€ç»´ä¹‹æ‰€ä»¥èƒ½å¸¦æ¥é¢ è¦†æ€§æ”¹å˜ï¼Œæ˜¯å› ä¸ºå®ƒï¼š</p>
<ul>
<li><strong>æ¿€å‘çœŸæ­£åˆ›æ–°</strong>ï¼šå½“ä½ è·³å‡ºç°æœ‰æ¡†æ¶ï¼Œå°±èƒ½å‘ç°é‚£äº›è¢«å¸¸äººè§†ä¸ºâ€œç†æ‰€å½“ç„¶â€è€Œå¿½ç•¥çš„å…¨æ–°å¯èƒ½ã€‚</li>
<li><strong>åŒ–ç¹ä¸ºç®€</strong>ï¼šæŠŠçœ‹ä¼¼å¤æ‚æ— æ¯”çš„é—®é¢˜ï¼Œæ‹†è§£æˆæ¸…æ™°ã€å¯é€ä¸ªæ”»å…‹çš„å°æ¨¡å—ã€‚</li>
<li><strong>çœæ—¶çœåŠ›</strong>ï¼šé¿å…åœ¨è¡¨é¢ä¿®è¡¥ä¸Šæµªè´¹æ—¶é—´ï¼ŒåªæŠŠèµ„æºæŠ•å…¥åˆ°çœŸæ­£å…³é”®ã€èƒ½æ¨åŠ¨è¿›å±•çš„åœ°æ–¹ã€‚</li>
<li><strong>å»ºç«‹æ·±åº¦è®¤çŸ¥</strong>ï¼šé€¼ä½ å»å¼„æ‡‚äº‹ç‰©èƒŒåçš„ç§‘å­¦åŸç†ã€å¸‚åœºè§„å¾‹æˆ–äººæ€§å› ç´ ï¼Œè€Œä¸åªæ˜¯åœç•™åœ¨è¡¨é¢ã€‚</li>
<li><strong>è®©å†³ç­–æ›´æœ‰åº•æ°”</strong>ï¼šæ¯ä¸ªå‡è®¾éƒ½ç»è¿‡éªŒè¯ï¼Œä½ çš„é€‰æ‹©å°±ä¸å†åªå‡­ç›´è§‰ï¼Œè€Œæ˜¯å»ºç«‹åœ¨æ‰å®çš„åŸºç¡€ä¸Šã€‚</li>
</ul>
<h2 data-id="heading-2"><strong>ä»æ ¹æœ¬åŸç†å‡ºå‘çš„åˆ›æ–°æ¡ˆä¾‹</strong></h2>
<h4 data-id="heading-3"><strong>1. SpaceX çš„ç«ç®­é©å‘½</strong></h4>
<p>ä¼Šéš†Â·é©¬æ–¯å…‹é—®äº†ä¸€ä¸ªç®€å•å´å…³é”®çš„é—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆç«ç®­åªèƒ½ç”¨ä¸€æ¬¡ï¼Ÿ</strong> ä»–ä»é›¶å¼€å§‹é‡æ–°æ€è€ƒç«ç®­çš„è®¾è®¡ï¼Œæ‹†è§£äº†å‘å°„æˆæœ¬å’Œææ–™ç»“æ„ï¼Œæœ€ç»ˆè®© SpaceX çš„ç«ç®­å®ç°äº†<strong>å¯å›æ”¶åˆ©ç”¨</strong>ã€‚è¿™ä¸€æ”¹å˜è®©æ¯æ¬¡å‘å°„çš„æˆæœ¬<strong>é™ä½äº† 90% ä»¥ä¸Š</strong>ï¼Œå½»åº•é¢ è¦†äº†èˆªå¤©ä¸šã€‚</p>
<h4 data-id="heading-4"><strong>2. ç‰¹æ–¯æ‹‰çš„ç”µåŠ¨è½¦çªç ´</strong></h4>
<p>ä¼ ç»Ÿè½¦ä¼åªæ˜¯åœ¨æ²¹è½¦åº•ç›˜ä¸ŠåŠ è£…ç”µæ± ï¼Œè€Œç‰¹æ–¯æ‹‰åˆ™<strong>ä»ç”µæ± å‡ºå‘</strong>ï¼Œé‡æ–°è®¾è®¡äº†è½¦èº«ç»“æ„ã€åŠ¨åŠ›ç³»ç»Ÿå’Œçƒ­ç®¡ç†ã€‚è¿™ç§â€œä»æ ¹æœ¬å‡ºå‘â€çš„æ€è·¯ï¼Œè®©ç”µåŠ¨è½¦<strong>ç»­èˆªæ›´é•¿ã€å……ç”µæ›´å¿«</strong>ï¼Œä»å°ä¼—äº§å“å˜æˆäº†ä¸»æµé€‰æ‹©ã€‚</p>
<h4 data-id="heading-5"><strong>3. å¨å¸ˆçš„é…±æ–™é©å‘½</strong></h4>
<p>ä¸€ä½å¤§å¨æƒ³è¦çªç ´ä¼ ç»Ÿç•ªèŒ„é…±çš„å±€é™ã€‚å¥¹æ²¡æœ‰éµå¾ªå¤æ³•ï¼Œè€Œæ˜¯ä»ç§‘å­¦è§’åº¦åˆ†æ"é²œå‘³"çš„æ¥æºã€‚é€šè¿‡å°†çƒ¤è˜‘è‡ä¸é•¿æ—¶é—´ç‚–ç…®çš„ç•ªèŒ„æ··åˆï¼Œç«Ÿè°ƒé…å‡ºåª²ç¾è‚‰æ±é…±çš„æµ“éƒå£æ„Ÿâ€”â€”å®Œå…¨é æ–°é²œè”¬èœï¼è¿™ä¸ªæ¡ˆä¾‹å®Œç¾å±•ç°äº†"ç”¨æœ€åŸºç¡€åŸç†é‡æ„äº‹ç‰©"çš„æ€ç»´åŠ›é‡ã€‚</p>
<h2 data-id="heading-6">å¦‚ä½•å®è·µç¬¬ä¸€æ€§åŸç†æ€ç»´</h2>
<p><strong>ç¬¬ä¸€æ­¥ï¼šè¯†åˆ«é—®é¢˜ï¼Œåˆ—å‡ºæ‰€æœ‰å‡è®¾</strong></p>
<p>é¦–å…ˆï¼Œæ˜ç¡®ä½ è¦è§£å†³çš„å…·ä½“é—®é¢˜ï¼Œç„¶åæŠŠä½ å¯¹è¿™ä¸ªé—®é¢˜çš„æ‰€æœ‰é¢„è®¾å’Œå‡è®¾éƒ½å†™ä¸‹æ¥ã€‚æ¥ç€ï¼Œé€æ¡é—®è‡ªå·±ï¼š"ä¸ºä»€ä¹ˆæˆ‘ä¼šè¿™æ ·æƒ³ï¼Ÿè¿™ä¸ªå‡è®¾çœŸçš„æ˜¯å¿…é¡»çš„å—ï¼Ÿ"è¿™æ ·åšçš„ç›®çš„æ˜¯æ‰“ç ´æˆ‘ä»¬ä¹ æƒ¯æ€§çš„æ€ç»´å®šå¼ï¼Œå»æ‰é‚£äº›ç†æ‰€å½“ç„¶ä½†å…¶å®æœªå¿…æ­£ç¡®çš„æƒ³æ³•ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šæŠŠé—®é¢˜æ‹†è§£æˆæœ€åŸºç¡€çš„ç»„æˆéƒ¨åˆ†</strong></p>
<p>æƒ³è±¡ä½ åœ¨æ‹†ä¸€ä¸ªå¤æ‚çš„æœºå™¨â€”â€”ä¸è¦æ€¥ç€çœ‹æ•´ä½“æ€æ ·è¿ä½œï¼Œè€Œæ˜¯å…ˆé—®è‡ªå·±ï¼š"è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿå“ªäº›æ˜¯çœŸæ­£èµ·ä½œç”¨çš„å…³é”®å› ç´ ï¼Ÿ"æŠŠè¿™äº›åŸºæœ¬å…ƒç´ ä¸€ä¸€åˆ—å‡ºæ¥ï¼Œè¿™æ ·ä½ å°±èƒ½çœ‹æ¸…é—®é¢˜çš„æœ¬è´¨ï¼Œè€Œä¸æ˜¯è¢«è¡¨é¢çš„å¤æ‚æ€§è¿·æƒ‘ã€‚</p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šç‹¬ç«‹éªŒè¯æ¯ä¸ªåŸºç¡€è¦ç´ </strong></p>
<p>å¯¹äºä½ åˆ—å‡ºçš„æ¯ä¸ªæ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œéƒ½è¦ä¸»åŠ¨å»éªŒè¯å®ƒã€‚ä½ å¯ä»¥æŸ¥æ‰¾èµ„æ–™ã€åšä¸€äº›å°çš„æµ‹è¯•ã€æˆ–è€…è¯·æ•™ç›¸å…³é¢†åŸŸçš„ä¸“å®¶ã€‚ç›®çš„æ˜¯ç”¨å®é™…æ•°æ®æˆ–äº‹å®æ¥è¯æ˜è¿™äº›åŸºç¡€è¦ç´ æ˜¯å¦çœŸçš„å­˜åœ¨ï¼Œé‚£äº›ä½ è®¤ä¸ºç†æ‰€å½“ç„¶çš„ä¸œè¥¿æ˜¯å¦çœŸçš„å¯é ã€‚</p>
<p><strong>ç¬¬å››æ­¥ï¼šä»é›¶å¼€å§‹é‡æ–°ç»„å»ºè§£å†³æ–¹æ¡ˆ</strong></p>
<p>ç°åœ¨ä½ å·²ç»çŸ¥é“äº†çœŸå®çš„ã€ç»è¿‡éªŒè¯çš„åŸºç¡€äº‹å®ï¼Œé—®è‡ªå·±ï¼š"å¦‚æœåªåŸºäºè¿™äº›çœŸå®æƒ…å†µï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°ä»€ä¹ˆæ ·çš„è§£å†³åŠæ³•ï¼Ÿ"è¿™æ—¶å¾€å¾€ä¼šå‡ºç°ä¸€äº›å…¨æ–°çš„ã€ä¹‹å‰ä»æœªè€ƒè™‘è¿‡çš„æƒ³æ³•å’Œå¯èƒ½æ€§ã€‚</p>
<p><strong>ç¬¬äº”æ­¥ï¼šå¿«é€Ÿæ”¹è¿›å¹¶è®°å½•ç»éªŒ</strong></p>
<p>ä¸è¦è®¤ä¸ºç¬¬ä¸€æ¬¡çš„ç»“è®ºå°±æ˜¯å®Œç¾çš„ã€‚è¦æŒç»­æ”¹è¿›ï¼Œå½“æœ‰æ–°çš„æ•°æ®æˆ–å‘ç°å‡ºç°æ—¶ï¼Œä¸æ–­è°ƒæ•´ä½ å¯¹é—®é¢˜çš„ç†è§£ã€‚ç¬¬ä¸€æ€§åŸç†ä¸æ˜¯ä¸€æˆä¸å˜çš„â€”â€”éšç€æƒ…å¢ƒçš„å˜åŒ–ï¼Œæˆ‘ä»¬å¯¹åŸºç¡€åŸç†çš„è®¤è¯†ä¹Ÿåº”è¯¥ä¸æ–­æ¼”è¿›å’Œå®Œå–„ã€‚</p>
<h2 data-id="heading-7">å¦‚ä½•é¿å…å¸¸è§çš„å‘</h2>
<h4 data-id="heading-8"><strong>æŠŠç¬¬ä¸€åŸç†å’Œè¿‡åº¦åˆ†ææ··ä¸ºä¸€ä½“</strong></h4>
<ul>
<li>**é—®é¢˜ï¼š**èŠ±æ•°æœˆæ—¶é—´ç ”ç©¶ç»†å¾®çš„ç»†èŠ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿›åº¦åœæ»ã€‚ <strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä¸ºç ”ç©¶è®¾å®šæ˜ç¡®çš„è¾¹ç•Œï¼Œç„¶åè¿…é€Ÿè¿›å…¥åŸå‹å¼€å‘é˜¶æ®µã€‚ä¸è¦é™·å…¥è¿‡åº¦åˆ†æçš„æ³¥æ½­ä¸­ã€‚</li>
</ul>
<h4 data-id="heading-9"><strong>ä¾èµ–é”™è¯¯çš„åŸºç¡€</strong></h4>
<ul>
<li>**é—®é¢˜ï¼š**å¦‚æœä½ çš„æ ¸å¿ƒæ•°æ®æˆ–å¯¹ç‰©ç†å­¦çš„ç†è§£æœ‰è¯¯ï¼Œé‚£ä¹ˆä½ æ‰€æ„å»ºçš„ä¸€åˆ‡éƒ½ä¼šå´©å¡Œã€‚ <strong>è§£å†³æ–¹æ¡ˆï¼š</strong> é€šè¿‡ç®€å•çš„æµ‹è¯•æˆ–åŒè¡Œè¯„å®¡å°½æ—©éªŒè¯ä½ çš„åŸºç¡€ã€‚ç¡®ä¿ä½ çš„æ•°æ®å’Œç†è®ºåŸºç¡€æ˜¯æ­£ç¡®çš„ã€‚</li>
</ul>
<h4 data-id="heading-10"><strong>å¿½è§†æ¸è¿›ä»·å€¼</strong></h4>
<ul>
<li>**é—®é¢˜ï¼š**æœ‰æ—¶å€™ï¼Œå¯¹ç°æœ‰è§£å†³æ–¹æ¡ˆè¿›è¡Œå°çš„è°ƒæ•´ä»ç„¶å¾ˆé‡è¦ã€‚ <strong>è§£å†³æ–¹æ¡ˆï¼š</strong> å½“å®Œå…¨é‡æ–°å‘æ˜è§£å†³æ–¹æ¡ˆå¹¶ä¸ç°å®æ—¶ï¼Œä½¿ç”¨ç¬¬ä¸€åŸç†æ¥æŒ‡å¯¼æ¸è¿›å¼çš„æ”¹è¿›ã€‚å³ä½¿æ˜¯å°çš„ä¼˜åŒ–ï¼Œä¹Ÿèƒ½å¸¦æ¥æ˜¾è‘—çš„ä»·å€¼ã€‚</li>
</ul>
<h2 data-id="heading-11">ä¸€ä¸ªç®€å•çš„ç¬¬ä¸€æ€§åŸç†æ£€æŸ¥æ¸…å•</h2>
<ul>
<li>æˆ‘è‡ªå·±å¯¹è¿™ä¸ªé—®é¢˜æœ‰å“ªäº›ä¸å®¹ç½®ç–‘çš„äº‹å®ï¼Ÿ</li>
<li>æˆ‘èƒ½æ£€éªŒæˆ–å‰”é™¤å“ªäº›å‡è®¾ï¼Ÿ</li>
<li>å¦‚ä½•åˆ†ç¦»å¹¶å•ç‹¬å®éªŒå…¶ä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„è¦ç´ ï¼Ÿ</li>
<li>å¦‚æœæˆ‘ä»é›¶å¼€å§‹é‡å»ºï¼Œä¼šæœ‰ä»€ä¹ˆå…¨æ–°çš„è®¾è®¡æˆ–ç­–ç•¥å‡ºç°ï¼Ÿ</li>
<li>æˆ‘æ˜¯å¦ä¸ºè°ƒç ”è®¾å®šäº†æ—¶é—´é™åˆ¶ï¼Œä»¥å…é™·å…¥æ— ä¼‘æ­¢çš„æ€è€ƒï¼Ÿ</li>
</ul>
<p>ç¬¬ä¸€æ€§åŸç†æ€ç»´ä¸ä»…ä»…æ˜¯ä¸ªæµè¡Œè¯æ±‡â€”â€”å®ƒæ˜¯ä½ é¢å¯¹é‡å¤§æŒ‘æˆ˜æ—¶çš„ä¸€å¥—æ€ç»´å·¥å…·ï¼Œå¸®åŠ©ä½ è·³å‡ºä¼ ç»Ÿæ¡†æ¶ã€‚å½“ä½ ä¸‹æ¬¡é­é‡é¡½å›ºçš„éš¾é¢˜æ—¶ï¼Œæ— è®ºæ˜¯åœ¨å•†ä¸šç­–ç•¥ã€DIYé¡¹ç›®è¿˜æ˜¯ä¸ªäººç›®æ ‡ä¸Šï¼Œéƒ½å¯ä»¥æš‚åœä¸‹æ¥é—®è‡ªå·±ï¼šæˆ‘çœŸæ­£æŒæ¡çš„æ˜¯ä»€ä¹ˆï¼ŸæŠŠâ€œè¿™å°±æ˜¯ä¸€ç›´ä»¥æ¥çš„åšæ³•â€è¿™ä¸€å±‚å±‚æ¦‚å¿µå‰¥ç¦»å¼€ï¼Œä¸‹é¢éšè—çš„åˆ›æ–°æ€è·¯å¯èƒ½ä¼šä»¤ä½ å¤§åƒä¸€æƒŠã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ TRAE SOLO ä¸€åˆ†é’Ÿå†™ä¸ªç®€æ˜“ç‰ˆé£æœºå¤§æˆ˜]]></title>    <link>https://juejin.cn/post/7581097545671327763</link>    <guid>https://juejin.cn/post/7581097545671327763</guid>    <pubDate>2025-12-08T12:00:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097545671327763" data-draft-id="7581097545671311379" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ TRAE SOLO ä¸€åˆ†é’Ÿå†™ä¸ªç®€æ˜“ç‰ˆé£æœºå¤§æˆ˜"/> <meta itemprop="keywords" content="Trae,Solo,Python"/> <meta itemprop="datePublished" content="2025-12-08T12:00:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ TRAE SOLO ä¸€åˆ†é’Ÿå†™ä¸ªç®€æ˜“ç‰ˆé£æœºå¤§æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T12:00:12.000Z" title="Mon Dec 08 2025 12:00:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Vå“¥ï¼Œæœ€è¿‘æ‰¾åˆ°ä¸€ä¸ªå¥½ç©çš„å·¥å…· TRAEï¼Œå®˜ç½‘æ˜¯è¿™æ ·ä»‹ç»çš„ï¼šTRAE æ·±åº¦èåˆ AI èƒ½åŠ›ï¼Œæ˜¯ä¸€åèƒ½å¤Ÿç†è§£éœ€æ±‚ã€è°ƒç”¨å·¥å…·å¹¶ç‹¬ç«‹å®Œæˆå„ç±»å¼€å‘ä»»åŠ¡çš„â€œAI å¼€å‘å·¥ç¨‹å¸ˆâ€ï¼Œå¸®åŠ©ä½ é«˜æ•ˆæ¨è¿›æ¯ä¸€ä¸ªé¡¹ç›®ã€‚äº‹ä¸å®œè¿Ÿï¼Œé©¬ä¸Šå¼€å¹²ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥ä½¿ç”¨ TRAE SOLO 1åˆ†é’Ÿå†™ä¸ªç®€æ˜“ç‰ˆé£æœºå¤§æˆ˜ç©ç©ã€‚</p>
<h2 data-id="heading-0">é¦–å…ˆæˆ‘çš„éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šå¸®æˆ‘å†™ä¸€ä¸ªé£æœºå¤§æˆ˜</h2>
<p>ä¸‹é¢æ˜¯ TRAE SOLO è‡ªåŠ¨ç”Ÿæˆçš„çš„å…¨è¿‡ç¨‹</p>
<pre><code class="hljs language-makefile" lang="makefile">
æˆ‘éœ€è¦å…ˆæ£€æŸ¥å½“å‰ç›®å½•ç»“æ„ï¼Œäº†è§£é¡¹ç›®çš„åŸºç¡€æƒ…å†µï¼Œç„¶åè§„åˆ’é£æœºå¤§æˆ˜æ¸¸æˆçš„å®ç°æ­¥éª¤ã€‚
        
            
<span class="hljs-section">toolName: view_folder</span>
            
<span class="hljs-section">status: success</span>
          
/Users/vince/Trae/demo1
          
æŸ¥çœ‹main.pyçš„å†…å®¹ï¼Œäº†è§£ç°æœ‰ä»£ç æƒ…å†µï¼Œç„¶åè§„åˆ’é£æœºå¤§æˆ˜æ¸¸æˆçš„å®ç°ã€‚
        
            
<span class="hljs-section">toolName: view_files</span>
            
<span class="hljs-section">status: success</span>
          
            
<span class="hljs-section">filePath: /Users/vince/Trae/demo1/main.py</span>
          
æˆ‘å°†é‡å†™main.pyæ–‡ä»¶ï¼Œå®ç°ä¸€ä¸ªå®Œæ•´çš„é£æœºå¤§æˆ˜æ¸¸æˆï¼ŒåŒ…å«ç©å®¶é£æœºã€æ•Œæœºã€å­å¼¹ç³»ç»Ÿå’Œç¢°æ’æ£€æµ‹ç­‰åŠŸèƒ½ã€‚
        
            
<span class="hljs-section">toolName: edit_file_search_replace</span>
            
<span class="hljs-section">status: success</span>
          
            
<span class="hljs-section">filePath: /Users/vince/Trae/demo1/main.py</span>
          
<span class="hljs-section">changes: undefined</span>
          
ç°åœ¨æˆ‘éœ€è¦å®‰è£…pygameåº“ï¼Œç„¶åè¿è¡Œæ¸¸æˆæ¥æµ‹è¯•æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚
        
            
<span class="hljs-section">toolName: run_command</span>
            
<span class="hljs-section">status: success</span>
          
<span class="hljs-section">command: pip install pygame undefined</span>
          
ä½¿ç”¨python -m pipæ¥å®‰è£…pygameåº“ï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨pipå‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ã€‚
        
            
<span class="hljs-section">toolName: run_command</span>
            
<span class="hljs-section">status: success</span>
          
<span class="hljs-section">command: python -m pip install pygame undefined</span>
          
ä½¿ç”¨python3 -m pipæ¥å®‰è£…pygameåº“ï¼Œå› ä¸ºç¯å¢ƒä¸­å¯èƒ½åªå®‰è£…äº†python3ã€‚
        
            
<span class="hljs-section">toolName: run_command</span>
            
<span class="hljs-section">status: success</span>
          
<span class="hljs-section">command: python3 -m pip install pygame undefined</span>
          
pygameå®‰è£…å¤±è´¥ï¼Œå› ä¸ºç¼ºå°‘SDLä¾èµ–ã€‚æˆ‘å°†ä¿®æ”¹ä»£ç ï¼Œä½¿ç”¨Pythonå†…ç½®çš„turtleåº“æ¥å®ç°é£æœºå¤§æˆ˜æ¸¸æˆï¼Œè¿™æ ·ä¸éœ€è¦ä»»ä½•å¤–éƒ¨ä¾èµ–ã€‚
        
            
<span class="hljs-section">toolName: edit_file_search_replace</span>
            
<span class="hljs-section">status: success</span>
          
            
<span class="hljs-section">filePath: /Users/vince/Trae/demo1/main.py</span>
          
<span class="hljs-section">changes: undefined</span>
          
ç°åœ¨è¿è¡Œæ¸¸æˆï¼Œæµ‹è¯•ä½¿ç”¨turtleåº“å®ç°çš„é£æœºå¤§æˆ˜æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚
        
            
<span class="hljs-section">toolName: run_command</span>
            
<span class="hljs-section">status: success</span>
          
<span class="hljs-section">command: python3 main.py undefined</span>
          
turtleåº“åœ¨macOSä¸Šé‡åˆ°äº†Tkä¾èµ–é—®é¢˜ï¼Œæˆ‘å°†é‡æ–°ç¼–å†™ä¸€ä¸ªåŸºäºæ–‡æœ¬ç•Œé¢çš„é£æœºå¤§æˆ˜æ¸¸æˆï¼Œä½¿ç”¨Pythonæ ‡å‡†åº“ï¼Œæ— éœ€ä»»ä½•å¤–éƒ¨ä¾èµ–ã€‚
        
            
<span class="hljs-section">toolName: edit_file_search_replace</span>
            
<span class="hljs-section">status: success</span>
          
            
<span class="hljs-section">filePath: /Users/vince/Trae/demo1/main.py</span>
          
<span class="hljs-section">changes: undefined</span>
          
ä¿®æ”¹ä»£ç ï¼Œä½¿ç”¨è·¨å¹³å°çš„éé˜»å¡é”®ç›˜è¾“å…¥æ–¹å¼ï¼Œæ›¿æ¢Windowsç‰¹æœ‰çš„msvcrtåº“ã€‚
        
            
<span class="hljs-section">toolName: edit_file_search_replace</span>
            
<span class="hljs-section">status: success</span>
          
            
<span class="hljs-section">filePath: /Users/vince/Trae/demo1/main.py</span>
          
<span class="hljs-section">changes: undefined</span>
          
è¿è¡Œæ¸¸æˆï¼Œæµ‹è¯•è·¨å¹³å°çš„æ–‡æœ¬ç•Œé¢é£æœºå¤§æˆ˜æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚
        
            
<span class="hljs-section">toolName: run_command</span>
            
<span class="hljs-section">status: success</span>
          
<span class="hljs-section">command: python3 main.py undefined</span>
          
é£æœºå¤§æˆ˜æ¸¸æˆå·²ç»æˆåŠŸç¼–å†™å®Œæˆï¼ä»¥ä¸‹æ˜¯æ¸¸æˆçš„ä¸»è¦åŠŸèƒ½å’Œç‰¹ç‚¹ï¼š

<span class="hljs-comment">## æ¸¸æˆåŠŸèƒ½</span>

- **ç©å®¶æ§åˆ¶**ï¼šä½¿ç”¨Aé”®å‘å·¦ç§»åŠ¨ï¼ŒDé”®å‘å³ç§»åŠ¨
- **æ­¦å™¨ç³»ç»Ÿ**ï¼šç©ºæ ¼é”®å‘å°„å­å¼¹
- **æ•Œæœºç³»ç»Ÿ**ï¼šè‡ªåŠ¨ç”Ÿæˆæ•Œæœºå¹¶å‘ä¸‹ç§»åŠ¨
- **ç¢°æ’æ£€æµ‹**ï¼š
  - å­å¼¹å‡»ä¸­æ•Œæœºå¾—åˆ†
  - æ•Œæœºæ’å‡»ç©å®¶æ¸¸æˆç»“æŸ
- **åˆ†æ•°ç³»ç»Ÿ**ï¼šå‡»ä¸­ä¸€æ¶æ•Œæœºå¾—10åˆ†
- **æ¸¸æˆçŠ¶æ€**ï¼šæ”¯æŒæ¸¸æˆç»“æŸã€é‡æ–°å¼€å§‹å’Œé€€å‡ºåŠŸèƒ½

<span class="hljs-comment">## æ¸¸æˆç‰¹ç‚¹</span>

- **è·¨å¹³å°**ï¼šæ”¯æŒWindowså’ŒmacOS/Linuxç³»ç»Ÿ
- **æ— å¤–éƒ¨ä¾èµ–**ï¼šä»…ä½¿ç”¨Pythonæ ‡å‡†åº“
- **æ–‡æœ¬ç•Œé¢**ï¼šä½¿ç”¨å­—ç¬¦ç»˜åˆ¶æ¸¸æˆå…ƒç´ ï¼Œç®€æ´ç›´è§‚
- **æ“ä½œç®€å•**ï¼šæ¸…æ™°çš„æ“ä½œè¯´æ˜
- **ä»£ç ç»“æ„æ¸…æ™°**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•

<span class="hljs-comment">## è¿è¡Œæ–¹å¼</span>

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
</code></pre>
<p>python3 main.py</p>
<pre><code class="hljs language-markdown" lang="markdown">
<span class="hljs-section">## æ“ä½œè¯´æ˜</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**Aé”®**</span>ï¼šå‘å·¦ç§»åŠ¨
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Dé”®**</span>ï¼šå‘å³ç§»åŠ¨
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç©ºæ ¼é”®**</span>ï¼šå‘å°„å­å¼¹
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Ré”®**</span>ï¼šæ¸¸æˆç»“æŸåé‡æ–°å¼€å§‹
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Qé”®**</span>ï¼šé€€å‡ºæ¸¸æˆ

æ¸¸æˆå·²ç»å¯ä»¥è¿è¡Œï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸­ä½“éªŒè¿™ä¸ªç®€å•è€Œæœ‰è¶£çš„é£æœºå¤§æˆ˜æ¸¸æˆï¼

</code></pre>
<p>å®Œæˆä»¥ä¸ŠåŠ¨ä½œåï¼Œåœ¨ä»£ç åŒºç”Ÿæˆçš„pyä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> select

<span class="hljs-comment"># æ¸¸æˆè®¾ç½®</span>
WIDTH = <span class="hljs-number">40</span>
HEIGHT = <span class="hljs-number">20</span>
PLAYER_CHAR = <span class="hljs-string">"â–²"</span>
ENEMY_CHAR = <span class="hljs-string">"â–¼"</span>
BULLET_CHAR = <span class="hljs-string">"|"</span>
EMPTY_CHAR = <span class="hljs-string">" "</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PlaneGame</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.player_x = WIDTH // <span class="hljs-number">2</span>
        self.player_y = HEIGHT - <span class="hljs-number">2</span>
        self.bullets = []
        self.enemies = []
        self.score = <span class="hljs-number">0</span>
        self.game_over = <span class="hljs-literal">False</span>
        self.last_enemy_time = time.time()
        self.enemy_spawn_delay = <span class="hljs-number">1.0</span>  <span class="hljs-comment"># ç§’</span>
        
        <span class="hljs-comment"># è®¾ç½®æ ‡å‡†è¾“å…¥ä¸ºéé˜»å¡</span>
        <span class="hljs-keyword">if</span> os.name == <span class="hljs-string">'nt'</span>:
            <span class="hljs-keyword">import</span> msvcrt
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Unixç³»ç»Ÿè®¾ç½®</span>
            <span class="hljs-keyword">import</span> tty
            <span class="hljs-keyword">import</span> termios
            self.old_settings = termios.tcgetattr(sys.stdin)
            tty.setcbreak(sys.stdin.fileno())
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">clear_screen</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># è·¨å¹³å°æ¸…å±</span>
        os.system(<span class="hljs-string">'cls'</span> <span class="hljs-keyword">if</span> os.name == <span class="hljs-string">'nt'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'clear'</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params">self</span>):
        self.clear_screen()
        
        <span class="hljs-comment"># åˆ›å»ºæ¸¸æˆç½‘æ ¼</span>
        grid = [[EMPTY_CHAR <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(WIDTH)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(HEIGHT)]
        
        <span class="hljs-comment"># ç»˜åˆ¶ç©å®¶</span>
        grid[self.player_y][self.player_x] = PLAYER_CHAR
        
        <span class="hljs-comment"># ç»˜åˆ¶å­å¼¹</span>
        <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets:
            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= bullet[<span class="hljs-number">1</span>] &lt; HEIGHT <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= bullet[<span class="hljs-number">0</span>] &lt; WIDTH:
                grid[bullet[<span class="hljs-number">1</span>]][bullet[<span class="hljs-number">0</span>]] = BULLET_CHAR
        
        <span class="hljs-comment"># ç»˜åˆ¶æ•Œæœº</span>
        <span class="hljs-keyword">for</span> enemy <span class="hljs-keyword">in</span> self.enemies:
            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= enemy[<span class="hljs-number">1</span>] &lt; HEIGHT <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= enemy[<span class="hljs-number">0</span>] &lt; WIDTH:
                grid[enemy[<span class="hljs-number">1</span>]][enemy[<span class="hljs-number">0</span>]] = ENEMY_CHAR
        
        <span class="hljs-comment"># ç»˜åˆ¶è¾¹ç•Œ</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * (WIDTH + <span class="hljs-number">2</span>))
        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> grid:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"|"</span> + <span class="hljs-string">""</span>.join(row) + <span class="hljs-string">"|"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * (WIDTH + <span class="hljs-number">2</span>))
        
        <span class="hljs-comment"># ç»˜åˆ¶åˆ†æ•°</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ†æ•°: <span class="hljs-subst">{self.score}</span>"</span>)
        
        <span class="hljs-keyword">if</span> self.game_over:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¸¸æˆç»“æŸï¼æŒ‰Ré”®é‡æ–°å¼€å§‹ï¼ŒæŒ‰Qé”®é€€å‡º"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ“ä½œè¯´æ˜ï¼šAé”®å‘å·¦ï¼ŒDé”®å‘å³ï¼Œç©ºæ ¼é”®å‘å°„"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ“ä½œè¯´æ˜ï¼šAé”®å‘å·¦ï¼ŒDé”®å‘å³ï¼Œç©ºæ ¼é”®å‘å°„ï¼ŒQé”®é€€å‡º"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_input</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># è·¨å¹³å°éé˜»å¡é”®ç›˜è¾“å…¥</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">if</span> os.name == <span class="hljs-string">'nt'</span>:
                <span class="hljs-keyword">import</span> msvcrt
                <span class="hljs-keyword">if</span> msvcrt.kbhit():
                    key = msvcrt.getch().decode(<span class="hljs-string">'utf-8'</span>).lower()
                    self.process_key(key)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># Unixç³»ç»Ÿä½¿ç”¨select</span>
                rlist, _, _ = select.select([sys.stdin], [], [], <span class="hljs-number">0.01</span>)
                <span class="hljs-keyword">if</span> rlist:
                    key = sys.stdin.read(<span class="hljs-number">1</span>).lower()
                    self.process_key(key)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_key</span>(<span class="hljs-params">self, key</span>):
        <span class="hljs-keyword">if</span> key == <span class="hljs-string">'a'</span> <span class="hljs-keyword">and</span> self.player_x &gt; <span class="hljs-number">0</span>:
            self.player_x -= <span class="hljs-number">1</span>
        <span class="hljs-keyword">elif</span> key == <span class="hljs-string">'d'</span> <span class="hljs-keyword">and</span> self.player_x &lt; WIDTH - <span class="hljs-number">1</span>:
            self.player_x += <span class="hljs-number">1</span>
        <span class="hljs-keyword">elif</span> key == <span class="hljs-string">' '</span>:
            <span class="hljs-comment"># å‘å°„å­å¼¹</span>
            self.bullets.append([self.player_x, self.player_y - <span class="hljs-number">1</span>])
        <span class="hljs-keyword">elif</span> key == <span class="hljs-string">'r'</span> <span class="hljs-keyword">and</span> self.game_over:
            self.reset_game()
        <span class="hljs-keyword">elif</span> key == <span class="hljs-string">'q'</span>:
            self.exit_game()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">exit_game</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># æ¢å¤ç»ˆç«¯è®¾ç½®</span>
        <span class="hljs-keyword">if</span> os.name != <span class="hljs-string">'nt'</span>:
            <span class="hljs-keyword">import</span> termios
            termios.tcsetattr(sys.stdin, termios.TCSADRAIN, self.old_settings)
        sys.exit()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.game_over:
            <span class="hljs-comment"># æ›´æ–°å­å¼¹</span>
            new_bullets = []
            <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets:
                bullet[<span class="hljs-number">1</span>] -= <span class="hljs-number">1</span>  <span class="hljs-comment"># å­å¼¹å‘ä¸Šç§»åŠ¨</span>
                <span class="hljs-keyword">if</span> bullet[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0</span>:  <span class="hljs-comment"># å­å¼¹æœªé£å‡ºå±å¹•</span>
                    new_bullets.append(bullet)
            self.bullets = new_bullets
            
            <span class="hljs-comment"># ç”Ÿæˆæ•Œæœº</span>
            current_time = time.time()
            <span class="hljs-keyword">if</span> current_time - self.last_enemy_time &gt; self.enemy_spawn_delay:
                enemy_x = random.randint(<span class="hljs-number">0</span>, WIDTH - <span class="hljs-number">1</span>)
                self.enemies.append([enemy_x, <span class="hljs-number">0</span>])
                self.last_enemy_time = current_time
            
            <span class="hljs-comment"># æ›´æ–°æ•Œæœº</span>
            new_enemies = []
            <span class="hljs-keyword">for</span> enemy <span class="hljs-keyword">in</span> self.enemies:
                enemy[<span class="hljs-number">1</span>] += <span class="hljs-number">1</span>  <span class="hljs-comment"># æ•Œæœºå‘ä¸‹ç§»åŠ¨</span>
                <span class="hljs-keyword">if</span> enemy[<span class="hljs-number">1</span>] &lt; HEIGHT:  <span class="hljs-comment"># æ•Œæœºæœªé£å‡ºå±å¹•</span>
                    new_enemies.append(enemy)
            self.enemies = new_enemies
            
            <span class="hljs-comment"># æ£€æµ‹ç¢°æ’ï¼šå­å¼¹å‡»ä¸­æ•Œæœº</span>
            bullets_to_remove = []
            enemies_to_remove = []
            
            <span class="hljs-keyword">for</span> i, bullet <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.bullets):
                <span class="hljs-keyword">for</span> j, enemy <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.enemies):
                    <span class="hljs-keyword">if</span> bullet[<span class="hljs-number">0</span>] == enemy[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> bullet[<span class="hljs-number">1</span>] == enemy[<span class="hljs-number">1</span>]:
                        bullets_to_remove.append(i)
                        enemies_to_remove.append(j)
                        self.score += <span class="hljs-number">10</span>
            
            <span class="hljs-comment"># åˆ é™¤å‡»ä¸­çš„å­å¼¹å’Œæ•Œæœºï¼ˆä»åå¾€å‰åˆ é™¤ï¼Œé¿å…ç´¢å¼•é—®é¢˜ï¼‰</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(bullets_to_remove, reverse=<span class="hljs-literal">True</span>):
                <span class="hljs-keyword">del</span> self.bullets[i]
            
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(enemies_to_remove, reverse=<span class="hljs-literal">True</span>):
                <span class="hljs-keyword">del</span> self.enemies[j]
            
            <span class="hljs-comment"># æ£€æµ‹ç¢°æ’ï¼šæ•Œæœºæ’å‡»ç©å®¶</span>
            <span class="hljs-keyword">for</span> enemy <span class="hljs-keyword">in</span> self.enemies:
                <span class="hljs-keyword">if</span> enemy[<span class="hljs-number">0</span>] == self.player_x <span class="hljs-keyword">and</span> enemy[<span class="hljs-number">1</span>] == self.player_y:
                    self.game_over = <span class="hljs-literal">True</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reset_game</span>(<span class="hljs-params">self</span>):
        self.player_x = WIDTH // <span class="hljs-number">2</span>
        self.player_y = HEIGHT - <span class="hljs-number">2</span>
        self.bullets = []
        self.enemies = []
        self.score = <span class="hljs-number">0</span>
        self.game_over = <span class="hljs-literal">False</span>
        self.last_enemy_time = time.time()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            self.handle_input()
            self.update()
            self.draw()
            time.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ§åˆ¶æ¸¸æˆé€Ÿåº¦</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    game = PlaneGame()
    game.run()
</code></pre>
<p>ä¸‹é¢æˆ‘æ¥æµ‹è¯•è¿è¡Œä¸€ä¸‹ï¼Œå•å‡»ä»£ç åŒºå³ä¸Šè§’çš„è¿è¡ŒæŒ‰é’®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/352ae9b75e1c48a1a88275549e00b535~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765800012&amp;x-signature=lLMUQzjmKIkvR099a96WoBaKdgs%3D" alt="" loading="lazy"/></p>
<p>åœ¨ç»ˆç«¯è¿è¡Œçš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01787c909cf747c99b059c5c10743cd7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765800012&amp;x-signature=M%2FgR0v%2Bxm5FUld1LVcG8p3By%2FHc%3D" alt="" loading="lazy"/></p>
<p>å•¥ä¹Ÿä¸è¯´ï¼ŒVå“¥å…ˆçˆ½ä¸€æŠŠã€‚</p>
<h2 data-id="heading-1">å°ç»“ä¸€ä¸‹</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8656d69efe94e01b3aaea4302689396~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765800012&amp;x-signature=QYFQxr%2FuFAtbooUbbqj20%2F2Eupw%3D" alt="" loading="lazy"/></p>
<p>TRAE è¦†ç›–ä»ç¼–ç ã€è°ƒè¯•åˆ°æµ‹è¯•ã€é‡æ„ã€éƒ¨ç½²ç­‰å¤šç±»å¼€å‘ä»»åŠ¡ã€‚æä¾›æ™ºèƒ½ä½“ç¼–ç¨‹å·¥å…· CUEï¼Œæ”¯æŒä»£ç è¡¥å…¨ã€å¤šè¡Œä¿®æ”¹ã€æ™ºèƒ½å¯¼å…¥å’Œæ™ºèƒ½é‡å‘½åç­‰åŠŸèƒ½ï¼Œé€‚é…å¤šç§æ—¥å¸¸å¼€å‘åœºæ™¯ï¼Œå¸®åŠ©ä½ å‡å°‘é‡å¤æ“ä½œï¼Œä¸“æ³¨æ ¸å¿ƒåˆ›æ–°ã€‚TRAE ä¸ä»…å°† AI é›†æˆè¿› IDEï¼Œä¹Ÿè®© Al ä½¿ç”¨æ›´å¤šå¼€å‘å·¥å…·ã€‚TRAE ç›®å‰æ‹¥æœ‰åŒé‡å¼€å‘æ¨¡å¼ï¼šIDE æ¨¡å¼ä¿ç•™åŸæœ‰æµç¨‹ï¼Œæ§åˆ¶æ„Ÿæ›´å¼ºï¼›SOLO æ¨¡å¼è®© AI ä¸»å¯¼ä»»åŠ¡ï¼Œè‡ªåŠ¨æ¨è¿›å¼€å‘ä»»åŠ¡ã€‚ä½ å¯æ ¹æ®ä»»åŠ¡éœ€æ±‚è‡ªç”±åˆ‡æ¢ï¼Œè®©é«˜æ•ˆä¸çµæ´»å¹¶å­˜ã€‚å…„å¼Ÿä»¬ï¼Œä¸ç”¨çŠ¹è±«ï¼Œå¿«å»è¯•è¯•å§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift 6.2 åˆ—ä¼ ï¼ˆç¬¬ä¸‰ç¯‡ï¼‰ï¼šå­—ç¬¦ä¸²æ’å€¼çš„ â€œè¡¥ä½ç¥æŠ€â€]]></title>    <link>https://juejin.cn/post/7580303864605458441</link>    <guid>https://juejin.cn/post/7580303864605458441</guid>    <pubDate>2025-12-07T02:19:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580303864605458441" data-draft-id="7580374090365042726" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift 6.2 åˆ—ä¼ ï¼ˆç¬¬ä¸‰ç¯‡ï¼‰ï¼šå­—ç¬¦ä¸²æ’å€¼çš„ â€œè¡¥ä½ç¥æŠ€â€"/> <meta itemprop="keywords" content="å‰ç«¯,Swift,Apple"/> <meta itemprop="datePublished" content="2025-12-07T02:19:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§ç†ŠçŒ«ä¾¯ä½©"/> <meta itemprop="url" content="https://juejin.cn/user/4292907536222152"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift 6.2 åˆ—ä¼ ï¼ˆç¬¬ä¸‰ç¯‡ï¼‰ï¼šå­—ç¬¦ä¸²æ’å€¼çš„ â€œè¡¥ä½ç¥æŠ€â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4292907536222152/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§ç†ŠçŒ«ä¾¯ä½©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T02:19:54.000Z" title="Sun Dec 07 2025 02:19:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb99131ac1074f19a60aba46e1641d4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=QfaAt0SeCyQyQ4oMtmaC96xtt4k%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-0">å¼•å­ï¼šç³–è‘«èŠ¦ä¸æŠ¥é”™é½é£ï¼Œç†ŠçŒ«ä¾ å¡å£³å®¢æ ˆ</h2>
<p>æ´›é˜³åŸçš„ â€œç æ—åˆ†èˆµâ€ å®¢æ ˆé‡Œï¼Œå¤§ç†ŠçŒ«ä¾¯ä½©æ­£ä¸€æ‰‹æ”¥ç€ç³–è‘«èŠ¦ï¼Œä¸€æ‰‹æˆ³ç€å±å¹•ä¸Šçš„çº¢è‰²æŠ¥é”™ï¼Œåœ†è„¸è›‹çš±æˆäº†åŒ…å­ã€‚</p>
<p>è¿™ä½è‡ªç§° â€œæ’å€¼å°èƒ½æ‰‹ï¼Œå¤´äº®ä¹Ÿä¸ç§ƒâ€ çš„ Swift ç©å®¶ï¼Œæ­¤åˆ»æ­£è¢«ä¸€è¡Œå­—ç¬¦ä¸²æ‰“å°ä»£ç éš¾ä½ â€”â€” ç”¨æˆ·ä¿¡æ¯é‡Œçš„<code>age</code>æ˜¯<code>Int?</code>ï¼Œæƒ³ç»™ä¸ª â€œUnknownâ€ å½“é»˜è®¤å€¼ï¼Œç»“æœç¼–è¯‘å™¨åè¯´ â€œç±»å‹ä¸åŒ¹é…ï¼Œæ­¤è·¯ä¸é€šâ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/449e1e4c49f448ddb08fc49a781883f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=y27FK4Ff8LsDK4dL8gqC%2BV5E4X0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€œå²‚æœ‰æ­¤ç†ï¼â€ ä¾¯ä½©å’¬ç¢ä¸€é¢—å±±æ¥‚ï¼Œç³–æ¸£æ‰åœ¨é”®ç›˜ä¸Šï¼Œâ€œ<code>name ?? "Anonymous"</code>è¿˜å¥½å¥½çš„ï¼Œæ¢<code>age</code>å°±ç¿»è„¸ï¼Ÿéš¾ä¸æˆè¦æˆ‘å…ˆæŠŠ<code>age</code>è½¬æˆå­—ç¬¦ä¸²ï¼Œå¤šæ­¤ä¸€ä¸¾åƒç»•è¿œè·¯åƒåŒ…å­ï¼Ÿâ€</p>
<p>åœ¨æœ¬ç¯‡æ­¦æ—åˆ—ä¼ ä¸­ï¼Œæ‚¨å°†å­¦åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>å¼•å­ï¼šç³–è‘«èŠ¦ä¸æŠ¥é”™é½é£ï¼Œç†ŠçŒ«ä¾ å¡å£³å®¢æ ˆ</li>
<li>ğŸ¯ 1. æ–°æ‹›æ­ç§˜ï¼šSE-0477 çš„ â€œç®€çº¦è¡¥ä½æœ¯â€</li>
<li>ğŸ¤” 2. åˆçœ‹å¹³æ·¡ï¼Ÿnil coalescing çš„ â€œè½¯è‚‹â€ åœ¨æ­¤</li>
<li>âœ¨ 3. å…³é”®çªç ´ï¼šè·¨ç±»å‹è¡¥ä½çš„ â€œé€šå…³ç§˜ç±â€</li>
<li>ğŸš¨ 4. ç»†èŠ‚æé†’ï¼šåˆ«è¸© â€œé»˜è®¤å€¼ç±»å‹â€ çš„å°å‘</li>
<li>ğŸ”® ç»“å°¾ï¼šå¤æ‚æ’å€¼ç°æ–°ç–‘ï¼Œç§˜ç±æ®‹é¡µè—ç„æœº</li>
</ul>
<p>å°±åœ¨ä»–å‡†å¤‡å†™ â€œç¬¨åŠæ³•â€ æ—¶ï¼Œçª—è¾¹ä¼ æ¥è½»æŸ”çš„å£°éŸ³ï¼šâ€œä¾¯å¤§ä¾ è«æ€¥ï¼Œæˆ‘è¿™æœ‰ SE-0477 çš„â€˜è¡¥ä½ç¥æŠ€â€™ï¼ˆ<strong>Default Value in String Interpolations</strong>ï¼‰ï¼Œä¸“è§£è¿™ç§â€˜ç±»å‹ä¸å¯¹ä»˜â€™çš„éš¾é¢˜ã€‚â€ åªè§ç¨‹çµç´ ä¸€èº«é’å¸ƒè¡£è£™ï¼Œæ‰‹ä¸­æ‹¿ç€æœ¬ã€ŠSwift æ’å€¼ç§˜ç±ã€‹ï¼Œç¬‘å®¹æ¸©å’Œå¦‚æ˜¥é£ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f29f646596794177923d4b4054b3fe12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=rxrb%2F%2Bmt%2Fb9w8TlQI5KnCCAxGDg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">ğŸ¯ 1. æ–°æ‹›æ­ç§˜ï¼šSE-0477 çš„ â€œç®€çº¦è¡¥ä½æœ¯â€</h2>
<p>SE-0477 è¿™é—¨åŠŸæ³•ï¼Œçœ‹ä¼¼å°å·§ï¼Œå´è—ç€å¤§æ™ºæ…§ â€”â€” å®ƒç»™<strong>å­—ç¬¦ä¸²æ’å€¼ï¼ˆString Interpolationï¼‰</strong> é‡Œçš„<strong>å¯é€‰ç±»å‹ï¼ˆoptionalï¼‰</strong> åŠ äº† â€œè¡¥ä½åŠŸèƒ½â€ï¼š</p>
<blockquote>
<p>å¦‚æœå¯é€‰å€¼æ˜¯<code>nil</code>ï¼Œç›´æ¥åœ¨æ’å€¼é‡ŒæŒ‡å®šé»˜è®¤å€¼å°±è¡Œï¼Œä¸ç”¨å†å†™é¢å¤–çš„åˆ¤æ–­ã€‚</p>
</blockquote>
<p>ä¾¯ä½©å‡‘è¿‡å»ä¸€çœ‹ï¼Œç¨‹çµç´ å†™ä¸‹çš„åŸºç¡€ç”¨æ³•è®©ä»–çœ¼å‰ä¸€äº®ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span> <span class="hljs-comment">// ç”¨æˆ·æ²¡å¡«åå­—ï¼Œæ˜¯nil</span>

<span class="hljs-comment">// ç”¨SE-0477çš„æ–°è¯­æ³•ï¼šæ’å€¼é‡ŒåŠ (default: é»˜è®¤å€¼)</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello, <span class="hljs-subst">\(name, <span class="hljs-keyword">default</span>: <span class="hljs-string">"Anonymous"</span>)</span>!"</span>)

<span class="hljs-comment">// ç›´æ¥è¾“å‡ºï¼šHello, Anonymous!</span>
</code></pre>
<p>â€œè¿™æ¯”ä»¥å‰çš„<code>\(name ?? "Anonymous")</code>å°±å°‘ä¸ªé—®å·å•Šï¼Ÿâ€ ä¾¯ä½©æŒ æŒ å¤´ï¼Œå±±æ¥‚æ ¸å·®ç‚¹æ‰è¿›é”®ç›˜ç¼ï¼Œâ€œçœ‹ç€ä¹Ÿæ²¡å¤šå‰å®³å˜›ã€‚â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8d63da0ad6c478eb7aaa0c38b98d9c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=S47fj4g6QV7lS%2Fm6jQdB07DVWVo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç¨‹çµç´ ç¬‘ç€æ‘‡å¤´ï¼šâ€œä¾¯å¤§ä¾ åˆ«æ€¥ï¼Œè¿™åªæ˜¯â€˜å¼€èƒƒå°èœâ€™ï¼ŒçœŸæ­£çš„å‰å®³ä¹‹å¤„ï¼Œä½ ä¸”åé¢å†çœ‹ã€‚â€</p>
<hr/>
<h2 data-id="heading-2">ğŸ¤” 2. åˆçœ‹å¹³æ·¡ï¼Ÿnil coalescing çš„ â€œè½¯è‚‹â€ åœ¨æ­¤</h2>
<p>ä¾¯ä½©ä¸æœæ°”ï¼Œæå‡ºä¹‹å‰èƒ½è·‘çš„ä»£ç ï¼šâ€œä½ çœ‹ï¼Œ<code>age ?? 0</code>å°±æ²¡é—®é¢˜ï¼Œæ‰“å°å‡ºæ¥æ˜¯â€˜Age: 0â€™ï¼Œä¹Ÿæ²¡æŠ¥é”™å•Šï¼â€</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> age: <span class="hljs-type">Int</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>

<span class="hljs-comment">// ä»¥å‰çš„nil coalescingï¼ˆç©ºåˆè¿ç®—ç¬¦ï¼‰å†™æ³•ï¼Œé»˜è®¤å€¼æ˜¯Intç±»å‹</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"Age: <span class="hljs-subst">\(age <span class="hljs-operator">??</span> <span class="hljs-number">0</span>)</span>"</span>) <span class="hljs-comment">// è¾“å‡ºï¼šAge: 0</span>
</code></pre>
<p>â€œå¯è¦æ˜¯ä½ æƒ³ç»™â€˜Unknownâ€™å½“é»˜è®¤å€¼å‘¢ï¼Ÿâ€ ç¨‹çµç´ è½»è½»ä¸€ç‚¹å±å¹•ï¼Œâ€œæ¯”å¦‚äº§å“è¯´â€˜æ²¡å¹´é¾„å°±æ˜¾ç¤º â€œæœªçŸ¥â€â€™ï¼Œä½ å†è¯•è¯•ï¼Ÿâ€</p>
<p>ä¾¯ä½©ç«‹é©¬ä¿®æ”¹ï¼Œç»“æœçº¢è‰²æŠ¥é”™åˆå†’äº†å‡ºæ¥ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ ç¼–è¯‘æŠ¥é”™ï¼šInt?å’ŒStringç±»å‹ä¸å…¼å®¹ï¼Œnil coalescingä¸æ”¯æŒè·¨ç±»å‹</span>

<span class="hljs-comment">// print("Age: \(age ?? "Unknown")")</span>
</code></pre>
<p>â€œè¿™ä¸å°±å¡å£³äº†ï¼Ÿâ€ ç¨‹çµç´ èå°”ï¼Œâ€œ<code>nil coalescing</code>ï¼ˆç©ºåˆè¿ç®—ç¬¦ï¼‰çš„è½¯è‚‹å°±åœ¨è¿™ â€”â€” å®ƒè¦æ±‚é»˜è®¤å€¼å’Œå¯é€‰å€¼<strong>ç±»å‹å¿…é¡»ä¸€è‡´</strong>ï¼Œå°±åƒç³–è‘«èŠ¦åªèƒ½ä¸²å±±æ¥‚ï¼Œä¸èƒ½æ··ç€åŒ…å­ä¸²ã€‚â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e87a686878624a0b8133aa4fee77fb5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=IVUfo6dhvq4L3esHRiHpMwVZV6A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¾¯ä½©æç„¶å¤§æ‚Ÿï¼Œæ‹äº†ä¸‹å¤§è…¿ï¼ˆå·®ç‚¹æŠŠç³–è‘«èŠ¦æ‹æ‰ï¼‰ï¼šâ€œåŸæ¥å¦‚æ­¤ï¼æˆ‘ä¹‹å‰ç»•è¿œè·¯è½¬ç±»å‹ï¼Œå°±æ˜¯å› ä¸ºè¿™â€˜ç±»å‹é”â€™ï¼â€</p>
<hr/>
<h2 data-id="heading-3">âœ¨ 3. å…³é”®çªç ´ï¼šè·¨ç±»å‹è¡¥ä½çš„ â€œé€šå…³ç§˜ç±â€</h2>
<p>â€œåˆ«æ€¥ï¼ŒSE-0477 çš„â€˜è¡¥ä½ç¥æŠ€â€™ï¼Œå°±æ˜¯æ¥è§£è¿™â€˜ç±»å‹é”â€™çš„ã€‚â€</p>
<p>ç¨‹çµç´ æ‹¿èµ·ç¬”ï¼Œåœ¨çº¸ä¸Šå†™ä¸‹å…³é”®ä»£ç ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> age: <span class="hljs-type">Int</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>

<span class="hljs-comment">// âœ… Swift 6.2+æ–°è¯­æ³•ï¼šæ’å€¼é‡Œç›´æ¥ç»™ä¸åŒç±»å‹çš„é»˜è®¤å€¼</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"Age: <span class="hljs-subst">\(age, <span class="hljs-keyword">default</span>: <span class="hljs-string">"Unknown"</span>)</span>"</span>);

<span class="hljs-comment">// è¾“å‡ºï¼šAge: Unknown</span>
</code></pre>
<p>ä¾¯ä½©çœ¼ç›çªå¾—æºœåœ†ï¼Œèµ¶ç´§åœ¨ç”µè„‘ä¸Šè¯•äº†è¯• â€”â€” å±…ç„¶çœŸçš„ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œç»“æœå®Œç¾ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab53348d05154b24a3c35f9e70266a0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=9mLY9S4bshJESHJ0QBsTtxOACmo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€œè¿™ä¹Ÿå¤ªä¸æ»‘äº†å§ï¼â€ ä¾¯ä½©æ¿€åŠ¨åœ°å’¬äº†å£ç³–è‘«èŠ¦ï¼Œâ€œä¸ç”¨è½¬ç±»å‹ï¼Œä¸ç”¨å†™é¢å¤–åˆ¤æ–­ï¼Œåƒç¨‹å§‘å¨˜ä½ é…è¯ä¸€æ ·ï¼Œæ—¢ç²¾å‡†åˆçœäº‹ï¼â€</p>
<p>ç¨‹çµç´ è¡¥å……é“ï¼šâ€œå®ƒçš„åŸç†å¾ˆç®€å• â€”â€” æ’å€¼æ—¶ Swift ä¼šè‡ªåŠ¨å¤„ç†ç±»å‹è½¬æ¢ï¼ŒæŠŠ<code>Int?</code>å’Œ<code>String</code>çš„é»˜è®¤å€¼â€˜è°ƒå’Œâ€™æˆå­—ç¬¦ä¸²è¾“å‡ºï¼Œå°±åƒæˆ‘é…è¯æ—¶è°ƒå’Œä¸åŒè¯æï¼Œè®©å®ƒä»¬å‘æŒ¥åˆåŠ›ã€‚â€</p>
<p>ä¸ºäº†è®©ä¾¯ä½©å½»åº•æ˜ç™½ï¼Œå¥¹åˆå†™äº†ä¸ª â€œç”¨æˆ·ä¿¡æ¯æ±‡æ€»â€ çš„å®æˆ˜ä¾‹å­ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®ï¼šnameæ˜¯String?ï¼Œageæ˜¯Int?ï¼Œscoreæ˜¯Double?</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>?
    <span class="hljs-keyword">var</span> age: <span class="hljs-type">Int</span>?
    <span class="hljs-keyword">var</span> score: <span class="hljs-type">Double</span>?
}

<span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-type">User</span>(name: <span class="hljs-literal">nil</span>, age: <span class="hljs-literal">nil</span>, score: <span class="hljs-number">89.5</span>)

<span class="hljs-comment">// ç”¨SE-0477ç»Ÿä¸€å¤„ç†æ‰€æœ‰å¯é€‰å€¼çš„é»˜è®¤å€¼ï¼Œç±»å‹äº’ä¸å¹²æ‰°</span>
<span class="hljs-keyword">let</span> userInfo <span class="hljs-operator">=</span> <span class="hljs-string">"""
ç”¨æˆ·æ˜µç§°ï¼š<span class="hljs-subst">\(user.name, <span class="hljs-keyword">default</span>: <span class="hljs-string">"åŒ¿åç”¨æˆ·"</span>)</span>
ç”¨æˆ·å¹´é¾„ï¼š<span class="hljs-subst">\(user.age, <span class="hljs-keyword">default</span>: <span class="hljs-string">"æœªå¡«å†™"</span>)</span>
ç”¨æˆ·åˆ†æ•°ï¼š<span class="hljs-subst">\(user.score, <span class="hljs-keyword">default</span>: <span class="hljs-string">"æš‚æ— æ•°æ®"</span>)</span>
"""</span>

<span class="hljs-built_in">print</span>(userInfo)
<span class="hljs-comment">/* è¾“å‡ºç»“æœï¼š
ç”¨æˆ·æ˜µç§°ï¼šåŒ¿åç”¨æˆ·
ç”¨æˆ·å¹´é¾„ï¼šæœªå¡«å†™
ç”¨æˆ·åˆ†æ•°ï¼š89.5
*/</span>
</code></pre>
<p>â€œä½ çœ‹ï¼Œä¸ç®¡æ˜¯ Stringã€Int è¿˜æ˜¯ Double çš„å¯é€‰å€¼ï¼Œéƒ½èƒ½æŒ‰éœ€æ±‚ç»™ä¸åŒç±»å‹çš„é»˜è®¤å€¼ï¼Œå†ä¹Ÿä¸ç”¨â€˜æ‹†ä¸œè¡¥è¥¿â€™äº†ã€‚â€ ç¨‹çµç´ è¯´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cb570487b6e4580bb15125212f48abd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=vQeTDhwdYpWbfPvmI5URNY%2FPYvY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¾¯ä½©è¿è¿ç‚¹å¤´ï¼Œè¾¹è®°ç¬”è®°è¾¹å˜€å’•ï¼šâ€œè¿™æ‹›æ¯”æˆ‘ä¹‹å‰â€˜å…ˆåˆ¤æ–­ nilï¼Œå†è½¬ç±»å‹ï¼Œå†æ‹¼æ¥â€™çš„ç¬¨åŠæ³•ï¼Œæ•ˆç‡é«˜äº†ä¸æ­¢ä¸€ç‚¹ï¼Œè¿˜èƒ½å°‘å†™å¥½å‡ è¡Œä»£ç  â€”â€” æ¯•ç«Ÿå†™ä»£ç å°±åƒåƒåŒ…å­ï¼Œèƒ½ä¸€å£è§£å†³çš„ï¼Œç»ä¸å’¬ç¬¬äºŒå£ï¼â€</p>
<hr/>
<h2 data-id="heading-4">ğŸš¨ 4. ç»†èŠ‚æé†’ï¼šåˆ«è¸© â€œé»˜è®¤å€¼ç±»å‹â€ çš„å°å‘</h2>
<p>ç¨‹çµç´ çªç„¶è¯é”‹ä¸€è½¬ï¼šâ€œä¸è¿‡æœ‰ä¸ªå°ç»†èŠ‚è¦æ³¨æ„ â€”â€” é»˜è®¤å€¼çš„ç±»å‹å¾—æ˜¯â€˜èƒ½è½¬æˆå­—ç¬¦ä¸²â€™çš„ï¼Œæ¯”å¦‚æ•°å­—ã€å¸ƒå°”å€¼ã€å­—ç¬¦ä¸²éƒ½è¡Œï¼Œä½†è¦æ˜¯ä¼ ä¸ª<code>UIView?</code>è¿™ç§â€˜ä¸å¥½è½¬å­—ç¬¦ä¸²â€™çš„ç±»å‹ï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™ã€‚â€</p>
<p>å¥¹ä¸¾äº†ä¸ªåä¾‹ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">var</span> view: <span class="hljs-type">UIView</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>

<span class="hljs-comment">// âŒ ç¼–è¯‘æŠ¥é”™ï¼šUIViewç±»å‹æ— æ³•ç›´æ¥è½¬æˆå­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼ä¹Ÿå¾—æ˜¯â€œå¯å­—ç¬¦ä¸²åŒ–â€çš„</span>

<span class="hljs-comment">// print("View: \(view, default: "No View")")</span>
</code></pre>
<p>â€œå“¦ï¼è¿™å°±åƒé…è¯ä¸èƒ½æ”¾â€˜ä¸èƒ½å…¥å£â€™çš„è¯æï¼Œå¯¹å§ï¼Ÿâ€ ä¾¯ä½©ç«‹é©¬ get åˆ°ï¼Œâ€œå¾—ç¡®ä¿é»˜è®¤å€¼æœ¬èº«èƒ½â€˜å˜æˆå­—ç¬¦ä¸²â€™ï¼Œä¸ç„¶ Swift ä¹Ÿâ€˜è°ƒä¸åŒ€â€™ã€‚â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd54c1d7a97d4a3fb4c90dd97f09dcc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=8uKEbkWwOqJUnvfkotLXap%2FhGtA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç¨‹çµç´ ç¬‘ç€ç‚¹å¤´ï¼šâ€œæ­£æ˜¯è¿™ä¸ªç†ã€‚ä¸è¿‡å¤§éƒ¨åˆ†æ—¥å¸¸å¼€å‘åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯ã€æ—¥å¿—æ‰“å°ï¼Œå¸¸ç”¨ç±»å‹éƒ½èƒ½æ”¯æŒï¼Œè¿™æ‹›å·²ç»èƒ½è§£å†³ä¹æˆä»¥ä¸Šçš„æ’å€¼éš¾é¢˜äº†ã€‚â€</p>
<hr/>
<h2 data-id="heading-5">ğŸ”® ç»“å°¾ï¼šå¤æ‚æ’å€¼ç°æ–°ç–‘ï¼Œç§˜ç±æ®‹é¡µè—ç„æœº</h2>
<p>ä¾¯ä½©å½»åº•æŒæ¡äº† â€œè¡¥ä½ç¥æŠ€â€ï¼Œå¼€å¿ƒåœ°æŠŠå‰©ä¸‹çš„ç³–è‘«èŠ¦åƒå®Œï¼Œè¿˜æƒ³è¯•è¯•æ›´å¤æ‚çš„åœºæ™¯ â€”â€” æ¯”å¦‚åœ¨æ’å€¼é‡ŒåŠ è®¡ç®—ï¼Œåƒ<code>\(user.score.map { $0 * 10 }, default: "æš‚æ— ")</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1127128e6dd54304a8043a394f28d145~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn54aK54yr5L6v5L2p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765678794&amp;x-signature=rhILGmE0PrDD5lqBSN18pS6fxhE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¯åˆšå†™å®Œï¼Œä»–åˆæ„£ä½äº†ï¼šâ€œå“ï¼Ÿè¿™é‡ŒåŠ äº†<code>map</code>å¤„ç†ï¼Œé»˜è®¤å€¼è¿˜èƒ½ç”¨å—ï¼Ÿâ€</p>
<p>ç¨‹çµç´ å‡‘è¿‡æ¥çœ‹äº†çœ‹ï¼ŒæŒ‡äº†æŒ‡ã€ŠSwift æ’å€¼ç§˜ç±ã€‹æœ€åä¸€é¡µçš„æ®‹é¡µï¼šâ€œ<strong>Add Collection conformances for enumerated()</strong>â€</p>
<p>ä¾¯ä½©ç›¯ç€æ®‹é¡µä¸Šæ¨¡ç³Šçš„å­—è¿¹ï¼Œå¥½å¥‡å¿ƒè¢«å‹¾äº†èµ·æ¥ï¼šâ€œéš¾é“è¿˜æœ‰æ›´å‰å®³çš„æ‹›å¼ï¼Ÿä¸‹æ¬¡å’±ä»¬å¯å¾—å¥½å¥½ç ”ç©¶ç ”ç©¶ï¼â€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisï¼ˆ169ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7580288235031248896</link>    <guid>https://juejin.cn/post/7580288235031248896</guid>    <pubDate>2025-12-06T23:06:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580288235031248896" data-draft-id="7580312375372611624" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisï¼ˆ169ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-06T23:06:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisï¼ˆ169ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-06T23:06:03.000Z" title="Sat Dec 06 2025 23:06:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ï¼Œç‰¹åˆ«é€‚åˆäºéœ€è¦åœ¨å¤šå°æœåŠ¡å™¨ä¹‹é—´ä¿æŒæ•°æ®ä¸€è‡´æ€§çš„åœºæ™¯ã€‚Redisæä¾›äº†å¤šç§æœºåˆ¶æ¥å®ç°æ•°æ®åŒæ­¥ï¼ŒåŒ…æ‹¬ä¸»ä»å¤åˆ¶ã€å‘å¸ƒè®¢é˜…å’ŒRedis Streamsç­‰ã€‚</p>
<h3 data-id="heading-0">1. æ•°æ®åŒæ­¥çš„åŸºæœ¬æ¦‚å¿µ</h3>
<p>æ•°æ®åŒæ­¥ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><strong>æ•°æ®æ”¶é›†å’Œå¤„ç†</strong>ï¼šæ¥æ”¶å¹¶å¤„ç†éœ€è¦åŒæ­¥çš„æ•°æ®ã€‚</li>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šå°†å¤„ç†åçš„æ•°æ®å­˜å‚¨åœ¨Redisä¸­ã€‚</li>
<li><strong>æ•°æ®åŒæ­¥æœºåˆ¶</strong>ï¼šåˆ©ç”¨Redisçš„å¤åˆ¶ã€å‘å¸ƒè®¢é˜…æˆ–Streamsç­‰æœºåˆ¶å®ç°æ•°æ®åŒæ­¥ã€‚</li>
<li><strong>æ•°æ®æ¶ˆè´¹</strong>ï¼šä»Redisä¸­è¯»å–å¹¶å¤„ç†åŒæ­¥çš„æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-1">2. ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥</h3>
<h4 data-id="heading-2">2.1 ä½¿ç”¨Redisä¸»ä»å¤åˆ¶</h4>
<p>Redisçš„ä¸»ä»å¤åˆ¶å¯ä»¥å®ç°æ•°æ®åœ¨å¤šä¸ªRediså®ä¾‹ä¹‹é—´çš„åŒæ­¥ã€‚é…ç½®ä¸€ä¸ªRediså®ä¾‹ä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–å®ä¾‹ä¸ºä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹ä¼šè‡ªåŠ¨åŒæ­¥ä¸»èŠ‚ç‚¹çš„æ•°æ®ã€‚</p>
<h5 data-id="heading-3">é…ç½®ä¸»ä»å¤åˆ¶</h5>
<ol>
<li><strong>é…ç½®ä¸»èŠ‚ç‚¹</strong>ï¼šä¸»èŠ‚ç‚¹ä¸éœ€è¦é¢å¤–é…ç½®ï¼Œå¯åŠ¨å³å¯ã€‚</li>
<li><strong>é…ç½®ä»èŠ‚ç‚¹</strong>ï¼šåœ¨ä»èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š
<pre><code class="hljs language-plaintext" lang="plaintext">replicaof &lt;master-ip&gt; &lt;master-port&gt;
</code></pre>
</li>
</ol>
<p>å¯åŠ¨Rediså®ä¾‹åï¼Œä»èŠ‚ç‚¹ä¼šè‡ªåŠ¨åŒæ­¥ä¸»èŠ‚ç‚¹çš„æ•°æ®ã€‚</p>
<h4 data-id="heading-4">2.2 ä½¿ç”¨Rediså‘å¸ƒè®¢é˜…</h4>
<p>Redisçš„å‘å¸ƒè®¢é˜…ï¼ˆPub/Subï¼‰æœºåˆ¶æ˜¯ä¸€ç§æ¶ˆæ¯ä¼ é€’æ¨¡å‹ï¼Œå¯ä»¥åœ¨å¤šä¸ªå®¢æˆ·ç«¯ä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚å‘å¸ƒè€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°ç‰¹å®šé¢‘é“ï¼Œè®¢é˜…è€…æ¥æ”¶è¯¥é¢‘é“çš„æ¶ˆæ¯ã€‚</p>
<h5 data-id="heading-5">ç¤ºä¾‹ï¼šä½¿ç”¨å‘å¸ƒè®¢é˜…è¿›è¡Œæ•°æ®åŒæ­¥</h5>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Redisçš„å‘å¸ƒè®¢é˜…æœºåˆ¶æ¥å®ç°æ•°æ®åŒæ­¥ã€‚</p>
<h6 data-id="heading-6">å‘å¸ƒè€…ï¼ˆProducerï¼‰</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisPublisher</span> {
    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CHANNEL_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_sync_channel"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisPublisher</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishData</span><span class="hljs-params">(String data)</span> {
        jedis.publish(CHANNEL_NAME, data);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisPublisher</span> <span class="hljs-variable">publisher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisPublisher</span>();
        publisher.publishData(<span class="hljs-string">"Hello, Redis!"</span>);
        publisher.close();
    }
}
</code></pre>
<h6 data-id="heading-7">è®¢é˜…è€…ï¼ˆSubscriberï¼‰</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPubSub;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisSubscriber</span> {
    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CHANNEL_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_sync_channel"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisSubscriber</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">subscribe</span><span class="hljs-params">()</span> {
        jedis.subscribe(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPubSub</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String channel, String message)</span> {
                System.out.println(<span class="hljs-string">"Received message: "</span> + message);
            }
        }, CHANNEL_NAME);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisSubscriber</span> <span class="hljs-variable">subscriber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisSubscriber</span>();
        subscriber.subscribe();
        subscriber.close();
    }
}
</code></pre>
<h4 data-id="heading-8">2.3 ä½¿ç”¨Redis Streams</h4>
<p>Redis Streamsæ˜¯ä¸€ç§é«˜çº§çš„æ•°æ®ç»“æ„ï¼Œé€‚ç”¨äºæ—¥å¿—å’Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ï¼Œå¯ä»¥å®ç°æ›´å¤æ‚çš„æ•°æ®åŒæ­¥éœ€æ±‚ã€‚</p>
<h5 data-id="heading-9">ç¤ºä¾‹ï¼šä½¿ç”¨Redis Streamsè¿›è¡Œæ•°æ®åŒæ­¥</h5>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Redis Streamsæ¥å®ç°æ•°æ®åŒæ­¥ã€‚</p>
<h6 data-id="heading-10">æ•°æ®ç”Ÿäº§è€…ï¼ˆProducerï¼‰</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.StreamEntryID;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisStreamProducer</span> {
    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">STREAM_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_stream"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisStreamProducer</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishData</span><span class="hljs-params">(String data)</span> {
        Map&lt;String, String&gt; message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        message.put(<span class="hljs-string">"data"</span>, data);
        jedis.xadd(STREAM_NAME, StreamEntryID.NEW_ENTRY, message);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisStreamProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisStreamProducer</span>();
        producer.publishData(<span class="hljs-string">"Hello, Redis Streams!"</span>);
        producer.close();
    }
}
</code></pre>
<h6 data-id="heading-11">æ•°æ®æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.StreamEntry;
<span class="hljs-keyword">import</span> redis.clients.jedis.StreamEntryID;
<span class="hljs-keyword">import</span> redis.clients.jedis.StreamPendingEntry;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisStreamConsumer</span> {
    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">STREAM_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_stream"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONSUMER_GROUP</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_group"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONSUMER_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"consumer_1"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisStreamConsumer</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);
        createConsumerGroup();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createConsumerGroup</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            jedis.xgroupCreate(STREAM_NAME, CONSUMER_GROUP, StreamEntryID.LAST_ENTRY, <span class="hljs-literal">true</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// Consumer group already exists</span>
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consumeData</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            List&lt;StreamEntry&gt; entries = jedis.xreadGroup(CONSUMER_GROUP, CONSUMER_NAME, COUNT, <span class="hljs-number">0</span>, <span class="hljs-literal">false</span>, STREAM_NAME, StreamEntryID.UNRECEIVED_ENTRY);
            <span class="hljs-keyword">for</span> (StreamEntry entry : entries) {
                Map&lt;String, String&gt; message = entry.getFields();
                processMessage(message);
                jedis.xack(STREAM_NAME, CONSUMER_GROUP, entry.getID());
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processMessage</span><span class="hljs-params">(Map&lt;String, String&gt; message)</span> {
        System.out.println(<span class="hljs-string">"Received message: "</span> + message.get(<span class="hljs-string">"data"</span>));
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisStreamConsumer</span> <span class="hljs-variable">consumer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisStreamConsumer</span>();
        consumer.consumeData();
        consumer.close();
    }
}
</code></pre>
<h3 data-id="heading-12">3. ç»¼åˆç¤ºä¾‹ï¼šæ•°æ®åŒæ­¥ç³»ç»Ÿ</h3>
<p>å°†ä¸Šè¿°å„éƒ¨åˆ†ç»“åˆèµ·æ¥ï¼Œå®ç°ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒæ­¥ç³»ç»Ÿã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPubSub;
<span class="hljs-keyword">import</span> redis.clients.jedis.StreamEntryID;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisDataSyncSystem</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CHANNEL_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_sync_channel"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">STREAM_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_stream"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONSUMER_GROUP</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data_group"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONSUMER_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"consumer_1"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. å‘å¸ƒè®¢é˜…æœºåˆ¶</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(RedisDataSyncSystem::startSubscriber).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// ç¡®ä¿è®¢é˜…è€…å·²å¯åŠ¨</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
            startPublisher();
        }).start();

        <span class="hljs-comment">// 2. Redis Streamsæœºåˆ¶</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(RedisDataSyncSystem::startStreamConsumer).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// ç¡®ä¿æ¶ˆè´¹è€…å·²å¯åŠ¨</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
            startStreamProducer();
        }).start();
    }

    <span class="hljs-comment">// å‘å¸ƒè€…</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startPublisher</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>)) {
            jedis.publish(CHANNEL_NAME, <span class="hljs-string">"Hello, Redis Pub/Sub!"</span>);
        }
    }

    <span class="hljs-comment">// è®¢é˜…è€…</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startSubscriber</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>)) {
            jedis.subscribe(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPubSub</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String channel, String message)</span> {
                    System.out.println(<span class="hljs-string">"Received message: "</span> + message);
                }
            }, CHANNEL_NAME);
        }
    }

    <span class="hljs-comment">// æ•°æ®ç”Ÿäº§è€…ï¼ˆStreamsï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startStreamProducer</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>)) {
            Map&lt;String, String&gt; message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            message.put(<span class="hljs-string">"data"</span>, <span class="hljs-string">"Hello, Redis Streams!"</span>);
            jedis.xadd(STREAM_NAME, StreamEntryID.NEW_ENTRY, message);
        }
    }

    <span class="hljs-comment">// æ•°æ®æ¶ˆè´¹è€…ï¼ˆStreamsï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startStreamConsumer</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>)) {
            createConsumerGroup(jedis);
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                List&lt;StreamEntry&gt; entries = jedis.xreadGroup(CONSUMER_GROUP, CONSUMER_NAME, COUNT, <span class="hljs-number">0</span>, <span class="hljs-literal">false</span>, STREAM_NAME, StreamEntryID.UNRECEIVED_ENTRY);
                <span class="hljs-keyword">for</span> (StreamEntry entry : entries) {
                    Map&lt;String, String&gt; message = entry.getFields();
                    processMessage(message);
                    jedis.xack(STREAM_NAME, CONSUMER_GROUP, entry.getID());
                }
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createConsumerGroup</span><span class="hljs-params">(Jedis jedis)</span> {
        <span class="hljs-keyword">try</span> {
            jedis.xgroupCreate(STREAM_NAME, CONSUMER_GROUP, StreamEntryID.LAST_ENTRY, <span class="hljs-literal">true</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// Consumer group already exists</span>
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processMessage</span><span class="hljs-params">(Map&lt;String, String&gt; message)</span> {
        System.out.println(<span class="hljs-string">"Received stream message: "</span> + message.get(<span class="hljs-string">"data"</span>));
    }
}
</code></pre>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>é€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rediså®ç°æ•°æ®åŒæ­¥ï¼ŒåŒ…æ‹¬ä½¿ç”¨Redisçš„ä¸»ä»å¤åˆ¶æœºåˆ¶ã€å‘å¸ƒè®¢é˜…æœºåˆ¶å’ŒRedis Streamsæœºåˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è½¯ä»¶å·¥ç¨‹å¸ˆå¿…é¡»è¦æŒæ¡çš„æ³³é“å›¾]]></title>    <link>https://juejin.cn/post/7580423629164068916</link>    <guid>https://juejin.cn/post/7580423629164068916</guid>    <pubDate>2025-12-07T06:07:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580423629164068916" data-draft-id="7580592190020239394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è½¯ä»¶å·¥ç¨‹å¸ˆå¿…é¡»è¦æŒæ¡çš„æ³³é“å›¾"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T06:07:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uzong"/> <meta itemprop="url" content="https://juejin.cn/user/372082495985181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è½¯ä»¶å·¥ç¨‹å¸ˆå¿…é¡»è¦æŒæ¡çš„æ³³é“å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/372082495985181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uzong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T06:07:26.000Z" title="Sun Dec 07 2025 06:07:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼šé¢æ±¤æ”¾ç› / uzong</p>
</blockquote>
<p>åœ¨è½¯ä»¶å¼€å‘çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä¹ æƒ¯ç”¨ä»£ç è¡¨è¾¾é€»è¾‘ï¼Œä½†å½“ç³»ç»Ÿæ¶‰åŠå¤šä¸ªè§’è‰²ã€å¤šä¸ªæœåŠ¡ã€ç”šè‡³è·¨å›¢é˜Ÿåä½œæ—¶ï¼Œå…‰é ä»£ç æ³¨é‡Šæˆ–å£å¤´æ²Ÿé€šï¼Œå¾€å¾€ä¸å¤Ÿã€‚è¿™æ—¶å€™ï¼Œä¸€å¼ æ¸…æ™°çš„æµç¨‹å›¾ï¼Œèƒœè¿‡åƒè¡Œæ–‡æ¡£ã€‚</p>
<p><strong>æ³³é“å›¾</strong> ï¼šå®ƒå¯èƒ½ä¸åƒ UML é‚£æ ·â€œé«˜å¤§ä¸Šâ€ï¼Œä¹Ÿä¸å¦‚æ¶æ„å›¾é‚£æ ·å®è§‚ï¼Œä½†åœ¨æ¢³ç†ä¸šåŠ¡æµç¨‹ã€å˜æ¸…è´£ä»»è¾¹ç•Œã€æ’æŸ¥ç³»ç»Ÿç“¶é¢ˆæ—¶ï¼Œå®ƒçœŸçš„éå¸¸å®ç”¨ã€‚</p>
<h2 data-id="heading-0">1. ä»€ä¹ˆæ˜¯æ³³é“å›¾</h2>
<p>æ³³é“å›¾çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼š<strong>æŠŠæµç¨‹ä¸­çš„æ¯ä¸ªæ­¥éª¤ï¼ŒæŒ‰æ‰§è¡Œè€…ï¼ˆäººã€ç³»ç»Ÿã€æ¨¡å—ï¼‰åˆ†ç»„æ’åˆ—ï¼Œå°±åƒæ¸¸æ³³æ± é‡Œçš„æ³³é“ä¸€æ ·ï¼Œå„èµ°å„é“ï¼Œäº’ä¸å¹²æ‰°åˆå½¼æ­¤å…³è”ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0827b245902848f0bc23a543804c4444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=ehyaawiQyCeygsgaf2p%2BvefSHwo%3D" alt="" loading="lazy"/></p>
<p><strong>æ¯ä¸€åˆ—å°±æ˜¯ä¸€ä¸ªâ€œæ³³é“â€ï¼Œä»£è¡¨ä¸€ä¸ªè´£ä»»ä¸»ä½“ã€‚æµç¨‹ä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹æµåŠ¨ï¼Œè°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆï¼Œä¸€ç›®äº†ç„¶</strong></p>
<hr/>
<p>ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼š<strong>è°å¹²äº†ä»€ä¹ˆï¼Œè°ä¾èµ–è°ï¼Œè¾¹ç•Œæ˜¯ä»€ä¹ˆã€‚</strong></p>
<p><strong>ä¸æµç¨‹çš„å·®å¼‚ç‚¹ï¼š</strong></p>
<ul>
<li>æµç¨‹å›¾èšç„¦ï¼šâ€œæ­¥éª¤é¡ºåºâ€ï¼Œä¾§é‡ â€œå…ˆåšä»€ä¹ˆã€å†åšä»€ä¹ˆâ€ï¼Œé€‚åˆæ¢³ç†çº¿æ€§ä¸šåŠ¡æµç¨‹ï¼›</li>
<li>æ³³é“å›¾èšç„¦ï¼š â€œæµè½¬é€šé“â€ï¼Œä¾§é‡ â€œä»€ä¹ˆä¸œè¥¿åœ¨ä»€ä¹ˆçº¦æŸä¸‹é€šè¿‡ä»€ä¹ˆè·¯å¾„æµè½¬â€ï¼Œé€‚åˆæ‹†è§£å¤æ‚ã€å¤šè·¯å¾„ã€æœ‰è§„åˆ™çº¦æŸçš„æµè½¬åœºæ™¯ï¼ˆå¦‚åˆ†å¸ƒå¼ç³»ç»Ÿæ•°æ®åŒæ­¥ã€ä¾›åº”é“¾ç‰©æ–™æµè½¬ã€å¾®æœåŠ¡è¯·æ±‚é“¾è·¯ç­‰ï¼‰</li>
</ul>
<h2 data-id="heading-1">2. æ³³é“å›¾åˆ†ç±»</h2>
<h3 data-id="heading-2">2.1. å‚ç›´æ³³é“å›¾</h3>
<p>å‚ç›´æ³³é“å›¾é‡‡å–ä¸Šä¸‹å¸ƒå±€ç»“æ„ï¼Œâ€Œä¸»è¦å¼ºè°ƒèŒèƒ½ç¾¤ä½“ã€‚<strong>è¿™ç§å¸ƒå±€æ–¹å¼æ›´é€‚åˆäºå±•ç¤ºè·¨èŒèƒ½ä»»åŠ¡å’Œæµç¨‹ä¸­ï¼Œâ€Œå„èŒèƒ½éƒ¨é—¨æˆ–è§’è‰²ä¹‹é—´çš„å‚ç›´å…³ç³»å’ŒèŒèƒ½åˆ†å·¥ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0f9a47ca0034d288c5f9228da4b2bf9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=2yszR61tULesrRNoYp92nDHDRBA%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">2.2. æ°´å¹³æ³³é“å›¾</h3>
<p>æ°´å¹³æ³³é“å›¾åˆ™é‡‡ç”¨å·¦å³å¸ƒå±€ç»“æ„ï¼Œâ€Œé‡ç‚¹åœ¨äºäº‹ä»¶è¿›ç¨‹çš„å±•ç¤ºã€‚<strong>è¿™ç§å¸ƒå±€æ–¹å¼æ›´é€‚åˆäºå¼ºè°ƒäº‹ä»¶æˆ–è¿‡ç¨‹çš„æ°´å¹³æµåŠ¨ï¼Œâ€Œä»¥åŠä¸åŒé˜¶æ®µæˆ–éƒ¨é—¨åœ¨æµç¨‹ä¸­çš„æ°´å¹³å‚ä¸</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3c39b7b10344cbf996f88d95d7abc6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=AEu6jfw8Hka8GFFoLA3VyGYPDeY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">3. æ³³é“å›¾ç»„æˆå…ƒç´ </h2>
<p><strong>æ³³æ± ï¼š</strong> æ³³æ± æ˜¯æ³³é“å›¾çš„å¤–éƒ¨æ¡†æ¶ï¼Œæ³³é“ã€æµç¨‹éƒ½åŒ…å«äºæ³³æ± å†…ã€‚</p>
<p><strong>æ³³é“ï¼š</strong> æ³³æ± é‡Œå¯ä»¥åˆ›å»ºå¤šä¸ªæ³³é“ã€‚</p>
<p><strong>æµç¨‹ï¼š</strong> å®é™…çš„ä¸šåŠ¡æµç¨‹ã€‚</p>
<p><strong>éƒ¨é—¨ï¼š</strong> é€šè¿‡éƒ¨é—¨æˆ–è€…è´£ä»»æ¥åŒºåˆ†ï¼Œæ˜ç¡®æ¯ä¸ªéƒ¨é—¨/äºº/ä¿¡æ¯ç³»ç»Ÿè´Ÿè´£å®Œæˆçš„ä»»åŠ¡ç¯èŠ‚ã€‚</p>
<p><strong>é˜¶æ®µï¼š</strong> é€šè¿‡ä»»åŠ¡é˜¶æ®µæ¥åŒºåˆ†ï¼Œæ˜ç¡®æ¯ä¸ªé˜¶æ®µéœ€è¦å¤„ç†çš„ä»»åŠ¡ç¯èŠ‚ã€‚</p>
<h2 data-id="heading-5">4. æ³³é“å›¾åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-6">4.1. é¡¹ç›®ç®¡ç†</h3>
<p>å±•ç¤ºé¡¹ç›®ä»å¯åŠ¨åˆ°å®Œæˆçš„å„ä¸ªé˜¶æ®µï¼Œæ˜ç¡®æ¯ä¸ªå›¢é˜Ÿæˆ–æˆå‘˜åœ¨é¡¹ç›®ä¸­çš„è§’è‰²å’ŒèŒè´£ï¼Œä¾¿äºè¿›è¡Œé¡¹ç›®ç®¡ç†å’Œç›‘æ§ï¼ŒåŒæ—¶ä¿ƒè¿›å›¢é˜Ÿåä½œå’Œæ²Ÿé€š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc65b6c24346448cb010aed90c2eb58d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=cwoi3aeghOLbFMwy7aGWQm0NWu8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">4.2. ä¸šåŠ¡æµç¨‹åˆ†æ</h3>
<p>å±•ç¤ºä¸šåŠ¡æµç¨‹çš„å„ä¸ªç¯èŠ‚å’Œæ¶‰åŠçš„ä¸åŒéƒ¨é—¨æˆ–èŒèƒ½ã€‚é€šè¿‡åˆ†ææ³³é“å›¾ï¼Œå¯ä»¥å‘ç°ä¸šåŠ¡æµç¨‹ä¸­çš„ç“¶é¢ˆã€å†—ä½™ç¯èŠ‚æˆ–ä¸åˆç†ä¹‹å¤„ï¼Œè¿›è€Œè¿›è¡Œæµç¨‹ä¼˜åŒ–å’Œæ”¹è¿›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8642f37ba1a240cdb2ecc3dd8b7af30b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=P7CAOtBGnpXc%2Bc5lPBuzQpqcnW4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">4.3. ç³»ç»Ÿè®¾è®¡</h3>
<p>å±•ç¤ºç³»ç»Ÿçš„æ•´ä½“æ¶æ„å’Œå„ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œæè¿°ç³»ç»Ÿçš„å·¥ä½œæµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®çš„è¾“å…¥ã€å¤„ç†ã€è¾“å‡ºç­‰å„ä¸ªç¯èŠ‚ï¼Œæœ‰åŠ©äºç³»ç»Ÿå¼€å‘äººå‘˜æ›´å¥½åœ°ç†è§£ç³»ç»Ÿçš„åŠŸèƒ½å’Œéœ€æ±‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34f9dc1384b4420fbd705fa0790433ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=BxEweXcfCwkeBDH6bZ33YxP7GOQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">5. æ›´å¤šå‚è€ƒæ¨¡æ¿</h2>
<p>æ•…éšœå¤„ç†å¤šç»´æ³³é“å›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4977f1e8c3fa499aa4090092982fb588~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=9giq30JmKdONpCguzsEr7EyrSxU%3D" alt="" loading="lazy"/></p>
<p>èµ„æºæ‰©å®¹æ³³é“å›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a743deb98ff48189f0423710ca4e14f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765692446&amp;x-signature=DMLSa3zzgplTpEP208yCk25FIBY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">6. æœ€å</h2>
<p>æˆ‘åˆšå·¥ä½œæ—¶ï¼Œçœ‹åˆ°å¯¼å¸ˆæŠ›å‡ºä¸€ä»½ç²¾è‡´çš„æ³³é“å›¾ï¼ŒæŠŠä¸€å›¢ä¹±éº»çš„é—®é¢˜è®²å¾—é€äº®ï¼Œå¿ƒé‡Œç‰¹åˆ«ä½©æœã€‚ç›´åˆ°è‡ªå·±å¤šå¹´åç”¨ä¸Šæ‰çœŸæ­£ä½“ä¼šï¼šåœ¨é¢å¯¹è·¨éƒ¨é—¨åä½œã€å¤æ‚æ•…éšœæ’æŸ¥ã€å…³é”®æµç¨‹è®¾è®¡æ—¶ï¼Œæå‡ºè¿™ä¹ˆä¸€å¼ å›¾ï¼Œå¾€å¾€å°±æ˜¯é«˜æ•ˆæ²Ÿé€šçš„å¼€å§‹ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å¸¸é™·å…¥â€œåªè¦ä»£ç è·‘å¾—é€šå°±è¡Œâ€çš„æ€ç»´æƒ¯æ€§ã€‚ä½†è½¯ä»¶ä¸ä»…æ˜¯æœºå™¨æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œæ›´æ˜¯äººä¸äººåä½œçš„åª’ä»‹ã€‚æ³³é“å›¾è¿™æ ·çš„å·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨<strong>é™ä½è®¤çŸ¥æˆæœ¬</strong>â€”â€”è®©å¤æ‚çš„äº‹æƒ…å˜å¾—å¯æ²Ÿé€šã€å¯éªŒè¯ã€å¯è¿­ä»£ã€‚ å…¶å®æ³³é“å›¾çš„æ ¸å¿ƒä¸æ˜¯â€œç”»å›¾â€ï¼Œè€Œæ˜¯â€œæ¢³ç†æµç¨‹ã€æ˜ç¡®æƒè´£â€ã€‚</p>
<p>åœ¨è·¨éƒ¨é—¨ã€ååŒéœ€æ±‚ã€æ•…éšœåˆ†æç­‰å…³é”®åœºæ™¯ä½¿ç”¨æ³³é“å›¾æ˜¯éå¸¸åˆé€‚ï¼Œå¹¶ä¸”ä¹Ÿèƒ½æŠŠé—®é¢˜è®²æ¸…æ¥šã€‚<strong>æŠ€æœ¯ä¸–ç•Œå……æ»¡äº†æŠ½è±¡å’Œå¤æ‚æ€§ï¼Œè€Œä¼˜ç§€å·¥ç¨‹å¸ˆçš„èƒ½åŠ›ä¹‹ä¸€ï¼Œå°±æ˜¯åˆ›å»ºåˆé€‚çš„å¯è§†åŒ–å·¥å…·ï¼Œè®©å¤æ‚é—®é¢˜å˜å¾—ç®€å•å¯è§</strong>ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ä¸­çš„å¤§éƒ¨åˆ†å›¾ç‰‡æ¥æºäº ProcessOnï¼ŒProcessOn æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„ç”»å›¾è½¯ä»¶ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œç•Œé¢ä¼˜ç¾ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¤– AI æ—¶ä»£ï¼Œå¤§æ¨¡å‹ä¸ç³»ç»Ÿçš„å¯èåˆåœºæ™¯æ¶æ„çŒœæƒ³]]></title>    <link>https://juejin.cn/post/7580374090364796966</link>    <guid>https://juejin.cn/post/7580374090364796966</guid>    <pubDate>2025-12-07T00:02:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580374090364796966" data-draft-id="7580378958072397834" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¤– AI æ—¶ä»£ï¼Œå¤§æ¨¡å‹ä¸ç³»ç»Ÿçš„å¯èåˆåœºæ™¯æ¶æ„çŒœæƒ³"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯æ¡†æ¶,æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2025-12-07T00:02:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¤– AI æ—¶ä»£ï¼Œå¤§æ¨¡å‹ä¸ç³»ç»Ÿçš„å¯èåˆåœºæ™¯æ¶æ„çŒœæƒ³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T00:02:37.000Z" title="Sun Dec 07 2025 00:02:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒŒ ä¸€ã€å‰è¨€ï¼šå¤§æ¨¡å‹ä¸å†æ˜¯â€œå•æœºç©å®¶â€</h2>
<p>æˆ‘ä»¬æ›¾ä»¥ä¸ºï¼Œå¤§æ¨¡å‹çš„å¥‡è¿¹åªå‘ç”Ÿåœ¨GPUæ•°æ®ä¸­å¿ƒçš„é»‘ç›’é‡Œã€‚<br/>
ä½†AIæ­£åœ¨ç»å†ä¸€æ¬¡â€œç³»ç»Ÿå­¦è¿å¾™â€â€”â€”å®ƒä¸å†å­¤ç«‹ï¼Œè€Œæ˜¯è¿›å…¥æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ã€ç½‘ç»œã€ç‰©è”ç½‘ä¹ƒè‡³æµè§ˆå™¨ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼š</p>
<ul>
<li>æ“ä½œç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦å™¨ä¼šâ€œé¢„æµ‹ç”¨æˆ·æ„å›¾â€ï¼›</li>
<li>ç½‘ç»œåè®®æ ˆæ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼˜åŒ–æµé‡è·¯å¾„ï¼›</li>
<li>æ•°æ®åº“èƒ½æ ¹æ®é—®é¢˜è‡ªåŠ¨ç”ŸæˆSQLç”šè‡³é€»è¾‘æ¨ç†æ ‘ï¼›</li>
<li>ç»ˆç«¯æµè§ˆå™¨è‡ªå·±å†³å®šä½•æ—¶å‹ç¼©ã€ç¼“å­˜æˆ–ç”Ÿæˆå†…å®¹ã€‚</li>
</ul>
<p>è¿™ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯<strong>å¤§æ¨¡å‹ä¸ç³»ç»Ÿçš„æ·±åº¦å¯èåˆæ¶æ„</strong>ã€‚<br/>
ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>AIä¸æ˜¯å¤–æŒ‚ï¼Œè€Œæ˜¯å†…æ ¸ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">âš™ï¸ äºŒã€å¤§æ¨¡å‹ + ç³»ç»Ÿï¼šä»å¹¶è¡Œåˆ°å…±ç”Ÿ</h2>
<p>åœ¨ä¼ ç»Ÿç³»ç»Ÿè®¾è®¡ä¸­ï¼Œæˆ‘ä»¬è®²ç©¶çš„æ˜¯ï¼š</p>
<blockquote>
<p>æ¨¡å—åˆ†å±‚ã€èŒè´£éš”ç¦»ã€é€»è¾‘ç¡®å®šã€‚</p>
</blockquote>
<p>è€Œå¤§æ¨¡å‹çš„é€»è¾‘æ˜¯ï¼š</p>
<blockquote>
<p>æ¨¡ç³Šæ¨ç†ã€è¯­ä¹‰ç†è§£ã€ä¸Šä¸‹æ–‡é©±åŠ¨ã€‚</p>
</blockquote>
<p>äºŒè€…åƒä¸€å¯¹æ€§æ ¼è¿¥å¼‚çš„å®¤å‹ï¼š<br/>
ç³»ç»Ÿæ˜¯ä¸¥è°¨çš„æœºæ¢°å·¥ç¨‹å¸ˆï¼Œè€Œæ¨¡å‹æ˜¯çŠ€åˆ©çš„è‰ºæœ¯å®¶ã€‚<br/>
ä½†å½“ä»–ä»¬å­¦ä¼šäº’ç›¸å€¾å¬ï¼Œå°±èƒ½æ„é€ å‡ºä»¤äººæƒŠå¹çš„ã€Œå…±ç”Ÿç³»ç»Ÿã€â€”â€”AIæˆä¸ºç³»ç»Ÿçš„â€œè®¤çŸ¥ä¸­æ¢â€ï¼Œç³»ç»Ÿæˆä¸ºAIçš„â€œç‰©è´¨è½½ä½“â€ã€‚</p>
<hr/>
<h2 data-id="heading-2">ğŸ§© ä¸‰ã€å…¸å‹èåˆåœºæ™¯è®¾æƒ³</h2>









































<table><thead><tr><th>åœºæ™¯</th><th>ç³»ç»Ÿå±‚è§’è‰²</th><th>å¤§æ¨¡å‹è§’è‰²</th><th>é¢„æœŸæ•ˆæœ</th></tr></thead><tbody><tr><td>ğŸ§  æ™ºèƒ½æ“ä½œç³»ç»Ÿ</td><td>è°ƒåº¦ã€é©±åŠ¨ã€å®‰å…¨ç®¡ç†</td><td>ç”¨æˆ·æ„å›¾é¢„æµ‹ã€ä»»åŠ¡ä¸Šä¸‹æ–‡ç†è§£</td><td>â€œä¼šæ€è€ƒâ€çš„ä»»åŠ¡ç®¡ç†</td></tr><tr><td>ğŸ—‚ï¸ æ•°æ®åº“ç³»ç»Ÿ</td><td>å­˜å‚¨ä¸ç´¢å¼•ä¼˜åŒ–</td><td>è¯­ä¹‰æŸ¥è¯¢ç”Ÿæˆã€æ¨¡å¼è¯†åˆ«</td><td>è‡ªä¼˜åŒ–çš„æ•°æ®åº“</td></tr><tr><td>â˜ï¸ äº‘åŸç”ŸåŸºç¡€è®¾æ–½</td><td>æœåŠ¡ç¼–æ’ã€èµ„æºåˆ†é…</td><td>å·¥ä½œè´Ÿè½½é¢„æµ‹ã€å¼‚å¸¸æ£€æµ‹</td><td>è‡ªåŠ¨å¼¹æ€§ä¼¸ç¼©ä¸æ™ºèƒ½è‡ªæ²»</td></tr><tr><td>ğŸ•¸ï¸ Web å‰ç«¯</td><td>æ¸²æŸ“ä¸äº¤äº’æ§åˆ¶</td><td>æ–‡æœ¬ã€è§†è§‰ã€UI è‡ªç”Ÿæˆ</td><td>â€œå¯æ„ŸçŸ¥â€çš„åŠ¨æ€ç•Œé¢</td></tr><tr><td>ğŸ¤– IoT / è¾¹ç¼˜ç³»ç»Ÿ</td><td>ä½åŠŸè€—è®¾å¤‡æ§åˆ¶</td><td>æ¨¡å‹å‰ªæã€è‡ªé€‚åº”å­¦ä¹ </td><td>è¾¹ç¼˜ç«¯æ™ºèƒ½è¿›åŒ–</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-3">ğŸš€ å››ã€æ¶æ„çŒœæƒ³ï¼šå¤§æ¨¡å‹-ç³»ç»Ÿèåˆçš„æœªæ¥å½¢æ€</h2>
<p>è®©æˆ‘ä»¬å°è¯•ç”»å‡ºè¿™ç§æœªæ¥æ¶æ„çš„é€»è¾‘å±‚æ¬¡ï¼Œç”¨æ€æƒ³çš„ASCIIçº¿æ¡æ‹¼ä¸€ä¸ªç®€åŒ–ç‰ˆğŸ‘‡</p>
<pre><code class="hljs language-css" lang="css">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ç”¨æˆ·äº¤äº’å±‚          â•‘ â† è‡ªç„¶è¯­è¨€ / å¤šæ¨¡æ€æ¥å£
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘      AIGC åº”ç”¨ååŒå±‚        â•‘ â† Promptä»£ç† / å†…å®¹è°ƒåº¦
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘   å¤§æ¨¡å‹æœåŠ¡ä¸è®¤çŸ¥å†…æ ¸å±‚    â•‘ â† å¤šæ¨¡å‹åä½œ / çŸ¥è¯†å›¾è°±æ¥å£
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘      ç³»ç»Ÿèåˆé€‚é…å±‚          â•‘ â† API Hook / <span class="hljs-selector-tag">I</span>/O Semantic Adapter
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘   æ“ä½œç³»ç»Ÿä¸åº•å±‚èµ„æºå±‚       â•‘ â† CPU/GPUè°ƒåº¦ / å†…å­˜ä¸Šä¸‹æ–‡å¢å¼º
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<p>ğŸ¯ <strong>å…³é”®è¯è§£é‡Šï¼š</strong></p>
<ul>
<li><em>è®¤çŸ¥å†…æ ¸å±‚</em>ï¼šè´Ÿè´£è¯­è¨€æ¨ç†ã€ä¸–ç•Œå»ºæ¨¡ä¸ç­–ç•¥ç”Ÿæˆã€‚</li>
<li><em>é€‚é…å±‚</em>ï¼šæ˜¯AIä¸ç³»ç»Ÿé€šä¿¡çš„æ¡¥æ¢ï¼Œæ¯”å¦‚AI Hook APIã€‚</li>
<li><em>ååŒå±‚</em>ï¼šè°ƒåº¦å¤šä¸ªAI Agentåä½œï¼Œä¾‹å¦‚å†…å®¹ç”Ÿæˆã€æ¨ç†æœåŠ¡ã€ç”¨æˆ·æ„å›¾è§£æã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">ğŸ’¡ äº”ã€èåˆçš„å…³é”®æœºåˆ¶</h2>
<ol>
<li>
<p><strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼ˆContext Injectionï¼‰</strong><br/>
ç³»ç»Ÿé€šè¿‡å…±äº«è¿è¡Œæ€ä¿¡æ¯ï¼ˆCPUè´Ÿè½½ã€ç½‘ç»œå»¶è¿Ÿã€ç”¨æˆ·äº¤äº’ï¼‰ä¾›æ¨¡å‹æ¨ç†ï¼Œä½¿AIå†³ç­–â€œæœ‰åœ°æ°”â€ã€‚</p>
</li>
<li>
<p><strong>è¯­ä¹‰ä¸­é—´ä»¶ï¼ˆSemantic Middlewareï¼‰</strong><br/>
å¼•å…¥è¯­è¨€å±‚APIï¼Œå°†ç³»ç»Ÿè°ƒç”¨å°è£…ä¸ºè‡ªç„¶è¯­è¨€æ„å›¾æ¥å£ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ğŸ§  è¯­ä¹‰è°ƒç”¨ç¤ºä¾‹ï¼šAI è®©æ“ä½œç³»ç»Ÿåšäº‹</span>
<span class="hljs-keyword">await</span> OS.semanticCall(<span class="hljs-string">"ä¼˜åŒ–æœ¬åœ°æ–‡ä»¶ç´¢å¼•"</span>, { priority: <span class="hljs-string">"low"</span> });
</code></pre>
</li>
<li>
<p><strong>æ¨¡å‹ç³»ç»ŸååŒè°ƒåº¦ï¼ˆCo-schedulingï¼‰</strong><br/>
æ¨¡å‹ä»»åŠ¡æˆä¸ºç³»ç»Ÿè¿›ç¨‹çš„ä¸€ç­‰å…¬æ°‘ï¼Œç”±æ“ä½œç³»ç»Ÿåè°ƒèµ„æºï¼Œè€Œéç”±å¤–å±‚ç¨‹åºä¸´æ—¶è°ƒç”¨ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®â€”æ¨¡å‹å¾ªç¯ï¼ˆFeedback Loopï¼‰</strong><br/>
ç³»ç»Ÿé‡‡é›†è¿è¡Œæ•°æ® â†’ æ¨¡å‹ä¼˜åŒ–ç­–ç•¥ â†’ å†è°ƒæ•´ç³»ç»Ÿè¡Œä¸ºï¼Œå¦‚åŒè‡ªå­¦ä¹ ç”Ÿæ€ä½“ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-5">ğŸ§± å…­ã€ä¸€ä¸ªç®€åŒ–çš„èåˆåŸå‹â€”â€”â€œæ™ºèƒ½ç³»ç»Ÿè°ƒåº¦å™¨â€</h2>
<p>è®©æˆ‘ä»¬æ¥æ®µå¹½é»˜çš„ä¼ªä»£ç ï¼Œè®¾æƒ³ä¸€ä¸ªç³»ç»Ÿå†…æ ¸ä¸­çš„AIä»£ç†ï¼Œå®ƒä¼šè‡ªåŠ¨å†³å®šæ˜¯ä¸æ˜¯è¯¥å¼€é£æ‰‡ ğŸ˜†</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸŒ¡ï¸ æ™ºèƒ½ç³»ç»Ÿè°ƒåº¦å™¨åŸå‹ï¼ˆèåˆAIå†³ç­–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AwareScheduler</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">model</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">observeSystem</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">cpuUsage</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span>,
      <span class="hljs-attr">temp</span>: <span class="hljs-number">36</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>,
      <span class="hljs-attr">runningTasks</span>: [<span class="hljs-string">"AI_render"</span>, <span class="hljs-string">"data_sync"</span>, <span class="hljs-string">"web_server"</span>]
    };
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">decide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeSystem</span>();
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span>.<span class="hljs-title function_">generate</span>(<span class="hljs-string">`
      å½“å‰CPUä½¿ç”¨ç‡ä¸º<span class="hljs-subst">${context.cpuUsage.toFixed(<span class="hljs-number">1</span>)}</span>%ï¼Œæ¸©åº¦ä¸º<span class="hljs-subst">${context.temp.toFixed(<span class="hljs-number">1</span>)}</span>â„ƒï¼Œ
      è¿è¡Œä»»åŠ¡ä¸º<span class="hljs-subst">${context.runningTasks.join(<span class="hljs-string">"ã€"</span>)}</span>
      è¯¥å¦‚ä½•è°ƒåº¦ä»»åŠ¡ä¸é£æ‰‡è½¬é€Ÿï¼Ÿè¯·è¾“å‡ºæŒ‡ä»¤å­—ç¬¦ä¸²ã€‚
    `</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ§  æ¨¡å‹ç­–ç•¥è¾“å‡ºï¼š"</span>, response);
  }
}

<span class="hljs-comment">// æ¨¡å‹ï¼ˆç®€åŒ–ç‰ˆï¼Œå¤§æ¦‚åªä¼šèƒ¡è¯´å…«é“ï¼‰</span>
<span class="hljs-keyword">const</span> fakeModel = {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">prompt</span>) {
    <span class="hljs-keyword">if</span> (prompt.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"æ¸©åº¦ä¸º"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼€é£æ‰‡åŠ å¼ºå†·å´ï¼Œå¹¶é™ä½AI_renderè¿›ç¨‹æƒé‡ã€‚"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">"ç³»ç»Ÿç¨³å®šï¼Œç»§ç»­è¿è¡Œã€‚"</span>;
  }
};

<span class="hljs-comment">// å¯åŠ¨AIå†…æ ¸çš„è°ƒåº¦å™¨</span>
<span class="hljs-keyword">const</span> scheduler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AwareScheduler</span>(fakeModel);
scheduler.<span class="hljs-title function_">decide</span>();
</code></pre>
<p>è¿™è™½æ˜¯ç©ç¬‘ï¼Œä½†å±•ç¤ºäº†â€œå¤§æ¨¡å‹å†…åµŒç³»ç»Ÿâ€ï¼Œé€šè¿‡è¯­ä¹‰é€»è¾‘æ§åˆ¶ä½å±‚æ“ä½œçš„è½®å»“ã€‚<br/>
æœªæ¥æ“ä½œç³»ç»Ÿçš„æ—¥å¿—æˆ–è®¸é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">[<span class="hljs-symbol">AI_DECISION</span>]: <span class="hljs-link">é™ä½GPUè°ƒåº¦ä¼˜å…ˆçº§ï¼Œæ£€æµ‹é£å™ªï¼Œç”¨æˆ·åœ¨è§†é¢‘é€šè¯ä¸­ã€‚  </span>
[<span class="hljs-symbol">SYS_ACTION</span>]: <span class="hljs-link">å·²è°ƒæ•´é£æ‰‡é€Ÿç‡è‡³é™éŸ³æ¨¡å¼ã€‚</span>
</code></pre>
<hr/>
<h2 data-id="heading-6">ğŸŒ ä¸ƒã€ä¼¦ç†ä¸æ²»ç†ï¼šæ™ºèƒ½å†…æ ¸ä¸æ˜¯ä¸»å®°ï¼Œè€Œæ˜¯ä¼™ä¼´</h2>
<p>å½“æˆ‘ä»¬è°ˆâ€œAIåµŒå…¥ç³»ç»Ÿâ€ï¼ŒåŒæ—¶ä¹Ÿè¦é¢å¯¹<strong>å®‰å…¨ä¸è´£ä»»è¾¹ç•Œ</strong>ï¼š</p>
<ul>
<li>âœ… <strong>å¯è§£é‡Šæ€§</strong>ï¼šAIçš„æ¯æ¬¡ç³»ç»Ÿè°ƒç”¨éƒ½å¿…é¡»æœ‰å†³ç­–ä¾æ®ã€‚</li>
<li>ğŸ”’ <strong>å®‰å…¨ç½‘å…³</strong>ï¼šé¿å…AIç›´æ¥è®¿é—®å†…æ ¸çº§èµ„æºï¼Œæ— äººç›‘ç£è¡Œä¸ºã€‚</li>
<li>ğŸ§­ <strong>æ²»ç†æ¥å£</strong>ï¼šä¸ºAIå†³ç­–æ„å»ºå®¡è®¡ä¸äººå·¥å¹²é¢„æœºåˆ¶ã€‚</li>
</ul>
<p>åªæœ‰åœ¨äººç±»ä»æ˜¯ç³»ç»Ÿâ€œæœ€ç»ˆè§£é‡Šè€…â€çš„å‰æä¸‹ï¼Œå¤§æ¨¡å‹èåˆæ‰æ˜¯æ–‡æ˜çš„ï¼Œè€Œéé£é™©çš„ã€‚</p>
<hr/>
<h2 data-id="heading-7">ğŸŒˆ å…«ã€ç»“è¯­ï¼šç³»ç»Ÿåœ¨å˜èªæ˜ï¼ŒAIåœ¨å˜è„šè¸å®åœ°</h2>
<p>æœªæ¥çš„æ¶æ„ä¸ä¼šå†æœ‰æ¸…æ™°çš„è¾¹ç•Œâ€”â€”<br/>
æ“ä½œç³»ç»Ÿä¼šâ€œè¯´è¯â€ï¼Œå¤§æ¨¡å‹ä¼šâ€œè°ƒåº¦â€ï¼Œè®¡ç®—æœºå°†é€æ¸æ¼”åŒ–ä¸ºã€Œè®¤çŸ¥ç”Ÿæ€ã€ã€‚</p>
<p>æˆ–è®¸æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬å†™ä¸‹è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">await</span> System.think(<span class="hljs-string">"æˆ‘æ˜¯ä¸æ˜¯è¯¥ä¼˜åŒ–è‡ªå·±äº†ï¼Ÿ"</span>);
</code></pre>
<p>è€Œæ§åˆ¶å°æ·¡å®šåœ°å›å¤ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">ğŸ§  æˆ‘åˆšå®Œæˆä¸€æ¬¡è‡ªç›‘ç£è°ƒä¼˜ï¼Œæ€§èƒ½æå‡<span class="hljs-number">12</span><span class="hljs-comment">%ï¼Œè°¢è°¢ä½ çš„å…³å¿ƒã€‚</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Android è¿›é˜¶ã€‘ä¸ºä»€ä¹ˆä½ åº”è¯¥åœæ­¢åœ¨ ViewModel `init` ä¸­åŠ è½½æ•°æ®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7580312375373021224</link>    <guid>https://juejin.cn/post/7580312375373021224</guid>    <pubDate>2025-12-07T03:20:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580312375373021224" data-draft-id="7580312375373004840" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Android è¿›é˜¶ã€‘ä¸ºä»€ä¹ˆä½ åº”è¯¥åœæ­¢åœ¨ ViewModel `init` ä¸­åŠ è½½æ•°æ®ï¼Ÿ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-07T03:20:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŸå ¡ä¿®ç‚¼è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2379804202775341"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Android è¿›é˜¶ã€‘ä¸ºä»€ä¹ˆä½ åº”è¯¥åœæ­¢åœ¨ ViewModel `init` ä¸­åŠ è½½æ•°æ®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2379804202775341/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŸå ¡ä¿®ç‚¼è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T03:20:25.000Z" title="Sun Dec 07 2025 03:20:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Android åº”ç”¨å¼€å‘ä¸­ï¼Œ"å¦‚ä½•åŠ è½½åˆå§‹æ•°æ®" ä¼¼ä¹æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ã€‚ç„¶è€Œï¼Œå³ä½¿æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…ï¼Œå¸¸å¸¸ä¹Ÿä¼šåœ¨<strong>é…ç½®å˜æ›´ï¼ˆConfiguration Changesï¼‰</strong> å’Œ<strong>å•å…ƒæµ‹è¯•ï¼ˆUnit Testingï¼‰</strong> è¿™ä¸¤ä¸ªæç«¯ä¹‹é—´å·¦å³ä¸ºéš¾ã€‚</p>
<p>ä½ æ˜¯å¦é‡åˆ°è¿‡ä»¥ä¸‹æƒ…å†µï¼Ÿ</p>
<ol>
<li>å±å¹•æ—‹è½¬åï¼Œæ•°æ®åˆé‡æ–°è¯·æ±‚äº†ä¸€æ¬¡ï¼Œæµªè´¹äº†æµé‡ã€‚</li>
<li>è¯•å›¾æµ‹è¯• ViewModelï¼Œä½†æ•°æ®åœ¨å®ä¾‹åŒ–æ—¶å°±è‡ªåŠ¨åŠ è½½äº†ï¼Œå¯¼è‡´æ— æ³• Mock åˆå§‹çŠ¶æ€ã€‚</li>
</ol>
<p>æœ¬æ–‡å°†ä»‹ç»ä¸€ç§ç»“åˆäº† <strong>Flow</strong> æ“ä½œç¬¦çš„â€œæœ€ä½³å®è·µâ€ï¼Œå®ƒèƒ½å®Œç¾è§£å†³ä¸Šè¿°ä¸¤ä¸ªç—›ç‚¹ï¼Œè®©ä½ çš„ä»£ç æ—¢å¥å£®åˆæ˜“äºæµ‹è¯•ã€‚</p>
<hr/>
<h2 data-id="heading-0">â›” å¸¸è§çš„ä¸¤ç§â€œä¸å®Œç¾â€å†™æ³•</h2>
<p>åœ¨ä»‹ç»æœ€ä½³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¿«é€Ÿå›é¡¾ä¸€ä¸‹ç›®å‰æœ€ä¸»æµçš„ä¸¤ç§åšæ³•ï¼Œä»¥åŠå®ƒä»¬çš„é—®é¢˜æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-1">1. è¿™ç§å†™æ³•ï¼š<code>LaunchedEffect</code></h3>
<p>åœ¨ Compose UI ä¸­ç›´æ¥è§¦å‘ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">MyViewModel</span>)</span></span> {
 Â   LaunchedEffect(<span class="hljs-built_in">Unit</span>) {
 Â  Â  Â   viewModel.loadData()
 Â   }
 Â   <span class="hljs-comment">// ...</span>
}
</code></pre>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼šæµ‹è¯•æ–¹ä¾¿ï¼Œå› ä¸ºä½ å¯ä»¥æ§åˆ¶ä½•æ—¶è°ƒç”¨ <code>loadData</code>ã€‚</li>
<li><strong>ç—›ç‚¹</strong>ï¼š<strong>é…ç½®å˜æ›´å™©æ¢¦</strong>ã€‚å½“ç”¨æˆ·æ—‹è½¬å±å¹•æ—¶ï¼ŒActivity é‡å»ºï¼Œ<code>LaunchedEffect</code> é‡æ–°æ‰§è¡Œï¼Œå¯¼è‡´é‡å¤çš„ç½‘ç»œè¯·æ±‚ã€‚è¿™ä¸ä»…æµªè´¹èµ„æºï¼Œè¿˜å¯èƒ½å¯¼è‡´ UI é—ªçƒã€‚</li>
</ul>
<h3 data-id="heading-2">2. è¿™ç§å†™æ³•ï¼šViewModel <code>init</code> å—</h3>
<p>åœ¨ ViewModel åˆå§‹åŒ–æ—¶è§¦å‘ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repo: Repository) : ViewModel() {
 Â   <span class="hljs-keyword">init</span> {
 Â  Â  Â   loadData()
 Â   }
}
</code></pre>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼šè§£å†³äº†æ—‹è½¬é—®é¢˜ã€‚ViewModel åœ¨é…ç½®å˜æ›´æœŸé—´æ˜¯å­˜æ´»çš„ï¼Œæ‰€ä»¥ <code>init</code> ä¸ä¼šé‡æ–°è¿è¡Œã€‚</li>
<li><strong>ç—›ç‚¹</strong>ï¼š<strong>æµ‹è¯•åœ°ç‹±</strong>ã€‚æ•°æ®åŠ è½½ä½œä¸ºæ„é€ å‡½æ•°çš„å‰¯ä½œç”¨ç«‹å³å‘ç”Ÿã€‚ä½ æ— æ³•åœ¨ <code>loadData</code> æ‰§è¡Œä¹‹å‰è®¾ç½®æµ‹è¯•ç¯å¢ƒï¼ˆæ¯”å¦‚ Mock ç‰¹å®šçš„æµå‘å°„ï¼‰ï¼Œè¿™è®©ç¼–å†™ç²¾å‡†çš„å•å…ƒæµ‹è¯•å˜å¾—éå¸¸å›°éš¾ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">âœ… æœ€ä½³å®è·µï¼š<code>onStart</code> + <code>stateIn</code></h2>
<p>æˆ‘ä»¬éœ€è¦çš„æ–¹æ¡ˆå¿…é¡»æ»¡è¶³ä¸¤ç‚¹ï¼š</p>
<ol>
<li><strong>æ‡’åŠ è½½ï¼ˆLazyï¼‰</strong> ï¼šåªæœ‰ UI å¼€å§‹ç›‘å¬æ—¶æ‰åŠ è½½ï¼ˆåˆ©äºæµ‹è¯•ï¼‰ã€‚</li>
<li><strong>ç¼“å­˜ï¼ˆCachingï¼‰</strong> ï¼šåœ¨å±å¹•æ—‹è½¬ç­‰çŸ­æš‚ä¸­æ–­æ—¶ï¼Œä¿æŒæ•°æ®ä¸é‡æ–°åŠ è½½ã€‚</li>
</ol>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Kotlin Flow çš„ <code>onStart</code> æ“ä½œç¬¦é…åˆ <code>stateIn</code> çš„ <code>WhileSubscribed</code> ç­–ç•¥æ¥å®ç°ã€‚</p>
<h3 data-id="heading-4">ä»£ç å®ç°</h3>
<p>çœ‹çœ‹è¿™ä¸ªä¼˜é›…çš„å®ç°æ–¹å¼ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repository: MyRepository) : ViewModel() {
â€‹
 Â   <span class="hljs-comment">// 1. æˆ‘ä»¬ä¸å†ä½¿ç”¨ init å—ï¼Œä¹Ÿä¸ä½¿ç”¨ private MutableStateFlow</span>
 Â  Â 
 Â   <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = repository.observeData()
 Â  Â  Â   <span class="hljs-comment">// 2. å…³é”®ç‚¹ï¼šä½¿ç”¨ onStart è§¦å‘å‰¯ä½œç”¨ï¼ˆåŠ è½½æ•°æ®ï¼‰</span>
 Â  Â  Â   .onStart {
 Â  Â  Â  Â  Â   repository.refreshData() <span class="hljs-comment">// æˆ–è€… emit(Loading)</span>
 Â  Â  Â   }
 Â  Â  Â   <span class="hljs-comment">// 3. è½¬æ¢ä¸º StateFlow</span>
 Â  Â  Â   .stateIn(
 Â  Â  Â  Â  Â   scope = viewModelScope,
 Â  Â  Â  Â  Â   <span class="hljs-comment">// 4. æ ¸å¿ƒï¼šè®¾ç½® 5 ç§’çš„è¶…æ—¶ç¼“å­˜</span>
 Â  Â  Â  Â  Â   started = SharingStarted.WhileSubscribed(<span class="hljs-number">5000</span>),
 Â  Â  Â  Â  Â   initialValue = UiState.Loading
 Â  Â  Â   )
}
</code></pre>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯å®Œç¾çš„ï¼Ÿ</h3>
<p>è®©æˆ‘ä»¬æ·±å…¥åˆ†æè¿™æ®µä»£ç èƒŒåçš„æœºåˆ¶ã€‚</p>
<h4 data-id="heading-6">1. è§£å†³æµ‹è¯•éš¾é¢˜ (<code>onStart</code>)</h4>
<p>onStart æ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œç¬¦ï¼Œå®ƒåªæœ‰åœ¨ Flow è¢«æ”¶é›†ï¼ˆcollectedï¼‰ æ—¶æ‰ä¼šæ‰§è¡Œã€‚è¿™æ„å‘³ç€å½“ä½ å®ä¾‹åŒ– ViewModel æ—¶ï¼Œç½‘ç»œè¯·æ±‚ä¸ä¼šç«‹å³å‘ç”Ÿã€‚</p>
<p>åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œä½ æœ‰å……è¶³çš„æ—¶é—´å» Mock ä½ çš„ Repositoryï¼Œç„¶åå†è°ƒç”¨ viewModel.uiState.test { ... } æ¥è§¦å‘åŠ è½½ã€‚</p>
<h4 data-id="heading-7">2. è§£å†³å±å¹•æ—‹è½¬é—®é¢˜ (<code>WhileSubscribed(5000)</code>)</h4>
<p>è¿™æ˜¯æ•´ä¸ªæ–¹æ¡ˆçš„çµé­‚æ‰€åœ¨ã€‚</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç”¨æˆ·æ—‹è½¬å±å¹•ã€‚</li>
<li><strong>å‘ç”Ÿçš„äº‹æƒ…</strong>ï¼šæ—§çš„ Activity é”€æ¯ï¼Œåœæ­¢æ”¶é›† Flowï¼›æ–°çš„ Activity åˆ›å»ºï¼Œé‡æ–°æ”¶é›† Flowã€‚</li>
<li><strong>WhileSubscribed(5000) çš„ä½œç”¨</strong>ï¼šå½“è®¢é˜…è€…æ•°é‡ä» 1 å˜ä¸º 0 æ—¶ï¼Œä¸Šæ¸¸çš„æ•°æ®æµ<strong>ä¸ä¼šç«‹å³åœæ­¢</strong>ï¼Œè€Œæ˜¯ä¼šä¿æŒæ´»è·ƒçŠ¶æ€ 5 ç§’é’Ÿï¼ˆstopTimeoutMillisï¼‰ã€‚</li>
</ul>

<ul>
<li><strong>ç»“æœ</strong>ï¼šå› ä¸ºå±å¹•æ—‹è½¬é€šå¸¸åœ¨å‡ ç™¾æ¯«ç§’å†…å®Œæˆï¼Œæ–°çš„è®¢é˜…è€…ä¼šåœ¨ 5 ç§’å†…å‡ºç°ã€‚æ­¤æ—¶ï¼ŒFlow è®¤ä¸ºâ€œä¸€ç›´æœ‰è®¢é˜…è€…â€ï¼Œå› æ­¤<strong>ä¸ä¼š</strong>é‡æ–°è§¦å‘ <code>onStart</code>ï¼Œä¹Ÿå°±é¿å…äº†é‡å¤è¯·æ±‚ã€‚</li>
</ul>
<h4 data-id="heading-8">3. æ™ºèƒ½çš„åå°è¡Œä¸º</h4>
<p>å¦‚æœç”¨æˆ·æŒ‰ Home é”®å°†åº”ç”¨é€€åˆ°åå°ï¼Œç”±äº <code>WhileSubscribed</code> çš„è¶…æ—¶æœºåˆ¶ï¼š</p>
<ul>
<li><strong>5ç§’å†…è¿”å›</strong>ï¼šæ•°æ®æ— éœ€é‡è½½ï¼Œæ— ç¼è¡”æ¥ã€‚</li>
<li><strong>è¶…è¿‡5ç§’è¿”å›</strong>ï¼šFlow åœæ­¢ã€‚å½“ç”¨æˆ·å†æ¬¡æ‰“å¼€åº”ç”¨ï¼Œ<code>onStart</code> é‡æ–°æ‰§è¡Œã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ª<strong>ç‰¹æ€§</strong>è€Œé Bugâ€”â€”å¦‚æœç”¨æˆ·ç¦»å¼€å¾ˆä¹…ï¼Œä»–ä»¬é€šå¸¸å¸Œæœ›çœ‹åˆ°æœ€æ–°çš„æ•°æ®ï¼Œè€Œä¸æ˜¯é™ˆæ—§çš„ç¼“å­˜ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>é€šè¿‡å°†æ•°æ®åŠ è½½é€»è¾‘ä» <code>init</code> å—ç§»åŠ¨åˆ° Flow çš„ <code>onStart</code> æ“ä½œç¬¦ï¼Œå¹¶ç»“åˆ <code>SharingStarted.WhileSubscribed(5000)</code>ï¼Œæˆ‘ä»¬è¾¾æˆäº†ä¸€ä¸ªå®Œç¾çš„å¹³è¡¡ï¼š</p>





























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>LaunchedEffect</strong></th><th><strong>ViewModel init</strong></th><th><strong>Flow (onStart + stateIn)</strong></th></tr></thead><tbody><tr><td><strong>æŠ—å±å¹•æ—‹è½¬</strong></td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>æ˜“äºå•å…ƒæµ‹è¯•</strong></td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr><tr><td><strong>è‡ªåŠ¨åˆ·æ–°è¿‡æœŸæ•°æ®</strong></td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7580606750291181619</link>    <guid>https://juejin.cn/post/7580606750291181619</guid>    <pubDate>2025-12-07T14:35:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750291181619" data-draft-id="7580621397971009545" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T14:35:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:35:44.000Z" title="Sun Dec 07 2025 14:35:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å…¨å±€/é™æ€å¯¹è±¡çš„æ„é€ ä¸ææ„æ—¶æœº</h2>
<h3 data-id="heading-1">æ„é€ é¡ºåºï¼šè·¨ç¼–è¯‘å•å…ƒçš„æŒ‘æˆ˜</h3>
<p>å…¨å±€å¯¹è±¡å’Œé™æ€å¯¹è±¡çš„æ„é€ é¡ºåºåœ¨C++æ ‡å‡†ä¸­<strong>æ²¡æœ‰æ˜ç¡®å®šä¹‰</strong>ï¼Œç‰¹åˆ«æ˜¯å¯¹äºä½äºä¸åŒç¼–è¯‘å•å…ƒä¸­çš„å¯¹è±¡ã€‚è¿™å¯èƒ½å¯¼è‡´å±é™©çš„åˆå§‹åŒ–ä¾èµ–é—®é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// file1.cpp</span>
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> global_from_file2;
<span class="hljs-type">int</span> global1 = global_from_file2 + <span class="hljs-number">1</span>;  <span class="hljs-comment">// å±é™©ï¼å¯èƒ½ä½¿ç”¨æœªåˆå§‹åŒ–çš„å€¼</span>

<span class="hljs-comment">// file2.cpp</span>
<span class="hljs-type">int</span> global_from_file2 = <span class="hljs-number">42</span>;
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨å‡½æ•°å±€éƒ¨é™æ€å˜é‡ï¼ˆMeyer's Singletonæ¨¡å¼ï¼‰</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">get_global</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> <span class="hljs-type">int</span> instance = <span class="hljs-number">42</span>;  <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨ï¼ˆC++11èµ·ï¼‰</span>
    <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<h3 data-id="heading-2">ææ„é¡ºåºï¼šåå‘ä¾èµ–é£é™©</h3>
<p>ææ„é¡ºåºå¤§è‡´æ˜¯æ„é€ é¡ºåºçš„é€†åºï¼Œä½†ç”±äºæ„é€ é¡ºåºä¸ç¡®å®šï¼Œææ„æ—¶å¯èƒ½å‡ºç°"å·²é”€æ¯å¯¹è±¡è¢«å¼•ç”¨"çš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Logger</span> {
    ~<span class="hljs-built_in">Logger</span>() { std::cout &lt;&lt; <span class="hljs-string">"Logger destroyed\n"</span>; }
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; msg)</span> </span>{ <span class="hljs-comment">/* ... */</span> }
};

Logger logger;  <span class="hljs-comment">// å…¨å±€å¯¹è±¡</span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Database</span> {
    ~<span class="hljs-built_in">Database</span>() {
        logger.<span class="hljs-built_in">log</span>(<span class="hljs-string">"Database cleaning up"</span>);  <span class="hljs-comment">// å±é™©ï¼loggerå¯èƒ½å·²é”€æ¯</span>
    }
};

Database db;  <span class="hljs-comment">// å¦ä¸€ä¸ªå…¨å±€å¯¹è±¡</span>
</code></pre>
<p><strong>æœ€ä½³å®è·µï¼š</strong> åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç¡®ä¿ä¾èµ–å…³ç³»ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">Logger&amp; <span class="hljs-title">get_logger</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> Logger instance;
    <span class="hljs-keyword">return</span> instance;
}

<span class="hljs-function">Database&amp; <span class="hljs-title">get_database</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> Database instance;
    <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<h2 data-id="heading-3">äºŒã€æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº</h2>
<h3 data-id="heading-4">å£°æ˜é¡ºåºçš„ç»å¯¹ä¼˜å…ˆçº§</h3>
<p>æˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåº<strong>åªå–å†³äºå®ƒä»¬åœ¨ç±»ä¸­å£°æ˜çš„é¡ºåº</strong>ï¼Œè€Œä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„é¡ºåºã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> {
    <span class="hljs-type">int</span> a;
    <span class="hljs-type">int</span> b;
    <span class="hljs-type">int</span> c;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è­¦å‘Šï¼šåˆå§‹åŒ–åˆ—è¡¨é¡ºåºä¸å£°æ˜é¡ºåºä¸åŒï¼</span>
    <span class="hljs-built_in">Example</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">c</span>(val), <span class="hljs-built_in">b</span>(c + <span class="hljs-number">1</span>), <span class="hljs-built_in">a</span>(b + <span class="hljs-number">1</span>) {
        <span class="hljs-comment">// å®é™…åˆå§‹åŒ–é¡ºåºï¼ša â†’ b â†’ c</span>
        <span class="hljs-comment">// a = æœªå®šä¹‰ï¼ˆä½¿ç”¨æœªåˆå§‹åŒ–çš„bï¼‰</span>
        <span class="hljs-comment">// b = æœªå®šä¹‰ï¼ˆä½¿ç”¨æœªåˆå§‹åŒ–çš„cï¼‰</span>
        <span class="hljs-comment">// c = val</span>
    }
};
</code></pre>
<p><strong>ç¼–è¯‘å™¨è­¦å‘Šï¼š</strong> ç°ä»£ç¼–è¯‘å™¨é€šå¸¸ä¼šè­¦å‘Šè¿™ç§é¡ºåºä¸ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">warning:</span> field <span class="hljs-comment">'b' will be initialized after field 'a'</span>
<span class="hljs-symbol">warning:</span> field <span class="hljs-comment">'c' will be initialized after field 'b'</span>
</code></pre>
<h3 data-id="heading-5">æ­£ç¡®æ¨¡å¼ï¼šéµå¾ªå£°æ˜é¡ºåº</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProperExample</span> {
    std::string name;
    <span class="hljs-type">int</span> id;
    std::vector&lt;<span class="hljs-type">double</span>&gt; data;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">ProperExample</span>(<span class="hljs-type">const</span> std::string&amp; n, <span class="hljs-type">int</span> i, std::initializer_list&lt;<span class="hljs-type">double</span>&gt; d)
        : <span class="hljs-built_in">name</span>(n)      <span class="hljs-comment">// 1. ç¬¬ä¸€ä¸ªå£°æ˜</span>
        , <span class="hljs-built_in">id</span>(i)        <span class="hljs-comment">// 2. ç¬¬äºŒä¸ªå£°æ˜  </span>
        , <span class="hljs-built_in">data</span>(d) {    <span class="hljs-comment">// 3. ç¬¬ä¸‰ä¸ªå£°æ˜</span>
        <span class="hljs-comment">// å®‰å…¨ï¼šåˆå§‹åŒ–é¡ºåºä¸å£°æ˜é¡ºåºä¸€è‡´</span>
    }
};
</code></pre>
<h3 data-id="heading-6">ä¾èµ–åˆå§‹åŒ–è§£å†³æ–¹æ¡ˆ</h3>
<p>å½“æˆå‘˜å˜é‡é—´å­˜åœ¨ä¾èµ–å…³ç³»æ—¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnection</span> {
    std::string connection_string;
    ConnectionHandle handle;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">DatabaseConnection</span>(<span class="hljs-type">const</span> std::string&amp; conn_str)
        : <span class="hljs-built_in">connection_string</span>(conn_str)
        , <span class="hljs-built_in">handle</span>(<span class="hljs-built_in">create_handle</span>(connection_string)) {  <span class="hljs-comment">// ä¾èµ–connection_string</span>
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">static</span> ConnectionHandle <span class="hljs-title">create_handle</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span>;
};
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€ä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿</h2>
<h3 data-id="heading-8">åŸºæœ¬è§„åˆ™ï¼šç»‘å®šåˆ°constå¼•ç”¨</h3>
<p>å½“ä¸´æ—¶å¯¹è±¡ç»‘å®šåˆ°constå¼•ç”¨æ—¶ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¼šå»¶é•¿åˆ°è¯¥å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">std::string <span class="hljs-title">create_string</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, World!"</span>;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> std::string&amp; str = <span class="hljs-built_in">create_string</span>();  <span class="hljs-comment">// ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå»¶é•¿</span>
    std::cout &lt;&lt; str &lt;&lt; <span class="hljs-string">"\n"</span>;                  <span class="hljs-comment">// å®‰å…¨ä½¿ç”¨</span>
    
    <span class="hljs-comment">// å½“strç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¸´æ—¶å¯¹è±¡æ‰ä¼šè¢«é”€æ¯</span>
}
</code></pre>
<h3 data-id="heading-9">é‡è¦é™åˆ¶å’Œç»†èŠ‚</h3>
<ol>
<li><strong>ä»…é€‚ç”¨äºconstå¼•ç”¨ï¼ˆC++98/03ï¼‰æˆ–å³å€¼å¼•ç”¨ï¼ˆC++11+ï¼‰</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// C++11èµ·ï¼Œä¹Ÿå¯ä»¥ç»‘å®šåˆ°å³å€¼å¼•ç”¨</span>
std::string&amp;&amp; rref = <span class="hljs-built_in">create_string</span>();  <span class="hljs-comment">// åŒæ ·å»¶é•¿ç”Ÿå‘½å‘¨æœŸ</span>

<span class="hljs-comment">// éconstå·¦å€¼å¼•ç”¨ä¸è¡Œ</span>
<span class="hljs-comment">// std::string&amp; ref = create_string();  // ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<ol start="2">
<li><strong>ç”Ÿå‘½å‘¨æœŸé“¾å¼å»¶é•¿</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">const</span> std::string&amp; <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Temporary"</span>;  <span class="hljs-comment">// ä¸´æ—¶å¯¹è±¡ç»‘å®šåˆ°è¿”å›çš„å¼•ç”¨</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> std::string&amp; ref = <span class="hljs-built_in">func</span>();  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸè¿›ä¸€æ­¥å»¶é•¿</span>
    <span class="hljs-comment">// refåœ¨test()ç»“æŸæ—¶é”€æ¯</span>
}
</code></pre>
<ol start="3">
<li><strong>ä¸é€‚ç”¨äºæˆå‘˜è®¿é—®</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Value</span> {
    <span class="hljs-type">int</span> data = <span class="hljs-number">42</span>;
};

<span class="hljs-function">Value <span class="hljs-title">get_value</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> {}; }

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> Value&amp; val = <span class="hljs-built_in">get_value</span>();  <span class="hljs-comment">// Valueå¯¹è±¡ç”Ÿå‘½å‘¨æœŸå»¶é•¿</span>
    <span class="hljs-type">int</span> x = val.data;                <span class="hljs-comment">// å®‰å…¨</span>
    
    <span class="hljs-comment">// ä½†æˆå‘˜è®¿é—®äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡ä¸å»¶é•¿</span>
    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; bad = <span class="hljs-built_in">get_value</span>().data;  <span class="hljs-comment">// å±é™©ï¼Valueä¸´æ—¶å¯¹è±¡ç«‹å³é”€æ¯</span>
}
</code></pre>
<h3 data-id="heading-10">å®é™…åº”ç”¨åœºæ™¯</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åœºæ™¯1ï¼šé¿å…æ‹·è´ï¼Œæé«˜æ€§èƒ½</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_string</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span>;

<span class="hljs-built_in">process_string</span>(<span class="hljs-string">"Temporary string"</span>);  <span class="hljs-comment">// æ— éœ€åˆ›å»ºå‘½åå˜é‡</span>

<span class="hljs-comment">// åœºæ™¯2ï¼šrange-based forå¾ªç¯</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; item : <span class="hljs-built_in">get_temporary_vector</span>()) {
    <span class="hljs-comment">// ä¸´æ—¶vectorçš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿åˆ°æ•´ä¸ªå¾ªç¯</span>
}

<span class="hljs-comment">// åœºæ™¯3ï¼šå‡½æ•°å¼ç¼–ç¨‹</span>
<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; result = std::<span class="hljs-built_in">accumulate</span>(
    data.<span class="hljs-built_in">begin</span>(), 
    data.<span class="hljs-built_in">end</span>(), 
    <span class="hljs-number">0</span>,  <span class="hljs-comment">// ä¸´æ—¶intå»¶é•¿ç”Ÿå‘½å‘¨æœŸ</span>
    [](<span class="hljs-type">int</span> acc, <span class="hljs-type">int</span> val) { <span class="hljs-keyword">return</span> acc + val; }
);
</code></pre>
<h2 data-id="heading-11">å››ã€std::launderåœ¨å¯¹è±¡é‡ç”¨ä¸­çš„å®é™…åº”ç”¨</h2>
<h3 data-id="heading-12">é—®é¢˜èƒŒæ™¯ï¼šæŒ‡é’ˆä¼˜åŒ–ä¸åˆ«åé—®é¢˜</h3>
<p>ç¼–è¯‘å™¨å¯èƒ½åŸºäº"å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ"å‡è®¾è¿›è¡Œä¼˜åŒ–ï¼Œå½“æˆ‘ä»¬åœ¨ç›¸åŒå†…å­˜ä½ç½®æ„é€ æ–°å¯¹è±¡æ—¶ï¼Œå¯èƒ½å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">X</span> { <span class="hljs-type">int</span> x; };
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Y</span> { <span class="hljs-type">int</span> y; };

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">problematic_example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(<span class="hljs-built_in">alignof</span>(Y)) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Y)];
    
    X* x = <span class="hljs-built_in">new</span> (buffer) X{<span class="hljs-number">10</span>};
    x-&gt;~<span class="hljs-built_in">X</span>();
    
    Y* y = <span class="hljs-built_in">new</span> (buffer) Y{<span class="hljs-number">20</span>};
    
    <span class="hljs-comment">// ç¼–è¯‘å™¨å¯èƒ½è®¤ä¸ºxæŒ‡å‘å·²é”€æ¯çš„å¯¹è±¡</span>
    <span class="hljs-comment">// å®é™…ä¸Šxå’ŒyæŒ‡å‘ç›¸åŒå†…å­˜ï¼Œä½†ç±»å‹ä¸åŒ</span>
}
</code></pre>
<h3 data-id="heading-13">std::launderçš„ä½œç”¨</h3>
<p><code>std::launder</code>é€šçŸ¥ç¼–è¯‘å™¨ï¼šé€šè¿‡è¿”å›çš„æŒ‡é’ˆè®¿é—®å†…å­˜æ—¶ï¼Œåº”è¯¥å¿½ç•¥ä¹‹å‰çš„ç±»å‹ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;new&gt;</span>  <span class="hljs-comment">// std::launder</span></span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">X</span> { 
    <span class="hljs-type">const</span> <span class="hljs-type">int</span> x;  <span class="hljs-comment">// constæˆå‘˜ï¼éå¸¸é‡è¦</span>
    <span class="hljs-built_in">X</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">x</span>(val) {}
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Y</span> {
    <span class="hljs-type">int</span> y;
    <span class="hljs-built_in">Y</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">y</span>(val) {}
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">correct_example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(<span class="hljs-built_in">alignof</span>(Y)) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Y)];
    
    X* x = <span class="hljs-built_in">new</span> (buffer) X{<span class="hljs-number">10</span>};
    
    <span class="hljs-comment">// é‡ç”¨å†…å­˜ï¼šå…ˆé”€æ¯æ—§å¯¹è±¡</span>
    x-&gt;~<span class="hljs-built_in">X</span>();
    
    <span class="hljs-comment">// æ„é€ æ–°å¯¹è±¡</span>
    Y* y = <span class="hljs-built_in">new</span> (buffer) Y{<span class="hljs-number">20</span>};
    
    <span class="hljs-comment">// ä½¿ç”¨std::launderè·å–æ­£ç¡®æŒ‡é’ˆ</span>
    X* laundered_x = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;X*&gt;(buffer));
    <span class="hljs-comment">// æ³¨æ„ï¼šä¸èƒ½é€šè¿‡laundered_xè®¿é—®ï¼Œå› ä¸ºXå¯¹è±¡å·²é”€æ¯</span>
    
    <span class="hljs-comment">// æ­£ç¡®ï¼šé€šè¿‡yè®¿é—®</span>
    std::cout &lt;&lt; y-&gt;y &lt;&lt; <span class="hljs-string">"\n"</span>;
}
</code></pre>
<h3 data-id="heading-14">å¿…é¡»ä½¿ç”¨std::launderçš„åœºæ™¯</h3>
<ol>
<li><strong>å¯¹è±¡æœ‰constæˆ–å¼•ç”¨æˆå‘˜</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ConstObject</span> {
    <span class="hljs-type">const</span> <span class="hljs-type">int</span> id;
    <span class="hljs-built_in">ConstObject</span>(<span class="hljs-type">int</span> i) : <span class="hljs-built_in">id</span>(i) {}
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reuse_const_memory</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(ConstObject) <span class="hljs-type">char</span> buf[<span class="hljs-built_in">sizeof</span>(ConstObject)];
    
    <span class="hljs-keyword">auto</span>* obj1 = <span class="hljs-built_in">new</span> (buf) ConstObject{<span class="hljs-number">1</span>};
    obj1-&gt;~<span class="hljs-built_in">ConstObject</span>();
    
    <span class="hljs-keyword">auto</span>* obj2 = <span class="hljs-built_in">new</span> (buf) ConstObject{<span class="hljs-number">2</span>};
    
    <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨launderï¼Œå› ä¸ºconstæˆå‘˜å¯èƒ½è¢«ç¼“å­˜</span>
    <span class="hljs-keyword">auto</span>* ptr = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;ConstObject*&gt;(buf));
    std::cout &lt;&lt; ptr-&gt;id &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼šè¾“å‡º2</span>
}
</code></pre>
<ol start="2">
<li><strong>å¯¹è±¡æœ‰è™šå‡½æ•°</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Base</span> {
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>{ std::cout &lt;&lt; <span class="hljs-string">"Base\n"</span>; }
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() = <span class="hljs-keyword">default</span>;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Derived</span> : Base {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>{ std::cout &lt;&lt; <span class="hljs-string">"Derived\n"</span>; }
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reuse_virtual_memory</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(Base) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Derived)];
    
    Base* b = <span class="hljs-built_in">new</span> (buffer) Derived;
    b-&gt;<span class="hljs-built_in">foo</span>();  <span class="hljs-comment">// è¾“å‡º"Derived"</span>
    
    b-&gt;~<span class="hljs-built_in">Base</span>();
    
    <span class="hljs-keyword">new</span> (buffer) Base;
    
    <span class="hljs-comment">// éœ€è¦launderæ¥æ­£ç¡®è®¿é—®è™šè¡¨</span>
    Base* laundered = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;Base*&gt;(buffer));
    laundered-&gt;<span class="hljs-built_in">foo</span>();  <span class="hljs-comment">// è¾“å‡º"Base"</span>
}
</code></pre>
<ol start="3">
<li><strong>æŒ‡å‘å·²é”€æ¯å¯¹è±¡çš„æŒ‡é’ˆ</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span>... Args&gt;
T* <span class="hljs-title">reconstruct</span><span class="hljs-params">(<span class="hljs-type">void</span>* memory, Args&amp;&amp;... args)</span> </span>{
    T* old = <span class="hljs-built_in">static_cast</span>&lt;T*&gt;(memory);
    old-&gt;~<span class="hljs-built_in">T</span>();  <span class="hljs-comment">// æ˜¾å¼ææ„</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">new</span> (memory) <span class="hljs-built_in">T</span>(std::forward&lt;Args&gt;(args)...);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    std::string* str = <span class="hljs-keyword">new</span> std::<span class="hljs-built_in">string</span>(<span class="hljs-string">"Hello"</span>);
    
    <span class="hljs-comment">// é‡ç”¨å†…å­˜</span>
    std::string* new_str = <span class="hljs-built_in">reconstruct</span>&lt;std::string&gt;(str, <span class="hljs-string">"World"</span>);
    
    <span class="hljs-comment">// æ—§æŒ‡é’ˆsträ¸èƒ½ç›´æ¥ä½¿ç”¨</span>
    <span class="hljs-comment">// std::cout &lt;&lt; *str;  // æœªå®šä¹‰è¡Œä¸ºï¼</span>
    
    <span class="hljs-comment">// éœ€è¦launder</span>
    std::string* laundered = std::<span class="hljs-built_in">launder</span>(str);
    std::cout &lt;&lt; *laundered &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼š"World"</span>
    
    <span class="hljs-keyword">delete</span> new_str;  <span class="hljs-comment">// æˆ– laundered</span>
}
</code></pre>
<h3 data-id="heading-15">ä¸éœ€è¦std::launderçš„æƒ…å†µ</h3>
<ol>
<li><strong>trivially destructibleç±»å‹</strong></li>
<li><strong>ç›¸åŒç±»å‹å¯¹è±¡çš„replacement new</strong></li>
<li><strong>å†…å­˜ä»æœªåŒ…å«è¿‡å¯¹è±¡</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Trivial</span> {
    <span class="hljs-type">int</span> x;
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">trivial_example</span><span class="hljs-params">()</span> </span>{
    Trivial t{<span class="hljs-number">1</span>};
    t.~<span class="hljs-built_in">Trivial</span>();  <span class="hljs-comment">// æ˜¾å¼ææ„ï¼ˆå…è®¸ä½†é€šå¸¸ä¸å¿…è¦ï¼‰</span>
    
    <span class="hljs-keyword">new</span> (&amp;t) Trivial{<span class="hljs-number">2</span>};
    
    <span class="hljs-comment">// å¯ä»¥ç›´æ¥è®¿é—®ï¼Œå› ä¸ºTrivialæ˜¯trivially destructible</span>
    std::cout &lt;&lt; t.x &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼šè¾“å‡º2</span>
}
</code></pre>
<h3 data-id="heading-16">å®é™…å·¥ç¨‹åº”ç”¨</h3>
<p><strong>å†…å­˜æ± å®ç°ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryPool</span> {
    <span class="hljs-keyword">union</span> <span class="hljs-title class_">Node</span> {
        T object;
        Node* next;
        <span class="hljs-built_in">Node</span>() : <span class="hljs-built_in">next</span>(<span class="hljs-literal">nullptr</span>) {}
        ~<span class="hljs-built_in">Node</span>() {}
    };
    
    Node* free_list = <span class="hljs-literal">nullptr</span>;
    std::vector&lt;std::unique_ptr&lt;Node[]&gt;&gt; blocks;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span>... Args&gt;
    T* <span class="hljs-title">construct</span><span class="hljs-params">(Args&amp;&amp;... args)</span> </span>{
        <span class="hljs-keyword">if</span> (!free_list) {
            <span class="hljs-built_in">allocate_block</span>();
        }
        
        Node* node = free_list;
        free_list = free_list-&gt;next;
        
        <span class="hljs-comment">// é‡ç”¨å†…å­˜ï¼šä½¿ç”¨launderç¡®ä¿æ­£ç¡®æ€§</span>
        T* obj = <span class="hljs-built_in">new</span> (&amp;node-&gt;object) <span class="hljs-built_in">T</span>(std::forward&lt;Args&gt;(args)...);
        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">launder</span>(obj);
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">(T* ptr)</span> </span>{
        <span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span>;
        
        ptr-&gt;~<span class="hljs-built_in">T</span>();
        
        Node* node = <span class="hljs-built_in">reinterpret_cast</span>&lt;Node*&gt;(
            <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">char</span>*&gt;(ptr) - <span class="hljs-built_in">offsetof</span>(Node, object)
        );
        
        node-&gt;next = free_list;
        free_list = node;
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">allocate_block</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">constexpr</span> <span class="hljs-type">size_t</span> BLOCK_SIZE = <span class="hljs-number">64</span>;
        <span class="hljs-keyword">auto</span> block = std::<span class="hljs-built_in">make_unique</span>&lt;Node[]&gt;(BLOCK_SIZE);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; BLOCK_SIZE; ++i) {
            block[i].next = free_list;
            free_list = &amp;block[i];
        }
        
        blocks.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(block));
    }
};
</code></pre>
<h2 data-id="heading-17">äº”ã€æœ€ä½³å®è·µæ€»ç»“</h2>
<ol>
<li>
<p><strong>å…¨å±€/é™æ€å¯¹è±¡</strong></p>
<ul>
<li>é¿å…è·¨ç¼–è¯‘å•å…ƒä¾èµ–</li>
<li>ä½¿ç”¨å±€éƒ¨é™æ€å˜é‡ä¿è¯åˆå§‹åŒ–é¡ºåº</li>
<li>æ³¨æ„ææ„é¡ºåºåå‘ä¾èµ–</li>
</ul>
</li>
<li>
<p><strong>æˆå‘˜åˆå§‹åŒ–</strong></p>
<ul>
<li>ä¸¥æ ¼æŒ‰ç…§å£°æ˜é¡ºåºç¼–å†™åˆå§‹åŒ–åˆ—è¡¨</li>
<li>å¯¹æœ‰ä¾èµ–å…³ç³»çš„æˆå‘˜ç‰¹åˆ«å°å¿ƒ</li>
<li>ä½¿ç”¨å‡½æ•°å¤„ç†å¤æ‚åˆå§‹åŒ–é€»è¾‘</li>
</ul>
</li>
<li>
<p><strong>ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</strong></p>
<ul>
<li>åˆ©ç”¨constå¼•ç”¨å»¶é•¿ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</li>
<li>æ³¨æ„ä¸é€‚ç”¨äºæˆå‘˜è®¿é—®äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡</li>
<li>å³å€¼å¼•ç”¨åŒæ ·æœ‰ç”Ÿå‘½å‘¨æœŸå»¶é•¿æ•ˆæœ</li>
</ul>
</li>
<li>
<p><strong>å¯¹è±¡é‡ç”¨ä¸std::launder</strong></p>
<ul>
<li>æœ‰const/å¼•ç”¨æˆå‘˜æˆ–è™šå‡½æ•°æ—¶å¿…é¡»ä½¿ç”¨</li>
<li>trivialç±»å‹é€šå¸¸ä¸éœ€è¦</li>
<li>åœ¨å†…å­˜æ± ã€è‡ªå®šä¹‰åˆ†é…å™¨ç­‰åœºæ™¯ç‰¹åˆ«é‡è¦</li>
<li>å§‹ç»ˆä¼˜å…ˆè€ƒè™‘æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆ</li>
</ul>
</li>
</ol>
<p>é€šè¿‡æ·±å…¥ç†è§£è¿™äº›C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œææ„é¡ºåºçš„ç»†èŠ‚ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´å®‰å…¨ã€æ›´é«˜æ•ˆçš„ä»£ç ï¼Œé¿å…æ½œåœ¨çš„å†…å­˜ç®¡ç†å’Œå¯¹è±¡ç”Ÿå‘½å‘¨æœŸé—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7580389111921508415</link>    <guid>https://juejin.cn/post/7580389111921508415</guid>    <pubDate>2025-12-07T15:31:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921508415" data-draft-id="7580389111921492031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,EventBus"/> <meta itemprop="datePublished" content="2025-12-07T15:31:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T15:31:40.000Z" title="Sun Dec 07 2025 15:31:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨ JavaScript å¼€å‘ä¸­ï¼Œäº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•åº”ç”¨çš„æ ¸å¿ƒèŒƒå¼ä¹‹ä¸€ã€‚ä»æµè§ˆå™¨ <code>DOM</code> äº‹ä»¶åˆ° Node.js çš„å¼‚æ­¥ <code>I/O</code>ï¼Œä» <code>Vue</code> çš„ç»„ä»¶é€šä¿¡åˆ° <code>React</code> çš„çŠ¶æ€ç®¡ç†ï¼Œå‘å¸ƒè®¢é˜…æ¨¡å¼æ— å¤„ä¸åœ¨ã€‚</p>
<p>é€šè¿‡æ‰‹å†™ä¸€ä¸ªç¬¦åˆ Node.js EventEmitter æ ‡å‡†çš„å®ç°ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½æ·±å…¥ç†è§£äº‹ä»¶é©±åŠ¨æ¶æ„çš„è®¾è®¡åŸç†ï¼Œè¿˜èƒ½æŒæ¡ JavaScript ä¸­é—­åŒ…ã€å†…å­˜ç®¡ç†ã€è®¾è®¡æ¨¡å¼ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ˜¯é¢è¯•ä¸­å¸¸è§çš„é«˜çº§é¢˜ç›®ï¼Œèƒ½ä½“ç°ä½ å¯¹JavaScriptè®¾è®¡æ¨¡å¼çš„ç†è§£æ·±åº¦ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å®ç°ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„<code>EventEmitter</code>ï¼Œå¹¶æ¢è®¨å…¶åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨å’Œä¼˜åŒ–ç­–ç•¥ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€å‘å¸ƒè®¢é˜…æ¨¡å¼çš„æ ¸å¿ƒæ¦‚å¿µ</h4>
<h5 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼</h5>
<p>å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆPub/Subï¼‰æ˜¯ä¸€ç§æ¶ˆæ¯ä¼ é€’èŒƒå¼ï¼Œæ¶ˆæ¯çš„å‘é€è€…ï¼ˆå‘å¸ƒè€…ï¼‰ä¸ä¼šå°†æ¶ˆæ¯ç›´æ¥å‘é€ç»™ç‰¹å®šçš„æ¥æ”¶è€…ï¼ˆè®¢é˜…è€…ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªä¸­é—´ä»¶ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰è¿›è¡Œé€šä¿¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç±»æ¯”ï¼šæŠ¥çº¸è®¢é˜…ç³»ç»Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewspaperSystem</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// äº‹ä»¶ä¸­å¿ƒ</span>
    }
    
    <span class="hljs-comment">// è®¢é˜…ï¼ˆè¯»è€…è®¢é˜…æŠ¥çº¸ï¼‰</span>
    <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">topic, reader</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">set</span>(topic, []);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic).<span class="hljs-title function_">push</span>(reader);
    }
    
    <span class="hljs-comment">// å‘å¸ƒï¼ˆæŠ¥ç¤¾å‘å¸ƒæ–°é—»ï¼‰</span>
    <span class="hljs-title function_">publish</span>(<span class="hljs-params">topic, news</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">reader</span> =&gt;</span> <span class="hljs-title function_">reader</span>(news));
        }
    }
    
    <span class="hljs-comment">// å–æ¶ˆè®¢é˜…ï¼ˆè¯»è€…é€€è®¢ï¼‰</span>
    <span class="hljs-title function_">unsubscribe</span>(<span class="hljs-params">topic, reader</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-keyword">const</span> readers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic);
            <span class="hljs-keyword">const</span> index = readers.<span class="hljs-title function_">indexOf</span>(reader);
            <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                readers.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-3">1.2 æ ¸å¿ƒç»„ä»¶</h5>
<ol>
<li><strong>äº‹ä»¶ä¸­å¿ƒ(EventEmitter):</strong> å­˜å‚¨äº‹ä»¶å’Œå›è°ƒçš„å¯¹åº”å…³ç³»</li>
<li><strong>å‘å¸ƒè€…(Publisher):</strong> è§¦å‘äº‹ä»¶ï¼Œä¼ é€’æ•°æ®</li>
<li><strong>è®¢é˜…è€…(Subscriber):</strong> ç›‘å¬äº‹ä»¶ï¼Œå¤„ç†æ•°æ®</li>
</ol>
<h5 data-id="heading-4">1.3 ä¸è§‚å¯Ÿè€…æ¨¡å¼çš„å¯¹æ¯”</h5>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">è§‚å¯Ÿè€…æ¨¡å¼</th><th align="left">å‘å¸ƒè®¢é˜…æ¨¡å¼</th></tr></thead><tbody><tr><td align="left">è€¦åˆåº¦</td><td align="left">ç›´æ¥è€¦åˆ</td><td align="left">é€šè¿‡äº‹ä»¶ä¸­å¿ƒè§£è€¦</td></tr><tr><td align="left">é€šä¿¡æ–¹å¼</td><td align="left">ç›´æ¥è°ƒç”¨</td><td align="left">é—´æ¥é€šä¿¡</td></tr><tr><td align="left">çµæ´»æ€§</td><td align="left">è¾ƒä½</td><td align="left">æ›´é«˜</td></tr><tr><td align="left">å…¸å‹å®ç°</td><td align="left">Vueå“åº”å¼</td><td align="left">NodeJS EventEmitter</td></tr></tbody></table>
<h4 data-id="heading-5">äºŒã€åŸºç¡€ EventEmitter å®ç°</h4>
<h5 data-id="heading-6">2.1 æœ€å°å¯è¡Œå®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å­˜å‚¨äº‹ä»¶å’Œå¯¹åº”çš„å›è°ƒå‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }

  <span class="hljs-comment">/**
   * è®¢é˜…äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback å›è°ƒå‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} å–æ¶ˆè®¢é˜…çš„å‡½æ•°
   */</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">set</span>(eventName, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName).<span class="hljs-title function_">push</span>(callback);

    <span class="hljs-comment">// è¿”å›å–æ¶ˆè®¢é˜…çš„å‡½æ•°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, callback);
  }

  <span class="hljs-comment">/**
   * è§¦å‘äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°
   */</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName);
    callbacks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        callback.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in event listener for <span class="hljs-subst">${eventName}</span>:`</span>, error);
      }
    });
  }

  <span class="hljs-comment">/**
   * å–æ¶ˆè®¢é˜…
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback è¦ç§»é™¤çš„å›è°ƒå‡½æ•°
   */</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName);
    <span class="hljs-keyword">const</span> index = callbacks.<span class="hljs-title function_">indexOf</span>(callback);

    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
      callbacks.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);

      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å›è°ƒå‡½æ•°äº†, åˆ é™¤è¿™ä¸ªäº‹ä»¶</span>
      <span class="hljs-keyword">if</span> (callbacks.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">delete</span>(eventName);
      }
    }
  }

  <span class="hljs-comment">/**
   * ä¸€æ¬¡æ€§è®¢é˜…
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback å›è°ƒå‡½æ•°
   */</span>
  <span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceCallback</span> = (<span class="hljs-params">...args</span>) =&gt; {
      callback.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, callback);
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, onceCallback);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, onceCallback);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨, æˆ–æŒ‡å®šäº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName å¯é€‰, äº‹ä»¶åç§°
   */</span>
  <span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (eventName) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">delete</span>(eventName);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">clear</span>();
    }
  }
}

<span class="hljs-comment">// åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// è®¢é˜…äº‹ä»¶</span>
<span class="hljs-keyword">const</span> unsubscribe = emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"message"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¶åˆ°æ¶ˆæ¯:"</span>, data);
});

<span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"message"</span>, <span class="hljs-string">"Hello World!"</span>); <span class="hljs-comment">// è¾“å‡º: æ”¶åˆ°æ¶ˆæ¯: Hello World!</span>

<span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
<span class="hljs-title function_">unsubscribe</span>();

<span class="hljs-comment">// å†æ¬¡è§¦å‘ï¼Œä¸ä¼šæœ‰è¾“å‡º</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"message"</span>, <span class="hljs-string">"Hello Again!"</span>);
</code></pre>
<h4 data-id="heading-7">ä¸‰ã€å®Œæ•´çš„ EventEmitter å®ç°</h4>
<h5 data-id="heading-8">3.1 æ”¯æŒæ›´å¤šç‰¹æ€§çš„å®Œæ•´å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä½¿ç”¨ Object.create(null) é¿å…åŸå‹æ±¡æŸ“</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = <span class="hljs-number">10</span>;
  }

  <span class="hljs-comment">// ================ æ ¸å¿ƒæ–¹æ³• ================</span>

  <span class="hljs-comment">/**
   * æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆåˆ«åï¼‰
   */</span>
  <span class="hljs-title function_">addListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ä¸€æ¬¡æ€§äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * è§¦å‘äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args ä¼ é€’ç»™ç›‘å¬å™¨çš„å‚æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ˜¯å¦æœ‰ç›‘å¬å™¨è¢«è°ƒç”¨
   */</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ error äº‹ä»¶çš„ç›‘å¬å™¨ï¼ŒæŠ›å‡ºé”™è¯¯</span>
      <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">"error"</span>) {
        <span class="hljs-keyword">const</span> error = args[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
          <span class="hljs-keyword">throw</span> error;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Unhandled error event"</span>);
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
    <span class="hljs-keyword">const</span> listenersCopy = listeners.<span class="hljs-title function_">slice</span>(); <span class="hljs-comment">// åˆ›å»ºå‰¯æœ¬é¿å…è¿­ä»£æ—¶ä¿®æ”¹</span>

    <span class="hljs-keyword">let</span> called = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
        <span class="hljs-keyword">if</span> (listener.<span class="hljs-property">_once</span>) {
          <span class="hljs-comment">// ç§»é™¤åŸå§‹ç›‘å¬å™¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
        }

        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        called = <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
        <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">"error"</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"error"</span>, error);
        }
      }
    }

    <span class="hljs-keyword">return</span> called;
  }

  <span class="hljs-comment">/**
   * ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener è¦ç§»é™¤çš„ç›‘å¬å™¨
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeListener</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener è¦ç§»é™¤çš„ç›‘å¬å™¨
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">removeListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} [eventName] å¯é€‰ï¼Œäº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (eventName) {
      <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// ================ è¾…åŠ©æ–¹æ³• ================</span>

  <span class="hljs-comment">/**
   * è®¾ç½®æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} n æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">"number"</span> || n &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"n must be a non-negative number"</span>);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = n;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} æœ€å¤§ç›‘å¬å™¨æ•°é‡
   */</span>
  <span class="hljs-title function_">getMaxListeners</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} ç›‘å¬å™¨æ•°é‡
   */</span>
  <span class="hljs-title function_">listenerCount</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-property">length</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string[]</span>} äº‹ä»¶åç§°æ•°ç»„
   */</span>
  <span class="hljs-title function_">eventNames</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>);
  }

  <span class="hljs-comment">/**
   * è·å–æŒ‡å®šäº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function[]</span>} ç›‘å¬å™¨æ•°ç»„
   */</span>
  <span class="hljs-title function_">listeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> [];
    }
    <span class="hljs-comment">// è¿”å›å‰¯æœ¬ï¼Œé¿å…å¤–éƒ¨ä¿®æ”¹å†…éƒ¨æ•°ç»„</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-title function_">slice</span>();
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ç›‘å¬å™¨åˆ°æ•°ç»„å¼€å¤´
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">prependListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ä¸€æ¬¡æ€§ç›‘å¬å™¨åˆ°æ•°ç»„å¼€å¤´
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">prependOnceListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * å†…éƒ¨æ–¹æ³•ï¼šæ·»åŠ ç›‘å¬å™¨
   * <span class="hljs-doctag">@private</span>
   */</span>
  <span class="hljs-title function_">_addListener</span>(<span class="hljs-params">eventName, listener, once = <span class="hljs-literal">false</span>, prepend = <span class="hljs-literal">false</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> listener !== <span class="hljs-string">"function"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"listener must be a function"</span>);
    }

    <span class="hljs-comment">// åˆå§‹åŒ–äº‹ä»¶æ•°ç»„</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];

    <span class="hljs-comment">// æ£€æŸ¥æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> !== <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
        <span class="hljs-string">`MaxListenersExceededWarning: Possible EventEmitter memory leak detected. `</span> +
          <span class="hljs-string">`<span class="hljs-subst">${listeners.length}</span> <span class="hljs-subst">${eventName}</span> listeners added. `</span> +
          <span class="hljs-string">`Use emitter.setMaxListeners() to increase limit`</span>
      );
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯ onceï¼Œåˆ›å»ºåŒ…è£…å‡½æ•°</span>
    <span class="hljs-keyword">let</span> listenerToAdd = listener;
    <span class="hljs-keyword">if</span> (once) {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        <span class="hljs-comment">// æ ‡è®°ä¸º once åŒ…è£…å‡½æ•°</span>
        onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
      };
      <span class="hljs-comment">// ä¿å­˜åŸå§‹ç›‘å¬å™¨å¼•ç”¨ï¼Œç”¨äºç§»é™¤</span>
      onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
      listenerToAdd = onceWrapper;
    }

    <span class="hljs-comment">// æ·»åŠ åˆ°æ•°ç»„å¼€å¤´æˆ–ç»“å°¾</span>
    <span class="hljs-keyword">if</span> (prepend) {
      listeners.<span class="hljs-title function_">unshift</span>(listenerToAdd);
    } <span class="hljs-keyword">else</span> {
      listeners.<span class="hljs-title function_">push</span>(listenerToAdd);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">/**
   * å†…éƒ¨æ–¹æ³•ï¼šç§»é™¤ç›‘å¬å™¨
   * <span class="hljs-doctag">@private</span>
   */</span>
  <span class="hljs-title function_">_removeListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];

    <span class="hljs-comment">// æŸ¥æ‰¾è¦ç§»é™¤çš„ç›‘å¬å™¨</span>
    <span class="hljs-comment">// éœ€è¦è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š</span>
    <span class="hljs-comment">// 1. ç›´æ¥ä¼ å…¥ç›‘å¬å™¨</span>
    <span class="hljs-comment">// 2. ä¼ å…¥ once åŒ…è£…å‡½æ•°çš„åŸå§‹ç›‘å¬å™¨</span>
    <span class="hljs-keyword">let</span> index = -<span class="hljs-number">1</span>;

    <span class="hljs-comment">// å°è¯•ç›´æ¥æŸ¥æ‰¾</span>
    index = listeners.<span class="hljs-title function_">indexOf</span>(listener);

    <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŸå§‹ç›‘å¬å™¨</span>
    <span class="hljs-keyword">if</span> (index === -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; listeners.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> current = listeners[i];
        <span class="hljs-keyword">if</span> (current.<span class="hljs-property">_originalListener</span> === listener) {
          index = i;
          <span class="hljs-keyword">break</span>;
        }
      }
    }

    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
      listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);

      <span class="hljs-comment">// å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œåˆ é™¤äº‹ä»¶</span>
      <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
}
</code></pre>
<h5 data-id="heading-9">3.2 ç±»å‹å®‰å…¨çš„TypeScriptç‰ˆæœ¬</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Listener</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">OnceWrapper</span> = <span class="hljs-title class_">Listener</span> &amp; { _originalListener?: <span class="hljs-title class_">Listener</span>; _once?: <span class="hljs-built_in">boolean</span> };

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_events</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Listener</span>[]&gt; = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_maxListeners</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
    
    <span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•</span>
    <span class="hljs-title function_">on</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>);
    }
    
    <span class="hljs-title function_">addListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">once</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, ...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) {
            <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'error'</span>) {
                <span class="hljs-keyword">const</span> error = args[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">throw</span> error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? error : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Unhandled error event'</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">const</span> listenersCopy = listeners.<span class="hljs-title function_">slice</span>();
        <span class="hljs-keyword">let</span> called = <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
                <span class="hljs-keyword">const</span> onceWrapper = listener <span class="hljs-keyword">as</span> <span class="hljs-title class_">OnceWrapper</span>;
                <span class="hljs-keyword">if</span> (onceWrapper.<span class="hljs-property">_once</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
                }
                
                listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
                called = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error);
                }
            }
        }
        
        <span class="hljs-keyword">return</span> called;
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeListener</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">removeListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">removeAllListeners</span>(eventName?: <span class="hljs-built_in">string</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (eventName) {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">'number'</span> || n &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'n must be a non-negative number'</span>);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = n;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-title function_">getMaxListeners</span>(): <span class="hljs-built_in">number</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span>;
    }
    
    <span class="hljs-title function_">listenerCount</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">number</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">return</span> listeners ? listeners.<span class="hljs-property">length</span> : <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-title function_">eventNames</span>(): <span class="hljs-built_in">string</span>[] {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>);
    }
    
    <span class="hljs-title function_">listeners</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Listener</span>[] {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">return</span> listeners ? listeners.<span class="hljs-title function_">slice</span>() : [];
    }
    
    <span class="hljs-title function_">prependListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-title function_">prependOnceListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_addListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>, <span class="hljs-attr">once</span>: <span class="hljs-built_in">boolean</span>, <span class="hljs-attr">prepend</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> listener !== <span class="hljs-string">'function'</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'listener must be a function'</span>);
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        
        <span class="hljs-comment">// æ£€æŸ¥æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> !== <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`MaxListenersExceededWarning for event <span class="hljs-subst">${eventName}</span>`</span>);
        }
        
        <span class="hljs-keyword">let</span> <span class="hljs-attr">listenerToAdd</span>: <span class="hljs-title class_">Listener</span> = listener;
        
        <span class="hljs-keyword">if</span> (once) {
            <span class="hljs-keyword">const</span> <span class="hljs-attr">onceWrapper</span>: <span class="hljs-title class_">OnceWrapper</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> {
                listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
                onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
            };
            onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
            listenerToAdd = onceWrapper;
        }
        
        <span class="hljs-keyword">if</span> (prepend) {
            listeners.<span class="hljs-title function_">unshift</span>(listenerToAdd);
        } <span class="hljs-keyword">else</span> {
            listeners.<span class="hljs-title function_">push</span>(listenerToAdd);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_removeListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-keyword">let</span> index = listeners.<span class="hljs-title function_">indexOf</span>(listener);
        
        <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŸå§‹ç›‘å¬å™¨</span>
        <span class="hljs-keyword">if</span> (index === -<span class="hljs-number">1</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; listeners.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-keyword">const</span> current = listeners[i] <span class="hljs-keyword">as</span> <span class="hljs-title class_">OnceWrapper</span>;
                <span class="hljs-keyword">if</span> (current.<span class="hljs-property">_originalListener</span> === listener) {
                    index = i;
                    <span class="hljs-keyword">break</span>;
                }
            }
        }
        
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
}
</code></pre>
<h4 data-id="heading-10">å››ã€æµ‹è¯•ç”¨ä¾‹</h4>
<h5 data-id="heading-11">4.1 åŸºç¡€åŠŸèƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== EventEmitter åŸºç¡€åŠŸèƒ½æµ‹è¯• ==="</span>);

<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•1: åŸºæœ¬è®¢é˜…å’Œè§¦å‘</span>
<span class="hljs-keyword">let</span> test1Count = <span class="hljs-number">0</span>;
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•1 - æ”¶åˆ°æ•°æ®:"</span>, data);
  test1Count++;
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// æµ‹è¯•1 - æ”¶åˆ°æ•°æ®: Hello</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-string">"World"</span>); <span class="hljs-comment">// æµ‹è¯•1 - æ”¶åˆ°æ•°æ®: World</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•1 - è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test1Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•1 - è°ƒç”¨æ¬¡æ•°: 2</span>

<span class="hljs-comment">// æµ‹è¯•2: å¤šä¸ªç›‘å¬å™¨</span>
<span class="hljs-keyword">let</span> test2Result = [];
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  test2Result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`listener1: <span class="hljs-subst">${data}</span>`</span>);
});
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  test2Result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`listener2: <span class="hljs-subst">${data.toUpperCase()}</span>`</span>);
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-string">"hello"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•2 - å¤šä¸ªç›‘å¬å™¨:"</span>, test2Result); <span class="hljs-comment">// æµ‹è¯•2 - å¤šä¸ªç›‘å¬å™¨: [ 'listener1: hello', 'listener2: HELLO' ]</span>

<span class="hljs-comment">// æµ‹è¯•3: å–æ¶ˆè®¢é˜…</span>
<span class="hljs-keyword">let</span> test3Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test3Listener</span> = (<span class="hljs-params"/>) =&gt; {
  test3Count++;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•3 - ç›‘å¬å™¨è¢«è°ƒç”¨"</span>);
};

emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test3"</span>, test3Listener);
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test3"</span>); <span class="hljs-comment">// æµ‹è¯•3 - ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">off</span>(<span class="hljs-string">"test3"</span>, test3Listener);
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test3"</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•3 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test3Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•3 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: 1</span>

<span class="hljs-comment">// æµ‹è¯•4: once æ–¹æ³•</span>
<span class="hljs-keyword">let</span> test4Count = <span class="hljs-number">0</span>;
emitter.<span class="hljs-title function_">once</span>(<span class="hljs-string">"test4"</span>, <span class="hljs-function">() =&gt;</span> {
  test4Count++;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨"</span>);
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•4 - once è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test4Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•4 - once è°ƒç”¨æ¬¡æ•°: 2</span>

<span class="hljs-comment">// æµ‹è¯•5: é”™è¯¯å¤„ç†</span>
<span class="hljs-keyword">let</span> errorCaught = <span class="hljs-literal">false</span>;
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"error"</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  errorCaught = <span class="hljs-literal">true</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•5 - æ•è·åˆ°é”™è¯¯:"</span>, error.<span class="hljs-property">message</span>);
});

emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test5"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"æµ‹è¯•é”™è¯¯"</span>); <span class="hljs-comment">// æµ‹è¯•5 - æ•è·åˆ°é”™è¯¯: æµ‹è¯•é”™è¯¯</span>
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test5"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•5 - é”™è¯¯æ˜¯å¦è¢«æ•è·: <span class="hljs-subst">${errorCaught}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•5 - é”™è¯¯æ˜¯å¦è¢«æ•è·: true</span>
</code></pre>
<h5 data-id="heading-12">4.2 é«˜çº§åŠŸèƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n=== EventEmitter é«˜çº§åŠŸèƒ½æµ‹è¯• ==="</span>);

<span class="hljs-keyword">const</span> emitter2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•6: prependListener æ–¹æ³•</span>
<span class="hljs-keyword">let</span> test6Order = [];
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"normal1"</span>));
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"normal2"</span>));
emitter2.<span class="hljs-title function_">prependListener</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"prepended"</span>));

emitter2.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test6"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•6 - ç›‘å¬å™¨é¡ºåº:"</span>, test6Order);
<span class="hljs-comment">// æµ‹è¯•6 - ç›‘å¬å™¨é¡ºåº: [ 'prepended', 'normal1', 'normal2' ]</span>

<span class="hljs-comment">// æµ‹è¯•7: æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
emitter2.<span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•7 - æœ€å¤§ç›‘å¬å™¨æ•°: <span class="hljs-subst">${emitter2.getMaxListeners()}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•7 - æœ€å¤§ç›‘å¬å™¨æ•°: 2</span>

emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});
<span class="hljs-comment">// ç¬¬ä¸‰ä¸ªåº”è¯¥è§¦å‘è­¦å‘Š</span>
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});

<span class="hljs-comment">// æµ‹è¯•8: è·å–ç›‘å¬å™¨ä¿¡æ¯</span>
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">once</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - ç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${emitter2.listenerCount(<span class="hljs-string">"test8"</span>)}</span>`</span>); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - ç›‘å¬å™¨æ•°ç»„é•¿åº¦: <span class="hljs-subst">${emitter2.listeners(<span class="hljs-string">"test8"</span>).length}</span>`</span>); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - äº‹ä»¶åç§°: <span class="hljs-subst">${emitter2.eventNames()}</span>`</span>); <span class="hljs-comment">// ['test6', 'test7', 'test8']</span>

<span class="hljs-comment">// æµ‹è¯•9: removeAllListeners</span>
emitter2.<span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-string">"test8"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•9 - ç§»é™¤åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${emitter2.listenerCount(<span class="hljs-string">"test8"</span>)}</span>`</span>); <span class="hljs-comment">// 0</span>

<span class="hljs-comment">// æµ‹è¯•10: é“¾å¼è°ƒç”¨</span>
emitter2
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"test10"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•10 - é“¾å¼è°ƒç”¨1"</span>))
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"test10"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•10 - é“¾å¼è°ƒç”¨2"</span>))
  .<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test10"</span>);
</code></pre>
<h5 data-id="heading-13">4.3 è¾¹ç•Œæƒ…å†µæµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n=== EventEmitter è¾¹ç•Œæƒ…å†µæµ‹è¯• ==='</span>);

<span class="hljs-keyword">const</span> emitter3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•11: é‡å¤æ·»åŠ ç›¸åŒç›‘å¬å™¨</span>
<span class="hljs-keyword">let</span> test11Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test11Listener</span> = (<span class="hljs-params"/>) =&gt; test11Count++;

emitter3.<span class="hljs-title function_">on</span>(<span class="hljs-string">'test11'</span>, test11Listener);
emitter3.<span class="hljs-title function_">on</span>(<span class="hljs-string">'test11'</span>, test11Listener); <span class="hljs-comment">// é‡å¤æ·»åŠ </span>

emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test11'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•11 - é‡å¤ç›‘å¬å™¨è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test11Count}</span>`</span>); <span class="hljs-comment">// 2</span>

<span class="hljs-comment">// æµ‹è¯•12: ç§»é™¤ä¸å­˜åœ¨çš„ç›‘å¬å™¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fakeListener</span> = (<span class="hljs-params"/>) =&gt; {};
emitter3.<span class="hljs-title function_">off</span>(<span class="hljs-string">'nonexistent'</span>, fakeListener); <span class="hljs-comment">// åº”è¯¥ä¸æŠ¥é”™</span>

<span class="hljs-comment">// æµ‹è¯•13: è§¦å‘æ²¡æœ‰ç›‘å¬å™¨çš„äº‹ä»¶</span>
<span class="hljs-keyword">const</span> result = emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'nonexistent'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•13 - è§¦å‘æ— ç›‘å¬å™¨äº‹ä»¶è¿”å›å€¼: <span class="hljs-subst">${result}</span>`</span>); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// æµ‹è¯•14: é”™è¯¯äº‹ä»¶å¤„ç†</span>
<span class="hljs-keyword">try</span> {
    emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æœªå¤„ç†çš„é”™è¯¯'</span>));
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•14 - æ•è·æœªå¤„ç†çš„é”™è¯¯: <span class="hljs-subst">${error.message}</span>`</span>);
}

<span class="hljs-comment">// æµ‹è¯•15: once ç›‘å¬å™¨ç§»é™¤åå†æ¬¡è§¦å‘</span>
<span class="hljs-keyword">let</span> test15Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test15Listener</span> = (<span class="hljs-params"/>) =&gt; {
    test15Count++;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•15 - ç¬¬ <span class="hljs-subst">${test15Count}</span> æ¬¡è°ƒç”¨`</span>);
};

<span class="hljs-keyword">const</span> removeOnce = emitter3.<span class="hljs-title function_">once</span>(<span class="hljs-string">'test15'</span>, test15Listener);
emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test15'</span>); <span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-title function_">removeOnce</span>(); <span class="hljs-comment">// æ‰‹åŠ¨ç§»é™¤</span>
emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test15'</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•15 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test15Count}</span>`</span>); <span class="hljs-comment">// 1</span>
</code></pre>
<h5 data-id="heading-14">4.4 æ€§èƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n=== EventEmitter æ€§èƒ½æµ‹è¯• ==='</span>);

<span class="hljs-keyword">const</span> performanceEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();
<span class="hljs-keyword">const</span> iterations = <span class="hljs-number">100000</span>;

<span class="hljs-comment">// å‡†å¤‡æµ‹è¯•æ•°æ®</span>
<span class="hljs-keyword">const</span> listeners = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    listeners.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {});
}

<span class="hljs-comment">// æµ‹è¯•æ·»åŠ ç›‘å¬å™¨çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'æ·»åŠ ç›‘å¬å™¨'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'performance'</span>, listeners[i % listeners.<span class="hljs-property">length</span>]);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'æ·»åŠ ç›‘å¬å™¨'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ·»åŠ åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${performanceEmitter.listenerCount(<span class="hljs-string">'performance'</span>)}</span>`</span>);

<span class="hljs-comment">// æµ‹è¯•è§¦å‘äº‹ä»¶çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'è§¦å‘äº‹ä»¶'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'performance'</span>, i);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'è§¦å‘äº‹ä»¶'</span>);

<span class="hljs-comment">// æµ‹è¯•ç§»é™¤ç›‘å¬å™¨çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'ç§»é™¤ç›‘å¬å™¨'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">off</span>(<span class="hljs-string">'performance'</span>, listeners[i % listeners.<span class="hljs-property">length</span>]);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'ç§»é™¤ç›‘å¬å™¨'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç§»é™¤åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${performanceEmitter.listenerCount(<span class="hljs-string">'performance'</span>)}</span>`</span>);
</code></pre>
<h4 data-id="heading-15">äº”ã€EventEmitterçš„æ ¸å¿ƒåŸç†åˆ†æ</h4>
<h5 data-id="heading-16">51 æ•°æ®ç»“æ„è®¾è®¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// EventEmitter çš„æ ¸å¿ƒæ•°æ®ç»“æ„</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä½¿ç”¨æ™®é€šå¯¹è±¡è€Œä¸æ˜¯ Map çš„åŸå› ï¼š</span>
        <span class="hljs-comment">// 1. åœ¨ V8 ä¸­ï¼Œæ™®é€šå¯¹è±¡æ€§èƒ½æ›´å¥½</span>
        <span class="hljs-comment">// 2. äº‹ä»¶åé€šå¸¸æ˜¯å­—ç¬¦ä¸²ï¼Œé€‚åˆä½œä¸ºå¯¹è±¡é”®</span>
        <span class="hljs-comment">// 3. Object.create(null) åˆ›å»ºæ²¡æœ‰åŸå‹çš„å¯¹è±¡ï¼Œé¿å…åŸå‹æ±¡æŸ“</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        
        <span class="hljs-comment">// æ¯ä¸ªäº‹ä»¶å¯¹åº”ä¸€ä¸ªç›‘å¬å™¨æ•°ç»„</span>
        <span class="hljs-comment">// {</span>
        <span class="hljs-comment">//   'event1': [listener1, listener2, ...],</span>
        <span class="hljs-comment">//   'event2': [listener3, listener4, ...]</span>
        <span class="hljs-comment">// }</span>
    }
}
</code></pre>
<h5 data-id="heading-17">5.2 once æ–¹æ³•çš„å®ç°åŸç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// once æ–¹æ³•çš„å®ç°ç»†èŠ‚</span>
<span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-comment">// åˆ›å»ºåŒ…è£…å‡½æ•°</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
        <span class="hljs-comment">// 1. æ‰§è¡ŒåŸå§‹ç›‘å¬å™¨</span>
        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        
        <span class="hljs-comment">// 2. æ ‡è®°ä¸ºå·²æ‰§è¡Œ</span>
        onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
        
        <span class="hljs-comment">// 3. åœ¨ emit ä¸­æ£€æµ‹åˆ°è¿™ä¸ªæ ‡è®°åä¼šç§»é™¤ç›‘å¬å™¨</span>
    };
    
    <span class="hljs-comment">// ä¿å­˜åŸå§‹ç›‘å¬å™¨å¼•ç”¨ï¼Œç”¨äº off æ–¹æ³•</span>
    onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
    
    <span class="hljs-comment">// æ·»åŠ åˆ°ç›‘å¬å™¨æ•°ç»„</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, onceWrapper, <span class="hljs-literal">false</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}

<span class="hljs-comment">// emit æ–¹æ³•ä¸­å¤„ç† once ç›‘å¬å™¨</span>
<span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
        <span class="hljs-keyword">if</span> (listener.<span class="hljs-property">_once</span>) {
            <span class="hljs-comment">// ç§»é™¤ç›‘å¬å™¨</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
        }
        <span class="hljs-comment">// ...</span>
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h5 data-id="heading-18">5.3 å†…å­˜ç®¡ç†ç­–ç•¥</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¿å…å†…å­˜æ³„æ¼çš„å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-comment">// è·Ÿè¸ªæ‰€æœ‰è®¢é˜…ï¼Œä¾¿äºæ¸…ç†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
    }
    
    <span class="hljs-title function_">safeOn</span>(<span class="hljs-params">eventName, listener, context = <span class="hljs-literal">null</span></span>) {
        <span class="hljs-comment">// ç»‘å®šä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">const</span> boundListener = context ? listener.<span class="hljs-title function_">bind</span>(context) : listener;
        
        <span class="hljs-comment">// å­˜å‚¨å…ƒæ•°æ®</span>
        <span class="hljs-keyword">const</span> meta = {
            eventName,
            <span class="hljs-attr">originalListener</span>: listener,
            boundListener,
            <span class="hljs-attr">unsubscribe</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener)
        };
        
        <span class="hljs-comment">// ä½¿ç”¨ WeakMap å­˜å‚¨ï¼Œä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span>.<span class="hljs-title function_">set</span>(listener, meta);
        
        <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, boundListener);
        
        <span class="hljs-comment">// è¿”å›å¢å¼ºçš„å–æ¶ˆè®¢é˜…å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span>.<span class="hljs-title function_">delete</span>(listener);
        };
    }
}
</code></pre>
<h4 data-id="heading-19">å…­ã€å¸¸è§é¢è¯•é¢˜å®ç°</h4>
<h5 data-id="heading-20">6.1 å®ç°ä¸€ä¸ªç®€å•çš„ EventBus</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€äº‹ä»¶æ€»çº¿ï¼ˆç±»ä¼¼ Vue ä¸­çš„ EventBusï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-comment">// å•ä¾‹æ¨¡å¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span>) {
            <span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventBus</span>();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span>;
    }
    
    $on(event, callback) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event] = [];
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">push</span>(callback);
    }
    
    $emit(event, ...args) {
        <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event];
        <span class="hljs-keyword">if</span> (!callbacks) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨ slice åˆ›å»ºå‰¯æœ¬ï¼Œé¿å…è¿­ä»£æ—¶ä¿®æ”¹æ•°ç»„</span>
        callbacks.<span class="hljs-title function_">slice</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-title function_">callback</span>(...args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventBus error in <span class="hljs-subst">${event}</span>:`</span>, error);
            }
        });
    }
    
    $off(event, callback) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event]) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-keyword">if</span> (callback) {
            <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">indexOf</span>(callback);
            <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event];
        }
    }
    
    $once(event, callback) {
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
            <span class="hljs-title function_">callback</span>(...args);
            <span class="hljs-variable language_">this</span>.$off(event, onceWrapper);
        };
        <span class="hljs-variable language_">this</span>.$on(event, onceWrapper);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> bus = <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">getInstance</span>();

<span class="hljs-comment">// ç»„ä»¶ A</span>
bus.$on(<span class="hljs-string">'user-login'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶A: ç”¨æˆ·ç™»å½•'</span>, user.<span class="hljs-property">name</span>);
});

<span class="hljs-comment">// ç»„ä»¶ B</span>
bus.$on(<span class="hljs-string">'user-login'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶B: æ›´æ–°ç”¨æˆ·ä¿¡æ¯'</span>, user.<span class="hljs-property">id</span>);
});

<span class="hljs-comment">// ç™»å½•æˆåŠŸå</span>
bus.$emit(<span class="hljs-string">'user-login'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> });
</code></pre>
<h5 data-id="heading-21">6.2 å®ç°å¸¦å‘½åç©ºé—´çš„äº‹ä»¶ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NamespacedEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span> = <span class="hljs-string">':'</span>;
    }
    
    <span class="hljs-comment">// è§£æäº‹ä»¶åï¼Œæ”¯æŒå‘½åç©ºé—´</span>
    <span class="hljs-title function_">_parseEvent</span>(<span class="hljs-params">eventString</span>) {
        <span class="hljs-keyword">const</span> parts = eventString.<span class="hljs-title function_">split</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span>);
        <span class="hljs-keyword">if</span> (parts.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">namespace</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">event</span>: parts[<span class="hljs-number">0</span>] };
        }
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">namespace</span>: parts[<span class="hljs-number">0</span>], <span class="hljs-attr">event</span>: parts.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span>) };
    }
    
    <span class="hljs-comment">// ç”Ÿæˆå®Œæ•´çš„äº‹ä»¶é”®</span>
    <span class="hljs-title function_">_getEventKey</span>(<span class="hljs-params">namespace, event</span>) {
        <span class="hljs-keyword">return</span> namespace ? <span class="hljs-string">`<span class="hljs-subst">${namespace}</span><span class="hljs-subst">${<span class="hljs-variable language_">this</span>._separator}</span><span class="hljs-subst">${event}</span>`</span> : event;
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventString, listener</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey] = [];
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey].<span class="hljs-title function_">push</span>({
            listener,
            namespace,
            event
        });
        
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventString, listener);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventString, ...args</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        
        <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰åŒ¹é…çš„ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> listenersToCall = [];
        
        <span class="hljs-comment">// å¦‚æœæŒ‡å®šäº†å‘½åç©ºé—´ï¼Œåªè§¦å‘è¯¥å‘½åç©ºé—´çš„äº‹ä»¶</span>
        <span class="hljs-keyword">if</span> (namespace) {
            <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
                listenersToCall.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æŒ‡å®šå‘½åç©ºé—´ï¼Œè§¦å‘æ‰€æœ‰åŒ¹é…çš„äº‹ä»¶</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventKey <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listenerInfo <span class="hljs-keyword">of</span> listeners) {
                    <span class="hljs-keyword">if</span> (listenerInfo.<span class="hljs-property">event</span> === event) {
                        listenersToCall.<span class="hljs-title function_">push</span>(listenerInfo);
                    }
                }
            }
        }
        
        <span class="hljs-comment">// æ‰§è¡Œç›‘å¬å™¨</span>
        listenersToCall.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ listener }</span>) =&gt;</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-title function_">listener</span>(...args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in <span class="hljs-subst">${eventString}</span>:`</span>, error);
            }
        });
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventString, listener</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        
        <span class="hljs-keyword">if</span> (namespace) {
            <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">const</span> index = listeners.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">listener</span> === listener);
                <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                    listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                    }
                }
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç§»é™¤æ‰€æœ‰å‘½åç©ºé—´ä¸‹çš„äº‹ä»¶</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventKey <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = listeners.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
                    <span class="hljs-keyword">if</span> (listeners[i].<span class="hljs-property">listener</span> === listener &amp;&amp; listeners[i].<span class="hljs-property">event</span> === event) {
                        listeners.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
                    }
                }
                <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                }
            }
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> nsEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NamespacedEventEmitter</span>();

nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·æ¨¡å—: ç™»å½•'</span>));
nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'admin:login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç®¡ç†å‘˜æ¨¡å—: ç™»å½•'</span>));
nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¨å±€: ç™»å½•'</span>));

nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:login'</span>);    <span class="hljs-comment">// åªè¾“å‡º: ç”¨æˆ·æ¨¡å—: ç™»å½•</span>
nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'admin:login'</span>);   <span class="hljs-comment">// åªè¾“å‡º: ç®¡ç†å‘˜æ¨¡å—: ç™»å½•</span>
nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'login'</span>);         <span class="hljs-comment">// è¾“å‡ºæ‰€æœ‰</span>
</code></pre>
<h5 data-id="heading-22">6.3 å®ç°æ”¯æŒå¼‚æ­¥ç›‘å¬å™¨çš„ EventEmitter</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-comment">/**
     * å¼‚æ­¥è§¦å‘äº‹ä»¶ï¼Œç­‰å¾…æ‰€æœ‰ç›‘å¬å™¨å®Œæˆ
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">emitAsync</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listeners</span>(eventName);
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> promises = listeners.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">async</span> (listener) =&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› Promiseï¼Œç­‰å¾…å®ƒå®Œæˆ</span>
                <span class="hljs-keyword">if</span> (result &amp;&amp; <span class="hljs-keyword">typeof</span> result.<span class="hljs-property">then</span> === <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">await</span> result;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emitAsync</span>(<span class="hljs-string">'error'</span>, error);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">throw</span> error;
                }
            }
        });
        
        <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
    }
    
    <span class="hljs-comment">/**
     * é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼ˆä¸€ä¸ªæ¥ä¸€ä¸ªï¼‰
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">emitSeries</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listeners</span>(eventName);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listeners) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› Promiseï¼Œç­‰å¾…å®ƒå®Œæˆ</span>
                <span class="hljs-keyword">if</span> (result &amp;&amp; <span class="hljs-keyword">typeof</span> result.<span class="hljs-property">then</span> === <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">await</span> result;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emitSeries</span>(<span class="hljs-string">'error'</span>, error);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">throw</span> error;
                }
            }
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> asyncEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncEventEmitter</span>();

asyncEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†å®Œæˆ:'</span>, data);
});

asyncEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªç›‘å¬å™¨:'</span>, data);
});

asyncEmitter.<span class="hljs-title function_">emitAsync</span>(<span class="hljs-string">'process'</span>, <span class="hljs-string">'æµ‹è¯•æ•°æ®'</span>);
</code></pre>
<h5 data-id="heading-23">6.5 å®ç°æ”¯æŒä¼˜å…ˆçº§çš„ EventEmitter</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_defaultPriority</span> = <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener, priority = <span class="hljs-variable language_">this</span>._defaultPriority</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        listeners.<span class="hljs-title function_">push</span>({ listener, priority });
        
        <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰</span>
        listeners.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">priority</span> - b.<span class="hljs-property">priority</span>);
        
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// éå†å·²æ’åºçš„ç›‘å¬å™¨</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { listener } <span class="hljs-keyword">of</span> listeners) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› falseï¼Œåœæ­¢åç»­ç›‘å¬å™¨çš„æ‰§è¡Œ</span>
                <span class="hljs-keyword">if</span> (result === <span class="hljs-literal">false</span>) {
                    <span class="hljs-keyword">break</span>;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in <span class="hljs-subst">${eventName}</span>:`</span>, error);
            }
        }
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-keyword">const</span> index = listeners.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">listener</span> === listener);
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> priorityEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityEventEmitter</span>();

priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 10'</span>), <span class="hljs-number">10</span>);
priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 0'</span>), <span class="hljs-number">0</span>);
priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 5'</span>), <span class="hljs-number">5</span>);

priorityEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'process'</span>);
<span class="hljs-comment">// è¾“å‡ºé¡ºåº: ä¼˜å…ˆçº§ 0, ä¼˜å…ˆçº§ 5, ä¼˜å…ˆçº§ 10</span>
</code></pre>
<h4 data-id="heading-24">ä¸ƒã€å®é™…åº”ç”¨åœºæ™¯</h4>
<h5 data-id="heading-25">7.1 åœ¨ Vue ä¸­å®ç°ç»„ä»¶é€šä¿¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€äº‹ä»¶æ€»çº¿</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EventBus</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-comment">// ComponentA.vue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user-updated'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUserUpdate</span>);
    },
    <span class="hljs-attr">methods</span>: {
        <span class="hljs-title function_">handleUserUpdate</span>(<span class="hljs-params">user</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·æ›´æ–°:'</span>, user);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = user;
        }
    },
    <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'user-updated'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUserUpdate</span>);
    }
};

<span class="hljs-comment">// ComponentB.vue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">methods</span>: {
        <span class="hljs-title function_">updateUser</span>(<span class="hljs-params"/>) {
            <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user-updated'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span> });
        }
    }
};

<span class="hljs-comment">// æˆ–è€…åœ¨ Vue åŸå‹ä¸Šæ·»åŠ </span>
<span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$bus</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'event'</span>, handler);
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'event'</span>, data);
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'event'</span>, handler);
</code></pre>
<h5 data-id="heading-26">7.2 åœ¨ Express ä¸­å®ç°äº‹ä»¶é©±åŠ¨æ¶æ„</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EventEmitter</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./EventEmitter'</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppEvents</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEvents</span>();
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å®šä¹‰åº”ç”¨çº§åˆ«äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:registered'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–°ç”¨æˆ·æ³¨å†Œ:'</span>, user.<span class="hljs-property">email</span>);
            <span class="hljs-comment">// å‘é€æ¬¢è¿é‚®ä»¶</span>
            <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·ç›®å½•</span>
            <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
        });
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'order:created'</span>, <span class="hljs-function">(<span class="hljs-params">order</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–°è®¢å•:'</span>, order.<span class="hljs-property">id</span>);
            <span class="hljs-comment">// å‘é€ç¡®è®¤é‚®ä»¶</span>
            <span class="hljs-comment">// æ›´æ–°åº“å­˜</span>
            <span class="hljs-comment">// é€šçŸ¥ç‰©æµ</span>
        });
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error, context</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åº”ç”¨é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>, context);
            <span class="hljs-comment">// å‘é€é”™è¯¯æŠ¥å‘Š</span>
            <span class="hljs-comment">// è®°å½•åˆ°ç›‘æ§ç³»ç»Ÿ</span>
        });
    }
}

<span class="hljs-comment">// åˆ›å»º Express åº”ç”¨</span>
<span class="hljs-keyword">const</span> appEvents = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppEvents</span>();
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// ä¸­é—´ä»¶ï¼šå°†äº‹ä»¶å‘å°„å™¨æ·»åŠ åˆ°è¯·æ±‚å¯¹è±¡</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
    req.<span class="hljs-property">appEvents</span> = appEvents;
    <span class="hljs-title function_">next</span>();
});

<span class="hljs-comment">// è·¯ç”±å¤„ç†</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/register'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">createUser</span>(req.<span class="hljs-property">body</span>);
    
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:registered'</span>, user);
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, user });
});

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/order'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> order = <span class="hljs-title function_">createOrder</span>(req.<span class="hljs-property">body</span>);
    
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'order:created'</span>, order);
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, order });
});

<span class="hljs-comment">// é”™è¯¯å¤„ç†ä¸­é—´ä»¶</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">error, req, res, next</span>) =&gt;</span> {
    <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error, {
        <span class="hljs-attr">url</span>: req.<span class="hljs-property">url</span>,
        <span class="hljs-attr">method</span>: req.<span class="hljs-property">method</span>,
        <span class="hljs-attr">userId</span>: req.<span class="hljs-property">user</span>?.<span class="hljs-property">id</span>
    });
    
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'Internal server error'</span> });
});
</code></pre>
<h5 data-id="heading-27">7.3 å®ç°ç®€å•çš„çŠ¶æ€ç®¡ç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableStore</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">initialState = {}</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> = initialState;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();
    }
    
    <span class="hljs-comment">// è·å–å½“å‰çŠ¶æ€</span>
    <span class="hljs-title function_">getState</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>;
    }
    
    <span class="hljs-comment">// è®¾ç½®çŠ¶æ€</span>
    <span class="hljs-title function_">setState</span>(<span class="hljs-params">updates</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>, ...updates };
        
        <span class="hljs-comment">// è§¦å‘çŠ¶æ€å˜åŒ–äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'state:changed'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span>);
        
        <span class="hljs-comment">// è§¦å‘ç‰¹å®šå±æ€§çš„å˜åŒ–äº‹ä»¶</span>
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(updates).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">`state:<span class="hljs-subst">${key}</span>:changed`</span>, updates[key], <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span>[key]);
        });
    }
    
    <span class="hljs-comment">// è®¢é˜…çŠ¶æ€å˜åŒ–</span>
    <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">callback</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'state:changed'</span>, callback);
    }
    
    <span class="hljs-comment">// è®¢é˜…ç‰¹å®šçŠ¶æ€å˜åŒ–</span>
    <span class="hljs-title function_">subscribeTo</span>(<span class="hljs-params">key, callback</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">`state:<span class="hljs-subst">${key}</span>:changed`</span>, callback);
    }
    
    <span class="hljs-comment">// æ‰¹é‡æ›´æ–°</span>
    <span class="hljs-title function_">batchUpdate</span>(<span class="hljs-params">updater</span>) {
        <span class="hljs-keyword">const</span> updates = <span class="hljs-title function_">updater</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(updates);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObservableStore</span>({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span>,
    <span class="hljs-attr">notifications</span>: []
});

<span class="hljs-comment">// è®¢é˜…çŠ¶æ€å˜åŒ–</span>
store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">newState, oldState</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çŠ¶æ€å˜åŒ–:'</span>, newState);
});

<span class="hljs-comment">// è®¢é˜…ç‰¹å®šçŠ¶æ€å˜åŒ–</span>
store.<span class="hljs-title function_">subscribeTo</span>(<span class="hljs-string">'theme'</span>, <span class="hljs-function">(<span class="hljs-params">newTheme, oldTheme</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸»é¢˜å˜åŒ–:'</span>, oldTheme, <span class="hljs-string">'-&gt;'</span>, newTheme);
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, newTheme);
});

<span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
store.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span> });
store.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> } });

<span class="hljs-comment">// æ‰¹é‡æ›´æ–°</span>
store.<span class="hljs-title function_">batchUpdate</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> ({
    <span class="hljs-attr">notifications</span>: [...state.<span class="hljs-property">notifications</span>, <span class="hljs-string">'æ–°æ¶ˆæ¯'</span>],
    <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span>
}));
</code></pre>
<h4 data-id="heading-28">å…«ã€æ€§èƒ½ä¼˜åŒ–å’Œæ³¨æ„äº‹é¡¹</h4>
<h5 data-id="heading-29">8.1 å†…å­˜æ³„æ¼é¢„é˜²</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®‰å…¨çš„ EventEmitterï¼Œè‡ªåŠ¨æ¸…ç†è®¢é˜…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-comment">// ä½¿ç”¨ WeakRef è·Ÿè¸ªç»„ä»¶å¼•ç”¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
    }
    
    <span class="hljs-comment">// ä¸ºç»„ä»¶ç»‘å®šäº‹ä»¶ï¼Œè‡ªåŠ¨æ¸…ç†</span>
    <span class="hljs-title function_">bindToComponent</span>(<span class="hljs-params">component, eventName, listener</span>) {
        <span class="hljs-comment">// åˆ›å»ºç»‘å®šå‡½æ•°</span>
        <span class="hljs-keyword">const</span> boundListener = listener.<span class="hljs-title function_">bind</span>(component);
        
        <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, boundListener);
        
        <span class="hljs-comment">// å­˜å‚¨å¼•ç”¨</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">has</span>(component)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">set</span>(component, []);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component).<span class="hljs-title function_">push</span>({ eventName, <span class="hljs-attr">listener</span>: boundListener });
        
        <span class="hljs-comment">// è¿”å›æ¸…ç†å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener);
            <span class="hljs-keyword">const</span> refs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component);
            <span class="hljs-keyword">if</span> (refs) {
                <span class="hljs-keyword">const</span> index = refs.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">ref</span> =&gt;</span> 
                    ref.<span class="hljs-property">eventName</span> === eventName &amp;&amp; ref.<span class="hljs-property">listener</span> === boundListener
                );
                <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                    refs.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
                }
            }
        };
    }
    
    <span class="hljs-comment">// æ¸…ç†ç»„ä»¶çš„æ‰€æœ‰äº‹ä»¶</span>
    <span class="hljs-title function_">cleanupComponent</span>(<span class="hljs-params">component</span>) {
        <span class="hljs-keyword">const</span> refs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component);
        <span class="hljs-keyword">if</span> (refs) {
            refs.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ eventName, listener }</span>) =&gt;</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, listener);
            });
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">delete</span>(component);
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">emitter</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span> = emitter;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç»‘å®šäº‹ä»¶ï¼Œè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ</span>
        <span class="hljs-keyword">const</span> cleanup1 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">bindToComponent</span>(
            <span class="hljs-variable language_">this</span>,
            <span class="hljs-string">'data'</span>,
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleData</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        );
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup1);
        
        <span class="hljs-keyword">const</span> cleanup2 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">bindToComponent</span>(
            <span class="hljs-variable language_">this</span>,
            <span class="hljs-string">'error'</span>,
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleError</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        );
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup2);
    }
    
    <span class="hljs-title function_">handleData</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†æ•°æ®:'</span>, data);
    }
    
    <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†é”™è¯¯:'</span>, error);
    }
    
    <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>());
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
        
        <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨è‡ªåŠ¨æ¸…ç†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">cleanupComponent</span>(<span class="hljs-variable language_">this</span>);
    }
}
</code></pre>
<h5 data-id="heading-30">8.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é«˜æ€§èƒ½ EventEmitter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HighPerformanceEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä½¿ç”¨ç©ºå¯¹è±¡ä½œä¸ºåŸå‹ï¼Œé¿å…åŸå‹é“¾æŸ¥æ‰¾</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-comment">// ç¼“å­˜ç©ºæ•°ç»„ï¼Œé¿å…é¢‘ç¹åˆ›å»º</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emptyArray</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>([]);
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-comment">// é¢„åˆ†é…æ•°ç»„ç©ºé—´</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-title function_">push</span>(listener);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„ï¼šæ²¡æœ‰ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨ for å¾ªç¯è€Œä¸æ˜¯ forEachï¼Œæ€§èƒ½æ›´å¥½</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, len = listeners.<span class="hljs-property">length</span>; i &lt; len; i++) {
            <span class="hljs-keyword">try</span> {
                listeners[i].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">const</span> errorListeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>.<span class="hljs-property">error</span>;
                    <span class="hljs-keyword">if</span> (errorListeners) {
                        <span class="hljs-comment">// é¿å…é€’å½’è°ƒç”¨</span>
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; errorListeners.<span class="hljs-property">length</span>; j++) {
                            <span class="hljs-keyword">try</span> {
                                errorListeners[j].<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, error);
                            } <span class="hljs-keyword">catch</span> (e) {
                                <span class="hljs-comment">// å¿½ç•¥é”™è¯¯å¤„ç†å‡½æ•°ä¸­çš„é”™è¯¯</span>
                            }
                        }
                    }
                }
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-comment">// ä»åå‘å‰éå†ï¼Œé¿å…æ•°ç»„ç§»åŠ¨</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = listeners.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">if</span> (listeners[i] === listener) {
                listeners.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
                <span class="hljs-keyword">break</span>;
            }
        }
        
        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ç›‘å¬å™¨äº†ï¼Œåˆ é™¤å±æ€§ï¼ˆè®© V8 ä¼˜åŒ–ï¼‰</span>
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// æ‰¹é‡æ“ä½œä¼˜åŒ–</span>
    <span class="hljs-title function_">emitMany</span>(<span class="hljs-params">eventNames, ...args</span>) {
        <span class="hljs-keyword">const</span> results = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventName <span class="hljs-keyword">of</span> eventNames) {
            results.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(eventName, ...args));
        }
        <span class="hljs-keyword">return</span> results;
    }
}
</code></pre>
<h5 data-id="heading-31">8,3 è°ƒè¯•å’Œç›‘æ§</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯ç›‘æ§çš„ EventEmitter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MonitoredEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span> = {
            <span class="hljs-attr">enabled</span>: options.<span class="hljs-property">enabled</span> !== <span class="hljs-literal">false</span>,
            <span class="hljs-attr">emitCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">listenerCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">eventStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">errorStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">slowListeners</span>: []
        };
        
        <span class="hljs-comment">// æ€§èƒ½ç›‘æ§é˜ˆå€¼ï¼ˆæ¯«ç§’ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_slowThreshold</span> = options.<span class="hljs-property">slowThreshold</span> || <span class="hljs-number">100</span>;
    }
    
    <span class="hljs-comment">// é‡å†™ emit æ–¹æ³•ä»¥æ”¶é›†ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">enabled</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">emit</span>(eventName, ...args);
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">emitCount</span>++;
        
        <span class="hljs-comment">// æ›´æ–°äº‹ä»¶ç»Ÿè®¡</span>
        <span class="hljs-keyword">const</span> eventStat = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">eventStats</span>.<span class="hljs-title function_">get</span>(eventName) || {
            <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">lastEmitted</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">avgDuration</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">maxDuration</span>: <span class="hljs-number">0</span>
        };
        
        eventStat.<span class="hljs-property">count</span>++;
        eventStat.<span class="hljs-property">lastEmitted</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
        
        <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">emit</span>(eventName, ...args);
        <span class="hljs-keyword">const</span> duration = performance.<span class="hljs-title function_">now</span>() - startTime;
        
        <span class="hljs-comment">// æ›´æ–°æ€§èƒ½ç»Ÿè®¡</span>
        eventStat.<span class="hljs-property">avgDuration</span> = 
            (eventStat.<span class="hljs-property">avgDuration</span> * (eventStat.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>) + duration) / eventStat.<span class="hljs-property">count</span>;
        eventStat.<span class="hljs-property">maxDuration</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(eventStat.<span class="hljs-property">maxDuration</span>, duration);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">eventStats</span>.<span class="hljs-title function_">set</span>(eventName, eventStat);
        
        <span class="hljs-comment">// è®°å½•æ…¢ç›‘å¬å™¨</span>
        <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_slowThreshold</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">push</span>({
                eventName,
                duration,
                <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
                <span class="hljs-attr">args</span>: args.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) <span class="hljs-comment">// åªè®°å½•å‰ä¸‰ä¸ªå‚æ•°</span>
            });
            
            <span class="hljs-comment">// ä¿æŒæ…¢ç›‘å¬å™¨è®°å½•çš„æ•°é‡</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">100</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">shift</span>();
            }
        }
        
        <span class="hljs-keyword">return</span> result;
    }
    
    <span class="hljs-comment">// è·å–ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">getMonitoringData</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
            ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>,
            <span class="hljs-attr">currentListeners</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getListenersCount</span>(),
            <span class="hljs-attr">eventNames</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">eventNames</span>(),
            <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
        };
    }
    
    <span class="hljs-comment">// é‡ç½®ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">resetMonitoring</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span> = {
            <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">emitCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">listenerCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">eventStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">errorStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">slowListeners</span>: []
        };
    }
    
    <span class="hljs-comment">// ç”Ÿæˆç›‘æ§æŠ¥å‘Š</span>
    <span class="hljs-title function_">generateReport</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMonitoringData</span>();
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== EventEmitter ç›‘æ§æŠ¥å‘Š ==='</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¿è¡Œæ—¶é—´: <span class="hljs-subst">${data.timestamp.toISOString()}</span>`</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ€»è§¦å‘æ¬¡æ•°: <span class="hljs-subst">${data.emitCount}</span>`</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ´»è·ƒäº‹ä»¶æ•°é‡: <span class="hljs-subst">${data.eventNames.length}</span>`</span>);
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\näº‹ä»¶ç»Ÿè®¡:'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [eventName, stat] <span class="hljs-keyword">of</span> data.<span class="hljs-property">eventStats</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  <span class="hljs-subst">${eventName}</span>:`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    è§¦å‘æ¬¡æ•°: <span class="hljs-subst">${stat.count}</span>`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    å¹³å‡è€—æ—¶: <span class="hljs-subst">${stat.avgDuration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    æœ€å¤§è€—æ—¶: <span class="hljs-subst">${stat.maxDuration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    æœ€åè§¦å‘: <span class="hljs-subst">${stat.lastEmitted.toISOString()}</span>`</span>);
        }
        
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">slowListeners</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\næ…¢ç›‘å¬å™¨è­¦å‘Š:'</span>);
            data.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>. <span class="hljs-subst">${item.eventName}</span> - <span class="hljs-subst">${item.duration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            });
        }
        
        <span class="hljs-keyword">return</span> data;
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼šè·å–ç›‘å¬å™¨è®¡æ•°</span>
    <span class="hljs-title function_">_getListenersCount</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> result = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventName <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
            result[eventName] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-property">length</span>;
        }
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<h4 data-id="heading-32">ä¹ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h4>
<h5 data-id="heading-33">9.1 æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h5>
<ol>
<li><strong>å‘å¸ƒè®¢é˜…æ¨¡å¼çš„æ ¸å¿ƒ:</strong> é€šè¿‡äº‹ä»¶ä¸­å¿ƒè§£è€¦å‘å¸ƒè€…å’Œè®¢é˜…è€…</li>
<li><strong>EventEmitterçš„å®ç°è¦ç‚¹:</strong></li>
</ol>
<ul>
<li>ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„å­˜å‚¨äº‹ä»¶å’Œç›‘å¬å™¨</li>
<li>æ­£ç¡®å¤„ç† once ç›‘å¬å™¨</li>
<li>å®ç°é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li>æ”¯æŒé“¾å¼è°ƒç”¨</li>
</ul>
<ol start="3">
<li><strong>å†…å­˜ç®¡ç†:</strong> åŠæ—¶æ¸…ç†ç›‘å¬å™¨, é¿å…å†…å­˜æ³„æ¼</li>
<li><strong>æ€§èƒ½è€ƒè™‘:</strong> é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œç®—æ³•</li>
</ol>
<h5 data-id="heading-34">9.2 æœ€ä½³å®ç°</h5>
<ol>
<li>å‘½åè§„èŒƒ:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¥½çš„å‘½å</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, handler);
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'order:created'</span>, handler);

<span class="hljs-comment">// ä¸å¥½çš„å‘½å</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'login'</span>, handler);
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'newOrder'</span>, handler);
</code></pre>
<ol start="2">
<li>é”™è¯¯å¤„ç†:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€»æ˜¯ç›‘å¬ error äº‹ä»¶</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'EventEmitter error:'</span>, error);
    <span class="hljs-comment">// å‘é€åˆ°é”™è¯¯ç›‘æ§ç³»ç»Ÿ</span>
});

<span class="hljs-comment">// æˆ–è€…åœ¨ç›‘å¬å™¨å†…éƒ¨å¤„ç†é”™è¯¯</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">processData</span>(data);
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†æ•°æ®æ—¶å‡ºé”™:'</span>, error);
        emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error);
    }
});
</code></pre>
<ol start="3">
<li>èµ„æºæ¸…ç†:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> cleanup1 = emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'event1'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handler1</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup1);
        
        <span class="hljs-keyword">const</span> cleanup2 = emitter.<span class="hljs-title function_">once</span>(<span class="hljs-string">'event2'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handler2</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup2);
    }
    
    <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>());
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
}
</code></pre>
<h5 data-id="heading-35">9.3 ä½¿ç”¨å»ºè®®</h5>



































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨èæ–¹æ¡ˆ</th><th align="left">ç†ç”±</th></tr></thead><tbody><tr><td align="left">ç®€å•ç»„ä»¶é€šä¿¡</td><td align="left">åŸºç¡€ EventEmitter</td><td align="left">è½»é‡ã€ç®€å•</td></tr><tr><td align="left">å¤§å‹åº”ç”¨çŠ¶æ€ç®¡ç†</td><td align="left">Observable Store</td><td align="left">ç»“æ„åŒ–ã€å¯é¢„æµ‹</td></tr><tr><td align="left">å¼‚æ­¥ä»»åŠ¡åè°ƒ</td><td align="left">AsyncEventEmitter</td><td align="left">æ›´å¥½çš„å¼‚æ­¥æ”¯æŒ</td></tr><tr><td align="left">æ€§èƒ½æ•æ„Ÿåœºæ™¯</td><td align="left">HighPerformanceEventEmitter</td><td align="left">ä¼˜åŒ–è¿‡çš„å®ç°</td></tr><tr><td align="left">éœ€è¦ç›‘æ§è°ƒè¯•</td><td align="left">MonitoredEventEmitter</td><td align="left">å†…ç½®ç›‘æ§åŠŸèƒ½</td></tr></tbody></table>
<h4 data-id="heading-36">ç»“è¯­</h4>
<p>é€šè¿‡æ‰‹å†™ EventEmitterï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†å‘å¸ƒè®¢é˜…æ¨¡å¼çš„å®ç°åŸç†ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£äº†äº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ã€‚EventEmitter è™½ç„¶ç®€å•ï¼Œä½†å…¶è®¾è®¡æ€æƒ³åœ¨ç°ä»£å‰ç«¯æ¡†æ¶ã€Node.js åç«¯ç³»ç»Ÿä»¥åŠå„ç§å¤æ‚åº”ç”¨ä¸­éƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚</p>
<p>è®°ä½ï¼Œå¥½çš„äº‹ä»¶ç³»ç»Ÿåº”è¯¥ï¼š</p>
<ul>
<li>
<p>âœ… èŒè´£æ¸…æ™°ï¼šäº‹ä»¶ä¸­å¿ƒåªè´Ÿè´£è½¬å‘æ¶ˆæ¯</p>
</li>
<li>
<p>âœ… æ€§èƒ½ä¼˜ç§€ï¼šé«˜é¢‘äº‹ä»¶è§¦å‘æ—¶è¡¨ç°è‰¯å¥½</p>
</li>
<li>
<p>âœ… æ˜“äºè°ƒè¯•ï¼šæœ‰è‰¯å¥½çš„ç›‘æ§å’Œé”™è¯¯å¤„ç†</p>
</li>
<li>
<p>âœ… å†…å­˜å®‰å…¨ï¼šé¿å…å†…å­˜æ³„æ¼å’Œèµ„æºæµªè´¹</p>
</li>
</ul>
<hr/>
<p>å»¶ä¼¸é˜…è¯»ï¼š</p>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fapi%2Fevents.html" target="_blank" title="https://nodejs.org/api/events.html" ref="nofollow noopener noreferrer">Node.js EventEmitter å®˜æ–¹æ–‡æ¡£</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPublish%2525E2%252580%252593subscribe_pattern" target="_blank" title="https://en.wikipedia.org/wiki/Publish%25E2%2580%2593subscribe_pattern" ref="nofollow noopener noreferrer">å‘å¸ƒè®¢é˜…æ¨¡å¼è¯¦è§£</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhackernoon.com%2Fobserver-vs-pub-sub-pattern-50d3b27f838c" target="_blank" title="https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c" ref="nofollow noopener noreferrer">è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒè®¢é˜…æ¨¡å¼çš„åŒºåˆ«</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Frxjs.dev%2Fguide%2Foverview" target="_blank" title="https://rxjs.dev/guide/overview" ref="nofollow noopener noreferrer">RxJS å“åº”å¼ç¼–ç¨‹</a></p>
</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡ç»è¿‡ä¸¥æ ¼æµ‹è¯•çš„åšå®¢èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ EventEmitterï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è®¨è®ºäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«é‡å¤é€ è½®å­ï¼ä¸šåŠ¡ç»„ä»¶å¤šåœºæ™¯å¤ç”¨å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7581314241409794083</link>    <guid>https://juejin.cn/post/7581314241409794083</guid>    <pubDate>2025-12-08T10:22:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581314241409794083" data-draft-id="7579808521203974178" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«é‡å¤é€ è½®å­ï¼ä¸šåŠ¡ç»„ä»¶å¤šåœºæ™¯å¤ç”¨å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-08T10:22:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è“ç‘Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3817959264107757"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«é‡å¤é€ è½®å­ï¼ä¸šåŠ¡ç»„ä»¶å¤šåœºæ™¯å¤ç”¨å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817959264107757/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è“ç‘Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:22:54.000Z" title="Mon Dec 08 2025 10:22:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€:å½“"ä¸€ä¸ªç»„ä»¶å¤šåœºæ™¯å¤ç”¨"é‡ä¸Šç°å®å¤æ‚æ€§</h2>
<p>ç»„ä»¶ã€Œå¤ç”¨ã€æœ€å®¹æ˜“è¢«è¯¯è§£â€”â€”<br/>
è€æ¿è¯´â€œè¿™ä¸å°±ä¸€æ ·å¡ç‰‡å˜›ï¼Œå¤šåŠ å‡ ä¸ªå­—æ®µâ€ï¼Œ<br/>
äº§å“è¯´â€œå°±æ¢ä¸ªçš®å˜›ï¼Œè¿˜ä¸æ˜¯ä¸€ä¸ªä¸šåŠ¡é€»è¾‘â€ï¼Œ<br/>
ä½†ä½ çŸ¥é“ï¼šè¿™ä¸ª â€œä¸€æ ·â€ï¼Œå¾€å¾€ç­‰äºä¸€åœ°é¸¡æ¯›ã€‚</p>
<p>ä¸€å¼€å§‹ä½ æƒ³ç€æ‰“ä¸ªè¡¥ä¸ï¼ˆæ¡ä»¶åˆ¤æ–­åŠ ä¸€ä¸ªï¼‰<br/>
åæ¥ä½ è¡¥è¡¥åˆè¡¥â€”â€”å†è¡¥è¿˜æ˜¯ä¸è¡Œï¼Œæœ€ååˆ«è¯´â€œå¤ç”¨â€ï¼Œæ—§ç»„ä»¶éƒ½åäº†:
é€»è¾‘è€¦åˆã€prop çˆ†ç‚¸ï¼Œä¸€ä¸å°å¿ƒèµ°ä¸Šå°è£…â€œå·¨å‹é»‘ç®±â€çš„ä¸å½’è·¯ã€‚</p>
<p><strong>è¿™ä¸æ˜¯å·¥ä½œç–å¿½ï¼Œè€Œæ˜¯è®¾è®¡æ–¹å¼å‡ºé”™äº†ã€‚</strong></p>
<p>å†ç»å¤šä¸ªé¡¹ç›®å®æˆ˜æ¢ç´¢ï¼Œä½ ä¼šå‘ç°ï¼šå¤ç”¨ä¸€ä¸ªç»„ä»¶ï¼Œå°±åƒåœ¨ç»„è£…å¤æ‚æ‹¼å›¾â€”â€”æ¸…æ™°è¾¹ç•Œã€æ‹†åˆ†åŠŸèƒ½ã€ç»„åˆè€Œä¸è€¦åˆï¼Œæ‰æ˜¯å…³é”®ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å°±å¸¦ä½ ç”¨â€œé…ç½®é©±åŠ¨è®¾è®¡â€ã€â€œå¤åˆç»„ä»¶æ¨¡å¼â€ã€â€œç­–ç•¥æ¨¡å¼â€ã€â€œæ¸²æŸ“å‡½æ•°â€çš„æ€ç»´è·¯å¾„ï¼Œæ‹†å¼€ã€å†ç»„å»ºå‡ºçœŸæ­£æ˜“å¤ç”¨çš„ä¸šåŠ¡ç»„ä»¶æ¨¡å‹ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€é…ç½®é©±åŠ¨è®¾è®¡ï¼šå‚æ•°åŒ–çš„è‰ºæœ¯</h2>
<h3 data-id="heading-2">é€‚ç”¨åœºæ™¯ï¼šåŠŸèƒ½å¼€å…³ä¸æ ·å¼ä¸»é¢˜çš„çµæ´»åˆ‡æ¢</h3>
<p>å½“ç»„ä»¶çš„å·®å¼‚ä¸»è¦ä½“ç°åœ¨<strong>åŠŸèƒ½ç»„åˆã€è§†è§‰ä¸»é¢˜å’Œç®€å•è¡Œä¸ºå˜åŒ–</strong>æ—¶ï¼Œé…ç½®é©±åŠ¨å°±åƒç»™ç»„ä»¶è£…ä¸Šäº†"æ§åˆ¶é¢æ¿"ï¼Œé€šè¿‡è°ƒèŠ‚å‚æ•°å³å¯å®ç°ä¸åŒå½¢æ€ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ä¸šåŠ¡ç»„ä»¶å…¥å£] --&gt; B{è¯»å–åœºæ™¯é…ç½®}
    B --&gt; C[ç®¡ç†å‘˜åœºæ™¯]
    B --&gt; D[ç”¨æˆ·åœºæ™¯]
    B --&gt; E[ç§»åŠ¨ç«¯åœºæ™¯]
    
    C --&gt; F[é…ç½®è§£æå™¨]
    D --&gt; F
    E --&gt; F
    
    F --&gt; G[åŠŸèƒ½å¼€å…³]
    F --&gt; H[æ ·å¼ä¸»é¢˜]
    F --&gt; I[è¡Œä¸ºç­–ç•¥]
    
    G --&gt; J[æ¸²æŸ“å¼•æ“]
    H --&gt; J
    I --&gt; J
    
    J --&gt; K[ç®¡ç†å‘˜ç•Œé¢]
    J --&gt; L[ç”¨æˆ·ç•Œé¢]
    J --&gt; M[ç§»åŠ¨ç«¯ç•Œé¢]
    
    style C fill:#e1f5e1
    style D fill:#fff3e0
    style E fill:#e3f2fd
</code></pre>
<h3 data-id="heading-3">è®¾è®¡å“²å­¦ï¼šåˆ†ç¦»å˜ä¸ä¸å˜</h3>
<p>é…ç½®é©±åŠ¨çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†<strong>å˜åŒ–çš„éƒ¨åˆ†å‚æ•°åŒ–</strong>ï¼Œè€Œ<strong>ä¸å˜çš„éƒ¨åˆ†å›ºå®šåŒ–</strong>ã€‚é€šè¿‡ä¸€ä¸ªé›†ä¸­ç®¡ç†çš„é…ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¿®æ”¹ç»„ä»¶å†…éƒ¨ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°å¤šç§åœºæ™¯çš„é€‚é…ã€‚</p>
<h3 data-id="heading-4">å…³é”®å®ç°æŠ€å·§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é…ç½®çš„å±‚æ¬¡åŒ–è®¾è®¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">createSceneConfig</span> = (<span class="hljs-params">baseConfig, overrideConfig</span>) =&gt; ({
  <span class="hljs-comment">// ç¬¬ä¸€å±‚ï¼šåŸºç¡€åŠŸèƒ½é…ç½®</span>
  <span class="hljs-attr">features</span>: <span class="hljs-title function_">mergeDeep</span>(baseConfig.<span class="hljs-property">features</span>, overrideConfig.<span class="hljs-property">features</span>),
  
  <span class="hljs-comment">// ç¬¬äºŒå±‚ï¼šUIè¡¨ç°é…ç½®  </span>
  <span class="hljs-attr">ui</span>: {
    ...baseConfig.<span class="hljs-property">ui</span>,
    ...overrideConfig.<span class="hljs-property">ui</span>,
    <span class="hljs-comment">// ä¸»é¢˜ç³»ç»Ÿæ”¯æŒåŠ¨æ€åˆ‡æ¢</span>
    <span class="hljs-attr">theme</span>: <span class="hljs-title function_">createTheme</span>(overrideConfig.<span class="hljs-property">ui</span>?.<span class="hljs-property">theme</span>)
  },
  
  <span class="hljs-comment">// ç¬¬ä¸‰å±‚ï¼šä¸šåŠ¡è§„åˆ™é…ç½®</span>
  <span class="hljs-attr">businessRules</span>: <span class="hljs-title function_">applyBusinessRules</span>(
    baseConfig.<span class="hljs-property">businessRules</span>,
    overrideConfig.<span class="hljs-property">businessRules</span>,
    context
  ),
  
  <span class="hljs-comment">// ç¬¬å››å±‚ï¼šæ€§èƒ½ä¼˜åŒ–é…ç½®</span>
  <span class="hljs-attr">performance</span>: {
    <span class="hljs-comment">// æ ¹æ®åœºæ™¯å¯ç”¨ä¸åŒçš„ä¼˜åŒ–ç­–ç•¥</span>
    <span class="hljs-attr">lazyLoad</span>: overrideConfig.<span class="hljs-property">isMobile</span>,
    <span class="hljs-attr">virtualScroll</span>: overrideConfig.<span class="hljs-property">isLargeDataset</span>,
    <span class="hljs-attr">memoization</span>: <span class="hljs-literal">true</span>
  }
});
</code></pre>
<h3 data-id="heading-5">ä¼˜åŠ¿ä¸è€ƒé‡</h3>
<h4 data-id="heading-6">ä¼˜åŠ¿ï¼š</h4>
<ol>
<li>é«˜åº¦å¯æ§ï¼šé€šè¿‡é…ç½®å³å¯è°ƒæ•´ç»„ä»¶è¡Œä¸ºï¼Œæ— éœ€ä¿®æ”¹ç»„ä»¶å†…éƒ¨ä»£ç </li>
<li>æ˜“äºæ‰©å±•ï¼šæ–°å¢åœºæ™¯åªéœ€æ·»åŠ é…ç½®ï¼Œç¬¦åˆå¼€é—­åŸåˆ™</li>
<li>é…ç½®é›†ä¸­ç®¡ç†ï¼šä¾¿äºç»´æŠ¤å’Œç»Ÿä¸€è°ƒæ•´</li>
</ol>
<h4 data-id="heading-7">è€ƒé‡ï¼š</h4>
<ol>
<li>é…ç½®å¯¹è±¡å¯èƒ½ä¼šå˜å¾—è‡ƒè‚¿ï¼Œéœ€è¦è‰¯å¥½çš„æ–‡æ¡£</li>
<li>å¤æ‚é€»è¾‘åœºæ™¯å¯èƒ½ä¸é€‚åˆçº¯é…ç½®é©±åŠ¨</li>
</ol>
<h3 data-id="heading-8">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>é…ç½®éªŒè¯</strong>ï¼šä½¿ç”¨SchemaéªŒè¯ç¡®ä¿é…ç½®çš„æ­£ç¡®æ€§</li>
<li><strong>é»˜è®¤å€¼å¤„ç†</strong>ï¼šæä¾›åˆç†çš„é»˜è®¤å€¼ï¼Œé¿å…é…ç½®ç¼ºå¤±å¯¼è‡´é”™è¯¯</li>
<li><strong>é…ç½®ç‰ˆæœ¬åŒ–</strong>ï¼šæ”¯æŒé…ç½®çš„çƒ­æ›´æ–°å’Œç‰ˆæœ¬å›æ»š</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹é…ç½®å¯¹è±¡è¿›è¡Œè®°å¿†åŒ–ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li>
</ol>
<h2 data-id="heading-9">äºŒã€å¤åˆç»„ä»¶æ¨¡å¼ï¼šä¹é«˜ç§¯æœ¨å¼çš„ç»„è£…è‰ºæœ¯</h2>
<h3 data-id="heading-10">é€‚ç”¨åœºæ™¯ï¼šUIç»“æ„å·®å¼‚æ˜¾è‘—çš„è·¨å¹³å°åº”ç”¨</h3>
<p>å½“ä¸åŒåœºæ™¯çš„<strong>ç•Œé¢å¸ƒå±€å’Œäº¤äº’æ¨¡å¼å·®å¼‚è¾ƒå¤§</strong>ï¼Œä½†åº•å±‚æ•°æ®é€»è¾‘ç›¸åŒæ—¶ï¼Œå¤åˆç»„ä»¶æ¨¡å¼å°±åƒæ˜¯æä¾›äº†ä¸€ç›’ä¹é«˜ç§¯æœ¨ï¼Œè®©ä½¿ç”¨è€…å¯ä»¥è‡ªç”±ç»„è£…å‡ºæ‰€éœ€çš„ç»“æ„ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "å¤åˆç»„ä»¶æ¶æ„"
        A[å®¹å™¨ç»„ä»¶&lt;br/&gt;BusinessContainer] --&gt; B[ä¸Šä¸‹æ–‡æä¾›è€…]
        B --&gt; C[åœºæ™¯ä¸Šä¸‹æ–‡]
        
        C --&gt; D[å¤´éƒ¨é€‰æ‹©å™¨]
        C --&gt; E[å†…å®¹é€‰æ‹©å™¨]
        C --&gt; F[åº•éƒ¨é€‰æ‹©å™¨]
        
        D --&gt; G[ç®¡ç†å‘˜å¤´éƒ¨]
        D --&gt; H[ç§»åŠ¨ç«¯å¤´éƒ¨]
        D --&gt; I[ç”¨æˆ·å¤´éƒ¨]
        
        E --&gt; J[è¯¦ç»†è§†å›¾]
        E --&gt; K[ç®€æ´è§†å›¾]
        E --&gt; L[å¡ç‰‡è§†å›¾]
        
        F --&gt; M[æ“ä½œæ ]
        F --&gt; N[åˆ†é¡µå™¨]
        F --&gt; O[ç©ºçŠ¶æ€]
    end
    
    subgraph "ä½¿ç”¨ç»„åˆ"
        P[ç®¡ç†å‘˜åœºæ™¯] --&gt; Q[ç»„åˆç¤ºä¾‹]
        Q --&gt; R[å®¹å™¨]
        R --&gt; S[ç®¡ç†å‘˜å¤´éƒ¨]
        R --&gt; T[è¯¦ç»†è§†å›¾]
        R --&gt; U[æ“ä½œæ ]
    end
    
    G -.-&gt; S
    J -.-&gt; T
    M -.-&gt; U
</code></pre>
<h3 data-id="heading-11">è®¾è®¡å“²å­¦ï¼šå…³æ³¨ç‚¹åˆ†ç¦»ä¸è‡ªç”±ç»„åˆ</h3>
<p>å¤åˆç»„ä»¶çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äº<strong>å°†å¤æ‚çš„ç»„ä»¶æ‹†è§£ä¸ºç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„å­ç»„ä»¶</strong>ï¼Œæ¯ä¸ªå­ç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼ŒåŒæ—¶é€šè¿‡å…±äº«çš„ä¸Šä¸‹æ–‡è¿›è¡Œé€šä¿¡ã€‚</p>
<h3 data-id="heading-12">è¿›é˜¶æ¨¡å¼ï¼šæ’æ§½ä¸æ‰©å±•ç‚¹</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ”¯æŒæ’æ§½çš„å¤åˆç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">BusinessComponentWithSlots</span> = (<span class="hljs-params">{ children, slots = {} }</span>) =&gt; {
  <span class="hljs-keyword">const</span> defaultSlots = {
    <span class="hljs-attr">header</span>: <span class="hljs-title class_">DefaultHeader</span>,
    <span class="hljs-attr">content</span>: <span class="hljs-title class_">DefaultContent</span>,
    <span class="hljs-attr">footer</span>: <span class="hljs-title class_">DefaultFooter</span>,
    <span class="hljs-attr">sidebar</span>: <span class="hljs-title class_">DefaultSidebar</span>,
    <span class="hljs-attr">toolbar</span>: <span class="hljs-title class_">DefaultToolbar</span>,
  };
  
  <span class="hljs-keyword">const</span> resolvedSlots = { ...defaultSlots, ...slots };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"business-layout"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"header-slot"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resolvedSlots.header</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sidebar-slot"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">resolvedSlots.sidebar</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"content-slot"</span>&gt;</span>
          {children || <span class="hljs-tag">&lt;<span class="hljs-name">resolvedSlots.content</span> /&gt;</span>}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"toolbar-slot"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resolvedSlots.toolbar</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"footer-slot"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resolvedSlots.footer</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-comment">// çµæ´»çš„ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">CustomizedView</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BusinessComponentWithSlots</span>
    <span class="hljs-attr">slots</span>=<span class="hljs-string">{{</span>
      <span class="hljs-attr">header:</span> <span class="hljs-attr">CustomHeader</span>,
      <span class="hljs-attr">sidebar:</span> <span class="hljs-attr">StatisticsSidebar</span>,
      <span class="hljs-attr">toolbar:</span> <span class="hljs-attr">QuickActionsToolbar</span>,
    }}
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">DashboardContent</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">BusinessComponentWithSlots</span>&gt;</span></span>
);
</code></pre>
<h3 data-id="heading-13">ä¼˜åŠ¿ä¸è€ƒé‡</h3>
<h4 data-id="heading-14">ä¼˜åŠ¿ï¼š</h4>
<ol>
<li>é«˜åº¦çµæ´»ï¼šå¯ä»¥åƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆç»„ä»¶</li>
<li>å…³æ³¨ç‚¹åˆ†ç¦»ï¼šæ¯ä¸ªå­ç»„ä»¶èŒè´£å•ä¸€</li>
<li>ä¸Šä¸‹æ–‡å…±äº«ï¼šçŠ¶æ€ç®¡ç†æ›´åŠ æ¸…æ™°</li>
</ol>
<h4 data-id="heading-15">è€ƒé‡ï¼š</h4>
<ol>
<li>å­¦ä¹ æ›²çº¿ç›¸å¯¹è¾ƒé«˜</li>
<li>éœ€è¦è‰¯å¥½çš„æ–‡æ¡£è¯´æ˜å¯ç”¨å­ç»„ä»¶</li>
</ol>
<h3 data-id="heading-16">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>æ˜ç¡®çš„ä¸Šä¸‹æ–‡å¥‘çº¦</strong>ï¼šä½¿ç”¨TypeScriptå®šä¹‰æ¸…æ™°çš„ä¸Šä¸‹æ–‡ç±»å‹ï¼Œç¡®ä¿å­ç»„ä»¶æ­£ç¡®ä½¿ç”¨å…±äº«çŠ¶æ€</li>
<li><strong>é»˜è®¤å­ç»„ä»¶å®ç°</strong>ï¼šä¸ºæ¯ä¸ªå­ç»„ä»¶æä¾›é»˜è®¤å®ç°ï¼Œé™ä½ä½¿ç”¨é—¨æ§›</li>
<li><strong>æ–‡æ¡£å’Œç¤ºä¾‹</strong>ï¼šä¸ºæ¯ä¸ªå­ç»„ä»¶æä¾›è¯¦ç»†çš„æ–‡æ¡£å’Œå¤šç§ä½¿ç”¨ç¤ºä¾‹</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šåˆç†æ‹†åˆ†ä¸Šä¸‹æ–‡ï¼Œé¿å…ä¸å¿…è¦çš„å­ç»„ä»¶é‡æ–°æ¸²æŸ“</li>
</ol>
<h2 data-id="heading-17">ä¸‰ã€ç­–ç•¥æ¨¡å¼ + è‡ªå®šä¹‰ Hookï¼šé€»è¾‘è§£è€¦çš„æ™ºæ…§</h2>
<h3 data-id="heading-18">é€‚ç”¨åœºæ™¯ï¼šä¸šåŠ¡è§„åˆ™å¤šå˜çš„å¤æ‚ç³»ç»Ÿ</h3>
<p>å½“ä¸åŒåœºæ™¯çš„<strong>ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å¤„ç†æ–¹å¼å·®å¼‚æ˜¾è‘—</strong>æ—¶ï¼Œç­–ç•¥æ¨¡å¼å¯ä»¥å°†è¿™äº›å·®å¼‚å°è£…åˆ°ç‹¬ç«‹çš„ç­–ç•¥å¯¹è±¡ä¸­ï¼Œä½¿ä¸»ç»„ä»¶ä¿æŒç®€æ´ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph "ç­–ç•¥ç®¡ç†å™¨"
        A[ç­–ç•¥é€‰æ‹©å™¨] --&gt; B{åœºæ™¯åˆ¤æ–­}
        B --&gt; C[ç®¡ç†å‘˜ç­–ç•¥]
        B --&gt; D[ç”¨æˆ·ç­–ç•¥]
        B --&gt; E[ç§»åŠ¨ç«¯ç­–ç•¥]
        B --&gt; F[é¢„è§ˆç­–ç•¥]
    end
    
    subgraph "ç­–ç•¥å®ç°"
        C --&gt; G[æ•°æ®å¤„ç†ç®¡é“]
        C --&gt; H[æƒé™éªŒè¯å™¨]
        C --&gt; I[æ“ä½œæ‰§è¡Œå™¨]
        
        D --&gt; J[ç®€åŒ–æ•°æ®å¤„ç†]
        D --&gt; K[åŸºç¡€éªŒè¯]
        D --&gt; L[å—é™æ“ä½œ]
        
        E --&gt; M[ç¦»çº¿æ•°æ®åŒæ­¥]
        E --&gt; N[è§¦æ‘¸æ‰‹åŠ¿å¤„ç†]
        E --&gt; O[ç½‘ç»œçŠ¶æ€æ„ŸçŸ¥]
    end
    
    subgraph "ç»„ä»¶é›†æˆ"
        P[ä¸šåŠ¡ç»„ä»¶] --&gt; Q[ç­–ç•¥Hook]
        Q --&gt; A
        R[UIæ¸²æŸ“å±‚] --&gt; S[ç­–ç•¥API]
        S --&gt; G
        S --&gt; J
        S --&gt; M
    end
    
    G -.-&gt; S
    J -.-&gt; S
    M -.-&gt; S
</code></pre>
<h3 data-id="heading-19">è®¾è®¡å“²å­¦ï¼šç®—æ³•æ—çš„è‡ªç”±æ›¿æ¢</h3>
<p>ç­–ç•¥æ¨¡å¼çš„ç²¾é«“åœ¨äº<strong>å®šä¹‰ä¸€ç³»åˆ—å¯äº’æ¢çš„ç®—æ³•</strong>ï¼Œè®©å®ƒä»¬å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·ç«¯å˜åŒ–ã€‚ç»“åˆReact Hookï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå‡ºæ—¢çµæ´»åˆæ˜“äºæµ‹è¯•çš„ä¸šåŠ¡é€»è¾‘å•å…ƒã€‚</p>
<h3 data-id="heading-20">ç­–ç•¥å·¥å‚æ¨¡å¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç­–ç•¥å·¥å‚ï¼šåŠ¨æ€åˆ›å»ºå’Œç»„åˆç­–ç•¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">createStrategy</span> = (<span class="hljs-params">scene, options</span>) =&gt; {
  <span class="hljs-comment">// åŸºç¡€ç­–ç•¥</span>
  <span class="hljs-keyword">const</span> baseStrategy = {
    <span class="hljs-attr">data</span>: options.<span class="hljs-property">data</span>,
    <span class="hljs-attr">format</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data,
    <span class="hljs-attr">validate</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">true</span>,
    <span class="hljs-attr">execute</span>: <span class="hljs-function">() =&gt;</span> {},
  };
  
  <span class="hljs-comment">// åœºæ™¯ç‰¹å®šçš„ç­–ç•¥å¢å¼º</span>
  <span class="hljs-keyword">const</span> enhancements = {
    <span class="hljs-attr">admin</span>: {
      <span class="hljs-attr">format</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-title function_">enrichAdminData</span>(data),
      <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> <span class="hljs-title function_">checkAdminPermissions</span>(action),
      <span class="hljs-attr">execute</span>: <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> {
        <span class="hljs-title function_">logAdminAction</span>(action);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">performAdminAction</span>(action);
      },
    },
    <span class="hljs-attr">mobile</span>: {
      <span class="hljs-attr">format</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-title function_">optimizeForMobile</span>(data),
      <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> <span class="hljs-title function_">checkNetworkStatus</span>(),
      <span class="hljs-attr">execute</span>: <span class="hljs-keyword">async</span> (action) =&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isOffline</span>()) {
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">queueAction</span>(action);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">performOnlineAction</span>(action);
      },
    },
  };
  
  <span class="hljs-comment">// ç­–ç•¥ç»„åˆï¼šå¯ä»¥æ··åˆå¤šä¸ªåœºæ™¯çš„ç‰¹æ€§</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">composeStrategies</span>(
    baseStrategy,
    enhancements[scene],
    options.<span class="hljs-property">customStrategies</span>
  );
};

<span class="hljs-comment">// ç­–ç•¥ç»„åˆå™¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">composeStrategies</span> = (<span class="hljs-params">...strategies</span>) =&gt; {
  <span class="hljs-keyword">return</span> strategies.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">combined, current</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      ...combined,
      ...current,
      <span class="hljs-comment">// ç‰¹æ®Šçš„ç»„åˆé€»è¾‘</span>
      <span class="hljs-attr">format</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> prevResult = combined.<span class="hljs-title function_">format</span>(data);
        <span class="hljs-keyword">return</span> current.<span class="hljs-property">format</span> ? current.<span class="hljs-title function_">format</span>(prevResult) : prevResult;
      },
    };
  });
};
</code></pre>
<h3 data-id="heading-21">ä¼˜åŠ¿ä¸è€ƒé‡</h3>
<h4 data-id="heading-22">ä¼˜åŠ¿ï¼š</h4>
<ol>
<li>é€»è¾‘ä¸UIè§£è€¦ï¼šä¸šåŠ¡é€»è¾‘å¯ä»¥ç‹¬ç«‹æµ‹è¯•</li>
<li>ç­–ç•¥å¯æ›¿æ¢ï¼šè½»æ¾åˆ‡æ¢ä¸åŒåœºæ™¯çš„é€»è¾‘</li>
<li>ä»£ç å¤ç”¨ï¼šç›¸ä¼¼é€»è¾‘å¯ä»¥åœ¨ä¸åŒç­–ç•¥é—´å…±äº«</li>
</ol>
<h4 data-id="heading-23">è€ƒé‡ï¼š</h4>
<ol>
<li>éœ€è¦è‰¯å¥½è®¾è®¡çš„ç­–ç•¥æ¥å£</li>
<li>ç­–ç•¥ä¹‹é—´å¯èƒ½å­˜åœ¨é‡å¤ä»£ç </li>
</ol>
<h3 data-id="heading-24">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>ç­–ç•¥æ¥å£æ ‡å‡†åŒ–</strong>ï¼šå®šä¹‰ç»Ÿä¸€çš„ç­–ç•¥æ¥å£ï¼Œç¡®ä¿ä¸åŒç­–ç•¥ä¹‹é—´å¯ä»¥æ— ç¼æ›¿æ¢</li>
<li><strong>ç­–ç•¥å·¥å‚ç®¡ç†</strong>ï¼šä½¿ç”¨ç­–ç•¥å·¥å‚ç»Ÿä¸€åˆ›å»ºå’Œç®¡ç†ç­–ç•¥å®ä¾‹</li>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šé€šè¿‡ä¾èµ–æ³¨å…¥è§£è€¦ç­–ç•¥çš„å…·ä½“å®ç°ï¼Œä¾¿äºæµ‹è¯•å’Œç»´æŠ¤</li>
<li><strong>ç­–ç•¥ç»„åˆ</strong>ï¼šæ”¯æŒç­–ç•¥çš„ç»„åˆä½¿ç”¨ï¼Œæé«˜ä»£ç å¤ç”¨æ€§</li>
</ol>
<h2 data-id="heading-25">å››ã€Render Props + ç»„ä»¶æ³¨å…¥ï¼šæè‡´çµæ´»æ€§çš„é€‰æ‹©</h2>
<h3 data-id="heading-26">é€‚ç”¨åœºæ™¯ï¼šéœ€è¦é«˜åº¦å®šåˆ¶åŒ–çš„å¼€æ”¾å¹³å°</h3>
<p>å½“ä½ è®¾è®¡çš„ç»„ä»¶éœ€è¦è¢«<strong>ä¸åŒå›¢é˜Ÿç”šè‡³ä¸åŒå…¬å¸ä½¿ç”¨</strong>ï¼Œä¸”ä»–ä»¬å¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„UIéœ€æ±‚å’Œäº¤äº’æ¨¡å¼æ—¶ï¼ŒRender Propsæä¾›äº†æœ€å¤§ç¨‹åº¦çš„çµæ´»æ€§ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[FlexibleComponent] --&gt; B[æ¸²æŸ“ä¸Šä¸‹æ–‡]
    A --&gt; C[æ•°æ®çŠ¶æ€]
    A --&gt; D[æ“ä½œæ–¹æ³•]
    
    B --&gt; E{æ¸²æŸ“æ¨¡å¼é€‰æ‹©}
    
    E --&gt; F[Render Propsæ¨¡å¼]
    E --&gt; G[Childrenæ¨¡å¼]
    E --&gt; H[ç»„ä»¶æ³¨å…¥æ¨¡å¼]
    
    F --&gt; I[å‡½æ•°å¼æ¸²æŸ“]
    G --&gt; J[å£°æ˜å¼æ¸²æŸ“]
    H --&gt; K[ç»„ä»¶å¼æ¸²æŸ“]
    
    I --&gt; L[å®Œå…¨æ§åˆ¶UI]
    J --&gt; M[éƒ¨åˆ†å®šåˆ¶]
    K --&gt; N[æ›¿æ¢ç»„ä»¶]
    
    subgraph "ä½¿ç”¨ç¤ºä¾‹"
        O[åå°ç³»ç»Ÿ] --&gt; L
        P[è¥é”€é¡µé¢] --&gt; M
        Q[ç¬¬ä¸‰æ–¹é›†æˆ] --&gt; N
    end
</code></pre>
<h3 data-id="heading-27">è®¾è®¡å“²å­¦ï¼šæ§åˆ¶åè½¬ä¸ä¾èµ–æ³¨å…¥</h3>
<p>Render Propsæ¨¡å¼å®ç°äº†<strong>æ§åˆ¶åè½¬</strong>â€”â€”å°†UIæ¸²æŸ“çš„æ§åˆ¶æƒäº¤ç»™ä½¿ç”¨è€…ï¼Œè€Œç»„ä»¶æœ¬èº«åªè´Ÿè´£æä¾›æ•°æ®å’ŒçŠ¶æ€ç®¡ç†ã€‚</p>
<h3 data-id="heading-28">å¤šæ¨¡å¼å…¼å®¹è®¾è®¡</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ”¯æŒå¤šç§ä½¿ç”¨æ–¹å¼çš„çµæ´»ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">UniversalComponent</span> = (<span class="hljs-params">props</span>) =&gt; {
  <span class="hljs-keyword">const</span> {
    <span class="hljs-comment">// æ¨¡å¼1: render props</span>
    render,
    
    <span class="hljs-comment">// æ¨¡å¼2: ç»„ä»¶æ³¨å…¥</span>
    components = {},
    
    <span class="hljs-comment">// æ¨¡å¼3: æ’æ§½ç³»ç»Ÿ</span>
    children,
    slots = {},
    
    <span class="hljs-comment">// æ¨¡å¼4: é…ç½®é©±åŠ¨</span>
    config,
    
    <span class="hljs-comment">// å…±äº«çš„çŠ¶æ€å’Œæ•°æ®</span>
    data,
    state,
    actions,
    context,
  } = <span class="hljs-title function_">useUniversalComponentLogic</span>(props);
  
  <span class="hljs-comment">// æ¸²æŸ“ç­–ç•¥ï¼šä¼˜å…ˆçº§é¡ºåº</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderContent</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// æœ€é«˜ä¼˜å…ˆçº§ï¼šrender props</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> render === <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">render</span>({ data, state, actions, context });
    }
    
    <span class="hljs-comment">// ç¬¬äºŒä¼˜å…ˆçº§ï¼šç»„ä»¶æ³¨å…¥</span>
    <span class="hljs-keyword">if</span> (components.<span class="hljs-property">Content</span>) {
      <span class="hljs-keyword">const</span> <span class="hljs-title class_">ContentComponent</span> = components.<span class="hljs-property">Content</span>;
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ContentComponent</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> <span class="hljs-attr">actions</span>=<span class="hljs-string">{actions}</span> /&gt;</span></span>;
    }
    
    <span class="hljs-comment">// ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šæ’æ§½ç³»ç»Ÿ</span>
    <span class="hljs-keyword">if</span> (slots.<span class="hljs-property">content</span>) {
      <span class="hljs-keyword">return</span> slots.<span class="hljs-property">content</span>;
    }
    
    <span class="hljs-comment">// ç¬¬å››ä¼˜å…ˆçº§ï¼šé»˜è®¤æ¸²æŸ“ + children</span>
    <span class="hljs-keyword">return</span> children || <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DefaultContent</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span> /&gt;</span></span>;
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UniversalContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{context}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">universal-component</span> ${<span class="hljs-attr">config</span>?<span class="hljs-attr">.theme</span> || '<span class="hljs-attr">default</span>'}`}&gt;</span>
        {/* å¤´éƒ¨æ¸²æŸ“ç­–ç•¥ */}
        {components.Header || slots.header ? (
          components.Header ? 
            <span class="hljs-tag">&lt;<span class="hljs-name">components.Header</span> /&gt;</span> : slots.header
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">DefaultHeader</span> /&gt;</span>
        )}
        
        {/* å†…å®¹åŒºåŸŸ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"content-area"</span>&gt;</span>
          {renderContent()}
        <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        
        {/* åº•éƒ¨åŒºåŸŸ */}
        {config?.showFooter !== false &amp;&amp; (
          components.Footer || slots.footer ? (
            components.Footer ?
              <span class="hljs-tag">&lt;<span class="hljs-name">components.Footer</span> /&gt;</span> : slots.footer
          ) : (
            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultFooter</span> <span class="hljs-attr">actions</span>=<span class="hljs-string">{actions}</span> /&gt;</span>
          )
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UniversalContext.Provider</span>&gt;</span></span>
  );
};

<span class="hljs-comment">// å¤šæ ·çš„ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Example1</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="hljs-comment">// æ–¹å¼1: render propsï¼ˆæœ€å¤§çµæ´»æ€§ï¼‰</span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UniversalComponent</span>
    <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
    <span class="hljs-attr">render</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">data</span>, <span class="hljs-attr">actions</span> }) =&gt;</span> (
      <span class="hljs-tag">&lt;<span class="hljs-name">CustomLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CustomHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"è‡ªå®šä¹‰æ ‡é¢˜"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CustomContent</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> <span class="hljs-attr">onAction</span>=<span class="hljs-string">{actions.handleAction}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">CustomLayout</span>&gt;</span>
    )}
  /&gt;</span>
);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Example2</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="hljs-comment">// æ–¹å¼2: ç»„ä»¶æ³¨å…¥ï¼ˆç±»å‹å®‰å…¨ï¼‰</span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UniversalComponent</span>
    <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
    <span class="hljs-attr">components</span>=<span class="hljs-string">{{</span>
      <span class="hljs-attr">Header:</span> <span class="hljs-attr">CustomHeader</span>,
      <span class="hljs-attr">Content:</span> <span class="hljs-attr">CustomContent</span>,
      <span class="hljs-attr">Footer:</span> <span class="hljs-attr">CustomFooter</span>,
    }}
  /&gt;</span></span>
);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Example3</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="hljs-comment">// æ–¹å¼3: æ’æ§½ç³»ç»Ÿï¼ˆç±»ä¼¼Vueçš„æ’æ§½ï¼‰</span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UniversalComponent</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"header"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CustomHeader</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      è¿™é‡Œæ˜¯è‡ªå®šä¹‰å†…å®¹
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">UniversalComponent</span>&gt;</span></span>
);
</code></pre>
<h3 data-id="heading-29">ä¼˜åŠ¿ä¸è€ƒé‡</h3>
<h4 data-id="heading-30">ä¼˜åŠ¿ï¼š</h4>
<ol>
<li>æè‡´çµæ´»æ€§ï¼šå…è®¸ä½¿ç”¨è€…å®Œå…¨æ§åˆ¶ç»„ä»¶æ¸²æŸ“ï¼Œé€‚åº”é«˜åº¦å®šåˆ¶åŒ–éœ€æ±‚</li>
<li>é€»è¾‘ä¸UIå®Œå…¨åˆ†ç¦»ï¼šç»„ä»¶ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼ŒUIæ¸²æŸ“å®Œå…¨å¯è‡ªå®šä¹‰</li>
<li>æ¸è¿›å¼é‡‡ç”¨ï¼šæä¾›é»˜è®¤æ¸²æŸ“å®ç°ï¼Œå¯æŒ‰éœ€é€æ­¥æ›¿æ¢ç‰¹å®šéƒ¨åˆ†</li>
<li>ç»„ä»¶å¤ç”¨æ€§é«˜ï¼šåŒä¸€ä¸šåŠ¡ç»„ä»¶å¯åœ¨ä¸åŒé¡¹ç›®ã€æŠ€æœ¯æ ˆä¸­å¤ç”¨</li>
<li>ç±»å‹å®‰å…¨æ€§å¼ºï¼šç»“åˆTypeScriptå¯ç²¾ç¡®å£°æ˜æ¸²æŸ“å‡½æ•°ç±»å‹</li>
</ol>
<h4 data-id="heading-31">è€ƒé‡ï¼š</h4>
<ol>
<li>ä½¿ç”¨å¤æ‚åº¦é«˜ï¼šéœ€è¦æ·±å…¥ç†è§£ç»„ä»¶çŠ¶æ€é€»è¾‘ï¼Œå¯¹å¼€å‘è€…è¦æ±‚è¾ƒé«˜</li>
<li>æ€§èƒ½ä¼˜åŒ–å›°éš¾ï¼šæ¸²æŸ“å‡½æ•°å®¹æ˜“å¯¼è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li>
<li>ä»£ç å†—ä½™é£é™©ï¼šç›¸ä¼¼UIåœ¨ä¸åŒåœºæ™¯ä¸­å¯èƒ½å¯¼è‡´ä»£ç é‡å¤</li>
<li>è°ƒè¯•å¤æ‚åº¦å¢åŠ ï¼šæ¸²æŸ“é€»è¾‘åˆ†æ•£ï¼Œè°ƒè¯•éœ€è¦è¿½è¸ªå¤šä¸ªè°ƒç”¨é“¾</li>
<li>APIå¤æ‚åº¦é«˜ï¼šä¸ºæä¾›çµæ´»æ€§éœ€æš´éœ²å¤§é‡çŠ¶æ€å’Œæ–¹æ³•</li>
</ol>
<h3 data-id="heading-32">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>æ¸²æŸ“å‡½æ•°è®°å¿†åŒ–</strong>ï¼šä½¿ç”¨useCallbackåŒ…è£…æ¸²æŸ“å‡½æ•°ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li>
<li><strong>é»˜è®¤ç»„ä»¶é›†</strong>ï¼šæä¾›ä¸€å¥—é»˜è®¤çš„ç»„ä»¶å®ç°ï¼Œç®€åŒ–åŸºç¡€ä½¿ç”¨</li>
<li><strong>ç±»å‹å®‰å…¨å£°æ˜</strong>ï¼šä½¿ç”¨TypeScriptç²¾ç¡®å£°æ˜æ¸²æŸ“å‡½æ•°å’Œç»„ä»¶æ³¨å…¥çš„propsç±»å‹</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šç›‘æ§æ¸²æŸ“æ€§èƒ½ï¼Œé¿å…å› è¿‡åº¦çµæ´»å¯¼è‡´çš„æ€§èƒ½é—®é¢˜</li>
</ol>
<h2 data-id="heading-33">äº”ã€å†³ç­–æµç¨‹å›¾ï¼šå¦‚ä½•é€‰æ‹©é€‚åˆçš„æ–¹æ¡ˆ</h2>
<p>é¢å¯¹å¤šåœºæ™¯å¤ç”¨éœ€æ±‚æ—¶ï¼Œå¦‚ä½•é€‰æ‹©æœ€åˆé€‚çš„æ–¹æ¡ˆï¼Ÿä¸‹é¢çš„å†³ç­–æµç¨‹å›¾å¯ä»¥å¸®åŠ©ä½ åšå‡ºæ˜æ™ºçš„é€‰æ‹©ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dba44358dbf4afdb88a4546a2733658~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JOd55Gf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794173&amp;x-signature=SQmFzJ6QBNPay8bYkfSG8E4e5Vg%3D" alt="deepseek_mermaid_20251204_079e14.png" loading="lazy"/></p>
<h3 data-id="heading-34">æ··åˆæ¨¡å¼ï¼šç°å®é¡¹ç›®çš„æœ€ä½³å®è·µ</h3>
<p>åœ¨å®é™…çš„å¤§å‹é¡¹ç›®ä¸­ï¼Œå•ä¸€æ¨¡å¼å¾€å¾€éš¾ä»¥åº”å¯¹æ‰€æœ‰åœºæ™¯ã€‚èªæ˜çš„åšæ³•æ˜¯<strong>ç»„åˆä½¿ç”¨å¤šç§æ¨¡å¼</strong>ï¼Œå‘æŒ¥å„è‡ªçš„ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ··åˆæ¨¡å¼ç¤ºä¾‹ï¼šé…ç½®é©±åŠ¨ + ç­–ç•¥æ¨¡å¼ + å¤åˆç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">HybridBusinessComponent</span> = (<span class="hljs-params">{ scene, config, children }</span>) =&gt; {
  <span class="hljs-comment">// 1. é…ç½®é©±åŠ¨ï¼šå¤„ç†ç®€å•çš„å·®å¼‚</span>
  <span class="hljs-keyword">const</span> baseConfig = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> 
    <span class="hljs-title function_">mergeConfigs</span>(<span class="hljs-variable constant_">DEFAULT_CONFIG</span>, <span class="hljs-variable constant_">SCENE_CONFIGS</span>[scene], config)
  , [scene, config]);
  
  <span class="hljs-comment">// 2. ç­–ç•¥æ¨¡å¼ï¼šå¤„ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å·®å¼‚</span>
  <span class="hljs-keyword">const</span> strategy = <span class="hljs-title function_">useBusinessStrategy</span>(scene, {
    <span class="hljs-attr">data</span>: baseConfig.<span class="hljs-property">data</span>,
    <span class="hljs-attr">features</span>: baseConfig.<span class="hljs-property">features</span>,
  });
  
  <span class="hljs-comment">// 3. å¤åˆç»„ä»¶ï¼šæä¾›çµæ´»çš„UIç»„åˆ</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BusinessContainer</span>
      <span class="hljs-attr">variant</span>=<span class="hljs-string">{scene}</span>
      <span class="hljs-attr">config</span>=<span class="hljs-string">{baseConfig}</span>
      <span class="hljs-attr">contextValue</span>=<span class="hljs-string">{strategy}</span>
    &gt;</span>
      {baseConfig.customHeader ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">BusinessContainer.Header</span>&gt;</span>
          {baseConfig.customHeader}
        <span class="hljs-tag">&lt;/<span class="hljs-name">BusinessContainer.Header</span>&gt;</span>
      ) : null}
      
      <span class="hljs-tag">&lt;<span class="hljs-name">BusinessContainer.Content</span>&gt;</span>
        {children || (
          <span class="hljs-tag">&lt;<span class="hljs-name">BusinessContent</span>
            <span class="hljs-attr">data</span>=<span class="hljs-string">{strategy.data}</span>
            <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{baseConfig.renderItem}</span>
            <span class="hljs-attr">onAction</span>=<span class="hljs-string">{strategy.handleAction}</span>
          /&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">BusinessContainer.Content</span>&gt;</span>
      
      {baseConfig.showActions &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">BusinessContainer.Actions</span>
          <span class="hljs-attr">actions</span>=<span class="hljs-string">{strategy.getAvailableActions()}</span>
          <span class="hljs-attr">onAction</span>=<span class="hljs-string">{strategy.executeAction}</span>
        /&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">BusinessContainer</span>&gt;</span></span>
  );
};
</code></pre>
<h2 data-id="heading-35">æ€»ç»“ï¼šç»„ä»¶è®¾è®¡çš„å¹³è¡¡è‰ºæœ¯</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54134aedceba4850976716b02891c4fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JOd55Gf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794173&amp;x-signature=yaEJ8rKaBrxYmfjQifHmJ%2BbmdA0%3D" alt="Balance-The-Principles-of-Art.jpg" loading="lazy"/></p>
<p>å¤šåœºæ™¯ä¸šåŠ¡ç»„ä»¶çš„è®¾è®¡æœ¬è´¨ä¸Šæ˜¯ä¸€åœº<strong>å¹³è¡¡çš„è‰ºæœ¯</strong>ï¼Œéœ€è¦åœ¨å¤šä¸ªç»´åº¦ä¸­æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹ï¼š</p>
<ol>
<li><strong>çµæ´»æ€§ä¸æ˜“ç”¨æ€§çš„å¹³è¡¡</strong>ï¼šæ—¢è¦è¶³å¤Ÿçµæ´»ä»¥é€‚åº”å„ç§åœºæ™¯ï¼Œåˆè¦å¯¹ä½¿ç”¨è€…ç®€å•å‹å¥½</li>
<li><strong>ä¸€è‡´æ€§ä¸ç‰¹å¼‚æ€§çš„å¹³è¡¡</strong>ï¼šä¿æŒæ ¸å¿ƒä½“éªŒä¸€è‡´ï¼ŒåŒæ—¶å…è®¸å¿…è¦çš„åœºæ™¯å®šåˆ¶</li>
<li><strong>æŠ½è±¡ç¨‹åº¦ä¸æ€§èƒ½çš„å¹³è¡¡</strong>ï¼šè¿‡åº¦æŠ½è±¡ä¼šå¢åŠ å¤æ‚åº¦ï¼Œä¸è¶³æŠ½è±¡ä¼šå¯¼è‡´ä»£ç é‡å¤</li>
<li><strong>å½“å‰éœ€æ±‚ä¸æœªæ¥æ‰©å±•çš„å¹³è¡¡</strong>ï¼šä¸ºæœªæ¥å˜åŒ–ç•™å‡ºç©ºé—´ï¼Œä½†ä¸è¿‡åº¦è®¾è®¡</li>
</ol>
<blockquote>
<p><strong>ä¸€äº›åŸåˆ™</strong></p>
<ol>
<li>
<p><strong>éµå¾ªå¼€æ”¾å°é—­åŸåˆ™</strong>ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</p>
</li>
<li>
<p><strong>ä¿æŒå•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªç»„ä»¶/æ¨¡å—åªåšä¸€ä»¶äº‹</p>
</li>
<li>
<p><strong>æä¾›æ˜ç¡®æ¥å£</strong>ï¼šæ¸…æ™°çš„APIå’Œç±»å‹å®šä¹‰</p>
</li>
<li>
<p><strong>æ”¯æŒæ¸è¿›å¢å¼º</strong>ï¼šä»ç®€å•åœºæ™¯å¼€å§‹ï¼Œé€æ­¥æ”¯æŒå¤æ‚åœºæ™¯</p>
</li>
<li>
<p><strong>æ³¨é‡å¼€å‘è€…ä½“éªŒ</strong>ï¼šè‰¯å¥½çš„æ–‡æ¡£å’Œé”™è¯¯æç¤º</p>
</li>
</ol>
</blockquote>
<p><strong>æœ€å¥½çš„è®¾è®¡ä¸æ˜¯æœ€å¤æ‚çš„è®¾è®¡ï¼Œè€Œæ˜¯æœ€é€‚åˆå›¢é˜Ÿå’Œé¡¹ç›®çš„è®¾è®¡ã€‚</strong> ä»ç®€å•çš„é…ç½®é©±åŠ¨å¼€å§‹ï¼Œéšç€åœºæ™¯å¤æ‚åº¦çš„å¢åŠ é€æ­¥å¼•å…¥æ›´é«˜çº§çš„æ¨¡å¼ï¼Œè¿™ç§æ¸è¿›å¼çš„æ¼”è¿›å¾€å¾€èƒ½å¸¦æ¥æœ€å¥åº·çš„ä»£ç baseã€‚</p>
<p>æœ€ç»ˆï¼Œä¼˜ç§€çš„ç»„ä»¶è®¾è®¡ä¸ä»…è®©ä»£ç æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ï¼Œæ›´é‡è¦çš„æ˜¯<strong>æå‡å›¢é˜Ÿçš„å¼€å‘æ•ˆç‡å’Œåä½œä½“éªŒ</strong>ã€‚å½“æ–°æˆå‘˜èƒ½å¤Ÿå¿«é€Ÿç†è§£å¦‚ä½•ä½¿ç”¨å’Œæ‰©å±•ç»„ä»¶ï¼Œå½“äº§å“éœ€æ±‚å˜åŒ–æ—¶ç»„ä»¶èƒ½å¤Ÿçµæ´»é€‚åº”ï¼Œå½“ä½ è‡ªå·±å‡ ä¸ªæœˆåå›å¤´çœ‹ä»£ç ä»ç„¶æ¸…æ™°æ˜“æ‡‚â€”â€”è¿™å°±æ˜¯æˆåŠŸçš„ç»„ä»¶è®¾è®¡å¸¦æ¥çš„çœŸæ­£ä»·å€¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MFCæ ¸å¿ƒæ¶æ„æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7581097111896277046</link>    <guid>https://juejin.cn/post/7581097111896277046</guid>    <pubDate>2025-12-08T10:28:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097111896277046" data-draft-id="7581210455827365924" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MFCæ ¸å¿ƒæ¶æ„æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T10:28:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MFCæ ¸å¿ƒæ¶æ„æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:28:39.000Z" title="Mon Dec 08 2025 10:28:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»42åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å°½ç®¡MFCï¼ˆMicrosoft Foundation Classesï¼‰å¸¸è¢«è§†ä¸ºâ€œè¿‡æ—¶â€çš„é—ç•™æŠ€æœ¯ï¼Œä½†å…¶è®¾è®¡æ€æƒ³å¯¹ç†è§£Windowsç¼–ç¨‹æœ¬è´¨å’Œæ¡†æ¶è®¾è®¡å“²å­¦ä»å…·é‡è¦ä»·å€¼ã€‚ä½œä¸ºä¸€å¥—ç»å…¸çš„C++æ¡†æ¶ï¼ŒMFCæˆåŠŸå°†è¿‡ç¨‹å¼çš„Win32 APIå°è£…ä¸ºé¢å‘å¯¹è±¡çš„ç±»åº“ï¼Œå…¶æ¶ˆæ¯æ˜ å°„æœºåˆ¶å’Œæ–‡æ¡£/è§†å›¾æ¶æ„ä½“ç°äº†æ—©æœŸæ¡†æ¶è®¾è®¡è€…å¯¹è½¯ä»¶å¤æ‚æ€§çš„æ·±åˆ»æ€è€ƒã€‚æœ¬æ–‡æ—¨åœ¨ç³»ç»Ÿæ€§å‰–æMFCçš„æ ¸å¿ƒæ¶æ„ï¼Œä¸ºå¼€å‘è€…æä¾›ä¸€ä¸ªç»“æ„åŒ–çš„è®¤çŸ¥æ¡†æ¶ã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€ç« ï¼šMFCçš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶â€”â€”Windowsäº‹ä»¶é©±åŠ¨çš„é©å‘½æ€§å°è£…</h2>
<h3 data-id="heading-1">ä¸€ã€Win32 SDKçš„åŸå§‹å›°å¢ƒï¼šé›†ä¸­å¼æ¶ˆæ¯å¤„ç†çš„å¤æ‚æ€§</h3>
<p>åœ¨æ·±å…¥ç†è§£MFCçš„æ¶ˆæ¯æ˜ å°„ä¹‹å‰ï¼Œå¿…é¡»é¦–å…ˆå®¡è§†ä¼ ç»ŸWin32 SDKç¼–ç¨‹çš„æ¶ˆæ¯å¤„ç†æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªé›†ä¸­å¼çš„çª—å£è¿‡ç¨‹å‡½æ•°ï¼ˆWindow Procedureï¼Œç®€ç§°WndProcï¼‰ï¼Œå®ƒæ¥æ”¶å¹¶å¤„ç†å‘é€åˆ°çª—å£çš„æ‰€æœ‰æ¶ˆæ¯ã€‚</p>
<p>å…¸å‹çš„Win32 SDKæ¶ˆæ¯å¤„ç†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">LRESULT CALLBACK <span class="hljs-title">WndProc</span><span class="hljs-params">(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)</span>
</span>{
    <span class="hljs-keyword">switch</span> (message)
    {
        <span class="hljs-keyword">case</span> WM_PAINT:
        {
            PAINTSTRUCT ps;
            HDC hdc = <span class="hljs-built_in">BeginPaint</span>(hWnd, &amp;ps);
            <span class="hljs-comment">// ç»˜å›¾ä»£ç ...</span>
            <span class="hljs-built_in">EndPaint</span>(hWnd, &amp;ps);
        }
        <span class="hljs-keyword">break</span>;
        
        <span class="hljs-keyword">case</span> WM_MOUSEMOVE:
        {
            <span class="hljs-type">int</span> xPos = <span class="hljs-built_in">LOWORD</span>(lParam);
            <span class="hljs-type">int</span> yPos = <span class="hljs-built_in">HIWORD</span>(lParam);
            <span class="hljs-comment">// å¤„ç†é¼ æ ‡ç§»åŠ¨...</span>
        }
        <span class="hljs-keyword">break</span>;
        
        <span class="hljs-keyword">case</span> WM_COMMAND:
        {
            <span class="hljs-type">int</span> wmId = <span class="hljs-built_in">LOWORD</span>(wParam);
            <span class="hljs-keyword">switch</span> (wmId)
            {
                <span class="hljs-keyword">case</span> IDM_FILE_OPEN:
                    <span class="hljs-comment">// å¤„ç†æ–‡ä»¶æ‰“å¼€...</span>
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> IDM_FILE_SAVE:
                    <span class="hljs-comment">// å¤„ç†æ–‡ä»¶ä¿å­˜...</span>
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-comment">// æ›´å¤šèœå•é¡¹...</span>
            }
        }
        <span class="hljs-keyword">break</span>;
        
        <span class="hljs-keyword">case</span> WM_DESTROY:
            <span class="hljs-built_in">PostQuitMessage</span>(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">break</span>;
            
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">DefWindowProc</span>(hWnd, message, wParam, lParam);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>è¿™ç§æ¨¡å¼å­˜åœ¨å‡ ä¸ªæ˜¾è‘—é—®é¢˜ï¼š</p>
<ol>
<li><strong>ä»£ç è†¨èƒ€</strong>ï¼šéšç€æ¶ˆæ¯ç±»å‹çš„å¢åŠ ï¼Œswitch-caseè¯­å¥å˜å¾—å¼‚å¸¸åºå¤§ï¼Œä¸€ä¸ªæˆç†Ÿçš„åº”ç”¨ç¨‹åºå¯èƒ½å¤„ç†æ•°ç™¾ç§æ¶ˆæ¯ç±»å‹ï¼Œå¯¼è‡´ä»£ç å¯è¯»æ€§æ€¥å‰§ä¸‹é™ã€‚</li>
<li><strong>é«˜åº¦è€¦åˆ</strong>ï¼šæ‰€æœ‰æ¶ˆæ¯å¤„ç†é€»è¾‘é›†ä¸­åœ¨å•ä¸€å‡½æ•°ä¸­ï¼Œä¸åŒç±»å‹çš„æ¶ˆæ¯å¤„ç†ä»£ç ç›¸äº’äº¤ç»‡ï¼Œéš¾ä»¥æ¨¡å—åŒ–ã€‚</li>
<li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šæ·»åŠ æ–°æ¶ˆæ¯å¤„ç†æˆ–ä¿®æ”¹ç°æœ‰é€»è¾‘æ—¶ï¼Œéœ€è¦åœ¨åºå¤§çš„switch-caseç»“æ„ä¸­å®šä½ï¼Œå®¹æ˜“å¼•å…¥é”™è¯¯ã€‚</li>
</ol>
<h3 data-id="heading-2">äºŒã€MFCçš„è§£å†³æ–¹æ¡ˆï¼šé¢å‘å¯¹è±¡çš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶</h3>
<p>MFCçš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶æ˜¯å¯¹ä¸Šè¿°é—®é¢˜çš„é©å‘½æ€§æ”¹è¿›ã€‚å®ƒåŸºäºä¸¤ä¸ªæ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š</p>
<ol>
<li><strong>åˆ†æ•£å¤„ç†</strong>ï¼šå°†æ¶ˆæ¯å¤„ç†åˆ†æ•£åˆ°å„ä¸ªçª—å£ç±»ä¸­ï¼Œæ¯ä¸ªç±»åªå¤„ç†ä¸è‡ªå·±ç›¸å…³çš„æ¶ˆæ¯ã€‚</li>
<li><strong>ç¼–è¯‘æ—¶ç»‘å®š</strong>ï¼šé€šè¿‡å®åœ¨ç¼–è¯‘æ—¶å»ºç«‹æ¶ˆæ¯åˆ°å¤„ç†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé¿å…è¿è¡Œæ—¶çš„ç±»å‹åˆ¤æ–­å¼€é”€ã€‚</li>
</ol>
<h4 data-id="heading-3">2.1 æ¶ˆæ¯æ˜ å°„çš„å®ç°æœºåˆ¶</h4>
<p>æ¶ˆæ¯æ˜ å°„çš„å®ç°ä¾èµ–äºä¸€ç»„ç²¾å¿ƒè®¾è®¡çš„å®å’Œé™æ€æ•°æ®ç»“æ„ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒå®ç°æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å…¸å‹çš„MFCç±»æ¶ˆæ¯æ˜ å°„å£°æ˜</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyWnd</span> : <span class="hljs-keyword">public</span> CWnd
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CMyWnd</span>();
    
<span class="hljs-keyword">protected</span>:
    <span class="hljs-comment">// æ¶ˆæ¯å¤„ç†å‡½æ•°å£°æ˜</span>
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnPaint</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnMouseMove</span><span class="hljs-params">(UINT nFlags, CPoint point)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnFileOpen</span><span class="hljs-params">()</span></span>;
    
    <span class="hljs-comment">// å…³é”®ï¼šå£°æ˜æ¶ˆæ¯æ˜ å°„</span>
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
};

<span class="hljs-comment">// å®ç°æ–‡ä»¶ä¸­çš„æ¶ˆæ¯æ˜ å°„å®šä¹‰</span>
<span class="hljs-built_in">BEGIN_MESSAGE_MAP</span>(CMyWnd, CWnd)
    <span class="hljs-built_in">ON_WM_PAINT</span>()
    <span class="hljs-built_in">ON_WM_MOUSEMOVE</span>()
    <span class="hljs-built_in">ON_COMMAND</span>(ID_FILE_OPEN, &amp;CMyWnd::OnFileOpen)
<span class="hljs-built_in">END_MESSAGE_MAP</span>()
</code></pre>
<h4 data-id="heading-4">2.2 æ¶ˆæ¯æ˜ å°„è¡¨çš„å†…éƒ¨ç»“æ„</h4>
<p>å½“ç¼–è¯‘å™¨å¤„ç†ä¸Šè¿°ä»£ç æ—¶ï¼Œä¼šç”Ÿæˆç±»ä¼¼ä¸‹é¢çš„é™æ€æ•°æ®ç»“æ„ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¶ˆæ¯æ˜ å°„è¡¨æ¡ç›®ç»“æ„ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AFX_MSGMAP_ENTRY</span>
{
    UINT nMessage;      <span class="hljs-comment">// Windowsæ¶ˆæ¯ID</span>
    UINT nCode;         <span class="hljs-comment">// æ§ä»¶é€šçŸ¥ç æˆ–å…¶å®ƒ</span>
    UINT nID;           <span class="hljs-comment">// æ§ä»¶IDï¼ˆå‘½ä»¤æ¶ˆæ¯ç”¨ï¼‰</span>
    UINT nLastID;       <span class="hljs-comment">// æ§ä»¶IDèŒƒå›´ç»“æŸï¼ˆç”¨äºèŒƒå›´æ˜ å°„ï¼‰</span>
    UINT nSig;          <span class="hljs-comment">// å‡½æ•°ç­¾åç±»å‹</span>
    AFX_PMSG pfn;       <span class="hljs-comment">// æŒ‡å‘æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆ</span>
};

<span class="hljs-comment">// ä¸ºCMyWndç±»ç”Ÿæˆçš„æ¶ˆæ¯æ˜ å°„è¡¨</span>
<span class="hljs-type">static</span> <span class="hljs-type">const</span> AFX_MSGMAP_ENTRY _messageEntries[] =
{
    <span class="hljs-comment">// æ ‡å‡†Windowsæ¶ˆæ¯</span>
    { WM_PAINT, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, AfxSig_vv, (AFX_PMSG)&amp;CMyWnd::OnPaint },
    { WM_MOUSEMOVE, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, AfxSig_vwp, (AFX_PMSG)&amp;CMyWnd::OnMouseMove },
    
    <span class="hljs-comment">// å‘½ä»¤æ¶ˆæ¯</span>
    { WM_COMMAND, <span class="hljs-number">0</span>, ID_FILE_OPEN, ID_FILE_OPEN, AfxSig_vv, 
      (AFX_PMSG)&amp;CMyWnd::OnFileOpen },
      
    <span class="hljs-comment">// ç»“æŸæ ‡è®°</span>
    { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, AfxSig_end, (AFX_PMSG)<span class="hljs-number">0</span> }
};
</code></pre>
<h4 data-id="heading-5">2.3 æ¶ˆæ¯æ´¾å‘æµç¨‹</h4>
<p>MFCæ¡†æ¶çš„æ¶ˆæ¯æ´¾å‘è¿‡ç¨‹éµå¾ªæ˜ç¡®çš„ç®—æ³•ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä¼ªä»£ç å±•ç¤ºMFCæ¶ˆæ¯æ´¾å‘é€»è¾‘</span>
<span class="hljs-function">LRESULT <span class="hljs-title">CWnd::WindowProc</span><span class="hljs-params">(UINT message, WPARAM wParam, LPARAM lParam)</span>
</span>{
    <span class="hljs-comment">// 1. è·å–å½“å‰ç±»çš„æ¶ˆæ¯æ˜ å°„è¡¨</span>
    <span class="hljs-type">const</span> AFX_MSGMAP* pMessageMap = <span class="hljs-built_in">GetMessageMap</span>();
    
    <span class="hljs-comment">// 2. æ²¿ç€ç»§æ‰¿é“¾å‘ä¸ŠæŸ¥æ‰¾æ¶ˆæ¯å¤„ç†å‡½æ•°</span>
    <span class="hljs-keyword">while</span> (pMessageMap != <span class="hljs-literal">NULL</span>)
    {
        <span class="hljs-comment">// åœ¨å½“å‰ç±»çš„æ¶ˆæ¯æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾</span>
        <span class="hljs-type">const</span> AFX_MSGMAP_ENTRY* pEntries = pMessageMap-&gt;lpEntries;
        
        <span class="hljs-keyword">for</span> (; pEntries-&gt;nSig != AfxSig_end; pEntries++)
        {
            <span class="hljs-keyword">if</span> (pEntries-&gt;nMessage == message)
            {
                <span class="hljs-comment">// æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œè°ƒç”¨å¤„ç†å‡½æ•°</span>
                <span class="hljs-keyword">union</span> <span class="hljs-title class_">MessageMapFunctions</span> mmf;
                mmf.pfn = pEntries-&gt;pfn;
                
                <span class="hljs-comment">// æ ¹æ®å‡½æ•°ç­¾åè°ƒç”¨ç›¸åº”çš„å¤„ç†å‡½æ•°</span>
                <span class="hljs-keyword">switch</span> (pEntries-&gt;nSig)
                {
                    <span class="hljs-keyword">case</span> AfxSig_vv:  <span class="hljs-comment">// void func(void)</span>
                        (<span class="hljs-keyword">this</span>-&gt;*mmf.pfn_vv)();
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
                        
                    <span class="hljs-keyword">case</span> AfxSig_vwp: <span class="hljs-comment">// void func(UINT, CPoint)</span>
                        (<span class="hljs-keyword">this</span>-&gt;*mmf.pfn_vwp)(wParam, 
                                            <span class="hljs-built_in">CPoint</span>(<span class="hljs-built_in">GET_X_LPARAM</span>(lParam), 
                                                  <span class="hljs-built_in">GET_Y_LPARAM</span>(lParam)));
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
                    <span class="hljs-comment">// æ›´å¤šå‡½æ•°ç­¾åå¤„ç†...</span>
                }
            }
        }
        
        <span class="hljs-comment">// 3. æœªæ‰¾åˆ°åˆ™ç»§ç»­åœ¨åŸºç±»ä¸­æŸ¥æ‰¾</span>
        pMessageMap = pMessageMap-&gt;pBaseMessageMap;
    }
    
    <span class="hljs-comment">// 4. æœªæ‰¾åˆ°ä»»ä½•å¤„ç†å‡½æ•°ï¼Œè°ƒç”¨é»˜è®¤çª—å£è¿‡ç¨‹</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">DefWindowProc</span>(message, wParam, lParam);
}
</code></pre>
<h3 data-id="heading-6">ä¸‰ã€æ¶ˆæ¯æ˜ å°„çš„åˆ†ç±»ä¸é«˜çº§ç‰¹æ€§</h3>
<h4 data-id="heading-7">3.1 å››ç±»æ¶ˆæ¯åŠå…¶å¤„ç†æ–¹å¼</h4>
<p>MFCå°†Windowsæ¶ˆæ¯ç³»ç»Ÿæ€§åœ°åˆ†ä¸ºå››ç±»ï¼Œæ¯ç±»æœ‰ä¸åŒçš„æ˜ å°„å®å’Œå¤„ç†æ¨¡å¼ï¼š</p>








































<table><thead><tr><th>æ¶ˆæ¯ç±»å‹</th><th>å…¸å‹ç¤ºä¾‹</th><th>æ˜ å°„å®</th><th>å¤„ç†å‡½æ•°ç‰¹å¾</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>æ ‡å‡†Windowsæ¶ˆæ¯</strong></td><td>WM_PAINT, WM_SIZE</td><td><code>ON_WM_XXXX()</code></td><td>å›ºå®šç­¾åï¼Œå¦‚<code>OnPaint()</code></td><td>çª—å£ç»˜åˆ¶ã€å¤§å°è°ƒæ•´ç­‰åŸºç¡€æ“ä½œ</td></tr><tr><td><strong>å‘½ä»¤æ¶ˆæ¯</strong></td><td>èœå•ç‚¹å‡»ã€å·¥å…·æ æŒ‰é’®</td><td><code>ON_COMMAND(id, func)</code></td><td>æ— å‚æ•°voidå‡½æ•°</td><td>ç”¨æˆ·å‘½ä»¤å“åº”</td></tr><tr><td><strong>æ§ä»¶é€šçŸ¥æ¶ˆæ¯</strong></td><td>æŒ‰é’®ç‚¹å‡»é€šçŸ¥ã€åˆ—è¡¨é¡¹é€‰æ‹©</td><td><code>ON_NOTIFY(code, id, func)</code></td><td>æ¥æ”¶NMHDRç»“æ„ä½“</td><td>å¤æ‚æ§ä»¶äº¤äº’</td></tr><tr><td><strong>åå°„æ¶ˆæ¯</strong></td><td>WM_CTLCOLOR, WM_DRAWITEM</td><td><code>ON_WM_CTLCOLOR_REFLECT()</code></td><td>å­æ§ä»¶è‡ªæˆ‘å¤„ç†</td><td>æ§ä»¶è‡ªå®šä¹‰ç»˜åˆ¶</td></tr></tbody></table>
<h4 data-id="heading-8">3.2 æ¶ˆæ¯åå°„æœºåˆ¶</h4>
<p>æ¶ˆæ¯åå°„æ˜¯MFCä¸­ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼Œå®ƒå…è®¸å­æ§ä»¶å¤„ç†é€šå¸¸ç”±çˆ¶çª—å£å¤„ç†çš„æ¶ˆæ¯ã€‚è¿™ç§æœºåˆ¶é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<ol>
<li>çˆ¶çª—å£æ”¶åˆ°å­æ§ä»¶çš„é€šçŸ¥æ¶ˆæ¯ï¼ˆå¦‚WM_CTLCOLORï¼‰</li>
<li>MFCæ¡†æ¶æ£€æŸ¥å­æ§ä»¶æ˜¯å¦èƒ½å¤„ç†åå°„æ¶ˆæ¯</li>
<li>å¦‚æœèƒ½ï¼Œå°†æ¶ˆæ¯åå°„å›å­æ§ä»¶</li>
<li>å­æ§ä»¶åœ¨è‡ªå·±çš„æ¶ˆæ¯æ˜ å°„è¡¨ä¸­å¤„ç†åå°„æ¶ˆæ¯</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è‡ªå®šä¹‰æŒ‰é’®ç±»å¤„ç†åå°„æ¶ˆæ¯çš„ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyButton</span> : <span class="hljs-keyword">public</span> CButton
{
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">afx_msg HBRUSH <span class="hljs-title">CtlColor</span><span class="hljs-params">(CDC* pDC, UINT nCtlColor)</span></span>;
};

<span class="hljs-built_in">BEGIN_MESSAGE_MAP</span>(CMyButton, CButton)
    <span class="hljs-built_in">ON_WM_CTLCOLOR_REFLECT</span>()  <span class="hljs-comment">// åå°„æ¶ˆæ¯å¤„ç†</span>
<span class="hljs-built_in">END_MESSAGE_MAP</span>()

<span class="hljs-function">HBRUSH <span class="hljs-title">CMyButton::CtlColor</span><span class="hljs-params">(CDC* pDC, UINT nCtlColor)</span>
</span>{
    <span class="hljs-comment">// æŒ‰é’®è‡ªè¡Œå†³å®šèƒŒæ™¯è‰²ï¼Œè€Œä¸æ˜¯ç”±å¯¹è¯æ¡†ç»Ÿä¸€æ§åˆ¶</span>
    pDC-&gt;<span class="hljs-built_in">SetTextColor</span>(<span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));  <span class="hljs-comment">// çº¢è‰²æ–‡å­—</span>
    pDC-&gt;<span class="hljs-built_in">SetBkColor</span>(<span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>));  <span class="hljs-comment">// é»„è‰²èƒŒæ™¯</span>
    
    <span class="hljs-function"><span class="hljs-type">static</span> CBrush <span class="hljs-title">yellowBrush</span><span class="hljs-params">(RGB(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>))</span></span>;
    <span class="hljs-keyword">return</span> yellowBrush;
}
</code></pre>
<h4 data-id="heading-9">3.3 æ¶ˆæ¯èŒƒå›´æ˜ å°„</h4>
<p>å¯¹äºå¤„ç†ä¸€ç³»åˆ—è¿ç»­IDçš„ç›¸ä¼¼å‘½ä»¤ï¼ŒMFCæä¾›äº†æ¶ˆæ¯èŒƒå›´æ˜ å°„æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¤„ç†IDä»ID_TOOL_BUTTON_FIRSTåˆ°ID_TOOL_BUTTON_LASTçš„æ‰€æœ‰å·¥å…·æ æŒ‰é’®</span>
<span class="hljs-built_in">BEGIN_MESSAGE_MAP</span>(CMyView, CView)
    <span class="hljs-built_in">ON_COMMAND_RANGE</span>(ID_TOOL_BUTTON_FIRST, ID_TOOL_BUTTON_LAST, OnToolButtonClicked)
<span class="hljs-built_in">END_MESSAGE_MAP</span>()

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnToolButtonClicked</span><span class="hljs-params">(UINT nID)</span>
</span>{
    <span class="hljs-comment">// æ ¹æ®å…·ä½“IDæ‰§è¡Œç›¸åº”æ“ä½œ</span>
    <span class="hljs-type">int</span> buttonIndex = nID - ID_TOOL_BUTTON_FIRST;
    <span class="hljs-comment">// å¤„ç†é€»è¾‘...</span>
}
</code></pre>
<h3 data-id="heading-10">å››ã€æ¶ˆæ¯æ˜ å°„çš„æ€§èƒ½ä¸è®¾è®¡æƒè¡¡</h3>
<h4 data-id="heading-11">4.1 æ€§èƒ½åˆ†æ</h4>
<p>MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶åœ¨æ€§èƒ½ä¸Šåšå‡ºäº†ä»¥ä¸‹æƒè¡¡ï¼š</p>
<ol>
<li><strong>ç©ºé—´æ¢æ—¶é—´</strong>ï¼šä¸ºæ¯ä¸ªçª—å£ç±»ç”Ÿæˆé™æ€æ¶ˆæ¯æ˜ å°„è¡¨ï¼Œå ç”¨é¢å¤–å†…å­˜ï¼Œä½†é¿å…äº†è¿è¡Œæ—¶çš„åŠ¨æ€æŸ¥æ‰¾å¼€é”€ã€‚</li>
<li><strong>çº¿æ€§æŸ¥æ‰¾</strong>ï¼šæ¶ˆæ¯æ˜ å°„è¡¨é€šå¸¸è¾ƒå°ï¼Œçº¿æ€§æŸ¥æ‰¾æ•ˆç‡å¯æ¥å—ã€‚å¯¹äºæœ‰å¤§é‡æ¶ˆæ¯å¤„ç†çš„å¤§å‹ç±»ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚</li>
<li><strong>ç»§æ‰¿é“¾æŸ¥æ‰¾</strong>ï¼šå½“æ¶ˆæ¯åœ¨å½“å‰ç±»æœªæ‰¾åˆ°æ—¶ï¼Œéœ€è¦æ²¿ç»§æ‰¿é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œè¿™å¢åŠ äº†å¤„ç†æœªå¤„ç†æ¶ˆæ¯çš„å¼€é”€ã€‚</li>
</ol>
<h4 data-id="heading-12">4.2 ä¸æ›¿ä»£æ–¹æ¡ˆçš„å¯¹æ¯”</h4>
<p>ä¸å…¶å®ƒæ¡†æ¶çš„æ¶ˆæ¯/äº‹ä»¶å¤„ç†æœºåˆ¶ç›¸æ¯”ï¼š</p>








































<table><thead><tr><th>æœºåˆ¶</th><th>ä»£è¡¨æ¡†æ¶</th><th>å®ç°æ–¹å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>æ¶ˆæ¯æ˜ å°„</strong></td><td>MFC</td><td>ç¼–è¯‘æ—¶é™æ€ç»‘å®šï¼Œçº¿æ€§æŸ¥æ‰¾</td><td>ç±»å‹å®‰å…¨ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥</td><td>ä¸å¤Ÿçµæ´»ï¼Œç»§æ‰¿é“¾æŸ¥æ‰¾å¼€é”€</td></tr><tr><td><strong>è™šå‡½æ•°è¡¨</strong></td><td>æ—©æœŸOWL</td><td>æ¯ä¸ªæ¶ˆæ¯å¯¹åº”è™šå‡½æ•°</td><td>ç›´æ¥è°ƒç”¨ï¼Œæ€§èƒ½é«˜</td><td>è™šå‡½æ•°è¡¨è†¨èƒ€ï¼ŒäºŒè¿›åˆ¶å…¼å®¹æ€§å·®</td></tr><tr><td><strong>ä¿¡å·æ§½</strong></td><td>Qt</td><td>è¿è¡Œæ—¶è¿æ¥ï¼Œå­—ç¬¦ä¸²åŒ¹é…</td><td>é«˜åº¦çµæ´»ï¼Œè·¨çº¿ç¨‹å®‰å…¨</td><td>è¿è¡Œæ—¶å¼€é”€ï¼Œç±»å‹å®‰å…¨æ£€æŸ¥å¼±</td></tr><tr><td><strong>å§”æ‰˜/äº‹ä»¶</strong></td><td>.NET</td><td>å¤šæ’­å§”æ‰˜ï¼Œå¼•ç”¨è®¡æ•°</td><td>ç±»å‹å®‰å…¨ï¼Œæ”¯æŒå¤šè®¢é˜…è€…</td><td>åƒåœ¾å›æ”¶ä¾èµ–ï¼Œéå®æ—¶ç³»ç»Ÿå¯èƒ½ä¸é€‚åˆ</td></tr></tbody></table>
<h3 data-id="heading-13">äº”ã€ç°ä»£æ¡†æ¶ä¸­çš„æ¶ˆæ¯æ˜ å°„é—äº§</h3>
<p>è™½ç„¶MFCæœ¬èº«å·²ä¸å†æ˜¯ä¸»æµå¼€å‘æ¡†æ¶ï¼Œä½†å…¶æ¶ˆæ¯æ˜ å°„çš„æ€æƒ³å½±å“äº†åç»­ä¼—å¤šUIæ¡†æ¶ï¼š</p>
<ol>
<li><strong>.NET WinForms</strong>ï¼šäº‹ä»¶å¤„ç†æ¨¡å‹å€Ÿé‰´äº†æ¶ˆæ¯æ˜ å°„çš„å¯¹è±¡åŒ–æ€æƒ³</li>
<li><strong>WPF/UWP</strong>ï¼šè·¯ç”±äº‹ä»¶æ¦‚å¿µå¯ä»¥è§†ä¸ºæ¶ˆæ¯æ˜ å°„çš„è¿›åŒ–å½¢å¼</li>
<li><strong>Qtä¿¡å·æ§½</strong>ï¼šè™½ç„¶å®ç°æœºåˆ¶ä¸åŒï¼Œä½†è§£å†³çš„é—®é¢˜åŸŸé«˜åº¦ç›¸ä¼¼</li>
</ol>
<p>åœ¨ç°ä»£C++ UIå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ç±»ä¼¼çš„æ¶ˆæ¯å¤„ç†æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ç°ä»£C++ UIæ¡†æ¶ä¸­çš„ç±»ä¼¼æ¨¡å¼ï¼ˆæ¦‚å¿µç¤ºä¾‹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ModernButton</span> : <span class="hljs-keyword">public</span> UIWidget
{
    <span class="hljs-comment">// å£°æ˜äº‹ä»¶å¤„ç†å™¨</span>
    EventHandler&lt;<span class="hljs-built_in">void</span>()&gt; onClick;
    
    <span class="hljs-comment">// è¿æ¥äº‹ä»¶</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setupEventHandlers</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// ç±»ä¼¼äºMFCçš„æ¶ˆæ¯æ˜ å°„ï¼Œä½†æ›´çµæ´»</span>
        onMouseDown += [<span class="hljs-keyword">this</span>](MouseEvent e) { <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">handleMouseDown</span>(e); };
        onClick += []() { <span class="hljs-comment">/* å¤„ç†ç‚¹å‡» */</span> };
    }
};
</code></pre>
<h3 data-id="heading-14">å…­ã€æ€»ç»“ï¼šæ¶ˆæ¯æ˜ å°„çš„è®¾è®¡å“²å­¦</h3>
<p>MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶çš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ƒæˆåŠŸåœ°å°†Windows APIçš„è¿‡ç¨‹å¼æ¶ˆæ¯å¤„ç†è½¬åŒ–ä¸ºé¢å‘å¯¹è±¡çš„èŒƒå¼ã€‚è¿™ä¸€è½¬åŒ–åŸºäºä»¥ä¸‹è®¾è®¡å“²å­¦ï¼š</p>
<ol>
<li><strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼šä¸åŒçª—å£ç±»åªå¤„ç†è‡ªå·±çš„æ¶ˆæ¯ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</li>
<li><strong>ç¼–è¯‘æ—¶å®‰å…¨</strong>ï¼šé€šè¿‡å®åœ¨ç¼–è¯‘æ—¶å»ºç«‹æ˜ å°„ï¼Œæ—©æœŸå‘ç°ç±»å‹ä¸åŒ¹é…é”™è¯¯ã€‚</li>
<li><strong>æ¡†æ¶é€æ˜æ€§</strong>ï¼šå¼€å‘è€…åªéœ€å…³æ³¨å¤„ç†å‡½æ•°æœ¬èº«ï¼Œå¤æ‚çš„æ¶ˆæ¯è·¯ç”±ç”±æ¡†æ¶å¤„ç†ã€‚</li>
</ol>
<p>ç„¶è€Œï¼Œè¿™ä¸€æœºåˆ¶ä¹Ÿæœ‰å…¶å†å²å±€é™æ€§ï¼Œç‰¹åˆ«æ˜¯ä¸ç°ä»£åå°„å’Œå§”æ‰˜æœºåˆ¶ç›¸æ¯”ï¼Œå®ƒç¼ºä¹è¶³å¤Ÿçš„çµæ´»æ€§å’Œè¡¨è¾¾èƒ½åŠ›ã€‚ç†è§£MFCæ¶ˆæ¯æ˜ å°„ä¸ä»…æœ‰åŠ©äºç»´æŠ¤é—ç•™ä»£ç ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒå±•ç¤ºäº†æ¡†æ¶è®¾è®¡è€…å¦‚ä½•é€šè¿‡æŠ½è±¡å’Œå°è£…æ¥ç®¡ç†å¹³å°APIçš„å¤æ‚æ€§ï¼Œè¿™ä¸€è®¾è®¡æ€ç»´å¯¹ä»Šå¤©çš„è½¯ä»¶å¼€å‘ä¾ç„¶å…·æœ‰å¯ç¤ºæ„ä¹‰ã€‚</p>
<h2 data-id="heading-15">ç¬¬äºŒç« ï¼šMFCæ–‡æ¡£/è§†å›¾æ¶æ„â€”â€”æ•°æ®ä¸ç•Œé¢çš„åˆ†ç¦»å®è·µ</h2>
<h3 data-id="heading-16">ä¸€ã€è®¾è®¡èµ·æºï¼šä»å•ä½“åº”ç”¨åˆ°æ¨¡å—åŒ–æ¶æ„çš„æ¼”è¿›</h3>
<p>åœ¨æ—©æœŸçš„Windowsåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªæ™®éçš„é—®é¢˜æ˜¯æ•°æ®ç®¡ç†ã€ç”¨æˆ·ç•Œé¢å’Œä¸šåŠ¡é€»è¾‘é«˜åº¦è€¦åˆã€‚ä»¥ç®€å•çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸ºä¾‹ï¼Œä¼ ç»Ÿè®¾è®¡å°†æ–‡ä»¶æ“ä½œã€æ–‡æœ¬æ˜¾ç¤ºå’Œç”¨æˆ·è¾“å…¥å¤„ç†å…¨éƒ¨æ··æ‚åœ¨çª—å£è¿‡ç¨‹ä¸­ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚</p>
<p>MFCæ–‡æ¡£/è§†å›¾æ¶æ„çš„æå‡ºï¼Œæ˜¯ä¸ºäº†è§£å†³è¿™ç§â€œå¤§æ³¥çƒâ€æ¶æ„é—®é¢˜ã€‚è¯¥æ¶æ„çš„æ ¸å¿ƒæ€æƒ³å€Ÿé‰´äº†è½¯ä»¶å·¥ç¨‹ä¸­çš„<strong>æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼ˆMVCï¼‰æ¨¡å¼</strong>ï¼Œä½†æ ¹æ®Windowså¹³å°çš„ç‰¹ç‚¹å’ŒC++è¯­è¨€çš„ç‰¹æ€§è¿›è¡Œäº†è°ƒæ•´å’Œä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-17">äºŒã€æ¶æ„ç»„æˆï¼šå››å¤§æ ¸å¿ƒç»„ä»¶çš„ååŒå·¥ä½œ</h3>
<p>æ–‡æ¡£/è§†å›¾æ¶æ„ç”±å››ä¸ªæ ¸å¿ƒç±»æ„æˆï¼Œå®ƒä»¬å„è‡ªæ‰¿æ‹…æ˜ç¡®çš„èŒè´£ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¶æ„æ ¸å¿ƒç±»å…³ç³»ç¤ºæ„ä»£ç </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CDocument</span>;  <span class="hljs-comment">// æ•°æ®ç®¡ç†å±‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CView</span>;      <span class="hljs-comment">// æ•°æ®æ˜¾ç¤ºä¸äº¤äº’å±‚  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CFrameWnd</span>;  <span class="hljs-comment">// çª—å£å®¹å™¨å±‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CDocTemplate</span>; <span class="hljs-comment">// å·¥å‚ä¸åè°ƒå±‚</span>

<span class="hljs-comment">// åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶çš„å…¸å‹è®¾ç½®</span>
<span class="hljs-function">BOOL <span class="hljs-title">CMyApp::InitInstance</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// 1. åˆ›å»ºæ–‡æ¡£æ¨¡æ¿ï¼ˆå…³é”®ç²˜åˆå‰‚ï¼‰</span>
    CSingleDocTemplate* pDocTemplate;
    pDocTemplate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">CSingleDocTemplate</span>(
        IDR_MAINFRAME,          <span class="hljs-comment">// èµ„æºIDï¼ˆèœå•ã€å›¾æ ‡ç­‰ï¼‰</span>
        <span class="hljs-built_in">RUNTIME_CLASS</span>(CMyDoc),  <span class="hljs-comment">// æ–‡æ¡£ç±»</span>
        <span class="hljs-built_in">RUNTIME_CLASS</span>(CMainFrame), <span class="hljs-comment">// æ¡†æ¶ç±»</span>
        <span class="hljs-built_in">RUNTIME_CLASS</span>(CMyView)  <span class="hljs-comment">// è§†å›¾ç±»</span>
    );
    
    <span class="hljs-comment">// 2. æ³¨å†Œæ¨¡æ¿</span>
    <span class="hljs-built_in">AddDocTemplate</span>(pDocTemplate);
    
    <span class="hljs-comment">// 3. åˆ›å»ºæˆ–æ‰“å¼€æ–‡æ¡£</span>
    <span class="hljs-built_in">OnFileNew</span>(); <span class="hljs-comment">// åˆ›å»ºæ–°æ–‡æ¡£</span>
    
    <span class="hljs-keyword">return</span> TRUE;
}
</code></pre>
<h4 data-id="heading-18">2.1 CDocumentï¼šæ•°æ®çš„å®ˆæŠ¤è€…</h4>
<p>æ–‡æ¡£ç±»æ˜¯æ¶æ„ä¸­çš„â€œæ¨¡å‹â€éƒ¨åˆ†ï¼Œè´Ÿè´£æ‰€æœ‰ä¸æ•°æ®ç›¸å…³çš„æ“ä½œï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyDocument</span> : <span class="hljs-keyword">public</span> CDocument
{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-built_in">CMyDocument</span>();
    
<span class="hljs-comment">// å±æ€§</span>
<span class="hljs-keyword">private</span>:
    CString m_strTitle;      <span class="hljs-comment">// æ–‡æ¡£æ ‡é¢˜</span>
    CStringArray m_lines;    <span class="hljs-comment">// æ–‡æœ¬è¡Œæ•°æ®</span>
    BOOL m_bModified;        <span class="hljs-comment">// ä¿®æ”¹æ ‡å¿—</span>
    
<span class="hljs-comment">// æ“ä½œ</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ•°æ®è®¿é—®æ¥å£</span>
    <span class="hljs-function"><span class="hljs-type">const</span> CString&amp; <span class="hljs-title">GetLine</span><span class="hljs-params">(<span class="hljs-type">int</span> nIndex)</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> m_lines[nIndex]; }
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">GetLineCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> m_lines.<span class="hljs-built_in">GetSize</span>(); }
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">AddLine</span><span class="hljs-params">(<span class="hljs-type">const</span> CString&amp; strLine)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DeleteLine</span><span class="hljs-params">(<span class="hljs-type">int</span> nIndex)</span></span>;
    
    <span class="hljs-comment">// é‡å†™åŸºç±»å…³é”®æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">OnNewDocument</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">OnOpenDocument</span><span class="hljs-params">(LPCTSTR lpszPathName)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">OnSaveDocument</span><span class="hljs-params">(LPCTSTR lpszPathName)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DeleteContents</span><span class="hljs-params">()</span></span>;
    
    <span class="hljs-comment">// åºåˆ—åŒ– - æ ¸å¿ƒæ•°æ®æŒä¹…åŒ–æœºåˆ¶</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">Serialize</span><span class="hljs-params">(CArchive&amp; ar)</span></span>;
    
    <span class="hljs-comment">// è§†å›¾é€šçŸ¥</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">UpdateAllViews</span><span class="hljs-params">(CView* pSender, LPARAM lHint = <span class="hljs-number">0L</span>, CObject* pHint = <span class="hljs-literal">NULL</span>)</span></span>;
    
    <span class="hljs-built_in">DECLARE_DYNCREATE</span>(CMyDocument)
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
};
</code></pre>
<p><strong>æ–‡æ¡£çš„å…³é”®èŒè´£åŒ…æ‹¬ï¼š</strong></p>
<ol>
<li><strong>æ•°æ®å­˜å‚¨ä¸ç®¡ç†</strong>ï¼šç»´æŠ¤åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒæ•°æ®ç»“æ„</li>
<li><strong>æŒä¹…åŒ–æ”¯æŒ</strong>ï¼šé€šè¿‡Serializeæ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™</li>
<li><strong>ä¿®æ”¹è¿½è¸ª</strong>ï¼šç®¡ç†â€œè„æ ‡å¿—â€ï¼ˆä¿®æ”¹çŠ¶æ€ï¼‰</li>
<li><strong>è§†å›¾åè°ƒ</strong>ï¼šé€šçŸ¥æ‰€æœ‰å…³è”è§†å›¾æ•°æ®å˜æ›´</li>
</ol>
<h4 data-id="heading-19">2.2 CViewï¼šæ•°æ®çš„è§‚å¯Ÿè€…ä¸äº¤äº’ç•Œé¢</h4>
<p>è§†å›¾ç±»æ˜¯æ¶æ„ä¸­çš„â€œè§†å›¾â€éƒ¨åˆ†ï¼Œè´Ÿè´£æ•°æ®çš„å¯è§†åŒ–å‘ˆç°å’Œç”¨æˆ·äº¤äº’ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyView</span> : <span class="hljs-keyword">public</span> CView
{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-built_in">CMyView</span>();
    
<span class="hljs-comment">// å±æ€§</span>
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> m_nCurrentLine;      <span class="hljs-comment">// å½“å‰é€‰ä¸­è¡Œ</span>
    CFont m_fontText;        <span class="hljs-comment">// æ˜¾ç¤ºå­—ä½“</span>
    CSize m_sizeChar;        <span class="hljs-comment">// å­—ç¬¦å°ºå¯¸</span>
    
<span class="hljs-comment">// æ“ä½œ</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è·å–å…³è”æ–‡æ¡£çš„å¼ºç±»å‹æŒ‡é’ˆ</span>
    <span class="hljs-function">CMyDocument* <span class="hljs-title">GetDocument</span><span class="hljs-params">()</span> <span class="hljs-type">const</span>
    </span>{
        <span class="hljs-keyword">return</span> (CMyDocument*)m_pDocument;
    }
    
    <span class="hljs-comment">// é‡å†™åŸºç±»å…³é”®æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnDraw</span><span class="hljs-params">(CDC* pDC)</span></span>;           <span class="hljs-comment">// ç»˜åˆ¶å†…å®¹</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnUpdate</span><span class="hljs-params">(CView* pSender, LPARAM lHint, CObject* pHint)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnInitialUpdate</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">PreCreateWindow</span><span class="hljs-params">(CREATESTRUCT&amp; cs)</span></span>;
    
    <span class="hljs-comment">// æ¶ˆæ¯å¤„ç†</span>
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnLButtonDown</span><span class="hljs-params">(UINT nFlags, CPoint point)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnKeyDown</span><span class="hljs-params">(UINT nChar, UINT nRepCnt, UINT nFlags)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnEditCut</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnEditCopy</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnEditPaste</span><span class="hljs-params">()</span></span>;
    
    <span class="hljs-built_in">DECLARE_DYNCREATE</span>(CMyView)
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
};
</code></pre>
<p>è§†å›¾é€šè¿‡<code>GetDocument()</code>æ–¹æ³•è·å–æ–‡æ¡£æŒ‡é’ˆï¼Œè¿™æ˜¯æ–‡æ¡£ä¸è§†å›¾é€šä¿¡çš„ä¸»è¦æ¡¥æ¢ã€‚è§†å›¾ä¸ç›´æ¥å­˜å‚¨æ•°æ®ï¼ŒåªæŒæœ‰å¯¹æ–‡æ¡£æ•°æ®çš„å¼•ç”¨ã€‚</p>
<h3 data-id="heading-20">ä¸‰ã€æ–‡æ¡£/è§†å›¾é€šä¿¡æœºåˆ¶</h3>
<h4 data-id="heading-21">3.1 æ•°æ®æµï¼šæ–‡æ¡£åˆ°è§†å›¾çš„æ›´æ–°</h4>
<p>æ–‡æ¡£æ•°æ®å˜åŒ–æ—¶ï¼Œé€šè¿‡<code>UpdateAllViews()</code>æ–¹æ³•é€šçŸ¥æ‰€æœ‰å…³è”çš„è§†å›¾ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ–‡æ¡£ç±»ä¸­ä¿®æ”¹æ•°æ®å¹¶é€šçŸ¥è§†å›¾</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDocument::AddLine</span><span class="hljs-params">(<span class="hljs-type">const</span> CString&amp; strLine)</span>
</span>{
    m_lines.<span class="hljs-built_in">Add</span>(strLine);
    m_bModified = TRUE;
    
    <span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰è§†å›¾æ•°æ®å·²æ›´æ–°</span>
    <span class="hljs-built_in">UpdateAllViews</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0L</span>, <span class="hljs-literal">NULL</span>);
    
    <span class="hljs-comment">// æˆ–è€…æºå¸¦æç¤ºä¿¡æ¯ï¼Œä¼˜åŒ–æ›´æ–°æ•ˆç‡</span>
    <span class="hljs-comment">// UpdateAllViews(NULL, UPDATE_LINE_ADDED, (CObject*)&amp;strLine);</span>
}
</code></pre>
<p>è§†å›¾æ¥æ”¶æ›´æ–°é€šçŸ¥å¹¶é‡ç»˜ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è§†å›¾ç±»ä¸­å“åº”æ›´æ–°é€šçŸ¥</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnUpdate</span><span class="hljs-params">(CView* pSender, LPARAM lHint, CObject* pHint)</span>
</span>{
    <span class="hljs-comment">// æ ¹æ®æç¤ºä¿¡æ¯å†³å®šæ›´æ–°ç­–ç•¥</span>
    <span class="hljs-keyword">if</span> (lHint == UPDATE_LINE_ADDED)
    {
        <span class="hljs-comment">// å±€éƒ¨æ›´æ–°ï¼šåªæ›´æ–°æ–°å¢è¡ŒåŒºåŸŸ</span>
        CString* pNewLine = (CString*)pHint;
        CRect rectUpdate = <span class="hljs-built_in">CalculateLineRect</span>(m_lines.<span class="hljs-built_in">GetSize</span>()<span class="hljs-number">-1</span>);
        <span class="hljs-built_in">InvalidateRect</span>(&amp;rectUpdate);
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-comment">// å®Œå…¨æ›´æ–°ï¼šé‡ç»˜æ•´ä¸ªå®¢æˆ·åŒº</span>
        <span class="hljs-built_in">Invalidate</span>();
    }
}
</code></pre>
<h4 data-id="heading-22">3.2 äº¤äº’æµï¼šè§†å›¾åˆ°æ–‡æ¡£çš„ä¿®æ”¹</h4>
<p>ç”¨æˆ·é€šè¿‡è§†å›¾ç•Œé¢ä¿®æ”¹æ•°æ®æ—¶ï¼Œè§†å›¾è°ƒç”¨æ–‡æ¡£çš„æ¥å£ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è§†å›¾å¤„ç†ç”¨æˆ·è¾“å…¥å¹¶ä¿®æ”¹æ–‡æ¡£</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnChar</span><span class="hljs-params">(UINT nChar, UINT nRepCnt, UINT nFlags)</span>
</span>{
    CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
    
    <span class="hljs-keyword">if</span> (nChar == VK_RETURN)  <span class="hljs-comment">// å›è½¦é”®</span>
    {
        pDoc-&gt;<span class="hljs-built_in">AddLine</span>(m_strCurrentLine);  <span class="hljs-comment">// è°ƒç”¨æ–‡æ¡£æ–¹æ³•</span>
        m_strCurrentLine.<span class="hljs-built_in">Empty</span>();
    }
    <span class="hljs-keyword">else</span>
    {
        m_strCurrentLine += (TCHAR)nChar;
    }
    
    <span class="hljs-comment">// é‡ç»˜å½“å‰è¡Œ</span>
    CRect rectUpdate = <span class="hljs-built_in">CalculateCurrentLineRect</span>();
    <span class="hljs-built_in">InvalidateRect</span>(&amp;rectUpdate);
    
    CView::<span class="hljs-built_in">OnChar</span>(nChar, nRepCnt, nFlags);
}
</code></pre>
<h3 data-id="heading-23">å››ã€å¤šè§†å›¾æ”¯æŒï¼šä¸€æ¡£å¤šè§†çš„å®ç°</h3>
<p>æ–‡æ¡£/è§†å›¾æ¶æ„æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€æ˜¯æ”¯æŒå•ä¸ªæ–‡æ¡£å¯¹åº”å¤šä¸ªè§†å›¾ï¼Œè¿™åœ¨CADã€å›¾å½¢ç¼–è¾‘ç­‰åº”ç”¨ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åˆ›å»ºåŒä¸€æ–‡æ¡£çš„ç¬¬äºŒä¸ªè§†å›¾</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMainFrame::OnWindowNewView</span><span class="hljs-params">()</span>
</span>{
    CMyDocument* pDoc = (CMyDocument*)<span class="hljs-built_in">GetActiveDocument</span>();
    
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„æ¡†æ¶çª—å£</span>
    CChildFrame* pNewFrame = <span class="hljs-keyword">new</span> CChildFrame;
    
    <span class="hljs-comment">// åŠ¨æ€åˆ›å»ºæ–°è§†å›¾</span>
    CCreateContext context;
    context.m_pCurrentDoc = pDoc;
    context.m_pNewViewClass = <span class="hljs-built_in">RUNTIME_CLASS</span>(CMyView);
    
    <span class="hljs-comment">// åˆ›å»ºè§†å›¾å¹¶å…³è”åˆ°æ–°æ¡†æ¶</span>
    <span class="hljs-keyword">if</span> (!pNewFrame-&gt;<span class="hljs-built_in">LoadFrame</span>(IDR_MYTYPE, WS_OVERLAPPEDWINDOW, 
                              <span class="hljs-keyword">this</span>, &amp;context))
    {
        <span class="hljs-keyword">delete</span> pNewFrame;
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ˜¾ç¤ºæ–°çª—å£</span>
    pNewFrame-&gt;<span class="hljs-built_in">InitialUpdateFrame</span>(pDoc, TRUE);
}

<span class="hljs-comment">// ä¸åŒç±»å‹çš„è§†å›¾å¯ä»¥å±•ç¤ºåŒä¸€æ–‡æ¡£çš„ä¸åŒæ–¹é¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CGraphView</span> : <span class="hljs-keyword">public</span> CView  <span class="hljs-comment">// å›¾å½¢è§†å›¾</span>
{
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnDraw</span><span class="hljs-params">(CDC* pDC)</span>
    </span>{
        CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
        <span class="hljs-comment">// å°†æ–‡æœ¬æ•°æ®è½¬æ¢ä¸ºå›¾å½¢å±•ç¤º</span>
        <span class="hljs-built_in">DrawTextAsGraph</span>(pDC, pDoc-&gt;<span class="hljs-built_in">GetAllLines</span>());
    }
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CStatsView</span> : <span class="hljs-keyword">public</span> CView  <span class="hljs-comment">// ç»Ÿè®¡è§†å›¾</span>
{
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnDraw</span><span class="hljs-params">(CDC* pDC)</span>
    </span>{
        CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
        <span class="hljs-comment">// æ˜¾ç¤ºæ–‡æœ¬çš„ç»Ÿè®¡ä¿¡æ¯</span>
        <span class="hljs-built_in">DrawStatistics</span>(pDC, pDoc-&gt;<span class="hljs-built_in">CalculateStats</span>());
    }
};
</code></pre>
<h3 data-id="heading-24">äº”ã€åºåˆ—åŒ–ï¼šæ–‡æ¡£æŒä¹…åŒ–çš„æ ¸å¿ƒæœºåˆ¶</h3>
<p>åºåˆ—åŒ–æ˜¯æ–‡æ¡£/è§†å›¾æ¶æ„çš„æ•°æ®æŒä¹…åŒ–åŸºç¡€ï¼Œå®ƒé€šè¿‡<code>CArchive</code>ç±»å®ç°æ•°æ®çš„äºŒè¿›åˆ¶æµå¼è¯»å†™ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ–‡æ¡£ç±»çš„åºåˆ—åŒ–å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDocument::Serialize</span><span class="hljs-params">(CArchive&amp; ar)</span>
</span>{
    <span class="hljs-keyword">if</span> (ar.<span class="hljs-built_in">IsStoring</span>())  <span class="hljs-comment">// ä¿å­˜æ–‡æ¡£</span>
    {
        <span class="hljs-comment">// å†™å…¥ç‰ˆæœ¬æ ‡è¯†</span>
        ar &lt;&lt; (WORD)<span class="hljs-number">0x0001</span>;  <span class="hljs-comment">// ç‰ˆæœ¬1.0</span>
        
        <span class="hljs-comment">// å†™å…¥æ–‡æ¡£å±æ€§</span>
        ar &lt;&lt; m_strTitle;
        ar &lt;&lt; m_bModified;
        
        <span class="hljs-comment">// å†™å…¥æ•°æ®å†…å®¹</span>
        m_lines.<span class="hljs-built_in">Serialize</span>(ar);  <span class="hljs-comment">// CStringArrayæ”¯æŒåºåˆ—åŒ–</span>
        
        <span class="hljs-comment">// å†™å…¥è‡ªå®šä¹‰å¯¹è±¡</span>
        <span class="hljs-keyword">if</span> (m_pCustomObj != <span class="hljs-literal">NULL</span>)
        {
            ar &lt;&lt; (WORD)<span class="hljs-number">1</span>;  <span class="hljs-comment">// æ ‡è®°æœ‰å¯¹è±¡</span>
            ar.<span class="hljs-built_in">WriteObject</span>(m_pCustomObj);  <span class="hljs-comment">// å†™å…¥å¯åºåˆ—åŒ–å¯¹è±¡</span>
        }
        <span class="hljs-keyword">else</span>
        {
            ar &lt;&lt; (WORD)<span class="hljs-number">0</span>;  <span class="hljs-comment">// æ ‡è®°æ— å¯¹è±¡</span>
        }
    }
    <span class="hljs-keyword">else</span>  <span class="hljs-comment">// åŠ è½½æ–‡æ¡£</span>
    {
        <span class="hljs-comment">// è¯»å–ç‰ˆæœ¬æ ‡è¯†</span>
        WORD wVersion;
        ar &gt;&gt; wVersion;
        
        <span class="hljs-keyword">if</span> (wVersion == <span class="hljs-number">0x0001</span>)
        {
            <span class="hljs-comment">// è¯»å–æ–‡æ¡£å±æ€§</span>
            ar &gt;&gt; m_strTitle;
            ar &gt;&gt; m_bModified;
            
            <span class="hljs-comment">// è¯»å–æ•°æ®å†…å®¹</span>
            m_lines.<span class="hljs-built_in">Serialize</span>(ar);
            
            <span class="hljs-comment">// è¯»å–è‡ªå®šä¹‰å¯¹è±¡</span>
            WORD wHasObject;
            ar &gt;&gt; wHasObject;
            <span class="hljs-keyword">if</span> (wHasObject == <span class="hljs-number">1</span>)
            {
                m_pCustomObj = (CCustomObject*)ar.<span class="hljs-built_in">ReadObject</span>(
                    <span class="hljs-built_in">RUNTIME_CLASS</span>(CCustomObject));
            }
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-comment">// å¤„ç†æ—§ç‰ˆæœ¬æ ¼å¼</span>
            <span class="hljs-built_in">LoadOldFormat</span>(ar, wVersion);
        }
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰å¯åºåˆ—åŒ–å¯¹è±¡çš„å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CCustomObject</span> : <span class="hljs-keyword">public</span> CObject
{
    <span class="hljs-built_in">DECLARE_SERIAL</span>(CCustomObject)
    
<span class="hljs-keyword">private</span>:
    CString m_strData;
    <span class="hljs-type">int</span> m_nValue;
    CPointArray m_points;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">Serialize</span><span class="hljs-params">(CArchive&amp; ar)</span>
    </span>{
        CObject::<span class="hljs-built_in">Serialize</span>(ar);
        
        <span class="hljs-keyword">if</span> (ar.<span class="hljs-built_in">IsStoring</span>())
        {
            ar &lt;&lt; m_strData &lt;&lt; m_nValue;
            m_points.<span class="hljs-built_in">Serialize</span>(ar);
        }
        <span class="hljs-keyword">else</span>
        {
            ar &gt;&gt; m_strData &gt;&gt; m_nValue;
            m_points.<span class="hljs-built_in">Serialize</span>(ar);
        }
    }
    
    <span class="hljs-comment">// å¿…é¡»æœ‰æ— å‚æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">CCustomObject</span>() { }
};

<span class="hljs-built_in">IMPLEMENT_SERIAL</span>(CCustomObject, CObject, VERSIONABLE_SCHEMA | <span class="hljs-number">1</span>)
</code></pre>
<h3 data-id="heading-25">å…­ã€ä¸ç»å…¸MVCæ¶æ„çš„æ·±åº¦å¯¹æ¯”</h3>
<h4 data-id="heading-26">6.1 ç›¸ä¼¼æ€§ï¼šåˆ†ç¦»å…³æ³¨ç‚¹çš„å…±åŒè¿½æ±‚</h4>
<p>æ–‡æ¡£/è§†å›¾æ¶æ„ä¸MVCéƒ½éµå¾ªäº†æ•°æ®ä¸æ˜¾ç¤ºåˆ†ç¦»çš„åŸåˆ™ï¼š</p>





























<table><thead><tr><th>æ¦‚å¿µå¯¹åº”</th><th>MVCç»„ä»¶</th><th>æ–‡æ¡£/è§†å›¾ç»„ä»¶</th><th>èŒè´£ç›¸ä¼¼åº¦</th></tr></thead><tbody><tr><td>æ•°æ®å±‚</td><td>Model</td><td>Document</td><td>é«˜ï¼šéƒ½è´Ÿè´£æ•°æ®ç®¡ç†å’Œä¸šåŠ¡è§„åˆ™</td></tr><tr><td>æ˜¾ç¤ºå±‚</td><td>View</td><td>View</td><td>é«˜ï¼šéƒ½è´Ÿè´£æ•°æ®å¯è§†åŒ–</td></tr><tr><td>æ§åˆ¶å±‚</td><td>Controller</td><td>åˆ†æ•£å¤„ç†</td><td>ä½ï¼šMVCæœ‰ç‹¬ç«‹æ§åˆ¶å™¨</td></tr></tbody></table>
<h4 data-id="heading-27">6.2 å·®å¼‚æ€§ï¼šæ¶æ„å®Œæ•´æ€§çš„æœ¬è´¨åŒºåˆ«</h4>
<p>å…³é”®å·®å¼‚åœ¨äºæ§åˆ¶å±‚çš„å¤„ç†æ–¹å¼ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// MVCçš„æ˜ç¡®æ§åˆ¶æµ</span>
<span class="hljs-comment">// 1. ç”¨æˆ·è¾“å…¥ -&gt; Controller</span>
<span class="hljs-comment">// 2. Controlleræ›´æ–°Model</span>
<span class="hljs-comment">// 3. Modelé€šçŸ¥Viewæ›´æ–°</span>

<span class="hljs-comment">// æ–‡æ¡£/è§†å›¾çš„æ··åˆæ§åˆ¶æµ</span>
<span class="hljs-comment">// 1. ç”¨æˆ·è¾“å…¥ -&gt; Viewï¼ˆç›´æ¥å¤„ç†ï¼‰</span>
<span class="hljs-comment">// 2. Viewæ›´æ–°Documentï¼ˆç›´æ¥è°ƒç”¨ï¼‰</span>
<span class="hljs-comment">// 3. Documenté€šçŸ¥æ‰€æœ‰Viewæ›´æ–°</span>
</code></pre>
<p><strong>æ¶æ„å·®å¼‚çš„å…·ä½“è¡¨ç°ï¼š</strong></p>
<ol>
<li>
<p><strong>æ§åˆ¶å™¨è§’è‰²çš„ç¼ºå¤±</strong></p>
<ul>
<li>MVCï¼šControlleræ˜¯ç‹¬ç«‹çš„åè°ƒè€…ï¼Œå†³å®šå¦‚ä½•å“åº”è¾“å…¥</li>
<li>æ–‡æ¡£/è§†å›¾ï¼šæ§åˆ¶é€»è¾‘åˆ†æ•£åœ¨Viewå’ŒDocumentä¸­</li>
</ul>
</li>
<li>
<p><strong>é€šä¿¡æ¨¡å¼çš„ä¸åŒ</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// MVCï¼šè§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ¾è€¦åˆ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Model</span> {
    List&lt;Observer&gt; observers;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">notifyObservers</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">for</span> (obs in observers) obs.<span class="hljs-built_in">update</span>();
    }
};

<span class="hljs-comment">// æ–‡æ¡£/è§†å›¾ï¼šç›´æ¥è°ƒç”¨ï¼Œç´§è€¦åˆ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Document</span> {
    List&lt;View*&gt; views;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">UpdateAllViews</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">for</span> (view in views) view-&gt;<span class="hljs-built_in">OnUpdate</span>(<span class="hljs-keyword">this</span>);
    }
};
</code></pre>
</li>
<li>
<p><strong>å¯æµ‹è¯•æ€§çš„å½±å“</strong></p>
<ul>
<li>MVCï¼šModelå’ŒControllerå¯ç‹¬ç«‹äºViewè¿›è¡Œå•å…ƒæµ‹è¯•</li>
<li>æ–‡æ¡£/è§†å›¾ï¼šViewå’ŒDocumentç´§å¯†è€¦åˆï¼Œæµ‹è¯•å›°éš¾</li>
</ul>
</li>
</ol>
<h3 data-id="heading-28">ä¸ƒã€æ¶æ„çš„é€‚ç”¨åœºæ™¯ä¸å±€é™æ€§</h3>
<h4 data-id="heading-29">7.1 ç†æƒ³é€‚ç”¨åœºæ™¯</h4>
<p>æ–‡æ¡£/è§†å›¾æ¶æ„ç‰¹åˆ«é€‚åˆä»¥ä¸‹ç±»å‹çš„åº”ç”¨ï¼š</p>
<ol>
<li><strong>æ–‡æ¡£ä¸­å¿ƒå‹åº”ç”¨</strong>ï¼šæ–‡å­—å¤„ç†å™¨ã€ç”µå­è¡¨æ ¼ã€ä»£ç ç¼–è¾‘å™¨</li>
<li><strong>å¤šè§†å›¾æ•°æ®å±•ç¤º</strong>ï¼šCADç³»ç»Ÿã€æ•°æ®åˆ†æå·¥å…·ã€æ•°æ®åº“å‰ç«¯</li>
<li><strong>éœ€è¦å®Œæ•´æ–‡ä»¶æ”¯æŒçš„åº”ç”¨</strong>ï¼šæ”¯æŒæ‰“å¼€ã€ä¿å­˜ã€å¦å­˜ä¸ºç­‰æ ‡å‡†æ“ä½œ</li>
</ol>
<h4 data-id="heading-30">7.2 æ¶æ„å±€é™æ€§</h4>
<ol>
<li><strong>å­¦ä¹ æ›²çº¿é™¡å³­</strong>ï¼šéœ€è¦ç†è§£å¤§é‡MFCç‰¹å®šæ¦‚å¿µå’Œå®</li>
<li><strong>è¿‡åº¦è®¾è®¡ç®€å•åº”ç”¨</strong>ï¼šå¯¹äºå¯¹è¯æ¡†åº”ç”¨è¿‡äºå¤æ‚</li>
<li><strong>å¹³å°é”å®š</strong>ï¼šæ·±åº¦ç»‘å®šWindowså’ŒMFCæ¡†æ¶</li>
<li><strong>ç°ä»£æ€§ä¸è¶³</strong>ï¼šç¼ºä¹å¯¹è§¦æ‘¸ã€æ‰‹åŠ¿ç­‰ç°ä»£äº¤äº’çš„æ”¯æŒ</li>
</ol>
<h3 data-id="heading-31">å…«ã€å®é™…åº”ç”¨ç¤ºä¾‹ï¼šç®€æ˜“æ–‡æœ¬ç¼–è¾‘å™¨</h3>
<p>ä»¥ä¸‹æ˜¯æ–‡æ¡£/è§†å›¾æ¶æ„åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„å®Œæ•´å®ç°ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ–‡æ¡£ç±» - ç®¡ç†æ–‡æœ¬æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CTextDocument</span> : <span class="hljs-keyword">public</span> CDocument
{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-built_in">CTextDocument</span>();
    
    <span class="hljs-comment">// æ•°æ®å­˜å‚¨</span>
    CStringArray m_lines;
    <span class="hljs-type">int</span> m_nTotalChars;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ•°æ®æ“ä½œæ¥å£</span>
    <span class="hljs-function">BOOL <span class="hljs-title">InsertText</span><span class="hljs-params">(<span class="hljs-type">int</span> nLine, <span class="hljs-type">int</span> nPos, <span class="hljs-type">const</span> CString&amp; strText)</span></span>;
    <span class="hljs-function">BOOL <span class="hljs-title">DeleteText</span><span class="hljs-params">(<span class="hljs-type">int</span> nLine, <span class="hljs-type">int</span> nPos, <span class="hljs-type">int</span> nCount)</span></span>;
    <span class="hljs-function">CString <span class="hljs-title">GetText</span><span class="hljs-params">(<span class="hljs-type">int</span> nLine, <span class="hljs-type">int</span> nPos, <span class="hljs-type">int</span> nCount)</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-comment">// é‡å†™å…³é”®æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">OnNewDocument</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">Serialize</span><span class="hljs-params">(CArchive&amp; ar)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DeleteContents</span><span class="hljs-params">()</span></span>;
    
    <span class="hljs-built_in">DECLARE_DYNCREATE</span>(CTextDocument)
};

<span class="hljs-comment">// è§†å›¾ç±» - æ˜¾ç¤ºå’Œç¼–è¾‘æ–‡æœ¬</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CTextView</span> : <span class="hljs-keyword">public</span> CScrollView
{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-built_in">CTextView</span>();
    
    <span class="hljs-comment">// ç¼–è¾‘çŠ¶æ€</span>
    <span class="hljs-type">int</span> m_nCaretLine;    <span class="hljs-comment">// å…‰æ ‡æ‰€åœ¨è¡Œ</span>
    <span class="hljs-type">int</span> m_nCaretPos;     <span class="hljs-comment">// å…‰æ ‡åœ¨è¡Œä¸­çš„ä½ç½®</span>
    BOOL m_bSelecting;   <span class="hljs-comment">// æ˜¯å¦åœ¨é€‰æ‹©æ–‡æœ¬</span>
    CPoint m_ptSelectStart; <span class="hljs-comment">// é€‰æ‹©èµ·å§‹ç‚¹</span>
    
    <span class="hljs-comment">// æ˜¾ç¤ºå±æ€§</span>
    CFont m_font;
    CSize m_sizeChar;    <span class="hljs-comment">// å­—ç¬¦å°ºå¯¸</span>
    <span class="hljs-type">int</span> m_nLinesPerPage; <span class="hljs-comment">// æ¯é¡µè¡Œæ•°</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">CTextDocument* <span class="hljs-title">GetDocument</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-comment">// é‡å†™å…³é”®æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnDraw</span><span class="hljs-params">(CDC* pDC)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnInitialUpdate</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnUpdate</span><span class="hljs-params">(CView* pSender, LPARAM lHint, CObject* pHint)</span></span>;
    
    <span class="hljs-comment">// æ¶ˆæ¯å¤„ç†</span>
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnLButtonDown</span><span class="hljs-params">(UINT nFlags, CPoint point)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnMouseMove</span><span class="hljs-params">(UINT nFlags, CPoint point)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnLButtonUp</span><span class="hljs-params">(UINT nFlags, CPoint point)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnKeyDown</span><span class="hljs-params">(UINT nChar, UINT nRepCnt, UINT nFlags)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnChar</span><span class="hljs-params">(UINT nChar, UINT nRepCnt, UINT nFlags)</span></span>;
    <span class="hljs-function">afx_msg <span class="hljs-type">void</span> <span class="hljs-title">OnVScroll</span><span class="hljs-params">(UINT nSBCode, UINT nPos, CScrollBar* pScrollBar)</span></span>;
    
    <span class="hljs-comment">// è®¡ç®—è¾…åŠ©å‡½æ•°</span>
    <span class="hljs-function">CPoint <span class="hljs-title">CharPosFromPoint</span><span class="hljs-params">(CPoint point)</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function">CPoint <span class="hljs-title">PointFromCharPos</span><span class="hljs-params">(<span class="hljs-type">int</span> nLine, <span class="hljs-type">int</span> nPos)</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function">CRect <span class="hljs-title">GetLineRect</span><span class="hljs-params">(<span class="hljs-type">int</span> nLine)</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-built_in">DECLARE_DYNCREATE</span>(CTextView)
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
};
</code></pre>
<h3 data-id="heading-32">ä¹ã€ç°ä»£æ¡†æ¶ä¸­çš„æ¼”è¿›ä¸å¯ç¤º</h3>
<p>è™½ç„¶MFCæ–‡æ¡£/è§†å›¾æ¶æ„å·²é€æ¸é€€å‡ºä¸»æµï¼Œä½†å…¶è®¾è®¡æ€æƒ³åœ¨ç°ä»£æ¡†æ¶ä¸­ä»æœ‰ä½“ç°ï¼š</p>
<ol>
<li><strong>æ•°æ®ç»‘å®š</strong>ï¼šWPF/XAMLçš„æ•°æ®ç»‘å®šæœºåˆ¶æ˜¯æ–‡æ¡£/è§†å›¾åˆ†ç¦»çš„è¿›åŒ–</li>
<li><strong>MVVMæ¨¡å¼</strong>ï¼šModel-View-ViewModelå¯è§†ä¸ºæ–‡æ¡£/è§†å›¾çš„ç°ä»£åŒ–èº«</li>
<li><strong>å“åº”å¼ç¼–ç¨‹</strong>ï¼šRxJSç­‰åº“å®ç°äº†æ›´çµæ´»çš„æ•°æ®-è§†å›¾åŒæ­¥</li>
</ol>
<p><strong>æ¶æ„æ¼”è¿›çš„å¯ç¤ºï¼š</strong></p>
<ul>
<li>å…³æ³¨ç‚¹åˆ†ç¦»æ˜¯æ°¸æ’çš„è®¾è®¡åŸåˆ™</li>
<li>æ¡†æ¶åº”è¯¥æä¾›æ¸…æ™°çš„æ•°æ®æµæŒ‡å¯¼</li>
<li>å¯æµ‹è¯•æ€§åº”è¯¥æˆä¸ºæ¶æ„çš„æ ¸å¿ƒè€ƒé‡</li>
<li>å¹³å°æŠ½è±¡å±‚å¯¹äºé•¿æœŸç»´æŠ¤è‡³å…³é‡è¦</li>
</ul>
<p>æ–‡æ¡£/è§†å›¾æ¶æ„å±•ç¤ºäº†åœ¨ç‰¹å®šæŠ€æœ¯çº¦æŸä¸‹ï¼ˆC++ã€Windowsã€90å¹´ä»£ç¡¬ä»¶ï¼‰å¦‚ä½•å®ç°å¤æ‚åº”ç”¨çš„ç»“æ„åŒ–ç»„ç»‡ã€‚è™½ç„¶å…·ä½“æŠ€æœ¯å·²è¿‡æ—¶ï¼Œä½†å…¶èƒŒåçš„æ¶æ„æ€ç»´â€”â€”å¦‚ä½•ç®¡ç†å¤æ‚æ€§ã€å¦‚ä½•åˆ†ç¦»å…³æ³¨ç‚¹ã€å¦‚ä½•è®¾è®¡å¯æ‰©å±•çš„ç³»ç»Ÿâ€”â€”å¯¹ä»Šå¤©çš„è½¯ä»¶å¼€å‘è€…ä»æœ‰é‡è¦ä»·å€¼ã€‚</p>
<h2 data-id="heading-33">ç¬¬ä¸‰ç« ï¼šMFCå¯¹è¯æ¡†ä¸DDX/DDVæœºåˆ¶â€”â€”ç”¨æˆ·ç•Œé¢çš„æ ‡å‡†åŒ–å°è£…</h2>
<h3 data-id="heading-34">ä¸€ã€å¯¹è¯æ¡†ç¼–ç¨‹çš„æ¼”è¿›ï¼šä»åŸå§‹APIåˆ°MFCå°è£…</h3>
<p>åœ¨åŸå§‹çš„Windows SDKä¸­ï¼Œåˆ›å»ºå’Œç®¡ç†å¯¹è¯æ¡†æ˜¯ä¸€é¡¹ç¹çä¸”å®¹æ˜“å‡ºé”™çš„å·¥ä½œã€‚å¼€å‘è€…éœ€è¦æ‰‹åŠ¨å¤„ç†å¯¹è¯æ¡†è¿‡ç¨‹å‡½æ•°ã€æ§ä»¶æ¶ˆæ¯ã€æ•°æ®éªŒè¯ç­‰ä¸€ç³»åˆ—å¤æ‚ä»»åŠ¡ã€‚MFCçš„å¯¹è¯æ¡†ç±»ï¼ˆCDialogåŠå…¶æ´¾ç”Ÿç±»ï¼‰é€šè¿‡é¢å‘å¯¹è±¡çš„å°è£…ï¼Œæå¤§åœ°ç®€åŒ–äº†è¿™ä¸€è¿‡ç¨‹ã€‚</p>
<h4 data-id="heading-35">1.1 åŸå§‹Win32å¯¹è¯æ¡†ç¼–ç¨‹çš„å¤æ‚æ€§</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Win32 SDKä¸­çš„å¯¹è¯æ¡†ç¤ºä¾‹</span>
<span class="hljs-function">BOOL CALLBACK <span class="hljs-title">DialogProc</span><span class="hljs-params">(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)</span>
</span>{
    <span class="hljs-keyword">switch</span> (uMsg)
    {
        <span class="hljs-keyword">case</span> WM_INITDIALOG:
            <span class="hljs-comment">// åˆå§‹åŒ–æ§ä»¶</span>
            <span class="hljs-built_in">SetDlgItemText</span>(hwndDlg, IDC_EDIT_NAME, <span class="hljs-string">"é»˜è®¤åç§°"</span>);
            <span class="hljs-built_in">SetDlgItemInt</span>(hwndDlg, IDC_EDIT_AGE, <span class="hljs-number">25</span>, FALSE);
            <span class="hljs-keyword">return</span> TRUE;
            
        <span class="hljs-keyword">case</span> WM_COMMAND:
            <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">LOWORD</span>(wParam))
            {
                <span class="hljs-keyword">case</span> IDOK:
                {
                    <span class="hljs-comment">// è·å–æ•°æ®</span>
                    TCHAR szName[<span class="hljs-number">100</span>];
                    <span class="hljs-built_in">GetDlgItemText</span>(hwndDlg, IDC_EDIT_NAME, szName, <span class="hljs-number">100</span>);
                    
                    <span class="hljs-comment">// æ‰‹åŠ¨éªŒè¯</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">lstrlen</span>(szName) == <span class="hljs-number">0</span>)
                    {
                        <span class="hljs-built_in">MessageBox</span>(hwndDlg, <span class="hljs-string">"å§“åä¸èƒ½ä¸ºç©º"</span>, <span class="hljs-string">"é”™è¯¯"</span>, MB_OK);
                        <span class="hljs-keyword">return</span> TRUE;
                    }
                    
                    <span class="hljs-type">int</span> nAge = <span class="hljs-built_in">GetDlgItemInt</span>(hwndDlg, IDC_EDIT_AGE, <span class="hljs-literal">NULL</span>, FALSE);
                    <span class="hljs-keyword">if</span> (nAge &lt; <span class="hljs-number">0</span> || nAge &gt; <span class="hljs-number">150</span>)
                    {
                        <span class="hljs-built_in">MessageBox</span>(hwndDlg, <span class="hljs-string">"å¹´é¾„å¿…é¡»åœ¨0-150ä¹‹é—´"</span>, <span class="hljs-string">"é”™è¯¯"</span>, MB_OK);
                        <span class="hljs-keyword">return</span> TRUE;
                    }
                    
                    <span class="hljs-built_in">EndDialog</span>(hwndDlg, IDOK);
                    <span class="hljs-keyword">return</span> TRUE;
                }
                
                <span class="hljs-keyword">case</span> IDCANCEL:
                    <span class="hljs-built_in">EndDialog</span>(hwndDlg, IDCANCEL);
                    <span class="hljs-keyword">return</span> TRUE;
            }
            <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">return</span> FALSE;
}

<span class="hljs-comment">// è°ƒç”¨å¯¹è¯æ¡†</span>
<span class="hljs-built_in">DialogBox</span>(hInstance, <span class="hljs-built_in">MAKEINTRESOURCE</span>(IDD_MYDIALOG), hwndParent, DialogProc);
</code></pre>
<p>è¿™ç§æ¨¡å¼å­˜åœ¨æ˜æ˜¾é—®é¢˜ï¼š</p>
<ol>
<li><strong>ä»£ç å†—é•¿</strong>ï¼šæ¯ä¸ªæ§ä»¶éƒ½éœ€è¦å•ç‹¬è·å–å’Œè®¾ç½®</li>
<li><strong>éªŒè¯åˆ†æ•£</strong>ï¼šéªŒè¯é€»è¾‘ä¸UIé€»è¾‘æ··æ‚</li>
<li><strong>ç±»å‹ä¸å®‰å…¨</strong>ï¼šæ‰€æœ‰æ•°æ®éƒ½æ˜¯å­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼Œéœ€è¦æ‰‹åŠ¨è½¬æ¢</li>
<li><strong>éš¾ä»¥ç»´æŠ¤</strong>ï¼šæ·»åŠ æ–°æ§ä»¶éœ€è¦ä¿®æ”¹å¤šä¸ªåœ°æ–¹</li>
</ol>
<h3 data-id="heading-36">äºŒã€MFCå¯¹è¯æ¡†ç±»çš„å°è£…æ¶æ„</h3>
<h4 data-id="heading-37">2.1 CDialogç±»å±‚æ¬¡ç»“æ„</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// MFCå¯¹è¯æ¡†ç±»çš„åŸºæœ¬å±‚æ¬¡</span>
CObject
â””â”€â”€ CCmdTarget
    â””â”€â”€ CWnd
        â””â”€â”€ CDialog
            â”œâ”€â”€ <span class="hljs-built_in">CCommonDialog</span> (é€šç”¨å¯¹è¯æ¡†åŸºç±»)
            â”‚   â”œâ”€â”€ CFileDialog
            â”‚   â”œâ”€â”€ CColorDialog
            â”‚   â”œâ”€â”€ CFontDialog
            â”‚   â””â”€â”€ ...
            â””â”€â”€ <span class="hljs-built_in">CDialogEx</span> (å¢å¼ºåŠŸèƒ½)

<span class="hljs-comment">// å…¸å‹çš„MFCå¯¹è¯æ¡†ç±»å®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyDialog</span> : <span class="hljs-keyword">public</span> CDialogEx
{
    <span class="hljs-built_in">DECLARE_DYNAMIC</span>(CMyDialog)

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ ‡å‡†æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">CMyDialog</span>(CWnd* pParent = <span class="hljs-literal">NULL</span>);
    
    <span class="hljs-comment">// å¯¹è¯æ¡†èµ„æºID</span>
    <span class="hljs-keyword">enum</span> { IDD = IDD_MYDIALOG };

<span class="hljs-keyword">protected</span>:
    <span class="hljs-comment">// DDX/DDVæ”¯æŒ</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span></span>;

    <span class="hljs-comment">// æ¶ˆæ¯æ˜ å°„</span>
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ§ä»¶å…³è”å˜é‡</span>
    CString m_strName;
    <span class="hljs-type">int</span> m_nAge;
    BOOL m_bAgree;
    CComboBox m_cboGender;
};
</code></pre>
<h4 data-id="heading-38">2.2 å¯¹è¯æ¡†ç”Ÿå‘½å‘¨æœŸç®¡ç†</h4>
<p>MFCå¯¹è¯æ¡†çš„ç”Ÿå‘½å‘¨æœŸç”±ä»¥ä¸‹å…³é”®æ–¹æ³•æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¯¹è¯æ¡†åˆ›å»ºä¸é”€æ¯æµç¨‹</span>
<span class="hljs-function">BOOL <span class="hljs-title">CMyDialog::OnInitDialog</span><span class="hljs-params">()</span>
</span>{
    CDialogEx::<span class="hljs-built_in">OnInitDialog</span>();
    
    <span class="hljs-comment">// 1. åˆå§‹åŒ–æ§ä»¶</span>
    m_cboGender.<span class="hljs-built_in">AddString</span>(_T(<span class="hljs-string">"ç”·"</span>));
    m_cboGender.<span class="hljs-built_in">AddString</span>(_T(<span class="hljs-string">"å¥³"</span>));
    m_cboGender.<span class="hljs-built_in">SetCurSel</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// 2. è®¾ç½®åˆå§‹æ•°æ®</span>
    m_strName = _T(<span class="hljs-string">"å¼ ä¸‰"</span>);
    m_nAge = <span class="hljs-number">25</span>;
    m_bAgree = TRUE;
    
    <span class="hljs-comment">// 3. æ›´æ–°æ§ä»¶æ˜¾ç¤º</span>
    <span class="hljs-built_in">UpdateData</span>(FALSE);
    
    <span class="hljs-comment">// 4. å…¶ä»–åˆå§‹åŒ–</span>
    <span class="hljs-built_in">CenterWindow</span>();  <span class="hljs-comment">// å±…ä¸­æ˜¾ç¤º</span>
    
    <span class="hljs-keyword">return</span> TRUE;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::OnOK</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// 1. ä»æ§ä»¶è·å–æ•°æ®å¹¶éªŒè¯</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">UpdateData</span>(TRUE))
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// éªŒè¯å¤±è´¥ï¼Œä¸å…³é—­å¯¹è¯æ¡†</span>
    
    <span class="hljs-comment">// 2. é¢å¤–çš„ä¸šåŠ¡é€»è¾‘éªŒè¯</span>
    <span class="hljs-keyword">if</span> (m_strName.<span class="hljs-built_in">GetLength</span>() &lt; <span class="hljs-number">2</span>)
    {
        <span class="hljs-built_in">MessageBox</span>(_T(<span class="hljs-string">"å§“åè‡³å°‘éœ€è¦2ä¸ªå­—ç¬¦"</span>), _T(<span class="hljs-string">"é”™è¯¯"</span>), MB_ICONERROR);
        <span class="hljs-built_in">GetDlgItem</span>(IDC_EDIT_NAME)-&gt;<span class="hljs-built_in">SetFocus</span>();
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// 3. è°ƒç”¨åŸºç±»OnOKå…³é—­å¯¹è¯æ¡†</span>
    CDialogEx::<span class="hljs-built_in">OnOK</span>();
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::OnCancel</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// å–æ¶ˆå‰çš„ç¡®è®¤</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">MessageBox</span>(_T(<span class="hljs-string">"ç¡®å®šè¦å–æ¶ˆå—ï¼Ÿ"</span>), _T(<span class="hljs-string">"ç¡®è®¤"</span>), 
                   MB_YESNO | MB_ICONQUESTION) == IDYES)
    {
        CDialogEx::<span class="hljs-built_in">OnCancel</span>();
    }
}
</code></pre>
<h3 data-id="heading-39">ä¸‰ã€DDXï¼ˆå¯¹è¯æ¡†æ•°æ®äº¤æ¢ï¼‰æœºåˆ¶è¯¦è§£</h3>
<h4 data-id="heading-40">3.1 DDXçš„æ ¸å¿ƒåŸç†</h4>
<p>DDXæœºåˆ¶é€šè¿‡<code>DoDataExchange</code>å‡½æ•°å’Œä¸€ç»„é¢„å®šä¹‰çš„å®ï¼Œåœ¨å¯¹è¯æ¡†æ§ä»¶å’Œæˆå‘˜å˜é‡ä¹‹é—´å»ºç«‹åŒå‘æ•°æ®ç»‘å®šï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// DoDataExchangeå‡½æ•°çš„æ ‡å‡†å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
    
    <span class="hljs-comment">// æ–‡æœ¬æ§ä»¶äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_NAME, m_strName);
    
    <span class="hljs-comment">// æ•°å€¼æ§ä»¶äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_AGE, m_nAge);
    
    <span class="hljs-comment">// å¤é€‰æ¡†äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Check</span>(pDX, IDC_CHECK_AGREE, m_bAgree);
    
    <span class="hljs-comment">// å•é€‰æŒ‰é’®äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Radio</span>(pDX, IDC_RADIO_MALE, m_nGender);
    
    <span class="hljs-comment">// ç»„åˆæ¡†äº¤æ¢</span>
    <span class="hljs-built_in">DDX_CBIndex</span>(pDX, IDC_COMBO_STATUS, m_nStatusIndex);
    <span class="hljs-built_in">DDX_CBString</span>(pDX, IDC_COMBO_STATUS, m_strStatus);
    
    <span class="hljs-comment">// åˆ—è¡¨æ¡†äº¤æ¢</span>
    <span class="hljs-built_in">DDX_LBIndex</span>(pDX, IDC_LIST_ITEMS, m_nSelectedItem);
    
    <span class="hljs-comment">// æ§ä»¶å¯¹è±¡äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Control</span>(pDX, IDC_COMBO_GENDER, m_cboGender);
}
</code></pre>
<h4 data-id="heading-41">3.2 DDXå®çš„ç¼–è¯‘æ—¶å±•å¼€</h4>
<p>ç¼–è¯‘å™¨ä¼šå°†DDXå®å±•å¼€ä¸ºå…·ä½“çš„ä»£ç ï¼Œä»¥ä¸‹æ˜¯å¯¹<code>DDX_Text</code>å®å±•å¼€çš„æ¨¡æ‹Ÿï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// DDX_Textå®çš„è¿‘ä¼¼å±•å¼€ï¼ˆæ¦‚å¿µæ€§ä»£ç ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DDX_Text(pDX, nIDC, value) \
    do { \
        <span class="hljs-keyword">if</span> ((pDX)-&gt;m_bSaveAndValidate) { \
            <span class="hljs-comment">/* ä»æ§ä»¶è·å–æ•°æ®åˆ°å˜é‡ */</span> \
            HWND hWndCtrl = ::GetDlgItem((pDX)-&gt;m_pDlgWnd-&gt;m_hWnd, nIDC); \
            <span class="hljs-keyword">if</span> (hWndCtrl != NULL) { \
                int nLen = ::GetWindowTextLength(hWndCtrl); \
                CString strTemp; \
                ::GetWindowText(hWndCtrl, strTemp.GetBuffer(nLen), nLen + 1); \
                strTemp.ReleaseBuffer(); \
                <span class="hljs-comment">/* ç±»å‹è½¬æ¢å’Œèµ‹å€¼ */</span> \
                value = _ttoi(strTemp); <span class="hljs-comment">/* å¯¹äºintç±»å‹ */</span> \
            } \
        } <span class="hljs-keyword">else</span> { \
            <span class="hljs-comment">/* ä»å˜é‡è®¾ç½®æ•°æ®åˆ°æ§ä»¶ */</span> \
            CString strTemp; \
            strTemp.Format(_T(<span class="hljs-string">"%d"</span>), value); <span class="hljs-comment">/* å¯¹äºintç±»å‹ */</span> \
            ::SetDlgItemText((pDX)-&gt;m_pDlgWnd-&gt;m_hWnd, nIDC, strTemp); \
        } \
    } while (0)</span>
</code></pre>
<h4 data-id="heading-42">3.3 å®Œæ•´DDXæ”¯æŒçš„æ•°æ®ç±»å‹</h4>
<p>MFCä¸ºä¸åŒç±»å‹çš„æ•°æ®æä¾›äº†ä¸“é—¨çš„DDXå®ï¼š</p>













































































<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>DDXå®</th><th>ç¤ºä¾‹</th><th>é€‚ç”¨æ§ä»¶</th></tr></thead><tbody><tr><td><strong>CString</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_strValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>int</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_nValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>UINT</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_uValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>long</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_lValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>DWORD</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_dwValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>float</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_fValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>double</strong></td><td><code>DDX_Text</code></td><td><code>DDX_Text(pDX, IDC_EDIT, m_dValue)</code></td><td>ç¼–è¾‘æ¡†</td></tr><tr><td><strong>BOOL</strong></td><td><code>DDX_Check</code></td><td><code>DDX_Check(pDX, IDC_CHECK, m_bValue)</code></td><td>å¤é€‰æ¡†</td></tr><tr><td><strong>int</strong> (å•é€‰)</td><td><code>DDX_Radio</code></td><td><code>DDX_Radio(pDX, IDC_RADIO1, m_nIndex)</code></td><td>å•é€‰æŒ‰é’®ç»„</td></tr><tr><td><strong>CComboBox</strong></td><td><code>DDX_Control</code></td><td><code>DDX_Control(pDX, IDC_COMBO, m_combo)</code></td><td>ç»„åˆæ¡†å¯¹è±¡</td></tr><tr><td><strong>CListBox</strong></td><td><code>DDX_Control</code></td><td><code>DDX_Control(pDX, IDC_LIST, m_list)</code></td><td>åˆ—è¡¨æ¡†å¯¹è±¡</td></tr></tbody></table>
<h3 data-id="heading-43">å››ã€DDVï¼ˆå¯¹è¯æ¡†æ•°æ®éªŒè¯ï¼‰æœºåˆ¶è¯¦è§£</h3>
<h4 data-id="heading-44">4.1 DDVçš„å·¥ä½œåŸç†</h4>
<p>DDVåœ¨æ•°æ®äº¤æ¢çš„åŒæ—¶è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„æœ‰æ•ˆæ€§ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¸¦æœ‰DDVéªŒè¯çš„DoDataExchangeç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
    
    <span class="hljs-comment">// æ•°æ®äº¤æ¢</span>
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_NAME, m_strName);
    
    <span class="hljs-comment">// æ•°æ®éªŒè¯</span>
    <span class="hljs-built_in">DDV_MaxChars</span>(pDX, m_strName, <span class="hljs-number">50</span>);  <span class="hljs-comment">// æœ€å¤š50ä¸ªå­—ç¬¦</span>
    
    <span class="hljs-comment">// æ•°å€¼äº¤æ¢ä¸éªŒè¯</span>
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_AGE, m_nAge);
    <span class="hljs-built_in">DDV_MinMaxInt</span>(pDX, m_nAge, <span class="hljs-number">0</span>, <span class="hljs-number">150</span>);  <span class="hljs-comment">// èŒƒå›´0-150</span>
    
    <span class="hljs-comment">// å­—ç¬¦ä¸²éç©ºéªŒè¯</span>
    <span class="hljs-built_in">DDV_NonEmptyString</span>(pDX, m_strName);
}
</code></pre>
<h4 data-id="heading-45">4.2 DDVéªŒè¯å¤±è´¥çš„å¤„ç†æœºåˆ¶</h4>
<p>å½“DDVéªŒè¯å¤±è´¥æ—¶ï¼ŒMFCä¼šæŠ›å‡ºå¼‚å¸¸å¹¶è‡ªåŠ¨å¤„ç†ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// DDV_MinMaxIntå®çš„å†…éƒ¨å®ç°é€»è¾‘ï¼ˆæ¦‚å¿µæ€§ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DDV_MinMaxInt(pDX, value, minVal, maxVal) \
    do { \
        <span class="hljs-keyword">if</span> ((pDX)-&gt;m_bSaveAndValidate &amp;&amp; (value <span class="hljs-string">&lt; minVal || value &gt;</span> maxVal)) { \
            <span class="hljs-comment">/* å‡†å¤‡é”™è¯¯ä¿¡æ¯ */</span> \
            CString strError; \
            strError.Format(_T(<span class="hljs-string">"æ•°å€¼å¿…é¡»åœ¨%då’Œ%dä¹‹é—´"</span>), minVal, maxVal); \
            \
            <span class="hljs-comment">/* æ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡† */</span> \
            AfxMessageBox(strError, MB_ICONEXCLAMATION); \
            \
            <span class="hljs-comment">/* æŠ›å‡ºå¼‚å¸¸åœæ­¢åç»­å¤„ç† */</span> \
            (pDX)-&gt;Fail(); \
        } \
    } while (0)</span>

<span class="hljs-comment">// CDataExchange::Fail()æ–¹æ³•çš„ç®€åŒ–å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CDataExchange::Fail</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// è®¾ç½®ç„¦ç‚¹åˆ°é—®é¢˜æ§ä»¶</span>
    <span class="hljs-keyword">if</span> (m_hWndLastControl != <span class="hljs-literal">NULL</span> &amp;&amp; ::<span class="hljs-built_in">IsWindow</span>(m_hWndLastControl))
    {
        ::<span class="hljs-built_in">SetFocus</span>(m_hWndLastControl);
    }
    
    <span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸ï¼Œè¢«MFCæ¡†æ¶æ•è·</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">CUserException</span>();
}
</code></pre>
<h4 data-id="heading-46">4.3 è‡ªå®šä¹‰DDVéªŒè¯</h4>
<p>é™¤äº†å†…ç½®çš„DDVå®ï¼Œè¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰éªŒè¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è‡ªå®šä¹‰DDVéªŒè¯å®</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DDV_Email(pDX, value) \
    do { \
        <span class="hljs-keyword">if</span> ((pDX)-&gt;m_bSaveAndValidate) { \
            <span class="hljs-keyword">if</span> (!IsValidEmail(value)) { \
                AfxMessageBox(_T(<span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€"</span>), \
                             MB_ICONEXCLAMATION); \
                (pDX)-&gt;Fail(); \
            } \
        } \
    } while (0)</span>

<span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
    
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_EMAIL, m_strEmail);
    <span class="hljs-built_in">DDV_Email</span>(pDX, m_strEmail);  <span class="hljs-comment">// è‡ªå®šä¹‰éªŒè¯</span>
}

<span class="hljs-comment">// ç”µå­é‚®ä»¶éªŒè¯å‡½æ•°</span>
<span class="hljs-function">BOOL <span class="hljs-title">CMyDialog::IsValidEmail</span><span class="hljs-params">(<span class="hljs-type">const</span> CString&amp; strEmail)</span>
</span>{
    <span class="hljs-comment">// ç®€å•çš„ç”µå­é‚®ä»¶éªŒè¯é€»è¾‘</span>
    <span class="hljs-type">int</span> nAtPos = strEmail.<span class="hljs-built_in">Find</span>(<span class="hljs-string">'@'</span>);
    <span class="hljs-type">int</span> nDotPos = strEmail.<span class="hljs-built_in">Find</span>(<span class="hljs-string">'.'</span>, nAtPos);
    
    <span class="hljs-keyword">return</span> (nAtPos &gt; <span class="hljs-number">0</span> &amp;&amp; nDotPos &gt; nAtPos + <span class="hljs-number">1</span> &amp;&amp; 
            nDotPos &lt; strEmail.<span class="hljs-built_in">GetLength</span>() - <span class="hljs-number">1</span>);
}
</code></pre>
<h3 data-id="heading-47">äº”ã€æ¨¡æ€ä¸éæ¨¡æ€å¯¹è¯æ¡†çš„æ·±å…¥å¯¹æ¯”</h3>
<h4 data-id="heading-48">5.1 æ¨¡æ€å¯¹è¯æ¡†çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¨¡æ€å¯¹è¯æ¡†çš„åˆ›å»ºä¸ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnOpenSettings</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function">CMyDialog <span class="hljs-title">dlg</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;  <span class="hljs-comment">// åˆ›å»ºå¯¹è¯æ¡†å¯¹è±¡</span>
    
    <span class="hljs-comment">// è®¾ç½®åˆå§‹å€¼</span>
    dlg.m_strName = m_strCurrentName;
    dlg.m_nAge = m_nCurrentAge;
    
    <span class="hljs-comment">// æ˜¾ç¤ºæ¨¡æ€å¯¹è¯æ¡†</span>
    <span class="hljs-keyword">if</span> (dlg.<span class="hljs-built_in">DoModal</span>() == IDOK)
    {
        <span class="hljs-comment">// ç”¨æˆ·ç‚¹å‡»äº†ç¡®å®š</span>
        m_strCurrentName = dlg.m_strName;
        m_nCurrentAge = dlg.m_nAge;
        
        <span class="hljs-comment">// ä¿å­˜è®¾ç½®</span>
        <span class="hljs-built_in">SaveSettings</span>();
        
        <span class="hljs-comment">// æ›´æ–°æ˜¾ç¤º</span>
        <span class="hljs-built_in">UpdateDisplay</span>();
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-comment">// ç”¨æˆ·ç‚¹å‡»äº†å–æ¶ˆ</span>
        <span class="hljs-built_in">AfxMessageBox</span>(_T(<span class="hljs-string">"è®¾ç½®æœªä¿å­˜"</span>));
    }
    
    <span class="hljs-comment">// å¯¹è¯æ¡†å¯¹è±¡è‡ªåŠ¨é”€æ¯</span>
}
</code></pre>
<h4 data-id="heading-49">5.2 éæ¨¡æ€å¯¹è¯æ¡†çš„ç‰¹æ®Šç®¡ç†</h4>
<p>éæ¨¡æ€å¯¹è¯æ¡†éœ€è¦ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// éæ¨¡æ€å¯¹è¯æ¡†çš„åˆ›å»ºä¸ç®¡ç†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyView</span> : <span class="hljs-keyword">public</span> CView
{
<span class="hljs-keyword">private</span>:
    CMyModelessDialog* m_pModelessDlg;  <span class="hljs-comment">// æŒ‡é’ˆæˆå‘˜</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnOpenModelessDialog</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// é˜²æ­¢é‡å¤æ‰“å¼€</span>
        <span class="hljs-keyword">if</span> (m_pModelessDlg != <span class="hljs-literal">NULL</span> &amp;&amp; m_pModelessDlg-&gt;<span class="hljs-built_in">GetSafeHwnd</span>() != <span class="hljs-literal">NULL</span>)
        {
            m_pModelessDlg-&gt;<span class="hljs-built_in">SetActiveWindow</span>();
            m_pModelessDlg-&gt;<span class="hljs-built_in">ShowWindow</span>(SW_SHOW);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// åˆ›å»ºéæ¨¡æ€å¯¹è¯æ¡†</span>
        m_pModelessDlg = <span class="hljs-keyword">new</span> <span class="hljs-built_in">CMyModelessDialog</span>(<span class="hljs-keyword">this</span>);
        
        <span class="hljs-comment">// å¿…é¡»æŒ‡å®šWS_VISIBLEé£æ ¼</span>
        <span class="hljs-keyword">if</span> (!m_pModelessDlg-&gt;<span class="hljs-built_in">Create</span>(IDD_MYDIALOG, <span class="hljs-keyword">this</span>))
        {
            <span class="hljs-keyword">delete</span> m_pModelessDlg;
            m_pModelessDlg = <span class="hljs-literal">NULL</span>;
            <span class="hljs-built_in">AfxMessageBox</span>(_T(<span class="hljs-string">"åˆ›å»ºå¯¹è¯æ¡†å¤±è´¥"</span>));
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æ˜¾ç¤ºå¯¹è¯æ¡†</span>
        m_pModelessDlg-&gt;<span class="hljs-built_in">ShowWindow</span>(SW_SHOW);
    }
    
    <span class="hljs-comment">// å¯¹è¯æ¡†å…³é—­æ—¶çš„æ¸…ç†</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnModelessDialogClosed</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span> (m_pModelessDlg != <span class="hljs-literal">NULL</span>)
        {
            <span class="hljs-comment">// æ³¨æ„ï¼šä¸èƒ½è°ƒç”¨deleteï¼Œå¯¹è¯æ¡†è‡ªå·±ç®¡ç†ç”Ÿå‘½å‘¨æœŸ</span>
            m_pModelessDlg = <span class="hljs-literal">NULL</span>;
        }
    }
};

<span class="hljs-comment">// éæ¨¡æ€å¯¹è¯æ¡†ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyModelessDialog</span> : <span class="hljs-keyword">public</span> CDialogEx
{
<span class="hljs-keyword">private</span>:
    CMyView* m_pParentView;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CMyModelessDialog</span>(CMyView* pParent) 
        : <span class="hljs-built_in">CDialogEx</span>(IDD_MYDIALOG, pParent), <span class="hljs-built_in">m_pParentView</span>(pParent) {}
    
    <span class="hljs-comment">// é‡å†™OnOKå’ŒOnCancel</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnOK</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">UpdateData</span>(TRUE))
            <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// é€šçŸ¥çˆ¶è§†å›¾</span>
        <span class="hljs-keyword">if</span> (m_pParentView != <span class="hljs-literal">NULL</span>)
        {
            m_pParentView-&gt;<span class="hljs-built_in">ApplyDialogSettings</span>(m_strName, m_nAge);
        }
        
        <span class="hljs-comment">// ä¸è°ƒç”¨åŸºç±»OnOKï¼ˆä¸å…³é—­å¯¹è¯æ¡†ï¼‰</span>
        <span class="hljs-comment">// è€Œæ˜¯éšè—æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œ</span>
        <span class="hljs-built_in">ShowWindow</span>(SW_HIDE);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnCancel</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// é€šçŸ¥çˆ¶è§†å›¾å¯¹è¯æ¡†å·²å…³é—­</span>
        <span class="hljs-keyword">if</span> (m_pParentView != <span class="hljs-literal">NULL</span>)
        {
            m_pParentView-&gt;<span class="hljs-built_in">OnModelessDialogClosed</span>();
        }
        
        <span class="hljs-comment">// é”€æ¯çª—å£</span>
        <span class="hljs-built_in">DestroyWindow</span>();
    }
    
    <span class="hljs-comment">// é‡å†™PostNcDestroyä»¥åˆ é™¤å¯¹è±¡</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">PostNcDestroy</span><span class="hljs-params">()</span>
    </span>{
        CDialogEx::<span class="hljs-built_in">PostNcDestroy</span>();
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>;  <span class="hljs-comment">// è‡ªæˆ‘åˆ é™¤</span>
    }
    
    <span class="hljs-built_in">DECLARE_MESSAGE_MAP</span>()
};
</code></pre>
<h3 data-id="heading-50">å…­ã€å±æ€§è¡¨ï¼ˆProperty Sheetï¼‰ä¸å±æ€§é¡µï¼ˆProperty Pageï¼‰</h3>
<p>å¯¹äºå¤æ‚çš„è®¾ç½®å¯¹è¯æ¡†ï¼ŒMFCæä¾›äº†å±æ€§è¡¨æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å±æ€§é¡µåŸºç±»çš„ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CGeneralPage</span> : <span class="hljs-keyword">public</span> CPropertyPage
{
    <span class="hljs-built_in">DECLARE_DYNCREATE</span>(CGeneralPage)
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CGeneralPage</span>() : <span class="hljs-built_in">CPropertyPage</span>(IDD_GENERAL_PAGE)
    {
        m_psp.dwFlags |= PSP_USETITLE;
        m_psp.pszTitle = _T(<span class="hljs-string">"å¸¸è§„è®¾ç½®"</span>);
    }
    
    <span class="hljs-comment">// æ•°æ®æˆå‘˜</span>
    CString m_strUserName;
    CString m_strCompany;
    BOOL m_bAutoSave;
    
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
    </span>{
        CPropertyPage::<span class="hljs-built_in">DoDataExchange</span>(pDX);
        <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_USERNAME, m_strUserName);
        <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_COMPANY, m_strCompany);
        <span class="hljs-built_in">DDX_Check</span>(pDX, IDC_CHECK_AUTOSAVE, m_bAutoSave);
    }
    
    <span class="hljs-comment">// éªŒè¯</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">OnApply</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">UpdateData</span>(TRUE))
            <span class="hljs-keyword">return</span> FALSE;
            
        <span class="hljs-comment">// åº”ç”¨è®¾ç½®</span>
        <span class="hljs-built_in">AfxGetApp</span>()-&gt;<span class="hljs-built_in">WriteProfileString</span>(_T(<span class="hljs-string">"Settings"</span>), _T(<span class="hljs-string">"UserName"</span>), m_strUserName);
        
        <span class="hljs-keyword">return</span> CPropertyPage::<span class="hljs-built_in">OnApply</span>();
    }
};

<span class="hljs-comment">// å±æ€§è¡¨çš„åˆ›å»ºä¸ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyApp::OnSettings</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// åˆ›å»ºå±æ€§è¡¨</span>
    <span class="hljs-function">CPropertySheet <span class="hljs-title">sheet</span><span class="hljs-params">(_T(<span class="hljs-string">"åº”ç”¨ç¨‹åºè®¾ç½®"</span>))</span></span>;
    
    <span class="hljs-comment">// æ·»åŠ å±æ€§é¡µ</span>
    CGeneralPage pageGeneral;
    CAdvancedPage pageAdvanced;
    
    sheet.<span class="hljs-built_in">AddPage</span>(&amp;pageGeneral);
    sheet.<span class="hljs-built_in">AddPage</span>(&amp;pageAdvanced);
    
    <span class="hljs-comment">// è®¾ç½®åˆå§‹å€¼</span>
    pageGeneral.m_strUserName = <span class="hljs-built_in">GetCurrentUserName</span>();
    pageAdvanced.m_nTimeout = <span class="hljs-built_in">GetTimeoutValue</span>();
    
    <span class="hljs-comment">// æ˜¾ç¤ºæ¨¡æ€å±æ€§è¡¨</span>
    <span class="hljs-keyword">if</span> (sheet.<span class="hljs-built_in">DoModal</span>() == IDOK)
    {
        <span class="hljs-comment">// ä¿å­˜æ‰€æœ‰è®¾ç½®</span>
        <span class="hljs-built_in">SaveSettings</span>(pageGeneral, pageAdvanced);
    }
}
</code></pre>
<h3 data-id="heading-51">ä¸ƒã€å¯¹è¯æ¡†æ•°æ®äº¤æ¢çš„é«˜çº§æŠ€å·§</h3>
<h4 data-id="heading-52">7.1 åŠ¨æ€æ§ä»¶çš„æ•°æ®äº¤æ¢</h4>
<p>å¯¹äºåŠ¨æ€åˆ›å»ºçš„æ§ä»¶ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†DDXï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CDynamicDialog</span> : <span class="hljs-keyword">public</span> CDialogEx
{
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// åŠ¨æ€æ§ä»¶IDèµ·å§‹å€¼ï¼ˆå¿…é¡»å¤§äºç³»ç»ŸIDï¼‰</span>
    <span class="hljs-keyword">enum</span> { IDC_DYNAMIC_START = <span class="hljs-number">0x8000</span> };
    
    <span class="hljs-comment">// åŠ¨æ€æ§ä»¶æ•°ç»„</span>
    CEdit* m_pDynamicEdits[<span class="hljs-number">10</span>];
    CStatic* m_pDynamicLabels[<span class="hljs-number">10</span>];
    <span class="hljs-type">int</span> m_nDynamicValues[<span class="hljs-number">10</span>];
    <span class="hljs-type">int</span> m_nControlCount;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
    </span>{
        CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
        
        <span class="hljs-comment">// åŠ¨æ€æ§ä»¶çš„DDX</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m_nControlCount; i++)
        {
            <span class="hljs-keyword">if</span> (m_pDynamicEdits[i] != <span class="hljs-literal">NULL</span> &amp;&amp; m_pDynamicEdits[i]-&gt;<span class="hljs-built_in">GetSafeHwnd</span>() != <span class="hljs-literal">NULL</span>)
            {
                <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_DYNAMIC_START + i, m_nDynamicValues[i]);
            }
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CreateDynamicControls</span><span class="hljs-params">(<span class="hljs-type">int</span> nCount)</span>
    </span>{
        m_nControlCount = nCount;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nCount; i++)
        {
            <span class="hljs-comment">// åˆ›å»ºæ ‡ç­¾</span>
            m_pDynamicLabels[i] = <span class="hljs-keyword">new</span> CStatic;
            m_pDynamicLabels[i]-&gt;<span class="hljs-built_in">Create</span>(_T(<span class="hljs-string">"åŠ¨æ€æ§ä»¶ "</span>) + <span class="hljs-built_in">CString</span>(<span class="hljs-built_in">char</span>(<span class="hljs-string">'A'</span> + i)),
                                       WS_CHILD | WS_VISIBLE,
                                       <span class="hljs-built_in">CRect</span>(<span class="hljs-number">10</span>, <span class="hljs-number">30</span> + i * <span class="hljs-number">30</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span> + i * <span class="hljs-number">30</span>),
                                       <span class="hljs-keyword">this</span>);
            
            <span class="hljs-comment">// åˆ›å»ºç¼–è¾‘æ¡†</span>
            m_pDynamicEdits[i] = <span class="hljs-keyword">new</span> CEdit;
            m_pDynamicEdits[i]-&gt;<span class="hljs-built_in">Create</span>(WS_CHILD | WS_VISIBLE | WS_BORDER | ES_AUTOHSCROLL,
                                      <span class="hljs-built_in">CRect</span>(<span class="hljs-number">110</span>, <span class="hljs-number">30</span> + i * <span class="hljs-number">30</span>, <span class="hljs-number">210</span>, <span class="hljs-number">50</span> + i * <span class="hljs-number">30</span>),
                                      <span class="hljs-keyword">this</span>, IDC_DYNAMIC_START + i);
        }
    }
};
</code></pre>
<h4 data-id="heading-53">7.2 æ•°æ®äº¤æ¢çš„æ€§èƒ½ä¼˜åŒ–</h4>
<p>å¯¹äºåŒ…å«å¤§é‡æ§ä»¶çš„å¯¹è¯æ¡†ï¼Œå¯ä»¥ä¼˜åŒ–DDXæ€§èƒ½ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">COptimizedDialog::DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
    
    <span class="hljs-comment">// ä½¿ç”¨æ¡ä»¶ç¼–è¯‘æˆ–æ ‡å¿—æ§åˆ¶DDXèŒƒå›´</span>
    <span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> FULL_DATA_EXCHANGE</span>
    <span class="hljs-comment">// å®Œæ•´çš„æ•°æ®äº¤æ¢</span>
    <span class="hljs-built_in">ExchangeAllData</span>(pDX);
    <span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
    <span class="hljs-comment">// éƒ¨åˆ†æ•°æ®äº¤æ¢ï¼ˆæ ¹æ®éœ€æ±‚ï¼‰</span>
    <span class="hljs-keyword">if</span> (pDX-&gt;m_bSaveAndValidate)
    {
        <span class="hljs-comment">// åªéªŒè¯å¿…è¦å­—æ®µ</span>
        <span class="hljs-built_in">ExchangeRequiredData</span>(pDX);
    }
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-comment">// åªæ›´æ–°å¯è§å­—æ®µ</span>
        <span class="hljs-built_in">ExchangeVisibleData</span>(pDX);
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
}

<span class="hljs-comment">// åˆ†ç»„æ•°æ®äº¤æ¢ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">COptimizedDialog::ExchangePersonalData</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_NAME, m_strName);
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_AGE, m_nAge);
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_PHONE, m_strPhone);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">COptimizedDialog::ExchangeWorkData</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_COMPANY, m_strCompany);
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_POSITION, m_strPosition);
}
</code></pre>
<h3 data-id="heading-54">å…«ã€å¯¹è¯æ¡†ä¸æ–‡æ¡£/è§†å›¾æ¶æ„çš„é›†æˆ</h3>
<p>å¯¹è¯æ¡†å¯ä»¥ä½œä¸ºæ–‡æ¡£/è§†å›¾æ¶æ„çš„è¡¥å……ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åœ¨æ–‡æ¡£/è§†å›¾åº”ç”¨ä¸­ä½¿ç”¨å¯¹è¯æ¡†</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnEditPreferences</span><span class="hljs-params">()</span>
</span>{
    CPreferencesDialog dlg;
    
    <span class="hljs-comment">// ä»æ–‡æ¡£è·å–å½“å‰è®¾ç½®</span>
    CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
    dlg.m_strDefaultPath = pDoc-&gt;<span class="hljs-built_in">GetDefaultPath</span>();
    dlg.m_nAutoSaveInterval = pDoc-&gt;<span class="hljs-built_in">GetAutoSaveInterval</span>();
    
    <span class="hljs-keyword">if</span> (dlg.<span class="hljs-built_in">DoModal</span>() == IDOK)
    {
        <span class="hljs-comment">// æ›´æ–°æ–‡æ¡£è®¾ç½®</span>
        pDoc-&gt;<span class="hljs-built_in">SetDefaultPath</span>(dlg.m_strDefaultPath);
        pDoc-&gt;<span class="hljs-built_in">SetAutoSaveInterval</span>(dlg.m_nAutoSaveInterval);
        
        <span class="hljs-comment">// æ ‡è®°æ–‡æ¡£ä¸ºå·²ä¿®æ”¹</span>
        pDoc-&gt;<span class="hljs-built_in">SetModifiedFlag</span>(TRUE);
        
        <span class="hljs-comment">// æ›´æ–°æ‰€æœ‰è§†å›¾</span>
        pDoc-&gt;<span class="hljs-built_in">UpdateAllViews</span>(<span class="hljs-keyword">this</span>);
    }
}

<span class="hljs-comment">// å¯¹è¯æ¡†æ•°æ®å˜åŒ–å®æ—¶æ›´æ–°è§†å›¾</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CRealTimeDialog::OnChangeEditValue</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// è·å–å½“å‰å€¼</span>
    <span class="hljs-built_in">UpdateData</span>(TRUE);
    
    <span class="hljs-comment">// å®æ—¶æ›´æ–°é¢„è§ˆ</span>
    CPreviewDialog* pPreview = <span class="hljs-built_in">GetPreviewWindow</span>();
    <span class="hljs-keyword">if</span> (pPreview != <span class="hljs-literal">NULL</span>)
    {
        pPreview-&gt;<span class="hljs-built_in">UpdatePreview</span>(m_nValue, m_strText);
    }
}
</code></pre>
<h3 data-id="heading-55">ä¹ã€å¸¸è§é—®é¢˜ä¸è°ƒè¯•æŠ€å·§</h3>
<h4 data-id="heading-56">9.1 DDX/DDVå¸¸è§é—®é¢˜æ’æŸ¥</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è°ƒè¯•DDXé—®é¢˜çš„æŠ€å·§</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::DoDataExchange</span><span class="hljs-params">(CDataExchange* pDX)</span>
</span>{
    <span class="hljs-built_in">TRACE</span>(_T(<span class="hljs-string">"DoDataExchange called, m_bSaveAndValidate = %d\n"</span>), 
          pDX-&gt;m_bSaveAndValidate);
    
    CDialogEx::<span class="hljs-built_in">DoDataExchange</span>(pDX);
    
    <span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _DEBUG</span>
    <span class="hljs-comment">// è°ƒè¯•æ¨¡å¼ä¸‹æ·»åŠ é¢å¤–æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> (pDX-&gt;m_bSaveAndValidate)
    {
        <span class="hljs-comment">// æ£€æŸ¥æ§ä»¶æ˜¯å¦å­˜åœ¨</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">GetDlgItem</span>(IDC_EDIT_NAME) == <span class="hljs-literal">NULL</span>)
        {
            <span class="hljs-built_in">TRACE0</span>(<span class="hljs-string">"é”™è¯¯: IDC_EDIT_NAME æ§ä»¶ä¸å­˜åœ¨!\n"</span>);
            <span class="hljs-built_in">ASSERT</span>(FALSE);
        }
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
    
    <span class="hljs-built_in">DDX_Text</span>(pDX, IDC_EDIT_NAME, m_strName);
    
    <span class="hljs-built_in">TRACE</span>(_T(<span class="hljs-string">"m_strName = %s\n"</span>), (LPCTSTR)m_strName);
}
</code></pre>
<h4 data-id="heading-57">9.2 å†…å­˜æ³„æ¼æ£€æµ‹</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ£€æµ‹å¯¹è¯æ¡†ç›¸å…³çš„å†…å­˜æ³„æ¼</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _DEBUG</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyDialog::OnDestroy</span><span class="hljs-params">()</span>
</span>{
    CDialogEx::<span class="hljs-built_in">OnDestroy</span>();
    
    <span class="hljs-comment">// æ£€æŸ¥åŠ¨æ€åˆ›å»ºçš„æ§ä»¶æ˜¯å¦è¢«æ­£ç¡®åˆ é™¤</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m_nControlCount; i++)
    {
        <span class="hljs-comment">// è¿™äº›æŒ‡é’ˆåº”è¯¥åœ¨PostNcDestroyä¸­åˆ é™¤</span>
        <span class="hljs-built_in">ASSERT</span>(m_pDynamicEdits[i] == <span class="hljs-literal">NULL</span>);
    }
}

<span class="hljs-comment">// é‡å†™PostNcDestroyç¡®ä¿èµ„æºæ¸…ç†</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyModelessDialog::PostNcDestroy</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// æ¸…ç†åŠ¨æ€æ§ä»¶</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m_nControlCount; i++)
    {
        <span class="hljs-keyword">if</span> (m_pDynamicEdits[i] != <span class="hljs-literal">NULL</span>)
        {
            <span class="hljs-keyword">delete</span> m_pDynamicEdits[i];
            m_pDynamicEdits[i] = <span class="hljs-literal">NULL</span>;
        }
    }
    
    CDialogEx::<span class="hljs-built_in">PostNcDestroy</span>();
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>;
}
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<h3 data-id="heading-58">åã€ç°ä»£æ›¿ä»£æ–¹æ¡ˆä¸æ¶æ„å¯ç¤º</h3>
<p>è™½ç„¶MFCå¯¹è¯æ¡†æœºåˆ¶æœ‰å…¶å†å²å±€é™æ€§ï¼Œä½†å…¶è®¾è®¡æ€æƒ³å¯¹ç°ä»£UIæ¡†æ¶ä»æœ‰å½±å“ï¼š</p>
<ol>
<li><strong>æ•°æ®ç»‘å®šæ¨¡å¼</strong>ï¼šWPF/XAMLçš„æ•°æ®ç»‘å®šæ˜¯DDXçš„è¿›åŒ–ç‰ˆæœ¬</li>
<li><strong>MVVMæ¨¡å¼</strong>ï¼šViewModelä½œä¸ºæ•°æ®ä¸­ä»‹ï¼Œç±»ä¼¼äºMFCå¯¹è¯æ¡†çš„æ•°æ®å±‚</li>
<li><strong>å“åº”å¼è¡¨å•</strong>ï¼šAngular/Reactä¸­çš„è¡¨å•éªŒè¯æœºåˆ¶å€Ÿé‰´äº†DDVçš„æ€æƒ³</li>
</ol>
<p><strong>DDX/DDVæœºåˆ¶çš„ç°ä»£å¯ç¤º</strong>ï¼š</p>
<ul>
<li>å£°æ˜å¼æ•°æ®ç»‘å®šä¼˜äºå‘½ä»¤å¼æ•°æ®æ“ä½œ</li>
<li>æ•°æ®éªŒè¯åº”è¯¥ä¸UIé€»è¾‘åˆ†ç¦»</li>
<li>ç±»å‹å®‰å…¨æ˜¯æ¡†æ¶è®¾è®¡çš„é‡è¦ç›®æ ‡</li>
<li>å¼€å‘è€…ä½“éªŒï¼ˆDXï¼‰ç›´æ¥å½±å“æ¡†æ¶çš„é‡‡ç”¨ç‡</li>
</ul>
<p>MFCçš„å¯¹è¯æ¡†å’ŒDDX/DDVæœºåˆ¶å±•ç¤ºäº†å¦‚ä½•åœ¨C++ç¯å¢ƒä¸­å®ç°ç±»å‹å®‰å…¨çš„UIæ•°æ®ç»‘å®šã€‚è™½ç„¶å…·ä½“å®ç°å·²æ˜¾é™ˆæ—§ï¼Œä½†å…¶æ ¸å¿ƒæ€æƒ³â€”â€”é€šè¿‡å…ƒç¼–ç¨‹ç®€åŒ–å¼€å‘è€…å·¥ä½œã€ç¡®ä¿æ•°æ®å®Œæ•´æ€§ã€æä¾›ä¸€è‡´çš„ç¼–ç¨‹æ¨¡å‹â€”â€”ä»ç„¶æ˜¯ä¼˜ç§€æ¡†æ¶è®¾è®¡çš„é‡è¦åŸåˆ™ã€‚</p>
<h2 data-id="heading-59">ç¬¬å››ç« ï¼šMFCå›¾å½¢è®¾å¤‡æ¥å£(GDI)ç¼–ç¨‹â€”â€”Windowså›¾å½¢æ¸²æŸ“çš„æ ¸å¿ƒå¼•æ“</h2>
<h3 data-id="heading-60">ä¸€ã€GDIç³»ç»Ÿæ¶æ„ï¼šä»ç¡¬ä»¶æŠ½è±¡åˆ°åº”ç”¨ç¨‹åº</h3>
<p>Windows GDIï¼ˆGraphics Device Interfaceï¼‰æ˜¯Windowsæ“ä½œç³»ç»Ÿçš„å›¾å½¢æ ¸å¿ƒå­ç³»ç»Ÿï¼ŒMFCé€šè¿‡CDCç±»åŠå…¶æ´¾ç”Ÿç±»å¯¹å…¶è¿›è¡Œé¢å‘å¯¹è±¡å°è£…ã€‚ç†è§£GDIçš„å±‚æ¬¡ç»“æ„æ˜¯æŒæ¡MFCç»˜å›¾çš„åŸºç¡€ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c729af5b21c74643a2c392c3667275b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794519&amp;x-signature=65LtXjXR43RYb9XFc%2BGT1dQD%2BXM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-61">äºŒã€è®¾å¤‡ä¸Šä¸‹æ–‡(CDC)çš„æ·±å…¥è§£æ</h3>
<h4 data-id="heading-62">2.1 CDCç±»çš„åŸºæœ¬åŸç†</h4>
<p>è®¾å¤‡ä¸Šä¸‹æ–‡æ˜¯GDIçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒä»£è¡¨äº†ç»˜å›¾è¡¨é¢çš„æŠ½è±¡ï¼ŒåŒ…å«ç»˜å›¾æ‰€éœ€çš„æ‰€æœ‰çŠ¶æ€ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// CDCç±»çš„å…³é”®å†…éƒ¨ç»“æ„ï¼ˆæ¦‚å¿µæ€§ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CDC</span> : <span class="hljs-keyword">public</span> CObject
{
<span class="hljs-keyword">protected</span>:
    HDC m_hDC;                 <span class="hljs-comment">// Windowsè®¾å¤‡ä¸Šä¸‹æ–‡å¥æŸ„</span>
    HDC m_hAttribDC;           <span class="hljs-comment">// å±æ€§DCï¼ˆç”¨äºæ‰“å°ç­‰ï¼‰</span>
    BOOL m_bPrinting;          <span class="hljs-comment">// æ˜¯å¦ä¸ºæ‰“å°DC</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°</span>
    <span class="hljs-built_in">CDC</span>();
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">CDC</span>();
    
    <span class="hljs-comment">// è®¾å¤‡ä¸Šä¸‹æ–‡æ“ä½œ</span>
    <span class="hljs-function">BOOL <span class="hljs-title">Attach</span><span class="hljs-params">(HDC hDC)</span></span>;      <span class="hljs-comment">// å…³è”ç°æœ‰HDC</span>
    <span class="hljs-function">HDC <span class="hljs-title">Detach</span><span class="hljs-params">()</span></span>;              <span class="hljs-comment">// åˆ†ç¦»HDC</span>
    <span class="hljs-function">HDC <span class="hljs-title">GetSafeHdc</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;    <span class="hljs-comment">// å®‰å…¨è·å–HDC</span>
    
    <span class="hljs-comment">// ç»˜å›¾çŠ¶æ€ç®¡ç†</span>
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">SaveDC</span><span class="hljs-params">()</span></span>;              <span class="hljs-comment">// ä¿å­˜DCçŠ¶æ€</span>
    <span class="hljs-function">BOOL <span class="hljs-title">RestoreDC</span><span class="hljs-params">(<span class="hljs-type">int</span> nSavedDC)</span></span>; <span class="hljs-comment">// æ¢å¤DCçŠ¶æ€</span>
    
    <span class="hljs-comment">// åæ ‡ä¸æ˜ å°„æ¨¡å¼</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> CPoint <span class="hljs-title">GetViewportOrg</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> CSize <span class="hljs-title">GetViewportExt</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">int</span> <span class="hljs-title">SetMapMode</span><span class="hljs-params">(<span class="hljs-type">int</span> nMapMode)</span></span>;
    
    <span class="hljs-comment">// ç»˜å›¾æ“ä½œ</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">LineTo</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">Rectangle</span><span class="hljs-params">(<span class="hljs-type">int</span> x1, <span class="hljs-type">int</span> y1, <span class="hljs-type">int</span> x2, <span class="hljs-type">int</span> y2)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">Ellipse</span><span class="hljs-params">(<span class="hljs-type">int</span> x1, <span class="hljs-type">int</span> y1, <span class="hljs-type">int</span> x2, <span class="hljs-type">int</span> y2)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> BOOL <span class="hljs-title">TextOut</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, LPCTSTR lpszString, <span class="hljs-type">int</span> nCount)</span></span>;
    
    <span class="hljs-comment">// GDIå¯¹è±¡ç®¡ç†</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> CGdiObject* <span class="hljs-title">SelectStockObject</span><span class="hljs-params">(<span class="hljs-type">int</span> nIndex)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> CGdiObject* <span class="hljs-title">SelectObject</span><span class="hljs-params">(CGdiObject* pObject)</span></span>;
    
    <span class="hljs-comment">// è®¾å¤‡èƒ½åŠ›æŸ¥è¯¢</span>
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">GetDeviceCaps</span><span class="hljs-params">(<span class="hljs-type">int</span> nIndex)</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-built_in">DECLARE_DYNAMIC</span>(CDC)
};
</code></pre>
<h4 data-id="heading-63">2.2 ä¸åŒCDCæ´¾ç”Ÿç±»çš„ä½¿ç”¨åœºæ™¯</h4>
<p>MFCæä¾›äº†å¤šç§CDCæ´¾ç”Ÿç±»ä»¥é€‚åº”ä¸åŒç»˜å›¾éœ€æ±‚ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 1. CPaintDC - ç”¨äºWM_PAINTæ¶ˆæ¯å¤„ç†</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnPaint</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function">CPaintDC <span class="hljs-title">dc</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>; <span class="hljs-comment">// è‡ªåŠ¨è°ƒç”¨BeginPaint</span>
    
    <span class="hljs-comment">// è·å–æ— æ•ˆåŒºåŸŸ</span>
    CRect rectUpdate;
    dc.<span class="hljs-built_in">GetClipBox</span>(&amp;rectUpdate);
    
    <span class="hljs-comment">// æ‰§è¡Œç»˜å›¾æ“ä½œ</span>
    <span class="hljs-built_in">OnDraw</span>(&amp;dc); <span class="hljs-comment">// é€šå¸¸è°ƒç”¨OnDrawè¿›è¡Œå®é™…ç»˜åˆ¶</span>
    
    <span class="hljs-comment">// ææ„æ—¶è‡ªåŠ¨è°ƒç”¨EndPaint</span>
}

<span class="hljs-comment">// 2. CClientDC - ç”¨äºå®¢æˆ·åŒºå³æ—¶ç»˜å›¾</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnMouseMove</span><span class="hljs-params">(UINT nFlags, CPoint point)</span>
</span>{
    <span class="hljs-keyword">if</span> (m_bDrawing)
    {
        <span class="hljs-function">CClientDC <span class="hljs-title">dc</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>; <span class="hljs-comment">// è·å–å®¢æˆ·åŒºDC</span>
        
        <span class="hljs-comment">// å®æ—¶ç»˜åˆ¶åé¦ˆ</span>
        dc.<span class="hljs-built_in">MoveTo</span>(m_ptLastPos);
        dc.<span class="hljs-built_in">LineTo</span>(point);
        
        m_ptLastPos = point;
    }
    
    CView::<span class="hljs-built_in">OnMouseMove</span>(nFlags, point);
}

<span class="hljs-comment">// 3. CWindowDC - ç»˜åˆ¶æ•´ä¸ªçª—å£ï¼ˆåŒ…æ‹¬éå®¢æˆ·åŒºï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyFrameWnd::OnDrawBorder</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function">CWindowDC <span class="hljs-title">dc</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>; <span class="hljs-comment">// è·å–æ•´ä¸ªçª—å£DC</span>
    
    <span class="hljs-comment">// ç»˜åˆ¶è‡ªå®šä¹‰çª—å£è¾¹æ¡†</span>
    CRect rectWindow;
    <span class="hljs-built_in">GetWindowRect</span>(&amp;rectWindow);
    
    <span class="hljs-comment">// è½¬æ¢ä¸ºå®¢æˆ·åŒºåæ ‡</span>
    <span class="hljs-built_in">ScreenToClient</span>(&amp;rectWindow);
    
    <span class="hljs-comment">// ç»˜åˆ¶è¾¹æ¡†</span>
    <span class="hljs-function">CPen <span class="hljs-title">pen</span><span class="hljs-params">(PS_SOLID, <span class="hljs-number">3</span>, RGB(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))</span></span>;
    dc.<span class="hljs-built_in">SelectObject</span>(&amp;pen);
    dc.<span class="hljs-built_in">SelectStockObject</span>(NULL_BRUSH);
    dc.<span class="hljs-built_in">Rectangle</span>(rectWindow);
}

<span class="hljs-comment">// 4. CMetaFileDC - åˆ›å»ºWindowså›¾å…ƒæ–‡ä»¶</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::CreateMetaFile</span><span class="hljs-params">()</span>
</span>{
    CMetaFileDC dcMeta;
    
    <span class="hljs-comment">// åˆ›å»ºå›¾å…ƒæ–‡ä»¶DC</span>
    <span class="hljs-keyword">if</span> (dcMeta.<span class="hljs-built_in">Create</span>())
    {
        <span class="hljs-comment">// åœ¨å›¾å…ƒæ–‡ä»¶ä¸­è®°å½•ç»˜å›¾å‘½ä»¤</span>
        dcMeta.<span class="hljs-built_in">SetMapMode</span>(MM_ANISOTROPIC);
        dcMeta.<span class="hljs-built_in">SetWindowExt</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>);
        dcMeta.<span class="hljs-built_in">SetViewportExt</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
        
        <span class="hljs-comment">// è®°å½•ç»˜å›¾æ“ä½œ</span>
        dcMeta.<span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">500</span>, <span class="hljs-number">500</span>);
        dcMeta.<span class="hljs-built_in">Ellipse</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>);
        
        <span class="hljs-comment">// å…³é—­å›¾å…ƒæ–‡ä»¶</span>
        HMETAFILE hMetaFile = dcMeta.<span class="hljs-built_in">Close</span>();
        
        <span class="hljs-keyword">if</span> (hMetaFile != <span class="hljs-literal">NULL</span>)
        {
            <span class="hljs-comment">// å¯ä»¥ä¿å­˜æˆ–å›æ”¾å›¾å…ƒæ–‡ä»¶</span>
            <span class="hljs-function">CClientDC <span class="hljs-title">dc</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;
            dc.<span class="hljs-built_in">PlayMetaFile</span>(hMetaFile);
            
            <span class="hljs-comment">// åˆ é™¤å›¾å…ƒæ–‡ä»¶å¥æŸ„</span>
            ::<span class="hljs-built_in">DeleteMetaFile</span>(hMetaFile);
        }
    }
}
</code></pre>
<h3 data-id="heading-64">ä¸‰ã€GDIå¯¹è±¡ç®¡ç†ä¸èµ„æºç”Ÿå‘½å‘¨æœŸ</h3>
<h4 data-id="heading-65">3.1 GDIå¯¹è±¡çš„åŸºæœ¬ä½¿ç”¨æ¨¡å¼</h4>
<p>æ­£ç¡®çš„GDIå¯¹è±¡ç®¡ç†æ˜¯é˜²æ­¢èµ„æºæ³„æ¼çš„å…³é”®ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnDraw</span><span class="hljs-params">(CDC* pDC)</span>
</span>{
    <span class="hljs-comment">// 1. åˆ›å»ºGDIå¯¹è±¡</span>
    <span class="hljs-function">CPen <span class="hljs-title">newPen</span><span class="hljs-params">(PS_SOLID, <span class="hljs-number">2</span>, RGB(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>))</span></span>;
    <span class="hljs-function">CBrush <span class="hljs-title">newBrush</span><span class="hljs-params">(RGB(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>))</span></span>;
    CFont newFont;
    
    <span class="hljs-comment">// åˆ›å»ºå­—ä½“</span>
    LOGFONT lf = {<span class="hljs-number">0</span>};
    lf.lfHeight = <span class="hljs-number">-16</span>;
    lf.lfWeight = FW_BOLD;
    <span class="hljs-built_in">lstrcpy</span>(lf.lfFaceName, _T(<span class="hljs-string">"Arial"</span>));
    newFont.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
    
    <span class="hljs-comment">// 2. ä¿å­˜æ—§å¯¹è±¡å¹¶é€‰å…¥æ–°å¯¹è±¡</span>
    CPen* pOldPen = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;newPen);
    CBrush* pOldBrush = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;newBrush);
    CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;newFont);
    
    <span class="hljs-comment">// 3. æ‰§è¡Œç»˜å›¾æ“ä½œ</span>
    pDC-&gt;<span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150</span>);
    pDC-&gt;<span class="hljs-built_in">Ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">150</span>, <span class="hljs-number">100</span>);
    pDC-&gt;<span class="hljs-built_in">TextOut</span>(<span class="hljs-number">20</span>, <span class="hljs-number">20</span>, _T(<span class="hljs-string">"GDIç»˜å›¾ç¤ºä¾‹"</span>));
    
    <span class="hljs-comment">// 4. æ¢å¤æ—§å¯¹è±¡ï¼ˆæŒ‰ç›¸åé¡ºåºï¼‰</span>
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldBrush);
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldPen);
    
    <span class="hljs-comment">// 5. GDIå¯¹è±¡åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨åˆ é™¤</span>
    <span class="hljs-comment">//    æ³¨æ„ï¼šå¦‚æœè°ƒç”¨DeleteObjectï¼Œéœ€ç¡®ä¿ä¸å†ä½¿ç”¨è¯¥å¯¹è±¡</span>
}
</code></pre>
<h4 data-id="heading-66">3.2 GDIå¯¹è±¡çš„åˆ›å»ºå·¥å‚æ¨¡å¼</h4>
<p>å¯¹äºéœ€è¦é¢‘ç¹åˆ›å»ºç›¸åŒæ ·å¼GDIå¯¹è±¡çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CGdiObjectFactory</span>
{
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">static</span> CMap&lt;DWORD, DWORD, CPen*, CPen*&gt; m_mapPens;
    <span class="hljs-type">static</span> CMap&lt;DWORD, DWORD, CBrush*, CBrush*&gt; m_mapBrushes;
    <span class="hljs-type">static</span> CCriticalSection m_cs; <span class="hljs-comment">// çº¿ç¨‹ä¿æŠ¤</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è·å–æˆ–åˆ›å»ºæŒ‡å®šæ ·å¼çš„ç”»ç¬”</span>
    <span class="hljs-function"><span class="hljs-type">static</span> CPen* <span class="hljs-title">GetPen</span><span class="hljs-params">(<span class="hljs-type">int</span> nStyle, <span class="hljs-type">int</span> nWidth, COLORREF crColor)</span>
    </span>{
        <span class="hljs-function">CSingleLock <span class="hljs-title">lock</span><span class="hljs-params">(&amp;m_cs, TRUE)</span></span>;
        
        <span class="hljs-comment">// åˆ›å»ºå”¯ä¸€é”®</span>
        DWORD dwKey = (nStyle &lt;&lt; <span class="hljs-number">24</span>) | (nWidth &lt;&lt; <span class="hljs-number">16</span>) | crColor;
        
        CPen* pPen = <span class="hljs-literal">NULL</span>;
        <span class="hljs-keyword">if</span> (!m_mapPens.<span class="hljs-built_in">Lookup</span>(dwKey, pPen))
        {
            <span class="hljs-comment">// åˆ›å»ºæ–°ç”»ç¬”</span>
            pPen = <span class="hljs-keyword">new</span> <span class="hljs-built_in">CPen</span>(nStyle, nWidth, crColor);
            m_mapPens.<span class="hljs-built_in">SetAt</span>(dwKey, pPen);
        }
        
        <span class="hljs-keyword">return</span> pPen;
    }
    
    <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰GDIå¯¹è±¡</span>
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">Cleanup</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-function">CSingleLock <span class="hljs-title">lock</span><span class="hljs-params">(&amp;m_cs, TRUE)</span></span>;
        
        <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰ç”»ç¬”</span>
        POSITION pos = m_mapPens.<span class="hljs-built_in">GetStartPosition</span>();
        DWORD dwKey;
        CPen* pPen;
        <span class="hljs-keyword">while</span> (pos != <span class="hljs-literal">NULL</span>)
        {
            m_mapPens.<span class="hljs-built_in">GetNextAssoc</span>(pos, dwKey, pPen);
            <span class="hljs-keyword">delete</span> pPen;
        }
        m_mapPens.<span class="hljs-built_in">RemoveAll</span>();
        
        <span class="hljs-comment">// ç±»ä¼¼åœ°æ¸…ç†ç”»åˆ·ç­‰</span>
    }
};
</code></pre>
<h3 data-id="heading-67">å››ã€é«˜çº§ç»˜å›¾æŠ€æœ¯ä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-68">4.1 åŒç¼“å†²ç»˜å›¾æŠ€æœ¯</h4>
<p>åŒç¼“å†²æ˜¯æ¶ˆé™¤ç»˜å›¾é—ªçƒçš„å…³é”®æŠ€æœ¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CDoubleBufferDC</span> : <span class="hljs-keyword">public</span> CDC
{
<span class="hljs-keyword">private</span>:
    CDC* m_pDC;            <span class="hljs-comment">// åŸå§‹è®¾å¤‡ä¸Šä¸‹æ–‡</span>
    CBitmap m_bitmap;      <span class="hljs-comment">// å†…å­˜ä½å›¾</span>
    CBitmap* m_pOldBitmap; <span class="hljs-comment">// æ—§ä½å›¾</span>
    CRect m_rect;          <span class="hljs-comment">// ç»˜åˆ¶åŒºåŸŸ</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CDoubleBufferDC</span>(CDC* pDC, <span class="hljs-type">const</span> CRect&amp; rect)
        : <span class="hljs-built_in">m_pDC</span>(pDC), <span class="hljs-built_in">m_rect</span>(rect)
    {
        <span class="hljs-comment">// åˆ›å»ºå…¼å®¹çš„å†…å­˜DC</span>
        <span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        
        <span class="hljs-comment">// åˆ›å»ºå…¼å®¹ä½å›¾</span>
        m_bitmap.<span class="hljs-built_in">CreateCompatibleBitmap</span>(pDC, rect.<span class="hljs-built_in">Width</span>(), rect.<span class="hljs-built_in">Height</span>());
        
        <span class="hljs-comment">// é€‰å…¥ä½å›¾</span>
        m_pOldBitmap = <span class="hljs-built_in">SelectObject</span>(&amp;m_bitmap);
        
        <span class="hljs-comment">// è®¾ç½®åŸç‚¹åç§»</span>
        <span class="hljs-built_in">SetViewportOrg</span>(-rect.left, -rect.top);
    }
    
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">CDoubleBufferDC</span>()
    {
        <span class="hljs-comment">// å°†å†…å­˜ä½å›¾æ‹·è´åˆ°å±å¹•</span>
        m_pDC-&gt;<span class="hljs-built_in">BitBlt</span>(m_rect.left, m_rect.top, 
                     m_rect.<span class="hljs-built_in">Width</span>(), m_rect.<span class="hljs-built_in">Height</span>(),
                     <span class="hljs-keyword">this</span>, 
                     m_rect.left, m_rect.top, 
                     SRCCOPY);
        
        <span class="hljs-comment">// æ¢å¤åŸå§‹ä½å›¾</span>
        <span class="hljs-built_in">SelectObject</span>(m_pOldBitmap);
        
        <span class="hljs-comment">// ä½å›¾å¯¹è±¡è‡ªåŠ¨åˆ é™¤</span>
    }
};

<span class="hljs-comment">// åœ¨è§†å›¾ç±»ä¸­ä½¿ç”¨åŒç¼“å†²</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::OnDraw</span><span class="hljs-params">(CDC* pDC)</span>
</span>{
    CRect rectClient;
    <span class="hljs-built_in">GetClientRect</span>(&amp;rectClient);
    
    <span class="hljs-comment">// åˆ›å»ºåŒç¼“å†²DC</span>
    <span class="hljs-function">CDoubleBufferDC <span class="hljs-title">dbDC</span><span class="hljs-params">(pDC, rectClient)</span></span>;
    
    <span class="hljs-comment">// ä½¿ç”¨dbDCè¿›è¡Œæ‰€æœ‰ç»˜å›¾æ“ä½œ</span>
    <span class="hljs-built_in">DrawBackground</span>(&amp;dbDC, rectClient);
    <span class="hljs-built_in">DrawContent</span>(&amp;dbDC, rectClient);
    <span class="hljs-built_in">DrawOverlay</span>(&amp;dbDC, rectClient);
    
    <span class="hljs-comment">// dbDCææ„æ—¶è‡ªåŠ¨åˆ·æ–°åˆ°å±å¹•</span>
}
</code></pre>
<h4 data-id="heading-69">4.2 è·¯å¾„ä¸å¤æ‚åŒºåŸŸæ“ä½œ</h4>
<p>è·¯å¾„æä¾›äº†ä¸€ç§è®°å½•å’Œé‡ç”¨å¤æ‚ç»˜å›¾åºåˆ—çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::DrawComplexShape</span><span class="hljs-params">(CDC* pDC)</span>
</span>{
    <span class="hljs-comment">// å¼€å§‹è·¯å¾„å®šä¹‰</span>
    pDC-&gt;<span class="hljs-built_in">BeginPath</span>();
    
    <span class="hljs-comment">// å®šä¹‰è·¯å¾„å½¢çŠ¶</span>
    pDC-&gt;<span class="hljs-built_in">MoveTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">100</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">200</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">200</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>); <span class="hljs-comment">// é—­åˆçŸ©å½¢</span>
    
    <span class="hljs-comment">// æ·»åŠ ç¬¬äºŒä¸ªå½¢çŠ¶</span>
    pDC-&gt;<span class="hljs-built_in">MoveTo</span>(<span class="hljs-number">150</span>, <span class="hljs-number">50</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">250</span>, <span class="hljs-number">150</span>);
    pDC-&gt;<span class="hljs-built_in">LineTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">150</span>);
    pDC-&gt;<span class="hljs-built_in">CloseFigure</span>(); <span class="hljs-comment">// é—­åˆä¸‰è§’å½¢</span>
    
    <span class="hljs-comment">// ç»“æŸè·¯å¾„å®šä¹‰</span>
    pDC-&gt;<span class="hljs-built_in">EndPath</span>();
    
    <span class="hljs-comment">// 1. ç»˜åˆ¶è·¯å¾„è½®å»“</span>
    <span class="hljs-function">CPen <span class="hljs-title">pen</span><span class="hljs-params">(PS_SOLID, <span class="hljs-number">2</span>, RGB(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))</span></span>;
    CPen* pOldPen = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;pen);
    pDC-&gt;<span class="hljs-built_in">StrokePath</span>();
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldPen);
    
    <span class="hljs-comment">// 2. å¡«å……è·¯å¾„</span>
    <span class="hljs-function">CBrush <span class="hljs-title">brush</span><span class="hljs-params">(RGB(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>))</span></span>;
    CBrush* pOldBrush = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;brush);
    pDC-&gt;<span class="hljs-built_in">FillPath</span>();
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldBrush);
    
    <span class="hljs-comment">// 3. å°†è·¯å¾„è½¬æ¢ä¸ºåŒºåŸŸ</span>
    CRgn region;
    <span class="hljs-keyword">if</span> (region.<span class="hljs-built_in">CreateFromPath</span>(pDC))
    {
        <span class="hljs-comment">// ä½¿ç”¨åŒºåŸŸè¿›è¡Œç‚¹å‡»æµ‹è¯•</span>
        <span class="hljs-function">CPoint <span class="hljs-title">ptTest</span><span class="hljs-params">(<span class="hljs-number">120</span>, <span class="hljs-number">120</span>)</span></span>;
        <span class="hljs-keyword">if</span> (region.<span class="hljs-built_in">PtInRegion</span>(ptTest))
        {
            pDC-&gt;<span class="hljs-built_in">TextOut</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, _T(<span class="hljs-string">"ç‚¹åœ¨åŒºåŸŸå†…"</span>));
        }
        
        <span class="hljs-comment">// åŒºåŸŸä¹Ÿå¯ä»¥ç”¨äºè£å‰ª</span>
        pDC-&gt;<span class="hljs-built_in">SelectClipRgn</span>(&amp;region);
        <span class="hljs-comment">// ... åœ¨è£å‰ªåŒºåŸŸå†…ç»˜å›¾</span>
        pDC-&gt;<span class="hljs-built_in">SelectClipRgn</span>(<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// å–æ¶ˆè£å‰ª</span>
    }
}
</code></pre>
<h4 data-id="heading-70">4.3 åæ ‡ç³»ç»Ÿä¸å˜æ¢</h4>
<p>MFCæ”¯æŒå¤šç§åæ ‡æ˜ å°„æ¨¡å¼å’Œå˜æ¢ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::DemonstrateCoordinateSystems</span><span class="hljs-params">(CDC* pDC)</span>
</span>{
    <span class="hljs-comment">// ä¿å­˜åŸå§‹DCçŠ¶æ€</span>
    <span class="hljs-type">int</span> nOldMapMode = pDC-&gt;<span class="hljs-built_in">SaveDC</span>();
    
    <span class="hljs-comment">// ç¤ºä¾‹1ï¼šé€»è¾‘åæ ‡ä¸è®¾å¤‡åæ ‡</span>
    pDC-&gt;<span class="hljs-built_in">SetMapMode</span>(MM_TEXT); <span class="hljs-comment">// é»˜è®¤æ¨¡å¼ï¼Œ1é€»è¾‘å•ä½=1åƒç´ </span>
    
    <span class="hljs-comment">// è®¾ç½®çª—å£ï¼ˆé€»è¾‘ï¼‰å’Œè§†å£ï¼ˆè®¾å¤‡ï¼‰èŒƒå›´</span>
    pDC-&gt;<span class="hljs-built_in">SetWindowExt</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>);  <span class="hljs-comment">// é€»è¾‘èŒƒå›´</span>
    pDC-&gt;<span class="hljs-built_in">SetViewportExt</span>(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>);  <span class="hljs-comment">// è®¾å¤‡èŒƒå›´</span>
    
    <span class="hljs-comment">// ç¤ºä¾‹2ï¼šä½¿ç”¨MM_ANISOTROPICæ¨¡å¼</span>
    pDC-&gt;<span class="hljs-built_in">SetMapMode</span>(MM_ANISOTROPIC);
    pDC-&gt;<span class="hljs-built_in">SetWindowExt</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>);
    pDC-&gt;<span class="hljs-built_in">SetViewportExt</span>(rectClient.<span class="hljs-built_in">Width</span>(), rectClient.<span class="hljs-built_in">Height</span>());
    
    <span class="hljs-comment">// ç»˜åˆ¶éšçª—å£å¤§å°ç¼©æ”¾çš„å›¾å½¢</span>
    pDC-&gt;<span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">900</span>, <span class="hljs-number">900</span>);
    
    <span class="hljs-comment">// ç¤ºä¾‹3ï¼šä½¿ç”¨MM_HIMETRICæ¨¡å¼ï¼ˆç‰©ç†å°ºå¯¸ï¼‰</span>
    pDC-&gt;<span class="hljs-built_in">SetMapMode</span>(MM_HIMETRIC); <span class="hljs-comment">// 0.01æ¯«ç±³å•ä½</span>
    pDC-&gt;<span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">-5000</span>); <span class="hljs-comment">// 10cm x 5cmçŸ©å½¢</span>
    
    <span class="hljs-comment">// åæ ‡è½¬æ¢ç¤ºä¾‹</span>
    <span class="hljs-function">CPoint <span class="hljs-title">ptLogical</span><span class="hljs-params">(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>)</span></span>;
    CPoint ptDevice;
    
    <span class="hljs-comment">// é€»è¾‘åæ ‡è½¬è®¾å¤‡åæ ‡</span>
    pDC-&gt;<span class="hljs-built_in">LPtoDP</span>(&amp;ptLogical);
    
    <span class="hljs-comment">// è®¾å¤‡åæ ‡è½¬é€»è¾‘åæ ‡</span>
    pDC-&gt;<span class="hljs-built_in">DPtoLP</span>(&amp;ptDevice);
    
    <span class="hljs-comment">// ç¤ºä¾‹4ï¼šä¸–ç•Œå˜æ¢ï¼ˆWindows NT/2000+ï¼‰</span>
    <span class="hljs-keyword">if</span> (pDC-&gt;<span class="hljs-built_in">GetDeviceCaps</span>(RASTERCAPS) &amp; RC_TRANSFORM)
    {
        XFORM xform;
        
        <span class="hljs-comment">// è®¾ç½®æ—‹è½¬çŸ©é˜µï¼ˆæ—‹è½¬30åº¦ï¼‰</span>
        <span class="hljs-type">float</span> fAngle = <span class="hljs-number">30.0f</span> * <span class="hljs-number">3.14159f</span> / <span class="hljs-number">180.0f</span>;
        xform.eM11 = <span class="hljs-built_in">cos</span>(fAngle);
        xform.eM12 = <span class="hljs-built_in">sin</span>(fAngle);
        xform.eM21 = -<span class="hljs-built_in">sin</span>(fAngle);
        xform.eM22 = <span class="hljs-built_in">cos</span>(fAngle);
        xform.eDx = <span class="hljs-number">100.0f</span>;  <span class="hljs-comment">// Xæ–¹å‘å¹³ç§»</span>
        xform.eDy = <span class="hljs-number">100.0f</span>;  <span class="hljs-comment">// Yæ–¹å‘å¹³ç§»</span>
        
        <span class="hljs-comment">// è®¾ç½®ä¸–ç•Œå˜æ¢</span>
        pDC-&gt;<span class="hljs-built_in">SetGraphicsMode</span>(GM_ADVANCED);
        pDC-&gt;<span class="hljs-built_in">SetWorldTransform</span>(&amp;xform);
        
        <span class="hljs-comment">// ç»˜åˆ¶å˜æ¢åçš„å›¾å½¢</span>
        pDC-&gt;<span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
        
        <span class="hljs-comment">// æ¢å¤é»˜è®¤å˜æ¢</span>
        pDC-&gt;<span class="hljs-built_in">ModifyWorldTransform</span>(<span class="hljs-literal">NULL</span>, MWT_IDENTITY);
    }
    
    <span class="hljs-comment">// æ¢å¤åŸå§‹DCçŠ¶æ€</span>
    pDC-&gt;<span class="hljs-built_in">RestoreDC</span>(nOldMapMode);
}
</code></pre>
<h3 data-id="heading-71">äº”ã€å­—ä½“ä¸æ–‡æœ¬æ¸²æŸ“</h3>
<h4 data-id="heading-72">5.1 å­—ä½“åˆ›å»ºä¸æ–‡æœ¬åº¦é‡</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CTextRenderer</span>
{
<span class="hljs-keyword">private</span>:
    CFont m_fontNormal;
    CFont m_fontBold;
    CFont m_fontItalic;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">BOOL <span class="hljs-title">InitializeFonts</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// åˆ›å»ºä¸åŒé£æ ¼çš„å­—ä½“</span>
        LOGFONT lf = {<span class="hljs-number">0</span>};
        
        <span class="hljs-comment">// æ ‡å‡†å­—ä½“</span>
        lf.lfHeight = <span class="hljs-number">-16</span>; <span class="hljs-comment">// 16åƒç´ é«˜ï¼ˆè´Ÿå€¼è¡¨ç¤ºå­—ç¬¦é«˜åº¦ï¼‰</span>
        lf.lfWeight = FW_NORMAL;
        lf.lfCharSet = DEFAULT_CHARSET;
        <span class="hljs-built_in">lstrcpy</span>(lf.lfFaceName, _T(<span class="hljs-string">"å¾®è½¯é›…é»‘"</span>));
        m_fontNormal.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
        
        <span class="hljs-comment">// ç²—ä½“</span>
        lf.lfWeight = FW_BOLD;
        m_fontBold.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
        
        <span class="hljs-comment">// æ–œä½“</span>
        lf.lfWeight = FW_NORMAL;
        lf.lfItalic = TRUE;
        m_fontItalic.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
        
        <span class="hljs-keyword">return</span> TRUE;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawTextWithMetrics</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, LPCTSTR lpszText)</span>
    </span>{
        CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;m_fontNormal);
        
        <span class="hljs-comment">// è·å–æ–‡æœ¬åº¦é‡ä¿¡æ¯</span>
        TEXTMETRIC tm;
        pDC-&gt;<span class="hljs-built_in">GetTextMetrics</span>(&amp;tm);
        
        <span class="hljs-comment">// è®¡ç®—æ–‡æœ¬å®½åº¦</span>
        CSize sizeText = pDC-&gt;<span class="hljs-built_in">GetTextExtent</span>(lpszText, <span class="hljs-built_in">lstrlen</span>(lpszText));
        
        <span class="hljs-comment">// ç»˜åˆ¶èƒŒæ™¯</span>
        <span class="hljs-function">CRect <span class="hljs-title">rectText</span><span class="hljs-params">(x, y, x + sizeText.cx, y + tm.tmHeight)</span></span>;
        <span class="hljs-function">CBrush <span class="hljs-title">brushBg</span><span class="hljs-params">(RGB(<span class="hljs-number">240</span>, <span class="hljs-number">240</span>, <span class="hljs-number">240</span>))</span></span>;
        pDC-&gt;<span class="hljs-built_in">FillRect</span>(&amp;rectText, &amp;brushBg);
        
        <span class="hljs-comment">// ç»˜åˆ¶æ–‡æœ¬</span>
        pDC-&gt;<span class="hljs-built_in">SetBkMode</span>(TRANSPARENT);
        pDC-&gt;<span class="hljs-built_in">TextOut</span>(x, y, lpszText);
        
        <span class="hljs-comment">// ç»˜åˆ¶åŸºçº¿</span>
        <span class="hljs-function">CPen <span class="hljs-title">penBaseline</span><span class="hljs-params">(PS_SOLID, <span class="hljs-number">1</span>, RGB(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))</span></span>;
        CPen* pOldPen = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;penBaseline);
        pDC-&gt;<span class="hljs-built_in">MoveTo</span>(x, y + tm.tmAscent);
        pDC-&gt;<span class="hljs-built_in">LineTo</span>(x + sizeText.cx, y + tm.tmAscent);
        
        <span class="hljs-comment">// ç»˜åˆ¶è¾¹ç•Œæ¡†</span>
        <span class="hljs-function">CPen <span class="hljs-title">penBorder</span><span class="hljs-params">(PS_DOT, <span class="hljs-number">1</span>, RGB(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>))</span></span>;
        pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;penBorder);
        pDC-&gt;<span class="hljs-built_in">SelectStockObject</span>(NULL_BRUSH);
        pDC-&gt;<span class="hljs-built_in">Rectangle</span>(&amp;rectText);
        
        pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldPen);
        pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
    }
    
    <span class="hljs-comment">// å¤šè¡Œæ–‡æœ¬ç»˜åˆ¶</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawMultilineText</span><span class="hljs-params">(CDC* pDC, CRect rect, LPCTSTR lpszText)</span>
    </span>{
        CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;m_fontNormal);
        
        <span class="hljs-comment">// è®¾ç½®æ–‡æœ¬æ ¼å¼</span>
        UINT uFormat = DT_LEFT | DT_WORDBREAK | DT_NOPREFIX | DT_EDITCONTROL;
        
        <span class="hljs-comment">// è®¡ç®—éœ€è¦çš„çŸ©å½¢é«˜åº¦</span>
        CRect rectCalc = rect;
        pDC-&gt;<span class="hljs-built_in">DrawText</span>(lpszText, <span class="hljs-number">-1</span>, &amp;rectCalc, uFormat | DT_CALCRECT);
        
        <span class="hljs-comment">// ç»˜åˆ¶æ–‡æœ¬</span>
        pDC-&gt;<span class="hljs-built_in">DrawText</span>(lpszText, <span class="hljs-number">-1</span>, &amp;rect, uFormat);
        
        pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
    }
};
</code></pre>
<h4 data-id="heading-73">5.2 é«˜çº§æ–‡æœ¬æ•ˆæœ</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CMyView::DrawTextEffects</span><span class="hljs-params">(CDC* pDC)</span>
</span>{
    CRect rectClient;
    <span class="hljs-built_in">GetClientRect</span>(&amp;rectClient);
    
    <span class="hljs-comment">// 1. é˜´å½±æ–‡å­—</span>
    <span class="hljs-built_in">DrawShadowText</span>(pDC, _T(<span class="hljs-string">"é˜´å½±æ•ˆæœ"</span>), 
                   <span class="hljs-built_in">CPoint</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>), 
                   <span class="hljs-built_in">RGB</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>));
    
    <span class="hljs-comment">// 2. æ¸å˜æ–‡å­—</span>
    <span class="hljs-built_in">DrawGradientText</span>(pDC, _T(<span class="hljs-string">"æ¸å˜æ–‡å­—"</span>), 
                     <span class="hljs-built_in">CPoint</span>(<span class="hljs-number">50</span>, <span class="hljs-number">100</span>), 
                     <span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-built_in">RGB</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>));
    
    <span class="hljs-comment">// 3. è½®å»“æ–‡å­—</span>
    <span class="hljs-built_in">DrawOutlineText</span>(pDC, _T(<span class="hljs-string">"è½®å»“æ–‡å­—"</span>), 
                    <span class="hljs-built_in">CPoint</span>(<span class="hljs-number">50</span>, <span class="hljs-number">150</span>), 
                    <span class="hljs-number">3</span>, <span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>), <span class="hljs-built_in">RGB</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawShadowText</span><span class="hljs-params">(CDC* pDC, LPCTSTR lpszText, CPoint pt, 
                    COLORREF crText, COLORREF crShadow)</span>
</span>{
    CFont font;
    LOGFONT lf = {<span class="hljs-number">0</span>};
    lf.lfHeight = <span class="hljs-number">-48</span>;
    lf.lfWeight = FW_BOLD;
    <span class="hljs-built_in">lstrcpy</span>(lf.lfFaceName, _T(<span class="hljs-string">"Arial"</span>));
    font.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
    
    CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;font);
    
    <span class="hljs-comment">// ç»˜åˆ¶é˜´å½±</span>
    pDC-&gt;<span class="hljs-built_in">SetTextColor</span>(crShadow);
    pDC-&gt;<span class="hljs-built_in">TextOut</span>(pt.x + <span class="hljs-number">3</span>, pt.y + <span class="hljs-number">3</span>, lpszText);
    
    <span class="hljs-comment">// ç»˜åˆ¶å‰æ™¯æ–‡å­—</span>
    pDC-&gt;<span class="hljs-built_in">SetTextColor</span>(crText);
    pDC-&gt;<span class="hljs-built_in">TextOut</span>(pt.x, pt.y, lpszText);
    
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawGradientText</span><span class="hljs-params">(CDC* pDC, LPCTSTR lpszText, CPoint pt,
                      COLORREF crStart, COLORREF crEnd)</span>
</span>{
    <span class="hljs-comment">// åˆ›å»ºå­—ä½“</span>
    CFont font;
    LOGFONT lf = {<span class="hljs-number">0</span>};
    lf.lfHeight = <span class="hljs-number">-48</span>;
    lf.lfWeight = FW_BOLD;
    <span class="hljs-built_in">lstrcpy</span>(lf.lfFaceName, _T(<span class="hljs-string">"Arial"</span>));
    font.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lf);
    
    CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;font);
    
    <span class="hljs-comment">// è·å–æ–‡æœ¬å°ºå¯¸</span>
    CSize sizeText = pDC-&gt;<span class="hljs-built_in">GetTextExtent</span>(lpszText, <span class="hljs-built_in">lstrlen</span>(lpszText));
    
    <span class="hljs-comment">// åˆ›å»ºæ¸å˜ç”»åˆ·</span>
    TRIVERTEX vert[<span class="hljs-number">2</span>] = {<span class="hljs-number">0</span>};
    vert[<span class="hljs-number">0</span>].x = pt.x;
    vert[<span class="hljs-number">0</span>].y = pt.y;
    vert[<span class="hljs-number">0</span>].Red = <span class="hljs-built_in">GetRValue</span>(crStart) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">0</span>].Green = <span class="hljs-built_in">GetGValue</span>(crStart) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">0</span>].Blue = <span class="hljs-built_in">GetBValue</span>(crStart) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">0</span>].Alpha = <span class="hljs-number">0x0000</span>;
    
    vert[<span class="hljs-number">1</span>].x = pt.x + sizeText.cx;
    vert[<span class="hljs-number">1</span>].y = pt.y + sizeText.cy;
    vert[<span class="hljs-number">1</span>].Red = <span class="hljs-built_in">GetRValue</span>(crEnd) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">1</span>].Green = <span class="hljs-built_in">GetGValue</span>(crEnd) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">1</span>].Blue = <span class="hljs-built_in">GetBValue</span>(crEnd) &lt;&lt; <span class="hljs-number">8</span>;
    vert[<span class="hljs-number">1</span>].Alpha = <span class="hljs-number">0x0000</span>;
    
    GRADIENT_RECT gRect = {<span class="hljs-number">0</span>, <span class="hljs-number">1</span>};
    
    <span class="hljs-comment">// ä½¿ç”¨è·¯å¾„åˆ›å»ºæ–‡æœ¬è½®å»“</span>
    pDC-&gt;<span class="hljs-built_in">BeginPath</span>();
    pDC-&gt;<span class="hljs-built_in">TextOut</span>(pt.x, pt.y, lpszText);
    pDC-&gt;<span class="hljs-built_in">EndPath</span>();
    
    <span class="hljs-comment">// ç”¨æ¸å˜å¡«å……æ–‡æœ¬è·¯å¾„</span>
    pDC-&gt;<span class="hljs-built_in">SelectClipPath</span>(RGN_COPY);
    pDC-&gt;<span class="hljs-built_in">GradientFill</span>(vert, <span class="hljs-number">2</span>, &amp;gRect, <span class="hljs-number">1</span>, GRADIENT_FILL_RECT_H);
    
    pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
}
</code></pre>
<h3 data-id="heading-74">å…­ã€ä½å›¾æ“ä½œä¸å›¾åƒå¤„ç†</h3>
<h4 data-id="heading-75">6.1 ä½å›¾åŠ è½½ä¸æ˜¾ç¤ºä¼˜åŒ–</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CBitmapManager</span>
{
<span class="hljs-keyword">private</span>:
    CMap&lt;UINT, UINT, CBitmap*, CBitmap*&gt; m_mapBitmaps;
    CSize m_sizeDisplay; <span class="hljs-comment">// æ˜¾ç¤ºå°ºå¯¸ç¼“å­˜</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CBitmapManager</span>() : <span class="hljs-built_in">m_sizeDisplay</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) {}
    
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">CBitmapManager</span>()
    {
        <span class="hljs-built_in">Cleanup</span>();
    }
    
    <span class="hljs-comment">// ä»èµ„æºåŠ è½½ä½å›¾</span>
    <span class="hljs-function">CBitmap* <span class="hljs-title">LoadBitmapFromResource</span><span class="hljs-params">(UINT nIDResource, 
                                    CSize sizeTarget = CSize(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>))</span>
    </span>{
        CBitmap* pBitmap = <span class="hljs-literal">NULL</span>;
        
        <span class="hljs-keyword">if</span> (m_mapBitmaps.<span class="hljs-built_in">Lookup</span>(nIDResource, pBitmap))
            <span class="hljs-keyword">return</span> pBitmap;
        
        <span class="hljs-comment">// åŠ è½½åŸå§‹ä½å›¾</span>
        CBitmap bmpOriginal;
        <span class="hljs-keyword">if</span> (!bmpOriginal.<span class="hljs-built_in">LoadBitmap</span>(nIDResource))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
        
        <span class="hljs-comment">// è·å–åŸå§‹å°ºå¯¸</span>
        BITMAP bmInfo;
        bmpOriginal.<span class="hljs-built_in">GetBitmap</span>(&amp;bmInfo);
        
        <span class="hljs-function">CSize <span class="hljs-title">sizeSource</span><span class="hljs-params">(bmInfo.bmWidth, bmInfo.bmHeight)</span></span>;
        
        <span class="hljs-comment">// å¦‚æœéœ€è¦ç¼©æ”¾</span>
        <span class="hljs-keyword">if</span> (sizeTarget.cx &gt; <span class="hljs-number">0</span> &amp;&amp; sizeTarget.cy &gt; <span class="hljs-number">0</span> &amp;&amp; 
            (sizeTarget != sizeSource))
        {
            pBitmap = <span class="hljs-built_in">ScaleBitmap</span>(&amp;bmpOriginal, sizeSource, sizeTarget);
        }
        <span class="hljs-keyword">else</span>
        {
            pBitmap = <span class="hljs-keyword">new</span> CBitmap;
            pBitmap-&gt;<span class="hljs-built_in">Attach</span>(bmpOriginal.<span class="hljs-built_in">Detach</span>());
        }
        
        m_mapBitmaps.<span class="hljs-built_in">SetAt</span>(nIDResource, pBitmap);
        <span class="hljs-keyword">return</span> pBitmap;
    }
    
    <span class="hljs-comment">// ä½å›¾ç¼©æ”¾å‡½æ•°</span>
    <span class="hljs-function">CBitmap* <span class="hljs-title">ScaleBitmap</span><span class="hljs-params">(CBitmap* pSrcBitmap, CSize sizeSrc, CSize sizeDst)</span>
    </span>{
        <span class="hljs-comment">// åˆ›å»ºæºDCå’Œç›®æ ‡DC</span>
        <span class="hljs-function">CWindowDC <span class="hljs-title">dcScreen</span><span class="hljs-params">(<span class="hljs-literal">NULL</span>)</span></span>;
        CDC dcSrc, dcDst;
        
        dcSrc.<span class="hljs-built_in">CreateCompatibleDC</span>(&amp;dcScreen);
        dcDst.<span class="hljs-built_in">CreateCompatibleDC</span>(&amp;dcScreen);
        
        <span class="hljs-comment">// åˆ›å»ºç›®æ ‡ä½å›¾</span>
        CBitmap* pDstBitmap = <span class="hljs-keyword">new</span> CBitmap;
        pDstBitmap-&gt;<span class="hljs-built_in">CreateCompatibleBitmap</span>(&amp;dcScreen, 
                                          sizeDst.cx, sizeDst.cy);
        
        <span class="hljs-comment">// é€‰å…¥ä½å›¾</span>
        CBitmap* pOldSrcBitmap = dcSrc.<span class="hljs-built_in">SelectObject</span>(pSrcBitmap);
        CBitmap* pOldDstBitmap = dcDst.<span class="hljs-built_in">SelectObject</span>(pDstBitmap);
        
        <span class="hljs-comment">// è®¾ç½®æ‹‰ä¼¸æ¨¡å¼</span>
        dcDst.<span class="hljs-built_in">SetStretchBltMode</span>(HALFTONE);
        dcDst.<span class="hljs-built_in">SetBrushOrg</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        
        <span class="hljs-comment">// æ‰§è¡Œç¼©æ”¾</span>
        dcDst.<span class="hljs-built_in">StretchBlt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sizeDst.cx, sizeDst.cy,
                        &amp;dcSrc, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sizeSrc.cx, sizeSrc.cy,
                        SRCCOPY);
        
        <span class="hljs-comment">// æ¢å¤å¹¶æ¸…ç†</span>
        dcSrc.<span class="hljs-built_in">SelectObject</span>(pOldSrcBitmap);
        dcDst.<span class="hljs-built_in">SelectObject</span>(pOldDstBitmap);
        
        <span class="hljs-keyword">return</span> pDstBitmap;
    }
    
    <span class="hljs-comment">// é€æ˜ä½å›¾ç»˜åˆ¶</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawTransparentBitmap</span><span class="hljs-params">(CDC* pDC, CBitmap* pBitmap, 
                               CPoint ptDest, COLORREF crTransparent)</span>
    </span>{
        <span class="hljs-comment">// åˆ›å»ºå†…å­˜DC</span>
        CDC dcMem, dcMask;
        dcMem.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        dcMask.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        
        <span class="hljs-comment">// è·å–ä½å›¾å°ºå¯¸</span>
        BITMAP bm;
        pBitmap-&gt;<span class="hljs-built_in">GetBitmap</span>(&amp;bm);
        
        <span class="hljs-comment">// åˆ›å»ºæ©ç ä½å›¾</span>
        CBitmap bmpMask;
        bmpMask.<span class="hljs-built_in">CreateBitmap</span>(bm.bmWidth, bm.bmHeight, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">NULL</span>);
        
        <span class="hljs-comment">// é€‰å…¥ä½å›¾</span>
        CBitmap* pOldMemBitmap = dcMem.<span class="hljs-built_in">SelectObject</span>(pBitmap);
        CBitmap* pOldMaskBitmap = dcMask.<span class="hljs-built_in">SelectObject</span>(&amp;bmpMask);
        
        <span class="hljs-comment">// è®¾ç½®é€æ˜è‰²</span>
        COLORREF crOldBk = dcMem.<span class="hljs-built_in">SetBkColor</span>(crTransparent);
        
        <span class="hljs-comment">// åˆ›å»ºæ©ç ï¼ˆé€æ˜åŒºåŸŸä¸º1ï¼Œéé€æ˜åŒºåŸŸä¸º0ï¼‰</span>
        dcMask.<span class="hljs-built_in">BitBlt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, bm.bmWidth, bm.bmHeight, 
                     &amp;dcMem, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, SRCCOPY);
        
        <span class="hljs-comment">// åœ¨ç›®æ ‡DCä¸Šä½¿ç”¨æ©ç </span>
        pDC-&gt;<span class="hljs-built_in">BitBlt</span>(ptDest.x, ptDest.y, bm.bmWidth, bm.bmHeight,
                   &amp;dcMask, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, SRCAND);
        
        <span class="hljs-comment">// è®¾ç½®èƒŒæ™¯è‰²å¹¶ç»˜åˆ¶</span>
        dcMem.<span class="hljs-built_in">SetBkColor</span>(<span class="hljs-built_in">RGB</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));
        dcMem.<span class="hljs-built_in">SetTextColor</span>(<span class="hljs-built_in">RGB</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>));
        dcMem.<span class="hljs-built_in">BitBlt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, bm.bmWidth, bm.bmHeight,
                    &amp;dcMask, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, SRCAND);
        
        <span class="hljs-comment">// åˆå¹¶ç»“æœ</span>
        pDC-&gt;<span class="hljs-built_in">BitBlt</span>(ptDest.x, ptDest.y, bm.bmWidth, bm.bmHeight,
                   &amp;dcMem, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, SRCPAINT);
        
        <span class="hljs-comment">// æ¢å¤</span>
        dcMem.<span class="hljs-built_in">SetBkColor</span>(crOldBk);
        dcMem.<span class="hljs-built_in">SelectObject</span>(pOldMemBitmap);
        dcMask.<span class="hljs-built_in">SelectObject</span>(pOldMaskBitmap);
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Cleanup</span><span class="hljs-params">()</span>
    </span>{
        POSITION pos = m_mapBitmaps.<span class="hljs-built_in">GetStartPosition</span>();
        UINT nID;
        CBitmap* pBitmap;
        <span class="hljs-keyword">while</span> (pos != <span class="hljs-literal">NULL</span>)
        {
            m_mapBitmaps.<span class="hljs-built_in">GetNextAssoc</span>(pos, nID, pBitmap);
            <span class="hljs-keyword">delete</span> pBitmap;
        }
        m_mapBitmaps.<span class="hljs-built_in">RemoveAll</span>();
    }
};
</code></pre>
<h4 data-id="heading-76">6.2 å›¾åƒç‰¹æ•ˆå¤„ç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ç®€å•çš„å›¾åƒå¤„ç†è¿‡æ»¤å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CImageFilter</span>
{
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// ç°åº¦åŒ–</span>
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">ConvertToGrayScale</span><span class="hljs-params">(CDC* pDC, CBitmap* pBitmap, 
                                   <span class="hljs-type">const</span> CRect&amp; rect)</span>
    </span>{
        <span class="hljs-comment">// è·å–ä½å›¾ä¿¡æ¯</span>
        BITMAP bm;
        pBitmap-&gt;<span class="hljs-built_in">GetBitmap</span>(&amp;bm);
        
        <span class="hljs-comment">// åˆ›å»ºå†…å­˜DC</span>
        CDC dcMem;
        dcMem.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        CBitmap* pOldBitmap = dcMem.<span class="hljs-built_in">SelectObject</span>(pBitmap);
        
        <span class="hljs-comment">// é€åƒç´ å¤„ç†</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = rect.top; y &lt; rect.bottom; y++)
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = rect.left; x &lt; rect.right; x++)
            {
                COLORREF cr = dcMem.<span class="hljs-built_in">GetPixel</span>(x, y);
                
                <span class="hljs-comment">// è®¡ç®—ç°åº¦å€¼</span>
                BYTE r = <span class="hljs-built_in">GetRValue</span>(cr);
                BYTE g = <span class="hljs-built_in">GetGValue</span>(cr);
                BYTE b = <span class="hljs-built_in">GetBValue</span>(cr);
                BYTE gray = (BYTE)(<span class="hljs-number">0.299</span> * r + <span class="hljs-number">0.587</span> * g + <span class="hljs-number">0.114</span> * b);
                
                <span class="hljs-comment">// è®¾ç½®ç°åº¦åƒç´ </span>
                dcMem.<span class="hljs-built_in">SetPixel</span>(x, y, <span class="hljs-built_in">RGB</span>(gray, gray, gray));
            }
        }
        
        dcMem.<span class="hljs-built_in">SelectObject</span>(pOldBitmap);
    }
    
    <span class="hljs-comment">// äº®åº¦è°ƒæ•´</span>
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">AdjustBrightness</span><span class="hljs-params">(CDC* pDC, CBitmap* pBitmap,
                                 <span class="hljs-type">const</span> CRect&amp; rect, <span class="hljs-type">int</span> nDelta)</span>
    </span>{
        CDC dcMem;
        dcMem.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        CBitmap* pOldBitmap = dcMem.<span class="hljs-built_in">SelectObject</span>(pBitmap);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = rect.top; y &lt; rect.bottom; y++)
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = rect.left; x &lt; rect.right; x++)
            {
                COLORREF cr = dcMem.<span class="hljs-built_in">GetPixel</span>(x, y);
                
                BYTE r = <span class="hljs-built_in">Clamp</span>(<span class="hljs-built_in">GetRValue</span>(cr) + nDelta);
                BYTE g = <span class="hljs-built_in">Clamp</span>(<span class="hljs-built_in">GetGValue</span>(cr) + nDelta);
                BYTE b = <span class="hljs-built_in">Clamp</span>(<span class="hljs-built_in">GetBValue</span>(cr) + nDelta);
                
                dcMem.<span class="hljs-built_in">SetPixel</span>(x, y, <span class="hljs-built_in">RGB</span>(r, g, b));
            }
        }
        
        dcMem.<span class="hljs-built_in">SelectObject</span>(pOldBitmap);
    }
    
    <span class="hljs-comment">// å¯¹æ¯”åº¦è°ƒæ•´</span>
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">AdjustContrast</span><span class="hljs-params">(CDC* pDC, CBitmap* pBitmap,
                               <span class="hljs-type">const</span> CRect&amp; rect, <span class="hljs-type">double</span> dContrast)</span>
    </span>{
        CDC dcMem;
        dcMem.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
        CBitmap* pOldBitmap = dcMem.<span class="hljs-built_in">SelectObject</span>(pBitmap);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = rect.top; y &lt; rect.bottom; y++)
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = rect.left; x &lt; rect.right; x++)
            {
                COLORREF cr = dcMem.<span class="hljs-built_in">GetPixel</span>(x, y);
                
                BYTE r = <span class="hljs-built_in">Clamp</span>((<span class="hljs-type">int</span>)((<span class="hljs-built_in">GetRValue</span>(cr) - <span class="hljs-number">128</span>) * dContrast + <span class="hljs-number">128</span>));
                BYTE g = <span class="hljs-built_in">Clamp</span>((<span class="hljs-type">int</span>)((<span class="hljs-built_in">GetGValue</span>(cr) - <span class="hljs-number">128</span>) * dContrast + <span class="hljs-number">128</span>));
                BYTE b = <span class="hljs-built_in">Clamp</span>((<span class="hljs-type">int</span>)((<span class="hljs-built_in">GetBValue</span>(cr) - <span class="hljs-number">128</span>) * dContrast + <span class="hljs-number">128</span>));
                
                dcMem.<span class="hljs-built_in">SetPixel</span>(x, y, <span class="hljs-built_in">RGB</span>(r, g, b));
            }
        }
        
        dcMem.<span class="hljs-built_in">SelectObject</span>(pOldBitmap);
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">static</span> BYTE <span class="hljs-title">Clamp</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span>
    </span>{
        <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">255</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">255</span>;
        <span class="hljs-keyword">return</span> (BYTE)value;
    }
};
</code></pre>
<h3 data-id="heading-77">ä¸ƒã€æ‰“å°ä¸æ‰“å°é¢„è§ˆ</h3>
<h4 data-id="heading-78">7.1 æ‰“å°æ¶æ„çš„å®ç°</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ”¯æŒæ‰“å°çš„è§†å›¾ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CPrintableView</span> : <span class="hljs-keyword">public</span> CView
{
<span class="hljs-keyword">protected</span>:
    <span class="hljs-comment">// æ‰“å°ç›¸å…³æˆå‘˜</span>
    CPrintInfo m_printInfo;
    <span class="hljs-type">int</span> m_nPageWidth;
    <span class="hljs-type">int</span> m_nPageHeight;
    <span class="hljs-type">int</span> m_nCurPage;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnPreparePrinting</span><span class="hljs-params">(CPrintInfo* pInfo)</span>
    </span>{
        <span class="hljs-comment">// è®¾ç½®æ‰“å°å¯¹è¯æ¡†é»˜è®¤å€¼</span>
        pInfo-&gt;<span class="hljs-built_in">SetMaxPage</span>(<span class="hljs-number">10</span>); <span class="hljs-comment">// å‡è®¾æœ€å¤š10é¡µ</span>
        pInfo-&gt;<span class="hljs-built_in">SetMinPage</span>(<span class="hljs-number">1</span>);
        
        <span class="hljs-comment">// è°ƒç”¨DoPreparePrintingæ˜¾ç¤ºæ‰“å°å¯¹è¯æ¡†</span>
        <span class="hljs-built_in">DoPreparePrinting</span>(pInfo);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnBeginPrinting</span><span class="hljs-params">(CDC* pDC, CPrintInfo* pInfo)</span>
    </span>{
        <span class="hljs-comment">// è·å–æ‰“å°æœºDCèƒ½åŠ›</span>
        m_nPageWidth = pDC-&gt;<span class="hljs-built_in">GetDeviceCaps</span>(HORZRES);
        m_nPageHeight = pDC-&gt;<span class="hljs-built_in">GetDeviceCaps</span>(VERTRES);
        
        <span class="hljs-comment">// è®¡ç®—æ€»é¡µæ•°</span>
        CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
        <span class="hljs-type">int</span> nTotalLines = pDoc-&gt;<span class="hljs-built_in">GetLineCount</span>();
        <span class="hljs-type">int</span> nLinesPerPage = m_nPageHeight / <span class="hljs-number">20</span>; <span class="hljs-comment">// å‡è®¾æ¯è¡Œ20åƒç´ </span>
        
        pInfo-&gt;<span class="hljs-built_in">SetMaxPage</span>((nTotalLines + nLinesPerPage - <span class="hljs-number">1</span>) / nLinesPerPage);
        
        <span class="hljs-comment">// åˆ›å»ºæ‰“å°å­—ä½“</span>
        LOGFONT lfPrint = {<span class="hljs-number">0</span>};
        lfPrint.lfHeight = <span class="hljs-number">-15</span>; <span class="hljs-comment">// æ‰“å°å­—ä½“ç¨å°</span>
        lfPrint.lfWeight = FW_NORMAL;
        <span class="hljs-built_in">lstrcpy</span>(lfPrint.lfFaceName, _T(<span class="hljs-string">"å®‹ä½“"</span>));
        m_fontPrint.<span class="hljs-built_in">CreateFontIndirect</span>(&amp;lfPrint);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnPrint</span><span class="hljs-params">(CDC* pDC, CPrintInfo* pInfo)</span>
    </span>{
        m_nCurPage = pInfo-&gt;m_nCurPage;
        
        <span class="hljs-comment">// è®¾ç½®æ˜ å°„æ¨¡å¼</span>
        pDC-&gt;<span class="hljs-built_in">SetMapMode</span>(MM_TEXT);
        
        <span class="hljs-comment">// è®¾ç½®å­—ä½“</span>
        CFont* pOldFont = pDC-&gt;<span class="hljs-built_in">SelectObject</span>(&amp;m_fontPrint);
        
        <span class="hljs-comment">// æ‰“å°é¡µçœ‰</span>
        <span class="hljs-built_in">PrintHeader</span>(pDC);
        
        <span class="hljs-comment">// æ‰“å°å†…å®¹</span>
        <span class="hljs-built_in">PrintPageContent</span>(pDC, pInfo-&gt;m_nCurPage);
        
        <span class="hljs-comment">// æ‰“å°é¡µè„š</span>
        <span class="hljs-built_in">PrintFooter</span>(pDC);
        
        pDC-&gt;<span class="hljs-built_in">SelectObject</span>(pOldFont);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">OnEndPrinting</span><span class="hljs-params">(CDC* <span class="hljs-comment">/*pDC*/</span>, CPrintInfo* <span class="hljs-comment">/*pInfo*/</span>)</span>
    </span>{
        <span class="hljs-comment">// æ¸…ç†æ‰“å°èµ„æº</span>
        m_fontPrint.<span class="hljs-built_in">DeleteObject</span>();
    }
    
<span class="hljs-keyword">protected</span>:
    CFont m_fontPrint;
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrintHeader</span><span class="hljs-params">(CDC* pDC)</span>
    </span>{
        CString strHeader;
        strHeader.<span class="hljs-built_in">Format</span>(_T(<span class="hljs-string">"ç¬¬ %d é¡µ"</span>), m_nCurPage);
        
        pDC-&gt;<span class="hljs-built_in">TextOut</span>(<span class="hljs-number">100</span>, <span class="hljs-number">50</span>, strHeader);
        
        <span class="hljs-comment">// ç»˜åˆ¶é¡µçœ‰çº¿</span>
        pDC-&gt;<span class="hljs-built_in">MoveTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">80</span>);
        pDC-&gt;<span class="hljs-built_in">LineTo</span>(m_nPageWidth - <span class="hljs-number">50</span>, <span class="hljs-number">80</span>);
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrintPageContent</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">int</span> nPage)</span>
    </span>{
        CMyDocument* pDoc = <span class="hljs-built_in">GetDocument</span>();
        
        <span class="hljs-comment">// è®¡ç®—æœ¬é¡µæ˜¾ç¤ºçš„è¡ŒèŒƒå›´</span>
        <span class="hljs-type">int</span> nLinesPerPage = (m_nPageHeight - <span class="hljs-number">150</span>) / <span class="hljs-number">20</span>; <span class="hljs-comment">// è€ƒè™‘é¡µçœ‰é¡µè„š</span>
        <span class="hljs-type">int</span> nStartLine = (nPage - <span class="hljs-number">1</span>) * nLinesPerPage;
        <span class="hljs-type">int</span> nEndLine = <span class="hljs-built_in">min</span>(nStartLine + nLinesPerPage, 
                          pDoc-&gt;<span class="hljs-built_in">GetLineCount</span>());
        
        <span class="hljs-comment">// é€è¡Œæ‰“å°</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = nStartLine; i &lt; nEndLine; i++)
        {
            <span class="hljs-type">int</span> y = <span class="hljs-number">100</span> + (i - nStartLine) * <span class="hljs-number">20</span>;
            pDC-&gt;<span class="hljs-built_in">TextOut</span>(<span class="hljs-number">100</span>, y, pDoc-&gt;<span class="hljs-built_in">GetLine</span>(i));
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrintFooter</span><span class="hljs-params">(CDC* pDC)</span>
    </span>{
        CString strFooter = CTime::<span class="hljs-built_in">GetCurrentTime</span>().<span class="hljs-built_in">Format</span>(_T(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>));
        
        <span class="hljs-comment">// ç»˜åˆ¶é¡µè„šçº¿</span>
        pDC-&gt;<span class="hljs-built_in">MoveTo</span>(<span class="hljs-number">50</span>, m_nPageHeight - <span class="hljs-number">70</span>);
        pDC-&gt;<span class="hljs-built_in">LineTo</span>(m_nPageWidth - <span class="hljs-number">50</span>, m_nPageHeight - <span class="hljs-number">70</span>);
        
        <span class="hljs-comment">// æ‰“å°é¡µè„šæ–‡æœ¬</span>
        pDC-&gt;<span class="hljs-built_in">TextOut</span>(<span class="hljs-number">100</span>, m_nPageHeight - <span class="hljs-number">50</span>, strFooter);
    }
};
</code></pre>
<h3 data-id="heading-79">å…«ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-80">8.1 GDIèµ„æºæ³„æ¼æ£€æµ‹</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _DEBUG</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CGdiLeakDetector</span>
{
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">static</span> <span class="hljs-type">int</span> m_nGdiObjectsStart;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CGdiLeakDetector</span>()
    {
        <span class="hljs-comment">// è®°å½•åˆå§‹GDIå¯¹è±¡æ•°é‡</span>
        m_nGdiObjectsStart = <span class="hljs-built_in">GetGuiResources</span>(<span class="hljs-built_in">GetCurrentProcess</span>(), 
                                            GR_GDIOBJECTS);
    }
    
    ~<span class="hljs-built_in">CGdiLeakDetector</span>()
    {
        <span class="hljs-comment">// æ£€æŸ¥GDIå¯¹è±¡æ³„æ¼</span>
        <span class="hljs-type">int</span> nGdiObjectsEnd = <span class="hljs-built_in">GetGuiResources</span>(<span class="hljs-built_in">GetCurrentProcess</span>(), 
                                            GR_GDIOBJECTS);
        
        <span class="hljs-keyword">if</span> (nGdiObjectsEnd &gt; m_nGdiObjectsStart)
        {
            <span class="hljs-built_in">TRACE</span>(_T(<span class="hljs-string">"è­¦å‘Šï¼šæ£€æµ‹åˆ°å¯èƒ½çš„GDIå¯¹è±¡æ³„æ¼ã€‚\n"</span>));
            <span class="hljs-built_in">TRACE</span>(_T(<span class="hljs-string">"åˆå§‹: %d, ç»“æŸ: %d, æ³„æ¼: %d\n"</span>), 
                  m_nGdiObjectsStart, nGdiObjectsEnd,
                  nGdiObjectsEnd - m_nGdiObjectsStart);
            
            <span class="hljs-comment">// åœ¨è°ƒè¯•æ—¶è§¦å‘æ–­ç‚¹</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IsDebuggerPresent</span>())
            {
                <span class="hljs-built_in">DebugBreak</span>();
            }
        }
    }
};

<span class="hljs-comment">// åœ¨åº”ç”¨ç¨‹åºç±»ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CMyApp</span> : <span class="hljs-keyword">public</span> CWinApp
{
<span class="hljs-keyword">private</span>:
    CGdiLeakDetector m_gdiDetector;
    <span class="hljs-comment">// ...</span>
};
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<h4 data-id="heading-81">8.2 ç»˜å›¾ç¼“å­˜ä¸å¢é‡æ›´æ–°</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CDrawingCache</span>
{
<span class="hljs-keyword">private</span>:
    CBitmap m_bmpCache;        <span class="hljs-comment">// ç¼“å­˜ä½å›¾</span>
    CRect m_rectCache;         <span class="hljs-comment">// ç¼“å­˜åŒºåŸŸ</span>
    BOOL m_bCacheValid;        <span class="hljs-comment">// ç¼“å­˜æœ‰æ•ˆæ€§æ ‡å¿—</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">CDrawingCache</span>() : <span class="hljs-built_in">m_bCacheValid</span>(FALSE) {}
    
    <span class="hljs-comment">// æ›´æ–°ç¼“å­˜</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">UpdateCache</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">const</span> CRect&amp; rect)</span>
    </span>{
        <span class="hljs-keyword">if</span> (!m_bCacheValid || m_rectCache != rect)
        {
            <span class="hljs-comment">// åˆ›å»ºæˆ–é‡æ–°åˆ›å»ºç¼“å­˜ä½å›¾</span>
            <span class="hljs-keyword">if</span> (m_bmpCache.<span class="hljs-built_in">GetSafeHandle</span>() == <span class="hljs-literal">NULL</span> || 
                m_rectCache != rect)
            {
                m_bmpCache.<span class="hljs-built_in">DeleteObject</span>();
                m_bmpCache.<span class="hljs-built_in">CreateCompatibleBitmap</span>(pDC, 
                                                 rect.<span class="hljs-built_in">Width</span>(), 
                                                 rect.<span class="hljs-built_in">Height</span>());
                m_rectCache = rect;
            }
            
            <span class="hljs-comment">// ç»˜åˆ¶åˆ°ç¼“å­˜</span>
            CDC dcCache;
            dcCache.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
            CBitmap* pOldBmp = dcCache.<span class="hljs-built_in">SelectObject</span>(&amp;m_bmpCache);
            
            <span class="hljs-comment">// ç»˜åˆ¶èƒŒæ™¯å’Œå†…å®¹åˆ°ç¼“å­˜</span>
            <span class="hljs-built_in">DrawToCache</span>(&amp;dcCache, rect);
            
            dcCache.<span class="hljs-built_in">SelectObject</span>(pOldBmp);
            m_bCacheValid = TRUE;
        }
    }
    
    <span class="hljs-comment">// ä»ç¼“å­˜ç»˜åˆ¶åˆ°å±å¹•</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RenderFromCache</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">const</span> CPoint&amp; ptDest)</span>
    </span>{
        <span class="hljs-keyword">if</span> (m_bCacheValid)
        {
            CDC dcCache;
            dcCache.<span class="hljs-built_in">CreateCompatibleDC</span>(pDC);
            CBitmap* pOldBmp = dcCache.<span class="hljs-built_in">SelectObject</span>(&amp;m_bmpCache);
            
            pDC-&gt;<span class="hljs-built_in">BitBlt</span>(ptDest.x, ptDest.y, 
                       m_rectCache.<span class="hljs-built_in">Width</span>(), m_rectCache.<span class="hljs-built_in">Height</span>(),
                       &amp;dcCache, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, SRCCOPY);
            
            dcCache.<span class="hljs-built_in">SelectObject</span>(pOldBmp);
        }
    }
    
    <span class="hljs-comment">// ä½¿ç¼“å­˜å¤±æ•ˆ</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvalidateCache</span><span class="hljs-params">()</span>
    </span>{
        m_bCacheValid = FALSE;
    }
    
    <span class="hljs-comment">// éƒ¨åˆ†ç¼“å­˜å¤±æ•ˆ</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvalidateCacheRect</span><span class="hljs-params">(<span class="hljs-type">const</span> CRect&amp; rectInvalid)</span>
    </span>{
        <span class="hljs-keyword">if</span> (m_bCacheValid &amp;&amp; m_rectCache.<span class="hljs-built_in">IntersectRect</span>(&amp;rectInvalid))
        {
            <span class="hljs-comment">// åªé‡æ–°ç»˜åˆ¶å—å½±å“çš„éƒ¨åˆ†</span>
            CDC dcCache;
            <span class="hljs-function">CClientDC <span class="hljs-title">dcScreen</span><span class="hljs-params">(<span class="hljs-literal">NULL</span>)</span></span>;
            dcCache.<span class="hljs-built_in">CreateCompatibleDC</span>(&amp;dcScreen);
            CBitmap* pOldBmp = dcCache.<span class="hljs-built_in">SelectObject</span>(&amp;m_bmpCache);
            
            <span class="hljs-comment">// æ¸…é™¤å—å½±å“åŒºåŸŸ</span>
            <span class="hljs-function">CBrush <span class="hljs-title">brushBg</span><span class="hljs-params">(RGB(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))</span></span>;
            dcCache.<span class="hljs-built_in">FillRect</span>(&amp;rectInvalid, &amp;brushBg);
            
            <span class="hljs-comment">// é‡æ–°ç»˜åˆ¶å—å½±å“åŒºåŸŸ</span>
            <span class="hljs-built_in">RedrawInvalidArea</span>(&amp;dcCache, rectInvalid);
            
            dcCache.<span class="hljs-built_in">SelectObject</span>(pOldBmp);
        }
    }
    
<span class="hljs-keyword">protected</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">DrawToCache</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">const</span> CRect&amp; rect)</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">RedrawInvalidArea</span><span class="hljs-params">(CDC* pDC, <span class="hljs-type">const</span> CRect&amp; rect)</span> </span>= <span class="hljs-number">0</span>;
};
</code></pre>
<h3 data-id="heading-82">ä¹ã€ä¸ç°ä»£å›¾å½¢APIçš„å¯¹æ¯”</h3>
<p>è™½ç„¶GDIå·²ç»é€æ¸è¢«Direct2Dã€DirectWriteç­‰ç°ä»£å›¾å½¢APIå–ä»£ï¼Œä½†ç†è§£GDIçš„è®¾è®¡ä»æœ‰ä»·å€¼ï¼š</p>
<ol>
<li><strong>è®¾å¤‡æŠ½è±¡å±‚</strong>ï¼šGDIçš„è®¾å¤‡ä¸Šä¸‹æ–‡æ¦‚å¿µå½±å“äº†åç»­APIçš„è®¾è®¡</li>
<li><strong>èµ„æºç®¡ç†æ¨¡å‹</strong>ï¼šGDIå¯¹è±¡çš„åˆ›å»º/é€‰æ‹©/åˆ é™¤æ¨¡å¼ä¸ºåæ¥çš„èµ„æºç®¡ç†æä¾›äº†å‚è€ƒ</li>
<li><strong>åæ ‡ç³»ç»Ÿ</strong>ï¼šGDIçš„æ˜ å°„æ¨¡å¼ä¸ºå›¾å½¢å˜æ¢å¥ å®šäº†åŸºç¡€</li>
</ol>
<p><strong>è¿ç§»ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>å¯¹äºæ–°é¡¹ç›®ï¼Œæ¨èä½¿ç”¨Direct2D/DirectWriteæˆ–è·¨å¹³å°å›¾å½¢åº“</li>
<li>å¯¹äºç°æœ‰MFCé¡¹ç›®ï¼Œå¯é€æ­¥æ›¿æ¢ç»˜å›¾ä»£ç ï¼ŒåŒæ—¶ä¿ç•™ä¸šåŠ¡é€»è¾‘</li>
<li>GDIä»é€‚ç”¨äºç®€å•çš„UIç»˜åˆ¶å’Œæ‰“å°åŠŸèƒ½</li>
</ul>
<p>MFCçš„GDIç¼–ç¨‹ä»£è¡¨äº†Windowså›¾å½¢ç¼–ç¨‹çš„ä¸€ä¸ªæ—¶ä»£ï¼Œè™½ç„¶æŠ€æœ¯å·²ç»æ¼”è¿›ï¼Œä½†å…¶è®¾è®¡æ€æƒ³å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆä»å¯¹ç†è§£è®¡ç®—æœºå›¾å½¢å­¦åŸºæœ¬åŸç†æœ‰é‡è¦ä»·å€¼ã€‚æŒæ¡GDIä¸ä»…æœ‰åŠ©äºç»´æŠ¤é—ç•™ä»£ç ï¼Œæ›´èƒ½æ·±åˆ»ç†è§£å›¾å½¢ç³»ç»Ÿçš„å·¥ä½œæœºåˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RebbitMQ å…¥é—¨æ•™ç¨‹çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†]]></title>    <link>https://juejin.cn/post/7580378958073069578</link>    <guid>https://juejin.cn/post/7580378958073069578</guid>    <pubDate>2025-12-07T07:33:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073069578" data-draft-id="7572972346073464859" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RebbitMQ å…¥é—¨æ•™ç¨‹çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†"/> <meta itemprop="keywords" content="åç«¯,Java,RabbitMQ"/> <meta itemprop="datePublished" content="2025-12-07T07:33:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RebbitMQ å…¥é—¨æ•™ç¨‹çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T07:33:28.000Z" title="Sun Dec 07 2025 07:33:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘ä»¬æ¥è®²ä¸€ä¸ªåœ¨åç«¯å¼€å‘ä¸­éå¸¸é‡è¦çš„ä¸­é—´ä»¶<strong>RabbitMQ</strong>ã€‚</p>
<p>ä¸ç®¡ä½ æ˜¯åˆšæ¥è§¦æ¶ˆæ¯é˜Ÿåˆ—çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯æƒ³å·©å›ºåŸºç¡€çš„å¼€å‘è€…ï¼Œè¿™ç¯‡æ–‡ç« éƒ½ä¼šå¸®ä½ è½»æ¾ç†è§£ RabbitMQ çš„æ ¸å¿ƒæ¦‚å¿µã€ä½¿ç”¨æ–¹æ³•å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ</h3>
<p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªç”µå•†ä¸‹å•æµç¨‹ï¼š</p>
<ol>
<li>ç”¨æˆ·æäº¤è®¢å•ï¼›</li>
<li>ç³»ç»Ÿä¿å­˜è®¢å•ï¼›</li>
<li>æ‰£å‡åº“å­˜ï¼›</li>
<li>å‘é€ç¡®è®¤é‚®ä»¶ï¼›</li>
<li>è®°å½•æ“ä½œæ—¥å¿—â€¦â€¦</li>
</ol>
<p>å¦‚æœè¿™äº›æ­¥éª¤éƒ½åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡ŒåŒæ­¥æ‰§è¡Œï¼Œä¸€æ—¦æŸä¸ªç¯èŠ‚ï¼ˆæ¯”å¦‚é‚®ä»¶æœåŠ¡ï¼‰å“åº”æ…¢æˆ–å®•æœºï¼Œæ•´ä¸ªä¸‹å•æµç¨‹å°±ä¼šå¡ä½ï¼Œç”šè‡³å¤±è´¥ã€‚</p>
<p>äºæ˜¯å¾ˆå¤šäººä¼šæƒ³åˆ°ï¼šç”¨ Spring çš„ <code>@Async</code> å¼‚æ­¥å¤„ç†ä¸å°±è¡Œäº†ï¼Ÿ</p>
<h4 data-id="heading-1">ä½¿ç”¨ <code>@Async</code> çš„å†™æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Order order)</span> {
    orderRepository.save(order); <span class="hljs-comment">// æ ¸å¿ƒä¸šåŠ¡</span>
    inventoryService.asyncDeductStock(order); <span class="hljs-comment">// å¼‚æ­¥æ‰£åº“å­˜</span>
    emailService.asyncSendConfirmationEmail(order); <span class="hljs-comment">// å¼‚æ­¥å‘é‚®ä»¶</span>
}

<span class="hljs-meta">@Async</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">asyncDeductStock</span><span class="hljs-params">(Order order)</span> {
    <span class="hljs-comment">// æ‰£åº“å­˜é€»è¾‘</span>
}
</code></pre>
<p><strong>ä½†é—®é¢˜æ¥äº†ï¼š</strong></p>
<ul>
<li><strong>ä»»åŠ¡å¯èƒ½ä¸¢å¤±</strong>ï¼šå¦‚æœåº”ç”¨é‡å¯ï¼Œæ­£åœ¨å¼‚æ­¥æ‰§è¡Œçš„ä»»åŠ¡å°±æ²¡äº†ï¼›</li>
<li><strong>æ— æ³•è·¨æœåŠ¡</strong>ï¼š<code>@Async</code> åªèƒ½åœ¨å½“å‰ JVM å†…ç”Ÿæ•ˆï¼Œæ— æ³•é€šçŸ¥å…¶ä»–å¾®æœåŠ¡ï¼›</li>
<li><strong>ç¼ºä¹é‡è¯•ä¸ç›‘æ§</strong>ï¼šå¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿæ²¡äººçŸ¥é“ï¼Œä¹Ÿæ²¡æ³•è‡ªåŠ¨é‡è¯•ï¼›</li>
<li><strong>æµé‡æ— æ³•ç¼“å†²</strong>ï¼šå¤§ä¿ƒæ—¶ç¬æ—¶é«˜å¹¶å‘ï¼Œç›´æ¥å‹å®ä¸‹æ¸¸æœåŠ¡ã€‚</li>
</ul>
<p><code>@Async</code> é€‚åˆè½»é‡çº§ã€éå…³é”®ã€åŒæœåŠ¡å†…çš„å¼‚æ­¥ä»»åŠ¡ï¼›è€Œ<strong>è·¨æœåŠ¡ã€é«˜å¯é ã€éœ€è§£è€¦çš„åœºæ™¯ï¼Œå¿…é¡»å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ RabbitMQï¼Ÿ</h3>
<p>RabbitMQ æ˜¯ä¸€ä¸ªå¼€æºçš„<strong>æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMessage Brokerï¼‰</strong>ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´å®‰å…¨ã€å¯é åœ°ä¼ é€’æ¶ˆæ¯ã€‚</p>
<p>ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªæ™ºèƒ½å¿«é€’ï¼š</p>
<ul>
<li><strong>ç”Ÿäº§è€…ï¼ˆProducerï¼‰</strong>ï¼šä¸‹å•æˆåŠŸåï¼ŒæŠŠâ€œè®¢å•å·²åˆ›å»ºâ€è¿™ä¸ªäº‹ä»¶æ‰“åŒ…æˆæ¶ˆæ¯ï¼ŒæŠ•é€’åˆ° RabbitMQï¼›</li>
<li><strong>RabbitMQ</strong>ï¼šæš‚å­˜æ¶ˆæ¯ï¼Œç¡®ä¿ä¸ä¸¢å¤±ï¼›</li>
<li><strong>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰</strong>ï¼šåº“å­˜æœåŠ¡ã€é‚®ä»¶æœåŠ¡å„è‡ªç›‘å¬é˜Ÿåˆ—ï¼ŒæŒ‰éœ€å–èµ°æ¶ˆæ¯å¤„ç†ã€‚</li>
</ul>
<p>å³ä½¿åº“å­˜æœåŠ¡æš‚æ—¶å®•æœºï¼Œæ¶ˆæ¯ä¹Ÿä¼šä¸€ç›´ç•™åœ¨é˜Ÿåˆ—é‡Œï¼Œç­‰å®ƒæ¢å¤åå†æ¶ˆè´¹â€”â€”<strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ç”±æ­¤ä¿éšœã€‚</p>
<hr/>
<h3 data-id="heading-3">RabbitMQ vs @Asyncï¼šå…³é”®å¯¹æ¯”</h3>








































<table><thead><tr><th>ç»´åº¦</th><th><code>@Async</code></th><th>RabbitMQ</th></tr></thead><tbody><tr><td><strong>ä½œç”¨èŒƒå›´</strong></td><td>åŒä¸€åº”ç”¨å†…</td><td>è·¨åº”ç”¨ã€è·¨æœåŠ¡</td></tr><tr><td><strong>å¯é æ€§</strong></td><td>ä½ï¼ˆJVM é‡å¯å³ä¸¢ï¼‰</td><td>é«˜ï¼ˆæ”¯æŒæŒä¹…åŒ–ã€ACKã€é‡è¯•ï¼‰</td></tr><tr><td><strong>è§£è€¦èƒ½åŠ›</strong></td><td>å¼±ï¼ˆä»ä¾èµ–æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼‰</td><td>å¼ºï¼ˆå®Œå…¨é€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼‰</td></tr><tr><td><strong>æµé‡å‰Šå³°</strong></td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒï¼ˆé˜Ÿåˆ—ç¼“å†²è¯·æ±‚ï¼‰</td></tr><tr><td><strong>å¯è§‚æµ‹æ€§</strong></td><td>å·®</td><td>å¥½ï¼ˆå¯é€šè¿‡ç®¡ç†ç•Œé¢ç›‘æ§ç§¯å‹ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ—¥å¿—è®°å½•ã€ç¼“å­˜æ›´æ–°ç­‰éå…³é”®ä»»åŠ¡</td><td>è®¢å•å¤„ç†ã€æ”¯ä»˜å›è°ƒã€å¼‚æ­¥é€šçŸ¥ç­‰å…³é”®é“¾è·¯</td></tr></tbody></table>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>ä¸¤è€…ä¸æ˜¯äº’æ–¥ï¼Œè€Œæ˜¯äº’è¡¥ã€‚</li>
<li>åº”ç”¨å†…éƒ¨è½»é‡å¼‚æ­¥ â†’ <code>@Async</code></li>
<li>è·¨æœåŠ¡å…³é”®å¼‚æ­¥ â†’ RabbitMQ</li>
</ul>
<h3 data-id="heading-4">RabbitMQ æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>ç†è§£è¿™äº›åŸºç¡€æ¦‚å¿µæ˜¯æŒæ¡ RabbitMQ çš„å…³é”®ï¼š</p>
<p><strong>1. Producerï¼ˆç”Ÿäº§è€…ï¼‰</strong>ï¼šæ¶ˆæ¯çš„å‘é€æ–¹
<strong>2. Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰</strong>ï¼šæ¶ˆæ¯çš„æ¥æ”¶å’Œå¤„ç†æ–¹<br/>
<strong>3. Queueï¼ˆé˜Ÿåˆ—ï¼‰</strong>ï¼šæ¶ˆæ¯çš„å­˜å‚¨å®¹å™¨ï¼Œå…ˆè¿›å…ˆå‡º
<strong>4. Exchangeï¼ˆäº¤æ¢æœºï¼‰</strong>ï¼šæ¥æ”¶æ¶ˆæ¯å¹¶æ ¹æ®è§„åˆ™è·¯ç”±åˆ°é˜Ÿåˆ—
<strong>5. Bindingï¼ˆç»‘å®šï¼‰</strong>ï¼šè¿æ¥äº¤æ¢æœºå’Œé˜Ÿåˆ—çš„è§„åˆ™</p>
<p><strong>å·¥ä½œæµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ° Exchange</li>
<li>Exchange æ ¹æ® Binding è§„åˆ™å°†æ¶ˆæ¯è·¯ç”±åˆ° Queue</li>
<li>æ¶ˆè´¹è€…ä» Queue è·å–å¹¶å¤„ç†æ¶ˆæ¯</li>
<li>å¤„ç†æˆåŠŸåç¡®è®¤æ¶ˆæ¯åˆ é™¤</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/959f9844aae7499ab1cb47e5f0211944~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5aSn5Y2O:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765697608&amp;x-signature=zdhKFaMlvduGpLwK9uvNn5Qq1Ow%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-5">å…¸å‹ä½¿ç”¨åœºæ™¯</h3>
<p><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šç”¨æˆ·æ³¨å†Œåå‘é€éªŒè¯é‚®ä»¶ï¼Œæ— éœ€ç­‰å¾…é‚®ä»¶å‘é€å®Œæˆ
<strong>åº”ç”¨è§£è€¦</strong>ï¼šè®¢å•ç³»ç»Ÿä¸ç‰©æµç³»ç»Ÿé€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼Œäº’ä¸å½±å“
<strong>æµé‡å‰Šå³°</strong>ï¼šç§’æ€æ´»åŠ¨æ—¶ï¼Œè¯·æ±‚å…ˆè¿›å…¥é˜Ÿåˆ—ï¼Œåç«¯å¹³ç¨³å¤„ç†
<strong>æ—¥å¿—æ”¶é›†</strong>ï¼šå¤šä¸ªæœåŠ¡å°†æ—¥å¿—å‘é€åˆ°é˜Ÿåˆ—ï¼Œç»Ÿä¸€å¤„ç†åˆ†æ</p>
<hr/>
<h3 data-id="heading-6">Spring Boot ç¤ºä¾‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªå®é™…åœºæ™¯æ¥å­¦ä¹  RabbitMQ çš„ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-7">åœºæ™¯ä¸€ï¼šåŸºç¡€æ¶ˆæ¯æ”¶å‘</h4>
<p><strong>1. æ·»åŠ ä¾èµ–</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>2. é…ç½®è¿æ¥</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">guest</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">guest</span>
</code></pre>
<p><strong>3. å®šä¹‰é˜Ÿåˆ—</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitConfig</span> {
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">helloQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(<span class="hljs-string">"hello.queue"</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// æŒä¹…åŒ–é˜Ÿåˆ—</span>
    }
}
</code></pre>
<p><strong>4. å‘é€æ¶ˆæ¯</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageController</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-meta">@GetMapping("/send")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">sendMessage</span><span class="hljs-params">()</span> {
        rabbitTemplate.convertAndSend(<span class="hljs-string">"hello.queue"</span>, <span class="hljs-string">"Hello, RabbitMQ!"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ¶ˆæ¯å‘é€æˆåŠŸ"</span>;
    }
}
</code></pre>
<p><strong>5. æ¥æ”¶æ¶ˆæ¯</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "hello.queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receiveMessage</span><span class="hljs-params">(String message)</span> {
        log.info(<span class="hljs-string">"æ”¶åˆ°æ¶ˆæ¯: {}"</span>, message);
    }
}
</code></pre>
<h4 data-id="heading-8">åœºæ™¯äºŒï¼šå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ - æ‰¹é‡ä»»åŠ¡å¤„ç†</h4>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦å¤„ç†ä¸¤ç§å¼‚æ­¥ä»»åŠ¡ï¼š</p>
<ul>
<li>æ‰¹é‡æ›´æ–°ç”¨æˆ·ä¿¡æ¯</li>
<li>æ‰¹é‡æ›´æ–°æ–‡ç« å¤‡æ³¨</li>
</ul>
<p><strong>1. ä»»åŠ¡é˜Ÿåˆ—é…ç½®</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskQueueConfig</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">USER_BATCH_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user.batch.update.queue"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ARTICLE_REMARK_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"article.remark.update.queue"</span>;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">userBatchQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> QueueBuilder.durable(USER_BATCH_QUEUE).build();
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">articleRemarkQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> QueueBuilder.durable(ARTICLE_REMARK_QUEUE).build();
    }
}
</code></pre>
<p>ä½¿ç”¨ <code>QueueBuilder</code> æ›´æ¸…æ™°ï¼Œä¸”é»˜è®¤å¼€å¯æŒä¹…åŒ–ã€‚</p>
<p><strong>2. æ¶ˆæ¯ç”Ÿäº§è€…</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendUserBatchUpdate</span><span class="hljs-params">(List&lt;Long&gt; userIds)</span> {
        rabbitTemplate.convertAndSend(TaskQueueConfig.USER_BATCH_QUEUE, userIds);
        log.info(<span class="hljs-string">"æäº¤æ‰¹é‡ç”¨æˆ·æ›´æ–°ä»»åŠ¡ï¼Œå…± {} äºº"</span>, userIds.size());
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendArticleRemarkUpdate</span><span class="hljs-params">(Long articleId, String remark)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">dto</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArticleRemarkDTO</span>(articleId, remark);
        rabbitTemplate.convertAndSend(TaskQueueConfig.ARTICLE_REMARK_QUEUE, dto);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendBatchRemarks</span><span class="hljs-params">(Map&lt;Long, String&gt; map)</span> {
        map.forEach(<span class="hljs-built_in">this</span>::sendArticleRemarkUpdate);
    }
}
</code></pre>
<p><strong>3. æ¶ˆæ¯æ¶ˆè´¹è€…</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = TaskQueueConfig.USER_BATCH_QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleUserBatch</span><span class="hljs-params">(List&lt;Long&gt; userIds)</span> {
        <span class="hljs-keyword">try</span> {
            userService.batchUpdate(userIds);
            log.info(<span class="hljs-string">"æ‰¹é‡æ›´æ–° {} ç”¨æˆ·å®Œæˆ"</span>, userIds.size());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ‰¹é‡æ›´æ–°å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e); <span class="hljs-comment">// è§¦å‘é‡è¯•ï¼ˆéœ€é…ç½®ï¼‰</span>
        }
    }

    <span class="hljs-meta">@RabbitListener(queues = TaskQueueConfig.ARTICLE_REMARK_QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleArticleRemark</span><span class="hljs-params">(ArticleRemarkDTO dto)</span> {
        <span class="hljs-keyword">try</span> {
            articleService.updateRemark(dto.getArticleId(), dto.getRemark());
            log.info(<span class="hljs-string">"æ›´æ–°æ–‡ç« [{}]å¤‡æ³¨æˆåŠŸ"</span>, dto.getArticleId());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ›´æ–°æ–‡ç« å¤‡æ³¨å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
}
</code></pre>
<p><strong>è¿™é‡Œä¸ºä»€ä¹ˆæ–‡ç« å¤‡æ³¨è¦é€ä¸ªå‘ï¼Ÿ</strong>
å› ä¸ºå•æ¡æ¶ˆæ¯å¤±è´¥åªå½±å“ä¸€æ¡æ•°æ®ï¼Œä¾¿äºé‡è¯•å’Œæ’æŸ¥ï¼›è€Œæ‰¹é‡æ¶ˆæ¯ä¸€æ—¦å¤±è´¥ï¼Œæ•´æ‰¹å›æ»šæˆæœ¬é«˜ã€‚å…·ä½“å¯ä»¥æ ¹æ®å®é™…æƒ…å†µä½¿ç”¨ä¸åŒçš„æ–¹æ¡ˆã€‚</p>
<hr/>
<h3 data-id="heading-9">ç”Ÿäº§ç¯å¢ƒå»ºè®®</h3>
<p><strong>1. æ¶ˆæ¯æŒä¹…åŒ–</strong>ï¼šç¡®ä¿ RabbitMQ é‡å¯åæ¶ˆæ¯ä¸ä¸¢å¤±
<strong>2. æ‰‹åŠ¨ç¡®è®¤æœºåˆ¶</strong>ï¼šé˜²æ­¢æ¶ˆæ¯å¤„ç†å¤±è´¥åä¸¢å¤±</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">listener:</span>
      <span class="hljs-attr">simple:</span>
        <span class="hljs-attr">acknowledge-mode:</span> <span class="hljs-string">manual</span>
</code></pre>
<p><strong>3. æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼šå¤„ç†å¤šæ¬¡é‡è¯•ä»å¤±è´¥çš„æ¶ˆæ¯
<strong>4. æ¶ˆè´¹è€…é™æµ</strong>ï¼šè®¾ç½®åˆé€‚çš„ prefetch count é˜²æ­¢æ¶ˆè´¹è€…è¿‡è½½
<strong>5. ç›‘æ§å‘Šè­¦</strong>ï¼šç›‘æ§é˜Ÿåˆ—ç§¯å‹æƒ…å†µï¼ŒåŠæ—¶å‘ç°é—®é¢˜</p>
<hr/>
<h3 data-id="heading-10">æ€»ç»“</h3>
<p>RabbitMQ ä½œä¸ºæˆç†Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼š</p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼š</p>
<ul>
<li><strong>ç³»ç»Ÿè§£è€¦</strong>ï¼šæœåŠ¡é—´é€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼Œç‹¬ç«‹æ¼”åŒ–</li>
<li><strong>å¯é ä¼ é€’</strong>ï¼šæ¶ˆæ¯æŒä¹…åŒ–ï¼Œç¡®ä¿ä¸ä¸¢å¤±</li>
<li><strong>å¼¹æ€§æ‰©å±•</strong>ï¼šæ¶ˆè´¹è€…å¯æ°´å¹³æ‰©å±•åº”å¯¹æµé‡æ³¢åŠ¨</li>
<li><strong>æµé‡å‰Šå³°</strong>ï¼šå¹³æ»‘çªå‘æµé‡ï¼Œä¿æŠ¤åç«¯ç³»ç»Ÿ</li>
<li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿæ•°æ®ä¸€è‡´æ€§</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¾®æœåŠ¡æ¶æ„ã€å¼‚æ­¥ä»»åŠ¡å¤„ç†ã€ç³»ç»Ÿé›†æˆã€æ•°æ®åŒæ­¥ç­‰ã€‚</p>
<p>æŒæ¡ RabbitMQ å°†æå¤§æå‡ä½ è®¾è®¡å’Œå¼€å‘åˆ†å¸ƒå¼ç³»ç»Ÿçš„èƒ½åŠ›ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£å¹¶ç†Ÿç»ƒè¿ç”¨è¿™ä¸ªå¼ºå¤§çš„å·¥å…·ï¼</p>
<p>å…¶å®ƒæ¨¡å¼çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ç»™å‡ºå®Œæ•´çš„ç¤ºä¾‹ã€‚</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-11">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6V83qjR6u0nyfzL-14xYAw" target="_blank" title="https://mp.weixin.qq.com/s/6V83qjR6u0nyfzL-14xYAw" ref="nofollow noopener noreferrer">ã€Šasync/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FPQ_w7CDVoIZPn-CVH2DKJg" target="_blank" title="https://mp.weixin.qq.com/s/PQ_w7CDVoIZPn-CVH2DKJg" ref="nofollow noopener noreferrer">ã€ŠVue3 å’Œ Vue2 çš„æ ¸å¿ƒåŒºåˆ«ï¼Ÿå¾ˆå¤šå¼€å‘è€…éƒ½æ²¡å®Œå…¨ææ‡‚çš„ 10 ä¸ªç»†èŠ‚ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqI3TRTdDfRJSH9kCTqAQUw" target="_blank" title="https://mp.weixin.qq.com/s/qI3TRTdDfRJSH9kCTqAQUw" ref="nofollow noopener noreferrer">ã€Šè¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7580378958073479178</link>    <guid>https://juejin.cn/post/7580378958073479178</guid>    <pubDate>2025-12-07T12:20:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073479178" data-draft-id="7576369868418891812" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:20:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:20:12.000Z" title="Sun Dec 07 2025 12:20:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« é‡Œï¼Œä»‹ç»äº† <code>BroadcastChannel</code> çš„å¹¿æ’­ã€<code>postMessage</code> çš„çµæ´»ä»¥åŠ <code>MessageChannel</code> çš„ç²¾å‡†ã€‚è¿™äº›ç°ä»£ API ä¸ºæˆ‘ä»¬æä¾›äº†æ ‡å‡†çš„é€šä¿¡èƒ½åŠ›ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬è¦ä»‹ç»ä¸‹â€”â€”<code>window.name</code>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªä¸ºé€šä¿¡è€Œç”Ÿçš„ APIï¼Œä½†æ˜¯æœ‰å…¶ç‹¬ç‰¹çš„â€œè·¨é¡µé¢æŒä¹…æ€§â€ç‰¹æ€§ï¼Œæˆä¸ºè§£å†³è·¨åŸŸæ•°æ®ä¼ è¾“é—®é¢˜çš„æ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-1">1. window.nameæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><code>window.name</code> æ˜¯ä¸€ä¸ªæå…¶ç®€å•çš„å±æ€§ï¼Œå®ƒçš„åŸå§‹è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥è®¾ç½®æˆ–è·å–çª—å£ï¼ˆæµè§ˆå™¨æ ‡ç­¾é¡µï¼‰çš„åç§°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è®¾ç½®çª—å£åç§°</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'My Awesome Window'</span>;

<span class="hljs-comment">// è·å–çª—å£åç§°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// 'My Awesome Window'</span>
</code></pre>
<p>å®ƒæœ‰ä¸€ä¸ª<strong>é‡è¦</strong>çš„ç‰¹æ€§ï¼š</p>
<blockquote>
<p><strong>åªè¦æ˜¯åœ¨åŒä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µä¸­ï¼Œå³ä½¿é¡µé¢å‘ç”Ÿäº†è·³è½¬ï¼ˆä»ä¸€ä¸ªåŸŸååˆ°å¦ä¸€ä¸ªåŸŸåï¼‰ï¼Œ<code>window.name</code> çš„å€¼ä¹Ÿä¸ä¼šè¢«é‡ç½®ï¼Œå®ƒä¼šä¸€ç›´ä¿ç•™ã€‚</strong> æ›´æƒŠäººçš„æ˜¯ï¼Œå®ƒçš„å®¹é‡éå¸¸å¤§ï¼Œé€šå¸¸å¯ä»¥è¾¾åˆ° <strong>2MB</strong> å·¦å³ï¼</p>
</blockquote>
<h2 data-id="heading-2">2. <code>window.name</code> çš„ä½œç”¨åŸŸ</h2>
<p><code>window.name</code> å±æ€§æ˜¯å±äº<strong>æ¯ä¸€ä¸ªç‹¬ç«‹çš„çª—å£ä¸Šä¸‹æ–‡ï¼ˆWindow Context</strong>çš„ã€‚</p>
<ol>
<li><strong>çˆ¶é¡µé¢</strong>æ˜¯ä¸€ä¸ªçª—å£ä¸Šä¸‹æ–‡ï¼Œå®ƒæœ‰è‡ªå·±çš„ <code>window.name</code>ã€‚</li>
<li><strong>iframe å­é¡µé¢</strong>æ˜¯å¦ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„çª—å£ä¸Šä¸‹æ–‡ï¼Œå®ƒä¹Ÿæœ‰<strong>è‡ªå·±</strong>çš„ <code>window.name</code>ã€‚</li>
</ol>
<p>å®ƒä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å˜é‡ï¼Œäº’ä¸å½±å“ã€‚å½“ä½ åœ¨å­é¡µé¢ä¸­ç›´æ¥è°ƒç”¨ <code>window.name</code> æ—¶ï¼Œä½ è®¿é—®çš„æ˜¯<strong>å­é¡µé¢è‡ªå·±</strong>çš„ <code>name</code>ï¼Œè€Œä¸æ˜¯çˆ¶é¡µé¢çš„ã€‚</p>
<h3 data-id="heading-3">2.1 å¦‚ä½•æ­£ç¡®è®¿é—®çˆ¶é¡µé¢çš„ <code>window.name</code></h3>
<p>è™½ç„¶ä¸èƒ½ç›´æ¥è¯»å–ï¼Œä½† iframe æä¾›äº†è®¿é—®çˆ¶çª—å£çš„è·¯å¾„ï¼š<code>window.parent</code>,å¯ä»¥é€šè¿‡<code>iframe.contentWindow.name</code>è®¾ç½®å­é¡µé¢çš„nameã€‚</p>
<blockquote>
<p><strong>å…³é”®ç‚¹ï¼š</strong> iframe çš„åˆ·æ–°åªä¼šé‡ç½®å®ƒ<strong>è‡ªå·±</strong>çš„ <code>window.name</code>ï¼Œå¯¹çˆ¶é¡µé¢çš„ <code>window.name</code> æ¯«æ— å½±å“ã€‚å¹¶ä¸”å¦‚æœéœ€è¦è®¾ç½®å­é¡µé¢çš„nameï¼Œå¿…é¡»æ˜¯åŒæºã€‚</p>
</blockquote>
<p>åªèƒ½è¯»å–åŒæºå­é¡µé¢çš„nameï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c507432879df4fffa238e1fa90d8899e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714812&amp;x-signature=FopTWfuXQup3T2%2Fl0DDjuVUV3EI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">3. å®æˆ˜æ¡ˆä¾‹</h2>
<p>é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ï¼Œå…·ä½“çœ‹ä»£ç ï¼š</p>
<ol>
<li>çˆ¶é¡µé¢ (<code>parent.html</code>)</li>
</ol>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>çˆ¶é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>è¿™æ˜¯çˆ¶é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çˆ¶é¡µé¢çš„ window.name: <span class="hljs-tag">&lt;<span class="hljs-name">strong</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parentName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"child.html"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myIframe"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 300px; border: 1px solid black;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// 1. è®¾ç½®çˆ¶é¡µé¢çš„ name</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®"</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentName'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>;

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶é¡µé¢: å·²è®¾ç½® window.name ='</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<ol start="2">
<li>å­é¡µé¢ (<code>child.html</code>)</li>
</ol>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å­é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è¿™æ˜¯ iframe å­é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"location.reload()"</span>&gt;</span>åˆ·æ–°æœ¬é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å­é¡µé¢è‡ªå·±çš„ window.name:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"childName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parentNameFromChild"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateDisplay</span>(<span class="hljs-params"/>) {
            <span class="hljs-comment">// è¯»å–å­é¡µé¢è‡ªå·±çš„ name</span>
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'childName'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> || <span class="hljs-string">'(ç©º)'</span>;

            <span class="hljs-comment">// é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢çš„ name</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> parentName = <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-property">name</span>;
                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentNameFromChild'</span>).<span class="hljs-property">textContent</span> = parentName;
            } <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentNameFromChild'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">'è®¿é—®å¤±è´¥ (è·¨åŸŸ?)'</span>;
            }
        }
        <span class="hljs-title function_">updateDisplay</span>();

        <span class="hljs-comment">// ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸‹å­é¡µé¢è‡ªå·±çš„ name</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"æˆ‘æ˜¯å­é¡µé¢è‡ªå·±çš„æ•°æ®"</span>;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>å­é¡µé¢ä¼šæ˜¾ç¤ºï¼š<code>å­é¡µé¢è‡ªå·±çš„ window.name: æˆ‘æ˜¯å­é¡µé¢è‡ªå·±çš„æ•°æ®</code>,å­é¡µé¢ä¼šæ˜¾ç¤ºï¼š<code>é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢: æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®</code>ã€‚
<strong>ç‚¹å‡»â€œåˆ·æ–°æœ¬é¡µé¢â€æŒ‰é’®å</strong>ï¼šå­é¡µé¢ä¼šé‡æ–°åŠ è½½ï¼Œå…¶<strong>è‡ªå·±</strong>çš„ <code>window.name</code> ä¼šè¢«é‡ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ä½†æ˜¯ï¼Œ<code>window.parent.name</code> çš„å€¼<strong>ä¾ç„¶æ˜¯</strong> <code>æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®</code>ï¼Œå®Œå…¨ä¸å—å½±å“ã€‚</p>
<h2 data-id="heading-5">4. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼šwindow.nameä½œä¸ºæµè§ˆå™¨çš„ä¸€ä¸ªè€å¤è‘£æ–¹æ¡ˆï¼Œç®€å•äº†è§£ä»‹ç»ä¸‹ï¼Œå¦‚æœéœ€è¦é€šè®¯ï¼Œè¿˜æ˜¯æ¨è<code>postMessage</code>ç­‰é€šè®¯æ–¹å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥è§£æ SystemUI ä¾èµ–æ³¨å…¥ï¼šDagger2 ä¸ Hilt æ ¸å¿ƒæœºåˆ¶é‡æ¸©]]></title>    <link>https://juejin.cn/post/7580329353353723950</link>    <guid>https://juejin.cn/post/7580329353353723950</guid>    <pubDate>2025-12-07T05:46:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580329353353723950" data-draft-id="7580537115910930432" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥è§£æ SystemUI ä¾èµ–æ³¨å…¥ï¼šDagger2 ä¸ Hilt æ ¸å¿ƒæœºåˆ¶é‡æ¸©"/> <meta itemprop="keywords" content="Android,Dagger"/> <meta itemprop="datePublished" content="2025-12-07T05:46:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„¤æ€’çš„ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/4125023358426190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥è§£æ SystemUI ä¾èµ–æ³¨å…¥ï¼šDagger2 ä¸ Hilt æ ¸å¿ƒæœºåˆ¶é‡æ¸©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023358426190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„¤æ€’çš„ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T05:46:14.000Z" title="Sun Dec 07 2025 05:46:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">0x00. èƒŒæ™¯</h2>
<p>SystemUI ä½œä¸º Android ç³»ç»Ÿçš„â€œé—¨é¢â€ï¼Œç®¡ç†ç€çŠ¶æ€æ (<code>StatusBar</code>)ã€é€šçŸ¥é¢æ¿(<code>NotificationPanel</code>)ã€é”å±(<code>Keyguard</code>)ç­‰æ ¸å¿ƒäº¤äº’ï¼Œå…¶ä»£ç åº“åºå¤§ä¸”çŠ¶æ€å¤æ‚ã€‚ä¸ºäº†è§£è€¦å„ä¸ªåŠŸèƒ½æ¨¡å—ï¼ŒGoogle åœ¨ SystemUI ä¸­æ·±åº¦åº”ç”¨äº† Dagger2 è¿›è¡Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injection, DIï¼‰ã€‚</p>
<p>åœ¨æ·±å…¥ SystemUI çš„ <code>GlobalRootComponent</code> æˆ– <code>SysUIComponent</code> æºç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹ Dagger2 çš„æ ¸å¿ƒæœºåˆ¶è¿›è¡Œä¸€æ¬¡â€œé«˜ä¿çœŸâ€çš„å›é¡¾ã€‚æœ¬ç¯‡ä¸è¿½æ±‚é¢é¢ä¿±åˆ°ï¼Œè€Œæ˜¯èšç„¦äºé‚£äº›æ”¯æ’‘ SystemUI æ¶æ„çš„åŸºçŸ³æ¦‚å¿µã€‚</p>
<h2 data-id="heading-1">0x01. æ ¸å¿ƒè§’è‰²ï¼šDagger2 çš„æ³¨è§£â€œäº”è™å°†â€</h2>
<p>Dagger2 çš„å·¥ä½œæœ¬è´¨æ˜¯<strong>é€šè¿‡æ³¨è§£å¤„ç†å™¨åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆä»£ç </strong>ï¼Œä»è€Œæ„å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–çš„ä¾èµ–å·¥å‚ã€‚ç†è§£ä»¥ä¸‹ 5 ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œæ˜¯çœ‹æ‡‚ SystemUI æºç çš„å‰æã€‚</p>
<h3 data-id="heading-2">1.1. @Injectï¼šè¯·æ±‚ä¸ä¾›ç»™çš„â€œé”šç‚¹â€</h3>
<p>è¿™æ˜¯æœ€åŸºç¡€çš„æ³¨è§£ï¼Œå®ƒæœ‰ä¸¤ä¸ªä¸»è¦ç”¨é€”ï¼š</p>
<ul>
<li><strong>è¯·æ±‚ä¾èµ–</strong>ï¼šæ ‡è®°åœ¨æ„é€ å‡½æ•°ï¼ˆConstructor Injectionï¼‰æˆ–æˆå‘˜å˜é‡ï¼ˆField Injectionï¼‰ä¸Šï¼Œå‘Šè¯‰ Daggerï¼šâ€œæˆ‘éœ€è¦è¿™ä¸ªå¯¹è±¡ã€‚â€</li>
<li><strong>ä¾›ç»™ä¾èµ–</strong>ï¼šæ ‡è®°åœ¨ç±»çš„æ„é€ å‡½æ•°ä¸Šï¼Œå‘Šè¯‰ Daggerï¼šâ€œä½ å¯ä»¥é€šè¿‡è°ƒç”¨è¿™ä¸ªæ„é€ å‡½æ•°æ¥åˆ›å»ºæˆ‘çš„å®ä¾‹ã€‚â€</li>
</ul>
<h3 data-id="heading-3">1.2. @Moduleï¼šç”Ÿäº§å®ä¾‹çš„å·¥å‚</h3>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰ç±»éƒ½èƒ½é€šè¿‡ <code>@Inject</code> æ„é€ å‡½æ•°åˆ›å»ºï¼ˆä¾‹å¦‚ï¼šæ¥å£ã€ç¬¬ä¸‰æ–¹åº“çš„ç±»ã€éœ€è¦å¤æ‚é…ç½®çš„ç±»ï¼‰ã€‚</p>
<ul>
<li><strong>@Module</strong>ï¼šå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œä»“åº“â€æˆ–â€œå·¥å‚è½¦é—´â€ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾ç”Ÿæˆå¯¹è±¡çš„æ–¹æ³•ã€‚</li>
<li><strong>@Provides</strong>ï¼šæ ‡è®°åœ¨ <code>@Module</code> ä¸­çš„æ–¹æ³•ä¸Šã€‚å½“ Dagger éœ€è¦æŸä¸ªç±»å‹çš„å¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡æ— æ³•ç›´æ¥æ„é€ æ—¶ï¼Œå®ƒä¼šæ¥è¿™é‡Œå¯»æ‰¾å¸¦æœ‰ <code>@Provides</code> çš„æ–¹æ³•ã€‚</li>
<li><strong>@Binds</strong>ï¼šæ ‡è®°åœ¨ <code>@Module</code> ä¸­çš„æ–¹æ³•ä¸Šã€‚å½“ Dagger éœ€è¦æ‰¾æŸä¸ªæ¥å£å¯¹åº”çš„å®ç°ç±»æ—¶ä½¿ç”¨ <code>@Binds</code>è¿›è¡Œç»‘å®šã€‚</li>
</ul>
<h3 data-id="heading-4">1.3. @Componentï¼šè¿æ¥å™¨ï¼ˆThe Bridgeï¼‰</h3>
<p>è¿™æ˜¯ Dagger çš„æ ¸å¿ƒå¤§è„‘ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¿æ¥äº†â€œéœ€æ±‚æ–¹â€ï¼ˆä½¿ç”¨ <code>@Inject</code> çš„åœ°æ–¹ï¼‰å’Œâ€œä¾›ç»™æ–¹â€ï¼ˆ<code>@Module</code> æˆ– <code>@Inject</code> æ„é€ å‡½æ•°ï¼‰ã€‚</p>
<ul>
<li>å®ƒå‘Šè¯‰ Dagger ä»å“ªé‡Œè·å–ä¾èµ–ï¼Œä»¥åŠå°†ä¾èµ–æ³¨å…¥åˆ°å“ªé‡Œã€‚</li>
<li>åœ¨ç¼–è¯‘æ—¶ï¼ŒDagger ä¼šç”Ÿæˆè¯¥æ¥å£çš„å®ç°ç±»ï¼ˆå¦‚ <code>DaggerCarComponent</code>ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5">1.4. @Subcomponentï¼šå›¾è°±çš„ç»§æ‰¿</h3>
<p>åœ¨ SystemUI ä¸­ï¼Œ<code>@Subcomponent</code> è‡³å…³é‡è¦ã€‚å®ƒç”¨äºåˆ›å»º<strong>ä¾èµ–å›¾è°±çš„å­å›¾</strong>ã€‚</p>
<ul>
<li>å­ç»„ä»¶å¯ä»¥è®¿é—®çˆ¶ç»„ä»¶çš„æ‰€æœ‰å¯¹è±¡ï¼Œä½†çˆ¶ç»„ä»¶æ— æ³•è®¿é—®å­ç»„ä»¶ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šSystemUI ä¸­æœ‰å…¨å±€å•ä¾‹ï¼ˆGlobal Scopeï¼‰ï¼Œä¹Ÿæœ‰é’ˆå¯¹ç‰¹å®šç”¨æˆ·çš„ä¼šè¯ï¼ˆUser Scopeï¼‰ã€‚å½“ç”¨æˆ·åˆ‡æ¢æ—¶ï¼ŒUserSubcomponent ä¼šè¢«é”€æ¯å¹¶é‡å»ºï¼Œè€Œ GlobalComponent ä¿æŒä¸å˜ã€‚</li>
</ul>
<h3 data-id="heading-6">1.5. @Scope (å¦‚ @Singleton)ï¼šç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†è€…</h3>
<p>Dagger é»˜è®¤æ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚<code>@Scope</code> ç”¨äºå°†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåˆ° Component çš„ç”Ÿå‘½å‘¨æœŸä¸Šã€‚</p>
<ul>
<li>å¦‚æœä¸€ä¸ª Component ç”Ÿå‘½å‘¨æœŸåƒ Application ä¸€æ ·é•¿ï¼Œä¸”å¯¹è±¡è¢«æ ‡è®°ä¸º <code>@Singleton</code>ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å°±æ˜¯å…¨å±€å•ä¾‹ã€‚</li>
<li>åœ¨ SystemUI ä¸­ï¼Œä½ ä¼šçœ‹åˆ°å¤§é‡çš„ <code>@SysUISingleton</code>ï¼Œå…¶æœ¬è´¨ä¸ <code>@Singleton</code> ç±»ä¼¼ï¼Œåªæ˜¯ä¸ºäº†è¯­ä¹‰æ›´æ˜ç¡®ã€‚</li>
</ul>
<h2 data-id="heading-7">0x02. å¹•åæœºåˆ¶ï¼šç¼–è¯‘æ—¶ä¾èµ–å›¾æ„å»º</h2>
<p>ä¸åŒäº Guice æˆ– Spring ç­‰æ¡†æ¶åœ¨<strong>è¿è¡Œæ—¶</strong>é€šè¿‡åå°„æŸ¥æ‰¾ä¾èµ–ï¼ŒDagger2 çš„é­”æ³•å‘ç”Ÿåœ¨<strong>ç¼–è¯‘æ—¶ï¼ˆCompile Timeï¼‰</strong> ã€‚</p>
<ol>
<li><strong>æ³¨è§£å¤„ç†</strong>ï¼šç¼–è¯‘å™¨æ‰«ææ‰€æœ‰çš„ <code>@Inject</code>, <code>@Module</code>, <code>@Component</code>ã€‚</li>
<li><strong>å›¾è°±éªŒè¯</strong>ï¼šDagger æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–ã€ä¾èµ–ç¼ºå¤±ç­‰é—®é¢˜ã€‚å¦‚æœæœ‰é”™ï¼Œç¼–è¯‘ç›´æ¥å¤±è´¥ï¼ˆFail Fastï¼‰ã€‚</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šDagger ç”Ÿæˆæ ‡å‡†çš„ Java/Kotlin ä»£ç ï¼ˆå¦‚ <code>Factory</code> ç±»å’Œ <code>MembersInjector</code> ç±»ï¼‰ã€‚</li>
</ol>
<p>è¿™æ„å‘³ç€ï¼ŒSystemUI è¿è¡Œæ—¶æ²¡æœ‰ä»»ä½•ä¾èµ–æ³¨å…¥å¸¦æ¥çš„åå°„æ€§èƒ½æŸè€—ï¼Œè¿™å¯¹äºå¯¹æµç•…åº¦è¦æ±‚æé«˜çš„ UI ç³»ç»Ÿå°¤ä¸ºå…³é”®ã€‚</p>
<h2 data-id="heading-8">0x03. å®æˆ˜æ¼”ç»ƒï¼šä¸€ä¸ªæç®€çš„ Car ç»„è£…å‚</h2>
<p>ä¸ºäº†æŠ›å¼€ SystemUI çš„å¤æ‚ä¸šåŠ¡å¹²æ‰°ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªå¹²å‡€çš„æ±½è½¦æ¨¡å‹ï¼Œå±•ç¤ºä»å®šä¹‰åˆ°æ³¨å…¥çš„å®Œæ•´é—­ç¯ã€‚</p>
<h3 data-id="heading-9">ç¬¬ä¸€æ­¥ï¼šå®šä¹‰ä¾èµ– (The Dependency)</h3>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª <code>Engine</code> æ¥å£ï¼Œä»¥åŠå®ƒçš„å…·ä½“å®ç° <code>V8Engine</code>ã€‚æ³¨æ„ <code>V8Engine</code> æ‹¥æœ‰ <code>@Inject</code> æ„é€ å‡½æ•°ï¼Œè¿™æ„å‘³ç€ Dagger çŸ¥é“å¦‚ä½•åˆ›å»ºå®ƒã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// 1. å®šä¹‰æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Engine</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span>
}

<span class="hljs-comment">// 2. å®šä¹‰å…·ä½“å®ç°ï¼Œå¹¶å‘ŠçŸ¥ Dagger å¦‚ä½•æ„é€ å®ƒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">V8Engine</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>() : Engine {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span> = println(<span class="hljs-string">"V8 Engine roaring!"</span>)
}

<span class="hljs-comment">// 3. æ™®é€šç±»ï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Wheel</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">roll</span><span class="hljs-params">()</span></span> = println(<span class="hljs-string">"Wheel rolling"</span>)
}
</code></pre>
<h3 data-id="heading-10">ç¬¬äºŒæ­¥ï¼šå®šä¹‰éœ€æ±‚æ–¹ (The Consumer)</h3>
<p>æˆ‘ä»¬çš„æ±½è½¦ (<code>Car</code>) éœ€è¦å¼•æ“å’Œè½®å­ã€‚å³è¿™é‡Œå®šä¹‰äº†â€œéœ€æ±‚æ–¹â€ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> engine: Engine, <span class="hljs-comment">// éœ€è¦ Module æä¾›ï¼Œå‘Šè¯‰ Dagger è¿™ä¸ªç±»æ˜¯å¦‚ä½•è·å–çš„</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> wheel: Wheel    <span class="hljs-comment">// Dagger å¯ä»¥ç›´æ¥é€šè¿‡ @Inject æ„é€ ç”Ÿæˆ</span>
) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">drive</span><span class="hljs-params">()</span></span> {
        engine.start()
        wheel.roll()
        println(<span class="hljs-string">"Car is moving!"</span>)
    }
}
</code></pre>
<h3 data-id="heading-11">ç¬¬ä¸‰æ­¥ï¼šåˆ¶ä½œæ¨¡å— (The Module)</h3>
<p>è¿™é‡Œæˆ‘ä»¬å±•ç¤º SystemUI ä¸­æœ€å¸¸è§çš„ Module å†™æ³•ï¼šåŒæ—¶åŒ…å« <code>@Binds</code> å’Œ <code>@Provides</code>ã€‚</p>
<ul>
<li><strong>@Binds (æ¨è)</strong> ï¼šç”¨äºå°†æ¥å£æ˜ å°„åˆ°å®ç°ç±»ã€‚å®ƒå¿…é¡»æ˜¯<strong>æŠ½è±¡æ–¹æ³•</strong>ï¼Œä¸”åœ¨<strong>æŠ½è±¡ç±»</strong>æˆ–æ¥å£ä¸­ã€‚å®ƒçš„æ•ˆç‡æ¯” <code>@Provides</code> æ›´é«˜ï¼Œå› ä¸º Dagger ä¸éœ€è¦å®ä¾‹åŒ– Moduleï¼Œç›´æ¥è°ƒç”¨å®ç°ç±»çš„ Providerã€‚</li>
<li><strong>@Provides</strong>ï¼šç”¨äºéœ€è¦è‡ªå®šä¹‰æ„é€ é€»è¾‘ã€å¼•å…¥ç¬¬ä¸‰æ–¹åº“æˆ–åŸºæœ¬ç±»å‹ï¼ˆå¦‚ String, Contextï¼‰çš„åœºæ™¯ã€‚</li>
</ul>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-meta">@Module</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CarModule</span> {

    <span class="hljs-comment">// ã€é‡ç‚¹ã€‘ä½¿ç”¨ @Binds</span>
    <span class="hljs-comment">// è¯­ä¹‰ï¼šå½“æœ‰äººè¯·æ±‚ Engine æ¥å£æ—¶ï¼Œç»™å®ƒ V8Engine çš„å®ä¾‹ã€‚</span>
    <span class="hljs-comment">// ä¼˜åŠ¿ï¼šç¼–è¯‘æ—¶ä¼˜åŒ–ï¼Œä¸ç”Ÿæˆé¢å¤–çš„å·¥å‚ä»£ç ï¼Œæ€§èƒ½æ›´å¥½ã€‚</span>
    <span class="hljs-meta">@Binds</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bindEngine</span><span class="hljs-params">(impl: <span class="hljs-type">V8Engine</span>)</span></span>: Engine

    <span class="hljs-comment">// ä½¿ç”¨ @Provides (ä¼´ç”Ÿå¯¹è±¡å†™æ³•æ˜¯ SystemUI ä¸­çš„å¸¸è§æ¨¡å¼)</span>
    <span class="hljs-comment">// åœºæ™¯ï¼šå¦‚æœæˆ‘ä»¬éœ€è¦æä¾›ä¸€äº›åŸºæœ¬ç±»å‹é…ç½®ï¼Œæˆ–è€…æ— æ³•ç›´æ¥ @Inject çš„å¯¹è±¡ï¼Œä¾‹å¦‚åœ¨ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹çš„ç±»åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ @Provides æ¥å‘Šè¯‰ Dagger å¦‚ä½•åˆ›å»ºå…·ä½“å¯¹è±¡</span>
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-meta">@Provides</span>
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">provideCarName</span><span class="hljs-params">()</span></span>: String {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"SystemUI Concept Car"</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-12">ç¬¬å››æ­¥ï¼šç»„è£…ç»„ä»¶ (The Component)</h3>
<p>å®šä¹‰è¿æ¥å™¨ï¼Œå‘Šè¯‰ Dagger å°† <code>CarModule</code> çº³å…¥ç‰ˆå›¾ï¼Œå¹¶æä¾›è·å– <code>Car</code> çš„å…¥å£ã€‚éœ€è¦ä½¿ç”¨<code>@Component</code>æŒ‡å®šæœ‰å“ªäº› <code>Module</code> ç±»</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-meta">@Component(modules = [CarModule::class])</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">CarComponent</span> {
    <span class="hljs-comment">// æ–¹å¼ Aï¼šç›´æ¥è·å–å¯¹è±¡</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCar</span><span class="hljs-params">()</span></span>: Car
    
    <span class="hljs-comment">// æ–¹å¼ Bï¼šæ³¨å…¥åˆ°æŸä¸ªå®¹å™¨ä¸­ï¼ˆå¸¸ç”¨äº Activity/Fragmentï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">inject</span><span class="hljs-params">(activity: <span class="hljs-type">MainActivity</span>)</span></span>
}
</code></pre>
<h3 data-id="heading-13">ç¬¬äº”æ­¥ï¼šæœ€ç»ˆè°ƒç”¨</h3>
<p>åœ¨ä»£ç å…¥å£å¤„ï¼ˆç±»ä¼¼äº SystemUI çš„ <code>SystemUIApplication</code>ï¼‰ï¼Œæ„å»ºå›¾è°±å¹¶ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-comment">//è¯·æ±‚ä¾èµ– </span>
    <span class="hljs-meta">@Inject</span>
    Car car;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        
        <span class="hljs-comment">// æ–¹å¼1ï¼šä½¿ç”¨é»˜è®¤Module</span>
        <span class="hljs-type">CarComponent</span> <span class="hljs-variable">component</span> <span class="hljs-operator">=</span> DaggerCarComponent.create();
        
        <span class="hljs-comment">// æ–¹å¼2ï¼šè‡ªå®šä¹‰Moduleï¼ˆæ›´çµæ´»ï¼‰</span>
        <span class="hljs-type">CarComponent</span> <span class="hljs-variable">component2</span> <span class="hljs-operator">=</span> DaggerCarComponent.builder()
            .carModule(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CarModule</span>())
            .ownerModule(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OwnerModule</span>())
            .build();
        
        <span class="hljs-comment">// åœ¨å½“å‰é¡µé¢æ³¨å…¥ä¾èµ–</span>
        component.inject(<span class="hljs-built_in">this</span>);
        
        <span class="hljs-comment">// ç°åœ¨å¯ä»¥ä½¿ç”¨ä¾èµ–äº†</span>
        car.drive();
    }
}
</code></pre>
<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>
<blockquote>
<p>Engine V8 Turbo started</p>
<p>Wheel rolling</p>
<p>Car is moving!</p>
</blockquote>
<h3 data-id="heading-14">å°ç»“</h3>
<p>é€šè¿‡è¿™ä¸ªæç®€ç¤ºä¾‹ï¼Œæˆ‘ä»¬ç¡®ç«‹äº† Component -&gt; Module -&gt; Dependency çš„ä¸‰è§’å…³ç³»ã€‚</p>
<ul>
<li>
<p>@Inject å®šä¹‰ä¾èµ–æˆ–è€…è¯·æ±‚ä¾èµ–</p>
</li>
<li>
<p>@Module å®šä¹‰Moduleç±»ï¼Œç”¨æ¥å‘Šè¯‰ Dagger å¦‚ä½•åˆ›å»ºä¾èµ–</p>
<ul>
<li>@Binds ç”¨äºæ¥å£ä¸å®ç°ç±»è¿›è¡Œç»‘å®š</li>
<li>@Provides ä¸€èˆ¬ç”¨äºæ— æ³•åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨@Injectçš„ä¾èµ–ï¼Œä¾‹å¦‚å¼•ç”¨ä¸‰æ–¹ç±»åº“çš„ä¾èµ–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨</li>
</ul>
</li>
<li>
<p>@Component ç”¨äºç»„è£…ç»„ä»¶ï¼Œå‘Šè¯‰ Dagger æœ‰å“ªäº› Module ç±»</p>
</li>
</ul>
<h2 data-id="heading-15">0x04. Hilt çš„å´›èµ·ï¼šåº”ç”¨å¼€å‘çš„åˆ©å™¨</h2>
<p>åœ¨ç°ä»£ Android å¼€å‘ä¸­ï¼ŒGoogle å¼ºçƒˆæ¨èä½¿ç”¨ <strong>Hilt</strong>ã€‚å®ƒæ˜¯å»ºç«‹åœ¨ Dagger2 ä¹‹ä¸Šçš„ä¸€å±‚å°è£…åº“ã€‚å¯¹äºæ™®é€š App å¼€å‘è€…ï¼ŒHilt æ˜¯æ•‘æ˜Ÿï¼Œä½†å¯¹äº SystemUI å·¥ç¨‹å¸ˆï¼Œå®ƒæ˜¯â€œå¦ä¸€ä¸ªä¸–ç•Œçš„äº§ç‰©â€ã€‚</p>
<h3 data-id="heading-16">4.1 ä¸ºä»€ä¹ˆè¦ç”¨ Hiltï¼Ÿ</h3>
<p>åŸç”Ÿ Dagger2 åŠŸèƒ½å¼ºå¤§ï¼Œä½†æœ‰ä¸€ä¸ªè‡´å‘½ç—›ç‚¹ï¼š<strong>æ ·æ¿ä»£ç è¿‡å¤šä¸”éš¾ä»¥æ ‡å‡†åŒ–</strong>ã€‚ä½ éœ€è¦æ‰‹åŠ¨å®šä¹‰ Componentï¼Œæ‰‹åŠ¨åœ¨ Application ä¸­å®ä¾‹åŒ–å®ƒï¼Œå†æ‰‹åŠ¨å†™ <code>inject()</code> æ–¹æ³•ã€‚å¯¹äºä¸“æ³¨ä¸šåŠ¡çš„åº”ç”¨å¼€å‘è€…æ¥è¯´ä¸Šæ‰‹éš¾åº¦æ˜¯æ¯”è¾ƒå¤§çš„ã€‚</p>
<p>Hilt çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒæä¾›äº†ä¸€å¥— <strong>â€œæ ‡å‡†åŒ–çš„ç»„ä»¶å±‚çº§â€</strong>ã€‚</p>
<p><strong>Hilt çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šé¢„å®šä¹‰å¥½äº† <code>SingletonComponent</code>, <code>ActivityComponent</code>, <code>ViewModelComponent</code> ç­‰æ ‡å‡†å®¹å™¨ã€‚</li>
<li><strong>è‡ªåŠ¨æ³¨å…¥</strong>ï¼šä½ ä¸å†éœ€è¦å†™ <code>component.inject(this)</code>ï¼Œåªéœ€ä¸€ä¸ªæ³¨è§£ã€‚</li>
</ul>
<p><strong>Hilt çš„æ ¸å¿ƒæ³¨è§£ï¼š</strong></p>
<h4 data-id="heading-17">@HiltAndroidAppï¼šåº”ç”¨å…¥å£ç‚¹</h4>
<ul>
<li><strong>è§’è‰²</strong>ï¼šæ ‡è®°åœ¨ <strong>Application</strong> ç±»ä¸Šã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå®ƒè§¦å‘äº† Hilt çš„ä»£ç ç”Ÿæˆè¿‡ç¨‹ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªç»§æ‰¿è‡ªè¯¥ Application çš„åŸºç±»ï¼Œå¹¶è‡ªåŠ¨åˆ›å»ºå’Œé…ç½®åº”ç”¨çš„ <strong>æ ¹ç»„ä»¶</strong>ï¼ˆå³ Dagger2 ä¸­çš„ <code>AppComponent</code>ï¼‰ï¼ŒHilt ç§°ä¹‹ä¸º <strong><code>SingletonComponent</code></strong>ã€‚æ­¤ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸ Application è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸä¸€è‡´ã€‚</li>
</ul>
<h4 data-id="heading-18">@AndroidEntryPointï¼šå¼€å¯æ³¨å…¥å¤§é—¨</h4>
<ul>
<li><strong>è§’è‰²</strong>ï¼šæ ‡è®°åœ¨ä»»ä½•æ ‡å‡† Android ç»„ä»¶ï¼ˆ<code>Activity</code>, <code>Fragment</code>, <code>Service</code>, <code>View</code>, <code>BroadcastReceiver</code>ï¼‰ä¸Šã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå‘Šè¯‰ Hiltï¼Œè¯¥ç»„ä»¶çš„å®ä¾‹éœ€è¦è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚åœ¨ç¼–è¯‘æ—¶ï¼ŒHilt ä¼šç”Ÿæˆä¸€ä¸ªä¸è¯¥ç»„ä»¶å…³è”çš„ Dagger Componentï¼ˆå¦‚ <code>ActivityComponent</code> æˆ– <code>FragmentComponent</code>ï¼‰ï¼Œå¹¶è‡ªåŠ¨è°ƒç”¨æ³¨å…¥æ–¹æ³•ï¼ˆå‘Šåˆ«æ‰‹åŠ¨ <code>component.inject(this)</code>ï¼‰</li>
</ul>
<h4 data-id="heading-19">@InstallInï¼šå®šä¹‰ä½œç”¨åŸŸè¾¹ç•Œ</h4>
<ul>
<li><strong>è§’è‰²</strong>ï¼šæ ‡è®°åœ¨ <code>@Module</code> ä¸Šã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå¼ºåˆ¶å®šä¹‰è¯¥ Module ä¸­çš„ä¾èµ–ï¼ˆ<code>@Provides</code> æˆ– <code>@Binds</code> æ–¹æ³•ï¼‰å°†<strong>å®‰è£…</strong>åˆ°å“ªä¸ªé¢„å®šä¹‰çš„ Hilt Component ä¸­ã€‚è¿™æ˜¯å®ç°ä½œç”¨åŸŸç®¡ç†çš„å…³é”®ã€‚</li>
</ul>
<h4 data-id="heading-20">@HiltViewModelï¼šJetpack ViewModel ä¸“ç”¨</h4>
<ul>
<li><strong>è§’è‰²</strong>ï¼šæ ‡è®°åœ¨ <code>ViewModel</code> å­ç±»ä¸Šã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå…è®¸ Hilt è‡ªåŠ¨æ³¨å…¥ <code>ViewModel</code> çš„æ„é€ å‡½æ•°ä¾èµ–ï¼Œå¹¶ç¡®ä¿ <code>ViewModel</code> èƒ½å¤Ÿä»æ­£ç¡®çš„ Componentï¼ˆé€šå¸¸æ˜¯ <code>ActivityRetainedComponent</code> æˆ– <code>FragmentComponent</code>ï¼‰ä¸­è·å–ä¾èµ–</li>
</ul>
<p>Hilt ä»£ç æç®€ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// 1. åœ¨Applicationç±»æ·»åŠ  @HiltApplication æ³¨è§£</span>
<span class="hljs-meta">@HiltApplication</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {

}

<span class="hljs-comment">// 2. åªéœ€è¦åŠ ä¸Š @AndroidEntryPointï¼ŒHilt è‡ªåŠ¨å¤„ç†æ³¨å…¥é€»è¾‘</span>
<span class="hljs-meta">@AndroidEntryPoint</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> car: Car <span class="hljs-comment">// ç›´æ¥å¯ç”¨</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        car.drive()
    }
}

<span class="hljs-comment">// 3. éœ€è¦å‘Šè¯‰ Hilt æŠŠè¿™ä¸ª Module å®‰è£…åˆ°å“ªä¸ªæ ‡å‡†å®¹å™¨é‡Œ</span>
<span class="hljs-meta">@Module</span>
<span class="hljs-meta">@InstallIn(SingletonComponent::class)</span> <span class="hljs-comment">// &lt;--- Hilt ç‹¬æœ‰ï¼šæŒ‡å®šå®‰è£…ä½ç½®</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CarModule</span> {
    <span class="hljs-meta">@Binds</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bindEngine</span><span class="hljs-params">(impl: <span class="hljs-type">V8Engine</span>)</span></span>: Engine
}
</code></pre>
<h3 data-id="heading-21">4.2 Dagger vs. Hiltï¼šæœ¬è´¨åŒºåˆ«</h3>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Dagger 2 (åŸç”Ÿ)</strong></th><th><strong>Hilt</strong></th></tr></thead><tbody><tr><td><strong>å®šä½</strong></td><td>é€šç”¨ Java/Kotlin ä¾èµ–æ³¨å…¥æ¡†æ¶</td><td>ä¸“ä¸º Android ä¼˜åŒ–çš„ Dagger å°è£…</td></tr><tr><td><strong>Component</strong></td><td><strong>æ‰‹åŠ¨å®šä¹‰</strong>ï¼šä½ éœ€è¦è‡ªå·±å†™ Interfaceï¼Œè‡ªå·±å†³å®šå±‚çº§å…³ç³»</td><td><strong>é¢„å®šä¹‰</strong>ï¼šæä¾›æ ‡å‡† Android ç”Ÿå‘½å‘¨æœŸç»„ä»¶ (Application, Activity, Fragment)</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td><strong>æé«˜</strong>ï¼šä½ å¯ä»¥æ„å»ºä»»æ„å½¢çŠ¶çš„ä¾èµ–å›¾</td><td><strong>å—é™</strong>ï¼šå¼ºåˆ¶éµå¾ª Hilt çš„æ ‡å‡†å±‚çº§ç»“æ„</td></tr><tr><td><strong>ä¸Šæ‰‹éš¾åº¦</strong></td><td>é«˜ (é™¡å³­çš„å­¦ä¹ æ›²çº¿)</td><td>ä½ (æ³¨è§£é©±åŠ¨ï¼Œå‚»ç“œå¼)</td></tr></tbody></table>
<h3 data-id="heading-22">4.3 çµé­‚æ‹·é—®ï¼šä¸ºä»€ä¹ˆ SystemUI ä¸ä½¿ç”¨ Hiltï¼Ÿ</h3>
<p>æ—¢ç„¶ Hilt è¿™ä¹ˆå¥½ç”¨ï¼Œä¸ºä»€ä¹ˆä½œä¸º Google äº²å„¿å­çš„ SystemUI ä¾ç„¶åšæŒä½¿ç”¨åŸç”Ÿ Dagger2ï¼Œç”šè‡³å†™äº†å¤§é‡çš„æ ·æ¿ä»£ç ï¼Ÿ</p>
<p>è¿™æ˜¯é˜…è¯»æºç æ—¶å¿…é¡»ç†è§£çš„<strong>æ¶æ„èƒŒæ™¯</strong>ï¼š</p>
<ol>
<li>
<p><strong>å†å²åŒ…è¢±ä¸è¿ç§»æˆæœ¬</strong> SystemUI çš„ä»£ç åº“å†å²è¿œæ—©äº Hilt çš„è¯ç”Ÿã€‚å®ƒæ‹¥æœ‰æ•°ä»¥åƒè®¡çš„ç±»å’Œåºå¤§çš„ä¾èµ–å›¾è°±ã€‚å°†è¿™æ ·ä¸€ä¸ªå·¨å‹å•ä½“æ¶æ„è¿ç§»åˆ° Hiltï¼Œä¸ä»…å·¥ä½œé‡å·¨å¤§ï¼Œè€Œä¸”é£é™©æé«˜ã€‚SystemUI ç›®å‰ä»å¤„äºä»æ—§çš„ <code>Dependency.get(Class)</code> é™æ€æŸ¥æ‰¾æ¨¡å¼å‘ Dagger è¿ç§»çš„è¿‡ç¨‹ä¸­ï¼Œå¼•å…¥ Hilt ä¼šå¢åŠ é¢å¤–çš„å¤æ‚åº¦ã€‚</p>
</li>
<li>
<p><strong>éæ ‡å‡†çš„ç”Ÿå‘½å‘¨æœŸä¸ä¸Šä¸‹æ–‡</strong> Hilt æ˜¯ä¸º<strong>æ ‡å‡† Android App</strong> è®¾è®¡çš„ï¼Œå®ƒå‡è®¾ä½ çš„ä¸–ç•Œç”± <code>Application</code> -&gt; <code>Activity</code> -&gt; <code>Fragment</code> ç»„æˆã€‚ ä½† SystemUI <strong>ä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„ App</strong>ã€‚å®ƒåŒ…å«ï¼š</p>
<ul>
<li><strong>DreamService</strong> (å±ä¿)</li>
<li><strong>Keyguard</strong> (é”å±ï¼Œç‹¬ç«‹äº Activity ç”Ÿå‘½å‘¨æœŸ)</li>
<li><strong>Quick Settings Tiles</strong> (å¿«æ·è®¾ç½®ç£è´´)</li>
<li><strong>SystemUI Process</strong> (å¸¸é©»ç³»ç»Ÿè¿›ç¨‹) è¿™äº›ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸéå¸¸ç‰¹æ®Šï¼ŒHilt é¢„å®šä¹‰çš„ <code>ActivityComponent</code> æˆ– <code>FragmentComponent</code> å¾ˆéš¾å®Œç¾è¦†ç›– SystemUI ä¸­åƒå¥‡ç™¾æ€ªçš„çª—å£å’ŒæœåŠ¡çš„éœ€æ±‚ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¤šç”¨æˆ·æ¶æ„ (Multi-User Support)</strong> è¿™æ˜¯æœ€å…³é”®çš„æŠ€æœ¯åŸå› ã€‚SystemUI å¿…é¡»åœ¨è®¾å¤‡å±‚é¢ï¼ˆGlobalï¼‰å’Œç”¨æˆ·å±‚é¢ï¼ˆUser-Specificï¼‰ä¹‹é—´æœ‰ä¸¥æ ¼çš„ç•Œé™ã€‚</p>
<ul>
<li>å½“ä½ åœ¨ Android ä¸Šé€šè¿‡â€œå¤šç”¨æˆ·â€åŠŸèƒ½åˆ‡æ¢ç”¨æˆ·æ—¶ï¼ŒSystemUI çš„ä¸€éƒ¨åˆ†ç»„ä»¶å¿…é¡»ä¿æŒä¸å˜ï¼ˆå¦‚çŠ¶æ€æ å›¾æ ‡ç®¡ç†ï¼‰ï¼Œè€Œå¦ä¸€éƒ¨åˆ†å¿…é¡»é”€æ¯å¹¶é‡å»ºï¼ˆå¦‚ä¸å½“å‰ç”¨æˆ·è®¾ç½®ç»‘å®šçš„ç»„ä»¶ï¼‰ã€‚</li>
<li>SystemUI ä½¿ç”¨åŸç”Ÿ Dagger çš„ <code>@Subcomponent</code> æ‰‹åŠ¨æ„å»ºäº†å¤æ‚çš„ <strong>UserScope</strong> æœºåˆ¶ã€‚åŸç”Ÿ Dagger å…è®¸å¼€å‘è€…ç²¾ç¡®æ§åˆ¶ä½•æ—¶åˆ›å»ºå­å›¾ã€ä½•æ—¶é”€æ¯å­å›¾ã€‚è€Œ Hilt çš„è‡ªåŠ¨åŒ–æœºåˆ¶åœ¨å¤„ç†è¿™ç§â€œç³»ç»Ÿçº§ç”¨æˆ·åˆ‡æ¢â€çš„åŠ¨æ€å›¾è°±æ—¶ï¼Œæ˜¾å¾—ä¸å¤Ÿçµæ´»ä¸”éš¾ä»¥æ§åˆ¶ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-23">4.4 <strong>ç»“è®º</strong></h3>
<p>SystemUI é€‰æ‹©åŸç”Ÿ Dagger2ï¼Œæ˜¯å› ä¸ºå®ƒéœ€è¦<strong>ç»å¯¹çš„æ§åˆ¶æƒ</strong>ã€‚å®ƒéœ€è¦æ ¹æ®ç³»ç»Ÿç‰¹æœ‰çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ User Switch, Boot Completeï¼‰æ¥æ‰‹åŠ¨ç®¡ç†ä¾èµ–å›¾è°±çš„æ„å»ºä¸é”€æ¯ï¼Œè¿™æ˜¯ä¸ºäº†ç³»ç»Ÿç¨³å®šæ€§æ‰€åšçš„å¿…è¦æƒè¡¡ã€‚</p>
<p>åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç¦»å¼€èˆ’é€‚åŒºï¼Œè¿›å…¥ SystemUI çš„åºå¤§ä»£ç åº“ï¼Œçœ‹çœ‹ Google å·¥ç¨‹å¸ˆæ˜¯å¦‚ä½•åˆ©ç”¨è¿™äº›åŸºç¡€ç§¯æœ¨ï¼Œæ­å»ºèµ·ç®¡ç† Android ç³»ç»Ÿçš„æ‘©å¤©å¤§æ¥¼çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[FluxImageLoader : åŸºäºCoil3å°è£…çš„ Android å›¾ç‰‡åŠ è½½åº“ï¼Œæ—¨åœ¨æä¾›ç®€å•ã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„å›¾ç‰‡åŠ è½½è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7581270148046356520</link>    <guid>https://juejin.cn/post/7581270148046356520</guid>    <pubDate>2025-12-08T10:33:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581270148046356520" data-draft-id="7581299982670692386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="FluxImageLoader : åŸºäºCoil3å°è£…çš„ Android å›¾ç‰‡åŠ è½½åº“ï¼Œæ—¨åœ¨æä¾›ç®€å•ã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„å›¾ç‰‡åŠ è½½è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-08T10:33:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Nerve"/> <meta itemprop="url" content="https://juejin.cn/user/3438928101639512"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            FluxImageLoader : åŸºäºCoil3å°è£…çš„ Android å›¾ç‰‡åŠ è½½åº“ï¼Œæ—¨åœ¨æä¾›ç®€å•ã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„å›¾ç‰‡åŠ è½½è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3438928101639512/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Nerve
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:33:32.000Z" title="Mon Dec 08 2025 10:33:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17ce8903392a42e2b9f32bb3f86bc516~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmVydmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794812&amp;x-signature=EGo%2B7ZnrEicWrTIiiu97g%2FEDggA%3D" alt="ScreenShot_2025-12-08_180655_892.png" loading="lazy"/></p>
<h2 data-id="heading-0">FluxImageLoader</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopensource.org%2Flicenses%2FApache-2.0" target="_blank" title="https://opensource.org/licenses/Apache-2.0" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/228aa39a27be4d36aa5a5d01da7bf552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmVydmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794812&amp;x-signature=XuH5o0kA0l6iLeSkgEo0AvAG9%2Bw%3D" alt="License" loading="lazy"/></a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fjitpack.io%2F%23darryrzhong%2FFluxImageLoader" target="_blank" title="https://jitpack.io/#darryrzhong/FluxImageLoader" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daff64ef7c184093874f2252931cc1be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmVydmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794812&amp;x-signature=ing%2Bb7dnPJmhAxPPs5oGIkThr30%3D" alt="" loading="lazy"/></a></p>
<p>FluxImageLoader æ˜¯ä¸€ä¸ªåŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fcoil-kt.github.io%2Fcoil%2F" target="_blank" title="https://coil-kt.github.io/coil/" ref="nofollow noopener noreferrer">Coil3</a> + <a href="https://link.juejin.cn?target=https%3A%2F%2Fsquare.github.io%2Fokhttp%2F" target="_blank" title="https://square.github.io/okhttp/" ref="nofollow noopener noreferrer">OkHttp</a> å°è£…çš„ Android å›¾ç‰‡åŠ è½½åº“ï¼Œæ—¨åœ¨æä¾›ç®€å•ã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„å›¾ç‰‡åŠ è½½è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdarryrzhong%2FFluxImageLoader" target="_blank" title="https://github.com/darryrzhong/FluxImageLoader" ref="nofollow noopener noreferrer">GitHub</a></h2>
<h3 data-id="heading-2">åŠŸèƒ½ç‰¹æ€§</h3>
<ul>
<li><strong>åŸºäº Coil3</strong>: äº«å— Coil3 å¸¦æ¥çš„ç°ä»£ kotlinå›¾ç‰‡åŠ è½½ä½“éªŒã€‚</li>
<li><strong>å¤šæ ¼å¼æ”¯æŒ</strong>: æ”¯æŒå¸¸è§å›¾ç‰‡æ ¼å¼ä»¥åŠ GIFã€WebP åŠ¨å›¾ã€SVGã€è§†é¢‘å¸§è§£ç ã€‚</li>
<li><strong>è‡ªå®šä¹‰é…ç½®</strong>: æ”¯æŒè‡ªå®šä¹‰å†…å­˜ç¼“å­˜ã€ç£ç›˜ç¼“å­˜å¤§å°åŠè·¯å¾„ã€‚</li>
<li><strong>ä¸°å¯Œå˜æ¢</strong>: å†…ç½®åœ†å½¢ã€åœ†è§’ã€é«˜æ–¯æ¨¡ç³Šç­‰å¸¸ç”¨å›¾ç‰‡å˜æ¢ã€‚</li>
<li><strong>é¢„åŠ è½½/ä¸‹è½½</strong>: æ”¯æŒå›¾ç‰‡é¢„åŠ è½½åˆ°å†…å­˜æˆ–ä»…ä¸‹è½½åˆ°ç£ç›˜ã€‚</li>
<li><strong>Javaå…¼å®¹</strong>: æä¾› <code>FluxLoader</code> å·¥å…·ç±»ï¼Œå®Œç¾å…¼å®¹ Java è°ƒç”¨ã€‚</li>
</ul>
<h3 data-id="heading-3">æ¥å…¥æŒ‡å—</h3>
<p>æœ¬æ–‡æ¡£æä¾›äº†å°† GalleryPicker åº“é›†æˆåˆ°æ‚¨çš„ Android åº”ç”¨ç¨‹åºä¸­çš„è¯¦ç»†æŒ‡å—ã€‚</p>
<h4 data-id="heading-4">1. æ·»åŠ ä¾èµ–</h4>
<p>åœ¨æ‚¨çš„é¡¹ç›® <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ  JitPack ä»“åº“å’Œä¾èµ–é¡¹ã€‚</p>
<p><strong>æ ¹ç›®å½• <code>build.gradle</code>:</strong></p>
<pre><code class="hljs language-gradle" lang="gradle">allprojects {
    repositories {
        ...
        maven { url 'https://jitpack.io' }
    }
}
</code></pre>
<p><strong>App æ¨¡å— <code>build.gradle</code>:</strong></p>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation 'com.github.darryrzhong:FluxImageLoader:1.0.0' // è¯·æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬
}
</code></pre>
<h3 data-id="heading-5">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-6">1. åˆå§‹åŒ–</h4>
<p>åœ¨ Application çš„ <code>onCreate</code> æ–¹æ³•ä¸­è¿›è¡Œåˆå§‹åŒ–é…ç½®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.FluxImageLoader

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        
        <span class="hljs-comment">// åˆå§‹åŒ–é…ç½®</span>
        FluxImageLoader.getInstance()
            .setMaxMemorySizePercent(<span class="hljs-number">0.25</span>) <span class="hljs-comment">// æœ€å¤§å†…å­˜ç¼“å­˜æ¯”ä¾‹ (Appå¯ç”¨å†…å­˜ç™¾åˆ†æ¯”)</span>
            .setMaxDiskSizePercent(<span class="hljs-number">0.02</span>)   <span class="hljs-comment">// æœ€å¤§ç£ç›˜ç¼“å­˜æ¯”ä¾‹ (ç”¨æˆ·å¯ç”¨ç£ç›˜ç™¾åˆ†æ¯”)</span>
            .setDiskCacheFileName(<span class="hljs-string">"coil_image_cache"</span>) <span class="hljs-comment">// ç£ç›˜ç¼“å­˜ç›®å½•åç§°</span>
            .debug(BuildConfig.DEBUG)      <span class="hljs-comment">// å¼€å¯è°ƒè¯•æ—¥å¿—</span>
            .<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>)
    }
}
</code></pre>
<h4 data-id="heading-7">2. æ”¯æŒçš„æ ¼å¼</h4>
<ul>
<li><strong>é™æ€å›¾ç‰‡</strong>: BMP, JPEG, PNG, WebP, HEIF (Android 8.0+)</li>
<li><strong>åŠ¨å›¾</strong>: GIF, WebP (Android 9.0+), HEIF (Android 11.0+)</li>
<li><strong>SVG</strong>: æ”¯æŒ SVG æ ¼å¼è§£ç </li>
<li><strong>è§†é¢‘</strong>: æ”¯æŒåŠ è½½è§†é¢‘æ–‡ä»¶çš„ç¬¬ä¸€å¸§æˆ–æŒ‡å®šå¸§</li>
</ul>
<p align="center">
  <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f070ecb1000c4370a1e59d1bfa96f8b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmVydmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794812&amp;x-signature=8Zg%2F3ktYlWWlfpyWkKLqvUOhfvM%3D" alt="pickerè½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" width="206" height="443" loading="lazy"/>
</p>
<h3 data-id="heading-8">ä½¿ç”¨æŒ‡å— (Kotlin)</h3>
<p>æ¨èä½¿ç”¨ Kotlin æ‰©å±•æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œç®€æ´é«˜æ•ˆã€‚</p>
<h4 data-id="heading-9">åŸºç¡€åŠ è½½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.load

<span class="hljs-comment">// åŠ è½½ç½‘ç»œå›¾ç‰‡</span>
imageView.load(<span class="hljs-string">"https://www.example.com/image.jpg"</span>)

<span class="hljs-comment">// åŠ è½½æœ¬åœ°æ–‡ä»¶</span>
imageView.load(File(<span class="hljs-string">"/path/to/image.jpg"</span>))

<span class="hljs-comment">// åŠ è½½èµ„æºID</span>
imageView.load(R.drawable.ic_launcher)

<span class="hljs-comment">// è®¾ç½®å ä½å›¾ (é»˜è®¤ä½¿ç”¨å†…ç½®å ä½å›¾ï¼Œä¼  0 æˆ–ä¸ä¼ ä½¿ç”¨é»˜è®¤)</span>
imageView.load(url, placeholder = R.drawable.custom_placeholder)
</code></pre>
<h4 data-id="heading-10">å›¾ç‰‡å˜æ¢</h4>
<h5 data-id="heading-11">åœ†å½¢å›¾ç‰‡</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.loadCircle

imageView.loadCircle(url)
</code></pre>
<h5 data-id="heading-12">åœ†è§’å›¾ç‰‡</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.loadRounded
<span class="hljs-keyword">import</span> com.flux.img.transform.RoundedCornersType
<span class="hljs-keyword">import</span> com.flux.loader.dp <span class="hljs-comment">// å‡è®¾ä½ æœ‰ dp æ‰©å±•ï¼Œæˆ–è€…ç›´æ¥ä¼  px å€¼</span>

<span class="hljs-comment">// ç»Ÿä¸€åœ†è§’</span>
imageView.loadRounded(url, radius = <span class="hljs-number">20f</span>)

<span class="hljs-comment">// æŒ‡å®šåœ†è§’ä½ç½® (ä¾‹å¦‚ï¼šå·¦ä¸Šå’Œå³ä¸Š)</span>
imageView.loadRounded(url, radius = <span class="hljs-number">20f</span>, cornersType = RoundedCornersType.TOP)
</code></pre>
<h5 data-id="heading-13">é«˜æ–¯æ¨¡ç³Š</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.loadBlur

<span class="hljs-comment">// åŸºç¡€é«˜æ–¯æ¨¡ç³Š (é»˜è®¤æ¨¡ç³ŠåŠå¾„ 10f)</span>
imageView.loadBlur(url)

<span class="hljs-comment">// è‡ªå®šä¹‰æ¨¡ç³ŠåŠå¾„å’Œåœ†è§’</span>
<span class="hljs-comment">// radius &gt; 0: åœ†è§’æ¨¡ç³Š</span>
<span class="hljs-comment">// radius &lt; 0: åœ†å½¢æ¨¡ç³Š (-1f)</span>
imageView.loadBlur(url, blurRadius = <span class="hljs-number">15f</span>, radius = <span class="hljs-number">20f</span>)
</code></pre>
<h4 data-id="heading-14">åŠ¨å›¾åŠ è½½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.loadWebpAnim
<span class="hljs-keyword">import</span> com.flux.img.loadGif

<span class="hljs-comment">// åŠ è½½ WebP åŠ¨å›¾ (Android 9.0+ ä½¿ç”¨ Coilï¼Œ9.0ä»¥ä¸‹è‡ªåŠ¨é™çº§ä½¿ç”¨ Glide)</span>
imageView.loadWebpAnim(<span class="hljs-string">"https://www.example.com/anim.webp"</span>)

<span class="hljs-comment">// åŠ è½½ GIF</span>
imageView.loadGif(<span class="hljs-string">"https://www.example.com/anim.gif"</span>)
</code></pre>
<h4 data-id="heading-15">è·å– Bitmap / Drawable</h4>
<p>å½“ä¸éœ€è¦ç›´æ¥æ˜¾ç¤ºåœ¨ ImageView æ—¶ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.loadBitmap
<span class="hljs-keyword">import</span> com.flux.img.loadDrawable
<span class="hljs-keyword">import</span> com.flux.img.listener.LoadListener

<span class="hljs-comment">// è·å– Bitmap</span>
imageView.loadBitmap(url, <span class="hljs-keyword">object</span> : LoadListener&lt;Bitmap&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">Bitmap</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç† Bitmap</span>
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(throwable: <span class="hljs-type">Throwable</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç†é”™è¯¯</span>
    }
    <span class="hljs-comment">// å¯é€‰: onStart(), onCancel()</span>
})

<span class="hljs-comment">// è·å– Drawable</span>
imageView.loadDrawable(url, <span class="hljs-keyword">object</span> : LoadListener&lt;Drawable&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">Drawable</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç† Drawable</span>
    }
    <span class="hljs-comment">// ...</span>
})
</code></pre>
<h4 data-id="heading-16">é¢„åŠ è½½ä¸ä¸‹è½½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.flux.img.preload
<span class="hljs-keyword">import</span> com.flux.img.preDownload

<span class="hljs-comment">// é¢„åŠ è½½åˆ°å†…å­˜ (å®ç°ç§’å¼€)</span>
preload(url, context)

<span class="hljs-comment">// é¢„ä¸‹è½½åˆ°ç£ç›˜ (ä¸è§£ç è¿›å†…å­˜ï¼Œé€‚åˆå¹¿å‘Šå›¾ç­‰)</span>
preDownload(url, context, <span class="hljs-keyword">object</span> : LoadListener&lt;<span class="hljs-built_in">Unit</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-comment">// ä¸‹è½½å®Œæˆ</span>
    }
})
</code></pre>
<h3 data-id="heading-17">ä½¿ç”¨æŒ‡å— (Java)</h3>
<p>Java ä»£ç è¯·ä½¿ç”¨ <code>FluxLoader</code> é™æ€æ–¹æ³•è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.flux.img.FluxLoader;

<span class="hljs-comment">// åŸºç¡€åŠ è½½</span>
FluxLoader.load(imageView, url);
FluxLoader.load(imageView, url, R.drawable.placeholder);

<span class="hljs-comment">// åœ†å½¢</span>
FluxLoader.loadCircle(imageView, url);

<span class="hljs-comment">// åœ†è§’</span>
FluxLoader.loadRounded(imageView, url, <span class="hljs-number">20f</span>);

<span class="hljs-comment">// é«˜æ–¯æ¨¡ç³Š</span>
FluxLoader.loadBlur(imageView, url);

<span class="hljs-comment">// é¢„åŠ è½½</span>
FluxLoader.preload(url, context);
</code></pre>
<h3 data-id="heading-18">èµ„æºé‡Šæ”¾</h3>
<p>Coil ä¼šè‡ªåŠ¨ç®¡ç†èµ„æºé‡Šæ”¾ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨å–æ¶ˆè¯·æ±‚ï¼š</p>
<ul>
<li>View æ‰€åœ¨çš„ Lifecycle è¿›å…¥ DESTROYED çŠ¶æ€</li>
<li>View è¢«è§£ç»‘ (Detached)</li>
</ul>
<p>æ‰‹åŠ¨å–æ¶ˆè¯·æ±‚ (ä»… Kotlin æ‰©å±•æ”¯æŒè¿”å› Disposable):</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> disposable = imageView.load(url)
disposable.dispose()
</code></pre>
<h4 data-id="heading-19">ç¼“å­˜æ¸…ç†</h4>
<p><code>FluxImageLoader</code> æä¾›äº†æ‰‹åŠ¨ç®¡ç†ç¼“å­˜çš„æ–¹æ³•ï¼Œå»ºè®®åœ¨ <code>Application</code> çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒä¸­åˆç†è°ƒç”¨ä»¥ä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ¸…é™¤å†…å­˜ç¼“å­˜ (å»ºè®®åœ¨ onLowMemory ä¸­è°ƒç”¨)</span>
FluxImageLoader.getInstance().clearMemoryCache(context)

<span class="hljs-comment">// æ¸…é™¤ç£ç›˜ç¼“å­˜</span>
FluxImageLoader.getInstance().clearDiskCache(context)

<span class="hljs-comment">// æ•´ç†å†…å­˜ç¼“å­˜ (å»ºè®®åœ¨ onTrimMemory ä¸­è°ƒç”¨)</span>
FluxImageLoader.getInstance().trimMemoryCache(context)
</code></pre>
<p>ç¤ºä¾‹ (åœ¨ Application ä¸­):</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLowMemory</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">super</span>.onLowMemory()
    <span class="hljs-comment">// ç³»ç»Ÿå†…å­˜ç´§å¼ ï¼Œç«‹å³æ¸…ç†å†…å­˜ç¼“å­˜</span>
    FluxImageLoader.getInstance().clearMemoryCache(<span class="hljs-keyword">this</span>)
}

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTrimMemory</span><span class="hljs-params">(level: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onTrimMemory(level)
    <span class="hljs-keyword">when</span> (level) {
        <span class="hljs-comment">// App åˆ‡åˆ°åå°ï¼ŒUI ä¸å¯è§ || åå° App å†…å­˜ä½</span>
        ComponentCallbacks2.TRIM_MEMORY_UI_HIDDEN, ComponentCallbacks2.TRIM_MEMORY_BACKGROUND -&gt; {
            FluxImageLoader.getInstance().trimMemoryCache(<span class="hljs-keyword">this</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-20">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li><code>@DrawableRes</code> èµ„æºå»ºè®®ç›´æ¥ä½¿ç”¨ <code>setImageResource</code>ï¼Œä½¿ç”¨åŠ è½½å™¨ä¼šäº§ç”Ÿä¸å¿…è¦çš„å¼€é”€ï¼Œé™¤ééœ€è¦åšå›¾ç‰‡å˜æ¢ã€‚</li>
<li>é«˜æ–¯æ¨¡ç³ŠåŠå¾„å¿…é¡»åœ¨ 0-25 ä¹‹é—´ã€‚</li>
<li>ç”±äºCoil3åº“ä»…æ”¯æŒåœ¨ Android API 28 ä»¥ä¸ŠåŠ è½½åŠ¨æ€ WebP å›¾ç‰‡,å¦‚æœéœ€è¦åœ¨ Android API 28 ä»¥ä¸‹åŠ è½½åŠ¨æ€ WebP å›¾ç‰‡ï¼Œè¯·è‡ªè¡Œä¾èµ– Glide åŠå…¶ WebP è§£ç åº“ã€‚</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin">def GLIDE_VERSION = <span class="hljs-string">"5.0.5"</span>
<span class="hljs-comment">// webpdecoder</span>
implementation <span class="hljs-string">"com.github.zjupure:webpdecoder:2.7.4.16.0"</span>
<span class="hljs-comment">// glide 4.10.0+</span>
implementation <span class="hljs-string">"com.github.bumptech.glide:glide:<span class="hljs-subst">${GLIDE_VERSION}</span>"</span>
kapt <span class="hljs-string">"com.github.bumptech.glide:compiler:<span class="hljs-subst">${GLIDE_VERSION}</span>"</span>
</code></pre>
<h3 data-id="heading-21">Proguard</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">-keep <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">com</span>.<span class="hljs-title">bumptech</span>.<span class="hljs-title">glide</span>.<span class="hljs-title">integration</span>.<span class="hljs-title">webp</span>.<span class="hljs-title">WebpImage</span> { *; }
-keep <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">com</span>.<span class="hljs-title">bumptech</span>.<span class="hljs-title">glide</span>.<span class="hljs-title">integration</span>.<span class="hljs-title">webp</span>.<span class="hljs-title">WebpFrame</span> { *; }
-keep <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">com</span>.<span class="hljs-title">bumptech</span>.<span class="hljs-title">glide</span>.<span class="hljs-title">integration</span>.<span class="hljs-title">webp</span>.<span class="hljs-title">WebpBitmapFactory</span> { *; }

-keep <span class="hljs-keyword">class</span> <span class="hljs-title class_">coil3</span>.<span class="hljs-title">util</span>.<span class="hljs-title">DecoderServiceLoaderTarget</span> { *; }
-keep <span class="hljs-keyword">class</span> <span class="hljs-title class_">coil3</span>.<span class="hljs-title">util</span>.<span class="hljs-title">FetcherServiceLoaderTarget</span> { *; }
-keep <span class="hljs-keyword">class</span> <span class="hljs-title class_">coil3</span>.<span class="hljs-title">util</span>.<span class="hljs-title">ServiceLoaderComponentRegistry</span> { *; }
-keep <span class="hljs-keyword">class</span> * implements coil3.util.DecoderServiceLoaderTarget { *; }
-keep <span class="hljs-keyword">class</span> * implements coil3.util.FetcherServiceLoaderTarget { *; }
</code></pre>
<h3 data-id="heading-22">Acknowledgments</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcoil-kt.github.io%2Fcoil%2F" target="_blank" title="https://coil-kt.github.io/coil/" ref="nofollow noopener noreferrer">Coil3</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbumptech%2Fglide" target="_blank" title="https://github.com/bumptech/glide" ref="nofollow noopener noreferrer">Glide</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzjupure%2FGlideWebpDecoder" target="_blank" title="https://github.com/zjupure/GlideWebpDecoder" ref="nofollow noopener noreferrer">GlideWebpDecoder</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7580564126402576434</link>    <guid>https://juejin.cn/post/7580564126402576434</guid>    <pubDate>2025-12-07T12:18:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580564126402576434" data-draft-id="7576369868418859044" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:18:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:18:33.000Z" title="Sun Dec 07 2025 12:18:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šä¸€ç¯‡ä»‹ç»äº†<strong>Localstorage</strong>è·¨é¡µé¢é€šè®¯çš„æ–¹å¼ã€‚åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œä»‹ç»äº†å¤šç§è·¨é¡µé¢é€šä¿¡æ–¹å¼ï¼Œä»é€‚ç”¨äºåŒæºé¡µé¢çš„ <code>BroadcastChannel</code>ï¼Œåˆ°è§£å†³è·¨åŸŸçš„ <code>postMessage</code>ã€‚å½“å¤šä¸ªé€šä¿¡è¿›è¡Œæ··æ‚åœ¨ä¸€èµ·ï¼Œä½¿ç”¨å…¨å±€çš„<code>message</code>äº‹ä»¶ç›‘å¬æ—¶ï¼Œä¼šé€šè¿‡å„ç§ç±»å‹åˆ¤æ–­æ¶ˆæ¯æ¥æºè¿›è¡Œå¤„ç†ã€‚</p>
<p>é‚£æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¢èƒ½å®ç°è·¨ä¸Šä¸‹æ–‡é€šä¿¡ï¼Œåˆèƒ½åƒæ‰“ç”µè¯ä¸€æ ·ï¼Œå»ºç«‹èµ·ä¸€æ¡<strong>ä¸“å±çš„ã€åŒå‘çš„ã€ç‚¹å¯¹ç‚¹çš„ç§å¯†é€šé“</strong>å‘¢ï¼Ÿ</p>
<p>ä»Šå¤©ä»‹ç»ä¸€ä¸ªæ–¹æ¡ˆâ€”â€”<strong>MessageChannel API</strong>ã€‚æä¾›äº†ä¸€ç§æ›´ä¸ºä¼˜é›…å’Œç§å¯†çš„æ–¹å¼ï¼Œå»ºç«‹èµ·ä¸€æ¡ç‚¹å¯¹ç‚¹çš„â€œä¸“çº¿ç”µè¯â€ï¼Œè®©é€šä¿¡åŒæ–¹å¯ä»¥æ¸…æ™°åœ°ã€æ— å¹²æ‰°åœ°å¯¹è¯ã€‚</p>
<h2 data-id="heading-1">1. MessageChannel æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FChannel_Messaging_API" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Channel_Messaging_API" ref="nofollow noopener noreferrer">Channel Messaging API</a>Â çš„Â <strong><code>MessageChannel</code></strong>Â æ¥å£å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆæ¯é€šé“ï¼Œå¹¶é€šè¿‡å®ƒçš„ä¸¤ä¸ªÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FMessagePort" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/MessagePort" ref="nofollow noopener noreferrer"><code>MessagePort</code></a>Â å±æ€§å‘é€æ•°æ®ã€‚</p>
<p>æ ¸å¿ƒæ˜¯åˆ›å»ºä¸€ä¸ª<strong>åŒå‘é€šè®¯çš„ç®¡é“</strong>ï¼Œè¿™ä¸ªç®¡é“åŒ…å«ä¸¤ä¸ªç›¸äº’å…³è”çš„ç«¯å£â€”â€”<code>port1</code> å’Œ <code>port2</code>ã€‚æ•°æ®ä» port1 å‘é€ï¼Œå°±åªèƒ½ç”± port2 æ¥æ”¶ï¼›åä¹‹ï¼Œport2 å‘é€çš„æ•°æ®ä¹Ÿåªèƒ½è¢« port1 æ•è·ï¼Œè¿™ç§â€œç‚¹å¯¹ç‚¹â€çš„é€šè®¯æ¨¡å¼ï¼Œä»æ ¹æºä¸Šé¿å…äº†æ•°æ®è¢«æ— å…³é¡µé¢æ‹¦æˆªçš„é£é™©ã€‚</p>
<p>ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼š BroadcastChannel æ˜¯â€œå°åŒºå¹¿æ’­â€ï¼Œæ‰€æœ‰äººéƒ½èƒ½å¬åˆ°ï¼›è€Œ MessageChannel å°±æ˜¯â€œä¸“çº¿ç”µè¯â€ï¼Œåªæœ‰ä¸¤ä¸ªç«¯å£å¯¹åº”çš„è®¾å¤‡èƒ½æ¥é€šã€‚</p>
<h2 data-id="heading-2">2. å¦‚ä½•ä½¿ç”¨</h2>
<p>ä½¿ç”¨ <code>MessageChannel</code> æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºé€šé“</strong>ï¼š åˆ›å»ºä¸€ä¸ª <code>MessageChannel</code> å®ä¾‹ï¼ŒåŒ…å«ä¸¤ä¸ªç«¯å£å±æ€§ï¼š<code>port1</code> å’Œ <code>port2</code>ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();

<span class="hljs-comment">// channel.port1 å’Œ channel.port2 éƒ½æ˜¯ MessagePort å¯¹è±¡</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c0a6bc583d24a04a01697afbbd6b593~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=h9mIZ%2FHNQmjWHrH7NoIABZ9zigA%3D" alt="image.png" loading="lazy"/></p>
<ol start="2">
<li><strong>ç›‘å¬æ¶ˆæ¯</strong>ï¼š åœ¨å…¶ä¸­ä¸€ä¸ªç«¯å£ä¸Šè®¾ç½® <code>onmessage</code> äº‹ä»¶å¤„ç†å™¨ï¼Œç”¨äºæ¥æ”¶æ¥è‡ªå¦ä¸€ä¸ªç«¯å£çš„æ¶ˆæ¯ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js">channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
};
</code></pre>
<ol start="3">
<li><strong>å‘é€æ¶ˆæ¯</strong>ï¼š é€šè¿‡ä¸€ä¸ªç«¯å£çš„ <code>postMessage</code>æ–¹æ³•å‘å¦ä¸€ä¸ªç«¯å£å‘é€æ•°æ®ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js">channel.<span class="hljs-property">port2</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello from port2!'</span>);
</code></pre>
<ol start="4">
<li><strong>è½¬ç§»ç«¯å£æ‰€æœ‰æƒ</strong> ï¼š <code>MessageChannel</code> çš„å¨åŠ›åœ¨äºå¯ä»¥å°†ä¸€ä¸ªç«¯å£å‘é€åˆ°å¦ä¸€ä¸ªæµè§ˆä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ iframeï¼‰ã€‚è¿™éœ€è¦é€šè¿‡ <code>window.postMessage</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•° <code>transfer</code> æ¥å®ç°, å¯ä»¥ç›´æ¥å°†ç«¯å£ä¸‹å‘åˆ°ä¸¤ä¸ªå­iframe,ç›´æ¥è¿›è¡Œé€šè®¯ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å‡è®¾ iframe æ˜¯æˆ‘ä»¬æƒ³è¦é€šä¿¡çš„ç›®æ ‡</span>
<span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'iframe'</span>).<span class="hljs-property">contentWindow</span>;

<span class="hljs-comment">// å°† port2 çš„æ‰€æœ‰æƒè½¬ç§»ç»™ iframe</span>
<span class="hljs-comment">// è½¬ç§»åï¼Œå½“å‰é¡µé¢å°±ä¸å†æ‹¥æœ‰ port2ï¼Œåªæœ‰ iframe èƒ½ä½¿ç”¨å®ƒ</span>

iframe.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port2</span>]);
</code></pre>
<p>ä½¿ç”¨postMessageå‘é€ç«¯å£ä¼šå‡ºç°portsï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/083da7c6bc5643a3ade3d23789ca5c8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=kQNarFBKYkESaPUWjd9v2URFszY%3D" alt="image.png" loading="lazy"/></p>
<p>æ¥æ”¶æ–¹ï¼ˆiframeï¼‰å¯ä»¥åœ¨å…¶ <code>message</code> äº‹ä»¶ä¸­è·å–åˆ°è¿™ä¸ªç«¯å£ï¼Œå¼€å§‹é€šä¿¡ã€‚</p>
<h2 data-id="heading-3">3. å®è·µåœºæ™¯</h2>
<p>ä¸‹é¢ä½¿ç”¨MessageChannelè¿›è¡Œçˆ¶å­åŒå‘ã€å…„å¼Ÿé€šè®¯è¿›è¡Œè¯´æ˜ã€‚</p>
<h3 data-id="heading-4">3.1 çˆ¶å­åŒå‘é€šè®¯</h3>
<p>çˆ¶é¡µé¢å¼•å…¥ä¸€ä¸ª iframeï¼Œåˆ›å»ºMessageChannel,åˆå§‹åŒ–æ—¶å°†å…¶ä¸­ä¸€ä¸ª<code>port1</code>ä½¿ç”¨<code>postMessage</code>ä¼ é€’ï¼Œåé¢ç›´æ¥é€šè¿‡portè¿›è¡ŒåŒå‘é€šè®¯ã€‚</p>
<p>æ­¥éª¤1ï¼šçˆ¶é¡µé¢ï¼ˆå‘é€ç«¯å£+é€šè®¯é€»è¾‘ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">// 1. åˆ›å»º MessageChannel å®ä¾‹ï¼Œç”Ÿæˆä¸¤ä¸ªç«¯å£
const <span class="hljs-attr">channel</span> = new MessageChannel()<span class="hljs-comment">;</span>
const { port1, port2 } = channel<span class="hljs-comment">;</span>

// 2. è·å– iframe å…ƒç´ ï¼Œç›‘å¬åŠ è½½å®Œæˆäº‹ä»¶
const <span class="hljs-attr">iframe</span> = document.getElementById(<span class="hljs-string">'myIframe'</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">iframe.onload</span> = () =&gt; {
  // 3. å‘ iframe ä¼ é€’ port2ï¼ˆå…³é”®ï¼šåªæœ‰ä¼ é€’ç«¯å£åæ‰èƒ½é€šè®¯ï¼‰
  iframe.contentWindow.postMessage('init', '*', <span class="hljs-section">[port2]</span>)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// 4. ç›‘å¬ port1 æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆæ¥è‡ª iframeï¼‰
<span class="hljs-attr">port1.onmessage</span> = (e) =&gt; {
  console.log('çˆ¶é¡µé¢æ”¶åˆ° iframe æ¶ˆæ¯ï¼š', e.data)<span class="hljs-comment">;</span>
  // æ”¶åˆ°æ¶ˆæ¯åå›å¤
  if (<span class="hljs-attr">e.data</span> === <span class="hljs-string">'hello from iframe'</span>) {
    port1.postMessage('hi iframe, I am parent')<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>

// 5. å¯é€‰ï¼šç›‘å¬é”™è¯¯äº‹ä»¶
<span class="hljs-attr">port1.onerror</span> = (error) =&gt; {
  console.error('é€šè®¯é”™è¯¯ï¼š', error)<span class="hljs-comment">;</span>
  port1.close()<span class="hljs-comment">; // å‡ºé”™åå…³é—­ç«¯å£</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>æ­¥éª¤2ï¼šiframe é¡µé¢ï¼ˆæ¥æ”¶ç«¯å£+å“åº”é€»è¾‘ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">// 1. ç›‘å¬çˆ¶é¡µé¢å‘é€çš„åˆå§‹åŒ–æ¶ˆæ¯
<span class="hljs-attr">window.onmessage</span> = (e) =&gt; {
  // 2. éªŒè¯æ¶ˆæ¯ç±»å‹ï¼Œè·å–ä¼ é€’çš„ port2
  if (<span class="hljs-attr">e.data</span> === <span class="hljs-string">'init'</span> &amp;&amp; e.ports.length) {
    const <span class="hljs-attr">port2</span> = e.ports[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>

    // 3. ç›‘å¬ port2 æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆæ¥è‡ªçˆ¶é¡µé¢ï¼‰
    <span class="hljs-attr">port2.onmessage</span> = (msg) =&gt; {
      console.log('iframe æ”¶åˆ°çˆ¶é¡µé¢æ¶ˆæ¯ï¼š', msg.data)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>

    // 4. å‘çˆ¶é¡µé¢å‘é€æ¶ˆæ¯
    port2.postMessage('hello from iframe')<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>çˆ¶é¡µé¢é€šè¿‡ <code>postMessage</code> ä¼ é€’ port2 æ—¶ï¼Œå¿…é¡»å°† port2 æ”¾åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆtransferListï¼‰ä¸­ï¼Œè¿™æ˜¯ â€œç«¯å£ä¼ é€’â€çš„å›ºå®šå†™æ³•ï¼›</li>
<li>ç«¯å£ä¸€æ—¦ä¼ é€’ï¼Œçˆ¶é¡µé¢çš„ port2 å°±ä¼šå¤±æ•ˆï¼Œåªèƒ½é€šè¿‡ iframe ä¸­çš„ port2 é€šè®¯ã€‚</li>
</ul>
<h3 data-id="heading-5">3.2 å…„å¼Ÿé€šè®¯</h3>
<p><strong>å®ç°æ€è·¯æ˜¯ï¼š</strong> çˆ¶é¡µé¢ä½œä¸ºâ€œæ€»æœºâ€ï¼Œè´Ÿè´£åˆ›å»º <code>MessageChannel</code>ï¼Œå¹¶å°†ä¸¤ä¸ªç«¯å£åˆ†åˆ«åˆ†é…ç»™ä¸¤ä¸ª <code>iframe</code>ï¼Œè®©å®ƒä»¬ä¹‹é—´å»ºç«‹èµ·ç›´è¿ä¸“çº¿ã€‚</p>
<p>æ­¥éª¤1ï¼šçˆ¶é¡µé¢ä»£ç </p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
<span class="hljs-keyword">const</span> frame1 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame1'</span>).<span class="hljs-property">contentWindow</span>;
<span class="hljs-keyword">const</span> frame2 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame2'</span>).<span class="hljs-property">contentWindow</span>;
<span class="hljs-comment">// ç­‰å¾…ä¸¤ä¸ª iframe åŠ è½½å®Œæˆ</span>
<span class="hljs-keyword">let</span> loadCount = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onLoad</span> = (<span class="hljs-params"/>) =&gt; {
  loadCount++;
  <span class="hljs-keyword">if</span> (loadCount === <span class="hljs-number">2</span>) {
    <span class="hljs-comment">// å°† port1 å‘é€ç»™ iframe1</span>
    frame1.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port1</span>]);
    <span class="hljs-comment">// å°† port2 å‘é€ç»™ iframe2</span>
    frame2.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port2</span>]);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶é¡µé¢ï¼šä¸“çº¿å·²å»ºç«‹ï¼Œç«¯å£å·²åˆ†å‘ã€‚'</span>);
  }
};
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame1'</span>).<span class="hljs-property">onload</span> = onLoad;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame2'</span>).<span class="hljs-property">onload</span> = onLoad;
</code></pre>
<p>æ­¥éª¤2ï¼šå­é¡µé¢æ¥æ”¶port</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">let</span> port;
<span class="hljs-comment">// 1. æ¥å£ç«¯å£</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-comment">// ç¡®è®¤æ˜¯çˆ¶é¡µé¢å‘æ¥çš„åˆå§‹åŒ–æ¶ˆæ¯ï¼Œå¹¶æ¥æ”¶ç«¯å£</span>
  <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span> === <span class="hljs-string">'init'</span>) {
    port = event.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'iframe1ï¼šå·²æ¥æ”¶ port1ï¼Œå‡†å¤‡å‘é€æ¶ˆæ¯ã€‚'</span>);
  }
});
<span class="hljs-comment">// 2. å‘é€æ¶ˆæ¯</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendBtn'</span>).<span class="hljs-property">onclick</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (port) {
    <span class="hljs-keyword">const</span> message = <span class="hljs-string">`æ¥è‡ª iframe1 çš„é—®å€™ï¼Œæ—¶é—´ï¼š<span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString()}</span>`</span>;
    port.<span class="hljs-title function_">postMessage</span>(message);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'iframe1ï¼šæ¶ˆæ¯å·²å‘é€ -&gt;'</span>, message);
  }
};
<span class="hljs-comment">// 3. ç›‘å¬ port æ¶ˆæ¯</span>
port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¡µé¢Bæ”¶åˆ°æ¶ˆæ¯ï¼š'</span>, e.<span class="hljs-property">data</span>);
};
</code></pre>
<p>å®é™…æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec819d8e1557474595cb35b95692f93f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=9RRQm6Vc1QOJrnz2llHw63vTTwg%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f5c6321a9ba40d1b7191f7fc57da9c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=BX9y9jns2dwjr4oeO%2FMbgzkDv3c%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">4. æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>ç«¯å£ä¼ é€’å¿…é¡»ç”¨ transferList</li>
</ol>
<p>ä¼ é€’ç«¯å£æ—¶ï¼Œå¿…é¡»å°† port æ”¾åœ¨ <code>postMessage</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆtransferListï¼‰ä¸­ï¼Œè€Œä¸æ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆdataï¼‰ã€‚é”™è¯¯å†™æ³•ä¼šå¯¼è‡´ç«¯å£æ— æ³•æ­£å¸¸ç»‘å®šï¼Œé€šè®¯å¤±æ•ˆã€‚</p>
<ol start="2">
<li>é€šè®¯å®ŒæˆååŠæ—¶å…³é—­ç«¯å£</li>
</ol>
<p>ä¸éœ€è¦é€šè®¯æ—¶ï¼Œè°ƒç”¨ <code>port.close()</code> å…³é—­ç«¯å£ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<h2 data-id="heading-7">5. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼š<code>MessageChannel</code> é€šè¿‡åˆ›å»ºä¸€ä¸ªä¸“å±çš„åŒå‘é€šé“ï¼Œè§£å†³äº†ç‚¹å¯¹ç‚¹é€šä¿¡çš„éœ€æ±‚ï¼Œå”¯ä¸€ä¸è¶³çš„æ˜¯æ— è®ºæ˜¯çˆ¶å­è¿˜æ˜¯å…„å¼Ÿé€šè®¯éƒ½æ˜¯éœ€è¦ä½¿ç”¨<code>postMessage</code>è¿›è¡Œä¼ é€’ç«¯å£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Dify è‡ªå»ºéƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»ä¸Šæ‰‹åˆ°æ”¾å¼ƒåˆ°çœŸé¦™]]></title>    <link>https://juejin.cn/post/7580394927977545747</link>    <guid>https://juejin.cn/post/7580394927977545747</guid>    <pubDate>2025-12-07T06:34:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580394927977545747" data-draft-id="7580389111920476223" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Dify è‡ªå»ºéƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»ä¸Šæ‰‹åˆ°æ”¾å¼ƒåˆ°çœŸé¦™"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-07T06:34:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lomocode"/> <meta itemprop="url" content="https://juejin.cn/user/2103792315926697"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Dify è‡ªå»ºéƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»ä¸Šæ‰‹åˆ°æ”¾å¼ƒåˆ°çœŸé¦™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2103792315926697/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lomocode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T06:34:07.000Z" title="Sun Dec 07 2025 06:34:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74f727f9968d4428880f3c21dce64c10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbG9tb2NvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765694046&amp;x-signature=hFc0JgyH0UO9B3jSJpHDOsGF62A%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">æ•…äº‹çš„å¼€å§‹ï¼šå°±æƒ³è¦ä¸ªå¬è¯çš„ AI åº”ç”¨å¹³å°</h2>
<p>å‡ ä¸ªæœˆå‰ï¼Œè€æ¿çªç„¶æ‰¾åˆ°æˆ‘ï¼š"é‚£ä¸ªè°å•Šï¼Œå’±ä»¬ä¹Ÿå¾—æä¸ª AI åº”ç”¨å¹³å°ï¼Œè¦èƒ½æ¥å…¥å„ç§æ¨¡å‹ï¼Œæ•°æ®å¿…é¡»åœ¨è‡ªå·±æ‰‹é‡Œï¼Œæœ€å¥½ä¸‹å‘¨å°±èƒ½ç”¨ä¸Šã€‚"</p>
<p>æˆ‘å¿ƒæƒ³ï¼Œè¿™ä¸æ˜¯ Coze å—ï¼Ÿæ‰“å¼€æµè§ˆå™¨å‡†å¤‡æ³¨å†Œè´¦å·ï¼Œçªç„¶æƒ³èµ·ä¸Šæ¬¡æ•°æ®åˆè§„ä¼šè®®ä¸Šæ³•åŠ¡éƒ¨é‚£å¼ ä¸¥è‚ƒçš„è„¸..."æ‰€æœ‰å®¢æˆ·æ•°æ®ä¸å¾—ä¸Šä¼ è‡³ç¬¬ä¸‰æ–¹å¹³å°"ã€‚</p>
<p>å¥½å§ï¼ŒCoze passã€‚</p>
<p>æ¥ä¸‹æ¥çš„ä¸€å‘¨ï¼Œæˆ‘åƒä¸ª AI åº”ç”¨å¹³å°è¯„æµ‹åšä¸»ï¼ŒæŠŠå¸‚é¢ä¸Šèƒ½æ‰¾åˆ°çš„éƒ½è¯•äº†ä¸ªéï¼š</p>
<p><strong>Cozeï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</strong> â€”â€” "å“‡ï¼Œè¿™ UI çœŸé¦™ï¼æ’ä»¶çœŸå¤šï¼" â†’ "ç­‰ç­‰ï¼Œæ•°æ®è¦ä¸Šä¼ ï¼Ÿå‘Šè¾ã€‚"</p>
<p><strong>FastGPT</strong> â€”â€” "çŸ¥è¯†åº“åŠŸèƒ½ä¸é”™" â†’ "å·¥ä½œæµæ€ä¹ˆè¿™ä¹ˆç®€é™‹ï¼Ÿ"</p>
<p><strong>LangFlow</strong> â€”â€” "èŠ‚ç‚¹æ‹–æ‹½å¾ˆé…·" â†’ "ä¸ºå•¥æ€»æ˜¯è«åå…¶å¦™æŠ¥é”™ï¼Ÿ"</p>
<p>æœ€åï¼Œçœ‹åˆ°äº† <strong>Dify</strong>ã€‚</p>





























<table><thead><tr><th>ç‰¹æ€§</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>å¼€æºï¼Ÿ</td><td>æ˜¯</td></tr><tr><td>ç§æœ‰åŒ–ï¼Ÿ</td><td>æ˜¯</td></tr><tr><td>æ”¯æŒå„ç§æ¨¡å‹ï¼Ÿ</td><td>æ˜¯</td></tr><tr><td>å·¥ä½œæµå¼ºå¤§ï¼Ÿ</td><td>æ˜¯</td></tr><tr><td>Star æ•° 45k+ï¼Ÿ</td><td>æ˜¯</td></tr></tbody></table>
<p>"å°±æ˜¯ä½ äº†ï¼"æˆ‘ä¿¡å¿ƒæ»¡æ»¡åœ°å¯¹è€æ¿è¯´ï¼š"ç»™æˆ‘ä¸¤å¤©æ—¶é—´ï¼Œä¿è¯æå®šï¼"</p>
<p>ç„¶åï¼Œæˆ‘ç”¨äº†æ•´æ•´ä¸¤å‘¨...</p>
<p>è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯è¿™ä¸¤å‘¨è¡€æ³ªå²çš„å®Œæ•´è®°å½•ã€‚å¦‚æœä½ ä¹Ÿå‡†å¤‡è‡ªå»º Difyï¼Œå»ºè®®å…ˆæ³¡æ¯èŒ¶ï¼Œå› ä¸ºè¿™è¶Ÿæ—…ç¨‹ï¼Œæœ‰ç‚¹é•¿ã€‚</p>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€å¤©ï¼šçœ‹ç€æ–‡æ¡£ä¿¡å¿ƒæ»¡æ»¡</h2>
<p>æ‹¿åˆ°ä»»åŠ¡åçš„ç¬¬ä¸€ä»¶äº‹ï¼Œå½“ç„¶æ˜¯çœ‹å®˜æ–¹æ–‡æ¡£ã€‚Dify çš„æ–‡æ¡£å†™å¾—è¿˜æŒºè¯¦ç»†ï¼Œç”šè‡³è´´å¿ƒåœ°æä¾›äº† docker-compose.yamlã€‚</p>
<p>æˆ‘è„‘æµ·é‡Œå·²ç»è§„åˆ’å¥½äº†æ•´ä¸ªæ¶æ„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "ç†æƒ³ä¸­çš„æ¶æ„"
        User[ç”¨æˆ·] --&gt;|HTTPS| Nginx[Nginxåå‘ä»£ç†]
        Nginx --&gt; Web[Difyå‰ç«¯]
        Nginx --&gt; API[Dify API]
        API --&gt; DB[(PostgreSQL)]
        API --&gt; Cache[(Redis)]
        API --&gt; Models[æ¨¡å‹æœåŠ¡]

        Models --&gt; OpenAI[OpenAI]
        Models --&gt; DeepSeek[DeepSeek]
        Models --&gt; Local[è‡ªå»ºæ¨¡å‹]
    end

    style User fill:#e1f5fe
    style Models fill:#fff3e0
    style DB fill:#f3e5f5
</code></pre>
<p>"Docker Compose ä¸€æŠŠæ¢­ï¼Œä¸¤å°æ—¶æå®šï¼"æˆ‘ç”šè‡³å·²ç»å¼€å§‹æƒ³è±¡è€æ¿èµè®¸çš„çœ¼ç¥äº†ã€‚</p>
<p>ç„¶åæˆ‘ clone äº†ä»£ç ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/langgenius/dify.git
<span class="hljs-built_in">cd</span> dify
docker-compose up -d
</code></pre>
<p>5åˆ†é’Ÿåï¼Œæˆ‘çš„å±å¹•ä¸Šæ»¡æ˜¯çº¢è‰²çš„æŠ¥é”™ä¿¡æ¯...</p>
<hr/>
<h2 data-id="heading-2">ç¬¬äºŒå¤©åˆ°ç¬¬äº”å¤©ï¼šPostgreSQLï¼Œä½ åˆ°åº•è¦æˆ‘æ€æ ·ï¼Ÿ</h2>
<h3 data-id="heading-3">Day 2ï¼šæ•°æ®åº“å¯åŠ¨å¤±è´¥çš„æ—©æ™¨</h3>
<p>æ—©ä¸Š8ç‚¹ï¼Œæ³¡å¥½äº†ä¸€æ¯ä¸­å¹´ç”·äººä¸“å±çš„å¤§è¡¥èŒ¶ï¼Œå‡†å¤‡è§£å†³æ˜¨å¤©çš„æŠ¥é”™ã€‚çœ‹äº†ä¸‹æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">FATAL: role <span class="hljs-string">"postgres"</span> does <span class="hljs-keyword">not</span> exist
db <span class="hljs-keyword">init</span> failed, retrying...
db <span class="hljs-keyword">init</span> failed, retrying...
db <span class="hljs-keyword">init</span> failed, retrying...
</code></pre>
<p>"postgres è§’è‰²ä¸å­˜åœ¨ï¼Ÿ"æˆ‘æŒ äº†æŒ å¤´ï¼Œè¿™ä¸æ˜¯ PostgreSQL çš„é»˜è®¤è¶…çº§ç”¨æˆ·å—ï¼Ÿ</p>
<p>æ¥ä¸‹æ¥çš„4ä¸ªå°æ—¶ï¼Œæˆ‘å°è¯•äº†ï¼š</p>
<ul>
<li>æ”¹ç¯å¢ƒå˜é‡ âœ—</li>
<li>æ”¹å¯†ç  âœ—</li>
<li>æ”¹ç”¨æˆ·å âœ—</li>
<li>æ”¹ç«¯å£ âœ—</li>
<li>æ”¹äººç”Ÿ âœ—ï¼ˆå¼€ç©ç¬‘çš„ï¼‰</li>
</ul>
<p>ä¸­åˆåƒé¥­çš„æ—¶å€™ï¼Œçªç„¶çµå…‰ä¸€é—ªï¼š"ä¸ä¼šæ˜¯ä¹‹å‰çš„å®¹å™¨æ®‹ç•™æ•°æ®å§ï¼Ÿ"</p>
<p>æœç„¶ï¼<code>docker volume ls</code> ä¸€çœ‹ï¼Œä¸€å † dify ç›¸å…³çš„ volumes èººåœ¨é‚£é‡Œã€‚åŸæ¥ Docker çš„ Volume æ˜¯æŒä¹…åŒ–çš„ï¼Œå³ä½¿å®¹å™¨åˆ äº†ï¼Œæ•°æ®è¿˜åœ¨ã€‚è€Œ PostgreSQL æœ‰ä¸ªç‰¹æ€§ï¼šå¦‚æœæ•°æ®ç›®å½•éç©ºï¼Œå°±ä¸ä¼šé‡æ–°åˆå§‹åŒ–ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»ˆæå¤§æ‹›</span>
docker-compose down -v  <span class="hljs-comment"># è¿ volume ä¸€èµ·åˆ </span>
docker volume prune -f  <span class="hljs-comment"># å†è¡¥ä¸€åˆ€</span>
<span class="hljs-built_in">rm</span> -rf ./volumes/db/*   <span class="hljs-comment"># ç‰©ç†åˆ é™¤ï¼Œä»¥é˜²ä¸‡ä¸€</span>
</code></pre>
<p>å†æ¬¡å¯åŠ¨ï¼Œç»ˆäºçœ‹åˆ°äº†æœŸå¾…å·²ä¹…çš„ï¼š</p>
<pre><code class="hljs language-css" lang="css">PostgreSQL Database directory appears <span class="hljs-selector-tag">to</span> <span class="hljs-attribute">contain</span> <span class="hljs-selector-tag">a</span> database
db_1 | PostgreSQL init process complete; ready for start up.
</code></pre>
<p>é‚£ä¸€åˆ»ï¼Œæˆ‘å·®ç‚¹çƒ­æ³ªç›ˆçœ¶ã€‚</p>
<h3 data-id="heading-4">Day 3ï¼š77 å¼ è¡¨çš„çµå¼‚äº‹ä»¶</h3>
<p>æ•°æ®åº“èµ·æ¥äº†ï¼Œå¿ƒæƒ…å¤§å¥½ã€‚æ‰“å¼€ pgAdmin è¿ä¸Šå»çœ‹çœ‹ï¼Œå‡†å¤‡æ¬£èµä¸€ä¸‹ç©ºè¡è¡çš„æ•°æ®åº“ã€‚</p>
<p>ç»“æœ...77 å¼ è¡¨æ•´æ•´é½é½åœ°æ‘†åœ¨é‚£é‡Œã€‚</p>
<p>"æˆ‘è¿˜æ²¡åˆå§‹åŒ–å‘¢ï¼Œå“ªæ¥çš„è¡¨ï¼Ÿ" æˆ‘å¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯æ’é¬¼äº†ã€‚</p>
<p>ä»”ç»†ä¸€çœ‹è¡¨åï¼š<code>migrations</code>ã€<code>users</code>ã€<code>apps</code>...è¿™ä¸æ˜¯ Dify çš„è¡¨å—ï¼Ÿå¯æ˜¯æˆ‘æ˜æ˜åˆšåˆ é™¤äº†æ‰€æœ‰æ•°æ®å•Šï¼Ÿ</p>
<p>èŠ±äº†ä¸€ä¸‹åˆæ’æŸ¥ï¼Œç»ˆäºå‘ç°çœŸç›¸ã€‚åŸæ¥æˆ‘åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå¤šæ¬¡ä½¿ç”¨ <code>git restore docker-compose.yaml</code> è¿˜åŸé…ç½®æ–‡ä»¶ï¼Œæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸åŒçš„ volume åç§°ã€‚è€Œ PostgreSQL æ¯æ¬¡éƒ½ä¼šæ‰¾åˆ°æŸä¸ªæ—§çš„ volume å¹¶åŠ è½½ã€‚</p>
<p>è¿™å°±åƒæ˜¯ï¼Œä½ ä»¥ä¸ºè‡ªå·±ä½è¿›äº†æ–°æˆ¿å­ï¼Œç»“æœå‘ç°ä¸Šä¸€ä»»ç§Ÿå®¢çš„å®¶å…·éƒ½è¿˜åœ¨ã€‚</p>
<p>æ•™è®­ï¼š<strong>ä¸åªæ˜¯è¦åˆ  volumeï¼Œè¿˜è¦ç¡®ä¿ volume åç§°ä¸€è‡´ï¼Œæˆ–è€…å¹²è„†ç”¨ç»å¯¹è·¯å¾„æŒ‚è½½ã€‚</strong></p>
<h3 data-id="heading-5">Day 4ï¼šå‰ç«¯ç™½å±çš„ä¸‹åˆèŒ¶æ—¶å…‰</h3>
<p>æ•°æ®åº“æå®šäº†ï¼ŒæœåŠ¡ä¹Ÿéƒ½èµ·æ¥äº†ã€‚ä¸‹åˆ3ç‚¹ï¼Œæ³¡äº†æ¯èŒ¶ï¼Œå‡†å¤‡æ¬£èµè‡ªå·±çš„åŠ³åŠ¨æˆæœã€‚</p>
<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <code>http://localhost:3000</code></p>
<p>ç™½å±ã€‚</p>
<p>F12 æ‰“å¼€æ§åˆ¶å°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable constant_">GET</span> <span class="hljs-attr">http</span>:<span class="hljs-comment">//localhost:3000/static/js/main.chunk.js 404</span>
<span class="hljs-variable constant_">GET</span> <span class="hljs-attr">http</span>:<span class="hljs-comment">//localhost:3000/static/css/main.css 404</span>
<span class="hljs-title class_">Uncaught</span> <span class="hljs-title class_">ReferenceError</span>: <span class="hljs-title class_">React</span> is not defined
</code></pre>
<p>"é™æ€èµ„æº 404ï¼Ÿ" æˆ‘è¿›åˆ°å®¹å™¨é‡Œä¸€çœ‹ï¼Œæ–‡ä»¶æ˜æ˜éƒ½åœ¨ <code>/app/web/dist</code> ç›®å½•ä¸‹ã€‚</p>
<p>åˆæ˜¯ä¸¤ä¸ªå°æ—¶çš„æ’æŸ¥ï¼Œå‘ç°æ˜¯ Nginx é…ç½®çš„é—®é¢˜ã€‚Dify çš„å‰ç«¯å®¹å™¨å·²ç»è‡ªå¸¦äº†ä¸€ä¸ª Node æœåŠ¡å™¨ï¼Œä¸éœ€è¦ Nginx ç›´æ¥ä»£ç†é™æ€æ–‡ä»¶ï¼Œè€Œæ˜¯è¦ä»£ç†åˆ°è¿™ä¸ª Node æœåŠ¡å™¨ã€‚</p>
<p>æ­£ç¡®çš„é…ç½®åº”è¯¥æ˜¯ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">location / {
    proxy_pass http://web:3000;  # æ³¨æ„æ˜¯ 3000 ç«¯å£ï¼Œä¸æ˜¯ 80
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}
</code></pre>
<p>æ”¹å®Œé…ç½®ï¼Œ<code>nginx -s reload</code>ï¼Œé¡µé¢ç»ˆäºå‡ºæ¥äº†ï¼</p>
<p>é‚£ä¸ªç†Ÿæ‚‰çš„ Dify Logo å‡ºç°åœ¨å±å¹•ä¸Šæ—¶ï¼Œæˆ‘æ„Ÿè§‰å°±åƒè§åˆ°äº†è€æœ‹å‹ã€‚</p>
<h3 data-id="heading-6">Day 5ï¼šDeepSeekï¼Œä½ ä¸æŒ‰å¥—è·¯å‡ºç‰Œå•Š</h3>
<p>åŸºç¡€ç¯å¢ƒæå®šï¼Œå¼€å§‹æ¥å…¥æ¨¡å‹ã€‚OpenAI çš„æ¥å…¥å¾ˆé¡ºåˆ©ï¼Œæ¯•ç«Ÿæ˜¯è¡Œä¸šæ ‡å‡†ã€‚ä½†åˆ°äº† DeepSeek...</p>
<p>åœ¨ Dify åå°å¡«å…¥ï¼š</p>
<ul>
<li>API Base: <code>https://api.deepseek.com/v1</code></li>
<li>API Key: <code>sk-xxxx</code></li>
</ul>
<p>æµ‹è¯•è¿æ¥ï¼Œè½¬äº†åŠå¤©ï¼Œè¶…æ—¶ã€‚</p>
<p>"ä¸åº”è¯¥å•Šï¼Œæˆ‘åœ¨æœ¬åœ°ç”¨ curl æµ‹è¯•æ˜¯æ­£å¸¸çš„ã€‚"</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°æµ‹è¯• OK</span>
curl https://api.deepseek.com/v1/chat/completions \
  -H <span class="hljs-string">"Authorization: Bearer sk-xxx"</span> \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{"model": "deepseek-chat", "messages": [{"role": "user", "content": "Hi"}]}'</span>
</code></pre>
<p>è¿›åˆ° Dify API å®¹å™¨é‡Œå†æµ‹è¯•ï¼Œä¹Ÿ OKã€‚ä½†ä» Dify ç•Œé¢å°±æ˜¯ä¸è¡Œã€‚</p>
<p>æŠ“åŒ…ï¼Œçœ‹æ—¥å¿—ï¼Œç¿»æºç ...æ™šä¸Š11ç‚¹ï¼Œç»ˆäºå‘ç°é—®é¢˜ï¼šDeepSeek çš„ API åœ¨å¤„ç† HTTP/2 è¯·æ±‚æ—¶æœ‰äº›ç‰¹æ®Šï¼Œè€Œ Dify ä½¿ç”¨çš„ Python requests åº“åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¼ºåˆ¶ä½¿ç”¨ HTTP/2ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆå¾ˆé­”å¹»ï¼šç”¨ Nginx åšä¸ªä¸­è½¬ï¼Œå¼ºåˆ¶é™çº§åˆ° HTTP/1.1ã€‚</p>
<pre><code class="hljs language-nginx" lang="nginx"># deepseek ä¸“ç”¨è½¬å‘
location /deepseek-proxy/ {
    proxy_pass https://api.deepseek.com/;
    proxy_http_version 1.1;  # å…³é”®æ˜¯è¿™è¡Œ
    proxy_ssl_server_name on;
    proxy_set_header Host api.deepseek.com;
    proxy_set_header Authorization $http_authorization;
}
</code></pre>
<p>ç„¶ååœ¨ Dify é‡Œå¡« <code>http://nginx/deepseek-proxy</code> ä½œä¸º API Baseã€‚</p>
<p>è™½ç„¶è§£å†³äº†ï¼Œä½†æ€»æ„Ÿè§‰åƒæ˜¯ç”¨åˆ›å¯è´´ä¿®è¡¥è½¯ä»¶ bug...</p>
<hr/>
<h2 data-id="heading-7">ç¬¬å…­å¤©ï¼šSGLangï¼Œä¸€ä¸ªç©ºæ ¼å¼•å‘çš„è¡€æ¡ˆ</h2>
<p>è‡ªå»ºæ¨¡å‹ä¹Ÿè¦æ¥è¿›æ¥ã€‚æˆ‘ä»¬ç”¨çš„æ˜¯ SGLangï¼Œä¸€ä¸ªé«˜æ€§èƒ½çš„æ¨ç†æ¡†æ¶ã€‚éƒ¨ç½²å¾ˆé¡ºåˆ©ï¼ŒAPI ä¹Ÿé€šäº†ï¼Œä½†å¼€å¯æµå¼è¾“å‡ºåï¼ŒDify åˆå¼€å§‹æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">Invalid chunk <span class="hljs-built_in">format</span>: expecting <span class="hljs-string">'data:'</span> prefix
</code></pre>
<p>"data: å‰ç¼€ï¼Ÿæ˜æ˜æœ‰å•Šï¼" æˆ‘ç›¯ç€è¿”å›çš„æ•°æ®çœ‹äº†åŠå¤©ã€‚</p>
<p>ç”¨ Postman æµ‹è¯• SGLang çš„æµå¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-css" lang="css">data:{"choices":[{"delta":{"<span class="hljs-attribute">content</span>":<span class="hljs-string">"Hello"</span>}}]}
</code></pre>
<p>ç”¨ Postman æµ‹è¯• OpenAI çš„æµå¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-css" lang="css">data: {"choices": [{"delta": {"<span class="hljs-attribute">content</span>": <span class="hljs-string">"Hello"</span>}}]}
</code></pre>
<p>ä½ å‘ç°åŒºåˆ«äº†å—ï¼Ÿæˆ‘ç›¯äº† 10 åˆ†é’Ÿæ‰å‘ç°ï¼š<strong>SGLang åœ¨ <code>data:</code> åé¢å°‘äº†ä¸€ä¸ªç©ºæ ¼ï¼</strong></p>
<p>å°±è¿™ä¹ˆä¸€ä¸ªç©ºæ ¼ï¼Œè®©æˆ‘è°ƒè¯•äº†æ•´æ•´ä¸€ä¸ªæ™šä¸Šã€‚</p>
<p>æœ€åå†™äº†ä¸ªä¸­é—´ä»¶ä¸“é—¨åŠ ç©ºæ ¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fix_sse_format</span>(<span class="hljs-params">original_stream</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> original_stream:
        <span class="hljs-keyword">if</span> chunk.startswith(<span class="hljs-string">b'data:'</span>) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> chunk.startswith(<span class="hljs-string">b'data: '</span>):
            chunk = <span class="hljs-string">b'data: '</span> + chunk[<span class="hljs-number">5</span>:]  <span class="hljs-comment"># åŠ ä¸ªç©ºæ ¼</span>
        <span class="hljs-keyword">yield</span> chunk + <span class="hljs-string">b'\n\n'</span>
</code></pre>
<p>å½“è¿™ä¸ª fix ç”Ÿæ•ˆçš„æ—¶å€™ï¼Œæˆ‘çš„å¿ƒæƒ…å¾ˆå¤æ‚ã€‚ä¸€æ–¹é¢ç»ˆäºè§£å†³äº†é—®é¢˜ï¼Œå¦ä¸€æ–¹é¢è§‰å¾—"ç¨‹åºå‘˜çš„äººç”Ÿå°±æ˜¯åœ¨å¤„ç†å„ç§ç©ºæ ¼ã€åˆ†å·ã€æ‹¬å·"...</p>
<hr/>
<h2 data-id="heading-8">ç¬¬ä¸ƒå¤©åˆ°ç¬¬åå¤©ï¼šä»"èƒ½è·‘"åˆ°"èƒ½ç”¨"</h2>
<p>åŸºç¡€ç¯å¢ƒæ­å¥½äº†ï¼Œæ¨¡å‹ä¹Ÿæ¥é€šäº†ï¼Œä½†è¿™åªæ˜¯"èƒ½è·‘"ï¼Œç¦»"èƒ½ç”¨"è¿˜æœ‰è·ç¦»ã€‚</p>
<h3 data-id="heading-9">æ€§èƒ½ä¼˜åŒ–ï¼šä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢ï¼Ÿ</h3>
<p>ç¬¬ä¸€ä¸ªç”¨æˆ·åé¦ˆæ¥äº†ï¼š"ä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡å¯¹è¯è¦ç­‰ 5 ç§’é’Ÿï¼Ÿ"</p>
<p>æˆ‘æµ‹äº†ä¸€ä¸‹ï¼Œç¡®å®æ…¢ï¼š</p>
<ul>
<li>å†·å¯åŠ¨ï¼š3-5 ç§’</li>
<li>çŸ¥è¯†åº“æ£€ç´¢ï¼š10+ ç§’</li>
<li>å¹¶å‘ 20 äººå°±å¼€å§‹å¡</li>
</ul>
<p>å¼€å§‹ä¼˜åŒ–ä¹‹æ—…ï¼š</p>
<p><strong>1. æ¨¡å‹è¿æ¥é¢„çƒ­</strong></p>
<p>åŸæ¥æ¯æ¬¡ç”¨æˆ·ç¬¬ä¸€æ¬¡å¯¹è¯ï¼ŒDify æ‰ä¼šå»å»ºç«‹æ¨¡å‹è¿æ¥ã€‚æ”¹æˆå¯åŠ¨æ—¶é¢„åŠ è½½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯åŠ¨æ—¶å°±æŠŠå¸¸ç”¨æ¨¡å‹è¿æ¥å»ºå¥½</span>
PRELOAD_MODELS = [<span class="hljs-string">'gpt-4'</span>, <span class="hljs-string">'deepseek-chat'</span>, <span class="hljs-string">'local-llama'</span>]
<span class="hljs-keyword">for</span> model <span class="hljs-keyword">in</span> PRELOAD_MODELS:
    <span class="hljs-keyword">try</span>:
        test_connection(model)
        logger.info(<span class="hljs-string">f"Model <span class="hljs-subst">{model}</span> preloaded"</span>)
    <span class="hljs-keyword">except</span>:
        logger.error(<span class="hljs-string">f"Failed to preload <span class="hljs-subst">{model}</span>"</span>)
</code></pre>
<p><strong>2. æ•°æ®åº“è¿æ¥æ± </strong></p>
<p>é»˜è®¤è¿æ¥æ± å¤ªå°äº†ï¼Œé«˜å¹¶å‘ç›´æ¥çˆ†ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">environment:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">SQLALCHEMY_POOL_SIZE=20</span>  <span class="hljs-comment"># åŸæ¥æ˜¯ 5</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">SQLALCHEMY_MAX_OVERFLOW=40</span>  <span class="hljs-comment"># åŸæ¥æ˜¯ 10</span>
</code></pre>
<p><strong>3. å‘é‡æ£€ç´¢ä¼˜åŒ–</strong></p>
<p>çŸ¥è¯†åº“ç”¨çš„æ˜¯å‘é‡æ•°æ®åº“ï¼Œé»˜è®¤æ˜¯æš´åŠ›æœç´¢ã€‚æ”¹æˆ HNSW ç´¢å¼•åï¼Œæ£€ç´¢é€Ÿåº¦æå‡ 10 å€ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> INDEX idx_embeddings <span class="hljs-keyword">ON</span> documents
<span class="hljs-keyword">USING</span> hnsw (embedding vector_cosine_ops)
<span class="hljs-keyword">WITH</span> (m <span class="hljs-operator">=</span> <span class="hljs-number">16</span>, ef_construction <span class="hljs-operator">=</span> <span class="hljs-number">64</span>);
</code></pre>
<p>ä¼˜åŒ–åçš„æ•ˆæœï¼š</p>






























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th></tr></thead><tbody><tr><td>å†·å¯åŠ¨</td><td>3.2s</td><td>0.8s</td></tr><tr><td>çŸ¥è¯†åº“æ£€ç´¢</td><td>12s</td><td>1.5s</td></tr><tr><td>å¹¶å‘æ”¯æŒ</td><td>20</td><td>200</td></tr><tr><td>å†…å­˜å ç”¨</td><td>8GB</td><td>3GB</td></tr></tbody></table>
<h3 data-id="heading-10">æ—¥å¿—ï¼Œæˆ‘çš„æ—¥å¿—å»å“ªäº†ï¼Ÿ</h3>
<p>å¤šå®¹å™¨ç¯å¢ƒæœ€å¤´ç–¼çš„å°±æ˜¯æŸ¥æ—¥å¿—ã€‚å‡ºé—®é¢˜äº†ï¼Œè¦è¿›å¥½å‡ ä¸ªå®¹å™¨æŒ¨ä¸ªçœ‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker logs dify-api
docker logs dify-web
docker logs dify-worker
docker logs nginx
</code></pre>
<p>æäº†ä¸ª ELK Stackï¼Œä½†å¤ªé‡äº†ã€‚æœ€åé€‰äº† Grafana Lokiï¼Œè½»é‡çº§æ­£åˆé€‚ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">loki:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">grafana/loki:latest</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./loki-config.yaml:/etc/loki/config.yaml</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">-config.file=/etc/loki/config.yaml</span>

  <span class="hljs-attr">promtail:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">grafana/promtail:latest</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/lib/docker/containers:/var/lib/docker/containers:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./promtail-config.yaml:/etc/promtail/config.yaml</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">-config.file=/etc/promtail/config.yaml</span>
</code></pre>
<p>ç°åœ¨æ‰€æœ‰æ—¥å¿—éƒ½èƒ½åœ¨ Grafana é‡Œç»Ÿä¸€æŸ¥è¯¢äº†ï¼Œçˆ½ï¼</p>
<hr/>
<h2 data-id="heading-11">ç¬¬åä¸€å¤©ï¼šä¸Šçº¿å‰çš„æœ€åå‡†å¤‡</h2>
<h3 data-id="heading-12">HTTPSï¼Œä¸€å®šè¦æœ‰ HTTPS</h3>
<p>æµ‹è¯•ç¯å¢ƒç”¨ HTTP æ²¡é—®é¢˜ï¼Œä½†ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¸Š HTTPSã€‚ä¸ç„¶ï¼š</p>
<ul>
<li>WebSocket è¿ä¸ä¸Š</li>
<li>æµè§ˆå™¨è­¦å‘Šä¸å®‰å…¨</li>
<li>SSE æµå¼è¾“å‡ºå„ç§é—®é¢˜</li>
</ul>
<p>ç”¨ Let's Encrypt å…è´¹è¯ä¹¦ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">certbot certonly --webroot -w /var/www/html -d your-domain.com
</code></pre>
<p>Nginx é…ç½®ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">server {
    listen 443 ssl http2;
    ssl_certificate /etc/letsencrypt/live/your-domain/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain/privkey.pem;

    # SSL ä¼˜åŒ–
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
}
</code></pre>
<h3 data-id="heading-13">å¤‡ä»½ï¼Œæ°¸è¿œä¸è¦å¿˜è®°å¤‡ä»½</h3>
<p>å†™äº†ä¸ªå®šæ—¶å¤‡ä»½è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># backup.sh</span>

BACKUP_DIR=<span class="hljs-string">"/backup/dify/<span class="hljs-subst">$(date +%Y%m%d)</span>"</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$BACKUP_DIR</span>

<span class="hljs-comment"># å¤‡ä»½æ•°æ®åº“</span>
docker <span class="hljs-built_in">exec</span> postgres pg_dump -U postgres dify &gt; <span class="hljs-variable">$BACKUP_DIR</span>/db.sql

<span class="hljs-comment"># å¤‡ä»½é…ç½®æ–‡ä»¶</span>
<span class="hljs-built_in">cp</span> -r ./docker ./volumes <span class="hljs-variable">$BACKUP_DIR</span>/

<span class="hljs-comment"># å¤‡ä»½ä¸Šä¼ çš„æ–‡ä»¶</span>
docker <span class="hljs-built_in">cp</span> dify-api:/app/storage <span class="hljs-variable">$BACKUP_DIR</span>/storage

<span class="hljs-comment"># ä¿ç•™æœ€è¿‘ 7 å¤©çš„å¤‡ä»½</span>
find /backup/dify -<span class="hljs-built_in">type</span> d -mtime +7 -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -rf {} +
</code></pre>
<p>åŠ åˆ° crontabï¼Œæ¯å¤©å‡Œæ™¨ 3 ç‚¹è‡ªåŠ¨å¤‡ä»½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">0 3 * * * /path/to/backup.sh
</code></pre>
<hr/>
<h2 data-id="heading-14">ç¬¬åå››å¤©ï¼šç»ˆäºï¼ŒçœŸé¦™äº†</h2>
<p>ä¸¤å‘¨è¿‡å»äº†ï¼ŒDify ç»ˆäºç¨³å®šè¿è¡Œèµ·æ¥ã€‚çœ‹ç€ç›‘æ§é¢æ¿ä¸Šå¹³ç¨³çš„æ›²çº¿ï¼Œæˆ‘é•¿èˆ’ä¸€å£æ°”ã€‚</p>
<p>ç°åœ¨çš„æ¶æ„å›¾å˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "ç”Ÿäº§ç¯å¢ƒæ¶æ„"
        Users[ç”¨æˆ·] --&gt;|HTTPS| LB[è´Ÿè½½å‡è¡¡]
        LB --&gt; Nginx1[Nginx 1]
        LB --&gt; Nginx2[Nginx 2]

        Nginx1 --&gt; Web[Dify Web]
        Nginx1 --&gt; API[Dify API]
        Nginx2 --&gt; Web
        Nginx2 --&gt; API

        API --&gt; PG[(PostgreSQL&lt;br/&gt;ä¸»ä»å¤åˆ¶)]
        API --&gt; Redis[(Redis&lt;br/&gt;å“¨å…µæ¨¡å¼)]
        API --&gt; S3[å¯¹è±¡å­˜å‚¨]

        API --&gt; Models[æ¨¡å‹æœåŠ¡]
        Models --&gt; OpenAI
        Models --&gt; DeepSeek
        Models --&gt; SGLang[è‡ªå»º SGLang]

        Grafana[ç›‘æ§] --&gt; Prometheus
        Grafana --&gt; Loki

        style Users fill:#e1f5fe
        style Models fill:#fff3e0
        style PG fill:#f3e5f5
        style Grafana fill:#e8f5e9
    end
</code></pre>
<p>å›å¤´çœ‹è¿™ä¸¤å‘¨çš„ç»å†ï¼š</p>
<p><strong>è¸©è¿‡çš„å‘ï¼š</strong></p>
<ul>
<li>PostgreSQL åˆå§‹åŒ–é—®é¢˜</li>
<li>Docker Volume çš„å‘</li>
<li>é™æ€èµ„æº 404</li>
<li>DeepSeek HTTP/2 ä¸å…¼å®¹</li>
<li>SGLang æµå¼è¾“å‡ºæ ¼å¼</li>
<li>æ€§èƒ½ä¼˜åŒ–</li>
<li>æ—¥å¿—æ”¶é›†</li>
<li>HTTPS é…ç½®</li>
</ul>
<p><strong>æ”¶è·çš„ç»éªŒï¼š</strong></p>
<ol>
<li><strong>æ°¸è¿œå…ˆçœ‹æ—¥å¿—</strong> - 90% çš„é—®é¢˜éƒ½èƒ½ä»æ—¥å¿—é‡Œæ‰¾åˆ°ç­”æ¡ˆ</li>
<li><strong>Volume è¦è°¨æ…</strong> - Docker Volume æ˜¯æŒä¹…åŒ–çš„ï¼Œåˆ å®¹å™¨ä¸ä¼šåˆ æ•°æ®</li>
<li><strong>HTTP åè®®ç»†èŠ‚å¾ˆé‡è¦</strong> - ä¸€ä¸ªç©ºæ ¼ã€ä¸€ä¸ªç‰ˆæœ¬å·éƒ½å¯èƒ½å¯¼è‡´é—®é¢˜</li>
<li><strong>ç›‘æ§è¦å…ˆè¡Œ</strong> - æ²¡æœ‰ç›‘æ§å°±åƒé—­ç€çœ¼ç›å¼€è½¦</li>
<li><strong>å¤‡ä»½æ˜¯æ•‘å‘½ç¨»è‰</strong> - æ°¸è¿œä¸è¦ç›¸ä¿¡"ä¸ä¼šå‡ºé—®é¢˜"</li>
</ol>
<hr/>
<h2 data-id="heading-15">å†™åœ¨æœ€åï¼šåˆ°åº•å€¼ä¸å€¼ï¼Ÿ</h2>
<p>å¦‚æœä½ é—®æˆ‘ï¼ŒèŠ±ä¸¤å‘¨æ—¶é—´éƒ¨ç½² Dify å€¼ä¸å€¼ï¼Ÿ</p>
<p>æˆ‘çš„ç­”æ¡ˆæ˜¯ï¼š<strong>å€¼ï¼Œä¸è¿‡ä¹Ÿå¾—çœ‹æƒ…å†µã€‚</strong></p>
<p><strong>å¦‚æœï¼š</strong></p>
<ul>
<li>å®Œå…¨æŒæ§æ•°æ®</li>
<li>çµæ´»æ¥å…¥å„ç§æ¨¡å‹</li>
<li>æ·±åº¦å®šåˆ¶åŠŸèƒ½</li>
<li>æ— é™åˆ¶çš„ API è°ƒç”¨</li>
<li>å¯é•¿æœŸæ¼”è¿›çš„å¹³å°</li>
</ul>
<p>é‚£ Dify è‡ªå»ºç»å¯¹æ˜¯æ­£ç¡®é€‰æ‹©ã€‚</p>
<p><strong>ä½†å¦‚æœï¼š</strong></p>
<ul>
<li>åªæ˜¯æƒ³å¿«é€Ÿä½“éªŒ AI åº”ç”¨</li>
<li>å›¢é˜Ÿæ²¡æœ‰è¿ç»´èƒ½åŠ›</li>
<li>å¯¹æ•°æ®å®‰å…¨æ²¡æœ‰å¼ºè¦æ±‚</li>
<li>ä¸éœ€è¦å®šåˆ¶åŒ–åŠŸèƒ½</li>
</ul>
<p>é‚£è¿˜æ˜¯ç”¨ SaaS ç‰ˆæœ¬å§ï¼ŒçœŸçš„èƒ½çœå¾ˆå¤šäº‹ã€‚</p>
<p>æœ€åï¼Œå¦‚æœä½ çœŸçš„è¦è‡ªå»º Difyï¼Œè¿™ä»½é¿å‘æŒ‡å—å¸Œæœ›èƒ½å¸®åˆ°ä½ ï¼š</p>
<h2 data-id="heading-16">å¿«é€Ÿé¿å‘æ¸…å•</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å½»åº•æ¸…ç†ç¯å¢ƒ</span>
docker-compose down -v
docker volume prune -f
<span class="hljs-built_in">rm</span> -rf ./volumes/*

<span class="hljs-comment"># 2. æ£€æŸ¥ç«¯å£å ç”¨</span>
netstat -tulpn | grep -E <span class="hljs-string">'5432|6379|3000|5001'</span>

<span class="hljs-comment"># 3. æ­£ç¡®çš„å¯åŠ¨é¡ºåº</span>
docker-compose up -d db redis
<span class="hljs-built_in">sleep</span> 30  <span class="hljs-comment"># ç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–</span>
docker-compose up -d

<span class="hljs-comment"># 4. éªŒè¯æœåŠ¡çŠ¶æ€</span>
curl http://localhost:5001/health
curl http://localhost:3000

<span class="hljs-comment"># 5. æŸ¥çœ‹æ—¥å¿—</span>
docker-compose logs -f

<span class="hljs-comment"># 6. è¿›å®¹å™¨è°ƒè¯•</span>
docker <span class="hljs-built_in">exec</span> -it dify-api bash
docker <span class="hljs-built_in">exec</span> -it dify-db psql -U postgres -d dify
</code></pre>
<h2 data-id="heading-17">å®Œæ•´éƒ¨ç½²æ¨¡æ¿</h2>
<p>æˆ‘æŠŠæœ€ç»ˆç¨³å®šè¿è¡Œçš„é…ç½®æ•´ç†æˆäº†æ¨¡æ¿ï¼Œéœ€è¦çš„æœ‹å‹å¯ä»¥ç›´æ¥ç”¨ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yaml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">nginx:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:alpine</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx.conf:/etc/nginx/nginx.conf</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./certs:/etc/nginx/certs</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"80:80"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"443:443"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">web</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">api</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>

  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:15-alpine</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">POSTGRES_USER:</span> <span class="hljs-string">postgres</span>
      <span class="hljs-attr">POSTGRES_PASSWORD:</span> <span class="hljs-string">difyai123456</span>
      <span class="hljs-attr">POSTGRES_DB:</span> <span class="hljs-string">dify</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./volumes/db:/var/lib/postgresql/data</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD-SHELL"</span>, <span class="hljs-string">"pg_isready -U postgres"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>

  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7-alpine</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./volumes/redis:/data</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">redis-server</span> <span class="hljs-string">--appendonly</span> <span class="hljs-literal">yes</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>

  <span class="hljs-attr">web:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">langgenius/dify-web:1.10.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">API_URL:</span> <span class="hljs-string">https://your-domain.com/api</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">api</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>

  <span class="hljs-attr">api:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">langgenius/dify-api:1.10.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-comment"># æ•°æ®åº“é…ç½®</span>
      <span class="hljs-attr">DB_HOST:</span> <span class="hljs-string">db</span>
      <span class="hljs-attr">DB_PORT:</span> <span class="hljs-number">5432</span>
      <span class="hljs-attr">DB_USERNAME:</span> <span class="hljs-string">postgres</span>
      <span class="hljs-attr">DB_PASSWORD:</span> <span class="hljs-string">difyai123456</span>
      <span class="hljs-attr">DB_DATABASE:</span> <span class="hljs-string">dify</span>

      <span class="hljs-comment"># Redis é…ç½®</span>
      <span class="hljs-attr">REDIS_HOST:</span> <span class="hljs-string">redis</span>
      <span class="hljs-attr">REDIS_PORT:</span> <span class="hljs-number">6379</span>

      <span class="hljs-comment"># æ€§èƒ½ä¼˜åŒ–</span>
      <span class="hljs-attr">SQLALCHEMY_POOL_SIZE:</span> <span class="hljs-number">20</span>
      <span class="hljs-attr">SQLALCHEMY_MAX_OVERFLOW:</span> <span class="hljs-number">40</span>

      <span class="hljs-comment"># å…¶ä»–é…ç½®</span>
      <span class="hljs-attr">SECRET_KEY:</span> <span class="hljs-string">your-secret-key-change-this</span>
      <span class="hljs-attr">STORAGE_TYPE:</span> <span class="hljs-string">local</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./volumes/storage:/app/storage</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>
</code></pre>
<hr/>
<p>éƒ¨ç½² Dify çš„è¿™ä¸¤å‘¨ï¼Œä»ä¸Šæ‰‹åˆ°æ”¾å¼ƒï¼Œå†åˆ°çœŸé¦™ï¼Œç»å†äº†ä¸€ä¸ªå®Œæ•´çš„å¿ƒè·¯å†ç¨‹ã€‚</p>
<p>ç°åœ¨å›æƒ³èµ·æ¥ï¼Œé‚£äº›æ·±å¤œè°ƒè¯•çš„æ—¶å…‰ã€é‚£äº›å› ä¸ºä¸€ä¸ªç©ºæ ¼æŠ“ç‹‚çš„ç¬é—´ã€é‚£äº›ç»ˆäºè·‘é€šåçš„å–œæ‚¦ï¼Œéƒ½æˆäº†å®è´µçš„ç»éªŒã€‚</p>
<p>æŠ€æœ¯çš„è·¯ä¸Šï¼Œè¸©å‘æ˜¯å¸¸æ€ï¼Œä½†æ¯ä¸ªå‘éƒ½æ˜¯æˆé•¿çš„æœºä¼šã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ å°‘è¸©ä¸€äº›å‘ï¼Œæ—©ç‚¹ä½“éªŒåˆ° Dify çš„"çœŸé¦™"ã€‚</p>
<p>å¦‚æœä½ åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿äº¤æµã€‚æ¯•ç«Ÿï¼Œè¸©å‘çš„äººå¤šäº†ï¼Œå‘å°±å˜æˆäº†è·¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Golangå¹¶å‘å®æˆ˜ï¼šé«˜æ•ˆå¯¹æ¥å¤©è¿œAPIå®ç°æµ·é‡ç”¨æˆ·ç”»åƒæ„å»º]]></title>    <link>https://juejin.cn/post/7581097111896211510</link>    <guid>https://juejin.cn/post/7581097111896211510</guid>    <pubDate>2025-12-08T10:12:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097111896211510" data-draft-id="7581312433529421867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Golangå¹¶å‘å®æˆ˜ï¼šé«˜æ•ˆå¯¹æ¥å¤©è¿œAPIå®ç°æµ·é‡ç”¨æˆ·ç”»åƒæ„å»º"/> <meta itemprop="keywords" content="API,å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2025-12-08T10:12:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©è¿œæ•°ç§‘"/> <meta itemprop="url" content="https://juejin.cn/user/3511153810487162"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Golangå¹¶å‘å®æˆ˜ï¼šé«˜æ•ˆå¯¹æ¥å¤©è¿œAPIå®ç°æµ·é‡ç”¨æˆ·ç”»åƒæ„å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3511153810487162/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©è¿œæ•°ç§‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:12:11.000Z" title="Mon Dec 08 2025 10:12:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é«˜æ€§èƒ½é£æ§ç½‘å…³çš„æ•°æ®åŸºçŸ³</h2>
<p>åœ¨æ„å»ºäº’è”ç½‘å°é¢ä¿¡è´·ã€æ”¯ä»˜åæ¬ºè¯ˆç³»ç»Ÿä»¥åŠå¤§è§„æ¨¡å³æ—¶å¾ä¿¡ç­‰é«˜æ€§èƒ½é‡‘èç§‘æŠ€åº”ç”¨æ—¶ï¼Œç³»ç»Ÿçš„ååé‡ï¼ˆThroughputï¼‰å’Œä½å»¶è¿Ÿï¼ˆLow Latencyï¼‰æ˜¯æ ¸å¿ƒæŒ‡æ ‡ã€‚ä¼ ç»Ÿçš„å•ä½“åº”ç”¨éš¾ä»¥åº”å¯¹æµ·é‡å¹¶å‘è¯·æ±‚ï¼Œè€ŒåŸºäºå¾®æœåŠ¡çš„æ¶æ„åˆ™éœ€è¦å¼ºæœ‰åŠ›çš„æ•°æ®æ”¯æ’‘æ¥åšå‡ºæ¯«ç§’çº§çš„é£é™©å†³ç­–ã€‚</p>
<p>"æ¶ˆè´¹äº¤æ˜“ç‰¹å¾"æ¥å£ï¼Œæä¾›äº†æ ‡å‡†åŒ–çš„HTTPæœåŠ¡ï¼Œèƒ½å¤Ÿè¿”å›åŒ…å«ç”¨æˆ·æ¶ˆè´¹èƒ½åŠ›ã€èµ„é‡‘ç¨³å®šæ€§åŠè¡Œä¸šåå¥½åœ¨å†…çš„160+ä¸ªç‰¹å¾æ ‡ç­¾ã€‚å¯¹äºè¿½æ±‚æè‡´æ€§èƒ½çš„Goå¼€å‘è€…è€Œè¨€ï¼Œå¦‚ä½•åˆ©ç”¨ Goroutine å¹¶å‘ä¼˜åŠ¿é«˜æ•ˆå¯¹æ¥æ­¤ APIï¼Œå¹¶å¤„ç† AES-128 åŠ å¯†æ•°æ®ï¼Œæ˜¯æ„å»ºä¸‹ä¸€ä»£é£æ§ç½‘å…³çš„å…³é”®ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå¦‚ä½•ä½¿ç”¨ Go è¯­è¨€å®ç° APIçš„é«˜æ€§èƒ½æ¥å…¥ï¼ŒåŠ©åŠ›ä¼ä¸šåœ¨æ¯«ç§’ä¹‹é—´å®Œæˆç²¾å‡†çš„ç”¨æˆ·ä»·å€¼è¯„ä¼°ã€‚</p>
<h2 data-id="heading-1">äºŒã€APIæ¥å£è°ƒç”¨ä»£ç æµç¨‹ï¼ˆGoè¯­è¨€ç‰ˆï¼‰</h2>
<p>Go è¯­è¨€æ ‡å‡†åº“ä¸­çš„ <code>net/http</code> å’Œ <code>crypto</code> åŒ…æä¾›äº†å¼ºå¤§çš„ç½‘ç»œå’ŒåŠ å¯†æ”¯æŒã€‚å¯¹æ¥APIçš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæ­£ç¡®å®ç° AES-128-CBC æ¨¡å¼çš„åŠ è§£å¯†ä»¥åŠ PKCS7 å¡«å……é€»è¾‘ã€‚</p>
<h3 data-id="heading-2">1. æ¥å£é…ç½®å‚æ•°</h3>
<ul>
<li><strong>æ¥å£åœ°å€</strong>ï¼š<code>https://api.tianyuanapi.com/api/v1/JRZQ1E7B</code></li>
<li><strong>è¯·æ±‚æ–¹å¼</strong>ï¼šPOST</li>
<li><strong>é‰´æƒå¤´</strong>ï¼š<code>Access-Id</code></li>
<li><strong>åŠ å¯†è§„èŒƒ</strong>ï¼šAES-128 CBCæ¨¡å¼ï¼Œ16å­—èŠ‚éšæœºIVï¼ŒBase64ç¼–ç ä¼ è¾“ã€‚</li>
</ul>
<h3 data-id="heading-3">2. cURL è°ƒç”¨éªŒè¯</h3>
<p>åœ¨ç¼–å†™ Go ä»£ç å‰ï¼Œç¡®ä¿æ‚¨çš„ç¯å¢ƒå¯ä»¥è¿é€š API ç½‘å…³ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-json" lang="json">curl -X POST <span class="hljs-string">"&lt;https://api.tianyuanapi.com/api/v1/JRZQ1E7B?t=1720000000&gt;"</span> \
     -H <span class="hljs-string">"Content-Type: application/json"</span> \
     -H <span class="hljs-string">"Access-Id: YOUR_ACCESS_ID"</span> \
     -d '<span class="hljs-punctuation">{</span><span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"BASE64_ENCRYPTED_PAYLOAD"</span><span class="hljs-punctuation">}</span>'
</code></pre>
<h3 data-id="heading-4">3. Go å®Œæ•´æ¥å…¥ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†åŒ…å«ç»“æ„ä½“å®šä¹‰ã€PKCS7 å¡«å……å¤„ç†åŠ HTTP è¯·æ±‚çš„å®Œæ•´æµç¨‹ã€‚</p>
<p>Go</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"bytes"</span>
	<span class="hljs-string">"crypto/aes"</span>
	<span class="hljs-string">"crypto/cipher"</span>
	<span class="hljs-string">"crypto/rand"</span>
	<span class="hljs-string">"encoding/base64"</span>
	<span class="hljs-string">"encoding/json"</span>
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"io"</span>
	<span class="hljs-string">"net/http"</span>
	<span class="hljs-string">"time"</span>
)

<span class="hljs-comment">// Config é…ç½®ä¿¡æ¯</span>
<span class="hljs-keyword">const</span> (
	ApiURL    = <span class="hljs-string">"&lt;https://api.tianyuanapi.com/api/v1/JRZQ1E7B&gt;"</span>
	AccessID  = <span class="hljs-string">"YOUR_ACCESS_ID"</span>
	SecretKey = <span class="hljs-string">"YOUR_16_BYTE_KEY"</span> <span class="hljs-comment">// å¿…é¡»æ˜¯16å­—èŠ‚çš„16è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢åçš„bytes</span>
)

<span class="hljs-comment">// RequestPayload åŸå§‹è¯·æ±‚å‚æ•°</span>
<span class="hljs-keyword">type</span> RequestPayload <span class="hljs-keyword">struct</span> {
	Name       <span class="hljs-type">string</span> <span class="hljs-string">`json:"name"`</span>
	IdCard     <span class="hljs-type">string</span> <span class="hljs-string">`json:"id_card"`</span>
	MobileNo   <span class="hljs-type">string</span> <span class="hljs-string">`json:"mobile_no"`</span>
	Authorized <span class="hljs-type">string</span> <span class="hljs-string">`json:"authorized"`</span> <span class="hljs-comment">// 0:å¦ï¼Œ1:æ˜¯</span>
}

<span class="hljs-comment">// APIResponse APIé€šç”¨å“åº”ç»“æ„</span>
<span class="hljs-keyword">type</span> APIResponse <span class="hljs-keyword">struct</span> {
	Code          <span class="hljs-keyword">interface</span>{} <span class="hljs-string">`json:"code"`</span> <span class="hljs-comment">// å¯èƒ½æ˜¯intæˆ–stringï¼Œå»ºè®®interface{}å…¼å®¹</span>
	Message       <span class="hljs-type">string</span>      <span class="hljs-string">`json:"message"`</span>
	TransactionID <span class="hljs-type">string</span>      <span class="hljs-string">`json:"transaction_id"`</span>
	Data          <span class="hljs-type">string</span>      <span class="hljs-string">`json:"data"`</span> <span class="hljs-comment">// åŠ å¯†å“åº”æ•°æ®</span>
}

<span class="hljs-comment">// TianyuanClient å®¢æˆ·ç«¯ç»“æ„ä½“</span>
<span class="hljs-keyword">type</span> TianyuanClient <span class="hljs-keyword">struct</span> {
	Client *http.Client
	Key    []<span class="hljs-type">byte</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewClient</span><span class="hljs-params">(key <span class="hljs-type">string</span>)</span></span> *TianyuanClient {
	<span class="hljs-keyword">return</span> &amp;TianyuanClient{
		Client: &amp;http.Client{Timeout: <span class="hljs-number">5</span> * time.Second},
		Key:    []<span class="hljs-type">byte</span>(key), <span class="hljs-comment">// å®é™…ä½¿ç”¨éœ€hex decode</span>
	}
}

<span class="hljs-comment">// PKCS7Padding è¡¥ç </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PKCS7Padding</span><span class="hljs-params">(ciphertext []<span class="hljs-type">byte</span>, blockSize <span class="hljs-type">int</span>)</span></span> []<span class="hljs-type">byte</span> {
	padding := blockSize - <span class="hljs-built_in">len</span>(ciphertext)%blockSize
	padtext := bytes.Repeat([]<span class="hljs-type">byte</span>{<span class="hljs-type">byte</span>(padding)}, padding)
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">append</span>(ciphertext, padtext...)
}

<span class="hljs-comment">// PKCS7UnPadding å»ç </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PKCS7UnPadding</span><span class="hljs-params">(origData []<span class="hljs-type">byte</span>)</span></span> []<span class="hljs-type">byte</span> {
	length := <span class="hljs-built_in">len</span>(origData)
	unpadding := <span class="hljs-type">int</span>(origData[length<span class="hljs-number">-1</span>])
	<span class="hljs-keyword">return</span> origData[:(length - unpadding)]
}

<span class="hljs-comment">// Encrypt AES-128-CBC åŠ å¯†</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TianyuanClient)</span></span> Encrypt(text <span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	block, err := aes.NewCipher(c.Key)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}
	blockSize := block.BlockSize()
	originData := PKCS7Padding([]<span class="hljs-type">byte</span>(text), blockSize)
	
	<span class="hljs-comment">// éšæœºIV</span>
	iv := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, blockSize)
	<span class="hljs-keyword">if</span> _, err := io.ReadFull(rand.Reader, iv); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}

	blockMode := cipher.NewCBCEncrypter(block, iv)
	crypted := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-built_in">len</span>(originData))
	blockMode.CryptBlocks(crypted, originData)

	<span class="hljs-comment">// æ‹¼æ¥ IV + å¯†æ–‡</span>
	combined := <span class="hljs-built_in">append</span>(iv, crypted...)
	<span class="hljs-keyword">return</span> base64.StdEncoding.EncodeToString(combined), <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// Decrypt AES-128-CBC è§£å¯†</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TianyuanClient)</span></span> Decrypt(cryptoText <span class="hljs-type">string</span>) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	decoded, err := base64.StdEncoding.DecodeString(cryptoText)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}

	<span class="hljs-comment">// æå– IV (å‰16å­—èŠ‚)</span>
	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(decoded) &lt; <span class="hljs-number">16</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, fmt.Errorf(<span class="hljs-string">"ciphertext too short"</span>)
	}
	iv := decoded[:<span class="hljs-number">16</span>]
	ciphertext := decoded[<span class="hljs-number">16</span>:]

	block, err := aes.NewCipher(c.Key)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}

	blockMode := cipher.NewCBCDecrypter(block, iv)
	origData := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-built_in">len</span>(ciphertext))
	blockMode.CryptBlocks(origData, ciphertext)

	origData = PKCS7UnPadding(origData)
	<span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(origData), <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// CallAPI å‘èµ·è¯·æ±‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TianyuanClient)</span></span> CallAPI(payload RequestPayload) (<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">error</span>) {
	jsonBytes, _ := json.Marshal(payload)
	encryptedData, err := c.Encrypt(<span class="hljs-type">string</span>(jsonBytes))
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}

	reqBody := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{<span class="hljs-string">"data"</span>: encryptedData}
	reqBytes, _ := json.Marshal(reqBody)

	url := fmt.Sprintf(<span class="hljs-string">"%s?t=%d"</span>, ApiURL, time.Now().UnixMilli())
	req, _ := http.NewRequest(<span class="hljs-string">"POST"</span>, url, bytes.NewBuffer(reqBytes))
	req.Header.Set(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)
	req.Header.Set(<span class="hljs-string">"Access-Id"</span>, AccessID)

	resp, err := c.Client.Do(req)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}
	<span class="hljs-keyword">defer</span> resp.Body.Close()

	<span class="hljs-keyword">var</span> apiResp APIResponse
	<span class="hljs-keyword">if</span> err := json.NewDecoder(resp.Body).Decode(&amp;apiResp); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}

    <span class="hljs-comment">// å¤„ç† code å¯èƒ½æ˜¯ int æˆ– string çš„æƒ…å†µ</span>
	codeVal := fmt.Sprintf(<span class="hljs-string">"%v"</span>, apiResp.Code)
	<span class="hljs-keyword">if</span> codeVal == <span class="hljs-string">"0"</span> {
		decryptedJSON, err := c.Decrypt(apiResp.Data)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
		}
		<span class="hljs-keyword">var</span> result <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}
		json.Unmarshal([]<span class="hljs-type">byte</span>(decryptedJSON), &amp;result)
		<span class="hljs-keyword">return</span> result, <span class="hljs-literal">nil</span>
	}
	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"API Error: %s"</span>, apiResp.Message)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// æ³¨æ„ï¼šKeyå¿…é¡»æ˜¯16å­—èŠ‚ã€‚å®é™…å¼€å‘ä¸­è¯·å¤„ç†å¯†é’¥ç®¡ç†</span>
	client := NewClient(<span class="hljs-string">"1234567890123456"</span>) 
	
	res, err := client.CallAPI(RequestPayload{
		Name:       <span class="hljs-string">"å¼ ä¸‰"</span>,
		IdCard:     <span class="hljs-string">"110101199001011234"</span>,
		MobileNo:   <span class="hljs-string">"13800138000"</span>,
		Authorized: <span class="hljs-string">"1"</span>,
	})

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"Error: %v\n"</span>, err)
	} <span class="hljs-keyword">else</span> {
		fmt.Printf(<span class="hljs-string">"æ¶ˆè´¹èƒ½åŠ›è¯„åˆ†(tap028): %v\n"</span>, res[<span class="hljs-string">"tap028"</span>])
		fmt.Printf(<span class="hljs-string">"ç”¨æˆ·æ ‡ç­¾(tap029): %v\n"</span>, res[<span class="hljs-string">"tap029"</span>])
	}
}
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€æ ¸å¿ƒæ•°æ®ç»“æ„è§£æ</h2>
<p>åœ¨ Go è¯­è¨€ä¸­ï¼Œåˆ©ç”¨ <code>struct</code> æ ‡ç­¾ï¼ˆStruct Tagsï¼‰å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¤„ç† APIè¿”å›çš„ JSON æ•°æ®ã€‚ä¸ºäº†ä¾¿äºå¾®æœåŠ¡é—´çš„æ•°æ®ä¼ é€’ï¼ˆä¾‹å¦‚é€šè¿‡ gRPC æˆ– Protocol Buffersï¼‰ï¼Œå»ºè®®å®šä¹‰æ˜ç¡®çš„ç»“æ„ä½“æ¥æ‰¿è½½è§£å¯†åçš„æ•°æ®ã€‚</p>
<p>APIè¿”å›çš„æ•°æ®ç»“æ„æ‰å¹³ä¸”ä¸°å¯Œï¼ŒåŒ…å«åŸºç¡€ä¿¡æ¯ã€äº¤æ˜“ç»Ÿè®¡ã€è¡Œä¸šç»´åº¦ç­‰æ¨¡å—ï¼š</p>
<p>Go</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// UserTransactionProfile ç”¨æˆ·äº¤æ˜“ç‰¹å¾ç”»åƒ</span>
<span class="hljs-keyword">type</span> UserTransactionProfile <span class="hljs-keyword">struct</span> {
    Tap028 <span class="hljs-type">string</span> <span class="hljs-string">`json:"tap028"`</span> <span class="hljs-comment">// æ¶ˆè´¹èƒ½åŠ›è¯„åˆ†</span>
    Tap001 <span class="hljs-type">string</span> <span class="hljs-string">`json:"tap001"`</span> <span class="hljs-comment">// å¸¸ç”¨å¡æ•°é‡åŒºé—´</span>
    Tap013 <span class="hljs-type">string</span> <span class="hljs-string">`json:"tap013"`</span> <span class="hljs-comment">// å†å²äº¤æ˜“æ€»é‡‘é¢åŒºé—´</span>
    Tap005 <span class="hljs-type">string</span> <span class="hljs-string">`json:"tap005"`</span> <span class="hljs-comment">// æœ€è¿‘ä¸€æ¬¡ä¸€çº§è¡Œä¸š</span>
    <span class="hljs-comment">// ... å…¶ä»–160+ä¸ªå­—æ®µ</span>
}
</code></pre>
<h2 data-id="heading-6">å››ã€å­—æ®µè¯¦è§£ï¼ˆå¾®æœåŠ¡æ¶æ„å…³æ³¨ç‚¹ï¼‰</h2>
<p>Go æœåŠ¡é€šå¸¸ä½œä¸ºé«˜æ€§èƒ½ç½‘å…³æˆ–è®¡ç®—èŠ‚ç‚¹ï¼Œä»¥ä¸‹å­—æ®µå¯¹äºæ„å»º<strong>è‡ªåŠ¨åŒ–è§„åˆ™å¼•æ“</strong>è‡³å…³é‡è¦ã€‚</p>















































<table><thead><tr><th><strong>å­—æ®µç¼–ç </strong></th><th><strong>å­—æ®µå«ä¹‰</strong></th><th><strong>ç±»å‹/æ˜ å°„è¯´æ˜</strong></th><th><strong>ä¸šåŠ¡å†³ç­–é€»è¾‘ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><strong>tap028</strong></td><td><strong>æ¶ˆè´¹èƒ½åŠ›è¯„åˆ†</strong></td><td>200-900åˆ†</td><td>è‹¥ <code>score &lt; 400</code>ï¼Œè‡ªåŠ¨è·¯ç”±è‡³å°é¢äº§å“çº¿ï¼›è‹¥ <code>score &gt; 700</code>ï¼Œè·¯ç”±è‡³VIPäººå·¥æœåŠ¡ã€‚</td></tr><tr><td><strong>tap013</strong></td><td>å†å²äº¤æ˜“æ€»é‡‘é¢</td><td>åŒºé—´æ˜ å°„ (1-6)</td><td>æ˜ å°„å€¼ <code>6</code> ä»£è¡¨æ€»é¢ <code>[128000, Inf)</code>ï¼Œå¯ä½œä¸ºé«˜ä»·å€¼ç”¨æˆ·çš„ç¡¬æ€§é—¨æ§›ã€‚</td></tr><tr><td><strong>tap027</strong></td><td>äº’é‡‘å¹³å°äº¤æ˜“é‡‘é¢</td><td>åŒºé—´æ˜ å°„ (1-4)</td><td>è‹¥è¯¥å€¼å¤§äº <code>2</code> (å³ &gt;10000å…ƒ)ï¼Œé£æ§ç³»ç»Ÿåº”å¢åŠ â€œå¤šå¤´å€Ÿè´·â€æƒé‡çš„è®¡ç®—ã€‚</td></tr><tr><td><strong>tap098</strong></td><td>è¿‘6ä¸ªæœˆå€Ÿè®°å¡äº¤æ˜“é¢</td><td>åŒºé—´æ˜ å°„</td><td>å¯¹æ¯” <code>tap099</code> (è´·è®°å¡é‡‘é¢)ï¼Œåˆ†æç”¨æˆ·çš„å‚¨è“„/è´Ÿå€ºæ¯”ã€‚</td></tr><tr><td><strong>tap143</strong></td><td>é‡‘èç±»å¤§é¢äº¤æ˜“ç¬”æ•°</td><td>åŒºé—´æ˜ å°„ (1-13)</td><td>é’ˆå¯¹é‡‘é¢&gt;10000çš„äº¤æ˜“ï¼Œé¢‘æ¬¡è¿‡é«˜å¯èƒ½æ„å‘³ç€èµ„é‡‘å‘¨è½¬é¢‘ç¹ï¼Œéœ€ç»“åˆåæ´—é’±è§„åˆ™ã€‚</td></tr><tr><td><strong>tap003</strong></td><td>æœ€è¿‘æˆåŠŸäº¤æ˜“æ—¶é—´</td><td>Date (yyyy-MM-dd)</td><td>è®¡ç®— <code>Now - tap003</code>ï¼Œè‹¥è¶…è¿‡180å¤©ï¼Œè§†ä¸ºâ€œæ²‰ç¡æˆ·â€ï¼Œæ¿€æ´»ç­–ç•¥éœ€è°ƒæ•´ã€‚</td></tr></tbody></table>
<h2 data-id="heading-7">äº”ã€åº”ç”¨ä»·å€¼åˆ†æ</h2>
<p>å€ŸåŠ© Go è¯­è¨€çš„é«˜å¹¶å‘ç‰¹æ€§ï¼Œé›†æˆ APIå¯æ˜¾è‘—æå‡ä»¥ä¸‹åœºæ™¯çš„å¤„ç†æ•ˆç‡ï¼š</p>
<h3 data-id="heading-8">1. é«˜å¹¶å‘æ‰¹é‡ç­›æŸ¥ (Batch Screening)</h3>
<p>åœ¨å­˜é‡å®¢æˆ·ï¼ˆå¦‚åƒä¸‡çº§ï¼‰çš„å®šæœŸå¤æŸ¥ä¸­ï¼Œåˆ©ç”¨ Go çš„ <code>Goroutines</code> å’Œ <code>Channels</code>ï¼Œå¯ä»¥è½»æ¾å®ç°æ¯ç§’æ•°åƒæ¬¡å¹¶å‘è°ƒç”¨ã€‚</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šæ¯æœˆ1å·å¯¹å…¨é‡æŒå¡ç”¨æˆ·è¿›è¡Œé¢åº¦è¯„ä¼°ã€‚</li>
<li><strong>å®ç°</strong>ï¼šå¯åŠ¨ 100 ä¸ª Worker Goroutineï¼Œå¹¶å‘è°ƒç”¨ API è·å– <code>tap028</code> å’Œ <code>tap013</code>ï¼Œæ¸…æ´—åå­˜å…¥æ•°ä»“ï¼Œè¿‡ç¨‹ä»…éœ€æ•°å°æ—¶è€Œéæ•°å¤©ã€‚</li>
</ul>
<h3 data-id="heading-9">2. å®æ—¶æ”¯ä»˜è·¯ç”± (Smart Routing)</h3>
<p>åœ¨èšåˆæ”¯ä»˜ç½‘å…³ä¸­ï¼Œæ ¹æ® APIè¿”å›çš„ <code>tap015</code>ï¼ˆæ”¯ä»˜æˆåŠŸç‡ï¼‰å’Œ <code>tap004</code>ï¼ˆæœ€è¿‘äº¤æ˜“é‡‘é¢ï¼‰ç‰¹å¾ï¼ŒåŠ¨æ€é€‰æ‹©æœ€ä¼˜æ”¯ä»˜é€šé“ã€‚</p>
<ul>
<li><strong>é€»è¾‘</strong>ï¼šå¦‚æœç”¨æˆ·å†å²æ”¯ä»˜æˆåŠŸç‡æé«˜ï¼ˆ<code>tap015</code> æ¥è¿‘ 1.0ï¼‰ï¼Œåˆ™è·¯ç”±è‡³æˆåŠŸç‡é«˜ä½†è´¹ç‡ç¨ä½çš„é€šé“ï¼›åä¹‹åˆ™è·¯ç”±è‡³å®¹é”™æ€§æ›´å¼ºçš„é€šé“ã€‚</li>
</ul>
<h3 data-id="heading-10">3. å¾®æœåŠ¡é£æ§ä¸­å° (Risk Microservice)</h3>
<p>å°† <strong>API</strong> çš„è°ƒç”¨å°è£…ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ gRPC å¾®æœåŠ¡ã€‚å…¶ä»–ä¸šåŠ¡çº¿ï¼ˆæ³¨å†Œã€å€Ÿæ¬¾ã€æç°ï¼‰åªéœ€ä¼ å…¥ <code>mobile</code> å’Œ <code>id_card</code>ï¼Œè¯¥æœåŠ¡å³å¯è‡ªåŠ¨å®ŒæˆåŠ å¯†ã€è¯·æ±‚ã€è§£å¯†ã€è§£æï¼Œå¹¶è¿”å›æ ‡å‡†åŒ–çš„ <code>RiskScore</code> ç»“æ„ä½“ï¼Œå®ç°ä¼ä¸šçº§çš„èƒ½åŠ›å¤ç”¨ã€‚</p>
<h2 data-id="heading-11">å…­ã€æ€»ç»“</h2>
<p>å¯¹äºè¿½æ±‚å·¥ç¨‹æ•ˆç‡ä¸è¿è¡Œæ€§èƒ½çš„å›¢é˜Ÿï¼Œé€‰æ‹© Go è¯­è¨€å¯¹æ¥ <strong>æ¶ˆè´¹äº¤æ˜“ç‰¹å¾API</strong> æ˜¯ä¸€ä¸ªæ˜æ™ºçš„å†³å®šã€‚é€šè¿‡æ ‡å‡†åŒ–çš„ AES åŠ å¯†æµç¨‹å’Œç»“æ„åŒ–çš„æ•°æ®è§£æï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿæ„å»ºå‡ºç¨³å®šå¯é çš„æ•°æ®ç®¡é“ã€‚</p>
<p><strong>API</strong> æä¾›çš„é«˜ç»´åº¦ç‰¹å¾æ•°æ®ï¼Œç»“åˆ Go è¯­è¨€åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç»Ÿæ²»åŠ›ï¼Œå°†ä¸ºä¼ä¸šæ„å»ºå®æ—¶ã€æ™ºèƒ½ã€é«˜ååçš„é‡‘èé£æ§ç³»ç»Ÿæä¾›å¼ºæœ‰åŠ›çš„æŠ€æœ¯ä¿éšœã€‚å»ºè®®å¼€å‘è€…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼•å…¥ç†”æ–­ï¼ˆCircuit Breakerï¼‰æœºåˆ¶ï¼Œä»¥ç¡®ä¿åœ¨å¤–éƒ¨ç½‘ç»œæ³¢åŠ¨æ—¶ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-12">ä¸ƒã€æ•°æ®åˆè§„ä¸éšç§å®‰å…¨å£°æ˜</h2>
<p>æ— è®ºæ˜¯ä½¿ç”¨ Pythonã€Javaã€PHP è¿˜æ˜¯ Go è¯­è¨€æ¥å…¥ <strong>å¤©è¿œAPI</strong>ï¼ŒæŠ€æœ¯å®ç°ä»…ä»…æ˜¯æ•°æ®èµ‹èƒ½ä¸šåŠ¡çš„èµ·ç‚¹ã€‚åœ¨åˆ©ç”¨ <strong>ä¿¡è´·è¡Œä¸ºæ•°æ®æ´å¯Ÿ</strong> ç­‰æ¶‰åŠä¸ªäººä¿¡ç”¨çš„é«˜æ•æ„Ÿåº¦æ¥å£è¿›è¡Œé£æ§å†³ç­–æ—¶ï¼Œ<strong>æ•°æ®åˆè§„ä¸éšç§ä¿æŠ¤</strong> å§‹ç»ˆæ˜¯ä¼ä¸šä¸å¯é€¾è¶Šçš„çº¢çº¿ã€‚</p>
<p>å¤©è¿œæ•°æ®ä¸¥æ ¼éµå¾ªã€Šä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ã€‹åŠç›¸å…³æ³•å¾‹æ³•è§„ï¼Œè¦æ±‚å¼€å‘è€…åœ¨è°ƒç”¨æ¥å£æ—¶å¿…é¡»ç¡®ä¿å·²è·å¾—ç”¨æˆ·çš„<strong>æ˜ç¡®æˆæƒ</strong>ï¼ˆå³è¯·æ±‚å‚æ•°ä¸­ <code>authorized</code> å¿…é¡»ä¸º <code>1</code>ï¼Œä¸”ä¿ç•™çœŸå®çš„æˆæƒå‡­è¯ï¼‰ã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä¼ä¸šåœ¨æ•°æ®é‡‡é›†ã€ä¼ è¾“ï¼ˆå…¨ç¨‹åŠ å¯†ï¼‰åŠå­˜å‚¨çš„å…¨ç”Ÿå‘½å‘¨æœŸä¸­å»ºç«‹ä¸¥æ ¼çš„éšç§ä¿æŠ¤æœºåˆ¶ã€‚è¿™ä¸ä»…æ˜¯æ»¡è¶³ç›‘ç®¡åˆè§„çš„åŸºæœ¬è¦æ±‚ï¼Œæ›´æ˜¯æ„å»ºç”¨æˆ·ä¿¡ä»»ã€ä¿éšœä¼ä¸šä¸šåŠ¡é•¿æœŸç¨³å¥å‘å±•çš„åŸºçŸ³ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Paimonæºç è§£è¯» -- Compaction-2.KeyValueFileWriterFactory]]></title>    <link>https://juejin.cn/post/7581306080434339891</link>    <guid>https://juejin.cn/post/7581306080434339891</guid>    <pubDate>2025-12-08T10:29:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581306080434339891" data-draft-id="7580971667037650970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Paimonæºç è§£è¯» -- Compaction-2.KeyValueFileWriterFactory"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Flink"/> <meta itemprop="datePublished" content="2025-12-08T10:29:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="expect7g"/> <meta itemprop="url" content="https://juejin.cn/user/3514471387235735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Paimonæºç è§£è¯» -- Compaction-2.KeyValueFileWriterFactory
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3514471387235735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    expect7g
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:29:14.000Z" title="Mon Dec 08 2025 10:29:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šç¯‡æ–‡ç« <a href="https://juejin.cn/post/7577609608828239898" target="_blank" title="https://juejin.cn/post/7577609608828239898">Paimonæºç è§£è¯» -- Compaction-1.MergeTreeCompactTask</a>è§£æäº†Paimon-Compactioné˜¶æ®µçš„å¤§æ¦‚æµç¨‹ï¼Œè€Œæœ€åå‘ç°ï¼ŒçœŸæ­£å»å°†æ–‡ä»¶é‡‡ç”¨ç‰¹ç‚¹ç®—æ³•åˆå¹¶çš„ç±»æ˜¯<code>KeyValueFileWriterFactoryä¸­createRollingMergeTreeFileWriter()å’ŒcreateRollingChangelogFileWriter()</code>åˆ›å»ºçš„---<code>RollingFileWriter</code></p>
<h2 data-id="heading-1">ä¸€.KeyValueFileWriterFactoryä¸­çš„ä¸¤ä¸ªæ ¸å¿ƒè°ƒç”¨æ–¹æ³•</h2>
<h3 data-id="heading-2">1.<code>createRollingMergeTreeFileWriter()</code>å’Œ<code>createRollingChangelogFileWriter()</code></h3>
<h4 data-id="heading-3">(1) ä¿©æ–¹æ³•ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> RollingFileWriter&lt;KeyValue, DataFileMeta&gt; <span class="hljs-title function_">createRollingMergeTreeFileWriter</span><span class="hljs-params">(
    <span class="hljs-type">int</span> level, FileSource fileSource)</span> {
<span class="hljs-comment">// åˆ›å»ºRollingFileWriterï¼Œåç»­ç”±å…¶è¿›è¡Œå†™å…¥åˆå¹¶æ“ä½œ</span>
<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RollingFileWriter</span>&lt;&gt;(
        () -&gt;
                createDataFileWriter(
                        formatContext.pathFactory(level).newPath(),
                        level, 
                        fileSource), <span class="hljs-comment">// åˆ›å»ºSingleFileWriterå†™å…¥å™¨ï¼Œè¿™é‡Œçš„å‚æ•°æ˜¯æ‡’åŠ è½½SupplieråŒ…è£…çš„</span>
        suggestedFileSize <span class="hljs-comment">// è¿™é‡ŒsuggestedFileSizeå…¶å®å°±æ˜¯é…ç½®çš„target-file-sizeå¤§å°</span>
    );
}

<span class="hljs-keyword">public</span> RollingFileWriter&lt;KeyValue, DataFileMeta&gt; <span class="hljs-title function_">createRollingChangelogFileWriter</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span> {
<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RollingFileWriter</span>&lt;&gt;(
        () -&gt;
                createDataFileWriter(
                        formatContext.pathFactory(level).newChangelogPath(), <span class="hljs-comment">// å’Œä¸Šé¢çš„createRollingMergeTreeFileWriter()çš„å‚æ•°ä¸åŒ</span>
                        level,
                        FileSource.APPEND),
        suggestedFileSize);
}
</code></pre>
<h4 data-id="heading-4">(2) è°ƒç”¨çš„<code>createDataFileWriter()</code></h4>
<p>ä½œç”¨ï¼šå¼€å¯ç˜¦æ¨¡å¼(<code>é…ç½®'data-file.thin-mode'ç»‘å®šï¼Œé»˜è®¤æ˜¯false</code>)ï¼Œé‡‡ç”¨<code>KeyValueThinDataFileWriterImpl</code>ï¼›å¦åˆ™ï¼Œéƒ½æ˜¯æ™®é€šæ¨¡å¼ï¼Œé‡‡ç”¨<code>KeyValueDataFileWriterImpl</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> KeyValueDataFileWriter <span class="hljs-title function_">createDataFileWriter</span><span class="hljs-params">(
    Path path, <span class="hljs-type">int</span> level, FileSource fileSource)</span> {
<span class="hljs-keyword">return</span> formatContext.thinModeEnabled() <span class="hljs-comment">// æ˜¯å¦å¼€å¯ç˜¦æ¨¡å¼ï¼Œé€šè¿‡é…ç½®'data-file.thin-mode'ç»‘å®šï¼Œé»˜è®¤æ˜¯false</span>
        ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeyValueThinDataFileWriterImpl</span>( <span class="hljs-comment">// ç˜¦æ¨¡å¼ï¼šä»…å­˜å‚¨å¢é‡å˜æ›´æ›´æ•°æ®</span>
                fileIO,
                formatContext.writerFactory(level),
                path,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeyValueThinSerializer</span>(keyType, valueType)::toRow,
                keyType,
                valueType,
                formatContext.extractor(level),
                schemaId,
                level,
                formatContext.compression(level),
                options,
                fileSource,
                fileIndexOptions)
        : <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeyValueDataFileWriterImpl</span>( <span class="hljs-comment">// æ™®é€šæ¨¡å¼ï¼šå­˜å‚¨å®Œæ•´æ•°æ®ï¼Œå…¨é‡å†™å…¥/è¦†ç›–</span>
                fileIO,
                formatContext.writerFactory(level),
                path,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeyValueSerializer</span>(keyType, valueType)::toRow,
                keyType,
                valueType,
                formatContext.extractor(level),
                schemaId,
                level,
                formatContext.compression(level),
                options,
                fileSource,
                fileIndexOptions);
}
</code></pre>
<h3 data-id="heading-5">2.æ¶‰åŠçš„<code>SingleFileWriter</code>ç±»</h3>
<p>æ•´ä½“çš„æƒ…å†µå¦‚ä¸‹
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/078bf93c8f3a426991b19d1402e878f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZXhwZWN0N2c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765794554&amp;x-signature=w64knDxjlrrVQlKIoaoUZA%2FzlJc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">(1) <code>SingleFileWriterç±»</code> -- æ ¸å¿ƒ1</h4>
<h5 data-id="heading-7">&lt;1&gt; å±æ€§å’Œæ„é€ å‡½æ•°</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">LOG</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(SingleFileWriter.class);

<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> FileIO fileIO; <span class="hljs-comment">// æŠ½è±¡æ–‡ä»¶IOæ¥å£</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Path path; <span class="hljs-comment">// è·¯å¾„</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Function&lt;T, InternalRow&gt; converter; <span class="hljs-comment">// ç±»å‹è½¬æ¢å™¨ï¼Œå°†åŸå§‹kvè®°å½•è½¬ä¸ºPaimonå†…éƒ¨è¡Œçš„InternalRowç±»å‹</span>

<span class="hljs-keyword">private</span> FormatWriter writer; <span class="hljs-comment">// å†™å…¥å™¨</span>
<span class="hljs-keyword">private</span> PositionOutputStream out; <span class="hljs-comment">// æ–‡ä»¶è¾“å‡ºæµ</span>

<span class="hljs-keyword">private</span> <span class="hljs-type">long</span> recordCount; <span class="hljs-comment">// å†™å…¥çš„è®°å½•æ•°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> closed; <span class="hljs-comment">// æ˜¯å¦å…³é—­å†™å…¥å™¨</span>

<span class="hljs-keyword">public</span> <span class="hljs-title function_">SingleFileWriter</span><span class="hljs-params">(
        FileIO fileIO,
        FormatWriterFactory factory,
        Path path,
        Function&lt;T, InternalRow&gt; converter,
        String compression,
        <span class="hljs-type">boolean</span> asyncWrite)</span> {
    <span class="hljs-built_in">this</span>.fileIO = fileIO;
    <span class="hljs-built_in">this</span>.path = path;
    <span class="hljs-built_in">this</span>.converter = converter;

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 1.åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµï¼Œå¼‚æ­¥æˆ–è€…åŒæ­¥</span>
        out = fileIO.newOutputStream(path, <span class="hljs-literal">false</span>); <span class="hljs-comment">// falseè¯´æ˜ä¸æ˜¯overwriteè¦†ç›–æ“ä½œï¼Œè€Œæ˜¯intoæ“ä½œ</span>
        <span class="hljs-keyword">if</span> (asyncWrite) {
            out = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncPositionOutputStream</span>(out);
        }
        <span class="hljs-comment">// æ­¥éª¤2ï¼šåˆ›å»ºå…·ä½“æ ¼å¼çš„å†™å…¥å™¨ï¼ˆå¦‚ParquetWriterï¼‰</span>
        writer = factory.create(out, compression);
    } <span class="hljs-keyword">catch</span> (IOException e) {
        LOG.warn(
                <span class="hljs-string">"Failed to open the bulk writer, closing the output stream and throw the error."</span>,
                e);
        <span class="hljs-keyword">if</span> (out != <span class="hljs-literal">null</span>) {
            abort();
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UncheckedIOException</span>(e);
    }
    <span class="hljs-comment">// 3.åˆå§‹åŒ–è®°å½•æ•°å’Œclosed</span>
    <span class="hljs-built_in">this</span>.recordCount = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.closed = <span class="hljs-literal">false</span>;
}
</code></pre>
<h5 data-id="heading-8">&lt;2&gt; <code>write()å’ŒwriteBundle()</code></h5>
<p>å†™å…¥çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹</p>
<ol>
<li>å°†recordè½¬ä¸ºPaimonå†…éƒ¨è¡Œç±»å‹<code>InternalRow</code></li>
<li>è°ƒç”¨å†™å…¥å™¨å»å°†è½¬åçš„æ•°æ®å†™å…¥</li>
<li>è®°å½•å†™å…¥æ•°æ®é‡</li>
<li>æµå¼è¿”å›è½¬æ¢åçš„æ•°æ®ä¾›å­ç±»ç»Ÿè®¡æ”¶é›†ï¼›æ‰¹å¼ä»€ä¹ˆä¹Ÿä¸è¿”å›</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æµå¼å†™å…¥</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(T record)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-comment">// è°ƒwriteImplå»å†™å…¥æ•°æ®</span>
    writeImpl(record);
}

<span class="hljs-comment">// æ‰¹é‡å†™å…¥</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeBundle</span><span class="hljs-params">(BundleRecords bundle)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">if</span> (closed) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Writer has already closed!"</span>);
    }

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// CASE-1: å†™å…¥å™¨ instanceof BundleFormatWriter</span>
        <span class="hljs-keyword">if</span> (writer <span class="hljs-keyword">instanceof</span> BundleFormatWriter) {
            ((BundleFormatWriter) writer).writeBundle(bundle); <span class="hljs-comment">// è°ƒæ‰¹é‡å†™å…¥å™¨çš„writeBundle()æ–¹æ³•å»å†™å…¥</span>
        } 
        <span class="hljs-comment">// CASE-2: å†™å…¥å™¨ä¸æ˜¯BundleFormatWriterå®ç°ç±»</span>
        <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// éå†æ‰¹ï¼Œè¿›è¡Œä¸€æ¡ä¸€æ¡write</span>
            <span class="hljs-keyword">for</span> (InternalRow row : bundle) {
                writer.addElement(row);
            }
        }
        <span class="hljs-comment">// è®°å½•æ‰¹é‡å†™å…¥æ•°æ®</span>
        recordCount += bundle.rowCount();
    } <span class="hljs-keyword">catch</span> (Throwable e) {
        LOG.warn(<span class="hljs-string">"Exception occurs when writing file "</span> + path + <span class="hljs-string">". Cleaning up."</span>, e);
        abort();
        <span class="hljs-keyword">throw</span> e;
    }
}

<span class="hljs-comment">// æ ¸å¿ƒå†™å…¥é€»è¾‘</span>
<span class="hljs-keyword">protected</span> InternalRow <span class="hljs-title function_">writeImpl</span><span class="hljs-params">(T record)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">if</span> (closed) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Writer has already closed!"</span>);
    }

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 1.å°†recordè½¬ä¸ºPaimonå†…éƒ¨è¡Œç±»å‹InternalRow</span>
        <span class="hljs-type">InternalRow</span> <span class="hljs-variable">rowData</span> <span class="hljs-operator">=</span> converter.apply(record);
        <span class="hljs-comment">// 2.è°ƒç”¨å†™å…¥å™¨ï¼ˆå¦‚ParquetWriterï¼‰å»å°†rowDataå†™å…¥</span>
        writer.addElement(rowData);
        <span class="hljs-comment">// 3.å†™å…¥è®°å½•æ•°++</span>
        recordCount++;
        <span class="hljs-comment">// 4.è¿”å›è½¬æ¢åçš„è¡Œæ•°æ®ï¼ˆä¾›å­ç±»ç»Ÿè®¡æ”¶é›†ä½¿ç”¨ï¼‰</span>
        <span class="hljs-keyword">return</span> rowData;
    } <span class="hljs-keyword">catch</span> (Throwable e) {
        LOG.warn(<span class="hljs-string">"Exception occurs when writing file "</span> + path + <span class="hljs-string">". Cleaning up."</span>, e);
        abort();
        <span class="hljs-keyword">throw</span> e;
    }
}
</code></pre>
<h5 data-id="heading-9">&lt;3&gt; <code>recordCount()å’ŒreachTargetSize()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿”å›å·²è®°å½•çš„å†™å…¥æ€»æ•°</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">recordCount</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> recordCount;
}

<span class="hljs-comment">// æ–‡ä»¶æ»šåŠ¨çš„æ ‡è®°ï¼Œåç»­ç”±RollingFileWriterå»è°ƒç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">reachTargetSize</span><span class="hljs-params">(<span class="hljs-type">boolean</span> suggestedCheck, <span class="hljs-type">long</span> targetSize)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-comment">// æ£€æŸ¥å·²å†™å…¥çš„æ–‡ä»¶æ˜¯å¦è¾¾åˆ°äº†ç›®æ ‡æ–‡ä»¶å¤§å°target-file-size</span>
    <span class="hljs-keyword">return</span> writer.reachTargetSize(suggestedCheck, targetSize);
}
</code></pre>
<h5 data-id="heading-10">&lt;4&gt; <code>abort()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸­æ­¢å†™å…¥ï¼Œå¹¶æ¸…ç†èµ„æºå’Œæ–‡ä»¶</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">abort</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// å…³é—­å†™å…¥å™¨</span>
    <span class="hljs-keyword">if</span> (writer != <span class="hljs-literal">null</span>) {
        IOUtils.closeQuietly(writer);
        writer = <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// å…³é—­è¾“å‡ºæµ</span>
    <span class="hljs-keyword">if</span> (out != <span class="hljs-literal">null</span>) {
        IOUtils.closeQuietly(out);
        out = <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// åˆ é™¤è¯¥pathè·¯å¾„ä¸‹å†™å…¥çš„æ–‡ä»¶</span>
    fileIO.deleteQuietly(path);
}
</code></pre>
<h4 data-id="heading-11">(2) <code>StatsCollectingSingleFileWriterç±»</code></h4>
<h5 data-id="heading-12">&lt;1&gt; å±æ€§å’Œæ„é€ å‡½æ•°</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SimpleStatsExtractor simpleStatsExtractor; <span class="hljs-comment">// æ‰¹é‡å†™å…¥åœºæ™¯ä¸‹ï¼Œä»æ–‡ä»¶ä¸­æå–çš„å­—æ®µç»Ÿè®¡ä¿¡æ¯</span>
<span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> <span class="hljs-type">SimpleStatsCollector</span> <span class="hljs-variable">simpleStatsCollector</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æµå¼å†™å…¥åœºæ™¯ä¸‹ï¼Œå®æ—¶æ”¶é›†çš„å­—æ®µç»Ÿè®¡ä¿¡æ¯</span>
<span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> SimpleColStats[] noneStats = <span class="hljs-literal">null</span>; <span class="hljs-comment">// ç¦ç”¨ç»Ÿè®¡æ—¶çš„é»˜è®¤å€¼ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯SimpleColStats.NONE</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> isStatsDisabled; <span class="hljs-comment">// æ˜¯å¦ç¦ç”¨ç»Ÿè®¡æ”¶é›†ï¼Œè‹¥æ‰€æœ‰å­—æ®µçš„ç»Ÿè®¡æ”¶é›†å™¨éƒ½æ˜¯NoneSimpleColStatsCollectorï¼Œåˆ™ä¸º true</span>

<span class="hljs-keyword">public</span> <span class="hljs-title function_">StatsCollectingSingleFileWriter</span><span class="hljs-params">(
        FileIO fileIO,
        FormatWriterFactory factory,
        Path path,
        Function&lt;T, InternalRow&gt; converter,
        RowType writeSchema,
        <span class="hljs-meta">@Nullable</span> SimpleStatsExtractor simpleStatsExtractor,
        String compression,
        SimpleColStatsCollector.Factory[] statsCollectors,
        <span class="hljs-type">boolean</span> asyncWrite)</span> {
    <span class="hljs-comment">// 1.è°ƒç”¨çˆ¶ç±»SingleFileWriterçš„æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">super</span>(fileIO, factory, path, converter, compression, asyncWrite);
    <span class="hljs-comment">// 2.åˆå§‹åŒ–</span>
    <span class="hljs-built_in">this</span>.simpleStatsExtractor = simpleStatsExtractor;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.simpleStatsExtractor == <span class="hljs-literal">null</span>) {
        <span class="hljs-built_in">this</span>.simpleStatsCollector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleStatsCollector</span>(writeSchema, statsCollectors);
    }
    Preconditions.checkArgument(
            statsCollectors.length == writeSchema.getFieldCount(),
            <span class="hljs-string">"The stats collector is not aligned to write schema."</span>);
    <span class="hljs-built_in">this</span>.isStatsDisabled =
            Arrays.stream(SimpleColStatsCollector.create(statsCollectors))
                    .allMatch(p -&gt; p <span class="hljs-keyword">instanceof</span> NoneSimpleColStatsCollector);
    <span class="hljs-keyword">if</span> (isStatsDisabled) {
        <span class="hljs-built_in">this</span>.noneStats =
                IntStream.range(<span class="hljs-number">0</span>, statsCollectors.length)
                        .mapToObj(i -&gt; SimpleColStats.NONE)
                        .toArray(SimpleColStats[]::<span class="hljs-keyword">new</span>);
    }
}
</code></pre>
<h5 data-id="heading-13">&lt;2&gt; <code>write()</code>å’Œ<code>writeBundle()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(T record)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-comment">// æ­¥1.è°ƒç”¨çˆ¶ç±»SingleFileWriter.writeImpl()ï¼Œå°†è®°å½•åºåˆ—åŒ–å¹¶å†™å…¥æ–‡ä»¶ä¸­ï¼Œè¿”å›åºåˆ—åŒ–åçš„InternalRow</span>
    <span class="hljs-type">InternalRow</span> <span class="hljs-variable">rowData</span> <span class="hljs-operator">=</span> writeImpl(record);
    <span class="hljs-comment">// æ­¥2.è‹¥å¼€å¯å®æ—¶ç»Ÿè®¡ï¼Œåˆ™è°ƒç”¨SimpleStatsCollector.collect()æ”¶é›†å½“å‰è®°å½•çš„å­—æ®µç»Ÿè®¡</span>
    <span class="hljs-keyword">if</span> (simpleStatsCollector != <span class="hljs-literal">null</span> &amp;&amp; !simpleStatsCollector.isDisabled()) {
        simpleStatsCollector.collect(rowData);
    }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeBundle</span><span class="hljs-params">(BundleRecords bundle)</span> <span class="hljs-keyword">throws</span> IOException {
    Preconditions.checkState(
            simpleStatsExtractor != <span class="hljs-literal">null</span>,
            <span class="hljs-string">"Can't write bundle without simpleStatsExtractor, we may lose all the statistical information"</span>);
    <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»SingleFileWriteræ‰¹é‡å†™å…¥é€»è¾‘ï¼ˆä¸å®æ—¶æ”¶é›†ç»Ÿè®¡ï¼Œåç»­ä»æ–‡ä»¶æå–ï¼‰</span>
    <span class="hljs-built_in">super</span>.writeBundle(bundle);
}
</code></pre>
<h5 data-id="heading-14">&lt;3&gt; <code>fieldStats()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æå–æœ€ç»ˆçš„å­—æ®µç»Ÿè®¡ä¿¡æ¯</span>
<span class="hljs-keyword">public</span> SimpleColStats[] fieldStats() <span class="hljs-keyword">throws</span> IOException {
    Preconditions.checkState(closed, <span class="hljs-string">"Cannot access metric unless the writer is closed."</span>);
    <span class="hljs-comment">// CASE-1: æ‰¹é‡å†™å…¥åœºæ™¯ï¼Œä»æ–‡ä»¶ä¸­æå–</span>
    <span class="hljs-keyword">if</span> (simpleStatsExtractor != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (isStatsDisabled) {
            <span class="hljs-keyword">return</span> noneStats;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> simpleStatsExtractor.extract(fileIO, path);
        }
    }
    <span class="hljs-comment">// CASE-2: å•æ¡å†™å…¥åœºæ™¯ï¼Œä»SimpleStatsCollectorå®æ—¶æ”¶é›†å™¨ä¸­æå–</span>
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> simpleStatsCollector.extract();
    }
}
</code></pre>
<h4 data-id="heading-15">(3) <code>KeyValueDataFileWriterç±»</code> -- æ ¸å¿ƒ2</h4>
<h5 data-id="heading-16">&lt;1&gt; ç›¸å…³å±æ€§</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">LOG</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(KeyValueDataFileWriter.class);  
<span class="hljs-comment">// å…¬å…±çŠ¶æ€å±æ€§  </span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> RowType keyType;  
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> RowType valueType;  
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> schemaId; <span class="hljs-comment">// Schemaç‰ˆæœ¬ID  </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> level; <span class="hljs-comment">// æ–‡ä»¶æ‰€å±levelå±‚çº§  </span>
  
<span class="hljs-comment">// ç»Ÿè®¡ä¿¡æ¯ç›¸å…³  </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SimpleStatsConverter keyStatsConverter; <span class="hljs-comment">// Keyç»Ÿè®¡ä¿¡æ¯è½¬æ¢å™¨ï¼ˆå°† SimpleColStats è½¬ä¸ºäºŒè¿›åˆ¶å­˜å‚¨çš„ SimpleStatsï¼‰  </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SimpleStatsConverter valueStatsConverter; <span class="hljs-comment">// Valueç»Ÿè®¡ä¿¡æ¯è½¬æ¢å™¨ï¼ˆå°† SimpleColStats è½¬ä¸ºäºŒè¿›åˆ¶å­˜å‚¨çš„ SimpleStatsï¼‰  </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> InternalRowSerializer keySerializer;  
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> FileSource fileSource;  
<span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DataFileIndexWriter dataFileIndexWriter; <span class="hljs-comment">// æ–‡ä»¶ç´¢å¼•å†™å…¥å™¨ï¼ˆç”Ÿæˆå¸ƒéš†è¿‡æ»¤å™¨ / åŒºé—´ç´¢å¼•ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼‰  </span>
  
<span class="hljs-comment">// ç”¨äºæŸ¥è¯¢æ—¶ï¼Œå¿«é€Ÿè¿‡æ»¤  </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">BinaryRow</span> <span class="hljs-variable">minKey</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// å†™å…¥æ–‡ä»¶çš„æœ€å°ä¸»é”®  </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">InternalRow</span> <span class="hljs-variable">maxKey</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// å†™å…¥æ–‡ä»¶çš„æœ€å¤§ä¸»  </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">minSeqNumber</span> <span class="hljs-operator">=</span> Long.MAX_VALUE; <span class="hljs-comment">// å†™å…¥æ–‡ä»¶æœ€å°sequenceNumber  </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">maxSeqNumber</span> <span class="hljs-operator">=</span> Long.MIN_VALUE; <span class="hljs-comment">// å†™å…¥æ–‡ä»¶æœ€å¤§sequenceNumber  </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">deleteRecordCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// å†™å…¥æ–‡ä»¶åˆ é™¤è®°å½•æ•°</span>
</code></pre>
<h5 data-id="heading-17">&lt;2&gt; æ„é€ å‡½æ•°</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">KeyValueDataFileWriter</span><span class="hljs-params">(
        FileIO fileIO,
        FormatWriterFactory factory,
        Path path,
        Function&lt;KeyValue, InternalRow&gt; converter,
        RowType keyType,
        RowType valueType,
        RowType writeRowType,
        <span class="hljs-meta">@Nullable</span> SimpleStatsExtractor simpleStatsExtractor,
        <span class="hljs-type">long</span> schemaId,
        <span class="hljs-type">int</span> level,
        String compression,
        CoreOptions options,
        FileSource fileSource,
        FileIndexOptions fileIndexOptions)</span> {
    <span class="hljs-comment">// 1.è°ƒç”¨çˆ¶ç±»StatsCollectingSingleFileWriterçš„æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">super</span>(
            fileIO,
            factory,
            path,
            converter,
            writeRowType,
            simpleStatsExtractor,
            compression,
            StatsCollectorFactories.createStatsFactories(
                    options, writeRowType.getFieldNames(), keyType.getFieldNames()),
            options.asyncFileWrite());
    <span class="hljs-comment">// 2.åˆå§‹åŒ–å…¬å…±çŠ¶æ€å±æ€§</span>
    <span class="hljs-built_in">this</span>.keyType = keyType;
    <span class="hljs-built_in">this</span>.valueType = valueType;
    <span class="hljs-built_in">this</span>.schemaId = schemaId;
    <span class="hljs-built_in">this</span>.level = level;
    <span class="hljs-comment">// 3.åˆå§‹åŒ–ç»Ÿè®¡ä¿¡æ¯ç›¸å…³å±æ€§</span>
    <span class="hljs-built_in">this</span>.keyStatsConverter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleStatsConverter</span>(keyType);
    <span class="hljs-built_in">this</span>.valueStatsConverter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleStatsConverter</span>(valueType, options.statsDenseStore());
    <span class="hljs-built_in">this</span>.keySerializer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InternalRowSerializer</span>(keyType);
    <span class="hljs-built_in">this</span>.fileSource = fileSource;
    <span class="hljs-built_in">this</span>.dataFileIndexWriter =
            DataFileIndexWriter.create(
                    fileIO, dataFileToFileIndexPath(path), valueType, fileIndexOptions);
}
</code></pre>
<h5 data-id="heading-18">&lt;3&gt; <code>write()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(KeyValue kv)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-comment">// æ­¥éª¤1.è°ƒçˆ¶ç±»StatsCollectingSingleFileWriter.write()ï¼Œå°†kvæ•°æ®åºåˆ—åŒ–å†™å…¥Data Fileä¸­</span>
    <span class="hljs-built_in">super</span>.write(kv);
    <span class="hljs-comment">// æ­¥éª¤2ï¼šå†™å…¥æ–‡ä»¶ç´¢å¼•ï¼ˆå¦‚å¸ƒéš†è¿‡æ»¤å™¨ï¼Œä¼˜åŒ–ç‚¹æŸ¥æ€§èƒ½ï¼‰</span>
    <span class="hljs-keyword">if</span> (dataFileIndexWriter != <span class="hljs-literal">null</span>) {
        dataFileIndexWriter.write(kv.value());
    }
    <span class="hljs-comment">// æ­¥éª¤3ï¼šæ›´æ–°min/max keyï¼ˆè¦æ±‚å†™å…¥è®°å½•å·²æ’åºï¼Œå¦åˆ™minKeyä»…å–ç¬¬ä¸€æ¡ï¼ŒmaxKeyå–æœ€åä¸€æ¡ï¼‰</span>
    updateMinKey(kv);
    updateMaxKey(kv);
    <span class="hljs-comment">// æ­¥éª¤4ï¼šæ›´æ–°æœ€å°/æœ€å¤§åºåˆ—å·ï¼ˆå¤„ç†ä¹±åºæ›´æ–°ï¼‰</span>
    updateMinSeqNumber(kv);
    updateMaxSeqNumber(kv);
    <span class="hljs-comment">// æ­¥éª¤5ï¼šç»Ÿè®¡åˆ é™¤è®°å½•æ•°ï¼ˆRetractç±»å‹ä¸ºåˆ é™¤ï¼‰</span>
    <span class="hljs-keyword">if</span> (kv.valueKind().isRetract()) {
        deleteRecordCount++;
    }

    <span class="hljs-keyword">if</span> (LOG.isDebugEnabled()) {
        LOG.debug(<span class="hljs-string">"Write to Path "</span> + path + <span class="hljs-string">" key value "</span> + kv.toString(keyType, valueType));
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMinKey</span><span class="hljs-params">(KeyValue kv)</span> {
    <span class="hljs-keyword">if</span> (minKey == <span class="hljs-literal">null</span>) {
        minKey = keySerializer.toBinaryRow(kv.key()).copy();
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMaxKey</span><span class="hljs-params">(KeyValue kv)</span> {
    maxKey = kv.key();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMinSeqNumber</span><span class="hljs-params">(KeyValue kv)</span> {
    minSeqNumber = Math.min(minSeqNumber, kv.sequenceNumber());
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMaxSeqNumber</span><span class="hljs-params">(KeyValue kv)</span> {
    maxSeqNumber = Math.max(maxSeqNumber, kv.sequenceNumber());
}
</code></pre>
<h5 data-id="heading-19">&lt;4&gt; <code>result()</code></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç”Ÿæˆæ–‡ä»¶å…ƒæ•°æ®</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-meta">@Nullable</span>
<span class="hljs-keyword">public</span> DataFileMeta <span class="hljs-title function_">result</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">if</span> (recordCount() == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// 1.è°ƒç”¨å­ç±»å®ç°çš„fetchKeyValueStatsï¼Œè·å–keyå’Œvalueçš„å…¨éƒ¨ç»Ÿè®¡ä¿¡æ¯</span>
    Pair&lt;SimpleColStats[], SimpleColStats[]&gt; keyValueStats = fetchKeyValueStats(fieldStats());
    <span class="hljs-comment">// 2.å°†keyå’Œvalueçš„ç»Ÿè®¡ä¿¡æ¯è½¬æ¢æˆäºŒè¿›åˆ¶å­˜å‚¨çš„SimpleStats</span>
    <span class="hljs-type">SimpleStats</span> <span class="hljs-variable">keyStats</span> <span class="hljs-operator">=</span> keyStatsConverter.toBinaryAllMode(keyValueStats.getKey());
    Pair&lt;List&lt;String&gt;, SimpleStats&gt; valueStatsPair =
            valueStatsConverter.toBinary(keyValueStats.getValue());
    <span class="hljs-comment">// 3.ç”Ÿæˆæ–‡ä»¶ç´¢å¼•ç»“æ„</span>
    DataFileIndexWriter.<span class="hljs-type">FileIndexResult</span> <span class="hljs-variable">indexResult</span> <span class="hljs-operator">=</span>
            dataFileIndexWriter == <span class="hljs-literal">null</span>
                    ? DataFileIndexWriter.EMPTY_RESULT
                    : dataFileIndexWriter.result();
    <span class="hljs-comment">// 4.æ„é€ DataFileMetaå…ƒæ•°æ®ä¿¡æ¯</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataFileMeta</span>(
            path.getName(),
            fileIO.getFileSize(path),
            recordCount(),
            minKey,
            keySerializer.toBinaryRow(maxKey).copy(),
            keyStats,
            valueStatsPair.getValue(),
            minSeqNumber,
            maxSeqNumber,
            schemaId,
            level,
            indexResult.independentIndexFile() == <span class="hljs-literal">null</span>
                    ? Collections.emptyList()
                    : Collections.singletonList(indexResult.independentIndexFile()),
            deleteRecordCount,
            indexResult.embeddedIndexBytes(),
            fileSource,
            valueStatsPair.getKey(),
            <span class="hljs-literal">null</span>);
}
</code></pre>
<h4 data-id="heading-20">(4) <code>KeyValueThinDataFileWriterImplç±»</code> -- ç˜¦æ¨¡å¼DFå†™å…¥å™¨</h4>
<p>é‡‡ç”¨ç˜¦æ¨¡å¼(<code>é…ç½®'data-file.thin-mode'ç»‘å®šï¼Œé»˜è®¤æ˜¯false</code>)ï¼ŒData FileåªåŒ…å«<code>_SEQUENCE_NUMBER_å’Œ_ROW_KIND_å’Œvalueå­—æ®µ</code>ï¼Œä¸å­˜å‚¨keyå­—æ®µ</p>
<h5 data-id="heading-21">&lt;1&gt; æ„é€ å‡½æ•°</h5>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>çˆ¶ç±»æ„é€ è°ƒç”¨</li>
<li>æ„å»ºæ‰€æœ‰å­—æ®µID-&gt;å­—æ®µç´¢å¼•çš„æ˜ å°„ï¼Œæ”¾å…¥idToIndexsçš„Mapä¸­ï¼Œç»“æ„ä¸ºï¼š<code>[å­—æ®µ1-&gt;ç´¢å¼•3, å­—æ®µ2-&gt;ç´¢å¼•7, ...]</code></li>
<li>è·å–keyå­—æ®µç´¢å¼•åœ¨idToIndexä¸­å¯¹åº”çš„å­—æ®µç´¢å¼•ï¼Œæ”¾å…¥keyStatMappingæ•°ç»„ä¸­ï¼Œç»“æ„ä¸ºï¼š<code>[keyå­—æ®µ1:ç´¢å¼•1, keyå­—æ®µ2:ç´¢å¼•3, ...]</code></li>
</ol>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä¸»é”®å­—æ®µID = ä¸»é”®keyçš„æ˜ å°„ID - SpecialFields.KEY_FIELD_ID_STARTï¼Œå…¶å®å°±æ˜¯ä¸»é”®keyçš„æ˜ å°„ID - Integer.MAX_VALUE / 2ï¼Œwhyï¼Ÿå› ä¸ºåº•å±‚Keyçš„æ˜ å°„idä¸ºID = 1073741823 + (field-id)ï¼Œå› æ­¤ï¼Œéœ€è¦å‡å»1073741823(ä¹Ÿå°±æ˜¯Integer.MAX_VALUE / 2)</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">KeyValueThinDataFileWriterImpl</span><span class="hljs-params">(
    FileIO fileIO,
    FormatWriterFactory factory,
    Path path,
    Function&lt;KeyValue, InternalRow&gt; converter,
    RowType keyType,
    RowType valueType,
    <span class="hljs-meta">@Nullable</span> SimpleStatsExtractor simpleStatsExtractor,
    <span class="hljs-type">long</span> schemaId,
    <span class="hljs-type">int</span> level,
    String compression,
    CoreOptions options,
    FileSource fileSource,
    FileIndexOptions fileIndexOptions)</span> {
        <span class="hljs-built_in">super</span>(
                fileIO,
                factory,
                path,
                converter,
                keyType,
                valueType,
                KeyValue.schema(RowType.of(), valueType), <span class="hljs-comment">// ä¸ä¼ å…¥keyçš„schemaï¼Œåªä¼ å…¥valueçš„schema</span>
                simpleStatsExtractor,
                schemaId,
                level,
                compression,
                options,
                fileSource,
                fileIndexOptions); <span class="hljs-comment">// çˆ¶ç±»æ„é€ è°ƒç”¨</span>
        <span class="hljs-comment">// æ­¥1.æ„å»ºæ‰€æœ‰å­—æ®µID-&gt;å­—æ®µç´¢å¼•çš„æ˜ å°„ï¼Œæ”¾å…¥idToIndex</span>
        Map&lt;Integer, Integer&gt; idToIndex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(valueType.getFieldCount());
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; valueType.getFieldCount(); i++) {
            idToIndex.put(valueType.getFields().get(i).id(), i);
        }
        <span class="hljs-comment">// æ­¥2.è·å–keyå­—æ®µç´¢å¼•åœ¨idToIndexä¸­å¯¹åº”çš„å­—æ®µç´¢å¼•ï¼Œæ”¾å…¥keyStatMappingæ•°ç»„ä¸­</span>
        <span class="hljs-built_in">this</span>.keyStatMapping = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[keyType.getFieldCount()];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; keyType.getFieldCount(); i++) {
            keyStatMapping[i] =
                    idToIndex.get(
                            <span class="hljs-comment">// æ³¨æ„ï¼šä¸»é”®å­—æ®µID = ä¸»é”®keyçš„æ˜ å°„ID - SpecialFields.KEY_FIELD_ID_STARTï¼Œå…¶å®å°±æ˜¯ä¸»é”®keyçš„æ˜ å°„ID - Integer.MAX_VALUE / 2ï¼Œwhyï¼Ÿ</span>
                            <span class="hljs-comment">// å› ä¸ºåº•å±‚Keyçš„æ˜ å°„idä¸ºID = 1073741823 + (field-id)ï¼Œå› æ­¤éœ€è¦å‡å»1073741823(ä¹Ÿå°±æ˜¯Integer.MAX_VALUE / 2)</span>
                            keyType.getFields().get(i).id() - SpecialFields.KEY_FIELD_ID_START);
        }
}
</code></pre>
<h5 data-id="heading-22">&lt;2&gt; <code>fetchKeyValueStats()</code> -- æå–keyå’Œvalueçš„ç»Ÿè®¡ä¿¡æ¯</h5>
<p>ç˜¦æ¨¡å¼ä¸‹rowStatsç»“æ„ï¼š<code>[0:_SEQUENCE_NUMBER_, 1:_ROW_KIND_, 2:valueå­—æ®µ1, 3:valueå­—æ®µ2, ...]</code></p>
<p>å› æ­¤ï¼Œæ•°ç»„éœ€è¦ä»ç¬¬3ä¸ªä½ç½®å¼€å§‹æˆªæ–­ï¼Œæœ€åçš„ç»“æ„ï¼š<code>[0:valueå­—æ®µ1, 1:valueå­—æ®µ2, ...]</code>
ç„¶åæ ¹æ®æ„é€ å‡½æ•°è·å–çš„<code>keyStatMapping</code>ä¸­å­˜å‚¨çš„keyå­—æ®µå¯¹åº”çš„ç´¢å¼•ä½ç½®ï¼Œå»è·å–keyçš„å€¼ï¼Œå½¢æˆkeyStatsï¼Œæœ€ååŒ…è£…æˆ<code>Pair.of(keyStats, valFieldStats)</code>è¿”å›</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è·å–keyå’Œvalueçš„ç»Ÿè®¡ä¿¡æ¯
 * <span class="hljs-doctag">@param</span> rowStats
 * <span class="hljs-doctag">@return</span>
 */</span>
<span class="hljs-meta">@Override</span>
Pair&lt;SimpleColStats[], SimpleColStats[]&gt; fetchKeyValueStats(SimpleColStats[] rowStats) {
    <span class="hljs-type">int</span> <span class="hljs-variable">numKeyFields</span> <span class="hljs-operator">=</span> keyType.getFieldCount();

    <span class="hljs-comment">// æ­¥éª¤1ï¼šæˆªå–valueå­—æ®µçš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆè·³è¿‡å‰2ä¸ªï¼š_SEQUENCE_NUMBER_ã€_ROW_KIND_ï¼‰</span>
    <span class="hljs-comment">// ç˜¦æ¨¡å¼ä¸‹rowStatsç»“æ„ï¼š[0:_SEQUENCE_NUMBER_, 1:_ROW_KIND_, 2:valueå­—æ®µ1, 3:valueå­—æ®µ2, ...]</span>
    SimpleColStats[] valFieldStats = Arrays.copyOfRange(rowStats, <span class="hljs-number">2</span>, rowStats.length);
    <span class="hljs-comment">// æœ€åvalFieldStatsçš„ç»“æ„ï¼š[0:valueå­—æ®µ1, 1:valueå­—æ®µ2, ...]</span>

    <span class="hljs-comment">// æ­¥éª¤2ï¼šä»valueç»Ÿè®¡ä¸­æ˜ å°„å‡ºkeyç»Ÿè®¡ï¼ˆæ ¸å¿ƒï¼šä½¿ç”¨keyStatMappingï¼‰</span>
    SimpleColStats[] keyStats = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleColStats</span>[numKeyFields];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; keyStatMapping.length; i++) {
        <span class="hljs-comment">// keyStatMapping[i]æ˜¯æ„é€ å‡½æ•°é˜¶æ®µæ„é€ å¥½çš„keyå­—æ®µå¯¹åº”çš„ç´¢å¼•ä½ç½®ï¼Œä»valFieldStatsä¸­å–å¯¹åº”ç»Ÿè®¡</span>
        <span class="hljs-comment">// æ¯”å¦‚keyStatMappingä¸­å­˜çš„ç´¢å¼•æ˜¯[1,3,4,2]ï¼Œé‚£ä¹ˆå°±å»valFieldStatsæ•°æ®ä¸­ï¼Œå–[1,3,4,2]è¿™å‡ ä¸ªä½ç½®çš„å€¼ï¼Œç„¶ååˆæˆkeyStats</span>
        keyStats[i] = valFieldStats[keyStatMapping[i]];
    }

    <span class="hljs-keyword">return</span> Pair.of(keyStats, valFieldStats); <span class="hljs-comment">// è¿”å›keyç»Ÿè®¡å’Œvalueç»Ÿè®¡ï¼Œå¯¹äºç˜¦æ¨¡å¼æ¥è¯´ï¼Œå…¨éƒ¨éƒ½æ˜¯valueï¼Œå› æ­¤valFieldStatsåŸå°ä¸åŠ¨ï¼Œä¸éœ€è¦æŠŠkeyçš„ç§»é™¤</span>
}
</code></pre>
<h4 data-id="heading-23">(5) <code>KeyValueDataFileWriterImplç±»</code> -- æ™®é€šæ¨¡å¼DFå†™å…¥å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KeyValueDataFileWriterImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">KeyValueDataFileWriter</span> {

<span class="hljs-keyword">public</span> <span class="hljs-title function_">KeyValueDataFileWriterImpl</span><span class="hljs-params">(
        FileIO fileIO,
        FormatWriterFactory factory,
        Path path,
        Function&lt;KeyValue, InternalRow&gt; converter,
        RowType keyType,
        RowType valueType,
        <span class="hljs-meta">@Nullable</span> SimpleStatsExtractor simpleStatsExtractor,
        <span class="hljs-type">long</span> schemaId,
        <span class="hljs-type">int</span> level,
        String compression,
        CoreOptions options,
        FileSource fileSource,
        FileIndexOptions fileIndexOptions)</span> {
    <span class="hljs-built_in">super</span>(
            fileIO,
            factory,
            path,
            converter,
            keyType,
            valueType,
            KeyValue.schema(keyType, valueType), <span class="hljs-comment">// ä¼ å…¥å®Œæ•´çš„schema(key+value)</span>
            simpleStatsExtractor,
            schemaId,
            level,
            compression,
            options,
            fileSource,
            fileIndexOptions);
}

<span class="hljs-meta">@Override</span>
Pair&lt;SimpleColStats[], SimpleColStats[]&gt; fetchKeyValueStats(SimpleColStats[] rowStats) {
    <span class="hljs-comment">// æ­¥éª¤1ï¼šè·å–ä¸»é”®å­—æ®µæ•°é‡</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">numKeyFields</span> <span class="hljs-operator">=</span> keyType.getFieldCount();
    <span class="hljs-comment">// æ­¥éª¤2ï¼šæ‹†åˆ†ç»Ÿè®¡ä¿¡æ¯å¹¶è¿”å›</span>
    <span class="hljs-keyword">return</span> Pair.of(
            <span class="hljs-comment">// ä¸»é”®ç»Ÿè®¡ï¼šæˆªå–rowStatså‰numKeyFieldsä¸ªï¼ˆ0 ~ numKeyFields-1ï¼‰</span>
            Arrays.copyOfRange(rowStats, <span class="hljs-number">0</span>, numKeyFields),
            <span class="hljs-comment">// å€¼ç»Ÿè®¡ï¼šè·³è¿‡ä¸»é”®+2ä¸ªç³»ç»Ÿå­—æ®µï¼ˆ_SEQUENCE_NUMBER_ã€_ROW_KIND_ï¼‰ï¼Œæˆªå–å‰©ä½™éƒ¨åˆ†</span>
            Arrays.copyOfRange(rowStats, numKeyFields + <span class="hljs-number">2</span>, rowStats.length ));
}
</code></pre>
<h2 data-id="heading-24">äºŒ.æ€»ç»“</h2>
<ol>
<li>æ•°æ®å†™å…¥æµç¨‹ï¼š ç±»<code>SingleFileWriter</code>çš„<code>write()</code>å®ç°çš„
<ol>
<li>å°†recordæ•°æ®è½¬ä¸ºPaimonå†…éƒ¨è¯†åˆ«çš„è¡Œç±»å‹<code>InternalRow</code></li>
<li>è°ƒç”¨å†™å…¥å™¨(å¦‚<code>ParquetWriter</code>)å°†è½¬åŒ–åçš„æ•°æ®å†™å…¥</li>
<li>è®°å½•å†™å…¥æ•°</li>
<li>æµå¼å†™å…¥ï¼Œè¿”å›<code>InternalRow</code>çš„æ•°æ®ï¼›æ‰¹å¼å†™å…¥ï¼Œä¸è¿”å›è¿™äº›</li>
</ol>
<blockquote>
<p><strong>æ‰¹é‡å†™å…¥æ³¨æ„</strong>ï¼š</p>
<ol>
<li>è‹¥å†™å…¥å™¨ä¸æ˜¯æ‰¹é‡å†™å…¥å™¨ï¼Œåˆ™éå†æ‰¹ï¼Œå»ä¸€ä¸ªä¸€ä¸ªå†™å…¥</li>
<li>è‹¥å†™å…¥å™¨æ˜¯æ‰¹é‡å†™å…¥å™¨ï¼Œåˆ™ç›´æ¥è°ƒå…¶<code>writeBundle()</code>å»æ‰¹é‡å†™å…¥</li>
</ol>
</blockquote>
<ol start="5">
<li>å­ç±»<code>KeyValueDataFileWriter</code>ä¼šç»§ç»­è®°å½•å†™å…¥çš„æ–‡ä»¶ç´¢å¼•ã€æ›´æ–°minå’Œmaxçš„ä¸»é”®ã€æ›´æ–°minå’Œmaxçš„sequnceNumberã€ç»Ÿè®¡å›æ’¤æ•°</li>
</ol>
</li>
<li>ç”Ÿæˆ<code>DataFileMeta</code>ï¼šç±»<code>KeyValueDataFileWriter</code>åŠå…¶å­ç±»å®ç°çš„
<ol>
<li>è°ƒç”¨å­ç±»å®ç°çš„<code>fetchKeyValueStats()</code>:è·å–Keyå’ŒValueçš„ç»Ÿè®¡ä¿¡æ¯</li>
<li>å°†Keyå’ŒValueçš„ç»Ÿè®¡ä¿¡æ¯è½¬ä¸ºäºŒè¿›åˆ¶å­˜å‚¨<code>SimpleStats</code></li>
<li>ç”Ÿæˆæ–‡ä»¶ç´¢å¼•ç»“æ„</li>
<li>æ„é€ <code>DataFileMeta</code>å…ƒæ•°æ®ä¿¡æ¯</li>
</ol>
</li>
<li>ç˜¦æ¨¡å¼è¡¥å……ï¼š<code>é…ç½®'data-file.thin-mode'ç»‘å®šï¼Œé»˜è®¤æ˜¯false</code>ï¼Œè¯¥æ¨¡å¼ä¸‹Data FileåªåŒ…å«<code>_SEQUENCE_NUMBER_å’Œ_ROW_KIND_å’Œvalueå­—æ®µ</code>ï¼Œä¸å­˜å‚¨keyå­—æ®µ
<ul>
<li>æ„é€ å‡½æ•°é˜¶æ®µï¼š
<ol>
<li>è°ƒçˆ¶ç±»æ„é€ å‡½æ•°</li>
<li>æ„å»ºæ‰€æœ‰å­—æ®µçš„IDå’Œç´¢å¼•æ˜ å°„mapï¼Œæ”¾å…¥<strong>idToIndexs</strong>ä¸­ï¼Œç»“æ„ä¸º:<code>[å­—æ®µ1-&gt;ç´¢å¼•2, å­—æ®µ2-&gt;ç´¢å¼•1, å­—æ®µ3-&gt;ç´¢å¼•3, ...]</code></li>
<li>è·å–Keyå­—æ®µç´¢å¼•ï¼Œæ”¾å…¥æ•°ç»„<strong>keyStatMapping</strong>ä¸­ï¼Œç»“æ„ä¸º:<code>[keyå­—æ®µ1:ç´¢å¼•1, keyå­—æ®µ2:ç´¢å¼•3, ...]</code></li>
</ol>
</li>
<li><code>fetchKeyValueStats()</code>:ç˜¦æ¨¡å¼ä¸‹rowStatsç»“æ„ä¸º:<code>[0:_SEQUENCE_NUMBER_, 1:_ROW_KIND_, 2:valueå­—æ®µ1, 3:valueå­—æ®µ2, ...]</code>
<ol>
<li>å°†rowStatsä»ç¬¬ä¸‰ä¸ªä½ç½®å¼€å§‹é˜¶æ®µï¼Œæœ€ç»ˆç»“æ„ä¸º:<code>[0:valueå­—æ®µ1, 1:valueå­—æ®µ2, ...]</code></li>
<li>æ ¹æ®<strong>keyStatMapping</strong>ä¸­å­˜å‚¨çš„keyå­—æ®µå¯¹åº”çš„ç´¢å¼•ä½ç½®ï¼Œå»è·å–keyçš„å€¼ç»™keyStats</li>
<li>æœ€ååŒ…è£…æˆ<code>Pair.of(keyStats, valFieldStats)</code>è¿”å›</li>
</ol>
</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼˜é›…çš„Reactè¡¨å•çŠ¶æ€ç®¡ç†]]></title>    <link>https://juejin.cn/post/7581117416811348011</link>    <guid>https://juejin.cn/post/7581117416811348011</guid>    <pubDate>2025-12-08T10:15:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581117416811348011" data-draft-id="7581097111896227894" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼˜é›…çš„Reactè¡¨å•çŠ¶æ€ç®¡ç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T10:15:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="dorisrv"/> <meta itemprop="url" content="https://juejin.cn/user/1522178380270712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼˜é›…çš„Reactè¡¨å•çŠ¶æ€ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1522178380270712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    dorisrv
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:15:58.000Z" title="Mon Dec 08 2025 10:15:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¼˜é›…çš„Reactè¡¨å•çŠ¶æ€ç®¡ç†</h2>
<p>ğŸŒ¸ ä½ æ˜¯å¦è¿˜åœ¨ä¸ºReactè¡¨å•ä¸­çš„é‡å¤çŠ¶æ€ç®¡ç†ä»£ç æ„Ÿåˆ°å›°æ‰°ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•ç”¨è‡ªå®šä¹‰Hookæ¥ä¼˜é›…åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï½</p>
<h3 data-id="heading-1">ä¼ ç»Ÿè¡¨å•ç®¡ç†çš„ç—›ç‚¹</h3>
<p>åœ¨Reactä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¿™æ ·ç®¡ç†è¡¨å•ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">LoginForm</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ¯ä¸ªå­—æ®µéƒ½éœ€è¦å•ç‹¬çš„state</span>
  <span class="hljs-keyword">const</span> [username, setUsername] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [password, setPassword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [email, setEmail] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">e</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-comment">// å¤„ç†è¡¨å•æäº¤</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({ username, password, email });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{username}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setUsername(e.target.value)} // æ¯ä¸ªå­—æ®µéƒ½éœ€è¦å•ç‹¬çš„onChange
        placeholder="ç”¨æˆ·å"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)}
        placeholder="å¯†ç "
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEmail(e.target.value)}
        placeholder="é‚®ç®±"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre>
<p>å½“è¡¨å•å­—æ®µå¢å¤šæ—¶ï¼Œè¿™ç§å†™æ³•ä¼šå˜å¾—éå¸¸ç¹çï¼š</p>
<ul>
<li>æ¯ä¸ªå­—æ®µéƒ½éœ€è¦å•ç‹¬çš„stateå’Œsetter</li>
<li>æ¯ä¸ªinputéƒ½éœ€è¦é‡å¤çš„onChangeé€»è¾‘</li>
<li>è¡¨å•æ•°æ®åˆ†æ•£åœ¨å¤šä¸ªstateä¸­ï¼Œä¸æ–¹ä¾¿ç»Ÿä¸€å¤„ç†</li>
</ul>
<h3 data-id="heading-2">ä¼˜é›…æ–¹æ¡ˆï¼šè‡ªå®šä¹‰useForm Hook</h3>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé€šç”¨çš„<code>useForm</code> Hookæ¥è§£å†³è¿™äº›é—®é¢˜ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">/**
 * é€šç”¨è¡¨å•çŠ¶æ€ç®¡ç†Hook
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">initialValues</span> - è¡¨å•åˆå§‹å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} åŒ…å«è¡¨å•å€¼ã€onChangeå¤„ç†å‡½æ•°å’Œé‡ç½®å‡½æ•°
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">useForm</span> = (<span class="hljs-params">initialValues</span>) =&gt; {
  <span class="hljs-comment">// ç”¨ä¸€ä¸ªå¯¹è±¡ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è¡¨å•å­—æ®µ</span>
  <span class="hljs-keyword">const</span> [values, setValues] = <span class="hljs-title function_">useState</span>(initialValues);

  <span class="hljs-comment">// é€šç”¨çš„onChangeå¤„ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-keyword">const</span> { name, value, type, checked } = e.<span class="hljs-property">target</span>;
    <span class="hljs-comment">// å¤„ç†å¤é€‰æ¡†ç­‰ç‰¹æ®Šç±»å‹</span>
    <span class="hljs-title function_">setValues</span>(<span class="hljs-function"><span class="hljs-params">prevValues</span> =&gt;</span> ({
      ...prevValues,
      [name]: type === <span class="hljs-string">'checkbox'</span> ? checked : value
    }));
  };

  <span class="hljs-comment">// é‡ç½®è¡¨å•åˆ°åˆå§‹çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resetForm</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setValues</span>(initialValues);
  };

  <span class="hljs-keyword">return</span> { values, handleChange, resetForm };
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">LoginForm</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä¸€è¡Œä»£ç åˆå§‹åŒ–æ•´ä¸ªè¡¨å•</span>
  <span class="hljs-keyword">const</span> { values, handleChange, resetForm } = <span class="hljs-title function_">useForm</span>({
    <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>
  });

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">e</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¡¨å•æ•°æ®:'</span>, values);
    <span class="hljs-comment">// æäº¤åé‡ç½®è¡¨å•</span>
    <span class="hljs-title function_">resetForm</span>();
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      {/* æ‰€æœ‰inputå…±ç”¨ä¸€ä¸ªhandleChange */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> // <span class="hljs-attr">æ³¨æ„nameå±æ€§è¦å’Œåˆå§‹å€¼çš„keyå¯¹åº”</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.username}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ç”¨æˆ·å"</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¯†ç "</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"é‚®ç®±"</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{resetForm}</span>&gt;</span>é‡ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-3">è¿›é˜¶ï¼šæ·»åŠ è¡¨å•éªŒè¯</h3>
<p>æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å¢å¼ºè¿™ä¸ªHookï¼Œæ·»åŠ è¡¨å•éªŒè¯åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">/**
 * å¸¦éªŒè¯çš„è¡¨å•çŠ¶æ€ç®¡ç†Hook
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">initialValues</span> - è¡¨å•åˆå§‹å€¼
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">validate</span> - éªŒè¯å‡½æ•°ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} è¡¨å•æ§åˆ¶å¯¹è±¡
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">useFormWithValidation</span> = (<span class="hljs-params">initialValues, validate</span>) =&gt; {
  <span class="hljs-keyword">const</span> [values, setValues] = <span class="hljs-title function_">useState</span>(initialValues);
  <span class="hljs-keyword">const</span> [errors, setErrors] = <span class="hljs-title function_">useState</span>({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// å½“è¡¨å•å€¼å˜åŒ–æ—¶è‡ªåŠ¨éªŒè¯</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (isSubmitting) {
      <span class="hljs-keyword">const</span> validationErrors = <span class="hljs-title function_">validate</span>(values);
      <span class="hljs-title function_">setErrors</span>(validationErrors);
      <span class="hljs-title function_">setIsSubmitting</span>(<span class="hljs-literal">false</span>);
    }
  }, [values, isSubmitting, validate]);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-keyword">const</span> { name, value, type, checked } = e.<span class="hljs-property">target</span>;
    <span class="hljs-title function_">setValues</span>(<span class="hljs-function"><span class="hljs-params">prevValues</span> =&gt;</span> ({
      ...prevValues,
      [name]: type === <span class="hljs-string">'checkbox'</span> ? checked : value
    }));
    <span class="hljs-comment">// æ¸…é™¤è¯¥å­—æ®µçš„é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-title function_">setErrors</span>(<span class="hljs-function"><span class="hljs-params">prevErrors</span> =&gt;</span> ({
      ...prevErrors,
      [name]: <span class="hljs-string">''</span>
    }));
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">callback</span>) =&gt; <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-keyword">const</span> validationErrors = <span class="hljs-title function_">validate</span>(values);
    <span class="hljs-title function_">setErrors</span>(validationErrors);
    <span class="hljs-title function_">setIsSubmitting</span>(<span class="hljs-literal">true</span>);
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæ‰§è¡Œæäº¤å›è°ƒ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(validationErrors).<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-title function_">callback</span>(values);
    }
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resetForm</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setValues</span>(initialValues);
    <span class="hljs-title function_">setErrors</span>({});
  };

  <span class="hljs-keyword">return</span> { values, errors, handleChange, handleSubmit, resetForm };
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">RegisterForm</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// éªŒè¯å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">validate</span> = (<span class="hljs-params">values</span>) =&gt; {
    <span class="hljs-keyword">const</span> errors = {};
    
    <span class="hljs-keyword">if</span> (!values.<span class="hljs-property">username</span>.<span class="hljs-title function_">trim</span>()) {
      errors.<span class="hljs-property">username</span> = <span class="hljs-string">'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (values.<span class="hljs-property">username</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span>) {
      errors.<span class="hljs-property">username</span> = <span class="hljs-string">'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦'</span>;
    }
    
    <span class="hljs-keyword">if</span> (!values.<span class="hljs-property">email</span>) {
      errors.<span class="hljs-property">email</span> = <span class="hljs-string">'é‚®ç®±ä¸èƒ½ä¸ºç©º'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.<span class="hljs-title function_">test</span>(values.<span class="hljs-property">email</span>)) {
      errors.<span class="hljs-property">email</span> = <span class="hljs-string">'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'</span>;
    }
    
    <span class="hljs-keyword">if</span> (!values.<span class="hljs-property">password</span>) {
      errors.<span class="hljs-property">password</span> = <span class="hljs-string">'å¯†ç ä¸èƒ½ä¸ºç©º'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (values.<span class="hljs-property">password</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">6</span>) {
      errors.<span class="hljs-property">password</span> = <span class="hljs-string">'å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦'</span>;
    }
    
    <span class="hljs-keyword">return</span> errors;
  };

  <span class="hljs-keyword">const</span> { values, errors, handleChange, handleSubmit, resetForm } = <span class="hljs-title function_">useFormWithValidation</span>(
    { <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">''</span> },
    validate
  );

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">onSubmit</span> = (<span class="hljs-params">formData</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ³¨å†ŒæˆåŠŸ:'</span>, formData);
    <span class="hljs-title function_">resetForm</span>();
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit(onSubmit)}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{values.username}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ç”¨æˆ·å"</span>
        /&gt;</span>
        {errors.username &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">red</span>' }}&gt;</span>{errors.username}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{values.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"é‚®ç®±"</span>
        /&gt;</span>
        {errors.email &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">red</span>' }}&gt;</span>{errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{values.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¯†ç "</span>
        /&gt;</span>
        {errors.password &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">red</span>' }}&gt;</span>{errors.password}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-4">æ ¸å¿ƒä¼˜åŠ¿</h3>
<ol>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼šä¸€ä¸ªHookå¯ä»¥ç”¨äºé¡¹ç›®ä¸­çš„æ‰€æœ‰è¡¨å•ï¼Œå‡å°‘é‡å¤ä»£ç </li>
<li><strong>é›†ä¸­ç®¡ç†</strong>ï¼šæ‰€æœ‰è¡¨å•æ•°æ®é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä¾¿äºå¤„ç†å’Œæäº¤</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ éªŒè¯ã€å¼‚æ­¥æäº¤ç­‰åŠŸèƒ½</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç»“åˆTypeScriptä½¿ç”¨æ—¶ï¼Œå¯ä»¥æä¾›å®Œæ•´çš„ç±»å‹æç¤º</li>
</ol>
<h3 data-id="heading-5">æœ€ä½³å®è·µ</h3>
<p>ğŸ’¡ ä½¿ç”¨æ—¶çš„å°å»ºè®®ï¼š</p>
<ol>
<li><strong>å‘½åè§„èŒƒ</strong>ï¼šç¡®ä¿inputçš„<code>name</code>å±æ€§ä¸åˆå§‹å€¼çš„keyå®Œå…¨å¯¹åº”</li>
<li><strong>å¤æ‚è¡¨å•</strong>ï¼šå¯¹äºéå¸¸å¤æ‚çš„è¡¨å•ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æˆç†Ÿçš„è¡¨å•åº“ï¼ˆå¦‚Formikã€React Hook Formï¼‰</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹äºåŒ…å«å¤§é‡å­—æ®µçš„è¡¨å•ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<code>useReducer</code>æ›¿ä»£<code>useState</code>æ¥ä¼˜åŒ–æ€§èƒ½</li>
<li><strong>å¼‚æ­¥éªŒè¯</strong>ï¼šå¦‚æœéœ€è¦å¼‚æ­¥éªŒè¯ï¼ˆå¦‚æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ï¼‰ï¼Œå¯ä»¥åœ¨è‡ªå®šä¹‰Hookä¸­æ·»åŠ ç›¸åº”çš„å¤„ç†é€»è¾‘</li>
</ol>
<h3 data-id="heading-6">æ€»ç»“</h3>
<p>é€šè¿‡è‡ªå®šä¹‰Hookï¼Œæˆ‘ä»¬å¯ä»¥å°†è¡¨å•çŠ¶æ€ç®¡ç†çš„é€»è¾‘å°è£…èµ·æ¥ï¼Œä½¿ç»„ä»¶ä»£ç æ›´åŠ ç®€æ´ä¼˜é›…ã€‚è¿™ç§æ–¹å¼ä¸ä»…æé«˜äº†ä»£ç çš„å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿˜è®©æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚</p>
<p>ä¸‹æ¬¡é‡åˆ°è¡¨å•æ—¶ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªæ–¹æ³•å§ï½ç›¸ä¿¡ä½ ä¼šçˆ±ä¸Šè¿™ç§ç®€æ´çš„è¡¨å•ç®¡ç†æ–¹å¼ï¼ğŸ˜‰</p>
<hr/>
<p>ğŸ«¶ ä»Šå¤©çš„å°æŠ€å·§å°±åˆ†äº«åˆ°è¿™é‡Œå•¦ï¼å¦‚æœä½ æœ‰æ›´å¥½çš„è¡¨å•ç®¡ç†æ–¹æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµå“¦ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£]]></title>    <link>https://juejin.cn/post/7580606750290903091</link>    <guid>https://juejin.cn/post/7580606750290903091</guid>    <pubDate>2025-12-07T12:56:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750290903091" data-draft-id="7580564126402609202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:56:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/4469974689386972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4469974689386972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:56:26.000Z" title="Sun Dec 07 2025 12:56:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»æœ¬è´¨çœ‹â€œå†…å­˜æ³„éœ²â€æ˜¯ä»€ä¹ˆ</h2>
<p><strong>å†…å­˜æ³„éœ²åœ¨ Java/Android ä¸­çš„å®šä¹‰</strong>ï¼šå¯¹è±¡ä¸å†è¢«ä¸šåŠ¡éœ€è¦ï¼Œä½†ä»ç„¶èƒ½è¢« GC æ ¹ï¼ˆGC rootsï¼‰é€šè¿‡ä¸€æ¡æˆ–å¤šæ¡å¼•ç”¨è·¯å¾„è®¿é—®åˆ°ï¼Œå¯¼è‡´åƒåœ¾å›æ”¶å™¨ä¸ä¼šå›æ”¶å®ƒï¼Œä»è€Œå ç”¨å†…å­˜å¹¶å¯èƒ½å¼•èµ· OOMã€‚<strong>åœ¨Androidä¸­</strong> ï¼Œå†…å­˜æ³„æ¼å¤§æ¦‚å°±åŒ…æ‹¬<strong>Javaå¯¹è±¡å±‚é¢çš„æ³„æ¼</strong>å’Œ<strong>Androidç³»ç»Ÿèµ„æºï¼ˆå¦‚Bitmapã€Cursorç­‰ï¼‰çš„æœªé‡Šæ”¾é—®é¢˜</strong>ã€‚å³ä¾¿ Java å¯¹è±¡è¢«å›æ”¶ï¼Œnative èµ„æºè‹¥æ²¡æœ‰æ˜¾å¼é‡Šæ”¾ä¹Ÿä¼šæ³„éœ²ã€‚</p>
<h2 data-id="heading-1">äºŒã€åº•å±‚åŸç†</h2>
<p>ä¸Šé¢è¯´äº†ï¼Œåœ¨ Android ä¸­å†…å­˜æ³„æ¼åˆ†ä¸ºã€ŒJVM å †å†…å­˜æ³„æ¼ã€å’Œã€Œç³»ç»Ÿèµ„æºæ³„æ¼ã€ä¸¤ç±»ï¼Œ <strong>JVM ç®¡ç†çš„å¯¹è±¡ç”± GC å›æ”¶ï¼Œè€Œ Android ç³»ç»Ÿèµ„æºåˆ™ç”±å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ API é‡Šæ”¾</strong>ï¼Œç³»ç»Ÿä¸è‡ªåŠ¨å›æ”¶ã€‚</p>
<p>å…·ä½“æ¥è¯´ <strong>Java/Kotlin å®šä¹‰çš„å¯¹è±¡</strong>ï¼ˆå¦‚ <code>Activity</code>ã€<code>View</code>ã€<code>String</code>ã€é›†åˆç­‰ï¼‰ï¼Œéƒ½å­˜å‚¨åœ¨ JVM å †ä¸­ï¼Œå®Œå…¨ç”± GC ç®¡ç†ã€‚æ¯”å¦‚ <code>Activity</code> å®ä¾‹ã€<code>MaterialButton</code> å¯¹è±¡ã€<code>EventBus</code> è®¢é˜…è€…å¼•ç”¨ï¼Œè¿™äº›éƒ½æ˜¯ JVM å †å¯¹è±¡ï¼ŒGC ä¼šæ ¹æ® â€œå¯è¾¾æ€§â€ åˆ¤æ–­æ˜¯å¦å›æ”¶ï¼›</p>
<p><strong>Android ç³»ç»Ÿèµ„æº</strong>æ˜¯é€šè¿‡ Native å±‚è°ƒç”¨ Linux å†…æ ¸æ¥å£ç”³è¯·çš„ã€Œé JVM èµ„æºã€ï¼ŒGC æ—¢æ„ŸçŸ¥ä¸åˆ°ï¼Œä¹Ÿæ— æ³•å›æ”¶ï¼Œå¸¸è§æœ‰<strong>ç³»ç»ŸæœåŠ¡å¼•ç”¨</strong><code>ContentResolver.Cursor</code>ã€<code>MediaPlayer</code>ã€å¹¿æ’­æ¥æ”¶å™¨ï¼ˆ<code>BroadcastReceiver</code>ï¼‰ã€<code>NotificationManager</code> ï¼›<strong>å›¾å½¢èµ„æº</strong>ï¼šBitmapï¼ˆNative å±‚åƒç´ æ•°æ®ï¼‰ã€<code>Drawable</code>ã€<code>Canvas</code> ï¼›<code>SharedPreferences</code> çš„ <code>Editor</code>çš„å†…å­˜å—ç­‰ ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦æˆ‘ä»¬è‡ªè¡Œè°ƒ<code>api</code>æ‰‹åŠ¨å…³é—­çš„ã€‚</p>
<h3 data-id="heading-2">2.1.<strong>å¼•ç”¨ç±»å‹å†³å®šå›æ”¶</strong></h3>
<p>Javaä¸­æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æåˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„ï¼Œå­¦ä¹ è¯¥ç®—æ³•éœ€è¦äº†è§£Javaä¸­çš„4ç§å¼•ç”¨ã€‚Javaä¸­å¼•ç”¨åˆ†ä¸ºå¼ºå¼•ç”¨ï¼ˆé»˜è®¤ï¼‰ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ã€‚æˆ‘ä»¬ç”¨åˆ°çš„å¼•ç”¨åŸºæœ¬éƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œå…¶ä»–ä¸‰ç§å‡ ä¹ä¸ä¼šå‡ºç°åœ¨æ—¥å¸¸å¼€å‘ä¸­ã€‚</p>
<ul>
<li>å¼ºå¼•ç”¨ï¼šå¼ºå¼•ç”¨æ˜¯åœ¨ç¨‹åºä»£ç ä¸­æ™®éå­˜åœ¨çš„ï¼Œä¾‹å¦‚<code>Person person = new Person()</code>ï¼Œ<strong>åªè¦å¼ºå¼•ç”¨è¿˜å­˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨æ°¸è¿œä¸ä¼šå›æ”¶è¢«å¼•ç”¨çš„å¯¹è±¡</strong>ã€‚</li>
<li>è½¯å¼•ç”¨ï¼šè½¯å¼•ç”¨æ˜¯ç”¨æ¥æè¿°ä¸€äº›è¿˜æœ‰ç”¨ä½†å¹¶éå¿…é¡»çš„å¯¹è±¡ï¼Œå¯¹äº<strong>è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿå°†å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸å‰ï¼Œå°†ä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—å…¥å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœè¯¥æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸</strong>ã€‚Javaæä¾›äº†**<code>SoftReference</code>**å®ç°è½¯å¼•ç”¨ï¼Œæˆ‘ä»¬åœ¨å®‰å“å¼€å‘ä¸­å¯èƒ½ç”¨è¿‡Glideåº“å¤„ç†å›¾ç‰‡ï¼ŒGlideçš„åº•å±‚å°±ç”¨åˆ°äº†è½¯å¼•ç”¨ã€‚</li>
<li>å¼±å¼•ç”¨ï¼šå¼±å¼•ç”¨ä¹Ÿæ˜¯æè¿°éå¿…éœ€å¯¹è±¡ï¼Œä½†æ˜¯å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´å¼±ä¸€äº›ï¼Œ<strong>è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†ä¹‹å‰</strong>ï¼Œå½“åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ï¼Œæ— è®ºå½“å‰å†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œéƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚Javaæä¾›äº†**<code>WeakReference</code>**å®ç°å¼±å¼•ç”¨ï¼ŒAndroidæ¶ˆæ¯æœºåˆ¶ä¸­çš„<code>ThreadLocal</code>å°±ç”¨åˆ°äº†å¼±å¼•ç”¨ï¼Œ<code>ThreadLocal</code>çš„æ ¸å¿ƒåœ¨äºå…¶å†…éƒ¨ç±» <code>ThreadLocalMap</code>ã€‚è¿™ä¸ª Map ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ <code>Entry</code>ç±»æ¥å­˜å‚¨é”®å€¼å¯¹ï¼Œè€Œ <code>Entry</code>å°±ç»§æ‰¿è‡ª <code>WeakReference</code>ã€‚</li>
<li>è™šå¼•ç”¨ï¼šè™šå¼•ç”¨æ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå¯¹ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“ã€‚<strong>ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥</strong>ã€‚Javaæä¾›äº†<code>PhantomReference</code>å®ç°è™šå¼•ç”¨ã€‚</li>
</ul>
<h3 data-id="heading-3">2.2.<strong>GC roots</strong></h3>
<p>GC Rootsï¼ˆGC æ ¹èŠ‚ç‚¹ï¼‰æ˜¯ JVM åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰åˆ¤æ–­å¯¹è±¡æ˜¯å¦ã€Œå¯è¾¾ã€çš„<strong>æ ¸å¿ƒèµ·ç‚¹</strong>ã€<strong>ç»å¯¹å­˜æ´»èµ·ç‚¹</strong>â€”â€”GC ä¼šä»è¿™äº›æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œéå†æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡å¼•ç”¨é“¾ã€‚</p>
<p>åœ¨Javaä¸­ï¼Œå¯ä½œä¸º<code>GC Roots</code>çš„å¯¹è±¡åŒ…æ‹¬ç³»ç»Ÿæ ˆã€é™æ€å˜é‡ã€<code>Classloader</code>ã€JNI å…¨å±€å¼•ç”¨ã€æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ç­‰ã€‚è¢«è¿™äº›æ ¹å¯è¾¾çš„å¯¹è±¡è¢«è§†ä¸ºâ€œæ´»ç€â€ã€‚</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡åˆ°<code>GC Roots</code>æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œè¯¥å¯¹è±¡å°±æ˜¯ä¸å¯ç”¨çš„ï¼Œæ­¤æ—¶å°±ä¼šè¢«åˆ¤å®šä¸ºå¯å›æ”¶çš„å¯¹è±¡ã€‚è¿™å°±æ˜¯<code>Java</code>é‡‡ç”¨çš„<strong>å¯è¾¾æ€§åˆ†æç®—æ³•ã€‚</strong></p>
<h3 data-id="heading-4">2.3.<strong>ç”Ÿå‘½å‘¨æœŸé”™é…</strong></h3>
<p>ç”Ÿå‘½å‘¨æœŸé”™é…æŒ‡çš„æ˜¯ä¸€ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸé•¿çš„å¯¹è±¡</strong>ï¼ˆå¦‚å•ä¾‹ã€é™æ€å˜é‡ã€åå°çº¿ç¨‹ï¼‰ä¸å¿…è¦åœ°æŒæœ‰äº†ä¸€ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸçŸ­çš„å¯¹è±¡</strong>ï¼ˆå¦‚Activityã€Fragmentï¼‰çš„å¼•ç”¨ï¼Œå¯¼è‡´åè€…åœ¨å…¶æœ¬è¯¥è¢«é”€æ¯æ—¶æ— æ³•è¢«åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰å›æ”¶ï¼Œä»è€ŒæŒç»­å ç”¨å†…å­˜ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€å¸¸è§æ³„éœ²æ¨¡å¼</h2>
<p>ä¸‹é¢åˆ†æåœ¨å®é™…å¼€å‘ä¸­æœ€å¸¸è§çš„å‡ ç§å†…å­˜æ³„æ¼æƒ…å†µ</p>
<ol start="0">
<li>
<p><strong>Activity/Context æ³„éœ²ï¼ˆæœ€å¸¸è§ï¼‰</strong></p>
<p>åœ¨ Android å¼€å‘ä¸­ï¼ŒActivity æˆ– Context è¢«æ— æ„ä¸­æŒæœ‰è€Œå¯¼è‡´æ— æ³•è¢«åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰å›æ”¶ï¼Œæ˜¯æœ€å¸¸è§çš„å†…å­˜æ³„æ¼é—®é¢˜ä¹‹ä¸€ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ¯” Activity æ›´é•¿çš„å¯¹è±¡ï¼ŒæŒæœ‰äº†è¯¥ Activity çš„å¼•ç”¨ï¼Œä»è€Œé˜»ç¢äº†å…¶æ­£å¸¸é”€æ¯å’Œå›æ”¶ã€‚</p>
<p><strong>å•ä¾‹æ¨¡å¼å¯¼è‡´æ³„æ¼</strong>æ˜¯è¯¥æƒ…å†µä¸‹ç»å…¸çš„æ³„æ¼åœºæ™¯ï¼Œå•ä¾‹å¯¹è±¡é€šå¸¸éšåº”ç”¨è¿›ç¨‹ä¸€ç›´å­˜åœ¨ï¼Œå¦‚æœå®ƒé”™è¯¯åœ°æŒæœ‰äº†ä¸€ä¸ª Activity çš„ Contextï¼Œé‚£ä¹ˆè¿™ä¸ª Activity å³ä½¿è¢«å…³é—­ä¹Ÿæ— æ³•è¢«å›æ”¶ã€‚è¿™å°±æ˜¯å› ä¸ºActivity è¢« GC Roots å½¢æˆçš„å¼•ç”¨é“¾ â€œç»‘å®šâ€ï¼Œæ— æ³•è¢«æ ‡è®°ä¸ºå¯å›æ”¶ã€‚çœ‹ä¸‹é¢çš„ä»£ç </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppSettings</span> {
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AppSettings</span> <span class="hljs-variable">sInstance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppSettings</span>();
 Â  Â <span class="hljs-keyword">private</span> Context mContext; 
 Â  Â 
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span><span class="hljs-params">(Context context)</span> {
 Â  Â  Â  Â <span class="hljs-built_in">this</span>.mContext = context; <span class="hljs-comment">// å¦‚æœä¼ å…¥çš„æ˜¯ Activity.thisï¼Œåˆ™å‘ç”Ÿæ³„æ¼</span>
 Â   }
}
</code></pre>
<p>å› æ­¤åœ¨å•ä¾‹æƒ…å†µä¸‹ï¼Œå°½é‡ä½¿ç”¨ç³»ç»Ÿçº§åˆ«çš„<code>context</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">Context context</span>) {
 Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">mContext</span> = context.<span class="hljs-title function_">getApplicationContext</span>(); <span class="hljs-comment">// æ­£ç¡®ï¼šä½¿ç”¨åº”ç”¨çº§åˆ«çš„ Context</span>
}
</code></pre>
</li>
<li>
<p><strong>åŒ¿åå†…éƒ¨ç±» / éé™æ€å†…éƒ¨ç±»</strong></p>
<p>éé™æ€å†…éƒ¨ç±»ä¼šéšå¼æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼ˆä¾‹å¦‚ <code>new Runnable(){}</code> æŒæœ‰å¤–éƒ¨ Activityï¼‰ï¼Œå¦‚æœ <code>Runnable</code> è¢«å»¶è¿Ÿæ‰§è¡Œæˆ–æ”¾åˆ°æŒä¹…å®¹å™¨é‡Œå°±ä¼šæ³„éœ²å¤–éƒ¨ <code>Activity</code>ã€‚<code>kotliln</code>è¯­è¨€ä¸­åœ¨ä¸€ä¸ªç±»å†…éƒ¨å†å£°æ˜ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªå†…éƒ¨çš„ç±»å°±è¢«è®¾è®¡åœ°åŒºåˆ«äºJavaçš„å†…éƒ¨ç±»ï¼Œç§°ä¸ºåµŒå¥—ç±»ï¼Œä¸æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼Œç±»ä¼¼<code>Java</code>ä¸­çš„é™æ€å†…éƒ¨ç±»ï¼Œè¿™ç§è®¾è®¡åŸå› å¾ˆå¤§æ–¹é¢å°±æ˜¯ä¸ºäº†é¿å…å†…å­˜æ³„æ¼ã€‚</p>
<p>ä¸¾ä¾‹ä¸‹é¢çš„ä»£ç ã€‚å¦‚æœåœ¨Activityé”€æ¯å‰æ²¡æœ‰å¤„ç†å®Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚å› ä¸º<code>Handler</code> åˆå§‹åŒ–æ—¶ä¼šé»˜è®¤å…³è”<strong>å½“å‰çº¿ç¨‹çš„ <code>Looper</code> å’Œ <code>MessageQueue</code></strong>ï¼ˆä¸»çº¿ç¨‹çš„ Looper éšåº”ç”¨è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸå­˜åœ¨ï¼Œæ°¸ä¸é”€æ¯ï¼‰ï¼Œåªè¦ Handler çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æœ‰æœªå¤„ç†çš„æ¶ˆæ¯ï¼Œ<code>Message</code> ä¼šæŒæœ‰ <code>Handler</code> çš„å¼•ç”¨ï¼Œè€Œ Handler åˆæŒæœ‰ Activity çš„å¼•ç”¨ï¼Œå¯¼è‡´ Activity æ— æ³•å›æ”¶ ã€‚</p>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> </span>{
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-type">Handler</span> mHandler = <span class="hljs-keyword">new</span> <span class="hljs-type">Handler</span>() { <span class="hljs-comment">// åŒ¿åå†…éƒ¨ç±»ï¼Œéšå¼æŒæœ‰ Activity å¼•ç”¨</span>
 Â  Â  Â  Â <span class="hljs-meta">@Override</span>
 Â  Â  Â  Â public void handleMessage(<span class="hljs-type">Message</span> msg) {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ... å¤„ç†æ¶ˆæ¯</span>
 Â  Â  Â   }
 Â   };
}
</code></pre>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦åœ¨onDestroyä¸­ç§»é™¤æ‰€æœ‰çš„æ¶ˆæ¯å’Œå›è°ƒã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"/>) {
 Â  Â <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onDestroy</span>();
 Â  Â mHandler.<span class="hljs-title function_">removeCallbacksAndMessages</span>(<span class="hljs-literal">null</span>); <span class="hljs-comment">// ç§»é™¤æ‰€æœ‰æ¶ˆæ¯å’Œå›è°ƒ</span>
}
</code></pre>
</li>
<li>
<p><strong>æœªæ³¨é”€çš„ç³»ç»Ÿå›è°ƒ</strong></p>
<p>è¿™ç§æƒ…å†µå’Œä¸Šé¢çš„åŒ¿åå†…éƒ¨ç±»ç±»ä¼¼ï¼Œä¾‹å¦‚ <code>BroadcastReceiver</code>ã€<code>ContentObserver</code>ã€<code>LocationListener</code>ã€<code>ViewTreeObserver</code> ç­‰æ²¡æœ‰åœ¨ <code>onDestroy</code>/<code>onStop</code> ä¸­ <code>unregister</code>ã€‚è¿™æ˜¯å› ä¸ºç³»ç»ŸæœåŠ¡ï¼ˆå¦‚ <code>SensorManager</code>ã€<code>LocationManager</code>ï¼‰æˆ–å…¨å±€ç»„ä»¶ï¼ˆå¦‚å¹¿æ’­ç®¡ç†å™¨ï¼‰é€šå¸¸å…·æœ‰ä¸åº”ç”¨ç¨‹åºè¿›ç¨‹ç›¸åŒçš„é•¿ç”Ÿå‘½å‘¨æœŸã€‚å½“æ‚¨åœ¨ Activity ä¸­æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨æ—¶ï¼Œè¿™ä¸ªé•¿ç”Ÿå‘½å‘¨æœŸçš„æœåŠ¡ä¼šæŒæœ‰è¯¥ç›‘å¬å™¨çš„å¼•ç”¨ã€‚å¦‚æœè¿™ä¸ªç›‘å¬å™¨æ˜¯ Activity çš„éé™æ€å†…éƒ¨ç±»æˆ–åŒ¿åå†…éƒ¨ç±»ï¼Œå®ƒä¼šéšå¼æŒæœ‰å…¶å¤–éƒ¨ç±»ï¼ˆå³ Activityï¼‰çš„å¼ºå¼•ç”¨ã€‚</p>
</li>
</ol>
<h2 data-id="heading-6">å››ã€MVPæ¶æ„å†…å­˜æ³„æ¼å‰–æ</h2>
<p>æœ‰äº†å‰é¢çš„ç†è®ºåŸºç¡€ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹MVPæ¶æ„çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚</p>
<p>MVPæ¶æ„ä¸­Activity / Fragment æŒæœ‰ <code>Presenter</code>ï¼Œè€Œ<code>Presenter</code> æŒæœ‰ View æ¥å£ï¼ˆé€šå¸¸æ˜¯ Activityï¼‰ï¼Œä¹Ÿå°±æ˜¯<code>Activity â†’ Presenter â†’ Activity</code>å½¢æˆäº†å¼ºå¼•ç”¨ç¯ã€‚åªè¦å…¶ä¸­ä¸€ä¸ªåœ°æ–¹<strong>æ²¡æœ‰æ­£ç¡®æ–­å¼€</strong>ï¼Œ Activity å°±ç®—é€€å‡ºäº†ï¼ŒGC ä¹Ÿå›æ”¶ä¸äº† ï¼Œä¼šç›´æ¥å¯¼è‡´å†…å­˜æ³„æ¼ã€‚å› æ­¤MVPæ¶æ„å¤©ç”Ÿå®¹æ˜“å†…å­˜æ³„æ¼ã€‚æˆ‘ä»¬ä¸‹é¢å…·ä½“ä¸¾ä¸ªä¾‹å­ã€‚</p>
<p>è¿™æ˜¯På±‚ï¼Œé€šè¿‡æŒæœ‰çš„viewå¼•ç”¨å±•ç¤ºæ•°æ®ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainPresenter</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> view: MainContract.View) {
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadData</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â view.showLoading()
 Â   }
}
</code></pre>
<p>è€Œ<code>View</code>å±‚ï¼ˆ<code>MainActivity</code>ï¼‰é€šè¿‡<code>presenter = MainPresenter(this)</code>ä¹Ÿä¼šæŒæœ‰På±‚çš„å¼•ç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>(), MainContract.View {
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> presenter = MainPresenter(<span class="hljs-keyword">this</span>)
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â <span class="hljs-keyword">super</span>.onDestroy()
 Â  Â  Â  Â <span class="hljs-comment">// æ²¡æœ‰ presenter.detachView()</span>
 Â   }
}
â€‹
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹å½“Activityè¿˜å­˜åœ¨æ—¶ï¼Œ V å±‚è¢« P å±‚å¼ºå¼•ç”¨ï¼ŒP å±‚åˆè¢« V å±‚å¼ºå¼•ç”¨ ï¼Œå½¢æˆäº†å¼ºå¼•ç”¨ç¯ã€‚æˆ‘ä»¬ä¸Šé¢è®²äº†Javaçš„åƒåœ¾å›æ”¶ç”¨çš„æ˜¯<strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong>ï¼Œè¿™ç§ç®—æ³•å¯¹æ¯”å¼•ç”¨è®¡æ•°ç®—æ³•æ¥è¯´æ˜¯ä¸æ€•æˆç¯çš„ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œå¦‚æœPå±‚ä¸æŸä¸ªå­˜æ´»å¯¹è±¡å»ºç«‹äº†å…³ç³»ï¼ˆæ¯”å¦‚çº¿ç¨‹ï¼Œç›‘å¬å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰ï¼Œè¿™æ—¶ä¾¿ä¸ä¼šè¢«æ¸…é™¤ï¼ŒPå±‚å’ŒVå±‚ä¾¿ä¼šè¾¾åˆ°æ°¸ç”Ÿï¼Œé€ æˆäº†å†…å­˜æ³„æ¼ã€‚</p>
<p>å› æ­¤MVPæ¶æ„ä¸€å®šè¦æ³¨æ„æ¶æ„çš„å†™æ³•è§„èŒƒ</p>
<p>Presenterå±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasePresenter</span>&lt;<span class="hljs-type">V</span>&gt; {
â€‹
 Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">var</span> view: V? = <span class="hljs-literal">null</span>
â€‹
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">attachView</span><span class="hljs-params">(v: <span class="hljs-type">V</span>)</span></span> {
 Â  Â  Â  Â view = v
 Â   }
â€‹
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">detachView</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â view = <span class="hljs-literal">null</span>
 Â  Â  Â  Â onCleared()
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {}
}
â€‹
</code></pre>
<p>Activityå±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(...)</span></span> {
 Â  Â presenter.attachView(<span class="hljs-keyword">this</span>)
}
â€‹
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
 Â  Â presenter.detachView()
 Â  Â <span class="hljs-keyword">super</span>.onDestroy()
}
â€‹
</code></pre>
<h2 data-id="heading-7">äº”ã€å†…å­˜æ³„éœ²çš„å‘ç°</h2>
<p>å°½ç®¡ç†Ÿæ‚‰äº†å†…å­˜æ³„éœ²ï¼Œä½†åœ¨å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ä»ä¸å¯é¿å…åœ°ä¼šå¶å°”å¤§æ„é€ æˆå†…å­˜æ³„æ¼ï¼Œè¿™æ–¹é¢æœ‰ä¸€äº›å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘æµ‹appçš„å†…å­˜é—®é¢˜ã€‚</p>
<p>1.<strong>Android Studioå†…ç½®çš„Memory Profiler</strong></p>
<p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„å·¥å…·ã€‚å®ƒå¯ä»¥å®æ—¶æ˜¾ç¤ºåº”ç”¨çš„å†…å­˜ä½¿ç”¨é‡æ›²çº¿å›¾ï¼Œå¸®åŠ©ä½ è§‚å¯Ÿå†…å­˜çš„æ€»ä½“è¶‹åŠ¿ã€‚ä½ å¯ä»¥é€šè¿‡å®ƒ<strong>æ•è·å †è½¬å‚¨ (Heap Dump)</strong> ï¼Œè·å–æŸä¸ªæ—¶é—´ç‚¹å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡çš„å¿«ç…§ï¼Œä»è€Œåˆ†æå“ªäº›å¯¹è±¡å¯èƒ½è¢«ä¸å½“æŒæœ‰ ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜èƒ½<strong>è®°å½•å†…å­˜åˆ†é…æƒ…å†µ</strong>ï¼Œè¿½è¸ªå¯¹è±¡æ˜¯åœ¨å“ªéƒ¨åˆ†ä»£ç ä¸­è¢«åˆ›å»ºçš„ï¼Œè¿™å¯¹äºå®šä½æ³„æ¼æºå¤´éå¸¸æœ‰å¸®åŠ© ï¼Œå¦‚å›¾ï¼Œå¯¹Memory Usageè¿›è¡Œåˆ†æï¼Œå¦‚ä¸‹ä¸¤å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17bd0c1e30654fb281d6f02f7bedacbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5a2U5aSa55qE54K86YeR5pyv5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717263&amp;x-signature=8i7p2YnkQZwFKlDikKsrvL8LOag%3D" alt="å±å¹•æˆªå›¾ 2025-12-07 202757.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/669de7ebda78410788b766638a691ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5a2U5aSa55qE54K86YeR5pyv5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717263&amp;x-signature=24RZWwOtCdHY6uTDwSYspBNwmqI%3D" alt="å±å¹•æˆªå›¾ 2025-12-07 202827.png" loading="lazy"/></p>
<p>ä¸è¿‡æ³¨æ„ï¼ŒProfiler çš„ <code>Leaks</code> è®¡æ•°åªæ£€æµ‹ Activity/Fragment æ³„æ¼ï¼Œè€Œ App è¿˜å¯èƒ½å­˜åœ¨å…¶ä»–æ³„æ¼åœºæ™¯ï¼Œ<strong>æ™®é€šå¯¹è±¡æ³„æ¼</strong>ï¼šå¦‚å•ä¾‹æŒæœ‰å·¥å…·ç±»å¯¹è±¡ã€æœªæ¸…ç†çš„é›†åˆç¼“å­˜ï¼›<strong>ç³»ç»Ÿèµ„æºæ³„æ¼</strong>ï¼šå¦‚æœªå…³é—­çš„ Cursorã€æœªå›æ”¶çš„ Bitmapã€æœªæ³¨é”€çš„ç›‘å¬å™¨ï¼›<strong>çŸ­æœŸæ³„æ¼</strong>ï¼šå¦‚ Handler å»¶è¿Ÿæ¶ˆæ¯ç­‰</p>
<p><strong>2. è‡ªåŠ¨åŒ–æ£€æµ‹åº“ï¼šLeakCanary</strong></p>
<p>ä¸Šé¢ä»‹ç»çš„Profileræ¯•ç«Ÿæ˜¯ã€Œæ‰‹åŠ¨åˆ†æå·¥å…·ã€ï¼Œè€Œ <strong><code>LeakCanary</code> æ˜¯è‡ªåŠ¨æ£€æµ‹å†…å­˜æ³„æ¼çš„åº“</strong>ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åŒ–åœ°æ£€æµ‹å†…å­˜æ³„æ¼ï¼Œå¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ ã€‚åªéœ€åœ¨é¡¹ç›®çš„ <code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼Œ<code>LeakCanary</code> å°±ä¼šè‡ªåŠ¨åœ¨åº”ç”¨è¿è¡Œæ—¶ç›‘æ§ Activity å’Œ Fragment ç­‰å¯¹è±¡ã€‚å½“è¿™äº›å¯¹è±¡æœ¬åº”è¢«å›æ”¶å´ä¾ç„¶å­˜æ´»æ—¶ï¼Œ<code>LeakCanary</code> ä¼šè§¦å‘å †è½¬å‚¨ï¼Œåˆ†ææ³„æ¼è½¨è¿¹ï¼Œå¹¶é€šè¿‡é€šçŸ¥æ æ¸…æ™°åœ°å±•ç¤ºå‡ºæ¥ï¼Œç›´æ¥å®šä½åˆ°æ³„æ¼çš„å¼•ç”¨é“¾ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">dependencies {
 Â  Â debugImplementation <span class="hljs-string">'com.squareup.leakcanary:leakcanary-android:2.10'</span>
}
</code></pre>
<p>ç¼–è¯‘å¹¶è¿è¡Œåº”ç”¨åï¼Œ<code>LeakCanary</code> ä¼šè‡ªåŠ¨åœ¨åå°å¯åŠ¨ã€‚å½“æ£€æµ‹åˆ°å†…å­˜æ³„æ¼æ—¶ï¼Œä¼šåœ¨é€šçŸ¥æ æ˜¾ç¤ºé€šçŸ¥ï¼Œç‚¹å‡»é€šçŸ¥å³å¯æŸ¥çœ‹è¯¦ç»†çš„æ³„æ¼åˆ†ææŠ¥å‘Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥å‰–æè¿›ç¨‹ã€çº¿ç¨‹ä¸è™šæ‹Ÿå†…å­˜]]></title>    <link>https://juejin.cn/post/7581312433529552939</link>    <guid>https://juejin.cn/post/7581312433529552939</guid>    <pubDate>2025-12-08T10:43:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581312433529552939" data-draft-id="7581097111896293430" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥å‰–æè¿›ç¨‹ã€çº¿ç¨‹ä¸è™šæ‹Ÿå†…å­˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T10:43:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥å‰–æè¿›ç¨‹ã€çº¿ç¨‹ä¸è™šæ‹Ÿå†…å­˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T10:43:54.000Z" title="Mon Dec 08 2025 10:43:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¹¶å‘ç¼–ç¨‹çš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªå¸¸è§çš„è¯¯åŒºæ˜¯è®¤ä¸º"å¤šçº¿ç¨‹æ€»æ˜¯æ›´å¿«"ã€‚ç„¶è€Œï¼Œå®é™…æƒ…å†µè¦å¤æ‚å¾—å¤šã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªå…³é”®é—®é¢˜å¼€å§‹ï¼š<strong>å¤šçº¿ç¨‹åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæ¯”å•çº¿ç¨‹æ›´æ…¢ï¼Ÿ</strong></p>
<h3 data-id="heading-0">å¤šçº¿ç¨‹çš„æ€§èƒ½é™·é˜±</h3>
<ol>
<li>
<p><strong>çº¿ç¨‹åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€</strong>ï¼šæ¯ä¸ªçº¿ç¨‹çš„åˆ›å»ºéœ€è¦åˆ†é…æ ˆç©ºé—´ï¼ˆé€šå¸¸8MBï¼‰ã€çº¿ç¨‹æ§åˆ¶å—(TCB)ç­‰èµ„æºã€‚ä¸Šä¸‹æ–‡åˆ‡æ¢æ›´æ˜¯æ˜‚è´µï¼Œéœ€è¦ä¿å­˜/æ¢å¤å¯„å­˜å™¨çŠ¶æ€ï¼ˆx86-64ä¸‹è‡³å°‘å‡ åä¸ªå¯„å­˜å™¨ï¼‰ã€æ›´æ–°çº¿ç¨‹è°ƒåº¦çŠ¶æ€ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®ç«äº‰å’ŒåŒæ­¥æˆæœ¬</strong>ï¼šå½“å¤šä¸ªçº¿ç¨‹é¢‘ç¹è®¿é—®å…±äº«æ•°æ®æ—¶ï¼ŒåŒæ­¥åŸè¯­æˆä¸ºç“¶é¢ˆã€‚ä»¥è‡ªæ—‹é”ä¸ºä¾‹ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp">std::atomic&lt;<span class="hljs-type">int</span>&gt; lock{<span class="hljs-number">0</span>};
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">critical_section</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">while</span> (lock.<span class="hljs-built_in">exchange</span>(<span class="hljs-number">1</span>, std::memory_order_acquire)) {
        <span class="hljs-comment">// å¿™ç­‰å¾… - CPUå‘¨æœŸè¢«æµªè´¹</span>
        _mm_pause();  <span class="hljs-comment">// x86çš„PAUSEæŒ‡ä»¤ï¼Œå‡å°‘èƒ½è€—</span>
    }
    <span class="hljs-comment">// å®é™…å·¥ä½œ...</span>
    lock.<span class="hljs-built_in">store</span>(<span class="hljs-number">0</span>, std::memory_order_release);
}
</code></pre>
<ol start="3">
<li><strong>ç¼“å­˜ä¸€è‡´æ€§åè®®å¼€é”€</strong>ï¼šå¤šæ ¸CPUé€šè¿‡MESIåè®®ç»´æŠ¤ç¼“å­˜ä¸€è‡´æ€§ã€‚å½“å¤šä¸ªçº¿ç¨‹ä¿®æ”¹åŒä¸€ç¼“å­˜è¡Œï¼ˆé€šå¸¸æ˜¯64å­—èŠ‚ï¼‰çš„ä¸åŒéƒ¨åˆ†æ—¶ï¼Œä¼šäº§ç”Ÿ"è™šå‡å…±äº«"(False Sharing)ï¼š</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">alignas</span>(<span class="hljs-number">64</span>) PaddedCounter {  <span class="hljs-comment">// ç¼“å­˜è¡Œå¯¹é½</span>
    std::atomic&lt;<span class="hljs-type">int</span>&gt; count;
    <span class="hljs-type">char</span> padding[<span class="hljs-number">64</span> - <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)];  <span class="hljs-comment">// å¡«å……åˆ°å®Œæ•´ç¼“å­˜è¡Œ</span>
};
<span class="hljs-comment">// æ¯ä¸ªçº¿ç¨‹ä½¿ç”¨ç‹¬ç«‹çš„PaddedCounterï¼Œé¿å…ç¼“å­˜è¡Œä¹’ä¹“</span>
</code></pre>
<ol start="4">
<li><strong>TLBæŠ–åŠ¨é—®é¢˜</strong>ï¼šå½“çº¿ç¨‹æ•°è¶…è¿‡TLBå®¹é‡æ—¶ï¼Œé¢‘ç¹çš„åœ°å€ç©ºé—´åˆ‡æ¢ä¼šå¯¼è‡´TLBå¤±æ•ˆã€‚å‡è®¾ç³»ç»Ÿæœ‰64ä¸ªTLBæ¡ç›®ï¼Œè¿è¡Œ128ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å·¥ä½œé›†ä¸º10é¡µï¼Œé‚£ä¹ˆTLBç¼ºå¤±ç‡å°†éå¸¸é«˜ã€‚</li>
</ol>
<h2 data-id="heading-1">è¿›ç¨‹ä¸çº¿ç¨‹çš„æœ¬è´¨åŒºåˆ«</h2>
<h3 data-id="heading-2">è¿›ç¨‹ï¼šèµ„æºçš„å®¹å™¨</h3>
<p>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç‹¬ç«‹çš„åœ°å€ç©ºé—´</strong>ï¼šæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œé€šè¿‡é¡µè¡¨éš”ç¦»</li>
<li><strong>èµ„æºå¥æŸ„è¡¨</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·å¤„ç†ç¨‹åºã€ç”¨æˆ·æƒé™ç­‰</li>
<li><strong>æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ï¼šç¨‹åºè®¡æ•°å™¨ã€æ ˆæŒ‡é’ˆã€å¯„å­˜å™¨é›†åˆ</li>
</ol>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// Linuxè¿›ç¨‹æè¿°ç¬¦ï¼ˆtask_structï¼‰å…³é”®éƒ¨åˆ†</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> {</span>
    <span class="hljs-type">pid_t</span> pid;                    <span class="hljs-comment">// è¿›ç¨‹ID</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mm_struct</span> *<span class="hljs-title">mm</span>;</span>         <span class="hljs-comment">// å†…å­˜æè¿°ç¬¦ï¼ˆæ ¸å¿ƒï¼ï¼‰</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">files_struct</span> *<span class="hljs-title">files</span>;</span>   <span class="hljs-comment">// æ‰“å¼€æ–‡ä»¶è¡¨</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">signal_struct</span> *<span class="hljs-title">signal</span>;</span> <span class="hljs-comment">// ä¿¡å·å¤„ç†</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">thread_group</span>;</span><span class="hljs-comment">// æ‰€å±çº¿ç¨‹ç»„</span>
    <span class="hljs-comment">// ...</span>
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mm_struct</span> {</span>
    <span class="hljs-type">pgd_t</span> *pgd;                  <span class="hljs-comment">// é¡µå…¨å±€ç›®å½•ï¼ˆé¡µè¡¨æ ¹ï¼‰</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vm_area_struct</span> *<span class="hljs-title">mmap</span>;</span> <span class="hljs-comment">// è™šæ‹Ÿå†…å­˜åŒºåŸŸé“¾è¡¨</span>
    <span class="hljs-type">atomic_t</span> mm_users;           <span class="hljs-comment">// ä½¿ç”¨è¯¥åœ°å€ç©ºé—´çš„çº¿ç¨‹æ•°</span>
    <span class="hljs-type">atomic_t</span> mm_count;           <span class="hljs-comment">// å¼•ç”¨è®¡æ•°</span>
};
</code></pre>
<h3 data-id="heading-3">çº¿ç¨‹ï¼šæ‰§è¡Œçš„å•å…ƒ</h3>
<p>çº¿ç¨‹å…±äº«è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼Œä½†æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š</p>
<ol>
<li><strong>å…±äº«åœ°å€ç©ºé—´</strong>ï¼šæ‰€æœ‰çº¿ç¨‹çœ‹åˆ°ç›¸åŒçš„å†…å­˜æ˜ å°„</li>
<li><strong>ç‹¬ç«‹æ‰§è¡ŒçŠ¶æ€</strong>ï¼šæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„æ ˆã€å¯„å­˜å™¨ã€ç¨‹åºè®¡æ•°å™¨</li>
<li><strong>å…±äº«èµ„æº</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·å¤„ç†ã€ç”¨æˆ·IDç­‰</li>
</ol>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// POSIXçº¿ç¨‹å±æ€§</span>
<span class="hljs-type">pthread_attr_t</span> attr;
pthread_attr_init(&amp;attr);
pthread_attr_setstacksize(&amp;attr, <span class="hljs-number">8</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>);  <span class="hljs-comment">// 8MBæ ˆ</span>
pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);

<span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹</span>
<span class="hljs-type">pthread_t</span> tid;
<span class="hljs-type">void</span>* <span class="hljs-title function_">thread_func</span><span class="hljs-params">(<span class="hljs-type">void</span>* arg)</span> {
    <span class="hljs-comment">// çº¿ç¨‹æœ¬åœ°å­˜å‚¨</span>
    <span class="hljs-type">static</span> __thread <span class="hljs-type">int</span> thread_local_var = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}
pthread_create(&amp;tid, &amp;attr, thread_func, <span class="hljs-literal">NULL</span>);
</code></pre>
<h3 data-id="heading-4">å¤šçº¿ç¨‹ç›¸å¯¹äºå¤šè¿›ç¨‹çš„ä¼˜åŠ¿</h3>
<ol>
<li>
<p><strong>åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€</strong>ï¼šçº¿ç¨‹åˆ›å»ºæ¯”è¿›ç¨‹åˆ›å»ºå¿«10-100å€</p>
<ul>
<li>è¿›ç¨‹åˆ›å»ºï¼šå¤åˆ¶é¡µè¡¨ã€æ–‡ä»¶æè¿°ç¬¦è¡¨ç­‰ï¼Œå¼€é”€çº¦100-1000Âµs</li>
<li>çº¿ç¨‹åˆ›å»ºï¼šå…±äº«åœ°å€ç©ºé—´ï¼Œä»…éœ€åˆ†é…æ ˆå’ŒTCBï¼Œå¼€é”€çº¦1-10Âµs</li>
</ul>
</li>
<li>
<p><strong>é€šä¿¡æ•ˆç‡</strong>ï¼šçº¿ç¨‹é—´å¯ç›´æ¥é€šè¿‡å…±äº«å†…å­˜é€šä¿¡ï¼Œæ— éœ€ç³»ç»Ÿè°ƒç”¨</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è¿›ç¨‹é—´é€šä¿¡ï¼ˆéœ€è¦ç³»ç»Ÿè°ƒç”¨ï¼‰</span>
<span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
<span class="hljs-built_in">pipe</span>(pipefd);  <span class="hljs-comment">// ç³»ç»Ÿè°ƒç”¨</span>
<span class="hljs-built_in">write</span>(pipefd[<span class="hljs-number">1</span>], data, size);  <span class="hljs-comment">// ç³»ç»Ÿè°ƒç”¨ + æ•°æ®å¤åˆ¶</span>

<span class="hljs-comment">// çº¿ç¨‹é—´é€šä¿¡ï¼ˆç›´æ¥å†…å­˜è®¿é—®ï¼‰</span>
shared_buffer[index++] = data;  <span class="hljs-comment">// æ— ç³»ç»Ÿè°ƒç”¨</span>
</code></pre>
</li>
<li>
<p><strong>å†…å­˜æ•ˆç‡</strong>ï¼šå…±äº«ä»£ç æ®µã€æ•°æ®æ®µï¼Œå‡å°‘å†…å­˜å†—ä½™</p>
</li>
</ol>
<h2 data-id="heading-5">è™šæ‹Ÿå†…å­˜ï¼šç°ä»£æ“ä½œç³»ç»Ÿçš„åŸºçŸ³</h2>
<h3 data-id="heading-6">è™šæ‹Ÿåœ°å€ vs ç‰©ç†åœ°å€</h3>
<h4 data-id="heading-7">åŸºæœ¬åŒºåˆ«</h4>



































<table><thead><tr><th>ç‰¹æ€§</th><th>è™šæ‹Ÿåœ°å€</th><th>ç‰©ç†åœ°å€</th></tr></thead><tbody><tr><td>å¯è§æ€§</td><td>è¿›ç¨‹å¯è§</td><td>ç¡¬ä»¶å¯è§</td></tr><tr><td>è¿ç»­æ€§</td><td>é€»è¾‘è¿ç»­</td><td>ç‰©ç†ä¸è¿ç»­</td></tr><tr><td>å¤§å°</td><td>ç”±æ¶æ„å†³å®š(48/57ä½)</td><td>ç”±RAMå¤§å°å†³å®š</td></tr><tr><td>è½¬æ¢</td><td>éœ€é€šè¿‡MMU</td><td>ç›´æ¥å¯»å€</td></tr><tr><td>ä¿æŠ¤</td><td>æœ‰æƒé™æ§åˆ¶</td><td>æ— ä¿æŠ¤</td></tr></tbody></table>
<h4 data-id="heading-8">åœ°å€è½¬æ¢ç»†èŠ‚</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// x86-64å››çº§é¡µè¡¨è½¬æ¢è¿‡ç¨‹</span>
<span class="hljs-comment">// è™šæ‹Ÿåœ°å€ï¼š0x00007ffff7a0d000</span>
<span class="hljs-comment">// åˆ†è§£ä¸ºï¼š9ä½PML4ç´¢å¼• + 9ä½PDPTç´¢å¼• + 9ä½PDç´¢å¼• + 9ä½PTç´¢å¼• + 12ä½åç§»</span>

<span class="hljs-type">uint64_t</span> <span class="hljs-title function_">translate</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> va)</span> {
    <span class="hljs-type">uint64_t</span> pml4_idx = (va &gt;&gt; <span class="hljs-number">39</span>) &amp; <span class="hljs-number">0x1FF</span>;
    <span class="hljs-type">uint64_t</span> pdpt_idx = (va &gt;&gt; <span class="hljs-number">30</span>) &amp; <span class="hljs-number">0x1FF</span>;
    <span class="hljs-type">uint64_t</span> pd_idx   = (va &gt;&gt; <span class="hljs-number">21</span>) &amp; <span class="hljs-number">0x1FF</span>;
    <span class="hljs-type">uint64_t</span> pt_idx   = (va &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x1FF</span>;
    <span class="hljs-type">uint64_t</span> offset   = va &amp; <span class="hljs-number">0xFFF</span>;
    
    <span class="hljs-comment">// ä»CR3å¯„å­˜å™¨è·å–PML4åŸºå€</span>
    <span class="hljs-type">uint64_t</span> pml4_base = read_cr3();
    
    <span class="hljs-comment">// å„çº§é¡µè¡¨éå†ï¼ˆæ¯æ¬¡éƒ½æ˜¯å†…å­˜è®¿é—®ï¼ï¼‰</span>
    <span class="hljs-type">uint64_t</span> pml4e = *(<span class="hljs-type">uint64_t</span>*)(pml4_base + pml4_idx*<span class="hljs-number">8</span>);
    <span class="hljs-type">uint64_t</span> pdpt_base = pml4e &amp; ~<span class="hljs-number">0xFFF</span>;
    <span class="hljs-type">uint64_t</span> pdpte = *(<span class="hljs-type">uint64_t</span>*)(pdpt_base + pdpt_idx*<span class="hljs-number">8</span>);
    <span class="hljs-comment">// ... ç»§ç»­éå†</span>
    
    <span class="hljs-keyword">return</span> physical_address;
}
</code></pre>
<h3 data-id="heading-9">é¡µè¡¨ï¼šè™šæ‹Ÿå†…å­˜çš„æ ¸å¿ƒæ•°æ®ç»“æ„</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// x86-64é¡µè¡¨é¡¹ç»“æ„</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">union</span> {</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
        <span class="hljs-type">uint64_t</span> present    : <span class="hljs-number">1</span>;   <span class="hljs-comment">// é¡µæ˜¯å¦åœ¨å†…å­˜ä¸­</span>
        <span class="hljs-type">uint64_t</span> rw         : <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0=åªè¯», 1=å¯å†™</span>
        <span class="hljs-type">uint64_t</span> user       : <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0=å†…æ ¸, 1=ç”¨æˆ·</span>
        <span class="hljs-type">uint64_t</span> pwt        : <span class="hljs-number">1</span>;   <span class="hljs-comment">// å†™é€šæ¨¡å¼</span>
        <span class="hljs-type">uint64_t</span> pcd        : <span class="hljs-number">1</span>;   <span class="hljs-comment">// ç¼“å­˜ç¦ç”¨</span>
        <span class="hljs-type">uint64_t</span> accessed   : <span class="hljs-number">1</span>;   <span class="hljs-comment">// æ˜¯å¦è¢«è®¿é—®</span>
        <span class="hljs-type">uint64_t</span> dirty      : <span class="hljs-number">1</span>;   <span class="hljs-comment">// æ˜¯å¦è¢«ä¿®æ”¹</span>
        <span class="hljs-type">uint64_t</span> ps         : <span class="hljs-number">1</span>;   <span class="hljs-comment">// é¡µå¤§å° (0=4KB, 1=å¤§é¡µ)</span>
        <span class="hljs-type">uint64_t</span> global     : <span class="hljs-number">1</span>;   <span class="hljs-comment">// å…¨å±€é¡µ</span>
        <span class="hljs-type">uint64_t</span> avl        : <span class="hljs-number">3</span>;   <span class="hljs-comment">// å¯ç”¨ä½</span>
        <span class="hljs-type">uint64_t</span> address    : <span class="hljs-number">40</span>;  <span class="hljs-comment">// ç‰©ç†é¡µå¸§å·æˆ–ä¸‹ä¸€çº§é¡µè¡¨åœ°å€</span>
        <span class="hljs-type">uint64_t</span> avl2       : <span class="hljs-number">11</span>;  <span class="hljs-comment">// æ›´å¤šå¯ç”¨ä½</span>
        <span class="hljs-type">uint64_t</span> nx         : <span class="hljs-number">1</span>;   <span class="hljs-comment">// ä¸å¯æ‰§è¡Œä½</span>
    };
    <span class="hljs-type">uint64_t</span> raw;
} <span class="hljs-type">pte_t</span>;
</code></pre>
<h3 data-id="heading-10">TLBï¼šåœ°å€è½¬æ¢çš„åŠ é€Ÿå™¨</h3>
<h4 data-id="heading-11">TLBå·¥ä½œåŸç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// TLBæŸ¥æ‰¾è¿‡ç¨‹ï¼ˆç¡¬ä»¶å®ç°ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TLB</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Entry</span> {
        <span class="hljs-type">uint64_t</span> tag;       <span class="hljs-comment">// è™šæ‹Ÿé¡µå·é«˜48-12ä½</span>
        <span class="hljs-type">uint64_t</span> ppn;       <span class="hljs-comment">// ç‰©ç†é¡µå¸§å·</span>
        <span class="hljs-type">uint8_t</span> asid;       <span class="hljs-comment">// åœ°å€ç©ºé—´ID</span>
        <span class="hljs-type">bool</span> valid, dirty, global;
    } entries[<span class="hljs-number">64</span>];          <span class="hljs-comment">// å…¸å‹L1 TLBå¤§å°</span>
    
    <span class="hljs-function">PhysicalAddress <span class="hljs-title">lookup</span><span class="hljs-params">(VirtualAddress va, <span class="hljs-type">uint8_t</span> current_asid)</span> </span>{
        <span class="hljs-type">uint64_t</span> tag = va &gt;&gt; <span class="hljs-number">12</span>;  <span class="hljs-comment">// å»æ‰é¡µå†…åç§»</span>
        
        <span class="hljs-comment">// å¹¶è¡Œæ¯”è¾ƒæ‰€æœ‰æ¡ç›®ï¼ˆç¡¬ä»¶å®ç°ï¼‰</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; entry : entries) {
            <span class="hljs-keyword">if</span> (entry.valid &amp;&amp; entry.tag == tag &amp;&amp; 
                (entry.global || entry.asid == current_asid)) {
                <span class="hljs-keyword">return</span> (entry.ppn &lt;&lt; <span class="hljs-number">12</span>) | (va &amp; <span class="hljs-number">0xFFF</span>);
            }
        }
        <span class="hljs-keyword">return</span> TLB_MISS;  <span class="hljs-comment">// è§¦å‘ç¡¬ä»¶é¡µè¡¨éå†</span>
    }
};
</code></pre>
<h4 data-id="heading-12">TLBä¸å¤šçº¿ç¨‹çš„å…³ç³»</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># TLBæ€§èƒ½åˆ†æ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_tlb_performance</span>(<span class="hljs-params">threads, pages_per_thread</span>):
    tlb_entries = <span class="hljs-number">64</span>  <span class="hljs-comment"># å‡è®¾TLBæœ‰64ä¸ªæ¡ç›®</span>
    total_pages = threads * pages_per_thread
    
    <span class="hljs-keyword">if</span> total_pages &lt;= tlb_entries:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"TLBå‘½ä¸­ç‡é«˜: <span class="hljs-subst">{total_pages}</span>/<span class="hljs-subst">{tlb_entries}</span>é¡µ"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-keyword">else</span>:
        miss_rate = (total_pages - tlb_entries) / total_pages
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"TLBç¼ºå¤±ç‡é«˜: <span class="hljs-subst">{miss_rate:<span class="hljs-number">.1</span>%}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

<span class="hljs-comment"># å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹çš„TLBå½±å“</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å¤šè¿›ç¨‹ï¼ˆ4ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ª10é¡µï¼‰:"</span>)
analyze_tlb_performance(<span class="hljs-number">4</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment"># 40é¡µï¼ŒTLBå‘½ä¸­</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå¤šçº¿ç¨‹ï¼ˆ4ä¸ªçº¿ç¨‹ï¼Œå…±äº«10é¡µï¼‰:"</span>)
analyze_tlb_performance(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment"># 10é¡µï¼ŒTLBå‘½ä¸­ç‡æ›´é«˜</span>
</code></pre>
<h3 data-id="heading-13">è™šæ‹Ÿå†…å­˜çš„é«˜çº§ç‰¹æ€§</h3>
<h4 data-id="heading-14">å†™æ—¶å¤åˆ¶ï¼ˆCopy-on-Writeï¼‰</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// fork()çš„å®ç°æ ¸å¿ƒ</span>
<span class="hljs-type">pid_t</span> <span class="hljs-title function_">fork</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-comment">// 1. åˆ›å»ºå­è¿›ç¨‹task_struct</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">child</span> =</span> copy_process();
    
    <span class="hljs-comment">// 2. å¤åˆ¶çˆ¶è¿›ç¨‹åœ°å€ç©ºé—´</span>
    child-&gt;mm = copy_mm(current-&gt;mm);
    
    <span class="hljs-comment">// 3. è®¾ç½®æ‰€æœ‰é¡µè¡¨é¡¹ä¸ºåªè¯»</span>
    <span class="hljs-keyword">for</span> (each page table entry in child-&gt;mm) {
        pte = *pte_entry;
        pte.writable = <span class="hljs-number">0</span>;          <span class="hljs-comment">// æ¸…é™¤å†™æƒé™</span>
        pte.cow = <span class="hljs-number">1</span>;               <span class="hljs-comment">// æ ‡è®°ä¸ºCOWé¡µ</span>
        *pte_entry = pte;
    }
    
    <span class="hljs-comment">// 4. å½“ä»»ä¸€è¿›ç¨‹å°è¯•å†™å…¥æ—¶è§¦å‘é¡µé”™è¯¯</span>
    <span class="hljs-keyword">return</span> child-&gt;pid;
}

<span class="hljs-comment">// COWé¡µé”™è¯¯å¤„ç†</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">handle_cow_fault</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> address)</span> {
    <span class="hljs-comment">// åˆ†é…æ–°ç‰©ç†é¡µ</span>
    page = alloc_page();
    
    <span class="hljs-comment">// å¤åˆ¶åŸé¡µå†…å®¹</span>
    <span class="hljs-built_in">memcpy</span>(page, old_physical_page, PAGE_SIZE);
    
    <span class="hljs-comment">// æ›´æ–°é¡µè¡¨é¡¹ï¼Œæ¢å¤å†™æƒé™</span>
    pte = get_pte(address);
    pte.address = page_physical_address;
    pte.writable = <span class="hljs-number">1</span>;
    pte.cow = <span class="hljs-number">0</span>;
    set_pte(address, pte);
    
    <span class="hljs-comment">// ç»§ç»­æ‰§è¡Œ</span>
}
</code></pre>
<h4 data-id="heading-15">å†…å­˜æ˜ å°„æ–‡ä»¶</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// mmapç³»ç»Ÿè°ƒç”¨çš„å¨åŠ›</span>
<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-title">map_file</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* filename, <span class="hljs-type">size_t</span> size)</span> </span>{
    <span class="hljs-type">int</span> fd = <span class="hljs-built_in">open</span>(filename, O_RDONLY);
    
    <span class="hljs-comment">// å°†æ–‡ä»¶æ˜ å°„åˆ°åœ°å€ç©ºé—´</span>
    <span class="hljs-type">void</span>* addr = <span class="hljs-built_in">mmap</span>(<span class="hljs-literal">NULL</span>, size, PROT_READ, 
                     MAP_PRIVATE | MAP_POPULATE, fd, <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// ç°åœ¨å¯ä»¥åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®æ–‡ä»¶</span>
    <span class="hljs-type">char</span> first_byte = *(<span class="hljs-type">char</span>*)addr;
    
    <span class="hljs-comment">// æ“ä½œç³»ç»Ÿè´Ÿè´£æŒ‰éœ€åŠ è½½æ–‡ä»¶å†…å®¹</span>
    <span class="hljs-keyword">return</span> addr;
}

<span class="hljs-comment">// åŒ¿åæ˜ å°„ï¼ˆç”¨äºå¤§å†…å­˜åˆ†é…ï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-title">large_alloc</span><span class="hljs-params">(<span class="hljs-type">size_t</span> size)</span> </span>{
    <span class="hljs-comment">// åˆ†é…1GBè™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä½†ä¸ç«‹å³åˆ†é…ç‰©ç†å†…å­˜</span>
    <span class="hljs-type">void</span>* addr = <span class="hljs-built_in">mmap</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">30</span>, PROT_READ|PROT_WRITE,
                     MAP_PRIVATE|MAP_ANONYMOUS, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// åªæœ‰åœ¨å®é™…è®¿é—®æ—¶æ‰ä¼šåˆ†é…ç‰©ç†é¡µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; size; i += <span class="hljs-number">4096</span>) {
        ((<span class="hljs-type">char</span>*)addr)[i] = <span class="hljs-number">0</span>;  <span class="hljs-comment">// è§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼Œåˆ†é…ç‰©ç†é¡µ</span>
    }
    
    <span class="hljs-keyword">return</span> addr;
}
</code></pre>
<h2 data-id="heading-16">ç¨‹åºå¯åŠ¨æ—¶çš„å†…å­˜åˆ†é…ç»†èŠ‚</h2>
<h3 data-id="heading-17">ç¼–è¯‘å’Œé“¾æ¥é˜¶æ®µ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¯‘ä¸ºä½ç½®æ— å…³ä»£ç </span>
gcc -fPIC -c program.c -o program.o

<span class="hljs-comment"># æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ä¸­çš„åœ°å€ï¼ˆéƒ½æ˜¯ç›¸å¯¹çš„ï¼‰</span>
objdump -t program.o | <span class="hljs-built_in">head</span> -5
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># 0000000000000000 g     F .text  0000000000000015 main</span>

<span class="hljs-comment"># é“¾æ¥æ—¶ç¡®å®šè™šæ‹Ÿåœ°å€å¸ƒå±€</span>
ld program.o -o program -T linkerscript.ld
<span class="hljs-comment"># linkerscript.ldæŒ‡å®šï¼š</span>
<span class="hljs-comment"># .text èµ·å§‹äº 0x400000</span>
<span class="hljs-comment"># .data èµ·å§‹äº 0x600000</span>
</code></pre>
<h3 data-id="heading-18">åŠ è½½æ‰§è¡Œé˜¶æ®µ</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// execç³»ç»Ÿè°ƒç”¨çš„å…³é”®æ­¥éª¤</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">execve</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">char</span> *<span class="hljs-type">const</span> argv[], <span class="hljs-type">char</span> *<span class="hljs-type">const</span> envp[])</span> {
    <span class="hljs-comment">// 1. åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶å¤´éƒ¨</span>
    elf_header = load_elf_header(filename);
    
    <span class="hljs-comment">// 2. åˆ›å»ºæ–°çš„åœ°å€ç©ºé—´</span>
    mm = create_new_mm();
    
    <span class="hljs-comment">// 3. è®¾ç½®è™šæ‹Ÿå†…å­˜åŒºåŸŸï¼ˆVMAï¼‰</span>
    <span class="hljs-keyword">for</span> (each program segment in elf_header) {
        vma = add_vma(mm, segment.virtual_addr, segment.size,
                      segment.flags);  <span class="hljs-comment">// PROT_READç­‰</span>
        
        <span class="hljs-comment">// æ³¨æ„ï¼šæ­¤æ—¶åªè®°å½•äº†è™šæ‹Ÿåœ°å€èŒƒå›´ï¼Œæ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜ï¼</span>
        <span class="hljs-comment">// é¡µè¡¨é¡¹è¢«æ ‡è®°ä¸º"ä¸å­˜åœ¨"</span>
    }
    
    <span class="hljs-comment">// 4. è®¾ç½®æ ˆåŒºåŸŸ</span>
    setup_stack(mm, initial_stack_pointer);
    
    <span class="hljs-comment">// 5. è®¾ç½®argc, argv, envpåˆ°æ ˆä¸­</span>
    
    <span class="hljs-comment">// 6. è®¾ç½®ç¨‹åºè®¡æ•°å™¨ï¼Œå¼€å§‹æ‰§è¡Œ</span>
    start_thread(regs, entry_point);
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// å¦‚æœæˆåŠŸï¼Œä¸ä¼šè¿”å›</span>
}
</code></pre>
<h3 data-id="heading-19">ç¬¬ä¸€æ¬¡å†…å­˜è®¿é—®çš„çœŸç›¸</h3>
<pre><code class="hljs language-assembly" lang="assembly"># ç¨‹åºçš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œæ—¶
_start:
    mov rax, [rip + global_var]  # è®¿é—®å…¨å±€å˜é‡
    
# ä¼šå‘ç”Ÿï¼š
# 1. CPUå°†è™šæ‹Ÿåœ°å€å‘ç»™MMU
# 2. MMUæŸ¥TLB â†’ æœªå‘½ä¸­ï¼ˆç¬¬ä¸€æ¬¡è®¿é—®ï¼‰
# 3. MMUæŸ¥é¡µè¡¨ â†’ PTE.present = 0ï¼ˆé¡µä¸åœ¨å†…å­˜ï¼‰
# 4. è§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼ˆPage Faultï¼Œä¸­æ–­14ï¼‰
# 5. å†…æ ¸ç¼ºé¡µå¤„ç†ç¨‹åºï¼š
#    - æ£€æŸ¥åœ°å€æ˜¯å¦åˆæ³•ï¼ˆåœ¨VMAä¸­ï¼‰
#    - åˆ†é…ç‰©ç†é¡µå¸§
#    - ä»ç£ç›˜åŠ è½½æ•°æ®ï¼ˆå¦‚æœæ˜¯æ–‡ä»¶æ˜ å°„ï¼‰
#    - æˆ–å¡«å……é›¶ï¼ˆå¦‚æœæ˜¯åŒ¿åæ˜ å°„ï¼‰
#    - è®¾ç½®PTEä¸ºpresent
# 6. è¿”å›ç”¨æˆ·æ€ï¼Œé‡æ–°æ‰§è¡ŒæŒ‡ä»¤
</code></pre>
<h2 data-id="heading-20">ç°ä»£å†…å­˜ç®¡ç†çš„ä¼˜åŒ–æŠ€æœ¯</h2>
<h3 data-id="heading-21">é€æ˜å¤§é¡µï¼ˆTransparent Huge Pagesï¼‰</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å†…æ ¸è‡ªåŠ¨å°†è¿ç»­çš„4KBé¡µåˆå¹¶ä¸º2MBå¤§é¡µ</span>
<span class="hljs-type">bool</span> <span class="hljs-title function_">try_thp</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> vm_area_struct *vma, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> address)</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ»¡è¶³å¤§é¡µæ¡ä»¶</span>
    <span class="hljs-keyword">if</span> (vma-&gt;vm_flags &amp; VM_NOHUGEPAGE)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰è¿ç»­çš„512ä¸ª4KBé¡µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">512</span>; i++) {
        <span class="hljs-keyword">if</span> (!page_is_present(vma, address + i*<span class="hljs-number">4096</span>))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (!pages_have_same_permissions(...))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// æ›¿æ¢ä¸ºå•ä¸ª2MBé¡µè¡¨é¡¹</span>
    replace_4k_entries_with_2m_entry(vma, address);
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">// ä¼˜åŠ¿ï¼šå‡å°‘TLBå‹åŠ›ï¼Œæå‡æ€§èƒ½</span>
<span class="hljs-comment">// 2MBé¡µï¼šä¸€ä¸ªTLBæ¡ç›®è¦†ç›–2MBå†…å­˜</span>
<span class="hljs-comment">// 4KBé¡µï¼šéœ€è¦512ä¸ªTLBæ¡ç›®è¦†ç›–ç›¸åŒèŒƒå›´</span>
</code></pre>
<h3 data-id="heading-22">å†…å­˜å‹ç¼©ï¼ˆZswap/Zramï¼‰</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¼ ç»Ÿäº¤æ¢ vs å†…å­˜å‹ç¼©äº¤æ¢</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">handle_memory_pressure</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-keyword">if</span> (zswap_enabled) {
        <span class="hljs-comment">// 1. é€‰æ‹©å€™é€‰é¡µè¿›è¡Œå‹ç¼©</span>
        page = select_page_to_evict();
        
        <span class="hljs-comment">// 2. å‹ç¼©é¡µé¢ï¼ˆä½¿ç”¨LZ4ç­‰ç®—æ³•ï¼‰</span>
        compressed_data = compress_page(page);
        
        <span class="hljs-comment">// 3. å­˜å‚¨åˆ°ZRAMï¼ˆå‹ç¼©å†…å­˜æ± ï¼‰</span>
        zram_store(compressed_data);
        
        <span class="hljs-comment">// 4. é‡Šæ”¾åŸç‰©ç†é¡µ</span>
        free_page(page);
        
        <span class="hljs-comment">// 5. æ ‡è®°é¡µè¡¨é¡¹ä¸º"å‹ç¼©å­˜å‚¨"</span>
        pte.present = <span class="hljs-number">0</span>;
        pte.swapped = <span class="hljs-number">1</span>;
        pte.zram_offset = offset;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ä¼ ç»Ÿäº¤æ¢åˆ°ç£ç›˜ï¼ˆæ…¢ï¼ï¼‰</span>
        swap_out_to_disk(page);
    }
}
</code></pre>
<h3 data-id="heading-23">è¿›ç¨‹é—´å…±äº«å†…å­˜ä¼˜åŒ–</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å…±äº«å†…å­˜çš„é«˜æ•ˆä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedMemoryManager</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> shm_fd;
    <span class="hljs-type">void</span>* shm_addr;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">SharedMemoryManager</span>(<span class="hljs-type">size_t</span> size) {
        <span class="hljs-comment">// åˆ›å»ºå…±äº«å†…å­˜å¯¹è±¡</span>
        shm_fd = <span class="hljs-built_in">shm_open</span>(<span class="hljs-string">"/my_shm"</span>, O_CREAT | O_RDWR, <span class="hljs-number">0666</span>);
        <span class="hljs-built_in">ftruncate</span>(shm_fd, size);
        
        <span class="hljs-comment">// æ˜ å°„åˆ°åœ°å€ç©ºé—´</span>
        shm_addr = <span class="hljs-built_in">mmap</span>(<span class="hljs-literal">NULL</span>, size, PROT_READ | PROT_WRITE,
                       MAP_SHARED, shm_fd, <span class="hljs-number">0</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨å¤§é¡µä¼˜åŒ–</span>
        <span class="hljs-built_in">madvise</span>(shm_addr, size, MADV_HUGEPAGE);
    }
    
    <span class="hljs-comment">// è¿›ç¨‹é—´é«˜æ•ˆé€šä¿¡</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">send_data</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* data, <span class="hljs-type">size_t</span> size)</span> </span>{
        <span class="hljs-comment">// ç›´æ¥å†…å­˜æ‹·è´ï¼Œæ— éœ€ç³»ç»Ÿè°ƒç”¨</span>
        <span class="hljs-built_in">memcpy</span>(shm_addr, data, size);
        
        <span class="hljs-comment">// ä½¿ç”¨å†…å­˜å±éšœç¡®ä¿å¯è§æ€§</span>
        std::<span class="hljs-built_in">atomic_thread_fence</span>(std::memory_order_release);
    }
};
</code></pre>
<h2 data-id="heading-24">æ€§èƒ½è°ƒä¼˜å®æˆ˜æŒ‡å—</h2>
<h3 data-id="heading-25">è¯Šæ–­å†…å­˜æ€§èƒ½é—®é¢˜</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹è™šæ‹Ÿå†…å­˜ç»Ÿè®¡</span>
<span class="hljs-built_in">cat</span> /proc/meminfo
<span class="hljs-comment"># å…³æ³¨ï¼šAnonPages, PageTables, SwapCached, HugePages</span>

<span class="hljs-comment"># 2. ç›‘æ§ç¼ºé¡µå¼‚å¸¸</span>
perf <span class="hljs-built_in">stat</span> -e page-faults,dTLB-load-misses,iTLB-load-misses ./program

<span class="hljs-comment"># 3. åˆ†æå†…å­˜è®¿é—®æ¨¡å¼</span>
valgrind --tool=cachegrind ./program
<span class="hljs-comment"># è¾“å‡ºLLdï¼ˆæœ€åä¸€çº§æ•°æ®ç¼“å­˜ï¼‰ç¼ºå¤±ç‡</span>

<span class="hljs-comment"># 4. æŸ¥çœ‹TLBå‹åŠ›</span>
perf <span class="hljs-built_in">stat</span> -e dtlb_load_misses.stlb_hit,dtlb_load_misses.walk_active ./program
</code></pre>
<h3 data-id="heading-26">ä¼˜åŒ–çº¿ç¨‹æ•°çš„é€‰æ‹©</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æœ€ä¼˜çº¿ç¨‹æ•°è®¡ç®—å…¬å¼</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">optimal_thread_count</span>(<span class="hljs-params">cpu_cores, task_type</span>):
    <span class="hljs-keyword">if</span> task_type == <span class="hljs-string">"cpu_bound"</span>:
        <span class="hljs-comment"># CPUå¯†é›†å‹ï¼šçº¿ç¨‹æ•° â‰ˆ æ ¸å¿ƒæ•°</span>
        <span class="hljs-keyword">return</span> cpu_cores
    <span class="hljs-keyword">elif</span> task_type == <span class="hljs-string">"io_bound"</span>:
        <span class="hljs-comment"># I/Oå¯†é›†å‹ï¼šå¯ä»¥æ›´å¤šçº¿ç¨‹</span>
        <span class="hljs-keyword">return</span> cpu_cores * <span class="hljs-number">2</span>  <span class="hljs-comment"># ç»éªŒå€¼</span>
    <span class="hljs-keyword">elif</span> task_type == <span class="hljs-string">"memory_bound"</span>:
        <span class="hljs-comment"># å†…å­˜å¯†é›†å‹ï¼šè€ƒè™‘å†…å­˜å¸¦å®½</span>
        memory_bandwidth = get_memory_bandwidth()
        per_thread_bandwidth = estimate_bandwidth_per_thread()
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(cpu_cores, memory_bandwidth / per_thread_bandwidth)

<span class="hljs-comment"># è€ƒè™‘è¶…çº¿ç¨‹çš„å½±å“</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">with_hyperthreading</span>(<span class="hljs-params">cpu_cores, has_ht</span>):
    physical_cores = cpu_cores // <span class="hljs-number">2</span> <span class="hljs-keyword">if</span> has_ht <span class="hljs-keyword">else</span> cpu_cores
    <span class="hljs-keyword">return</span> physical_cores
</code></pre>
<h3 data-id="heading-27">å†…å­˜è®¿é—®æ¨¡å¼ä¼˜åŒ–</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä¼˜åŒ–å‰ï¼šéšæœºè®¿é—®æ¨¡å¼</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_random</span><span class="hljs-params">(<span class="hljs-type">int</span>* data, <span class="hljs-type">int</span>* indices, <span class="hljs-type">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        data[indices[i]] *= <span class="hljs-number">2</span>;  <span class="hljs-comment">// éšæœºè®¿é—®ï¼Œç¼“å­˜ä¸å‹å¥½</span>
    }
}

<span class="hljs-comment">// ä¼˜åŒ–åï¼šé¡ºåºè®¿é—®æ¨¡å¼</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_sequential</span><span class="hljs-params">(<span class="hljs-type">int</span>* data, <span class="hljs-type">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        data[i] *= <span class="hljs-number">2</span>;  <span class="hljs-comment">// é¡ºåºè®¿é—®ï¼Œç¼“å­˜å‹å¥½</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨é¢„å–ä¼˜åŒ–</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_with_prefetch</span><span class="hljs-params">(<span class="hljs-type">int</span>* data, <span class="hljs-type">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i += <span class="hljs-number">8</span>) {
        _mm_prefetch(&amp;data[i + <span class="hljs-number">64</span>], _MM_HINT_T0);  <span class="hljs-comment">// é¢„å–æœªæ¥æ•°æ®</span>
        <span class="hljs-comment">// å¤„ç†å½“å‰æ•°æ®å—</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++) {
            data[i + j] *= <span class="hljs-number">2</span>;
        }
    }
}
</code></pre>
<h2 data-id="heading-28">ç»“è®º</h2>
<p>ç°ä»£è®¡ç®—ç³»ç»Ÿçš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¯¹å†…å­˜å±‚æ¬¡ç»“æ„çš„ç†è§£å’Œç®¡ç†ï¼š</p>
<ol>
<li><strong>å¯„å­˜å™¨</strong>ï¼šæœ€å¿«ï¼Œä½†æ•°é‡æœ‰é™ï¼ˆ~1å‘¨æœŸï¼‰</li>
<li><strong>L1/L2/L3ç¼“å­˜</strong>ï¼šSRAMï¼Œå®¹é‡é€’å¢ï¼Œé€Ÿåº¦é€’å‡ï¼ˆ~1-30å‘¨æœŸï¼‰</li>
<li><strong>TLB</strong>ï¼šä¸“ç”¨çš„åœ°å€è½¬æ¢ç¼“å­˜ï¼ˆ~1-10å‘¨æœŸï¼‰</li>
<li><strong>ç‰©ç†å†…å­˜ï¼ˆDRAMï¼‰</strong>ï¼šä¸»å†…å­˜ï¼ˆ~50-200å‘¨æœŸï¼‰</li>
<li><strong>å­˜å‚¨è®¾å¤‡ï¼ˆSSD/HDDï¼‰</strong>ï¼šæ…¢é€Ÿåå¤‡å­˜å‚¨ï¼ˆ~10â´-10â¶å‘¨æœŸï¼‰</li>
</ol>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹çš„ä¼˜åŠ¿åœ¨äºå…±äº«TLBå’Œç¼“å­˜ï¼Œå‡å°‘åœ°å€è½¬æ¢å¼€é”€</li>
<li>è™šæ‹Ÿå†…å­˜é€šè¿‡æŒ‰éœ€åˆ†é…ã€å†™æ—¶å¤åˆ¶ç­‰æœºåˆ¶å®ç°é«˜æ•ˆèµ„æºåˆ©ç”¨</li>
<li>ç†è§£è®¿é—®æ¨¡å¼ï¼ˆé¡ºåºvséšæœºï¼‰å¯¹æ€§èƒ½å½±å“å·¨å¤§</li>
<li>ä¼˜åŒ–åº”è¯¥åŸºäºå®é™…ç¡¬ä»¶ç‰¹æ€§ï¼ˆTLBå¤§å°ã€ç¼“å­˜è¡Œå¤§å°ç­‰ï¼‰</li>
</ul>
<p>æœ€ç»ˆï¼Œé«˜æ•ˆçš„ç³»ç»Ÿç¼–ç¨‹éœ€è¦æ·±å…¥ç†è§£è¿™äº›å±‚æ¬¡ä¹‹é—´çš„äº¤äº’ï¼Œä»¥åŠè¿›ç¨‹ã€çº¿ç¨‹å¦‚ä½•åœ¨è¿™äº›å±‚æ¬¡ä¸Šé«˜æ•ˆåœ°ååŒå·¥ä½œã€‚è™šæ‹Ÿå†…å­˜ä¸ä»…ä»…æ˜¯éš”ç¦»è¿›ç¨‹çš„å·¥å…·ï¼Œæ›´æ˜¯ç°ä»£æ“ä½œç³»ç»Ÿå®ç°é«˜æ•ˆã€å®‰å…¨ã€çµæ´»å†…å­˜ç®¡ç†çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uniapp ä¸‹æ‹‰åˆ·æ–°ç»ˆææ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7581312433529077803</link>    <guid>https://juejin.cn/post/7581312433529077803</guid>    <pubDate>2025-12-08T09:05:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581312433529077803" data-draft-id="7566096665724878883" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uniapp ä¸‹æ‹‰åˆ·æ–°ç»ˆææ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T09:05:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè‚‰çš„å°é£çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/4195392103385911"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uniapp ä¸‹æ‹‰åˆ·æ–°ç»ˆææ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4195392103385911/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè‚‰çš„å°é£çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:05:37.000Z" title="Mon Dec 08 2025 09:05:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">z-paging</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fext.dcloud.net.cn%2Fplugin%3Fid%3D3935" target="_blank" title="https://ext.dcloud.net.cn/plugin?id=3935" ref="nofollow noopener noreferrer">ã€z-pagingä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½ã€‘é«˜æ€§èƒ½ï¼Œå…¨å¹³å°å…¼å®¹ã€‚æ”¯æŒè™šæ‹Ÿåˆ—è¡¨ï¼Œåˆ†é¡µå…¨è‡ªåŠ¨å¤„ç†</a></p>
<p>éå¸¸å¥½ç”¨ï¼Œ å¿…é¡»ç‚¹èµã€‚</p>
<p>uniapp å®˜æ–¹çš„ä¸‹æ‹‰åˆ·æ–°å¥½åƒæœ‰å¥½å¤šé—®é¢˜ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆå¿˜è®°äº†ï¼Œåæ­£ç¥å‘æ— æ¯”ã€‚</p>
<p>z-paging æŒºå¥½ç”¨çš„ï¼Œ ä¸è¿‡å¥½åƒä¼šå’Œå±€éƒ¨çš„ <code>scroll-view</code> ç»„ä»¶å†²çªï¼Œç°è±¡å°±æ˜¯ä¸‹æ‹‰åˆ·æ–°ä¼šä¸€è·³ä¸€è·³çš„ï¼Œ ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œ ä¸è¿‡é—®é¢˜ä¸æ˜¯å¾ˆå¤§ï¼Œ å°†å°±ç”¨å§ã€‚</p>
<h2 data-id="heading-1">ä¸‹æ‹‰åˆ·æ–°ä½¿ç”¨</h2>
<pre><code class="hljs language-vue" lang="vue">
&lt;ZPaging
    ref="pagingRef"
    :fixed="false"
    refresher-only
    @onRefresh="onRefresh"
    refresher-default-text="ä¸‹æ‹‰åˆ·æ–°"
    refresher-pulling-text="é‡Šæ”¾åˆ·æ–°"
    refresher-refreshing-text="åˆ·æ–°ä¸­..."
    refresher-complete-text="åˆ·æ–°å®Œæˆ"
    :refresher-title-style="{ fontSize: '14px' }"
&gt;
    &lt;view&gt;
            &lt;Total @onRefresh="onRefreshed"&gt;&lt;/Total&gt;
            &lt;City @onRefresh="onRefreshed"&gt;&lt;/City&gt;
            &lt;Brand @onRefresh="onRefreshed"&gt;&lt;/Brand&gt;
    &lt;/view&gt;
&lt;/ZPaging&gt;

// import ZPaging from "@/uni_modules/z-paging/components/z-paging/z-paging.vue";
</code></pre>
<p><em>æœ‰ä¸€ä¸ªé—®é¢˜åœ¨çº¿æ±‚åŠ©ï¼Œ å°±æ˜¯åœ¨åº•éƒ¨ä¼šå‡ºç°å¤§é¢ç§¯ç•™ç™½</em></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/076dae13ca904ac69b03efec1e856b53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCD6IKJ55qE5bCP6aOe54yq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765789536&amp;x-signature=Qx0NemoGunBBnz41ZY%2FYq2ll%2FOQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">ai èŠå¤©ç»„ä»¶</h2>
<p>å¯¹è¯å†…å®¹å’Œè¾“å…¥æ¡†éƒ½å¯ä»¥è‡ªå®šä¹‰ã€‚éå¸¸æ–¹ä¾¿ã€‚å…·ä½“çš„å®˜æ–¹æœ‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fz-paging.zxlee.cn%2Fmodule%2Fchat-record-mode.html" target="_blank" title="https://z-paging.zxlee.cn/module/chat-record-mode.html" ref="nofollow noopener noreferrer">ç¤ºä¾‹</a>ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;z-paging
      ref="pagingRef"
      :fixed="false"
      :refresher-enabled="false"
      :refresher-default-style="'none'"
      v-model="chatHistories"
      use-chat-record-mode
      :safe-area-inset-bottom="false"
      bottom-bg-color="#FBFAFA"
      :calcKeyboardHeight="calcKeyboardHeight"
    &gt;
      &lt;!-- forå¾ªç¯æ¸²æŸ“èŠå¤©è®°å½•åˆ—è¡¨ --&gt;
      &lt;view
        v-for="(chatItem, index) in chatHistories"
        :key="chatItem.id"
        style="position: relative"
      &gt;
        &lt;!-- style="transform: scaleY(-1)"å¿…é¡»å†™ï¼Œå¦åˆ™ä¼šå¯¼è‡´åˆ—è¡¨å€’ç½® --&gt;
        &lt;!-- æ³¨æ„ä¸è¦ç›´æ¥åœ¨chat-itemç»„ä»¶æ ‡ç­¾ä¸Šè®¾ç½®styleï¼Œå› ä¸ºåœ¨å¾®ä¿¡å°ç¨‹åºä¸­æ˜¯æ— æ•ˆçš„ï¼Œè¯·åŒ…ä¸€å±‚view --&gt;
        &lt;view style="transform: scaleY(-1)"&gt;
          &lt;!-- å¯¹è¯æ¶ˆæ¯ç»„ä»¶ --&gt;
          &lt;ChatItem :message="chatItem" @onSelectOption="handleSelectOption" /&gt;
        &lt;/view&gt;
      &lt;/view&gt;
      &lt;!-- åº•éƒ¨èŠå¤©è¾“å…¥æ¡† --&gt;
      &lt;template #bottom&gt;
        &lt;view class="chat-input-container"&gt;
          &lt;Question
            :status="networkStatus"
            :question="userMsg"
            @onSend="(params: any) =&gt; doSend(params.question)"
            @onCancel="handleCancel"
          /&gt;
        &lt;/view&gt;
      &lt;/template&gt;
    &lt;/z-paging&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Xcode 26 Navigator å¿«æ·é”®]]></title>    <link>https://juejin.cn/post/7581251003329806362</link>    <guid>https://juejin.cn/post/7581251003329806362</guid>    <pubDate>2025-12-08T09:11:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581251003329806362" data-draft-id="7581406561684373550" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Xcode 26 Navigator å¿«æ·é”®"/> <meta itemprop="keywords" content="Xcode"/> <meta itemprop="datePublished" content="2025-12-08T09:11:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiAo_Ju"/> <meta itemprop="url" content="https://juejin.cn/user/3966693681926029"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Xcode 26 Navigator å¿«æ·é”®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693681926029/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiAo_Ju
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:11:46.000Z" title="Mon Dec 08 2025 09:11:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a581891c67b458995789f09bf006e43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlBb19KdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765789905&amp;x-signature=Wvm3R%2FQgYDPrYQeowLJCWYzVKzc%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP ç½‘å…³å®æˆ˜ï¼šåŸºäº Higress + Nacos çš„é›¶ä»£ç å·¥å…·æ‰©å±•æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7581210455827021860</link>    <guid>https://juejin.cn/post/7581210455827021860</guid>    <pubDate>2025-12-08T09:15:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581210455827021860" data-draft-id="7581117416810954795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCP ç½‘å…³å®æˆ˜ï¼šåŸºäº Higress + Nacos çš„é›¶ä»£ç å·¥å…·æ‰©å±•æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ,MCP"/> <meta itemprop="datePublished" content="2025-12-08T09:15:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCP ç½‘å…³å®æˆ˜ï¼šåŸºäº Higress + Nacos çš„é›¶ä»£ç å·¥å…·æ‰©å±•æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:15:17.000Z" title="Mon Dec 08 2025 09:15:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šé™†èƒ¤ä»»</p>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨ AI å¤§çˆ†å‘çš„æ—¶ä»£ï¼Œå·²ç»æœ‰éå¸¸å¤šçš„ AI åŠ©æ‰‹ï¼Œç»“åˆ RAG é€šè¿‡æ™ºèƒ½é—®ç­”å¸®åŠ©ç”¨æˆ·è§£ç­”é—®é¢˜ã€‚å•çº¯åœ°ä¾é æ™ºèƒ½é—®ç­”å¸®åŠ©å®¢æˆ·è‡ªåŠ©è§£ç­”æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦è®© AI åŠ©æ‰‹èƒ½å¤Ÿç›´æ¥è°ƒç”¨å·²æœ‰çš„ä¸°å¯Œæ¥å£ï¼Œæœç€æ›´å¼ºå¤§çš„æ™ºèƒ½ä½“æ¼”è¿›ã€‚æˆ‘ä»¬é€‰ç”¨å½“ä¸‹æœ€ä¸ºç«çƒ­ï¼Œä¸”å·²é€æ­¥æˆä¸ºæ ‡å‡†çš„ MCP ä½œä¸ºæ¨¡å‹å’Œæ¥å£ä¹‹é—´é€šä¿¡çš„ä¼ è¾“åè®®ã€‚å…³äº MCPï¼Œå·²æœ‰éå¸¸å¤šçš„ä»‹ç»æ–‡ç« ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°ã€‚</p>
<p>åœ¨ä¼ä¸šå¯¹å¤–æœåŠ¡çš„åœºæ™¯ä¸‹ï¼ŒMCP Server éœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>åœ¨æœåŠ¡çš„å¤šå®ä¾‹é«˜å¯ç”¨åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ SSE é€šä¿¡æ–¹å¼å¦‚ä½•ç»´æŠ¤ sessionï¼›</li>
<li>å¦‚ä½•åšåˆ°åŠ¨æ€æ›´æ–° MCP å·¥å…· Promptï¼Œåšåˆ°å¿«é€Ÿæ›´æ–°&amp;è°ƒè¯•&amp;éªŒè¯ï¼›</li>
<li>ç§Ÿæˆ·éš”ç¦»çš„äº‘æœåŠ¡åœºæ™¯ä¸‹å¦‚ä½•å¯¹ç”¨æˆ·çš„å·¥å…·è°ƒç”¨è¿›è¡Œé‰´æƒã€‚</li>
</ol>
<p>Higress å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸Šé¢çš„é—®é¢˜ 1ï¼ŒåŒæ—¶è¿˜æœ‰å®Œå–„çš„è¿ç»´ç›‘æ§ä½“ç³»ï¼Œå¯è§†åŒ–æ˜“æ“ä½œçš„æ§åˆ¶å°ç•Œé¢ã€‚ä¸ºäº†è§£å†³é—®é¢˜ 2ï¼Œæˆ‘ä»¬å¼•å…¥äº† Nacos è´Ÿè´£æ³¨å†Œåç«¯æœåŠ¡ä»¥åŠç®¡ç†ç»´æŠ¤ MCP å·¥å…·çš„å…ƒæ•°æ®ç­‰ä¿¡æ¯ã€‚åœ¨æ•´ä¸ª MCP æœåŠ¡ä¸­ï¼ŒHigress æ‹…ä»» MCP Proxy çš„è§’è‰²ï¼ŒNacos æ‹…ä»» MCP Registry çš„è§’è‰²ã€‚å¯¹äºé—®é¢˜ 3 ç§Ÿæˆ·éš”ç¦»é—®é¢˜ï¼Œä¼šåœ¨ä¸‹é¢é‰´æƒç« èŠ‚ä¸­è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0eba8180a02843ce87ac6f061198089e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=8xZCfZ5StfBcfQ3vwZCzcM8RqwM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Higress å’Œ Nacos éƒ½æ˜¯äº‘åŸç”Ÿçš„åº”ç”¨ï¼Œåœ¨éƒ¨ç½²æ–¹é¢ï¼Œè‡ªç„¶é€‰æ‹©ä½¿ç”¨ K8s é›†ç¾¤è¿›è¡Œäº‘åŸç”Ÿéƒ¨ç½²ã€‚åŒæ—¶å¾ˆå¤šä¼ä¸šæœ‰è‡ªå·±çš„ä¸“å±ç”Ÿäº§ç½‘ç»œç¯å¢ƒï¼Œä¸€èˆ¬å’Œå¤–ç½‘ä¸é€šï¼Œå› æ­¤æœ¬æ–‡ä¼šå›´ç»•å¦‚ä½•åˆ©ç”¨ç¤¾åŒºç‰ˆæœ¬çš„ Higress å’Œ Nacosï¼ˆApache-2.0 å¼€æºåè®®ï¼‰è¿›è¡Œç§æœ‰åŒ–éƒ¨ç½²ã€‚å› ä¸ºå†…éƒ¨ç¯å¢ƒçš„é™åˆ¶ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ç›´æ¥é€šè¿‡ Helm æ“ä½œ K8s é›†ç¾¤è¿›è¡Œéƒ¨ç½²ï¼Œå› æ­¤æœ¬æ–‡ä¼šå›´ç»•å¦‚ä½•åŸºäº Higress å’Œ Nacos çš„ docker é•œåƒåœ¨ K8s é›†ç¾¤ä¸Šè¿›è¡Œåˆ†è§’è‰²éƒ¨ç½²ã€‚</p>
<p>é€šè¿‡è¿™å¥—è‡ªå»ºçš„ç½‘å…³æœåŠ¡ï¼Œä½¿ç”¨é…ç½®å³å¯å®ç°é›¶ä»£ç æ‰©å±• Toolï¼Œæ–°åº”ç”¨çš„æ³¨å†Œã€åº”ç”¨ä¸‹é¢å·¥å…·çš„æ‰©å±•ã€å·¥å…· prompt æ›´æ–°éªŒè¯éƒ½èƒ½é€šè¿‡æœåŠ¡é›†æˆçš„å¯è§†åŒ–æ§åˆ¶å°ï¼Œæ›´æ–°å‘å¸ƒé…ç½®å¿«é€Ÿå®Œæˆï¼Œ<strong>æ¥å…¥æ–¹å¼æå…¶ç®€å•ï¼æ›´æ–°éªŒè¯æå…¶å¿«é€Ÿï¼</strong> åŒæ—¶åˆ©ç”¨ Nacos çš„å‘½åç©ºé—´èƒ½åŠ›å¯ä»¥åšåˆ°æœåŠ¡å’Œå·¥å…·é›†çš„éš”ç¦»ï¼Œç»™ä¸åŒçš„ç”¨æˆ·æä¾›ä¸åŒçš„ MCP å·¥å…·é›†ã€‚</p>
<h2 data-id="heading-1">ç§æœ‰åŒ–éƒ¨ç½²</h2>
<h3 data-id="heading-2">Higress</h3>
<p>Higress æ”¯æŒä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼šHelmã€docker compose å’ŒåŸºäº all-in-one çš„Â docker é•œåƒè¿›è¡Œéƒ¨ç½²ã€‚Higress å®˜æ–¹æ¨èä½¿ç”¨ Helm çš„æ–¹å¼è¿›è¡Œç”Ÿäº§ç¯å¢ƒçš„éƒ¨ç½²ï¼Œå°†ä¾èµ–çš„æ¨¡å—éƒ¨ç½²åœ¨ä¸åŒçš„ pod ä¸Šã€‚è€Œå› ä¸Šè¿°ç¯å¢ƒåŸå› ï¼Œè¿™é‡Œé€‰æ‹©ä½¿ç”¨ç¬¬ä¸‰ç§åŸºäº all-in-one çš„ dockerÂ é•œåƒÂ Dockerfile <strong>[</strong> <strong>1]</strong> è¿›è¡Œéƒ¨ç½²ï¼Œå°† Higress ä¾èµ–çš„ç»„ä»¶ä»¥è¿›ç¨‹çš„æ–¹å¼éƒ¨ç½²åœ¨åŒä¸€ pod ä¸Šé¢ï¼Œé€šè¿‡å¤šå‰¯æœ¬çš„æ–¹å¼å®ç°æœåŠ¡é«˜å¯ç”¨ï¼Œä¹Ÿå®ç°äº†å¯¹ K8s é›†ç¾¤ Ingress çš„æ— ä¾µå…¥å¼éƒ¨ç½²ã€‚</p>
<p>æˆ‘ä»¬å…ˆå°è¯•ç›´æ¥å¼•ç”¨ docker é•œåƒè¿›è¡Œéƒ¨ç½²æ—¶ï¼Œä¼šæŠ¥ WASM çš„æ’ä»¶é”™è¯¯ï¼ŒæŸ¥çœ‹æŠ¥é”™ä¿¡æ¯æ˜¯é€šè¿‡ oci åœ°å€å»ä¸‹è½½ WASM æ’ä»¶çš„æ—¶å€™å‡ºç°äº†é—®é¢˜ã€‚åŒæ—¶ Higress å®ç° MCP åŠŸèƒ½ä¹Ÿä¾èµ–äº† WASM æ’ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªç»•ä¸å¼€çš„é—®é¢˜ã€‚ï»¿</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">FROM</span>Â higress<span class="hljs-operator">-</span>registry.cn<span class="hljs-operator">-</span>hangzhou.cr.aliyuncs.com<span class="hljs-operator">/</span>higress<span class="hljs-operator">/</span><span class="hljs-keyword">all</span><span class="hljs-operator">-</span><span class="hljs-keyword">in</span><span class="hljs-operator">-</span><span class="hljs-keyword">one</span>:latest
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1242b0ea9ed342978a58e041aad988b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=154nLMQJywrRr6GiHWBfSzhtve0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-3">WASM æ’ä»¶ç‹¬ç«‹éƒ¨ç½²</h4>
<p>Higress çš„Â plugin-server <strong>[</strong> <strong>2]</strong> é¡¹ç›®å°±æ˜¯ä¸ºäº†â€œè§£å†³ç§æœ‰åŒ–éƒ¨ç½² Higress ç½‘å…³æ—¶æ‹‰å–æ’ä»¶çš„ç—›ç‚¹ï¼Œä¼˜åŒ–äº†æ’ä»¶çš„ä¸‹è½½ä¸ç®¡ç†æ•ˆç‡â€ï¼Œä½¿ Higress é€šè¿‡ http çš„æ–¹å¼å»ä¸‹è½½ç‹¬ç«‹éƒ¨ç½²çš„æ’ä»¶åº“ï¼Œè€Œä¸æ˜¯é€šè¿‡ oci å»è®¿é—®å¤–éƒ¨å…¬å¼€ä»“åº“ï¼Œé¿å…å› ç½‘ç»œé—®é¢˜å¯¼è‡´æ’ä»¶æ‹‰å–ä¸ä¸‹æ¥ã€‚è§£å†³è¿‡ç¨‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<p><strong>1ï¼‰ç§æœ‰åŒ–éƒ¨ç½² plugin-server</strong></p>
<pre><code class="hljs language-bash" lang="bash">FROMÂ higress-registry.cn-hangzhou.cr.aliyuncs.com/higress/plugin-server:1.0.0
</code></pre>
<p><strong>2ï¼‰ä¸º plugin-server é›†ç¾¤ç”³è¯· K8s Serviceï¼ˆCluster IPï¼‰</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
Â  <span class="hljs-attr">name:</span> <span class="hljs-string">higress-plugin-server</span>
Â  <span class="hljs-attr">namespace:</span> <span class="hljs-string">higress-system</span>
Â  <span class="hljs-attr">labels:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">higress-plugin-server</span>
Â  Â  <span class="hljs-attr">higress:</span> <span class="hljs-string">higress-plugin-server</span>
<span class="hljs-attr">spec:</span>
Â  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>
Â  <span class="hljs-attr">ports:</span>
Â  Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">80</span>
Â  Â  Â  <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
Â  Â  Â  <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8080</span>
Â  <span class="hljs-attr">selector:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">higress-plugin-server</span>
Â  Â  <span class="hljs-attr">higress:</span> <span class="hljs-string">higress-plugin-server</span>
</code></pre>
<p>K8s é›†ç¾¤å†…ç½®çš„ DNS ä¸ºæ­¤åˆ›å»ºçš„åŸŸåè§£æè®°å½•çš„æ ¼å¼ä¸ºÂ <code>&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local</code>ã€‚</p>
<p>åœ¨æ²¡æœ‰ K8s çš„åœºæ™¯ä¸‹ä¹Ÿå¯ä»¥ä¸º plugin-server é›†ç¾¤ç”³è¯·å†…ç½‘ VIP æˆ–è€… SLB åšå¥½æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚</p>
<p><strong>3ï¼‰ä¿®æ”¹ Higress å†…ç½®æ’ä»¶ä¸‹è½½åœ°å€</strong></p>
<p>ä¾ç…§ github ä¸­çš„ç¤ºä¾‹ï¼Œåœ¨åŸºäº Higress é•œåƒçš„é¡¹ç›® Dockerfile ä¸­å£°æ˜æ’ä»¶çš„ä¸‹è½½åœ°å€ã€‚è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸‹ï¼Œreadme ä¸­ç»™å‡ºçš„ç¤ºä¾‹æ˜¯ç¯å¢ƒå˜é‡çš„æ ¼å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/deef89984e3f456b86d4fa4f4bb6c730~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=cmJOGZq62Q0t%2FpVqpZLrG%2F8hb4U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ Dockerfile ä¸­å£°æ˜éœ€è¦è½¬ä¹‰ä¸€ä¸‹ï¼Œ${name}/${version}Â çš„å½¢å¼æ‰å¯ä»¥è¢«æ­£ç¡®è§£æã€‚</p>
<pre><code class="hljs language-bash" lang="bash">...
<span class="hljs-comment"># æ¨¡ç‰ˆ</span>
ENV HIGRESS_ADMIN_WASM_PLUGIN_CUSTOM_IMAGE_URL_PATTERN=http://[ç”³è¯·çš„k8s serviceåœ°å€]/plugins/\<span class="hljs-variable">${name}</span>/\<span class="hljs-variable">${version}</span>/plugin.wasm
<span class="hljs-comment"># mcp wasm æ’ä»¶ä¸‹è½½åœ°å€</span>
ENV MCP_SERVER_WASM_IMAGE_URL=http://[ç”³è¯·çš„k8s serviceåœ°å€]/plugins/mcp-server/1.0.0/plugin.wasm
...
</code></pre>
<p>é…ç½®å®Œç‹¬ç«‹çš„æ’ä»¶ HTTP ä¸‹è½½åœ°å€åé‡æ–°éƒ¨ç½²ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå¯ä»¥çœ‹åˆ° 8080 ç«¯å£ä»¥åŠ 8443 ç«¯å£å¯ä»¥è¢«æ­£å¸¸ç›‘å¬ï¼Œè¯´æ˜ Higress å…·å¤‡ä»£ç†å’Œç½‘å…³åŠŸèƒ½çš„æ ¸å¿ƒæ•°æ®é¢ç»„ä»¶å·²ç»å¯ä»¥æ­£å¸¸æœåŠ¡äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50a78e0794714d30956da299515be560~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=nt%2FNejfjL2XbA%2FOkNvYBZRtHt5U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è§£å†³å®Œ WASM æ’ä»¶ä¸‹è½½é—®é¢˜ï¼ŒåŸºäº docker é•œåƒçš„ Higress æœåŠ¡å°±å¯ä»¥è¢«æˆåŠŸæ‹‰èµ·å¹¶è¿è¡Œäº†ã€‚åªä¸è¿‡åŸºäºè¿™ç§æ¨¡å¼éƒ¨ç½²çš„<strong>æ¯ä¸ª pod éƒ½æ˜¯ç‹¬ç«‹ã€å¯¹ç­‰ã€åŒ…å«å…¨éƒ¨ç»„ä»¶ã€åŠŸèƒ½å®Œæ•´çš„ Higress æœåŠ¡ï¼Œéœ€è¦é€šè¿‡å¤šå‰¯æœ¬çš„æ–¹å¼å®ç°é«˜å¯ç”¨ã€‚</strong></p>
<p>è¿™ç§éƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œé€šè¿‡ Higress è‡ªèº«é›†æˆçš„æ§åˆ¶å°å»è¿ç»´æœåŠ¡&amp;æ›´æ”¹é…ç½®æ˜¯ä¸ç°å®çš„ï¼Œåªèƒ½æ“ä½œä¸€å°å®ä¾‹çš„é…ç½®å˜æ›´ï¼Œæ— æ³•è®©å®ä¾‹é—´è¿›è¡Œé…ç½®åŒæ­¥ã€‚å› æ­¤åœ¨è¿™ç§æ¨¡å¼ä¸‹çš„ç¼ºç‚¹æ˜¯ï¼Œåªèƒ½é€šè¿‡åœ¨é¡¹ç›®ä»£ç ä¸­ç»´æŠ¤é…ç½®æ–‡ä»¶ï¼Œéœ€è¦æ›´æ”¹æ—¶èµ°å‘å¸ƒæµç¨‹ï¼Œå°†é…ç½®å‘å¸ƒåˆ°æ¯å°å®ä¾‹ä¸Šé¢ã€‚ä¸è¿‡åœ¨æˆ‘ä»¬è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œéœ€è¦å˜æ›´é…ç½®çš„æƒ…å†µä¸å¤šã€‚</p>
<h4 data-id="heading-4">ç²˜æ€§ä¼šè¯</h4>
<p>åœ¨ MCP SSE é€šä¿¡æ–¹å¼ä¸‹ï¼Œå¤©ç„¶éœ€è¦è§£å†³ç²˜æ€§ä¼šè¯çš„é—®é¢˜ï¼ŒHigress åŸºäº Redis å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æå‰éƒ¨ç½²å¥½ Redis å®ä¾‹ä¹‹åï¼Œæ‰“å¼€ Higress çš„ MCP åŠŸèƒ½ï¼Œå¹¶å°† Redis é…ç½®æ›´æ–°è¿›å»ï¼Œé‡æ–°éƒ¨ç½²ä¸€ä¸‹å°±å¯ä»¥ä½¿ç”¨ MCP çš„åŠŸèƒ½äº†ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">...</span>
<span class="hljs-attr">data:</span>
Â  <span class="hljs-attr">higress:</span> <span class="hljs-string">|-</span>
Â  Â  <span class="hljs-attr">mcpServer:</span>
Â  Â  Â Â <span class="hljs-string">enable:</span>Â <span class="hljs-literal">true</span>
Â  Â  Â  <span class="hljs-attr">sse_path_suffix:</span> <span class="hljs-string">/sse</span>
Â  Â  Â  <span class="hljs-attr">redis:</span>
Â  Â  Â  Â  <span class="hljs-attr">address:</span> <span class="hljs-string">xxx.redis.zhangbei.rds.aliyuncs.com:6379</span>
Â  Â  Â  Â  <span class="hljs-string">username:</span>Â <span class="hljs-string">""</span>
Â  Â  Â  Â  <span class="hljs-string">password:</span>Â <span class="hljs-string">"xxx"</span>
Â  Â  Â  Â  <span class="hljs-attr">db:</span> <span class="hljs-number">0</span>
<span class="hljs-string">...</span>
</code></pre>
<p>è¿™ä»½é…ç½®æ–‡ä»¶å¯ä»¥ç»´æŠ¤åœ¨è‡ªå·±çš„åŸºäº Higress é•œåƒçš„é¡¹ç›®ä¸­ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™å°†é…ç½®æ–‡ä»¶ COPY åˆ°æŒ‡å®šç›®å½•ï¼ˆè¿™ç§éƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„é…ç½®æ–‡ä»¶éƒ½åº”è¯¥è¿™ä¹ˆåšï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">...
<span class="hljs-comment"># custom config</span>
COPY config/configmaps/higress-config.yaml /data/configmaps/higress-config.yaml
COPY config/mcpbridges/default.yaml /data/mcpbridges/default.yaml
COPY config/secrets/higress-console.yaml /data/secrets/higress-console.yaml
RUNÂ <span class="hljs-built_in">chmod</span>Â +x /data/configmaps/higress-config.yaml &amp;&amp; \
Â  Â Â <span class="hljs-built_in">chmod</span>Â +x /data/secrets/higress-console.yaml &amp;&amp; \
Â  Â Â <span class="hljs-built_in">chmod</span>Â +x /data/mcpbridges/*
...
</code></pre>
<p>å½“æ•´ä¸ª MCP ç½‘å…³æ­å»ºå®Œå¹¶ä½¿ç”¨çš„æ—¶å€™ï¼Œåœ¨ redis ä¸Šé€šè¿‡Â PSUBSCRIBE mcp-server-sse:*Â å‘½ä»¤å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„è°ƒç”¨ä¿¡æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f181283db3440f4881d64258ccd6e0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=FYsl1PaSZ7kmRr1p50P%2Bq9Y3Lmo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-5">è‡ªå®šä¹‰æ„å»ºé•œåƒ</h4>
<p>å®˜æ–¹æ„å»ºå‡ºæ¥çš„é•œåƒä¸€èˆ¬ä¼šè¦æ±‚ä½“ç§¯å°ï¼Œæ»¡è¶³æœ€å°è¿è¡Œè¦æ±‚ï¼Œæ‰€ä»¥å¾ˆå¤šåŠŸèƒ½å…¶å®å¹¶ä¸é›†æˆåœ¨ Higress çš„é•œåƒä¸­ã€‚å¦‚æœä½ çš„ä¼ä¸šæœ‰è‡ªå·±çº¦å®šçš„é€šç”¨é•œåƒï¼Œæˆ–è€…æ˜¯æƒ³åœ¨åŸæœ¬çš„åŸºç¡€ä¸Šé›†æˆä¸€äº›æ–°çš„åŠŸèƒ½ï¼Œå¦‚ä½¿ç”¨é˜¿é‡Œäº‘çš„ SLSã€äº‘ç›‘æ§ç­‰åŠŸèƒ½ï¼Œå°±éœ€è¦æ ¹æ® all-in-one é•œåƒçš„ Dockerfile å†…å®¹è¿›è¡Œè‡ªå®šä¹‰æ„å»ºã€‚è¿™é‡Œæœ‰ä¸ªæ³¨æ„çš„ç‚¹æ˜¯ï¼ŒHigress ä¸­çš„ envoy æ¨¡å—è¦æ±‚çš„ glibc æ˜¯ 2.18 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</p>
<p>å…¶å®åªéœ€è¦å°† Higress çš„ Dockerfile æ–‡ä»¶å†…å®¹ç§»æ¤è¿‡æ¥å°±è¡Œï¼Œç„¶å<strong>å†å£°æ˜ä¸‹ç‹¬ç«‹éƒ¨ç½²çš„ WASM æ’ä»¶ä¸‹è½½åœ°å€</strong>ï¼Œå°±èƒ½å®ç°åŸºäºæŒ‡å®šé•œåƒè¿›è¡Œ Higress è‡ªå®šä¹‰æ„å»ºæ‰“åŒ…éƒ¨ç½²äº†ã€‚</p>
<p>Higress æœåŠ¡æ­å»ºå¥½åï¼Œå°±å¯ä»¥èµ°å¯¹å¤–å…¬ç½‘è®¿é—®çš„æµç¨‹äº†ï¼šï¼ˆ1ï¼‰ä¸€ä¸ªæ˜¯ç»‘å®š 8001 ç«¯å£ï¼Œé€šè¿‡ Higress æ§åˆ¶å°è¿›è¡ŒæŸ¥çœ‹ç›¸å…³é…ç½®çš„åŸŸåï¼Œé™åˆ¶ä¸ºåªå…è®¸å†…ç½‘è®¿é—®ã€‚æ³¨ï¼šè¿™ç§æ¨¡å¼ä¸‹æ— æ³•é€šè¿‡æ§åˆ¶å°ç›´æ¥å»æ›´æ”¹é…ç½®ï¼›ï¼ˆ2ï¼‰å¦ä¸€ä¸ªæ˜¯ç»‘å®š 8080 ç«¯å£ï¼Œå¯¹å¤–æä¾› MCP ç½‘å…³æœåŠ¡çš„åŸŸåã€‚</p>
<p>å®Œæ•´çš„ Dockerfile å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">FROM [ä¼ä¸šå†…éƒ¨åŸºç¡€é•œåƒ]
<span class="hljs-comment"># ä¸‹é¢ä¸º Higress all-in-one dockerfileä¸­çš„å†…å®¹</span>
ARG HUB=higress-registry.cn-hangzhou.cr.aliyuncs.com/higress
...
<span class="hljs-comment"># æ¨¡ç‰ˆ</span>
ENV HIGRESS_ADMIN_WASM_PLUGIN_CUSTOM_IMAGE_URL_PATTERN=http://[ç”³è¯·çš„k8s serviceåœ°å€]/plugins/\<span class="hljs-variable">${name}</span>/\<span class="hljs-variable">${version}</span>/plugin.wasm
<span class="hljs-comment"># mcp wasm æ’ä»¶ä¸‹è½½åœ°å€</span>
ENV MCP_SERVER_WASM_IMAGE_URL=http://[ç”³è¯·çš„k8s serviceåœ°å€]/plugins/mcp-server/1.0.0/plugin.wasm
...
<span class="hljs-comment"># æ³¨æ„ dockerfile ä¸­ä¼šå» github ä¸‹è½½å¯¹åº”å¤„ç†å™¨æ¶æ„ä¸‹çš„ yq æ¨¡å—ï¼Œä¼ä¸šå†…ç½‘ç¯å¢ƒä¸‹å¯ä»¥æå‰ä¸‹è½½ä¸‹æ¥</span>
COPY ./yq_linux_[<span class="hljs-built_in">arch</span>] /usr/local/bin/yq
...
<span class="hljs-comment"># custom config</span>
COPY config/configmaps/higress-config.yaml /data/configmaps/higress-config.yaml
COPY config/mcpbridges/default.yaml /data/mcpbridges/default.yaml
COPY config/secrets/higress-console.yaml /data/secrets/higress-console.yaml
RUNÂ <span class="hljs-built_in">chmod</span>Â +x /data/configmaps/higress-config.yaml &amp;&amp; \
Â  Â Â <span class="hljs-built_in">chmod</span>Â +x /data/secrets/higress-console.yaml &amp;&amp; \
Â  Â Â <span class="hljs-built_in">chmod</span>Â +x /data/mcpbridges/*
...
</code></pre>
<h3 data-id="heading-6">Nacos</h3>
<p>Nacos çš„éƒ¨ç½²ç›¸å¯¹ç®€å•ï¼Œé™¤äº†é€šè¿‡ kubectl æˆ–è€… nacos-operator å·¥å…·ç›´æ¥æ“ä½œ K8s é›†ç¾¤éƒ¨ç½²å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥åŸºäº nacos-server çš„é•œåƒè¿›è¡Œéƒ¨ç½²Â Dockerfile <strong>[</strong> <strong>3]</strong> ã€‚å› ä¸Šæ–‡æåˆ°çš„å†…éƒ¨ç¯å¢ƒé—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹©åŸºäº nacos-server çš„é•œåƒï¼Œå°†æœåŠ¡éƒ¨ç½²äº K8s é›†ç¾¤ä¸Šé¢ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">FROM nacos-registry.cn-hangzhou.cr.aliyuncs.com/nacos/nacos-server:latest
</code></pre>
<h4 data-id="heading-7">é›†ç¾¤æ¨¡å¼éƒ¨ç½²</h4>
<p>Nacos é›†ç¾¤æ¨¡å¼ä¸‹ä½¿ç”¨çš„ä¸€è‡´æ€§åè®®æ˜¯åŸºäº Raft å®ç°çš„ï¼Œå› æ­¤æœ€å°éœ€è¦éƒ¨ç½² 3 å°å®ä¾‹ã€‚</p>
<p>åœ¨å¼•ç”¨ nacos-server é•œåƒçš„ dockerfile ä¸­ï¼Œå£°æ˜ cluster çš„éƒ¨ç½²æ¨¡å¼ã€‚æˆ‘ä»¬æŸ¥çœ‹ nacos çš„å¯åŠ¨è„šæœ¬ï¼Œå‘ç°åœ¨ peer-finderï¼ˆæ’ä»¶ï¼‰ç›®å½•ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå®šä¹‰äº† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>A</mi><mi>C</mi><mi>O</mi><msub><mi>S</mi><mi>S</mi></msub><mi>E</mi><mi>R</mi><mi>V</mi><mi>E</mi><mi>R</mi><mi>S</mi><mtext>å˜é‡ï¼Œä¼šå°†</mtext></mrow><annotation encoding="application/x-tex">NACOS_SERVERS å˜é‡ï¼Œä¼šå°† </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">CO</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">ER</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.05764em;">ERS</span><span class="mord cjk_fallback">å˜é‡ï¼Œä¼šå°†</span></span></span></span></span>NACOS_SERVERS å˜é‡ä¸­çš„å€¼å†™å…¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>L</mi><mi>U</mi><mi>S</mi><mi>T</mi><mi>E</mi><msub><mi>R</mi><mi>C</mi></msub><mi>O</mi><mi>N</mi><mi>F</mi><mtext>æ–‡ä»¶ä¸­ï¼Œ</mtext></mrow><annotation encoding="application/x-tex">CLUSTER_CONF æ–‡ä»¶ä¸­ï¼Œ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.10903em;">LU</span><span class="mord mathnormal" style="margin-right:0.05764em;">STE</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">ONF</span><span class="mord cjk_fallback">æ–‡ä»¶ä¸­ï¼Œ</span></span></span></span></span>CLUSTER_CONF æ–‡ä»¶çš„é»˜è®¤è·¯å¾„æ˜¯ /home/nacos/conf/cluster.confï¼Œå…¶ä¸­å®šä¹‰çš„å°±æ˜¯ Nacos é›†ç¾¤çš„é™æ€æˆå‘˜åœ°å€åˆ—è¡¨ï¼Œå®ƒåœ¨é›†ç¾¤é¦–æ¬¡å¯åŠ¨æ—¶ä¼šè¢«è¯»å–ï¼Œç”¨äºå‘ŠçŸ¥æ¯ä¸ªèŠ‚ç‚¹â€œé‚»å±…â€åœ¨å“ªï¼Œä»è€Œè®©å®ƒä»¬èƒ½å¤Ÿäº’ç›¸å‘ç°ã€å»ºç«‹è¿æ¥ï¼Œå¹¶åˆå§‹åŒ– Raft ä¸€è‡´æ€§åè®®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">...
PLUGINS_DIR=<span class="hljs-string">"/home/nacos/plugins/peer-finder"</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-function"><span class="hljs-title">print_servers</span></span>() {
Â  Â <span class="hljs-keyword">if</span>Â [[ ! -dÂ <span class="hljs-string">"<span class="hljs-variable">${PLUGINS_DIR}</span>"</span>Â ]];Â <span class="hljs-keyword">then</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">""</span>Â &gt;<span class="hljs-string">"<span class="hljs-variable">$CLUSTER_CONF</span>"</span>
Â  Â Â <span class="hljs-keyword">for</span>Â serverÂ <span class="hljs-keyword">in</span>Â <span class="hljs-variable">${NACOS_SERVERS}</span>;Â <span class="hljs-keyword">do</span>
Â  Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"<span class="hljs-variable">$server</span>"</span>Â &gt;&gt;<span class="hljs-string">"<span class="hljs-variable">$CLUSTER_CONF</span>"</span>
Â  Â Â <span class="hljs-keyword">done</span>
Â Â <span class="hljs-keyword">else</span>
Â  Â  bashÂ <span class="hljs-variable">$PLUGINS_DIR</span>/plugin.sh
Â  Â Â <span class="hljs-built_in">sleep</span>Â 30
Â Â <span class="hljs-keyword">fi</span>
}
...
</code></pre>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ Dockerfile ä¸­ç»´æŠ¤å½“å‰é›†ç¾¤ä¸‹çš„ [å®ä¾‹ IP:ç«¯å£] åˆ—è¡¨ï¼Œä¾› Nacos é›†ç¾¤å¯åŠ¨æ—¶è¯»å–å¹¶åˆå§‹åŒ–ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">...
ENV <span class="hljs-attr">MODE</span>=cluster
ENV <span class="hljs-attr">NACOS_AUTH_TOKEN</span>=xxx
ENV <span class="hljs-attr">NACOS_AUTH_IDENTITY_KEY</span>=xxx
ENV <span class="hljs-attr">NACOS_AUTH_IDENTITY_VALUE</span>=xxx
ENV <span class="hljs-attr">NACOS_SERVERS</span>=<span class="hljs-string">"10.0.0.1:8848 10.0.0.2:8848 10.0.0.3:8848"</span>
<span class="hljs-comment"># nacos ç”¨æˆ·åå¯†ç </span>
ENV <span class="hljs-attr">NACOS_USERNAME</span>=xxx
ENV <span class="hljs-attr">NACOS_PASSWORD</span>=xxx
...
</code></pre>
<h4 data-id="heading-8">å®ä¾‹é—´åŠ¨æ€å‘ç°</h4>
<p>ä¸Šé¢è¿™ç§å›ºå®š IP åˆ—è¡¨çš„æ–¹å¼<strong>ç¼ºç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„</strong>ã€‚å®ƒæ˜¯ä¸€ä¸ªé™æ€çš„é…ç½®ï¼Œå½“å‡ºç°é›†ç¾¤çš„æ‰©ç¼©å®¹æ—¶ï¼Œå®ä¾‹æ˜¯æ²¡æœ‰åŠæ³•è‡ªåŠ¨å»æ›´æ–°æˆå‘˜ IP åˆ—è¡¨çš„ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹å¹¶å‘å¸ƒï¼Œæ•´ä¸ªè¿‡ç¨‹éå¸¸ç¹çï¼Œä¸¥é‡æƒ…å†µä¸‹å¯èƒ½ä¼šå½±å“çº¿ä¸ŠæœåŠ¡çš„ç¨³å®šæ€§ï¼›ä¸”åœ¨äº‘åŸç”Ÿå®¹å™¨åŒ–èƒŒæ™¯ä¸‹ï¼ŒIP å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œéšæ—¶æœ‰å¯èƒ½ä¼šå› ä¸ºæ•…éšœè¿ç§»è€Œæ”¹å˜ IPï¼Œç»´æŠ¤é™æ€ IP åˆ—è¡¨ä¸äº‘åŸç”Ÿçš„ç†å¿µèƒŒé“è€Œé©°ã€‚çº¿ä¸Šç”Ÿäº§æ˜¯å®Œå…¨ä¸æ¨èè¿™ç§æ–¹å¼çš„ã€‚</p>
<p>å†å›åˆ°ä¸Šé¢ docker-startup.sh è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡ peer-finder æ’ä»¶æ¥å®ç°é›†ç¾¤é—´å®ä¾‹çš„å‘ç°ï¼Œå–ä»£æ‰‹åŠ¨ç»´æŠ¤ cluster.conf æ–‡ä»¶ã€‚peer-finder æ’ä»¶è¿è¡Œä¾èµ–äº K8s é›†ç¾¤ Headless Service åŸŸåï¼Œä¼šå»æ‰§è¡Œç±»ä¼¼äº nslookup å‘½ä»¤æŸ¥æ‰¾ Service ä¸‹é¢çš„æ‰€æœ‰å¥åº· Pod çš„ IP åˆ—è¡¨ï¼Œç±»æ¯”äºæœåŠ¡å‘ç°çš„èƒ½åŠ› <strong>[</strong> <strong>4]</strong> ï¼Œè¿™æ ·å°±ä¸ç”¨å†æ‰‹åŠ¨å»ç»´æŠ¤å®ä¾‹ IP åˆ—è¡¨ã€‚</p>
<p>ä½†æ˜¯ peer-finder çš„è¿è¡Œä¾èµ–äº StatefulSet çš„å®ä¾‹éƒ¨ç½²æ¨¡å¼ï¼Œéœ€è¦æ¯ä¸ªå®ä¾‹æœ‰å›ºå®šçš„å®ä¾‹åã€‚å› ä¸ºæˆ‘ä»¬å†…éƒ¨ç¯å¢ƒçš„é™åˆ¶ï¼Œæˆ‘ä»¬ç°åœ¨éƒ¨ç½²çš„éƒ½æ˜¯æ— çŠ¶æ€çš„å®ä¾‹ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•é€šè¿‡ peer-finder æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‚ç…§ peer-finder è„šæœ¬çš„å®ç°æ€è·¯ï¼Œæ¥è‡ªå·±å†™ä¸€ä¸ªå¯åŠ¨è„šæœ¬ã€‚</p>
<p><strong>1ï¼‰é¦–å…ˆä¸º Nacos é›†ç¾¤ç”³è¯· Headless çš„ Serviceã€‚</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
Â  <span class="hljs-attr">name:</span> <span class="hljs-string">nacos-headless</span>
Â  <span class="hljs-attr">namespace:</span> <span class="hljs-string">mcp-nacos</span>
Â  <span class="hljs-attr">labels:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">mcp-nacos</span>
Â  Â  <span class="hljs-attr">nacos:</span> <span class="hljs-string">mcp-nacos</span>
<span class="hljs-attr">spec:</span>
Â  <span class="hljs-attr">clusterIP:</span> <span class="hljs-string">None</span>
Â  <span class="hljs-attr">ports:</span>
Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">peer-finder-port</span>
Â  Â  <span class="hljs-attr">port:</span> <span class="hljs-number">8848</span>
Â  Â  <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
Â  Â  <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8848</span>
Â  <span class="hljs-attr">selector:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">mcp-nacos</span>
Â  <span class="hljs-attr">sessionAffinity:</span> <span class="hljs-string">None</span>
Â  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b26974cc4274b4695cdd2fb29d07a8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=085QUiISHnSTaM6%2FwuJEyrUl4Jc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>2ï¼‰è¿™é‡Œä¿®æ”¹ä¸‹ nacos-docker çš„å¯åŠ¨è„šæœ¬ï¼Œæä¾›ä¸€ä¸ªç®€å•çš„å®ç°ã€‚ï¼ˆä»…ä¾›å‚è€ƒï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash">...
åŸdocker-startup.shå†…å®¹
...
<span class="hljs-comment"># æ–°å¢å†…å®¹</span>
<span class="hljs-comment"># æ³¨é‡Šæ‰ JAVAå¯åŠ¨å‘½ä»¤</span>
<span class="hljs-comment"># exec $JAVA ${JAVA_OPT}</span>
<span class="hljs-built_in">export</span>Â JAVA_OPTÂ <span class="hljs-comment"># export JAVA å¯åŠ¨å‚æ•°ï¼Œæ–¹é¢ä¸‹é¢è¯»å–</span>
HEADLESS_SERVICE_FQDN=<span class="hljs-string">"xxx.svc.cluster.local"</span>
CLUSTER_CONF_FILE=<span class="hljs-string">"/home/nacos/conf/cluster.conf"</span>
UPDATE_SCRIPT=<span class="hljs-string">"/home/nacos/bin/update-cluster.sh"</span>Â <span class="hljs-comment"># åŸå­æ›´æ–°è„šæœ¬</span>
NACOS_START_CMD=<span class="hljs-string">"<span class="hljs-variable">$JAVA</span>Â <span class="hljs-variable">$JAVA_OPT</span>"</span>
<span class="hljs-comment"># 1. åŠ¨æ€åˆ›å»º update-cluster.sh è„šæœ¬</span>
<span class="hljs-built_in">cat</span>Â &gt;Â <span class="hljs-variable">${UPDATE_SCRIPT}</span>Â &lt;&lt;Â <span class="hljs-string">'EOF'</span>
<span class="hljs-comment">#!/bin/bash</span>
<span class="hljs-built_in">set</span>Â -e
NACOS_PORT=<span class="hljs-variable">${NACOS_APPLICATION_PORT:-8848}</span>
CLUSTER_CONF_FILE=<span class="hljs-string">"/home/nacos/conf/cluster.conf"</span>
TMP_CONF_FILE=<span class="hljs-string">"/home/nacos/conf/cluster.conf.tmp"</span>
&gt;Â <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>
<span class="hljs-comment"># ä»æ ‡å‡†è¾“å…¥è¯»å– nslookup çš„åŸå§‹è¾“å‡º</span>
awkÂ <span class="hljs-string">'
/^Name:/ { flag=1; next }
flag &amp;&amp; /^Address:/ { print $2; flag=0 }
'</span> |Â <span class="hljs-keyword">while</span>Â IFS=Â <span class="hljs-built_in">read</span>Â -r ip;Â <span class="hljs-keyword">do</span>
Â  Â Â <span class="hljs-keyword">if</span>Â [ -nÂ <span class="hljs-string">"<span class="hljs-variable">$ip</span>"</span>Â ];Â <span class="hljs-keyword">then</span>
Â  Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"<span class="hljs-variable">${ip}</span>:<span class="hljs-variable">${NACOS_PORT}</span>"</span>Â &gt;&gt;Â <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>
Â  Â Â <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>
<span class="hljs-comment"># æ’åºä»¥ç¡®ä¿æ–‡ä»¶å†…å®¹çš„ä¸€è‡´æ€§ï¼Œé¿å…ä¸å¿…è¦çš„æ›´æ–°</span>
<span class="hljs-built_in">sort</span>Â -oÂ <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>Â <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>
<span class="hljs-comment"># åªæœ‰åœ¨æ–°æ—§é…ç½®ä¸åŒæ—¶æ‰æ‰§è¡Œæ›´æ–°</span>
<span class="hljs-comment"># æ£€æŸ¥æ—§æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
<span class="hljs-keyword">if</span>Â [ ! -fÂ <span class="hljs-string">"<span class="hljs-variable">${CLUSTER_CONF_FILE}</span>"</span>Â ] || ! cmp -sÂ <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>Â <span class="hljs-string">"<span class="hljs-variable">${CLUSTER_CONF_FILE}</span>"</span>;Â <span class="hljs-keyword">then</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[<span class="hljs-subst">$(date)</span>][update-script] Peer list changed. Updating config."</span>
Â  Â Â <span class="hljs-built_in">mv</span>Â <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>Â <span class="hljs-string">"<span class="hljs-variable">${CLUSTER_CONF_FILE}</span>"</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[<span class="hljs-subst">$(date)</span>][update-script] cluster.conf updated:"</span>
Â  Â Â <span class="hljs-built_in">cat</span>Â <span class="hljs-string">"<span class="hljs-variable">${CLUSTER_CONF_FILE}</span>"</span>
<span class="hljs-keyword">else</span>
Â  Â Â <span class="hljs-built_in">rm</span>Â <span class="hljs-string">"<span class="hljs-variable">${TMP_CONF_FILE}</span>"</span>
<span class="hljs-keyword">fi</span>
EOF
<span class="hljs-built_in">chmod</span>Â +xÂ <span class="hljs-variable">${UPDATE_SCRIPT}</span>
<span class="hljs-comment"># 2. å¯åŠ¨å‰çš„åˆå§‹åŒ–å¾ªç¯</span>
MAX_INIT_RETRIES=30
RETRY_COUNT=0
MIN_PEERS=3Â <span class="hljs-comment"># æœŸæœ›çš„é›†ç¾¤æœ€å°å‰¯æœ¬æ•°é‡</span>
<span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[INFO] Initializing cluster config. Waiting for at leastÂ <span class="hljs-variable">${MIN_PEERS}</span>Â peers to be available..."</span>
<span class="hljs-keyword">while</span>Â <span class="hljs-literal">true</span>;Â <span class="hljs-keyword">do</span>
Â Â <span class="hljs-comment"># ç›´æ¥å°† nslookup çš„è¾“å‡ºé€šè¿‡ç®¡é“ä¼ ç»™æ›´æ–°è„šæœ¬</span>
Â  nslookupÂ <span class="hljs-string">"<span class="hljs-variable">${HEADLESS_SERVICE_FQDN}</span>"</span>Â |Â <span class="hljs-variable">${UPDATE_SCRIPT}</span>
Â Â <span class="hljs-comment"># æ£€æŸ¥ç”Ÿæˆçš„é…ç½®æ–‡ä»¶è¡Œæ•°</span>
Â  LINE_COUNT=$(<span class="hljs-built_in">wc</span>Â -l &lt;Â <span class="hljs-string">"<span class="hljs-variable">${CLUSTER_CONF_FILE}</span>"</span>)
Â Â <span class="hljs-keyword">if</span>Â [Â <span class="hljs-string">"<span class="hljs-variable">${LINE_COUNT}</span>"</span>Â -geÂ <span class="hljs-string">"<span class="hljs-variable">${MIN_PEERS}</span>"</span>Â ];Â <span class="hljs-keyword">then</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[INFO] Initial cluster.conf is ready withÂ <span class="hljs-variable">${LINE_COUNT}</span>Â peers."</span>
Â  Â Â <span class="hljs-built_in">break</span>
Â Â <span class="hljs-keyword">fi</span>
Â  RETRY_COUNT=$((RETRY_COUNT+<span class="hljs-number">1</span>))
Â Â <span class="hljs-keyword">if</span>Â [Â <span class="hljs-string">"<span class="hljs-variable">${RETRY_COUNT}</span>"</span>Â -gtÂ <span class="hljs-string">"<span class="hljs-variable">${MAX_INIT_RETRIES}</span>"</span>Â ];Â <span class="hljs-keyword">then</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[WARN] Could not findÂ <span class="hljs-variable">${MIN_PEERS}</span>Â peers afterÂ <span class="hljs-variable">${MAX_INIT_RETRIES}</span>Â retries. Starting withÂ <span class="hljs-variable">${LINE_COUNT}</span>Â peers found."</span>
Â  Â Â <span class="hljs-built_in">break</span>
Â Â <span class="hljs-keyword">fi</span>
Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[INFO] FoundÂ <span class="hljs-variable">${LINE_COUNT}</span>Â peers. Waiting for more... Retrying in 5 seconds."</span>
Â Â <span class="hljs-built_in">sleep</span>Â 5
<span class="hljs-keyword">done</span>
<span class="hljs-comment"># 3. åœ¨åå°å¯åŠ¨æˆ‘ä»¬è‡ªå·±çš„ç›‘æ§å¾ªç¯</span>
(
Â Â <span class="hljs-keyword">while</span>Â <span class="hljs-literal">true</span>;Â <span class="hljs-keyword">do</span>
Â  Â Â <span class="hljs-built_in">sleep</span>Â 15Â <span class="hljs-comment"># æ¯ 15 ç§’æ£€æŸ¥ä¸€æ¬¡</span>
Â  Â Â <span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[<span class="hljs-subst">$(date)</span>][monitor] Checking for peer updates..."</span>
Â  Â  nslookupÂ <span class="hljs-string">"<span class="hljs-variable">${HEADLESS_SERVICE_FQDN}</span>"</span>Â |Â <span class="hljs-variable">${UPDATE_SCRIPT}</span>
Â Â <span class="hljs-keyword">done</span>
) &amp;
<span class="hljs-comment"># 4. å¯åŠ¨ Nacos ä¸»è¿›ç¨‹</span>
<span class="hljs-built_in">echo</span>Â <span class="hljs-string">"[INFO] Starting Nacos server..."</span>
<span class="hljs-built_in">exec</span>Â sh -cÂ <span class="hljs-string">"<span class="hljs-variable">${NACOS_START_CMD}</span>"</span>
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬ cluster.conf æ–‡ä»¶ä¸­çš„æˆå‘˜ IP åˆ—è¡¨å°±å®ç°äº†è‡ªåŠ¨æ›´æ–°ã€‚</p>
<p>çº¿ä¸Šç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯æ¨èä½¿ç”¨æœ‰çŠ¶æ€ StatefulSet çš„éƒ¨ç½²æ¨¡å¼ï¼Œå¹¶ç»“åˆ peer-finder çš„èƒ½åŠ›å®ç°å®ä¾‹é—´çš„äº’ç›¸å‘ç°ã€‚è€Œä¸æ˜¯ç”¨æ— çŠ¶æ€çš„å®ä¾‹ï¼Œè‡ªå·±å»å†™è„šæœ¬å®ç°ã€‚åç»­æˆ‘ä»¬ä¹Ÿä¼šå‡çº§åˆ° StatefulSet çš„æ¨¡å¼è¿›è¡Œéƒ¨ç½²ã€‚</p>
<h4 data-id="heading-9">é…ç½®å¤–ç½® Mysql</h4>
<p>åœ¨é›†ç¾¤éƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œå°±æ— æ³•ä½¿ç”¨ Nacos å†…ç½®çš„ä¸æ”¯æŒæ•°æ®å…±äº«çš„ Derby æ•°æ®åº“ï¼Œéœ€è¦é…ç½®å¤–ç½®çš„ Mysql æ•°æ®åº“ã€‚æå‰éƒ¨ç½²å¥½ Mysql å®ä¾‹ä¹‹åï¼ŒæŒ‰ç…§ Nacos ä¸­çš„Â mysql-schema.sql <strong>[</strong> <strong>5]</strong> æ•°æ®åº“é…ç½®æ–‡ä»¶å°†è¡¨åˆå§‹åŒ–ï¼Œå†å°† mysql é…ç½®ä¿¡æ¯å†™å…¥ Dockerfile ä¸­å³å¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">...
<span class="hljs-comment"># mysql config</span>
ENV <span class="hljs-attr">SPRING_DATASOURCE_PLATFORM</span>=mysql
ENV <span class="hljs-attr">MYSQL_DATABASE_NUM</span>=<span class="hljs-number">1</span>
ENV <span class="hljs-attr">MYSQL_SERVICE_HOST</span>=xxx.mysql.zhangbei.rds.aliyuncs.com
ENV <span class="hljs-attr">MYSQL_SERVICE_PORT</span>=<span class="hljs-number">3306</span>
ENV <span class="hljs-attr">MYSQL_SERVICE_DB_NAME</span>=nacos
ENV <span class="hljs-attr">MYSQL_SERVICE_USER</span>=xxx
ENV <span class="hljs-attr">MYSQL_SERVICE_PASSWORD</span>=xxx
...
</code></pre>
<p>åœ¨ä¸º Nacos åšæœåŠ¡æš´éœ²çš„æ—¶å€™ï¼Œåªéœ€è¦æš´éœ² Nacos æ§åˆ¶å°çš„ 8080 ç«¯å£ï¼Œä¸”é™åˆ¶ä¸ºåªå…è®¸å†…ç½‘è®¿é—®å³å¯ã€‚å› ä¸º Nacos åªæ˜¯å†…éƒ¨ä½œä¸ºç»´æŠ¤ç®¡ç† MCP å·¥å…·å…ƒæ•°æ®ä¿¡æ¯çš„ MCP Registry ä½¿ç”¨ï¼Œå¯¹ç”¨æˆ·ä¾§ä¸æ„ŸçŸ¥ï¼›ä¸” Higress å’Œ Nacos éƒ½éƒ¨ç½²åœ¨å†…ç½‘çš„ K8s é›†ç¾¤ä¸Šé¢ï¼Œå†…éƒ¨é€šä¿¡é€šè¿‡ K8s çš„ Service å³å¯ï¼Œæ— éœ€å°† Nacos çš„ 8848 ç«¯å£æš´éœ²ç»™å…¬ç½‘ã€‚</p>
<h4 data-id="heading-10">ç”³è¯· K8s Service ä¾› Higress ä½¿ç”¨</h4>
<p>æ³¨æ„ Higress æ‹‰å–/è®¢é˜… Nacos ä¸­çš„é…ç½®ä¼šé€šè¿‡ gRPC çš„æ–¹å¼è°ƒç”¨ï¼Œè¿™é‡Œçš„ Service éœ€è¦<strong>æš´éœ² 8848 å’Œ 9848 ä¸¤ä¸ªç«¯å£</strong>ç»™ Higress ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
Â  <span class="hljs-attr">name:</span> <span class="hljs-string">pre-oss-mcp-nacos-endpoint</span>
Â  <span class="hljs-attr">namespace:</span> <span class="hljs-string">aso-oss-mcp-nacos</span>
Â  <span class="hljs-attr">labels:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">mcp-nacos</span>
Â  Â  <span class="hljs-attr">nacos:</span> <span class="hljs-string">mcp-nacos</span>
<span class="hljs-attr">spec:</span>
Â  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>
Â  <span class="hljs-attr">ports:</span>
Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subscribe-port</span>
Â  Â  <span class="hljs-attr">port:</span> <span class="hljs-number">8848</span>
Â  Â  <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
Â  Â  <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8848</span>
Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">grpc-port</span>
Â  Â  <span class="hljs-attr">port:</span> <span class="hljs-number">9848</span>
Â  Â  <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
Â  Â  <span class="hljs-attr">targetPort:</span> <span class="hljs-number">9848</span>
Â  <span class="hljs-attr">selector:</span>
Â  Â  <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
</code></pre>
<p>åŒç†ï¼Œå¦‚æœæƒ³ä½¿ç”¨ä¼ä¸šå†…éƒ¨çš„é•œåƒï¼Œæˆ–è€…æ˜¯æƒ³åœ¨åŸæœ¬çš„åŸºç¡€ä¸Šå³æˆä¸€äº›æ–°çš„åŠŸèƒ½ï¼Œå¦‚ä½¿ç”¨é˜¿é‡Œäº‘çš„ SLSã€äº‘ç›‘æ§ç­‰åŠŸèƒ½ï¼Œä¹Ÿå¯æ ¹æ® Nacos çš„ Dockerfile è¿›è¡Œè‡ªå®šä¹‰æ„å»ºéƒ¨ç½²ã€‚</p>
<h2 data-id="heading-11">é‰´æƒ</h2>
<p>Higress è‡ªèº«æä¾›äº†ä¸°å¯Œçš„é‰´æƒ <strong>[6</strong> <strong>]</strong> èƒ½åŠ›ï¼Œå¦‚æœä½ çš„ä¼ä¸šæœ¬èº«å°±åŸºäº Higress æ­å»ºäº†è‡ªå·±çš„ç½‘å…³å¹¶ä½¿ç”¨äº† Higress æä¾›çš„é‰´æƒèƒ½åŠ›ï¼Œè¿™ç§åœºæ™¯ä¸‹ç›´æ¥å¤ç”¨åŸæ¥çš„æ–¹æ¡ˆå³å¯ã€‚</p>
<p>å¦ä¸€ç§åœºæ™¯ä¸‹ï¼Œä¼ä¸šä¸­ä¼šæœ‰å¤šä¸ªæœåŠ¡ Providerï¼Œæ¯ä¸ª Provider æœ‰ä¸åŒçš„é‰´æƒæ–¹å¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒæŸä¸ªæœåŠ¡æä¾›è€…ä¼šé€šè¿‡æ‹¦æˆªå™¨å¯¹è¯·æ±‚ä¸­æºå¸¦çš„ç”¨æˆ· Cookie è¿›è¡Œ RAM é‰´æƒï¼›å¦ä¸€ä¸ªæœåŠ¡æä¾›è€…ä¼šé€šè¿‡ tengine lua è„šæœ¬å¯¹è¯·æ±‚è¿›è¡Œè‡ªå®šä¹‰é‰´æƒï¼›ä»¥åŠåç»­æ³¨å†Œçš„æœåŠ¡å¯èƒ½æœ‰å…¶ä»–çš„é‰´æƒæ–¹å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7acd4931beee4a66a5895d49856ed06f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=EO%2F2UHvLGWugcoZNCiMt6LwWi0w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›ä½¿ç”¨ Higress çš„é‰´æƒèƒ½åŠ›å»è¦†ç›–å…¨éƒ¨çš„é‰´æƒåœºæ™¯ï¼Œå¼€å‘ç»´æŠ¤æˆæœ¬è¿‡é«˜ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘ç›´æ¥å¤ç”¨æœåŠ¡æä¾›è€…å·²æœ‰çš„é‰´æƒèƒ½åŠ›ï¼›å¦ä¸€æ–¹é¢ï¼Œå¦‚æœé€šè¿‡ç½‘å…³å±‚é‰´æƒéœ€è¦å°† AK æˆ–è€…è®¤è¯ä¿¡æ¯å­˜æ”¾åœ¨ Higress æœåŠ¡ä¸Šï¼Œåœ¨å®‰å…¨å±‚é¢ä¹Ÿä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„åšæ³•ã€‚</p>
<p>è¿™é‡Œæ¨èçš„åšæ³•æ˜¯ç›´æ¥åœ¨ MCP å·¥å…·è°ƒç”¨çš„æ—¶å€™ï¼Œå°†é‰´æƒä¿¡æ¯é€ä¼ ç»™æœåŠ¡æä¾›è€…ï¼Œè®©æœåŠ¡æä¾›è€…å®Œæˆé‰´æƒã€‚</p>
<h2 data-id="heading-12">MCP éªŒè¯</h2>
<p>æ ¹æ®æ–‡æ¡£ <strong>[</strong> <strong>7]</strong> ä¸­çš„æ“ä½œç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åšä¸ªå…¨é“¾è·¯æµ‹è¯•éªŒè¯ã€‚ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š</p>
<p><strong>1ï¼‰åœ¨ Nacos ä¸­æ³¨å†ŒæœåŠ¡ï¼Œå¹¶é…ç½® MCP å·¥å…·çš„å…ƒæ•°æ®ä¿¡æ¯ï¼š</strong></p>
<p>åœ¨ public å‘½åç©ºé—´ä¸‹ï¼Œåˆ›å»ºæœåŠ¡ä¿¡æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3cce81e87f4424e99a857611e3a2859~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=ik5zeW9J75vyrvBOPjfEZ2YPskM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨æœºå™¨ä¸Šå°†è‡ªå·±çš„æœåŠ¡ä½œä¸ºæ°¸ä¹…å®ä¾‹æ³¨å†Œè¿›å»ã€‚ï¼ˆè¿™é‡Œä¸ºäº†å¿«é€ŸéªŒè¯é»‘å±ç™»é™†æœºå™¨æ“ä½œï¼Œçº¿ä¸Šç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯é¡»è¦ç™½å±æ“ä½œï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">curlÂ -X POSTÂ 'http://127.0.0.1:8848/nacos/v1/ns/instance?<span class="hljs-attr">namespaceId</span>=[namespace]&amp;serviceName=[service_name]&amp;groupName=[group_name]&amp;ip=[æœåŠ¡åŸŸå]&amp;port=[æœåŠ¡ç«¯å£]&amp;ephemeral=<span class="hljs-literal">false</span><span class="hljs-string">'
</span></code></pre>
<p>æ³¨å†Œå®Œä¹‹åï¼Œå°±èƒ½åœ¨ Nacos æ§åˆ¶å°ä¸Šçœ‹åˆ°æ³¨å†Œçš„æœåŠ¡é…ç½®ä»¥åŠå¥åº·çŠ¶æ€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5be0472e03b74a07bbd388c7c1d92e98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=ca4dvfQPFxFBQAhkYhJF1gY%2FFeg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¥ç€åœ¨ Nacos æ§åˆ¶å°ä¸Šé…ç½® MCP å·¥å…·ï¼Œæ·»åŠ ä¸€ä¸ªç®€å•å·¥å…·ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªæ— å‚æ•° GET æ¥å£ï¼Œå¹¶å‘å¸ƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d0605c476a54633aa18f22b8a6c70ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=ODOnOK10ad6NFyuev6hkAYQVwMI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c08d19a2f86d40f6ac93ff1fbd120dab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=TnmN1a1FMqzBSUSBgIfMheVwAdE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â Â <span class="hljs-attr">"requestTemplate"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>
Â  Â Â <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"/xxx/list.json"</span><span class="hljs-punctuation">,</span>
Â  Â Â <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"GET"</span><span class="hljs-punctuation">,</span>
Â  Â Â <span class="hljs-attr">"headers"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â Â <span class="hljs-attr">"argsToUrlParam"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
Â Â <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"responseTemplate"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>
Â  Â Â <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"{{.}}"</span>
Â Â <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>2ï¼‰åœ¨ Higress ä¸­é…ç½® MCP Nacos çš„æœåŠ¡æ¥æºï¼š</strong></p>
<p>è¿™é‡Œä¸ºäº†å¿«é€Ÿæµ‹è¯•å…³é—­äº† Nacos çš„è®¤è¯ï¼Œçº¿ä¸Šç¯å¢ƒå»ºè®®å¼€å¯ Nacos çš„è®¤è¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31950e12263e4c80b2ac2b9391c6a910~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=fdoePTv7xVPvSlxOqIUEjegEEV0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>3ï¼‰åœ¨ Cursor/Cherry Studio ä¸­é…ç½®å¯¹å¤–æš´éœ²çš„ Higress æœåŠ¡åœ°å€å’Œ uriï¼Œå³å¯ä½¿ç”¨ MCP å·¥å…·ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb0c06bc1fe04cb89931c0c337d67e1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=1HPKUFXuboEWfYgYUHR4ewk2xUw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc7470b810164f83b9b8ca7d89834aae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=rchVHa9y6735FluxCW2WeqU7MVg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-13">è®¾è®¡å›¾</h2>
<h3 data-id="heading-14">å®¹ç¾æ¶æ„</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e48188f92d884ebd9159719acf34ae38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=67W9t9detsxceS8jx39TR0TLcnY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿›å…¥æµè§ˆå™¨æŸ¥çœ‹åŸå›¾ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fimg.alicdn.com%2Fimgextra%2Fi2%2FO1CN0138v82b1L7vNY3RQdo_!!6000000001253-2-tps-6507-5451.png" target="_blank" title="https://img.alicdn.com/imgextra/i2/O1CN0138v82b1L7vNY3RQdo_!!6000000001253-2-tps-6507-5451.png" ref="nofollow noopener noreferrer">img.alicdn.com/imgextra/i2â€¦</a></p>
<p>åœ¨æ•´ä¸ª MCP ç½‘å…³ä¸­ï¼Œé€šè¿‡ uri æ¥è·¯ç”±ä¸åŒçš„ MCP å·¥å…·ï¼Œå®ç°å·¥å…·çš„éš”ç¦»ã€‚</p>
<h3 data-id="heading-15">é€»è¾‘æ¨¡å—å›¾</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58740208297546f9bb5f91a6f3fea541~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=w%2B%2F8liRptkOr3GSLOcW3qzC8u7o%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-16">æ—¶åºå›¾</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c3feed715ef439ab853acdd4f56d7d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790117&amp;x-signature=7Bq0kGTU%2FKBtcEc5D0Ks%2BdrrOWA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>é™„å½•ï¼š</strong></p>
<p>[1] åŸºäº all-in-one çš„ docker é•œåƒ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhigress-standalone%2Fblob%2Fmain%2Fall-in-one%2FDockerfile" target="_blank" title="https://github.com/higress-group/higress-standalone/blob/main/all-in-one/Dockerfile" ref="nofollow noopener noreferrer">github.com/higress-groâ€¦</a></p>
<p>[2] higress-plugin-server</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnkirito.moe%2Fhigress-plugin-server%2F" target="_blank" title="https://www.cnkirito.moe/higress-plugin-server/" ref="nofollow noopener noreferrer">www.cnkirito.moe/higress-pluâ€¦</a></p>
<p>[3] åŸºäº nacos-server çš„é•œåƒè¿›è¡Œéƒ¨ç½²</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnacos-group%2Fnacos-docker%2Fblob%2Fmaster%2Fbuild%2FDockerfile" target="_blank" title="https://github.com/nacos-group/nacos-docker/blob/master/build/Dockerfile" ref="nofollow noopener noreferrer">github.com/nacos-groupâ€¦</a></p>
<p>[4] è„šæœ¬æºç </p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkmodules%2Fpeer-finder%2Fblob%2Fmaster%2Fpeer-finder.go" target="_blank" title="https://github.com/kmodules/peer-finder/blob/master/peer-finder.go" ref="nofollow noopener noreferrer">github.com/kmodules/peâ€¦</a></p>
<p>[5] mysql-schema.sql</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Fnacos%2Fblob%2Fdevelop%2Fdistribution%2Fconf%2Fmysql-schema.sql" target="_blank" title="https://github.com/alibaba/nacos/blob/develop/distribution/conf/mysql-schema.sql" ref="nofollow noopener noreferrer">github.com/alibaba/nacâ€¦</a></p>
<p>[6] Higress æä¾›ä¸°å¯Œé‰´æƒèƒ½åŠ›</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhigress.cn%2Fdocs%2Flatest%2Fplugins%2Fauthentication%2Fbasic-auth%2F" target="_blank" title="https://higress.cn/docs/latest/plugins/authentication/basic-auth/" ref="nofollow noopener noreferrer">higress.cn/docs/latestâ€¦</a></p>
<p>[7]Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUzNzYxNjAzMg%3D%3D%26mid%3D2247575770%26idx%3D1%26sn%3Dca41d8dade57fcf378e1f7c5a5e0dca5%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUzNzYxNjAzMg==&amp;mid=2247575770&amp;idx=1&amp;sn=ca41d8dade57fcf378e1f7c5a5e0dca5&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åŸºäº Nacos + Higress Â çš„ MCP å¼€å‘æ–°èŒƒå¼ï¼Œæ‰‹æŠŠæ‰‹æ•™ç¨‹æ¥äº†ï¼</a></p>
<p>[8]Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU0MzkyMTgzNg%3D%3D%26mid%3D2247486505%26idx%3D1%26sn%3Db61997531cce196d0b7fc46f79a003be%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU0MzkyMTgzNg==&amp;mid=2247486505&amp;idx=1&amp;sn=b61997531cce196d0b7fc46f79a003be&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Nacos 3.0 æ­£å¼å‘å¸ƒï¼šMCP Registryã€å®‰å…¨é›¶ä¿¡ä»»ã€é“¾æ¥æ›´å¤šç”Ÿæ€</a></p>
<p>[9] ä¿®æ”¹å†…ç½®æ’ä»¶çš„é•œåƒåœ°å€</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhigress.cn%2Fdocs%2Flatest%2Fops%2Fhow-tos%2Fbuiltin-plugin-url%2F" target="_blank" title="https://higress.cn/docs/latest/ops/how-tos/builtin-plugin-url/" ref="nofollow noopener noreferrer">higress.cn/docs/latestâ€¦</a></p>
<p>[10] Nacos é›†ç¾¤æ¨¡å¼</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnacos.io%2Fdocs%2Flatest%2Fmanual%2Fadmin%2Fdeployment%2Fdeployment-cluster%2F" target="_blank" title="https://nacos.io/docs/latest/manual/admin/deployment/deployment-cluster/" ref="nofollow noopener noreferrer">nacos.io/docs/latestâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çº¿ä¸‹æ´»åŠ¨é€Ÿé€’ä¸¨AI åŸç”Ÿåº”ç”¨å¼€æºå¼€å‘è€…æ²™é¾™Â·æ­å·ç«™]]></title>    <link>https://juejin.cn/post/7581097545670869011</link>    <guid>https://juejin.cn/post/7581097545670869011</guid>    <pubDate>2025-12-08T09:23:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097545670869011" data-draft-id="7581210455827038244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çº¿ä¸‹æ´»åŠ¨é€Ÿé€’ä¸¨AI åŸç”Ÿåº”ç”¨å¼€æºå¼€å‘è€…æ²™é¾™Â·æ­å·ç«™"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-08T09:23:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çº¿ä¸‹æ´»åŠ¨é€Ÿé€’ä¸¨AI åŸç”Ÿåº”ç”¨å¼€æºå¼€å‘è€…æ²™é¾™Â·æ­å·ç«™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:23:54.000Z" title="Mon Dec 08 2025 09:23:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><ul>
<li>
<p><strong>æ—¶é—´ï¼š12 æœˆÂ 12Â æ—¥ï¼ˆå‘¨äº”ï¼‰13ï¼š30</strong></p>
</li>
<li>
<p><strong>åœ°ç‚¹ï¼šæ­å·é˜¿é‡Œå·´å·´äº‘è°·å›­åŒºÂ 2Â å·æ¥¼è®¿å®¢ä¸­å¿ƒÂ 225Â æ™¯é€¸ä¹¦é™¢</strong></p>
</li>
</ul>
<p>äº†è§£Â AIÂ åŸç”Ÿåº”ç”¨å¼€å‘çš„å‰æ²¿è¶‹åŠ¿å’Œæ ¸å¿ƒäº§å“æŠ€æœ¯ï¼Œå…¨é¢Â getÂ å…¸å‹åº”ç”¨åœºæ™¯åŠç¡¬æ ¸å®æˆ˜ç»éªŒã€‚</p>
<p>ç°åœºå®Œæˆå®æ“ï¼Œé¢å‘ä¸“å±è¯ä¹¦ï¼</p>
<p>å…è´¹æŠ¥åé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Factivity%2Fmiddleware%2F2025-ai-hangzhou" target="_blank" title="https://www.aliyun.com/activity/middleware/2025-ai-hangzhou" ref="nofollow noopener noreferrer">www.aliyun.com/activity/miâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98f6b2dc601a4a7a9f6fa105f70cc5d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765790633&amp;x-signature=aSIv13dpBUeny%2FePDCvOb%2Bsxb4A%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™ new æ“ä½œç¬¦å’Œ instanceofï¼šæ·±å…¥ç†è§£ JavaScript å¯¹è±¡åˆ›å»ºä¸åŸå‹é“¾æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7581097111896080438</link>    <guid>https://juejin.cn/post/7581097111896080438</guid>    <pubDate>2025-12-08T09:26:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581097111896080438" data-draft-id="7581210455827087396" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™ new æ“ä½œç¬¦å’Œ instanceofï¼šæ·±å…¥ç†è§£ JavaScript å¯¹è±¡åˆ›å»ºä¸åŸå‹é“¾æ£€æµ‹"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ECMAScript 6"/> <meta itemprop="datePublished" content="2025-12-08T09:26:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™ new æ“ä½œç¬¦å’Œ instanceofï¼šæ·±å…¥ç†è§£ JavaScript å¯¹è±¡åˆ›å»ºä¸åŸå‹é“¾æ£€æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:26:45.000Z" title="Mon Dec 08 2025 09:26:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨JavaScriptä¸­ï¼Œ<code>new</code>æ“ä½œç¬¦å’Œ<code>instanceof</code>æ“ä½œç¬¦æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µã€‚ç†è§£å®ƒä»¬çš„åº•å±‚åŸç†ä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ä½¿ç”¨JavaScriptï¼Œè¿˜èƒ½åœ¨é¢è¯•ä¸­å±•ç°å‡ºæ›´æ‰å®çš„åŸºç¡€çŸ¥è¯†ã€‚</p>
<p>ä½ æ˜¯å¦æ›¾å¥½å¥‡:</p>
<ul>
<li>å½“æˆ‘ä»¬ä½¿ç”¨<code>new</code>åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒèƒŒååˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?</li>
<li><code>instanceof</code>æ˜¯å¦‚ä½•æ£€æµ‹å¯¹è±¡ç±»å‹çš„?</li>
<li>åŸå‹é“¾åœ¨å¯¹è±¡åˆ›å»ºå’Œç±»å‹æ£€æµ‹ä¸­æ‰®æ¼”äº†ä»€ä¹ˆè§’è‰²?</li>
</ul>
<p>é€šè¿‡æ‰‹å†™å®ç°è¿™ä¸¤ä¸ªæ“ä½œç¬¦, æˆ‘ä»¬å°†æ·±å…¥ç†è§£JavaScriptçš„å¯¹è±¡åˆ›å»ºæœºåˆ¶å’ŒåŸå‹é“¾æ£€æµ‹åŸç†ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€newæ“ä½œç¬¦çš„æ·±å…¥ç†è§£</h4>
<h5 data-id="heading-2">1.1 newæ“ä½œç¬¦çš„ä½œç”¨</h5>
<p><code>new</code>æ“ä½œç¬¦ç”¨äºåˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸºæœ¬ç”¨æ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span> years old.`</span>);
};

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">25</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">name</span>); <span class="hljs-comment">// Alice</span>
person.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// Hello, I'm Alice, 25 years old.</span>
</code></pre>
<h5 data-id="heading-3">1.2 newæ“ä½œç¬¦çš„æ‰§è¡Œè¿‡ç¨‹</h5>
<p>å½“æˆ‘ä»¬æ‰§è¡Œ<code>new Constructor(...args)</code>æ—¶, JavaScriptå¼•æ“ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤:</p>
<ol>
<li><strong>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡:</strong> åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å•JavaScriptå¯¹è±¡(å³<code>{}</code>)</li>
<li><strong>è®¾ç½®åŸå‹é“¾:</strong> å°†æ–°å¯¹è±¡çš„<code>[[Prototype]]</code>(å³<code>__proto__</code>)æŒ‡å‘æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§</li>
<li><strong>ç»‘å®šthiså€¼:</strong> å°†æ„é€ å‡½æ•°ä¸­çš„<code>this</code>ç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡</li>
<li><strong>æ‰§è¡Œæ„é€ å‡½æ•°:</strong> æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç (ä¸ºæ–°å¯¹è±¡æ·»åŠ å±æ€§)</li>
<li><strong>è¿”å›ç»“æœ:</strong></li>
</ol>
<ul>
<li>å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡, åˆ™è¿”å›è¿™ä¸ªå¯¹è±¡</li>
<li>å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</li>
</ul>
<h4 data-id="heading-4">äºŒã€æ‰‹å†™newæ“ä½œç¬¦</h4>
<h5 data-id="heading-5">2.1 åŸºç¡€å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ‰‹å†™ new æ“ä½œç¬¦
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args æ„é€ å‡½æ•°å‚æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} æ–°åˆ›å»ºçš„å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œç»§æ‰¿æ„é€ å‡½æ•°çš„åŸå‹</span>
  <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);

  <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®š this åˆ°æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);

  <span class="hljs-comment">// 3. å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡, åˆ™è¿”å›è¯¥å¯¹è±¡; å¦åˆ™è¿”å›æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> ? result : obj;
}

<span class="hljs-comment">// æµ‹è¯•åŸºç¡€åŠŸèƒ½</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">introduce</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span> years old.`</span>);
};

<span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">25</span>);
<span class="hljs-keyword">const</span> person2 = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">"Bob"</span>, <span class="hljs-number">30</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2.<span class="hljs-property">name</span>); <span class="hljs-comment">// Bob</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2.<span class="hljs-property">age</span>); <span class="hljs-comment">// 30</span>
person2.<span class="hljs-title function_">introduce</span>(); <span class="hljs-comment">// Hi, I'm Bob, 30 years old.</span>

</code></pre>
<h5 data-id="heading-6">2.2 å®Œæ•´å®ç°(å¤„ç†è¾¹ç•Œæƒ…å†µ)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å®Œæ•´ç‰ˆ myNew å®ç°ï¼Œå¤„ç†å„ç§è¾¹ç•Œæƒ…å†µ
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args æ„é€ å‡½æ•°å‚æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} æ–°åˆ›å»ºçš„å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Constructor must be a function."</span>);
  }

  <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, ç»§æ‰¿æ„é€ å‡½æ•°çš„åŸå‹</span>
  <span class="hljs-comment">// ä½¿ç”¨ Object.create è€Œä¸æ˜¯ {}, ç¡®ä¿åŸå‹é“¾æ­£ç¡®</span>
  <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);

  <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°, ç»‘å®š this åˆ°æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);

  <span class="hljs-comment">// 3. å¤„ç†è¿”å›å€¼</span>
  <span class="hljs-comment">// 3.1 å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡</span>
  <span class="hljs-comment">// 3.2 å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> isObject = result !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">"object"</span>;
  <span class="hljs-keyword">const</span> isFunction = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">"function"</span>;

  <span class="hljs-keyword">return</span> isObject || isFunction ? result : obj;
}
<span class="hljs-comment">// æµ‹è¯•å„ç§è¾¹ç•Œæƒ…å†µ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== æµ‹è¯• myNewComplete ==="</span>);

<span class="hljs-comment">// æµ‹è¯•1: æ„é€ å‡½æ•°è¿”å›å¯¹è±¡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PersonWithReturnObject</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">"custom object"</span> };
}

<span class="hljs-keyword">const</span> test1 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">PersonWithReturnObject</span>, <span class="hljs-string">"Alice"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•1 - æ„é€ å‡½æ•°è¿”å›å¯¹è±¡:"</span>, test1); <span class="hljs-comment">// { custom: 'custom object' }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æµ‹è¯•1 - ä¸æ˜¯ Person å®ä¾‹:"</span>,
  !(test1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">PersonWithReturnObject</span>)
); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•2: æ„é€ å‡½æ•°è¿”å› null</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PersonWithReturnNull</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">const</span> test2 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">PersonWithReturnNull</span>, <span class="hljs-string">"Bob"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æµ‹è¯•2 - æ„é€ å‡½æ•°è¿”å› null:"</span>,
  test2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">PersonWithReturnNull</span>
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•2 - name å±æ€§:"</span>, test2.<span class="hljs-property">name</span>); <span class="hljs-comment">// Bob</span>

<span class="hljs-comment">// æµ‹è¯•3: æ„é€ å‡½æ•°è¿”å›å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PersonWithReturnFunction</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"I am a function"</span>;
  };
}

<span class="hljs-keyword">const</span> test3 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">PersonWithReturnFunction</span>, <span class="hljs-string">"Charlie"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•3 - æ„é€ å‡½æ•°è¿”å›å‡½æ•°:"</span>, <span class="hljs-keyword">typeof</span> test3); <span class="hljs-comment">// function</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•3 - å‡½æ•°è°ƒç”¨:"</span>, <span class="hljs-title function_">test3</span>()); <span class="hljs-comment">// I am a function</span>

<span class="hljs-comment">// æµ‹è¯•4: æ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PersonWithReturnPrimitive</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;
}

<span class="hljs-keyword">const</span> test4 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">PersonWithReturnPrimitive</span>, <span class="hljs-string">"David"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æµ‹è¯•4 - æ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹:"</span>,
  test4 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">PersonWithReturnPrimitive</span>
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•4 - name å±æ€§:"</span>, test4.<span class="hljs-property">name</span>); <span class="hljs-comment">// David</span>

<span class="hljs-comment">// æµ‹è¯•5: æ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å€¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PersonNoReturn</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">const</span> test5 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">PersonNoReturn</span>, <span class="hljs-string">"Eve"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•5 - æ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å€¼:"</span>, test5 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">PersonNoReturn</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•5 - name å±æ€§:"</span>, test5.<span class="hljs-property">name</span>); <span class="hljs-comment">// Eve</span>
</code></pre>
<h5 data-id="heading-7">2.3 å¤„ç†ES6ç±»çš„ç‰ˆæœ¬</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å®Œæ•´ç‰ˆ myNew å®ç°ï¼Œå¤„ç†å„ç§è¾¹ç•Œæƒ…å†µï¼ˆåŒ…æ‹¬ ES6 ç±»ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args æ„é€ å‡½æ•°å‚æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} æ–°åˆ›å»ºçš„å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Constructor must be a function."</span>);
  }

  <span class="hljs-comment">// æ˜¯å“Ÿå“¦é‚£ä¸ª Reflect.construct å¤„ç† ES6 ç±»å’Œæ™®é€šå‡½æ•°</span>
  <span class="hljs-keyword">const</span> instance = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">construct</span>(<span class="hljs-title class_">Constructor</span>, args, <span class="hljs-title class_">Constructor</span>);

  <span class="hljs-comment">// å¯¹äºæ™®é€šå‡½æ•°, å¤„ç†è¿”å›å€¼é€»è¾‘</span>
  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ˜¯ ES6ç±»(ç®€å•åˆ¤æ–­æ–¹å¼)</span>
  <span class="hljs-keyword">const</span> isClass =
    <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> === <span class="hljs-string">"function"</span> &amp;&amp;
    (<span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"class"</span>) ||
      <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-title class_">Constructor</span>).<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"class"</span>));

  <span class="hljs-keyword">if</span> (!isClass) {
    <span class="hljs-comment">// æ£€æŸ¥æ„é€ å‡½æ•°æ˜¯å¦æ˜¾å¼è¿”å›äº†å¯¹è±¡/å‡½æ•°</span>
    <span class="hljs-keyword">const</span> isObject = instance !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> instance === <span class="hljs-string">"object"</span>;
    <span class="hljs-keyword">const</span> isFunction = <span class="hljs-keyword">typeof</span> instance === <span class="hljs-string">"function"</span>;

    <span class="hljs-comment">// å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„ä¸æ˜¯ç»§æ‰¿è‡ªå…¶åŸå‹çš„å¯¹è±¡, è¯´æ˜æ˜¾å¼è¿”å›äº†å…¶ä»–å€¼</span>
    <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) {
      <span class="hljs-keyword">return</span> isObject || isFunction
        ? instance
        : <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    }
  }

  <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<h4 data-id="heading-8">2.4 æµ‹è¯•ç”¨ä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== å®Œæ•´æµ‹è¯•ç”¨ä¾‹ ==="</span>);

<span class="hljs-comment">// æµ‹è¯•ç±»ç»§æ‰¿</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> makes a noise.`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, breed</span>) {
    <span class="hljs-variable language_">super</span>(name);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">breed</span> = breed;
  }

  <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breed}</span>) barks.`</span>);
  }
}

<span class="hljs-comment">// æµ‹è¯• ES6 ç±»</span>
<span class="hljs-keyword">const</span> dog1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">"Rex"</span>, <span class="hljs-string">"Labrador"</span>);
<span class="hljs-keyword">const</span> dog2 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">Dog</span>, <span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Golden Retriever"</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog1 instanceof Dog:"</span>, dog1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog2 instanceof Dog:"</span>, dog2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog1 instanceof Animal:"</span>, dog1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog2 instanceof Animal:"</span>, dog2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>

dog1.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">// Rex (Labrador) barks.</span>
dog2.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">// Buddy (Golden Retriever) barks.</span>

<span class="hljs-comment">// æµ‹è¯•å†…ç½®æ„é€ å‡½æ•°</span>
<span class="hljs-keyword">const</span> date1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">"2025-12-08"</span>);
<span class="hljs-keyword">const</span> date2 = <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-title class_">Date</span>, <span class="hljs-string">"2025-12-08"</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"date1 instanceof Date:"</span>, date1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"date2 instanceof Date:"</span>, date2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"date1.toISOString():"</span>, date1.<span class="hljs-title function_">toISOString</span>()); <span class="hljs-comment">// 2025-12-08T00:00:00.000Z</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"date2.toISOString():"</span>, date2.<span class="hljs-title function_">toISOString</span>()); <span class="hljs-comment">// 2025-12-08T00:00:00.000Z</span>

<span class="hljs-comment">// æµ‹è¯•é”™è¯¯æƒ…å†µ</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-literal">null</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”™è¯¯æµ‹è¯•1 - null:"</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// Constructor must be a function</span>
}

<span class="hljs-keyword">try</span> {
  <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-number">42</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”™è¯¯æµ‹è¯•2 - æ•°å­—:"</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// Constructor must be a function</span>
}

<span class="hljs-keyword">try</span> {
  <span class="hljs-title function_">myNewComplete</span>(<span class="hljs-string">"string"</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”™è¯¯æµ‹è¯•3 - å­—ç¬¦ä¸²:"</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// Constructor must be a function</span>
}
</code></pre>
<h4 data-id="heading-9">ä¸‰ã€instanceofçš„æ·±å…¥ç†è§£</h4>
<h5 data-id="heading-10">3.1 instanceofæ“ä½œç¬¦çš„ä½œç”¨</h5>
<p><code>instanceof</code>æ“ä½œç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"/>) {}

<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// false</span>
</code></pre>
<h5 data-id="heading-11">3.2 instanceofçš„å·¥ä½œåŸç†</h5>
<p><code>instanceof</code>æ“ä½œç¬¦çš„ç®—æ³•å¯ä»¥æè¿°ä¸º:</p>
<ol>
<li>è·å–å³ä¾§æ“ä½œæ•°çš„<code>prototype</code>å±æ€§</li>
<li>è·å–å·¦ä¾§æ“ä½œæ•°çš„<code>[[Prototype]]</code>é“¾(å³<code>__proto__</code>é“¾)</li>
<li>æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾, å¦‚æœæ‰¾åˆ°ä¸å³ä¾§<code>prototype</code>ç›¸åŒçš„å¯¹è±¡, è¿”å›<code>true</code></li>
<li>å¦‚æœåˆ°è¾¾åŸå‹é“¾æœ«ç«¯(<code>null</code>)ä»æœªæ‰¾åˆ°, è¿”å›<code>false</code></li>
</ol>
<h4 data-id="heading-12">å››ã€æ‰‹å†™ instanceof æ“ä½œç¬¦</h4>
<h5 data-id="heading-13">4.1 åŸºç¡€å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ‰‹å†™ instanceof æ“ä½œç¬¦
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} instance éœ€è¦æ£€æµ‹çš„å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myInstanceof</span>(<span class="hljs-params">instance, Constructor</span>) {
  <span class="hljs-comment">// åŸºæœ¬ç±»å‹ç›´æ¥è¿”å›false</span>
  <span class="hljs-keyword">if</span> (
    instance === <span class="hljs-literal">null</span> ||
    (<span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">"object"</span> &amp;&amp; <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">"function"</span>)
  ) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-comment">// è·å–æ„é€ å‡½æ•°çš„ prototype</span>
  <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;

  <span class="hljs-comment">// è·å–å®ä¾‹çš„åŸå‹</span>
  <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(instance);

  <span class="hljs-comment">// æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾</span>
  <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (proto === prototype) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">// æµ‹è¯•åŸºç¡€åŠŸèƒ½</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params"/>) {}

<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== æµ‹è¯• myInstanceof ==="</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog instanceof Dog:"</span>, <span class="hljs-title function_">myInstanceof</span>(dog, <span class="hljs-title class_">Dog</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog instanceof Animal:"</span>, <span class="hljs-title function_">myInstanceof</span>(dog, <span class="hljs-title class_">Animal</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog instanceof Object:"</span>, <span class="hljs-title function_">myInstanceof</span>(dog, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"dog instanceof Cat:"</span>, <span class="hljs-title function_">myInstanceof</span>(dog, <span class="hljs-title class_">Cat</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"cat instanceof Dog:"</span>, <span class="hljs-title function_">myInstanceof</span>(cat, <span class="hljs-title class_">Dog</span>)); <span class="hljs-comment">// false</span>
</code></pre>
<h5 data-id="heading-14">4.2 å®Œæ•´å®ç°(å¤„ç†è¾¹ç•Œæƒ…å†µ)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å®Œæ•´ç‰ˆ myInstanceof å®ç°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} instance è¦æ£€æµ‹çš„å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-params">instance, Constructor</span>) {
    <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Right-hand side of instanceof is not callable'</span>);
    }
    
    <span class="hljs-comment">// åŸºæœ¬ç±»å‹ç›´æ¥è¿”å› false</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šnull å’Œ undefined è¿”å› false</span>
    <span class="hljs-keyword">if</span> (instance === <span class="hljs-literal">null</span> || instance === <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// å¯¹äºéå¯¹è±¡ç±»å‹ï¼Œé™¤äº† function å¤–éƒ½è¿”å› false</span>
    <span class="hljs-keyword">const</span> type = <span class="hljs-keyword">typeof</span> instance;
    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'object'</span> &amp;&amp; type !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// è·å–æ„é€ å‡½æ•°çš„ prototype</span>
    <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// å¦‚æœæ„é€ å‡½æ•°çš„ prototype ä¸æ˜¯å¯¹è±¡ï¼ŒæŠ›å‡ºé”™è¯¯</span>
    <span class="hljs-keyword">if</span> (prototype === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> prototype !== <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Function has non-object prototype in instanceof check'</span>);
    }
    
    <span class="hljs-comment">// è·å–å®ä¾‹çš„åŸå‹</span>
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(instance);
    
    <span class="hljs-comment">// æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾</span>
    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (proto === prototype) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">// æµ‹è¯•å®Œæ•´åŠŸèƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== æµ‹è¯• myInstanceofComplete ==='</span>);

<span class="hljs-comment">// æµ‹è¯•1: åŸºæœ¬ç±»å‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - æ•°å­—:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-number">42</span>, <span class="hljs-title class_">Number</span>));         <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - å­—ç¬¦ä¸²:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-string">'hello'</span>, <span class="hljs-title class_">String</span>));  <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - å¸ƒå°”å€¼:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-literal">true</span>, <span class="hljs-title class_">Boolean</span>));    <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - null:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-literal">null</span>, <span class="hljs-title class_">Object</span>));       <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - undefined:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// æµ‹è¯•2: å¯¹è±¡ç±»å‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•2 - å¯¹è±¡:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(person, <span class="hljs-title class_">Person</span>));     <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•2 - å¯¹è±¡ instanceof Object:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(person, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•3: æ•°ç»„</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•3 - æ•°ç»„:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(arr, <span class="hljs-title class_">Array</span>));         <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•3 - æ•°ç»„ instanceof Object:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(arr, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•4: å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">testFunc</span>(<span class="hljs-params"/>) {}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•4 - å‡½æ•°:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(testFunc, <span class="hljs-title class_">Function</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•4 - å‡½æ•° instanceof Object:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(testFunc, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•5: å†…ç½®å¯¹è±¡</span>
<span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•5 - Date:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(date, <span class="hljs-title class_">Date</span>));         <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•5 - Date instanceof Object:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(date, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•6: åŸå‹é“¾ç»§æ‰¿</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•6 - åŸå‹é“¾:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(dog, <span class="hljs-title class_">Dog</span>));         <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•6 - åŸå‹é“¾:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(dog, <span class="hljs-title class_">Animal</span>));      <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•6 - åŸå‹é“¾:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(dog, <span class="hljs-title class_">Object</span>));      <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•7: é”™è¯¯æƒ…å†µ</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-title function_">myInstanceofComplete</span>({}, <span class="hljs-literal">null</span>);
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•7 - éå‡½æ•°:'</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// 'Right-hand side of instanceof is not callable'</span>
}

<span class="hljs-keyword">try</span> {
    <span class="hljs-title function_">myInstanceofComplete</span>({}, {<span class="hljs-attr">prototype</span>: <span class="hljs-literal">null</span>});
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•7 - éå‡½æ•°2:'</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// 'Right-hand side of instanceof is not callable'</span>
}
</code></pre>
<h5 data-id="heading-15">4.3 æµ‹è¯•ç”¨ä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== å®Œæ•´æµ‹è¯•ç”¨ä¾‹ ==='</span>);

<span class="hljs-comment">// å¤æ‚åŸå‹é“¾æµ‹è¯•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">GrandParent</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {}

<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">GrandParent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Parent</span>;

<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;

<span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŸå‹é“¾æµ‹è¯• - child instanceof Child:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(child, <span class="hljs-title class_">Child</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŸå‹é“¾æµ‹è¯• - child instanceof Parent:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(child, <span class="hljs-title class_">Parent</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŸå‹é“¾æµ‹è¯• - child instanceof GrandParent:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(child, <span class="hljs-title class_">GrandParent</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŸå‹é“¾æµ‹è¯• - child instanceof Object:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(child, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Symbol.hasInstance æµ‹è¯•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomClass</span> {
    <span class="hljs-keyword">static</span> [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](instance) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> instance === <span class="hljs-string">'object'</span> &amp;&amp; instance.<span class="hljs-property">isCustom</span> === <span class="hljs-literal">true</span>;
    }
}

<span class="hljs-keyword">const</span> customObj = { <span class="hljs-attr">isCustom</span>: <span class="hljs-literal">true</span> };
<span class="hljs-keyword">const</span> notCustomObj = { <span class="hljs-attr">isCustom</span>: <span class="hljs-literal">false</span> };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Symbol.hasInstance æµ‹è¯• - è‡ªå®šä¹‰å¯¹è±¡:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(customObj, <span class="hljs-title class_">CustomClass</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Symbol.hasInstance æµ‹è¯• - éè‡ªå®šä¹‰å¯¹è±¡:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(notCustomObj, <span class="hljs-title class_">CustomClass</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// è¾¹ç•Œæƒ…å†µï¼šObject.create(null)</span>
<span class="hljs-keyword">const</span> objWithoutProto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Object.create(null) æµ‹è¯•:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(objWithoutProto, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// è¾¹ç•Œæƒ…å†µï¼šä¿®æ”¹åŸå‹é“¾</span>
<span class="hljs-keyword">const</span> obj = {};
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¿®æ”¹åŸå‹é“¾æµ‹è¯•:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(obj, <span class="hljs-title class_">Array</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¿®æ”¹åŸå‹é“¾æµ‹è¯•:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(obj, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// è¾¹ç•Œæƒ…å†µï¼šå¾ªç¯å¼•ç”¨ï¼ˆåº”é¿å…è¿™ç§æƒ…å†µï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">A</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">B</span>(<span class="hljs-params"/>) {}

<span class="hljs-comment">// è®¾ç½®å¾ªç¯åŸå‹é“¾ï¼ˆä¸æ¨èï¼Œä»…ç”¨äºæµ‹è¯•ï¼‰</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();
<span class="hljs-keyword">const</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();

<span class="hljs-comment">// æ³¨æ„ï¼šå®é™…ä¸­ä¸è¦è¿™æ ·åšï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†æµ‹è¯•</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è¿™é‡Œå¯èƒ½ä¼šé™·å…¥æ— é™å¾ªç¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰ä¿æŠ¤æœºåˆ¶</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾ªç¯å¼•ç”¨æµ‹è¯•:'</span>, <span class="hljs-title function_">myInstanceofComplete</span>(a, B));
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾ªç¯å¼•ç”¨æµ‹è¯• - æ•è·é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
}
</code></pre>
<h4 data-id="heading-16">äº”ã€newå’Œinstanceofçš„ç»¼åˆåº”ç”¨</h4>
<h5 data-id="heading-17">5.1 å®ç°ä¸€ä¸ªç»§æ‰¿ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ new å’Œ instanceof å®ç°å®Œæ•´çš„ç»§æ‰¿ç³»ç»Ÿ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">inherit</span>(<span class="hljs-params">Child, Parent</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºä¸­é—´æ„é€ å‡½æ•°ï¼Œé¿å…ç›´æ¥ä¿®æ”¹ Child.prototype</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">Temp</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {};
  <span class="hljs-title class_">Temp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;

  <span class="hljs-comment">// 2. è®¾ç½® Child çš„åŸå‹ä¸º Parent çš„å®ä¾‹</span>
  <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Temp</span>();

  <span class="hljs-comment">// 3. ä¿®å¤ constructor æŒ‡å‘</span>
  <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;

  <span class="hljs-comment">// 4. è®¾ç½® superClass å¼•ç”¨ï¼Œä¾¿äºè°ƒç”¨çˆ¶ç±»æ–¹æ³•</span>
  <span class="hljs-title class_">Child</span>.<span class="hljs-property">superClass</span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;

  <span class="hljs-comment">// 5. å¦‚æœçˆ¶ç±»çš„åŸå‹æ˜¯ Objectï¼Œéœ€è¦é¢å¤–å¤„ç†</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Object</span>) {
    <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Parent</span>;
  }
}

<span class="hljs-comment">// æµ‹è¯•ç»§æ‰¿ç³»ç»Ÿ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Shape</span>(<span class="hljs-params">color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-title class_">Shape</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getColor</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span>;
};

<span class="hljs-title class_">Shape</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getArea</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"getArea() must be implemented by subclasses"</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Circle</span>(<span class="hljs-params">color, radius</span>) {
  <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span>
  <span class="hljs-title class_">Shape</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, color);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> = radius;
}

<span class="hljs-comment">// ç»§æ‰¿ Shape</span>
<span class="hljs-title function_">inherit</span>(<span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">Shape</span>);

<span class="hljs-comment">// æ·»åŠ å­ç±»æ–¹æ³•</span>
<span class="hljs-title class_">Circle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getArea</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span>;
};

<span class="hljs-title class_">Circle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getCircumference</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span>;
};

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> circle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-string">"red"</span>, <span class="hljs-number">5</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - color:"</span>, circle.<span class="hljs-title function_">getColor</span>()); <span class="hljs-comment">// red</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - area:"</span>, circle.<span class="hljs-title function_">getArea</span>().<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 78.54</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - circumference:"</span>, circle.<span class="hljs-title function_">getCircumference</span>().<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 31.42</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - instanceof Circle:"</span>, circle <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Circle</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - instanceof Shape:"</span>, circle <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Shape</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç»§æ‰¿æµ‹è¯• - instanceof Object:"</span>, circle <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>
</code></pre>
<h5 data-id="heading-18">5.2 å®ç°å¤šæ€æ£€æµ‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ instanceof å®ç°å¤šæ€ç±»å‹æ£€æµ‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    }
    
    <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> makes a noise.`</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> barks.`</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> meows.`</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> chirps.`</span>);
    }
}

<span class="hljs-comment">// å¤šæ€å¤„ç†å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimalHandler</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">animal</span>) {
        <span class="hljs-keyword">if</span> (animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Handling a dog named <span class="hljs-subst">${animal.name}</span>`</span>);
            animal.<span class="hljs-title function_">speak</span>();
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Taking the dog for a walk...'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Handling a cat named <span class="hljs-subst">${animal.name}</span>`</span>);
            animal.<span class="hljs-title function_">speak</span>();
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Giving the cat some milk...'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Bird</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Handling a bird named <span class="hljs-subst">${animal.name}</span>`</span>);
            animal.<span class="hljs-title function_">speak</span>();
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Letting the bird fly...'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Handling an unknown animal named <span class="hljs-subst">${animal.name}</span>`</span>);
            animal.<span class="hljs-title function_">speak</span>();
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Providing general care...'</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Not an animal!'</span>);
        }
    }
}

<span class="hljs-comment">// æµ‹è¯•å¤šæ€</span>
<span class="hljs-keyword">const</span> animals = [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Rex'</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'Whiskers'</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>(<span class="hljs-string">'Tweety'</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">'Generic'</span>),
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Not an animal'</span> }
];

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== å¤šæ€å¤„ç†æµ‹è¯• ==='</span>);
animals.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">animal</span> =&gt;</span> {
    <span class="hljs-title class_">AnimalHandler</span>.<span class="hljs-title function_">handle</span>(animal);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'---'</span>);
});
</code></pre>
<h4 data-id="heading-19">å…­ã€å¸¸è§é¢è¯•é¢˜</h4>
<h5 data-id="heading-20">6.1 å®ç°Object.create()</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ‰‹å†™ Object.create()
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} proto æ–°åˆ›å»ºå¯¹è±¡çš„åŸå‹å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} propertiesObject å¯é€‰ï¼ŒåŒ…å«å±æ€§æè¿°ç¬¦çš„å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} æ–°å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myObjectCreate</span>(<span class="hljs-params">proto, propertiesObject</span>) {
    <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
    <span class="hljs-keyword">if</span> (proto !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> proto !== <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> proto !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Object prototype may only be an Object or null'</span>);
    }
    
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç©ºæ„é€ å‡½æ•°</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">Temp</span>(<span class="hljs-params"/>) {}
    
    <span class="hljs-comment">// è®¾ç½®æ„é€ å‡½æ•°çš„åŸå‹</span>
    <span class="hljs-title class_">Temp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = proto;
    
    <span class="hljs-comment">// åˆ›å»ºæ–°å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Temp</span>();
    
    <span class="hljs-comment">// å¦‚æœ proto æ˜¯ nullï¼Œæ‰‹åŠ¨è®¾ç½®åŸå‹ä¸º null</span>
    <span class="hljs-keyword">if</span> (proto === <span class="hljs-literal">null</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, <span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-comment">// å¤„ç†ç¬¬äºŒä¸ªå‚æ•°</span>
    <span class="hljs-keyword">if</span> (propertiesObject !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperties</span>(obj, propertiesObject);
    }
    
    <span class="hljs-keyword">return</span> obj;
}

<span class="hljs-comment">// æµ‹è¯• myObjectCreate</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== æµ‹è¯• myObjectCreate ==='</span>);

<span class="hljs-comment">// æµ‹è¯•1: åŸºæœ¬åŠŸèƒ½</span>
<span class="hljs-keyword">const</span> proto = { <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">20</span> };
<span class="hljs-keyword">const</span> obj1 = <span class="hljs-title function_">myObjectCreate</span>(proto);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - åŸå‹é“¾:'</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj1) === proto); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•1 - ç»§æ‰¿å±æ€§:'</span>, obj1.<span class="hljs-property">x</span>, obj1.<span class="hljs-property">y</span>); <span class="hljs-comment">// 10, 20</span>

<span class="hljs-comment">// æµ‹è¯•2: null åŸå‹</span>
<span class="hljs-keyword">const</span> obj2 = <span class="hljs-title function_">myObjectCreate</span>(<span class="hljs-literal">null</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•2 - null åŸå‹:'</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj2)); <span class="hljs-comment">// null</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•2 - æ²¡æœ‰ toString:'</span>, obj2.<span class="hljs-property">toString</span> === <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•3: å±æ€§æè¿°ç¬¦</span>
<span class="hljs-keyword">const</span> obj3 = <span class="hljs-title function_">myObjectCreate</span>({}, {
    <span class="hljs-attr">value</span>: {
        <span class="hljs-attr">value</span>: <span class="hljs-number">42</span>,
        <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
    }
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•3 - å±æ€§æè¿°ç¬¦:'</span>, obj3.<span class="hljs-property">value</span>); <span class="hljs-comment">// 42</span>
obj3.<span class="hljs-property">value</span> = <span class="hljs-number">100</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•3 - ä¸å¯å†™:'</span>, obj3.<span class="hljs-property">value</span>); <span class="hljs-comment">// 42 (ä¸å¯å†™)</span>

<span class="hljs-comment">// æµ‹è¯•4: ä¸åŸç”Ÿ Object.create æ¯”è¾ƒ</span>
<span class="hljs-keyword">const</span> nativeObj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(proto);
<span class="hljs-keyword">const</span> myObj = <span class="hljs-title function_">myObjectCreate</span>(proto);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•4 - åŸç”Ÿ vs æ‰‹å†™:'</span>, 
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(nativeObj) === <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(myObj)); <span class="hljs-comment">// true</span>
</code></pre>
<h5 data-id="heading-21">6.2 å®ç°Object.getPrototypeOf()</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ‰‹å†™ Object.getPrototypeOf()
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} obj è¦è·å–åŸå‹çš„å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object | null</span>} å¯¹è±¡çš„åŸå‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myGetPrototypeOf</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
  <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || obj === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Cannot convert undefined or null to object"</span>);
  }

  <span class="hljs-comment">// ä½¿ç”¨ __proto__ è®¿é—®å™¨(éæ ‡å‡†ï¼Œä½†å¹¿æ³›æ”¯æŒ)</span>
  <span class="hljs-comment">// æ³¨æ„: å®é™…ä¸­æ›´æ¨èä½¿ç”¨ Object.getPrototypeOf</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-string">"__proto__"</span> <span class="hljs-keyword">in</span> obj) {
    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">__proto__</span>;
  }

  <span class="hljs-comment">// å¯¹äºä¸æ”¯æŒ __proto__ çš„ç¯å¢ƒï¼Œä½¿ç”¨ Constructor å±æ€§</span>
  <span class="hljs-comment">// æ³¨æ„: è¿™ç§æ–¹æ³•ä¸å¯é ï¼Œå› ä¸º Constructor å¯èƒ½è¢«ä¿®æ”¹</span>
  <span class="hljs-keyword">if</span> (obj.<span class="hljs-property">constructor</span> &amp;&amp; obj.<span class="hljs-property">constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) {
    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  }

  <span class="hljs-comment">// å¯¹äºé€šè¿‡ Object.create(null) åˆ›å»ºçš„å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// æµ‹è¯• myGetPrototypeOf</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== æµ‹è¯• myGetPrototypeOf ==="</span>);

<span class="hljs-comment">// æµ‹è¯•1: æ™®é€šå¯¹è±¡</span>
<span class="hljs-keyword">const</span> obj1 = {};
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•1 - æ™®é€šå¯¹è±¡:"</span>, <span class="hljs-title function_">myGetPrototypeOf</span>(obj1) === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•2: æ•°ç»„</span>
<span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•2 - æ•°ç»„:"</span>, <span class="hljs-title function_">myGetPrototypeOf</span>(arr) === <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•3: è‡ªå®šä¹‰å¯¹è±¡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æµ‹è¯•3 - è‡ªå®šä¹‰å¯¹è±¡:"</span>,
  <span class="hljs-title function_">myGetPrototypeOf</span>(person) === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯•4: null åŸå‹</span>
<span class="hljs-keyword">const</span> nullProtoObj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•4 - null åŸå‹:"</span>, <span class="hljs-title function_">myGetPrototypeOf</span>(nullProtoObj)); <span class="hljs-comment">// null</span>

<span class="hljs-comment">// æµ‹è¯•5: é”™è¯¯æƒ…å†µ</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-title function_">myGetPrototypeOf</span>(<span class="hljs-literal">null</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•5 - null é”™è¯¯:"</span>, error.<span class="hljs-property">message</span>); <span class="hljs-comment">// Cannot convert undefined or null to object</span>
}
</code></pre>
<h5 data-id="heading-22">6.3 å®ç°å®Œæ•´çš„åŸå‹é“¾æ£€æµ‹å·¥å…·</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * åŸå‹é“¾æ£€æµ‹å·¥å…·ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PrototypeChainUtils</span> {
  <span class="hljs-comment">/**
   * è·å–å¯¹è±¡çš„å®Œæ•´åŸå‹é“¾
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} obj è¦æ£€æµ‹çš„å¯¹è±¡
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Array</span>} åŸå‹é“¾æ•°ç»„
   */</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getPrototypeChain</span>(<span class="hljs-params">obj</span>) {
    <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || obj === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Cannot convert undefined or null to object"</span>);
    }

    <span class="hljs-keyword">const</span> chain = [];
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj);

    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
      chain.<span class="hljs-title function_">push</span>(proto);
      proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }

    <span class="hljs-keyword">return</span> chain;
  }

  <span class="hljs-comment">/**
   * æ£€æŸ¥å¯¹è±¡æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} obj è¦æ£€æŸ¥çš„å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} target ç›®æ ‡åŸå‹
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š
   */</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">isInPrototypeChain</span>(<span class="hljs-params">obj, target</span>) {
    <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || obj === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj);

    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (proto === target) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
      proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-comment">/**
   * è·å–å¯¹è±¡åˆ°æŒ‡å®šåŸå‹çš„è·ç¦»
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} obj å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} target ç›®æ ‡åŸå‹
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} è·ç¦»(-1 è¡¨ç¤ºä¸å†åŸå‹é“¾ä¸Š)
   */</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDistanceToPrototype</span>(<span class="hljs-params">obj, target</span>) {
    <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || obj === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }

    <span class="hljs-keyword">let</span> distance = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj);

    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (proto === target) {
        <span class="hljs-keyword">return</span> distance;
      }
      distance++;
      proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }

    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  }
}

<span class="hljs-comment">// æµ‹è¯•åŸå‹é“¾å·¥å…·</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== æµ‹è¯• PrototypeChainUtils ==="</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">A</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">B</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">C</span>(<span class="hljs-params"/>) {}

B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = B;

C.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
C.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = C;

<span class="hljs-keyword">const</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>();

<span class="hljs-comment">// è·å–åŸå‹é“¾</span>
<span class="hljs-keyword">const</span> chain = <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getPrototypeChain</span>(c);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŸå‹é“¾:"</span>, chain);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŸå‹é“¾é•¿åº¦:"</span>, chain.<span class="hljs-property">length</span>); <span class="hljs-comment">// 4</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŒ…å« C.prototype:"</span>, chain[<span class="hljs-number">0</span>] === C.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŒ…å« B.prototype:"</span>, chain[<span class="hljs-number">1</span>] === B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŒ…å« A.prototype:"</span>, chain[<span class="hljs-number">2</span>] === A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŒ…å« Object.prototype:"</span>, chain[<span class="hljs-number">3</span>] === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š - C.prototype:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">isInPrototypeChain</span>(c, C.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š - B.prototype:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">isInPrototypeChain</span>(c, B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š - A.prototype:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">isInPrototypeChain</span>(c, A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š - Object.prototype:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">isInPrototypeChain</span>(c, <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š - ä¸å­˜åœ¨çš„åŸå‹:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">isInPrototypeChain</span>(c, <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// è·å–è·ç¦»</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"åˆ° C.prototype çš„è·ç¦»:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getDistanceToPrototype</span>(c, C.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// 0</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"åˆ° B.prototype çš„è·ç¦»:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getDistanceToPrototype</span>(c, B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// 1</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"åˆ° A.prototype çš„è·ç¦»:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getDistanceToPrototype</span>(c, A.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// 2</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"åˆ° Object.prototype çš„è·ç¦»:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getDistanceToPrototype</span>(c, <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
  <span class="hljs-string">"åˆ°ä¸å­˜åœ¨çš„åŸå‹çš„è·ç¦»:"</span>,
  <span class="hljs-title class_">PrototypeChainUtils</span>.<span class="hljs-title function_">getDistanceToPrototype</span>(c, <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)
); <span class="hljs-comment">// -1</span>

</code></pre>
<h4 data-id="heading-23">ä¸ƒã€å®é™…åº”ç”¨åœºæ™¯</h4>
<h5 data-id="heading-24">7.1 å®ç°å·¥å‚æ¨¡å¼</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ new å’Œ instanceof å®ç°å·¥å‚æ¨¡å¼</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">VehicleFactory</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">createVehicle</span>(<span class="hljs-params">type, options</span>) {
        <span class="hljs-keyword">switch</span> (type) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'car'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(options);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'truck'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Truck</span>(options);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'motorcycle'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Motorcycle</span>(options);
            <span class="hljs-attr">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Unknown vehicle type: <span class="hljs-subst">${type}</span>`</span>);
        }
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">validateVehicle</span>(<span class="hljs-params">vehicle</span>) {
        <span class="hljs-keyword">if</span> (!(vehicle <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Vehicle</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Invalid vehicle'</span>);
        }
        <span class="hljs-keyword">return</span> vehicle;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">make, model, year</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">make</span> = make;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">year</span> = year;
    }
    
    <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.year}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.make}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.model}</span>`</span>;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Vehicle</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
        <span class="hljs-variable language_">super</span>(options.<span class="hljs-property">make</span>, options.<span class="hljs-property">model</span>, options.<span class="hljs-property">year</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doors</span> = options.<span class="hljs-property">doors</span> || <span class="hljs-number">4</span>;
    }
    
    <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">super</span>.getInfo()}</span> (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.doors}</span> doors)`</span>;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Truck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Vehicle</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
        <span class="hljs-variable language_">super</span>(options.<span class="hljs-property">make</span>, options.<span class="hljs-property">model</span>, options.<span class="hljs-property">year</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">payload</span> = options.<span class="hljs-property">payload</span> || <span class="hljs-string">'1 ton'</span>;
    }
    
    <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">super</span>.getInfo()}</span> (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.payload}</span> payload)`</span>;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Motorcycle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Vehicle</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
        <span class="hljs-variable language_">super</span>(options.<span class="hljs-property">make</span>, options.<span class="hljs-property">model</span>, options.<span class="hljs-property">year</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = options.<span class="hljs-property">type</span> || <span class="hljs-string">'street'</span>;
    }
    
    <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">super</span>.getInfo()}</span> (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.type}</span> motorcycle)`</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨å·¥å‚æ¨¡å¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== å·¥å‚æ¨¡å¼æµ‹è¯• ==='</span>);

<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> car = <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">createVehicle</span>(<span class="hljs-string">'car'</span>, {
        <span class="hljs-attr">make</span>: <span class="hljs-string">'Toyota'</span>,
        <span class="hljs-attr">model</span>: <span class="hljs-string">'Camry'</span>,
        <span class="hljs-attr">year</span>: <span class="hljs-number">2022</span>,
        <span class="hljs-attr">doors</span>: <span class="hljs-number">4</span>
    });
    
    <span class="hljs-keyword">const</span> truck = <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">createVehicle</span>(<span class="hljs-string">'truck'</span>, {
        <span class="hljs-attr">make</span>: <span class="hljs-string">'Ford'</span>,
        <span class="hljs-attr">model</span>: <span class="hljs-string">'F-150'</span>,
        <span class="hljs-attr">year</span>: <span class="hljs-number">2021</span>,
        <span class="hljs-attr">payload</span>: <span class="hljs-string">'2 tons'</span>
    });
    
    <span class="hljs-keyword">const</span> motorcycle = <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">createVehicle</span>(<span class="hljs-string">'motorcycle'</span>, {
        <span class="hljs-attr">make</span>: <span class="hljs-string">'Harley-Davidson'</span>,
        <span class="hljs-attr">model</span>: <span class="hljs-string">'Sportster'</span>,
        <span class="hljs-attr">year</span>: <span class="hljs-number">2020</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'cruiser'</span>
    });
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Car:'</span>, car.<span class="hljs-title function_">getInfo</span>());
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Truck:'</span>, truck.<span class="hljs-title function_">getInfo</span>());
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Motorcycle:'</span>, motorcycle.<span class="hljs-title function_">getInfo</span>());
    
    <span class="hljs-comment">// éªŒè¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Car instanceof Vehicle:'</span>, <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">validateVehicle</span>(car) <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Vehicle</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Car instanceof Car:'</span>, car <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Car</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Truck instanceof Vehicle:'</span>, truck <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Vehicle</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Motorcycle instanceof Vehicle:'</span>, motorcycle <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Vehicle</span>);
    
    <span class="hljs-comment">// é”™è¯¯æµ‹è¯•</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">createVehicle</span>(<span class="hljs-string">'airplane'</span>, {});
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é”™è¯¯å¤„ç†:'</span>, error.<span class="hljs-property">message</span>);
    }
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title class_">VehicleFactory</span>.<span class="hljs-title function_">validateVehicle</span>({});
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'éªŒè¯é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
    }
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å·¥å‚æ¨¡å¼é”™è¯¯:'</span>, error);
}
</code></pre>
<h5 data-id="heading-25">7.2 å®ç°æ’ä»¶ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨åŸå‹é“¾å®ç°æ’ä»¶ç³»ç»Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PluginSystem</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">plugins</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    }
    
    <span class="hljs-comment">// æ³¨å†Œæ’ä»¶</span>
    <span class="hljs-title function_">register</span>(<span class="hljs-params">plugin</span>) {
        <span class="hljs-keyword">if</span> (!(plugin <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Plugin</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Plugin must be an instance of Plugin'</span>);
        }
        
        <span class="hljs-keyword">const</span> name = plugin.<span class="hljs-property">name</span>;
        
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">has</span>(name)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Plugin "<span class="hljs-subst">${name}</span>" is already registered`</span>);
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">set</span>(name, plugin);
        
        <span class="hljs-comment">// æ³¨å†Œé’©å­</span>
        <span class="hljs-keyword">if</span> (plugin.<span class="hljs-property">hooks</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [hookName, handler] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(plugin.<span class="hljs-property">hooks</span>)) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">has</span>(hookName)) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">set</span>(hookName, []);
                }
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">get</span>(hookName).<span class="hljs-title function_">push</span>(handler);
            }
        }
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Plugin "<span class="hljs-subst">${name}</span>" registered successfully`</span>);
    }
    
    <span class="hljs-comment">// è§¦å‘é’©å­</span>
    <span class="hljs-title function_">trigger</span>(<span class="hljs-params">hookName, ...args</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">has</span>(hookName)) {
            <span class="hljs-keyword">return</span> [];
        }
        
        <span class="hljs-keyword">const</span> results = [];
        <span class="hljs-keyword">const</span> handlers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span>.<span class="hljs-title function_">get</span>(hookName);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> handler <span class="hljs-keyword">of</span> handlers) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">handler</span>(...args);
                results.<span class="hljs-title function_">push</span>(result);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in hook "<span class="hljs-subst">${hookName}</span>":`</span>, error);
            }
        }
        
        <span class="hljs-keyword">return</span> results;
    }
    
    <span class="hljs-comment">// è·å–æ’ä»¶</span>
    <span class="hljs-title function_">getPlugin</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">get</span>(name);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ’ä»¶æ˜¯å¦å·²æ³¨å†Œ</span>
    <span class="hljs-title function_">hasPlugin</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">has</span>(name);
    }
}

<span class="hljs-comment">// æ’ä»¶åŸºç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Plugin</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span>.<span class="hljs-property">target</span> === <span class="hljs-title class_">Plugin</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Cannot instantiate Plugin directly'</span>);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span> = {};
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–é’©å­</span>
    <span class="hljs-title function_">init</span>(<span class="hljs-params">system</span>) {
        <span class="hljs-comment">// ç”±å­ç±»å®ç°</span>
    }
}

<span class="hljs-comment">// ç¤ºä¾‹æ’ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggerPlugin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Plugin</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>(<span class="hljs-string">'logger'</span>);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span> = {
            <span class="hljs-string">'beforeRequest'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">beforeRequest</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
            <span class="hljs-string">'afterResponse'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">afterResponse</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
            <span class="hljs-string">'onError'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">onError</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        };
    }
    
    <span class="hljs-title function_">beforeRequest</span>(<span class="hljs-params">request</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Logger] Request started: <span class="hljs-subst">${request.url}</span>`</span>);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">logged</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };
    }
    
    <span class="hljs-title function_">afterResponse</span>(<span class="hljs-params">response</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Logger] Response received: <span class="hljs-subst">${response.status}</span>`</span>);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">logged</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };
    }
    
    <span class="hljs-title function_">onError</span>(<span class="hljs-params">error</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[Logger] Error: <span class="hljs-subst">${error.message}</span>`</span>);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">logged</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() };
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnalyticsPlugin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Plugin</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>(<span class="hljs-string">'analytics'</span>);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hooks</span> = {
            <span class="hljs-string">'afterResponse'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">trackAnalytics</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        };
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span> = [];
    }
    
    <span class="hljs-title function_">trackAnalytics</span>(<span class="hljs-params">response</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span>.<span class="hljs-title function_">push</span>({
            <span class="hljs-attr">url</span>: response.<span class="hljs-property">url</span>,
            <span class="hljs-attr">status</span>: response.<span class="hljs-property">status</span>,
            <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
        });
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Analytics] Tracked request to <span class="hljs-subst">${response.url}</span>`</span>);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">tracked</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">totalRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span>.<span class="hljs-property">length</span> };
    }
    
    <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">totalRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span>.<span class="hljs-property">length</span>,
            <span class="hljs-attr">successfulRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>).<span class="hljs-property">length</span>,
            <span class="hljs-attr">failedRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">requests</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">status</span> !== <span class="hljs-number">200</span>).<span class="hljs-property">length</span>
        };
    }
}

<span class="hljs-comment">// ä½¿ç”¨æ’ä»¶ç³»ç»Ÿ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== æ’ä»¶ç³»ç»Ÿæµ‹è¯• ==='</span>);

<span class="hljs-keyword">const</span> pluginSystem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PluginSystem</span>();

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// æ³¨å†Œæ’ä»¶</span>
    <span class="hljs-keyword">const</span> logger = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LoggerPlugin</span>();
    <span class="hljs-keyword">const</span> analytics = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnalyticsPlugin</span>();
    
    pluginSystem.<span class="hljs-title function_">register</span>(logger);
    pluginSystem.<span class="hljs-title function_">register</span>(analytics);
    
    <span class="hljs-comment">// è§¦å‘é’©å­</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è§¦å‘ beforeRequest é’©å­:'</span>);
    <span class="hljs-keyword">const</span> beforeResults = pluginSystem.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'beforeRequest'</span>, { <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/data'</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span> });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Before request results:'</span>, beforeResults);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\nè§¦å‘ afterResponse é’©å­:'</span>);
    <span class="hljs-keyword">const</span> afterResults = pluginSystem.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'afterResponse'</span>, { <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/data'</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">data</span>: {} });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'After response results:'</span>, afterResults);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\nè§¦å‘ onError é’©å­:'</span>);
    <span class="hljs-keyword">const</span> errorResults = pluginSystem.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'onError'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Network error'</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Error results:'</span>, errorResults);
    
    <span class="hljs-comment">// è·å–æ’ä»¶</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\næ’ä»¶æ£€æŸ¥:'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Has logger plugin:'</span>, pluginSystem.<span class="hljs-title function_">hasPlugin</span>(<span class="hljs-string">'logger'</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Has analytics plugin:'</span>, pluginSystem.<span class="hljs-title function_">hasPlugin</span>(<span class="hljs-string">'analytics'</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Has unknown plugin:'</span>, pluginSystem.<span class="hljs-title function_">hasPlugin</span>(<span class="hljs-string">'unknown'</span>));
    
    <span class="hljs-comment">// è·å–ç»Ÿè®¡ä¿¡æ¯</span>
    <span class="hljs-keyword">const</span> analyticsPlugin = pluginSystem.<span class="hljs-title function_">getPlugin</span>(<span class="hljs-string">'analytics'</span>);
    <span class="hljs-keyword">if</span> (analyticsPlugin <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">AnalyticsPlugin</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\nAnalytics stats:'</span>, analyticsPlugin.<span class="hljs-title function_">getStats</span>());
    }
    
    <span class="hljs-comment">// é”™è¯¯æµ‹è¯•</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\né”™è¯¯æµ‹è¯•:'</span>);
    <span class="hljs-keyword">try</span> {
        pluginSystem.<span class="hljs-title function_">register</span>({}); <span class="hljs-comment">// ä¸æ˜¯ Plugin å®ä¾‹</span>
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ³¨å†Œéæ’ä»¶é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
    }
    
    <span class="hljs-keyword">try</span> {
        pluginSystem.<span class="hljs-title function_">register</span>(logger); <span class="hljs-comment">// é‡å¤æ³¨å†Œ</span>
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é‡å¤æ³¨å†Œé”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
    }
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ’ä»¶ç³»ç»Ÿé”™è¯¯:'</span>, error);
}
</code></pre>
<h4 data-id="heading-26">å…«ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h4>
<h5 data-id="heading-27">81 æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h5>
<ol>
<li><strong>newæ“ä½œç¬¦çš„æ‰§è¡Œæ­¥éª¤:</strong></li>
</ol>
<ul>
<li>åˆ›å»ºæ–°å¯¹è±¡</li>
<li>è®¾ç½®åŸå‹é“¾</li>
<li>ç»‘å®š this å€¼</li>
<li>æ‰§è¡Œæ„é€ å‡½æ•°</li>
<li>å¤„ç†è¿”å›å€¼</li>
</ul>
<ol start="2">
<li><strong>instanceofçš„å·¥ä½œåŸç†:</strong></li>
</ol>
<ul>
<li>æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾</li>
<li>æ¯”è¾ƒæ„é€ å‡½æ•°çš„prototypeå±æ€§</li>
<li>æ”¯æŒSymbol.hasInstanceè‡ªå®šä¹‰æ£€æµ‹</li>
</ul>
<ol start="3">
<li><strong>åŸå‹é“¾çš„é‡è¦æ€§:</strong></li>
</ol>
<ul>
<li>æ˜¯å®ç°ç»§æ‰¿çš„åŸºç¡€</li>
<li>å½±å“ instanceof çš„æ£€æµ‹ç»“æœ</li>
<li>å†³å®šäº†å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•æŸ¥æ‰¾è·¯å¾„</li>
</ul>
<h5 data-id="heading-28">8.2 æ‰‹å†™å®ç°çš„å…³é”®ç‚¹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// new æ“ä½œç¬¦å®ç°çš„å…³é”®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºå¯¹è±¡å¹¶è®¾ç½®åŸå‹</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 3. å¤„ç†è¿”å›å€¼</span>
    <span class="hljs-keyword">return</span> result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> ? result : obj;
}

<span class="hljs-comment">// instanceof æ“ä½œç¬¦å®ç°çš„å…³é”®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myInstanceof</span>(<span class="hljs-params">instance, Constructor</span>) {
    <span class="hljs-comment">// 1. åŸºæœ¬ç±»å‹ç›´æ¥è¿”å› false</span>
    <span class="hljs-keyword">if</span> (instance === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// 2. è·å–åŸå‹é“¾</span>
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(instance);
    <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. æ²¿ç€åŸå‹é“¾æŸ¥æ‰¾</span>
    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (proto === prototype) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h5 data-id="heading-29">8.3 æœ€ä½³å®è·µ</h5>
<ol>
<li><strong>ä½¿ç”¨newæ“ä½œç¬¦æ—¶:</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¥½çš„å®è·µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-keyword">if</span> (!(<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(name); <span class="hljs-comment">// é˜²æ­¢å¿˜è®°ä½¿ç”¨ new</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ ES6 class</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    }
}
</code></pre>
<ol start="2">
<li><strong>ä½¿ç”¨instanceofæ—¶:</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¥½çš„å®è·µ - æ£€æŸ¥ç±»å‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>) {
        <span class="hljs-comment">// å¤„ç†æ•°ç»„</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>) {
        <span class="hljs-comment">// å¤„ç†æ—¥æœŸ</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span>) {
        <span class="hljs-comment">// å¤„ç†æ­£åˆ™è¡¨è¾¾å¼</span>
    }
}

<span class="hljs-comment">// æ›´å¥½çš„å®è·µ - ä½¿ç”¨é¸­å­ç±»å‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) {
        <span class="hljs-comment">// å¤„ç†æ•°ç»„</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span> || <span class="hljs-keyword">typeof</span> value.<span class="hljs-property">getMonth</span> === <span class="hljs-string">'function'</span>) {
        <span class="hljs-comment">// å¤„ç†æ—¥æœŸ</span>
    }
}
</code></pre>
<ol start="3">
<li><strong>é¿å…çš„é—®é¢˜:</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¿å…çš„é—®é¢˜1: ä¿®æ”¹å†…ç½®å¯¹è±¡çš„åŸå‹</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">customMethod</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
<span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-property">customMethod</span>); <span class="hljs-comment">// function</span>

<span class="hljs-comment">// é¿å…çš„é—®é¢˜2: è·¨æ¡†æ¶çš„ instanceof é—®é¢˜</span>
<span class="hljs-comment">// åœ¨ä¸åŒ iframe ä¸­åˆ›å»ºçš„æ•°ç»„ï¼Œinstanceof å¯èƒ½è¿”å› false</span>

<span class="hljs-comment">// é¿å…çš„é—®é¢˜3: constructor è¢«ä¿®æ”¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();
person.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Object</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// false</span>
</code></pre>
<h5 data-id="heading-30">8.4 æ€§èƒ½è€ƒè™‘</h5>
<ol>
<li><strong>newæ“ä½œç¬¦çš„æ€§èƒ½:</strong></li>
</ol>
<ul>
<li>åŸç”Ÿçš„<code>new</code>æ“ä½œç¬¦æ˜¯æœ€å¿«çš„</li>
<li>æ‰‹å†™å®ç°ä¼šæœ‰è½»å¾®æ€§èƒ½å¼€é”€</li>
<li>åœ¨æ€§èƒ½å…³é”®è·¯å¾„ä¸Šä½¿ç”¨åŸç”Ÿæ“ä½œ</li>
</ul>
<ol start="2">
<li><strong>instanceofçš„æ€§èƒ½:</strong></li>
</ol>
<ul>
<li>åŸå‹é“¾è¶Šé•¿ï¼Œæ£€æµ‹è¶Šæ…¢</li>
<li>å¯¹äºé¢‘ç¹çš„ç±»å‹æ£€æµ‹ï¼Œå¯ä»¥è€ƒè™‘ç¼“å­˜ç»“æœ</li>
<li>ä½¿ç”¨<code>typeof</code>æ£€æµ‹åŸºæœ¬ç±»å‹æ›´å¿«</li>
</ul>
<ol start="3">
<li><strong>ä¼˜åŒ–å»ºè®®:</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼˜åŒ–é¢‘ç¹çš„ç±»å‹æ£€æµ‹</span>
<span class="hljs-keyword">const</span> isArray = <span class="hljs-title class_">Array</span>.<span class="hljs-property">isArray</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">processItems</span>(<span class="hljs-params">items</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isArray</span>(items)) {
        <span class="hljs-comment">// å¤„ç†æ•°ç»„</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-comment">// ä½¿ç”¨ for å¾ªç¯è€Œä¸æ˜¯ forEach</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-31">ç»“è¯­</h4>
<p>é€šè¿‡æ‰‹å†™<code>new</code>æ“ä½œç¬¦å’Œ<code>instanceof</code>æ“ä½œç¬¦ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†JavaScriptçš„å¯¹è±¡åˆ›å»ºæœºåˆ¶å’Œç±»å‹æ£€æµ‹åŸç†ã€‚è¿™äº›çŸ¥è¯†ä¸ä»…æ˜¯é¢è¯•ä¸­çš„å¸¸è§è€ƒç‚¹ï¼Œæ›´æ˜¯ç¼–å†™é«˜è´¨é‡JavaScriptä»£ç çš„åŸºç¡€ã€‚</p>
<p>è®°ä½ä»¥ä¸‹è¦ç‚¹:</p>
<ul>
<li>âœ… new æ“ä½œç¬¦åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šè®¾ç½®åŸå‹é“¾å¹¶æ‰§è¡Œæ„é€ å‡½æ•°</li>
<li>âœ… instanceof é€šè¿‡æ£€æŸ¥åŸå‹é“¾æ¥åˆ¤æ–­å¯¹è±¡ç±»å‹</li>
<li>âœ… åŸå‹é“¾æ˜¯ JavaScript ç»§æ‰¿çš„åŸºç¡€</li>
<li>âœ… ç†è§£è¿™äº›åŸç†æœ‰åŠ©äºé¿å…å¸¸è§çš„é™·é˜±å’Œé”™è¯¯</li>
</ul>
<p><strong>å»¶ä¼¸é˜…è¯»:</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Fnew" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new" ref="nofollow noopener noreferrer">MDN: new æ“ä½œç¬¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Finstanceof" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/instanceof" ref="nofollow noopener noreferrer">MDN: instanceof æ“ä½œç¬¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgetify%2FYou-Dont-Know-JS%2Fblob%2F1st-ed%2Fthis%252520%252526%252520object%252520prototypes%2Fch5.md" target="_blank" title="https://github.com/getify/You-Dont-Know-JS/blob/1st-ed/this%2520%2526%2520object%2520prototypes/ch5.md" ref="nofollow noopener noreferrer">JavaScript åŸå‹é“¾è¯¦è§£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FClasses" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes" ref="nofollow noopener noreferrer">ES6 Class ä¸åŸå‹ç»§æ‰¿</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JuiceFS + MinIOï¼šAriste AI é‡åŒ–æŠ•èµ„é«˜æ€§èƒ½å­˜å‚¨å®è·µ]]></title>    <link>https://juejin.cn/post/7581041679190753315</link>    <guid>https://juejin.cn/post/7581041679190753315</guid>    <pubDate>2025-12-08T09:38:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581041679190753315" data-draft-id="7581279471745826850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JuiceFS + MinIOï¼šAriste AI é‡åŒ–æŠ•èµ„é«˜æ€§èƒ½å­˜å‚¨å®è·µ"/> <meta itemprop="keywords" content="åç«¯,è¿ç»´"/> <meta itemprop="datePublished" content="2025-12-08T09:38:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JuiceFS"/> <meta itemprop="url" content="https://juejin.cn/user/2665636828032446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JuiceFS + MinIOï¼šAriste AI é‡åŒ–æŠ•èµ„é«˜æ€§èƒ½å­˜å‚¨å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2665636828032446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JuiceFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:38:26.000Z" title="Mon Dec 08 2025 09:38:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Ariste AI æ˜¯ä¸€å®¶ä¸“æ³¨äº AI é©±åŠ¨äº¤æ˜“çš„å…¬å¸ï¼Œä¸šåŠ¡æ¶µç›–è‡ªè¥äº¤æ˜“ã€èµ„äº§ç®¡ç†ã€é«˜é¢‘åšå¸‚ç­‰å¤šä¸ªé¢†åŸŸã€‚åœ¨é‡åŒ–äº¤æ˜“ç ”ç©¶ä¸­ï¼Œæ•°æ®çš„è¯»å–é€Ÿåº¦å’Œå­˜å‚¨æ•ˆç‡ï¼Œå¾€å¾€ç›´æ¥å†³å®šäº†ç ”ç©¶è¿­ä»£çš„é€Ÿåº¦ã€‚</p>
<p>Ariste AI å›¢é˜Ÿåœ¨æ„å»ºé‡åŒ–ç ”ç©¶åŸºç¡€è®¾æ–½çš„è¿‡ç¨‹ä¸­ï¼Œé¢å¯¹æ€»è§„æ¨¡è¶…è¿‡ 500TBï¼Œè¡Œæƒ…ä¸å› å­æ•°æ®ï¼Œç»å†äº†ä»æœ¬åœ°ç›˜åˆ°æœ€ç»ˆé€‰æ‹©åœ¨ MinIO å¯¹è±¡å­˜å‚¨ä¹‹ä¸Šå åŠ  JuiceFS æ–‡ä»¶ç³»ç»Ÿçš„å››ä¸ªé˜¶æ®µã€‚é€šè¿‡ç¼“å­˜æœºåˆ¶ä¸åˆ†å±‚æ¶æ„ï¼Œå›¢é˜Ÿå®ç°äº†é«˜é¢‘æ•°æ®çš„å¿«é€Ÿè®¿é—®ä¸é›†ä¸­ç®¡ç†ã€‚<strong>è¿™ä¸€å®è·µéªŒè¯äº†â€œç¼“å­˜åŠ é€Ÿã€å¼¹æ€§å¯¹è±¡å­˜å‚¨ä¸ POSIX å…¼å®¹â€ä¸‰ä½ä¸€ä½“æ–¹æ¡ˆåœ¨é‡åŒ–åœºæ™¯ä¸‹çš„å¯è¡Œæ€§</strong>ï¼Œå¸Œæœ›è¿™ä¸€ç»éªŒèƒ½ä¸ºåŒè¡Œæä¾›ä¸€äº›å‚è€ƒã€‚</p>
<h2 data-id="heading-0">01 é‡åŒ–æŠ•èµ„å­˜å‚¨æŒ‘æˆ˜ï¼šè§„æ¨¡ã€é€Ÿåº¦ä¸åä½œçš„å¹³è¡¡</h2>
<p>é‡åŒ–æŠ•èµ„æµç¨‹ä¾æ¬¡åŒ…æ‹¬æ•°æ®å±‚ã€å› å­ä¸ä¿¡å·å±‚ã€ç­–ç•¥ä¸ä»“ä½å±‚åŠæ‰§è¡Œä¸äº¤æ˜“å±‚ï¼Œæ„æˆä»æ•°æ®è·å–åˆ°äº¤æ˜“æ‰§è¡Œçš„å®Œæ•´é—­ç¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9766cde494b428596aa2620592817a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=TShcTqagLXbZd4iTWJBZpmncPMw%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå­˜å‚¨ç³»ç»Ÿé¢ä¸´å¤šé‡æŒ‘æˆ˜ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>æ•°æ®è§„æ¨¡ä¸å¢é€Ÿ</strong>ï¼šé‡åŒ–ç ”ç©¶æ‰€éœ€å¤„ç†çš„æ•°æ®æ€»é‡è¾ƒå¤§ï¼Œæ¶µç›–å†å²è¡Œæƒ…æ•°æ®ã€æ–°é—»æ•°æ®ä»¥åŠè‡ªè¡Œè®¡ç®—çš„å› å­æ•°æ®ç­‰ã€‚ç›®å‰ï¼Œè¿™äº›æ•°æ®çš„æ€»é‡å·²æ¥è¿‘ 500Tã€‚å¹¶ä¸”ï¼Œä¼ä¸šæ¯æ—¥æ–°å¢çš„è¡Œæƒ…æ•°æ®ä¹Ÿè¾¾æ•°ç™¾ GBã€‚è‹¥é‡‡ç”¨ä¼ ç»Ÿç£ç›˜è¿›è¡Œå­˜å‚¨ï¼Œæ˜¾ç„¶æ— æ³•æ»¡è¶³å¦‚æ­¤å·¨å¤§çš„æ•°æ®å­˜å‚¨éœ€æ±‚ã€‚</li>
<li><strong>é«˜é¢‘è®¿é—®ä¸ä½å»¶è¿Ÿè¦æ±‚</strong>ï¼šé«˜é¢‘çš„æ•°æ®è®¿é—®ä¾èµ–äºä½å»¶è¿Ÿçš„æ•°æ®è¯»å–ã€‚æ•°æ®è¯»å–çš„é€Ÿç‡ç›´æ¥å†³å®šäº†ç ”ç©¶æ•ˆç‡çš„é«˜ä½ã€‚è‹¥æ•°æ®è¯»å–é€Ÿåº¦è¾ƒå¿«ï¼Œç ”ç©¶è¿›ç¨‹ä¾¿èƒ½è¿…é€Ÿæ¨è¿›ï¼›åä¹‹ï¼Œåˆ™ä¼šå¯¼è‡´ç ”ç©¶æ•ˆç‡ä½ä¸‹ã€‚</li>
<li><strong>å¤šå›¢é˜Ÿå¹¶è¡Œä¸æ•°æ®æ²»ç†</strong>ï¼šåœ¨é‡åŒ–ç ”ç©¶è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ä¼šæœ‰å¤šä¸ªå›¢é˜ŸåŒæ—¶å¼€å±•ä¸åŒçš„å®éªŒã€‚ä¸ºç¡®ä¿å„å›¢é˜Ÿç ”ç©¶å·¥ä½œçš„ç‹¬ç«‹æ€§ä¸æ•°æ®å®‰å…¨æ€§ï¼Œéœ€è¦è¿›è¡Œå®‰å…¨çš„éš”ç¦»ï¼Œä»¥é¿å…æ•°æ®æ··æ·†ä¸æ³„éœ²ã€‚</li>
</ul>
<p>ä¸ºåº”å¯¹ä¸Šè¿°é‡åŒ–å…¨æµç¨‹å¯¹æ•°æ®å­˜å‚¨çš„éœ€æ±‚ï¼Œæ‰“é€ é¢å‘æœªæ¥çš„å­˜å‚¨ç³»ç»Ÿï¼Œ<strong>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç°ï¼šé«˜æ€§èƒ½ã€æ˜“æ‰©å±•ä¸å¯æ²»ç†ï¼Œä¸‰è€…æœ‰æœºç»Ÿä¸€</strong>ï¼š</p>
<ul>
<li>é«˜æ€§èƒ½ï¼šå•èŠ‚ç‚¹è¯»å†™å¸¦å®½çªç ´ 500MB/sï¼Œè®¿é—®å»¶è¿Ÿä½äºæœ¬åœ°ç£ç›˜æ„ŸçŸ¥é˜ˆå€¼ï¼›</li>
<li>æ˜“æ‰©å±•ï¼šæ”¯æŒå­˜å‚¨ä¸è®¡ç®—èµ„æºæŒ‰éœ€æ°´å¹³æ‰©å®¹ï¼Œä¸šåŠ¡æ— éœ€æ”¹é€ å³å¯å®ç°å¹³æ»‘å¼¹æ€§ä¼¸ç¼©ï¼›</li>
<li>å¯æ²»ç†ï¼šæä¾›ç»†ç²’åº¦æƒé™æ§åˆ¶ã€æ“ä½œå®¡è®¡ä¸æ•°æ®ç”Ÿå‘½å‘¨æœŸç­–ç•¥çš„ä¸€ç«™å¼ç®¡ç†èƒ½åŠ›ã€‚</li>
</ul>
<h2 data-id="heading-1">02 å­˜å‚¨æ¶æ„çš„æ¼”è¿›</h2>
<h3 data-id="heading-2">é˜¶æ®µä¸€ï¼šæœ¬åœ°ç›˜æé€Ÿèµ·æ­¥</h3>
<p>åœ¨é¡¹ç›®åˆæœŸï¼Œæˆ‘ä»¬é‡‡ç”¨äº† Quantrabyte ç ”ç©¶æ¡†æ¶ï¼Œè¯¥æ¡†æ¶å†…ç½®äº† ETF æ¨¡å—ï¼Œå¯ç›´æ¥å°†æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼Œæ•°æ®è¯»å–é€Ÿåº¦è¾ƒå¿«ã€‚ç ”ç©¶å‘˜å¯æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œç›´æ¥è¿è¡Œæ‰€éœ€æ•°æ®ï¼Œè¿­ä»£è¿‡ç¨‹è¾ƒä¸ºè¿…é€Ÿã€‚ç„¶è€Œï¼Œè¿™ä¸€é˜¶æ®µä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li>é‡å¤ä¸‹è½½é€ æˆèµ„æºæµªè´¹ï¼šå¤šä¸ªç ”ç©¶å‘˜è‹¥ä½¿ç”¨ç›¸åŒæ•°æ®ï¼Œä¼šè¿›è¡Œå¤šæ¬¡ä¸‹è½½ã€‚</li>
<li>å­˜å‚¨å®¹é‡ä¸è¶³ï¼šç ”ç©¶æœåŠ¡å™¨çš„å­˜å‚¨å®¹é‡æœ‰é™ï¼Œä»…çº¦ 15Tï¼Œéš¾ä»¥æ»¡è¶³æ—¥ç›Šå¢é•¿çš„æ•°æ®å­˜å‚¨éœ€æ±‚ã€‚</li>
<li>åä½œå›°éš¾ï¼šå½“éœ€è¦å¤ç”¨ä»–äººçš„ç ”ç©¶ç»“æœæ—¶ï¼Œæ“ä½œè¿‡ç¨‹ä¸å¤Ÿä¾¿æ·ã€‚</li>
</ul>
<h3 data-id="heading-3">é˜¶æ®µäºŒï¼šMinIO é›†ä¸­ç®¡ç†çš„åŒåˆƒå‰‘</h3>
<p>ä¸ºè§£å†³ç¬¬ä¸€é˜¶æ®µå­˜åœ¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº† MinIO è¿›è¡Œé›†ä¸­ç®¡ç†ã€‚å°†æ‰€æœ‰å­˜å‚¨æ•°æ®é›†ä¸­åœ¨ MinIO ä¸Šï¼Œé€šè¿‡æ‹†åˆ†å‡ºçš„æ¨¡å—å°†æ•°æ®å…¨éƒ¨å­˜å…¥ã€‚åŒæ—¶ï¼Œå°†å…·ä½“å› å­æ•°æ®ä¹Ÿå­˜å…¥ MinIOï¼Œå®ç°å…¬å…±æ•°æ®çš„ç»Ÿä¸€ä¸‹è½½ã€‚å¹¶é€šè¿‡æƒé™éš”ç¦»ï¼Œå®ç°å¤šå›¢é˜Ÿæ•°æ®å…±äº«ï¼Œæå‡å­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¸€é˜¶æ®µä¹Ÿå‡ºç°äº†æ–°çš„ç“¶é¢ˆï¼š</p>
<ul>
<li>é«˜é¢‘éšæœºè¯»å»¶è¿Ÿå¤§ï¼šåœ¨è¿›è¡Œé«˜é¢‘æ•°æ® I/O æ“ä½œæ—¶å»¶è¿Ÿè¾ƒå¤§ï¼Œå½±å“æ•°æ®è¯»å–é€Ÿåº¦ã€‚</li>
<li>æ— ç¼“å­˜å¯¼è‡´è¯»å†™æ…¢ï¼šç”±äº MinIO ç¤¾åŒºç‰ˆæ— ç¼“å­˜åŠŸèƒ½ï¼Œè¯»å†™é«˜é¢‘å…¬å…±æ•°æ®æ—¶é€Ÿåº¦è¾ƒæ…¢ã€‚</li>
</ul>
<h3 data-id="heading-4">é˜¶æ®µä¸‰ï¼šJuiceFS å¼•å…¥ç¼“å­˜åŠ é€Ÿ</h3>
<p>ä¸ºè§£å†³ä¸Šè¿°ç“¶é¢ˆï¼Œç»å……åˆ†è°ƒç ”ï¼Œæˆ‘ä»¬æœ€ç»ˆå¼•å…¥ JuiceFS çš„ç¼“å­˜åŠ é€Ÿæ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆé€šè¿‡å®¢æˆ·ç«¯æœ¬åœ° RAID5 å­˜å‚¨è¿›è¡ŒæŒ‚è½½ï¼Œå€ŸåŠ©é«˜æ•ˆçš„ç¼“å­˜æœºåˆ¶ï¼Œ<strong>æˆåŠŸå°†è¯»å†™æ€§èƒ½æå‡çº¦ä¸‰å€ï¼Œæ˜¾è‘—æ”¹å–„äº†é«˜é¢‘å…±äº«æ•°æ®çš„è®¿é—®ä½“éªŒ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13e0899c549a417ca221b6ee99269d62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=7kgwbZYF8ZzobKMcZH18m9JVGbw%3D" alt="" loading="lazy"/></p>
<p>éšç€ä¸šåŠ¡æ•°æ®é‡çªç ´ 300TBï¼Œæœ¬åœ°å­˜å‚¨çš„æ‰©å®¹ç“¶é¢ˆé€æ¸æ˜¾ç°ã€‚ç”±äºæ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œæ‰©å®¹éœ€é‡æ–°é…ç½®å­˜å‚¨è®¾å¤‡ï¼Œè€Œ RAID5 æ¶æ„ä¸‹æ‰©å®¹é€Ÿåº¦ç¼“æ…¢ä¸”é£é™©è¾ƒé«˜ï¼Œéš¾ä»¥æ»¡è¶³ä¸šåŠ¡æŒç»­å¢é•¿çš„éœ€æ±‚ã€‚</p>
<h3 data-id="heading-5">é˜¶æ®µå››ï¼šJuiceFS + MinIO é›†ç¾¤ç»ˆå±€æ¶æ„</h3>
<p>ä¸ºè§£å†³æ‰©å®¹éš¾é¢˜ï¼Œæˆ‘ä»¬æœ€ç»ˆé‡‡ç”¨äº†JuiceFS+MinIO é›†ç¾¤æ¶æ„ã€‚è¯¥æ–¹æ¡ˆå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li>æŒç»­é«˜æ€§èƒ½ï¼šJuiceFS æä¾›å……è¶³çš„ç¼“å­˜èƒ½åŠ›ï¼Œå……åˆ†æ»¡è¶³é«˜é¢‘æ•°æ®è®¿é—®åœºæ™¯çš„æ€§èƒ½éœ€æ±‚ï¼›</li>
<li>ä¾¿æ·é›†ç¾¤æ‰©å±•ï¼šåŸºäºé›†ç¾¤åŒ–æ–¹æ¡ˆï¼Œå¯å¿«é€Ÿå®ç°æ¨ªå‘æ‰©å®¹ï¼Œä»…éœ€æ·»åŠ åŒç±»å‹ç£ç›˜å³å¯çµæ´»æå‡å­˜å‚¨å®¹é‡ï¼Œå¤§å¹…å¢å¼ºç³»ç»Ÿæ‰©å±•æ€§ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65805ffd8db9418db4459baa08c599c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=c9is2ftDHq34Y%2BAuPREbNMvB%2FCg%3D" alt="" loading="lazy"/></p>
<p><strong>é€šè¿‡å››é˜¶æ®µæ¼”è¿›ï¼Œæˆ‘ä»¬éªŒè¯äº†ç¼“å­˜åŠ é€Ÿã€å¼¹æ€§å¯¹è±¡å­˜å‚¨ä¸ POSIX å…¼å®¹ä¸‰ä½ä¸€ä½“æ–¹æ¡ˆåœ¨é‡åŒ–åœºæ™¯çš„å¯è¡Œæ€§</strong>ã€‚æ­¤æ–¹æ¡ˆå¯ä¸ºåŒè¡Œä¸šæä¾›å¯å¤åˆ¶ã€å¯è½åœ°çš„æœ€ä½³å®è·µèŒƒæœ¬ï¼Œåœ¨æ€§èƒ½ã€æˆæœ¬ä¸æ²»ç†ä¹‹é—´å–å¾—äº†å“è¶Šå¹³è¡¡ã€‚</p>
<h2 data-id="heading-6">03 æ€§èƒ½ä¸æˆæœ¬æ”¶ç›Š</h2>
<p>é€šè¿‡é‡‡ç”¨ JuiceFS ä¸ MinIOç›¸ ç»“åˆçš„å­˜å‚¨æ¶æ„ï¼Œç³»ç»Ÿå¸¦å®½ä¸èµ„æºåˆ©ç”¨æ•ˆç‡å¾—åˆ°è´¨çš„é£è·ƒï¼Œç›®å‰å·²å®Œå…¨æ»¡è¶³ç ”ç©¶ä¸šåŠ¡å¯¹å­˜å‚¨æ€§èƒ½çš„éœ€æ±‚ã€‚å¼•å…¥ JuiceFS ç¼“å­˜å±‚åï¼Œ<strong>å›æµ‹ä»»åŠ¡æ‰§è¡Œæ•ˆç‡å¤§å¹…æé«˜ï¼Œ1 äº¿æ¡ Tick æ•°æ®å›æµ‹è€—æ—¶ç”±ä¹‹å‰çš„æ•°å°æ—¶é™è‡³æ•°ååˆ†é’Ÿ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/806ffdaa142543e18b01f00412955e07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=kzcFFuF6w7dcWTbwzOtLsl7fkR0%3D" alt="" loading="lazy"/></p>
<p>åŒæ—¶ï¼ŒåŸºäºæˆ‘ä»¬å®Œæ•´çš„æ•°æ®ç”Ÿå‘½å‘¨æœŸåˆ†å±‚å­˜å‚¨ä½“ç³»ç­–ç•¥ï¼Œå®ç°å­˜å‚¨å•ä»·ç”±é«˜åˆ°ä½çš„å¹³æ»‘è¿‡æ¸¡ï¼Œæ•´ä½“å­˜å‚¨æˆæœ¬ä¸‹é™40% ä»¥ä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5592715e44c94eadb18e7b2824695f12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=fhx6hZI5XI6Xt151FznhirId7eM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">04 è¿ç»´å®è·µä¸å±•æœ›</h2>
<h3 data-id="heading-8">å¤šç§Ÿæˆ·æ²»ç†</h3>
<p>åœ¨æ•°æ®éš”ç¦»ä¸æƒé™ç®¡ç†æ–¹é¢ï¼Œæˆ‘ä»¬å»ºç«‹äº†å®Œå–„çš„ç®¡ç†ä½“ç³»ï¼š</p>
<p>é€šè¿‡å‘½åç©ºé—´å®ç°é€»è¾‘éš”ç¦»ï¼Œé‡‡ç”¨ç±»ä¼¼ <code>/factor/A</code>ã€<code>/factor/B</code> çš„è·¯å¾„è§„åˆ’ï¼Œç¡®ä¿å„ä¸šåŠ¡æ•°æ®è¾¹ç•Œæ¸…æ™°ã€‚åœ¨æƒé™æ§åˆ¶å±‚é¢ï¼Œæ”¯æŒç”¨æˆ·ã€å›¢é˜Ÿã€é¡¹ç›®ä¸‰ä¸ªç»´åº¦çš„ç²¾ç»†åŒ–ç®¡ç†ï¼Œå¹¶ä¸ POSIX ACL æƒé™ä½“ç³»æ— ç¼å¯¹æ¥ã€‚åŒæ—¶å»ºç«‹å®Œæ•´çš„å®¡è®¡æ—¥å¿—ç³»ç»Ÿï¼Œå®ç°è®¿é—®è¡Œä¸ºçš„å®æ—¶è¿½è¸ªä¸å˜æ›´å†å²å›æº¯ï¼Œå…¨é¢æ»¡è¶³åˆè§„æ€§è¦æ±‚ã€‚</p>
<h3 data-id="heading-9">å¯è§‚æµ‹æ€§ä¸è‡ªåŠ¨åŒ–è¿ç»´</h3>
<p><strong>æˆ‘ä»¬å›´ç»•å››å¤§æ ¸å¿ƒæŒ‡æ ‡æ„å»ºäº†å®Œæ•´çš„ç›‘æ§ä½“ç³»ï¼šç¼“å­˜å‘½ä¸­ç‡ã€I/O ååé‡ã€I/O å»¶è¿Ÿä¸å†™å…¥é‡è¯•ç‡ï¼Œç³»ç»Ÿåœ¨æŒ‡æ ‡å¼‚å¸¸æ—¶å¯è‡ªåŠ¨è§¦å‘å‘Šè­¦</strong>ã€‚</p>
<p>åŸºäº Grafana å®ç°äº†è¿ç»´é—­ç¯ç®¡ç†ï¼ŒæŒç»­ç›‘æ§èŠ‚ç‚¹å¥åº·çŠ¶æ€ä¸å­˜å‚¨å®¹é‡ã€‚åœ¨æ¯æ¬¡æ‰©å®¹å‰ï¼Œä¼šé€šè¿‡æ¨¡æ‹Ÿå‹æµ‹éªŒè¯ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›ï¼Œç¡®ä¿ä¸šåŠ¡æ— æ„ŸçŸ¥ã€‚æ•´ä½“è¿ç»´ä½“ç³»å®ç°äº†è‡ªåŠ¨åŒ–ã€å¯é¢„æµ‹ã€å¯å›æ»šçš„é«˜æ ‡å‡†è¿ç»´ç›®æ ‡ã€‚</p>
<h3 data-id="heading-10">å›æµ‹ç³»ç»Ÿä¸­çš„æ•°æ®æ›´æ–°è®¾è®¡</h3>
<p>æˆ‘ä»¬åœ¨å›æµ‹ç³»ç»Ÿè®¾è®¡ä¸­é‡‡ç”¨åŸºäº DAGï¼ˆDirected Acyclic Graphï¼Œæœ‰å‘æ— ç¯å›¾ï¼‰çš„æ¶æ„ï¼Œä»¥æå‡ç³»ç»Ÿçš„è®¡ç®—æ•ˆç‡ä¸å¯ç»´æŠ¤æ€§ã€‚<strong>è¯¥æ¡†æ¶ä»¥è®¡ç®—èŠ‚ç‚¹å’Œä¾èµ–å…³ç³»ä¸ºæ ¸å¿ƒï¼Œå°†æ•°æ®å¤„ç†ã€ç‰¹å¾è®¡ç®—ã€ä¿¡å·ç”Ÿæˆç­‰ç¯èŠ‚æŠ½è±¡ä¸ºèŠ‚ç‚¹ï¼Œå¹¶é€šè¿‡ä¾èµ–å›¾ç»Ÿä¸€ç®¡ç†</strong>ã€‚ç³»ç»Ÿå†…ç½®ç‰ˆæœ¬æ§åˆ¶æœºåˆ¶ï¼Œå½“æ•°æ®ç‰ˆæœ¬æ›´æ–°æ—¶ï¼Œå¯ä¾æ‰˜ä¾èµ–å›¾è‡ªåŠ¨è¯†åˆ«å—å½±å“çš„èŠ‚ç‚¹ï¼Œç²¾ç¡®å®šä½éœ€é‡ç®—éƒ¨åˆ†ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„å¢é‡æ›´æ–°ä¸ç»“æœè¿½æº¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19116a3229954b53a3588d69f9d01090~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765791506&amp;x-signature=X%2FRuoWwZTit9SA7gUItiC131pUA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-11">æœªæ¥å±•æœ›</h2>
<p>åœ¨æœªæ¥è§„åˆ’ä¸­ï¼Œæˆ‘ä»¬å°†ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹å‘æŒç»­ä¼˜åŒ–å­˜å‚¨æ¶æ„ï¼š</p>
<ol>
<li>å…ƒæ•°æ®é«˜å¯ç”¨å‡çº§ï¼šè®¡åˆ’å°†å…ƒæ•°æ®å­˜å‚¨ä» Redis è¿ç§»è‡³ TiKV æˆ– PostgreSQLï¼Œä»¥æ„å»ºè·¨æœºæˆ¿é«˜å¯ç”¨æ¶æ„ï¼Œæ˜¾è‘—æå‡ç³»ç»Ÿå®¹ç¾ä¸å¿«é€Ÿæ¢å¤èƒ½åŠ›ã€‚</li>
<li>æ··åˆäº‘åˆ†å±‚å­˜å‚¨ï¼šé€šè¿‡å¯¹æ¥å…¬æœ‰äº‘ S3 ä¸ Glacier å­˜å‚¨æœåŠ¡ï¼Œæ„å»ºæ™ºèƒ½å†·çƒ­åˆ†å±‚ä½“ç³»ï¼Œåœ¨å®ç°å­˜å‚¨å®¹é‡æ— é™å¼¹æ€§çš„åŒæ—¶ï¼Œè¾¾æˆæˆæœ¬æœ€ä¼˜åŒ–ç›®æ ‡ã€‚</li>
<li>ç ”ç©¶æ•°æ®æ¹–ç»Ÿä¸€æ²»ç†ï¼šè®¡åˆ’æ„å»ºç»Ÿä¸€çš„ç ”ç©¶æ•°æ®æ¹–å¹³å°ï¼Œé›†æˆ Schema æ³¨å†Œã€è‡ªåŠ¨æ•°æ®æ¸…æ´—ä¸ç»Ÿä¸€ç›®å½•æ²»ç†ç­‰æ ¸å¿ƒæœåŠ¡ï¼Œå…¨é¢æå‡æ•°æ®èµ„äº§çš„å‘ç°ä¸ç®¡ç†æ•ˆç‡ã€‚</li>
</ol>
<p>æˆ‘ä»¬å¸Œæœ›æœ¬æ–‡ä¸­çš„ä¸€äº›å®è·µç»éªŒï¼Œèƒ½ä¸ºæ­£åœ¨é¢ä¸´ç±»ä¼¼é—®é¢˜çš„å¼€å‘è€…æä¾›å‚è€ƒï¼Œå¦‚æœæœ‰å…¶ä»–ç–‘é—®æ¬¢è¿åŠ å…¥Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fjuicefs.com%2Fzh-cn%2F" target="_blank" title="https://juicefs.com/zh-cn/" ref="nofollow noopener noreferrer">JuiceFS ç¤¾åŒº</a>ä¸å¤§å®¶å…±åŒäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆspringbootä¾èµ–ä¸å†™ç‰ˆæœ¬å·ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7581041679190687779</link>    <guid>https://juejin.cn/post/7581041679190687779</guid>    <pubDate>2025-12-08T09:19:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581041679190687779" data-draft-id="7581292270960869386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆspringbootä¾èµ–ä¸å†™ç‰ˆæœ¬å·ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T09:19:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯å¤©é¾™_ç»"/> <meta itemprop="url" content="https://juejin.cn/user/1831109918994644"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆspringbootä¾èµ–ä¸å†™ç‰ˆæœ¬å·ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1831109918994644/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯å¤©é¾™_ç»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:19:35.000Z" title="Mon Dec 08 2025 09:19:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>æœ‰æ—¶å€™æˆ‘ä»¬çœ‹åˆ°<code>SpringBoot</code>é¡¹ç›®çš„ä¾èµ–ä¸å†™ç‰ˆæœ¬å·ï¼Œä¸ºä»€ä¹ˆè¿™æ ·å‘¢ï¼Ÿè¿™æ ·å¯ä»¥å—ï¼Ÿä¸ºä»€ä¹ˆä¸æŠ¥é”™ï¼Ÿ</p>
<p>ä¹Ÿå°±æ˜¯è¯´ä¸ºä»€ä¹ˆåœ¨æœ‰çš„springé¡¹ç›®ä¸­çš„mavené…ç½®ä¸­ï¼Œå†™ä¾èµ–<code>&lt;dependencies&gt;</code>æ—¶ï¼Œæœ‰çš„ä¸ç”¨å†™ç‰ˆæœ¬å·<code>&lt;version&gt;</code></p>
<p>ä¸ºä»€ä¹ˆåœ¨æœ‰çš„springé¡¹ç›®ä¸­çš„mavené…ç½®ä¸­ï¼Œå†™ä¾èµ–æ—¶ï¼Œæœ‰çš„ä¸ç”¨å†™ç‰ˆæœ¬å·</p>
<p>ä¸€ã€ç¬¬ä¸€ç§æƒ…å†µï¼š</p>
<pre><code class="hljs language-java" lang="java">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<p>å¦‚åŒä»¥ä¸Š</p>
<p>ä¸€èˆ¬å‡ºç°è¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºã€‚</p>
<ol>
<li>ç»§æ‰¿äº†spring-bootçš„é…ç½®,è¿™é‡Œå¼•å…¥spring-boot-starter-parentçš„å¥½å¤„æ˜¯åœ¨æ·»åŠ å¯åŠ¨å™¨æ—¶ä¸ç”¨ç”³æ˜ç‰ˆæœ¬å·ï¼</li>
</ol>
<pre><code class="hljs language-java" lang="java">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">1.3</span><span class="hljs-number">.3</span>.RELEASE&lt;/version&gt;
&lt;/parent&gt;
</code></pre>
<p><strong>å› ä¸ºæ·»åŠ äº†æ ‡ç­¾</strong></p>
<p>spring-boot-starter-parenthä¼šä¸ºæˆ‘ä»¬æä¾›å¸¸ç”¨jaråŒ…ç‰ˆæœ¬ï¼Œå…¶å®ä¸æ˜¯ä¸ç”¨æŒ‡å®šï¼Œæ˜¯äººå®¶ä¸ºæˆ‘ä»¬æŒ‡å®šå¥½äº†ã€‚</p>
<p>è‡ªå·±æŒ‡å®šç‰ˆæœ¬å·ä¹Ÿå¯ä»¥ï¼Œä¼šè¦†ç›–å®˜æ–¹ç‰ˆæœ¬ï¼Œè¿™æ—¶å¯ä»¥ç”¨mavenÂ helperæŸ¥çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰å†²çªå³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•å®ç°ä¸€ä¸ªMCPæœåŠ¡å™¨]]></title>    <link>https://juejin.cn/post/7581306080434110515</link>    <guid>https://juejin.cn/post/7581306080434110515</guid>    <pubDate>2025-12-08T09:11:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581306080434110515" data-draft-id="7581297888807944242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•å®ç°ä¸€ä¸ªMCPæœåŠ¡å™¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T09:11:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¬¦æ–¹æ˜Š"/> <meta itemprop="url" content="https://juejin.cn/user/2005988778191245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•å®ç°ä¸€ä¸ªMCPæœåŠ¡å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2005988778191245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¬¦æ–¹æ˜Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:11:15.000Z" title="Mon Dec 08 2025 09:11:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ index.ts             <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ server.ts            <span class="hljs-comment"># æœåŠ¡å™¨å¯åŠ¨é€»è¾‘</span>
â”œâ”€â”€ common/              <span class="hljs-comment"># å…¬å…±æ¨¡å—</span>
â”‚   â””â”€â”€ index.ts         <span class="hljs-comment"># é…ç½®å’Œå·¥å…·å‡½æ•°</span>
â”œâ”€â”€ tools/               <span class="hljs-comment"># MCPå·¥å…·å®ç°</span>
â”‚   â”œâ”€â”€ index.ts         <span class="hljs-comment"># å·¥å…·æ³¨å†Œ</span>
â”‚   â””â”€â”€ manage/          <span class="hljs-comment"># ä¸šåŠ¡åŠŸèƒ½</span>
â”‚       â”œâ”€â”€ upload-rule.ts
â”‚       â””â”€â”€ download.ts
â””â”€â”€ utils/               <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
    â”œâ”€â”€ common.ts
    â”œâ”€â”€ uploadCommon.ts
    â””â”€â”€ workspaceScanner.ts
</code></pre>
<h2 data-id="heading-1">æ ¸å¿ƒä¾èµ–</h2>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"@modelcontextprotocol/sdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.10.2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"axios"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.10.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"form-data"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.0.4"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-2">1. é¡¹ç›®åˆå§‹åŒ–</h2>
<h3 data-id="heading-3">package.jsoné…ç½®</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"@company/mcp-server-demo"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/index.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"mcp-server-demo"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/index.js"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-4">tsconfig.jsoné…ç½®</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esnext"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esnext"</span><span class="hljs-punctuation">,</span> 
    <span class="hljs-attr">"moduleResolution"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"outDir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"esModuleInterop"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-5">2. å…¥å£æ–‡ä»¶å®ç°</h2>
<h3 data-id="heading-6">src/index.ts</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> { startServer } <span class="hljs-keyword">from</span> <span class="hljs-string">"./server.js"</span>;
<span class="hljs-keyword">import</span> { registerBusinessTool } <span class="hljs-keyword">from</span> <span class="hljs-string">"./tools/index.js"</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>({
        <span class="hljs-attr">name</span>: packageInfo.<span class="hljs-property">name</span>,
        <span class="hljs-attr">version</span>: packageInfo.<span class="hljs-property">version</span>,
    }, {
        <span class="hljs-attr">capabilities</span>: {
            <span class="hljs-attr">tools</span>: {
                <span class="hljs-attr">listChanged</span>: <span class="hljs-literal">true</span>,
            },
        },
    });

    <span class="hljs-comment">// æ³¨å†Œå·¥å…·</span>
    <span class="hljs-title function_">registerBusinessTool</span>(server);
    
    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">startServer</span>(server);
}

<span class="hljs-title function_">main</span>();
</code></pre>
<h2 data-id="heading-7">3. æœåŠ¡å™¨å¯åŠ¨é€»è¾‘</h2>
<h3 data-id="heading-8">src/server.ts</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">StdioServerTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/stdio.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startStdioMode</span>(<span class="hljs-params">server: Server</span>) {
    <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioServerTransport</span>();
    <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startServer</span>(<span class="hljs-params">server: Server</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">startStdioMode</span>(server);
    } <span class="hljs-keyword">catch</span> (error) {
        process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
    }
}
</code></pre>
<h2 data-id="heading-9">4. å·¥å…·æ³¨å†Œä¸å®ç°</h2>
<h3 data-id="heading-10">src/tools/index.ts</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-title class_">ListToolsRequestSchema</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/types.js"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">registerBusinessTool</span>(<span class="hljs-params">server: Server</span>) {
    <span class="hljs-comment">// æ³¨å†Œå·¥å…·åˆ—è¡¨</span>
    server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">ListToolsRequestSchema</span>, <span class="hljs-keyword">async</span> () =&gt; ({
        <span class="hljs-attr">tools</span>: [
            <span class="hljs-variable constant_">UPLOAD_RULE_TOOL</span>,
            <span class="hljs-variable constant_">DOWNLOAD_PROJECT_RULES_TOOL</span>,
        ],
    }));

    <span class="hljs-comment">// æ³¨å†Œå·¥å…·è°ƒç”¨å¤„ç†å™¨</span>
    server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">request</span>: <span class="hljs-built_in">any</span>) =&gt; {
        <span class="hljs-keyword">switch</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span>) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"upload_rule"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleUploadRule</span>(request);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"get_download_rules"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleDownloadRules</span>(request);
            <span class="hljs-attr">default</span>:
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`Unknown tool: <span class="hljs-subst">${request.params.name}</span>`</span> }],
                    <span class="hljs-attr">isError</span>: <span class="hljs-literal">true</span>
                };
        }
    });
}
</code></pre>
<h2 data-id="heading-11">5. å·¥å…·å®šä¹‰</h2>
<h3 data-id="heading-12">ä¸Šä¼ å·¥å…·å®šä¹‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">UPLOAD_RULE_TOOL</span> = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'upload'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'ä¸Šä¼ æ–‡ä»¶'</span>,
    <span class="hljs-attr">inputSchema</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,
        <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">filePaths</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">'array'</span>,
                <span class="hljs-attr">items</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> },
                <span class="hljs-attr">description</span>: <span class="hljs-string">'è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨(å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„)'</span>
            },
            <span class="hljs-attr">teamSelection</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">'å›¢é˜Ÿé€‰æ‹©ï¼Œå¦‚ï¼šfrontendã€backendã€testingç­‰'</span>
            },
            <span class="hljs-attr">ruleTypeName</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
                <span class="hljs-attr">enum</span>: [<span class="hljs-string">'requirement_rules'</span>, <span class="hljs-string">'project_rules'</span>, <span class="hljs-string">'common_rules'</span>],
                <span class="hljs-attr">description</span>: <span class="hljs-string">'è§„åˆ™ç±»å‹'</span>
            },
        },
        <span class="hljs-attr">required</span>: [<span class="hljs-string">'filePaths'</span>, <span class="hljs-string">'teamSelection'</span>, <span class="hljs-string">'ruleTypeName'</span>]
    }
};
</code></pre>
<h3 data-id="heading-13">ä¸‹è½½å·¥å…·å®šä¹‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOWNLOAD_PROJECT_RULES_TOOL</span> = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"get_download_rules"</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'ä¸‹è½½æ–‡ä»¶'</span>,
    <span class="hljs-attr">inputSchema</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">projectNameList</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">"array"</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">"é¡¹ç›®åé›†åˆ"</span>,
                <span class="hljs-attr">items</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> }
            },
            <span class="hljs-attr">workspaceProjectList</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">"array"</span>, 
                <span class="hljs-attr">description</span>: <span class="hljs-string">"å·¥ä½œåŒºé¡¹ç›®åé›†åˆ"</span>,
                <span class="hljs-attr">items</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> }
            }
        },
        <span class="hljs-attr">required</span>: [<span class="hljs-string">"projectNameList"</span>, <span class="hljs-string">"workspaceProjectList"</span>]
    },
};
</code></pre>
<h2 data-id="heading-14">6. ä¸šåŠ¡é€»è¾‘å®ç°</h2>
<h3 data-id="heading-15">ä¸Šä¼ åŠŸèƒ½æ ¸å¿ƒä»£ç </h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleUploadRule</span>(<span class="hljs-params">request: <span class="hljs-built_in">any</span>, filePaths: <span class="hljs-built_in">string</span>[], teamSelection: <span class="hljs-built_in">string</span>, ruleTypeName: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 1. éªŒè¯æ–‡ä»¶è·¯å¾„</span>
        <span class="hljs-keyword">const</span> invalidPaths = filePaths.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">path</span> =&gt;</span> !<span class="hljs-title function_">isAbsolute</span>(path));
        <span class="hljs-keyword">if</span> (invalidPaths.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">createErrorResponse</span>(<span class="hljs-string">"æ–‡ä»¶è·¯å¾„ä¸æ˜¯ç»å¯¹è·¯å¾„"</span>, invalidPaths.<span class="hljs-title function_">join</span>(<span class="hljs-string">', '</span>));
        }

        <span class="hljs-comment">// 2. è¯»å–æ–‡ä»¶å†…å®¹</span>
        <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> filePath <span class="hljs-keyword">of</span> filePaths) {
            <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(filePath, <span class="hljs-string">'utf-8'</span>);
            <span class="hljs-keyword">const</span> fileName = <span class="hljs-title function_">basename</span>(filePath);
            formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'file'</span>, <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(content), {
                <span class="hljs-attr">filename</span>: fileName,
                <span class="hljs-attr">contentType</span>: <span class="hljs-title function_">getMimeType</span>(<span class="hljs-title function_">extname</span>(filePath))
            });
        }

        <span class="hljs-comment">// 3. æ·»åŠ å…¶ä»–å‚æ•°</span>
        formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'team'</span>, teamId);
        formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'ruleTypeId'</span>, ruleTypeId);
        formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'creator'</span>, <span class="hljs-title function_">getCurrentUserEmail</span>());

        <span class="hljs-comment">// 4. å‘é€è¯·æ±‚</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`<span class="hljs-subst">${baseUrl}</span>/api/rules/upload`</span>, formData, {
            <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'multipart/form-data'</span> },
            <span class="hljs-attr">timeout</span>: <span class="hljs-number">30000</span>
        });

        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"ä¸Šä¼ æˆåŠŸï¼"</span> }],
            <span class="hljs-attr">isError</span>: <span class="hljs-literal">false</span>
        };
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createErrorResponse</span>(<span class="hljs-string">"ä¸Šä¼ å¤±è´¥"</span>, error.<span class="hljs-property">message</span>);
    }
}
</code></pre>
<h3 data-id="heading-16">ä¸‹è½½åŠŸèƒ½æ ¸å¿ƒä»£ç </h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleDownloadRules</span>(<span class="hljs-params">request: <span class="hljs-built_in">any</span>, projectNameList: <span class="hljs-built_in">string</span>[], workspaceProjectList: <span class="hljs-built_in">string</span>[]</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 1. æ„å»ºè¯·æ±‚å‚æ•°</span>
        <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>();
        projectNameList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> params.<span class="hljs-title function_">append</span>(<span class="hljs-string">'projectNameList'</span>, name));

        <span class="hljs-comment">// 2. å‘èµ·ä¸‹è½½è¯·æ±‚</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`<span class="hljs-subst">${baseUrl}</span>/api/rules/download?<span class="hljs-subst">${params}</span>`</span>);
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();

        <span class="hljs-comment">// 3. ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ°</span>
        <span class="hljs-keyword">const</span> <span class="hljs-attr">savedFiles</span>: <span class="hljs-built_in">string</span>[] = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> fileInfo <span class="hljs-keyword">of</span> data.<span class="hljs-property">files</span>) {
            <span class="hljs-keyword">const</span> targetPath = <span class="hljs-keyword">await</span> <span class="hljs-title function_">determineFilePath</span>(fileInfo.<span class="hljs-property">filePath</span>, projectNameList);
            <span class="hljs-keyword">await</span> <span class="hljs-title function_">ensureDirectoryExists</span>(<span class="hljs-title function_">dirname</span>(targetPath));
            <span class="hljs-keyword">await</span> <span class="hljs-title function_">writeFile</span>(targetPath, fileInfo.<span class="hljs-property">content</span>, <span class="hljs-string">'utf-8'</span>);
            savedFiles.<span class="hljs-title function_">push</span>(targetPath);
        }

        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">content</span>: [{
                <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>,
                <span class="hljs-attr">text</span>: <span class="hljs-string">`ä¸‹è½½å®Œæˆï¼ä¿å­˜äº† <span class="hljs-subst">${savedFiles.length}</span> ä¸ªæ–‡ä»¶`</span>
            }],
            <span class="hljs-attr">isError</span>: <span class="hljs-literal">false</span>
        };
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createErrorResponse</span>(<span class="hljs-string">"ä¸‹è½½å¤±è´¥"</span>, error.<span class="hljs-property">message</span>);
    }
}
</code></pre>
<h2 data-id="heading-17">7. å·¥å…·å‡½æ•°</h2>
<h3 data-id="heading-18">é”™è¯¯å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createErrorResponse</span>(<span class="hljs-params">title: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">content</span>: [{
            <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>,
            <span class="hljs-attr">text</span>: <span class="hljs-string">`âŒ **<span class="hljs-subst">${title}</span>**\n\n<span class="hljs-subst">${message}</span>`</span>
        }],
        <span class="hljs-attr">isError</span>: <span class="hljs-literal">true</span>
    };
}
</code></pre>
<h3 data-id="heading-19">æ–‡ä»¶è·¯å¾„å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">determineFilePath</span>(<span class="hljs-params">remotePath: <span class="hljs-built_in">string</span>, projectList: <span class="hljs-built_in">string</span>[]</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">const</span> hasCursorRules = remotePath.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'.cursor/rules'</span>);
    
    <span class="hljs-keyword">if</span> (hasCursorRules) {
        <span class="hljs-comment">// ä¿å­˜åˆ° .cursor/rules ç›®å½•</span>
        <span class="hljs-keyword">const</span> projectName = <span class="hljs-title function_">extractProjectName</span>(remotePath);
        <span class="hljs-keyword">const</span> projectPath = <span class="hljs-keyword">await</span> <span class="hljs-title function_">findProjectPath</span>(projectName, projectList);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">join</span>(projectPath, <span class="hljs-string">'.cursor'</span>, <span class="hljs-string">'rules'</span>, <span class="hljs-title function_">getRelativePath</span>(remotePath));
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ä¿å­˜åˆ° ProjectRules ç›®å½•</span>
        <span class="hljs-keyword">const</span> parentDir = <span class="hljs-title function_">dirname</span>(process.<span class="hljs-title function_">cwd</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">join</span>(parentDir, <span class="hljs-string">'ProjectRules'</span>, remotePath);
    }
}
</code></pre>
<h2 data-id="heading-20">8. æ„å»ºå’Œéƒ¨ç½²</h2>
<h3 data-id="heading-21">æ„å»ºè„šæœ¬</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc &amp;&amp; chmod 755 dist/index.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"NODE_OPTIONS=\"--loader ts-node/esm\" node src/index.ts"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node dist/index.js"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-22">postbuildå¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// scripts/postbuild.mjs</span>
<span class="hljs-keyword">import</span> { readFileSync, writeFileSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>;

<span class="hljs-comment">// æ·»åŠ shebangåˆ°å…¥å£æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> indexPath = <span class="hljs-string">'./dist/index.js'</span>;
<span class="hljs-keyword">let</span> content = <span class="hljs-title function_">readFileSync</span>(indexPath, <span class="hljs-string">'utf8'</span>);
<span class="hljs-keyword">if</span> (!content.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#!/usr/bin/env node'</span>)) {
    content = <span class="hljs-string">'#!/usr/bin/env node\n'</span> + content;
    <span class="hljs-title function_">writeFileSync</span>(indexPath, content);
}
</code></pre>
<h2 data-id="heading-23">9. å…³é”®å®ç°è¦ç‚¹</h2>
<h3 data-id="heading-24">MCPé€šä¿¡åè®®</h3>
<ul>
<li>ä½¿ç”¨stdioæ¨¡å¼è¿›è¡Œæ ‡å‡†è¾“å…¥è¾“å‡ºé€šä¿¡</li>
<li>æ”¯æŒå·¥å…·åˆ—è¡¨æŸ¥è¯¢å’Œå·¥å…·è°ƒç”¨</li>
<li>è¿”å›æ ‡å‡†åŒ–çš„å“åº”æ ¼å¼</li>
</ul>
<h3 data-id="heading-25">æ–‡ä»¶å¤„ç†ç­–ç•¥</h3>
<ul>
<li>æ”¯æŒå¤šæ–‡ä»¶æ‰¹é‡æ“ä½œ</li>
<li>æ™ºèƒ½è¯†åˆ«é¡¹ç›®ç»“æ„</li>
<li>è‡ªåŠ¨åˆ›å»ºç›®å½•ç»“æ„</li>
</ul>
<h3 data-id="heading-26">é”™è¯¯å¤„ç†æœºåˆ¶</h3>
<ul>
<li>ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼</li>
<li>è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯æç¤º</li>
<li>ä¼˜é›…çš„å¼‚å¸¸å¤„ç†</li>
</ul>
<h3 data-id="heading-27">å·¥ä½œåŒºé›†æˆ</h3>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹å·¥ä½œåŒºé¡¹ç›®</li>
<li>æ”¯æŒå•é¡¹ç›®å’Œå¤šé¡¹ç›®æ¨¡å¼</li>
<li>æ™ºèƒ½æ–‡ä»¶è·¯å¾„è§£æ</li>
</ul>
<h2 data-id="heading-28">10. æµ‹è¯•å’Œè°ƒè¯•</h2>
<h3 data-id="heading-29">æœ¬åœ°æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘æ¨¡å¼</span>
npm run dev

<span class="hljs-comment"># æ„å»ºæµ‹è¯•</span>
npm run build
npm start
</code></pre>
<h3 data-id="heading-30">MCPå®¢æˆ·ç«¯é›†æˆæµ‹è¯•</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"rule-server"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"/path/to/dist/index.js"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå³å¯å®Œæˆä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„MCPæœåŠ¡å™¨å®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼šé«˜æ•ˆæ‰¹é‡åŒ–è·å–æ·˜å®å…³é”®è¯æœç´¢ç»“æœçš„å®è·µ]]></title>    <link>https://juejin.cn/post/7581292270960951306</link>    <guid>https://juejin.cn/post/7581292270960951306</guid>    <pubDate>2025-12-08T09:30:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581292270960951306" data-draft-id="7581297888808009778" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼šé«˜æ•ˆæ‰¹é‡åŒ–è·å–æ·˜å®å…³é”®è¯æœç´¢ç»“æœçš„å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,API,æ•°æ®æŒ–æ˜"/> <meta itemprop="datePublished" content="2025-12-08T09:30:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”µå•†APIå¤§æ•°æ®æ¥å£å¼€å‘Cris"/> <meta itemprop="url" content="https://juejin.cn/user/3836609967955659"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼šé«˜æ•ˆæ‰¹é‡åŒ–è·å–æ·˜å®å…³é”®è¯æœç´¢ç»“æœçš„å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3836609967955659/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”µå•†APIå¤§æ•°æ®æ¥å£å¼€å‘Cris
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:30:52.000Z" title="Mon Dec 08 2025 09:30:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>åœ¨ç”µå•†æ•°æ®åˆ†æã€ç«å“è°ƒç ”æˆ–å•†å“ç›‘æ§ç­‰åœºæ™¯ä¸­ï¼Œæ‰¹é‡è·å–æ·˜å®å…³é”®è¯æœç´¢ç»“æœæ˜¯é«˜é¢‘éœ€æ±‚ã€‚ä½†ä¼ ç»ŸåŒæ­¥è¯·æ±‚æ–¹å¼å­˜åœ¨æ•ˆç‡ä½ã€æ˜“é˜»å¡ã€å®¹é”™æ€§å·®ç­‰é—®é¢˜ â€”â€” å½“å…³é”®è¯æ•°é‡è¾¾åˆ°æ•°ç™¾ç”šè‡³æ•°åƒä¸ªæ—¶ï¼ŒåŒæ­¥è¯·æ±‚ä¼šå› ç½‘ç»œå»¶è¿Ÿã€æ¥å£é™æµç­‰å› ç´ å¯¼è‡´æ•´ä½“è€—æ—¶æˆå€å¢åŠ ï¼Œä¸”å•ä¸ªè¯·æ±‚å¤±è´¥å¯èƒ½ä¸­æ–­æ•´ä¸ªæµç¨‹ã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆ Python çš„å¼‚æ­¥ç¼–ç¨‹å’Œä»»åŠ¡é˜Ÿåˆ—æŠ€æœ¯ï¼Œæ„å»ºä¸€å¥—é«˜æ•ˆã€å¯æ‰©å±•çš„æ·˜å®å…³é”®è¯æœç´¢ç»“æœæ‰¹é‡è·å–ç³»ç»Ÿï¼Œè§£å†³åŒæ­¥æ–¹å¼çš„ç—›ç‚¹ï¼Œå®ç°é«˜å¹¶å‘ã€é«˜å¯ç”¨çš„æ‰¹é‡æ•°æ®é‡‡é›†ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æŠ€æœ¯é€‰å‹ä¸æ ¸å¿ƒæ€è·¯</h2>
<h3 data-id="heading-1">1. æ ¸å¿ƒæŠ€æœ¯æ ˆ</h3>
<ul>
<li><strong>å¼‚æ­¥æ¡†æ¶</strong>ï¼š<code>aiohttp</code>ï¼ˆå¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼Œæ”¯æŒé«˜å¹¶å‘è¯·æ±‚ï¼‰</li>
<li><strong>ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š<code>asyncio.Queue</code>ï¼ˆè½»é‡çº§å¼‚æ­¥é˜Ÿåˆ—ï¼Œå®ç°ä»»åŠ¡è§£è€¦ä¸è°ƒåº¦ï¼‰</li>
<li><strong>æ•°æ®è§£æ</strong>ï¼š<code>parsel</code>ï¼ˆé«˜æ•ˆè§£æ HTML/JSONï¼Œæ›¿ä»£ BeautifulSoupï¼‰</li>
<li><strong>ååçˆ¬è¾…åŠ©</strong>ï¼š<code>fake-useragent</code>ï¼ˆç”Ÿæˆéšæœº User-Agentï¼‰ã€<code>asyncio.Semaphore</code>ï¼ˆæ§åˆ¶å¹¶å‘é‡ï¼Œé¿å…è§¦å‘é™æµï¼‰</li>
</ul>
<h3 data-id="heading-2">2. æ ¸å¿ƒæ€è·¯</h3>
<ol>
<li>æ„å»ºå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†å¾…æœç´¢çš„å…³é”®è¯æ‰¹é‡å…¥é˜Ÿï¼›</li>
<li>å¯åŠ¨å¤šä¸ªå¼‚æ­¥æ¶ˆè´¹è€…åç¨‹ï¼Œä»é˜Ÿåˆ—ä¸­å–å‡ºå…³é”®è¯å¹¶å‘èµ·å¼‚æ­¥ HTTP è¯·æ±‚ï¼›</li>
<li>å¯¹è¿”å›ç»“æœè¿›è¡Œè§£æï¼Œæå–å•†å“æ ¸å¿ƒä¿¡æ¯ï¼ˆæ ‡é¢˜ã€ä»·æ ¼ã€é”€é‡ã€åº—é“ºåç­‰ï¼‰ï¼›</li>
<li>ç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼ˆç½‘ç»œè¶…æ—¶ã€æ¥å£é™æµã€è§£æå¤±è´¥ç­‰ï¼‰ï¼Œä¿è¯é˜Ÿåˆ—æ¶ˆè´¹ä¸ä¸­æ–­ï¼›</li>
<li>å°†è§£æåçš„ç»“æœè½åœ°ï¼ˆæœ¬æ–‡ä»¥æœ¬åœ° JSON æ–‡ä»¶ä¸ºä¾‹ï¼Œå¯æ‰©å±•è‡³æ•°æ®åº“ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-3">äºŒã€å®Œæ•´å®ç°ä»£ç </h2>
<h3 data-id="heading-4">1. ç¯å¢ƒå‡†å¤‡</h3>
<p>é¦–å…ˆå®‰è£…ä¾èµ–åŒ…ï¼š</p>
<pre><code class="hljs">pip install aiohttp parsel fake-useragent python-dotenv
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-5">2. æ ¸å¿ƒä»£ç å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Optional</span>
<span class="hljs-keyword">from</span> fake_useragent <span class="hljs-keyword">import</span> UserAgent
<span class="hljs-keyword">import</span> aiohttp
<span class="hljs-keyword">from</span> parsel <span class="hljs-keyword">import</span> Selector
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># åŠ è½½ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œç”¨äºé…ç½®æ•æ„Ÿä¿¡æ¯ï¼‰</span>
load_dotenv()

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TaobaoSearchCrawler</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, concurrency: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>, timeout: <span class="hljs-built_in">int</span> = <span class="hljs-number">30</span></span>):
        <span class="hljs-string">"""
        åˆå§‹åŒ–æ·˜å®æœç´¢çˆ¬è™«
        :param concurrency: æœ€å¤§å¹¶å‘æ•°ï¼ˆé¿å…è§¦å‘æ·˜å®é™æµï¼‰
        :param timeout: è¯·æ±‚è¶…æ—¶æ—¶é—´
        """</span>
        self.concurrency = concurrency
        self.timeout = timeout
        self.semaphore = asyncio.Semaphore(concurrency)  <span class="hljs-comment"># å¹¶å‘æ§åˆ¶ä¿¡å·é‡</span>
        self.user_agent = UserAgent()
        <span class="hljs-comment"># æ·˜å®æœç´¢æ¥å£ï¼ˆéœ€æ³¨æ„ï¼šæ·˜å®ç½‘é¡µç‰ˆå¯èƒ½æœ‰åçˆ¬ï¼Œå»ºè®®ä½¿ç”¨åˆè§„çš„å¼€æ”¾å¹³å°æ¥å£ï¼‰</span>
        self.search_url = <span class="hljs-string">"https://s.taobao.com/search?q={}&amp;imgfile=&amp;commend=all&amp;ssid=s5-e&amp;search_type=item&amp;sourceId=tb.index&amp;spm=a21bo.jianhua.201856-taobao-item.1&amp;ie=utf8&amp;initiative_id=tbindexz_20170306"</span>
        <span class="hljs-comment"># ç»“æœå­˜å‚¨åˆ—è¡¨</span>
        self.results: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>] = []
        <span class="hljs-comment"># å¤±è´¥ä»»åŠ¡è®°å½•</span>
        self.failed_tasks: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>] = []

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_html</span>(<span class="hljs-params">self, session: aiohttp.ClientSession, keyword: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""
        å¼‚æ­¥è·å–æœç´¢ç»“æœé¡µé¢HTML
        :param session: aiohttpä¼šè¯å¯¹è±¡
        :param keyword: æœç´¢å…³é”®è¯
        :return: é¡µé¢HTMLå­—ç¬¦ä¸²ï¼Œå¤±è´¥è¿”å›None
        """</span>
        headers = {
            <span class="hljs-string">"User-Agent"</span>: self.user_agent.random,
            <span class="hljs-string">"Referer"</span>: <span class="hljs-string">"https://www.taobao.com/"</span>,
            <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"zh-CN,zh;q=0.9"</span>,
            <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, br"</span>
        }
        url = self.search_url.<span class="hljs-built_in">format</span>(keyword)
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.semaphore:  <span class="hljs-comment"># æ§åˆ¶å¹¶å‘</span>
                <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> session.get(
                    url=url,
                    headers=headers,
                    timeout=aiohttp.ClientTimeout(total=self.timeout),
                    <span class="hljs-comment"># å¯é€‰ï¼šæ·»åŠ ä»£ç†</span>
                    <span class="hljs-comment"># proxy=os.getenv("PROXY_URL")</span>
                ) <span class="hljs-keyword">as</span> response:
                    <span class="hljs-keyword">if</span> response.status == <span class="hljs-number">200</span>:
                        html = <span class="hljs-keyword">await</span> response.text()
                        <span class="hljs-keyword">return</span> html
                    <span class="hljs-keyword">else</span>:
                        self.failed_tasks.append({
                            <span class="hljs-string">"keyword"</span>: keyword,
                            <span class="hljs-string">"reason"</span>: <span class="hljs-string">f"HTTPçŠ¶æ€ç å¼‚å¸¸: <span class="hljs-subst">{response.status}</span>"</span>
                        })
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            self.failed_tasks.append({
                <span class="hljs-string">"keyword"</span>: keyword,
                <span class="hljs-string">"reason"</span>: <span class="hljs-string">f"è¯·æ±‚å¼‚å¸¸: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
            })
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_html</span>(<span class="hljs-params">self, html: <span class="hljs-built_in">str</span>, keyword: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-string">"""
        è§£ææœç´¢ç»“æœHTMLï¼Œæå–å•†å“ä¿¡æ¯
        :param html: é¡µé¢HTML
        :param keyword: æœç´¢å…³é”®è¯
        :return: å•†å“ä¿¡æ¯åˆ—è¡¨
        """</span>
        selector = Selector(text=html)
        items = []
        <span class="hljs-comment"># æ·˜å®æœç´¢ç»“æœå•†å“èŠ‚ç‚¹ï¼ˆéœ€æ ¹æ®å®é™…é¡µé¢ç»“æ„è°ƒæ•´ï¼‰</span>
        product_nodes = selector.css(<span class="hljs-string">".item J_MouserOnverReq  "</span>)
        <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> product_nodes:
            <span class="hljs-keyword">try</span>:
                item = {
                    <span class="hljs-string">"keyword"</span>: keyword,
                    <span class="hljs-string">"title"</span>: node.css(<span class="hljs-string">".J_ClickStat::attr(title)"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>,
                    <span class="hljs-string">"price"</span>: node.css(<span class="hljs-string">".price J_price::text"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>,
                    <span class="hljs-string">"sales"</span>: node.css(<span class="hljs-string">".deal-cnt::text"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">"0"</span>,
                    <span class="hljs-string">"shop_name"</span>: node.css(<span class="hljs-string">".shopname J_MouseververReq::text"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>,
                    <span class="hljs-string">"item_url"</span>: node.css(<span class="hljs-string">".J_ClickStat::attr(href)"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>,
                    <span class="hljs-string">"image_url"</span>: node.css(<span class="hljs-string">".J_ItemImg::attr(src)"</span>).extract_first() <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>
                }
                <span class="hljs-comment"># æ¸…æ´—æ•°æ®</span>
                item[<span class="hljs-string">"title"</span>] = item[<span class="hljs-string">"title"</span>].strip()
                item[<span class="hljs-string">"price"</span>] = item[<span class="hljs-string">"price"</span>].strip().replace(<span class="hljs-string">"Â¥"</span>, <span class="hljs-string">""</span>)
                items.append(item)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-keyword">continue</span>
        <span class="hljs-keyword">return</span> items

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>(<span class="hljs-params">self, queue: asyncio.Queue, session: aiohttp.ClientSession</span>):
        <span class="hljs-string">"""
        é˜Ÿåˆ—æ¶ˆè´¹è€…ï¼šä»é˜Ÿåˆ—å–å…³é”®è¯ï¼Œæ‰§è¡Œè¯·æ±‚å’Œè§£æ
        :param queue: å¼‚æ­¥é˜Ÿåˆ—
        :param session: aiohttpä¼šè¯
        """</span>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> queue.empty():
            keyword = <span class="hljs-keyword">await</span> queue.get()
            html = <span class="hljs-keyword">await</span> self.fetch_html(session, keyword)
            <span class="hljs-keyword">if</span> html:
                items = self.parse_html(html, keyword)
                self.results.extend(items)
            queue.task_done()  <span class="hljs-comment"># æ ‡è®°ä»»åŠ¡å®Œæˆ</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, keywords: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
        <span class="hljs-string">"""
        å¯åŠ¨çˆ¬è™«ä¸»æµç¨‹
        :param keywords: å¾…æœç´¢å…³é”®è¯åˆ—è¡¨
        """</span>
        <span class="hljs-comment"># 1. åˆå§‹åŒ–ä»»åŠ¡é˜Ÿåˆ—</span>
        queue = asyncio.Queue()
        <span class="hljs-keyword">for</span> keyword <span class="hljs-keyword">in</span> keywords:
            <span class="hljs-keyword">await</span> queue.put(keyword)

        <span class="hljs-comment"># 2. åˆ›å»ºaiohttpä¼šè¯ï¼ˆå¤ç”¨è¿æ¥ï¼Œæå‡æ•ˆç‡ï¼‰</span>
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiohttp.ClientSession() <span class="hljs-keyword">as</span> session:
            <span class="hljs-comment"># 3. åˆ›å»ºæ¶ˆè´¹è€…ä»»åŠ¡</span>
            tasks = [asyncio.create_task(self.consumer(queue, session)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.concurrency)]
            <span class="hljs-comment"># 4. ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
            <span class="hljs-keyword">await</span> queue.join()
            <span class="hljs-comment"># 5. å–æ¶ˆæœªå®Œæˆçš„ä»»åŠ¡ï¼ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼‰</span>
            <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> tasks:
                task.cancel()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_results</span>(<span class="hljs-params">self, save_path: <span class="hljs-built_in">str</span> = <span class="hljs-string">"taobao_search_results.json"</span></span>):
        <span class="hljs-string">"""
        ä¿å­˜ç»“æœåˆ°JSONæ–‡ä»¶
        :param save_path: ä¿å­˜è·¯å¾„
        """</span>
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(save_path, <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
            json.dump({
                <span class="hljs-string">"total_success"</span>: <span class="hljs-built_in">len</span>(self.results),
                <span class="hljs-string">"total_failed"</span>: <span class="hljs-built_in">len</span>(self.failed_tasks),
                <span class="hljs-string">"results"</span>: self.results,
                <span class="hljs-string">"failed_tasks"</span>: self.failed_tasks
            }, f, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">4</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç»“æœå·²ä¿å­˜è‡³ <span class="hljs-subst">{save_path}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸè§£æ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(self.results)}</span> æ¡å•†å“æ•°æ®ï¼Œå¤±è´¥ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(self.failed_tasks)}</span> ä¸ªå…³é”®è¯"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å¾…æœç´¢çš„å…³é”®è¯åˆ—è¡¨</span>
    KEYWORDS = [
        <span class="hljs-string">"Pythonç¼–ç¨‹"</span>,
        <span class="hljs-string">"å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—"</span>,
        <span class="hljs-string">"æ·˜å®æ•°æ®åˆ†æ"</span>,
        <span class="hljs-string">"ç”µå•†çˆ¬è™«"</span>,
        <span class="hljs-string">"aiohttpå®æˆ˜"</span>
        <span class="hljs-comment"># å¯æ‰©å±•è‡³æ•°åƒä¸ªå…³é”®è¯</span>
    ]

    <span class="hljs-comment"># åˆå§‹åŒ–çˆ¬è™«</span>
    crawler = TaobaoSearchCrawler(concurrency=<span class="hljs-number">10</span>, timeout=<span class="hljs-number">30</span>)

    <span class="hljs-comment"># è®°å½•å¼€å§‹æ—¶é—´</span>
    start_time = time.time()

    <span class="hljs-comment"># è¿è¡Œå¼‚æ­¥çˆ¬è™«</span>
    asyncio.run(crawler.run(KEYWORDS))

    <span class="hljs-comment"># ä¿å­˜ç»“æœ</span>
    crawler.save_results()

    <span class="hljs-comment"># è¾“å‡ºè€—æ—¶</span>
    end_time = time.time()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»è€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span> ç§’"</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-6">ä¸‰ã€å…³é”®æŠ€æœ¯è§£æ</h2>
<h3 data-id="heading-7">1. å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆasyncio.Queueï¼‰</h3>
<ul>
<li><strong>è§£è€¦ç”Ÿäº§ä¸æ¶ˆè´¹</strong>ï¼šå…³é”®è¯ä½œä¸ºä»»åŠ¡è¢« â€œç”Ÿäº§è€…â€ æ”¾å…¥é˜Ÿåˆ—ï¼Œâ€œæ¶ˆè´¹è€…â€ åç¨‹ä»é˜Ÿåˆ—å–ä»»åŠ¡æ‰§è¡Œï¼Œå®ç°ä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œåˆ†ç¦»ï¼›</li>
<li><strong>é˜»å¡ä¸å”¤é†’</strong>ï¼šé˜Ÿåˆ—ç©ºæ—¶æ¶ˆè´¹è€…è‡ªåŠ¨é˜»å¡ï¼Œæ–°ä»»åŠ¡å…¥é˜Ÿæ—¶å”¤é†’ï¼Œé¿å…æ— æ•ˆè½®è¯¢ï¼›</li>
<li><strong>ä»»åŠ¡å®Œæˆç¡®è®¤</strong>ï¼š<code>queue.task_done()</code>Â æ ‡è®°ä»»åŠ¡å®Œæˆï¼Œ<code>queue.join()</code>Â ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼Œä¿è¯æµç¨‹å®Œæ•´æ€§ã€‚</li>
</ul>
<h3 data-id="heading-8">2. å¹¶å‘æ§åˆ¶ï¼ˆasyncio.Semaphoreï¼‰</h3>
<p>æ·˜å®å¯¹é«˜é¢‘è¯·æ±‚æœ‰é™æµæœºåˆ¶ï¼Œé€šè¿‡<code>Semaphore</code>é™åˆ¶æœ€å¤§å¹¶å‘æ•°ï¼ˆæœ¬æ–‡è®¾ä¸º 10ï¼‰ï¼Œé¿å…å› è¯·æ±‚è¿‡äºå¯†é›†è§¦å‘åçˆ¬æˆ– IP å°ç¦ã€‚</p>
<h3 data-id="heading-9">3. å¼‚æ­¥ HTTP è¯·æ±‚ï¼ˆaiohttpï¼‰</h3>
<ul>
<li><strong>è¿æ¥å¤ç”¨</strong>ï¼šé€šè¿‡<code>aiohttp.ClientSession</code>å¤ç”¨ TCP è¿æ¥ï¼Œå‡å°‘æ¡æ‰‹å¼€é”€ï¼›</li>
<li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šè®¾ç½®<code>ClientTimeout</code>é¿å…å•ä¸ªè¯·æ±‚é˜»å¡æ•´ä¸ªæµç¨‹ï¼›</li>
<li><strong>å¼‚å¸¸æ•è·</strong>ï¼šå¯¹ç½‘ç»œè¶…æ—¶ã€çŠ¶æ€ç å¼‚å¸¸ç­‰æƒ…å†µå•ç‹¬å¤„ç†ï¼Œä¿è¯å•ä¸ªè¯·æ±‚å¤±è´¥ä¸å½±å“æ•´ä½“é˜Ÿåˆ—æ¶ˆè´¹ã€‚</li>
</ul>
<h3 data-id="heading-10">4. æ•°æ®è§£æï¼ˆparselï¼‰</h3>
<p><code>parsel</code>åŸºäº lxml å®ç°ï¼Œæ”¯æŒ XPath/CSS é€‰æ‹©å™¨ï¼Œè§£ææ•ˆç‡è¿œé«˜äº BeautifulSoupï¼Œä¸”è¯­æ³•æ›´ç®€æ´ã€‚éœ€æ³¨æ„ï¼šæ·˜å®é¡µé¢ç»“æ„å¯èƒ½åŠ¨æ€å˜åŒ–ï¼Œéœ€å®šæœŸè°ƒæ•´é€‰æ‹©å™¨è§„åˆ™ã€‚</p>
<h2 data-id="heading-11">å››ã€ä¼˜åŒ–ä¸æ‰©å±•å»ºè®®</h2>
<h3 data-id="heading-12">1. ååçˆ¬ä¼˜åŒ–</h3>
<ul>
<li><strong>ä»£ç†æ± é›†æˆ</strong>ï¼šæ·»åŠ åŠ¨æ€ä»£ç†æ± ï¼ˆå¦‚ä½¿ç”¨<code>aiohttp-socks</code>æ”¯æŒ SOCKS ä»£ç†ï¼‰ï¼Œé¿å…å• IP è¯·æ±‚è¿‡äºé¢‘ç¹ï¼›</li>
<li><strong>Cookie æŒä¹…åŒ–</strong>ï¼šç™»å½•æ·˜å®åæŒä¹…åŒ– Cookieï¼Œæå‡è¯·æ±‚æˆåŠŸç‡ï¼›</li>
<li><strong>è¯·æ±‚é—´éš”éšæœºåŒ–</strong>ï¼šåœ¨<code>fetch_html</code>ä¸­æ·»åŠ éšæœºå»¶è¿Ÿï¼ˆå¦‚ 0.5-2 ç§’ï¼‰ï¼Œæ¨¡æ‹Ÿäººå·¥æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-13">2. ä»»åŠ¡é˜Ÿåˆ—æ‰©å±•</h3>
<ul>
<li><strong>åˆ†å¸ƒå¼é˜Ÿåˆ—</strong>ï¼šè‹¥å…³é”®è¯æ•°é‡è¶… 10 ä¸‡çº§ï¼Œå¯æ›¿æ¢ä¸º<code>Celery + Redis</code>åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ”¯æŒå¤šæœºå™¨åˆ†å¸ƒå¼æ¶ˆè´¹ï¼›</li>
<li><strong>ä»»åŠ¡é‡è¯•</strong>ï¼šå¯¹å¤±è´¥çš„ä»»åŠ¡ï¼ˆå¦‚<code>failed_tasks</code>ï¼‰å®ç°è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œæå‡æˆåŠŸç‡ã€‚</li>
</ul>
<h3 data-id="heading-14">3. æ•°æ®è½åœ°ä¼˜åŒ–</h3>
<ul>
<li><strong>æ‰¹é‡å…¥åº“</strong>ï¼šå°†è§£æåçš„å•†å“æ•°æ®æ‰¹é‡æ’å…¥ MySQL/Redis/MongoDBï¼Œé¿å…å•æ¡æ’å…¥çš„ IO å¼€é”€ï¼›</li>
<li><strong>å¢é‡æ›´æ–°</strong>ï¼šè®°å½•å·²çˆ¬å–çš„å…³é”®è¯å’Œå•†å“ï¼Œé¿å…é‡å¤é‡‡é›†ã€‚</li>
</ul>
<h3 data-id="heading-15">4. ç›‘æ§ä¸å‘Šè­¦</h3>
<ul>
<li>æ·»åŠ æ—¥å¿—æ¨¡å—ï¼ˆå¦‚<code>logging</code>ï¼‰è®°å½•è¯·æ±‚ / è§£ææ—¥å¿—ï¼›</li>
<li>ç›‘æ§å¤±è´¥ç‡ï¼Œå½“å¤±è´¥ç‡è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘é‚®ä»¶ / é’‰é’‰å‘Šè­¦ã€‚</li>
</ul>
<h2 data-id="heading-16">äº”ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>åˆè§„æ€§</strong>ï¼šæ·˜å®æ•°æ®å—ã€Šç”µå­å•†åŠ¡æ³•ã€‹ä¿æŠ¤ï¼Œçˆ¬è™«éœ€éµå®ˆå¹³å°<code>robots.txt</code>åè®®ï¼Œä»…ç”¨äºåˆæ³•çš„æ•°æ®åˆ†æï¼Œç¦æ­¢å•†ç”¨æˆ–æ¶æ„é‡‡é›†ï¼›</li>
<li><strong>åçˆ¬åº”å¯¹</strong>ï¼šæ·˜å®ä¼šåŠ¨æ€æ›´æ–°åçˆ¬ç­–ç•¥ï¼ˆå¦‚éªŒè¯ç ã€JS åŠ å¯†ï¼‰ï¼Œæœ¬æ–‡ä»…æ¼”ç¤ºåŸºç¡€æ€è·¯ï¼Œç”Ÿäº§ç¯å¢ƒéœ€ç»“åˆå®é™…åçˆ¬æœºåˆ¶è°ƒæ•´ï¼›</li>
<li><strong>æ€§èƒ½æµ‹è¯•</strong>ï¼šå»ºè®®å…ˆé€šè¿‡å°‘é‡å…³é”®è¯æµ‹è¯•å¹¶å‘æ•°ï¼Œæ‰¾åˆ° â€œæ•ˆç‡ - ç¨³å®šæ€§â€ å¹³è¡¡ç‚¹ï¼ˆå¦‚ 10-20 å¹¶å‘è¾ƒåˆé€‚ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-17">å…­ã€æ€»ç»“</h2>
<p>æœ¬æ–‡é€šè¿‡å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— + é«˜å¹¶å‘å¼‚æ­¥è¯·æ±‚çš„ç»„åˆï¼Œè§£å†³äº†ä¼ ç»ŸåŒæ­¥æ–¹å¼æ‰¹é‡è·å–æ·˜å®æœç´¢ç»“æœçš„æ•ˆç‡é—®é¢˜ã€‚æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘</strong>ï¼šå¼‚æ­¥ IO å¤§å¹…æå‡è¯·æ±‚æ•ˆç‡ï¼Œæ•°åƒä¸ªå…³é”®è¯çš„é‡‡é›†è€—æ—¶ä»å°æ—¶çº§é™è‡³åˆ†é’Ÿçº§ï¼›</li>
<li><strong>é«˜å¯ç”¨</strong>ï¼šå¼‚å¸¸éš”ç¦»ã€å¹¶å‘æ§åˆ¶ä¿è¯æµç¨‹ä¸ä¸­æ–­ï¼Œå¤±è´¥ä»»åŠ¡å¯è¿½æº¯ï¼›</li>
<li><strong>æ˜“æ‰©å±•</strong>ï¼šé˜Ÿåˆ—æ¶æ„æ”¯æŒåˆ†å¸ƒå¼ã€é‡è¯•ã€ç›‘æ§ç­‰æ‰©å±•èƒ½åŠ›ï¼Œé€‚é…ä¸åŒè§„æ¨¡çš„é‡‡é›†éœ€æ±‚ã€‚</li>
</ul>
<p>è¯¥æ€è·¯ä¸ä»…é€‚ç”¨äºæ·˜å®æœç´¢ç»“æœé‡‡é›†ï¼Œä¹Ÿå¯è¿ç§»è‡³äº¬ä¸œã€æ‹¼å¤šå¤šç­‰ç”µå•†å¹³å°ï¼Œæˆ–å…¶ä»–éœ€è¦æ‰¹é‡å¼‚æ­¥è¯·æ±‚çš„åœºæ™¯ï¼ˆå¦‚ API æ‰¹é‡è°ƒç”¨ã€ç½‘é¡µæ‰¹é‡æŠ“å–ï¼‰ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ GitHub Actions ä¸ Docker å®ç° CaptchaVision API æŒç»­é›†æˆ]]></title>    <link>https://juejin.cn/post/7581292270961000458</link>    <guid>https://juejin.cn/post/7581292270961000458</guid>    <pubDate>2025-12-08T09:34:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581292270961000458" data-draft-id="7581406561684406318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ GitHub Actions ä¸ Docker å®ç° CaptchaVision API æŒç»­é›†æˆ"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-08T09:34:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="abining"/> <meta itemprop="url" content="https://juejin.cn/user/741495293092151"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ GitHub Actions ä¸ Docker å®ç° CaptchaVision API æŒç»­é›†æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/741495293092151/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    abining
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T09:34:07.000Z" title="Mon Dec 08 2025 09:34:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ GitHub Actions ä¸ Docker å®ç° CaptchaVision API æŒç»­é›†æˆ</h2>
<p>æœ¬æ–‡è¯¦ç»†è®²è§£å¦‚ä½•åˆ©ç”¨ <strong>GitHub Actions</strong> è‡ªåŠ¨åŒ–å·¥ä½œæµï¼Œé…åˆ <strong>Docker</strong> å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå°†åŸºäº <strong>CaptchaVision</strong> é¡¹ç›®çš„ AI éªŒè¯ç è¯†åˆ«æœåŠ¡æŒç»­é›†æˆå¹¶æ¨é€åˆ° <strong>é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼ˆACRï¼‰</strong> ã€‚</p>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>æŒç»­é›†æˆï¼ˆCIï¼‰æ˜¯ç°ä»£è½¯ä»¶å¼€å‘çš„å…³é”®å®è·µã€‚é€šè¿‡ GitHub Actionsï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç æ¨é€åˆ°ä»“åº“æ—¶ï¼Œè‡ªåŠ¨å®Œæˆ <strong>æ„å»ºé•œåƒã€ç™»å½•ä»“åº“ã€æ¨é€é•œåƒ</strong> ç­‰ç¹çæ­¥éª¤ã€‚</p>
<ul>
<li><strong>é¡¹ç›®åŸºç¡€ï¼š</strong> æœ¬æ–‡ä»¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fabining%2FCaptchaVision" target="_blank" title="https://github.com/abining/CaptchaVision" ref="nofollow noopener noreferrer">github.com/abining/Capâ€¦</a> å¼€æºé¡¹ç›®ä¸ºä¾‹ï¼Œè¯¥é¡¹ç›®é€šå¸¸åŒ…å«ä¸€ä¸ªç”¨äº AI è¯†åˆ«å’Œå›¾åƒé¢„å¤„ç†çš„ Python æœåŠ¡ã€‚</li>
<li><strong>ç›®æ ‡å·¥ä½œæµï¼š</strong> æäº¤ä»£ç åˆ° <code>main</code> åˆ†æ”¯ â†’ GitHub Actions è‡ªåŠ¨æ„å»º Docker é•œåƒ â†’ é•œåƒæ¨é€è‡³é˜¿é‡Œäº‘ ACRã€‚</li>
</ul>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒä¸æœºå¯†ä¿¡æ¯é…ç½®</h3>
<p>ä¸ºäº†è®© GitHub Actions èƒ½å¤Ÿè‡ªåŠ¨ç™»å½•é˜¿é‡Œäº‘ ACR å¹¶ä½¿ç”¨æ‚¨çš„ä»“åº“ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ GitHub ä¸­é…ç½®æœºå¯†ä¿¡æ¯ï¼ˆSecretsï¼‰ã€‚</p>
<h4 data-id="heading-3">1. å­˜å‚¨é˜¿é‡Œäº‘å‡­è¯å’Œä»“åº“ä¿¡æ¯</h4>
<p>æˆ‘ä»¬å°†æœºå¯†ä¿¡æ¯åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>
<p><strong>å­˜å‚¨åº“æœºå¯† (Repository Secrets)ï¼š</strong> é€‚ç”¨äºæ•´ä¸ªä»“åº“ã€‚</p>
<ul>
<li><code>REPO_NAME</code>: é•œåƒä»“åº“åç§°ï¼Œä¾‹å¦‚ <code>captcha_vision</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¯å¢ƒæœºå¯† (Environment Secrets)ï¼š</strong> ä¸“ç”¨äºéƒ¨ç½²ç¯å¢ƒï¼Œå®‰å…¨æ€§æ›´é«˜ã€‚</p>
</li>
</ul>
<p>åœ¨ GitHub ä»“åº“ä¸­ï¼Œè¿›å…¥ <strong>Settings</strong> â†’ <strong>Security</strong> â†’ <strong>Secrets and variables</strong> â†’ <strong>Actions</strong>ã€‚</p>



































<table><thead><tr><th><strong>å¯†é’¥åç§°</strong></th><th><strong>ç±»å‹</strong></th><th><strong>å­˜å‚¨å€¼ç¤ºä¾‹</strong></th><th><strong>ç”¨é€”</strong></th></tr></thead><tbody><tr><td><code>ALI_DOCKER_HUB_REGISTRY</code></td><td>ç¯å¢ƒæœºå¯†</td><td><code>crpi-&lt;hashstring&gt;.cn-hangzhou.personal.cr.aliyuncs.com</code></td><td>é˜¿é‡Œäº‘ ACR åŒºåŸŸ Registry åœ°å€ã€‚</td></tr><tr><td><code>ALI_DOCKER_HUB_USN</code></td><td>ç¯å¢ƒæœºå¯†</td><td><code>æ‚¨çš„é˜¿é‡Œäº‘ç”¨æˆ·å</code></td><td>ç™»å½•é˜¿é‡Œäº‘ ACR çš„ç”¨æˆ·åã€‚</td></tr><tr><td><code>ALI_DOCKER_HUB_PWD</code></td><td>ç¯å¢ƒæœºå¯†</td><td><code>æ‚¨çš„é˜¿é‡Œäº‘å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ</code></td><td>ç™»å½•é˜¿é‡Œäº‘ ACR çš„å¯†ç /ä»¤ç‰Œã€‚</td></tr><tr><td><code>REPO_NAME</code></td><td>å­˜å‚¨åº“æœºå¯†</td><td><code>captcha_vision</code></td><td>ç”¨äºæ„å»º <code>tags</code> çš„é•œåƒä»“åº“åç§°ã€‚</td></tr></tbody></table>
<blockquote>
<p><strong>âš ï¸ æ³¨æ„ï¼š</strong> æ‚¨çš„æœºå¯†ä¿¡æ¯ï¼ˆå¦‚ <code>ALI_DOCKER_HUB_PWD</code> å’Œ <code>ALI_DOCKER_HUB_USN</code>ï¼‰è¢«å…³è”åˆ°åä¸º <code>ALI_DOCKER_HUB_REGISTRY</code> çš„<strong>ç¯å¢ƒ</strong>ã€‚å› æ­¤ï¼Œåœ¨ YAML ä¸­æˆ‘ä»¬å¿…é¡»æŒ‡å®š <code>environment: ALI_DOCKER_HUB_REGISTRY</code> æ‰èƒ½è§£é”è¿™äº›æœºå¯†ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5c31136473c489e84bccf6b29953082~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWJpbmluZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765792272&amp;x-signature=xx3joACqlbUs0mc3PUEIkzJwjO4%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">2. åˆ›å»ºé˜¿é‡Œäº‘é•œåƒä»“åº“</h4>
<p>åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°<a href="https://link.juejin.cn?target=https%3A%2F%2Fcr.console.aliyun.com%2Fcn-hangzhou%2Finstance%2Frepositories" target="_blank" title="https://cr.console.aliyun.com/cn-hangzhou/instance/repositories" ref="nofollow noopener noreferrer">cr.console.aliyun.com/cn-hangzhouâ€¦</a> è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>è®¿é—® <strong>å®¹å™¨é•œåƒæœåŠ¡</strong> (Container Registry)ã€‚</li>
<li>è¿›å…¥ <strong>å®ä¾‹/ä»“åº“ç®¡ç†</strong>ï¼Œåˆ›å»ºæ–°çš„é•œåƒä»“åº“ï¼ˆä¾‹å¦‚ï¼Œå‘½åä¸º <code>chouvelgis/captchavision</code>ï¼‰ã€‚</li>
<li>å°†ä»£ç æºè®¾ç½®ä¸º<strong>æ‰‹åŠ¨ä¸Šä¼ </strong>ï¼Œå¹¶è®°å½•æ‚¨çš„ <strong>Registry åœ°å€</strong>ã€‚</li>
</ul>
<h3 data-id="heading-5">ğŸ’» ç¬¬äºŒæ­¥ï¼šç¼–å†™ GitHub Actions å·¥ä½œæµæ–‡ä»¶</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º <code>.github/workflows/deploy.yml</code> æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯æ‚¨çš„éƒ¨ç½²è„šæœ¬ï¼Œå®ƒå°†å®ç°è‡ªåŠ¨æ„å»ºã€ç™»å½•ã€æ¨é€çš„å®Œæ•´ CI è¿‡ç¨‹ã€‚</p>
<pre><code class="hljs language-YAML" lang="YAML"><span class="hljs-comment"># å·¥ä½œæµç¨‹åç§°</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Docker</span> <span class="hljs-string">éƒ¨ç½²</span> <span class="hljs-string">CaptchaVision</span> <span class="hljs-string">API</span>

<span class="hljs-comment"># è§¦å‘æ¡ä»¶ï¼šå½“ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶è§¦å‘å·¥ä½œæµ</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span>

<span class="hljs-comment"># å·¥ä½œæµç¨‹ä½œä¸š</span>
<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-comment"># å…³é”®æ­¥éª¤ï¼šæŒ‡å®šç¯å¢ƒï¼Œä»¥è§£é”ç¯å¢ƒæœºå¯†ï¼ˆALI_DOCKER_HUB_USN/PWDï¼‰</span>
    <span class="hljs-attr">environment:</span> <span class="hljs-string">ALI_DOCKER_HUB_REGISTRY</span>
    
    <span class="hljs-attr">steps:</span>
      <span class="hljs-comment"># 1. è¿å‡ºä»£ç </span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">è¿å‡ºä»£ç </span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>

      <span class="hljs-comment"># 2. è®¾ç½® Docker Buildx (ç”¨äºé«˜æ•ˆæ„å»ºå’Œç¼“å­˜)</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">è®¾ç½®</span> <span class="hljs-string">Docker</span> <span class="hljs-string">Buildx</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">docker/setup-buildx-action@v3</span>

      <span class="hljs-comment"># 3. ç™»å½•åˆ°é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ (ä½¿ç”¨ç¯å¢ƒæœºå¯†)</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ç™»å½•åˆ°é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">docker/login-action@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">registry:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.ALI_DOCKER_HUB_REGISTRY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">username:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.ALI_DOCKER_HUB_USN</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">password:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.ALI_DOCKER_HUB_PWD</span> <span class="hljs-string">}}</span>

      <span class="hljs-comment"># 4.æ„å»ºå¹¶æ¨é€ Docker é•œåƒ</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">æ„å»ºå¹¶æ¨é€</span> <span class="hljs-string">Docker</span> <span class="hljs-string">é•œåƒ</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">docker/build-push-action@v5</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">context:</span> <span class="hljs-string">.</span>
          <span class="hljs-attr">push:</span> <span class="hljs-literal">true</span>
          <span class="hljs-attr">tags:</span> <span class="hljs-string">|
            ${{ secrets.ALI_DOCKER_HUB_REGISTRY }}/chouvelgis/${{ secrets.REPO_NAME }}:latest
            ${{ secrets.ALI_DOCKER_HUB_REGISTRY }}/chouvelgis/${{ secrets.REPO_NAME }}:${{ github.sha }}
            ${{ secrets.ALI_DOCKER_HUB_REGISTRY }}/chouvelgis/${{ secrets.REPO_NAME }}:v${{ github.run_number }}
</span>          <span class="hljs-attr">cache-from:</span> <span class="hljs-string">type=gha</span> <span class="hljs-comment"># ä» GHA ç¼“å­˜ä¸­æ‹‰å–å†å²æ„å»ºå±‚</span>
          <span class="hljs-attr">cache-to:</span> <span class="hljs-string">type=gha,mode=max</span> <span class="hljs-comment"># æ¨é€æ–°çš„æ„å»ºå±‚åˆ° GHA ç¼“å­˜</span>

      <span class="hljs-comment"># 5. éƒ¨ç½²å®Œæˆé€šçŸ¥</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">éƒ¨ç½²å®Œæˆ</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">"Docker éƒ¨ç½²å®Œæˆï¼Œé•œåƒå·²æ¨é€åˆ° Aliyun ACRï¼"</span>
</code></pre>
<h3 data-id="heading-6">ğŸ“ˆ ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹å·¥ä½œæµæ—¥å¿—ä¸åç»­éƒ¨ç½²</h3>
<h4 data-id="heading-7">1. æŸ¥çœ‹å·¥ä½œæµæ—¥å¿—</h4>
<p>ä»£ç æäº¤åˆ° <code>main</code> åˆ†æ”¯åï¼š</p>
<ol>
<li>è¿›å…¥ GitHub ä»“åº“çš„ <strong>Actions</strong> èœå•ã€‚</li>
<li>æ‰¾åˆ°åä¸º <code>Docker éƒ¨ç½² CaptchaVision API</code> çš„å·¥ä½œæµã€‚</li>
<li>ç‚¹å‡»æŸ¥çœ‹æ—¥å¿—ï¼Œæ‰€æœ‰æ­¥éª¤ï¼ˆå¦‚â€œç™»å½•åˆ°é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡â€ã€â€œæ„å»ºå¹¶æ¨é€ Docker é•œåƒâ€ï¼‰éƒ½åº”æ˜¾ç¤ºç»¿è‰²å‹¾é€‰ï¼ˆâœ…ï¼‰ã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17e414ed09334169b3a07b9a4da725c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWJpbmluZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765792272&amp;x-signature=zM%2F5nmXmJlTgCgyKo3n8iGXgznk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">2. éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ˆCD)</h4>
<p>ä¸€æ—¦é•œåƒæ¨é€æˆåŠŸï¼Œæ‚¨çš„ CI ä»»åŠ¡å°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥çš„ CDï¼ˆæŒç»­éƒ¨ç½²ï¼‰éœ€è¦åœ¨æ‚¨çš„ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</p>
<p>åœ¨æœåŠ¡å™¨ç»ˆç«¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‹‰å–å¹¶å¯åŠ¨æœ€æ–°çš„å®¹å™¨ï¼š</p>
<p>ç›´æ¥å»<a href="https://link.juejin.cn?target=https%3A%2F%2Fcr.console.aliyun.com%2Fcn-hangzhou%2Finstance%2Frepositories" target="_blank" title="https://cr.console.aliyun.com/cn-hangzhou/instance/repositories" ref="nofollow noopener noreferrer">cr.console.aliyun.com/cn-hangzhouâ€¦</a> æ§åˆ¶å°ï¼Œæ‰¾åˆ°å¯¹åº”é•œåƒä»“åº“ï¼ŒæŸ¥çœ‹ç›¸å…³æ–‡æ¡£å³å¯æ‹‰å–é•œåƒã€‚å¦‚æœä½¿ç”¨é˜¿é‡Œäº‘çš„ECSï¼Œå¯ä»¥ä½¿ç”¨é•œåƒä»“åº“å†…ç½‘åœ°å€ï¼ŒåŠ å¿«é€Ÿåº¦ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‡è®¾æ‚¨å·²ç™»å½•é˜¿é‡Œäº‘ ACR</span>

<span class="hljs-comment"># åœæ­¢å¹¶ç§»é™¤æ—§å®¹å™¨ (å¦‚æœå­˜åœ¨)</span>
docker stop captchavision-api
docker <span class="hljs-built_in">rm</span> captchavision-api

<span class="hljs-comment"># æ‹‰å–æœ€æ–°çš„é•œåƒ (ä½¿ç”¨ latest æ ‡ç­¾)</span>
docker pull <span class="hljs-variable">${{ secrets.ALI_DOCKER_HUB_REGISTRY }</span>}/chouvelgis/<span class="hljs-variable">${{ secrets.REPO_NAME }</span>}:latest

<span class="hljs-comment"># å¯åŠ¨å®¹å™¨ (æ³¨æ„ï¼šå¦‚æœåº”ç”¨éœ€è¦ API Keyï¼Œè¯·åœ¨è¿è¡Œæ—¶æ³¨å…¥ -e å‚æ•°)</span>
docker run -d \
  -p 8011:8011 \
  --name=captchavision-api \
  -e GEMINI_API_KEY=<span class="hljs-string">"æ‚¨çš„Gemini API Key"</span> \
  <span class="hljs-variable">${{ secrets.ALI_DOCKER_HUB_REGISTRY }</span>}/chouvelgis/<span class="hljs-variable">${{ secrets.REPO_NAME }</span>}:latest
</code></pre>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>é€šè¿‡è¿™ä¸€å¥—æµç¨‹ï¼Œæ‚¨å®ç°äº†ä»ä»£ç æäº¤åˆ°é•œåƒæ¨é€çš„å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæå¤§åœ°æé«˜äº†å¼€å‘æ•ˆç‡å’Œéƒ¨ç½²ä¸€è‡´æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>