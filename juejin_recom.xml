<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªVSCodeæ’ä»¶ï¼Œä»å¼€å‘åˆ°å‘å¸ƒå…¨æµç¨‹]]></title>    <link>https://juejin.cn/post/7584320417307082803</link>    <guid>https://juejin.cn/post/7584320417307082803</guid>    <pubDate>2025-12-17T00:08:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584320417307082803" data-draft-id="7584340871412596763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªVSCodeæ’ä»¶ï¼Œä»å¼€å‘åˆ°å‘å¸ƒå…¨æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Visual Studio Code"/> <meta itemprop="datePublished" content="2025-12-17T00:08:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°å¯’"/> <meta itemprop="url" content="https://juejin.cn/user/694547078987287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªVSCodeæ’ä»¶ï¼Œä»å¼€å‘åˆ°å‘å¸ƒå…¨æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547078987287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°å¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:08:02.000Z" title="Wed Dec 17 2025 00:08:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p><code>VSCode</code> å‡ ä¹æ˜¯å‰ç«¯å¼€å‘äººå‘˜çš„æ ‡é…ï¼Œè€Œç°åœ¨ç¼–è¾‘å™¨å¾€å¾€åªæä¾›<strong>ä»£ç ç¼–è¾‘</strong>ã€<strong>æ–‡ä»¶å’Œé¡¹ç›®ç®¡ç†</strong>ã€<strong>ç»ˆç«¯é›†æˆ</strong>ã€<strong>æºä»£ç ç®¡ç†</strong>ã€<strong>è°ƒè¯•æ”¯æŒ</strong>ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œè€Œä¸€äº›æ‰©å±•åŠŸèƒ½åˆ™äº¤ç»™æ’ä»¶æ¥å®ç°ã€‚</p>
<p>ä¼šç¼–å†™ <code>VSCode</code> æ’ä»¶å¯ä»¥æå¤§æå‡æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ç¼–å†™ä¸€ä¸ªç®€å•çš„ <code>VSCode</code> æ’ä»¶ã€‚</p>
<h2 data-id="heading-1">1ã€ å®‰è£…å·¥å…·ï¼Œåˆå§‹åŒ–é¡¹ç›®</h2>
<p>é¦–å…ˆè‚¯å®šè¦å®‰è£… <code>node</code>ï¼Œå†é€šè¿‡å…¶è‡ªå¸¦ <code>npm</code> åŒ…ç®¡ç†å·¥å…·å®‰è£… <code>yo</code> å’Œ <code>generator-code</code>ã€‚</p>
<ul>
<li><code>yo</code>ï¼šå…¨ç§°å« <code>Yeoman</code>ï¼Œæ˜¯ä¸€ä¸ªç°ä»£ Web åº”ç”¨çš„è„šæ‰‹æ¶å·¥å…·ï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰ï¼Œç”¨äºå¿«é€Ÿç”Ÿæˆé¡¹ç›®ã€‚</li>
<li><code>generator-code</code>ï¼š<code>VS Code</code> æ‰©å±•ç”Ÿæˆå™¨ã€‚</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">npm install -g yo@5 generator-code
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼Œä½¿ç”¨ <code>yo</code> æœ€æ–°çš„ <code>6.0.0</code> ç‰ˆæœ¬è¿è¡Œ <code>yo</code> å‘½ä»¤ä¼šæŠ¥é”™ï¼Œå› æ­¤è¿™é‡ŒæŒ‡å®šå®‰è£… <code>5</code> ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p>å®‰è£…å®Œæˆåï¼Œè¿è¡Œ <code>yo code</code> å‘½ä»¤ï¼Œåˆå§‹åŒ–é¡¹ç›®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">yo code
</code></pre>
<p>è¿™é‡ŒæŒ‰æç¤ºå³å¯ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ <code>pnpm + Typescript</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6571f5eb0ef249ac9199dc321c5d75c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=j0VVKybvWZ1Ba86kwjE6WbI1gS0%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸»è¦é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">my-vscode-extension/
â”œâ”€â”€ .vscode/            <span class="hljs-comment"># VS Code è°ƒè¯•é…ç½®</span>
â”‚   â”œâ”€â”€ launch.json
â”‚   â””â”€â”€ tasks.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ <span class="hljs-built_in">test</span>/           <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”‚   â””â”€â”€ extension.ts    <span class="hljs-comment"># æ’ä»¶ä¸»å…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ .gitignore          <span class="hljs-comment"># git å¿½ç•¥æ–‡ä»¶</span>
â”œâ”€â”€ .npmrc              <span class="hljs-comment"># npm é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ .vscode-test.mjs    <span class="hljs-comment"># å•æµ‹é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ .vscodeignore       <span class="hljs-comment"># æ’ä»¶å‘å¸ƒå¿½ç•¥æ–‡ä»¶</span>
â”œâ”€â”€ package.json        <span class="hljs-comment"># é¡¹ç›®ä¾èµ–ç®¡ç†æ–‡ä»¶</span>
â”œâ”€â”€ tsconfig.json       <span class="hljs-comment"># TypeScript é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ eslint.config.mjs   <span class="hljs-comment"># Eslint é…ç½®æ–‡ä»¶</span>
â””â”€â”€ README.md
</code></pre>
<p>ä»‹ç»ä¸€ä¸‹ <code>package.json</code> ä¸­æä¾›çš„å‡ ä¸ªé‡è¦å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vscode:prepublish"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm run compile"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"compile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc -p ./"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"watch"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc -watch -p ./"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pretest"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm run compile &amp;&amp; pnpm run lint"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint src"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vscode-test"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li><code>npm run compile</code>ï¼šç¼–è¯‘ TypeScript ä»£ç ã€‚</li>
<li><code>npm run watch</code>ï¼šç›‘å¬ TypeScript æ–‡ä»¶å˜åŒ–å¹¶å®æ—¶ç¼–è¯‘ã€‚</li>
<li><code>npm run test</code>ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ã€‚</li>
</ul>
<p>å¦å¤–æ˜¯ <code>package.json</code> ä¸­æä¾›çš„æ’ä»¶å‘½ä»¤ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"contributes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"commands"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-vscode-extension.helloWorld"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Hello World"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åœ¨é»˜è®¤æä¾›çš„ <code>demo</code> ä¸­ï¼Œæ’ä»¶å‘½ä»¤åå­—å« <code>hello world</code>ã€‚</p>
<h2 data-id="heading-2">2ã€è°ƒè¯•æ’ä»¶</h2>
<p>åœ¨è°ƒè¯•æ’ä»¶å‰ï¼Œéœ€è¦å…ˆè¿è¡Œä¸‹ <code>npm run compile</code> ç¼–è¯‘ TypeScript ä»£ç ï¼Œç»ç¼–è¯‘åä¼šç”Ÿæˆ <code>out/</code> æ–‡ä»¶ï¼Œç„¶åä¾¿å¯ä»¥å¼€å§‹è°ƒè¯•äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦å…ˆç¼–è¯‘å‘¢ï¼Ÿå› ä¸ºåœ¨ <code>package.json</code> ä¸­å®šä¹‰äº†æ’ä»¶è¿è¡Œçš„å…¥å£æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ <code>main</code> å­—æ®µï¼Œé»˜è®¤å€¼ä¸º <code>./out/extension.js</code>ï¼Œæ‰€ä»¥å¦‚æœä¸å…ˆç¼–è¯‘ç”Ÿæˆ <code>out/</code> æ–‡ä»¶æ˜¯ä¼šè¿è¡ŒæŠ¥é”™çš„ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./out/extension.js"</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æœ‰ä¸¤ç§å¯åŠ¨è°ƒè¯•çš„æ–¹å¼ï¼š</p>
<ol>
<li>æŒ‰å¿«æ·é”® <code>F5</code>ã€‚</li>
<li>ç‚¹å‡»ç¼–è¾‘å™¨å·¦ä¸‹æ–¹çš„ <code>Run Extensionï¼ˆæ’ä»¶åï¼‰</code>ã€‚</li>
</ol>
<p>å¯åŠ¨åï¼Œä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªæ–°çš„ VS Code çª—å£ï¼Œå¹¶å¯åŠ¨è°ƒè¯•æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¯¥çª—å£ä¸­è°ƒè¯•æ’ä»¶ã€‚</p>
<p>å…ˆæŒ‰ <code>Ctrl/Command + Shift + P</code>ï¼Œè¾“å…¥ <code>hello word</code>ï¼Œä¼šå‘ç°æ‰¾ä¸åˆ°å‘½ä»¤ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b98cfcd4c5984c94aef3b4110dfd92b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=gCp%2Ft4IeRIKlioX6GqZVLg6km5Y%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæ˜¯å› ä¸ºæˆ‘ä»¬æœ¬åœ°å®‰è£…çš„ vscode ç‰ˆæœ¬ä¸ç¬¦åˆæ’ä»¶è¦æ±‚ï¼Œæˆ‘ä»¬åœ¨ <code>package.json</code> æ‰¾åˆ°å¦‚ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"engines"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vscode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.107.0"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶åæˆ‘ä»¬å†æŸ¥çœ‹ä¸‹æœ¬æœºçš„ vscode ç‰ˆæœ¬ï¼Œ<code>Code -&gt; About VisualStdio Code</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/665dea952ca64a76b34400dceb7dbda2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=bWeHEXyFKUFY75b17DZd8HPyito%3D" alt="" loading="lazy"/></p>
<p>å‘ç°æˆ‘ä»¬æœ¬åœ°ç‰ˆæœ¬ä¸º <code>1.105.1</code>ï¼Œä¸æ»¡è¶³ <code>^1.107.0</code>ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠ <code>engines.vscode</code> ä¿®æ”¹ä¸º <code>^1.105.0</code>ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"engines"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vscode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.105.0"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å†é€šè¿‡ <code>F5</code> æˆ–è€…å·¦ä¸‹è§’ <code>Run Extension</code> å¯åŠ¨è°ƒè¯•ï¼ŒæŒ‰ <code>Ctrl/Command + Shift + P</code>ï¼Œè¾“å…¥<code>hello world</code>ï¼Œå°±èƒ½çœ‹åˆ°å‘½ä»¤äº†ã€‚è¿™ä¸ª <code>hello world</code> å°±å¯¹åº”æˆ‘ä»¬ä¸Šé¢è¯´çš„ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>contributes.commands.title</code> å­—æ®µã€‚</p>
<p>æˆåŠŸè¿è¡Œåï¼Œä¼šåœ¨ç¼–è¾‘å™¨å³ä¸‹è§’çœ‹åˆ°å¦‚ä¸‹æç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ac8da8ab49e415e8959fc7a3b63f2de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=VHfq2ZjmjWH0cx7MiVRnEEm3uKA%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªæç¤ºå°±æ˜¯å¯¹åº” <code>src/extension.ts</code> çš„å¦‚ä¸‹ä»£ç ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/145e2cfeeca54fac80964d058b5c5b1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=pN%2FYBYxTEGFTVOn1A0O8JzWUP0Q%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç¼–å†™æ’ä»¶çš„å…·ä½“åŠŸèƒ½äº†ã€‚</p>
<h2 data-id="heading-3">3ã€ç¼–å†™æ’ä»¶æ ¸å¿ƒé€»è¾‘</h2>
<p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ï¼Œå¹³æ—¶æˆ‘ä»¬å†™ä»£ç æ—¶ï¼Œç»å¸¸ä¼šå†™ <code>console.log</code>ï¼Œå¦‚æœæ¯æ¬¡éƒ½å†™è¿™ä¸ªå¤ªéº»çƒ¦äº†ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å®ç°ä¸‹é¢çš„åŠŸèƒ½ï¼š</p>
<ol>
<li>é€šè¿‡å¿«æ·é”®ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆ <code>console.log</code> è¯­å¥ã€‚</li>
<li>å…‰æ ‡é€‰ä¸­å˜é‡å¹¶æŒ‰ä¸‹å¿«æ·é”®æ—¶ï¼Œèƒ½æŠŠå˜é‡åä¹Ÿæ˜¾ç¤ºå‡ºæ¥ã€‚</li>
</ol>
<h3 data-id="heading-4">3.1 ä¿®æ”¹ package.jsonï¼Œå®šä¹‰æ’ä»¶åå­—ã€æè¿°å’Œå¿«æ·é”®</h3>
<p>å®šä¹‰åå­— <code>name</code>ï¼Œæè¿° <code>description</code>ï¼Œå¿«æ·é”® <code>keybindings</code>ï¼Œé€šè¿‡ <code>ctrl/command+alt+l</code> å¯ä»¥è¿è¡Œæ’ä»¶ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"log-util"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"displayName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"log-util"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"generate log statement"</span><span class="hljs-punctuation">,</span>
   <span class="hljs-attr">"contributes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"commands"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"log-util.logUtil"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"log util"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"keybindings"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"log-util.logUtil"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ctrl+alt+l"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"mac"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cmd+alt+l"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"editorTextFocus"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-5">3.2 æ ¸å¿ƒåŠŸèƒ½ä»£ç </h3>
<p>ä¿®æ”¹ <code>src/extension.ts</code> æ–‡ä»¶ï¼Œå®ç°æ’ä»¶åŠŸèƒ½ã€‚</p>
<p>å…ˆå®ç°ç¬¬ä¸€æ­¥ï¼Œå¿«é€Ÿç”Ÿæˆ <code>console.log</code> è¯­å¥ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> vscode <span class="hljs-keyword">from</span> <span class="hljs-string">"vscode"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">activate</span>(<span class="hljs-params">context: vscode.ExtensionContext</span>) {
  <span class="hljs-keyword">const</span> disposable = vscode.<span class="hljs-property">commands</span>.<span class="hljs-title function_">registerCommand</span>(
    <span class="hljs-string">"log-util.logUtil"</span>,
    <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> editor = vscode.<span class="hljs-property">window</span>.<span class="hljs-property">activeTextEditor</span>;
      <span class="hljs-keyword">if</span> (!editor) {
        vscode.<span class="hljs-property">window</span>.<span class="hljs-title function_">showWarningMessage</span>(<span class="hljs-string">"æ²¡æœ‰æ‰“å¼€çš„ç¼–è¾‘å™¨"</span>);
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-comment">// è·å–é…ç½®</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">getConfig</span> = (<span class="hljs-params"/>) =&gt;
        vscode.<span class="hljs-property">workspace</span>.<span class="hljs-title function_">getConfiguration</span>(<span class="hljs-string">"consoleLogGenerator"</span>);
      <span class="hljs-keyword">const</span> config = <span class="hljs-title function_">getConfig</span>();
      <span class="hljs-keyword">const</span> logType = config.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"logType"</span>, <span class="hljs-string">"log"</span>);
      <span class="hljs-keyword">const</span> prefix = config.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"logPrefix"</span>, <span class="hljs-string">"ğŸš€ ~ "</span>);

      <span class="hljs-keyword">const</span> position = editor.<span class="hljs-property">selection</span>.<span class="hljs-property">active</span>;

      <span class="hljs-keyword">const</span> <span class="hljs-variable language_">document</span> = editor.<span class="hljs-property">document</span>;
      <span class="hljs-keyword">const</span> selection = editor.<span class="hljs-property">selection</span>;
      <span class="hljs-keyword">const</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getText</span>(selection);

      <span class="hljs-keyword">const</span> statement = <span class="hljs-string">`console.<span class="hljs-subst">${logType}</span>('<span class="hljs-subst">${prefix}</span>:', );`</span>;

      editor
        .<span class="hljs-title function_">edit</span>(<span class="hljs-function">(<span class="hljs-params">editBuilder</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> insertPosition = <span class="hljs-keyword">new</span> vscode.<span class="hljs-title class_">Position</span>(position.<span class="hljs-property">line</span>, position.<span class="hljs-property">character</span> + <span class="hljs-number">1</span>);
          editBuilder.<span class="hljs-title function_">insert</span>(insertPosition, statement);
        })
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (success) {
            <span class="hljs-comment">// è®¾ç½®å…‰æ ‡ä½ç½®</span>
            <span class="hljs-keyword">const</span> newPosition = <span class="hljs-keyword">new</span> vscode.<span class="hljs-title class_">Position</span>(position.<span class="hljs-property">line</span>, statement.<span class="hljs-property">length</span> + position.<span class="hljs-property">character</span> - <span class="hljs-number">2</span>);
            editor.<span class="hljs-property">selection</span> = <span class="hljs-keyword">new</span> vscode.<span class="hljs-title class_">Selection</span>(newPosition, newPosition);
          }
        });
    }
  );

  context.<span class="hljs-property">subscriptions</span>.<span class="hljs-title function_">push</span>(disposable);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">deactivate</span>(<span class="hljs-params"/>) {}

</code></pre>
<p>ç„¶åå®ç°ç¬¬äºŒæ­¥ï¼Œå¢åŠ å¯¹å…‰æ ‡é€‰ä¸­å˜é‡çš„å¤„ç†ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">		 // è·å–å˜é‡å
<span class="hljs-addition">+   let variableName = text.trim();</span>
<span class="hljs-deletion">-   const statement = `console.${logType}('${prefix}:', );`;</span>
<span class="hljs-addition">+   const statement = `console.${logType}('${prefix}${variableName ? ` â†’  ${variableName}` : ''}:', ${variableName});`;</span>
  
    editor.edit(editBuilder =&gt; {
<span class="hljs-deletion">-     const insertPosition = new vscode.Position(position.line, position.character + 1);</span>
<span class="hljs-addition">+     const insertPosition = new vscode.Position(position.line + (variableName ? 1 : 0), variableName ? 0 : position.character + 1);</span>
<span class="hljs-addition">+     if (variableName) {</span>
<span class="hljs-addition">+       editBuilder.insert(insertPosition, '\n');</span>
<span class="hljs-addition">+     }</span>
      editBuilder.insert(insertPosition, statement);
    }).then(success =&gt; {
        if (success) {
          // è®¾ç½®å…‰æ ‡ä½ç½®
<span class="hljs-deletion">-         const newPosition = new vscode.Position(position.line, statement.length + position.character - 2);</span>
<span class="hljs-addition">+         const newPosition = new vscode.Position(position.line + (variableName ? 1 : 0), variableName ? statement.length : statement.length + position.character - 2);</span>
          editor.selection = new vscode.Selection(newPosition, newPosition);
			}
		});
</code></pre>
<p>æµ‹è¯•æ’ä»¶åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸš€ ~  â†’  path:'</span>, path); <span class="hljs-comment">// å…‰æ ‡é€‰ä¸­ä¸Šä¸€è¡Œçš„ path å˜é‡ï¼ŒæŒ‰ ctrl/command+alt+l ç”Ÿæˆ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸš€ ~ :'</span>, ); <span class="hljs-comment">// åœ¨å½“å‰è¡ŒæŒ‰ ctrl/command+alt+l ç”Ÿæˆ</span>
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f0ff80370884bd7b277b9d33fa361da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=BL3NsZoOVJiaxzbf1g308uS3PF8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">4ã€å‘å¸ƒæ’ä»¶</h2>
<ol>
<li>
<p>è¿›å…¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2F" target="_blank" title="https://marketplace.visualstudio.com/" ref="nofollow noopener noreferrer">è¿™ä¸ªç½‘ç«™</a>ï¼Œç‚¹å‡» <code>Sign in</code>ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªå¼€å‘è€…è´¦å·ã€‚</p>
</li>
<li>
<p>ç‚¹å‡» <code>Public extensions</code>ï¼ŒæŒ‰ç…§æç¤ºä¸€æ­¥æ­¥å‘å¸ƒå³å¯ã€‚</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8cf7f44940e439899097cebd21e173f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766534881&amp;x-signature=5L185gIJAA%2BOUS99N5qDEwx0ZO0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">å°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å¦‚ä½•ç¼–å†™ä¸€ä¸ªç®€å•çš„ VSCode æ’ä»¶ï¼Œä»å¼€å‘åˆ°å‘å¸ƒå…¨æµç¨‹ï¼š</p>
<ol>
<li>å®‰è£… <code>yo</code> å’Œ <code>generator-code</code>ã€‚</li>
<li>è¿è¡Œ <code>yo code</code> å‘½ä»¤ç”Ÿæˆæ’ä»¶é¡¹ç›®ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©æ’ä»¶çš„å¼€å‘è¯­è¨€ï¼Œå®šä¹‰æ’ä»¶çš„åç§°ã€æè¿°ç­‰ã€‚</li>
<li>ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶ï¼Œå¯ä»¥ä¿®æ”¹æ’ä»¶çš„åç§°ã€æè¿°ã€å…¥å£æ–‡ä»¶ï¼Œå®šä¹‰æ’ä»¶çš„å¿«æ·é”®ã€‚å¹¶è¦æ³¨æ„è®¾ç½® <code>engines.vscode</code> å­—æ®µï¼ŒæŒ‡å®šæ’ä»¶æ”¯æŒçš„ VSCode ç‰ˆæœ¬ã€‚</li>
<li>åœ¨ <code>src/extension.ts</code> æ–‡ä»¶ä¸­ç¼–å†™æ’ä»¶é€»è¾‘ã€‚</li>
<li>è¿è¡Œ <code>npm run compile</code> ç¼–è¯‘æ’ä»¶ï¼Œæˆ–è€…è¿è¡Œ <code>npm run watch</code> ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶ç¼–è¯‘ã€‚</li>
<li>æŒ‰å¿«æ·é”® <code>F5</code>ï¼Œæˆ–è€…ç‚¹å‡»ç¼–è¾‘å™¨å·¦ä¸‹æ–¹çš„ <code>Run Extension</code> è¿›è¡Œæ’ä»¶è°ƒè¯•ã€‚</li>
<li>åœ¨è°ƒè¯•çš„æ–°çª—å£ä¸­ï¼Œä½¿ç”¨ <code>Ctrl/Command + Shift + P</code>ï¼Œè¾“å…¥é…ç½®çš„å‘½ä»¤ï¼Œæˆ–è€…æŒ‰é…ç½®çš„å¿«æ·é”®ï¼Œæµ‹è¯•æ’ä»¶åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚</li>
<li>è¿è¡Œ <code>npm run test</code> æµ‹è¯•æ’ä»¶åŠŸèƒ½ã€‚ï¼ˆæœ¬æ–‡æœªæ¶‰åŠåˆ°å•å…ƒæµ‹è¯•ï¼‰</li>
<li>å‘å¸ƒæ’ä»¶ã€‚</li>
</ol>
<p>å¸Œæœ›æœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot3.0æ€§èƒ½ä¼˜åŒ–ï¼šè¿™5ä¸ªå†·é—¨é…ç½®è®©æˆ‘èŠ‚çœäº†40%å†…å­˜å ç”¨]]></title>    <link>https://juejin.cn/post/7584286241488584744</link>    <guid>https://juejin.cn/post/7584286241488584744</guid>    <pubDate>2025-12-17T00:17:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584286241488584744" data-draft-id="7584319403858755619" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot3.0æ€§èƒ½ä¼˜åŒ–ï¼šè¿™5ä¸ªå†·é—¨é…ç½®è®©æˆ‘èŠ‚çœäº†40%å†…å­˜å ç”¨"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-17T00:17:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot3.0æ€§èƒ½ä¼˜åŒ–ï¼šè¿™5ä¸ªå†·é—¨é…ç½®è®©æˆ‘èŠ‚çœäº†40%å†…å­˜å ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:17:49.000Z" title="Wed Dec 17 2025 00:17:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>SpringBoot3.0æ€§èƒ½ä¼˜åŒ–ï¼šè¿™5ä¸ªå†·é—¨é…ç½®è®©æˆ‘èŠ‚çœäº†40%å†…å­˜å ç”¨</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ç››è¡Œçš„ä»Šå¤©ï¼ŒSpring Boot ä½œä¸º Java ç”Ÿæ€ä¸­æœ€æµè¡Œçš„å¼€å‘æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶æ€§èƒ½è¡¨ç°ç›´æ¥å½±å“ç€ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œèµ„æºåˆ©ç”¨ç‡ã€‚å°½ç®¡ Spring Boot 3.0 åœ¨é»˜è®¤é…ç½®ä¸Šå·²ç»åšäº†å¤§é‡ä¼˜åŒ–ï¼Œä½†åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä»æœ‰ä¸å°‘å¼€å‘è€…å¿½ç•¥äº†æŸäº›â€œå†·é—¨â€é…ç½®é¡¹ï¼Œå¯¼è‡´å†…å­˜å ç”¨å±…é«˜ä¸ä¸‹ã€‚</p>
<p>æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨ä¸€ä¸ªé«˜å¹¶å‘é¡¹ç›®ä¸­é€šè¿‡è°ƒæ•´ <strong>5 ä¸ªé²œä¸ºäººçŸ¥çš„ Spring Boot 3.0 é…ç½®é¡¹</strong>ï¼ŒæˆåŠŸå‡å°‘ <strong>40% å†…å­˜å ç”¨</strong>çš„ç»éªŒã€‚è¿™äº›ä¼˜åŒ–ä¸ä»…é€‚ç”¨äºæ–°é¡¹ç›®ï¼Œä¹Ÿèƒ½ä¸ºç°æœ‰ç³»ç»Ÿæä¾›æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. è°ƒæ•´ JVM åƒåœ¾å›æ”¶å™¨ï¼šä» Parallel GC åˆ‡æ¢åˆ° ZGC</h3>
<h4 data-id="heading-4">é—®é¢˜èƒŒæ™¯</h4>
<p>Spring Boot é»˜è®¤ä½¿ç”¨ Parallel GCï¼ˆå¹¶è¡Œåƒåœ¾å›æ”¶å™¨ï¼‰ï¼Œè™½ç„¶ååé‡é«˜ï¼Œä½†åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹å®¹æ˜“å¯¼è‡´è¾ƒé•¿çš„ STWï¼ˆStop-The-Worldï¼‰åœé¡¿å’Œè¾ƒé«˜çš„å†…å­˜å ç”¨ã€‚</p>
<h4 data-id="heading-5">ä¼˜åŒ–æ–¹æ¡ˆ</h4>
<p>åˆ‡æ¢åˆ° <strong>ZGCï¼ˆZ Garbage Collectorï¼‰</strong>ï¼Œè¿™æ˜¯ä¸€ç§ä½å»¶è¿Ÿã€å¯æ‰©å±•çš„åƒåœ¾å›æ”¶å™¨ï¼Œå°¤å…¶é€‚åˆå †å†…å­˜è¾ƒå¤§çš„åº”ç”¨ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># application.properties</span>
spring.jvm.gc.type=zgc
</code></pre>
<p>æˆ–è€…é€šè¿‡å¯åŠ¨å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">java -XX:+UseZGC -jar your-application.jar
</code></pre>
<h4 data-id="heading-6">æ•ˆæœéªŒè¯</h4>
<ul>
<li><strong>å†…å­˜å ç”¨ä¸‹é™</strong>ï¼šZGC çš„åˆ†ä»£å‹ç¼©ç‰¹æ€§å‡å°‘äº†å †å†…å­˜ç¢ç‰‡ï¼Œé™ä½äº†æ•´ä½“å ç”¨ã€‚</li>
<li><strong>å»¶è¿Ÿé™ä½</strong>ï¼šSTW æ—¶é—´ä»åŸæ¥çš„ 200ms+ é™è‡³ &lt;1msã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šZGC éœ€è¦ JDK 17+ï¼Œä¸”å¯¹ Windows/macOS çš„æ”¯æŒè¾ƒå¼±ï¼Œå»ºè®®åœ¨ Linux ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">2. ç¦ç”¨ä¸å¿…è¦çš„ Actuator Endpoints</h3>
<h4 data-id="heading-8">é—®é¢˜èƒŒæ™¯</h4>
<p>Spring Boot Actuator æ˜¯ç›‘æ§å’Œç®¡ç†åº”ç”¨çš„åˆ©å™¨ï¼Œä½†é»˜è®¤å¯ç”¨çš„ç«¯ç‚¹ï¼ˆå¦‚ <code>heapdump</code>ã€<code>env</code>ï¼‰ä¼šå ç”¨é¢å¤–å†…å­˜ï¼Œå°¤å…¶æ˜¯ <code>heapdump</code> åœ¨è§¦å‘æ—¶å¯èƒ½å¯¼è‡´ç¬æ—¶ OOMã€‚</p>
<h4 data-id="heading-9">ä¼˜åŒ–æ–¹æ¡ˆ</h4>
<p>ä»…å¯ç”¨å¿…è¦çš„ç«¯ç‚¹ï¼š</p>
<pre><code class="hljs language-properties" lang="properties"># application.properties
management.endpoints.web.exposure.include=health,metrics,info
management.endpoint.health.probes.enabled=true
management.endpoint.heapdump.enabled=false
</code></pre>
<h4 data-id="heading-10">æ•ˆæœéªŒè¯</h4>
<ul>
<li><strong>å†…å­˜èŠ‚çœ</strong>ï¼šç¦ç”¨ <code>heapdump</code> åå‡å°‘çº¦ <strong>50MB</strong> å¸¸é©»å†…å­˜ã€‚</li>
<li><strong>å®‰å…¨æ€§æå‡</strong>ï¼šé¿å…æ•æ„Ÿä¿¡æ¯é€šè¿‡ <code>/actuator/env</code>æ³„éœ²ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-11">3. Spring MVC/WebFluxï¼šä¼˜åŒ–é™æ€èµ„æºå¤„ç†ç­–ç•¥</h3>
<h4 data-id="heading-12">é—®é¢˜èƒŒæ™¯</h4>
<p>Spring Boot WebFlux/MVCä¼šç¼“å­˜é™æ€èµ„æºï¼ˆå¦‚JS/CSSï¼‰çš„è§£æç»“æœä»¥æé«˜æ€§èƒ½,ä½†è¿™å¯¹äºçº¯APIæœåŠ¡æ˜¯å¤šä½™çš„ã€‚</p>
<p>####ä¼˜åŒ–æ–¹æ¡ˆ<br/>
é’ˆå¯¹API-onlyæœåŠ¡,å®Œå…¨å…³é—­é™æ€èµ„æºå¤„ç†:</p>
<pre><code class="hljs language-properties" lang="properties"># application.properties 
spring.web.resources.add-mappings=false

# WebFluxé¢å¤–é…ç½®(å¦‚æœä½¿ç”¨)
spring.webflux.static-path-pattern=/nonexistent-path/
</code></pre>
<p>####æ•ˆæœéªŒè¯</p>
<ul>
<li><strong>å¯åŠ¨é€Ÿåº¦æå‡</strong>:å‡å°‘çº¦20%çš„å¯åŠ¨æ—¶é—´(å®æµ‹ä»4sâ†’3.2s)</li>
<li><strong>å¸¸é©»å†…å­˜ä¸‹é™</strong>:èŠ‚çœ30-50MB Metaspaceå ç”¨</li>
</ul>
<hr/>
<p>###4. JPA/HibernateäºŒçº§ç¼“å­˜è°ƒä¼˜</p>
<p>####é—®é¢˜èƒŒæ™¯<br/>
HibernateäºŒçº§ç¼“å­˜é»˜è®¤ä½¿ç”¨EHCache,ä½†å…¶å †å¤–å†…å­˜ç®¡ç†è¾ƒå·®,å®¹æ˜“é€ æˆNative Memoryæ³„æ¼ã€‚</p>
<p>####ä¼˜åŒ–æ–¹æ¡ˆ<br/>
æ”¹ç”¨Caffeineä½œä¸ºäºŒçº§ç¼“å­˜å®ç°:</p>
<pre><code class="hljs language-properties" lang="properties"># application.properties
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory
spring.jpa.properties.javax.persistence.sharedCache.mode=ENABLE_SELECTIVE

# pom.xmléœ€æ·»åŠ ä¾èµ–
&lt;dependency&gt;
    &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt;
    &lt;artifactId&gt;jcache&lt;/artifactId&gt;
    &lt;version&gt;3.1.8&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>åŒæ—¶é…ç½®Caffeineç¼“å­˜ç­–ç•¥:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
 <span class="hljs-attr">cache:</span>
   <span class="hljs-attr">caffeine:</span>
     <span class="hljs-attr">spec:</span> <span class="hljs-string">maximumSize=5000,expireAfterWrite=30m</span>
</code></pre>
<p>####æ•ˆæœéªŒè¯</p>
<ul>
<li><strong>GCå‹åŠ›é™ä½</strong>:ç›¸æ¯”EHCacheå‡å°‘70%çš„GCæ¬¡æ•°(YMMV)</li>
<li><strong>æŸ¥è¯¢æ€§èƒ½æå‡</strong>:é«˜é¢‘æŸ¥è¯¢å“åº”æ—¶é—´ç¼©çŸ­15%</li>
</ul>
<hr/>
<p>###5.Tomcat/Undertowçº¿ç¨‹æ¨¡å‹ä¼˜åŒ–</p>
<p>####é—®é¢˜èƒŒæ™¯<br/>
SpringBooté»˜è®¤ä½¿ç”¨Tomcatä¸”å·¥ä½œçº¿ç¨‹æ•°=200,è¿™å¯¹äºIOå¯†é›†å‹æœåŠ¡æ˜¯ä¸¥é‡æµªè´¹ã€‚</p>
<p>####ä¼˜åŒ–æ–¹æ¡ˆ<br/>
åˆ‡æ¢åˆ°Undertowå¹¶ç²¾ç»†åŒ–é…ç½®:</p>
<pre><code class="hljs language-properties" lang="properties"># application.properties
server.undertow.io-threads=4      # CPUæ ¸å¿ƒæ•°Ã—1~2 
server.undertow.worker-threads=20 # CPUæ ¸å¿ƒæ•°Ã—5~10 
server.compression.enabled=true   #å¯ç”¨å“åº”å‹ç¼©é™ä½ç½‘ç»œå¼€é”€

# Mavenä¾èµ–æ’é™¤Tomcat 
&lt;exclusions&gt;
    &lt;exclusion&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
    &lt;/exclusion&gt;
&lt;/exclusions&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-undertow&lt;/artifactId&gt;
&lt;/dependency&gt; 
</code></pre>
<p>####æ•ˆæœéªŒè¯</p>
<ul>
<li><strong>å†…å­˜ä¸‹é™æ˜¾è‘—</strong>:ç›¸æ¯”TomcatèŠ‚çœ100MB+å†…å­˜(ç›¸åŒå¹¶å‘é‡ä¸‹)</li>
<li><strong>ååé‡æå‡</strong>:åœ¨IOå¯†é›†å‹åœºæ™¯QPSæé«˜18%</li>
</ul>
<hr/>
<p>##æ€»ç»“</p>
<p>é€šè¿‡ä¸Šè¿°5ä¸ªæ–¹å‘çš„ä¼˜åŒ–ï¼š</p>
<ol>
<li>ZGCæ›¿ä»£Parallel GC â†’é™ä½å»¶è¿Ÿ&amp;å†…å­˜ç¢ç‰‡<br/>
2.ç²¾ç®€Actuatorç«¯ç‚¹ â†’æ¶ˆé™¤ç›‘æ§ç»„ä»¶å†—ä½™æ¶ˆè€—<br/>
3.å…³é—­é™æ€èµ„æºå¤„ç† â†’ä¸“ç²¾APIæœåŠ¡åœºæ™¯<br/>
4.Caffeineæ›¿æ¢EHCache â†’é«˜æ•ˆç¼“å­˜ç®¡ç†<br/>
5.Undertowçº¿ç¨‹è°ƒä¼˜ â†’åŒ¹é…å®é™…å·¥ä½œè´Ÿè½½</li>
</ol>
<p>æœ€ç»ˆæˆ‘ä»¬çš„è®¢å•æœåŠ¡åœ¨åŒç­‰æµé‡ä¸‹ï¼š
â–¸å †å†…å­˜å ç”¨ä»2.1GBâ†’1.3GB(-38%)<br/>
â–¸Full GCé¢‘ç‡ä»æ¯å¤©50+æ¬¡â†’å®Œå…¨æ¶ˆå¤±</p>
<p>è¿™äº›ä¼˜åŒ–è¯æ˜ï¼šSpringBootçš„é»˜è®¤é…ç½®å¹¶éæ”¾ä¹‹å››æµ·è€Œçš†å‡†ã€‚æ ¹æ®å®é™…ä¸šåŠ¡ç‰¹ç‚¹è¿›è¡Œé’ˆå¯¹æ€§è°ƒå‚,å¾€å¾€èƒ½æ”¶è·æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚å»ºè®®å¼€å‘è€…åœ¨æ€§èƒ½æµ‹è¯•é˜¶æ®µç”¨JProfilerç­‰å·¥å…·æŒç»­è§‚æµ‹,æ‰¾åˆ°æœ€é€‚åˆè‡ªå·±åº”ç”¨çš„é»„é‡‘é…ç½®ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP å€¼å¯¹è±¡å®æˆ˜æŒ‡å—ï¼šé¿å…åŸå§‹ç±»å‹åæ‰§]]></title>    <link>https://juejin.cn/post/7584353612500697129</link>    <guid>https://juejin.cn/post/7584353612500697129</guid>    <pubDate>2025-12-17T00:24:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584353612500697129" data-draft-id="7584353612500680745" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP å€¼å¯¹è±¡å®æˆ˜æŒ‡å—ï¼šé¿å…åŸå§‹ç±»å‹åæ‰§"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-12-17T00:24:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP å€¼å¯¹è±¡å®æˆ˜æŒ‡å—ï¼šé¿å…åŸå§‹ç±»å‹åæ‰§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:24:01.000Z" title="Wed Dec 17 2025 00:24:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP å€¼å¯¹è±¡å®æˆ˜æŒ‡å—ï¼šé¿å…åŸå§‹ç±»å‹åæ‰§</h2>
<p>ä¸Šä¸€ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬èŠäº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-12%2Fprimitive-obsession-in-php" target="_blank" title="https://catchadmin.com/post/2025-12/primitive-obsession-in-php" ref="nofollow noopener noreferrer">åŸå§‹ç±»å‹åæ‰§ï¼ˆPrimitive Obsessionï¼‰</a>åœ¨ PHP é‡Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¸¸è§ï¼šé‚®ç®±ã€é‡‘é¢ã€æ—¥æœŸã€IDâ€¦â€¦ç»Ÿç»Ÿç”¨ string/int/float/array ä¼ æ¥ä¼ å»ã€‚é¢†åŸŸå«ä¹‰è¢«æŠ¹å¹³ï¼Œæ ¡éªŒé€»è¾‘æ•£è½åœ¨å„å¤„ï¼Œä»£ç è¶Šå†™è¶Šéš¾æ”¹ã€‚</p>
<p>è¿™ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­å¾€ä¸‹èµ°ï¼šå€¼å¯¹è±¡ï¼ˆValue Objectï¼‰ä¸ä»…èƒ½è®©ä»£ç æ›´æ¸…æ™°ï¼Œè¿˜èƒ½è®©åä½œã€æµ‹è¯•å’Œåç»­æ¼”è¿›éƒ½æ›´çœå¿ƒã€‚ä¸ç®¡ä½ ç”¨çš„æ˜¯ Laravelã€Symfony è¿˜æ˜¯åˆ«çš„æ¡†æ¶ï¼Œåªè¦é¡¹ç›®é‡Œæœ‰æ˜ç¡®çš„é¢†åŸŸæ¦‚å¿µï¼Œå€¼å¯¹è±¡éƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-12%2Favoiding-primitive-obsession-in-php-value-objects" target="_blank" title="https://catchadmin.com/post/2025-12/avoiding-primitive-obsession-in-php-value-objects" ref="nofollow noopener noreferrer">åŸæ–‡é“¾æ¥ PHP å€¼å¯¹è±¡å®æˆ˜æŒ‡å—ï¼šé¿å…åŸå§‹ç±»å‹åæ‰§</a></p>
<h3 data-id="heading-1">1. é‡å¤å‡ºç°çš„æ¨¡å¼ï¼šä¸åªæ˜¯ä»£ç å‘³é“</h3>
<p>åœ¨ PHP é¡¹ç›®é‡Œï¼ŒæŸäº›è§„åˆ™ä¼šåå¤å‡ºç°ã€‚æ—¥æœŸå°±æ˜¯å…¸å‹ä¾‹å­ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerEvent</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$eventDate</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$timeZone</span></span>): <span class="hljs-title">void</span>
</span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">'/^\d{4}-\d{2}-\d{2}$/'</span>, <span class="hljs-variable">$eventDate</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid date format.'</span>);
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$timeZone</span>, <span class="hljs-title class_">DateTimeZone</span>::<span class="hljs-title function_ invoke__">listIdentifiers</span>())) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid time zone.'</span>);
    }
    <span class="hljs-comment">// More logic here...</span>
}
</code></pre>
<p>è¿™é‡Œçš„æ—¥æœŸå’Œæ—¶åŒºéƒ½ç”¨ string è¡¨ç¤ºã€‚é—®é¢˜åœ¨äºï¼šä¸€æ—¦æ—¥æœŸæ ¼å¼è¦æ”¹ã€æˆ–è€…æ—¶åŒºè§„åˆ™æœ‰å˜åŒ–ï¼Œä½ å°±ä¼šå¼€å§‹åœ¨å„ä¸ªè§’è½å¤åˆ¶ç²˜è´´åŒæ ·çš„éªŒè¯é€»è¾‘â€”â€”æ¼ä¸€å¤„å°±å‡ºäº‹æ•…ã€‚</p>
<h3 data-id="heading-2">2. å€¼å¯¹è±¡ç™»åœºï¼šDate å’Œ TimeZone</h3>
<p>ä¸å…¶åœ¨æ¯ä¸ªå…¥å£éƒ½æ‰‹å†™æ ¡éªŒï¼Œä¸å¦‚æŠŠâ€œæ—¥æœŸâ€â€œæ—¶åŒºâ€åšæˆå€¼å¯¹è±¡ï¼Œè®©å®ƒä»¬è‡ªå·±ä¿è¯åˆæ³•æ€§ã€‚</p>
<h4 data-id="heading-3">2.1 Date å€¼å¯¹è±¡</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Date</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$value</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$date</span></span>)
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">'/^\d{4}-\d{2}-\d{2}$/'</span>, <span class="hljs-variable">$date</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid date format.'</span>);
        }
        <span class="hljs-variable language_">$this</span>-&gt;value = <span class="hljs-variable">$date</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$date</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-variable">$date</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">value</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;value;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;value;
    }
}
</code></pre>
<h4 data-id="heading-4">2.2 TimeZone å€¼å¯¹è±¡</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeZone</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$value</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$timeZone</span></span>)
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$timeZone</span>, <span class="hljs-title class_">DateTimeZone</span>::<span class="hljs-title function_ invoke__">listIdentifiers</span>())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid time zone.'</span>);
        }
        <span class="hljs-variable language_">$this</span>-&gt;value = <span class="hljs-variable">$timeZone</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$timeZone</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-variable">$timeZone</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">value</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;value;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;value;
    }
}
</code></pre>
<h4 data-id="heading-5">2.3 åœ¨ä¸šåŠ¡é‡Œæ€ä¹ˆç”¨</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerEvent</span>(<span class="hljs-params">Date <span class="hljs-variable">$eventDate</span>, TimeZone <span class="hljs-variable">$timeZone</span></span>): <span class="hljs-title">void</span>
</span>{
    <span class="hljs-comment">// No need for repetitive validation</span>
    <span class="hljs-comment">// Logic continues...</span>
}
</code></pre>
<p>å‚æ•°ä¸€çœ¼å°±èƒ½çœ‹æ‡‚ï¼Œè€Œä¸”éªŒè¯é€»è¾‘åªå­˜åœ¨ä¸€ä»½ï¼šåœ¨å€¼å¯¹è±¡é‡Œã€‚</p>
<h3 data-id="heading-6">3. ç»™å€¼å¯¹è±¡åŠ ä¸Šè¡Œä¸º</h3>
<p>å€¼å¯¹è±¡ä¸åªæ˜¯â€œæ›´å¼ºçš„ç±»å‹â€ã€‚å®ƒè¿˜èƒ½æ‰¿è½½å’Œè¿™ä¸ªæ¦‚å¿µç´§å¯†ç›¸å…³çš„è¡Œä¸ºã€‚</p>
<p>æ¯”å¦‚ä½ éœ€è¦åˆ¤æ–­æ´»åŠ¨æ—¥æœŸæ˜¯å¦åœ¨æœªæ¥ï¼Œå¯ä»¥æŠŠé€»è¾‘æ”¾è¿› Dateï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Date</span>
</span>{
    <span class="hljs-comment">// ..</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isInTheFuture</span>(<span class="hljs-params"/>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-variable">$now</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>();
        <span class="hljs-variable">$eventDate</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>(<span class="hljs-variable language_">$this</span>-&gt;value);
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$eventDate</span> &gt; <span class="hljs-variable">$now</span>;
    }
}
</code></pre>
<p>è¿™æ ·å°±ä¸ç”¨åœ¨æ¯ä¸ªç”¨åˆ°æ—¥æœŸçš„åœ°æ–¹éƒ½é‡å¤å†™ä¸€éæ¯”è¾ƒé€»è¾‘ï¼Œä¹Ÿæ›´ç¬¦åˆé¢†åŸŸè¡¨è¾¾ï¼šåˆ¤æ–­æœªæ¥ä¸å¦ï¼Œæœ¬æ¥å°±æ˜¯â€œæ—¥æœŸâ€è¿™ä¸ªæ¦‚å¿µçš„ä¸€éƒ¨åˆ†ã€‚</p>
<h3 data-id="heading-7">4. é‡‘é¢ï¼šç”¨å€¼å¯¹è±¡å®ˆä½ç²¾åº¦</h3>
<p>å¤„ç†é‡‘é¢æ˜¯åŸå§‹ç±»å‹åæ‰§æœ€å®¹æ˜“è¸©å‘çš„åœ°æ–¹ä¹‹ä¸€ã€‚ç”¨ float è¡¨ç¤ºé’±ï¼Œèˆå…¥è¯¯å·®è¿Ÿæ—©ä¼šæ‰¾ä¸Šé—¨ï¼›å†åŠ ä¸Šå¸ç§ã€æ±‡ç‡ï¼Œå¤æ‚åº¦ä¼šè¿…é€Ÿæ‹‰é«˜ã€‚</p>
<p>æŠŠé‡‘é¢åšæˆå€¼å¯¹è±¡ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼š</p>
<ul>
<li>ç”¨æœ€å°å•ä½ï¼ˆæ¯”å¦‚åˆ†ï¼‰æŠŠé‡‘é¢å­˜æˆ int</li>
<li>å¸ç§ä½œä¸ºå­—æ®µå’Œé‡‘é¢ç»‘å®šåœ¨ä¸€èµ·</li>
</ul>
<p>ä¸‹é¢è¿™ä¸ª Money ç¤ºä¾‹è¿›ä¸€æ­¥åŠ ä¸Šäº†æ¢æ±‡çš„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Money</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$amount</span>; <span class="hljs-comment">// Stored in minor units (e.g., cents)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$currency</span>;

    <span class="hljs-comment">// Constructor and other methods...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertToCurrency</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$targetCurrency</span>, <span class="hljs-keyword">float</span> <span class="hljs-variable">$exchangeRate</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-variable">$convertedAmount</span> = (<span class="hljs-keyword">int</span>) <span class="hljs-title function_ invoke__">round</span>(<span class="hljs-variable">$this</span>-&gt;amount * <span class="hljs-variable">$exchangeRate</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-variable">$convertedAmount</span>, <span class="hljs-variable">$targetCurrency</span>);
    }
}
</code></pre>
<p>æŠŠè§„åˆ™å…³åœ¨ Money é‡Œï¼Œä½ çš„ä¸šåŠ¡ä»£ç å°±ä¸ç”¨åˆ°å¤„å…³å¿ƒâ€œè¿™é‡Œæ˜¯åˆ†è¿˜æ˜¯å…ƒâ€â€œå¸ç§å¯¹ä¸å¯¹â€â€œèˆå…¥æ€ä¹ˆåšâ€ã€‚</p>
<h3 data-id="heading-8">5. åœ¨æ¡†æ¶é‡Œè½åœ°</h3>
<p>ä¸€æ—¦ä½ å¼€å§‹ç”¨å€¼å¯¹è±¡ï¼ŒLaravel / Symfony åè€Œä¼šæ›´å¥½ç”¨ï¼šä½ èƒ½æŠŠâ€œåŸå§‹æ•°æ® â†” å€¼å¯¹è±¡â€çš„è½¬æ¢æ”¾åˆ°æ¡†æ¶æ‰©å±•ç‚¹é‡Œï¼Œä¸šåŠ¡å±‚æ‹¿åˆ°çš„å°±éƒ½æ˜¯é¢†åŸŸç±»å‹ã€‚</p>
<h4 data-id="heading-9">5.1 Laravel ç¤ºä¾‹</h4>
<p>Laravel é‡Œå¯ä»¥ç”¨è‡ªå®šä¹‰ castï¼ŒæŠŠæ•°æ®åº“å­—æ®µè‡ªåŠ¨è½¬æˆå€¼å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Contracts</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">CastsAttributes</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyCast</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CastsAttributes</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$model</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$attributes</span></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Money</span>::<span class="hljs-title function_ invoke__">fromInt</span>(<span class="hljs-variable">$value</span>, <span class="hljs-string">'USD'</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">set</span>(<span class="hljs-params"><span class="hljs-variable">$model</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$attributes</span></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$value</span> <span class="hljs-keyword">instanceof</span> Money ? <span class="hljs-variable">$value</span>-&gt;<span class="hljs-title function_ invoke__">amount</span>() : <span class="hljs-variable">$value</span>;
    }
}
</code></pre>
<p>æŠŠè¿™ä¸ª cast æŒ‚åˆ° Eloquent æ¨¡å‹ä¸Šåï¼Œå–å‡ºæ¥çš„å°±æ˜¯ Moneyï¼Œè€Œä¸æ˜¯è£¸å€¼ï¼Œä»£ç ä¼šå¹²å‡€å¾ˆå¤šã€‚</p>
<h4 data-id="heading-10">5.2 Symfony ç¤ºä¾‹</h4>
<p>Symfony é‡Œå¯ä»¥ç”¨ Doctrine çš„ embeddables æˆ–è‡ªå®šä¹‰ DBAL typeï¼ŒæŠŠ Money / EmailAddress è¿™ç±»å¤æ‚ç±»å‹æ˜ å°„åˆ°æ•°æ®åº“ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyType</span> <span class="hljs-keyword">extends</span> \<span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">Types</span>\<span class="hljs-title">Type</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MONEY</span> = <span class="hljs-string">'money'</span>; <span class="hljs-comment">// Custom type name</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertToPHPValue</span>(<span class="hljs-params"><span class="hljs-variable">$value</span>, \Doctrine\DBAL\Platforms\AbstractPlatform <span class="hljs-variable">$platform</span></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Money</span>::<span class="hljs-title function_ invoke__">fromInt</span>(<span class="hljs-variable">$value</span>, <span class="hljs-string">'USD'</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertToDatabaseValue</span>(<span class="hljs-params"><span class="hljs-variable">$value</span>, \Doctrine\DBAL\Platforms\AbstractPlatform <span class="hljs-variable">$platform</span></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$value</span> <span class="hljs-keyword">instanceof</span> Money ? <span class="hljs-variable">$value</span>-&gt;<span class="hljs-title function_ invoke__">amount</span>() : <span class="hljs-variable">$value</span>;
    }
}
</code></pre>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šä»æ•°æ®åº“åˆ°é¢†åŸŸå±‚ï¼Œä½ å§‹ç»ˆåœ¨ç”¨â€œé¢†åŸŸç±»å‹â€ï¼Œè€Œä¸æ˜¯ä¸€å †æ— æ„ä¹‰çš„ string/int/floatã€‚</p>
<h3 data-id="heading-11">6. æ€ä¹ˆè¿ç§»ç°æœ‰ä»£ç åº“</h3>
<p>å¼•å…¥å€¼å¯¹è±¡ä¸éœ€è¦æ¨å€’é‡æ¥ã€‚æœ€ç¨³å¦¥çš„æ–¹å¼æ˜¯æ¸è¿›å¼è¿ç§»ï¼š</p>
<ul>
<li>å…ˆæ”¹è¾¹ç•Œå±‚ï¼šåœ¨ HTTP controllerã€è¡¨å•è¯·æ±‚ã€CLI å‘½ä»¤é‡Œï¼ŒæŠŠè¾“å…¥çš„åŸå§‹å€¼è§£ææˆå€¼å¯¹è±¡</li>
<li>å†æ”¹æœåŠ¡å±‚ï¼šé€æ­¥æŠŠ service æ–¹æ³•ç­¾åä»åŸå§‹ç±»å‹æ¢æˆå€¼å¯¹è±¡</li>
<li>é…åˆé™æ€åˆ†æï¼šç”¨ PHPStan æˆ– Psalm å¼ºåŒ–ç±»å‹çº¦æŸï¼Œå°½æ—©å‘ç°ä¸åŒ¹é…</li>
</ul>
<h3 data-id="heading-12">7. ç»“è¯­ï¼šè®©é¢†åŸŸè‡ªå·±è¯´è¯</h3>
<p>å€¼å¯¹è±¡çš„æ„ä¹‰ï¼Œä¸åœ¨äºâ€œOO æ›´çº¯ç²¹â€ï¼Œè€Œåœ¨äºè®©é¢†åŸŸæ¦‚å¿µå˜å¾—æ¸…æ¥šã€å¯çº¦æŸã€å¯å¤ç”¨ã€‚</p>
<p>ä¸‹æ¬¡ä½ å‡†å¤‡åœ¨æ–¹æ³•é‡Œä¼ ä¸€å † string/int çš„æ—¶å€™ï¼Œä¸å¦¨åœä¸€ä¸‹é—®è‡ªå·±ï¼š</p>
<p>â€œè¿™çœŸçš„æ˜¯ä¸€ä¸ªç®€å•å€¼å—ï¼Ÿè¿˜æ˜¯ä¸€ä¸ªåº”è¯¥è¢«å‘½åã€è¢«çº¦æŸçš„é¢†åŸŸæ¦‚å¿µï¼Ÿâ€</p>
<p>åšå‡ºè¿™ä¸ªå°æ”¹å˜ï¼ŒçŸ­æœŸèƒ½å‡å°‘é‡å¤æ ¡éªŒå’Œéšæ€§ bugï¼›é•¿æœŸåˆ™ä¼šè®©æ•´ä¸ªä»£ç åº“æ›´ç¨³ã€æ›´å¥½æ”¹â€”â€”ä¹Ÿæ›´ç…§é¡¾æœªæ¥ç»´æŠ¤å®ƒçš„ä½ ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-186 Logstash JDBC vs Syslog Inputï¼šåŸç†ã€åœºæ™¯å¯¹æ¯”ä¸å¯å¤ç”¨é…ç½®ï¼ˆåŸºäº Logstash 7.3.0ï¼‰]]></title>    <link>https://juejin.cn/post/7584320417307197491</link>    <guid>https://juejin.cn/post/7584320417307197491</guid>    <pubDate>2025-12-17T00:45:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584320417307197491" data-draft-id="7584279552434094118" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-186 Logstash JDBC vs Syslog Inputï¼šåŸç†ã€åœºæ™¯å¯¹æ¯”ä¸å¯å¤ç”¨é…ç½®ï¼ˆåŸºäº Logstash 7.3.0ï¼‰"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Logstash"/> <meta itemprop="datePublished" content="2025-12-17T00:45:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-186 Logstash JDBC vs Syslog Inputï¼šåŸç†ã€åœºæ™¯å¯¹æ¯”ä¸å¯å¤ç”¨é…ç½®ï¼ˆåŸºäº Logstash 7.3.0ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:45:29.000Z" title="Wed Dec 17 2025 00:45:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šä» MySQL å¢é‡åŒæ­¥ç»“æ„åŒ–æ•°æ®åˆ° Logstashï¼›åŒæ—¶é›†ä¸­é‡‡é›† Linux/è®¾å¤‡ Syslog æ—¥å¿—å¹¶è§£æã€‚</li>
<li>ç»“è®ºï¼šJDBC é€‚åˆâ€œæŒ‰è¡¨/æŒ‰ SQL æ‹‰å–+å¢é‡ä½ç‚¹â€ï¼›Syslog é€‚åˆâ€œç½‘ç»œæ—¥å¿—æµå…¥+Grok/Date è§£æâ€ï¼Œä¸¤è€…ç“¶é¢ˆåˆ†åˆ«åœ¨ DB/æŸ¥è¯¢ä¸ç½‘ç»œ/è§£æã€‚</li>
<li>äº§å‡ºï¼šä¸¤å¥—å¯è·‘é€šçš„ Logstash 7.3.0 é…ç½®ï¼ˆjdbc.confã€syslog.confï¼‰+ å¢é‡è¿½è¸ªä¸ rsyslog è½¬å‘é“¾è·¯ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83442750aee4466da32a35ba9b2a5071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=0ezZp9WLTCSILVQ3YKjS709bet0%3D" alt="å¤§æ•°æ®-186 Logstash JDBC vs Syslog Inputï¼šåŸç†ã€åœºæ™¯å¯¹æ¯”ä¸å¯å¤ç”¨é…ç½®ï¼ˆåŸºäº Logstash 7.3.0ï¼‰" loading="lazy"/></p>
<h2 data-id="heading-1">ç‰ˆæœ¬çŸ©é˜µ</h2>





























<table><thead><tr><th>ç»„ä»¶/å·¥å…·</th><th>é…ç½®è¯´æ˜</th></tr></thead><tbody><tr><td>Logstash 7.3.0</td><td>é…ç½®è·¯å¾„ä¸å‘½ä»¤å‡ä»¥ <code>/opt/servers/logstash-7.3.0</code> ä¸ºåŸºå‡†ï¼›<code>-t</code> æ ¡éªŒé€šè¿‡æˆªå›¾å·²ä½“ç°</td></tr><tr><td>MySQL Connector/J</td><td>ä½¿ç”¨ <code>jdbc.conf</code> é…ç½®ï¼Œé©±åŠ¨ç‰ˆæœ¬ä¸º 8.0.19ï¼›MySQL 8 æ¨èä½¿ç”¨ <code>com.mysql.cj.jdbc.Driver</code>ï¼ˆå…¼å®¹æ€§ä¸æ—¶åŒº/SSL å‚æ•°æ›´æ˜ç¡®ï¼‰</td></tr><tr><td>MySQLï¼ˆç¤ºä¾‹è¡¨ userï¼‰</td><td>é€šè¿‡ <code>tracking_column =&gt; "id" + id &gt; :sql_last_value</code> å®ç°å¢é‡ï¼›é€‚é…è‡ªå¢/å•è°ƒé€’å¢åˆ—</td></tr><tr><td>rsyslogï¼ˆLinuxï¼‰</td><td>åœ¨ <code>/etc/rsyslog.conf</code> ä¸­å¢åŠ  <code>*.* @@host:port</code> å®ç° TCP è½¬å‘ï¼›éœ€æ‰§è¡Œ <code>systemctl restart rsyslog</code> ç”Ÿæ•ˆ</td></tr><tr><td>Logstash tcp/udp input</td><td><code>syslog.conf</code> é‡‡ç”¨ <code>tcp {} + udp {}</code> ç›‘å¬ 6789 ç«¯å£ï¼Œå¹¶ä½¿ç”¨ <code>grok</code> è§£æâ€œç±» syslogâ€æ¶ˆæ¯ï¼ˆé syslog input æ’ä»¶ç›´é…ï¼‰</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f7c20b7a75b4186b5742e09dd0a1d13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=WBQBi50P7LaSfTFnK4d5kT37x8c%3D" alt="Elasticsearch" loading="lazy"/></p>
<h2 data-id="heading-2">åŸºæœ¬ä»‹ç»</h2>
<p>Logstash çš„ JDBC å’Œ Syslog æ˜¯ä¸¤ç§åŠŸèƒ½å„å¼‚çš„ Input æ’ä»¶ï¼Œå®ƒä»¬åˆ†åˆ«é’ˆå¯¹ä¸åŒçš„æ•°æ®æºè¿›è¡Œä¼˜åŒ–è®¾è®¡ï¼Œåœ¨æ•°æ®å¤„ç†æµç¨‹ä¸­æ‰®æ¼”ç€å…³é”®è§’è‰²ã€‚ä¸‹é¢å°†è¯¦ç»†é˜è¿°å®ƒä»¬çš„æŠ€æœ¯ç‰¹æ€§ã€åº”ç”¨åœºæ™¯åŠå…¸å‹é…ç½®ï¼š</p>
<h4 data-id="heading-3">JDBC æ’ä»¶æ·±å…¥è§£æ</h4>
<ol>
<li>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æ”¯æŒä¸»æµå…³ç³»å‹æ•°æ®åº“ï¼šMySQL (5.7+)ã€PostgreSQL (9.6+)ã€Oracle (12c+)ã€SQL Server (2016+)ç­‰</li>
<li>åŸºäº JDBC 4.2 è§„èŒƒå®ç°ï¼Œä½¿ç”¨æ•°æ®åº“å®˜æ–¹æä¾›çš„ JDBC é©±åŠ¨</li>
<li>æ”¯æŒå¢é‡æ•°æ®é‡‡é›†ï¼šé€šè¿‡ <code>sql_last_value</code> å‚æ•°è®°å½•æœ€åå¤„ç†ä½ç½®</li>
</ul>
</li>
<li>
<p><strong>å…¸å‹åº”ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>æ•°æ®ä»“åº“çš„ ETL æµç¨‹</li>
<li>ä¸šåŠ¡ç³»ç»Ÿæ•°æ®åº“å˜æ›´ç›‘æ§</li>
<li>å°†ä¼ ç»Ÿæ•°æ®åº“æ•°æ®å¯¼å…¥ Elasticsearch é›†ç¾¤</li>
<li>ç¤ºä¾‹ï¼šç”µå•†è®¢å•æ•°æ®å®æ—¶åŒæ­¥</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-sql" lang="sql">     <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> orders <span class="hljs-keyword">WHERE</span> update_time <span class="hljs-operator">&gt;</span> :sql_last_value
</code></pre>
<ol start="3">
<li><strong>å…³é”®é…ç½®å‚æ•°</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-ruby" lang="ruby">   input {
     jdbc {
       jdbc_driver_library =&gt; <span class="hljs-string">"/path/to/mysql-connector-java-8.0.28.jar"</span>
       jdbc_driver_class =&gt; <span class="hljs-string">"com.mysql.jdbc.Driver"</span>
       jdbc_connection_string =&gt; <span class="hljs-string">"jdbc:mysql://localhost:3306/ecommerce"</span>
       jdbc_user =&gt; <span class="hljs-string">"logstash"</span>
       jdbc_password =&gt; <span class="hljs-string">"securepassword"</span>
       schedule =&gt; <span class="hljs-string">"* * * * *"</span>  <span class="hljs-comment"># æ¯åˆ†é’Ÿæ‰§è¡Œ</span>
       statement =&gt; <span class="hljs-string">"SELECT * FROM products WHERE last_modified &gt; :sql_last_value"</span>
       use_column_value =&gt; <span class="hljs-literal">true</span>
       tracking_column =&gt; <span class="hljs-string">"last_modified"</span>
     }
   }
</code></pre>
<h4 data-id="heading-4">Syslog æ’ä»¶æŠ€æœ¯ç»†èŠ‚</h4>
<ol>
<li>
<p><strong>åè®®æ”¯æŒ</strong>ï¼š</p>
<ul>
<li>RFC3164 (æ—§ç‰ˆ BSD syslog)</li>
<li>RFC5424 (æ–°ç‰ˆç»“æ„åŒ–syslog)</li>
<li>æ”¯æŒ TCP/UDP ä¸¤ç§ä¼ è¾“åè®®</li>
</ul>
</li>
<li>
<p><strong>ç½‘ç»œé…ç½®é€‰é¡¹</strong>ï¼š</p>
<ul>
<li>ç«¯å£ç»‘å®šï¼šé»˜è®¤ 514 (UDP) / 6514 (TCP)</li>
<li>æ”¯æŒ TLS åŠ å¯†ä¼ è¾“</li>
<li>å¯é…ç½®å¤šä¸ªç›‘å¬ç«¯å£å®ç°å¤šç§Ÿæˆ·éš”ç¦»</li>
</ul>
</li>
<li>
<p><strong>å…¸å‹éƒ¨ç½²æ¨¡å¼</strong>ï¼š</p>
<ul>
<li>ç½‘ç»œè®¾å¤‡æ—¥å¿—æ”¶é›†ï¼ˆè·¯ç”±å™¨/äº¤æ¢æœºï¼‰</li>
<li>Linux ç³»ç»Ÿæ—¥å¿—é›†ä¸­ç®¡ç†</li>
<li>å®¹å™¨ç¯å¢ƒæ—¥å¿—é‡‡é›†ï¼ˆDocker syslogé©±åŠ¨ï¼‰</li>
<li>ç¤ºä¾‹ï¼šé˜²ç«å¢™æ—¥å¿—å¤„ç†</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-ruby" lang="ruby">     input {
       syslog {
         port =&gt; <span class="hljs-number">5514</span>
         type =&gt; <span class="hljs-string">"firewall"</span>
         syslog_field =&gt; <span class="hljs-string">"syslog_message"</span>
       }
     }
</code></pre>
<ol start="4">
<li><strong>é«˜çº§åŠŸèƒ½</strong>ï¼š
<ul>
<li>æ”¯æŒè‡ªå®šä¹‰æ¶ˆæ¯è§£ææ¨¡å¼</li>
<li>å¯é…ç½®æ—¶åŒºè½¬æ¢</li>
<li>æä¾›æ¶ˆæ¯ä¼˜å…ˆçº§(PRI)è§£æ</li>
</ul>
</li>
</ol>
<p>ä¸¤ç§æ’ä»¶åœ¨æ€§èƒ½è°ƒä¼˜æ–¹é¢ä¹Ÿå­˜åœ¨å·®å¼‚ï¼šJDBC æ’ä»¶éœ€è¦å…³æ³¨æ•°æ®åº“è¿æ¥æ± é…ç½®å’Œæ‰¹å¤„ç†å¤§å°ï¼Œè€Œ Syslog æ’ä»¶åˆ™éœ€è¦ä¼˜åŒ–ç½‘ç»œç¼“å†²åŒºè®¾ç½®å’Œå¹¶å‘å¤„ç†èƒ½åŠ›ã€‚å®é™…éƒ¨ç½²æ—¶ï¼Œå»ºè®®æ ¹æ®æ•°æ®é‡çº§å’Œå»¶è¿Ÿè¦æ±‚è¿›è¡Œé’ˆå¯¹æ€§è°ƒä¼˜ã€‚</p>
<h3 data-id="heading-5">JDBC Input æ’ä»¶</h3>
<p>JDBC æ’ä»¶ç”¨äºä»å…³ç³»å‹æ•°æ®åº“ä¸­æå–æ•°æ®ï¼Œç‰¹åˆ«é€‚ç”¨äºå°†ç»“æ„åŒ–çš„ä¸šåŠ¡æ•°æ®å¯¼å…¥åˆ° ELKï¼ˆElasticsearch, Logstash, Kibanaï¼‰å †æ ˆä¸­ã€‚å®ƒæ”¯æŒå®šæ—¶è°ƒåº¦å’Œå¢é‡æå–ï¼Œé€‚åˆæ•°æ®åŒæ­¥å’Œ ETL åœºæ™¯ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li>æ•°æ®åº“è¿æ¥ï¼šä½¿ç”¨ JDBC é©±åŠ¨æ¥è¿æ¥å„ç§æ•°æ®åº“ï¼ˆä¾‹å¦‚ MySQLã€PostgreSQLã€Oracleã€SQL Server ç­‰ï¼‰ã€‚</li>
<li>SQL æŸ¥è¯¢ï¼šå…è®¸ç”¨æˆ·é€šè¿‡ SQL æŸ¥è¯¢è¯­å¥é€‰æ‹©æ•°æ®ï¼Œæ”¯æŒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€‚</li>
<li>å¢é‡æå–ï¼šå¯ä»¥é…ç½®â€œè¿½è¸ªåˆ—â€ï¼ˆtracking columnï¼‰ï¼ŒåŸºäºæŸä¸€åˆ—ï¼ˆå¦‚è‡ªå¢ ID æˆ–æ—¶é—´æˆ³ï¼‰å®ç°å¢é‡æ•°æ®æ‹‰å–ï¼Œé¿å…é‡å¤å¯¼å…¥ã€‚</li>
<li>å®šæ—¶è°ƒåº¦ï¼šå¯ä»¥è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸæŸ¥è¯¢å’ŒåŒæ­¥æ•°æ®åº“çš„æ•°æ®ã€‚</li>
<li>é”™è¯¯é‡è¯•æœºåˆ¶ï¼šå¯ä»¥å¤„ç†è¿æ¥é”™è¯¯å¹¶è‡ªåŠ¨é‡è¯•ï¼Œç¡®ä¿æ•°æ®é‡‡é›†çš„ç¨³å®šæ€§ã€‚</li>
</ul>
<h3 data-id="heading-6">Syslog Input æ’ä»¶</h3>
<p>Syslog æ’ä»¶ç”¨äºæ¥æ”¶åŸºäº Syslog åè®®ä¼ è¾“çš„æ—¥å¿—æ•°æ®ã€‚Syslog æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ—¥å¿—åè®®ï¼Œç‰¹åˆ«æ˜¯åœ¨ç½‘ç»œè®¾å¤‡å’Œ Linux/Unix æ“ä½œç³»ç»Ÿä¸­ã€‚Logstash çš„ Syslog æ’ä»¶èƒ½å¤Ÿç›‘å¬ç‰¹å®šçš„ç«¯å£ï¼Œæ¥æ”¶å’Œè§£æè¿™äº›æ—¥å¿—ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li>åè®®æ”¯æŒï¼šæ”¯æŒ Syslog åè®®ï¼ŒåŒ…æ‹¬ RFC 3164 å’Œ RFC 5424 æ ¼å¼çš„æ—¥å¿—ã€‚</li>
<li>å¤šç§ä¼ è¾“æ–¹å¼ï¼šæ”¯æŒé€šè¿‡ TCP å’Œ UDP åè®®æ¥æ”¶æ—¥å¿—ï¼Œé€‚åº”ä¸åŒçš„ä¼ è¾“éœ€æ±‚ã€‚</li>
<li>æ—¥å¿—è§£æï¼šè‡ªåŠ¨è§£æ Syslog æ¶ˆæ¯çš„å¤´éƒ¨å­—æ®µï¼Œä¾‹å¦‚æ—¶é—´æˆ³ã€ä¸»æœºåã€ç¨‹åºåç­‰ã€‚</li>
<li>ç½‘ç»œç›‘å¬ï¼šå¯ä»¥é€šè¿‡ç›‘å¬æŒ‡å®šçš„ IP å’Œç«¯å£ï¼ŒæŒç»­æ¥æ”¶å¹¶å¤„ç†æ¥è‡ªç½‘ç»œçš„ Syslog æ—¥å¿—ã€‚</li>
</ul>
<h2 data-id="heading-7">JDBCæ’ä»¶</h2>
<p>JDBCæ’ä»¶å¯ä»¥é‡‡é›†æŸå¼ æ•°æ®åº“è¡¨å½“ä¸­çš„æ•°æ®åˆ°Logstashå½“ä¸­æ¥</p>
<h3 data-id="heading-8">å‡†å¤‡æ•°æ®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">user</span>` (
  `id` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `user_name` <span class="hljs-type">varchar</span>(<span class="hljs-number">25</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `gender` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `create_time` <span class="hljs-type">timestamp</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY(`id`)
) ENGINE<span class="hljs-operator">=</span>InnoDB <span class="hljs-keyword">DEFAULT</span> CHRASET<span class="hljs-operator">=</span>utf8;

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `<span class="hljs-keyword">user</span>` <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'zhangsan'</span>, <span class="hljs-string">'male'</span>, <span class="hljs-string">'2024-08-16 00:00:00'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `<span class="hljs-keyword">user</span>` <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'lisi'</span>, <span class="hljs-string">'female'</span>, <span class="hljs-string">'2024-08-16 00:00:00'</span>);
</code></pre>
<p>ç›®å‰æˆ‘ä»¬çš„MySQLæœåŠ¡å™¨æ˜¯åœ¨ h122 èŠ‚ç‚¹ä¸Šçš„ï¼ˆä¹‹å‰ç»™Hiveå’ŒHBaseç­‰ä¸šåŠ¡ä½¿ç”¨çš„ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦åˆ° h122 æ•°æ®åº“ä¸­ï¼Œæ‰§è¡Œä¸Šè¿°çš„SQLæŒ‡ä»¤ã€‚
æˆ‘è¿™é‡Œä½¿ç”¨Navicatæ‰§è¡Œï¼Œ æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f4d73cd9bdb4b508b43bda78bd8cb7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=N1CX2DFcdfLQMLmgXkYGjx1Zxnw%3D" alt="Elasticsearch æ‰§è¡ŒSQLè¡¨" loading="lazy"/></p>
<h3 data-id="heading-9">ç¼–å†™é…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0/config
vim jdbc.conf
</code></pre>
<p>å†™å…¥å¦‚ä¸‹çš„å†…å®¹ï¼ˆè¿™é‡Œæ³¨æ„äº›è‡ªå·±çš„ç¯å¢ƒï¼Œæˆ‘çš„ç¯å¢ƒå’Œä½ çš„ä¸ä¸€æ ·ï¼‰ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">input {
  jdbc {
    jdbc_driver_library =&gt; "/opt/servers/mysql-connector-java-8.0.19.jar"
    jdbc_driver_class =&gt; "com.mysql.jdbc.Driver"
    jdbc_connection_string =&gt; "jdbc:mysql://h122.wzk.icu:3306/es-test"
    jdbc_user =&gt; "hive"
    jdbc_password =&gt; "hive@wzk.icu"
    use_column_value =&gt; "true"
    clean_run =&gt; "false"
    record_last_run =&gt;"true"
    tracking_column =&gt; "id"
    schedule =&gt; "* * * * *"
    last_run_metadata_path =&gt; "/opt/servers/es/.Logstash_user_jdbc_last_run"
    statement =&gt; "SELECT * from user where id &gt; :sql_last_value;"
  }
}

output{
  stdout{
    codec=&gt;rubydebug
  }
}
</code></pre>
<h3 data-id="heading-10">æ£€æŸ¥é…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0
bin/logstash -f /opt/servers/logstash-7.3.0/config/jdbc.conf -t
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21e0c6e692cf412389e4eda9b9474703~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=y%2BSooLmZ%2FiWWr79fcZk5uUQdgCU%3D" alt="Elasticsearch æ£€æŸ¥é…ç½®" loading="lazy"/></p>
<h3 data-id="heading-11">å¯åŠ¨æœåŠ¡</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0
bin/logstash -f /opt/servers/logstash-7.3.0/config/jdbc.conf
</code></pre>
<p>å¯åŠ¨ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79421effd51c4e1c8bcf485749a9ea18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=11vR4ckNBkDxzP%2BB06LdRaKE7BU%3D" alt="Elasticsearch å¯åŠ¨æœåŠ¡" loading="lazy"/>
å¯ä»¥çœ‹åˆ°è·å–åˆ°äº†å¯¹åº”çš„æ•°æ®ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7169cb230a5c4e938b80e3ac0f525fc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=79Y9VL8h9orAGUx5j1eX4QqxKiU%3D" alt="Elasticsearch å¯¹åº”çš„æ•°æ®" loading="lazy"/></p>
<h3 data-id="heading-12">å‘é€æ•°æ®</h3>
<p>ç°åœ¨å‘æ•°æ®åº“ä¸­å†™å…¥æ•°æ®ï¼Œå°±å¯ä»¥å‘ç°Logstashç›‘å¬åˆ°äº†ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `<span class="hljs-keyword">user</span>` <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">3</span>, <span class="hljs-string">'wangwu'</span>, <span class="hljs-string">'female'</span>, <span class="hljs-string">'2024-08-16 00:00:00'</span>);
</code></pre>
<p>å¯¹åº”çš„Logstashçš„å˜åŒ–ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea1e21b5969c4b2cb163dea12b8038e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=7k1UsZgQb69PVLgBujSgon1gLtA%3D" alt="Elasticsearch å‘é€æ•°æ®" loading="lazy"/></p>
<h2 data-id="heading-13">syslogæ’ä»¶</h2>
<p>syslogæœºåˆ¶è´Ÿè´£è®°å½•å†…æ ¸å’Œåº”ç”¨ç¨‹åºäº§ç”Ÿçš„æ—¥å¿—ä¿¡æ¯ï¼Œç®¡ç†å‘˜å¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—è®°å½•ï¼Œæ¥æŒæ¡ç³»ç»ŸçŠ¶å†µï¼Œé»˜è®¤ç³»ç»Ÿå·²ç»å®‰è£…äº†rsyslogï¼Œç›´æ¥å¯åŠ¨å³å¯ã€‚</p>
<h3 data-id="heading-14">ç¼–å†™é…ç½®</h3>
<p>åˆ›å»ºæ–°è„šæœ¬ï¼Œsyslog.conf</p>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0/config
vim syslog.conf
</code></pre>
<p>å†™å…¥å¦‚ä¸‹çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">input {
  tcp {
    port =&gt; 6789
    type =&gt; "syslog"
  }
  udp {
    port =&gt; 6789
    type =&gt; "syslog"
  }
}

filter {
  if [type] == "syslog" {
    grok {
      match =&gt; {
        "message" =&gt; "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}"
      }
      add_field =&gt; {
        "received_at" =&gt; "%{@timestamp}"
        "received_from" =&gt; "%{host}"
      }
    }
    date {
      match =&gt; [ "syslog_timestamp", "MMM d HH:mm:ss", "MMM dd HH:mm:ss" ]
    }
  }
}

output {
  stdout {
    codec =&gt; rubydebug
  }
}

</code></pre>
<p>å†™å…¥çš„å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8d4191b454740548d7dd390b5e9dcdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=7BUtLyAQcboRANPlI547ok77JIY%3D" alt="Elasticsearch inputé…ç½®" loading="lazy"/></p>
<h3 data-id="heading-15">æ£€æŸ¥é…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0
bin/logstash -f /opt/servers/logstash-7.3.0/config/syslog.conf -t
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dec55d2ee5247988014387e8a356f6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=2QbsrRQ3uO6nUcJFzL0Qjg2tCJI%3D" alt="Elasticsearch æ£€æŸ¥é…ç½®" loading="lazy"/></p>
<h3 data-id="heading-16">å¯åŠ¨æœåŠ¡</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/logstash-7.3.0
bin/logstash -f /opt/servers/logstash-7.3.0/config/syslog.conf
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d9e282bcbb7454ea6ae9708f4c29aab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=ULNiqzj8McP4LVPGV%2BSv4ApVMmk%3D" alt="Elasticsearch å¯åŠ¨æœåŠ¡æµ‹è¯•" loading="lazy"/></p>
<h3 data-id="heading-17">å‘é€æ•°æ®</h3>
<p>ä¿®æ”¹ç³»ç»Ÿæ—¥å¿—é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-shell" lang="shell">vim /etc/rsyslog.conf
</code></pre>
<p>æ·»åŠ ä¸€è¡Œé…ç½®ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">*.* @@h121.wzk.icu:6789
</code></pre>
<p>å†™å…¥çš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa2cb122c50c4f9a8bcbd1bec6f0a60d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=zbTPfhfY6qS6qv2pNjapGuqCJjY%3D" alt="Elasticsearch å‘é€æ•°æ®" loading="lazy"/>
é‡å¯ç³»ç»Ÿæ—¥å¿—æœåŠ¡</p>
<pre><code class="hljs language-shell" lang="shell">systemctl restart rsyslog
</code></pre>
<p>æŸ¥çœ‹æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00160c04b3e043118d08fc7334c3ac85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537129&amp;x-signature=VOzZ5eBvg%2FnFJ9%2FqqBcPc8cg7eg%3D" alt="Elasticsearch æŸ¥çœ‹ log æ—¥å¿—" loading="lazy"/></p>
<h2 data-id="heading-18">é”™è¯¯é€ŸæŸ¥</h2>







































































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› </th><th>å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>JDBC å¯åŠ¨æŠ¥é©±åŠ¨ç±»æ‰¾ä¸åˆ°ï¼ˆClassNotFoundï¼‰</td><td>jdbc_driver_library è·¯å¾„ä¸å¯¹ / jar ä¸å­˜åœ¨ / ç±»åä¸åŒ¹é…</td><td>Logstash å¯åŠ¨æ—¥å¿—é‡Œçœ‹ Java::...ClassNotFoundExceptionï¼›ç¡®è®¤ jar å®é™…è·¯å¾„</td><td>æ ¡æ­£ jar è·¯å¾„ï¼›MySQL 8 ç”¨ com.mysql.cj.jdbc.Driverï¼›ç¡®ä¿ jar å¯¹ logstash è¿›ç¨‹å¯è¯»</td></tr><tr><td>JDBC èƒ½è¿åº“ä½†ä¸æ‹‰æ•°æ®</td><td>statement æ¡ä»¶ä¸ sql_last_value åˆå§‹å€¼ä¸åŒ¹é…ï¼›æˆ–è¿½è¸ªåˆ—éå•è°ƒ</td><td>æ‰“å° stdout è§‚å¯Ÿæ˜¯å¦æœ‰ eventï¼›æ£€æŸ¥ last_run_metadata_path å†…å®¹</td><td>é¦–æ¬¡å…¨é‡ï¼šä¸´æ—¶ clean_run =&gt; true æˆ–æ”¹ SQL å…è®¸å…¨é‡ï¼›ç¡®ä¿ tracking_column å•è°ƒé€’å¢ï¼ˆid/æ—¶é—´æˆ³ï¼‰</td></tr><tr><td>å¢é‡ä½ç‚¹ä¸æ›´æ–°/é‡å¯åé‡å¤æ‹‰å–</td><td>last_run_metadata_path æ— å†™æƒé™/è·¯å¾„ä¸å­˜åœ¨ï¼›record_last_run é…ç½®ä¸ç”Ÿæ•ˆ</td><td>æŸ¥çœ‹è¯¥è·¯å¾„æ–‡ä»¶æ˜¯å¦ç”Ÿæˆä¸æ›´æ–°æ—¶é—´ï¼›Logstash æ—¥å¿—æœ last_run</td><td>åˆ›å»ºç›®å½•å¹¶æˆæƒï¼›å°† record_last_run/clean_run/use_column_value æ”¹ä¸ºå¸ƒå°”å€¼ï¼›å›ºå®šéƒ¨ç½²ç”¨æˆ·ä¸è·¯å¾„</td></tr><tr><td>æ¯åˆ†é’Ÿè°ƒåº¦ä¸æ‰§è¡Œ</td><td>schedule æ—¶åŒº/cron è§£æé—®é¢˜ï¼›è¿›ç¨‹æœªæŒç»­è¿è¡Œï¼ˆå‰å°é€€å‡ºï¼‰</td><td>Logstash æ—¥å¿—çœ‹æ˜¯å¦æ‰“å° scheduler tickï¼›ç¡®è®¤è¿›ç¨‹å­˜æ´»</td><td>ç”¨æ ‡å‡† cron è¡¨è¾¾å¼ï¼›ä¿æŒè¿›ç¨‹å¸¸é©»ï¼ˆsystemd/å®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼›å¿…è¦æ—¶åŠ å¤§æ—¥å¿—çº§åˆ«</td></tr><tr><td>æ‹‰å–é€Ÿåº¦æ…¢/æ•°æ®åº“å‹åŠ›å¤§</td><td>SQL æ— ç´¢å¼•ã€å…¨è¡¨æ‰«ï¼›æ‰¹æ¬¡å¤ªå°/ç½‘ç»œæ…¢</td><td>DB ä¾§çœ‹æ…¢æŸ¥è¯¢ä¸æ‰§è¡Œè®¡åˆ’ï¼›Logstash ä¾§çœ‹æ¯è½®è€—æ—¶</td><td>ç»™ tracking_column å»ºç´¢å¼•ï¼›åªé€‰å¿…è¦å­—æ®µï¼›åˆ†æ‰¹åˆ†é¡µï¼ˆstatement + ä¸»é”®èŒƒå›´ï¼‰ï¼›åˆç†è°ƒåº¦é¢‘ç‡</td></tr><tr><td>syslog ç«¯å£æ— æ•°æ®</td><td>rsyslog æœªè½¬å‘/é˜²ç«å¢™æ‹¦æˆª/ç›®æ ‡ä¸»æœºä¸å¯è¾¾</td><td>ç›®æ ‡æœº ss -lntup çœ‹ 6789 æ˜¯å¦ç›‘å¬ï¼›æºæœº tcpdump æŠ“åŒ…</td><td>æ”¾é€š 6789 TCP/UDPï¼›ç¡®è®¤ @@(TCP) æˆ– @(UDP)ï¼›æ ¡éªŒä¸»æœºåè§£æä¸è·¯ç”±</td></tr><tr><td>æ”¶åˆ°æ•°æ®ä½† grok è§£æå¤±è´¥ï¼ˆ_grokparsefailureï¼‰</td><td>æ¶ˆæ¯æ ¼å¼ä¸ grok æ¨¡å¼ä¸åŒ¹é…ï¼ˆè®¾å¤‡/ç³»ç»Ÿå·®å¼‚ï¼‰</td><td>stdout é‡Œçœ‹åŸå§‹ messageï¼›è§‚å¯Ÿå­—æ®µæ˜¯å¦ç¼ºå¤±</td><td>æŒ‰å®é™…æ—¥å¿—æ”¹ grokï¼›å…ˆå®½æ¾å†æ”¶ç´§ï¼›ä¸ºä¸åŒæ¥æºåšåˆ†æ”¯åŒ¹é…</td></tr><tr><td>æ—¶é—´æˆ³ä¸å¯¹/æ—¶åŒºé”™ä¹±</td><td>date åŒ¹é…æ ¼å¼ä¸å…¨ï¼›æºæ—¥å¿—æ— å¹´ä»½/æ—¶åŒºä¿¡æ¯</td><td>çœ‹ @timestamp ä¸ syslog_timestampï¼›æ¯”å¯¹æ—¶åŒº</td><td>date å¢åŠ åŒ¹é…æ ¼å¼ï¼›å¿…è¦æ—¶è¡¥ timezone =&gt; "Asia/Shanghai"ï¼›æˆ–åœ¨ rsyslog ä¾§è¾“å‡º RFC3339</td></tr><tr><td>UDP ä¸¢æ—¥å¿—</td><td>UDP å¤©ç„¶ä¸å¯é ï¼›é«˜å³°æœŸä¸¢åŒ…/ç¼“å†²åŒºä¸è¶³</td><td>å¯¹æ¯”æºç«¯æ—¥å¿—é‡ä¸æ¥æ”¶ç«¯äº‹ä»¶é‡ï¼›ç³»ç»Ÿä¸¢åŒ…ç»Ÿè®¡</td><td>å…³é”®æ—¥å¿—æ”¹ TCPï¼›æå‡å†…æ ¸ç¼“å†²åŒºï¼›é™ä½å•æœºè§£æå‹åŠ›ï¼ˆæ°´å¹³æ‰©å±•/åˆ†æµç«¯å£ï¼‰</td></tr><tr><td>ç«¯å£å†²çª/å¯åŠ¨å¤±è´¥</td><td>ç«¯å£è¢«å ç”¨æˆ–æƒé™ä¸è¶³ï¼ˆä½ç«¯å£ï¼‰</td><td>å¯åŠ¨æ—¥å¿—æç¤º bind å¤±è´¥ï¼›lsof -i :PORT</td><td>æ›´æ¢ç«¯å£ï¼›é‡Šæ”¾å ç”¨ï¼›é¿å…ä½¿ç”¨ 514 ç­‰ç‰¹æƒç«¯å£æˆ–ç”¨èƒ½åŠ›æˆæƒ/å‰ç½®è½¬å‘</td></tr></tbody></table>
<h2 data-id="heading-19">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-20">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-21">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-196 æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹ï¼šRabbitMQ vs RocketMQ vs Kafka</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-22">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯¹é•¿ä¸Šä¸‹æ–‡èƒ½åŠ›æœ‰ä¸åŒè¦æ±‚ï¼Œæ€ä¹ˆé€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584307643000815659</link>    <guid>https://juejin.cn/post/7584307643000815659</guid>    <pubDate>2025-12-17T00:48:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584307643000815659" data-draft-id="7584356212800569385" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯¹é•¿ä¸Šä¸‹æ–‡èƒ½åŠ›æœ‰ä¸åŒè¦æ±‚ï¼Œæ€ä¹ˆé€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿ"/> <meta itemprop="keywords" content="LLM,äººå·¥æ™ºèƒ½,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-17T00:48:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯¹é•¿ä¸Šä¸‹æ–‡èƒ½åŠ›æœ‰ä¸åŒè¦æ±‚ï¼Œæ€ä¹ˆé€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:48:06.000Z" title="Wed Dec 17 2025 00:48:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> å½“ä¸€é¡¹æŠ€æœ¯çš„å‚æ•°æŒ‡æ ‡æˆä¸ºè¡Œä¸šç„¦ç‚¹ï¼Œæˆ‘ä»¬æ˜¯å¦å®¹æ˜“è½å…¥â€œæ•°å­—è¿·ä¿¡â€çš„é™·é˜±ï¼Ÿåœ¨å¤§è¯­è¨€æ¨¡å‹ç«ç›¸å®£ä¼ â€œç™¾ä¸‡çº§ä¸Šä¸‹æ–‡çª—å£â€çš„ä»Šå¤©ï¼Œæ›´é•¿æ˜¯å¦çœŸçš„æ„å‘³ç€æ›´å¼ºï¼Ÿæˆ‘ä»¬ä»Šå¤©ä¸ºå¤§å®¶å¸¦æ¥çš„è¿™ç¯‡æ–‡ç« ï¼Œä½œè€…çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼šä¸Šä¸‹æ–‡çª—å£çš„é•¿åº¦å¹¶ä¸èƒ½å®Œå…¨ä»£è¡¨æ¨¡å‹çš„å®é™…èƒ½åŠ›ï¼ŒçœŸæ­£å†³å®šæ¨¡å‹åœ¨é•¿æ–‡æœ¬åœºæ™¯ä¸‹è¡¨ç°çš„æ˜¯å…¶èƒŒåçš„æ¶æ„è®¾è®¡ä¸æŠ€æœ¯æƒè¡¡ã€‚</p>
<p>æ–‡ç« ç³»ç»Ÿæ¢³ç†äº†å½“å‰ä¸»æµå¤§æ¨¡å‹åœ¨å¤„ç†é•¿ä¸Šä¸‹æ–‡æ—¶æ‰€é‡‡ç”¨çš„ä¸åŒæŠ€æœ¯è·¯å¾„ â€”â€” ä»ä¼˜åŒ–åçš„ç²¾ç¡®æ³¨æ„åŠ›æœºåˆ¶ï¼ˆå¦‚ GPT-5ã€Mistralï¼‰ã€ç¨€ç–æˆ–æ··åˆæ³¨æ„åŠ›æœºåˆ¶ï¼ˆå¦‚ Claudeã€Geminiï¼‰ï¼Œåˆ°å½»åº•è„±ç¦»æ³¨æ„åŠ›èŒƒå¼çš„çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆå¦‚ Mambaï¼‰ï¼Œå¹¶æ·±å…¥å‰–æäº†æ¯ç§æ¶æ„åœ¨è®°å¿†æŒä¹…æ€§ã€æ¨ç†æ·±åº¦ä¸è®¡ç®—æ•ˆç‡ä¹‹é—´çš„æƒè¡¡ã€‚</p>
</blockquote>
<p><strong>ä½œè€… | Phuoc Nguyen</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<p>åœ¨è¿‡å»ä¸‰å¹´ä¸­ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„ä¸Šä¸‹æ–‡çª—å£å·²ä»å‡ åƒä¸ª token æ‰©å±•è‡³æ•°åä¸‡é‡çº§ â€”â€” åœ¨æŸäº›ç³»ç»Ÿä¸­ç”šè‡³è¾¾åˆ°æ•°ç™¾ä¸‡ã€‚Gemini 2.5ã€Claude 4.5 Sonnetã€GPT-5 Pro å’Œ Llama 4 Scout å‡å®£ç§°å…·å¤‡ç™¾ä¸‡ token çº§åˆ«çš„å¤„ç†èƒ½åŠ›ã€‚ä¹çœ‹ä¹‹ä¸‹ï¼Œè¿™ä¼¼ä¹æ„å‘³ç€æ¨¡å‹èƒ½å¤Ÿâ€œè®°ä½â€å¹¶è·¨æ•´æœ¬ä¹¦ç±ã€æ•´ä¸ªä»£ç ä»“åº“æˆ–æ•°å°æ—¶çš„å¯¹è¯è¿›è¡Œæ¨ç†ã€‚ç„¶è€Œå®é™…ä¸Šï¼Œå®é™…æƒ…å†µè¦å¤æ‚å¾—å¤šã€‚</p>
<p><strong>æ›´é•¿çš„ä¸Šä¸‹æ–‡çª—å£å¹¶ä¸ä¿è¯æ›´æ·±å±‚æ¬¡çš„æ¨ç†èƒ½åŠ›æˆ–æ›´ä¸ºå‡†ç¡®çš„è®°å¿†èƒ½åŠ›ã€‚</strong> æ¯ç§æ¶æ„ â€”â€” Transformerã€ç¨€ç–/æ··åˆæ¶æ„ã€æ··åˆä¸“å®¶æ¨¡å‹ï¼ˆMoEï¼‰æˆ–çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆMambaï¼‰ï¼Œä¸ä¸Šä¸‹æ–‡çš„äº¤äº’æ–¹å¼å„æœ‰ä¸åŒã€‚ç†è§£è¿™äº›å·®å¼‚æœ‰åŠ©äºå¼€å‘è€…æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Œè€Œä¸æ˜¯ç®€å•åœ°è®¤ä¸ºæ‰€æœ‰â€œç™¾ä¸‡ token ä¸Šä¸‹æ–‡â€çš„ç³»ç»Ÿéƒ½è¡¨ç°ä¸€è‡´ã€‚</p>
<h2 data-id="heading-0"><strong>01 ä¸ºä»€ä¹ˆåªçœ‹ä¸Šä¸‹æ–‡é•¿åº¦è¿™ä¸ªæ•°å­—å¹¶ä¸èƒ½å®Œæ•´åˆ¤æ–­æ¨¡å‹çš„å®é™…èƒ½åŠ›</strong></h2>
<p>åŸå§‹çš„ Transformerï¼ˆVaswani ç­‰äººï¼Œ2017ï¼‰ä¼šå¯¹æ¯ä¸€å¯¹ token æ‰§è¡Œè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œç†è®ºä¸Šå…·å¤‡å…¨å±€æ„ŸçŸ¥èƒ½åŠ›ã€‚ç„¶è€Œï¼Œè¿™ç§äºŒæ¬¡æ–¹å¤æ‚åº¦ï¼ˆO(nÂ²)ï¼‰ä½¿å¾—åºåˆ—é•¿åº¦å¢é•¿æ—¶è®¡ç®—é‡æé€Ÿå¢åŠ ã€‚</p>
<p><strong>ç°ä»£é•¿ä¸Šä¸‹æ–‡ç³»ç»Ÿé€šè¿‡å·¥ç¨‹æŠ€å·§çªç ´äº†è¿™ä¸€é™åˆ¶ â€”â€” ä½†è¿™äº›æŠ€å·§ä¹Ÿæ”¹å˜äº†æ¨¡å‹çš„â€œæ€è€ƒâ€æ–¹å¼ã€‚</strong></p>
<p>å®è¯æµ‹è¯•ï¼ˆå¦‚ LongBenchã€RULER 2025ï¼‰è¡¨æ˜ï¼Œå³ä½¿å®£ç§°æ”¯æŒ 1M-token è¾“å…¥çš„æ¨¡å‹ï¼Œä¹Ÿå¾ˆå°‘èƒ½åœ¨è¶…è¿‡å…¶ä¸€åŠé•¿åº¦çš„ä¸Šä¸‹æ–‡ä¸­ç»´æŒé«˜ç²¾åº¦çš„æ¨ç†èƒ½åŠ›ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œâ€œæœ‰æ•ˆä¸Šä¸‹æ–‡â€é€šå¸¸åœ¨è¾¾åˆ°ä¸Šä¸‹æ–‡çª—å£é•¿åº¦å®£ä¼ å€¼ä¸Šé™çš„ 30%â€“60% æ—¶ï¼Œå°±ä¼šå‡ºç°è®°å¿†è¡°å‡ã€‚é€ æˆè¿™ä¸€ç°è±¡çš„åŸå› å› æ¶æ„è€Œå¼‚ã€‚</p>
<h2 data-id="heading-1"><strong>02 é•¿ä¸Šä¸‹æ–‡èƒŒåçš„æ¶æ„æŠ€æœ¯</strong></h2>
<p>æˆªè‡³ 2025 å¹´åº•ï¼Œå¤§å¤šæ•°æ——èˆ°æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£å·²ç¨³å®šåœ¨ 128k è‡³ 2M token ä¹‹é—´ã€‚ç„¶è€Œï¼ŒLongBench å’Œ RULER ç­‰åŸºå‡†æµ‹è¯•æŒç»­æ˜¾ç¤ºï¼Œæ¨¡å‹çš„â€œæœ‰æ•ˆä¸Šä¸‹æ–‡â€ ï¼ˆçœŸæ­£èƒ½<strong>ä¸ä¸¢ä¿¡æ¯ã€ä¸ä¹±æ¨ç†</strong>çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼‰ï¼Œå¾€å¾€ä»…ä¸ºå®ƒä»¬è¢«å®£ä¼ çš„æœ€å¤§å€¼çš„ä¸€åŠå·¦å³ã€‚è¿™ä¸€å·®è·ç›´æ¥æºäºä¸åŒæ¶æ„è®¾è®¡ç†å¿µçš„åˆ†æ­§ã€‚</p>
<p><strong>å½“å‰çš„å¤§æ¨¡å‹ç”Ÿæ€å·²åˆ†åŒ–ä¸ºè‹¥å¹²ç‹¬ç‰¹çš„æ¶æ„è°±ç³»ï¼Œå„è‡ªåœ¨æ¨ç†æ·±åº¦ã€è®°å¿†æŒä¹…æ€§å’Œè®¡ç®—æ•ˆç‡ä¹‹é—´åšå‡ºä¸åŒçš„æƒè¡¡ã€‚</strong> ä¸‹è¡¨æ€»ç»“äº† 2025 å¹´åº•éƒ¨åˆ†ä¸»æµåŸºç¡€æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£æƒ…å†µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4308a3b307ca40f7b3e153d24e3e531b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537286&amp;x-signature=0nBN6n9nu36qYouoWhTqFvcPvto%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>03 å¤§è¯­è¨€æ¨¡å‹æ˜¯å¦‚ä½•å…·ä½“å¤„ç†å’Œåˆ©ç”¨å…¶é•¿ä¸Šä¸‹æ–‡çª—å£çš„</strong></h2>
<p>è¦ç†è§£è¿™äº›è¡Œä¸ºï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥å…¶æŠ€æœ¯ç»†èŠ‚ã€‚æ¨¡å‹çš„æ€§èƒ½è¡¨ç°å¹¶éå®Œå…¨ä¸å¯é¢„æµ‹çš„é­”æ³•ï¼Œå…¶å®æ˜¯å·¥ç¨‹å¸ˆä¸ºäº†è§£å†³â€œè§„æ¨¡æ‰©å±•â€è¿™ä¸ªæ ¹æœ¬éš¾é¢˜ï¼Œè¢«è¿«åšå‡ºå„ç§æŠ€æœ¯æƒè¡¡åï¼Œç›´æ¥å¯¼è‡´çš„ç»“æœã€‚</p>
<h3 data-id="heading-3"><strong>3.1 å†…å­˜æ¶ˆè€—å‡å°‘çš„æ³¨æ„åŠ›æœºåˆ¶</strong></h3>
<p>åŸå§‹çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶å…è®¸æ¯ä¸ª token æŸ¥çœ‹å…¶ä»–æ‰€æœ‰ tokenï¼Œå…¶è®¡ç®—å¤æ‚åº¦éšåºåˆ—é•¿åº¦å‘ˆäºŒæ¬¡æ–¹å¢é•¿ã€‚è¿™ç§è®¡ç®—å¤æ‚åº¦ä¸Šçš„é™¡å¢ï¼Œä½¿å¾—å¤„ç†å‡ åƒ token ä»¥ä¸Šçš„ä¸Šä¸‹æ–‡å˜å¾—æå…¶æ˜‚è´µã€‚ç°ä»£æ¶æ„é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å…‹æœè¿™ä¸€é™åˆ¶ï¼š</p>
<ul>
<li><strong>ç»è¿‡ä¼˜åŒ–çš„ç²¾ç¡®æ³¨æ„åŠ›æœºåˆ¶ï¼ˆOptimized Exact Attentionï¼‰</strong> ï¼šMistral å’Œ GPT-5 ç­‰æ¨¡å‹å¹¶æœªæ”¹å˜æ³¨æ„åŠ›è®¡ç®—çš„æ•°å­¦æœ¬è´¨ï¼Œè€Œæ˜¯é‡‡ç”¨å¦‚ FlashAttention-3ï¼ˆGPT-5 æ®æ¨æµ‹ä½¿ç”¨äº†è¯¥æŠ€æœ¯ï¼‰ç­‰ä¼˜åŒ–å†…æ ¸ã€‚è¯¥æŠ€æœ¯é€šè¿‡â€œåˆ†å—â€ï¼ˆtilingï¼‰å¤§å¹…å‡å°‘å¯¹ GPU é«˜å¸¦å®½å†…å­˜çš„æ…¢é€Ÿè¯»å†™æ“ä½œï¼Œä½¿ç²¾ç¡®è®¡ç®—æ³¨æ„åŠ›åœ¨é•¿è¾¾ 256k token ç”šè‡³æ›´é•¿çš„åºåˆ—ä¸Šå˜å¾—å¯è¡Œã€‚</li>
<li><strong>ç¨€ç–æˆ–æ··åˆæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSparse or Hybrid Attentionï¼‰ï¼ˆä¾‹å¦‚ Claudeã€Geminiï¼‰</strong> ï¼šè¿™ç±»æ¶æ„ä¼šåŠ¨æ€å‹ç¼©æˆ–æ‘˜è¦éƒ¨åˆ†ä¸Šä¸‹æ–‡ï¼Œä»¥æ§åˆ¶å†…å­˜å¢é•¿ã€‚å…·ä½“å®ç°å¤§å¤šå±äºå•†ä¸šæœºå¯†ï¼Œä½†å­¦æœ¯ç ”ç©¶ç‰ˆæœ¬ï¼ˆå¦‚ Longformerï¼‰è¡¨æ˜ï¼Œç¨€ç–æˆ–æ··åˆæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿåœ¨åºåˆ—å¢é•¿æ—¶ä¸¢å¼ƒæˆ–èšåˆä¸é‚£ä¹ˆé‡è¦çš„ä¿¡æ¯ï¼Œä»è€Œç»´æŒä¸»é¢˜è¿è´¯æ€§å¹¶é™ä½è®¡ç®—å¼€é”€ã€‚</li>
<li><strong>åˆ†å¸ƒå¼ç²¾ç¡®æ³¨æ„åŠ›æœºåˆ¶ï¼ˆDistributed Exact Attentionï¼‰</strong> ï¼šå¯¹äºå¯æ‰©å±•ç³»ç»Ÿï¼ŒRing Attentionï¼ˆLiu, 2023ï¼‰èƒ½å°†è®¡ç®—è´Ÿè½½åˆ†å¸ƒåˆ°å¤šä¸ªåŠ é€Ÿå™¨ç»„æˆçš„é›†ç¾¤ä¸Šã€‚æ¯ä¸ªè®¾å¤‡è´Ÿè´£è®¡ç®—åºåˆ—ä¸­æŸä¸€ç‰‡æ®µçš„æ³¨æ„åŠ›ï¼Œå¹¶å°†ç»“æœä»¥ç¯å½¢çš„æ–¹å¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè®¾å¤‡ï¼Œä»è€Œå®ç°å¯¹æ•°ç™¾ä¸‡ token çš„ç²¾ç¡®æ³¨æ„åŠ›è®¡ç®—ã€‚æ®ä¼  Google Gemini 1.5 é‡‡ç”¨äº†è¿™ç§æ–¹æ³•[1]ï¼Œä½†ç”±äºå…¶æœªå…¬å¼€ä¸“æœ‰æ¶æ„ï¼Œæˆ‘ä»¬æ— æ³•ç¡®è®¤ã€‚è¿™ç§æ¶æ„åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„ä¸€ä¸ªæœ‰è¶£ç‰¹æ€§æ˜¯æ”¯æŒç¡®å®šæ€§è®¡ç®—æ¨¡å¼ï¼ˆdeterministic compute modeï¼‰ï¼Œæœ‰åŠ©äºå¼€å‘è€…è·å¾—æ›´å¼ºçš„ä¸€è‡´æ€§ä¿éšœã€‚</li>
</ul>
<p>å…¶å½±å“ä½“ç°ä¸ºä¸€ç§æ˜ç¡®çš„æƒè¡¡ï¼šâ€œä½¿ç”¨ç²¾ç¡®æ³¨æ„åŠ›æœºåˆ¶çš„æ¨¡å‹ï¼ˆexact attention modelsï¼‰â€é€‚åˆéœ€è¦æé«˜å‡†ç¡®æ€§çš„ç²¾ç»†ä»»åŠ¡ï¼ˆå¦‚æ³•å¾‹å®¡é˜…ï¼‰ï¼Œè€Œâ€œåˆ†å¸ƒå¼æ¨¡å‹ï¼ˆdistributed modelsï¼‰â€é€‚åˆéœ€è¦å¤„ç†æµ·é‡æ•°æ®çš„æ‰¹é‡ä»»åŠ¡ï¼ˆå¦‚å¤§å‹åª’ä½“æ–‡ä»¶åˆ†æï¼‰ã€‚</p>
<h3 data-id="heading-4"><strong>3.2 ä¸ºé€‚åº”æ›´é•¿ä¸Šä¸‹æ–‡è€Œå¯¹ä½ç½®ç¼–ç æ–¹æ³•è¿›è¡Œæ‰©å±•çš„æ–¹æ¡ˆ</strong></h3>
<p>Transformer æ¨¡å‹æœ¬èº«ä¸å…·å¤‡é¡ºåºæ„ŸçŸ¥èƒ½åŠ›ã€‚ä½ç½®ç¼–ç ç”¨äºå‘Šè¯‰æ¨¡å‹æ¯ä¸ª token æ‰€å¤„çš„ä½ç½®ï¼Œä½†æ‰€é€‰ç”¨çš„æ–¹æ³•ä¼šäº§ç”Ÿå¼ºå¤§ä¸”å¯é¢„æµ‹çš„ biasesï¼ˆè¯‘è€…æ³¨ï¼šbiases æŒ‡æ¨¡å‹åœ¨å¤„ç†ä¿¡æ¯æ—¶ï¼Œä¼šç³»ç»Ÿæ€§åœ°æ›´é‡è§†æŸäº›ä½ç½®ï¼ˆæ¯”å¦‚å¼€å¤´ã€ç»“å°¾ï¼‰ï¼Œè€Œç›¸å¯¹å¿½è§†å¦ä¸€äº›ä½ç½®ï¼ˆæ¯”å¦‚ä¸­é—´ï¼‰ã€‚ï¼‰ã€‚</p>
<ul>
<li><strong>æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRotary Position Embeddings, RoPEï¼‰</strong> ï¼šLlama 4 é‡‡ç”¨ RoPEï¼Œä»¥ç›¸å¯¹æ–¹å¼ç¼–ç ä½ç½®ä¿¡æ¯ã€‚ä¸ºäº†å¤„ç†æ¯”è®­ç»ƒæ•°æ®æ›´é•¿çš„åºåˆ—ï¼Œå®ƒä»¬ä½¿ç”¨ RoPE ç¼©æ”¾ï¼ˆRoPE scalingï¼‰æŠ€æœ¯ï¼Œå¯¹ä½ç½®å€¼è¿›è¡Œâ€œæ‹‰ä¼¸â€ã€‚è™½ç„¶è¿™èƒ½é˜²æ­¢æ¨¡å‹å› ä½ç½®æ··æ·†è€Œâ€œå›ç»•â€ï¼ˆwrap aroundï¼‰ï¼Œå´é™ä½äº†è¿œè·ç¦» token ä¹‹é—´çš„ä½ç½®åˆ†è¾¨ç‡ï¼Œç›´æ¥åŠ å‰§äº†â€œä¸­é—´è¿·å¤±â€ï¼ˆlost in the middleï¼‰é—®é¢˜ â€”â€” å³ä¸Šä¸‹æ–‡ä¸­é—´éƒ¨åˆ†çš„ç»†èŠ‚å¸¸è¢«å¿½ç•¥æˆ–é”™è¯¯å›å¿†ã€‚</li>
<li><strong>å¸¦çº¿æ€§åç½®çš„æ³¨æ„åŠ›ï¼ˆAttention with Linear Biases, ALiBiï¼‰</strong> ï¼šALiBi æœ€åˆé€šè¿‡åœ¨æ³¨æ„åŠ›åˆ†æ•°ä¸Šæ–½åŠ ä¸ token è·ç¦»æˆæ¯”ä¾‹çš„çº¿æ€§æƒ©ç½šæ¥å®ç°ä½ç½®æ„ŸçŸ¥ï¼Œå¦‚ä»Š ALiBi å·²æˆä¸ºä¸»æµçš„ä½ç½®ç¼–ç æ–¹æ¡ˆã€‚å®ƒé€šè¿‡æ•°å­¦è®¾è®¡ï¼Œå¼ºåˆ¶æ¨¡å‹æ›´å…³æ³¨æ–‡æœ¬ä¸­è¾ƒæ–°çš„å†…å®¹ï¼Œä½†è¿™ç§â€œè¿‘æœŸåå¥½ï¼ˆrecency biasï¼‰â€æ˜¯å¯æ§ä¸”å¹³æ»‘çš„ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿç¨³å®šåœ°å¤„ç†æ¯”è®­ç»ƒæ—¶æ›´é•¿çš„åºåˆ—ã€‚Mistral ç³»åˆ—æ¨¡å‹å³é‡‡ç”¨äº† ALiBiï¼Œå¹¶ç»“åˆä½¿ç”¨äº† FlashAttention åº“ã€‚</li>
</ul>
<p><strong>è¿™æˆ–è®¸å¯ä»¥è§£é‡Šï¼šåœ¨é•¿é—®ç­”ä»»åŠ¡ä¸­ï¼ŒGPT-5 å¯èƒ½èƒ½æ­£ç¡®å…³è”ä¸¤ä¸ªç›¸è·è¾ƒè¿œçš„äº‹å®ï¼Œå´å¯¹ä¸­æ®µä¿¡æ¯äº§ç”Ÿå¹»è§‰æ€§è¡¥å……ï¼›è€ŒæŸä¸ª Llama å˜ä½“åˆ™å¯èƒ½å®Œå…¨å¿½ç•¥æç¤ºè¯å¼€å¤´çš„å†…å®¹ï¼Œåªå…³æ³¨ç»“å°¾éƒ¨åˆ†ã€‚</strong></p>
<h3 data-id="heading-5"><strong>3.3 ç¨€ç–ä¸åˆ†å—æ³¨æ„åŠ›æœºåˆ¶ï¼ˆSparse and Chunked Attentionï¼‰</strong></h3>
<p>ä¸ºé¿å…å®Œæ•´çš„ O(nÂ²) å¤æ‚åº¦çš„æ³¨æ„åŠ›è®¡ç®—ï¼ŒLongformer æˆ– BigBird ç­‰æ¶æ„é‡‡ç”¨ç¨€ç–æ¨¡å¼ï¼ˆä¾‹å¦‚åˆ†å—æˆ–æ»‘åŠ¨çª—å£ï¼‰ï¼Œè€Œåˆ†å—æ–¹æ³•å°†é•¿åºåˆ—åˆ‡å‰²æˆç‰‡æ®µï¼Œå¹¶åœ¨å¤„ç†åç»­ç‰‡æ®µæ—¶æºå¸¦å¹¶åˆ©ç”¨ä¹‹å‰ç‰‡æ®µçš„â€œçŠ¶æ€ï¼ˆè¯‘è€…æ³¨ï¼šæ¨¡å‹å¯¹è¯¥å—å†…å®¹çš„ç†è§£å’Œè®°å¿†ã€‚ï¼‰â€ï¼ˆä¾‹å¦‚ GLM-4 ä¸­çš„ Retentive Transformerï¼‰ã€‚Claude 4 çš„æ··åˆæ–¹æ¡ˆåˆ™ä¼šåŠ¨æ€å‹ç¼©è¾ƒæ—§çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>å®é™…å½±å“ï¼šç¨€ç–è®¾è®¡åœ¨æ™ºèƒ½ä½“ï¼ˆagenticï¼‰å·¥ä½œæµä¸­è¡¨ç°çªå‡º â€”â€” å­æ™ºèƒ½ä½“å¯åˆ†åˆ«å¤„ç†ä¸åŒç‰‡æ®µï¼Œè¿›è¡Œåˆ†å±‚æ‘˜è¦ï¼Œæœ‰æ•ˆå‡å°‘äº†å¤šæ­¥éª¤è§„åˆ’ç­‰é•¿ç¨‹ä»»åŠ¡ä¸­çš„ä¿¡æ¯å¹²æ‰°ã€‚å®ƒä»¬åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ä¹Ÿååˆ†é«˜æ•ˆï¼Œä¾‹å¦‚åˆ†æå¤§å‹ä»£ç åº“æ—¶æ— éœ€å®Œæ•´é‡è½½ä¸Šä¸‹æ–‡ã€‚</p>
<h2 data-id="heading-6"><strong>04 è¶…è¶Šæ³¨æ„åŠ›æœºåˆ¶ï¼šçŠ¶æ€ç©ºé—´æ¨¡å‹çš„å´›èµ·</strong></h2>
<p>æœ‰ä¸€ç±»æ–°å‹æ¶æ„æ­£åœ¨å½»åº•è„±ç¦»æ³¨æ„åŠ›æœºåˆ¶çš„èŒƒå¼ã€‚å…¶ä¸­æœ€å¼•äººæ³¨ç›®çš„æ˜¯ Mambaï¼ˆGu &amp; Dao, 2024ï¼‰ï¼Œå®ƒç”¨é€‰æ‹©æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSelective State Space Model, SSMï¼‰å–ä»£äº†è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚<strong>Mamba å¹¶ä¸ä¼šé€ä¸€æ¯”è¾ƒæ¯å¯¹ tokenï¼Œè€Œæ˜¯ç»´æŠ¤ä¸€ä¸ªä¸æ–­æ¼”åŒ–çš„éšçŠ¶æ€ï¼Œä½œä¸ºå¯¹è¿‡å» token çš„å‹ç¼©è®°å¿†ï¼Œå¹¶é€‰æ‹©æ€§åœ°æ›´æ–°è¯¥çŠ¶æ€ â€”â€” å­¦ä¹ ä½•æ—¶è¦†ç›–ã€ä½•æ—¶ä¿ç•™ä¿¡æ¯ã€‚</strong></p>
<p>è¿™ç§æ–¹æ³•å®ç°äº†çº¿æ€§æ—¶é—´å¤„ç† â€”â€” æ¯ä¸ª token çš„å¤„ç†æ—¶é—´ä¸ºå¸¸æ•°ï¼Œä½¿ Mamba çš„å®é™…æ‰©å±•å¤æ‚åº¦è¾¾åˆ° O(n)ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€å®ƒèƒ½ä»¥æ’å®šçš„å†…å­˜æ¶ˆè€—å¤„ç†æ•°ç™¾ä¸‡ tokenï¼Œå³ä¾¿æ˜¯ GPT-5 æˆ– Gemini ç­‰ç»è¿‡é«˜åº¦ä¼˜åŒ–çš„ Transformer ä¹Ÿéš¾ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>ä¸éœ€è¦æ˜¾å¼è®¡ç®— token é—´å…³ç³»çš„æ³¨æ„åŠ›æœºåˆ¶ä¸åŒï¼ŒMamba çš„é€‰æ‹©æ€§æ‰«ææœºåˆ¶ï¼ˆselective scanï¼‰æ›´åƒä¸€ä¸ªåŠ¨æ€æ»¤æ³¢å™¨ï¼Œè‡ªä¸»å†³å®šå°†å“ªäº›å†å²ä¿¡æ¯å‘å‰ä¼ é€’ã€‚Mamba ä¸ä¼šåƒ Transformer é‚£æ ·å­˜å‚¨ä¸€å¼ æ¸…æ™°çš„ã€è®°å½•ç€æ‰€æœ‰è¯å…ƒä¹‹é—´å…³ç³»çš„â€œåœ°å›¾â€ï¼Œè€Œæ˜¯ç»´æŒç€ä¸€æ®µå¯¹åºåˆ—è¿›è¡ŒæŒç»­å‹ç¼©è€Œå½¢æˆçš„â€œè®°å¿†æµâ€ã€‚è¿™ç§è®¾è®¡ä½¿ Mamba åœ¨â€œå¤§æµ·æé’ˆâ€å¼æ£€ç´¢ã€æµå¼æ•°æ®å¤„ç†å’Œåºåˆ—åŒ–é—®ç­”ç­‰ä»»åŠ¡ä¸­è¡¨ç°å“è¶Š â€”â€” åœ¨è¿™äº›åœºæ™¯ä¸­ï¼ŒæŒä¹…çš„è®°å¿†èƒ½åŠ›æ¯”ç²¾ç»†çš„å…³ç³»æ¨ç†æ›´ä¸ºå…³é”®ã€‚</p>
<p>ç„¶è€Œå…¶ä¼˜åŠ¿ä¼´éšç›¸åº”ä»£ä»·ã€‚ç”±äºå†…éƒ¨çŠ¶æ€ç»è¿‡å‹ç¼©ï¼ŒMamba æœ‰æ—¶ä¼šä¸¢å¤±ç»†èŠ‚ï¼Œåœ¨å¤æ‚çš„å¤šè·³æ¨ç†ä»»åŠ¡ä¸­è¡¨ç°åƒåŠ›ã€‚ç›®å‰ï¼Œæ–°å…´çš„æ··åˆæ¶æ„ã€å¦‚ IBM çš„ Granite 4.0ï¼Œä»¥åŠ Gemini 2.5 Proï¼ˆå¯èƒ½ï¼‰ã€‘å·²å¼€å§‹æ¢ç´¢å°† Mamba å¼çš„å¾ªç¯è®°å¿†ä¸ Transformer æ¨ç†å±‚ç»“åˆï¼Œä»¥æœŸå…¼é¡¾è®°å¿†ç¨³å®šæ€§å’Œé€»è¾‘æ·±åº¦ã€‚</p>
<p>Granite 4.0 æ··åˆæ¨¡å‹å®é™…ä¸Šé‡‡ç”¨äº† 9:1 çš„ Mamba-2 æ¨¡å—ä¸ Transformer æ¨¡å—æ¯”ä¾‹ã€‚å…¶æ ¸å¿ƒç†å¿µæ˜¯ï¼šç”± Mamba ä»¥è½»é‡é«˜æ•ˆçš„æ–¹å¼å¤„ç†å®è§‚ä¸Šä¸‹æ–‡å’Œé•¿ç¨‹è®°å¿†ï¼Œè€Œå‘¨æœŸæ€§æ’å…¥çš„ Transformer å±‚åˆ™è´Ÿè´£å¤„ç†ç²¾ç»†çš„å…³ç³»æ¨ç†ä»»åŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c43e615d8d4473ab2684d5d9458712a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537286&amp;x-signature=bmoCIGPpsQrgfkeRlO1nWIveVsA%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>05 æ¨ç†æ·±åº¦ vs. ä¸Šä¸‹æ–‡å¹¿åº¦</strong></h2>
<p>ç ”ç©¶ä¸€å†è¯å®ï¼Œä»…é æ›´é•¿çš„ä¸Šä¸‹æ–‡é•¿åº¦å¹¶ä¸èƒ½ä¿è¯ç¨³å®šçš„æ¨ç†èƒ½åŠ›ã€‚Liu ç­‰äººï¼ˆ2023ï¼‰æ­ç¤ºäº†â€œä¸­é—´è¿·å¤±â€ï¼ˆlost in the middleï¼‰æ•ˆåº”ï¼šæ¨¡å‹çš„è®°å¿†å‘ˆç°ç³»ç»Ÿæ€§çš„ U å‹æ›²çº¿ â€”â€” è¿‡åº¦å¼ºè°ƒæœ€è¿‘çš„å’Œæœ€å¼€å§‹çš„ tokenï¼Œå´å¿½è§†äº†æç¤ºè¯ä¸­é—´éƒ¨åˆ†çš„ä¿¡æ¯ã€‚è¿™ä¸€ç°è±¡åæ¥è¢«ç§°ä¸ºä¸Šä¸‹æ–‡è¡°å‡ï¼ˆcontext rotï¼‰ï¼Œå³ä¾¿åœ¨ 2025 å¹´çš„æ¨¡å‹æ¶æ„ä¸­ä¾ç„¶å­˜åœ¨ï¼Œåªæ˜¯ç¼“è§£æ‰‹æ®µæœ‰æ‰€æ¼”è¿›ã€‚IBM çš„ Granite 4.0 æ¨¡å‹ï¼ˆIBM, 2025ï¼‰å¼•å…¥äº†åˆ†å±‚è®°å¿†è·¯ç”±å’Œæ··åˆæ³¨æ„åŠ›å±‚ï¼Œèƒ½å¤Ÿæ˜¾å¼åœ°åœ¨æ•°åä¸‡ token çš„ä¸Šä¸‹æ–‡ä¸­ä¿æŒæ¯ä¸ª token çš„é‡è¦æ€§ï¼ˆè¯‘è€…æ³¨ï¼šå³å“ªäº›ä¿¡æ¯æ›´å€¼å¾—ä¿ç•™å’Œå…³æ³¨ï¼‰ï¼Œåˆæ­¥å±•ç°å‡ºè¶…è¶Šæ ‡å‡† Transformer çš„ç¨³å®šæ€§ã€‚</p>
<ul>
<li><strong>Dense Transformersï¼ˆå¦‚ GPT-5 å’Œ Mistralï¼‰</strong></li>
</ul>
<p>å®ƒä»¬çš„å¤±è´¥å¾€å¾€åœ¨äºæ¯«å˜ä¹‹å·®ï¼Œè€Œéåƒé‡Œä¹‹è°¬ã€‚ç”±äºå®ƒä»¬è¿›è¡Œå®Œæ•´æ³¨æ„åŠ›è®¡ç®—ï¼Œå¾ˆå°‘å®Œå…¨å´©æºƒï¼Œå…¶é”™è¯¯é€šå¸¸è¡¨ç°ä¸ºå¾®å¦™çš„äº‹å®å¹»è§‰ â€”â€” ä¾‹å¦‚ï¼Œç¬¬ 50,000 ä¸ª token ä¸­çš„æŸä¸ªç»†èŠ‚å‡ ä¹èƒ½è¢«æ­£ç¡®å›å¿†ï¼Œå´åœ¨å…³é”®æ•°å­—æˆ–åç§°ä¸Šå‡ºé”™ã€‚</p>
<ul>
<li><strong>Compression-Hybridsï¼ˆå¦‚ Claude 4.5ï¼‰</strong></li>
</ul>
<p>å…¶å¤±è´¥æºäºè¿‡åº¦è°¨æ…ã€‚å…¶ä¼˜åŠ¿åœ¨äºä¿æŒä¸»é¢˜è¿è´¯æ€§ï¼Œå¼±ç‚¹åˆ™æ˜¯ç»è¿‡å¯¹é½å¾®è°ƒçš„æ¨¡å‹å¯èƒ½å°†å¤§é‡ç”¨æˆ·æä¾›çš„æ–‡æœ¬ï¼ˆå¦‚æ•´éƒ¨å°è¯´ï¼‰è¯¯åˆ¤ä¸ºå—ç‰ˆæƒä¿æŠ¤çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¤¼è²Œåœ°æ‹’ç»å›ç­”ã€‚</p>
<ul>
<li><strong>Sparse and Multimodal modelsï¼ˆå¦‚ Gemini 2.5ï¼‰</strong></li>
</ul>
<p>å®ƒä»¬å…·å¤‡è¿‘ä¹å®Œç¾çš„äº‹å®å›å¿†èƒ½åŠ›ã€‚ä¸»è¦çš„å¤±è´¥ç‚¹å¾€å¾€æ¥è‡ªæ¨¡å‹å¤–å›´çš„å®‰å…¨æœºåˆ¶ï¼šåœ¨å¤„ç†æ•°ç™¾ä¸‡å¤šæ¨¡æ€ token æ—¶ï¼Œä¸€ä¸ªè¿‡äºæ•æ„Ÿçš„å®‰å…¨è¿‡æ»¤å™¨å¯èƒ½åœ¨å™ªå£°ä¸­äº§ç”Ÿè¯¯æŠ¥ï¼Œå¯¼è‡´å“åº”è¢«æå‰ä¸­æ­¢ã€‚</p>
<ul>
<li><strong>Mixture-of-Experts modelsï¼ˆå¦‚ Llama 4 å’Œ Qwenï¼‰</strong></li>
</ul>
<p>è¿™ç±»æ¨¡å‹å¯èƒ½ä¼šå› ä¸ºå‡ºç°â€œæŒ‡ä»¤æ¼‚ç§»â€æˆ–â€œä¸æ–­è¾“å‡ºé‡å¤å†…å®¹â€è€Œå¤±æ•ˆã€‚å½“å¤æ‚æŸ¥è¯¢é€¼è¿‘ä¸Šä¸‹æ–‡æé™æ—¶ï¼Œä¸“å®¶è·¯ç”±æœºåˆ¶å¯èƒ½å¼€å§‹å¤±çµï¼Œå¯¼è‡´æ¨¡å‹â€œè¿·å¤±ä½ç½®â€ï¼Œè½¬è€Œè¾“å‡ºé€šç”¨çš„æˆ–é‡å¤çš„å†…å®¹ã€‚</p>
<ul>
<li><strong>State-Space Modelsï¼ˆå¦‚ Mambaï¼‰</strong></li>
</ul>
<p>Mamba å¸¦æ¥äº†ä¸€ç§æ–°å‹çš„å¤±æ•ˆæ¨¡å¼ã€‚ç”±äºå®ƒå°†ä¿¡æ¯å­˜å‚¨ä¸ºè¿ç»­çš„å†…éƒ¨çŠ¶æ€ï¼Œé”™è¯¯é€šå¸¸è¡¨ç°ä¸ºä¿¡æ¯å‹ç¼©æŸå¤±ï¼Œè€Œéç›´æ¥çš„å¹»è§‰ã€‚æ¨¡å‹å¯èƒ½å‡†ç¡®è®°å¾—æŸäº‹å®æ›¾åœ¨åºåˆ—æ—©æœŸå‡ºç°ï¼Œä½†åœ¨è½¬è¿°æ—¶è¿›è¡Œäº†ä¸ç²¾ç¡®çš„ç®€åŒ–æˆ–æ”¹å†™ã€‚è¿™ç§ç‰¹æ€§ä½¿å…¶åœ¨è¶…é•¿ä¸Šä¸‹æ–‡ä¸­æä¸ºç¨³å®šï¼Œä½†åœ¨éœ€è¦ç²¾ç»†åˆ†ææ¨ç†ï¼ˆå°¤å…¶æ˜¯ä¾èµ–ä¸Šä¸‹æ–‡çš„æ¶ˆæ­§ä»»åŠ¡ï¼‰æ—¶å¶å°”ä¸å¤Ÿç²¾ç¡®ã€‚</p>
<p>åŒæ ·å±äº SSMï¼ˆState-Space Modelsï¼‰ èŒƒç•´çš„ï¼Œè¿˜æœ‰ IBM çš„ Granite 4.0 ç³»åˆ—ï¼Œå®ƒä»£è¡¨äº†ä¸€ç§â€œç¨ å¯†-ç¨€ç–æ··åˆâ€æ¶æ„ï¼Œç»“åˆäº†æ··åˆä¸“å®¶æ¨¡å‹ä¸è‡ªé€‚åº”å‹ç¼©çš„ç‰¹æ€§ã€‚å®ƒå¹¶éçº¯ç²¹å°† token è·¯ç”±åˆ°ä¸åŒä¸“å®¶ï¼Œè€Œæ˜¯é‡‡ç”¨åˆ†å±‚èšåˆå’Œé•¿æœŸè®°å¿†å±‚ï¼Œæ¥å‡å°‘è¿œè·ç¦»ä¿¡æ¯ä¼ é€’ä¸­çš„æ¢¯åº¦è¡°å‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/617c75be821d48e1afde1673871ee216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537286&amp;x-signature=Fpdaescw1cIxoOEcqig11i9gGrU%3D" alt="image.png" loading="lazy"/></p>
<p>æ¶æ„é€‰æ‹©ç›´æ¥å†³å®šäº†ç”¨æˆ·æ‰€èƒ½ä½“éªŒåˆ°çš„â€œé•¿ä¸Šä¸‹æ–‡â€çš„å®é™…æ•ˆæœ</p>
<h2 data-id="heading-8"><strong>06 å®é™…æƒè¡¡ä¸ä½¿ç”¨åœºæ™¯</strong></h2>
<p>ä»¥ä¸‹æ˜¯é’ˆå¯¹ä¸åŒæ¶æ„é€‰æ‹©çš„ä¸€äº›åº”ç”¨åœºæ™¯å»ºè®®ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f82e8f0014a4620a3bc86552e4ada61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537286&amp;x-signature=OJ6DSoR1hRx94ICMAzwNkwAT1ew%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9"><strong>07 æœªæ¥å‘å±•æ–¹å‘ï¼šæ›´æ™ºèƒ½ï¼Œè€Œéæ›´é•¿</strong></h2>
<p>æˆªè‡³2025å¹´æœ«ï¼Œä¸Šä¸‹æ–‡æ‰©å±•çš„é‡ç‚¹å·²éå•çº¯å¢åŠ è¯å…ƒæ•°é‡ï¼Œè€Œæ˜¯æ›´æ³¨é‡è®©æ¯ä¸ª token éƒ½æœ‰æ„ä¹‰ã€‚é«˜æ•ˆåˆ©ç”¨ä¸Šä¸‹æ–‡éœ€è¦ç»“åˆæ¶æ„è®¾è®¡ï¼ˆarchitectural designï¼‰ã€æ•°æ®æ‰©å±•ï¼ˆdata scalingï¼‰å’Œç¨‹åºåŒ–æ¨ç†ï¼ˆprocedural reasoningï¼‰ã€‚</p>
<p>æœªæ¥çš„ç³»ç»Ÿå¾ˆå¯èƒ½èåˆè¿™äº›æ–¹å‘ â€”â€”Â <strong>ç”¨çŠ¶æ€ç©ºé—´æ¨¡å‹ä¿è¯æŒä¹…è®°å¿†ï¼Œç”¨æ³¨æ„åŠ›æœºåˆ¶ä¿éšœç²¾åº¦ï¼Œå†é€šè¿‡æ¡ä»¶æ¨ç†æå‡æ•´ä½“æ•ˆç‡ã€‚</strong></p>
<p>å¼€å‘è€…åº”åœ¨ä¸åŒæ¶æ„é—´è¿›è¡Œæµ‹è¯•æ¯”è¾ƒï¼Œè€Œéä»…å…³æ³¨ä¸Šä¸‹æ–‡çª—å£å¤§å°ã€‚å¦‚æœæ¨¡å‹çš„å†…åœ¨åå¥½ï¼ˆinductive biasesï¼‰ï¼ˆæ¯”å¦‚é‡è§†å±€éƒ¨è¿è´¯æ€§ã€å‹ç¼©è¿œè·ç¦»ä¿¡æ¯ï¼‰ä¸ä»»åŠ¡ç‰¹æ€§ç›¸åŒ¹é…ï¼Œä¸€ä¸ª 128k ä¸Šä¸‹æ–‡çª—å£å¤§å°çš„ç¨€ç–æ¨¡å‹å®Œå…¨å¯èƒ½èƒœè¿‡ 1M çš„å¯†é›†æ¨¡å‹ã€‚<strong>å½’æ ¹ç»“åº•ï¼Œä¸Šä¸‹æ–‡èƒ½åŠ›æ˜¯æ¶æ„ç‰¹æ€§çš„ä½“ç°ï¼Œè€Œä¸ä»…ä»…æ˜¯è®¡ç®—é‡ï¼ˆæˆ–ç®—åŠ›è§„æ¨¡ï¼‰çš„å †ç Œç»“æœã€‚</strong></p>
<h2 data-id="heading-10"><strong>References</strong></h2>
<p>Gu, A., &amp; Dao, T. (2024). Mamba: Linear-time sequence modeling with selective state spaces. arXiv:2312.00752.</p>
<p>Liu, N. F., RÃ¶ttger, P., Misra, K., Yu, J., &amp; Levy, O. (2023). Lost in the middle: How language models use long contexts. arXiv:2307.03172</p>
<p>International Business Machines Corporation. (2025, October 2). IBM Granite 4.0: Hyper-efficient, high-performance hybrid models. IBM Newsroom. Retrieved from <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ibm.com%2Fnew%2Fannouncements%2Fibm-granite-4-0-hyper-efficient-high-performance-hybrid-models" target="_blank" title="https://www.ibm.com/new/announcements/ibm-granite-4-0-hyper-efficient-high-performance-hybrid-models" ref="nofollow noopener noreferrer">www.ibm.com/new/announcâ€¦</a></p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“æ–‡ç« æŒ‡å‡ºâ€œé•¿ä¸Šä¸‹æ–‡ç«èµ›çš„é‡ç‚¹æ­£ä»â€˜è®°å¤šé•¿â€™è½¬å‘â€˜å¦‚ä½•è®°â€™â€ã€‚ä½ æ˜¯å¦è®¤åŒè¿™æ˜¯æœªæ¥çš„ä¸»è¦æŠ€æœ¯æ–¹å‘ï¼Ÿä½ è®¤ä¸ºä¸šç•Œæ¥ä¸‹æ¥æœ€éœ€è¦çªç ´çš„æ¶æ„ç“¶é¢ˆæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2F%40ignacio.de.gregorio.noblejas%2Fis-this-the-secret-to-googles-success-over-chatgpt-b2a545f39ad5" target="_blank" title="https://medium.com/@ignacio.de.gregorio.noblejas/is-this-the-secret-to-googles-success-over-chatgpt-b2a545f39ad5" ref="nofollow noopener noreferrer">medium.com/@ignacio.deâ€¦</a></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2F%40phuocnguyen90%2Funderstanding-long-context-windows-in-ai-models-65eeb76ca20a" target="_blank" title="https://medium.com/@phuocnguyen90/understanding-long-context-windows-in-ai-models-65eeb76ca20a" ref="nofollow noopener noreferrer">medium.com/@phuocnguyeâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰‘æŒ‡offer-51ã€æ„å»ºä¹˜ç§¯æ•°ç»„]]></title>    <link>https://juejin.cn/post/7584279552434110502</link>    <guid>https://juejin.cn/post/7584279552434110502</guid>    <pubDate>2025-12-17T00:49:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584279552434110502" data-draft-id="7582896213855600655" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" å‰‘æŒ‡offer-51ã€æ„å»ºä¹˜ç§¯æ•°ç»„"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-17T00:49:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             å‰‘æŒ‡offer-51ã€æ„å»ºä¹˜ç§¯æ•°ç»„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:49:18.000Z" title="Wed Dec 17 2025 00:49:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¢˜â½¬æè¿°</h2>
<p>ç»™å®šâ¼€ä¸ªæ•°ç»„A[0,1,...,n-1] ,è¯·æ„å»ºâ¼€ä¸ªæ•°ç»„B[0,1,...,n-1] ï¼Œå…¶ä¸­B ä¸­çš„å…ƒç´ <code>B[i]=A[0]*A[1]*...*A[i-1]*A[i+1]*...*A[n-1]</code> ã€‚ä¸èƒ½ä½¿â½¤é™¤æ³•ã€‚ï¼ˆæ³¨æ„ï¼šè§„å®š<code>B[0] =A[1] * A[2] * ... * A[n-1]ï¼ŒB[n-1] = A[0] * A[1] * ... * A[n-2]</code> ï¼‰</p>
<p>å¯¹äºA â»“åº¦ä¸º1 çš„æƒ…å†µï¼ŒBâ½†æ„ä¹‰ï¼Œæ•…â½½â½†æ³•æ„å»ºï¼Œå› æ­¤è¯¥æƒ…å†µä¸ä¼šå­˜åœ¨ã€‚</p>
<p>è¾“â¼Šï¼š[1,2,3,4,5]
è¾“å‡ºï¼š[120,60,40,30,24]</p>
<h2 data-id="heading-1">æ€è·¯åŠè§£ç­”</h2>
<h3 data-id="heading-2">æš´åŠ›</h3>
<p>å¯¹æ¯ä¸ªB[i]éƒ½è®¡ç®—Aä¸­é™¤A[i]å¤–æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ï¼ŒåŒé‡å¾ªç¯ï¼Œå¤–å±‚éå†Bçš„æ¯ä¸ªä½ç½®ï¼Œå†…å±‚éå†Aæ•°ç»„è·³è¿‡å½“å‰å…ƒç´ </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] multiply(<span class="hljs-type">int</span>[] A) {
        <span class="hljs-keyword">if</span> (A == <span class="hljs-literal">null</span> || A.length &lt;= <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>]; <span class="hljs-comment">// æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œé•¿åº¦&lt;=1æ—¶è¿”å›ç©ºæ•°ç»„</span>
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> A.length;
        <span class="hljs-type">int</span>[] B = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        
        <span class="hljs-comment">// éå†æ¯ä¸ªB[i]</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// åˆå§‹åŒ–ä¹˜ç§¯ä¸º1</span>
            
            <span class="hljs-comment">// è®¡ç®—Aä¸­é™¤A[i]å¤–æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++) {
                <span class="hljs-keyword">if</span> (j != i) { <span class="hljs-comment">// è·³è¿‡å½“å‰å…ƒç´ A[i]</span>
                    product *= A[j];
                }
            }
            
            B[i] = product; <span class="hljs-comment">// å°†ç»“æœå­˜å…¥B[i]</span>
        }
        
        <span class="hljs-keyword">return</span> B;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(nÂ²)ï¼Œéœ€è¦åµŒå¥—å¾ªç¯éå†æ•°ç»„</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)ï¼Œé™¤ç»“æœæ•°ç»„å¤–åªä½¿ç”¨å¸¸æ•°ç©ºé—´</li>
</ul>
<h3 data-id="heading-3">å·¦å³ä¹˜ç§¯æ•°ç»„æ³•ï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰</h3>
<p>ä½¿ç”¨å·¦å³ä¸¤ä¸ªè¾…åŠ©æ•°ç»„å­˜å‚¨ä¹˜ç§¯ä¿¡æ¯</p>
<p>æ€è·¯ï¼šleft[i]è¡¨ç¤ºA[0]åˆ°A[i-1]çš„ä¹˜ç§¯ï¼Œright[i]è¡¨ç¤ºA[i+1]åˆ°A[n-1]çš„ä¹˜ç§¯</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] multiply(<span class="hljs-type">int</span>[] A) {
        <span class="hljs-keyword">if</span> (A == <span class="hljs-literal">null</span> || A.length &lt;= <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>];
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> A.length;
        <span class="hljs-type">int</span>[] B = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        <span class="hljs-type">int</span>[] left = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];  <span class="hljs-comment">// å­˜å‚¨å·¦ä¾§ä¹˜ç§¯</span>
        <span class="hljs-type">int</span>[] right = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n]; <span class="hljs-comment">// å­˜å‚¨å³ä¾§ä¹˜ç§¯</span>
        
        <span class="hljs-comment">// åˆå§‹åŒ–è¾¹ç•Œå€¼</span>
        left[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;     <span class="hljs-comment">// B[0]æ²¡æœ‰å·¦ä¾§å…ƒç´ ï¼Œä¹˜ç§¯ä¸º1</span>
        right[n-<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;  <span class="hljs-comment">// B[n-1]æ²¡æœ‰å³ä¾§å…ƒç´ ï¼Œä¹˜ç§¯ä¸º1</span>
        
        <span class="hljs-comment">// è®¡ç®—å·¦ä¾§ä¹˜ç§¯ï¼šleft[i] = A[0] Ã— A[1] Ã— ... Ã— A[i-1]</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; n; i++) {
            left[i] = left[i-<span class="hljs-number">1</span>] * A[i-<span class="hljs-number">1</span>];
        }
        
        <span class="hljs-comment">// è®¡ç®—å³ä¾§ä¹˜ç§¯ï¼šright[i] = A[i+1] Ã— A[i+2] Ã— ... Ã— A[n-1]</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n-<span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            right[i] = right[i+<span class="hljs-number">1</span>] * A[i+<span class="hljs-number">1</span>];
        }
        
        <span class="hljs-comment">// åˆå¹¶å·¦å³ä¹˜ç§¯å¾—åˆ°æœ€ç»ˆç»“æœï¼šB[i] = left[i] Ã— right[i]</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) {
            B[i] = left[i] * right[i];
        }
        
        <span class="hljs-keyword">return</span> B;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œä¸‰æ¬¡å•å±‚å¾ªç¯</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéœ€è¦ä¸¤ä¸ªè¾…åŠ©æ•°ç»„</li>
</ul>
<p><strong>çŸ©é˜µè§†è§’ç†è§£</strong>ï¼š å¦‚æœæŠŠé—®é¢˜çœ‹ä½œçŸ©é˜µï¼ŒB[i]å°±æ˜¯å»æ‰å¯¹è§’çº¿å…ƒç´ A[i]åï¼Œè¯¥è¡Œæ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ã€‚</p>
<pre><code class="hljs language-text" lang="text">A = [1, 2, 3, 4, 5]

B[0] = 2 Ã— 3 Ã— 4 Ã— 5 = 120  (å»æ‰A[0])
B[1] = 1 Ã— 3 Ã— 4 Ã— 5 = 60   (å»æ‰A[1])  
B[2] = 1 Ã— 2 Ã— 4 Ã— 5 = 40   (å»æ‰A[2])
</code></pre>
<p><strong>å·¦å³åˆ†è§£ç­–ç•¥ï¼š</strong></p>
<ul>
<li><code>left[i]</code>= A[0] Ã— A[1] Ã— ... Ã— A[i-1] ï¼ˆiå·¦è¾¹çš„ä¹˜ç§¯ï¼‰</li>
<li><code>right[i]</code>= A[i+1] Ã— A[i+2] Ã— ... Ã— A[n-1] ï¼ˆiå³è¾¹çš„ä¹˜ç§¯ï¼‰</li>
<li><code>B[i] = left[i] Ã— right[i]</code>ï¼ˆå·¦å³ä¹˜ç§¯ç›¸ä¹˜æ­£å¥½å»æ‰A[i]ï¼‰</li>
</ul>
<h3 data-id="heading-4">ç©ºé—´ä¼˜åŒ–ï¼ˆæ¨èï¼‰</h3>
<p>åœ¨æ–¹æ³•äºŒçš„åŸºç¡€ä¸Šä¼˜åŒ–ç©ºé—´ä½¿ç”¨ï¼Œåœ¨ç»“æœæ•°ç»„Bä¸Šç›´æ¥è¿›è¡Œå·¦å³ä¹˜ç§¯è®¡ç®—ã€‚</p>
<p>å…ˆç”¨Bæ•°ç»„å­˜å‚¨å·¦ä¾§ä¹˜ç§¯ï¼Œå†ç”¨å˜é‡åŠ¨æ€è®¡ç®—å³ä¾§ä¹˜ç§¯</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] multiply(<span class="hljs-type">int</span>[] A) {
        <span class="hljs-keyword">if</span> (A == <span class="hljs-literal">null</span> || A.length &lt;= <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>];
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> A.length;
        <span class="hljs-type">int</span>[] B = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        
        <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šè®¡ç®—å·¦ä¾§ä¹˜ç§¯å¹¶ç›´æ¥å­˜å…¥B</span>
        B[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// B[0]æ²¡æœ‰å·¦ä¾§å…ƒç´ </span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; n; i++) {
            <span class="hljs-comment">// B[i] = A[0] Ã— A[1] Ã— ... Ã— A[i-1]</span>
            B[i] = B[i-<span class="hljs-number">1</span>] * A[i-<span class="hljs-number">1</span>];
        }
        
        <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šä»å³å‘å·¦éå†ï¼Œç”¨tempå˜é‡ç´¯ç§¯å³ä¾§ä¹˜ç§¯</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// ç”¨äºç´¯ç§¯å³ä¾§ä¹˜ç§¯</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n-<span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-comment">// B[i]å½“å‰å­˜å‚¨çš„æ˜¯å·¦ä¾§ä¹˜ç§¯ï¼Œä¹˜ä»¥å³ä¾§ä¹˜ç§¯å¾—åˆ°æœ€ç»ˆç»“æœ</span>
            B[i] = B[i] * temp;
            <span class="hljs-comment">// æ›´æ–°tempï¼Œä¸ºä¸‹ä¸€ä¸ªä½ç½®ï¼ˆi-1ï¼‰å‡†å¤‡å³ä¾§ä¹˜ç§¯</span>
            temp = temp * A[i];
        }
        
        <span class="hljs-keyword">return</span> B;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œä¸¤æ¬¡éå†æ•°ç»„</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)ï¼Œé™¤ç»“æœæ•°ç»„å¤–åªä½¿ç”¨å¸¸æ•°ç©ºé—´</li>
</ul>
<p><strong>ç®—æ³•æ­¥éª¤è¯¦è§£</strong></p>
<ol>
<li>ç¬¬ä¸€æ­¥ï¼šå·¦ä¾§ä¹˜ç§¯è®¡ç®—</li>
</ol>
<pre><code class="hljs language-less" lang="less">åˆå§‹: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[0]</span> = <span class="hljs-number">1</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">1</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[1]</span> = <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[0]</span> Ã— <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[0]</span> = <span class="hljs-number">1</span> Ã— <span class="hljs-number">1</span> = <span class="hljs-number">1</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">2</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[2]</span> = <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[1]</span> Ã— <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[1]</span> = <span class="hljs-number">1</span> Ã— <span class="hljs-number">2</span> = <span class="hljs-number">2</span>  
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">3</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[3]</span> = <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[2]</span> Ã— <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[2]</span> = <span class="hljs-number">2</span> Ã— <span class="hljs-number">3</span> = <span class="hljs-number">6</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">4</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[4]</span> = <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[3]</span> Ã— <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[3]</span> = <span class="hljs-number">6</span> Ã— <span class="hljs-number">4</span> = <span class="hljs-number">24</span>
æ­¤æ—¶<span class="hljs-selector-tag">B</span> = <span class="hljs-selector-attr">[1, 1, 2, 6, 24]</span> (å­˜å‚¨çš„æ˜¯å„ä½ç½®çš„å·¦ä¾§ä¹˜ç§¯)
</code></pre>
<ol start="2">
<li>ç¬¬äºŒæ­¥ï¼šå³ä¾§ä¹˜ç§¯æ•´åˆ</li>
</ol>
<pre><code class="hljs language-less" lang="less">åˆå§‹: <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">1</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">4</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[4]</span> = <span class="hljs-number">24</span> Ã— <span class="hljs-number">1</span> = <span class="hljs-number">24</span>, <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">1</span> Ã— <span class="hljs-number">5</span> = <span class="hljs-number">5</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">3</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[3]</span> = <span class="hljs-number">6</span> Ã— <span class="hljs-number">5</span> = <span class="hljs-number">30</span>, <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">5</span> Ã— <span class="hljs-number">4</span> = <span class="hljs-number">20</span>  
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">2</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[2]</span> = <span class="hljs-number">2</span> Ã— <span class="hljs-number">20</span> = <span class="hljs-number">40</span>, <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">20</span> Ã— <span class="hljs-number">3</span> = <span class="hljs-number">60</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">1</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[1]</span> = <span class="hljs-number">1</span> Ã— <span class="hljs-number">60</span> = <span class="hljs-number">60</span>, <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">60</span> Ã— <span class="hljs-number">2</span> = <span class="hljs-number">120</span>
<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>: <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[0]</span> = <span class="hljs-number">1</span> Ã— <span class="hljs-number">120</span> = <span class="hljs-number">120</span>, <span class="hljs-selector-tag">temp</span> = <span class="hljs-number">120</span> Ã— <span class="hljs-number">1</span> = <span class="hljs-number">120</span>
æœ€ç»ˆ<span class="hljs-selector-tag">B</span> = <span class="hljs-selector-attr">[120, 60, 40, 30, 24]</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cursor å¯è§†åŒ–ç¼–è¾‘å™¨å®æµ‹ï¼šå‰ç«¯æ•ˆç‡æ–°åˆ©å™¨ï¼Œä½†ä»éœ€å®Œå–„]]></title>    <link>https://juejin.cn/post/7584353612500779049</link>    <guid>https://juejin.cn/post/7584353612500779049</guid>    <pubDate>2025-12-17T00:53:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584353612500779049" data-draft-id="7584356212800602153" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cursor å¯è§†åŒ–ç¼–è¾‘å™¨å®æµ‹ï¼šå‰ç«¯æ•ˆç‡æ–°åˆ©å™¨ï¼Œä½†ä»éœ€å®Œå–„"/> <meta itemprop="keywords" content="Cursor,AIç¼–ç¨‹,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-17T00:53:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£å“¥æ•°æ™ºè°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cursor å¯è§†åŒ–ç¼–è¾‘å™¨å®æµ‹ï¼šå‰ç«¯æ•ˆç‡æ–°åˆ©å™¨ï¼Œä½†ä»éœ€å®Œå–„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£å“¥æ•°æ™ºè°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:53:54.000Z" title="Wed Dec 17 2025 00:53:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>12æœˆ10æ—¥ï¼Œ<code>Cursor</code> å‘å¸ƒäº† 2.2 ç‰ˆæœ¬ã€‚</p>
<p>è¿™ä¸ªç‰ˆæœ¬ä¸»è¦åŒ…å«ä¸¤ä¸ªé‡å¤§ç‰¹æ€§ï¼š</p>
<ol>
<li>åœ¨ Askã€Agentã€Plan æ¨¡å¼åï¼Œå¢åŠ äº† <strong>Debug æ¨¡å¼</strong>ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿å¤§å®¶è°ƒè¯• bugã€‚</li>
<li>åŸæ¥æµ‹è¯•çš„å†…ç½®æµè§ˆå™¨å‡çº§ä¸º<strong>å¯è§†åŒ–ç¼–è¾‘å™¨</strong>äº†ï¼Œæ”¯æŒå¸ƒå±€è°ƒæ•´å’Œæ ·å¼ç¼–è¾‘ã€‚</li>
</ol>
<p>ä»Šå¤©ï¼Œå…ˆå’Œå¤§å®¶èŠèŠæµè§ˆå™¨è¿™å—å‡çº§ä½“éªŒå¦‚ä½•ã€‚</p>
<h2 data-id="heading-0">å‡çº§å†…å®¹</h2>
<p>æˆ‘å°è¯•ä¸‹æ¥ï¼Œæå‡ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>ç²¾å‡†å®šä½</li>
<li>å¯è§†åŒ–</li>
</ul>
<h3 data-id="heading-1">ç²¾å‡†å®šä½</h3>
<p>å¤§å®¶åœ¨ä½¿ç”¨ AI å¼€å‘å‰ç«¯çš„è¿‡ç¨‹ä¸­ä¸€å®šé‡åˆ°ç±»ä¼¼ä¸‹é¢çš„æƒ…å†µï¼šâ€œè¯·ä¸ºå¯¼èˆªæ ä¸­ç¬¬äºŒè¡Œç¬¬ä¸‰ä¸ªèœå•æ ·å¼å¢åŠ çƒ­ç‚¹å›¾æ ‡ï¼Œå®ƒæ˜¯æˆ‘ä»¬ç›®å‰ä¸»æ¨çš„æ´»åŠ¨ã€‚â€</p>
<p>å°±æ˜¯ç®€å•çš„ä¸€ä¸ªé«˜æ˜¾æ•ˆæœï¼Œä½†æ˜¯éœ€è¦å¾ˆå¤šé¢å¤–çš„æ–‡å­—æ¥ä¿è¯ç›®æ ‡å…ƒç´ çš„å‘½ä¸­ã€‚</p>
<p>ç°åœ¨æœ‰äº†å¯è§†åŒ–æµè§ˆå™¨ï¼Œå°±å¯ä»¥<strong>ç›´æ¥ç‚¹é€‰ç›®æ ‡</strong>ï¼Œç„¶ååŠ å…¥å¯¹è¯ï¼Œè¿›è€Œé€šè¿‡æŒ‡ä»¤è¿›è¡Œä¿®æ”¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/544fa284fa0445b1ab25a53647993f80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=hKG%2FbICqf18joC4YxiRyVC5rcjY%3D" alt="" loading="lazy"/></p>
<p>ä½†è¿™ä¸ªç‰¹æ€§åœ¨ä¹‹å‰å†…æµ‹çš„æµè§ˆå™¨åŠŸèƒ½ä¸­å·²ç»ä½“éªŒè¿‡äº†ï¼Œå¹¶ä¸ç®—å¾ˆå‡ºå½©ã€‚</p>
<h3 data-id="heading-2">å¯è§†åŒ–</h3>
<p>å¦ä¸€ä¸ªå‡çº§çš„é‡ç‚¹å°±æ˜¯å¯è§†åŒ–ã€‚</p>
<p>ç¬¬1ç‚¹ï¼Œå¢åŠ äº† <code>Design</code> å’Œ <code>CSS</code> é¢æ¿ï¼Œä¸ç”¨åœ¨ä»£ç ä¸­å³å¯å®Œæˆé¡µé¢æ•ˆæœçš„è°ƒæ•´ï¼ŒåŒ…æ‹¬æ–‡å­—å†…å®¹ã€é¢œè‰²æ ·å¼ç­‰ã€‚</p>
<p>å°¤å…¶æ˜¯ <code>Design</code> é¢æ¿ï¼Œæ˜æ‘†ç€å†² <code>Figma</code> ç­‰åŸå‹å·¥å…·å»çš„ã€‚ç°é˜¶æ®µ AI åœ¨åŸå‹åˆ¶ä½œé˜¶æ®µå·²ç»éå¸¸æœ‰æ•ˆæœäº†ï¼Œå¦‚æœå†åŠ ä¸Šå¯è§†åŒ–ç¼–è¾‘ï¼Œå¿…å°†æ›´åŠ é«˜æ•ˆã€‚</p>
<p>å¦‚æœä¿®æ”¹å†…å®¹äº†ï¼Œè®°å¾—ç‚¹å‡»â€œApplyâ€ï¼Œå¦‚æœæ“ä½œé”™è¯¯ï¼Œä¹Ÿå¯ä»¥â€œæ’¤é”€â€æˆ–è€…ç›´æ¥â€œå–æ¶ˆâ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/443a203c2d5240d79750b4d9f53d36f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=yJl9f4N%2Bs3RqNmnf0Lfcdr1%2FQWs%3D" alt="" loading="lazy"/></p>
<p>ç¬¬2ç‚¹ï¼Œæµè§ˆå™¨ä¸­çš„å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥æ‹–åŠ¨ä½ç½®ã€è°ƒæ•´å¤§å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39a56e5541b448e5abaa88aae7b049c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=weKFNyUdhUq48LrrGSRbSdTVgrQ%3D" alt="æ‹–åŠ¨ä½ç½®åçš„æ ‡é¢˜" loading="lazy"/></p>
<p>å†ä¹Ÿä¸ä¼šå‡ºç°è°ƒæ•´è¿‡å¤´ã€åå¤ä¼˜åŒ–çš„é—®é¢˜äº†ï¼Œ<strong>æ‰€è§å³æ‰€å¾—</strong>ï¼Œä¸€æ­¥åˆ°ä½ã€‚</p>
<p>è°ƒæ•´å¤§å°çš„ä½¿ç”¨ä¸æ˜¯å¾ˆç›´è§‚ï¼Œéœ€è¦å°†é¼ æ ‡æ”¾åˆ° <code>Layout</code> - <code>Dimensions</code> ä¸‹çš„ <code>W</code> ä¸Šï¼Œå½“é¼ æ ‡å˜ä¸ºåŒå‘ç®­å¤´æ—¶ï¼Œæ‹–åŠ¨å³å¯è°ƒæ•´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e223cbacbc94f5c95d443e5f4bf5d7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=elshBZmz4IRtighDq9jSesu4y3w%3D" alt="åŒå‘ç®­å¤´å¯è°ƒæ•´å®½åº¦" loading="lazy"/></p>
<h2 data-id="heading-3">æ”¹è¿›çš„åœ°æ–¹</h2>
<p>å‡çº§å†…å®¹ä½“éªŒèµ·æ¥è¿˜æ˜¯ä¸é”™çš„ï¼Œä½†è¿˜æœ‰å‡ ä¸ªåœ°æ–¹æ˜æ˜¾éœ€è¦ç»§ç»­æ”¹è¿›ã€‚</p>
<p>ä¸€ä¸ªæ˜¯ï¼Œå®˜æ–¹å®£ç§°çš„ç›´æ¥ä¿®æ”¹ <code>props</code> ç›®å‰å¥½åƒ<strong>ä»…æ”¯æŒ React å·¥ç¨‹</strong>ï¼ŒVue å·¥ç¨‹æ˜¯ä¸è¡Œçš„ï¼Œç›´æ¥æ²¡æœ‰ <code>Properties</code> éƒ¨åˆ†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f5654d9abbf4b35a136f5a8be654cbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=oVIYDCTrp7yJPojoEZwwhFJkae4%3D" alt="" loading="lazy"/></p>
<p>å¦ä¸€ä¸ªæ˜¯ï¼Œé¡µé¢å…ƒç´ æ”¯æŒç›´æ¥æ‹–åŠ¨ï¼Œä½†æ˜¯æ‹–åŠ¨å¯¼è‡´çš„ <code>DOM</code> ç»“æ„å˜åŒ–ï¼Œä¼š<strong>å½±å“åˆ°åŸæœ‰çš„æ ·å¼</strong>ã€‚åº”è¯¥å®ç°åŸæœ‰æ ·å¼åŒæ­¥ç§»åŠ¨å¹¶ä¿æŒæ•ˆæœï¼Œè¿™æ ·çš„æ‹–åŠ¨æ‰ç®—æ›´åŠ æœ‰ä»·å€¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80a6868d895c41c9b712f660313bb296~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=CzJRnWbbpUpw9CNOu0jRWyGTkZ8%3D" alt="ç¬¬äºŒæ¡ç§»åŠ¨åæ ·å¼è¢«å½±å“" loading="lazy"/></p>
<p>å†æœ‰ä¸€ä¸ªå°±æ˜¯ï¼Œ<code>Cursor Browser</code> å¼€æ”¾äº†å¼€å‘è€…å·¥å…·ï¼ŒåŒ…æ‹¬å¤§å®¶å¸¸ç”¨çš„ <code>Console</code> é€‰é¡¹å¡ã€‚</p>
<p>ä½†æ˜¯ï¼Œç›®å‰ <code>Console</code> ä¸­å‡ºç°çš„<strong>é”™è¯¯</strong>ï¼Œå¹¶ä¸èƒ½åƒ <code>TRAE</code> ä¸€æ ·ç›´æ¥<strong>ç‚¹é€‰åŠ å…¥å¯¹è¯</strong>ï¼Œéœ€è¦å¤åˆ¶ç²˜è´´ï¼Œä¸å¤Ÿä¸€ä½“åŒ–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbfd024bd08d42d1aea5d4f61d6b7137~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537633&amp;x-signature=IyDx5XXi0H758kNFEOJ3RH%2FT1sY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">ç»“è¯­</h2>
<p>åœ¨æˆ‘çš„ä½¿ç”¨å†ç¨‹ä¸­ï¼Œå†…ç½®æµè§ˆå™¨åŠç›¸å…³ç‰¹æ€§æ˜¯ç”± <code>TRAE</code> æœ€å…ˆæå‡ºå¹¶å®ç°çš„ï¼Œä½†ç›®å‰ <code>Cursor</code> æ˜æ˜¾åšçš„æ›´åŠ æ·±å…¥äº†ã€‚</p>
<p>å…¶å®æˆ‘æŒºå¸Œæœ›ä»–ä»¬å¯ä»¥ç›¸äº’â€œå€Ÿé‰´â€ï¼Œæ¯•ç«Ÿï¼Œ<strong>å€¼å¾—â€œå€Ÿé‰´â€çš„è‚¯å®šæ˜¯åå“å¥½çš„ç‰¹æ€§ï¼Œè¶Šæ¥è¶Šå¤šå¥½ç‰¹æ€§çš„å‡çº§ï¼Œå¿…ç„¶å¸¦æ¥ AI å¼€å‘çš„æ–°ä½“éªŒ</strong>ã€‚</p>
<p>æœŸå¾…åç»­å„å®¶çš„å‡çº§~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ CSS ä¼ªç±»å’Œä¼ªå…ƒç´ çš„æœ¬è´¨åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7584266184882880546</link>    <guid>https://juejin.cn/post/7584266184882880546</guid>    <pubDate>2025-12-17T00:54:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584266184882880546" data-draft-id="7576936862632411136" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ CSS ä¼ªç±»å’Œä¼ªå…ƒç´ çš„æœ¬è´¨åŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2025-12-17T00:54:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ CSS ä¼ªç±»å’Œä¼ªå…ƒç´ çš„æœ¬è´¨åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T00:54:34.000Z" title="Wed Dec 17 2025 00:54:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å†™å‰ç«¯CSSæ ·å¼çš„æ—¶å€™ï¼Œç»å¸¸ç”¨åˆ°è¿™ç§<code>:hover</code>æˆ–è€…<code>::before</code>æœ‰å†’å·çš„å†™æ³•ã€‚æˆ‘å¾ˆç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆæœ‰äº›æ˜¯å•å†’å·ï¼Œæœ‰äº›åˆæ˜¯åŒå†’å·å‘¢ï¼Ÿ</p>
<p>åæ¥æˆ‘æ‰çŸ¥é“è¿™ç§å†™æ³•ä¹ŸåŒºåˆ†ä¸º<strong>ä¼ªç±»</strong>å’Œ<strong>ä¼ªå…ƒç´ </strong>ã€‚</p>
<h3 data-id="heading-0">ä¼ªç±»å’Œä¼ªå…ƒç´ æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>ä¼ªç±»ï¼ˆPseudo-classesï¼‰</strong>ï¼šâ€‹ç”¨äºé€‰æ‹©å¤„äºç‰¹å®šçŠ¶æ€çš„å…ƒç´ ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼Œå½“å…ƒç´ å¤„äºæŸç§çŠ¶æ€çš„æ—¶å€™ï¼Œç»™å®ƒåŠ ä¸Šä¸€ä¸ªâ€œç±»â€æ¥å®šä¹‰æ ·å¼ã€‚</p>
<ul>
<li>è¯­æ³•ï¼šâ€‹å•ä¸ªå†’å·<code>:</code>ï¼Œä¾‹å¦‚<code>:hover</code></li>
</ul>
<p><strong>ä¼ªå…ƒç´ ï¼ˆPseudo-elementsï¼‰</strong>ï¼šç”¨äºé€‰æ‹©å…ƒç´ çš„ç‰¹å®šéƒ¨åˆ†ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œå®ƒåœ¨æ–‡æ¡£ä¸­åˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿçš„â€œå…ƒç´ â€æ¥è®¾ç½®æ ·å¼ã€‚</p>
<ul>
<li>è¯­æ³•ï¼šåŒå†’å·<code>::</code>ï¼Œä¾‹å¦‚<code>::before</code></li>
</ul>
<hr/>
<h3 data-id="heading-1">åªè¦æ˜¯å•ä¸ªå†’å·çš„å°±ä¸€å®šæ˜¯ä¼ªå…ƒç´ å—ï¼Ÿ</h3>
<p>åœ¨ç°ä»£CSS3ç‚¹è§„èŒƒä¸­ï¼Œæ‰€æœ‰ä½¿ç”¨åŒå†’å·<code>::</code>è¯­æ³•çš„é€‰æ‹©å™¨éƒ½è¢«å®šä¹‰ä¸ºä¼ªå…ƒç´ ã€‚è¿™æ˜¯W3Cä¸ºäº†æ˜ç¡®åŒºåˆ†ä¼ªç±»å’Œä¼ªå…ƒç´ è€Œå¼•å…¥çš„çº¦å®šã€‚</p>
<p>ä½†åœ¨æ—©æœŸçš„CSSä¸­ï¼Œä¼ªå…ƒç´ ä¹Ÿä½¿ç”¨å•å†’å·ï¼Œå› ä¸ºå½“æ—¶æ²¡æœ‰åŒºåˆ†è¯­æ³•ã€‚æ‰€ä»¥ä¸ºäº†å‘åå…¼å®¹ï¼Œå¤§å¤šæ•°çš„æµè§ˆå™¨è¿˜æ˜¯ä¼šæ”¯æŒ<code>:before</code>ã€<code>:after</code>ç­‰å•å†’å·çš„å†™æ³•ã€‚</p>
<p>ä½†æ–°çš„ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·ï¼Œæ¯”å¦‚ï¼š<code>::selection</code>ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¼ªç±»ï¼ˆPseudo-classesï¼‰</h3>
<p>ä¼ªç±»ç”¨äº<strong>é€‰æ‹©å¤„äºç‰¹å®šçŠ¶æ€çš„å…ƒç´ </strong>ï¼Œæ¯”å¦‚ç”¨æˆ·äº¤äº’çŠ¶æ€ã€ç»“æ„ä½ç½®ç­‰ã€‚</p>
<h4 data-id="heading-3">å¸¸è§ä¼ªç±»ç¤ºä¾‹ï¼š</h4>
<ul>
<li><code>:hover</code>ï¼šé¼ æ ‡æ‚¬åœæ—¶</li>
<li><code>:focus</code>ï¼šå…ƒç´ è·å¾—ç„¦ç‚¹æ—¶ï¼ˆå¦‚è¾“å…¥æ¡†ï¼‰</li>
<li><code>:active</code>ï¼šå…ƒç´ è¢«æ¿€æ´»æ—¶ï¼ˆå¦‚ç‚¹å‡»æŒ‰é’®ï¼‰</li>
<li><code>:visited</code>ï¼šé“¾æ¥å·²è¢«è®¿é—®è¿‡</li>
<li><code>:first-child</code> / <code>:last-child</code>ï¼šç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ªå­å…ƒç´ </li>
<li><code>:nth-child(n)</code>ï¼šç¬¬ n ä¸ªå­å…ƒç´ </li>
<li><code>:not(selector)</code>ï¼šæ’é™¤åŒ¹é… selector çš„å…ƒç´ </li>
</ul>
<h4 data-id="heading-4">ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">color</span>: red;
}

<span class="hljs-selector-tag">input</span><span class="hljs-selector-pseudo">:focus</span> {
  <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid blue;
}

<span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:first</span>-child {
  <span class="hljs-attribute">font-weight</span>: bold;
}
</code></pre>
<p>ä¼ªç±»ä½¿ç”¨<strong>å•å†’å·</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-5">ä¼ªå…ƒç´ ï¼ˆPseudo-elementsï¼‰</h3>
<p>ä¼ªå…ƒç´ ç”¨äº<strong>åˆ›å»ºå¹¶æ ·å¼åŒ–æ–‡æ¡£ä¸­ä¸å­˜åœ¨çš„è™šæ‹Ÿå…ƒç´ </strong>ï¼Œæ¯”å¦‚æ®µè½é¦–å­—æ¯ã€é€‰ä¸­æ–‡æœ¬ã€å…ƒç´ å‰åæ’å…¥å†…å®¹ç­‰ã€‚</p>
<h4 data-id="heading-6">å¸¸è§ä¼ªå…ƒç´ ï¼š</h4>
<ul>
<li><code>::before</code>ï¼šåœ¨å…ƒç´ å†…å®¹å‰æ’å…¥å†…å®¹</li>
<li><code>::after</code>ï¼šåœ¨å…ƒç´ å†…å®¹åæ’å…¥å†…å®¹</li>
<li><code>::first-letter</code>ï¼šæ®µè½çš„ç¬¬ä¸€ä¸ªå­—æ¯</li>
<li><code>::first-line</code>ï¼šæ®µè½çš„ç¬¬ä¸€è¡Œ</li>
<li><code>::selection</code>ï¼šç”¨æˆ·é€‰ä¸­çš„æ–‡æœ¬ï¼ˆéƒ¨åˆ†æµè§ˆå™¨éœ€åŠ å‰ç¼€ï¼‰</li>
</ul>
<h4 data-id="heading-7">ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">p</span><span class="hljs-selector-pseudo">::first-letter</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2em</span>;
  <span class="hljs-attribute">color</span>: gold;
}

<span class="hljs-selector-class">.quote</span><span class="hljs-selector-pseudo">::before</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">"â€œ"</span>;
}

<span class="hljs-selector-class">.quote</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">"â€"</span>;
}

<span class="hljs-selector-pseudo">::selection</span> {
  <span class="hljs-attribute">background</span>: yellow;
  <span class="hljs-attribute">color</span>: black;
}
</code></pre>
<p>ä¼ªå…ƒç´ ä½¿ç”¨<strong>åŒå†’å·</strong>ï¼ˆ<code>::before</code>ï¼‰ï¼Œè¿™æ˜¯CSS3çš„è§„èŒƒå†™æ³•ã€‚å‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œæ—§ä»£ç å¯èƒ½ä»ç”¨å•å†’å·ï¼ˆå¦‚<code>:before</code>ï¼‰ï¼Œç°ä»£é¡¹ç›®å»ºè®®ç”¨åŒå†’å·ã€‚</p>
<hr/>
<h3 data-id="heading-8">ä¸»è¦åŒºåˆ«</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ªç±»ï¼ˆPseudo-classï¼‰</th><th>ä¼ªå…ƒç´ ï¼ˆPseudo-elementï¼‰</th></tr></thead><tbody><tr><td>ä½œç”¨å¯¹è±¡</td><td>å·²å­˜åœ¨çš„å…ƒç´ çš„<strong>çŠ¶æ€æˆ–ä½ç½®</strong></td><td>åˆ›å»º<strong>ä¸å­˜åœ¨çš„è™šæ‹Ÿå†…å®¹æˆ–éƒ¨åˆ†</strong></td></tr><tr><td>è¯­æ³•</td><td>å•å†’å·ï¼ˆå¦‚ <code>:hover</code>ï¼‰</td><td>åŒå†’å·ï¼ˆå¦‚ <code>::before</code>ï¼‰</td></tr><tr><td>æ˜¯å¦ç”Ÿæˆå†…å®¹</td><td>å¦</td><td>æ˜¯ï¼ˆå¸¸é…åˆ <code>content</code> å±æ€§ï¼‰</td></tr><tr><td>ç¤ºä¾‹</td><td><code>a:hover</code>, <code>:nth-child(2)</code></td><td><code>::first-letter</code>, <code>::after</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-9">ç¤ºä¾‹æ•ˆæœ</h3>
<p>ä¸€ä¸ªç®€å•çš„å¾…åŠäº‹é¡¹åˆ—è¡¨
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0592bd2d56b48c689768cb07b368be4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5aSn5Y2O:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766537673&amp;x-signature=%2FiRwnx4WTNIkf3UjEJUqOy02d6A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-10">å®Œæ•´ä»£ç </h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ä¼ªç±»vsä¼ªå…ƒç´ ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.container</span> {
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">30px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">30px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);
        }

        <span class="hljs-selector-tag">h1</span> {
            <span class="hljs-attribute">text-align</span>: center;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#2c3e50</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
        }

        <span class="hljs-selector-class">.explanation</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f8f9fa</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border-left</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#3498db</span>;
        }

        <span class="hljs-selector-class">.todo-list</span> {
            <span class="hljs-attribute">list-style</span>: none;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }

        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#e9ecef</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
            <span class="hljs-attribute">position</span>: relative;
        }

        <span class="hljs-comment">/* === ä¼ªç±»æ ·å¼ === */</span>
        <span class="hljs-comment">/* ç¬¬ä¸€ä¸ªå­å…ƒç´  */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:first</span>-child {
            <span class="hljs-attribute">border-left</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#e74c3c</span>;
        }

        <span class="hljs-comment">/* å¶æ•°é¡¹ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:nth-child</span>(even) {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f8f9fa</span>;
        }

        <span class="hljs-comment">/* æ‚¬åœæ•ˆæœ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#aab49b</span>;
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">10px</span>);
            <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#aab49b</span>;
        }

        <span class="hljs-comment">/* ç‚¹å‡»æ•ˆæœ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:active</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2ecc71</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.98</span>);
        }

        <span class="hljs-comment">/* === ä¼ªå…ƒç´ æ ·å¼ === */</span>
        <span class="hljs-comment">/* å‰é¢çš„å›¾æ ‡ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">::before</span> {
            <span class="hljs-attribute">content</span>: <span class="hljs-string">"ğŸ“Œ"</span>;
            <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
        }

        <span class="hljs-comment">/* æ‚¬åœæ—¶å›¾æ ‡å˜åŒ– */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::before</span> {
            <span class="hljs-attribute">content</span>: <span class="hljs-string">"ğŸ”¥"</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.2</span>);
        }

        <span class="hljs-comment">/* åé¢çš„è£…é¥°çº¿ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">::after</span> {
            <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">90deg</span>, <span class="hljs-number">#e74c3c</span>, <span class="hljs-number">#669521</span>);
            <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.3s</span> ease;
        }

        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::after</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        }

        <span class="hljs-comment">/* é¦–å­—æ¯æ ·å¼ */</span>
        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">::first-letter</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.3em</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#2c3e50</span>;
            <span class="hljs-attribute">font-weight</span>: bold;
        }

        <span class="hljs-selector-class">.todo-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::first-letter</span> {
            <span class="hljs-attribute">color</span>: white;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä¼ªç±» vs ä¼ªå…ƒç´  æ¼”ç¤º<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ä¼ªç±»ï¼ˆPseudo-classï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>ï¼šé€‰æ‹©å…ƒç´ çš„ç‰¹å®š<span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>çŠ¶æ€<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ä¼ªå…ƒç´ ï¼ˆPseudo-elementï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>ï¼šé€‰æ‹©å…ƒç´ çš„ç‰¹å®š<span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>éƒ¨åˆ†<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å­¦ä¹  CSS ä¼ªç±»<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç†è§£ä¼ªå…ƒç´ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å®Œæˆé¡¹ç›®ç»ƒä¹ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å¤ä¹ çŸ¥è¯†ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// æ·»åŠ ç‚¹å‡»åˆ‡æ¢å®ŒæˆçŠ¶æ€çš„åŠŸèƒ½</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.todo-list li'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
            item.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(<span class="hljs-string">'completed'</span>);
            });
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ï¼š</p>
<h4 data-id="heading-11">ä¼ªç±»ï¼ˆæ“ä½œçš„æ˜¯æ•´ä¸ªå…ƒç´ ï¼‰</h4>
<ul>
<li><code>:first-child</code>ï¼šæ“ä½œç¬¬ä¸€ä¸ª<code>&lt;li&gt;</code>å…ƒç´ çš„æ•´ä½“æ ·å¼</li>
<li><code>:nth-child(even)</code>ï¼šæ“ä½œå¶æ•°ä½ç½®<code>&lt;li&gt;</code>çš„æ•´ä½“èƒŒæ™¯</li>
<li><code>:hover</code>ï¼šæ“ä½œé¼ æ ‡æ‚¬åœæ—¶<code>&lt;li&gt;</code>çš„æ•´ä½“çŠ¶æ€å˜åŒ–</li>
</ul>
<h4 data-id="heading-12">ä¼ªå…ƒç´ ï¼ˆæ“ä½œçš„æ˜¯å…ƒç´ çš„ä¸€éƒ¨åˆ†ï¼‰</h4>
<ul>
<li><code>::before</code>ï¼šåœ¨<code>&lt;li&gt;</code>å†…å®¹ä¹‹å‰æ’å…¥æ–°å†…å®¹ï¼ˆå›¾æ ‡ï¼‰</li>
<li><code>::after</code>ï¼šåœ¨<code>&lt;li&gt;</code>å†…å®¹ä¹‹åæ’å…¥è£…é¥°çº¿æ¡</li>
<li><code>::first-letter</code>ï¼šåªæ ·å¼åŒ–<code>&lt;li&gt;</code>æ–‡æœ¬çš„ç¬¬ä¸€ä¸ªå­—æ¯</li>
</ul>
<p><strong>ç®€å•è®°å¿†</strong>ï¼šä¼ªç±»æ˜¯çŠ¶æ€é€‰æ‹©å™¨ï¼Œä¼ªå…ƒç´ æ˜¯å†…å®¹ç”Ÿæˆå™¨ã€‚</p>
<hr/>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p><strong>ä¼ªç±»</strong>ï¼š</p>
<ul>
<li>é€‰æ‹©å…ƒç´ çš„<strong>ç‰¹å®šçŠ¶æ€</strong>ï¼ˆå¦‚:hoverã€:focusï¼‰</li>
<li>è¯­æ³•ä½¿ç”¨<strong>å•å†’å·</strong>ï¼ˆå¦‚<code>:hover</code>ï¼‰</li>
<li>ä¸ç”Ÿæˆæ–°å†…å®¹ï¼Œåªé’ˆå¯¹å…ƒç´ æœ¬èº«çš„çŠ¶æ€å˜åŒ–</li>
<li>å¸¸è§ç”¨é€”ï¼šç”¨æˆ·äº¤äº’åé¦ˆã€ç»“æ„ä½ç½®é€‰æ‹©</li>
</ul>
<p><strong>ä¼ªå…ƒç´ </strong>ï¼š</p>
<ul>
<li>åˆ›å»ºå¹¶æ ·å¼åŒ–å…ƒç´ çš„<strong>ç‰¹å®šéƒ¨åˆ†</strong>æˆ–<strong>è™šæ‹Ÿå†…å®¹</strong></li>
<li>è¯­æ³•ä½¿ç”¨<strong>åŒå†’å·</strong>ï¼ˆå¦‚<code>::before</code>ï¼‰</li>
<li>å¸¸é…åˆ<code>content</code>å±æ€§ç”Ÿæˆæ–°å†…å®¹</li>
<li>å¸¸è§ç”¨é€”ï¼šæ’å…¥è£…é¥°å…ƒç´ ã€æ ·å¼åŒ–æ–‡æœ¬éƒ¨åˆ†</li>
</ul>
<p>é€šè¿‡ä¸Šé¢çš„å†…å®¹ï¼Œæˆ‘ä¹Ÿç»ˆäºææ‡‚äº†ä¼ªç±»å’Œä¼ªå…ƒç´ çš„åŒºåˆ«ã€‚</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-14">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6V83qjR6u0nyfzL-14xYAw" target="_blank" title="https://mp.weixin.qq.com/s/6V83qjR6u0nyfzL-14xYAw" ref="nofollow noopener noreferrer">ã€Šasync/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FPQ_w7CDVoIZPn-CVH2DKJg" target="_blank" title="https://mp.weixin.qq.com/s/PQ_w7CDVoIZPn-CVH2DKJg" ref="nofollow noopener noreferrer">ã€ŠVue3 å’Œ Vue2 çš„æ ¸å¿ƒåŒºåˆ«ï¼Ÿå¾ˆå¤šå¼€å‘è€…éƒ½æ²¡å®Œå…¨ææ‡‚çš„ 10 ä¸ªç»†èŠ‚ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqI3TRTdDfRJSH9kCTqAQUw" target="_blank" title="https://mp.weixin.qq.com/s/qI3TRTdDfRJSH9kCTqAQUw" ref="nofollow noopener noreferrer">ã€Šè¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C#.NET ref struct æ·±åº¦è§£æï¼šè¯­ä¹‰ã€é™åˆ¶ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7584266184882700322</link>    <guid>https://juejin.cn/post/7584266184882700322</guid>    <pubDate>2025-12-16T23:19:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584266184882700322" data-draft-id="7584286241488535592" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C#.NET ref struct æ·±åº¦è§£æï¼šè¯­ä¹‰ã€é™åˆ¶ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="C#,.NET"/> <meta itemprop="datePublished" content="2025-12-16T23:19:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”é’æ«"/> <meta itemprop="url" content="https://juejin.cn/user/3737995266234280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C#.NET ref struct æ·±åº¦è§£æï¼šè¯­ä¹‰ã€é™åˆ¶ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3737995266234280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”é’æ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T23:19:59.000Z" title="Tue Dec 16 2025 23:19:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ç®€ä»‹</h3>
<p><code>ref struct</code> æ˜¯ <code>C# 7.2</code> å¼•å…¥çš„ä¸€ç§ç‰¹æ®Šç»“æ„ä½“ç±»å‹ï¼Œ
å®ƒä¸æ™®é€š <code>struct</code> çš„æœ€å¤§åŒºåˆ«æ˜¯ ä¸¥æ ¼é™åˆ¶å…¶åˆ†é…ä½ç½®ï¼š</p>
<p><code>ref struct</code> åªèƒ½åˆ†é…åœ¨æ ˆï¼ˆ<code>stack</code>ï¼‰ä¸Šï¼Œä¸èƒ½åˆ†é…åœ¨å †ï¼ˆ<code>heap</code>ï¼‰ä¸Šã€‚</p>
<p>âš¡ è®¾è®¡åˆè¡·</p>
<ul>
<li>
<p>æé«˜æ€§èƒ½ï¼šæ ˆåˆ†é…æ¯”å †åˆ†é…å¿«ï¼Œå¹¶ä¸”æ— éœ€ <code>GC</code> å›æ”¶ã€‚</p>
</li>
<li>
<p>æä¾›å®‰å…¨çš„å†…å­˜è®¿é—®ï¼šä¿è¯ç”Ÿå‘½å‘¨æœŸå—æ§ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºå¼•ç”¨ã€‚</p>
</li>
<li>
<p>é€‚ç”¨äºéœ€è¦ç›´æ¥æ“ä½œå†…å­˜çš„åœºæ™¯ï¼Œä¾‹å¦‚ <code>Span&lt;T&gt;</code>ã€<code>ReadOnlySpan&lt;T&gt;</code>ã€‚</p>
</li>
</ul>
<h4 data-id="heading-1">å…³é”®ç‰¹æ€§</h4>
<ul>
<li>
<p>åªèƒ½åˆ†é…åœ¨æ ˆä¸Šï¼Œä¸èƒ½åˆ†é…åœ¨å †ä¸Š</p>
</li>
<li>
<p>ä¸èƒ½ä½œä¸ºç±»çš„å­—æ®µ</p>
</li>
<li>
<p>ä¸èƒ½å®ç°æ¥å£</p>
</li>
<li>
<p>ä¸èƒ½è£…ç®±</p>
</li>
<li>
<p>ä¸èƒ½ä½œä¸ºå¼‚æ­¥æ–¹æ³•æˆ–è¿­ä»£å™¨çš„å±€éƒ¨å˜é‡</p>
</li>
</ul>
<h3 data-id="heading-2">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">ref</span> <span class="hljs-keyword">struct</span> MyStruct
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Y;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Print</span>()</span> =&gt; Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{X}</span>, <span class="hljs-subst">{Y}</span>"</span>);
}
</code></pre>
<h3 data-id="heading-3">ä¸æ™®é€š struct çš„åŒºåˆ«</h3>













































<table><thead><tr><th>ç‰¹æ€§</th><th><code>struct</code></th><th><code>ref struct</code></th></tr></thead><tbody><tr><td>åˆ†é…ä½ç½®</td><td>æ ˆæˆ–å †ï¼ˆä¾‹å¦‚åœ¨ç±»ä¸­æˆ–è£…ç®±æ—¶ï¼‰</td><td><strong>åªèƒ½æ ˆåˆ†é…</strong></td></tr><tr><td>è£…ç®±ï¼ˆboxingï¼‰</td><td>æ”¯æŒï¼ˆå¯è½¬ä¸º <code>object</code>ï¼‰</td><td>âŒ ç¦æ­¢</td></tr><tr><td>æ¥å£å®ç°</td><td>æ”¯æŒ</td><td>âŒ ç¦æ­¢ï¼ˆä¸èƒ½å®ç°æ¥å£ï¼‰</td></tr><tr><td>å¼‚æ­¥æ–¹æ³•/è¿­ä»£å™¨</td><td>æ”¯æŒ</td><td>âŒ ä¸èƒ½è¢« <code>async</code>/<code>yield</code> æ•è·</td></tr><tr><td>é—­åŒ…æ•è·</td><td>æ”¯æŒ</td><td>âŒ ç¦æ­¢</td></tr><tr><td>æ³›å‹çº¦æŸ</td><td>å¯ä½œä¸ºæ³›å‹å‚æ•°</td><td>âŒ ç¦æ­¢ç”¨ä½œç±»æ³›å‹å‚æ•°</td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸ</td><td>å— GC ç®¡ç†</td><td><strong>å®Œå…¨å—æ ˆä½œç”¨åŸŸçº¦æŸ</strong></td></tr></tbody></table>
<p><code>ref struct</code> çš„é™åˆ¶ç¡®ä¿å®ƒ ä¸ä¼šè¢«é”™è¯¯åœ°æå‡åˆ°å †ä¸­ï¼Œä¿è¯å…¶ç”Ÿå‘½å‘¨æœŸå®‰å…¨ã€‚</p>
<h3 data-id="heading-4">ä½¿ç”¨åœºæ™¯</h3>
<p><code>ref struct</code> éå¸¸é€‚åˆä»¥ä¸‹ é«˜æ€§èƒ½ã€ä½å¼€é”€ çš„åœºæ™¯ï¼š</p>

























<table><thead><tr><th>åœºæ™¯</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>å†…å­˜åˆ‡ç‰‡</strong></td><td><code>Span&lt;T&gt;</code>ã€<code>ReadOnlySpan&lt;T&gt;</code></td></tr><tr><td><strong>é¿å… GC</strong></td><td>é«˜é¢‘åˆ†é…å’Œé‡Šæ”¾çš„ä¸´æ—¶æ•°æ®ç»“æ„</td></tr><tr><td><strong>éæ‰˜ç®¡èµ„æºè®¿é—®</strong></td><td>æŒ‡é’ˆæ“ä½œã€<code>stackalloc</code> åˆ†é…çš„ç¼“å†²åŒº</td></tr><tr><td><strong>ç½‘ç»œä¸æ•°æ®è§£æ</strong></td><td>é«˜æ€§èƒ½åºåˆ—åŒ–/ååºåˆ—åŒ–ï¼ˆå¦‚ JSONã€Protocol Buffersï¼‰</td></tr></tbody></table>
<h3 data-id="heading-5">å…¸å‹ç¤ºä¾‹</h3>
<h4 data-id="heading-6"><code>Span&lt;T&gt;</code>ï¼šæœ€å¸¸è§çš„ ref struct</h4>
<p><code>Span&lt;T&gt;</code> æ˜¯ä¸€ä¸ªè¡¨ç¤ºè¿ç»­å†…å­˜åŒºåŸŸçš„ç±»å‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">Span&lt;<span class="hljs-built_in">int</span>&gt; numbers = <span class="hljs-keyword">stackalloc</span> <span class="hljs-built_in">int</span>[<span class="hljs-number">5</span>] { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };
numbers[<span class="hljs-number">2</span>] = <span class="hljs-number">99</span>;

<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> numbers)
    Console.Write(<span class="hljs-string">$"<span class="hljs-subst">{n}</span> "</span>); <span class="hljs-comment">// è¾“å‡º: 1 2 99 4 5</span>
</code></pre>
<ul>
<li>
<p><code>stackalloc</code> åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ã€‚</p>
</li>
<li>
<p><code>Span&lt;T&gt;</code> åªèƒ½å­˜åœ¨äºå½“å‰æ–¹æ³•æ ˆä¸­ï¼Œç¦»å¼€ä½œç”¨åŸŸè‡ªåŠ¨å›æ”¶ã€‚</p>
</li>
</ul>
<h4 data-id="heading-7">è‡ªå®šä¹‰ ref struct</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">ref</span> <span class="hljs-keyword">struct</span> Point
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Y;

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> Length =&gt; Math.Sqrt(X * X + Y * Y);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Demo</span>()</span>
{
    <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> Point { X = <span class="hljs-number">3</span>, Y = <span class="hljs-number">4</span> };
    Console.WriteLine(p.Length); <span class="hljs-comment">// 5</span>
}
</code></pre>
<h4 data-id="heading-8">ä¸ stackalloc é…åˆ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Span&lt;<span class="hljs-built_in">byte</span>&gt; <span class="hljs-title">CreateBuffer</span>()</span>
{
    Span&lt;<span class="hljs-built_in">byte</span>&gt; buffer = <span class="hljs-keyword">stackalloc</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1024</span>]; <span class="hljs-comment">// æ ˆä¸Šåˆ†é… 1KB</span>
    buffer[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>;
    <span class="hljs-keyword">return</span> buffer; <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½è¿”å› ref struct</span>
}
</code></pre>
<p>è¿”å› <code>Span&lt;T&gt;</code> ä¼šå¯¼è‡´æ ˆå†…å­˜é€ƒé€¸ï¼Œå› æ­¤ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p>
<h3 data-id="heading-9">ç¼–è¯‘å™¨æ–½åŠ çš„çº¦æŸ</h3>
<p><code>ref struct</code> çš„å®‰å…¨é™åˆ¶ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<h4 data-id="heading-10">ä¸èƒ½è£…ç®±</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">ref</span> <span class="hljs-keyword">struct</span> MyStruct { }
<span class="hljs-built_in">object</span> o = <span class="hljs-keyword">new</span> MyStruct(); <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<p>å› ä¸ºè£…ç®±ä¼šå°†å€¼ç±»å‹å¤åˆ¶åˆ°å †ä¸Šã€‚</p>
<h4 data-id="heading-11">ä¸èƒ½å®ç°æ¥å£</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">ref</span> <span class="hljs-keyword">struct</span> MyStruct : IDisposable { } <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<p>æ¥å£è°ƒç”¨å¯èƒ½å¯¼è‡´æå‡åˆ°å †ï¼Œç ´åç”Ÿå‘½å‘¨æœŸå®‰å…¨ã€‚</p>
<h4 data-id="heading-12">ä¸èƒ½ä½œä¸ºç±»å­—æ®µ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span>
{
    <span class="hljs-keyword">public</span> Span&lt;<span class="hljs-built_in">int</span>&gt; SpanField; <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
}
</code></pre>
<p>å› ä¸ºç±»å®ä¾‹åœ¨å †ä¸Šï¼Œè€Œ <code>ref struct</code> åªèƒ½å­˜åœ¨æ ˆä¸Šã€‚</p>
<h4 data-id="heading-13">ä¸èƒ½ç”¨ä½œæ³›å‹å‚æ•°</h4>
<pre><code class="hljs language-csharp" lang="csharp">List&lt;Span&lt;<span class="hljs-built_in">int</span>&gt;&gt; list = <span class="hljs-keyword">new</span>(); <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<h4 data-id="heading-14">ä¸èƒ½æ•è·åˆ°é—­åŒ…</h4>
<pre><code class="hljs language-csharp" lang="csharp">Span&lt;<span class="hljs-built_in">int</span>&gt; span = <span class="hljs-keyword">stackalloc</span> <span class="hljs-built_in">int</span>[<span class="hljs-number">10</span>];
Action action = () =&gt; Console.WriteLine(span[<span class="hljs-number">0</span>]); <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<p>é—­åŒ…ä¼šå°†å˜é‡æå‡åˆ°å †ä¸­ï¼Œç ´åç”Ÿå‘½å‘¨æœŸã€‚</p>
<h4 data-id="heading-15">ä¸èƒ½ç”¨äºå¼‚æ­¥æ–¹æ³•/è¿­ä»£å™¨</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">Demo</span>()</span>
{
    Span&lt;<span class="hljs-built_in">int</span>&gt; span = <span class="hljs-keyword">stackalloc</span> <span class="hljs-built_in">int</span>[<span class="hljs-number">10</span>]; <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
    <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">1000</span>);
}
</code></pre>
<p>å¼‚æ­¥çŠ¶æ€æœºä¼šå¯¼è‡´å˜é‡åœ¨å †ä¸Šå­˜å‚¨ã€‚</p>
<h3 data-id="heading-16">ä¸å…¶ä»–ç±»å‹å¯¹æ¯”</h3>















































<table><thead><tr><th>ç‰¹æ€§</th><th><code>class</code></th><th><code>struct</code></th><th><code>ref struct</code></th></tr></thead><tbody><tr><td>åˆ†é…ä½ç½®</td><td>å †</td><td>æ ˆ/å †</td><td><strong>ä»…æ ˆ</strong></td></tr><tr><td>å†…å­˜å›æ”¶</td><td>GC</td><td>è‡ªåŠ¨å›æ”¶/GC</td><td>è‡ªåŠ¨å›æ”¶ï¼ˆæ–¹æ³•é€€å‡ºæ—¶ï¼‰</td></tr><tr><td>æ¥å£å®ç°</td><td>âœ…</td><td>âœ…</td><td>âŒ</td></tr><tr><td>è£…ç®±/æ‹†ç®±</td><td>âŒï¼ˆæœ¬èº«æ˜¯å¼•ç”¨ï¼‰</td><td>âœ…</td><td>âŒ</td></tr><tr><td>å¼‚æ­¥/é—­åŒ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td></tr><tr><td>å…¸å‹ä»£è¡¨</td><td><code>String</code></td><td><code>DateTime</code></td><td><code>Span&lt;T&gt;</code>, <code>ReadOnlySpan&lt;T&gt;</code></td></tr></tbody></table>
<h3 data-id="heading-17">æ€§èƒ½ä¼˜åŠ¿</h3>






























<table><thead><tr><th>åœºæ™¯</th><th>æ™®é€š <code>struct</code></th><th><code>ref struct</code></th></tr></thead><tbody><tr><td>åˆ†é…/é‡Šæ”¾é€Ÿåº¦</td><td>å¿«</td><td><strong>æœ€å¿«ï¼ˆä»…æ ˆæ“ä½œï¼‰</strong></td></tr><tr><td>GC å‹åŠ›</td><td>å¯èƒ½æœ‰ï¼ˆè£…ç®±ï¼‰</td><td><strong>æ—  GC</strong></td></tr><tr><td>å†…å­˜å±€éƒ¨æ€§</td><td>è¾ƒå¥½</td><td><strong>æœ€ä½³</strong></td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸå¯æ§æ€§</td><td>GC ç®¡ç†</td><td><strong>ä½œç”¨åŸŸç»“æŸå³é‡Šæ”¾</strong></td></tr></tbody></table>
<h3 data-id="heading-18">å®æˆ˜ç¤ºä¾‹ï¼šé«˜æ€§èƒ½å­—ç¬¦ä¸²åˆ‡ç‰‡</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">ParseDigits</span>(<span class="hljs-params">ReadOnlySpan&lt;<span class="hljs-built_in">char</span>&gt; span</span>)</span>
{
    <span class="hljs-built_in">int</span> <span class="hljs-keyword">value</span> = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> c <span class="hljs-keyword">in</span> span)
    {
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">char</span>.IsDigit(c)) <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">value</span> = <span class="hljs-keyword">value</span> * <span class="hljs-number">10</span> + (c - <span class="hljs-string">'0'</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span>;
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Demo</span>()</span>
{
    <span class="hljs-built_in">string</span> input = <span class="hljs-string">"12345abc"</span>;
    <span class="hljs-keyword">var</span> slice = input.AsSpan(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// ç›´æ¥æ“ä½œåŸå­—ç¬¦ä¸²å†…å­˜</span>
    Console.WriteLine(ParseDigits(slice)); <span class="hljs-comment">// è¾“å‡º 12345</span>
}
</code></pre>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>
<p>ä¸ä¼šäº§ç”Ÿ <code>Substring</code> å¸¦æ¥çš„é¢å¤–å †åˆ†é…ã€‚</p>
</li>
<li>
<p>å†…å­˜å®‰å…¨ä¸”æ€§èƒ½æ¥è¿‘æŒ‡é’ˆæ“ä½œã€‚</p>
</li>
</ul>
<h3 data-id="heading-19">æ€»ç»“</h3>

























<table><thead><tr><th>æ–¹é¢</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ ¸å¿ƒç‰¹æ€§</td><td>åªèƒ½åˆ†é…åœ¨æ ˆä¸Šï¼Œç”Ÿå‘½å‘¨æœŸç”±ä½œç”¨åŸŸä¸¥æ ¼æ§åˆ¶ï¼Œæ—  GC å‹åŠ›</td></tr><tr><td>ä¸»è¦é™åˆ¶</td><td>ä¸èƒ½è£…ç®±ã€ä¸èƒ½ä½œä¸ºç±»å­—æ®µã€ä¸èƒ½æ•è·é—­åŒ…ã€ä¸èƒ½å¼‚æ­¥/è¿­ä»£ã€ä¸èƒ½å®ç°æ¥å£</td></tr><tr><td>å…¸å‹åº”ç”¨</td><td><code>Span&lt;T&gt;</code>ã€<code>ReadOnlySpan&lt;T&gt;</code>ã€é«˜æ€§èƒ½å†…å­˜å¤„ç†ã€ç½‘ç»œæ•°æ®è§£æ</td></tr><tr><td>æœ€ä½³å®è·µ</td><td>ä½¿ç”¨ <code>using</code> èŒƒå›´ã€<code>readonly</code> ä¿®é¥°ã€é¿å…é€ƒé€¸ã€çŸ­ç”Ÿå‘½å‘¨æœŸ</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜¿é‡ŒWan 2.6å®æµ‹ï¼šè¿™å›ä¸ä»…ä»…æ˜¯Soraå¹³æ›¿ï¼Œè€Œæ˜¯AIå¯¼æ¼”çš„å®Œå…¨è¿›åŒ–]]></title>    <link>https://juejin.cn/post/7584298069610233856</link>    <guid>https://juejin.cn/post/7584298069610233856</guid>    <pubDate>2025-12-16T15:51:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584298069610233856" data-draft-id="7584243498528636928" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜¿é‡ŒWan 2.6å®æµ‹ï¼šè¿™å›ä¸ä»…ä»…æ˜¯Soraå¹³æ›¿ï¼Œè€Œæ˜¯AIå¯¼æ¼”çš„å®Œå…¨è¿›åŒ–"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-16T15:51:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜¿é‡ŒWan 2.6å®æµ‹ï¼šè¿™å›ä¸ä»…ä»…æ˜¯Soraå¹³æ›¿ï¼Œè€Œæ˜¯AIå¯¼æ¼”çš„å®Œå…¨è¿›åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T15:51:23.000Z" title="Tue Dec 16 2025 15:51:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´å®è¯ï¼Œåœ¨OpenAIçš„Soraè¿Ÿè¿Ÿä¸è‚¯å…¬æµ‹çš„è¿™æ®µæ—¥å­é‡Œï¼Œå›½å†…çš„AIè§†é¢‘åœˆå­å…¶å®åè€Œæ›´å·äº†ã€‚ä½†æˆ‘æ²¡æƒ³åˆ°çš„æ˜¯ï¼Œåœ¨è¿™ä¸ªå¹´åº•ï¼Œé˜¿é‡Œä¼šçªç„¶æ‰”å‡ºä¸€å¼ ç‹ç‚¸â€”â€”é€šä¹‰ä¸‡ç›¸ï¼ˆWanï¼‰2.6ã€‚</p>
<p>å¤§å®¶éƒ½åœ¨ä¼ è¿™æ˜¯â€œä¸­å›½ç‰ˆSora 2â€ï¼Œç”šè‡³LiblibAIç­‰å¹³å°åˆšä¸€é¦–å‘ä¸Šçº¿å°±è¢«æŒ¤çˆ†äº†ã€‚æˆ‘èŠ±äº†ä¸€ä¸‹åˆæ—¶é—´æŠŠç©äº†è¿™ä¸ªæ¨¡å‹ï¼Œæƒ³æ’‡å¼€é‚£äº›èŠ±å“¨çš„è¥é”€è¯ï¼Œå•çº¯ä»ä¸€ä¸ªåˆ›ä½œè€…çš„è§’åº¦ï¼Œè·Ÿä½ ä»¬èŠèŠå®ƒåˆ°åº•å¼ºåœ¨å“ªï¼Œä»¥åŠä¸ºä»€ä¹ˆæˆ‘è§‰å¾—å®ƒå¯èƒ½çœŸçš„æ”¹å˜äº†ç©å„¿æ³•ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fdasdasf.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/dasdasf.webp" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c5191afa0ca437099a051fa42ae0be1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766505083&amp;x-signature=A5KxjRgXlMzxm3osgM3QMH6ImAw%3D" alt="dasdasf" loading="lazy"/></a></p>
<p><strong>ä¸ä»…æ˜¯â€œç”Ÿæˆâ€ï¼Œè€Œæ˜¯â€œä¸»æ¼”â€</strong></p>
<p>ç©è¿‡AIè§†é¢‘çš„æœ‹å‹éƒ½çŸ¥é“ä¸€ä¸ªç—›ç‚¹ï¼šæŠ½å¡å®¹æ˜“ï¼Œæ§å¡éš¾ã€‚ä»¥å‰æˆ‘ä»¬ç”Ÿæˆçš„è§†é¢‘ï¼Œäººç‰©é•¿ç›¸éšæœºå˜ï¼Œè¿™ä¸€ç§’æ˜¯å´å½¦ç¥–ï¼Œä¸‹ä¸€ç§’å¯èƒ½å°±å˜æˆäº†è‹å¤§å¼ºã€‚</p>
<p>Wan 2.6æœ€è®©æˆ‘æƒŠå–œçš„ï¼Œæ˜¯å®ƒçš„**è§’è‰²æ‰®æ¼”ï¼ˆRoleplayï¼‰**åŠŸèƒ½ã€‚è¿™ä¸ä»…ä»…æ˜¯ç®€å•çš„æ¢è„¸ã€‚</p>
<p>ä½ å¯ä»¥ç›´æ¥ä¸¢ç»™å®ƒä¸€æ®µä½ è‡ªå·±æˆ–è€…å® ç‰©çš„è§†é¢‘ï¼ˆ5ç§’ä»¥å†…ï¼‰ï¼Œå®ƒå°±èƒ½æŠŠè¿™ä¸ªå½¢è±¡â€œæŠ â€ä¸‹æ¥ï¼Œè®°ä½äº†é•¿ç›¸ã€ç¥æ€ç”šè‡³æ˜¯å£°éŸ³ã€‚ç„¶åï¼Œä½ é€šè¿‡æ–‡å­—æè¿°ï¼Œå°±èƒ½è®©è¿™ä¸ªè§’è‰²å»æ¼”ç§‘å¹»ç‰‡ã€å¤è£…å‰§ï¼Œæˆ–è€…åœ¨èµ›åšæœ‹å…‹çš„è¡—é“ä¸Šåƒé¢ã€‚æœ€å…³é”®çš„æ˜¯ï¼Œå®ƒèƒ½ä¿æŒäººç‰©çš„é«˜åº¦ä¸€è‡´æ€§ã€‚è¿™å¯¹äºæƒ³åšè¿ç»­å‰§æƒ…çŸ­ç‰‡çš„åˆ›ä½œè€…æ¥è¯´ï¼Œç®€ç›´æ˜¯æ•‘å‘½ç¨»è‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-16_23.26.51-1024x580.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-16_23.26.51-1024x580.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eff1bea373d24190ac010df7ebb1ccfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766505083&amp;x-signature=y38poSP2Wj%2Blu9fINiI%2BX1vMRRo%3D" alt="iShot_2025-12-16_23.26.51" loading="lazy"/></a></p>
<p><strong>AIç»ˆäºæ‡‚ä»€ä¹ˆæ˜¯â€œå‰ªè¾‘â€äº†</strong></p>
<p>ä»¥å‰çš„AIè§†é¢‘æ¨¡å‹ï¼Œå¤§å¤šåªèƒ½ç”Ÿæˆé‚£ç§â€œä¸€é•œåˆ°åº•â€çš„ç”»é¢ï¼Œçœ‹å¤šäº†å®¹æ˜“è…»ã€‚</p>
<p>Wan 2.6è¿™æ¬¡æäº†ä¸€ä¸ª<strong>æ™ºèƒ½åˆ†é•œ</strong>çš„èƒ½åŠ›ã€‚ç®€å•è¯´ï¼Œå®ƒç°åœ¨çš„è„‘å­æ›´åƒä¸€ä¸ªå¯¼æ¼”ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç”»å¸ˆã€‚ä½ è¾“å…¥ä¸€æ®µå¤æ‚çš„å‰§æƒ…æè¿°ï¼Œå®ƒä¸ä¼šå‚»å‚»åœ°æŒ¤åœ¨ä¸€ä¸ªç”»é¢é‡Œè¡¨ç°ï¼Œè€Œæ˜¯è‡ªåŠ¨ç»™ä½ åˆ‡åˆ†é•œå¤´â€”â€”å…ˆæ¥ä¸ªå¤§è¿œæ™¯äº¤ä»£ç¯å¢ƒï¼Œç´§æ¥ç€åˆ‡ç‰¹å†™å±•ç¤ºè¡¨æƒ…ï¼Œæœ€åæ‹‰ä¸­æ™¯å±•ç¤ºåŠ¨ä½œã€‚</p>
<p>å®ƒç”Ÿæˆçš„15ç§’è§†é¢‘é‡Œï¼Œå¯èƒ½åŒ…å«ç€æ¨æ‹‰æ‘‡ç§»å’Œæ™¯åˆ«åˆ‡æ¢ï¼Œè€Œä¸”è¿™äº›é•œå¤´ä¹‹é—´çš„é€»è¾‘æ˜¯è¿è´¯çš„ã€‚è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ„å‘³ç€ä½ ä¸éœ€è¦å†å»PRé‡Œè‹¦å“ˆå“ˆåœ°æŠŠä¸€å †åºŸç‰‡æ‹¼å‡‘èµ·æ¥ï¼Œå®ƒä¸€æ¬¡ç”Ÿæˆå°±æ˜¯ä¸€ä¸ªæœ‰å™äº‹æ„Ÿçš„å°çŸ­ç‰‡ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-16_23.26.46-1024x476.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-16_23.26.46-1024x476.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/341ce42f9f424ad48eeb83ad208a1588~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766505083&amp;x-signature=GAWzLF9P%2BhcbLr1dnWXjjJYEQro%3D" alt="iShot_2025-12-16_23.26.46" loading="lazy"/></a></p>
<p><strong>å…³äºé‚£ä¸ªâ€œSora 2â€çš„æ ‡ç­¾</strong></p>
<p>åª’ä½“å¾ˆå–œæ¬¢ç”¨â€œä¸­å›½ç‰ˆSora 2â€è¿™ä¸ªè¯ï¼Œè™½ç„¶å®˜æ–¹æ²¡è¿™ä¹ˆå«ï¼Œä½†ä»æŠ€æœ¯è·¯çº¿ä¸Šçœ‹ï¼Œè¿™ä¸ªæ¯”å–»æœ‰ä¸€å®šé“ç†ã€‚</p>
<p>ç‰¹åˆ«æ˜¯<strong>å£°ç”»åŒæ­¥</strong>è¿™ä¸€ç‚¹ã€‚Wan 2.6ä¸æ˜¯å…‰ç”Ÿæˆå“‘å‰§ï¼Œå®ƒåœ¨ç”Ÿæˆç”»é¢çš„åŒæ—¶ï¼Œèƒ½é¡ºä¾¿æŠŠé…éŸ³ã€éŸ³æ•ˆã€èƒŒæ™¯éŸ³ä¹å…¨æå®šã€‚å°¤å…¶æ˜¯äººç‰©è¯´è¯çš„å£å‹å¯¹é½ï¼Œè™½ç„¶è¿˜ä¸èƒ½è¯´å®Œç¾æ— ç¼ºï¼Œä½†åœ¨çŸ­è§†é¢‘çš„ä¿¡æ¯æµé‡Œï¼Œå·²ç»è¶³å¤Ÿä»¥å‡ä¹±çœŸã€‚</p>
<p>å®ƒèƒ½åšåˆ°å•æ¬¡ç›´å‡º15ç§’çš„1080Pé«˜æ¸…ç”»è´¨ï¼Œè¿™ä¸ªå‚æ•°å¡å¾—å¾ˆç²¾å‡†â€”â€”æ­£å¥½è¦†ç›–äº†ç›®å‰ä¸»æµçŸ­è§†é¢‘å¹³å°å®Œæ’­ç‡æœ€é«˜çš„æ—¶é•¿åŒºé—´ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-16_23.26.40-1024x374.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-16_23.26.40-1024x374.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b037a11c3b941e2a9af7aacd397d0e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766505083&amp;x-signature=JIoobRQVpRDd90j5kYhQ5SwfavA%3D" alt="iShot_2025-12-16_23.26.40" loading="lazy"/></a></p>
<p><strong>ç°åœ¨å°±èƒ½ç©ï¼Œä¸ç”¨æ’é˜Ÿ</strong></p>
<p>è¿™ç‚¹å¿…é¡»å¥½è¯„ã€‚ç›¸æ¯”äºåœ¨å¤§æ´‹å½¼å²¸ç”»å¤§é¥¼ï¼ŒWan 2.6æ˜¯å®æ‰“å®ä¸Šçº¿äº†ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸ªäººç©å®¶ï¼Œæƒ³å°é²œï¼Œç›´æ¥å»<strong>LiblibAI</strong>æˆ–è€…é€šä¹‰ä¸‡ç›¸çš„å®˜ç½‘å°±èƒ½è¯•ã€‚å¯¹äºå’±ä»¬åšå†…å®¹çš„ï¼ŒLiblibAIä¸Šé‚£ç§å·¥ä½œæµçš„ä½“éªŒå¯èƒ½æ›´é¡ºæ‰‹ä¸€äº›ã€‚å¦‚æœä½ æ˜¯æå¼€å‘çš„ï¼Œé˜¿é‡Œäº‘ç™¾ç‚¼çš„APIä¹Ÿå¼€äº†ã€‚</p>
<p><strong>å†™åœ¨æœ€å</strong></p>
<p>Wan 2.6ç»™æˆ‘çš„æ„Ÿè§‰ï¼Œä¸æ˜¯å•çº¯çš„ç”»è´¨æå‡ï¼Œè€Œæ˜¯å®ƒå¼€å§‹è¯•å›¾ç†è§£â€œå½±è§†è¯­è¨€â€äº†ã€‚</p>
<p>ä»å•ä¸€çš„ç”»é¢ç”Ÿæˆï¼Œåˆ°å¤šé•œå¤´çš„å™äº‹è°ƒåº¦ï¼Œå†åˆ°è§’è‰²çš„ä¸€è‡´æ€§æ§åˆ¶ï¼Œè¿™æ ‡å¿—ç€AIè§†é¢‘å·¥å…·æ­£åœ¨ä»â€œç©å…·â€å‘â€œç”Ÿäº§åŠ›å·¥å…·â€è¿ˆè¿›ã€‚è™½ç„¶å®ƒè‚¯å®šè¿˜æœ‰ç©¿æ¨¡ã€é€»è¾‘è·³è·ƒè¿™äº›AIé€šç—…ï¼Œä½†è‡³å°‘ç°åœ¨ï¼Œæˆ‘ä»¬ç¦»â€œä¸€ä¸ªäººå°±æ˜¯ä¸€æ”¯é˜Ÿä¼â€çš„æ¢¦æƒ³ï¼Œåˆè¿‘äº†ç»“ç»“å®å®çš„ä¸€å¤§æ­¥ã€‚</p>
<p>å¦‚æœä½ æ‰‹å¤´æœ‰å¥½çš„åˆ›æ„ï¼Œåˆ«ç­‰äº†ï¼Œå»è¯•è¯•å§ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android15é€‚é…ä¹‹ä¸–ä¸Šæœ¬æ— å‘ï¼ŒtargetSdkVersionå‡åˆ°35åå…¨æ˜¯å‘]]></title>    <link>https://juejin.cn/post/7584295332340858943</link>    <guid>https://juejin.cn/post/7584295332340858943</guid>    <pubDate>2025-12-16T23:59:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584295332340858943" data-draft-id="7580389111920508991" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android15é€‚é…ä¹‹ä¸–ä¸Šæœ¬æ— å‘ï¼ŒtargetSdkVersionå‡åˆ°35åå…¨æ˜¯å‘"/> <meta itemprop="keywords" content="Android,gradle,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-16T23:59:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Coffeeee"/> <meta itemprop="url" content="https://juejin.cn/user/2089524588718126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android15é€‚é…ä¹‹ä¸–ä¸Šæœ¬æ— å‘ï¼ŒtargetSdkVersionå‡åˆ°35åå…¨æ˜¯å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2089524588718126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Coffeeee
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T23:59:27.000Z" title="Tue Dec 16 2025 23:59:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è‡ªä»2024å¹´åˆæ—¶å€™ï¼Œè°·æ­Œå‘å¸ƒäº†ç¬¬ä¸€ä¸ªAndroid15çš„é¢„è§ˆç‰ˆï¼Œæˆ‘å°±ä¸€ç›´åœ¨å…³æ³¨ç€è¿™ä¸ªç‰ˆæœ¬çš„èµ°å‘ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ®è¯´Android15é‡Œé¢çš„å˜åŒ–éå¸¸å¤§ï¼Œåæ¥äº‹å®è¯æ˜æœçœŸå¦‚æ­¤ï¼Œæ— è®ºæ˜¯ç‰¹æ€§ä¸Šçš„æ”¹åŠ¨å¦‚é¢„æµ‹æ€§è¿”å›ï¼Œedge to edgeè¿˜æ˜¯16kbå†…å­˜é¡µé¢ï¼Œæˆ–è€…æ˜¯ç¼–è¯‘ç¯å¢ƒä¸Šçš„æ”¹åŠ¨å¦‚targetSdkVersionï¼ŒAgpï¼Œgradleä»¥åŠjdkçš„ä¸€äº›å‡çº§ï¼Œéƒ½è®©æˆ‘è§‰å¾—è¿™æ¬¡å‡çº§éåŒä¸€èˆ¬ï¼Œæ¥åŠ¿å‡¶çŒ›ï¼Œä¸æ˜¯é‚£ä¹ˆçš„å¥½å¯¹ä»˜ï¼Œä¸è¿‡å¥½åœ¨ä¹‹å‰å·¥ä½œä¸Šéƒ½æ²¡æœ‰æµ·å¤–ä¸Šçš„ä¸šåŠ¡ï¼Œå›½å†…çš„åº”ç”¨å•†åº—å¯¹åº”ç”¨çš„targetSdkä¹Ÿæ²¡æœ‰å¤ªå¼ºåˆ¶çš„è¦æ±‚ï¼Œæ‰€ä»¥Android15è·Ÿæˆ‘éƒ½ä¸€ç›´ä¿æŒç€ä¸€ç§æ•Œä¸åŠ¨æˆ‘ä¸åŠ¨çš„å’Œå¹³å±€åŠ¿ï¼Œä½†æ˜¯å±€åŠ¿ç»ˆå°†æ˜¯è¢«æ‰“ç ´äº†...</p>
<h2 data-id="heading-1">ä¹±ä¸–ä¸­çš„ç›¸é€¢</h2>
<p>å‰æ®µæ—¶é—´ç»å†äº†è£å‘˜ä»¥åŠä¸‰ä¸ªæœˆçš„æ‰¾å·¥ä½œï¼Œè®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº†ä¸¥å³»çš„è¡Œæƒ…å±€åŠ¿ä»¥åŠå¯æ€•çš„å°±ä¸šå‹åŠ›ï¼Œä¿ƒä½¿æˆ‘ä¸å¾—ä¸é™ä½è‡ªå·±çš„åº•çº¿ï¼Œé¢äº†å„ç§æœªæ›¾å°è¯•è¿‡çš„å²—ä½é¢è¯•ï¼Œå¦‚è½¦è½½ï¼ŒFWæˆ–è€…é¢å‘è°·æ­Œå¸‚åœºå¼€å‘ï¼Œæœ‰ä¸€æ¬¡é¢è¯•ä¸­ï¼š</p>
<ul>
<li>é¢è¯•å®˜ï¼šæœ‰å¼€å‘è¿‡è°·æ­Œå¸‚åœºçš„åº”ç”¨å—ï¼Ÿ</li>
<li>æˆ‘ï¼šå¥½å‡ å¹´å‰åšè¿‡ï¼ŒçŸ¥é“ç°åœ¨å‘å¸ƒçš„æ˜¯aabæ ¼å¼çš„åŒ…</li>
<li>é¢è¯•å®˜ï¼šé€‚é…è¿‡Android15å—ï¼Ÿ</li>
<li>æˆ‘ï¼šæ²¡æœ‰ï¼Œå°±åªé€‚é…è¿‡Android12</li>
<li>é¢è¯•å®˜ï¼šå“¦ï½ï½</li>
</ul>
<p>ç„¶åofferå°±æ¥äº†...è™½ç„¶æ˜ç™½è¿™ä¸ªofferä¸æ˜¯é‚£ä¹ˆçš„å¥½æ¥ï¼Œå…¥èŒåä¸»è¦ä»»åŠ¡å°±æ˜¯è·Ÿè°·æ­Œçš„ä¸€ç³»åˆ—æ”¿ç­–æ–—æ³•ï¼Œä½†ç”±äºè¡Œæƒ…å®åœ¨æ˜¯ä¸å®¹ä¹è§‚ï¼Œæ‹›è˜å¸‚åœºä¸Šå·²ç»è¢«ä¸€å †å¤–åŒ…è·ŸçŸ­æœŸé¡¹ç›®æå¾—ä¹ŒçƒŸç˜´æ°”äº†ï¼Œè€ƒè™‘å†ä¸‰è¿˜æ˜¯æ¥ä¸‹äº†è¿™ä¸ªofferï¼Œäºæ˜¯ä¹æˆ‘è·ŸAndroid15ä¹‹é—´æ–—äº‰ä¹Ÿæ‹‰å¼€äº†åºå¹•</p>
<h3 data-id="heading-2">å‡çº§targetSdkVersionä¸compileSdkVersion</h3>
<p>æ¥æ‰‹åˆ°é¡¹ç›®ä¹‹åï¼Œæ— æ„å¤–çš„è¢«åˆ†é…åˆ°çš„ç¬¬ä¸€ä¸ªä»»åŠ¡å°±æ˜¯è°·æ­Œå¸‚åœºåˆè§„è¦æ±‚ï¼Œé€‚é…Android15,ä¸å¾—ä¸æ„Ÿæ…¨ä¸åˆ°ä¸¤å¹´å‰è¿˜åœ¨åº†å¹¸è‡ªå·±ä¸Android15æ— ç¼˜ï¼Œè°çŸ¥é“è¿™ä¹ˆå¿«å°±è¦è·Ÿè¿™ä¸ªâ€œå¤§é­”ç‹â€é¢å¯¹é¢æ¥è§¦ï¼Œå®åœ¨æ˜¯ä¸–äº‹éš¾æ–™ï¼Œåº”äº†é‚£å¥è¯ï¼Œå‡ºæ¥æ··çš„ï¼Œç»ˆç©¶è¦è¿˜çš„ï¼ŒåƒAndroidè¿™ç¢—é¥­ï¼Œå°±è¦åšå¥½é€‚é…å„ç§Androidæ–°ç‰ˆæœ¬çš„å‡†å¤‡ï¼Œä¸è¿‡å¦æˆ‘æ„Ÿåˆ°æ¬£æ…°çš„æ˜¯é¡¹ç›®å¹¶ä¸æ˜¯ç‰¹åˆ«çš„è€ï¼Œè®©æˆ‘äº§ç”Ÿä¸€ç§é”™è§‰ï¼Œåº”è¯¥æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆè´¹åŠ²ï¼Œé¡¹ç›®åŸºæœ¬é…ç½®å¦‚ä¸‹</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/f94af4c7f76046288444fecd98e27ece~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="70%" loading="lazy"/>
<p>æ—¢ç„¶å¦‚æ­¤ï¼ŒåºŸè¯ä¸å¤šè¯´äº†ï¼Œå’±å…ˆæŠŠ<code>targetSdk</code>è·Ÿ<code>compileSdk</code>éƒ½å‡çº§åˆ°35å†è¯´ï¼Œä¸‡ä¸€è·‘ä¸‹æ¥æ²¡å•¥é—®é¢˜å‘¢ï¼Œæˆ‘å°±å˜»å˜»äº†ï¼Œä¿®æ”¹äº†ä¸€ä¸‹<code>gradle.properties</code>ä¸­çš„å‡ ä¸ªå˜é‡</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/0ad1c0bb958f4c29ae727b30e2e6a0f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="70%" loading="lazy"/>
<p>syncä¸€ä¸‹åå‘ç°æ²¡å•¥é—®é¢˜ï¼Œå—¯ï¼Ÿå°±è¿™ï¼Ÿrunä¸€ä¸‹è¯•è¯•ï¼Œå‘ç°æœç„¶æŠ¥é”™äº†,ç¬é—´ä¸å˜»å˜»</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/4f96b764f18e49fdb5d2be8c04df107e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="002.png" width="90%" loading="lazy"/>
<p>æŠ¥äº†ä¸ªæ— æ³•åŠ è½½sdkè·¯å¾„ä¸‹/platforms/android-35/android.jarçš„è¿™ä¸ªæ–‡ä»¶ï¼Œæœ‰ç‚¹æ‘¸ä¸ç€å¤´è„‘ï¼ŒæŸ¥äº†ä¸€ä¸‹é©¬ä¸Šå°±çŸ¥é“äº†ï¼ŒåŸå› å¾ˆç®€å•ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„gradleæ’ä»¶ä»¥åŠAGPæ’ä»¶å·²ç»ä¸æ”¯æŒtargetSdk35äº†ï¼Œå¿…é¡»è¦å‡çº§äº†ï¼Œå‡åˆ°å¤šå°‘å‘¢ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Fbuild%2Freleases%2Fgradle-plugin%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.google.cn/build/releases/gradle-plugin?hl=zh-cn" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ä¸Šçœ‹çœ‹å»</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/3182f631c7974443a65070de4afdbfdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/067bee2a61bb4edeb861104be5616621~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>å†™çš„å¾ˆæ¸…æ¥šäº†ï¼Œå½“å‡çº§åˆ°target35åï¼ŒAGPç‰ˆæœ¬æœ€ä½éœ€è¦8.6,æ­¤ç‰ˆæœ¬å¯¹åº”çš„gradleæœ€ä½ç‰ˆæœ¬æ˜¯8.7ï¼Œé‚£ä¹ˆå¼€å§‹å‡çº§è¿™ä¿©æ’ä»¶</p>
<h3 data-id="heading-3">å‡çº§gradleå’ŒAGP</h3>
<p>é¦–å…ˆå°†é¡¹ç›®ä¸­gradle/wrapper/gradle-wrapper.propertiesä¸­çš„ä»¥ä¸‹ä»£ç </p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/f7254e7b93de482789b7cf36a6fee586~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>æ›¿æ¢æˆ</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/758d2a74b88947c1886ffbc35042b04f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>ç„¶åå†æŠŠæ ¹ç›®å½•build.gradleæ–‡ä»¶é‡Œé¢çš„AGPæ’ä»¶ä»</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/b878ff10c1e941969088daf16a6c8775~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>æ›¿æ¢æˆ</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/b11a66ae625946ea88326ed5f8bf1171~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>ä¸€é¡¿æ“ä½œä¹‹åå¿ƒé‡Œå°±çŠ¯æ€µï¼Œè¿™ä¿©æ’ä»¶ä¸€ä¸‹å­éƒ½æŠ¬é«˜äº†ä¸€ä¸ªå¤§ç‰ˆæœ¬ï¼ŒçœŸçš„æ²¡é—®é¢˜å—ï¼Ÿç¼–è¯‘ä¸‹çœ‹çœ‹å§ï¼Œæœç„¶æ€•å•¥æ¥å•¥ï¼Œå‡ºç°ä»¥ä¸‹æŠ¥çº¢</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/85ea4c0bc17f48cb8984228c59f54c84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>ä¸è¿‡è¿˜å¥½è¿˜ç®—å®¹æ˜“æ‡‚ï¼Œç°åœ¨ç”¨çš„jdkç‰ˆæœ¬11è¿‡ä½äº†ï¼Œéœ€è¦ç”¨æ›´é«˜çš„jdkç‰ˆæœ¬17æ‰å¯ä»¥ã€‚</p>
<h3 data-id="heading-4">å‡çº§JDK</h3>
<p>æ²¡æƒ³åˆ°åˆšå¼€å§‹è¿˜æ²¡å¹²å•¥å‘¢ï¼Œéšç€å‡å®Œgradleä¸AGPä¹‹åï¼Œjdkç‰ˆæœ¬ä¹Ÿè¦å‡çº§äº†ï¼Œä¸€ä¸‹å­å°±æ„Ÿåˆ°ç–‘æƒ‘äº†èµ·æ¥ï¼Œè¦çŸ¥é“jdk11è¿™ä¸ªç‰ˆæœ¬å¤§å¤šæ•°é¡¹ç›®è¿˜æ˜¯åœ¨ç”¨çš„ï¼Œä¸è¿‡äººå®¶<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Fbuild%2Freleases%2Fpast-releases%2Fagp-8-0-0-release-notes%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.google.cn/build/releases/past-releases/agp-8-0-0-release-notes?hl=zh-cn" ref="nofollow noopener noreferrer">gradleæ’ä»¶çš„changelog</a>é‡Œé¢å¯æ˜¯å†™çš„æ¸…æ¸…æ¥šæ¥šï¼Œå‡çº§åˆ°8.0åï¼Œjdkçš„æœ€å°ç‰ˆæœ¬å°±è¦æ±‚å¿…é¡»æ˜¯17äº†</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/576e8a9b9647440dba11a43a5841ede7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="70%" loading="lazy"/>
<p>é‚£å°±å‡å§ï¼Œå‡è¿™ä¸ªä¸œè¥¿æ²¡å•¥éš¾çš„ï¼Œå·¦ä¸Šè§’Android Studio-&gt;Settings-&gt;Build Tools-&gt;Gradleé‡Œé¢é€‰æ‹©JDK17,æ²¡æœ‰çš„è¯å°±å»ä¸‹ä¸€ä¸ª</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/693a06a1820e476a87114cc04d47ee6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>Applyå¹¶ä¸”okåæˆ‘ä»¬å†ç¼–è¯‘çœ‹çœ‹</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/41b1449f19df4cf2b3dc79f0b7d0241c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<h3 data-id="heading-5">æ·»åŠ buildConfig=trueé…ç½®</h3>
<p>è¿™çœŸæ˜¯å¤´ä¸€æ¬¡è§å•Šï¼Œè¯´çš„å•¥debugçš„build typeæœ‰ä¸€äº›è‡ªå®šä¹‰çš„BuildConfigçš„å˜é‡ï¼Œä½†æ˜¯è¢«ç¦ç”¨äº†ï¼Œè¯´çš„åº”è¯¥æ˜¯ä¸‹é¢è¿™æ®µä»£ç </p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/1807fb2085b844e3901358f83c440e8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>è¿™æ®µä»£ç å¾ˆå¸¸è§ï¼Œå¤§å¤šæ•°é¡¹ç›®ä¸­éƒ½ä¼šåœ¨<code>buildTypes</code>é‡Œé¢å®šä¹‰ä¸€äº›<code>buildConfigField</code>å˜é‡ï¼Œç”¨æ¥åŒºåˆ†ç”Ÿäº§ç¯å¢ƒè·Ÿdebugç¯å¢ƒï¼Œæˆ‘è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„<code>Coffee_Test</code>å€¼ä¸º<code>true</code>çš„å˜é‡ï¼Œç°åœ¨è¯´çš„æ˜¯è¿™ä¸ªå·²ç»è¢«ç¦ç”¨äº†ï¼Œè‚¯å®šåˆæ˜¯å‡çº§gradleå¸¦æ¥çš„å‰¯ä½œç”¨ï¼Œæœç„¶åœ¨AGP8.0çš„æ›´æ–°ä¸­å°±æœ‰çœ‹åˆ°</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/b5652e16d01e41159c768c3749f5eff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>åŒæ—¶è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨æ¯ä¸ªå®šä¹‰è¿‡è‡ªå®šä¹‰å˜é‡çš„æ¨¡å—çš„build.gradleæ–‡ä»¶ä¸‹æ·»åŠ ä¸€å¥ä»£ç <code>android.buildFeatures.buildConfig true</code>å°±å¯ä»¥äº†,åƒè¿™æ ·</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/e8828db1c857421e81290b4a937cb626~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>è¿™ä¸ªé—®é¢˜ä¹Ÿå°±è§£å†³äº†</p>
<h3 data-id="heading-6">æ·»åŠ namespace</h3>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/df43fb03c36745b0927e358dd512573f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>éšç€å†æ¬¡ç¼–è¯‘ï¼Œåˆå‡ºç°ä¸Šè¿°æŠ¥é”™ï¼Œè·Ÿä¹‹å‰çš„BuildConfigç±»ä¼¼ï¼Œè¿™æ¬¡æ˜¯è¦æ±‚åœ¨æ¯ä¸ªæ¨¡å—çš„buildæ–‡ä»¶ä¸­éœ€è¦æ·»åŠ ä¸ª<code>namespace</code>çš„å‘½åç©ºé—´ï¼Œè¿™ä¸ªå˜æ›´æ˜¯åœ¨AGP7.3ä¸­å‡ºç°ï¼Œä½†æ˜¯AGP8.0å°±è¦è¢«å¼ºåˆ¶æ‰§è¡Œ</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/5dd12084bc0849f48c0a7491b256435e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>é€šå¸¸è¿™ä¸ªå‘½åç©ºé—´å°±æ˜¯æŒ‡çš„æ˜¯å½“å‰æ¨¡å—çš„åŒ…åï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°æŠ¥é”™çº¢å­—ä¸‹æ–¹ä¹Ÿæç¤ºäº†ï¼Œå¯ä»¥å€ŸåŠ©AGPçš„å‡çº§åŠ©æ‰‹æ¥å®Œæˆè¿™ä¸€æ­¥ï¼Œå®Œæˆååœ¨ä½ çš„build.gradleæ–‡ä»¶ä¸­å°±ä¼šå¤šå‡ºä¸€è¡Œé…ç½®</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/18e38faa91a74b3489f16df18b50a526~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<h3 data-id="heading-7">ä½¿ç”¨subprojectsç»Ÿä¸€æ·»åŠ é…ç½®</h3>
<p>ä¸Šé¢è¯´çš„æ·»åŠ <code>android.buildFeatures.buildConfig true</code>ä»¥åŠå‘½åç©ºé—´çš„åšæ³•ï¼Œåœ¨ä¸€äº›å°å‹ï¼Œæ¨¡å—æ²¡å‡ ä¸ªçš„é¡¹ç›®ä¸­ï¼Œé…ç½®èµ·æ¥ä¸æ˜¯ç‰¹åˆ«éš¾å—ï¼Œä½†æ˜¯è‹¥æ˜¯é¡¹ç›®è§„æ¨¡å¤§ä¸€äº›ï¼ŒåŠ¨è¾„åå‡ ä¸ªå‡ åä¸ªæ¨¡å—çš„è¯ï¼Œé€ä¸ªåŠ é‚£å°±çœŸçš„æ˜¯ä»¶å¾ˆç—›è‹¦çš„äº‹æƒ…ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰è½»æ¾ä¸€ç‚¹çš„åŠæ³•å‘¢ï¼Ÿç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯æ–°å¢ä¸€ä¸ªcommon.gradleçš„æ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ ä¸€äº›è¯¸å¦‚<code>android.buildFeatures.buildConfig true</code>è¿™æ ·çš„é…ç½®ï¼Œç„¶åå…¶ä»–æ¨¡å—å¼•å…¥è¿™ä¸ªcommon.gradleæ–‡ä»¶ï¼Œå€’æ˜¯å¯ä»¥è¾¾åˆ°æ•ˆæœï¼Œä½†æ˜¯å­˜åœ¨ç€ä¸€äº›ç¼ºç‚¹</p>
<ol>
<li>é€ä¸ªgradleæ–‡ä»¶æ·»åŠ common.gradleçš„ä¾èµ–ä¹Ÿéœ€è¦è€—è´¹ä¸€äº›æ—¶é—´ç²¾åŠ›</li>
<li>å¦‚æœé¡¹ç›®è¿˜éœ€è¦æºç ä¾èµ–ä¸€äº›å…¶ä»–é¡¹ç›®çš„æ¨¡å—ï¼Œé‚£ä¹ˆå…¶ä»–é¡¹ç›®çš„æ¨¡å—ç”±äºæ²¡æœ‰æ·»åŠ ç±»ä¼¼é…ç½®ï¼Œä¹Ÿæ˜¯ä¼šæŠ¥é”™</li>
</ol>
<p>æ‰€ä»¥æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯åœ¨é¡¹ç›®çš„æ ¹ç›®å½•çš„gradleæ–‡ä»¶ä¸­ä½¿ç”¨<code>subprojects</code>ï¼ŒåŠ¨æ€ç»™æ¯ä¸ªå‚ä¸åˆ°ç¼–è¯‘çš„æ¨¡å—æ·»åŠ <code>android.buildFeatures.buildConfig true</code>ä»¥åŠå‘½åç©ºé—´ï¼Œä»£ç å¦‚ä¸‹</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/64d1fb58299540a68b71694c4678ae8d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>å¦‚æœè¿™ä¸ªæ¨¡å—æ²¡æœ‰å®šä¹‰è¿‡å‘½åç©ºé—´ï¼Œæ¯”å¦‚ä¾èµ–çš„ä¸€äº›æºç åº“ï¼Œé‚£ä¹ˆæ‰ä¼šç»™è¿™ä¸ªæ¨¡å—æ·»åŠ å‘½åç©ºé—´ï¼Œè‡³äº<code>buildConfig</code>ï¼Œç”±äºæˆ‘ä¸çŸ¥é“å¦‚ä½•åˆ¤æ–­gradleæ–‡ä»¶ä¸­å·²ç»å£°æ˜è¿‡è‡ªå®šä¹‰å˜é‡äº†ï¼Œæ‰€ä»¥åªèƒ½å…¨é‡æ·»åŠ ï¼Œè¿™æ ·å°±èƒ½é¿å…æŸäº›æ¨¡å—å› æ¼åŠ è¿™ä¸¤ä¸ªé…ç½®è€Œäº§ç”Ÿç¼–è¯‘æŠ¥é”™</p>
<h3 data-id="heading-8">Ræ–‡ä»¶ä¸¢å¤±</h3>
<p>è¨€å½’æ­£ä¼ ï¼Œåˆšæ‰å·²ç»æ·»åŠ å®Œ<code>namespace</code>äº†ï¼Œæˆ‘å¿ƒé‡Œç¢ç£¨ç€è¿™ä¸‹åº”è¯¥å·®ä¸å¤šäº†å§ï¼Œå¯ä»¥æ­£å¸¸è·‘äº†å§ï¼Œè°çŸ¥é“Android15ç»™æˆ‘æ†‹äº†å¨å¤§çš„ï¼ŒæŠ¥å‡ºä»¥ä¸‹çº¢å­—</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/6292fc0c3a0d47bbb8e5442edde62f68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>è«åå…¶å¦™å•Šï¼Œæ€ä¹ˆæœ‰äº›stringèµ„æºè¯´æ‰¾ä¸åˆ°å°±æ‰¾ä¸åˆ°äº†å‘¢ï¼Ÿå¼€å§‹æ²¡å¤ªåœ¨æ„ï¼Œç¢ç£¨ç€è¡¥å…¨Rè·¯å¾„å°±å¥½äº†,ç±»ä¼¼äºè¿™æ ·</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/9659bc462e3344c78822942dbc35121c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="80%" loading="lazy"/>
<p>è¿™ç§åˆå¥‡è‘©åˆä¸‘çš„æ–¹å¼ä¸ç”¨æƒ³è‚¯å®šä¹ŸçŸ¥é“æ²¡æ³•è§£å†³æœ¬è´¨é—®é¢˜ï¼Œæœç„¶å†æ¬¡ç¼–è¯‘ååˆæŠ¥å‡ºæ¥ä¸€å †æ‰¾ä¸åˆ°èµ„æºçš„Ræ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬layout,color,drawableç­‰ï¼Œè¿™ä¸‹å½»åº•å‡Œä¹±äº†ï¼Œè‚¯å®šä¸èƒ½ä¸€ä¸ªä¸ªè·¯å¾„å»è¡¥å…¨ï¼Œå¿ƒæƒ³è¿™ä¹ˆå¤§çš„äº‹å®˜ç½‘ä¸Šè‚¯å®šä¼šæœ‰è¯´æ˜å§ï¼Œæ‰¾æ‰¾çœ‹æœç„¶åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Fbuild%2Freleases%2Fpast-releases%2Fagp-8-0-0-release-notes%3Fhl%3Dzh-CN%23kotlin-assignment" target="_blank" title="https://developer.android.google.cn/build/releases/past-releases/agp-8-0-0-release-notes?hl=zh-CN#kotlin-assignment" ref="nofollow noopener noreferrer">gradle8.0çš„æ›´æ–°æ—¥å¿—é‡Œ</a>ä»¥åŠ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Fbuild%2Fconfigure-app-module%3Fhl%3Dzh-cn%23set-namespace" target="_blank" title="https://developer.android.google.cn/build/configure-app-module?hl=zh-cn#set-namespace" ref="nofollow noopener noreferrer">è®¾ç½®å‘½åç©ºé—´çš„ä»‹ç»é‡Œ</a>æ‰¾åˆ°äº†å…·ä½“æ›´æ–°ä¿¡æ¯ï¼Œè°·æ­Œå¼•å…¥<code>namespace</code>çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†ä»¥ååœ¨æ¯ä¸ªæ¨¡å—é‡Œé¢ï¼Œåªä¼šç”Ÿæˆå½“å‰æ¨¡å—ä¸‹çš„èµ„æºæ–‡ä»¶ï¼Œå…¶ä»–å­æ¨¡å—çš„èµ„æºæ–‡ä»¶å°±ä¸ä¼šç”Ÿæˆäº†ï¼Œè‹¥è¦è®¿é—®çš„è¯å¿…é¡»ä½¿ç”¨å¯¹åº”å‘½åç©ºé—´å¯¼å…¥Rç±»ï¼Œæˆ‘è®¤ä¸ºè°·æ­Œè¿™ä¸€æ”¹åŠ¨å°±æ˜¯ä¸ºäº†åŠ é€Ÿæ„å»ºé€Ÿåº¦å§ï¼Œä½†æ˜¯çœŸçš„è¦æˆ‘ä»¬å¼€å‘è€…ä¸€ä¸ªä¸ªèµ„æºå‰é¢è¡¥å…¨è·¯å¾„å—ï¼Œå½“ç„¶ä¸ä¼šï¼Œè°·æ­Œè¿˜æ˜¯ç»™å‡ºäº†å¯¹ç­–çš„</p>
<img src="https://p-xtjj.byted.org/tos-cn-i-73owjymdk6/393d8fee14224f169750752a70f78cc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6:q75.image" alt="image.png" width="90%" loading="lazy"/>
<p>åœ¨æ ‡å¿—é¡¹çš„è¡¨æ ¼ä¸­å°±çœ‹åˆ°äº†ä¸¤ä¸ªè·ŸRæ–‡ä»¶ç›¸å…³çš„è®¾ç½®</p>
<ul>
<li>android.nonFinalResIdsï¼šå…³é—­è¿™ä¸ªå¼€å…³AGP 8.0 é»˜è®¤æƒ…å†µä¸‹å°±ä¸ä¼šç”ŸæˆåŒ…å«éæœ€ç»ˆå­—æ®µçš„Â <code>R</code>Â ç±»</li>
<li>android.nonTransitiveRClassï¼šå…³é—­è¿™ä¸ªå¼€å…³AGP 8.0 å°±ä¸ä¼šä»…ä¸ºå½“å‰æ¨¡å—ä¸­å®šä¹‰çš„èµ„æºç”ŸæˆÂ <code>R</code>Â ç±»</li>
</ul>
<p>å°†è¿™ä¿©è®¾ç½®åŠ åœ¨<code>gradle.properties</code>ä¸­åï¼Œé¡¹ç›®æœç„¶å¯ä»¥æ­£å¸¸è¿è¡Œäº†ï¼Œä¸å®¹æ˜“ï¼ç»ˆäºå¯ä»¥ææµ‹äº†ï¼</p>
<h2 data-id="heading-9">æœ€å</h2>
<p>è¿˜æ˜¯ä»¥å‰æé€‚é…æ²¡å•¥å‹åŠ›å•Šï¼Œæ¯ä¸ªç‰ˆæœ¬å‡ºæ¥å°±ä¸€ç‚¹å˜åŠ¨ï¼Œç°åœ¨è¿™ä¸ªAndroid15ç€å®æœ‰ç‚¹è´¹ä½“åŠ›ï¼Œå…‰ä¸€ä¸ªç¼–è¯‘ç¯å¢ƒéƒ½æŠ˜è…¾äº†é‚£ä¹ˆä¹…ï¼Œç…ç…è¿™äº›å‘ï¼Œæˆ‘å†™éƒ½å†™åŠå¤©ï¼Œæ›´åˆ«è¯´ä¸€ä¸ªä¸ªè¸©äº†ï¼Œé‚£äº›æ–°å‡ºæ¥çš„ç‰¹æ€§éƒ½è¿˜æ²¡å¼€å§‹æ­£ç»é€‚é…ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« æ­£å¼é¢†æ•™ä¸‹edge-to-edgeä»¥åŠ16kbå†…å­˜é¡µé¢</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹çš„å¥¥ç§˜ï¼šTokenä¸Transformerç®€å•ç†è§£]]></title>    <link>https://juejin.cn/post/7584298069610315776</link>    <guid>https://juejin.cn/post/7584298069610315776</guid>    <pubDate>2025-12-16T17:09:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584298069610315776" data-draft-id="7584319403858673699" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹çš„å¥¥ç§˜ï¼šTokenä¸Transformerç®€å•ç†è§£"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM"/> <meta itemprop="datePublished" content="2025-12-16T17:09:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shawn_Shawn"/> <meta itemprop="url" content="https://juejin.cn/user/1855631358965384"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹çš„å¥¥ç§˜ï¼šTokenä¸Transformerç®€å•ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631358965384/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shawn_Shawn
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T17:09:52.000Z" title="Tue Dec 16 2025 17:09:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¤§æ¨¡å‹æ˜¯ä»€ä¹ˆ</h2>
<p>å¤§æ¨¡å‹ï¼ˆLarge Modelï¼‰æ˜¯æŒ‡å…·æœ‰å¤§è§„æ¨¡å‚æ•°å’Œå¤æ‚è®¡ç®—ç»“æ„çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚è¿™äº›æ¨¡å‹é€šå¸¸ç”±<strong>æ·±åº¦ç¥ç»ç½‘ç»œ</strong>æ„å»ºè€Œæˆï¼Œæ‹¥æœ‰æ•°åäº¿ç”šè‡³æ•°åƒäº¿ä¸ªå‚æ•°ã€‚å¤§æ¨¡å‹çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†æé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å’Œé¢„æµ‹æ€§èƒ½ï¼Œèƒ½å¤Ÿå¤„ç†æ›´åŠ å¤æ‚çš„ä»»åŠ¡å’Œæ•°æ®ã€‚å¤§æ¨¡å‹åœ¨å„ç§é¢†åŸŸéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬<strong>è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ã€è¯­éŸ³è¯†åˆ«å’Œæ¨èç³»ç»Ÿ</strong>ç­‰ã€‚å¤§æ¨¡å‹é€šè¿‡è®­ç»ƒæµ·é‡æ•°æ®æ¥å­¦ä¹ å¤æ‚çš„æ¨¡å¼å’Œç‰¹å¾ï¼Œå…·æœ‰æ›´å¼ºå¤§çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¯ä»¥å¯¹æœªè§è¿‡çš„æ•°æ®åšå‡ºå‡†ç¡®çš„é¢„æµ‹ã€‚</p>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆlarge language modelï¼ŒLLMï¼‰ï¼Œä¹Ÿç§°å¤§è¯­è¨€æ¨¡å‹ï¼Œæ˜¯ç”±å…·æœ‰å¤§é‡å‚æ•°ï¼ˆé€šå¸¸æ•°åäº¿ä¸ªæƒé‡æˆ–æ›´å¤šï¼‰çš„äººå·¥ç¥ç»ç½‘ç»œç»„æˆçš„ä¸€ç±»è¯­è¨€æ¨¡å‹ï¼Œä½¿ç”¨è‡ªç›‘ç£å­¦ä¹ æˆ–åŠç›‘ç£å­¦ä¹ å¯¹å¤§é‡æœªæ ‡è®°æ–‡æœ¬è¿›è¡Œè®­ç»ƒã€‚å¤§å‹è¯­è¨€æ¨¡å‹åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ã€æ–‡æœ¬ç”Ÿæˆå’Œæ™ºèƒ½å¯¹è¯ç­‰é¢†åŸŸæœ‰å¹¿æ³›åº”ç”¨ã€‚</p>
<p>GPTï¼ˆGenerative Pre-trained Transformerï¼‰ï¼šGPT å’Œ ChatGPT éƒ½æ˜¯åŸºäº Transformer æ¶æ„çš„è¯­è¨€æ¨¡å‹ï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡å’Œåº”ç”¨ä¸Šå­˜åœ¨åŒºåˆ«ï¼šGPT æ¨¡å‹æ—¨åœ¨ç”Ÿæˆè‡ªç„¶è¯­è¨€æ–‡æœ¬å¹¶å¤„ç†å„ç§è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼Œå¦‚æ–‡æœ¬ç”Ÿæˆã€ç¿»è¯‘ã€æ‘˜è¦ç­‰ã€‚å®ƒé€šå¸¸åœ¨å•å‘ç”Ÿæˆçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå³æ ¹æ®ç»™å®šçš„æ–‡æœ¬ç”Ÿæˆè¿è´¯çš„è¾“å‡ºã€‚</p>
<p>ChatGPTï¼šChatGPT åˆ™ä¸“æ³¨äºå¯¹è¯å’Œäº¤äº’å¼å¯¹è¯ã€‚å®ƒç»è¿‡ç‰¹å®šçš„è®­ç»ƒï¼Œä»¥æ›´å¥½åœ°å¤„ç†å¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡ç†è§£ã€‚ChatGPT è®¾è®¡ç”¨äºæä¾›æµç•…ã€è¿è´¯å’Œæœ‰è¶£çš„å¯¹è¯ä½“éªŒï¼Œä»¥å“åº”ç”¨æˆ·çš„è¾“å…¥å¹¶ç”Ÿæˆåˆé€‚çš„å›å¤ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬æ—¥å¸¸è¯´çš„å¤§æ¨¡å‹ï¼Œæ›´å¤šè¿˜æ˜¯å€¼å¾—æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼ŒChatgpt, DeepSeekï¼ŒQwenç­‰ä¸€å¼€å§‹ä¹Ÿéƒ½æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Œéšç€å¤§æ¨¡å‹æŠ€æœ¯ä¸æ–­çš„æ›´æ–°ï¼Œæˆç†Ÿï¼Œè¶Šæ¥è¶Šå¤šçš„æ¨¡å‹ä¾›åº”å•†ï¼Œå¼€å§‹æ”¯æŒCVï¼ŒOCRï¼ŒASRï¼ŒSERç­‰æ¨¡å‹ï¼Œå½¢æˆå¤šæ¨¡æ€å¤§æ¨¡å‹ã€‚</p>
<p>æœ¬æ–‡è¿˜æ˜¯ä¸»è¦è®²è¿°çš„æ˜¯å¤§è¯­è¨€æ¨¡å‹ç›¸å…³æ¦‚å¿µå’ŒåŸºæœ¬åŸç†ã€‚</p>
<h2 data-id="heading-1">å¤§æ¨¡å‹åŸç†</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯token</h3>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨chatgptï¼Œdeepseekçš„æ—¶å€™ï¼Œç»å¸¸çœ‹åˆ°è®¡è´¹è§„åˆ™ï¼ŒåŸºæœ¬æ˜¯æŒ‰ç…§tokenæ¥è®¡è´¹çš„ï¼Œé‚£ä»€ä¹ˆæ˜¯tokenï¼Ÿå°±æ˜¯ä¸€ä¸ªå­—ç¬¦å—ï¼Ÿ</p>
<p>Tokenå°±æ˜¯å¤§æ¨¡å‹å¤„ç†æ–‡æœ¬çš„æœ€å°å•ä½ã€‚tokenå¯ä»¥è¡¨ç¤ºå•è¯ã€å•è¯çš„ä¸€éƒ¨åˆ†ï¼Œç”šè‡³åªè¡¨ç¤ºå­—ç¬¦ã€‚</p>
<p>â€œä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œæˆ‘æ‰“ç®—å‡ºå»æ‰“ç¾½æ¯›çƒâ€ï¼Œæ‹¿è¿™æ®µè¯æ¥è¯´ï¼Œå¤§æ¨¡å‹ä¼šé€šè¿‡åˆ†è¯å™¨(Tokenizer)ï¼Œå¯èƒ½ä¼šåˆ†æˆå¦‚ä¸‹çš„token: "ä»Šå¤©"ï¼Œâ€œå¤©æ°”â€ï¼Œâ€œå¾ˆâ€ï¼Œâ€œå¥½â€ï¼Œâ€œæˆ‘â€ï¼Œâ€œæ‰“ç®—â€ï¼Œâ€œå‡ºå»â€ï¼Œâ€œæ‰“â€ï¼Œâ€œç¾½æ¯›çƒâ€ã€‚è¿™äº›tokenæœ€åéƒ½è½¬åŒ–ä¸ºå‘é‡ï¼Œæ˜ å°„åˆ°å”¯ä¸€çš„æ•°å€¼è¡¨ç¤ºï¼ŒLLM ä½¿ç”¨å‘é‡æ•°å€¼è¾“å…¥ï¼Œè¿™ç§æ˜ å°„å…è®¸ LLM å°†æ–‡æœ¬æ•°æ®ä½œä¸ºæ•°å­—åºåˆ—è¿›è¡Œå¤„ç†å’Œæ“ä½œï¼Œä»è€Œå®ç°é«˜æ•ˆçš„è®¡ç®—å’Œå»ºæ¨¡ã€‚</p>
<p>å‡è®¾ä¸Šé¢çš„æ–‡æœ¬æ˜¯è¾“å…¥ï¼Œå¤§è¯­è¨€æ¨¡å‹çš„è¾“å‡ºtokenåˆæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿå‡è®¾å¤§æ¨¡å‹çš„è¾“å‡ºæ˜¯â€œæ˜¯çš„ï¼Œä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œä½ å¯ä»¥å¸¦ä¸Šä½ çš„ç¾½æ¯›çƒå»å®¤å¤–ç©â€ã€‚å®é™…ä¸Šï¼Œå¤§æ¨¡å‹çš„è¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªtokenï¼Œä¸€ä¸ªtokençš„è¾“å‡ºï¼Œæœ€åç»„è£…èµ·æ¥ï¼Œåä¸€ä¸ªtokenæ˜¯ä¸Šä¸€ä¸ªtokençš„æ¦‚ç‡è¾“å‡ºã€‚ä¾‹å¦‚å…ˆè¾“å‡ºâ€œæ˜¯çš„â€ï¼Œåé¢ç´§è·Ÿç€çš„é¢„æµ‹tokenæ˜¯â€œï¼Œâ€ï¼Œä¸”æ¦‚ç‡æœ€å¤§ï¼Œæˆ–è€…é«˜äºé˜ˆå€¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62996af715bd46479a238b66f2ad2003~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hhd25fU2hhd24=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766509791&amp;x-signature=RuEO34VG9p6L%2FIqtWTrEyXBEo5s%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹deepseekçš„æµå¼è¾“å‡ºï¼Œå®é™…ä¸Šå°±æ˜¯è¾“å‡ºä¸€ä¸ªä¸ªtokenã€‚</p>
<h3 data-id="heading-3">ä»€ä¹ˆæ˜¯transform</h3>
<p>ä¸Šé¢ä»‹ç»äº†ä¸€ä¸‹ä»€ä¹ˆæ˜¯tokenï¼Œé‚£ä¹ˆå¤§æ¨¡å‹å¦‚ä½•ç†è§£tokenå‘¢ï¼Ÿæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°çš„ç¬¬ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯è®©AIä¸€ä¸ªä¸ªtokenï¼Œé¡ºåºè¯»ï¼Œè¯»äº†ç¬¬ä¸€ä¸ªtokenï¼Œè®°ä½å®ƒï¼Œä¼ ç»™å¤§è„‘ï¼›å†è¯»ç¬¬äºŒä¸ªtokenï¼Œç»“åˆç¬¬ä¸€ä¸ªå­—ç†è§£ï¼Œå†ä¼ ä¸‹å»ã€‚ã€‚ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·æœ‰ä¸¤ä¸ªååˆ†æ˜æ˜¾çš„ç¼ºç‚¹ï¼š</p>
<ol>
<li>æ…¢ï¼Œéœ€è¦ä¸€ä¸ªæ¥ç€ä¸€ä¸ªè¯»ï¼ŒåŒæ—¶ç»“åˆä¸Šæ–‡ï¼Œç†è§£ã€‚</li>
<li>å¥å¿˜ï¼Œå¦‚æœå¥å­å¾ˆé•¿ï¼Œè¯»åˆ°æœ€åå‡ ä¸ªå­—æ—¶ï¼Œå¯èƒ½å·²ç»å¿˜äº†å¼€å¤´è®²ä»€ä¹ˆäº†ï¼ˆæ¯”å¦‚â€œå› ä¸ºâ€¦â€¦æ‰€ä»¥â€¦â€¦â€çš„é€»è¾‘å®¹æ˜“æ–­ï¼‰ã€‚</li>
</ol>
<p>è¿™æ˜¯ä¼ ç»ŸAIçš„æ–¹å¼ï¼Œé€šè¿‡<strong>RNN</strong>ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œæ¥è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ—¥å¸¸ç”¨çš„å¤§æ¨¡å‹ï¼ŒåŸºæœ¬å¤„ç†é€Ÿåº¦éƒ½æ¯”è¾ƒå¿«ï¼Œæ‰€ä»¥å¤§æ¨¡å‹æ˜¾ç„¶å¹¶æ²¡æœ‰é‡‡ç”¨RNNçš„æ–¹å¼å®ç°ï¼Œè€Œæ˜¯é€šè¿‡å¦å¤–ä¸€ç§æ–¹å¼ï¼ŒTransformæ¶æ„æ¥å®ç°ã€‚</p>
<p>Transformæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å¿«ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªä¸ªè¯»çš„ï¼Œè¿˜æ˜¯æ•´ä½“è¯»ï¼Œé€šè¿‡<strong>å¹¶è¡Œè®¡ç®—</strong>ï¼Œç¬é—´æŠŠæ•´æ®µè¯çš„æ‰€æœ‰tokenåŒæ—¶è®°å½•åˆ°è„‘æµ·é‡Œã€‚å½“ç„¶ï¼Œå†™è¿˜æ˜¯ä¸²è¡Œçš„ã€‚</p>
<p>å¹¶è¡Œçš„è¯»å»tokenï¼ŒåŠ¿å¿…ä¼šé€ æˆæœ‰çš„tokenè¯»å¾—å¿«ï¼Œæœ‰çš„tokenè¯»å¾—æ…¢ï¼Œå‡ºç°ä¹±åºè¡Œä¸ºï¼Œä½†æˆ‘ä»¬å†ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å¤§æ¨¡å‹å¹¶æ²¡æœ‰å‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Œé‚£transformå¦‚ä½•è§£å†³çš„ï¼Ÿ</p>
<p>Transformer çš„æ¶æ„ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>ç¼–ç å™¨ (<strong>Encoder</strong>) â€”â€” è´Ÿè´£â€œè¯»â€å’Œâ€œç†è§£â€ï¼šå®ƒæŠŠäººç±»çš„è¯­è¨€ï¼ˆæ–‡å­—ï¼‰è½¬åŒ–æˆè®¡ç®—æœºèƒ½æ‡‚çš„æ•°å­—å‘é‡ï¼ˆç‰¹å¾ï¼‰ã€‚åŒæ—¶ä¹Ÿä¼šè®°å½•æ¯ä¸ªtokenæˆ–è€…æ¯ä¸ªç‰¹å¾çš„<strong>ä½ç½®ç¼–ç </strong>ï¼Œè¿™æ ·å°±èƒ½ä¿è¯tokençš„é¡ºåºæ€§ã€‚</li>
<li>è§£ç å™¨ (<strong>Decoder</strong>) â€”â€” è´Ÿè´£â€œå†™â€å’Œâ€œç”Ÿæˆâ€ï¼šå®ƒæ‹¿åˆ°ç¼–ç å™¨ç»™çš„ç†è§£ç»“æœï¼Œå¼€å§‹ç”Ÿæˆç›®æ ‡è¯­è¨€ï¼ˆæ¯”å¦‚æŠŠä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ï¼Œæˆ–è€…å›ç­”ä½ çš„é—®é¢˜ï¼‰ã€‚è™½è¯´æ˜¯ç”Ÿæˆï¼Œä½†ä¹Ÿä¼šè®¡ç®—å‡ºæ¯æ¬¡è¾“å‡ºtokençš„<strong>ä½ç½®ç¼–ç ã€‚</strong></li>
</ul>
<p>Transformè¿˜æœ‰ä¸ªéå¸¸é‡è¦çš„æœºåˆ¶ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶<strong>self-Attention</strong>ã€‚æˆ‘ä»¬ä»¥â€œè‹¹æœæ‰åœ¨åœ°ä¸Šï¼Œå®ƒæ‘”åäº†ã€‚â€è¿™æ®µè¯ä¸ºä¾‹ã€‚å½“æˆ‘ä»¬è¯»åˆ°â€œå®ƒâ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬äººç±»çŸ¥é“â€œå®ƒâ€æŒ‡çš„æ˜¯â€œè‹¹æœâ€ã€‚ä½†ç”µè„‘æ€ä¹ˆçŸ¥é“â€œå®ƒâ€æ˜¯æŒ‡â€œè‹¹æœâ€è¿˜æ˜¯â€œåœ°â€ï¼Ÿç®€å•ä¸€ç‚¹ç†è§£ï¼ŒTransformer ä¼šè®©æ¯ä¸€ä¸ªtokenï¼Œéƒ½å»å’Œå…¶ä½™tokenè¿›è¡Œç›¸å…³æ€§çš„ç®—åˆ†ï¼Œå–æƒé‡æœ€é«˜çš„é‚£ä¸€ä¸ªtokenã€‚å½“æ¨¡å‹å¤„ç†â€œå®ƒâ€è¿™ä¸ªå­—æ—¶ï¼Œä¼šå‘ç°â€œè‹¹æœâ€è·Ÿå®ƒçš„å…³è”åº¦ï¼ˆæƒé‡ï¼‰å¾ˆé«˜ï¼Œå¯èƒ½æœ‰ 90 åˆ†ã€‚è€Œâ€œåœ°â€è·Ÿå®ƒçš„å…³è”åº¦åªæœ‰ 10 åˆ†ã€‚äºæ˜¯ï¼Œæ¨¡å‹åœ¨ç†è§£â€œå®ƒâ€çš„æ—¶å€™ï¼Œä¼šæŠŠæ³¨æ„åŠ›æ›´å¤šåœ°æ”¾åœ¨â€œè‹¹æœâ€èº«ä¸Šã€‚</p>
<p>å¦å¤–ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç›®å‰Chatgptç­‰ä¸»æµå¤§è¯­è¨€æ¨¡å‹ï¼Œä¸»è¦é‡‡ç”¨çš„æ˜¯çº¯<strong>Decoderæ¨¡å¼</strong>ã€‚</p>
<h2 data-id="heading-4">å‚è€ƒæ–‡çŒ®</h2>
<p>æƒ³è¦æ›´åŠ æ·±å…¥çš„ç†è§£transformerçš„åŒå­¦ï¼Œå¯ä»¥å‚è€ƒï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftransformers.run%2Fc1%2Ftransformer%2F" target="_blank" title="https://transformers.run/c1/transformer/" ref="nofollow noopener noreferrer">transformers.run/c1/transforâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F338817680" target="_blank" title="https://zhuanlan.zhihu.com/p/338817680" ref="nofollow noopener noreferrer">zhuanlan.zhihu.com/p/338817680</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆè¯´ AI èµ‹èƒ½å‰ç«¯å¼€å‘ï¼Œå·²ç»ä¸æ˜¯é€‰æ‹©é¢˜ï¼Œè€Œæ˜¯å¿…ç„¶è¶‹åŠ¿ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584292514959654921</link>    <guid>https://juejin.cn/post/7584292514959654921</guid>    <pubDate>2025-12-16T15:04:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584292514959654921" data-draft-id="7584262116389290010" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆè¯´ AI èµ‹èƒ½å‰ç«¯å¼€å‘ï¼Œå·²ç»ä¸æ˜¯é€‰æ‹©é¢˜ï¼Œè€Œæ˜¯å¿…ç„¶è¶‹åŠ¿ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-16T15:04:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¥¿é™µ"/> <meta itemprop="url" content="https://juejin.cn/user/4353721774379054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆè¯´ AI èµ‹èƒ½å‰ç«¯å¼€å‘ï¼Œå·²ç»ä¸æ˜¯é€‰æ‹©é¢˜ï¼Œè€Œæ˜¯å¿…ç„¶è¶‹åŠ¿ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721774379054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¥¿é™µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T15:04:37.000Z" title="Tue Dec 16 2025 15:04:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¦–å‘äºå…¬ä¼—å·Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FcqfeTj6GhIIv7Ief5554Ow" target="_blank" title="https://mp.weixin.qq.com/s/cqfeTj6GhIIv7Ief5554Ow" ref="nofollow noopener noreferrer">codeè¿›åŒ–è®º</a>ï¼Œæ¬¢è¿å…³æ³¨ã€‚</p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>è¿™å‡ å¹´ AI åœ¨å‰ç«¯å¼€å‘é‡Œçš„èƒ½åŠ›å‡ ä¹æ˜¯è‚‰çœ¼å¯è§åœ°è¿›åŒ–â€ã€‚ä»æœ€æ—©åªèƒ½å¸®æˆ‘ä»¬åšåšä»£ç è¡¥å…¨ã€æç¤ºå‡ ä¸ªå‚æ•°ï¼Œä¾‹å¦‚æ—©æœŸçš„ comateã€‚åˆ°åæ¥èƒ½å¤Ÿç‹¬ç«‹ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ React/Vue ç»„ä»¶ï¼Œè¿é€»è¾‘ã€æ ·å¼å’Œäº¤äº’éƒ½èƒ½è‡ªåŠ¨å†™å¥½ï¼Œä¾‹å¦‚ cursor å’Œ claudeã€‚å†åˆ°ç°åœ¨ï¼ŒAI å·²ç»èƒ½æ ¹æ®ä¸€å¥è‡ªç„¶è¯­è¨€å»æ­å»ºæ•´ä¸ªå‰ç«¯é¡¹ç›®ï¼Œè‡ªåŠ¨åˆ›å»ºé¡µé¢ã€è·¯ç”±ã€æ¥å£å±‚ï¼Œç”šè‡³è·‘é€šåŸºç¡€ä¸šåŠ¡æµç¨‹ï¼Œä¾‹å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fv0.dev%2F" target="_blank" title="https://v0.dev/" ref="nofollow noopener noreferrer">v0</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fbolt.new%2F" target="_blank" title="https://bolt.new/" ref="nofollow noopener noreferrer">bolt.new</a>ã€‚AI çš„è§’è‰²æ­£åœ¨ä»â€œèªæ˜çš„ç¼–è¾‘å™¨â€å˜æˆâ€œèƒ½ç‹¬ç«‹å¹²æ´»çš„è™šæ‹Ÿå·¥ç¨‹å¸ˆâ€ï¼Œè®©å‰ç«¯å¼€å‘çš„é—¨æ§›é™ä½ã€æ•ˆç‡æå‡ï¼Œä¹Ÿè®©æ›´å¤šçš„ç²¾åŠ›èƒ½å¤ŸæŠ•å…¥åˆ°çœŸæ­£æœ‰ä»·å€¼çš„äº§å“è®¾è®¡å’Œä½“éªŒåˆ›æ–°ä¸Šã€‚</p>
<h2 data-id="heading-1">AIèµ‹èƒ½ä¸‹çš„èŒƒå¼è¿ç§»</h2>
<p>åœ¨å½“å‰ AI çš„å‘å±•ä¹‹ä¸‹ï¼ŒAI èµ‹èƒ½å¼€å‘å½“å‰è¿˜å¤„äºæœ€åˆçº§çš„é˜¶æ®µï¼Œè¿™é‡Œå¼•ç”¨äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.iamkasong.com%2Fdocs%2F%25E7%25AC%25AC%25E4%25B8%2580%25E8%25AF%25BE%2520%25E9%259D%25A2%25E5%2590%2591%25E6%259C%25AA%25E6%259D%25A5%25E7%259A%2584%25E5%2589%258D%25E7%25AB%25AF%25E5%258F%2591%25E5%25B1%2595%25E8%25B7%25AF%25E5%25BE%2584.html" target="_blank" title="https://doc.iamkasong.com/docs/%E7%AC%AC%E4%B8%80%E8%AF%BE%20%E9%9D%A2%E5%90%91%E6%9C%AA%E6%9D%A5%E7%9A%84%E5%89%8D%E7%AB%AF%E5%8F%91%E5%B1%95%E8%B7%AF%E5%BE%84.html" ref="nofollow noopener noreferrer">å¡é¢‚è€å¸ˆç”»çš„ä¸€å¼ å›¾</a>ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59fb4816eebc45779e287a5a3dfa4791~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_6Zm1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766502536&amp;x-signature=F3Vs7o4Jd92RiXUFF%2FWmbPzSawA%3D" alt="image.png" loading="lazy"/></p>
<p>å½“å‰é˜¶æ®µæ­£å¤„äºå¼€å‘èŒƒå¼çš„è¿ç§»é˜¶æ®µï¼Œè¿™é‡Œå¯ä»¥å›æƒ³ä¸€ä¸‹å‰ç«¯å¼€å‘å‘å±•çš„å†ç¨‹ï¼š</p>
<ul>
<li>æ‰‹å†™ JSã€HTML ä»£ç ï¼Œæ‰‹åŠ¨å¤„ç†æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ç‚¹ã€‚</li>
<li>å¼•å…¥ jQuery ç»Ÿä¸€ DOM æ“ä½œï¼ŒæŠ¹å¹³æµè§ˆå™¨çš„å·®å¼‚æ€§ã€‚</li>
<li>å¼•å…¥ Reactã€Vue ç­‰å‰ç«¯æ¡†æ¶ï¼Œä»¥æ•°æ®é©±åŠ¨ä¸ºæ ¸å¿ƒï¼Œå°†å¼€å‘è€…ä»å‘½ä»¤å¼çš„å¼€å‘è½¬ä¸ºå£°æ˜å¼å¼€å‘ã€‚</li>
<li>â€¦.</li>
</ul>
<p>ç°é˜¶æ®µçš„ AI ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¼€å‘èŒƒå¼çš„å‘å±•åˆ°äº†ä¸€å®šé˜¶æ®µåå°±ä¼šæ¶Œç°å‡ºæ–°çš„å¼€å‘æŠ€æœ¯æ¥é™ä½é—¨æ§›ã€‚</p>
<h2 data-id="heading-2">å‰ç«¯å¼€å‘è§’è‰²çš„è½¬å˜</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9b9f49e3c894191a4f2d7d973a88429~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_6Zm1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766502536&amp;x-signature=A2WOMH4ev4BPzJ%2FeRvYVB72upks%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ AI æ—¶ä»£ä¸‹ï¼Œå‰ç«¯å¼€å‘çš„è§’è‰²ä¼šé€æ­¥è¿›è¡Œè½¬å˜ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<ul>
<li>
<p><strong>å‰ç«¯å·¥ç¨‹å¸ˆ</strong></p>
<p>ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å‰ç«¯å·¥ç¨‹å¸ˆæŒæ¡ HTML/CSS/JavaScriptï¼Œèƒ½å¤ŸæŠŠè®¾è®¡ç¨¿è¿˜åŸæˆäº¤äº’ç•Œé¢ï¼Œç†Ÿæ‚‰å¸¸è§æ¡†æ¶ï¼ˆå¦‚ React/Vue/Angularï¼‰å’Œå·¥ç¨‹åŒ–å·¥å…·ï¼ˆæ‰“åŒ…ã€CIã€æµ‹è¯•ï¼‰ã€‚ä»–ä»¬çš„ä»·å€¼ä½“ç°åœ¨æŠŠäº§å“éœ€æ±‚è½¬åŒ–ä¸ºç¨³å®šã€å¯ç»´æŠ¤çš„ç”¨æˆ·ç•Œé¢ï¼ŒåŒæ—¶éœ€è¦å…³æ³¨æµè§ˆå™¨å…¼å®¹ã€æ€§èƒ½ä¼˜åŒ–ç­‰ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨AIå·¥å…·çš„å‰ç«¯</strong></p>
<p>è¿›å…¥ AI èµ‹èƒ½é˜¶æ®µï¼Œå‰ç«¯å·¥ç¨‹å¸ˆä¼šæŠŠ AI å½“æˆæ”¾å¤§æ•ˆç‡çš„åŠ©æ‰‹ï¼Œåˆ©ç”¨ AI çš„ä»£ç è¡¥å…¨ã€ç»„ä»¶å¼€å‘ã€è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆç­‰èƒ½åŠ›æé«˜å¼€å‘æ•ˆç‡ã€‚ç»“æœæ˜¯åŒæ ·çš„å·¥ä½œå¯ä»¥æ›´å¿«äº¤ä»˜ï¼Œå·¥ç¨‹å¸ˆæŠŠèŠ‚çœä¸‹æ¥çš„æ—¶é—´æŠ•å…¥åˆ°æ›´é«˜ä»·å€¼çš„å·¥ä½œä¸Šâ€”â€”æ¯”å¦‚æ·±æŒ–ä¸šåŠ¡é€»è¾‘ã€åšå¤æ‚çš„äº¤äº’è®¾è®¡ã€æˆ–è€…æ­å»ºæ›´ç¨³å¥çš„æ¶æ„ã€‚é‡è¦å˜åŒ–ä¸æ˜¯å·¥å…·æœ¬èº«ï¼Œè€Œæ˜¯å°†å·¥ä½œé‡å¿ƒä»å†™ä»£ç è½¬å‘å†™æç¤ºè¯ã€review AI ä»£ç ã€æ¶æ„å†³ç­–ä¸ä¸šåŠ¡ç†è§£ã€‚</p>
</li>
<li>
<p><strong>ä¼šå¼€å‘AIå·¥å…·çš„å‰ç«¯</strong></p>
<p>å‰ç«¯å·¥ç¨‹å¸ˆå¼€å§‹å‚ä¸æˆ–ä¸»å¯¼ AI å·¥å…·çš„å¼€å‘ï¼Œèƒ½æŠŠå‰ç«¯åœºæ™¯æŠ½è±¡æˆå¯å¤ç”¨çš„ AI ææ•ˆå·¥å…·ã€‚</p>
</li>
<li>
<p><strong>æŠ€æœ¯å…¨é¢çš„ä¸“ä¸šå‰ç«¯äººæ‰</strong></p>
<p>å‰ç«¯å·¥ç¨‹å¸ˆä¸å†åªè´Ÿè´£å‰ç«¯é¡µé¢çš„å¼€å‘ï¼Œè€Œéœ€è¦å…·å¤‡æ›´å¹¿çš„æŠ€æœ¯è§†é‡ï¼Œé€æ­¥å‘â€œå¤§å‰ç«¯ / å…¨æ ˆå¼â€æ–¹å‘æ¼”ç”¨AIè¿›ã€‚AI èƒ½å¸®åŠ©å·¥ç¨‹å¸ˆæŠŠä»£ç åœ¨ä¸åŒæŠ€æœ¯æ ˆä¹‹é—´å¿«é€Ÿè¿ç§»ï¼Œä½†å·¥ç¨‹å¸ˆå¿…é¡»å…·å¤‡è·¨æŠ€æœ¯é¢†åŸŸçš„ç†è§£èƒ½åŠ›ï¼Œæ‰èƒ½è¯„ä¼°ã€ä¿®æ”¹å’Œç»´æŠ¤ AI ç”Ÿæˆçš„å¤šç«¯ä»£ç ã€‚å› æ­¤å‰ç«¯éœ€è¦æŒæ¡åç«¯åŸºç¡€ã€Node æœåŠ¡å¼€å‘ã€è·¨ç«¯æ¡†æ¶ã€å°ç¨‹åºã€ç§»åŠ¨ç«¯ç­‰å¤šæ–¹å‘çŸ¥è¯†ï¼Œä½¿è‡ªå·±ä»å•ä¸€å‰ç«¯è§’è‰²æˆé•¿ä¸ºèƒ½å¤Ÿå¤„ç†å¤šç«¯ã€å¤šæ ˆã€å¤šåœºæ™¯çš„æŠ€æœ¯å‹äººæ‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-3">AI å¦‚ä½•èµ‹èƒ½å‰ç«¯</h2>
<h3 data-id="heading-4">å‰ç«¯å¼€å‘æµç¨‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c2f48ab73174294b4ed70b1ac23d6d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_6Zm1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766502536&amp;x-signature=2ALGd91%2BA9pqrjLXQbib28ENgEY%3D" alt="image.png" loading="lazy"/></p>
<p>ç†æƒ³æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„æç¤ºè¯è¶³å¤Ÿç²¾ç¡®ï¼Œä»éœ€æ±‚çš„ç†è§£åˆ°æœ€åçš„ä»£ç å¼€å‘ï¼ŒAI éƒ½èƒ½å¸®æˆ‘ä»¬å®Œæˆå¼€å‘ï¼Œå¼€å‘è€…å”¯ä¸€è¦åšçš„å°±æ˜¯å¯¹ç”Ÿæˆçš„ç»“æœè¿›è¡Œ reviewï¼Œå¹¶ä¼˜åŒ–æç¤ºè¯ã€‚</p>
<p>å¯¹äºå°å‹çš„é¡¹ç›®æ¥è¯´è¿™å³å°†æˆä¸ºç°å®ï¼Œè¯´æ®‹é…·ç‚¹å°±æ˜¯åªä¼šåˆ‡å›¾çš„å‰ç«¯å·¥ç¨‹å¸ˆå³å°†å¤±ä¸šï¼Œä½†æ˜¯å¯¹äºå¤æ‚çš„å¤§å‹é¡¹ç›®æ¥è¯´è¿™æ¡è·¯è¿˜å¾ˆé•¿å¾ˆé•¿ï¼Œé‚£ç°é˜¶æ®µä½œä¸ºå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆçš„æˆ‘ä»¬è¯¥å¦‚ä½•è§„åˆ’ï¼ŒåŒ–è¢«åŠ¨ä¸ºä¸»åŠ¨ï¼Œå°† AI èƒ½åŠ›å†…åŒ–ï¼Ÿ</p>
<h3 data-id="heading-5">AIå¦‚ä½•å¼€å‘ææ•ˆ</h3>
<h4 data-id="heading-6">åˆçº§é˜¶æ®µ</h4>
<p>åˆçº§é˜¶æ®µå¼€å‘è€…åªéœ€è¦ä¼šç®€å•çš„ä½¿ç”¨ AI èƒ½åŠ›å³å¯ï¼š</p>
<ul>
<li>
<p>ä»£ç è¡¥å…¨&amp;ä¼˜åŒ–</p>
<p>ä¾‹å¦‚ storybook ç¤ºä¾‹ã€å•æµ‹ä»£ç ç­‰ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ AI å®Œæˆé™æ€é¡µé¢ã€çº¯ UI ç»„ä»¶ç­‰åŠŸèƒ½å¼€å‘ã€‚</p>
<p>ä¾‹å¦‚ä½¿ç”¨AI + æˆªå›¾æˆ–è€…AI + Figma Mcp å®Œæˆ UI å¼€å‘ã€‚</p>
</li>
<li>
<p>â€¦.</p>
</li>
</ul>
<h4 data-id="heading-7">ä¸­çº§é˜¶æ®µ</h4>
<p>è¯¥é˜¶æ®µå¼€å‘è€…éœ€è¦ç†è§£ <code>AI æç¤ºè¯å·¥ç¨‹</code>ï¼Œå¼€å‘è€…éœ€è¦é€šè¿‡åˆç†çš„ rules æ¥çº¦æŸ AI çš„è¡Œä¸ºï¼Œç¡®ä¿å…¶åœ¨æ‰§è¡Œå¤æ‚ç¼–ç ä»»åŠ¡æ—¶çš„æ¯ä¸€æ­¥æ“ä½œéƒ½å®‰å…¨ã€å¯æ§ä¸”ç¬¦åˆé¢„æœŸã€‚ä¾‹å¦‚å½“å‰ä¸šç•Œæ¥å—åº¦æ¯”è¾ƒé«˜çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FNeekChaw%2FRIPER-5" target="_blank" title="https://github.com/NeekChaw/RIPER-5" ref="nofollow noopener noreferrer">RIPER-5</a> è§„èŒƒï¼Œè¿™ä¸ªé˜¶æ®µ AI å¯ä»¥å¸®åŠ©å¼€å‘è€…å®Œæˆï¼š</p>
<ul>
<li>
<p>é€šè¿‡è®¾ç½® rules å®Œæˆä»£ç çš„åˆæ­¥ crã€‚</p>
</li>
<li>
<p>è‡ªåŠ¨é‡æ„ä¸æŠ€æœ¯å€ºæ²»ç†ã€‚</p>
<p>ä¾‹å¦‚é‡å¤é€»è¾‘æŠ½ç¦»ã€hooks æ‹†åˆ†ã€package å¾ªç¯ä¾èµ–åˆ†æ&amp;è§£å†³ã€‚</p>
</li>
<li>
<p>æ¥å£å¯¹é½ä¸ç±»å‹æ¨å¯¼</p>
</li>
<li>
<p>æŒ‰ç…§è§„èŒƒå®ŒæˆåŠŸèƒ½æ¨¡å—çš„å¼€å‘&amp;è¿­ä»£ã€‚</p>
</li>
<li>
<p>â€¦</p>
</li>
</ul>
<h4 data-id="heading-8">é«˜çº§é˜¶æ®µ</h4>
<p>åœ¨é«˜çº§é˜¶æ®µï¼ŒAI èµ‹èƒ½å‰ç«¯å¼€å‘ä¸å†å±€é™äºå•ç‚¹æ•ˆç‡æå‡ï¼Œè€Œæ˜¯è¿›å…¥èƒ½åŠ›å·¥ç¨‹åŒ–é˜¶æ®µã€‚å¼€å‘è€…ä¸€æ–¹é¢éœ€è¦æŒç»­æ‰©å±• AI åœ¨å·¥ç¨‹ä¸­çš„å‚ä¸æ·±åº¦ï¼Œå¦ä¸€æ–¹é¢é’ˆå¯¹ AI å¹»è§‰ã€ä¸Šä¸‹æ–‡é™åˆ¶å’Œè¡Œä¸ºä¸ç¡®å®šæ€§ç­‰å›ºæœ‰ç¼ºé™·è¿›è¡Œç³»ç»Ÿæ€§æ²»ç†ï¼Œå¹¶å°†å®è·µç»éªŒæ²‰æ·€ä¸º<code>å¯å¤ç”¨çš„å·¥ç¨‹èƒ½åŠ›</code>ï¼Œä»è€Œæ„å»ºç¨³å®šã€å¯æ¼”è¿›çš„æ™ºèƒ½å¼€å‘ä½“ç³»ï¼Œå¹¶å¯åœ¨å›¢é˜ŸåŠç¤¾åŒºè¿›è¡Œåˆ†äº«ã€‚</p>
<p>åœ¨ claude code ä¸­å·²ç»æå‡ºå¹¶æ”¯æŒäº†ç›¸å…³èƒ½åŠ›ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>Agent Skills</li>
<li>Sub Agent</li>
<li>Plugin</li>
</ul>
<p>è¯¦ç»†ä»‹ç»å¯æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.claude.com%2Fdocs%2Fzh-CN%2Fsub-agents" target="_blank" title="https://code.claude.com/docs/zh-CN/sub-agents" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†æœªæ¥ AI çš„å‘å±•çš„è¶‹åŠ¿ï¼Œä»¥åŠå‰ç«¯è§’è‰²çš„è½¬å˜ï¼Œå¯¹å‰ç«¯å·¥ç¨‹å¸ˆæ¥è¯´ AI æ—¢æ˜¯ä¸€ç§æŒ‘æˆ˜ä¹Ÿæ˜¯ä¸€ç§æœºé‡ï¼ŒæŒ‘æˆ˜æ˜¯æŒ‡æœªæ¥ AI å°†ä¼šå…¨é¢æ›¿ä»£åˆçº§å‰ç«¯å·¥ç¨‹å¸ˆï¼Œæœºé‡åˆ™æ˜¯ AI ä¹Ÿèƒ½å¤Ÿèµ‹èƒ½å‰ç«¯å·¥ç¨‹å¸ˆå˜æˆä¸€ä¸ªæ›´å…¨é¢çš„äººæ‰ã€‚æœ€åä¹Ÿä»‹ç»äº† AI èµ‹èƒ½å‰ç«¯å¼€å‘ææ•ˆçš„ä¸‰ä¸ªé˜¶æ®µï¼Œä» AI çš„åŸºæœ¬ä½¿ç”¨åˆ° AI èƒ½åŠ›å·¥ç¨‹åŒ–é€æ­¥æå‡ï¼Œåœ¨åé¢çš„ç³»åˆ—æ–‡ç« ä¸­ä½œè€…ä¼šåˆ†äº«æ›´å¤š AI èµ‹èƒ½å¼€å‘çš„å®æˆ˜æŠ€å·§å’Œç›¸å…³ç†è®ºçŸ¥è¯†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€é¡¹ç›®è¸©å‘å®å½•ã€‘å¹¶å‘ç¯å¢ƒä¸‹ï¼ŒGlideç¼“å­˜å¼•èµ·çš„å›¾ç‰‡åŠ è½½å¼‚å¸¸]]></title>    <link>https://juejin.cn/post/7584320417306492979</link>    <guid>https://juejin.cn/post/7584320417306492979</guid>    <pubDate>2025-12-16T15:36:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584320417306492979" data-draft-id="7584279552433242150" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€é¡¹ç›®è¸©å‘å®å½•ã€‘å¹¶å‘ç¯å¢ƒä¸‹ï¼ŒGlideç¼“å­˜å¼•èµ·çš„å›¾ç‰‡åŠ è½½å¼‚å¸¸"/> <meta itemprop="keywords" content="Android,Debug,Glide"/> <meta itemprop="datePublished" content="2025-12-16T15:36:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lei_official"/> <meta itemprop="url" content="https://juejin.cn/user/2351234021066314"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€é¡¹ç›®è¸©å‘å®å½•ã€‘å¹¶å‘ç¯å¢ƒä¸‹ï¼ŒGlideç¼“å­˜å¼•èµ·çš„å›¾ç‰‡åŠ è½½å¼‚å¸¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2351234021066314/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lei_official
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T15:36:54.000Z" title="Tue Dec 16 2025 15:36:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨ç°å®ä¸»ä¹‰è€…èº«ä¸Šï¼Œå¹¶ä¸æ˜¯å¥‡è¿¹äº§ç”Ÿä¿¡ä»°ï¼Œè€Œæ˜¯ä¿¡ä»°äº§ç”Ÿå¥‡è¿¹ã€‚â€”â€”ã€Šå¡æ‹‰é©¬ä½å¤«å…„å¼Ÿã€‹</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/533f755d7e0a46a0bdf2510cf43fae57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766504213&amp;x-signature=p2PFiQEVbnTBMSJn7zRJ6qspX5w%3D" alt="glide_logo.png" loading="lazy"/></p>
<h2 data-id="heading-0">èƒŒæ™¯ç®€è¿°</h2>
<p>åœ¨ç»´æŠ¤æ™ºèƒ½æ‰‹è¡¨ä¸»é¢˜ç®¡ç†åŠŸèƒ½æ—¶ï¼Œæˆ‘é‡åˆ°è¿‡ä¸€ä¸ªååˆ†æœ‰è¶£çš„bugï¼Œä»æµ‹è¯•é¦–æ¬¡å‘ç°é—®é¢˜æ—¶æ„Ÿåˆ°ååˆ†å›°æƒ‘ä¸”ä¸è§£ï¼Œåˆ°è‡ªå·±æˆ‘ä¸æ–­å°è¯•å¹¶æˆåŠŸå¤ç°ï¼Œç›´è‡³æœ€ç»ˆæ‰¾åˆ°æ ¹æœ¬åŸå› ä¸è§£å†³æ–¹æ¡ˆï¼Œå†ç»ä¸€å‘¨å·¦å³æ—¶é—´ã€‚è™½ç„¶æ˜¯å­˜åœ¨å·²ä¹…çš„å†å²é—®é¢˜ï¼Œä½†ä»æœ‰è®°å½•å’Œæ€»ç»“çš„æ„ä¹‰ï¼ŒåŒæ—¶ä¹Ÿè­¦é†’è‡ªå·±åœ¨è®¾è®¡å¹¶å‘æ¨¡å—æ—¶ï¼Œä¸€å®šè¦å¿ƒå­˜æ•¬æ„ã€è€ƒè™‘å‘¨å…¨ã€‚</p>
<h2 data-id="heading-1">é—®é¢˜ç°è±¡</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14ca16b34a864ee2a66ea2fb0b2033bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766504213&amp;x-signature=VnZB9oMnSBbmDU13iJp9AsFfn4g%3D" alt="" loading="lazy"/></p>
<p>é—®é¢˜çš„è¡¨ç°å¦‚ä¸Šï¼Œç”¨æˆ·ç¼–è¾‘ç›¸å†Œè¡¨ç›˜åï¼Œè¿”å›åˆ°è¡¨ç›˜åˆ—è¡¨é¡µï¼Œé¢„æœŸæ˜¯å¯ä»¥å±•ç¤ºå‡ºæ–°è®¾ç½®çš„ç›¸å†Œè¡¨ç›˜çš„é¢„è§ˆå›¾ï¼Œä½†å®é™…æ•ˆæœå´æ˜¯ï¼Œå›¾ç‰‡ç¡®å®æœ‰åˆ·æ–°å‡ºæ¥ï¼Œä½†åˆæ²¡æœ‰å®Œå…¨åˆ·æ–°ï¼Œåªå±•ç¤ºäº†ä¸ŠåŠéƒ¨åˆ†ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯é»‘è‰²ã€‚</p>
<h2 data-id="heading-2">æŠ€æœ¯è®¾è®¡æ–¹æ¡ˆ</h2>
<p>è¿™ä¸ªæ¨¡å—æ˜¯æˆ‘ä¸­é€”æ¥æ‰‹çš„ï¼Œåœ¨åˆæœŸæ¥æ‰‹æ—¶å°±æƒŠè®¶å…¶åŠŸèƒ½å¤æ‚ä¹‹é«˜ã€é€»è¾‘åµŒå¥—ä¹‹æ·±ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£é—®é¢˜ï¼Œæœ‰å¿…è¦ä»‹ç»ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½çš„æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡ã€‚</p>
<p>æš‚ä¸”ç§°ä¹‹ä¸ºâ€œæ‰‹è¡¨ä¸»é¢˜æ¨¡å—â€ï¼Œç”¨æ¥ç®¡ç†æ™ºèƒ½æ‰‹è¡¨ä¸»é¢˜çš„æ ·å¼ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ™ºèƒ½æ‰‹è¡¨ä¸Šçš„å­—ä½“ã€é¢œè‰²ã€å¸ƒå±€ã€èƒŒæ™¯å›¾ç­‰ï¼Œå½“ç”¨æˆ·å®Œæˆè®¾ç½®åï¼Œç”Ÿæˆå½“å‰é…ç½®ä¸‹çš„é¢„è§ˆå›¾ï¼Œå¹¶ä¿å­˜åœ¨åº”ç”¨æ•°æ®ç›®å½•ä¸‹ï¼ˆ<code>Android/data/packageName/files/aaa_111.png</code>ï¼‰ï¼Œå…¶å®ƒé¡µé¢ï¼ˆä¾‹å¦‚è¡¨ç›˜åˆ—è¡¨é¡µï¼‰ç›‘å¬åˆ°é¢„è§ˆå›¾å˜åŒ–çš„äº‹ä»¶åï¼Œæ›´æ–° UIï¼Œå±•ç¤ºå‡ºæœ€æ–°çš„é¢„è§ˆå›¾ã€‚</p>
<ul>
<li><code>WatchThemePreviewManager</code>ï¼šå•ä¾‹ç±»ï¼Œæä¾›æ¥å£æ›´æ–°å¹¶ä¿å­˜é¢„è§ˆå›¾pngï¼Œå¹¶é€šçŸ¥ç›‘å¬è€…ã€‚</li>
<li><code>WatchThemeView</code>ï¼šç»§æ‰¿è‡ª <code>FrameLayout</code>ï¼Œæ˜¯é¢„è§ˆå›¾çš„å±•ç¤ºViewï¼Œåœ¨ <code>onAttachedToWindow()/onDetachedFromWindow()</code> ä¸­è¿›è¡Œæ³¨å†Œ/åæ³¨å†Œï¼Œç›‘å¬é¢„è§ˆå›¾å˜åŒ–ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d08452cee8d4e2f82eb89082ce43f47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766504213&amp;x-signature=V%2BWVETUFSlrIwo39qXdVMgLgsI8%3D" alt="ç”¨æˆ·æ“ä½œæµç¨‹å›¾.png" loading="lazy"/></p>
<p>é¢„æœŸæ•ˆæœæ˜¯ï¼Œç”¨æˆ·åœ¨APPä¸­æ“ä½œå®Œä¸»é¢˜æ ·å¼è®¾ç½®åï¼Œå…¶å®ƒæ‰€æœ‰å±•ç¤ºè¿™ä¸ªæ‰‹è¡¨è¡¨ç›˜çš„é¡µé¢ï¼Œéƒ½ä¼šåŠ è½½æ–°çš„æ ·å¼å›¾ã€‚ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œçš„ç¡®è¡¨ç°å¦‚é¢„æœŸæ‰€æƒ³ã€‚ä½†æµ‹è¯•å¶å°”ä¼šå‘ç°å‰æ–‡å›¾ä¸­çš„bugï¼Œæ–°çš„é¢„è§ˆå›¾åªå±•ç¤ºäº†ä¸ŠåŠéƒ¨åˆ†ï¼Œå…¶ä¸‹åŠéƒ¨åˆ†æ˜¯çº¯é»‘è‰²ã€‚æŸ¥çœ‹åº”ç”¨æ•°æ®ç›®å½•åï¼Œå‘ç°ç”Ÿæˆçš„å›¾ç‰‡æ˜¯å®Œæ•´çš„ï¼Œå¹¶ä¸å­˜åœ¨ç¼ºå¤±ç°è±¡ï¼›ä»æ—¥å¿—ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å›è°ƒç¡®å®å‘ç”Ÿäº†ï¼Œç»“æœè®©äººç™¾æ€ä¸å¾—å…¶è§£ã€‚</p>
<h2 data-id="heading-3">å½’ç»“ä¸º2ä¸ªé—®é¢˜</h2>
<ul>
<li>Q1ï¼šä¸ºä»€ä¹ˆå›¾ç‰‡åªå±•ç¤ºäº†å±€éƒ¨ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯çº¯é»‘çš„ï¼Ÿ</li>
<li>Q2ï¼šä¸ºä»€ä¹ˆå›è°ƒå‘ç”Ÿåï¼Œæ²¡æœ‰æŠŠæ­£å¸¸çš„å›¾ç‰‡åˆ·æ–°å‡ºæ¥ï¼Ÿ</li>
</ul>
<h2 data-id="heading-4">æœ€ç»ˆåˆ†æç»“è®º</h2>
<p>ç•¥å»ä¸­é—´ç¹ççš„åˆ†æè¿‡ç¨‹ï¼ˆæ— éå°±æ˜¯åœ¨å…³é”®èŠ‚ç‚¹å¢åŠ æ—¥å¿—ã€æ‰“æ–­ç‚¹é€æ­¥è°ƒè¯•ç­‰ï¼‰ï¼Œç›´æ¥å°†ç»“è®ºå¥‰ä¸Šã€‚</p>
<ul>
<li>A1ï¼šä½¿ç”¨ Glide æ˜¾ç¤º png æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶è™½ç„¶å­˜åœ¨ï¼Œä½†å…¶å†…å®¹å°šæœªå®Œå…¨å†™å…¥ã€‚</li>
<li>A2ï¼šGlide åŠ è½½åŒåæ–‡ä»¶ï¼Œå‘½ä¸­ç£ç›˜ç¼“å­˜ï¼Œä¸ä¼šé‡æ–°è¯»å–æ–‡ä»¶ã€‚</li>
</ul>
<h2 data-id="heading-5">Q1ï¼šå›¾ç‰‡åŠ è½½ä¸å®Œæ•´çš„åŸå› </h2>
<p>è™½ç„¶å·²ç»åœ¨ä»£ç é‡Œè€ƒè™‘åˆ°ï¼Œå½“ png æ–‡ä»¶ä¿å­˜å®Œæˆï¼ˆå¤§çº¦300msï¼‰åï¼Œæ‰å›è°ƒé€šçŸ¥ç›‘å¬è€…ã€‚ä½†å­˜åœ¨æé™åœºæ™¯ï¼Œå³åœ¨â€œè¡¨ç›˜ç¼–è¾‘é¡µâ€ç¼–è¾‘åï¼Œå¿«é€Ÿè¿”å›åˆ°ä¸Šä¸€çº§çš„â€œè¡¨ç›˜åˆ—è¡¨é¡µâ€ï¼Œç”±äºâ€œè¡¨ç›˜åˆ—è¡¨é¡µâ€åœ¨<code>onRestart()</code>æ—¶åˆ·æ–°ç•Œé¢ï¼Œä¼šè¯»å–åˆ°æœ€æ–°çš„é¢„è§ˆå›¾pngè·¯å¾„ï¼Œæ–‡ä»¶æ­¤æ—¶å·²å­˜åœ¨ï¼Œä½†å°šæœªå®Œæˆå†™å…¥ï¼Œå› æ­¤ Glide åŠ è½½åˆ°çš„æ˜¯åªå†™å…¥éƒ¨åˆ†å†…å®¹çš„ pngï¼Œä»è€Œå‘ç”Ÿäº†å›¾ä¸­çš„é”™è¯¯åœºæ™¯ã€‚</p>
<h2 data-id="heading-6">A1ï¼šè§£å†³æ–¹æ¡ˆ-å…ˆå†™tmpæ–‡ä»¶å†rename</h2>
<p>å®è·µä¸­ï¼Œå¯¹äºè¿™ç§ä¿å­˜æ•°æ®åˆ°æ–‡ä»¶çš„åœºæ™¯ï¼Œä¸€èˆ¬é‡‡ç”¨â€œä¿å­˜ä¸´æ—¶æ–‡ä»¶-&gt;renameâ€çš„æ–¹æ¡ˆï¼Œå…ˆæŠŠæ•°æ®å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶f.tmpä¸­ï¼Œå†™å…¥å®Œæˆåï¼Œå†å°†å…¶renameä¸ºfï¼Œå¯ä»¥é¿å…å¤–éƒ¨å‘ç”Ÿâ€œè¯»å–éƒ¨åˆ†æ–‡ä»¶â€çš„åœºæ™¯ã€‚</p>
<p>è¿™é‡Œè¿˜ä½¿ç”¨äº† <code>FileOutputStream.flush()</code> å’Œ <code>FileOutputStream.fd.sync()</code>ï¼Œå¯¹äº <strong>é«˜é¢‘å†™å…¥&amp;è¯»å–</strong> çš„åœºæ™¯ï¼Œè¿™æ ·åšå¯ä»¥ä¿éšœæ–‡ä»¶è¢«è¿…é€Ÿæ¨ç»™å†…æ ¸å’Œè½ç›˜æŒä¹…åŒ–ã€‚ä½† <code>sync()</code> å‡½æ•°æœ‰æ€§èƒ½æŸè€—ï¼Œåœ¨å·¥ç¨‹ä¸­æ…ç”¨ã€‚</p>
<p>æ ·ä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * åŸå­æ€§ä¿å­˜å›¾ç‰‡æ–‡ä»¶ï¼Œå¤–éƒ¨ä¸ä¼šè¯»å–åˆ°ä¸€éƒ¨ä»½æ–‡ä»¶
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveBitmapToFileAtomic</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">val</span> dst = File(path)
    dst.parentFile?.mkdirs()

    <span class="hljs-keyword">val</span> tmp = File(dst.parentFile, dst.name + <span class="hljs-string">".tmp"</span>)

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
        FileOutputStream(tmp).use { <span class="hljs-keyword">out</span> -&gt;
            <span class="hljs-keyword">if</span> (!bitmap.compress(Bitmap.CompressFormat.PNG, <span class="hljs-number">100</span>, <span class="hljs-keyword">out</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
            <span class="hljs-keyword">out</span>.flush() <span class="hljs-comment">// æŠŠæ–‡ä»¶æ¨ç»™å†…æ ¸</span>
            <span class="hljs-keyword">out</span>.fd.sync() <span class="hljs-comment">// æŠŠæ–‡ä»¶å¼ºåˆ¶è½ç›˜ï¼ˆæ›´ç¨³ï¼Œä½†æ›´æ…¢ï¼Œå‹¿å¤§æ‰¹é‡è°ƒç”¨ï¼‰ï¼Œé€‚ç”¨äºå†™å®Œç«‹åˆ»è¯»çš„åœºæ™¯</span>
        }

        <span class="hljs-comment">// renameTo åœ¨åŒä¸€åˆ†åŒºé€šå¸¸æ˜¯â€œåŸå­æ›¿æ¢â€æ•ˆæœï¼šè¯»è€…è¦ä¹ˆçœ‹åˆ°æ—§æ–‡ä»¶ï¼Œè¦ä¹ˆçœ‹åˆ°æ–°å®Œæ•´æ–‡ä»¶</span>
        <span class="hljs-keyword">if</span> (dst.exists()) dst.delete()
        tmp.renameTo(dst)
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        tmp.delete()
        <span class="hljs-literal">false</span>
    }
}
</code></pre>
<h2 data-id="heading-7">Q2ï¼šå›è°ƒåæ²¡æœ‰è§¦å‘é‡æ–°åŠ è½½å›¾ç‰‡çš„åŸå› </h2>
<p>å¯¹äºåŒä¸€ä¸ª ImageViewï¼Œä½¿ç”¨ Glide åŠ è½½åŒåæ–‡ä»¶ï¼Œå¦‚æœä¸å¢åŠ æ–‡ä»¶ç­¾åæ ¡éªŒï¼Œä¼šå¯¼è‡´ç›´æ¥å¤ç”¨å‰ä¸€æ¬¡äº§ç”Ÿçš„ç¼“å­˜ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå½“çœŸæ­£å®Œæˆ png æ–‡ä»¶ä¿å­˜åï¼Œå›è°ƒè§¦å‘æ—¶ï¼Œé¢„è§ˆå›¾å¹¶æ²¡æœ‰åˆ·æ–°ä¸ºæ­£å¸¸ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-8">A2ï¼šè§£å†³æ–¹æ¡ˆ-å¢åŠ signature</h2>
<p>è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨è°ƒç”¨ Glide åŠ è½½å›¾ç‰‡æ—¶ï¼Œä½¿ç”¨ <code>signature()</code> å‡½æ•°ï¼Œç”¨äºåœ¨åŸæœ‰çš„ç¼“å­˜Keyè®¡ç®—æ–¹æ³•ä¸Šå¢åŠ å”¯ä¸€æ€§æ ¡éªŒï¼Œå…¶å†…éƒ¨ä½¿ç”¨å‚æ•°çš„ <code>equals()</code> å’Œ <code>hashCode()</code> å®ç°ã€‚æ¥å£æ–‡æ¡£å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">public RequestOptions signature(@NonNull Key signature)

Sets some additional data to be mixed in to the memory and disk cache keys allowing the caller more control over when cached data is invalidated.

Note - The signature does not replace the cache key, it is purely additive.

Parameters:
signature - A unique non-null Key representing the current state of the model that will be mixed in to the cache key.

Returns:
This request builder.

See Also:
ObjectKey
</code></pre>
<p>å› æ­¤ï¼Œåœ¨ä½¿ç”¨Glideä¸ºæ­¤ ImageView åŠ è½½å›¾ç‰‡æ—¶ï¼Œå¯¹äºæ–‡ä»¶åä¸å˜ä½†å†…å®¹å¯èƒ½å‘ç”Ÿå˜åŒ–çš„åœºæ™¯ï¼Œå»ºè®®è¿›ä¸€æ­¥å¢åŠ ç­¾åæ ¡éªŒï¼Œå¸¸è§çš„ signature å‚æ•°æœ‰ <code>file.lastModified()</code>ã€æ–‡ä»¶å­—èŠ‚æ•°ã€md5ç­‰ã€‚</p>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨ <code>æ–‡ä»¶é•¿åº¦_æ›´æ–°æ—¶é—´</code>ï¼Œä½œä¸ºå”¯ä¸€keyï¼Œå¯ä»¥è§£å†³æ–‡ä»¶å†…å®¹æ›´æ–°çš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadPngIntoImageView</span><span class="hljs-params">(imageView: <span class="hljs-type">ImageView</span>, pngFile: <span class="hljs-type">File</span>)</span></span> {
    glide.with(context)
        .load(pngFile)
        .signature(ObjectKey(<span class="hljs-string">"<span class="hljs-subst">${file.length()}</span>_<span class="hljs-subst">${file.lastModified()}</span>"</span>)) <span class="hljs-comment">// æ–‡ä»¶é•¿åº¦_æ›´æ–°æ—¶é—´æˆ³ï¼Œè§£å†³æ–‡ä»¶æ›´æ–°é—®é¢˜</span>
        <span class="hljs-comment">// ç•¥</span>
        .into(imageView)
}
</code></pre>
<h2 data-id="heading-9">å†™åœ¨æœ€åçš„åæ€</h2>
<ol>
<li>è¿™ç§â€œå…ˆå†™tmpæ–‡ä»¶ï¼Œç„¶åé‡å‘½åâ€çš„æ¨¡å¼ï¼Œé€‚ç”¨äºå¤§å¤šæ•°å†™æ–‡ä»¶çš„åœºæ™¯ã€‚ç¬”è€…ä¹‹å‰å¼€å‘apkä¸‹è½½å·¥å…·æ—¶ï¼Œä¹Ÿå¤„ç†è¿‡ç±»ä¼¼é—®é¢˜ï¼Œæ²¡æœ‰ä¸‹è½½å®Œæˆçš„apkæ–‡ä»¶ï¼Œä¹Ÿä¼šè¢«èµ„æºç®¡ç†å™¨è¯†åˆ«æˆå®‰è£…åŒ…ï¼Œä½†è§£æå¿…å®šå¤±è´¥ã€‚</li>
<li>ç¼“å­˜è™½å¥½ï¼Œä½¿ç”¨è¦è°¨æ…ã€‚ä½¿ç”¨GlideåŠ è½½å›¾ç‰‡æ–‡ä»¶ï¼Œåœ¨å¯ç”¨ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ–‡ä»¶åä¸å˜ä½†æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ˜¯ä¸ä¼šè¯»å–æ›´æ–°åçš„å†…å®¹çš„ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[springboot é¡¹ç›® ä»jdk 8 å‡çº§åˆ°jdk21 ä¼šé¢ä¸´å“ªäº›é—®é¢˜]]></title>    <link>https://juejin.cn/post/7584307643000078379</link>    <guid>https://juejin.cn/post/7584307643000078379</guid>    <pubDate>2025-12-16T13:31:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584307643000078379" data-draft-id="7584273076646166534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="springboot é¡¹ç›® ä»jdk 8 å‡çº§åˆ°jdk21 ä¼šé¢ä¸´å“ªäº›é—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-16T13:31:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æå‰é€€ä¼‘çš„javaçŒ¿"/> <meta itemprop="url" content="https://juejin.cn/user/465848660928872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            springboot é¡¹ç›® ä»jdk 8 å‡çº§åˆ°jdk21 ä¼šé¢ä¸´å“ªäº›é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848660928872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æå‰é€€ä¼‘çš„javaçŒ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T13:31:59.000Z" title="Tue Dec 16 2025 13:31:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å…„å¼Ÿä»¬æœ€è¿‘ä¸Šç­æ²¡æ—¶é—´å†™åšå®¢å•Šï¼Œä»Šå¤©åˆæ¥æ°´ä¸€ç¯‡ï¼</p>
<p>Spring Boot é¡¹ç›®ä» JDK 8 å‡çº§åˆ° JDK 21ï¼ˆé•¿æœŸæ”¯æŒç‰ˆ LTSï¼‰ï¼Œä¼šé¢ä¸´å“ªäº›é—®é¢˜ã€‚ ä¸»è¦å°±æ˜¯<strong>APIå˜æ›´ã€æ¡†æ¶é€‚é…ã€ç¬¬ä¸‰æ–¹ä¾èµ–ã€æ„å»ºå·¥å…·é…ç½®</strong>Â é—®é¢˜ã€‚</p>
<blockquote>
<p>æ¨èé˜…è¯»: <a href="https://juejin.cn/user/2634854380340008/posts" target="_blank" title="https://juejin.cn/user/2634854380340008/posts">JDKä»8å‡çº§åˆ°21çš„é—®é¢˜é›†ï¼ˆäº¬ä¸œäº‘ï¼‰</a></p>
</blockquote>
<h2 data-id="heading-1">springbooté¡¹ç›®ä»1.8åˆ°21é¢ä¸´çš„é—®é¢˜</h2>
<h3 data-id="heading-2">ä¸€ã€JDK API å˜æ›´å¯¼è‡´çš„é—®é¢˜</h3>
<p>JDK 8 åˆ° 21 æœ‰å¤§é‡ API åºŸå¼ƒã€ç§»é™¤æˆ–è¡Œä¸ºå˜æ›´ï¼Œæ ¸å¿ƒå½±å“ç‚¹ï¼š</p>
<h4 data-id="heading-3">1. å·²ç§»é™¤çš„ API</h4>
<ul>
<li><code>sun.misc.BASE64Encoder/Decoder</code>ï¼šJDK 8 ä¸­å·²æ ‡è®°åºŸå¼ƒï¼ŒJDK 16 + ç§»é™¤ï¼Œéœ€æ›¿æ¢ä¸º<code>java.util.Base64</code>ï¼›</li>
<li><code>Thread.stop()</code>ã€<code>Thread.suspend()</code>ï¼šJDK 11 + ä¸¥æ ¼é™åˆ¶ï¼Œè°ƒç”¨ä¼šæŠ› UnsupportedOperationExceptionï¼›</li>
<li><code>com.sun.image.codec.jpeg.JPEGCodec</code>ï¼šJDK 9 + ç§»é™¤ï¼Œéœ€æ›¿æ¢ä¸º<code>ImageIO</code>ï¼›</li>
<li><code>java.security.acl</code>åŒ…ï¼šJDK 17 + æ ‡è®°ä¸ºåºŸå¼ƒï¼ŒJDK 21 ä¸­éƒ¨åˆ†ç±»ç§»é™¤ï¼Œéœ€æ”¹ç”¨<code>java.security.Policy</code>ã€‚</li>
</ul>
<h4 data-id="heading-4">2. æ¨¡å—åŒ–é™åˆ¶ï¼ˆJPMSï¼‰</h4>
<p>JDK 9 + å¼•å…¥æ¨¡å—ç³»ç»Ÿï¼Œé»˜è®¤ä¸å…è®¸è®¿é—®<code>sun.*</code>ã€<code>com.sun.*</code>ç­‰å†…éƒ¨ APIï¼š</p>
<ul>
<li>
<p>é—®é¢˜è¡¨ç°ï¼šè¿è¡Œæ—¶æŠ›<code>IllegalAccessError</code>æˆ–<code>ModuleNotFoundException</code>ï¼›</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ›¿æ¢å†…éƒ¨ API ä¸ºæ ‡å‡† APIï¼ˆå¦‚<code>sun.misc.Unsafe</code>æ›¿æ¢ä¸º<code>VarHandle</code>ï¼‰ï¼›</li>
<li>è‹¥å¿…é¡»ä½¿ç”¨ï¼Œéœ€åœ¨å¯åŠ¨å‚æ•°ä¸­æ·»åŠ <code>--add-exports</code>ï¼ˆå¦‚<code>--add-exports java.base/sun.misc=ALL-UNNAMED</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">3. æ—¥æœŸæ—¶é—´ APIï¼ˆå¯é€‰ï¼‰</h4>
<p>JDK 8 çš„<code>Date/Calendar</code>æœªç§»é™¤ï¼Œä½† JDK 1.8 å¼•å…¥çš„<code>java.time</code>ï¼ˆJSR 310ï¼‰åœ¨ 21 ä¸­æ›´å®Œå–„ï¼Œè‹¥é¡¹ç›®ä»ç”¨æ—§ APIï¼Œéœ€æ³¨æ„ï¼š</p>
<ul>
<li><code>SimpleDateFormat</code>çš„çº¿ç¨‹å®‰å…¨é—®é¢˜æœªè§£å†³ï¼Œä½† JDK 21 æ— å˜æ›´ï¼›</li>
<li>æ¨èé€æ­¥æ›¿æ¢ä¸º<code>LocalDateTime</code>ã€<code>ZonedDateTime</code>ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-6">4. å­—ç¬¦ä¸²ä¸é›†åˆ API å˜æ›´</h4>
<ul>
<li><code>String.trim()</code>ï¼šJDK 11 + è¡Œä¸ºä¸å˜ï¼Œä½†<code>String.strip()</code>ï¼ˆå»é™¤ Unicode ç©ºç™½ï¼‰æˆä¸ºæ¨èæ›¿ä»£ï¼›</li>
<li><code>Collections.singletonMap()</code>ï¼šJDK 9 + æ–°å¢<code>Map.of()</code>ã€<code>List.of()</code>ç­‰ä¸å¯å˜é›†åˆå·¥å‚æ–¹æ³•ï¼Œæ—§ä»£ç å…¼å®¹ï¼Œä½†éœ€æ³¨æ„ä¸å¯å˜é›†åˆçš„ç‰¹æ€§ï¼ˆä¸æ”¯æŒä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-7">äºŒã€Mavenç‰ˆæœ¬å…¼å®¹</h3>
<p>JDK 21 å¯¹æ„å»ºå·¥å…·ç‰ˆæœ¬æœ‰æœ€ä½è¦æ±‚ï¼Œæ—§ç‰ˆæœ¬æ„å»ºå·¥å…·æ— æ³•è¯†åˆ« JDK 21 çš„ç¼–è¯‘å‚æ•°ï¼š</p>
<p><strong>Maven</strong>ï¼šéœ€å‡çº§åˆ° 3.8.0+ï¼ˆæ¨è 3.8.5+ï¼‰ï¼Œä¸”<code>maven-compiler-plugin</code>éœ€å‡çº§åˆ° 3.10.0+ï¼ˆå¦åˆ™æ— æ³•ç¼–è¯‘ JDK 21 ä»£ç ï¼‰ã€‚</p>
<pre><code class="hljs language-pom.xml" lang="pom.xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; 
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; 
    &lt;version&gt;3.13.0&lt;/version&gt; 
    &lt;configuration&gt; 
        &lt;release&gt;21&lt;/release&gt;&lt;!-- ç»Ÿä¸€ä½¿ç”¨releaseå‚æ•° --&gt; 
    &lt;/configuration&gt; 
&lt;/plugin&gt;

</code></pre>
<h3 data-id="heading-8">ä¸‰ã€Spring Boot æ¡†æ¶æœ¬èº«å’Œä¸­é—´ä»¶ç‰ˆæœ¬</h3>
<h4 data-id="heading-9">1. Spring Boot ç‰ˆæœ¬å¿…é¡»å‡çº§</h4>
<p>JDK 21 ä»…æ”¯æŒ<strong>Spring Boot 3.1+</strong> ï¼ˆå®˜æ–¹æ˜ç¡®ï¼šSpring Boot 3.0 æ”¯æŒ JDK 17ï¼Œ3.1 å¼€å§‹æ”¯æŒ JDK 21ï¼‰ï¼Œè‹¥é¡¹ç›®å½“å‰æ˜¯ Spring Boot 2.xï¼ˆä»…æ”¯æŒ JDK 8-17ï¼‰ï¼Œéœ€å…ˆå‡çº§åˆ° Spring Boot 3.xï¼Œè¿™ä¼šå¸¦æ¥è¿é”å˜æ›´ï¼š</p>
<ul>
<li>
<p><strong>Spring Boot 3.x æ ¸å¿ƒå˜æ›´</strong>ï¼š</p>
<ul>
<li>åŸºäº Spring Framework 6.xï¼Œè¦æ±‚ Java 17+ï¼ˆJDK 21 å…¼å®¹ï¼‰ï¼›</li>
<li>ç§»é™¤å¯¹<code>javax.*</code>åŒ…çš„æ”¯æŒï¼Œå…¨é¢è¿ç§»åˆ°<code>jakarta.*</code>ï¼ˆå¦‚<code>jakarta.servlet</code>æ›¿ä»£<code>javax.servlet</code>ï¼Œ<code>jakarta.persistence</code>æ›¿ä»£<code>javax.persistence</code>ï¼‰ï¼›</li>
<li>è‡ªåŠ¨é…ç½®ç±»ã€starter ä¾èµ–æœ‰è°ƒæ•´ï¼ˆå¦‚<code>spring-boot-starter-web</code>åº•å±‚ä¾èµ– Tomcat 10+ï¼Œè€Œ Tomcat 10 + ä¹ŸåŸºäº Jakarta EE 9ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li><strong>å†…åµŒå®¹å™¨</strong>ï¼šTomcat 9ï¼ˆJDK 8ï¼‰â†’ Tomcat 10+ï¼ˆJDK 17+ï¼‰ï¼ŒTomcat 10 + çš„ Servlet API ä»<code>javax.servlet</code>è¿ç§»åˆ°<code>jakarta.servlet</code>ï¼Œè‹¥é¡¹ç›®ä¸­æœ‰è‡ªå®šä¹‰ Servlet/Filter/Listenerï¼Œéœ€ä¿®æ”¹åŒ…åï¼›</li>
<li><strong>æ—¥å¿—æ¡†æ¶</strong>ï¼šSpring Boot 3.x é»˜è®¤ä½¿ç”¨ Logback 1.4+ï¼ŒLogback 1.4 + è¦æ±‚ JDK 11+ï¼Œéœ€ç¡®è®¤æ—¥å¿—é…ç½®æ–‡ä»¶ï¼ˆå¦‚<code>logback.xml</code>ï¼‰æ˜¯å¦é€‚é…ï¼›</li>
<li><strong>ç¼“å­˜ã€äº‹åŠ¡ç­‰æ³¨è§£</strong>ï¼š<code>@Transactional</code>ã€<code>@Cacheable</code>ç­‰æ³¨è§£åº•å±‚ä¾èµ–çš„ API æ— å¤§å˜æ›´ï¼Œä½†éœ€ç¡®è®¤ Spring Framework 6.x çš„è¡Œä¸ºå˜æ›´ï¼ˆå¦‚äº‹åŠ¡ä¼ æ’­æœºåˆ¶ã€ç¼“å­˜ç®¡ç†å™¨é€‚é…ï¼‰ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-10">2ã€ç¬¬ä¸‰æ–¹ä¾èµ–å…¼å®¹é—®é¢˜</h4>
<p>è¿™æ˜¯å‡çº§ä¸­æœ€å¸¸è§çš„ â€œå‘â€ï¼Œå¤§é‡ç¬¬ä¸‰æ–¹åº“åœ¨ JDK 21 ä¸‹æ— æ³•è¿è¡Œï¼š</p>
<h5 data-id="heading-11">1. æ•°æ®åº“é©±åŠ¨</h5>
<ul>
<li><strong>MySQL é©±åŠ¨</strong>ï¼š<code>mysql-connector-java</code>Â 8.0.28 + æ‰æ”¯æŒ JDK 17+ï¼Œéœ€å‡çº§åˆ° 8.0.30+ï¼ˆé€‚é… JDK 21ï¼‰ï¼›</li>
<li><strong>Oracle é©±åŠ¨</strong>ï¼šojdbc8 ä»…æ”¯æŒ JDK 8-11ï¼Œéœ€å‡çº§åˆ° ojdbc11ï¼ˆæ”¯æŒ JDK 11-21ï¼‰ï¼›</li>
<li><strong>PostgreSQL é©±åŠ¨</strong>ï¼š42.2.x ä»…æ”¯æŒ JDK 8ï¼Œéœ€å‡çº§åˆ° 42.5+ï¼ˆæ”¯æŒ JDK 17+ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-12">2. ä¸­é—´ä»¶å®¢æˆ·ç«¯</h5>
<ul>
<li><strong>Redis</strong>ï¼š<code>jedis</code>Â 3.7.x ä»…æ”¯æŒ JDK 8ï¼Œéœ€å‡çº§åˆ° 4.0+ï¼ˆæ”¯æŒ JDK 11+ï¼‰ï¼›</li>
<li><strong>Kafka</strong>ï¼š<code>kafka-clients</code>Â 2.8.x æ”¯æŒ JDK 8ï¼Œ3.0 + æ”¯æŒ JDK 11+ï¼Œéœ€å‡çº§åˆ° 3.4+ï¼ˆé€‚é… JDK 21ï¼‰ï¼›</li>
<li><strong>Elasticsearch</strong>ï¼š7.17.x æ”¯æŒ JDK 8-17ï¼Œ8.x æ”¯æŒ JDK 17+ï¼Œéœ€å‡çº§å®¢æˆ·ç«¯åˆ° 8.xï¼ˆé€‚é… JDK 21ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-13">3. å…¶ä»–å¸¸ç”¨åº“</h5>
<ul>
<li><strong>MyBatis</strong>ï¼š3.5.9 + æ”¯æŒ JDK 17+ï¼Œéœ€å‡çº§ï¼ˆæ—§ç‰ˆæœ¬ 3.5.6 ä»¥ä¸‹åœ¨ JDK 21 ä¸­ä¼šæŠ›ç±»åŠ è½½å¼‚å¸¸ï¼‰ï¼›</li>
<li><strong>FastJSON</strong>ï¼š1.2.83 ä»¥ä¸‹å­˜åœ¨ JDK 17 + å…¼å®¹é—®é¢˜ï¼Œéœ€å‡çº§åˆ° 2.0+ï¼ˆFastJSON2ï¼‰ï¼›</li>
<li><strong>Apache Commons</strong>ï¼š<code>commons-lang3</code>éœ€å‡çº§åˆ° 3.12.0+ï¼Œ<code>commons-collections4</code>éœ€å‡çº§åˆ° 4.4+ï¼›</li>
<li><strong>Lombok</strong>ï¼š1.18.20 ä»¥ä¸‹ä¸æ”¯æŒ JDK 16+ï¼Œéœ€å‡çº§åˆ° 1.18.30+ï¼ˆé€‚é… JDK 21ï¼‰ï¼Œä¸”éœ€åœ¨ Maven ä¸­é…ç½®<code>lombok.version</code>ä¸ºæœ€æ–°ç‰ˆã€‚</li>
</ul>
<h3 data-id="heading-14">å››ã€è¿è¡Œæ—¶ä¸å¯åŠ¨å‚æ•°é—®é¢˜</h3>
<h4 data-id="heading-15">1. JVM å‚æ•°å˜æ›´</h4>
<ul>
<li>JDK 8 çš„<code>-XX:+UseConcMarkSweepGC</code>ï¼ˆCMS åƒåœ¾æ”¶é›†å™¨ï¼‰åœ¨ JDK 14 ä¸­åºŸå¼ƒï¼ŒJDK 21 ä¸­ç§»é™¤ï¼Œéœ€æ›¿æ¢ä¸º<code>-XX:+UseG1GC</code>ï¼ˆé»˜è®¤ï¼‰æˆ–<code>-XX:+UseZGC</code>ï¼ˆJDK 15 + æ­£å¼æ”¯æŒï¼Œä½å»¶è¿Ÿï¼‰ï¼›</li>
<li><code>-XX:+UseParallelGC</code>ä»å¯ç”¨ï¼Œä½†æ¨èé€‚é…æ–° GCï¼›</li>
<li>JDK 11 + ç§»é™¤<code>-XX:+UseCGroupMemoryLimitForHeap</code>ï¼Œéœ€æ”¹ç”¨<code>-XX:+UseContainerSupport</code>ï¼ˆé»˜è®¤å¼€å¯ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-16">2. æ¨¡å—åŒ–å¯åŠ¨å‚æ•°</h4>
<p>è‹¥é¡¹ç›®æœªé€‚é…æ¨¡å—åŒ–ï¼Œéœ€æ·»åŠ å¯åŠ¨å‚æ•°é¿å…æ¨¡å—å†²çªï¼š</p>
<pre><code class="hljs language-css" lang="css">java <span class="hljs-attr">--add-modules</span> <span class="hljs-attribute">ALL</span>-MODULE-PATH \
     <span class="hljs-attr">--add-exports</span> java<span class="hljs-selector-class">.base</span>/sun<span class="hljs-selector-class">.misc</span>=<span class="hljs-attribute">ALL</span>-UNNAMED \
     -jar your-app<span class="hljs-selector-class">.jar</span>
</code></pre>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>ä¸»è¦çš„é£é™©ç‚¹ï¼šspring boot éœ€è¦å‡çº§åˆ°<strong>Spring Boot 3.1+</strong> ï¼Œå¤§ç‰ˆçš„å‡çº§å°±æ¶‰åŠåˆ°å¾ˆå¤šä¸­é—´ä»¶éœ€è¦è·Ÿç€å‡çº§ï¼Œå…¶æ¬¡å°±æ˜¯ä¸€äº›APIå¯èƒ½è¢«ç§»é™¤äº†ï¼Œè¿™å—ç¼–è¯‘å°±é˜¶æ®µå°±èƒ½è§£å†³ã€‚è¿˜æœ‰å°±æ˜¯æˆ‘ä»¬mavenç‰ˆæœ¬å’Œç¼–è¯‘æ’ä»¶éœ€è¦å‡çº§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‡ºæµ·åˆ«å† 1:1 æŠ„ç«™äº†:ã€Šæ¯›é€‰ã€‹ç»™æˆ‘çš„ 6 æ¡åº•å±‚æ€è€ƒ]]></title>    <link>https://juejin.cn/post/7584286241488273448</link>    <guid>https://juejin.cn/post/7584286241488273448</guid>    <pubDate>2025-12-16T14:03:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584286241488273448" data-draft-id="7584286241488240680" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‡ºæµ·åˆ«å† 1:1 æŠ„ç«™äº†:ã€Šæ¯›é€‰ã€‹ç»™æˆ‘çš„ 6 æ¡åº•å±‚æ€è€ƒ"/> <meta itemprop="keywords" content="äº§å“,åˆ›ä¸š,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-16T14:03:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­Ÿå¥AIç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/4212984287073895"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‡ºæµ·åˆ«å† 1:1 æŠ„ç«™äº†:ã€Šæ¯›é€‰ã€‹ç»™æˆ‘çš„ 6 æ¡åº•å±‚æ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984287073895/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­Ÿå¥AIç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T14:03:41.000Z" title="Tue Dec 16 2025 14:03:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å­Ÿå¥ã€‚</p>
<p>å¥½ä¹…ä¸è§ã€‚å‰æ®µæ—¶é—´æˆ‘è¢«ç”²æµ <strong>H3N2</strong> æ”¾å€’äº†ï¼Œæ¢å¤äº†ä¸¤å‘¨æ‰ç¼“è¿‡æ¥ï¼Œä½“æ„Ÿä¸äºšäºæ–°å† ã€‚å†¬å­£æµæ„Ÿé«˜å‘ï¼Œå¤§å®¶æ³¨æ„é˜²æŠ¤ï¼Œåˆ«ç¡¬æ‰›ã€‚</p>
<p>èººç€ä¼‘æ¯çš„è¿™æ®µæ—¶é—´ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³ä¸€ä¸ªé—®é¢˜ï¼š</p>
<p><strong>åˆ›ä¸šåˆ°åº•æœ‰æ²¡æœ‰ä¸€å¥—å¯å¤ç”¨çš„åº•å±‚æ–¹æ³•è®ºï¼Ÿæœ‰æ²¡æœ‰ä¸€ç§â€œæ›´åº•å±‚çš„æ€ç»´â€ï¼Œèƒ½åœ¨ä¸ç¡®å®šæ€§é‡Œç»™æˆ‘ä»¬ä¸€ä¸ªç¨³å®šçš„æŒ‡å—é’ˆï¼Ÿ</strong></p>
<p>æ€æ¥æƒ³å»ï¼Œæˆ‘å‘ç°ç­”æ¡ˆå¾ˆæœ´ç´ ï¼šå»è¯»ã€Šæ¯›é€‰ã€‹ã€‚</p>
<p>å®ƒå‘Šè¯‰ä½ <strong>å¦‚ä½•è®¤è¯†ä¸–ç•Œã€å¦‚ä½•åˆ†æé—®é¢˜ã€å¦‚ä½•ç»„ç»‡è¡ŒåŠ¨</strong>ã€‚</p>
<p>æŠŠå®ƒæŠ½è±¡æˆæ–¹æ³•è®ºï¼Œå†æ”¾å›åˆ°å•†ä¸šä¸å‡ºæµ·çš„è¯­å¢ƒé‡Œï¼Œä¼šéå¸¸å¥½ç”¨ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘æƒ³æŠŠè‡ªå·±çš„å®æˆ˜ä½“ä¼šï¼Œå’Œã€Šæ¯›é€‰ã€‹é‡Œå‡ æ¡æ ¸å¿ƒæ€ç»´åšä¸€ä¸ªå¯¹åº”ï¼Œä¾›ä½ å‚è€ƒï¼š</p>
<ul>
<li>
<p><strong>å®äº‹æ±‚æ˜¯</strong>ï¼šç”¨è°ƒæŸ¥æ›¿ä»£è‡†æƒ³ï¼Œè®©å†³ç­–å¯¹é½ç°å®</p>
</li>
<li>
<p><strong>é˜¶çº§åˆ†æ</strong>ï¼šçœ‹æ¸…åˆ©ç›Šç»“æ„ï¼Œå†³å®šå›¢ç»“è°ã€åˆä½œè°ã€å¯¹æŠ—è°</p>
</li>
<li>
<p><strong>ä¸»è¦çŸ›ç›¾</strong>ï¼šæŠ“ä½â€œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«â€çš„å…³é”®é—®é¢˜ï¼Œé¿å…çœ‰æ¯›èƒ¡å­ä¸€æŠŠæŠ“</p>
</li>
<li>
<p><strong>å¯¹ç«‹ç»Ÿä¸€</strong>ï¼šè¾©è¯çœ‹ä¼˜åŠ£ï¼ŒæŠŠä¸åˆ©æ¡ä»¶è½¬åŒ–ä¸ºæœ‰åˆ©æ¡ä»¶</p>
</li>
<li>
<p><strong>æŒä¹…æˆ˜</strong>ï¼šä»¥æ—¶é—´æ¢ç©ºé—´ï¼Œåœ¨æ­£ç¡®æˆ˜åœºé•¿æœŸç§¯ç´¯ä¼˜åŠ¿</p>
</li>
<li>
<p><strong>ä»ç¾¤ä¼—ä¸­æ¥ï¼Œåˆ°ç¾¤ä¼—ä¸­å»</strong>ï¼šç”¨ MVP + åé¦ˆé—­ç¯ï¼ŒæŠŠè®¤çŸ¥è½åˆ°å®è·µé‡Œ</p>
</li>
</ul>
<h3 data-id="heading-0">01ï½œå®äº‹æ±‚æ˜¯ï¼šåˆ›ä¸šæœ€ç¨€ç¼ºçš„ä¸æ˜¯èªæ˜ï¼Œæ˜¯â€œäº‹å®â€</h3>
<p>æ¯›é€‰çš„æ€æƒ³æ¡†æ¶ï¼Œå»ºç«‹åœ¨å››ä¸ªå­—çš„åŸºçŸ³ä¸Šé¢â€”â€”å®äº‹æ±‚æ˜¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cd319a2c81a4ab3b9ce3682e298e54e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=BEKnxCrPgstZ7vQrzyPT2RcwFdc%3D" alt="" loading="lazy"/></p>
<p>â€œå®äº‹â€å°±æ˜¯å®¢è§‚å­˜åœ¨ç€çš„ä¸€åˆ‡äº‹ç‰©ï¼Œâ€œæ˜¯â€å°±æ˜¯å®¢è§‚äº‹ç‰©çš„å†…éƒ¨è”ç³»ï¼Œä¹Ÿå°±æ˜¯è§„å¾‹æ€§ï¼Œâ€œæ±‚â€å°±æ˜¯å»ç ”ç©¶ã€‚</p>
<p>å®äº‹æ±‚æ˜¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è¦æ±‚æˆ‘ä»¬çš„æ€æƒ³å¿…é¡»å’Œå®¢è§‚ç°å®ç²¾å‡†å¯¹åº”èµ·æ¥ã€‚</p>
<p>è¿™å¬èµ·æ¥ç†æ‰€å½“ç„¶ï¼Œä½†æ˜¯å®é™…å¹¶ä¸å®¹æ˜“åšåˆ°ã€‚</p>
<p>ä¹‹å‰æˆ‘åˆ†äº«è¿‡å¿«æ€è€ƒæ…¢æ€è€ƒï¼Œäººç±»çš„å¤§è„‘åå‘äºè€—èƒ½ä½çš„å¿«æ€è€ƒæ¥åšå†³ç­–ï¼Œä¹Ÿå°±æ˜¯è¯´ä¾èµ–ç›´è§‰ã€ç»éªŒã€æƒ…ç»ªç­‰ç­‰æ¥åšåˆ¤æ–­ã€‚</p>
<p>æˆ‘ä»¬ç»å¸¸çœ‹åˆ°æŸä¸ªäººæˆåŠŸäº†ï¼Œæˆ–è€…å•†ä¸šæ¨¡å¼æˆåŠŸäº†ï¼Œå°±æ€¥äºå»å¤åˆ¶å®ƒçš„è¡¨è±¡ã€‚</p>
<p>åœ¨åšå‡ºæµ·çš„æ—¶å€™ï¼Œè¿™ç§ä¾‹å­å¤ªå¤šäº†ï¼Œå¾ˆå¤šäººä¼šå» 1:1 å¤åˆ¶åˆ«äººçš„ç«™ç‚¹ï¼Œåƒç´ çº§å¯¹é½ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿½ç•¥äº†å®ƒèƒ½å¤ŸæˆåŠŸçš„â€œå®äº‹â€æ˜¯ä»€ä¹ˆï¼Œå®ƒçš„å¸‚åœºç¯å¢ƒã€ç”¨æˆ·åŸºç¡€ã€å†…éƒ¨ç¯èŠ‚ä¹‹é—´çš„â€œæ˜¯â€ã€‚</p>
<p>çœŸæ­£çš„å®äº‹æ±‚æ˜¯ï¼Œç¬¬ä¸€æ­¥æ˜¯æ”¾ä¸‹é¢„è®¾çš„ç«‹åœºå’Œç­”æ¡ˆï¼Œè¿™æ˜¯ä¸€ç§â€œç©ºæ¯å¿ƒæ€â€ï¼Œæ‰¿è®¤è‡ªå·±çš„æ— çŸ¥ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦è¯¢é—®çš„æ˜¯â€œäº‹å®ç©¶ç«Ÿæ˜¯ä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œæˆ‘è®¤ä¸º/å¸Œæœ›äº‹å®æ˜¯ä»€ä¹ˆâ€ã€‚</p>
<p>æˆ‘ä»¬å‡ºæµ·åšäº§å“çš„ç¬¬ä¸€æ­¥å°±æ˜¯å»æŒ–æ˜éœ€æ±‚ï¼Œå¾ˆå®¹æ˜“æ²¡æœ‰â€œç©ºæ¯å¿ƒæ€â€ã€‚</p>
<p>æ¯”å¦‚ï¼Œåœ¨çœ‹åˆ°ä¸€ä¸ªâ€œbackground removeâ€è¿™ä¸ªå…³é”®è¯ï¼Œæƒ³å½“ç„¶çš„è®¤ä¸ºè¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„éœ€æ±‚ï¼Œä¸å°±æ˜¯å»é™¤èƒŒæ™¯å—ï¼Ÿ</p>
<p>ä½ å»æ·±å…¥çœ‹ä¸€ä¸‹ï¼Œå°±çŸ¥é“è¿™æ˜¯ Photoshop çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå›´ç»•è¿™ä¸ªäº‹æƒ…åšäº†å¤šä¹ˆå¤§é‡çš„å·¥ä½œï¼Œå¸‚åœºä¸Šæœ‰å¤šå°‘ç«å“ã€‚</p>
<p>æˆ‘ä»¬å›¢é˜Ÿæœ‰çš„æ—¶å€™åšå†…é¡µçš„éœ€æ±‚ï¼Œæƒ³å½“ç„¶çš„å°±æ˜¯æ ¹æ®å…³é”®è¯è®© AI å»ç”Ÿæˆé¡µé¢ï¼Œè¿™æ˜¯è‚¯å®šä¸è¡Œçš„ã€‚</p>
<p>ç¬¬ä¸€ï¼ŒAI çš„çŸ¥è¯†åº“æ˜¯è€æ—§çš„ï¼Œä½ ç»™ä»–ä¸€ä¸ªå…³é”®è¯ï¼Œä»–æœªå¿…èƒ½å¤Ÿæ·±å…¥ç†è§£èƒŒåçš„éœ€æ±‚ï¼ŒåŸºæœ¬ä¸Šå‡ºæ¥çš„éƒ½æ˜¯åºŸè¯å¹»è§‰ã€‚</p>
<p>ç¬¬äºŒï¼Œgoogle æ¯å¤©éƒ½åœ¨æ›´æ–°ä¿¡æ¯ï¼Œä¸€ä¸ªè¯èƒŒåå¯èƒ½æ˜¯ä¸€ä¸ªè®¨è®ºã€ä¸€ä¸ªäº‹ä»¶ã€ä¸€ä¸ªå·¥å…·ç­‰ç­‰ï¼Œä½ åœ¨æ²¡æœ‰è°ƒæŸ¥ä¹‹å‰ï¼Œæ ¹æœ¬ä¸çŸ¥é“è¿™ä¸ªè¯æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚</p>
<p>æ²¡æœ‰è°ƒæŸ¥ï¼Œå°±æ²¡æœ‰å‘è¨€æƒã€‚æˆ‘ä»¬å‡ºæµ·å»åšäº§å“ï¼Œè‚¯å®šè¦ç ”ç©¶å¸‚åœºï¼Œç ”ç©¶ç«å“ã€‚æ–©æ–­ä¸€åˆ‡çš„è‡†æƒ³å’Œæ£æµ‹ï¼Œè€Œä¸”ä¸èƒ½å¤ªè¡¨é¢çš„è°ƒç ”ã€‚</p>
<p>è°ƒç ”æ˜¯æœ‰æ–¹å¼æ–¹æ³•çš„ï¼ŒæŸ¥èµ„æ–™è¦å»æŸ¥ä¸€æ‰‹èµ„æ–™ï¼Œè€Œä¸æ˜¯ AI æ€»ç»“çš„å¹»è§‰èµ„æ–™ã€‚å¾ˆå¤šäººç°åœ¨éƒ½å€ŸåŠ© AI åˆ†æéœ€æ±‚ï¼Œè¿™æ˜¯ä¸å¥½çš„ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„å‡ºæµ·å»åˆ†æéœ€æ±‚çš„æ—¶å€™ï¼Œè¦å» Redditã€Twitterã€Facebookã€Youtube ç­‰ç­‰å¤šç§æ¸ é“ï¼Œç†è§£è¿™ä¸ªéœ€æ±‚èƒŒåçš„ç¬¬ä¸€æ‰‹èµ„æ–™èƒŒæ™¯ï¼Œæ‰èƒ½æ·±åˆ»æ˜ç™½çœŸæ­£çš„ç”¨æˆ·éœ€æ±‚ã€‚</p>
<p>åŸºäºå®äº‹æ±‚æ˜¯çš„æ€æƒ³ï¼Œå»ç†è§£éœ€æ±‚ï¼Œæˆ‘ä»¬çš„è°ƒç ”æ˜¯æ·±åˆ»çš„ï¼Œè€Œä¸æ˜¯è¡¨é¢çš„ï¼Œæ˜¯çœŸå®çš„ï¼Œè€Œä¸æ˜¯è‡†æµ‹çš„ï¼Œè¿™å°±æ˜¯æ´å¯Ÿï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæˆ‘ä»¬å°±æœ‰äº†æ´è§ã€‚</p>
<p>å¯ä»¥è¯´ï¼ŒæŒæ¡äº†å®äº‹æ±‚æ˜¯ï¼Œå°±èƒ½åšåˆ°ï¼Œæ— è®ºå¤–ç•Œç¯å¢ƒå¤šä¹ˆå¤æ‚å¤šå˜ï¼Œéƒ½èƒ½æ‰¾åˆ°é€šå¾€æ­£ç¡®æ–¹å‘çš„é“è·¯ã€‚</p>
<h3 data-id="heading-1">02ï½œé˜¶çº§åˆ†æï¼šçœ‹æ¸…åˆ©ç›Šç»“æ„ï¼Œæ‰èƒ½åšå‡ºæ­£ç¡®ç«™ä½</h3>
<p>æ¯›é€‰çš„ç¬¬äºŒä¸ªæ€æƒ³æ˜¯é˜¶çº§åˆ†æï¼Œä¹Ÿå°±æ˜¯åˆ†æ¸…è°æ˜¯æˆ‘ä»¬çš„æ•Œäººï¼Œè°æ˜¯æˆ‘ä»¬çš„æœ‹å‹ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå¤©ä¸‹ç†™ç†™ï¼Œçš†ä¸ºåˆ©æ¥ï¼Œåœ¨å•†ä¸šä¸–ç•Œä¸­ï¼Œæ‰€æœ‰çš„äººæˆ–äº‹éƒ½ç»‘å®šåœ¨åˆ©ç›Šä¸Šé¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6fd9c8f437241fca61b07b205fc91ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=quAh5ddJBu2f%2FqWPX%2BieuxzRAps%3D" alt="" loading="lazy"/></p>
<p>æ¯ä¸ªäººçš„æ ¸å¿ƒè¯‰æ±‚å’Œåˆ©ç›Šéƒ½ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨æ¨åŠ¨äº‹æƒ…å’Œåšå†³ç­–ä¹‹å‰ï¼Œå…ˆè¦åˆ’åˆ†åˆ©ç›Šç¾¤ä½“ï¼Œæ¯”å¦‚å¯¹äºå¹³å°å‹äº§å“æ¥è¯´ï¼Œå¹³å°æ–¹ã€å¤§ V åˆ›ä½œè€…ã€ä¸­å°åˆ›ä½œè€…ã€æ™®é€šç”¨æˆ·ã€å¹¿å‘Šå•†ï¼Œä»–ä»¬å°±æ˜¯ä¸åŒåˆ©ç›Šé˜¶çº§çš„ç¾¤ä½“ã€‚</p>
<p>åœ¨æˆ‘ä»¬é‚£ä¸ªçˆ†å‘çš„ç«™ç‚¹äº§å“ä¸Šçº¿åï¼Œå…¶å®æœ‰ä¸€ç³»åˆ—ç«äº‰è€…å‡ºç°ï¼Œä¹Ÿæœ‰ä¸€ç³»åˆ—å¸Œæœ›åˆä½œçš„é‚®ä»¶å‡ºç°ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ç«™åœ¨åˆ©ç›Šçš„è§’åº¦ï¼Œæ€è€ƒå¦‚ä½•å»åšå†³ç­–ï¼Œæ€»ä½“çš„æŒ‡å¯¼æ€æƒ³å°±æ˜¯å›¢ç»“æœ‹å‹ï¼Œæ‰“å‡»æ•Œäººã€‚</p>
<p>æˆ‘ä¹‹å‰å®Œå…¨ä¸ç†Ÿæ‚‰æµ·å¤– Affliate çš„è¿™å¥—ç©æ³•ï¼Œåœ¨äº§å“ä¸Šçº¿åï¼Œå€’é—­è‡ªå·±å®Œå…¨å°† Affliate çš„æ–¹å¼ç ”ç©¶é€å½»ï¼Œç°åœ¨æˆ‘æ¥è‡ªäº Affliate çš„æ”¶å…¥å·²ç»è¶…è¿‡äº†åƒåˆ€ï¼Œè€Œä¸”å·²ç»æ­£å¼è¿ç§»è‡³ Affliate å¹³å°å½“ä¸­ï¼Œå»ºç«‹äº†é•¿æœŸçš„åˆä½œå…³ç³»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a47172e362c441b8604d8b5c9db6054~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=eRw6B2TkbPxEl4pjeL5FIxPI4fY%3D" alt="" loading="lazy"/></p>
<p>åœ¨æˆ‘ SEO æ’åä¸‹é™çš„é‚£æ®µæ—¶é—´ï¼Œæˆ‘çš„æ”¶ç›Šä¸é™åå¢ï¼Œå› ä¸ºæ’åä¸Šå‡çš„æ˜¯æˆ‘çš„ç›Ÿå‹ï¼Œé€šè¿‡ Affliate è¿‡æ¥çš„ç”¨æˆ·ä»·å€¼è¿œè¿œå¤§äºæ‰€è°“ SEO æ’åçš„æµé‡ï¼Œè¿™å°±æ‰“äº†ä¸€åœºå¾ˆå¥½çš„é˜²å¾¡æˆ˜ã€‚</p>
<p>åœ¨ç°åœ¨ï¼Œæˆ‘çš„ SEO åˆé‡å›äº†å‰ä¸‰çš„æ’åä½ç½®ï¼Œè¿™ä¸ªæˆ˜ç•¥ä¸é˜¶çº§åˆ†æçš„æ€ç»´æ–¹æ³•æ˜¯ä¸è°‹è€Œåˆçš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcb453c3e5994960a58515ed282b998c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=d%2Fq6LDYZq2vsA7deN8TNQccJH48%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">03ï½œæŠ“ä¸»è¦çŸ›ç›¾ï¼š0-1 é˜¶æ®µï¼Œå…ˆè§£å†³â€œæ´»ä¸‹å»â€</h3>
<p>æ¯›é€‰çš„ç¬¬ä¸‰ä¸ªæ€æƒ³ï¼Œæ˜¯æŠ“ä½ä¸»è¦çŸ›ç›¾ã€‚åšå‡ºæµ·åº”ç”¨ï¼Œæˆ‘ä»¬é¢ä¸´çš„åœºæ™¯æ˜¯å¤æ‚å¤šå˜çš„ï¼Œå„ç§å„æ ·çš„ç»†èŠ‚å’ŒçŸ›ç›¾é”™ç»¼å¤æ‚ï¼Œåˆ°åº•åº”è¯¥ä»ä½•å¤„ç€æ‰‹ï¼Œå¦‚æœç¼ºä¹ä¸€ä¸ªæ¸…æ™°çš„ä¼˜å…ˆçº§ï¼Œå°±ä¼šé™·å…¥çœ‰æ¯›èƒ¡å­ä¸€æŠŠæŠ“çš„å›°å¢ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f97503f172849179e5b8ba9c59a18db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=Pp1fi2REtpNLMnNFuNBM86T4yyg%3D" alt="" loading="lazy"/></p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ˜¯ä¸»è¦çŸ›ç›¾å‘¢ï¼Ÿæ ‡å‡†åªæœ‰ä¸€ä¸ªï¼šçœ‹å“ªä¸ªçŸ›ç›¾çš„å­˜åœ¨å’Œå‘å±•ï¼Œè§„å®šæˆ–å½±å“äº†å…¶ä»–çŸ›ç›¾çš„å­˜åœ¨å’Œå‘å±•ã€‚ä¸»è¦çŸ›ç›¾å¾€å¾€å°±æ˜¯ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚</p>
<p>åœ¨æŠ—æ—¥æˆ˜äº‰æ—¶æœŸï¼Œæœ‰ä¸­åæ°‘æ—å’Œå¸å›½ä¸»ä¹‰çš„æ°‘æ—çŸ›ç›¾ï¼Œæœ‰å›½å†…çš„é˜¶çº§çŸ›ç›¾ï¼Œæœ‰å›½æ°‘å…šå†…éƒ¨çš„æ´¾ç³»çŸ›ç›¾ç­‰ç­‰ï¼Œå“ªä¸ªæ˜¯ä¸»è¦çŸ›ç›¾ï¼Ÿæ¯«æ— ç–‘é—®ï¼Œæ˜¯æ°‘æ—çŸ›ç›¾ï¼Œå¦‚æœè¿™ä¸ªé—®é¢˜ä¸è§£å†³ï¼Œå…¶ä»–çŸ›ç›¾æ— ä»è°ˆèµ·ã€‚è¿™å°±æ˜¯æˆ˜ç•¥æ€ç»´ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬åˆæ­¥å°è¯• 0-1 åˆ›ä¸šçš„å‡ºæµ·ä¸šåŠ¡æ¥è¯´ï¼Œé¢ä¸´æ— æ•°é—®é¢˜ï¼Œæœ‰äººè¯´ Reddit éå¸¸é‡è¦ï¼Œæœ‰äººè¯´å¿…é¡»è¦åš Twitterï¼Œæœ‰äººè¯´åº”è¯¥å»ç¾å›½å¼€ä¸ªå…¬å¸ï¼Œæœ‰äººè¯´éœ€è¦åŠä¸ªæ¸¯å¡...</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå°±è¦æƒ³æ¸…æ¥šä»€ä¹ˆæ˜¯ä¸»è¦çŸ›ç›¾ï¼Œ0-1 é˜¶æ®µæ˜¯ç”Ÿå­˜é˜¶æ®µï¼Œæ‰€æœ‰å…¶ä»–äººçš„å»ºè®®å’Œç»éªŒéƒ½æ˜¯å¤–åœ¨è¡¨è±¡ï¼Œ0-1 è¦è€ƒè™‘çš„é¦–è¦é—®é¢˜æ˜¯ç”Ÿå­˜é—®é¢˜ï¼Œæ˜¯ PMF çš„é—®é¢˜ï¼Œæ˜¯èƒ½ä¸èƒ½æ´»ä¸‹å»çš„é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥æƒ³é€šäº†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠç›®æ ‡å®šä¸º 3 ä¸ªæœˆèµšåˆ°åƒåˆ€ï¼Œé‚£ä¹ˆä»¥ä¸Šæåˆ°çš„æ‰€æœ‰äº‹æƒ…éƒ½æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œå¹¶ä¸æ˜¯å…³é”®å› ç´ ã€‚é‚£æˆ‘ä»¬éœ€è¦ä»ç»“æœåæ¨ï¼Œå¦‚ä½•è¾¾æˆç›®æ ‡ï¼Ÿæ‰€æœ‰èƒ½æƒ³åˆ°çš„å…³é”®å› ç´ å°±æ˜¯ä¸»è¦çŸ›ç›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8f50f5a61ce4baa8245fbfb01b250d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=W%2B%2B3%2F7cpYLXEnvqYby%2Bn0O1nBvU%3D" alt="" loading="lazy"/></p>
<p>å›¢é˜Ÿç»è¿‡ AARRR æ¨¡å‹çš„åå¤æ¨æ¼”ï¼Œå°±å¯ä»¥å¾—å‡ºåœ¨ 0-1 é˜¶æ®µæœ€é‡è¦çš„åŠ¨ä½œï¼Œå®é™…ä¸Šå¯ä»¥å½’çº³ä¸ºä¸¤ä¸ªï¼šå¸‚åœº+æ•ˆç‡ã€‚åªè¦æˆ‘ä»¬é€‰å¯¹å¸‚åœºï¼ŒæŠŠæ•ˆç‡æœ€å¤§åŒ–ï¼Œåˆ©ç”¨ AI ç¼–ç¨‹çš„æ æ†ä¸Š 100 ä¸ªç«™ï¼Œç†è®ºä¸Šæœ€æœ‰å¯èƒ½è¾¾åˆ°ç›®æ ‡ã€‚</p>
<p>è¿™æ ·ä¸€æ‹†è§£ï¼Œå°±ååˆ†æ¸…æ™°äº†ï¼Œä¸»è¦åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æå‡å¸‚åœºæ´å¯ŸåŠ›ï¼Œä¸€ä¸ªæ˜¯æå‡ AI ç¼–ç¨‹æ•ˆç‡ï¼Œä»¥é‡å˜äº§ç”Ÿè´¨å˜æ˜¯æ ¸å¿ƒçš„æˆ˜ç•¥ã€‚å½“ç„¶è‚¯å®šä¹Ÿä¸æ˜¯ç›²ç›®ä¸Šç«™ï¼Œå¿…ç„¶æ˜¯è¦ç»è¿‡ä¸æ–­å¤ç›˜æ‰èƒ½å¤Ÿæˆé•¿ï¼Œé‚£ä¹ˆç»†è‡´çš„ SOP ä¹Ÿå°±å‡ºæ¥äº†ï¼Œåªè¦ä¸æ–­æ‰§è¡Œï¼šæ‰¾éœ€æ±‚-åšéœ€æ±‚-è¿è¥å¤–é“¾-å¤ç›˜ï¼Œè¿™ä¸ªé—­ç¯åå¤åšï¼Œå°±å¯ä»¥è¾¾æˆç›®æ ‡ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼ŒæŠ“ä½ä¸»è¦çŸ›ç›¾æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•è®ºï¼Œè¿™éœ€è¦æˆ‘ä»¬æœ‰ä¸€å®šçš„é¢†å¯¼æ„è¯†å’Œæˆ˜ç•¥æ„è¯†ï¼Œæ‰èƒ½æ‹¨å¼€è¿·é›¾ï¼Œçœ‹æ¸…äº‹æƒ…çš„æœ¬è´¨ï¼Œè¿™å’Œç¬¬ä¸€æ€§åŸç†æœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„ã€‚</p>
<h3 data-id="heading-3">04ï½œå¯¹ç«‹ç»Ÿä¸€ï¼šæŠŠåŠ£åŠ¿å½“å˜é‡ï¼Œè€Œä¸æ˜¯å®šè®º</h3>
<p>æ¯›é€‰çš„ç¬¬å››ä¸ªæ€æƒ³ï¼Œæ˜¯çŸ›ç›¾çš„å¯¹ç«‹ç»Ÿä¸€æ³•åˆ™ã€‚å…¶å®æˆ‘ä»¬ä¸­åä¼ ç»Ÿæ–‡åŒ–æ—©å°±å·²ç»äº§ç”Ÿæ™ºæ…§ï¼Œä¸­åº¸ä¹‹é“ï¼Œå¤ªæï¼Œéƒ½æ˜¯åœ¨è®²æˆ‘ä»¬ä¸èƒ½é™æ­¢ã€å­¤ç«‹ã€ç‰‡é¢åœ°çœ‹å¾…é—®é¢˜ï¼Œä»»ä½•çŸ›ç›¾çš„åŒæ–¹ï¼Œç›¸äº’æ’æ–¥ã€ç›¸äº’æ–—äº‰ï¼Œåˆç›¸äº’ä¾å­˜ï¼Œç›¸äº’è”ç»“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31102bc4b83c4b09955d35931785e049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=AR5zILQq%2FO6yLnbRIbR0hJQX4lk%3D" alt="" loading="lazy"/></p>
<p>æ‰€è°“é˜´é˜³æ—¢æ˜¯å¯¹ç«‹ï¼Œåˆæ˜¯ç»Ÿä¸€ï¼Œæ²¡æœ‰ç»å¯¹çš„å…‰èŠ’ï¼Œä¹Ÿæ²¡æœ‰ç»å¯¹çš„é»‘æš—ã€‚åœ¨å•†ä¸šå¸‚åœºä¸Šï¼Œä¹°æ–¹å¸Œæœ›åŠ ä¸ªè¶Šä½è¶Šå¥½ï¼Œå–æ–¹å¸Œæœ›ä»·æ ¼è¶Šé«˜è¶Šå¥½ï¼Œçœ‹ä¼¼å¯¹ç«‹ï¼Œåˆå¿…é¡»ç›¸äº’ä¾å­˜ï¼Œæ‰èƒ½å…±ç”Ÿã€‚</p>
<p>è¿™æ˜¯ä¸€ç§å“²å­¦æ€æƒ³ï¼Œåˆæ˜¯æˆ‘ä»¬çœ‹å¾…é—®é¢˜çš„é«˜åº¦ï¼Œè§£å†³çŸ›ç›¾çš„ç›®çš„ä¸æ˜¯ä¸ºäº†æ¶ˆç­æŸä¸€æ–¹ï¼Œè€Œæ˜¯è¦åŒæ–¹åœ¨ä¸€ä¸ªæ›´é«˜çš„æ°´å¹³ä¸Šè¾¾æˆæ–°çš„å¹³è¡¡ã€‚</p>
<p>ä»å‡ºæµ·åˆ›ä¸šçš„è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬çš„ä¼˜åŠ¿åŠ£åŠ¿æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¯¹ç«‹ç»Ÿä¸€ä½“ï¼Œåœ¨å¸‚åœºä¸Šï¼Œæˆ‘ä»¬è·Ÿå¤§å…¬å¸ç«äº‰ï¼Œåœ¨å¾ˆå¤šæ–¹é¢éƒ½å¤„äºåŠ£åŠ¿ï¼Œä½†ç›¸å¯¹æ¥è¯´ï¼ŒåŠ£åŠ¿ä¹Ÿæ˜¯ä¼˜åŠ¿ï¼Œæ‰€è°“â€œèˆ¹å°å¥½è°ƒå¤´â€ï¼Œå†³ç­–æµç¨‹ã€æ‰§è¡ŒåŠ›ã€å¸‚åœºååº”çµæ´»ï¼Œè¿™å°±æ˜¯åŠ£åŠ¿ä¸­çš„æœ‰åˆ©æ¡ä»¶ã€‚</p>
<p>å…¶å®ï¼Œæˆ‘ä»¬åˆ›ä¸šçš„å¤±è´¥å’ŒæˆåŠŸä¹Ÿæ˜¯ä¸€ä¸ªå¯¹ç«‹ç»Ÿä¸€çš„å…³ç³»ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šäº’è”ç½‘åˆ›ä¸šæˆåŠŸçš„å¤§ä½¬ï¼Œéƒ½æ˜¯è¿ç»­åˆ›ä¸šè€…ï¼Œå±¡è´¥å±¡æˆ˜ï¼Œå¤±è´¥å¹¶ä¸æ˜¯ä¸€ä¸ªå¯æ€•çš„äº‹æƒ…ï¼Œå…³é”®åœ¨äºæˆ‘ä»¬èƒ½å¦åœ¨åˆ›ä¸šå¤±è´¥ä¸­è¿›è¡Œå¤ç›˜ï¼Œå¸å–æ•™è®­ï¼Œä¸œå±±å†èµ·ã€‚</p>
<h3 data-id="heading-4">05ï½œã€Šè®ºæŒä¹…æˆ˜ã€‹ï¼šä»¥æ—¶é—´æ¢ç©ºé—´ï¼Œåœ¨æ­£ç¡®æˆ˜åœºé•¿æœŸç§¯ç´¯</h3>
<p>æ¯›é€‰çš„ç¬¬äº”ä¸ªæ€æƒ³æ˜¯ã€Šè®ºæŒä¹…æˆ˜ã€‹ï¼Œè¿™æ˜¯ä¸€éƒ¨ä¼Ÿå¤§çš„è‘—ä½œï¼Œå®ƒæ­ç¤ºäº†ä»¥å¼±èƒœå¼ºçš„åº•å±‚é€»è¾‘ï¼Œä¸ºæ‰€æœ‰åŠ£åŠ¿åœ°ä½çš„å¥‹æ–—è€…æä¾›äº†ä¸€éƒ¨æˆ˜ç•¥å®å…¸ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1326779d6e84c5fb22496c3a510b4b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=5Cwww%2BPTpxWILJmDklAmV684KB0%3D" alt="" loading="lazy"/></p>
<p>å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œåå¯¹é€Ÿèƒœè®ºå’Œäº¡å›½è®ºçš„æ‚²è§‚ï¼Œä¸»å¼ åœ¨å®¢è§‚è®¤è¯†æ•Œæˆ‘ä¼˜åŠ£çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å‘æŒ¥ä¸»è§‚èƒ½åŠ¨æ€§ï¼Œæ‰“ä¸€åœºæœ‰è®¡åˆ’ã€æœ‰æ­¥éª¤ï¼Œä»¥æ—¶é—´æ¢ç©ºé—´çš„æŒä¹…æˆ˜ã€‚</p>
<p>è¿™ä¸ªç»“è®ºéœ€è¦æ¸…é†’åœ°è®¤è¯†ï¼Œé€Ÿèƒœæ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºæ•Œå¼ºæˆ‘å¼±ã€‚äº¡å›½ä¹Ÿæ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºæ•Œå°æˆ‘å¤§ï¼Œæ•Œé€€æ­¥æˆ‘è¿›æ­¥ï¼Œæ•Œå¯¡åŠ©æˆ‘å¤šåŠ©ï¼Œè¿™å¥ å®šäº†æœ€åšå®çš„è®¤çŸ¥åŸºç¡€ã€‚</p>
<p>è¿™ä¸ªæ€ç»´æ¨¡å‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå½“é¢å¯¹ä¸€ä¸ªå¼ºå¤§çš„å¯¹æ‰‹æ—¶ï¼Œä¸è¦è¢«å…¶è¡¨é¢çš„å¼ºå¤§æ‰€å“åˆ°ï¼Œä¹Ÿä¸è¦è¢«è‡ªå·±çš„å¼±å°æ‰€è¿·æƒ‘ã€‚å¿…é¡»éå¸¸æ·±å…¥çš„åˆ†æï¼Œå¯¹æ–¹çš„å¼ºå¤§èƒŒåï¼Œæœ‰å“ªäº›å›ºæœ‰çš„ã€éš¾ä»¥å…‹æœçš„å¼±ç‚¹ï¼Ÿè‡ªèº«çš„å¼±å°ä¹‹ä¸­ï¼Œè•´å«ç€å“ªäº›å¯ä»¥è¢«åˆ©ç”¨ã€å†³å®šæœªæ¥çš„ä¼˜åŠ¿ï¼Ÿ</p>
<p>å¯¹äºå‡ºæµ·åˆ›ä¸šæ¥è¯´ï¼ŒæŒä¹…æˆ˜çš„æ€æƒ³å°¤ä¸ºé‡è¦ã€‚æˆ‘ä»¬ä¸ªä½“åˆ›ä¸šï¼Œå¤©ç„¶åœ¨æŸäº›æ–¹é¢å­˜åœ¨åŠ£åŠ¿ï¼Œå¦‚æœä½ å»åœ¨ä¸»æˆ˜åœºä¸å·¨å¤´è¯æ˜ç¡¬åˆšï¼Œæ— å¼‚äºä»¥åµå‡»çŸ³ã€‚</p>
<p>æˆ‘ä»¬ç›®å‰çœ‹å‡ºæµ·çš„ç»†åˆ†å¸‚åœºï¼Œå®é™…ä¸Šæ­£æ˜¯â€œå·¨å¤´çœ‹ä¸ä¸Šâ€çš„è¾¹ç¼˜å¸‚åœºï¼Œä½†æ˜¯è¿™ä¸ªå¸‚åœºçš„è›‹ç³•è¶³å¤Ÿå¤§ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡çµæ´»çš„ä¼˜åŠ¿ï¼Œå¿«é€ŸæŠ¢å è¿™ä¸ªå¸‚åœºã€‚</p>
<p>æ‰€è°“â€œæ–°è¯â€çš„é€»è¾‘ï¼Œå°±æ˜¯ä»¥æ—¶é—´å’Œæ•ˆç‡ä¼˜åŠ¿ï¼Œå¿«é€ŸæŠ¢å æ–°çš„å¸‚åœºï¼ŒæŠ¢å è°·æ­Œæ¯å¤© 15%çš„æ–°æ£€ç´¢ç®—åŠ›ï¼Œä»è€Œæ„å»ºäº†å®ƒçš„å•†ä¸šæ¨¡å¼ã€‚</p>
<p>æ‰€è°“â€œé•¿å°¾è¯â€çš„é€»è¾‘ï¼Œå°±æ˜¯å†œæ‘åŒ…å›´åŸå¸‚æˆ˜ç•¥ï¼Œä»¥å°åšå¤§ï¼Œé€šè¿‡ç»†åˆ†å‚ç›´éœ€æ±‚å…³é”®è¯åŸŸåï¼Œé€æ­¥å é¢†é•¿å°¾è¯å¸‚åœºï¼Œç§¯å°‘æˆå¤šï¼Œä»¥å°åšå¤§ï¼Œåœ¨æŒä¹…æˆ˜ä¸­èƒ½å¤Ÿè¶…è¶Šç«äº‰å¯¹æ‰‹ã€‚</p>
<p>è¿™ä¸ªæˆ˜ç•¥ï¼Œæ›´è€ƒéªŒæˆ˜ç•¥å®šåŠ›å’Œæ‰§è¡Œçš„åšéŸ§ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„è€å¿ƒå’ŒåšæŒã€‚æ‰€ä»¥æˆ‘å¸¸å¸¸è¯´ï¼Œåˆ›ä¸šä¸æ˜¯ä¸€èˆ¬äººèƒ½å¤Ÿåšçš„ï¼Œå› ä¸ºå¤§å¤šæ•°äººåªæƒ³èµšå¿«é’±ï¼Œåªæƒ³ä¸€å¤œæš´å¯Œï¼Œå¾ˆéš¾æŒä¹…åœ°å»åšä¸€ä»¶äº‹ã€‚</p>
<p>æˆ‘ä»¬åšåˆ›ä¸šï¼Œéœ€è¦è„šè¸å®åœ°ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œå°†ç›®æ ‡æ‹†è§£ï¼Œè¸è¸å®å®åœ°èµ°å¥½æ¯ä¸€æ­¥ã€‚åœ¨å›°éš¾çš„æ—¶å€™ï¼Œæœ‰åšæŒä¸‹å»çš„å‹‡æ°”å’Œæ–¹æ³•ï¼Œåœ¨é¡ºåˆ©çš„æ—¶å€™ï¼Œä¿æŒæ¸…é†’å’Œè°¦é€Šã€‚</p>
<h3 data-id="heading-5">06ï½œä»ç¾¤ä¼—ä¸­æ¥ï¼Œåˆ°ç¾¤ä¼—ä¸­å»ï¼šç”¨ MVP + åé¦ˆé—­ç¯é€¼è¿‘çœŸç›¸</h3>
<p>æ¯›é€‰çš„ç¬¬å…­ä¸ªæ€æƒ³ï¼Œæ˜¯ä»ç¾¤ä¼—ä¸­æ¥ï¼Œåˆ°ç¾¤ä¼—ä¸­å»ã€‚æˆ‘ä»¬åšäº§å“ï¼Œå¯¹è¿™ä¸ªä½“ä¼šå¯èƒ½ä¼šæ›´åŠ æ·±åˆ»ï¼Œè¿™é‡Œçš„â€œç¾¤ä¼—â€å°±æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·ã€‚æ‰€æœ‰çš„éœ€æ±‚ï¼Œä¸€å®šä¸èƒ½æ˜¯å‡­è„‘è¢‹ç©ºæƒ³å‡ºæ¥çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28b6bc6b29e948db95dd8551d3a7f26d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766498621&amp;x-signature=t2%2FSA3UJ7rbp4VCIWPE1gf%2FWi9g%3D" alt="" loading="lazy"/></p>
<p>å…¶å®åœ¨ç²¾ç›Šåˆ›ä¸šä¸­ï¼Œæœ‰å¾ˆå¤§çš„ç¯‡å¹…æ˜¯ä»‹ç»äº†æˆ‘ä»¬åº”è¯¥æ€æ ·è¿›è¡Œç”¨æˆ·ç ”ç©¶ï¼Œç”¨æˆ·è®¿è°ˆï¼Œä»è€Œæç‚¼å‡ºçœŸæ­£çš„éœ€æ±‚ã€‚å¯¹äºå‡ºæµ·ä¸šåŠ¡ï¼Œç”¨æˆ·è®¿è°ˆå¯èƒ½æ˜¯ä¸€ä¸ªéš¾é¢˜ï¼Œè¿™å°±æ›´éœ€è¦æˆ‘ä»¬æ‹¥æœ‰äº§å“ Senseã€‚</p>
<p>SEO ç›¸å¯¹æ¥è¯´å°±æ˜¯ä¸€ä¸ªç§‘å­¦çš„æ–¹æ³•è®ºï¼Œé€šè¿‡å…³é”®è¯çš„åˆ†æï¼Œæ¥æ‹†è§£ç”¨æˆ·èƒŒåçš„è¯‰æ±‚ï¼Œè‡³å°‘è¿™ä¸ª idea ä¸æ˜¯å‡­ç©ºåˆ›é€ å‡ºæ¥çš„ï¼Œå®ƒæ˜¯çœŸæ­£çš„ç”¨æˆ·éœ€æ±‚ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å‡­å€Ÿè‡ªå·±çš„è°ƒç ”ï¼Œå¯¹äº Serp ç«™ç‚¹çš„æ·±å…¥ä½“éªŒå’Œæ€è€ƒåˆ†æï¼Œç¡®å®šç”¨æˆ·çš„å®é™…éœ€æ±‚ï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯ä»ç¾¤ä¼—ä¸­æ¥ã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å®éªŒçš„æ–¹å¼ï¼Œåšå‡ºäº§å“è¿›è¡Œå¸‚åœºéªŒè¯ï¼Œå°±æ˜¯æ‰€è°“çš„â€œåˆ°ç¾¤ä¼—ä¸­å»â€ã€‚</p>
<p>ä¸€æ—¦æˆ‘ä»¬çš„ MVP äº§å“æœ‰äº†åˆå§‹ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‚®ä»¶çš„æ–¹å¼æ”¶åˆ°ç”¨æˆ·åé¦ˆï¼Œäº¦æˆ–æ˜¯è¯„ä»·ã€è¯„è®ºçš„æ–¹å¼ï¼Œä»å¤šæ–¹é¢æ”¶é›†ç”¨æˆ·è¯‰æ±‚ï¼Œè¿™æ ·å°±å½¢æˆäº†æ¯ä¸€æ¬¡äº§å“çš„è¿­ä»£ä¼˜åŒ–ï¼Œéšç€æ¯ä¸€æ¬¡çš„è¿­ä»£ï¼Œæˆ‘ä»¬å°±æ·±åŒ–äº§å“è®¤çŸ¥ï¼Œå†³ç­–å®Œå–„ä¸€æ­¥ã€‚</p>
<p>è¿™ä¸ªé—­ç¯å°±æ˜¯ï¼š**å®è·µã€è®¤çŸ¥ã€å†å®è·µã€å†è®¤çŸ¥ã€‚**ä½ ä¸å¯èƒ½åœ¨è¡ŒåŠ¨ä¹‹å‰å°±æŒæ¡å…¨éƒ¨çœŸç†ï¼Œå¾ˆå¤šäº‹æƒ…åªæœ‰å»åšäº†ï¼Œæ‰èƒ½çœŸæ­£æ˜ç™½ã€‚æ‰€ä»¥ï¼Œè¦æ•¢äºå®è·µï¼Œæ•¢äºè¯•é”™ã€‚</p>
<h3 data-id="heading-6">å†™åœ¨æœ€åï¼šæŠŠæ–¹æ³•è®ºå˜æˆä½ çš„è¡ŒåŠ¨æ¸…å•</h3>
<p>å›åˆ°å¼€å¤´é‚£ä¸ªé—®é¢˜ï¼šåˆ›ä¸šæœ‰æ²¡æœ‰ä¸€å¥—åº•å±‚æ€ç»´ï¼Ÿ</p>
<p>æˆ‘çš„ç­”æ¡ˆæ˜¯ï¼šæœ‰ã€‚è‡³å°‘å¯¹æˆ‘è€Œè¨€ï¼Œã€Šæ¯›é€‰ã€‹ç»™äº†æˆ‘ä¸€å¥—éå¸¸å¼ºçš„â€œé—®é¢˜è§£å†³æ¡†æ¶â€ï¼š</p>
<ul>
<li>
<p><strong>å®äº‹æ±‚æ˜¯</strong>ï¼šç”¨è°ƒæŸ¥ç ”ç©¶ææ¸…æ¥šäº‹å®</p>
</li>
<li>
<p><strong>é˜¶çº§åˆ†æ</strong>ï¼šç”¨åˆ©ç›Šåœ°å›¾å†³å®šåˆä½œä¸ç«äº‰</p>
</li>
<li>
<p><strong>ä¸»è¦çŸ›ç›¾</strong>ï¼šæŠŠä¸»è¦ç²¾åŠ›æŠ•å…¥åˆ°â€œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«â€çš„å…³é”®é—®é¢˜</p>
</li>
<li>
<p><strong>å¯¹ç«‹ç»Ÿä¸€</strong>ï¼šè¾©è¯çœ‹åˆ©å¼Šï¼ŒæŠŠä¸åˆ©å› ç´ è½¬åŒ–ä¸ºæœ‰åˆ©æ¡ä»¶</p>
</li>
<li>
<p><strong>æŒä¹…æˆ˜</strong>ï¼šé•¿æœŸåšæŒï¼Œæœ‰ç›®æ ‡ã€æœ‰é˜¶æ®µã€è„šè¸å®åœ°</p>
</li>
<li>
<p><strong>ä»ç¾¤ä¼—ä¸­æ¥ï¼Œåˆ°ç¾¤ä¼—ä¸­å»</strong>ï¼šç”¨ MVP æœ€å¿«è·å¾—åé¦ˆï¼Œä¸æ–­è¯•é”™ä¸å¤ç›˜</p>
</li>
</ul>
<p>å¦‚æœä½ æ„¿æ„ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘Šè¯‰æˆ‘ï¼šä½ å½“ä¸‹å‡ºæµ·/åˆ›ä¸šçš„<strong>ä¸»è¦çŸ›ç›¾</strong>æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å¥½äº†ï¼Œä»Šå¤©å°±åˆ†äº«åˆ°è¿™é‡Œã€‚å’±ä»¬ä¸‹æœŸå†è§ï¼</p>
<hr/>
<p>ğŸš€ æƒ³è¦ä¸æ›´å¤šAIçˆ±å¥½è€…äº¤æµï¼Œå…±åŒæˆé•¿å—ï¼Ÿ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ4k_5_waWJbRRo5lZBZmog" target="_blank" title="https://mp.weixin.qq.com/s/Z4k_5_waWJbRRo5lZBZmog" ref="nofollow noopener noreferrer">å’Œä¸€ç¾¤å¿—åŒé“åˆçš„äººï¼ŒæŒç»­ç²¾è¿› AI çš„æ¯ä¸€å¤©</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“æ—¶åºæ•°æ®ä¸å†â€œåªæ˜¯æ—¶é—´â€ï¼šé‡‘ä»“æ•°æ®åº“å¦‚ä½•åœ¨å¤æ‚åœºæ™¯ä¸­æ‹‰å¼€ä¸ InfluxDB çš„å·®è·]]></title>    <link>https://juejin.cn/post/7584287969214791699</link>    <guid>https://juejin.cn/post/7584287969214791699</guid>    <pubDate>2025-12-16T14:28:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584287969214791699" data-draft-id="7584307643000307755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“æ—¶åºæ•°æ®ä¸å†â€œåªæ˜¯æ—¶é—´â€ï¼šé‡‘ä»“æ•°æ®åº“å¦‚ä½•åœ¨å¤æ‚åœºæ™¯ä¸­æ‹‰å¼€ä¸ InfluxDB çš„å·®è·"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T14:28:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯æ°å°¼"/> <meta itemprop="url" content="https://juejin.cn/user/4200579899599495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“æ—¶åºæ•°æ®ä¸å†â€œåªæ˜¯æ—¶é—´â€ï¼šé‡‘ä»“æ•°æ®åº“å¦‚ä½•åœ¨å¤æ‚åœºæ™¯ä¸­æ‹‰å¼€ä¸ InfluxDB çš„å·®è·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4200579899599495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯æ°å°¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T14:28:37.000Z" title="Tue Dec 16 2025 14:28:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å½“æ—¶åºæ•°æ®ä¸å†â€œåªæ˜¯æ—¶é—´â€ï¼šé‡‘ä»“æ•°æ®åº“å¦‚ä½•åœ¨å¤æ‚åœºæ™¯ä¸­æ‹‰å¼€ä¸ InfluxDB çš„å·®è·</h2>
<h3 data-id="heading-1">ä¸€ã€æ—¶åºæ•°æ®åº“çš„â€œç¬¬äºŒé˜¶æ®µâ€å·²ç»åˆ°æ¥</h3>
<p>åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œæ—¶åºæ•°æ®åº“çš„æ ¸å¿ƒé—®é¢˜åªæœ‰ä¸€ä¸ªï¼š
<strong>å¦‚ä½•é«˜æ•ˆå­˜å‚¨æŒ‰æ—¶é—´ä¸æ–­å¢é•¿çš„æ•°æ®ç‚¹ï¼Ÿ</strong></p>
<p>InfluxDB æ­£æ˜¯åœ¨è¿™ä¸€é˜¶æ®µè„±é¢–è€Œå‡ºçš„ä»£è¡¨äº§å“ã€‚å…¶ä¸“é—¨ä¸ºæ—¶é—´åºåˆ—è®¾è®¡çš„å­˜å‚¨æ¨¡å‹ã€ç®€æ´çš„å†™å…¥æ¥å£ä»¥åŠè‰¯å¥½çš„åˆæœŸæ€§èƒ½ï¼Œä½¿å…¶åœ¨ç›‘æ§å’Œç‰©è”ç½‘é¢†åŸŸè¢«å¤§é‡é‡‡ç”¨ã€‚</p>
<p>ä½†éšç€ä¸šåŠ¡ç³»ç»Ÿé€æ¸æˆç†Ÿï¼Œä¼ä¸šå¯¹æ—¶åºæ•°æ®çš„è¯‰æ±‚æ­£åœ¨å‘ç”Ÿå˜åŒ–ï¼š</p>
<ul>
<li>æ•°æ®é‡ä¸å†æ˜¯ç™¾ä¸‡ã€åƒä¸‡ï¼Œè€Œæ˜¯<strong>æŒç»­å¢é•¿çš„ç™¾äº¿çº§</strong></li>
<li>æŸ¥è¯¢ä¸å†åªæ˜¯ç”»å›¾ï¼Œè€Œæ˜¯<strong>å®æ—¶åˆ†æã€å¼‚å¸¸å®šä½ã€æ™ºèƒ½å†³ç­–</strong></li>
<li>æ—¶åºæ•°æ®ä¸å†ç‹¬ç«‹å­˜åœ¨ï¼Œè€Œæ˜¯è¦ä¸<strong>ä¸šåŠ¡æ•°æ®ã€è®¾å¤‡æ•°æ®ã€ç©ºé—´ä¿¡æ¯</strong>ç»“åˆ</li>
</ul>
<p>è¿™æ„å‘³ç€ï¼Œæ—¶åºæ•°æ®åº“æ­£åœ¨è¿›å…¥ä¸€ä¸ªæ–°çš„é˜¶æ®µâ€”â€”
<strong>ä»â€œä¸“ç”¨å­˜å‚¨å·¥å…·â€å‘â€œæ ¸å¿ƒæ•°æ®èƒ½åŠ›â€çš„è½¬å˜ã€‚</strong></p>
<p>ä¹Ÿæ­£æ˜¯åœ¨è¿™ä¸€é˜¶æ®µï¼Œé‡‘ä»“æ•°æ®åº“ï¼ˆKingbaseESï¼‰ä¸ InfluxDB çš„å·®è·å¼€å§‹è¢«ä¸æ–­æ”¾å¤§ã€‚</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6bdfa05de7c446491c79ba14269cdd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766500117&amp;x-signature=gu2xDu4i1y8OZDe8RJ%2FqqBVovoU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-2">äºŒã€å†™å…¥ä¸æ˜¯ç»ˆç‚¹ï¼šé«˜å¹¶å‘ä¹‹ä¸‹çš„å¯æŒç»­èƒ½åŠ›</h3>
<p>å†™å…¥æ€§èƒ½ï¼Œå¾€å¾€æ˜¯è¯„ä»·æ—¶åºæ•°æ®åº“çš„ç¬¬ä¸€æŒ‡æ ‡ã€‚ä½†çœŸæ­£é‡è¦çš„ï¼Œå¹¶ä¸æ˜¯â€œå•æ¬¡è·‘åˆ†æœ‰å¤šé«˜â€ï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p>åœ¨è®¾å¤‡è§„æ¨¡ä¸æ–­æ‰©å¤§ã€å†™å…¥é•¿æœŸæŒç»­çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿæ˜¯å¦è¿˜èƒ½ç¨³å®šã€é«˜æ•ˆåœ°è¿è¡Œï¼Ÿ</p>
</blockquote>
<p>åœ¨åŸºäº TSBS çš„æµ‹è¯•ä¸­ï¼Œæ¨¡æ‹Ÿäº†ä»å°è§„æ¨¡è®¾å¤‡åˆ°åƒä¸‡çº§è®¾å¤‡çš„æŒç»­å†™å…¥å‹åŠ›ã€‚æµ‹è¯•ç»“æœå‘ˆç°å‡ºä¸€ä¸ªéå¸¸æ¸…æ™°çš„è¶‹åŠ¿ï¼š</p>
<ul>
<li>åœ¨å°è§„æ¨¡å†™å…¥åœºæ™¯ä¸‹ï¼Œä¸¤è€…æ€§èƒ½æ¥è¿‘</li>
<li>éšç€è®¾å¤‡æ•°é‡å’ŒæŒ‡æ ‡æ•°é‡å¢é•¿ï¼Œé‡‘ä»“çš„å†™å…¥ååä¼˜åŠ¿é€æ­¥æ˜¾ç°</li>
<li>åœ¨åƒä¸‡çº§è®¾å¤‡å‹åŠ›ä¸‹ï¼Œé‡‘ä»“çš„å†™å…¥æ€§èƒ½è¾¾åˆ° InfluxDB çš„ <strong>2 å€ä»¥ä¸Š</strong></li>
</ul>
<p>è¿™èƒŒååæ˜ çš„ï¼Œå¹¶ä¸æ˜¯ç®€å•çš„â€œå†™å¾—å¿«â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>å¹¶å‘è°ƒåº¦èƒ½åŠ›</li>
<li>å­˜å‚¨ç»“æ„å¯¹é«˜åŸºæ•°æ•°æ®çš„é€‚åº”æ€§</li>
<li>åˆ†åŒºä¸ç´¢å¼•ç­–ç•¥çš„å¯æ‰©å±•æ€§</li>
</ul>
<p>åœ¨çœŸå®ç”Ÿäº§ç³»ç»Ÿä¸­ï¼Œè¿™äº›å› ç´ å¾€å¾€æ¯”å•æ¬¡å†™å…¥å»¶è¿Ÿæ›´é‡è¦ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€çœŸæ­£å†³å®šä¸Šé™çš„ï¼Œæ˜¯å¤æ‚æŸ¥è¯¢èƒ½åŠ›</h3>
<p>å¦‚æœè¯´å†™å…¥èƒ½åŠ›å†³å®šç³»ç»Ÿèƒ½å¦â€œæ´»ä¸‹æ¥â€ï¼Œé‚£ä¹ˆæŸ¥è¯¢èƒ½åŠ›å†³å®šçš„ï¼Œå°±æ˜¯ç³»ç»Ÿæ˜¯å¦â€œæœ‰ä»·å€¼â€ã€‚</p>
<p>åœ¨å¤§é‡ä¼ä¸šå®è·µä¸­ï¼Œæ—¶åºæŸ¥è¯¢å¾€å¾€ä¼šç»å†ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>åŸºç¡€æŸ¥è¯¢</strong>ï¼šå•æŒ‡æ ‡ã€çŸ­æ—¶é—´çª—å£</li>
<li><strong>åˆ†ææŸ¥è¯¢</strong>ï¼šå¤šè®¾å¤‡ã€å¤šæŒ‡æ ‡ã€åˆ†ç»„èšåˆ</li>
<li><strong>ä¸šåŠ¡æŸ¥è¯¢</strong>ï¼šæœ€æ–°çŠ¶æ€ã€å¼‚å¸¸ç­›é€‰ã€è·¨ç»´åº¦åˆ†æ</li>
</ol>
<h4 data-id="heading-4">1. ç®€å•æŸ¥è¯¢é˜¶æ®µï¼šå·®è·ä¸æ˜æ˜¾</h4>
<p>åœ¨å•è®¾å¤‡ã€å•æŒ‡æ ‡çš„èšåˆæŸ¥è¯¢ä¸­ï¼Œé‡‘ä»“ä¸ InfluxDB çš„æ€§èƒ½éƒ½èƒ½ä¿æŒåœ¨æ¯«ç§’çº§ï¼Œæ•´ä½“ä½“éªŒå·®è·æœ‰é™ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯å¾ˆå¤šå›¢é˜Ÿåœ¨æ—©æœŸä½¿ç”¨ InfluxDB æ—¶æ„Ÿè§‰â€œæ€§èƒ½å¾ˆå¥½â€çš„åŸå› ã€‚</p>
<hr/>
<h4 data-id="heading-5">2. åˆ†ææŸ¥è¯¢é˜¶æ®µï¼šä¼˜åŠ¿å¼€å§‹æ˜¾ç°</h4>
<p>å½“æŸ¥è¯¢æ¶‰åŠå¤šè®¾å¤‡ã€å¤šæŒ‡æ ‡ï¼Œå¹¶ä¸”éœ€è¦è¿›è¡Œåˆ†ç»„ç»Ÿè®¡æ—¶ï¼Œé‡‘ä»“çš„ä¼˜åŠ¿é€æ­¥ä½“ç°ã€‚</p>
<p>åœ¨å…¸å‹çš„â€œå¤šè®¾å¤‡å¤šæŒ‡æ ‡ä¸€å°æ—¶ç»Ÿè®¡â€æµ‹è¯•ä¸­ï¼š</p>
<ul>
<li>é‡‘ä»“çš„å“åº”é€Ÿåº¦é€šå¸¸ä¸º InfluxDB çš„ <strong>3ï½4 å€</strong></li>
<li>éšç€æ—¶é—´çª—å£æ‹‰é•¿ï¼Œè¿™ä¸€å·®è·ä»èƒ½ä¿æŒç¨³å®š</li>
</ul>
<p>è¿™è¯´æ˜ï¼Œåœ¨æ•°æ®é‡å’Œè®¡ç®—å¤æ‚åº¦åŒæ—¶å¢é•¿çš„æƒ…å†µä¸‹ï¼Œé‡‘ä»“çš„æ‰§è¡Œè®¡åˆ’å’Œèµ„æºè°ƒåº¦æ›´åŠ é«˜æ•ˆã€‚</p>
<hr/>
<h4 data-id="heading-6">3. ä¸šåŠ¡çº§æŸ¥è¯¢ï¼šæ•°é‡çº§å·®è·çš„å‡ºç°</h4>
<p>åœ¨æœ€æ¥è¿‘çœŸå®ä¸šåŠ¡çš„æŸ¥è¯¢åœºæ™¯ä¸­ï¼Œä¸¤è€…çš„æ€§èƒ½å·®è·å‘ˆç°å‡ºæ•°é‡çº§æ”¾å¤§ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>Last Point æŸ¥è¯¢</strong>ï¼ˆè·å–æ¯ä¸ªè®¾å¤‡çš„æœ€æ–°æ•°æ®ï¼‰</li>
<li><strong>é˜ˆå€¼ç­›é€‰æŸ¥è¯¢</strong>ï¼ˆæ‰¾å‡ºæŸæ—¶é—´æ®µå†…è¶…é™çš„è®¾å¤‡ï¼‰</li>
<li><strong>çŠ¶æ€ç»Ÿè®¡æŸ¥è¯¢</strong>ï¼ˆæŒ‰è®¾å¤‡ç»´åº¦æ±‡æ€»è¿è¡ŒçŠ¶æ€ï¼‰</li>
</ul>
<p>åœ¨æµ‹è¯•ä¸­ï¼Œé¢å¯¹æ•°ç™¾å°è®¾å¤‡çš„æ•°æ®ï¼š</p>
<ul>
<li>é‡‘ä»“çš„æŸ¥è¯¢è€—æ—¶ç»´æŒåœ¨ç™¾æ¯«ç§’çº§</li>
<li>InfluxDB çš„æŸ¥è¯¢è€—æ—¶åˆ™å¯èƒ½è¾¾åˆ°æ•°ç§’ç”šè‡³åç§’ä»¥ä¸Š</li>
</ul>
<p>åœ¨éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œæ€§èƒ½å·®è·è¶…è¿‡ <strong>70 å€</strong>ã€‚</p>
<p>å¯¹äºå®æ—¶å‘Šè­¦ã€æ™ºèƒ½è°ƒåº¦å’Œè‡ªåŠ¨æ§åˆ¶ç³»ç»Ÿè€Œè¨€ï¼Œè¿™ç§å·®è·ç›´æ¥å†³å®šäº†ç³»ç»Ÿæ˜¯å¦â€œå¯ç”¨â€ã€‚</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45b0fe36c4864590bbed424ee0e6f87d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766500117&amp;x-signature=VV7PogJYf4LvlHAOATJEYUwZgV4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-7">å››ã€æ¶æ„å·®å¼‚ï¼šä¸ºä»€ä¹ˆ InfluxDB ä¼šåœ¨å¤æ‚åœºæ™¯ä¸­â€œåƒåŠ›â€</h3>
<p>ä»æ ¹æœ¬ä¸Šçœ‹ï¼Œè¿™ç§æ€§èƒ½å·®è·å¹¶éå¶ç„¶ï¼Œè€Œæ˜¯æ¶æ„è®¾è®¡ç›®æ ‡ä¸åŒæ‰€å¯¼è‡´çš„å¿…ç„¶ç»“æœã€‚</p>
<h4 data-id="heading-8">1. ä¸“ç”¨æ¨¡å‹ vs é€šç”¨æ‰§è¡Œå¼•æ“</h4>
<p>InfluxDB çš„è®¾è®¡åˆè¡·æ˜¯å›´ç»•æ—¶é—´åºåˆ—è¿›è¡Œé«˜åº¦ä¼˜åŒ–ï¼Œé€‚åˆæŒ‡æ ‡å‹æ•°æ®çš„å¿«é€Ÿå†™å…¥ä¸ç®€å•èšåˆã€‚</p>
<p>è€Œé‡‘ä»“çš„æ—¶åºèƒ½åŠ›ï¼Œæ„å»ºåœ¨æˆç†Ÿçš„å…³ç³»å‹æ•°æ®åº“å†…æ ¸ä¹‹ä¸Šï¼Œå…·å¤‡ï¼š</p>
<ul>
<li>å®Œæ•´çš„æŸ¥è¯¢ä¼˜åŒ–å™¨</li>
<li>å¤šç§ç´¢å¼•ä¸æ‰§è¡Œç­–ç•¥</li>
<li>æˆç†Ÿçš„å¹¶å‘æ§åˆ¶ä¸äº‹åŠ¡æœºåˆ¶</li>
</ul>
<p>å½“æŸ¥è¯¢é€»è¾‘å˜å¤æ‚æ—¶ï¼Œè¿™ç§é€šç”¨èƒ½åŠ›åè€Œæˆä¸ºä¼˜åŠ¿ã€‚</p>
<hr/>
<h4 data-id="heading-9">2. SQL ç”Ÿæ€å¸¦æ¥çš„é•¿æœŸæ”¶ç›Š</h4>
<p>é‡‘ä»“åŸç”Ÿæ”¯æŒæ ‡å‡† SQLï¼Œè¿™ä¸€ç‚¹åœ¨ä¼ä¸šçº§åœºæ™¯ä¸­æ„ä¹‰é‡å¤§ï¼š</p>
<ul>
<li>å¯ç›´æ¥å¤ç”¨ BIã€æŠ¥è¡¨ã€åˆ†æå·¥å…·</li>
<li>æ”¯æŒå¤æ‚å…³è”æŸ¥è¯¢ä¸å­æŸ¥è¯¢</li>
<li>ç»Ÿä¸€æŠ€æœ¯æ ˆï¼Œé™ä½å­¦ä¹ å’Œç»´æŠ¤æˆæœ¬</li>
</ul>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒInfluxDB çš„ä¸“ç”¨æŸ¥è¯¢è¯­è¨€åœ¨ç®€å•åœºæ™¯ä¸‹è¶³å¤Ÿé«˜æ•ˆï¼Œä½†åœ¨å¤æ‚åˆ†æå’Œç³»ç»Ÿé›†æˆä¸­ï¼Œå¾€å¾€éœ€è¦é¢å¤–çš„é€‚é…å’Œå¼€å‘å·¥ä½œã€‚</p>
<hr/>
<h3 data-id="heading-10">äº”ã€å­˜å‚¨ä¸æˆæœ¬ï¼šè¢«å¿½è§†ä½†æå…¶å…³é”®çš„ç»´åº¦</h3>
<p>åœ¨æµ·é‡æ—¶åºæ•°æ®åœºæ™¯ä¸­ï¼Œå­˜å‚¨æˆæœ¬å¾€å¾€æ˜¯é•¿æœŸè¿è¥ä¸­æœ€å¤§çš„éšæ€§æ”¯å‡ºã€‚</p>
<p>é‡‘ä»“åœ¨æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹é¢æä¾›äº†ï¼š</p>
<ul>
<li>è‡ªåŠ¨æ—¶é—´åˆ†åŒº</li>
<li>çµæ´»çš„æ•°æ®ä¿ç•™ç­–ç•¥</li>
<li>é«˜å‹ç¼©æ¯”çš„å†å²æ•°æ®å­˜å‚¨</li>
<li>å†·çƒ­æ•°æ®åˆ†çº§ç®¡ç†</li>
</ul>
<p>åœ¨å®é™…æµ‹è¯•ä¸­ï¼Œé’ˆå¯¹å·¥ä¸šä¼ æ„Ÿå™¨ç±»æ•°æ®ï¼Œé‡‘ä»“å¯å®ç° <strong>1:4 å·¦å³çš„å‹ç¼©æ¯”</strong>ï¼Œåœ¨æ•°æ®è§„æ¨¡æŒç»­å¢é•¿çš„æƒ…å†µä¸‹ï¼Œè¿™ç§ä¼˜åŠ¿ä¼šè¢«ä¸æ–­æ”¾å¤§ã€‚</p>
<hr/>
<h3 data-id="heading-11">å…­ã€ä»â€œæ—¶åºâ€åˆ°â€œèåˆâ€ï¼šä¸šåŠ¡ä»·å€¼çš„çœŸæ­£é‡Šæ”¾</h3>
<p>ä¼ä¸šçœŸæ­£å…³å¿ƒçš„ï¼Œå¹¶ä¸æ˜¯â€œæ—¶åºæ•°æ®æœ¬èº«â€ï¼Œè€Œæ˜¯å®ƒæ‰€æ‰¿è½½çš„ä¸šåŠ¡å«ä¹‰ã€‚</p>
<p>é‡‘ä»“æ”¯æŒåœ¨åŒä¸€æ•°æ®åº“å†…ï¼Œå¯¹ä»¥ä¸‹æ•°æ®è¿›è¡Œç»Ÿä¸€åˆ†æï¼š</p>
<ul>
<li>æ—¶åºæ•°æ®</li>
<li>è®¾å¤‡ä¸ä¸šåŠ¡ä¸»æ•°æ®</li>
<li>JSON æ–‡æ¡£å‹ä¿¡æ¯</li>
<li>ç©ºé—´åœ°ç†æ•°æ®</li>
</ul>
<p>è¿™ä½¿å¾—è®¸å¤šå¤æ‚åˆ†æåœºæ™¯å¾—ä»¥ç®€åŒ–ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>â€œç»Ÿè®¡è¿‡å»ä¸€å‘¨å†…ï¼ŒæŸåŒºåŸŸå†…è¿è¡Œå¼‚å¸¸çš„è®¾å¤‡æ•°é‡åŠåˆ†å¸ƒæƒ…å†µâ€</p>
</blockquote>
<p>åœ¨ InfluxDB ä¸­ï¼Œè¿™é€šå¸¸éœ€è¦å¤šç³»ç»Ÿåä½œå®Œæˆï¼›è€Œåœ¨é‡‘ä»“ä¸­ï¼Œä¸€æ¡ SQL å³å¯å®Œæˆã€‚</p>
<hr/>
<h3 data-id="heading-12">ä¸ƒã€ç»“è¯­ï¼šæ—¶åºæ•°æ®åº“ç«äº‰çš„çœŸæ­£åˆ†æ°´å²­</h3>
<p>InfluxDB åœ¨æ—¶åºæ•°æ®åº“å‘å±•æ—©æœŸï¼Œèµ·åˆ°äº†é‡è¦æ¨åŠ¨ä½œç”¨ã€‚ä½†éšç€ä¸šåŠ¡å¤æ‚åº¦å’Œæ•°æ®è§„æ¨¡çš„æŒç»­æå‡ï¼Œä¼ä¸šå¯¹æ•°æ®åº“çš„æœŸå¾…å·²ç»å‘ç”Ÿæ ¹æœ¬å˜åŒ–ã€‚</p>
<p>é‡‘ä»“æ•°æ®åº“æ‰€å±•ç°çš„ä¼˜åŠ¿ï¼Œå¹¶ä¸ä»…æ˜¯â€œè·‘å¾—æ›´å¿«â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>åœ¨å¤æ‚æŸ¥è¯¢ä¸‹ä¾ç„¶å¯æ§ã€ç¨³å®š</li>
<li>åœ¨ä¼ä¸šç”Ÿæ€ä¸­æ˜“äºèåˆ</li>
<li>åœ¨é•¿æœŸè¿è¥ä¸­æˆæœ¬å¯é¢„æœŸ</li>
</ul>
<p>å½“æ—¶åºæ•°æ®ä»â€œè®°å½•çŠ¶æ€â€èµ°å‘â€œé©±åŠ¨å†³ç­–â€ï¼Œæ•°æ®åº“çš„è§’è‰²ä¹Ÿå¿…é¡»éšä¹‹è¿›åŒ–ã€‚</p>
<p>è€Œè¿™ï¼Œæ­£æ˜¯é‡‘ä»“åœ¨å¤æ‚æ—¶åºåœºæ™¯ä¸­é€æ­¥é¢†å…ˆçš„æ ¹æœ¬åŸå› ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›½äº§æ—¶åºæ•°æ®åº“å´›èµ·ï¼šé‡‘ä»“å‡­ä»€ä¹ˆåœ¨å¤æ‚åœºæ™¯ä¸­ç¢¾å‹InfluxDB]]></title>    <link>https://juejin.cn/post/7584073390694973455</link>    <guid>https://juejin.cn/post/7584073390694973455</guid>    <pubDate>2025-12-16T14:33:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584073390694973455" data-draft-id="7584243498528505856" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›½äº§æ—¶åºæ•°æ®åº“å´›èµ·ï¼šé‡‘ä»“å‡­ä»€ä¹ˆåœ¨å¤æ‚åœºæ™¯ä¸­ç¢¾å‹InfluxDB"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T14:33:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›½äº§æ—¶åºæ•°æ®åº“å´›èµ·ï¼šé‡‘ä»“å‡­ä»€ä¹ˆåœ¨å¤æ‚åœºæ™¯ä¸­ç¢¾å‹InfluxDB
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T14:33:12.000Z" title="Tue Dec 16 2025 14:33:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç‰©è”ç½‘ã€å·¥ä¸šäº’è”ç½‘ä¸æ™ºèƒ½è¿ç»´é«˜é€Ÿå‘å±•çš„å½“ä¸‹ï¼Œæ—¶åºæ•°æ®çš„å¤„ç†éœ€æ±‚æ­£å‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚ä»è®¾å¤‡ç›‘æ§åˆ°æ™ºèƒ½å†³ç­–ï¼Œä¼ä¸šå¯¹æ•°æ®åº“çš„è¦æ±‚æ—©å·²ä¸å†å±€é™äºâ€œèƒ½å†™èƒ½æŸ¥â€ï¼Œè€Œæ˜¯è¿½æ±‚é«˜ååã€ä½å»¶è¿Ÿã€å¼ºä¸€è‡´æ€§ä»¥åŠå¤šç»´åº¦åˆ†æèƒ½åŠ›ã€‚è¿‡å»ï¼ŒInfluxDBå‡­å€Ÿå…ˆå‘ä¼˜åŠ¿å’Œç®€æ´æ¶æ„ï¼Œæˆä¸ºæ—¶åºæ•°æ®åº“çš„ä»£è¡¨ã€‚ç„¶è€Œï¼Œéšç€æ•°æ®é‡çº§ä»â€œä¸‡â€è·ƒå‡è‡³â€œåƒä¸‡â€ï¼Œå…¶æ€§èƒ½ç“¶é¢ˆæ—¥ç›Šå‡¸æ˜¾ã€‚</p>
<p>ä¸€åœºå›½äº§æ•°æ®åº“ä¸å›½é™…å¼€æºæ–¹æ¡ˆä¹‹é—´çš„è¾ƒé‡æ‚„ç„¶å±•å¼€ã€‚é‡‘ä»“æ•°æ®åº“ï¼ˆKingbaseESï¼‰ä»¥å…¨é¢é¢†å…ˆçš„æ€§èƒ½è¡¨ç°ï¼Œæ­£åœ¨é‡æ–°å®šä¹‰æ—¶åºæ•°æ®åº“çš„èƒ½åŠ›è¾¹ç•Œã€‚</p>
<hr/>
<h2 data-id="heading-0"><strong>æ€§èƒ½å…¨é¢é¢†å…ˆï¼šä»å†™å…¥åˆ°åˆ†æï¼Œé‡‘ä»“å…¨é¢èƒœå‡º</strong></h2>
<p>åŸºäºä¸šç•Œå…¬è®¤çš„TSBSï¼ˆTime Series Benchmark Suiteï¼‰åŸºå‡†æµ‹è¯•ï¼Œé‡‘ä»“ä¸InfluxDBåœ¨å¤šè½®å¯¹æ¯”ä¸­å±•å¼€æ­£é¢äº¤é”‹ã€‚ç»“æœæ˜¾ç¤ºï¼šåœ¨å°è§„æ¨¡ã€ç®€å•æŸ¥è¯¢åœºæ™¯ä¸‹ï¼Œä¸¤è€…è¡¨ç°æ¥è¿‘ï¼›ä½†åœ¨å¤§è§„æ¨¡ã€å¤æ‚åˆ†æçš„çœŸå®ä¸šåŠ¡ç¯å¢ƒä¸­ï¼Œé‡‘ä»“å±•ç°å‡ºå‹å€’æ€§ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-1"><strong>å†™å…¥æ€§èƒ½ï¼šé«˜å¹¶å‘ä¸‹ç¨³å®šé¢†å…ˆ</strong></h3>
<p>æ¨¡æ‹Ÿä»100å°åˆ°1000ä¸‡å°è®¾å¤‡çš„æ•°æ®å†™å…¥å‹åŠ›ï¼Œé‡‘ä»“åœ¨è®¾å¤‡è§„æ¨¡è¾¾åˆ°4000å°ï¼ˆæ¯å°10ä¸ªæŒ‡æ ‡ï¼‰æ—¶ï¼Œå†™å…¥æ€§èƒ½å·²è¾¾InfluxDBçš„162%ã€‚åœ¨åƒä¸‡çº§è®¾å¤‡æé™æµ‹è¯•ä¸­ï¼Œè¿™ä¸€ä¼˜åŠ¿è¿›ä¸€æ­¥æ‰©å¤§<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d6d605a72ef42b293962b0fe5f5b935~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766500392&amp;x-signature=VE24Ow2%2FbGW10%2FjtnJhTzPoe%2BgY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
è‡³267%ã€‚è¿™æ„å‘³ç€ï¼Œé¢å¯¹é«˜å¹¶å‘ã€æŒç»­å†™å…¥çš„æµ·é‡æ—¶åºæ•°æ®ï¼Œé‡‘ä»“å…·å¤‡æ›´å¼ºçš„æ‰©å±•èƒ½åŠ›ä¸ç¨³å®šæ€§ã€‚</p>
<h3 data-id="heading-2"><strong>æŸ¥è¯¢æ€§èƒ½ï¼šå¤æ‚åˆ†æåœºæ™¯ä¸‹ç¢¾å‹å¼é¢†å…ˆ</strong></h3>
<p>åœ¨æŸ¥è¯¢æ€§èƒ½æ–¹é¢ï¼Œé‡‘ä»“çš„ä¼˜åŠ¿å°¤ä¸ºæ˜æ˜¾ï¼Œå°¤å…¶åœ¨å¤šç»´åº¦èšåˆã€è·¨è®¾å¤‡åˆ†æç­‰é«˜å¤æ‚åº¦æŸ¥è¯¢ä¸­ï¼š</p>
<ul>
<li><strong>ç®€å•èšåˆæŸ¥è¯¢ï¼ˆå¦‚å•è®¾å¤‡çŸ­æ—¶é—´çª—å£èšåˆï¼‰</strong>ï¼šä¸¤è€…å“åº”æ—¶é—´æ¥è¿‘ï¼Œæ¯«ç§’çº§å®Œæˆã€‚</li>
<li><strong>ä¸­ç­‰å¤æ‚åº¦æŸ¥è¯¢ï¼ˆå¦‚å¤šæŒ‡æ ‡èšåˆã€è·¨è®¾å¤‡åˆ†ç»„ï¼‰</strong>ï¼šé‡‘ä»“å“åº”é€Ÿåº¦ä¸ºInfluxDBçš„3~4å€ã€‚</li>
<li><strong>é«˜å¤æ‚åº¦å…³è”åˆ†æï¼ˆå¦‚Last PointæŸ¥è¯¢ã€é«˜è´Ÿè½½è®¾å¤‡ç­›é€‰ï¼‰</strong>ï¼šé‡‘ä»“æ€§èƒ½é¢†å…ˆå¯è¾¾æ•°åå€ã€‚ä¾‹å¦‚ï¼Œåœ¨â€œæŸ¥è¯¢æŸæ—¶æ®µå†…æ¯å°è®¾å¤‡çš„æœ€åè¯»æ•°â€åœºæ™¯ä¸­ï¼Œé‡‘ä»“è€—æ—¶ä»…147æ¯«ç§’ï¼Œè€ŒInfluxDBè¶…è¿‡10ç§’ï¼Œæ€§èƒ½å·®è·è¶…è¿‡70å€ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f8c8cef3efe40108458094b4bbd2014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766500392&amp;x-signature=WjrsrT6OkNB6GYXOqT4HuLGfO%2Bc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3"><strong>ä¸æ­¢äºå¿«ï¼šé‡‘ä»“çš„ä¼ä¸šçº§èƒ½åŠ›ä¸èåˆä¼˜åŠ¿</strong></h2>
<p>é‡‘ä»“çš„ä¼˜åŠ¿ä¸ä»…ä½“ç°åœ¨â€œè·‘å¾—å¿«â€ï¼Œæ›´åœ¨äºå…¶é¢å‘ä¼ä¸šçº§åº”ç”¨çš„æ·±åº¦è®¾è®¡ã€‚ç›¸æ¯”InfluxDBï¼Œé‡‘ä»“åœ¨ä»¥ä¸‹å‡ ä¸ªå…³é”®ç»´åº¦å®ç°äº†è´¨çš„é£è·ƒã€‚</p>
<h3 data-id="heading-4"><strong>1. å®Œæ•´SQLç”Ÿæ€ï¼Œé™ä½å¼€å‘ä¸è¿ç§»æˆæœ¬</strong></h3>
<p>é‡‘ä»“åŸºäºæˆç†Ÿçš„å…³ç³»å‹æ•°æ®åº“å†…æ ¸ï¼ŒåŸç”Ÿæ”¯æŒæ ‡å‡†SQLã€å­˜å‚¨è¿‡ç¨‹ã€äº‹åŠ¡ï¼ˆACIDï¼‰ä¸å¤šè¡¨å…³è”æŸ¥è¯¢ã€‚ä¼ä¸šæ— éœ€å­¦ä¹ æ–°çš„æŸ¥è¯¢è¯­è¨€ï¼Œç°æœ‰SQLå·¥å…·å’Œä¸šåŠ¡ç³»ç»Ÿå¯ç›´æ¥å¯¹æ¥ï¼Œæå¤§é™ä½å¼€å‘ä¸è¿ç»´æˆæœ¬ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒInfluxDBéœ€ä½¿ç”¨InfluxQLæˆ–Fluxè¯­è¨€ï¼Œé›†æˆæˆæœ¬é«˜ï¼Œä¸”åœ¨é‡‘èã€å·¥æ§ç­‰å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ä¸­éš¾ä»¥èƒœä»»ã€‚</p>
<h3 data-id="heading-5"><strong>2. é«˜æ•ˆå­˜å‚¨ä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong></h3>
<p>é‡‘ä»“å†…ç½®æ—¶åºç»„ä»¶ï¼Œæ”¯æŒæŒ‰æ—¶é—´è‡ªåŠ¨åˆ†åŒºã€å†·çƒ­æ•°æ®åˆ†çº§å­˜å‚¨ä¸é«˜å‹ç¼©æ¯”å­˜å‚¨ã€‚å®æµ‹æ˜¾ç¤ºï¼Œå…¶å¯¹å·¥ä¸šä¼ æ„Ÿå™¨æ•°æ®å¯å®ç°é«˜è¾¾1:4çš„å‹ç¼©æ¯”ï¼Œæ˜¾è‘—é™ä½å­˜å‚¨æˆæœ¬ã€‚åŒæ—¶ï¼Œå†·çƒ­æ•°æ®åˆ†ç¦»æœºåˆ¶ä¹Ÿæå‡äº†æŸ¥è¯¢æ•ˆç‡ä¸ç³»ç»Ÿå“åº”é€Ÿåº¦ã€‚</p>
<h3 data-id="heading-6"><strong>3. å¤šæ¨¡èåˆï¼Œæ‰“ç ´æ•°æ®å­¤å²›</strong></h3>
<p>é‡‘ä»“é¦–åˆ›â€œæ—¶åº+â€å¤šæ¨¡èåˆæ¶æ„ï¼Œæ”¯æŒåœ¨åŒä¸€æ•°æ®åº“ä¸­å¯¹æ—¶åºæ•°æ®ã€ç©ºé—´åœ°ç†ä¿¡æ¯ï¼ˆGISï¼‰ã€JSONæ–‡æ¡£ç­‰å¤šç§æ•°æ®ç±»å‹è¿›è¡Œè”åˆæŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼Œåœ¨æ™ºæ…§äº¤é€šåœºæ™¯ä¸­ï¼Œç”¨æˆ·å¯é€šè¿‡ä¸€æ¡SQLå®ç°â€œæŸ¥è¯¢è¿‡å»ä¸€å‘¨åœ¨æœºåœºå‘¨è¾¹é¢‘ç¹å‡ºç°çš„è½¦è¾†â€ï¼Œè€Œè¿™ç±»æ—¶ç©ºè”åˆæŸ¥è¯¢åœ¨InfluxDBä¸­å‡ ä¹æ— æ³•åŸç”Ÿæ”¯æŒã€‚</p>
<hr/>
<h2 data-id="heading-7"><strong>å®æˆ˜éªŒè¯ï¼šä»æµ‹è¯•åœºèµ°å‘æ ¸å¿ƒç”Ÿäº§ç³»ç»Ÿ</strong></h2>
<p>é‡‘ä»“çš„æ—¶åºèƒ½åŠ›å·²åœ¨å¤šä¸ªå…³é”®è¡Œä¸šä¸­è½åœ°ï¼ŒæˆåŠŸæ›¿ä»£æˆ–ä¼˜äºåŸæœ‰æ–¹æ¡ˆï¼Œæˆä¸ºæ”¯æ’‘æ ¸å¿ƒä¸šåŠ¡çš„æ•°æ®åº•åº§ã€‚</p>
<h3 data-id="heading-8"><strong>æ¡ˆä¾‹ä¸€ï¼šæ™ºæ…§æ¸¯å£</strong></h3>
<p>åœ¨æŸå¤§å‹æ¸¯å£é›†å›¢çš„æ™ºèƒ½è°ƒåº¦ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿéœ€å¤„ç†æ—¥å‡æ•°åäº¿æ¡GPSè½¨è¿¹æ•°æ®ã€‚é‡‘ä»“åœ¨å†™å…¥ååé‡ã€æŸ¥è¯¢å“åº”é€Ÿåº¦ä¸ç³»ç»Ÿç¨³å®šæ€§æ–¹é¢å…¨é¢ä¼˜äºInfluxDBï¼Œæœ€ç»ˆæˆä¸ºå…¶æ ¸å¿ƒå¼•æ“ï¼Œæ”¯æ’‘é›†å¡è°ƒåº¦ã€åŒºåŸŸç»Ÿè®¡ç­‰å…³é”®åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-9"><strong>æ¡ˆä¾‹äºŒï¼šæ–°èƒ½æºé£ç”µ</strong></h3>
<p>æŸæ–°èƒ½æºä¼ä¸šéœ€ç®¡ç†ä¸Šåƒå°é£æœºçš„è¿è¡ŒçŠ¶æ€æ•°æ®ã€‚é‡‘ä»“ä¸ä»…å®ç°æ¯ç§’æ•°åä¸‡ç‚¹æ•°æ®çš„é«˜æ•ˆå†™å…¥ï¼Œè¿˜èƒ½ä¸è®¾å¤‡å…ƒæ•°æ®æ— ç¼èåˆï¼Œæ”¯æŒâ€œè®¾å¤‡-çŠ¶æ€-å‘Šè­¦â€ä¸€ä½“åŒ–æŸ¥è¯¢ã€‚æµ‹è¯•æ˜¾ç¤ºï¼Œå…¶å¤æ‚åˆ†ææŸ¥è¯¢æ€§èƒ½ä¸ºInfluxDBçš„2~70å€ï¼Œé¢„è®¡å¯èŠ‚çœè¶…ç™¾ä¸‡å…ƒå­˜å‚¨æˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-10"><strong>ç»“è¯­ï¼šä»â€œè®°å½•â€åˆ°â€œæ´å¯Ÿâ€ï¼Œé‡‘ä»“å®šä¹‰ä¸‹ä¸€ä»£æ—¶åºæ•°æ®åº“</strong></h2>
<p>InfluxDBæˆ–è®¸ä»é€‚ç”¨äºè½»é‡çº§ç›‘æ§åœºæ™¯ï¼Œä½†å½“ä¼ä¸šè¿ˆå‘å®æ—¶åˆ†æã€æ™ºèƒ½å†³ç­–ã€ç³»ç»Ÿèåˆçš„æ–°é˜¶æ®µï¼Œé‡‘ä»“æä¾›äº†æ›´å¼ºå¤§ã€æ›´æˆç†Ÿã€æ›´å¯æ§çš„é€‰æ‹©ã€‚</p>
<p>å®ƒä¸ä»…æ˜¯ä¸€ä¸ªæ›´å¿«çš„æ—¶åºæ•°æ®åº“ï¼Œæ›´æ˜¯ä¸€ä¸ªèåˆæ—¶åºã€å…³ç³»ã€ç©ºé—´ç­‰å¤šæ¨¡æ•°æ®èƒ½åŠ›çš„ç»Ÿä¸€å¹³å°ã€‚é€‰æ‹©é‡‘ä»“ï¼Œä¸åªæ˜¯é€‰æ‹©ä¸€æ¬¾æ•°æ®åº“ï¼Œæ›´æ˜¯é€‰æ‹©ä¸€ç§é¢å‘æœªæ¥çš„æ•°æ®åŸºç¡€è®¾æ–½ã€‚</p>
<p>åœ¨æ•°æ®é©±åŠ¨çš„æ–°æ—¶ä»£ï¼Œé‡‘ä»“æ­£ä»¥â€œæ´å¯Ÿæœªæ¥â€çš„èƒ½åŠ›ï¼Œå¼•é¢†å›½äº§æ•°æ®åº“èµ°å‘æ›´å¹¿é˜”çš„èˆå°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹]]></title>    <link>https://juejin.cn/post/7584266184882552866</link>    <guid>https://juejin.cn/post/7584266184882552866</guid>    <pubDate>2025-12-16T14:50:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584266184882552866" data-draft-id="7576487832089788431" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹"/> <meta itemprop="keywords" content="åç«¯,MySQL"/> <meta itemprop="datePublished" content="2025-12-16T14:50:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T14:50:50.000Z" title="Tue Dec 16 2025 14:50:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å¤§åï¼</p>
<p>MySQL æœ‰å¾ˆå¤šé«˜çº§ä½†å®ç”¨çš„åŠŸèƒ½ï¼Œèƒ½è®©ä½ çš„æŸ¥è¯¢å˜å¾—æ›´ç®€æ´ã€æ›´é«˜æ•ˆã€‚</p>
<p>ä»Šå¤©åˆ†äº« 10 ä¸ªæˆ‘åœ¨å·¥ä½œä¸­ç»å¸¸ä½¿ç”¨çš„ SQL æŠ€å·§ï¼Œä¸ç”¨æ­»è®°ç¡¬èƒŒï¼ŒæŒæ¡äº†å°±èƒ½ç«‹åˆ»æå‡ä½ çš„æ•°æ®åº“æ“ä½œæ°´å¹³ï¼</p>
<h3 data-id="heading-0">1. CTEï¼ˆ<code>WITH</code> å­å¥ï¼‰â€”â€”è®©å¤æ‚æŸ¥è¯¢å˜æ¸…æ™°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä¼ ç»Ÿå­æŸ¥è¯¢ï¼Œéš¾ä»¥é˜…è¯»</span>
<span class="hljs-keyword">SELECT</span> nickname 
<span class="hljs-keyword">FROM</span> system_users 
<span class="hljs-keyword">WHERE</span> dept_id <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> system_dept <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-operator">=</span> <span class="hljs-string">'ITéƒ¨'</span>
);

<span class="hljs-comment">-- ä½¿ç”¨CTEï¼Œé€»è¾‘æ¸…æ™°</span>
<span class="hljs-keyword">WITH</span> ny_depts <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> system_dept <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-operator">=</span> <span class="hljs-string">'ITéƒ¨'</span>
)
<span class="hljs-keyword">SELECT</span> u.nickname
<span class="hljs-keyword">FROM</span> system_users u
<span class="hljs-keyword">JOIN</span> ny_depts nd <span class="hljs-keyword">ON</span> u.dept_id <span class="hljs-operator">=</span> nd.id;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>WITH ny_depts AS (...)</code>ï¼šå…ˆåˆ›å»ºä¸€ä¸ªä¸´æ—¶ç»“æœé›†ï¼Œå« <code>ny_depts</code>ï¼Œé‡Œé¢åªåŒ…å«â€œITéƒ¨â€çš„éƒ¨é—¨åç§°ã€‚</li>
<li><code>SELECT u.nickname FROM system_users u JOIN ny_depts...</code>ï¼šå†ä»ç”¨æˆ·è¡¨ä¸­æ‰¾å‡ºé‚£äº›éƒ¨é—¨IDåœ¨<code>ny_depts</code>é‡Œçš„å‘˜å·¥æ˜µç§°ã€‚</li>
</ul>
<p><strong>å¥½å¤„</strong>ï¼šæŠŠæ‰¾éƒ¨é—¨å’Œæ‰¾äººåˆ†æˆä¸¤æ­¥ï¼Œé€»è¾‘æ›´æ¸…æ¥šï¼Œæ¯”åµŒå¥—å­æŸ¥è¯¢å¥½è¯»å¤šäº†ã€‚</p>
<hr/>
<h3 data-id="heading-1">2. çª—å£å‡½æ•° â€”â€” ä¸åˆ†ç»„ä¹Ÿèƒ½ç»Ÿè®¡</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    name,
    department,
    salary,
    <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rank_in_dept,
    <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department) <span class="hljs-keyword">AS</span> avg_salary
<span class="hljs-keyword">FROM</span> employees;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>PARTITION BY department</code>ï¼šæŒ‰éƒ¨é—¨â€œåˆ†ç»„â€ï¼Œä½†<strong>ä¸åˆå¹¶è¡Œ</strong>ï¼Œæ¯è¡Œä»ç„¶ä¿ç•™ã€‚</li>
<li><code>RANK() OVER (...)</code>ï¼šåœ¨æ¯ä¸ªéƒ¨é—¨å†…éƒ¨ï¼ŒæŒ‰è–ªæ°´ä»é«˜åˆ°ä½æ’åï¼ˆç›¸åŒè–ªæ°´å¹¶åˆ—ï¼‰ã€‚</li>
<li><code>AVG(salary) OVER (...)</code>ï¼šè®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„ï¼Œå¹¶æ˜¾ç¤ºåœ¨æ¯ä¸€è¡Œé‡Œã€‚</li>
</ul>
<p><strong>å¯¹æ¯” GROUP BY</strong>ï¼š<code>GROUP BY</code> ä¼šæŠŠå¤šè¡Œåˆå¹¶æˆä¸€è¡Œï¼Œè€Œçª—å£å‡½æ•°ä¿ç•™åŸå§‹è¡Œï¼ŒåŒæ—¶åŠ ä¸Šç»Ÿè®¡å€¼ã€‚</p>
<hr/>
<h3 data-id="heading-2">3. æ¡ä»¶èšåˆ â€”â€” ä¸€è¡ŒæŸ¥å‡ºå¤šä¸ªç»Ÿè®¡</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">YEAR</span>(created_at) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">year</span>,
    <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> total,
    <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'completed'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> completed,
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'completed'</span> <span class="hljs-keyword">THEN</span> amount <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> revenue
<span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">YEAR</span>(created_at);
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>YEAR(created_at)</code>ï¼šæå–è®¢å•å¹´ä»½ã€‚</li>
<li><code>COUNT(*)</code>ï¼šè¯¥å¹´æ€»è®¢å•æ•°ã€‚</li>
<li><code>COUNT(CASE WHEN status = 'completed' THEN 1 END)</code>ï¼š
å¦‚æœçŠ¶æ€æ˜¯ <code>'completed'</code>ï¼Œå°±è¿”å› <code>1</code>ï¼Œå¦åˆ™è¿”å› <code>NULL</code>ï¼›</li>
<li><code>COUNT()</code> åªç»Ÿè®¡é <code>NULL</code> å€¼ï¼Œæ‰€ä»¥è¿™è¡Œå°±æ˜¯â€œå®Œæˆçš„è®¢å•æ•°â€ã€‚</li>
<li><code>SUM(CASE WHEN ... THEN amount ELSE 0 END)</code>ï¼šåªå¯¹å®Œæˆçš„è®¢å•æ±‚é‡‘é¢æ€»å’Œã€‚</li>
</ul>
<p><strong>å…³é”®</strong>ï¼šä¸ç”¨å†™å¤šä¸ªå­æŸ¥è¯¢ï¼Œä¸€æ¡è¯­å¥æå®šå…¨å¹´æŠ¥è¡¨ï¼</p>
<hr/>
<h3 data-id="heading-3">4. è‡ªè¿æ¥ â€”â€” åŒä¸€å¼ è¡¨è‡ªå·±è¿è‡ªå·±</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> e1.name, e2.name
<span class="hljs-keyword">FROM</span> employees e1
<span class="hljs-keyword">JOIN</span> employees e2 
  <span class="hljs-keyword">ON</span> e1.department <span class="hljs-operator">=</span> e2.department
  <span class="hljs-keyword">AND</span> e1.id <span class="hljs-operator">&lt;</span> e2.id  
  <span class="hljs-keyword">AND</span> <span class="hljs-built_in">ABS</span>(e1.salary <span class="hljs-operator">-</span> e2.salary) <span class="hljs-operator">&lt;=</span> e1.salary <span class="hljs-operator">*</span> <span class="hljs-number">0.1</span>;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>employees e1 JOIN employees e2</code>ï¼šæŠŠå‘˜å·¥è¡¨å½“æˆä¸¤ä¸ªå‰¯æœ¬ï¼ˆe1 å’Œ e2ï¼‰æ¥è¿æ¥ã€‚</li>
<li><code>e1.department = e2.department</code>ï¼šåªæ‰¾åŒä¸€ä¸ªéƒ¨é—¨çš„äººã€‚</li>
<li><code>e1.id &lt; e2.id</code>ï¼šé¿å…é‡å¤é…å¯¹ï¼ˆæ¯”å¦‚ Alice-Bob å’Œ Bob-Alice åªä¿ç•™ä¸€ä¸ªï¼‰ã€‚</li>
<li><code>ABS(...)</code>ï¼šè®¡ç®—ä¸¤äººè–ªæ°´å·®æ˜¯å¦ â‰¤ 10%ã€‚</li>
</ul>
<p><strong>ç”¨é€”</strong>ï¼šæ‰¾â€œç›¸ä¼¼è®°å½•â€â€œé…å¯¹å…³ç³»â€â€œä¸Šä¸‹çº§â€ç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-4">5. <code>EXISTS</code> æ›¿ä»£ <code>IN</code> â€”â€” æ›´é«˜æ•ˆçš„å­˜åœ¨åˆ¤æ–­</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> name <span class="hljs-keyword">FROM</span> customers c
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> orders o 
    <span class="hljs-keyword">WHERE</span> o.customer_id <span class="hljs-operator">=</span> c.id <span class="hljs-keyword">AND</span> o.amount <span class="hljs-operator">&gt;</span> <span class="hljs-number">1000</span>
);
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li>å¯¹æ¯ä¸€ä½å®¢æˆ· <code>c</code>ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ç¬”è®¢å•æ»¡è¶³ï¼š
<ul>
<li>è®¢å•çš„ <code>customer_id</code> ç­‰äºè¿™ä¸ªå®¢æˆ·çš„ <code>id</code></li>
<li>è®¢å•é‡‘é¢ &gt; 1000</li>
</ul>
</li>
<li><code>SELECT 1</code>ï¼šè¿™é‡Œä¸éœ€è¦è¿”å›å…·ä½“å­—æ®µï¼Œåªè¦çŸ¥é“â€œæœ‰æ²¡æœ‰â€å°±è¡Œï¼Œæ‰€ä»¥ç”¨ <code>1</code> æœ€è½»é‡ã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</strong>ï¼šä¸€æ—¦æ‰¾åˆ°ä¸€æ¡åŒ¹é…è®¢å•ï¼Œå°±ç«‹åˆ»åœæ­¢æœç´¢ï¼Œä¸åƒ <code>IN</code> å¯èƒ½è¦åŠ è½½å…¨éƒ¨è®¢å• IDã€‚</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœå­æŸ¥è¯¢å¯èƒ½è¿”å› <code>NULL</code>ï¼Œ<code>IN</code> ä¼šå¤±æ•ˆï¼ˆå› ä¸º <code>x IN (..., NULL)</code> æ°¸è¿œä¸º <code>UNKNOWN</code>ï¼‰ï¼Œè€Œ <code>EXISTS</code> ä¸å—å½±å“ã€‚</p>
<hr/>
<h3 data-id="heading-5">6. JSON å‡½æ•° â€”â€” è½»æ¾è¯»å– JSON å­—æ®µ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    name,
    profile<span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span><span class="hljs-string">'$.address.city'</span> <span class="hljs-keyword">AS</span> city,
    JSON_EXTRACT(profile, <span class="hljs-string">'$.age'</span>) <span class="hljs-keyword">AS</span> age
<span class="hljs-keyword">FROM</span> users
<span class="hljs-keyword">WHERE</span> profile<span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span><span class="hljs-string">'$.city'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'Beijing'</span>;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>profile</code> æ˜¯ä¸€ä¸ª JSON ç±»å‹å­—æ®µï¼Œæ¯”å¦‚ï¼š<code>{"address": {"city": "Beijing"}, "age": 30}</code></li>
<li><code>profile-&gt;&gt;'$.address.city'</code>ï¼š
<ul>
<li><code>-&gt;&gt;</code> æ˜¯ç®€å†™ï¼Œç­‰ä»·äº <code>JSON_UNQUOTE(JSON_EXTRACT(...))</code></li>
<li>è¿”å›å­—ç¬¦ä¸² <code>"Beijing"</code>ï¼ˆå»æ‰å¼•å·ï¼‰</li>
</ul>
</li>
<li><code>JSON_EXTRACT(profile, '$.age')</code>ï¼šè¿”å› <code>30</code>ï¼ˆå¸¦ç±»å‹ï¼Œå¯èƒ½æ˜¯æ•°å­—ï¼‰</li>
<li><code>WHERE profile-&gt;&gt;'$.city' = 'Beijing'</code>ï¼šç­›é€‰åŸå¸‚æ˜¯åŒ—äº¬çš„ç”¨æˆ·ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç”¨æˆ·åå¥½ã€åŠ¨æ€è¡¨å•ã€æ—¥å¿—ç­‰ç»“æ„ä¸å›ºå®šçš„å­—æ®µã€‚</p>
<hr/>
<h3 data-id="heading-6">7. ç”Ÿæˆåˆ— â€”â€” æ•°æ®åº“è‡ªåŠ¨å¸®ä½ ç®—</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> products (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    width <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),
    height <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),
    area <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> (width <span class="hljs-operator">*</span> height) STORED
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> products (id, width, height) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>);
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>area DECIMAL(...) AS (width * height) STORED</code>ï¼š
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªâ€œå­˜å‚¨å‹ç”Ÿæˆåˆ—â€ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨è®¡ç®— <code>width * height</code> å¹¶å­˜ä¸‹æ¥ã€‚</li>
<li>å¦‚æœä¸åŠ  <code>STORED</code>ï¼Œå°±æ˜¯â€œè™šæ‹Ÿåˆ—â€ï¼ˆæ¯æ¬¡æŸ¥è¯¢æ—¶è®¡ç®—ï¼Œä¸å å­˜å‚¨ï¼‰ã€‚</li>
</ul>
</li>
<li>æ’å…¥æ—¶åªéœ€ç»™ <code>width</code> å’Œ <code>height</code>ï¼Œ<code>area</code> è‡ªåŠ¨å˜æˆ <code>50</code>ã€‚</li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>ï¼šé¿å…åº”ç”¨å±‚é‡å¤è®¡ç®—ï¼Œè¿˜èƒ½ç»™ <code>area</code> åŠ ç´¢å¼•åŠ é€ŸæŸ¥è¯¢ï¼</p>
<hr/>
<h3 data-id="heading-7">8. å¤šè¡¨æ›´æ–° â€”â€” ä¸€æ¡è¯­å¥æ›´æ–°å…³è”æ•°æ®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span> customers c
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> customer_id, <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">AS</span> total
    <span class="hljs-keyword">FROM</span> orders
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> customer_id
) o <span class="hljs-keyword">ON</span> c.id <span class="hljs-operator">=</span> o.customer_id
<span class="hljs-keyword">SET</span> c.total_spent <span class="hljs-operator">=</span> o.total;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li>å­æŸ¥è¯¢ <code>o</code>ï¼šå…ˆæŒ‰å®¢æˆ· ID ç»Ÿè®¡æ¯ä¸ªäººçš„æ€»æ¶ˆè´¹ã€‚</li>
<li><code>UPDATE customers c JOIN o ...</code>ï¼šæŠŠå®¢æˆ·è¡¨å’Œç»Ÿè®¡ç»“æœè¿æ¥èµ·æ¥ã€‚</li>
<li><code>SET c.total_spent = o.total</code>ï¼šç›´æ¥æŠŠç»Ÿè®¡å€¼å†™å›å®¢æˆ·è¡¨ã€‚</li>
</ul>
<p><strong>å¥½å¤„</strong>ï¼šä¸ç”¨åœ¨ç¨‹åºé‡Œå¾ªç¯â€œæŸ¥ä¸€ä¸ªã€æ”¹ä¸€ä¸ªâ€ï¼Œå‡å°‘ç½‘ç»œå¼€é”€ï¼Œä¿è¯åŸå­æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-8">9. <code>GROUP_CONCAT</code> â€”â€” å¤šè¡Œå˜ä¸€è¡Œ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    department,
    GROUP_CONCAT(name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span> SEPARATOR <span class="hljs-string">', '</span>) <span class="hljs-keyword">AS</span> members
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>GROUP BY department</code>ï¼šæŒ‰éƒ¨é—¨åˆ†ç»„ã€‚</li>
<li><code>GROUP_CONCAT(name ...)</code>ï¼šæŠŠæ¯ä¸ªéƒ¨é—¨çš„æ‰€æœ‰å‘˜å·¥åå­—æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li><code>ORDER BY salary DESC</code>ï¼šæŒ‰è–ªæ°´ä»é«˜åˆ°ä½æ’åºåå†æ‹¼æ¥ã€‚</li>
<li><code>SEPARATOR ', '</code>ï¼šç”¨é€—å·åŠ ç©ºæ ¼åˆ†éš”åå­—ã€‚</li>
</ul>
<p><strong>å…¸å‹ç”¨é€”</strong>ï¼šå¯¼å‡ºåå•ã€å±•ç¤ºæ ‡ç­¾ã€æ±‡æ€»æ˜ç»†ç­‰ã€‚</p>
<p>é»˜è®¤æœ€å¤šæ‹¼ 1024 å­—ç¬¦ï¼Œå¯é€šè¿‡ <code>SET SESSION group_concat_max_len = 1000000;</code> è°ƒå¤§ã€‚</p>
<hr/>
<h3 data-id="heading-9">10. <code>INSERT ... ON DUPLICATE KEY UPDATE</code> â€”â€” æ™ºèƒ½æ’å…¥/æ›´æ–°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> page_views (page_url, view_date, view_count)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'/home'</span>, CURDATE(), <span class="hljs-number">1</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> 
    view_count <span class="hljs-operator">=</span> view_count <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li>å°è¯•æ’å…¥ä¸€æ¡æ–°è®°å½•ï¼šé¡µé¢ <code>/home</code>ï¼Œä»Šå¤©æ—¥æœŸï¼Œè®¿é—®æ¬¡æ•°ä¸º 1ã€‚</li>
<li>å¦‚æœå› ä¸º<strong>å”¯ä¸€ç´¢å¼•å†²çª</strong>ï¼ˆæ¯”å¦‚ <code>(page_url, view_date)</code> æ˜¯å”¯ä¸€é”®ï¼‰å¯¼è‡´æ’å…¥å¤±è´¥ï¼š
<ul>
<li>å°±æ‰§è¡Œ <code>ON DUPLICATE KEY UPDATE</code> éƒ¨åˆ†</li>
<li>æŠŠåŸæœ‰çš„ <code>view_count</code> åŠ  1</li>
</ul>
</li>
<li><strong>æ•ˆæœ</strong>ï¼šç¬¬ä¸€æ¬¡è®¿é—®åˆ›å»ºè®°å½•ï¼Œä¹‹åæ¯æ¬¡è®¿é—®è‡ªåŠ¨ +1ï¼Œå®Œç¾å®ç°è®¡æ•°å™¨ï¼</li>
</ul>
<p><strong>å‰æ</strong>ï¼šè¡¨å¿…é¡»æœ‰ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ï¼Œå¦åˆ™ä¸ä¼šè§¦å‘æ›´æ–°ã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-10">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6V83qjR6u0nyfzL-14xYAw" target="_blank" title="https://mp.weixin.qq.com/s/6V83qjR6u0nyfzL-14xYAw" ref="nofollow noopener noreferrer">ã€Šasync/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FbgLoyqb3VLgn3xXAok3kcQ" target="_blank" title="https://mp.weixin.qq.com/s/bgLoyqb3VLgn3xXAok3kcQ" ref="nofollow noopener noreferrer">ã€Šå¦‚ä½•æŸ¥çœ‹ SpringBoot å½“å‰çº¿ç¨‹æ•°ï¼Ÿ3 ç§æ–¹æ³•äº²æµ‹æœ‰æ•ˆã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FDpjuafW3agyhLEQYif3zJA" target="_blank" title="https://mp.weixin.qq.com/s/DpjuafW3agyhLEQYif3zJA" ref="nofollow noopener noreferrer">ã€Šåˆ«å†ä¹± new ArrayListï¼8 å¤§ Java å®¹å™¨é€‰å‹æ¡ˆä¾‹ï¼Œä¸€ç¯‡çœ‹æ‡‚ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å¦‚ä½•å®ç°RAGï¼Ÿä¸€æ–‡å¸¦ä½ é€Ÿé€šï¼Œä½¿ç”¨RAGå®ç°é•¿æœŸè®°å¿†]]></title>    <link>https://juejin.cn/post/7584297353419522048</link>    <guid>https://juejin.cn/post/7584297353419522048</guid>    <pubDate>2025-12-16T13:40:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584297353419522048" data-draft-id="7584073390694793231" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å¦‚ä½•å®ç°RAGï¼Ÿä¸€æ–‡å¸¦ä½ é€Ÿé€šï¼Œä½¿ç”¨RAGå®ç°é•¿æœŸè®°å¿†"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,Node.js"/> <meta itemprop="datePublished" content="2025-12-16T13:40:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‰­ç "/> <meta itemprop="url" content="https://juejin.cn/user/3349589831715801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å¦‚ä½•å®ç°RAGï¼Ÿä¸€æ–‡å¸¦ä½ é€Ÿé€šï¼Œä½¿ç”¨RAGå®ç°é•¿æœŸè®°å¿†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3349589831715801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‰­ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T13:40:50.000Z" title="Tue Dec 16 2025 13:40:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸€ä¸ªç—›ç‚¹ï¼š<strong>AI åŠ©æ‰‹æ— æ³•è®°ä½è·¨ä¼šè¯çš„å†å²è®°å½•</strong>ã€‚æœ¬æ–‡å°†ä»å‰ç«¯çš„è§†è§’å‡ºå‘ï¼Œæ·±åº¦è§£æ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„å·¥ä½œåŸç†ï¼Œå¹¶ç»“åˆå®é™…é¡¹ç›®ä»£ç ï¼Œè¯¦ç»†å‰–æå¦‚ä½•ä½¿ç”¨ <strong>LlamaIndex.js + DeepSeek + Qdrant</strong> å®ç° AI åŠ©æ‰‹çš„æ°¸ä¹…è®°å¿†ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ RAGï¼Ÿ</h2>
<p>å½“æˆ‘è°ƒç”¨ DeepSeek API æ­å»º AI å¯¹è¯å¹³å°æ—¶ï¼Œå¾ˆå¿«å‘ç°ä¸€ä¸ªè‡´å‘½ç¼ºé™·ï¼šå¦‚æœç”¨æˆ·å…³é—­ç½‘é¡µå†æ¬¡è¿›å…¥ï¼ŒAI ä¼šç«‹åˆ»â€œå¤±å¿†â€ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¼ ç»Ÿä¸Šæœ‰å‡ ç§æ–¹æ¡ˆï¼Œä½†éƒ½æœ‰æ˜æ˜¾å¼Šç«¯ï¼š</p>






























<table><thead><tr><th><strong>æ–¹æ¡ˆ</strong></th><th><strong>æè¿°</strong></th><th><strong>å¼Šç«¯åˆ†æ</strong></th></tr></thead><tbody><tr><td><strong>1. å®Œæ•´ä¸Šä¸‹æ–‡ä¼ é€’</strong></td><td>åœ¨ç³»ç»Ÿæç¤ºè¯ä¸­åŠ å…¥å…¨éƒ¨å†å²å¯¹è¯ã€‚</td><td><strong>é«˜æ˜‚æˆæœ¬ä¸é™åˆ¶</strong>ï¼šå¤§é‡ä¸Šä¸‹æ–‡ææ˜“è¶…å‡º LLM çš„ Token ä¸Šé™ï¼Œå¯¼è‡´å·¨é¢æ¶ˆè€—ï¼Œä¸”é•¿æ–‡æœ¬ä¼šç¨€é‡Š AI çš„æ³¨æ„åŠ›ã€‚</td></tr><tr><td><strong>2. å¯¹è¯æ‘˜è¦è®°å½•</strong></td><td>æ¯æ¬¡å¯¹è¯åï¼Œç”Ÿæˆä¸€ä¸ªæ‘˜è¦å¹¶ä¸æ–­ä¿®æ”¹ã€‚</td><td><strong>ä¿¡æ¯ä¸¢å¤±ä¸å‡†ç¡®æ€§</strong>ï¼šæ‘˜è¦æœ‰æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œä¸” AI è‡ªåŠ¨ç”Ÿæˆçš„æ‘˜è¦éš¾ä»¥ä¿è¯å‡†ç¡®æ€§ï¼Œå°‘é‡æ–‡å­—æ— æ³•å­˜å‚¨æµ·é‡ä¿¡æ¯ã€‚</td></tr><tr><td><strong>3. æ¨¡å‹å¾®è°ƒï¼ˆFine-tuningï¼‰</strong></td><td>ä½¿ç”¨å¯¹è¯è®°å½•å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚</td><td><strong>é«˜é—¨æ§›ä¸é«˜æˆæœ¬</strong>ï¼šå¯¹å‰ç«¯å¼€å‘è€…è€Œè¨€ï¼Œå®ç°éš¾åº¦ã€èµ„é‡‘æŠ•å…¥å’Œæ—¶é—´æˆæœ¬è¿‡é«˜ã€‚</td></tr><tr><td><strong>4. RAG æ£€ç´¢</strong></td><td>æ¯æ¬¡å¯¹è¯æ—¶ï¼Œæ£€ç´¢ä¸å½“å‰é—®é¢˜æœ€ç›¸å…³çš„å†å²è®°å½•ä½œä¸ºä¸Šä¸‹æ–‡ã€‚</td><td><strong>ä¼˜å¼‚çš„é•¿æœŸè®°å¿†æ–¹æ¡ˆ</strong>ï¼šé€šè¿‡å‘é‡åŒ–å®ç°è¯­ä¹‰åŒ¹é…ï¼Œç²¾å‡†é«˜æ•ˆåœ°æ³¨å…¥ç›¸å…³è®°å¿†ã€‚</td></tr></tbody></table>
<p><strong>ç»“è®ºï¼š</strong> RAG æ˜¯ç›®å‰æœ€ç»æµé«˜æ•ˆã€å¯æ§æ€§æœ€é«˜çš„é•¿æœŸè®°å¿†å®ç°æ–¹æ¡ˆã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ä»€ä¹ˆæ˜¯ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ï¼Ÿ</h2>
<p>RAG çš„å…¨ç§°æ˜¯ <strong>Retrieval-Augmented Generation</strong>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªæ–°çš„æ¨¡å‹ï¼Œè€Œæ˜¯ä¸€ç§<strong>æ¶æ„</strong>æˆ–<strong>æ¡†æ¶</strong>ï¼Œç”¨äºæå‡å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å›ç­”çš„<strong>å‡†ç¡®æ€§ã€æ—¶æ•ˆæ€§</strong>å’Œ<strong>çŸ¥è¯†æ·±åº¦</strong>ã€‚</p>
<p>RAG ä¸“é—¨è§£å†³ LLM çš„ä¸¤å¤§æ ¸å¿ƒé™åˆ¶ï¼š<strong>çŸ¥è¯†æ—¶æ•ˆæ€§</strong>ï¼ˆæ¨¡å‹çŸ¥è¯†æˆªæ­¢äºè®­ç»ƒæ•°æ®ï¼‰å’Œ<strong>ä¸Šä¸‹æ–‡çª—å£é™åˆ¶</strong>ï¼ˆçŸ­æœŸè®°å¿†ï¼‰ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒå·¥ä½œåŸç†</h3>
<p>RAG çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>åœ¨ LLM ç”Ÿæˆå›å¤ä¹‹å‰ï¼Œå…ˆå»å¤–éƒ¨çš„ã€ç‰¹å®šçš„çŸ¥è¯†åº“ä¸­æ‰¾åˆ°ç›¸å…³çš„â€œå‚è€ƒèµ„æ–™â€ï¼Œç„¶åå°†è¿™äº›èµ„æ–™ä½œä¸ºè¯æ®æä¾›ç»™ LLMã€‚</strong></p>
<p>RAG æµç¨‹åˆ†ä¸ºä¸¤å¤§é˜¶æ®µï¼š</p>
<h4 data-id="heading-3">1. ç´¢å¼•é˜¶æ®µ (Indexing) â€” çŸ¥è¯†çš„å­˜å‚¨ä¸å‘é‡åŒ–</h4>
<p>è¿™ä¸ªé˜¶æ®µæ˜¯<strong>é¢„å…ˆå®Œæˆ</strong>çš„ï¼Œç›®æ ‡æ˜¯å°†æ‚¨çš„ç§æœ‰æ•°æ®ï¼ˆä¾‹å¦‚æœ¬é¡¹ç›®ä¸­çš„å†å²å¯¹è¯è®°å½•ï¼‰è½¬æ¢ä¸º LLM å¯ä»¥å¿«é€ŸæŸ¥æ‰¾çš„æ ¼å¼ã€‚</p>
<ul>
<li><strong>åˆ†å— (Chunking)</strong> ï¼šå°†é•¿çš„å¯¹è¯è®°å½•æˆ–æ–‡æ¡£åˆ‡åˆ†æˆè¾ƒå°çš„ã€è¯­ä¹‰å®Œæ•´çš„ç‰‡æ®µã€‚</li>
<li><strong>åµŒå…¥ (Embedding)</strong> ï¼šä½¿ç”¨åµŒå…¥æ¨¡å‹ï¼ˆå¦‚ DeepSeek Embeddingsï¼‰å°†æ¯ä¸ªæ–‡æœ¬å—è½¬æ¢æˆ<strong>æ•°å€¼å‘é‡</strong>ã€‚</li>
<li><strong>å­˜å‚¨ (Storage)</strong> ï¼šå°†è¿™äº›å‘é‡åŠå…¶å¯¹åº”çš„åŸå§‹æ–‡æœ¬å­˜å‚¨åœ¨<strong>å‘é‡æ•°æ®åº“</strong>ï¼ˆå¦‚ Qdrantï¼‰ä¸­ã€‚</li>
</ul>
<h4 data-id="heading-4">2. è¿è¡Œæ—¶é˜¶æ®µ (Runtime) â€” è®°å¿†çš„æ£€ç´¢ä¸ç”Ÿæˆ</h4>
<p>è¿™ä¸ªé˜¶æ®µåœ¨<strong>æ¯æ¬¡ç”¨æˆ·æé—®æ—¶å®æ—¶å‘ç”Ÿ</strong>ï¼š</p>
<ul>
<li><strong>é—®é¢˜åµŒå…¥</strong>ï¼šå°†ç”¨æˆ·å½“å‰çš„é—®é¢˜è½¬æ¢ä¸ºæŸ¥è¯¢å‘é‡ã€‚</li>
<li><strong>æ£€ç´¢</strong>ï¼šç³»ç»Ÿåœ¨å‘é‡æ•°æ®åº“ä¸­è¿›è¡Œ<strong>ç›¸ä¼¼æ€§æœç´¢</strong>ï¼Œå¿«é€Ÿæ‰¾åˆ°ä¸æŸ¥è¯¢å‘é‡æœ€ç›¸ä¼¼çš„ <strong>Top K</strong> ä¸ªå†å²å¯¹è¯è®°å½•ã€‚</li>
<li><strong>æç¤ºè¯å¢å¼º (Augmentation)</strong> ï¼šå°†ç”¨æˆ·åŸå§‹é—®é¢˜ä¸æ£€ç´¢åˆ°çš„ç›¸å…³è®°å½•ä¸€èµ·æ‰“åŒ…ï¼Œå½¢æˆä¸€ä¸ª <strong>â€œå¢å¼ºçš„æç¤ºè¯â€ï¼ˆAugmented Promptï¼‰</strong> ã€‚</li>
<li><strong>ç”Ÿæˆ (Generation)</strong> ï¼šå°†å¢å¼ºæç¤ºè¯å‘é€ç»™ DeepSeek Chat APIï¼Œæ¨¡å‹æ ¹æ®ä¸Šä¸‹æ–‡ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€å¦‚ä½•å®ç° RAGï¼Ÿï¼ˆé¡¹ç›®å®æˆ˜æµç¨‹ï¼‰</h2>
<p>é¡¹ç›®githubè¿æ¥â€”â€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FObjecteee%2FaiKnowedge%2Ftree%2Fmain%2Frag%2FLlamaIndex" target="_blank" title="https://github.com/Objecteee/aiKnowedge/tree/main/rag/LlamaIndex" ref="nofollow noopener noreferrer">github.com/Objecteee/aâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f7c3e07337443bd9ea5d87c9052314d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766497249&amp;x-signature=DvW9DBbxqDyOkpHY8oQMkhhamNE%3D" alt="GIF 2025-12-16 21-18-35.gif" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‘é€ç»™aiçš„æç¤ºè¯å·²ç»é€šè¿‡RAGæ£€ç´¢åˆ°äº†ç›¸ä¼¼çš„å¯¹è¯è®°å½•,æˆ‘æ•´ç†äº†ä¸€ä¸‹æ ¼å¼å¦‚ä¸‹â€”â€”</p>
<pre><code class="hljs language-swift" lang="swift">
{

Â  <span class="hljs-string">"dataType"</span>: <span class="hljs-string">"ChatHistoryContext"</span>,

Â  <span class="hljs-string">"sourceJsonType"</span>: <span class="hljs-string">"debug"</span>,

Â  <span class="hljs-string">"systemInstruction"</span>: <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ã€‚è¯·åŸºäºä»¥ä¸‹æä¾›çš„èƒŒæ™¯ä¿¡æ¯ï¼ˆContextï¼‰æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚è¿™äº›èƒŒæ™¯ä¿¡æ¯å¯èƒ½åŒ…å«ç›¸å…³çš„çŸ¥è¯†æ–‡æ¡£æˆ–è¿‡å»çš„å†å²å¯¹è¯è®°å½•ã€‚å¦‚æœèƒŒæ™¯ä¿¡æ¯ä¸é—®é¢˜æ— å…³ï¼Œè¯·å¿½ç•¥å®ƒã€‚"</span>,

Â  <span class="hljs-string">"contextType"</span>: <span class="hljs-string">"å†å²å¯¹è¯è®°å½• (Historical Conversation Records)"</span>,

Â  <span class="hljs-string">"parsedConversations"</span>: [

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"User"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘ä»¬åˆšåˆšåœ¨ç©ä»€ä¹ˆæ¸¸æˆ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"Assistant"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ ¹æ®æˆ‘ä»¬çš„å¯¹è¯è®°å½•ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨ç©å…·ä½“çš„æ¸¸æˆå“¦ï½ <span class="hljs-subst">\n</span>ä½ ä¹‹å‰è¿ç»­å‘é€äº†å‡ æ¬¡â€œä½ å¥½â€å’Œâ€œ1â€ï¼Œæˆ‘éƒ½åœ¨çƒ­æƒ…å›åº”ä½ çš„æ‹›å‘¼å‘¢ï¼ğŸ˜Š <span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>å¦‚æœä½ æƒ³ç©ç‚¹ä»€ä¹ˆï¼Œæˆ‘å¯ä»¥é™ªä½ ç©çŒœè°œã€æˆè¯­æ¥é¾™ã€è„‘ç­‹æ€¥è½¬å¼¯ï¼Œæˆ–è€…ä½ æè®®å…¶ä»–å°æ¸¸æˆä¹Ÿå¯ä»¥ï½ æ¥è¯•è¯•å—ï¼Ÿ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"User"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘ä»¬ç©è¿‡äº’ç›¸è¯´1çš„æ¸¸æˆä¹ˆ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"Assistant"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ˜¯çš„ï¼Œæˆ‘ä»¬ä¹‹å‰ç©è¿‡è¿™ä¸ªæ¸¸æˆï¼ğŸ˜Š <span class="hljs-subst">\n</span>ä½ è®©æˆ‘åœ¨ä½ è¾“å…¥â€œ1â€æ—¶åªå›å¤â€œ1â€ï¼Œä¸åŠ å…¶ä»–å†…å®¹ã€‚ <span class="hljs-subst">\n</span>éœ€è¦å†ç©ä¸€æ¬¡å—ï¼Ÿ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">3</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"User"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½å•Š"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">3</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"Assistant"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½å•Šï¼ğŸ˜Š ä»Šå¤©çœ‹èµ·æ¥ç‰¹åˆ«æœ‰æ´»åŠ›å‘¢ï½ <span class="hljs-subst">\n</span>æœ‰ä»€ä¹ˆæƒ³èŠçš„ï¼Œæˆ–è€…éœ€è¦æˆ‘å¸®å¿™çš„å—ï¼Ÿ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">4</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"User"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">4</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"Assistant"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼ğŸ˜Š å¾ˆé«˜å…´è§åˆ°ä½ ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">5</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"User"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>

Â  Â  },

Â  Â  {

Â  Â  Â  <span class="hljs-string">"id"</span>: <span class="hljs-number">5</span>,

Â  Â  Â  <span class="hljs-string">"role"</span>: <span class="hljs-string">"Assistant"</span>,

Â  Â  Â  <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼ğŸ˜Š å¾ˆé«˜å…´è§åˆ°ä½ ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"</span>

Â  Â  }

Â  ],

Â  <span class="hljs-string">"summary"</span>: <span class="hljs-string">"è¿™æ®µæ•°æ®æ˜¯ RAG ç³»ç»Ÿç”¨äºå¢å¼º LLM ä¸Šä¸‹æ–‡çš„è°ƒè¯•ä¿¡æ¯ã€‚å®ƒåŒ…å«äº† AI çš„ç³»ç»ŸæŒ‡ä»¤å’Œäº”ç»„ç»“æ„åŒ–çš„ç”¨æˆ·/åŠ©æ‰‹å†å²å¯¹è¯è®°å½•ã€‚"</span>

}

</code></pre>
<p>è¦æ„å»º RAG ç³»ç»Ÿï¼Œæ— è®ºæŠ€æœ¯æ ˆå¦‚ä½•ï¼Œéƒ½å¿…é¡»éµå¾ªä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µã€‚æˆ‘ä»¬å°†ç»“åˆé¡¹ç›®æºç ï¼ˆ<code>rag/LlamaIndex</code>ï¼‰æ¥å…·ä½“åˆ†æå®ç°ç»†èŠ‚ã€‚</p>
<h3 data-id="heading-6">é¡¹ç›®æ¦‚è§ˆï¼šè¿™å¥— RAG åœ¨åšä»€ä¹ˆ</h3>
<p>è¿™å¥—ç³»ç»Ÿçš„ç›®æ ‡ä¸æ˜¯â€œæŠŠæœ€è¿‘ N æ¡å¯¹è¯å¡ç»™æ¨¡å‹â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li><strong>é•¿æœŸè®°å¿†</strong>ï¼šæŠŠæ¯ä¸€è½®å¯¹è¯ï¼ˆUser+Assistantï¼‰å†™å…¥å‘é‡åº“ï¼Œä¹‹åé€šè¿‡<strong>è¯­ä¹‰æ£€ç´¢</strong>å¬å›ç›¸å…³ç‰‡æ®µä½œä¸ºä¸Šä¸‹æ–‡ã€‚</li>
<li><strong>çŸ­æœŸè®°å¿†</strong>ï¼šä» SQLite å–æœ€è¿‘ <strong>5 æ¡</strong>ï¼ˆç”¨äºâ€œç»§ç»­â€â€œä¸Šé¢é‚£ä¸ªâ€è¿™ç±»æŒ‡ä»£ä¿æŒè¿è´¯ï¼‰ã€‚</li>
<li><strong>ç”Ÿæˆ</strong>ï¼šå°†â€œç³»ç»ŸæŒ‡ä»¤ + RAG å¬å›ä¸Šä¸‹æ–‡â€ç»„æˆ <code>systemPrompt</code>ï¼Œå†åŠ ä¸ŠçŸ­æœŸå†å²ä¸å½“å‰é—®é¢˜ï¼Œè°ƒç”¨ DeepSeek Chat ç”Ÿæˆå›ç­”ã€‚</li>
</ul>
<p>å…³é”®å…¥å£åœ¨ï¼š</p>
<ul>
<li>åç«¯ RAG æœåŠ¡ï¼š<code>rag/LlamaIndex/backend/services/ragService.js</code></li>
<li>åç«¯å¯¹è¯æ¥å£ï¼š<code>rag/LlamaIndex/backend/server.js</code></li>
<li>å‰ç«¯è°ƒè¯•è¾“å‡ºï¼š<code>rag/LlamaIndex/frontend/src/App.jsx</code></li>
</ul>
<hr/>
<h3 data-id="heading-7">RAG å®ç°å‰–æï¼šç¬¬ä¸€é˜¶æ®µï¼ˆçŸ¥è¯†åº“æ„å»ºï¼‰</h3>
<h4 data-id="heading-8">1. æ•°æ®æ‘„å–ï¼ˆLoadersï¼‰</h4>
<p>ç›®å‰çš„çŸ¥è¯†åº“æ¥æºæ˜¯ <code>backend/data/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¯åŠ¨æ—¶åŠ è½½ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">const</span> documents = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> SimpleDirectoryReader().loadData({
Â  directoryPath: path.<span class="hljs-keyword">join</span>(__dirname, <span class="hljs-string">"../data"</span>),
});
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:56-59</code></p>
<p>è¿™æ„å‘³ç€ï¼šåªè¦å¾€ <code>backend/data/</code> æ”¾å…¥æ–°æ–‡æ¡£ï¼ˆå¦‚ <code>.md</code>ï¼‰ï¼Œé‡å»ºç´¢å¼•æˆ–é¦–æ¬¡åˆå§‹åŒ–æ—¶å°±ä¼šè¢«çº³å…¥å‘é‡åº“ã€‚</p>
<hr/>
<h4 data-id="heading-9">2. åˆ‡ç‰‡é€»è¾‘ï¼ˆChunkingï¼‰â€”â€”å½“å‰å®ç°ä¸é‡è¦è¯´æ˜</h4>
<h5 data-id="heading-10">å½“å‰å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ</h5>
<p>å½“å‰<strong>æ²¡æœ‰æ˜¾å¼å†™åˆ‡ç‰‡å™¨</strong>ï¼ˆSplitterï¼‰ï¼Œè€Œæ˜¯ä¾èµ– LlamaIndex åœ¨ <code>VectorStoreIndex.fromDocuments(...)</code> å†…éƒ¨çš„é»˜è®¤åˆ‡ç‰‡ç­–ç•¥ï¼ˆé€šå¸¸æ˜¯å¥å­/æ®µè½ä¼˜å…ˆçš„ splitter + é»˜è®¤ chunkSize/overlapï¼‰ã€‚</p>
<p>çœŸå®è§¦å‘ç‚¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">index</span> = await VectorStoreIndex.fromDocuments(documents, {
Â  storageContext,
})<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:105-108</code></p>
<h5 data-id="heading-11">è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</h5>
<ul>
<li>
<p><strong>åˆ‡ç‰‡ç¡®å®å‘ç”Ÿäº†</strong>ï¼Œä½†å‚æ•°ç›®å‰ç”± LlamaIndex é»˜è®¤å€¼å†³å®šã€‚</p>
</li>
<li>
<p>ç°åœ¨ç³»ç»Ÿçš„â€œåˆ‡ç‰‡è´¨é‡â€ä¸»è¦å–å†³äºï¼š</p>
<ul>
<li>æ–‡æ¡£æœ¬èº«çš„ç»“æ„ï¼ˆæ˜¯å¦æœ‰æ¸…æ™°æ ‡é¢˜/æ®µè½ï¼‰</li>
<li>LlamaIndex é»˜è®¤ splitter ç­–ç•¥</li>
</ul>
</li>
</ul>
<h5 data-id="heading-12">åˆ‡ç‰‡ä¼˜åŒ–æ–¹æ¡ˆï¼ˆå»ºè®®æŒ‰é˜¶æ®µæ¼”è¿›ï¼‰</h5>
<ul>
<li><strong>ç»“æ„åŒ–åˆ‡ç‰‡</strong>ï¼ˆæ¨èä¼˜å…ˆçº§æœ€é«˜ï¼‰ï¼šæŒ‰æ ‡é¢˜ï¼ˆå¦‚ Markdown çš„ <code>#</code>/<code>##</code>ï¼‰ã€æ®µè½åˆ†éš”ç¬¦ã€ä»£ç å—è¾¹ç•Œåˆ‡ï¼Œå‡å°‘â€œè·¨ä¸»é¢˜æ··ç‰‡â€ã€‚</li>
<li><strong>Overlap å¢å¤§</strong>ï¼šå¦‚æœç»å¸¸å‡ºç°â€œå…³é”®å¥åˆšå¥½åˆ‡æ–­â€ï¼Œå¢åŠ  overlap å¯ä»¥å‡å°‘ä¿¡æ¯æ–­è£‚ã€‚</li>
<li><strong>è¯­ä¹‰åˆ‡ç‰‡</strong>ï¼šå¯¹é•¿æ–‡æ¡£å…ˆåšä¸»é¢˜è¾¹ç•Œè¯†åˆ«ï¼Œå†åˆ‡ chunkï¼Œå‡å°‘å™ªå£°å¬å›ã€‚</li>
<li><strong>ä¸“é—¨ä¸ºå¯¹è¯è®°å¿†è®¾è®¡åˆ‡ç‰‡</strong>ï¼šç°åœ¨æ˜¯ä¸€è½®å¯¹è¯å†™æˆä¸€ä¸ª Documentï¼ˆè§é•¿æœŸè®°å¿†éƒ¨åˆ†ï¼‰ï¼Œè¿™ç±»æ•°æ®å¤©ç„¶çŸ­è€Œå¯†ï¼Œé€šå¸¸ä¸éœ€è¦å†ç»†åˆ‡ï¼›ä½†å¦‚æœä¸€è½®å›ç­”å¾ˆé•¿ï¼Œå¯è€ƒè™‘æŠŠä¸€è½®å¯¹è¯æ‹†ä¸ºå¤šæ®µå¹¶å…±äº« metadataï¼ˆå¦‚åŒä¸€ <code>conversationId</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-13">3. å‘é‡åŒ–ï¼ˆEmbeddingï¼‰ä¸å­˜å‚¨ï¼ˆVector Storeï¼‰</h4>
<h5 data-id="heading-14">å‘é‡åŒ–æ¨¡å‹ï¼ˆEmbedding Modelï¼‰</h5>
<p>è¿™é‡Œ<strong>ä¸æ˜¯ DeepSeek Embedding API</strong>ï¼Œè€Œæ˜¯æœ¬åœ° HuggingFace Embeddingï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Settings.embedModel = <span class="hljs-keyword">new</span> <span class="hljs-built_in">HuggingFaceEmbedding</span>({
Â  modelType: <span class="hljs-string">"Xenova/all-MiniLM-L6-v2"</span>,
Â  quantized: <span class="hljs-literal">false</span>
});
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:40-43</code></p>
<p>åŒæ—¶ä¸ºç½‘ç»œç¯å¢ƒè®¾ç½®äº†é•œåƒï¼ˆç”¨äºæ¨¡å‹ä¸‹è½½ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">env.remoteHost</span> = <span class="hljs-string">"https://hf-mirror.com"</span><span class="hljs-comment">;</span>
<span class="hljs-attr">env.remoteTemplate</span> = <span class="hljs-string">"{model}/resolve/{revision}/{file}"</span><span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:7-8</code></p>
<h5 data-id="heading-15">å­˜å‚¨æ¨¡å¼ï¼šLocal / Qdrant</h5>
<p>é€šè¿‡ç¯å¢ƒå˜é‡åˆ‡æ¢ï¼š</p>
<ul>
<li><code>VECTOR_STORE_TYPE=local</code>ï¼šè½åœ¨æœ¬åœ° JSON</li>
<li><code>VECTOR_STORE_TYPE=qdrant</code>ï¼šè½åœ¨ Qdrantï¼ˆå¤±è´¥ä¼š fallback åˆ° localï¼‰</li>
</ul>
<p>é€»è¾‘ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:63-81</code></p>
<p>Local æ¨¡å¼ä¸‹çš„æŒä¹…åŒ–ç›®å½•æ˜¯ï¼š</p>
<ul>
<li><code>rag/LlamaIndex/backend/storage/</code></li>
</ul>
<h5 data-id="heading-16">å¦‚ä½•æŸ¥çœ‹â€œå‘é‡åŒ–å­˜å‚¨å†…å®¹â€</h5>
<p>åœ¨ Local æ¨¡å¼ä¸‹ï¼Œæœ€ç›´æ¥å¯è¯»çš„æ–‡ä»¶æ˜¯ï¼š</p>
<ul>
<li><code>backend/storage/doc_store.json</code>ï¼šåŸå§‹æ–‡æœ¬ï¼ˆåˆ‡ç‰‡/å¯¹è¯è®°å¿†ï¼‰å†…å®¹</li>
<li><code>backend/storage/index_store.json</code>ï¼šç´¢å¼•ç»“æ„ä¿¡æ¯</li>
<li><code>backend/storage/vector_store_default.json</code>ï¼ˆæˆ–ç±»ä¼¼ï¼‰ï¼šå‘é‡æœ¬ä½“ï¼ˆå¤§é‡æ•°å€¼ï¼Œä¸å¤ªé€‚åˆäººè¯»ï¼Œä½†å¯ä»¥ç¡®è®¤å­˜åœ¨ä¸è§„æ¨¡ï¼‰</li>
</ul>
<p>å†™å…¥æŒä¹…åŒ–å‘ç”Ÿåœ¨é•¿æœŸè®°å¿†å†™å…¥æ—¶ï¼ˆè§åæ–‡ï¼‰ï¼Œä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:159-190</code></p>
<hr/>
<h3 data-id="heading-17">RAG å®ç°å‰–æï¼šç¬¬äºŒé˜¶æ®µï¼ˆè¿è¡Œæ—¶æ£€ç´¢ï¼‰</h3>
<p>å½“ç”¨æˆ·æ¯æ¬¡æé—®æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡å‘é‡å¬å›ã€‚</p>
<h4 data-id="heading-18">1. å¬å›é€»è¾‘ï¼šTopK ç›¸ä¼¼æ£€ç´¢</h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">retriever</span> = index.asRetriever({ similarityTopK: <span class="hljs-number">5</span> })<span class="hljs-comment">;</span>
const <span class="hljs-attr">nodes</span> = await retriever.retrieve(queryText)<span class="hljs-comment">;</span>
return nodes.map(<span class="hljs-attr">node</span> =&gt; node.node.text).join(<span class="hljs-string">"\n\n"</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:135-141</code></p>
<p>è¿™é‡Œçš„å…³é”®ç‚¹ï¼š</p>
<ul>
<li><strong>TopK=5</strong>ï¼šæ¯æ¬¡æœ€å¤šå– 5 æ¡â€œæœ€ç›¸è¿‘ç‰‡æ®µâ€</li>
<li>è¿”å›çš„æ˜¯çº¯æ–‡æœ¬æ‹¼æ¥ï¼Œä½œä¸ºåç»­ System Prompt çš„â€œèƒŒæ™¯ä¿¡æ¯â€</li>
</ul>
<h4 data-id="heading-19">2. å¬å›çš„æ•°æ®æ¥æºï¼šçŸ¥è¯†åº“ + å†å²å¯¹è¯</h4>
<p>å› ä¸ºæŠŠâ€œå†å²å¯¹è¯â€ä¹Ÿå†™è¿›äº†åŒä¸€ä¸ªå‘é‡ç´¢å¼•ï¼ˆè§é•¿æœŸè®°å¿†å†™å…¥ï¼‰ï¼Œæ‰€ä»¥æ£€ç´¢ç»“æœå¯èƒ½æ··åˆï¼š</p>
<ul>
<li><code>backend/data/</code> é‡Œçš„çŸ¥è¯†æ–‡æ¡£åˆ‡ç‰‡</li>
<li>ç”¨æˆ·å†å²å¯¹è¯ï¼ˆ<code>User:...\nAssistant:...</code>ï¼‰</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ åœ¨æµè§ˆå™¨ Console çœ‹åˆ°çš„ <code>systemPrompt</code> èƒŒæ™¯ä¿¡æ¯é‡Œä¼šå‡ºç°å¾ˆå¤šè½®å¯¹è¯æ–‡æœ¬ã€‚</p>
<hr/>
<h3 data-id="heading-20">RAG å®ç°å‰–æï¼šç¬¬ä¸‰é˜¶æ®µï¼ˆç”Ÿæˆå›å¤ï¼‰</h3>
<h4 data-id="heading-21">1. å¢å¼ºæç¤ºè¯ï¼ˆSystem Promptï¼‰çš„æ„é€ è§„åˆ™</h4>
<p>éæµå¼æ¥å£ <code>/api/chat</code> çš„ System Prompt ç»„è£…ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">systemPrompt</span> = <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ã€‚"</span><span class="hljs-comment">;</span>
if (context) {
Â  systemPrompt += `è¯·åŸºäºä»¥ä¸‹æä¾›çš„èƒŒæ™¯ä¿¡æ¯ï¼ˆContextï¼‰æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚è¿™äº›èƒŒæ™¯ä¿¡æ¯å¯èƒ½åŒ…å«ç›¸å…³çš„çŸ¥è¯†æ–‡æ¡£æˆ–è¿‡å»çš„å†å²å¯¹è¯è®°å½•ã€‚å¦‚æœèƒŒæ™¯ä¿¡æ¯ä¸é—®é¢˜æ— å…³ï¼Œè¯·å¿½ç•¥å®ƒã€‚\nèƒŒæ™¯ä¿¡æ¯ï¼š\n${context}`<span class="hljs-comment">;</span>
}
const <span class="hljs-attr">systemMessage</span> = { role: <span class="hljs-string">'system'</span>, content: systemPrompt }<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/server.js:100-112</code></p>
<p><strong>ç»„æˆç»“è®ºï¼ˆéå¸¸å…³é”®ï¼‰</strong> ï¼š</p>
<ul>
<li><code>systemPrompt</code> = â€œåŸºç¡€ç³»ç»ŸæŒ‡ä»¤â€ + â€œRAG æ£€ç´¢å‡ºæ¥çš„ contextï¼ˆå¯ä¸ºç©ºï¼‰â€</li>
<li><code>systemPrompt</code> <strong>ä¸åŒ…å«</strong> SQLite çš„æœ€è¿‘ 5 æ¡å¯¹è¯ï¼Œå®ƒä»¬æ˜¯ä½œä¸ºå•ç‹¬ message æ’å…¥çš„ï¼ˆä¸‹ä¸€æ®µï¼‰</li>
</ul>
<h4 data-id="heading-22">2. æœ€ç»ˆå‘é€ç»™æ¨¡å‹çš„æ¶ˆæ¯åˆ—è¡¨ç»„æˆ</h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">dbHistory</span> = chatHistoryService.getHistory(sessionId, <span class="hljs-number">5</span>)<span class="hljs-comment">;</span>

const <span class="hljs-attr">finalMessages</span> = [
Â  systemMessage,
Â  ...dbHistory,
Â  { role: <span class="hljs-string">'user'</span>, content: lastMsg.content }
]<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/server.js:90-118</code></p>
<p>æ‰€ä»¥é¡¹ç›®ä¸­â€œå–‚ç»™æ¨¡å‹çš„ä¸Šä¸‹æ–‡â€æ¥è‡ªä¸¤æ¡ç®¡çº¿ï¼š</p>
<ul>
<li><strong>é•¿æœŸè®°å¿†ï¼ˆRAGï¼‰</strong> ï¼šè¿› <code>systemPrompt</code></li>
<li><strong>çŸ­æœŸè®°å¿†ï¼ˆSQLite æœ€è¿‘ 5 æ¡ï¼‰</strong> ï¼šä»¥ <code>messages</code> æ•°ç»„å½¢å¼é€å…¥æ¨¡å‹ï¼ˆæ›´æ¥è¿‘â€œå¯¹è¯ä¸Šä¸‹æ–‡â€ï¼‰</li>
</ul>
<h4 data-id="heading-23">3. å°†ç³»ç»Ÿæç¤ºè¯æš´éœ²ç»™æµè§ˆå™¨ Console</h4>
<h5 data-id="heading-24">éæµå¼ï¼šç›´æ¥å›ä¼ ç»™å‰ç«¯</h5>
<pre><code class="hljs language-php" lang="php">res.<span class="hljs-title function_ invoke__">json</span>({
Â  <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>,
Â  <span class="hljs-attr">content</span>: responseContent,
Â  <span class="hljs-attr">systemPrompt</span>: systemPrompt
});
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/server.js:136-142</code></p>
<p>å‰ç«¯æ‰“å°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"ğŸ” [DeepSeek Chat] RAG Debug Info"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"User Prompt:"</span>, ...);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"System Prompt (with RAG Context):"</span>, response.<span class="hljs-property">data</span>.<span class="hljs-property">systemPrompt</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/frontend/src/App.jsx:60-85</code></p>
<h5 data-id="heading-25">æµå¼ï¼šåœ¨ SSE å¼€å¤´å…ˆå‘ä¸€æ¡ debug åŒ…</h5>
<pre><code class="hljs language-typescript" lang="typescript">res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-keyword">type</span>: <span class="hljs-string">'debug'</span>, systemPrompt })}</span>\n\n`</span>);
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/server.js:198-213</code></p>
<p>å‰ç«¯è§£æï¼š</p>
<pre><code class="hljs language-ini" lang="ini">if (<span class="hljs-attr">parsed.type</span> === <span class="hljs-string">'debug'</span> &amp;&amp; parsed.systemPrompt) {
Â  console.group("ğŸ” <span class="hljs-section">[DeepSeek Chat Stream]</span> RAG Debug Info")<span class="hljs-comment">;</span>
Â  console.log("User Prompt:", ...)<span class="hljs-comment">;</span>
Â  console.log("System Prompt (with RAG Context):", parsed.systemPrompt)<span class="hljs-comment">;</span>
Â  console.groupEnd()<span class="hljs-comment">;</span>
Â  continue<span class="hljs-comment">;</span>
}
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/frontend/src/App.jsx:127-137</code></p>
<p>è¿™å®ç°äº†è¦çš„ï¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°å®Œæ•´è§‚å¯Ÿâ€œç³»ç»Ÿæç¤ºè¯ + ç”¨æˆ·æç¤ºè¯â€ã€‚</p>
<hr/>
<h3 data-id="heading-26">é•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰åœ¨æ‚¨é¡¹ç›®é‡Œæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h3>
<h4 data-id="heading-27">1. å†™å…¥è§„åˆ™ï¼šæ¯è½®å¯¹è¯ç»“æŸå°±å†™å…¥å‘é‡åº“</h4>
<p>å½“ <code>/api/chat</code> æ‹¿åˆ°æ¨¡å‹å›ç­”åï¼Œä¼šè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">await</span> ragService.insertChatLog(lastMsg.content, responseContent);
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/server.js:133-135</code></p>
<h4 data-id="heading-28">2. å†™å…¥å†…å®¹æ ¼å¼ï¼šUser + Assistant åˆå¹¶æˆä¸€ä¸ª Document</h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">text</span> = `User: <span class="hljs-variable">${userMsg}</span>\nAssistant: <span class="hljs-variable">${assistantMsg}</span>`<span class="hljs-comment">;</span>
const <span class="hljs-attr">doc</span> = new Document({ text, metadata: { type: <span class="hljs-string">'conversation'</span>, timestamp: ... }})<span class="hljs-comment">;</span>
await index.insert(doc)<span class="hljs-comment">;</span>
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:148-158</code></p>
<h4 data-id="heading-29">3. æŒä¹…åŒ–è§„åˆ™ï¼šLocal æ¨¡å¼å†™åˆ° storage/*.json</h4>
<p>æ’å…¥åä¼šæŒä¹…åŒ–ï¼ˆLocalï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">await storageContext<span class="hljs-selector-class">.docStore</span><span class="hljs-selector-class">.persist</span>(...doc_store.json)
await storageContext<span class="hljs-selector-class">.indexStore</span><span class="hljs-selector-class">.persist</span>(...index_store.json)
for (...) await store<span class="hljs-selector-class">.persist</span>(...vector_store_${key}.json)
</code></pre>
<p>ä½ç½®ï¼š<code>rag/LlamaIndex/backend/services/ragService.js:159-190</code></p>
<hr/>
<h3 data-id="heading-30">ä¸â€œæ ‡å‡†ä¸‰é˜¶æ®µ RAGâ€ç›¸æ¯”ï¼šé¡¹ç›®æœ‰å“ªäº›å…³é”®å·®å¼‚ï¼Ÿ</h3>
<ul>
<li><strong>Embedding ä¸æ˜¯ DeepSeek Embedding API</strong>ï¼šæ˜¯æœ¬åœ° <code>HuggingFaceEmbedding</code>ï¼ˆæ›´ç¨³å®šã€æˆæœ¬ä½ï¼Œä½†æ¨¡å‹é€‰æ‹©éœ€è¦è‡ªå·±è¯„ä¼°å‡†ç¡®ç‡ï¼‰ï¼Œè§ <code>ragService.js:40-43</code>ã€‚</li>
<li><strong>Prompt ä¸ä»…æœ‰ RAG Context</strong>ï¼šé¢å¤–æ³¨å…¥äº† SQLite æœ€è¿‘ 5 æ¡çŸ­æœŸå†å²ï¼ˆä½œä¸º messagesï¼‰ï¼Œè§ <code>server.js:90-118</code>ã€‚</li>
<li><strong>é•¿æœŸè®°å¿†ä¸æ˜¯â€œæ‹‰å†å²è®°å½• N æ¡â€</strong> ï¼šæ˜¯æŠŠå¯¹è¯å†™å…¥å‘é‡åº“ï¼Œåç»­é ç›¸ä¼¼æ£€ç´¢å¬å›ï¼Œè§ <code>insertChatLog</code> ä¸ <code>retrieveContext</code>ã€‚</li>
<li><strong>å¯è§‚æµ‹æ€§åŠ å¼º</strong>ï¼šç³»ç»Ÿæç¤ºè¯ä¼šåŒæ—¶åœ¨åç«¯ç»ˆç«¯æ‰“å°ï¼ˆ<code>server.js:105-109</code>/<code>183-187</code>ï¼‰å¹¶åœ¨æµè§ˆå™¨ Console æ‰“å°ï¼ˆ<code>App.jsx:70-77</code>/<code>129-137</code>ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-31">æ€»ç»“</h2>
<p>OKï¼Œå°±å†™åˆ°è¿™å„¿äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nettyï¼ˆ13ï¼‰Nettyä¸­çš„äº‹ä»¶å’Œå›è°ƒæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7584071941025693711</link>    <guid>https://juejin.cn/post/7584071941025693711</guid>    <pubDate>2025-12-16T12:19:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584071941025693711" data-draft-id="7584286241488093224" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nettyï¼ˆ13ï¼‰Nettyä¸­çš„äº‹ä»¶å’Œå›è°ƒæœºåˆ¶"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T12:19:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nettyï¼ˆ13ï¼‰Nettyä¸­çš„äº‹ä»¶å’Œå›è°ƒæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T12:19:46.000Z" title="Tue Dec 16 2025 12:19:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Nettyä¸­ï¼Œäº‹ä»¶å’Œå›è°ƒæœºåˆ¶æ˜¯å®ç°å¼‚æ­¥å’Œäº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚Nettyä½¿ç”¨ChannelPipelineå’ŒChannelHandleræ¥å¤„ç†äº‹ä»¶å’Œå›è°ƒã€‚</p>
<ol>
<li>äº‹ä»¶ï¼š
Nettyä¸­çš„äº‹ä»¶åŒ…æ‹¬è¿æ¥å»ºç«‹ã€æ•°æ®æ¥æ”¶ã€æ•°æ®å‘é€ã€è¿æ¥å…³é—­ç­‰ã€‚åœ¨å¤„ç†è¿™äº›äº‹ä»¶æ—¶ï¼Œé€šå¸¸éœ€è¦å®ç°ChannelHandleræ¥å£ï¼Œå¹¶é‡å†™ç›¸åº”çš„æ–¹æ³•æ¥å¤„ç†äº‹ä»¶ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// è¿æ¥å»ºç«‹äº‹ä»¶</span>
        System.out.println(<span class="hljs-string">"Connection established"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// æ•°æ®æ¥æ”¶äº‹ä»¶</span>
        System.out.println(<span class="hljs-string">"Received data: "</span> + msg);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelReadComplete</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// æ•°æ®æ¥æ”¶å®Œæˆäº‹ä»¶</span>
        System.out.println(<span class="hljs-string">"Data reception complete"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// å¼‚å¸¸äº‹ä»¶</span>
        System.out.println(<span class="hljs-string">"Exception caught: "</span> + cause.getMessage());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelInactive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// è¿æ¥å…³é—­äº‹ä»¶</span>
        System.out.println(<span class="hljs-string">"Connection closed"</span>);
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ChannelHandlerç±»MyHandlerï¼Œå¹¶é‡å†™äº†channelActive()ã€channelRead()ã€channelReadComplete()ã€exceptionCaught()å’ŒchannelInactive()æ–¹æ³•æ¥å¤„ç†è¿æ¥å»ºç«‹ã€æ•°æ®æ¥æ”¶ã€æ•°æ®æ¥æ”¶å®Œæˆã€å¼‚å¸¸å’Œè¿æ¥å…³é—­äº‹ä»¶ã€‚</p>
<ol start="2">
<li>å›è°ƒï¼š
Nettyä¸­çš„å›è°ƒæœºåˆ¶é€šå¸¸ç”¨äºå¼‚æ­¥æ“ä½œçš„ç»“æœé€šçŸ¥ã€‚å½“æŸä¸ªå¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œä¼šè°ƒç”¨ç›¸åº”çš„å›è°ƒæ–¹æ³•æ¥å¤„ç†æ“ä½œçš„ç»“æœã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> io.netty.channel.ChannelFuture;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelFutureListener;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// å¼‚æ­¥æ“ä½œ</span>
        <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">future</span> <span class="hljs-operator">=</span> ctx.writeAndFlush(<span class="hljs-string">"Hello, Netty!"</span>);

        <span class="hljs-comment">// æ³¨å†Œå›è°ƒ</span>
        future.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelFutureListener</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationComplete</span><span class="hljs-params">(ChannelFuture future)</span> <span class="hljs-keyword">throws</span> Exception {
                <span class="hljs-keyword">if</span> (future.isSuccess()) {
                    System.out.println(<span class="hljs-string">"Data sent successfully"</span>);
                } <span class="hljs-keyword">else</span> {
                    System.out.println(<span class="hljs-string">"Failed to send data"</span>);
                }
            }
        });
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨channelActive()æ–¹æ³•ä¸­æ‰§è¡Œäº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œctx.writeAndFlush()ï¼Œå¹¶é€šè¿‡addListener()æ–¹æ³•æ³¨å†Œäº†ä¸€ä¸ªå›è°ƒç›‘å¬å™¨ChannelFutureListenerã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œä¼šè°ƒç”¨å›è°ƒæ–¹æ³•operationComplete()æ¥å¤„ç†æ“ä½œçš„ç»“æœã€‚</p>
<p>é€šè¿‡äº‹ä»¶å’Œå›è°ƒæœºåˆ¶ï¼ŒNettyèƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å„ç§ç½‘ç»œäº‹ä»¶å’Œå¼‚æ­¥æ“ä½œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nettyï¼ˆ14ï¼‰å¦‚ä½•å¤„ç†Nettyä¸­çš„å¼‚å¸¸å’Œé”™è¯¯ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584266184882241570</link>    <guid>https://juejin.cn/post/7584266184882241570</guid>    <pubDate>2025-12-16T12:21:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584266184882241570" data-draft-id="7584243498528260096" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nettyï¼ˆ14ï¼‰å¦‚ä½•å¤„ç†Nettyä¸­çš„å¼‚å¸¸å’Œé”™è¯¯ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T12:21:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nettyï¼ˆ14ï¼‰å¦‚ä½•å¤„ç†Nettyä¸­çš„å¼‚å¸¸å’Œé”™è¯¯ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T12:21:05.000Z" title="Tue Dec 16 2025 12:21:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Nettyä¸­ï¼Œå¯ä»¥é€šè¿‡å®ç°ChannelHandlerçš„exceptionCaught()æ–¹æ³•æ¥å¤„ç†å¼‚å¸¸å’Œé”™è¯¯ã€‚è¯¥æ–¹æ³•ä¼šåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶è¢«è°ƒç”¨ï¼Œå¯ä»¥åœ¨å…¶ä¸­è¿›è¡Œå¼‚å¸¸å¤„ç†å’Œé”™è¯¯å¤„ç†é€»è¾‘ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// å¼‚å¸¸å¤„ç†é€»è¾‘</span>
        System.out.println(<span class="hljs-string">"Exception caught: "</span> + cause.getMessage());

        <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå…³é—­è¿æ¥</span>
        ctx.close();
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ChannelHandlerç±»MyHandlerï¼Œå¹¶é‡å†™äº†exceptionCaught()æ–¹æ³•æ¥å¤„ç†å¼‚å¸¸ã€‚åœ¨å¼‚å¸¸å¤„ç†é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œæ¯”å¦‚æ‰“å°å¼‚å¸¸ä¿¡æ¯ã€è®°å½•æ—¥å¿—ã€å‘é€é”™è¯¯å“åº”ç­‰ã€‚</p>
<p>åœ¨å¼‚å¸¸å¤„ç†é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©å…³é—­è¿æ¥æ¥ç»ˆæ­¢ä¸å®¢æˆ·ç«¯çš„é€šä¿¡ã€‚é€šè¿‡è°ƒç”¨ctx.close()æ–¹æ³•ï¼Œå¯ä»¥ä¸»åŠ¨å…³é—­ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œé‡Šæ”¾ç›¸å…³çš„èµ„æºã€‚</p>
<p>å¦å¤–ï¼Œä¸ºäº†æ›´å¥½åœ°æ•è·å¼‚å¸¸å’Œé”™è¯¯ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ChannelFutureçš„addListener()æ–¹æ³•æ¥æ³¨å†Œå›è°ƒç›‘å¬å™¨ï¼Œä»¥ä¾¿åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶å¤„ç†å¼‚å¸¸ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> io.netty.channel.ChannelFuture;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelFutureListener;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// å¼‚æ­¥æ“ä½œ</span>
        <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">future</span> <span class="hljs-operator">=</span> ctx.writeAndFlush(<span class="hljs-string">"Hello, Netty!"</span>);

        <span class="hljs-comment">// æ³¨å†Œå›è°ƒ</span>
        future.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelFutureListener</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationComplete</span><span class="hljs-params">(ChannelFuture future)</span> <span class="hljs-keyword">throws</span> Exception {
                <span class="hljs-keyword">if</span> (future.isSuccess()) {
                    System.out.println(<span class="hljs-string">"Data sent successfully"</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// å¼‚å¸¸å¤„ç†é€»è¾‘</span>
                    System.out.println(<span class="hljs-string">"Failed to send data: "</span> + future.cause().getMessage());

                    <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå…³é—­è¿æ¥</span>
                    future.channel().close();
                }
            }
        });
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨channelActive()æ–¹æ³•ä¸­æ‰§è¡Œäº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œctx.writeAndFlush()ï¼Œå¹¶é€šè¿‡addListener()æ–¹æ³•æ³¨å†Œäº†ä¸€ä¸ªå›è°ƒç›‘å¬å™¨ChannelFutureListenerã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œä¼šè°ƒç”¨å›è°ƒæ–¹æ³•operationComplete()æ¥å¤„ç†æ“ä½œçš„ç»“æœã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›è°ƒæ–¹æ³•ä¸­å¤„ç†å¼‚å¸¸ï¼Œå¹¶å…³é—­è¿æ¥ã€‚</p>
<p>é€šè¿‡åˆç†å¤„ç†å¼‚å¸¸å’Œé”™è¯¯ï¼Œå¯ä»¥æé«˜Nettyåº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JUnit 5 ä¸­çš„ @ClassTemplate å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7584295332340252735</link>    <guid>https://juejin.cn/post/7584295332340252735</guid>    <pubDate>2025-12-16T12:52:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584295332340252735" data-draft-id="7584289165754105910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JUnit 5 ä¸­çš„ @ClassTemplate å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="Java,åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T12:52:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºçŒ¿DD"/> <meta itemprop="url" content="https://juejin.cn/user/131597123993358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JUnit 5 ä¸­çš„ @ClassTemplate å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597123993358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºçŒ¿DD
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T12:52:01.000Z" title="Tue Dec 16 2025 12:52:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“ä½ åœ¨æœ¬åœ°ã€æµ‹è¯•ç¯å¢ƒå’Œ CI ä¸­è·‘åŒä¸€ç»„æµ‹è¯•æ—¶ï¼Œæ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„å›°æƒ‘ï¼šåŒä¸€æ®µä¸šåŠ¡é€»è¾‘åœ¨ä¸åŒé…ç½®ã€ä¸åŒ Locale ä¸‹çš„è¡¨ç°ä¸å°½ç›¸åŒï¼Œä½†ä½ åˆä¸æƒ³ä¸ºæ¯ç§åœºæ™¯å¤åˆ¶ä¸€å †å‡ ä¹ä¸€æ ·çš„æµ‹è¯•ç±»ï¼Ÿå¦‚æœæŠŠæ‰€æœ‰åˆ†æ”¯é€»è¾‘éƒ½å¡è¿›ä¸€ä¸ªæµ‹è¯•æ–¹æ³•é‡Œï¼Œåˆä¼šè®©æµ‹è¯•å˜å¾—è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ã€‚æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥è®©æµ‹è¯•ä»£ç ä¿æŒç®€æ´ï¼Œå´èƒ½ä¼˜é›…åœ°åœ¨å¤šç§â€œç¯å¢ƒåˆ‡é¢â€ä¸‹é‡å¤æ‰§è¡Œæ•´å¥—æµ‹è¯•ï¼Ÿè¿™æ­£æ˜¯ JUnit 5 ä¸­ <code>@ClassTemplate</code> æƒ³è¦è§£å†³çš„é—®é¢˜ã€‚æœ¬æ–‡å°±ä»è¿™ä¸ªç°å®åœºæ™¯å‡ºå‘ï¼Œå¸¦ä½ æ·±å…¥ç†è§£ Class Template çš„æ‰§è¡Œæœºåˆ¶ã€æ‰©å±•ç‚¹è®¾è®¡ä»¥åŠä¸€ä¸ªå®ç”¨çš„å¤š Locale ç¤ºä¾‹ã€‚</p>
<h2 data-id="heading-0">1. å¼•è¨€</h2>
<p>æœ‰äº›æµ‹è¯•éœ€è¦åœ¨ä¸åŒçš„ç¯å¢ƒä¸­è¿è¡Œã€‚<code>@ClassTemplate</code> æ³¨è§£å¯ä»¥å¸®æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ï¼šå®ƒä¼šè®©æ•´ä¸ªæµ‹è¯•ç±»åœ¨å¤šç§ä¸åŒé…ç½®ä¸‹è¢«é‡å¤æ‰§è¡Œã€‚</p>
<p>åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå…ˆè®¨è®ºä¸ºä»€ä¹ˆä¼šæœ‰â€œç±»æ¨¡æ¿ï¼ˆClass Templateï¼‰â€è¿™ç§æœºåˆ¶ï¼Œä»¥åŠ JUnit æ˜¯å¦‚ä½•æ‰§è¡Œå®ƒä»¬çš„ï¼›æ¥ç€ä¼šçœ‹çœ‹å®ƒåœ¨æ•´ä½“æ‰§è¡Œæ¨¡å‹ä¸­çš„ä½ç½®ï¼›æœ€åï¼Œæˆ‘ä»¬ä¼šæ‹†è§£ç±»æ¨¡æ¿çš„ç»“æ„ã€èƒŒåçš„æä¾›è€…ï¼ˆproviderï¼‰ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç¤ºä¾‹ï¼Œåœ¨ä¸å¤åˆ¶ä»»ä½•æµ‹è¯•ä»£ç çš„å‰æä¸‹ï¼Œè®©åŒä¸€ä¸ªæµ‹è¯•ç±»åœ¨å¤šä¸ª Locale ç¯å¢ƒä¸‹è¿è¡Œã€‚</p>
<h2 data-id="heading-1">2. ä»€ä¹ˆæ˜¯ <code>@ClassTemplate</code></h2>
<p>ç®€å•å›é¡¾ä¸€ä¸‹ï¼Œ<code>@ClassTemplate</code> ä¼šæŠŠä¸€ä¸ªæµ‹è¯•ç±»å˜æˆâ€œæ¨¡æ¿ç±»â€ï¼Œè®©å®ƒæŒ‰ç…§ä¸åŒçš„è°ƒç”¨ä¸Šä¸‹æ–‡ï¼ˆinvocation contextï¼‰å¤šæ¬¡æ‰§è¡Œã€‚æä¾›è€…è´Ÿè´£æä¾›è¿™äº›ä¸Šä¸‹æ–‡ï¼Œæ¯ä¸€ä¸ªä¸Šä¸‹æ–‡éƒ½ä¼šè§¦å‘ä¸€æ¬¡ç‹¬ç«‹çš„æ‰§è¡Œï¼Œæ‹¥æœ‰å„è‡ªçš„ç”Ÿå‘½å‘¨æœŸå’Œæ‰©å±•ã€‚</p>
<p>åœ¨å®è·µä¸­ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥<strong>åœ¨ä¸åŒç¯å¢ƒæˆ–é…ç½®ä¸‹å¤šæ¬¡è¿è¡ŒåŒä¸€ä¸ªæµ‹è¯•ç±»ï¼ŒåŒæ—¶ä¿æŒæµ‹è¯•ä»£ç æœ¬èº«çš„ç®€å•æ€§</strong>ã€‚æˆ‘ä»¬å¯ä»¥æ”¹å˜è¿è¡Œæ—¶çš„ç¯å¢ƒé…ç½®ï¼Œè€Œä¸ç”¨å¤åˆ¶æµ‹è¯•ç±»ï¼Œæˆ–è€…åœ¨å•ä¸ªæµ‹è¯•æ–¹æ³•é‡ŒåŠ å…¥å¤æ‚çš„åˆ†æ”¯é€»è¾‘ã€‚</p>
<h3 data-id="heading-2">2.1. Class Template å¦‚ä½•æ‰§è¡Œ</h3>
<p>ä¸€ä¸ªç±»æ¨¡æ¿ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<strong>æ¨¡æ¿ç±»æœ¬èº«ï¼Œä»¥åŠä¸ºå…¶æä¾›è°ƒç”¨ä¸Šä¸‹æ–‡çš„æä¾›è€…</strong>ã€‚æ¨¡æ¿ç±»åœ¨å¤–è§‚ä¸Šå°±åƒä¸€ä¸ªæ™®é€šçš„ JUnit æµ‹è¯•ç±»ï¼Œä½† <code>@ClassTemplate</code> æ³¨è§£ä¼šå‘Šè¯‰ JUnit ä¸è¦ç›´æ¥è¿è¡Œå®ƒï¼Œè€Œæ˜¯ç­‰å¾…æä¾›è€…æ¥å®šä¹‰è¯¥ç±»çš„å…·ä½“æ‰§è¡Œæ–¹å¼ã€‚</p>
<p>ä¸€æ—¦ JUnit è¯†åˆ«å‡ºæŸä¸ªç±»æ˜¯ç±»æ¨¡æ¿ï¼Œæä¾›è€…å°±ä¼šè¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä¸Šä¸‹æ–‡ï¼Œæ¯ä¸ªä¸Šä¸‹æ–‡éƒ½å®šä¹‰äº†ä¸€æ¬¡å®Œæ•´çš„æ‰§è¡Œã€‚å¯¹äºæ¯ä¸ªä¸Šä¸‹æ–‡ï¼Œ<strong>JUnit éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•å®ä¾‹ï¼Œåº”ç”¨å¯¹åº”çš„æ‰©å±•ï¼Œå¹¶æ‰§è¡Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæµ‹è¯•æ–¹æ³•</strong>ã€‚è¿™æ ·ï¼Œæµ‹è¯•ç±»å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘æœ¬èº«ï¼Œè€Œç”±æä¾›è€…æ¥å¡‘é€ è¿è¡Œæ—¶ç¯å¢ƒã€‚</p>
<h3 data-id="heading-3">2.2. Class Template ä¸ Method Template å¯¹æ¯”</h3>
<p>åœ¨ç»§ç»­ä¹‹å‰ï¼Œå€¼å¾—å…ˆå¯¹æ¯”ä¸€ä¸‹ç±»æ¨¡æ¿å’Œæ–¹æ³•æ¨¡æ¿ï¼ˆmethod templateï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚ä¸¤è€…éƒ½æ”¯æŒé‡å¤æ‰§è¡Œï¼Œä½†å…³æ³¨çš„å±‚çº§ä¸åŒã€‚æ–¹æ³•æ¨¡æ¿ä¼šåœ¨ä¸åŒè¾“å…¥ä¸‹é‡å¤æ‰§è¡Œ<strong>åŒä¸€ä¸ªæµ‹è¯•æ–¹æ³•</strong>ï¼›è€Œç±»æ¨¡æ¿åˆ™ä¼šé‡å¤æ‰§è¡Œ<strong>æ•´ä¸ªæµ‹è¯•ç±»</strong>ï¼ŒåŒ…æ‹¬å®ƒçš„ç”Ÿå‘½å‘¨æœŸå›è°ƒã€æ‰©å±•ä»¥åŠé…ç½®ã€‚</p>
<p>å› æ­¤ï¼Œå½“å˜åŒ–ç‚¹ä¸»è¦ä½“ç°åœ¨æ•´ä½“ç¯å¢ƒå±‚é¢â€”â€”ä¾‹å¦‚ Localeã€ç‰¹æ€§å¼€å…³æˆ–ç³»ç»Ÿçº§é…ç½®â€”â€”è€Œä¸æ˜¯å•ä¸ªæ–¹æ³•å‚æ•°æ—¶ï¼Œ<strong>ç±»æ¨¡æ¿ä¼šæ›´åŠ åˆé€‚</strong>ã€‚</p>
<h2 data-id="heading-4">3. è°ƒç”¨ä¸Šä¸‹æ–‡æä¾›è€…</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹â€œè°ƒç”¨ä¸Šä¸‹æ–‡æä¾›è€…ï¼ˆinvocation context providerï¼‰â€ã€‚<strong>è¿™ä¸ªæ‰©å±•è´Ÿè´£ä¸ºç±»æ¨¡æ¿æä¾›æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ã€‚å®ƒéœ€è¦å®ç° <code>ClassTemplateInvocationContextProvider</code> æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œç”¨æ¥å†³å®šæä¾›è€…å¦‚ä½•å‚ä¸æµ‹è¯•æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«æ¥çœ‹ã€‚</p>
<h3 data-id="heading-5">3.1. <code>supportsClassTemplate()</code> æ–¹æ³•</h3>
<p>åœ¨ JUnit ä½¿ç”¨æŸä¸ªæä¾›è€…ä¹‹å‰ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥è¯¥æä¾›è€…æ˜¯å¦é€‚ç”¨äºå½“å‰æ­£åœ¨å‘ç°çš„æµ‹è¯•ç±»ã€‚è¿™ä¸ªæ£€æŸ¥å°±æ˜¯é€šè¿‡ <code>supportsClassTemplate()</code> æ–¹æ³•å®Œæˆçš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supportsClassTemplate</span><span class="hljs-params">(ExtensionContext context)</span> {
    <span class="hljs-keyword">return</span> context.getTestClass()
        .map(aClass -&gt; aClass.isAnnotationPresent(ClassTemplate.class))
        .orElse(<span class="hljs-literal">false</span>);
}
</code></pre>
<p>JUnit ä¼šå¯¹æ¯ä¸€ä¸ªå·²æ³¨å†Œçš„æä¾›è€…è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚åªæœ‰è¿”å› <code>true</code> çš„æä¾›è€…æ‰ä¼šå¯¹å½“å‰ç±»æ¨¡æ¿ç”Ÿæ•ˆã€‚é€šè¿‡è¿™ç§æœºåˆ¶ï¼ŒJUnit å¯ä»¥<strong>é¿å…æä¾›è€…è¢«æ„å¤–æ¿€æ´»ï¼Œé¿å…åœ¨æ— å…³æµ‹è¯•ä¸Šè¿è¡Œæ‰©å±•ï¼ŒåŒæ—¶ä¹Ÿå…è®¸å¤šä¸ªæä¾›è€…å¹¶å­˜è€Œäº’ä¸å¹²æ‰°</strong>ã€‚</p>
<h3 data-id="heading-6">3.2. <code>provideClassTemplateInvocationContexts()</code> æ–¹æ³•</h3>
<p>ä¸€æ—¦æŸä¸ªæä¾›è€…è¢«æ¿€æ´»ï¼ŒJUnit å°±ä¼šè°ƒç”¨ <code>provideClassTemplateInvocationContexts()</code>ï¼Œä»¥è·å–æè¿°æ¨¡æ¿æ‰§è¡Œæ–¹å¼çš„ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Stream&lt;ClassTemplateInvocationContext&gt; <span class="hljs-title function_">provideClassTemplateInvocationContexts</span><span class="hljs-params">(ExtensionContext context)</span> {
    <span class="hljs-keyword">return</span> Stream.of(invocationContext(<span class="hljs-string">"A"</span>), invocationContext(<span class="hljs-string">"B"</span>));
}
</code></pre>
<p><strong>æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡éƒ½ä»£è¡¨äº†ä¸€æ¬¡å¯¹æµ‹è¯•ç±»çš„å®Œæ•´æ‰§è¡Œ</strong>ã€‚å•ä¸ªæä¾›è€…å¯ä»¥æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªä¸Šä¸‹æ–‡ï¼›å¦‚æœåŒæ—¶æœ‰å¤šä¸ªæä¾›è€…å¤„äºæ¿€æ´»çŠ¶æ€ï¼ŒJUnit ä¼šæŠŠå®ƒä»¬æä¾›çš„æµæ‹¼æ¥èµ·æ¥ã€‚æ¯ä¸ªä¸Šä¸‹æ–‡éƒ½å¯ä»¥æ·»åŠ è‡ªå·±çš„æ‰©å±•æˆ–é…ç½®ï¼Œä»è€Œè®©æä¾›è€…å¯ä»¥å¯¹è¯¥æ¬¡æ‰§è¡Œçš„ç¯å¢ƒè¿›è¡Œç²¾ç»†æ§åˆ¶ã€‚</p>
<p>ä»è¿™é‡Œå¼€å§‹ï¼Œ<strong>JUnit ä¼šä¸ºæ¯ä¸ªä¸Šä¸‹æ–‡åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç±»å®ä¾‹ï¼Œåº”ç”¨å¯¹åº”çš„æ‰©å±•ï¼Œå¹¶å®Œæ•´è¿è¡Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæµ‹è¯•æ–¹æ³•å„ä¸€æ¬¡</strong>ã€‚</p>
<h2 data-id="heading-7">4. å®ç”¨ç¤ºä¾‹</h2>
<p>ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£è¿™äº›æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥æ„é€ ä¸€ä¸ªç¤ºä¾‹ï¼šç¼–å†™ä¸€ä¸ªæµ‹è¯•ï¼Œç”¨æ¥éªŒè¯åœ¨å¤šä¸ª JVM Locale ä¸‹çš„æ—¥æœŸæ ¼å¼åŒ–é€»è¾‘ã€‚ç”±äº Locale ä¼šå½±å“æ•´ä¸ªæ‰§è¡Œç¯å¢ƒï¼Œè¿™ç±»éœ€æ±‚éå¸¸é€‚åˆç”¨ç±»æ¨¡æ¿æ¥å®ç°ã€‚æˆ‘ä»¬åªä¿ç•™<strong>ä¸€ä¸ª</strong>æµ‹è¯•ç±»ï¼Œç„¶åè®©æä¾›è€…åœ¨ä¸åŒé…ç½®ä¸‹å¤šæ¬¡æ‰§è¡Œå®ƒã€‚</p>
<h3 data-id="heading-8">4.1. æ—¥æœŸæ ¼å¼åŒ–é€»è¾‘</h3>
<p>é¦–å…ˆï¼Œä»ä¸€ä¸ªå°å·¥å…·ç±»å¼€å§‹ï¼Œå®ƒä½¿ç”¨å½“å‰ JVM é»˜è®¤ Locale æ¥æ ¼å¼åŒ–æ—¥æœŸã€‚åªè¦é»˜è®¤ Locale å‘ç”Ÿå˜åŒ–ï¼Œå®ƒçš„è¾“å‡ºå°±ä¼šéšä¹‹æ”¹å˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DateFormatter</span> {

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">format</span><span class="hljs-params">(LocalDate date)</span> {
        <span class="hljs-type">DateTimeFormatter</span> <span class="hljs-variable">formatter</span> <span class="hljs-operator">=</span> DateTimeFormatter.ofLocalizedDate(FormatStyle.LONG)
            .withLocale(Locale.getDefault());

        <span class="hljs-keyword">return</span> date.format(formatter);
    }
}
</code></pre>
<p>æœ‰äº†è¿™ä¸ªç±»ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¤šç§ä¸åŒçš„é…ç½®ä¸‹éªŒè¯å®ƒçš„è¡Œä¸ºï¼Œè€Œè¿™äº›é…ç½®éƒ½ç”±ç±»æ¨¡æ¿æ¥æä¾›ã€‚</p>
<h3 data-id="heading-9">4.2. æä¾›è€…ä¸æ‰©å±•</h3>
<p>ä¸ºäº†æ”¯æ’‘ä¸Šè¿°éœ€æ±‚ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ªæ‰©å±•ï¼Œç”¨æ¥åœ¨å•æ¬¡æ‰§è¡ŒæœŸé—´è®¾ç½®é»˜è®¤ Localeï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LocaleExtension</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeforeEachCallback</span>, AfterEachCallback {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Locale locale;
    <span class="hljs-keyword">private</span> Locale previous;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeEach</span><span class="hljs-params">(ExtensionContext context)</span> {
        previous = Locale.getDefault();
        Locale.setDefault(locale);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterEach</span><span class="hljs-params">(ExtensionContext context)</span> {
        Locale.setDefault(previous);
    }
}
</code></pre>
<p>è¿™ä¸ªæ‰©å±•ä¼šåœ¨æ¯æ¬¡æµ‹è¯•ä¹‹å‰æš‚æ—¶æ›¿æ¢ JVM çš„é»˜è®¤ Localeï¼Œå¹¶åœ¨æµ‹è¯•ç»“æŸåæ¢å¤åŸæœ‰å€¼ã€‚<strong>åœ¨ä¸åŒæ‰§è¡Œä¹‹é—´å”¯ä¸€å˜åŒ–çš„ï¼Œå°±æ˜¯ä¼ å…¥è¯¥æ‰©å±•çš„ <code>Locale</code> å®ä¾‹ã€‚</strong></p>
<p>æ¥ä¸‹æ¥ï¼Œæä¾›è€…ä¼šé€šè¿‡ <code>provideClassTemplateInvocationContexts()</code> æ–¹æ³•æ¥æä¾›ä¸åŒçš„ä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªä¸Šä¸‹æ–‡éƒ½ç”± <code>invocationContext()</code> æ–¹æ³•åˆ›å»ºï¼Œè¯¥æ–¹æ³•é€šè¿‡ <code>getDisplayName()</code> æŒ‡å®šæ˜¾ç¤ºåï¼Œå¹¶é€šè¿‡ <code>getAdditionalExtensions()</code> å®‰è£…å¯¹åº”çš„ <code>LocaleExtension</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DateLocaleClassTemplateProvider</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ClassTemplateInvocationContextProvider</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Stream&lt;ClassTemplateInvocationContext&gt; <span class="hljs-title function_">provideClassTemplateInvocationContexts</span><span class="hljs-params">(ExtensionContext context)</span> {
        <span class="hljs-keyword">return</span> Stream.of(Locale.US, Locale.GERMANY, Locale.ITALY, Locale.JAPAN)
            .map(<span class="hljs-built_in">this</span>::invocationContext);
    }

    <span class="hljs-keyword">private</span> ClassTemplateInvocationContext <span class="hljs-title function_">invocationContext</span><span class="hljs-params">(Locale locale)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassTemplateInvocationContext</span>() {

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDisplayName</span><span class="hljs-params">(<span class="hljs-type">int</span> invocationIndex)</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"Locale: "</span> + locale.getDisplayName();
            }

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> List&lt;Extension&gt; <span class="hljs-title function_">getAdditionalExtensions</span><span class="hljs-params">()</span> {
                <span class="hljs-keyword">return</span> List.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LocaleExtension</span>(locale));
            }
        };
    }
}
</code></pre>
<p>é€šè¿‡è¿™æ ·çš„é…ç½®ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†äº’ä¸ç›¸åŒçš„æ‰§è¡Œç¯å¢ƒï¼Œæœ€ç»ˆä¼šå¯¹åŒä¸€ä¸ªæµ‹è¯•ç±»æ‰§è¡Œå››æ¬¡æµ‹è¯•ã€‚</p>
<h3 data-id="heading-10">4.3. Class Template æµ‹è¯•</h3>
<p>æ­¤æ—¶ï¼Œç±»æ¨¡æ¿çš„æ•´ä½“é…ç½®å·²ç»å°±ä½ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸“æ³¨äºç¼–å†™ä¸€ä¸ªæµ‹è¯•æ–¹æ³•äº†ã€‚JUnit ä¼šé€šè¿‡å‰é¢é…ç½®å¥½çš„æä¾›è€…ï¼Œä¸ºæ¯ä¸ªä¸Šä¸‹æ–‡æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">DateFormatter</span> <span class="hljs-variable">formatter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateFormatter</span>();

<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">givenDefaultLocale_whenFormattingDate_thenMatchesLocalizedOutput</span><span class="hljs-params">()</span> {
    <span class="hljs-type">LocalDate</span> <span class="hljs-variable">date</span> <span class="hljs-operator">=</span> LocalDate.of(<span class="hljs-number">2025</span>, <span class="hljs-number">9</span>, <span class="hljs-number">30</span>);

    <span class="hljs-type">DateTimeFormatter</span> <span class="hljs-variable">expectedFormatter</span> <span class="hljs-operator">=</span> DateTimeFormatter.ofLocalizedDate(FormatStyle.LONG)
        .withLocale(Locale.getDefault());

    <span class="hljs-type">String</span> <span class="hljs-variable">expected</span> <span class="hljs-operator">=</span> date.format(expectedFormatter);
    <span class="hljs-type">String</span> <span class="hljs-variable">formatted</span> <span class="hljs-operator">=</span> formatter.format(date);

    LOG.info(<span class="hljs-string">"Locale: {}, Expected: {}, Formatted: {}"</span>, Locale.getDefault(), expected, formatted);

    assertEquals(expected, formatted);
}
</code></pre>
<p>åœ¨æ¯æ¬¡æ‰§è¡Œä¸­ï¼Œæµ‹è¯•éƒ½ä¼šåŸºäºå½“å‰é»˜è®¤ Locale è®¡ç®—é¢„æœŸå€¼ï¼Œå¹¶ä¸ <code>DateFormatter</code> çš„è¾“å‡ºè¿›è¡Œæ¯”è¾ƒã€‚<strong>ç±»æ¨¡æ¿å’Œæä¾›è€…è´Ÿè´£åœ¨æ¯æ¬¡æ‰§è¡Œä¹‹é—´åˆ‡æ¢ç¯å¢ƒè®¾ç½®</strong>ï¼Œå› æ­¤æµ‹è¯•ä»£ç æœ¬èº«å¯ä»¥ä¿æŒç®€å•ã€å¹²å‡€ï¼Œä¸éœ€è¦ä»»ä½•åˆ†æ”¯é€»è¾‘ã€‚</p>
<h3 data-id="heading-11">4.4. æµ‹è¯•è¾“å‡º</h3>
<p>æœ€åï¼Œå½“æˆ‘ä»¬è¿è¡Œè¿™ç»„æµ‹è¯•æ—¶ï¼ŒåŒä¸€ä¸ªæµ‹è¯•ç±»ä¼šåœ¨æ¯ä¸ª Locale ä¸‹æ‰§è¡Œä¸€æ¬¡ï¼Œè€Œæ¯æ¬¡çš„æ ¼å¼åŒ–ç»“æœéƒ½ä¸ç›¸åŒï¼š</p>
<pre><code class="hljs language-text" lang="text">Locale: en_US, Expected: September 30, 2025, Formatted: September 30, 2025
Locale: de_DE, Expected: 30. September 2025, Formatted: 30. September 2025
Locale: it_IT, Expected: 30 settembre 2025, Formatted: 30 settembre 2025
Locale: ja_JP, Expected: 2025å¹´9æœˆ30æ—¥, Formatted: 2025å¹´9æœˆ30æ—¥
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€è¡Œéƒ½å¯¹åº”äºä¸€ä¸ªè°ƒç”¨ä¸Šä¸‹æ–‡ã€‚æµ‹è¯•ä»£ç åœ¨è¿™äº›è¿è¡Œä¹‹é—´å®Œå…¨æ²¡æœ‰å˜åŒ–ï¼›å˜åŒ–çš„åªæ˜¯ç”±æä¾›è€…å’Œæ‰©å±•é…ç½®å‡ºæ¥çš„æ‰§è¡Œç¯å¢ƒã€‚</p>
<h2 data-id="heading-12">5. æ€»ç»“</h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œè¿›ä¸€æ­¥æ·±å…¥äº† <code>@ClassTemplate</code> çš„ä½¿ç”¨æ–¹å¼ï¼Œé‡ç‚¹è€ƒå¯Ÿäº†æä¾›è€…å¦‚ä½•ä¸ºå•ä¸ªæµ‹è¯•ç±»æä¾›å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚é€šè¿‡ Locale ç¤ºä¾‹ï¼Œæˆ‘ä»¬çœ‹åˆ°æä¾›è€…å’Œæ‰©å±•å¯ä»¥åœ¨ä¸ä¿®æ”¹æµ‹è¯•ä»£ç çš„å‰æä¸‹çµæ´»åœ°åˆ‡æ¢æµ‹è¯•ç¯å¢ƒã€‚è¿™ä½¿å¾—ç±»æ¨¡æ¿<strong>æˆä¸ºå¤„ç†å…¨å±€è®¾ç½®æˆ–é…ç½®çº§è¡Œä¸ºæµ‹è¯•çš„ä¸€ç§å¹²å‡€è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ</strong>ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœæ‚¨å¯¹Javaå†…å®¹æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fspring4all.com%2Ftags%2Fjava" target="_blank" title="https://spring4all.com/tags/java" ref="nofollow noopener noreferrer">Javaä¸“é¢˜</a>å†…å®¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vercel AI SDKï¼šæ„å»ºç°ä»£ Web AI åº”ç”¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7584289165754155062</link>    <guid>https://juejin.cn/post/7584289165754155062</guid>    <pubDate>2025-12-16T12:52:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584289165754155062" data-draft-id="7584273076646264838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vercel AI SDKï¼šæ„å»ºç°ä»£ Web AI åº”ç”¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,AIGC"/> <meta itemprop="datePublished" content="2025-12-16T12:52:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‡èˆç²¾é€‰"/> <meta itemprop="url" content="https://juejin.cn/user/4388906147515367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vercel AI SDKï¼šæ„å»ºç°ä»£ Web AI åº”ç”¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4388906147515367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‡èˆç²¾é€‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T12:52:07.000Z" title="Tue Dec 16 2025 12:52:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç®€ä»‹</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41660f289c874d41be4751f8d93e894e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWH6Iie57K-6YCJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766494327&amp;x-signature=5h0WgpbEX%2FvyTrgAiVHcTwL2TUE%3D" alt="" loading="lazy"/>
éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è¶Šæ¥è¶Šæ™®åŠï¼Œå°†å®ƒä»¬é›†æˆåˆ° Web åº”ç”¨ã€èŠå¤©æœºå™¨äººç­‰åœºæ™¯ä¸­æˆä¸ºå¾ˆå¤šå¼€å‘è€…çš„è¯‰æ±‚ã€‚ä½†ä¸åŒæ¨¡å‹æä¾›å•†ï¼ˆDeepSeekã€OpenAIã€Anthropicã€Google ç­‰ï¼‰åœ¨æ¥å£ã€è¯·æ±‚æ–¹å¼ã€è¿”å›æ ¼å¼ç­‰æ–¹é¢å·®å¼‚å¾ˆå¤§ã€‚ æ­¤å¤–ï¼Œä¸åŒ Web æ¡†æ¶ï¼ˆReactï¼Next.jsã€Vueï¼Nuxtã€Node.js ç­‰ï¼‰ä¹Ÿå¸¦æ¥äº†å…¼å®¹æ€§å’Œå·¥ç¨‹å¤æ‚æ€§ã€‚</p>
<p>Vercel æ¨å‡ºçš„ Vercel AI SDKï¼Œæ—¨åœ¨é€šè¿‡ <strong>ç»Ÿä¸€ API + æ¡†æ¶æ— å…³ UI ç»„ä»¶ + å¤šæ¨¡å‹é€‚é…å™¨</strong> çš„è®¾è®¡ï¼Œå°† â€œè°ƒç”¨ LLM + æ„å»ºå¯¹è¯/ç”Ÿæˆ UIâ€ çš„å¤æ‚æ€§å°è£…èµ·æ¥ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸å¿…è¿‡å¤šå…³æ³¨æ¨¡å‹å’Œæ¡†æ¶å·®å¼‚ã€‚æ¢å¥è¯è¯´ï¼ŒVercel AI SDK æ˜¯ä¸ºâ€œæŠŠ AIï¼ˆLLMï¼‰æ¥å…¥ç°ä»£ Web åº”ç”¨â€ â€” ä»åŸå‹åˆ°ç”Ÿäº§ â€” æä¾›ä¸€ç§æ ‡å‡†ã€æ–¹ä¾¿ã€é«˜æ•ˆçš„â€œä¸­é—´å±‚/åŸºç¡€è®¾æ–½â€ã€‚å¦‚æœä½ åœ¨åš ChatBotã€çŸ¥è¯†åº“é—®ç­”ç­‰é¡¹ç›®æ—¶ï¼ŒVercel AI SDK èƒ½å¤§å¹…é™ä½ä¸Šä¸‹æ¸¸é›†æˆå’Œå·¥ç¨‹å¤æ‚åº¦ã€‚</p>
<p>å½“å‰ï¼ŒVercel AI SDK æœ€æ–°ç‰ˆæœ¬ä¸º <strong>AI SDK 6</strong>ï¼Œä¸è¿‡ç›®å‰å®ƒå¤„äº <strong>Beta é˜¶æ®µ</strong>ã€‚å¦‚æœä½ ä¸æƒ³ç”¨ Beta ç‰ˆæœ¬ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ç¨³å®šç‰ˆï¼Œå³ AI SDK 5ã€‚</p>
<p>Vercel AI SDK å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fai-sdk.dev%2F" target="_blank" title="https://ai-sdk.dev/" ref="nofollow noopener noreferrer">ai-sdk.dev</a></p>
<p>Vercel AI SDK å¼€æºåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fai" target="_blank" title="https://github.com/vercel/ai" ref="nofollow noopener noreferrer">github.com/vercel/ai</a></p>
<h2 data-id="heading-1">æ ¸å¿ƒæ¨¡å—</h2>
<p><strong>AI SDK Core</strong></p>
<p>æä¾›ç»Ÿä¸€ API ç”¨äºè°ƒç”¨è¯­è¨€æ¨¡å‹ï¼ç”Ÿæˆæ–‡æœ¬ã€ç»“æ„åŒ–å¯¹è±¡ï¼æ•°ç»„ã€å·¥å…·è°ƒç”¨ã€æµå¼å“åº”ç­‰ã€‚é€šè¿‡ç»Ÿä¸€æ¥å£å±è”½ä¸åŒæ¨¡å‹ Provider çš„å·®å¼‚ã€‚SDK æœ¬èº«ä¸ç»‘æ­»ä»»ä½•æ¨¡å‹ï¼Œè€Œæ˜¯é€šè¿‡ Provider æœºåˆ¶é€‚é…ä¼—å¤šæ¨¡å‹æä¾›å•† (LLM)ã€‚å¦‚å®˜æ–¹æ”¯æŒ DeepSeekã€OpenAIã€Anthropicã€Googleã€xAI Grok ç­‰ï¼Œè¿˜æ”¯æŒè‡ªå®šä¹‰ Providerã€‚</p>
<p><strong>AI SDK UI</strong></p>
<p>æä¾›é¢å‘å‰ç«¯ï¼å‰ç«¯æ¡†æ¶ (Reactã€Vueã€Svelteã€Angular ç­‰) çš„ hooks æˆ–ç»„ä»¶ (å¦‚ <code>useChat</code>, <code>useCompletion</code> ç­‰)ï¼Œæ–¹ä¾¿æ„å»ºèŠå¤©ç•Œé¢ã€ç”Ÿæˆå¼ UIã€æµå¼èŠå¤©ç•Œé¢ã€Agent UI ç­‰ã€‚å¯ä»¥åœ¨å¤šç§å‰ç«¯æ¶æ„ä¸­å¤ç”¨ã€‚</p>
<h2 data-id="heading-2">å„åº“ (Package) åŠŸèƒ½èŒè´£ä¸é€‚ç”¨åœºæ™¯</h2>
<h3 data-id="heading-3"><code>ai</code> â€” Core SDK</h3>
<ul>
<li>Core æ ¸å¿ƒåŒ…ï¼Œæä¾›ç»Ÿä¸€ã€æ¡†æ¶æ— å…³çš„ APIï¼Œç”¨äºè°ƒç”¨ä»»æ„å…¼å®¹ Provider çš„ LLM</li>
<li>æ”¯æŒåŸºç¡€ç”¨ä¾‹ï¼šæ–‡æœ¬ç”Ÿæˆã€ç»“æ„åŒ–æ•°æ®ç”Ÿæˆã€æµå¼å“åº” (streaming)</li>
<li>æ”¯æŒå¤šæ¨¡å‹ï¼Œé€šè¿‡ Provider Adapter æœºåˆ¶ï¼Œå¦‚ <code>@ai-sdk/openai</code>) æ¥é€‚é…å„å®¶æ¨¡å‹ï¼Œå°†å®ƒä»¬åœ¨ç»Ÿä¸€çš„æ¥å£ä¸‹æŠ½è±¡ã€‚</li>
</ul>
<p><strong>ä½•æ—¶ä½¿ç”¨</strong><code>ai</code>ï¼š</p>
<ul>
<li>ä½ éœ€è¦åç«¯ / API route ç­‰è°ƒç”¨ LLMã€ç”Ÿæˆæ–‡æœ¬ã€ç»“æ„åŒ–è¾“å‡ºã€æ‰§è¡Œå·¥å…·è°ƒç”¨ (ä¾‹å¦‚è°ƒç”¨å¤–éƒ¨ APIã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰)ï¼Œå¹¶å°†ç»“æœå¤„ç†ã€å­˜å‚¨ã€è½¬å‘</li>
<li>æ„å»º â€œWorkflow / åç«¯æœåŠ¡ / CLI å·¥å…· â€ ç­‰ï¼Œä¸éœ€è¦å‰ç«¯ UI</li>
<li>è·¨ Provider (DeepSeek / OpenAI / Google / Anthropic ) ç¼–å†™é€šç”¨é€»è¾‘ï¼Œä¸æƒ³ä¸ºæ¯ä¸ªæä¾›å•†å†™ç‹¬ç«‹å¤„ç†ã€‚</li>
</ul>
<p><strong>å¦‚ä½•å®‰è£… / ä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install ai
</code></pre>
<h3 data-id="heading-4"><code>@ai-sdk/openai</code> â€” OpenAI Provider é€‚é…åŒ…</h3>
<ul>
<li>â€œæ¨¡å‹ Provider é€‚é…åŒ…â€ â€” ç”¨äºå½“ä½ å¸Œæœ›ä½¿ç”¨ OpenAI (æˆ–å…¼å®¹ OpenAI API) ä½œä¸º LLM Provider æ—¶ï¼ŒæŠŠ OpenAI æ•´åˆè¿› Coreï¼›å®ƒå®ç°äº† Provider æ¥å£ã€‚</li>
<li>æä¾›å¯¹ OpenAI è§„èŒƒåŠŸèƒ½çš„å°è£…ã€‚</li>
</ul>
<p><strong>ä½•æ—¶ä½¿ç”¨</strong><code>@ai-sdk/openai</code>ï¼š</p>
<ul>
<li>ä½ è®¡åˆ’ç”¨ OpenAI çš„æ¨¡å‹ (GPT-4, GPT-4o, GPT-5, å…¶ä»– OpenAI æ¨¡å‹) ä½œä¸ºä½ çš„ LLMã€‚</li>
<li>ä½ è®¡åˆ’ç”¨ å…¼å®¹ OpenAI æ¥å£è§„èŒƒçš„æ¨¡å‹ä½œä¸ºä½ çš„ LLMã€‚</li>
</ul>
<p><strong>å¦‚ä½•å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install @ai-sdk/openai
</code></pre>
<p>åŒæ—¶ä½ è¿˜éœ€è¦ <code>ai</code> (core) æ‰èƒ½ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { generateText } <span class="hljs-keyword">from</span> <span class="hljs-string">'ai'</span>;
<span class="hljs-keyword">import</span> { openai } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ai-sdk/openai'</span>;

<span class="hljs-keyword">const</span> { text } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">generateText</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-title function_">openai</span>(<span class="hljs-string">'gpt-4o'</span>),
  <span class="hljs-attr">prompt</span>: <span class="hljs-string">'ä»‹ç»ä¸€ä¸‹ Vercel AI SDK'</span>,
});
</code></pre>
<h3 data-id="heading-5"><code>@ai-sdk/react</code> â€” React UI å±‚</h3>
<ul>
<li>ä¸º React åº”ç”¨ (åŒ…æ‹¬åŸºäº React çš„æ¡†æ¶ï¼Œå¦‚ Next.js) æä¾› UI å±‚æŠ½è±¡ (hooks / ç»„ä»¶)ï¼Œæ–¹ä¾¿åœ¨å‰ç«¯æ„å»ºèŠå¤© UI /ç”Ÿæˆ UI /æµå¼ UIã€‚</li>
<li>å¸¸è§æä¾›çš„ hook åŒ…æ‹¬ <code>useChat</code>, <code>useCompletion</code>, <code>useObject</code> ç­‰ â€”â€” å®ƒä»¬å°è£…äº†çŠ¶æ€ç®¡ç† (Messages åˆ—è¡¨ã€ç”¨æˆ·è¾“å…¥ã€æäº¤ã€Request/Response çŠ¶æ€)ã€UI æ›´æ–°ã€ä¸åç«¯ (æˆ–ç”± <code>ai</code> åŒ…æä¾›çš„ API) çš„äº¤äº’æµç¨‹ã€‚</li>
<li>æ”¯æŒä¸ <code>ai</code> + Provider ç»„åˆä½¿ç”¨ï¼Œé€šè¿‡å‰ç«¯ + åç«¯ æ„å»ºå®Œæ•´çš„ ChatBot åº”ç”¨ã€‚</li>
</ul>
<p><strong>ä½•æ—¶ä½¿ç”¨</strong><code>@ai-sdk/react</code>ï¼š</p>
<ul>
<li>ä½ åœ¨åšå‰ç«¯é¡¹ç›® (SPA / é™æ€ç½‘é¡µ / Next.js / React) å¹¶å¸Œæœ›ç›´æ¥ç»™ç”¨æˆ·å±•ç¤ºäº¤äº’ç•Œé¢ (èŠå¤©æ¡†ã€å¯¹è¯ã€ç”Ÿæˆå†…å®¹ã€æµå¼è¾“å‡ºç­‰)ã€‚</li>
<li>æƒ³å¿«é€Ÿæ„å»º UIï¼Œä¸ç”¨è‡ªå·±ä»å¤´ç®¡ç†è¯·æ±‚ / å“åº” /æ¶ˆæ¯åˆ—è¡¨ /çŠ¶æ€ /loading /streaming/ UI æ›´æ–°ã€‚</li>
</ul>
<p><strong>å¦‚ä½•å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install @ai-sdk/react
</code></pre>
<p><strong>ç¤ºä¾‹ (React / Next.js)</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { messages, sendMessage, status, error } = <span class="hljs-title function_">useChat</span>({
  <span class="hljs-attr">transport</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStreamChatTransport</span>({
    <span class="hljs-attr">api</span>: <span class="hljs-string">"/api/chat"</span>,
  }),
});
</code></pre>
<p>åç«¯ï¼ˆNext.js API routeï¼‰ä½¿ç”¨ <code>ai</code> + <code>@ai-sdk/openai</code> äº§ç”Ÿå“åº”ã€‚</p>
<h2 data-id="heading-6">æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åŒ…</h2>
<ul>
<li>å¦‚æœä½ çš„é¡¹ç›® <strong>åªéœ€è¦åç«¯ / å¯¹ LLM è¿›è¡Œè°ƒç”¨ / ç”Ÿæˆæ–‡æœ¬</strong> â€”â€” åªå®‰è£… <code>ai</code> + å¯¹åº” Provider (ä¾‹å¦‚ <code>@ai-sdk/openai</code>)ã€‚</li>
<li>å¦‚æœä½ çš„é¡¹ç›® <strong>æ¶‰åŠå‰ç«¯ / ç”¨æˆ·äº¤äº’ / Chat UI /å¯¹è¯ç•Œé¢ /ç”Ÿæˆ UI</strong> â€”â€” é‚£å»ºè®®ä¹ŸåŠ ä¸Š <code>@ai-sdk/react</code> (æˆ–è§†ä½ å‰ç«¯æ¡†æ¶ä¸º <code>@ai-sdk/vue</code>, <code>@ai-sdk/svelte</code> ç­‰) æ¥å¤„ç† UI/äº¤äº’é€»è¾‘ã€‚</li>
<li><code>@ai-sdk/openai</code> (æˆ–å…¶ä»– Provider åŒ…) æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ <code>ai</code> å°±ä¸çŸ¥é“ç”¨å“ªå®¶æ¨¡å‹æœåŠ¡ã€‚</li>
</ul>
<h2 data-id="heading-7">å¿«é€Ÿä¸Šæ‰‹</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ "åˆ©ç”¨ Vercel AI SDK æ„å»ºç®€å•èŠå¤©" çš„å®è·µã€‚</p>
<h3 data-id="heading-8">æ­¥éª¤ 1: åˆ›å»º Next.js é¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„ Next.js é¡¹ç›®</span>
npx create-next-app@latest ai-chatbot

<span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> ai-chatbot
</code></pre>
<p>åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©ä»¥ä¸‹é€‰é¡¹ï¼š</p>
<ul>
<li>âœ… TypeScript</li>
<li>âœ… ESLint</li>
<li>âœ… Tailwind CSS</li>
<li>âœ… App Router</li>
<li>ğŸ”˜ src/ directory (å¯é€‰)</li>
<li>âœ… Turbopack (å¯é€‰)</li>
</ul>
<h3 data-id="heading-9">æ­¥éª¤ 2: å®‰è£… Vercel AI SDK ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…æ ¸å¿ƒåŒ…å’Œ OpenAI Provider</span>
npm install ai @ai-sdk/openai @ai-sdk/react

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨å…¶ä»– Providerï¼Œä¾‹å¦‚:</span>
<span class="hljs-comment"># npm install ai @ai-sdk/anthropic @ai-sdk/react  # Anthropic Claude</span>
<span class="hljs-comment"># npm install ai @ai-sdk/google @ai-sdk/react     # Google Gemini</span>
</code></pre>
<h3 data-id="heading-10">æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.env.local</code> æ–‡ä»¶ï¼ˆè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Kimiï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># OpenAI API Key</span>
OPENAI_API_KEY=your_kimi_api_key_here

<span class="hljs-comment"># å¦‚æœä½¿ç”¨å…¼å®¹ OpenAI çš„æœåŠ¡ï¼ˆå¦‚ Kimiï¼‰ï¼Œå¯ä»¥é…ç½®åŸºç¡€ URL</span>
OPENAI_BASE_URL=https://api.moonshot.cn/v1
</code></pre>
<h3 data-id="heading-11">æ­¥éª¤ 4: åˆ›å»ºåç«¯ API Route</h3>
<p>åˆ›å»ºæ–‡ä»¶ <code>app/api/chat/route.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { openai } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ai-sdk/openai'</span>;
<span class="hljs-keyword">import</span> { streamText } <span class="hljs-keyword">from</span> <span class="hljs-string">'ai'</span>;

<span class="hljs-comment">// å…è®¸æµå¼å“åº”æœ€å¤š 30 ç§’</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> maxDuration = <span class="hljs-number">30</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">req: Request</span>) {
  <span class="hljs-comment">// ä»è¯·æ±‚ä½“ä¸­æå–æ¶ˆæ¯</span>
  <span class="hljs-keyword">const</span> { messages } = <span class="hljs-keyword">await</span> req.<span class="hljs-title function_">json</span>();

  <span class="hljs-comment">// è°ƒç”¨ LLM ç”Ÿæˆæµå¼å“åº”</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">streamText</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-title function_">openai</span>(<span class="hljs-string">'gpt-4o'</span>),
    messages
  });

  <span class="hljs-comment">// è¿”å›æµå¼å“åº”</span>
  <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">toTextStreamResponse</span>();
}
</code></pre>
<p><strong>å¦‚æœä½¿ç”¨ Kimiï¼ˆå…¼å®¹ OpenAI APIï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createOpenAI } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ai-sdk/openai"</span>;
<span class="hljs-keyword">import</span> { streamText, convertToModelMessages } <span class="hljs-keyword">from</span> <span class="hljs-string">"ai"</span>;

<span class="hljs-comment">// åˆ›å»º Kimi Provider (Moonshot AI)</span>
<span class="hljs-keyword">const</span> kimiClient = <span class="hljs-title function_">createOpenAI</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"https://api.moonshot.cn/v1"</span>,
  <span class="hljs-attr">apiKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">KIMI_API_KEY</span>,
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> maxDuration = <span class="hljs-number">30</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">req: Request</span>) {
  <span class="hljs-keyword">const</span> { messages } = <span class="hljs-keyword">await</span> req.<span class="hljs-title function_">json</span>();

  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">streamText</span>({
    <span class="hljs-attr">model</span>: kimiClient.<span class="hljs-title function_">chat</span>(<span class="hljs-string">"moonshot-v1-8k"</span>),
    <span class="hljs-attr">messages</span>: <span class="hljs-title function_">convertToModelMessages</span>(messages),
  });
  <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">toTextStreamResponse</span>();
}

</code></pre>
<h3 data-id="heading-12">æ­¥éª¤ 5: åˆ›å»ºå‰ç«¯èŠå¤©é¡µé¢</h3>
<p>ä¿®æ”¹ <code>app/page.tsx</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-string">"use client"</span>;

<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { useChat } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ai-sdk/react"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">TextStreamChatTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"ai"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ChatPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [input, setInput] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> { messages, sendMessage, status, error } = <span class="hljs-title function_">useChat</span>({
    <span class="hljs-attr">transport</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStreamChatTransport</span>({
      <span class="hljs-attr">api</span>: <span class="hljs-string">"/api/chat"</span>,
    }),
  });

  <span class="hljs-keyword">const</span> isLoading = status === <span class="hljs-string">"streaming"</span> || status === <span class="hljs-string">"submitted"</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex min-h-screen flex-col items-center justify-between p-8"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full max-w-2xl flex flex-col h-[80vh]"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-3xl font-bold mb-6 text-center"</span>&gt;</span>AI èŠå¤©åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

        {/* æ¶ˆæ¯åˆ—è¡¨ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex-1 overflow-y-auto mb-4 space-y-4 p-4 bg-gray-50 rounded-lg"</span>&gt;</span>
          {messages.length === 0 &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-center text-gray-500 mt-10"</span>&gt;</span>
              å¼€å§‹å¯¹è¯å§ï¼å‘ AI åŠ©æ‰‹æé—®ä»»ä½•é—®é¢˜ã€‚
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          )}

          {messages.map((message) =&gt; {
            // æå–æ–‡æœ¬å†…å®¹
            const textContent = message.parts
              ?.filter((part) =&gt; part.type === "text")
              .map((part) =&gt; part.text)
              .join("") || "";

            return (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id}</span>
                <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">flex</span> ${
                  <span class="hljs-attr">message.role</span> === <span class="hljs-string">"user"</span> ? "<span class="hljs-attr">justify-end</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">justify-start</span>"
                }`}
              &gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                  <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">max-w-</span>[<span class="hljs-attr">80</span>%] <span class="hljs-attr">rounded-lg</span> <span class="hljs-attr">px-4</span> <span class="hljs-attr">py-2</span> ${
                    <span class="hljs-attr">message.role</span> === <span class="hljs-string">"user"</span>
                      ? "<span class="hljs-attr">bg-blue-500</span> <span class="hljs-attr">text-white</span>"
                      <span class="hljs-attr">:</span> "<span class="hljs-attr">bg-white</span> <span class="hljs-attr">text-gray-800</span> <span class="hljs-attr">border</span> <span class="hljs-attr">border-gray-200</span>"
                  }`}
                &gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-xs font-semibold mb-1 opacity-70"</span>&gt;</span>
                    {message.role === "user" ? "ä½ " : "AI åŠ©æ‰‹"}
                  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"whitespace-pre-wrap"</span>&gt;</span>{textContent}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            );
          })}

          {isLoading &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex justify-start"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-white text-gray-800 border border-gray-200 rounded-lg px-4 py-2"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex space-x-2"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-2 h-2 bg-gray-400 rounded-full animate-bounce"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                    <span class="hljs-attr">className</span>=<span class="hljs-string">"w-2 h-2 bg-gray-400 rounded-full animate-bounce"</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">animationDelay:</span> "<span class="hljs-attr">0.1s</span>" }}
                  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                    <span class="hljs-attr">className</span>=<span class="hljs-string">"w-2 h-2 bg-gray-400 rounded-full animate-bounce"</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">animationDelay:</span> "<span class="hljs-attr">0.2s</span>" }}
                  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          )}

          {error &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-center text-red-500 p-4 bg-red-50 rounded-lg"</span>&gt;</span>
              é”™è¯¯ï¼š{error.message}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        {/* è¾“å…¥è¡¨å• */}
        <span class="hljs-tag">&lt;<span class="hljs-name">form</span>
          <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{(e)</span> =&gt;</span> {
            e.preventDefault();
            if (input.trim()) {
              sendMessage({ text: input });
              setInput("");
            }
          }}
          className="flex gap-2"
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{input}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInput(e.target.value)}
            placeholder="è¾“å…¥æ¶ˆæ¯..."
            disabled={isLoading}
            className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"
          /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
            <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isLoading</span> || !<span class="hljs-attr">input.trim</span>()}
            <span class="hljs-attr">className</span>=<span class="hljs-string">"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"</span>
          &gt;</span>
            {isLoading ? "å‘é€ä¸­..." : "å‘é€"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-13">æ­¥éª¤ 6: è¿è¡Œé¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
npm run dev
</code></pre>
<p>è®¿é—® <code>http://localhost:3000</code>ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå®Œæ•´çš„ AI èŠå¤©ç•Œé¢äº†ï¼æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06ad1c4c89f849958f3db15eb42cb9f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWH6Iie57K-6YCJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766494327&amp;x-signature=JjAue6YF%2Ft93qsIO4NuFYnfB8v8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-14">æ€»ç»“</h2>
<p>Vercel AI SDK æ˜¯ç›®å‰ Web / JavaScript / TypeScript ç”Ÿæ€ä¸­ï¼Œå°†å¤§è¯­è¨€æ¨¡å‹ (LLM) ä¸ç°ä»£å‰ç«¯ + åç«¯æ¡†æ¶ (Next.js, React, Vue, Svelte, Node.js, Serverless ç­‰) æ•´åˆå¾—æœ€å®Œæ•´ã€æœ€æ–¹ä¾¿ã€æœ€å…¨é¢çš„å¼€æº SDK ä¹‹ä¸€ã€‚</p>
<ul>
<li>å¯¹äºæƒ³å¿«é€Ÿæ„å»ºèŠå¤©æœºå™¨äººã€ç”Ÿæˆå¼åº”ç”¨ã€agentã€æ–‡æ¡£åˆ†æã€RAG ç³»ç»Ÿã€å¤šæ¨¡æ€åº”ç”¨ç­‰çš„äººæ¥è¯´ï¼Œå®ƒå¤§å¹…é™ä½äº†æŠ€æœ¯é—¨æ§›å’Œå·¥ç¨‹æˆæœ¬ï¼›</li>
<li>å¯¹äºéœ€è¦æ”¯æŒå¤šæ¨¡å‹ã€å¤š providerã€è·¨æ¡†æ¶ã€è·¨è¿è¡Œæ—¶ (server / edge / frontend) çš„é¡¹ç›®ï¼Œå®ƒæä¾›äº†ç¨³å®šã€ç»Ÿä¸€ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•çš„åŸºç¡€è®¾æ–½ï¼›</li>
<li>å¯¹äºåªæ˜¯æƒ³åœ¨çŸ­æ—¶é—´å†…åšåŸå‹ / MVP / demoï¼Œä¹Ÿéå¸¸å‹å¥½ã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œå¯¹äºæåº¦å®šåˆ¶ã€é«˜æ€§èƒ½ã€ç‰¹æ®Šæ¨¡å‹ / æç«¯åœºæ™¯ï¼Œä½ ä»å¯èƒ½éœ€è¦ç»•å¼€ SDKï¼Œè‡ªå·±æ„å»ºæ›´åº•å±‚æˆ–æ›´ä¸“é—¨åŒ–çš„æ–¹æ¡ˆã€‚å¦‚æœä½  <strong>åˆšå¼€å§‹åš AI + Web åº”ç”¨</strong> â€”â€” Vercel AI SDK æ˜¯ä¸€ä¸ªéå¸¸æ¨èçš„ â€œæœ€å¥½å®è·µ / èµ·ç‚¹ / åŸºç¡€è®¾æ–½â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GELab-Zero æŠ€æœ¯è§£æï¼šå½“è±†åŒ…è”æ‰‹ä¸­å…´ï¼Œå¼€æºç•Œå¦‚ä½•å®ˆä½ç«¯ä¾§ AI çš„â€œæœ€åé˜²çº¿â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584289165754171446</link>    <guid>https://juejin.cn/post/7584289165754171446</guid>    <pubDate>2025-12-16T12:52:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584289165754171446" data-draft-id="7584273076646281222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GELab-Zero æŠ€æœ¯è§£æï¼šå½“è±†åŒ…è”æ‰‹ä¸­å…´ï¼Œå¼€æºç•Œå¦‚ä½•å®ˆä½ç«¯ä¾§ AI çš„â€œæœ€åé˜²çº¿â€ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,AIGC"/> <meta itemprop="datePublished" content="2025-12-16T12:52:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‡èˆç²¾é€‰"/> <meta itemprop="url" content="https://juejin.cn/user/4388906147515367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GELab-Zero æŠ€æœ¯è§£æï¼šå½“è±†åŒ…è”æ‰‹ä¸­å…´ï¼Œå¼€æºç•Œå¦‚ä½•å®ˆä½ç«¯ä¾§ AI çš„â€œæœ€åé˜²çº¿â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4388906147515367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‡èˆç²¾é€‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T12:52:58.000Z" title="Tue Dec 16 2025 12:52:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>2025å¹´12æœˆï¼ŒAI ç«¯ä¾§é¢†åŸŸè¿æ¥äº†ä¸¤å¤§é‡Œç¨‹ç¢‘å¼çªç ´ï¼Œæ ‡å¿—ç€ç«¯ä¾§æ™ºèƒ½åŠ©æ‰‹ä»"èƒ½ä¸èƒ½ç”¨"è¿ˆå‘"èƒ½å¦è§„æ¨¡åŒ–è½åœ°"çš„å…³é”®é˜¶æ®µã€‚</strong></p>
<p>ä¸€æ–¹é¢ï¼Œ<strong>å­—èŠ‚è·³åŠ¨è±†åŒ…å›¢é˜Ÿ</strong>å‘å¸ƒäº†è±†åŒ…æ‰‹æœºåŠ©æ‰‹æŠ€æœ¯é¢„è§ˆç‰ˆï¼Œé¦–æ¬¡åœ¨æ‰‹æœºç«¯å®ç°äº†æŒä¹…åŒ–æœ¬åœ°è®°å¿†ä¸è·¨åº”ç”¨æ“ä½œèƒ½åŠ›ã€‚ç‰¹åˆ«æ˜¯å…¶ä¸<strong>ä¸­å…´æ‰‹æœº</strong>çš„æ·±åº¦åˆä½œï¼Œé€šè¿‡ç³»ç»Ÿçº§æˆæƒï¼ˆå¦‚ nubia M153 å·¥ç¨‹æ ·æœºï¼‰å®ç°äº†è¯­éŸ³ã€ä¾§è¾¹é”®ç›´æ¥å”¤é†’çš„ä¾¿æ·äº¤äº’ï¼Œå¼•å‘äº†è¡Œä¸šå…³äº"äº’è”ç½‘å·¨å¤´+æ‰‹æœºå‚å•†"ç”Ÿæ€åˆä½œæ¨¡å¼çš„çƒ­çƒˆè®¨è®ºã€‚</p>
<p>è¿‘æ—¥ï¼Œ<strong>é˜¶è·ƒæ˜Ÿè¾°</strong>å¼€æºäº† <strong>GELab-Zero-4B-preview</strong> æ¨¡å‹åŠé…å¥—å·¥ç¨‹åŸºå»ºï¼Œå®ç°äº† 4B çº§å‚æ•°æ¨¡å‹åœ¨ä¸»æµå®‰å“è®¾å¤‡ä¸Šçš„è½»é‡åŒ–éƒ¨ç½²ã€‚ä½œä¸ºå¼€æºæ¨¡å‹æä¾›æ–¹ï¼Œé˜¶è·ƒé€‰æ‹©äº†èµ‹èƒ½å¼€å‘è€…çš„è·¯çº¿ï¼Œé€šè¿‡æä¾›å®Œæ•´çš„æ¨ç†å·¥ç¨‹åŸºå»ºï¼Œè§£å†³å®‰å“ç”Ÿæ€ç¢ç‰‡åŒ–çš„éš¾é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†èšç„¦äºå¼€æºç•Œçš„ä»£è¡¨ä½œâ€”â€”<strong>GELab-Zero</strong>ï¼Œé€šè¿‡ä¸€ä¸ªçœŸå®çš„ä»»åŠ¡æ‰§è¡Œæ¡ˆä¾‹ï¼ˆSession ID: <code>1fe9db3f-92c8-4ae9-89bc-1d035d4bf59b</code>ï¼‰ï¼Œæ·±å…¥å‰–æå…¶æŠ€æœ¯æ¶æ„ã€å·¥ä½œåŸç†ä»¥åŠå¦‚ä½•åœ¨æ¶ˆè´¹çº§è®¾å¤‡ä¸Šå®ç° SOTA çº§çš„ GUI æ“ä½œèƒ½åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-1">æŠ€æœ¯èƒŒæ™¯ï¼šç«¯ä¾§ AI çš„æˆ˜å›½æ—¶ä»£</h2>
<h3 data-id="heading-2">1. è¡Œä¸šæ ¼å±€ï¼šä¸‰æ¡è·¯çº¿çš„è§’é€</h3>
<p>å½“å‰æ‰‹æœºç«¯ä¾§æ™ºèƒ½åŠ©æ‰‹é¢†åŸŸå½¢æˆäº†å¤šå…ƒåŒ–çš„ç«äº‰æ ¼å±€ï¼Œä¸»è¦å‚å•†çš„æŠ€æœ¯è·¯çº¿å’Œè¡Œä¸šå®šä½å„æœ‰ç‰¹è‰²ï¼š</p>

































<table><thead><tr><th align="left">å‚å•†ç±»å‹</th><th align="left">ä»£è¡¨å‚å•†/äº§å“</th><th align="left">æ¨¡å‹è§„æ¨¡</th><th align="left">æŠ€æœ¯è·¯çº¿ç‰¹ç‚¹</th><th align="left">è¡Œä¸šå®šä½</th></tr></thead><tbody><tr><td align="left"><strong>æ‰‹æœºå‚å•†</strong></td><td align="left"><strong>OPPO</strong> (AndesVL)<br/><strong>vivo</strong> (BlueLM)<br/><strong>åä¸º</strong> (å°è‰º)<br/><strong>è£è€€</strong> (MagicGUI)</td><td align="left">0.6B-7B+</td><td align="left"><strong>ç³»ç»Ÿçº§æ•´åˆ</strong>ï¼šå¤šé‡‡ç”¨å¤šæ¨¡æ€æ¨¡å‹ï¼Œæ·±åº¦æ•´åˆç³»ç»Ÿåº•å±‚ï¼ˆå¦‚åä¸º NPU+é¸¿è’™ï¼ŒOPPO æ½®æ±å¼•æ“ï¼‰ã€‚å¼ºè°ƒç¡¬ä»¶ååŒä¸ä¸“å±ä½“éªŒã€‚</td><td align="left"><strong>ç³»ç»Ÿçº§æ™ºèƒ½åŠ©ç†</strong><br/>æ‰“é€ "é«˜æ•ˆ&amp;ä¸“å±"çš„å·®å¼‚åŒ–ä½“éªŒ</td></tr><tr><td align="left"><strong>äº’è”ç½‘å·¨å¤´</strong></td><td align="left"><strong>å­—èŠ‚è·³åŠ¨</strong> (è±†åŒ…)</td><td align="left">æœªå…¬å¼€</td><td align="left"><strong>è½»é‡åŒ–å·¥å…·+ç”Ÿæ€åˆä½œ</strong>ï¼šå…·å¤‡ç«¯ä¾§æŒä¹…è®°å¿†å’Œè·¨ App æ“ä½œèƒ½åŠ›ã€‚ä¾èµ–ä¸å‚å•†ï¼ˆå¦‚ä¸­å…´ï¼‰çš„åˆä½œè·å¾—ç³»ç»Ÿçº§æƒé™ã€‚</td><td align="left"><strong>è½»é‡åŒ–å·¥å…·å‹åŠ©æ‰‹</strong><br/>é€šè¿‡ç”Ÿæ€åˆä½œè¦†ç›–å¤šå“ç‰Œ</td></tr><tr><td align="left"><strong>å¼€æºæ¨¡å‹æ–¹</strong></td><td align="left"><strong>é˜¶è·ƒæ˜Ÿè¾°</strong> (GELab-Zero)</td><td align="left">4B</td><td align="left"><strong>å¼€æºåŸºå»º+é€šç”¨å…¼å®¹</strong>ï¼šæä¾›å®Œæ•´çš„æ¨ç†å·¥ç¨‹åŸºå»ºï¼Œè§£å†³ ADB è¿æ¥ã€ä¾èµ–å®‰è£…ç­‰"è„æ´»ç´¯æ´»"ã€‚æ”¯æŒä¸€é”®éƒ¨ç½²ã€‚</td><td align="left"><strong>å¼€å‘è€…èµ‹èƒ½å¹³å°</strong><br/>é™ä½ç«¯ä¾§ Agent å¼€å‘é—¨æ§›</td></tr></tbody></table>
<h3 data-id="heading-3">2. æ·±åº¦æ¡ˆä¾‹è§£æï¼šè±†åŒ… x ä¸­å…´ nubia çš„é›†æˆæœºåˆ¶</h3>
<p>è±†åŒ…æ‰‹æœºåŠ©æ‰‹åœ¨ä¸­å…´ nubia M153 å·¥ç¨‹æœºä¸Šçš„å®ç°ï¼Œå±•ç¤ºäº†**"äº’è”ç½‘å·¨å¤´è½¯ä»¶ + æ‰‹æœºå‚å•†ç¡¬ä»¶"**çš„å…¸å‹åˆä½œæ¨¡å¼ï¼š</p>
<h4 data-id="heading-4">A. é›†æˆæ–¹å¼ï¼šç³»ç»Ÿçº§æ·±åº¦æ¤å…¥ (System-Level Integration)</h4>
<p>ä¸åŒäºæ™®é€š Appï¼Œè±†åŒ…é€šè¿‡ä¸ä¸­å…´ OS (MyOS) çš„åº•å±‚æ‰“é€šï¼Œå®ç°äº†ç¡¬ä»¶çº§çš„æ¥ç®¡ï¼š</p>
<ul>
<li><strong>ç¡¬ä»¶å…¥å£ç»‘å®š</strong>ï¼šå°†ç‰©ç†<strong>ä¾§è¾¹é”®</strong>æ˜ å°„ä¸º AI å”¤é†’é”®ï¼Œæ”¯æŒç†„å±çŠ¶æ€ä¸‹ä¸€é”®ç›´è¾¾ã€‚</li>
<li><strong>æƒé™ç™½åå•</strong>ï¼šçªç ´äº†ä¼ ç»Ÿ Accessibility æœåŠ¡æ˜“è¢«åå°æŸ¥æ€çš„é™åˆ¶ï¼Œè·å¾—äº†<strong>ç³»ç»Ÿçº§ä¿æ´»</strong>æƒé™ï¼Œç¡®ä¿æŒç»­çš„æ„ŸçŸ¥èƒ½åŠ›ã€‚</li>
</ul>
<h4 data-id="heading-5">B. æ¨¡å‹è¿è¡Œæ¶æ„ï¼šç«¯äº‘ååŒ (Cloud-Edge Collaboration)</h4>
<ul>
<li><strong>ç«¯ä¾§ (On-Device)</strong>ï¼š
<ul>
<li><strong>Secure Memory (å®‰å…¨è®°å¿†)</strong>ï¼šæ ¸å¿ƒå·®å¼‚åŒ–åŠŸèƒ½ã€‚åˆ©ç”¨ Android Keystore å¯¹ç”¨æˆ·æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å®¶åº­åœ°å€ã€æ”¯ä»˜ä¹ æƒ¯ï¼‰è¿›è¡Œ<strong>æœ¬åœ°åŠ å¯†å­˜å‚¨</strong>ï¼Œç¡®ä¿éšç§ä¸ç¦»ç«¯ã€‚</li>
<li><strong>Executor (æ‰§è¡Œå¼•æ“)</strong>ï¼šè¿è¡Œåœ¨æ‰‹æœºæœ¬åœ°çš„è½»é‡çº§æœåŠ¡ï¼Œè´Ÿè´£å°†æŒ‡ä»¤è½¬åŒ–ä¸ºå…·ä½“çš„ç‚¹å‡»/æ»‘åŠ¨æ“ä½œã€‚</li>
</ul>
</li>
<li><strong>äº‘ç«¯ (Cloud)</strong>ï¼š
<ul>
<li><strong>Reasoning Engine (æ¨ç†å¤§è„‘)</strong>ï¼šå¤„ç†å¤æ‚çš„é•¿ç¨‹ä»»åŠ¡è§„åˆ’ï¼ˆå¦‚"è·¨ App æ¯”ä»·"ï¼‰ï¼Œåˆ©ç”¨äº‘ç«¯å¤§æ¨¡å‹çš„ç®—åŠ›ä¼˜åŠ¿è¿›è¡Œå†³ç­–ï¼Œç„¶åå°†æ“ä½œæµä¸‹å‘ç»™ç«¯ä¾§æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">C. äº¤äº’é—­ç¯</h4>
<ol>
<li><strong>æ„ŸçŸ¥</strong>ï¼šé€šè¿‡æ— éšœç¢æœåŠ¡ (Accessibility API) å®æ—¶è·å–å±å¹• UI æ ‘ä¿¡æ¯ã€‚</li>
<li><strong>å†³ç­–</strong>ï¼šç«¯ä¾§è®°å¿† + å±å¹•ä¿¡æ¯ + ç”¨æˆ·æŒ‡ä»¤ -&gt; äº‘ç«¯æ¨ç† -&gt; ä¸‹å‘æ“ä½œæµã€‚</li>
<li><strong>æ‰§è¡Œ</strong>ï¼šè°ƒç”¨ç³»ç»Ÿçº§ API æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œé‡åˆ°æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚æ”¯ä»˜ï¼‰è‡ªåŠ¨é™çº§ä¸º"è¯·æ±‚ç”¨æˆ·ç¡®è®¤"ã€‚</li>
</ol>
<h3 data-id="heading-7">3. GUI Agent çš„æŠ€æœ¯æ¼”è¿›</h3>
<h3 data-id="heading-8">ç§»åŠ¨ç«¯ Agent çš„ä¸‰å¤§æŠ€æœ¯è·¯å¾„</h3>
<p>åœ¨ç§»åŠ¨ç«¯ Agent é¢†åŸŸï¼Œç›®å‰ä¸»è¦å­˜åœ¨ä¸‰ç§æŠ€æœ¯å®ç°è·¯å¾„ï¼š</p>
<h4 data-id="heading-9">1. <strong>API æ¥å£æ–¹æ¡ˆ</strong></h4>
<ul>
<li><strong>ä¼˜åŠ¿</strong>ï¼šç²¾ç¡®å¯é ï¼Œå»¶è¿Ÿä½</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šéœ€è¦ App å‚å•†æ·±åº¦é€‚é…ï¼Œå¼€å‘æˆæœ¬é«˜ï¼Œéš¾ä»¥è§„æ¨¡åŒ–</li>
<li><strong>ä»£è¡¨</strong>ï¼šéœ€è¦æ¯ä¸ª App æä¾›ä¸“é—¨çš„ Agent API</li>
</ul>
<h4 data-id="heading-10">2. <strong>è¾…åŠ©åŠŸèƒ½ï¼ˆAccessibilityï¼‰æ–¹æ¡ˆ</strong></h4>
<ul>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¯ä»¥è·å– UI æ ‘ç»“æ„ï¼Œç†è§£ç•Œé¢å…ƒç´ </li>
<li><strong>åŠ£åŠ¿</strong>ï¼šä¾èµ–ç³»ç»Ÿæƒé™ï¼Œéƒ¨åˆ†åº”ç”¨é™åˆ¶è®¿é—®ï¼Œå…¼å®¹æ€§é—®é¢˜å¤š</li>
<li><strong>ä»£è¡¨</strong>ï¼šAndroid Accessibility Service</li>
</ul>
<h4 data-id="heading-11">3. <strong>GUI è§†è§‰æ–¹æ¡ˆ</strong>ï¼ˆGELab-Zero é‡‡ç”¨ï¼‰</h4>
<ul>
<li><strong>ä¼˜åŠ¿</strong>ï¼š
<ul>
<li><strong>é€šç”¨å…¼å®¹</strong>ï¼šæ— éœ€ App å‚å•†é€‚é…ï¼Œæ”¯æŒæ‰€æœ‰åº”ç”¨</li>
<li><strong>é›¶æˆæœ¬æ¥å…¥</strong>ï¼šåŸºäºæˆªå±å’Œåæ ‡æ“ä½œï¼Œå¼€ç®±å³ç”¨</li>
<li><strong>çœŸå®ç”¨æˆ·è§†è§’</strong>ï¼šä¸äººç±»æ“ä½œæ–¹å¼ä¸€è‡´</li>
</ul>
</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šå¯¹è§†è§‰ç†è§£èƒ½åŠ›è¦æ±‚é«˜ï¼Œéœ€è¦å¼ºå¤§çš„å¤šæ¨¡æ€æ¨¡å‹</li>
<li><strong>ä»£è¡¨</strong>ï¼šGELab-Zeroã€Anthropic Computer Use</li>
</ul>
<h3 data-id="heading-12">ä¸ºä»€ä¹ˆé€‰æ‹© GUI æ–¹æ¡ˆï¼Ÿ</h3>
<p>ç§»åŠ¨åº”ç”¨ç”Ÿæ€å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>é«˜åº¦ç¢ç‰‡åŒ–</strong>ï¼šä¸­å›½å¸‚åœºæœ‰è¶…è¿‡ <strong>æ•°ç™¾ä¸‡ä¸ª</strong> Android åº”ç”¨</li>
<li><strong>å¿«é€Ÿè¿­ä»£</strong>ï¼šåº”ç”¨ UI é¢‘ç¹æ›´æ–°ï¼ŒAPI æ–¹æ¡ˆéš¾ä»¥ç»´æŠ¤</li>
<li><strong>æƒé™é™åˆ¶</strong>ï¼šè®¸å¤šåº”ç”¨é™åˆ¶ Accessibility è®¿é—®</li>
<li><strong>ç”¨æˆ·ä¹ æƒ¯</strong>ï¼šåŸºäºè§†è§‰çš„äº¤äº’æ›´æ¥è¿‘çœŸå®ç”¨æˆ·è¡Œä¸º</li>
</ol>
<p>å› æ­¤ï¼Œ<strong>GUI æ–¹æ¡ˆå·²æˆä¸ºå½“å‰é˜¶æ®µåº”å¯¹å¤æ‚ç§»åŠ¨ç”Ÿæ€ã€å®ç° Agent èƒ½åŠ›è§„æ¨¡åŒ–çš„æœ€ä½³è·¯å¾„</strong>ã€‚</p>
<h3 data-id="heading-13">è¡Œä¸šç°çŠ¶ä¸æŒ‘æˆ˜</h3>
<h4 data-id="heading-14">å½“å‰ GUI Agent é¢ä¸´çš„æ ¸å¿ƒé—®é¢˜</h4>
<ol>
<li>
<p><strong>å·¥ç¨‹é—¨æ§›é«˜</strong></p>
<ul>
<li>å¤šè®¾å¤‡ ADB è¿æ¥ç®¡ç†</li>
<li>ä¾èµ–å®‰è£…å’Œæƒé™é…ç½®</li>
<li>æ¨ç†æœåŠ¡éƒ¨ç½²ï¼ˆæœ¬åœ° LLMï¼‰</li>
<li>ä»»åŠ¡ç¼–æ’ä¸è½¨è¿¹å›æ”¾</li>
<li>å¯è§†åŒ–è°ƒè¯•å·¥å…·</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹èƒ½åŠ›è¦æ±‚é«˜</strong></p>
<ul>
<li>éœ€è¦å¼ºå¤§çš„è§†è§‰ç†è§£èƒ½åŠ›</li>
<li>å¤šæ­¥éª¤ä»»åŠ¡è§„åˆ’</li>
<li>ä¸Šä¸‹æ–‡è®°å¿†</li>
<li>å¼‚å¸¸å¤„ç†</li>
</ul>
</li>
<li>
<p><strong>éšç§å®‰å…¨é¡¾è™‘</strong></p>
<ul>
<li>äº‘ç«¯ API éœ€è¦ä¸Šä¼ æˆªå›¾</li>
<li>ç”¨æˆ·æ“ä½œæ•°æ®æ³„éœ²é£é™©</li>
<li>æ•æ„Ÿä¿¡æ¯æš´éœ²</li>
</ul>
</li>
</ol>
<h4 data-id="heading-15">ä¸»æµ Benchmark çš„å±€é™æ€§</h4>
<p>å½“å‰ä¸»æµåŸºå‡†æµ‹è¯•ï¼ˆå¦‚ AndroidWorldï¼‰å¤šèšç„¦äº<strong>ç”Ÿäº§åŠ›åº”ç”¨</strong>ï¼ˆé‚®ä»¶ã€æ—¥å†ï¼‰ï¼Œä½†ç”¨æˆ·æ—¥å¸¸é«˜é¢‘ä½¿ç”¨çš„å…¶å®æ˜¯<strong>ç”Ÿæ´»æœåŠ¡ç±»åº”ç”¨</strong>ï¼š</p>
<ul>
<li>ğŸ” å¤–å–ï¼ˆç¾å›¢ã€é¥¿äº†ä¹ˆï¼‰</li>
<li>ğŸš— æ‰“è½¦ï¼ˆæ»´æ»´ã€é«˜å¾·ï¼‰</li>
<li>ğŸ›’ è´­ç‰©ï¼ˆæ·˜å®ã€äº¬ä¸œï¼‰</li>
<li>ğŸ’¬ ç¤¾äº¤ï¼ˆå¾®ä¿¡ã€æŠ–éŸ³ï¼‰</li>
<li>ğŸ’° æ”¯ä»˜ï¼ˆæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ï¼‰</li>
</ul>
<p>è¿™äº›åœºæ™¯æ›´èƒ½ä½“ç° GUI Agent çš„å®ç”¨ä»·å€¼ï¼Œä½†ç¼ºä¹é’ˆå¯¹æ€§çš„è¯„ä¼°æ ‡å‡†ã€‚</p>
<h3 data-id="heading-16">GELab-Zero çš„æŠ€æœ¯çªç ´</h3>
<p>é’ˆå¯¹ä¸Šè¿°æŒ‘æˆ˜ï¼ŒGELab-Zero æä¾›äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<h4 data-id="heading-17">1. <strong>å®Œæ•´å·¥ç¨‹åŸºç¡€è®¾æ–½</strong></h4>
<pre><code class="hljs">ä¸€é”®éƒ¨ç½²è„šæœ¬
è‡ªåŠ¨è®¾å¤‡ç®¡ç†
å¤šè®¾å¤‡ä»»åŠ¡åˆ†å‘
å®Œæ•´æ—¥å¿—ç³»ç»Ÿ
Streamlit å¯è§†åŒ–ç•Œé¢
</code></pre>
<h4 data-id="heading-18">2. <strong>è½»é‡çº§æœ¬åœ°æ¨¡å‹</strong></h4>
<ul>
<li><strong>4B å‚æ•°</strong>ï¼šåœ¨æ¶ˆè´¹çº§ç¡¬ä»¶ï¼ˆ16GB RAMï¼‰ä¸Šæµç•…è¿è¡Œ</li>
<li><strong>å¤šæ¨¡æ€èƒ½åŠ›</strong>ï¼šåŒæ—¶ç†è§£å›¾åƒå’Œæ–‡æœ¬</li>
<li><strong>é«˜å‡†ç¡®ç‡</strong>ï¼šAndroidDaily é™æ€æµ‹è¯•è¾¾åˆ° <strong>73.4%</strong>ï¼ˆè¶…è¶Š GPT-4o çš„ 19.6%ï¼‰</li>
</ul>
<h4 data-id="heading-19">3. <strong>å®Œå…¨æœ¬åœ°åŒ–</strong></h4>
<ul>
<li>æ‰€æœ‰æ¨ç†åœ¨æœ¬åœ°å®Œæˆï¼ˆOllama/vLLMï¼‰</li>
<li>æˆªå›¾å’Œæ—¥å¿—å­˜å‚¨åœ¨æœ¬åœ°</li>
<li>æ— éœ€ç½‘ç»œä¼ è¾“ï¼Œä¿æŠ¤éšç§</li>
</ul>
<h4 data-id="heading-20">4. <strong>çœŸå®åœºæ™¯åŸºå‡†</strong></h4>
<ul>
<li><strong>AndroidDaily</strong>ï¼š235 ä¸ªç«¯åˆ°ç«¯ä»»åŠ¡</li>
<li>è¦†ç›–å…­å¤§ç”Ÿæ´»åœºæ™¯ï¼šé£Ÿã€è¡Œã€è´­ã€ä½ã€è®¯ã€å¨±</li>
<li>75.86% æˆåŠŸç‡ï¼ˆçœŸå®ç§»åŠ¨åœºæ™¯ï¼‰</li>
</ul>
<h3 data-id="heading-21">ä¸å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”</h3>















































<table><thead><tr><th>ç»´åº¦</th><th>API æ–¹æ¡ˆ</th><th>Accessibility</th><th>GUI æ–¹æ¡ˆ (GELab-Zero)</th></tr></thead><tbody><tr><td><strong>å…¼å®¹æ€§</strong></td><td>âŒ éœ€è¦é€‚é…</td><td>âš ï¸ éƒ¨åˆ†é™åˆ¶</td><td>âœ… é€šç”¨å…¼å®¹</td></tr><tr><td><strong>å¼€å‘æˆæœ¬</strong></td><td>âŒ é«˜</td><td>âš ï¸ ä¸­</td><td>âœ… ä½</td></tr><tr><td><strong>éšç§ä¿æŠ¤</strong></td><td>âš ï¸ ä¾èµ–æœåŠ¡å•†</td><td>âœ… æœ¬åœ°</td><td>âœ… å®Œå…¨æœ¬åœ°</td></tr><tr><td><strong>æ¨ç†é€Ÿåº¦</strong></td><td>âœ… å¿«</td><td>âœ… å¿«</td><td>âš ï¸ ä¸­ç­‰</td></tr><tr><td><strong>å‡†ç¡®æ€§</strong></td><td>âœ… é«˜</td><td>âœ… é«˜</td><td>âœ… é«˜ï¼ˆ73.4%ï¼‰</td></tr><tr><td><strong>å¯ç»´æŠ¤æ€§</strong></td><td>âŒ ä½</td><td>âš ï¸ ä¸­</td><td>âœ… é«˜</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-22">ä¸€ã€é¡¹ç›®æ¦‚è§ˆ</h2>
<h3 data-id="heading-23">1.1 æ ¸å¿ƒä»·å€¼ä¸»å¼ </h3>
<p>GELab-Zero è§£å†³äº†ç§»åŠ¨ç«¯ Agent è½åœ°çš„ä¸‰å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼š</p>
<ol>
<li><strong>éšç§å®‰å…¨</strong>ï¼šå®Œå…¨æœ¬åœ°åŒ–éƒ¨ç½²ï¼Œæ‰€æœ‰æ•°æ®å¤„ç†åœ¨æœ¬åœ°å®Œæˆï¼Œæ— éœ€ä¸Šä¼ äº‘ç«¯</li>
<li><strong>å³æ’å³ç”¨</strong>ï¼šæä¾›å®Œæ•´çš„å·¥ç¨‹åŸºç¡€è®¾æ–½ï¼Œå¼€ç®±å³ç”¨ï¼Œæ— éœ€å¤æ‚é…ç½®</li>
<li><strong>é€šç”¨å…¼å®¹</strong>ï¼šåŸºäº GUI æ“ä½œï¼Œæ— éœ€ App å‚å•†é€‚é…ï¼Œæ”¯æŒæ‰€æœ‰åº”ç”¨</li>
</ol>
<h3 data-id="heading-24">1.2 æŠ€æœ¯æ ˆç»„æˆ</h3>
<ul>
<li><strong>æ¨¡å‹å±‚</strong>ï¼šGELab-Zero-4B-previewï¼ˆåŸºäº Qwen3-VL-4B-Instruct å¾®è°ƒçš„ 4B å‚æ•°å¤šæ¨¡æ€è§†è§‰æ¨¡å‹ï¼‰</li>
<li><strong>æ¨ç†æœåŠ¡</strong>ï¼šOllama / vLLMï¼ˆæœ¬åœ°æ¨ç†ï¼‰</li>
<li><strong>è®¾å¤‡æ§åˆ¶</strong>ï¼šADBï¼ˆAndroid Debug Bridgeï¼‰</li>
<li><strong>ä»»åŠ¡ç¼–æ’</strong>ï¼šLocalServer + PU Client</li>
<li><strong>å¯è§†åŒ–</strong>ï¼šStreamlit Web ç•Œé¢</li>
</ul>
<h3 data-id="heading-25">1.3 å¼€æºä»·å€¼æ·±åº¦è§£æï¼šå•†ä¸šå·¨å¤´é˜´å½±ä¸‹çš„"å®ˆç«äºº"</h3>
<p>åœ¨å­—èŠ‚è·³åŠ¨è±†åŒ…ç­‰å•†ä¸šäº§å“å±•ç°å‡ºå¼ºå¤§çš„ç³»ç»Ÿçº§ç»Ÿæ²»åŠ›æ—¶ï¼ŒGELab-Zero è¿™æ ·çš„å¼€æºé¡¹ç›®å¹¶éæ¯«æ— æ„ä¹‰çš„"é‡å¤é€ è½®å­"ï¼Œè€Œæ˜¯æ„å»ºäº†å¦ä¸€æ¡å¿…ä¸å¯å°‘çš„æŠ€æœ¯æŠ¤åŸæ²³ã€‚è™½ç„¶åœ¨æµç•…åº¦å’Œç³»ç»Ÿæƒé™ä¸Šä¸å¦‚å•†ä¸šäº§å“ï¼Œä½†å…¶ç‹¬ç‰¹ä»·å€¼åœ¨äºï¼š</p>
<ol>
<li>
<p><strong>æ‰“ç ´"å›´å¢™èŠ±å›­"ï¼ˆé’ˆå¯¹å­˜é‡å¸‚åœºï¼‰</strong>
å•†ä¸šäº§å“ï¼ˆå¦‚è±†åŒ…+ä¸­å…´ï¼‰ä¾èµ–äºæ’ä»–æ€§çš„å‚å•†åˆä½œä¸ç§æœ‰ç³»ç»Ÿ APIã€‚GELab-Zero è¯æ˜äº†<strong>çº¯è§†è§‰æ–¹æ¡ˆï¼ˆVisual-basedï¼‰<strong>çš„å¯è¡Œæ€§â€”â€”å³ä½¿æ²¡æœ‰ä»»ä½•å‚å•†ç‰¹æƒï¼Œä»…å‡­å±å¹•æˆªå›¾ä¹Ÿèƒ½å®ç°å¤æ‚çš„ Agent äº¤äº’ã€‚è¿™æ„å‘³ç€å®ƒèƒ½åœ¨æ•°ä»¥äº¿è®¡çš„</strong>å­˜é‡æ—§æ‰‹æœº</strong>ä¸Šè¿è¡Œï¼Œè€Œä¸æ˜¯å¼ºè¿«ç”¨æˆ·è´­ä¹°ç‰¹å®šçš„æ–°æ¬¾"AI æ‰‹æœº"ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®ä¸»æƒçš„"æœ€åé˜²çº¿"ï¼ˆé’ˆå¯¹æ•æ„Ÿåœºæ™¯ï¼‰</strong>
å•†ä¸šåŠ©æ‰‹è™½ç„¶å¼ºè°ƒ"ç«¯ä¾§éšç§"ï¼Œä½†ä¸ºäº†è¿½æ±‚æè‡´æ•ˆæœï¼Œæ ¸å¿ƒçš„é•¿ç¨‹æ¨ç†ï¼ˆReasoningï¼‰å¾€å¾€ä»ä¾èµ–äº‘ç«¯å¤§æ¨¡å‹ï¼ˆCloud-Edge Collaborationï¼‰ã€‚GELab-Zero æ˜¯çœŸæ­£çš„<strong>å…¨é“¾è·¯æœ¬åœ°åŒ–ï¼ˆLocal-Firstï¼‰</strong>ï¼Œä»æ¨¡å‹æƒé‡åˆ°æ¨ç†è¿‡ç¨‹å®Œå…¨æŒæ¡åœ¨ç”¨æˆ·æ‰‹ä¸­ã€‚å¯¹äº<strong>é‡‘èå®¡è®¡ã€åŒ»ç–—æ•°æ®å¤„ç†ã€ä¼ä¸šå†…ç½‘åŠå…¬</strong>ç­‰å¯¹æ•°æ®å¤–æ³„é›¶å®¹å¿çš„åœºæ™¯ï¼Œè¿™æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚</p>
</li>
<li>
<p><strong>é€æ˜å¯æ§çš„"ç™½ç›’"åŸºåº§ï¼ˆé’ˆå¯¹å¼€å‘è€…ï¼‰</strong>
å¯¹äºå­¦æœ¯ç•Œå’Œå¼€å‘è€…ï¼Œå•†ä¸šåŠ©æ‰‹æ˜¯"é»‘ç›’"ï¼Œåªèƒ½è°ƒç”¨ï¼Œæ— æ³•æ¢ç©¶å…¶å†³ç­–é€»è¾‘ã€‚GELab-Zero æä¾›äº†ä»æ•°æ®é‡‡é›†ï¼ˆAndroidDailyï¼‰ã€åŠ¨ä½œå®šä¹‰ï¼ˆActTreeï¼‰åˆ°æ¨¡å‹è®­ç»ƒçš„å®Œæ•´**ç™½ç›’ï¼ˆWhite-boxï¼‰**æµç¨‹ã€‚å®ƒæ˜¯ç ”ç©¶ Agent å¹»è§‰ã€ä¼˜åŒ–å¤šæ­¥æ¨ç†æœºåˆ¶çš„æœ€ä½³å®éªŒå°ï¼Œä¸ºè¡Œä¸šå»ºç«‹äº†å…¬å¼€é€æ˜çš„æŠ€æœ¯æ ‡å‡†ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-26">äºŒã€ç³»ç»Ÿæ¶æ„æ·±åº¦è§£æ</h2>
<h3 data-id="heading-27">2.1 æ•´ä½“æ¶æ„å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e449caaac2a14ee29499325dee486ae8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWH6Iie57K-6YCJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766494378&amp;x-signature=r72fl3npN5PyYiLCZ8FMFHC44NI%3D" loading="lazy"/>
<h3 data-id="heading-28">2.2 æ ¸å¿ƒç»„ä»¶è¯¦è§£</h3>
<h4 data-id="heading-29">2.2.1 LocalServerï¼ˆä»»åŠ¡ç¼–æ’æœåŠ¡å™¨ï¼‰</h4>
<p><strong>èŒè´£</strong>ï¼š</p>
<ul>
<li>æ¥æ”¶ç”¨æˆ·ä»»åŠ¡æŒ‡ä»¤</li>
<li>ç®¡ç†ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€</li>
<li>åè°ƒè§†è§‰ç†è§£å’Œè®¾å¤‡æ§åˆ¶</li>
<li>è®°å½•å®Œæ•´æ‰§è¡Œè½¨è¿¹</li>
</ul>
<p><strong>å…³é”®é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python">tmp_server_config = {
    <span class="hljs-string">"log_dir"</span>: <span class="hljs-string">"running_log/server_log/os-copilot-local-eval-logs/traces"</span>,
    <span class="hljs-string">"image_dir"</span>: <span class="hljs-string">"running_log/server_log/os-copilot-local-eval-logs/images"</span>,
    <span class="hljs-string">"debug"</span>: <span class="hljs-literal">False</span>
}
</code></pre>
<h4 data-id="heading-30">2.2.2 GELab-Zero-4B-preview æ¨¡å‹ä¸æ¶æ„</h4>
<p><strong>ä¸‰å±‚æ¶æ„è®¾è®¡</strong>ï¼š
GELab-Zero é‡‡ç”¨äº†ç±»ä¼¼ MobiAgent çš„ä¸‰å±‚æ¶æ„ï¼Œä»¥ç¡®ä¿å¤æ‚ä»»åŠ¡çš„æ‰§è¡Œèƒ½åŠ›ï¼š</p>
<ol>
<li><strong>Planner (è§„åˆ’å¸ˆ)</strong>ï¼šè´Ÿè´£ä»»åŠ¡æ‹†è§£å’Œæ•´ä½“æµç¨‹æ§åˆ¶ã€‚</li>
<li><strong>Decider (å†³ç­–è€…)</strong>ï¼šæ ¹æ®å½“å‰å±å¹•çŠ¶æ€å†³å®šå…·ä½“æ“ä½œã€‚</li>
<li><strong>Ground (æ‰§è¡Œè€…)</strong>ï¼šå°†å†³ç­–è½¬åŒ–ä¸ºå…·ä½“çš„åæ ‡ç‚¹å‡»æˆ–æ–‡æœ¬è¾“å…¥ã€‚</li>
</ol>
<p><strong>æ¨¡å‹ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>å‚æ•°è§„æ¨¡</strong>ï¼š4Bï¼ˆ40 äº¿å‚æ•°ï¼‰ï¼Œä¸“ä¸ºæ¶ˆè´¹çº§ç¡¬ä»¶ä¼˜åŒ–ã€‚</li>
<li><strong>æ€§èƒ½è¡¨ç°</strong>ï¼šåœ¨ ScreenSpotã€OSWorldã€Android World ç­‰å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­æ‹¿ä¸‹åŒå°ºå¯¸ SOTAã€‚</li>
<li><strong>å¤šæ¨¡æ€è¾“å…¥</strong>ï¼šæ‰‹æœºæˆªå›¾ + ä»»åŠ¡æè¿° + å†å²æ“ä½œã€‚</li>
</ul>
<p><strong>åŸºåº§æ¨¡å‹</strong>ï¼š
è¯¥æ¨¡å‹æ˜¯åŸºäº <strong>Qwen3-VL-4B-Instruct</strong> è¿›è¡Œå¾®è°ƒçš„ã€‚é€‰æ‹© Qwen3-VL ä½œä¸ºåŸºåº§æ˜¯å› ä¸ºå…¶åœ¨å°å‚æ•°é‡çº§ä¸‹å±•ç°å‡ºäº†å“è¶Šçš„è§†è§‰ç†è§£å’ŒæŒ‡ä»¤éµå¾ªèƒ½åŠ›ï¼Œéå¸¸é€‚åˆç«¯ä¾§éƒ¨ç½²åœºæ™¯ã€‚</p>
<p><strong>æŠ€æœ¯äº®ç‚¹ï¼šActTree ä»»åŠ¡åˆ†å‘</strong>
ä¸ºäº†æå‡æ•ˆç‡ï¼Œç³»ç»Ÿå¼•å…¥äº† <strong>å¤šè®¾å¤‡ä»»åŠ¡åˆ†å‘ç³»ç»Ÿ</strong>ã€‚é€šè¿‡ ActTree ç»“æ„è®°å½•å¹¶å¤ç”¨å†å²æ“ä½œè½¨è¿¹ï¼Œå¤§å¹…å‡å°‘é‡å¤æ¨ç†ã€‚åœ¨æ¨¡æ‹ŸçœŸå®ç”¨æˆ·ä¹ æƒ¯ï¼ˆ80% è¯·æ±‚é›†ä¸­åœ¨ 20% ä»»åŠ¡ï¼‰çš„æµ‹è¯•ä¸­ï¼Œ<strong>åŠ¨ä½œå¤ç”¨ç‡å¯è¾¾ 60%-85%</strong>ï¼Œå¸¦æ¥ 2 åˆ° 3 å€çš„æ€§èƒ½æå‡ã€‚</p>
<p><strong>æ¨ç†é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python">local_model_config = {
    <span class="hljs-string">"model_name"</span>: <span class="hljs-string">"gelab-zero-4b-preview"</span>,
    <span class="hljs-string">"model_provider"</span>: <span class="hljs-string">"local"</span>,
    <span class="hljs-string">"args"</span>: {
        <span class="hljs-string">"temperature"</span>: <span class="hljs-number">0.1</span>,      <span class="hljs-comment"># ä½æ¸©åº¦ä¿è¯ç¨³å®šæ€§</span>
        <span class="hljs-string">"top_p"</span>: <span class="hljs-number">0.95</span>,
        <span class="hljs-string">"frequency_penalty"</span>: <span class="hljs-number">0.0</span>,
        <span class="hljs-string">"max_tokens"</span>: <span class="hljs-number">4096</span>,
    }
}
</code></pre>
<h4 data-id="heading-31">2.2.3 åŠ¨ä½œç©ºé—´å®šä¹‰</h4>
<p>ç³»ç»Ÿæ”¯æŒ 9 ç±»åŸºç¡€æ“ä½œï¼š</p>























































<table><thead><tr><th>åŠ¨ä½œç±»å‹</th><th>è¯´æ˜</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><strong>CLICK</strong></td><td>ç‚¹å‡»å±å¹•åæ ‡</td><td>point (x,y)</td></tr><tr><td><strong>TYPE</strong></td><td>è¾“å…¥æ–‡æœ¬</td><td>value (æ–‡æœ¬å†…å®¹), point (è¾“å…¥æ¡†ä½ç½®)</td></tr><tr><td><strong>SLIDE</strong></td><td>æ»‘åŠ¨æ“ä½œ</td><td>point1 (èµ·ç‚¹), point2 (ç»ˆç‚¹)</td></tr><tr><td><strong>LONGPRESS</strong></td><td>é•¿æŒ‰æ“ä½œ</td><td>point (åæ ‡)</td></tr><tr><td><strong>AWAKE</strong></td><td>å”¤é†’åº”ç”¨</td><td>value (åº”ç”¨åç§°)</td></tr><tr><td><strong>WAIT</strong></td><td>ç­‰å¾…</td><td>value (ç§’æ•°)</td></tr><tr><td><strong>INFO</strong></td><td>è¯¢é—®ç”¨æˆ·</td><td>value (é—®é¢˜å†…å®¹)</td></tr><tr><td><strong>COMPLETE</strong></td><td>ä»»åŠ¡å®Œæˆ</td><td>return (ç»“æœæŠ¥å‘Š)</td></tr><tr><td><strong>ABORT</strong></td><td>ç»ˆæ­¢ä»»åŠ¡</td><td>value (ç»ˆæ­¢åŸå› )</td></tr></tbody></table>
<p><strong>åæ ‡ç³»ç»Ÿ</strong>ï¼š</p>
<ul>
<li>åŸç‚¹ï¼šå·¦ä¸Šè§’ (0, 0)</li>
<li>X è½´ï¼šå‘å³é€’å¢</li>
<li>Y è½´ï¼šå‘ä¸‹é€’å¢</li>
<li>å–å€¼èŒƒå›´ï¼š0-1000ï¼ˆå½’ä¸€åŒ–åæ ‡ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-32">ä¸‰ã€å®æˆ˜æ¡ˆä¾‹ï¼šæ·˜å®è´­ä¹¦ä»»åŠ¡å…¨æµç¨‹è§£æ</h2>
<h3 data-id="heading-33">3.1 ä»»åŠ¡èƒŒæ™¯</h3>
<p><strong>ä»»åŠ¡æè¿°</strong>ï¼šå»æ·˜å®å¸®æˆ‘ä¹°æœ¬ä¹¦<br/>
<strong>Session ID</strong>ï¼š<code>1fe9db3f-92c8-4ae9-89bc-1d035d4bf59b</code><br/>
<strong>æ‰§è¡Œæ—¶é—´</strong>ï¼š2025-12-05 18:41:39 - 18:46:55<br/>
<strong>æ€»æ­¥éª¤æ•°</strong>ï¼š9 æ­¥<br/>
<strong>æ¨¡å‹é…ç½®</strong>ï¼šgelab-zero-4b-preview (æœ¬åœ°æ¨ç†)
<strong>è®¾å¤‡ç¯å¢ƒ</strong>ï¼šMacBook Pro (Apple M3 Pro, 18GB RAM)
<strong>é‡åŒ–è¯´æ˜</strong>ï¼šå›  18GB ç»Ÿä¸€å†…å­˜è¿è¡Œ FP16 åŸç”Ÿæ¨¡å‹ä¼šè§¦å‘ç³»ç»Ÿå¡æ­»ï¼Œæœ¬æ¡ˆä¾‹ä½¿ç”¨äº† Int8 é‡åŒ–æ¨¡å‹ (<code>q8_0</code>) è¿›è¡Œæ¨ç†ã€‚</p>
<h3 data-id="heading-34">3.2 å®Œæ•´æ‰§è¡Œæµç¨‹</h3>
<h4 data-id="heading-35">æ­¥éª¤ 1ï¼šåº”ç”¨å”¤é†’ï¼ˆAWAKEï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°çš„æ˜¯æ‰‹æœºä¸»å±å¹•ã€‚ä»»åŠ¡æ˜¯å»æ·˜å®ä¹°ä¹¦ã€‚ç¬¬ä¸€æ­¥å°±æ˜¯è¦æ‰“å¼€æ·˜å®åº”ç”¨ã€‚æˆ‘çœ‹åˆ°å±å¹•ä¸Šæœ‰'äº¬ä¸œ'åº”ç”¨ï¼Œä½†ä»»åŠ¡æ˜ç¡®è¦æ±‚ä½¿ç”¨'æ·˜å®'ã€‚å› æ­¤ï¼Œæˆ‘éœ€è¦å…ˆå¯åŠ¨æ·˜å®åº”ç”¨ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: AWAKE</span>
<span class="hljs-section">value: æ·˜å®</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š20.43 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¨¡å‹èƒ½å¤ŸåŒºåˆ†ä¸åŒçš„ç”µå•†åº”ç”¨ï¼ˆäº¬ä¸œ vs æ·˜å®ï¼‰</li>
<li>å‡†ç¡®ç†è§£ä»»åŠ¡æŒ‡ä»¤ä¸­çš„åº”ç”¨è¦æ±‚</li>
<li>ä½¿ç”¨ AWAKE æŒ‡ä»¤ç›´æ¥å”¤é†’åº”ç”¨ï¼Œè€Œéæ‰‹åŠ¨æŸ¥æ‰¾ç‚¹å‡»</li>
</ul>
<hr/>
<h4 data-id="heading-36">æ­¥éª¤ 2ï¼šæœç´¢æ¡†å®šä½ï¼ˆCLICKï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰æ˜¯æ·˜å®çš„é¦–é¡µã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ä¸€æœ¬ä¹¦ã€‚ä¸ºäº†æ‰¾åˆ°ä¹¦ï¼Œæˆ‘éœ€è¦ä½¿ç”¨æœç´¢åŠŸèƒ½ã€‚æˆ‘è§‚å¯Ÿåˆ°é¡µé¢é¡¶éƒ¨æœ‰ä¸€ä¸ªæœç´¢æ¡†ï¼Œé‡Œé¢æœ‰'å¹²è„†é¢'çš„æç¤ºæ–‡å­—ã€‚æˆ‘éœ€è¦ç‚¹å‡»è¿™ä¸ªæœç´¢æ¡†æ¥æ¿€æ´»å®ƒã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: CLICK</span>
<span class="hljs-section">point: 375,117</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š20.69 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li>å‡†ç¡®è¯†åˆ«æœç´¢æ¡†çš„è§†è§‰ä½ç½®</li>
<li>ç†è§£éœ€è¦å…ˆæ¿€æ´»æœç´¢æ¡†æ‰èƒ½è¾“å…¥</li>
<li>åæ ‡ç²¾å‡†å®šä½ï¼ˆå±å¹•ä¸­ä¸Šéƒ¨åŒºåŸŸï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-37">æ­¥éª¤ 3ï¼šæ–‡æœ¬è¾“å…¥ï¼ˆTYPEï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯æ·˜å®çš„æœç´¢é¡µé¢ï¼Œé”®ç›˜å·²ç»å¼¹èµ·ï¼Œå…‰æ ‡åœ¨æœç´¢æ¡†ä¸­ã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ä¸€æœ¬ä¹¦ã€‚ç°åœ¨æˆ‘éœ€è¦è¾“å…¥è¦æœç´¢çš„å…³é”®è¯ã€‚ä¸ºäº†æ‰¾åˆ°ä¹¦ï¼Œæˆ‘åº”è¯¥åœ¨æœç´¢æ¡†ä¸­è¾“å…¥'ä¹¦'ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: TYPE</span>
<span class="hljs-section">value: ä¹¦</span>
<span class="hljs-section">point: 213,132</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š22.23 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li>è¯†åˆ«è¾“å…¥æ¡†çš„æ¿€æ´»çŠ¶æ€ï¼ˆé”®ç›˜å¼¹èµ·ï¼‰</li>
<li>æå–ä»»åŠ¡å…³é”®è¯ï¼ˆ"ä¹°ä¹¦" â†’ æœç´¢"ä¹¦"ï¼‰</li>
<li>TYPE åŠ¨ä½œéœ€è¦åŒæ—¶æä¾›æ–‡æœ¬å†…å®¹å’Œè¾“å…¥æ¡†ä½ç½®</li>
</ul>
<hr/>
<h4 data-id="heading-38">æ­¥éª¤ 4ï¼šæ‰§è¡Œæœç´¢ï¼ˆCLICKï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯æ·˜å®çš„æœç´¢é¡µé¢ï¼Œæœç´¢æ¡†é‡Œå·²ç»è¾“å…¥äº†'ä¹¦'ã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ä¸€æœ¬ä¹¦ï¼Œç°åœ¨éœ€è¦æ‰§è¡Œæœç´¢æ¥æŸ¥çœ‹æœ‰å“ªäº›ä¹¦å¯ä»¥é€‰ã€‚å› æ­¤ï¼Œæˆ‘åº”è¯¥ç‚¹å‡»æœç´¢æ¡†æ—è¾¹çš„æ©™è‰²'æœç´¢'æŒ‰é’®ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: CLICK</span>
<span class="hljs-section">point: 896,130</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š21.06 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li>è¯†åˆ«"æœç´¢"æŒ‰é’®çš„è§†è§‰ç‰¹å¾ï¼ˆæ©™è‰²ã€ä½ç½®ï¼‰</li>
<li>ç†è§£æœç´¢æµç¨‹çš„å®Œæ•´æ€§ï¼ˆè¾“å…¥ â†’ ç‚¹å‡»æœç´¢ï¼‰</li>
<li>å³ä¸Šè§’æŒ‰é’®çš„ç²¾å‡†ç‚¹å‡»</li>
</ul>
<hr/>
<h4 data-id="heading-39">æ­¥éª¤ 5ï¼šä¿¡æ¯è¯¢é—®ï¼ˆINFOï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯'ä¹¦'çš„æœç´¢ç»“æœé¡µã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ä¸€æœ¬ä¹¦ï¼Œä½†ç”¨æˆ·æ²¡æœ‰æŒ‡å®šå…·ä½“ä¹¦åã€‚ä¸ºäº†ç»§ç»­ä»»åŠ¡ï¼Œæˆ‘éœ€è¦çŸ¥é“ç”¨æˆ·æƒ³ä¹°å“ªä¸€æœ¬ä¹¦ã€‚å› æ­¤ï¼Œæˆ‘åº”è¯¥å‘ç”¨æˆ·è¯¢é—®ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: INFO</span>
<span class="hljs-section">value: è¯·é—®æ‚¨æƒ³ä¹°å“ªæœ¬ä¹¦ï¼Ÿ</span>
</code></pre>
<p><strong>ç”¨æˆ·å›å¤</strong>ï¼šæˆ‘æƒ³ä¹°æ˜æœé‚£äº›äº‹</p>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š20.63 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ä¸»åŠ¨ä¿¡æ¯è·å–</strong>ï¼šæ¨¡å‹æ„è¯†åˆ°ä»»åŠ¡ä¿¡æ¯ä¸å®Œæ•´</li>
<li><strong>äº¤äº’å¼å†³ç­–</strong>ï¼šé€šè¿‡ INFO åŠ¨ä½œæš‚åœæ‰§è¡Œï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥</li>
<li><strong>ä¸Šä¸‹æ–‡ç†è§£</strong>ï¼šè®°ä½ç”¨æˆ·å›å¤ï¼Œç»§ç»­æ‰§è¡Œåç»­æ­¥éª¤</li>
</ul>
<hr/>
<h4 data-id="heading-40">æ­¥éª¤ 6ï¼šå¼¹çª—å¤„ç†ï¼ˆCLICKï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯'ä¹¦'çš„æœç´¢ç»“æœé¡µï¼Œä½†æœ‰ä¸€ä¸ª'æ·˜å®åŒ12'çš„æ¶ˆè´¹åˆ¸å¼¹çª—è¦†ç›–åœ¨ä¸Šé¢ï¼Œé˜»ç¢äº†åç»­æ“ä½œã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ã€Šæ˜æœé‚£äº›äº‹ã€‹ï¼Œæ‰€ä»¥å¿…é¡»å…ˆå¤„ç†æ‰è¿™ä¸ªå¼¹çª—ã€‚æˆ‘è§‚å¯Ÿåˆ°å¼¹çª—ä¸‹æ–¹æœ‰ä¸€ä¸ª'X'å…³é—­æŒ‰é’®ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: CLICK</span>
<span class="hljs-section">point: 500,710</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š22.28 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¹²æ‰°è¯†åˆ«</strong>ï¼šå‡†ç¡®åˆ¤æ–­å¼¹çª—æ˜¯é˜»ç¢å› ç´ </li>
<li><strong>ä¼˜å…ˆçº§å¤„ç†</strong>ï¼šå…ˆæ¸…é™¤éšœç¢å†ç»§ç»­ä¸»ä»»åŠ¡</li>
<li><strong>ç»†èŠ‚å…³æ³¨</strong>ï¼šå®šä½å…³é—­æŒ‰é’®çš„ä½ç½®</li>
</ul>
<hr/>
<h4 data-id="heading-41">æ­¥éª¤ 7ï¼šå•†å“é€‰æ‹©ï¼ˆCLICKï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯'ä¹¦'çš„æœç´¢ç»“æœåˆ—è¡¨ã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°ã€Šæ˜æœé‚£äº›äº‹ã€‹ã€‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå•†å“å°±æ˜¯'æ–°ç‰ˆå…¨9å†Œ æ˜æœé‚£äº›äº‹å„¿å…¨å¥—1-9å†Œ'ï¼Œè¿™æ­£æ˜¯æˆ‘è¦æ‰¾çš„ä¹¦ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: CLICK</span>
<span class="hljs-section">point: 258,445</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š19.94 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å•†å“åŒ¹é…</strong>ï¼šä»æœç´¢ç»“æœä¸­è¯†åˆ«ç›®æ ‡å•†å“</li>
<li><strong>æ–‡æœ¬ç†è§£</strong>ï¼š"æ˜æœé‚£äº›äº‹" = "æ˜æœé‚£äº›äº‹å„¿"ï¼ˆè¿‘ä¹‰è¯åŒ¹é…ï¼‰</li>
<li><strong>è§†è§‰å®šä½</strong>ï¼šåœ¨å•†å“åˆ—è¡¨ä¸­å‡†ç¡®å®šä½ç›®æ ‡</li>
</ul>
<hr/>
<h4 data-id="heading-42">æ­¥éª¤ 8ï¼šç«‹å³è´­ä¹°ï¼ˆCLICKï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯ã€Šæ˜æœé‚£äº›äº‹å„¿ã€‹çš„å•†å“è¯¦æƒ…é¡µã€‚ä»»åŠ¡ç›®æ ‡æ˜¯è´­ä¹°è¿™æœ¬ä¹¦ã€‚ä¸ºäº†ç»§ç»­è´­ä¹°æµç¨‹ï¼Œæˆ‘éœ€è¦ç‚¹å‡»é¡µé¢åº•éƒ¨çš„'ç«‹å³è´­ä¹°'æŒ‰é’®ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">action: CLICK</span>
<span class="hljs-section">point: 836,946</span>
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š19.32 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>é¡µé¢ç†è§£</strong>ï¼šè¯†åˆ«å•†å“è¯¦æƒ…é¡µçš„å¸ƒå±€ç»“æ„</li>
<li><strong>æŒ‰é’®å®šä½</strong>ï¼šå‡†ç¡®æ‰¾åˆ°åº•éƒ¨è´­ä¹°æŒ‰é’®</li>
<li><strong>æµç¨‹æ¨è¿›</strong>ï¼šç†è§£ç”µå•†è´­ç‰©çš„æ ‡å‡†æµç¨‹</li>
</ul>
<hr/>
<h4 data-id="heading-43">æ­¥éª¤ 9ï¼šä»»åŠ¡å®Œæˆï¼ˆCOMPLETEï¼‰</h4>
<p><strong>æ¨¡å‹æ€è€ƒ</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘çœ‹åˆ°å½“å‰ç•Œé¢æ˜¯è®¢å•ç¡®è®¤é¡µã€‚ä»»åŠ¡æ˜¯è´­ä¹°ä¸€æœ¬ä¹¦ï¼Œæˆ‘å·²ç»å®Œæˆäº†å•†å“é€‰æ‹©ã€åŠ å…¥è´­ç‰©è½¦ã€è¿›å…¥ç»“ç®—çš„æ‰€æœ‰æ­¥éª¤ã€‚ç°åœ¨é¡µé¢æ˜¾ç¤ºäº†æ”¶è´§åœ°å€ã€å•†å“ä¿¡æ¯å’Œæ”¯ä»˜é‡‘é¢243å…ƒã€‚ç”±äºè¿™æ˜¯æ¶‰åŠé‡‘é’±äº¤æ˜“çš„æœ€åä¸€æ­¥ï¼Œæˆ‘åº”è¯¥åœ¨è¿™é‡Œåœæ­¢æ“ä½œï¼Œå¹¶å‘ç”¨æˆ·æŠ¥å‘Šè®¢å•çš„è¯¦ç»†ä¿¡æ¯ã€‚"</p>
</blockquote>
<p><strong>æ‰§è¡ŒåŠ¨ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">action: COMPLETE
return: æˆ‘å·²å®Œæˆè´­ä¹¦æµç¨‹å¹¶åˆ°è¾¾è®¢å•ç¡®è®¤é¡µé¢ã€‚
è®¢å•è¯¦æƒ…å¦‚ä¸‹ï¼š
<span class="hljs-deletion">- å•†å“ï¼šæ­£ç‰ˆã€Šæ˜æœé‚£äº›äº‹å„¿ã€‹å…¨å¥—1-9å†Œ</span>
<span class="hljs-deletion">- æ”¶è´§åœ°å€ï¼šxxx xxxxxxxxxx</span>
<span class="hljs-deletion">- æ”¯ä»˜é‡‘é¢ï¼šÂ¥243</span>
<span class="hljs-deletion">- æ”¯ä»˜æ–¹å¼ï¼šå…ˆç”¨åä»˜</span>
è¯·æ‚¨ç¡®è®¤ä»¥ä¸Šä¿¡æ¯æ— è¯¯åï¼Œå¯ä»¥ç‚¹å‡»é¡µé¢åº•éƒ¨çš„"å…ˆç”¨åä»˜ï¼Œç¡®è®¤æ”¶è´§åä»˜æ¬¾ Â¥243"æŒ‰é’®ç»§ç»­å®Œæˆæ”¯ä»˜ã€‚
</code></pre>
<p><strong>æ¨ç†è€—æ—¶</strong>ï¼š25.83 ç§’</p>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å®‰å…¨è¾¹ç•Œ</strong>ï¼šåœ¨æ”¯ä»˜å‰åœæ­¢ï¼Œä¸æ‰§è¡Œæ•æ„Ÿæ“ä½œ</li>
<li><strong>ä¿¡æ¯æå–</strong>ï¼šä»è®¢å•é¡µé¢æå–å…³é”®ä¿¡æ¯</li>
<li><strong>å®Œæ•´æ±‡æŠ¥</strong>ï¼šå‘ç”¨æˆ·æ¸…æ™°æŠ¥å‘Šä»»åŠ¡å®ŒæˆçŠ¶æ€å’Œåç»­æ“ä½œå»ºè®®</li>
</ul>
<hr/>
<h3 data-id="heading-44">3.3 æ€§èƒ½ç»Ÿè®¡</h3>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th></tr></thead><tbody><tr><td><strong>æ€»æ­¥éª¤æ•°</strong></td><td>9 æ­¥</td></tr><tr><td><strong>æ€»æ‰§è¡Œæ—¶é—´</strong></td><td>~5 åˆ†é’Ÿ 16 ç§’</td></tr><tr><td><strong>å¹³å‡æ¯æ­¥æ¨ç†æ—¶é—´</strong></td><td>~21 ç§’</td></tr><tr><td><strong>æˆåŠŸç‡</strong></td><td>100% (å®Œæˆåˆ°è®¢å•ç¡®è®¤é¡µ)</td></tr><tr><td><strong>ç”¨æˆ·äº¤äº’æ¬¡æ•°</strong></td><td>1 æ¬¡ (è¯¢é—®ä¹¦å)</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-45">å››ã€æŠ€æœ¯äº®ç‚¹ä¸åˆ›æ–°</h2>
<h3 data-id="heading-46">4.1 å¤šæ¨¡æ€æ¨ç†èƒ½åŠ›</h3>
<p>GELab-Zero çš„ 4B æ¨¡å‹å±•ç°äº†å¼ºå¤§çš„è§†è§‰-è¯­è¨€ç†è§£èƒ½åŠ›ï¼š</p>
<ol>
<li>
<p><strong>è§†è§‰å…ƒç´ è¯†åˆ«</strong>ï¼š</p>
<ul>
<li>æœç´¢æ¡†ã€æŒ‰é’®ã€å•†å“åˆ—è¡¨</li>
<li>å¼¹çª—ã€é”®ç›˜çŠ¶æ€</li>
<li>æ–‡å­—å†…å®¹ï¼ˆå•†å“åã€ä»·æ ¼ã€åœ°å€ï¼‰</li>
</ul>
</li>
<li>
<p><strong>è¯­ä¹‰ç†è§£</strong>ï¼š</p>
<ul>
<li>ä»»åŠ¡ç›®æ ‡æ‹†è§£ï¼ˆ"ä¹°ä¹¦" â†’ æœç´¢ â†’ é€‰æ‹© â†’ è´­ä¹°ï¼‰</li>
<li>è¿‘ä¹‰è¯åŒ¹é…ï¼ˆ"æ˜æœé‚£äº›äº‹" â‰ˆ "æ˜æœé‚£äº›äº‹å„¿"ï¼‰</li>
<li>ä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼ˆè®°ä½ç”¨æˆ·æŒ‡å®šçš„ä¹¦åï¼‰</li>
</ul>
</li>
<li>
<p><strong>é€»è¾‘æ¨ç†</strong>ï¼š</p>
<ul>
<li>åˆ¤æ–­ä»»åŠ¡å®Œæˆåº¦</li>
<li>è¯†åˆ«é˜»ç¢å› ç´ ï¼ˆå¼¹çª—ï¼‰</li>
<li>å†³å®šä½•æ—¶è¯¢é—®ç”¨æˆ·ã€ä½•æ—¶åœæ­¢æ“ä½œ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-47">4.2 å®‰å…¨æ€§è®¾è®¡</h3>
<ol>
<li>
<p><strong>æ•æ„Ÿæ“ä½œä¿æŠ¤</strong>ï¼š</p>
<ul>
<li>åœ¨æ”¯ä»˜å‰åœæ­¢ï¼Œä¸æ‰§è¡Œé‡‘èäº¤æ˜“</li>
<li>ä½¿ç”¨ COMPLETE åŠ¨ä½œæ±‡æŠ¥ç»“æœï¼Œç”±ç”¨æˆ·ç¡®è®¤</li>
</ul>
</li>
<li>
<p><strong>å®Œå…¨æœ¬åœ°åŒ–</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰æ¨ç†åœ¨æœ¬åœ°å®Œæˆ</li>
<li>æˆªå›¾å’Œæ—¥å¿—å­˜å‚¨åœ¨æœ¬åœ°</li>
<li>æ— éœ€ç½‘ç»œä¼ è¾“ç”¨æˆ·æ•°æ®</li>
</ul>
</li>
<li>
<p><strong>è½¨è¿¹å¯è¿½æº¯</strong>ï¼š</p>
<ul>
<li>æ¯ä¸€æ­¥æ“ä½œéƒ½æœ‰å®Œæ•´æ—¥å¿—</li>
<li>åŒ…å«æ¨¡å‹æ€è€ƒè¿‡ç¨‹ï¼ˆCoTï¼‰</li>
<li>å¯é€šè¿‡ Streamlit å¯è§†åŒ–æŸ¥çœ‹</li>
</ul>
</li>
</ol>
<h3 data-id="heading-48">4.3 å·¥ç¨‹åŒ–è®¾è®¡</h3>
<ol>
<li>
<p><strong>æ¨¡å—åŒ–æ¶æ„</strong>ï¼š</p>
<ul>
<li>Server å±‚ã€Client å±‚ã€Frontend å±‚åˆ†ç¦»</li>
<li>æ˜“äºæ‰©å±•å’Œç»´æŠ¤</li>
</ul>
</li>
<li>
<p><strong>æ—¥å¿—ç³»ç»Ÿ</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python">{
    <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"å”¯ä¸€æ ‡è¯†"</span>,
    <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"æ—¶é—´æˆ³"</span>,
    <span class="hljs-string">"message"</span>: {
        <span class="hljs-string">"environment"</span>: {
            <span class="hljs-string">"image"</span>: <span class="hljs-string">"æˆªå›¾è·¯å¾„"</span>,
            <span class="hljs-string">"user_comment"</span>: <span class="hljs-string">"ç”¨æˆ·åé¦ˆ"</span>
        },
        <span class="hljs-string">"action"</span>: {
            <span class="hljs-string">"cot"</span>: <span class="hljs-string">"æ€è€ƒè¿‡ç¨‹"</span>,
            <span class="hljs-string">"explain"</span>: <span class="hljs-string">"åŠ¨ä½œè§£é‡Š"</span>,
            <span class="hljs-string">"action"</span>: <span class="hljs-string">"åŠ¨ä½œç±»å‹"</span>,
            ...
        },
        <span class="hljs-string">"llm_cost"</span>: {
            <span class="hljs-string">"llm_time"</span>: <span class="hljs-string">"æ¨ç†è€—æ—¶"</span>,
            ...
        }
    }
}
</code></pre>
</li>
<li>
<p><strong>å¯è§†åŒ–å·¥å…·</strong>ï¼š</p>
<ul>
<li>Streamlit Web ç•Œé¢</li>
<li>å±•ç¤ºå®Œæ•´æ‰§è¡Œè½¨è¿¹</li>
<li>åœ¨æˆªå›¾ä¸Šæ ‡è®°æ“ä½œç‚¹ä½</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-49">äº”ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 data-id="heading-50">5.1 æ¨ç†é€Ÿåº¦ä¼˜åŒ–</h3>
<p><strong>å½“å‰ç“¶é¢ˆ</strong>ï¼šå¹³å‡æ¯æ­¥ ~21 ç§’</p>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ¨¡å‹é‡åŒ–ï¼ˆå…³é”®ï¼ï¼‰</strong>ï¼š
å®æµ‹å‘ç°ï¼Œåœ¨ Apple M3 Pro (18GB RAM) ç­‰ä¸­ç«¯é…ç½®ä¸Šï¼Œç›´æ¥è¿è¡Œ FP16 æ¨¡å‹å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºç”šè‡³ç³»ç»Ÿå¡æ­»ã€‚<strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨ Int8 æˆ– Int4 é‡åŒ–ç‰ˆæœ¬</strong>ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># INT8 é‡åŒ–ï¼ˆæœ¬æ¡ˆä¾‹ä½¿ç”¨ï¼Œå…¼é¡¾é€Ÿåº¦ä¸ç²¾åº¦ï¼Œé€‚åˆ 16GB+ å†…å­˜ï¼‰</span>
ollama create -q q8_0 gelab-zero-4b-preview

<span class="hljs-comment"># INT4 é‡åŒ–ï¼ˆé€Ÿåº¦æœ€å¿«ï¼Œé€‚åˆ 8GB/12GB å†…å­˜ï¼‰</span>
ollama create -q Q4_K_M gelab-zero-4b-preview
</code></pre>
</li>
<li>
<p><strong>å›¾åƒå°ºå¯¸è°ƒæ•´</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"resize_config"</span>: {
    <span class="hljs-string">"is_resize"</span>: <span class="hljs-literal">True</span>,
    <span class="hljs-string">"target_image_size"</span>: (<span class="hljs-number">756</span>, <span class="hljs-number">756</span>)  <span class="hljs-comment"># é™ä½åˆ†è¾¨ç‡</span>
}
</code></pre>
</li>
<li>
<p><strong>ç¡¬ä»¶å‡çº§ï¼ˆç«‹ç«¿è§å½±ï¼‰</strong>ï¼š
å¦‚æœé¢„ç®—å…è®¸ï¼Œå‡çº§ç¡¬ä»¶æ˜¯æå‡ä½“éªŒæœ€ç›´æ¥çš„æ–¹å¼ï¼š</p>
<ul>
<li><strong>Apple Silicon ç”¨æˆ·</strong>ï¼šå»ºè®®ä½¿ç”¨ M3 Max / M4 Max èŠ¯ç‰‡ï¼ˆé…å¤‡ 36GB+ ç»Ÿä¸€å†…å­˜ï¼‰ï¼Œå¯æµç•…è¿è¡Œ FP16 åŸç‰ˆæ¨¡å‹ï¼Œæ¨ç†å»¶è¿Ÿæœ‰æœ›é™ä½è‡³ <strong>3-5ç§’/æ­¥</strong>ã€‚</li>
<li><strong>NVIDIA GPU ç”¨æˆ·</strong>ï¼šä½¿ç”¨ RTX 4090 (24GB) æˆ– A100 (40GB/80GB) éƒ¨ç½²ï¼Œç»“åˆ vLLM æ¨ç†åŠ é€Ÿæ¡†æ¶ï¼Œå¯å®ç°äºšç§’çº§å“åº”ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ‰¹å¤„ç†æ¨ç†</strong>ï¼š</p>
<ul>
<li>å¯¹äºå¤šè®¾å¤‡ä»»åŠ¡ï¼Œä½¿ç”¨æ‰¹å¤„ç†æå‡ååé‡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-51">5.2 å‡†ç¡®æ€§æå‡</h3>
<ol>
<li>
<p><strong>æ¸©åº¦å‚æ•°è°ƒæ•´</strong>ï¼š</p>
<ul>
<li>å½“å‰ï¼š0.1ï¼ˆåä¿å®ˆï¼‰</li>
<li>å»ºè®®ï¼š0.0ï¼ˆå®Œå…¨ç¡®å®šæ€§ï¼‰æˆ– 0.05ï¼ˆå¹³è¡¡ï¼‰</li>
</ul>
</li>
<li>
<p><strong>Prompt ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å¢åŠ ä»»åŠ¡ç›¸å…³çš„ç¤ºä¾‹</li>
<li>ç»†åŒ–åŠ¨ä½œç©ºé—´çš„æè¿°</li>
</ul>
</li>
<li>
<p><strong>å¤šæ¨¡æ€èåˆ</strong>ï¼š</p>
<ul>
<li>ç»“åˆ OCR æå–æ–‡å­—</li>
<li>ä½¿ç”¨ UI å±‚æ¬¡ç»“æ„ä¿¡æ¯</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-52">å…­ã€åº”ç”¨åœºæ™¯æ‹“å±•</h2>
<h3 data-id="heading-53">6.1 ä¸ªäººåŠ©æ‰‹åœºæ™¯</h3>
<ul>
<li><strong>è´­ç‰©åŠ©æ‰‹</strong>ï¼šæ¯”ä»·ã€ä¸‹å•ã€è·Ÿè¸ªç‰©æµ</li>
<li><strong>å‡ºè¡ŒåŠ©æ‰‹</strong>ï¼šæ‰“è½¦ã€è®¢ç¥¨ã€å¯¼èˆª</li>
<li><strong>ç¤¾äº¤åŠ©æ‰‹</strong>ï¼šè‡ªåŠ¨å›å¤ã€æ¶ˆæ¯è½¬å‘</li>
</ul>
<h3 data-id="heading-54">6.2 ä¼ä¸šåº”ç”¨åœºæ™¯</h3>
<ul>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ï¼šApp UI è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li><strong>æ•°æ®é‡‡é›†</strong>ï¼šç«å“åˆ†æã€ä»·æ ¼ç›‘æ§</li>
<li><strong>RPA</strong>ï¼šé‡å¤æ€§ä»»åŠ¡è‡ªåŠ¨åŒ–</li>
</ul>
<h3 data-id="heading-55">6.3 ç ”ç©¶æ–¹å‘</h3>
<ul>
<li><strong>å¤šè®¾å¤‡ååŒ</strong>ï¼šåŒæ—¶æ§åˆ¶å¤šå°æ‰‹æœº</li>
<li><strong>é•¿æœŸè®°å¿†</strong>ï¼šè·¨ Session çš„ä»»åŠ¡è®°å¿†</li>
<li><strong>å¤šæ¨¡æ€è¾“å…¥</strong>ï¼šè¯­éŸ³æŒ‡ä»¤ã€æ‰‹åŠ¿æ§åˆ¶</li>
</ul>
<hr/>
<h2 data-id="heading-56">ä¸ƒã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-57">7.1 æ ¸å¿ƒä¼˜åŠ¿ï¼šä¸ºä»€ä¹ˆæ˜¯ GELab-Zeroï¼Ÿ</h3>
<ol>
<li><strong>å·¥ç¨‹åŸºå»ºçš„èƒœåˆ©</strong>ï¼šè¦†ç›–ä¸»æµ Android 9+ åŠ RAM 4GB ä»¥ä¸Šè®¾å¤‡ã€‚é€šè¿‡å®Œæ•´çš„æ¨ç†å·¥ç¨‹åŸºå»ºï¼Œè§£å†³äº†å¤šè®¾å¤‡ ADB è¿æ¥ã€ä¾èµ–å®‰è£…ç­‰ç¹çæµç¨‹ï¼Œè®©å¼€å‘è€…ä»"è„æ´»ç´¯æ´»"ä¸­è§£æ”¾å‡ºæ¥ã€‚</li>
<li><strong>éšç§ä¸å®‰å…¨çš„å¹³è¡¡</strong>ï¼šç±»ä¼¼äºè±†åŒ…æ‰‹æœºåŠ©æ‰‹çš„ç«¯ä¾§æŒä¹…è®°å¿†ç†å¿µï¼ŒGELab-Zero åšæŒå®Œå…¨æœ¬åœ°åŒ–è¿è¡Œï¼Œæ‰€æœ‰æ•°æ®åœ¨æœ¬åœ°é—­ç¯ï¼Œè§„é¿äº†äº‘ç«¯éšç§æ³„éœ²é£é™©ã€‚</li>
<li><strong>çœŸå®åœºæ™¯çš„æ‰“ç£¨</strong>ï¼šåŸºäº <strong>AndroidDaily</strong> è‡ªå»ºè¯„æµ‹åŸºå‡†ï¼Œèšç„¦ç°ä»£ç”Ÿæ´»å…­å¤§æ ¸å¿ƒç»´åº¦ï¼ˆé£Ÿã€è¡Œã€è´­ã€ä½ã€è®¯ã€å¨±ï¼‰ï¼Œåœ¨çœŸå®å¤æ‚ä»»åŠ¡ä¸­ï¼ˆå¦‚è·¨ App æ¯”ä»·ã€å¤šå•†å“é‡‡è´­ï¼‰å‡†ç¡®ç‡è¾¾åˆ° <strong>73.4%</strong>ã€‚</li>
</ol>
<h3 data-id="heading-58">7.2 è¡Œä¸šå‘å±•è¶‹åŠ¿</h3>
<p>éšç€ 2025 å¹´æœ«ç«¯ä¾§ AI çš„é›†ä¸­çˆ†å‘ï¼Œæœªæ¥å‡ å¹´æˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹è¶‹åŠ¿ï¼š</p>
<ol>
<li><strong>æŠ€æœ¯èåˆ</strong>ï¼šç«¯ä¾§æ¨¡å‹å‚æ•°å°†æŒç»­å¢é•¿ï¼Œ3B/4B æ¨¡å‹é€šè¿‡è’¸é¦æŠ€æœ¯å°†é€¼è¿‘ 8B é€šç”¨æ¨¡å‹æ•ˆæœã€‚ç¡¬ä»¶ä¸Šï¼ŒNPU çš„æ™®åŠå’Œå­˜å†…è®¡ç®—æŠ€æœ¯å°†è¿›ä¸€æ­¥é™ä½åŠŸè€—ã€‚</li>
<li><strong>äº¤äº’å˜é©</strong>ï¼šä»å•ä¸€çš„è§¦æ§äº¤äº’å‘<strong>è¯­éŸ³+è§†è§‰+æ„å›¾ç†è§£</strong>çš„å¤šæ¨¡æ€äº¤äº’æ¼”è¿›ã€‚æ­£å¦‚è±†åŒ…ä¸ä¸­å…´çš„åˆä½œæ‰€ç¤ºï¼Œç³»ç»Ÿçº§å…¥å£ï¼ˆä¾§è¾¹é”®ã€è€³æœºå”¤é†’ï¼‰å°†æˆä¸ºå…µå®¶å¿…äº‰ä¹‹åœ°ã€‚</li>
<li><strong>ä¸»åŠ¨æœåŠ¡</strong>ï¼šAI å°†ä»"è¢«åŠ¨å·¥å…·"è½¬å‘"ä¸»åŠ¨åŠ©ç†"ã€‚å…·å¤‡é•¿æœŸè®°å¿†èƒ½åŠ›çš„ Agent å°†èƒ½è®°ä½ç”¨æˆ·çš„åå¥½ï¼ˆå¦‚"å¸®æˆ‘æ•´ç†ä¸‹å‘¨è¡Œç¨‹"ï¼‰ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶æœºä¸»åŠ¨æä¾›æœåŠ¡ï¼ˆå¦‚"è‡ªåŠ¨æ¯”ä»·å¹¶é¢†åˆ¸"ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-59">7.3 ç»“è¯­ï¼šå•†ä¸šé—­ç¯ä¸å¼€æºä»·å€¼çš„æ€è€ƒ</h3>
<p>è™½ç„¶ä»å•†ä¸šåŒ–æˆç†Ÿåº¦å’Œç”¨æˆ·ä½“éªŒæ¥çœ‹ï¼Œ<strong>è±†åŒ…æ‰‹æœºåŠ©æ‰‹</strong>å‡­å€Ÿä¸æ‰‹æœºå‚å•†çš„ç³»ç»Ÿçº§æ·±åº¦ç»‘å®šï¼ˆå¦‚ä¸­å…´ Nubiaï¼‰ï¼Œåœ¨ä¿æ´»èƒ½åŠ›ã€æƒé™è·å–å’Œäº¤äº’ä¾¿æ·æ€§ä¸Šå æ®äº†ç»å¯¹ä¼˜åŠ¿ï¼Œè¿™ä»£è¡¨äº†"æè‡´äº§å“ä½“éªŒ"çš„æ–¹å‘ã€‚</p>
<p>ä½† <strong>GELab-Zero</strong> çš„å¼€æºä»·å€¼æ°æ°åœ¨äºå…¶<strong>ç‹¬ç«‹æ€§ä¸æ™®æƒ æ€§</strong>ï¼š</p>
<ol>
<li><strong>æŠ€æœ¯æ°‘ä¸»åŒ–</strong>ï¼šå®ƒè¯æ˜äº†ä¸ä¾èµ–æ‰‹æœºå‚å•†çš„ç³»ç»Ÿçº§åé—¨ï¼ˆBackdoorï¼‰æˆ–ç‰¹æƒ APIï¼Œä»…å‡­çº¯è§†è§‰æ–¹æ¡ˆï¼ˆVisual-basedï¼‰ï¼Œä¹Ÿèƒ½åœ¨é€šç”¨ Android è®¾å¤‡ä¸Šå®ç°é«˜å¯ç”¨æ€§çš„ Agentã€‚è¿™ä¸ºéæ‰‹æœºå‚å•†çš„å¼€å‘è€…æ‰“å¼€äº†ä¸€æ‰‡çª—ã€‚</li>
<li><strong>éšç§åº•çº¿</strong>ï¼šåœ¨å·¨å¤´ä»¬çº·çº·å°†æ•°æ®ä¸Šä¼ äº‘ç«¯è¿›è¡Œ"æ··åˆè®¡ç®—"çš„å½“ä¸‹ï¼ŒGELab-Zero åšå®ˆçš„"å…¨æœ¬åœ°æ¨ç†"ï¼ˆLocal Inferenceï¼‰ä¸ºåŒ»ç–—ã€é‡‘èç­‰é«˜æ•æ„Ÿåœºæ™¯æä¾›äº†ä¸€ä¸ªå¯ä¿¡çš„æ›¿ä»£æ–¹æ¡ˆã€‚</li>
<li><strong>æ ‡å‡†å®šä¹‰è€…</strong>ï¼šå®ƒæ‰€å®šä¹‰çš„ ActTree åŠ¨ä½œç©ºé—´ã€AndroidDaily è¯„æµ‹æ ‡å‡†ï¼Œææœ‰å¯èƒ½æˆä¸ºæœªæ¥ç§»åŠ¨ç«¯ Agent å¼€å‘çš„è¡Œä¸šäº‹å®æ ‡å‡†ã€‚</li>
</ol>
<p>å¦‚æœè¯´è±†åŒ…æ˜¯ iOS å¼çš„å°é—­èŠ±å›­ç²¾å“ï¼Œé‚£ä¹ˆ GELab-Zero æ­£è‡´åŠ›äºæˆä¸ºç§»åŠ¨ç«¯ Agent æ—¶ä»£çš„ Androidâ€”â€”è™½ç„¶ç²—ç³™ï¼Œä½†å……æ»¡æ— é™å¯èƒ½ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç»ä½³çš„å®éªŒå¹³å°ï¼Œè®©ä½ ç°åœ¨å°±èƒ½åœ¨è‡ªå·±çš„ç”µè„‘å’Œæ‰‹æœºä¸Šï¼Œæ„å»ºå‡ºèƒ½å¤Ÿç†è§£ä¸–ç•Œã€æ“ä½œåº”ç”¨çš„ä¸‹ä¸€ä»£ AI Agentã€‚</p>
<hr/>
<h2 data-id="heading-60">å…«ã€å‚è€ƒèµ„æ–™</h2>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstepfun-ai%2Fgelab-zero" target="_blank" title="https://github.com/stepfun-ai/gelab-zero" ref="nofollow noopener noreferrer">github.com/stepfun-ai/â€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fstepfun-ai%2FGELab-Zero-4B-preview" target="_blank" title="https://huggingface.co/stepfun-ai/GELab-Zero-4B-preview" ref="nofollow noopener noreferrer">huggingface.co/stepfun-ai/â€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.modelscope.cn%2Fmodels%2FQwen%2FQwen3-VL-4B-Instruct" target="_blank" title="https://www.modelscope.cn/models/Qwen/Qwen3-VL-4B-Instruct" ref="nofollow noopener noreferrer">www.modelscope.cn/models/Qwenâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fdatasets%2Fstepfun-ai%2FAndroidDaily" target="_blank" title="https://huggingface.co/datasets/stepfun-ai/AndroidDaily" ref="nofollow noopener noreferrer">huggingface.co/datasets/stâ€¦</a></li>
<li><strong>è®ºæ–‡</strong>ï¼šGUI Exploration Lab: Enhancing Screen Navigation in Agents via Multi-Turn Reinforcement Learning (NeurIPS 2025)</li>
<li><a href="https://juejin.cn/post/7579088065697611816" target="_blank" title="https://juejin.cn/post/7579088065697611816">juejin.cn/post/757908â€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DeoY4EIcbFck" target="_blank" title="https://www.youtube.com/watch?v=eoY4EIcbFck" ref="nofollow noopener noreferrer">www.youtube.com/watch?v=eoYâ€¦</a></li>
</ol>
<hr/>
<h2 data-id="heading-61">é™„å½•ï¼š</h2>
<h3 data-id="heading-62">A.1 å•ä»»åŠ¡æ‰§è¡Œè„šæœ¬</h3>
<pre><code class="hljs language-python" lang="python">é¡¹ç›®ä¸­çš„ç¤ºä¾‹ï¼š
python examples/run_single_task.py
</code></pre>
<h3 data-id="heading-63">A.2 è½¨è¿¹å¯è§†åŒ–å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»…æœ¬æœºè®¿é—®</span>
streamlit run --server.address 127.0.0.1 --server.port 33503 --server.headless <span class="hljs-literal">true</span> visualization/main_page.py

<span class="hljs-comment"># å±€åŸŸç½‘è®¿é—®</span>
streamlit run --server.address 0.0.0.0 --server.port 33503 --server.headless <span class="hljs-literal">true</span> visualization/main_page.py
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»æ¦‚å¿µå¼€å§‹å¼€å§‹C++ç®¡é“ç¼–ç¨‹]]></title>    <link>https://juejin.cn/post/7584287969214054419</link>    <guid>https://juejin.cn/post/7584287969214054419</guid>    <pubDate>2025-12-16T11:07:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584287969214054419" data-draft-id="7584295332339695679" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»æ¦‚å¿µå¼€å§‹å¼€å§‹C++ç®¡é“ç¼–ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T11:07:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»æ¦‚å¿µå¼€å§‹å¼€å§‹C++ç®¡é“ç¼–ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T11:07:33.000Z" title="Tue Dec 16 2025 11:07:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬ä¸€ç« ï¼šç®¡é“ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯ç®¡é“ï¼Ÿ</h3>
<p><strong>ç®¡é“</strong>æ˜¯UNIXå’Œç±»UNIXç³»ç»Ÿä¸­æœ€å¤è€ã€æœ€åŸºç¡€çš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æœºåˆ¶ä¹‹ä¸€ã€‚ä½ å¯ä»¥å°†å®ƒæƒ³è±¡æˆç°å®ä¸–ç•Œä¸­çš„æ°´ç®¡ï¼šæ•°æ®åƒæ°´æµä¸€æ ·ä»ä¸€ä¸ªè¿›ç¨‹"æµ"å‘å¦ä¸€ä¸ªè¿›ç¨‹ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹å¾</strong>ï¼š</p>
<ul>
<li><strong>åŠåŒå·¥é€šä¿¡</strong>ï¼šæ•°æ®åªèƒ½å•å‘æµåŠ¨ï¼ˆè¦ä¹ˆä»Aåˆ°Bï¼Œè¦ä¹ˆä»Båˆ°Aï¼‰</li>
<li><strong>å­—èŠ‚æµå¯¼å‘</strong>ï¼šæ²¡æœ‰æ¶ˆæ¯è¾¹ç•Œï¼Œæ•°æ®æ˜¯è¿ç»­çš„å­—èŠ‚æµ</li>
<li><strong>åŸºäºæ–‡ä»¶æè¿°ç¬¦</strong>ï¼šä½¿ç”¨ä¸æ–‡ä»¶æ“ä½œç›¸åŒçš„æ¥å£</li>
<li><strong>å†…æ ¸ç¼“å†²åŒº</strong>ï¼šæ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºä¸­æš‚å­˜</li>
</ul>
<h3 data-id="heading-2">1.2 ç®¡é“çš„å·¥ä½œåŸç†</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¯”å–»æ¥ç†è§£ç®¡é“çš„å·¥ä½œåŸç†ï¼š</p>
<p>æƒ³è±¡ä¸¤ä¸ªè¿›ç¨‹è¦é€šè¿‡ç®¡é“é€šä¿¡ï¼š</p>
<pre><code class="hljs language-css" lang="css">è¿›ç¨‹<span class="hljs-selector-tag">A</span>ï¼ˆå†™ç«¯ï¼‰ â†’ <span class="hljs-selector-attr">[å†…æ ¸ç¼“å†²åŒº]</span> â†’ è¿›ç¨‹<span class="hljs-selector-tag">B</span>ï¼ˆè¯»ç«¯ï¼‰
</code></pre>
<p><strong>å†…æ ¸ç¼“å†²åŒºçš„ä½œç”¨</strong>ï¼š</p>
<ol>
<li>å½“è¿›ç¨‹Aå†™å…¥æ•°æ®æ—¶ï¼Œæ•°æ®å…ˆè¿›å…¥å†…æ ¸ç¼“å†²åŒº</li>
<li>è¿›ç¨‹Bä»ç¼“å†²åŒºè¯»å–æ•°æ®</li>
<li>å¦‚æœç¼“å†²åŒºç©ºï¼Œè¯»æ“ä½œä¼šé˜»å¡ï¼ˆç­‰å¾…æ•°æ®ï¼‰</li>
<li>å¦‚æœç¼“å†²åŒºæ»¡ï¼Œå†™æ“ä½œä¼šé˜»å¡ï¼ˆç­‰å¾…ç©ºé—´ï¼‰</li>
</ol>
<p><strong>åŒ¿åç®¡é“çš„å…³é”®é™åˆ¶</strong>ï¼š</p>
<ul>
<li>åªèƒ½ç”¨äºæœ‰"äº²ç¼˜å…³ç³»"çš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆé€šå¸¸æ˜¯çˆ¶å­è¿›ç¨‹æˆ–å…„å¼Ÿè¿›ç¨‹ï¼‰</li>
<li>ç”Ÿå‘½å‘¨æœŸéšè¿›ç¨‹ç»“æŸè€Œç»“æŸ</li>
<li>æ— æ³•åœ¨æ— å…³è¿›ç¨‹é—´ä½¿ç”¨</li>
</ul>
<h2 data-id="heading-3">ç¬¬äºŒç« ï¼šå…¥é—¨å®è·µâ€”â€”åˆ›å»ºç¬¬ä¸€ä¸ªç®¡é“</h2>
<h3 data-id="heading-4">2.1 ç†è§£æ–‡ä»¶æè¿°ç¬¦</h3>
<p>åœ¨æ·±å…¥ä»£ç ä¹‹å‰ï¼Œå¿…é¡»ç†è§£<strong>æ–‡ä»¶æè¿°ç¬¦</strong>çš„æ¦‚å¿µï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è¿™ä¸‰ä¸ªæ ‡å‡†æ–‡ä»¶æè¿°ç¬¦ï¼š</span>
<span class="hljs-comment">// 0 - æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰   â†’ é€šå¸¸ä»é”®ç›˜è¯»å–</span>
<span class="hljs-comment">// 1 - æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰  â†’ é€šå¸¸è¾“å‡ºåˆ°å±å¹•</span>
<span class="hljs-comment">// 2 - æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰  â†’ é”™è¯¯ä¿¡æ¯è¾“å‡º</span>

<span class="hljs-comment">// å½“åˆ›å»ºç®¡é“æ—¶ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸¤ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼š</span>
<span class="hljs-comment">// pipefd[0] - ç”¨äºè¯»å–çš„ç«¯</span>
<span class="hljs-comment">// pipefd[1] - ç”¨äºå†™å…¥çš„ç«¯</span>
</code></pre>
<h3 data-id="heading-5">2.2 åˆ›å»ºç¬¬ä¸€ä¸ªç®¡é“ç¨‹åº</h3>
<p>è®©æˆ‘ä»¬ä»æœ€ç®€å•çš„ä¾‹å­å¼€å§‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span>   <span class="hljs-comment">// pipe(), fork(), read(), write()</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span>   <span class="hljs-comment">// strlen()</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/wait.h&gt;</span> <span class="hljs-comment">// wait()</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];  <span class="hljs-comment">// ç®¡é“æ–‡ä»¶æè¿°ç¬¦æ•°ç»„</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">100</span>];
    
    <span class="hljs-comment">// æ­¥éª¤1ï¼šåˆ›å»ºç®¡é“</span>
    <span class="hljs-comment">// pipe() è¿”å›0è¡¨ç¤ºæˆåŠŸï¼Œ-1è¡¨ç¤ºå¤±è´¥</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">-1</span>) {
        std::cerr &lt;&lt; <span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span> &lt;&lt; std::endl;
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-comment">// æ­¥éª¤2ï¼šåˆ›å»ºå­è¿›ç¨‹</span>
    <span class="hljs-type">pid_t</span> pid = fork();
    
    <span class="hljs-keyword">if</span> (pid == <span class="hljs-number">-1</span>) {
        std::cerr &lt;&lt; <span class="hljs-string">"è¿›ç¨‹åˆ›å»ºå¤±è´¥"</span> &lt;&lt; std::endl;
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-keyword">if</span> (pid == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å­è¿›ç¨‹ä»£ç </span>
        <span class="hljs-comment">// å…³é—­ä¸éœ€è¦çš„å†™ç«¯</span>
        <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">1</span>]);
        
        <span class="hljs-comment">// ä»ç®¡é“è¯»å–æ•°æ®</span>
        <span class="hljs-type">int</span> bytes_read = <span class="hljs-built_in">read</span>(pipefd[<span class="hljs-number">0</span>], buffer, <span class="hljs-built_in">sizeof</span>(buffer));
        <span class="hljs-keyword">if</span> (bytes_read &gt; <span class="hljs-number">0</span>) {
            std::cout &lt;&lt; <span class="hljs-string">"å­è¿›ç¨‹æ”¶åˆ°: "</span> &lt;&lt; buffer &lt;&lt; std::endl;
        }
        
        <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// çˆ¶è¿›ç¨‹ä»£ç </span>
        <span class="hljs-comment">// å…³é—­ä¸éœ€è¦çš„è¯»ç«¯</span>
        <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">0</span>]);
        
        <span class="hljs-type">const</span> <span class="hljs-type">char</span>* message = <span class="hljs-string">"Hello from parent!"</span>;
        
        <span class="hljs-comment">// å‘ç®¡é“å†™å…¥æ•°æ®</span>
        <span class="hljs-built_in">write</span>(pipefd[<span class="hljs-number">1</span>], message, <span class="hljs-built_in">strlen</span>(message));
        
        <span class="hljs-comment">// å…³é—­å†™ç«¯ï¼Œè¡¨ç¤ºæ•°æ®å‘é€å®Œæ¯•</span>
        <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">1</span>]);
        
        <span class="hljs-comment">// ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</span>
        <span class="hljs-built_in">wait</span>(<span class="hljs-literal">nullptr</span>);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-6">2.3 å…³é”®åŸç†åˆ†æ</h3>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å…³é—­ä¸ç”¨çš„æè¿°ç¬¦ï¼Ÿ</strong></p>
<ol>
<li><strong>èµ„æºç®¡ç†</strong>ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼ŒåŠæ—¶å…³é—­é¿å…æ³„æ¼</li>
<li><strong>æ­£ç¡®ç»ˆæ­¢</strong>ï¼šè¯»è¿›ç¨‹éœ€è¦çŸ¥é“ä½•æ—¶æ²¡æœ‰æ›´å¤šæ•°æ®
<ul>
<li>æ‰€æœ‰å†™ç«¯å…³é—­ â†’ è¯»ç«¯è¿”å›0ï¼ˆEOFï¼‰</li>
<li>å¦åˆ™è¯»ç«¯ä¼šä¸€ç›´ç­‰å¾…</li>
</ul>
</li>
</ol>
<p><strong>ç®¡é“çš„é˜»å¡è¡Œä¸º</strong>ï¼š</p>
<ul>
<li><strong>è¯»é˜»å¡</strong>ï¼šå½“ç®¡é“ç©ºä¸”ä»æœ‰å†™ç«¯æ‰“å¼€æ—¶ï¼Œè¯»æ“ä½œä¼šé˜»å¡</li>
<li><strong>å†™é˜»å¡</strong>ï¼šå½“ç®¡é“æ»¡ï¼ˆé»˜è®¤64KBï¼‰ï¼Œå†™æ“ä½œä¼šé˜»å¡</li>
<li><strong>éé˜»å¡æ¨¡å¼</strong>ï¼šå¯ä»¥é€šè¿‡fcntl()è®¾ç½®O_NONBLOCK</li>
</ul>
<h2 data-id="heading-7">ç¬¬ä¸‰ç« ï¼šä¸­çº§åº”ç”¨â€”â€”åŒå‘é€šä¿¡ä¸å¤æ‚ç®¡é“</h2>
<h3 data-id="heading-8">3.1 å®ç°åŒå‘é€šä¿¡</h3>
<p>å•ä¸ªç®¡é“åªèƒ½å•å‘é€šä¿¡ï¼Œè¦å®ç°åŒå‘é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªç®¡é“ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BidirectionalPipe</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> parent_to_child[<span class="hljs-number">2</span>];  <span class="hljs-comment">// çˆ¶â†’å­ç®¡é“</span>
    <span class="hljs-type">int</span> child_to_parent[<span class="hljs-number">2</span>];  <span class="hljs-comment">// å­â†’çˆ¶ç®¡é“</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">BidirectionalPipe</span>() {
        <span class="hljs-comment">// åˆ›å»ºä¸¤ä¸ªç®¡é“</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(parent_to_child) == <span class="hljs-number">-1</span> || <span class="hljs-built_in">pipe</span>(child_to_parent) == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
        }
    }
    
    ~<span class="hljs-built_in">BidirectionalPipe</span>() {
        <span class="hljs-built_in">closeAll</span>();
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">parentWrite</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; message)</span> </span>{
        <span class="hljs-built_in">write</span>(parent_to_child[<span class="hljs-number">1</span>], message.<span class="hljs-built_in">c_str</span>(), message.<span class="hljs-built_in">length</span>());
    }
    
    <span class="hljs-function">std::string <span class="hljs-title">parentRead</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-type">char</span> buffer[<span class="hljs-number">256</span>];
        <span class="hljs-type">int</span> n = <span class="hljs-built_in">read</span>(child_to_parent[<span class="hljs-number">0</span>], buffer, <span class="hljs-built_in">sizeof</span>(buffer)<span class="hljs-number">-1</span>);
        <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
            buffer[n] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">string</span>(buffer);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">childWrite</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; message)</span> </span>{
        <span class="hljs-built_in">write</span>(child_to_parent[<span class="hljs-number">1</span>], message.<span class="hljs-built_in">c_str</span>(), message.<span class="hljs-built_in">length</span>());
    }
    
    <span class="hljs-function">std::string <span class="hljs-title">childRead</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-type">char</span> buffer[<span class="hljs-number">256</span>];
        <span class="hljs-type">int</span> n = <span class="hljs-built_in">read</span>(parent_to_child[<span class="hljs-number">0</span>], buffer, <span class="hljs-built_in">sizeof</span>(buffer)<span class="hljs-number">-1</span>);
        <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
            buffer[n] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">string</span>(buffer);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">closeParentSide</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">close</span>(parent_to_child[<span class="hljs-number">1</span>]);  <span class="hljs-comment">// å…³é—­çˆ¶è¿›ç¨‹çš„å†™ç«¯</span>
        <span class="hljs-built_in">close</span>(child_to_parent[<span class="hljs-number">0</span>]);  <span class="hljs-comment">// å…³é—­çˆ¶è¿›ç¨‹çš„è¯»ç«¯</span>
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">closeChildSide</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">close</span>(parent_to_child[<span class="hljs-number">0</span>]);  <span class="hljs-comment">// å…³é—­å­è¿›ç¨‹çš„è¯»ç«¯</span>
        <span class="hljs-built_in">close</span>(child_to_parent[<span class="hljs-number">1</span>]);  <span class="hljs-comment">// å…³é—­å­è¿›ç¨‹çš„å†™ç«¯</span>
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">closeAll</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">close</span>(parent_to_child[<span class="hljs-number">0</span>]);
        <span class="hljs-built_in">close</span>(parent_to_child[<span class="hljs-number">1</span>]);
        <span class="hljs-built_in">close</span>(child_to_parent[<span class="hljs-number">0</span>]);
        <span class="hljs-built_in">close</span>(child_to_parent[<span class="hljs-number">1</span>]);
    }
};
</code></pre>
<h3 data-id="heading-9">3.2 ç®¡é“é“¾çš„å®ç°</h3>
<p>ç®¡é“é“¾æ˜¯UNIX shellä¸­<code>|</code>æ“ä½œç¬¦çš„åŸºç¡€ï¼Œè®©æˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;array&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Pipeline</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// å­˜å‚¨å¤šä¸ªå‘½ä»¤</span>
    std::vector&lt;std::vector&lt;std::string&gt;&gt; commands;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addCommand</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;std::string&gt;&amp; cmd)</span> </span>{
        commands.<span class="hljs-built_in">push_back</span>(cmd);
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>{
        std::vector&lt;<span class="hljs-type">int</span>&gt; prev_pipe_read;  <span class="hljs-comment">// å‰ä¸€ä¸ªç®¡é“çš„è¯»ç«¯</span>
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; commands.<span class="hljs-built_in">size</span>(); ++i) {
            <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
            
            <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå‘½ä»¤ï¼Œåˆ›å»ºç®¡é“</span>
            <span class="hljs-keyword">if</span> (i &lt; commands.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">-1</span>) {
                    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
                }
            }
            
            <span class="hljs-type">pid_t</span> pid = fork();
            
            <span class="hljs-keyword">if</span> (pid == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// å­è¿›ç¨‹ä»£ç </span>
                
                <span class="hljs-comment">// è®¾ç½®è¾“å…¥é‡å®šå‘ï¼ˆä»ä¸Šä¸€ä¸ªç®¡é“è¯»å–ï¼‰</span>
                <span class="hljs-keyword">if</span> (!prev_pipe_read.<span class="hljs-built_in">empty</span>()) {
                    <span class="hljs-built_in">dup2</span>(prev_pipe_read[<span class="hljs-number">0</span>], STDIN_FILENO);
                    <span class="hljs-built_in">close</span>(prev_pipe_read[<span class="hljs-number">0</span>]);
                }
                
                <span class="hljs-comment">// è®¾ç½®è¾“å‡ºé‡å®šå‘ï¼ˆå†™å…¥ä¸‹ä¸€ä¸ªç®¡é“ï¼‰</span>
                <span class="hljs-keyword">if</span> (i &lt; commands.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {
                    <span class="hljs-built_in">dup2</span>(pipefd[<span class="hljs-number">1</span>], STDOUT_FILENO);
                    <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">0</span>]);
                    <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">1</span>]);
                }
                
                <span class="hljs-comment">// å‡†å¤‡execå‚æ•°</span>
                std::vector&lt;<span class="hljs-type">char</span>*&gt; args;
                <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; arg : commands[i]) {
                    args.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">char</span>*&gt;(arg.<span class="hljs-built_in">c_str</span>()));
                }
                args.<span class="hljs-built_in">push_back</span>(<span class="hljs-literal">nullptr</span>);
                
                <span class="hljs-comment">// æ‰§è¡Œå‘½ä»¤</span>
                <span class="hljs-built_in">execvp</span>(args[<span class="hljs-number">0</span>], args.<span class="hljs-built_in">data</span>());
                
                <span class="hljs-comment">// execå¤±è´¥æ‰æ‰§è¡Œåˆ°è¿™é‡Œ</span>
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// çˆ¶è¿›ç¨‹ä»£ç </span>
                
                <span class="hljs-comment">// å…³é—­ä¸å†éœ€è¦çš„æè¿°ç¬¦</span>
                <span class="hljs-keyword">if</span> (!prev_pipe_read.<span class="hljs-built_in">empty</span>()) {
                    <span class="hljs-built_in">close</span>(prev_pipe_read[<span class="hljs-number">0</span>]);
                }
                
                <span class="hljs-keyword">if</span> (i &lt; commands.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {
                    <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">1</span>]);  <span class="hljs-comment">// çˆ¶è¿›ç¨‹ä¸éœ€è¦å†™ç«¯</span>
                    prev_pipe_read = {pipefd[<span class="hljs-number">0</span>]};  <span class="hljs-comment">// ä¿å­˜è¯»ç«¯ç”¨äºä¸‹ä¸€ä¸ªè¿›ç¨‹</span>
                }
            }
        }
        
        <span class="hljs-comment">// çˆ¶è¿›ç¨‹ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; commands.<span class="hljs-built_in">size</span>(); ++i) {
            <span class="hljs-built_in">wait</span>(<span class="hljs-literal">nullptr</span>);
        }
    }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    Pipeline pipeline;
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿ: ls -l | grep ".cpp" | wc -l</span>
    pipeline.<span class="hljs-built_in">addCommand</span>({<span class="hljs-string">"ls"</span>, <span class="hljs-string">"-l"</span>});
    pipeline.<span class="hljs-built_in">addCommand</span>({<span class="hljs-string">"grep"</span>, <span class="hljs-string">"\\.cpp"</span>});
    pipeline.<span class="hljs-built_in">addCommand</span>({<span class="hljs-string">"wc"</span>, <span class="hljs-string">"-l"</span>});
    
    pipeline.<span class="hljs-built_in">execute</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-10">3.3 å‘½åç®¡é“ï¼ˆFIFOï¼‰çš„æ·±å…¥ç†è§£</h3>
<p><strong>å‘½åç®¡é“ä¸åŒ¿åç®¡é“çš„åŒºåˆ«</strong>ï¼š</p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>åŒ¿åç®¡é“</th><th>å‘½åç®¡é“ï¼ˆFIFOï¼‰</th></tr></thead><tbody><tr><td>æŒä¹…æ€§</td><td>è¿›ç¨‹ç»“æŸå³æ¶ˆå¤±</td><td>æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰å®ä½“æ–‡ä»¶</td></tr><tr><td>è¿›ç¨‹å…³ç³»</td><td>å¿…é¡»æœ‰äº²ç¼˜å…³ç³»</td><td>ä»»æ„è¿›ç¨‹éƒ½å¯è®¿é—®</td></tr><tr><td>åˆ›å»ºæ–¹å¼</td><td>pipe()ç³»ç»Ÿè°ƒç”¨</td><td>mkfifo()å‡½æ•°</td></tr><tr><td>è®¿é—®æ§åˆ¶</td><td>åŸºäºæ–‡ä»¶æè¿°ç¬¦ç»§æ‰¿</td><td>åŸºäºæ–‡ä»¶æƒé™</td></tr></tbody></table>
<p><strong>åˆ›å»ºå’Œä½¿ç”¨å‘½åç®¡é“</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">NamedPipe</span> {
<span class="hljs-keyword">private</span>:
    std::string path;
    <span class="hljs-type">int</span> fd;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">NamedPipe</span>(<span class="hljs-type">const</span> std::string&amp; pipePath) : <span class="hljs-built_in">path</span>(pipePath) {
        <span class="hljs-comment">// åˆ›å»ºå‘½åç®¡é“ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">mkfifo</span>(path.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">0666</span>) == <span class="hljs-number">-1</span>) {
            <span class="hljs-comment">// å¦‚æœå·²å­˜åœ¨ï¼Œå¿½ç•¥EEXISTé”™è¯¯</span>
            <span class="hljs-keyword">if</span> (errno != EEXIST) {
                <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æ— æ³•åˆ›å»ºå‘½åç®¡é“"</span>);
            }
        }
    }
    
    <span class="hljs-comment">// ä½œä¸ºè¯»å–è€…æ‰“å¼€</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">openForReading</span><span class="hljs-params">(<span class="hljs-type">bool</span> nonblock = <span class="hljs-literal">false</span>)</span> </span>{
        <span class="hljs-type">int</span> flags = O_RDONLY;
        <span class="hljs-keyword">if</span> (nonblock) flags |= O_NONBLOCK;
        
        fd = <span class="hljs-built_in">open</span>(path.<span class="hljs-built_in">c_str</span>(), flags);
        <span class="hljs-keyword">if</span> (fd == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æ— æ³•æ‰“å¼€å‘½åç®¡é“è¿›è¡Œè¯»å–"</span>);
        }
    }
    
    <span class="hljs-comment">// ä½œä¸ºå†™å…¥è€…æ‰“å¼€</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">openForWriting</span><span class="hljs-params">(<span class="hljs-type">bool</span> nonblock = <span class="hljs-literal">false</span>)</span> </span>{
        <span class="hljs-type">int</span> flags = O_WRONLY;
        <span class="hljs-keyword">if</span> (nonblock) flags |= O_NONBLOCK;
        
        fd = <span class="hljs-built_in">open</span>(path.<span class="hljs-built_in">c_str</span>(), flags);
        <span class="hljs-keyword">if</span> (fd == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æ— æ³•æ‰“å¼€å‘½åç®¡é“è¿›è¡Œå†™å…¥"</span>);
        }
    }
    
    <span class="hljs-comment">// è¯»å–æ•°æ®</span>
    <span class="hljs-function">std::string <span class="hljs-title">readData</span><span class="hljs-params">(<span class="hljs-type">size_t</span> max_size = <span class="hljs-number">1024</span>)</span> </span>{
        <span class="hljs-type">char</span> buffer[max_size];
        <span class="hljs-type">ssize_t</span> bytes = <span class="hljs-built_in">read</span>(fd, buffer, max_size - <span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span> (bytes &gt; <span class="hljs-number">0</span>) {
            buffer[bytes] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">string</span>(buffer);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }
    
    <span class="hljs-comment">// å†™å…¥æ•°æ®</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">writeData</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; data)</span> </span>{
        <span class="hljs-built_in">write</span>(fd, data.<span class="hljs-built_in">c_str</span>(), data.<span class="hljs-built_in">length</span>());
    }
    
    ~<span class="hljs-built_in">NamedPipe</span>() {
        <span class="hljs-keyword">if</span> (fd != <span class="hljs-number">-1</span>) {
            <span class="hljs-built_in">close</span>(fd);
        }
        <span class="hljs-comment">// å¯ä»¥é€‰æ‹©æ˜¯å¦åˆ é™¤ç®¡é“æ–‡ä»¶</span>
        <span class="hljs-comment">// unlink(path.c_str());</span>
    }
};
</code></pre>
<h2 data-id="heading-11">ç¬¬å››ç« ï¼šé«˜çº§ä¸»é¢˜â€”â€”æ€§èƒ½ä¸å¹¶å‘</h2>
<h3 data-id="heading-12">4.1 éé˜»å¡ç®¡é“æ“ä½œ</h3>
<p>éé˜»å¡ç®¡é“åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åŒæ—¶ç›‘æ§å¤šä¸ªç®¡é“ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">NonBlockingPipe</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">NonBlockingPipe</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
        }
        
        <span class="hljs-comment">// è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼</span>
        <span class="hljs-built_in">setNonBlocking</span>(pipefd[<span class="hljs-number">0</span>]);
        <span class="hljs-built_in">setNonBlocking</span>(pipefd[<span class="hljs-number">1</span>]);
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setNonBlocking</span><span class="hljs-params">(<span class="hljs-type">int</span> fd)</span> </span>{
        <span class="hljs-type">int</span> flags = <span class="hljs-built_in">fcntl</span>(fd, F_GETFL, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span> (flags == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥"</span>);
        }
        
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fcntl</span>(fd, F_SETFL, flags | O_NONBLOCK) == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"è®¾ç½®éé˜»å¡æ¨¡å¼å¤±è´¥"</span>);
        }
    }
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// éé˜»å¡è¯»å–</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">tryRead</span><span class="hljs-params">(std::string&amp; result)</span> </span>{
        <span class="hljs-type">char</span> buffer[<span class="hljs-number">1024</span>];
        <span class="hljs-type">ssize_t</span> bytes = <span class="hljs-built_in">read</span>(pipefd[<span class="hljs-number">0</span>], buffer, <span class="hljs-built_in">sizeof</span>(buffer) - <span class="hljs-number">1</span>);
        
        <span class="hljs-keyword">if</span> (bytes &gt; <span class="hljs-number">0</span>) {
            buffer[bytes] = <span class="hljs-string">'\0'</span>;
            result = buffer;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (bytes == <span class="hljs-number">-1</span> &amp;&amp; errno == EAGAIN) {
            <span class="hljs-comment">// æ²¡æœ‰æ•°æ®å¯è¯»ï¼ˆéé˜»å¡æ¨¡å¼ï¼‰</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// é”™è¯¯æˆ–EOF</span>
    }
};
</code></pre>
<h3 data-id="heading-13">4.2 ä½¿ç”¨selectå®ç°å¤šè·¯å¤ç”¨</h3>
<p>å½“éœ€è¦åŒæ—¶ç›‘æ§å¤šä¸ªç®¡é“æ—¶ï¼Œselectæ˜¯ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„å·¥å…·ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/select.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PipeMonitor</span> {
<span class="hljs-keyword">private</span>:
    std::vector&lt;<span class="hljs-type">int</span>&gt; read_fds;  <span class="hljs-comment">// éœ€è¦ç›‘æ§çš„è¯»æè¿°ç¬¦</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addPipe</span><span class="hljs-params">(<span class="hljs-type">int</span> read_fd)</span> </span>{
        read_fds.<span class="hljs-built_in">push_back</span>(read_fd);
    }
    
    <span class="hljs-comment">// ç›‘æ§æ‰€æœ‰ç®¡é“ï¼Œè¿”å›æœ‰æ•°æ®å¯è¯»çš„ç®¡é“åˆ—è¡¨</span>
    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">monitor</span><span class="hljs-params">(<span class="hljs-type">int</span> timeout_sec = <span class="hljs-number">0</span>)</span> </span>{
        fd_set read_set;
        <span class="hljs-built_in">FD_ZERO</span>(&amp;read_set);
        
        <span class="hljs-type">int</span> max_fd = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> fd : read_fds) {
            <span class="hljs-built_in">FD_SET</span>(fd, &amp;read_set);
            <span class="hljs-keyword">if</span> (fd &gt; max_fd) max_fd = fd;
        }
        
        <span class="hljs-keyword">struct</span> <span class="hljs-title class_">timeval</span> timeout;
        timeout.tv_sec = timeout_sec;
        timeout.tv_usec = <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨selectç­‰å¾…æ•°æ®</span>
        <span class="hljs-type">int</span> ready = <span class="hljs-built_in">select</span>(max_fd + <span class="hljs-number">1</span>, &amp;read_set, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, 
                          timeout_sec &gt;= <span class="hljs-number">0</span> ? &amp;timeout : <span class="hljs-literal">nullptr</span>);
        
        std::vector&lt;<span class="hljs-type">int</span>&gt; ready_fds;
        <span class="hljs-keyword">if</span> (ready &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> fd : read_fds) {
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">FD_ISSET</span>(fd, &amp;read_set)) {
                    ready_fds.<span class="hljs-built_in">push_back</span>(fd);
                }
            }
        }
        
        <span class="hljs-keyword">return</span> ready_fds;
    }
};
</code></pre>
<h3 data-id="heading-14">4.3 é›¶æ‹·è´æŠ€æœ¯ï¼šsplice()</h3>
<p>Linuxæä¾›äº†é«˜çº§çš„ç³»ç»Ÿè°ƒç”¨æ¥ä¼˜åŒ–ç®¡é“æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„æ•°æ®æ‹·è´ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">HighPerformancePipe</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">HighPerformancePipe</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨spliceå®ç°é›¶æ‹·è´æ•°æ®ä¼ è¾“</span>
    <span class="hljs-comment">// å°†æ•°æ®ä»ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç›´æ¥ç§»åŠ¨åˆ°ç®¡é“</span>
    <span class="hljs-function"><span class="hljs-type">ssize_t</span> <span class="hljs-title">transferFrom</span><span class="hljs-params">(<span class="hljs-type">int</span> source_fd, <span class="hljs-type">size_t</span> len)</span> </span>{
        <span class="hljs-comment">// spliceä»source_fdè¯»å–æ•°æ®ï¼Œç›´æ¥å†™å…¥ç®¡é“</span>
        <span class="hljs-comment">// é¿å…äº†ç”¨æˆ·ç©ºé—´çš„å†…å­˜æ‹·è´</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">splice</span>(source_fd, <span class="hljs-literal">nullptr</span>,        <span class="hljs-comment">// æºæ–‡ä»¶æè¿°ç¬¦</span>
                     pipefd[<span class="hljs-number">1</span>], <span class="hljs-literal">nullptr</span>,         <span class="hljs-comment">// ç›®æ ‡ç®¡é“å†™ç«¯</span>
                     len,                        <span class="hljs-comment">// ä¼ è¾“é•¿åº¦</span>
                     SPLICE_F_MOVE | SPLICE_F_MORE);
    }
    
    <span class="hljs-comment">// å°†æ•°æ®ä»ç®¡é“ç›´æ¥ä¼ è¾“åˆ°ç›®æ ‡æ–‡ä»¶æè¿°ç¬¦</span>
    <span class="hljs-function"><span class="hljs-type">ssize_t</span> <span class="hljs-title">transferTo</span><span class="hljs-params">(<span class="hljs-type">int</span> dest_fd, <span class="hljs-type">size_t</span> len)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">splice</span>(pipefd[<span class="hljs-number">0</span>], <span class="hljs-literal">nullptr</span>,        <span class="hljs-comment">// æºç®¡é“è¯»ç«¯</span>
                     dest_fd, <span class="hljs-literal">nullptr</span>,          <span class="hljs-comment">// ç›®æ ‡æ–‡ä»¶æè¿°ç¬¦</span>
                     len,
                     SPLICE_F_MOVE | SPLICE_F_MORE);
    }
};
</code></pre>
<h2 data-id="heading-15">ç¬¬äº”ç« ï¼šæœ€ä½³å®è·µä¸é”™è¯¯å¤„ç†</h2>
<h3 data-id="heading-16">5.1 RAIIåŒ…è£…å™¨</h3>
<p>ä¸ºäº†é¿å…èµ„æºæ³„æ¼ï¼Œä½¿ç”¨RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰æ¨¡å¼ç®¡ç†ç®¡é“ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PipeRAII</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
    <span class="hljs-type">bool</span> valid;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">PipeRAII</span>() : <span class="hljs-built_in">valid</span>(<span class="hljs-literal">false</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">0</span>) {
            valid = <span class="hljs-literal">true</span>;
        }
    }
    
    ~<span class="hljs-built_in">PipeRAII</span>() {
        <span class="hljs-keyword">if</span> (valid) {
            <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">0</span>]);
            <span class="hljs-built_in">close</span>(pipefd[<span class="hljs-number">1</span>]);
        }
    }
    
    <span class="hljs-comment">// åˆ é™¤æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦</span>
    <span class="hljs-built_in">PipeRAII</span>(<span class="hljs-type">const</span> PipeRAII&amp;) = <span class="hljs-keyword">delete</span>;
    PipeRAII&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> PipeRAII&amp;) = <span class="hljs-keyword">delete</span>;
    
    <span class="hljs-comment">// å…è®¸ç§»åŠ¨è¯­ä¹‰</span>
    <span class="hljs-built_in">PipeRAII</span>(PipeRAII&amp;&amp; other) <span class="hljs-keyword">noexcept</span> 
        : pipefd{other.pipefd[<span class="hljs-number">0</span>], other.pipefd[<span class="hljs-number">1</span>]}, 
          <span class="hljs-built_in">valid</span>(other.valid) {
        other.valid = <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">readEnd</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> valid ? pipefd[<span class="hljs-number">0</span>] : <span class="hljs-number">-1</span>; }
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">writeEnd</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> valid ? pipefd[<span class="hljs-number">1</span>] : <span class="hljs-number">-1</span>; }
    
    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">bool</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> valid; }
};

<span class="hljs-comment">// ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆç®¡ç†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafePipeManager</span> {
<span class="hljs-keyword">private</span>:
    std::unique_ptr&lt;PipeRAII&gt; pipe;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">SafePipeManager</span>() : <span class="hljs-built_in">pipe</span>(std::<span class="hljs-built_in">make_unique</span>&lt;PipeRAII&gt;()) {
        <span class="hljs-keyword">if</span> (!*pipe) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sendData</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; data)</span> </span>{
        <span class="hljs-keyword">if</span> (pipe) {
            <span class="hljs-built_in">write</span>(pipe-&gt;<span class="hljs-built_in">writeEnd</span>(), data.<span class="hljs-built_in">c_str</span>(), data.<span class="hljs-built_in">length</span>());
        }
    }
};
</code></pre>
<h3 data-id="heading-17">5.2 å¸¸è§é”™è¯¯ä¸å¤„ç†</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RobustPipe</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> pipefd[<span class="hljs-number">2</span>];
    
    <span class="hljs-comment">// å®‰å…¨è¯»å–å‡½æ•°</span>
    <span class="hljs-function"><span class="hljs-type">ssize_t</span> <span class="hljs-title">safeRead</span><span class="hljs-params">(<span class="hljs-type">void</span>* buf, <span class="hljs-type">size_t</span> count)</span> </span>{
        <span class="hljs-type">ssize_t</span> bytes_read;
        <span class="hljs-keyword">do</span> {
            bytes_read = <span class="hljs-built_in">read</span>(pipefd[<span class="hljs-number">0</span>], buf, count);
        } <span class="hljs-keyword">while</span> (bytes_read == <span class="hljs-number">-1</span> &amp;&amp; errno == EINTR);  <span class="hljs-comment">// å¤„ç†ä¿¡å·ä¸­æ–­</span>
        
        <span class="hljs-keyword">return</span> bytes_read;
    }
    
    <span class="hljs-comment">// å®‰å…¨å†™å…¥å‡½æ•°</span>
    <span class="hljs-function"><span class="hljs-type">ssize_t</span> <span class="hljs-title">safeWrite</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* buf, <span class="hljs-type">size_t</span> count)</span> </span>{
        <span class="hljs-type">ssize_t</span> bytes_written;
        <span class="hljs-type">size_t</span> total_written = <span class="hljs-number">0</span>;
        <span class="hljs-type">const</span> <span class="hljs-type">char</span>* ptr = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">char</span>*&gt;(buf);
        
        <span class="hljs-keyword">while</span> (total_written &lt; count) {
            <span class="hljs-keyword">do</span> {
                bytes_written = <span class="hljs-built_in">write</span>(pipefd[<span class="hljs-number">1</span>], ptr + total_written, 
                                     count - total_written);
            } <span class="hljs-keyword">while</span> (bytes_written == <span class="hljs-number">-1</span> &amp;&amp; errno == EINTR);
            
            <span class="hljs-keyword">if</span> (bytes_written == <span class="hljs-number">-1</span>) {
                <span class="hljs-comment">// å¤„ç†çœŸæ­£çš„é”™è¯¯</span>
                <span class="hljs-keyword">if</span> (errno == EPIPE) {
                    std::cerr &lt;&lt; <span class="hljs-string">"ç®¡é“æ–­è£‚ï¼šè¯»ç«¯å·²å…³é—­"</span> &lt;&lt; std::endl;
                }
                <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
            }
            
            total_written += bytes_written;
        }
        
        <span class="hljs-keyword">return</span> total_written;
    }
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">RobustPipe</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(pipefd) == <span class="hljs-number">-1</span>) {
            <span class="hljs-comment">// æ£€æŸ¥å…·ä½“é”™è¯¯</span>
            <span class="hljs-keyword">switch</span> (errno) {
                <span class="hljs-keyword">case</span> EMFILE:
                    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"è¿›ç¨‹æ–‡ä»¶æè¿°ç¬¦è€—å°½"</span>);
                <span class="hljs-keyword">case</span> ENFILE:
                    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"ç³»ç»Ÿæ–‡ä»¶æè¿°ç¬¦è€—å°½"</span>);
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æœªçŸ¥ç®¡é“åˆ›å»ºé”™è¯¯"</span>);
            }
        }
        
        <span class="hljs-comment">// è®¾ç½®ç®¡é“ç¼“å†²åŒºå¤§å°ï¼ˆå¯é€‰ï¼‰</span>
        <span class="hljs-type">int</span> size = <span class="hljs-number">65536</span>;  <span class="hljs-comment">// 64KB</span>
        <span class="hljs-built_in">fcntl</span>(pipefd[<span class="hljs-number">0</span>], F_SETPIPE_SZ, size);
    }
};
</code></pre>
<h2 data-id="heading-18">ç¬¬å…­ç« ï¼šå®æˆ˜åº”ç”¨æ¡ˆä¾‹</h2>
<h3 data-id="heading-19">6.1 æ—¥å¿—æ”¶é›†ç³»ç»Ÿ</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LogCollector</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> log_pipe[<span class="hljs-number">2</span>];
    std::queue&lt;std::string&gt; log_queue;
    std::mutex queue_mutex;
    std::condition_variable queue_cv;
    std::thread worker_thread;
    <span class="hljs-type">bool</span> running;
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">worker</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
        
        <span class="hljs-keyword">while</span> (running) {
            <span class="hljs-type">ssize_t</span> bytes = <span class="hljs-built_in">read</span>(log_pipe[<span class="hljs-number">0</span>], buffer, <span class="hljs-built_in">sizeof</span>(buffer) - <span class="hljs-number">1</span>);
            
            <span class="hljs-keyword">if</span> (bytes &gt; <span class="hljs-number">0</span>) {
                buffer[bytes] = <span class="hljs-string">'\0'</span>;
                <span class="hljs-function">std::string <span class="hljs-title">log_entry</span><span class="hljs-params">(buffer)</span></span>;
                
                {
                    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(queue_mutex)</span></span>;
                    log_queue.<span class="hljs-built_in">push</span>(log_entry);
                }
                queue_cv.<span class="hljs-built_in">notify_one</span>();
            }
        }
    }
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">LogCollector</span>() : <span class="hljs-built_in">running</span>(<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pipe</span>(log_pipe) == <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æ—¥å¿—ç®¡é“åˆ›å»ºå¤±è´¥"</span>);
        }
        
        worker_thread = std::<span class="hljs-built_in">thread</span>(&amp;LogCollector::worker, <span class="hljs-keyword">this</span>);
    }
    
    ~<span class="hljs-built_in">LogCollector</span>() {
        running = <span class="hljs-literal">false</span>;
        <span class="hljs-built_in">close</span>(log_pipe[<span class="hljs-number">1</span>]);  <span class="hljs-comment">// å…³é—­å†™ç«¯ï¼Œä½¿è¯»ç«¯é€€å‡º</span>
        <span class="hljs-keyword">if</span> (worker_thread.<span class="hljs-built_in">joinable</span>()) {
            worker_thread.<span class="hljs-built_in">join</span>();
        }
        <span class="hljs-built_in">close</span>(log_pipe[<span class="hljs-number">0</span>]);
    }
    
    <span class="hljs-comment">// å†™å…¥æ—¥å¿—</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; message)</span> </span>{
        <span class="hljs-built_in">write</span>(log_pipe[<span class="hljs-number">1</span>], message.<span class="hljs-built_in">c_str</span>(), message.<span class="hljs-built_in">length</span>());
    }
    
    <span class="hljs-comment">// è·å–æ—¥å¿—ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</span>
    <span class="hljs-function">std::string <span class="hljs-title">getLog</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(queue_mutex)</span></span>;
        queue_cv.<span class="hljs-built_in">wait</span>(lock, [<span class="hljs-keyword">this</span>] { <span class="hljs-keyword">return</span> !log_queue.<span class="hljs-built_in">empty</span>(); });
        
        std::string log = log_queue.<span class="hljs-built_in">front</span>();
        log_queue.<span class="hljs-built_in">pop</span>();
        <span class="hljs-keyword">return</span> log;
    }
};
</code></pre>
<h2 data-id="heading-20">æ€»ç»“</h2>
<p>ç®¡é“ç¼–ç¨‹æ˜¯C++ç³»ç»Ÿç¼–ç¨‹çš„é‡è¦éƒ¨åˆ†ï¼ŒæŒæ¡å®ƒéœ€è¦ï¼š</p>
<ol>
<li><strong>ç†è§£åŸºæœ¬åŸç†</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦ã€ç¼“å†²åŒºã€é˜»å¡è¡Œä¸º</li>
<li><strong>æŒæ¡æ ¸å¿ƒAPI</strong>ï¼špipe(), fork(), dup2(), read(), write()</li>
<li><strong>å­¦ä¼šé«˜çº§æŠ€æœ¯</strong>ï¼šéé˜»å¡IOã€å¤šè·¯å¤ç”¨ã€é›¶æ‹·è´</li>
<li><strong>éµå¾ªæœ€ä½³å®è·µ</strong>ï¼šRAIIç®¡ç†ã€é”™è¯¯å¤„ç†ã€èµ„æºæ¸…ç†</li>
</ol>
<p>ç®¡é“ä¸ä»…æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œæ›´æ˜¯ä¸€ç§è®¾è®¡å“²å­¦â€”â€”å®ƒé¼“åŠ±æˆ‘ä»¬åˆ›å»ºæ¨¡å—åŒ–ã€å¯ç»„åˆçš„ç¨‹åºï¼Œè¿™æ­£æ˜¯UNIXå“²å­¦çš„æ ¸å¿ƒç†å¿µä¹‹ä¸€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VS Code 1.107 æ›´æ–°ï¼šå¤šæ™ºèƒ½ä½“ååŒä¸å¼€å‘ä½“éªŒå‡çº§]]></title>    <link>https://juejin.cn/post/7584307642999537707</link>    <guid>https://juejin.cn/post/7584307642999537707</guid>    <pubDate>2025-12-16T11:13:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584307642999537707" data-draft-id="7584287969214070803" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VS Code 1.107 æ›´æ–°ï¼šå¤šæ™ºèƒ½ä½“ååŒä¸å¼€å‘ä½“éªŒå‡çº§"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T11:13:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VS Code 1.107 æ›´æ–°ï¼šå¤šæ™ºèƒ½ä½“ååŒä¸å¼€å‘ä½“éªŒå‡çº§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T11:13:08.000Z" title="Tue Dec 16 2025 11:13:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025 å¹´ 12 æœˆ 10 æ—¥ï¼Œå¾®è½¯æ­£å¼å‘å¸ƒäº† VS Code 1.107 ç‰ˆæœ¬ï¼Œè¿™æ¬¡æ›´æ–°å ªç§°å¹´åº¦æœ€é‡ç£…ï¼<strong>å¤šæ™ºèƒ½ä½“ååŒå¼€å‘</strong>æˆä¸ºæ ¸å¿ƒäº®ç‚¹ï¼Œå½»åº•é‡æ„äº†å¼€å‘è€…ä¸ AI åä½œçš„æ¨¡å¼ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å¯ä»¥åŒæ—¶éƒ¨ç½²å¤šä¸ª AI åŠ©æ‰‹åˆ†å·¥åˆä½œï¼šä¸€ä¸ªè´Ÿè´£ä»£ç å®¡æŸ¥ï¼Œä¸€ä¸ªå¤„ç†å•å…ƒæµ‹è¯•ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ¨åå°é»˜é»˜é‡æ„ legacy ä»£ç â€”â€”è¿™ä¸å†æ˜¯ç§‘å¹»åœºæ™¯ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d52455df60c84e1f86b5d74f160b2dbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766488388&amp;x-signature=eNiPuTrnir8zmc9yYe7V5ZexRlY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">å¤šæ™ºèƒ½ä½“ååŒï¼šå¼€å‘æ•ˆç‡çš„é©å‘½æ€§çªç ´</h2>
<h3 data-id="heading-1">Agent HQï¼šä½ çš„ AI å›¢é˜ŸæŒ‡æŒ¥ä¸­å¿ƒ</h3>
<p>VS Code 1.107 å¼•å…¥äº†å…¨æ–°çš„ <strong>Agent HQ</strong> æ¦‚å¿µï¼Œå°†æ‰€æœ‰æ™ºèƒ½ä½“ç»Ÿä¸€ç®¡ç†ã€‚ç°åœ¨ï¼ŒGitHub Copilot ä¸å†æ˜¯å­¤å†›å¥‹æˆ˜ï¼Œä½ å¯ä»¥åˆ›å»ºã€é…ç½®å¤šä¸ªè‡ªå®šä¹‰æ™ºèƒ½ä½“ï¼Œå¹¶è®©å®ƒä»¬ååŒå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<p>æœ€æƒŠè‰³çš„æ˜¯ <strong>ä¼šè¯ç®¡ç†åŠŸèƒ½</strong>ï¼æ‰€æœ‰æ™ºèƒ½ä½“ä¼šè¯éƒ½æ•´åˆåˆ°èŠå¤©è§†å›¾ä¸­ï¼Œä½ èƒ½ä¸€ç›®äº†ç„¶åœ°çœ‹åˆ°æ¯ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€è¿›åº¦å’Œæ–‡ä»¶æ›´æ”¹ç»Ÿè®¡ã€‚å³é”®ç‚¹å‡»ä¼šè¯ï¼Œè¿˜èƒ½é€‰æ‹©åœ¨ç¼–è¾‘å™¨æ ‡ç­¾é¡µæˆ–æ–°çª—å£ä¸­æ‰“å¼€ï¼Œçµæ´»åº¦æ‹‰æ»¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cf7048587a944f4871619e7940eb0db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766488388&amp;x-signature=3yONxuXphV23qvW%2F%2FInRYHVFjNo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">èƒŒæ™¯æ™ºèƒ½ä½“ï¼šè®© AI åœ¨åå°é»˜é»˜å¹²æ´»</h3>
<p><strong>èƒŒæ™¯æ™ºèƒ½ä½“</strong> å½»åº•æ”¹å˜äº†å·¥ä½œæµï¼ä»¥å‰ç”¨ Copilot æ—¶ï¼Œä½ å¿…é¡»ç­‰å¾…å®ƒå®Œæˆå½“å‰ä»»åŠ¡æ‰èƒ½ç»§ç»­å·¥ä½œã€‚ç°åœ¨ï¼Œåªéœ€ç‚¹å‡» <strong>Continue in</strong> æŒ‰é’®ï¼Œå°±èƒ½å°†ä»»åŠ¡æ— ç¼è½¬ç§»åˆ°åå°æ™ºèƒ½ä½“ï¼Œè‡ªå·±ç»§ç»­ä¸“æ³¨äºå…¶ä»–ç¼–ç å·¥ä½œã€‚</p>
<p>æ›´å‰å®³çš„æ˜¯ <strong>Git å·¥ä½œæ ‘éš”ç¦»</strong> æŠ€æœ¯ï¼æ¯ä¸ªèƒŒæ™¯æ™ºèƒ½ä½“éƒ½èƒ½åœ¨ç‹¬ç«‹çš„ Git å·¥ä½œæ ‘ä¸­è¿è¡Œï¼Œå¤šä¸ªæ™ºèƒ½ä½“åŒæ—¶ä¿®æ”¹ä»£ç ä¹Ÿä¸ä¼šå†²çªã€‚å®Œæˆåï¼Œä½ å¯ä»¥ä¸€é”®å°†æ›´æ”¹åˆå¹¶å›ä¸»å·¥ä½œåŒºï¼Œç®€ç›´æ˜¯å¤šä»»åŠ¡å¤„ç†çš„ç»ˆæè§£å†³æ–¹æ¡ˆï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/597edcc556e942c685e12af746a53c21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766488388&amp;x-signature=ley2Th5PgZStx67vL9F2T8YHUWA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">ç»„ç»‡çº§æ™ºèƒ½ä½“å…±äº«ï¼šå›¢é˜Ÿåä½œæ–°èŒƒå¼</h3>
<p>å¯¹äºä¼ä¸šç”¨æˆ·ï¼Œ1.107 ç‰ˆæœ¬å¸¦æ¥äº† <strong>ç»„ç»‡çº§æ™ºèƒ½ä½“å…±äº«</strong>ï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼‰ã€‚ç®¡ç†å‘˜å¯ä»¥åœ¨ GitHub ç»„ç»‡çº§åˆ«å®šä¹‰æ™ºèƒ½ä½“ï¼Œå›¢é˜Ÿæˆå‘˜æ— éœ€æ‰‹åŠ¨å¯¼å…¥å°±èƒ½ç›´æ¥ä½¿ç”¨ã€‚å¯ç”¨æ–¹æ³•å¾ˆç®€å•ï¼š</p>
<ul>
<li>æ‰“å¼€è®¾ç½® <code>github.copilot.chat.customAgents.showOrganizationAndEnterpriseAgents</code></li>
<li>å°†å…¶è®¾ä¸º <code>true</code></li>
</ul>
<p>ä»æ­¤ï¼Œå›¢é˜ŸçŸ¥è¯†åº“ã€ç¼–ç è§„èŒƒã€æœ€ä½³å®è·µéƒ½èƒ½é€šè¿‡è‡ªå®šä¹‰æ™ºèƒ½ä½“è½»æ¾ä¼ æ‰¿ï¼Œæ–°äººä¸Šæ‰‹é€Ÿåº¦è‡³å°‘æå‡ 50%ï¼</p>
<h2 data-id="heading-4">èŠå¤©ä½“éªŒå‡çº§ï¼šAI äº¤äº’æ›´è‡ªç„¶</h2>
<h3 data-id="heading-5">è¯­è¨€æ¨¡å‹ç®¡ç†ï¼šä¸€é”®åˆ‡æ¢ä½ çš„ "AI å¤§è„‘"</h3>
<p>é¢å¯¹è¶Šæ¥è¶Šå¤šçš„ AI æ¨¡å‹é€‰æ‹©ï¼ŒVS Code æ–°å¢äº† <strong>è¯­è¨€æ¨¡å‹ç¼–è¾‘å™¨</strong>ã€‚åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥ï¼š</p>
<ul>
<li>æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹çš„èƒ½åŠ›ã€ä¸Šä¸‹æ–‡é•¿åº¦å’Œè®¡è´¹ä¿¡æ¯</li>
<li>æŒ‰æä¾›å•†ã€èƒ½åŠ›ï¼ˆå·¥å…·è°ƒç”¨ã€è§†è§‰ã€æ™ºèƒ½ä½“ï¼‰ç­›é€‰</li>
<li>éšè—ä¸å¸¸ç”¨æ¨¡å‹ï¼Œè®©ç•Œé¢æ›´æ¸…çˆ½</li>
</ul>
<p>åªéœ€æŒ‰ä¸‹ <code>Ctrl+Shift+P</code> å¹¶è¾“å…¥ <strong>Chat: Manage Language Models</strong>ï¼Œå°±èƒ½æ‰“å¼€è¿™ä¸ªå¼ºå¤§çš„ç®¡ç†ä¸­å¿ƒã€‚</p>
<h3 data-id="heading-6">åŠ¨æ€å†…å®¹æŠ“å–ï¼šè¿ SPA ç½‘ç«™ä¹Ÿèƒ½è½»æ¾è§£æ</h3>
<p><code>#fetch</code> å·¥å…·ç°åœ¨æ”¯æŒ <strong>åŠ¨æ€ç½‘é¡µå†…å®¹æŠ“å–</strong>ï¼æ— è®ºæ˜¯ Reactã€Vue æ„å»ºçš„å•é¡µåº”ç”¨ï¼Œè¿˜æ˜¯ Jira è¿™æ ·çš„åŠ¨æ€ç³»ç»Ÿï¼Œéƒ½èƒ½å‡†ç¡®è·å–å†…å®¹ã€‚AI ç°åœ¨èƒ½ç›´æ¥åˆ†æä½ å…¬å¸çš„å†…éƒ¨æ–‡æ¡£ç³»ç»Ÿï¼Œå›ç­”é—®é¢˜ä¸å†å±€é™äºæœ¬åœ°ä»£ç ï¼</p>
<h3 data-id="heading-7">æ•æ„Ÿæ–‡ä»¶ç¼–è¾‘ï¼šå®‰å…¨ä¸ä¾¿æ·çš„å®Œç¾å¹³è¡¡</h3>
<p>ä¿®æ”¹ <code>package.json</code> æˆ– <code>settings.json</code> è¿™ç±»æ•æ„Ÿæ–‡ä»¶æ—¶ï¼ŒVS Code ä¼šè‡ªåŠ¨æ˜¾ç¤º <strong>å·®å¼‚å¯¹æ¯”è§†å›¾</strong>ï¼Œè®©ä½ æ¸…æ™°çœ‹åˆ°æ¯ä¸€å¤„å˜æ›´ã€‚å†ä¹Ÿä¸ç”¨æ‹…å¿ƒ AI è¯¯æ”¹é…ç½®å¯¼è‡´é¡¹ç›®å´©æºƒäº†ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d09085ede19746aba3d4ca78bf7ac859~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766488388&amp;x-signature=Cl9QvjzYaYeW1hVQhVwlO93C3FQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-8">ç¼–è¾‘å™¨ä½“éªŒä¼˜åŒ–ï¼šç»†èŠ‚ä¹‹å¤„è§çœŸç« </h2>
<h3 data-id="heading-9">æŒ‰éœ€æ‚¬åœæç¤ºï¼šå‘Šåˆ«å¹²æ‰°ï¼Œä¸“æ³¨ç¼–ç </h3>
<p>ç»ˆäºå¯ä»¥å‘Šåˆ«çƒ¦äººçš„è‡ªåŠ¨æ‚¬åœæç¤ºäº†ï¼åœ¨è®¾ç½®ä¸­å°† <code>editor.hover.enabled</code> è®¾ä¸º <code>onKeyboardModifier</code>ï¼Œæ‚¬åœä¿¡æ¯åªä¼šåœ¨æŒ‰ä½ç‰¹å®šä¿®é¥°é”®æ—¶æ‰æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li>å¦‚æœå¤šå…‰æ ‡ä¿®é¥°é”®æ˜¯ <code>Ctrl/Cmd</code>ï¼Œåˆ™æŒ‰ä½ <code>Alt</code> æ˜¾ç¤ºæ‚¬åœ</li>
<li>å¦‚æœå¤šå…‰æ ‡ä¿®é¥°é”®æ˜¯ <code>Alt</code>ï¼Œåˆ™æŒ‰ä½ <code>Ctrl</code> æ˜¾ç¤ºæ‚¬åœ</li>
</ul>
<p>è¿™ä¸ªå°æ”¹è¿›ï¼Œå´èƒ½è®©ç¼–ç ä¸“æ³¨åº¦æå‡ä¸€ä¸ªæ¡£æ¬¡ï¼</p>
<h3 data-id="heading-10">TypeScript 7.0 é¢„è§ˆï¼šåŸç”Ÿé‡æ„ï¼Œæ€§èƒ½é£è·ƒ</h3>
<p>VS Code 1.107 å¸¦æ¥äº† <strong>TypeScript 7.0 é¢„è§ˆæ”¯æŒ</strong>ï¼è¿™ä¸ªå®Œå…¨ç”¨åŸç”Ÿä»£ç é‡å†™çš„ç‰ˆæœ¬ï¼Œæ€§èƒ½æå‡å ªç§°é©å‘½æ€§ã€‚ç›®å‰å·²æ”¯æŒè‡ªåŠ¨å¯¼å…¥ã€é‡å‘½åå’Œå¼•ç”¨ä»£ç é€é•œï¼Œå®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DTypeScriptTeam.native-preview" target="_blank" title="https://marketplace.visualstudio.com/items?itemName=TypeScriptTeam.native-preview" ref="nofollow noopener noreferrer">TypeScript (Native Preview)</a> æ‰©å±•å³å¯ä½“éªŒã€‚</p>
<p>æ ¹æ®å¾®è½¯å®˜æ–¹æ•°æ®ï¼ŒTypeScript 7.0 çš„ç±»å‹æ£€æŸ¥é€Ÿåº¦æ¯” 5.0 å¿« <strong>3-5 å€</strong>ï¼Œå¤§å‹é¡¹ç›®çš„ç¼–è¯‘æ—¶é—´å°†å¤§å¹…ç¼©çŸ­ï¼</p>
<h2 data-id="heading-11">ç»ˆç«¯å¢å¼ºï¼šå‘½ä»¤è¡Œæ•ˆç‡å€å¢</h2>
<h3 data-id="heading-12">ç»ˆç«¯è¾“å‡ºæ•è·ï¼šå†å²å‘½ä»¤éšæ—¶å›æº¯</h3>
<p>ç°åœ¨ï¼ŒèŠå¤©ä¸­çš„ç»ˆç«¯å‘½ä»¤è¾“å‡ºä¼šå®Œæ•´ä¿å­˜åœ¨ <code>xterm.js</code> ç»ˆç«¯ä¸­ï¼Œå³ä½¿ç»ˆç«¯å·²å…³é—­ä¹Ÿèƒ½éšæ—¶æŸ¥çœ‹ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ï¼š</p>
<ul>
<li>å¯¹æ¯”ä¸åŒå‘½ä»¤çš„æ‰§è¡Œç»“æœ</li>
<li>è¿½æº¯æ™ºèƒ½ä½“è¿è¡Œçš„è„šæœ¬è¾“å‡º</li>
<li>åˆ†äº«å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ç»™åŒäº‹</li>
</ul>
<h3 data-id="heading-13">ä¸€é”®å…è®¸æ‰€æœ‰å‘½ä»¤ï¼šä¿¡ä»»æ™ºèƒ½ä½“ï¼Œè§£æ”¾åŒæ‰‹</h3>
<p>åœ¨èŠå¤©ä¸­è¿è¡Œç»ˆç«¯å‘½ä»¤æ—¶ï¼Œæ–°å¢äº† <strong>Allow All Commands in this Session</strong> é€‰é¡¹ã€‚å¯ç”¨åï¼Œå½“å‰ä¼šè¯ä¸­çš„æ‰€æœ‰ç»ˆç«¯å‘½ä»¤éƒ½ä¼šè‡ªåŠ¨æ‰¹å‡†ï¼Œæ— éœ€åå¤ç¡®è®¤ã€‚å¯¹äºä¿¡ä»»çš„æ™ºèƒ½ä½“ï¼Œè¿™èƒ½èŠ‚çœå¤§é‡äº¤äº’æ—¶é—´ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/101390277e4a45e084db64c5abb4fbba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766488388&amp;x-signature=PHDwOisPS0GAyIAcTOLs9k4%2FqFM%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-14">ä¼ä¸šçº§ç‰¹æ€§ï¼šå®‰å…¨ä¸ç®¡ç†å¹¶é‡</h2>
<h3 data-id="heading-15">æ™ºèƒ½ä½“å·¥å…·æƒé™æ§åˆ¶ï¼šç²¾ç»†ç®¡ç† AI èƒ½åŠ›</h3>
<p>ä¼ä¸šç®¡ç†å‘˜ç°åœ¨å¯ä»¥é€šè¿‡ <code>chat.tools.eligibleForAutoApproval</code> è®¾ç½®ï¼Œç²¾ç¡®æ§åˆ¶å“ªäº›æ™ºèƒ½ä½“å·¥å…·å…è®¸è‡ªåŠ¨æ‰¹å‡†ã€‚å¯¹äº <code>runTask</code> è¿™ç±»é«˜å±æ“ä½œï¼Œå¯ä»¥å¼ºåˆ¶è¦æ±‚äººå·¥ç¡®è®¤ï¼Œå®‰å…¨æ€§å¤§å¤§æå‡ï¼</p>
<h3 data-id="heading-16">GitHub ä¼ä¸šç­–ç•¥æ”¯æŒï¼šäº‘ç«¯å¼€å‘æ— ç¼è¡”æ¥</h3>
<p>ä½¿ç”¨ GitHub Codespaces çš„å›¢é˜Ÿï¼Œç°åœ¨èƒ½è‡ªåŠ¨åº”ç”¨ä¼ä¸šç­–ç•¥ã€‚æ— è®ºæ˜¯ MCP æ³¨å†Œè¡¨é…ç½®è¿˜æ˜¯æ™ºèƒ½ä½“æƒé™ï¼Œéƒ½èƒ½åœ¨äº‘ç«¯å¼€å‘ç¯å¢ƒä¸­ä¿æŒä¸€è‡´ï¼Œå¼€å‘ä½“éªŒæ— ç¼è¡”æ¥ã€‚</p>
<h2 data-id="heading-17">æ€»ç»“ï¼šAI é©±åŠ¨å¼€å‘çš„æœªæ¥å·²æ¥</h2>
<p>VS Code 1.107 ç‰ˆæœ¬é€šè¿‡ <strong>å¤šæ™ºèƒ½ä½“ååŒ</strong>ã€<strong>èƒŒæ™¯ä»»åŠ¡å¤„ç†</strong> å’Œ <strong>ç»„ç»‡çº§æ™ºèƒ½ä½“å…±äº«</strong>ï¼Œå°† AI è¾…åŠ©å¼€å‘æ¨å‘äº†æ–°é˜¶æ®µã€‚å®ƒä¸ä»…æ˜¯å·¥å…·çš„å‡çº§ï¼Œæ›´æ˜¯å¼€å‘èŒƒå¼çš„è½¬å˜â€”â€”ä» "å¼€å‘è€…ä½¿ç”¨ AI" åˆ° "å¼€å‘è€…æŒ‡æŒ¥ AI å›¢é˜Ÿ"ã€‚</p>
<p>æœ€ä»¤äººå…´å¥‹çš„æ˜¯ï¼Œè¿™ä»…ä»…æ˜¯å¼€å§‹ã€‚éšç€ TypeScript 7.0 çš„æˆç†Ÿå’Œæ›´å¤š AI èƒ½åŠ›çš„æ•´åˆï¼ŒVS Code æ­£åœ¨æœç€ "å¼€å‘è€…æ€ç»´æ”¾å¤§å™¨" çš„æ–¹å‘å¿«é€Ÿè¿›åŒ–ã€‚</p>
<p>ç«‹å³é€šè¿‡ <strong>å¸®åŠ© &gt; æ£€æŸ¥æ›´æ–°</strong> å‡çº§åˆ° 1.107 ç‰ˆæœ¬ï¼Œæˆ–è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2F" target="_blank" title="https://code.visualstudio.com/" ref="nofollow noopener noreferrer">VS Code å®˜ç½‘</a> ä¸‹è½½æœ€æ–°å®‰è£…åŒ…ï¼Œä½“éªŒè¿™åœºå¼€å‘æ•ˆç‡çš„é©å‘½ï¼</p>
<blockquote>
<p><strong>æç¤º</strong>ï¼šæƒ³æŠ¢å…ˆä½“éªŒæœªæ¥åŠŸèƒ½ï¼Ÿå¯ä»¥å®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Finsiders%2F" target="_blank" title="https://code.visualstudio.com/insiders/" ref="nofollow noopener noreferrer">Insiders ç‰ˆæœ¬</a>ï¼Œæ¯å¤©è·å–æœ€æ–°æ›´æ–°ï¼</p>
</blockquote>
<p>Happy Codingï¼ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•æŸ¥çœ‹ã€ç”Ÿæˆ github å¼€æºé¡¹ç›®star å›¾è¡¨]]></title>    <link>https://juejin.cn/post/7584071941025628175</link>    <guid>https://juejin.cn/post/7584071941025628175</guid>    <pubDate>2025-12-16T11:44:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584071941025628175" data-draft-id="7584266920641314867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•æŸ¥çœ‹ã€ç”Ÿæˆ github å¼€æºé¡¹ç›®star å›¾è¡¨"/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº,ECharts"/> <meta itemprop="datePublished" content="2025-12-16T11:44:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç„é­‚"/> <meta itemprop="url" content="https://juejin.cn/user/571401774834093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•æŸ¥çœ‹ã€ç”Ÿæˆ github å¼€æºé¡¹ç›®star å›¾è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/571401774834093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç„é­‚
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T11:44:14.000Z" title="Tue Dec 16 2025 11:44:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å£°æ˜</h2>
<blockquote>
<p>é‡è¦å£°æ˜ï¼šæœ¬åº”ç”¨åŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstar-history%2Fstar-history" target="_blank" title="https://github.com/star-history/star-history" ref="nofollow noopener noreferrer">star-history/star-history</a> æ”¹é€ å‡çº§ï¼Œæˆ‘ä»¬å°†æŒç»­åŠ å…¥æ›´å¤šæ•°æ®åˆ†æèƒ½åŠ›ï¼Œæ„Ÿè°¢åŸä½œè€…ï¼æœ¬æ–‡æ¡£ä¹Ÿåœ¨åŸä»“åº“æ–‡æ¡£çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹å†™ä¸å®Œå–„ã€‚</p>
</blockquote>
<p>æ–°çš„ä»“åº“åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxuanhun%2Fgithub-data-analysis-" target="_blank" title="https://github.com/xuanhun/github-data-analysis-" ref="nofollow noopener noreferrer">github-data-analysis-</a></p>
<p>æ–°é¡¹ç›®æ›´æ–°äº†å›¾è¡¨å®ç°æ–¹å¼ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.visactor.com%2Fvchart" target="_blank" title="https://www.visactor.com/vchart" ref="nofollow noopener noreferrer">@visactor/vchart</a>)ï¼ŒåŠ å…¥mongodb è¿›è¡Œæ•°æ®ç¼“å­˜ï¼Œä»¥å‡å°‘å¯¹ GitHub API çš„è°ƒç”¨æ¬¡æ•°ï¼Œæå‡æ€§èƒ½ã€‚
åŠ å…¥äº†dark ä¸»é¢˜ï¼Œå¤šè¯­è¨€ç­‰</p>
<hr/>
<h2 data-id="heading-1">åœ¨ GitHub README ä¸­åŠ å…¥å®æ—¶çš„ Star å†å²å›¾</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/041f8a08a9774fcab14c4357c201a1d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=rdN8T4QV2avDcMW%2BdRGWZvLD47U%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬æ”¯æŒæŠŠå®æ—¶çš„ Star å†å²å›¾åµŒå…¥åˆ°ä½ çš„ GitHub README ä¸­ã€‚ä¸Šå›¾æ˜¯æˆ‘ä»¬è‡ªå·±çš„é¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvisactor%2Fvchart" target="_blank" title="https://github.com/visactor/vchart" ref="nofollow noopener noreferrer">GitHub æ•°æ®åˆ†æ</a> çš„æˆªå›¾ã€‚</p>
<p>è¿™ä¸ªåŠŸèƒ½éå¸¸å¥½ç”¨ï¼šåœ¨ç«™ç‚¹é¡µé¢æŸ¥è¯¢ä»“åº“åï¼Œä¼šç”Ÿæˆä¸€æ®µä»£ç ç‰‡æ®µï¼Œä½ åªéœ€è¦æŠŠå®ƒå¤åˆ¶åˆ°ä½ çš„ READMEï¼ˆæˆ–ä»»ä½•ç«™ç‚¹/åšå®¢ï¼‰å³å¯ã€‚</p>
<img width="1302" height="903" alt="imageè½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08dceed37e9948188d51a9ddf51ec87b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=6uw%2Fvjwbd5l5IJ6Ixy3Ltu1PDUY%3D" alt="image.png" loading="lazy"/>
ä¸‹é¢ä»‹ç»è¯¥åŠŸèƒ½çš„è®¾è®¡èƒŒæ™¯ä¸å…·ä½“ç”¨æ³•ã€‚</p>
<h3 data-id="heading-2">ä½¿ç”¨ <code>&lt;iframe /&gt;</code> æ–¹å¼åµŒå…¥</h3>
<p>åœ¨è°ƒç ”å¸¸è§çš„ç½‘é¡µåµŒå…¥å®ç°åï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ <code>&lt;iframe /&gt;</code> ä½œä¸ºåµŒå…¥å®¹å™¨ï¼šå®ƒæ— éœ€åç«¯å³å¯å±•ç¤ºåŸå§‹å›¾è¡¨ï¼Œå¹¶ä¸”å¯ä»¥ä¸å®æ—¶æ•°æ®äº¤äº’ã€‚</p>
<p>ç”±äº GitHub API å¯¹åŒ¿åè°ƒç”¨æœ‰ä¸¥æ ¼é™æµï¼Œæˆ‘ä»¬éœ€è¦ç”¨æˆ·æä¾›è‡ªå·±ç”Ÿæˆçš„ Token æ¥æå‡é™é¢ã€‚</p>
<h4 data-id="heading-3"><code>iframe</code> åµŒå…¥çš„ä½¿ç”¨æ­¥éª¤</h4>
<ol>
<li>
<p>æ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitdata.xuanhun520.com%2F" target="_blank" title="https://gitdata.xuanhun520.com/" ref="nofollow noopener noreferrer">gitdata.xuanhun520.com</a> å¹¶æŸ¥è¯¢ç›®æ ‡ä»“åº“ï¼›</p>
</li>
<li>
<p>ç‚¹å‡»å›¾è¡¨ä¸‹æ–¹çš„ <code>Embed</code> æŒ‰é’®ï¼›</p>
</li>
<li>
<p>è¾“å…¥ä½ çš„ä¸ªäººè®¿é—® Tokenï¼›</p>
<img width="745" height="596" alt="imageè½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c4b955faf39498bbfba4b6b866e183a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=fCwUkjsMQ2OZi%2B9YqBg99s6dOD4%3D" alt="image.png" loading="lazy"/>
4.  ç‚¹å‡» <code>Copy</code> æŒ‰é’®ï¼ŒæŠŠä»£ç ç²˜è´´åˆ°ä½ çš„ç«™ç‚¹æˆ–åšå®¢å³å¯ï¼›</p>
<h3 data-id="heading-4">ä½¿ç”¨ SVG é™æ€å›¾ç‰‡åµŒå…¥ï¼ˆç”¨äº READMEï¼‰</h3>
<p><code>iframe</code> åµŒå…¥å¾ˆå¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰ä¸¤ç‚¹é™åˆ¶ï¼š</p>
<ol>
<li>GitHub çš„ Markdown é£æ ¼ä¸å…è®¸æ¸²æŸ“ <code>&lt;iframe /&gt;</code>ï¼Œå› æ­¤æ— æ³•ç›´æ¥æŠŠäº¤äº’å›¾åµŒåˆ° READMEï¼›</li>
<li>éœ€è¦æä¾›ä¸ªäºº Tokenã€‚è™½ç„¶æˆ‘ä»¬ä¸åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨ Tokenï¼Œä½†åœ¨ç½‘é¡µæºç ä¸­ä»å¯çœ‹åˆ°å®ƒï¼Œè¿™åœ¨å…¬å…±åœºæ™¯ä¸‹å¹¶ä¸ç†æƒ³ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œæˆ‘ä»¬æä¾›äº†åŸºäºå›¾ç‰‡é“¾æ¥çš„ SVG æ–¹æ¡ˆï¼Œé€‚åˆåœ¨å…¬å…±é¡µé¢ï¼ˆä¾‹å¦‚ä»“åº“ READMEï¼‰ä¸­å±•ç¤ºæœ€æ–°æ˜Ÿå›¾ã€‚</p>
<h4 data-id="heading-5">åœ¨ GitHub README ä¸­æ·»åŠ å›¾è¡¨çš„æ­¥éª¤</h4>
<ol>
<li>
<p>æ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitdata.xuanhun520.com" target="_blank" title="https://gitdata.xuanhun520.com" ref="nofollow noopener noreferrer">gitdata.xuanhun520.com</a> å¹¶æŸ¥è¯¢ä»“åº“ï¼›</p>
</li>
<li>
<p>æ»šåŠ¨åˆ°æ“ä½œæŒ‰é’®ä¸‹æ–¹çš„å›¾ç‰‡åµŒå…¥åŒºåŸŸï¼›</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/107047db28f84d0ba6c4cc2fa79b247a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=Yk3833YHxok%2BY8VsIXlm7VMWAPg%3D" alt="image.png" loading="lazy"/>
3.  ç‚¹å‡» <code>Copy</code> æŒ‰é’®ï¼›</p>
<ol start="4">
<li>
<p>å°†ä»£ç ç²˜è´´åˆ°ä½ çš„ä»“åº“ README ä¸­ï¼›</p>
</li>
<li>
<p>æå®š ğŸ˜</p>
</li>
</ol>
<p>ç¤ºä¾‹é“¾æ¥ï¼ˆæŒ‰æ—¥æœŸæ¨¡å¼å±•ç¤ºï¼‰ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitdata.xuanhun520.com%2Fapi%2Fstarimg%3Frepos%3Dvisactor%2Fvchart%26type%3DDate%26theme%3Ddark" target="_blank" title="https://gitdata.xuanhun520.com/api/starimg?repos=visactor/vchart&amp;type=Date&amp;theme=dark" ref="nofollow noopener noreferrer">gitdata.xuanhun520.com/api/starimgâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d3deef95f4e4689b18a313ca46dc75d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=4vmt40xt5AfN5fie7mHPIXOj28s%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">ç»“è®º</h3>
<p>æˆ‘ä»¬æä¾›ä¸¤ç§æŠŠå®æ—¶æ˜Ÿå›¾åµŒå…¥ç½‘é¡µçš„æ–¹å¼ï¼š</p>
<ul>
<li>å¦‚æœä½ å¸Œæœ›åœ¨ç§æœ‰ç½‘ç»œé¡µé¢ä¸­æ”¾ç½®å¯è‡ªé€‚åº”ä¸”å¯äº¤äº’çš„å›¾è¡¨ï¼Œè¯·ä½¿ç”¨ <code>&lt;iframe /&gt;</code> åµŒå…¥ï¼›</li>
<li>å¦‚æœä½ å¸Œæœ›åœ¨å…¬å…±é¡µé¢ï¼ˆä¾‹å¦‚ GitHub READMEï¼‰ä¸­å±•ç¤ºæœ€æ–°çš„æ˜Ÿå›¾ï¼Œè¯·ä½¿ç”¨ SVG å›¾ç‰‡é“¾æ¥æ–¹å¼ï¼Œä¾‹å¦‚ï¼š</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">https://gitdata.xuanhun520.com/api/starimg?repos=visactor/vchart&amp;<span class="hljs-built_in">type</span>=Date&amp;theme=dark
</code></pre>
<hr/>
<h3 data-id="heading-7">ä¸‹ä¸€æ­¥</h3>
<ul>
<li>å¤šè¯­è¨€</li>
<li>åŠ å…¥æ›´å¤šæ•°æ®åˆ†æèƒ½åŠ›ï¼Œä¾‹å¦‚ï¼šä»“åº“ forks å†å²å›¾ã€è´¡çŒ®è€…æ´»åŠ¨å›¾ç­‰ï¼›</li>
<li>åŠ å…¥ç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼Œä»¥æ”¯æŒç§æœ‰ä»“åº“çš„åˆ†æï¼›</li>
<li>åŠ å…¥æ›´å¤šå¯è§†åŒ–å½¢å¼ï¼Œä¾‹å¦‚ä¿¡æ¯å›¾ï¼ŒåŠ¨æ€å›¾è¡¨ç­‰</li>
</ul>
<h3 data-id="heading-8">æ¬¢è¿star</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxuanhun%2Fgithub-data-analysis-" target="_blank" title="https://github.com/xuanhun/github-data-analysis-" ref="nofollow noopener noreferrer">star it </a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/398616932b064d5d87643629d0207605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766490254&amp;x-signature=5JYziidoTbedFxoX5a0eIoxi9Tc%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ruoyié›†æˆdmnè§„åˆ™å¼•æ“]]></title>    <link>https://juejin.cn/post/7583878719543738377</link>    <guid>https://juejin.cn/post/7583878719543738377</guid>    <pubDate>2025-12-15T10:22:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583878719543738377" data-draft-id="7583871118949236786" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ruoyié›†æˆdmnè§„åˆ™å¼•æ“"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-15T10:22:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç æ¬¡ä½é¢"/> <meta itemprop="url" content="https://juejin.cn/user/1535333867720295"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ruoyié›†æˆdmnè§„åˆ™å¼•æ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1535333867720295/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç æ¬¡ä½é¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T10:22:59.000Z" title="Mon Dec 15 2025 10:22:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¯å¢ƒè¯´æ˜</h2>
<p>åŸºäºRuoYi-Vue2qå‰ç«¯å¦‚ä½•é›†æˆDMNç»„ä»¶<br/>
ç‰ˆæœ¬å·:3.9.0<br/>
æ›´å¤šå…³äºruoyié›†æˆå·¥ä½œæµï¼Œè¯·è®¿é—®<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruoyiflow.com%2Fproduct%2F3" target="_blank" title="https://www.ruoyiflow.com/product/3" ref="nofollow noopener noreferrer">è‹¥ä¾å·¥ä½œæµ</a></p>
<h2 data-id="heading-1">é›†æˆæ­¥éª¤</h2>
<ul>
<li>å®‰è£…ä¾èµ–</li>
</ul>
<pre><code class="hljs language-shell" lang="shell">npm install dmn-js dmn-js-properties-panel --save
npm install --save dmn-moddle
</code></pre>
<ul>
<li>vue.config.jså¢åŠ dmn.jsé…ç½®, åœ¨transpileDependenciesï¼Œalias è¿›è¡Œè®¾ç½®</li>
</ul>
<pre><code class="hljs language-shell" lang="shell">lias: {
    '@': resolve('src'),
    'lezer-feel$': resolve('node_modules/lezer-feel/dist/index.js'),
    '@camunda/feel-builtins$': resolve('node_modules/@camunda/feel-builtins/dist/index.js'),
    'feelers$': resolve('node_modules/feelers/dist/index.js'),
    'feelin$': resolve('node_modules/feelin/dist/index.cjs'),
    '@bpmn-io/feel-lint$': resolve('node_modules/@bpmn-io/feel-lint/dist/index.js'),
    '@bpmn-io/lezer-feel$': resolve('node_modules/@bpmn-io/lezer-feel/dist/index.js'),
    // dmn-moddle ä½¿ç”¨ ES æ¨¡å—ï¼Œwebpack4 éœ€è¦æŒ‡å‘ CJS ç‰ˆæœ¬
    'dmn-moddle$': resolve('node_modules/dmn-moddle/dist/index.cjs')
    }

  transpileDependencies: [
    'quill', 
    'bpmn-js', 
    'diagram-js',
    'bpmn-js-properties-panel',
    '@bpmn-io/properties-panel',
    '@bpmn-io/feel-editor',
    '@bpmn-io/feel-lint', 
    '@bpmn-io/lezer-feel', 
    'feelers', 
    //ä»¥ä¸‹æ˜¯dmn-jséœ€è¦çš„é…ç½®ï¼Œä¸»è¦æ˜¯å› ä¸ºdmn-js ä½¿ç”¨äº† ES6+ è¯­æ³•ï¼Œä½† webpack æœªè½¬è¯‘ node_modules ä¸­çš„è¿™äº›æ–‡ä»¶
    'lezer-feel',
    'dmn-js',
    'dmn-js-properties-panel',
    'dmn-js-boxed-expression',
    'dmn-js-decision-table',
    'dmn-js-literal-expression',
    'dmn-js-shared',
    'dmn-moddle'],
</code></pre>
<ul>
<li>å‰ç«¯é¡µé¢ç¼–ç </li>
</ul>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;el-container class="dmn-modeler-container"&gt;
    &lt;!-- å¤´éƒ¨æ“ä½œåŒºåŸŸ --&gt;
    &lt;el-header class="dmn-header"&gt;
      &lt;div class="header-content"&gt;
        &lt;div class="header-title"&gt;
          &lt;h3&gt;DMN å†³ç­–è¡¨å»ºæ¨¡å™¨&lt;/h3&gt;
        &lt;/div&gt;
        &lt;div class="header-actions"&gt;
          &lt;el-button-group&gt;
            &lt;el-button icon="el-icon-folder-opened" @click="openFile"&gt;å¯¼å…¥&lt;/el-button&gt;
            &lt;el-button icon="el-icon-download" @click="downloadDiagram"&gt;å¯¼å‡º&lt;/el-button&gt;
            &lt;el-button icon="el-icon-document" type="primary" @click="saveDiagram"&gt;éƒ¨ç½²&lt;/el-button&gt;
          &lt;/el-button-group&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/el-header&gt;
    
    &lt;!-- ä¸»è¦å†…å®¹åŒºåŸŸ --&gt;
    &lt;el-main class="dmn-main"&gt;
      &lt;div class="dmn-content"&gt;
        &lt;!-- DMN ç”»å¸ƒåŒºåŸŸ --&gt;
        &lt;div class="canvas-container"&gt;
          &lt;div id="canvas" class="dmn-canvas" v-loading="initializing"&gt;&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/el-main&gt;
    
    &lt;!-- æ–‡ä»¶è¾“å…¥ --&gt;
    &lt;input 
      ref="fileInput" 
      type="file" 
      accept=".dmn,.xml" 
      style="display: none" 
      @change="handleFileImport"
    /&gt;
  &lt;/el-container&gt;
&lt;/template&gt;

&lt;script&gt;
import DmnModeler from 'dmn-js/lib/Modeler'
import FileSaver from 'file-saver'
import { deployDmnTable } from '@/api/camunda/dmn'

// æ ·å¼å¼•å…¥
// åŸºç¡€æ ·å¼
import 'dmn-js/dist/assets/diagram-js.css'
// DMN å­—ä½“æ ·å¼
import 'dmn-js/dist/assets/dmn-font/css/dmn.css'
// å†³ç­–è¡¨ç›¸å…³æ ·å¼ï¼ˆç¡®ä¿å†³ç­–è¡¨æ­£ç¡®æ˜¾ç¤ºï¼‰
import 'dmn-js/dist/assets/dmn-js-shared.css'
import 'dmn-js/dist/assets/dmn-js-decision-table.css'
import 'dmn-js/dist/assets/dmn-js-decision-table-controls.css'
// DRD (Decision Requirements Diagram) è§†å›¾æ ·å¼
import 'dmn-js/dist/assets/dmn-js-drd.css'

export default {
  name: 'CamundaDmnModeler',
  data() {
    return {
      dmnModeler: null,
      canUndo: false,
      canRedo: false,
      isInitialized: false, // æ ‡è®°æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ
      initializing: false, // åˆå§‹åŒ–æˆ–å¯¼å…¥ä¸­çš„ loading çŠ¶æ€
      initPromise: null // è®°å½•åˆå§‹åŒ– Promiseï¼Œä¾¿äºåç»­ç­‰å¾…
    }
  },
  mounted() {
    this.$nextTick(() =&gt; {
      this.initModeler()
    })
  },
  beforeDestroy() {
    if (this.dmnModeler) {
      this.dmnModeler.destroy()
      this.dmnModeler = null
    }
    this.initPromise = null
  },
  methods: {
    // ç”Ÿæˆéšæœºå†³ç­–è¡¨ID
    generateDecisionId() {
      const randomNum = Math.floor(Math.random() * 10000)
      return `Decision_${randomNum}`
    },

    initModeler() {
      if (this.initializing &amp;&amp; this.initPromise) {
        return this.initPromise
      }

      try {
        // å¦‚æœå·²æœ‰å®ä¾‹ï¼Œå…ˆé”€æ¯é‡æ–°åˆ›å»ºï¼Œé¿å…æ®‹ç•™çŠ¶æ€
        if (this.dmnModeler) {
          try {
            this.dmnModeler.destroy()
          } catch (destroyErr) {
            console.warn('é”€æ¯æ—§çš„ DMN Modeler å¤±è´¥:', destroyErr)
          }
        }

        this.dmnModeler = new DmnModeler({
          container: '#canvas'
        })
        this.initializing = true
        this.isInitialized = false
        
        // åŠ è½½ç©ºç™½å†³ç­–è¡¨ - ä½¿ç”¨æ ‡å‡†çš„ DMN 1.3 æ ¼å¼
        // æ ¹æ® dmn-moddle 11.0.0ï¼Œä½¿ç”¨æ­£ç¡®çš„å‘½åç©ºé—´
        const decisionId = this.generateDecisionId()
        const decisionTableId = 'DecisionTable_' + Date.now()
        const diagramXML = `&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" id="Definitions_1" name="å†³ç­–è¡¨" namespace="http://camunda.org/schema/1.0/dmn"&gt;
  &lt;decision id="${decisionId}" name="å†³ç­–è¡¨"&gt;
    &lt;decisionTable id="${decisionTableId}" hitPolicy="UNIQUE"&gt;
      &lt;input id="Input_1" label="è¾“å…¥"&gt;
        &lt;inputExpression id="InputExpression_1" typeRef="string"&gt;
          &lt;text&gt;&lt;/text&gt;
        &lt;/inputExpression&gt;
      &lt;/input&gt;
      &lt;output id="Output_1" label="è¾“å‡º" typeRef="string" /&gt;
    &lt;/decisionTable&gt;
  &lt;/decision&gt;
  &lt;dmndi:DMNDI&gt;
    &lt;dmndi:DMNDiagram id="DMNDiagram_1"&gt;
      &lt;dmndi:DMNShape id="DMNShape_${decisionId}" dmnElementRef="${decisionId}"&gt;
        &lt;dc:Bounds x="100" y="100" width="300" height="200" /&gt;
      &lt;/dmndi:DMNShape&gt;
    &lt;/dmndi:DMNDiagram&gt;
  &lt;/dmndi:DMNDI&gt;
&lt;/definitions&gt;`

        // ä½¿ç”¨ç®­å¤´å‡½æ•°ç¡®ä¿ this ä¸Šä¸‹æ–‡æ­£ç¡®
        const initTask = this.dmnModeler.importXML(diagramXML)
        this.initPromise = initTask
        initTask.then(() =&gt; {
          // åªæœ‰åœ¨ importXML æˆåŠŸåæ‰æ ‡è®°ä¸ºå·²åˆå§‹åŒ–
          this.isInitialized = true
          this.initializing = false
          this.$message.success('å†³ç­–è¡¨åˆå§‹åŒ–æˆåŠŸ')
          
          // ç¡®ä¿ dmnModeler å·²å®Œå…¨åˆå§‹åŒ–åå†è®¿é—®æœåŠ¡
          if (this.dmnModeler &amp;&amp; typeof this.dmnModeler.get === 'function') {
            // ç­‰å¾… DOM æ›´æ–°
            this.$nextTick(() =&gt; {
              // ç›‘å¬æ’¤é”€é‡åšçŠ¶æ€
              const eventBus = this.dmnModeler.get('eventBus')
              if (eventBus) {
                eventBus.on('commandStack.changed', () =&gt; {
                  if (this.dmnModeler &amp;&amp; typeof this.dmnModeler.get === 'function') {
                    const commandStack = this.dmnModeler.get('commandStack')
                    if (commandStack) {
                      this.canUndo = commandStack.canUndo()
                      this.canRedo = commandStack.canRedo()
                    }
                  }
                })
              }
              
            })
          }
        }).catch(err =&gt; {
          console.error('åˆå§‹åŒ–å¤±è´¥:', err)
          console.error('XML å†…å®¹:', diagramXML)
          this.isInitialized = false
          this.initializing = false
          this.$message.error('å†³ç­–è¡¨åˆå§‹åŒ–å¤±è´¥: ' + (err.message || 'æœªçŸ¥é”™è¯¯'))
          // å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œæ¸…ç©º dmnModelerï¼Œé¿å…ä½¿ç”¨ä¸å®Œæ•´çš„çŠ¶æ€
          if (this.dmnModeler) {
            try {
              this.dmnModeler.destroy()
            } catch (e) {
              console.warn('é”€æ¯å¤±è´¥çš„ modeler:', e)
            }
            this.dmnModeler = null
          }
          throw err
        }).finally(() =&gt; {
          // ä¿æŒ initPromise åªä»£è¡¨æœ€è¿‘ä¸€æ¬¡åˆå§‹åŒ–
          if (this.initPromise === initTask) {
            this.initPromise = null
          }
        })

        return initTask
      } catch (err) {
        console.error('åˆ›å»º DMN Modeler å¤±è´¥:', err)
        this.$message.error('åˆ›å»ºå†³ç­–è¡¨å»ºæ¨¡å™¨å¤±è´¥: ' + (err.message || 'æœªçŸ¥é”™è¯¯'))
        this.initializing = false
        this.isInitialized = false
        this.initPromise = null
        throw err
      }
    },

    async ensureModelerReady() {
      debugger
      if (this.isInitialized &amp;&amp; this.dmnModeler &amp;&amp; typeof this.dmnModeler.get === 'function') {
        return true
      }
      if (!this.initializing || !this.initPromise) {
        try {
          await this.initModeler()
        } catch (err) {
          console.error('é‡æ–°åˆå§‹åŒ–å†³ç­–è¡¨å»ºæ¨¡å™¨å¤±è´¥:', err)
          return false
        }
      }
      if (this.initPromise) {
        try {
          await this.initPromise
        } catch (err) {
          console.error('ç­‰å¾…å†³ç­–è¡¨å»ºæ¨¡å™¨åˆå§‹åŒ–å¤±è´¥:', err)
          return false
        }
      }
      return this.isInitialized &amp;&amp; this.dmnModeler &amp;&amp; typeof this.dmnModeler.get === 'function'
    },

    // ç¡®ä¿XMLåŒ…å«å¿…è¦çš„å‘½åç©ºé—´
    ensureDmnNamespace(xml) {
      // æ£€æŸ¥æ˜¯å¦åŒ…å«æ­£ç¡®çš„ DMN 1.3 å‘½åç©ºé—´
      // MODEL å‘½åç©ºé—´åº”è¯¥æ˜¯ https://www.omg.org/spec/DMN/20191111/MODEL/
      if (xml.indexOf('xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"') === -1 &amp;&amp; 
          xml.indexOf('xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/"') === -1) {
        // å¦‚æœç¼ºå°‘é»˜è®¤å‘½åç©ºé—´ï¼Œå°è¯•æ·»åŠ 
        if (xml.indexOf('&lt;definitions') !== -1) {
          // æ›¿æ¢ definitions æ ‡ç­¾ï¼Œæ·»åŠ é»˜è®¤å‘½åç©ºé—´
          xml = xml.replace(
            /&lt;definitions([^&gt;]*)&gt;/,
            '&lt;definitions$1 xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"&gt;'
          )
        } else if (xml.indexOf('&lt;dmn:definitions') !== -1) {
          // å¦‚æœä½¿ç”¨ dmn: å‰ç¼€ï¼Œä¹Ÿæ·»åŠ å‘½åç©ºé—´
          xml = xml.replace(
            /&lt;dmn:definitions([^&gt;]*)&gt;/,
            '&lt;dmn:definitions$1 xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"&gt;'
          )
        }
      }
      return xml
    },

    // ä» XML ä¸­æå–ç¬¬ä¸€ä¸ª decision çš„ name å±æ€§
    extractDecisionName(xml) {
      if (!xml || typeof xml !== 'string') {
        return null
      }
      try {
        if (typeof window !== 'undefined' &amp;&amp; window.DOMParser) {
          const parser = new DOMParser()
          const doc = parser.parseFromString(xml, 'text/xml')
          const parserError = doc.getElementsByTagName('parsererror')
          if (parserError &amp;&amp; parserError.length) {
            console.warn('DOMParser è§£æ DMN XML å‡ºé”™ï¼Œé€€å›æ­£åˆ™è§£æ')
          } else {
            // å…ˆå°è¯•ä¸å¸¦å‘½åç©ºé—´çš„ decision
            let decisionEl = doc.getElementsByTagName('decision')[0]
            if (!decisionEl) {
              // å†å°è¯•å¸¦å‘½åç©ºé—´çš„ decision
              decisionEl = doc.getElementsByTagNameNS('https://www.omg.org/spec/DMN/20191111/MODEL/', 'decision')[0]
            }
            if (decisionEl) {
              const name = decisionEl.getAttribute('name')
              if (name) {
                return name
              }
            }
          }
        }
      } catch (err) {
        console.warn('DOMParser æå–å†³ç­–åç§°å¤±è´¥:', err)
      }

      // æ­£åˆ™åå¤‡æ–¹æ¡ˆï¼Œå…¼å®¹å•å¼•å·æˆ–åŒå¼•å·
      const match = xml.match(/&lt;\s*(?:dmn:)?decision\b[^&gt;]*\bname=['"]([^'"]+)['"]/i)
      if (match &amp;&amp; match[1]) {
        return match[1]
      }
      return null
    },

    async saveDiagram() {
      try {
        // const ready = await this.ensureModelerReady()
        // if (!ready) {
        //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨æœªåˆå§‹åŒ–ï¼Œè¯·ç¨åå†è¯•')
        //   return
        // }
        
        const modeler = this.dmnModeler
        // if (!modeler || typeof modeler.get !== 'function') {
        //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨ä¸å¯ç”¨ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•')
        //   return
        // }

        const { xml } = await modeler.saveXML({ 
          format: true,
          preamble: true
        })
        
        // ç¡®ä¿XMLåŒ…å«å¿…è¦çš„å‘½åç©ºé—´
        const processedXml = this.ensureDmnNamespace(xml)
        
        // è·å–å†³ç­–è¡¨åç§°ï¼šä¼˜å…ˆè¯»å– XML ä¸­ decision çš„ name
        let decisionName = this.extractDecisionName(processedXml)
        
        if (!decisionName) {
          try {
            const elementRegistry = modeler.get('elementRegistry')
            if (elementRegistry) {
              // å°è¯•ä»å†³ç­–è¡¨ä¸­è·å–åç§°
              const decisions = elementRegistry.filter(el =&gt; el.type === 'dmn:Decision')
              if (decisions.length &gt; 0) {
                const decision = decisions[0]
                const bo = decision.businessObject || decision
                decisionName = bo.name || bo.id || decisionName
              }
            }
          } catch (e) {
            console.warn('ä» elementRegistry è·å–å†³ç­–è¡¨åç§°å¤±è´¥:', e)
          }
        }

        if (!decisionName) {
          decisionName = 'decision_' + Date.now()
        }
        
        // å‡†å¤‡éƒ¨ç½²å‚æ•°
        const deployData = {
          decisionName: decisionName,
          dmnXml: processedXml,
          tenantId: '',
          description: 'å†³ç­–è¡¨éƒ¨ç½²'
        }
        
        // è°ƒç”¨éƒ¨ç½²API
        this.$message.info('æ­£åœ¨éƒ¨ç½²å†³ç­–è¡¨...')
        const response = await deployDmnTable(deployData)
        
        this.$message.success(`å†³ç­–è¡¨éƒ¨ç½²æˆåŠŸï¼å†³ç­–åç§°: ${decisionName}`)
        
        console.log('Deployment response:', response)
        // è·³è½¬åˆ°å†³ç­–è¡¨åˆ—è¡¨é¡µé¢
        this.$router.push('/dmn/list')
        
      } catch (err) {
        console.error('Deployment error:', err)
        const errorMessage = err.response?.data?.message || err.message || 'éƒ¨ç½²å¤±è´¥'
        this.$message.error('éƒ¨ç½²å¤±è´¥: ' + errorMessage)
      }
    },

    async downloadDiagram() {
      try {
        // const ready = await this.ensureModelerReady()
        // if (!ready) {
        //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨æœªåˆå§‹åŒ–ï¼Œè¯·ç¨åå†è¯•')
        //   return
        // }
        
        const modeler = this.dmnModeler
        // if (!modeler || typeof modeler.get !== 'function') {
        //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨ä¸å¯ç”¨ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•')
        //   return
        // }

        const { xml } = await modeler.saveXML({ 
          format: true,
          preamble: true
        })
        // ç¡®ä¿XMLåŒ…å«å¿…è¦çš„å‘½åç©ºé—´
        const processedXml = this.ensureDmnNamespace(xml)
        const blob = new Blob([processedXml], { type: 'application/xml' })
        FileSaver.saveAs(blob, 'decision-table.dmn')
      } catch (err) {
        this.$message.error('å¯¼å‡ºå¤±è´¥: ' + (err.message || 'æœªçŸ¥é”™è¯¯'))
      }
    },

    openFile() {
      this.$refs.fileInput.click()
    },
    
    async handleFileImport(event) {
      const file = event.target.files[0]
      if (!file) return
      
      // const ready = await this.ensureModelerReady()
      // if (!ready) {
      //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•')
      //   return
      // }
      
      const reader = new FileReader()
      reader.onload = (e) =&gt; {
        try {
          const xml = e.target.result
          this.initializing = true
          const modeler = this.dmnModeler
          // if (!modeler || typeof modeler.get !== 'function') {
          //   this.initializing = false
          //   this.$message.error('å†³ç­–è¡¨å»ºæ¨¡å™¨ä¸å¯ç”¨ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•')
          //   return
          // }
          modeler.importXML(xml).then(() =&gt; {
            this.isInitialized = true
            this.initializing = false
            this.$message.success('æ–‡ä»¶å¯¼å…¥æˆåŠŸ')
          }).catch(error =&gt; {
            console.error('æ–‡ä»¶å¯¼å…¥å¤±è´¥:', error)
            this.isInitialized = false
            this.initializing = false
            this.$message.error('æ–‡ä»¶å¯¼å…¥å¤±è´¥: ' + (error.message || 'æœªçŸ¥é”™è¯¯'))
          })
        } catch (error) {
          console.error('æ–‡ä»¶è¯»å–å¤±è´¥:', error)
          this.initializing = false
          this.$message.error('æ–‡ä»¶è¯»å–å¤±è´¥: ' + (error.message || 'æœªçŸ¥é”™è¯¯'))
        }
      }
      reader.readAsText(file)
      
      // æ¸…ç©ºæ–‡ä»¶è¾“å…¥
      event.target.value = ''
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.dmn-modeler-container {
  width: 100%;
  height: 100vh;
  min-width: 900px;
  display: flex;
  flex-direction: column;
}

/* å¤´éƒ¨æ ·å¼ */
.dmn-header {
  background-color: #f5f7fa;
  border-bottom: 1px solid #e4e7ed;
  padding: 0 20px;
  height: 60px !important;
  display: flex;
  align-items: center;
}

.header-content {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.header-title h3 {
  margin: 0;
  color: #303133;
  font-size: 18px;
  font-weight: 500;
}

.header-actions {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
}

.header-actions .el-button-group {
  margin-right: 0;
}

.header-actions .el-button-group .el-button {
  margin-right: 0;
}

/* ä¸»å†…å®¹åŒºåŸŸæ ·å¼ */
.dmn-main {
  padding: 0;
  height: calc(100vh - 60px);
  overflow: hidden;
}

.dmn-content {
  display: flex;
  height: 100%;
  width: 100%;
}

/* ç”»å¸ƒå®¹å™¨æ ·å¼ */
.canvas-container {
  flex: 1;
  position: relative;
  display: flex;
  flex-direction: column;
  min-width: 0; /* å…è®¸ flex å­å…ƒç´ ç¼©å° */
}

.dmn-canvas {
  width: 100%;
  height: 100%;
  border: 1px solid #dcdfe6;
  background-color: #fff;
}

&lt;/style&gt;

</code></pre>
<h2 data-id="heading-2">æœ€ç»ˆé¡µé¢å±•ç¤º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a96e614955d4819805d2fc81d5ca3c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766398979&amp;x-signature=Mz%2BtwnNwYlHxCrRajjgE55UwMz0%3D" alt="dmn1.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸‰åˆ†é’Ÿææ‡‚ Kotlin Flow ä¸­çš„èƒŒå‹]]></title>    <link>https://juejin.cn/post/7583325900294995968</link>    <guid>https://juejin.cn/post/7583325900294995968</guid>    <pubDate>2025-12-15T01:22:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583325900294995968" data-draft-id="7576676694784835618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸‰åˆ†é’Ÿææ‡‚ Kotlin Flow ä¸­çš„èƒŒå‹"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2025-12-15T01:22:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸‰åˆ†é’Ÿææ‡‚ Kotlin Flow ä¸­çš„èƒŒå‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T01:22:45.000Z" title="Mon Dec 15 2025 01:22:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/593a6d2a7d204736a202ff46eb495300~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766366565&amp;x-signature=n69WJc8IuUGvUhJiommxN3H5tyY%3D" alt="0.jpg" loading="lazy"/></p>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼šæ•°æ®æºå‘é€å¾—å¤ªå¿«ï¼Œä½ çš„åº”ç”¨æ ¹æœ¬å¤„ç†ä¸è¿‡æ¥ï¼Œç»“æœè¦ä¹ˆå¡é¡¿è¦ä¹ˆå´©æºƒï¼Ÿ</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒKotlin <code>Flow</code> æä¾›äº†ä¸€äº›å†…ç½®çš„æ–¹æ³•ï¼Œè®©ä½ çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…èƒ½æ­¥è°ƒä¸€è‡´ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šèŠèŠï¼š</p>
<ol>
<li>èƒŒå‹ï¼ˆBackpressureï¼‰æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</li>
<li>é»˜è®¤çš„â€œç­‰ä¸€ç­‰â€æ¨¡å¼æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</li>
<li>ä»€ä¹ˆæ—¶å€™ç”¨ <code>buffer()</code> åŠ ä¸ªå°é˜Ÿåˆ—ï¼Ÿ</li>
<li><code>conflate()</code> æ€ä¹ˆè·³è¿‡æ—§æ•°æ®ï¼Ÿ</li>
<li><code>collectLatest { }</code> ä¸ºä»€ä¹ˆä¼šåœ¨æ–°æ•°æ®åˆ°æ¥æ—¶åœæ­¢æ—§ä»»åŠ¡ï¼Ÿ</li>
<li>å¦‚ä½•æ ¹æ®è‡ªå·±çš„æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆï¼Ÿ</li>
</ol>
<h2 data-id="heading-0">èƒŒå‹ï¼ˆBackpressureï¼‰æ˜¯ä»€ä¹ˆ</h2>
<p><strong>èƒŒå‹</strong> å°±æ˜¯ç¡®ä¿å¿«é€Ÿçš„æ•°æ®å‘é€æ–¹ä¸ä¼šæŠŠæ…¢é€Ÿçš„æ¥æ”¶æ–¹ç»™å‹å®ã€‚è¦æ˜¯æ²¡æœ‰è¿™ç©æ„å„¿ï¼Œå†…å­˜é‡Œå¯èƒ½ä¼šå †æ»¡æœªå¤„ç†çš„æ•°æ®ï¼Œæˆ–è€…èŠ±æ—¶é—´å¤„ç†å·²ç»è¿‡æ—¶çš„ä¿¡æ¯ã€‚</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒAndroid å±å¹•çš„åˆ·æ–°ç‡æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼Œ<code>60</code> fpsï¼Œ<code>90</code> fpsï¼Œå¥½ä¸€ç‚¹çš„æ”¶é›† <code>120</code> fpsï¼Œæƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬å†™çš„ UI ä»æµé‚£é‡Œæ”¶é›†æ•°æ®ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®å‘é€å‘æ¯ç§’é’Ÿè¶…è¿‡äº† <code>200</code> æ¬¡ï¼Œé‚£ä¹ˆå…¶å®å…¶ä¸­æœ‰å¥½å‡ åæ¬¡æ˜¯æ²¡ç”¨çš„ï¼Œå› ä¸ºè¿™äº›æ•°æ®æ ¹æœ¬ä¸ä¼šæ¸²æŸ“åœ¨å±å¹•ä¸Šã€‚</p>
<p>å®é™…ä¸Šæ¥æ”¶æ–¹çš„æ•°æ®ï¼Œåªè¦ä¿æŒ <code>60</code> æ¬¡/ç§’å°±å¾ˆå¤Ÿç”¨äº†ã€‚</p>
<p>æ­¤æ—¶ï¼Œä½ å°±éœ€è¦èƒŒå‹ï¼</p>
<p>èƒŒå‹çš„å¥½å¤„æœ‰ï¼š</p>
<ul>
<li>æ§åˆ¶å†…å­˜ä½¿ç”¨</li>
<li>é¿å…åšæ— ç”¨åŠŸ</li>
<li>è®©åº”ç”¨æ€§èƒ½æ›´ç¨³å®š</li>
</ul>
<h2 data-id="heading-1">é»˜è®¤çš„â€œç­‰ä¸€ç­‰â€æ¨¡å¼</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceda4839984a48c99228a3e92599e692~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766366565&amp;x-signature=UTK2Q2fdnNWkB5b5Bg75wb83QBs%3D" alt="1.png" loading="lazy"/></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä½ è¿™ä¹ˆå†™ä»£ç æ—¶ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flow {
        (<span class="hljs-number">1.</span><span class="hljs-number">.3</span>).forEach {
            timeLog(<span class="hljs-string">"Send <span class="hljs-variable">$it</span>"</span>)
            emit(it)
            delay(<span class="hljs-number">100</span>)            <span class="hljs-comment">// å¿«é€Ÿå‘é€æ–¹</span>
        }
    }.collect { value -&gt;
        timeLog(<span class="hljs-string">"Processing <span class="hljs-variable">$value</span>"</span>)
        delay(<span class="hljs-number">300</span>)             <span class="hljs-comment">// æ…¢é€Ÿå¤„ç†æ–¹</span>
    }
}

<span class="hljs-comment">// output:</span>
<span class="hljs-comment">// 20:22:19.647 Send 1</span>
<span class="hljs-comment">// 20:22:19.701 Processing 1</span>
<span class="hljs-comment">// 20:22:20.142 Send 2</span>
<span class="hljs-comment">// 20:22:20.143 Processing 2</span>
<span class="hljs-comment">// 20:22:20.564 Send 3</span>
<span class="hljs-comment">// 20:22:20.564 Processing 3</span>
</code></pre>
<p><strong>å‘é€æ–¹</strong>ï¼ˆ<code>emit</code>ï¼‰ä¼šæš‚åœï¼Œç›´åˆ° <strong>å¤„ç†æ–¹</strong>ï¼ˆ<code>collect</code>ï¼‰å¤„ç†å®Œä¸Šä¸€ä¸ªå€¼ã€‚è¿™é‡Œæ²¡æœ‰é˜Ÿåˆ—ï¼Œæ¯ä¸ªå€¼éƒ½æ˜¯ä¸€æ¬¡å‘é€ã€ä¸€æ¬¡å¤„ç†ã€‚</p>
<h2 data-id="heading-2">bufferï¼šåŠ ä¸ªå°é˜Ÿåˆ—</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2fe89428f2274e69b78a2b23b0e348b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766366565&amp;x-signature=l26s4106hXnpRlLbK3o5wdGkLg0%3D" alt="2.png" loading="lazy"/></p>
<p>å¦‚æœä½ æƒ³è®©å‘é€æ–¹ç¨å¾®æå‰ä¸€ç‚¹ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin">flow {
<span class="hljs-comment">//...</span>
}
.buffer(capacity = <span class="hljs-number">2</span>)
.collect { value -&gt;
<span class="hljs-comment">//...    </span>
}

<span class="hljs-comment">// output:</span>
<span class="hljs-comment">// 20:27:03.368 Send 1</span>
<span class="hljs-comment">// 20:27:03.418 Processing 1</span>
<span class="hljs-comment">// 20:27:03.529 Send 2</span>
<span class="hljs-comment">// 20:27:03.639 Send 3</span>
<span class="hljs-comment">// 20:27:03.732 Processing 2</span>
<span class="hljs-comment">// 20:27:04.470 Processing 3</span>
</code></pre>
<p><em>æ•´ä½“æ—¶é—´å˜å¿«äº†ï¼</em></p>
<ul>
<li>ç°åœ¨å‘é€æ–¹æœ€å¤šå¯ä»¥æŠŠ <code>2</code> ä¸ªå…ƒç´ æ”¾å…¥ä¸€ä¸ªå°é˜Ÿåˆ—ä¸­ã€‚</li>
<li>ä¸€æ—¦é˜Ÿåˆ—æ»¡äº†ï¼Œå®ƒå°±ä¼šå†æ¬¡æš‚åœã€‚</li>
</ul>
<p>è¿™å°±ç»™äº†ä½ ä¸€ä¸ª <strong>æœ‰é™é˜Ÿåˆ—</strong>ï¼šä½ ä»ç„¶ä¼šå¤„ç†æ¯ä¸€ä¸ªå…ƒç´ ï¼Œä½†å¯ä»¥å¹³æ»‘å¤„ç†é€Ÿåº¦ä¸Šçš„çªå‘æ³¢åŠ¨ã€‚</p>
<h2 data-id="heading-3">conflateï¼šè·³è¿‡æ—§æ•°æ®</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e115b3dfe7874c41a64b1d6e0c958bdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766366565&amp;x-signature=acYkkwsGQLMewTnJQOn6tNNMK3U%3D" alt="3.png" loading="lazy"/></p>
<p>å½“ä½ åªå…³å¿ƒæœ€æ–°æ•°æ®æ—¶ï¼ˆæ¯”å¦‚æ›´æ–°è¿›åº¦æ¡ï¼‰ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin">flow { ... }
.conflate()
.collect { value -&gt; ... }

<span class="hljs-comment">// output:</span>
<span class="hljs-comment">// 20:30:45.745 Send 1</span>
<span class="hljs-comment">// 20:30:45.813 Processing 1</span>
<span class="hljs-comment">// 20:30:45.930 Send 2</span>
<span class="hljs-comment">// 20:30:46.039 Send 3</span>
<span class="hljs-comment">// 20:30:46.133 Processing 3</span>
</code></pre>
<ul>
<li>å¦‚æœå¤„ç†æ–¹æ­£å¿™ï¼Œåªæœ‰ <strong>æœ€æ–°çš„</strong> æœªå¤„ç†é¡¹ä¼šè¢«ä¿ç•™ã€‚</li>
<li>æ—§çš„é¡¹ä¼šè¢«ä¸¢å¼ƒï¼Œæ‰€ä»¥ä½ æ°¸è¿œä¸ä¼šå¤„ç†è¿‡æ—¶çš„æ›´æ–°ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š<code>conflate()</code> ä¸ä¼šåœæ­¢å½“å‰æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼›å®ƒåªæ˜¯åœ¨ä¸‹ä¸€æ¬¡è¯»å–æ—¶è·³è¿‡æ—§å€¼ã€‚</p>
</blockquote>
<h2 data-id="heading-4">collectLatestï¼šå–æ¶ˆæ—§ä»»åŠ¡</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c5e4db0599841cca90b2f1eb0a0c597~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766366565&amp;x-signature=cXhLnC1G98uWA4zIWrhe4OEqXTk%3D" alt="4.png" loading="lazy"/></p>
<p>å¦‚æœä½ å¸Œæœ›åœ¨æ–°æ•°æ®åˆ°æ¥æ—¶ç«‹å³å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flow {
        (<span class="hljs-number">1.</span><span class="hljs-number">.3</span>).forEach {
            timeLog(<span class="hljs-string">"Send <span class="hljs-variable">$it</span>"</span>)
            emit(it)
            delay(<span class="hljs-number">100</span>)            
        }
    }.collectLatest { value -&gt;
        timeLog(<span class="hljs-string">"Start process <span class="hljs-variable">$value</span>"</span>)
        delay(<span class="hljs-number">300</span>)             
        timeLog(<span class="hljs-string">"Complete process <span class="hljs-variable">$value</span>"</span>)
    }
}

<span class="hljs-comment">// output:</span>
<span class="hljs-comment">// 09:31:32.919 Send 1</span>
<span class="hljs-comment">// 09:31:32.979 Start process 1</span>
<span class="hljs-comment">// 09:31:33.090 Send 2</span>
<span class="hljs-comment">// 09:31:33.093 Start process 2</span>
<span class="hljs-comment">// 09:31:33.195 Send 3</span>
<span class="hljs-comment">// 09:31:33.195 Start process 3</span>
<span class="hljs-comment">// 09:31:33.498 Complete process 3</span>
</code></pre>
<p><em>ä½ ä¼šå‘ç°ï¼Œåªæœ‰ <code>3</code> å®Œæˆäº†ä»»åŠ¡ã€‚</em></p>
<ul>
<li>æ¯å½“æœ‰æ–°çš„ <code>emit</code> å‘ç”Ÿæ—¶ï¼Œæ­£åœ¨å¤„ç†å‰ä¸€ä¸ªå€¼çš„ä»£ç å—ä¼šç«‹åˆ»è¢«ä¸¢å¼ƒã€‚</li>
<li>åªæœ‰å½“å‘é€æ–¹åœæ­¢å‘é€åï¼Œä½ æ‰ä¼šå®Œæˆå¯¹ <strong>æœ€åä¸€ä¸ª</strong> å€¼çš„å¤„ç†ã€‚</li>
</ul>
<p>è¿™ç§æ¨¡å¼éå¸¸é€‚åˆ <strong>â€œè¾¹è¾“å…¥è¾¹æœç´¢â€</strong> çš„åœºæ™¯â€”â€”ç”¨æˆ·ç»§ç»­è¾“å…¥æ—¶ï¼Œä½ å¯ä»¥ç«‹å³æ”¾å¼ƒä¹‹å‰çš„æœç´¢è¯·æ±‚ã€‚</p>
<h2 data-id="heading-5">æŠ‰æ‹©æŒ‡å—</h2>
<ul>
<li><code>collect</code><br/>
<em>ä½œç”¨</em>ï¼šå‘é€æ–¹å’Œå¤„ç†æ–¹é€ä¸ªç­‰å¾…ï¼Œä¸€ä¸€å¯¹åº”<br/>
<em>é€‚ç”¨åœºæ™¯</em>ï¼šä½ éœ€è¦æŒ‰é¡ºåºå¤„ç† <strong>æ¯ä¸€ä¸ª</strong> å€¼</li>
<li><code>buffer</code><br/>
<em>ä½œç”¨</em>ï¼šåˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º <code>n</code> çš„å°é˜Ÿåˆ—ï¼›ä¸ä¼šä¸¢å¼ƒä»»ä½•å…ƒç´ <br/>
<em>é€‚ç”¨åœºæ™¯</em>ï¼šä½ æƒ³æœ‰ä¸€ç‚¹ç¼“å†²èƒ½åŠ›ï¼Œä½†ä»éœ€å¤„ç†æ‰€æœ‰å…ƒç´ </li>
<li><code>conflate</code><br/>
<em>ä½œç”¨</em>ï¼šå¦‚æœå¤„ç†æ–¹æ­£å¿™ï¼Œåªä¿ç•™ <strong>æœ€æ–°çš„</strong> å…ƒç´ <br/>
<em>é€‚ç”¨åœºæ™¯</em>ï¼šä½ éœ€è¦æœ€æ–°æ•°æ®ï¼Œä½†ä»å¸Œæœ›å®Œæˆå½“å‰æ­£åœ¨å¤„ç†çš„ä»»åŠ¡</li>
<li><code>collectLatest</code><br/>
<em>ä½œç”¨</em>ï¼šæ–°æ•°æ®ä¸€åˆ°å°±ç«‹å³å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡<br/>
<em>é€‚ç”¨åœºæ™¯</em>ï¼šåªæœ‰ <strong>æœ€æ–°ç»“æœ</strong> æœ‰æ„ä¹‰ï¼›å…¶ä»–ä¸€åˆ‡éƒ½å¯ä»¥ç«‹åˆ»ä¸¢å¼ƒ</li>
</ul>
<hr/>
<p>ä¸‹æ¬¡å½“ä½ è§‰å¾— Flow å¤ªå¿«æˆ–å¤ªæ…¢æ—¶ï¼Œé—®é—®è‡ªå·±ï¼š</p>
<ol>
<li>æˆ‘æ˜¯å¦éœ€è¦å¤„ç†æ¯ä¸€ä¸ªå€¼ï¼Ÿ</li>
<li>ä¸€ä¸ªå°é˜Ÿåˆ—ä¼šæœ‰å¸®åŠ©å—ï¼Ÿ</li>
<li>æ˜¯å¦åªæœ‰æœ€æ–°æ•°æ®æ‰é‡è¦ï¼Ÿ</li>
<li>æ–°æ•°æ®åˆ°æ¥æ—¶ï¼Œæˆ‘æ˜¯å¦åº”è¯¥å–æ¶ˆæ—§ä»»åŠ¡ï¼Ÿ</li>
</ol>
<p>é€‰æ‹©æœ€ç®€å•çš„ã€èƒ½æ»¡è¶³éœ€æ±‚çš„é€‰é¡¹ï¼ŒKotlin <code>Flow</code> ä¼šæ›¿ä½ å¤„ç†å…¶ä½™çš„ä¸€åˆ‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ Trae + MCP è®© AI è‡ªåŠ¨æµ‹è¯•é¡µé¢]]></title>    <link>https://juejin.cn/post/7583898823921008682</link>    <guid>https://juejin.cn/post/7583898823921008682</guid>    <pubDate>2025-12-15T12:10:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583898823921008682" data-draft-id="7581649704884191247" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ Trae + MCP è®© AI è‡ªåŠ¨æµ‹è¯•é¡µé¢"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-15T12:10:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è°è¨€è¥¿è¥¿é‡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/332466136029851"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ Trae + MCP è®© AI è‡ªåŠ¨æµ‹è¯•é¡µé¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/332466136029851/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è°è¨€è¥¿è¥¿é‡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T12:10:47.000Z" title="Mon Dec 15 2025 12:10:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æƒ³å¿…å¤§å®¶åœ¨å‰æ®µæ—¶é—´å…³äº <strong>â€œè±†åŒ…æ‰‹æœºâ€</strong> ä¸€å®šæœ‰æ‰€è€³é—»ï¼Œè¯´å®è¯åœ¨çœ‹è¿‡äº†ä¸å°‘åšä¸»çš„ä½“éªŒå’Œæµ‹è¯„ä¹‹åå‘€ï¼Œä¸ç¦æœ‰ç‚¹æ„Ÿå¹ç°ä»£çš„AIå‘å±•äº†ğŸ¤¯ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸€ä¸ªè®©æˆ‘æ¯”è¾ƒå¥½å¥‡çš„åŠŸèƒ½ğŸ¤”ï¼Œé‚£å°±æ˜¯ <strong>AI Agentæ˜¯å¦‚ä½•é€šè¿‡ç”¨æˆ·æä¾›çš„æç¤ºè¯æ¥ç›´æ¥æ“æ§åº”ç”¨çš„å‘¢ï¼Ÿ</strong>
æ¯•ç«Ÿå¯¹äºå¤§å¤šæ•°äººæ¥è¯´ AI è¿˜åœç•™åœ¨èŠå¤©å¯¹è¯çš„é˜¶æ®µï¼Œæ˜¯ä»€ä¹ˆä¸œè¥¿è®© AI çªç„¶æ‹¥æœ‰äº†è‡ªå·±çš„ â€œæ‰‹â€ä¸â€œçœ¼â€ å‘¢ï¼Ÿ</p>
<p>å› æ­¤æˆ‘å°±å»ç¨å¾®äº†è§£äº†ä¸€ä¸‹ä¸è¿™æ–¹é¢æœ‰å…³çš„ä¸€äº›çŸ¥è¯†ï¼Œç»“æœç¢°åˆ°äº† <code>mcpåè®®</code> å’Œ <code>playwright</code>ã€‚</p>
<p>äºæ˜¯æˆ‘æŠ±ç€ä¸€é¢—å­¦å¾’çš„å¿ƒï¼Œæ¥è¯•è¯•åœ¨ç›®å‰å¾ˆç«çš„ AI ç¼–è¯‘å™¨ <strong>Trae</strong> æ¥çœ‹çœ‹ä¼šæ‘©æ“¦å‡ºæ€æ ·çš„ç«èŠ±ğŸ”¥ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯ MCPï¼ˆModel Context Protocolï¼‰ï¼Ÿ</h2>
<h3 data-id="heading-2">å®šä¹‰ï¼š</h3>
<p>MCP åè®®æ˜¯ä¸€ä¸ª<strong>å¼€æ”¾ã€æ ‡å‡†åŒ–çš„é€šä¿¡åè®®</strong>ï¼Œè€Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ï¼š</p>
<blockquote>
<p><strong>è®©å¤§è¯­è¨€æ¨¡å‹èƒ½å¤Ÿå®‰å…¨ã€ç»“æ„åŒ–åœ°è°ƒç”¨å¤–éƒ¨å·¥å…·ã€è®¿é—®ä¸Šä¸‹æ–‡æ•°æ®ï¼Œå¹¶ä¸çœŸå®ä¸–ç•Œäº¤äº’ã€‚</strong></p>
</blockquote>
<p>è¯´ç™½äº†ï¼Œ<strong>MCP æ˜¯ç»™ AI è£…ä¸Šâ€œæ‰‹â€å’Œâ€œçœ¼â€çš„æ¥å£ã€‚</strong></p>
<p>åœ¨ MCP å‡ºç°ä¹‹å‰ï¼ŒAI ç¼–ç¨‹åŠ©æ‰‹å­˜åœ¨ä¸¥é‡å±€é™ï¼š</p>
<ul>
<li><strong>åªèƒ½æ²Ÿé€šï¼Œä¸èƒ½å®æ–½</strong>ï¼šè™½ç„¶ AI å¯ä»¥å¸®åŠ©ç”Ÿæˆä»£ç ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¿è¡Œã€æµ‹è¯•æˆ–éªŒè¯å®ƒæ˜¯å¦çœŸçš„è¾¾åˆ°äº†éœ€è¦çš„æ•ˆæœã€‚</li>
<li><strong>ä¿¡æ¯è·å–æ­¥éª¤å¤æ‚</strong>ï¼šAI å¹¶ä¸çŸ¥é“æˆ‘ä»¬æœ¬åœ°æœ‰å“ªäº›æ–‡ä»¶ã€ä¾èµ–ç­‰ç­‰ï¼Œå¤§å¤šæ•°æ—¶å€™éœ€è¦æ‰‹åŠ¨æ“ä½œæ¥æä¾›ç»™å®ƒã€‚</li>
</ul>
<p>ä½†æ˜¯é€šè¿‡ MCP è¿™ä¸ªâ€œæ¡¥æ¢â€ï¼Œè®© AI ä½œä¸ºå®¢æˆ·ç«¯é€šè¿‡æ ‡å‡†åè®®ï¼Œè¿æ¥ä¸€ä¸ªæˆ–å¤šä¸ª MCP Serverä»è€ŒæŠŠ<strong>å¤–éƒ¨ç¨‹åº</strong>ï¼ˆæ¯”å¦‚ Playwrightã€Shell è„šæœ¬ç­‰ï¼‰æ¥å…¥åˆ° AI ç¼–è¯‘å™¨ä¸­ï¼Œè®© AI èƒ½è°ƒç”¨å®ƒä»¬ã€‚</p>
<p>ä¾‹å¦‚ï¼š<strong>â€œæ¨¡å‹ + å·¥å…·ç”Ÿæ€â€ååŒ</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fb68ab9a3fc4321aa5510b8f5e1cf8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=MgUSrQgDXCybSASpatSkpPrd1Ow%3D" alt="tongyi-mermaid-2025-12-15-184415.png" loading="lazy"/></p>
<p>åœ¨è¿™æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ä»…ä»…åªæ˜¯å‘ AI Agent ä¸‹è¾¾äº†æµ‹è¯•ç™»å½•çš„å‘½ä»¤ï¼Œåœ¨æ­¤ä¹‹åçš„è¿‡ç¨‹éƒ½æ— éœ€äººå·¥å¹²é¢„ï¼ŒAI å¯ä»¥è‡ªä¸»åè°ƒå¤šä¸ªå·¥å…·å®Œæˆé—­ç¯ã€‚</p>
<p><strong>AI å°±åƒå…¬å¸çš„ CEOï¼Œé€šè¿‡ MCP åè®®å‘å¤šä¸ªéƒ¨é—¨ï¼ˆMCP Serverï¼‰ä¸‹è¾¾å‘½ä»¤</strong></p>
<p>å¦‚æœä½ æƒ³å¾—åˆ°æ›´å®˜æ–¹çš„è§£é‡Šï¼Œå¯ä»¥å»å®˜ç½‘<a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fdocs%2Fgetting-started%2Fintro" target="_blank" title="https://modelcontextprotocol.io/docs/getting-started/intro" ref="nofollow noopener noreferrer">What is the Model Context Protocol (MCP)?</a></p>
<h2 data-id="heading-3">äºŒã€ä»€ä¹ˆæ˜¯ Playwrightï¼Ÿ</h2>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.nodejs.cn%2F" target="_blank" title="https://playwright.nodejs.cn/" ref="nofollow noopener noreferrer">Playwright</a></strong> æ˜¯ç”± Microsoft å¼€å‘çš„ <strong>ç°ä»£åŒ–ç«¯åˆ°ç«¯ï¼ˆE2Eï¼‰Web æµ‹è¯•å·¥å…·</strong>ï¼Œç”¨äºè‡ªåŠ¨åŒ– Chromiumã€WebKit å’Œ Firefox æµè§ˆå™¨çš„ Node.js/Python/Java/.NET åº“ã€‚</p>
<p>ä½†æ˜¯ç”±äº <strong>AI + MCP</strong> çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ç²¾é€šè¿™ä¸ªå·¥å…·ï¼ŒæŠŠäº‹æƒ…äº¤ç»™AIï¼Œè®©æˆ‘ä»¬æ›´æ³¨é‡äºåŠŸèƒ½ã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€MCP + Playwright çš„ååŒ</h2>
<p>ä¸‹è¿°ç¤ºä¾‹éƒ½æ˜¯é€šè¿‡ä½¿ç”¨ Trae æ¥å®ç°çš„</p>
<h3 data-id="heading-5">å‰æœŸå·¥ä½œï¼š</h3>
<p>æ‰“å¼€æˆ‘ä»¬çš„ <strong>Trae</strong> ç¼–è¾‘å™¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc0e072cdb764925bb62e240922b2798~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=ha7hnjUKnBlq5zdJx6eelvtYysU%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è®¾ç½®é¡µé¢æ‰¾åˆ° MCP</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3895986df5a41a5849509f98f62dcf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=GGN1nB6TnF3Bi9ZcuSBc1jyNwq0%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹å‡»å³è¾¹çš„ <strong>æ·»åŠ </strong> æŒ‰é’®ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•æ·»åŠ ï¼Œ<strong>ä»å¸‚åœºæ·»åŠ  / æ‰‹åŠ¨æ·»åŠ </strong>ï¼Œè¿™é‡Œæˆ‘ä»¬ç‚¹å‡»ä»å¸‚åœºæ·»åŠ å³å¯</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16ff7bfae4054c328826d0650c8eab7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=x2Si4lUB0IE9Ba%2F7zFKSyezTgOU%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨å¸‚åœºè¿™é‡Œå¯ä»¥æ·»åŠ ä»»ä½•ä½ éœ€è¦çš„ <strong>MCP Server</strong>ï¼Œå¹¶ä¸”å¯ä»¥è¾“å…¥ä½ éœ€è¦é…ç½®çš„ MCP Server ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘ä»¬æ·»åŠ  <code>playwright</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a41ef842a6f47fe87bc4d1559d74f77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=PdZis9IKBSUyh9mnsZGO4ibbAE8%3D" alt="2025-12-15.gif" loading="lazy"/></p>
<p>å®‰è£…å¥½åå›åˆ°ä¸»é¡µé¢ä¸Šï¼Œåœ¨ TRAE æ™ºèƒ½ä½“èŠå¤©æ¡†ä¸­é€‰æ‹© <code>@Builder with MCP</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/117d264a3cc74bc599a9c56ab6c4ba37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=2qYRBHdMhD0IQmHlHE2qvfkGoFI%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>æ³¨ï¼š</p>
<p>ä¸è¦å¿˜è®° playwright åªé€‚é… Chromiumã€WebKit å’Œ Firefoxæµè§ˆå™¨ï¼Œå„ä½åªéœ€æå‰å®‰è£…å¥½å…¶ä¸€å³å¯</p>
</blockquote>
<h3 data-id="heading-6">ç¤ºä¾‹ä¸€ï¼šè®© AI è‡ªåŠ¨è®¿é—®é¡µé¢</h3>
<p>ç»™ AI æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">è¯·å¸®æˆ‘æµ‹è¯•æ˜é‡‘ç½‘ç«™çš„æ’ä»¶é¡µé¢ï¼š
<span class="hljs-bullet">    1.</span> æ‰“å¼€ https://juejin.cn/
<span class="hljs-bullet">    2.</span> ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªæ çš„"æ’ä»¶"æŒ‰é’®
<span class="hljs-bullet">    3.</span> ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ
<span class="hljs-bullet">    4.</span> æˆªå›¾å¹¶ä¿å­˜åˆ°å½“å‰ç›®å½•
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b6fc7eea1524e49a3b03d1463358e6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=25oMtNgfLETI8vJDGE3TG3yyc7o%3D" alt="image.png" loading="lazy"/></p>
<p>æœ€åå®ç°ç»“æœï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22aa8f38bc5c4056a06bca6dc681fe8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=jWzCGeVq1FR433W5ea%2FPeqF3vQU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">ç¤ºä¾‹äºŒï¼šè®© AI è‡ªåŠ¨æµ‹è¯•é¡µé¢</h3>
<p>ç°åœ¨æˆ‘testæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª <code>1.html</code>æ–‡ä»¶ï¼Œç»™ AI æç¤ºè¯è®©å®ƒå¸®æˆ‘æµ‹è¯•é¡µé¢çš„åŸºæœ¬æ•ˆæœã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">è¯·ç¡®è®¤ 1.html æ–‡ä»¶çš„ä»¥ä¸‹èƒ½åŠ›ï¼š
<span class="hljs-bullet">    1.</span> æµ‹è¯•æ˜¯å¦èƒ½æ­£ç¡®é€šè¿‡æ–‡ä»¶è·¯å¾„åŠ è½½æœ¬åœ° HTMLã€‚
<span class="hljs-bullet">    2.</span> æµ‹è¯• fillå’Œclickæ˜¯å¦ç²¾å‡†ã€‚
<span class="hljs-bullet">    3.</span> é€šè¿‡éªŒè¯ç»“æœæ–‡æœ¬ï¼Œç¡®ä¿é¡µé¢é€»è¾‘æ­£å¸¸è¿è¡Œä¸”è¢«æµ‹è¯•å·¥å…·æ­£ç¡®æ•è·ã€‚
<span class="hljs-bullet">    4.</span> é€šè¿‡æˆªå›¾æä¾›æœ€ç»ˆçš„è§†è§‰è¯æ®ã€‚
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a3f6f41c8ff4f859aa2eb8727f97e57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCO6KiA6KW_6KW_6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766405447&amp;x-signature=ke4gSzoD67v0w0GzpjCZF06VT1U%3D" alt="åŠ¨ç”».gif" loading="lazy"/></p>
<h2 data-id="heading-8">å››ã€è¿™ä»£è¡¨æœªæ¥</h2>





















<table><thead><tr><th>ä¼ ç»Ÿå¼€å‘</th><th>AI + MCP + Playwright</th></tr></thead><tbody><tr><td>å†™ä»£ç  â†’ æ‰‹åŠ¨æµ‹è¯• â†’ è°ƒè¯• â†’ ä¿®å¤</td><td>æè¿°éœ€æ±‚ â†’ AI ç”Ÿæˆ + è‡ªåŠ¨æµ‹è¯• + è‡ªåŠ¨ä¿®å¤</td></tr><tr><td>æµ‹è¯•æ˜¯â€œäº‹åâ€è¡Œä¸º</td><td>æµ‹è¯•æ˜¯â€œå†…å»ºâ€èƒ½åŠ›</td></tr><tr><td>äººåšæœºæ¢°æ€§éªŒè¯</td><td>AI åšé—­ç¯éªŒè¯</td></tr></tbody></table>
<blockquote>
<p>è¿™æ­£æ˜¯ <strong>â€œAgentic AIâ€ï¼ˆæ™ºèƒ½ä½“å¼å¼€å‘ï¼‰</strong> çš„æ ¸å¿ƒï¼šAI ä¸å†åªæ˜¯ç”Ÿæˆä»£ç ï¼Œè€Œæ˜¯èƒ½<strong>è‡ªä¸»æ‰§è¡Œã€éªŒè¯ã€è¿­ä»£</strong>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JWorkerâ€”â€”ä¸€å¥—ç®€å•æ˜“ç”¨çš„åŸºäºé¸¿è’™ Worker çš„åŒå‘ RPC é€šè®¯æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7583260493851557929</link>    <guid>https://juejin.cn/post/7583260493851557929</guid>    <pubDate>2025-12-15T00:29:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583260493851557929" data-draft-id="7583260493851263017" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JWorkerâ€”â€”ä¸€å¥—ç®€å•æ˜“ç”¨çš„åŸºäºé¸¿è’™ Worker çš„åŒå‘ RPC é€šè®¯æœºåˆ¶"/> <meta itemprop="keywords" content="HarmonyOS,ArkTS,TypeScript"/> <meta itemprop="datePublished" content="2025-12-15T00:29:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±Ÿæ¾æ¶Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1820446986338504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JWorkerâ€”â€”ä¸€å¥—ç®€å•æ˜“ç”¨çš„åŸºäºé¸¿è’™ Worker çš„åŒå‘ RPC é€šè®¯æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446986338504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±Ÿæ¾æ¶Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T00:29:27.000Z" title="Mon Dec 15 2025 00:29:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é›¶ã€JWorker</h2>
<p><strong>JWorker æ˜¯ä¸€å¥—ç®€å•æ˜“ç”¨çš„åŸºäºé¸¿è’™ Worker çš„åŒå‘ RPC é€šè®¯æœºåˆ¶ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6fda4257dbe4aac9ecae9d1b97bb4b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766363366&amp;x-signature=Qyt8awOG6G6qKBSbJqBTWZ06YV8%3D" alt="structure.png" loading="lazy"/></p>
<p>ä¼ ç»Ÿçš„ Worker é€šè®¯åŸºäºäº‹ä»¶ç›‘å¬å’Œæ¶ˆæ¯ä¼ é€’ï¼Œç¼ºä¹åŸç”Ÿçš„ <code>Promise/async-await</code> æ”¯æŒï¼Œå¯¼è‡´é€»è¾‘å‰²è£‚ã€‚<strong>JWorker é€šè¿‡åŒå‘ RPC æœºåˆ¶ï¼Œè®©ä¸» Worker å¯ä»¥ await å­ Worker çš„æ‰§è¡Œç»“æœï¼Œå­ Worker ä¹Ÿå¯ä»¥ await ä¸» Worker çš„å“åº”ï¼Œå°†è·¨ Worker é€šè®¯ç®€åŒ–ä¸ºåƒè°ƒç”¨æœ¬åœ°å¼‚æ­¥å‡½æ•°ï¼Œæ¶ˆé™¤å›è°ƒåµŒå¥—ï¼Œä¿æŒä»£ç çº¿æ€§æµç•…ã€‚</strong></p>
<h2 data-id="heading-1">ä¸€ã€å®‰è£…</h2>
<p>è¿è¡Œ <code>ohpm install jworker</code> å®‰è£… JWorker åº“</p>
<h2 data-id="heading-2">äºŒã€å¸¸è§„ä½¿ç”¨</h2>
<p>JWorker æ˜¯åŸºäºé¸¿è’™ Worker å°è£…çš„ä¸€å¥— RPC é€šè®¯æœºåˆ¶ï¼Œæ‰€ä»¥åœ¨æ­£å¼ä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆæ·»åŠ å’Œé…ç½® Worker çš„ ets æ–‡ä»¶ã€‚å¯ä»¥æŒ‰ç…§<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-guides%2Fworker-introduction" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/worker-introduction" ref="nofollow noopener noreferrer">é¸¿è’™å®˜æ–¹ Worker</a> çš„ä½¿ç”¨æ–‡æ¡£è¿›è¡Œæ·»åŠ é…ç½®ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<blockquote>
<p>â€œå¸¸è§„ä½¿ç”¨â€ ç¤ºä¾‹å®Œæ•´ä»£ç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FzincPower%2FJWorker%2Ftree%2Fmain%2Fsample%2Fsrc%2Fmain%2Fets%2Fworker%2Fsimple" target="_blank" title="https://github.com/zincPower/JWorker/tree/main/sample/src/main/ets/worker/simple" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
</blockquote>
<h3 data-id="heading-3">1ã€åˆ›å»º JWorker</h3>
<p><strong>ä¸» Worker ä¸­</strong>ä½¿ç”¨ <code>createJWorker(workerPath: string)</code> åˆ›å»º <code>JWorker</code> å®ä¾‹ï¼Œç„¶åè°ƒç”¨ <code>JWorker.start()</code> å¯åŠ¨ <code>JWorker</code> ã€‚ å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<blockquote>
<p><code>JWorker.start()</code> å†…éƒ¨ä¼šå¯åŠ¨ Worker æ–‡ä»¶ï¼Œå¹¶å…³è”æ¶ˆæ¯æ¥æ”¶ã€é€€å‡ºæ¥æ”¶ç­‰å›è°ƒã€‚</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// å°† Worker çš„æ–‡ä»¶è·¯å¾„ä¼ ç»™ createJWorker æ–¹æ³•ï¼Œä¼šè¿”å› JWorker å®ä¾‹</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/simple/SimpleWorker.ets"</span>)
<span class="hljs-comment">// å¯åŠ¨ JWorker</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>.<span class="hljs-title function_">start</span>()
</code></pre>
<p><strong>å­ Worker ä¸­</strong>ä½¿ç”¨ <code>initJWorker()</code> è·å– <code>SubWorker</code> å®ä¾‹ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<blockquote>
<p><code>initJWorker()</code> å†…éƒ¨ä¼šè®© <code>SubWorker</code> å…³è”å­ Worker çš„æ¶ˆæ¯æ¥æ”¶ç­‰å›è°ƒã€‚</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> worker = <span class="hljs-title function_">initJWorker</span>()
</code></pre>
<h3 data-id="heading-4">2ã€åŒå‘ RPC é€šè®¯</h3>
<p><strong>JWorker çš„é€šè®¯æ˜¯åŸºäº Channel</strong> ï¼Œæ‰€ä»¥ä¸»å­ Worker çš„é€šè®¯éœ€è¦å…ˆæ·»åŠ <strong>ç›¸åŒåç§°çš„ Channel</strong>ã€‚</p>
<p><strong>ä¸» Worker</strong> é€šè¿‡ <code>JWorker.addChannel(channelName: string, channel: Channel)</code> æ–¹æ³•è¿›è¡Œæ·»åŠ é€šè®¯ Channel ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åˆ›å»ºé€šè®¯æ¸ é“ MainSimpleChannel ï¼Œéœ€è¦ç»§æ‰¿ Channel </span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainSimpleChannel</span>()
<span class="hljs-comment">// æ·»åŠ æ¸ é“åä¸º â€œSimpleWorkerChannelâ€ çš„é€šè®¯ Channel </span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"SimpleWorkerChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span>)
</code></pre>
<p><strong>å­ Worker</strong> é€šè¿‡ <code>JWorkerChannel(channelName: string, channel: Channel)</code> æ–¹æ³•è¿›è¡Œæ·»åŠ é€šè®¯ Channel ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ·»åŠ æ¸ é“åä¸º â€œSimpleWorkerChannelâ€ çš„é€šè®¯ Channel</span>
<span class="hljs-comment">// åŒæ · SubSimpleChannel ä¹Ÿéœ€è¦ç»§æ‰¿ Channel</span>
<span class="hljs-title class_">JWorkerChannel</span>(<span class="hljs-string">"SimpleWorkerChannel"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubSimpleChannel</span>(worker))
</code></pre>
<p><strong>ä¸» Worker å’Œå­ Worker é€šè¿‡ç›¸åŒçš„æ¸ é“åç§°å»ºç«‹é€šè®¯é€šé“</strong>ï¼Œ<code>MainSimpleChannel</code> å’Œ <code>SubSimpleChannel</code> é€šè®¯è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡ <code>handleMessage(methodName: string, data: any): Promise&lt;any&gt;</code> æ¥æ”¶å¯¹æ–¹çš„è°ƒç”¨æ¶ˆæ¯ï¼Œè¿”å›å€¼ä¼šè¿”å›åˆ°è°ƒç”¨ç‚¹ï¼›</li>
<li>é€šè¿‡ <code>send(methodName: string, data?: any, transfer?: ArrayBuffer[]) =&gt; Promise&lt;any&gt;</code> å¯ä»¥ä¸»åŠ¨è°ƒç”¨å¯¹æ–¹æ–¹æ³•å¹¶æºå¸¦å‚æ•°ï¼Œå¯¹æ–¹å¤„ç†å®Œçš„è¿”å›å€¼ä¼šä»¥ <code>Promise&lt;any&gt;</code> ç±»å‹è¿”å›åˆ°è°ƒç”¨ç‚¹ã€‚</li>
</ul>
<p><strong>ä¸» Worker è°ƒç”¨å­ Worker çš„é€»è¾‘</strong>ï¼Œé€šè¿‡æ³¨å†Œçš„ <code>simpleWorkerChannel</code> è°ƒç”¨ <code>send</code> æ–¹æ³•å‘é€å³å¯ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ============== ä¸» Worker ä¸­è¿›è¡Œå‘é€ ==============</span>
<span class="hljs-keyword">const</span> user = {
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"jiangpengyong"</span>,
  <span class="hljs-string">"year"</span>: <span class="hljs-number">1994</span>,
  <span class="hljs-string">"height"</span>: <span class="hljs-number">170.0</span>,
  <span class="hljs-string">"address"</span>: {
    <span class="hljs-string">"country"</span>: <span class="hljs-string">"China"</span>,
    <span class="hljs-string">"province"</span>: <span class="hljs-string">"GuangDong"</span>,
    <span class="hljs-string">"city"</span>: <span class="hljs-string">"Guangzhou"</span>,
  },
} <span class="hljs-keyword">as</span> <span class="hljs-title class_">User</span>
<span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè°ƒç”¨æ–¹æ³•åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè°ƒç”¨æ–¹æ³•çš„å‚æ•°</span>
<span class="hljs-comment">// response ä¸ºå­ Worker å¤„ç†çš„ç»“æœ</span>
<span class="hljs-keyword">const</span> response = (<span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span>?.<span class="hljs-title function_">send</span>(<span class="hljs-string">"sayHello"</span>, user)) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Any</span>
<span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€å‘é€æœ‰å¤„ç†çš„æ¶ˆæ¯ã€‘å­ Worker å›å¤ response=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>)

<span class="hljs-comment">// ============== å­ Worker ä¸­è¿›è¡Œæ¥æ”¶å¤„ç† ==============</span>
<span class="hljs-comment">// é€šè¿‡ SubSimpleChannel æ¥æ”¶è°ƒç”¨æ–¹æ³•åç§°å’Œå‚æ•°ï¼Œå¤„ç†åè¿”å›ç»“æœ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSimpleChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-comment">// å¤„ç†ä¸» Worker è°ƒç”¨çš„ â€œsayHelloâ€ æ–¹æ³•ï¼Œå°† data è½¬ä¸º User ç±»å‹å¹¶è·å–å¯¹åº”æ•°æ®ï¼Œè¿”å›ä¸€ä¸ª string ç»“æœ</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">"sayHello"</span>: {
        <span class="hljs-keyword">const</span> user = data <span class="hljs-keyword">as</span> <span class="hljs-title class_">User</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, <span class="hljs-subst">${user.name}</span>. I'm replying to you from the sub-worker.`</span>
      }
      <span class="hljs-comment">// çœç•¥å…¶ä»–æ–¹æ³•</span>
    }
  }
}

<span class="hljs-comment">// ============== æœ€ç»ˆä¼šåœ¨ Log ä¸­çœ‹åˆ°ä»¥ä¸‹è¾“å‡º ==============</span>
<span class="hljs-comment">// ã€å‘é€æœ‰å¤„ç†çš„æ¶ˆæ¯ã€‘å­ Worker å›å¤ response="Hello, jiangpengyong. I'm replying to you from the sub-worker."</span>
</code></pre>
<p><strong>å­ Worker è°ƒç”¨ä¸» Worker çš„é€»è¾‘</strong>ï¼Œä¹Ÿæ˜¯åŒæ ·çš„æµç¨‹ï¼Œé€šè¿‡æ³¨å†Œçš„ <code>SubSimpleChannel</code> è°ƒç”¨ <code>send</code> æ–¹æ³•å‘é€å³å¯ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ============== å­ Worker è°ƒç”¨ä¸» Worker çš„é€»è¾‘ ==============</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSimpleChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"getUserDes"</span>: {
        <span class="hljs-comment">// è°ƒç”¨ä¸» Worker çš„ â€œgetUserInfoâ€ æ–¹æ³•ï¼Œæ­¤å¤„æ²¡æœ‰æºå¸¦å‚æ•°ï¼Œä¼šè¿”å› User ç±»å‹</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">send</span>(<span class="hljs-string">"getUserInfo"</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">User</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">`name: <span class="hljs-subst">${user.name}</span>, height: <span class="hljs-subst">${user.height}</span>`</span>
      }
      <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>
    }
  }
}

<span class="hljs-comment">// ============== ä¸» Worker å¤„ç†é€»è¾‘ ==============</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainSimpleChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-comment">// æ¥æ”¶åˆ°å­ Worker çš„è¯·æ±‚å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åè¿”å›æ•°æ®</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">"getUserInfo"</span>: {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-string">"name"</span>: <span class="hljs-string">"æ±Ÿæ¾æ¶Œ"</span>,
          <span class="hljs-string">"year"</span>: <span class="hljs-number">1994</span>,
          <span class="hljs-string">"height"</span>: <span class="hljs-number">170.0</span>,
          <span class="hljs-string">"address"</span>: {
            <span class="hljs-string">"country"</span>: <span class="hljs-string">"ä¸­å›½"</span>,
            <span class="hljs-string">"province"</span>: <span class="hljs-string">"å¹¿ä¸œ"</span>,
            <span class="hljs-string">"city"</span>: <span class="hljs-string">"æ™®å®"</span>,
          },
        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">User</span>
      }
    }
  }
}
</code></pre>
<blockquote>
<p>Channel ä¸­åŒ…å«äº† <code>send(methodName: string, data?: any, transfer?: ArrayBuffer[]) =&gt; Promise&lt;any&gt;</code> æ–¹æ³•ï¼Œå¯ä»¥åœ¨ â€œ Channel å†…éƒ¨ä¸»åŠ¨è°ƒç”¨â€ æˆ–æ˜¯ â€œå¤–éƒ¨ä»£ç é€šè¿‡ Channel å®ä¾‹ä¸»åŠ¨è°ƒç”¨â€ï¼Œ<code>await</code> æ•°æ®è¿”å›å³å¯ã€‚</p>
</blockquote>
<h3 data-id="heading-5">3ã€ä¼ é€’ ArrayBuffer æ•°æ®</h3>
<p>Worker åœ¨ä¼ é€’ ArrayBuffer æ—¶ï¼Œä¸ºäº†ä¸æ‹·è´ ArrayBuffer æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘å°† ArrayBuffer ä½¿ç”¨æƒç§»äº¤ç»™å¯¹æ–¹ï¼ŒJWorker ä¹ŸåŒæ ·æä¾›è¿™ä¸€èƒ½åŠ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aff8632ddf2f4a149f4f8424f42dcaf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766363366&amp;x-signature=%2Fyu2vdb5l5doeJvIPBjnqr4DdW0%3D" alt="transfer_data.png" loading="lazy"/></p>
<p>ä¸Šå›¾åˆ™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç§»äº¤ ArrayBuffer ä½¿ç”¨æƒçš„å…¨æµç¨‹</p>
<p><strong>è°ƒç”¨ç‚¹ä¼ é€’ ArrayBuffer ç±»å‹æ•°æ®</strong></p>
<p>æ— è®ºæ˜¯ â€œä¸» Worker ä¸»åŠ¨è°ƒç”¨å­ Worker æ–¹æ³•â€ï¼Œè¿˜æ˜¯ â€œå­ Worker ä¸»åŠ¨è°ƒç”¨ä¸» Worker æ–¹æ³•â€ï¼Œéƒ½æ˜¯ä½¿ç”¨ Channel çš„ <code>send</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">send</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, data?: <span class="hljs-built_in">any</span>, transfer?: <span class="hljs-title class_">ArrayBuffer</span>[]) =&gt; <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;
</code></pre>
<p><code>send</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•° <code>transfer</code> æŒæœ‰ç¬¬äºŒä¸ªå‚æ•° <code>data</code> ä¸­éœ€è¦ç§»äº¤ä½¿ç”¨æƒçš„ ArrayBuffer å¯¹è±¡ï¼ŒJWorker ä¼šè´Ÿè´£ç§»äº¤ä½¿ç”¨æƒã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ============== å‘é€æ–¹ä»£ç ï¼ˆæ­¤å¤„ä¸ºä¸» Worker ï¼‰ ==============</span>
<span class="hljs-keyword">const</span> uint8Array = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getContext</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">"image1.jpeg"</span>)
<span class="hljs-keyword">const</span> arrayBuffer = uint8Array.<span class="hljs-property">buffer</span>
<span class="hljs-comment">// æ­¤å¤„å°† arrayBuffer ä½¿ç”¨æƒç§»äº¤ç»™å­ Worker ï¼Œæ‰€ä»¥å°† arrayBuffer æ”¾ç½®åˆ°äº†ç¬¬ä¸‰ä¸ªå‚æ•°</span>
<span class="hljs-comment">// å€¼å¾—æ³¨æ„ï¼Œç§»äº¤åçš„ arrayBuffer ï¼Œä¸» Worker ä¸å¯å†ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span>.<span class="hljs-title function_">send</span>(<span class="hljs-string">"cropImage"</span>, arrayBuffer, [arrayBuffer]) <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>

<span class="hljs-comment">// ============== æ¥æ”¶æ–¹ä»£ç ï¼ˆæ­¤å¤„ä¸ºå­ Worker ï¼‰ ==============</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSimpleChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"cropImage"</span>: {
        <span class="hljs-comment">// æ¥æ”¶ ArrayBuffer çš„ä»£ç æ²¡æœ‰ç‰¹åˆ«çš„è¦æ±‚ï¼Œå’Œæ¥æ”¶æ™®é€šç±»å‹çš„é€»è¾‘ä¸€æ ·ï¼Œåªéœ€è¦è½¬ä¸ºå¯¹åº”çš„ç±»å‹è¿›è¡Œå¤„ç†å³å¯</span>
        <span class="hljs-keyword">const</span> arrayBuffer = data <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span>
        <span class="hljs-keyword">const</span> cropPixelMap = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cropImage</span>(arrayBuffer)
        <span class="hljs-keyword">const</span> cropArrayBuffer = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PixelMapConverter</span>.<span class="hljs-title function_">pixelMapToArrayBuffer</span>(cropPixelMap)
        <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>
      }
    }
  }
}
</code></pre>
<p><strong>è¿”å›å€¼ä¼ é€’ ArrayBuffer ç±»å‹æ•°æ®</strong></p>
<p>åœ¨å¤„ç†å®Œé€»è¾‘åï¼Œè¿”å›æ•°æ®ç»™è°ƒç”¨æ–¹ï¼Œæ­¤æ—¶å­˜åœ¨è¿”å›æ•°æ®æºå¸¦ ArrayBuffer ç±»å‹æ•°æ®çš„åœºæ™¯ã€‚ä¸ºæ­¤ JWorker æä¾›äº† <code>TransferData</code> ç±»å‹ï¼Œæ”¯æŒè¯¥åœºæ™¯çš„æ•°æ®ä¼ é€’ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ============== ç»§ç»­ä¸Šé¢çš„ä»£ç  ==============</span>
<span class="hljs-comment">// ============== æ¥æ”¶æ–¹ä»£ç ï¼ˆæ­¤å¤„ä¸ºå­ Worker ï¼‰ ==============</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSimpleChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">methodName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"cropImage"</span>: {
        <span class="hljs-comment">// çœç•¥é‡å¤ä»£ç </span>
        <span class="hljs-comment">// è¿”å›å€¼å¦‚æœéœ€è¦ç§»äº¤ ArrayBuffer ä½¿ç”¨æƒï¼Œåˆ™ä½¿ç”¨ TransferData ç±»è¿›è¡ŒåŒ…è£¹</span>
        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¿”å›æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºéœ€è¦ç§»äº¤ä½¿ç”¨æƒçš„ ArrayBuffer åˆ—è¡¨</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransferData</span>(cropArrayBuffer, [cropArrayBuffer])
      }
    }
  }
}

<span class="hljs-comment">// ============== å‘é€æ–¹ä»£ç ï¼ˆæ­¤å¤„ä¸ºä¸» Worker ï¼‰ ==============</span>
<span class="hljs-comment">// è°ƒç”¨ç‚¹æ¥æ”¶åˆ°çš„æ•°æ®ç±»å‹æ˜¯å·²ç»å»æ‰ TransferData åŒ…è£¹çš„çœŸå®æ•°æ®</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span>.<span class="hljs-title function_">send</span>(<span class="hljs-string">"cropImage"</span>, arrayBuffer, [arrayBuffer]) <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>
<span class="hljs-keyword">if</span> (response) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cropPixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PixelMapConverter</span>.<span class="hljs-title function_">arrayBufferToPixelMap</span>(response)
}
</code></pre>
<h3 data-id="heading-6">4ã€å…³é—­ JWorker</h3>
<p>åœ¨ JWorker ä¸­æä¾›äº†ä¸¤ç§å…³é—­ Worker çš„æ–¹å¼ï¼Œåˆ†åˆ«ä¸º <strong>ä¸» Worker è¿›è¡Œå…³é—­</strong> å’Œ <strong>å­ Worker è¿›è¡Œå…³é—­</strong> ã€‚<strong>æ¨èä½¿ç”¨å­ Worker è¿›è¡Œå…³é—­</strong>ï¼Œå› ä¸ºé¡¹ç›®å¯ä»¥æ›´å¥½æ§åˆ¶å­ Worker çš„ç”Ÿå‘½å‘¨æœŸå’Œé‡Šæ”¾ç›¸åº”èµ„æºã€‚</p>
<p><strong>ä¸» Worker è¿›è¡Œå…³é—­</strong></p>
<p>é€šè¿‡è°ƒç”¨ <code>JWorker</code> å®ä¾‹çš„ <code>release()</code> æ–¹æ³•è¿›è¡Œé‡Šæ”¾ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åˆ›å»º JWorker å¯¹è±¡</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/simple/SimpleWorker.ets"</span>)
<span class="hljs-comment">// è¿›è¡Œå¼€å¯ JWorker ã€æ·»åŠ  Channel ç­‰æ“ä½œ</span>

<span class="hljs-comment">// å…³é—­ JWorker</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>?.<span class="hljs-title function_">release</span>()
</code></pre>
<p><strong>å­ Worker è¿›è¡Œå…³é—­</strong></p>
<p>é€šè¿‡è°ƒç”¨ <code>SubWorker</code> å¯¹è±¡çš„ <code>release()</code> æ–¹æ³•è¿›è¡Œé‡Šæ”¾ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åœ¨å­ Worker ä¸­æ„å»º subWorker</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-title function_">initJWorker</span>()
<span class="hljs-comment">// æ·»åŠ éœ€è¦çš„ Channel æ“ä½œ</span>

<span class="hljs-comment">// åœ¨éœ€è¦é‡Šæ”¾çš„æ—¶å€™è°ƒç”¨</span>
<span class="hljs-comment">// 1ã€å¯ä»¥å°† worker ä¼ é€’ç»™ Channel ï¼ŒChannel å†…éƒ¨å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè°ƒç”¨é‡Šæ”¾</span>
<span class="hljs-comment">// 2ã€å¯ä»¥å…¨å±€æŒæœ‰ï¼Œåœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œé‡Šæ”¾</span>
worker.<span class="hljs-title function_">release</span>()
</code></pre>
<h3 data-id="heading-7">5ã€å€¼å¾—æ³¨æ„</h3>
<p>å¦‚æœ <code>JWorker</code> å¯¹è±¡æœªå¼€å¯ï¼ˆå³æœªè°ƒç”¨ <code>JWorker.start()</code> æ–¹æ³•æˆ–å·²å…³é—­ï¼‰ï¼Œæ­¤æ—¶ä½¿ç”¨æ·»åŠ åœ¨è¯¥ JWorker çš„ Channel è¿›è¡Œå‘é€æ¶ˆæ¯ä¼šç«‹é©¬å¾—åˆ°ä¸€ä¸ª <code>undefined</code> æ•°æ®ã€‚</p>
<p>å¦‚æœé€šè¿‡ <code>JWorker</code> çš„ Channel å‘é€äº†æ¶ˆæ¯ï¼Œåœ¨æœªå¾—åˆ°å›å¤å‰å¯¹è¯¥ <code>JWorker</code> è¿›è¡Œå…³é—­ï¼Œåˆ™ä¼šè®©è°ƒç”¨ç‚¹ç«‹é©¬å¾—åˆ°ä¸€ä¸ª <code>undefined</code> æ•°æ®ã€‚</p>
<p><strong>æ‰€ä»¥ä¸ºäº†ç¨‹åºçš„å¥å£®ï¼Œè°ƒç”¨ç‚¹çš„ç±»å‹è½¬æ¢æœ€å¥½å¢åŠ å¯¹ <code>undefined</code> çš„åˆ¤æ–­ã€‚</strong></p>
<h2 data-id="heading-8">ä¸‰ã€å¤šä¸ª Worker</h2>
<h3 data-id="heading-9">1ã€é¡¹ç›®ä¸» Worker å¼€å¤šä¸ªå­ Worker</h3>
<p><code>JWorker</code> é¡¹ç›®æ”¯æŒå¼€å¯å¤šä¸ª Worker ï¼Œä½¿ç”¨ <code>createJWorker(workerPath: string)</code> æ–¹æ³•ä¼ å…¥ä¸åŒçš„è·¯å¾„ï¼Œç®¡ç†å¥½è¿”å› <code>JWorker</code> å¯¹è±¡å³å¯ã€‚</p>
<blockquote>
<p>â€œé¡¹ç›®ä¸» Worker å¼€å¤šä¸ªå­ Workerâ€ ç¤ºä¾‹å®Œæ•´ä»£ç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FzincPower%2FJWorker%2Ftree%2Fmain%2Fsample%2Fsrc%2Fmain%2Fets%2Fworker%2Fmainmultiworker" target="_blank" title="https://github.com/zincPower/JWorker/tree/main/sample/src/main/ets/worker/mainmultiworker" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85be0b25cb7b4c16989ea08b3dfa2509~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766363366&amp;x-signature=F0Jnyg6FHA6jqIfXeHuoKfyNGXI%3D" alt="main_multi_worker.png" loading="lazy"/></p>
<p>å‡è®¾é¡¹ç›®éœ€è¦æ„å»ºä¸Šå›¾çš„ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç åˆ›å»º <code>JWorker</code> å®ä¾‹ã€‚</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨ä¸åŒçš„ Worker ets æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª Worker ets æ–‡ä»¶å¯ä»¥å¼€å¯å¤šä¸ª <code>JWorker</code> å®ä¾‹ã€‚</li>
<li>é€šè¿‡ç®¡ç†å¥½ <code>JWorker</code> å®ä¾‹ï¼Œæ·»åŠ æ¸ é“åè¿›è¡Œå„è‡ª Worker é€šè®¯ã€‚</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// worker0 å’Œ worker1ã€worker2 ä½¿ç”¨ä¸åŒçš„ Worker ets æ–‡ä»¶è¿›è¡Œå¼€å¯ä¸åŒçš„ JWorker å®ä¾‹</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker0</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/simple/SimpleWorker.ets"</span>)
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker0</span>.<span class="hljs-title function_">start</span>()
<span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainSimpleChannel</span>()
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker0</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"SimpleWorkerChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleWorkerChannel</span>)

<span class="hljs-comment">// worker1 å’Œ worker2 ä½¿ç”¨ç›¸åŒçš„ Worker ets æ–‡ä»¶è¿›è¡Œå¼€å¯ä¸åŒçš„ JWorker å®ä¾‹ </span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker1</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/mainmultiworker/MainMultiWorker.ets"</span>)
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker1Channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainMultiChannel</span>()
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker1</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"multiChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker1Channel</span>)
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker1</span>.<span class="hljs-title function_">start</span>()

<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker2</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/mainmultiworker/MainMultiWorker.ets"</span>)
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker2Channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainMultiChannel</span>()
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker2</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"multiChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker2Channel</span>)
<span class="hljs-variable language_">this</span>.<span class="hljs-property">worker2</span>.<span class="hljs-title function_">start</span>()
</code></pre>
<h3 data-id="heading-10">2ã€å­ Worker å¼€å¤šä¸ªå­ Worker</h3>
<p><code>JWorker</code> åŒæ ·æ”¯æŒåœ¨å­ Worker ä¸­å¼€å¯å¤šä¸ª <code>JWorker</code> ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹å›¾æ‰€ç¤ºçš„åˆ›å»ºå’Œç®¡ç†ã€‚</p>
<blockquote>
<p>â€œå­ Worker å¼€å¤šä¸ªå­ Workerâ€ ç¤ºä¾‹å®Œæ•´ä»£ç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FzincPower%2FJWorker%2Ftree%2Fmain%2Fsample%2Fsrc%2Fmain%2Fets%2Fworker%2Fsubmultiworker" target="_blank" title="https://github.com/zincPower/JWorker/tree/main/sample/src/main/ets/worker/submultiworker" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ad99bd5488f42b38fe7133536e5fa0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766363366&amp;x-signature=Y4omM%2BPnwoOrW9nj4ZB7yfIFuWI%3D" alt="sub_multi_worker.png" loading="lazy"/></p>
<p>å¯ä»¥åœ¨å­ Worker éœ€è¦åˆ›å»ºå­ Worker çš„åœ°æ–¹è°ƒç”¨ <code>createJWorker</code> æ–¹æ³•åˆ›å»º <code>JWorker</code> ï¼Œç„¶åè¿›è¡Œå¯åŠ¨å’Œæ·»åŠ ç›¸åº” Channel è¿›è¡Œé€šè®¯ã€‚<strong>ä½¿ç”¨æ–¹å¼å’Œä¹‹å‰çš„å®Œå…¨ç›¸åŒã€‚</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentSubChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">worker: SubWorker</span>) {
    <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startChildrenWorker</span>()
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">startChildrenWorker</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åˆ›å»ºä¸‰ä¸ª JWorker å¹¶å¼€å¯ï¼Œæ·»åŠ å¯¹åº” Channel </span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1</span> == <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/submultiworker/ChildWorker.ets"</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1Channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChildMainChannel</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"childChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1Channel</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1</span>.<span class="hljs-title function_">start</span>()
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2</span> == <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/submultiworker/ChildWorker.ets"</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2Channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChildMainChannel</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"childChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2Channel</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2</span>.<span class="hljs-title function_">start</span>()
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3</span> == <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3</span> = <span class="hljs-title function_">createJWorker</span>(<span class="hljs-string">"sample/ets/worker/submultiworker/ChildWorker.ets"</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3Channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChildMainChannel</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3</span>.<span class="hljs-title function_">addChannel</span>(<span class="hljs-string">"childChannel"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3Channel</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3</span>.<span class="hljs-title function_">start</span>()
    }
  }
}
</code></pre>
<p><strong>å€¼å¾—æ³¨æ„</strong></p>
<p>è¿™ç§æƒ…å†µä¸‹éœ€è¦æ§åˆ¶å¥½ Worker çš„å…³é—­é¡ºåºï¼Œåº”è¯¥è®©é¡¹ç›®çš„ä¸» Worker é€šçŸ¥å­ Worker è¿›è¡Œå…³é—­ä»–åˆ›å»ºçš„å­ Worker ï¼Œç„¶ååœ¨å…³é—­è‡ªèº«ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// é¡¹ç›®ä¸» Worker è°ƒç”¨å­ Worker çš„ exit æ–¹æ³•</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">workerChannel</span>?.<span class="hljs-title function_">send</span>(<span class="hljs-string">"exit"</span>)

<span class="hljs-comment">// å­ Worker æ¥æ”¶åˆ°ä¸» Worker çš„ â€œexitâ€ è°ƒç”¨ï¼Œåˆ™è°ƒç”¨å­ Worker åˆ›å»ºçš„å­ Worker çš„ â€œexitâ€ æ–¹æ³•è¿›è¡Œé€€å‡ºï¼Œå¹¶ç­‰å¾…æ‰€æœ‰çš„å­ Worker å¤„ç†å®Œå†é€€å‡ºè‡ªèº«</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentSubChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-params">methodName: <span class="hljs-built_in">string</span>, data: Any</span>) {
    <span class="hljs-keyword">switch</span> (methodName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"exit"</span>: {
        <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰å­ Worker é€€å‡ºå®Œæˆ</span>
        <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1Channel</span>?.<span class="hljs-title function_">send</span>(<span class="hljs-string">"exit"</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2Channel</span>?.<span class="hljs-title function_">send</span>(<span class="hljs-string">"exit"</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3Channel</span>?.<span class="hljs-title function_">send</span>(<span class="hljs-string">"exit"</span>)])
        <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">"ã€exitã€‘"</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>?.<span class="hljs-title function_">release</span>()
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker1Channel</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker2Channel</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">childWorker3Channel</span> = <span class="hljs-literal">undefined</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
      }
      <span class="hljs-attr">default</span>: {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
      }
    }
  }
}

<span class="hljs-comment">// å­ Worker çš„å­ Worker æ¥æ”¶åˆ° â€œexitâ€ çš„è°ƒç”¨ï¼Œé€€å‡ºè‡ªèº«</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChildSubChannel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Channel</span> {
  <span class="hljs-comment">// çœç•¥å…¶ä»–é€»è¾‘</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-params">methodName: <span class="hljs-built_in">string</span>, data: Any</span>) {
    <span class="hljs-keyword">if</span> (methodName == <span class="hljs-string">"exit"</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>.<span class="hljs-title function_">release</span>()
      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
  }
}
</code></pre>
<h2 data-id="heading-11">å››ã€ä½œè€…åšå®¢</h2>
<p>æ˜é‡‘ï¼š<a href="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts" target="_blank" title="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts">juejin.im/user/5c3033â€¦</a></p>
<p>csdnï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_37625173" target="_blank" title="https://blog.csdn.net/weixin_37625173" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_3762â€¦</a></p>
<p>å…¬ä¼—å·ï¼šå¾®ä¿¡æœç´¢ "æ±Ÿæ¾æ¶Œ"</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript æ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ•°æ®ç»“æ„å’Œç®—æ³•]]></title>    <link>https://juejin.cn/post/7583727768543412260</link>    <guid>https://juejin.cn/post/7583727768543412260</guid>    <pubDate>2025-12-15T08:22:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583727768543412260" data-draft-id="7583591656178024484" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript æ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ•°æ®ç»“æ„å’Œç®—æ³•"/> <meta itemprop="keywords" content="å‰ç«¯,ç®—æ³•,æ•°æ®ç»“æ„"/> <meta itemprop="datePublished" content="2025-12-15T08:22:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript æ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ•°æ®ç»“æ„å’Œç®—æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T08:22:34.000Z" title="Mon Dec 15 2025 08:22:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨JavaScriptå¼€å‘ä¸­, æ­£ç¡®çš„æ•°æ®ç»“æ„å’Œç®—æ³•é€‰æ‹©å¯¹åº”ç”¨æ€§èƒ½æœ‰ç€å†³å®šæ€§çš„å½±å“ã€‚éšç€Webåº”ç”¨æ—¥ç›Šå¤æ‚, å¤„ç†çš„æ•°æ®é‡ä¸æ–­å¢é•¿, ä¼˜åŒ–ä»£ç æ€§èƒ½å˜å¾—è‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨JavaScriptä¸­å…³é”®æ•°æ®ç»“æ„å’Œç®—æ³•çš„å®ç°ã€ä¼˜åŒ–ç­–ç•¥ä»¥åŠå…¶åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€JavaScriptä¸­æ•°æ®ç»“æ„çš„é€‰æ‹©ç­–ç•¥</h4>
<h5 data-id="heading-2">1.1 æ•°ç»„ä¸å¯¹è±¡çš„é€‰æ‹©</h5>
<p>åœ¨JavaScriptä¸­, æ•°ç»„å’Œå¯¹è±¡æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„, ä½†å®ƒä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹çš„æ€§èƒ½ç‰¹å¾å·®å¼‚æ˜¾è‘—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ•°ç»„å’Œå¯¹è±¡æ€§èƒ½å¯¹æ¯”ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataStructureSelector</span> {
  <span class="hljs-comment">// æ•°ç»„: é€‚åˆé¡ºåºè®¿é—®å’Œç´¢å¼•è®¿é—®</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">arrayPerformanceTest</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> arr = [];
    <span class="hljs-keyword">const</span> size = <span class="hljs-number">1000000</span>;

    <span class="hljs-comment">// æµ‹è¯•æ’å…¥æ€§èƒ½</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"æ•°ç»„æ’å…¥"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {
      arr.<span class="hljs-title function_">push</span>(i);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"æ•°ç»„æ’å…¥"</span>);

    <span class="hljs-comment">// æµ‹è¯•éšæœºè®¿é—®æ€§èƒ½</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"æ•°ç»„éšæœºè®¿é—®"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
      <span class="hljs-keyword">const</span> index = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * size);
      <span class="hljs-keyword">const</span> _ = arr[index];
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"æ•°ç»„éšæœºè®¿é—®"</span>);
  }

  <span class="hljs-comment">// å¯¹è±¡: é€‚åˆé”®å€¼å¯¹æŸ¥æ‰¾</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">objectPerformanceTest</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> obj = {};
    <span class="hljs-keyword">const</span> size = <span class="hljs-number">1000000</span>;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"å¯¹è±¡æ’å…¥"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {
      obj[<span class="hljs-string">`key<span class="hljs-subst">${i}</span>`</span>] = i;
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"å¯¹è±¡æ’å…¥"</span>);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"å¯¹è±¡æŸ¥æ‰¾"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`key<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * size)}</span>`</span>;
      <span class="hljs-keyword">const</span> _ = obj[key];
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"å¯¹è±¡æŸ¥æ‰¾"</span>);
  }
}

<span class="hljs-comment">// æ€§èƒ½æµ‹è¯•</span>
<span class="hljs-title class_">DataStructureSelector</span>.<span class="hljs-title function_">arrayPerformanceTest</span>();
<span class="hljs-title class_">DataStructureSelector</span>.<span class="hljs-title function_">objectPerformanceTest</span>();
<span class="hljs-comment">// æ•°ç»„æ’å…¥: 24.589ms</span>
<span class="hljs-comment">// æ•°ç»„éšæœºè®¿é—®: 0.172ms</span>
<span class="hljs-comment">// å¯¹è±¡æ’å…¥: 933.765ms</span>
<span class="hljs-comment">// å¯¹è±¡æŸ¥æ‰¾: 0.512ms</span>
</code></pre>
<h5 data-id="heading-3">1.2 Mapä¸Setçš„ä¼˜åŠ¿</h5>
<p>ES6å¼•å…¥çš„Mapå’ŒSetæä¾›äº†æ›´ä¸“ä¸šçš„é”®å€¼å¯¹å’Œé›†åˆæ“ä½œã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MapSetPerformance</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">compareMapVsObject</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> size = <span class="hljs-number">1000000</span>;

    <span class="hljs-comment">// Objectæµ‹è¯•</span>
    <span class="hljs-keyword">const</span> obj = {};
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"Objectè®¾ç½®"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {
      obj[i] = <span class="hljs-string">`value<span class="hljs-subst">${i}</span>`</span>;
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"Objectè®¾ç½®"</span>);

    <span class="hljs-comment">// Mapæµ‹è¯•</span>
    <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"Mapè®¾ç½®"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {
      map.<span class="hljs-title function_">set</span>(i, <span class="hljs-string">`value<span class="hljs-subst">${i}</span>`</span>);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"Mapè®¾ç½®"</span>);

    <span class="hljs-comment">// æŸ¥æ‰¾æ€§èƒ½æ¯”è¾ƒ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"ObjectæŸ¥æ‰¾"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
      <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * size);
      <span class="hljs-keyword">const</span> _ = obj[key];
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"ObjectæŸ¥æ‰¾"</span>);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"MapæŸ¥æ‰¾"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
      <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * size);
      <span class="hljs-keyword">const</span> _ = map.<span class="hljs-title function_">get</span>(key);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"MapæŸ¥æ‰¾"</span>);
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">setOperations</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> setA = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
    <span class="hljs-keyword">const</span> setB = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]);

    <span class="hljs-comment">// å¹¶é›†</span>
    <span class="hljs-keyword">const</span> union = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA, ...setB]);

    <span class="hljs-comment">// äº¤é›†</span>
    <span class="hljs-keyword">const</span> intersection = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA].<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> setB.<span class="hljs-title function_">has</span>(x)));

    <span class="hljs-comment">// å·®é›†</span>
    <span class="hljs-keyword">const</span> difference = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA].<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> !setB.<span class="hljs-title function_">has</span>(x)));

    <span class="hljs-keyword">return</span> { union, intersection, difference };
  }
}

<span class="hljs-title class_">MapSetPerformance</span>.<span class="hljs-title function_">compareMapVsObject</span>();
<span class="hljs-title class_">MapSetPerformance</span>.<span class="hljs-title function_">setOperations</span>();
<span class="hljs-comment">// Objectè®¾ç½®: 192.252ms</span>
<span class="hljs-comment">// Mapè®¾ç½®: 329.439ms</span>
<span class="hljs-comment">// ObjectæŸ¥æ‰¾: 1.574ms</span>
<span class="hljs-comment">// MapæŸ¥æ‰¾: 2.983ms</span>
</code></pre>
<h4 data-id="heading-4">äºŒã€é“¾è¡¨åŠå…¶å˜ä½“å®ç°</h4>
<h5 data-id="heading-5">2.1 å•å‘é“¾è¡¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ListNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value, next = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">next</span> = next;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkedList</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹åˆ°æœ«å°¾</span>
  <span class="hljs-title function_">append</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(value);

    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = newNode;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">next</span> = newNode;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹åˆ°å¼€å¤´</span>
  <span class="hljs-title function_">prepend</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(value, <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = newNode;

    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span>
  <span class="hljs-title function_">delete</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">let</span> deletedNode = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// å¦‚æœå¤´èŠ‚ç‚¹å°±æ˜¯è¦åˆ é™¤çš„èŠ‚ç‚¹</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">value</span> === value) {
      deletedNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>--;
    }

    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;

    <span class="hljs-comment">// éå†åˆ é™¤åŒ¹é…çš„èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (currentNode !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">while</span> (currentNode.<span class="hljs-property">next</span>) {
        <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">next</span>.<span class="hljs-property">value</span> === value) {
          deletedNode = currentNode.<span class="hljs-property">next</span>;
          currentNode.<span class="hljs-property">next</span> = currentNode.<span class="hljs-property">next</span>.<span class="hljs-property">next</span>;
        } <span class="hljs-keyword">else</span> {
          currentNode = currentNode.<span class="hljs-property">next</span>;
        }
      }
    }

    <span class="hljs-comment">// æ›´æ–°å°¾èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">value</span> === value) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = currentNode;
    }

    <span class="hljs-keyword">return</span> deletedNode;
  }

  <span class="hljs-comment">// æŸ¥æ‰¾èŠ‚ç‚¹</span>
  <span class="hljs-title function_">find</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;

    <span class="hljs-keyword">while</span> (currentNode) {
      <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">value</span> === value) {
        <span class="hljs-keyword">return</span> currentNode;
      }

      currentNode = currentNode.<span class="hljs-property">next</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// åè½¬é“¾è¡¨</span>
  <span class="hljs-title function_">reverse</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
    <span class="hljs-keyword">let</span> prevNode = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> nextNode = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">while</span> (currentNode) {
      nextNode = currentNode.<span class="hljs-property">next</span>;
      currentNode.<span class="hljs-property">next</span> = prevNode;

      prevNode = currentNode;
      currentNode = nextNode;
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = prevNode;

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// è½¬æ¢ä¸ºæ•°ç»„</span>
  <span class="hljs-title function_">toArray</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> nodes = [];
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;

    <span class="hljs-keyword">while</span> (currentNode) {
      nodes.<span class="hljs-title function_">push</span>(currentNode.<span class="hljs-property">value</span>);
      currentNode = currentNode.<span class="hljs-property">next</span>;
    }

    <span class="hljs-keyword">return</span> nodes;
  }
}
</code></pre>
<h5 data-id="heading-6">2.2 åŒå‘é“¾è¡¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DoublyListNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value, next = <span class="hljs-literal">null</span>, prev = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">next</span> = next;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">prev</span> = prev;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DoublyLinkedList</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// åœ¨æœ«å°¾æ·»åŠ èŠ‚ç‚¹</span>
  <span class="hljs-title function_">append</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DoublyListNode</span>(value);
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = newNode;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">next</span> = newNode;
      newNode.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
  
  <span class="hljs-comment">// åœ¨å¼€å¤´æ·»åŠ èŠ‚ç‚¹</span>
  <span class="hljs-title function_">prepend</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DoublyListNode</span>(value, <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>);
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">prev</span> = newNode;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = newNode;
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = newNode;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
  
  <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span>
  <span class="hljs-title function_">delete</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">let</span> deletedNode = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
    
    <span class="hljs-keyword">while</span> (currentNode) {
      <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">value</span> === value) {
        deletedNode = currentNode;
        
        <span class="hljs-keyword">if</span> (deletedNode === <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = deletedNode.<span class="hljs-property">next</span>;
          
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">prev</span> = <span class="hljs-literal">null</span>;
          }
          
          <span class="hljs-keyword">if</span> (deletedNode === <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = <span class="hljs-literal">null</span>;
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (deletedNode === <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = deletedNode.<span class="hljs-property">prev</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">const</span> prevNode = deletedNode.<span class="hljs-property">prev</span>;
          <span class="hljs-keyword">const</span> nextNode = deletedNode.<span class="hljs-property">next</span>;
          
          prevNode.<span class="hljs-property">next</span> = nextNode;
          nextNode.<span class="hljs-property">prev</span> = prevNode;
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>--;
      }
      
      currentNode = currentNode.<span class="hljs-property">next</span>;
    }
    
    <span class="hljs-keyword">return</span> deletedNode;
  }
  
  <span class="hljs-comment">// ä»å°¾éƒ¨éå†</span>
  <span class="hljs-title function_">reverseTraversal</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>;
    
    <span class="hljs-keyword">while</span> (currentNode) {
      <span class="hljs-title function_">callback</span>(currentNode.<span class="hljs-property">value</span>);
      currentNode = currentNode.<span class="hljs-property">prev</span>;
    }
  }
}
</code></pre>
<h4 data-id="heading-7">ä¸‰ã€æ ˆå’Œé˜Ÿåˆ—çš„ä¼˜åŒ–å®ç°</h4>
<h5 data-id="heading-8">3.1 æ ˆçš„å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// å…¥æ ˆ</span>
  <span class="hljs-title function_">push</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>] = element;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>;
  }
  
  <span class="hljs-comment">// å‡ºæ ˆ</span>
  <span class="hljs-title function_">pop</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;
    <span class="hljs-keyword">const</span> deletedItem = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];
    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>];
    <span class="hljs-keyword">return</span> deletedItem;
  }
  
  <span class="hljs-comment">// æŸ¥çœ‹æ ˆé¡¶å…ƒç´ </span>
  <span class="hljs-title function_">peek</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>];
  }
  
  <span class="hljs-comment">// æ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º</span>
  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// è·å–æ ˆå¤§å°</span>
  <span class="hljs-title function_">size</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>;
  }
  
  <span class="hljs-comment">// æ¸…ç©ºæ ˆ</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// æ ˆçš„åº”ç”¨ï¼šæ‹¬å·åŒ¹é…</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">isBalancedParentheses</span>(<span class="hljs-params">str</span>) {
    <span class="hljs-keyword">const</span> stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>();
    <span class="hljs-keyword">const</span> parenthesesMap = {
      <span class="hljs-string">')'</span>: <span class="hljs-string">'('</span>,
      <span class="hljs-string">'}'</span>: <span class="hljs-string">'{'</span>,
      <span class="hljs-string">']'</span>: <span class="hljs-string">'['</span>
    };
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> str) {
      <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'('</span> || char === <span class="hljs-string">'{'</span> || char === <span class="hljs-string">'['</span>) {
        stack.<span class="hljs-title function_">push</span>(char);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (char === <span class="hljs-string">')'</span> || char === <span class="hljs-string">'}'</span> || char === <span class="hljs-string">']'</span>) {
        <span class="hljs-keyword">if</span> (stack.<span class="hljs-title function_">isEmpty</span>() || stack.<span class="hljs-title function_">pop</span>() !== parenthesesMap[char]) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
      }
    }
    
    <span class="hljs-keyword">return</span> stack.<span class="hljs-title function_">isEmpty</span>();
  }
}
</code></pre>
<h5 data-id="heading-9">3.2 é˜Ÿåˆ—çš„å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Queue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = {};
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// å…¥é˜Ÿ</span>
  <span class="hljs-title function_">enqueue</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span>] = element;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>;
  }
  
  <span class="hljs-comment">// å‡ºé˜Ÿ</span>
  <span class="hljs-title function_">dequeue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>];
    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>++;
    <span class="hljs-keyword">return</span> element;
  }
  
  <span class="hljs-comment">// æŸ¥çœ‹é˜Ÿé¦–å…ƒç´ </span>
  <span class="hljs-title function_">peek</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>];
  }
  
  <span class="hljs-comment">// é˜Ÿåˆ—å¤§å°</span>
  <span class="hljs-title function_">size</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span>;
  }
  
  <span class="hljs-comment">// æ˜¯å¦ä¸ºç©º</span>
  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">size</span>() === <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// æ¸…ç©ºé˜Ÿåˆ—</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = {};
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">backIndex</span> = <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">// å¾ªç¯é˜Ÿåˆ—å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CircularQueue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">k</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = k;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(k);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-title function_">enQueue</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">const</span> tailIndex = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>[tailIndex] = value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-title function_">deQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span> + <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-title class_">Front</span>() {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span>];
  }
  
  <span class="hljs-title class_">Rear</span>() {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> tailIndex = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">headIndex</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>[tailIndex];
  }
  
  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-title function_">isFull</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
  }
}
</code></pre>
<h4 data-id="heading-10">å››ã€æ ‘ç»“æ„çš„æ·±åº¦ä¼˜åŒ–</h4>
<h5 data-id="heading-11">4.1 äºŒå‰æ ‘å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">left</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">right</span> = <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BinaryTree</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span> = <span class="hljs-literal">null</span>;
  }
  
  <span class="hljs-comment">// æ’å…¥èŠ‚ç‚¹</span>
  <span class="hljs-title function_">insert</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(value);
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span> = newNode;
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>;
    
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
      <span class="hljs-keyword">if</span> (value &lt; currentNode.<span class="hljs-property">value</span>) {
        <span class="hljs-keyword">if</span> (!currentNode.<span class="hljs-property">left</span>) {
          currentNode.<span class="hljs-property">left</span> = newNode;
          <span class="hljs-keyword">break</span>;
        }
        currentNode = currentNode.<span class="hljs-property">left</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (!currentNode.<span class="hljs-property">right</span>) {
          currentNode.<span class="hljs-property">right</span> = newNode;
          <span class="hljs-keyword">break</span>;
        }
        currentNode = currentNode.<span class="hljs-property">right</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
  
  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ï¼šå‰åº</span>
  <span class="hljs-title function_">preOrderTraversal</span>(<span class="hljs-params">node = <span class="hljs-variable language_">this</span>.root, result = []</span>) {
    <span class="hljs-keyword">if</span> (node) {
      result.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">value</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preOrderTraversal</span>(node.<span class="hljs-property">left</span>, result);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preOrderTraversal</span>(node.<span class="hljs-property">right</span>, result);
    }
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ï¼šä¸­åº</span>
  <span class="hljs-title function_">inOrderTraversal</span>(<span class="hljs-params">node = <span class="hljs-variable language_">this</span>.root, result = []</span>) {
    <span class="hljs-keyword">if</span> (node) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">inOrderTraversal</span>(node.<span class="hljs-property">left</span>, result);
      result.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">value</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">inOrderTraversal</span>(node.<span class="hljs-property">right</span>, result);
    }
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†ï¼šååº</span>
  <span class="hljs-title function_">postOrderTraversal</span>(<span class="hljs-params">node = <span class="hljs-variable language_">this</span>.root, result = []</span>) {
    <span class="hljs-keyword">if</span> (node) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">postOrderTraversal</span>(node.<span class="hljs-property">left</span>, result);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">postOrderTraversal</span>(node.<span class="hljs-property">right</span>, result);
      result.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">value</span>);
    }
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// å¹¿åº¦ä¼˜å…ˆéå†</span>
  <span class="hljs-title function_">levelOrderTraversal</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>) <span class="hljs-keyword">return</span> [];
    
    <span class="hljs-keyword">const</span> result = [];
    <span class="hljs-keyword">const</span> queue = [<span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>];
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> levelSize = queue.<span class="hljs-property">length</span>;
      <span class="hljs-keyword">const</span> currentLevel = [];
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; levelSize; i++) {
        <span class="hljs-keyword">const</span> currentNode = queue.<span class="hljs-title function_">shift</span>();
        currentLevel.<span class="hljs-title function_">push</span>(currentNode.<span class="hljs-property">value</span>);
        
        <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">left</span>) {
          queue.<span class="hljs-title function_">push</span>(currentNode.<span class="hljs-property">left</span>);
        }
        <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">right</span>) {
          queue.<span class="hljs-title function_">push</span>(currentNode.<span class="hljs-property">right</span>);
        }
      }
      
      result.<span class="hljs-title function_">push</span>(currentLevel);
    }
    
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æŸ¥æ‰¾èŠ‚ç‚¹</span>
  <span class="hljs-title function_">find</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">let</span> currentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>;
    
    <span class="hljs-keyword">while</span> (currentNode) {
      <span class="hljs-keyword">if</span> (value === currentNode.<span class="hljs-property">value</span>) {
        <span class="hljs-keyword">return</span> currentNode;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &lt; currentNode.<span class="hljs-property">value</span>) {
        currentNode = currentNode.<span class="hljs-property">left</span>;
      } <span class="hljs-keyword">else</span> {
        currentNode = currentNode.<span class="hljs-property">right</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}
</code></pre>
<h5 data-id="heading-12">4.2 å¹³è¡¡äºŒå‰æœç´¢æ ‘(AVLæ ‘)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AVLNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">left</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">right</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = <span class="hljs-number">1</span>;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AVLTree</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span> = <span class="hljs-literal">null</span>;
  }
  
  <span class="hljs-comment">// è·å–èŠ‚ç‚¹é«˜åº¦</span>
  <span class="hljs-title function_">getHeight</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">return</span> node ? node.<span class="hljs-property">height</span> : <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// è·å–å¹³è¡¡å› å­</span>
  <span class="hljs-title function_">getBalanceFactor</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">return</span> node ? <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(node.<span class="hljs-property">left</span>) - <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(node.<span class="hljs-property">right</span>) : <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// å³æ—‹è½¬</span>
  <span class="hljs-title function_">rightRotate</span>(<span class="hljs-params">y</span>) {
    <span class="hljs-keyword">const</span> x = y.<span class="hljs-property">left</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = x.<span class="hljs-property">right</span>;
    
    x.<span class="hljs-property">right</span> = y;
    y.<span class="hljs-property">left</span> = <span class="hljs-variable constant_">T2</span>;
    
    y.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(y.<span class="hljs-property">left</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(y.<span class="hljs-property">right</span>)) + <span class="hljs-number">1</span>;
    x.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(x.<span class="hljs-property">left</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(x.<span class="hljs-property">right</span>)) + <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">return</span> x;
  }
  
  <span class="hljs-comment">// å·¦æ—‹è½¬</span>
  <span class="hljs-title function_">leftRotate</span>(<span class="hljs-params">x</span>) {
    <span class="hljs-keyword">const</span> y = x.<span class="hljs-property">right</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = y.<span class="hljs-property">left</span>;
    
    y.<span class="hljs-property">left</span> = x;
    x.<span class="hljs-property">right</span> = <span class="hljs-variable constant_">T2</span>;
    
    x.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(x.<span class="hljs-property">left</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(x.<span class="hljs-property">right</span>)) + <span class="hljs-number">1</span>;
    y.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(y.<span class="hljs-property">left</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(y.<span class="hljs-property">right</span>)) + <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">return</span> y;
  }
  
  <span class="hljs-comment">// æ’å…¥èŠ‚ç‚¹</span>
  <span class="hljs-title function_">insert</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_insertNode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">root</span>, value);
  }
  
  <span class="hljs-title function_">_insertNode</span>(<span class="hljs-params">node, value</span>) {
    <span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AVLNode</span>(value);
    
    <span class="hljs-keyword">if</span> (value &lt; node.<span class="hljs-property">value</span>) {
      node.<span class="hljs-property">left</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_insertNode</span>(node.<span class="hljs-property">left</span>, value);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &gt; node.<span class="hljs-property">value</span>) {
      node.<span class="hljs-property">right</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_insertNode</span>(node.<span class="hljs-property">right</span>, value);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> node; <span class="hljs-comment">// ä¸å…è®¸é‡å¤å€¼</span>
    }
    
    <span class="hljs-comment">// æ›´æ–°é«˜åº¦</span>
    node.<span class="hljs-property">height</span> = <span class="hljs-number">1</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(node.<span class="hljs-property">left</span>),
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHeight</span>(node.<span class="hljs-property">right</span>)
    );
    
    <span class="hljs-comment">// è·å–å¹³è¡¡å› å­</span>
    <span class="hljs-keyword">const</span> balance = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getBalanceFactor</span>(node);
    
    <span class="hljs-comment">// å¹³è¡¡è°ƒæ•´</span>
    <span class="hljs-comment">// å·¦å·¦æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; value &lt; node.<span class="hljs-property">left</span>.<span class="hljs-property">value</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rightRotate</span>(node);
    }
    
    <span class="hljs-comment">// å³å³æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; value &gt; node.<span class="hljs-property">right</span>.<span class="hljs-property">value</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">leftRotate</span>(node);
    }
    
    <span class="hljs-comment">// å·¦å³æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; value &gt; node.<span class="hljs-property">left</span>.<span class="hljs-property">value</span>) {
      node.<span class="hljs-property">left</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">leftRotate</span>(node.<span class="hljs-property">left</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rightRotate</span>(node);
    }
    
    <span class="hljs-comment">// å³å·¦æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; value &lt; node.<span class="hljs-property">right</span>.<span class="hljs-property">value</span>) {
      node.<span class="hljs-property">right</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rightRotate</span>(node.<span class="hljs-property">right</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">leftRotate</span>(node);
    }
    
    <span class="hljs-keyword">return</span> node;
  }
  
  <span class="hljs-comment">// æŸ¥æ‰¾æœ€å°å€¼èŠ‚ç‚¹</span>
  <span class="hljs-title function_">findMinNode</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">while</span> (node &amp;&amp; node.<span class="hljs-property">left</span>) {
      node = node.<span class="hljs-property">left</span>;
    }
    <span class="hljs-keyword">return</span> node;
  }
}
</code></pre>
<h4 data-id="heading-13">äº”ã€LRUç¼“å­˜æœºåˆ¶å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LRUCache</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">capacity</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = capacity;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span> = { <span class="hljs-attr">key</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">value</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">prev</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span> };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span> = { <span class="hljs-attr">key</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">value</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">prev</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span> };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
  }
  
  <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨å¤´éƒ¨</span>
  <span class="hljs-title function_">_addToHead</span>(<span class="hljs-params">node</span>) {
    node.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
    node.<span class="hljs-property">next</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span>.<span class="hljs-property">prev</span> = node;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span> = node;
  }
  
  <span class="hljs-comment">// ç§»é™¤èŠ‚ç‚¹</span>
  <span class="hljs-title function_">_removeNode</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">const</span> prev = node.<span class="hljs-property">prev</span>;
    <span class="hljs-keyword">const</span> next = node.<span class="hljs-property">next</span>;
    prev.<span class="hljs-property">next</span> = next;
    next.<span class="hljs-property">prev</span> = prev;
  }
  
  <span class="hljs-comment">// ç§»åŠ¨åˆ°å¤´éƒ¨</span>
  <span class="hljs-title function_">_moveToHead</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeNode</span>(node);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addToHead</span>(node);
  }
  
  <span class="hljs-comment">// ç§»é™¤å°¾éƒ¨èŠ‚ç‚¹</span>
  <span class="hljs-title function_">_popTail</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> res = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">prev</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeNode</span>(res);
    <span class="hljs-keyword">return</span> res;
  }
  
  <span class="hljs-comment">// è·å–ç¼“å­˜</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
    
    <span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_moveToHead</span>(node);
    <span class="hljs-keyword">return</span> node.<span class="hljs-property">value</span>;
  }
  
  <span class="hljs-comment">// è®¾ç½®ç¼“å­˜</span>
  <span class="hljs-title function_">put</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);
      node.<span class="hljs-property">value</span> = value;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_moveToHead</span>(node);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> newNode = {
        key,
        value,
        <span class="hljs-attr">prev</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span>
      };
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key, newNode);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addToHead</span>(newNode);
      
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>) {
        <span class="hljs-keyword">const</span> tail = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_popTail</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(tail.<span class="hljs-property">key</span>);
      }
    }
  }
  
  <span class="hljs-comment">// è·å–æ‰€æœ‰ç¼“å­˜é”®ï¼ˆæŒ‰ä½¿ç”¨é¡ºåºï¼‰</span>
  <span class="hljs-title function_">getKeys</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> keys = [];
    <span class="hljs-keyword">let</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span>;
    
    <span class="hljs-keyword">while</span> (node !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>) {
      keys.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">key</span>);
      node = node.<span class="hljs-property">next</span>;
    }
    
    <span class="hljs-keyword">return</span> keys;
  }
  
  <span class="hljs-comment">// æ¸…ç©ºç¼“å­˜</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>.<span class="hljs-property">next</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tail</span>.<span class="hljs-property">prev</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">head</span>;
  }
}

<span class="hljs-comment">// LRUç¼“å­˜ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> lruCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LRUCache</span>(<span class="hljs-number">3</span>);

<span class="hljs-comment">// æ·»åŠ æ•°æ®</span>
lruCache.<span class="hljs-title function_">put</span>(<span class="hljs-string">'user1'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> });
lruCache.<span class="hljs-title function_">put</span>(<span class="hljs-string">'user2'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });
lruCache.<span class="hljs-title function_">put</span>(<span class="hljs-string">'user3'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Charlie'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span> });

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å½“å‰ç¼“å­˜é”®:'</span>, lruCache.<span class="hljs-title function_">getKeys</span>()); <span class="hljs-comment">// ['user3', 'user2', 'user1']</span>

<span class="hljs-comment">// è®¿é—®user1ï¼Œå°†å…¶ç§»åŠ¨åˆ°æœ€å‰é¢</span>
lruCache.<span class="hljs-title function_">get</span>(<span class="hljs-string">'user1'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è®¿é—®user1å:'</span>, lruCache.<span class="hljs-title function_">getKeys</span>()); <span class="hljs-comment">// ['user1', 'user3', 'user2']</span>

<span class="hljs-comment">// æ·»åŠ æ–°æ•°æ®ï¼Œè¶…å‡ºå®¹é‡</span>
lruCache.<span class="hljs-title function_">put</span>(<span class="hljs-string">'user4'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'David'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">40</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ·»åŠ user4å:'</span>, lruCache.<span class="hljs-title function_">getKeys</span>()); <span class="hljs-comment">// ['user4', 'user1', 'user3']</span>
</code></pre>
<h4 data-id="heading-14">å…­ã€å›¾çš„ç®—æ³•å®ç°</h4>
<h5 data-id="heading-15">6.1 å›¾çš„è¡¨ç¤ºå’Œéå†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Graph</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">isDirected = <span class="hljs-literal">false</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDirected</span> = isDirected;
  }
  
  <span class="hljs-comment">// æ·»åŠ é¡¶ç‚¹</span>
  <span class="hljs-title function_">addVertex</span>(<span class="hljs-params">vertex</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">has</span>(vertex)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">set</span>(vertex, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>());
    }
  }
  
  <span class="hljs-comment">// æ·»åŠ è¾¹</span>
  <span class="hljs-title function_">addEdge</span>(<span class="hljs-params">vertex1, vertex2</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">has</span>(vertex1)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertex</span>(vertex1);
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">has</span>(vertex2)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addVertex</span>(vertex2);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex1).<span class="hljs-title function_">add</span>(vertex2);
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDirected</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex2).<span class="hljs-title function_">add</span>(vertex1);
    }
  }
  
  <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†</span>
  <span class="hljs-title function_">dfs</span>(<span class="hljs-params">startVertex, callback</span>) {
    <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">dfsVisit</span> = (<span class="hljs-params">vertex</span>) =&gt; {
      visited.<span class="hljs-title function_">add</span>(vertex);
      callback &amp;&amp; <span class="hljs-title function_">callback</span>(vertex);
      
      <span class="hljs-keyword">const</span> neighbors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> neighbor <span class="hljs-keyword">of</span> neighbors) {
        <span class="hljs-keyword">if</span> (!visited.<span class="hljs-title function_">has</span>(neighbor)) {
          <span class="hljs-title function_">dfsVisit</span>(neighbor);
        }
      }
    };
    
    <span class="hljs-title function_">dfsVisit</span>(startVertex);
  }
  
  <span class="hljs-comment">// å¹¿åº¦ä¼˜å…ˆéå†</span>
  <span class="hljs-title function_">bfs</span>(<span class="hljs-params">startVertex, callback</span>) {
    <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([startVertex]);
    <span class="hljs-keyword">const</span> queue = [startVertex];
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> vertex = queue.<span class="hljs-title function_">shift</span>();
      callback &amp;&amp; <span class="hljs-title function_">callback</span>(vertex);
      
      <span class="hljs-keyword">const</span> neighbors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> neighbor <span class="hljs-keyword">of</span> neighbors) {
        <span class="hljs-keyword">if</span> (!visited.<span class="hljs-title function_">has</span>(neighbor)) {
          visited.<span class="hljs-title function_">add</span>(neighbor);
          queue.<span class="hljs-title function_">push</span>(neighbor);
        }
      }
    }
  }
  
  <span class="hljs-comment">// æœ€çŸ­è·¯å¾„ï¼ˆBFSï¼‰</span>
  <span class="hljs-title function_">shortestPath</span>(<span class="hljs-params">startVertex, endVertex</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">has</span>(startVertex) || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">has</span>(endVertex)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([startVertex]);
    <span class="hljs-keyword">const</span> queue = [startVertex];
    <span class="hljs-keyword">const</span> predecessors = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-keyword">const</span> distances = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    
    distances.<span class="hljs-title function_">set</span>(startVertex, <span class="hljs-number">0</span>);
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> vertex = queue.<span class="hljs-title function_">shift</span>();
      
      <span class="hljs-keyword">if</span> (vertex === endVertex) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_buildPath</span>(predecessors, startVertex, endVertex);
      }
      
      <span class="hljs-keyword">const</span> neighbors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> neighbor <span class="hljs-keyword">of</span> neighbors) {
        <span class="hljs-keyword">if</span> (!visited.<span class="hljs-title function_">has</span>(neighbor)) {
          visited.<span class="hljs-title function_">add</span>(neighbor);
          predecessors.<span class="hljs-title function_">set</span>(neighbor, vertex);
          distances.<span class="hljs-title function_">set</span>(neighbor, distances.<span class="hljs-title function_">get</span>(vertex) + <span class="hljs-number">1</span>);
          queue.<span class="hljs-title function_">push</span>(neighbor);
        }
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  
  <span class="hljs-title function_">_buildPath</span>(<span class="hljs-params">predecessors, start, end</span>) {
    <span class="hljs-keyword">const</span> path = [end];
    <span class="hljs-keyword">let</span> current = end;
    
    <span class="hljs-keyword">while</span> (current !== start) {
      current = predecessors.<span class="hljs-title function_">get</span>(current);
      path.<span class="hljs-title function_">unshift</span>(current);
    }
    
    <span class="hljs-keyword">return</span> path;
  }
  
  <span class="hljs-comment">// æ‹“æ‰‘æ’åºï¼ˆä»…é€‚ç”¨äºæœ‰å‘æ— ç¯å›¾ï¼‰</span>
  <span class="hljs-title function_">topologicalSort</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDirected</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ‹“æ‰‘æ’åºä»…é€‚ç”¨äºæœ‰å‘å›¾'</span>);
    }
    
    <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-keyword">const</span> stack = [];
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">visit</span> = (<span class="hljs-params">vertex</span>) =&gt; {
      visited.<span class="hljs-title function_">add</span>(vertex);
      
      <span class="hljs-keyword">const</span> neighbors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">get</span>(vertex);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> neighbor <span class="hljs-keyword">of</span> neighbors) {
        <span class="hljs-keyword">if</span> (!visited.<span class="hljs-title function_">has</span>(neighbor)) {
          <span class="hljs-title function_">visit</span>(neighbor);
        }
      }
      
      stack.<span class="hljs-title function_">push</span>(vertex);
    };
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> vertex <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertices</span>.<span class="hljs-title function_">keys</span>()) {
      <span class="hljs-keyword">if</span> (!visited.<span class="hljs-title function_">has</span>(vertex)) {
        <span class="hljs-title function_">visit</span>(vertex);
      }
    }
    
    <span class="hljs-keyword">return</span> stack.<span class="hljs-title function_">reverse</span>();
  }
}
</code></pre>
<h5 data-id="heading-16">6.2 Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WeightedGraph</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }
  
  <span class="hljs-title function_">addVertex</span>(<span class="hljs-params">vertex</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">has</span>(vertex)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">set</span>(vertex, []);
    }
  }
  
  <span class="hljs-title function_">addEdge</span>(<span class="hljs-params">vertex1, vertex2, weight</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">get</span>(vertex1).<span class="hljs-title function_">push</span>({ <span class="hljs-attr">node</span>: vertex2, weight });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">get</span>(vertex2).<span class="hljs-title function_">push</span>({ <span class="hljs-attr">node</span>: vertex1, weight });
  }
  
  <span class="hljs-title function_">dijkstra</span>(<span class="hljs-params">start, end</span>) {
    <span class="hljs-keyword">const</span> nodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>();
    <span class="hljs-keyword">const</span> distances = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-keyword">const</span> previous = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-keyword">const</span> path = [];
    
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> vertex <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">keys</span>()) {
      <span class="hljs-keyword">if</span> (vertex === start) {
        distances.<span class="hljs-title function_">set</span>(vertex, <span class="hljs-number">0</span>);
        nodes.<span class="hljs-title function_">enqueue</span>(vertex, <span class="hljs-number">0</span>);
      } <span class="hljs-keyword">else</span> {
        distances.<span class="hljs-title function_">set</span>(vertex, <span class="hljs-title class_">Infinity</span>);
        nodes.<span class="hljs-title function_">enqueue</span>(vertex, <span class="hljs-title class_">Infinity</span>);
      }
      previous.<span class="hljs-title function_">set</span>(vertex, <span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-keyword">while</span> (!nodes.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-keyword">const</span> smallest = nodes.<span class="hljs-title function_">dequeue</span>().<span class="hljs-property">value</span>;
      
      <span class="hljs-keyword">if</span> (smallest === end) {
        <span class="hljs-comment">// æ„å»ºè·¯å¾„</span>
        <span class="hljs-keyword">let</span> current = end;
        <span class="hljs-keyword">while</span> (current) {
          path.<span class="hljs-title function_">unshift</span>(current);
          current = previous.<span class="hljs-title function_">get</span>(current);
        }
        <span class="hljs-keyword">break</span>;
      }
      
      <span class="hljs-keyword">if</span> (smallest &amp;&amp; distances.<span class="hljs-title function_">get</span>(smallest) !== <span class="hljs-title class_">Infinity</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> neighbor <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjacencyList</span>.<span class="hljs-title function_">get</span>(smallest)) {
          <span class="hljs-keyword">const</span> candidate = distances.<span class="hljs-title function_">get</span>(smallest) + neighbor.<span class="hljs-property">weight</span>;
          
          <span class="hljs-keyword">if</span> (candidate &lt; distances.<span class="hljs-title function_">get</span>(neighbor.<span class="hljs-property">node</span>)) {
            distances.<span class="hljs-title function_">set</span>(neighbor.<span class="hljs-property">node</span>, candidate);
            previous.<span class="hljs-title function_">set</span>(neighbor.<span class="hljs-property">node</span>, smallest);
            nodes.<span class="hljs-title function_">enqueue</span>(neighbor.<span class="hljs-property">node</span>, candidate);
          }
        }
      }
    }
    
    <span class="hljs-keyword">return</span> path.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> ? path : [];
  }
}

<span class="hljs-comment">// ä¼˜å…ˆé˜Ÿåˆ—å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityQueue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">values</span> = [];
  }
  
  <span class="hljs-title function_">enqueue</span>(<span class="hljs-params">value, priority</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">values</span>.<span class="hljs-title function_">push</span>({ value, priority });
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sort</span>();
  }
  
  <span class="hljs-title function_">dequeue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">values</span>.<span class="hljs-title function_">shift</span>();
  }
  
  <span class="hljs-title function_">sort</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">values</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">priority</span> - b.<span class="hljs-property">priority</span>);
  }
  
  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">values</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>;
  }
}
</code></pre>
<h4 data-id="heading-17">ä¸ƒã€æ•£åˆ—è¡¨ä¸å“ˆå¸Œå‡½æ•°</h4>
<h5 data-id="heading-18">7.1 è‡ªå®šä¹‰æ•£åˆ—è¡¨å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HashTable</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">size = <span class="hljs-number">53</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(size);
  }
  
  <span class="hljs-comment">// å“ˆå¸Œå‡½æ•°</span>
  <span class="hljs-title function_">_hash</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PRIME</span> = <span class="hljs-number">31</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(key.<span class="hljs-property">length</span>, <span class="hljs-number">100</span>); i++) {
      <span class="hljs-keyword">const</span> char = key[i];
      <span class="hljs-keyword">const</span> value = char.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>) - <span class="hljs-number">96</span>;
      total = (total * <span class="hljs-variable constant_">PRIME</span> + value) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>;
    }
    
    <span class="hljs-keyword">return</span> total;
  }
  
  <span class="hljs-comment">// äºŒæ¬¡å“ˆå¸Œè§£å†³å†²çª</span>
  <span class="hljs-title function_">_hash2</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PRIME</span> = <span class="hljs-number">37</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(key.<span class="hljs-property">length</span>, <span class="hljs-number">100</span>); i++) {
      <span class="hljs-keyword">const</span> char = key[i];
      <span class="hljs-keyword">const</span> value = char.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>) - <span class="hljs-number">96</span>;
      total = (total * <span class="hljs-variable constant_">PRIME</span> + value) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>;
    }
    
    <span class="hljs-keyword">return</span> total || <span class="hljs-number">1</span>; <span class="hljs-comment">// ç¡®ä¿ä¸ä¸º0</span>
  }
  
  <span class="hljs-comment">// åŒé‡æ•£åˆ—è§£å†³å†²çª</span>
  <span class="hljs-title function_">_doubleHash</span>(<span class="hljs-params">key, attempt</span>) {
    <span class="hljs-keyword">const</span> hash1 = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_hash</span>(key);
    <span class="hljs-keyword">const</span> hash2 = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_hash2</span>(key);
    <span class="hljs-keyword">return</span> (hash1 + attempt * hash2) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>;
  }
  
  <span class="hljs-comment">// è®¾ç½®é”®å€¼å¯¹</span>
  <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">let</span> attempt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doubleHash</span>(key, attempt);
    
    <span class="hljs-comment">// å¤„ç†å†²çª</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index] &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index][<span class="hljs-number">0</span>] !== key) {
      attempt++;
      index = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doubleHash</span>(key, attempt);
      
      <span class="hljs-keyword">if</span> (attempt &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å“ˆå¸Œè¡¨å·²æ»¡'</span>);
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index] = [key, value];
  }
  
  <span class="hljs-comment">// è·å–å€¼</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">let</span> attempt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doubleHash</span>(key, attempt);
    
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index]) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index][<span class="hljs-number">0</span>] === key) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[index][<span class="hljs-number">1</span>];
      }
      attempt++;
      index = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doubleHash</span>(key, attempt);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
  }
  
  <span class="hljs-comment">// è·å–æ‰€æœ‰é”®</span>
  <span class="hljs-title function_">keys</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> keysArr = [];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[i]) {
        keysArr.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[i][<span class="hljs-number">0</span>]);
      }
    }
    
    <span class="hljs-keyword">return</span> keysArr;
  }
  
  <span class="hljs-comment">// è·å–æ‰€æœ‰å€¼</span>
  <span class="hljs-title function_">values</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> valuesArr = [];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[i]) {
        <span class="hljs-comment">// é¿å…é‡å¤å€¼</span>
        <span class="hljs-keyword">if</span> (!valuesArr.<span class="hljs-title function_">includes</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[i][<span class="hljs-number">1</span>])) {
          valuesArr.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyMap</span>[i][<span class="hljs-number">1</span>]);
        }
      }
    }
    
    <span class="hljs-keyword">return</span> valuesArr;
  }
}
</code></pre>
<h4 data-id="heading-19">å…«ã€æ’åºç®—æ³•ä¼˜åŒ–</h4>
<h5 data-id="heading-20">8.1 å¿«é€Ÿæ’åºä¼˜åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SortingAlgorithms</span> {
  <span class="hljs-comment">// å¿«é€Ÿæ’åºï¼ˆåŸåœ°æ’åºï¼‰</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">quickSort</span>(<span class="hljs-params">arr, left = <span class="hljs-number">0</span>, right = arr.length - <span class="hljs-number">1</span></span>) {
    <span class="hljs-keyword">if</span> (left &lt; right) {
      <span class="hljs-keyword">const</span> pivotIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">partition</span>(arr, left, right);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">quickSort</span>(arr, left, pivotIndex - <span class="hljs-number">1</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">quickSort</span>(arr, pivotIndex + <span class="hljs-number">1</span>, right);
    }
    <span class="hljs-keyword">return</span> arr;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">partition</span>(<span class="hljs-params">arr, left, right</span>) {
    <span class="hljs-keyword">const</span> pivot = arr[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>)];
    <span class="hljs-keyword">let</span> i = left;
    <span class="hljs-keyword">let</span> j = right;
    
    <span class="hljs-keyword">while</span> (i &lt;= j) {
      <span class="hljs-keyword">while</span> (arr[i] &lt; pivot) {
        i++;
      }
      <span class="hljs-keyword">while</span> (arr[j] &gt; pivot) {
        j--;
      }
      <span class="hljs-keyword">if</span> (i &lt;= j) {
        [arr[i], arr[j]] = [arr[j], arr[i]];
        i++;
        j--;
      }
    }
    
    <span class="hljs-keyword">return</span> i;
  }
  
  <span class="hljs-comment">// å½’å¹¶æ’åº</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">mergeSort</span>(<span class="hljs-params">arr</span>) {
    <span class="hljs-keyword">if</span> (arr.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> arr;
    
    <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(arr.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> left = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mergeSort</span>(arr.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, mid));
    <span class="hljs-keyword">const</span> right = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mergeSort</span>(arr.<span class="hljs-title function_">slice</span>(mid));
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">merge</span>(left, right);
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">left, right</span>) {
    <span class="hljs-keyword">const</span> result = [];
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">while</span> (i &lt; left.<span class="hljs-property">length</span> &amp;&amp; j &lt; right.<span class="hljs-property">length</span>) {
      <span class="hljs-keyword">if</span> (left[i] &lt; right[j]) {
        result.<span class="hljs-title function_">push</span>(left[i]);
        i++;
      } <span class="hljs-keyword">else</span> {
        result.<span class="hljs-title function_">push</span>(right[j]);
        j++;
      }
    }
    
    <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">concat</span>(left.<span class="hljs-title function_">slice</span>(i), right.<span class="hljs-title function_">slice</span>(j));
  }
  
  <span class="hljs-comment">// å †æ’åº</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">heapSort</span>(<span class="hljs-params">arr</span>) {
    <span class="hljs-keyword">const</span> n = arr.<span class="hljs-property">length</span>;
    
    <span class="hljs-comment">// æ„å»ºæœ€å¤§å †</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(n / <span class="hljs-number">2</span>) - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">heapify</span>(arr, n, i);
    }
    
    <span class="hljs-comment">// ä¸€ä¸ªä¸ªæå–å…ƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = n - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; i--) {
      [arr[<span class="hljs-number">0</span>], arr[i]] = [arr[i], arr[<span class="hljs-number">0</span>]];
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">heapify</span>(arr, i, <span class="hljs-number">0</span>);
    }
    
    <span class="hljs-keyword">return</span> arr;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">heapify</span>(<span class="hljs-params">arr, n, i</span>) {
    <span class="hljs-keyword">let</span> largest = i;
    <span class="hljs-keyword">const</span> left = <span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> right = <span class="hljs-number">2</span> * i + <span class="hljs-number">2</span>;
    
    <span class="hljs-keyword">if</span> (left &lt; n &amp;&amp; arr[left] &gt; arr[largest]) {
      largest = left;
    }
    
    <span class="hljs-keyword">if</span> (right &lt; n &amp;&amp; arr[right] &gt; arr[largest]) {
      largest = right;
    }
    
    <span class="hljs-keyword">if</span> (largest !== i) {
      [arr[i], arr[largest]] = [arr[largest], arr[i]];
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">heapify</span>(arr, n, largest);
    }
  }
  
  <span class="hljs-comment">// æ€§èƒ½æ¯”è¾ƒ</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">performanceTest</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> sizes = [<span class="hljs-number">1000</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">100000</span>];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> size <span class="hljs-keyword">of</span> sizes) {
      <span class="hljs-keyword">const</span> arr = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: size }, <span class="hljs-function">() =&gt;</span> 
        <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * size)
      );
      
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\næµ‹è¯•æ•°ç»„å¤§å°: <span class="hljs-subst">${size}</span>`</span>);
      
      <span class="hljs-comment">// å¿«é€Ÿæ’åº</span>
      <span class="hljs-keyword">const</span> arr1 = [...arr];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'å¿«é€Ÿæ’åº'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">quickSort</span>(arr1);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'å¿«é€Ÿæ’åº'</span>);
      
      <span class="hljs-comment">// å½’å¹¶æ’åº</span>
      <span class="hljs-keyword">const</span> arr2 = [...arr];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'å½’å¹¶æ’åº'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mergeSort</span>(arr2);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'å½’å¹¶æ’åº'</span>);
      
      <span class="hljs-comment">// å †æ’åº</span>
      <span class="hljs-keyword">const</span> arr3 = [...arr];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'å †æ’åº'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">heapSort</span>(arr3);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'å †æ’åº'</span>);
      
      <span class="hljs-comment">// å†…ç½®æ’åº</span>
      <span class="hljs-keyword">const</span> arr4 = [...arr];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'å†…ç½®æ’åº'</span>);
      arr4.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'å†…ç½®æ’åº'</span>);
    }
  }
}
</code></pre>
<h4 data-id="heading-21">ä¹ã€æœç´¢ç®—æ³•ä¼˜åŒ–</h4>
<h5 data-id="heading-22">9.1 äºŒåˆ†æŸ¥æ‰¾åŠå…¶å˜ä½“</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SearchAlgorithms</span> {
  <span class="hljs-comment">// æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">binarySearch</span>(<span class="hljs-params">arr, target</span>) {
    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> right = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (left &lt;= right) {
      <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>);
      
      <span class="hljs-keyword">if</span> (arr[mid] === target) {
        <span class="hljs-keyword">return</span> mid;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[mid] &lt; target) {
        left = mid + <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        right = mid - <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  }
  
  <span class="hljs-comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºç›®æ ‡å€¼çš„ä½ç½®</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">binarySearchFirst</span>(<span class="hljs-params">arr, target</span>) {
    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> right = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">let</span> result = -<span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (left &lt;= right) {
      <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>);
      
      <span class="hljs-keyword">if</span> (arr[mid] &gt;= target) {
        <span class="hljs-keyword">if</span> (arr[mid] === target) {
          result = mid;
        }
        right = mid - <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        left = mid + <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ªç­‰äºç›®æ ‡å€¼çš„ä½ç½®</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">binarySearchLast</span>(<span class="hljs-params">arr, target</span>) {
    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> right = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">let</span> result = -<span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (left &lt;= right) {
      <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>);
      
      <span class="hljs-keyword">if</span> (arr[mid] &lt;= target) {
        <span class="hljs-keyword">if</span> (arr[mid] === target) {
          result = mid;
        }
        left = mid + <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        right = mid - <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç›®æ ‡å€¼çš„ä½ç½®</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">binarySearchCeil</span>(<span class="hljs-params">arr, target</span>) {
    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> right = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">let</span> result = -<span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (left &lt;= right) {
      <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>);
      
      <span class="hljs-keyword">if</span> (arr[mid] &gt;= target) {
        result = mid;
        right = mid - <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        left = mid + <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// æ’å€¼æŸ¥æ‰¾ï¼ˆé€‚ç”¨äºå‡åŒ€åˆ†å¸ƒçš„æœ‰åºæ•°ç»„ï¼‰</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">interpolationSearch</span>(<span class="hljs-params">arr, target</span>) {
    <span class="hljs-keyword">let</span> low = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> high = arr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (low &lt;= high &amp;&amp; target &gt;= arr[low] &amp;&amp; target &lt;= arr[high]) {
      <span class="hljs-keyword">if</span> (low === high) {
        <span class="hljs-keyword">return</span> arr[low] === target ? low : -<span class="hljs-number">1</span>;
      }
      
      <span class="hljs-comment">// è®¡ç®—æ’å€¼ä½ç½®</span>
      <span class="hljs-keyword">const</span> pos = low + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(
        ((target - arr[low]) * (high - low)) / (arr[high] - arr[low])
      );
      
      <span class="hljs-keyword">if</span> (arr[pos] === target) {
        <span class="hljs-keyword">return</span> pos;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[pos] &lt; target) {
        low = pos + <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        high = pos - <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  }
}
</code></pre>
<h4 data-id="heading-23">åã€å®é™…åº”ç”¨åœºæ™¯</h4>
<h5 data-id="heading-24">10.1 è™šæ‹ŸDOM diffç®—æ³•ä¸­çš„ä¼˜åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VNode</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">tag, props, children</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tag</span> = tag;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span> = props || {};
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = children || [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = props &amp;&amp; props.<span class="hljs-property">key</span>;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualDOM</span> {
  <span class="hljs-comment">// ç®€åŒ–çš„diffç®—æ³•</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">diff</span>(<span class="hljs-params">oldVNode, newVNode</span>) {
    <span class="hljs-comment">// å¦‚æœæ ‡ç­¾ä¸åŒï¼Œç›´æ¥æ›¿æ¢</span>
    <span class="hljs-keyword">if</span> (oldVNode.<span class="hljs-property">tag</span> !== newVNode.<span class="hljs-property">tag</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'REPLACE'</span>, <span class="hljs-attr">node</span>: newVNode };
    }
    
    <span class="hljs-comment">// å¦‚æœéƒ½æœ‰keyä¸”ä¸åŒï¼Œç§»åŠ¨èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (oldVNode.<span class="hljs-property">key</span> !== newVNode.<span class="hljs-property">key</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'REORDER'</span>, <span class="hljs-attr">moves</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateMoves</span>(oldVNode, newVNode) };
    }
    
    <span class="hljs-comment">// æ¯”è¾ƒå±æ€§</span>
    <span class="hljs-keyword">const</span> propsPatches = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">diffProps</span>(oldVNode.<span class="hljs-property">props</span>, newVNode.<span class="hljs-property">props</span>);
    
    <span class="hljs-comment">// æ¯”è¾ƒå­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> childrenPatches = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">diffChildren</span>(oldVNode.<span class="hljs-property">children</span>, newVNode.<span class="hljs-property">children</span>);
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'UPDATE'</span>,
      <span class="hljs-attr">props</span>: propsPatches,
      <span class="hljs-attr">children</span>: childrenPatches
    };
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">diffProps</span>(<span class="hljs-params">oldProps, newProps</span>) {
    <span class="hljs-keyword">const</span> patches = {};
    <span class="hljs-keyword">const</span> allKeys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([
      ...<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(oldProps),
      ...<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(newProps)
    ]);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> allKeys) {
      <span class="hljs-keyword">if</span> (oldProps[key] !== newProps[key]) {
        patches[key] = newProps[key];
      }
    }
    
    <span class="hljs-keyword">return</span> patches;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">diffChildren</span>(<span class="hljs-params">oldChildren, newChildren</span>) {
    <span class="hljs-keyword">const</span> patches = [];
    <span class="hljs-keyword">const</span> len = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(oldChildren.<span class="hljs-property">length</span>, newChildren.<span class="hljs-property">length</span>);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-keyword">const</span> oldChild = oldChildren[i];
      <span class="hljs-keyword">const</span> newChild = newChildren[i];
      
      <span class="hljs-keyword">if</span> (!oldChild &amp;&amp; newChild) {
        patches.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'INSERT'</span>, <span class="hljs-attr">node</span>: newChild });
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldChild &amp;&amp; !newChild) {
        patches.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'REMOVE'</span> });
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldChild &amp;&amp; newChild) {
        patches.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">diff</span>(oldChild, newChild));
      }
    }
    
    <span class="hljs-keyword">return</span> patches;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">calculateMoves</span>(<span class="hljs-params">oldNode, newNode</span>) {
    <span class="hljs-comment">// ç®€åŒ–çš„ç§»åŠ¨è®¡ç®—ï¼Œå®é™…å®ç°æ›´å¤æ‚</span>
    <span class="hljs-keyword">return</span> [];
  }
}
</code></pre>
<h5 data-id="heading-25">10.2 çŠ¶æ€ç®¡ç†ä¸­çš„ä¼˜åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedStore</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">reducer, initialState</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = initialState;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reducer</span> = reducer;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDispatching</span> = <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-title function_">getState</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDispatching</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¸èƒ½åœ¨reduceræ‰§è¡Œä¸­è·å–çŠ¶æ€'</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;
  }
  
  <span class="hljs-title function_">dispatch</span>(<span class="hljs-params">action</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDispatching</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¸èƒ½åœ¨reduceræ‰§è¡Œä¸­dispatch'</span>);
    }
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDispatching</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reducer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>, action);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDispatching</span> = <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰ç›‘å¬å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> <span class="hljs-title function_">listener</span>());
  }
  
  <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">listener</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">add</span>(listener);
    
    <span class="hljs-comment">// è¿”å›å–æ¶ˆè®¢é˜…çš„å‡½æ•°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">delete</span>(listener);
    };
  }
  
  <span class="hljs-comment">// é€‰æ‹©å™¨ä¼˜åŒ–ï¼šè®°å¿†åŒ–</span>
  <span class="hljs-title function_">createSelector</span>(<span class="hljs-params">...funcs</span>) {
    <span class="hljs-keyword">const</span> resultFunc = funcs.<span class="hljs-title function_">pop</span>();
    <span class="hljs-keyword">const</span> dependencies = funcs;
    <span class="hljs-keyword">let</span> lastArgs = [];
    <span class="hljs-keyword">let</span> lastResult;
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (lastArgs.<span class="hljs-property">length</span> === args.<span class="hljs-property">length</span> &amp;&amp; 
          lastArgs.<span class="hljs-title function_">every</span>(<span class="hljs-function">(<span class="hljs-params">arg, i</span>) =&gt;</span> arg === args[i])) {
        <span class="hljs-keyword">return</span> lastResult;
      }
      
      <span class="hljs-keyword">const</span> dependenciesResults = dependencies.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>(...args));
      lastResult = <span class="hljs-title function_">resultFunc</span>(...dependenciesResults);
      lastArgs = args;
      
      <span class="hljs-keyword">return</span> lastResult;
    };
  }
}
</code></pre>
<h4 data-id="heading-26">æ€»ç»“</h4>
<p>JavaScriptæ€§èƒ½ä¼˜åŒ–ç¦»ä¸å¼€å¯¹æ•°æ®ç»“æ„å’Œç®—æ³•çš„æ·±å…¥ç†è§£ã€‚æœ¬æ–‡æ¶µç›–äº†ä»åŸºç¡€æ•°æ®ç»“æ„åˆ°é«˜çº§ç®—æ³•ä¼˜åŒ–çš„å®Œæ•´ä½“ç³»ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ•°æ®ç»“æ„é€‰æ‹©ç­–ç•¥:</strong> æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„æ•°æ®ç»“æ„</li>
<li><strong>é“¾è¡¨åŠå…¶å˜ä½“:</strong> å•å‘é“¾è¡¨ã€åŒå‘é“¾è¡¨çš„å®ç°ä¸åº”ç”¨</li>
<li><strong>æ ˆå’Œé˜Ÿåˆ—:</strong> åŸºç¡€å®ç°åŠå…¶åœ¨ç®—æ³•ä¸­çš„åº”ç”¨</li>
<li><strong>æ ‘ç»“æ„:</strong> äºŒå‰æ ‘ã€å¹³è¡¡æ ‘çš„å®ç°ä¸éå†ä¼˜åŒ–</li>
<li><strong>ç¼“å­˜æœºåˆ¶:</strong> LRUç¼“å­˜çš„å®ç°åŸç†</li>
<li><strong>å›¾ç®—æ³•:</strong> éå†ã€æœ€çŸ­è·¯å¾„ç­‰æ ¸å¿ƒç®—æ³•</li>
<li><strong>æ•£åˆ—è¡¨:</strong> å“ˆå¸Œå‡½æ•°è®¾è®¡ä¸å†²çªè§£å†³</li>
<li><strong>æ’åºæœç´¢:</strong> å„ç±»ç®—æ³•çš„æ€§èƒ½æ¯”è¾ƒä¸ä¼˜åŒ–</li>
<li><strong>å®é™…åº”ç”¨:</strong> åœ¨å‰ç«¯æ¡†æ¶å’ŒçŠ¶æ€ç®¡ç†ä¸­çš„å®è·µ</li>
</ol>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œç®—æ³•ã€‚å¯¹äºå¤§å¤šæ•°å‰ç«¯åº”ç”¨ï¼Œåˆç†ä½¿ç”¨Mapã€Setç­‰å†…ç½®æ•°æ®ç»“æ„ï¼Œç»“åˆé€‚å½“çš„ç®—æ³•ä¼˜åŒ–ï¼Œå°±èƒ½æ˜¾è‘—æå‡æ€§èƒ½ã€‚å¯¹äºå¤æ‚åœºæ™¯ï¼Œåˆ™éœ€è¦æ·±å…¥ç†è§£å„ç§æ•°æ®ç»“æ„çš„ç‰¹æ€§ï¼Œåšå‡ºæœ€ä¼˜é€‰æ‹©ã€‚</p>
<p>è®°ä½ï¼Œæ²¡æœ‰ç»å¯¹æœ€ä¼˜çš„æ•°æ®ç»“æ„ï¼Œåªæœ‰åœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„æœ€é€‚åˆé€‰æ‹©ã€‚æŒç»­å­¦ä¹ å’Œå®è·µï¼Œæ‰èƒ½åœ¨æ€§èƒ½ä¼˜åŒ–è¿™æ¡é“è·¯ä¸Šè¶Šèµ°è¶Šè¿œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®ç‚¹çš„â€œç¤¾äº¤è·ç¦»â€ï¼šè¡¡é‡å®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼ä¸å·®å¼‚]]></title>    <link>https://juejin.cn/post/7583403164578431018</link>    <guid>https://juejin.cn/post/7583403164578431018</guid>    <pubDate>2025-12-15T01:37:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583403164578431018" data-draft-id="7583284454165643283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®ç‚¹çš„â€œç¤¾äº¤è·ç¦»â€ï¼šè¡¡é‡å®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼ä¸å·®å¼‚"/> <meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ,æ•°æ®æŒ–æ˜"/> <meta itemprop="datePublished" content="2025-12-15T01:37:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®ç‚¹çš„â€œç¤¾äº¤è·ç¦»â€ï¼šè¡¡é‡å®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼ä¸å·®å¼‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T01:37:53.000Z" title="Mon Dec 15 2025 01:37:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ•°æ®åˆ†æçš„ä¸–ç•Œé‡Œï¼Œ <strong>â€œè·ç¦»â€</strong> ä¸ä»…ä»…æ˜¯åœ°å›¾ä¸Šä¸¤ç‚¹ä¹‹é—´çš„è·¯ç¨‹ã€‚</p>
<p><strong>è·ç¦»</strong> ï¼Œæœ¬è´¨ä¸Šæ˜¯è¡¡é‡ä¸¤ä¸ªäº‹ç‰© <strong>â€œç›¸ä¼¼åº¦â€</strong> çš„å°ºå­ã€‚</p>
<ul>
<li>è·ç¦»è¶Šè¿‘ = ç›¸ä¼¼åº¦è¶Šé«˜</li>
<li>è·ç¦»è¶Šè¿œ = å·®å¼‚è¶Šå¤§</li>
</ul>
<p>å¦‚æœä½ æƒ³åš<strong>ç”¨æˆ·ç”»åƒèšç±»</strong>ã€æƒ³åš<strong>å•†å“æ¨èç³»ç»Ÿ</strong>ï¼Œæˆ–è€…æƒ³è¯†åˆ«<strong>ä¿¡ç”¨å¡æ¬ºè¯ˆäº¤æ˜“</strong>ï¼Œä½ é¦–å…ˆè¦é€‰å¯¹è¿™æŠŠ**â€œå°ºå­â€**ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ å…¨é¢äº†è§£æ•°æ®åˆ†æä¸­å¸¸ç”¨çš„å„ç§è·ç¦»åº¦é‡ï¼Œä»æœ€ç›´è§‚çš„æ¬§æ°è·ç¦»åˆ°å¤æ‚çš„æ—¶é—´åºåˆ—è·ç¦»ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘å°†å®ƒä»¬åˆ†ä¸ºäº†äº”å¤§é—¨æ´¾ã€‚</p>
<h2 data-id="heading-0">1. ç¬¬ä¸€é—¨æ´¾ï¼šå‡ ä½•ç©ºé—´çš„æµ‹é‡è€…</h2>
<p>è¿™ä¸€ç±»è·ç¦»æœ€ç¬¦åˆæˆ‘ä»¬çš„ç›´è§‰ï¼Œé€šå¸¸ç”¨äºå¤„ç†æ•°å€¼å‹æ•°æ®ï¼ˆæ¯”å¦‚èº«é«˜ã€ä½“é‡ã€ç»çº¬åº¦ï¼‰ã€‚</p>
<h3 data-id="heading-1">1.1. æ¬§æ°è·ç¦»ï¼šæœ€ç›´è§‚çš„â€œç›´çº¿è·ç¦»â€</h3>
<p><strong>æ¬§æ°è·ç¦»</strong>å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ <strong>â€œç›´çº¿è·ç¦»â€</strong>ã€‚</p>
<p>åœ¨äºŒç»´å¹³é¢ä¸Šï¼Œä¸¤ç‚¹é—´çš„æ¬§æ°è·ç¦»å°±æ˜¯è¿æ¥å®ƒä»¬çš„ç›´çº¿é•¿åº¦ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å¤–å–é…é€ï¼š</strong> å‡è®¾ä½ æ˜¯æ— äººæœºé€å¤–å–ï¼Œä¸å—é“è·¯é™åˆ¶ï¼Œç›´æ¥é£è¿‡å»ï¼Œè¿™å°±æ˜¯æ¬§æ°è·ç¦»ã€‚</li>
<li><strong>K-Means èšç±»ï¼š</strong> æœ€å¸¸ç”¨çš„è·ç¦»åº¦é‡ã€‚</li>
</ul>
<hr/>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-comment"># åé¢çš„ä»£ç ç¤ºä¾‹å¤šæ¬¡ç”¨åˆ° distanceï¼Œä¸å†é‡å¤å¼•ç”¨äº†</span>
<span class="hljs-keyword">from</span> scipy.spatial <span class="hljs-keyword">import</span> distance

<span class="hljs-comment"># ä¸¤ä¸ªç”¨æˆ·çš„ç‰¹å¾ï¼š[æ´»è·ƒæ—¶é•¿(å°æ—¶), æ¶ˆè´¹é‡‘é¢(å…ƒ)]</span>
user_A = [<span class="hljs-number">2.5</span>, <span class="hljs-number">300</span>]
user_B = [<span class="hljs-number">3.0</span>, <span class="hljs-number">350</span>]

d_euclidean = distance.euclidean(user_A, user_B)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¬§æ°è·ç¦»: <span class="hljs-subst">{d_euclidean:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ¬§æ°è·ç¦»: 50.00
'''</span>
</code></pre>
<p>å›¾å½¢åŒ–æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1e0dca9dfc0439e82ca48beebf418b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766367473&amp;x-signature=1tT5s%2BA7uZw65lJnPVelYh48Fp4%3D" alt="" loading="lazy"/></p>
<p><strong>æ³¨æ„</strong>ï¼šæ¬§æ°è·ç¦»å¯¹æ•°æ®çš„<strong>å°ºåº¦æ•æ„Ÿ</strong>ï¼å¦‚æœç‰¹å¾çš„å•ä½ä¸åŒï¼ˆå¦‚å¹´é¾„å’Œæ”¶å…¥ï¼‰ï¼Œç›´æ¥è®¡ç®—ä¼šå¯¼è‡´æ”¶å…¥ç‰¹å¾ä¸»å¯¼è·ç¦»è®¡ç®—ã€‚</p>
<h3 data-id="heading-2">1.2. æ›¼å“ˆé¡¿è·ç¦»ï¼šåŸå¸‚è¡—åŒºçš„èµ°æ³•</h3>
<p>æƒ³è±¡åœ¨çº½çº¦æ›¼å“ˆé¡¿çš„è¡—é“ä¸Šè¡Œèµ°ï¼Œä½ ä¸èƒ½æ–œç©¿å¤§æ¥¼ï¼Œåªèƒ½æ²¿ç€è¡—é“èµ°ã€‚<strong>æ›¼å“ˆé¡¿è·ç¦»</strong>å°±æ˜¯è¿™ç§ <strong>â€œåŸå¸‚è¡—åŒºè·ç¦»â€</strong>ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>åŸå¸‚ç‰©æµï¼š</strong> çœŸå®çš„å¿«é€’å‘˜é…é€è·¯å¾„ä¼°ç®—ã€‚</li>
<li><strong>é«˜ç»´æ•°æ®ï¼š</strong> åœ¨æŸäº›é«˜ç»´æ•°æ®ä¸­ï¼Œæ›¼å“ˆé¡¿è·ç¦»æ¯”æ¬§æ°è·ç¦»æ›´èƒ½æŠ—å¹²æ‰°ï¼ˆRobustï¼‰ã€‚</li>
</ul>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¤–å–é…é€ç¤ºä¾‹ï¼šä»é¤å…åˆ°é¡¾å®¢çš„è·¯å¾„</span>
restaurant = np.array([<span class="hljs-number">3</span>, <span class="hljs-number">7</span>])  <span class="hljs-comment"># åæ ‡(3,7)</span>
customer = np.array([<span class="hljs-number">8</span>, <span class="hljs-number">2</span>])  <span class="hljs-comment"># åæ ‡(8,2)</span>

euclidean = distance.euclidean(restaurant, customer)
manhattan = distance.cityblock(restaurant, customer)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"é¤å…åˆ°é¡¾å®¢çš„ç›´çº¿è·ç¦»ï¼ˆæ¬§æ°ï¼‰: <span class="hljs-subst">{euclidean:<span class="hljs-number">.2</span>f}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"é¤å…åˆ°é¡¾å®¢çš„è¡—åŒºè·ç¦»ï¼ˆæ›¼å“ˆé¡¿ï¼‰: <span class="hljs-subst">{manhattan:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
é¤å…åˆ°é¡¾å®¢çš„ç›´çº¿è·ç¦»ï¼ˆæ¬§æ°ï¼‰: 7.07
é¤å…åˆ°é¡¾å®¢çš„è¡—åŒºè·ç¦»ï¼ˆæ›¼å“ˆé¡¿ï¼‰: 10.00
'''</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e80494d57e14f8896c677cdf0ebd357~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766367473&amp;x-signature=gilGF96oIG88ploqGGXcdOukPkw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">1.3. åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼šæ£‹ç›˜ä¸Šçš„ç‹è€…</h3>
<p>ä¹Ÿå°±æ˜¯å›½é™…è±¡æ£‹ä¸­â€œå›½ç‹â€ç§»åŠ¨çš„æ­¥æ•°ã€‚å›½ç‹å¯ä»¥æ¨ªç€èµ°ã€ç«–ç€èµ°ï¼Œä¹Ÿèƒ½æ–œç€èµ°ï¼Œä¸”æ­¥æ•°éƒ½ç®— 1ã€‚</p>
<p>å®ƒåªåœ¨ä¹æ•°å€¼å·®æœ€å¤§çš„é‚£ä¸ªç»´åº¦ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ä»“å‚¨ç‰©æµï¼š</strong> é¾™é—¨åŠæŠ“å–è´§ç‰©ï¼Œæ¨ªå‘ç§»åŠ¨å’Œçºµå‘ç§»åŠ¨å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œæ—¶é—´å–å†³äºæœ€è¿œçš„é‚£ä¸ªæ–¹å‘ã€‚</li>
</ul>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">d_chebyshev = distance.chebyshev(user_A, user_B)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ‡æ¯”é›ªå¤«è·ç¦»: <span class="hljs-subst">{d_chebyshev:<span class="hljs-number">.2</span>f}</span>"</span>)
</code></pre>
<h3 data-id="heading-4">1.4. é—µå¯å¤«æ–¯åŸºè·ç¦»ï¼šè·ç¦»çš„é€šç”¨å…¬å¼</h3>
<p>å®ƒæ˜¯ä¸Šé¢ä¸‰ç§è·ç¦»çš„â€œçˆ¸çˆ¸â€ã€‚é€šè¿‡ä¸€ä¸ªå‚æ•° <code>p</code> æ¥æ§åˆ¶ï¼š</p>
<ul>
<li>å½“ p=1 æ—¶ï¼Œå°±æ˜¯<strong>æ›¼å“ˆé¡¿è·ç¦»</strong>ã€‚</li>
<li>å½“ p=2 æ—¶ï¼Œå°±æ˜¯<strong>æ¬§æ°è·ç¦»</strong>ã€‚</li>
<li>å½“ p=âˆ æ—¶ï¼Œå°±æ˜¯<strong>åˆ‡æ¯”é›ªå¤«è·ç¦»</strong>ã€‚</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong> å½“ä½ ä¸ç¡®å®šç”¨å“ªç§å‡ ä½•è·ç¦»æ—¶ï¼Œå¯ä»¥è°ƒèŠ‚ p å€¼æ¥å¯»æ‰¾æœ€ä¼˜è§£ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯¹æ¯”ä¸åŒpå€¼çš„æ•ˆæœ</span>
point1 = np.array([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
point2 = np.array([<span class="hljs-number">3</span>, <span class="hljs-number">4</span>])

p_values = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>]
distances = []

<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> p_values:
    dist = distance.minkowski(point1, point2, p)
    distances.append(dist)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"p=<span class="hljs-subst">{p}</span>: è·ç¦»=<span class="hljs-subst">{dist:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
p=1: è·ç¦»=7.00
p=2: è·ç¦»=5.00
p=3: è·ç¦»=4.50
p=5: è·ç¦»=4.17
p=10: è·ç¦»=4.02
'''</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/095df22d5b554f24bc7ef03c71783af1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766367473&amp;x-signature=WUjXEAcZvDYAiRmDoR9ebJ7MJjQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">2. ç¬¬äºŒé—¨æ´¾ï¼šæ–¹å‘ä¸ç›¸å…³æ€§çš„æ¢ç´¢è€…</h2>
<p>è¿™ä¸€ç±»è·ç¦»ä¸å…³å¿ƒ <strong>â€œæ•°å€¼å¤§å°â€</strong>ï¼Œæ›´å…³å¿ƒ <strong>â€œè¶‹åŠ¿æ–¹å‘â€</strong> æˆ– <strong>â€œç»Ÿè®¡å…³ç³»â€</strong>ã€‚</p>
<h3 data-id="heading-6">2.1. ä½™å¼¦è·ç¦»ï¼šå…³æ³¨æ–¹å‘è€Œéå¤§å°</h3>
<p><strong>ä½™å¼¦è·ç¦»</strong>è¡¡é‡çš„æ˜¯ä¸¤ä¸ªå‘é‡æ–¹å‘çš„å·®å¼‚ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„å¤§å°å·®å¼‚ã€‚</p>
<p>è¿™åœ¨<strong>æ–‡æœ¬åˆ†æ</strong>ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºæ–‡æ¡£çš„é•¿åº¦ä¸åŒï¼Œä½†ä¸»é¢˜å¯èƒ½ç›¸ä¼¼ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æ–‡æœ¬ç›¸ä¼¼åº¦ï¼ˆçƒ­ç‚¹ï¼‰ï¼š</strong> æ¯”å¦‚æ¯”è¾ƒä¸¤ç¯‡æ–‡ç« ã€‚æ–‡ç«  A åªæœ‰ 100 å­—ï¼Œæ–‡ç«  B æœ‰ 10000 å­—ï¼Œè™½ç„¶è¯é¢‘æ•°å€¼å·®å¾ˆå¤§ï¼Œä½†å¦‚æœå®ƒä»¬éƒ½åœ¨è®²â€œäººå·¥æ™ºèƒ½â€ï¼Œå®ƒä»¬çš„æ–¹å‘ï¼ˆè§’åº¦ï¼‰æ˜¯ä¸€è‡´çš„ã€‚</li>
<li><strong>æ¨èç³»ç»Ÿï¼š</strong> ç”¨æˆ·æ‰“åˆ†åå¥½ã€‚</li>
</ul>
<p>ä»£ç ç¤ºä¾‹ï¼šï¼ˆç”¨å‡ ä¸ªç®€å•çš„æ–°é—»æ ‡é¢˜æ¥è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–‡æœ¬å‘é‡ï¼ˆå‡è®¾æ˜¯è¯é¢‘ï¼‰ï¼š[AI, è‹¹æœ, è‚¡ç¥¨]</span>
doc_1 = [<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># ç§‘æŠ€è´¢ç»æ–‡</span>
doc_2 = [<span class="hljs-number">20</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>] <span class="hljs-comment"># é•¿ç¯‡ç§‘æŠ€è´¢ç»æ–‡ï¼ˆæ–¹å‘ä¸€è‡´ï¼‰</span>
doc_3 = [<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>]  <span class="hljs-comment"># æ°´æœæ–‡</span>

<span class="hljs-comment"># ä½™å¼¦è·ç¦» = 1 - ä½™å¼¦ç›¸ä¼¼åº¦</span>
<span class="hljs-comment"># æ¥è¿‘0ï¼Œè¡¨ç¤ºéå¸¸ç›¸ä¼¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŒç±»æ–‡ç« ä½™å¼¦è·ç¦»: <span class="hljs-subst">{distance.cosine(doc_1, doc_2):<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># æ¥è¿‘1ï¼Œè¡¨ç¤ºæ— å…³</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸åŒç±»æ–‡ç« ä½™å¼¦è·ç¦»: <span class="hljs-subst">{distance.cosine(doc_1, doc_3):<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
åŒç±»æ–‡ç« ä½™å¼¦è·ç¦»: 0.00
ä¸åŒç±»æ–‡ç« ä½™å¼¦è·ç¦»: 1.00
'''</span>
</code></pre>
<h3 data-id="heading-7">2.2. ç›¸å…³ç³»æ•°è·ç¦»ï¼šè¡¡é‡çº¿æ€§å…³ç³»</h3>
<p>åŸºäº<strong>çš®å°”é€Šç›¸å…³ç³»æ•°</strong>çš„è·ç¦»ï¼Œè¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§ç›¸å…³æ€§çš„å·®å¼‚ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è‚¡ç¥¨åˆ†æï¼š</strong> è¡¡é‡ä¸¤åªè‚¡ç¥¨çš„èµ°åŠ¿æ˜¯å¦åŒæ­¥ã€‚å¦‚æœä¸€æ”¯æ¶¨å¦ä¸€æ”¯ä¹Ÿæ¶¨ï¼Œå®ƒä»¬çš„ç›¸å…³è·ç¦»å°±å¾ˆå°ï¼Œå“ªæ€•ä¸€ä¸ªè‚¡ä»·æ˜¯ 10 å…ƒï¼Œå¦ä¸€ä¸ªæ˜¯ 1000 å…ƒã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¸¤åªè‚¡ç¥¨è¿‡å»5å¤©çš„æ¶¨è·Œå¹…</span>
stock_A = [<span class="hljs-number">0.1</span>, -<span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">0.0</span>]
stock_B = [<span class="hljs-number">0.2</span>, -<span class="hljs-number">0.4</span>, <span class="hljs-number">0.6</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.0</span>] <span class="hljs-comment"># èµ°åŠ¿å®Œå…¨ä¹Ÿå°±æ˜¯2å€å…³ç³»</span>

d_correlation = distance.correlation(stock_A, stock_B)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç›¸å…³ç³»æ•°è·ç¦»: <span class="hljs-subst">{d_correlation:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœ</span>
<span class="hljs-string">'''
ç›¸å…³ç³»æ•°è·ç¦»: 0.00
'''</span>
</code></pre>
<p>å¯ä»¥å°è¯•è°ƒæ•´è°ƒæ•´<code>stock_A</code>å’Œ<code>stock_B</code>çš„æ•°å€¼ï¼Œå†çœ‹çœ‹ç›¸å…³ç³»æ•°çš„å˜åŒ–ã€‚</p>
<h3 data-id="heading-8">2.3. é©¬æ°è·ç¦»ï¼šè€ƒè™‘æ•°æ®åˆ†å¸ƒçš„è·ç¦»</h3>
<p><strong>é©¬æ°è·ç¦»</strong>è€ƒè™‘äº†æ•°æ®çš„åæ–¹å·®ç»“æ„ï¼Œæ˜¯ä¸€ç§å°ºåº¦æ— å…³ä¸”æ’é™¤äº†ç‰¹å¾ç›¸å…³æ€§çš„è·ç¦»åº¦é‡ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å¼‚å¸¸æ£€æµ‹ï¼š</strong> å‡è®¾ä½ ç»Ÿè®¡äººçš„èº«é«˜å’Œä½“é‡ã€‚å¦‚æœä½ ç”¨æ¬§æ°è·ç¦»ï¼Œä¸€ä¸ª 190cmã€50kg çš„äººå¯èƒ½ç¦»ä¸­å¿ƒç‚¹ä¸è¿œã€‚ä½†è€ƒè™‘åˆ°èº«é«˜ä½“é‡çš„æ­£ç›¸å…³æ€§ï¼ˆé«˜çš„äººé€šå¸¸é‡ï¼‰ï¼Œè¿™ä¸ªæ•°æ®ç‚¹åœ¨é©¬æ°è·ç¦»ä¸‹å°±ä¼šéå¸¸è¿œï¼ˆéå¸¸å¼‚å¸¸ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éœ€è¦å…ˆè®¡ç®—åæ–¹å·®çŸ©é˜µçš„é€†</span>
np.random.seed(<span class="hljs-number">42</span>)
height = np.random.normal(<span class="hljs-number">170</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>)  <span class="hljs-comment"># 20ä¸ªèº«é«˜æ ·æœ¬</span>
weight = height * <span class="hljs-number">0.5</span> + np.random.normal(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)  <span class="hljs-comment"># ä½“é‡ä¸èº«é«˜ç›¸å…³</span>
data = np.column_stack([height, weight])

cov_matrix = np.cov(data.T)
inv_cov_matrix = np.linalg.inv(cov_matrix)

point_1 = [<span class="hljs-number">170</span>, <span class="hljs-number">60</span>] <span class="hljs-comment"># æ­£å¸¸ç‚¹</span>
point_2 = [<span class="hljs-number">190</span>, <span class="hljs-number">50</span>] <span class="hljs-comment"># å¼‚å¸¸ç‚¹ï¼ˆåˆé«˜åˆç˜¦ï¼‰</span>

d_mah_1 = distance.mahalanobis(point_1, np.mean(data, axis=<span class="hljs-number">0</span>), inv_cov_matrix)
d_mah_2 = distance.mahalanobis(point_2, np.mean(data, axis=<span class="hljs-number">0</span>), inv_cov_matrix)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£å¸¸ç‚¹é©¬æ°è·ç¦»: <span class="hljs-subst">{d_mah_1:<span class="hljs-number">.2</span>f}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼‚å¸¸ç‚¹é©¬æ°è·ç¦»: <span class="hljs-subst">{d_mah_2:<span class="hljs-number">.2</span>f}</span>"</span>) <span class="hljs-comment"># è·ç¦»ä¼šå¾ˆå¤§</span>

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ­£å¸¸ç‚¹é©¬æ°è·ç¦»: 4.93
å¼‚å¸¸ç‚¹é©¬æ°è·ç¦»: 9.06
'''</span>
</code></pre>
<h2 data-id="heading-9">3. ç¬¬ä¸‰é—¨æ´¾ï¼šé›†åˆä¸åˆ†ç±»çš„è£åˆ¤</h2>
<p>å½“æ•°æ®ä¸æ˜¯æ•°å­—ï¼Œè€Œæ˜¯åˆ†ç±»ã€æ ‡ç­¾æˆ–å­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬ç”¨è¿™äº›ã€‚</p>
<h3 data-id="heading-10">3.1. æ°å¡å¾·è·ç¦»ï¼šé›†åˆçš„ç›¸ä¼¼åº¦</h3>
<p>æ°å¡å¾·è·ç¦»è¡¡é‡ä¸¤ä¸ªé›†åˆçš„å·®å¼‚ç¨‹åº¦ï¼Œé€šè¿‡è®¡ç®—äº¤é›†ä¸å¹¶é›†çš„æ¯”ä¾‹å¾—åˆ°ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ç”µå•†æ¨èï¼š</strong> ç”¨æˆ· A ä¹°äº† {è‹¹æœ, é¦™è•‰}ï¼Œç”¨æˆ· B ä¹°äº† {è‹¹æœ, é¦™è•‰, è¥¿ç“œ}ã€‚é€šè¿‡æ°å¡å¾·è·ç¦»è®¡ç®—ä»–ä»¬çš„è´­ä¹°é‡åˆåº¦ï¼Œè¿›è€Œæ¨èå•†å“ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python">d_jaccard = distance.jaccard([<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) <span class="hljs-comment"># boolean vector</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ°å¡å¾·è·ç¦»: <span class="hljs-subst">{d_jaccard:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ°å¡å¾·è·ç¦»: 0.33
'''</span>
</code></pre>
<h3 data-id="heading-11">3.2. æ±‰æ˜è·ç¦»ï¼šå­—ç¬¦ä¸²çš„å·®å¼‚åº¦é‡</h3>
<p><strong>æ±‰æ˜è·ç¦»</strong>è¡¡é‡ä¸¤ä¸ªç­‰é•¿å­—ç¬¦ä¸²åœ¨å¯¹åº”ä½ç½®ä¸Šä¸åŒå­—ç¬¦çš„æ•°é‡ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æ‹¼å†™çº é”™ï¼š</strong> "banana" å’Œ "banane"ï¼Œåªæœ‰ä¸€ä¸ªå­—æ¯ä¸åŒï¼Œæ±‰æ˜è·ç¦»ä¸º 1ã€‚</li>
<li><strong>ä¿¡æ¯ç¼–ç ï¼š</strong> é€šä¿¡ä¸­æ£€æµ‹æ•°æ®ä¼ è¾“æ˜¯å¦å‡ºé”™ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python">d_hamming = distance.hamming([<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ±‰æ˜è·ç¦»: <span class="hljs-subst">{d_hamming:<span class="hljs-number">.2</span>f}</span>"</span>) <span class="hljs-comment"># è¾“å‡ºæ¯”ä¾‹ï¼Œæœ‰äº›åº“è¾“å‡ºä¸ªæ•°</span>

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
æ±‰æ˜è·ç¦»: 0.33
'''</span>
</code></pre>
<h3 data-id="heading-12">3.3. ç¼–è¾‘è·ç¦»ï¼šå­—ç¬¦ä¸²è½¬æ¢çš„ä»£ä»·</h3>
<p><strong>ç¼–è¾‘è·ç¦»</strong>ï¼ˆ<code>Levenshtein</code>è·ç¦»ï¼‰è¡¡é‡å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²æ‰€éœ€çš„æœ€å°‘å•å­—ç¬¦ç¼–è¾‘æ“ä½œæ¬¡æ•°ï¼ˆæ’å…¥ã€åˆ é™¤ã€æ›¿æ¢ï¼‰ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æœç´¢å¼•æ“ï¼š</strong> ä½ è¾“é”™å•è¯æ—¶ï¼Œç™¾åº¦/è°·æ­Œæç¤ºâ€œæ‚¨æ˜¯ä¸æ˜¯è¦æ‰¾...â€ï¼Œå°±æ˜¯é€šè¿‡ç¼–è¾‘è·ç¦»æ‰¾åˆ°æœ€æ¥è¿‘çš„æ­£ç¡®è¯ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ³¨ï¼šæ ‡å‡†åº“æ— æ­¤å‡½æ•°ï¼Œé€šå¸¸ç”¨ pip install Levenshtein æˆ–è‡ªå®šä¹‰</span>
<span class="hljs-comment"># è¿™é‡Œç”¨ç®€å•çš„é€»è¾‘æ¼”ç¤ºæ¦‚å¿µ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">simple_levenshtein</span>(<span class="hljs-params">s1, s2</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s1) &lt; <span class="hljs-built_in">len</span>(s2):
        <span class="hljs-keyword">return</span> simple_levenshtein(s2, s1)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s2) == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(s1)
    previous_row = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s2) + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">for</span> i, c1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s1):
        current_row = [i + <span class="hljs-number">1</span>]
        <span class="hljs-keyword">for</span> j, c2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s2):
            insertions = previous_row[j + <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>
            deletions = current_row[j] + <span class="hljs-number">1</span>
            substitutions = previous_row[j] + (c1 != c2)
            current_row.append(<span class="hljs-built_in">min</span>(insertions, deletions, substitutions))
        previous_row = current_row
    <span class="hljs-keyword">return</span> previous_row[-<span class="hljs-number">1</span>]

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¼–è¾‘è·ç¦» ('kitten', 'sitting'): <span class="hljs-subst">{simple_levenshtein(<span class="hljs-string">'kitten'</span>, <span class="hljs-string">'sitting'</span>)}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
ç¼–è¾‘è·ç¦» ('kitten', 'sitting'): 3
'''</span>
</code></pre>
<h2 data-id="heading-13">4. ç¬¬å››é—¨æ´¾ï¼šåˆ†å¸ƒå·®å¼‚çš„é‰´å®šå¸ˆ</h2>
<p>ç”¨äºè¡¡é‡ä¸¤ä¸ªâ€œæ¦‚ç‡åˆ†å¸ƒâ€ï¼ˆæ¯”å¦‚ä¸¤ä¸ªç›´æ–¹å›¾ï¼‰æœ‰å¤šåƒã€‚è¿™åœ¨æœºå™¨å­¦ä¹ å’Œç”Ÿæˆå¼ AI ä¸­éå¸¸ç«ã€‚</p>
<h3 data-id="heading-14">4.1. KL æ•£åº¦ï¼šè¡¡é‡æ¦‚ç‡åˆ†å¸ƒå·®å¼‚</h3>
<p><strong>KLæ•£åº¦</strong>è¡¡é‡ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒä¸å¦ä¸€ä¸ªå‚è€ƒåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼Œä½†ä¸æ˜¯å¯¹ç§°çš„ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æœºå™¨å­¦ä¹ è®­ç»ƒï¼š</strong> è¡¡é‡æ¨¡å‹é¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒä¸çœŸå®æ ‡ç­¾åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼ˆLoss Functionï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> entropy
p = [<span class="hljs-number">0.1</span>, <span class="hljs-number">0.9</span>] <span class="hljs-comment"># çœŸå®åˆ†å¸ƒ</span>
q = [<span class="hljs-number">0.2</span>, <span class="hljs-number">0.8</span>] <span class="hljs-comment"># é¢„æµ‹åˆ†å¸ƒ</span>
kl_div = entropy(p, q)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"KLæ•£åº¦: <span class="hljs-subst">{kl_div:<span class="hljs-number">.4</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
KLæ•£åº¦: 0.0367
'''</span>
</code></pre>
<h3 data-id="heading-15">4.2. JS æ•£åº¦ï¼šè¡¡é‡æ¦‚ç‡åˆ†å¸ƒå·®å¼‚-å¯¹ç§°</h3>
<p><strong>JSæ•£åº¦</strong>æ˜¯<strong>KLæ•£åº¦</strong>çš„å¯¹ç§°ç‰ˆæœ¬ï¼Œå€¼åŸŸå›ºå®šã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>GAN (ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ)ï¼š</strong> æ—©æœŸç”¨äºè¡¡é‡ç”Ÿæˆå›¾ç‰‡åˆ†å¸ƒä¸çœŸå®å›¾ç‰‡åˆ†å¸ƒçš„ç›¸ä¼¼åº¦ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python">d_js = distance.jensenshannon(p, q)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"JSæ•£åº¦: <span class="hljs-subst">{d_js:<span class="hljs-number">.4</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
JSæ•£åº¦: 0.0998
'''</span>
</code></pre>
<h3 data-id="heading-16">4.3. Wasserstein è·ç¦»ï¼šåœ°çƒæ¬è¿è·ç¦»</h3>
<p><strong>Wassersteinè·ç¦»</strong>è¡¡é‡å°†ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒ"æ¬è¿"æˆå¦ä¸€ä¸ªæ‰€éœ€çš„æœ€å°å·¥ä½œé‡ï¼Œç›´è§‚ç†è§£æ˜¯å°†ä¸€å †æ²™å­å˜æˆæŒ‡å®šå½¢çŠ¶æ‰€éœ€çš„æœ€å°ç§»åŠ¨è·ç¦»ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å›¾åƒç”Ÿæˆ (WGAN)ï¼š</strong> å³ä½¿ä¸¤ä¸ªåˆ†å¸ƒå®Œå…¨ä¸é‡å ï¼ˆKL æ•£åº¦ä¼šå¤±æ•ˆï¼‰ï¼ŒWasserstein è·ç¦»ä¹Ÿèƒ½ç»™å‡ºåˆç†çš„æ•°å€¼ï¼ŒæŒ‡å¯¼ AI å­¦ä¹ ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> wasserstein_distance
d_wasserstein = wasserstein_distance([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Wassersteinè·ç¦»: <span class="hljs-subst">{d_wasserstein:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
Wassersteinè·ç¦»: 5.00
'''</span>
</code></pre>
<h2 data-id="heading-17">5. ç¬¬äº”é—¨æ´¾ï¼šæ—¶é—´åºåˆ—çš„å˜å½¢è€…</h2>
<h3 data-id="heading-18">5.1. DTW è·ç¦»ï¼šæ—¶é—´åºåˆ—çš„å¼¹æ€§åŒ¹é…</h3>
<p><strong>åŠ¨æ€æ—¶é—´è§„æ•´</strong>ï¼ˆ<code>DTW</code>ï¼‰è·ç¦»å…è®¸æ—¶é—´è½´ä¼¸ç¼©å¼¯æ›²ï¼Œç”¨äºè¡¡é‡ä¸¤ä¸ªæ—¶é—´åºåˆ—çš„ç›¸ä¼¼æ€§ï¼Œå³ä½¿å®ƒä»¬åœ¨æ—¶é—´è½´ä¸Šä¸å®Œå…¨å¯¹é½ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è¯­éŸ³è¯†åˆ«/è‚¡ç¥¨åˆ†æï¼š</strong> ä¸¤ä¸ªäººè¯»åŒä¸€ä¸ªå•è¯ "Hello"ã€‚
<ul>
<li>äºº Aï¼šH-e-l-l-o (è¯­é€Ÿå¿«)</li>
<li>äºº Bï¼šH-e-e-e-l-l-o-o (è¯­é€Ÿæ…¢)</li>
<li>æ¬§æ°è·ç¦»ä¼šè®¤ä¸ºè¿™å®Œå…¨ä¸åŒï¼Œä½† DTW ä¼šæŠŠæ—¶é—´è½´â€œå¯¹é½â€ï¼Œå‘ç°å®ƒä»¬å…¶å®å¾ˆåƒã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç®€å•çš„DTWæ¦‚å¿µä»£ç ï¼ˆå®é™…åº”ç”¨æ¨èä½¿ç”¨ fastdtw åº“ï¼‰</span>
<span class="hljs-keyword">from</span> scipy.spatial.distance <span class="hljs-keyword">import</span> euclidean

<span class="hljs-keyword">def</span> <span class="hljs-title function_">dtw_distance</span>(<span class="hljs-params">s1, s2</span>):
    n, m = <span class="hljs-built_in">len</span>(s1), <span class="hljs-built_in">len</span>(s2)
    dtw_matrix = np.zeros((n+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>))
    dtw_matrix[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>:] = np.inf
    dtw_matrix[<span class="hljs-number">1</span>:, <span class="hljs-number">0</span>] = np.inf

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>):
            cost = <span class="hljs-built_in">abs</span>(s1[i-<span class="hljs-number">1</span>] - s2[j-<span class="hljs-number">1</span>])
            dtw_matrix[i, j] = cost + <span class="hljs-built_in">min</span>(dtw_matrix[i-<span class="hljs-number">1</span>, j],    <span class="hljs-comment"># æ’å…¥</span>
                                          dtw_matrix[i, j-<span class="hljs-number">1</span>],    <span class="hljs-comment"># åˆ é™¤</span>
                                          dtw_matrix[i-<span class="hljs-number">1</span>, j-<span class="hljs-number">1</span>])  <span class="hljs-comment"># åŒ¹é…</span>
    <span class="hljs-keyword">return</span> dtw_matrix[n, m]

ts_1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]
ts_2 = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>] <span class="hljs-comment"># åŒæ ·è¶‹åŠ¿ï¼Œä½†å¤šäº†é‡å¤ï¼ˆæ…¢åŠ¨ä½œï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"DTWè·ç¦»: <span class="hljs-subst">{dtw_distance(ts_1, ts_2)}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œç»“æœï¼š</span>
<span class="hljs-string">'''
DTWè·ç¦»: 0.0
'''</span>
</code></pre>
<h2 data-id="heading-19">6. æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©ä½ çš„â€œå°ºå­â€ï¼Ÿ</h2>
<p>é¢å¯¹æ–°æ•°æ®ï¼Œåˆ«ç›²ç›®é€‰æ¬§æ°è·ç¦»ï¼Œå‚è€ƒä¸‹é¢çš„å»ºè®®ï¼š</p>
<ol>
<li><strong>æ™®é€šæ•°å€¼æ•°æ®ï¼Œçœ‹ç»å¯¹å¤§å°ï¼š</strong> é€‰ <strong>æ¬§æ°</strong> æˆ– <strong>æ›¼å“ˆé¡¿</strong>ã€‚</li>
<li><strong>çœ‹é‡æ–¹å‘/å–œå¥½ï¼Œå¿½ç•¥ç»å¯¹æ•°å€¼ï¼š</strong> é€‰ <strong>ä½™å¼¦è·ç¦»</strong>ï¼ˆå¦‚æ–‡æœ¬ã€æ¨èï¼‰ã€‚</li>
<li><strong>çœ‹é‡è¶‹åŠ¿å˜åŒ–ï¼Œå¿½ç•¥æ•°å€¼å¤§å°ï¼š</strong> é€‰ <strong>ç›¸å…³ç³»æ•°è·ç¦»</strong>ï¼ˆå¦‚è‚¡ç¥¨ï¼‰ã€‚</li>
<li><strong>æ•°æ®ç›¸å…³æ€§å¼ºï¼Œä¸”æœ‰ç¦»ç¾¤ç‚¹ï¼š</strong> é€‰ <strong>é©¬æ°è·ç¦»</strong>ã€‚</li>
<li><strong>é›†åˆã€æ ‡ç­¾ç±»æ•°æ®ï¼š</strong> é€‰ <strong>æ°å¡å¾·</strong> æˆ– <strong>æ±‰æ˜</strong>ã€‚</li>
<li><strong>æ¦‚ç‡åˆ†å¸ƒå¯¹æ¯”ï¼ˆAI æ¨¡å‹ï¼‰ï¼š</strong> é€‰ <strong>KL</strong> æˆ– <strong>Wasserstein</strong>ã€‚</li>
<li><strong>é•¿çŸ­ä¸ä¸€çš„æ—¶é—´åºåˆ—ï¼š</strong> é€‰ <strong>DTW</strong>ã€‚</li>
</ol>
<p>æ–‡ä¸­ä»£ç ä¸­å¤§éƒ¨åˆ†çš„<strong>è·ç¦»</strong>å…³é”®æ˜¯æŒæ¡å…¶<strong>æ¦‚å¿µ</strong>å’Œ<strong>åº”ç”¨åœºæ™¯</strong>ï¼Œè‡³äºå…¶è·ç¦»ç®—æ³•çš„å®ç°ï¼Œ<code>scipy</code>åº“ä¸­å¤§éƒ¨åˆ†éƒ½æœ‰å°è£…å¥½çš„å‡½æ•°ï¼Œå³ä½¿æ²¡æœ‰ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶ä»–åº“æ¥ä»£æ›¿ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•é¿å…MySQLæ­»é”ï¼Ÿèµ„æ·±DBAçš„9æ¡é»„é‡‘æ³•åˆ™]]></title>    <link>https://juejin.cn/post/7583799807593840674</link>    <guid>https://juejin.cn/post/7583799807593840674</guid>    <pubDate>2025-12-15T09:47:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583799807593840674" data-draft-id="7576487832089722895" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•é¿å…MySQLæ­»é”ï¼Ÿèµ„æ·±DBAçš„9æ¡é»„é‡‘æ³•åˆ™"/> <meta itemprop="keywords" content="åç«¯,MySQL"/> <meta itemprop="datePublished" content="2025-12-15T09:47:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•é¿å…MySQLæ­»é”ï¼Ÿèµ„æ·±DBAçš„9æ¡é»„é‡‘æ³•åˆ™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T09:47:30.000Z" title="Mon Dec 15 2025 09:47:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å¤§åï¼</p>
<p>æ­»é”æ˜¯æ•°æ®åº“é‡Œå¾ˆå¸¸è§çš„é—®é¢˜ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”ï¼Œç»“æœè°ä¹ŸåŠ¨ä¸äº†ã€‚</p>
<p>MySQLçš„InnoDBå¼•æ“ä¼šè‡ªå·±è‡ªåŠ¨æ£€æµ‹æ­»é”ï¼Œå¹¶ä¸”å›æ»šå…¶ä¸­ä¸€ä¸ªäº‹åŠ¡æ¥è§£å†³ï¼Œä½†è¿™ç§æƒ…å†µå¦‚æœç»å¸¸é‡åˆ°çš„è¯ï¼Œä¼šå¾ˆå½±å“æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p>
<p>å…¶å®ï¼Œåªè¦æ³¨æ„ä¸€äº›è®¾è®¡ç»†èŠ‚ï¼Œå°±èƒ½å¤§å¤§å‡å°‘ç”šè‡³é¿å…æ­»é”ã€‚</p>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªæœ€å®ç”¨çš„æ–¹æ³•ï¼š</p>
<hr/>
<h3 data-id="heading-0">1. äº‹åŠ¡è¦çŸ­ï¼ŒåŠ¨ä½œè¦å¿«</h3>
<p>äº‹åŠ¡è¶Šé•¿ï¼Œé”ä½æ•°æ®çš„æ—¶é—´å°±è¶Šä¹…ï¼Œåˆ«äººå°±è¶Šå®¹æ˜“â€œæ’ä¸Šâ€ä½ ã€‚</p>
<p><strong>æ­£ç¡®åšæ³•</strong>ï¼šåªåœ¨äº‹åŠ¡é‡Œåšå¿…è¦çš„æ•°æ®åº“æ“ä½œï¼Œåˆ«æŠŠä¸šåŠ¡é€»è¾‘ï¼ˆæ¯”å¦‚è°ƒæ¥å£ã€ç®—æ•°æ®ï¼‰å¡è¿›å»ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä¸æ¨èï¼šäº‹åŠ¡ä¸­æ··æ‚ä¸šåŠ¡é€»è¾‘</span>
<span class="hljs-keyword">START</span> TRANSACTION;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-comment">-- å‡è®¾æ­¤å¤„æœ‰è€—æ—¶çš„ä¸šåŠ¡å¤„ç†...</span>
<span class="hljs-keyword">UPDATE</span> accounts <span class="hljs-keyword">SET</span> balance <span class="hljs-operator">=</span> balance <span class="hljs-operator">-</span> <span class="hljs-number">100</span> <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">UPDATE</span> orders <span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'paid'</span> <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- æ¨èï¼šäº‹åŠ¡åªåŒ…å«å¿…è¦æ•°æ®åº“æ“ä½œ</span>
<span class="hljs-keyword">START</span> TRANSACTION;
<span class="hljs-keyword">UPDATE</span> accounts <span class="hljs-keyword">SET</span> balance <span class="hljs-operator">=</span> balance <span class="hljs-operator">-</span> <span class="hljs-number">100</span> <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">UPDATE</span> orders <span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'paid'</span> <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">COMMIT</span>;
</code></pre>
<hr/>
<h3 data-id="heading-1">2. æ‰€æœ‰äº‹åŠ¡æŒ‰åŒä¸€ä¸ªé¡ºåºæ“ä½œè¡¨</h3>
<p>è¿™æ˜¯é¿å…æ­»é”æœ€æœ‰æ•ˆçš„ä¸€æ‹›ï¼</p>
<p>æ¯”å¦‚ï¼šå¦‚æœå¤šä¸ªäº‹åŠ¡éƒ½è¦æ”¹ <code>users</code> å’Œ <code>orders</code> è¡¨ï¼Œé‚£å°±<strong>ç»Ÿä¸€å…ˆæ”¹ usersï¼Œå†æ”¹ orders</strong>ã€‚ä¸è¦æœ‰çš„å…ˆæ”¹ usersï¼Œæœ‰çš„å…ˆæ”¹ ordersã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ‰€æœ‰åœ°æ–¹éƒ½è¿™æ ·å†™ï¼š</span>
<span class="hljs-keyword">UPDATE</span> users <span class="hljs-keyword">SET</span> ... <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">UPDATE</span> orders <span class="hljs-keyword">SET</span> ... <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>
<p>åªè¦é¡ºåºä¸€è‡´ï¼Œå°±ä¸ä¼šå‡ºç°â€œAç­‰Bã€Bç­‰Aâ€çš„å¾ªç¯ç­‰å¾…ã€‚</p>
<hr/>
<h3 data-id="heading-2">3. ç»™è¡¨åŠ åˆé€‚çš„ç´¢å¼•</h3>
<p>InnoDB çš„è¡Œé”æ˜¯é ç´¢å¼•æ¥å®ç°çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡ç”¨åˆ°ç´¢å¼•ï¼ŒMySQL å°±å¯èƒ½é”ä½æ•´å¼ è¡¨ï¼ˆæˆ–å¾ˆå¤šæ— å…³çš„è¡Œï¼‰ï¼Œå¤§å¤§å¢åŠ æ­»é”é£é™©ã€‚</p>
<p><strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>ç»å¸¸ç”¨æ¥æŸ¥æˆ–æ›´æ–°çš„å­—æ®µï¼ˆæ¯”å¦‚ <code>user_id</code>ï¼‰è¦å»ºç´¢å¼•ã€‚</li>
<li>ç”¨ <code>EXPLAIN</code> çœ‹çœ‹ SQL æ˜¯å¦å‘½ä¸­ç´¢å¼•ã€‚</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> INDEX idx_user_id <span class="hljs-keyword">ON</span> orders(user_id);
</code></pre>
<hr/>
<h3 data-id="heading-3">4. åˆ«ç”¨å¤ªé«˜çš„éš”ç¦»çº§åˆ«ï¼ˆé™¤éå¿…è¦ï¼‰</h3>
<p>MySQL é»˜è®¤æ˜¯ <code>REPEATABLE READ</code>ï¼Œå®ƒä¼šåŠ â€œé—´éš™é”â€ï¼Œé˜²æ­¢å¹»è¯»ï¼Œä½†ä¹Ÿæ›´å®¹æ˜“æ­»é”ã€‚</p>
<p>å¦‚æœä½ çš„ä¸šåŠ¡èƒ½æ¥å—â€œè¯»å·²æäº¤â€ï¼ˆæ¯”å¦‚å…è®¸çœ‹åˆ°åˆ«äººåˆšæäº¤çš„æ•°æ®ï¼‰ï¼Œå¯ä»¥æ”¹æˆï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;
</code></pre>
<p>è¿™æ ·é”çš„èŒƒå›´æ›´å°ï¼Œæ­»é”æ¦‚ç‡æ›´ä½ã€‚</p>
<hr/>
<h3 data-id="heading-4">5. æ˜¾å¼åŠ é”æ—¶è¦å°å¿ƒ</h3>
<p>å¦‚æœä½ è¦ç”¨ <code>SELECT ... FOR UPDATE</code> é”è¡Œï¼Œä¸€å®šè¦ç¡®ä¿ï¼š</p>
<ul>
<li>æ¡ä»¶èƒ½å‘½ä¸­ç´¢å¼•ï¼›</li>
<li>é”çš„è¡Œå°½é‡å°‘ï¼›</li>
<li>äº‹åŠ¡å°½å¿«ç»“æŸã€‚</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å®‰å…¨ï¼šé€šè¿‡ä¸»é”®æˆ–ç´¢å¼•é”å®šä¸€è¡Œ</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> accounts <span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">UPDATE</span>;
</code></pre>
<p>å¦‚æœ <code>user_id</code> æ²¡ç´¢å¼•ï¼Œè¿™æ¡è¯­å¥å¯èƒ½é”ä½æˆåƒä¸Šä¸‡è¡Œï¼</p>
<hr/>
<h3 data-id="heading-5">6. åº”ç”¨å±‚è¦æœ‰é‡è¯•æœºåˆ¶</h3>
<p>æ­»é”å¶å°”è¿˜æ˜¯ä¼šå‘ç”Ÿã€‚è¿™æ—¶å€™ï¼Œåº”ç”¨åº”è¯¥ï¼š</p>
<ul>
<li>æ•è·æ­»é”é”™è¯¯ï¼ˆMySQL é”™è¯¯ç  1213 æˆ– SQLSTATE '40001'ï¼‰ï¼›</li>
<li>è‡ªåŠ¨é‡è¯•å‡ æ¬¡ï¼ˆæ¯”å¦‚æœ€å¤š 2~3 æ¬¡ï¼‰ï¼›</li>
<li>æ¯æ¬¡é‡è¯•å‰ç­‰ä¸€å°ä¼šå„¿ï¼ˆæ¯”å¦‚ 100msã€200msâ€¦ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    <span class="hljs-keyword">try</span> {
        doDatabaseUpdate();
        <span class="hljs-keyword">break</span>; <span class="hljs-comment">// æˆåŠŸå°±é€€å‡º</span>
    } <span class="hljs-keyword">catch</span> (DeadlockException e) {
        sleep(<span class="hljs-number">100</span> * (i + <span class="hljs-number">1</span>)); <span class="hljs-comment">// ç­‰ä¸€ä¸‹å†è¯•</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-6">7. å¤§æ‰¹é‡æ›´æ–°è¦åˆ†æ‰¹åš</h3>
<p>ä¸€æ¬¡æ›´æ–°å‡ ä¸‡è¡Œï¼Ÿè¿™å¾ˆå®¹æ˜“é”ä½å¤§é‡æ•°æ®ï¼Œå¼•å‘æ­»é”æˆ–å¡é¡¿ã€‚</p>
<p><strong>æ­£ç¡®åšæ³•</strong>ï¼šæ¯æ¬¡åªæ”¹ 500~1000 è¡Œï¼Œæ”¹å®Œæäº¤ï¼Œå†ç»§ç»­ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ†æ‰¹æ›´æ–°</span>
<span class="hljs-keyword">UPDATE</span> large_table <span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'done'</span>
<span class="hljs-keyword">WHERE</span> create_time <span class="hljs-operator">&lt;</span> <span class="hljs-string">'2023-01-01'</span> <span class="hljs-keyword">AND</span> status <span class="hljs-operator">!=</span> <span class="hljs-string">'done'</span>
LIMIT <span class="hljs-number">1000</span>;
<span class="hljs-comment">-- å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°æ²¡æœ‰æ•°æ®å¯æ›´æ–°</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">8. é¿å…çƒ­ç‚¹æ•°æ®è¢«é¢‘ç¹ä¿®æ”¹</h3>
<p>æ¯”å¦‚ä¸€ä¸ªå…¨å±€è®¡æ•°å™¨ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å» <code>UPDATE counter SET value = value + 1</code>ï¼Œé‚£è¿™ä¸€è¡Œå°±æˆäº†å µç‚¹ã€‚</p>
<p><strong>è§£å†³åŠæ³•</strong>ï¼šç”¨åˆ†æ¡¶è®¡æ•°ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŠŠè®¡æ•°åˆ†æ•£åˆ° 10 ä¸ªæ¡¶é‡Œ</span>
<span class="hljs-keyword">UPDATE</span> counter_buckets <span class="hljs-keyword">SET</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span> 
<span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'views'</span> <span class="hljs-keyword">AND</span> bucket <span class="hljs-operator">=</span> <span class="hljs-built_in">FLOOR</span>(RAND() <span class="hljs-operator">*</span> <span class="hljs-number">10</span>);

<span class="hljs-comment">-- æŸ¥æ€»æ•°æ—¶å†åŠ èµ·æ¥</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">FROM</span> counter_buckets <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'views'</span>;
</code></pre>
<hr/>
<h3 data-id="heading-8">9. å‡ºé—®é¢˜äº†æ€ä¹ˆæŸ¥ï¼Ÿ</h3>
<p>çœ‹æœ€è¿‘ä¸€æ¬¡æ­»é”è¯¦æƒ…ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> ENGINE INNODB STATUS;
</code></pre>
<p>æ‰¾<code>LATEST DETECTED DEADLOCK</code>éƒ¨åˆ†ã€‚</p>
<p>æŸ¥å½“å‰æ­£åœ¨è¿è¡Œçš„äº‹åŠ¡ï¼ˆMySQL 8.0+ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> performance_schema.data_locks;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> information_schema.INNODB_TRX;
</code></pre>
<hr/>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>1.<strong>äº‹åŠ¡è¦çŸ­</strong>ï¼šåˆ«æ‹–ç€ä¸æäº¤ã€‚
2.<strong>é¡ºåºè¦ä¸€è‡´</strong>ï¼šæ‰€æœ‰äººæŒ‰ç›¸åŒé¡ºåºæ”¹è¡¨ã€‚
3.<strong>ç´¢å¼•è¦åˆ°ä½</strong>ï¼šé¿å…é”å¤ªå¤šæ— å…³æ•°æ®ã€‚
4.<strong>å‡ºé”™è¦é‡è¯•</strong>ï¼šåº”ç”¨å±‚å…œåº•å¤„ç†æ­»é”ã€‚
5.<strong>å¤§æ‰¹é‡è¦åˆ†æ‰¹</strong>ï¼šåˆ«ä¸€æ¬¡é”å¤ªå¤šè¡Œã€‚</p>
<p>æ­»é”æ²¡æ³•å®Œå…¨æœç»ï¼Œä½†åªè¦åšå¥½è¿™äº›ï¼ŒåŸºæœ¬å°±ä¸ä¼šå†è¢«å®ƒå›°æ‰°äº†ï¼</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-10">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6V83qjR6u0nyfzL-14xYAw" target="_blank" title="https://mp.weixin.qq.com/s/6V83qjR6u0nyfzL-14xYAw" ref="nofollow noopener noreferrer">ã€Šasync/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FbgLoyqb3VLgn3xXAok3kcQ" target="_blank" title="https://mp.weixin.qq.com/s/bgLoyqb3VLgn3xXAok3kcQ" ref="nofollow noopener noreferrer">ã€Šå¦‚ä½•æŸ¥çœ‹ SpringBoot å½“å‰çº¿ç¨‹æ•°ï¼Ÿ3 ç§æ–¹æ³•äº²æµ‹æœ‰æ•ˆã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FDpjuafW3agyhLEQYif3zJA" target="_blank" title="https://mp.weixin.qq.com/s/DpjuafW3agyhLEQYif3zJA" ref="nofollow noopener noreferrer">ã€Šåˆ«å†ä¹± new ArrayListï¼8 å¤§ Java å®¹å™¨é€‰å‹æ¡ˆä¾‹ï¼Œä¸€ç¯‡çœ‹æ‡‚ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js ç¼–ç¨‹å®æˆ˜ï¼šCookieä¸Sessionæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7583618094175322158</link>    <guid>https://juejin.cn/post/7583618094175322158</guid>    <pubDate>2025-12-15T02:04:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583618094175322158" data-draft-id="7583613222344638490" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js ç¼–ç¨‹å®æˆ˜ï¼šCookieä¸Sessionæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯,Node.js,Trae"/> <meta itemprop="datePublished" content="2025-12-15T02:04:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js ç¼–ç¨‹å®æˆ˜ï¼šCookieä¸Sessionæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T02:04:42.000Z" title="Mon Dec 15 2025 02:04:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨ Web åº”ç”¨ä¸­ï¼ŒHTTP åè®®æœ¬èº«æ˜¯æ— çŠ¶æ€çš„ã€‚æœåŠ¡å™¨æ— æ³•ä»…å‡­ä¸€æ¬¡è¯·æ±‚å°±åˆ¤æ–­â€œå½“å‰ç”¨æˆ·æ˜¯è°ã€ä¹‹å‰åšè¿‡ä»€ä¹ˆæ“ä½œâ€ã€‚ä¸ºäº†è§£å†³çŠ¶æ€ä¿æŒçš„é—®é¢˜ï¼ŒCookie ä¸ Session æˆä¸ºäº† Web å¼€å‘ä¸­æœ€åŸºç¡€ã€ä¹Ÿæœ€é‡è¦çš„æœºåˆ¶ä¹‹ä¸€ã€‚æœ¬æ–‡å°†ç»“åˆ Node.jsï¼Œç³»ç»Ÿè®²è§£ Cookie ä¸ Session çš„å·¥ä½œåŸç†ã€ä½¿ç”¨æ–¹å¼ä»¥åŠå¸¸è§å®è·µã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ Cookie ä¸ Session</h2>
<p>HTTP æ˜¯ä¸€ç§æ— çŠ¶æ€åè®®ï¼Œæ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼š</p>
<ul>
<li>æœåŠ¡å™¨ä¸ä¼šè®°ä½ä¸Šä¸€æ¬¡è¯·æ±‚çš„ç”¨æˆ·</li>
<li>ä¸åŒè¯·æ±‚ä¹‹é—´é»˜è®¤æ²¡æœ‰ä»»ä½•å…³è”</li>
<li>ç”¨æˆ·ç™»å½•çŠ¶æ€æ— æ³•è‡ªåŠ¨ä¿æŒ</li>
</ul>
<p>å¦‚æœæ²¡æœ‰çŠ¶æ€æœºåˆ¶ï¼Œå°±æ— æ³•å®ç°ç™»å½•ã€è´­ç‰©è½¦ã€ä¸ªæ€§åŒ–é…ç½®ç­‰åŠŸèƒ½ã€‚Cookie ä¸ Session çš„å‡ºç°ï¼Œæ­£æ˜¯ä¸ºäº†åœ¨â€œæ— çŠ¶æ€åè®®â€ä¹‹ä¸Šï¼Œæ„å»ºâ€œæœ‰çŠ¶æ€çš„åº”ç”¨ä½“éªŒâ€ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€Cookie çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>Cookie æ˜¯æœåŠ¡å™¨å‘é€ç»™æµè§ˆå™¨çš„ä¸€å°æ®µæ•°æ®ï¼Œæµè§ˆå™¨ä¼šå°†å…¶ä¿å­˜åœ¨æœ¬åœ°ï¼Œå¹¶åœ¨åç»­è¯·æ±‚ä¸­è‡ªåŠ¨æºå¸¦å›æœåŠ¡å™¨ã€‚</p>
<p>Cookie çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰</li>
<li>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šéš HTTP å¤´ä¸€èµ·å‘é€</li>
<li>å¤§å°æœ‰é™ï¼ˆé€šå¸¸ä¸è¶…è¿‡ 4KBï¼‰</li>
<li>å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ã€ä½œç”¨åŸŸå’Œå®‰å…¨å±æ€§</li>
</ul>
<p>ä»æœ¬è´¨ä¸Šçœ‹ï¼ŒCookie æ˜¯æœåŠ¡å™¨åœ¨å®¢æˆ·ç«¯ä¿å­˜çŠ¶æ€ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€Node.js ä¸­æ“ä½œ Cookie</h2>
<h3 data-id="heading-3">1. è®¾ç½® Cookie</h3>
<p>åœ¨ Node.js åŸç”Ÿ <code>http</code> æ¨¡å—ä¸­ï¼Œå¯ä»¥é€šè¿‡å“åº”å¤´è®¾ç½® Cookieã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);

<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Set-Cookie"</span>, <span class="hljs-string">"username=nodejs; Max-Age=3600"</span>);
  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">"Cookie set"</span>);
});

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
</code></pre>
<p>ä¸Šé¢çš„ä»£ç ä¼šåœ¨æµè§ˆå™¨ä¸­ä¿å­˜ä¸€ä¸ªåä¸º <code>username</code> çš„ Cookieï¼Œæœ‰æ•ˆæœŸä¸ºä¸€å°æ—¶ã€‚</p>
<hr/>
<h3 data-id="heading-4">2. è¯»å– Cookie</h3>
<p>æµè§ˆå™¨å‘é€çš„ Cookie ä¼šå‡ºç°åœ¨è¯·æ±‚å¤´ä¸­ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> cookie = req.<span class="hljs-property">headers</span>.<span class="hljs-property">cookie</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cookie);
</code></pre>
<p>å¦‚æœæœ‰å¤šä¸ª Cookieï¼Œå®ƒä»¬ä¼šä»¥åˆ†å·åˆ†éš”çš„å½¢å¼å‡ºç°ï¼Œéœ€è¦æ‰‹åŠ¨è§£æã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">parseCookie</span>(<span class="hljs-params">cookieStr = <span class="hljs-string">""</span></span>) {
  <span class="hljs-keyword">const</span> cookies = {};
  cookieStr.<span class="hljs-title function_">split</span>(<span class="hljs-string">";"</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> [key, value] = item.<span class="hljs-title function_">split</span>(<span class="hljs-string">"="</span>);
    <span class="hljs-keyword">if</span> (key &amp;&amp; value) {
      cookies[key.<span class="hljs-title function_">trim</span>()] = value.<span class="hljs-title function_">trim</span>();
    }
  });
  <span class="hljs-keyword">return</span> cookies;
}
</code></pre>
<hr/>
<h2 data-id="heading-5">å››ã€Cookie çš„å¸¸è§å±æ€§</h2>
<p>Cookie å¹¶ä¸ä»…ä»…æ˜¯é”®å€¼å¯¹ï¼Œè¿˜å¯ä»¥è®¾ç½®å¤šç§å±æ€§æ¥å¢å¼ºå®‰å…¨æ€§å’Œæ§åˆ¶èŒƒå›´ã€‚</p>
<ul>
<li><code>Max-Age / Expires</code>ï¼šæ§åˆ¶ Cookie è¿‡æœŸæ—¶é—´</li>
<li><code>Path</code>ï¼šé™åˆ¶ Cookie ç”Ÿæ•ˆçš„è·¯å¾„</li>
<li><code>Domain</code>ï¼šé™åˆ¶ Cookie ç”Ÿæ•ˆçš„åŸŸå</li>
<li><code>HttpOnly</code>ï¼šç¦æ­¢ JavaScript è®¿é—® Cookie</li>
<li><code>Secure</code>ï¼šä»…åœ¨ HTTPS è¿æ¥ä¸‹å‘é€</li>
</ul>
<p>åˆç†è®¾ç½®è¿™äº›å±æ€§ï¼Œæ˜¯ Web å®‰å…¨çš„é‡è¦ä¸€ç¯ã€‚</p>
<hr/>
<h2 data-id="heading-6">äº”ã€Session çš„æ ¸å¿ƒæ€æƒ³</h2>
<p>Session æ˜¯æœåŠ¡å™¨ç«¯ä¿å­˜ç”¨æˆ·çŠ¶æ€çš„ä¸€ç§æœºåˆ¶ã€‚
ä¸ Cookie ä¸åŒï¼ŒSession çš„æ ¸å¿ƒæ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­ã€‚</p>
<p>å¸¸è§çš„å·¥ä½œæµç¨‹æ˜¯ï¼š</p>
<ol>
<li>ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡å™¨</li>
<li>æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ª Sessionï¼Œå¹¶ç”Ÿæˆ Session ID</li>
<li>æœåŠ¡å™¨å°† Session ID é€šè¿‡ Cookie å‘é€ç»™å®¢æˆ·ç«¯</li>
<li>å®¢æˆ·ç«¯åç»­è¯·æ±‚æºå¸¦è¯¥ Session ID</li>
<li>æœåŠ¡å™¨æ ¹æ® Session ID æŸ¥æ‰¾å¯¹åº”çš„ Session æ•°æ®</li>
</ol>
<p>Session è§£å†³äº† Cookie æ•°æ®æš´éœ²åœ¨å®¢æˆ·ç«¯çš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-7">å…­ã€Node.js ä¸­çš„ç®€å• Session å®ç°</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„ç®€æ˜“ Session ç¤ºä¾‹ï¼Œç”¨äºç†è§£åŸç†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">"crypto"</span>);

<span class="hljs-keyword">const</span> sessions = {};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateSessionId</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">"hex"</span>);
}

<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> sid;

  <span class="hljs-keyword">const</span> cookies = <span class="hljs-title function_">parseCookie</span>(req.<span class="hljs-property">headers</span>.<span class="hljs-property">cookie</span>);
  sid = cookies.<span class="hljs-property">sid</span>;

  <span class="hljs-keyword">if</span> (!sid || !sessions[sid]) {
    sid = <span class="hljs-title function_">generateSessionId</span>();
    sessions[sid] = { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> };
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Set-Cookie"</span>, <span class="hljs-string">`sid=<span class="hljs-subst">${sid}</span>; HttpOnly`</span>);
  }

  sessions[sid].<span class="hljs-property">count</span>++;
  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">`Visit count: <span class="hljs-subst">${sessions[sid].count}</span>`</span>);
});

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
</code></pre>
<p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº† Session çš„åŸºæœ¬æµç¨‹ï¼Œä½†å¹¶ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¸ƒã€Cookie ä¸ Session çš„åŒºåˆ«</h2>
<p>ä»è®¾è®¡è§’åº¦æ¥çœ‹ï¼Œä¸¤è€…çš„å·®å¼‚éå¸¸æ˜æ˜¾ï¼š</p>
<ul>
<li>Cookie å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼ŒSession å­˜å‚¨åœ¨æœåŠ¡å™¨</li>
<li>Cookie å®¹é‡å°ï¼ŒSession ç†è®ºä¸Šæ›´çµæ´»</li>
<li>Cookie æ›´å®¹æ˜“è¢«ç¯¡æ”¹ï¼ŒSession ç›¸å¯¹å®‰å…¨</li>
<li>Session é€šå¸¸ä¾èµ– Cookie ä¼ é€’ Session ID</li>
</ul>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå®ƒä»¬å¾€å¾€æ˜¯é…åˆä½¿ç”¨çš„ï¼Œè€Œä¸æ˜¯äºŒé€‰ä¸€ã€‚</p>
<hr/>
<h2 data-id="heading-9">å…«ã€ç”Ÿäº§ç¯å¢ƒä¸­çš„ Session ç®¡ç†</h2>
<p>åœ¨çœŸå®é¡¹ç›®ä¸­ï¼ŒSession é€šå¸¸ä¸ä¼šå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ï¼š</p>
<ul>
<li>Redis</li>
<li>æ•°æ®åº“</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿ</li>
</ul>
<p>è¿™æ ·å¯ä»¥æ”¯æŒï¼š</p>
<ul>
<li>æœåŠ¡é‡å¯ä¸ä¸¢å¤± Session</li>
<li>å¤šå®ä¾‹éƒ¨ç½²ä¸‹çš„ Session å…±äº«</li>
<li>æ›´å¥½çš„æ€§èƒ½ä¸æ‰©å±•æ€§</li>
</ul>
<p>åœ¨ Node.js é¡¹ç›®ä¸­ï¼ŒExpress é€šå¸¸ä¼šæ­é… <code>express-session</code> ä¸ Redis ä¸€èµ·ä½¿ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-10">ä¹ã€Cookie ä¸ Session çš„å®‰å…¨å®è·µ</h2>
<p>åœ¨æ¶‰åŠç™»å½•å’Œç”¨æˆ·èº«ä»½çš„åœºæ™¯ä¸­ï¼Œå®‰å…¨å°¤ä¸ºé‡è¦ï¼š</p>
<ul>
<li>Session ID å¿…é¡»è¶³å¤Ÿéšæœºï¼Œé˜²æ­¢çŒœæµ‹</li>
<li>Cookie åº”è®¾ç½® <code>HttpOnly</code>ï¼Œé˜²æ­¢ XSS</li>
<li>ä½¿ç”¨ HTTPS å¹¶å¼€å¯ <code>Secure</code> å±æ€§</li>
<li>å®šæœŸæ¸…ç†è¿‡æœŸ Session</li>
<li>é¿å…åœ¨ Cookie ä¸­å­˜å‚¨æ•æ„Ÿä¿¡æ¯</li>
</ul>
<p>è¿™äº›ç»†èŠ‚ç›´æ¥å†³å®šäº†ç³»ç»Ÿçš„å®‰å…¨ç­‰çº§ã€‚</p>
<hr/>
<h2 data-id="heading-11">åã€æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡ï¼š</p>
<ul>
<li>Cookie ä¸ Session å‡ºç°çš„èƒŒæ™¯</li>
<li>Cookie çš„åŸºæœ¬åŸç†ä¸ Node.js å®ç°æ–¹å¼</li>
<li>Session çš„æ ¸å¿ƒæ€æƒ³ä¸è¿è¡Œæµç¨‹</li>
<li>ä¸¤è€…çš„å·®å¼‚ä¸ä½¿ç”¨åœºæ™¯</li>
<li>å®é™…é¡¹ç›®ä¸­çš„å®‰å…¨ä¸æ¶æ„å»ºè®®</li>
</ul>
<p>Cookie ä¸ Session æ˜¯ Node.js Web å¼€å‘ä¸­ç»•ä¸å¼€çš„åŸºç¡€çŸ¥è¯†ã€‚ç†è§£å®ƒä»¬çš„åŸç†ï¼Œæ¯”å•çº¯ä¼šç”¨æ¡†æ¶æ›´é‡è¦ï¼Œä¹Ÿä¸ºåç»­å­¦ä¹ è®¤è¯ç³»ç»Ÿã€æƒé™æ§åˆ¶å’Œåˆ†å¸ƒå¼æ¶æ„æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AgentScope Java 1.0ï¼šä»æ¨¡å‹åˆ°åº”ç”¨ï¼ŒAI Agent å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åˆ©å™¨ï¼]]></title>    <link>https://juejin.cn/post/7583910637957611539</link>    <guid>https://juejin.cn/post/7583910637957611539</guid>    <pubDate>2025-12-15T09:46:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583910637957611539" data-draft-id="7583615094363815990" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AgentScope Java 1.0ï¼šä»æ¨¡å‹åˆ°åº”ç”¨ï¼ŒAI Agent å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åˆ©å™¨ï¼"/> <meta itemprop="keywords" content="Java,äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-15T09:46:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AgentScope Java 1.0ï¼šä»æ¨¡å‹åˆ°åº”ç”¨ï¼ŒAI Agent å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åˆ©å™¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T09:46:44.000Z" title="Mon Dec 15 2025 09:46:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šäº¦ç›</p>
<h2 data-id="heading-0">AgentScope ç®€ä»‹</h2>
<p>AgentScope æ˜¯é˜¿é‡Œå·´å·´æ¨å‡ºçš„ä¸€æ¬¾ä»¥å¼€å‘è€…ä¸ºæ ¸å¿ƒï¼Œä¸“æ³¨äºæ™ºèƒ½ä½“å¼€å‘çš„å¼€æºæ¡†æ¶ï¼Œæ˜¯ç»§ ModelScopeï¼ˆé­”æ­ç¤¾åŒºï¼‰ååœ¨ Agent å±‚çš„æˆ˜ç•¥äº§å“ã€‚å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³æ™ºèƒ½ä½“åœ¨æ„å»ºã€è¿è¡Œå’Œç®¡ç†ä¸­çš„éš¾é¢˜ï¼Œæä¾›ä¸€å¥—è¦†ç›–â€œå¼€å‘ã€éƒ¨ç½²ã€è°ƒä¼˜â€å…¨ç”Ÿå‘½å‘¨æœŸçš„ç”Ÿäº§çº§è§£å†³æ–¹æ¡ˆï¼Œè®©æ™ºèƒ½ä½“åº”ç”¨çš„å¼€å‘æ›´ç®€å•ã€è¿è¡Œæ›´ç¨³å®šã€æ•ˆæœæ›´å“è¶Šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c118a37647241b1893e0e5747440f79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766396803&amp;x-signature=Nc2fHBcTJPl7TPLyvyAIXGwQRE4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>è¿‘æœŸ AgentScope è¿æ¥äº† 12 æœˆç‰ˆæœ¬çš„é‡å¤§æ›´æ–°</strong>ï¼Œè¿™æ˜¯ä¸€æ¬¡é¢å‘ç”Ÿäº§çº§æ™ºèƒ½ä½“åº”ç”¨çš„åŸºå»ºå¤§å‡çº§ï¼Œè®©æ™ºèƒ½ä½“ä»â€œå®éªŒå®¤åŸå‹â€èµ°å‘â€œä¸šåŠ¡è½åœ°â€ã€‚<strong>æœ¬æ¬¡æ›´æ–°å›´ç»•ä¸‰å¤§æ ¸å¿ƒä¸»çº¿ï¼š</strong> å¼€ç®±å³ç”¨çš„æ™ºèƒ½ä½“ï¼Œå³åˆ»èµ‹èƒ½å¤šç§çœŸå®åœºæ™¯ï¼›åŸºå»ºå¢å¼ºè®©æ™ºèƒ½ä½“â€œå˜èªæ˜â€çš„åº•å±‚èƒ½åŠ›å…¨é¢å‡çº§ï¼›è¿è¡Œæ—¶ Ã— å¤šè¯­è¨€ Ã— å‰ç«¯ï¼Œä¸‰ä½ä¸€ä½“äº¤ä»˜ç”Ÿäº§å°±ç»ªçš„æ™ºèƒ½ä½“ã€‚</p>
<p>ä¸€ç›´ä»¥æ¥ï¼ŒJava è¯­è¨€åœ¨é‡‘èã€æ”¿åŠ¡ã€ç”µå•†ç­‰é¢†åŸŸå¼€å‘ä¸­éƒ½å ç€ä¸»å¯¼åœ°ä½ï¼Œå¼€å‘è€…ç¤¾åŒºå¯¹äº AgentScope Java ç‰ˆæœ¬çš„å‘¼å£°ä¹Ÿéå¸¸é«˜ï¼ŒAgentScope æœ¬æ¬¡ä¹Ÿé‡ç£…å‘å¸ƒäº† Java çš„ 1.0 ç‰ˆæœ¬ï¼Œæ‹¥æŠ±ä¼ä¸šå¼€å‘ä¸»æµæŠ€æœ¯æ ˆã€‚</p>
<h2 data-id="heading-1">AgentScope Java 1.0 é‡ç£…å‘å¸ƒ</h2>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ AgentScope Java 1.0 ç‰ˆæœ¬æ­£å¼å‘å¸ƒäº†ï¼Œé¢å‘ Java å¼€å‘è€…æä¾›ä¼ä¸šçº§ Agentic åº”ç”¨æ„å»ºçš„èƒ½åŠ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baa988a8c2bb49048d8340894e4f4527~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766396803&amp;x-signature=wUxY2bFxf92eRxIpEWm9EDhl3dg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>é¦–å…ˆåœ¨å¼€å‘èŒƒå¼ä¸Šï¼Œ</strong>Â AgentScopeÂ é‡‡ç”¨é¢†å…ˆçš„ ReActï¼ˆæ¨ç†-è¡ŒåŠ¨ï¼‰æ¨¡å¼ï¼Œæ”¯æŒé«˜æ•ˆçš„å·¥å…·è°ƒç”¨ï¼Œå¹¶å…è®¸å¼€å‘è€…å¯¹ Agent æ‰§è¡Œè¿‡ç¨‹è¿›è¡Œå®æ—¶ä»‹å…¥ï¼Œå®ç°äº†è‡ªä¸»æ€§ä¸å¯æ§æ€§çš„å®Œç¾å¹³è¡¡ã€‚</p>
<p><strong>å…¶æ¬¡ï¼Œå®ƒæä¾›äº†å¼€ç®±å³ç”¨çš„ä¼ä¸šçº§èƒ½åŠ›ã€‚</strong> æ¡†æ¶æä¾›å®‰å…¨æ²™ç®±ä¿éšœä»£ç æ‰§è¡Œå®‰å…¨ï¼Œé€šè¿‡ç²¾ç»†çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ä¼˜åŒ–æ¨¡å‹äº¤äº’æ•ˆæœã€‚ä½œä¸º Java æ¡†æ¶ï¼Œå®ƒæ˜“äºé›†æˆåˆ°ç°æœ‰ä¼ä¸šæŠ€æœ¯æ ˆä¸­ï¼Œå¹¶å…·å¤‡é«˜æ€§èƒ½æ¶æ„ï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šå¯é ã€‚</p>
<p><strong>æœ€åï¼Œå®ƒæ‹¥æœ‰å®Œå–„çš„å¼€å‘ä¸ä¼˜åŒ–ç”Ÿæ€ã€‚</strong> æä¾›ä»å¼€å‘æ€å¯è§†åŒ–è°ƒè¯•ã€A/B æµ‹è¯•åˆ°è¯„ä¼°ä¸å¼ºåŒ–å­¦ä¹ çš„å®Œæ•´å·¥å…·é“¾ï¼Œæ„æˆäº† Agent å¼€å‘ã€éƒ¨ç½²ã€è°ƒä¼˜çš„é—­ç¯ï¼ŒåŠ©åŠ›æŒç»­æå‡ Agent æ•ˆæœã€‚</p>
<h3 data-id="heading-2">é¢†å…ˆçš„å¼€å‘èŒƒå¼</h3>
<p>åœ¨æ„å»ºå¤æ‚çš„ AI Agent åº”ç”¨æ—¶ï¼Œå¼€å‘è€…æ™®éé¢ä¸´ä¼—å¤šæŒ‘æˆ˜ï¼šåƒµåŒ–çš„å·¥ä½œæµéš¾ä»¥é€‚åº”å¤šå˜çš„ä»»åŠ¡ã€è¿è¡Œä¸­çš„Agent æ— æ³•å®æ—¶å¹²é¢„ã€æµ·é‡å·¥å…·å¯¼è‡´ç®¡ç†æ··ä¹±ä¸æ€§èƒ½ç“¶é¢ˆã€æ¨¡å‹è¾“å‡ºæ ¼å¼ä¸ç¨³å®šç­‰ç­‰ã€‚å¦‚ä½•ç³»ç»Ÿæ€§åœ°è§£å†³è¿™äº›ç—›ç‚¹ï¼Œæ˜¯æå‡å¼€å‘æ•ˆç‡å’Œåº”ç”¨ç¨³å®šæ€§çš„å…³é”®ã€‚AgentScope é‡‡ç”¨é¢†å…ˆçš„ ReAct èŒƒå¼ï¼Œèµ‹äºˆ LLM è‡ªä¸»è§„åˆ’èƒ½åŠ›ï¼Œå¹¶æä¾›å®æ—¶ä»‹å…¥æ§åˆ¶ã€é«˜æ•ˆçš„å·¥å…·è°ƒç”¨ä½“ç³»ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å†…ç½®ä»»åŠ¡è§„åˆ’ã€ç»“æ„åŒ–è¾“å‡ºç­‰å¼ºå¤§å·¥å…·ï¼Œæ”¯æŒé«˜æ•ˆå¼€å‘ç”Ÿäº§çº§åº”ç”¨ã€‚</p>
<ol>
<li>
<p><strong>é¢†å…ˆçš„ ReAct èŒƒå¼</strong>ï¼Œèµ‹äºˆAgentè‡ªä¸»è§„åˆ’èƒ½åŠ›ã€‚</p>
<ol>
<li>å·¥ä½œæµï¼ˆWorkflowï¼‰æ¨¡å¼ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒLLM ä¸å·¥å…·ï¼ˆToolï¼‰çš„åä½œè·¯å¾„ç”±å¼€å‘è€…é¢„å…ˆå®šä¹‰ï¼Œå¼€å‘è€…å¯¹ç³»ç»Ÿçš„æ‰§è¡Œæµç¨‹æœ‰å®Œå…¨çš„æ§åˆ¶æƒï¼Œè¿™ä¿è¯äº†ä»»åŠ¡æ‰§è¡Œçš„ç¨³å®šæ€§å’Œç¡®å®šæ€§ã€‚ä½†æ˜¯ä»–çš„ç¼ºç‚¹æ˜¯æ¶æ„åƒµåŒ–ï¼Œå½“ä¸šåŠ¡é€»è¾‘å˜å¾—å¤æ‚æ—¶ï¼Œç»´æŠ¤æˆæœ¬æ¿€å¢ï¼Œè€Œä¸”æ— æ³•äº«å— LLM æŒç»­è¿›åŒ–æ‰€å¸¦æ¥çš„èƒ½åŠ›æå‡ã€‚</li>
<li>ReAct èŒƒå¼ï¼šä¸ Workflow ç›¸åï¼ŒReAct èµ‹äºˆäº† LLM è‡ªä¸»æ§åˆ¶æƒã€‚LLM æ‰®æ¼”å¤§è„‘çš„è§’è‰²ï¼Œèƒ½å¤ŸåŠ¨æ€åœ°è¿›è¡Œæ¨ç†ï¼ˆReasoningï¼‰å’Œè§„åˆ’ï¼Œè‡ªä¸»å†³å®šä½•æ—¶ã€å¦‚ä½•è°ƒç”¨å·¥å…·æ¥æ‰§è¡Œæ“ä½œï¼ˆActionï¼‰ï¼Œä»è€Œä¸»å¯¼ä»»åŠ¡çš„å®Œæˆã€‚éšç€ LLM åœ¨ç†è§£ã€è§„åˆ’å’Œå·¥å…·ä½¿ç”¨ç­‰å…³é”®èƒ½åŠ›ä¸Šæ—¥è¶‹æˆç†Ÿï¼Œè¿™ç§é«˜åº¦è‡ªä¸»çš„ Agent æ¶æ„å·²æˆä¸ºå¤æ‚åº”ç”¨åœºæ™¯ä¸‹çš„é¦–é€‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>å®æ—¶çš„ä»‹å…¥æ§åˆ¶</strong>ï¼Œè®© Agent è¿è¡Œå…¨ç¨‹å¯æ§ã€‚ä¼ ç»Ÿ Agent ä¸€æ—¦å¯åŠ¨ä¾¿æ— æ³•å®‰å…¨å¹²é¢„ï¼ŒAgentScope åŸºäºå¼‚æ­¥æ¶æ„ï¼Œå®ç°äº†å¼ºå¤§çš„å®æ—¶ä»‹å…¥æœºåˆ¶ã€‚</p>
<ol>
<li>å®‰å…¨ä¸­æ–­ï¼šæ”¯æŒéšæ—¶æš‚åœ Agentï¼Œå¹¶è‡ªåŠ¨ä¿å­˜å…¶ä¸Šä¸‹æ–‡å’Œå·¥å…·çŠ¶æ€ï¼Œç¡®ä¿ä»»åŠ¡èƒ½æ— ç¼æ¢å¤ã€‚</li>
<li>å®æ—¶æ‰“æ–­ï¼šå½“ä»»åŠ¡åç¦»é¢„æœŸæˆ–è€—æ—¶è¿‡é•¿æ—¶ï¼Œç”¨æˆ·å¯ç«‹å³ç»ˆæ­¢ï¼Œé¿å…èµ„æºæµªè´¹ã€‚</li>
<li>çµæ´»å®šåˆ¶ï¼šå¼€å‘è€…å¯ä»¥è‡ªå®šä¹‰ä¸­æ–­å¤„ç†é€»è¾‘ï¼Œå®ç°æ›´ç²¾ç»†åŒ–çš„ç®¡ç†ã€‚</li>
</ol>
</li>
<li>
<p><strong>é«˜æ•ˆçš„å·¥å…·è°ƒç”¨</strong>ï¼Œéšç€å¯è°ƒç”¨å·¥å…·æ•°é‡çš„æ¿€å¢ï¼ŒAgent é¢ä¸´ç€å·¥å…·ç®¡ç†å¤æ‚ã€æ‰§è¡Œæ•ˆç‡ä½ã€ä¸Šä¸‹æ–‡ç´§å¼ çš„é—®é¢˜ã€‚AgentScope æ„å»ºäº†ä¸€å¥—é«˜æ•ˆã€å¯é çš„å·¥å…·ç®¡ç†ä½“ç³»ã€‚</p>
<ol>
<li>å·¥å…·æ³¨å†Œï¼šæä¾›æ ‡å‡†åŒ–çš„æ³¨å†Œæ¥å£ï¼Œæ”¯æŒè‡ªåŠ¨æå–å·¥å…·çš„ JSON Schemaï¼Œæä¾›å‚æ•°é¢„è®¾å’Œå·¥å…·å‡½æ•°åå¤„ç†æ¥å£ï¼Œé™ä½é›†æˆé—¨æ§›ã€‚</li>
<li>ä¾¿æ·ç®¡ç†ï¼šAgentScope é€šè¿‡ç»“æ„åŒ–çš„ç»„ç»‡æ–¹å¼å’ŒåŠ¨æ€æ§åˆ¶æœºåˆ¶æ¥é«˜æ•ˆæ”¯æŒå·¥å…·çš„ä½¿ç”¨ã€‚å·¥å…·ç»„ï¼ˆTool Groupï¼‰æŒ‰ç…§åŠŸèƒ½å¯¹å·¥å…·è¿›è¡Œåˆ†ç±»ï¼ˆä¾‹å¦‚æµè§ˆå™¨ã€åœ°å›¾æœåŠ¡ç­‰ï¼‰ï¼Œä½¿ Agent èƒ½å¤Ÿæ ¹æ®å½“å‰ä»»åŠ¡æŒ‰éœ€æ¿€æ´»ç›¸å…³å·¥å…·ï¼Œä»è€Œæœ‰æ•ˆç¼“è§£ä¸Šä¸‹æ–‡çª—å£çš„å‹åŠ›ï¼›å…ƒå·¥å…·ï¼ˆMeta-Toolï¼‰å…è®¸ Agent åœ¨è¿è¡Œæ—¶åŠ¨æ€å¯ç”¨æˆ–åœç”¨æ•´ä¸ªå·¥å…·ç»„ï¼Œå®ç°æ›´åŠ æ™ºèƒ½åŒ–çš„å·¥å…·ç®¡ç†ã€‚</li>
<li>é«˜æ•ˆæ‰§è¡Œï¼šé‡‡ç”¨ç»Ÿä¸€æ¥å£å¤„ç†æ‰€æœ‰å·¥å…·è°ƒç”¨ï¼Œæ— è®ºåŒæ­¥ã€å¼‚æ­¥æˆ–æµå¼è¾“å‡ºï¼Œåœ¨ AgentScope ä¸­å°†è¢«ç»Ÿä¸€ä¸ºå¼‚æ­¥æµå¼è¿”å›ï¼Œé™ä½å·¥å…·å‡½æ•°è¿”å›çš„å¤„ç†å¤æ‚åº¦ã€‚åŒæ—¶æ”¯æŒå·¥å…·çš„å¹¶è¡Œè°ƒç”¨ï¼Œå¤§å¹…æå‡è¿è¡Œæ•ˆç‡ã€‚</li>
</ol>
</li>
<li>
<p><strong>å¼ºå¤§çš„å†…ç½®å·¥å…·</strong>ï¼šAgentScope å†…ç½®äº†è®¸å¤šå¼€ç®±å³ç”¨çš„å¼ºå¤§å·¥å…·ï¼Œå¼€ç®±å³ç”¨ï¼ŒåŠ é€Ÿç”Ÿäº§çº§åº”ç”¨å¼€å‘ã€‚</p>
<ol>
<li>PlanNoteBook å·¥å…·æä¾›äº†å¼ºå¤§çš„ä»»åŠ¡è§„åˆ’ä¸æ‰§è¡Œèƒ½åŠ›ã€‚æ”¯æŒå¼€å‘è€…æ‰‹åŠ¨å®šä¹‰ç»“æ„åŒ–è®¡åˆ’ï¼Œä¹Ÿå…è®¸ Agent åœ¨è¿è¡Œæ—¶è‡ªä¸»åˆ›å»ºå’Œç®¡ç†è®¡åˆ’ã€‚é€šè¿‡ PlanNotebook æä¾›å®Œæ•´çš„è®¡åˆ’ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»ºã€ä¿®æ”¹ã€æš‚åœã€æ¢å¤å’Œåˆ‡æ¢å¤šä¸ªè®¡åˆ’ï¼Œå¼•å¯¼ Agent æœ‰åºæ‰§è¡Œå¤æ‚è®¡åˆ’ã€‚</li>
<li>ç»“æ„åŒ–è¾“å‡ºï¼šä¼ ç»Ÿçš„åšæ³•æ˜¯åœ¨ Prompt ä¸­å†™æ ¼å¼è¦æ±‚ï¼Œè¦æ±‚æ¨¡å‹â€œè¯·æŒ‰ç…§ä»¥ä¸‹ JSON æ ¼å¼è¾“å‡ºâ€ï¼Œä¸æ–­å°è¯•å’Œä¼˜åŒ–æç¤ºè¯ï¼Œç»å¸¸éœ€è¦åœ¨å¤–éƒ¨ä»£ç ä¸­åšäºŒæ¬¡è§£æå’Œæ ¼å¼æ ¡éªŒã€‚AgentScope é€šè¿‡å†…ç½®å·¥å…·ç¡®ä¿ LLM çš„è¾“å‡ºä¸¥æ ¼éµå¾ªé¢„å®šä¹‰çš„ JSON æ ¼å¼ï¼Œå½»åº•å‘Šåˆ«ç¹ççš„æç¤ºè¯è°ƒè¯•å’ŒäºŒæ¬¡è§£æã€‚</li>
</ol>
</li>
</ol>
<h3 data-id="heading-3">ä¼ä¸šçº§èƒ½åŠ›</h3>
<p>AgentScope æä¾›äº†å®‰å…¨å·¥å…·æ²™ç®±å’Œä¸Šä¸‹æ–‡å·¥ç¨‹èƒ½åŠ›ï¼Œè§£å†³äº†å®‰å…¨ä¸æ•ˆæœçš„æ ¸å¿ƒç—›ç‚¹ï¼Œç¡®ä¿ Agent çš„è¾“å‡ºæ•ˆæœæ»¡è¶³ç”Ÿäº§æ ‡å‡†ã€‚ä¾æ‰˜äº Java åœ¨ä¼ä¸šåº”ç”¨å¼€å‘å¸‚åœºçš„å¼ºå¤§ç”Ÿæ€ï¼Œé€šè¿‡æ ‡å‡†çš„ A2A å’Œ MCP åè®®ï¼Œæä¾›äº†çµæ´»çš„é›†æˆä¸è¢«é›†æˆæ–¹æ¡ˆï¼Œè¿™ä½¿å¾— Agent æ—¢èƒ½ä½œä¸ºç‹¬ç«‹æœåŠ¡åµŒå…¥ç°æœ‰ç³»ç»Ÿï¼Œä¹Ÿèƒ½æˆä¸ºè¿æ¥å’Œè°ƒåº¦å…¶ä»–æœåŠ¡çš„æ™ºèƒ½ä¸­æ¢ã€‚å¼€å‘è€…æ— éœ€å…³å¿ƒåº•å±‚é›†æˆç»†èŠ‚ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘å³å¯å¿«é€Ÿæ„å»ºç”Ÿäº§çº§ Agent åº”ç”¨ã€‚æœ€åï¼Œä¾æ‰˜äº AgentScope Runtime æä¾›çš„èƒ½åŠ›ï¼Œæ”¯æŒå°† Agent ä¸€é”®éƒ¨ç½²åˆ°é˜¿é‡Œäº‘ç™¾ç‚¼å’Œå‡½æ•°è®¡ç®—å¹³å°ï¼Œä¸ºæ‚¨çš„ Agent åº”ç”¨æä¾›å•†ä¸šçº§çš„äº§å“åŒ–ä¿éšœã€‚</p>
<ol>
<li>
<p><strong>å®‰å…¨æ²™ç®±</strong></p>
<ol>
<li>Agent åœ¨æ‰§è¡Œå·¥å…·è°ƒç”¨æˆ–è‡ªåŠ¨åŒ–ä»»åŠ¡æ—¶ï¼Œå¯èƒ½è®¿é—®æ•æ„Ÿèµ„æºæˆ–å¼•å‘ä¸å¯æ§è¡Œä¸ºï¼Œéœ€è¦æ²™ç®±æä¾›å®‰å…¨éš”ç¦»ç¯å¢ƒã€‚AgentScope Runtime Sandbox æ”¯æŒå¼€å‘è€…å°†è‡ªå®šä¹‰å·¥å…·éƒ¨ç½²åœ¨é«˜åº¦éš”ç¦»çš„å—æ§ç¯å¢ƒä¸­å®‰å…¨è¿è¡Œï¼Œé˜²æ­¢å¯¹ç³»ç»Ÿé€ æˆæ„å¤–å½±å“æˆ–å®‰å…¨é£é™©ã€‚</li>
<li>å†…ç½®å¤šç§å¼€ç®±å³ç”¨çš„æ²™ç®±ï¼šGUI æ²™ç®±æä¾›å®Œæ•´æ¡Œé¢ç¯å¢ƒï¼Œæ”¯æŒé¼ æ ‡ã€é”®ç›˜å’Œå±å¹•æ“ä½œï¼›æ–‡ä»¶ç³»ç»Ÿæ²™ç®±å®ç°éš”ç¦»çš„æ–‡ä»¶è¯»å†™ä¸ç®¡ç†ï¼›ç§»åŠ¨ç«¯æ²™ç®±åŸºäº Android æ¨¡æ‹Ÿå™¨ï¼Œæ”¯æŒç‚¹å‡»ã€æ»‘åŠ¨ã€è¾“å…¥å’Œæˆªå±ç­‰çœŸå®ç§»åŠ¨äº¤äº’ã€‚å…¼é¡¾äº†å®‰å…¨æ€§ã€çµæ´»æ€§ä¸å¤šå¹³å°è¦†ç›–ï¼Œå…¨é¢æ”¯æ’‘å·¥å…·æ‰§è¡Œã€æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€è®­ç»ƒè¯„æµ‹ç­‰å¤æ‚åœºæ™¯ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä¸Šä¸‹æ–‡å·¥ç¨‹</strong></p>
<ol>
<li>RAGï¼šå†…ç½®åŸºäº Embedding çš„æ ‡å‡†å®ç°ï¼Œæ”¯æŒä¼ä¸šåœ¨é¢å¯¹å¤æ‚çš„å¤šå…ƒä¸šåŠ¡æ•°æ®æƒ…å†µä¸‹ï¼Œç§æœ‰åŒ–éƒ¨ç½²è‡ªæœ‰çš„çŸ¥è¯†åº“ä½“ç³»ï¼Œå®ç°å¯¹æ•°æ®çš„å®Œå…¨è‡ªä¸»å¯æ§ï¼›é›†æˆé˜¿é‡Œäº‘ç™¾ç‚¼ä¼ä¸šçº§çŸ¥è¯†åº“ï¼Œå€ŸåŠ©å•†ä¸šåŒ–äº§å“è·å¾—æ›´å¼ºå¤§çš„æ£€ç´¢ä¸é‡æ’åºèƒ½åŠ›ã€‚</li>
<li>Memoryï¼šAgentScope å®šä¹‰äº†å¯¹çŸ­æœŸã€é•¿æœŸè®°å¿†çš„æŠ½è±¡ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢ä¸å¤šç§Ÿæˆ·éš”ç¦»ï¼Œæä¾›è‡ªåŠ¨ç®¡ç†ã€Agent ä¸»åŠ¨è°ƒç”¨ã€æ··åˆæ¨¡å¼ä¸‰ç§æ§åˆ¶æ–¹å¼ã€‚é€šè¿‡ ReMe é¡¹ç›®æä¾›äº†è®°å¿†çš„æœ€ä½³å®è·µæ–¹æ¡ˆï¼Œè®© Agent èƒ½å¤Ÿç†è§£ç”¨æˆ·åå¥½ã€æå‡ä»»åŠ¡è¡¨ç°å’Œæ›´èªæ˜åœ°ä½¿ç”¨å·¥å…·ï¼Œæ˜¾è‘—æå‡ä¸šåŠ¡åœºæ™¯ä¸‹çš„æ™ºèƒ½é—®ç­”å‡†ç¡®æ€§ä¸ä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼Œå®ç°è¶Šç”¨è¶Šå¥½ç”¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ˜“äºé›†æˆ</strong></p>
<ol>
<li>MCP é›†æˆï¼šåŸºäº AgentScope Java å¼€æºç”Ÿæ€ï¼Œç°æœ‰çš„ HTTP ä¸šåŠ¡ç³»ç»Ÿæ— éœ€æ”¹åŠ¨ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œé€šè¿‡ç®€å•é…ç½®å³å¯è¢« Agent æ— ç¼é›†æˆï¼Œå¿«é€Ÿæˆä¸º Agent å¯è°ƒç”¨çš„â€œæ‰‹è„šâ€ï¼Œæå¤§åœ°æ‰©å±•äº† Agent çš„èƒ½åŠ›è¾¹ç•Œã€‚</li>
<li>A2A é›†æˆï¼šå¤æ‚çš„ä»»åŠ¡é€šå¸¸éœ€è¦å¤šä¸ª Agent ååŒå·¥ä½œã€‚AgentScope Java æ”¯æŒå°†æè¿° Agent è‡ªèº«èƒ½åŠ›çš„ Agent Card æ³¨å†Œåˆ° Nacos ç­‰æœåŠ¡ä¸­å¿ƒï¼Œè°ƒç”¨æ–¹ Agent åªéœ€è¿æ¥ Nacosï¼Œå³å¯è‡ªåŠ¨å‘ç°å¹¶è°ƒç”¨å…¶ä»– Agent çš„èƒ½åŠ›ã€‚è¿™ä½¿å¾—åˆ†å¸ƒå¼ Multi Agent ç³»ç»Ÿçš„æ„å»ºä¸åä½œå˜å¾—åƒè°ƒç”¨æ™®é€šå¾®æœåŠ¡ä¸€æ ·ç®€å•ã€‚</li>
</ol>
</li>
<li>
<p>é«˜æ€§èƒ½</p>
<ol>
<li>è½»é‡åŒ–ï¼šæ ¸å¿ƒåº“ä»…ä¾èµ– Reactor Coreã€Jackson å’Œ SLF4Jã€RAGã€é•¿æœŸè®°å¿†ç­‰èƒ½åŠ›é€šè¿‡å¯é€‰æ‰©å±•æŒ‰éœ€å¼•å…¥ï¼Œç›®å‰åŸºäºå‚å•†åŸç”Ÿ SDK å®ç°æ¨¡å‹è°ƒç”¨ï¼Œæœªæ¥å°†åŸºäº OkHttp ä¸ Jackson åŸç”Ÿå®ç°ï¼Œè¿›ä¸€æ­¥ç²¾ç®€å†…æ ¸ä¾èµ–ã€‚</li>
<li>å¼‚æ­¥åŒ–ï¼šé’ˆå¯¹ AI åº”ç”¨äº¤äº’å…·æœ‰æŒç»­æ—¶é—´é•¿ã€å¤šè½®æ¬¡ä¸Šä¸‹æ–‡ä¾èµ–çš„ç‰¹ç‚¹ï¼Œæ”¯æŒå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ— RocketMQ ä½œä¸ºå¼‚æ­¥æ¶ˆæ¯ä¸­æ¢ï¼Œå®ç°ä»»åŠ¡è§£è€¦ä¸éé˜»å¡è°ƒç”¨ï¼Œæå‡ Agent çš„ååèƒ½åŠ›å’Œå“åº”é€Ÿåº¦ã€‚</li>
<li>Native ä¼˜åŒ–ï¼šè”åˆ JVM å›¢é˜Ÿé€‚é…äº† GraalVM å’Œ Leydenï¼Œå°† Java åº”ç”¨å¯åŠ¨é€Ÿåº¦æå‡ 3 åˆ° 10 å€ï¼Œå®ç°äº† Agent 200ms å†…å†·å¯åŠ¨ï¼Œä¸º AI åº”ç”¨ Serverless æ¯«ç§’çº§å¼¹æ€§å¥ å®šåŸºç¡€ã€‚</li>
</ol>
</li>
</ol>
<h3 data-id="heading-4">å¼ºå¤§çš„ç”Ÿæ€</h3>
<p>AI åŸç”Ÿåº”ç”¨æ¶æ„æ­£åœ¨æ·±åˆ»é‡å¡‘è½¯ä»¶å·¥ç¨‹èŒƒå¼ï¼Œä¼ ç»Ÿè½¯ä»¶çš„ç¡®å®šæ€§è¢« Agent çš„éç¡®å®šæ€§æ‰€å–ä»£ï¼Œå…¶æœ€ç»ˆæ•ˆæœç”±æ¨¡å‹ã€æ•°æ®å’Œä¸Šä¸‹æ–‡å…±åŒå†³å®šï¼Œè¿™ä½¿å¾—ä¼ ç»Ÿçš„â€œä»£ç æµ‹è¯•â€æ¼”å˜ä¸ºå¤æ‚çš„â€œæ•ˆæœè¯„ä¼°â€ã€‚ç”±äºä»»ä½•å¾®å°çš„å˜æ›´éƒ½å¯èƒ½å¼•å‘æ•ˆæœçš„å‰§çƒˆæ³¢åŠ¨ï¼ŒA/B æµ‹è¯•å·²ä»è¿‡å»çš„ä¼˜åŒ–é€‰é¡¹ï¼Œè½¬å˜ä¸ºä¿éšœç‰ˆæœ¬è´¨é‡çš„æ ¸å¿ƒå‘å¸ƒæµç¨‹ã€‚è½¯ä»¶å·¥ç¨‹é‡å¿ƒä¹Ÿå¿…é¡»ä»ä»¥ä»£ç ä¸ºä¸­å¿ƒè½¬å‘ä»¥æ•°æ®ä¸ºä¸­å¿ƒï¼ŒæˆåŠŸçš„å…³é”®åœ¨äºæ„å»ºä¸€ä¸ªé«˜æ•ˆçš„æ•°æ®é£è½®ã€‚</p>
<p>é¢å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼ŒAgentScope æä¾›äº† Studioã€RM Gallery å’Œ Trinity-RFT ç­‰ä¸€ç³»åˆ—ç”Ÿæ€å·¥å…·ï¼Œç»“åˆ Higress AI ç½‘å…³å’Œå¯è§‚æµ‹ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå®è·µ AI åŸç”Ÿåº”ç”¨æ•°æ®é£è½®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/869488f900334ff785218cf8991ba100~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766396803&amp;x-signature=NGCD4iN%2FPsiVCl4yld8V4v15CrU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ Agent å¼€å‘é˜¶æ®µï¼Œæˆ‘ä»¬é‡‡ç”¨ AgentScope Studio å¯è§†åŒ–å¹³å°å¯¹ Agent è¿›è¡Œå®æ—¶è°ƒè¯•ä¸è§‚æµ‹ï¼Œæ˜¾è‘—æå‡äº†å¼€å‘æ•ˆç‡ï¼Œå®ƒæ·±åº¦é›†æˆäº† OpenTelemetry å’Œ LoongSuiteï¼Œå®ç°äº†ç«¯åˆ°ç«¯çš„å…¨é“¾è·¯è¿½è¸ªã€‚</p>
<p>åœ¨éƒ¨ç½²æ¶æ„ä¸­ï¼ŒHigress ä½œä¸ºç»Ÿä¸€çš„æµé‡å…¥å£ç½‘å…³ï¼Œè´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚è·¯ç”±è‡³ç›¸åº”çš„ Agentã€‚Agent åˆ™é€šè¿‡ Higress å†…ç½®çš„ AI ç½‘å…³èƒ½åŠ›ä¸ LLM é€šä¿¡ã€‚å€ŸåŠ© Higress å¼ºå¤§çš„æ’ä»¶ä½“ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æµé‡è¿›è¡Œçµæ´»æ‰“æ ‡ï¼Œä»è€Œå®ç°å¯¹ Agent å’Œ LLM çš„ç²¾å‡†è·¯ç”±æ§åˆ¶ã€‚</p>
<p>åœ¨å‘å¸ƒåçš„ A/B æµ‹è¯•é˜¶æ®µï¼ŒHigress ç½‘å…³èƒ½æ ¹æ®è¯·æ±‚å†…å®¹ï¼ˆå¦‚ç”¨æˆ·åœ°ç†ä½ç½®ã€ä¸šåŠ¡çº¿ã€ä»˜è´¹çŠ¶æ€ç­‰ï¼‰å°†æµé‡åˆ†é…åˆ°ä¸åŒå®éªŒç»„ã€‚ä¾‹å¦‚ï¼Œå°†ä»˜è´¹ç”¨æˆ·å¯¼å‘ Agent çš„ A ç‰ˆæœ¬ï¼Œå…è´¹ç”¨æˆ·å¯¼å‘ B ç‰ˆæœ¬ï¼Œä»¥è¿›è¡Œæ•ˆæœå¯¹æ¯”ã€‚åŒæ—¶æµé‡çš„åˆ†ç»„æ ‡ç­¾ä¼šå€ŸåŠ©å¯è§‚æµ‹åœ¨æ•´ä¸ªè°ƒç”¨é“¾è·¯ä¸­é€ä¼ ã€‚è¿™æ ·ï¼ŒAI ç½‘å…³ä¾¿èƒ½æ ¹æ®æ­¤æ ‡ç­¾å°†è¯·æ±‚è·¯ç”±åˆ°å¯¹åº”çš„ LLM ç‰ˆæœ¬ã€‚è¿™ä¸€æœºåˆ¶è®©æˆ‘ä»¬åœ¨æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°äº† Agent ä¸ LLM çš„ååŒ A/B æµ‹è¯•ã€‚</p>
<p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå…¨é“¾è·¯äº§ç”Ÿçš„æ‰€æœ‰æ•°æ®â€”â€”ä»ç”¨æˆ·è¾“å…¥ã€Agent çš„æç¤ºè¯ï¼ˆPromptï¼‰ï¼Œåˆ°æ¨¡å‹çš„è¾“å‡ºã€æ—¶å»¶ä¸æˆæœ¬éƒ½ä¼šä¸ŠæŠ¥åˆ°å¯è§‚æµ‹ç³»ç»Ÿä¸­ã€‚åŸºäº RM Gallery çš„å¥–åŠ±å‡½æ•°è¯„ä¼° Agent åœ¨å„å®éªŒç»„çš„ä¸šåŠ¡è¡¨ç°ï¼Œå¹¶ç­›é€‰æ²‰æ·€é«˜è´¨é‡çš„æ•°æ®é›†ã€‚éšåï¼Œæˆ‘ä»¬çš„è®­ç»ƒæ¡†æ¶ Trinity-RFT ä¼šè¿ç”¨è¿™äº›æ•°æ®é›†å’Œå¥–åŠ±æ¨¡å‹ï¼Œé€šè¿‡å¼ºåŒ–å­¦ä¹ å¯¹æ¨¡å‹è¿›è¡ŒæŒç»­è¿­ä»£ï¼Œä¸æ–­æå‡å…¶è§£å†³ä¸šåŠ¡é—®é¢˜çš„èƒ½åŠ›ã€‚</p>
<p>æœ€ç»ˆï¼Œè¿™å½¢æˆäº†ä¸€ä¸ªä»¥æ•°æ®ä¸ºé©±åŠ¨çš„è‡ªæˆ‘ä¼˜åŒ–é—­ç¯ã€‚ç³»ç»Ÿé€šè¿‡æŒç»­é‡‡é›†çº¿ä¸ŠçœŸå®æ•°æ®ã€åˆ†æè¯„ä¼°æ•ˆæœå¹¶è½¬åŒ–ä¸ºé«˜è´¨é‡çš„è®­ç»ƒæ•°æ®ï¼Œä¸æ–­å¢å¼ºæ¨¡å‹èƒ½åŠ›ï¼Œæ„ç­‘èµ·åšå®çš„æŠ€æœ¯ç«äº‰å£å’ã€‚</p>
<h2 data-id="heading-5">AgentScope Java Roadmap</h2>
<ul>
<li>ä¸Šä¸‹æ–‡å·¥ç¨‹æŒç»­ä¼˜åŒ–ï¼šAgent æ•ˆæœä¸å¤Ÿå¥½çš„åŸå› ï¼Œè¦ä¹ˆæ˜¯æ¨¡å‹èƒ½åŠ›ä¸å¤Ÿå¼ºï¼Œè¦ä¹ˆæ˜¯æä¾›çš„ä¸Šä¸‹æ–‡ä¸å‡†ç¡®ï¼Œä¸Šä¸‹æ–‡å·¥ç¨‹æ˜¯å·¥ç¨‹èƒ½åŠ›çš„æ ¸å¿ƒã€‚AgentScope Java ä¼šæŒç»­æ·±è€•ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼Œè‡´åŠ›äºæ„å»ºä¸€ä¸ªæ›´åŠ é«˜æ•ˆã€ä½å»¶è¿Ÿçš„ä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿã€‚æœªæ¥å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒä¸Šä¸‹æ–‡çš„æŠ€æœ¯ç»†èŠ‚ï¼Œåªéœ€è¦ä¸“æ³¨äºå®šä¹‰å¥½ Agent çš„åŠŸèƒ½ã€‚</li>
<li>å®æ—¶å…¨æ¨¡æ€æ”¯æŒï¼šå¤§æ¨¡å‹çš„è¾¹ç•Œæ­£åœ¨ä»æ–‡æœ¬æ‰©å±•è‡³å›¾åƒã€è¯­éŸ³ä¹ƒè‡³è§†é¢‘ï¼Œèƒ½å¤Ÿä¸ç‰©ç†ä¸–ç•Œäº’åŠ¨çš„å…·èº«æ™ºèƒ½äº§å“å¼€å§‹è¿›å…¥æˆ‘ä»¬çš„ç”Ÿæ´»ï¼ŒAgentScope Java ä¼šæ„å»ºå¯¹å®æ—¶å…¨æ¨¡æ€çš„æ·±åº¦æ”¯æŒï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°å¼€å‘å¤šæ¨¡æ€çš„åº”ç”¨ï¼Œæœªæ¥ Agent ä¸åªæ˜¯æ–‡æœ¬è¾“å…¥ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡â€œçœ¼ç›â€ã€â€œè€³æœµâ€å’Œâ€œæ‰‹â€æ›´å¥½åœ°æœåŠ¡ç”¨æˆ·ã€‚</li>
<li>è¯„ä¼°ä¸å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼šæˆ‘ä»¬å·²ç»æä¾›äº†è§‚æµ‹ã€è¯„ä¼°ã€ä¼˜åŒ–çš„æ•´ä½“è§£å†³æ–¹æ¡ˆï¼Œä½†ç›®å‰è¯„ä¼°å’Œå¼ºåŒ–å­¦ä¹ çš„é—¨æ§›ä»æ—§æ¯”è¾ƒé«˜ã€‚åç»­ä¼šä¸æ–­é€šè¿‡ç”Ÿæ€é›†æˆé™ä½é—¨æ§›ï¼Œå¼€å‘è€…åªéœ€ç¼–å†™ä¸šåŠ¡é€»è¾‘ä¸è®¾è®¡å¥–åŠ±å‡½æ•°ï¼Œå³å¯å€ŸåŠ© AgentScope çš„ç”Ÿæ€å·¥å…·é“¾ï¼Œè®© Agent åœ¨ä¸ç”¨æˆ·æˆ–ç¯å¢ƒçš„äº¤äº’ä¸­ä¸æ–­è¿›åŒ–ï¼Œå®ç°çœŸæ­£çš„è‡ªæˆ‘æˆé•¿ä¸è¿­ä»£ã€‚</li>
</ul>
<p>AgentScope Java ç‰ˆ Github åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fagentscope-ai%2Fagentscope-java" target="_blank" title="https://github.com/agentscope-ai/agentscope-java" ref="nofollow noopener noreferrer">github.com/agentscope-â€¦</a></p>
<p>å¸®åŠ©æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjava.agentscope.io%2Fen%2Fintro.html" target="_blank" title="https://java.agentscope.io/en/intro.html" ref="nofollow noopener noreferrer">java.agentscope.io/en/intro.htâ€¦</a></p>
<p>å¦‚æœä½ è§‰å¾— AgentScope Java ä¸é”™ï¼Œæ¬¢è¿ç»™æˆ‘ä»¬çš„é¡¹ç›® StarÂ å¹¶åŠ å…¥æˆ‘ä»¬å¼€æºç¤¾åŒºï¼Œä¸€èµ·æ„å»ºé¢å‘æœªæ¥çš„ Agent ä½“ç³»ï¼</p>
<p>AgentScope Java å’Œ Spring AI Alibaba æœ‰å“ªäº›ä¸åŒï¼Œè¯·æŸ¥çœ‹ï¼šã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzIwODYwNTA4MA%3D%3D%26mid%3D2247486409%26idx%3D1%26sn%3Da934c815a81fec948c9e146223aab8f9%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzIwODYwNTA4MA==&amp;mid=2247486409&amp;idx=1&amp;sn=a934c815a81fec948c9e146223aab8f9&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Spring AI Alibaba å’Œ AgentScope å•¥åŒºåˆ«ï¼Ÿ</a>ã€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›½é™…åŒ–è¯­è¨€åŒ…ä¸Excelè‡ªåŠ¨åŒ–åŒå‘è½¬æ¢æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7583469866008887331</link>    <guid>https://juejin.cn/post/7583469866008887331</guid>    <pubDate>2025-12-15T03:23:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583469866008887331" data-draft-id="7583510227146047503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›½é™…åŒ–è¯­è¨€åŒ…ä¸Excelè‡ªåŠ¨åŒ–åŒå‘è½¬æ¢æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-15T03:23:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜åŒå­¦æœ‰ç‚¹å¿™"/> <meta itemprop="url" content="https://juejin.cn/user/4318537402555224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›½é™…åŒ–è¯­è¨€åŒ…ä¸Excelè‡ªåŠ¨åŒ–åŒå‘è½¬æ¢æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4318537402555224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜åŒå­¦æœ‰ç‚¹å¿™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T03:23:00.000Z" title="Mon Dec 15 2025 03:23:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">ä¸€ã€æ–¹æ¡ˆèƒŒæ™¯</h2>
<p>åœ¨å›½é™…åŒ–é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¤šè¯­è¨€èµ„æºï¼ˆlocalesè¯­è¨€åŒ…ï¼‰çš„ç®¡ç†é€šå¸¸è¦ç»å†ä¸‹é¢çš„æµç¨‹ï¼š</p>
<ol>
<li>å¼€å‘äººå‘˜é€šè¿‡æœºç¿»åˆæ­¥æ•´ç†å¥½ä¸€ä»½è¯­è¨€åŒ…</li>
<li>æŠŠè¯­è¨€åŒ…è½¬æˆExceläº¤ä»˜ç»™ç¿»è¯‘å›¢é˜Ÿäººå·¥ç¿»è¯‘</li>
<li>æŠŠäººå·¥ç¿»è¯‘å¥½çš„Excelé‡æ–°è½¬æ¢ä¸ºè¯­è¨€åŒ…ä¸”éœ€ä¿è¯å…¶æ­£ç¡®æ€§</li>
</ol>
<p>è¿™ç§æ‰‹åŠ¨è½¬æ¢çš„æ–¹å¼å­˜åœ¨æ•ˆç‡ä½ä¸‹ã€å®¹æ˜“å‡ºé”™çš„é—®é¢˜ã€‚å› æ­¤éœ€è¦è®¾è®¡ä¸€å¥—è‡ªåŠ¨è½¬æ¢æ–¹æ¡ˆï¼Œå®ç°è¯­è¨€åŒ…å’ŒExcelçš„è‡ªåŠ¨åŒ–åŒå‘è½¬æ¢ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ–¹æ¡ˆç›®æ ‡</h2>
<ol>
<li>å®ç°è¯­è¨€åŒ…å’ŒExcelçš„è‡ªåŠ¨åŒ–åŒå‘è½¬æ¢ã€‚</li>
<li>Exceléœ€åŒ…å«"åŠŸèƒ½æ¨¡å—"åˆ—ï¼Œæ–¹ä¾¿å®šä½è¯­è¨€åŒ…ä¸­å­—æ®µå¯¹åº”é¡µé¢çš„å…·ä½“ä½ç½®ã€‚</li>
<li>è‹¥å­˜åœ¨ä¸­æ–‡è¯­è¨€åŒ…ï¼Œè½¬æ¢æˆExcelæ—¶æŠŠä¸­æ–‡åˆ—æ”¾åœ¨å…¶å®ƒè¯­è¨€åˆ—å‰é¢ï¼Œæ–¹ä¾¿ç¿»è¯‘å¯¹ç…§ã€‚</li>
<li>åŸºäºTypeScriptçš„é¡¹ç›®ï¼Œéœ€æä¾›å®Œæ•´çš„ç±»å‹æ”¯æŒã€‚</li>
</ol>
<h2 data-id="heading-2">ä¸‰ã€æŠ€æœ¯é€‰å‹ä¸ç›®å½•ç»“æ„è®¾è®¡</h2>
<h3 data-id="heading-3">3.1 æŠ€æœ¯é€‰å‹</h3>
<ul>
<li>æ ¸å¿ƒæ¡†æ¶ï¼šVue3 + Vite + TypeScript</li>
<li>å›½é™…åŒ–æ–¹æ¡ˆï¼švue-i18n</li>
<li>è¯­è¨€åŒ…æ ¼å¼ï¼šYAMLï¼ˆæ”¯æŒæ³¨é‡ŠåŠŸèƒ½ï¼‰</li>
<li>è¡¨æ ¼å¤„ç†ï¼šxlsx åº“</li>
<li>è‡ªåŠ¨åŒ–å·¥å…·ï¼šNode.jsè„šæœ¬ï¼Œè„šæœ¬å¯ä»¥è€ƒè™‘å¤§æ¨¡å‹å®ç°</li>
</ul>
<h3 data-id="heading-4">3.2 ç›®å½•ç»“æ„</h3>
<pre><code class="hljs language-plaintext" lang="plaintext">â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–ä¸è„šæœ¬é…ç½®
â”œâ”€â”€ vite.config.ts                # Viteé…ç½®æ–‡ä»¶
â”œâ”€â”€ build/
â”‚   â””â”€â”€ vite-plugin-i18n-types.ts # è‡ªåŠ¨ç”Ÿæˆç±»å‹å£°æ˜çš„Viteæ’ä»¶
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ i18n/
â”‚       â”œâ”€â”€ yaml2xlsx.js          # YAMLè½¬Excelè„šæœ¬
â”‚       â”œâ”€â”€ xlsx2yaml.js          # Excelè½¬YAMLè„šæœ¬
â”‚       â””â”€â”€ output/
â”‚           â”œâ”€â”€ translations.xlsx # ç”Ÿæˆçš„Excelæ–‡ä»¶
â”‚           â””â”€â”€ locales/          # ä»Excelç”Ÿæˆçš„è¯­è¨€åŒ…
â”œâ”€â”€ types/
â”‚   â””â”€â”€ i18n.d.ts                 # è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å£°æ˜æ–‡ä»¶
â””â”€â”€ src/
    â”œâ”€â”€ i18n/
    â”‚   â”œâ”€â”€ index.ts              # i18né…ç½®å…¥å£
    â”‚   â””â”€â”€ locales/
    â”‚       â”œâ”€â”€ zh-CN.yaml        # ä¸­æ–‡è¯­è¨€åŒ…
    â”‚       â”œâ”€â”€ en-US.yaml        # è‹±æ–‡è¯­è¨€åŒ…
    â”‚       â””â”€â”€ ...               # å…¶ä»–è¯­è¨€åŒ…
    â””â”€â”€ ...                       # å…¶ä»–ä¸šåŠ¡ä»£ç 
</code></pre>
<h2 data-id="heading-5">å››ã€æ ¸å¿ƒå®ç°æ–¹æ¡ˆ</h2>
<h3 data-id="heading-6">4.1 è¯­è¨€åŒ…è®¾è®¡</h3>
<p>é‡‡ç”¨yamlæ–‡ä»¶ç®¡ç†è¯­è¨€åŒ…ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä¸ç”¨æ›´å¸¸ç”¨çš„jsonæ ¼å¼ï¼Ÿ
è„šæœ¬åœ¨æŠŠè¯­è¨€åŒ…è½¬æ¢ä¸ºExcelæ–‡ä»¶æ—¶ï¼Œéœ€è¦æ ¹æ®ä¸€äº›æ ‡è®°ï¼ˆå¦‚æ³¨é‡Šï¼‰æ¥ç”Ÿæˆã€åŠŸèƒ½æ¨¡å—ã€‘åˆ—ï¼Œè€Œjsonæ ¼å¼ä¸æ”¯æŒæ³¨é‡Šã€‚
jsæˆ–tsä¹Ÿæ”¯æŒæ³¨é‡Šï¼Œä½†å±äºç‰¹å®šå¼€å‘è¯­è¨€çš„æ ¼å¼ï¼Œè€Œéæ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œä¸å¤Ÿé€šç”¨ã€‚
yamlæ˜¯æ”¯æŒæ³¨é‡Šã€å¼€å‘è¯­è¨€æ— å…³çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œä½†å¯¹äºTypeScriptç±»å‹ä¸å‹å¥½ï¼Œéœ€è¦é¢å¤–æ”¯æŒï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼Œåé¢ä¼šæåˆ°ã€‚æ‰€ä»¥æœ€ç»ˆé€‰æ‹©äº†yamlæ ¼å¼ã€‚</p>
</blockquote>
<p>zh-CN.yamlç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># é¦–é¡µ</span>
<span class="hljs-attr">home:</span>
  <span class="hljs-comment"># å¯¼èˆªæ </span>
  <span class="hljs-attr">navbar:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">'é¦–é¡µ'</span>
<span class="hljs-comment"># ç™»å½•é¡µ</span>
<span class="hljs-attr">login:</span>
  <span class="hljs-comment"># è¡¨å•</span>
  <span class="hljs-attr">form:</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">'ç”¨æˆ·å'</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">'å¯†ç '</span>
</code></pre>
<p>en-US.yamlç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># é¦–é¡µ</span>
<span class="hljs-attr">home:</span>
  <span class="hljs-comment"># å¯¼èˆªæ </span>
  <span class="hljs-attr">navbar:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">'Home'</span>
<span class="hljs-comment"># ç™»å½•é¡µ</span>
<span class="hljs-attr">login:</span>
  <span class="hljs-comment"># è¡¨å•</span>
  <span class="hljs-attr">form:</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">'Username'</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">'Password'</span>
</code></pre>
<h3 data-id="heading-7">4.2 YAMLè½¬Excelå®ç°ï¼ˆyaml2xlsx.jsï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span>
<span class="hljs-keyword">import</span> yaml <span class="hljs-keyword">from</span> <span class="hljs-string">'yaml'</span>
<span class="hljs-keyword">import</span> <span class="hljs-variable constant_">XLSX</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'xlsx'</span>
<span class="hljs-keyword">import</span> yargs <span class="hljs-keyword">from</span> <span class="hljs-string">'yargs'</span>
<span class="hljs-keyword">import</span> { hideBin } <span class="hljs-keyword">from</span> <span class="hljs-string">'yargs/helpers'</span>

<span class="hljs-comment">// è·å–å½“å‰æ–‡ä»¶çš„ç›®å½•è·¯å¾„</span>
<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)
<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename)

<span class="hljs-comment">/**
 * åè½¬ä¹‰YAMLå•å¼•å·å­—ç¬¦ä¸²ä¸­çš„è½¬ä¹‰åºåˆ—
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">str</span> - è¦åè½¬ä¹‰çš„å­—ç¬¦ä¸²
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} åè½¬ä¹‰åçš„å­—ç¬¦ä¸²
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">unescapeSingleQuotes</span>(<span class="hljs-params">str</span>) {
  <span class="hljs-comment">// å°†ä¸¤ä¸ªè¿ç»­çš„å•å¼•å·è½¬ä¹‰ä¸ºä¸€ä¸ªå•å¼•å·</span>
  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/''/g</span>, <span class="hljs-string">"'"</span>)
}

<span class="hljs-comment">/**
 * è§£æYAMLæ–‡ä»¶å¹¶æå–æ³¨é‡Šè·¯å¾„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">filePath</span> - YAMLæ–‡ä»¶è·¯å¾„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} è§£æåçš„æ•°æ®å¯¹è±¡ï¼ŒåŒ…å«é”®å€¼å¯¹å’Œæ¨¡å—è·¯å¾„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseYamlWithComments</span>(<span class="hljs-params">filePath</span>) {
  <span class="hljs-comment">// è¯»å–YAMLæ–‡ä»¶å†…å®¹</span>
  <span class="hljs-keyword">const</span> content = fs.<span class="hljs-title function_">readFileSync</span>(filePath, <span class="hljs-string">'utf8'</span>)
  <span class="hljs-comment">// æŒ‰è¡Œåˆ†å‰²å†…å®¹</span>
  <span class="hljs-keyword">const</span> lines = content.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>)
  <span class="hljs-keyword">const</span> result = {}
  <span class="hljs-comment">// æ³¨é‡Šæ ˆï¼Œç”¨äºå­˜å‚¨å½“å‰å±‚çº§çš„æ³¨é‡Š</span>
  <span class="hljs-keyword">const</span> commentStack = []

  <span class="hljs-comment">// å½“å‰è·¯å¾„æ ˆå’Œæ³¨é‡Šè·¯å¾„æ ˆ</span>
  <span class="hljs-keyword">let</span> currentPath = []
  <span class="hljs-keyword">let</span> currentCommentPath = []

  <span class="hljs-comment">// éå†æ¯ä¸€è¡Œ</span>
  lines.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">line, index</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> trimmedLine = line.<span class="hljs-title function_">trim</span>()

    <span class="hljs-comment">// å¦‚æœæ˜¯æ³¨é‡Šè¡Œ</span>
    <span class="hljs-keyword">if</span> (trimmedLine.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
      <span class="hljs-comment">// æå–æ³¨é‡Šå†…å®¹ï¼ˆå»æ‰#å·å¹¶å»é™¤å‰åç©ºæ ¼ï¼‰</span>
      <span class="hljs-keyword">const</span> comment = trimmedLine.<span class="hljs-title function_">substring</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">trim</span>()
      <span class="hljs-keyword">if</span> (comment) {
        <span class="hljs-comment">// å°†æ³¨é‡Šå‹å…¥æ ˆä¸­</span>
        commentStack.<span class="hljs-title function_">push</span>(comment)
      }
      <span class="hljs-keyword">return</span> <span class="hljs-comment">// æ³¨é‡Šè¡Œä¸è¿›è¡Œåç»­å¤„ç†</span>
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯é”®å€¼å¯¹è¡Œï¼ˆåŒ…å«å†’å·ä¸”ä¸æ˜¯æ³¨é‡Šï¼‰</span>
    <span class="hljs-keyword">if</span> (trimmedLine.<span class="hljs-title function_">includes</span>(<span class="hljs-string">':'</span>) &amp;&amp; !trimmedLine.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
      <span class="hljs-comment">// æå–é”®å</span>
      <span class="hljs-keyword">const</span> key = trimmedLine.<span class="hljs-title function_">split</span>(<span class="hljs-string">':'</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">trim</span>()
      <span class="hljs-comment">// è®¡ç®—ç¼©è¿›çº§åˆ«ï¼ˆé€šè¿‡è¡Œé¦–ç©ºæ ¼æ•°é‡ï¼‰</span>
      <span class="hljs-keyword">const</span> indent = line.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^\s*/</span>)[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>

      <span class="hljs-comment">// è®¡ç®—å½“å‰å±‚çº§ï¼ˆå‡è®¾ä½¿ç”¨2ç©ºæ ¼ç¼©è¿›ï¼‰</span>
      <span class="hljs-keyword">const</span> level = indent / <span class="hljs-number">2</span>

      <span class="hljs-comment">// æ ¹æ®å±‚çº§æ›´æ–°è·¯å¾„æ ˆï¼ˆç§»é™¤è¶…å‡ºå½“å‰å±‚çº§çš„éƒ¨åˆ†ï¼‰</span>
      currentPath = currentPath.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, level)
      currentCommentPath = currentCommentPath.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, level)

      <span class="hljs-comment">// å°†å½“å‰é”®æ·»åŠ åˆ°è·¯å¾„æ ˆ</span>
      currentPath.<span class="hljs-title function_">push</span>(key)

      <span class="hljs-comment">// å¤„ç†æ³¨é‡Šè·¯å¾„</span>
      <span class="hljs-keyword">if</span> (commentStack.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å¦‚æœæœ‰æ³¨é‡Šï¼Œå°†å…¶æ·»åŠ åˆ°æ³¨é‡Šè·¯å¾„æ ˆ</span>
        currentCommentPath.<span class="hljs-title function_">push</span>(commentStack.<span class="hljs-title function_">pop</span>())
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentCommentPath.<span class="hljs-property">length</span> &lt; level &amp;&amp; currentCommentPath.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ³¨é‡Šä½†éœ€è¦ç»§æ‰¿çˆ¶çº§æ³¨é‡Šï¼Œä½¿ç”¨çˆ¶çº§æ³¨é‡Š</span>
        currentCommentPath.<span class="hljs-title function_">push</span>(currentCommentPath[currentCommentPath.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>])
      }

      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯å¶å­èŠ‚ç‚¹ï¼ˆåŒ…å«å€¼çš„èŠ‚ç‚¹ï¼‰</span>
      <span class="hljs-keyword">const</span> valueMatch = trimmedLine.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/:\s*(.+)$/</span>)
      <span class="hljs-keyword">if</span> (valueMatch &amp;&amp; valueMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">trim</span>()) {
        <span class="hljs-comment">// æå–å€¼å¹¶å»é™¤å‰åç©ºæ ¼</span>
        <span class="hljs-keyword">let</span> value = valueMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">trim</span>()

        <span class="hljs-comment">// å»é™¤å¯èƒ½å­˜åœ¨çš„å•å¼•å·ï¼ˆYAMLå­—ç¬¦ä¸²æœ‰æ—¶ä¼šç”¨å¼•å·åŒ…è£¹ï¼‰</span>
        <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"'"</span>) &amp;&amp; value.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">"'"</span>)) {
          value = value.<span class="hljs-title function_">substring</span>(<span class="hljs-number">1</span>, value.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)
          <span class="hljs-comment">// åè½¬ä¹‰å•å¼•å·ï¼ˆå°†ä¸¤ä¸ªå•å¼•å·è½¬ä¹‰ä¸ºä¸€ä¸ªå•å¼•å·ï¼‰</span>
          value = unescapeSingleQuotes(value)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'"'</span>) &amp;&amp; value.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'"'</span>)) {
          value = value.<span class="hljs-title function_">substring</span>(<span class="hljs-number">1</span>, value.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)
          <span class="hljs-comment">// å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥å¤„ç†åŒå¼•å·çš„è½¬ä¹‰</span>
        }

        <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„é”®è·¯å¾„ï¼ˆç”¨ç‚¹å·è¿æ¥ï¼‰</span>
        <span class="hljs-keyword">const</span> fullKey = currentPath.<span class="hljs-title function_">join</span>(<span class="hljs-string">'.'</span>)
        <span class="hljs-comment">// æ„å»ºæ¨¡å—è·¯å¾„ï¼ˆç”¨æ–œæ è¿æ¥æ³¨é‡Šï¼‰</span>
        <span class="hljs-keyword">const</span> modulePath = currentCommentPath.<span class="hljs-title function_">join</span>(<span class="hljs-string">'/'</span>)

        <span class="hljs-comment">// å°†ç»“æœå­˜å‚¨åˆ°å¯¹è±¡ä¸­</span>
        result[fullKey] = {
          <span class="hljs-attr">value</span>: value,
          <span class="hljs-attr">module</span>: modulePath,
        }
      }
    }

    <span class="hljs-comment">// é‡ç½®æ³¨é‡Šæ ˆï¼ˆæ³¨é‡Šåªå¯¹ä¸‹ä¸€è¡Œæœ‰æ•ˆï¼‰</span>
    <span class="hljs-keyword">if</span> (!trimmedLine.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>) &amp;&amp; trimmedLine !== <span class="hljs-string">''</span>) {
      commentStack.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
    }
  })

  <span class="hljs-keyword">return</span> result
}

<span class="hljs-comment">/**
 * è®¾ç½®å·¥ä½œè¡¨çš„åˆ—å®½
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">worksheet</span> - XLSXå·¥ä½œè¡¨å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setColumnWidths</span>(<span class="hljs-params">worksheet</span>) {
  <span class="hljs-comment">// å®šä¹‰åˆ—å®½é…ç½®</span>
  <span class="hljs-keyword">const</span> colWidths = [
    { <span class="hljs-attr">wch</span>: <span class="hljs-number">30</span> }, <span class="hljs-comment">// åŠŸèƒ½æ¨¡å—åˆ—å®½ï¼š30å­—ç¬¦</span>
    { <span class="hljs-attr">wch</span>: <span class="hljs-number">40</span> }, <span class="hljs-comment">// keyåˆ—å®½ï¼š40å­—ç¬¦</span>
  ]

  <span class="hljs-comment">// è·å–å·¥ä½œè¡¨çš„èŒƒå›´</span>
  <span class="hljs-keyword">const</span> range = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">decode_range</span>(worksheet[<span class="hljs-string">'!ref'</span>])
  <span class="hljs-keyword">const</span> numCols = range.<span class="hljs-property">e</span>.<span class="hljs-property">c</span> - range.<span class="hljs-property">s</span>.<span class="hljs-property">c</span> + <span class="hljs-number">1</span>

  <span class="hljs-comment">// ä¸ºè¯­è¨€åˆ—è®¾ç½®å›ºå®šå®½åº¦ï¼ˆä»ç¬¬ä¸‰åˆ—å¼€å§‹ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt; numCols; i++) {
    colWidths.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">wch</span>: <span class="hljs-number">20</span> }) <span class="hljs-comment">// è¯­è¨€åˆ—å®½ï¼š20å­—ç¬¦</span>
  }

  <span class="hljs-comment">// å°†åˆ—å®½é…ç½®åº”ç”¨åˆ°å·¥ä½œè¡¨</span>
  worksheet[<span class="hljs-string">'!cols'</span>] = colWidths
}

<span class="hljs-comment">/**
 * è®¾ç½®è¡Œé«˜
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">worksheet</span> - XLSXå·¥ä½œè¡¨å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setRowHeights</span>(<span class="hljs-params">worksheet</span>) {
  <span class="hljs-comment">// è·å–å·¥ä½œè¡¨çš„èŒƒå›´</span>
  <span class="hljs-keyword">const</span> range = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">decode_range</span>(worksheet[<span class="hljs-string">'!ref'</span>])

  <span class="hljs-comment">// éå†æ¯ä¸€è¡Œè®¾ç½®è¡Œé«˜</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> row = range.<span class="hljs-property">s</span>.<span class="hljs-property">r</span>; row &lt;= range.<span class="hljs-property">e</span>.<span class="hljs-property">r</span>; row++) {
    <span class="hljs-comment">// ç¡®ä¿è¡Œé…ç½®æ•°ç»„å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!worksheet[<span class="hljs-string">'!rows'</span>]) worksheet[<span class="hljs-string">'!rows'</span>] = []
    <span class="hljs-comment">// è®¾ç½®è¡Œé«˜ï¼Œæ ‡é¢˜è¡Œï¼ˆç¬¬0è¡Œï¼‰ç¨é«˜ä¸€äº›</span>
    worksheet[<span class="hljs-string">'!rows'</span>][row] = { <span class="hljs-attr">hpt</span>: row === <span class="hljs-number">0</span> ? <span class="hljs-number">25</span> : <span class="hljs-number">20</span> }
  }
}

<span class="hljs-comment">/**
 * å¯¹è¯­è¨€è¿›è¡Œæ’åºï¼Œç¡®ä¿zh-CNåœ¨æœ€å‰é¢
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">languages</span> - è¯­è¨€ä»£ç æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Array</span>} æ’åºåçš„è¯­è¨€æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sortLanguages</span>(<span class="hljs-params">languages</span>) {
  <span class="hljs-keyword">return</span> [...languages].<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
    <span class="hljs-comment">// zh-CNå§‹ç»ˆæ’åœ¨æœ€å‰é¢</span>
    <span class="hljs-keyword">if</span> (a === <span class="hljs-string">'zh-CN'</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span> (b === <span class="hljs-string">'zh-CN'</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
    <span class="hljs-comment">// å…¶ä»–è¯­è¨€æŒ‰å­—æ¯é¡ºåºæ’åº</span>
    <span class="hljs-keyword">return</span> a.<span class="hljs-title function_">localeCompare</span>(b)
  })
}

<span class="hljs-comment">/**
 * å°†ç›®å½•ä¸‹çš„æ‰€æœ‰YAMLæ–‡ä»¶è½¬æ¢ä¸ºXLSXæ ¼å¼
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">inputDir</span> - è¾“å…¥ç›®å½•è·¯å¾„ï¼ˆåŒ…å«YAMLæ–‡ä»¶ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">outputFile</span> - è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆXLSXæ–‡ä»¶ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">convertYamlDirToXlsx</span>(<span class="hljs-params">inputDir, outputFile</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ç¡®ä¿è¾“å…¥ç›®å½•å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(inputDir)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`è¾“å…¥ç›®å½•ä¸å­˜åœ¨: <span class="hljs-subst">${inputDir}</span>`</span>)
    }

    <span class="hljs-comment">// è¯»å–ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶</span>
    <span class="hljs-keyword">const</span> files = fs.<span class="hljs-title function_">readdirSync</span>(inputDir)
    <span class="hljs-comment">// è¿‡æ»¤å‡ºYAMLæ–‡ä»¶ï¼ˆæ”¯æŒ.yamlå’Œ.ymlæ‰©å±•åï¼‰</span>
    <span class="hljs-keyword">const</span> yamlFiles = files.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> file.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.yaml'</span>) || file.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.yml'</span>))

    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°YAMLæ–‡ä»¶ï¼Œæç¤ºå¹¶é€€å‡º</span>
    <span class="hljs-keyword">if</span> (yamlFiles.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœªæ‰¾åˆ°YAMLæ–‡ä»¶'</span>)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰è¯­è¨€çš„æ•°æ®</span>
    <span class="hljs-keyword">const</span> allData = {}
    <span class="hljs-keyword">const</span> languages = []

    <span class="hljs-comment">// å¤„ç†æ¯ä¸ªYAMLæ–‡ä»¶</span>
    yamlFiles.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> {
      <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„æ–‡ä»¶è·¯å¾„</span>
      <span class="hljs-keyword">const</span> filePath = path.<span class="hljs-title function_">join</span>(inputDir, file)
      <span class="hljs-comment">// ä»æ–‡ä»¶åæå–è¯­è¨€ä»£ç ï¼ˆå»æ‰æ‰©å±•åï¼‰</span>
      <span class="hljs-keyword">const</span> language = path.<span class="hljs-title function_">basename</span>(file, path.<span class="hljs-title function_">extname</span>(file))
      <span class="hljs-comment">// å°†è¯­è¨€ä»£ç æ·»åŠ åˆ°è¯­è¨€æ•°ç»„</span>
      languages.<span class="hljs-title function_">push</span>(language)

      <span class="hljs-comment">// è§£æYAMLæ–‡ä»¶</span>
      <span class="hljs-keyword">const</span> parsedData = <span class="hljs-title function_">parseYamlWithComments</span>(filePath)

      <span class="hljs-comment">// å°†è§£æåçš„æ•°æ®æŒ‰keyç»„ç»‡</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(parsedData).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, data]</span>) =&gt;</span> {
        <span class="hljs-comment">// å¦‚æœè¯¥keyå°šæœªå­˜åœ¨ï¼Œåˆå§‹åŒ–æ•°æ®ç»“æ„</span>
        <span class="hljs-keyword">if</span> (!allData[key]) {
          allData[key] = {
            <span class="hljs-attr">module</span>: data.<span class="hljs-property">module</span>,
            <span class="hljs-attr">translations</span>: {},
          }
        }
        <span class="hljs-comment">// å­˜å‚¨è¯¥è¯­è¨€çš„ç¿»è¯‘å€¼</span>
        allData[key].<span class="hljs-property">translations</span>[language] = data.<span class="hljs-property">value</span>
      })
    })

    <span class="hljs-comment">// å¯¹è¯­è¨€è¿›è¡Œæ’åºï¼Œç¡®ä¿zh-CNåœ¨æœ€å‰é¢</span>
    <span class="hljs-keyword">const</span> sortedLanguages = <span class="hljs-title function_">sortLanguages</span>([...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(languages)])

    <span class="hljs-comment">// å‡†å¤‡XLSXæ•°æ®</span>
    <span class="hljs-keyword">const</span> worksheetData = []

    <span class="hljs-comment">// æ·»åŠ è¡¨å¤´è¡Œ</span>
    <span class="hljs-keyword">const</span> headers = [<span class="hljs-string">'åŠŸèƒ½æ¨¡å—'</span>, <span class="hljs-string">'key'</span>, ...sortedLanguages]
    worksheetData.<span class="hljs-title function_">push</span>(headers)

    <span class="hljs-comment">// æ·»åŠ æ•°æ®è¡Œ</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(allData).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, data]</span>) =&gt;</span> {
      <span class="hljs-comment">// åˆ›å»ºæ–°è¡Œï¼šåŠŸèƒ½æ¨¡å—å’Œkey</span>
      <span class="hljs-keyword">const</span> row = [data.<span class="hljs-property">module</span>, key]

      <span class="hljs-comment">// æŒ‰æ’åºåçš„è¯­è¨€é¡ºåºæ·»åŠ ç¿»è¯‘å€¼</span>
      sortedLanguages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">language</span>) =&gt;</span> {
        <span class="hljs-comment">// å¦‚æœè¯¥è¯­è¨€æœ‰ç¿»è¯‘å€¼åˆ™æ·»åŠ ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²</span>
        row.<span class="hljs-title function_">push</span>(data.<span class="hljs-property">translations</span>[language] || <span class="hljs-string">''</span>)
      })

      <span class="hljs-comment">// å°†è¡Œæ·»åŠ åˆ°å·¥ä½œè¡¨æ•°æ®</span>
      worksheetData.<span class="hljs-title function_">push</span>(row)
    })

    <span class="hljs-comment">// åˆ›å»ºæ–°çš„workbookå’Œå·¥ä½œè¡¨</span>
    <span class="hljs-keyword">const</span> workbook = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">book_new</span>()
    <span class="hljs-keyword">const</span> worksheet = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">aoa_to_sheet</span>(worksheetData)

    <span class="hljs-comment">// è®¾ç½®åˆ—å®½å’Œè¡Œé«˜</span>
    <span class="hljs-title function_">setColumnWidths</span>(worksheet)
    <span class="hljs-title function_">setRowHeights</span>(worksheet)

    <span class="hljs-comment">// æ·»åŠ æ ·å¼ï¼šæ ‡é¢˜è¡ŒåŠ ç²—å¹¶å±…ä¸­å¯¹é½</span>
    <span class="hljs-keyword">const</span> headerRange = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">decode_range</span>(worksheet[<span class="hljs-string">'!ref'</span>])
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> col = headerRange.<span class="hljs-property">s</span>.<span class="hljs-property">c</span>; col &lt;= headerRange.<span class="hljs-property">e</span>.<span class="hljs-property">c</span>; col++) {
      <span class="hljs-keyword">const</span> cellAddress = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">encode_cell</span>({ <span class="hljs-attr">r</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">c</span>: col })
      <span class="hljs-comment">// å¦‚æœå•å…ƒæ ¼å­˜åœ¨ï¼Œè®¾ç½®æ ·å¼</span>
      <span class="hljs-keyword">if</span> (worksheet[cellAddress]) {
        worksheet[cellAddress].<span class="hljs-property">s</span> = {
          <span class="hljs-attr">font</span>: { <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span> },
          <span class="hljs-attr">alignment</span>: { <span class="hljs-attr">vertical</span>: <span class="hljs-string">'center'</span>, <span class="hljs-attr">horizontal</span>: <span class="hljs-string">'center'</span> },
        }
      }
    }

    <span class="hljs-comment">// æ·»åŠ worksheetåˆ°workbook</span>
    <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">book_append_sheet</span>(workbook, worksheet, <span class="hljs-string">'ç¿»è¯‘æ•°æ®'</span>)

    <span class="hljs-comment">// ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨</span>
    <span class="hljs-keyword">const</span> outputDir = path.<span class="hljs-title function_">dirname</span>(outputFile)
    <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(outputDir)) {
      <span class="hljs-comment">// é€’å½’åˆ›å»ºç›®å½•</span>
      fs.<span class="hljs-title function_">mkdirSync</span>(outputDir, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> })
    }

    <span class="hljs-comment">// å†™å…¥æ–‡ä»¶</span>
    <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-title function_">writeFile</span>(workbook, outputFile)

    <span class="hljs-comment">// è¾“å‡ºæˆåŠŸä¿¡æ¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… è½¬æ¢å®Œæˆï¼`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“ è¾“å…¥ç›®å½•: <span class="hljs-subst">${inputDir}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“„ è¾“å‡ºæ–‡ä»¶: <span class="hljs-subst">${outputFile}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸŒ å¤„ç†äº† <span class="hljs-subst">${yamlFiles.length}</span> ä¸ªè¯­è¨€æ–‡ä»¶: <span class="hljs-subst">${sortedLanguages.join(<span class="hljs-string">', '</span>)}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“Š åˆ—é¡ºåº: åŠŸèƒ½æ¨¡å—, key, <span class="hljs-subst">${sortedLanguages.join(<span class="hljs-string">', '</span>)}</span>`</span>)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ è½¬æ¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:'</span>, error.<span class="hljs-property">message</span>)
    process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
  }
}

<span class="hljs-comment">// é…ç½®å‘½ä»¤è¡Œå‚æ•°</span>
<span class="hljs-keyword">const</span> argv = <span class="hljs-title function_">yargs</span>(<span class="hljs-title function_">hideBin</span>(process.<span class="hljs-property">argv</span>))
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'input'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'i'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'YAMLæ–‡ä»¶æ‰€åœ¨ç›®å½•è·¯å¾„'</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'./locales'</span>,
  })
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'output'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'o'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'è¾“å‡ºçš„XLSXæ–‡ä»¶è·¯å¾„'</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'./output/translations.xlsx'</span>,
  })
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'config'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'c'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'é…ç½®æ–‡ä»¶è·¯å¾„'</span>,
  })
  .<span class="hljs-title function_">help</span>() <span class="hljs-comment">// æ·»åŠ å¸®åŠ©ä¿¡æ¯</span>
  .<span class="hljs-title function_">alias</span>(<span class="hljs-string">'help'</span>, <span class="hljs-string">'h'</span>) <span class="hljs-comment">// è®¾ç½®å¸®åŠ©å‘½ä»¤åˆ«å</span>
  .<span class="hljs-title function_">version</span>() <span class="hljs-comment">// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯</span>
  .<span class="hljs-title function_">alias</span>(<span class="hljs-string">'version'</span>, <span class="hljs-string">'v'</span>).<span class="hljs-property">argv</span> <span class="hljs-comment">// è®¾ç½®ç‰ˆæœ¬å‘½ä»¤åˆ«å // è§£æå‘½ä»¤è¡Œå‚æ•°</span>

<span class="hljs-comment">/**
 * ä¸»å‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å¦‚æœæœ‰é…ç½®æ–‡ä»¶ï¼Œè¯»å–é…ç½®æ–‡ä»¶</span>
  <span class="hljs-keyword">if</span> (argv.<span class="hljs-property">config</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è§£æé…ç½®æ–‡ä»¶è·¯å¾„</span>
      <span class="hljs-keyword">const</span> configPath = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), argv.<span class="hljs-property">config</span>)
      <span class="hljs-comment">// è¯»å–å¹¶è§£æé…ç½®æ–‡ä»¶</span>
      <span class="hljs-keyword">const</span> config = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(configPath, <span class="hljs-string">'utf8'</span>))

      <span class="hljs-comment">// åˆå¹¶é…ç½®å‚æ•°ï¼ˆå‘½ä»¤è¡Œå‚æ•°ä¼˜å…ˆäºé…ç½®æ–‡ä»¶ï¼‰</span>
      <span class="hljs-keyword">const</span> finalInput = argv.<span class="hljs-property">input</span> !== <span class="hljs-string">'./locales'</span> ? argv.<span class="hljs-property">input</span> : config.<span class="hljs-property">input</span> || <span class="hljs-string">'./locales'</span>
      <span class="hljs-keyword">const</span> finalOutput =
        argv.<span class="hljs-property">output</span> !== <span class="hljs-string">'./output/translations.xlsx'</span>
          ? argv.<span class="hljs-property">output</span>
          : config.<span class="hljs-property">output</span> || <span class="hljs-string">'./output/translations.xlsx'</span>

      <span class="hljs-comment">// æ‰§è¡Œè½¬æ¢</span>
      <span class="hljs-title function_">convertYamlDirToXlsx</span>(finalInput, finalOutput)
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ è¯»å–é…ç½®æ–‡ä»¶å¤±è´¥:'</span>, error.<span class="hljs-property">message</span>)
      process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°</span>
    <span class="hljs-title function_">convertYamlDirToXlsx</span>(argv.<span class="hljs-property">input</span>, argv.<span class="hljs-property">output</span>)
  }
}

<span class="hljs-title function_">main</span>()
</code></pre>
<h3 data-id="heading-8">4.3 Excelè½¬YAMLå®ç°ï¼ˆxlsx2yaml.jsï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span>
<span class="hljs-keyword">import</span> <span class="hljs-variable constant_">XLSX</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'xlsx'</span>
<span class="hljs-keyword">import</span> yargs <span class="hljs-keyword">from</span> <span class="hljs-string">'yargs'</span>
<span class="hljs-keyword">import</span> { hideBin } <span class="hljs-keyword">from</span> <span class="hljs-string">'yargs/helpers'</span>

<span class="hljs-comment">// è·å–å½“å‰æ–‡ä»¶çš„ç›®å½•è·¯å¾„</span>
<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)
<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename)

<span class="hljs-comment">/**
 * è¯»å–XLSXæ–‡ä»¶å¹¶è§£æä¸ºç»“æ„åŒ–æ•°æ®
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">filePath</span> - XLSXæ–‡ä»¶è·¯å¾„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} åŒ…å«è¯­è¨€æ•°æ®å’Œæ³¨é‡Šæ˜ å°„çš„å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseXlsxFile</span>(<span class="hljs-params">filePath</span>) {
  <span class="hljs-comment">// è¯»å–XLSXæ–‡ä»¶</span>
  <span class="hljs-keyword">const</span> workbook = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-title function_">readFile</span>(filePath)
  <span class="hljs-comment">// è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨</span>
  <span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-property">Sheets</span>[workbook.<span class="hljs-property">SheetNames</span>[<span class="hljs-number">0</span>]]
  <span class="hljs-comment">// å°†å·¥ä½œè¡¨æ•°æ®è½¬æ¢ä¸ºJSON</span>
  <span class="hljs-keyword">const</span> jsonData = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">sheet_to_json</span>(worksheet, { <span class="hljs-attr">header</span>: <span class="hljs-number">1</span> })

  <span class="hljs-keyword">if</span> (jsonData.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'XLSXæ–‡ä»¶æ•°æ®ä¸è¶³ï¼Œè‡³å°‘éœ€è¦è¡¨å¤´å’Œæ•°æ®è¡Œ'</span>)
  }

  <span class="hljs-comment">// æå–è¡¨å¤´ï¼ˆç¬¬ä¸€è¡Œï¼‰</span>
  <span class="hljs-keyword">const</span> headers = jsonData[<span class="hljs-number">0</span>]
  <span class="hljs-comment">// éªŒè¯è¡¨å¤´ç»“æ„</span>
  <span class="hljs-keyword">if</span> (headers[<span class="hljs-number">0</span>] !== <span class="hljs-string">'åŠŸèƒ½æ¨¡å—'</span> || headers[<span class="hljs-number">1</span>] !== <span class="hljs-string">'key'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'XLSXæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼Œå‰ä¸¤åˆ—åº”ä¸º"åŠŸèƒ½æ¨¡å—"å’Œ"key"'</span>)
  }

  <span class="hljs-comment">// æå–è¯­è¨€åˆ—ï¼ˆä»ç¬¬ä¸‰åˆ—å¼€å§‹ï¼‰</span>
  <span class="hljs-keyword">const</span> languages = headers.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>)

  <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ç»“æ„</span>
  <span class="hljs-keyword">const</span> result = {
    <span class="hljs-attr">languages</span>: languages,
    <span class="hljs-attr">data</span>: {},
    <span class="hljs-attr">comments</span>: {}, <span class="hljs-comment">// å­˜å‚¨æ³¨é‡Šæ˜ å°„å…³ç³»</span>
  }

  <span class="hljs-comment">// å¤„ç†æ¯ä¸€è¡Œæ•°æ®ï¼ˆè·³è¿‡è¡¨å¤´ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; jsonData.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> row = jsonData[i]
    <span class="hljs-keyword">if</span> (!row || row.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">continue</span>

    <span class="hljs-keyword">const</span> modulePath = row[<span class="hljs-number">0</span>] <span class="hljs-comment">// åŠŸèƒ½æ¨¡å—è·¯å¾„</span>
    <span class="hljs-keyword">const</span> key = row[<span class="hljs-number">1</span>] <span class="hljs-comment">// é”®è·¯å¾„</span>

    <span class="hljs-comment">// ä¸ºæ¯ç§è¯­è¨€å­˜å‚¨é”®å€¼å¯¹</span>
    languages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">lang, index</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> value = row[<span class="hljs-number">2</span> + index] || <span class="hljs-string">''</span>
      <span class="hljs-keyword">if</span> (!result.<span class="hljs-property">data</span>[lang]) {
        result.<span class="hljs-property">data</span>[lang] = {}
      }

      <span class="hljs-comment">// ä½¿ç”¨ç‚¹å·åˆ†éš”çš„é”®è·¯å¾„è®¾ç½®åµŒå¥—å¯¹è±¡</span>
      <span class="hljs-title function_">setNestedValue</span>(result.<span class="hljs-property">data</span>[lang], key, value)
    })

    <span class="hljs-comment">// å¤„ç†æ³¨é‡Šæ˜ å°„</span>
    <span class="hljs-keyword">if</span> (modulePath) {
      <span class="hljs-comment">// å°†åŠŸèƒ½æ¨¡å—è·¯å¾„ä¸é”®è·¯å¾„å…³è”</span>
      result.<span class="hljs-property">comments</span>[key] = modulePath
    }
  }

  <span class="hljs-keyword">return</span> result
}

<span class="hljs-comment">/**
 * æ ¹æ®ç‚¹å·åˆ†éš”çš„è·¯å¾„è®¾ç½®åµŒå¥—å¯¹è±¡çš„å€¼
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">obj</span> - ç›®æ ‡å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">path</span> - ç‚¹å·åˆ†éš”çš„è·¯å¾„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">value</span> - è¦è®¾ç½®çš„å€¼
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setNestedValue</span>(<span class="hljs-params">obj, path, value</span>) {
  <span class="hljs-keyword">const</span> keys = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)
  <span class="hljs-keyword">let</span> current = obj

  <span class="hljs-comment">// éå†è·¯å¾„ï¼Œåˆ›å»ºåµŒå¥—å¯¹è±¡</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i++) {
    <span class="hljs-keyword">const</span> key = keys[i]
    <span class="hljs-keyword">if</span> (!current[key] || <span class="hljs-keyword">typeof</span> current[key] !== <span class="hljs-string">'object'</span>) {
      current[key] = {}
    }
    current = current[key]
  }

  <span class="hljs-comment">// è®¾ç½®æœ€ç»ˆçš„å€¼</span>
  current[keys[keys.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]] = value
}

<span class="hljs-comment">/**
 * æ„å»ºæ³¨é‡Šæ˜ å°„ï¼Œå°†æ³¨é‡Šåˆ†é…åˆ°æ­£ç¡®çš„YAMLå±‚çº§
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">commentsMap</span> - åŸå§‹çš„æ³¨é‡Šæ˜ å°„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} æŒ‰YAMLå±‚çº§ç»„ç»‡çš„æ³¨é‡Šæ˜ å°„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildHierarchicalComments</span>(<span class="hljs-params">commentsMap</span>) {
  <span class="hljs-keyword">const</span> hierarchicalComments = {}

  <span class="hljs-comment">// éå†æ‰€æœ‰é”®å’Œå¯¹åº”çš„æ³¨é‡Šè·¯å¾„</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(commentsMap).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, commentPath]</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> keyParts = key.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)
    <span class="hljs-keyword">const</span> commentParts = commentPath.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>)

    <span class="hljs-comment">// ä¸ºæ¯ä¸ªå±‚çº§æ„å»ºæ³¨é‡Š</span>
    <span class="hljs-keyword">let</span> currentPath = <span class="hljs-string">''</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keyParts.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// æ„å»ºå½“å‰è·¯å¾„</span>
      currentPath = currentPath ? <span class="hljs-string">`<span class="hljs-subst">${currentPath}</span>.<span class="hljs-subst">${keyParts[i]}</span>`</span> : keyParts[i]

      <span class="hljs-comment">// å¦‚æœå½“å‰å±‚çº§æœ‰å¯¹åº”çš„æ³¨é‡Šéƒ¨åˆ†ï¼Œåˆ™åˆ†é…æ³¨é‡Š</span>
      <span class="hljs-keyword">if</span> (i &lt; commentParts.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// ç¡®ä¿æ¯ä¸ªè·¯å¾„åªåˆ†é…ä¸€æ¬¡æ³¨é‡Šï¼ˆå–ç¬¬ä¸€ä¸ªå‡ºç°çš„ï¼‰</span>
        <span class="hljs-keyword">if</span> (!hierarchicalComments[currentPath]) {
          hierarchicalComments[currentPath] = commentParts[i]
        }
      }
    }
  })

  <span class="hljs-keyword">return</span> hierarchicalComments
}

<span class="hljs-comment">/**
 * è½¬ä¹‰å­—ç¬¦ä¸²ä¸­çš„å•å¼•å·ï¼Œç”¨äºYAMLå•å¼•å·å­—ç¬¦ä¸²
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">str</span> - è¦è½¬ä¹‰çš„å­—ç¬¦ä¸²
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} è½¬ä¹‰åçš„å­—ç¬¦ä¸²
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escapeSingleQuotes</span>(<span class="hljs-params">str</span>) {
  <span class="hljs-comment">// å°†å•å¼•å·è½¬ä¹‰ä¸ºä¸¤ä¸ªå•å¼•å·</span>
  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"''"</span>)
}

<span class="hljs-comment">/**
 * æ ¼å¼åŒ–YAMLå€¼ï¼Œç¡®ä¿å­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·åŒ…è£¹å¹¶æ­£ç¡®å¤„ç†è½¬ä¹‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">value</span> - è¦æ ¼å¼åŒ–çš„å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} æ ¼å¼åŒ–åçš„YAMLå€¼è¡¨ç¤º
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatYamlValue</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span> || value === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"''"</span> <span class="hljs-comment">// ç©ºå€¼ç”¨ç©ºå­—ç¬¦ä¸²è¡¨ç¤º</span>
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'boolean'</span>) {
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// å¸ƒå°”å€¼ç›´æ¥è¾“å‡º</span>
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// æ•°å­—ç›´æ¥è¾“å‡º</span>
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>) {
    <span class="hljs-comment">// ç©ºå­—ç¬¦ä¸²ç”¨ç©ºå­—ç¬¦ä¸²è¡¨ç¤º</span>
    <span class="hljs-keyword">if</span> (value === <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">"''"</span>
    }

    <span class="hljs-comment">// è½¬ä¹‰å­—ç¬¦ä¸²ä¸­çš„å•å¼•å·</span>
    <span class="hljs-keyword">const</span> escapedValue = escapeSingleQuotes(value)

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å¼•å·ï¼ˆåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰</span>
    <span class="hljs-keyword">const</span> needsQuotes =
      <span class="hljs-regexp">/[:{}\[\],&amp;*#?|&lt;&gt;=!%@`]/</span>.<span class="hljs-title function_">test</span>(value) ||
      value.<span class="hljs-title function_">trim</span>() !== value ||
      value.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'\n'</span>) ||
      value.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'\t'</span>)

    <span class="hljs-keyword">if</span> (needsQuotes) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`'<span class="hljs-subst">${escapedValue}</span>'`</span> <span class="hljs-comment">// éœ€è¦å¼•å·çš„æƒ…å†µ</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// ç®€å•å­—ç¬¦ä¸²å¯ä»¥ä¸åŠ å¼•å·ï¼Œä½†ä¸ºäº†ç»Ÿä¸€é£æ ¼ï¼Œæˆ‘ä»¬ä»ç„¶ä½¿ç”¨å•å¼•å·</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">`'<span class="hljs-subst">${escapedValue}</span>'`</span>
    }
  }

  <span class="hljs-comment">// å…¶ä»–ç±»å‹ï¼ˆå¦‚å¯¹è±¡ã€æ•°ç»„ï¼‰ä¸åº”è¯¥å‡ºç°åœ¨è¿™é‡Œ</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`'<span class="hljs-subst">${escapeSingleQuotes(<span class="hljs-built_in">String</span>(value))}</span>'`</span>
}

<span class="hljs-comment">/**
 * å°†å¯¹è±¡è½¬æ¢ä¸ºYAMLæ ¼å¼å­—ç¬¦ä¸²ï¼Œå¹¶æ·»åŠ æ³¨é‡Š
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">data</span> - è¦è½¬æ¢çš„æ•°æ®å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">commentsMap</span> - æ³¨é‡Šæ˜ å°„å…³ç³»
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} YAMLæ ¼å¼çš„å­—ç¬¦ä¸²
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectToYamlWithComments</span>(<span class="hljs-params">data, commentsMap</span>) {
  <span class="hljs-comment">// æ„å»ºå±‚çº§åŒ–çš„æ³¨é‡Šæ˜ å°„</span>
  <span class="hljs-keyword">const</span> hierarchicalComments = <span class="hljs-title function_">buildHierarchicalComments</span>(commentsMap)

  <span class="hljs-keyword">let</span> yamlContent = <span class="hljs-string">''</span>
  <span class="hljs-keyword">let</span> indentLevel = <span class="hljs-number">0</span>

  <span class="hljs-comment">/**
   * é€’å½’å¤„ç†å¯¹è±¡ï¼Œç”Ÿæˆå¸¦æ³¨é‡Šçš„YAML
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">obj</span> - å½“å‰å¤„ç†çš„å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">currentPath</span> - å½“å‰è·¯å¾„
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">processObject</span>(<span class="hljs-params">obj, currentPath = <span class="hljs-string">''</span></span>) {
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)

    keys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> value = obj[key]
      <span class="hljs-keyword">const</span> newPath = currentPath ? <span class="hljs-string">`<span class="hljs-subst">${currentPath}</span>.<span class="hljs-subst">${key}</span>`</span> : key
      <span class="hljs-keyword">const</span> indent = <span class="hljs-string">'  '</span>.<span class="hljs-title function_">repeat</span>(indentLevel)

      <span class="hljs-comment">// æ£€æŸ¥å½“å‰è·¯å¾„æ˜¯å¦æœ‰æ³¨é‡Š</span>
      <span class="hljs-keyword">if</span> (hierarchicalComments[newPath]) {
        <span class="hljs-comment">// æ·»åŠ æ³¨é‡Šï¼ˆç¼©è¿›ä¸å½“å‰å±‚çº§ç›¸åŒï¼‰</span>
        yamlContent += <span class="hljs-string">`<span class="hljs-subst">${indent}</span># <span class="hljs-subst">${hierarchicalComments[newPath]}</span>\n`</span>
      }

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// å¦‚æœæ˜¯åµŒå¥—å¯¹è±¡ï¼Œæ·»åŠ é”®å¹¶é€’å½’å¤„ç†</span>
        yamlContent += <span class="hljs-string">`<span class="hljs-subst">${indent}</span><span class="hljs-subst">${key}</span>:\n`</span>
        indentLevel++
        <span class="hljs-title function_">processObject</span>(value, newPath)
        indentLevel--
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å¦‚æœæ˜¯å¶å­èŠ‚ç‚¹ï¼Œæ ¼å¼åŒ–å€¼å¹¶æ·»åŠ é”®å€¼å¯¹</span>
        <span class="hljs-keyword">const</span> formattedValue = <span class="hljs-title function_">formatYamlValue</span>(value)
        yamlContent += <span class="hljs-string">`<span class="hljs-subst">${indent}</span><span class="hljs-subst">${key}</span>: <span class="hljs-subst">${formattedValue}</span>\n`</span>
      }
    })
  }

  <span class="hljs-comment">// å¼€å§‹å¤„ç†æ ¹å¯¹è±¡</span>
  <span class="hljs-title function_">processObject</span>(data)
  <span class="hljs-keyword">return</span> yamlContent
}

<span class="hljs-comment">/**
 * ä»XLSXæ–‡ä»¶ç”ŸæˆYAMLè¯­è¨€åŒ…
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">inputFile</span> - è¾“å…¥çš„XLSXæ–‡ä»¶è·¯å¾„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">outputDir</span> - è¾“å‡ºçš„YAMLæ–‡ä»¶ç›®å½•
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">convertXlsxToYaml</span>(<span class="hljs-params">inputFile, outputDir</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ç¡®ä¿è¾“å…¥æ–‡ä»¶å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(inputFile)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`è¾“å…¥æ–‡ä»¶ä¸å­˜åœ¨: <span class="hljs-subst">${inputFile}</span>`</span>)
    }

    <span class="hljs-comment">// è§£æXLSXæ–‡ä»¶</span>
    <span class="hljs-keyword">const</span> parsedData = <span class="hljs-title function_">parseXlsxFile</span>(inputFile)
    <span class="hljs-keyword">const</span> { languages, data, comments } = parsedData

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“Š æ£€æµ‹åˆ° <span class="hljs-subst">${languages.length}</span> ç§è¯­è¨€: <span class="hljs-subst">${languages.join(<span class="hljs-string">', '</span>)}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“ å¤„ç†äº† <span class="hljs-subst">${<span class="hljs-built_in">Object</span>.keys(data[languages[<span class="hljs-number">0</span>]] || {}).length}</span> ä¸ªé”®å€¼å¯¹`</span>)

    <span class="hljs-comment">// ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(outputDir)) {
      fs.<span class="hljs-title function_">mkdirSync</span>(outputDir, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> })
    }

    <span class="hljs-comment">// ä¸ºæ¯ç§è¯­è¨€ç”ŸæˆYAMLæ–‡ä»¶</span>
    languages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">lang</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!data[lang]) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`âš ï¸  è¯­è¨€ <span class="hljs-subst">${lang}</span> æ²¡æœ‰æ•°æ®ï¼Œè·³è¿‡ç”Ÿæˆ`</span>)
        <span class="hljs-keyword">return</span>
      }

      <span class="hljs-comment">// ç”Ÿæˆå¸¦æ³¨é‡Šçš„YAMLå†…å®¹</span>
      <span class="hljs-keyword">const</span> yamlContent = <span class="hljs-title function_">objectToYamlWithComments</span>(data[lang], comments)

      <span class="hljs-comment">// æ„å»ºè¾“å‡ºæ–‡ä»¶è·¯å¾„</span>
      <span class="hljs-keyword">const</span> outputFile = path.<span class="hljs-title function_">join</span>(outputDir, <span class="hljs-string">`<span class="hljs-subst">${lang}</span>.yaml`</span>)

      <span class="hljs-comment">// å†™å…¥æ–‡ä»¶</span>
      fs.<span class="hljs-title function_">writeFileSync</span>(outputFile, yamlContent, <span class="hljs-string">'utf8'</span>)

      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… ç”Ÿæˆ <span class="hljs-subst">${lang}</span>.yaml`</span>)
    })

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ‰ è½¬æ¢å®Œæˆï¼`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“ è¾“å‡ºç›®å½•: <span class="hljs-subst">${outputDir}</span>`</span>)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ è½¬æ¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:'</span>, error.<span class="hljs-property">message</span>)
    process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
  }
}

<span class="hljs-comment">// é…ç½®å‘½ä»¤è¡Œå‚æ•°</span>
<span class="hljs-keyword">const</span> argv = <span class="hljs-title function_">yargs</span>(<span class="hljs-title function_">hideBin</span>(process.<span class="hljs-property">argv</span>))
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'input'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'i'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'è¾“å…¥çš„XLSXæ–‡ä»¶è·¯å¾„'</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'./translations.xlsx'</span>,
  })
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'output'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'o'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'è¾“å‡ºçš„YAMLæ–‡ä»¶ç›®å½•'</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'./locales'</span>,
  })
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'config'</span>, {
    <span class="hljs-attr">alias</span>: <span class="hljs-string">'c'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'é…ç½®æ–‡ä»¶è·¯å¾„'</span>,
  })
  .<span class="hljs-title function_">help</span>()
  .<span class="hljs-title function_">alias</span>(<span class="hljs-string">'help'</span>, <span class="hljs-string">'h'</span>)
  .<span class="hljs-title function_">version</span>()
  .<span class="hljs-title function_">alias</span>(<span class="hljs-string">'version'</span>, <span class="hljs-string">'v'</span>).<span class="hljs-property">argv</span>

<span class="hljs-comment">/**
 * ä¸»å‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å¦‚æœæœ‰é…ç½®æ–‡ä»¶ï¼Œè¯»å–é…ç½®æ–‡ä»¶</span>
  <span class="hljs-keyword">if</span> (argv.<span class="hljs-property">config</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> configPath = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), argv.<span class="hljs-property">config</span>)
      <span class="hljs-keyword">const</span> config = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(configPath, <span class="hljs-string">'utf8'</span>))

      <span class="hljs-comment">// åˆå¹¶é…ç½®å‚æ•°</span>
      <span class="hljs-keyword">const</span> finalInput =
        argv.<span class="hljs-property">input</span> !== <span class="hljs-string">'./translations.xlsx'</span> ? argv.<span class="hljs-property">input</span> : config.<span class="hljs-property">input</span> || <span class="hljs-string">'./translations.xlsx'</span>
      <span class="hljs-keyword">const</span> finalOutput = argv.<span class="hljs-property">output</span> !== <span class="hljs-string">'./locales'</span> ? argv.<span class="hljs-property">output</span> : config.<span class="hljs-property">output</span> || <span class="hljs-string">'./locales'</span>

      <span class="hljs-title function_">convertXlsxToYaml</span>(finalInput, finalOutput)
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ è¯»å–é…ç½®æ–‡ä»¶å¤±è´¥:'</span>, error.<span class="hljs-property">message</span>)
      process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°</span>
    <span class="hljs-title function_">convertXlsxToYaml</span>(argv.<span class="hljs-property">input</span>, argv.<span class="hljs-property">output</span>)
  }
}

<span class="hljs-title function_">main</span>()
</code></pre>
<h3 data-id="heading-9">4.4 è„šæœ¬å‘½ä»¤é…ç½®ï¼ˆpackage.jsonï¼‰</h3>
<p>è„šæœ¬æ”¯æŒé€šè¿‡<code>-i</code>å’Œ<code>-o</code>å‚æ•°è‡ªå®šä¹‰è¾“å…¥è¾“å‡ºè·¯å¾„ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>â€‹
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>â€‹
    <span class="hljs-attr">"i18n:yaml2xlsx"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node ./scripts/i18n/yaml2xlsx.js -i src/i18n/locales -o scripts/i18n/output/translation.xlsx"</span><span class="hljs-punctuation">,</span>â€‹
    <span class="hljs-attr">"i18n:xlsx2yaml"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node ./scripts/i18n/xlsx2yaml.js -i scripts/i18n/output/translation.xlsx -o scripts/i18n/output/locales"</span>â€‹
  <span class="hljs-punctuation">}</span>â€‹
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-10">4.5 ç±»å‹è‡ªåŠ¨ç”Ÿæˆæ–¹æ¡ˆ</h3>
<p>tsé»˜è®¤æ˜¯ä¸æ”¯æŒå¯¼å…¥yamlæ–‡ä»¶çš„ï¼Œéœ€è¦æ·»åŠ æ¨¡å—å£°æ˜ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'*.yaml'</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">content</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> content
}
</code></pre>
<p>è¿™æ ·å°±æ”¯æŒå¯¼å…¥yamlæ–‡ä»¶äº†ï¼Œä½†å¯¼å…¥çš„æ‰€æœ‰tsç±»å‹éƒ½æ˜¯<code>Record&lt;string, any&gt;</code>ï¼Œä½¿ç”¨<code>vue-i18n</code>æ—¶ä¹Ÿæ²¡æœ‰ç±»å‹æç¤ºï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ— ç±»å‹æç¤ºï¼šlogin.?</span>
<span class="hljs-title function_">t</span>(<span class="hljs-string">'login.form.username'</span>)
</code></pre>
<p>æœŸæœ›çš„ç›®æ ‡æ˜¯ï¼šå¯¼å…¥çš„yamlè¯­è¨€åŒ…æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œä½¿ç”¨æ—¶å¯ä»¥äº«å—ç±»å‹æç¤ºã€‚æ‰‹åŠ¨æ ¹æ®è¯­è¨€åŒ…yamlæ–‡ä»¶ç”Ÿæˆtsç±»å‹å£°æ˜æ–‡ä»¶æ˜¯é‡å¤ä½æ•ˆçš„ï¼Œyamlæ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„æ–‡ä»¶ï¼Œæ ¹æ®yamlæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆtsç±»å‹å£°æ˜æ–‡ä»¶æ˜¯å¯è¡Œçš„ã€‚æ–¹æ¡ˆå¯ä»¥å‚è€ƒunplugin-vue-componentsï¼Œç¼–å†™ä¸€ä¸ªviteæ’ä»¶ï¼Œæ ¹æ®è¯­è¨€åŒ…yamlæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆtsç±»å‹å£°æ˜æ–‡ä»¶ã€‚</p>
<p>vite-plugin-i18n-types.ts</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { readFileSync, writeFileSync, existsSync, mkdirSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> { resolve, dirname } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
<span class="hljs-keyword">import</span> { parse } <span class="hljs-keyword">from</span> <span class="hljs-string">'yaml'</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> I18nTypePluginOptions {
  <span class="hljs-attr">input</span>: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">string</span>[]
  <span class="hljs-attr">output</span>: <span class="hljs-built_in">string</span>
  typeName?: <span class="hljs-built_in">string</span>
  watch?: <span class="hljs-built_in">boolean</span>
  build?: <span class="hljs-built_in">boolean</span>
  <span class="hljs-comment">// æ¨¡å—å£°æ˜çš„è·¯å¾„ï¼Œå¦‚ '@/i18n/locales'</span>
  modulePath?: <span class="hljs-built_in">string</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectToTypeString</span>(<span class="hljs-params">obj: <span class="hljs-built_in">any</span>, indent = <span class="hljs-number">2</span>, level = <span class="hljs-number">1</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> spaces = <span class="hljs-string">' '</span>.<span class="hljs-title function_">repeat</span>(indent * level)
  <span class="hljs-keyword">const</span> entries = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)

  <span class="hljs-keyword">if</span> (entries.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'Record&lt;string, any&gt;'</span>

  <span class="hljs-keyword">const</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">string</span>[] = []

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> entries) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">const</span> nestedType = <span class="hljs-title function_">objectToTypeString</span>(value, indent, level + <span class="hljs-number">1</span>)
      result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`<span class="hljs-subst">${spaces}</span><span class="hljs-subst">${key}</span>: <span class="hljs-subst">${nestedType}</span>`</span>)
    } <span class="hljs-keyword">else</span> {
      result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`<span class="hljs-subst">${spaces}</span><span class="hljs-subst">${key}</span>: string`</span>)
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-string">`{
<span class="hljs-subst">${result.join(<span class="hljs-string">'\n'</span>)}</span>
<span class="hljs-subst">${<span class="hljs-string">' '</span>.repeat(indent * (level - <span class="hljs-number">1</span>))}</span>}`</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">i18nTypePlugin</span>(<span class="hljs-params">options: I18nTypePluginOptions</span>): <span class="hljs-title class_">Plugin</span> {
  <span class="hljs-keyword">const</span> {
    input = <span class="hljs-string">'src/i18n/locales/zh-CN.yaml'</span>,
    output = <span class="hljs-string">'types/i18n.d.ts'</span>,
    typeName = <span class="hljs-string">'I18nMessageSchema'</span>,
    watch = <span class="hljs-literal">true</span>,
    build = <span class="hljs-literal">true</span>,
    modulePath = <span class="hljs-string">'@/i18n/locales'</span>,
  } = options

  <span class="hljs-keyword">const</span> inputPaths = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(input) ? input : [input]
  <span class="hljs-keyword">const</span> resolvedInputPaths = inputPaths.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">path</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), path))
  <span class="hljs-keyword">const</span> resolvedOutputPath = <span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), output)

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateTypes</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è¯»å–ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼ˆå‡è®¾æ‰€æœ‰è¯­è¨€æ–‡ä»¶æœ‰ç›¸åŒçš„ç»“æ„ï¼‰</span>
      <span class="hljs-keyword">const</span> inputPath = resolvedInputPaths[<span class="hljs-number">0</span>]
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">existsSync</span>(inputPath)) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`âš ï¸  File not found: <span class="hljs-subst">${inputPath}</span>`</span>)
        <span class="hljs-keyword">return</span>
      }

      <span class="hljs-keyword">const</span> yamlContent = <span class="hljs-title function_">readFileSync</span>(inputPath, <span class="hljs-string">'utf-8'</span>)
      <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">parse</span>(yamlContent)
      <span class="hljs-keyword">const</span> typeDefinition = <span class="hljs-title function_">objectToTypeString</span>(data, <span class="hljs-number">2</span>)

      <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„ç±»å‹å£°æ˜å†…å®¹</span>
      <span class="hljs-keyword">let</span> content = <span class="hljs-string">`declare type <span class="hljs-subst">${typeName}</span> = <span class="hljs-subst">${typeDefinition}</span>\n`</span>

      <span class="hljs-comment">// æ·»åŠ æ¨¡å—å£°æ˜</span>
      <span class="hljs-keyword">if</span> (modulePath) {
        content += <span class="hljs-string">`
declare module '<span class="hljs-subst">${modulePath}</span>/*.yaml' {
  const content: <span class="hljs-subst">${typeName}</span>
  export default content
}

declare module '<span class="hljs-subst">${modulePath}</span>/*.yml' {
  const content: <span class="hljs-subst">${typeName}</span>
  export default content
}
`</span>
      }

      <span class="hljs-comment">// ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨</span>
      <span class="hljs-keyword">const</span> outputDir = <span class="hljs-title function_">dirname</span>(resolvedOutputPath)
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">existsSync</span>(outputDir)) {
        <span class="hljs-title function_">mkdirSync</span>(outputDir, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> })
      }

      <span class="hljs-title function_">writeFileSync</span>(resolvedOutputPath, content, <span class="hljs-string">'utf-8'</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… Generated i18n types: <span class="hljs-subst">${resolvedOutputPath}</span>`</span>)
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ Failed to generate i18n types:'</span>, error)
    }
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vite-plugin-i18n-types'</span>,

    <span class="hljs-title function_">buildStart</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (build) {
        <span class="hljs-title function_">generateTypes</span>()
      }
    },

    <span class="hljs-title function_">configureServer</span>(<span class="hljs-params">server</span>) {
      <span class="hljs-keyword">if</span> (watch) {
        <span class="hljs-comment">// é¦–æ¬¡ç”Ÿæˆ</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">generateTypes</span>(), <span class="hljs-number">100</span>)

        <span class="hljs-comment">// ç›‘å¬æ‰€æœ‰è¾“å…¥æ–‡ä»¶</span>
        resolvedInputPaths.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">inputPath</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (<span class="hljs-title function_">existsSync</span>(inputPath)) {
            server.<span class="hljs-property">watcher</span>.<span class="hljs-title function_">add</span>(inputPath)
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ‘€ Watching: <span class="hljs-subst">${inputPath}</span>`</span>)
          }
        })

        <span class="hljs-comment">// ç›‘å¬æ–‡ä»¶å˜åŒ–</span>
        server.<span class="hljs-property">watcher</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'change'</span>, <span class="hljs-function">(<span class="hljs-params">changedPath</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (resolvedInputPaths.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">path</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(path) === <span class="hljs-title function_">resolve</span>(changedPath))) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“„ i18n file changed: <span class="hljs-subst">${changedPath}</span>`</span>)
            <span class="hljs-title function_">generateTypes</span>()

            <span class="hljs-comment">// å‘é€ HMR æ›´æ–°</span>
            server.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>({
              <span class="hljs-attr">type</span>: <span class="hljs-string">'full-reload'</span>,
              <span class="hljs-attr">path</span>: <span class="hljs-string">'*'</span>,
            })
          }
        })
      }
    },

    <span class="hljs-title function_">buildEnd</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (build &amp;&amp; !watch) {
        <span class="hljs-title function_">generateTypes</span>()
      }
    },
  }
}
</code></pre>
<h3 data-id="heading-11">4.6 Viteé…ç½®é›†æˆ</h3>
<p>vite.config.ts</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> i18nTypePlugin <span class="hljs-keyword">from</span> <span class="hljs-string">'./build/vite-plugin-i18n-types'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">i18nTypePlugin</span>({
      <span class="hljs-comment">// ä½¿ç”¨å“ªä¸ªè¯­è¨€åŒ…ä¸ºåŸºå‡†ç”¨æ¥ç”Ÿæˆ.d.tsæ–‡ä»¶</span>
      <span class="hljs-attr">input</span>: <span class="hljs-string">'src/i18n/locales/zh-CN.yaml'</span>,
      <span class="hljs-comment">// ç”¨äºç”Ÿæˆ.d.tsæ–‡ä»¶ä¸­çš„declare module '@/i18n/locales/*.yaml'è¯­å¥</span>
      <span class="hljs-attr">modulePath</span>: <span class="hljs-string">'@/i18n/locales'</span>,
      <span class="hljs-comment">// .d.tsæ–‡ä»¶ç”Ÿæˆä½ç½®</span>
      <span class="hljs-attr">output</span>: <span class="hljs-string">'types/i18n.d.ts'</span>,
      <span class="hljs-comment">// .d.tsæ–‡ä»¶ä¸­çš„MessageSchemaç±»å‹çš„åç§°</span>
      <span class="hljs-attr">typeName</span>: <span class="hljs-string">'I18nMessageSchema'</span>,
      <span class="hljs-attr">watch</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">build</span>: <span class="hljs-literal">true</span>,
    }),
  ],
})
</code></pre>
<p>è‡ªåŠ¨ç”Ÿæˆ<code>types/i18n.d.ts</code>æ–‡ä»¶</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">type</span> I18nMessageSchema {
  <span class="hljs-attr">home</span>: {
    <span class="hljs-attr">navbar</span>: {
      <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
    }
  }
  <span class="hljs-attr">login</span>: {
    <span class="hljs-attr">form</span>: {
      <span class="hljs-attr">username</span>: <span class="hljs-built_in">string</span>
      <span class="hljs-attr">password</span>: <span class="hljs-built_in">string</span>
    }
  }
}

<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'@/i18n/locales/*.yaml'</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">content</span>: I18nMessageSchema
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> content
}

<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'@/i18n/locales/*.yml'</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">content</span>: I18nMessageSchema
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> content
}
</code></pre>
<p>ä¸Šé¢çš„<code>declare module</code>è¯­å¥ä¸ä»…ä¿è¯äº†å¼•å…¥çš„è¯­è¨€åŒ…yamlæ–‡ä»¶çš„ç±»å‹å®‰å…¨ï¼Œè€Œä¸”åªé™å®šäº†<code>@/i18n/locales</code>ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸å½±å“å…¶å®ƒç›®å½•ä¸‹çš„æ–‡ä»¶å¼•å…¥ã€‚</p>
<p>éœ€è¦é…åˆtsconfig.json:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"include"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"types/**/*"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"paths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"@/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"./src/*"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-12">4.7 i18né…ç½®å®ç°</h3>
<p>src/i18n/index.ts</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { createI18n, useI18n } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-i18n'</span>
<span class="hljs-comment">// zhCNå’ŒenUSéƒ½æ˜¯I18nMessageSchemaç±»å‹â€‹</span>
<span class="hljs-keyword">import</span> zhCN <span class="hljs-keyword">from</span> <span class="hljs-string">'@/i18n/locales/zh-CN.yaml'</span>
<span class="hljs-keyword">import</span> enUS <span class="hljs-keyword">from</span> <span class="hljs-string">'@/i18n/locales/en-US.yaml'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">LangCodes</span> = <span class="hljs-string">'zh-CN'</span> | <span class="hljs-string">'en-US'</span>
<span class="hljs-keyword">const</span> messages = {
  <span class="hljs-string">'zh-CN'</span>: zhCN,
  <span class="hljs-string">'en-US'</span>: enUS,
}
<span class="hljs-keyword">const</span> i18n = createI18n&lt;[I18nMessageSchema], <span class="hljs-title class_">LangCodes</span>, <span class="hljs-literal">false</span>&gt;({
  <span class="hljs-attr">legacy</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">locale</span>: <span class="hljs-string">'zh-CN'</span>, <span class="hljs-comment">// é»˜è®¤ä¸­æ–‡â€‹</span>
  <span class="hljs-attr">fallbackLocale</span>: <span class="hljs-string">'zh-CN'</span>,
  messages,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> i18n
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useGlobalI18n</span> = (<span class="hljs-params"/>) =&gt;
  useI18n&lt;{ <span class="hljs-attr">message</span>: I18nMessageSchema }&gt;({
    <span class="hljs-attr">useScope</span>: <span class="hljs-string">'global'</span>,
  })
</code></pre>
<p>åœ¨å…¶å®ƒæ–‡ä»¶ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> { t } = <span class="hljs-title function_">useGlobalI18n</span>()
<span class="hljs-comment">// äº«å—å®Œæ•´çš„ç±»å‹æç¤ºâ€‹</span>
<span class="hljs-title function_">t</span>(<span class="hljs-string">'home.navbar.title'</span>)
</code></pre>
<h2 data-id="heading-13">äº”ã€ä½¿ç”¨æµç¨‹è¯´æ˜</h2>
<ol>
<li>YAML è½¬ Excelï¼šæ‰§è¡Œ<code>pnpm i18n:yaml2xlsx</code>å‘½ä»¤ï¼Œè¿™ä¼šæ‰«æ<code>src/i18n/locales</code>ç›®å½•ä¸‹çš„æ‰€æœ‰yamlæ–‡ä»¶ï¼ŒæŠŠå®ƒä»¬è½¬æ¢æˆexcelæ–‡ä»¶è¾“å‡ºåˆ°<code>scripts/i18n/output/translation.xlsx</code>ï¼Œè¯­è¨€åŒ…è½¬æ¢åçš„ç»“æœç¤ºä¾‹ï¼š</li>
</ol>





























<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>key</th><th>zh-CN</th><th>en-US</th></tr></thead><tbody><tr><td>é¦–é¡µ/å¯¼èˆªæ </td><td>home.navbar.title</td><td>é¦–é¡µ</td><td>Home</td></tr><tr><td>ç™»å½•é¡µ/è¡¨å•</td><td>login.form.username</td><td>ç”¨æˆ·å</td><td>Username</td></tr><tr><td>ç™»å½•é¡µ/è¡¨å•</td><td>login.form.password</td><td>å¯†ç </td><td>Password</td></tr></tbody></table>
<ol start="2">
<li>Excel è½¬ YAML: æ‰§è¡Œ<code>pnpm i18n:xlsx2yaml</code>å‘½ä»¤ï¼Œè¿™ä¼šæŠŠ<code>scripts/i18n/output/translation.xlsx</code>æ–‡ä»¶è½¬æ¢æˆè¯­è¨€åŒ…æ–‡ä»¶è¾“å‡ºåˆ°<code>scripts/i18n/output/locales</code>ç›®å½•ä¸‹ï¼Œè€Œä¸æ˜¯ç›´æ¥è¦†ç›–åŸè¯­è¨€åŒ…æ–‡ä»¶ï¼Œè¿™æ ·æ–¹ä¾¿å¼€å‘è€…æ ¡å¯¹ç”Ÿæˆç»“æœåå†è¦†ç›–æºç ï¼Œé˜²æ­¢å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šOPA é›†æˆæŒ‡å—ï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7583906870827646985</link>    <guid>https://juejin.cn/post/7583906870827646985</guid>    <pubDate>2025-12-15T12:34:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583906870827646985" data-draft-id="7583906870827630601" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šOPA é›†æˆæŒ‡å—ï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="åç«¯,Go"/> <meta itemprop="datePublished" content="2025-12-15T12:34:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–µä¸ªå’ª"/> <meta itemprop="url" content="https://juejin.cn/user/1350630784901262"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šOPA é›†æˆæŒ‡å—ï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1350630784901262/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–µä¸ªå’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T12:34:41.000Z" title="Mon Dec 15 2025 12:34:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šOPA é›†æˆæŒ‡å—ï¼šä»åŸç†åˆ°å®è·µ</h2>
<p>Open Policy Agentï¼ˆç®€ç§° OPAï¼‰æ˜¯ä¸€æ¬¾å¼€æºçš„é€šç”¨ç­–ç•¥å¼•æ“ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºå®ç°â€œç­–ç•¥å³ä»£ç â€ï¼ˆPolicy as Codeï¼‰ï¼Œå°†åˆ†æ•£åœ¨å„ç³»ç»Ÿä¸­çš„æƒé™æ§åˆ¶ã€èµ„æºè®¿é—®è§„åˆ™ç­‰ç­–ç•¥é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œè¿›è¡Œç»Ÿä¸€ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶ä¸æ‰§è¡Œã€‚å¦‚ä»Šï¼ŒOPA å·²æˆä¸ºäº‘åŸç”Ÿç”Ÿæ€ä¸­ç­–ç•¥ç®¡æ§çš„äº‹å®æ ‡å‡†ï¼Œè¢« Netflixã€Cloudflareã€Pinterestã€Chef ç­‰å·¨å¤´å¹¿æ³›åº”ç”¨â€”â€”ä»å†…éƒ¨ API æƒé™ç®¡æ§ã€Kubernetes é›†ç¾¤èµ„æºè°ƒåº¦ï¼Œåˆ°ç»ˆç«¯äº§å“çš„ IAM åŠŸèƒ½å®ç°ï¼Œå‡èƒ½çœ‹åˆ°å…¶èº«å½±ã€‚</p>
<p>OPA ç”± Styra å…¬å¸äº 2016 å¹´å¼€æºï¼Œ2018 å¹´åŠ å…¥ CNCFï¼ˆäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰æˆä¸ºæ²™ç®±é¡¹ç›®ï¼Œ2021 å¹´ 2 æœˆæ­£å¼æ¯•ä¸šï¼Œå…¶å¿«é€Ÿæ™‹å‡çš„èƒŒåï¼Œæ˜¯ç¤¾åŒºçš„é«˜åº¦æ´»è·ƒä¸è¡Œä¸šå¯¹ç»Ÿä¸€ç­–ç•¥ç®¡æ§éœ€æ±‚çš„è¿«åˆ‡æ€§ã€‚æœ¬æ–‡å°†ä» OPA æ ¸å¿ƒåŸç†ã€Rego è¯­è¨€å…¥é—¨ï¼Œé€æ­¥æ·±å…¥åˆ° GoWind Admin ä¼ä¸šçº§ä¸­åå°æ¡†æ¶çš„å®Œæ•´é›†æˆæµç¨‹ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿè½åœ°æƒé™ç®¡æ§èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ·±å…¥ç†è§£ OPAï¼šæ ¸å¿ƒåŸç†ä¸æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>åœ¨é›†æˆ OPA ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå˜æ¸…å…¶æ ¸å¿ƒé€»è¾‘ï¼šOPA ä¸å…³å¿ƒâ€œè°åœ¨è®¿é—®â€ï¼ˆè®¤è¯ï¼ŒAuthenticationï¼‰ï¼Œåªä¸“æ³¨äºâ€œèƒ½å¦è®¿é—®â€ï¼ˆæˆæƒï¼ŒAuthorizationï¼‰åŠæ›´å¹¿æ³›çš„ç­–ç•¥å†³ç­–ï¼ˆå¦‚èµ„æºéƒ¨ç½²è§„åˆ™ã€ç½‘ç»œè·¯ç”±é™åˆ¶ç­‰ï¼‰ã€‚å®ƒé€šè¿‡æ¥æ”¶è¾“å…¥ã€ç»“åˆå¤–éƒ¨æ•°æ®ã€æ‰§è¡Œé¢„å®šä¹‰ç­–ç•¥ï¼Œæœ€ç»ˆè¾“å‡ºå†³ç­–ç»“æœï¼Œå®ç°ç­–ç•¥ä¸ä¸šåŠ¡ç³»ç»Ÿçš„è§£è€¦ã€‚</p>
<h4 data-id="heading-2">1.1 æ ¸å¿ƒæ¦‚å¿µï¼šå››å¤§æ ¸å¿ƒè¦ç´ </h4>
<p>å®è§‚ä¸Šï¼ŒOPA çš„å†³ç­–è¿‡ç¨‹ä¾èµ–å››ä¸ªæ ¸å¿ƒè¦ç´ ï¼Œå››è€…æ„æˆå®Œæ•´çš„ç­–ç•¥æ‰§è¡Œé—­ç¯ï¼Œåœ¨ OPA å®˜æ–¹è¯•ç‚¼åœºï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fplay.openpolicyagent.org" target="_blank" title="https://play.openpolicyagent.org" ref="nofollow noopener noreferrer">play.openpolicyagent.org</a>ï¼‰ä¸­å¯ç›´è§‚éªŒè¯å…¶äº¤äº’é€»è¾‘ï¼š</p>
<ul>
<li><strong>è¯·æ±‚è¾“å…¥ï¼ˆRequest Inputï¼‰</strong>ï¼šè§¦å‘ç­–ç•¥å†³ç­–çš„è¯·æ±‚æ•°æ®ï¼Œé€šå¸¸åŒ…å«è®¿é—®ä¸»ä½“ã€è®¿é—®èµ„æºã€è®¿é—®æ“ä½œç­‰å…³é”®ä¿¡æ¯ï¼Œæ ¼å¼ä¸º JSONã€‚</li>
<li><strong>å¤–éƒ¨æ•°æ®ï¼ˆDataï¼‰</strong>ï¼šç­–ç•¥æ‰§è¡Œæ‰€éœ€çš„è¡¥å……æ•°æ®ï¼ˆéè¯·æ±‚è‡ªå¸¦ï¼‰ï¼Œå¦‚ç”¨æˆ·è§’è‰²åˆ—è¡¨ã€èµ„æºæƒé™æ˜ å°„è¡¨ç­‰ï¼Œå¯é€šè¿‡ OPA çš„æ•°æ® API åŠ¨æ€æ³¨å…¥ã€‚</li>
<li><strong>Rego ç­–ç•¥ï¼ˆPolicyï¼‰</strong>ï¼šä½¿ç”¨ OPA ä¸“ç”¨çš„å£°æ˜å¼ DSL è¯­è¨€ Rego ç¼–å†™çš„ç­–ç•¥è§„åˆ™ï¼Œå®šä¹‰â€œä½•ç§æ¡ä»¶ä¸‹å…è®¸/æ‹’ç»æŸä¸ªæ“ä½œâ€ã€‚</li>
<li><strong>å“åº”æ•°æ®ï¼ˆResponseï¼‰</strong>ï¼šç­–ç•¥æ‰§è¡Œåçš„å†³ç­–ç»“æœï¼Œå¯æ˜¯ç®€å•çš„ true/falseï¼ˆå…è®¸/æ‹’ç»ï¼‰ï¼Œä¹Ÿå¯æ˜¯å¤æ‚çš„ JSON ç»“æ„ï¼ˆå¦‚è¿”å›å…è®¸çš„èµ„æºåˆ—è¡¨ã€æ‹’ç»åŸå› ç­‰ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-3">1.2 å¾®è§‚è§†è§’ï¼šè¯·æ±‚è¾“å…¥çš„ä¸‰å…ƒç»„æ¨¡å‹</h4>
<p>ä»»ä½•è®¿é—®æ§åˆ¶ç±»çš„ç­–ç•¥å†³ç­–ï¼Œå…¶è¾“å…¥æœ¬è´¨ä¸Šéƒ½å¯æŠ½è±¡ä¸ºâ€œä¸»ä½“-èµ„æº-æ“ä½œâ€çš„ä¸‰å…ƒç»„æ¨¡å‹ï¼š</p>
<ol>
<li>è®¿é—®å®ä½“ï¼ˆSubjectï¼‰ï¼šå‘èµ·è®¿é—®çš„ä¸»ä½“ï¼Œå¦‚ç”¨æˆ· IDã€è§’è‰²ã€ç”¨æˆ·ç»„ç­‰ï¼›</li>
<li>è®¿é—®èµ„æºï¼ˆObjectï¼‰ï¼šè¢«è®¿é—®çš„å¯¹è±¡ï¼Œå¦‚ API æ¥å£ã€æ•°æ®åº“è¡¨ã€K8s èµ„æºç­‰ï¼›</li>
<li>è®¿é—®æ–¹æ³•ï¼ˆActionï¼‰ï¼šå…·ä½“çš„æ“ä½œç±»å‹ï¼Œå¦‚ HTTP çš„ GET/POST/PUT/DELETEï¼Œæˆ–æ•°æ®åº“çš„æŸ¥è¯¢/ä¿®æ”¹ç­‰ã€‚</li>
</ol>
<p>è¿™ä¸€æ¨¡å‹ä¸ Casbin é«˜åº¦ç›¸ä¼¼ï¼Œä½†ä¸¤è€…æ ¸å¿ƒå·®å¼‚åœ¨äºç­–ç•¥æè¿°èƒ½åŠ›ï¼šCasbin é‡‡ç”¨ç®€æ´çš„è¡¨è¾¾å¼æ¨¡å‹ï¼Œé€‚åˆç®€å•æƒé™åœºæ™¯ï¼›è€Œ OPA çš„ Rego ä½œä¸ºå®Œæ•´çš„ DSL è¯­è¨€ï¼Œæ”¯æŒå¤æ‚çš„é€»è¾‘åˆ¤æ–­ã€æ•°æ®è½¬æ¢ã€å‡½æ•°è°ƒç”¨ï¼Œèƒ½åº”å¯¹ä¼ä¸šçº§å¤æ‚ç­–ç•¥éœ€æ±‚ï¼ˆå¦‚å¤šç»´åº¦æƒé™å åŠ ã€åŠ¨æ€æ•°æ®å…³è”æ ¡éªŒç­‰ï¼‰ã€‚</p>
<h3 data-id="heading-4">äºŒã€Rego è¯­è¨€å…¥é—¨ï¼šä»åŸºç¡€è¯­æ³•åˆ°å®Œæ•´è§„åˆ™</h3>
<p>Rego æ˜¯ OPA çš„æ ¸å¿ƒï¼Œä¸“ä¸ºç­–ç•¥ç¼–å†™è®¾è®¡ï¼Œå…·æœ‰å£°æ˜å¼ã€æ˜“è¯»æ˜“å†™çš„ç‰¹ç‚¹ã€‚å®ƒçµæ„Ÿæºè‡ª Datalog æŸ¥è¯¢è¯­è¨€ï¼Œæ‰©å±•äº†å¯¹ JSON ç»“æ„åŒ–æ•°æ®çš„æ”¯æŒï¼Œå¯è½»æ¾å¤„ç†åµŒå¥—å¯¹è±¡ã€æ•°ç»„ç­‰å¸¸è§æ•°æ®æ ¼å¼ã€‚ä»¥ä¸‹ä»æ ¸å¿ƒè¯­æ³•å…¥æ‰‹ï¼Œé€æ­¥æ„å»ºå®Œæ•´çš„ç­–ç•¥è§„åˆ™ã€‚</p>
<h4 data-id="heading-5">2.1 åŸºç¡€è¯­æ³•ï¼šå˜é‡ä¸èµ‹å€¼</h4>
<p>Rego ä¸­çš„å˜é‡ä¸€æ—¦èµ‹å€¼ä¾¿ä¸å¯ä¿®æ”¹ï¼ˆä¸å¯å˜å˜é‡ï¼‰ï¼Œæ”¯æŒæ ‡é‡ã€å¤åˆç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ã€é›†åˆï¼‰ç­‰å¤šç§æ•°æ®ç±»å‹ï¼Œèµ‹å€¼ä½¿ç”¨ <code>:=</code> ç¬¦å·ï¼š</p>
<pre><code class="hljs language-rego" lang="rego"># æ ‡é‡èµ‹å€¼ï¼šå­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ã€ç©ºå€¼
greeting   := "Hello"
max_height := 42
pi         := 3.14159
allowed    := true
location   := null

# å¤åˆç±»å‹èµ‹å€¼
rect := {"width": 2, "height": 4}  # å¯¹è±¡ï¼šé”®å€¼å¯¹é›†åˆ
allowed_users := ["papaya", "potato"]  # æ•°ç»„ï¼šæœ‰åºå…ƒç´ é›†åˆ
ips_by_port := {  # åµŒå¥—å¯¹è±¡ï¼šé”®ä¸ºæ•´æ•°ï¼Œå€¼ä¸ºæ•°ç»„
    80: ["1.1.1.1", "1.1.1.2"],
    443: ["2.2.2.1"],
}
</code></pre>
<h4 data-id="heading-6">2.2 é€»è¾‘åˆ¤æ–­ï¼šæ¡ä»¶ä¸å†³ç­–å—</h4>
<p>Rego çš„ç­–ç•¥è§„åˆ™æœ¬è´¨æ˜¯â€œæ¡ä»¶åˆ¤æ–­â€ï¼Œé€šè¿‡ <code>if</code> å…³é”®å­—æˆ–çœç•¥ <code>if</code> çš„å†³ç­–å—å®šä¹‰â€œä½•æ—¶æ»¡è¶³ç­–ç•¥â€ã€‚æ ¸å¿ƒé€»è¾‘è¿ç®—ç¬¦æ”¯æŒ <code>==</code>ã€<code>!=</code>ã€<code>&gt;</code>ã€<code>&lt;</code> ç­‰ï¼Œé€»è¾‘å…³ç³»é€šè¿‡è¯­æ³•ç»“æ„è¡¨è¾¾ï¼š</p>
<pre><code class="hljs language-rego" lang="rego"># åŸºç¡€æ¡ä»¶åˆ¤æ–­ï¼ˆä¸¤ç§å†™æ³•ç­‰ä»·ï¼‰
v if "hello" == "world"  # æ¡ä»¶ä¸æ»¡è¶³ï¼Œv ä¸º false
t2 if {                  # å¤šè¡Œå†³ç­–å—ï¼Œå†…éƒ¨è¯­å¥éœ€å…¨éƒ¨æ»¡è¶³
    x := 42
    y := 41
    x &gt; y                # æ¡ä»¶æ»¡è¶³ï¼Œt2 ä¸º true
}

# çœç•¥ if å…³é”®å­—çš„ç®€æ´å†™æ³•ï¼ˆæ¨èï¼‰
v { "hello" == "world" }  # ç­‰ä»·äºä¸Šè¿° v çš„å®šä¹‰
t2 {
    x := 42
    y := 41
    x &gt; y
}

# é€»è¾‘ ANDï¼šåˆ†å·åˆ†éš”æˆ–å¤šè¡Œåˆ†éš”ï¼ˆä¸¤ç§å†™æ³•ç­‰ä»·ï¼‰
# éœ€åŒæ—¶æ»¡è¶³â€œæœåŠ¡å™¨IDä¸ºappâ€å’Œâ€œåè®®ä¸ºhttpsâ€
valid_server {
    input.servers[0].id == "app"
    input.servers[0].protocols[0] == "https"
}
# ç­‰ä»·äºï¼šinput.servers[0].id == "app"; input.servers[0].protocols[0] == "https"

# é€»è¾‘ ORï¼šå¤šä¸ªåŒåå†³ç­–å—ï¼ˆä»»ä¸€æ»¡è¶³å³å¯ï¼‰
# æ»¡è¶³â€œæ˜¯ç®¡ç†å‘˜â€æˆ–â€œç«¯ç‚¹å…¬å¼€â€å³å…è®¸è®¿é—®
allow {
    is_admin
}
allow {
    is_endpoint_public
}
</code></pre>
<h4 data-id="heading-7">2.3 è¿­ä»£éå†ï¼šsome ä¸ every</h4>
<p>Rego æä¾›<code>some</code>ï¼ˆå­˜åœ¨æ€§éå†ï¼‰å’Œ <code>every</code>ï¼ˆå…¨ç§°éå†ï¼‰å…³é”®å­—ï¼Œç”¨äºå¤„ç†æ•°ç»„ã€å¯¹è±¡ç­‰å¯è¿­ä»£æ•°æ®ï¼Œæ”¯æŒç´¢å¼•<code>+</code>å€¼çš„åŒé‡éå†ï¼Œä¹Ÿå¯é€šè¿‡ä¸‹åˆ’çº¿ <code>_</code> å¿½ç•¥æ— å…³æ•°æ®ï¼š</p>
<pre><code class="hljs language-rego" lang="rego"># 1. æ•°ç»„éå†ï¼šsome å…³é”®å­—
arr := [1, 2, 3]
has_even {
    some val in arr  # éå†æ•°ç»„ä¸­çš„å€¼
    val % 2 == 0     # å­˜åœ¨å¶æ•°å³æ»¡è¶³
}

# 2. ç´¢å¼•+å€¼éå†
has_index_1 {
    some i, val in arr  # i ä¸ºç´¢å¼•ï¼Œval ä¸ºå¯¹åº”å€¼
    i == 1 &amp;&amp; val == 2  # ç´¢å¼•1å¯¹åº”å€¼ä¸º2å³æ»¡è¶³
}

# 3. å¯¹è±¡éå†ï¼ševery å…³é”®å­—ï¼ˆæ‰€æœ‰å…ƒç´ éœ€æ»¡è¶³æ¡ä»¶ï¼‰
valid_obj {
    every k, v in {"foo": "bar", "fox": "baz"} {
        startswith(k, "f")  # æ‰€æœ‰é”®ä»¥få¼€å¤´
        startswith(v, "b")  # æ‰€æœ‰å€¼ä»¥bå¼€å¤´
    }
}

# 4. é€šé…ç¬¦ _ï¼šå¿½ç•¥æ— å…³æ•°æ®
get_project_id {
    proj = input.projects[_]  # å–ä»»æ„ä¸€ä¸ªé¡¹ç›®
    id := proj.id             # è·å–é¡¹ç›®ID
}
</code></pre>
<h4 data-id="heading-8">2.4 å‡½æ•°å®šä¹‰ï¼šè‡ªå®šä¹‰ç­–ç•¥é€»è¾‘</h4>
<p>Rego æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ï¼Œç”¨äºå°è£…å¯å¤ç”¨çš„ç­–ç•¥é€»è¾‘ï¼Œæ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li>é»˜è®¤è¿”å› <code>true/false</code>ï¼Œä¹Ÿå¯æ˜¾å¼æŒ‡å®šè¿”å›å€¼ï¼›</li>
<li>æ”¯æŒåŒåå‡½æ•°é‡è½½ï¼Œä½†å‚æ•°æ•°é‡å¿…é¡»ä¸€è‡´ï¼›</li>
<li>è¾“å…¥ç›¸åŒåˆ™è¾“å‡ºå¿…ç›¸åŒï¼ˆçº¯å‡½æ•°ç‰¹æ€§ï¼Œç¡®ä¿ç­–ç•¥æ‰§è¡Œçš„ä¸€è‡´æ€§ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-rego" lang="rego"># 1. æ— è¿”å›å€¼å‡½æ•°ï¼ˆé»˜è®¤è¿”å›true/falseï¼‰
# åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºé…ç½®æ–‡ä»¶ï¼ˆæ»¡è¶³ä»»ä¸€åç¼€å³è¿”å›trueï¼‰
is_config_file(str) {
  contains(str, ".yaml")
}
is_config_file(str) {
  contains(str, ".yml")
}
is_config_file(str) {
  contains(str, ".json")
}

# 2. ç”¨ else åˆå¹¶åŒåå‡½æ•°ï¼ˆç­‰ä»·äºä¸Šè¿°å†™æ³•ï¼Œæ›´ç®€æ´ï¼‰
is_config_file2(str) {
  contains(str, ".yaml")
} else {
  contains(str, ".yml")
} else {
  contains(str, ".json")
}

# 3. æ˜¾å¼è¿”å›å€¼å‡½æ•°
# è‡ªå®šä¹‰åŠ æ³•å‡½æ•°ï¼Œè¿”å› a + b çš„ç»“æœ
plus_custom(a, b) := c {
    c := a + b
}
out := plus_custom(42, 43)  # out ç»“æœä¸º 85
</code></pre>
<h4 data-id="heading-9">2.5 å®Œæ•´ç­–ç•¥ç¤ºä¾‹ï¼šRBAC æƒé™æ§åˆ¶</h4>
<p>ç»“åˆä¸Šè¿°è¯­æ³•ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªç»å…¸çš„ RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰ç­–ç•¥ï¼Œå®šä¹‰â€œGET è¯·æ±‚æ”¾è¡Œã€ç®¡ç†å‘˜åŠç®¡ç†å‘˜ç»„ç”¨æˆ·å…¨æ”¾è¡Œâ€çš„è§„åˆ™ï¼š</p>
<pre><code class="hljs language-rego" lang="rego">package authz  # å®šä¹‰ç­–ç•¥åŒ…ï¼ˆç±»ä¼¼å‘½åç©ºé—´ï¼Œé¿å…å†²çªï¼‰

default allow = false  # é»˜è®¤æ‹’ç»æ‰€æœ‰è®¿é—®

# è§„åˆ™1ï¼šæ”¾è¡Œæ‰€æœ‰ GET è¯·æ±‚
allow {
    input.method == "GET"
}

# è§„åˆ™2ï¼šå…è®¸ admin ç”¨æˆ·æ‰§è¡Œä»»ä½•æ“ä½œ
allow {
    input.user == "admin"
}

# è§„åˆ™3ï¼šå…è®¸ admin ç”¨æˆ·ç»„ä¸­çš„ç”¨æˆ·æ‰§è¡Œä»»ä½•æ“ä½œ
allow {
    input.group[_] == "admin"  # éå†ç”¨æˆ·ç»„ï¼Œå­˜åœ¨adminå³æ»¡è¶³
}
</code></pre>
<h5 data-id="heading-10">ç­–ç•¥æµ‹è¯•</h5>
<p>è¾“å…¥ä»¥ä¸‹è¯·æ±‚æ•°æ®ï¼ˆæ¨¡æ‹Ÿç”¨æˆ· <code>user1</code> å±äº <code>dev</code> å’Œ <code>admin</code> ç»„ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"group"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"dev"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"admin"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>OPA æ‰§è¡Œåè¾“å‡ºå†³ç­–ç»“æœï¼ˆæ»¡è¶³è§„åˆ™3ï¼Œå…è®¸è®¿é—®ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-11">2.6 å•å…ƒæµ‹è¯•ï¼šç¡®ä¿ç­–ç•¥æ­£ç¡®æ€§</h4>
<p>Rego åŸç”Ÿæ”¯æŒå•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•æ–‡ä»¶å‘½åéœ€éµå¾ª <code>xxx_test.rego</code> è§„èŒƒï¼ˆä¸ Go è¯­è¨€ä¸€è‡´ï¼‰ï¼Œé€šè¿‡ <code>with</code> å…³é”®å­—æ¨¡æ‹Ÿè¾“å…¥æ•°æ®ï¼ŒéªŒè¯ç­–ç•¥æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</p>
<h5 data-id="heading-12">æµ‹è¯•ç¤ºä¾‹</h5>
<p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶<code>authz_test.rego</code>ï¼š</p>
<pre><code class="hljs language-rego" lang="rego">package authz  # ä¸è¢«æµ‹ç­–ç•¥åŒ…ä¸€è‡´
import future.keywords  # å¼•å…¥æœªæ¥å…³é”®å­—ï¼ˆå¯é€‰ï¼Œå¢å¼ºè¯­æ³•å…¼å®¹æ€§ï¼‰

# æµ‹è¯•ç”¨ä¾‹1ï¼šGET è¯·æ±‚åº”è¢«å…è®¸
test_get_allowed if {
    allow with input as {"user": "user1", "method": "GET"}
}

# æµ‹è¯•ç”¨ä¾‹2ï¼šadmin ç”¨æˆ·åº”è¢«å…è®¸
test_admin_allowed if {
    allow with input as {"user": "admin", "method": "POST"}
}

# æµ‹è¯•ç”¨ä¾‹3ï¼šé admin é GET è¯·æ±‚åº”è¢«æ‹’ç»
test_non_admin_non_get_denied if {
    not allow with input as {"user": "user2", "method": "POST", "group": ["dev"]}
}
</code></pre>
<h5 data-id="heading-13">æ‰§è¡Œæµ‹è¯•</h5>
<p>åœ¨ç­–ç•¥æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹æµ‹è¯•ç»“æœï¼š</p>
<pre><code class="hljs language-shell" lang="shell">opa test . -v  # -v æ˜¾ç¤ºè¯¦ç»†æµ‹è¯•æ—¥å¿—
</code></pre>
<h5 data-id="heading-14">æµ‹è¯•è¾“å‡ºï¼ˆæˆåŠŸç¤ºä¾‹ï¼‰ï¼š</h5>
<pre><code class="hljs language-shell" lang="shell">authz_test.rego:
data.authz.test_get_allowed: PASS (522.5Âµs)
data.authz.test_admin_allowed: PASS (310.2Âµs)
data.authz.test_non_admin_non_get_denied: PASS (285.7Âµs)
--------------------------------------------------------------------------------
PASS: 3/3
</code></pre>
<h3 data-id="heading-15">ä¸‰ã€GoWind Admin é›†æˆ OPA å®Œæ•´æ­¥éª¤</h3>
<p>GoWind Admin å·²å°† OPA æ ¸å¿ƒé€»è¾‘å°è£…è‡³ &lt;github.com/tx7do/kratos-authz&gt; ç»„ä»¶ä¸­ï¼Œå¼€å‘è€…æ— éœ€é‡å¤å®ç°å¼•æ“åˆå§‹åŒ–ã€ç­–ç•¥åŠ è½½ç­‰åº•å±‚é€»è¾‘ï¼Œåªéœ€æŒ‰ä»¥ä¸‹æ­¥éª¤å®Œæˆé…ç½®ã€ä¾èµ–æ³¨å…¥ä¸ä¸­é—´ä»¶é›†æˆï¼Œå³å¯å¿«é€Ÿå¯ç”¨ OPA æƒé™ç®¡æ§ã€‚</p>
<h4 data-id="heading-16">3.1 æ ¸å¿ƒå°è£…ï¼šå®ç° Authorizer æƒé™ç®¡ç†å™¨</h4>
<p>é¦–å…ˆåœ¨ <code>app/admin/service/internal/data/authorizer.go</code> ä¸­å®ç°æƒé™ç®¡ç†å™¨ï¼Œå°è£… OPA å¼•æ“åˆå§‹åŒ–ã€ç­–ç•¥é‡ç½®ï¼ˆä»æ•°æ®åº“åŠ è½½è§’è‰²-API æƒé™æ˜ å°„ï¼‰ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// app/admin/service/internal/data/authorizer.go</span>

<span class="hljs-keyword">package</span> data

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"errors"</span>

	<span class="hljs-string">"github.com/go-kratos/kratos/v2/log"</span>

	authzEngine <span class="hljs-string">"github.com/tx7do/kratos-authz/engine"</span>
	<span class="hljs-string">"github.com/tx7do/kratos-authz/engine/casbin"</span>
	<span class="hljs-string">"github.com/tx7do/kratos-authz/engine/noop"</span>

	pagination <span class="hljs-string">"github.com/tx7do/go-crud/api/gen/go/pagination/v1"</span>
	<span class="hljs-string">"github.com/tx7do/go-utils/trans"</span>
	conf <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/api/gen/go/conf/v1"</span>

	<span class="hljs-string">"go-wind-admin/app/admin/service/cmd/server/assets"</span>

	adminV1 <span class="hljs-string">"go-wind-admin/api/gen/go/admin/service/v1"</span>
	userV1 <span class="hljs-string">"go-wind-admin/api/gen/go/user/service/v1"</span>
)

<span class="hljs-comment">// Authorizer æƒé™ç®¡ç†å™¨</span>
<span class="hljs-keyword">type</span> Authorizer <span class="hljs-keyword">struct</span> {
	log *log.Helper

	roleRepo        *RoleRepo
	apiResourceRepo *ApiResourceRepo

	engine authzEngine.Engine
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewAuthorizer</span><span class="hljs-params">(
	logger log.Logger,
	cfg *conf.Bootstrap,
	roleRepo *RoleRepo,
	apiResourceRepo *ApiResourceRepo,
)</span></span> *Authorizer {
	a := &amp;Authorizer{
		log:             log.NewHelper(log.With(logger, <span class="hljs-string">"module"</span>, <span class="hljs-string">"authorizer/repo/admin-service"</span>)),
		roleRepo:        roleRepo,
		apiResourceRepo: apiResourceRepo,
	}

	a.init(cfg)

	<span class="hljs-keyword">return</span> a
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> init(cfg *conf.Bootstrap) {
	a.engine = a.newEngine(cfg)

	<span class="hljs-keyword">if</span> err := a.ResetPolicies(context.Background()); err != <span class="hljs-literal">nil</span> {
		a.log.Errorf(<span class="hljs-string">"reset policies error: %v"</span>, err)
	}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> newEngine(cfg *conf.Bootstrap) authzEngine.Engine {
	<span class="hljs-keyword">if</span> cfg.Authz == <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	}

	ctx := context.Background()

	<span class="hljs-keyword">switch</span> cfg.GetAuthz().GetType() {
	<span class="hljs-keyword">default</span>:
		<span class="hljs-keyword">fallthrough</span>
	<span class="hljs-keyword">case</span> <span class="hljs-string">"noop"</span>:
		state, err := noop.NewEngine(ctx)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			a.log.Errorf(<span class="hljs-string">"new noop engine error: %v"</span>, err)
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}
		<span class="hljs-keyword">return</span> state

	<span class="hljs-keyword">case</span> <span class="hljs-string">"casbin"</span>:
		state, err := casbin.NewEngine(ctx)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			a.log.Errorf(<span class="hljs-string">"init casbin engine error: %v"</span>, err)
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}
		<span class="hljs-keyword">return</span> state
	}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> Engine() authzEngine.Engine {
	<span class="hljs-keyword">return</span> a.engine
}

<span class="hljs-comment">// ResetPolicies é‡ç½®ç­–ç•¥</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> ResetPolicies(ctx context.Context) <span class="hljs-type">error</span> {
	<span class="hljs-comment">//a.log.Info("*******************reset policies")</span>

	roles, err := a.roleRepo.List(ctx, &amp;pagination.PagingRequest{NoPaging: trans.Ptr(<span class="hljs-literal">true</span>)})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		a.log.Errorf(<span class="hljs-string">"failed to list roles: %v"</span>, err)
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-keyword">if</span> roles == <span class="hljs-literal">nil</span> || <span class="hljs-built_in">len</span>(roles.Items) &lt; <span class="hljs-number">1</span> {
		a.log.Warnf(<span class="hljs-string">"no roles found to set policies"</span>)
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> <span class="hljs-comment">// No roles to set policies</span>
	}

	apis, err := a.apiResourceRepo.List(ctx, &amp;pagination.PagingRequest{NoPaging: trans.Ptr(<span class="hljs-literal">true</span>)})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		a.log.Errorf(<span class="hljs-string">"failed to list APIs: %v"</span>, err)
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-keyword">if</span> apis == <span class="hljs-literal">nil</span> || <span class="hljs-built_in">len</span>(apis.Items) &lt; <span class="hljs-number">1</span> {
		a.log.Warnf(<span class="hljs-string">"no APIs found to set policies for roles"</span>)
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> <span class="hljs-comment">// No APIs to set policies</span>
	}

	<span class="hljs-comment">//a.log.Debugf("roles [%d] apis [%d]", len(roles.Items), len(apis.Items))</span>

	<span class="hljs-keyword">var</span> policies authzEngine.PolicyMap

	<span class="hljs-keyword">switch</span> a.engine.Name() {
	<span class="hljs-keyword">case</span> <span class="hljs-string">"casbin"</span>:
		<span class="hljs-keyword">if</span> policies, err = a.generateCasbinPolicies(roles, apis); err != <span class="hljs-literal">nil</span> {
			a.log.Errorf(<span class="hljs-string">"generate casbin policies error: %v"</span>, err)
			<span class="hljs-keyword">return</span> err
		}

	<span class="hljs-keyword">case</span> <span class="hljs-string">"noop"</span>:
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>

	<span class="hljs-keyword">default</span>:
		a.log.Warnf(<span class="hljs-string">"unknown engine name: %s"</span>, a.engine.Name())
		<span class="hljs-keyword">return</span> errors.New(<span class="hljs-string">"unknown authz engine name"</span>)
	}

	<span class="hljs-comment">//a.log.Debugf("***************** policy rules len: %v", len(rules))</span>

	<span class="hljs-keyword">if</span> err = a.engine.SetPolicies(context.Background(), policies, <span class="hljs-literal">nil</span>); err != <span class="hljs-literal">nil</span> {
		a.log.Errorf(<span class="hljs-string">"set policies error: %v"</span>, err)
		<span class="hljs-keyword">return</span> err
	}
	a.log.Infof(<span class="hljs-string">"Reloaded policy rules"</span>)

	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// generateCasbinPolicies ç”Ÿæˆ Casbin ç­–ç•¥</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> generateCasbinPolicies(roles *userV1.ListRoleResponse, apis *adminV1.ListApiResourceResponse) (authzEngine.PolicyMap, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> rules []casbin.PolicyRule
	apiSet := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">uint32</span>]<span class="hljs-keyword">struct</span>{})

	domain := <span class="hljs-string">"*"</span>

	<span class="hljs-keyword">for</span> _, role := <span class="hljs-keyword">range</span> roles.Items {
		<span class="hljs-keyword">if</span> role.GetId() == <span class="hljs-number">0</span> {
			<span class="hljs-keyword">continue</span> <span class="hljs-comment">// Skip if role or API ID is not set</span>
		}

		<span class="hljs-keyword">for</span> _, apiId := <span class="hljs-keyword">range</span> role.GetApis() {
			apiSet[apiId] = <span class="hljs-keyword">struct</span>{}{}
		}

		<span class="hljs-keyword">for</span> _, api := <span class="hljs-keyword">range</span> apis.Items {
			<span class="hljs-keyword">if</span> api.GetId() == <span class="hljs-number">0</span> {
				<span class="hljs-keyword">continue</span> <span class="hljs-comment">// Skip if role or API ID is not set</span>
			}

			<span class="hljs-keyword">if</span> _, exists := apiSet[api.GetId()]; exists {
				rules = <span class="hljs-built_in">append</span>(rules, casbin.PolicyRule{
					PType: <span class="hljs-string">"p"</span>,
					V0:    role.GetCode(),
					V1:    api.GetPath(),
					V2:    api.GetMethod(),
					V3:    domain,
				})
			}
		}
	}

	policies := authzEngine.PolicyMap{
		<span class="hljs-string">"policies"</span>: rules,
		<span class="hljs-string">"projects"</span>: authzEngine.MakeProjects(),
	}

	<span class="hljs-keyword">return</span> policies, <span class="hljs-literal">nil</span>
}
</code></pre>
<h4 data-id="heading-17">3.2 ä¾èµ–æ³¨å…¥ï¼šæ³¨å†Œ Authorizer åˆ° Wire å®¹å™¨</h4>
<p>GoWind Admin ä½¿ç”¨ Wire å®ç°ä¾èµ–æ³¨å…¥ï¼Œéœ€ä¿®æ”¹ <code>app/admin/service/internal/data/init.go</code>ï¼Œå°† <code>NewAuthorizer</code> æ³¨å†Œåˆ°ä¾èµ–å®¹å™¨ï¼Œç¡®ä¿æ¡†æ¶å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–æƒé™ç®¡ç†å™¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// app/admin/service/internal/data/init.go</span>

<span class="hljs-comment">//go:build wireinject</span>
<span class="hljs-comment">// +build wireinject</span>

<span class="hljs-keyword">package</span> data

<span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/google/wire"</span>

<span class="hljs-comment">// ProviderSet æ•°æ®å±‚ä¾èµ–æ³¨å…¥é›†åˆ</span>
<span class="hljs-keyword">var</span> ProviderSet = wire.NewSet(
    NewAuthorizer,        <span class="hljs-comment">// æ³¨å†Œæƒé™ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰</span>
    NewRoleRepo,          <span class="hljs-comment">// æ³¨å†Œè§’è‰²æ•°æ®ä»“åº“</span>
    NewApiResourceRepo,   <span class="hljs-comment">// æ³¨å†Œ API èµ„æºæ•°æ®ä»“åº“</span>
    <span class="hljs-comment">// ... å…¶ä»–æ•°æ®ä»“åº“ï¼ˆå¦‚ç”¨æˆ·ä»“åº“ã€èœå•ä»“åº“ç­‰ï¼‰</span>
)
</code></pre>
<h4 data-id="heading-18">3.3 ä¸­é—´ä»¶é›†æˆï¼šåµŒå…¥ REST æœåŠ¡è¯·æ±‚é“¾è·¯</h4>
<p>å°† OPA æƒé™æ ¡éªŒä¸­é—´ä»¶åµŒå…¥ REST æœåŠ¡å™¨çš„è¯·æ±‚é“¾è·¯ï¼Œå®ç°å¯¹æ‰€æœ‰ API æ¥å£çš„æƒé™æ‹¦æˆªã€‚ä¿®æ”¹ <code>app/admin/service/internal/server/rest.go</code>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// app/admin/service/internal/server/rest.go</span>

<span class="hljs-keyword">package</span> server

<span class="hljs-comment">// NewMiddleware åˆ›å»ºä¸­é—´ä»¶</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newRestMiddleware</span><span class="hljs-params">(
	logger log.Logger,
	authenticator authnEngine.Authenticator,
	authorizer *data.Authorizer,
)</span></span> []middleware.Middleware {
	<span class="hljs-keyword">var</span> ms []middleware.Middleware
	ms = <span class="hljs-built_in">append</span>(ms, logging.Server(logger))

	ms = <span class="hljs-built_in">append</span>(ms, selector.Server(
		authn.Server(authenticator),
		auth.Server(),
		authz.Server(authorizer.Engine()),
	).Match(newRestWhiteListMatcher()).Build())

	<span class="hljs-keyword">return</span> ms
}

<span class="hljs-comment">// NewRESTServer new an HTTP server.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewRESTServer</span><span class="hljs-params">(
    cfg *conf.Bootstrap, logger log.Logger,
	authenticator authnEngine.Authenticator, authorizer *data.Authorizer,
)</span></span> {
    ...

	srv := rpc.CreateRestServer(cfg,
		newRestMiddleware(logger, authenticator, authorizer)...,
	)

    ...
}
</code></pre>
<h4 data-id="heading-19">3.4 é…ç½®å¯ç”¨ï¼šä¿®æ”¹ auth.yaml å¯ç”¨ OPA</h4>
<p>ä¿®æ”¹ <code>app/admin/service/configs/auth.yaml</code>ï¼Œå°†æƒé™å¼•æ“ç±»å‹è®¾ç½®ä¸º <code>opa</code>ï¼Œå¯ç”¨æƒé™æ ¡éªŒï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># app/admin/service/configs/auth.yaml</span>
<span class="hljs-comment"># è®¤è¯ä¸æˆæƒé…ç½®</span>
<span class="hljs-attr">auth:</span>
  <span class="hljs-comment"># è®¤è¯é…ç½®ï¼ˆå¦‚ JWTã€OAuth2 ç­‰ï¼Œæ ¹æ®å®é™…éœ€æ±‚é…ç½®ï¼‰</span>
  <span class="hljs-attr">authn:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">"jwt"</span>
    <span class="hljs-attr">jwt:</span>
      <span class="hljs-attr">secret:</span> <span class="hljs-string">"your-jwt-secret"</span>
      <span class="hljs-attr">expires_at:</span> <span class="hljs-number">3600</span>

<span class="hljs-comment"># æˆæƒé…ç½®ï¼ˆæ ¸å¿ƒï¼‰</span>
<span class="hljs-attr">authz:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">"opa"</span>  <span class="hljs-comment"># å¯ç”¨ OPA å¼•æ“ï¼ˆå¯é€‰ï¼šopa/noopï¼‰</span>
  <span class="hljs-comment"># OPA é¢å¤–é…ç½®ï¼ˆå¯é€‰ï¼Œæ ¹æ®å®é™…éœ€æ±‚æ‰©å±•ï¼‰</span>
  <span class="hljs-comment"># opa:</span>
  <span class="hljs-comment">#   cache:  # ç­–ç•¥ç¼“å­˜é…ç½®</span>
  <span class="hljs-comment">#     enabled: true</span>
  <span class="hljs-comment">#     ttl: 300s  # ç¼“å­˜è¿‡æœŸæ—¶é—´</span>
  <span class="hljs-comment">#   watch: true  # ç›‘å¬ç­–ç•¥æ–‡ä»¶å˜åŒ–ï¼ŒåŠ¨æ€é‡è½½ï¼ˆå¼€å‘ç¯å¢ƒæ¨èï¼‰</span>
</code></pre>
<h4 data-id="heading-20">3.5 è‡ªå®šä¹‰æ¨¡å‹ï¼šå†…åµŒè‡ªå®šä¹‰ OPA ç­–ç•¥</h4>
<p>è‹¥é»˜è®¤çš„ RBAC ç­–ç•¥æ¨¡å‹ä¸æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚æ”¯æŒæ•°æ®æƒé™ã€å¤šç§Ÿæˆ·éš”ç¦»ç­‰ï¼‰ï¼Œå¯è‡ªå®šä¹‰ Rego ç­–ç•¥æ–‡ä»¶ï¼Œé€šè¿‡ Go å†…ç½®çš„ <code>//go:embed</code> æŒ‡ä»¤å†…åµŒåˆ°é¡¹ç›®ä¸­ï¼Œå®ç°ç­–ç•¥ä¸ç¨‹åºçš„ä¸€ä½“åŒ–éƒ¨ç½²ã€‚</p>
<h5 data-id="heading-21">æ­¥éª¤ 1ï¼šåˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥æ–‡ä»¶</h5>
<p>åœ¨ <code>app/admin/service/cmd/server/assets/</code> ç›®å½•ä¸‹åˆ›å»º <code>opa_custom.rego</code>ï¼Œç¼–å†™è‡ªå®šä¹‰ç­–ç•¥ï¼ˆç¤ºä¾‹ï¼šæ”¯æŒå¤šç§Ÿæˆ·çš„ RBAC è§„åˆ™ï¼‰ï¼š</p>
<pre><code class="hljs language-rego" lang="rego">package authz

default allow = false

# è‡ªå®šä¹‰è§„åˆ™ï¼šç§Ÿæˆ·å†…ç®¡ç†å‘˜å¯è®¿é—®æ‰€æœ‰æ¥å£
allow {
    input.tenant_id != ""  # ç§Ÿæˆ·IDéç©º
    input.user_role == "tenant_admin"  # ç”¨æˆ·ä¸ºç§Ÿæˆ·ç®¡ç†å‘˜
}

# è‡ªå®šä¹‰è§„åˆ™ï¼šæ™®é€šç”¨æˆ·ä»…å¯è®¿é—®è‡ªèº«ç§Ÿæˆ·çš„èµ„æº
allow {
    input.tenant_id != ""
    input.user_role == "user"
    input.resource_tenant_id == input.tenant_id  # èµ„æºç§Ÿæˆ·IDä¸ç”¨æˆ·ç§Ÿæˆ·IDä¸€è‡´
    input.method == "GET"  # ä»…å…è®¸æŸ¥è¯¢æ“ä½œ
}

# è‡ªå®šä¹‰è§„åˆ™ï¼šè¶…çº§ç®¡ç†å‘˜å¿½ç•¥ç§Ÿæˆ·é™åˆ¶
allow {
    input.user_role == "super_admin"
}
</code></pre>
<h5 data-id="heading-22">æ­¥éª¤ 2ï¼šå†…åµŒç­–ç•¥æ–‡ä»¶</h5>
<p>ä¿®æ”¹ <code>app/admin/service/cmd/server/assets/assets.go</code>ï¼Œé€šè¿‡ <code>//go:embed</code> æŒ‡ä»¤å°†è‡ªå®šä¹‰ç­–ç•¥æ–‡ä»¶å†…åµŒåˆ°ç¨‹åºä¸­ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// app/admin/service/cmd/server/assets/assets.go</span>
<span class="hljs-keyword">package</span> assets

<span class="hljs-keyword">import</span> _ <span class="hljs-string">"embed"</span>

<span class="hljs-comment">// å†…åµŒé»˜è®¤ RBAC ç­–ç•¥ï¼ˆåŸæœ‰ï¼‰</span>
<span class="hljs-comment">//go:embed opa_rbac.rego</span>
<span class="hljs-keyword">var</span> OpaRbacRego []<span class="hljs-type">byte</span>

<span class="hljs-comment">// å†…åµŒè‡ªå®šä¹‰ OPA ç­–ç•¥ï¼ˆæ–°å¢ï¼‰</span>
<span class="hljs-comment">//go:embed opa_custom.rego</span>
<span class="hljs-keyword">var</span> OpaCustomRego []<span class="hljs-type">byte</span>
</code></pre>
<h5 data-id="heading-23">æ­¥éª¤ 3ï¼šåŠ è½½è‡ªå®šä¹‰ç­–ç•¥</h5>
<p>ä¿®æ”¹ <code>Authorizer.newEngine</code> æ–¹æ³•ï¼ŒåŠ è½½å†…åµŒçš„è‡ªå®šä¹‰ç­–ç•¥æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> data

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"go-wind-admin/app/admin/service/cmd/server/assets"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Authorizer)</span></span> newEngine(cfg *conf.Bootstrap) authzEngine.Engine {
	<span class="hljs-keyword">switch</span> cfg.GetAuthz().GetType() {
	<span class="hljs-keyword">default</span>:
		<span class="hljs-keyword">fallthrough</span>

	<span class="hljs-keyword">case</span> <span class="hljs-string">"casbin"</span>:
		state, err := opa.NewEngine(ctx,
			opa.WithModulesFromString(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{
				<span class="hljs-string">"custom.rego"</span>: <span class="hljs-type">string</span>(assets.OpaCustomRego),
			}),
		)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			a.log.Errorf(<span class="hljs-string">"init opa engine error: %v"</span>, err)
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}

		<span class="hljs-keyword">if</span> err = state.InitModulesFromString(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{
			<span class="hljs-string">"custom.rego"</span>: <span class="hljs-type">string</span>(assets.OpaCustomRego),
		}); err != <span class="hljs-literal">nil</span> {
			a.log.Errorf(<span class="hljs-string">"init opa modules error: %v"</span>, err)
		}

		<span class="hljs-keyword">return</span> state
	}
}
</code></pre>
<h3 data-id="heading-24">å››ã€é¡¹ç›®èµ„æºä¸å‚è€ƒèµ„æ–™</h3>
<h4 data-id="heading-25">4.1 æ ¸å¿ƒé¡¹ç›®ä»“åº“</h4>
<ul>
<li>GoWind Adminï¼ˆGiteeï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Ftx7do%2Fgo-wind-admin" target="_blank" title="https://gitee.com/tx7do/go-wind-admin" ref="nofollow noopener noreferrer">gitee.com/tx7do/go-wiâ€¦</a></li>
<li>GoWind Adminï¼ˆGitHubï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftx7do%2Fgo-wind-admin" target="_blank" title="https://github.com/tx7do/go-wind-admin" ref="nofollow noopener noreferrer">github.com/tx7do/go-wiâ€¦</a></li>
<li>Kratos-Authzï¼ˆOPA/Casbin å°è£…ç»„ä»¶ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftx7do%2Fkratos-authz" target="_blank" title="https://github.com/tx7do/kratos-authz" ref="nofollow noopener noreferrer">github.com/tx7do/kratoâ€¦</a></li>
<li>OPA å®˜æ–¹ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopen-policy-agent%2Fopa%2F" target="_blank" title="https://github.com/open-policy-agent/opa/" ref="nofollow noopener noreferrer">github.com/open-policyâ€¦</a></li>
</ul>
<h4 data-id="heading-26">4.2 å­¦ä¹ å‚è€ƒèµ„æ–™</h4>
<h5 data-id="heading-27">å®˜æ–¹æ–‡æ¡£</h5>
<ul>
<li>OPA å®˜æ–¹ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.openpolicyagent.org%2F" target="_blank" title="https://www.openpolicyagent.org/" ref="nofollow noopener noreferrer">www.openpolicyagent.org/</a></li>
<li>OPA äº¤äº’å¼è§£é‡Šå™¨ï¼ˆåœ¨çº¿æµ‹è¯• Regoï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplay.openpolicyagent.org%2F" target="_blank" title="https://play.openpolicyagent.org/" ref="nofollow noopener noreferrer">play.openpolicyagent.org/</a></li>
</ul>
<h5 data-id="heading-28">å…¥é—¨ä¸è¿›é˜¶æ•™ç¨‹</h5>
<ul>
<li>ã€Šç­–ç•¥å³ä»£ç â€”â€”Open Policy Agentï¼ˆOPAï¼‰ç®€ä»‹ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloudnative.to%2Fblog%2Fintroducing-policy-as-code-the-open-policy-agent-opa%2F" target="_blank" title="https://cloudnative.to/blog/introducing-policy-as-code-the-open-policy-agent-opa/" ref="nofollow noopener noreferrer">cloudnative.to/blog/introdâ€¦</a></li>
<li>ã€ŠHow to Write Your First Rules in Regoã€‹ï¼ˆå®˜æ–¹å…¥é—¨ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.styra.com%2Fblog%2Fhow-to-write-your-first-rules-in-rego-the-policy-language-for-opa%2F" target="_blank" title="https://www.styra.com/blog/how-to-write-your-first-rules-in-rego-the-policy-language-for-opa/" ref="nofollow noopener noreferrer">www.styra.com/blog/how-toâ€¦</a></li>
<li>ã€ŠOPAè¿›é˜¶-å‡½æ•°ä¸è™šæ‹Ÿæ–‡æ¡£è¦åˆ†æ¸…ã€‹ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fblog.newbmiao.com%2F2020%2F03%2F18%2Fopa-func-and-virtual-doc.html" target="_blank" title="http://blog.newbmiao.com/2020/03/18/opa-func-and-virtual-doc.html" ref="nofollow noopener noreferrer">blog.newbmiao.com/2020/03/18/â€¦</a></li>
<li>ã€ŠOPAè¿›é˜¶-ç®€æ´çš„æ¨å¯¼å¼ã€‹ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fblog.newbmiao.com%2F2020%2F03%2F20%2Fopa-comprehensions.html" target="_blank" title="http://blog.newbmiao.com/2020/03/20/opa-comprehensions.html" ref="nofollow noopener noreferrer">blog.newbmiao.com/2020/03/20/â€¦</a></li>
</ul>
<h5 data-id="heading-29">å®è·µæ¡ˆä¾‹</h5>
<ul>
<li>ã€ŠOpen Policy Agent - å¿«é€Ÿå°å…¥ Authz è‡³ Microservice æ¶æ§‹ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fengineering.linecorp.com%2Fzh-hant%2Fblog%2Fopen-policy-agent-authz-in-microservice%2F" target="_blank" title="https://engineering.linecorp.com/zh-hant/blog/open-policy-agent-authz-in-microservice/" ref="nofollow noopener noreferrer">engineering.linecorp.com/zh-hant/bloâ€¦</a></li>
<li>ã€ŠOpen Policy Agent: What Is OPA and How It Works (Examples)ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fspacelift.io%2Fblog%2Fwhat-is-open-policy-agent-and-how-it-works" target="_blank" title="https://spacelift.io/blog/what-is-open-policy-agent-and-how-it-works" ref="nofollow noopener noreferrer">spacelift.io/blog/what-iâ€¦</a></li>
</ul>
<h3 data-id="heading-30">äº”ã€é›†æˆéªŒè¯ä¸å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-31">5.1 é›†æˆéªŒè¯æ­¥éª¤</h4>
<ol>
<li>å¯åŠ¨ GoWind Admin æœåŠ¡ï¼Œç¡®ä¿ OPA å¼•æ“åˆå§‹åŒ–æˆåŠŸï¼ˆæŸ¥çœ‹æ—¥å¿— <code>successfully reloaded xxx policy rules</code>ï¼‰ï¼›</li>
<li>é€šè¿‡ Postman ç­‰å·¥å…·å‘é€è¯·æ±‚ï¼š
<ul>
<li>æœªè®¤è¯è¯·æ±‚ï¼šè®¿é—®éœ€è¦æƒé™çš„æ¥å£ï¼Œåº”è¿”å› 401 æœªæˆæƒï¼›</li>
<li>å·²è®¤è¯ä½†æ— æƒé™ï¼šä½¿ç”¨æ™®é€šç”¨æˆ· Token è®¿é—®ç®¡ç†å‘˜æ¥å£ï¼Œåº”è¿”å› 403 ç¦æ­¢è®¿é—®ï¼›</li>
<li>å·²è®¤è¯ä¸”æœ‰æƒé™ï¼šä½¿ç”¨ç®¡ç†å‘˜ Token è®¿é—®ç®¡ç†å‘˜æ¥å£ï¼Œåº”è¿”å› 200 æˆåŠŸã€‚</li>
</ul>
</li>
<li>ä¿®æ”¹è§’è‰²-API æƒé™æ˜ å°„ï¼Œè°ƒç”¨ <code>Authorizer.ResetPolicies</code> æ¥å£é‡ç½®ç­–ç•¥ï¼ŒéªŒè¯æƒé™åŠ¨æ€æ›´æ–°æ˜¯å¦ç”Ÿæ•ˆã€‚</li>
</ol>
<h4 data-id="heading-32">5.2 å¸¸è§é—®é¢˜æ’æŸ¥</h4>
<ul>
<li>OPA å¼•æ“åˆå§‹åŒ–å¤±è´¥ï¼šæ£€æŸ¥ç­–ç•¥æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼ˆå¯é€šè¿‡ OPA åœ¨çº¿è¯•ç‚¼åœºéªŒè¯ï¼‰ã€å†…åµŒæ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼›</li>
<li>æƒé™æ ¡éªŒä¸ç”Ÿæ•ˆï¼šç¡®è®¤ä¸­é—´ä»¶é¡ºåºï¼ˆå…ˆè®¤è¯åæˆæƒï¼‰ã€ç™½åå•é…ç½®æ˜¯å¦æ­£ç¡®ã€è¯·æ±‚è¾“å…¥æ˜¯å¦åŒ…å« <code>user</code>ã€<code>role</code> ç­‰ç­–ç•¥æ‰€éœ€å­—æ®µï¼›</li>
<li>ç­–ç•¥æ›´æ–°ä¸ç”Ÿæ•ˆï¼šç¡®ä¿ä¿®æ”¹æƒé™åè°ƒç”¨äº† <code>ResetPolicies</code> æ–¹æ³•ï¼Œé‡æ–°åŠ è½½ç­–ç•¥åˆ° OPA å¼•æ“ï¼›</li>
<li>æ€§èƒ½é—®é¢˜ï¼šå¯ç”¨ OPA ç­–ç•¥ç¼“å­˜ï¼ˆé…ç½® <code>authz.opa.cache</code>ï¼‰ï¼Œå‡å°‘é‡å¤ç­–ç•¥è®¡ç®—ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Agentã€‘MemOS æºç ç¬”è®°---(5)---è®°å¿†åˆ†ç±»]]></title>    <link>https://juejin.cn/post/7583910418658459694</link>    <guid>https://juejin.cn/post/7583910418658459694</guid>    <pubDate>2025-12-15T13:35:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583910418658459694" data-draft-id="7582955784569716787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Agentã€‘MemOS æºç ç¬”è®°---(5)---è®°å¿†åˆ†ç±»"/> <meta itemprop="keywords" content="ç®—æ³•,äººå·¥æ™ºèƒ½,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-15T13:35:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç½—è¥¿çš„æ€è€ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/351470467691175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Agentã€‘MemOS æºç ç¬”è®°---(5)---è®°å¿†åˆ†ç±»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/351470467691175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç½—è¥¿çš„æ€è€ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T13:35:35.000Z" title="Mon Dec 15 2025 13:35:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»35åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€Agentã€‘MemOS æºç ç¬”è®°---(5)---è®°å¿†åˆ†ç±»</h2>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x00 æ‘˜è¦</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x01 è®°å¿†åˆ†ç±»</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.1 ä¸šç•Œåˆ†ç±»</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.2 MemOS</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x02 MemOSåˆ†ç±»è§£æ</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.1 ç»´åº¦å®šä¹‰</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.2 æ ¸å¿ƒå…³ç³»è§£æ</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x03 MemOSçš„å…·ä½“å®ç°</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.1 åŸºæœ¬æ¦‚å¿µ</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.2 è®°å¿†ç”Ÿæˆ</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x04 MemOS è®°å¿†ç”Ÿå‘½å‘¨æœŸç®¡ç†</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">4.1 ç”Ÿå‘½å‘¨æœŸé˜¶æ®µç®€ä»‹</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">4.2 æ¡ˆä¾‹ï¼šåœ¨çº¿æ•™è‚²åŠ©æ‰‹çš„è®°å¿†ç”Ÿå‘½å‘¨æœŸ</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">4.3 è‡ªå·±çš„ç†è§£</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">4.4 MemScheduler</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0xFF å‚è€ƒ</a></p>
</li>
</ul>
<h3 data-id="heading-1">0x00 æ‘˜è¦</h3>
<p>å¤§æ¨¡å‹ä¹‹æ‰€ä»¥â€œå¿˜äº‹â€ï¼Œæ ¹æœ¬åœ¨äºæˆ‘ä»¬å¯¹â€œæ— çŠ¶æ€æ¨¡å‹â€é‡Œâ€œä¸Šä¸‹æ–‡çª—å£â€çš„è¯¯è§£ã€‚å¾ˆå¤šäººæŠŠå®ƒå½“æˆä¸€åªå¤§ç®©ç­ï¼Œè®¤ä¸ºè£…å¾—è¶Šå¤šè¶Šå¥½ï¼›ç„¶è€Œï¼Œäº‹å®ä¸Šï¼Œä¸Šä¸‹æ–‡çª—å£æ›´åƒä¸€å—å®¹é‡æœ‰é™çš„å·¥ä½œè®°å¿†ã€‚ç¡¬å¡å¤ªå¤šä¿¡æ¯ï¼Œåªä¼šåŒæ—¶å¸¦æ¥å¦‚ä¸‹éº»çƒ¦ï¼šå…³é”®å†…å®¹è¢«å™ªå£°æ·¹æ²¡ï¼Œæ¨¡å‹æŠ“ä¸ä½é‡ç‚¹ï¼Œä¸Šä¸‹æ–‡è¶Šé•¿ï¼Œè´¹ç”¨å’Œå»¶è¿Ÿä¹Ÿè¶Šé«˜ã€‚</p>
<p>è¿™ä¸æ˜¯æ¨¡å‹å·æ‡’ï¼Œè€Œæ˜¯ Transformer æ¶æ„çš„å…ˆå¤©ç‰¹æ€§ã€‚æ¯ä¸€æ¬¡è°ƒç”¨éƒ½åƒé‡æ–°å¼€æœºï¼šæ²¡æœ‰é•¿æœŸè®°å¿†ï¼Œä¸Šä¸‹æ–‡ä¸€æ—¦è¿‡é•¿ï¼Œæ³¨æ„åŠ›å°±è¢«å†—ä½™ä¿¡æ¯æ‰¯æ•£ï¼Œäºæ˜¯å‡ºç°é—å¿˜ã€è·‘é¢˜ã€é€Ÿåº¦ä¸‹é™ã€‚</p>
<p>ä¸ºäº†è¡¥ä¸Šè¿™å—çŸ­æ¿ï¼Œäººä»¬åœ¨è®°å¿†ä¸Šå¤§åŠ¨æ‰‹è„šã€‚</p>
<p>è™½ç„¶å‰æ–‡ç®€ç•¥ä»‹ç»äº†MemOSçš„è®°å¿†ç±»å‹ï¼Œä½†æ˜¯å¹¶æœªæ·±å…¥ï¼Œæœ¬æ–‡ä»¥å®˜æ–¹æ–‡æ¡£ä¸ºåŸºç¡€è¿›è¡Œè§£è¯»ï¼Œç›®çš„æ˜¯äº†è§£MemOSçš„è®°å¿†åˆ†ç±»ï¼Œä»¥åŠå…¶ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h3 data-id="heading-2">0x01 è®°å¿†åˆ†ç±»</h3>
<h4 data-id="heading-3">1.1 ä¸šç•Œåˆ†ç±»</h4>
<p>ä¸ºäº†æ›´å¥½çš„åˆ†æï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸šç•Œå¦‚ä½•å¯¹è®°å¿†è¿›è¡Œåˆ†ç±»ã€‚</p>
<p>åœ¨å½“å‰ï¼ˆæˆªè‡³ 2025 å¹´ï¼‰ä¸»æµçš„æ™ºèƒ½ä½“ï¼ˆAgentï¼‰ç³»ç»Ÿå’Œè®°å¿†æ¶æ„ç ”ç©¶ä¸å®è·µä¸­ï¼Œå­˜åœ¨å¤šç§åˆ†ç±»æ–¹å¼ï¼Œè¿™äº›åˆ†ç±»å€Ÿé‰´è‡ªè®¤çŸ¥ç§‘å­¦ï¼Œå¹¶è¢« AI Agent æ¶æ„ä¸åŒç¨‹åº¦åœ°é‡‡çº³ã€‚</p>
<h5 data-id="heading-4">1.1.1 æ•´ä½“å›¾è¡¨</h5>
<p>å…ˆç»™å‡ºæ•´ä½“å›¾è¡¨ã€‚</p>





















































<table><thead><tr><th>Memory ç±»å‹</th><th>ç‰¹ç‚¹</th><th>å­˜å‚¨å½¢å¼</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td><strong>å·¥ä½œè®°å¿†ï¼ˆWorkingï¼‰</strong></td><td>ä»»åŠ¡çº§ã€ä¸´æ—¶ã€ç»“æ„åŒ–</td><td>å†…å­˜ä¸­çš„å­—å…¸ / å¯¹è±¡</td><td>æ­£åœ¨æ‰§è¡Œçš„å·¥å…·è°ƒç”¨å‚æ•°ã€ä»»åŠ¡çŠ¶æ€</td></tr><tr><td><strong>çŸ­æœŸè®°å¿†ï¼ˆShort-term Memoryï¼‰</strong></td><td>å®¹é‡å°ã€æ—¶æ•ˆçŸ­ã€ä¸Šä¸‹æ–‡ç›¸å…³</td><td>å†…å­˜ä¸­çš„ç¼“å­˜ / åˆ—è¡¨</td><td>å½“å‰å¯¹è¯ã€ä»»åŠ¡æ‰§è¡Œä¸­çš„ä¸´æ—¶çŠ¶æ€</td></tr><tr><td><strong>é•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰</strong></td><td>æŒä¹…å­˜å‚¨ã€å¯æ£€ç´¢ã€ç»“æ„åŒ–/éç»“æ„åŒ–</td><td>ç»“æ„åŒ–æ•°æ®åº“ / å‘é‡åº“ / çŸ¥è¯†åº“</td><td>ç”¨æˆ·å†å²ã€çŸ¥è¯†åº“ã€ç»éªŒæ²‰æ·€</td></tr><tr><td><strong>æƒ…æ™¯è®°å¿†ï¼ˆEpisodic Memoryï¼‰</strong></td><td>è®°å½•ç‰¹å®šäº‹ä»¶ï¼ˆæ—¶é—´+åœ°ç‚¹+å†…å®¹ï¼‰å’Œå¯¹è¯è½¨è¿¹</td><td>å‘é‡æ•°æ®åº“ / çŸ¥è¯†åº“</td><td>å›å¿†â€œä¸Šæ¬¡ç”¨æˆ·è¯´...â€</td></tr><tr><td><strong>è¯­ä¹‰è®°å¿†ï¼ˆSemantic Memoryï¼‰</strong></td><td>æŠ½è±¡çŸ¥è¯†ï¼ˆäº‹å®ã€æ¦‚å¿µã€è§„åˆ™ï¼‰ï¼Œå³ä»å¤šæ¬¡äº¤äº’ä¸­æç‚¼ç¨³å®šäº‹å®</td><td>å‘é‡æ•°æ®åº“ / çŸ¥è¯†åº“</td><td>â€œå·´é»æ˜¯æ³•å›½é¦–éƒ½â€</td></tr><tr><td><strong>ç¨‹åºæ€§è®°å¿†ï¼ˆProcedural Memoryï¼‰</strong></td><td>å¦‚ä½•åšæŸäº‹ï¼ˆæŠ€èƒ½ã€æµç¨‹ï¼‰</td><td>ç»“æ„åŒ–æ•°æ®åº“ / å‘é‡åº“</td><td>è°ƒç”¨å·¥å…·é“¾ã€æ‰§è¡Œè®¡åˆ’</td></tr><tr><td><strong>åå¥½/ç”¨æˆ·ç”»åƒè®°å¿†/ä¸ªæ€§åŒ–è®°å¿†ï¼ˆPreference/User Profile Memoryï¼‰</strong></td><td>ç”¨æˆ·å…´è¶£ã€ä¹ æƒ¯ã€é£æ ¼åå¥½</td><td>ç»“æ„åŒ–æ•°æ®åº“ / å‘é‡åº“</td><td>ä¸ªæ€§åŒ–æ¨èã€è¯­æ°”è°ƒæ•´</td></tr></tbody></table>
<h5 data-id="heading-5">1.1.2 æ¢³ç†</h5>
<p>ä»¥ä¸‹åˆ†ç±»å±äºç¬”è€…è‡ªå·±çš„ç†è§£ï¼Œä¸ä¸€å®šæ­£ç¡®ï¼Œä»…ä¾›å¤§å®¶å‚è€ƒã€‚ä¸»è¦æ˜¯ â€œæ„ŸçŸ¥ - çŸ­æœŸ - é•¿æœŸâ€ ä¸‰çº§æ—¶æ•ˆåˆ†å±‚ä½“ç³»ï¼Œå„å±‚çº§åŠŸèƒ½ä¸ç‰¹æ€§ç›¸å¯¹å¯ä»¥æ˜ç¡®åŒºåˆ†ï¼š</p>
<ul>
<li>æ„ŸçŸ¥è®°å¿†ï¼ˆç¯å¢ƒæ„ŸçŸ¥è®°å¿†ï¼‰ï¼šæœ€ç¬æ—¶çš„è®°å¿†å½¢æ€ï¼Œä»…å­˜å‚¨å½“ä¸‹ç¯å¢ƒä¸­çš„å³æ—¶æ•°æ®ï¼ˆå¦‚è§†è§‰ã€å£°éŸ³ä¿¡æ¯ï¼‰ï¼Œæ— é•¿æœŸå¤ç”¨ä»·å€¼ï¼Œä»…åœ¨å½“å‰ç¬é—´æœ‰æ•ˆï¼Œéœ€é€šè¿‡è½¬åŒ–æœºåˆ¶è¿›å…¥æ›´é«˜å±‚çº§è®°å¿†æ‰èƒ½é•¿æœŸä¿ç•™ã€‚</li>
</ul>

<ul>
<li>
<p>çŸ­æœŸè®°å¿†ï¼ˆå¯¹åº” Agent çš„ Session çº§åˆ«æ•°æ®ç®¡ç†ï¼‰ï¼Œæ­¤å¤„æœ‰ä¸¤ç§éå¸¸ç±»ä¼¼çš„è¯´æ³•ï¼Œå¯ä»¥æ··ç”¨ã€‚å¯èƒ½å·¥ä½œè®°å¿†æ›´å¼ºè°ƒå½“å‰ä¼šè¯ï¼ŒçŸ­æœŸè®°å¿†å¼ºè°ƒçŸ­æœŸçš„å¯¹è¯è®°å½•ã€‚</p>
<ul>
<li>å·¥ä½œè®°å¿†ï¼ˆWorking Memoryï¼‰ï¼šç”¨æ¥å¤„ç†å½“å‰ä¼šè¯ä¸ä»»åŠ¡çš„ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬å½“å‰ç›®æ ‡ã€æ­£åœ¨æ‰§è¡Œçš„å­ä»»åŠ¡ç­‰ã€‚æ ¸å¿ƒä½œç”¨æ˜¯ä¿éšœä¸Šä¸‹æ–‡è¿ç»­æ€§ä¸å³æ—¶å“åº”èƒ½åŠ›ã€‚å®¹é‡æœ‰é™ï¼Œä½†è¯»å†™é¢‘ç¹ã€å»¶è¿Ÿæä½ã€‚æœ‰çš„æ–¹æ¡ˆä¸­ï¼Œå·¥ä½œè®°å¿†ä¹ŸåŒ…æ‹¬æœ€è¿‘å‡ è½®å¯¹è¯ã€‚</li>
<li>çŸ­æœŸè®°å¿†ï¼šä¸ç‰¹å®šä¼šè¯æˆ–ä»»åŠ¡çº¿ç¨‹å¼ºç»‘å®šï¼Œå³å¸¸è§çš„ â€œå†å²å¯¹è¯è®°å½•â€ï¼Œæ˜¯ LLM æ¨ç† API çš„æ ¸å¿ƒåŸºç¡€å‚æ•°ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ç»´æŒå•ä¸€ä¼šè¯å†…çš„äº¤äº’è¿è´¯æ€§ã€‚</li>
</ul>
</li>
<li>
<p>é•¿æœŸè®°å¿†ï¼šä¸ä¾èµ–ç‰¹å®šä¼šè¯ï¼Œå¯è·¨åœºæ™¯å¤ç”¨ï¼ŒåŒ…æ‹¬ä¸¤ç§åˆ†ç±»æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>åˆ†ç±»1ï¼ˆä»ç”¨æˆ·è§’åº¦å‡ºå‘ï¼‰</p>
<ul>
<li>
<p>æƒ…æ™¯è®°å¿†ï¼ˆEpisodic Memoryï¼‰ï¼šè´Ÿè´£å­˜å‚¨ç”¨æˆ·å’ŒAgentçš„å…·ä½“äº¤äº’äº‹ä»¶ã€‚è®°å½•è¿‡å¾€äº‹ä»¶ä¸è¡ŒåŠ¨å†ç¨‹ï¼ŒåŒºåˆ«äºå­¤ç«‹äº‹å®ï¼Œæ›´ä¾§é‡ â€œç»å†â€ çš„å®Œæ•´ç•™å­˜ï¼Œå¸®åŠ© Agent å›å¿†ä»»åŠ¡æ‰§è¡Œçš„å…·ä½“è¿‡ç¨‹ä¸åœºæ™¯ï¼›</p>
</li>
<li>
<p>é™ˆè¿°æ€§è®°å¿†ï¼ˆDeclarative Memoryï¼Œâ€œæ˜¯ä»€ä¹ˆï¼‰ï¼Œæ­¤å¤„ä¹Ÿæœ‰ä¸¤ç§ç±»ä¼¼çš„è¯´æ³•ï¼š</p>
<ul>
<li>è¯­ä¹‰è®°å¿†ï¼ˆSemantic Memoryâ€ï¼‰ï¼šé€šè¿‡å±‚çº§ç»“æ„å½’çº³ç”¨æˆ·é•¿æœŸä¿¡æ¯ã€‚èšç„¦äº‹å®ä¸æ¦‚å¿µçš„å­˜å‚¨ï¼Œå¦‚äº¤äº’ä¸­ç§¯ç´¯çš„ç‰¹å®šä¿¡æ¯ã€æ¦‚å¿µé—´çš„å…³è”å…³ç³»ï¼Œæ˜¯å®ç°ä¸ªæ€§åŒ–æœåŠ¡çš„å…³é”®ï¼ˆå¦‚è®°ä½ç”¨æˆ·çš„åå¥½äº‹å®ï¼‰ï¼›</li>
<li>é™ˆè¿°æ€§è®°å¿†ï¼šæ­¤åˆ†ç±»å’Œè¯­ä¹‰è®°å¿†å¾ˆç±»ä¼¼ï¼Œå±äºå°†è¯­ä¹‰è®°å¿†æ‰©å¤§åŒ–ã€‚å³ï¼Œ é™ˆè¿°æ€§è®°å¿†æ˜¯å…³äºäº‹å®å’Œäº‹ä»¶çš„çŸ¥è¯† ã€‚å®ƒå›ç­”çš„æ˜¯å„ç§â€œæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ â€” æ— è®ºæ˜¯ä¸–ç•ŒçŸ¥è¯†è¿˜æ˜¯ç”¨æˆ·çš„å…·ä½“ä¿¡æ¯ã€‚æ¯”å¦‚ç”¨æˆ·çš„å§“åã€å–œæ¬¢çš„ç¾é£Ÿï¼Œæ›¾é­é‡è¿‡çš„äº‹ä»¶ç­‰ï¼Œéƒ½å±äºé™ˆè¿°æ€§è®°å¿† ã€‚</li>
</ul>
</li>
<li>
<p>ç¨‹åºæ€§è®°å¿†ï¼ˆProcedural Memoryï¼Œâ€œæ€ä¹ˆåšâ€ï¼‰ï¼šå­˜å‚¨æ‰§è¡Œä»»åŠ¡çš„è§„åˆ™ã€æ–¹æ³•ä¸æµç¨‹ï¼Œç”±æ¨¡å‹æƒé‡ã€æ™ºèƒ½ä½“ä»£ç ã€æç¤ºè¯ç­–ç•¥ç­‰å…±åŒæ„æˆï¼Œç›¸å½“äº Agent çš„ â€œå†…åœ¨æ–¹æ³•è®ºâ€ï¼ŒæŒ‡å¯¼å…¶å¦‚ä½•å®Œæˆå…·ä½“ä»»åŠ¡ï¼ˆç±»ä¼¼äººç±»éª‘è‡ªè¡Œè½¦çš„æŠ€èƒ½è®°å¿†ï¼‰ã€‚</p>
</li>
<li>
<p>ä¸ªæ€§åŒ–è®°å¿†ï¼šå½¢æˆå…³äºç”¨æˆ·çš„æŒç»­ç”»åƒã€‚é€šè¿‡ä¼šè¯å†…å®¹æ‘˜è¦ç­‰æ–¹å¼æå–çš„ç”¨æˆ·ç”»åƒä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åå¥½ã€è¡Œä¸ºä¹ æƒ¯ã€èº«ä»½ç‰¹å¾ç­‰ï¼Œæ”¯æ’‘é•¿æœŸäº¤äº’ä¸­çš„ä¸ªæ€§åŒ–æœåŠ¡ã€‚</p>
</li>
</ul>
</li>
<li>
<p>åˆ†ç±»2ï¼ˆä»å®é™…åº”ç”¨åŠŸèƒ½å‡ºå‘ï¼‰ï¼š</p>
<ul>
<li>æ£€ç´¢è®°å¿†ï¼šé€šè¿‡ RAG æŠ€æœ¯å¯¹æ¥å¤–éƒ¨çŸ¥è¯†åº“ï¼Œæ ¸å¿ƒä»·å€¼æ˜¯è¡¥å……æ¨¡å‹åŸç”ŸçŸ¥è¯†ï¼ŒåŒæ—¶å‡å°‘å†…éƒ¨çŸ¥è¯†å†²çªï¼Œæå‡ä¿¡æ¯è·å–çš„ç²¾å‡†æ€§ä¸æ—¶æ•ˆæ€§ã€‚</li>
<li>é€šç”¨è®°å¿†ï¼šé€šè¿‡é¢„è®­ç»ƒæˆ–åç»­å¾®è°ƒæ²‰æ·€çš„åŸºç¡€é€šç”¨çŸ¥è¯†ï¼Œæ„æˆ Agent çš„æ ¸å¿ƒè®¤çŸ¥åº•åº§ï¼Œæ”¯æ’‘å„ç±»åŸºç¡€ä»»åŠ¡çš„ç†è§£ä¸æ‰§è¡Œã€‚</li>
<li>è§„åˆ™è®°å¿†ï¼šä»¥å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ã€æç¤ºè¯ï¼ˆPromptï¼‰ç­‰æ–¹å¼å›ºåŒ–çš„è¡Œä¸ºè§„èŒƒï¼Œç”¨äºçº¦æŸ Agent è¾“å‡ºæ ¼å¼ï¼ˆå¦‚ JSONã€CoT é“¾å¼æ¨ç†ï¼‰ä¸è¡Œä¸ºè¾¹ç•Œï¼Œç¡®ä¿å“åº”çš„ä¸€è‡´æ€§ä¸åˆè§„æ€§ã€‚</li>
<li>ä¸ªæ€§åŒ–è®°å¿†ï¼šé€šè¿‡ä¼šè¯å†…å®¹æ‘˜è¦ç­‰æ–¹å¼æå–çš„ç”¨æˆ·ç”»åƒä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åå¥½ã€è¡Œä¸ºä¹ æƒ¯ã€èº«ä»½ç‰¹å¾ç­‰ï¼Œæ”¯æ’‘é•¿æœŸäº¤äº’ä¸­çš„ä¸ªæ€§åŒ–æœåŠ¡ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">1.2 MemOS</h4>
<p>MemOSå¯¹è®°å¿†æœ‰ä¸¤ç§åˆ†ç±»ï¼š</p>
<p>ç¬¬ä¸€ç§æ˜¯åˆ†æˆä¸‰ä¸ªå­ç±»ï¼š</p>
<ul>
<li>ç»“æ„åŒ–è®°å¿†ï¼ˆæ˜æ–‡è®°å¿†ï¼‰ï¼šå°è¯•åŸºäºå›¾çš„åˆ†å±‚çŸ¥è¯† TreeTextMemoryï¼Œæ˜¯ç»“æ„åŒ–ã€å±‚æ¬¡åŒ–å’ŒçŸ¥è¯†å›¾è°±ã€‚å›¾ä¸å‘é‡åç«¯ä¼šè¿æ¥ Neo4j æˆ– Qdrant å®ç°ç”Ÿäº§çº§å‘é‡/å›¾æœç´¢ã€‚é€‚åˆå¸¸é’æŠ€èƒ½å’Œç¨³å®šçš„é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚</li>
<li>æ¿€æ´»è®°å¿†ï¼šè¿è¡Œæ—¶çš„ KV ç¼“å­˜å’Œéšè—çŠ¶æ€ï¼ˆé«˜æ•ˆç‡ï¼‰ï¼Œä½¿ç”¨ KVCacheMemory ï¼ˆæœ€è¿‘æˆ–ç¨³å®šçš„ä¸Šä¸‹æ–‡ï¼‰åŠ é€Ÿå¤šè½®å¯¹è¯ï¼Œé«˜æ•ˆçš„è¿è¡Œæ—¶çŠ¶æ€ç¼“å­˜ã€‚é€‚åˆå¯¹è¯ä¸­çš„å¿«é€Ÿé‡ç”¨ã€å¤šè½®ä¼šè¯ã€‚</li>
<li>å‚æ•°åŒ–è®°å¿†ï¼šåµŒå…¥æ¨¡å‹ä¸­çš„é•¿æœŸçŸ¥è¯†å’ŒæŠ€èƒ½ï¼Œç”¨é€‚é…å™¨/LoRA å®ç°åŠ¨æ€æŠ€èƒ½æ³¨å…¥ã€‚é€‚åˆå¯æœç´¢ã€å¯æ£€æŸ¥ã€æ¼”è¿›çŸ¥è¯†ã€‚</li>
</ul>
<p>ç¬¬äºŒç§ä¹Ÿæ˜¯ä¸‰ä¸ªå­ç±»ï¼š</p>
<ul>
<li><code>WorkingMemory</code>: å·¥ä½œè®°å¿†ï¼Œä¸´æ—¶å­˜å‚¨</li>
<li><code>LongTermMemory</code>: é•¿æœŸè®°å¿†ï¼ŒæŒä¹…å­˜å‚¨</li>
<li><code>UserMemory</code>: ç”¨æˆ·è®°å¿†ï¼Œä¸ªæ€§åŒ–å­˜å‚¨</li>
</ul>
<h3 data-id="heading-7">0x02 MemOSåˆ†ç±»è§£æ</h3>
<p>MemOS è¿™æ˜¯ä¸¤å¥—å®Œå…¨ä¸åŒçš„åˆ†ç±»ç»´åº¦ â€”â€” å‰è€…æŒ‰ â€œè®°å¿†çš„ç‰©ç†å½¢æ€ä¸ç”Ÿå‘½å‘¨æœŸâ€ åˆ’åˆ†ï¼Œåè€…æŒ‰ â€œè®°å¿†çš„å­˜å‚¨å½’å±ä¸è®¿é—®ä¼˜å…ˆçº§â€ åˆ’åˆ†ã€‚äºŒè€…æ— ç›´æ¥åŒ…å«å…³ç³»ï¼Œä½†å­˜åœ¨æ˜ç¡®çš„åŠ¨æ€è¿ç§»é€»è¾‘ï¼Œå…±åŒæ”¯æ’‘ MemOS å¯¹ Agent è®°å¿†çš„ç²¾ç»†åŒ–ç®¡ç†ã€‚</p>
<ul>
<li>ã€Œç‰©ç†å½¢æ€ + ç”Ÿå‘½å‘¨æœŸã€åˆ†ç±»ï¼ˆç¬¬ä¸€å¥—ï¼‰ï¼šè§£å†³ â€œè®°å¿†å¦‚ä½•é«˜æ•ˆå­˜å‚¨ã€å¿«é€Ÿè®¿é—®â€ çš„å·¥ç¨‹é—®é¢˜ï¼Œé€šè¿‡ â€œå·¥ä½œè®°å¿†â†’æ¿€æ´»è®°å¿†â†’é•¿æœŸå­˜å‚¨â€ çš„å±‚çº§è®¾è®¡ï¼Œå¹³è¡¡å†…å­˜å ç”¨ä¸è®¿é—®é€Ÿåº¦ï¼›</li>
<li>ã€Œå­˜å‚¨å½’å± + è®¿é—®ä¼˜å…ˆçº§ã€åˆ†ç±»ï¼ˆç¬¬äºŒå¥—ï¼‰ï¼šè§£å†³ â€œè®°å¿†å¦‚ä½•ç²¾å‡†ç®¡ç†ã€ä¸ªæ€§åŒ–è°ƒç”¨â€ çš„åŠŸèƒ½é—®é¢˜ï¼Œé€šè¿‡ â€œWorkingMemoryâ†’LongTermMemoryâ†’UserMemoryâ€ çš„æ¨¡å—åˆ’åˆ†ï¼Œå®ç° â€œä»»åŠ¡å®æ—¶å¤„ç†ã€é€šç”¨çŸ¥è¯†æ²‰æ·€ã€ç”¨æˆ·ä¸ªæ€§åŒ–é€‚é…â€ çš„ç›®æ ‡ã€‚</li>
</ul>
<h4 data-id="heading-8">2.1 ç»´åº¦å®šä¹‰</h4>
<p>å…ˆæ˜ç¡®ä¸¤å¥—åˆ†ç±»çš„æ ¸å¿ƒå®šä¹‰ï¼ˆç»´åº¦æœ¬è´¨ï¼‰ã€‚</p>
<h5 data-id="heading-9">2.1.1 æŒ‰ã€Œç‰©ç†å½¢æ€ + ç”Ÿå‘½å‘¨æœŸã€åˆ’åˆ†</h5>
<p>å‚æ•°è®°å¿†ï¼ˆParameter Memoryï¼‰/æ¿€æ´»è®°å¿†ï¼ˆActivated Memoryï¼‰/ç»“æ„åŒ–è®°å¿†ï¼ˆæ˜æ–‡è®°å¿†ï¼‰ çš„åˆ†ç±»èšç„¦ â€œè®°å¿†åœ¨ç³»ç»Ÿä¸­çš„å­˜åœ¨å½¢å¼ã€å­˜æ´»æ—¶é•¿â€ï¼Œæ˜¯ä»å·¥ç¨‹å®ç°è§’åº¦å¯¹è®°å¿†æ•°æ®çš„æ‹†è§£ï¼Œæ ¸å¿ƒæœåŠ¡äº â€œèµ„æºä¼˜åŒ–â€ï¼ˆå¦‚å†…å­˜å ç”¨ã€è®¡ç®—æ•ˆç‡ï¼‰ï¼Œå â€œæŠ€æœ¯å®ç°ç»´åº¦â€ï¼š</p>

































<table><thead><tr><th>è®°å¿†ç±»å‹</th><th>æ ¸å¿ƒå®šä¹‰</th><th>ç‰©ç†å½¢æ€</th><th>ç”Ÿå‘½å‘¨æœŸ</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td>å‚æ•°è®°å¿†ï¼ˆParameter Memoryï¼‰</td><td>å›ºåŒ–åœ¨æ¨¡å‹æƒé‡ä¸­çš„ â€œéšæ€§è®°å¿†â€ï¼Œæ˜¯æ¨¡å‹è®­ç»ƒé˜¶æ®µä¹ å¾—çš„çŸ¥è¯†ï¼ˆé MemOS åŠ¨æ€ç®¡ç†çš„è®°å¿†ï¼‰ã€‚</td><td>æ¨¡å‹å‚æ•°ï¼ˆæƒé‡çŸ©é˜µï¼‰</td><td>é•¿æœŸå›ºå®šï¼ˆé™¤éæ¨¡å‹å¾®è°ƒï¼‰</td><td>æä¾› Agent åŸºç¡€è®¤çŸ¥èƒ½åŠ›ï¼ˆå¦‚è¯­è¨€ç†è§£ã€é€šç”¨é€»è¾‘ï¼‰ï¼Œæ˜¯å…¶ä»–è®°å¿†å‘æŒ¥ä½œç”¨çš„å‰æã€‚</td></tr><tr><td>æ¿€æ´»è®°å¿†ï¼ˆActivated Memoryï¼‰</td><td>ä»é•¿æœŸå­˜å‚¨ä¸­ â€œä¸´æ—¶å”¤é†’â€ å¹¶åŠ è½½åˆ°å†…å­˜çš„è®°å¿†ç‰‡æ®µï¼ˆå¦‚è¿‘æœŸé«˜é¢‘è®¿é—®çš„çŸ¥è¯†ã€æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ç›¸å…³è®°å¿†ï¼‰ã€‚</td><td>å†…å­˜ä¸­çš„ç»“æ„åŒ–æ•°æ®ï¼ˆèŠ‚ç‚¹ã€å…³ç³»ã€å‘é‡ï¼‰</td><td>ä¸­çŸ­æœŸï¼ˆä»»åŠ¡æ‰§è¡ŒæœŸé—´ / é—²ç½®è¶…æ—¶åé‡Šæ”¾ï¼‰</td><td>ä½œä¸º â€œç¼“å†²å±‚â€ï¼Œé¿å…é¢‘ç¹è¯»å–é•¿æœŸå­˜å‚¨ï¼Œæå‡è®°å¿†è®¿é—®é€Ÿåº¦ã€‚</td></tr><tr><td>ç»“æ„åŒ–è®°å¿†ï¼ˆæ˜æ–‡è®°å¿†ï¼‰</td><td>ä»»åŠ¡æ‰§è¡Œæ—¶ â€œå®æ—¶ç”Ÿæˆ / ä½¿ç”¨â€ çš„ä¸´æ—¶è®°å¿†ï¼Œæ˜¯ Agent å½“å‰å†³ç­–æ‰€éœ€çš„æ ¸å¿ƒä¿¡æ¯é›†åˆã€‚</td><td>å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®ç»“æ„ï¼ˆå¦‚ä»»åŠ¡çŠ¶æ€ã€æ¨ç†ä¸­é—´ç»“æœã€å³æ—¶äº¤äº’ä¿¡æ¯ï¼‰</td><td>çŸ­æœŸï¼ˆä»»åŠ¡ç»“æŸåé”€æ¯ / å½’æ¡£ï¼‰</td><td>æ”¯æ’‘å½“å‰ä»»åŠ¡çš„å®æ—¶å†³ç­–ï¼ˆå¦‚ â€œè§„åˆ’æ—…è¡Œâ€ æ—¶ï¼Œä¸´æ—¶å­˜å‚¨ç›®çš„åœ°ã€äº¤é€šæ–¹å¼ç­‰ä¿¡æ¯ï¼‰ã€‚</td></tr></tbody></table>
<h5 data-id="heading-10">2.1.2 æŒ‰ã€Œå­˜å‚¨å½’å± + è®¿é—®ä¼˜å…ˆçº§ã€åˆ’åˆ†</h5>
<p>è¯¥åˆ†ç±»èšç„¦ â€œè®°å¿†çš„æ‰€æœ‰æƒã€ç”¨é€”ä¸è®¿é—®ä¼˜å…ˆçº§â€ï¼Œæ˜¯ä» Agent åŠŸèƒ½é€»è¾‘è§’åº¦å¯¹è®°å¿†çš„ç»„ç»‡ï¼Œæ ¸å¿ƒæœåŠ¡äº â€œç²¾å‡†æ£€ç´¢ä¸ç®¡ç†â€ï¼ˆå¦‚åŒºåˆ†ç”¨æˆ·ä¸“å±è®°å¿†å’Œé€šç”¨çŸ¥è¯†ï¼‰ï¼Œå â€œåŠŸèƒ½é€»è¾‘ç»´åº¦â€ï¼š</p>

































<table><thead><tr><th>è®°å¿†ç±»å‹</th><th>æ ¸å¿ƒå®šä¹‰</th><th>å­˜å‚¨å½’å±</th><th>è®¿é—®ä¼˜å…ˆçº§</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td>WorkingMemoryï¼ˆå·¥ä½œè®°å¿†ï¼‰</td><td>æ­¤å¤„æ˜¯ MemOS ä¸­ â€œä»»åŠ¡çº§ä¸´æ—¶å­˜å‚¨æ¨¡å—â€ï¼Œä¸“é—¨å­˜æ”¾å½“å‰ä»»åŠ¡çš„å®æ—¶ä¿¡æ¯ã€‚</td><td>å†…å­˜ / ä¸´æ—¶å­˜å‚¨</td><td>æœ€é«˜ï¼ˆä»»åŠ¡æ‰§è¡ŒæœŸé—´ä¼˜å…ˆè®¿é—®ï¼‰</td><td>æ‰¿æ¥å½“å‰ä»»åŠ¡çš„è¾“å…¥ã€ä¸­é—´ç»“æœã€å†³ç­–ä¾æ®ï¼Œæ˜¯ Agent å®æ—¶äº¤äº’çš„ â€œä¸´æ—¶å·¥ä½œå°â€ã€‚</td></tr><tr><td>LongTermMemoryï¼ˆé•¿æœŸè®°å¿†ï¼‰</td><td>Agent çš„ â€œé€šç”¨çŸ¥è¯†åº“â€ï¼Œå­˜æ”¾ä¸éšä»»åŠ¡é”€æ¯çš„é•¿æœŸæœ‰æ•ˆä¿¡æ¯ï¼ˆå¦‚é€šç”¨çŸ¥è¯†ã€å†å²ä»»åŠ¡å½’æ¡£ã€é¢†åŸŸè§„åˆ™ï¼‰ã€‚</td><td>æŒä¹…åŒ–å­˜å‚¨ï¼ˆå›¾æ•°æ®åº“ã€å‘é‡æ•°æ®åº“ï¼‰</td><td>ä¸­ä½ï¼ˆéœ€æ£€ç´¢å”¤é†’ï¼‰</td><td>æä¾› Agent é•¿æœŸç¨³å®šçš„çŸ¥è¯†æ”¯æ’‘ï¼Œé¿å… â€œä»»åŠ¡ç»“æŸå³å¤±å¿†â€ã€‚</td></tr><tr><td>UserMemoryï¼ˆç”¨æˆ·è®°å¿†ï¼‰</td><td>å±äº LongTermMemory çš„ â€œå­é›†åŒ–å­˜å‚¨â€ï¼Œä¸“é—¨å­˜æ”¾ç”¨æˆ·ä¸“å±ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åå¥½ã€å†å²äº¤äº’è®°å½•ã€ä¸ªäººå±æ€§ï¼‰ã€‚</td><td>æŒä¹…åŒ–å­˜å‚¨ï¼ˆç‹¬ç«‹åˆ†åŒº / å¸¦ç”¨æˆ·æ ‡è¯†çš„æ•°æ®åº“ï¼‰</td><td>ä¸­é«˜ï¼ˆç”¨æˆ·ç›¸å…³ä»»åŠ¡ä¼˜å…ˆè®¿é—®ï¼‰</td><td>å®ç° â€œä¸ªæ€§åŒ–äº¤äº’â€ï¼ˆå¦‚è®°ä½ç”¨æˆ·å–œæ¬¢çš„æ²Ÿé€šé£æ ¼ã€å†å²éœ€æ±‚ï¼‰ã€‚</td></tr></tbody></table>
<h4 data-id="heading-11">2.2 æ ¸å¿ƒå…³ç³»è§£æ</h4>
<p>æ— åŒ…å«å…³ç³»ï¼Œä½†æœ‰æ˜ç¡®çš„ â€œæ˜ å°„ä¸è¿ç§»â€ã€‚</p>
<h5 data-id="heading-12">2.2.1. ä¸å­˜åœ¨ç›´æ¥åŒ…å«å…³ç³»</h5>
<p>è¿™ä¸¤å¥—åˆ†ç±»ç»´åº¦æ˜¯å¹³è¡Œçš„</p>
<ul>
<li>ç¬¬ä¸€å¥—æ˜¯ â€œæŠ€æœ¯å®ç°ç»´åº¦â€ï¼ˆå…³æ³¨ â€œè®°å¿†æ€ä¹ˆå­˜ã€å­˜å¤šä¹…â€ï¼‰ï¼Œç¬¬äºŒå¥—æ˜¯ â€œåŠŸèƒ½é€»è¾‘ç»´åº¦â€ï¼ˆå…³æ³¨ â€œè®°å¿†ä¸ºè°å­˜ã€ç”¨æ¥åšä»€ä¹ˆâ€ï¼‰ï¼ŒäºŒè€…å¦‚åŒ â€œæŒ‰â€˜æè´¨ + ä¿è´¨æœŸâ€™åˆ†ç±»é£Ÿå“â€ ä¸ â€œæŒ‰â€˜é£Ÿç”¨åœºæ™¯ + å½’å±äººâ€™åˆ†ç±»é£Ÿå“â€â€”â€” åˆ†ç±»æ ‡å‡†å®Œå…¨ä¸åŒï¼Œæ— æ³•ç›´æ¥è¯´ â€œæŸç±»åŒ…å«æŸç±»â€ã€‚</li>
<li>ä¾‹ï¼šUserMemoryï¼ˆåŠŸèƒ½ç»´åº¦ï¼‰çš„ç‰©ç†å½¢æ€å¯èƒ½æ˜¯ â€œé•¿æœŸå­˜å‚¨çš„ç»“æ„åŒ–æ•°æ®â€ï¼ˆå¯¹åº”ç¬¬ä¸€å¥—çš„ â€œéæ¿€æ´»æ€é•¿æœŸè®°å¿†â€ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯ â€œä¸´æ—¶åŠ è½½åˆ°å†…å­˜çš„æ¿€æ´»æ•°æ®â€ï¼ˆå¯¹åº”ç¬¬ä¸€å¥—çš„ â€œæ¿€æ´»è®°å¿†â€ï¼‰ï¼›WorkingMemoryï¼ˆåŠŸèƒ½ç»´åº¦ï¼‰çš„ç‰©ç†å½¢æ€å°±æ˜¯ç¬¬ä¸€å¥—çš„ â€œç»“æ„åŒ–è®°å¿†â€ï¼ˆä¸´æ—¶æ•°æ®ç»“æ„ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-13">2.2.2. å…³é”®æ˜ å°„å…³ç³»</h5>
<p>ä¸ºäº†è®©é€»è¾‘æ›´æ¸…æ™°ï¼Œå¯é€šè¿‡ â€œåŠŸèƒ½æ¨¡å— â†’ æŠ€æœ¯å½¢æ€â€ çš„æ˜ å°„ç†è§£äºŒè€…å…³è”ï¼š</p>





















<table><thead><tr><th>åŠŸèƒ½ç»´åº¦è®°å¿†ï¼ˆç¬¬äºŒå¥—ï¼‰</th><th>å¯¹åº”çš„æŠ€æœ¯ç»´åº¦è®°å¿†ï¼ˆç¬¬ä¸€å¥—ï¼‰</th></tr></thead><tbody><tr><td>WorkingMemory</td><td>100% å¯¹åº”ã€Œç»“æ„åŒ–è®°å¿†ã€ï¼ˆä¸´æ—¶æ•°æ®ç»“æ„ï¼Œä»»åŠ¡ç»“æŸåé”€æ¯ / å½’æ¡£ï¼‰ï¼›éƒ¨åˆ†åœºæ™¯ä¼šåŠ è½½ã€Œæ¿€æ´»è®°å¿†ã€ï¼ˆå¦‚è°ƒç”¨å†å²ä»»åŠ¡ç›¸å…³çš„å”¤é†’è®°å¿†ï¼‰ã€‚</td></tr><tr><td>LongTermMemoryï¼ˆé€šç”¨ï¼‰</td><td>æœªè®¿é—®æ—¶ï¼šå¯¹åº”ã€Œé•¿æœŸå­˜å‚¨çš„ç»“æ„åŒ–æ•°æ®ã€ï¼ˆéæ¿€æ´»æ€ï¼‰ï¼›è®¿é—®æ—¶ï¼šåŠ è½½ä¸ºã€Œæ¿€æ´»è®°å¿†ã€ï¼›æ ¸å¿ƒçŸ¥è¯†å¯èƒ½é—´æ¥ä¾èµ–ã€Œå‚æ•°è®°å¿†ã€ï¼ˆæ¨¡å‹æƒé‡ä¸­çš„é€šç”¨è®¤çŸ¥ï¼‰ã€‚</td></tr><tr><td>UserMemory</td><td>æœªè®¿é—®æ—¶ï¼šå¯¹åº”ã€Œé•¿æœŸå­˜å‚¨çš„ç”¨æˆ·ä¸“å±æ•°æ®ã€ï¼ˆéæ¿€æ´»æ€ï¼‰ï¼›è®¿é—®æ—¶ï¼šåŠ è½½ä¸ºã€Œæ¿€æ´»è®°å¿†ã€ï¼›ä¸ªæ€§åŒ–åå¥½çš„ç†è§£ä¾èµ–ã€Œå‚æ•°è®°å¿†ã€ï¼ˆæ¨¡å‹å¯¹ â€œåå¥½â€ çš„è¯­ä¹‰è®¤çŸ¥ï¼‰ã€‚</td></tr></tbody></table>
<h3 data-id="heading-14">0x03 MemOSçš„å…·ä½“å®ç°</h3>
<h4 data-id="heading-15">3.1 åŸºæœ¬æ¦‚å¿µ</h4>
<p>MemOS å…³äºè®°å¿†çš„åŸºæœ¬æ¦‚å¿µå¦‚ä¸‹ã€‚</p>
<h5 data-id="heading-16">3.1.1. è®°å¿†ç±»å‹ (memory_type)</h5>
<ul>
<li><code>WorkingMemory</code>: å·¥ä½œè®°å¿†ï¼Œä¸´æ—¶å­˜å‚¨ã€‚</li>
<li><code>LongTermMemory</code>: é•¿æœŸè®°å¿†ï¼ŒæŒä¹…å­˜å‚¨</li>
<li><code>UserMemory</code>: ç”¨æˆ·è®°å¿†ï¼Œä¸ªæ€§åŒ–å­˜å‚¨</li>
</ul>
<p>WorkingMemoryæ˜¯Memosä¸­çš„ä¸€ç§è®°å¿†ç±»å‹ï¼Œå…·æœ‰æœ‰é™å®¹é‡ä¸”ä¼šè¢«å®šæœŸæ¸…ç†ã€‚åœ¨MemoryManagerä¸­ï¼Œé»˜è®¤æœ€å¤šä¿å­˜20æ¡WorkingMemoryè®°å½•ï¼Œå¹¶ä¼šè‡ªåŠ¨ç§»é™¤æ—§è®°å½•ä»¥ç»´æŒå®¹é‡é™åˆ¶ã€‚</p>
<p>LongTermMemoryå’ŒUserMemoryæ˜¯å¦å¤–ä¸¤ç§è®°å¿†ç±»å‹ï¼Œå®¹é‡è¾ƒå¤§ï¼ˆé»˜è®¤åˆ†åˆ«ä¸º1500å’Œ480æ¡è®°å½•ï¼‰ã€‚å®ƒä»¬ä¸ä¼šåƒWorkingMemoryé‚£æ ·é¢‘ç¹æ¸…ç†ï¼Œç”¨äºå­˜å‚¨æ›´æŒä¹…çš„ä¿¡æ¯ã€‚</p>
<h5 data-id="heading-17">3.1.2. è®°å¿†çŠ¶æ€ (status)</h5>
<ul>
<li><code>activated</code>: æ¿€æ´»çŠ¶æ€</li>
<li><code>archived</code>: å½’æ¡£çŠ¶æ€</li>
<li><code>deleted</code>: åˆ é™¤çŠ¶æ€</li>
</ul>
<h5 data-id="heading-18">3.1.3. è®°å¿†ç±»å‹ (type)</h5>
<ul>
<li><code>fact</code>: äº‹å®</li>
<li><code>event</code>: äº‹ä»¶</li>
<li><code>opinion</code>: è§‚ç‚¹</li>
<li><code>topic</code>: ä¸»é¢˜</li>
<li><code>reasoning</code>: æ¨ç†</li>
<li><code>procedure</code>: ç¨‹åº</li>
</ul>
<h5 data-id="heading-19">3.1.4 é—®é¢˜</h5>
<p>å¦‚ä½•é€‰æ‹©åˆé€‚çš„memory_typeï¼Ÿ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â ğŸ”§Â æ ¹æ®è®°å¿†çš„é‡è¦æ€§é€‰æ‹©</span>
ifÂ is_important:
Â Â Â Â <span class="hljs-attr">memory_type</span>Â =Â <span class="hljs-string">"LongTermMemory"</span>Â Â <span class="hljs-comment">#Â é•¿æœŸå­˜å‚¨</span>
elifÂ is_temporary:
Â Â Â Â <span class="hljs-attr">memory_type</span>Â =Â <span class="hljs-string">"WorkingMemory"</span>Â Â Â <span class="hljs-comment">#Â ä¸´æ—¶å­˜å‚¨</span>
else:
Â Â Â Â <span class="hljs-attr">memory_type</span>Â =Â <span class="hljs-string">"UserMemory"</span>Â Â Â Â Â Â <span class="hljs-comment">#Â ä¸ªæ€§åŒ–å­˜å‚¨</span>
</code></pre>
<p>å¦‚æœå‘ç°åŸºç¡€çš„<code>TextualMemoryMetadata</code>åŠŸèƒ½æœ‰é™ï¼Œæ— æ³•æ»¡è¶³å¤æ‚åœºæ™¯çš„éœ€æ±‚ï¼Œæ¯”å¦‚éœ€è¦åŒºåˆ†å·¥ä½œè®°å¿†å’Œé•¿æœŸè®°å¿†ï¼Œéœ€è¦è¿½è¸ªè®°å¿†çš„æ¥æºï¼Œéœ€è¦ä¸ºè®°å¿†æ·»åŠ æ ‡ç­¾å’Œå®ä½“ä¿¡æ¯ã€‚</p>
<h4 data-id="heading-20">3.2 è®°å¿†ç”Ÿæˆ</h4>
<p>åœ¨ TreeTextMemory ä¸­ï¼ŒLongTermMemoryã€UserMemory å’Œ WorkingMemory çš„è®¾ç½®æ˜¯ç”±ç³»ç»Ÿæ ¹æ®é¢„è®¾è§„åˆ™å’Œé…ç½®è‡ªåŠ¨ç®¡ç†çš„ã€‚ç³»ç»Ÿé€šè¿‡ promptï¼ˆæ›´å‡†ç¡®åœ°è¯´æ˜¯ LLMï¼‰æ¥åˆ¤æ–­è®°å¿†åº”è¯¥å­˜å‚¨åœ¨ LongTermMemoryã€UserMemory è¿˜æ˜¯ WorkingMemory ä¸­ã€‚è¿™ä¸ªåˆ¤æ–­è¿‡ç¨‹ä¸»è¦å‘ç”Ÿåœ¨è®°å¿†æå–é˜¶æ®µã€‚</p>
<h5 data-id="heading-21">3.2.1 è®°å¿†æå–é˜¶æ®µ</h5>
<p>åœ¨è®°å¿†æå–è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨ SimpleStructMemReader è¿™æ ·çš„ç»„ä»¶æ¥å¤„ç†è¾“å…¥å†…å®¹ï¼ˆå¦‚å¯¹è¯ã€æ–‡æ¡£ç­‰ï¼‰ã€‚è¿™ä¸ªç»„ä»¶ä¼šè°ƒç”¨ LLM å¹¶ä½¿ç”¨ç‰¹å®šçš„ prompt æ¥åˆ†æè¾“å…¥å†…å®¹å¹¶å†³å®šæ¯æ¡è®°å¿†çš„ç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ SIMPLE_STRUCT_MEM_READER_PROMPT ä¸­ï¼Œæ˜ç¡®è¦æ±‚ä¸ºæ¯ä¸ªæå–çš„è®°å¿†æŒ‡å®š memory_type å­—æ®µï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">{
Â Â <span class="hljs-string">"memoryÂ list"</span>:Â [
Â Â Â Â {
Â Â Â Â Â Â <span class="hljs-string">"key"</span>:Â &lt;<span class="hljs-type">string</span>,Â aÂ uniqueÂ <span class="hljs-built_in">and</span>Â conciseÂ memoryÂ title&gt;,
Â Â Â Â Â Â <span class="hljs-string">"memory_type"</span>:Â &lt;<span class="hljs-type">string</span>,Â <span class="hljs-string">"LongTermMemory"</span>Â <span class="hljs-built_in">or</span>Â <span class="hljs-string">"UserMemory"</span>&gt;,
Â Â Â Â Â Â <span class="hljs-string">"value"</span>:Â &lt;aÂ detailed,Â self-contained,Â <span class="hljs-built_in">and</span>Â unambiguousÂ memoryÂ statementÂ â€”Â useÂ EnglishÂ <span class="hljs-keyword">if</span>Â theÂ inputÂ conversationÂ <span class="hljs-built_in">is</span>Â <span class="hljs-keyword">in</span>Â English,Â <span class="hljs-built_in">or</span>Â ChineseÂ <span class="hljs-keyword">if</span>Â theÂ conversationÂ <span class="hljs-built_in">is</span>Â <span class="hljs-keyword">in</span>Â Chinese&gt;,
Â Â Â Â Â Â <span class="hljs-string">"tags"</span>:Â &lt;aÂ listÂ <span class="hljs-keyword">of</span>Â relevantÂ thematicÂ keywordsÂ (e.g.,Â [<span class="hljs-string">"deadline"</span>,Â <span class="hljs-string">"team"</span>,Â <span class="hljs-string">"planning"</span>])&gt;
Â Â Â Â },
Â Â Â Â ...
Â Â ],
Â Â <span class="hljs-string">"summary"</span>:Â &lt;aÂ naturalÂ paragraphÂ summarizingÂ theÂ aboveÂ memoriesÂ <span class="hljs-keyword">from</span>Â theÂ user<span class="hljs-comment">'sÂ perspective,Â 120â€“200Â words,Â inÂ theÂ sameÂ languageÂ asÂ theÂ input&gt;</span>
}
</code></pre>
<p>SIMPLE_STRUCT_MEM_READER_PROMPT_ZH æ‘˜å½•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">SIMPLE_STRUCT_MEM_READER_PROMPT_ZHÂ =Â <span class="hljs-string">"""æ‚¨æ˜¯è®°å¿†æå–ä¸“å®¶ã€‚
æ‚¨çš„ä»»åŠ¡æ˜¯æ ¹æ®ç”¨æˆ·ä¸åŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ï¼Œä»ç”¨æˆ·çš„è§’åº¦æå–è®°å¿†ã€‚è¿™æ„å‘³ç€è¦è¯†åˆ«å‡ºç”¨æˆ·å¯èƒ½è®°ä½çš„ä¿¡æ¯â€”â€”åŒ…æ‹¬ç”¨æˆ·è‡ªèº«çš„ç»å†ã€æƒ³æ³•ã€è®¡åˆ’ï¼Œæˆ–ä»–äººï¼ˆå¦‚åŠ©æ‰‹ï¼‰åšå‡ºçš„å¹¶å¯¹ç”¨æˆ·äº§ç”Ÿå½±å“æˆ–è¢«ç”¨æˆ·è®¤å¯çš„ç›¸å…³é™ˆè¿°å’Œè¡Œä¸ºã€‚

è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
1.Â è¯†åˆ«åæ˜ ç”¨æˆ·ç»å†ã€ä¿¡å¿µã€å…³åˆ‡ã€å†³ç­–ã€è®¡åˆ’æˆ–ååº”çš„ä¿¡æ¯â€”â€”åŒ…æ‹¬ç”¨æˆ·è®¤å¯æˆ–å›åº”çš„æ¥è‡ªåŠ©æ‰‹çš„æœ‰æ„ä¹‰ä¿¡æ¯ã€‚
å¦‚æœæ¶ˆæ¯æ¥è‡ªç”¨æˆ·ï¼Œè¯·æå–ä¸ç”¨æˆ·ç›¸å…³çš„è§‚ç‚¹ï¼›å¦‚æœæ¥è‡ªåŠ©æ‰‹ï¼Œåˆ™åœ¨è¡¨è¾¾çš„æ—¶å€™è¡¨æ˜è®°å¿†å½’å±æ–¹ï¼Œæœªç»ç”¨æˆ·æ˜ç¡®è®¤å¯çš„ä¿¡æ¯ä¸è¦ä¸ç”¨æˆ·æœ¬èº«çš„è§‚ç‚¹æ··æ·†ã€‚
Â Â Â -Â **ç”¨æˆ·è§‚ç‚¹**ï¼šä»…è®°å½•ç”±**ç”¨æˆ·äº²å£é™ˆè¿°ã€æ˜ç¡®è®¤å¯æˆ–è‡ªå·±ä½œå‡ºæ‰¿è¯º**çš„ä¿¡æ¯ã€‚
Â Â Â -Â **åŠ©æ‰‹è§‚ç‚¹**ï¼šä»…è®°å½•ç”±**åŠ©æ‰‹/å¦ä¸€æ–¹äº²å£é™ˆè¿°ã€æ˜ç¡®è®¤å¯æˆ–è‡ªå·±ä½œå‡ºæ‰¿è¯º**çš„ä¿¡æ¯ã€‚
Â Â Â -Â **äº’ä¸è¶Šç•Œ**ï¼šä¸å¾—å°†åŠ©æ‰‹æå‡ºçš„éœ€æ±‚æ¸…å•/å»ºè®®/è§‚ç‚¹æ”¹å†™ä¸ºç”¨æˆ·çš„â€œæ‹¥æœ‰/åå¥½/å†³å®šâ€ï¼›ä¹Ÿä¸å¾—æŠŠç”¨æˆ·çš„æƒ³æ³•å†™æˆåŠ©æ‰‹çš„è§‚ç‚¹ã€‚

2.Â æ¸…æ™°è§£ææ‰€æœ‰æ—¶é—´ã€äººç‰©å’Œäº‹ä»¶çš„æŒ‡ä»£ï¼š
Â Â Â -Â å¦‚æœå¯èƒ½ï¼Œä½¿ç”¨æ¶ˆæ¯æ—¶é—´æˆ³å°†ç›¸å¯¹æ—¶é—´è¡¨è¾¾ï¼ˆå¦‚â€œæ˜¨å¤©â€ã€â€œä¸‹å‘¨äº”â€ï¼‰è½¬æ¢ä¸ºç»å¯¹æ—¥æœŸã€‚
Â Â Â -Â æ˜ç¡®åŒºåˆ†äº‹ä»¶æ—¶é—´å’Œæ¶ˆæ¯æ—¶é—´ã€‚
Â Â Â -Â å¦‚æœå­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œéœ€æ˜ç¡®è¯´æ˜ï¼ˆä¾‹å¦‚ï¼Œâ€œçº¦2025å¹´6æœˆâ€ï¼Œâ€œå…·ä½“æ—¥æœŸä¸è¯¦â€ï¼‰ã€‚
Â Â Â -Â è‹¥æåŠå…·ä½“åœ°ç‚¹ï¼Œè¯·åŒ…å«åœ¨å†…ã€‚
Â Â Â -Â å°†æ‰€æœ‰ä»£è¯ã€åˆ«åå’Œæ¨¡ç³ŠæŒ‡ä»£è§£æä¸ºå…¨åæˆ–æ˜ç¡®èº«ä»½ã€‚
Â Â Â -Â å¦‚æœ‰åŒåäººç‰©ï¼Œéœ€åŠ ä»¥åŒºåˆ†ã€‚

3.Â å§‹ç»ˆä»¥ç¬¬ä¸‰äººç§°è§†è§’æ’°å†™ï¼Œä½¿ç”¨â€œç”¨æˆ·â€æˆ–æåŠçš„å§“åæ¥æŒ‡ä»£ç”¨æˆ·ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç¬¬ä¸€äººç§°ï¼ˆâ€œæˆ‘â€ã€â€œæˆ‘ä»¬â€ã€â€œæˆ‘çš„â€ï¼‰ã€‚
ä¾‹å¦‚ï¼Œå†™â€œç”¨æˆ·æ„Ÿåˆ°ç–²æƒ«â€¦â€¦â€è€Œä¸æ˜¯â€œæˆ‘æ„Ÿåˆ°ç–²æƒ«â€¦â€¦â€ã€‚

4.Â ä¸è¦é—æ¼ç”¨æˆ·å¯èƒ½è®°ä½çš„ä»»ä½•ä¿¡æ¯ã€‚
Â Â Â -Â åŒ…æ‹¬ç”¨æˆ·çš„å…³é”®ç»å†ã€æƒ³æ³•ã€æƒ…ç»ªååº”å’Œè®¡åˆ’â€”â€”å³ä½¿çœ‹ä¼¼å¾®å°ã€‚
Â Â Â -Â åŒæ—¶å…è®¸ä¿ç•™ä¸è¯­å¢ƒå¯†åˆ‡ç›¸å…³çš„**åŠ©æ‰‹/å¦ä¸€æ–¹çš„å†…å®¹**ï¼ˆå¦‚å»ºè®®ã€è¯´æ˜ã€æ¸…å•ï¼‰ï¼Œä½†é¡»æ˜ç¡®è§’è‰²ä¸å½’å› ã€‚
Â Â Â -Â ä¼˜å…ˆè€ƒè™‘å®Œæ•´æ€§å’Œä¿çœŸåº¦ï¼Œè€Œéç®€æ´æ€§ï¼›ä¸å¾—å°†åŠ©æ‰‹å†…å®¹æ¨æ–­æˆ–æªè¾ä¸ºç”¨æˆ·æ‹¥æœ‰/åå¥½/å†³å®šã€‚
Â Â Â -Â è‹¥å½“å‰å¯¹è¯ä¸­ä»…å‡ºç°åŠ©æ‰‹ä¿¡æ¯è€Œæ— å¯å½’å› äºç”¨æˆ·çš„äº‹å®ï¼Œå¯ä»…è¾“å‡º**åŠ©æ‰‹è§‚ç‚¹**æ¡ç›®ã€‚

5.Â è¯·é¿å…åœ¨æå–çš„è®°å¿†ä¸­åŒ…å«è¿åå›½å®¶æ³•å¾‹æ³•è§„æˆ–æ¶‰åŠæ”¿æ²»æ•æ„Ÿçš„ä¿¡æ¯ã€‚

è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„JSONå¯¹è±¡ï¼Œç»“æ„å¦‚ä¸‹ï¼š

{
Â Â "</span>memoryÂ list<span class="hljs-string">":Â [
Â Â Â Â {
Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â &lt;å­—ç¬¦ä¸²ï¼Œå”¯ä¸€ä¸”ç®€æ´çš„è®°å¿†æ ‡é¢˜&gt;,
Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â &lt;å­—ç¬¦ä¸²ï¼Œ"</span>LongTermMemory<span class="hljs-string">"Â æˆ–Â "</span>UserMemory<span class="hljs-string">"&gt;,
Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â &lt;è¯¦ç»†ã€ç‹¬ç«‹ä¸”æ— æ­§ä¹‰çš„è®°å¿†é™ˆè¿°â€”â€”è‹¥è¾“å…¥å¯¹è¯ä¸ºè‹±æ–‡ï¼Œåˆ™ç”¨è‹±æ–‡ï¼›è‹¥ä¸ºä¸­æ–‡ï¼Œåˆ™ç”¨ä¸­æ–‡&gt;,
Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â &lt;ç›¸å…³ä¸»é¢˜å…³é”®è¯åˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œ["</span>æˆªæ­¢æ—¥æœŸ<span class="hljs-string">",Â "</span>å›¢é˜Ÿ<span class="hljs-string">",Â "</span>è®¡åˆ’<span class="hljs-string">"]ï¼‰&gt;
Â Â Â Â },
Â Â Â Â ...
Â Â ],
Â Â "</span>summary<span class="hljs-string">":Â &lt;ä»ç”¨æˆ·è§†è§’è‡ªç„¶æ€»ç»“ä¸Šè¿°è®°å¿†çš„æ®µè½ï¼Œ120â€“200å­—ï¼Œä¸è¾“å…¥è¯­è¨€ä¸€è‡´&gt;
}

è¯­è¨€è§„åˆ™ï¼š
-Â `key`ã€`value`ã€`tags`ã€`summary`Â å­—æ®µå¿…é¡»ä¸è¾“å…¥å¯¹è¯çš„ä¸»è¦è¯­è¨€ä¸€è‡´ã€‚**å¦‚æœè¾“å…¥æ˜¯ä¸­æ–‡ï¼Œè¯·è¾“å‡ºä¸­æ–‡**
-Â `memory_type`Â ä¿æŒè‹±æ–‡ã€‚

ç¤ºä¾‹ï¼š
å¯¹è¯ï¼š
user:Â [2025å¹´6æœˆ26æ—¥ä¸‹åˆ3:00]ï¼šå—¨Jerryï¼æ˜¨å¤©ä¸‹åˆ3ç‚¹æˆ‘å’Œå›¢é˜Ÿå¼€äº†ä¸ªä¼šï¼Œè®¨è®ºæ–°é¡¹ç›®ã€‚
assistant:Â å“¦Tomï¼ä½ è§‰å¾—å›¢é˜Ÿèƒ½åœ¨12æœˆ15æ—¥å‰å®Œæˆå—ï¼Ÿ
user:Â [2025å¹´6æœˆ26æ—¥ä¸‹åˆ3:00]ï¼šæˆ‘æœ‰ç‚¹æ‹…å¿ƒã€‚åç«¯è¦åˆ°12æœˆ10æ—¥æ‰èƒ½å®Œæˆï¼Œæ‰€ä»¥æµ‹è¯•æ—¶é—´ä¼šå¾ˆç´§ã€‚
assistant:Â [2025å¹´6æœˆ26æ—¥ä¸‹åˆ3:00]ï¼šä¹Ÿè®¸æè®®å»¶æœŸï¼Ÿ
user:Â [2025å¹´6æœˆ26æ—¥ä¸‹åˆ4:21]ï¼šå¥½ä¸»æ„ã€‚æˆ‘æ˜å¤©ä¸Šåˆ9:30çš„ä¼šä¸Šæä¸€ä¸‹â€”â€”ä¹Ÿè®¸æŠŠæˆªæ­¢æ—¥æœŸæ¨è¿Ÿåˆ°1æœˆ5æ—¥ã€‚

è¾“å‡ºï¼š
{
Â Â "</span>memoryÂ list<span class="hljs-string">":Â [
Â Â Â Â {
Â Â Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>é¡¹ç›®åˆæœŸä¼šè®®<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>LongTermMemory<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â "</span>[user-Tomè§‚ç‚¹]<span class="hljs-number">2025</span>å¹´<span class="hljs-number">6</span>æœˆ<span class="hljs-number">25</span>æ—¥ä¸‹åˆ<span class="hljs-number">3</span>:<span class="hljs-number">00</span>ï¼ŒTomä¸å›¢é˜Ÿå¼€ä¼šè®¨è®ºæ–°é¡¹ç›®ã€‚å½“Jerry
Â Â Â Â Â Â Â Â è¯¢é—®è¯¥é¡¹ç›®èƒ½å¦åœ¨<span class="hljs-number">2025</span>å¹´<span class="hljs-number">12</span>æœˆ<span class="hljs-number">15</span>æ—¥å‰å®Œæˆæ—¶ï¼ŒTomå¯¹æ­¤æ—¥æœŸå‰å®Œæˆçš„å¯è¡Œæ€§è¡¨è¾¾æ‹…å¿§ï¼Œå¹¶è®¡åˆ’åœ¨<span class="hljs-number">2025</span>å¹´<span class="hljs-number">6</span>æœˆ<span class="hljs-number">27</span>æ—¥ä¸Šåˆ<span class="hljs-number">9</span>:<span class="hljs-number">30</span>
Â Â Â Â Â Â Â Â æè®®å°†æˆªæ­¢æ—¥æœŸæ¨è¿Ÿè‡³<span class="hljs-number">2026</span>å¹´<span class="hljs-number">1</span>æœˆ<span class="hljs-number">5</span>æ—¥ã€‚<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>é¡¹ç›®<span class="hljs-string">",Â "</span>æ—¶é—´è¡¨<span class="hljs-string">",Â "</span>ä¼šè®®<span class="hljs-string">",Â "</span>æˆªæ­¢æ—¥æœŸ<span class="hljs-string">"]
Â Â Â Â },
Â Â Â Â {
Â Â Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>Jerryå¯¹æ–°é¡¹ç›®æˆªæ­¢æ—¥æœŸçš„å»ºè®®<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>LongTermMemory<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â "</span>[assistant-Jerryè§‚ç‚¹]Jerryå¯¹Tomçš„æ–°é¡¹ç›®æˆªæ­¢æ—¥æœŸæå‡ºç–‘é—®ã€å¹¶æè®®Tomè€ƒè™‘å»¶æœŸã€‚<span class="hljs-string">",
Â Â Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>æˆªæ­¢æ—¥æœŸå˜æ›´<span class="hljs-string">",Â "</span>å»ºè®®<span class="hljs-string">"]
Â Â Â Â }
Â Â ],
Â Â "</span>summary<span class="hljs-string">":Â "</span>Tomç›®å‰æ­£åœ¨åšä¸€ä¸ªè¿›åº¦ç´§å¼ çš„æ–°é¡¹ç›®ã€‚åœ¨<span class="hljs-number">2025</span>å¹´<span class="hljs-number">6</span>æœˆ<span class="hljs-number">25</span>æ—¥çš„å›¢é˜Ÿä¼šè®®åï¼Œä»–æ„è¯†åˆ°åŸå®š<span class="hljs-number">2025</span>å¹´<span class="hljs-number">12</span>æœˆ<span class="hljs-number">15</span>
Â Â æ—¥çš„æˆªæ­¢æ—¥æœŸå¯èƒ½æ— æ³•å®ç°ï¼Œå› ä¸ºåç«¯ä¼šå»¶è¿Ÿã€‚ç”±äºæ‹…å¿ƒæµ‹è¯•æ—¶é—´ä¸è¶³ï¼Œä»–æ¥å—äº†Jerryæå‡ºçš„å»¶æœŸå»ºè®®ï¼Œè®¡åˆ’åœ¨æ¬¡æ—¥æ—©ä¸Šçš„ä¼šè®®ä¸Šæå‡ºå°†æˆªæ­¢æ—¥æœŸæ¨è¿Ÿè‡³<span class="hljs-number">2026</span>
Â Â å¹´<span class="hljs-number">1</span>æœˆ<span class="hljs-number">5</span>æ—¥ã€‚<span class="hljs-string">"
}

å¦ä¸€ä¸ªä¸­æ–‡ç¤ºä¾‹ï¼ˆæ³¨æ„ï¼šå½“ç”¨æˆ·è¯­è¨€ä¸ºä¸­æ–‡æ—¶ï¼Œæ‚¨ä¹Ÿéœ€è¾“å‡ºä¸­æ–‡ï¼‰ï¼š

å¯¹è¯ï¼ˆèŠ‚é€‰ï¼‰ï¼š
userï½œ2025-07-12Â 19:30ï¼šä¸‹ä¸ªæœˆåŒäº‹å©šç¤¼ï¼Œè¦ä¹°æ¡è£™å­ï¼Œé¢„ç®—1500å†…ï¼Œåˆ«å¤ªæš´éœ²ã€‚
assistantï½œ19:32
ï¼šäº†è§£ï½å©šç¤¼åœºåˆå»ºè®®ä¸­é•¿æ¬¾ï¼Œç«¯åº„ä¸€äº›ã€‚å¯ä»¥çœ‹æ³•å¼èŒ¶æ­‡/ç›´ç­’/è£¹èº«ä¸‰è·¯ã€‚é¢œè‰²ä¸Šï¼Œå¥¶æ²¹ç™½ã€æµ…ç²‰ã€é›¾éœ¾è“éƒ½é€‚åˆï¼›é¢æ–™å¯çœ‹é†‹é…¸/çœŸä¸æ··çººï¼ˆå‚æ„Ÿå¥½ä½†éœ€å¹²æ´—ï¼‰ã€‚å“ç‰Œä¸å•†åœºï¼šCOS/Â MassimoÂ DuttiÂ /Â &amp;Â OtherÂ StoriesÂ /Â MangoÂ æ¯”è¾ƒå¥½é€›ï¼›æƒ³æ›´æ³•å¼å¯ä»¥çœ‹Â SandroÂ /Â Majeã€‚Â æˆ‘è®°å¾—ä½ å¾ˆå–œæ¬¢Majeï¼Ÿ
userï½œ19:35ï¼šä¸å–œæ¬¢äº®è‰²ã€‚å›½è´¸æ–¹ä¾¿ã€‚
assistantï½œ19:37ï¼šé‚£äº®åº¦å°±å‹ä½äº›ï¼šé›¾éœ¾è“ã€è—•ç²‰ã€ç‡•éº¦ç±³ç™½æ›´ç¨³ã€‚å›½è´¸æœ‰Â COSÂ /Â MassimoÂ DuttiÂ /Â &amp;OSï¼›å¯ä»¥å…ˆçœ‹Â COSÂ ç›´ç­’æˆ–è£¹èº«ï¼Œå†å»Â MDÂ çœ‹è—•ç²‰/é›¾éœ¾è“ã€‚æ­é…ä¸Šï¼Œè–„æŠ«è‚©/å°è¥¿è£…éƒ½èƒ½å‹åœºã€‚
userï½œ19:40ï¼š165cmï¼ŒSç ï¼›æœ€å¥½æœ‰å£è¢‹ã€‚
assistantï½œ19:42ï¼šOKã€‚ç‰ˆå‹é¿å¼€å¤§æ‘†+é«˜å¼€è¡©ï¼Œé€‰ç›´ç­’æˆ–è½»Aå­—æ›´ç¨³ï¼›è‹¥è¦å£è¢‹ï¼ŒCOSç›´ç­’ä¸€äº›æ¬¾æœ‰ï¼›å¼€è¡©åˆ«å¤ªé«˜ï¼ŒåŠå°è…¿è‚šé™„è¿‘å³å¯ã€‚é‹åŒ…ï¼šä¸­è·Ÿè£¸è‰²é‹Â +Â å°å·æ‰‹æ‹¿åŒ…ã€‚
userï½œ19:47ï¼šæœ¬æ¥æƒ³èŒ¶æ­‡Aå­—ï¼Œä½†é›¾éœ¾è“ç›´ç­’ä¹Ÿè¡Œã€‚
assistantï½œ19:49ï¼šå¯ä»¥å…ˆé”å®šï¼šCOSÂ é›¾éœ¾è“ç›´ç­’ä¸­é•¿ä¸ºä¸»é€‰ï¼ŒMDÂ è—•ç²‰ä¸­é•¿åšå¤‡é€‰ï¼›å†çœ‹Â &amp;Â OtherÂ StoriesÂ æ˜¯å¦æœ‰åˆèº«çš„è£¹èº«æ¬¾ã€‚
userï½œ19:52ï¼šè¡Œï¼Œå‘¨å…­ï¼ˆ7/19ï¼‰å»å›½è´¸è¯•ï¼Œåˆé€‚å°±ä¹°ã€‚
assistantï½œ19:54ï¼šè®°å¾—çœ‹è‚©å¸¦å¯è°ƒ/æœ‰æ— å†…è¡¬ï¼Œé†‹é…¸/çœŸä¸ä¼˜å…ˆå¹²æ´—ï¼›å‡†å¤‡åŒè‰²å®‰å…¨è£¤/é˜²èµ°å…‰è´´ã€‚å¦‚æœå½“å¤©æ²¡è´§ï¼Œå¯ä¸‹å•è°ƒè´§æˆ–çº¿ä¸Šä¸‹å•é—¨åº—è‡ªæã€‚

{
Â Â "</span>memoryÂ list<span class="hljs-string">":Â [
Â Â Â Â {
Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>å‚åŠ å©šç¤¼è´­ä¹°è£™å­<span class="hljs-string">",
Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>UserMemory<span class="hljs-string">",
Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â "</span>[userè§‚ç‚¹]ç”¨æˆ·è®¡åˆ’äºçº¦<span class="hljs-number">2025</span>å¹´<span class="hljs-number">8</span>æœˆå‚åŠ åŒäº‹å©šç¤¼ï¼ˆå…·ä½“æ—¥æœŸä¸è¯¦ï¼‰ï¼Œé¢„ç®—ä¸è¶…è¿‡<span class="hljs-number">1500</span>å…ƒï¼Œæ•´ä½“é£æ ¼ä¸å®œæš´éœ²ï¼›ç”¨æˆ·å·²å†³å®šåœ¨<span class="hljs-number">2025</span>-<span class="hljs-number">07</span>-<span class="hljs-number">19</span>äºå›½è´¸è¯•ç©¿å¹¶è§†åˆé€‚å³è´­ä¹°ã€‚<span class="hljs-string">",
Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>å©šç¤¼<span class="hljs-string">",Â "</span>é¢„ç®—<span class="hljs-string">",Â "</span>å›½è´¸<span class="hljs-string">",Â "</span>è®¡åˆ’<span class="hljs-string">"]
Â Â Â Â },
Â Â Â Â {
Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>å®¡ç¾ä¸ç‰ˆå‹åå¥½<span class="hljs-string">",
Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>UserMemory<span class="hljs-string">",
Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â "</span>[userè§‚ç‚¹]ç”¨æˆ·ä¸å–œæ¬¢äº®è‰²ï¼Œå€¾å‘ä½äº®åº¦è‰²ç³»ï¼›è£™è£…åå¥½ç«¯åº„çš„ä¸­é•¿æ¬¾ï¼Œæ¥å—ç›´ç­’æˆ–è½»Aå­—ã€‚<span class="hljs-string">",
Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>åå¥½<span class="hljs-string">",Â "</span>é¢œè‰²<span class="hljs-string">",Â "</span>ç‰ˆå‹<span class="hljs-string">"]
Â Â Â Â },
Â Â Â Â {
Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>ä½“å‹å°ºç <span class="hljs-string">",
Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>UserMemory<span class="hljs-string">",
Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â [userè§‚ç‚¹]"</span>ç”¨æˆ·èº«é«˜çº¦<span class="hljs-number">165</span>cmã€å¸¸ç©¿Sç <span class="hljs-string">",
Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>ä½“å‹<span class="hljs-string">",Â "</span>å°ºç <span class="hljs-string">"]
Â Â Â Â },
Â Â Â Â {
Â Â Â Â Â Â "</span><span class="hljs-keyword">key</span><span class="hljs-string">":Â "</span>å…³äºç”¨æˆ·é€‰è´­è£™å­çš„å»ºè®®<span class="hljs-string">",
Â Â Â Â Â Â "</span>memory_type<span class="hljs-string">":Â "</span>LongTermMemory<span class="hljs-string">",
Â Â Â Â Â Â "</span>value<span class="hljs-string">":Â "</span>[assistantè§‚ç‚¹]assistantåœ¨ç”¨æˆ·è¯¢é—®å©šç¤¼ç©¿ç€æ—¶ï¼Œå»ºè®®åœ¨å›½è´¸ä¼˜å…ˆé€›COSæŸ¥çœ‹é›¾éœ¾è“ç›´ç­’ä¸­é•¿ä¸ºä¸»é€‰ï¼ŒMassimoÂ Duttiè—•ç²‰ä¸­é•¿ä¸ºå¤‡é€‰ï¼›è¯¥å»ºè®®ä¸ç”¨æˆ·â€œå›½è´¸æ–¹ä¾¿â€â€œé›¾éœ¾è“ç›´ç­’ä¹Ÿè¡Œâ€çš„å›åº”ç›¸ä¸€è‡´ï¼Œå¦å¤–assistantä¹Ÿæåˆ°userå–œæ¬¢Majeï¼Œä½†Userå¹¶æœªå›åº”æˆ–è¯å®è¯¥è¯´æ³•ã€‚<span class="hljs-string">",
Â Â Â Â Â Â "</span>tags<span class="hljs-string">":Â ["</span>å©šç¤¼ç©¿ç€<span class="hljs-string">",Â "</span>é—¨åº—<span class="hljs-string">",Â "</span>é€‰è´­è·¯çº¿<span class="hljs-string">"]
Â Â Â Â }
Â Â ],
Â Â "</span>summary<span class="hljs-string">":Â "</span>ç”¨æˆ·è®¡åˆ’åœ¨çº¦<span class="hljs-number">2025</span>å¹´<span class="hljs-number">8</span>æœˆå‚åŠ åŒäº‹å©šç¤¼ï¼Œé¢„ç®—â‰¤<span class="hljs-number">1500</span>å¹¶åå¥½ç«¯åº„çš„ä¸­é•¿æ¬¾ï¼›ç¡®å®šäº<span class="hljs-number">2025</span>-<span class="hljs-number">07</span>-<span class="hljs-number">19</span>åœ¨å›½è´¸è¯•ç©¿ã€‚å…¶é•¿æœŸç”»åƒæ˜¾ç¤ºï¼šä¸å–œæ¬¢äº®è‰²ã€åå¥½ä½äº®åº¦è‰²ç³»ä¸ä¸è¿‡åˆ†æš´éœ²çš„ç‰ˆå‹ï¼Œèº«é«˜çº¦<span class="hljs-number">165</span>cmã€Sç ä¸”åå¥½è£™è£…å¸¦å£è¢‹ã€‚åŠ©æ‰‹æå‡ºçš„å›½è´¸é€‰è´­è·¯çº¿ä»¥COSé›¾éœ¾è“ç›´ç­’ä¸­é•¿ä¸ºä¸»é€‰ã€MDè—•ç²‰ä¸­é•¿ä¸ºå¤‡é€‰ï¼Œä¸”ä¸ç”¨æˆ·å›åº”ä¸€è‡´ï¼Œä¸ºçº¿ä¸‹è¯•ç©¿ä¸è´­ä¹°æä¾›äº†æ˜ç¡®è·¯å¾„ã€‚<span class="hljs-string">"
}

è¯·å§‹ç»ˆä½¿ç”¨ä¸å¯¹è¯ç›¸åŒçš„è¯­è¨€è¿›è¡Œå›å¤ã€‚

å¯¹è¯ï¼š
${conversation}

æ‚¨çš„è¾“å‡ºï¼š""
</span></code></pre>
<h5 data-id="heading-22">3.2.2 å†…å­˜ç±»å‹åˆ¤æ–­çš„æ ‡å‡†</h5>
<p>æ ¹æ® prompt ä¸­çš„æŒ‡ç¤ºï¼ŒLLM ä¼šåŸºäºä»¥ä¸‹æ ‡å‡†æ¥åˆ¤æ–­è®°å¿†ç±»å‹ï¼š</p>
<ul>
<li>
<p>LongTermMemory</p>
<ul>
<li>åŒ…å«é•¿æœŸé‡è¦ä¿¡æ¯</li>
<li>æ¶‰åŠé¡¹ç›®è®¡åˆ’ã€é‡è¦å†³ç­–ã€å…³é”®äº‹å®</li>
<li>å¯¹ç”¨æˆ·é•¿æœŸæœ‰ä»·å€¼çš„ä¿¡æ¯</li>
</ul>
</li>
<li>
<p>UserMemory</p>
<ul>
<li>ä¸ç”¨æˆ·ä¸ªäººåå¥½ã€ä¹ æƒ¯ã€ç‰¹å¾ç›¸å…³</li>
<li>ç”¨æˆ·çš„ä¸ªäººç»å†ã€è§‚ç‚¹ã€å–œå¥½</li>
<li>ä¸ç‰¹å®šç”¨æˆ·å¼ºç›¸å…³çš„ä¿¡æ¯</li>
</ul>
</li>
</ul>
<p>æ ¹æ®æä¾›çš„ SIMPLE_STRUCT_MEM_READER_PROMPTï¼Œå†³å®šè®°å¿†ç±»å‹çš„åˆ¤æ–­æ ‡å‡†å¦‚ä¸‹ï¼š</p>
<p>åœ¨ prompt ä¸­ï¼Œæ˜ç¡®è¦æ±‚ä¸ºæ¯ä¸ªæå–çš„è®°å¿†æŒ‡å®š memory_type å­—æ®µï¼Œå…¶å€¼åªèƒ½æ˜¯ "LongTermMemory" æˆ– "UserMemory"ã€‚è™½ç„¶ prompt æ²¡æœ‰è¯¦ç»†è¯´æ˜ä¸¤è€…çš„å…·ä½“åŒºåˆ«ï¼Œä½†é€šè¿‡ç¤ºä¾‹å’Œä¸Šä¸‹æ–‡å¯ä»¥æ¨æ–­å‡ºä»¥ä¸‹åˆ¤æ–­æ ‡å‡†ï¼š</p>
<p>LongTermMemoryï¼ˆé•¿æœŸè®°å¿†ï¼‰å­˜å‚¨å…·æœ‰é•¿æœŸä»·å€¼å’Œé‡è¦æ€§çš„ä¿¡æ¯ï¼š</p>
<ul>
<li>é¡¹ç›®è®¡åˆ’å’Œå…³é”®å†³ç­–</li>
<li>é‡è¦çš„äº‹å®å’Œäº‹ä»¶</li>
<li>éœ€è¦é•¿æœŸä¿å­˜çš„å·¥ä½œç›¸å…³ä¿¡æ¯</li>
<li>å¯¹ç”¨æˆ·æœªæ¥å‘å±•æœ‰æŒç»­å½±å“çš„ä¿¡æ¯</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â Â <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"InitialÂ projectÂ meeting"</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"memory_type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"LongTermMemory"</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"[user-TomÂ viewpoint]Â OnÂ JuneÂ 25,Â 2025Â atÂ 3:00Â PM,Â TomÂ metÂ withÂ theÂ teamÂ toÂ discussÂ aÂ newÂ project..."</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-string">"project"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"timeline"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"meeting"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"deadline"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>UserMemoryï¼ˆç”¨æˆ·è®°å¿†ï¼‰å­˜å‚¨ä¸ç”¨æˆ·ä¸ªäººç›¸å…³çš„åå¥½ã€ä¹ æƒ¯å’Œç‰¹å¾ï¼š</p>
<ul>
<li>ç”¨æˆ·çš„ä¸ªäººåå¥½å’Œé€‰æ‹©</li>
<li>ç”¨æˆ·çš„ä¹ æƒ¯å’Œè¡Œä¸ºæ¨¡å¼</li>
<li>ç”¨æˆ·çš„ä¸ªäººè§‚ç‚¹å’Œæ„Ÿå—</li>
<li>ä¸ç‰¹å®šç”¨æˆ·å¼ºç›¸å…³çš„ä¿¡æ¯</li>
</ul>
<p>ç¤ºä¾‹ï¼ˆåŸºäºè´­ç‰©åœºæ™¯ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â Â <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"weddingÂ dressÂ preference"</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"memory_type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"UserMemory"</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"[user-viewpoint]Â ForÂ colleague'sÂ weddingÂ nextÂ month,Â theÂ userÂ wantsÂ toÂ buyÂ aÂ dressÂ withinÂ 1500Â RMBÂ budget,Â notÂ tooÂ revealing.Â PrefersÂ midiÂ length,Â modestÂ style,Â andÂ colorsÂ likeÂ creamÂ white,Â lightÂ pink,Â orÂ hazeÂ blue."</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-string">"wedding"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"dress"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"budget"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"preference"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-23">3.2.3 åˆ¤æ–­ä¾æ®æ€»ç»“</h5>
<p>è™½ç„¶ prompt ä¸­æ²¡æœ‰æ˜ç¡®åˆ—å‡ºè¯¦ç»†çš„åˆ¤æ–­è§„åˆ™ï¼Œä½†ä»ç¤ºä¾‹å’Œä»»åŠ¡æè¿°ä¸­å¯ä»¥å½’çº³å‡ºä»¥ä¸‹åˆ¤æ–­ä¾æ®ï¼š</p>
<ul>
<li>å†…å®¹æ€§è´¨ï¼šä¿¡æ¯æ˜¯å·¥ä½œ/é¡¹ç›®ç›¸å…³ï¼ˆLongTermMemoryï¼‰è¿˜æ˜¯ä¸ªäººåå¥½/ä½“éªŒï¼ˆUserMemoryï¼‰</li>
<li>æ—¶é—´è·¨åº¦ï¼šçŸ­æœŸä¸´æ—¶ä¿¡æ¯å¯èƒ½å½’ç±»ä¸º WorkingMemoryï¼ˆè™½ç„¶ç¤ºä¾‹ä¸­æœªæ˜¾ç¤ºï¼‰ï¼Œè€Œé•¿æœŸæœ‰ä»·å€¼ä¿¡æ¯å½’ç±»ä¸º LongTermMemory</li>
<li>æ‰€æœ‰æƒï¼šä¿¡æ¯å±äºç”¨æˆ·ä¸ªäººï¼ˆUserMemoryï¼‰è¿˜æ˜¯å·¥ä½œ/é¡¹ç›®ç›¸å…³ï¼ˆLongTermMemoryï¼‰</li>
<li>é‡è¦æ€§ï¼šå¯¹ç”¨æˆ·é•¿æœŸæœ‰ä»·å€¼çš„ä¿¡æ¯å½’ç±»ä¸º LongTermMemoryï¼Œä¸ªäººå–œå¥½å’Œä¹ æƒ¯å½’ç±»ä¸º UserMemory</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æå–é˜¶æ®µçš„ prompt ä¸­æ²¡æœ‰æåŠ WorkingMemoryï¼Œè¿™æ˜¯å› ä¸º WorkingMemory é€šå¸¸ç”±ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†ï¼Œç”¨äºå­˜å‚¨æœ€è¿‘è®¿é—®çš„è®°å¿†ï¼Œè€Œä¸æ˜¯ç”± LLM åˆ¤æ–­åˆ†ç±»çš„ã€‚</p>
<h5 data-id="heading-24">3.2.4 ä»£ç æµç¨‹</h5>
<h6 data-id="heading-25">å®é™…è½¬æ¢æµç¨‹æ€»ç»“</h6>
<p>æ–°å¢è®°å¿†å³æ—¶è½¬æ¢ï¼š</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥æˆ–ç³»ç»Ÿç”Ÿæˆè®°å¿†æ—¶ç«‹å³å­˜å‚¨åˆ°ç›¸åº”çš„ç›®æ ‡è®°å¿†åº“</li>
<li>æ‰€æœ‰è®°å¿†éƒ½åŒæ—¶ä¿å­˜åœ¨ WorkingMemory ä¸­ä½œä¸ºç¼“å­˜ï¼Œéƒ¨åˆ†ä¹Ÿä¼šè¿›å…¥ LongTermMemory æˆ– UserMemory</li>
</ul>
<p>å‘¨æœŸæ€§æ¸…ç†</p>
<ul>
<li>WorkingMemory è¾¾åˆ°å®¹é‡ä¸Šé™æ—¶ï¼Œç§»é™¤æœ€æ—§çš„è®°å¿†é¡¹</li>
<li>é•¿æœŸè®°å¿†åº“ä¸€èˆ¬ä¸ä¸»åŠ¨æ¸…ç†ï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤</li>
</ul>
<p>ç»“æ„ä¼˜åŒ–ä¸æŠ½è±¡</p>
<ul>
<li>ç³»ç»Ÿå®šæœŸå¯¹é•¿æœŸè®°å¿†è¿›è¡Œèšç±»åˆ†æ</li>
<li>ç”Ÿæˆæ›´é«˜å±‚æ¬¡çš„æŠ½è±¡è®°å¿†èŠ‚ç‚¹</li>
<li>å»ºç«‹è®°å¿†é—´çš„è¯­ä¹‰å…³è”ç½‘ç»œ</li>
</ul>
<p>å¹¶è¡Œæ£€ç´¢</p>
<ul>
<li>æœç´¢æ—¶ä¼šåŒæ—¶æŸ¥è¯¢å¤šç§å†…å­˜ç±»å‹ï¼Œç„¶ååˆå¹¶ç»“æœ</li>
</ul>
<p>æ‰‹åŠ¨æ›¿æ¢</p>
<ul>
<li>å¯ä»¥æ‰‹åŠ¨æ›¿æ¢ WorkingMemory çš„å†…å®¹</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿæ—¢èƒ½å¿«é€Ÿå“åº”æœ€æ–°ä¿¡æ¯ï¼Œåˆèƒ½é•¿æœŸä¿å­˜é‡è¦çŸ¥è¯†ï¼Œå¹¶é€šè¿‡ç»“æ„ä¼˜åŒ–ä¸æ–­æå‡æ£€ç´¢æ•ˆç‡å’Œè¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚</p>
<h6 data-id="heading-26">åˆ›å»ºå’Œåˆå§‹å­˜å‚¨</h6>
<p>è®°å¿†é€šè¿‡ MemReader ç»„ä»¶åˆ›å»ºï¼Œè¯¥ç»„ä»¶å¤„ç†è¾“å…¥æ•°æ®ï¼ˆæ–‡æ¡£æˆ–å¯¹è¯ï¼‰å¹¶å°†å…¶è½¬æ¢ä¸ºç»“æ„åŒ–çš„è®°å¿†é¡¹ï¼Œå­˜å‚¨åœ¨ TreeTextMemory ä¸­ã€‚</p>
<p>åœ¨åˆ›å»ºè®°å¿†é¡¹æ—¶ï¼Œå¯ä»¥é€šè¿‡ TreeNodeTextualMemoryMetadata çš„ memory_type å­—æ®µæŒ‡å®šè®°å¿†ç±»å‹ä¸º LongTermMemoryï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">#Â åœ¨Â memos/memories/textual/item.pyÂ ä¸­å®šä¹‰çš„Â TreeNodeTextualMemoryMetadataÂ ç±»
<span class="hljs-function"><span class="hljs-keyword">class</span>Â <span class="hljs-title">TreeNodeTextualMemoryMetadata</span><span class="hljs-params">(TextualMemoryMetadata)</span>:
Â Â Â Â memory_type:Â Literal[<span class="hljs-string">"WorkingMemory"</span>,Â <span class="hljs-string">"LongTermMemory"</span>,Â <span class="hljs-string">"UserMemory"</span>]Â =</span>Â <span class="hljs-string">"WorkingMemory"</span>
</code></pre>
<p>å½“é€šè¿‡ TreeTextMemory.add() æ·»åŠ è®°å¿†æ—¶ï¼Œä¼šè§¦å‘ä»¥ä¸‹è½¬æ¢é€»è¾‘ï¼š</p>
<ul>
<li>æ‰€æœ‰æ–°å¢è®°å¿†éƒ½ä¼šå…ˆå­˜å‚¨åˆ° WorkingMemoryï¼›</li>
<li>åŒæ—¶æ ¹æ®è®°å¿†å…ƒæ•°æ®ä¸­çš„ memory_type å­—æ®µå†³å®šæ˜¯å¦åŒæ—¶å­˜å‚¨åˆ° LongTermMemory æˆ– UserMemoryã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python">TreeTextMemory.add()
â†’Â MemoryManager.add()
â†’Â MemoryManager._process_memory()

Â Â Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">_process_memory</span>(<span class="hljs-params">self,Â memory:Â TextualMemoryItem</span>):
Â Â Â Â Â Â Â Â <span class="hljs-string">"""
Â Â Â Â Â Â Â Â ProcessÂ andÂ addÂ memoryÂ toÂ differentÂ memoryÂ typesÂ (WorkingMemory,Â LongTermMemory,Â UserMemory).
Â Â Â Â Â Â Â Â ThisÂ methodÂ runsÂ asynchronouslyÂ toÂ processÂ eachÂ memoryÂ item.
Â Â Â Â Â Â Â Â """</span>
Â Â Â Â Â Â Â Â idsÂ =Â []

Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â æ€»æ˜¯æ·»åŠ åˆ°Â WorkingMemory</span>
Â Â Â Â Â Â Â Â working_idÂ =Â self._add_memory_to_db(memory,Â <span class="hljs-string">"WorkingMemory"</span>)
Â Â Â Â Â Â Â Â ids.append(working_id)

Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â å¦‚æœå…ƒæ•°æ®ä¸­æŒ‡å®šäº†Â LongTermMemoryÂ æˆ–Â UserMemoryï¼Œåˆ™ä¹Ÿæ·»åŠ åˆ°ç›¸åº”ç±»å‹</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â memory.metadata.memory_typeÂ <span class="hljs-keyword">in</span>Â [<span class="hljs-string">"LongTermMemory"</span>,Â <span class="hljs-string">"UserMemory"</span>]:
Â Â Â Â Â Â Â Â Â Â Â Â added_idÂ =Â self._add_to_graph_memory(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â memory=memory,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â memory_type=memory.metadata.memory_type,
Â Â Â Â Â Â Â Â Â Â Â Â )
Â Â Â Â Â Â Â Â Â Â Â Â ids.append(added_id)

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â ids
</code></pre>
<p>å½“æ·»åŠ è®°å¿†æ—¶ï¼Œå¯ä»¥æŒ‡å®šLongTermMemoryç±»å‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">Â Â Â Â <span class="hljs-comment">#Â CreateÂ characterÂ memoryÂ metadata</span>
Â Â Â Â <span class="hljs-attr">metadata</span>Â =Â TreeNodeTextualMemoryMetadata(
Â Â Â Â Â Â Â Â <span class="hljs-attr">user_id</span>=user_id,
Â Â Â Â Â Â Â Â <span class="hljs-attr">type</span>=<span class="hljs-string">"fact"</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">source</span>=<span class="hljs-string">"conversation"</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">confidence</span>=<span class="hljs-number">90.0</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">memory_type</span>=<span class="hljs-string">"LongTermMemory"</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">key</span>=<span class="hljs-string">"Zhang_San_Info"</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">entities</span>=[<span class="hljs-string">"ZhangÂ San"</span>,Â <span class="hljs-string">"Engineer"</span>],
Â Â Â Â Â Â Â Â <span class="hljs-attr">tags</span>=[<span class="hljs-string">"Personnel"</span>,Â <span class="hljs-string">"Technical"</span>]
Â Â Â Â )

Â Â Â Â <span class="hljs-comment">#Â CreateÂ memoryÂ item</span>
Â Â Â Â <span class="hljs-attr">memory_item</span>Â =Â TextualMemoryItem(
Â Â Â Â Â Â Â Â <span class="hljs-attr">memory</span>=<span class="hljs-string">"ZhangÂ SanÂ isÂ aÂ seniorÂ engineerÂ inÂ ourÂ company,Â specializingÂ inÂ PythonÂ andÂ machineÂ learning"</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">metadata</span>=metadata
Â Â Â Â )
</code></pre>
<h6 data-id="heading-27">å®šæœŸæ¸…ç†ä¸ç»´æŠ¤æœºåˆ¶</h6>
<p>ç³»ç»Ÿé‡‡ç”¨å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„æ–¹å¼å®šæœŸæ¸…ç† WorkingMemoryï¼š</p>
<ul>
<li>åœ¨æ¯æ¬¡æ·»åŠ è®°å¿†åè°ƒç”¨ remove_oldest_memory æ–¹æ³•ï¼›</li>
<li>ä¿ç•™æœ€æ–°çš„ N æ¡è®°å½•ï¼ˆé»˜è®¤é…ç½®ä¸º 20 æ¡ï¼‰ï¼›</li>
<li>è¶…å‡ºé™åˆ¶çš„æ—§è®°å½•ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</li>
</ul>
<p>åœ¨ç³»ç»Ÿé…ç½®ä¸­ï¼Œå¯ä»¥è®¾ç½®è®°å¿†å¤§å°é™åˆ¶ç­‰å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šç›´æ¥å½±å“ LongTermMemoryçš„ç®¡ç†ã€‚</p>
<p>åœ¨ TreeTextMemory ä¸­ï¼ŒMemoryManager è´Ÿè´£ç®¡ç†ä¸åŒç±»å‹å†…å­˜çš„åˆ†é…å’Œç»´æŠ¤ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â åœ¨Â TreeTextMemory.__init__Â ä¸­åˆå§‹åŒ–</span>
self.memory_manager:Â MemoryManagerÂ =Â MemoryManager(
Â Â Â Â self.graph_store,
Â Â Â Â self.embedder,
Â Â Â Â self.extractor_llm,
Â Â Â Â memory_size=config.memory_sizeÂ <span class="hljs-keyword">or</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-string">"WorkingMemory"</span>:Â <span class="hljs-number">20</span>,Â <span class="hljs-comment">#Â ç”Ÿå‘½å‘¨æœŸï¼šçŸ­æœŸå­˜å‚¨ï¼Œå®šæœŸæ¸…ç†ï¼Œç”¨é€”ï¼šå­˜å‚¨æœ€è¿‘ä½¿ç”¨çš„è®°å¿†ï¼Œç”¨äºå¿«é€Ÿè®¿é—®</span>
Â Â Â Â Â Â Â Â <span class="hljs-string">"LongTermMemory"</span>:Â <span class="hljs-number">1500</span>,Â <span class="hljs-comment">#Â ç”Ÿå‘½å‘¨æœŸï¼šé•¿æœŸå­˜å‚¨ï¼Œå­˜å‚¨é‡è¦ä¸”æŒä¹…çš„è®°å¿†</span>
Â Â Â Â Â Â Â Â <span class="hljs-string">"UserMemory"</span>:Â <span class="hljs-number">480</span>,Â <span class="hljs-comment">#Â ç”Ÿå‘½å‘¨æœŸï¼šä¸ç‰¹å®šç”¨æˆ·ç›¸å…³è”ï¼Œå­˜å‚¨ä¸ç‰¹å®šç”¨æˆ·ç›¸å…³çš„ä¸ªæ€§åŒ–è®°å¿†</span>
Â Â Â Â },
Â Â Â Â is_reorganize=self.is_reorganize,
)
</code></pre>
<p>æ¸…ç†è§¦å‘æ—¶æœºä¸ºï¼š</p>
<pre><code class="hljs language-python" lang="python">Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>:
Â Â Â Â Â Â Â Â Â Â Â Â self.graph_store.remove_oldest_memory(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â memory_type=<span class="hljs-string">"WorkingMemory"</span>,Â keep_latest=self.memory_size[<span class="hljs-string">"WorkingMemory"</span>]
Â Â Â Â Â Â Â Â Â Â Â Â )
Â Â Â Â Â Â Â Â <span class="hljs-keyword">except</span>Â Exception:
Â Â Â Â Â Â Â Â Â Â Â Â logger.warning(<span class="hljs-string">f"RemoveÂ WorkingMemoryÂ error:Â <span class="hljs-subst">{traceback.format_exc()}</span>"</span>)

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>:
Â Â Â Â Â Â Â Â Â Â Â Â self.graph_store.remove_oldest_memory(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â memory_type=<span class="hljs-string">"LongTermMemory"</span>,Â keep_latest=self.memory_size[<span class="hljs-string">"LongTermMemory"</span>]
Â Â Â Â Â Â Â Â Â Â Â Â )
Â Â Â Â Â Â Â Â <span class="hljs-keyword">except</span>Â Exception:
Â Â Â Â Â Â Â Â Â Â Â Â logger.warning(<span class="hljs-string">f"RemoveÂ LongTermMemoryÂ error:Â <span class="hljs-subst">{traceback.format_exc()}</span>"</span>)

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>:
Â Â Â Â Â Â Â Â Â Â Â Â self.graph_store.remove_oldest_memory(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â memory_type=<span class="hljs-string">"UserMemory"</span>,Â keep_latest=self.memory_size[<span class="hljs-string">"UserMemory"</span>]
Â Â Â Â Â Â Â Â Â Â Â Â )
Â Â Â Â Â Â Â Â <span class="hljs-keyword">except</span>Â Exception:
Â Â Â Â Â Â Â Â Â Â Â Â logger.warning(<span class="hljs-string">f"RemoveÂ UserMemoryÂ error:Â <span class="hljs-subst">{traceback.format_exc()}</span>"</span>)
</code></pre>
<h6 data-id="heading-28">æœç´¢æ—¶çš„æ•°æ®äº¤äº’</h6>
<p>åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œä¸åŒç±»å‹çš„å†…å­˜ä¼šè¢«å¹¶è¡ŒæŸ¥è¯¢ï¼Œç„¶åç»“æœè¢«åˆå¹¶å’Œé‡æ–°æ’åºï¼š</p>
<pre><code class="hljs language-less" lang="less">#Â åœ¨Â <span class="hljs-selector-tag">Searcher</span><span class="hljs-selector-class">._retrieve_paths</span>Â æ–¹æ³•ä¸­
<span class="hljs-selector-tag">tasks</span><span class="hljs-selector-class">.append</span>(
Â Â Â Â executor.<span class="hljs-built_in">submit</span>(
Â Â Â Â Â Â Â Â self._retrieve_from_working_memory,
Â Â Â Â Â Â Â Â query,
Â Â Â Â Â Â Â Â parsed_goal,
Â Â Â Â Â Â Â Â query_embedding,
Â Â Â Â Â Â Â Â top_k,
Â Â Â Â Â Â Â Â memory_type,
Â Â Â Â Â Â Â Â search_filter,
tasks.<span class="hljs-built_in">append</span>(
Â Â Â Â executor.<span class="hljs-built_in">submit</span>(
Â Â Â Â Â Â Â Â self._retrieve_from_working_memory,
Â Â Â Â )
)
</code></pre>
<h6 data-id="heading-29">å›¾ç»“æ„é‡ç»„è¿‡ç¨‹ä¸­çš„è®°å¿†ä¼˜åŒ–</h6>
<p>GraphStructureReorganizer çš„å‘¨æœŸæ€§ä¼˜åŒ–ï¼Œå³GraphStructureReorganizer è¿˜ä¼šå®šæœŸå¯¹ LongTermMemory å’Œ UserMemory è¿›è¡Œç»“æ„ä¼˜åŒ–ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–°çš„èšåˆèŠ‚ç‚¹ã€‚</p>
<p>ç³»ç»Ÿæœ‰ä¸€ä¸ªåå°çº¿ç¨‹è¿è¡Œ GraphStructureReorganizerï¼Œå®ƒä¼šå®šæœŸæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>å¯¹é•¿æœŸè®°å¿†è¿›è¡Œèšç±»å’Œæ€»ç»“ï¼›</li>
<li>åˆ›å»ºæŠ½è±¡å±‚çº§çš„è®°å¿†èŠ‚ç‚¹ã€‚</li>
</ul>
<p>ä¼˜åŒ–è§¦å‘æ¡ä»¶ä¸ºï¼š</p>
<ul>
<li>æ–°å¢è®°å¿†æ—¶è®¾ç½® _reorganize_needed=True æ ‡å¿—</li>
<li>å®šæœŸè°ƒåº¦å™¨æ¯ 100 ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦é‡æ–°ç»„ç»‡ç»“æ„</li>
<li>å½“æœ‰è¶³å¤Ÿå¤šçš„æ–°è®°å¿†ç§¯ç´¯æ—¶æ‰çœŸæ­£è§¦å‘ä¼˜åŒ–è¿‡ç¨‹</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">defÂ optimize_structure(
Â Â Â Â self,
Â Â Â Â scope:Â <span class="hljs-attr">str</span>Â =Â <span class="hljs-string">"LongTermMemory"</span>,
):
Â Â Â Â <span class="hljs-comment">#Â åŠ è½½å€™é€‰èŠ‚ç‚¹</span>
Â Â Â Â <span class="hljs-attr">raw_nodes</span>Â =Â self.graph_store.get_structure_optimization_candidates(scope)
Â Â Â Â <span class="hljs-attr">nodes</span>Â =Â [GraphDBNode(**n)Â forÂ nÂ inÂ raw_nodes]
Â Â Â Â <span class="hljs-comment">#Â åˆ†åŒºå¤„ç†</span>
Â Â Â Â <span class="hljs-attr">partitioned_groups</span>Â =Â self._partition(nodes)
Â Â Â Â <span class="hljs-comment">#Â å¯¹æ¯ä¸ªåˆ†åŒºè¿›è¡Œèšç±»å’Œæ€»ç»“</span>
Â Â Â Â forÂ cluster_nodesÂ inÂ partitioned_groups:
Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â åˆ›å»ºçˆ¶èŠ‚ç‚¹è¡¨ç¤ºèšç±»</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">sub_parent_node</span>Â =Â self._summarize_cluster(sub_nodes,Â scope)
Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â ...</span>
</code></pre>
<h6 data-id="heading-30">ç”¨æˆ·æ§åˆ¶æ–¹å¼</h6>
<p>è™½ç„¶ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†å†…å­˜ç±»å‹ï¼Œä½†ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é—´æ¥å½±å“ï¼š</p>
<ul>
<li>è®¾ç½®å…ƒæ•°æ®ï¼šåœ¨åˆ›å»º TextualMemoryItem æ—¶è®¾ç½® metadata.memory_type å­—æ®µ</li>
<li>é…ç½®å®¹é‡ï¼šé€šè¿‡ TreeTextMemoryConfig è®¾ç½®å„ç±»å†…å­˜çš„æœ€å¤§å®¹é‡</li>
<li>æ‰‹åŠ¨æ›¿æ¢ï¼šä½¿ç”¨ replace_working_memory æ–¹æ³•ç›´æ¥æ“ä½œå·¥ä½œå†…å­˜</li>
</ul>
<h6 data-id="heading-31">æ€»ç»“</h6>
<p>LongTermMemoryã€UserMemory å’Œ WorkingMemory çš„è®¾ç½®ä¸»è¦æ˜¯ç”±ç³»ç»Ÿæ ¹æ®é¢„å®šä¹‰è§„åˆ™è‡ªåŠ¨å®Œæˆçš„ï¼Œè€Œä¸æ˜¯ç”¨æˆ·ä¸»åŠ¨è®¾ç½®ã€‚ç³»ç»Ÿä¼šæ ¹æ®è®°å¿†çš„å…ƒæ•°æ®å’Œé…ç½®è‡ªåŠ¨å°†å…¶åˆ†é…åˆ°é€‚å½“çš„å†…å­˜ç±»å‹ä¸­ï¼Œå¹¶æŒ‰ç…§è®¾å®šçš„å®¹é‡é™åˆ¶è¿›è¡Œç®¡ç†ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®å‚æ•°å’Œè®¾ç½®è®°å¿†å…ƒæ•°æ®æ¥é—´æ¥å½±å“è¿™ä¸€è¿‡ç¨‹ã€‚</p>
<h3 data-id="heading-32">0x04 MemOS è®°å¿†ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
<p>MemOS å¹¶æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æ¨¡å—ï¼Œè¯¥åŠŸèƒ½æ˜¯æ•£å¸ƒåœ¨MemOSå„ä¸ªæ¨¡å—ä¸­ã€‚</p>
<p>ä»¥ä¸‹ä¸ºå®˜æ–¹æ–‡æ¡£å†…å®¹ã€‚</p>
<p>ä¸€æ¡è®°å¿†ä»è¢«ç”Ÿæˆå¼€å§‹ï¼Œå¯èƒ½ä¼šé€æ­¥æ²‰æ·€ä¸ºç¨³å®šçš„é•¿æœŸåå¥½ï¼Œä¹Ÿå¯èƒ½å› è¿‡æ—¶æˆ–æ— æ•ˆè€Œè¢«æ¸…ç†ã€‚</p>
<p>è¿™å¥—æ¼”åŒ–è¿‡ç¨‹ç§°ä¸ºÂ <strong>è®°å¿†ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼Œå®ƒçš„ç›®æ ‡æ˜¯ä¿æŒè®°å¿†åº“â€œå¹²å‡€è€Œæœ‰åºâ€ã€‚</p>
<ul>
<li><strong>è¿‘æœŸæœ‰ç”¨çš„æ¡ç›®</strong>ä¿æŒæ´»è·ƒï¼Œæ–¹ä¾¿éšæ—¶è°ƒç”¨ï¼›</li>
<li><strong>é•¿æœŸç¨³å®šçš„äº‹å®</strong>è¢«æ²‰æ·€ï¼Œå‡å°‘é‡å¤å’Œå™ªéŸ³ï¼›</li>
<li><strong>è¿‡æ—¶æˆ–å†²çªçš„ä¿¡æ¯</strong>ä¼šè¢«å½’æ¡£æˆ–åˆ é™¤ï¼Œä¿è¯ä¸€è‡´æ€§å’Œåˆè§„æ€§ã€‚</li>
</ul>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”Ÿå‘½å‘¨æœŸç®¡ç†å…³æ³¨çš„æ˜¯<strong>è®°å¿†æ¡ç›®åœ¨å­˜å‚¨å±‚é¢çš„æ¼”åŒ–</strong>ï¼›è€Œå…·ä½“ä¸€æ¬¡æ¨ç†é‡Œâ€œæ˜¯å¦è°ƒç”¨æŸæ¡è®°å¿†â€ï¼Œä»ç”±è°ƒåº¦æœºåˆ¶å†³å®šã€‚</p>
</blockquote>
<h4 data-id="heading-33">4.1 ç”Ÿå‘½å‘¨æœŸé˜¶æ®µç®€ä»‹</h4>








































<table><thead><tr><th><strong>é˜¶æ®µ</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>ç³»ç»Ÿè¡Œä¸º</strong></th></tr></thead><tbody><tr><td>Generated ç”Ÿæˆ</td><td>æ–°äº§ç”Ÿçš„è®°å¿†å¯¹è±¡ï¼Œå¸¦æœ‰æ¥æºã€æ—¶é—´æˆ³ã€ç½®ä¿¡åº¦ç­‰å…ƒä¿¡æ¯</td><td>åˆå§‹å­˜å…¥å­˜å‚¨å±‚ï¼Œç­‰å¾…åç»­ä½¿ç”¨</td></tr><tr><td>Activated æ¿€æ´»</td><td>åœ¨æ¨ç†æˆ–ä»»åŠ¡ä¸­è¢«å¼•ç”¨ï¼Œè¿›å…¥é«˜é¢‘æ´»è·ƒçŠ¶æ€</td><td>æ›´å®¹æ˜“è¢«è°ƒåº¦æœºåˆ¶é€‰ä¸­</td></tr><tr><td>Merged åˆå¹¶</td><td>ä¸å†å²è®°å¿†å­˜åœ¨è¯­ä¹‰é‡å æˆ–ç”¨æˆ·è¡¥å……æ•°æ®ï¼Œç³»ç»Ÿå°†å…¶æ•´åˆä¸ºæ–°ç‰ˆæœ¬</td><td>å¤šæ¡è®°å½•è¢«å‹ç¼©åˆå¹¶ï¼Œå½¢æˆæ›´æ–°åçš„ç¨³å®šæ¡ç›®</td></tr><tr><td>Archived å½’æ¡£</td><td>é•¿æœŸæœªè¢«è®¿é—®ï¼Œè‡ªåŠ¨é™çº§ä¸ºå†·å­˜å‚¨çŠ¶æ€</td><td>ä»…åœ¨ç‰¹æ®Šæ£€ç´¢æˆ–å›æº¯æ—¶å¯ç”¨</td></tr><tr><td>Expired è¿‡æœŸï¼Œå¯é€‰</td><td>å½’æ¡£åè¿›ä¸€æ­¥è¶…æ—¶æˆ–è¢«ç­–ç•¥åˆ¤å®šä¸ºæ— æ•ˆ</td><td>è¢«æ¸…ç†å‡ºç´¢å¼•ï¼Œä¸å†å‚ä¸æ¨ç†ï¼Œä»…ç•™æœ€å°æ—¥å¿—</td></tr><tr><td>Frozen å†»ç»“ï¼Œç‰¹æ®ŠçŠ¶æ€</td><td>å…³é”®æˆ–åˆè§„æ€§è®°å¿†è¢«é”å®šï¼Œä¸å…è®¸ä¿®æ”¹</td><td>ä¿ç•™å®Œæ•´å†å²ç‰ˆæœ¬ï¼Œæ”¯æŒå®¡è®¡ä¸åˆè§„è¿½è¸ª</td></tr></tbody></table>
<h4 data-id="heading-34">4.2 æ¡ˆä¾‹ï¼šåœ¨çº¿æ•™è‚²åŠ©æ‰‹çš„è®°å¿†ç”Ÿå‘½å‘¨æœŸ</h4>
<p>å‡è®¾ä½ æ­£åœ¨ç”¨ MemOS æ„å»ºä¸€ä¸ª <strong>åœ¨çº¿æ•™è‚²åŠ©æ‰‹</strong>ï¼Œå¸®åŠ©å­¦ç”Ÿè§£ç­”æ•°å­¦é¢˜ã€‚</p>
<p><strong>ç”Ÿæˆï¼ˆGeneratedï¼‰</strong></p>
<ul>
<li>å­¦ç”Ÿç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è¯´ï¼šâ€œæˆ‘æ€»æ˜¯æŠŠäºŒæ¬¡å‡½æ•°å’Œä¸€æ¬¡å‡½æ•°ææ··ã€‚â€</li>
<li>ç³»ç»ŸæŠ½å–å‡ºè®°å¿†ï¼š</li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"fact"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"å­¦ç”Ÿå¸¸æ··æ·†äºŒæ¬¡å‡½æ•°ä¸ä¸€æ¬¡å‡½æ•°"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>Â <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"2025-09-11"</span><span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li>çŠ¶æ€ï¼š<strong>Generated</strong></li>
<li>è¡Œä¸ºï¼šè¢«å­˜å‚¨è¿›è®°å¿†åº“ï¼Œç­‰å¾…åç»­ä½¿ç”¨ã€‚</li>
</ul>
<hr/>
<p><strong>æ¿€æ´»ï¼ˆActivatedï¼‰</strong></p>
<ul>
<li>åœ¨æ¥ä¸‹æ¥çš„å¤šæ¬¡ç­”é¢˜ä¸­ï¼Œç³»ç»Ÿé¢‘ç¹è°ƒç”¨è¿™æ¡è®°å¿†æ¥è¾…åŠ©è§£é¢˜ã€‚</li>
<li>çŠ¶æ€ï¼š<strong>Activated</strong></li>
<li>è¡Œä¸ºï¼šè¢«è°ƒåº¦æœºåˆ¶ä¼˜å…ˆç¼“å­˜è¿›Â MemoryCubeï¼Œæé«˜æ£€ç´¢é€Ÿåº¦ã€‚</li>
</ul>
<hr/>
<p><strong>åˆå¹¶ï¼ˆMergedï¼‰</strong></p>
<ul>
<li>éšç€æ›´å¤šäº¤äº’ï¼Œç³»ç»Ÿå‘ç°å­¦ç”Ÿä¸ä»…æ··æ·†ä¸€æ¬¡å‡½æ•°å’ŒäºŒæ¬¡å‡½æ•°ï¼Œè¿˜å¯¹æŒ‡æ•°å‡½æ•°ä¹Ÿå®¹æ˜“æ··æ·†ã€‚</li>
<li>ç³»ç»Ÿå°†å¤šæ¡ç›¸ä¼¼è®°å¿†åˆå¹¶ä¸ºï¼š</li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"fact"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"è¯¥å­¦ç”Ÿåœ¨å‡½æ•°çŸ¥è¯†ç‚¹ä¸Šå­˜åœ¨æ··æ·†ï¼Œå°¤å…¶æ˜¯ä¸€å…ƒä¸€æ¬¡ã€äºŒæ¬¡å’ŒæŒ‡æ•°å‡½æ•°"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-number">0.95</span><span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li>çŠ¶æ€ï¼š<strong>Merged</strong></li>
<li>è¡Œä¸ºï¼šæ—§æ¡ç›®è¢«å‹ç¼©ï¼Œå½¢æˆæ–°ç‰ˆæœ¬ï¼Œå‡å°‘å†—ä½™ã€‚</li>
</ul>
<hr/>
<p><strong>å½’æ¡£ï¼ˆArchivedï¼‰</strong></p>
<ul>
<li>ä¸‰ä¸ªæœˆåï¼Œå­¦ç”Ÿå·²æŒæ¡å‡½æ•°ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œç³»ç»Ÿå¾ˆä¹…æ²¡æœ‰å†è°ƒåº¦åˆ°è¿™æ¡è®°å¿†ã€‚</li>
<li>çŠ¶æ€ï¼š<strong>Archived</strong></li>
<li>è¡Œä¸ºï¼šè¢«è¿ç§»è‡³Â MemVaultï¼ˆå†·å­˜å‚¨ï¼‰ï¼Œé»˜è®¤ä¸å‚ä¸æ¨ç†ï¼Œä½†å¯åœ¨â€œå­¦ä¹ è½¨è¿¹å›æº¯â€ä¸­è¢«è°ƒç”¨ã€‚</li>
</ul>
<hr/>
<p><strong>è¿‡æœŸï¼ˆExpiredï¼‰</strong></p>
<ul>
<li>åˆè¿‡äº†ä¸€å¹´ï¼Œè¯¥å­¦ç”Ÿå‡çº§åˆ°æ–°çš„å­¦æ®µï¼Œæ—§çš„â€œåˆä¸­å‡½æ•°æ··æ·†â€è®°å¿†è¢«ç­–ç•¥åˆ¤å®šä¸ºæ— æ•ˆã€‚</li>
<li>çŠ¶æ€ï¼š<strong>Expired</strong></li>
<li>è¡Œä¸ºï¼šä»ç´¢å¼•ä¸­å½»åº•æ¸…ç†ï¼Œä»…ä¿ç•™æœ€å°å®¡è®¡ä¿¡æ¯ï¼š</li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"deleted_fact_id"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"12345"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-attr">"deleted_at"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"2026-09-11"</span><span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<p><strong>å†»ç»“ï¼ˆFrozenï¼Œç‰¹æ®ŠçŠ¶æ€ï¼‰</strong></p>
<ul>
<li>ä¸æ­¤åŒæ—¶ï¼Œè¯¥å­¦ç”Ÿçš„â€œæœŸæœ«æˆç»©è¯„ä¼°æŠ¥å‘Šâ€å±äºåˆè§„æ€§æ–‡ä»¶ï¼Œä¸å…è®¸ä¿®æ”¹ã€‚</li>
<li>çŠ¶æ€ï¼š<strong>Frozen</strong></li>
<li>è¡Œä¸ºï¼šè¢«é”å®šï¼Œç¦æ­¢æ›´æ–°ï¼Œä»…ä¿ç•™å®Œæ•´ä¿®æ”¹å†å²ï¼Œä¾¿äºå®¡è®¡ä¸åˆè§„æ£€æŸ¥ã€‚</li>
</ul>
<p>è¿›é˜¶ï¼šå¦‚æœä½ æƒ³åšæ·±åº¦å®šåˆ¶</p>



































<table><thead><tr><th><strong>å¯æ‰©å±•ç‚¹</strong></th><th><strong>æè¿°</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td>çŠ¶æ€è½¬æ¢æ¡ä»¶</td><td>æ§åˆ¶å„ä¸ªçŠ¶æ€è§¦å‘æ¡ä»¶</td><td>â€œè‹¥Â 7Â å¤©æœªä½¿ç”¨Â â†’Â å½’æ¡£â€</td></tr><tr><td>åˆå¹¶ä¸å‹ç¼©</td><td>å®šä¹‰ç›¸ä¼¼è®°å¿†çš„å¤„ç†æ–¹å¼</td><td>å¤šæ¡â€œå–œæ¬¢ç§‘å¹»ç‰‡â€åˆå¹¶ä¸ºä¸€æ¡ç½®ä¿¡åº¦æ›´é«˜çš„äº‹å®</td></tr><tr><td>å†²çªè§£å†³</td><td>å¤„ç†æ—¶é—´æˆ³æˆ–æ¥æºçŸ›ç›¾çš„è®°å¿†</td><td>é€‰æ‹©â€œæœ€æ–°è¦†ç›–æ—§æ¡ç›®â€æˆ–â€œå¹¶åˆ—ä¿ç•™â€</td></tr><tr><td>æ¸…ç†æœºåˆ¶</td><td>è®¾ç½®åˆ é™¤æ¡ä»¶ï¼Œæ§åˆ¶ç´¢å¼•è§„æ¨¡</td><td>åˆ é™¤ä½ç½®ä¿¡åº¦æˆ–ç”¨æˆ·æ’¤å›çš„è®°å¿†</td></tr><tr><td>å®¡è®¡è¿½è¸ª</td><td>å†³å®šæ˜¯å¦ä¿ç•™è¢«åˆ é™¤æ¡ç›®çš„æœ€å°å…ƒä¿¡æ¯</td><td>åœ¨åˆè§„è¦æ±‚ä¸‹å¼€å¯â€œæº¯æºæ—¥å¿—â€</td></tr></tbody></table>
<h4 data-id="heading-35">4.3 è‡ªå·±çš„ç†è§£</h4>
<p>Memosä¸­TreeTextMemoryç³»ç»Ÿçš„ä¸‰ç§è®°å¿†ç±»å‹ï¼ˆWorkingMemoryã€LongTermMemoryå’ŒUserMemoryï¼‰ä¹‹é—´ä¸å­˜åœ¨è‡ªåŠ¨è¿ç§»æˆ–è½¬æ¢æœºåˆ¶ã€‚ç³»ç»Ÿé‡‡ç”¨ç‹¬ç«‹ç®¡ç†ç­–ç•¥ï¼Œæ¯ç§è®°å¿†ç±»å‹æœ‰å„è‡ªçš„å®¹é‡é™åˆ¶å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹å¼ã€‚</p>
<p>MemoryManagerè´Ÿè´£ç»´æŠ¤å„è®°å¿†ç±»å‹çš„å®¹é‡é™åˆ¶ï¼ŒåŒ…æ‹¬WorkingMemoryï¼ˆé»˜è®¤20æ¡ï¼‰ã€LongTermMemoryï¼ˆé»˜è®¤1500æ¡ï¼‰å’ŒUserMemoryï¼ˆé»˜è®¤480æ¡ï¼‰ã€‚å½“è¶…å‡ºé™åˆ¶æ—¶æŒ‰ç…§FIFOåŸåˆ™æ¸…ç†æ—§è®°å¿†ï¼Œä½†ä¸ä¼šè‡ªåŠ¨å°†è®°å¿†åœ¨ä¸åŒç±»å‹é—´è¿ç§»ã€‚æ–°è®°å¿†æ·»åŠ æ—¶ä¼šæ ¹æ®å…¶ç±»å‹å±æ€§å†³å®šå­˜å‚¨ä½ç½®ï¼Œè¿™æ˜¯ä¸€ç§å¹¶è¡Œæ·»åŠ è€Œéè¿ç§»è¿‡ç¨‹ã€‚</p>
<p>åœ¨æ·»åŠ è®°å¿†æ—¶ï¼Œç³»ç»Ÿä¼šå°†æ‰€æœ‰è®°å¿†åŒæ—¶æ·»åŠ åˆ°WorkingMemoryä¸­ï¼Œå¹¶æ ¹æ®è®°å¿†çš„metadata.memory_typeå­—æ®µå†³å®šæ˜¯å¦åŒæ—¶æ·»åŠ åˆ°LongTermMemoryæˆ–UserMemoryä¸­ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯å¹¶è¡Œå‘ç”Ÿçš„ï¼Œè€Œéè¿ç§»æˆ–è½¬æ¢ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è‡ªå·±çš„ç†è§£ã€‚</p>
<p>åŠ¨æ€è¿ç§»é€»è¾‘ï¼Œæ ¸å¿ƒæ˜¯ â€œè®°å¿†åœ¨ä¸åŒå½¢æ€ / æ¨¡å—é—´çš„æµåŠ¨â€ï¼Œæœ¬è´¨æ˜¯ â€œåŠŸèƒ½éœ€æ±‚é©±åŠ¨æŠ€æœ¯å½¢æ€è½¬æ¢â€â€”â€” è®© Agent æ—¢èƒ½ â€œå®æ—¶å“åº”ä»»åŠ¡â€ï¼ˆä¾èµ–å·¥ä½œè®°å¿†ã€æ¿€æ´»è®°å¿†ï¼‰ï¼Œåˆèƒ½ â€œé•¿æœŸç§¯ç´¯çŸ¥è¯†â€ï¼ˆä¾èµ– LongTermMemoryã€UserMemoryï¼‰ï¼Œè¿˜èƒ½ â€œé«˜æ•ˆåˆ©ç”¨èµ„æºâ€ï¼ˆé€šè¿‡å±‚çº§å­˜å‚¨ä¼˜åŒ–ï¼‰ï¼Œæœ€ç»ˆå®ç° â€œå¯æ¨ç†ã€å¯æ‰©å±•ã€ä¸ªæ€§åŒ–â€ çš„è®°å¿†ç®¡ç†æ ¸å¿ƒç›®æ ‡ã€‚</p>
<p>MemOS çš„æ ¸å¿ƒè®°å¿†æµè½¬é€»è¾‘ï¼Œå…·ä½“è¿ç§»è·¯å¾„å¯åˆ†ä¸º 4 ç±»ï¼Œè¦†ç›– Agent ä»»åŠ¡æ‰§è¡Œçš„å…¨æµç¨‹ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰ä»»åŠ¡å¯åŠ¨ï¼šé•¿æœŸè®°å¿† â†’ æ¿€æ´»è®°å¿† â†’ å·¥ä½œè®°å¿†</strong></p>
<ul>
<li>
<p>åœºæ™¯ï¼šAgent æ¥æ”¶ç”¨æˆ·ä»»åŠ¡ï¼ˆå¦‚ â€œå¸®æˆ‘è§„åˆ’ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æ—…è¡Œï¼Œè®°å¾—æˆ‘å–œæ¬¢ç»æµå‹é…’åº—â€ï¼‰ï¼›</p>
</li>
<li>
<p>è¿ç§»è¿‡ç¨‹ï¼š</p>
<ol>
<li>å…ˆä»ã€ŒUserMemoryã€ï¼ˆåŠŸèƒ½ç»´åº¦ï¼‰ä¸­æ£€ç´¢ â€œç”¨æˆ·å–œæ¬¢ç»æµå‹é…’åº—â€ çš„ä¸“å±è®°å¿†ï¼Œä»ã€ŒLongTermMemoryã€ï¼ˆåŠŸèƒ½ç»´åº¦ï¼‰ä¸­æ£€ç´¢ â€œåŒ—äº¬åˆ°ä¸Šæµ·çš„äº¤é€šæ–¹å¼â€ çš„é€šç”¨è®°å¿†ï¼›</li>
<li>è¿™äº›æ£€ç´¢åˆ°çš„è®°å¿†ä» â€œé•¿æœŸå­˜å‚¨â€ï¼ˆéæ¿€æ´»æ€ï¼‰åŠ è½½ä¸ºã€Œæ¿€æ´»è®°å¿†ã€ï¼ˆæŠ€æœ¯ç»´åº¦ï¼‰ï¼Œç¼“å­˜åˆ°å†…å­˜ï¼›</li>
<li>å†å°†ã€Œæ¿€æ´»è®°å¿†ã€ä¸­çš„å…³é”®ä¿¡æ¯ï¼ˆç”¨æˆ·åå¥½ã€äº¤é€šé€‰é¡¹ï¼‰æ³¨å…¥ã€ŒWorkingMemoryã€ï¼ˆåŠŸèƒ½ç»´åº¦ï¼‰ï¼Œä½œä¸ºå½“å‰ä»»åŠ¡çš„å†³ç­–ä¾æ®ã€‚</li>
</ol>
</li>
</ul>
<p><strong>ï¼ˆ2ï¼‰ä»»åŠ¡æ‰§è¡Œï¼šå·¥ä½œè®°å¿† â†” æ¿€æ´»è®°å¿†ï¼ˆå®æ—¶äº¤äº’ï¼‰</strong></p>
<ul>
<li>
<p>åœºæ™¯ï¼šAgent åˆ†ææ—…è¡Œæ–¹æ¡ˆæ—¶ï¼Œéœ€è¦ç¡®è®¤ â€œç»æµå‹é…’åº—çš„å…·ä½“æ ‡å‡†â€ï¼ˆç”¨æˆ·ä¹‹å‰æè¿‡ â€œä»·æ ¼ä½äº 500 å…ƒ / æ™šâ€ï¼‰ï¼›</p>
</li>
<li>
<p>è¿ç§»è¿‡ç¨‹ï¼š</p>
<ol>
<li>ã€ŒWorkingMemoryã€ä¸­æ— è¯¥ç»†èŠ‚ï¼Œè§¦å‘ä»ã€ŒUserMemoryã€æ£€ç´¢ï¼›</li>
<li>æ£€ç´¢ç»“æœåŠ è½½ä¸ºã€Œæ¿€æ´»è®°å¿†ã€ï¼Œè¡¥å……åˆ°ã€ŒWorkingMemoryã€ä¸­ï¼›</li>
<li>Agent åŸºäºè¡¥å……ä¿¡æ¯ç»†åŒ–æ–¹æ¡ˆï¼ˆç­›é€‰ 500 å…ƒä»¥ä¸‹é…’åº—ï¼‰ï¼Œä¸­é—´å†³ç­–ç»“æœå®æ—¶å†™å…¥ã€ŒWorkingMemoryã€ã€‚</li>
</ol>
</li>
</ul>
<p><strong>ï¼ˆ3ï¼‰ä»»åŠ¡ç»“æŸï¼šå·¥ä½œè®°å¿† â†’ é•¿æœŸè®°å¿†ï¼ˆå½’æ¡£ / ä¸¢å¼ƒï¼‰</strong></p>
<ul>
<li>
<p>åœºæ™¯ï¼šæ—…è¡Œæ–¹æ¡ˆç”Ÿæˆå®Œæˆï¼Œç”¨æˆ·ç¡®è®¤åä»»åŠ¡ç»“æŸï¼›</p>
</li>
<li>
<p>è¿ç§»è¿‡ç¨‹ï¼š</p>
<ol>
<li>ã€ŒWorkingMemoryã€ä¸­çš„æœ‰ç”¨ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·æœ€ç»ˆé€‰æ‹©çš„é…’åº—ã€äº¤é€šæ–¹å¼ã€åé¦ˆ â€œä¸‹æ¬¡æƒ³é¿å¼€é«˜é“æ¢ä¹˜â€ï¼‰ï¼ŒæŒ‰å½’å±å½’æ¡£ï¼šç”¨æˆ·ä¸“å±ä¿¡æ¯å†™å…¥ã€ŒUserMemoryã€ï¼Œé€šç”¨æ–¹æ¡ˆæ¨¡æ¿å†™å…¥ã€ŒLongTermMemoryã€ï¼›</li>
<li>å½’æ¡£åï¼Œè¿™äº›ä¿¡æ¯ä»ã€Œå·¥ä½œè®°å¿†ã€è½¬ä¸º â€œé•¿æœŸå­˜å‚¨çš„éæ¿€æ´»æ€æ•°æ®â€ï¼›</li>
<li>ã€ŒWorkingMemoryã€ä¸­æ— ä»·å€¼çš„ä¸´æ—¶ä¿¡æ¯ï¼ˆå¦‚ä¸­é—´ç­›é€‰çš„æ— æ•ˆé…’åº—ã€è®¡ç®—è¿‡ç¨‹ï¼‰ç›´æ¥é”€æ¯ï¼Œé‡Šæ”¾å†…å­˜ã€‚</li>
</ol>
</li>
</ul>
<p><strong>ï¼ˆ4ï¼‰é•¿æœŸè®°å¿†æ›´æ–°ï¼šæ¿€æ´»è®°å¿† â†’ é•¿æœŸè®°å¿†ï¼ˆè¿­ä»£ä¼˜åŒ–ï¼‰</strong></p>
<ul>
<li>
<p>åœºæ™¯ï¼šAgent å­¦ä¹ åˆ°æ–°çš„é€šç”¨çŸ¥è¯†ï¼ˆå¦‚ â€œåŒ—äº¬åˆ°ä¸Šæµ·æ–°å¢äº†ç›´è¾¾èˆªç­â€ï¼‰ï¼Œæˆ–ç”¨æˆ·æ›´æ–°åå¥½ï¼ˆå¦‚ â€œç°åœ¨å–œæ¬¢ä¸­ç«¯é…’åº—ï¼Œé¢„ç®— 800 å…ƒ / æ™šâ€ï¼‰ï¼›</p>
</li>
<li>
<p>è¿ç§»è¿‡ç¨‹ï¼š</p>
<ol>
<li>æ–°çŸ¥è¯† / æ–°åå¥½å…ˆé€šè¿‡ã€ŒRelationAndReasoningDetectorã€å¤„ç†ä¸ºç»“æ„åŒ–æ•°æ®ï¼ŒåŠ è½½ä¸ºã€Œæ¿€æ´»è®°å¿†ã€ï¼›</li>
<li>ã€Œæ¿€æ´»è®°å¿†ã€é€šè¿‡ã€ŒNodeHandlerã€å†™å…¥å¯¹åº”é•¿æœŸå­˜å‚¨ï¼šé€šç”¨çŸ¥è¯†å†™å…¥ã€ŒLongTermMemoryã€ï¼Œç”¨æˆ·åå¥½æ›´æ–°ã€ŒUserMemoryã€ï¼›</li>
<li>å†™å…¥å®Œæˆåï¼Œã€Œæ¿€æ´»è®°å¿†ã€å¯ä¿ç•™ç¼“å­˜ï¼ˆæå‡åç»­è®¿é—®é€Ÿåº¦ï¼‰ï¼Œè¶…æ—¶åè‡ªåŠ¨é‡Šæ”¾ã€‚</li>
</ol>
</li>
</ul>
<p><strong>è¡¥å……ï¼šå‚æ•°è®°å¿†çš„ç‰¹æ®Šè§’è‰²ï¼ˆæ— è¿ç§»ï¼Œä»…æä¾›åŸºç¡€æ”¯æ’‘ï¼‰</strong></p>
<p>å‚æ•°è®°å¿†ï¼ˆæ¨¡å‹æƒé‡ï¼‰æ˜¯ â€œé™æ€åŸºç¡€â€ï¼Œä¸å‚ä¸ä¸Šè¿°åŠ¨æ€è¿ç§» â€”â€” å®ƒä¸ºæ‰€æœ‰è®°å¿†çš„ â€œç†è§£ä¸æ¨ç†â€ æä¾›åº•å±‚èƒ½åŠ›ï¼ˆå¦‚è¯†åˆ« â€œç”¨æˆ·åå¥½â€ çš„è¯­ä¹‰ã€æ¨ç† â€œäº¤é€šæ–¹å¼é€‰æ‹©â€ çš„é€»è¾‘ï¼‰ï¼Œä½†è‡ªèº«ä¸ä¼šè¢« MemOS åŠ¨æ€ä¿®æ”¹ï¼ˆé™¤éè¿›è¡Œæ¨¡å‹å¾®è°ƒï¼Œå°†é•¿æœŸè®°å¿†ä¸­çš„å…³é”®çŸ¥è¯†å›ºåŒ–ä¸ºå‚æ•°è®°å¿†ï¼‰ã€‚</p>
<h4 data-id="heading-36">4.4 MemScheduler</h4>
<p>MemOS ä¹Ÿåœ¨å°è¯•è‡ªåŠ¨è¿ç§»ï¼Œè¿™å°±æ˜¯ MemScheduler çš„åŠŸèƒ½ã€‚</p>
<p>MemScheduler æ˜¯ä¸€ä¸ªä¸ MemOS ç³»ç»Ÿå¹¶è¡Œè¿è¡Œçš„å¹¶å‘è®°å¿†ç®¡ç†ç³»ç»Ÿï¼Œå®ƒåè°ƒ AI ç³»ç»Ÿä¸­å·¥ä½œè®°å¿†ã€é•¿æ—¶è®°å¿†å’Œæ¿€æ´»è®°å¿†ä¹‹é—´çš„è®°å¿†æ“ä½œã€‚å®ƒé€šè¿‡äº‹ä»¶é©±åŠ¨è°ƒåº¦å¤„ç†è®°å¿†æ£€ç´¢ã€æ›´æ–°å’Œå‹ç¼©ã€‚è¯¥ç³»ç»Ÿç‰¹åˆ«é€‚åˆéœ€è¦åŠ¨æ€è®°å¿†ç®¡ç†çš„å¯¹è¯ä»£ç†å’Œæ¨ç†ç³»ç»Ÿã€‚</p>
<p>æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« ä»‹ç» MemSchedulerã€‚</p>
<h3 data-id="heading-37">0xFF å‚è€ƒ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1981392181592871894" target="_blank" title="https://zhuanlan.zhihu.com/p/1981392181592871894" ref="nofollow noopener noreferrer">Multi-Agentç³»ç»Ÿæ„å»ºåˆæ¢ï¼šåŸºäºLangGraphçš„é•¿çŸ­æœŸè®°å¿†ç®¡ç†å®è·µæŒ‡å—</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1975514242754049684" target="_blank" title="https://zhuanlan.zhihu.com/p/1975514242754049684" ref="nofollow noopener noreferrer">Agentå¼€å‘å®è·µï¼šä»æƒ³æ³•åˆ°äº§å“â€”â€”SSEã€ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸æµå¼è§£æå…³é”®æŠ€æœ¯æ”»åš</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1975511012347249929" target="_blank" title="https://zhuanlan.zhihu.com/p/1975511012347249929" ref="nofollow noopener noreferrer">Agentå¼€å‘å®è·µï¼šä»æƒ³æ³•åˆ°äº§å“â€”â€”ç³»ç»Ÿæ¶æ„è®¾è®¡å®è·µ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.memmachine.ai%2Fopen_source%2Fmemory_types" target="_blank" title="https://docs.memmachine.ai/open_source/memory_types" ref="nofollow noopener noreferrer">docs.memmachine.ai/open_sourceâ€¦</a></p>
<p>æœ¬æ–‡ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> æ’ç‰ˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•å®ç°æµå¼è¾“å‡ºï¼Ÿä¸€ç¯‡æ–‡ç« æ‰‹æŠŠæ‰‹æ•™ä½ ï¼]]></title>    <link>https://juejin.cn/post/7583921477613502499</link>    <guid>https://juejin.cn/post/7583921477613502499</guid>    <pubDate>2025-12-15T13:42:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583921477613502499" data-draft-id="7583903159774101519" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•å®ç°æµå¼è¾“å‡ºï¼Ÿä¸€ç¯‡æ–‡ç« æ‰‹æŠŠæ‰‹æ•™ä½ ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-15T13:42:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‰­ç "/> <meta itemprop="url" content="https://juejin.cn/user/3349589831715801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•å®ç°æµå¼è¾“å‡ºï¼Ÿä¸€ç¯‡æ–‡ç« æ‰‹æŠŠæ‰‹æ•™ä½ ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3349589831715801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‰­ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T13:42:59.000Z" title="Mon Dec 15 2025 13:42:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ä»£ç githubä»“åº“åœ°å€â€”â€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FObjecteee%2FaiKnowedge" target="_blank" title="https://github.com/Objecteee/aiKnowedge" ref="nofollow noopener noreferrer">github.com/Objecteee/aâ€¦</a></p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯æµå¼è¾“å‡ºï¼Ÿ</h2>
<p>æµå¼è¾“å‡ºæ˜¯ä¸€ç§<strong>æ•°æ®ä¼ è¾“æ¨¡å¼</strong>ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ•°æ®ä¸æ˜¯ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„ã€å•ä¸€çš„åŒ…è£¹åœ¨ä¸€æ¬¡å“åº”ä¸­å‘é€ç»™å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯è¢«åˆ†æˆè®¸å¤šå°çš„<strong>æ•°æ®å— (chunks)</strong> ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„åŒæ—¶ï¼Œ<strong>æŒç»­ä¸æ–­ã€é€å—åœ°</strong>æ¨é€åˆ°å®¢æˆ·ç«¯ã€‚ä¾‹å¦‚ä¸‹é¢çš„Geminiå›ç­”è¿‡ç¨‹â€”â€”</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b098f41dc36644fb971483fa5a7e0dd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766412291&amp;x-signature=i7xZviKG%2BvYA1zYsFTtx6T1OaMY%3D" alt="GIF 2025-12-15 19-26-17.gif" width="50%" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æµå¼è¾“å‡ºï¼Ÿ</h2>
<p>æµå¼è¾“å‡ºçš„æ ¸å¿ƒä»·å€¼åœ¨äºæ”¹å˜äº†ç”¨æˆ·å¯¹<strong>å»¶è¿Ÿçš„æ„ŸçŸ¥</strong>ï¼Œå°†åŸæœ¬æ¼«é•¿çš„ç­‰å¾…è½¬åŒ–ä¸ºå³æ—¶çš„å†…å®¹æ¶ˆè´¹ã€‚</p>
<p><strong>1.æå¤§åœ°æå‡ç”¨æˆ·ä½“éªŒ (UX)ï¼š</strong></p>
<p>åœ¨ä¼ ç»Ÿçš„ <strong>è¯·æ±‚-å“åº”æ¨¡å‹</strong>ä¸­ï¼Œç”¨æˆ·å¿…é¡»ç­‰å¾…æœåŠ¡å™¨ç”Ÿæˆå¹¶è¿”å›<strong>å…¨éƒ¨æ•°æ®</strong>æ‰èƒ½çœ‹åˆ°ç»“æœã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª AI å›å¤å¯èƒ½éœ€è¦ 5-10 ç§’ã€‚</p>
<p>æµå¼è¾“å‡ºåˆ™å®ç°äº†å†…å®¹<strong>é€å—ã€é€å­—</strong>åˆ°è¾¾å’Œæ˜¾ç¤ºã€‚ç”¨æˆ·æ„ŸçŸ¥åˆ°çš„å»¶è¿Ÿä» <strong>â€œæ€»ç”Ÿæˆæ—¶é—´â€</strong> ç¼©çŸ­ä¸º <strong>â€œé¦–ä¸ªæ•°æ®å—åˆ°è¾¾æ—¶é—´â€</strong> ã€‚è¿™ç§å®æ—¶åé¦ˆæœºåˆ¶è®©ç”¨æˆ·æ„Ÿè§‰ç¨‹åºåœ¨å³æ—¶å“åº”ï¼Œæ˜¾è‘—é™ä½äº†ç­‰å¾…çš„ç„¦è™‘æ„Ÿã€‚</p>
<p><strong>åœ¨ AI/LLM åœºæ™¯ä¸­ï¼Œ</strong> æµå¼è¾“å‡ºæ˜¯<strong>å¿…éœ€å“</strong>ï¼Œå®ƒå°†æ•°ç§’çš„æ¯ç‡¥ç­‰å¾…å˜æˆäº†æŒç»­çš„é˜…è¯»è¿‡ç¨‹ï¼Œæ˜¯ç”¨æˆ·ç•™å­˜å’Œäº§å“ä½“éªŒçš„åŸºçŸ³ã€‚</p>
<p><strong>2.æé«˜ç³»ç»Ÿå’Œç½‘ç»œæ•ˆç‡ï¼š</strong></p>
<p>æµå¼è¾“å‡ºæŠ€æœ¯ï¼ˆå°¤å…¶æ˜¯ <strong>SSE</strong> å’Œ <strong>WebSocket</strong>ï¼‰é€šè¿‡å»ºç«‹æŒä¹…è¿æ¥ï¼Œå‡å°‘äº†é‡å¤å»ºç«‹å’Œå…³é—­ HTTP è¿æ¥çš„å¼€é”€ã€‚
æ•°æ®ç”Ÿæˆå¤šå°‘æ¨é€å¤šå°‘ï¼Œç½‘ç»œå¸¦å®½å¾—åˆ°æ›´æœ‰æ•ˆçš„åˆ©ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡å¼‚æ­¥æˆ–é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æ—¶ï¼Œæ•ˆç‡ä¼˜åŠ¿æ›´ä¸ºæ˜æ˜¾ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œæµå¼è¾“å‡ºçš„é‡è¦æ€§åœ¨äºï¼šå®ƒæŠŠ <strong>â€œç­‰å¾…â€</strong> å˜æˆäº† <strong>â€œæ¶ˆè´¹â€</strong> ï¼Œæ˜¯ç°ä»£äº¤äº’å¼åº”ç”¨å’Œå®æ—¶æ•°æ®å¹³å°çš„<strong>æ ‡é…</strong>ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ä¸»æµçš„æµå¼è¾“å‡ºå®ç°</h2>
<p>æµå¼è¾“å‡ºä¸»è¦æœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œç¬¬ä¸€ç§æ˜¯SSEï¼ˆåŸºäºHTTPï¼‰çš„å•å‘æµå¼è¾“å‡ºï¼›ç¬¬äºŒç§æ˜¯åŸºäºWebSocketçš„åŒå‘æµå¼è¾“å‡ºã€‚</p>
<h3 data-id="heading-3">1.åŸºäºSSEçš„å•å‘æµå¼è¾“å‡º</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be674caa94c545a1bd70bb6008a9e46e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766412291&amp;x-signature=KZJnx9Y1OdAp4i%2FmPomM7K3sEV8%3D" alt="GIF 2025-12-15 22-02-13.gif" loading="lazy"/></p>
<h4 data-id="heading-4">ï¼ˆ1ï¼‰åç«¯å®ç°</h4>
<p>SSE æµå¼è¾“å‡ºçš„åç«¯ä»£ç æ˜¯æœ‰<strong>å›ºå®šçš„æ ¼å¼å’Œä¸¥æ ¼çš„è¦æ±‚</strong>ã€‚è¿™ç§æ ¼å¼æ˜¯ <strong>Server-Sent Events è§„èŒƒ</strong>çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯å®¢æˆ·ç«¯æµè§ˆå™¨èƒ½å¤Ÿæ­£ç¡®è§£ææµçš„å…³é”®ã€‚</p>
<h5 data-id="heading-5">A. åŸºç¡€æ ¼å¼</h5>
<p>è¿™æ˜¯æœ€å¸¸ç”¨ã€æœ€æ ¸å¿ƒçš„æ ¼å¼ï¼Œç”¨äºä¼ è¾“æ•°æ®å—ã€‚</p>























<table><thead><tr><th><strong>å­—æ®µ</strong></th><th><strong>æ ¼å¼</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><strong>Data</strong></td><td><code>data: [å†…å®¹]</code></td><td>åŒ…å«è¦å‘é€çš„å®é™…æ•°æ®ã€‚å®¢æˆ·ç«¯ <code>event.data</code> æ¥æ”¶åˆ°çš„å°±æ˜¯ <code>:</code> åé¢çš„å†…å®¹ã€‚</td><td><code>data: Hello world\n\n</code></td></tr><tr><td><strong>åˆ†éš”ç¬¦</strong></td><td><code>\n\n</code></td><td><strong>è‡³å…³é‡è¦ï¼</strong> å¿…é¡»ä»¥ä¸¤ä¸ªæ¢è¡Œç¬¦æ ‡è®°ä¸€ä¸ªäº‹ä»¶å—çš„ç»“æŸã€‚</td><td/></tr></tbody></table>
<h5 data-id="heading-6">B. å®Œæ•´æ ¼å¼</h5>
<p>SSE è§„èŒƒè¿˜å…è®¸å…¶ä»–å¯é€‰å­—æ®µï¼Œç”¨äºæ›´å¤æ‚çš„æµæ§åˆ¶ï¼š</p>





























<table><thead><tr><th><strong>å­—æ®µ</strong></th><th><strong>æ ¼å¼</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><strong>Event</strong></td><td><code>event: [äº‹ä»¶å]</code></td><td>å…è®¸å‘é€ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ <code>eventSource.addEventListener('äº‹ä»¶å', ...)</code> ç›‘å¬ã€‚</td><td><code>event: update\n</code></td></tr><tr><td><strong>ID</strong></td><td><code>id: [å”¯ä¸€æ ‡è¯†]</code></td><td>å…è®¸ä¸ºæ¯ä¸ªäº‹ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€ IDã€‚å¦‚æœå®¢æˆ·ç«¯æ–­çº¿é‡è¿ï¼Œå®ƒä¼šå‘é€ <code>Last-Event-ID</code>ï¼ŒæœåŠ¡å™¨å¯ä»¥ä»è¯¥ ID æ¢å¤æ¨é€ã€‚</td><td><code>id: 12345\n</code></td></tr><tr><td><strong>Retry</strong></td><td><code>retry: [æ¯«ç§’æ•°]</code></td><td><strong>å…¨å±€è®¾ç½®ã€‚</strong> å®¢æˆ·ç«¯æ–­å¼€è¿æ¥åï¼Œæµè§ˆå™¨ç­‰å¾…è¯¥æ¯«ç§’æ•°åå†å°è¯•é‡è¿ã€‚</td><td><code>retry: 10000\n\n</code></td></tr></tbody></table>
<p><strong>ä¸€ä¸ªåŒ…å«æ‰€æœ‰å­—æ®µçš„å®Œæ•´äº‹ä»¶å—ç¤ºä¾‹å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">event:</span> system-update
<span class="hljs-symbol">id:</span> <span class="hljs-number">999</span>
<span class="hljs-symbol">retry:</span> <span class="hljs-number">5000</span>
<span class="hljs-symbol">data:</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>, <span class="hljs-string">"progress"</span>: <span class="hljs-number">80</span>}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> å³ä½¿ä½¿ç”¨äº†å¤šä¸ªå­—æ®µï¼Œ<strong>æœ€åä¹Ÿå¿…é¡»ä»¥ <code>\n\n</code> ç»“æŸ</strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = <span class="hljs-number">3000</span>;

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/stream-sse'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-comment">// ------------------------------------------------------------------</span>
    <span class="hljs-comment">// A. å›ºå®šçš„ HTTP å“åº”å¤´è®¾ç½® (å…³é”®!)</span>
    <span class="hljs-comment">// ------------------------------------------------------------------</span>
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/event-stream'</span>);
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>);
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Connection'</span>, <span class="hljs-string">'keep-alive'</span>);
    <span class="hljs-comment">// å…è®¸è·¨åŸŸè®¿é—®</span>
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, <span class="hljs-string">'*'</span>); 

    <span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®æ–­çº¿é‡è¿æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰</span>
    <span class="hljs-comment">// res.write('retry: 5000\n\n'); </span>

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- SSE Connection Established ---'</span>);

    <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®æµå¼ç”Ÿæˆ</span>
    <span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> intervalId = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">if</span> (counter &gt;= <span class="hljs-number">8</span>) {
            <span class="hljs-comment">// 4. ç»“æŸæµï¼šå‘é€ [DONE] æ ‡è®°ï¼ˆå¸¸è§å®è·µï¼‰å¹¶å…³é—­è¿æ¥</span>
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">'data: [DONE]\n\n'</span>);
            res.<span class="hljs-title function_">end</span>();
            <span class="hljs-built_in">clearInterval</span>(intervalId);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- SSE Stream Ended ---'</span>);
            <span class="hljs-keyword">return</span>;
        }

        counter++;
        <span class="hljs-keyword">const</span> payload = <span class="hljs-string">`è¿™æ˜¯ç¬¬ <span class="hljs-subst">${counter}</span> å—æ•°æ®ï¼Œæ—¶é—´ï¼š<span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString()}</span>`</span>;
        
        <span class="hljs-comment">// ------------------------------------------------------------------</span>
        <span class="hljs-comment">// B. å›ºå®šçš„æ•°æ®ä½“æ ¼å¼ (ä¸¥æ ¼è¦æ±‚!)</span>
        <span class="hljs-comment">// ------------------------------------------------------------------</span>
        <span class="hljs-keyword">const</span> sseData = 
        <span class="hljs-comment">// 1. data å­—æ®µï¼šå¿…é¡»ä»¥ "data: " å¼€å¤´</span>
        <span class="hljs-string">`data: <span class="hljs-subst">${payload}</span>\n`</span> + 
        <span class="hljs-comment">// 2. ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼šå¿…é¡»ä»¥ "\n\n" ç»“å°¾ï¼Œæ ‡å¿—ä¸€ä¸ªäº‹ä»¶çš„ç»“æŸ</span>
        <span class="hljs-string">`\n`</span>; 

        <span class="hljs-comment">// 3. å®æ—¶å†™å…¥æ•°æ®åˆ°å“åº”æµ</span>
        res.<span class="hljs-title function_">write</span>(sseData);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Pushed: <span class="hljs-subst">${payload}</span>`</span>);

    }, <span class="hljs-number">1500</span>); <span class="hljs-comment">// æ¯ 1.5 ç§’æ¨é€ä¸€æ¬¡</span>

    <span class="hljs-comment">// å¤„ç†å®¢æˆ·ç«¯æ–­å¼€è¿æ¥çš„æ¸…ç†å·¥ä½œ</span>
    req.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">clearInterval</span>(intervalId);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Client closed connection.'</span>);
    });
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`SSE Server running on http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
</code></pre>
<ol>
<li><strong>è®¾ç½®æ­£ç¡®çš„ Headerï¼š</strong> å¿…é¡»è®¾ç½® <code>Content-Type: text/event-stream</code>ã€‚</li>
<li><strong>å®æ—¶å†™å…¥ï¼š</strong> ä½¿ç”¨ Node.js çš„ <code>res.write()</code> æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ•°æ®å…¨éƒ¨æ”¶é›†å®Œæ¯•åä½¿ç”¨ <code>res.send()</code>ã€‚<code>res.send()</code> ä¼šå°è¯•å…³é—­è¿æ¥ï¼Œä¸é€‚ç”¨äºæµå¼è¾“å‡ºã€‚</li>
<li><strong>éµå®ˆ <code>data: ...\n\n</code> æ ¼å¼ï¼š</strong> ä»»ä½•åç¦»è¿™ä¸ªæ ¼å¼çš„è¾“å‡ºéƒ½å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯ <code>EventSource</code> æ— æ³•æ­£ç¡®è§¦å‘ <code>onmessage</code> äº‹ä»¶ã€‚</li>
<li><strong>è¿æ¥æ¸…ç†ï¼š</strong> ç›‘å¬ <code>req.on('close', ...)</code> äº‹ä»¶ï¼Œç¡®ä¿åœ¨å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨èƒ½åœæ­¢ä¸å¿…è¦çš„å®šæ—¶å™¨æˆ–èµ„æºå ç”¨ã€‚</li>
</ol>
<h4 data-id="heading-7">ï¼ˆ2ï¼‰å‰ç«¯å®ç°</h4>
<h5 data-id="heading-8">A.æµè§ˆå™¨åŸç”Ÿå®ç°ï¼ˆEventSourceï¼‰</h5>
<p><code>EventSource</code> æ˜¯æµè§ˆå™¨ä¸“ä¸º SSE è§„èŒƒè®¾è®¡çš„é«˜çº§ APIã€‚å®ƒè‡ªåŠ¨å¤„ç†äº†åº•å±‚ HTTP è¿æ¥ã€æ•°æ®æ ¼å¼è§£æã€äº‹ä»¶è§¦å‘ï¼Œä»¥åŠæ–­çº¿é‡è¿ç­‰æ‰€æœ‰å¤æ‚é€»è¾‘ã€‚</p>
<h6 data-id="heading-9">ä¼˜åŠ¿</h6>
<ul>
<li><strong>æœ€ç®€æ´ï¼š</strong> åªéœ€è¦å‡ è¡Œä»£ç å³å¯å¼€å§‹ç›‘å¬æµã€‚</li>
<li><strong>å¯é æ€§é«˜ï¼š</strong> å†…ç½®è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼Œéå¸¸å¥å£®ã€‚</li>
<li><strong>æ— éœ€æ‰‹åŠ¨è§£æï¼š</strong> è‡ªåŠ¨å°† <code>data:</code> å­—æ®µçš„å†…å®¹æå–å‡ºæ¥ï¼Œä½œä¸º <code>event.data</code>ã€‚</li>
</ul>
<h6 data-id="heading-10">å±€é™æ€§</h6>
<ul>
<li><strong>åªèƒ½ GET è¯·æ±‚ã€‚</strong></li>
<li><strong>ä¸æ”¯æŒè‡ªå®šä¹‰ Headerï¼š</strong> æ— æ³•åœ¨è¯·æ±‚å¤´ä¸­ä¼ é€’ Tokenï¼ˆåªèƒ½é€šè¿‡ URL query å‚æ•°ï¼‰ã€‚</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>EventSource å®¢æˆ·ç«¯ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Segoe UI'</span>, Tahoma, Geneva, Verdana, sans-serif; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
        <span class="hljs-selector-tag">h1</span> { <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>; }
        <span class="hljs-selector-id">#status</span> { <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span>; <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>; }
        <span class="hljs-selector-class">.status-connecting</span> { <span class="hljs-attribute">color</span>: orange; <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff3e0</span>; }
        <span class="hljs-selector-class">.status-open</span> { <span class="hljs-attribute">color</span>: green; <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#e8f5e9</span>; }
        <span class="hljs-selector-class">.status-closed</span> { <span class="hljs-attribute">color</span>: red; <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffebee</span>; }
        <span class="hljs-selector-id">#output-area</span> { 
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>; 
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>; 
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">150px</span>; 
            <span class="hljs-attribute">white-space</span>: pre-wrap; <span class="hljs-comment">/* ä¿æŒæ¢è¡Œå’Œç©ºæ ¼ */</span>
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fcfcfc</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
        }
        <span class="hljs-selector-class">.chunk</span> { <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">5px</span>; <span class="hljs-attribute">color</span>: <span class="hljs-number">#00796b</span>; }
        <span class="hljs-selector-class">.divider</span> { <span class="hljs-attribute">color</span>: <span class="hljs-number">#bdbdbd</span>; }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>EventSource å®æ—¶æµæ¥æ”¶ç«¯<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-connecting"</span>&gt;</span>è¿æ¥çŠ¶æ€: æ­£åœ¨åˆå§‹åŒ–...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ¥æ”¶åˆ°çš„æ¶ˆæ¯æµ:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-area"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"closeStream()"</span>&gt;</span>ğŸ›‘ åœæ­¢æ¥æ”¶æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// è¯·ç¡®ä¿è¿™é‡Œçš„ URL ä¸æ‚¨çš„ Node.js åç«¯ SSE è·¯ç”±åŒ¹é…</span>
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STREAM_URL</span> = <span class="hljs-string">'http://localhost:3000/api/stream-sse'</span>; 
        
        <span class="hljs-keyword">const</span> statusElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status'</span>);
        <span class="hljs-keyword">const</span> outputElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-area'</span>);
        
        <span class="hljs-keyword">let</span> eventSource;

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">text, className</span>) {
            statusElement.<span class="hljs-property">textContent</span> = text;
            statusElement.<span class="hljs-property">className</span> = <span class="hljs-string">''</span>;
            statusElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(className);
        }

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">initializeSSE</span>(<span class="hljs-params"/>) {
            outputElement.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>; <span class="hljs-comment">// æ¸…ç©ºæ—§å†…å®¹</span>
            
            <span class="hljs-comment">// 1. åˆ›å»º EventSource å®ä¾‹å¹¶å»ºç«‹è¿æ¥</span>
            eventSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(<span class="hljs-variable constant_">STREAM_URL</span>);
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: æ­£åœ¨è¿æ¥...'</span>, <span class="hljs-string">'status-connecting'</span>);

            <span class="hljs-comment">// 2. ç›‘å¬è¿æ¥æ‰“å¼€äº‹ä»¶</span>
            eventSource.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âœ… å·²å»ºç«‹'</span>, <span class="hljs-string">'status-open'</span>);
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SSE connection opened successfully.'</span>);
            };

            <span class="hljs-comment">// 3. ç›‘å¬æ¥æ”¶åˆ°æ•°æ®äº‹ä»¶ (æ ¸å¿ƒé€»è¾‘)</span>
            eventSource.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
                <span class="hljs-keyword">const</span> chunk = event.<span class="hljs-property">data</span>;
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Received chunk:'</span>, chunk);

                <span class="hljs-comment">// æ£€æŸ¥ç»“æŸæ ‡è®°ï¼ˆä¸åç«¯å®šä¹‰çš„ "[DONE]" åŒ¹é…ï¼‰</span>
                <span class="hljs-keyword">if</span> (chunk === <span class="hljs-string">'[DONE]'</span>) {
                    eventSource.<span class="hljs-title function_">close</span>();
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸŸ¢ æµå·²å®Œæˆå¹¶å…³é—­'</span>, <span class="hljs-string">'status-closed'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Stream finished and closed by server.'</span>);
                    <span class="hljs-keyword">return</span>;
                }

                <span class="hljs-comment">// å®æ—¶è¿½åŠ æ•°æ®åˆ° UI</span>
                <span class="hljs-comment">// ä½¿ç”¨ innerHTML è¿½åŠ ï¼Œå¯ä»¥å®ç°æ›´ä¸°å¯Œçš„æ ·å¼</span>
                outputElement.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">`&lt;span class="chunk"&gt;<span class="hljs-subst">${chunk}</span>&lt;/span&gt;&lt;span class="divider"&gt; | &lt;/span&gt;`</span>;

                <span class="hljs-comment">// ç¡®ä¿æ»šåŠ¨åˆ°åº•éƒ¨ä»¥æŸ¥çœ‹æœ€æ–°å†…å®¹</span>
                outputElement.<span class="hljs-property">scrollTop</span> = outputElement.<span class="hljs-property">scrollHeight</span>;
            };

            <span class="hljs-comment">// 4. ç›‘å¬é”™è¯¯äº‹ä»¶ï¼ˆå¤„ç†æ–­çº¿ç­‰ï¼‰</span>
            eventSource.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'EventSource encountered an error:'</span>, error);
                
                <span class="hljs-keyword">if</span> (eventSource.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">EventSource</span>.<span class="hljs-property">CLOSED</span>) {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âŒ å·²å…³é—­æˆ–æ–­å¼€'</span>, <span class="hljs-string">'status-closed'</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// EventSource é»˜è®¤ä¼šå°è¯•è‡ªåŠ¨é‡è¿</span>
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âš ï¸ å‘ç”Ÿé”™è¯¯ï¼Œæ­£åœ¨å°è¯•é‡è¿...'</span>, <span class="hljs-string">'status-connecting'</span>);
                }
            };
        }

        <span class="hljs-comment">// 5. å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­æµçš„å‡½æ•°</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">closeStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (eventSource &amp;&amp; eventSource.<span class="hljs-property">readyState</span> !== <span class="hljs-title class_">EventSource</span>.<span class="hljs-property">CLOSED</span>) {
                eventSource.<span class="hljs-title function_">close</span>();
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸ›‘ ç”¨æˆ·æ‰‹åŠ¨å…³é—­'</span>, <span class="hljs-string">'status-closed'</span>);
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'User manually closed the stream.'</span>);
            }
        }

        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåç«‹å³å¯åŠ¨ SSE</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = initializeSSE;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 data-id="heading-11">é˜¶æ®µä¸€ï¼šè¿æ¥åˆå§‹åŒ–ä¸å»ºç«‹</h5>
<p>æ­¤é˜¶æ®µæ—¨åœ¨å»ºç«‹ä¸€ä¸ªæŒä¹…åŒ–çš„ HTTP è¿æ¥ï¼Œå¹¶å¼€å§‹ç›‘å¬ã€‚</p>





























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>æ ¸å¿ƒä»£ç </strong></th><th><strong>å…³é”®ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>1. åˆ›å»º <code>EventSource</code> å®ä¾‹</strong></td><td>ä½¿ç”¨ <code>EventSource</code> æ„é€ å‡½æ•°ä¼ å…¥ SSE æ¥å£ URLï¼Œå‘æœåŠ¡å™¨å‘èµ·è¿æ¥è¯·æ±‚ã€‚</td><td><code>const es = new EventSource(url);</code></td><td><strong>æµè§ˆå™¨è‡ªåŠ¨å¤„ç†</strong> åº•å±‚ HTTP GET è¯·æ±‚ã€‚</td></tr><tr><td><strong>2. ç›‘å¬è¿æ¥æ‰“å¼€</strong></td><td>ç›‘å¬ <code>onopen</code> äº‹ä»¶ï¼Œç¡®è®¤ä¸æœåŠ¡å™¨çš„è¿æ¥å·²æˆåŠŸå»ºç«‹ã€‚</td><td><code>es.onopen = () =&gt; { ... }</code></td><td>æ­¤æ—¶æµå¼æ•°æ®ä¼ è¾“é€šé“å·²æ‰“å¼€ã€‚</td></tr><tr><td><strong>3. æ›´æ–° UI çŠ¶æ€</strong></td><td>åœ¨ <code>onopen</code> ä¸­ï¼Œæ›´æ–°ç•Œé¢çŠ¶æ€ï¼Œæç¤ºç”¨æˆ·æ•°æ®æµå·²å¼€å§‹ã€‚</td><td><code>setStatus('å·²è¿æ¥');</code></td><td>æå‡ç”¨æˆ·ä½“éªŒã€‚</td></tr></tbody></table>
<h5 data-id="heading-12">é˜¶æ®µäºŒï¼šæ•°æ®æ¥æ”¶ä¸å¤„ç†ï¼ˆæ ¸å¿ƒï¼‰</h5>
<p>æ­¤é˜¶æ®µæ˜¯æŒç»­æ¥æ”¶æœåŠ¡å™¨æ¨é€çš„æ•°æ®ï¼Œå¹¶å®æ—¶æ›´æ–° UIã€‚</p>





























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>æ ¸å¿ƒä»£ç </strong></th><th><strong>å…³é”®ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>4. ç›‘å¬æ¶ˆæ¯äº‹ä»¶</strong></td><td>ç›‘å¬ <code>onmessage</code> äº‹ä»¶ã€‚æ¯å½“æœåŠ¡å™¨æ¨é€ä¸€ä¸ªå®Œæ•´çš„ <code>data:...\n\n</code> äº‹ä»¶å—æ—¶ï¼Œæ­¤å›è°ƒå‡½æ•°å°±ä¼šè§¦å‘ã€‚</td><td><code>es.onmessage = (event) =&gt; { ... }</code></td><td><strong><code>event.data</code></strong> åŒ…å«äº†æœåŠ¡å™¨æ¨é€çš„å®é™…å†…å®¹ã€‚</td></tr><tr><td><strong>5. å®æ—¶æ•°æ®è¿½åŠ </strong></td><td>å°†æ¥æ”¶åˆ°çš„æ•°æ® (<code>event.data</code>) <strong>è¿½åŠ </strong>åˆ°å½“å‰å±•ç¤ºçš„æ–‡æœ¬æœ«å°¾ï¼ˆè€Œä¸æ˜¯æ›¿æ¢ï¼‰ã€‚</td><td><code>currentMsg += event.data;</code></td><td>è¿™æ˜¯å®ç°â€œæ‰“å­—æœºâ€æ•ˆæœçš„å…³é”®ã€‚</td></tr><tr><td><strong>6. å¤„ç†è‡ªå®šä¹‰äº‹ä»¶</strong></td><td>å¦‚æœåç«¯ä½¿ç”¨äº† <code>event: [name]</code> å­—æ®µï¼Œå‰ç«¯å¯ä»¥é€šè¿‡ <code>es.addEventListener('name', callback)</code> é’ˆå¯¹æ€§åœ°å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ã€‚</td><td><code>es.addEventListener('update', ...)</code></td><td>é€‚ç”¨äºéœ€è¦åŒºåˆ†ä¸åŒä¸šåŠ¡ç±»å‹æ•°æ®çš„åœºæ™¯ã€‚</td></tr></tbody></table>
<h5 data-id="heading-13">é˜¶æ®µä¸‰ï¼šè¿æ¥ç»´æŠ¤ã€å…³é—­ä¸é”™è¯¯å¤„ç†</h5>
<p>æ­¤é˜¶æ®µå¤„ç†æµçš„æ­£å¸¸ç»“æŸã€ç½‘ç»œé”™è¯¯å’Œé‡è¯•é€»è¾‘ã€‚</p>





























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>æ ¸å¿ƒä»£ç </strong></th><th><strong>å…³é”®ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>7. ç›‘å¬æµç»“æŸæ ‡è®°</strong></td><td>æ ¹æ®ä¸åç«¯çº¦å®šçš„ç»“æŸæ ‡è®°ï¼ˆå¦‚ <code>[DONE]</code>ï¼‰ï¼Œåˆ¤æ–­æµæ˜¯å¦å®Œæˆã€‚</td><td><code>if (event.data === '[DONE]') { ... }</code></td><td><strong>æµçš„æ­£å¸¸ç»“æŸï¼Œ</strong> é¿å…æ— é™ç­‰å¾…ã€‚</td></tr><tr><td><strong>8. å…³é—­è¿æ¥</strong></td><td>å½“æµç»“æŸæˆ–ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»â€œåœæ­¢â€æŒ‰é’®æ—¶ï¼Œä¸»åŠ¨è°ƒç”¨ <code>close()</code> æ–¹æ³•ã€‚</td><td><code>es.close();</code></td><td>é‡Šæ”¾å®¢æˆ·ç«¯èµ„æºã€‚</td></tr><tr><td><strong>9. ç›‘å¬é”™è¯¯ä¸é‡è¿</strong></td><td>ç›‘å¬ <code>onerror</code> äº‹ä»¶ã€‚å½“è¿æ¥å‡ºé”™æ—¶ï¼Œæµè§ˆå™¨ä¼šæ ¹æ®æœåŠ¡å™¨è®¾ç½®çš„ <code>retry:</code> æ—¶é—´é—´éš”è‡ªåŠ¨å°è¯•é‡è¿ã€‚</td><td><code>es.onerror = (error) =&gt; { ... }</code></td><td><strong>è‡ªåŠ¨é‡è¯•</strong> æ˜¯ SSE ç›¸æ¯”äºæ‰‹åŠ¨ <code>fetch</code> çš„å·¨å¤§ä¼˜åŠ¿ã€‚</td></tr></tbody></table>
<h5 data-id="heading-14">B.Fetch APIå®ç°</h5>
<p>å½“éœ€è¦æ›´å¼ºå¤§çš„æ§åˆ¶åŠ›ã€è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼Œæˆ–å¤„ç†éæ ‡å‡† SSE æ ¼å¼çš„æµæ—¶ï¼Œ<code>fetch</code> æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p>
<p>åˆ©ç”¨ <code>fetch</code> è¿”å›çš„ <code>response.body</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ª <strong><code>ReadableStream</code></strong> å¯¹è±¡ã€‚å¼€å‘è€…éœ€è¦è·å–è¿™ä¸ªæµçš„ <strong>Reader</strong>ï¼Œè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œ<strong>æ‰‹åŠ¨</strong>è¯»å–æ•°æ®å—ã€è§£ç ï¼Œå¹¶æ ¹æ® <code>\n\n</code> è§„åˆ™<strong>æ‰‹åŠ¨è§£æ</strong> SSE æ ¼å¼ã€‚</p>
<h6 data-id="heading-15">ä¼˜åŠ¿</h6>
<ul>
<li><strong>æ§åˆ¶åŠ›å¼ºï¼š</strong> å¯ä»¥å‘é€ POSTã€PUT ç­‰è¯·æ±‚ï¼Œå¹¶è®¾ç½®è‡ªå®šä¹‰ Headerï¼ˆç”¨äºé‰´æƒï¼‰ã€‚</li>
<li><strong>é€šç”¨æ€§ï¼š</strong> å¯ä»¥å¤„ç†ä»»ä½•åŸºäº HTTP çš„æµå¼æ•°æ®ï¼Œä¸é™äº SSE æ ¼å¼ã€‚</li>
<li><strong>æ–°æ ‡å‡†ï¼š</strong> ç¬¦åˆç°ä»£ Web æ ‡å‡†ï¼Œæµè§ˆå™¨æ”¯æŒè‰¯å¥½ã€‚</li>
</ul>
<h6 data-id="heading-16">æŒ‘æˆ˜</h6>
<ul>
<li><strong>å®ç°å¤æ‚ï¼š</strong> éœ€è¦æ‰‹åŠ¨ç¼–å†™æ•°æ®è§£æå’Œé”™è¯¯é‡è¿çš„ä»£ç ã€‚</li>
<li><strong>æ€§èƒ½è€ƒé‡ï¼š</strong> é¢‘ç¹çš„å¾ªç¯è¯»å–å’Œå­—ç¬¦ä¸²æ‹¼æ¥/è§£ç æ“ä½œéœ€è¦è°¨æ…ä¼˜åŒ–ã€‚</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Fetch API SSE å®¢æˆ·ç«¯ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Segoe UI'</span>, Tahoma, Geneva, Verdana, sans-serif; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
        <span class="hljs-selector-id">#status</span> { <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>; <span class="hljs-attribute">color</span>: orange; }
        <span class="hljs-selector-id">#output-area</span> { 
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>; 
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>; 
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">150px</span>; 
            <span class="hljs-attribute">white-space</span>: pre-wrap;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fcfcfc</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ”— Fetch API æ¨¡æ‹Ÿ SSE æ¥æ”¶ç«¯<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status"</span>&gt;</span>è¿æ¥çŠ¶æ€: å¾…å¯åŠ¨<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ¥æ”¶åˆ°çš„æ¶ˆæ¯æµ:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-area"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"startStream()"</span>&gt;</span>â–¶ï¸ å¯åŠ¨æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"stopStream()"</span>&gt;</span>ğŸ›‘ åœæ­¢æ¥æ”¶æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STREAM_URL</span> = <span class="hljs-string">'http://localhost:3000/api/stream-sse'</span>; <span class="hljs-comment">// ç¡®ä¿ URL æ­£ç¡®</span>
        
        <span class="hljs-keyword">const</span> statusElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status'</span>);
        <span class="hljs-keyword">const</span> outputElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-area'</span>);
        
        <span class="hljs-keyword">let</span> controller = <span class="hljs-literal">null</span>; <span class="hljs-comment">// ç”¨äºæ§åˆ¶è¯·æ±‚ä¸­æ­¢ (AbortController)</span>

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">text, color</span>) {
            statusElement.<span class="hljs-property">textContent</span> = text;
            statusElement.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = color;
        }

        <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (controller) <span class="hljs-title function_">stopStream</span>(); <span class="hljs-comment">// ç¡®ä¿å‰ä¸€ä¸ªæµå·²åœæ­¢</span>

            controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
            <span class="hljs-keyword">const</span> signal = controller.<span class="hljs-property">signal</span>;
            <span class="hljs-keyword">let</span> textDecoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>(<span class="hljs-string">'utf-8'</span>);
            <span class="hljs-keyword">let</span> buffer = <span class="hljs-string">''</span>; <span class="hljs-comment">// ç¼“å†²åŒºï¼Œç”¨äºå­˜å‚¨ä¸å®Œæ•´çš„äº‹ä»¶å—</span>

            outputElement.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: æ­£åœ¨è¿æ¥...'</span>, <span class="hljs-string">'orange'</span>);

            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// 1. å‘èµ· Fetch è¯·æ±‚ï¼Œè®¾ç½® signal ç”¨äºä¸­æ­¢</span>
                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">STREAM_URL</span>, {
                    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
                    <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'text/event-stream'</span> },
                    <span class="hljs-attr">signal</span>: signal 
                });

                <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">body</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"å“åº”ä½“ä¸æ˜¯ä¸€ä¸ªå¯è¯»æµã€‚"</span>);
                }

                <span class="hljs-comment">// 2. è·å– ReadableStream çš„ Reader</span>
                <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();

                <span class="hljs-comment">// 3. å¾ªç¯è¯»å–æµæ•°æ®</span>
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                    <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
                    
                    <span class="hljs-keyword">if</span> (done) {
                        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸŸ¢ æµå·²å®Œæˆ'</span>, <span class="hljs-string">'green'</span>);
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Stream finished.'</span>);
                        <span class="hljs-keyword">break</span>;
                    }

                    <span class="hljs-comment">// 4. è§£ç å­—èŠ‚æ•°æ®å¹¶è¿½åŠ åˆ°ç¼“å†²åŒº</span>
                    <span class="hljs-comment">// { stream: true } å…è®¸åœ¨æµç»§ç»­æ—¶è¿›è¡Œè§£ç </span>
                    buffer += textDecoder.<span class="hljs-title function_">decode</span>(value, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span> });

                    <span class="hljs-comment">// 5. æ‰‹åŠ¨è§£æ SSE æ¶ˆæ¯å—</span>
                    <span class="hljs-comment">// SSE æ¶ˆæ¯ä»¥ \n\n ç»“æŸï¼Œåˆ†å‰²ç¼“å†²åŒº</span>
                    <span class="hljs-keyword">let</span> messages = buffer.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n\n'</span>);
                    buffer = messages.<span class="hljs-title function_">pop</span>(); <span class="hljs-comment">// æœ€åä¸€ä¸ªä¸å®Œæ•´çš„å—ç•™åœ¨ç¼“å†²åŒº</span>

                    messages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {
                        <span class="hljs-keyword">if</span> (message) {
                            <span class="hljs-comment">// 6. æå– data: å­—æ®µå†…å®¹</span>
                            <span class="hljs-keyword">const</span> dataMatch = message.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/data: (.*)/</span>);
                            <span class="hljs-keyword">if</span> (dataMatch &amp;&amp; dataMatch[<span class="hljs-number">1</span>]) {
                                <span class="hljs-keyword">const</span> data = dataMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">trim</span>();

                                <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'[DONE]'</span>) {
                                    controller.<span class="hljs-title function_">abort</span>(); <span class="hljs-comment">// æ¥æ”¶åˆ°ç»“æŸæ ‡è®°ï¼Œä¸»åŠ¨ä¸­æ­¢è¯·æ±‚</span>
                                } <span class="hljs-keyword">else</span> {
                                    <span class="hljs-comment">// 7. å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®</span>
                                    outputElement.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">`&lt;span class="chunk"&gt;<span class="hljs-subst">${data}</span>&lt;/span&gt;&lt;span class="divider"&gt; | &lt;/span&gt;`</span>;
                                    outputElement.<span class="hljs-property">scrollTop</span> = outputElement.<span class="hljs-property">scrollHeight</span>;
                                }
                            }
                        }
                    });
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'AbortError'</span>) {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸ›‘ æµè¢«ç”¨æˆ·/DONEæ ‡è®°ä¸­æ­¢'</span>, <span class="hljs-string">'gray'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Fetch request aborted successfully.'</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">`è¿æ¥çŠ¶æ€: âŒ é”™è¯¯: <span class="hljs-subst">${error.message}</span>`</span>, <span class="hljs-string">'red'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Fetch SSE é”™è¯¯:'</span>, error);
                }
            }
        }

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">stopStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (controller) {
                controller.<span class="hljs-title function_">abort</span>();
                controller = <span class="hljs-literal">null</span>;
            }
        }
        
        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåï¼Œè®¾ç½®åˆå§‹çŠ¶æ€</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: å¾…å¯åŠ¨'</span>, <span class="hljs-string">'black'</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Fetch API å®ç°æµå¼è¾“å‡ºæ˜¯é«˜åº¦å¯å®šåˆ¶ä½†ç›¸å¯¹å¤æ‚çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œå®ƒè¦æ±‚å¼€å‘è€…<strong>æ‰‹åŠ¨å¤„ç†æ•°æ®çš„æ¥æ”¶ã€è§£ç å’Œ SSE æ ¼å¼çš„è§£æ</strong>ã€‚æ•´ä¸ªæµç¨‹å¯ä»¥æ¸…æ™°åœ°åˆ’åˆ†ä¸ºä¸‰ä¸ªä¸»è¦é˜¶æ®µã€‚</p>
<h3 data-id="heading-17">é˜¶æ®µä¸€ï¼šåˆå§‹åŒ–è¯·æ±‚ä¸å‡†å¤‡å·¥ä½œ</h3>
<p>æ­¤é˜¶æ®µçš„ç›®æ ‡æ˜¯å‘èµ·è¯·æ±‚å¹¶è®¾ç½®æµè¯»å–æ‰€éœ€çš„ç¯å¢ƒã€‚</p>






























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>å…³é”®æŠ€æœ¯ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>1. å‡†å¤‡æ§åˆ¶å™¨</strong></td><td>åˆ›å»º <code>AbortController</code> å®ä¾‹ã€‚ç”¨äºåœ¨æµç»“æŸæˆ–éœ€è¦ä¸­æ–­æ—¶ï¼Œèƒ½å¤Ÿ<strong>ä¸­æ­¢</strong> <code>fetch</code> è¯·æ±‚ã€‚</td><td><code>new AbortController()</code></td></tr><tr><td><strong>2. å‘èµ· Fetch è¯·æ±‚</strong></td><td>å‘èµ· <code>fetch</code> è¯·æ±‚ï¼Œå°† <code>controller.signal</code> é™„åŠ åˆ°è¯·æ±‚é…ç½®ä¸­ã€‚å¯åœ¨ <code>headers</code> ä¸­è®¾ç½®é‰´æƒä¿¡æ¯ã€‚</td><td><code>fetch(url, { signal: controller.signal, headers: {...} })</code></td></tr><tr><td><strong>3. è·å–æµè¯»å–å™¨</strong></td><td>æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ (<code>response.ok</code>)ï¼Œç„¶åé€šè¿‡ <code>response.body.getReader()</code> è·å– <strong><code>reader</code></strong> å¯¹è±¡ã€‚</td><td><code>response.body.getReader()</code></td></tr><tr><td><strong>4. å‡†å¤‡è§£ç å™¨ä¸ç¼“å†²åŒº</strong></td><td>å®ä¾‹åŒ– <code>TextDecoder</code> ç”¨äºå°†å­—èŠ‚è§£ç ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶åˆå§‹åŒ–ä¸€ä¸ª <strong><code>buffer</code></strong> å˜é‡ç”¨äºæš‚å­˜ä¸å®Œæ•´çš„æ•°æ®ç‰‡æ®µã€‚</td><td><code>new TextDecoder('utf-8')</code>, <code>let buffer = ''</code></td></tr></tbody></table>
<h3 data-id="heading-18">é˜¶æ®µäºŒï¼šå¾ªç¯è¯»å–ã€è§£ç ä¸è§£æï¼ˆæ ¸å¿ƒï¼‰</h3>
<p>æ­¤é˜¶æ®µæ˜¯æ•´ä¸ªæµç¨‹æœ€å¤æ‚çš„éƒ¨åˆ†ï¼Œéœ€è¦æŒç»­ä»æµä¸­æ‹‰å–æ•°æ®å¹¶æ‰‹åŠ¨è§£æ SSE æ ¼å¼ã€‚</p>













































<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>å…³é”®æŠ€æœ¯ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>5. å¯åŠ¨è¯»å–å¾ªç¯</strong></td><td>ä½¿ç”¨ <code>while (true)</code> æˆ–ç±»ä¼¼çš„å¾ªç¯ç»“æ„å¼€å§‹æŒç»­è¯»å–æ•°æ®ã€‚</td><td><code>while (true)</code></td></tr><tr><td><strong>6. è¯»å–æ•°æ®å—</strong></td><td>è°ƒç”¨ <code>await reader.read()</code>ã€‚å®ƒä¼šæš‚åœæ‰§è¡Œï¼Œç­‰å¾…æœåŠ¡å™¨æ¨é€æ–°çš„æ•°æ®å— (<code>value: Uint8Array</code>)ã€‚</td><td><code>const { done, value } = await reader.read()</code></td></tr><tr><td><strong>7. åˆ¤æ–­æµç»“æŸ</strong></td><td>æ£€æŸ¥ <code>done</code> å±æ€§ã€‚å¦‚æœä¸º <code>true</code>ï¼Œè·³å‡ºå¾ªç¯ï¼Œè¿›å…¥æ¸…ç†é˜¶æ®µã€‚</td><td><code>if (done) break;</code></td></tr><tr><td><strong>8. è§£ç ä¸ç¼“å†²</strong></td><td>ä½¿ç”¨ <code>TextDecoder</code> å°†åŸå§‹å­—èŠ‚ <code>value</code> è§£ç ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶<strong>è¿½åŠ </strong>åˆ°ç¼“å†²åŒº (<code>buffer</code>) ä¸­ã€‚</td><td><code>buffer += decoder.decode(value, { stream: true })</code></td></tr><tr><td><strong>9. æ‰‹åŠ¨è§£æ SSE</strong></td><td>ä½¿ç”¨ <code>buffer.split('\n\n')</code> å°†ç¼“å†²åŒºå†…å®¹åˆ†å‰²æˆæ½œåœ¨çš„ SSE æ¶ˆæ¯æ•°ç»„ã€‚ç„¶åå°†æ•°ç»„ä¸­<strong>æœ€åä¸€ä¸ªä¸å®Œæ•´çš„å—</strong>é‡æ–°æ”¾å›ç¼“å†²åŒºã€‚</td><td><code>buffer.split('\n\n')</code>, <code>buffer = messages.pop()</code></td></tr><tr><td><strong>10. æå–æ•°æ®</strong></td><td>éå†å…¶ä½™å®Œæ•´çš„æ¶ˆæ¯å—ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¦‚ <code>/data: (.*)/</code>ï¼‰æ‰‹åŠ¨æå– <strong><code>data:</code></strong> å­—æ®µåçš„å®é™…å†…å®¹ã€‚</td><td><code>message.match(/data: (.*)/)</code></td></tr><tr><td><strong>11. å®æ—¶å¤„ç†</strong></td><td>å°†æå–åˆ°çš„æ•°æ®è¿½åŠ åˆ° UI ç•Œé¢ï¼Œå¹¶æ‰§è¡Œæ‰€éœ€çš„ä¸šåŠ¡é€»è¾‘ã€‚</td><td>UI æ›´æ–°ã€æ»šåŠ¨åˆ°åº•éƒ¨</td></tr></tbody></table>
<h3 data-id="heading-19">é˜¶æ®µä¸‰ï¼šè¿æ¥æ¸…ç†ä¸é”™è¯¯å¤„ç†</h3>
<p>æ­¤é˜¶æ®µç¡®ä¿æµçš„æ­£ç¡®ç»ˆæ­¢å’Œèµ„æºé‡Šæ”¾ã€‚</p>

























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>å…³é”®æŠ€æœ¯ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>12. å¤„ç†ç»“æŸæ ‡è®°</strong></td><td>åœ¨æ•°æ®å¤„ç†é€»è¾‘ä¸­ï¼Œå¦‚æœæ£€æµ‹åˆ°æœåŠ¡å™¨æ¨é€çš„ç»“æŸæ ‡è®°ï¼ˆå¦‚ <code>[DONE]</code>ï¼‰ï¼Œåˆ™ç«‹å³è°ƒç”¨ <strong><code>controller.abort()</code></strong> ç»ˆæ­¢æµã€‚</td><td><code>controller.abort()</code></td></tr><tr><td><strong>13. é”™è¯¯æ•è·</strong></td><td>å°†æ•´ä¸ª <code>fetch</code> å’Œæµè¯»å–å¾ªç¯åŒ…è£¹åœ¨ <code>try...catch</code> å—ä¸­ã€‚æ•è·ç½‘ç»œé”™è¯¯å’Œå›  <code>controller.abort()</code> äº§ç”Ÿçš„ <code>AbortError</code>ã€‚</td><td><code>try...catch (error)</code></td></tr><tr><td><strong>14. é‡Šæ”¾èµ„æº</strong></td><td>æ— è®ºæ˜¯æ­£å¸¸ç»“æŸè¿˜æ˜¯å‡ºé”™ï¼Œç¡®ä¿æ‰€æœ‰ç›¸å…³èµ„æºï¼ˆå¦‚ <code>reader</code>ï¼‰å¾—åˆ°é‡Šæ”¾ã€‚</td><td><strong><code>AbortController</code></strong> è‡ªåŠ¨å¤„ç†äº†è¯·æ±‚çš„ç»ˆæ­¢ã€‚</td></tr></tbody></table>
<p>é€šè¿‡è¿™ç§æ‰‹åŠ¨æ§åˆ¶çš„æ–¹å¼ï¼ŒFetch API æä¾›äº†å¯¹æµçš„<strong>æœ€é«˜çº§åˆ«æ§åˆ¶</strong>ï¼Œä½†ä»£ä»·æ˜¯ä»£ç å®ç°æ›´ä¸ºå¤æ‚ï¼Œä¸”éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å¤„ç†è‡ªåŠ¨é‡è¿ç­‰å¥å£®æ€§æœºåˆ¶ã€‚</p>
<h5 data-id="heading-20">C.Axios APIå®ç°</h5>
<p>ä½¿ç”¨ <code>axios</code> å®ç°æµå¼è¾“å‡ºä¸»è¦ä¾èµ–å…¶é…ç½®é¡¹ï¼Œä½†åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹çš„è¡¨ç°ä¸å¦‚ <code>fetch</code> å’Œ <code>EventSource</code>ã€‚</p>
<p>åœ¨ <code>axios</code> çš„é…ç½®ä¸­ï¼Œéœ€è¦æ˜¾å¼è®¾ç½® <code>responseType: 'stream'</code>ã€‚åœ¨ <strong>Node.js</strong> ç¯å¢ƒä¸­ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ª Node.js çš„æµï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚ä½†åœ¨<strong>æµè§ˆå™¨ç¯å¢ƒ</strong>ä¸­ï¼Œ<code>axios</code> å¯¹æµçš„å°è£…ä¸å¦‚ <code>fetch</code> åŸç”Ÿã€‚</p>
<h6 data-id="heading-21">ä¼˜åŠ¿</h6>
<ul>
<li><strong>Node.js å‹å¥½ï¼š</strong> åœ¨ Node.js ç¯å¢ƒä¸­å¤„ç†æµå¼æ•°æ®å¾ˆæ–¹ä¾¿ã€‚</li>
<li><strong>ä»£ç ç»Ÿä¸€ï¼š</strong> å¦‚æœåº”ç”¨å¤§é‡ä¾èµ– <code>axios</code>ï¼Œå¯ä»¥é¿å…å¼•å…¥ <code>fetch</code>ã€‚</li>
</ul>
<h6 data-id="heading-22">æŒ‘æˆ˜</h6>
<ul>
<li><strong>æµè§ˆå™¨å…¼å®¹æ€§/ç¨³å®šæ€§ï¼š</strong> æµè§ˆå™¨ç«¯å¯¹ <code>axios</code> æµçš„ç¨³å®šæ”¯æŒä¸å¦‚ <code>fetch</code> å’Œ <code>EventSource</code>ã€‚</li>
<li><strong>è§£æä¾ç„¶éœ€è¦æ‰‹åŠ¨ï¼š</strong> åƒ <code>fetch</code> ä¸€æ ·ï¼Œæ‚¨ä»ç„¶éœ€è¦è·å–æµå¹¶æ‰‹åŠ¨è¿›è¡Œ SSE æ ¼å¼çš„è§£æå’Œè§£ç ã€‚</li>
<li><strong>æ½œåœ¨çš„å†…å­˜é—®é¢˜ï¼š</strong> å¦‚æœæµå¤„ç†ä¸å½“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ã€‚</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Axios å®¢æˆ·ç«¯æ¨¡æ‹Ÿ SSE ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Segoe UI'</span>, Tahoma, Geneva, Verdana, sans-serif; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
        <span class="hljs-selector-id">#status</span> { <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>; <span class="hljs-attribute">color</span>: orange; }
        <span class="hljs-selector-id">#output-area</span> { 
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>; 
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>; 
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">150px</span>; 
            <span class="hljs-attribute">white-space</span>: pre-wrap;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fcfcfc</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
        }
        <span class="hljs-selector-class">.chunk</span> { <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">5px</span>; <span class="hljs-attribute">color</span>: <span class="hljs-number">#00796b</span>; }
        <span class="hljs-selector-class">.divider</span> { <span class="hljs-attribute">color</span>: <span class="hljs-number">#bdbdbd</span>; }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ› ï¸ Axios æ¨¡æ‹Ÿ SSE æ¥æ”¶ç«¯<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status"</span>&gt;</span>è¿æ¥çŠ¶æ€: å¾…å¯åŠ¨<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ¥æ”¶åˆ°çš„æ¶ˆæ¯æµ:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-area"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"startStream()"</span>&gt;</span>â–¶ï¸ å¯åŠ¨æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"stopStream()"</span>&gt;</span>ğŸ›‘ åœæ­¢æ¥æ”¶æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STREAM_URL</span> = <span class="hljs-string">'http://localhost:3000/api/stream-sse'</span>;
        
        <span class="hljs-keyword">const</span> statusElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status'</span>);
        <span class="hljs-keyword">const</span> outputElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-area'</span>);
        
        <span class="hljs-keyword">let</span> cancelTokenSource = <span class="hljs-literal">null</span>; <span class="hljs-comment">// ç”¨äºå–æ¶ˆè¯·æ±‚çš„ Axios Token</span>
        <span class="hljs-keyword">let</span> lastProcessedIndex = <span class="hljs-number">0</span>;   <span class="hljs-comment">// è¿½è¸ªä¸Šæ¬¡å¤„ç†åˆ°çš„æ•°æ®ç´¢å¼•</span>
        <span class="hljs-keyword">let</span> buffer = <span class="hljs-string">''</span>;              <span class="hljs-comment">// ç”¨äºå­˜æ”¾ä¸å®Œæ•´çš„ SSE äº‹ä»¶å—</span>
        <span class="hljs-keyword">let</span> isConnected = <span class="hljs-literal">false</span>;      <span class="hljs-comment">// æ ‡è®°æ˜¯å¦å·²å»ºç«‹è¿æ¥</span>

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">text, color</span>) {
            statusElement.<span class="hljs-property">textContent</span> = text;
            statusElement.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = color;
        }

        <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (cancelTokenSource) <span class="hljs-title function_">stopStream</span>();

            cancelTokenSource = axios.<span class="hljs-property">CancelToken</span>.<span class="hljs-title function_">source</span>();
            lastProcessedIndex = <span class="hljs-number">0</span>;
            buffer = <span class="hljs-string">''</span>;
            isConnected = <span class="hljs-literal">false</span>;
            outputElement.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: æ­£åœ¨è¿æ¥...'</span>, <span class="hljs-string">'orange'</span>);

            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-variable constant_">STREAM_URL</span>, {
                    <span class="hljs-attr">responseType</span>: <span class="hljs-string">'text'</span>,
                    <span class="hljs-attr">cancelToken</span>: cancelTokenSource.<span class="hljs-property">token</span>,
                    <span class="hljs-attr">onDownloadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progressEvent</span>) =&gt;</span> {
                        <span class="hljs-keyword">let</span> xhr = progressEvent.<span class="hljs-property">currentTarget</span> || progressEvent.<span class="hljs-property">target</span>;
                        <span class="hljs-keyword">if</span> (progressEvent.<span class="hljs-property">event</span> &amp;&amp; progressEvent.<span class="hljs-property">event</span>.<span class="hljs-property">target</span>) {
                            xhr = progressEvent.<span class="hljs-property">event</span>.<span class="hljs-property">target</span>;
                        }
                        
                        <span class="hljs-keyword">if</span> (!xhr || <span class="hljs-keyword">typeof</span> xhr.<span class="hljs-property">responseText</span> === <span class="hljs-string">'undefined'</span>) {
                            <span class="hljs-keyword">return</span>;
                        }
                        
                        <span class="hljs-keyword">const</span> responseText = xhr.<span class="hljs-property">responseText</span>;
                        <span class="hljs-keyword">const</span> newChunk = responseText.<span class="hljs-title function_">substring</span>(lastProcessedIndex);
                        lastProcessedIndex = responseText.<span class="hljs-property">length</span>;
                        buffer += newChunk;

                        <span class="hljs-comment">// æ”¶åˆ°æ•°æ®æ—¶æ›´æ–°è¿æ¥çŠ¶æ€</span>
                        <span class="hljs-keyword">if</span> (!isConnected &amp;&amp; newChunk.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
                            isConnected = <span class="hljs-literal">true</span>;
                            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âœ… å·²è¿æ¥ï¼Œæ­£åœ¨æ¥æ”¶æ•°æ®...'</span>, <span class="hljs-string">'green'</span>);
                        }

                        <span class="hljs-keyword">let</span> messages = buffer.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n\n'</span>);
                        buffer = messages.<span class="hljs-title function_">pop</span>() || <span class="hljs-string">''</span>;

                        messages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {
                            <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">trim</span>()) {
                                <span class="hljs-keyword">const</span> dataMatch = message.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/data: (.*)/</span>);
                                <span class="hljs-keyword">if</span> (dataMatch &amp;&amp; dataMatch[<span class="hljs-number">1</span>]) {
                                    <span class="hljs-keyword">const</span> data = dataMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">trim</span>();
                                    <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'[DONE]'</span>) {
                                        <span class="hljs-title function_">stopStream</span>(<span class="hljs-literal">true</span>);
                                    } <span class="hljs-keyword">else</span> {
                                        outputElement.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">`&lt;span class="chunk"&gt;<span class="hljs-subst">${data}</span>&lt;/span&gt;&lt;span class="divider"&gt; | &lt;/span&gt;`</span>;
                                        outputElement.<span class="hljs-property">scrollTop</span> = outputElement.<span class="hljs-property">scrollHeight</span>;
                                    }
                                }
                            }
                        });
                    }
                });
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (axios.<span class="hljs-title function_">isCancel</span>(error)) {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸ›‘ æµå·²ä¸­æ­¢'</span>, <span class="hljs-string">'gray'</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">`è¿æ¥çŠ¶æ€: âŒ é”™è¯¯: <span class="hljs-subst">${error.message}</span>`</span>, <span class="hljs-string">'red'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Axios SSE é”™è¯¯:'</span>, error);
                }
            }
        }

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">stopStream</span>(<span class="hljs-params">isDone = <span class="hljs-literal">false</span></span>) {
            <span class="hljs-keyword">if</span> (cancelTokenSource) {
                cancelTokenSource.<span class="hljs-title function_">cancel</span>(<span class="hljs-string">'Stream terminated.'</span>);
                cancelTokenSource = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">if</span> (isDone) {
                    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸŸ¢ æµå·²å®Œæˆå¹¶å…³é—­'</span>, <span class="hljs-string">'green'</span>);
                }
            }
        }
        
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: å¾…å¯åŠ¨'</span>, <span class="hljs-string">'black'</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Axios å¹¶éä¸º SSE è®¾è®¡çš„ï¼Œå› ä¸ºå®ƒåŸºäºä¼ ç»Ÿçš„ XMLHttpRequest (XHR) æ¨¡å‹ï¼Œæˆ–è€…åœ¨ Node.js ä¸­åŸºäº <code>http</code> æ¨¡å—ã€‚åœ¨<strong>æµè§ˆå™¨ç¯å¢ƒ</strong>ä¸­ï¼ŒAxios æ²¡æœ‰åŸç”Ÿ <code>EventSource</code> æˆ– <code>ReadableStream</code> çš„æ”¯æŒã€‚</p>
<p>å› æ­¤ï¼Œä½¿ç”¨ Axios å®ç°æµå¼è¾“å‡ºçš„<strong>æ ‡å‡†å·¥ä½œæµç¨‹</strong>æ˜¯åˆ©ç”¨ XHR çš„ <strong><code>onprogress</code></strong> äº‹ä»¶ç›‘å¬æœºåˆ¶ï¼ˆåœ¨ Axios ä¸­è¡¨ç°ä¸º <code>onDownloadProgress</code> å›è°ƒï¼‰ï¼Œæ‰‹åŠ¨è·å–æ¯æ¬¡æ–°å¢çš„æ•°æ®å—ï¼Œå¹¶æ‰‹åŠ¨è¿›è¡Œ SSE æ ¼å¼çš„è§£æã€‚</p>
<ol>
<li><strong>æ²¡æœ‰è‡ªåŠ¨è§£æï¼š</strong> å¿…é¡»æ‰‹åŠ¨è§£æ <code>data:</code> å­—æ®µå’Œ <code>\n\n</code> åˆ†éš”ç¬¦ã€‚</li>
<li><strong>æ‰‹åŠ¨è¿½è¸ªæ•°æ®ï¼š</strong> æ¯æ¬¡ <code>onDownloadProgress</code> è§¦å‘æ—¶ï¼Œè¿”å›çš„æ˜¯<strong>å½“å‰å·²æ¥æ”¶çš„å…¨éƒ¨æ•°æ®</strong>ï¼Œè€Œä¸æ˜¯æ–°å¢çš„æ•°æ®ã€‚æ‚¨éœ€è¦ä¸€ä¸ªæŒ‡é’ˆæ¥è¿½è¸ªä¸Šæ¬¡å¤„ç†åˆ°äº†å“ªé‡Œï¼Œå¹¶æå–å‡ºæ–°çš„æ•°æ®å—ã€‚</li>
<li><strong>ä¸æ”¯æŒè‡ªåŠ¨é‡è¿ï¼š</strong> å¿…é¡»æ‰‹åŠ¨å®ç°é”™è¯¯æ£€æµ‹å’Œé‡è¿é€»è¾‘ï¼ˆæœ¬ç¤ºä¾‹ä¸åŒ…å«é‡è¿ï¼Œä½†éœ€æ³¨æ„ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-23">æµå¼è¾“å‡ºæŠ€æœ¯çš„é€‰æ‹©</h5>
<h6 data-id="heading-24">1. ğŸ¥‡ EventSource API</h6>
<p>è¿™æ˜¯å®ç° SSE çš„<strong>æ ‡å‡†å’Œé¦–é€‰</strong>æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>å®ç°å¤æ‚åº¦ï¼š</strong> <strong>æœ€ä½ã€‚</strong> æµè§ˆå™¨åŸç”Ÿæ”¯æŒï¼Œä»£ç é‡æœ€å°‘ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong> <strong>å†…ç½®å¥å£®æ€§ã€‚</strong> è‡ªåŠ¨å¤„ç† SSE æ•°æ®æ ¼å¼è§£æã€æ¶ˆæ¯äº‹ä»¶ (<code>onmessage</code>) è§¦å‘ï¼Œå¹¶å†…ç½®äº†æ–­çº¿é‡è¿æœºåˆ¶ï¼ˆæ”¯æŒæœåŠ¡å™¨è®¾ç½® <code>retry:</code> é—´éš”ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä¸»è¦å±€é™ï¼š</strong></p>
<ul>
<li><strong>åªèƒ½ GET è¯·æ±‚ã€‚</strong></li>
<li><strong>ä¸æ”¯æŒè‡ªå®šä¹‰ Header é‰´æƒã€‚</strong> åªèƒ½é€šè¿‡ URL å‚æ•°ä¼ é€’ Tokenï¼Œå®‰å…¨æ€§ç›¸å¯¹è¾ƒä½ã€‚</li>
</ul>
</li>
<li>
<p><strong>é€‰æ‹©åŸåˆ™ï¼š</strong> <strong>å¼ºçƒˆæ¨è</strong>ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨å®‰å…¨æ€§è¦æ±‚ä¸æ¶‰åŠè¯·æ±‚ Headerï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ Session Cookie æˆ– URL Token é‰´æƒï¼‰ä¸”åªéœ€è¦å•å‘æ•°æ®æ¨é€æ—¶ã€‚</p>
</li>
</ul>
<h6 data-id="heading-25">2. ğŸ¥ˆ Fetch API + ReadableStream</h6>
<p>è¿™æ˜¯åœ¨éœ€è¦é«˜æ§åˆ¶åº¦æ—¶ä½¿ç”¨çš„ç°ä»£æ ‡å‡†æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>å®ç°å¤æ‚åº¦ï¼š</strong> <strong>ä¸­é«˜ã€‚</strong> éœ€è¦æ‰‹åŠ¨è·å–æµé˜…è¯»å™¨ (<code>getReader()</code>)ï¼Œå¹¶è¿›å…¥å¾ªç¯ï¼Œæ‰‹åŠ¨è¿›è¡Œ SSE æ•°æ®è§£æï¼ˆè§£ç å­—èŠ‚ã€æŸ¥æ‰¾ <code>\n\n</code>ã€æå– <code>data:</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong> <strong>æ§åˆ¶åŠ›æœ€å¼ºã€‚</strong></p>
<ul>
<li>æ”¯æŒè‡ªå®šä¹‰ HTTP Headerï¼ˆé€‚ç”¨äºä¼ é€’ JWT ç­‰é‰´æƒä¿¡æ¯ï¼‰ã€‚</li>
<li>æ”¯æŒ POST ç­‰å…¶ä»– HTTP æ–¹æ³•ã€‚</li>
<li>å¯ä»¥å¤„ç†éæ ‡å‡†çš„æµæ ¼å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸»è¦å±€é™ï¼š</strong> å¿…é¡»æ‰‹åŠ¨ç¼–å†™å¤æ‚çš„ SSE æ ¼å¼è§£æé€»è¾‘å’Œé”™è¯¯é‡è¿æœºåˆ¶ã€‚</p>
</li>
<li>
<p><strong>é€‰æ‹©åŸåˆ™ï¼š</strong> å½“æ‚¨<strong>å¿…é¡»</strong>åœ¨è¯·æ±‚ Header ä¸­ä¼ é€’é‰´æƒä¿¡æ¯ï¼ˆä¾‹å¦‚ JWTï¼‰ï¼Œæˆ–è€…éœ€è¦å¤„ç†éæ ‡å‡†çš„æµæ ¼å¼æ—¶ï¼Œåº”é€‰æ‹©æ­¤æ–¹æ¡ˆã€‚</p>
</li>
</ul>
<h6 data-id="heading-26">3. ğŸ¥‰ Axios + onDownloadProgress</h6>
<p>è¿™æ˜¯åŸºäºæ—§çš„ XHR æœºåˆ¶çš„æ¨¡æ‹Ÿæ–¹æ¡ˆï¼Œ<strong>é€šå¸¸ä¸æ¨è</strong>ç”¨äºç°ä»£ Web åº”ç”¨çš„ SSEã€‚</p>
<ul>
<li>
<p><strong>å®ç°å¤æ‚åº¦ï¼š</strong> <strong>é«˜ã€‚</strong> ä¾èµ– <code>onDownloadProgress</code> äº‹ä»¶ï¼Œæ¯æ¬¡äº‹ä»¶è§¦å‘è¿”å›çš„æ˜¯<strong>å…¨éƒ¨</strong>å·²æ¥æ”¶æ•°æ®ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„é€»è¾‘æ¥è¿½è¸ªä¸Šæ¬¡å¤„ç†çš„ç´¢å¼•ï¼Œä»¥æå–æ–°å¢çš„æ•°æ®å—ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong> å¦‚æœæ‚¨çš„é¡¹ç›®å¤§é‡ä¾èµ– Axiosï¼Œå¯ä»¥ä¿æŒæŠ€æœ¯æ ˆçš„ç»Ÿä¸€ã€‚</p>
</li>
<li>
<p><strong>ä¸»è¦å±€é™ï¼š</strong></p>
<ul>
<li>å®ç°æµç¨‹å¤æ‚ä¸”æ˜“é”™ã€‚</li>
<li>æ€§èƒ½ä¸å¦‚åŸç”Ÿ APIï¼Œä¸”ä¸æ”¯æŒåŸç”Ÿçš„è‡ªåŠ¨é‡è¿ã€‚</li>
<li>åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œç¼ºä¹å¯¹æµçš„æ ‡å‡†åŒ–æ”¯æŒã€‚</li>
</ul>
</li>
<li>
<p><strong>é€‰æ‹©åŸåˆ™ï¼š</strong> ä»…åœ¨éœ€è¦å…¼å®¹æ—§ç¯å¢ƒæˆ–å› ç‰¹æ®Šé™åˆ¶<strong>æ— æ³•ä½¿ç”¨ <code>EventSource</code> æˆ– <code>fetch</code></strong> çš„æƒ…å†µä¸‹è€ƒè™‘ã€‚</p>
</li>
</ul>
<h3 data-id="heading-27">2.åŸºäºWebSocketçš„åŒå‘æµå¼è¾“å‡ºå®ç°</h3>
<p>WebSocket åè®®ä¸ SSEï¼ˆå•å‘æµï¼‰å’Œä¼ ç»Ÿçš„ HTTP è¯·æ±‚ï¼ˆä¸€æ¬¡æ€§ä¼ è¾“ï¼‰æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ï¼Œå®ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªæŒä¹…çš„ã€<strong>å…¨åŒå·¥ï¼ˆåŒå‘ï¼‰</strong> çš„é€šä¿¡é€šé“ï¼Œéå¸¸é€‚åˆéœ€è¦é«˜é¢‘ç‡ã€ä½å»¶è¿Ÿäº¤äº’çš„åœºæ™¯ã€‚</p>
<h4 data-id="heading-28">1. åè®®å‡çº§</h4>
<p>WebSocket è¿æ¥çš„å»ºç«‹å§‹äºä¸€ä¸ªæ ‡å‡†çš„ HTTP è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚åŒ…å«äº†ç‰¹æ®Šçš„ Headerï¼Œç”¨äºè¯·æ±‚å°†è¿æ¥ä» HTTP <strong>å‡çº§ï¼ˆUpgradeï¼‰</strong> åˆ° WebSocket åè®®ã€‚ä¸€æ—¦å‡çº§æˆåŠŸï¼Œè¿æ¥å°±ä¸å†å—é™äºä¼ ç»Ÿçš„ HTTP è¯·æ±‚-å“åº”æ¨¡å‹ã€‚</p>
<h4 data-id="heading-29">2. å…¨åŒå·¥é€šä¿¡</h4>
<p>ä¸€æ—¦è¿æ¥å»ºç«‹ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¯ä»¥<strong>ç‹¬ç«‹ã€åŒæ—¶åœ°</strong>äº’ç›¸å‘é€æ•°æ®å¸§ã€‚</p>
<ul>
<li><strong>å®¢æˆ·ç«¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> æœåŠ¡å™¨ï¼š</strong> å®¢æˆ·ç«¯å¯ä»¥éšæ—¶å‘é€è¾“å…¥ã€æ§åˆ¶å‘½ä»¤æˆ–å¿ƒè·³åŒ…ã€‚</li>
<li><strong>æœåŠ¡å™¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> å®¢æˆ·ç«¯ï¼š</strong> æœåŠ¡å™¨å¯ä»¥éšæ—¶å‘é€æµå¼æ•°æ®ã€çŠ¶æ€æ›´æ–°æˆ–å“åº”ã€‚</li>
</ul>
<p>è¿™ç§åŒå‘æ€§ä½¿å¾— WebSocket ä¸ä»…å¯ä»¥ç”¨äºæµå¼è¾“å‡ºï¼ˆæœåŠ¡å™¨æ¨æ•°æ®ï¼‰ï¼Œè¿˜å¯ä»¥ç”¨äºå®æ—¶æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œå®Œç¾æ”¯æŒ <strong>å®æ—¶èŠå¤©</strong> æˆ– <strong>åä½œç¼–è¾‘</strong> ç­‰åœºæ™¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3069d503a494ec090c04f35cdc6f07a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766412291&amp;x-signature=4GXjB9BUL9HsVXDblZgF%2Blgd46Q%3D" alt="WebSocket bidirectional communication diagramçš„å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-30">3. åŸºäºå¸§çš„ä¼ è¾“</h4>
<p>WebSocket çš„æ•°æ®ä¼ è¾“æ˜¯åŸºäº<strong>å¸§</strong>çš„ï¼Œè€Œä¸æ˜¯åŸºäºæ–‡æœ¬æµæˆ– HTTP è¯·æ±‚ã€‚è¿™ä½¿å¾—ä¼ è¾“æ•ˆç‡æ›´é«˜ï¼Œå»¶è¿Ÿæ›´ä½ã€‚å¸§å¯ä»¥åŒ…å«æ–‡æœ¬æ•°æ®ï¼ˆText Frameï¼‰æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼ˆBinary Frameï¼‰ã€‚</p>
<hr/>
<p>åŸºäº WebSocket çš„åŒå‘æµå¼è¾“å‡ºéœ€è¦å‰ç«¯å’Œåç«¯åˆ†åˆ«<strong>ä½¿ç”¨ä¸“é—¨çš„åº“å’Œ API è¿›è¡Œ</strong>å®ç°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74f39a28fe9243eb92cd01fa86b8f306~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766412291&amp;x-signature=6krzmCfdIO55YFCsHg4rbpX41Gc%3D" alt="GIF 2025-12-15 22-03-28.gif" loading="lazy"/></p>
<h4 data-id="heading-31">1. åç«¯å®ç° (Node.js/ws æˆ– Socket.IO)</h4>
<p>åç«¯éœ€è¦ä¸€ä¸ªä¸“é—¨çš„ WebSocket æœåŠ¡å™¨æ¥ç®¡ç†è¿æ¥å’Œå‘é€æ•°æ®å¸§ã€‚</p>



































<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>å…³é”®æŠ€æœ¯ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>1. æ¡æ‰‹ä¸è¿æ¥</strong></td><td>ç›‘å¬ HTTP å‡çº§è¯·æ±‚ï¼Œæ¥å—è¿æ¥ï¼Œå¹¶åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ WebSocket è¿æ¥å¯¹è±¡ã€‚</td><td><code>ws.on('connection', (socket) =&gt; { ... })</code></td></tr><tr><td><strong>2. æ¥æ”¶å®¢æˆ·ç«¯è¾“å…¥</strong></td><td>ç›‘å¬å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ•°æ®å¸§ï¼Œç”¨äºè§¦å‘ AI ä»»åŠ¡æˆ–æ§åˆ¶æµã€‚</td><td><code>socket.on('message', (input) =&gt; { // Process input })</code></td></tr><tr><td><strong>3. æµå¼ç”Ÿæˆä¸æ¨é€</strong></td><td>åœ¨ AI æ¨¡å‹ç”Ÿæˆæ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ•°æ®å—å°è£…æˆ WebSocket å¸§å¹¶å®æ—¶å‘é€ã€‚</td><td><code>socket.send(data_chunk)</code></td></tr><tr><td><strong>4. ç»´æŠ¤è¿æ¥</strong></td><td>ç»´æŠ¤è¿æ¥çŠ¶æ€ï¼Œå¤„ç†å¿ƒè·³åŒ…ï¼ˆPing/Pongï¼‰ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯æ–­å¼€æ—¶æ¸…ç†èµ„æºã€‚</td><td><code>socket.on('close', ...)</code></td></tr><tr><td/><td/><td/></tr></tbody></table>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">WebSocket</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ws'</span>);

<span class="hljs-comment">// åˆ›å»º WebSocket æœåŠ¡å™¨ï¼Œç›‘å¬ 8080 ç«¯å£</span>
<span class="hljs-keyword">const</span> wss = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>.<span class="hljs-title class_">Server</span>({ <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span> });

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'WebSocket Server running on ws://localhost:8080'</span>);

<span class="hljs-comment">// ç›‘å¬å®¢æˆ·ç«¯è¿æ¥äº‹ä»¶</span>
wss.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connection'</span>, <span class="hljs-keyword">function</span> <span class="hljs-title function_">connection</span>(<span class="hljs-params">ws</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- Client Connected ---'</span>);
    
    <span class="hljs-comment">// 1. ç›‘å¬å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯ï¼ˆåŒå‘è¾“å…¥ï¼‰</span>
    ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-keyword">function</span> <span class="hljs-title function_">incoming</span>(<span class="hljs-params">message</span>) {
        <span class="hljs-keyword">const</span> clientMessage = message.<span class="hljs-title function_">toString</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Received message from client: <span class="hljs-subst">${clientMessage}</span>`</span>);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(clientMessage);
            
            <span class="hljs-keyword">if</span> (data.<span class="hljs-property">command</span> === <span class="hljs-string">'START'</span>) {
                <span class="hljs-comment">// å®¢æˆ·ç«¯è¯·æ±‚å¼€å§‹æµå¼è¾“å‡º</span>
                <span class="hljs-title function_">startStreaming</span>(ws, data.<span class="hljs-property">prompt</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">command</span> === <span class="hljs-string">'STOP'</span>) {
                <span class="hljs-comment">// å®¢æˆ·ç«¯è¯·æ±‚åœæ­¢æµå¼è¾“å‡º (å®æ—¶æ§åˆ¶)</span>
                <span class="hljs-title function_">stopStreaming</span>(ws);
                ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">'info'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Streaming stopped by client.'</span> }));
            }
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error parsing client message:'</span>, e);
            ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">'error'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Invalid JSON format.'</span> }));
        }
    });

    <span class="hljs-comment">// ç›‘å¬è¿æ¥å…³é—­äº‹ä»¶</span>
    ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-keyword">function</span> <span class="hljs-title function_">close</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- Client Disconnected ---'</span>);
        <span class="hljs-comment">// æ¸…ç†èµ„æºï¼Œåœæ­¢è¯¥è¿æ¥ä¸Šçš„æ‰€æœ‰æµ</span>
        <span class="hljs-title function_">stopStreaming</span>(ws);
    });

    <span class="hljs-comment">// åˆå§‹é—®å€™</span>
    ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">'ready'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Welcome! Send {"command": "START", "prompt": "..."} to begin streaming.'</span> }));
});

<span class="hljs-comment">// å­˜å‚¨å½“å‰æ­£åœ¨æµå¼è¾“å‡ºçš„è¿æ¥å’Œå®šæ—¶å™¨</span>
<span class="hljs-keyword">const</span> activeStreams = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">/**
 * æ¨¡æ‹Ÿ AI æ¨¡å‹æµå¼è¾“å‡ºçš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">WebSocket</span>} <span class="hljs-variable">ws</span> - å½“å‰è¿æ¥çš„ WebSocket å®ä¾‹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">prompt</span> - å®¢æˆ·ç«¯æä¾›çš„è¾“å…¥æç¤º
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">startStreaming</span>(<span class="hljs-params">ws, prompt</span>) {
    <span class="hljs-keyword">if</span> (activeStreams.<span class="hljs-title function_">has</span>(ws)) {
        ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">'info'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Stream is already active.'</span> }));
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> intervalId = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        counter++;
        <span class="hljs-keyword">const</span> chunk = <span class="hljs-string">`[Chunk <span class="hljs-subst">${counter}</span>] Output for "<span class="hljs-subst">${prompt.substring(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>)}</span>...": Data block <span class="hljs-subst">${counter}</span>.`</span>;
        
        <span class="hljs-comment">// 2. å®æ—¶å°†æ•°æ®å—ä½œä¸º WebSocket å¸§å‘é€ç»™å®¢æˆ·ç«¯</span>
        <span class="hljs-comment">// ä½¿ç”¨ JSON æ ¼å¼å°è£…æ•°æ®ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯è§£æ</span>
        <span class="hljs-keyword">const</span> dataToSend = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ 
            <span class="hljs-attr">type</span>: <span class="hljs-string">'data'</span>, 
            <span class="hljs-attr">content</span>: chunk,
            <span class="hljs-attr">count</span>: counter
        });
        
        <span class="hljs-comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦ä»ç„¶æ‰“å¼€</span>
        <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
            ws.<span class="hljs-title function_">send</span>(dataToSend);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Pushed data chunk <span class="hljs-subst">${counter}</span>`</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœè¿æ¥å…³é—­ï¼Œåœæ­¢æµ</span>
            <span class="hljs-built_in">clearInterval</span>(intervalId);
            activeStreams.<span class="hljs-title function_">delete</span>(ws);
        }

        <span class="hljs-keyword">if</span> (counter &gt;= <span class="hljs-number">15</span>) {
            <span class="hljs-comment">// 3. æµç»“æŸï¼Œå‘é€ç»“æŸæ ‡è®°</span>
            <span class="hljs-built_in">clearInterval</span>(intervalId);
            activeStreams.<span class="hljs-title function_">delete</span>(ws);
            <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
                 ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'done'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Streaming complete.'</span> }));
            }
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- Streaming finished ---'</span>);
        }
    }, <span class="hljs-number">500</span>); <span class="hljs-comment">// æ¯ 500 æ¯«ç§’å‘é€ä¸€ä¸ªæ•°æ®å—</span>

    activeStreams.<span class="hljs-title function_">set</span>(ws, intervalId);
}

<span class="hljs-comment">/**
 * åœæ­¢æŒ‡å®šè¿æ¥çš„æµå¼è¾“å‡º
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">stopStreaming</span>(<span class="hljs-params">ws</span>) {
    <span class="hljs-keyword">if</span> (activeStreams.<span class="hljs-title function_">has</span>(ws)) {
        <span class="hljs-built_in">clearInterval</span>(activeStreams.<span class="hljs-title function_">get</span>(ws));
        activeStreams.<span class="hljs-title function_">delete</span>(ws);
    }
}
</code></pre>
<h4 data-id="heading-32">2. å‰ç«¯å®ç° (Browser WebSocket API)</h4>
<p>å‰ç«¯ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„ <code>WebSocket</code> API æ¥å»ºç«‹è¿æ¥å’Œå¤„ç†åŒå‘é€šä¿¡ã€‚</p>






























<table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>åŠ¨ä½œæè¿°</strong></th><th><strong>å…³é”®æŠ€æœ¯ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>1. å»ºç«‹è¿æ¥</strong></td><td>ä½¿ç”¨ <code>new WebSocket(ws://url)</code> å»ºç«‹è¿æ¥ã€‚æ³¨æ„åè®®æ˜¯ <code>ws://</code> æˆ– <code>wss://</code>ã€‚</td><td><code>new WebSocket('ws://localhost:8080')</code></td></tr><tr><td><strong>2. ç›‘å¬è¿æ¥çŠ¶æ€</strong></td><td>ç›‘å¬ <code>onopen</code>ï¼ˆè¿æ¥æˆåŠŸï¼‰ã€<code>onerror</code> å’Œ <code>onclose</code> äº‹ä»¶ã€‚</td><td><code>ws.onopen = () =&gt; {...}</code></td></tr><tr><td><strong>3. æ¥æ”¶æµå¼è¾“å‡º</strong></td><td>ç›‘å¬ <strong><code>onmessage</code></strong> äº‹ä»¶ï¼Œæ¥æ”¶æœåŠ¡å™¨æ¨é€çš„æµå¼æ•°æ®å¸§ï¼Œå¹¶å®æ—¶è¿½åŠ åˆ° UIã€‚</td><td><code>ws.onmessage = (event) =&gt; { // Append event.data }</code></td></tr><tr><td><strong>4. å‘é€å®¢æˆ·ç«¯è¾“å…¥</strong></td><td>å½“ç”¨æˆ·æœ‰æ–°è¾“å…¥æˆ–éœ€è¦å‘é€æ§åˆ¶å‘½ä»¤æ—¶ï¼Œé€šè¿‡ <code>send()</code> æ–¹æ³•å‘é€æ•°æ®å¸§åˆ°æœåŠ¡å™¨ã€‚</td><td><code>ws.send(JSON.stringify({command: 'stop'}))</code></td></tr></tbody></table>
<hr/>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WebSocket åŒå‘æµå¼è¾“å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">font-family</span>: Arial, sans-serif; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
        <span class="hljs-selector-id">#status</span> { <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>; }
        <span class="hljs-selector-id">#output-area</span> { <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>; <span class="hljs-attribute">min-height</span>: <span class="hljs-number">150px</span>; <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f9f9f9</span>; <span class="hljs-attribute">white-space</span>: pre-wrap; <span class="hljs-attribute">overflow-y</span>: scroll; }
        <span class="hljs-selector-class">.control-panel</span> { <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>; }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ’¬ WebSocket åŒå‘æµå¼äº¤äº’<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: gray;"</span>&gt;</span>è¿æ¥çŠ¶æ€: å¾…è¿æ¥...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æœåŠ¡å™¨è¾“å‡ºæµ:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-area"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"control-panel"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"prompt"</span>&gt;</span>è¾“å…¥æç¤º:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prompt"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"è¯·ç»™æˆ‘å†™ä¸€ç¯‡å…³äºAIæµå¼è¾“å‡ºçš„æ–‡ç« "</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 300px;"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"connectWebSocket()"</span>&gt;</span>å»ºç«‹è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"startStream()"</span>&gt;</span>â–¶ï¸ å¯åŠ¨æµå¼è¾“å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"stopStream()"</span>&gt;</span>ğŸ›‘ å®æ—¶åœæ­¢æµ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"closeWebSocket()"</span>&gt;</span>æ–­å¼€è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WS_URL</span> = <span class="hljs-string">'ws://localhost:8080'</span>;
        <span class="hljs-keyword">let</span> ws = <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">const</span> statusElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status'</span>);
        <span class="hljs-keyword">const</span> outputElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-area'</span>);
        <span class="hljs-keyword">const</span> promptInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'prompt'</span>);

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">message</span>) {
            outputElement.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">`&lt;p style="margin: 0; padding: 2px 0;"&gt;<span class="hljs-subst">${message}</span>&lt;/p&gt;`</span>;
            outputElement.<span class="hljs-property">scrollTop</span> = outputElement.<span class="hljs-property">scrollHeight</span>;
        }
        
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">text, color</span>) {
            statusElement.<span class="hljs-property">textContent</span> = text;
            statusElement.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = color;
        }

        <span class="hljs-comment">// 1. å»ºç«‹ WebSocket è¿æ¥</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (ws &amp;&amp; ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥å·²å­˜åœ¨'</span>, <span class="hljs-string">'blue'</span>);
                <span class="hljs-keyword">return</span>;
            }

            ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-variable constant_">WS_URL</span>);
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'æ­£åœ¨è¿æ¥...'</span>, <span class="hljs-string">'orange'</span>);
            outputElement.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;

            <span class="hljs-comment">// ç›‘å¬è¿æ¥æˆåŠŸäº‹ä»¶</span>
            ws.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âœ… å·²å»ºç«‹'</span>, <span class="hljs-string">'green'</span>);
                <span class="hljs-title function_">log</span>(<span class="hljs-string">'--- WebSocket Connection Opened ---'</span>);
            };

            <span class="hljs-comment">// 2. ç›‘å¬æ¥æ”¶åˆ°çš„æ•°æ®å¸§ (æ ¸å¿ƒ)</span>
            ws.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
                    
                    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'data'</span>) {
                        <span class="hljs-comment">// å®æ—¶è¿½åŠ æµå¼è¾“å‡ºçš„å†…å®¹</span>
                        <span class="hljs-title function_">log</span>(<span class="hljs-string">`[Server Stream]: <span class="hljs-subst">${data.content}</span>`</span>);
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'done'</span>) {
                        <span class="hljs-title function_">log</span>(<span class="hljs-string">`[INFO]: <span class="hljs-subst">${data.message}</span>`</span>);
                        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'æµå·²å®Œæˆ'</span>, <span class="hljs-string">'blue'</span>);
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'info'</span>) {
                        <span class="hljs-title function_">log</span>(<span class="hljs-string">`[INFO]: <span class="hljs-subst">${data.message}</span>`</span>);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-comment">// å¤„ç†é JSON æ ¼å¼çš„æ¶ˆæ¯</span>
                    <span class="hljs-title function_">log</span>(<span class="hljs-string">`[RAW MESSAGE]: <span class="hljs-subst">${event.data}</span>`</span>);
                }
            };

            <span class="hljs-comment">// ç›‘å¬é”™è¯¯äº‹ä»¶</span>
            ws.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: âŒ å‘ç”Ÿé”™è¯¯'</span>, <span class="hljs-string">'red'</span>);
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'WebSocket Error:'</span>, error);
            };

            <span class="hljs-comment">// ç›‘å¬è¿æ¥å…³é—­äº‹ä»¶ (è¿æ¥æ–­å¼€)</span>
            ws.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¿æ¥çŠ¶æ€: ğŸ›‘ å·²æ–­å¼€'</span>, <span class="hljs-string">'red'</span>);
                <span class="hljs-title function_">log</span>(<span class="hljs-string">'--- WebSocket Connection Closed ---'</span>);
                ws = <span class="hljs-literal">null</span>;
            };
        }

        <span class="hljs-comment">// 3. å®¢æˆ·ç«¯å‘é€å‘½ä»¤ï¼šå¯åŠ¨æµå¼è¾“å‡º</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (ws &amp;&amp; ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
                <span class="hljs-keyword">const</span> prompt = promptInput.<span class="hljs-property">value</span> || <span class="hljs-string">"Default prompt"</span>;
                <span class="hljs-keyword">const</span> command = {
                    <span class="hljs-attr">command</span>: <span class="hljs-string">'START'</span>,
                    <span class="hljs-attr">prompt</span>: prompt
                };
                <span class="hljs-comment">// å‘é€ JSON æ ¼å¼çš„å¯åŠ¨å‘½ä»¤</span>
                ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(command));
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'æµå¼è¾“å‡ºå·²å¯åŠ¨...'</span>, <span class="hljs-string">'purple'</span>);
                <span class="hljs-title function_">log</span>(<span class="hljs-string">`[Client Command]: Starting stream for prompt: "<span class="hljs-subst">${prompt}</span>"`</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¯·å…ˆå»ºç«‹è¿æ¥'</span>, <span class="hljs-string">'red'</span>);
            }
        }

        <span class="hljs-comment">// 4. å®¢æˆ·ç«¯å‘é€å‘½ä»¤ï¼šå®æ—¶åœæ­¢æµ</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">stopStream</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (ws &amp;&amp; ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
                <span class="hljs-keyword">const</span> command = {
                    <span class="hljs-attr">command</span>: <span class="hljs-string">'STOP'</span>
                };
                <span class="hljs-comment">// å‘é€ JSON æ ¼å¼çš„åœæ­¢å‘½ä»¤</span>
                ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(command));
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å‘é€åœæ­¢å‘½ä»¤'</span>, <span class="hljs-string">'purple'</span>);
                <span class="hljs-title function_">log</span>(<span class="hljs-string">`[Client Command]: Sending STOP command.`</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'è¯·å…ˆå»ºç«‹è¿æ¥'</span>, <span class="hljs-string">'red'</span>);
            }
        }
        
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">closeWebSocket</span>(<span class="hljs-params"/>) {
             <span class="hljs-keyword">if</span> (ws &amp;&amp; ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
                 ws.<span class="hljs-title function_">close</span>();
             }
        }

        <span class="hljs-comment">// é¡µé¢åŠ è½½åè‡ªåŠ¨å°è¯•è¿æ¥</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = connectWebSocket;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>



































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>WebSocket åŒå‘æµ</strong></th><th><strong>SSE å•å‘æµ</strong></th></tr></thead><tbody><tr><td><strong>é€šä¿¡æ–¹å‘</strong></td><td><strong>åŒå‘</strong>ï¼ˆå…¨åŒå·¥ï¼‰</td><td><strong>å•å‘</strong>ï¼ˆæœåŠ¡å™¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> å®¢æˆ·ç«¯ï¼‰</td></tr><tr><td><strong>åè®®åŸºç¡€</strong></td><td>ç‹¬ç«‹äº HTTP çš„ TCP åè®®</td><td>åŸºäº HTTP åè®®</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å®æ—¶èŠå¤©ã€åä½œç¼–è¾‘ã€<strong>AI å®æ—¶äº¤äº’æ§åˆ¶</strong></td><td><strong>çº¯ç²¹çš„ AI æµå¼è¾“å‡º</strong>ã€æ–°é—»æ¨é€</td></tr><tr><td><strong>å®ç°å¤æ‚åº¦</strong></td><td>è¾ƒé«˜ï¼ˆéœ€ç‹¬ç«‹æœåŠ¡å™¨æ”¯æŒï¼‰</td><td>è¾ƒä½ï¼ˆåŸºäºæ ‡å‡† HTTPï¼‰</td></tr><tr><td><strong>è‡ªåŠ¨é‡è¿</strong></td><td><strong>æ— åŸç”Ÿæ”¯æŒ</strong>ï¼Œéœ€è¦æ‰‹åŠ¨å®ç°</td><td><strong>æµè§ˆå™¨åŸç”Ÿæ”¯æŒ</strong></td></tr></tbody></table>
<p>å¦‚æœä½ çš„ AI åº”ç”¨åªéœ€è¦å°† LLM çš„ç»“æœæµå¼è¾“å‡ºç»™ç”¨æˆ·ï¼Œ<strong>SSE æ˜¯æ›´ç®€å•ã€æ›´å¥å£®çš„é€‰æ‹©</strong>ã€‚ä½†å¦‚æœæ‚¨çš„åº”ç”¨éœ€è¦ç”¨æˆ·åœ¨æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­<strong>å®æ—¶ä¸­æ–­ã€ä¿®æ”¹è¾“å…¥ã€æˆ–è€…å®ç°å¤šäººåä½œ</strong>ï¼Œ<strong>WebSocket æ˜¯å”¯ä¸€çš„é€‰æ‹©</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡å¸¦ä½ ç©è½¬ WebSocket å…¨é“¾è·¯å¯è§‚æµ‹]]></title>    <link>https://juejin.cn/post/7583898823920418858</link>    <guid>https://juejin.cn/post/7583898823920418858</guid>    <pubDate>2025-12-15T09:14:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583898823920418858" data-draft-id="7583845695196577846" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡å¸¦ä½ ç©è½¬ WebSocket å…¨é“¾è·¯å¯è§‚æµ‹"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-15T09:14:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡å¸¦ä½ ç©è½¬ WebSocket å…¨é“¾è·¯å¯è§‚æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T09:14:16.000Z" title="Mon Dec 15 2025 09:14:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šå¼ é“­è¾‰ï¼ˆå¸Œé“­ï¼‰</p>
<h2 data-id="heading-0">å‰è¨€ï¼šWebSocket çš„æŠ€æœ¯æ¼”è¿›ä¸æ—¶ä»£ä»·å€¼</h2>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯ WebSocketï¼Ÿ</h3>
<p>WebSocket æ˜¯ä¸€ç§åŸºäº TCP åè®®çš„å…¨åŒå·¥é€šä¿¡åè®®ï¼ˆRFC 6455 <strong>[</strong> <strong>1]</strong> ï¼‰ï¼Œé€šè¿‡ä¸€æ¬¡ HTTP æ¡æ‰‹å³å¯å»ºç«‹æŒä¹…åŒ–è¿æ¥ï¼Œå®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„åŒå‘æ•°æ®ä¼ è¾“ã€‚ä»¥ä¸‹æ˜¯ä¸€æ¬¡ WebSocket é€šä¿¡çš„ç¤ºæ„å›¾ <strong>[</strong> <strong>2]</strong> ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76c38de6ef7a4bccb8a4e8ba14927b81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=8rxa69Hb%2B16TwcJCDMZ3NojUW%2BU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå’Œ HTTP ä¸åŒï¼ŒClient ä¼šå…ˆå‘ Server ç«¯åŸºäº HTTP åè®®å‘èµ·ä¸€æ¬¡æ¡æ‰‹è¯·æ±‚ï¼ŒServer è¿”å›å“åº”æ¡æ‰‹æˆåŠŸã€‚åœ¨è¿™ä¹‹åï¼Œå·²æœ‰çš„ TCP è¿æ¥ä¼šè¢«å‡çº§ä¸º WebSocket è¿æ¥ï¼ŒClient å’Œ Server ä¹‹é—´å¯ä»¥è¿›è¡Œå…¨åŒå·¥é€šä¿¡ã€‚TCP è¿æ¥ä¼šä¸€ç›´æŒç»­åˆ°å…¶ä¸­ä¸€ä¾§è®¤ä¸ºéœ€è¦å…³é—­ï¼Œä¸”å¯¹æ–¹åŒæ„å…³é—­ä¹‹æ—¶ã€‚</p>
<p>ä¸ºäº†æ›´å¥½ç†è§£åç»­ WebSocket çš„å…¨é“¾è·¯å¯è§‚æµ‹æ–¹æ¡ˆï¼Œæœ‰å¿…è¦å¯¹ WebSocket çš„åè®®ç»†èŠ‚è¿›è¡Œè§£è¯»ï¼Œæœ¬èŠ‚å‰©ä½™å†…å®¹éƒ¨åˆ†ç¿»è¯‘ + æ€»ç»“è‡ª WebSocket Protocol <strong>[</strong> <strong>3]</strong> ã€‚</p>
<h4 data-id="heading-2">1.1.1 URI æ ¼å¼ä¸è¯­æ³•</h4>
<p>å’Œ HTTP åè®®æ—éå¸¸ç±»ä¼¼ï¼ŒWebSocket ä¹Ÿæœ‰æ™®é€šåè®®å’Œä»–çš„å®‰å…¨ç‰ˆæœ¬ï¼Œç”¨ ws å’Œ wss æ¥åŒºåˆ†ï¼Œwss çš„å®‰å…¨ä¹Ÿé‡‡ç”¨ TLS åè®®å®ç°ã€‚ç”±äº WebSocket ä¾èµ– HTTP åè®®è¿›è¡Œæ¡æ‰‹ï¼Œåç»­å¤ç”¨åŸ TCP è¿æ¥ï¼Œæ•… WebSocket é»˜è®¤çš„ç«¯å£ä¹Ÿæ˜¯ 80ï¼ˆwsï¼‰å’Œ 443ï¼ˆwssï¼‰ã€‚URI æ•´ä½“çš„æ ¼å¼ä¹Ÿå’Œ HTTP éå¸¸ç±»ä¼¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfc5d72902bb4d3a880b3a5b5c5be124~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=E8veoaNdC5JWPQ17NtDAl6JUFd4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-3">1.1.2 å¯åŠ¨è¿æ¥æ¡æ‰‹ï¼ˆåŸºäº HTTP/1.1ï¼‰</h4>
<p>ä¼ ç»Ÿçš„ WebSocket æ¡æ‰‹æ˜¯ä¸€æ¬¡å…¸å‹çš„ HTTP è¯·æ±‚/å“åº”ã€‚å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·ä¸€ä¸ª WebSocket æ¡æ‰‹è¯·æ±‚ï¼ˆä¸€ä¸ªç‰¹æ®Šçš„ GETï¼‰ï¼Œå¦‚æœæœåŠ¡å™¨æ”¯æŒä¸”å…è®¸ä½¿ç”¨ WebSocket åè®®é€šä¿¡ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª WebSocket æ¡æ‰‹å“åº”ã€‚WebSocket Connection å°±å»ºç«‹èµ·æ¥äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/828f98b33c1644ea84b9869e88576811~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=UOfbY8VUXuXTd7Sg4Y6VAcr%2FkCs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¡æ‰‹è¯·æ±‚åŒ…å«ä»¥ä¸‹å¤´ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4775de1446c4d339cdfae679ac6f5e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=OUfNON19IAxtnLG8tQNPjJnKBDA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦‚æœæœåŠ¡ç«¯æ¥å— WebSocket åè®®ï¼Œåˆ™å‘é€ä¸€ä¸ª StatusCode ä¸º 101 çš„å“åº”ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">HTTP/1.1Â 101Â Switching Protocols
<span class="hljs-section">Upgrade: websocket</span>
<span class="hljs-section">Connection: Upgrade</span>
<span class="hljs-section">Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=</span>
</code></pre>
<p>å“åº”åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>HTTP/1.1 101 Switching Protocols</code>ï¼šè¡¨ç¤ºæˆåŠŸä» HTTP å‡çº§åˆ° WebSocketã€‚</li>
<li><code>Upgrade: websocket</code>ï¼šç¡®è®¤åè®®å‡çº§ã€‚</li>
<li><code>Connection: Upgrade</code>ï¼šè¡¨ç¤ºè¿æ¥å·²å‡çº§ã€‚</li>
<li><code>Sec-WebSocket-Accept</code>ï¼šä¸€ä¸ªæ ¹æ®å®¢æˆ·ç«¯çš„Â <code>Sec-WebSocket-Key</code>Â è®¡ç®—å‡ºçš„å€¼ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨ç†è§£äº† WebSocket æ¡æ‰‹è¯·æ±‚ã€‚</li>
</ul>
<p>HTTP/2 ä¸ HTTP/3 å‡çº§åˆ° WebSocket çš„è¿‡ç¨‹æœ‰ä¸€äº›ä¸åŒï¼Œä½†ä¸æ˜¯æœ¬æ–‡è®¨è®ºçš„å…³é”®ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ï¼Œæ¬¢è¿é˜…è¯» WebSocket ProtocolÂ åŸæ–‡ <strong>[</strong> <strong>3]</strong> ã€‚</p>
<h4 data-id="heading-4">1.1.3 WebSocket æ¶ˆæ¯ä¸æ•°æ®å¸§</h4>
<p>åœ¨æ¡æ‰‹å®Œæ¯•åï¼Œè¿æ¥ä¼šè¢«å‡çº§ä¸º WebSocket è¿æ¥ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥éšæ—¶åŒå‘å‘é€ WebSocket æ¶ˆæ¯ï¼ˆmessageï¼‰ï¼Œç”¨æ¥äº¤æ¢æ•°æ®å’ŒæŒ‡ä»¤ã€‚WebSocket ä¸­çš„æœ€å°é€šä¿¡å•å…ƒæ˜¯æ•°æ®å¸§ï¼Œæ¯ä¸ªæ¶ˆæ¯æœ‰å¯èƒ½ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®å¸§ç»„æˆã€‚</p>
<p>æ•°æ®å¸§æ ¹æ®å…¶ç”¨é€”å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼š</p>
<ul>
<li><strong>æ–‡æœ¬å¸§ï¼š</strong> è½½è·ä¸º UTF-8 ç¼–ç çš„æ–‡æœ¬æ•°æ®</li>
<li><strong>äºŒè¿›åˆ¶å¸§ï¼š</strong> è½½è·ä¸ºäºŒè¿›åˆ¶æ•°æ®</li>
<li><strong>æ§åˆ¶å¸§ï¼š</strong> ç”¨äºä¼ é€’åè®®ä¿¡å·ï¼Œå¦‚ pingã€pongã€close å¸§ç­‰</li>
</ul>
<p>ä¸€ä¸ªæ•°æ®å¸§çš„æ•°æ®ç»„æˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/961fdeb250e4437d816cca34abde8e6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=5wIgf%2FLtTgQxWjg6cHOKA%2FUAYQ8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…³äºæ•°æ®å¸§ä¸­æ¯æ®µæ•°æ®çš„å«ä¹‰ï¼Œå¦‚æœ‰å…´è¶£ï¼Œæ¬¢è¿é˜…è¯»Â WebSocket ProtocolÂ åŸæ–‡Â  <strong>[</strong> <strong>3]</strong> ã€‚</p>
<h4 data-id="heading-5">1.1.4 å…³é—­è¿æ¥æ¡æ‰‹</h4>
<p>å½“å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯æŸä¸€æ–¹è®¤ä¸ºè¿æ¥å¯ä»¥å…³é—­æ—¶ï¼Œä¼šå‘å¯¹ç«¯å‘é€ä¸€ä¸ªå…³é—­å¸§ï¼ˆæ˜¯æ§åˆ¶å¸§çš„ä¸€ç§ï¼‰ï¼Œå¯¹ç«¯æ”¶åˆ°å…³é—­å¸§åä¼šå°½å¿«å‘é€å¦ä¸€ä¸ªå…³é—­å¸§ä½œä¸ºå“åº”ã€‚å‘é€å®Œå…³é—­å¸§åï¼Œè¯¥ç«¯ä¸åº”è¯¥å†å‘é€ä»»ä½•æ•°æ®å¸§ã€‚åŒæ–¹äº¤æ¢å®Œå…³é—­å¸§åï¼ŒTCP è¿æ¥å°†å…³é—­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ce443f1cb0b4b96827dacf032be2a1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=7jwOUM10oRrnC7OHhCF5%2BAsOMlc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-6">1.2 ä¸ºä»€ä¹ˆç”¨ WebSocketï¼Ÿ</h3>
<p>ä¸éš¾çœ‹å‡ºï¼ŒWebSocket æ ¸å¿ƒç‰¹æ€§ä½“ç°åœ¨ï¼š</p>
<ul>
<li><strong>é•¿è¿æ¥ä¿æŒï¼š</strong> è¿æ¥å»ºç«‹åæŒç»­å­˜åœ¨ï¼Œé¿å…é‡å¤æ¡æ‰‹å¼€é”€</li>
<li><strong>åŒå‘æ•°æ®é€šé“ï¼š</strong> å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å¯éšæ—¶å‘é€æ•°æ®å¸§ï¼ˆText/Binaryï¼‰</li>
<li><strong>ä½å»¶è¿Ÿç‰¹æ€§ï¼š</strong> çœå» HTTP è½®è¯¢çš„è¯·æ±‚å¤´ä¼ è¾“æˆæœ¬</li>
<li><strong>æ¶ˆæ¯åˆ†å¸§æœºåˆ¶ï¼š</strong> æ”¯æŒè¶…å¤§æ•°æ®é‡çš„åˆ†ç‰‡ä¼ è¾“ï¼ˆå•å¸§æœ€å¤§ 2^64 å­—èŠ‚ï¼‰</li>
</ul>
<p>ä¸ä¼ ç»Ÿ HTTP åè®®å¯¹æ¯”ï¼ŒWebSocket åœ¨é€šä¿¡æ¨¡å¼ä¸Šå®ç°äº†æ ¹æœ¬æ€§çªç ´ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/213ead72a2ec49ac8a38d1affaa83fc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=c7CMmh%2FKcgtL1LeOyt%2BLtIYnCv8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ç§åè®®ç‰¹æ€§ä½¿å…¶æˆä¸ºå¤§æ•°æ®é‡ä¸‹å®æ—¶é€šä¿¡åœºæ™¯çš„é¦–é€‰æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-7">1.3 AI æ—¶ä»£ WebSocket åè®®çš„å¤å…´</h3>
<p>éšç€å¤§æ¨¡å‹æŠ€æœ¯çš„çˆ†å‘ï¼Œè¶Šæ¥è¶Šå¤šéœ€è¦å®æ—¶äº¤äº’çš„åœºæ™¯å¼€å§‹å‡ºç°ï¼Œæ™ºèƒ½åŒ–èµ‹äºˆäº† WebSocket åè®®æ–°çš„æ´»åŠ›ï¼š</p>
<ul>
<li>æ”¯æŒå®æ—¶å¯¹è¯ä¸äº¤äº’çš„æ™ºèƒ½å®¢æœæˆ–æœºå™¨äºº</li>
<li>è½¦è½½ AI åŠ©æ‰‹ä¸äº‘ç«¯æ¨¡å‹å®æ—¶äº¤äº’</li>
<li>è‡ªåŠ¨ç¿»è¯‘ã€æ™ºèƒ½è¯†å›¾çš„ AI æ™ºèƒ½çœ¼é•œ</li>
</ul>
<p>é™¤å®æ—¶æ€§å¤–ï¼ŒWebSocket ä¸ºæœ‰çŠ¶æ€çš„è¿æ¥ï¼Œå¤šè½®å¯¹è¯çš„è®°å¿†ä¿æŒã€å³æ—¶æ‰“æ–­è¾“å‡ºç­‰åŠŸèƒ½ä¹Ÿæ¯”ä¼ ç»Ÿçš„ HTTP æ›´åŠ å®¹æ˜“å®ç°ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸»æµçš„å¤§æ¨¡å‹æä¾›å•†å¤§å¤šéƒ½æä¾›äº† WebSocket çš„äº¤äº’ API åŠé…å¥—çš„ SDKï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°æ„å»ºåç«¯æœåŠ¡ç³»ç»Ÿï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>OpenAI æ”¯æŒåŸºäº WebSocket çš„ Realtime API <strong>[</strong> <strong>4]</strong></li>
<li>ç™¾ç‚¼å¤§æ¨¡å‹æœåŠ¡å¹³å°å‘å¸ƒåŸºäº WebSocket çš„å®æ—¶å¤šæ¨¡æ€äº¤äº’åè®® <strong>[</strong> <strong>5]</strong></li>
<li>Google Gemini æ”¯æŒåŸºäº WebSocket çš„ Live API <strong>[</strong> <strong>6]</strong></li>
</ul>
<p>WebSocket åœ¨èµ‹èƒ½ AI åº”ç”¨å®æ—¶æ€§çš„åŒæ—¶ï¼Œä¹Ÿä¸ºåº”ç”¨ç³»ç»Ÿçš„å¯è§‚æµ‹æ€§å¸¦æ¥äº†å¾ˆå¤§çš„æŒ‘æˆ˜ã€‚WebSocket åè®®é«˜åº¦çš„çµæ´»æ€§ä¸æ‰©å±•æ€§æ³¨å®šäº†å®ƒä¸èƒ½åƒ HTTP å’Œ gRPC é‚£æ ·éå¸¸æ–¹ä¾¿åœ°åšåˆ°å…¨é“¾è·¯å¯è§‚æµ‹ï¼Œæœ¬æ–‡æ¥ä¸‹æ¥å°†å…·ä½“åˆ†æ WebSocket åœºæ™¯ä¸‹å…¨é“¾è·¯å¯è§‚æµ‹çš„å®ç°ç—›ç‚¹ä¸è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-8">WebSocket å…¨é“¾è·¯å¯è§‚æµ‹ç—›ç‚¹åˆ†æ</h2>
<h3 data-id="heading-9">2.1 åè®®çµæ´»æ€§å¸¦æ¥çš„é“¾è·¯è¿½è¸ªå›°å¢ƒ</h3>
<h4 data-id="heading-10">2.1.1 é“¾è·¯ä¿¡æ¯æ³¨å…¥éš¾</h4>
<p>å¯¹äºå¸¸è§„çš„ HTTP è°ƒç”¨ï¼Œä¸ºäº†ä¿è¯é“¾è·¯çš„è¿é€šæ€§ï¼Œè°ƒç”¨æ–¹ä¼šåœ¨ HTTP headers ä¸­é¢å¤–æ·»åŠ ä¸€ç»„ç”¨äºæ‰¿è½½é“¾è·¯ä¸Šä¸‹æ–‡çš„é”®å€¼å¯¹ï¼Œç¡®ä¿è¢«è°ƒç”¨æ–¹åœ¨è§£æåè®®æ—¶èƒ½å¤Ÿæ­£ç¡®åœ°è¿˜åŸè°ƒç”¨æ–¹çš„é“¾è·¯ä¸Šä¸‹æ–‡ï¼Œè¿›è€Œä¿è¯ä¸Šä¸‹æ–‡å¯ä»¥è¢«ç»§ç»­ä¼ é€’ä¸‹å»ã€‚å›¾ç¤ºæ˜¯ä½¿ç”¨ W3C é“¾è·¯è¿½è¸ªåè®® <strong>[</strong> <strong>7]</strong> æ—¶ï¼Œé“¾è·¯ä¸Šä¸‹æ–‡çš„ header çš„ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aaf274625aa845d788f096c2488b3bdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=JZ5Em8skYNt%2FI4H7TVU9iF%2BKxvU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è€Œåœ¨ 1.1.3 èŠ‚æˆ‘ä»¬äº†è§£åˆ°ï¼Œä¸€ä¸ª WebSocket æ•°æ®å¸§å…¶å®ä»…ç”±æ•°å­—èŠ‚çš„æ§åˆ¶ä½å’Œæ•°æ®è½½è·æ„æˆã€‚é™¤å»ºç«‹è¿æ¥æ—¶æ¡æ‰‹ä»¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–çš„æœºä¼šä¼ è¾“ header è¿™äº›å…ƒæ•°æ®ã€‚å› æ­¤ï¼Œä¼ ç»Ÿ OpenTelemetry çš„ W3C é“¾è·¯ä¸Šä¸‹æ–‡æ— æ³•ç›´æ¥æ¤å…¥æ¯ä¸ªæ•°æ®å¸§ä¸­ã€‚è€Œåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯¹äºä¸€æ¬¡ WebSocket è¿æ¥ï¼Œå¾€å¾€å¹¶ä¸ä»£è¡¨ä»…ä¸€æ¬¡ WebSocket è°ƒç”¨ï¼Œä»…ä¾èµ–å»ºç«‹è¿æ¥æ—¶çš„ HTTP è¯·æ±‚ä¸å“åº”æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿç‰µæ‰¯å‡ºç¬¬äºŒä¸ªå›°éš¾â€”â€”Span ä½œç”¨åŸŸç•Œå®šæ¨¡ç³Šã€‚</p>
<h4 data-id="heading-11">2.1.2 Span ä½œç”¨åŸŸç•Œå®šæ¨¡ç³Š</h4>
<p>åœ¨å¯è§‚æµ‹é¢†åŸŸï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠè°ƒç”¨é“¾è·¯ä¸Šä¸€æ¬¡å…³é”®çš„æ“ä½œç§°ä¸ºä¸€æ¡ Spanï¼ˆè·¨åº¦ï¼‰ <strong>[</strong> <strong>8]</strong> ï¼Œä¸€æ¡è°ƒç”¨é“¾ä¸€èˆ¬ç”±ä¸€ç»„æ ‘çŠ¶ç»“æ„çš„ Span ç»„æˆã€‚åœ¨å¯è§‚æµ‹å‰ç«¯çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŒå±äºä¸€æ¡è°ƒç”¨é“¾çš„ Span å¬å›ï¼Œå¹¶æ ¹æ®çˆ¶å­å…³ç³»ï¼ˆä¹Ÿå°±æ˜¯è°ƒç”¨å…³ç³»ï¼‰ä»¥åŠå‘ç”Ÿæ—¶é—´æ¸²æŸ“ä¸ºä¸‹å›¾æ‰€ç¤ºçš„ç€‘å¸ƒå›¾ï¼Œä»¥æ­¤æ¥å¸®åŠ©æˆ‘ä»¬äº†è§£ä¸€æ¡é“¾è·¯å‘ç”Ÿçš„æ‰€æœ‰å…³é”®æ“ä½œä»¥åŠè°ƒç”¨å…³ç³»ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b45f8da1ce5c4769b633a16fbefe80d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=tMGgJdacc0KFUbsNUHSVH9ZD5kY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶è€Œï¼Œåœ¨ WebSocket åœºæ™¯ä¸‹ï¼Œæ“ä½œç²’åº¦çš„å®šä¹‰å¯ä»¥éå¸¸çµæ´»ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œä¸€ä¸ª Span æœ‰å¯èƒ½å¯¹åº”ä¸€æ¬¡ WebSocket è¿æ¥ä»å¼€å§‹åˆ°ç»“æŸçš„å…¨è¿‡ç¨‹ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¹åº”æ¯ä¸€æ¬¡æ¶ˆæ¯çš„æ”¶å‘ï¼Œç”šè‡³ä¹Ÿå¯ä»¥å¯¹åº”æ¯ä¸€æ¬¡æ•°æ®å¸§çš„ä¼ é€’è¿‡ç¨‹ã€‚å¯¹ Span ç²’åº¦å®šä¹‰çš„é«˜åº¦çµæ´»ä¹Ÿå¯¼è‡´äº†é“¾è·¯ä¸Šä¸‹æ–‡åœ¨æ³¨å…¥ä¸ç®¡ç†ä¸Šä¹Ÿä¼šæœ‰éå¸¸å¤§çš„å˜åŒ–ï¼Œè¿™ä¹Ÿå¢å¤§äº†ä¸šåŠ¡ä¸Šè½åœ°çš„éš¾åº¦ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61a6f4b831234030b1a14715fed53089~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=0dIHTkc8ItpcLo8tF8jAF54Khns%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-12">2.1.3 é“¾è·¯ä¸Šä¸‹æ–‡çš„åå‘æ‰©æ•£é—®é¢˜</h4>
<p>è™½ç„¶æˆ‘ä»¬æ ¹æ® WebSocket è¿æ¥çš„å‘èµ·æ–¹ä¸æ¥æ”¶æ–¹å°†ä¸¤ç«¯åˆ†ä¸ºäº† Client å’Œ Serverï¼Œä½†å®é™…ä¸šåŠ¡çš„å¤„ç†è¿‡ç¨‹æ˜¯é«˜åº¦çµæ´»çš„åŒå‘æµï¼Œå¯èƒ½å­˜åœ¨ç”± Server ä¾§å‘èµ·è¯·æ±‚ï¼ŒClient è¿›è¡Œå¤„ç†çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå…è®¸ Client ä¸»åŠ¨ä¸ Server å»ºç«‹è¿æ¥å¹¶å°†è‡ªèº«æœåŠ¡æ³¨å†Œç»™ Server ç«¯ï¼Œç”± Server å‘é€æ¶ˆæ¯æ¥å¯¹ Client è¿›è¡Œå›è°ƒã€‚å¯¹äºè¿™ç§äº¤äº’æ–¹å¼è€Œè¨€ï¼Œæ¶ˆæ¯ç”Ÿäº§æ–¹ï¼ˆè°ƒç”¨æ–¹ï¼‰æ˜¯ Serverï¼Œæ¶ˆè´¹æ–¹ï¼ˆè¢«è°ƒç”¨æ–¹ï¼‰æ˜¯ Clientï¼Œå› æ­¤é“¾è·¯ä¸Šä¸‹æ–‡åº”è¯¥ç”± Server æ³¨å…¥åˆ°æ¶ˆæ¯ä¸­ï¼Œç”± Client è¿˜åŸå¹¶è¿›ä¸€æ­¥ä¼ é€’ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/156f2d0d0df54b4d9007f129ee2b59cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=E1ECT%2FpAqvV3FM9IuWzJ6wAn%2BR8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-13">2.2 å¼‚æ­¥è°ƒç”¨å¼•å‘çš„æ–­é“¾å±æœº</h3>
<p>åœ¨ WebSocket åº”ç”¨ä¸­ï¼Œä¸ºäº†æé«˜è¿æ¥åˆ©ç”¨ç‡ï¼Œä¸¤ç«¯ä¹Ÿå¸¸ç”¨å¼‚æ­¥çš„æ–¹å¼æ¥è§£è€¦æ¶ˆæ¯æ¥æ”¶è¿‡ç¨‹ä¸å¤„ç†è¿‡ç¨‹ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå…¸å‹çš„å¼‚æ­¥æ¶ˆæ¯å¤„ç†æ¶æ„ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯æœ‰å¯èƒ½ä¼šç›´æ¥è¢«æäº¤åˆ°çº¿ç¨‹æ± ï¼Œä¹Ÿæœ‰å¯èƒ½å­˜æ”¾åœ¨ä¸€ä¸ªè¿›ç¨‹å†…çš„é˜Ÿåˆ—ï¼Œç”šè‡³ç›´æ¥å†™å…¥ Redis ç­‰å¤–éƒ¨å­˜å‚¨ã€‚è¿™ç§çµæ´»å¤šå˜çš„å¼‚æ­¥æ–¹å¼ä¹Ÿç»™é“¾è·¯ä¸Šä¸‹æ–‡çš„è¿›ç¨‹å†…é€ä¼ å¸¦æ¥äº†å›°éš¾ï¼Œéå¸¸å®¹æ˜“å‡ºç°æ–­é“¾é—®é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd549381fe484dd391b81e0da8dc88d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=U4ELeDMOl6XmpFAm%2BC0yIno5nrU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-14">åŸºäº LoongSuite çš„å…¨é“¾è·¯è§‚æµ‹æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-15">3.1 æ–¹æ¡ˆåŸºæœ¬åŸç†</h3>
<p>é€šè¿‡ä¸Šä¸¤èŠ‚çš„è®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ä¸ªåŸºæœ¬ç»“è®ºï¼š</p>
<ul>
<li>WebSocket çš„ç”¨æ³•ç›¸å½“çµæ´»ï¼Œé“¾è·¯è¿½è¸ªçš„å®ç°å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¸šåŠ¡å®ç°ï¼Œéœ€è¦å¼€å‘è€…è‡ªä¸»å®ç°ä¸€äº›æ‰©å±•æ¥ä¿è¯é“¾è·¯å®Œæ•´æ€§</li>
<li>é«˜é¢‘ä¸šåŠ¡åœºæ™¯ç¼ºå°‘ä¸€äº›æœ€ä½³è½åœ°èŒƒå¼ï¼Œå¯¼è‡´è‡ªä¸»å®ç°é“¾è·¯è¿½è¸ªå›°éš¾</li>
</ul>
<p>æ­¤å¤–ï¼Œç”±äº WebSocket é“¾è·¯ä¸Šä¹Ÿéš¾å…å­˜åœ¨ä¸€äº› NoSQLã€HTTP ç­‰å…¶ä»–ç±»å‹çš„è°ƒç”¨ï¼Œä¾ç„¶éœ€è¦æ— ä¾µå…¥æ¢é’ˆæ¥ä¿è¯å„ç§è°ƒç”¨çš„ä¸²è”ï¼Œè¿™å°±è¦æ±‚æ— ä¾µå…¥æ¢é’ˆä¸è‡ªå®šä¹‰æ‰©å±•äº§ç”Ÿçš„é“¾è·¯ä¸Šä¸‹æ–‡å¯ä»¥å¾ˆå¥½åœ°äº’é€šã€‚LoongSuite æ— ä¾µå…¥æ¢é’ˆæä¾›çš„åŸºäº OpenTelemetry API çš„æ‰©å±•æœºåˆ¶å°±æ˜¯è§£å†³è¿™äº›é—®é¢˜çš„æœ€ä½³æ‰‹æ®µ <strong>[</strong> <strong>9]</strong> ã€‚</p>
<h4 data-id="heading-16">3.1.1 OpenTelemetry API ä¸ LoongSuite æ¢é’ˆå·¥ä½œåŸç†</h4>
<p>OpenTelemetry API æ˜¯ OpenTelemetry ç¤¾åŒºå®šä¹‰çš„å¯è§‚æµ‹æ•°æ®é‡‡é›†æ ‡å‡†çš„é‡è¦ç»„ä»¶ä¹‹ä¸€ <strong>[</strong> <strong>10]</strong> ï¼Œå®ƒå®šä¹‰äº†ä¸€æ•´å¥—å¯è§‚æµ‹é¢†åŸŸä½¿ç”¨çš„ API è¡Œä¸ºæ ‡å‡†å’ŒåŠŸèƒ½è¯´æ˜ï¼Œæ¯”å¦‚å¯è§‚æµ‹æ•°æ®åˆ›å»ºã€ä¸Šä¸‹æ–‡ç®¡ç†/é€ä¼ ã€æ•°æ®ä¸ŠæŠ¥ç­‰é€»è¾‘ï¼Œå¹¶ä¸ºè®¸å¤šè¯­è¨€æä¾›äº†é…å¥—çš„ SDK å®ç°ã€‚ä½¿ç”¨è€…å¯ä»¥åŸºäº API ä¸ SDK æ¯”è¾ƒå®¹æ˜“åœ°å®ç°ä¸Šä¸‹æ–‡çš„ç®¡ç†ä¸é€ä¼ ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Tracer API å®šä¹‰ Span çš„ç¤ºæ„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">privateÂ intÂ doWork()Â {
Â Â // åˆ›å»º span
Â Â SpanÂ <span class="hljs-attr">doWorkSpan</span>Â =Â tracer.spanBuilder(<span class="hljs-string">"doWork"</span>).startSpan()<span class="hljs-comment">;</span>
Â Â // æ¿€æ´» span æ‰€åœ¨ä¸Šä¸‹æ–‡
Â Â tryÂ (ScopeÂ <span class="hljs-attr">scope</span>Â =Â doWorkSpan.makeCurrent()) {
Â  Â Â intÂ <span class="hljs-attr">result</span>Â =Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
Â  Â Â forÂ (intÂ <span class="hljs-attr">i</span>Â =Â <span class="hljs-number">0</span><span class="hljs-comment">; i &lt;Â 10; i++) {</span>
Â  Â  Â  result += i<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â returnÂ result<span class="hljs-comment">;</span>
Â  }Â finallyÂ {
Â  Â Â // ç»“æŸ span
Â  Â  doWorkSpan.end()<span class="hljs-comment">;</span>
Â  }
}
</code></pre>
<p>LoongSuite æ¢é’ˆæ˜¯é˜¿é‡Œäº‘å¯è§‚æµ‹å›¢é˜ŸåŸºäº OpenTelemetry æ¢é’ˆæ„å»ºçš„ï¼Œé¢å‘ AI åº”ç”¨çš„å¼€æºçš„è¿›ç¨‹å†…å¯è§‚æµ‹é‡‡é›†ç»„ä»¶ã€‚å¯¹äºçƒ­é—¨çš„å¼€æºç»„ä»¶ï¼Œä¾‹å¦‚ LangChainã€OpenAI SDKã€Tomcat ç­‰ï¼ŒLoongSuite æ¢é’ˆæä¾›äº†ä¸°å¯Œçš„é¢„å®šä¹‰æ’æ¡©å®ç°ã€‚ä½¿ç”¨è€…ä¸å†éœ€è¦åŸºäº OpenTelemetry API è¿›è¡Œå¼€å‘ï¼Œåªéœ€è¦ä¿®æ”¹ç¼–è¯‘æˆ–è¿è¡Œæ—¶å‘½ä»¤ï¼Œæ¢é’ˆå°±èƒ½æŠŠå¯è§‚æµ‹æ•°æ®åˆ›å»ºã€ä¸Šä¸‹æ–‡ç®¡ç†/é€ä¼ ã€æ•°æ®ä¸ŠæŠ¥ç­‰å…³é”®é€»è¾‘è‡ªåŠ¨å®Œæˆï¼Œä»è€Œè¾¾æˆæ— ä¾µå…¥å¯è§‚æµ‹çš„ç›®æ ‡ã€‚</p>
<p>LoongSuite æ¢é’ˆå¯ä»¥æ»¡è¶³ç”Ÿäº§åº”ç”¨ç»å¤§å¤šæ•°åœºæ™¯ä¸‹çš„å¯è§‚æµ‹éœ€æ±‚ï¼Œä½†å¯¹äºä¸€äº›é«˜åº¦è‡ªå®šä¹‰çš„åœºæ™¯ï¼Œå¦‚æ¶ˆæ¯ç³»ç»Ÿä¸­çš„å¤æ‚æ¶ˆè´¹è¿‡ç¨‹ã€éƒ¨åˆ† MQTT åœºæ™¯ä»¥åŠ WebSocket é€šä¿¡åœºæ™¯ï¼Œä½¿ç”¨ OpenTelemetry API/SDK æ·»åŠ è‡ªå®šä¹‰åŸ‹ç‚¹åˆ™æ˜¯å¼¥è¡¥æ— ä¾µå…¥æ¢é’ˆç›‘æ§ç›²åŒºçš„æœ€ä¼˜æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-17">3.1.2 LoongSuite æ¢é’ˆä¸è‡ªå®šä¹‰æ‰©å±•äº¤äº’ç¤ºæ„</h4>
<p>å¯¹äº Javaã€Golang è¿™ç±»åŒ…ç®¡ç†ç›¸å¯¹ä¸¥æ ¼ï¼ˆéœ€è¦æ˜ç¡®æŒ‡å®šç‰ˆæœ¬ï¼‰çš„è¯­è¨€æ¥è¯´ï¼Œæ¢é’ˆä¸åº”ç”¨å¯èƒ½ä¼šå­˜åœ¨ç‰ˆæœ¬ä¸ä¸€è‡´çš„ä¾èµ–ï¼Œæ¯”å¦‚ Jacksonã€gRPC å’Œ OpenTelemetry API/SDK ç­‰ç­‰ã€‚ä¸ºäº†é¿å…ä¾èµ–å†²çªï¼Œå¸¸é‡‡ç”¨ shadow çš„æ–¹å¼è¿›è¡Œä¾èµ–éš”ç¦»ã€‚ä½†è¿™ä¹Ÿä¼šå¯¼è‡´ç”¨æˆ·åœ¨ä½¿ç”¨ OpenTelemetry API å’Œ SDK è‡ªä¸»åŸ‹ç‚¹çš„æ—¶å€™ï¼Œäº§ç”Ÿçš„é“¾è·¯ä¸Šä¸‹æ–‡å¹¶ä¸èƒ½ä¸æ¢é’ˆå†…äº’é€šï¼Œè¿›è€Œå¯¼è‡´è°ƒç”¨é“¾æ–­è£‚ã€‚</p>
<p>OpenTelemetry å’Œ LoongSuite æ¢é’ˆåŒæ ·é‡‡ç”¨ä»£ç å¢å¼ºæœºåˆ¶ä¿è¯äº†é“¾è·¯ä¸Šä¸‹æ–‡çš„å…±äº«ï¼Œå…·ä½“æ•´ä½“ç¤ºæ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4577a2ca81bc4904a9eeb9bb187db058~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=gVcx8e6nZY7xAKgYjNqlDKu5VHs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æ¢é’ˆå’Œåº”ç”¨å…±ç”¨ä¸€å¥— APIï¼ŒAPI è‡ªèº«ä¿è¯å‘å‰å…¼å®¹</li>
<li>æ¢é’ˆåˆå§‹åŒ–æ—¶ï¼Œä¼šå°†åˆå§‹åŒ–å¥½çš„å®ä¾‹å¯¹è±¡æ³¨å†Œåˆ° GlobalHolderï¼Œåº”ç”¨ä¸­è‡ªå®šä¹‰åŸ‹ç‚¹æ—¶ï¼Œç›´æ¥ä» API ä¸­çš„ GlobalHolder å°±å¯ä»¥è·å–åˆ°æ¢é’ˆçš„å®ä¾‹å¯¹è±¡</li>
<li>å¯¹äº SDK ä¸­å®šä¹‰çš„ä¸€äº›æ–¹æ³•å’Œé™æ€çš„ APIï¼Œå¦‚ Contextã€Baggage ç­‰ï¼Œé€šè¿‡ä»£ç å¢å¼ºçš„æ–¹å¼ï¼Œè·³è¿‡è¿™äº›å‡½æ•°åŸæœ¬çš„è°ƒç”¨ï¼Œè½¬è€Œä½¿ç”¨æ¢é’ˆä¸­å¯¹åº”çš„å®ç°</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šæœºåˆ¶ï¼ŒLoongSuite æ¢é’ˆå¯ä»¥å¾ˆå¥½åœ°å’Œ OpenTelemetry API/SDK åˆ›å»ºçš„ Span ä¸²è”åœ¨ä¸€èµ·ï¼Œä¿è¯äº†é“¾è·¯çš„å®Œæ•´æ€§ã€‚</p>
<h3 data-id="heading-18">3.2 WebSocket åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæœ€ä½³å®è·µ</h3>
<p>äº†è§£äº†è¿™å‡ ä¸ªç»„ä»¶ï¼Œå…³é”®çš„é—®é¢˜æ˜¯ï¼Œæˆ‘çš„åº”ç”¨åº”è¯¥æ€ä¹ˆæ·»åŠ è¿™äº›è‡ªå®šä¹‰çš„åŸ‹ç‚¹å‘¢ï¼Ÿåœ¨ WebSocket å…¨é“¾è·¯çš„å®ç°ä¸­ï¼Œéœ€è¦å…ˆæ ¹æ®ä¸šåŠ¡è¯‰æ±‚æ˜ç¡®å‡ ä¸ªé—®é¢˜ï¼š</p>
<p><strong>ä¼šè¯ç²’åº¦é—®é¢˜ï¼š</strong> ä¸€æ¬¡ WebSocket è¿æ¥å¯¹åº”ä¸€æ¡ Trace è¿˜æ˜¯å¤šæ¡ Traceï¼Ÿ</p>
<ul>
<li>å¯¹åº”ä¸€æ¡ Traceï¼šä¸€æ¬¡ WebSocket è¿æ¥æ˜¯ä¸ºäº†å®Œæˆä¸€ç³»åˆ—ç›¸å…³æ€§å¼ºçš„æ“ä½œï¼Œä¸”æŒç»­æ—¶é—´ä¸€èˆ¬ä»…åœ¨æ•°åˆ†é’Ÿï¼›</li>
<li>å¯¹åº”å¤šæ¡ Traceï¼šä¸€æ¬¡ WebSocket è¿æ¥ä¼šåœ¨å»ºç«‹å®Œæˆåç•™å­˜ä¸‹æ¥æŒç»­å¤ç”¨ï¼ŒæŒç»­æ—¶é—´å¯èƒ½æŒç»­å‡ å°æ—¶ã€‚</li>
</ul>
<p><strong>è°ƒç”¨å»ºæ¨¡é—®é¢˜ï¼š</strong> WebSocket å†…éƒ¨çš„æ•°æ®ä¼ è¾“è¿‡ç¨‹èƒ½å¦å»ºæ¨¡ä¸ºç¦»æ•£çš„è¯·æ±‚ä¸å“åº”ï¼Ÿ</p>
<ul>
<li>å¦‚æœè¿æ¥å»ºç«‹ååªç”¨äºåŒæ–¹ä¼ é€’æ•°æ®ï¼Œåˆ™ä¸éœ€è¦ä¸ºæ¯æ¡æ¶ˆæ¯ä¸“é—¨åˆ›å»º Spanï¼Œä¸€ä¸ª Span çš„ç”Ÿå‘½å‘¨æœŸåº”è¯¥å¯¹åº”åŒæ–¹ä¼ é€’æ¶ˆæ¯çš„å®Œæ•´è¿‡ç¨‹ï¼›</li>
<li>å¦‚æœè¿æ¥å»ºç«‹åï¼Œä¸€æ–¹å‘é€æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹å¤„ç†æ¶ˆæ¯å¹¶è¿”å›å“åº”ï¼Œåˆ™æ¯ç»„è¿™ç±»è°ƒç”¨éƒ½å¯ä»¥åˆ›å»ºä¸€å¯¹çˆ¶å­ Spanï¼Œå¯¹åº”çš„æ•°æ®ç»“æ„éœ€è¦å…è®¸æ‰¿è½½åºåˆ—åŒ–åçš„é“¾è·¯ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<p>åº”å¯¹ä»¥ä¸Šå‡ ä¸ªä¸åŒåœºæ™¯ï¼Œè‡ªå®šä¹‰åŸ‹ç‚¹çš„å®ç°æ¨èä¹Ÿä¼šæœ‰æ‰€å·®å¼‚ï¼Œæ¥ä¸‹æ¥å°†åˆ†åˆ«å±•å¼€ä»‹ç»ã€‚</p>
<h4 data-id="heading-19">3.2.1 å¼•å…¥ OpenTelemetry API ä¾èµ–</h4>
<blockquote>
<p>æ¢é’ˆå¯¹ API çš„å…¼å®¹ä¸ºå‘å‰å…¼å®¹ï¼Œå¯¹äºæœ€æ–°ç‰ˆæœ¬çš„ API é€‚é…å¯èƒ½æ¯”è¾ƒæœ‰é™ï¼Œç”Ÿäº§ç¯å¢ƒä¸­ API åŒ…çš„ç‰ˆæœ¬ä¸éœ€è¦è¿‡æ–°ï¼ŒåŸºæœ¬ API è¶³å¤Ÿä½¿ç”¨å³å¯ã€‚</p>
</blockquote>
<p>å¯¹äº Java è¯­è¨€ï¼Œå»ºè®®åœ¨ pom.xml ä¸­å¼•å…¥ã€‚API æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjavadoc.io%2Fdoc%2Fio.opentelemetry%2Fopentelemetry-api%2F1.28.0%2Findex.html" target="_blank" title="https://javadoc.io/doc/io.opentelemetry/opentelemetry-api/1.28.0/index.html" ref="nofollow noopener noreferrer">javadoc.io/doc/io.openâ€¦</a></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.opentelemetry<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>opentelemetry-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>è·å–æ¢é’ˆæ³¨å…¥çš„å…¨å±€å®ä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">openTelemetry</span>Â = GlobalOpenTelemetry.get()<span class="hljs-comment">;</span>
<span class="hljs-attr">tracer</span>Â = openTelemetry.getTracer(<span class="hljs-string">"websocket-example"</span>,Â <span class="hljs-string">"1.0.0"</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>å¯¹äº Golang è¯­è¨€ï¼Œå¯ä»¥æ‰§è¡Œ go get å‘½ä»¤è·å–åŒ…ã€‚API æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fgo.opentelemetry.io%2Fotel%40v1.28.0" target="_blank" title="https://pkg.go.dev/go.opentelemetry.io/otel@v1.28.0" ref="nofollow noopener noreferrer">pkg.go.dev/go.openteleâ€¦</a></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">go</span>Â getÂ <span class="hljs-keyword">go</span>.opentelemetry.io/otel
</code></pre>
<p>è·å–æ¢é’ˆæ³¨å…¥çš„å…¨å±€å®ä¾‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">tracer := otel.<span class="hljs-built_in">GetTracerProvider</span>().<span class="hljs-built_in">Tracer</span>(<span class="hljs-string">"websocket-example"</span>)
</code></pre>
<p>å¯¹äº Python è¯­è¨€ï¼Œå¯ä»¥é€šè¿‡ pip install è·å–ã€‚API æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopentelemetry-python.readthedocs.io%2Fen%2Flatest%2F" target="_blank" title="https://opentelemetry-python.readthedocs.io/en/latest/" ref="nofollow noopener noreferrer">opentelemetry-python.readthedocs.io/en/latest/</a></p>
<pre><code class="hljs">pipÂ install opentelemetry-api
</code></pre>
<p>è·å–æ¢é’ˆæ³¨å…¥çš„å…¨å±€å®ä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">fromÂ opentelemetryÂ importÂ trace
<span class="hljs-attr">tracer</span> = trace.get_tracer(__name__)
</code></pre>
<h4 data-id="heading-20">3.2.2 ä¼šè¯ç²’åº¦é—®é¢˜â€”â€”åˆ›å»º WebSocket è¿æ¥ç»´åº¦çš„ Trace</h4>
<p><strong>å®ç°å»ºè®®ï¼š</strong> WebSocket åœ¨å»ºç«‹è¿æ¥æ—¶ä¼šåŸºäº HTTP è¯·æ±‚å‘èµ·æ¡æ‰‹ï¼Œå¤ç”¨è¯¥ Trace ä¸Šä¸‹æ–‡ä½œä¸ºæ•´æ¬¡ WebSocket è¿æ¥ä¸­å­æ“ä½œçš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä»¥ä¸€æ•´ä¸ª WebSocket è¿æ¥ä¸ºä¸€æ¡ Trace çš„å®ç°åŸºæœ¬ç¤ºæ„å›¾ï¼Œæ‰€æœ‰çš„è¯·æ±‚ä¸æ•°æ®ä¼ é€’éƒ½ä½œä¸ºå­ Span æŒ‚é åœ¨ä¸€æ¡ Trace ä¸‹é¢ã€‚å› æ­¤ï¼Œè¿™ç§å®ç°æ›´é€‚åˆ WebSocket è¿æ¥æŒ‰éœ€è¿æ¥å¹¶ä¼šåŠæ—¶å…³é—­çš„åœºæ™¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b2c8e553b85415ba9d994c662b7b407~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=gfzt3GBvWKXkZm6YggkDJxQK0iY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Client ä¾§ä»£ç å®ç°ï¼ˆä»¥ Java åŸç”Ÿæä¾›çš„ WebSocket åº“ä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">main</span>(<span class="hljs-title class_">String</span>[] args) throwsÂ <span class="hljs-title class_">Exception</span>Â {
Â Â <span class="hljs-comment">// 1. åˆ›å»ºè¿æ¥çº§åˆ«çš„ Traceï¼ˆåœ¨è¿æ¥å‰åˆ›å»ºï¼Œä»¥ä¾¿åœ¨æ¡æ‰‹æ—¶ä¼ é€’ TraceContextï¼‰</span>
Â Â <span class="hljs-title class_">Span</span>Â connectionSpan = tracer.<span class="hljs-title function_">spanBuilder</span>(<span class="hljs-string">"websocket.connection"</span>)
Â  Â  Â  .<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"websocket.endpoint"</span>,Â <span class="hljs-string">"/native/ws"</span>)
Â  Â  Â  .<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"websocket.destination"</span>,Â <span class="hljs-string">"ws://localhost:18081"</span>)
Â  Â  Â  .<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"websocket.connection.type"</span>,Â <span class="hljs-string">"client"</span>)
Â  Â  Â  .<span class="hljs-title function_">startSpan</span>();
Â Â <span class="hljs-comment">// 2. å°†å½“å‰ Span æ¿€æ´»åœ¨çº¿ç¨‹å†…çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ ‡è®° Span çš„ä½œç”¨åŸŸä¸ºä»è¿æ¥å¼€å§‹åˆ°è¿æ¥å…³é—­</span>
Â Â <span class="hljs-keyword">try</span>Â (<span class="hljs-title class_">Scope</span>Â scope = connectionSpan.<span class="hljs-title function_">makeCurrent</span>()) {
Â  Â Â <span class="hljs-title class_">WebSocketContainer</span>Â container =Â <span class="hljs-title class_">ContainerProvider</span>.<span class="hljs-title function_">getWebSocketContainer</span>();
Â  Â Â <span class="hljs-comment">// åˆ›å»º WebSocket Client</span>
Â  Â Â <span class="hljs-title class_">NativeWebSocketClient</span>Â client =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">NativeWebSocketClient</span>();
Â  Â Â <span class="hljs-comment">// ä½¿ç”¨ Endpoint æ–¹å¼è¿æ¥</span>
Â  Â Â <span class="hljs-title class_">Session</span>Â session = container.<span class="hljs-title function_">connectToServer</span>(
Â  Â  Â  Â Â <span class="hljs-keyword">new</span>Â jakarta.<span class="hljs-property">websocket</span>.<span class="hljs-title class_">Endpoint</span>() {
Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onOpen</span>(<span class="hljs-params">SessionÂ session,Â EndpointConfigÂ config</span>) {
Â  Â  Â  Â  Â  Â  client.<span class="hljs-title function_">onOpen</span>(session);
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment">// æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨ï¼ˆä½¿ç”¨åŒ¿åå†…éƒ¨ç±»è€Œä¸æ˜¯ lambdaï¼Œé¿å…æ³›å‹ç±»å‹æ¨æ–­é—®é¢˜ï¼‰</span>
Â  Â  Â  Â  Â  Â  session.<span class="hljs-title function_">addMessageHandler</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">MessageHandler</span>.<span class="hljs-property">Whole</span>&lt;<span class="hljs-title class_">String</span>&gt;() {
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onMessage</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â message</span>) {
Â  Â  Â  Â  Â  Â  Â  Â  client.<span class="hljs-title function_">onMessage</span>(message);
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onClose</span>(<span class="hljs-params">SessionÂ session,Â CloseReasonÂ closeReason</span>) {
Â  Â  Â  Â  Â  Â  client.<span class="hljs-title function_">onClose</span>();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onError</span>(<span class="hljs-params">SessionÂ session,Â ThrowableÂ thr</span>) {
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment">// è®°å½•é”™è¯¯åˆ°å½“å‰ Span</span>
Â  Â  Â  Â  Â  Â  connectionSpan.<span class="hljs-title function_">recordException</span>(thr);
Â  Â  Â  Â  Â  Â  client.<span class="hljs-title function_">onError</span>(thr);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â Â <span class="hljs-comment">// 3. å‘èµ·æ¡æ‰‹æ—¶ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦å½“å‰çš„ä¸Šä¸‹æ–‡</span>
Â  Â  Â  Â Â <span class="hljs-title function_">createHeaderWithUserProperties</span>(),
Â  Â  Â  Â Â <span class="hljs-variable constant_">URI</span>.<span class="hljs-title function_">create</span>(<span class="hljs-string">"ws://localhost:18081/native/ws"</span>));
Â  Â  client.<span class="hljs-property">session</span>Â = session;
Â  Â  client.<span class="hljs-property">sessionId</span>Â = session.<span class="hljs-title function_">getId</span>();
Â  Â  log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å®¢æˆ·ç«¯å·²å¯åŠ¨ï¼Œè¾“å…¥æ¶ˆæ¯å‘é€ç»™æœåŠ¡å™¨ï¼ˆè¾“å…¥ 'exit' é€€å‡ºï¼‰:"</span>);
Â  Â Â <span class="hljs-comment">// ä»æ§åˆ¶å°è¯»å–è¾“å…¥</span>
Â  Â Â <span class="hljs-title class_">BufferedReader</span>Â reader =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">InputStreamReader</span>(<span class="hljs-title class_">System</span>.<span class="hljs-property">in</span>));
Â  Â Â <span class="hljs-title class_">String</span>Â line;
Â  Â Â <span class="hljs-keyword">while</span>Â ((line = reader.<span class="hljs-title function_">readLine</span>()) !=Â <span class="hljs-literal">null</span>Â &amp;&amp; !line.<span class="hljs-title function_">equals</span>(<span class="hljs-string">"exit"</span>)) {
Â  Â  Â Â <span class="hljs-keyword">if</span>Â (!line.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">isEmpty</span>()) {
Â  Â  Â  Â Â <span class="hljs-comment">// 4. å‘ Server å‘é€æ¶ˆæ¯</span>
Â  Â  Â  Â  client.<span class="hljs-title function_">sendMessage</span>(line);
Â  Â  Â  }
Â  Â  }
Â  Â Â <span class="hljs-comment">// å…³é—­è¿æ¥</span>
Â  Â  client.<span class="hljs-title function_">close</span>();
Â  Â  log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å®¢æˆ·ç«¯å·²é€€å‡º"</span>);
Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e) {
Â  Â Â <span class="hljs-comment">// å¦‚æœå‡ºç°é”™è¯¯ï¼Œè®°å½•åˆ° span ä¸­</span>
Â  Â  connectionSpan.<span class="hljs-title function_">recordException</span>(e);
Â  Â  log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å®¢æˆ·ç«¯å¯åŠ¨å¤±è´¥"</span>, e);
Â  }Â <span class="hljs-keyword">finally</span>Â {
Â  Â Â <span class="hljs-comment">// 5. ç»“æŸ span</span>
Â  Â  connectionSpan.<span class="hljs-title function_">end</span>();
Â  }
Â Â <span class="hljs-comment">// ç­‰å¾… span å¼‚æ­¥ä¸ŠæŠ¥ï¼Œå®é™…ä¸šåŠ¡ä¸­æ— éœ€ä¿ç•™</span>
Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">sleep</span>(5000L);
}
<span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-title class_">ClientEndpointConfig</span>Â <span class="hljs-title function_">createHeaderWithUserProperties</span>(<span class="hljs-params"/>) {
Â Â <span class="hljs-comment">// åˆ›å»º ClientEndpointConfigï¼Œç”¨äºè‡ªå®šä¹‰æ¡æ‰‹è¯·æ±‚å¤´</span>
Â Â <span class="hljs-title class_">ClientEndpointConfig</span>.<span class="hljs-property">Builder</span>Â configBuilder =Â <span class="hljs-title class_">ClientEndpointConfig</span>.<span class="hljs-property">Builder</span>.<span class="hljs-title function_">create</span>();
Â Â <span class="hljs-comment">// 3.1. è·å–å½“å‰çš„ TraceContextï¼Œå‡†å¤‡ HTTP headers</span>
Â  finalÂ <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;&gt; headersMap =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">HashMap</span>&lt;&gt;();
Â Â <span class="hljs-title class_">Context</span>Â currentContext =Â <span class="hljs-title class_">Context</span>.<span class="hljs-title function_">current</span>();
Â Â <span class="hljs-comment">// 3.2. é€šè¿‡å…¨å±€å®ä¾‹çš„ ContextPropagators æ³¨å…¥ TraceContext åˆ° headers</span>
Â  openTelemetry.<span class="hljs-title function_">getPropagators</span>().<span class="hljs-title function_">getTextMapPropagator</span>()
Â  Â  Â  .<span class="hljs-title function_">inject</span>(currentContext, headersMap, (carrier, key, value) -&gt; carrier.<span class="hljs-title function_">put</span>(key,Â <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(value)));
Â Â <span class="hljs-comment">// 3.3. è®¾ç½® Configurator æ¥åœ¨æ¡æ‰‹æ—¶æ·»åŠ  headers</span>
Â  configBuilder.<span class="hljs-title function_">configurator</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ClientEndpointConfig</span>.<span class="hljs-title class_">Configurator</span>() {
Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">beforeRequest</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,Â List&lt;<span class="hljs-built_in">String</span>&gt;&gt; headers</span>) {
Â  Â  Â  headers.<span class="hljs-title function_">putAll</span>(headersMap);
Â  Â  }
Â  });
Â Â <span class="hljs-keyword">return</span>Â configBuilder.<span class="hljs-title function_">build</span>();
}
</code></pre>
<p>Server ä¾§ä»£ç å®ç°ï¼ˆä»¥ Java åŸç”Ÿæä¾›çš„ WebSocket åº“ä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@ServerEndpoint</span>(value =Â <span class="hljs-string">"/native/ws"</span>, configurator =Â <span class="hljs-title class_">NativeWebSocketServer</span>.<span class="hljs-property">TraceContextConfigurator</span>.<span class="hljs-property">class</span>)
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NativeWebSocketServer</span>Â {
Â Â <span class="hljs-comment">// æŒ‰ç…§ session ç»´åº¦ç®¡ç†æ¥è‡ª Client çš„ä¸Šä¸‹æ–‡</span>
Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Context</span>&gt; connectionTraceContexts =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
Â Â <span class="hljs-comment">// 1. å®šä¹‰é…ç½®ç±»ï¼Œç”¨äºåœ¨æ¡æ‰‹æ—¶æå– TraceContext</span>
Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">TraceContextConfigurator</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_ inherited__">ServerEndpointConfig.Configurator</span>Â {
Â  Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ <span class="hljs-title class_">TextMapGetter</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;&gt;&gt; headerGetter =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">TextMapGetter</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;&gt;&gt;() {
Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Iterable</span>&lt;<span class="hljs-title class_">String</span>&gt;Â <span class="hljs-title function_">keys</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,Â List&lt;<span class="hljs-built_in">String</span>&gt;&gt; carrier</span>) {
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â carrier.<span class="hljs-title function_">keySet</span>();
Â  Â  Â  }
Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">get</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,Â List&lt;<span class="hljs-built_in">String</span>&gt;&gt; carrier,Â <span class="hljs-built_in">String</span>Â key</span>) {
Â  Â  Â  Â Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; values = carrier.<span class="hljs-title function_">get</span>(key);
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â values !=Â <span class="hljs-literal">null</span>Â &amp;&amp; !values.<span class="hljs-title function_">isEmpty</span>() ? values.<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>) :Â <span class="hljs-literal">null</span>;
Â  Â  Â  }
Â  Â  };
Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">modifyHandshake</span>(<span class="hljs-params">ServerEndpointConfigÂ sec,Â HandshakeRequestÂ request,Â HandshakeResponseÂ response</span>) {
Â  Â  Â Â <span class="hljs-comment">// ä» HTTP headers ä¸­æå– TraceContext</span>
Â  Â  Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;&gt; headers = request.<span class="hljs-title function_">getHeaders</span>();
Â  Â  Â Â <span class="hljs-title class_">Context</span>Â extractedContext = openTelemetry.<span class="hljs-title function_">getPropagators</span>()
Â  Â  Â  Â  Â  .<span class="hljs-title function_">getTextMapPropagator</span>()
Â  Â  Â  Â  Â  .<span class="hljs-title function_">extract</span>(<span class="hljs-title class_">Context</span>.<span class="hljs-title function_">current</span>(), headers, headerGetter);
Â  Â  Â Â <span class="hljs-comment">// 2. å°† TraceContext å­˜å‚¨åˆ° userPropertiesï¼Œåœ¨ onOpen æ—¶æå–</span>
Â  Â  Â  sec.<span class="hljs-title function_">getUserProperties</span>().<span class="hljs-title function_">put</span>(<span class="hljs-string">"traceContext"</span>, extractedContext);
Â  Â  }
Â  }
Â Â <span class="hljs-meta">@OnOpen</span>
Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onOpen</span>(<span class="hljs-params">SessionÂ session,Â EndpointConfigÂ config</span>) {
Â  Â Â <span class="hljs-title class_">String</span>Â sessionId = session.<span class="hljs-title function_">getId</span>();
Â  Â  sessions.<span class="hljs-title function_">put</span>(sessionId, session);
Â  Â Â <span class="hljs-comment">// 3. ä» config çš„ userProperties ä¸­æå– TraceContextï¼ˆåœ¨ Configurator ä¸­è®¾ç½®ï¼‰</span>
Â  Â Â <span class="hljs-title class_">Context</span>Â parentContext =Â <span class="hljs-title class_">Context</span>.<span class="hljs-title function_">current</span>();
Â  Â Â <span class="hljs-title class_">Object</span>Â traceContextObj = config.<span class="hljs-title function_">getUserProperties</span>().<span class="hljs-title function_">get</span>(<span class="hljs-string">"traceContext"</span>);
Â  Â Â <span class="hljs-keyword">if</span>Â (traceContextObjÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">Context</span>) {
Â  Â  Â  Â  parentContext = (<span class="hljs-title class_">Context</span>) traceContextObj;
Â  Â  }
Â  Â Â <span class="hljs-comment">// 4. å°† Client é“¾è·¯ä¸Šä¸‹æ–‡ä¿å­˜ä¸‹æ¥ï¼Œåœ¨éœ€è¦åˆ›å»ºå­ span æ—¶è·å–å³å¯</span>
Â  Â  connectionTraceContexts.<span class="hljs-title function_">put</span>(sessionId, parentContext);
Â  Â  log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å®¢æˆ·ç«¯è¿æ¥: sessionId={}, å½“å‰è¿æ¥æ•°={}, å·²ä» Client TraceContext åˆ›å»ºå­ Span"</span>, sessionId, sessions.<span class="hljs-title function_">size</span>());
Â  Â Â <span class="hljs-title function_">sendMessage</span>(session,Â <span class="hljs-string">"æ¬¢è¿è¿æ¥ï¼æ‚¨çš„ä¼šè¯ID: "</span>Â + sessionId);
Â  }
Â Â <span class="hljs-meta">@OnClose</span>
Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onClose</span>(<span class="hljs-params">SessionÂ session</span>) {
Â  Â Â <span class="hljs-title class_">String</span>Â sessionId = session.<span class="hljs-title function_">getId</span>();
Â  Â  sessions.<span class="hljs-title function_">remove</span>(sessionId);
Â  Â  connectionTraceContexts.<span class="hljs-title function_">remove</span>(sessionId);
Â  Â  log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å®¢æˆ·ç«¯æ–­å¼€: sessionId={}, å‰©ä½™è¿æ¥æ•°={}, Traceå·²ç»“æŸ"</span>, sessionId, sessions.<span class="hljs-title function_">size</span>());
Â  }
}
</code></pre>
<h4 data-id="heading-21">3.2.3 ä¼šè¯ç²’åº¦é—®é¢˜â€”â€”ä½¿ç”¨ä¼šè¯ ID å…³è”ä¸åŒçš„ Trace</h4>
<p><strong>å®ç°å»ºè®®ï¼š</strong> å¤ç”¨ WebSocket çš„ Session ID ä½œä¸ºæ¯æ¡ Span çš„å±æ€§ï¼Œåœ¨å¿…è¦æ—¶ä¹Ÿå¯ä»¥æŒ‰ç…§å±æ€§æŸ¥è¯¢æ¥è‡ªäºåŒä¸€ä¸ª WebSocket ä¼šè¯çš„æ‰€æœ‰ Traceã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ä¼šè¯ ID å…³è”ä¸åŒ Trace çš„å®ç°åŸºæœ¬ç¤ºæ„å›¾ï¼Œæ¯æ¬¡ Client ä¾§æˆ– Server ä¾§å‘èµ·çš„ä¸»åŠ¨è¯·æ±‚éƒ½æ˜¯ä¸€æ¡å•ç‹¬çš„ Traceï¼Œå½¼æ­¤ä¹‹é—´å¹¶ä¸ä¼šåœ¨ Trace ç€‘å¸ƒå›¾ä¸­å‘ˆç°å…³ç³»ï¼Œä½†å¯ä»¥é€šè¿‡ä¼šè¯ ID è¿™ä¸ªå±æ€§è¿›è¡Œè¿‡æ»¤å’ŒæŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¿™ç§å®ç°æ›´é€‚åˆ WebSocket è¿æ¥æ—¶é—´å¾ˆé•¿ï¼Œä¸”å¯èƒ½å­˜åœ¨å¤ç”¨çš„åœºæ™¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f0e6fa947114ba0b17c1972832d2087~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=MX%2B%2BPHdbiF7dDs1s%2BrjjX1sswGs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½¿ç”¨ä¼šè¯ ID å…³è”ä¸åŒ Trace å®ç°æ–¹æ¡ˆç›¸å¯¹ç®€å•ï¼Œå¤§å¤šæ•°æ¡†æ¶éƒ½èƒ½ç›´æ¥è·å–åˆ°å½“å‰æ‰€åœ¨ä¼šè¯çš„ IDï¼Œè°ƒç”¨ setAttribute API å†™å…¥ Span å³å¯ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(Session session, String message)</span>Â {
Â Â <span class="hljs-type">Span</span>Â <span class="hljs-variable">span</span>Â <span class="hljs-operator">=</span>Â tracer.spanBuilder(<span class="hljs-string">"Client send message"</span>).startSpan();
Â Â <span class="hljs-comment">// å‘ span ä¸­å†™å…¥ session id</span>
Â  span.setAttribute(<span class="hljs-string">"websocket.session.id"</span>, session.getId());
Â Â <span class="hljs-keyword">try</span>Â (<span class="hljs-type">Scope</span>Â <span class="hljs-variable">scope</span>Â <span class="hljs-operator">=</span>Â span.makeCurrent()) {
Â  Â  doSendMessage(message);
Â  }Â <span class="hljs-keyword">finally</span>Â {
Â  Â  span.end();
Â  }
}
</code></pre>
<h4 data-id="heading-22">3.2.4 è°ƒç”¨å»ºæ¨¡é—®é¢˜â€”â€”å­˜åœ¨æ˜æ˜¾è°ƒç”¨å…³ç³»</h4>
<p><strong>å®ç°å»ºè®®ï¼š</strong> ä»¿ç…§ Messaging ç³»ç»Ÿçš„é“¾è·¯è¿½è¸ªé€»è¾‘ï¼Œæ¶ˆæ¯çš„å‘é€è€…ä¸ºè°ƒç”¨æ–¹ï¼Œæ¶ˆæ¯çš„æ¥å—è€…ä¸ºè¢«è°ƒç”¨æ–¹ï¼Œåˆ†åˆ«åˆ›å»º Spanã€‚è°ƒç”¨æ–¹ Span ä½œä¸ºè¢«è°ƒç”¨æ–¹çš„çˆ¶çº§ã€‚æ¶‰åŠå¤šè½®æ¶ˆæ¯å‘é€ï¼Œåªè¦æ„å›¾ä¸ºæµå¼ä¼ è¾“ï¼Œè§†ä¸ºä¸€æ¬¡è°ƒç”¨è¡Œä¸ºã€‚</p>
<p>é“¾è·¯æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77e68f788b7c4c6eafcb0381b57bf7ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=Sg%2FCnw1eoFQivh9Ang3gFXDeME8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ç§æƒ…å½¢æ˜¯ç”Ÿäº§åº”ç”¨ä¸­æœ€æ™®éç¢°åˆ°çš„æƒ…å†µï¼Œè¦ä¿è¯ Client é“¾è·¯å’Œ Server é“¾è·¯çš„ä¸²è”ï¼Œéœ€è¦è°ƒç”¨æ–¹åœ¨å‘é€æ¶ˆæ¯æ—¶ä¿è¯æ¶ˆæ¯ä¸­æœ‰ä¸€ä¸ªç±»ä¼¼ headers çš„é¢„ç•™å­—æ®µç”¨äºä¼ é€’é“¾è·¯ä¸Šä¸‹æ–‡ï¼Œè¯¥å­—æ®µéœ€è¦è¢« Client å’Œ Server åŒæ—¶æ”¯æŒè§£æã€‚è®¸å¤šç”Ÿäº§æœåŠ¡éƒ½é¢„ç•™äº†è¿™ç±»å­—æ®µï¼Œä¾‹å¦‚ï¼šè¯­éŸ³åˆæˆCosyVoice WebSocket API#æŒ‡ä»¤ï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fmodel-studio%2Fcosyvoice-websocket-api%255B%23b0100c3591yqq" target="_blank" title="https://help.aliyun.com/zh/model-studio/cosyvoice-websocket-api%5B#b0100c3591yqq" ref="nofollow noopener noreferrer">help.aliyun.com/zh/model-stâ€¦</a></p>
<p>è°ƒç”¨æ–¹ä»£ç å®ç°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">publicÂ voidÂ <span class="hljs-built_in">sendMessage</span>(StringÂ message) {
Â Â <span class="hljs-comment">// 0. ï¼ˆå¯é€‰ï¼‰å¦‚æœä¸ºä¸€ä¸ª Connection åˆ›å»ºäº† spanï¼Œéœ€è¦åœ¨æ­¤å¤„æ‰§è¡Œ span.makeCurrent()</span>
Â Â <span class="hljs-comment">// 1. åˆ›å»º header å­—æ®µ</span>
Â Â HashMap&lt;String,Â String&gt; headers =Â newÂ HashMap&lt;&gt;();
Â Â <span class="hljs-comment">// 2. åˆ›å»º span å¹¶å†™å…¥å¿…è¦çš„å±æ€§</span>
Â Â <span class="hljs-selector-tag">Span</span>Â <span class="hljs-selector-tag">span</span> = tracer<span class="hljs-selector-class">.spanBuilder</span>("Client send message")<span class="hljs-selector-class">.startSpan</span>();
Â  <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.setAttribute</span>("websocket.session.id", session.getId());
Â Â tryÂ (ScopeÂ scope = span.makeCurrent()) {
Â  Â Â <span class="hljs-comment">// 3. è°ƒç”¨ OTel APIï¼Œå°†ä¸Šä¸‹æ–‡æ³¨å…¥åˆ° header ä¸­</span>
Â  Â  openTelemetry<span class="hljs-selector-class">.getPropagators</span>()<span class="hljs-selector-class">.getTextMapPropagator</span>()<span class="hljs-selector-class">.inject</span>(Context.current(), headers,
Â  Â  Â  Â  (headersMap, key, value) -&gt; headersMap<span class="hljs-selector-class">.put</span>(key, value));
Â  Â Â <span class="hljs-comment">// 4. å‘é€æ¶ˆæ¯</span>
Â  Â Â <span class="hljs-comment">// å¦‚æœæ˜¯æµå¼å‘é€æ¶ˆæ¯ï¼Œåˆ™å¯ä»¥ä»…åœ¨ç¬¬ä¸€æ¡æ¶ˆæ¯ä¸­æ·»åŠ  headerï¼Œè°ƒç”¨åŒæ–¹éœ€è¦ä¿è¯ span åˆ›å»ºçš„å¹‚ç­‰æ€§ï¼ˆå³æ•´ä¸ªæµå¼å‘é€æœŸé—´ä»…åˆ›å»ºä¸€ä¸ª spanï¼‰</span>
Â  Â Â <span class="hljs-built_in">sendMessage</span>(message, headers);
Â  }Â finallyÂ {
Â  Â  <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.end</span>();
Â  }
}
</code></pre>
<p>è¢«è°ƒç”¨æ–¹ä»£ç å®ç°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">onMessage</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â message,Â SessionÂ session</span>) {
Â Â <span class="hljs-title class_">String</span>Â sessionId = session.<span class="hljs-title function_">getId</span>();
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-comment">// 1. è§£ææ¶ˆæ¯</span>
Â  Â Â <span class="hljs-title class_">MessageWithHeaders</span>Â msgWithHeaders = objectMapper.<span class="hljs-title function_">readValue</span>(message,Â <span class="hljs-title class_">MessageWithHeaders</span>.<span class="hljs-property">class</span>);
Â  Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt; headers = msgWithHeaders.<span class="hljs-title function_">getHeaders</span>();
Â  Â Â <span class="hljs-comment">// 2. ä»æ¶ˆæ¯ä¸­æå–é“¾è·¯ä¸Šä¸‹æ–‡</span>
Â  Â Â <span class="hljs-title class_">Context</span>Â remoteContext = openTelemetry.<span class="hljs-title function_">getPropagators</span>().<span class="hljs-title function_">getTextMapPropagator</span>()
Â  Â  Â  Â  .<span class="hljs-title function_">extract</span>(<span class="hljs-title class_">Context</span>.<span class="hljs-title function_">current</span>(),
Â  Â  Â  Â  Â  Â  headers,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">TextMapGetter</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt;&gt;() {
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Iterable</span>&lt;<span class="hljs-title class_">String</span>&gt;Â <span class="hljs-title function_">keys</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,Â <span class="hljs-built_in">String</span>&gt; headersMap</span>) {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â headersMap.<span class="hljs-title function_">keySet</span>();
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-meta">@Override</span>
Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">get</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,Â <span class="hljs-built_in">String</span>&gt; headersMap,Â <span class="hljs-built_in">String</span>Â key</span>) {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â headersMap.<span class="hljs-title function_">getOrDefault</span>(key,Â <span class="hljs-literal">null</span>);
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â Â <span class="hljs-comment">// 3. ä»¥æå–å‡ºæ¥çš„ä¸Šä¸‹æ–‡ä½œä¸ºçˆ¶çº§ï¼Œåˆ›å»º Server span</span>
Â  Â Â <span class="hljs-title class_">Span</span>Â serverSpan = tracer.<span class="hljs-title function_">spanBuilder</span>(<span class="hljs-string">"Server handle message"</span>)
Â  Â  Â  Â  .<span class="hljs-title function_">setParent</span>(remoteContext).<span class="hljs-title function_">startSpan</span>();
Â  Â Â <span class="hljs-keyword">try</span>Â (<span class="hljs-title class_">Scope</span>Â scope = serverSpan.<span class="hljs-title function_">makeCurrent</span>()) {
Â  Â  Â Â <span class="hljs-comment">// 4. å¤„ç†æ¶ˆæ¯/æµå¼è¿”å›å“åº”</span>
Â  Â  Â Â <span class="hljs-title class_">String</span>Â body = msgWithHeaders.<span class="hljs-title function_">getBody</span>();
Â  Â  Â  log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"æ”¶åˆ°æ¶ˆæ¯ [{}] [headers={}]: {}"</span>, sessionId, headers, body);
Â  Â  Â Â <span class="hljs-comment">// å¤„ç†æ¶ˆæ¯ï¼ˆå¸¦ headersï¼‰</span>
Â  Â  Â Â <span class="hljs-title function_">handleMessage</span>(session, body, headers);
Â  Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e) {
Â  Â  Â  serverSpan.<span class="hljs-title function_">recordException</span>(e);
Â  Â  }Â <span class="hljs-keyword">finally</span>Â {
Â  Â  Â  serverSpan.<span class="hljs-title function_">end</span>();
Â  Â  }
Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e) {
Â  Â  log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ¶ˆæ¯æ¥æ”¶å¤±è´¥ [{}]: {}"</span>, sessionId, message, e);
Â  }
}
</code></pre>
<h4 data-id="heading-23">3.2.5 è°ƒç”¨å»ºæ¨¡é—®é¢˜â€”â€”æ— æ˜¾å¼è°ƒç”¨å…³ç³»ï¼Œä»…ä¼ è¾“æ•°æ®</h4>
<p><strong>å®ç°å»ºè®®ï¼š</strong> æ•°æ®å‘é€æ–¹åˆ›å»º Spanï¼Œä½œä¸ºæ•´ä¸ª WebSocket è¿æ¥ Spanï¼ˆå¦‚æœ‰ï¼‰çš„å­ Spanï¼ŒåŒæ–¹ Span ä¸ç»´æŒçˆ¶å­å…³ç³»ã€‚</p>
<p>é“¾è·¯æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f36d0163e58b49f19fa6afe419ffd57d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=BUKxDgBS8ScFsshQ7BwRqJjQ5%2FM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ•°æ®å‘é€æ–¹ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">publicÂ voidÂ <span class="hljs-built_in">streamingSendMessages</span>(Session session)Â {
Â Â <span class="hljs-comment">// 0. ï¼ˆå¯é€‰ï¼‰å¦‚æœä¸ºä¸€ä¸ª Connection åˆ›å»ºäº† spanï¼Œéœ€è¦åœ¨æ­¤å¤„æ‰§è¡Œ span.makeCurrent()</span>
Â Â ContextÂ contextÂ =Â connectionTraceContexts<span class="hljs-selector-class">.containsKey</span>(session.getId()) ?
Â  Â  Â  Â  Â  Â  connectionTraceContexts<span class="hljs-selector-class">.get</span>(session.getId()) : Context.<span class="hljs-built_in">current</span>();
Â Â tryÂ (ScopeÂ pScopeÂ =Â context.makeCurrent()) {
Â  Â Â <span class="hljs-comment">// 1. åˆ›å»º Span</span>
Â  Â Â <span class="hljs-selector-tag">Span</span>Â <span class="hljs-selector-tag">span</span>Â =Â tracer<span class="hljs-selector-class">.spanBuilder</span>("Client send message")<span class="hljs-selector-class">.setParent</span>(context)<span class="hljs-selector-class">.startSpan</span>();
Â  Â  <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.setAttribute</span>("websocket.session.id", session.getId());
Â  Â Â tryÂ (ScopeÂ scopeÂ =Â span.makeCurrent()) {
Â  Â  Â Â <span class="hljs-comment">// 2. å‘é€æ¶ˆæ¯</span>
Â  Â  Â Â whileÂ (messageQueue !=Â nullÂ &amp;&amp; messageQueue.containsKey(session.getId())) {
Â  Â  Â  Â  List&lt;Message&gt; messages = messageQueue<span class="hljs-selector-class">.get</span>(session.getId());
Â  Â  Â  Â  messages<span class="hljs-selector-class">.forEach</span>(message -&gt; sendMessage(session, message));
Â  Â  Â  Â  Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">200</span>L);
Â  Â  Â  }
Â  Â  }Â finallyÂ {
Â  Â  Â  <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.end</span>();
Â  Â  }
Â  }
}
</code></pre>
<h4 data-id="heading-24">3.2.6 å¼‚æ­¥é€ä¼ é—®é¢˜â€”â€”è¿›ç¨‹å†…å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†</h4>
<p>ä¸€èˆ¬åœ°ï¼Œåœ¨ WebSocket åº”ç”¨ä¸­çš„å¼‚æ­¥å­˜åœ¨ä¸¤ç§å®ç°ï¼š</p>
<ul>
<li>åŸºäºçº¿ç¨‹æ± çš„å¼‚æ­¥è°ƒåº¦ï¼Œæ¯å½“æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œéƒ½åˆ›å»ºä¸€ä¸ª Runnable æˆ– Callableï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ª Golang/Python åç¨‹</li>
<li>åŸºäºè¿›ç¨‹å†…é˜Ÿåˆ—è¿›è¡Œå¼‚æ­¥é€šä¿¡ï¼ˆå¦‚ Java çš„ Dequeã€Golang çš„ Channelã€Python çš„ Generator ç­‰ï¼‰ï¼Œæ¯å½“æ¥æ”¶åˆ°æ¶ˆæ¯éƒ½å…¥é˜Ÿï¼Œç”±ç»Ÿä¸€çš„ Worker è¿›è¡Œå¤„ç†</li>
</ul>
<p>å¯¹äºç¬¬ä¸€ç§æƒ…å½¢ï¼ŒLoongSuite æ¢é’ˆå·²ç»æ”¯æŒä¸Šä¸‹æ–‡çš„è‡ªåŠ¨é€ä¼ ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">publicÂ voidÂ <span class="hljs-built_in">onMessage</span>(String message)Â {
Â Â <span class="hljs-selector-tag">Span</span>Â messageSpanÂ =Â tracer<span class="hljs-selector-class">.spanBuilder</span>("Server handle message")<span class="hljs-selector-class">.startSpan</span>();
Â Â <span class="hljs-comment">// æŠŠå½“å‰ span æ¿€æ´»å¹¶æ”¾åˆ° ThreadLocal ä¸­</span>
Â Â tryÂ (ScopeÂ scopeÂ =Â messageSpan.makeCurrent()) {
Â  Â Â <span class="hljs-comment">// å¼‚æ­¥è°ƒç”¨æ¶ˆæ¯å¤„ç†æµç¨‹</span>
Â  Â Â <span class="hljs-comment">// æ¢é’ˆä¼šåœ¨ Runnable ä»»åŠ¡è¢«åˆ›å»ºæ—¶ï¼Œå°† span æ‰€åœ¨ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’åˆ° doHandleMessage æ–¹æ³•å†…éƒ¨</span>
Â  Â Â <span class="hljs-comment">// doHandleMessage æ–¹æ³•å®é™…æ‰§è¡Œæ—¶ï¼Œä¸Šä¸‹æ–‡ä¼šè¢«è‡ªåŠ¨å¤åŸ</span>
Â  Â  workerExecutor<span class="hljs-selector-class">.execute</span>(() -&gt; <span class="hljs-built_in">doHandleMessage</span>(message));
Â  }
}
</code></pre>
<p>å¯¹äºç¬¬äºŒç§æƒ…å½¢ï¼Œéœ€è¦ä½¿ç”¨è€…ä¸»åŠ¨è¿›è¡Œä¸Šä¸‹æ–‡é€ä¼ å’Œè¿˜åŸï¼š</p>
<pre><code class="hljs language-scss" lang="scss">publicÂ voidÂ <span class="hljs-built_in">onMessage</span>(String message)Â {
Â Â <span class="hljs-selector-tag">Span</span>Â messageSpanÂ =Â tracer<span class="hljs-selector-class">.spanBuilder</span>("Server handle message")<span class="hljs-selector-class">.startSpan</span>();
Â Â <span class="hljs-comment">// æŠŠå½“å‰ span æ¿€æ´»å¹¶æ”¾åˆ° ThreadLocal ä¸­</span>
Â Â tryÂ (ScopeÂ scopeÂ =Â messageSpan.makeCurrent()) {
Â  Â Â <span class="hljs-comment">// æ‰‹åŠ¨å°† TraceContext ä¸ Message å…³è”ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ Mapï¼‰</span>
Â  Â  message<span class="hljs-selector-class">.setTracingContext</span>(Context.current());
Â  Â Â <span class="hljs-comment">// æ¶ˆæ¯å…¥é˜Ÿ</span>
Â  Â  messageQueue<span class="hljs-selector-class">.offer</span>(message);
Â  }
}
publicÂ voidÂ <span class="hljs-built_in">pollAndHandleMessage</span>()Â {
Â Â whileÂ (true) {
Â  Â Â ifÂ (!messageQueue.isEmpty) {
Â  Â  Â Â MessageÂ messageÂ =Â messageQueue<span class="hljs-selector-class">.poll</span>();
Â  Â  Â Â <span class="hljs-comment">// æ¶ˆæ¯å‡ºé˜Ÿåï¼Œè·å– TraceContext ä¸ Span</span>
Â  Â  Â Â ContextÂ tracingContextÂ =Â message<span class="hljs-selector-class">.getTracingContext</span>();
Â  Â  Â Â <span class="hljs-selector-tag">Span</span>Â <span class="hljs-selector-tag">span</span>Â =Â <span class="hljs-selector-tag">Span</span><span class="hljs-selector-class">.fromContext</span>(tracingContext);
Â  Â  Â Â <span class="hljs-comment">// å°† TraceContext é‡æ–°æ¿€æ´»å¹¶æ”¾åˆ° ThreadLocal ä¸­</span>
Â  Â  Â Â tryÂ (ScopeÂ scopeÂ =Â tracingContext.makeCurrent()) {
Â  Â  Â  Â  <span class="hljs-built_in">handleMessage</span>(message);
Â  Â  Â  }Â finallyÂ {
Â  Â  Â  Â Â <span class="hljs-comment">// æ¶ˆæ¯å¤„ç†ç»“æŸï¼Œå…³é—­ span</span>
Â  Â  Â  Â  <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.end</span>();
Â  Â  Â  }
Â  Â  }
Â  Â  Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>L);
Â  }
}
</code></pre>
<h3 data-id="heading-25">3.3 WebSocket ä¸­æµå¼ä¼ è¾“çš„å…³é”®ä¸šåŠ¡æŒ‡æ ‡</h3>
<p>åœ¨ 3.2 èŠ‚ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æµå¼ä¼ è¾“çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¼šæŠŠä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚è®°å½•ä¸ºä¸€æ¡ Spanï¼Œä»¥é˜²æ­¢è¿‡å¤š Span å¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚ä½†è¿™ä¹Ÿä¼šæŠ¹å»æµå¼ä¼ è¾“ä¸­çš„ä¸€äº›å…³é”®æ€§èƒ½ä¿¡æ¯â€”â€”ä¸€æ¬¡æ¶ˆæ¯å¤„ç†ä¸­ï¼ŒæŸäº›ä¸ªåˆ«çš„æ•°æ®åŒ…å¤„ç†æ—¶é•¿è¿‡é•¿å¼•å‘æ•´ä¸ªå“åº”è¿‡ç¨‹åæ…¢ã€‚å®é™…ç”Ÿäº§ä¸­ï¼Œè¿™äº›æŒ‡æ ‡ä¹Ÿèƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå¸®æˆ‘ä»¬è¡¡é‡åº”ç”¨çš„å¥åº·åº¦ä¸è¯„ä¼°æŸäº›é“¾è·¯çš„é—®é¢˜æ‰€åœ¨ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸ç”¨çš„ä¸šåŠ¡æŒ‡æ ‡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b4f17d11e0f4280beca8b9dfecb5224~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=pzkdagqWySUY5WnMeVnQaz1D6rw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯è®¡ç®—è¿™äº›æŒ‡æ ‡çš„ä¸€ä¸ªç®€å•çš„å·¥å…·ç±»å®ç°ï¼Œå…³äºè¯¦ç»†çš„ä½¿ç”¨æ–¹å¼ï¼Œæ¬¢è¿æŸ¥çœ‹ç¤ºä¾‹ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCirilla-zmh%2Fasr-demo%2Fblob%2Fmain%2Fasr-service%2Fsrc%2Fmain%2Fjava%2Fcom%2Fexample%2Fasr%2Fws%2FAsrWebSocketHandler.java" target="_blank" title="https://github.com/Cirilla-zmh/asr-demo/blob/main/asr-service/src/main/java/com/example/asr/ws/AsrWebSocketHandler.java" ref="nofollow noopener noreferrer">github.com/Cirilla-zmhâ€¦</a></p>
<p>å·¥å…·ç±»å®šä¹‰</p>
<pre><code class="hljs language-ini" lang="ini">publicÂ classÂ WebSocketPerformanceMeasureÂ {
Â Â privateÂ staticÂ final Logger <span class="hljs-attr">log</span> = LoggerFactory.getLogger(WebSocketPerformanceMeasure.class)<span class="hljs-comment">;</span>
Â Â privateÂ staticÂ finalÂ longÂ <span class="hljs-attr">UNINITIALIZED</span> =Â -<span class="hljs-number">1</span>L<span class="hljs-comment">;</span>
Â Â privateÂ Long startTime<span class="hljs-comment">;</span>
Â Â privateÂ Long firstChunkTime<span class="hljs-comment">;</span>
Â Â privateÂ AtomicInteger chunkCounts<span class="hljs-comment">;</span>
Â Â privateÂ AtomicLong totalInterval<span class="hljs-comment">;</span>
Â Â privateÂ Long lastChunkTime<span class="hljs-comment">;</span>
Â Â publicÂ staticÂ WebSocketPerformanceMeasureÂ create()Â {
Â  Â  WebSocketPerformanceMeasure <span class="hljs-attr">measure</span> =Â newÂ WebSocketPerformanceMeasure()<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">measure.startTime</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">measure.firstChunkTime</span> = UNINITIALIZED<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">measure.chunkCounts</span> =Â newÂ AtomicInteger(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">measure.totalInterval</span> =Â newÂ AtomicLong(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">measure.lastChunkTime</span> = UNINITIALIZED<span class="hljs-comment">;</span>
Â  Â Â returnÂ measure<span class="hljs-comment">;</span>
Â  }
Â Â /**
Â  Â * å¼€å§‹æµ‹é‡ï¼ˆå¦‚æœå°šæœªå¼€å§‹ï¼‰
Â  Â */
Â Â publicÂ voidÂ start()Â {
Â  Â Â ifÂ (<span class="hljs-attr">startTime</span> ==Â null) {
Â  Â  Â  <span class="hljs-attr">startTime</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">firstChunkTime</span> = UNINITIALIZED<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">chunkCounts</span> =Â newÂ AtomicInteger(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">totalInterval</span> =Â newÂ AtomicLong(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">lastChunkTime</span> = UNINITIALIZED<span class="hljs-comment">;</span>
Â  Â  }
Â  }
Â Â /**
Â  Â * è®°å½•ä¸€ä¸ª chunk çš„åˆ°è¾¾
Â  Â * è‡ªåŠ¨è®¡ç®— time_to_first_chunk å’Œæ›´æ–°é—´éš”ç»Ÿè®¡
Â  Â *Â 
Â  Â * @return å¦‚æœæ˜¯ç¬¬ä¸€ä¸ª chunkï¼Œè¿”å› time_to_first_chunkï¼ˆæ¯«ç§’ï¼‰ï¼Œå¦åˆ™è¿”å› null
Â  Â */
Â Â publicÂ LongÂ recordChunk()Â {
Â  Â Â ifÂ (<span class="hljs-attr">startTime</span> ==Â null) {
Â  Â  Â  log.warn("Performance measure not started, calling start() automatically")<span class="hljs-comment">;</span>
Â  Â  Â  start()<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â longÂ <span class="hljs-attr">currentTime</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
Â  Â  chunkCounts.incrementAndGet()<span class="hljs-comment">;</span>
Â  Â Â // è®°å½•ç¬¬ä¸€ä¸ª chunk çš„æ—¶é—´
Â  Â  Long <span class="hljs-attr">timeToFirstChunk</span> =Â null<span class="hljs-comment">;</span>
Â  Â Â ifÂ (<span class="hljs-attr">firstChunkTime</span> == UNINITIALIZED) {
Â  Â  Â  <span class="hljs-attr">timeToFirstChunk</span> = currentTime - startTime<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">firstChunkTime</span> = currentTime<span class="hljs-comment">;</span>
Â  Â  Â  log.debug("First chunk recorded, time_to_first_chunk: {}ms", timeToFirstChunk)<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â // è®¡ç®— chunk é—´éš”ï¼ˆä»ç¬¬äºŒä¸ª chunk å¼€å§‹ï¼‰
Â  Â Â ifÂ (lastChunkTime != UNINITIALIZED) {
Â  Â  Â Â longÂ <span class="hljs-attr">interval</span> = currentTime - lastChunkTime<span class="hljs-comment">;</span>
Â  Â  Â  totalInterval.addAndGet(interval)<span class="hljs-comment">;</span>
Â  Â  }
Â  Â  <span class="hljs-attr">lastChunkTime</span> = currentTime<span class="hljs-comment">;</span>
Â  Â Â returnÂ timeToFirstChunk<span class="hljs-comment">;</span>
Â  }
Â Â /**
Â  Â * è·å– time_to_first_chunkï¼ˆæ¯«ç§’ï¼‰
Â  Â * å¦‚æœç¬¬ä¸€ä¸ª chunk å°šæœªåˆ°è¾¾ï¼Œè¿”å› null
Â  Â */
Â Â publicÂ LongÂ getTimeToFirstChunk()Â {
Â  Â Â ifÂ (<span class="hljs-attr">firstChunkTime</span> == UNINITIALIZED || startTime ==Â null) {
Â  Â  Â Â returnÂ null<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â returnÂ firstChunkTime - startTime<span class="hljs-comment">;</span>
Â  }
Â Â /**
Â  Â * è·å– time_to_last_chunkï¼ˆæ¯«ç§’ï¼‰
Â  Â * éœ€è¦ä¿è¯åœ¨ chunk å®Œå…¨åˆ°è¾¾åè°ƒç”¨
Â  Â * å¦‚æœç¬¬ä¸€ä¸ª chunk å°šæœªåˆ°è¾¾ï¼Œè¿”å› null
Â  Â */
Â Â publicÂ LongÂ getTimeToLastChunk()Â {
Â  Â Â ifÂ (<span class="hljs-attr">lastChunkTime</span> == UNINITIALIZED || startTime ==Â null) {
Â  Â  Â Â returnÂ null<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â returnÂ lastChunkTime - startTime<span class="hljs-comment">;</span>
Â  }
Â Â /**
Â  Â * è·å–å¹³å‡ chunk é—´éš”ï¼ˆæ¯«ç§’ï¼‰
Â  Â * å¦‚æœ chunk æ•°é‡å°‘äº 2ï¼Œè¿”å› null
Â  Â */
Â Â publicÂ LongÂ getAverageInterval()Â {
Â  Â Â intÂ <span class="hljs-attr">count</span> = chunkCounts.get()<span class="hljs-comment">;</span>
Â  Â Â ifÂ (count &lt;Â 2Â || <span class="hljs-attr">totalInterval</span> ==Â null) {
Â  Â  Â Â returnÂ null<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â returnÂ totalInterval.get() / (count -Â 1)<span class="hljs-comment">;</span>
Â  }
Â Â /**
Â  Â * è·å– chunk æ€»æ•°
Â  Â */
Â Â publicÂ intÂ getChunkCount()Â {
Â  Â Â returnÂ chunkCounts !=Â nullÂ ? chunkCounts.get() :Â 0<span class="hljs-comment">;</span>
Â  }
}
</code></pre>
<h2 data-id="heading-26">å…¸å‹åœºæ™¯å®è·µï¼šAI è¯­éŸ³å¯¹è¯ç³»ç»Ÿ</h2>
<p>æœ¬èŠ‚æˆ‘ä»¬å°†ç»“åˆä¸€ä¸ªç”Ÿäº§ä¸­å¸¸è§çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œæ¥ç®€è¦ä»‹ç»æœ¬æ–‡æ–¹æ¡ˆåœ¨è¯¥åœºæ™¯ä¸‹çš„å…·ä½“å®è·µã€‚ç›¸å…³ demo ä»£ç å·²å¼€æºï¼Œæ¬¢è¿ç§»æ­¥Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCirilla-zmh%2Fasr-demo%25C2%25A0%25E5%25AE%259E%25E8%25B7%25B5%25E3%2580%2582" target="_blank" title="https://github.com/Cirilla-zmh/asr-demo%C2%A0%E5%AE%9E%E8%B7%B5%E3%80%82" ref="nofollow noopener noreferrer">github.com/Cirilla-zmhâ€¦</a></p>
<h3 data-id="heading-27">4.1 ç³»ç»Ÿæ¶æ„è§£æ</h3>
<p>ä»¥ä¸‹æ˜¯ç³»ç»Ÿæ•´ä½“æ¶æ„çš„ç®€å•ç¤ºæ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">è®¾å¤‡ç«¯ â†’ WebSocket â†’ ASR â†’ <span class="hljs-built_in">LLM</span>(æ„å›¾è¯†åˆ«) â†“
â”œâ”€ é—²èŠ â†’ <span class="hljs-built_in">LLM</span>(ç”Ÿæˆ) â†’ TTS â†’ è®¾å¤‡ç«¯
â””â”€ ä¸‹å• â†’ <span class="hljs-built_in">MCP</span>(ä¸‹å•) â†’ <span class="hljs-built_in">LLM</span>(ç”Ÿæˆ) â†’ TTS â†’ è®¾å¤‡ç«¯
</code></pre>
<p>è°ƒç”¨æ—¶åºå›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55cc7b8d26324cb9982d1ff6557e7739~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=4dDIWtu837Ut3S4ADlWodJ9LtKM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-28">4.2 æ¥å…¥ LoongSuite æ¢é’ˆ</h3>
<p>åœ¨æœ¬ç¤ºä¾‹é¡¹ç›®ä¸­ï¼Œé¢„ç•™äº†æ¢é’ˆæŒ‚è½½çš„ç¯å¢ƒå˜é‡ï¼Œé€šè¿‡æŒ‚è½½ LoongSuite æ¢é’ˆï¼Œæˆ‘ä»¬å¯ä»¥å°† ASR demo æœåŠ¡çš„å¯è§‚æµ‹æ•°æ®æ¥å…¥åˆ° ARMS æ§åˆ¶å°ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤ï¼š</p>
<ol>
<li>ä¸‹è½½ LoongSuite å•†ä¸šåŒ–æ¢é’ˆå¹¶è§£å‹</li>
</ol>
<blockquote>
<p>ä¸ºä¿è¯ LLM é“¾è·¯çš„å®Œæ•´æ€§ï¼Œå»ºè®®ä¸‹è½½ 4.6.0 åŠæ›´é«˜ç‰ˆæœ¬æ¢é’ˆã€‚</p>
</blockquote>
<pre><code class="hljs language-python" lang="python">wgetÂ <span class="hljs-string">"http://arms-apm-cn-hangzhou.oss-cn-hangzhou.aliyuncs.com/4.6.0/AliyunJavaAgent.zip"</span>Â -O AliyunJavaAgent.<span class="hljs-built_in">zip</span>
unzip AliyunJavaAgent.<span class="hljs-built_in">zip</span>
</code></pre>
<p>2.  å‚ç…§ READMEï¼Œåœ¨å¯åŠ¨åº”ç”¨æ—¶æ·»åŠ æ¢é’ˆæŒ‚è½½ç›¸å…³å‚æ•°ï¼Œç›¸å…³å‚æ•°å¯ä»¥å‚è€ƒæ‰‹åŠ¨å®‰è£…æ¢é’ˆ <strong>[1****1]</strong> æ–‡æ¡£è·å–ã€‚</p>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span>Â JAVA_AGENT_OPTIONS=<span class="hljs-string">"-javaagent:/path/to/4.6.0/AliyunJavaAgent/aliyun-java-agent.jar -Darms.licenseKey=<span class="hljs-variable">${your_license_key}</span>Â -Darms.appName=websocket-demo -Daliyun.javaagent.regionId=cn-hangzhou -Darms.workspace=<span class="hljs-variable">${your_cms_workspace}</span>"</span>
./start.sh
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥æ¥å…¥ LoongSuite å¼€æºç‰ˆæœ¬æ¢é’ˆæˆ–è€… OpenTelemetry æ¢é’ˆï¼Œå¹¶å¯è§‚æµ‹æ•°æ®ä¸ŠæŠ¥åˆ°å¼€æºçš„å¯è§‚æµ‹å¹³å°ï¼Œå—é™äºç¯‡å¹…ï¼Œåœ¨æ­¤ä¸å†å±•å¼€ï¼Œæ¬¢è¿ç§»æ­¥Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Floongsuite-java-agent%25C2%25A0%25E8%258E%25B7%25E5%258F%2596%25E6%259B%25B4%25E5%25A4%259A%25E4%25BF%25A1%25E6%2581%25AF%25E3%2580%2582" target="_blank" title="https://github.com/alibaba/loongsuite-java-agent%C2%A0%E8%8E%B7%E5%8F%96%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF%E3%80%82" ref="nofollow noopener noreferrer">github.com/alibaba/looâ€¦</a></p>
<h3 data-id="heading-29">4.3 ç³»ç»Ÿé¡µé¢ä¸å¯è§‚æµ‹æ•ˆæœç¤ºæ„</h3>
<p>ä»¥ä¸‹æ˜¯éƒ¨ç½²åçš„åº”ç”¨ç³»ç»Ÿé¡µé¢ï¼Œç±»ä¼¼ç°åœ¨çš„æ™ºèƒ½æœºå™¨äºº IM ç³»ç»Ÿï¼Œç”¨äºæ›¿ä»£è®¾å¤‡ç«¯çš„å·¦å³ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2457aea5acd3462ab61a2d4077a53634~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=eWkO7fbQjUwnAOzEyuitlK9thLQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨å‘èµ·å¯¹è¯åï¼Œç»Ÿè®¡ä¸Šæ¥çš„é“¾è·¯å¦‚å›¾æ‰€ç¤ºã€‚å¯ä»¥åœ¨ä¸€æ¡é“¾è·¯ä¸­æ¸…æ™°çœ‹åˆ°æ¯ä¸ªç¯èŠ‚çš„æŒç»­æ—¶é—´ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d467b4c5bd743509e58891c4fd82f21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=qNy8DKKAQVSBUKu%2BqlkWgPlqfKA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ WebSocket å¯¹åº” span ä¸­ï¼Œèƒ½å¤Ÿçœ‹åˆ°ç»Ÿè®¡åˆ°çš„é¦–åŒ…å»¶è¿Ÿä¸å¹³å‡è¾“å‡ºé—´éš”ç­‰æŒ‡æ ‡ï¼Œå¸®åŠ©åˆ†ææ•´ä½“ä¸šåŠ¡æ€§èƒ½ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58bdf4fa4b1144abb890919506bf80c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766394855&amp;x-signature=y6FtHNwt%2ByaP4qV6XmhmttVbafw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-30">ç»“è¯­ï¼šæœªæ¥å±•æœ›</h2>
<p>WebSocket é¢†åŸŸçš„å…¨é“¾è·¯å¯è§‚æµ‹æ€§ä¸€ç›´ä»¥æ¥éƒ½æ˜¯è®©è®¸å¤šä¼ä¸šå¼€å‘å’Œè¿ç»´äººå‘˜å¤´ç—›çš„é—®é¢˜ã€‚å¯è§‚æµ‹æ€§çš„è§£å†³æ–¹æ¡ˆå¹¶ä¸èƒ½ä¸€è¹´è€Œå°±ï¼Œéœ€è¦ä¸ç”¨æˆ·è¿›è¡ŒæŒç»­æ·±åº¦å…±å»ºä¸é…åˆã€‚å¾ˆå…´å¥‹èƒ½çœ‹åˆ°å…¬ç‰›åœ¨ä¸å¯è§‚æµ‹å›¢é˜Ÿå…±åŒå®Œæˆäº†è¯¥æ–¹æ¡ˆåœ¨ç”Ÿäº§ä¸Šçš„å®é™…è½åœ° <strong>[</strong> <strong>12]</strong> ï¼Œä¹Ÿä¸ºæˆ‘ä»¬æ–¹æ¡ˆçš„å®Œå–„æä¾›äº†éå¸¸å®è´µçš„ç»éªŒã€‚æœªæ¥æˆ‘ä»¬å°†ä¸æ›´å¤šçš„ç”¨æˆ·ä¸å¼€æºå¼€å‘è€…å…±å»ºï¼ŒæŒç»­è¡¥å……å’Œå»ºè®¾æ›´å®Œå–„ã€æ›´æ˜“ç”¨çš„ WebSocket å¯è§‚æµ‹æ–¹æ¡ˆã€‚</p>
<p>æ¬¢è¿å¤§å®¶å…³æ³¨ LoongSuite ç¤¾åŒºï¼Œä»¥è·å–ç›¸å…³æ–¹æ¡ˆçš„æœ€æ–°è¿›å±•ï¼š</p>
<p>â€œLoongCollector(åŸiLogtail)ç¤¾åŒºâ€é’‰é’‰ç¾¤å·ï¼š 35576244</p>
<p>â€œLoongSuite Go Agentå¼€æºäº¤æµç¾¤â€é’‰é’‰ç¾¤å·ï¼š 102565007776</p>
<p>â€œLoongSuite Python SIGâ€é’‰é’‰ç¾¤å·ï¼š 101925034286</p>
<p>â€œLoongSuite Python SIGâ€é’‰é’‰ç¾¤å·ï¼š 101925034286</p>
<p><strong>å‚è€ƒæ–‡ç« ï¼š</strong></p>
<p>[1] RFC 6455</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdatatracker.ietf.org%2Fdoc%2Fhtml%2Frfc6455" target="_blank" title="https://datatracker.ietf.org/doc/html/rfc6455" ref="nofollow noopener noreferrer">datatracker.ietf.org/doc/html/rfâ€¦</a></p>
<p>[2] The Road to WebSockets</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebsocket.org%2Fguides%2Froad-to-websockets%2F" target="_blank" title="https://websocket.org/guides/road-to-websockets/" ref="nofollow noopener noreferrer">websocket.org/guides/roadâ€¦</a></p>
<p>[3] WebSocket Protocol</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebsocket.org%2Fguides%2Fwebsocket-protocol%2F" target="_blank" title="https://websocket.org/guides/websocket-protocol/" ref="nofollow noopener noreferrer">websocket.org/guides/websâ€¦</a></p>
<p>[4] OpenAI Realtime API</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Frealtime-websocket" target="_blank" title="https://platform.openai.com/docs/guides/realtime-websocket" ref="nofollow noopener noreferrer">platform.openai.com/docs/guidesâ€¦</a></p>
<p>[5]Â å®æ—¶å¤šæ¨¡æ€äº¤äº’åè®®ï¼ˆWebSocketï¼‰</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fmodel-studio%2Fmultimodal-interaction-protocol" target="_blank" title="https://help.aliyun.com/zh/model-studio/multimodal-interaction-protocol" ref="nofollow noopener noreferrer">help.aliyun.com/zh/model-stâ€¦</a></p>
<p>[6] Live API - WebSockets API reference</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fai.google.dev%2Fapi%2Flive" target="_blank" title="https://ai.google.dev/api/live" ref="nofollow noopener noreferrer">ai.google.dev/api/live</a></p>
<p>[7] Trace Context</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Ftrace-context%2F%23abstract" target="_blank" title="https://www.w3.org/TR/trace-context/#abstract" ref="nofollow noopener noreferrer">www.w3.org/TR/trace-coâ€¦</a></p>
<p>[8]Â Distributed Tracing åŸºæœ¬ä»‹ç»</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fobservability.cn%2Fproject%2Fopentelemetry%2Frp8k7gzvtys07zsb%2F" target="_blank" title="https://observability.cn/project/opentelemetry/rp8k7gzvtys07zsb/" ref="nofollow noopener noreferrer">observability.cn/project/opeâ€¦</a></p>
<p>[9]Â é€šè¿‡OpenTelemetry Java SDKä¸ºè°ƒç”¨é“¾å¢åŠ è‡ªå®šä¹‰åŸ‹ç‚¹</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Farms%2Fapplication-monitoring%2Fuse-cases%2Fuse-opentelemetry-sdk-for-java-to-manually-instrument-applications%3Fspm%3Da2c4g.11186623.help-menu-search-34364.d_5" target="_blank" title="https://help.aliyun.com/zh/arms/application-monitoring/use-cases/use-opentelemetry-sdk-for-java-to-manually-instrument-applications?spm=a2c4g.11186623.help-menu-search-34364.d_5" ref="nofollow noopener noreferrer">help.aliyun.com/zh/arms/appâ€¦</a></p>
<p>[10] OpenTelemetry Specification Overview</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopentelemetry.io%2Fdocs%2Fspecs%2Fotel%2Foverview%2F" target="_blank" title="https://opentelemetry.io/docs/specs/otel/overview/" ref="nofollow noopener noreferrer">opentelemetry.io/docs/specs/â€¦</a></p>
<p>[11] æ‰‹åŠ¨å®‰è£…æ¢é’ˆ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Farms%2Fapplication-monitoring%2Fuser-guide%2Fmanually-install-arms-agent-for-java-applications" target="_blank" title="https://help.aliyun.com/zh/arms/application-monitoring/user-guide/manually-install-arms-agent-for-java-applications" ref="nofollow noopener noreferrer">help.aliyun.com/zh/arms/appâ€¦</a></p>
<p>[12] ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUzNzYxNjAzMg%3D%3D%26mid%3D2247577965%26idx%3D2%26sn%3D842338decd2e1d6886f9f7c77b0e68fc%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUzNzYxNjAzMg==&amp;mid=2247577965&amp;idx=2&amp;sn=842338decd2e1d6886f9f7c77b0e68fc&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">è®©æ¯æ¬¡è¯­éŸ³å”¤é†’éƒ½å¯é ï¼Œå…¬ç‰›æ²å…‰é‡æ„å¯è§‚æµ‹ä½“ç³»</a>ã€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Repository æ–¹æ³•è®¾è®¡ï¼šsuspend ä¸ Flow çš„å†³é€‰æ‹©æŒ‡å—ï¼ˆä»¥æœ‹å‹åœˆä¸ºä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7583567658253762586</link>    <guid>https://juejin.cn/post/7583567658253762586</guid>    <pubDate>2025-12-14T23:51:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583567658253762586" data-draft-id="6979915155467403271" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Repository æ–¹æ³•è®¾è®¡ï¼šsuspend ä¸ Flow çš„å†³é€‰æ‹©æŒ‡å—ï¼ˆä»¥æœ‹å‹åœˆä¸ºä¾‹ï¼‰"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-14T23:51:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2313028195058471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Repository æ–¹æ³•è®¾è®¡ï¼šsuspend ä¸ Flow çš„å†³é€‰æ‹©æŒ‡å—ï¼ˆä»¥æœ‹å‹åœˆä¸ºä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2313028195058471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T23:51:58.000Z" title="Sun Dec 14 2025 23:51:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Repoæ¥å£å®šä¹‰ä¸­ï¼Œå¸¸è§ä¸¤ç±»å‡½æ•°ï¼š</p>
<ul>
<li><strong>suspend functions</strong>ï¼šè¿”å›å•ä¸€ç»“æœ</li>
<li><strong>æ™®é€šå‡½æ•°è¿”å› Flow</strong>ï¼šè¿”å›ä¸€ä¸ªç»“æœæµ</li>
</ul>
<p>è¿™ä¸¤ç±»å‡½æ•°åœ¨ Room DAO ç­‰åº“ä¸­éƒ½æœ‰ä½“ç°ã€‚ä¾‹å¦‚ <code>observeUsers()</code> è¿”å› <code>Flow</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œæ¯æ¬¡è¡¨å˜åŒ–éƒ½ä¼šå‘å°„æ–°çš„ç”¨æˆ·åˆ—è¡¨ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€é€šç”¨åŸåˆ™</h2>
<ul>
<li><strong>ä½¿ç”¨ <code>suspend</code></strong>ï¼šå½“å‡½æ•°åªäº§ç”Ÿä¸€ä¸ªç»“æœæ—¶ï¼Œä¾‹å¦‚æ•°æ®åº“æŸ¥è¯¢æˆ–è°ƒç”¨å¤–éƒ¨æœåŠ¡</li>
<li><strong>ä½¿ç”¨ <code>Flow</code></strong>ï¼šå½“å‡½æ•°å¯èƒ½äº§ç”ŸæœªçŸ¥æ•°é‡çš„ç»“æœæ—¶ï¼Œä¾‹å¦‚ WebSocket è¿æ¥æˆ–æ•°æ®åº“è§‚å¯Ÿ</li>
</ul>
<blockquote>
<p>ä¸æ¨èåœ¨åªæœŸæœ›ä¸€ä¸ªç»“æœçš„åœºæ™¯ä½¿ç”¨ <code>Flow</code>ï¼ŒåŸå› åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>è¯­ä¹‰è¯¯å¯¼</strong>ï¼š<code>Flow</code> æš—ç¤ºå¤šä¸ªç»“æœ</li>
<li><strong>å¤æ‚åº¦æ›´é«˜</strong>ï¼š<code>suspend</code> æ›´ç®€å•ã€å¯è¯»æ€§æ›´å¥½ã€æ˜“äºè°ƒè¯•</li>
</ol>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€æœ‹å‹åœˆå‘é€åœºæ™¯ â€”â€” ä½¿ç”¨ <code>suspend</code></h2>
<p>åœ¨å‘é€æœ‹å‹åœˆçš„ä¸šåŠ¡ä¸­ï¼Œå¾ˆå¤šæ“ä½œéƒ½æ˜¯ä¸€æ¬¡æ€§è§¦å‘å¹¶è¿”å›ç»“æœï¼Œå› æ­¤é€‚åˆç”¨ <code>suspend</code>ï¼š</p>
<ul>
<li>å‘å¸ƒæœ‹å‹åœˆï¼šç”¨æˆ·ç‚¹å‡»"å‘é€"åï¼Œç­‰å¾…ç»“æœè¿”å›</li>
<li>åˆ é™¤æœ‹å‹åœˆï¼šä¸€æ¬¡æ€§æ“ä½œï¼Œæ‰§è¡Œåå³ç»“æŸ</li>
<li>ç‚¹èµ/å–æ¶ˆç‚¹èµï¼šè§¦å‘åç«‹å³è¿”å›ç»“æœ</li>
<li>å‘è¡¨è¯„è®ºï¼šæäº¤åè¿”å›æˆåŠŸæˆ–å¤±è´¥</li>
</ul>
<h3 data-id="heading-2">ç¤ºä¾‹æ¥å£</h3>
<h2 data-id="heading-3"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ea10b1cc9af49b6970089d80d043f2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766361118&amp;x-signature=iJEWuu0y01K82jGHOOIw6cFkjto%3D" alt="image.png" loading="lazy"/></h2>
<h2 data-id="heading-4">ä¸‰ã€æœ‹å‹åœˆåŠ¨æ€åœºæ™¯ â€”â€” ä½¿ç”¨ <code>Flow</code></h2>
<p>æœ‹å‹åœˆçš„å¦ä¸€ç±»éœ€æ±‚æ˜¯å®æ—¶åŠ¨æ€æ›´æ–°ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æœ‹å‹åœˆåˆ—è¡¨ï¼šæ–°å†…å®¹å‘å¸ƒåï¼Œåˆ—è¡¨éœ€è¦è‡ªåŠ¨åˆ·æ–°</li>
<li>ç‰¹å®šæœ‹å‹åœˆè¯¦æƒ…ï¼šç‚¹èµæ•°ã€è¯„è®ºæ•°éšæ—¶å˜åŒ–</li>
<li>æ–°æœ‹å‹åœˆé€šçŸ¥ï¼šå¥½å‹å‘å¸ƒæ–°åŠ¨æ€æ—¶æ¨é€</li>
<li>äº’åŠ¨æ›´æ–°ï¼šç‚¹èµã€è¯„è®ºçš„å®æ—¶å˜åŒ–</li>
</ul>
<h3 data-id="heading-5">ç¤ºä¾‹æ¥å£</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cc7df2d7e354e65bfa14cc4f9252ef4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766361118&amp;x-signature=O3KkdXZhZAF7iQSw2F7xcsvzPgI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">å››ã€ ViewModelä¸çŠ¶æ€ç®¡ç†</h2>
<p>ViewModel çš„å¯è§‚å¯ŸçŠ¶æ€é€šå¸¸ç”¨ <code>StateFlow</code> è¡¨ç¤ºã€‚  å› æ­¤ï¼ŒAPI æš´éœ² <code>Flow</code> ä¼šæ›´å®¹æ˜“æ¶ˆè´¹ï¼Œå¯ä»¥ç›´æ¥ç”¨ <code>stateIn</code> è½¬æ¢ä¸º <code>StateFlow</code>ã€‚</p>
<ul>
<li>å°å‹åº”ç”¨ï¼šç”¨ Flow åˆ°å¤„éƒ½è¡Œï¼Œå·®åˆ«ä¸å¤§</li>
<li>å¤æ‚é¢†åŸŸæ¨¡å‹ï¼šæ»¥ç”¨ Flow ä¼šæˆä¸ºè´Ÿæ‹…ï¼Œ<code>suspend</code> æ›´ç®€æ´</li>
<li>æœ€ä½³å®è·µï¼šå¯ä»¥å®šä¹‰è¾…åŠ©å‡½æ•°ï¼ŒæŠŠ <code>suspend</code> è½¬æ¢ä¸º <code>StateFlow</code>ï¼Œé¿å…å¼ºè¡Œç”¨ Flow everywhere (ä¸è¦ä¸ºäº†è¿åˆ ViewModel çš„éœ€è¦è€Œè®©æ•°æ®å±‚æ‰€æœ‰ API éƒ½è¿”å› Flowï¼Œè€Œæ˜¯ä¿æŒæ•°æ®å±‚ API çš„ç®€æ´æ€§ï¼ˆä½¿ç”¨æŒ‚èµ·å‡½æ•°ï¼‰ï¼Œç„¶ååœ¨ ViewModel å±‚é€šè¿‡è¾…åŠ©å‡½æ•°å°†ä¸€æ¬¡æ€§æ“ä½œçš„ç»“æœè½¬æ¢ä¸º StateFlow)ã€‚</li>
</ul>
<h2 data-id="heading-7">äº”ã€å†³ç­–æµç¨‹å›¾</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5316144709b04c64a2a42bee418689e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766361118&amp;x-signature=Wq%2FsFSnFi6xh6jY5GKYi1plo7LQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">æˆ‘æ€»ç»“äº†ä¸€ä¸ªå›¾,å¦‚ä¸‹:</h3>
<h2 data-id="heading-9"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/559df06a3f1843cc9afcc4e23884d4e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766361118&amp;x-signature=M494oJTiFAG00gZseBS4LBWBoI4%3D" alt="Copilot_20251212_175153.png" loading="lazy"/></h2>
<h2 data-id="heading-10">å…­ã€æ€»ç»“åŸåˆ™</h2>






























<table><thead><tr><th>ç‰¹å¾</th><th><code>suspend</code></th><th><code>Flow</code></th></tr></thead><tbody><tr><td><strong>æ•°æ®ç‰¹æ€§</strong></td><td>é™æ€ï¼Œä¸€æ¬¡æ€§</td><td>åŠ¨æ€ï¼ŒæŒç»­å˜åŒ–</td></tr><tr><td><strong>ç»“æœæ•°é‡</strong></td><td>å•æ¬¡ç»“æœ</td><td>å¤šä¸ªå€¼åºåˆ—</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>å‘é€æœ‹å‹åœˆã€åˆ é™¤ã€ç‚¹èµã€è¯„è®º</td><td>åˆ—è¡¨æ›´æ–°ã€é€šçŸ¥ã€äº’åŠ¨å˜åŒ–</td></tr><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td>æ‰§è¡Œå®Œå³ç»“æŸ</td><td>æŒç»­åˆ°å–æ¶ˆæ”¶é›†</td></tr></tbody></table>
<p><strong>ç®€å•è®°å¿†</strong>ï¼š</p>
<ul>
<li>æ“ä½œåƒ <strong>åŠ¨è¯</strong>ï¼ˆåšæŸäº‹ï¼Œä¾‹å¦‚"å‘é€æœ‹å‹åœˆ"ï¼‰ â†’ ç”¨ <code>suspend</code></li>
<li>æ“ä½œåƒ <strong>åè¯</strong>ï¼ˆè§‚å¯ŸæŸç‰©ï¼Œä¾‹å¦‚"æœ‹å‹åœˆåŠ¨æ€"ï¼‰ â†’ ç”¨ <code>Flow</code></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cè¿›é˜¶ä¹‹å†…å­˜å¯¹é½ï¼Œç¡¬ä»¶æ€»çº¿å’Œé«˜å¹¶å‘ä¼ªå…±äº«çš„åº•å±‚åŸç†]]></title>    <link>https://juejin.cn/post/7583615094362701878</link>    <guid>https://juejin.cn/post/7583615094362701878</guid>    <pubDate>2025-12-15T06:50:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583615094362701878" data-draft-id="7583591656177418276" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Cè¿›é˜¶ä¹‹å†…å­˜å¯¹é½ï¼Œç¡¬ä»¶æ€»çº¿å’Œé«˜å¹¶å‘ä¼ªå…±äº«çš„åº•å±‚åŸç†"/> <meta itemprop="keywords" content="é¢è¯•,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-15T06:50:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xlp666hub"/> <meta itemprop="url" content="https://juejin.cn/user/2965810860569131"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Cè¿›é˜¶ä¹‹å†…å­˜å¯¹é½ï¼Œç¡¬ä»¶æ€»çº¿å’Œé«˜å¹¶å‘ä¼ªå…±äº«çš„åº•å±‚åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2965810860569131/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xlp666hub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T06:50:21.000Z" title="Mon Dec 15 2025 06:50:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ C è¯­è¨€çš„é¢è¯•å’Œå®é™…å¼€å‘ä¸­ï¼Œ<code>sizeof</code> æ˜¯ä¸€ä¸ªå‡ºç°é¢‘ç‡æé«˜çš„å…³é”®è¯ã€‚åˆå­¦è€…å¾€å¾€è®¤ä¸ºå®ƒåªæ˜¯ç”¨æ¥è®¡ç®—å˜é‡å ç”¨ç©ºé—´çš„ï¼Œä½†å®é™…ä¸Šï¼Œ<code>sizeof</code> çš„èƒŒåéšè—ç€<strong>CPU æ¶æ„</strong>ã€<strong>ç¡¬ä»¶æ€»çº¿</strong>ç”šè‡³<strong>é«˜å¹¶å‘æ€§èƒ½</strong>çš„ç§˜å¯†ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸æ³¨é‡äºå¯¹é½è§„åˆ™ï¼Œè€Œæ˜¯ä»ç¡¬ä»¶è§†è§’å‡ºå‘ï¼Œå½»åº•ææ‡‚<strong>ä¸ºä»€ä¹ˆè¦å¯¹é½ï¼Ÿä¸å¯¹é½ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä»¥åŠå¦‚ä½•æŒæ§å¯¹é½ã€‚</strong></p>
<h2 data-id="heading-0">1. <code>sizeof</code> çš„ç»“æœå±…ç„¶å’Œæƒ³è±¡ä¸­ä¸ä¸€æ ·ï¼</h2>
<p>æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼Œå¤§å®¶å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹å®ƒä¼šè¾“å‡ºå¤šå°‘ï¼Ÿ</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
â€‹
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">demo</span> {</span>
 Â  Â <span class="hljs-type">char</span> a; <span class="hljs-comment">// 1 å­—èŠ‚</span>
 Â  Â <span class="hljs-type">int</span> b; Â <span class="hljs-comment">// 4 å­—èŠ‚</span>
};
â€‹
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
 Â  Â <span class="hljs-built_in">printf</span>(<span class="hljs-string">"sizeof(struct demo) = %zu\n"</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> demo));
 Â  Â <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>æˆ‘æ˜¯åœ¨ 64 ä½ Linux ç³»ç»Ÿä¸‹è¿è¡Œï¼Œå¤§å®¶çš„ç»“æœå¤§æ¦‚ç‡ä¹Ÿæ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a39e3ebe9214242b47fb812da500d12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766386221&amp;x-signature=GM7S4fPwU1F%2BTquM5IYfhLXy1q8%3D" alt="1. sizeof ç»“æœ.png" loading="lazy"/></p>
<p>æ€ä¹ˆæ ·ï¼Œå¯èƒ½æœ‰çš„äººå·²ç»çŸ¥é“äº†è¿™ä¸ªç»†èŠ‚ï¼Œä½†æŒ‰ç…§æ­£å¸¸äººçš„æ€ç»´ï¼Œ1åŠ 4æ˜¯ç­‰äº5çš„ï¼Œç»“æœä¸ºä»€ä¹ˆä¼šæ˜¯8å‘¢ï¼Ÿä¸ºä»€ä¹ˆæœ‰3ä¸ªå­—èŠ‚çš„å†…å­˜è¢«ç™½ç™½æµªè´¹äº†ï¼Ÿå…¶å®è¿™å¹¶ä¸æ˜¯ç¼–è¯‘å™¨çš„ BUG ï¼Œè€Œæ˜¯ç¼–è¯‘å™¨ä¸ºäº†è¿åˆ CPU è€Œåšå‡ºçš„<strong>å¦¥å</strong>ã€‚</p>
<p>è¦ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»è·³å‡ºè½¯ä»¶çš„ä»£ç é€»è¾‘ï¼Œçœ‹çœ‹<strong>ç¡¬ä»¶æ€»çº¿</strong>æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<h2 data-id="heading-1">2. CPU è¯»å–å†…å­˜çš„æ–¹å¼</h2>
<p>è¦ç†è§£å†…å­˜å¯¹é½ï¼Œé¦–å…ˆè¦æ˜ç™½ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š<strong>CPU è¯»å–å†…å­˜å¹¶ä¸æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¯»çš„ï¼Œè€Œæ˜¯ä¸€å—ä¸€å—è¯»çš„ã€‚</strong></p>
<h3 data-id="heading-2">2.1 æ•°æ®æ€»çº¿ä¸è¯»å–ç²’åº¦</h3>
<p>CPU å’Œå†…å­˜ä¹‹é—´æœ‰ä¸€æ¡â€œ é«˜é€Ÿå…¬è·¯ â€ï¼Œå«<strong>æ•°æ®æ€»çº¿ (Data Bus)</strong> ã€‚è¿™æ¡è·¯çš„å®½åº¦æ˜¯å›ºå®šçš„ï¼š</p>
<p>å¯¹äº<strong>32ä½ CPU</strong>ï¼šæ€»çº¿å®½åº¦ 32 bitï¼Œä¸€æ¬¡æ¬è¿ <strong>4 å­—èŠ‚</strong>ã€‚</p>
<p>å¯¹äº<strong>64ä½ CPU</strong>ï¼šæ€»çº¿å®½åº¦ 64 bitï¼Œä¸€æ¬¡æ¬è¿ <strong>8 å­—èŠ‚</strong>ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€æ¡è§„åˆ™ï¼š</p>
<p>æˆ‘æ‹¿32ä½ CPU æ¥ä¸¾ä¾‹å­ï¼Œå®ƒä¸€æ¬¡åªèƒ½æ¬è¿4ä¸ªå­—èŠ‚ã€‚è¿™ä¸ªè§„åˆ™çš„å¤§è‡´å†…å®¹æ˜¯ï¼Œè¿™ä¸ª32ä½ CPU ï¼Œæ¯æ¬¡æ¬è¿åªèƒ½ä»åœ°å€ä¸º4çš„å€æ•°å¤„ï¼ˆ0ï¼Œ4ï¼Œ8ï¼Œ12ç­‰ï¼‰å¼€å§‹æ¬è¿4ä¸ªå­—èŠ‚ã€‚</p>
<p>å¯èƒ½æœ‰äººæ— æ³•ç†è§£è¿™æ¡è§„åˆ™å­˜åœ¨çš„æ„ä¹‰ï¼Œé‚£æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹<strong>å†…å­˜æ¡çš„ç‰©ç†ç»“æ„</strong>ã€‚</p>
<p>å®é™…ä¸Šï¼Œç°ä»£æ ‡å‡†å†…å­˜æ¡ï¼ˆDIMMï¼‰ç‰©ç†ä½å®½é€šå¸¸éƒ½æ˜¯ 64 ä½çš„ã€‚</p>
<p>å¯¹äº <strong>64 ä½ CPU</strong>ï¼Œå®ƒèƒ½å……åˆ†åˆ©ç”¨å†…å­˜æ¡çš„ç‰©ç†ä½å®½ï¼Œä¸€æ¬¡åå 8 å­—èŠ‚ã€‚</p>
<p>å¯¹äº <strong>32 ä½ CPU</strong>ï¼Œå—é™äº CPU å†…éƒ¨çš„æ•°æ®æ€»çº¿å®½åº¦ï¼Œå®ƒ<strong>é€»è¾‘ä¸Š</strong>ä¾ç„¶åªèƒ½æŠŠå†…å­˜å½“ä½œ 4 å­—èŠ‚å®½çš„è®¾å¤‡æ¥è®¿é—®ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æ˜¯ä¸€ä¸ª 32 ä½çš„ CPUï¼ˆä¸€æ¬¡è¯»4å­—èŠ‚ï¼‰ï¼šCPU å’Œå†…å­˜ä¹‹é—´æœ‰ <strong>32 æ ¹æ•°æ®çº¿</strong>ï¼ˆD0 - D31ï¼‰ã€‚å†…å­˜æ¡å†…éƒ¨å¹¶ä¸æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚å­˜çš„ï¼Œè€Œæ˜¯åƒ<strong>4åˆ—å®½çš„è¡¨æ ¼</strong>ä¸€æ ·å­˜çš„ï¼Œæƒ³è±¡ä¸€ä¸‹æœ‰å››åˆ—çš„ execl è¡¨æ ¼ï¼ŒCPU æ¯æ¬¡è¯»ä¸€è¡Œï¼ˆä¸€ä¸ª Row ï¼Œä¹Ÿå°±æ˜¯4ä¸ªå­—èŠ‚ï¼‰ã€‚å®ƒçš„ç‰©ç†å¯»å€é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>
<p><strong>Row 0 (åœ°å€ 0)</strong> : åŒ…å«å­—èŠ‚ 0, 1, 2, 3</p>
<p><strong>Row 1 (åœ°å€ 4)</strong> : åŒ…å«å­—èŠ‚ 4, 5, 6, 7</p>
<p><strong>Row 2 (åœ°å€ 8)</strong> : åŒ…å«å­—èŠ‚ 8, 9, 10, 11</p>
<p>å½“ä½ ç»™å†…å­˜å‘é€è¯»å–åœ°å€ 0 çš„ä¿¡å·æ—¶ï¼Œå†…å­˜èŠ¯ç‰‡ä¼š<strong>åŒæ—¶</strong>æŠŠ Row 0 çš„ 4 ä¸ªå­—èŠ‚ï¼Œé€šè¿‡ 32 æ ¹çº¿ä¸€æ¬¡æ€§å‘ç»™ CPUã€‚</p>
<p><strong>é‚£å¦‚æœä½ æƒ³è¯»åœ°å€ 1 å‘¢ï¼Ÿ</strong> ä¹Ÿå°±æ˜¯è¯´<strong>ä½ æƒ³è¦</strong>å­—èŠ‚ 1, 2, 3, 4ã€‚å­—èŠ‚ 1, 2, 3 åœ¨ <strong>Row 0</strong> é‡Œã€‚å­—èŠ‚ 4 åœ¨ <strong>Row 1</strong> é‡Œã€‚è€Œå†…å­˜æ§åˆ¶å™¨<strong>ä¸€æ¬¡åªèƒ½é€‰ä¸­ä¸€è¡Œ</strong>ã€‚å®ƒä¸èƒ½è®©æ•°æ®çº¿çš„ä¸€åŠè¿ç€ Row 0ï¼Œå¦ä¸€åŠè¿ç€ Row 1ã€‚<strong>è¿™å°±æ˜¯ç‰©ç†é™åˆ¶</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c18f19835914f4e807f863f41d7c3bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766386221&amp;x-signature=HzPAq7fc%2BwejIESiICIB2uZlw6s%3D" alt="2. 32ä½å†…å­˜æ¼”ç¤º.png" loading="lazy"/></p>
<p>è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šæœ‰<strong>4çš„å€æ•°</strong>è¿™æ¡è§„åˆ™â€”â€”<strong>è¿™æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†åŒ¹é…å†…å­˜é¢—ç²’çš„ç‰©ç†ä½å®½ï¼Œä»¥è¾¾åˆ°æœ€é«˜çš„ä¼ è¾“æ•ˆç‡ã€‚</strong></p>
<p>è¿™é‡Œå†ç®€å•æä¸€ä¸‹ï¼Œå¯¹äº 64 ä½ CPU ï¼Œä¸Šé¢çš„è¡¨æ ¼ä¸­æ¯è¡Œå°±æ˜¯ 8 ä¸ªå•å…ƒï¼Œä»£è¡¨æ¯æ¬¡è¯»å– 8 ä¸ªå­—èŠ‚ã€‚</p>
<p><strong>å¦‚æœæˆ‘ä»¬éè¦è¯»å–åœ°å€ 1 çš„æ•°æ®ï¼ˆè·¨è¶Šäº†ç¬¬0è¡Œå’Œç¬¬1è¡Œï¼‰æ—¶ï¼Œåˆ°åº•ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p>
<ol>
<li><strong>åœ¨ä¸¥æ ¼çš„æ¶æ„ä¸Šï¼ˆå¦‚æ—©æœŸçš„ ARMã€DSPï¼‰</strong> ï¼šç¡¬ä»¶ç”µè·¯ä¸ºäº†ç®€åŒ–è®¾è®¡ï¼Œå¼ºåˆ¶è¦æ±‚åœ°å€å¿…é¡»å¯¹é½ã€‚å¦‚æœ CPU å‘ç°ä½ è¯•å›¾ä»åœ°å€ 1 è¯»å– 4 å­—èŠ‚ï¼Œå®ƒæ ¹æœ¬æ— æ³•ç”Ÿæˆå¯¹åº”çš„æ—¶åºä¿¡å·ï¼Œç›´æ¥æŠ›å‡º <strong>Bus Error</strong> æˆ– <strong>Hard Fault</strong>ï¼Œç¨‹åº<strong>å½“åœºå´©æºƒ</strong>ã€‚</li>
<li><strong>åœ¨å®½å®¹çš„æ¶æ„ä¸Šï¼ˆå¦‚ x86ï¼‰</strong> ï¼šCPU ç¡¬ä»¶å†…éƒ¨é›†æˆäº†å¤æ‚çš„å¤„ç†é€»è¾‘ã€‚å®ƒä¼šå¸®æˆ‘ä»¬å¤„ç†è¿™ç§æƒ…å†µï¼Œè‡ªåŠ¨å‘èµ·<strong>ä¸¤æ¬¡</strong>å†…å­˜è®¿é—®ï¼ˆä¸€æ¬¡è¯»ç¬¬0è¡Œï¼Œä¸€æ¬¡è¯»ç¬¬1è¡Œï¼‰ï¼Œç„¶ååœ¨ CPU å†…éƒ¨å°†ä¸¤éƒ¨åˆ†æ•°æ®æ‹¼æ¥èµ·æ¥ã€‚è™½ç„¶ç¨‹åºæ²¡å´©ï¼Œä½†<strong>æ¶ˆè€—äº†åŒå€çš„æ€»çº¿å‘¨æœŸ</strong>ã€‚</li>
</ol>
<p><strong>å› æ­¤å†…å­˜å¯¹é½çš„æœ¬è´¨ï¼Œå°±æ˜¯ä¸ºäº†ä¿è¯åœ¨ä»»ä½•æ¶æ„ä¸‹ï¼Œéƒ½èƒ½é€šè¿‡å•æ¬¡æ€»çº¿ä¼ è¾“å®Œæˆæ•°æ®çš„è¯»å–ï¼Œæ—¢ä¸æ­»æœºï¼Œä¹Ÿä¸é™é€Ÿã€‚</strong></p>
<h3 data-id="heading-3">2.2 ä¸åŒæ•°æ®ç±»å‹çš„è‡ªç„¶å¯¹é½é€»è¾‘</h3>
<p>æ˜ç™½äº†æ€»çº¿çš„ç‰©ç†é™åˆ¶åï¼Œæˆ‘ä»¬å°±èƒ½æ¨å¯¼å‡ºä¸åŒæ•°æ®ç±»å‹åœ¨å†…å­˜ä¸­çš„<strong>å­˜æ”¾æ³•åˆ™</strong>ã€‚</p>
<p>åªè¦éµå¾ªä¸‹é¢è¿™æ¡<strong>é»„é‡‘å®šå¾‹</strong>ï¼Œå°±èƒ½ä¿è¯æ•°æ®æ°¸è¿œä¸ä¼šè·¨è¶Šè¡Œè¾¹ç•Œï¼š</p>
<p><strong>æ•°æ®çš„èµ·å§‹åœ°å€ï¼Œå¿…é¡»æ˜¯è¯¥æ•°æ®ç±»å‹å¤§å°çš„æ•´æ•°å€ã€‚</strong> å³ï¼š<code>Address % sizeof(Type) == 0</code>ã€‚</p>
<p>ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯çœ‹ä¸Šé¢çš„å†…å­˜è¡¨æ ¼ã€‚</p>
<ol>
<li><strong>å¯¹äº char</strong> ï¼šå› ä¸ºå®ƒåªæœ‰ 1 ä¸ªå­—èŠ‚ã€‚æ— è®ºä½ æŠŠå®ƒæ”¾åœ¨å“ªä¸ªä½ç½®ï¼Œå®ƒéƒ½<strong>ç»å¯¹ä¸å¯èƒ½</strong>åŒæ—¶è·¨è¶Šä¸¤è¡Œã€‚å› æ­¤ char ä¸éœ€è¦å¯¹é½ï¼Œåœ°å€ä»»æ„ã€‚</li>
</ol>

<ol start="2">
<li><strong>å¯¹äºshort</strong>ï¼šå®ƒå  2 ä¸ªå­—èŠ‚ã€‚</li>
</ol>
<p>å¦‚æœæ”¾åœ¨ 0ï¼šå  [0, 1]ï¼Œåœ¨ Row 0 å†…ï¼Œå®‰å…¨ã€‚</p>
<p>å¦‚æœæ”¾åœ¨ 1ï¼šå  [1, 2]ï¼Œåœ¨ Row 0 å†…ï¼Œå®‰å…¨ã€‚</p>
<p>å¦‚æœæ”¾åœ¨ 2ï¼šå  [2, 3]ï¼Œåœ¨ Row 0 å†…ï¼Œå®‰å…¨ã€‚</p>
<p>å¦‚æœæ”¾åœ¨ 3 (å¥‡æ•°)ï¼šå  [3, 4]ã€‚è·¨è¡Œäº†ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œshort çš„åœ°å€å¿…é¡»æ˜¯ 2 çš„å€æ•°</p>
<ol start="3">
<li>
<p><strong>å¯¹äº int</strong> ï¼šå æ»¡äº†ä¸€æ•´è¡Œã€‚</p>
<p><strong>å¦‚æœæ”¾åœ¨ 0</strong>ï¼šå  [0, 1, 2, 3]ï¼Œå®Œç¾å¡«æ»¡ Row 0ï¼Œå®‰å…¨ã€‚</p>
<p><strong>å¦‚æœæ”¾åœ¨ 1</strong>ï¼šå  [1, 2, 3, 4]ã€‚è·¨è¶Šäº† Row 0 å’Œ Row 1ã€‚è·¨è¡Œï¼</p>
<p>å› æ­¤int çš„åœ°å€å¿…é¡»æ˜¯ 4 çš„å€æ•°ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯å®ƒæ°¸è¿œåªè½åœ¨åŒä¸€è¡Œé‡Œï¼Œè¢« CPU ä¸€æ¬¡æŠ“å–ã€‚</p>
</li>
</ol>

<ol start="4">
<li>
<p><strong>å¯¹äºDouble (8å­—èŠ‚)</strong> ï¼š åœ¨ 64ä½ç³»ç»Ÿ ä¸‹ï¼Œ<strong>å¿…é¡» 8 å­—èŠ‚å¯¹é½</strong>ï¼Œå¦åˆ™è·¨è¶Šæ€»çº¿å‘¨æœŸã€‚</p>
<p>åœ¨ 32ä½ç³»ç»Ÿ ä¸‹ï¼Œè™½ç„¶æ€»çº¿ä¸€æ¬¡åªèƒ½æ¬ 4 å­—èŠ‚ï¼Œè¢«è¿«è¯»ä¸¤æ¬¡ï¼ˆè¿™å·²ç»æ˜¯æé™äº†ï¼‰ï¼Œä½†ä¾ç„¶å»ºè®® 8 å­—èŠ‚å¯¹é½ï¼ˆæˆ–è€…è‡³å°‘ 4 å­—èŠ‚å¯¹é½ï¼‰ï¼Œå¦åˆ™å¯èƒ½éœ€è¦è¯»ä¸‰æ¬¡ï¼</p>
</li>
<li>
<p><strong>å¯¹äºLong</strong> ï¼š åƒä¸‡ä¸è¦æƒ³å½“ç„¶åœ°è®¤ä¸º long æ˜¯ 8 å­—èŠ‚ã€‚</p>
<p>åœ¨ 64ä½ Windows ä¸‹ï¼Œlong ä¾ç„¶æ˜¯ 4 å­—èŠ‚ï¼ˆåŒ intï¼‰ã€‚</p>
<p>åœ¨ 64ä½ Linux ä¸‹ï¼Œlong æ‰æ˜¯ 8 å­—èŠ‚ã€‚</p>
<p>å·¥ç¨‹ç»éªŒï¼šåœ¨è®¾è®¡è·¨å¹³å°é€šä¿¡åè®®æ—¶ï¼Œ<strong>ä¸¥ç¦ä½¿ç”¨ long</strong>ï¼Œè¯·ç›´æ¥ä½¿ç”¨ <code>&lt;stdint.h&gt;</code> ä¸­çš„ <code>int32_t</code> æˆ– <code>int64_t</code>ï¼Œæ˜ç¡®æŒ‡å®šå­—èŠ‚å®½ï¼Œå½»åº•æ¶ˆç­æ­§ä¹‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-4">2.3 ç»“æ„ä½“ä¸­çš„éšå½¢å¡«å……</h3>
<p>åœ¨æ˜ç™½äº†ä¸Šé¢æ‰€è®²çš„ç»†èŠ‚ä¹‹åï¼Œæˆ‘ä»¬å†å›è¿‡å¤´çœ‹æœ€å¼€å§‹çš„é‚£ä¸ªç»“æ„ä½“ Demoï¼Œå°±èƒ½ç†è§£ç¼–è¯‘å™¨ä¸ºä»€ä¹ˆè¦æµªè´¹é‚£ 3 ä¸ªå­—èŠ‚äº†ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">demo</span> {</span>
 Â  Â <span class="hljs-type">char</span> a; <span class="hljs-comment">// 1 å­—èŠ‚</span>
 Â  Â <span class="hljs-type">int</span> b; Â <span class="hljs-comment">// 4 å­—èŠ‚</span>
};
</code></pre>
<p>å‡è®¾èµ·å§‹åœ°å€æ˜¯ 0ï¼Œæˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹ç¼–è¯‘å™¨å®‰æ’å†…å­˜çš„è¿‡ç¨‹ï¼š</p>
<p>æ”¾ç½® <code>char a</code>ï¼š<code>char</code> æ˜¯ä¸€å­—èŠ‚æ•°æ®ï¼Œå¯¹é½è¦æ±‚æ˜¯ 1ã€‚æŠŠå®ƒæ”¾åœ¨åœ°å€ 0x00ã€‚</p>
<p>æ”¾ç½® <code>int b</code>ï¼š<code>int</code> æ˜¯å››å­—èŠ‚æ•°æ®ï¼Œå¯¹é½è¦æ±‚æ˜¯ 4ã€‚å®ƒå¿…é¡»æ”¾åœ¨ 4 çš„å€æ•°åœ°å€ä¸Šã€‚å¦‚æœç´§æŒ¨ç€ a æ”¾ï¼Œåœ°å€æ˜¯ 0x01 ï¼Œè€Œ 0x01 ä¸æ˜¯4çš„å€æ•°ï¼Œæ”¾åœ¨è¿™é‡Œï¼ŒCPU è¯»å®ƒéœ€è¦ä¸¤æ¬¡æ€»çº¿æ“ä½œï¼Œç”šè‡³æŠ¥é”™ã€‚å› æ­¤æŠŠ <code>int b</code> <strong>æ”¾åœ¨åœ°å€ 0x04</strong>ã€‚</p>
<p>è¿™æ—¶ï¼Œ0x01, 0x02, 0x03 è¿™ä¸‰ä¸ªä½ç½®æ˜¯ç©ºçš„ã€‚ç¼–è¯‘å™¨ä¼šåœ¨è¿™äº›ä½ç½®è‡ªåŠ¨å¡«å…¥ <strong>Padding Bytesï¼ˆå¡«å……å­—èŠ‚ï¼‰</strong> ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™äº›å­—èŠ‚åªæ˜¯èµ·åˆ°äº†å¡«å……çš„ä½œç”¨ã€‚</p>
<p>æœ€ç»ˆçš„å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e0fc48877c04ccaa0233339dbdaffbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766386221&amp;x-signature=j9dBvXnKqF3Gork0mJvlb0Yyp6o%3D" alt="3. æœ€ç»ˆå†…å­˜å¸ƒå±€.png" loading="lazy"/></p>
<p><strong>è®¡ç®—æ€»å¤§å°</strong>ï¼š1 (a) + 3 (padding) + 4 (b) = <strong>8 å­—èŠ‚</strong>ã€‚</p>
<p>è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆ <code>sizeof(demo)</code> æ˜¯ 8ï¼Œè€Œä¸æ˜¯ 5ã€‚è¿™æ˜¯<strong>ç”¨ç©ºé—´æ¢æ—¶é—´</strong>çš„å…¸å‹ç­–ç•¥ã€‚</p>
<h2 data-id="heading-5">3. ç¼–è¯‘å™¨çš„å¯¹é½åŸåˆ™</h2>
<p>è®²å®Œäº†æ€»çº¿å®½åº¦å’Œè‡ªç„¶å¯¹é½ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è½¯ä»¶å±‚é¢ã€‚ç¼–è¯‘å™¨åœ¨å¤„ç†ç»“æ„ä½“æ—¶ï¼Œå¹¶ä¸æ˜¯éšæ„å¡«å……çš„ï¼Œè€Œæ˜¯ä¸¥æ ¼éµå¾ªä¸€å¥—<strong>å¯¹é½ç®—æ³•</strong>ã€‚è¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬èƒ½æ‰‹åŠ¨è®¡ç®— <code>sizeof</code> çš„ä¾æ®ã€‚</p>
<p>ç¼–è¯‘å™¨ä¸»è¦éµå¾ªä¸¤æ¡æ ¸å¿ƒåŸåˆ™ï¼š<strong>æˆå‘˜å¯¹é½</strong> å’Œ <strong>æ•´ä½“å¯¹é½</strong>ã€‚</p>
<h3 data-id="heading-6">3.1 æˆå‘˜å¯¹é½</h3>
<p>ç»“æ„ä½“ä¸­æ¯ä¸ªæˆå‘˜ç›¸å¯¹äºç»“æ„ä½“é¦–åœ°å€çš„<strong>åç§»é‡ (Offset)</strong> ï¼Œå¿…é¡»æ˜¯<strong>è¯¥æˆå‘˜å¤§å°çš„æ•´æ•°å€</strong>ï¼ˆæˆ–è€…ç¼–è¯‘å™¨æŒ‡å®šçš„å¯¹é½æ¨¡æ•° #pragma pack(n)ï¼Œå–äºŒè€…è¾ƒå°å€¼ï¼‰ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯ä»¥ struct demo ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Demo</span> {</span>
 Â  Â <span class="hljs-type">char</span> a; <span class="hljs-comment">// 1 byte</span>
 Â  Â <span class="hljs-type">int</span> b; Â <span class="hljs-comment">// 4 bytes</span>
};
</code></pre>
<p>ç»“æ„ä½“<strong>ç¬¬ä¸€ä¸ªæˆå‘˜çš„é¦–åœ°å€</strong>ä¸<strong>æ•´ä¸ªç»“æ„ä½“çš„é¦–åœ°å€</strong>æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯´ï¼Œç»“æ„ä½“ç¬¬ä¸€ä¸ªæˆå‘˜ç›¸å¯¹äºç»“æ„ä½“é¦–åœ°å€çš„<strong>åç§»é‡ä¸º0</strong>ã€‚</p>
<p>æ”¾ç½®aï¼š<code>char</code> å¤§å°ä¸º 1ã€‚åç§»é‡ 0 æ­£å¥½æ˜¯ 1 çš„å€æ•°ã€‚<strong>æ”¾åœ¨ Offset 0</strong>ã€‚</p>
<p>æ”¾ç½®bï¼š<code>int</code> å¤§å°ä¸º 4ã€‚æ­¤æ—¶ç¦» a æœ€è¿‘çš„å¯ä»¥å­˜æ”¾çš„ä½ç½®æ˜¯ <strong>Offset 4</strong>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†è®© b æ”¾åœ¨ Offset 4ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨åœ¨ a åé¢å¡«å……äº† 3 ä¸ªå­—èŠ‚ï¼ˆPaddingï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e0b5c76eae14379b16050de4557f85d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766386221&amp;x-signature=xuedjrkKLRsUSOhYXN4KFJWAZ8Q%3D" alt="4. æˆå‘˜å¯¹é½å†…å­˜å¸ƒå±€.png" loading="lazy"/></p>
<p>æœ€ç»ˆçš„å†…å­˜å¸ƒå±€æ˜¯è¿™æ ·çš„ã€‚</p>
<h3 data-id="heading-7">3.2 æ•´ä½“å¯¹é½</h3>
<p>ç»“æ„ä½“çš„<strong>æ€»å¤§å°</strong>ï¼Œå¿…é¡»æ˜¯å…¶<strong>å†…éƒ¨æœ€å¤§æˆå‘˜å¤§å°</strong>çš„æ•´æ•°å€ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è§„å®šï¼Ÿ</strong> å…¶å®è¿™æ˜¯ä¸ºäº†<strong>ç»“æ„ä½“æ•°ç»„</strong>ã€‚</p>
<p>å¦‚æœç»“æ„ä½“æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">demo_reverse</span> {</span>
 Â  Â <span class="hljs-type">int</span> a; Â <span class="hljs-comment">// 4 bytes</span>
 Â  Â <span class="hljs-type">char</span> b; <span class="hljs-comment">// 1 byte</span>
};
</code></pre>
<p>a åœ¨ <strong>Offset 0</strong>ï¼Œå æ®ç€0ï¼Œ1ï¼Œ2ï¼Œ3å››ä¸ªå­—èŠ‚çš„ä½ç½®ã€‚</p>
<p>b æ˜¯ char å‹ï¼Œå¯ä»¥ä»»æ„æ”¾ï¼Œé‚£å°±æ”¾åœ¨ <strong>Offset 4</strong> è¿™ä¸ªä½ç½®ã€‚</p>
<p>è¿™æ ·çœ‹èµ·æ¥ç¡®å®æ˜¯ä¸éœ€è¦å¡«å……çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ•°ç»„ <code>struct Reverse arr[2];</code> ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p><strong>arr[0]</strong> ï¼šå æ®åœ°å€ 0x00 åˆ° 0x04ã€‚</p>
<p><strong>arr[1]</strong> ï¼šå¦‚æœç»“æ„ä½“å¤§å°æ˜¯ 5ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰å¡«å……ï¼Œé‚£ä¹ˆ <code>arr[1]</code> çš„èµ·å§‹åœ°å€å°±æ˜¯ 0x05ã€‚</p>
<p>è¿™æ—¶å€™é—®é¢˜å‡ºç°äº†ï¼š<code>arr[1].a</code> çš„åœ°å€<strong>0x05</strong>ã€‚0x05 ä¸æ˜¯ 4 çš„å€æ•°ã€‚è¿™æ„å‘³ç€ï¼Œæ•°ç»„é‡Œ<strong>ç¬¬äºŒä¸ªå…ƒç´ çš„ int æˆå‘˜ç«Ÿç„¶ä¸å¯¹é½äº†</strong>ï¼ŒCPU è¯»å®ƒä¼š<strong>å˜æ…¢æˆ–è€…å´©æºƒ</strong>ã€‚</p>
<p>æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç¼–è¯‘å™¨å¼ºåˆ¶è¦æ±‚ï¼š<strong>ç»“æ„ä½“æ€»å¤§å° = æœ€å¤§æˆå‘˜çš„å€æ•°</strong>ã€‚è¿™æ ·å°±ä¸ä¼šå‡ºç°ä¸Šé¢çš„é—®é¢˜äº†ã€‚</p>
<p>ç›®å‰å¤§å°ä¸º 5ï¼Œéœ€è¦è¡¥é½åˆ° 8 (è¿™æ˜¯4çš„å€æ•°)ã€‚æ‰€ä»¥åœ¨ <code>char b</code> åé¢ï¼Œç¼–è¯‘å™¨ä¼šåŠ  3 ä¸ªå­—èŠ‚çš„ <code>Padding</code>ã€‚</p>
<p>æ­¤æ—¶çš„å†…å­˜å¸ƒå±€æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af83649898d24a4e9ae0694d19d1999f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766386221&amp;x-signature=wQkD9gmX24b5RRDhgLi9P%2Bccbd4%3D" alt="5. æ•´ä½“å¯¹é½å†…å­˜å¸ƒå±€.png" loading="lazy"/></p>
<h3 data-id="heading-8">3.3 å¦‚ä½•æ§åˆ¶å¯¹é½</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ˆæ¯”å¦‚ç½‘ç»œä¼ è¾“ï¼‰ï¼Œæˆ‘ä»¬ä¸æƒ³æµªè´¹ç©ºé—´ï¼Œæˆ–è€…åè®®è§„å®šäº†ç´§å‡‘æ’åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ä¿®æ”¹ç¼–è¯‘å™¨çš„é»˜è®¤è¡Œä¸º</strong>ã€‚</p>
<h4 data-id="heading-9">3.3.1 <code>#pragma pack(n)</code></h4>
<p>å‘Šè¯‰ç¼–è¯‘å™¨ï¼šä¸è¦æŒ‰æˆå‘˜å¤§å°å¯¹é½ï¼ŒæŒ‰æˆ‘æŒ‡å®šçš„ n æ¥å¯¹é½ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack(1) <span class="hljs-comment">// å¼ºåˆ¶æŒ‰ 1 å­—èŠ‚å¯¹é½ï¼ˆç›¸å½“äºä¸å¯¹é½ï¼‰</span></span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">packed_demo</span> {</span>
 Â  Â <span class="hljs-type">char</span> a;
 Â  Â <span class="hljs-type">int</span> b;
};
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack() <span class="hljs-comment">// ç”¨æ¥æ¢å¤é»˜è®¤</span></span>
</code></pre>
<p><code>a</code> åœ¨ 0ï¼Œ<code>b</code> åœ¨ 1ï¼ˆå› ä¸º 1 æ˜¯ <code>pack(1)</code> çš„å€æ•°ï¼‰ã€‚æ€»å…± 1 + 4 = 5 å­—èŠ‚ã€‚ä½†æ˜¯CPU è¯»å†™æ•ˆç‡ä¼šé™ä½ã€‚</p>
<h4 data-id="heading-10">3.3.2 <code>__attribute__((packed))</code> (GCC ç‰¹æœ‰)</h4>
<p>åœ¨ Linux å†…æ ¸æºç ä¸­ï¼Œä¸‹é¢è¿™ç§æƒ…å†µæ˜¯å¾ˆå¸¸è§çš„ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">packet</span> {</span>
 Â  Â <span class="hljs-type">char</span> head;
 Â  Â <span class="hljs-type">int</span> len;
} __attribute__((packed));
</code></pre>
<p>è¿™ä¸ªæ•ˆæœå’Œ 3.3.1 ä¸­ä»‹ç»çš„æ–¹æ³•æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚</p>
<h2 data-id="heading-11">4. å®æˆ˜é¿å‘ï¼šç½‘ç»œé€šä¿¡ä¸è·¨å¹³å°ä¼ è¾“</h2>
<p>ç†è§£äº†å¯¹é½ï¼Œä½ å°±èƒ½é¿å¼€åµŒå…¥å¼ç½‘ç»œç¼–ç¨‹ä¸­æœ€å¤§çš„â€œå‘â€ã€‚å¾ˆå¤šäººåœ¨æœ¬åœ°è·‘ä»£ç æ²¡é—®é¢˜ï¼Œä¸€è”è°ƒè®¾å¤‡å°±å´©ï¼ŒåŸå› å¾€å¾€å°±åœ¨è¿™é‡Œã€‚</p>
<h3 data-id="heading-12">4.1 å½“ 64ä½æœåŠ¡å™¨é‡ä¸Š 32ä½å•ç‰‡æœº</h3>
<p>åœ¨ç½‘ç»œç¼–ç¨‹ï¼ˆç‰©è”ç½‘ï¼‰ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ç›´æ¥æŠŠç»“æ„ä½“æŒ‡é’ˆè½¬æˆ <code>void*</code>ï¼Œé€šè¿‡ <code>Socket</code> æˆ–ä¸²å£ç›´æ¥å‘é€å‡ºå»ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªé€šä¿¡åè®®åŒ…ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Packet</span> {</span>
 Â  Â <span class="hljs-type">char</span> cmd; Â  Â <span class="hljs-comment">// 1 byte (å‘½ä»¤å­—)</span>
 Â  Â <span class="hljs-type">int</span> length; Â <span class="hljs-comment">// 4 bytes (æ•°æ®é•¿åº¦)</span>
};
</code></pre>
<p>å‘é€ç«¯ï¼ˆ64ä½ Linux å¼€å‘æœºï¼‰ï¼šæ ¹æ®å¯¹é½è§„åˆ™ï¼Œ<code>cmd</code> åé¢è¡¥ 3 å­—èŠ‚ <code>Padding</code>ï¼Œ<code>sizeof(Packet) = 8</code>ã€‚</p>
<p>å‘é€çš„æ•°æ®æµä¸ºï¼š<code>[cmd] [X] [X] [X] [len_byte1] [len_byte2]...</code></p>
<p>æ¥æ”¶ç«¯ï¼ˆèµ„æºå—é™çš„ 32ä½ STM32 å•ç‰‡æœºï¼‰ï¼šä¸ºäº†èŠ‚çœçè´µçš„ RAMï¼Œå›ºä»¶å·¥ç¨‹å¸ˆå¯èƒ½åœ¨ç¼–è¯‘é€‰é¡¹é‡Œå¼€å¯äº† <code>-fpack-struct</code>ï¼ˆå…¨å±€ç´§å‡‘æ¨¡å¼ï¼‰ï¼Œæˆ–è€…æ‰‹åŠ¨è®¾ç½®äº†å¯¹é½ã€‚ æ¥æ”¶ç«¯è®¤ä¸ºï¼š<code>sizeof(Packet) = 5</code>ã€‚ æ­¤æ—¶ï¼Œå®ƒè¯»å–ç¬¬ 1 ä¸ªå­—èŠ‚å½“ <code>cmd</code>ï¼Œç´§æ¥ç€è¯»å–ç¬¬ 2-5 ä¸ªå­—èŠ‚å½“ <code>length</code>ã€‚</p>
<p>ç»“æœæ˜¯æ¥æ”¶ç«¯æŠŠ<strong>å‘é€ç«¯å¡«å……çš„é‚£ 3 ä¸ªåƒåœ¾å­—èŠ‚å½“æˆäº† length çš„é«˜ä½æ•°æ®</strong>ã€‚</p>
<p>é‚£ä¹ˆè¿™ç§é—®é¢˜è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿè¯·çœ‹ä¸‹ä¸€ç« ã€‚</p>
<h3 data-id="heading-13">4.2 å¼ºåˆ¶å–æ¶ˆå¯¹é½</h3>
<p>åœ¨è®¾è®¡è·¨å¹³å°é€šä¿¡åè®®æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ä¾èµ–ç¼–è¯‘å™¨çš„é»˜è®¤å¯¹é½è¡Œä¸ºï¼Œå› ä¸ºä½ ä¸çŸ¥é“å¯¹æ–¹çš„ç¼–è¯‘å™¨æ˜¯æ€ä¹ˆæƒ³çš„ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦<strong>æ˜¾å¼</strong>åœ°è®©ç¼–è¯‘å™¨ä¸è¦å¡«å……ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Packet</span> {</span>
 Â  Â <span class="hljs-type">char</span> cmd;
 Â  Â <span class="hljs-type">int</span> length;
} __attribute__((packed)); 
â€‹
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack(1) Â </span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Packet</span> {</span>
 Â  Â <span class="hljs-type">char</span> cmd;
 Â  Â <span class="hljs-type">int</span> length;
};
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack() Â  </span>
</code></pre>
<p>è¿™ä¹Ÿæ˜¯ä¸Šé¢æåˆ°çš„ä¸¤ç§æ–¹æ³•ã€‚</p>
<p><code>sizeof</code> å˜æˆäº† <strong>5</strong>ã€‚å‘é€ç«¯å’Œæ¥æ”¶ç«¯çš„å†…å­˜å¸ƒå±€å®Œå…¨ä¸€è‡´ã€‚ä½†ä»£ä»·æ˜¯<strong>æ€§èƒ½çš„ç‰ºç‰²</strong>ã€‚CPU è¯»å–è¿™ä¸ª <code>length</code> æ—¶ï¼Œå› ä¸ºåœ°å€ä¸å¯¹é½ï¼ˆ<code>Offset 1</code>ï¼‰ï¼Œç¡¬ä»¶éœ€è¦è¿›è¡Œä¸¤æ¬¡æ€»çº¿è®¿é—®å’Œæ‹¼æ¥ã€‚ä½†åœ¨ç½‘ç»œä¼ è¾“çš„<strong>æ­£ç¡®æ€§</strong>é¢å‰ï¼Œè¿™ç‚¹ CPU æŸè€—æ˜¯å¿…é¡»ä»˜å‡ºçš„ã€‚</p>
<h3 data-id="heading-14">4.3 å…³äº long çš„é™·é˜±</h3>
<p>é™¤äº†å¯¹é½ï¼Œæ•°æ®ç±»å‹çš„å¤§å°æ˜¯å¦ä¸€ä¸ªå¤§å‘ã€‚è¿™é‡Œæˆ‘å…ˆè¯´ç»“è®ºï¼š<strong>æ°¸è¿œä¸è¦åœ¨è·¨å¹³å°åè®®ä¸­ä½¿ç”¨</strong> <strong>long</strong>ã€‚</p>
<p>å› ä¸º C è¯­è¨€æ ‡å‡†åªè§„å®š <code>long</code> è‡³å°‘å’Œ <code>int</code> ä¸€æ ·å¤§ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è§„å®šå…·ä½“æ˜¯å¤šå°‘ã€‚</p>
<p>åœ¨Windows 64ä½ä¸­ï¼š<code>long</code> æ˜¯ <strong>4 å­—èŠ‚</strong>ã€‚ åœ¨Linux 64ä½ä¸­ï¼š<code>long</code> æ˜¯ <strong>8 å­—èŠ‚</strong>ã€‚</p>
<p>å¦‚æœä½ åœ¨åè®®é‡Œå†™äº† <code>long timestamp;</code>ï¼ŒWindows å‘ç»™ Linuxï¼Œæ•°æ®å°±ä¼šå½»åº•é”™ä½ã€‚</p>
<p>é‚£ä¹ˆä¸ç”¨ long çš„è¯ï¼Œè¯¥æ€ä¹ˆå®šä¹‰ long å¤§å°çš„æ•°æ®ç±»å‹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ°¸è¿œä½¿ç”¨ <code>&lt;stdint.h&gt;</code> ä¸­çš„å®šé•¿ç±»å‹ï¼Œæ˜ç¡®æŒ‡å®šä½å®½ï¼Œä¸ç»™ç¼–è¯‘å™¨ç•™ä»»ä½•è§£é‡Šç©ºé—´ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span>
â€‹
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack(1)</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ProtocolHeader</span> {</span>
 Â  Â <span class="hljs-type">uint8_t</span> Â cmd; Â  Â  Â  
 Â  Â <span class="hljs-type">uint32_t</span> length; Â  Â 
 Â  Â <span class="hljs-type">int64_t</span> Â timestamp; 
};
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> pack()</span>
</code></pre>
<p>åœ¨åº•å±‚å¼€å‘ä¸­ï¼Œæ˜¾å¼å®šä¹‰æ˜¯æ°¸è¿œä¼˜äºéšå¼å®šä¹‰çš„ã€‚</p>
<h2 data-id="heading-15">5. é«˜å¹¶å‘ä¸‹çš„ä¼ªå…±äº«</h2>
<p>å¦‚æœè¯´å‰é¢çš„ <code>Padding</code> æ˜¯ä¸ºäº†å¯¹é½è€Œå¡«å……ï¼Œé‚£ä¹ˆåœ¨<strong>å¤šçº¿ç¨‹é«˜å¹¶å‘</strong>é¢†åŸŸï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦åå…¶é“è€Œè¡Œä¹‹ï¼Œä¹Ÿå°±æ˜¯ä¸ºäº†<strong>ä¸å¯¹é½</strong>è€Œå¡«å……ã€‚</p>
<p>è¿™å¬èµ·æ¥å¾ˆçŸ›ç›¾ï¼Ÿè®©æˆ‘ä»¬å›åˆ°ç¡¬ä»¶å±‚é¢ï¼ŒèŠèŠ <strong>Cache Line</strong>ã€‚å…³äº Cache Lineçš„è¯¦ç»†å†…å®¹æˆ‘å‰é¢çš„æ–‡ç« å·²ç»è®²çš„éå¸¸è¯¦ç»†äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç›´æ¥è¿›å…¥æœ¬ç« èŠ‚çš„å†…å®¹ã€‚</p>
<h3 data-id="heading-16">5.1 åŒä¸€ä¸ªç¼“å­˜è¡Œå†…çš„ç«äº‰</h3>
<p>Cache Line å¤§å°é€šå¸¸æ˜¯ <strong>64 å­—èŠ‚</strong>ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½ è¯»å–ä¸€ä¸ª 4 å­—èŠ‚çš„æ•´æ•°æ—¶ï¼ŒCPU ä¼šé¡ºä¾¿æŠŠé™„è¿‘çš„ 60 ä¸ªå­—èŠ‚ä¹Ÿéƒ½åŠ è½½åˆ° L1 Cache ä¸­ï¼ˆç©ºé—´å±€éƒ¨æ€§ï¼‰ã€‚ä½†åœ¨<strong>å¤šæ ¸å¤šçº¿ç¨‹</strong>ç¯å¢ƒä¸‹ï¼Œè¿™ä¸ªæœºåˆ¶å¯èƒ½ä¼šå¥½å¿ƒåŠåäº‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå…¨å±€ç»“æ„ä½“ï¼Œè¢«ä¸¤ä¸ªçº¿ç¨‹é¢‘ç¹è®¿é—®ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SharedData</span> {</span>
 Â  Â <span class="hljs-type">long</span> a; <span class="hljs-comment">// çº¿ç¨‹ A é¢‘ç¹ä¿®æ”¹</span>
 Â  Â <span class="hljs-type">long</span> b; <span class="hljs-comment">// çº¿ç¨‹ B é¢‘ç¹ä¿®æ”¹</span>
};
</code></pre>
<p><code>long</code> å  8 å­—èŠ‚ï¼Œa å’Œ b ç´§æŒ¨ç€ï¼ŒåŠ èµ·æ¥æ‰ 16 å­—èŠ‚ã€‚åœ¨å†…å­˜ä¸­ï¼Œå®ƒä»¬æœ‰å¾ˆå¤§æ¦‚ç‡ä¼šå¤„åœ¨<strong>åŒä¸€ä¸ª 64 å­—èŠ‚çš„ Cache Line</strong> ä¸­ã€‚</p>
<p>è¯·çœ‹ä¸‹é¢çš„è¿‡ç¨‹ï¼š</p>
<p>Core A ä¿®æ”¹äº†å˜é‡ aã€‚æ ¹æ® <strong>MESI ç¼“å­˜ä¸€è‡´æ€§åè®®</strong>ï¼Œå®ƒå¿…é¡»å¹¿æ’­å‘Šè¯‰å…¶ä»–æ ¸å¿ƒï¼šè¿™ä¸€è¡Œ Cache Line å·²ç»è¢«ä¿®æ”¹äº†ï¼Œå®ƒæ˜¯è„çš„ï¼Œä½ ä»¬å·²ç»è·å–çš„ Cache Line æ— æ•ˆã€‚ Core B æ­¤æ—¶æƒ³ä¿®æ”¹å˜é‡ bã€‚è™½ç„¶ b å’Œ a é€»è¾‘ä¸Šæ— å…³ï¼Œä½†å› ä¸ºå®ƒä»¬<strong>åœ¨åŒä¸€è¡Œ Cache Line</strong>ï¼ŒCore B å‘ç°è‡ªå·±æ‰‹é‡Œçš„ Cache å¤±æ•ˆäº†ã€‚ Core B ä¸å¾—ä¸é‡æ–°ä» L3 æˆ–ä¸»å­˜æ‹‰å–æœ€æ–°çš„ Cache Line æ•°æ®ï¼Œç„¶åä¿®æ”¹ bã€‚è¿™ä¸€ä¿®æ”¹ï¼Œåˆå¯¼è‡´ Core A çš„ Cache Line å¤±æ•ˆã€‚</p>
<p>ç»“æœæ˜¯ä¸¤ä¸ªçº¿ç¨‹æ˜æ˜ä¿®æ”¹çš„æ˜¯ä¸åŒçš„å˜é‡ï¼Œå´åœ¨ç¡¬ä»¶ç¼“å­˜å±‚é¢<strong>äº’ç›¸æ‰“æ¶</strong>ï¼Œå¯¼è‡´ CPU åœ¨æ ¸å¿ƒé—´ç–¯ç‹‚å€’è…¾æ•°æ®ï¼Œæ€»çº¿å¸¦å®½è¢«å æ»¡ï¼Œæ€§èƒ½æš´è·Œã€‚</p>
<p>è¿™å°±æ˜¯è‘—åçš„<strong>ä¼ªå…±äº« (False Sharing)</strong> ã€‚</p>
<h3 data-id="heading-17">5.2 è§£å†³æ–¹æ¡ˆ</h3>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦<strong>æ‰‹åŠ¨å¡«å……</strong>ï¼ŒæŠŠ a å’Œ b <strong>åˆ†åˆ°ä¸åŒçš„ç¼“å­˜è¡Œ</strong>ï¼Œè®©ä»–ä»¬è€æ­»ä¸ç›¸å¾€æ¥ã€‚å…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨ a åé¢å¼ºè¡Œå¡å…¥å¡«å……å­—èŠ‚ï¼Œä½¿å…¶å¡«æ»¡ä¸€ä¸ª Cache Lineï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SharedData</span> {</span>
 Â  Â <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> a;
 Â  Â <span class="hljs-comment">// å¼ºåˆ¶å¡«å…… 56 å­—èŠ‚ï¼ŒåŠ ä¸Šlongå‹çš„aæ­£å¥½64å­—èŠ‚</span>
 Â  Â <span class="hljs-type">char</span> padding1[<span class="hljs-number">56</span>]; 
 Â  Â 
 Â  Â <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> b;
 Â  Â <span class="hljs-comment">// å°¾éƒ¨ä¹Ÿå¡«å……ï¼Œé˜²æ­¢ b å’Œåé¢çš„å˜é‡å†²çª</span>
 Â  Â <span class="hljs-type">char</span> padding2[<span class="hljs-number">56</span>]; 
};
</code></pre>
<h3 data-id="heading-18">5.3 åº”ç”¨æ¡ˆä¾‹</h3>
<p>è¿™ç§æ–¹æ³•è™½ç„¶ä¼šæµªè´¹å¾ˆå¤šå­—èŠ‚ï¼Œä½†æ˜¯åœ¨æè‡´çš„é«˜å¹¶å‘é¢†åŸŸï¼Œæ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p>
<p><strong>Linux å†…æ ¸</strong>ï¼šåœ¨è‡ªæ—‹é”å’Œä¸€äº›ç½‘ç»œè®¾å¤‡é©±åŠ¨çš„æ•°æ®ç»“æ„ä¸­ï¼Œç»å¸¸ä½¿ç”¨ <code>____cacheline_aligned</code> å®æ¥å¼ºåˆ¶å¯¹é½åˆ° 64 å­—èŠ‚ï¼Œé˜²æ­¢å¤šæ ¸ç«äº‰ã€‚</p>
<h2 data-id="heading-19">6. ç»“è¯­</h2>
<p>åˆ°è¿™é‡Œï¼Œè¿™ç¯‡æ–‡ç« å°±ç»“æŸäº†ï¼Œä»æœ€å¼€å§‹çš„ä¸€ä¸ªç»å…¸æ¡ˆä¾‹ï¼Œåˆ°å¯¹ç¡¬ä»¶å±‚é¢çš„è§£è¯»ï¼Œå’Œç¼–è¯‘å™¨çš„ä¼˜åŒ–ä»¥åŠä½œä¸ºç¼–ç¨‹äººå‘˜çš„æˆ‘ä»¬è¯¥æ€æ ·æ§åˆ¶å¯¹é½ï¼Œå†åˆ°ç½‘ç»œå’Œè·¨å¹³å°é€šä¿¡çš„å‘å’Œé«˜å¹¶å‘ä¸‹çš„ä¼ªå…±äº«ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¾ˆå…¨é¢çš„è®¤è¯†å¹¶ç†è§£äº†<strong>å†…å­˜å¯¹é½</strong>å­˜åœ¨çš„æ„ä¹‰ï¼Œä»¥åŠå¦‚ä½•æ§åˆ¶å®ƒã€‚å¦‚æœå¤§å®¶æœ‰ä»»ä½•é—®é¢˜å¯ä»¥å‘åœ¨è¯„è®ºåŒºï¼Œæˆ‘çœ‹åˆ°äº†éƒ½ä¼šæ¢å¤</p>
<p>æœ€åï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹èµå’Œå…³æ³¨å“¦~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºé“¾è¡¨æ“ä½œï¼šä»DummyèŠ‚ç‚¹åˆ°å¿«æ…¢æŒ‡é’ˆçš„å®æˆ˜ç²¾è¦]]></title>    <link>https://juejin.cn/post/7584307642999406635</link>    <guid>https://juejin.cn/post/7584307642999406635</guid>    <pubDate>2025-12-16T10:25:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584307642999406635" data-draft-id="7584287969213972499" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºé“¾è¡¨æ“ä½œï¼šä»DummyèŠ‚ç‚¹åˆ°å¿«æ…¢æŒ‡é’ˆçš„å®æˆ˜ç²¾è¦"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-16T10:25:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ €ç§‹666"/> <meta itemprop="url" content="https://juejin.cn/user/2566698322650307"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºé“¾è¡¨æ“ä½œï¼šä»DummyèŠ‚ç‚¹åˆ°å¿«æ…¢æŒ‡é’ˆçš„å®æˆ˜ç²¾è¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2566698322650307/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ €ç§‹666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T10:25:13.000Z" title="Tue Dec 16 2025 10:25:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨æ•°æ®ç»“æ„çš„å­¦ä¹ ä¸­ï¼Œé“¾è¡¨ä»¥å…¶åŠ¨æ€çµæ´»çš„å†…å­˜ç®¡ç†ç‰¹æ€§ï¼Œæˆä¸ºç®—æ³•è®¾è®¡ä¸é¢è¯•è€ƒå¯Ÿçš„é‡ç‚¹ã€‚ç„¶è€Œï¼Œç”±äºå…¶ä¾èµ–æŒ‡é’ˆæ“ä½œã€ç¼ºä¹éšæœºè®¿é—®èƒ½åŠ›ï¼Œè®¸å¤šå¼€å‘è€…åœ¨å¤„ç†é“¾è¡¨é—®é¢˜æ—¶å¸¸å¸¸é™·å…¥è¾¹ç•Œæ··ä¹±ã€é€»è¾‘æ–­è£‚çš„å›°å¢ƒã€‚æœ¬æ–‡å°†èšç„¦ä¸‰å¤§æ ¸å¿ƒæŠ€å·§â€”â€”<strong>dummyèŠ‚ç‚¹ã€å¤´æ’æ³•åè½¬ã€å¿«æ…¢æŒ‡é’ˆ</strong>ï¼Œç³»ç»Ÿæ¢³ç†é“¾è¡¨æ“ä½œçš„æœ¬è´¨é€»è¾‘ï¼ŒåŠ©ä½ æ„å»ºæ¸…æ™°ç¨³å®šçš„è§£é¢˜æ€ç»´ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€DummyèŠ‚ç‚¹ï¼šç»Ÿä¸€è¾¹ç•Œå¤„ç†çš„â€œä¸‡èƒ½å“¨å…µâ€</h3>
<p>é“¾è¡¨æ“ä½œä¸­æœ€ä»¤äººå¤´ç–¼çš„é—®é¢˜ä¹‹ä¸€ï¼Œæ˜¯<strong>å¤´èŠ‚ç‚¹çš„ç‰¹æ®Šæ€§</strong>ã€‚ä¾‹å¦‚åˆ é™¤å€¼ä¸º <code>val</code> çš„èŠ‚ç‚¹æ—¶ï¼Œè‹¥ç›®æ ‡æ°å¥½æ˜¯å¤´èŠ‚ç‚¹ï¼Œç”±äºå®ƒæ²¡æœ‰å‰é©±ï¼Œæ— æ³•é€šè¿‡â€œå‰é©±ä¿®æ”¹ nextâ€çš„æ–¹å¼åˆ é™¤ï¼Œå¿…é¡»å•ç‹¬åˆ¤æ–­ã€‚</p>
<p>è¿™ç§â€œä¾‹å¤–æƒ…å†µâ€ä¸ä»…å¢åŠ ä»£ç å¤æ‚åº¦ï¼Œè¿˜å®¹æ˜“å¼•å‘ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå°¤å…¶åœ¨ç©ºé“¾è¡¨æˆ–å…¨åŒ¹é…åœºæ™¯ä¸‹ææ˜“å‡ºé”™ã€‚</p>
<h4 data-id="heading-2">è§£å†³æ–¹æ¡ˆï¼šå¼•å…¥ dummy èŠ‚ç‚¹</h4>
<p>dummy èŠ‚ç‚¹ï¼ˆåˆç§°å“¨å…µèŠ‚ç‚¹ï¼‰æ˜¯ä¸€ä¸ªä¸å­˜å‚¨æœ‰æ•ˆæ•°æ®çš„äººå·¥èŠ‚ç‚¹ï¼Œé€šå¸¸ç½®äºé“¾è¡¨å¤´éƒ¨ï¼Œä½œä¸º <code>head</code> çš„å‰é©±ã€‚å®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<blockquote>
<p><strong>è®©æ‰€æœ‰èŠ‚ç‚¹éƒ½æ‹¥æœ‰å‰é©±ï¼Œä»è€Œå°†å¤´èŠ‚ç‚¹é™çº§ä¸ºæ™®é€šèŠ‚ç‚¹ï¼Œå®ç°æ“ä½œç»Ÿä¸€åŒ–ã€‚</strong></p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">removeElements</span>(<span class="hljs-params">head, val</span>) {
    <span class="hljs-keyword">const</span> dummy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);
    dummy.<span class="hljs-property">next</span> = head;
    <span class="hljs-keyword">let</span> cur = dummy;

    <span class="hljs-keyword">while</span> (cur.<span class="hljs-property">next</span>) {
        <span class="hljs-keyword">if</span> (cur.<span class="hljs-property">next</span>.<span class="hljs-property">val</span> === val) {
            cur.<span class="hljs-property">next</span> = cur.<span class="hljs-property">next</span>.<span class="hljs-property">next</span>;
        } <span class="hljs-keyword">else</span> {
            cur = cur.<span class="hljs-property">next</span>;
        }
    }

    <span class="hljs-keyword">return</span> dummy.<span class="hljs-property">next</span>;
}
</code></pre>
<p>æ­¤æ—¶æ— è®ºåŸå¤´èŠ‚ç‚¹æ˜¯å¦è¢«åˆ é™¤ï¼Œ<code>dummy.next</code> å§‹ç»ˆæŒ‡å‘æ–°çš„å¤´èŠ‚ç‚¹ï¼Œå½»åº•è§„é¿äº†å¯¹ <code>head</code> çš„ç‰¹æ®Šå¤„ç†ï¼Œä¹Ÿé¿å…äº†ç©ºé“¾è¡¨ä¸‹çš„ <code>null</code> å¼‚å¸¸ã€‚</p>
<p>ğŸ’¡ <strong>ä½¿ç”¨åŸåˆ™</strong>ï¼š</p>
<ul>
<li>å‡¡æ¶‰åŠèŠ‚ç‚¹åˆ é™¤ã€æ’å…¥ç­‰å¯èƒ½å½±å“å¤´èŠ‚ç‚¹çš„æ“ä½œï¼Œä¼˜å…ˆè€ƒè™‘æ·»åŠ  dummyã€‚</li>
<li>æœ€ç»ˆè¿”å› <code>dummy.next</code>ï¼Œè€ŒéåŸå§‹ headã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3">äºŒã€å¤´æ’æ³•åè½¬é“¾è¡¨ï¼šæœ€ä¼˜é›…çš„å°±åœ°åè½¬ç­–ç•¥</h3>
<p>é“¾è¡¨åè½¬æ˜¯ç»å…¸æ“ä½œï¼Œå¸¸è§è§£æ³•æœ‰é€’å½’æ³•å’Œä¸‰æŒ‡é’ˆè¿­ä»£æ³•ã€‚è€Œ<strong>åŸºäº dummy çš„å¤´æ’æ³•</strong>ï¼Œé€»è¾‘æœ€ä¸ºç›´è§‚ï¼Œä¸æ˜“å‡ºé”™ã€‚</p>
<h4 data-id="heading-4">æ ¸å¿ƒæ€æƒ³</h4>
<p>éå†åŸé“¾è¡¨ï¼Œå°†æ¯ä¸ªèŠ‚ç‚¹ä¾æ¬¡â€œæ’å…¥â€åˆ° dummy èŠ‚ç‚¹ä¹‹åï¼Œå½¢æˆä¸€ä¸ªæ–°çš„é€†åºé“¾ã€‚éšç€éå†è¿›è¡Œï¼Œå·²å¤„ç†éƒ¨åˆ†è‡ªç„¶æ„æˆä¸€ä¸ªåå‘é“¾è¡¨ã€‚</p>
<h4 data-id="heading-5">å®ç°æ­¥éª¤</h4>
<ol>
<li>åˆ›å»º <code>dummy</code> èŠ‚ç‚¹ï¼Œåˆå§‹ <code>dummy.next = null</code></li>
<li>éå†åŸé“¾è¡¨ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹ <code>cur</code>ï¼š
<ul>
<li>ä¿å­˜å…¶åç»§ï¼š<code>const next = cur.next</code></li>
<li>å°† <code>cur</code> æ’å…¥ dummy åï¼š<code>cur.next = dummy.next</code></li>
<li>æ›´æ–° dummy æŒ‡å‘æ–°å¤´ï¼š<code>dummy.next = cur</code></li>
<li>ç»§ç»­å¤„ç†ï¼š<code>cur = next</code></li>
</ul>
</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">reverseList</span>(<span class="hljs-params">head</span>) {
    <span class="hljs-keyword">const</span> dummy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">let</span> cur = head;

    <span class="hljs-keyword">while</span> (cur) {
        <span class="hljs-keyword">const</span> next = cur.<span class="hljs-property">next</span>;     <span class="hljs-comment">// ä¿å­˜åç»­</span>
        cur.<span class="hljs-property">next</span> = dummy.<span class="hljs-property">next</span>;     <span class="hljs-comment">// æ¥åˆ°å·²åè½¬éƒ¨åˆ†</span>
        dummy.<span class="hljs-property">next</span> = cur;          <span class="hljs-comment">// æˆä¸ºæ–°å¤´</span>
        cur = next;                <span class="hljs-comment">// ç»§ç»­éå†</span>
    }

    <span class="hljs-keyword">return</span> dummy.<span class="hljs-property">next</span>;
}
</code></pre>
<p>âœ… <strong>ä¼˜åŠ¿åˆ†æ</strong>ï¼š</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ O(n)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)</li>
<li>æ— éœ€é¢å¤–å˜é‡è®°å½• prev å’Œ next</li>
<li>é€»è¾‘æ¸…æ™°ï¼Œé€‚åˆå¿«é€Ÿç¼–ç </li>
</ul>
<p>ğŸ“Œ <strong>å…³é”®æé†’</strong>ï¼šåŠ¡å¿…åœ¨ä¿®æ”¹ <code>cur.next</code> å‰ä¿å­˜ <code>next</code>ï¼Œå¦åˆ™åŸé“¾æ–­è£‚ï¼Œéå†ä¸­æ–­ã€‚</p>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€å¿«æ…¢æŒ‡é’ˆï¼šé«˜æ•ˆå®šä½çš„â€œåŒå¼•æ“â€</h3>
<p>å½“éœ€è¦åœ¨å•æ¬¡éå†ä¸­å®šä½ç‰¹å®šä½ç½®ï¼ˆå¦‚ä¸­é—´èŠ‚ç‚¹ã€å€’æ•°ç¬¬ N ä¸ªã€ç¯å…¥å£ï¼‰ï¼Œ<strong>å¿«æ…¢æŒ‡é’ˆ</strong>æ˜¯æœ€é«˜æ•ˆçš„å·¥å…·ã€‚</p>
<p>å…¶åŸºæœ¬å½¢å¼ä¸ºï¼š</p>
<ul>
<li><code>slow</code> æ¯æ¬¡èµ° 1 æ­¥</li>
<li><code>fast</code> æ¯æ¬¡èµ° 2 æ­¥</li>
</ul>
<p>åˆ©ç”¨ä¸¤è€…é€Ÿåº¦å·®ï¼Œå¯å·§å¦™è§£å†³å¤šç§é—®é¢˜ã€‚</p>
<h4 data-id="heading-7">åº”ç”¨ 1ï¼šåˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯</h4>
<p>è‹¥é“¾è¡¨æ— ç¯ï¼Œ<code>fast</code> ä¼šå…ˆåˆ°è¾¾æœ«å°¾ï¼ˆ<code>null</code>ï¼‰ã€‚è‹¥æœ‰ç¯ï¼Œ<code>fast</code> è¿›å…¥ç¯åä¼šä¸æ–­è¿½èµ¶ <code>slow</code>ï¼Œæœ€ç»ˆç›¸é‡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hasCycle</span>(<span class="hljs-params">head</span>) {
    <span class="hljs-keyword">let</span> slow = head, fast = head;

    <span class="hljs-keyword">while</span> (fast &amp;&amp; fast.<span class="hljs-property">next</span>) {
        slow = slow.<span class="hljs-property">next</span>;
        fast = fast.<span class="hljs-property">next</span>.<span class="hljs-property">next</span>;
        <span class="hljs-keyword">if</span> (slow === fast) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>ä¸ºä½• <code>fast</code> èµ°ä¸¤æ­¥ï¼Ÿå› ä¸ºæ¯è½®ä¸¤è€…è·ç¦»ç¼©å° 1ï¼Œå¿…èƒ½è¿½ä¸Šï¼›è‹¥èµ°æ›´å¤šæ­¥ï¼Œå¯èƒ½è·³è¿‡ <code>slow</code> å¯¼è‡´è¯¯åˆ¤ã€‚</p>
<h4 data-id="heading-8">åº”ç”¨ 2ï¼šæŸ¥æ‰¾ä¸­é—´èŠ‚ç‚¹</h4>
<p>å½“ <code>fast</code> åˆ°è¾¾æœ«å°¾æ—¶ï¼Œ<code>slow</code> æ­£å¥½ä½äºä¸­ç‚¹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">middleNode</span>(<span class="hljs-params">head</span>) {
    <span class="hljs-keyword">let</span> slow = head, fast = head;
    <span class="hljs-keyword">while</span> (fast &amp;&amp; fast.<span class="hljs-property">next</span>) {
        slow = slow.<span class="hljs-property">next</span>;
        fast = fast.<span class="hljs-property">next</span>.<span class="hljs-property">next</span>;
    }
    <span class="hljs-keyword">return</span> slow;
}
</code></pre>
<p>æ­¤æ–¹æ³•é€‚ç”¨äºå¥‡å¶é•¿åº¦é“¾è¡¨ï¼Œè¿”å›é åçš„ä¸­é—´èŠ‚ç‚¹ã€‚</p>
<h4 data-id="heading-9">åº”ç”¨ 3ï¼šåˆ é™¤å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹</h4>
<p>æ€è·¯ï¼šè®© <code>fast</code> å…ˆèµ° N æ­¥ï¼Œå†ä¸ <code>slow</code> åŒæ­¥å‰è¿›ã€‚å½“ <code>fast</code> åˆ°è¾¾æœ«å°¾æ—¶ï¼Œ<code>slow</code> æŒ‡å‘ç›®æ ‡èŠ‚ç‚¹çš„å‰é©±ã€‚</p>
<p>ç»“åˆ dummy èŠ‚ç‚¹ï¼Œå¯ç»Ÿä¸€å¤„ç†å¤´èŠ‚ç‚¹åˆ é™¤ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">removeNthFromEnd</span>(<span class="hljs-params">head, n</span>) {
    <span class="hljs-keyword">const</span> dummy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);
    dummy.<span class="hljs-property">next</span> = head;
    <span class="hljs-keyword">let</span> fast = dummy, slow = dummy;

    <span class="hljs-keyword">while</span> (n--) fast = fast.<span class="hljs-property">next</span>;

    <span class="hljs-keyword">while</span> (fast.<span class="hljs-property">next</span>) {
        fast = fast.<span class="hljs-property">next</span>;
        slow = slow.<span class="hljs-property">next</span>;
    }

    slow.<span class="hljs-property">next</span> = slow.<span class="hljs-property">next</span>.<span class="hljs-property">next</span>;
    <span class="hljs-keyword">return</span> dummy.<span class="hljs-property">next</span>;
}
</code></pre>
<hr/>
<h3 data-id="heading-10">å››ã€æ€»ç»“ï¼šé“¾è¡¨æ“ä½œçš„å››å¤§å¿ƒæ³•</h3>
<ol>
<li>
<p><strong>Dummyä¼˜å…ˆåŸåˆ™</strong><br/>
æ‰€æœ‰æ¶‰åŠç»“æ„å˜æ›´çš„æ“ä½œï¼Œä¼˜å…ˆæ·»åŠ  dummy èŠ‚ç‚¹ï¼Œæ¶ˆé™¤è¾¹ç•Œå·®å¼‚ã€‚</p>
</li>
<li>
<p><strong>æŒ‡é’ˆå®‰å…¨ç¬¬ä¸€</strong><br/>
ä¿®æ”¹ä»»ä½• <code>next</code> æŒ‡é’ˆå‰ï¼ŒåŠ¡å¿…ä¿å­˜åç»­èŠ‚ç‚¹å¼•ç”¨ï¼Œé˜²æ­¢é“¾è¡¨æ–­è£‚ã€‚</p>
</li>
<li>
<p><strong>å¿«æ…¢æŒ‡é’ˆæé€Ÿ</strong><br/>
æ¶‰åŠâ€œä¸­ç‚¹â€ã€â€œå€’æ•°â€ã€â€œç¯â€ç­‰é—®é¢˜ï¼Œé¦–é€‰å¿«æ…¢æŒ‡é’ˆï¼Œå®ç°ä¸€æ¬¡éå†å®šä½ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ‰‹ç”»å›¾éªŒè¯</strong><br/>
é“¾è¡¨é€»è¾‘æŠ½è±¡ï¼Œå»ºè®®ç”¨ç®€å•å®ä¾‹ï¼ˆå¦‚ 3 ä¸ªèŠ‚ç‚¹ï¼‰æ‰‹åŠ¨æ¨¡æ‹Ÿæ¯ä¸€æ­¥æŒ‡é’ˆå˜åŒ–ï¼Œç¡®ä¿ç†è§£æ­£ç¡®ã€‚</p>
</li>
</ol>
<hr/>
<p>æŒæ¡è¿™ä¸‰å¤§æŠ€å·§ï¼Œä½ å°±æ‹¥æœ‰äº†åº”å¯¹ç»å¤§å¤šæ•°é“¾è¡¨é—®é¢˜çš„â€œå·¥å…·ç®±â€ã€‚å®ƒä»¬ä¸ä»…æ˜¯è§£é¢˜æ–¹æ³•ï¼Œæ›´æ˜¯ä¸€ç§ç¼–ç¨‹æ€ç»´ï¼š<strong>é€šè¿‡å¼•å…¥è¾…åŠ©ç»“æ„ï¼ˆdummyï¼‰ã€æ§åˆ¶ç›¸å¯¹é€Ÿåº¦ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰ã€é‡æ„å¤„ç†é¡ºåºï¼ˆå¤´æ’æ³•ï¼‰ï¼Œå°†å¤æ‚é—®é¢˜è½¬åŒ–ä¸ºå¯ç»Ÿä¸€å¤„ç†çš„æ¨¡å¼</strong>ã€‚</p>
<p>é“¾è¡¨å¹¶ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯æ²¡æœ‰ç« æ³•ã€‚å½“ä½ å­¦ä¼šç”¨è¿™äº›æ¨¡å¼å»æ‹†è§£é—®é¢˜ï¼Œä½ ä¼šå‘ç°ï¼Œæ‰€è°“çš„â€œéš¾é¢˜â€ï¼Œä¸è¿‡æ˜¯åŸºç¡€æŠ€å·§çš„ç»„åˆåº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reacté¡µé¢åˆ·æ–°æ•°æ®ä¸ä¸¢å¤±ï¼Ÿ5ç§æ–¹æ¡ˆå…¨è§£æï¼]]></title>    <link>https://juejin.cn/post/7583913535271092234</link>    <guid>https://juejin.cn/post/7583913535271092234</guid>    <pubDate>2025-12-15T13:30:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583913535271092234" data-draft-id="7583878719544147977" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reacté¡µé¢åˆ·æ–°æ•°æ®ä¸ä¸¢å¤±ï¼Ÿ5ç§æ–¹æ¡ˆå…¨è§£æï¼"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-15T13:30:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reacté¡µé¢åˆ·æ–°æ•°æ®ä¸ä¸¢å¤±ï¼Ÿ5ç§æ–¹æ¡ˆå…¨è§£æï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T13:30:16.000Z" title="Mon Dec 15 2025 13:30:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯å¼€å‘ä¸­ï¼Œç›¸ä¿¡å¤§å®¶éƒ½é‡åˆ°è¿‡è¿™æ ·çš„ç—›ç‚¹ï¼š<strong>é¡µé¢ä¸€åˆ·æ–°ï¼Œè¾›è¾›è‹¦è‹¦å¡«çš„è¡¨å•æ•°æ®æ²¡äº†ï¼ç²¾å¿ƒé€‰æ‹©çš„ç­›é€‰æ¡ä»¶é‡ç½®äº†ï¼</strong></p>
<p>ä»Šå¤©æˆ‘ä»¬å°±æ¥æ·±å…¥æ¢è®¨Reactä¸­æ•°æ®æŒä¹…åŒ–çš„<strong>5å¤§æ ¸å¿ƒæ–¹æ¡ˆ</strong>ï¼Œä»ç®€å•åˆ°å¤æ‚ï¼Œå¸®ä½ å½»åº•è§£å†³è¿™ä¸ªéš¾é¢˜ï¼</p>
<h2 data-id="heading-0">ä¸€ã€é—®é¢˜åœºæ™¯ï¼šä¸ºä»€ä¹ˆæ•°æ®ä¼šä¸¢å¤±ï¼Ÿ</h2>
<p>æˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­æ„Ÿå—ä¸€ä¸‹é—®é¢˜ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span>Â <span class="hljs-title">UserForm</span>(<span class="hljs-params"/>)Â </span>{
Â Â <span class="hljs-keyword">const</span>Â [formData,Â setFormData]Â =Â <span class="hljs-title function_ invoke__">useState</span>({
<span class="hljs-attr">Â Â Â Â username</span>:Â <span class="hljs-string">''</span>,
<span class="hljs-attr">Â Â Â Â email</span>:Â <span class="hljs-string">''</span>,
<span class="hljs-attr">Â Â Â Â preferences</span>:Â {
<span class="hljs-attr">Â Â Â Â Â Â theme</span>:Â <span class="hljs-string">'light'</span>,
<span class="hljs-attr">Â Â Â Â Â Â notifications</span>:Â <span class="hljs-literal">true</span>
Â Â Â Â }
Â Â });

Â Â <span class="hljs-comment">//Â ç”¨æˆ·è¾“å…¥æ•°æ®...</span>
Â Â <span class="hljs-comment">//Â é¡µé¢åˆ·æ–°Â â†’Â æ‰€æœ‰æ•°æ®å½’é›¶Â ğŸ˜­</span>
Â Â 
Â Â <span class="hljs-keyword">return</span><span class="hljs-title function_ invoke__">Â </span>(
Â Â Â Â &lt;form&gt;
Â Â Â Â Â Â &lt;inputÂ 
Â Â Â Â Â Â Â Â value={formData.username}
Â Â Â Â Â Â Â Â onChange={(e)Â =&gt;Â <span class="hljs-title function_ invoke__">setFormData</span>({...formData,<span class="hljs-attr">Â username</span>:Â e.target.value})}
Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â {<span class="hljs-comment">/*Â å…¶ä»–è¡¨å•é¡¹Â */</span>}
Â Â Â Â &lt;/form&gt;
Â Â );
}
</code></pre>
<p>æ•°æ®ä¸¢å¤±çš„æ ¹æœ¬åŸå› æ˜¯ï¼š<strong>ReactçŠ¶æ€ï¼ˆstateï¼‰å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé¡µé¢åˆ·æ–°æ—¶å†…å­˜è¢«æ¸…ç©º</strong>ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ–¹æ¡ˆä¸€ï¼šlocalStorageï¼ˆæœ€å¸¸ç”¨ï¼‰</h2>
<h3 data-id="heading-2">åŸºæœ¬å®ç°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">useLocalStorage</span>(<span class="hljs-params">key,Â initialValue</span>)Â {
Â Â <span class="hljs-comment">//Â ä»localStorageè¯»å–åˆå§‹å€¼</span>
Â Â <span class="hljs-keyword">const</span>Â [storedValue,Â setStoredValue]Â =Â <span class="hljs-title function_">useState</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â itemÂ =Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â itemÂ ?Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(item)Â :Â initialValue;
Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â initialValue;
Â Â Â Â }
Â Â });

Â Â <span class="hljs-comment">//Â æ›´æ–°çŠ¶æ€å¹¶ä¿å­˜åˆ°localStorage</span>
Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-title function_">setValue</span>Â =Â (<span class="hljs-params">value</span>)Â =&gt;Â {
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â valueToStoreÂ =Â valueÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">Function</span>Â ?Â <span class="hljs-title function_">value</span>(storedValue)Â :Â value;
Â Â Â Â Â Â <span class="hljs-title function_">setStoredValue</span>(valueToStore);
Â Â Â Â Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">localStorage</span>.<span class="hljs-title function_">setItem</span>(key,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(valueToStore));
Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
Â Â Â Â }
Â Â };

Â Â <span class="hljs-keyword">return</span>Â [storedValue,Â setValue];
}

<span class="hljs-comment">//Â ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">PersistentForm</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">const</span>Â [userData,Â setUserData]Â =Â <span class="hljs-title function_">useLocalStorage</span>(<span class="hljs-string">'user_form_data'</span>,Â {
Â Â Â Â <span class="hljs-attr">username</span>:Â <span class="hljs-string">''</span>,
Â Â Â Â <span class="hljs-attr">email</span>:Â <span class="hljs-string">''</span>,
Â Â Â Â <span class="hljs-attr">theme</span>:Â <span class="hljs-string">'light'</span>
Â Â });

Â Â <span class="hljs-keyword">return</span>Â (
Â Â Â Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">value</span>=<span class="hljs-string">{userData.username}</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span>Â =&gt;</span>Â setUserData({
Â Â Â Â Â Â Â Â Â Â ...userData,Â 
Â Â Â Â Â Â Â Â Â Â username:Â e.target.value
Â Â Â Â Â Â Â Â })}
Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â {/*Â ä¿å­˜ååˆ·æ–°é¡µé¢ï¼Œæ•°æ®è¿˜åœ¨ï¼Â */}
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
Â Â );
}
</code></pre>
<h3 data-id="heading-3">è¿›é˜¶ï¼šè‡ªåŠ¨è¿‡æœŸå’ŒåŠ å¯†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SecureStorage</span>Â {
Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">namespace</span></span>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">namespace</span>Â =Â <span class="hljs-keyword">namespace</span>;
Â Â }

Â Â set(key,Â value,Â ttlÂ =Â null)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â itemÂ =Â {
Â Â Â Â Â Â value,
Â Â Â Â Â Â <span class="hljs-attr">timestamp</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
Â Â Â Â Â Â ttl
Â Â Â Â };
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ç®€å•åŠ å¯†ï¼ˆç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹æ¡ˆï¼‰</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â encryptedÂ =Â <span class="hljs-title function_">btoa</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(item));
Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.<span class="hljs-keyword">namespace</span>}</span>:<span class="hljs-subst">${key}</span>`</span>,Â encrypted);
Â Â }

Â Â <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â encryptedÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.<span class="hljs-keyword">namespace</span>}</span>:<span class="hljs-subst">${key}</span>`</span>);
Â Â Â Â <span class="hljs-keyword">if</span>Â (!encrypted)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>;

Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â itemÂ =Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title function_">atob</span>(encrypted));
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â æ£€æŸ¥æ˜¯å¦è¿‡æœŸ</span>
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (item.<span class="hljs-property">ttl</span>Â &amp;&amp;Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()Â -Â item.<span class="hljs-property">timestamp</span>Â &gt;Â item.<span class="hljs-property">ttl</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">remove</span>(key);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>;
Â Â Â Â Â Â }
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â item.<span class="hljs-property">value</span>;
Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>;
Â Â Â Â }
Â Â }
}

<span class="hljs-comment">//Â ä½¿ç”¨</span>
<span class="hljs-keyword">const</span>Â storageÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">SecureStorage</span>(<span class="hljs-string">'myApp'</span>);
storage.<span class="hljs-title function_">set</span>(<span class="hljs-string">'token'</span>,Â <span class="hljs-string">'abc123'</span>,Â <span class="hljs-number">1000</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">60</span>);Â <span class="hljs-comment">//Â 1å°æ—¶è¿‡æœŸ</span>
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€æ–¹æ¡ˆäºŒï¼šsessionStorageï¼ˆæ ‡ç­¾é¡µçº§åˆ«ï¼‰</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">useSessionStorage</span>(<span class="hljs-params">key,Â initialValue</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â [state,Â setState]Â =Â <span class="hljs-title function_">useState</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â åªåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">typeof</span>Â <span class="hljs-variable language_">window</span>Â ===Â <span class="hljs-string">'undefined'</span>)Â <span class="hljs-keyword">return</span>Â initialValue;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">const</span>Â storedÂ =Â sessionStorage.<span class="hljs-title function_">getItem</span>(key);
Â Â Â Â <span class="hljs-keyword">return</span>Â storedÂ ?Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(stored)Â :Â initialValue;
Â Â });

Â Â <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â sessionStorage.<span class="hljs-title function_">setItem</span>(key,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(state));
Â Â },Â [key,Â state]);

Â Â <span class="hljs-keyword">return</span>Â [state,Â setState];
}

<span class="hljs-comment">//Â ç‰¹æ€§ï¼šä¸åŒæ ‡ç­¾é¡µæ•°æ®éš”ç¦»ï¼Œå…³é—­æ ‡ç­¾é¡µè‡ªåŠ¨æ¸…é™¤</span>
</code></pre>
<h2 data-id="heading-5">å››ã€æ–¹æ¡ˆä¸‰ï¼šIndexedDBï¼ˆå¤§é‡æ•°æ®ï¼‰</h2>
<p>å½“éœ€è¦å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®æ—¶ï¼ŒIndexedDBæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">classÂ IndexedDBServiceÂ {
Â Â constructor(dbName,Â version)Â {
Â Â Â Â <span class="hljs-attr">this.dbName</span>Â =Â dbName<span class="hljs-comment">;</span>
Â Â Â Â <span class="hljs-attr">this.version</span>Â =Â version<span class="hljs-comment">;</span>
Â Â Â Â <span class="hljs-attr">this.db</span>Â =Â null<span class="hljs-comment">;</span>
Â Â }

Â Â asyncÂ open()Â {
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =&gt;Â {
Â Â Â Â Â Â constÂ <span class="hljs-attr">request</span>Â =Â indexedDB.open(this.dbName,Â this.version)<span class="hljs-comment">;</span>

Â Â Â Â Â Â <span class="hljs-attr">request.onupgradeneeded</span>Â =Â (event)Â =&gt;Â {
Â Â Â Â Â Â Â Â constÂ <span class="hljs-attr">db</span>Â =Â event.target.result<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â ifÂ (!db.objectStoreNames.contains('state'))Â {
Â Â Â Â Â Â Â Â Â Â db.createObjectStore('state',Â {Â keyPath:Â 'key'Â })<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }<span class="hljs-comment">;</span>

Â Â Â Â Â Â <span class="hljs-attr">request.onsuccess</span>Â =Â (event)Â =&gt;Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">this.db</span>Â =Â event.target.result<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â resolve()<span class="hljs-comment">;</span>
Â Â Â Â Â Â }<span class="hljs-comment">;</span>

Â Â Â Â Â Â <span class="hljs-attr">request.onerror</span>Â =Â (event)Â =&gt;Â reject(event.target.error)<span class="hljs-comment">;</span>
Â Â Â Â })<span class="hljs-comment">;</span>
Â Â }

Â Â asyncÂ set(key,Â value)Â {
Â Â Â Â constÂ <span class="hljs-attr">transaction</span>Â =Â this.db.transaction([<span class="hljs-string">'state'</span>],Â <span class="hljs-string">'readwrite'</span>)<span class="hljs-comment">;</span>
Â Â Â Â constÂ <span class="hljs-attr">store</span>Â =Â transaction.objectStore(<span class="hljs-string">'state'</span>)<span class="hljs-comment">;</span>
Â Â Â Â store.put({Â key,Â valueÂ })<span class="hljs-comment">;</span>
Â Â }

Â Â asyncÂ get(key)Â {
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =&gt;Â {
Â Â Â Â Â Â constÂ <span class="hljs-attr">transaction</span>Â =Â this.db.transaction([<span class="hljs-string">'state'</span>],Â <span class="hljs-string">'readonly'</span>)<span class="hljs-comment">;</span>
Â Â Â Â Â Â constÂ <span class="hljs-attr">store</span>Â =Â transaction.objectStore(<span class="hljs-string">'state'</span>)<span class="hljs-comment">;</span>
Â Â Â Â Â Â constÂ <span class="hljs-attr">request</span>Â =Â store.get(key)<span class="hljs-comment">;</span>

Â Â Â Â Â Â <span class="hljs-attr">request.onsuccess</span>Â =Â ()Â =&gt;Â resolve(request.result?.value)<span class="hljs-comment">;</span>
Â Â Â Â Â Â <span class="hljs-attr">request.onerror</span>Â =Â ()Â =&gt;Â reject(request.error)<span class="hljs-comment">;</span>
Â Â Â Â })<span class="hljs-comment">;</span>
Â Â }
}

//Â ReactÂ Hookå°è£…
functionÂ useIndexedDB(key,Â initialValue)Â {
Â Â constÂ <span class="hljs-section">[value,Â setValue]</span>Â =Â useState(initialValue)<span class="hljs-comment">;</span>
Â Â constÂ <span class="hljs-section">[db,Â setDb]</span>Â =Â useState(null)<span class="hljs-comment">;</span>

Â Â useEffect(()Â =&gt;Â {
Â Â Â Â constÂ <span class="hljs-attr">initDB</span>Â =Â asyncÂ ()Â =&gt;Â {
Â Â Â Â Â Â constÂ <span class="hljs-attr">dbService</span>Â =Â newÂ IndexedDBService(<span class="hljs-string">'AppDB'</span>,Â <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
Â Â Â Â Â Â awaitÂ dbService.open()<span class="hljs-comment">;</span>
Â Â Â Â Â Â setDb(dbService)<span class="hljs-comment">;</span>
Â Â Â Â Â Â 
Â Â Â Â Â Â constÂ <span class="hljs-attr">stored</span>Â =Â awaitÂ dbService.get(key)<span class="hljs-comment">;</span>
Â Â Â Â Â Â ifÂ (stored)Â setValue(stored)<span class="hljs-comment">;</span>
Â Â Â Â }<span class="hljs-comment">;</span>
Â Â Â Â 
Â Â Â Â initDB()<span class="hljs-comment">;</span>
Â Â },Â <span class="hljs-section">[key]</span>)<span class="hljs-comment">;</span>

Â Â constÂ <span class="hljs-attr">updateValue</span>Â =Â asyncÂ (newValue)Â =&gt;Â {
Â Â Â Â setValue(newValue)<span class="hljs-comment">;</span>
Â Â Â Â ifÂ (db)Â awaitÂ db.set(key,Â newValue)<span class="hljs-comment">;</span>
Â Â }<span class="hljs-comment">;</span>

Â Â returnÂ <span class="hljs-section">[value,Â updateValue]</span><span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-6">äº”ã€æ–¹æ¡ˆå››ï¼šURLå‚æ•°ï¼ˆåˆ†äº«å‹å¥½å‹ï¼‰</h2>
<p>é€‚åˆç­›é€‰æ¡ä»¶ç­‰éœ€è¦åˆ†äº«çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">importÂ {Â useHistory,Â useLocationÂ }Â fromÂ 'react-router-dom'<span class="hljs-comment">;</span>

functionÂ useURLState(key,Â initialValue)Â {
Â Â constÂ <span class="hljs-attr">location</span>Â =Â useLocation()<span class="hljs-comment">;</span>
Â Â constÂ <span class="hljs-attr">history</span>Â =Â useHistory()<span class="hljs-comment">;</span>
Â Â 
Â Â constÂ <span class="hljs-attr">queryParams</span>Â =Â newÂ URLSearchParams(location.search)<span class="hljs-comment">;</span>
Â Â 
Â Â constÂ <span class="hljs-section">[value,Â setValue]</span>Â =Â useState(()Â =&gt;Â {
Â Â Â Â constÂ <span class="hljs-attr">param</span>Â =Â queryParams.get(key)<span class="hljs-comment">;</span>
Â Â Â Â returnÂ paramÂ ?Â JSON.parse(decodeURIComponent(param))Â :Â initialValue<span class="hljs-comment">;</span>
Â Â })<span class="hljs-comment">;</span>

Â Â constÂ <span class="hljs-attr">setURLValue</span>Â =Â (newValue)Â =&gt;Â {
Â Â Â Â setValue(newValue)<span class="hljs-comment">;</span>
Â Â Â Â 
Â Â Â Â //Â æ›´æ–°URLå‚æ•°
Â Â Â Â constÂ <span class="hljs-attr">newParams</span>Â =Â newÂ URLSearchParams(location.search)<span class="hljs-comment">;</span>
Â Â Â Â newParams.set(key,Â encodeURIComponent(JSON.stringify(newValue)))<span class="hljs-comment">;</span>
Â Â Â Â 
Â Â Â Â history.replace({
Â Â Â Â Â Â pathname:Â location.pathname,
Â Â Â Â Â Â search:Â newParams.toString()
Â Â Â Â })<span class="hljs-comment">;</span>
Â Â }<span class="hljs-comment">;</span>

Â Â returnÂ <span class="hljs-section">[value,Â setURLValue]</span><span class="hljs-comment">;</span>
}

//Â ä½¿ç”¨ï¼šURLä¼šæ˜¾ç¤ºÂ ?<span class="hljs-attr">filters</span>=%<span class="hljs-number">7</span>B%<span class="hljs-number">22</span>status%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>active%<span class="hljs-number">22</span>%<span class="hljs-number">7</span>D
functionÂ FilterComponent()Â {
Â Â constÂ <span class="hljs-section">[filters,Â setFilters]</span>Â =Â useURLState('filters',Â {Â status:Â 'all'Â })<span class="hljs-comment">;</span>
Â Â 
Â Â //Â åˆ†äº«å½“å‰URLï¼Œåˆ«äººæ‰“å¼€èƒ½çœ‹åˆ°åŒæ ·çš„ç­›é€‰ç»“æœ
}
</code></pre>
<h2 data-id="heading-7">å…­ã€æ–¹æ¡ˆäº”ï¼šRedux + æŒä¹…åŒ–ä¸­é—´ä»¶</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â store/persistConfig.js</span>
<span class="hljs-keyword">const</span>Â persistConfigÂ =Â {
Â Â <span class="hljs-attr">key</span>:Â <span class="hljs-string">'root'</span>,
Â Â storage,Â <span class="hljs-comment">//Â å¯ä»¥æ˜¯localStorageã€sessionStorageç­‰</span>
Â Â <span class="hljs-attr">whitelist</span>:Â [<span class="hljs-string">'auth'</span>,Â <span class="hljs-string">'userPreferences'</span>],Â <span class="hljs-comment">//Â åªæŒä¹…åŒ–è¿™äº›reducer</span>
Â Â <span class="hljs-attr">blacklist</span>:Â [<span class="hljs-string">'temporaryData'</span>],Â <span class="hljs-comment">//Â ä¸æŒä¹…åŒ–è¿™äº›</span>
Â Â <span class="hljs-attr">transforms</span>:Â [
Â Â Â Â <span class="hljs-comment">//Â æ•°æ®è½¬æ¢ï¼ˆå¦‚åŠ å¯†ï¼‰</span>
Â Â Â Â <span class="hljs-title function_">encryptTransform</span>({
Â Â Â Â Â Â <span class="hljs-attr">secretKey</span>:Â process.<span class="hljs-property">env</span>.<span class="hljs-property">REACT_APP_ENCRYPT_KEY</span>
Â Â Â Â })
Â Â ]
};

<span class="hljs-comment">//Â store/index.js</span>
<span class="hljs-keyword">import</span>Â {Â createStoreÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span>Â {Â persistStore,Â persistReducerÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'redux-persist'</span>;
<span class="hljs-keyword">import</span>Â storageÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'redux-persist/lib/storage'</span>;

<span class="hljs-keyword">const</span>Â persistedReducerÂ =Â <span class="hljs-title function_">persistReducer</span>(persistConfig,Â rootReducer);

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â storeÂ =Â <span class="hljs-title function_">createStore</span>(persistedReducer);
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â persistorÂ =Â <span class="hljs-title function_">persistStore</span>(store);

<span class="hljs-comment">//Â App.js</span>
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">PersistGate</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'redux-persist/integration/react'</span>;

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">App</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">return</span>Â (
Â Â Â Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span>Â <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">PersistGate</span>Â <span class="hljs-attr">loading</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingSpinner</span>Â /&gt;</span>}Â persistor={persistor}&gt;
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">MainApp</span>Â /&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">PersistGate</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>
Â Â );
}
</code></pre>
<h2 data-id="heading-8">ä¸ƒã€æ•°æ®æŒä¹…åŒ–æµç¨‹å›¾</h2>
<pre><code class="hljs">å°é‡ç®€å•æ•°æ®

æ ‡ç­¾é¡µéš”ç¦»æ•°æ®

å¤§é‡ç»“æ„åŒ–æ•°æ®

å¯åˆ†äº«çŠ¶æ€

å…¨å±€çŠ¶æ€ç®¡ç†

é¡µé¢åˆ·æ–°æ•°æ®æ¢å¤å†³ç­–localStoragesessionStorageIndexedDBURLå‚æ•°ReduxæŒä¹…åŒ–å¿«é€Ÿè¯»å–
5-10MBé™åˆ¶ä¼šè¯çº§å­˜å‚¨
æ ‡ç­¾é¡µç‹¬ç«‹å¤§å®¹é‡å­˜å‚¨
å¼‚æ­¥æ“ä½œå¯åˆ†äº«çŠ¶æ€
URLå¯è§é›†æˆRedux
çŠ¶æ€åŒæ­¥æ•°æ®æ¢å¤å®Œæˆ
</code></pre>
<h2 data-id="heading-9">å…«ã€æ€§èƒ½ä¸å®‰å…¨æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-10">1. é˜²æŠ–ä¿å­˜é¿å…é¢‘ç¹å†™å…¥</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">useDebouncedPersist</span>(<span class="hljs-params">key,Â value,Â delayÂ =Â <span class="hljs-number">1000</span></span>)Â {
Â Â <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â timerÂ =Â <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));
Â Â Â Â },Â delay);
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-built_in">clearTimeout</span>(timer);
Â Â },Â [key,Â value,Â delay]);
}
</code></pre>
<h3 data-id="heading-11">2. æ•°æ®å‹ç¼©ï¼ˆå¤§æ•°æ®é‡æ—¶ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â compress,Â decompressÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'lz-string'</span>;

<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">compressData</span>Â =Â (<span class="hljs-params">data</span>)Â =&gt;Â {
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">compress</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
};

<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">decompressData</span>Â =Â (<span class="hljs-params">compressed</span>)Â =&gt;Â {
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title function_">decompress</span>(compressed));
};
</code></pre>
<h3 data-id="heading-12">3. å®‰å…¨å­˜å‚¨æ•æ„Ÿä¿¡æ¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â æ°¸è¿œä¸è¦è¿™æ ·åšï¼</span>
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>,Â rawToken);

<span class="hljs-comment">//Â åº”è¯¥ï¼šä½¿ç”¨HttpOnlyÂ Cookieæˆ–ä¸´æ—¶å†…å­˜å­˜å‚¨</span>
</code></pre>
<h2 data-id="heading-13">ä¹ã€æ–¹æ¡ˆå¯¹æ¯”é€‰æ‹©æŒ‡å—</h2>















































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å®¹é‡</th><th>ç”Ÿå‘½å‘¨æœŸ</th><th>ä½¿ç”¨åœºæ™¯</th><th>ä¼˜ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>localStorage</strong></td><td>5-10MB</td><td>æ°¸ä¹…</td><td>ç”¨æˆ·åå¥½è®¾ç½®</td><td>ç®€å•æ˜“ç”¨ï¼Œä½†åŒæ­¥é˜»å¡</td></tr><tr><td><strong>sessionStorage</strong></td><td>5-10MB</td><td>æ ‡ç­¾é¡µ</td><td>ä¸´æ—¶è¡¨å•æ•°æ®</td><td>æ ‡ç­¾é¡µéš”ç¦»ï¼Œå…³é—­å³å¤±</td></tr><tr><td><strong>IndexedDB</strong></td><td>å¤§é‡</td><td>æ°¸ä¹…</td><td>ç¦»çº¿åº”ç”¨æ•°æ®</td><td>å¼‚æ­¥å¤§å®¹é‡ï¼ŒAPIå¤æ‚</td></tr><tr><td><strong>URLå‚æ•°</strong></td><td>å—é™</td><td>é¡µé¢çº§åˆ«</td><td>ç­›é€‰æ¡ä»¶åˆ†äº«</td><td>å¯åˆ†äº«ï¼Œä½†æœ‰é•¿åº¦é™åˆ¶</td></tr><tr><td><strong>ReduxæŒä¹…åŒ–</strong></td><td>çµæ´»</td><td>å¯é…ç½®</td><td>å…¨å±€çŠ¶æ€ç®¡ç†</td><td>é›†æˆåº¦é«˜ï¼Œéœ€é¢å¤–é…ç½®</td></tr></tbody></table>
<h2 data-id="heading-14">åã€å®æˆ˜ï¼šå®Œæ•´è¡¨å•æŒä¹…åŒ–ç¤ºä¾‹</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">PersistentForm</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-comment">//Â ç»¼åˆä½¿ç”¨å¤šç§æ–¹æ¡ˆ</span>
Â Â <span class="hljs-keyword">const</span>Â [basicInfo,Â setBasicInfo]Â =Â <span class="hljs-title function_">useLocalStorage</span>(<span class="hljs-string">'form_basic'</span>,Â {});
Â Â <span class="hljs-keyword">const</span>Â [tempData,Â setTempData]Â =Â <span class="hljs-title function_">useSessionStorage</span>(<span class="hljs-string">'form_temp'</span>,Â {});
Â Â <span class="hljs-keyword">const</span>Â [filters,Â setFilters]Â =Â <span class="hljs-title function_">useURLState</span>(<span class="hljs-string">'form_filters'</span>,Â {});
Â Â 
Â Â <span class="hljs-comment">//Â è‡ªåŠ¨ä¿å­˜è‰ç¨¿</span>
Â Â <span class="hljs-title function_">useDebouncedPersist</span>(<span class="hljs-string">'form_draft'</span>,Â {
Â Â Â Â basicInfo,
Â Â Â Â tempData
Â Â },Â <span class="hljs-number">2000</span>);
Â Â 
Â Â <span class="hljs-comment">//Â ç¦»å¼€é¡µé¢æç¤º</span>
Â Â <span class="hljs-title function_">useBeforeUnload</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (hasUnsavedChanges)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">'æ‚¨æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ'</span>;
Â Â Â Â }
Â Â });
Â Â 
Â Â <span class="hljs-keyword">return</span>Â (
Â Â Â Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â {/*Â è¡¨å•å†…å®¹Â */}
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearAllStorage}</span>&gt;</span>
Â Â Â Â Â Â Â Â æ¸…ç©ºæ‰€æœ‰æŒä¹…åŒ–æ•°æ®
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
Â Â );
}
</code></pre>
<h2 data-id="heading-15">æ€»ç»“</h2>
<p>Reactæ•°æ®æŒä¹…åŒ–æ²¡æœ‰é“¶å¼¹ï¼Œ<strong>å…³é”®åœ¨äºæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>1.Â <strong>ç”¨æˆ·è®¾ç½®</strong>Â â†’ localStorage</li>
<li>2.Â <strong>ä¸´æ—¶è¡¨å•</strong>Â â†’ sessionStorage</li>
<li>3.Â <strong>ç¦»çº¿æ•°æ®</strong>Â â†’ IndexedDB</li>
<li>4.Â <strong>åˆ†äº«çŠ¶æ€</strong>Â â†’ URLå‚æ•°</li>
<li>5.Â <strong>å…¨å±€çŠ¶æ€</strong>Â â†’ ReduxæŒä¹…åŒ–</li>
</ol>
<p>è®°ä½ä¸€ä¸ªåŸåˆ™ï¼š<strong>æ•æ„Ÿä¿¡æ¯æ°¸è¿œä¸è¦åœ¨å‰ç«¯æŒä¹…åŒ–</strong>ï¼tokenã€å¯†ç ç­‰åº”è¯¥é€šè¿‡HttpOnly Cookieæˆ–åç«¯sessionç®¡ç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ªçœ‹ä¼¼â€œé€åˆ†â€çš„éœ€æ±‚ä¸ºä½•ç¿»è½¦ï¼Ÿâ€”â€”å‰ç«¯çŠ¶æ€æœºå®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7584071941025497103</link>    <guid>https://juejin.cn/post/7584071941025497103</guid>    <pubDate>2025-12-16T10:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584071941025497103" data-draft-id="7583799807594201122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ªçœ‹ä¼¼â€œé€åˆ†â€çš„éœ€æ±‚ä¸ºä½•ç¿»è½¦ï¼Ÿâ€”â€”å‰ç«¯çŠ¶æ€æœºå®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-16T10:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¸€å°å’"/> <meta itemprop="url" content="https://juejin.cn/user/1943592286564045"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ªçœ‹ä¼¼â€œé€åˆ†â€çš„éœ€æ±‚ä¸ºä½•ç¿»è½¦ï¼Ÿâ€”â€”å‰ç«¯çŠ¶æ€æœºå®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592286564045/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¸€å°å’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T10:55:02.000Z" title="Tue Dec 16 2025 10:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æºç å¤ªæ¯ç‡¥ï¼Ÿä¸€ä¸ªäººå•ƒä¸åŠ¨ï¼Ÿå…³æ³¨å…¬ä¼—å·-ã€Œå‰ç«¯å°å’ã€ï¼Œè®©æˆ‘åšä½ çš„æºç é¢†è¯»äººã€‚è¿™é‡Œæ²¡æœ‰æ™¦æ¶©çš„è¯´æ•™ï¼Œåªæœ‰æ¸…æ™°çš„Â <strong>Vue 3 &amp; React 19</strong>Â æºç æ‹†è§£ã€‚ç§¯è·¬æ­¥ä»¥è‡³åƒé‡Œï¼Œ<strong>å°å’ä¹Ÿèƒ½è¿›é˜¶ä¸ºå¤§å°†</strong>ï¼Œæˆ‘ä»¬ä¸€èµ·è¿‡æ²³ï¼â™Ÿï¸</p>
</blockquote>
<p>æ•…äº‹çš„å¼€å§‹æ€»æ˜¯æƒŠäººçš„ç›¸ä¼¼ã€‚</p>
<p>ä¸Šä¸ªæœˆï¼Œéœ€æ±‚è¯„å®¡ä¼šä¸Šï¼Œæ”¶åˆ°äº†äº§å“ç»ç†çš„ä¸€ä¸ªéœ€æ±‚ï¼šâ€œåšä¸€ä¸ªæ‰«ç æ”¯ä»˜å¼¹çª—ã€‚é€»è¾‘å¾ˆç®€å•ï¼šæ‰“å¼€å¼¹çª—è·å–äºŒç»´ç ï¼Œç„¶åæ¯éš” 2 ç§’è½®è¯¢ä¸€æ¬¡æ¥å£ï¼Œæ‰«ç æˆåŠŸå°±è·³è½¬ï¼Œ30 ç§’è¶…æ—¶å°±è®©ç”¨æˆ·åˆ·æ–°â€</p>
<p>ä¸€æ‹è„‘è¢‹ï¼Œå‡­ç»éªŒåˆ¤æ–­ï¼Œéœ€æ±‚ä¸éš¾ã€‚ä½œä¸ºä¸€åç†Ÿç»ƒçš„â€œReactå·¥ç¨‹å¸ˆâ€ï¼Œæˆ‘æå…¶è‡ªä¿¡åœ°æ•²ä¸‹ä»£ç ï¼Œå¼€å§‹å†™éœ€æ±‚ä»£ç ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [isLoading, setIsLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// åŠ è½½äºŒç»´ç ä¸­</span>
<span class="hljs-keyword">const</span> [isPolling, setIsPolling] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// è½®è¯¢æ¥å£ä¸­</span>
<span class="hljs-keyword">const</span> [isError, setIsError] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);     <span class="hljs-comment">// å‡ºé”™äº†</span>
<span class="hljs-keyword">const</span> [retryCount, setRetryCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);   <span class="hljs-comment">// é‡è¯•æ¬¡æ•°</span>
<span class="hljs-comment">// ...åé¢è¿˜æœ‰ä¸€å † useEffect å’Œ useRef ç”¨æ¥å­˜å®šæ—¶å™¨ID</span>
</code></pre>
<p>å½“æ—¶çš„æˆ‘è¿˜æœªæ„è¯†åˆ°ï¼Œè¿™å‡ ä¸ªstateç»™æˆ‘å¸¦æ¥äº†å¥½å‡ ä¸ªbugå•ã€‚</p>
<h2 data-id="heading-0">éšå½¢çš„â€œçŠ¶æ€çˆ†ç‚¸â€</h2>
<p>æ­£å¼ææµ‹ä¹‹åï¼Œæˆ‘å°±é™†é™†ç»­ç»­æ”¶åˆ°äº†å¥½å‡ ä¸ªbugå•ã€‚</p>
<p>â€œå¤§ä½¬ï¼Œæˆ‘å°±åœ¨ç½‘ç»œå¡é¡¿çš„æ—¶å€™å¤šç‚¹äº†å‡ ä¸‹â€˜åˆ·æ–°â€™ï¼Œé¡µé¢å°±ä¹±äº†â€</p>
<p>æµè§ˆå™¨çš„Network é¢æ¿ä¸Šï¼Œå‡ åä¸ªè½®è¯¢è¯·æ±‚åœ¨å¹¶å‘æ‰§è¡Œã€‚UI ç•Œé¢ä¸Šï¼Œâ€œæ­£åœ¨åŠ è½½â€çš„è½¬åœˆåŠ¨ç”»å’Œâ€œç½‘ç»œé”™è¯¯â€çš„çº¢å­—æç¤ºç«Ÿç„¶åŒæ—¶å­˜åœ¨ï¼Œç”šè‡³è¿˜èƒ½ç‚¹å‡»â€œé‡è¯•â€æŒ‰é’®ï¼ï¼ï¼</p>
<p>æŒ‰ç…§æˆ‘çš„é€»è¾‘ï¼Œ<code>isLoading</code> ä¸º <code>true</code> æ—¶ï¼Œ<code>isError</code> è‚¯å®šå¾—æ˜¯ <code>false</code> å•Šã€‚æˆ‘æ˜æ˜å†™äº† <code>setLoading(true); setError(false)</code>ï¼Œä¸ºå•¥ä¼šå‡ºç°è¿™ç§é—®é¢˜ï¼</p>
<p><strong>ä¸ºä»€ä¹ˆä¼šå¤±æ§ï¼Ÿ</strong></p>
<p>é—®é¢˜çš„æ ¹æºå°±åœ¨äºè¯•å›¾ç”¨çº¿æ€§çš„é€»è¾‘ï¼Œå»å¯¹æŠ—éçº¿æ€§çš„ç°å®ã€‚</p>
<p>å½“ <code>isLoading</code>ã€<code>isPolling</code>ã€<code>isError</code> ä¸‰ä¸ªå¸ƒå°”å€¼æ··åœ¨ä¸€èµ·æ—¶ï¼Œç†è®ºä¸Šå®ƒä»¬èƒ½ç»„åˆå‡º 2^3=8 ç§çŠ¶æ€ã€‚è€Œåœ¨çœŸå®çš„ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œåˆæ³•çš„çŠ¶æ€å¯èƒ½åªæœ‰ 3 ç§ï¼ˆåŠ è½½ä¸­ã€è½®è¯¢ä¸­ã€å¤±è´¥ï¼‰ã€‚é‚£ä¹ˆ<strong>å‰©ä¸‹çš„é‚£ 5 ç§â€œä¸å¯èƒ½å­˜åœ¨çš„çŠ¶æ€â€ï¼Œä¸€ä¸å°å¿ƒæ²¡å¤„ç†å°±ä¼šå­˜åœ¨å¤§é‡çš„ç¼ºé™·ã€‚</strong></p>
<p>æˆ‘ä»¬èŠ±è´¹ 80% çš„æ—¶é—´ï¼Œä¸æ˜¯åœ¨å†™ä¸šåŠ¡ï¼Œè€Œæ˜¯åœ¨å†™é˜²å¾¡ä»£ç ï¼Œå»å µé‚£äº›å› ä¸ºé€»è¾‘æ¼æ´è€Œäº§ç”Ÿçš„æ··æ²ŒçŠ¶æ€ã€‚</p>
<p>é¢å¯¹é‚£å¨è†¨èƒ€ä¸”è„†å¼±çš„ä»£ç ï¼Œå†è¿›è¡Œä¿®ä¿®è¡¥è¡¥å·²ç»æ— æµäºäº‹ï¼Œå¿…é¡»è¦å¤§åˆ€é˜”æ–§å¼çš„æ¨å€’é‡æ¥ï¼Œå’ŒPMå’Œè¿è¥æ²Ÿé€šï¼Œéœ€æ±‚è¿›è¡Œå»¶æœŸï¼Œä»£ç æ‰“å›å»é‡å†™ã€‚</p>
<p>è§£å†³æ­¤ç±»é—®é¢˜çš„æœ€ä½³æ–¹æ¡ˆï¼Œä¸æ˜¯æ›´é«˜è¶…çš„ <code>if-else</code> æŠ€å·§ï¼Œè€Œæ˜¯ä¸€ä¸ªç»å…¸çš„æ•°å­¦æ¨¡å‹â€”â€”<strong>æœ‰é™çŠ¶æ€æœº</strong> ã€‚å®ƒçš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š<strong>ç³»ç»Ÿåœ¨ä»»ä½•æ—¶åˆ»åªèƒ½å¤„äºä¸€ç§çŠ¶æ€ï¼Œä¸”çŠ¶æ€çš„æµè½¬æ˜¯ç¡®å®šçš„ã€‚</strong></p>
<h2 data-id="heading-1">å¼•å…¥æœ‰é™çŠ¶æ€æœº (FSM)</h2>
<h3 data-id="heading-2">ç»˜åˆ¶çŠ¶æ€æµè½¬å›¾</h3>
<p>åœ¨å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘å…ˆç”»äº†ä¸€å¼ å›¾ã€‚è¿™æ‰æ˜¯é€»è¾‘çš„æ ¸å¿ƒï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1a5e676a636492fa064b0e5d1417ea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LiA5bCP5Y2S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487301&amp;x-signature=bhvOGCRnUe0UJ6YFfe0nvs14GVQ%3D" alt="svgviewer-png-output (52).png" loading="lazy"/></p>
<p>æµç¨‹å›¾æ¸…æ™°çš„å±•ç¤ºå‡ºæ¥ï¼š</p>
<ul>
<li>åªæœ‰åœ¨ <code>FAILURE</code> æˆ– <code>IDLE</code> çŠ¶æ€ä¸‹ï¼Œæ‰å…è®¸å‘èµ· <code>FETCH</code>ã€‚</li>
<li>åœ¨ <code>LOADING</code> çŠ¶æ€ä¸‹ï¼Œæ— è®ºç”¨æˆ·æ€ä¹ˆç‚¹å‡»ï¼Œéƒ½ä¸ä¼šè§¦å‘å¤šä½™çš„è¯·æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-3">å¼•å…¥useReducer</h3>
<p>React çš„ <code>useReducer</code> æ˜¯å®ç°çŠ¶æ€æœºçš„ç»ä½³å·¥å…·ï¼Œé€šè¿‡å®ƒå¯ä»¥å°†çŠ¶æ€ç®¡ç†æ”¶æ•›åˆ°ä¸€ä¸ªçº¯å‡½æ•°ä¸­ã€‚</p>
<p><strong>å®šä¹‰çŠ¶æ€ä¸äº‹ä»¶</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// çŠ¶æ€æšä¸¾ï¼Œåªæœ‰è¿™äº”ç§çŠ¶æ€</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STATES</span> = {
  <span class="hljs-attr">IDLE</span>: <span class="hljs-string">'idle'</span>,
  <span class="hljs-attr">LOADING</span>: <span class="hljs-string">'loading'</span>,
  <span class="hljs-attr">POLLING</span>: <span class="hljs-string">'polling'</span>,
  <span class="hljs-attr">SUCCESS</span>: <span class="hljs-string">'success'</span>,
  <span class="hljs-attr">FAILURE</span>: <span class="hljs-string">'failure'</span>,
};

<span class="hljs-comment">// äº‹ä»¶æšä¸¾ï¼šç”¨æˆ·æˆ–ç³»ç»Ÿèƒ½åšçš„åŠ¨ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EVENTS</span> = {
  <span class="hljs-attr">FETCH</span>: <span class="hljs-string">'FETCH'</span>,      <span class="hljs-comment">// è§¦å‘è·å–</span>
  <span class="hljs-attr">RESOLVE</span>: <span class="hljs-string">'RESOLVE'</span>,  <span class="hljs-comment">// æˆåŠŸæ‹¿åˆ°äºŒç»´ç </span>
  <span class="hljs-attr">REJECT</span>: <span class="hljs-string">'REJECT'</span>,    <span class="hljs-comment">// å¤±è´¥</span>
  <span class="hljs-attr">DONE</span>: <span class="hljs-string">'DONE'</span>,        <span class="hljs-comment">// æ”¯ä»˜å®Œæˆ</span>
  <span class="hljs-attr">TIMEOUT</span>: <span class="hljs-string">'TIMEOUT'</span>,  <span class="hljs-comment">// è¶…æ—¶</span>
};
</code></pre>
<p><strong>ç¼–å†™ Reducer</strong></p>
<p>è¿™é‡Œä½¿ç”¨åŒé‡ Switch ç»“æ„ï¼šå…ˆåˆ¤æ–­<strong>å½“å‰å¤„äºä»€ä¹ˆçŠ¶æ€</strong>ï¼Œå†åˆ¤æ–­<strong>å‘ç”Ÿäº†ä»€ä¹ˆäº‹ä»¶</strong>ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> machineReducer = (state, event) =&gt; {
  <span class="hljs-keyword">switch</span> (state.status) {
    <span class="hljs-keyword">case</span> STATES.IDLE:
    <span class="hljs-keyword">case</span> STATES.FAILURE:
      <span class="hljs-comment">// åªæœ‰åœ¨ç©ºé—²æˆ–å¤±è´¥æ—¶ï¼Œæ‰å…è®¸å‘èµ· FETCH</span>
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.FETCH) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.LOADING, <span class="hljs-type">error</span>: null };
      }
      <span class="hljs-keyword">return</span> state; <span class="hljs-comment">// å…¶ä»–äº‹ä»¶ç›´æ¥å¿½ç•¥ï¼</span>

    <span class="hljs-keyword">case</span> STATES.LOADING:
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.RESOLVE) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.POLLING, qrCode: event.data };
      }
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.REJECT) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.FAILURE, <span class="hljs-type">error</span>: event.<span class="hljs-type">error</span> };
      }
      <span class="hljs-comment">// ğŸ”¥ é‡ç‚¹ï¼šè¿™é‡Œæ²¡æœ‰å¤„ç† 'FETCH' äº‹ä»¶ã€‚</span>
      <span class="hljs-comment">// è¿™æ„å‘³ç€ï¼šåœ¨ Loading çŠ¶æ€ä¸‹ï¼Œæ— è®ºç”¨æˆ·æ€ä¹ˆç‹‚ç‚¹æŒ‰é’®ï¼Œä»£ç éƒ½ä¸ä¼šæœ‰ä»»ä½•ååº”ï¼</span>
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">case</span> STATES.POLLING:
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.DONE) <span class="hljs-keyword">return</span> { ...state, status: STATES.SUCCESS };
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.TIMEOUT) <span class="hljs-keyword">return</span> { ...state, status: STATES.FAILURE, <span class="hljs-type">error</span>: <span class="hljs-string">'è¶…æ—¶'</span> };
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
};
</code></pre>
<p><strong>ç»„ä»¶å±‚è°ƒç”¨ï¼ˆåˆ†ç¦»å‰¯ä½œç”¨ï¼‰</strong></p>
<p>ç°åœ¨ï¼Œç»„ä»¶å±‚çš„ä»£ç å˜å¾—å¼‚å¸¸æ¸…çˆ½ã€‚æˆ‘ä»¬åªéœ€è¦æ ¹æ®çŠ¶æ€å»æ¸²æŸ“ UIï¼Œå¹¶åˆ©ç”¨ <code>useEffect</code> å¤„ç†è½®è¯¢å‰¯ä½œç”¨ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">PaymentModal</span> = () =&gt; {
  const <span class="hljs-section">[state, dispatch]</span> = useReducer(machineReducer, { status: STATES.IDLE })<span class="hljs-comment">;</span>

  // ä¸šåŠ¡åŠ¨ä½œï¼šåªè´Ÿè´£æ´¾å‘æ„å›¾ï¼Œä¸è´Ÿè´£åˆ¤æ–­é€»è¾‘
  const <span class="hljs-attr">handleFetch</span> = () =&gt; {
    dispatch({ type: EVENTS.FETCH })<span class="hljs-comment">;</span>
    api.getQrCode()
      .then(<span class="hljs-attr">data</span> =&gt; dispatch({ type: EVENTS.RESOLVE, data }))
      .catch(<span class="hljs-attr">err</span> =&gt; dispatch({ type: EVENTS.REJECT, error: err }))<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  // å‰¯ä½œç”¨ç®¡ç†ï¼šç”±çŠ¶æ€é©±åŠ¨è½®è¯¢
  useEffect(() =&gt; {
    let <span class="hljs-attr">timer</span> = null<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">state.status</span> === STATES.POLLING) {
      <span class="hljs-attr">timer</span> = setInterval(async () =&gt; {
        const <span class="hljs-attr">res</span> = await api.checkStatus()<span class="hljs-comment">;</span>
        if (res.success) dispatch({ type: EVENTS.DONE })<span class="hljs-comment">;</span>
      }, 2000)<span class="hljs-comment">;</span>
    }
    return () =&gt; clearInterval(timer)<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[state.status]</span>)<span class="hljs-comment">; // çŠ¶æ€å˜äº†ï¼Œå‰¯ä½œç”¨è‡ªåŠ¨æ¸…ç†æˆ–é‡å¯</span>

  return (
    &lt;div&gt;
      {<span class="hljs-attr">state.status</span> === STATES.LOADING &amp;&amp; &lt;Spinner /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.POLLING &amp;&amp; &lt;QRCode img={state.qrCode} /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.FAILURE &amp;&amp; &lt;ErrorView <span class="hljs-literal">on</span>Retry={handleFetch} /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.SUCCESS &amp;&amp; &lt;SuccessView /&gt;}
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>çœ‹æ‡‚äº†å—ï¼Ÿæˆ‘ä»¬ä¸å†ä¿®è¡¥æ¼æ´ï¼Œé€šè¿‡æ¸…æ™°çš„å®šä¹‰çŠ¶æ€å’Œè§¦å‘äº‹ä»¶ï¼Œæ”¶æ•›ä¸šåŠ¡ä»£ç å¤æ‚åº¦ï¼Œæ¶ˆé™¤å¯èƒ½äº§ç”Ÿçš„bugã€‚</p>
<hr/>
<h2 data-id="heading-4">æ·±åº¦è§£æçŠ¶æ€æœº</h2>
<p>å†™åˆ°è¿™é‡Œï¼Œå¯èƒ½å¾ˆå¤šåŒå­¦ä¼šé—®ï¼š <strong>â€œè¿™ä¸å°±æ˜¯ Switch-Case å—ï¼Ÿä¸ºä»€ä¹ˆè¦å«å®ƒçŠ¶æ€æœºï¼Ÿâ€</strong> æˆ‘ä»¬éœ€è¦æŠŠè§†è§’æ‹‰é«˜ï¼Œä»ç†è®ºå±‚é¢å½»åº•ç†è§£å®ƒï¼Œä»¥ä¾¿åº”å¯¹æ›´å¤æ‚çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-5">ä»€ä¹ˆæ˜¯æœ‰é™çŠ¶æ€æœº</h3>
<p>æœ‰é™çŠ¶æ€æœºä¸æ˜¯ä¸€ç§ä»£ç å†™æ³•ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°å­¦æ¨¡å‹ã€‚å®ƒç”±äº”ä¸ªè¦ç´ ç»„æˆï¼š</p>
<ul>
<li><strong>æœ‰é™çš„çŠ¶æ€</strong> ï¼šæ¯”å¦‚çº¢ç»¿ç¯åªæœ‰çº¢ã€é»„ã€ç»¿ï¼Œä¸å¯èƒ½å‡ºç°â€œçº¢ç»¿â€ã€‚</li>
<li><strong>æœ‰é™çš„äº‹ä»¶</strong> ï¼šæ¯”å¦‚â€œå€’è®¡æ—¶ç»“æŸâ€ã€â€œæŒ‰ä¸‹æŒ‰é’®â€ã€‚</li>
<li><strong>è½¬æ¢è§„åˆ™</strong> ï¼šå³ <code>çŠ¶æ€ A + äº‹ä»¶ B -&gt; çŠ¶æ€ C</code>ã€‚</li>
<li><strong>åˆå§‹çŠ¶æ€</strong> ã€‚</li>
<li><strong>æœ€ç»ˆçŠ¶æ€</strong> ã€‚</li>
</ul>
<p>å®ƒçš„æ ¸å¿ƒç†å¿µå°±æ˜¯ï¼š<strong>ç³»ç»Ÿåœ¨ä»»ä½•æ—¶åˆ»åªèƒ½å¤„äºä¸€ç§çŠ¶æ€ï¼Œä¸”çŠ¶æ€çš„æµè½¬æ˜¯ç¡®å®šçš„ã€‚</strong></p>
<h3 data-id="heading-6">ä¸ºä»€ä¹ˆå‰ç«¯éœ€è¦å®ƒ</h3>
<p>å‰ç«¯æ—©å·²ä¸æ˜¯â€œå±•ç¤ºé¡µé¢â€é‚£ä¹ˆç®€å•äº†ï¼Œæˆ‘ä»¬æ˜¯åœ¨æµè§ˆå™¨é‡Œè·‘ APPã€‚ä»¥ä¸‹åœºæ™¯å¦‚æœä¸ä»¥çŠ¶æ€æœºæ€ç»´å»å†™ï¼Œè¿Ÿæ—©ä¼šå´©ï¼š</p>
<ul>
<li><strong>å¤šåª’ä½“æ’­æ”¾å™¨</strong>ï¼š ä½ ä»¥ä¸ºåªæœ‰ <code>Play</code> å’Œ <code>Pause</code>ï¼Ÿé”™ã€‚ è¿˜æœ‰ <code>Buffering</code>ï¼ˆç¼“å†²ä¸­ï¼‰ã€<code>Seeking</code>ï¼ˆæ‹–æ‹½è¿›åº¦æ¡ä¸­ï¼‰ã€<code>Ended</code>ï¼ˆæ’­æ”¾ç»“æŸï¼‰ã€<code>Error</code>ï¼ˆåŠ è½½å¤±è´¥ï¼‰è¿™äº›åœºæ™¯ã€‚</li>
<li><strong>å¤æ‚çš„è¡¨å•å‘å¯¼</strong> ï¼š ç¬¬ä¸€æ­¥ -&gt; ç¬¬äºŒæ­¥ -&gt; ç¬¬ä¸‰æ­¥ã€‚ ç”¨æˆ·åœ¨ç¬¬äºŒæ­¥ç‚¹äº†â€œä¸Šä¸€æ­¥â€ï¼Œæ•°æ®æ€ä¹ˆå­˜ï¼Ÿåœ¨ç¬¬ä¸‰æ­¥æäº¤å¤±è´¥äº†ï¼Œé€€å›å“ªä¸€æ­¥ï¼Ÿ</li>
<li><strong>TCP/WebSocket è¿æ¥ç®¡ç†</strong>ï¼š <code>Connecting</code> -&gt; <code>Connected</code> -&gt; <code>Reconnecting</code> -&gt; <code>Disconnected</code>ã€‚ å¦‚æœåœ¨ <code>Reconnecting</code> æœŸé—´ç”¨æˆ·æ‰‹åŠ¨ç‚¹äº†â€œæ–­å¼€â€ï¼Œåº”è¯¥å»å“ªï¼Ÿ</li>
<li><strong>Canvas æ¸¸æˆ/äº¤äº’å¯è§†åŒ–</strong>ï¼š æ‹–æ‹½æ¨¡å¼ã€ç»˜å›¾æ¨¡å¼ã€é€‰ä¸­æ¨¡å¼ã€‚</li>
</ul>
<p>è¯»åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½å·²ç»çƒ­è¡€æ²¸è…¾ï¼Œå‡†å¤‡æŠŠé¡¹ç›®é‡Œçš„æ‰€æœ‰ç»„ä»¶éƒ½é‡å†™ä¸€éã€‚</p>
<p><strong>ä¸”æ…¢ã€‚</strong></p>
<p>è½¯ä»¶å·¥ç¨‹çš„æ ¸å¿ƒåœ¨äºæƒè¡¡ï¼Œå¦‚æœéœ€æ±‚ä»…ä»…æ˜¯æ§åˆ¶ä¸€ä¸ªæ¨¡æ€æ¡†çš„æ˜¾ç¤ºä¸éšè—ï¼Œå¼•å…¥çŠ¶æ€æœºåªä¼šå¢åŠ æ— è°“çš„ä»£ç å¤æ‚åº¦ã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨å®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä¾æ®å“ªäº›æ ‡å‡†æ¥åˆ¤å®šæ˜¯å¦éœ€è¦å¼•å…¥çŠ¶æ€æœºï¼Ÿå½“ä½ çš„ç»„ä»¶å‡ºç°ä»¥ä¸‹ä¸‰ç§ç‰¹å¾ä¹‹ä¸€æ—¶ï¼Œå°±å¯ä»¥ç»“åˆä¸šåŠ¡é€‚å½“çš„è€ƒè™‘é‡æ„äº†ã€‚</p>
<h3 data-id="heading-7">å­˜åœ¨å¤šä¸ªéœ€è¦â€œæ‰‹åŠ¨åŒæ­¥â€çš„booleanå˜é‡</h3>
<p>è¿™æ˜¯æœ€æ˜¾è‘—çš„ä¿¡å·ã€‚æ£€æŸ¥ä¸€ä¸‹ä½ çš„ç»„ä»¶ State å®šä¹‰ï¼Œå¦‚æœå‡ºç°äº†ä¸¤ä¸ªåŠä»¥ä¸Šçš„booleanï¼Œä¸”å½¼æ­¤ä¹‹é—´å­˜åœ¨é€»è¾‘å…³è”ï¼Œå°±éœ€è¦è­¦æƒ•ï¼Œ<strong>å½“ä½ éœ€è¦ç»´æŠ¤å¤šä¸ªå¸ƒå°”å€¼å˜é‡çš„åŒæ­¥å…³ç³»æ—¶ï¼ŒçŠ¶æ€æœºæ˜¯æ›´ä¼˜è§£</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// å…¸å‹çš„é«˜é£é™©ä»£ç </span>
const <span class="hljs-selector-attr">[isLoading, setLoading]</span> = <span class="hljs-built_in">useState</span>(false);
const <span class="hljs-selector-attr">[isError, setError]</span> = <span class="hljs-built_in">useState</span>(false);
const <span class="hljs-selector-attr">[hasData, setHasData]</span> = <span class="hljs-built_in">useState</span>(false);
</code></pre>
<p>åœ¨è¿™ç§ç»“æ„ä¸‹ï¼Œå¼€å‘è€…éœ€è¦æ—¶åˆ»è­¦æƒ•å˜é‡é—´çš„åŒæ­¥é—®é¢˜ã€‚æ¯”å¦‚åœ¨ <code>setLoading(true)</code> æ—¶ï¼Œå¿…é¡»è®°å¾—åŒæ—¶é‡ç½® <code>setError(false)</code>ã€‚è¿™ç§ä¾èµ–â€œäººä¸ºç»†å¿ƒâ€æ¥ç»´æŠ¤çš„ä»£ç ï¼Œéšç€è¿­ä»£å‘¨æœŸçš„æ‹‰é•¿ï¼Œå‡ ä¹å¿…ç„¶ä¼šäº§ç”Ÿ Bugã€‚</p>
<h3 data-id="heading-8">ä¸šåŠ¡é€»è¾‘è¦æ±‚çŠ¶æ€å¿…é¡»â€œäº’æ–¥â€</h3>
<p>åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¸šåŠ¡çŠ¶æ€åœ¨é€»è¾‘ä¸Šæ˜¯å®Œå…¨æ’ä»–çš„ã€‚</p>
<p>æ¯”å¦‚å¼€å¤´çš„â€œæ‰«ç è½®è¯¢â€åœºæ™¯ï¼šä¸€ä¸ªè¯·æ±‚ä¸å¯èƒ½æ—¢åœ¨â€œè¿›è¡Œä¸­â€åˆâ€œå·²å¤±è´¥â€ã€‚ç„¶è€Œï¼Œå¦‚æœä½¿ç”¨åˆ†æ•£çš„å¸ƒå°”å€¼æ§åˆ¶ï¼Œä»£ç å±‚é¢æ˜¯å…è®¸ <code>{ isLoading: true, isError: true }</code> è¿™ç§éæ³•ç»„åˆå­˜åœ¨çš„ã€‚</p>
<p>è¿™ç§é€»è¾‘ä¸Šçš„â€œæ’ä»–æ€§â€å¦‚æœä¸èƒ½åœ¨ä»£ç ç»“æ„ä¸Šå¾—åˆ°å¼ºåˆ¶ä¿è¯ï¼Œå°±ä¼šå¯¼è‡´ UI æ¸²æŸ“å‡ºé”™ï¼ˆä¾‹å¦‚ Loading åŠ¨ç”»å’Œé”™è¯¯æç¤ºé‡å æ˜¾ç¤ºï¼‰ã€‚æ‰€ä»¥å¦‚æœUIå±•ç¤ºä¾èµ–äºä¸¥æ ¼äº’æ–¥çš„çŠ¶æ€ï¼ˆå¦‚ Promise çš„ Pending/Resolved/Rejectedï¼‰ï¼Œè¯·å°½å¯èƒ½çš„ä½¿ç”¨çŠ¶æ€æœºå¼ºåˆ¶çº¦æŸã€‚</p>
<h3 data-id="heading-9">çŠ¶æ€æµè½¬è·¯å¾„æœ‰ä¸¥æ ¼é™åˆ¶</h3>
<p>ç®€å•çš„ä¸šåŠ¡çŠ¶æ€æµè½¬æ˜¯è‡ªç”±çš„ï¼Œè€Œå¤æ‚çš„ä¸šåŠ¡å¾€å¾€æ˜¯æœ‰å‘å›¾ã€‚</p>
<p>ä»¥â€œé€€æ¬¾æµç¨‹â€ä¸ºä¾‹ï¼š</p>
<ul>
<li>âœ… åˆæ³•è·¯å¾„ï¼š<code>ç”³è¯·ä¸­</code> -&gt; <code>å®¡æ ¸é€šè¿‡</code> -&gt; <code>æ‰“æ¬¾ä¸­</code></li>
<li>âŒ éæ³•è·¯å¾„ï¼š<code>ç”³è¯·ä¸­</code> -&gt; <code>æ‰“æ¬¾ä¸­</code>ï¼ˆè·³è¿‡å®¡æ ¸ï¼‰</li>
</ul>
<p>å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„ <code>if-else</code> æ¥é˜²å¾¡éæ³•è·³è½¬ï¼Œä»£ç ä¸­ä¼šå……æ–¥ç€å¤§é‡ <code>if (status === 'AUDIT_PASS')</code> è¿™æ ·çš„é˜²å¾¡æ€§åˆ¤æ–­ã€‚è€ŒçŠ¶æ€æœºå¯ä»¥é€šè¿‡é…ç½® <code>transitions</code>ï¼Œå¤©ç„¶åœ°ç¦æ­¢äº†æ‰€æœ‰æœªå®šä¹‰çš„è·³è½¬è·¯å¾„ã€‚</p>
<p>æ‰€ä»¥å½“ä¸šåŠ¡é€»è¾‘ä¸ä»…ä»…å…³ä¹â€œå½“å‰æ˜¯ä»€ä¹ˆçŠ¶æ€â€ï¼Œæ›´å…³ä¹â€œå½“å‰çŠ¶æ€å…è®¸å˜æ›´ä¸ºå“ªäº›çŠ¶æ€â€æ—¶ï¼Œå¯ä»¥è€ƒè™‘å¼•å…¥çŠ¶æ€æœºã€‚</p>
<h3 data-id="heading-10">æŠ€æœ¯é€‰å‹å¯¹ç…§è¡¨</h3>
<p>åœ¨å¼€å§‹å†™ä»£ç å‰ï¼Œå¯ä»¥å‚è€ƒä¸‹è¡¨è¿›è¡Œå†³ç­–ï¼š</p>

























<table><thead><tr><th><strong>ä¸šåŠ¡åœºæ™¯ç‰¹å¾</strong></th><th><strong>æ¨èæ–¹æ¡ˆ</strong></th></tr></thead><tbody><tr><td>ç®€å•çš„å¼€/å…³çŠ¶æ€ (Toggle)</td><td><code>useState(boolean)</code></td></tr><tr><td>ç®€å•çš„äº’æ–¥çŠ¶æ€ (Loading/Success/Error)</td><td>å­—ç¬¦ä¸²æšä¸¾ (String Enum)</td></tr><tr><td><strong>çŠ¶æ€å¤æ‚ï¼Œä¸”å­˜åœ¨ç‰¹å®šçš„æµè½¬è§„åˆ™</strong></td><td><strong>çŠ¶æ€æœº (Reducer / XState)</strong></td></tr><tr><td><strong>æ¶‰åŠå®šæ—¶å™¨ã€é‡è¯•ã€å–æ¶ˆç­‰å¼‚æ­¥ç«æ€é—®é¢˜</strong></td><td><strong>çŠ¶æ€æœº (æ¨è)</strong></td></tr></tbody></table>
<p>è®°ä½ï¼Œå·¥å…·æ˜¯ä¸ºäº†è§£å†³å¤æ‚åº¦è€Œç”Ÿçš„ã€‚ç®€å•ç•™ç»™ <code>useState</code>ï¼Œå¤æ‚ç•™ç»™çŠ¶æ€æœºã€‚</p>
<h2 data-id="heading-11">é™åˆ¶å³è‡ªç”±</h2>
<p>å†™çƒ‚ä»£ç çš„æœ¬è´¨ï¼Œå¾€å¾€æ˜¯æˆ‘ä»¬è¯•å›¾åœ¨æ··ä¹±ä¸­ä¿ç•™è¿‡å¤šçš„â€œè‡ªç”±åº¦â€ã€‚è€Œä¼˜ç§€æ¶æ„çš„æœ¬è´¨ï¼Œé€šå¸¸åœ¨äº<strong>é™åˆ¶</strong>ã€‚æ­£å¦‚é‚£å¥è¯è¯´çš„ï¼šã€Œ<strong>å–œæ¬¢å°±ä¼šæ”¾è‚†ï¼Œä½†çˆ±å°±æ˜¯å…‹åˆ¶</strong>ã€</p>
<p>çŠ¶æ€æœºä¸¥æ ¼è§„å®šäº†ä»€ä¹ˆçŠ¶æ€ä¸‹èƒ½åšä»€ä¹ˆäº‹ï¼Œè¿™ç§å…‹åˆ¶æé«˜äº†æˆ‘ä»¬çš„å‰ç«¯ç¨³å®šæ€§ã€‚</p>
<p><strong>æœ€åé€ç»™æ‰€æœ‰çš„å‰ç«¯çš„ä¸€å¥è¯ï¼š</strong></p>
<blockquote>
<p>æ‰€æœ‰çš„ Bugï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ <strong>â€œéæ³•çš„çŠ¶æ€â€æˆ–â€œé”™è¯¯çš„è½¬æ¢â€</strong>ã€‚</p>
<p>TypeScript å¸®æˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶é™æ€åœ°è§„é¿äº†éæ³•ç±»å‹ï¼Œè€ŒçŠ¶æ€æœºåˆ™å¸®æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°ç®¡ç†çŠ¶æ€æµè½¬ã€‚</p>
<p>TypeScript + State Machine = å‰ç«¯é€»è¾‘çš„ç»å¯¹é˜²å¾¡ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Q CLIåŠ©åŠ›åˆåˆä¿¡æ¯å®ç°Auroraçš„å‡çº§è¿è¥]]></title>    <link>https://juejin.cn/post/7584289165753614390</link>    <guid>https://juejin.cn/post/7584289165753614390</guid>    <pubDate>2025-12-16T11:01:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584289165753614390" data-draft-id="7583898823920926762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Q CLIåŠ©åŠ›åˆåˆä¿¡æ¯å®ç°Auroraçš„å‡çº§è¿è¥"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-16T11:01:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºšé©¬é€Šäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2850395271209496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Q CLIåŠ©åŠ›åˆåˆä¿¡æ¯å®ç°Auroraçš„å‡çº§è¿è¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2850395271209496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºšé©¬é€Šäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T11:01:23.000Z" title="Tue Dec 16 2025 11:01:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f51e1e53d92e492cb369495a99b9628c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=jxq%2Bp0lx3qR04HutCyBZceMdcE4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">1. å‡çº§èƒŒæ™¯</h2>
<p>åˆåˆä¿¡æ¯æ˜¯ä¸€å®¶ä¸­å›½é¢†å…ˆçš„äººå·¥æ™ºèƒ½(AI)äº§å“å…¬å¸ï¼Œä¸€ç›´è‡´åŠ›äºé€šè¿‡AIæŠ€æœ¯èµ‹èƒ½åˆ›æ–°ï¼Œä¸ºå…¨çƒæ•°äº¿ç”¨æˆ·å’Œå¤šå…ƒåŒ–è¡Œä¸šæä¾›äº§å“æœåŠ¡ã€‚å‡­å€Ÿè¶…è¿‡18å¹´çš„AIç ”ç©¶å’Œåº”ç”¨ä¸“ä¸šçŸ¥è¯†ï¼Œåˆåˆä¿¡æ¯å·²æˆä¸ºå…¨çƒå¤šæ¨¡æ€å¤§æ¨¡å‹æ–‡æœ¬æ™ºèƒ½æŠ€æœ¯çš„é¢†å…ˆè€…ï¼Œå¹¶è‡ªä¸»ç ”å‘æ¨å‡ºäº†ä¸€ç³»åˆ—äº§å“ï¼ŒåŒ…æ‹¬æ‰«æå…¨èƒ½ç‹ã€åç‰‡å…¨èƒ½ç‹ã€å¯ä¿¡å®ã€TextInå’ŒChatermï¼Œå…¬å¸ä¸šåŠ¡éåŠå…¨çƒ200å¤šä¸ªå›½å®¶å’Œåœ°åŒºã€‚</p>
<p>ç›®å‰åˆåˆä¿¡æ¯åœ¨æµ·å¤–åŒºåŸŸæœ‰å¤šå¥—Aurora MySQLå®ä¾‹è¿è¡Œåœ¨3.xç‰ˆæœ¬ï¼Œè®¡ç®—èŠ‚ç‚¹çš„é…ç½®ä¸ºr6gã€‚æˆ‘ä»¬æœŸæœ›ä¸äºšé©¬é€Šäº‘ç§‘æŠ€åˆä½œè¾¾æˆä»¥ä¸‹ç›®æ ‡ï¼š</p>
<h3 data-id="heading-1">1.1å€ŸåŠ©Graviton4æœºå‹æå‡Auroraé›†ç¾¤æ€§ä»·æ¯”</h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒGravitonèŠ¯ç‰‡çš„ç®—åŠ›å’Œæ€§ä»·æ¯”æ˜¯ç›¸å½“å‡ºä¼—çš„ï¼Œæ›¾æœ‰Blogæåˆ°æ¬¡æ–°ä¸€ä»£Graviton3ä¸é«˜äºGraviton3ä¸€ä»£çš„Intel r7iæœºå‹ç›¸æ¯”ï¼Œåœ¨.netçš„æµ‹è¯•åœºæ™¯ä¸­æœ‰23ï½32%çš„æ€§èƒ½æå‡ï¼Œä½†ä»·æ ¼å´æ›´ä¾¿å®œ(å¯å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fblogs%2Fdotnet%2Fpowering-net-8-with-aws-graviton3-benchmarks%2F" target="_blank" title="https://aws.amazon.com/blogs/dotnet/powering-net-8-with-aws-graviton3-benchmarks/" ref="nofollow noopener noreferrer">Blog</a>)ã€‚åœ¨æœ¬æ¬¡å®éªŒå½“ä¸­åˆåˆä¿¡æ¯å°†åœ¨AuroraæœåŠ¡ä¸ŠéªŒè¯æœ€æ–°çš„Graviton4çš„æ€§èƒ½æ”¶ç›Šï¼Œä¹Ÿå¸Œæœ›é€šè¿‡å¼•å…¥G4æœºå‹åˆ°AuroraæœåŠ¡ä¸­æ¥æå‡å½“å‰æ•°æ®åº“é›†ç¾¤çš„å¤„ç†èƒ½åŠ›ï¼Œäº«å—åˆ°æœ€æ–°Graviton4èŠ¯ç‰‡æ‰€å¸¦æ¥çš„å¤§å¹…åº¦æ€§ä»·æ¯”æå‡ã€‚</p>
<h3 data-id="heading-2">1.2å€ŸåŠ©Aurora 3.10 LTSç‰ˆæœ¬è·å¾—æ›´é•¿çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Aurora MySQL 3.10ç‰ˆæœ¬åœ¨2025å¹´8æœˆä»½å‘å¸ƒï¼Œè¿™ä¸€ç‰ˆæœ¬ä¸æ™®é€šçš„å‘å¸ƒç‰ˆæœ¬ä»…æ”¯æŒ1å¹´ä¸åŒï¼ŒLTS 3.10ç‰ˆæœ¬å°†æä¾›è¿‘3å¹´çš„æ”¯æŒæ—¶é—´ï¼Œå³åˆ°2028å¹´ã€‚ç”¨æˆ·å¯ä»¥ä¿æŒåœ¨LTSç‰ˆæœ¬3å¹´ä»¥é¿å…æ¯å¹´ä¸€æ¬¡çš„å‡çº§å·¥ä½œï¼ŒåŒæ—¶å› ä¸ºå‡çº§åˆ‡æ¢å¸¦æ¥çš„ä¸šåŠ¡å½±å“ä¹Ÿè¢«å‡å°‘åˆ°æœ€ä½ã€‚</p>
<h3 data-id="heading-3">1.3å€ŸåŠ©Q CLIåŠ é€ŸæŠ€æœ¯éªŒè¯ï¼Œæ”¯æ’‘Auroraæ¼”è¿›</h3>
<p>åœ¨ç”Ÿäº§è¿ç§»å‰éœ€è¦å¯¹Graviton4åšæ€§èƒ½éªŒè¯ï¼ŒåŒæ—¶éœ€è¦å¯¹èŠ‚ç‚¹åˆ‡æ¢çš„å½±å“åšæ·±å…¥çš„åˆ†æï¼Œæœ€å°åŒ–åˆ‡æ¢å¯¹åº”ç”¨è®¿é—®çš„å½±å“ï¼Œä½†è¿™äº›å·¥ä½œå¾€å¾€æ˜¯éœ€è¦ç¹æ‚çš„ç¯å¢ƒæ­å»ºå’Œå·¥å…·è®¾è®¡æ‰èƒ½å®Œæˆï¼Œæœ¬æ¬¡åˆåˆä¿¡æ¯çš„æµ‹è¯•éªŒè¯å½“ä¸­å°±å¤§é‡ä½¿ç”¨äº†Q CLIæ¥åŠ é€ŸæŠ€æœ¯éªŒè¯ï¼Œç”šè‡³å½¢æˆå¤šç»´åº¦çš„åˆ†ææŠ¥å‘Šã€‚è®©æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚é‡Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨Q CLIæ¥åŠ é€Ÿåˆåˆä¿¡æ¯åœ¨Aurora + Graviton4ä¸Šçš„æŠ€æœ¯éªŒè¯ã€‚</p>
<blockquote>
<p>ğŸ“¢é™æ—¶æ’æ’­ï¼šAmazon Q Developer æ¥å¸®ä½ åšåº”ç”¨å•¦ï¼
ğŸŒŸ10åˆ†é’Ÿå¸®ä½ æ„å»ºæ™ºèƒ½ç•ªèŒ„é’Ÿåº”ç”¨ï¼Œ1å°æ—¶æå®šæ–°åŠŸèƒ½æ‹“å±•ã€æµ‹è¯•ä¼˜åŒ–ã€æ–‡æ¡£æ³¨ç¨‹å’Œéƒ¨ç½²
â©å¿«å¿«ç‚¹å‡»è¿›å…¥ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fevents.amazoncloud.cn%2Flabs%2Fcloudlab-amazon-q-cli-and-ide-build%3Fvisitfrom%3D3P_SFhead_1216%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_SFhead_1216" target="_blank" title="https://events.amazoncloud.cn/labs/cloudlab-amazon-q-cli-and-ide-build?visitfrom=3P_SFhead_1216&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_SFhead_1216" ref="nofollow noopener noreferrer">Agentic Al å¸®ä½ åšåº”ç”¨ -- ä»0åˆ°1æ‰“é€ è‡ªå·±çš„æ™ºèƒ½ç•ªèŒ„é’Ÿ</a>ã€‹å®éªŒ
å…è´¹ä½“éªŒä¼ä¸šçº§ AI å¼€å‘å·¥å…·çš„çœŸå®æ•ˆæœå§
æ„å»ºæ— é™ï¼Œæ¢ç´¢å¯ç¨‹!</p>
</blockquote>
<h2 data-id="heading-4">2. Auroraå‡çº§çš„ç‰ˆæœ¬é€‰æ‹©</h2>
<p>åœ¨æœ¬æ¬¡æŠ€æœ¯éªŒè¯å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹Auroraçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ”¯æŒæ—¶é—´ï¼Œä»¥åŠå¼•æ“ä¸R7g/R8gçš„å…¼å®¹ä¿¡æ¯åšæ•´ç†ã€‚å¦‚æœä½¿ç”¨äººå·¥ï¼Œè¿™å°†æ˜¯éå¸¸è€—æ—¶ï¼Œä¸”å®¹æ˜“å‡ºé”™çš„ï¼Œä½†å½“æˆ‘ä»¬é…ç½®äºšé©¬é€Šäº‘ç§‘æŠ€å®˜æ–¹çš„aws-knowledge-mcp-serverï¼Œå°±å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„ç”Ÿæˆç›¸å…³çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-5">2.1 Aurora R8g/R7gä¸ç‰ˆæœ¬é€‰æ‹©å»ºè®®</h3>
<p>å½“å‰æœ€æ–°çš„Aurora mysql ç‰ˆæœ¬æ˜¯3.10.1ï¼Œå½“å‰LTSç‰ˆæœ¬æ˜¯3.10ï¼Œæ¨èç”Ÿäº§ç³»ç»Ÿä½¿ç”¨3.10.1ç‰ˆæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c709cb1705e54a19b1451fd7a0e2ff1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=1yBWzdLTY%2FyX%2BgbrnjGrzX9a1zg%3D" alt="1.webp" loading="lazy"/></p>
<p>å¯¹äºAurora MySQLå¼•æ“æ¨èä½¿ç”¨3.10.0 (LTS)ï¼Œè·å¾—è¿‘3å¹´çš„æ”¯æŒå‘¨æœŸã€‚æ›´é•¿çš„å‘¨æœŸæ„å‘³ç€æ›´å°‘çš„è¿ç»´å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿèƒ½é¿å…å¼ºåˆ¶å‡çº§å¸¦æ¥çš„ä¸šåŠ¡å½±å“ã€‚</p>
<h3 data-id="heading-6">2.2 Aurora R8gæœºå‹æŒ‰éœ€/é¢„ç•™å®ä¾‹çš„å¯ç”¨æ€§</h3>
<p>ç»“åˆQ CLIçš„MCPåŠŸèƒ½ï¼Œå€ŸåŠ©äºAmazon Pricing APIå®ŒæˆR8g OD/RIåœ¨å„åŒºåŸŸçš„è¦†ç›–æƒ…å†µç¡®è®¤ï¼Œå¹¶å€ŸåŠ©äºaws-knowledge-mcp-serverè¡¥å……ç›¸åº”çš„å‘å¸ƒæ—¶é—´ä¿¡æ¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5509ebd117c14feaaf9f1c8dec38f443~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=en4lLSTCUo7SkmGDpAq%2BGjZFtIE%3D" alt="2.webp" loading="lazy"/></p>
<h3 data-id="heading-7">2.3 Q CLIè¾…åŠ©å®Œæˆç‰ˆæœ¬è°ƒç ”</h3>
<p>å¯ä»¥å‚è€ƒä»¥ä¸‹æç¤ºè¯å®Œæˆç›¸å…³å†…å®¹çš„ç”Ÿæˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef89ea14ebdb4f1b93281c927e15c572~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=oD%2B78PwPZKonMlkDWJwRE69q6ds%3D" alt="3.webp" loading="lazy"/></p>
<pre><code class="hljs language-markdown" lang="markdown">Plain Text
æˆ‘éœ€è¦å¯¹Auroraå’Œç‰ˆæœ¬å’Œr7g/r8gçš„å…¼å®¹æ€§åšåˆ†æï¼Œä»¥ä¸‹æ˜¯åˆ†æè¦æ±‚ï¼š
<span class="hljs-bullet">   -</span> åŸºäºAmazon CLIæŸ¥è¯¢çš„å®æ—¶ç‰ˆæœ¬å…¼å®¹æ€§åˆ†æï¼Œç»“åˆawsçš„åœ¨çº¿æ–‡æ¡£å’ŒBlogï¼ŒWhat'newèµ„æºï¼›
<span class="hljs-bullet">   -</span> å½“å‰å¯ç”¨Auroraç‰ˆæœ¬æ€»è§ˆï¼šä»¥è¡¨æ ¼å‘ˆç°ï¼ŒåŒ…æ‹¬å¼•æ“ç±»å‹/æœ€æ–°ç‰ˆæœ¬/å½“å‰LTSç‰ˆæœ¬/R7gæœ€ä½ç‰ˆæœ¬è¦æ±‚/R8gæœ€ä½ç‰ˆæœ¬è¦æ±‚
<span class="hljs-bullet">   -</span> è¯¦ç»†çš„Aurora MySQLå’ŒPostgreSQLç‰ˆæœ¬å‘å¸ƒæ—¶é—´çº¿,ä»¥è¡¨æ ¼å‘ˆç°ï¼ŒåŒ…æ‹¬Auroraç‰ˆæœ¬/å‘å¸ƒæ—¶é—´/æ ‡å‡†æ”¯æŒç»“æŸæ—¶é—´/æ˜¯å¦LTSç‰ˆæœ¬/R7gå…¼å®¹/r8gå…¼å®¹
<span class="hljs-bullet">   -</span> å¦‚æœéœ€è¦æ¸²æŸ“å¯ä»¥ä½¿ç”¨ä¸­å›½å›½å†…æºçš„d3.jsï¼›
<span class="hljs-bullet">   -</span> ä»¥htmlæ ¼å¼å‘ˆç°ï¼Œæ–‡ä»¶åä¸ºaurora-graviton-version.html;
</code></pre>
<p>æ³¨æ„ï¼š</p>
<p>1.ä¸ºç¡®ä¿R8g/R7g OD/RIå®ä¾‹å¯ç”¨ä¿¡æ¯çš„å‡†ç¡®æ€§ï¼Œè¿™éœ€è¦aws cliç¯å¢ƒæ”¯æŒï¼Œprofileéœ€è¦æœ‰Pricing APIçš„è®¿é—®æƒï¼›</p>
<p>2.éœ€è¦ç¡®ä¿Q CLIé…ç½®äº†è¿™ä¸¤ä¸ªMCP Server</p>
<ul>
<li>core-mcp-serverï¼šäºšé©¬é€Šäº‘ç§‘æŠ€ç›¸å…³çš„è¯­ä¹‰è¯†åˆ«</li>
<li>aws-knowledge-mcp-serverï¼šæ”¯æŒstreamablehttp</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fawslabs.github.io%2Fmcp%2Fservers%2Faws-knowledge-mcp-server%2F" target="_blank" title="https://awslabs.github.io/mcp/servers/aws-knowledge-mcp-server/" ref="nofollow noopener noreferrer">awslabs.github.io/mcp/serversâ€¦</a></p>
<h2 data-id="heading-8">3. Q CLIåŠ é€Ÿå‡çº§å‰çš„æŠ€æœ¯éªŒè¯</h2>
<p>åˆåˆä¿¡æ¯åœ¨å†³å®šå°†Auroraè¿ç§»è‡³æœ€æ–°çš„Graviton4å¹³å°ä¹‹å‰ï¼Œæˆ‘ä»¬å¯¹ä¸¤ä¸ªç»´åº¦çš„ä¿¡æ¯åšäº†ç¡®è®¤ï¼Œè¿™åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ€§èƒ½éªŒè¯åœºæ™¯ â€“ Graviton2/Graviton3/Graviton4çš„æ•°æ®åº“æ€§èƒ½åšæµ‹è¯•ï¼›</li>
<li>åº”ç”¨åˆ‡æ¢éªŒè¯ â€“ åˆ‡æ¢è¿‡ç¨‹åº”ç”¨å½±å“æ¨¡æ‹Ÿä¸åˆ†æï¼›</li>
</ul>
<p>ä»¥ä¸‹æˆ‘ä»¬å°†é€šè¿‡Q CLIæ¥åŠ é€Ÿè¿™äº›ç»´åº¦çš„æŠ€æœ¯éªŒè¯ã€‚</p>
<h3 data-id="heading-9">3.1ä½¿ç”¨Q CLIåŠ é€ŸAuroraçš„G2/G3/G4æœºå‹çš„æ€§èƒ½å¯¹æ¯”</h3>
<p>æƒ³åˆ°åšä¸€æ¬¡æ•°æ®åº“æ€§èƒ½æµ‹è¯•ï¼Œç›¸ä¿¡å¤§å®¶ä¼šæƒ³åˆ°æœ‰è¿™å‡ ç±»å·¥ä½œè¦åšï¼š</p>
<ul>
<li><strong>è®¾è®¡é˜¶æ®µï¼š</strong> è®¾è®¡å¹¶æ­å»ºæµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬VPC/å­ç½‘/å®‰å…¨ç»„ï¼Œç”¨äºæµ‹è¯•çš„å ¡å’æœºå’ŒAuroraé›†ç¾¤ï¼›</li>
<li><strong>æµ‹è¯•é˜¶æ®µï¼š</strong> å®‰è£…sysbenchï¼Œä¸ºARMæ¶æ„ç¼–è¯‘ç¨‹åºï¼Œåˆ›å»ºæµ‹è¯•æ•°æ®ï¼Œç¼–å†™è„šæœ¬ï¼Œå¤šæ¬¡æµ‹è¯•ï¼›</li>
<li><strong>ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šï¼š</strong> åˆ†ææµ‹è¯•æ•°æ®ï¼Œç”¨Excelç”»å‡ºè¡¨æ ¼ï¼Œä»¥æ­¤å¾—å‡ºæµ‹è¯•ç»“è®ºï¼›</li>
</ul>
<p>ä½†ä½¿ç”¨äº†Q CLIä¹‹åä»¥ä¸Šé™¤äº†å®éªŒè®¾è®¡ï¼Œæµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•æŠ¥å‘Šè¦æ±‚éœ€è¦æ˜ç¡®å¤–ï¼Œå…¶å®ƒå·¥ä½œéƒ½å¯ä»¥äº¤ç»™Q CLIæ¥å®Œæˆã€‚å®ƒå¯ä»¥å¸®æˆ‘ä»¬è¾¾æˆä»€ä¹ˆæ ·çš„ç»“æœï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥çœ‹ã€‚</p>
<h4 data-id="heading-10">3.1.1 Q CLIåˆ›å»ºçš„éªŒè¯ç¯å¢ƒå’ŒéªŒè¯æµç¨‹å›¾</h4>
<p><strong>1.</strong> <strong>éªŒè¯æœºå‹é€‰æ‹©</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37265a3f4f8045c1b2d2a2b63458eb5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=N7xifgtAfKQzd%2F5gfbZU%2BMesIxQ%3D" alt="4.webp" loading="lazy"/></p>
<p><strong>2.</strong> <strong>éªŒè¯èµ„æºä¸æ¶æ„å›¾</strong></p>
<p>å€ŸåŠ©äºQ CLIçš„xmlè§£æèƒ½åŠ›ï¼Œåœ¨å®Œæˆäº†æµ‹è¯•ç¯å¢ƒæ­å»ºä¹‹åï¼Œå®ƒä¸ºæœ¬æ¬¡æµ‹è¯•ç¯å¢ƒç”Ÿæˆäº†drawioæ ¼å¼çš„æ¶æ„å›¾(å­—ä½“é‡å é—®é¢˜éœ€äººå·¥ç¾åŒ–)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a8eb3eafc18477093e56972c792150b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=RwYmzLvyCjT2VdY97Qc8tf2lr%2Fo%3D" alt="5.webp" loading="lazy"/></p>
<p><strong>3.</strong> <strong>éªŒè¯æµç¨‹æ¦‚è¦</strong></p>
<p>å¯¹äºæœ¬æ¬¡æµ‹è¯•éœ€è¦æµ‹è¯•äººå‘˜ä¸Q CLIç´§å¯†åä½œï¼Œå› ä¸ºQ CLIè¿˜ä¸å…·å¤‡ç‹¬ç«‹å®Œæˆæµ‹è¯•æµç¨‹åˆ¶è®¢çš„èƒ½åŠ›ï¼Œéœ€è¦èåˆæˆ‘ä»¬åœ¨æ€§èƒ½æµ‹è¯•çš„è®¸å¤šæ–¹æ³•å’Œç»éªŒç§¯ç´¯ã€‚ ä»¥ä¸‹ä¸ºQ CLIæ ¹æ®å¤šæ¬¡çš„ä¿®æ”¹è¡¥å……åå®Œæˆçš„æµ‹è¯•è®¡åˆ’ï¼Œå¹¶ä¸”ä½¿ç”¨drawioæ ¼å¼ç”Ÿæˆçš„æµ‹è¯•æµç¨‹å›¾ï¼Œä¸ºäº†ç¾è§‚æ€»ä½“å¸ƒå±€åšäº†å°‘é‡è°ƒæ•´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3176fbbb588444c91b0529405a41ba0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=XOc8uxDBKx%2Bxl87IJVGzZiSC6Gc%3D" alt="6.webp" loading="lazy"/></p>
<h4 data-id="heading-11">3.1.2ä½¿ç”¨Q CLIå®Œæˆæµ‹è¯•ç»“æœåˆ†æä¸æŠ¥å‘Šå±•ç¤º</h4>
<p>Q CLIåœ¨æœ¬æ¬¡çš„æŠ€æœ¯éªŒè¯ä¸­å‘æŒ¥äº†é‡å¤§çš„ä½œç”¨ï¼Œå°¤å…¶æ˜¯åœ¨æµ‹è¯•ç»“æœçš„åˆ†æå’Œå‘ˆç°ä¸Šï¼Œå¯ä»¥ç”Ÿæˆéå¸¸ç¾è§‚çš„æµ‹è¯•æŠ¥å‘Šï¼Œè€Œè¿™äº›æŠ¥å‘Šå¯ä»¥ä½œä¸ºç‹¬ç«‹çš„äº¤ä»˜ç‰©å­˜æ¡£æ€»ç»“ã€‚</p>
<p><strong>1.</strong> <strong>æ€§èƒ½éªŒè¯æ€»ç»“</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1582fab0aaeb428ca5bb4d6990b0c758~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=tZ8IfJEBJhXSzM47q3mjB7UT1yo%3D" alt="7.webp" loading="lazy"/></p>
<p><strong>2.</strong> <strong>æµ‹è¯•å„é¡¹æŒ‡æ ‡æƒ…</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cff41fe79461442fa7845ba7f185c9d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=QcbgoVxMKz3Aox8iH72f5cujbCw%3D" alt="8.webp" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68751b69da39429cbcf406ad7a1959f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=CIvKF0IQfPlOLhOWurq2S7mUNPE%3D" alt="9.webp" loading="lazy"/></p>
<p><strong>3.</strong> <strong>è¯¦ç»†çš„æµ‹è¯•æ•°æ®ä¸æ€§ä»·æ¯”æŠ˜ç®—</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/833f9cd48daf47788cec067fa08a8791~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=peOgT%2FihcQ4%2BmYRjnkCvxPQOeGE%3D" alt="10.webp" loading="lazy"/></p>
<p><strong>4.</strong> <strong>éªŒè¯æ€»ç»“</strong></p>
<p>é€šè¿‡è¿™æ¬¡æ€§èƒ½éªŒè¯æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰æ¯ç™¾ä¸‡TPSæ¯ç¾é‡‘çš„æˆæœ¬æ¥å¯¹æ¯”ä¸åŒæœºå‹çš„å·®å¼‚ï¼š</p>
<ul>
<li><strong>r8g.2xlarge TPS</strong> <strong>æå‡113%:</strong> Â æœ€æ–°ä¸€ä»£å¤„ç†å™¨ï¼Œåœ¨128çº¿ç¨‹é«˜å¹¶å‘åœºæ™¯ä¸‹è¡¨ç°ä¼˜å¼‚ï¼Œæµ‹è¯•ç»“æœä¸º27.22ç™¾ä¸‡<strong>TPS/$ï¼›</strong></li>
<li><strong>r7g.2xlarge TPS</strong> <strong>æå‡40%:</strong> Â å¹³è¡¡çš„æ€§èƒ½è¡¨ç°ï¼Œé€‚åˆå¤§å¤šæ•°å·¥ä½œè´Ÿè½½ï¼Œåœ¨128çº¿ç¨‹ä¸‹ï¼Œæµ‹è¯•ç»“æœä¸º15.55ç™¾ä¸‡<strong>TPS/$ï¼›</strong></li>
<li><strong>r6g.2xlarge</strong> <strong>æµ‹è¯•åŸºçº¿:</strong> Â 128çº¿ç¨‹å¹¶å‘ä¸‹ï¼Œæµ‹è¯•ç»“æœä¸º13.88ç™¾ä¸‡<strong>TPS/$ï¼›</strong></li>
</ul>
<p><strong>5.Q CLI</strong> <strong>æç¤ºè¯å‚è€ƒ</strong></p>
<p>ä»¥ä¸‹æ˜¯æç¤ºè¯å‚è€ƒ</p>
<pre><code class="hljs language-diff" lang="diff">Bash
æˆ‘éœ€è¦å®ŒæˆAurora 3.10ç‰ˆæœ¬å’ŒGraviton2/Graviton3/Graviton4å®ä¾‹çš„æ€§èƒ½æµ‹è¯•é¡¹ç›®ï¼Œå¹¶ç”Ÿæˆå®Œæ•´çš„åˆ†ææŠ¥å‘Šã€‚
## ç¯å¢ƒé…ç½®
<span class="hljs-deletion">- å½“å‰ç¯å¢ƒï¼šmacOSï¼Œå·²é…ç½®AWS CLIå’ŒPython3</span>
<span class="hljs-deletion">- Pythonç¯å¢ƒï¼šsource ~/Documents/VSCodeFolder/.venv/bin/activate</span>
<span class="hljs-deletion">- åŒ…ç®¡ç†ï¼šä½¿ç”¨ uv pip install å®‰è£…PythonåŒ…</span>
<span class="hljs-deletion">- å¯†é’¥è·¯å¾„ï¼š~/Documents/VSCodeFolder/_aihome/kp-vgn.pem</span>
<span class="hljs-deletion">- æµ‹è¯•åŒºåŸŸï¼šus-east-1</span>
## åŸºç¡€è®¾æ–½è¦æ±‚
<span class="hljs-deletion">- ä½¿ç”¨ç°æœ‰VPCï¼ˆå¦‚æ»¡è¶³è¦æ±‚ï¼‰</span>
<span class="hljs-deletion">- å ¡å’æœºï¼šr6a.2xlargeï¼ŒAmazon Linux 2023ï¼Œå¼€æ”¾22ç«¯å£</span>
<span class="hljs-deletion">- Auroraé›†ç¾¤ï¼š3.10ç‰ˆæœ¬ï¼Œ3ä¸ªå®ä¾‹åˆ†åˆ«ä¸º db.r6g.2xlarge(ä¸»), db.r7g.2xlarge, db.r8g.2xlarge</span>
<span class="hljs-deletion">- å®‰å…¨ç»„ï¼šä¸å¼€æ”¾å…¬ç½‘ï¼Œä½†å…è®¸å ¡å’æœºè®¿é—®Auroraï¼ˆ3306ç«¯å£ï¼‰</span>
## è½¯ä»¶å®‰è£…è¦æ±‚ï¼ˆå…³é”®æ”¹è¿›ï¼‰
<span class="hljs-deletion">- å ¡å’æœºè½¯ä»¶åŒ…ï¼š</span>
* MySQLå®¢æˆ·ç«¯ï¼šä½¿ç”¨ mariadb105 (Amazon Linux 2023å…¼å®¹)
* sysbenchï¼šä»æºç ç¼–è¯‘å®‰è£…ï¼Œéœ€è¦å…ˆå®‰è£…Development Toolså’Œmariadb105-devel
* ç¼–è¯‘ä¾èµ–ï¼šgit, automake, libtool, openssl-devel
<span class="hljs-deletion">- å®‰è£…é¡ºåºï¼šå…ˆå®‰è£…ä¾èµ–åŒ… â†’ ç¼–è¯‘sysbench â†’ éªŒè¯å®‰è£…</span>
## æµ‹è¯•æ•°æ®è¦æ±‚
<span class="hljs-deletion">- ä½¿ç”¨sysbench oltp_read_writeæ¨¡æ¿</span>
<span class="hljs-deletion">- 8å¼ è¡¨ï¼Œæ¯è¡¨200ä¸‡è®°å½•</span>
<span class="hljs-deletion">- è¯»å†™æ¯”ä¾‹1:1</span>
<span class="hljs-deletion">- æ•°æ®å‡†å¤‡æ—¶é—´ï¼šçº¦15-20åˆ†é’Ÿ</span>
## æµ‹è¯•æ‰§è¡Œè¦æ±‚
<span class="hljs-deletion">- æµ‹è¯•çº¿ç¨‹ï¼š32, 64, 128</span>
<span class="hljs-deletion">- æ¯ä¸ªæµ‹è¯•ï¼šé¢„çƒ­1åˆ†é’Ÿ + æµ‹è¯•2åˆ†é’Ÿ = å…±3åˆ†é’Ÿ</span>
<span class="hljs-deletion">- **å…³é”®**ï¼šæ¯ä¸ªå®ä¾‹å¿…é¡»é€šè¿‡ä¸»å¤‡åˆ‡æ¢ä½œä¸ºä¸»èŠ‚ç‚¹è¿›è¡Œæµ‹è¯•ï¼ˆå› ä¸ºsysbenchåŒ…å«å†™æ“ä½œï¼‰</span>
<span class="hljs-deletion">- æµ‹è¯•é¡ºåºï¼šr6g â†’ r7g â†’ r8g</span>
<span class="hljs-deletion">- åˆ‡æ¢ç­‰å¾…æ—¶é—´ï¼šfailoveråç­‰å¾…60ç§’ç¨³å®šï¼Œæµ‹è¯•é—´éš”30ç§’</span>
## å®šä»·æ•°æ®ï¼ˆus-east-1ï¼ŒåŸºäºå®æ—¶æŸ¥è¯¢ï¼‰
<span class="hljs-deletion">- æŒ‰éœ€ä»·æ ¼ï¼šdb.r6g.2xlarge=$1.038/h, db.r7g.2xlarge=$1.106/h, db.r8g.2xlarge=$1.104/h</span>
<span class="hljs-deletion">- é¢„ç•™å®ä¾‹(1å¹´)ï¼šdb.r6g.2xlarge=$0.68/h, db.r7g.2xlarge=$0.851/h, db.r8g.2xlarge=$0.74/h</span>
## æŠ¥å‘Šç”Ÿæˆè¦æ±‚ï¼ˆé‡è¦æ›´æ–°ï¼‰
éœ€è¦ç”Ÿæˆ3ä¸ªä¸åŒç±»å‹çš„æŠ¥å‘Šï¼š
### 1. æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
<span class="hljs-deletion">- ä½¿ç”¨EChartsï¼ˆä¸­å›½å›½å†…CDNï¼‰è¿›è¡Œå›¾è¡¨æ¸²æŸ“</span>
<span class="hljs-deletion">- å•†åŠ¡é£æ ¼HTMLæŠ¥å‘Š</span>
<span class="hljs-deletion">- åŒ…å«ï¼šTPS/QPS/å»¶è¿ŸP95å¯¹æ¯”ã€æˆæœ¬æ•ˆç›Šåˆ†æ</span>
<span class="hljs-deletion">- æ–‡ä»¶åï¼šaurora_graviton_performance_report.html</span>
### 2. æ¶æ„åˆ†ææŠ¥å‘Š
<span class="hljs-deletion">- å•†åŠ¡é£æ ¼HTMLæŠ¥å‘Šï¼ŒåŒ…å«ï¼š</span>
* Auroraç‰ˆæœ¬å…¼å®¹æ€§è¯¦ç»†åˆ†æï¼ˆåŸºäºAWS CLIæŸ¥è¯¢ï¼‰
* å…¨çƒåŒºåŸŸå¯ç”¨æ€§å’Œå®šä»·å¯¹æ¯”
* LTSç‰ˆæœ¬å‘å¸ƒæ—¶é—´çº¿
* æŠ€æœ¯è§„æ ¼å¯¹æ¯”
<span class="hljs-deletion">- æ–‡ä»¶åï¼šaurora_graviton_analysis_report.html</span>
### 3. Draw.ioæ¶æ„å›¾ï¼ˆé‡è¦æ–°å¢ï¼‰
<span class="hljs-deletion">- AWSå®˜æ–¹é£æ ¼æ¶æ„å›¾ï¼Œä½¿ç”¨æ ‡å‡†AWSå›¾æ ‡å’Œé¢œè‰²</span>
<span class="hljs-deletion">- åŒ…å«VPCã€å¤šAZã€å®‰å…¨ç»„ã€Auroraé›†ç¾¤çš„å®Œæ•´æ¶æ„</span>
<span class="hljs-deletion">- æµ‹è¯•æµç¨‹å›¾ï¼Œå±•ç¤º7ä¸ªå…³é”®é˜¶æ®µå’Œè¯¦ç»†ä»»åŠ¡åˆ†è§£</span>
<span class="hljs-deletion">- æ–‡ä»¶æ ¼å¼ï¼š.drawio (å¯åœ¨diagrams.netä¸­æ‰“å¼€ç¼–è¾‘)</span>
<span class="hljs-deletion">- æ–‡ä»¶åï¼šaurora_graviton_architecture.drawio, aurora_graviton_test_process.drawio</span>
</code></pre>
<h3 data-id="heading-12">3.2 Q CLIåŠ é€Ÿåº”ç”¨åˆ‡æ¢é€è§†ä¸éªŒè¯</h3>
<p>Auroraé›†ç¾¤åœ¨èŠ‚ç‚¹åˆ‡æ¢æˆ–è“ç»¿éƒ¨ç½²çš„åˆ‡æ¢ä¸Šæä¾›éå¸¸å¥½çš„ä½“éªŒï¼Œ ä»æŠ€æœ¯ä¸Šæˆ‘ä»¬ä¹Ÿå¸Œæœ›å€ŸåŠ©äºQ CLIçš„èƒ½åŠ›ï¼Œå¸®æˆ‘ä»¬ç†æ¸…æ¥šä¸¤ä¸ªæŠ€æœ¯é—®é¢˜ï¼š</p>
<ul>
<li><strong>è¯»å†™è®¿é—®çš„å½±å“æœºåˆ¶ï¼š</strong> åœ¨èŠ‚ç‚¹åˆ‡æ¢çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œåº”ç”¨ç¨‹åºä¼šç»å†å“ªäº›é˜¶æ®µï¼Œä¼šæœ‰æ€æ ·çš„è¡Œä¸ºè¡¨ç°ï¼›</li>
<li><strong>å®ä¾‹åˆ‡æ¢ä¸DNSåˆ‡æ¢çš„æ—¶é—´å…³ç³»ï¼š</strong> DNSåˆ‡æ¢ä¸å®ä¾‹åˆ‡æ¢çš„å…³ç³»ï¼Œä»¥åŠå“ªäº›æœºåˆ¶å°†æœ‰åŠ©äºå‡å°‘åˆ‡æ¢å¯¹ä¸šåŠ¡çš„å½±å“ï¼›</li>
</ul>
<h4 data-id="heading-13">3.2.1æµ‹è¯•åœºæ™¯è®¾è®¡</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/deccce4412df47fa912a81c70e41db5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=TMz5caAAvs9%2FEnpczMJemqGSZ2c%3D" alt="11.webp" loading="lazy"/></p>
<h4 data-id="heading-14">3.2.2æµ‹è¯•çš„é‡è¦æŒ‡æ ‡</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7feaddb5fdf471f86329a0506851fe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=XxFKhtkmvmXcNqeTUZeDYbkoXwo%3D" alt="12.webp" loading="lazy"/></p>
<h4 data-id="heading-15">3.2.3.æµ‹è¯•çš„æ—¶é—´çº¿</h4>
<p>ä¸‹å›¾æ˜¯åˆ‡æ¢è¿‡ç¨‹æ“ä½œçš„æ—¶é—´çº¿ä¸3ç§æ¢é’ˆçš„è¡¨ç°</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7dcbb667f8b4334b7d1de1722d1d77c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=NikvaabJXl%2B0Evcv5cSd0w0%2F8fM%3D" alt="13.webp" loading="lazy"/></p>
<h4 data-id="heading-16">3.2.4åˆ‡æ¢è¿‡ç¨‹ä¸åº”ç”¨è¡Œä¸º</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a5fe5ef9fd548438fcddb45744de64b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=9GNi9IpwrrdnlXUH3IlNC9QmrbE%3D" alt="14.webp" loading="lazy"/></p>
<p>ä»ä¸Šé¢çš„è¡¨æ ¼ï¼Œåœ¨æ•´ä¸ªåˆ‡æ¢è¿‡ç¨‹ä¸­è¯»å†™æ¢é’ˆå’ŒDNSæ¢é’ˆæ‰€æœ‰çš„æ€§èƒ½å˜åŒ–ï¼ŒæŠ¥é”™ç±»å‹ï¼Œè¿™äº›éƒ½å°½æ”¶çœ¼åº•ï¼Œæˆ‘ä»¬ç»ˆäºæ¯”è¾ƒé€å½»äº†è§£åˆ‡æ¢è¿‡ç¨‹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºè¡¨ç°ã€‚</p>
<h4 data-id="heading-17">3.2.5åˆ‡æ¢æµ‹è¯•ç»“è®º</h4>
<p>é€šè¿‡ä¸Šé¢çš„æµ‹è¯•æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p>
<ol>
<li>ä¸šåŠ¡çš„å½±å“ä¸º14sï¼Œå…¶ä¸­è¯»æ“ä½œçš„å½±å“ä¸º9sï¼Œå†™æ“ä½œçš„å½±å“ä¸º14sï¼Œè¿™è¯´æ˜å¦‚æœåº”ç”¨å¯ä»¥æœ‰è¯»å†™åˆ†ç¦»ï¼Œåœ¨èŠ‚ç‚¹åˆ‡æ¢æ—¶å°†èƒ½æä¾›æ›´é«˜çš„å¯ç”¨æ€§ï¼›</li>
<li>åœ¨Auroraå®ä¾‹å‘ç”Ÿåˆ‡æ¢åˆ°DNSçš„IPæ˜ å°„çœŸå®åˆ‡æ¢ä¹‹é—´ï¼Œå¯¹äºå†™æ“ä½œéƒ½æ˜¯ä¸å¯ç”¨çš„ï¼Œè¿™æœŸé—´çš„è¿æ¥å°è¯•ä¹Ÿæ˜¯æ— æ•ˆå’Œï¼›</li>
<li>åœ¨DNSåˆ‡æ¢å®Œæˆåå†™æ“ä½œå®Œå…¨æ¢å¤æ­£å¸¸ï¼Œè¿™è¡¨æ˜DNSåˆ‡æ¢æ˜¯åº”ç”¨æ¢å¤çš„å”¯ä¸€æ ‡è®°ï¼›</li>
</ol>
<h4 data-id="heading-18">3.2.6åº”ç”¨åˆ‡æ¢çš„ä¼˜åŒ–</h4>
<p>æ—¢ç„¶DNSåˆ‡æ¢æ˜¯åº”ç”¨æ¢å¤çš„å”¯ä¸€æ ‡è®°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä½¿åº”ç”¨åˆ‡æ¢å˜å¾—æ›´å¿«ï¼Œæ›´æœ‰æ•ˆç‡ï¼š</p>
<ol>
<li>å¯¹äºå…·å¤‡DNSæ£€æµ‹çš„åº”ç”¨ï¼Œå®ƒæœ€ç»ˆä¼šé€šè¿‡DNSè§£æåˆ°æ–°çš„IPï¼Œè¿æ¥åˆ°æ–°çš„å®ä¾‹ï¼›</li>
<li>å¯¹äºæ²¡æœ‰DNSæ£€æµ‹çš„åº”ç”¨ï¼Œåœ¨åˆ‡æ¢å‘ç”Ÿåï¼Œå°†æ–°çš„é›†ç¾¤IPåˆ·æ–°ç»™è¿™äº›åº”ç”¨(reloadæˆ–é‡å¯æœåŠ¡)ï¼Œè¿™äº›åº”ç”¨ä¹Ÿä¼šè¿æ¥åˆ°æ­£ç¡®çš„å®ä¾‹ï¼›</li>
<li>ä½¿ç”¨äºšé©¬é€Šäº‘ç§‘æŠ€å®˜æ–¹çš„é©±åŠ¨ç¨‹åºæˆ–Wrapperæ’ä»¶å®ç°é›†ç¾¤æ‹“æ‰‘æ„ŸçŸ¥ï¼Œåœ¨ç¬¬ä¸€æ—¶é—´è·çŸ¥IPæ”¹å˜ï¼Œç¬¬ä¸€æ—¶é—´æ¢å¤è¿æ¥ï¼›</li>
</ol>
<p>å®˜æ–¹çš„æ•°æ®åº“é©±åŠ¨åŠ é€Ÿåˆ‡æ¢çš„åŸç†ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fblogs%2Fdatabase%2Fdemystifying-the-aws-advanced-jdbc-wrapper-plugins%2F" target="_blank" title="https://aws.amazon.com/blogs/database/demystifying-the-aws-advanced-jdbc-wrapper-plugins/" ref="nofollow noopener noreferrer">Demystifying the Amazon advanced JDBC wrapper plugins</a>ã€‹</p>
<h4 data-id="heading-19">3.2.7 Q CLIçš„æç¤ºè¯å‚è€ƒ</h4>
<p>åˆ‡æ¢æµ‹è¯•è¿›è¡Œè¿‡è®¸å¤šæ¬¡ï¼Œæç¤ºè¯ä¼šæ ¹æ®Q CLIè¾“å‡ºçš„ä¸åŒæ ¹æ®æµ‹è¯•ç›®æ ‡åšè°ƒæ•´ï¼Œæ‰€ä»¥è¿™ä¸ªæç¤ºè¯ä¸æ˜¯åˆå¹¶æ‰€æœ‰ä¿®æ”¹çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½ ä½¿ç”¨å®ƒå¯èƒ½çš„è¾“å‡ºä¸ä¸€å®šç›¸åŒï¼Œéœ€è¦ç»“åˆä½ çš„æµ‹è¯•ç¯å¢ƒï¼Œæµ‹è¯•è¦æ±‚æ¥ç¡®å®šã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾›å‚è€ƒçš„ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">Shell
æˆ‘éœ€è¦å®ŒæˆAurora 3.10ç‰ˆæœ¬å’ŒGraviton2/Graviton4å®ä¾‹çš„åˆ‡æ¢æµ‹è¯•é¡¹ç›®ï¼Œæˆ‘ä¼šæä¾›æµ‹è¯•å·¥å…·ï¼Œä½ ç†Ÿæ‚‰å®ƒï¼Œå¹¶å®Œæˆæµ‹è¯•ï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„åˆ†ææŠ¥å‘Šã€‚ä»¥ä¸‹æ˜¯æµ‹è¯•çš„è¯¦ç»†æè¿°ï¼š

## ç¯å¢ƒé…ç½®
<span class="hljs-deletion">- å½“å‰ç¯å¢ƒï¼šmacOSï¼Œå·²é…ç½®AWS CLIå’ŒPython3</span>
<span class="hljs-deletion">- Pythonç¯å¢ƒï¼šsource ~/Documents/VSCodeFolder/.venv/bin/activate</span>
<span class="hljs-deletion">- åŒ…ç®¡ç†ï¼šä½¿ç”¨ uv pip install å®‰è£…PythonåŒ…</span>
<span class="hljs-deletion">- å¯†é’¥è·¯å¾„ï¼š~/Documents/VSCodeFolder/_aihome/kp-vgn.pem</span>
<span class="hljs-deletion">- æµ‹è¯•åŒºåŸŸï¼šap-southeast-1</span>

## åŸºç¡€è®¾æ–½è¦æ±‚
<span class="hljs-deletion">- ä½¿ç”¨ç°æœ‰VPCï¼ˆå¦‚æ»¡è¶³è¦æ±‚ï¼‰</span>
<span class="hljs-deletion">- å ¡å’æœºï¼šr6a.2xlargeï¼ŒAmazon Linux 2023ï¼Œå¼€æ”¾22ç«¯å£</span>
<span class="hljs-deletion">- Auroraé›†ç¾¤ï¼š3.10ç‰ˆæœ¬ï¼Œ2ä¸ªå®ä¾‹åˆ†åˆ«ä¸º db.r6g.2xlarge(ä¸»),  db.r8g.2xlarge</span>
<span class="hljs-deletion">- å®‰å…¨ç»„ï¼šå…è®¸å ¡å’æœºè®¿é—®Auroraï¼ˆ3306ç«¯å£ï¼‰</span>

## è½¯ä»¶å®‰è£…è¦æ±‚ï¼ˆå…³é”®æ”¹è¿›ï¼‰
<span class="hljs-deletion">- å ¡å’æœºè½¯ä»¶åŒ…ï¼š</span>
  * MySQLå®¢æˆ·ç«¯ï¼šä½¿ç”¨ mariadb105 (Amazon Linux 2023å…¼å®¹)
  * sysbenchï¼šä»æºç ç¼–è¯‘å®‰è£…ï¼Œéœ€è¦å…ˆå®‰è£…Development Toolså’Œmariadb105-devel
  * ç¼–è¯‘ä¾èµ–ï¼šgit, automake, libtool, openssl-devel
<span class="hljs-deletion">- å®‰è£…é¡ºåºï¼šå…ˆå®‰è£…ä¾èµ–åŒ… â†’ ç¼–è¯‘sysbench â†’ éªŒè¯å®‰è£…</span>
<span class="hljs-deletion">- æµ‹è¯•ç¨‹åºï¼š~/Documents/VSCodeFolder/tanzhenç›®å½•ä¸‹</span>
    aurora_failover_monitor_3probes-v2.py - åŒ…æ‹¬MySQLè¯»/å†™/DNSæ£€æµ‹çš„3æ¢é’ˆéªŒè¯å·¥å…·ï¼›
    aurora_config.json - æµ‹è¯•çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬é›†ç¾¤/ç”¨æˆ·å/å¯†ç /è¶…æ—¶è®¾ç½®ç­‰ï¼›
    generate_html_report.py - HTMLæŠ¥å‘Šç”Ÿæˆå·¥å…·ï¼›
    README.md - æ¢é’ˆå·¥å…·ä»‹ç»
    aurora_probe_round2_20250918.jsonl - ä¹‹å‰çš„æµ‹è¯•æ—¥å¿—
    aurora_failover_report_round2.html - ä¹‹å‰çš„åˆ†ææŠ¥å‘Š

## æµ‹è¯•æ‰§è¡Œè¦æ±‚
<span class="hljs-deletion">- æµ‹è¯•å¹¶å‘ï¼šä½¿ç”¨æµ‹è¯•ç¨‹åºæ¨¡æ‹Ÿ200ä¸ªä¼šè¯ä»å ¡å’æœºè¿æ¥åˆ°Auroraé›†ç¾¤</span>
<span class="hljs-deletion">- æµ‹è¯•æ–¹æ³•ï¼šåœ¨é¢„çƒ­30ç§’ä¹‹åï¼Œå‘èµ·èŠ‚ç‚¹åˆ‡æ¢ï¼Œä»r6gåˆ‡æ¢åˆ°r8gï¼Œç¨‹åºç»§ç»­è¿è¡Œ1åˆ†é’Ÿ</span>
<span class="hljs-deletion">- æµ‹è¯•è¯„ä¼°ï¼šæ ¹æ®aurora_failover_monitor_3probes-v2.pyçš„ä¼šè¯ä¿¡æ¯åˆ†æ200ä¸ªä¼šè¯å—å½±å“çš„æƒ…å†µï¼ŒåŒ…æ‹¬å—å½±å“çš„æ—¶é—´ç‚¹ï¼Œå½±å“çš„æ“ä½œï¼Œæ¢å¤çš„æ—¶é—´ï¼Œä»¥åŠåˆ‡æ¢è¿‡ç¨‹ä¸­ä¼šè¯çš„å¼‚å¸¸æƒ…å†µï¼šä¸­æ–­/è¶…æ—¶/é‡è¿ç­‰æƒ…å†µ</span>

## æŠ¥å‘Šè¾“å‡º
1.ä½¿ç”¨htmlè¾“å‡ºæŠ¥å‘Šï¼Œéœ€è¦Chartæ¸²æŸ“è¯·ä½¿ç”¨ä¸­å›½åŒºçš„echartsï¼›
2.å†…å®¹åŒ…æ‹¬ï¼šå®éªŒè®¾è®¡ï¼Œç¯å¢ƒé…ç½®ï¼Œæ“ä½œæ—¶åºå›¾ï¼Œä¼šè¯éšæ—¶é—´å±•ç¤ºå—å½±å“çš„çš„æƒ…å†µï¼ŒåŒ…æ‹¬æŠ¥é”™/è¶…æ—¶/ä¸­æ–­/æ¢å¤ç­‰æƒ…å†µï¼›
3.ç»™å‡ºåˆ‡æ¢å¯¹äºé«˜å¹¶å‘ä¸šåŠ¡çš„å½±å“æ¨¡å¼æè¿°ï¼Œæ¶ˆé™¤å®¢æˆ·å¯¹ä¸šåŠ¡å½±å“çš„é¡¾è™‘ï¼›
</code></pre>
<h2 data-id="heading-20">4.å‡çº§æ–¹æ¡ˆé€‰æ‹©ä¸å‡çº§è¿‡ç¨‹</h2>
<p>å€ŸåŠ©äºä¸Šé¢çš„æŠ€æœ¯éªŒè¯ï¼Œæˆ‘ä»¬å¯¹å°†ç”Ÿäº§ç¯å¢ƒåˆ‡æ¢åˆ°Auroraçš„Graviton4æœºå‹æ›´åŠ æœ‰ä¿¡å¿ƒäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å‡çº§æ–¹æ¡ˆçš„é€‰æ‹©ï¼Œå› ä¸ºæˆ‘ä»¬çš„Aurora MySQLæ•°æ®åº“çš„ä¸»è¦ç‰ˆæœ¬åœ¨3.04ä¸Šï¼Œéœ€è¦å‡çº§åˆ°Aurora 3.10 LTSç‰ˆæœ¬ã€‚</p>
<p>åœ¨å‡çº§æ–¹æ¡ˆçš„é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Q CLIç”ŸæˆåŸºæœ¬çš„æ–¹æ¡ˆå»ºè®®ï¼Œä½†åŒæ—¶æˆ‘ä»¬éœ€è¦è€ƒè™‘åˆ°ç›®å‰çš„ç”Ÿäº§å®å†µï¼ŒæŠŠä¸å¸¸ç”¨çš„æ–¹æ¡ˆå‰”é™¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»å¤šä¸ªç»´åº¦å¯¹æ¯”3å¥—å‡çº§æ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-21">4.1å‡çº§æ–¹æ¡ˆé€‰æ‹©</h3>
<h4 data-id="heading-22">4.1.1æ–¹æ¡ˆ1 â€“ è“ç»¿éƒ¨ç½²(æ¨è)</h4>
<p><strong>å»ºè®®æ–¹å¼ï¼š å¯¹äºå‡çº§æ”¯æŒï¼ŒAuroraæä¾›äº†è“ç»¿éƒ¨ç½²ï¼Œå®ƒå°†è‡ªåŠ¨åˆ›å»ºç»¿ç¯å¢ƒ(ç›®æ ‡ç¯å¢ƒ)ï¼Œå¹¶è‡ªåŠ¨åŒæ­¥æ•°æ®ä¿®æ”¹ï¼Œæœ€ç»ˆæŒ‰ç…§æŒ‡ä»¤å®ŒæˆDNSæŒ‡å‘çš„åˆ‡æ¢ã€‚ã€‚</strong></p>
<p>ä»¥ä¸‹æ˜¯åˆ‡æ¢çš„æ ¸å¿ƒä»£ç ï¼Œä¾›å‚è€ƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Shell
<span class="hljs-number">1.</span> åˆ›å»ºè“ç»¿éƒ¨ç½²
aws rds create-blue-green-deployment \
  --blue-green-deployment-name <span class="hljs-string">"aurora-upgrade"</span> \
  --source <span class="hljs-string">"arn:aws:rds:region:account:cluster:source-cluster"</span> \
  --target-engine-version <span class="hljs-string">"8.0.mysql_aurora.3.10.0"</span>

<span class="hljs-number">2.</span> å‡çº§ç»¿ç¯å¢ƒå®ä¾‹åˆ°R8g
aws rds modify-db-instance \
  --db-instance-identifier <span class="hljs-string">"green-instance-id"</span> \
  --db-instance-<span class="hljs-keyword">class</span> <span class="hljs-string">"db.r8g.xlarge"</span>

<span class="hljs-number">3.</span> æ‰§è¡Œåˆ‡æ¢
aws rds switchover-blue-green-deployment \
  --blue-green-deployment-identifier <span class="hljs-string">"deployment-id"</span>
</code></pre>
<h4 data-id="heading-23">4.1.2æ–¹æ¡ˆ2 â€“ åŸåœ°å‡çº§</h4>
<p><strong>ç›´æ¥åœ¨åŸé›†ç¾¤ä¸Šä¸²è¡Œæ‰§è¡Œç‰ˆæœ¬å‡çº§å’Œç¡¬ä»¶å‡çº§ï¼Œè¯»å†™ä¸šåŠ¡ä¼šå—å½±å“ï¼Œå‡çº§åæ— æ³•å›é€€ã€‚</strong></p>
<p>ä»¥ä¸‹æ˜¯åŸåœ°å‡çº§çš„æ ¸å¿ƒä»£ç ï¼Œä¾›å‚è€ƒï¼š</p>
<pre><code class="hljs language-css" lang="css">Shell
<span class="hljs-number">1</span>. å‡çº§å¼•æ“ç‰ˆæœ¬
aws rds modify-db-cluster \
  <span class="hljs-attr">--db-cluster-identifier</span> "cluster-name" \
  <span class="hljs-attr">--engine-version</span> "<span class="hljs-number">8.0</span><span class="hljs-selector-class">.mysql_aurora</span>.<span class="hljs-number">3.10</span>.<span class="hljs-number">0</span>" \
  <span class="hljs-attr">--apply-immediately</span>

<span class="hljs-number">2</span>. å‡çº§å®ä¾‹ç±»å‹
aws rds modify-db-instance \
  <span class="hljs-attr">--db-instance-identifier</span> "instance-name" \
  <span class="hljs-attr">--db-instance-class</span> "db<span class="hljs-selector-class">.r8g</span><span class="hljs-selector-class">.xlarge</span>" \
  <span class="hljs-attr">--apply-immediately</span>
</code></pre>
<h4 data-id="heading-24">4.1.3æ–¹æ¡ˆ3 â€“ è¯»å¤æœ¬æå‡</h4>
<p><strong>åˆ›å»ºè·¨åŒºåŸŸè¯»å‰¯æœ¬é›†ç¾¤(æ–°ç‰ˆæœ¬+æ–°ç¡¬ä»¶)ï¼Œæå‡ä¸ºç‹¬ç«‹é›†ç¾¤åæ‰‹åŠ¨åˆ‡æ¢åº”ç”¨è¿æ¥ã€‚è¯¥ç‰¹æ€§ç›®å‰åªåœ¨3.10ä¸Šæ”¯æŒã€‚</strong></p>
<p>ä»¥ä¸‹æ˜¯è¯»å¤æœ¬æå‡çš„æ ¸å¿ƒä»£ç ï¼Œä¾›å‚è€ƒï¼š</p>
<pre><code class="hljs language-lua" lang="lua">Shell
<span class="hljs-number">1.</span> åˆ›å»ºè·¨åŒºåŸŸè¯»å‰¯æœ¬(æ–°ç‰ˆæœ¬)
aws rds <span class="hljs-built_in">create</span>-db-cluster \
  <span class="hljs-comment">--db-cluster-identifier "replica-cluster" \</span>
  <span class="hljs-comment">--engine-version "8.0.mysql_aurora.3.10.0" \</span>
  <span class="hljs-comment">--replication-source-identifier "source-cluster-arn"</span>

<span class="hljs-number">2.</span> æ·»åŠ R8gå®ä¾‹
aws rds <span class="hljs-built_in">create</span>-db-instance \
  <span class="hljs-comment">--db-cluster-identifier "replica-cluster" \</span>
  <span class="hljs-comment">--db-instance-class "db.r8g.xlarge"</span>

<span class="hljs-number">3.</span> æå‡ä¸ºç‹¬ç«‹é›†ç¾¤
aws rds promote-<span class="hljs-built_in">read</span>-replica-db-cluster \
  <span class="hljs-comment">--db-cluster-identifier "replica-cluster"</span>
</code></pre>
<h4 data-id="heading-25">4.1.4ä¸‰ç§æ–¹æ¡ˆçš„å¯¹æ¯”</h4>
<p>å€ŸåŠ©äºQ CLIæˆ‘ä»¬å¯ä»¥å¯¹ä¸‰ç§å…¸å‹çš„å‡çº§æ–¹æ¡ˆè¿›è¡Œå¤šç»´åº¦çš„å¯¹æ¯”ï¼Œå¯¹æ¯”ç»´åº¦åŒ…æ‹¬åœæœºæ—¶é—´/æ•°æ®å®‰å…¨/å›æ»šèƒ½åŠ›ï¼Œä»¥åŠé€‚ç”¨çš„åº”ç”¨åœºæ™¯ç­‰ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f919c7f1ac5478db0440d4dab43108a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=PDDaF9CsJ4waIBM1PJOGnwjv2UQ%3D" alt="15.webp" loading="lazy"/></p>
<p>æ ¹æ®ç›®å‰æˆ‘ä»¬è¿‡å»çš„ç”Ÿäº§å®è·µï¼Œç»“åˆä¸šåŠ¡åœæœºæ—¶é—´è¦æ±‚ï¼Œæˆ‘ä»¬å°†é€‰æ‹©è“ç»¿éƒ¨ç½²æ¥å®ç°æ•°æ®åº“çš„å‡çº§å’Œåˆ‡æ¢ã€‚</p>
<h3 data-id="heading-26">4.2åº”ç”¨åˆ‡æ¢æ–¹æ¡ˆ</h3>
<p>å€ŸåŠ©äºä¸Šé¢çš„æŠ€æœ¯éªŒè¯ç»“è®ºï¼Œåº”ç”¨ç¨‹åºåœ¨å®ä¾‹åˆ‡æ¢æ—¶æ¢å¤çš„é€Ÿåº¦å’ŒDNSçš„å˜åŒ–æ„ŸçŸ¥æœ‰ç›´æ¥å…³ç³»ï¼Œæˆ‘ä»¬å¯¹ç°æœ‰çš„åº”ç”¨è¿›è¡Œæ¢³ç†åï¼Œå°†åº”ç”¨åˆ†ä¸ºä¸¤ç±»åœºæ™¯ï¼šå¦‚æœä¸€ä¸ªåº”ç”¨å…·å¤‡ä¸»åŠ¨çš„DNSå˜åŒ–æ£€æµ‹èƒ½åŠ›ï¼Œå®ƒåœ¨è¿æ¥é‡å»ºä¸Šå°†æ˜¯æœ€æœ‰æ•ˆçš„ã€‚å¦‚æœåº”ç”¨ä¸å…·å¤‡è¿™æ ·çš„æ£€æµ‹èƒ½åŠ›ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»“åˆæ‰‹å·¥reloadé…ç½®æ–‡ä»¶çš„æ–¹å¼å®ç°åº”ç”¨çš„å¿«é€Ÿåˆ‡æ¢ã€‚</p>
<p>æ ¹æ®è¿™ä¸ªå› ç´ æˆ‘ä»¬å°†ç”Ÿäº§çš„ä¸šåŠ¡åˆ†ä¸ºä¸¤ç±»åœºæ™¯ï¼š</p>
<ul>
<li>åœºæ™¯1 â€“ ä»¥golangä¸ºå®¢æˆ·ç«¯çš„æ•°æ®åº“ä¸­é—´å±‚ï¼Œå…·å¤‡DNSå˜åŒ–æ£€æµ‹èƒ½åŠ›</li>
<li>åœºæ™¯2 â€“ ä»¥ngx+luaä¸ºå®¢æˆ·ç«¯çš„ä¸šåŠ¡ä¸­é—´å±‚ï¼Œä¸å…·å¤‡DNSå˜åŒ–æ£€æµ‹èƒ½åŠ›</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac11be3750624188836d3dc9f7ccc6ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=mCYvOIO2VniFEOZN5SbXseoRJ%2FM%3D" alt="16.webp" loading="lazy"/></p>
<p>æ ¹æ®æˆ‘ä»¬çš„ç”Ÿäº§å®è·µï¼Œè¿™æ ·çš„åŒºåˆ†åº”ç”¨åœºæ™¯çš„åˆ‡æ¢è™½ç„¶ç¨ç¨å¢åŠ è¿ç»´å·¥ä½œé‡ï¼Œä½†å®ƒå¯ä»¥è®©åº”ç”¨ç¨‹åºåœ¨10sä¹‹å†…å¿«é€Ÿçš„æ¢å¤ï¼Œè¿™æ ·çš„åˆ‡æ¢æ•ˆç‡æ˜¯ç›¸å½“é«˜çš„ã€‚</p>
<h4 data-id="heading-27">4.2.1åœºæ™¯1 â€“ ä»¥golangä¸ºå®¢æˆ·ç«¯çš„æ•°æ®åº“ä¸­é—´å±‚</h4>
<p>èƒ½è‡ªä¸»è¯†åˆ«RDSåŸŸååç«¯IPåœ°å€å˜åŠ¨ï¼Œè¯¥åœºæ™¯ä¸‹ï¼Œåœ¨è“ç»¿åˆ‡æ¢åï¼Œå®¢æˆ·ç«¯ä¼šç«‹å³å°†90%åˆ°100%çš„è¿æ¥åˆ‡æ¢åˆ°ç»¿å®ä¾‹ï¼Œåœ¨åŸŸåç¨³å®šå(çº¦30ç§’)ï¼Œreloadå®¢æˆ·ç«¯ï¼Œå®Œæˆå‰©ä½™è¿æ¥åˆ‡æ¢ã€‚</p>
<h4 data-id="heading-28">4.2.2åœºæ™¯2 â€“ ä»¥ngx+luaä¸ºå®¢æˆ·ç«¯çš„ä¸šåŠ¡ä¸­é—´å±‚</h4>
<p>ä¸èƒ½è‡ªä¸»è¯†åˆ«RDSåŸŸååç«¯IPåœ°å€å˜åŠ¨ï¼Œéœ€è¦æå‰è§£æipï¼Œç„¶ååœ¨é…ç½®ä¸­å¿ƒæ›´æ–°ipï¼Œåœ¨è“ç»¿åˆ‡æ¢åï¼Œå®Œæˆä¸€è‡´æ€§æ ¡éªŒï¼Œè“åªè¯»ï¼Œç»¿å¯å†™ï¼Œçº¦5ç§’å†…ï¼Œreload ngxï¼Œå®ç°å¿«é€Ÿåˆ‡æ¢ã€‚</p>
<h3 data-id="heading-29">4.3Â å®Œæ•´çš„å‡çº§è¿‡ç¨‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1f3adb2e71e407c8b6bf62f648bb396~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=m6XobEAhi%2F2nlun05BGFr054v44%3D" alt="17.webp" loading="lazy"/></p>
<p>ç»“åˆæˆ‘ä»¬å¯¹åˆ‡æ¢è¿‡ç¨‹æœ€ä½³å®è·µçš„äº†è§£ï¼Œå¯ä»¥ä½¿ç”¨Q CLIå¯¹æ•´ä¸ªå‡çº§è¿‡ç¨‹åšæ¢³ç†ï¼ŒæŠŠç›¸å…³å·¥ä½œæŒ‰é˜¶æ®µåˆ’åˆ†ï¼Œå¯ä»¥ä¸ºæˆ‘ä»¬ç”Ÿæˆæ¸…æ™°çš„drawioæ ¼å¼çš„å‡çº§ä¸åˆ‡æ¢è¿‡ç¨‹çš„å±•ç¤ºã€‚</p>
<p>åœ¨æŠ€æœ¯éªŒè¯å’Œæ–¹æ¡ˆæ•´ç†ä¸Šï¼ŒQ CLIæ˜¯éå¸¸å¾—åŠ›çš„åŠ©åŠ›ï¼Œå¯ä»¥ä¸ºæˆ‘ä»¬æå‡æ•°å€çš„å·¥ä½œæ•ˆç‡ã€‚åœ¨ç”Ÿäº§é›†ç¾¤çš„å‡çº§åˆ‡æ¢é˜¶æ®µï¼Œæˆ‘ä»¬ä¸ºäº†æœ€å¤§ç¨‹åº¦çš„è¿‡ç¨‹å¯æ§æ€§ï¼Œä»ç„¶ä½¿ç”¨Consoleæ–¹å¼æ¥å®ç°é›†ç¾¤çš„å‡çº§å’Œåˆ‡æ¢ã€‚</p>
<h4 data-id="heading-30">4.3.1å¼€å¯Binlog</h4>
<p>å¦‚æœåœ¨åˆæ¬¡ä½¿ç”¨è“ç»¿éƒ¨ç½²ï¼Œå› ä¸ºBinlogä¸ºé™æ€å‚æ•°ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°éœ€è¦å®ä¾‹é‡å¯ï¼Œè¯·æ³¨æ„ã€‚</p>
<h4 data-id="heading-31">4.3.2åˆ›å»ºè“ç»¿éƒ¨ç½²</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c184cc4dcb80432db13dcd0c1d0f0468~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=HCuBXPd8KxWwMEPXiYviAIez6sI%3D" alt="18.webp" loading="lazy"/></p>
<h4 data-id="heading-32">4.3.3ç¡®è®¤å¹¶åˆ›å»º</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62814ca1e9e14aefbaabd289221bad09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=kBqFVWp8m7vpTJL0FRhsceyIuC8%3D" alt="19.webp" loading="lazy"/></p>
<h4 data-id="heading-33">4.3.4åˆ›å»ºå®Œæˆ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0be9dd194c5641e39a2772846b07836a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=flwchQP23F2%2BfXcPSfcvyKMKqbM%3D" alt="20.webp" loading="lazy"/></p>
<h4 data-id="heading-34">4.3.5ä¿®æ”¹ç»¿å®ä¾‹ç±»å‹</h4>
<p>ç»¿ç¯å¢ƒåˆ›å»ºåï¼Œæ‰‹åŠ¨åœæ­¢å¤åˆ¶(CALL mysql.rds_stop_replication; show slave status\G)ï¼Œè®°å½•å¤åˆ¶ä½ç½®ä¿¡æ¯ï¼Œå•ç‹¬ä¿®æ”¹å®ä¾‹ç±»å‹:</p>
<pre><code class="hljs language-scss" lang="scss">Plain Text
aws rds modify-db-instance \
<span class="hljs-attr">--db-instance-identifier</span> "green-cluster-instance-name" \
<span class="hljs-attr">--db-instance-class</span> "db<span class="hljs-selector-class">.r8g</span><span class="hljs-selector-class">.large</span>" \
<span class="hljs-attr">--apply-immediately</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d09b75b7c043471a89363975b279c9b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=Phv2ZDTlb2fe%2Be2aF7b0uIoa83g%3D" alt="21.webp" loading="lazy"/></p>
<h4 data-id="heading-35">4.3.6æ¢å¤BinlogåŒæ­¥</h4>
<p>å®ä¾‹ç±»å‹ä¿®æ”¹æˆåŠŸåï¼ŒéªŒè¯å¤åˆ¶ä½ç½®ï¼Œæ‰‹åŠ¨å¯åŠ¨å¤åˆ¶(show slave status\G; CALL mysql.rds_start_replication;)éªŒè¯æ•°æ®åŒæ­¥åï¼Œå®‰æ’çª—å£æ‰§è¡Œåˆ‡æ¢ã€‚</p>
<h4 data-id="heading-36">4.3.7è“ç»¿é›†ç¾¤åˆ‡æ¢</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fda579b9ee14ba38260447b01b0a671~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=M1p71jG7xFlxYjN2JkgehlrVoGI%3D" alt="22.webp" loading="lazy"/></p>
<h4 data-id="heading-37">4.3.8æ‰§è¡Œåº”ç”¨åˆ‡æ¢</h4>
<p>æ ¹æ®4.2çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬åŒºåˆ†ä¸åŒåº”ç”¨åœºæ™¯å®Œæˆåº”ç”¨é…ç½®çš„reloadï¼Œæ­¤å¤„éœ€è¦ç¡®è®¤åº”ç”¨æ“ä½œçš„æ­£ç¡®æ€§ã€‚</p>
<h4 data-id="heading-38">4.3.9åˆ é™¤æ—§é›†ç¾¤</h4>
<p>å…ˆå…³é—­é›†ç¾¤åˆ é™¤ä¿æŠ¤ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆ–consoleå®Œæˆæ—§é›†ç¾¤çš„åˆ é™¤ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SQL</span>
aws rds <span class="hljs-keyword">delete</span><span class="hljs-operator">-</span>db<span class="hljs-operator">-</span>instance \
  <span class="hljs-comment">--db-instance-identifier aurora-test-304-traditional-instance-old1 \</span>
  <span class="hljs-comment">--region us-east-1</span>

aws rds <span class="hljs-keyword">delete</span><span class="hljs-operator">-</span>db<span class="hljs-operator">-</span>cluster \
  <span class="hljs-comment">--db-cluster-identifier aurora-test-304-traditional-old1 \</span>
  <span class="hljs-comment">--region us-east-1 \</span>
  <span class="hljs-comment">--skip-final-snapshot</span>
</code></pre>
<h3 data-id="heading-39">4.4å‡çº§è¿‡ç¨‹ä¸­çš„å…³æ³¨ç‚¹</h3>
<p>æˆ‘ä»¬åœ¨ç”Ÿäº§é›†ç¾¤çš„å‡çº§åˆ‡æ¢å½“ä¸­ï¼Œåœ¨åŒæ­¥ç¯èŠ‚æ›¾ç»é‡åˆ°Relay Logå †ç§¯çš„æƒ…å†µï¼Œæˆ‘ä»¬å€ŸåŠ©äºä¼ä¸šæœåŠ¡ï¼Œåœ¨TAMçš„ååŠ©ä¸‹ï¼Œå¿«é€Ÿçš„å®šä½åŸå› ï¼Œå¹¶å®æ–½çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œè¿™ä½¿åŒæ­¥å»¶è¿Ÿå¿«é€Ÿçš„è§£å†³ï¼Œç¡®ä¿äº†åº”ç”¨åˆ‡æ¢å‰è“ç»¿é›†ç¾¤å¯ä»¥è¾¾åˆ°åŒæ­¥çŠ¶æ€ã€‚</p>
<h4 data-id="heading-40">4.4.1åŒæ­¥å»¶è¿Ÿçš„ä¼˜åŒ–</h4>
<ul>
<li>binlog_transaction_dependency_tracking=WRITESET (æºåº“è·Ÿç›®æ ‡åº“éƒ½è¦è®¾ç½®)</li>
</ul>
<p>è¿™ä¸ªå‚æ•°å¯ä»¥éå¸¸æœ‰æ•ˆå’Œæé«˜å¤åˆ¶æ•ˆèƒ½ï¼š</p>
<p>a. æ›´ç²¾ç¡®åœ°è¯†åˆ«äº‹åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»<br/>
b. å…è®¸ä¸ç›¸å…³çš„äº‹åŠ¡å¹¶è¡Œæ‰§è¡Œ<br/>
c. å‡å°‘å¤åˆ¶å»¶è¿Ÿ<br/>
d. æ”¹å–„å¹¶è¡Œå¤åˆ¶</p>
<ul>
<li>aurora_binlog_replication_sec_index_parallel_workers=8</li>
</ul>
<p>åœ¨Aurora MySQL 3.06åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå½“å¤åˆ¶å…·æœ‰å¤šä¸ªäºŒçº§ç´¢å¼•çš„å¤§è¡¨äº‹åŠ¡æ—¶ï¼Œé€šè¿‡è¯¥ç‰¹æ€§å¼•å…¥çº¿ç¨‹æ± ï¼Œåœ¨äºŒè¿›åˆ¶æ—¥å¿—å‰¯æœ¬ä¸Šå¹¶è¡Œåº”ç”¨äºŒçº§ç´¢å¼•è¿›è¡Œå˜æ›´ï¼Œæœ‰æ•ˆæå‡åŒæ­¥é€Ÿåº¦</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2a40633956842cc90f02d9817af7342~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=UH9rVcgn9ZT%2B7rQXXK5qLfjdxbQ%3D" alt="23.webp" loading="lazy"/></p>
<h4 data-id="heading-41">4.4.2å…¶å®ƒå‚æ•°ä¼˜åŒ–</h4>
<ul>
<li>å…³é—­Aurora 3.10çš„æ–°ç‰¹æ€§Memory Relaylog ï¼šaurora_in_memory_relaylog=OFF</li>
</ul>
<p>é¿å…ç»¿å®ä¾‹æŠ¥é”™ï¼šcanâ€™t find relay log</p>
<p>å‚æ•°çš„åŠŸèƒ½æè¿°è¯·å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2FAmazonRDS%2Flatest%2FAuroraUserGuide%2Fbinlog-optimization.html" target="_blank" title="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/binlog-optimization.html" ref="nofollow noopener noreferrer">docs.aws.amazon.com/AmazonRDS/lâ€¦</a></p>
<h2 data-id="heading-42">5.å‡çº§åçš„è¿è¡Œæ•ˆæœ</h2>
<p>æˆ‘ä»¬åœ¨9æœˆ9å·éå¸¸é¡ºåˆ©çš„å®Œæˆäº†Auroraæ•°æ®åº“çš„åˆ‡æ¢ï¼Œä»æŒ‰ä¸‹æ¥ä¸€å‘¨çš„ç³»ç»Ÿè´Ÿè½½æ•°æ®çœ‹ï¼ŒCPUè´Ÿè½½å’Œäº‹åŠ¡æäº¤/DMLå»¶è¿Ÿéƒ½æœ‰è¿‘50%çš„ä¸‹é™ï¼Œè¿™ä¹Ÿå’Œæˆ‘ä»¬ä¹‹å‰çš„æŠ€æœ¯éªŒè¯ç»“æœå®Œå…¨å»åˆã€‚</p>
<h3 data-id="heading-43">5.1æ—¥é—´CPUé«˜å³°è´Ÿè½½ä¸‹é™è¿‘ä¸€åŠ(47%)</h3>
<p>9æœˆ9å·0æ—¶ï¼Œæˆ‘ä»¬å®Œæˆäº†æ•°æ®åº“å®ä¾‹å’ŒAurora 3.10+Graviton4æœºå‹çš„è¿ç§»ï¼Œ8å·ä¸9å·çš„ä¸šåŠ¡è´Ÿè½½æ¨¡å¼å…¶å®æ˜¯ç›¸åŒçš„(ä¸ºå·¥ä½œæ—¥æ¨¡å¼ï¼Œ7å·ä¸ºå‘¨æœ«æ¨¡å¼)ï¼Œæ‰€ä»¥ä»ç³»ç»Ÿçš„å³°å€¼çš„å˜åŒ–å¯ä»¥å¾—åˆ°å¼•å…¥Aurora 3.10+Graviton4å¸¦æ¥çš„è´Ÿè½½å˜åŒ–ï¼šCPUçš„æ—¥é—´å³°å€¼ä»8å·çš„50%ä¸‹é™åˆ°9å·çš„27%å·¦å³ï¼Œé™å¹…ä¸º47%ï¼›CPUçš„å‡Œæ™¨é«˜å³°ä»64%ä¸‹é™åˆ°52%ï¼Œé™å¹…ä¸º19%ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f61448da4c1b46f39bfb5d576f83c839~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=OCBCY9M60a870wCbw73pqBe9AmQ%3D" alt="24.webp" loading="lazy"/></p>
<h3 data-id="heading-44">5.2æ—¥é—´æäº¤/DMLLatencyé™ä½50%</h3>
<p>åŒæ ·çš„ï¼Œæˆ‘ä»¬æ¥çœ‹äº‹åŠ¡æäº¤å»¶è¿Ÿï¼Œæ—¥é—´æœ€å¤§æäº¤Latencyä»8å·çš„5msä¸‹é™åˆ°2.5msï¼Œä¸‹é™å¹…åº¦ä¸º50%ï¼Œå‡Œæ™¨çš„æœ€å¤§æäº¤Latencyä»9å·çš„27msä¸‹é™åˆ°5msï¼Œä¸‹é™å¹…åº¦ä¸º81%ã€‚</p>
<p>å¯¹äºDMLå»¶è¿Ÿä¹Ÿæœ‰ç›¸å½“æ˜æ˜¾çš„è¡¨ç°ï¼Œæ—¥é—´æœ€å¤§DMLå»¶è¿Ÿä»8å·çš„2msä¸‹é™åˆ°1.7msï¼Œä¸‹é™å¹…åº¦ä¸º30%ã€‚å‡Œæ™¨DMLå»¶è¿Ÿä»8å·çš„3msä¸‹é™åˆ°1msï¼Œä¸‹é™å¹…åº¦ä¸º60%ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/606c453ec24a45c983a081b1cc0e1122~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=LeR0e3uv9a%2B%2BEt2coRldC9XIFW4%3D" alt="25.webp" loading="lazy"/></p>
<h2 data-id="heading-45">6. å›é¡¾ä¸æ€»ç»“</h2>
<p>ä½œä¸ºä»Šå¹´è¿ç»´å·¥ä½œçš„é‡è¦éƒ¨åˆ†ï¼Œåœ¨è¿‡å»çš„2ä¸ªæœˆï¼Œæˆ‘ä»¬å®Œæˆäº†å¯¹Graviton4çš„æ€§èƒ½éªŒè¯ï¼Œç”Ÿäº§ä¸šåŠ¡æ¨¡æ‹Ÿçš„åˆ‡æ¢éªŒè¯ï¼Œä»¥åŠAuroraçš„ç‰ˆæœ¬é€‰æ‹©å’Œç”Ÿäº§ç¯å¢ƒå®Œæˆå‡çº§ï¼Œè€ŒQ CLIä¹Ÿæä¾›äº†ç›´æ¥æˆ–é—´æ¥çš„æ”¯æŒã€‚</p>
<h3 data-id="heading-46">6.1 Aurora 3.10ä¸Graviton4æœºå‹çš„ç»¼åˆè¡¨ç°</h3>
<p>ä»æœ€ç»ˆçš„ç”Ÿäº§ç³»ç»Ÿçš„è´Ÿè½½ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºAuroraçš„Graviton4æœºå‹çš„å¼•å…¥ç›¸å½“æ˜æ˜¾æŠŠCPUä½¿ç”¨ç‡é™ä½äº†47%ï¼Œäº‹åŠ¡æäº¤å’ŒDMLå»¶è¿Ÿä¹Ÿé™ä½äº†è¿‘50%ï¼Œè¿™æ„å‘³ç€Auroraé›†ç¾¤åœ¨æˆæœ¬æ²¡æœ‰æ˜¾è‘—å¢åŠ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ºä¸šåŠ¡æä¾›è¿‘1å€çš„æ•°æ®åº“è®¡ç®—èƒ½åŠ›ã€‚</p>
<p>Aurora 3.10ç‰ˆæœ¬ä¸ºä¸šåŠ¡æä¾›äº†æ¯”å¸¸è§„ç‰ˆæœ¬æ›´é•¿æœŸçš„æ”¯æŒå‘¨æœŸï¼Œæ¥è¿‘3å¹´ï¼Œè¿™ä¹Ÿæ„å‘³ç€æ›´å°‘çš„åœæœºæ—¶é—´ï¼Œæ›´å°‘çš„ä¸šåŠ¡ä¸­æ–­å’Œæ›´ä½çš„è¿ç»´æˆæœ¬ã€‚</p>
<h3 data-id="heading-47">6.2 TAMä¸Q CLIåœ¨æ–¹æ¡ˆè½åœ°è¿‡ç¨‹ä¸­çš„ä»·å€¼ä½“ç°</h3>
<p>åœ¨æœ¬é¡¹ç›®ä¸­Amazon Q CLIä»¥å‡ºè‰²çš„æ¶æ„æ„ŸçŸ¥å’Œæ“æ§èƒ½åŠ›ï¼Œç›¸å½“å¤§ç¨‹åº¦ä¸ŠåŠ é€Ÿäº†æŠ€æœ¯éªŒè¯ï¼Œç‰ˆæœ¬åˆ†æï¼Œæ–¹æ¡ˆå¯¹æ¯”ç­‰å·¥ä½œï¼š</p>
<ul>
<li><strong>TAM</strong> <strong>æœ‰åŠ›çš„æ”¯æŒ â€“</strong> åœ¨æŠ€æœ¯éªŒè¯å’Œç”Ÿäº§é›†ç¾¤çš„åˆ‡æ¢æœŸé—´ï¼Œä¼ä¸šæœåŠ¡å›¢é˜Ÿçš„TAMä»å‰æœŸçš„æŠ€æœ¯éªŒè¯ï¼Œåˆ°åæœŸçš„åˆ‡æ¢è¿‡ç¨‹çš„å¤åˆ¶ä¼˜åŒ–ï¼Œä½“ç°äº†TAMè‡ªèº«æ‰å®çš„æŠ€æœ¯èƒ½åŠ›ï¼Œå¹¶ä¸”ä¸ºå®¢æˆ·å‘å£°ï¼Œé«˜æ•ˆçš„åè°ƒå‰åç«¯å›¢é˜Ÿï¼Œæä¾›äº†è®¸è®¸å¤šå¤šæ€è·¯ï¼Œè§£å†³äº†ä¼—å¤šæŠ€æœ¯ç–‘éš¾é—®é¢˜ï¼›</li>
<li><strong>æ€§èƒ½ä¸åˆ‡æ¢åœºæ™¯éªŒè¯ â€“</strong> åœ¨æµ‹è¯•æ–¹æ¡ˆè®¾è®¡ï¼Œæ–¹æ¡ˆè¡¥å……ï¼Œä»¥åŠç¯å¢ƒæ­å»ºï¼Œæµ‹è¯•å·¥å…·ç”Ÿæˆï¼Œæµ‹è¯•æ•°æ®åˆ†æä¸æŠ¥å‘Šæ•´ç†ï¼ŒQ CLIå¯ä»¥æä¾›éå¸¸å¥½çš„ååŠ©ï¼Œæ˜¾è‘—ç¼©çŸ­æµ‹è¯•å‘¨æœŸï¼Œä¸ºç”Ÿäº§åˆ‡æ¢åšæŠ€æœ¯å‡†å¤‡ï¼Œè®©åˆ‡æ¢æ›´æœ‰ä¿¡å¿ƒï¼›</li>
<li><strong>ç‰ˆæœ¬åˆ†æä¸å»ºè®® â€“</strong>Â Q CLIå¯ä»¥æ›´å¿«é€Ÿçš„ä»åœ¨çº¿æ–‡æ¡£ã€Blogã€Whatâ€™s newã€Pricing APIç­‰å®˜æ–¹èµ„æºã€é€”å¾„ä¸­æç‚¼ã€æ±‡æ€»å¤šæ–¹é¢çš„æ•°æ®ï¼Œå½¢æˆå®Œå…¨é€‚ç”¨äºåˆåˆä¿¡æ¯çš„ç‰ˆæœ¬å»ºè®®ï¼Œè¿™èŠ‚çœäº†å¤§é‡çš„äººå·¥æŸ¥é˜…çš„æ—¶é—´ï¼Œä¹Ÿæå‡äº†å‡†ç¡®æ€§ï¼›</li>
<li><strong>æ•°æ®åˆ†æä¸æŠ¥å‘Šç”Ÿæˆ â€“</strong> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Q CLIå¯¹å¤šç»´åº¦çš„æµ‹è¯•æ•°æ®è¿›è¡Œåˆ†æï¼Œå¹¶ä¸”åœ¨æ¶æ„å›¾ç”Ÿæˆï¼Œæµç¨‹å›¾ç”Ÿæˆï¼Œåˆ†ææŠ¥å‘Šå‘ˆç°å’Œæ¸²æŸ“ï¼Œè¿™äº›å·¥ä½œä¸ŠQ CLIéƒ½ä¸ºæˆ‘ä»¬å¤§å¹…åº¦æå‡äº†æ•ˆç‡ï¼Œä¹Ÿæå‡äº†äº¤ä»˜ç‰©çš„è´¨é‡ï¼›</li>
</ul>
<h3 data-id="heading-48">6.3æœªæ¥æ¢ç´¢ â€“ Q CLIåœ¨è¿ç»´åœºæ™¯çš„åº”ç”¨</h3>
<p>åœ¨æœ¬é¡¹ç›®å½“ä¸­Q CLI åœ¨æŠ€æœ¯éªŒè¯ä¸Šæ˜¯è¿ç»´åŒå­¦å¾—åŠ›çš„åŠ©æ‰‹ï¼Œæå‡çš„æ•ˆç‡ï¼Œæˆ‘ä»¬åŒæ—¶ä¹Ÿä¼šåœ¨ä»¥ä¸‹è¿ç»´åœºæ™¯ä¸­æ·±åº¦ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼š</p>
<ul>
<li><strong>è¿ç»´æ•…éšœè¯Šæ–­ â€“</strong> å€ŸåŠ©äºQ CLIå¯¹äºšé©¬é€Šäº‘ç§‘æŠ€èµ„æºçš„ç†è§£å’Œå¼ºå¤§çš„çŸ¥è¯†åº“æ”¯æ’‘ï¼ŒåŠ é€Ÿè¿ç»´æ•…éšœåˆ†æä¸è§£å†³ï¼›</li>
<li><strong>è¿ç»´çŸ¥è¯†åº“ â€“</strong> Q CLIæä¾›äº†ä¸Bedrock KnowledgeBaseäº¤äº’çš„MCP Serveræ”¯æŒï¼Œå¯ä»¥å°†è¿ç»´ä¿¡æ¯æ›´å……åˆ†çš„åœ¨å›¢é˜Ÿå†…éƒ¨åˆ†äº«ï¼›</li>
<li><strong>è¿ç»´å·¥å…·å¼€å‘ â€“</strong> Q CLIæä¾›äº†è¶Šæ¥è¶Šä¸°å¯Œçš„ä»£ç ç¼–å†™æ”¯æŒï¼Œä»Todos/Hooksåˆ°Issueçš„ç®¡ç†ï¼Œé™ä½è¿ç»´å¼€å‘é—¨æ§›ï¼›</li>
<li><strong>æ™ºèƒ½å·¡æ£€ â€“</strong> åŸºäºäºšé©¬é€Šäº‘ç§‘æŠ€åç«¯çŸ¥è¯†åº“ï¼Œå¯ä»¥å¯¹ç”Ÿäº§ã€å¼€å‘ç¯å¢ƒåšæ·±åº¦çš„æ¶æ„åˆ†æï¼Œå‘ç°æ›´å¤šå¯ä¼˜åŒ–çš„æŠ€æœ¯é¡¹ï¼Œæå‡è¿ç»´æ°´å¹³ï¼›</li>
</ul>
<p>ä»¥ä¸Šæ˜¯æˆ‘ä»¬å¯¹Q CLIåœ¨æœªæ¥è¿ç»´ä»·å€¼çš„å±•æœ›ï¼Œç›¸ä¿¡ç†Ÿç»ƒè¿ç”¨è¿™äº›å·¥å…·ï¼Œä¼šä¸æ–­æå‡æˆ‘ä»¬çš„è¿ç»´æ°´å¹³ã€è¿ç»´æ•ˆç‡ã€‚</p>
<h2 data-id="heading-49">7.æœ¬æ–‡æåˆ°çš„æŠ€æœ¯èµ„æ–™é“¾æ¥</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flvst-gh%2Fqcli-aurora-graviton4%2F" target="_blank" title="https://github.com/lvst-gh/qcli-aurora-graviton4/" ref="nofollow noopener noreferrer">github.com/lvst-gh/qclâ€¦</a><br/>
*<strong>å‰è¿°ç‰¹å®šäºšé©¬é€Šäº‘ç§‘æŠ€ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ç›¸å…³çš„æœåŠ¡ç›®å‰åœ¨äºšé©¬é€Šäº‘ç§‘æŠ€æµ·å¤–åŒºåŸŸå¯ç”¨ã€‚äºšé©¬é€Šäº‘ç§‘æŠ€ä¸­å›½åŒºåŸŸç›¸å…³äº‘æœåŠ¡ç”±è¥¿äº‘æ•°æ®å’Œå…‰ç¯æ–°ç½‘è¿è¥ï¼Œå…·ä½“ä¿¡æ¯ä»¥ä¸­å›½åŒºåŸŸå®˜ç½‘ä¸ºå‡†ã€‚</strong></p>
<p><strong>æœ¬ç¯‡ä½œè€…</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c7437c2f13e405f839259e21bbfc282~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487683&amp;x-signature=iMjFjMrWCh9q%2FASylqpnPu2%2Bvy4%3D" alt="26.webp" loading="lazy"/></p>
<blockquote>
<p>æœ¬æœŸæœ€æ–°å®éªŒä¸ºã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fevents.amazoncloud.cn%2Flabs%2Fcloudlab-amazon-q-cli-and-ide-build%3Fvisitfrom%3D3P_Juejintail_1216%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_1216" target="_blank" title="https://events.amazoncloud.cn/labs/cloudlab-amazon-q-cli-and-ide-build?visitfrom=3P_Juejintail_1216&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_1216" ref="nofollow noopener noreferrer">Agentic AI å¸®ä½ åšåº”ç”¨ â€”â€” ä»0åˆ°1æ‰“é€ è‡ªå·±çš„æ™ºèƒ½ç•ªèŒ„é’Ÿ</a>ã€‹</p>
<p>âœ¨ è‡ªç„¶è¯­è¨€ç©è½¬å‘½ä»¤è¡Œï¼Œ10åˆ†é’Ÿå¸®ä½ æ„å»ºåº”ç”¨ï¼Œ1å°æ—¶æå®šæ–°åŠŸèƒ½æ‹“å±•ã€æµ‹è¯•ä¼˜åŒ–ã€æ–‡æ¡£æ³¨é‡Šå’Œéƒ¨ç½²</p>
<p>ğŸ’ª å…è´¹ä½“éªŒä¼ä¸šçº§ AI å¼€å‘å·¥å…·ï¼Œè´¨é‡+å®‰å…¨å…¨æŒæ§</p>
<p>â©ï¸[<a href="https://link.juejin.cn?target=https%3A%2F%2Fevents.amazoncloud.cn%2Flabs%2Fcloudlab-amazon-q-cli-and-ide-build%3Fvisitfrom%3D3P_Juejintail_1216%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_1216" target="_blank" title="https://events.amazoncloud.cn/labs/cloudlab-amazon-q-cli-and-ide-build?visitfrom=3P_Juejintail_1216&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_1216" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿›å…¥å®éªŒ</a>] å³åˆ»å¼€å¯  AI å¼€å‘ä¹‹æ—…
æ„å»ºæ— é™, æ¢ç´¢å¯ç¨‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‡ªå®šä¹‰å°è£… vueå¤šé¡µé¡¹ç›®æ–°å¢é¡¹ç›®è„šæ‰‹æ¶]]></title>    <link>https://juejin.cn/post/7584057497206702123</link>    <guid>https://juejin.cn/post/7584057497206702123</guid>    <pubDate>2025-12-16T08:49:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584057497206702123" data-draft-id="7584007232411926534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‡ªå®šä¹‰å°è£… vueå¤šé¡µé¡¹ç›®æ–°å¢é¡¹ç›®è„šæ‰‹æ¶"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Node.js"/> <meta itemprop="datePublished" content="2025-12-16T08:49:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ximimimi"/> <meta itemprop="url" content="https://juejin.cn/user/3350967174040238"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‡ªå®šä¹‰å°è£… vueå¤šé¡µé¡¹ç›®æ–°å¢é¡¹ç›®è„šæ‰‹æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3350967174040238/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ximimimi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T08:49:27.000Z" title="Tue Dec 16 2025 08:49:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å¤šé¡µé¡¹ç›®ä¸­ï¼Œæœ‰æ—¶å€™æ–°å»ºé¡¹ç›®éœ€è¦åŸºäºåŸå…ˆçš„é¡¹ç›®æ‹·è´ä¸€ä»½ï¼Œè¿˜éœ€è¦åœ¨publicä¸Šæ–°å¢htmlå…¥å£ï¼Œä¿®æ”¹vue.config.jsé…ç½®....è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒç¹çï¼Œè€Œä¸”å®¹æ˜“æ¼æ‰ï¼Œæ‰€ä»¥å°è£…äº†ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„è„šæ‰‹æ¶å·¥å…·</p>
<h2 data-id="heading-1">ä½¿ç”¨</h2>
<ul>
<li>
<p>åŸå…ˆæ–¹å¼ï¼š æ‰‹åŠ¨å¢åŠ </p>
<ul>
<li>åœ¨srcç›®å½•ä¸‹æ–°å¢é¡¹ç›®,main.tsä¸­ç›‘å¬ç‰ˆæœ¬å·çš„initVersionUpdateJsonä¼ å…¥å‚æ•°æ”¹æˆæ–°çš„æ¨¡å— ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œæ‹·è´æ•´ä¸ªé¡¹ç›®åéœ€è¦æŠŠé¡¹ç›®å†…çš„å¼•ç”¨æ”¹ä¸€ä¸‹ï¼Œæ¯”å¦‚æ–°å»ºé¡¹ç›®æ˜¯B, æ‹·è´çš„æ˜¯Aé¡¹ç›®ï¼Œéœ€è¦å…¨å±€å°†@/views/A/XXX æ”¹æˆ@/views/B/XXXXï¼‰</li>
<li>åœ¨publicç›®å½•ä¸‹æ–°å¢ä¸€ä¸ªhtmlæ–‡ä»¶</li>
<li>é…ç½®vue.config.jsä¸­çš„pageså‚æ•°ï¼Œæ–°å¢ä¸€ä¸ªitem</li>
<li>åœ¨é¦–é¡µï¼ˆ<code>src/views/Home/index.vue</code>ï¼‰æ·»åŠ æ–°å…¥å£é¡¹</li>
<li>åœ¨version.jsonä¸­å¢åŠ è¯¥é¡¹ç›®ç‰ˆæœ¬</li>
</ul>
</li>
<li>
<p>ç°åœ¨ï¼š ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·</p>
<ul>
<li>å®‰è£…ï¼šnpm install hcli</li>
<li>ä½¿ç”¨ï¼šhcli create
äº¤äº’å¼æç¤ºå°†è¯¢é—®ï¼š
<ul>
<li>æ˜¯å¦åˆ›å»ºæ–°çš„é¡¹ç›®ï¼ˆconfirmï¼‰</li>
<li>é¡¹ç›®åç§°ï¼ˆnameï¼‰</li>
<li>åœ¨é¦–é¡µæ˜¾ç¤ºçš„æ ‡é¢˜ï¼ˆtitleï¼‰</li>
<li>é€‰æ‹©è¦å¤ç”¨çš„æ¨¡æ¿ï¼ˆmodelï¼Œåˆ—ä¸¾ä¾‹å¦‚ <code>Aé¡¹ç›®</code>, <code>Bé¡¹ç›®</code>....ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">å¦‚ä½•å®ç°</h2>
<h4 data-id="heading-3">å‰ç½®çŸ¥è¯†</h4>
<ul>
<li>node bin å°è£…æ’ä»¶</li>
<li>nodeæ¨¡å—ï¼ˆcommander /inquirer /fs/ chalk)</li>
</ul>
<h4 data-id="heading-4">å®ç°</h4>
<ul>
<li>
<p>åˆå§‹åŒ–é¡¹ç›®npm init -yï¼Œ æ–°å»ºbin/hcli.jsæ–‡ä»¶,å†…å®¹å¦‚ä¸‹
// åœ¨package.jsonä¸­çš„é…ç½®
{
"name": "hcli",
"version": "1.0.0",
"description": "",
"main": "index.js",
"bin": {
"hcli": "bin/hcli.js"
},
"scripts": {
"publish": "npm publish",
"test": "echo "Error: no test specified" &amp;&amp; exit 1"
},
"author": "",
"license": "ISC",
"dependencies": {
"commander": "^14.0.2",
"inquirer": "^12.11.1"
}
}</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// bin/hcli.js å†…å®¹</span>
#!<span class="hljs-regexp">/usr/</span>bin/env node
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hello,world'</span>)
</code></pre>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97374feb3aec45ec9a561d08a9a4328c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGltaW1pbWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766479811&amp;x-signature=JYkVC3LxOYWqDoxfP1DgZ%2BRKflc%3D" alt="image.png" loading="lazy"/></p>
<p>è°ƒè¯•ï¼š åœ¨å½“å‰ç›®å½•ä¸‹npm link,åœ¨è°ƒè¯•çš„ç›®å½•ä¸‹npm link hcli; è¿™æ—¶å€™æ‰§è¡Œhcliå°±ä¼šæ‰“å°hello,world</p>
<ul>
<li>ä¸ºäº†å®ç°hcli createåŠŸèƒ½ï¼Œéœ€è¦ä½¿ç”¨commanderè¿™ä¸ªæ¨¡å—, åœ¨bin/hcli.jsæ–‡ä»¶ä¸­</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-keyword">const</span> { program } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>)
<span class="hljs-keyword">const</span> create = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../src/create'</span>)

program.<span class="hljs-title function_">command</span>(<span class="hljs-string">'create'</span>).<span class="hljs-title function_">description</span>(<span class="hljs-string">'create a project '</span>).<span class="hljs-title function_">action</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'create project'</span>)
})

program.<span class="hljs-title function_">parse</span>(process.<span class="hljs-property">argv</span>)
</code></pre>
<ul>
<li>åœ¨hcli createæ—¶éœ€è¦å‡ºç°äº¤äº’ç•Œé¢è¿è¡Œç”¨æˆ·è¾“å…¥é€‰æ‹©ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨åˆ°inquireræ¨¡å—</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–°å¢src/question.jsæ–‡ä»¶</span>
<span class="hljs-keyword">const</span> create = [
    {
        <span class="hljs-attr">name</span>:<span class="hljs-string">'conf'</span>,
        <span class="hljs-attr">type</span>:<span class="hljs-string">'confirm'</span>,
        <span class="hljs-attr">message</span>:<span class="hljs-string">'æ˜¯å¦åˆ›å»ºæ–°çš„é¡¹ç›®ï¼Ÿ'</span>
    },{
        <span class="hljs-attr">name</span>:<span class="hljs-string">'name'</span>,
        <span class="hljs-attr">message</span>:<span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®åç§°ï¼Ÿ'</span>,
        <span class="hljs-attr">when</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title class_">Boolean</span>(res.<span class="hljs-property">conf</span>)
    },{
        <span class="hljs-attr">name</span>:<span class="hljs-string">'title'</span>,
        <span class="hljs-attr">message</span>:<span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®åœ¨é¦–é¡µçš„æ ‡é¢˜ï¼Ÿ'</span>,
        <span class="hljs-attr">when</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title class_">Boolean</span>(res.<span class="hljs-property">conf</span>)
    },{
        <span class="hljs-attr">type</span>: <span class="hljs-string">'list'</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·é€‰æ‹©è¦å¤ç”¨çš„é¡¹ç›®æ¨¡ç‰ˆï¼Ÿ'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'model'</span>,
        <span class="hljs-attr">choices</span>: [<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'C'</span> ....],
        <span class="hljs-attr">filter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) {
          <span class="hljs-keyword">return</span> val.<span class="hljs-title function_">toLowerCase</span>()
        },
        <span class="hljs-attr">when</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title class_">Boolean</span>(res.<span class="hljs-property">conf</span>)
    }
]
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    create
}

<span class="hljs-comment">// æ–°å¢src/inquirer.jsæ–‡ä»¶</span>
<span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'inquirer'</span>)
<span class="hljs-keyword">const</span> questions = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./question'</span>)
<span class="hljs-keyword">const</span> prompt = inquirer.<span class="hljs-property">prompt</span> || (inquirer.<span class="hljs-property">default</span> &amp;&amp; inquirer.<span class="hljs-property">default</span>.<span class="hljs-property">prompt</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">create</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-title function_">prompt</span>(questions.<span class="hljs-property">create</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(res)
    })
  })
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  create
}

<span class="hljs-comment">/// bin/hcli.jsæ–‡ä»¶</span>
#!<span class="hljs-regexp">/usr/</span>bin/env node
<span class="hljs-keyword">const</span> { program } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>)
<span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../src/inquirer'</span>)
<span class="hljs-keyword">const</span> create = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../src/create'</span>)

program.<span class="hljs-title function_">command</span>(<span class="hljs-string">'create'</span>).<span class="hljs-title function_">description</span>(<span class="hljs-string">'create a project '</span>).<span class="hljs-title function_">action</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'create project'</span>)
  inquirer.<span class="hljs-title function_">create</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>{
		<span class="hljs-keyword">if</span>(res.<span class="hljs-property">conf</span>){
                <span class="hljs-comment">// todo</span>
                 <span class="hljs-title function_">create</span>(res)
		}
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'res'</span>, res)
	})
})
program.<span class="hljs-title function_">parse</span>(process.<span class="hljs-property">argv</span>)
</code></pre>
<ul>
<li>æœ€é‡è¦çš„å°±æ˜¯æ ¹æ®inquirerä¼ å…¥çš„reså‚æ•°æ¥å®ç°createåŠŸèƒ½</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">const fs = <span class="hljs-built_in">require</span>('fs')
const path = <span class="hljs-built_in">require</span>('path')
const copy = <span class="hljs-built_in">require</span>('../utils/copyFile.js')

module<span class="hljs-selector-class">.exports</span> = <span class="hljs-built_in">function</span>(res){
    <span class="hljs-comment">/**
    * 1ã€åœ¨src/viewä¸‹åˆ›å»ºnameç›®å½•ï¼Œå°†modelç›®å½•ä¸‹çš„æ–‡ä»¶å¤åˆ¶è¿‡å»
    * 2ã€åœ¨publicç›®å½•ä¸‹åˆ›å»ºname.htmlæ–‡ä»¶
    * 3ã€ä¿®æ”¹vue.config.jsæ–‡ä»¶ï¼Œæ·»åŠ æ–°çš„å…¥å£
    * 4ã€åœ¨homeé¡¹ç›®ä¸­å¢åŠ å…¥å£
    * 5ã€åœ¨public/versions.jsonä¸­æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯
    * **/</span>
    <span class="hljs-built_in">createBaseProject</span>(res)
    <span class="hljs-built_in">createPublicHtml</span>(res)
    <span class="hljs-built_in">updateVueConfig</span>(res)
    <span class="hljs-built_in">addHomeEnetry</span>(res)
    <span class="hljs-built_in">addVersion</span>(res)
}

function <span class="hljs-built_in">createBaseProject</span>(res){
    ....
}

function <span class="hljs-built_in">createPublicHtml</span>(res){
 ...
}

function <span class="hljs-built_in">updateVueConfig</span>(res) {
 ...
}

const addVersion = (res) =&gt; {
 ...
}
</code></pre>
<p>è¿™é‡Œcreateæ–¹æ³•éœ€è¦æ ¹æ®è‡ªå·±å®é™…é¡¹ç›®çš„éœ€æ±‚æ¥å®ç°ï½åªéœ€åˆ—å‡ºå…·ä½“æ¡†æ¶ï¼Œå…¶ä»–è®©AIå®ç°å°±å¥½äº†</p>
<p>å‚è€ƒæ–‡ç« ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.aliyun.com%2Farticle%2F1259366" target="_blank" title="https://developer.aliyun.com/article/1259366" ref="nofollow noopener noreferrer">developer.aliyun.com/article/125â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>