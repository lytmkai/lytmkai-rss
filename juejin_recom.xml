<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[åŸºäºPixiJSçš„å°æ¸¸æˆå¹¿å‘Šå¼€å‘]]></title>    <link>https://juejin.cn/post/7579255046980190234</link>    <guid>https://juejin.cn/post/7579255046980190234</guid>    <pubDate>2025-12-03T09:38:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579255046980190234" data-draft-id="7579255046980108314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºPixiJSçš„å°æ¸¸æˆå¹¿å‘Šå¼€å‘"/> <meta itemprop="keywords" content="å‰ç«¯,æ¸¸æˆå¼€å‘,WebGL"/> <meta itemprop="datePublished" content="2025-12-03T09:38:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¦å¤§å‘½å¤§"/> <meta itemprop="url" content="https://juejin.cn/user/2154698523020205"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºPixiJSçš„å°æ¸¸æˆå¹¿å‘Šå¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2154698523020205/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¦å¤§å‘½å¤§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:38:25.000Z" title="Wed Dec 03 2025 09:38:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯•ç©æ¸¸æˆå¹¿å‘Šï¼Œæœ€ç»ˆä¼šæŠ•æ”¾åˆ° <code>Moloco</code> å¹¿å‘Šå¹³å°è¿›è¡Œæ¨å¹¿ï¼Œæ¸¸æˆä¸ç®—å¤æ‚ï¼Œä½†æ˜¯ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ä¸ªç±»ç›®ï¼Œè®°å½•ä¸€ä¸‹ ğŸ˜€ğŸ˜€ğŸ˜€</p>
<p>å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œ<strong>è®°å¾—ä¸€é”®ä¸‰è¿å“Ÿ</strong>ã€‚æœ‰é—®é¢˜å’Œç–‘æƒ‘çš„è¯ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ã€‚æˆ‘ä¼šç¬¬ä¸€æ—¶é—´å›å¤å¤§å®¶ï¼Œå¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å“ªé‡Œæœ‰çŸ¥è¯†ç‚¹é”™è¯¯çš„è¯ï¼Œä¹Ÿæ³è¯·èƒ½å¤Ÿå‘ŠçŸ¥ï¼ŒæŠŠé”™çš„ä¸œè¥¿ç†è§£æˆå¯¹çš„ï¼Œæ— è®ºåœ¨ä»€ä¹ˆè¡Œä¸šï¼Œéƒ½æ˜¯è‡´å‘½çš„ã€‚</p>
<h2 data-id="heading-1">é¡¹ç›®æ¦‚è§ˆ</h2>
<h3 data-id="heading-2">æŠ€æœ¯æ ˆ</h3>
<ul>
<li><strong>PixiJS 8.x</strong>: 2D WebGL æ¸²æŸ“å¼•æ“ï¼Œç”¨æ¥ç”»æ¸¸æˆç”»é¢</li>
<li><strong>GSAP 3.x</strong>: åŠ¨ç”»åº“ï¼Œè®©å…ƒç´ åŠ¨èµ·æ¥æ›´æµç•…ï¼Œå¼ºçƒˆæ¨è</li>
<li><strong>TypeScript</strong>: å¸¦ç±»å‹æ£€æŸ¥çš„ JavaScript</li>
<li><strong>Vite</strong>: ç°ä»£åŒ–çš„æ‰“åŒ…å·¥å…·</li>
<li><strong>@pixi/sound</strong>: ç®¡ç†éŸ³æ•ˆå’ŒèƒŒæ™¯éŸ³ä¹</li>
</ul>
<h3 data-id="heading-3">é¡¹ç›®æ–‡ä»¶ç»“æ„</h3>
<pre><code class="hljs language-plain" lang="plain">src/
â”œâ”€â”€ main.ts                 # ç¨‹åºå…¥å£
â”œâ”€â”€ types.ts               # ç±»å‹å®šä¹‰
â”œâ”€â”€ components/            # æ¸¸æˆç»„ä»¶
â”‚   â”œâ”€â”€ Background.ts      # èƒŒæ™¯å±‚
â”‚   â”œâ”€â”€ Character.ts       # å·¦ä¾§è§’è‰²
â”‚   â”œâ”€â”€ TopBar.ts         # é¡¶éƒ¨æ (Logo/å¤§å¥–/åˆ†æ•°)
â”‚   â”œâ”€â”€ SlotArea.ts       # è½¬è½®åŒºåŸŸå®¹å™¨
â”‚   â”œâ”€â”€ SlotMachine.ts    # è½¬è½®æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ MaskOverlay.ts    # å¼•å¯¼é®ç½©
â”‚   â”œâ”€â”€ BottomArea.ts     # åº•éƒ¨æŒ‰é’®
â”‚   â”œâ”€â”€ GuideHand.ts      # å¼•å¯¼æ‰‹åŠ¿
â”‚   â”œâ”€â”€ CoinRain.ts       # é‡‘å¸é›¨ç‰¹æ•ˆ
â”‚   â””â”€â”€ DownloadOverlay.ts # ä¸‹è½½å¼¹çª—
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ responsive.ts     # å“åº”å¼é€‚é…
â”‚   â”œâ”€â”€ textures.ts       # çº¹ç†ç®¡ç†
â”‚   â”œâ”€â”€ resources.ts      # èµ„æºåŠ è½½
â”‚   â”œâ”€â”€ audio.ts         # éŸ³é¢‘ç®¡ç†
â”‚   â”œâ”€â”€ ad.ts            # å¹¿å‘Šè·³è½¬
â”‚   â””â”€â”€ time.ts          # æ—¶é—´å·¥å…·
â””â”€â”€ assets/              # èµ„æºæ–‡ä»¶
</code></pre>
<h2 data-id="heading-4">æ ¸å¿ƒç³»ç»Ÿå®ç°</h2>
<h3 data-id="heading-5">ç¨‹åºå¯åŠ¨æµç¨‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆ›å»º PixiJS åº”ç”¨</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Application</span>();

<span class="hljs-comment">// åˆå§‹åŒ–é…ç½®</span>
<span class="hljs-keyword">await</span> app.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0xffffff</span>,
  <span class="hljs-attr">resizeTo</span>: <span class="hljs-variable language_">window</span>, <span class="hljs-comment">// è‡ªåŠ¨é€‚é…çª—å£å¤§å°</span>
  <span class="hljs-attr">resolution</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>, <span class="hljs-number">2</span>), <span class="hljs-comment">// æ”¯æŒé«˜æ¸…å±</span>
  <span class="hljs-attr">autoDensity</span>: <span class="hljs-literal">true</span>,
});

<span class="hljs-comment">// åˆå§‹åŒ–å“åº”å¼ç³»ç»Ÿ(åŸºäº 375x667 è®¾è®¡ç¨¿)</span>
<span class="hljs-title function_">initResponsive</span>(app, <span class="hljs-number">375</span>, <span class="hljs-number">667</span>);

<span class="hljs-comment">// åŠ è½½æ‰€æœ‰èµ„æº</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">loadResources</span>();

<span class="hljs-comment">// åˆ›å»ºæ¸¸æˆåœºæ™¯</span>
<span class="hljs-title function_">createGameScene</span>();
</code></pre>
<h3 data-id="heading-6">å“åº”å¼é€‚é…ç³»ç»Ÿ</h3>
<p>ç±»ä¼¼ CSS çš„ Rem å•ä½ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è®¾è®¡ç¨¿ä¸Šçš„åƒç´ å€¼è½¬æ¢æˆå®é™…å±å¹•åƒç´ </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">rem</span>(<span class="hljs-params">px: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">const</span> scale = <span class="hljs-title function_">getScale</span>();
  <span class="hljs-keyword">return</span> px * scale;
}

<span class="hljs-comment">// è®¡ç®—ç¼©æ”¾æ¯”ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getScale</span>(<span class="hljs-params"/>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">const</span> { width, height } = appInstance.<span class="hljs-property">screen</span>;

  <span class="hljs-comment">// ç«–å±: æŒ‰å®½åº¦ç¼©æ”¾</span>
  <span class="hljs-keyword">if</span> (height &gt; width) {
    <span class="hljs-keyword">return</span> width / <span class="hljs-variable constant_">DESIGN_WIDTH</span>; <span class="hljs-comment">// DESIGN_WIDTH = 375</span>
  }
  <span class="hljs-comment">// æ¨ªå±: æŒ‰é«˜åº¦ç¼©æ”¾</span>
  <span class="hljs-keyword">return</span> height / <span class="hljs-variable constant_">DESIGN_HEIGHT</span>; <span class="hljs-comment">// DESIGN_HEIGHT = 667</span>
}
</code></pre>
<p><strong>ä½¿ç”¨æ–¹æ³•</strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è®¾è®¡ç¨¿ä¸ŠæŸä¸ªå…ƒç´ ä½ç½®æ˜¯ (100, 200)</span>
sprite.<span class="hljs-property">x</span> = <span class="hljs-title function_">rem</span>(<span class="hljs-number">100</span>);
sprite.<span class="hljs-property">y</span> = <span class="hljs-title function_">rem</span>(<span class="hljs-number">200</span>);

<span class="hljs-comment">// è®¾è®¡ç¨¿ä¸Šå­—ä½“å¤§å°æ˜¯ 24</span>
text.<span class="hljs-property">style</span>.<span class="hljs-property">fontSize</span> = <span class="hljs-title function_">rem</span>(<span class="hljs-number">24</span>);
</code></pre>
<h3 data-id="heading-7">èµ„æºç®¡ç†</h3>
<h4 data-id="heading-8">çº¹ç†å›¾é›†</h4>
<p>çº¹ç†å°±æ˜¯æŠŠå¾ˆå¤šå°å›¾ç‰‡åŠ åˆ°ä¸€ä¸ªå¤§å›¾ç‰‡é‡Œé¢ï¼ŒåŒ…å«äº†ä¸€ä¸ª json æ–‡ä»¶è®°å½•å°å›¾ç‰‡ä½ç½®ï¼Œæˆ‘æŠŠæ‰€æœ‰å°å›¾ç‰‡æ‰“åŒ…æˆä¸‰å¼ å¤§å›¾ï¼Œè¿™æ ·åŠ è½½æ›´å¿«ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¸»èµ„æºå›¾é›† (assets.png)</span>
<span class="hljs-comment">// åŒ…å« UIã€èƒŒæ™¯ã€æŒ‰é’®ç­‰</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">loadAssetsSheet</span>();

<span class="hljs-comment">// å›¾æ ‡å›¾é›† (assets_icons.png)</span>
<span class="hljs-comment">// åŒ…å«è½¬è½®ä¸Šçš„å„ç§å›¾æ ‡</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">loadAssetsIconsSheet</span>();

<span class="hljs-comment">// å®£ä¼ å›¾é›† (promo_custom.png)</span>
<span class="hljs-comment">// åŒ…å«æœ€ç»ˆè½åœ°é¡µç´ æ</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">loadPromoCustomSheet</span>();

<span class="hljs-comment">// ä½¿ç”¨æ—¶åªéœ€è¦ä¼ å›¾ç‰‡åç§°</span>
<span class="hljs-keyword">const</span> texture = <span class="hljs-title function_">getAssetsTexture</span>(<span class="hljs-string">"Character"</span>);
<span class="hljs-keyword">const</span> sprite = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sprite</span>(texture);
</code></pre>
<p><strong>å›¾é›†çš„å¥½å¤„</strong>:</p>
<ul>
<li>ä¸€æ¬¡è¯·æ±‚ä¸‹è½½å¤šå¼ å›¾</li>
<li>å‡å°‘æœåŠ¡å™¨å‹åŠ›</li>
<li>GPU æ¸²æŸ“æ›´é«˜æ•ˆ</li>
</ul>
<h4 data-id="heading-9">éŸ³é¢‘ç®¡ç†</h4>
<p>éŸ³é¢‘ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç”¨@pixi/sound è¿›è¡Œæ’­æ”¾ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼ç®¡ç†æ‰€æœ‰éŸ³æ•ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AudioManager</span> {
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åŠ è½½æ‰€æœ‰éŸ³æ•ˆ</span>
    <span class="hljs-keyword">await</span> sound.<span class="hljs-title function_">add</span>(<span class="hljs-string">"spinButton"</span>, spinButtonUrl);
    <span class="hljs-keyword">await</span> sound.<span class="hljs-title function_">add</span>(<span class="hljs-string">"reelClick"</span>, reelClickUrl);
    <span class="hljs-keyword">await</span> sound.<span class="hljs-title function_">add</span>(<span class="hljs-string">"backgroundMusic"</span>, backgroundMusicUrl);
  }

  <span class="hljs-keyword">public</span> <span class="hljs-title function_">playSpinButton</span>(<span class="hljs-params"/>) {
    sound.<span class="hljs-title function_">play</span>(<span class="hljs-string">"spinButton"</span>);
  }

  <span class="hljs-keyword">public</span> <span class="hljs-title function_">playBackgroundMusic</span>(<span class="hljs-params"/>) {
    sound.<span class="hljs-title function_">play</span>(<span class="hljs-string">"backgroundMusic"</span>, {
      <span class="hljs-attr">loop</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¾ªç¯æ’­æ”¾</span>
      <span class="hljs-attr">volume</span>: <span class="hljs-number">0.5</span>, <span class="hljs-comment">// éŸ³é‡ 50%</span>
    });
  }
}
</code></pre>
<h3 data-id="heading-10">ç»„ä»¶è®¾è®¡æ¨¡å¼</h3>
<p>æ‰€æœ‰éœ€è¦é€‚é…å±å¹•çš„ç»„ä»¶éƒ½å¾—å®ç° <code>Resizable</code> è¿™ä¸ªæ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Resizable</span> {
  <span class="hljs-title function_">resize</span>(...<span class="hljs-attr">args</span>: <span class="hljs-built_in">unknown</span>[]): <span class="hljs-built_in">void</span>;
}
</code></pre>
<p><strong>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</strong>:</p>
<ol>
<li><strong>æ„é€ </strong>: åˆ›å»ºç²¾çµã€è®¾ç½®åˆå§‹ä½ç½®</li>
<li><strong>Resize</strong>: çª—å£å˜åŒ–æ—¶é‡æ–°è®¡ç®—å¸ƒå±€</li>
<li><strong>äº¤äº’</strong>: å¤„ç†ç”¨æˆ·ç‚¹å‡»ã€æ‹–åŠ¨ç­‰</li>
<li><strong>é”€æ¯</strong>: æ¸…ç†èµ„æºé˜²æ­¢å†…å­˜æ³„æ¼</li>
</ol>
<h2 data-id="heading-11">æ¸¸æˆæµç¨‹è®¾è®¡</h2>
<h3 data-id="heading-12">åœºæ™¯å±‚çº§</h3>
<p>é¡µé¢ä¸­å„ä¸ªåŒºå—å±‚çº§ä¸ä¸€æ ·ï¼Œä½¿ç”¨ <code>zIndex</code> ç®¡ç†ä¸åŒå±‚çº§ï¼Œæ•°å­—è¶Šå¤§è¶Šé å‰ï¼š</p>
<pre><code class="hljs language-plain" lang="plain">Stage
â”œâ”€â”€ Background (zIndex: 0) - èƒŒæ™¯æœ€åº•å±‚
â”œâ”€â”€ MaskOverlay (zIndex: 1) - å¼•å¯¼é®ç½©
â”œâ”€â”€ Character (zIndex: 2) - è§’è‰²
â”œâ”€â”€ BottomArea (zIndex: 3) - æŒ‰é’®
â”œâ”€â”€ SlotArea (zIndex: 4) - è½¬è½®
â”œâ”€â”€ TopBar (zIndex: 5) - é¡¶éƒ¨UI
â””â”€â”€ DownloadOverlay (zIndex: 100) - å¼¹çª—æœ€ä¸Šå±‚
</code></pre>
<h3 data-id="heading-13">æ¸¸æˆæµç¨‹å›¾</h3>
<pre><code class="hljs language-plain" lang="plain">ç”¨æˆ·è¿›å…¥
    â†“
[åˆå§‹åœºæ™¯]
- æ˜¾ç¤ºè§’è‰²å’Œå¼•å¯¼
- Play æŒ‰é’® + æ‰‹åŠ¿åŠ¨ç”»
- æ’­æ”¾èƒŒæ™¯éŸ³ä¹
    â†“
ç”¨æˆ·ç‚¹å‡» Play
    â†“
[æ·¡å‡ºåŠ¨ç”»]
- è§’è‰²æ·¡å‡º (0.8ç§’)
- é®ç½©æ·¡å‡º
- æŒ‰é’®æ·¡å‡º
    â†“
[è½¬è½®æ—‹è½¬]
- æ’­æ”¾æ—‹è½¬éŸ³æ•ˆ
- 3ä¸ªè½¬è½®ä¾æ¬¡å¯åŠ¨
- æ¯ä¸ªè½¬ 2 ç§’
- ä¾æ¬¡åœæ­¢
    â†“
[åˆ¤æ–­ç»“æœ]
- æ£€æŸ¥æ˜¯å¦ä¸‰ä¸ªå›¾æ ‡ä¸€æ ·
- åˆ†æ•°å¢é•¿åŠ¨ç”»
    â†“
[é‡‘å¸é›¨]
- å¼€å§‹æ‰é‡‘å¸
- é‡‘å¸ä¸‹è½+æ—‹è½¬+ç¿»è½¬
- æ’­æ”¾ä¸­å¥–éŸ³æ•ˆ
    â†“
[3ç§’å]
    â†“
[æ˜¾ç¤ºä¸‹è½½å¼¹çª—]
- å¼¹çª—æ·¡å…¥
- é‡‘å¸é›¨é€æ¸åœæ­¢
</code></pre>
<h2 data-id="heading-14">æ ¸å¿ƒåŠŸèƒ½å®ç°</h2>
<h3 data-id="heading-15">æ¸¸æˆè½¬è½®</h3>
<h4 data-id="heading-16">çŠ¶æ€æœºç®¡ç†</h4>
<p>æˆ‘ç”¨<code>çŠ¶æ€æœº</code>æ¥ç®¡ç†è½¬è½®çŠ¶æ€ï¼Œé¿å…å‡ºç°ç‚¹ä¸¤æ¬¡æŒ‰é’®ä¹‹ç±»çš„ bugï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">SlotMachineState</span> {
  <span class="hljs-variable constant_">IDLE</span> = <span class="hljs-string">"IDLE"</span>, <span class="hljs-comment">// ç©ºé—²ï¼Œå¯ä»¥ç‚¹å‡»</span>
  <span class="hljs-variable constant_">SPINNING</span> = <span class="hljs-string">"SPINNING"</span>, <span class="hljs-comment">// æ­£åœ¨è½¬</span>
  <span class="hljs-variable constant_">STOPPING</span> = <span class="hljs-string">"STOPPING"</span>, <span class="hljs-comment">// æ­£åœ¨åœæ­¢</span>
  <span class="hljs-variable constant_">STOPPED</span> = <span class="hljs-string">"STOPPED"</span>, <span class="hljs-comment">// å·²åœæ­¢</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SlotMachineStateMachine</span> {
  <span class="hljs-title function_">canSpin</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-comment">// åªæœ‰ç©ºé—²å’Œå·²åœæ­¢çŠ¶æ€æ‰èƒ½å†æ¬¡æ—‹è½¬</span>
    <span class="hljs-keyword">return</span> [<span class="hljs-title class_">SlotMachineState</span>.<span class="hljs-property">IDLE</span>, <span class="hljs-title class_">SlotMachineState</span>.<span class="hljs-property">STOPPED</span>].<span class="hljs-title function_">includes</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>
    );
  }
}
</code></pre>
<h4 data-id="heading-17">è½¬è½®åŠ¨ç”»</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Reel</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">spin</span>(
    <span class="hljs-attr">delay</span>: <span class="hljs-built_in">number</span>, <span class="hljs-comment">// å»¶è¿Ÿå¯åŠ¨</span>
    <span class="hljs-attr">targetIcon</span>: <span class="hljs-built_in">number</span>, <span class="hljs-comment">// ç›®æ ‡å›¾æ ‡</span>
    <span class="hljs-attr">speed</span>: <span class="hljs-built_in">number</span>, <span class="hljs-comment">// é€Ÿåº¦</span>
    <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// æŒç»­æ—¶é—´</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// 1. å»¶è¿Ÿå¯åŠ¨(è®©3ä¸ªè½¬è½®é”™å¼€)</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(delay * <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// 2. åŠ é€Ÿé˜¶æ®µ</span>
    gsap.<span class="hljs-title function_">to</span>(<span class="hljs-variable language_">this</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-string">`+=<span class="hljs-subst">${speed * <span class="hljs-number">3</span>}</span>`</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">0.3</span>,
      <span class="hljs-attr">ease</span>: <span class="hljs-string">"power2.in"</span>,
    });

    <span class="hljs-comment">// 3. åŒ€é€Ÿæ—‹è½¬</span>
    gsap.<span class="hljs-title function_">to</span>(<span class="hljs-variable language_">this</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-string">`+=<span class="hljs-subst">${speed * duration}</span>`</span>,
      <span class="hljs-attr">duration</span>: duration,
      <span class="hljs-attr">ease</span>: <span class="hljs-string">"none"</span>,
    });

    <span class="hljs-comment">// 4. å‡é€Ÿåœåœ¨ç›®æ ‡å›¾æ ‡</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopAtIcon</span>(targetIcon);
  }
}
</code></pre>
<h4 data-id="heading-18">é¢„è®¾ç»“æœ</h4>
<p>å› ä¸ºæ˜¯è¯•ç©æ¸¸æˆï¼Œä¸ºäº†æ§åˆ¶ä½“éªŒï¼Œç›´æ¥é¢„è®¾å‡ ä¸ªæ¸¸æˆç»“æœï¼ŒéšæœºæŠ½å–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PRESET_RESULTS</span> = [
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-comment">// ä¸‰ä¸ªç›¸åŒ - ä¸­å¥–</span>
  [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],
  [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
  <span class="hljs-comment">// ...</span>
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-comment">// ä¸åŒ - ä¸ä¸­å¥–</span>
];

<span class="hljs-comment">// éšæœºé€‰ä¸€ä¸ª</span>
<span class="hljs-keyword">const</span> resultIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable constant_">PRESET_RESULTS</span>.<span class="hljs-property">length</span>);
<span class="hljs-keyword">const</span> resultData = <span class="hljs-variable constant_">PRESET_RESULTS</span>[resultIndex];
</code></pre>
<h3 data-id="heading-19">é‡‘å¸é›¨ç‰¹æ•ˆ</h3>
<p>æ¸¸æˆç»“æŸæ—¶é‡‘å¸ä¸‹è½æ•ˆæœ</p>
<h4 data-id="heading-20">é‡‘å¸çš„å±æ€§</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">CoinSprite</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sprite</span> {
  <span class="hljs-attr">speedY</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ä¸‹è½é€Ÿåº¦</span>
  <span class="hljs-attr">speedX</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// æ°´å¹³æ¼‚ç§»</span>
  <span class="hljs-attr">speedR</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// æ—‹è½¬é€Ÿåº¦</span>
  <span class="hljs-attr">flipSpeed</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ç¿»è½¬é€Ÿåº¦(å®ç°3Dæ•ˆæœ)</span>
  <span class="hljs-attr">flipPhase</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ç¿»è½¬ç›¸ä½</span>
  <span class="hljs-attr">initialScale</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// åˆå§‹å¤§å°</span>
}
</code></pre>
<h4 data-id="heading-21">åˆ›å»ºé‡‘å¸</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-title function_">createCoin</span>(<span class="hljs-params">randomY: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span></span>) {
  <span class="hljs-keyword">const</span> coin = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sprite</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">texture</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">CoinSprite</span>;

  <span class="hljs-comment">// éšæœºä½ç½®</span>
  coin.<span class="hljs-property">x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">width</span>;
  coin.<span class="hljs-property">y</span> = randomY
    ? (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">height</span>) / <span class="hljs-number">2</span> - <span class="hljs-title function_">rem</span>(<span class="hljs-number">200</span>)
    : <span class="hljs-title function_">rem</span>(-<span class="hljs-number">50</span>); <span class="hljs-comment">// ä»é¡¶éƒ¨å¼€å§‹</span>

  <span class="hljs-comment">// éšæœºå¤§å° (0.3 - 0.6)</span>
  <span class="hljs-keyword">const</span> scale = (<span class="hljs-number">0.3</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">0.3</span>) * <span class="hljs-title function_">getScale</span>();
  coin.<span class="hljs-property">scale</span>.<span class="hljs-title function_">set</span>(scale);
  coin.<span class="hljs-property">initialScale</span> = scale;

  <span class="hljs-comment">// éšæœºç‰©ç†å±æ€§</span>
  coin.<span class="hljs-property">speedY</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedMin</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (<span class="hljs-variable language_">this</span>.<span class="hljs-property">speedMax</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedMin</span>);
  coin.<span class="hljs-property">speedX</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">1</span>;      <span class="hljs-comment">// å·¦å³æ¼‚ç§»</span>
  coin.<span class="hljs-property">speedR</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">0.1</span>;    <span class="hljs-comment">// æ—‹è½¬</span>
  coin.<span class="hljs-property">flipSpeed</span> = <span class="hljs-number">0.02</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">0.05</span>; <span class="hljs-comment">// ç¿»è½¬å¿«æ…¢</span>
  coin.<span class="hljs-property">flipPhase</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>; <span class="hljs-comment">// åˆå§‹ç›¸ä½</span>

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>.<span class="hljs-title function_">push</span>(coin);
}
</code></pre>
<h4 data-id="heading-22">åŠ¨ç”»æ›´æ–°</h4>
<p>è¿™æ˜¯æ•´ä¸ªç‰¹æ•ˆçš„æ ¸å¿ƒï¼Œæ¯å¸§éƒ½ä¼šæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> update = <span class="hljs-function">(<span class="hljs-params">ticker: Ticker</span>) =&gt;</span> {
  <span class="hljs-comment">// 1. ç”Ÿæˆæ–°é‡‘å¸(å¦‚æœæ²¡æœ‰åœæ­¢)</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isStopping</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">300</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">density</span>) { <span class="hljs-comment">// density = 0.2</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createCoin</span>();
    }
  }

  <span class="hljs-comment">// 2. æ›´æ–°æ¯ä¸ªé‡‘å¸</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
    <span class="hljs-keyword">const</span> coin = <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>[i];

    <span class="hljs-comment">// ä½ç½®æ›´æ–°</span>
    coin.<span class="hljs-property">y</span> += coin.<span class="hljs-property">speedY</span> * ticker.<span class="hljs-property">deltaTime</span>;
    coin.<span class="hljs-property">x</span> += coin.<span class="hljs-property">speedX</span> * ticker.<span class="hljs-property">deltaTime</span>;
    coin.<span class="hljs-property">rotation</span> += coin.<span class="hljs-property">speedR</span> * ticker.<span class="hljs-property">deltaTime</span>;

    <span class="hljs-comment">// 3Dç¿»è½¬æ•ˆæœ(é€šè¿‡ç¼©æ”¾ x è½´æ¨¡æ‹Ÿ)</span>
    coin.<span class="hljs-property">flipPhase</span> += coin.<span class="hljs-property">flipSpeed</span> * ticker.<span class="hljs-property">deltaTime</span>;
    coin.<span class="hljs-property">scale</span>.<span class="hljs-property">x</span> = coin.<span class="hljs-property">initialScale</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(coin.<span class="hljs-property">flipPhase</span>);

    <span class="hljs-comment">// è¾¹ç•Œæ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> (coin.<span class="hljs-property">y</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">height</span> + <span class="hljs-title function_">rem</span>(<span class="hljs-number">50</span>)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isStopping</span>) {
        <span class="hljs-comment">// åœæ­¢é˜¶æ®µ: é”€æ¯æ‰å‡ºå»çš„é‡‘å¸</span>
        coin.<span class="hljs-title function_">destroy</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ­£å¸¸é˜¶æ®µ: å¾ªç¯åˆ©ç”¨ï¼Œä»é¡¶éƒ¨é‡æ–°æ‰ä¸‹æ¥</span>
        coin.<span class="hljs-property">y</span> = <span class="hljs-title function_">rem</span>(-<span class="hljs-number">50</span>);
        coin.<span class="hljs-property">x</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">width</span>;
      }
    }
  }

  <span class="hljs-comment">// 3. å¦‚æœåœæ­¢ä¸”æ²¡æœ‰é‡‘å¸äº†ï¼Œæ¸…ç†èµ„æº</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isStopping</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">coins</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>();
  }
};
</code></pre>
<h4 data-id="heading-23">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h4>
<ol>
<li><strong>å¯¹è±¡æ± æ€æƒ³</strong>: é‡‘å¸æ‰å‡ºå±å¹•åä¸é”€æ¯ï¼Œè€Œæ˜¯é‡ç½®ä½ç½®ç»§ç»­ç”¨</li>
<li><strong>æ•°é‡é™åˆ¶</strong>: æœ€å¤š 300 ä¸ªé‡‘å¸ï¼Œé¿å…å†…å­˜çˆ†ç‚¸</li>
<li><strong>è½¯åœæ­¢</strong>: è°ƒç”¨ <code>stop()</code> åä¸ç«‹å³æ¸…ç†ï¼Œè®©ç°æœ‰é‡‘å¸è‡ªç„¶è½å®Œ</li>
<li><strong>ç¦ç”¨äº¤äº’</strong>: <code>coin.eventMode = "none"</code> é¿å…ä¸å¿…è¦çš„äº‹ä»¶æ£€æµ‹</li>
</ol>
<h3 data-id="heading-24">å¼•å¯¼æ‰‹åŠ¿åŠ¨ç”»</h3>
<p>ä½¿ç”¨ GSAP Timeline åšå¾ªç¯åŠ¨ç”»ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-title function_">startAnimation</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeline</span> = gsap.<span class="hljs-title function_">timeline</span>({ <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span> }); <span class="hljs-comment">// æ— é™å¾ªç¯</span>

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeline</span>
    <span class="hljs-comment">// æ‰‹æŒ‡ä¸‹å‹ + æ—‹è½¬</span>
    .<span class="hljs-title function_">to</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mcPointer</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-title function_">rem</span>(<span class="hljs-number">10</span>),
      <span class="hljs-attr">rotation</span>: -<span class="hljs-number">0.1</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">0.3</span>,
      <span class="hljs-attr">ease</span>: <span class="hljs-string">"power2.out"</span>
    })
    <span class="hljs-comment">// åŒæ—¶æ’­æ”¾æ°´æ³¢çº¹æ‰©æ•£</span>
    .<span class="hljs-title function_">to</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mcRing</span>, {
      <span class="hljs-attr">scale</span>: <span class="hljs-number">1.5</span>,
      <span class="hljs-attr">alpha</span>: <span class="hljs-number">0</span>,      <span class="hljs-comment">// æ·¡å‡º</span>
      <span class="hljs-attr">duration</span>: <span class="hljs-number">0.6</span>,
      <span class="hljs-attr">ease</span>: <span class="hljs-string">"power2.out"</span>
    }, <span class="hljs-string">"&lt;"</span>)          <span class="hljs-comment">// "&lt;" è¡¨ç¤ºå’Œä¸Šä¸€ä¸ªåŠ¨ç”»åŒæ—¶å¼€å§‹</span>
    <span class="hljs-comment">// æ‰‹æŒ‡å¤ä½</span>
    .<span class="hljs-title function_">to</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mcPointer</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">0.3</span>,
      <span class="hljs-attr">ease</span>: <span class="hljs-string">"power2.in"</span>
    })
    <span class="hljs-comment">// æš‚åœ 0.5 ç§’</span>
    .<span class="hljs-title function_">to</span>({}, { <span class="hljs-attr">duration</span>: <span class="hljs-number">0.5</span> });
}
</code></pre>
<h2 data-id="heading-25"><code>Moloco</code>é›†æˆ</h2>
<p>è¿™ä¸ªé¡¹ç›®æœ€ç»ˆè¦åœ¨ <code>Moloco</code> å¹¿å‘Šå¹³å°ä¸Šè¿è¡Œï¼ŒæŒ‰ä»–çš„éœ€æ±‚ç»™ä¸‹è½½æŒ‰é’®æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleCTA</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ£€æŸ¥å¹¿å‘Šå¹³å°æ³¨å…¥çš„å…¨å±€å¯¹è±¡</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">FbPlayableAd</span> !== <span class="hljs-string">"undefined"</span> &amp;&amp; <span class="hljs-title class_">FbPlayableAd</span>.<span class="hljs-property">onCTAClick</span>) {
    <span class="hljs-title class_">FbPlayableAd</span>.<span class="hljs-title function_">onCTAClick</span>(); <span class="hljs-comment">// è°ƒç”¨å¹³å°çš„è·³è½¬æ–¹æ³•</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ã€æœ¬åœ°æµ‹è¯•ã€‘æ¨¡æ‹Ÿè·³è½¬"</span>);
  }
}
</code></pre>
<h2 data-id="heading-26">æ‰“åŒ…é…ç½®</h2>
<p><code>Moloco</code>è¦æ±‚äº§ç‰©æ˜¯ä¸€ä¸ªå•ç‹¬çš„<code>HTML</code>æ–‡ä»¶ï¼Œè¦æ”¹ä¸€ä¸‹ <code>Vite</code> çš„æ‰“åŒ…é…ç½®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">viteSingleFile</span>()],
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">assetsInlineLimit</span>: <span class="hljs-number">100000000</span>, <span class="hljs-comment">// æ‰€æœ‰èµ„æºå†…è”</span>
    <span class="hljs-attr">cssCodeSplit</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// CSS ä¸åˆ†å‰²</span>
    <span class="hljs-attr">minify</span>: <span class="hljs-string">"terser"</span>, <span class="hljs-comment">// å‹ç¼©ä»£ç </span>
  },
});
</code></pre>
<p>è¿è¡Œ <code>npm run build</code> åå¾—åˆ°ä¸€ä¸ª <code>HTML</code> æ–‡ä»¶ï¼Œ  <code>HTML</code> æ–‡ä»¶åŒ…å«æ‰€æœ‰ä»£ç ã€å›¾ç‰‡ã€éŸ³é¢‘</p>
<h2 data-id="heading-27">æ€»ç»“</h2>
<p>å°½ç®¡æ¸¸æˆæ¯”è¾ƒç®€å•ï¼Œä½†æ•´ä¸ªå¼€å‘è¿‡ç¨‹è®©æˆ‘å¯¹æ¸¸æˆå¼€å‘æœ‰äº†åˆæ­¥çš„äº†è§£ã€‚è¿™ä¸ªé¡¹ç›®æ²¡æœ‰æ¶‰åŠåˆ°ç¢°æ’æ£€æµ‹ã€è·¯ç”±ã€éª¨éª¼åŠ¨ç”»ä»¥åŠèµ„äº§åŒ…ç®¡ç†ï¼ˆAssetPackï¼‰ç­‰æŠ€æœ¯ï¼Œæœªæ¥æœ‰æœºä¼šå†å»å­¦ä¹ å¼ºåŒ–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºç‰©è”ç½‘è®¾è®¡çš„èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿè®¾è®¡]]></title>    <link>https://juejin.cn/post/7579440586693836846</link>    <guid>https://juejin.cn/post/7579440586693836846</guid>    <pubDate>2025-12-03T09:03:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579440586693836846" data-draft-id="7579440586693820462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºç‰©è”ç½‘è®¾è®¡çš„èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿè®¾è®¡"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T09:03:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="DSå°é¾™å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/968038836867111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºç‰©è”ç½‘è®¾è®¡çš„èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿè®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/968038836867111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    DSå°é¾™å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:03:31.000Z" title="Wed Dec 03 2025 09:03:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1å°æ—¶+
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<h3 data-id="heading-1">1.1 é¡¹ç›®ä»‹ç»</h3>
<h4 data-id="heading-2">ã€1ã€‘é¡¹ç›®å¼€å‘èƒŒæ™¯</h4>
<p>éšç€ç°ä»£å†œä¸šå‘æ™ºèƒ½åŒ–ã€ç²¾ç»†åŒ–æ–¹å‘çš„ä¸æ–­æ¼”è¿›ï¼Œä¼ ç»Ÿå…»èœ‚ä¸šé¢ä¸´çš„æŒ‘æˆ˜æ—¥ç›Šå‡¸æ˜¾ã€‚ä¼ ç»Ÿçš„å…»èœ‚æ–¹å¼é«˜åº¦ä¾èµ–å…»èœ‚äººçš„ç»éªŒå’Œå®šæœŸçš„äººå·¥å¼€ç®±æ£€æŸ¥ï¼Œè¿™ç§æ¨¡å¼ä¸ä»…è€—è´¹å¤§é‡äººåŠ›ç‰©åŠ›ï¼Œè€Œä¸”é¢‘ç¹çš„å¼€ç®±æ“ä½œä¼šä¸¥é‡å¹²æ‰°èœ‚ç¾¤çš„æ­£å¸¸ç”Ÿæ´»ï¼Œç”šè‡³å¯èƒ½å¼•èµ·èœ‚ç¾¤åº”æ¿€ååº”ï¼Œå½±å“èœ‚èœœäº§é‡ä¸èœ‚ç¾¤å¥åº·ã€‚æ­¤å¤–ï¼Œå¯¹äºç—…è™«å®³ã€å¤©æ•Œå…¥ä¾µã€åˆ†èœ‚é¢„å…†ç­‰çªå‘çŠ¶å†µï¼Œä¼ ç»Ÿç®¡ç†æ–¹å¼å¾€å¾€å“åº”è¿Ÿç¼“ï¼Œå®¹æ˜“é”™å¤±æœ€ä½³å¹²é¢„æ—¶æœºï¼Œç»™å…»èœ‚ä¸šå¸¦æ¥æ˜¾è‘—çš„ç»æµæŸå¤±ã€‚</p>
<p>åœ¨æ­¤èƒŒæ™¯ä¸‹ï¼Œå°†ç‰©è”ç½‘ï¼ˆIoTï¼‰æŠ€æœ¯ä¸ç°ä»£ä¼ æ„ŸæŠ€æœ¯ç›¸ç»“åˆï¼Œåº”ç”¨äºä¼ ç»Ÿå…»èœ‚ä¸šçš„æ•°å­—åŒ–è½¬å‹ï¼Œæˆä¸ºæå‡å…»èœ‚æ•ˆç‡ä¸ç§‘å­¦ç®¡ç†æ°´å¹³çš„å…³é”®è·¯å¾„ã€‚ç‰©è”ç½‘æŠ€æœ¯èƒ½å¤Ÿå®ç°å¯¹ç¯å¢ƒå’Œè®¾å¤‡çŠ¶æ€çš„è¿œç¨‹ã€å®æ—¶ã€æ— å¹²æ‰°ç›‘æµ‹ï¼Œé€šè¿‡æ•°æ®åˆ†æä¸ºç”Ÿäº§å†³ç­–æä¾›ç§‘å­¦ä¾æ®ã€‚å°†è¿™ä¸€æŠ€æœ¯åº”ç”¨äºèœ‚ç®±ï¼Œå¯ä»¥æ‰“ç ´ä¼ ç»Ÿå…»èœ‚ä¸šåœ¨ç©ºé—´å’Œæ—¶é—´ä¸Šçš„é™åˆ¶ï¼Œå®ç°å¯¹èœ‚ç¾¤çŠ¶æ€çš„å…¨å¤©å€™ã€æ•°æ®åŒ–ã€å¯è§†åŒ–ç®¡ç†ï¼Œä»è€Œæ¨åŠ¨å…»èœ‚ä¸šä»â€œç»éªŒå…»èœ‚â€å‘â€œç§‘å­¦å…»èœ‚â€çš„ç°ä»£åŒ–å‡çº§ã€‚</p>
<p>æœ¬é¡¹ç›®è®¾è®¡å¹¶å®ç°ä¸€å¥—åŸºäºç‰©è”ç½‘çš„èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿï¼Œä»¥åº”å¯¹ä¼ ç»Ÿå…»èœ‚æ¨¡å¼çš„ç—›ç‚¹ã€‚è¯¥ç³»ç»Ÿé€šè¿‡é›†æˆå¤šç§ä¼ æ„Ÿå™¨ï¼Œå®æ—¶é‡‡é›†èœ‚ç®±å†…å¤–çš„å…³é”®ç¯å¢ƒå‚æ•°ï¼Œå¦‚æ¸©åº¦ã€æ¹¿åº¦ã€é‡é‡ã€å£°éŸ³ã€éœ‡åŠ¨åŠå…‰ç…§å¼ºåº¦ç­‰ã€‚è¿™äº›æ•°æ®é€šè¿‡4Gæˆ–Wi-Fiç­‰æ— çº¿é€šä¿¡æ–¹å¼ï¼Œå®æ—¶ä¸Šä¼ è‡³äº‘ç«¯æœåŠ¡å™¨ã€‚å…»èœ‚ç®¡ç†è€…å¯ä»¥é€šè¿‡ä¸Šä½æœºè½¯ä»¶è¿œç¨‹è®¿é—®è¿™äº›æ•°æ®ï¼Œç›´è§‚åœ°äº†è§£èœ‚ç¾¤çš„å¥åº·çŠ¶å†µã€æ´»åŠ¨è§„å¾‹ä»¥åŠèœ‚èœœçš„äº§å‡ºæƒ…å†µï¼Œå¹¶é€šè¿‡ç³»ç»Ÿè®¾å®šçš„æŠ¥è­¦é˜ˆå€¼ï¼ŒåŠæ—¶è·å–å¦‚å¤±é‡ï¼ˆå¯èƒ½çš„åˆ†èœ‚æˆ–é¥¥é¥¿ï¼‰ã€è¶…é‡ï¼ˆèœ‚èœœå·²æ»¡ï¼‰ã€å¼‚å¸¸éœ‡åŠ¨ï¼ˆå¤©æ•Œå…¥ä¾µï¼‰ç­‰é¢„è­¦ä¿¡æ¯ï¼Œä»è€Œå®ç°ç²¾å‡†ã€é«˜æ•ˆã€ä½å¹²æ‰°çš„ç°ä»£åŒ–èœ‚ç¾¤ç®¡ç†ï¼Œæœ€ç»ˆè¾¾åˆ°é™æœ¬å¢æ•ˆã€æå‡èœ‚èœœäº§é‡ä¸å“è´¨çš„ç›®çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f85f727f62884178a36a1b5c317b96e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=nKSfwATnYbsm04AOMU5WxMvjmHc%3D" alt="4" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b5b10b5ea4f48dbb5f440c71d17ca10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=XGr2n7NkjI4%2FvbZEy5YxL1MgMZ0%3D" alt="mermaid_20251203_313da6" loading="lazy"/></p>
<h4 data-id="heading-3">ã€2ã€‘è®¾è®¡å®ç°çš„åŠŸèƒ½</h4>
<p>å½“å‰é¡¹ç›®ä½¿ç”¨çš„ç›¸å…³è½¯ä»¶å·¥å…·ã€æ¨¡å—æºç å·²ç»ä¸Šä¼ ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fccnr8sukk85n.feishu.cn%2Fwiki%2FQjY8weDYHibqRYkFP2qcA9aGnvb%3Ffrom%3Dfrom_copylink" target="_blank" title="https://ccnr8sukk85n.feishu.cn/wiki/QjY8weDYHibqRYkFP2qcA9aGnvb?from=from_copylink" ref="nofollow noopener noreferrer">ccnr8sukk85n.feishu.cn/wiki/QjY8weâ€¦</a></p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨ STM32F103C8T6 å®Œæˆæ¸©æ¹¿åº¦ã€é‡é‡ã€å£°éŸ³ã€éœ‡åŠ¨ç­‰ä¼ æ„Ÿå™¨çš„é‡‡é›†ä¸æ•°å­—å¤„ç†ã€‚</p>
<p>ï¼ˆ2ï¼‰é€šè¿‡ HX711 å®Œæˆèœ‚ç®±é‡é‡ä¼ æ„Ÿå™¨ï¼ˆç§°é‡ä¼ æ„Ÿå™¨ï¼‰çš„é«˜ç²¾åº¦é‡‡é›†ä¸æ ¡å‡†ã€‚</p>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨ä¸€ä¸ª DHT11 å®Œæˆèœ‚ç®±å†…éƒ¨æ¸©æ¹¿åº¦ç²¾å‡†æµ‹é‡ï¼Œå®ç°æ•°æ®è¡¥å¿ä¸æ»¤æ³¢ã€‚</p>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨ä¸€ä¸ª DHT11 å®Œæˆå¤–éƒ¨ç¯å¢ƒæ¸©æ¹¿åº¦æµ‹é‡ï¼Œä¸Šä¼ å¯¹æ¯”åˆ†ææ•°æ®ã€‚</p>
<p>ï¼ˆ5ï¼‰ä½¿ç”¨ MAX9814 éº¦å…‹é£æ¨¡å—é‡‡é›†èœ‚ç®±å£°å­¦ä¿¡æ¯ï¼Œç”¨äºèœ‚ç¾¤æ´»åŠ›åˆ¤æ–­ã€‚</p>
<p>ï¼ˆ6ï¼‰ä½¿ç”¨ SW420 éœ‡åŠ¨æ¨¡å—é‡‡é›†èœ‚ç®±éœ‡åŠ¨æƒ…å†µï¼Œå®ç°å¼‚å¸¸éœ‡åŠ¨æŠ¥è­¦ã€‚</p>
<p>ï¼ˆ7ï¼‰ä½¿ç”¨ BH1750 å…‰ç…§ä¼ æ„Ÿå™¨æµ‹é‡å¤–ç•Œå…‰ç…§å¼ºåº¦ï¼Œè¾…åŠ©åˆ¤æ–­èœ‚ç¾¤æ´»åŠ¨å‘¨æœŸã€‚</p>
<p>ï¼ˆ8ï¼‰ä½¿ç”¨ OLED 0.96 æ˜¾ç¤ºå±æ˜¾ç¤ºå®æ—¶çš„èœ‚ç®±å†…éƒ¨æ¸©æ¹¿åº¦ã€é‡é‡ã€å…‰ç…§ç­‰ä¿¡æ¯ã€‚</p>
<p>ï¼ˆ9ï¼‰ä½¿ç”¨ Air780E æ¨¡å—å®ç° 4G LTE ç‰©è”ç½‘æ•°æ®é€šä¿¡æˆ–é€‰æ‹© ESP8266-WIFIï¼Œä¸Šä¼ æ•°æ®è‡³åä¸ºäº‘ã€‚</p>
<p>ï¼ˆ10ï¼‰é€šè¿‡ MQTT åè®®å®ç°èœ‚ç®±æ•°æ®ä¸ŠæŠ¥ã€é˜ˆå€¼ä¸‹å‘å’ŒæŠ¥è­¦æ¨é€ã€‚</p>
<p>ï¼ˆ11ï¼‰ä¸Šä½æœºé‡‡ç”¨ Qtï¼ˆC++ï¼‰å®ç°æ•°æ®æ¥æ”¶å¯è§†åŒ–æ˜¾ç¤ºã€‚</p>
<h4 data-id="heading-4">ã€3ã€‘é¡¹ç›®ç¡¬ä»¶æ¨¡å—ç»„æˆ</h4>
<p>ï¼ˆ1ï¼‰ä¸»æ§æ¨¡å—ï¼šSTM32F103C8T6 æ ¸å¿ƒæ¿</p>
<p>ï¼ˆ2ï¼‰å†…éƒ¨æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼šDHT11</p>
<p>ï¼ˆ3ï¼‰å¤–éƒ¨ç¯å¢ƒæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼šDHT11</p>
<p>ï¼ˆ4ï¼‰é‡é‡ä¼ æ„Ÿå™¨ï¼š10kg ç§°é‡ä¼ æ„Ÿå™¨ + HX711 æ”¾å¤§å™¨</p>
<p>ï¼ˆ5ï¼‰å£°éŸ³é‡‡é›†æ¨¡å—ï¼šMAX9814 è‡ªåŠ¨å¢ç›Šéº¦å…‹é£æ¨¡å—</p>
<p>ï¼ˆ6ï¼‰éœ‡åŠ¨ä¼ æ„Ÿå™¨ï¼šSW420 éœ‡åŠ¨æ£€æµ‹æ¨¡å—</p>
<p>ï¼ˆ7ï¼‰å…‰ç…§é‡‡é›†æ¨¡å—ï¼šBH1750</p>
<p>ï¼ˆ8ï¼‰é€šä¿¡æ¨¡å—ï¼šAir780Eï¼ˆ4G LTE Cat1ï¼‰ æˆ–ESP8266-01S</p>
<p>ï¼ˆ9ï¼‰æ˜¾ç¤ºæ¨¡å—ï¼šOLED 0.96 I2C æ˜¾ç¤ºå±</p>
<p>ï¼ˆ10ï¼‰ç”µæºæ¨¡å—ï¼šDC-DC 5V/3.3V ç¨³å‹æ¨¡å—ï¼ˆAMS1117ï¼‰</p>
<p>ï¼ˆ11ï¼‰ç”µæ± ï¼š18650 é”‚ç”µæ±  + ä¿æŠ¤æ¿ + å¤ªé˜³èƒ½æ¿ï¼ˆæˆ·å¤–éƒ¨ç½²ï¼‰</p>
<h4 data-id="heading-5">ã€4ã€‘è®¾è®¡æ„ä¹‰</h4>
<p>æœ¬é¡¹ç›®è®¾è®¡çš„æ™ºèƒ½èœ‚ç®±ç›‘æµ‹ç³»ç»Ÿï¼Œå…¶æ ¸å¿ƒæ„ä¹‰åœ¨äºåˆ©ç”¨ç‰©è”ç½‘å’Œä¼ æ„ŸæŠ€æœ¯ï¼Œå°†ä¼ ç»Ÿå…»èœ‚æ¨¡å¼ä»ä¾èµ–äººåŠ›å’Œç»éªŒçš„ç²—æ”¾å¼ç®¡ç†ï¼Œè½¬å˜ä¸ºä¸€ç§éä¾µå…¥å¼ã€æ•°æ®åŒ–çš„ç²¾ç»†åŒ–ç®¡ç†æ¨¡å¼ã€‚å®ƒè§£å†³äº†é¢‘ç¹å¼€ç®±æ£€æŸ¥å¯¹èœ‚ç¾¤é€ æˆçš„å¹²æ‰°é—®é¢˜ï¼Œå®ç°äº†å¯¹èœ‚ç®±å†…éƒ¨çŠ¶æ€çš„æŒç»­ã€æ— å£°ç›‘æµ‹ï¼Œä¸ºå…»èœ‚ä¸šçš„ç°ä»£åŒ–è½¬å‹æä¾›äº†åˆ‡å®å¯è¡Œçš„æŠ€æœ¯è·¯å¾„ã€‚</p>
<p>è¯¥è®¾è®¡çš„æ·±è¿œæ„ä¹‰ä½“ç°åœ¨å®ƒä¸ºå…»èœ‚å†³ç­–æä¾›äº†ç§‘å­¦çš„æ•°æ®æ”¯æŒã€‚é€šè¿‡é›†æˆæ¸©åº¦ã€æ¹¿åº¦ã€é‡é‡ã€å£°éŸ³ã€å…‰ç…§å’Œéœ‡åŠ¨ç­‰å¤šç§ä¼ æ„Ÿå™¨ï¼Œç³»ç»Ÿèƒ½å¤Ÿæ„å»ºä¸€ä¸ªå…³äºèœ‚ç¾¤å¥åº·ã€æ´»åŠ›ã€ç¹æ®–å’Œç”Ÿäº§çŠ¶æ€çš„å¤šç»´åº¦æ•°æ®æ¨¡å‹ã€‚å…»èœ‚äººä¸å†ä»…ä»…ä¾èµ–ä¸»è§‚ç»éªŒæ¥åˆ¤æ–­èœ‚ç¾¤çŠ¶å†µï¼Œè€Œæ˜¯å¯ä»¥æ ¹æ®å®æ—¶ã€å®¢è§‚çš„æ•°æ®è¿›è¡Œåˆ†æã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å¯¹æ¯”ç®±å†…å¤–æ¸©æ¹¿åº¦å’Œå…‰ç…§å¼ºåº¦ï¼Œå¯ä»¥æ›´å‡†ç¡®åœ°è¯„ä¼°èœ‚ç¾¤çš„æ´»åŠ¨èŠ‚å¾‹ï¼›é€šè¿‡åˆ†æå£°éŸ³é¢‘ç‡ï¼Œå¯ä»¥é¢„åˆ¤åˆ†èœ‚æˆ–ç—…æ€ç­‰å¼‚å¸¸æƒ…å†µï¼Œä»è€Œå°†â€œç»éªŒå…»èœ‚â€æå‡åˆ°â€œç§‘å­¦å…»èœ‚â€çš„å…¨æ–°æ°´å¹³ã€‚</p>
<p>æ­¤ç³»ç»Ÿæ˜¾è‘—æå‡äº†å…»èœ‚ç®¡ç†çš„æ•ˆç‡ä¸å“åº”é€Ÿåº¦ã€‚å€ŸåŠ©4Gæˆ–Wi-Fiæ— çº¿é€šä¿¡æ¨¡å—ï¼Œæ‰€æœ‰é‡‡é›†çš„æ•°æ®éƒ½èƒ½å®æ—¶ä¼ è¾“è‡³äº‘æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡ä¸Šä½æœºè½¯ä»¶è¿›è¡Œå¯è§†åŒ–å‘ˆç°ã€‚è¿™æ„å‘³ç€ç®¡ç†è€…å¯ä»¥éšæ—¶éšåœ°è¿œç¨‹ç›‘æ§èœ‚ç®±ï¼Œæå¤§åœ°é™ä½äº†å·¡æŸ¥æˆæœ¬å’ŒåŠ³åŠ¨å¼ºåº¦ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒåŸºäºé‡é‡å’Œéœ‡åŠ¨ç­‰å…³é”®æŒ‡æ ‡çš„é˜ˆå€¼æŠ¥è­¦åŠŸèƒ½ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿä¸»åŠ¨é¢„è­¦æ½œåœ¨é£é™©ï¼Œå¦‚èœ‚èœœæ»¡æº¢ã€èœ‚ç¾¤å¤±é‡ï¼ˆå¯èƒ½ç”±åˆ†èœ‚æˆ–é¥¥è’å¯¼è‡´ï¼‰æˆ–å¤–éƒ¨ä¾µæ‰°ï¼Œä½¿ç®¡ç†è€…èƒ½å¤Ÿç¬¬ä¸€æ—¶é—´é‡‡å–å¹²é¢„æªæ–½ï¼Œå˜è¢«åŠ¨ç®¡ç†ä¸ºä¸»åŠ¨é¢„é˜²ï¼Œæœ‰æ•ˆè§„é¿ç»æµæŸå¤±ã€‚</p>
<p>æœ¬è®¾è®¡çš„ç°å®æ„ä¹‰è¿˜åœ¨äºå…¶é«˜åº¦çš„å®ç”¨æ€§å’Œå¯éƒ¨ç½²æ€§ã€‚ç³»ç»Ÿæä¾›äº†4Gå’ŒWi-Fiä¸¤ç§é€šä¿¡æ–¹æ¡ˆï¼Œä½¿å…¶èƒ½å¤Ÿçµæ´»é€‚åº”ä¸åŒåœºåœ°çš„ç½‘ç»œæ¡ä»¶ï¼Œæ— è®ºæ˜¯åè¿œå±±åŒºè¿˜æ˜¯å®¶åº­å†œåœºã€‚ç»“åˆå¤ªé˜³èƒ½æ¿å’Œé”‚ç”µæ± çš„ä¾›ç”µæ–¹æ¡ˆï¼Œç¡®ä¿äº†è®¾å¤‡åœ¨æˆ·å¤–ç¯å¢ƒä¸‹çš„é•¿æœŸç¨³å®šè¿è¡Œã€‚åŒæ—¶ï¼Œæœ¬åœ°OLEDæ˜¾ç¤ºå±çš„è®¾è®¡ä¹Ÿä¸ºç°åœºç»´æŠ¤å’Œå¿«é€Ÿè¯Šæ–­æä¾›äº†ä¾¿åˆ©ã€‚è¿™å¥—å®Œæ•´çš„è½¯ç¡¬ä»¶è§£å†³æ–¹æ¡ˆä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯éªŒè¯åŸå‹ï¼Œæ›´æ˜¯ä¸€ä¸ªå…·å¤‡å®é™…åº”ç”¨ä»·å€¼ã€èƒ½å¤Ÿç›´æ¥æœåŠ¡äºå…»èœ‚ç”Ÿäº§ã€é™ä½ç®¡ç†é—¨æ§›ã€æå‡äº§ä¸šæ•ˆç›Šçš„æ™ºèƒ½åŒ–å·¥å…·ã€‚</p>
<h4 data-id="heading-6">ã€5ã€‘å¸‚é¢ä¸ŠåŒç±»äº§å“ç ”ç©¶ç°çŠ¶</h4>
<h5 data-id="heading-7">æ¡ˆä¾‹ä¸€ï¼šå›½å†…çš„å…ˆè¡Œè€…â€”â€”å¤©åºœèœ‚è°·â€œå¤§èœ‚æ…§â€æ™ºèƒ½èœ‚ç®±</h5>
<p>å››å·å¤©åºœèœ‚è°·ç§‘æŠ€æœ‰é™å…¬å¸æ˜¯å›½å†…æ™ºæ…§å…»èœ‚é¢†åŸŸçš„ä»£è¡¨ä¼ä¸šä¹‹ä¸€ã€‚   ä»–ä»¬çš„æ ¸å¿ƒäº§å“æ˜¯â€œå¤§èœ‚æ…§â€AIå…»èœ‚ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿæ·±åº¦èåˆäº†ç‰©è”ç½‘ä¸å¤§æ•°æ®æŠ€æœ¯ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šè¿™å¥—ç³»ç»Ÿä¸æ‚¨çš„è®¾è®¡éå¸¸ç›¸ä¼¼ï¼ŒåŒæ ·é€šè¿‡åœ¨èœ‚ç®±åº•éƒ¨å®‰è£…æ™ºèƒ½ä¼ æ„Ÿå™¨ï¼Œå®æ—¶é‡‡é›†èœ‚ç®±çš„é‡é‡ã€èœœèœ‚å‡ºå…¥èœ‚ç®±çš„æ¬¡æ•°ï¼ˆå³â€œå‡ºå‹¤ç‡â€ï¼‰ç­‰æ•°æ®ã€‚   è¿™äº›æ•°æ®é€šè¿‡æ— çº¿ç½‘ç»œä¼ è¾“åˆ°äº‘ç«¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰‹æœºAppéšæ—¶æŸ¥çœ‹ï¼Œå®ç°äº†è¿œç¨‹ã€æ— å¹²æ‰°çš„èœ‚ç®±çŠ¶æ€ç›‘æ§ã€‚</li>
<li><strong>æŠ€æœ¯äº®ç‚¹</strong>ï¼šå¤©åºœèœ‚è°·å¼ºè°ƒå…¶â€œèœœèœ‚å¤šç»´å¤§æ•°æ®å¹³å°â€ï¼Œè¯¥å¹³å°ä¸ä»…æ”¶é›†æ•°æ®ï¼Œè¿˜åˆ©ç”¨AIè¿›è¡Œè®¡ç®—å’Œåˆ†æï¼Œä¸ºå…»èœ‚æˆ·æä¾›ç²¾å‡†çš„æ•°æ®æœåŠ¡å’Œå¼‚å¸¸é¢„è­¦ã€‚   ä¾‹å¦‚ï¼Œé€šè¿‡åˆ†æèœ‚ç®±é‡é‡å˜åŒ–æ›²çº¿ï¼Œå¯ä»¥åˆ¤æ–­èœ‚èœœæ˜¯å¦æˆç†Ÿï¼Œä½•æ—¶å¯ä»¥å–èœœï¼›é€šè¿‡ç›‘æµ‹èœœèœ‚å‡ºå‹¤æ•°æ®ï¼Œå¯ä»¥è¯„ä¼°èœ‚ç¾¤çš„å¥åº·ä¸æ´»åŠ›ã€‚</li>
<li><strong>è§£å†³çš„ç—›ç‚¹</strong>ï¼šè¯¥ç³»ç»Ÿæ˜¾è‘—å‡å°‘äº†ä¼ ç»Ÿå…»èœ‚ä¸­é¢‘ç¹çš„äººå·¥å¼€ç®±æ£€æŸ¥ï¼Œé™ä½äº†70%çš„åŠ³åŠ¨é‡ï¼ŒåŒæ—¶å‡å°‘äº†å¯¹èœ‚ç¾¤50%çš„å¹²æ‰°ã€‚   å¯¹äºå…»èœ‚å¤§æˆ·æ¥è¯´ï¼ŒåŸæœ¬éœ€è¦å¤šäººå¤šå¤©å®Œæˆçš„å·¡æŸ¥å·¥ä½œï¼Œç°åœ¨åªéœ€å°‘æ•°äººé€šè¿‡æ‰‹æœºå³å¯å®Œæˆï¼Œå¤§å¹…æå‡äº†ç®¡ç†æ•ˆç‡ã€‚ æ­¤å¤–ï¼Œè¯¥å…¬å¸è¿˜å…³æ³¨åˆ°äº†é‡å¤–èœ‚åœºä¾›ç”µå’Œç½‘ç»œè¦†ç›–çš„éš¾é¢˜ï¼Œå¹¶é€šè¿‡å¤ªé˜³èƒ½å…‰ä¼æ¿å’Œä¼˜åŒ–çš„ä½åŠŸè€—è®¾è®¡æ¥åº”å¯¹ã€‚</li>
</ul>
<h5 data-id="heading-8">æ¡ˆä¾‹äºŒï¼šå›½é™…è§†é‡ä¸‹çš„åˆ›æ–°è€…â€”â€”ä»¥è‰²åˆ—Beewiseå…¬å¸çš„â€œBeeHomeâ€</h5>
<p>Beewiseæ˜¯ä¸€å®¶å¤‡å—å…³æ³¨çš„ä»¥è‰²åˆ—å†œä¸šç§‘æŠ€åˆåˆ›å…¬å¸ï¼Œä»–ä»¬æ¨å‡ºçš„â€œBeeHomeâ€äº§å“ï¼Œåœ¨æ™ºèƒ½åŒ–å’Œè‡ªåŠ¨åŒ–æ–¹é¢è¿ˆå‡ºäº†æ›´å¤§çš„ä¸€æ­¥ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šâ€œBeeHomeâ€ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç›‘æµ‹è®¾å¤‡ï¼Œå®ƒæ›´åƒä¸€ä¸ªæœºå™¨äººç®¡å®¶ã€‚å®ƒåœ¨ä¸€ä¸ªå¤§å‹ç®±ä½“ä¸­å®¹çº³å¤šä¸ªèœ‚ç¾¤ï¼Œå¹¶é€šè¿‡å†…ç½®çš„æœºå™¨äººã€è®¡ç®—æœºè§†è§‰å’ŒAIæŠ€æœ¯ï¼Œå®ç°24/7çš„å…¨å¤©å€™ç›‘æµ‹å’Œè‡ªåŠ¨å¹²é¢„ã€‚</li>
<li><strong>æŠ€æœ¯äº®ç‚¹</strong>ï¼šå…¶æœ€å¤§çš„ç‰¹è‰²æ˜¯â€œæœºå™¨äººå…»èœ‚â€ã€‚ç³»ç»Ÿé€šè¿‡æ‘„åƒå¤´å’Œä¼ æ„Ÿå™¨ç›‘æµ‹èœ‚ç¾¤ï¼Œå½“AIç®—æ³•å‘ç°é—®é¢˜æ—¶ï¼ˆå¦‚ç—…è™«å®³ã€èœ‚ç‹é—®é¢˜ã€åˆ†èœ‚é¢„å…†ç­‰ï¼‰ï¼Œæœºå™¨äººä¼šè‡ªåŠ¨é‡‡å–è¡ŒåŠ¨ï¼Œä¾‹å¦‚æ–½è¯ã€è°ƒæ•´ç¯å¢ƒæˆ–åˆå¹¶èœ‚ç¾¤ï¼Œå…¨ç¨‹æ— éœ€äººå·¥ä»‹å…¥ã€‚ Beewiseå£°ç§°è¿™ç§æ–¹å¼èƒ½æ˜¾è‘—é™ä½é«˜è¾¾35%çš„èœ‚ç¾¤å´©æºƒç‡ã€‚</li>
<li>
<ul>
<li><strong>å•†ä¸šæ¨¡å¼</strong>ï¼šBeewiseçš„æ¨¡å¼ä¸ä»…æ˜¯é”€å”®ç¡¬ä»¶ï¼Œæ›´ä¾§é‡äºæä¾›æˆç²‰æœåŠ¡ã€‚ä»–ä»¬ä¸å†œåœºä¸»åˆä½œï¼Œé€šè¿‡å…¶é«˜æ•ˆçš„èœ‚ç¾¤ç®¡ç†æŠ€æœ¯ï¼Œç¡®ä¿ä½œç‰©æˆç²‰çš„è´¨é‡å’Œæ•ˆç‡ï¼Œè§£å†³äº†å› èœ‚ç¾¤æ•°é‡ä¸‹é™å¯¼è‡´çš„æˆç²‰æœåŠ¡ä»·æ ¼ä¸Šæ¶¨å’Œä¾›åº”ä¸ç¨³å®šçš„é—®é¢˜ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-9">æ¡ˆä¾‹ä¸‰ï¼šåŠŸèƒ½å…¨é¢çš„è§£å†³æ–¹æ¡ˆæä¾›å•†â€”â€”æ…§å…»èœ‚</h5>
<p>â€œæ…§å…»èœ‚â€æ˜¯ä¸­å›½å†œä¸šç§‘å­¦é™¢èœœèœ‚ç ”ç©¶æ‰€èƒŒæ™¯ä¸‹çš„ä¸€ä¸ªå“ç‰Œï¼Œæä¾›ä»ç¡¬ä»¶åˆ°è½¯ä»¶çš„ä¸€æ•´å¥—æ™ºæ…§èœ‚ä¸šè§£å†³æ–¹æ¡ˆã€‚</p>
<ul>
<li><strong>äº§å“ç³»åˆ—åŒ–</strong>ï¼šä»–ä»¬æ ¹æ®ä¸åŒç”¨æˆ·éœ€æ±‚ï¼Œæ¨å‡ºäº†åŸºç¡€ç‰ˆã€æ ‡å‡†ç‰ˆã€é«˜çº§ç‰ˆç­‰ä¸åŒé…ç½®çš„æ™ºèƒ½èœ‚ç®±ã€‚ åŸºç¡€ç‰ˆä¾§é‡äºå†…éƒ¨ç¯å¢ƒç›‘æµ‹å’Œæ— çº¿ä¼ è¾“ï¼Œç”±å¤ªé˜³èƒ½ä¾›ç”µï¼Œæ˜“äºéƒ¨ç½²ã€‚ è€Œæ ‡å‡†ç‰ˆåˆ™å¢åŠ äº†è§†é¢‘ç›‘æ§å’Œæ›´ç²¾ç¡®çš„èœœèœ‚è®¡æ•°åŠŸèƒ½ã€‚</li>
<li><strong>å¹³å°åŒ–æœåŠ¡</strong>ï¼šé™¤äº†æ™ºèƒ½ç¡¬ä»¶ï¼Œä»–ä»¬è¿˜æä¾›èœ‚äº§å“è´¨é‡å®‰å…¨è¿½æº¯å¹³å°ã€èœ‚äº§ä¸šå¤§æ•°æ®ç®¡ç†å†³ç­–å¹³å°å’Œèœ‚ä¸šå…¬å…±æœåŠ¡å¹³å°ç­‰ã€‚ è¿™è¡¨æ˜å¸‚åœºè¶‹åŠ¿æ­£ä»å•ä¸€çš„ç¡¬ä»¶é”€å”®ï¼Œè½¬å‘æä¾›å…¨äº§ä¸šé“¾çš„æ•°å­—åŒ–æœåŠ¡ï¼ŒåŒ…æ‹¬ç”Ÿäº§ç®¡ç†ã€äº§å“æº¯æºå’Œä¿¡æ¯å…±äº«ã€‚</li>
</ul>
<h5 data-id="heading-10">æ€»ç»“ä¸å…±æ€§</h5>
<p>ç»¼åˆæ¥çœ‹ï¼Œå¸‚é¢ä¸Šçš„åŒç±»äº§å“åœ¨æ ¸å¿ƒæ€è·¯ä¸Šé€šè¿‡ä¼ æ„Ÿå™¨é‡‡é›†æ•°æ®ï¼Œå®ç°è¿œç¨‹ç›‘æ§å’Œæ™ºèƒ½é¢„è­¦ã€‚   <strong>é‡é‡ã€æ¸©åº¦ã€æ¹¿åº¦</strong>æ˜¯æ‰€æœ‰äº§å“çš„æ ‡é…ç›‘æµ‹æŒ‡æ ‡ã€‚   <strong>å£°éŸ³ç›‘æµ‹</strong>ä¹Ÿé€æ¸æˆä¸ºä¸»æµï¼Œç”¨äºåˆ†æèœ‚ç¾¤çš„â€œè„‰åŠ¨â€å’ŒçŠ¶æ€ã€‚   åœ¨é€šä¿¡æ–¹é¢ï¼ŒåŒæ ·é‡‡ç”¨4G/LTEæˆ–Wi-Fiç­‰æ–¹æ¡ˆå°†æ•°æ®ä¸Šä¼ è‡³äº‘å¹³å°ã€‚</p>
<h4 data-id="heading-11">ã€6ã€‘æ‘˜è¦</h4>
<p>ä¸ºè§£å†³ä¼ ç»Ÿå…»èœ‚ä¸šä¾èµ–äººå·¥ã€ç®¡ç†æ•ˆç‡ä½ä¸‹ã€å¹²æ‰°èœ‚ç¾¤ç­‰é—®é¢˜ï¼Œæœ¬é¡¹ç›®è®¾è®¡å¹¶å®ç°äº†ä¸€å¥—åŸºäºç‰©è”ç½‘ï¼ˆIoTï¼‰çš„èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿä»¥STM32F103C8T6å•ç‰‡æœºä½œä¸ºä¸»æ§æ ¸å¿ƒï¼Œé›†æˆDHT11æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ã€HX711ç§°é‡æ¨¡å—ã€MAX9814å£°éŸ³ä¼ æ„Ÿå™¨ã€SW420éœ‡åŠ¨ä¼ æ„Ÿå™¨åŠBH1750å…‰ç…§ä¼ æ„Ÿå™¨ï¼Œå®ç°å¯¹èœ‚ç®±å†…å¤–ç¯å¢ƒã€èœ‚ç¾¤æ´»åŠ›ã€èœ‚èœœäº§é‡åŠå¤–éƒ¨å¹²æ‰°ç­‰å¤šç»´åº¦ä¿¡æ¯çš„å®æ—¶é‡‡é›†ã€‚ç³»ç»Ÿæ”¯æŒé€šè¿‡Air780Eï¼ˆ4Gï¼‰æˆ–ESP8266ï¼ˆWi-Fiï¼‰æ¨¡å—ï¼Œåˆ©ç”¨MQTTåè®®å°†æ•°æ®ç¨³å®šä¸Šä¼ è‡³åä¸ºäº‘IoTDAå¹³å°ã€‚åŒæ—¶ï¼Œæ•°æ®å¯åœ¨æœ¬åœ°OLEDå±å¹•ä¸Šå®æ—¶æ˜¾ç¤ºï¼Œå¹¶é€šè¿‡Qtå¼€å‘çš„ä¸Šä½æœºè½¯ä»¶è¿›è¡Œè¿œç¨‹å¯è§†åŒ–ç›‘æ§ä¸æŠ¥è­¦é˜ˆå€¼é…ç½®ã€‚æœ¬è®¾è®¡æ—¨åœ¨å®ç°å¯¹èœ‚ç®±çš„è¿œç¨‹åŒ–ã€æ•°æ®åŒ–ã€æ— å¹²æ‰°å¼ç®¡ç†ï¼Œä»¥æå‡å…»èœ‚çš„ç§‘å­¦æ€§ä¸ç»æµæ•ˆç›Šã€‚</p>
<hr/>
<p><strong>å…³é”®å­—</strong></p>
<ul>
<li>ç‰©è”ç½‘</li>
<li>æ™ºèƒ½èœ‚ç®±</li>
<li>STM32</li>
<li>ä¼ æ„Ÿå™¨ç½‘ç»œ</li>
<li>MQTT</li>
<li>åä¸ºäº‘</li>
<li>Qt</li>
</ul>
<h3 data-id="heading-12">1.2 è®¾è®¡æ€è·¯</h3>
<p>æœ¬é¡¹ç›®çš„è®¾è®¡æ€è·¯å›´ç»•æ¨¡å—åŒ–ã€å®ç”¨æ€§å’Œå¯æ‰©å±•æ€§å±•å¼€ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„â€œæ„ŸçŸ¥-ä¼ è¾“-åº”ç”¨â€ç‰©è”ç½‘è§£å†³æ–¹æ¡ˆã€‚æ•´ä½“æ¶æ„åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒå±‚æ¬¡ï¼šåº•å±‚çš„æ•°æ®é‡‡é›†ç«¯ã€ä¸­å±‚çš„ç½‘ç»œä¼ è¾“å±‚ä»¥åŠé¡¶å±‚çš„äº‘å¹³å°ä¸ç”¨æˆ·åº”ç”¨å±‚ã€‚é€šè¿‡è¿™ç§åˆ†å±‚è®¾è®¡ï¼Œå°†å¤æ‚çš„ç³»ç»ŸåŠŸèƒ½è§£è€¦ï¼Œä½¿æ¯ä¸ªéƒ¨åˆ†éƒ½èƒ½ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•å’Œä¼˜åŒ–ï¼Œæœ€ç»ˆé›†æˆä¸ºä¸€ä¸ªé«˜æ•ˆã€å¯é çš„æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿã€‚</p>
<p>åœ¨æ•°æ®é‡‡é›†ç«¯ï¼Œè®¾è®¡çš„æ ¸å¿ƒæ˜¯é€‰ç”¨STM32F103C8T6ä½œä¸ºä¸»æ§èŠ¯ç‰‡ã€‚é€‰æ‹©æ­¤èŠ¯ç‰‡æ˜¯åŸºäºå…¶å¼ºå¤§çš„æ€§èƒ½ã€ä¸°å¯Œçš„ç‰‡ä¸Šå¤–è®¾èµ„æºï¼ˆå¦‚ADCã€I2Cã€SPIç­‰ï¼‰ä»¥åŠå¹¿æ³›çš„ç¤¾åŒºæ”¯æŒï¼Œè¶³ä»¥èƒœä»»åŒæ—¶å¤„ç†å¤šä¸ªä¼ æ„Ÿå™¨æ•°æ®çš„ä»»åŠ¡ã€‚ä¼ æ„Ÿå™¨çš„é€‰æ‹©åˆ™ä¸¥æ ¼å¯¹åº”åŠŸèƒ½éœ€æ±‚ï¼šé€šè¿‡ä¸¤ä¸ªDHT11ä¼ æ„Ÿå™¨åˆ†åˆ«é‡‡é›†èœ‚ç®±å†…éƒ¨å’Œå¤–éƒ¨çš„æ¸©æ¹¿åº¦ï¼Œå½¢æˆå†…å¤–ç¯å¢ƒå¯¹æ¯”ï¼›é‡‡ç”¨é«˜ç²¾åº¦çš„HX711æ¨¡å—é…åˆç§°é‡ä¼ æ„Ÿå™¨ï¼Œå®ç°å¯¹èœ‚ç®±é‡é‡çš„ç²¾ç¡®æµ‹é‡ï¼Œä»è€Œé—´æ¥åæ˜ èœ‚èœœäº§é‡å’Œèœ‚ç¾¤è§„æ¨¡ï¼›åˆ©ç”¨MAX9814éº¦å…‹é£å’ŒSW420éœ‡åŠ¨æ¨¡å—ï¼Œåˆ†åˆ«ä»å£°å­¦å’Œç‰©ç†éœ‡åŠ¨ä¸¤ä¸ªç»´åº¦ç›‘æµ‹èœ‚ç¾¤çŠ¶æ€åŠå¤–éƒ¨å¨èƒï¼›å¹¶è¾…ä»¥BH1750å…‰ç…§ä¼ æ„Ÿå™¨åˆ¤æ–­èœ‚ç¾¤çš„æ˜¼å¤œæ´»åŠ¨å‘¨æœŸã€‚æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®ç”±STM32è¿›è¡Œç»Ÿä¸€çš„é‡‡é›†ã€æ»¤æ³¢å’Œåˆæ­¥å¤„ç†ï¼Œå¹¶é€šè¿‡æœ¬åœ°çš„OLEDæ˜¾ç¤ºå±ä¸ºç°åœºäººå‘˜æä¾›å³æ—¶çš„æ•°æ®åé¦ˆã€‚</p>
<p>åœ¨ç½‘ç»œä¼ è¾“å±‚ï¼Œè®¾è®¡å……åˆ†è€ƒè™‘äº†ä¸åŒéƒ¨ç½²åœºæ™¯çš„ç½‘ç»œå¯ç”¨æ€§ï¼Œæä¾›äº†4Gå’ŒWi-Fiä¸¤ç§çµæ´»çš„é€šä¿¡æ–¹æ¡ˆã€‚å¯¹äºåè¿œã€æ— Wi-Fiè¦†ç›–çš„é‡å¤–èœ‚åœºï¼Œé€‰ç”¨Air780Eæ¨¡ç»„æ¥å…¥4G LTEç½‘ç»œï¼›å¯¹äºå®¶åº­æˆ–æœ‰Wi-Fiç½‘ç»œçš„åœºæ™¯ï¼Œåˆ™å¯é€‰ç”¨æˆæœ¬æ›´ä½çš„ESP8266æ¨¡å—ã€‚é€šä¿¡åè®®é€‰æ‹©äº†è½»é‡çº§çš„MQTTåè®®ï¼Œå®ƒåŸºäºå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œéå¸¸é€‚åˆèµ„æºå—é™çš„ç‰©è”ç½‘è®¾å¤‡ã€‚è®¾å¤‡ä½œä¸ºå®¢æˆ·ç«¯ï¼Œå°†é‡‡é›†åˆ°çš„å„é¡¹æ•°æ®å‘å¸ƒåˆ°äº‘æœåŠ¡å™¨çš„æŒ‡å®šä¸»é¢˜ï¼ˆTopicï¼‰ï¼ŒåŒæ—¶è®¢é˜…é…ç½®ä¸»é¢˜ï¼Œä»¥æ¥æ”¶äº‘ç«¯ä¸‹å‘çš„æŠ¥è­¦é˜ˆå€¼ç­‰æŒ‡ä»¤ï¼Œå®ç°äº†è®¾å¤‡ä¸äº‘å¹³å°ä¹‹é—´é«˜æ•ˆã€ä½åŠŸè€—çš„åŒå‘é€šä¿¡ã€‚</p>
<p>åœ¨äº‘å¹³å°ä¸åº”ç”¨å±‚ï¼Œç³»ç»Ÿä»¥åä¸ºäº‘IoTDAä½œä¸ºæ•°æ®ä¸­æ¢ã€‚è¯¥å¹³å°è´Ÿè´£è®¾å¤‡çš„æ¥å…¥è®¤è¯ã€æ•°æ®æµçš„æ¥æ”¶ã€å­˜å‚¨ä»¥åŠè§„åˆ™å¼•æ“çš„é…ç½®ï¼Œä¸ºåç»­çš„æ•°æ®åˆ†æå’Œåº”ç”¨å¼€å‘æä¾›äº†åšå®çš„åŸºç¡€ã€‚æŠ¥è­¦åŠŸèƒ½ï¼ˆå¦‚è¶…é‡ã€å¤±é‡ã€å¼‚å¸¸éœ‡åŠ¨ï¼‰çš„æ ¸å¿ƒé€»è¾‘åœ¨äº‘ç«¯å®ç°ï¼Œå½“ä¸ŠæŠ¥çš„æ•°æ®è§¦å‘é¢„è®¾é˜ˆå€¼æ—¶ï¼Œå¹³å°èƒ½å¤Ÿä¸»åŠ¨æ¨é€æŠ¥è­¦ä¿¡æ¯ã€‚æœ€ç»ˆï¼Œé¢å‘ç”¨æˆ·çš„äº¤äº’ç•Œé¢é€šè¿‡Qtï¼ˆC++ï¼‰å¼€å‘çš„ä¸Šä½æœºè½¯ä»¶å®ç°ã€‚è¯¥è½¯ä»¶é€šè¿‡è®¢é˜…äº‘å¹³å°ç›¸åº”çš„æ•°æ®ä¸»é¢˜ï¼Œå°†æ¥æ”¶åˆ°çš„å®æ—¶æ•°æ®ç›´è§‚å½¢å¼è¿›è¡Œå¯è§†åŒ–å±•ç¤ºï¼Œå¹¶èƒ½æ¥æ”¶å’Œæ˜¾ç¤ºæŠ¥è­¦é€šçŸ¥ï¼Œä»è€Œè®©ç®¡ç†è€…å¯ä»¥è¿œç¨‹ã€æ¸…æ™°åœ°æŒæ¡èœ‚ç®±çš„å…¨éƒ¨åŠ¨æ€ï¼Œå®ç°ç§‘å­¦å†³ç­–ã€‚</p>
<h3 data-id="heading-13">1.3 ç³»ç»ŸåŠŸèƒ½æ€»ç»“</h3>











































































<table><thead><tr><th>åŠŸèƒ½ç±»åˆ«</th><th>å…·ä½“åŠŸèƒ½æè¿°</th><th>å®ç°æ–¹å¼/æ¶‰åŠæ¨¡å—</th></tr></thead><tbody><tr><td><strong>æ•°æ®é‡‡é›†</strong></td><td>é‡‡é›†èœ‚ç®±å†…éƒ¨çš„å®æ—¶æ¸©åº¦å’Œæ¹¿åº¦ã€‚</td><td>STM32F103C8T6 + å†…éƒ¨DHT11ä¼ æ„Ÿå™¨</td></tr><tr><td/><td>é‡‡é›†èœ‚ç®±å¤–éƒ¨ç¯å¢ƒçš„å®æ—¶æ¸©åº¦å’Œæ¹¿åº¦ã€‚</td><td>STM32F103C8T6 + å¤–éƒ¨DHT11ä¼ æ„Ÿå™¨</td></tr><tr><td/><td>é«˜ç²¾åº¦é‡‡é›†èœ‚ç®±é‡é‡ï¼Œåæ˜ èœ‚èœœé‡ä¸èœ‚ç¾¤è§„æ¨¡ã€‚</td><td>10kgç§°é‡ä¼ æ„Ÿå™¨ + HX711æ”¾å¤§å™¨ + STM32</td></tr><tr><td/><td>é‡‡é›†èœ‚ç®±å†…éƒ¨å£°éŸ³ï¼Œç”¨äºåˆ†æèœ‚ç¾¤çŠ¶æ€ã€‚</td><td>MAX9814éº¦å…‹é£æ¨¡å— + STM32</td></tr><tr><td/><td>é‡‡é›†èœ‚ç®±å…¥å£éœ‡åŠ¨ï¼Œåˆ¤æ–­å¤–éƒ¨å¹²æ‰°æˆ–æ”»å‡»ã€‚</td><td>SW420éœ‡åŠ¨æ¨¡å— + STM32</td></tr><tr><td/><td>é‡‡é›†å¤–éƒ¨ç¯å¢ƒå…‰ç…§å¼ºåº¦ï¼Œè¾…åŠ©åˆ¤æ–­èœ‚ç¾¤æ´»åŠ¨å‘¨æœŸã€‚</td><td>BH1750å…‰ç…§ä¼ æ„Ÿå™¨ + STM32</td></tr><tr><td><strong>æ•°æ®ä¼ è¾“</strong></td><td>æ”¯æŒ4Gæˆ–Wi-Fiç½‘ç»œå°†æ•°æ®ä¸Šä¼ è‡³äº‘æœåŠ¡å™¨ã€‚</td><td>Air780E (4G LTE) æˆ– ESP8266 (Wi-Fi)</td></tr><tr><td/><td>é€šè¿‡MQTTåè®®å®ç°æ•°æ®ä¸ŠæŠ¥å’ŒæŒ‡ä»¤ä¸‹å‘ã€‚</td><td>MQTTåè®®æ ˆ (åœ¨é€šä¿¡æ¨¡å—å’ŒSTM32ä¸Šå®ç°)</td></tr><tr><td><strong>æœ¬åœ°äº¤äº’</strong></td><td>åœ¨èœ‚ç®±æœ¬åœ°å®æ—¶æ˜¾ç¤ºå„é¡¹å…³é”®æ•°æ®ã€‚</td><td>OLED 0.96å¯¸I2Cæ˜¾ç¤ºå±</td></tr><tr><td><strong>è¿œç¨‹ç›‘æ§</strong></td><td>åœ¨ä¸Šä½æœºè½¯ä»¶ä¸Šå®æ—¶å¯è§†åŒ–æ˜¾ç¤ºèœ‚ç®±æ•°æ®ã€‚</td><td>Qt (C++) å¼€å‘çš„ä¸Šä½æœºè½¯ä»¶</td></tr><tr><td><strong>æ™ºèƒ½æŠ¥è­¦</strong></td><td>æ”¯æŒæœåŠ¡å™¨ç«¯é…ç½®æŠ¥è­¦é˜ˆå€¼ï¼ˆæ¸©åº¦ã€æ¹¿åº¦ã€é‡é‡ã€å£°éŸ³ï¼‰ã€‚</td><td>åä¸ºäº‘IoTDAå¹³å°è§„åˆ™å¼•æ“</td></tr><tr><td/><td>å®ç°èœ‚èœœè¿‡è½½æˆ–å¼‚å¸¸å‡é‡æ—¶çš„æŠ¥è­¦ã€‚</td><td>åŸºäºé‡é‡æ•°æ®å’Œäº‘ç«¯é˜ˆå€¼é…ç½®</td></tr><tr><td/><td>å®ç°èœ‚ç®±å¼‚å¸¸éœ‡åŠ¨æ—¶çš„æŠ¥è­¦ã€‚</td><td>åŸºäºéœ‡åŠ¨æ•°æ®å’Œäº‘ç«¯é˜ˆå€¼é…ç½®</td></tr></tbody></table>
<h3 data-id="heading-14">1.4 å¼€å‘å·¥å…·çš„é€‰æ‹©</h3>
<h4 data-id="heading-15">ã€1ã€‘è®¾å¤‡ç«¯å¼€å‘</h4>
<p>ç¡¬ä»¶è®¾å¤‡ç«¯çš„å¼€å‘ä¸»è¦ä¾èµ–äºCè¯­è¨€ï¼Œåˆ©ç”¨è¯¥è¯­è¨€ç›´æ¥æ“ä½œç¡¬ä»¶å¯„å­˜å™¨ï¼Œç¡®ä¿ç³»ç»Ÿè¿è¡Œçš„é«˜æ•ˆæ€§å’Œä½å»¶è¿Ÿã€‚Cè¯­è¨€åœ¨åµŒå…¥å¼å¼€å‘ä¸­å…·æœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œå®ƒèƒ½å¤Ÿç›´æ¥è®¿é—®ç¡¬ä»¶ï¼Œæ»¡è¶³å¯¹èµ„æºæ¶ˆè€—å’Œå“åº”é€Ÿåº¦çš„ä¸¥æ ¼è¦æ±‚ã€‚ä¸ºäº†ç¼–å†™é«˜æ•ˆã€ç¨³å®šçš„ä»£ç ï¼Œå¼€å‘å·¥å…·é€‰æ‹©äº†<strong>Keil uVision 5</strong>ä½œä¸ºä¸»è¦çš„å¼€å‘ç¯å¢ƒã€‚Keilæ˜¯ä¸€ä¸ªä¸“ä¸šçš„åµŒå…¥å¼å¼€å‘å·¥å…·ï¼Œå¹¿æ³›åº”ç”¨äºåŸºäºARMæ¶æ„çš„å¾®æ§åˆ¶å™¨ï¼ˆå¦‚STM32ï¼‰å¼€å‘ã€‚Keilæä¾›äº†å®Œå–„çš„è°ƒè¯•ã€ç¼–è¯‘å’Œä»¿çœŸæ”¯æŒï¼Œèƒ½å¤Ÿå¸®åŠ©åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é«˜æ•ˆåœ°è¿›è¡Œè°ƒè¯•ã€å•æ­¥æ‰§è¡Œä»¥åŠæ–­ç‚¹è®¾ç½®ï¼Œç¡®ä¿å¼€å‘çš„ç¨³å®šæ€§å’Œé«˜æ•ˆæ€§ã€‚
STM32F103RCT6æ˜¯é¡¹ç›®ä¸­ä½¿ç”¨çš„ä¸»æ§èŠ¯ç‰‡ï¼Œå®ƒåŸºäºARM Cortex-M3æ¶æ„ï¼Œæ‹¥æœ‰å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œä¸°å¯Œçš„å¤–è®¾æ¥å£ã€‚åœ¨ç¡¬ä»¶ç¼–ç¨‹ä¸­ï¼Œå¯„å­˜å™¨çº§ç¼–ç¨‹æ˜¯å¸¸ç”¨çš„æ–¹å¼ï¼Œè¿™è¦æ±‚å¼€å‘è€…å¯¹èŠ¯ç‰‡çš„ç¡¬ä»¶å¯„å­˜å™¨æœ‰æ·±å…¥çš„ç†è§£ã€‚åœ¨Keilç¯å¢ƒä¸­ï¼Œé€šè¿‡STM32çš„å¯„å­˜å™¨ç›´æ¥æ§åˆ¶GPIOã€ADCã€I2Cã€SPIç­‰ç¡¬ä»¶æ¥å£ï¼Œä»¥æ»¡è¶³å„ä¸ªç¡¬ä»¶æ¨¡å—ï¼ˆå¦‚ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨ã€æ˜¾ç¤ºå±ç­‰ï¼‰ä¸ä¸»æ§èŠ¯ç‰‡çš„äº¤äº’ã€‚ä½¿ç”¨å¯„å­˜å™¨ç¼–ç¨‹èƒ½å¤Ÿæä¾›æ›´é«˜æ•ˆã€ç²¾ç¡®çš„æ§åˆ¶ï¼Œé¿å…äº†å¤–éƒ¨åº“çš„å¼€é”€ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ·±å…¥è°ƒæ§ç¡¬ä»¶ç‰¹æ€§ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<h4 data-id="heading-16">ã€2ã€‘ä¸Šä½æœºå¼€å‘</h4>
<p>æœ¬é¡¹ç›®çš„ä¸Šä½æœºå¼€å‘åŸºäº<strong>Qt 5</strong>æ¡†æ¶ï¼Œä½¿ç”¨**C++**ä½œä¸ºä¸»è¦ç¼–ç¨‹è¯­è¨€ã€‚Qtæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå¹¿æ³›ç”¨äºå¼€å‘GUIåº”ç”¨ç¨‹åºã€‚Qtæä¾›äº†ä¸°å¯Œçš„GUIç»„ä»¶å’Œå·¥å…·ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å®ç°å›¾å½¢ç•Œé¢çš„è®¾è®¡ä¸å¼€å‘ã€‚C++åˆ™ä½œä¸ºQtçš„åº•å±‚è¯­è¨€ï¼Œå…·æœ‰é«˜æ•ˆçš„æ€§èƒ½å’Œè‰¯å¥½çš„æ§åˆ¶åŠ›ï¼Œéå¸¸é€‚åˆç”¨äºå¤„ç†è®¾å¤‡ä¸ç³»ç»Ÿä¹‹é—´çš„æ•°æ®äº¤äº’ã€é€šä¿¡åè®®çš„å®ç°å’Œå¤æ‚çš„è®¡ç®—ä»»åŠ¡ã€‚åœ¨é¡¹ç›®ä¸­ï¼ŒQtè¢«ç”¨äºå¼€å‘Windowså¹³å°çš„æ¡Œé¢åº”ç”¨ç¨‹åºä»¥åŠAndroidå¹³å°çš„æ‰‹æœºAPPã€‚Qtæ¡†æ¶çš„è·¨å¹³å°ç‰¹æ€§ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨åŒä¸€å¥—ä»£ç åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šè¿›è¡Œæ„å»ºå’Œéƒ¨ç½²ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿å¼€å‘å’Œè°ƒè¯•ï¼Œä¸Šä½æœºçš„å¼€å‘é‡‡ç”¨äº†<strong>Qt Creator</strong>ä½œä¸ºä¸»è¦çš„é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ã€‚Qt Creatoræ˜¯ä¸€æ¬¾ç”±Qtå®˜æ–¹æä¾›çš„å¼€å‘å·¥å…·ï¼Œä¸“ä¸ºQtåº”ç”¨ç¨‹åºå¼€å‘è®¾è®¡ï¼Œæ”¯æŒC++ã€QMLå’ŒJavaScriptç­‰è¯­è¨€ã€‚Qt Creatoræä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¦‚ä»£ç ç¼–è¾‘ã€è°ƒè¯•ã€æ„å»ºã€ç‰ˆæœ¬æ§åˆ¶é›†æˆç­‰ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å¼€å‘è€…çš„ç”Ÿäº§åŠ›ã€‚åœ¨æœ¬é¡¹ç›®ä¸­ï¼ŒQt Creatorä¸ºå¼€å‘è€…æä¾›äº†è‡ªåŠ¨åŒ–æ„å»ºã€ç•Œé¢è®¾è®¡å·¥å…·ï¼ˆå¦‚Qt Designerï¼‰å’Œè°ƒè¯•å·¥å…·ï¼ˆå¦‚QDebugå’ŒQMLè°ƒè¯•å·¥å…·ï¼‰ï¼Œä½¿å¾—å¼€å‘è¿‡ç¨‹æ›´åŠ é«˜æ•ˆå’Œæµç•…ã€‚
ä¸Šä½æœºä¸ç¡¬ä»¶è®¾å¤‡ç«¯çš„é€šä¿¡é‡‡ç”¨äº†åŸºäºTCP/IPåè®®çš„æ•°æ®ä¼ è¾“æ–¹å¼ã€‚ä¸ºäº†å®ç°è¿™ä¸€åŠŸèƒ½ï¼ŒQtæä¾›äº†ä¸°å¯Œçš„ç½‘ç»œç¼–ç¨‹æ”¯æŒï¼Œå°¤å…¶æ˜¯<strong>QTcpSocket</strong>å’Œ<strong>QTcpServer</strong>ç±»ï¼Œä½¿å¾—ä¸Šä½æœºèƒ½å¤Ÿè½»æ¾åœ°ä¸ç¡¬ä»¶è®¾å¤‡å»ºç«‹TCPè¿æ¥ï¼Œè¿›è¡Œæ•°æ®æ”¶å‘ã€‚ä¸Šä½æœºé€šè¿‡WIFIè¿æ¥ESP8266-WIFIæ¨¡å—ï¼ŒESP8266æ¨¡å—åˆ›å»ºTCPæœåŠ¡å™¨ï¼Œä¸Šä½æœºåº”ç”¨åˆ™ä½œä¸ºå®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¿›è¡Œå®æ—¶çš„æ•°æ®ä¼ è¾“ä¸æ§åˆ¶å‘½ä»¤çš„ä¸‹å‘ã€‚
ä¸ºäº†æ»¡è¶³ä¸åŒç”¨æˆ·çš„éœ€æ±‚ï¼Œæœ¬é¡¹ç›®éœ€è¦æ”¯æŒWindowså¹³å°çš„æ¡Œé¢åº”ç”¨å’ŒAndroidå¹³å°çš„ç§»åŠ¨APPã€‚Qtçš„è·¨å¹³å°ç‰¹æ€§ä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨ä¸€ä¸ªä»£ç åº“ä¸‹å®Œæˆå¤šå¹³å°åº”ç”¨çš„å¼€å‘å’Œç§»æ¤ã€‚å¼€å‘è€…ä»…éœ€è¦ç¼–å†™ä¸€æ¬¡åº”ç”¨é€»è¾‘å’Œç”¨æˆ·ç•Œé¢ï¼Œå°±å¯ä»¥é€šè¿‡Qtçš„è·¨å¹³å°æ„å»ºå·¥å…·ç”ŸæˆWindowså’ŒAndroidä¸¤ä¸ªå¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ­¤å¤–ï¼ŒQtæä¾›äº†ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒï¼Œå¸®åŠ©å¼€å‘è€…è§£å†³å¹³å°å·®å¼‚å’Œå…¼å®¹æ€§é—®é¢˜ï¼Œç¡®ä¿åº”ç”¨åœ¨ä¸åŒå¹³å°ä¸Šéƒ½èƒ½ç¨³å®šè¿è¡Œã€‚</p>
<p>æ€»ä½“è€Œè¨€ï¼Œä¸Šä½æœºå¼€å‘ç¯å¢ƒé‡‡ç”¨äº†Qt 5æ¡†æ¶å’ŒC++è¯­è¨€ï¼Œç»“åˆQt Creatoré›†æˆå¼€å‘ç¯å¢ƒï¼Œæä¾›äº†ä¸€ä¸ªé«˜æ•ˆã€ç¨³å®šã€è·¨å¹³å°çš„å¼€å‘å·¥å…·é“¾ã€‚é€šè¿‡Qtå¼ºå¤§çš„GUIè®¾è®¡ã€ç½‘ç»œé€šä¿¡ã€å¤šçº¿ç¨‹æ”¯æŒä»¥åŠæ•°æ®åº“ç®¡ç†åŠŸèƒ½ï¼Œå¼€å‘è€…èƒ½å¤Ÿè½»æ¾å®ç°ä¸ç¡¬ä»¶è®¾å¤‡çš„äº¤äº’ã€æ§åˆ¶è®¾å¤‡ã€å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›ç›´è§‚ã€æµç•…çš„æ“ä½œä½“éªŒã€‚</p>
<h3 data-id="heading-17">1.5 æ¨¡å—çš„æŠ€æœ¯è¯¦æƒ…ä»‹ç»</h3>
<p>(1) <strong>ä¸»æ§æ¨¡å—ï¼šSTM32F103C8T6 æ ¸å¿ƒæ¿</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šä½œä¸ºæ•´ä¸ªç³»ç»Ÿçš„â€œå¤§è„‘â€ï¼Œè´Ÿè´£åè°ƒå„ä¼ æ„Ÿå™¨çš„æ•°æ®é‡‡é›†ã€ä¿¡å·å¤„ç†ã€é€»è¾‘åˆ¤æ–­ä»¥åŠæ§åˆ¶é€šä¿¡æ¨¡å—ä¸äº‘ç«¯äº¤äº’ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåŸºäº ARM Cortex-M3 å†…æ ¸ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„å¤–è®¾èµ„æºï¼ˆå¦‚ ADCã€I2Cã€USART ç­‰ï¼‰ï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼ŒåŠŸè€—è¾ƒä½ï¼Œä¸”å¼€å‘ç”Ÿæ€æˆç†Ÿï¼Œæ€§ä»·æ¯”é«˜ï¼Œå®Œå…¨æ»¡è¶³å¤šä¼ æ„Ÿå™¨å¹¶è¡Œå·¥ä½œçš„éœ€æ±‚ã€‚</li>
</ul>
<p>(2) <strong>æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼šDHT11</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šåˆ†åˆ«ç”¨äºé‡‡é›†èœ‚ç®±å†…éƒ¨å’Œå¤–éƒ¨ç¯å¢ƒçš„æ¸©åº¦ä¸æ¹¿åº¦æ•°æ®ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé‡‡ç”¨å•æ€»çº¿æ•°å­—é€šä¿¡ï¼Œé›†æˆåº¦é«˜ï¼Œè‡ªå¸¦æ ¡å‡†åŠŸèƒ½ã€‚è™½ç„¶ç²¾åº¦ç›¸å¯¹ä¸­ç­‰ï¼Œä½†ç¨³å®šæ€§å¥½ã€å“åº”é€Ÿåº¦å¿«ä¸”æˆæœ¬ä½å»‰ï¼Œéå¸¸é€‚åˆä¸€èˆ¬çš„ç¯å¢ƒæ¸©æ¹¿åº¦ç›‘æµ‹åœºæ™¯ã€‚</li>
</ul>
<p>(3) <strong>é‡é‡æ£€æµ‹æ¨¡å—ï¼š10kg ç§°é‡ä¼ æ„Ÿå™¨ + HX711 æ”¾å¤§å™¨</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šå®æ—¶æµ‹é‡èœ‚ç®±çš„æ€»é‡é‡ï¼Œé€šè¿‡é‡é‡å˜åŒ–ç›‘æµ‹èœ‚èœœäº§é‡ã€èœ‚ç¾¤æ•°é‡å˜åŒ–åŠå¼‚å¸¸å¤±é‡æƒ…å†µã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šHX711 æ˜¯ä¸€æ¬¾ä¸“ä¸ºé«˜ç²¾åº¦ç”µå­ç§¤è®¾è®¡çš„ 24 ä½ A/D è½¬æ¢èŠ¯ç‰‡ï¼Œå…·æœ‰æé«˜çš„é›†æˆåº¦å’ŒæŠ—å¹²æ‰°èƒ½åŠ›ã€‚é…åˆå…¨æ¡¥å¼ç§°é‡ä¼ æ„Ÿå™¨ï¼Œèƒ½å®ç°å¾®å°é‡é‡å˜åŒ–çš„ç²¾å‡†æ•æ‰ã€‚</li>
</ul>
<p>(4) <strong>å£°éŸ³é‡‡é›†æ¨¡å—ï¼šMAX9814 è‡ªåŠ¨å¢ç›Šéº¦å…‹é£</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šé‡‡é›†èœ‚ç®±å†…éƒ¨çš„éŸ³é¢‘ä¿¡å·ï¼Œç”¨äºåç»­åˆ†æèœ‚ç¾¤çš„é¸£å«é¢‘ç‡å’Œå¼ºåº¦ï¼Œä»¥åˆ¤æ–­èœ‚ç¾¤æ˜¯å¦å¤„äºèºåŠ¨æˆ–åˆ†èœ‚çŠ¶æ€ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šå†…ç½®è‡ªåŠ¨å¢ç›Šæ§åˆ¶ï¼ˆAGCï¼‰åŠŸèƒ½ï¼Œèƒ½å¤Ÿåœ¨å‘¨å›´ç¯å¢ƒå£°éŸ³è¿‡å¤§æ—¶è‡ªåŠ¨é™ä½å¢ç›Šï¼Œå£°éŸ³è¿‡å°æ—¶è‡ªåŠ¨æé«˜å¢ç›Šï¼Œä»è€Œä¿è¯é‡‡é›†åˆ°çš„èœ‚ç¾¤å£°éŸ³ä¿¡å·å¹…åº¦ç¨³å®šï¼Œå™ªå£°æ›´ä½ã€‚</li>
</ul>
<p>(5) <strong>éœ‡åŠ¨ä¼ æ„Ÿå™¨ï¼šSW420 éœ‡åŠ¨æ£€æµ‹æ¨¡å—</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šç›‘æµ‹èœ‚ç®±å—åˆ°çš„ç‰©ç†éœ‡åŠ¨ï¼Œç”¨äºæ£€æµ‹æ˜¯å¦æœ‰å¤©æ•Œå…¥ä¾µï¼ˆå¦‚ç†Šã€ç¾ï¼‰æˆ–äººä¸ºç ´åç­‰å¤–éƒ¨æ”»å‡»è¡Œä¸ºã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåŸºäºå¸¸é—­å‹éœ‡åŠ¨ä¼ æ„Ÿå™¨è®¾è®¡ï¼Œçµæ•åº¦å¯é€šè¿‡ç”µä½å™¨è°ƒèŠ‚ã€‚è¾“å‡ºä¸ºæ•°å­—å¼€å…³é‡ï¼ˆ0æˆ–1ï¼‰ï¼Œèƒ½å¤Ÿç›´æ¥è§¦å‘å•ç‰‡æœºä¸­æ–­ï¼Œå“åº”è¿…é€Ÿï¼Œè¯¯æŠ¥ç‡é€šè¿‡è°ƒèŠ‚å¯æ§ã€‚</li>
</ul>
<p>(6) <strong>å…‰ç…§é‡‡é›†æ¨¡å—ï¼šBH1750</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šæµ‹é‡å¤–ç•Œç¯å¢ƒçš„å…‰ç…§å¼ºåº¦ï¼ˆLuxï¼‰ï¼Œè¾…åŠ©ç³»ç»Ÿåˆ¤æ–­å½“å‰çš„æ˜¼å¤œçŠ¶æ€åŠå¤©æ°”æƒ…å†µï¼Œåˆ†æèœ‚ç¾¤å‡ºå‹¤ä¸å…‰ç…§çš„å…³ç³»ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé‡‡ç”¨ I2C æ€»çº¿æ¥å£ï¼Œèƒ½å¤Ÿç›´æ¥è¾“å‡ºæ•°å­—å…‰ç…§å€¼ï¼Œæ— éœ€å¤æ‚çš„è®¡ç®—å’Œæ ¡å‡†ã€‚å…¶å…‰è°±å“åº”ç‰¹æ€§æ¥è¿‘äººçœ¼è§†è§‰ï¼Œæµ‹é‡èŒƒå›´å®½ï¼Œå—çº¢å¤–çº¿å½±å“å°ã€‚</li>
</ul>
<p>(7) <strong>é€šä¿¡æ¨¡å—ï¼šAir780E (4G) æˆ– ESP8266 (Wi-Fi)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šè´Ÿè´£å°†å•ç‰‡æœºå¤„ç†åçš„æ•°æ®æ‰“åŒ…ï¼Œé€šè¿‡ MQTT åè®®å‘é€è‡³åä¸ºäº‘ IoTDA å¹³å°ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li><strong>Air780E</strong>ï¼šæ”¯æŒ LTE Cat.1 ç½‘ç»œï¼Œå¹¿åŸŸç½‘è¦†ç›–ï¼Œä¼ è¾“é€Ÿç‡é€‚ä¸­ï¼Œé€‚åˆæ²¡æœ‰ Wi-Fi çš„é‡å¤–åè¿œèœ‚åœºéƒ¨ç½²ã€‚</li>
<li><strong>ESP8266</strong>ï¼šé›†æˆåº¦é«˜çš„ Wi-Fi æ¨¡å—ï¼Œæˆæœ¬æä½ï¼Œé€‚åˆå®¶åº­å†œåœºæˆ–æœ‰æ— çº¿ç½‘ç»œè¦†ç›–çš„åŒºåŸŸï¼Œå¼€å‘ä¾¿æ·ã€‚</li>
</ul>
</li>
</ul>
<p>(8) <strong>æ˜¾ç¤ºæ¨¡å—ï¼šOLED 0.96 I2C æ˜¾ç¤ºå±</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šä½œä¸ºæœ¬åœ°äººæœºäº¤äº’ç•Œé¢ï¼Œå®æ—¶è½®æ’­æ˜¾ç¤ºæ¸©æ¹¿åº¦ã€é‡é‡ã€ç³»ç»ŸçŠ¶æ€ç­‰å…³é”®ä¿¡æ¯ï¼Œæ–¹ä¾¿ç°åœºå·¡æŸ¥ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šè‡ªå‘å…‰æŠ€æœ¯ï¼ˆæ— éœ€èƒŒå…‰ï¼‰ï¼Œå¯¹æ¯”åº¦é«˜ï¼Œå¯è§†è§’å¹¿ï¼ŒåŠŸè€—æä½ã€‚ä½¿ç”¨ I2C æ¥å£ï¼Œä»…éœ€å ç”¨å•ç‰‡æœºä¸¤ä¸ª I/O å£ï¼ŒèŠ‚çœèµ„æºã€‚</li>
</ul>
<p>(9) <strong>ç”µæºç³»ç»Ÿï¼šAMS1117 ç¨³å‹ä¸é”‚ç”µæ± ä¾›ç”µ</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šä¸ºç³»ç»Ÿå„æ¨¡å—æä¾›ç¨³å®šã€çº¯å‡€çš„ç”µå‹ï¼ˆ3.3V å’Œ 5Vï¼‰ï¼Œå¹¶ä¿éšœæˆ·å¤–æŒç»­è¿è¡Œã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šAMS1117 ç³»åˆ—å…·æœ‰ä½å‹å·®ç‰¹æ€§ï¼Œè¾“å‡ºç”µå‹ç¨³å®šã€‚é…åˆ 18650 é”‚ç”µæ± å’Œå¤ªé˜³èƒ½å……ç”µæ¿ï¼Œæ„æˆäº†å¯å¾ªç¯çš„ç»¿è‰²ä¾›ç”µç³»ç»Ÿï¼Œè§£å†³äº†æˆ·å¤–è®¾å¤‡å–ç”µéš¾çš„é—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-18">äºŒã€éƒ¨ç½²åä¸ºäº‘ç‰©è”ç½‘å¹³å°</h2>
<p>åä¸ºäº‘å®˜ç½‘: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.huaweicloud.com%2F" target="_blank" title="https://www.huaweicloud.com/" ref="nofollow noopener noreferrer">www.huaweicloud.com/</a></p>
<p>æ‰“å¼€å®˜ç½‘ï¼Œæœç´¢ç‰©è”ç½‘ï¼Œå°±èƒ½å¿«é€Ÿæ‰¾åˆ° <code>è®¾å¤‡æ¥å…¥IoTDA</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1382e8b60ae44a93b28a934e32066648~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=0JNKEhw%2FWioH%2FNGz5sCtbosLkj4%3D" alt="image-20221204193824815" loading="lazy"/></p>
<h3 data-id="heading-19">2.1 ç‰©è”ç½‘å¹³å°ä»‹ç»</h3>
<p>åä¸ºäº‘ç‰©è”ç½‘å¹³å°ï¼ˆIoT è®¾å¤‡æ¥å…¥äº‘æœåŠ¡ï¼‰æä¾›æµ·é‡è®¾å¤‡çš„æ¥å…¥å’Œç®¡ç†èƒ½åŠ›ï¼Œå°†ç‰©ç†è®¾å¤‡è”æ¥åˆ°äº‘ï¼Œæ”¯æ’‘è®¾å¤‡æ•°æ®é‡‡é›†ä¸Šäº‘å’Œäº‘ç«¯ä¸‹å‘å‘½ä»¤ç»™è®¾å¤‡è¿›è¡Œè¿œç¨‹æ§åˆ¶ï¼Œé…åˆåä¸ºäº‘å…¶ä»–äº§å“ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ„ç­‘ç‰©è”ç½‘è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä½¿ç”¨ç‰©è”ç½‘å¹³å°æ„å»ºä¸€ä¸ªå®Œæ•´çš„ç‰©è”ç½‘è§£å†³æ–¹æ¡ˆä¸»è¦åŒ…æ‹¬3éƒ¨åˆ†ï¼šç‰©è”ç½‘å¹³å°ã€ä¸šåŠ¡åº”ç”¨å’Œè®¾å¤‡ã€‚</p>
<p>ç‰©è”ç½‘å¹³å°ä½œä¸ºè¿æ¥ä¸šåŠ¡åº”ç”¨å’Œè®¾å¤‡çš„ä¸­é—´å±‚ï¼Œå±è”½äº†å„ç§å¤æ‚çš„è®¾å¤‡æ¥å£ï¼Œå®ç°è®¾å¤‡çš„å¿«é€Ÿæ¥å…¥ï¼›åŒæ—¶æä¾›å¼ºå¤§çš„å¼€æ”¾èƒ½åŠ›ï¼Œæ”¯æ’‘è¡Œä¸šç”¨æˆ·æ„å»ºå„ç§ç‰©è”ç½‘è§£å†³æ–¹æ¡ˆã€‚</p>
<p>è®¾å¤‡å¯ä»¥é€šè¿‡å›ºç½‘ã€2G/3G/4G/5Gã€NB-IoTã€Wifiç­‰å¤šç§ç½‘ç»œæ¥å…¥ç‰©è”ç½‘å¹³å°ï¼Œå¹¶ä½¿ç”¨LWM2M/CoAPã€MQTTã€HTTPSåè®®å°†ä¸šåŠ¡æ•°æ®ä¸ŠæŠ¥åˆ°å¹³å°ï¼Œå¹³å°ä¹Ÿå¯ä»¥å°†æ§åˆ¶å‘½ä»¤ä¸‹å‘ç»™è®¾å¤‡ã€‚</p>
<p>ä¸šåŠ¡åº”ç”¨é€šè¿‡è°ƒç”¨ç‰©è”ç½‘å¹³å°æä¾›çš„APIï¼Œå®ç°è®¾å¤‡æ•°æ®é‡‡é›†ã€å‘½ä»¤ä¸‹å‘ã€è®¾å¤‡ç®¡ç†ç­‰ä¸šåŠ¡åœºæ™¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9b29ee3c1aa4f389bda6f0d5e11eee7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=HN%2FGYH3MukYbuBMwGQ30b631QGg%3D" alt="img" loading="lazy"/></p>
<h3 data-id="heading-20">2.2 å¼€é€šç‰©è”ç½‘æœåŠ¡</h3>
<p>åœ°å€ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.huaweicloud.com%2Fproduct%2Fiothub.html" target="_blank" title="https://www.huaweicloud.com/product/iothub.html" ref="nofollow noopener noreferrer">www.huaweicloud.com/product/iotâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a0353113269441c8a9eac4f1c881cfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=1PWC%2BskCqXtD8PE85mzqiVDttuw%3D" alt="image-20241028135834377" loading="lazy"/></p>
<p><strong>å¼€é€šå…è´¹å•å…ƒã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d9940ca991e4fc7b3f7066b8075e033~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=6Fg06SAnz5RGMgy63reXkfl5v0M%3D" alt="image-20241028135935457" loading="lazy"/></p>
<p>ç‚¹å‡»<code>ç«‹å³åˆ›å»º</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da9652c3bd454462ba9cd2d62c09e970~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=JGOEnx%2FTfFHm8q5fKBHbLJ9%2By4k%3D" alt="image-20240117134653452" loading="lazy"/></p>
<p>æ­£åœ¨åˆ›å»ºæ ‡å‡†ç‰ˆå®ä¾‹ï¼Œéœ€è¦ç­‰å¾…ç‰‡åˆ»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8de114dfd8242d4a17631097388e3db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=sJ0ihw24c%2FttOPqYhxu08upqqCk%3D" alt="image-20241028140048811" loading="lazy"/></p>
<p><strong>åˆ›å»ºå®Œæˆä¹‹åï¼Œç‚¹å‡»è¯¦æƒ…ã€‚ å¯ä»¥çœ‹åˆ°æ ‡å‡†ç‰ˆå®ä¾‹çš„è®¾å¤‡æ¥å…¥ç«¯å£å’Œåœ°å€ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fea83cd4cb0c412f905c6929c759a091~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=04jDLdQNeXWAyJlVB1oVfWyqa7g%3D" alt="image-20241028140129102" loading="lazy"/></p>
<p>ä¸‹é¢æ¡†èµ·æ¥çš„å°±æ˜¯<code>ç«¯å£å·</code>å’Œ<code>åŸŸå</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a06706afa0b34adbbcf6a28fbbf053cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=j1n4iV1o3POrbKKtKaPq0kFTGcw%3D" alt="image-20241028140229696" loading="lazy"/></p>
<p>ç‚¹å‡»å®ä¾‹åç§°ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰<code>å…è´¹å•å…ƒ</code>çš„é…ç½®æƒ…å†µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02a4e1631cee476fa971b280a5f8b279~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=%2BDD5ugKJ26JBpH1HjUD1V%2FMHqX4%3D" alt="image-20241028140331523" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f0d332c26b34e2cbc865896709b6a89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=0pfNg6VzQbmd4zIKYZJIjegjQMw%3D" alt="image-20241028140428663" loading="lazy"/></p>
<p>å¼€é€šä¹‹åï¼Œç‚¹å‡»<code>æ¥å…¥ä¿¡æ¯</code>ï¼Œä¹Ÿèƒ½æŸ¥çœ‹æ¥å…¥ä¿¡æ¯ã€‚ æˆ‘ä»¬å½“å‰è®¾å¤‡å‡†å¤‡é‡‡ç”¨MQTTåè®®æ¥å…¥åä¸ºäº‘å¹³å°ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°MQTTåè®®çš„åœ°å€å’Œç«¯å£å·ç­‰ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bb6d845ddba44b39a6c23b03447be37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=P4mIhdjF6ikr4OEDhbT%2F8RhlX4U%3D" alt="image-20241028140511105" loading="lazy"/></p>
<p><strong>æ€»ç»“:</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç«¯å£å·ï¼š   MQTT (<span class="hljs-number">1883</span>)| MQTTS (<span class="hljs-number">8883</span>)    
æ¥å…¥åœ°å€ï¼š dab1a1f2c6<span class="hljs-selector-class">.st1</span><span class="hljs-selector-class">.iotda-device</span><span class="hljs-selector-class">.cn-north-4</span><span class="hljs-selector-class">.myhuaweicloud</span><span class="hljs-selector-class">.com</span>
</code></pre>
<p><strong>æ ¹æ®åŸŸååœ°å€å¾—åˆ°IPåœ°å€ä¿¡æ¯:</strong></p>
<p>æ‰“å¼€Windowsç”µè„‘çš„å‘½ä»¤è¡Œæ§åˆ¶å°ç»ˆç«¯ï¼Œä½¿ç”¨<code>ping</code> å‘½ä»¤ã€‚<code>ping</code>ä¸€ä¸‹å³å¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">Microsoft Windows <span class="hljs-section">[ç‰ˆæœ¬ 10.0.19045.5011]</span>
(c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚

C:\Users\Lenovo&gt;ping dab1a1f2c6.st1.iotda-device.cn-north-4.myhuaweicloud.com

æ­£åœ¨ Ping dab1a1f2c6.st1.iotda-device.cn-north-4.myhuaweicloud.com <span class="hljs-section">[117.78.5.125]</span> å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 117.78.5.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=37ms <span class="hljs-attr">TTL</span>=<span class="hljs-number">44</span>
æ¥è‡ª 117.78.5.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=37ms <span class="hljs-attr">TTL</span>=<span class="hljs-number">44</span>
æ¥è‡ª 117.78.5.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=37ms <span class="hljs-attr">TTL</span>=<span class="hljs-number">44</span>
æ¥è‡ª 117.78.5.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=37ms <span class="hljs-attr">TTL</span>=<span class="hljs-number">44</span>

117.78.5.125 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 4ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 37msï¼Œæœ€é•¿ = 37msï¼Œå¹³å‡ = 37ms

C:\Users\Lenovo&gt;

</code></pre>
<p>MQTTåè®®æ¥å…¥ç«¯å£å·æœ‰ä¸¤ä¸ªï¼Œ1883æ˜¯éåŠ å¯†ç«¯å£ï¼Œ8883æ˜¯è¯ä¹¦åŠ å¯†ç«¯å£ï¼Œ<code>å•ç‰‡æœºæ— æ³•åŠ è½½è¯ä¹¦ï¼Œæ‰€ä»¥ä½¿ç”¨1883ç«¯å£åˆé€‚</code>ã€‚</p>
<h3 data-id="heading-21">2.3 åˆ›å»ºäº§å“</h3>
<p>é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.huaweicloud.com%2Fiotdm%2F%3Fregion%3Dcn-north-4%23%2Fdm-dev%2Fall-product%3FinstanceId%3D03c5c68c-e588-458c-90c3-9e4c640be7af" target="_blank" title="https://console.huaweicloud.com/iotdm/?region=cn-north-4#/dm-dev/all-product?instanceId=03c5c68c-e588-458c-90c3-9e4c640be7af" ref="nofollow noopener noreferrer">console.huaweicloud.com/iotdm/?regiâ€¦</a></p>
<h4 data-id="heading-22">ï¼ˆ1ï¼‰åˆ›å»ºäº§å“</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25822cf39c7e45f7a9038655e7263750~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=S3olirMz%2BV5LlczhUIVoyhd2swg%3D" alt="image-20241028141601305" loading="lazy"/></p>
<h4 data-id="heading-23">ï¼ˆ2ï¼‰å¡«å†™äº§å“ä¿¡æ¯</h4>
<p>æ ¹æ®è‡ªå·±äº§å“åå­—å¡«å†™ï¼Œä¸‹é¢çš„è®¾å¤‡ç±»å‹é€‰æ‹©è‡ªå®šä¹‰ç±»å‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c04ebb116d34d7493adae7081c8090b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=hGn0Ueg9KjoSW3pIVc%2Ffu9Z3zzw%3D" alt="image-20240612094809689" loading="lazy"/></p>
<h4 data-id="heading-24">ï¼ˆ3ï¼‰äº§å“åˆ›å»ºæˆåŠŸ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4681fd1b277748e186625711ee370f50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=eiY7ccPALAsBz3GxhQsRDTyUoPA%3D" alt="image-20240612095148945" loading="lazy"/></p>
<p>åˆ›å»ºå®Œæˆä¹‹åç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/191b19e4acfa4a5e8d67ada4995227ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Yd5UiknaHE6KLvzhTQ4cx%2BJpOkA%3D" alt="image-20240612095134263" loading="lazy"/></p>
<h4 data-id="heading-25">ï¼ˆ4ï¼‰æ·»åŠ è‡ªå®šä¹‰æ¨¡å‹</h4>
<p>äº§å“åˆ›å»ºå®Œæˆä¹‹åï¼Œç‚¹å‡»è¿›å…¥äº§å“è¯¦æƒ…é¡µé¢ï¼Œç¿»åˆ°æœ€ä¸‹é¢å¯ä»¥çœ‹åˆ°æ¨¡å‹å®šä¹‰ã€‚</p>
<p>æ¨¡å‹ç®€å•æ¥è¯´ï¼š å°±æ˜¯å­˜æ”¾è®¾å¤‡ä¸Šä¼ åˆ°äº‘å¹³å°çš„æ•°æ®ã€‚</p>
<p>å¯ä»¥æ ¹æ®è‡ªå·±çš„äº§å“è¿›è¡Œåˆ›å»ºã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">çƒŸé›¾å¯ä»¥å«  MQ2
æ¸©åº¦å¯ä»¥å«  Temperature
æ¹¿åº¦å¯ä»¥å«  humidity
ç«ç„°å¯ä»¥å«  flame
å…¶ä»–çš„ä¼ æ„Ÿå™¨è‡ªå·±ç”¨å•è¯ç®€å†™å‘½åå³å¯ã€‚ è¿™å°±æ˜¯çš„å•ç‰‡æœºè®¾å¤‡ç«¯ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ•°æ®åå­—ã€‚
</code></pre>
<p>å…ˆç‚¹å‡»è‡ªå®šä¹‰æ¨¡å‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8c87b5aac21489c9b0712207666970c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=2lfL%2BTfcWfSP7p4YLHClbJTemvo%3D" alt="image-20240612095517900" loading="lazy"/></p>
<p>å†åˆ›å»ºä¸€ä¸ªæœåŠ¡IDã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aba2193baa014a0a8d93198b1281cc20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=nk4yBMqw189jjB5FToLl27ZkEJI%3D" alt="image-20240612095542749" loading="lazy"/></p>
<p>æ¥ç€ç‚¹å‡»æ–°å¢å±æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42fa34b0a9684339967607d4247c7f11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=muAaL12FeRBEdzVqEiDCou7zfDA%3D" alt="image-20240612095648815" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/367e042ab370453d9c6b1d6eca71a531~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=CmWaxXKtUjgoIkgOHb082O5Ut%2Bg%3D" alt="image-20240612095711898" loading="lazy"/></p>
<h3 data-id="heading-26">2.4 æ·»åŠ è®¾å¤‡</h3>
<p>äº§å“æ˜¯å±äºä¸Šå±‚çš„æŠ½è±¡æ¨¡å‹ï¼Œæ¥ä¸‹æ¥åœ¨äº§å“æ¨¡å‹ä¸‹æ·»åŠ å®é™…çš„è®¾å¤‡ã€‚æ·»åŠ çš„è®¾å¤‡æœ€ç»ˆéœ€è¦ä¸çœŸå®çš„è®¾å¤‡å…³è”åœ¨ä¸€èµ·ï¼Œå®Œæˆæ•°æ®äº¤äº’ã€‚</p>
<h4 data-id="heading-27">ï¼ˆ1ï¼‰æ³¨å†Œè®¾å¤‡</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71940c7ea72c422aad6cc9575f4260f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=lLRJdlXS3EOA7wJ%2FI2RbVC5Lg%2B4%3D" alt="image-20240425181935561" loading="lazy"/></p>
<h4 data-id="heading-28">ï¼ˆ2ï¼‰æ ¹æ®è‡ªå·±çš„è®¾å¤‡å¡«å†™</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcef1477597e4e13bcef776b7a69142e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=W5OW6C4cLypoNpsIV34r1mITCoI%3D" alt="image-20240612100115167" loading="lazy"/></p>
<h4 data-id="heading-29">ï¼ˆ3ï¼‰ä¿å­˜è®¾å¤‡ä¿¡æ¯</h4>
<p>åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œç‚¹å‡»ä¿å­˜å¹¶å…³é—­ï¼Œå¾—åˆ°åˆ›å»ºçš„è®¾å¤‡å¯†åŒ™ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯åœ¨åç»­ç”ŸæˆMQTTä¸‰å…ƒç»„çš„æ—¶å€™éœ€è¦ä½¿ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae5e71606a1f412eb68eedb3d3ad28dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=GKp%2BoE8O5r5IOwV%2FwTfPBcghDao%3D" alt="image-20240612100128061" loading="lazy"/></p>
<h4 data-id="heading-30">ï¼ˆ4ï¼‰è®¾å¤‡åˆ›å»ºå®Œæˆ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48cea29e8169435f966e8717ae886980~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=dsaSOyqDPndQZHUydsDioK5KQTc%3D" alt="image-20240612100147232" loading="lazy"/></p>
<h4 data-id="heading-31">ï¼ˆ5ï¼‰è®¾å¤‡è¯¦æƒ…</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a5a24fd3d7d4199b0a835aad4016f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=c2WLvbkJ7wySRz64mQcj13tlVu4%3D" alt="image-20240612100202960" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e61b358a66b54253bb2dc8844c8a9e25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=f9QfzY7jYbArtM8GqJGoiaLBOHE%3D" alt="image-20240612100217236" loading="lazy"/></p>
<h3 data-id="heading-32">2.5 MQTTåè®®ä¸»é¢˜è®¢é˜…ä¸å‘å¸ƒ</h3>
<h4 data-id="heading-33">ï¼ˆ1ï¼‰MQTTåè®®ä»‹ç»</h4>
<p>å½“å‰çš„è®¾å¤‡æ˜¯é‡‡ç”¨MQTTåè®®ä¸åä¸ºäº‘å¹³å°è¿›è¡Œé€šä¿¡ã€‚</p>
<p>MQTTæ˜¯ä¸€ä¸ªç‰©è”ç½‘ä¼ è¾“åè®®ï¼Œå®ƒè¢«è®¾è®¡ç”¨äºè½»é‡çº§çš„å‘å¸ƒ/è®¢é˜…å¼æ¶ˆæ¯ä¼ è¾“ï¼Œæ—¨åœ¨ä¸ºä½å¸¦å®½å’Œä¸ç¨³å®šçš„ç½‘ç»œç¯å¢ƒä¸­çš„ç‰©è”ç½‘è®¾å¤‡æä¾›å¯é çš„ç½‘ç»œæœåŠ¡ã€‚MQTTæ˜¯ä¸“é—¨é’ˆå¯¹ç‰©è”ç½‘å¼€å‘çš„è½»é‡çº§ä¼ è¾“åè®®ã€‚MQTTåè®®é’ˆå¯¹ä½å¸¦å®½ç½‘ç»œï¼Œä½è®¡ç®—èƒ½åŠ›çš„è®¾å¤‡ï¼Œåšäº†ç‰¹æ®Šçš„ä¼˜åŒ–ï¼Œä½¿å¾—å…¶èƒ½é€‚åº”å„ç§ç‰©è”ç½‘åº”ç”¨åœºæ™¯ã€‚ç›®å‰MQTTæ‹¥æœ‰å„ç§å¹³å°å’Œè®¾å¤‡ä¸Šçš„å®¢æˆ·ç«¯ï¼Œå·²ç»å½¢æˆäº†åˆæ­¥çš„ç”Ÿæ€ç³»ç»Ÿã€‚</p>
<p>MQTTæ˜¯ä¸€ç§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œä½¿ç”¨å‘å¸ƒ/è®¢é˜…æ¶ˆæ¯æ¨¡å¼ï¼Œæä¾›ä¸€å¯¹å¤šçš„æ¶ˆæ¯å‘å¸ƒï¼Œè§£é™¤åº”ç”¨ç¨‹åºè€¦åˆï¼Œç›¸å¯¹äºå…¶ä»–åè®®ï¼Œå¼€å‘æ›´ç®€å•ï¼›MQTTåè®®æ˜¯å·¥ä½œåœ¨TCP/IPåè®®ä¸Šï¼›ç”±TCP/IPåè®®æä¾›ç¨³å®šçš„ç½‘ç»œè¿æ¥ï¼›æ‰€ä»¥ï¼Œåªè¦å…·å¤‡TCPåè®®æ ˆçš„ç½‘ç»œè®¾å¤‡éƒ½å¯ä»¥ä½¿ç”¨MQTTåè®®ã€‚  æœ¬æ¬¡è®¾å¤‡é‡‡ç”¨çš„ESP8266å°±å…·å¤‡TCPåè®®æ ˆï¼Œèƒ½å¤Ÿå»ºç«‹TCPè¿æ¥ï¼Œæ‰€ä»¥ï¼Œé…åˆSTM32ä»£ç é‡Œå°è£…çš„MQTTåè®®ï¼Œå°±å¯ä»¥ä¸åä¸ºäº‘å¹³å°å®Œæˆé€šä¿¡ã€‚</p>
<p>åä¸ºäº‘çš„MQTTåè®®æ¥å…¥å¸®åŠ©æ–‡æ¡£åœ¨è¿™é‡Œ:  <a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.huaweicloud.com%2Fdevg-iothub%2Fiot_02_2200.html" target="_blank" title="https://support.huaweicloud.com/devg-iothub/iot_02_2200.html" ref="nofollow noopener noreferrer">support.huaweicloud.com/devg-iothubâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85420a00ae274df98e59953f6c36f34e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=ah7KfQUU3wUflKWc6sSsPe89RkI%3D" alt="img" loading="lazy"/></p>
<p><strong>ä¸šåŠ¡æµç¨‹ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85560f1e730040f98559d94e814fc472~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=WOllCxdpsRWnvPsFEjdAlqHLUUU%3D" alt="img" loading="lazy"/></p>
<h4 data-id="heading-34">ï¼ˆ2ï¼‰åä¸ºäº‘å¹³å°MQTTåè®®ä½¿ç”¨é™åˆ¶</h4>





















































<table><thead><tr><th>æè¿°</th><th>é™åˆ¶</th></tr></thead><tbody><tr><td>æ”¯æŒçš„MQTTåè®®ç‰ˆæœ¬</td><td>3.1.1</td></tr><tr><td>ä¸æ ‡å‡†MQTTåè®®çš„åŒºåˆ«</td><td>æ”¯æŒQos 0å’ŒQos 1æ”¯æŒTopicè‡ªå®šä¹‰ä¸æ”¯æŒQoS2ä¸æ”¯æŒwillã€retain msg</td></tr><tr><td>MQTTSæ”¯æŒçš„å®‰å…¨ç­‰çº§</td><td>é‡‡ç”¨TCPé€šé“åŸºç¡€ + TLSåè®®ï¼ˆæœ€é«˜TLSv1.3ç‰ˆæœ¬ï¼‰</td></tr><tr><td>å•å¸å·æ¯ç§’æœ€å¤§MQTTè¿æ¥è¯·æ±‚æ•°</td><td>æ— é™åˆ¶</td></tr><tr><td>å•ä¸ªè®¾å¤‡æ¯åˆ†é’Ÿæ”¯æŒçš„æœ€å¤§MQTTè¿æ¥æ•°</td><td>1</td></tr><tr><td>å•ä¸ªMQTTè¿æ¥æ¯ç§’çš„ååé‡ï¼Œå³å¸¦å®½ï¼ŒåŒ…å«ç›´è¿è®¾å¤‡å’Œç½‘å…³</td><td>3KB/s</td></tr><tr><td>MQTTå•ä¸ªå‘å¸ƒæ¶ˆæ¯æœ€å¤§é•¿åº¦ï¼Œè¶…è¿‡æ­¤å¤§å°çš„å‘å¸ƒè¯·æ±‚å°†è¢«ç›´æ¥æ‹’ç»</td><td>1MB</td></tr><tr><td>MQTTè¿æ¥å¿ƒè·³æ—¶é—´å»ºè®®å€¼</td><td>å¿ƒè·³æ—¶é—´é™å®šä¸º30è‡³1200ç§’ï¼Œæ¨èè®¾ç½®ä¸º120ç§’</td></tr><tr><td>äº§å“æ˜¯å¦æ”¯æŒè‡ªå®šä¹‰Topic</td><td>æ”¯æŒ</td></tr><tr><td>æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…</td><td>è®¾å¤‡åªèƒ½å¯¹è‡ªå·±çš„Topicè¿›è¡Œæ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…</td></tr><tr><td>æ¯ä¸ªè®¢é˜…è¯·æ±‚çš„æœ€å¤§è®¢é˜…æ•°</td><td>æ— é™åˆ¶</td></tr></tbody></table>
<h4 data-id="heading-35">ï¼ˆ3ï¼‰ä¸»é¢˜è®¢é˜…æ ¼å¼</h4>
<p>å¸®åŠ©æ–‡æ¡£åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.huaweicloud.com%2Fdevg-iothub%2Fiot_02_2200.html" target="_blank" title="https://support.huaweicloud.com/devg-iothub/iot_02_2200.html" ref="nofollow noopener noreferrer">support.huaweicloud.com/devg-iothubâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c122c8357f540d3b72888d825e2c51e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=8r8HSLz6dHB9r2SjPr8Cs8jTDaY%3D" alt="image-20221207153310037" loading="lazy"/></p>
<p>å¯¹äºè®¾å¤‡è€Œè¨€ï¼Œä¸€èˆ¬ä¼šè®¢é˜…å¹³å°ä¸‹å‘æ¶ˆæ¯ç»™è®¾å¤‡ è¿™ä¸ªä¸»é¢˜ã€‚</p>
<p>è®¾å¤‡æƒ³æ¥æ”¶å¹³å°ä¸‹å‘çš„æ¶ˆæ¯ï¼Œå°±éœ€è¦è®¢é˜…å¹³å°ä¸‹å‘æ¶ˆæ¯ç»™è®¾å¤‡ çš„ä¸»é¢˜ï¼Œè®¢é˜…åï¼Œå¹³å°ä¸‹å‘æ¶ˆæ¯ç»™è®¾å¤‡ï¼Œè®¾å¤‡å°±ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚</p>
<p>å¦‚æœè®¾å¤‡æƒ³è¦çŸ¥é“å¹³å°ä¸‹å‘çš„æ¶ˆæ¯ï¼Œéœ€è¦è®¢é˜…ä¸Šé¢å›¾ç‰‡é‡Œæ ‡æ³¨çš„ä¸»é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp">ä»¥å½“å‰è®¾å¤‡ä¸ºä¾‹ï¼Œæœ€ç»ˆè®¢é˜…ä¸»é¢˜çš„æ ¼å¼å¦‚ä¸‹:
$oc/devices/{device_id}/sys/messages/down
    
æœ€ç»ˆçš„æ ¼å¼:
$oc/devices/<span class="hljs-number">663</span>cb18871d845632a0912e7_dev1/sys/messages/down
</code></pre>
<h4 data-id="heading-36">ï¼ˆ4ï¼‰ä¸»é¢˜å‘å¸ƒæ ¼å¼</h4>
<p>å¯¹äºè®¾å¤‡æ¥è¯´ï¼Œä¸»é¢˜å‘å¸ƒè¡¨ç¤ºå‘äº‘å¹³å°ä¸Šä¼ æ•°æ®ï¼Œå°†æœ€æ–°çš„ä¼ æ„Ÿå™¨æ•°æ®ï¼Œè®¾å¤‡çŠ¶æ€ä¸Šä¼ åˆ°äº‘å¹³å°ã€‚</p>
<p>è¿™ä¸ªæ“ä½œç§°ä¸ºï¼šå±æ€§ä¸ŠæŠ¥ã€‚</p>
<p>å¸®åŠ©æ–‡æ¡£åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.huaweicloud.com%2Fusermanual-iothub%2Fiot_06_v5_3010.html" target="_blank" title="https://support.huaweicloud.com/usermanual-iothub/iot_06_v5_3010.html" ref="nofollow noopener noreferrer">support.huaweicloud.com/usermanual-â€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88790ea5762c46139b43c08bc5337acd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=wHcf%2F9%2FInrC8OchyHo4vx0uoOZo%3D" alt="image-20221207153637391" loading="lazy"/></p>
<p><strong>æ ¹æ®å¸®åŠ©æ–‡æ¡£çš„ä»‹ç»ï¼Œ å½“å‰è®¾å¤‡å‘å¸ƒä¸»é¢˜ï¼Œä¸ŠæŠ¥å±æ€§çš„æ ¼å¼æ€»ç»“å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp">å‘å¸ƒçš„ä¸»é¢˜æ ¼å¼:
$oc/devices/{device_id}/sys/properties/report
 
æœ€ç»ˆçš„æ ¼å¼:
$oc/devices/<span class="hljs-number">663</span>cb18871d845632a0912e7_dev1/sys/properties/report
å‘å¸ƒä¸»é¢˜æ—¶ï¼Œéœ€è¦ä¸Šä¼ æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®æ ¼å¼æ˜¯JSONæ ¼å¼ã€‚

ä¸Šä¼ çš„JSONæ•°æ®æ ¼å¼å¦‚ä¸‹:

{
  <span class="hljs-string">"services"</span>: [
    {
      <span class="hljs-string">"service_id"</span>: &lt;å¡«æœåŠ¡ID&gt;,
      <span class="hljs-string">"properties"</span>: {
        <span class="hljs-string">"&lt;å¡«å±æ€§åç§°1&gt;"</span>: &lt;å¡«å±æ€§å€¼&gt;,
        <span class="hljs-string">"&lt;å¡«å±æ€§åç§°2&gt;"</span>: &lt;å¡«å±æ€§å€¼&gt;,
        ..........
      }
    }
  ]
}
æ ¹æ®JSONæ ¼å¼ï¼Œä¸€æ¬¡å¯ä»¥ä¸Šä¼ å¤šä¸ªå±æ€§å­—æ®µã€‚ è¿™ä¸ªJSONæ ¼å¼é‡Œçš„ï¼ŒæœåŠ¡IDï¼Œå±æ€§å­—æ®µåç§°ï¼Œå±æ€§å€¼ç±»å‹ï¼Œåœ¨å‰é¢åˆ›å»ºäº§å“çš„æ—¶å€™å°±å·²ç»ä»‹ç»äº†ï¼Œä¸è®°å¾—å¯ä»¥ç¿»åˆ°å‰é¢å»æŸ¥çœ‹ã€‚

æ ¹æ®è¿™ä¸ªæ ¼å¼ï¼Œç»„åˆä¸€æ¬¡ä¸Šä¼ çš„å±æ€§æ•°æ®:
{<span class="hljs-string">"services"</span>: [{<span class="hljs-string">"service_id"</span>: <span class="hljs-string">"stm32"</span>,<span class="hljs-string">"properties"</span>:{<span class="hljs-string">"çš„å­—æ®µåå­—1"</span>:<span class="hljs-number">30</span>,<span class="hljs-string">"çš„å­—æ®µåå­—2"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"çš„å­—æ®µåå­—3"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"çš„å­—æ®µåå­—4"</span>:<span class="hljs-number">0</span>}}]}
</code></pre>
<h3 data-id="heading-37">2.6 MQTTä¸‰å…ƒç»„</h3>
<p>MQTTåè®®ç™»å½•éœ€è¦å¡«ç”¨æˆ·IDï¼Œè®¾å¤‡IDï¼Œè®¾å¤‡å¯†ç ç­‰ä¿¡æ¯ï¼Œå°±åƒæˆ‘ä»¬å¹³æ—¶ç™»å½•QQï¼Œå¾®ä¿¡ä¸€æ ·è¦è¾“å…¥è´¦å·å¯†ç æ‰èƒ½ç™»å½•ã€‚MQTTåè®®ç™»å½•çš„è¿™3ä¸ªå‚æ•°ï¼Œä¸€èˆ¬ç§°ä¸ºMQTTä¸‰å…ƒç»„ã€‚</p>
<p>æ¥ä¸‹æ¥ä»‹ç»ï¼Œåä¸ºäº‘å¹³å°çš„MQTTä¸‰å…ƒç»„å‚æ•°å¦‚ä½•å¾—åˆ°ã€‚</p>
<h4 data-id="heading-38">ï¼ˆ1ï¼‰MQTTæœåŠ¡å™¨åœ°å€</h4>
<p>è¦ç™»å½•MQTTæœåŠ¡å™¨ï¼Œé¦–å…ˆè®°å¾—å…ˆçŸ¥é“æœåŠ¡å™¨çš„åœ°å€æ˜¯å¤šå°‘ï¼Œç«¯å£æ˜¯å¤šå°‘ã€‚</p>
<p>å¸®åŠ©æ–‡æ¡£åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.huaweicloud.com%2Fiotdm%2F%3Fregion%3Dcn-north-4%23%2Fdm-portal%2Fhome" target="_blank" title="https://console.huaweicloud.com/iotdm/?region=cn-north-4#/dm-portal/home" ref="nofollow noopener noreferrer">console.huaweicloud.com/iotdm/?regiâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28721cafc3e4419ab7d458158aa5c22d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=vouEWdFtwJGyeeINjWPcJcbRcb0%3D" alt="image-20240509193207359" loading="lazy"/></p>
<p>MQTTåè®®çš„ç«¯å£æ”¯æŒ1883å’Œ8883ï¼Œå®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼š8883 æ˜¯åŠ å¯†ç«¯å£æ›´åŠ å®‰å…¨ã€‚ä½†æ˜¯å•ç‰‡æœºä¸Šä½¿ç”¨æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥å½“å‰çš„è®¾å¤‡æ˜¯é‡‡ç”¨1883ç«¯å£è¿›è¿æ¥çš„ã€‚</p>
<p><strong>æ ¹æ®ä¸Šé¢çš„åŸŸåå’Œç«¯å£å·ï¼Œå¾—åˆ°ä¸‹é¢çš„IPåœ°å€å’Œç«¯å£å·ä¿¡æ¯ï¼š</strong>   å¦‚æœè®¾å¤‡æ”¯æŒå¡«å†™åŸŸåå¯ä»¥ç›´æ¥å¡«åŸŸåï¼Œä¸æ”¯æŒå°±ç›´æ¥å¡«å†™IPåœ°å€ã€‚  ï¼ˆIPåœ°å€å°±æ˜¯åŸŸåè§£æå¾—åˆ°çš„ï¼‰</p>
<pre><code class="hljs language-cpp" lang="cpp">åä¸ºäº‘çš„MQTTæœåŠ¡å™¨åœ°å€ï¼š<span class="hljs-number">117.78</span><span class="hljs-number">.5</span><span class="hljs-number">.125</span>
åä¸ºäº‘çš„MQTTç«¯å£å·ï¼š<span class="hljs-number">1883</span>
</code></pre>
<p>å¦‚ä½•å¾—åˆ°IPåœ°å€ï¼Ÿå¦‚ä½•åŸŸåè½¬IPï¼Ÿ  æ‰“å¼€Windowsçš„å‘½ä»¤è¡Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp">ping  ad635970a1.st1.iotda-device.cn-north<span class="hljs-number">-4.</span>myhuaweicloud.com
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78672b5427c6440989468a2bfe855d51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=pAOujZ97EIi%2BtOgVkykgaoNnMlc%3D" alt="image-20240425182610048" loading="lazy"/></p>
<h4 data-id="heading-39">ï¼ˆ2ï¼‰ç”ŸæˆMQTTä¸‰å…ƒç»„</h4>
<p>åä¸ºäº‘æä¾›äº†ä¸€ä¸ªåœ¨çº¿å·¥å…·ï¼Œç”¨æ¥ç”ŸæˆMQTTé‰´æƒä¸‰å…ƒç»„ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fiot-tool.obs-website.cn-north-4.myhuaweicloud.com%2F" target="_blank" title="https://iot-tool.obs-website.cn-north-4.myhuaweicloud.com/" ref="nofollow noopener noreferrer">iot-tool.obs-website.cn-north-4.myhuaweicloud.com/</a></p>
<p>æ‰“å¼€è¿™ä¸ªå·¥å…·ï¼Œå¡«å…¥è®¾å¤‡çš„ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯åˆšæ‰åˆ›å»ºå®Œè®¾å¤‡ä¹‹åä¿å­˜çš„ä¿¡æ¯ï¼‰ï¼Œç‚¹å‡»ç”Ÿæˆï¼Œå°±å¯ä»¥å¾—åˆ°MQTTçš„ç™»å½•ä¿¡æ¯äº†ã€‚</p>
<p><strong>ä¸‹é¢æ˜¯æ‰“å¼€çš„é¡µé¢ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/514802762d904bdcbf50cf7eda3d1b9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=V03NiFDBbpiQ2O6nz1r4T%2Biyw84%3D" alt="image-20240425183025893" loading="lazy"/></p>
<p><strong>å¡«å…¥è®¾å¤‡çš„ä¿¡æ¯ï¼š</strong>   ï¼ˆä¸Šé¢ä¸¤è¡Œå°±æ˜¯è®¾å¤‡åˆ›å»ºå®Œæˆä¹‹åä¿å­˜å¾—åˆ°çš„ï¼‰</p>
<p>ç›´æ¥å¾—åˆ°ä¸‰å…ƒç»„ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c8cd7be6a534b7cad309dcfb4968f37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=0mChOVaLRJU51PohVrUL8eIDP2E%3D" alt="image-20240509193310020" loading="lazy"/></p>
<p>å¾—åˆ°ä¸‰å…ƒç»„ä¹‹åï¼Œè®¾å¤‡ç«¯é€šè¿‡MQTTåè®®ç™»å½•é‰´æƒçš„æ—¶å€™ï¼Œå¡«å…¥å‚æ•°å³å¯ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp">ClientId  <span class="hljs-number">663</span>cb18871d845632a0912e7_dev1_0_0_2024050911
Username  <span class="hljs-number">663</span>cb18871d845632a0912e7_dev1
Password  <span class="hljs-number">71b</span>82deae83e80f04c4269b5bbce3b2fc7c13f610948fe210ce18650909ac237
</code></pre>
<h3 data-id="heading-40">2.7 æ¨¡æ‹Ÿè®¾å¤‡ç™»å½•æµ‹è¯•</h3>
<p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ä»‹ç»ï¼Œå·²ç»åˆ›å»ºäº†äº§å“ï¼Œè®¾å¤‡ï¼Œæ•°æ®æ¨¡å‹ï¼Œå¾—åˆ°MQTTç™»å½•ä¿¡æ¯ã€‚ æ¥ä¸‹æ¥å°±ç”¨MQTTå®¢æˆ·ç«¯è½¯ä»¶æ¨¡æ‹ŸçœŸå®çš„è®¾å¤‡æ¥ç™»å½•å¹³å°ã€‚æµ‹è¯•ä¸æœåŠ¡å™¨é€šä¿¡æ˜¯å¦æ­£å¸¸ã€‚</p>
<p><strong>MQTTè½¯ä»¶ä¸‹è½½åœ°å€ã€å…è´¹ã€‘ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fdownload.csdn.net%2Fdownload%2Fxiaolong1126626497%2F89928772" target="_blank" title="https://download.csdn.net/download/xiaolong1126626497/89928772" ref="nofollow noopener noreferrer">download.csdn.net/download/xiâ€¦</a></p>
<h4 data-id="heading-41">ï¼ˆ1ï¼‰å¡«å…¥ç™»å½•ä¿¡æ¯</h4>
<p>æ‰“å¼€MQTTå®¢æˆ·ç«¯è½¯ä»¶ï¼Œå¯¹å·å¡«å…¥ç›¸å…³ä¿¡æ¯ï¼ˆå°±æ˜¯ä¸Šé¢çš„æ–‡æœ¬ä»‹ç»ï¼‰ã€‚ç„¶åï¼Œç‚¹å‡»ç™»å½•ï¼Œè®¢é˜…ä¸»é¢˜ï¼Œå‘å¸ƒä¸»é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1645ee1035024af89e127ca0936bd056~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=m2iFJrbX2KCmazwXLItJSheRrdc%3D" alt="image-20240509193457358" loading="lazy"/></p>
<h4 data-id="heading-42">ï¼ˆ2ï¼‰æ‰“å¼€ç½‘é¡µæŸ¥çœ‹</h4>
<p>å®Œæˆä¸Šé¢çš„æ“ä½œä¹‹åï¼Œæ‰“å¼€åä¸ºäº‘ç½‘é¡µåå°ï¼Œå¯ä»¥çœ‹åˆ°è®¾å¤‡å·²ç»åœ¨çº¿äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/785fe0014613421c862df2833b7242b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=UCAhuXTgXANj3DZEWpHRvpcKD90%3D" alt="image-20240612100508790" loading="lazy"/></p>
<p>ç‚¹å‡»è¯¦æƒ…é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ•°æ®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6baa2073dc8b4283824c173e3ba02aff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=sXlb8TUTXC5GF08QBPdkoRWf7VU%3D" alt="image-20240612100529581" loading="lazy"/></p>
<p>åˆ°æ­¤ï¼Œäº‘å¹³å°çš„éƒ¨ç½²å·²ç»å®Œæˆï¼Œè®¾å¤‡å·²ç»å¯ä»¥æ­£å¸¸ä¸Šä¼ æ•°æ®äº†ã€‚</p>
<h4 data-id="heading-43">ï¼ˆ3ï¼‰MQTTç™»å½•æµ‹è¯•å‚æ•°æ€»ç»“</h4>
<pre><code class="hljs language-cpp" lang="cpp">MQTTæœåŠ¡å™¨:  <span class="hljs-number">117.78</span><span class="hljs-number">.5</span><span class="hljs-number">.125</span>
MQTTç«¯å£å·:  <span class="hljs-number">183</span>

<span class="hljs-comment">//ç‰©è”ç½‘æœåŠ¡å™¨çš„è®¾å¤‡ä¿¡æ¯</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> MQTT_ClientID <span class="hljs-string">"663cb18871d845632a0912e7_dev1_0_0_2024050911"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> MQTT_UserName <span class="hljs-string">"663cb18871d845632a0912e7_dev1"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> MQTT_PassWord <span class="hljs-string">"71b82deae83e80f04c4269b5bbce3b2fc7c13f610948fe210ce18650909ac237"</span></span>

<span class="hljs-comment">//è®¢é˜…ä¸å‘å¸ƒçš„ä¸»é¢˜</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> SET_TOPIC  <span class="hljs-string">"$oc/devices/663cb18871d845632a0912e7_dev1/sys/messages/down"</span>  <span class="hljs-comment">//è®¢é˜…</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> POST_TOPIC <span class="hljs-string">"$oc/devices/663cb18871d845632a0912e7_dev1/sys/properties/report"</span>  <span class="hljs-comment">//å‘å¸ƒ</span></span>


å‘å¸ƒçš„æ•°æ®:
{<span class="hljs-string">"services"</span>: [{<span class="hljs-string">"service_id"</span>: <span class="hljs-string">"stm32"</span>,<span class="hljs-string">"properties"</span>:{<span class="hljs-string">"çš„å­—æ®µåå­—1"</span>:<span class="hljs-number">30</span>,<span class="hljs-string">"çš„å­—æ®µåå­—2"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"çš„å­—æ®µåå­—3"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"çš„å­—æ®µåå­—4"</span>:<span class="hljs-number">0</span>}}]}

</code></pre>
<h3 data-id="heading-44">2.8 åˆ›å»ºIAMè´¦æˆ·</h3>
<p>åˆ›å»ºä¸€ä¸ªIAMè´¦æˆ·ï¼Œå› ä¸ºæ¥ä¸‹æ¥å¼€å‘ä¸Šä½æœºï¼Œéœ€è¦ä½¿ç”¨äº‘å¹³å°çš„APIæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½éœ€è¦tokenè¿›è¡Œé‰´æƒã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯èº«ä»½çš„è®¤è¯ã€‚  è°ƒç”¨æ¥å£è·å–Tokenæ—¶ï¼Œå°±éœ€è¦å¡«å†™IAMè´¦å·ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹è¿‡ç¨‹ã€‚</p>
<p>åœ°å€:  <a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.huaweicloud.com%2Fiam%2F%3Fregion%3Dcn-north-4%23%2Fiam%2Fusers" target="_blank" title="https://console.huaweicloud.com/iam/?region=cn-north-4#/iam/users" ref="nofollow noopener noreferrer">console.huaweicloud.com/iam/?regionâ€¦</a></p>
<p>**ã€1ã€‘è·å–é¡¹ç›®å‡­è¯ **  ç‚¹å‡»å·¦ä¸Šè§’ç”¨æˆ·åï¼Œé€‰æ‹©ä¸‹æ‹‰èœå•é‡Œçš„<code>æˆ‘çš„å‡­è¯</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2062a032bf2547e3bf52615f0b6ae3c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=LHJ0jg0v1OfX4yDTb7QgneFDgwc%3D" alt="image-20240509193646253" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82319076baee40058ab4eed4ac38af17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=UAXxl5GU6vOqTEcvTWUU7iynBDg%3D" alt="image-20240509193701262" loading="lazy"/></p>
<p><strong>é¡¹ç›®å‡­è¯:</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-number">28</span>add376c01e4a61ac8b621c714bf459
</code></pre>
<p><strong>ã€2ã€‘åˆ›å»ºIAMç”¨æˆ·</strong></p>
<p>é¼ æ ‡æ”¾åœ¨å·¦ä¸Šè§’å¤´åƒä¸Šï¼Œåœ¨ä¸‹æ‹‰èœå•é‡Œé€‰æ‹©<code>ç»Ÿä¸€èº«ä»½è®¤è¯</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6aa6543f1734f26aad695500910aa4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=FLdflBY8cV3jgkHT5ncLD9GXilo%3D" alt="image-20240509193729078" loading="lazy"/></p>
<p>ç‚¹å‡»å·¦ä¸Šè§’<code>åˆ›å»ºç”¨æˆ·</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83554585c7e44b5a95cd80fdf2395f08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=OOZBI363CdPMKnyJIAzZz8tqO18%3D" alt="image-20240509193744287" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3597d011458042d9ac113b86ae122565~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=fU3w4vdurlImOw6FDEsEoPrWixM%3D" alt="image-20240314153208692" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f381cbaf63046b68e2d99040f545624~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=ewMwPkjtJW1rKQH6qc9XbejfOLs%3D" alt="image-20240314153228359" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abeb9f97d260461cafb8a608fb8fd4fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Ml3oiY%2FEWwdiGcQ7FevOrqi6jRk%3D" alt="image-20240314153258229" loading="lazy"/></p>
<p><strong>åˆ›å»ºæˆåŠŸï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6890cd751d3742268fa46346af3c8619~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=59loPvTOiLQFHBPlTr6rKZOMPFs%3D" alt="image-20240314153315444" loading="lazy"/></p>
<p>ã€3ã€‘åˆ›å»ºå®Œæˆ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a202140521c7424f8c02815d1f1c2519~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=wlHWQ%2BZt2VTWKvFxMfq8pXYFHz8%3D" alt="image-20240509193828289" loading="lazy"/></p>
<p><strong>ç”¨æˆ·ä¿¡æ¯å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp">ä¸»ç”¨æˆ·å  l19504562721
IAMç”¨æˆ·  ds_abc
å¯†ç      DS12345678
</code></pre>
<h3 data-id="heading-45">2.9 è·å–å½±å­æ•°æ®</h3>
<p>å¸®åŠ©æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.huaweicloud.com%2Fapi-iothub%2Fiot_06_v5_0079.html" target="_blank" title="https://support.huaweicloud.com/api-iothub/iot_06_v5_0079.html" ref="nofollow noopener noreferrer">support.huaweicloud.com/api-iothub/â€¦</a></p>
<p><strong>è®¾å¤‡å½±å­ä»‹ç»ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp">è®¾å¤‡å½±å­æ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨å’Œæ£€ç´¢è®¾å¤‡å½“å‰çŠ¶æ€ä¿¡æ¯çš„JSONæ–‡æ¡£ã€‚
æ¯ä¸ªè®¾å¤‡æœ‰ä¸”åªæœ‰ä¸€ä¸ªè®¾å¤‡å½±å­ï¼Œç”±è®¾å¤‡IDå”¯ä¸€æ ‡è¯†
è®¾å¤‡å½±å­ä»…ä¿å­˜æœ€è¿‘ä¸€æ¬¡è®¾å¤‡çš„ä¸ŠæŠ¥æ•°æ®å’Œé¢„æœŸæ•°æ®
æ— è®ºè¯¥è®¾å¤‡æ˜¯å¦åœ¨çº¿ï¼Œéƒ½å¯ä»¥é€šè¿‡è¯¥å½±å­è·å–å’Œè®¾ç½®è®¾å¤‡çš„å±æ€§
</code></pre>
<p>ç®€å•æ¥è¯´ï¼šè®¾å¤‡å½±å­å°±æ˜¯ä¿å­˜ï¼Œè®¾å¤‡æœ€æ–°ä¸Šä¼ çš„ä¸€æ¬¡æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬è®¾è®¡çš„è½¯ä»¶é‡Œï¼Œå¦‚æœæƒ³è¦è·å–è®¾å¤‡çš„æœ€æ–°çŠ¶æ€ä¿¡æ¯ï¼Œå°±é‡‡ç”¨è®¾å¤‡å½±å­æ¥å£ã€‚</p>
<p>å¦‚æœå¯¹æ¥å£ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥å…ˆè¿›è¡Œåœ¨çº¿è°ƒè¯•ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fapiexplorer.developer.huaweicloud.com%2Fapiexplorer%2Fdoc%3Fproduct%3DIoTDA%26api%3DShowDeviceShadow" target="_blank" title="https://apiexplorer.developer.huaweicloud.com/apiexplorer/doc?product=IoTDA&amp;api=ShowDeviceShadow" ref="nofollow noopener noreferrer">apiexplorer.developer.huaweicloud.com/apiexplorerâ€¦</a></p>
<p>åœ¨çº¿è°ƒè¯•æ¥å£ï¼Œå¯ä»¥è¯·æ±‚å½±å­æ¥å£ï¼Œäº†è§£è¯·æ±‚ï¼Œä¸è¿”å›çš„æ•°æ®æ ¼å¼ã€‚</p>
<p><strong>è°ƒè¯•å®Œæˆçœ‹å³ä¸‹è§’çš„å“åº”ä½“ï¼Œå°±æ˜¯è¿”å›çš„å½±å­æ•°æ®ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dc5dbdda256495aad3b6d0e3f8545a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=auviXLjBrxmq4qwDZ1NKBB11fXo%3D" alt="image-20240509194152229" loading="lazy"/></p>
<p><strong>è®¾å¤‡å½±å­æ¥å£è¿”å›çš„æ•°æ®å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp">{
 <span class="hljs-string">"device_id"</span>: <span class="hljs-string">"663cb18871d845632a0912e7_dev1"</span>,
 <span class="hljs-string">"shadow"</span>: [
  {
   <span class="hljs-string">"service_id"</span>: <span class="hljs-string">"stm32"</span>,
   <span class="hljs-string">"desired"</span>: {
    <span class="hljs-string">"properties"</span>: null,
    <span class="hljs-string">"event_time"</span>: null
   },
   <span class="hljs-string">"reported"</span>: {
    <span class="hljs-string">"properties"</span>: {
     <span class="hljs-string">"DHT11_T"</span>: <span class="hljs-number">18</span>,
     <span class="hljs-string">"DHT11_H"</span>: <span class="hljs-number">90</span>,
     <span class="hljs-string">"BH1750"</span>: <span class="hljs-number">38</span>,
     <span class="hljs-string">"MQ135"</span>: <span class="hljs-number">70</span>
    },
    <span class="hljs-string">"event_time"</span>: <span class="hljs-string">"20240509T113448Z"</span>
   },
   <span class="hljs-string">"version"</span>: <span class="hljs-number">3</span>
  }
 ]
}
</code></pre>
<p><strong>è°ƒè¯•æˆåŠŸä¹‹åï¼Œå¯ä»¥å¾—åˆ°è®¿é—®å½±å­æ•°æ®çš„çœŸå®é“¾æ¥ï¼Œæ¥ä¸‹æ¥çš„ä»£ç å¼€å‘ä¸­ï¼Œå°±é‡‡ç”¨Qtå†™ä»£ç è®¿é—®æ­¤é“¾æ¥ï¼Œè·å–å½±å­æ•°æ®ï¼Œå®Œæˆä¸Šä½æœºå¼€å‘ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c50df9d3fc9a4e5b84b259a3fabd0058~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=C6mzKBLWwPwMes2jFLJp1%2Fu18jo%3D" alt="image-20240509194214716" loading="lazy"/></p>
<p><strong>é“¾æ¥å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp">https:<span class="hljs-comment">//ad635970a1.st1.iotda-app.cn-north-4.myhuaweicloud.com:443/v5/iot/28add376c01e4a61ac8b621c714bf459/devices/663cb18871d845632a0912e7_dev1/shadow</span>
</code></pre>
<h2 data-id="heading-46">ä¸‰ã€Qtå¼€å‘å…¥é—¨ä¸ç¯å¢ƒæ­å»º</h2>
<p><strong>å½“å‰é¡¹ç›®çš„ä¸Šä½æœºæ˜¯é‡‡ç”¨Qtå¼€å‘çš„ï¼Œè¿™ä¸€ç« èŠ‚ä¸»è¦æ˜¯ä»‹ç»Qtå¼€å‘ç¯å¢ƒçš„å®‰è£…ï¼Œä»¥åŠQtå¼€å‘ç¯å¢ƒå…¥é—¨çš„ä½¿ç”¨ã€‚å¦‚æœQtæ²¡æœ‰ä»»ä½•åŸºç¡€ï¼Œå»ºè®®ä»”ç»†çœ‹ä¸€éã€‚</strong></p>
<h3 data-id="heading-47">3.1 Qtæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>Qt æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€è·¨å¹³å°çš„åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰åº”ç”¨ç¨‹åºï¼Œä½†å®ƒä¸ä»…ä»…å±€é™äºGUIç¼–ç¨‹ã€‚å®ƒç”±æŒªå¨çš„å¥‡è¶£ç§‘æŠ€ï¼ˆTrollTechï¼‰æœ€åˆäº1991å¹´å¼€å‘ï¼Œå¹¶åœ¨åç»­çš„å‘å±•å†ç¨‹ä¸­ç»å†äº†å¤šæ¬¡æ‰€æœ‰æƒå˜æ›´ï¼ŒåŒ…æ‹¬è¯ºåŸºäºšå’ŒDigiaç­‰å…¬å¸æ¥æ‰‹ï¼Œç°åœ¨Qtå±äºThe Qt Companyæ‰€æœ‰ã€‚</p>
<p><strong>Qt ä¸»è¦ç‰¹ç‚¹å’Œä¼˜åŠ¿åŒ…æ‹¬ï¼š</strong></p>
<p>ï¼ˆ1ï¼‰<strong>è·¨å¹³å°</strong>ï¼šQt æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨åŒä¸€ä»½æºä»£ç åœ¨ä¸åŒå¹³å°ä¸Šç¼–è¯‘è¿è¡Œï¼Œå¦‚Windowsã€Linuxã€macOSã€Androidä»¥åŠå„ç§åµŒå…¥å¼ç³»ç»Ÿï¼ˆå¦‚RTOSï¼‰ï¼Œå®ç°â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„ç¼–è¯‘â€ã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>C++ å¼€å‘</strong>ï¼šQt çš„æ ¸å¿ƒæ˜¯åŸºäºC++ç¼–ç¨‹è¯­è¨€æ„å»ºï¼Œæä¾›äº†ä¸€å¥—ä¸°å¯Œçš„ç±»åº“ï¼Œé€šè¿‡é¢å‘å¯¹è±¡çš„è®¾è®¡æ–¹å¼ç®€åŒ–äº†å¼€å‘è¿‡ç¨‹ã€‚</p>
<p>ï¼ˆ3ï¼‰<strong>å›¾å½¢ç”¨æˆ·ç•Œé¢</strong>ï¼šQt æä¾›äº†å®Œæ•´çš„GUIç»„ä»¶é›†ï¼ŒåŒ…å«çª—å£ã€æŒ‰é’®ã€æ ‡ç­¾ã€æ–‡æœ¬æ¡†ç­‰å„ç§æ ‡å‡†æ§ä»¶ï¼Œä»¥åŠå¸ƒå±€ç®¡ç†å™¨ã€æ ·å¼è¡¨ç­‰åŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿé«˜æ•ˆåœ°åˆ›å»ºç¾è§‚ä¸”åŠŸèƒ½å®Œå–„çš„æ¡Œé¢åº”ç”¨æˆ–ç§»åŠ¨åº”ç”¨ç•Œé¢ã€‚</p>
<p>ï¼ˆ4ï¼‰<strong>å·¥å…·é“¾å®Œæ•´</strong>ï¼šQt åŒ…å«ä¸€ç³»åˆ—é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰å’Œè¾…åŠ©å·¥å…·ï¼Œä¾‹å¦‚Qt Creatoræ˜¯ä¸€ä¸ªå…¨èƒ½çš„è·¨å¹³å°IDEï¼ŒQt Designerç”¨äºå¯è§†åŒ–æ‹–æ‹½è®¾è®¡UIç•Œé¢ï¼ŒQt Linguistæ”¯æŒå›½é™…åŒ–èµ„æºæ–‡ä»¶çš„ç¿»è¯‘ï¼Œè¿˜æœ‰Qt Assistantå’Œå¤§é‡æ–‡æ¡£èµ„æºæ–¹ä¾¿å¼€å‘è€…çš„ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ5ï¼‰<strong>éGUIåŠŸèƒ½ä¸°å¯Œ</strong>ï¼šé™¤äº†GUIåŠŸèƒ½å¤–ï¼ŒQt è¿˜æä¾›äº†ä¼—å¤šéå›¾å½¢åŒ–åŠŸèƒ½æ¨¡å—ï¼Œå¦‚ç½‘ç»œé€šä¿¡ã€æ•°æ®åº“è®¿é—®ã€XMLå¤„ç†ã€å¤šåª’ä½“å¤„ç†ï¼ˆéŸ³é¢‘è§†é¢‘ï¼‰ã€æ–‡ä»¶I/Oã€çº¿ç¨‹ä¸å¹¶å‘å¤„ç†ã€OpenGLå’Œ3Då›¾å½¢æ¸²æŸ“ç­‰ã€‚</p>
<p>ï¼ˆ6ï¼‰<strong>å…ƒå¯¹è±¡ç³»ç»Ÿ</strong>ï¼šQt ä½¿ç”¨å…ƒå¯¹è±¡ç³»ç»Ÿï¼ˆMeta-Object System, MOCï¼‰å®ç°äº†ä¿¡å·ä¸æ§½æœºåˆ¶ï¼ˆSignals and Slotsï¼‰ï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œå…è®¸åœ¨ä¸åŒå¯¹è±¡ä¹‹é—´å®‰å…¨åœ°è¿›è¡Œå¼‚æ­¥é€šä¿¡ã€‚</p>
<p>ï¼ˆ7ï¼‰<strong>å¯æ‰©å±•æ€§ä¸çµæ´»æ€§</strong>ï¼šQt æ¶æ„é«˜åº¦çµæ´»ï¼Œæ”¯æŒæ’ä»¶ä½“ç³»ç»“æ„ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰ç»„ä»¶å¹¶è½»æ¾åœ°é›†æˆåˆ°Qtåº”ç”¨ä¸­ã€‚</p>
<p>Qt ä»¥å…¶å¼ºå¤§çš„è·¨å¹³å°èƒ½åŠ›å’Œå…¨é¢çš„åŠŸèƒ½é›†åˆæˆä¸ºè®¸å¤šä¼ä¸šå’Œä¸ªäººå¼€å‘è€…é€‰æ‹©ç”¨æ¥å¼€å‘é«˜æ€§èƒ½ã€é«˜ç¨³å®šæ€§çš„åº”ç”¨ç¨‹åºçš„é‡è¦å·¥å…·ä¹‹ä¸€ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç±»æ¡Œé¢è½¯ä»¶ã€åµŒå…¥å¼è®¾å¤‡ã€ç§»åŠ¨åº”ç”¨ä»¥åŠæœåŠ¡å™¨ç«¯ç»„ä»¶ç­‰é¢†åŸŸã€‚</p>
<h3 data-id="heading-48">3.2 Qtç‰ˆæœ¬ä»‹ç»</h3>
<p>åœ¨Qtå‘è¡Œç‰ˆæœ¬ä¸­å°†è¦æ¶‰åŠä¸¤ä¸ªç‰ˆæœ¬ï¼šQtå•†ä¸šæˆæƒå’ŒQtå¼€æºæˆæƒã€‚</p>
<p>ï¼ˆ1ï¼‰Qtå•†ä¸šæˆæƒæ˜¯è®¾è®¡å•†ä¸šè½¯ä»¶çš„å¼€å‘ç¯å¢ƒï¼Œè¿™äº›å•†ä¸šè½¯ä»¶ä½¿ç”¨äº†ä¼ ç»Ÿçš„å•†ä¸šæ¥å‘å¸ƒï¼Œå®ƒåŒ…å«äº†ä¸€äº›æ›´æ–°çš„åŠŸèƒ½ã€æŠ€æœ¯ä¸Šçš„æ”¯æŒå’Œå¤§é‡çš„è§£å†³æ–¹æ¡ˆï¼Œå¼€å‘äº†ä½¿ç”¨äºè¡Œä¸šçš„ä¸€äº›ç‰¹å®šçš„ç»„ä»¶ï¼Œæœ‰ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½åªåœ¨å•†ä¸šç”¨æˆ·ä¸­ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ2ï¼‰Qtå¼€æºæˆæƒæ˜¯ç”¨æ¥å¼€å‘å¼€æºçš„è½¯ä»¶ï¼Œå®ƒæä¾›äº†ä¸€äº›å…è´¹çš„æ”¯æŒï¼Œå¹¶éµå¾ªQPLåè®®ã€‚</p>
<p>å¼€æ”¾æºä»£ç æ˜¯å…è´¹çš„è½¯ä»¶ï¼Œä¸ç‰µæ¶‰ç”¨æˆ·çš„æŸäº›æƒç›Šã€‚ä»»ä½•äººéƒ½æœ‰ä½¿ç”¨å¼€æºè½¯ä»¶å’Œå‚ä¸å®ƒçš„ä¿®æ”¹çš„æœºä¼šï¼Œè¿™å°±æ„å‘³ç€å…¶ä»–çš„äººåŒæ ·å¯è·å¾—å¼€å‘çš„ä»£ç ã€‚ç›®å‰ Qt çš„å¼€æºæˆæƒæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ GPL æˆæƒï¼Œå¦ä¸€ç§æ˜¯ LGPL æˆæƒã€‚</p>
<h3 data-id="heading-49">3.3 Qtå¼€å‘ç¯å¢ƒå®‰è£…</h3>
<p>Qtçš„ä¸­æ–‡å®˜ç½‘ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.qt.io%2Fzh-cn%2F!%255Bimage-20221207160550486%255D(https%3A%2F%2Fled-obs.obs.cn-north-1.myhuaweicloud.com%2FBlog%2Fimg%2Fimage-20221207160550486.png)" target="_blank" title="https://www.qt.io/zh-cn/!%5Bimage-20221207160550486%5D(https://led-obs.obs.cn-north-1.myhuaweicloud.com/Blog/img/image-20221207160550486.png)" ref="nofollow noopener noreferrer">www.qt.io/zh-cn/![imaâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b65fec9401b4fe2a6bba80e43a459f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=6igUydPoyOoFHVOZo1iZJEOFo4Y%3D" alt="image-20221207160606892" loading="lazy"/></p>
<p>QT5.12.6çš„ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdownload.qt.io%2Farchive%2Fqt%2F5.12%2F5.12.6" target="_blank" title="https://download.qt.io/archive/qt/5.12/5.12.6" ref="nofollow noopener noreferrer">download.qt.io/archive/qt/â€¦</a></p>
<p>æ‰“å¼€ä¸‹è½½é“¾æ¥åé€‰æ‹©ä¸‹é¢çš„ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ï¼š</p>
<p><code>qt-opensource-windows-x86-5.12.6.exe 13-Nov-2019 07:28 3.7G Details</code></p>
<p>è½¯ä»¶å®‰è£…æ—¶æ–­ç½‘å®‰è£…ï¼Œå¦åˆ™ä¼šæç¤ºè¾“å…¥è´¦æˆ·ã€‚</p>
<p><strong>å¦‚æœä¸‹è½½ä¸äº†ï¼Œå¯ä»¥åœ¨ç½‘ç›˜é‡Œæ‰¾åˆ°å®‰è£…åŒ…ä¸‹è½½ï¼š</strong>    é£ä¹¦æ–‡æ¡£è®°å½•çš„ç½‘ç›˜åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fccnr8sukk85n.feishu.cn%2Fwiki%2FQjY8weDYHibqRYkFP2qcA9aGnvb%3Ffrom%3Dfrom_copylink" target="_blank" title="https://ccnr8sukk85n.feishu.cn/wiki/QjY8weDYHibqRYkFP2qcA9aGnvb?from=from_copylink" ref="nofollow noopener noreferrer">ccnr8sukk85n.feishu.cn/wiki/QjY8weâ€¦</a></p>
<p>å®‰è£…çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå¤é€‰æ¡†é‡Œå‹¾é€‰ä¸€ä¸ª<code>mingw 32</code>ç¼–è¯‘å™¨å³å¯ï¼Œå…¶ä»–çš„ä¸ç®¡é»˜è®¤å°±è¡Œï¼Œç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ç»§ç»­å®‰è£…ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d9784a612b34b1894d3678a13a22341~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=e72Jj5uxVcliaKd7fWkLfA4tFLE%3D" alt="image-20221203151742653" loading="lazy"/></p>
<p>é€‰æ‹©MinGW 32-bit ç¼–è¯‘å™¨ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d3a87702e02468181ac0020e4be9f67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=4Ng%2BbmOODXYVaa4eUuVm1Qekcqs%3D" alt="image-20221203151750344" loading="lazy"/></p>
<h3 data-id="heading-50">3.4 å¼€å‘ç¬¬ä¸€ä¸ªQTç¨‹åº</h3>
<p>åœ¨QTå¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–å†™ä»£ç ä¹Ÿå¯ä»¥ä½¿ç”¨UIè®¾è®¡å¸ˆç›´æ¥æ‹–æ‹½æ§ä»¶çš„æ–¹å¼ç¼–å†™ç•Œé¢å’Œå¸ƒå±€ï¼Œåœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ä¸€èˆ¬æ˜¯ä¸¤ç§æ–¹å¼ç»“åˆä½¿ç”¨ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<p><strong>æœ¬å°èŠ‚ç”¨ä¸€ä¸ªç®€å•çš„ "Hello QT" ç¨‹åºä»‹ç»ä¸€ä¸‹ä½¿ç”¨QtCreatoræ–°å»ºå·¥ç¨‹çš„æ­¥éª¤</strong>ã€‚</p>
<p>ï¼ˆ1ï¼‰æ‰“å¼€QtCreatorè½¯ä»¶ï¼Œé€‰æ‹©New Projectï¼Œæ–°å»ºä¸€ä¸ªå·¥ç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3f5779cfa67451aabaa85d3d8e28efc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=pbD7dDa%2B7jXAdT9bNQTZH5J0YG4%3D" alt="image-20240304134953164" loading="lazy"/></p>
<p><strong>ï¼ˆ2ï¼‰é¡¹ç›®æ¨¡æ¿é€‰æ‹©QT Widgets Application</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e560b32a44047b7aa47a91eaf91e952~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=wVi6WoHLwjdAvBZICVYAkH4ClFQ%3D" alt="image-20240304135416497" loading="lazy"/></p>
<p><strong>ï¼ˆ3ï¼‰è®¾ç½®é¡¹ç›®åç§°å’Œå­˜æ”¾è·¯å¾„</strong></p>
<p>æ³¨æ„ï¼šQTé¡¹ç›®è·¯å¾„å’Œåç§°ä¸èƒ½å‡ºç°ä¸­æ–‡å­—ç¬¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6ebe97b4ad840feb2c84a0918e20c2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=2EFfcS9gg4zS03OE2wyB%2BhfyH1U%3D" alt="image-20240304135504345" loading="lazy"/></p>
<p><strong>ï¼ˆ4ï¼‰ç¼–è¯‘å·¥å…·å¥—ä»¶é€‰æ‹©</strong></p>
<p>ç¼–è¯‘å·¥å…·å¥—ä»¶å¯ä»¥åé¢è‡ªå·±å¢åŠ ï¼Œæ¯”å¦‚å¢åŠ Androidçš„ã€‚å¥—ä»¶æ˜¯æŒ‡ Qt ç¨‹åºä»ç¼–è¯‘é“¾æ¥åˆ°è¿è¡Œç¯å¢ƒçš„å…¨éƒ¨å·¥å…·å’Œ Qt ç±»åº“çš„é›†åˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7872f1c2fa1140309ce9b66ef29c1012~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=%2F54DzLUNDFi5vPuS0fA0qzjIS%2BM%3D" alt="image-20240304135535341" loading="lazy"/></p>
<p><strong>ï¼ˆ5ï¼‰è®¾ç½®ç”Ÿæˆçš„ç±»ä¿¡æ¯</strong></p>
<p>åœ¨ç±»ä¿¡æ¯è®¾ç½®ç•Œé¢é€‰æ‹©åŸºç±»ï¼Œç›®å‰æœ‰ä¸‰ç§åŸºç±»ï¼šQMainWindowï¼ŒQWidgetï¼ŒQDialogã€‚åœ¨åŸºç±»é‡Œé€‰æ‹©QMainWindowï¼Œç±»åå’Œæ–‡ä»¶åä¼šæ ¹æ®åŸºç±»è‡ªåŠ¨ä¿®æ”¹ï¼Œä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ï¼Œé»˜è®¤å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76a4d2ffbe63472491b4a2fffd648c0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Flaw4mItaGVMV%2BptURdBCM0n%2FPY%3D" alt="image-20240304135630942" loading="lazy"/></p>
<p><strong>ï¼ˆ6ï¼‰é¡¹ç›®ç®¡ç†</strong></p>
<p>åœ¨é¡¹ç›®ç®¡ç†ç•Œé¢å¯ä»¥è®¾ç½®ä½œä¸ºå­é¡¹ç›®ï¼Œä»¥åŠåŠ å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚è¿™ä¸¤ä¸ªåŠŸèƒ½æš‚æ—¶ç”¨ä¸åˆ°ï¼Œéƒ½ç”¨é»˜è®¤çš„  ï¼Œç„¶åç‚¹å‡» â€œå®Œæˆâ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fcabfd49c1541a885d105f6cb23c447~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=PN7CgTGjDZwb1S9QJEa6f%2FdbbEQ%3D" alt="image-20240304135652922" loading="lazy"/></p>
<p><strong>ï¼ˆ7ï¼‰åˆ›å»ºå®Œæˆ</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5de4a6ce3cd84dc8ac1f686dccf13474~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=3rQgsaSMgJg%2F3LwurzIy4PUi7ug%3D" alt="image-20240304135728165" loading="lazy"/></p>
<p><strong>ï¼ˆ8ï¼‰ ç¼–è¾‘ä»£ç </strong></p>
<p>å±•å¼€main.cppæ–‡ä»¶ï¼Œæ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"mainwindow.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QApplication&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QDebug&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QLabel&gt;</span></span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>
</span>{
    <span class="hljs-function">QApplication <span class="hljs-title">a</span><span class="hljs-params">(argc, argv)</span></span>;
    <span class="hljs-comment">//MainWindow w;</span>
    <span class="hljs-comment">//w.show();</span>
    QLabel *label =<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"Hello Qt!"</span>);
    label-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">400</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">20</span>);
    label-&gt;<span class="hljs-built_in">show</span>();
    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">exec</span>();
}
</code></pre>
<p><strong>ä»£ç è§£æï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-number">1</span>)	<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QApplication&gt;</span>å’Œ #<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QLabel&gt;</span>æ˜¯QTçš„ç±»å£°æ˜å¤´æ–‡ä»¶ï¼Œå¯¹äºæ¯ä¸ªQTç±»éƒ½æœ‰ä¸€ä¸ªä¸è¯¥ç±»åŒåçš„å¤´æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªå¤´æ–‡ä»¶åŒ…å«äº†å¯¹è¯¥ç±»çš„å®šä¹‰ã€‚</span>
<span class="hljs-number">2</span>)	<span class="hljs-built_in">main</span>(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[]) ï¼šmainå‡½æ•°çš„æ ‡å‡†å†™æ³•ã€‚
<span class="hljs-number">3</span>)	<span class="hljs-function">QApplication <span class="hljs-title">a</span><span class="hljs-params">(argc, argv)</span>ï¼šåˆ›å»ºä¸€ä¸ªQApplicationå¯¹è±¡ï¼Œç”¨äºç®¡ç†åº”ç”¨ç¨‹åºçš„èµ„æºï¼ŒQApplicationç±»çš„æ„é€ å‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚
4)	QLabel *label </span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"Hello Qt!"</span>) ï¼šåˆ›å»ºQLabelçª—å£éƒ¨ä»¶ï¼ŒQLabelæ˜¯ä¸€ä¸ªQtæä¾›çš„çª—å£éƒ¨ä»¶ï¼Œå¯ä»¥ç”¨æ¥æ˜¾ç¤ºä¸€è¡Œæ–‡æœ¬ã€‚
<span class="hljs-number">5</span>)	label-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">400</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">20</span>) ï¼š è®¾ç½®æ§ä»¶æ˜¾ç¤ºçš„ä½ç½®ã€‚
<span class="hljs-number">6</span>)	label-&gt;<span class="hljs-built_in">show</span>()ï¼šä½¿Qlabelåˆ›å»ºçš„çª—å£å¯è§ï¼Œå°±æ˜¯æ˜¾ç¤ºè®¾ç½®çš„æ–‡æœ¬ã€‚
<span class="hljs-number">7</span>)	<span class="hljs-keyword">return</span> a.<span class="hljs-built_in">exec</span>()ï¼šåº”ç”¨ç¨‹åºå°†æ§åˆ¶æƒä¼ é€’ç»™QTï¼Œè®©ç¨‹åºè¿›å…¥æ¶ˆæ¯å¾ªç¯ã€‚ç­‰å¾…å¯èƒ½çš„èœå•ï¼Œå·¥å…·æ¡ï¼Œé¼ æ ‡ç­‰çš„è¾“å…¥ï¼Œè¿›è¡Œå“åº”ã€‚
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ad718b513084f38883dfae9cca9bc1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=87KdZC%2BT7T5A5F5J9%2BxW4BdjyMU%3D" alt="image-20240304135908750" loading="lazy"/></p>
<p><strong>ï¼ˆ9ï¼‰è¡Œç¨‹åº</strong></p>
<p>è¿è¡Œç¨‹åºå¯ä»¥ç‚¹å‡»å·¦ä¸‹è§’çš„ä¸‰è§’å½¢ç¬¦å·æˆ–è€…æŒ‰ä¸‹å¿«æ·é”®Ctrl+Rã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a218608a8d224e829050d0265a7ddccd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=KUQzh9HKKqht6bkk%2F%2BrNUQWElW4%3D" alt="image-20240304135938848" loading="lazy"/></p>
<h3 data-id="heading-51">3.5 è°ƒè¯•è¾“å‡º</h3>
<p>QTä¸­ä½¿ç”¨QDebugç±»è¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€‚ä¸»è¦ç”¨äºè°ƒè¯•ä»£ç ï¼Œç±»ä¼¼äºstd::coutçš„æ›¿ä»£å“ï¼Œæ”¯æŒQTçš„æ•°æ®ç±»å‹ã€‚ä½¿ç”¨å‰éœ€è¦åŒ…å«å¤´æ–‡ä»¶ã€‚</p>
<p><strong>è°ƒè¯•è¾“å‡ºçš„åˆ†ç±»</strong></p>





















<table><thead><tr><th>qDebug</th><th>è°ƒè¯•ä¿¡æ¯æç¤º</th></tr></thead><tbody><tr><td>qWarning</td><td>ä¸€èˆ¬çš„è­¦å‘Šæç¤º</td></tr><tr><td>qCritical</td><td>ä¸¥é‡é”™è¯¯æç¤º</td></tr><tr><td>qFatal</td><td>è‡´å‘½é”™è¯¯æç¤º</td></tr></tbody></table>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-built_in">qDebug</span>(<span class="hljs-string">"è°ƒè¯•ä¿¡æ¯è¾“å‡º"</span>);
<span class="hljs-built_in">qWarning</span>(<span class="hljs-string">"ä¸€èˆ¬è­¦å‘Šä¿¡æ¯è¾“å‡º"</span>);
<span class="hljs-built_in">qCritical</span>(<span class="hljs-string">"ä¸¥é‡é”™è¯¯è¾“å‡º"</span>);
<span class="hljs-built_in">qFatal</span>(<span class="hljs-string">"è‡´å‘½é”™è¯¯è¾“å‡º"</span>);
</code></pre>
<p>qDebugè¾“å‡ºçš„ä¿¡æ¯ä¼šæ‰“å°åˆ°QTè½¯ä»¶ä¸‹è¾¹çš„è¾“å‡ºé¢æ¿ã€‚</p>
<p>åœ¨ä¸ŠèŠ‚çš„HelloQtå·¥ç¨‹ä¸ŠåŠ ä¸Šè°ƒè¯•è¾“å‡ºä»£ç ï¼Œå¢åŠ çš„main.cppä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"mainwindow.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QApplication&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QDebug&gt;</span></span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>
</span>{
    <span class="hljs-function">QApplication <span class="hljs-title">a</span><span class="hljs-params">(argc, argv)</span></span>;
    <span class="hljs-comment">//MainWindow w;</span>
    <span class="hljs-comment">//w.show();</span>
    <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">"QTè°ƒè¯•ä¿¡æ¯è¾“å‡º"</span>;
    <span class="hljs-type">int</span> data_int=<span class="hljs-number">8888</span>;
    <span class="hljs-built_in">qDebug</span>()&lt;&lt;data_int;
    <span class="hljs-type">float</span> data_float=<span class="hljs-number">123.888</span>;
    <span class="hljs-built_in">qDebug</span>()&lt;&lt;data_float;
    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">exec</span>();
}
</code></pre>
<p>è¿è¡Œç¨‹åºï¼Œè§‚å¯Ÿè¾“å‡ºçš„è°ƒè¯•ä¿¡æ¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/231fccaa47e2428bbbf5d78446befc39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=EglhN0PVbbCIIZkaIe0vn0wietA%3D" alt="image-20240304140142790" loading="lazy"/></p>
<h3 data-id="heading-52">3.6 QT Creatorå¸¸ç”¨çš„å¿«æ·é”®</h3>
<p>æŒæ¡ä¸€äº›é€‚ç”¨çš„å¿«æ·é”®ï¼Œå¯ä»¥æé«˜ç¨‹åºå¼€å‘çš„æ•ˆç‡ã€‚</p>
<p>ï¼ˆ1ï¼‰F1 é”®ï¼Œå¿«é€Ÿåˆ‡æ¢å…‰æ ‡é€‰ä¸­çš„å‡½æ•°æˆ–è€…ç±»çš„å¸®åŠ©ä¿¡æ¯ï¼ŒæŒ‰ä¸€æ¬¡åŠå±æ˜¾ç¤ºï¼ŒæŒ‰ä¸‹ä¸¤æ¬¡å…¨å±æ˜¾ç¤ºã€‚</p>
<p>ï¼ˆ2ï¼‰F2 é”®ï¼Œå¿«é€Ÿåˆ‡æ¢åˆ°å…‰æ ‡é€‰ä¸­çš„å‡½æ•°æˆ–è€…ç±»çš„æºç å®šä¹‰å¤„ã€‚</p>
<p>ï¼ˆ3ï¼‰F4é”®ï¼Œå¿«é€Ÿåœ¨æºæ–‡ä»¶å’Œå¤´æ–‡ä»¶ä¹‹é—´åˆ‡æ¢ã€‚</p>
<p>ï¼ˆ4ï¼‰Ctrl(æŒ‰ä½)+ Tabï¼Œå¿«é€Ÿåˆ‡æ¢å·²æ‰“å¼€çš„æ–‡ä»¶</p>
<p>ï¼ˆ5ï¼‰Ctrl+ I ï¼Œç¼©è¿›å…‰æ ‡é€‰ä¸­è¡Œä»£ç ï¼ˆè‡ªåŠ¨ä¸ä¸Šå±‚ä»£ç å¯¹é½ï¼‰ã€‚</p>
<p>ï¼ˆ6ï¼‰Ctrl + / ï¼Œå¿«é€Ÿæ³¨é‡Šæˆ–è€…å–æ¶ˆæ³¨é‡Šå…‰æ ‡é€‰ä¸­è¡Œã€‚</p>
<p>ï¼ˆ7ï¼‰å¿«é€Ÿä¿®æ”¹å…¨å±€å˜é‡å</p>
<p>é¼ æ ‡å…‰æ ‡é€‰ä¸­å˜é‡åï¼ŒæŒ‰ä¸‹Ctrl+Shift+Rï¼Œå½“å˜é‡åç§°å‡ºç°çº¢è‰²æ¡†è¡¨ç¤ºå·²ç»æ¿€æ´»å…¨å±€ä¿®æ”¹åŠŸèƒ½ã€‚ä¿®æ”¹ä¸€å¤„ï¼Œæ•´ä¸ªå·¥ç¨‹å¯¹åº”å˜é‡åç§°å…¨éƒ¨ä¼šä¿®æ”¹ã€‚ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œå…‰æ ‡ç§»å¼€ï¼Œå†æŒ‰ä¸‹Ctrl+Shift+Rä¿å­˜ä¿®æ”¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a30a4452f949447b806c787af10a5937~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=fBkKbYSmmdln5tC5ANBqpJFsINY%3D" alt="image-20240304140242113" loading="lazy"/></p>
<p>ï¼ˆ8ï¼‰å¿«é€Ÿä¿®æ”¹å…¨å±€å‡½æ•°å</p>
<p>å¿«æ·æ–¹å¼ä¸å˜é‡ä¿®æ”¹ä¸€æ ·æŒ‰ä¸‹Ctrl+Shift+Rï¼Œä¸€å¤„ä¿®æ”¹æ•´ä¸ªå·¥ç¨‹å¯¹åº”çš„å‡½æ•°åç§°ä¹Ÿä¼šè·Ÿç€æ”¹ã€‚é€‰ä¸­å‡½æ•°åï¼ŒæŒ‰ä¸‹Ctrl+Shift+Råæ•´ä¸ªå·¥ç¨‹çš„å¯¹åº”çš„å‡½æ•°åä¼šé«˜äº®ï¼Œå¹¶ä¸”åœ¨è½¯ä»¶ä¸‹æ–¹å¼¹å‡ºä¿®æ”¹æ¡†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/257b6eb6d3a24fe3958a93295b0a2d3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=ZB89axi8zTbcGZdO4BELLznua3E%3D" alt="image-20240304140311742" loading="lazy"/></p>
<h3 data-id="heading-53">3.7 QTå¸®åŠ©æ–‡æ¡£</h3>
<p>Qt å¸®åŠ©æ–‡æ¡£å¤ªå¤šï¼Œéš¾ä»¥å…¨éƒ¨ç¿»è¯‘æˆä¸­æ–‡ï¼Œå³ä½¿ç¿»è¯‘äº†ä¸€éƒ¨åˆ†ï¼Œç¿»è¯‘èŠ±çš„æ—¶é—´å¤ªå¤šï¼Œç¿»è¯‘æ›´æ–°çš„æ—¶æ•ˆæ€§ä¹Ÿéš¾ä»¥ä¿è¯ï¼Œæœ€ç»ˆè¿˜æ˜¯å¾—çœ‹è‹±æ–‡å¸®åŠ©ï¼ŒQtCreator é›†æˆäº†å¸®åŠ©ç³»ç»Ÿï¼ŒæŸ¥æ‰¾éå¸¸æ–¹ä¾¿ã€‚</p>
<p>æ‰“å¼€QtCreatorï¼Œé€‰æ‹©èœå•æ çš„æœ€å·¦è¾¹çš„å¸®åŠ©é€‰é¡¹ï¼Œç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e206ccc87b504c52a976ef69d7061ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=iX29EMyPeyyiGrZqNPSJqsireoA%3D" alt="image-20240304140337833" loading="lazy"/></p>
<p>ï¼ˆ1ï¼‰æŸ¥çœ‹Qlabelæ§ä»¶çš„å¸®åŠ©ä¿¡æ¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b5057dbb1694be19e6ab07d25f6be5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=dTxGj39tuIvXSEOXVDF7pv3tbk4%3D" alt="image-20240304140357011" loading="lazy"/></p>
<h3 data-id="heading-54">3.8 UIè®¾è®¡å¸ˆä½¿ç”¨</h3>
<p>ä¸ŠèŠ‚çš„Hello QTç¨‹åºä½¿ç”¨çº¯C++ä»£ç ç¼–å†™ï¼Œè¿™ä¸€èŠ‚ä½¿ç”¨QTç•Œé¢è®¾è®¡æ¨¡å¼å®ç°ä¸ä¸Šä¸€èŠ‚<code>Hello QTç¨‹åº</code>ä¸€æ ·çš„åŠŸèƒ½ã€‚ä»¿ç…§ç€ä¸ŠèŠ‚æ–°åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ã€‚åŒå‡»æ‰“å¼€<code>mainwindow.ui</code>æ–‡ä»¶ï¼Œè¿›å…¥åˆ°UIè®¾è®¡ç•Œé¢ã€‚</p>
<p>ï¼ˆ1ï¼‰æ‹–ä¸€ä¸ªLabelæ§ä»¶åˆ°ç¼–è¾‘åŒºï¼ŒåŒå‡»Labelæ§ä»¶å¯ä»¥ä¿®æ”¹æ–‡æœ¬å†…å®¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db383ffaab0b4b93a65bda8e283489c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=qqZo29q0%2BfZIDvWRaF71%2BqP6caQ%3D" alt="image-20240304140517858" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰è¿è¡Œç¨‹åºå¯ä»¥ç‚¹å‡»å·¦ä¸‹è§’çš„ä¸‰è§’å½¢ç¬¦å·æˆ–è€…æŒ‰ä¸‹å¿«æ·é”®Ctrl+Rã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6b0ed4a33df49ce87bb957f47897d4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=ZheLEFl3z5MhlVcvQeOuXNXrKDI%3D" alt="image-20240304140600717" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰UIè®¾è®¡å¸ˆç•Œé¢åŠŸèƒ½ä»‹ç»</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7fa2ef9b3904859a350dd403519781d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=%2FjLD9OKJTwmtNjkNtGWcMBtL%2F18%3D" alt="image-20240304140615717" loading="lazy"/></p>
<h3 data-id="heading-55">3.9 æŒ‰é’®æ§ä»¶ç»„</h3>
<p>QT Creator UIè®¾è®¡å¸ˆç•Œé¢çš„æŒ‰é’®ç»„æˆªå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a9f14b2bbdd4d3993859d1e355f27a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=iG%2FyrkN8XYsiBseJsrxHONSx5SQ%3D" alt="image-20240304140809093" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯å¯¹æŒ‰é’®ç»„æ§ä»¶çš„ä¸€äº›åŠŸèƒ½ä»‹ç»ï¼š</p>
<p>ï¼ˆ1ï¼‰Push ButtonæŒ‰å‹æŒ‰é’®ï¼šæœ€æ™®é€šçš„æŒ‰é’®ï¼ŒæŒ‰(ç‚¹å‡»)æŒ‰é’®å‘½ä»¤è®¡ç®—æœºæ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œæˆ–è€…å›ç­”é—®é¢˜ï¼Œæ¯”å¦‚windowså¼€å§‹èœå•é‡Œçš„é‡å¯ï¼Œæ³¨é”€ï¼Œå…³æœºç­‰æŒ‰é’®ã€‚</p>
<p>ï¼ˆ2ï¼‰Tool Buttonå·¥å…·æŒ‰é’®ï¼šå·¥å…·æŒ‰é’®æ˜¯ä¸€ä¸ªé›†åˆï¼Œä¸€èˆ¬é›†æˆåœ¨å·¥å…·æ é‡Œã€‚æ¯”å¦‚æ‰“å¼€ï¼Œä¿å­˜ï¼Œå¤åˆ¶ï¼Œç²˜è´´ï¼Œå‰ªåˆ‡ç­‰å¸¸ç”¨çš„æ“ä½œã€‚</p>
<p>ï¼ˆ3ï¼‰Radio Buttonå•é€‰æŒ‰é’®ï¼šå•é€‰æŒ‰é’®æ˜¯ä¸¤ä¸ªä»¥ä¸Šçš„å½¢å¼å‡ºç°åœ¨ä¸€å—ï¼ŒæŒ‰é’®ä¹‹é—´æœ‰äº’æ–¥å…³ç³»ï¼Œæ¯æ¬¡åªèƒ½é€‰ä¸­ä¸€ä¸ªã€‚æ¯”å¦‚ï¼šä¸€ä¸ªäººçš„æ€§åˆ«åªèƒ½é€‰æ‹©ä¸€ä¸ªï¼Œä¸èƒ½åŒæ—¶æ˜¯ç”·æ€§åˆæ˜¯å¥³æ€§ã€‚</p>
<p>ï¼ˆ4ï¼‰Check Boxå¤é€‰æ¡†ï¼šå¤é€‰æ¡†ä¸å•é€‰æŒ‰é’®æ¦‚å¿µç›¸åï¼Œå¤é€‰æ¡†è¡¨ç¤ºå¤šä¸ªå¯ä»¥åŒæ—¶å­˜åœ¨çš„é€‰é¡¹ï¼Œæ¯”å¦‚ä¸€ä¸ªäººå¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªçˆ±å¥½ï¼Œæ¯”å¦‚è¯»ä¹¦ã€çœ‹ç”µå½±ã€çˆ¬å±±ã€æ¸¸æ³³ç­‰ã€‚</p>
<p>ï¼ˆ5ï¼‰Command Link Buttonå‘½ä»¤é“¾æ¥æŒ‰é’®ï¼šä¸€èˆ¬ç”¨æ¥æ‰“å¼€çš„çª—å£æˆ–è€…ç½‘é¡µé“¾æ¥ã€‚</p>
<p>ï¼ˆ6ï¼‰Dialog Button Boxæ ‡å‡†æŒ‰é’®ç›’ï¼šæ ‡å‡†æŒ‰é’®ç›’ç”¨äºå¯¹è¯æ¡†ç¨‹åºï¼›æ¯”å¦‚ï¼šå¸¸è§çš„ç¡®è®¤å¯¹è¯æ¡†æœ‰ â€œç¡®å®šâ€â€œå–æ¶ˆâ€ç­‰æ ‡å‡†æŒ‰é’®ï¼ŒQt å°†è¿™äº›å…¸å‹çš„æŒ‰é’®åšæˆæ ‡å‡†æŒ‰é’®ç›’ï¼Œå¹¶å°†ç›¸åº”çš„ä¿¡å·åŠ ä»¥å°è£…ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-56">3.10 å¸ƒå±€æ§ä»¶ç»„</h3>
<p>å¼€å‘ä¸€ä¸ªå›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åºï¼Œç•Œé¢çš„å¸ƒå±€å½±å“åˆ°ç•Œé¢çš„ç¾è§‚ã€‚å‰é¢çš„ç¨‹åºä¸­éƒ½æ˜¯ä½¿ç”¨UIç•Œé¢æ‹–æ§ä»¶ï¼Œå¦‚æœæœ‰å¤šä¸ªæŒ‰é’®ï¼Œä¼šå‡ºç°å¤§å°éš¾è°ƒæ•´ã€ä½ç½®éš¾å¯¹é½ç­‰é—®é¢˜ã€‚Qt æä¾›çš„â€œå¸ƒå±€ç®¡ç†â€œå°±å¾ˆå¥½çš„è§£å†³äº†æ§ä»¶æ‘†æ”¾çš„é—®é¢˜ã€‚</p>
<p>ä»¥ä¸‹æ˜¯UIè®¾è®¡å¸ˆç•Œé¢çš„å¸ƒå±€ç›¸å…³æ§ä»¶ç»„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89631e2c4bff4db4b4286922a496def8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=xyeGpOovOvgG8nBXDeBXp14l1OA%3D" alt="image-20240304140914361" loading="lazy"/></p>
<p><strong>åŠŸèƒ½ä»‹ç»ï¼š</strong></p>
<p>ï¼ˆ1ï¼‰Vertical Layoutï¼šå‚ç›´å¸ƒå±€</p>
<p>ï¼ˆ2ï¼‰Horizontal Layoutï¼šæ°´å¹³å¸ƒå±€</p>
<p>ï¼ˆ3ï¼‰Grid Layoutï¼šç½‘æ ¼å¸ƒå±€</p>
<p>ï¼ˆ4ï¼‰Form Layoutï¼šçª—ä½“ä¸­å¸ƒå±€</p>
<p>ï¼ˆ5ï¼‰Horizontal Spacersï¼šæ°´å¹³ç©ºæ ¼ï¼Œåœ¨å¸ƒå±€ä¸­ç”¨æ¥å ä½ã€‚</p>
<p>ï¼ˆ6ï¼‰Vertical Spacerï¼šå‚ç›´ç©ºæ ¼ï¼Œåœ¨å¸ƒå±€ä¸­ç”¨æ¥å ä½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/475f9b71f3ef49d1b25de6a2e0b12346~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=PLF%2FnQYYCQIba%2F4qfjabA%2FH0OTk%3D" alt="image-20240304140956243" loading="lazy"/></p>
<h3 data-id="heading-57">3.11 åŸºæœ¬å¸ƒå±€æ§ä»¶</h3>
<p>åœ¨UIè®¾è®¡ç•Œé¢æ·»åŠ ä¸€ä¸ªå¸ƒå±€æ§ä»¶ï¼Œç„¶åå°†éœ€è¦å¸ƒå±€çš„å…¶ä»–æ§ä»¶æ”¾å…¥å¸ƒå±€æ§ä»¶ä¸­å³å¯å®Œæˆå¸ƒå±€ï¼Œå¸ƒå±€æ§ä»¶å¯ä»¥äº’ç›¸åµŒå¥—ä½¿ç”¨ã€‚ï¼ˆæœ¬èŠ‚åªä»‹ç»åŸºæœ¬å¸ƒå±€æ§ä»¶çš„ä½¿ç”¨ï¼‰</p>
<p><strong>ä»¥ä¸‹æ˜¯4ç§å¸ƒå±€æ§ä»¶çš„æ•ˆæœï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aba84d7044e54b1baa2deb483323bbbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=GBIXrDCNJAABt0TQ9ZrIjLI1kcY%3D" alt="image-20240304141035428" loading="lazy"/></p>
<h3 data-id="heading-58">3.12 UIè®¾è®¡å¸ˆçš„å¸ƒå±€åŠŸèƒ½</h3>
<p>åœ¨UIè®¾è®¡ç•Œé¢çš„å·¦ä¸Šè§’æœ‰ä¸€æ’å¿«æ·çš„å¸ƒå±€é€‰é¡¹ï¼Œä½¿ç”¨æ—¶é€‰ä¸­ä¸¤ä¸ªä»¥ä¸Šçš„æ§ä»¶ï¼Œç‚¹å‡»å…¶ä¸­ä¸€ç§å¸ƒå±€æ–¹å¼å°±å¯ä»¥åˆ‡æ¢å¸ƒå±€ã€‚</p>
<p>ä»¥ä¸‹ä¸ºå¸ƒå±€çš„ç®€å•ç¤ºä¾‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4026b618e45f4672bdc0580e4ad3459f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=a6IvwcA4KonCvaskw1bGJ5aBtjM%3D" alt="image-20240304141115657" loading="lazy"/></p>
<p>ï¼ˆ1ï¼‰ä¸ºå¸ƒå±€çš„é€‰é¡¹ã€‚</p>
<p>ï¼ˆ2ï¼‰æ§ä»¶å±‚æ¬¡å›¾ï¼Œå¯ä»¥çœ‹åˆ°æ§ä»¶çš„å¸ƒå±€æ‘†æ”¾å±‚æ¬¡ã€‚</p>
<p>å¦‚æœæƒ³è¦æ§åˆ¶æŸä¸ªæ§ä»¶çš„å›ºå®šå¤§å°ï¼Œä¸éšç€å¸ƒå±€æ”¹å˜å¤§å°ï¼Œå¯ä»¥é™å®šæœ€å¤§æœ€å°å°ºå¯¸ã€‚é€‰ä¸­æ§ä»¶é¼ æ ‡å³é”®--&gt;å¤§å°é™å®š-&gt;è®¾ç½®å¤§å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c0f3f0b868d4cb7b62fdf11c764ac26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=pgvp9tIWwImDplJyMfJ%2By7a1eGQ%3D" alt="image-20240304141311256" loading="lazy"/></p>
<p><strong>æ°´å¹³å¸ƒå±€ä¸å‚ç›´å¸ƒå±€ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fac6c6f1d9734a75a789b7d795142e4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Ol%2BvOLpM2wdoUmQvK%2FPpTMggITQ%3D" alt="image-20240304141335977" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02127c0ed419463e828ccd7d5b73f1cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=5blCaPdcj%2FieClN4FQonLuxSQVI%3D" alt="image-20240304141347209" loading="lazy"/></p>
<p>æ°´å¹³å¸ƒå±€å°†æ§ä»¶æŒ‰ç…§æ°´å¹³æ–¹å¼æ‘†æ”¾ï¼Œå‚ç›´å¸ƒå±€å°†æ§ä»¶æŒ‰ç…§å‚ç›´æ–¹å¼æ‘†æ”¾ã€‚é¼ æ ‡æ‹–åŠ¨çº¢è‰²å¸ƒå±€æ¡†ä¸Šçš„é»‘è‰²æ–¹ç‚¹ï¼Œå¯ä»¥è°ƒæ•´å¸ƒå±€æ¡†çš„å¤§å°ã€‚éšç€å¸ƒå±€æ¡†çš„å°ºå¯¸å˜åŒ–ï¼ŒåŒ…å«çš„æ§ä»¶é«˜åº¦ä¸ä¼šå˜åŒ–ï¼Œå®½åº¦ä¼šéšç€å¸ƒå±€æ¡†å˜åŒ–ã€‚é€‰ä¸­å…¶ä¸­ä¸€ä¸ªæ§ä»¶ç„¶åé¼ æ ‡å³é”®&gt;ç‚¹å‡»å¤§å°é™å®šï¼Œå¯ä»¥é™å®šæ§ä»¶çš„æœ€å¤§å’Œæœ€å°å°ºå¯¸ã€‚</p>
<p><strong>åˆ†è£‚å™¨æ°´å¹³å¸ƒå±€ä¸å‚ç›´å¸ƒå±€ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32e29b498be2486aa831e840f358d874~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=MH63OXdJ57fox%2BdZreiLlIFEuRY%3D" alt="image-20240304141412287" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92e0d7042ce84cb486168298b6354efd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=37VMLECp0RFsxBib%2BaTiZtfrVTI%3D" alt="image-20240304141426088" loading="lazy"/></p>
<p>åˆ†è£‚å™¨æ–¹å¼å¸ƒå±€ï¼ŒåŒ…å«æ§ä»¶çš„é«˜åº¦å’Œå®½åº¦éƒ½ä¼šéšç€å¸ƒå±€æ¡†çš„æ‹‰ä¼¸è€Œæ”¹å˜ã€‚é€‰ä¸­å…¶ä¸­ä¸€ä¸ªæ§ä»¶ç„¶åé¼ æ ‡å³é”®&gt;ç‚¹å‡»å¤§å°é™å®šï¼Œå¯ä»¥é™å®šæ§ä»¶çš„æœ€å¤§å’Œæœ€å°å°ºå¯¸ã€‚</p>
<p><strong>çª—ä½“ä¸­å¸ƒå±€ä¸æ …æ ¼å¸ƒå±€ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c8dc789e7d2459b8eca3a0a413452f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=tG4SXFS5id6Mr6cve36qlplZP9g%3D" alt="image-20240304141449390" loading="lazy"/></p>
<p>æ …æ ¼ï¼ˆç½‘æ ¼ï¼‰å¸ƒå±€å™¨çš„åŸºæœ¬å•å…ƒæ˜¯å•å…ƒæ ¼ï¼Œè€Œçª—ä½“ä¸­å¸ƒå±€ï¼ˆè¡¨å•ï¼‰çš„åŸºæœ¬å•å…ƒæ˜¯è¡Œã€‚éšç€å¸ƒå±€æ¡†çš„å°ºå¯¸å˜åŒ–ï¼ŒåŒ…å«çš„æ§ä»¶é«˜åº¦ä¸ä¼šå˜åŒ–ï¼Œå®½åº¦ä¼šéšç€å¸ƒå±€æ¡†å˜åŒ–ã€‚</p>
<p><strong>è®¾ç½®ä¸»çª—ä½“å¸ƒå±€æ–¹å¼ï¼š</strong></p>
<p>è®¾ç½®ä¸»çª—ä½“çš„å¸ƒå±€æ–¹å¼åï¼ŒåŒ…å«åœ¨ä¸»çª—ä½“å†…çš„æ§ä»¶ä¼šéšç€çª—ä½“çš„æ‹‰ä¼¸è‡ªåŠ¨è°ƒæ•´å¤§å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b46dce499a7e4476bfe71edb3f57675a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=j6H4seKpLE3JeWHWxLMb%2Beq7FdY%3D" alt="image-20240304141518067" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ad30da169cb472283fbc8c940e95c77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=7RThh6BMwx504GGmha%2FLqwcjYMA%3D" alt="image-20240304141529003" loading="lazy"/></p>
<h2 data-id="heading-59">å››ã€ä¸Šä½æœºå¼€å‘</h2>
<p>å½“å‰é¡¹ç›®ä½¿ç”¨çš„ç›¸å…³è½¯ä»¶å·¥å…·ã€æ¨¡å—æºç å·²ç»ä¸Šä¼ åˆ°ç½‘ç›˜ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fccnr8sukk85n.feishu.cn%2Fwiki%2FQjY8weDYHibqRYkFP2qcA9aGnvb%3Ffrom%3Dfrom_copylink" target="_blank" title="https://ccnr8sukk85n.feishu.cn/wiki/QjY8weDYHibqRYkFP2qcA9aGnvb?from=from_copylink" ref="nofollow noopener noreferrer">ccnr8sukk85n.feishu.cn/wiki/QjY8weâ€¦</a></p>
<h3 data-id="heading-60">4.1 Qtå¼€å‘ç¯å¢ƒå®‰è£…</h3>
<p>Qtçš„ä¸­æ–‡å®˜ç½‘ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.qt.io%2Fzh-cn%2F!%255Bimage-20221207160550486%255D(https%3A%2F%2Fled-obs.obs.cn-north-1.myhuaweicloud.com%2FBlog%2Fimg%2Fimage-20221207160550486.png)" target="_blank" title="https://www.qt.io/zh-cn/!%5Bimage-20221207160550486%5D(https://led-obs.obs.cn-north-1.myhuaweicloud.com/Blog/img/image-20221207160550486.png)" ref="nofollow noopener noreferrer">www.qt.io/zh-cn/![imaâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efe081cf84ef4352b544edc732a114b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=E9H4FZjiuLgrwIv4rqu3rl5lDZE%3D" alt="image-20221207160606892" loading="lazy"/></p>
<p>QT5.12.6çš„ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdownload.qt.io%2Farchive%2Fqt%2F5.12%2F5.12.6" target="_blank" title="https://download.qt.io/archive/qt/5.12/5.12.6" ref="nofollow noopener noreferrer">download.qt.io/archive/qt/â€¦</a></p>
<p><strong>æ‰“å¼€ä¸‹è½½é“¾æ¥åé€‰æ‹©ä¸‹é¢çš„ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e09c8bfafbf04bf8a1701fb6911108ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Z3sEaVnnWldBYgJ3SG%2BoZuHc99k%3D" alt="" loading="lazy"/></p>
<p><strong>å¦‚æœä¸‹è½½ä¸äº†ï¼Œå¯ä»¥åœ¨ç½‘ç›˜é‡Œæ‰¾åˆ°å®‰è£…åŒ…ä¸‹è½½ï¼š</strong>    é£ä¹¦æ–‡æ¡£è®°å½•çš„ç½‘ç›˜åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fccnr8sukk85n.feishu.cn%2Fwiki%2FQjY8weDYHibqRYkFP2qcA9aGnvb%3Ffrom%3Dfrom_copylink" target="_blank" title="https://ccnr8sukk85n.feishu.cn/wiki/QjY8weDYHibqRYkFP2qcA9aGnvb?from=from_copylink" ref="nofollow noopener noreferrer">ccnr8sukk85n.feishu.cn/wiki/QjY8weâ€¦</a></p>
<p>è½¯ä»¶å®‰è£…æ—¶æ–­ç½‘å®‰è£…ï¼Œå¦åˆ™ä¼šæç¤ºè¾“å…¥è´¦æˆ·ã€‚</p>
<p>å®‰è£…çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå¤é€‰æ¡†é‡Œçš„ç¼–è¯‘å™¨å¯ä»¥å…¨é€‰ï¼Œç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ç»§ç»­å®‰è£…ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4a6adb7af5742d6936a6f3ff605e390~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Lk8aAAze%2Fgp9%2Bt8y8VotdU2bsss%3D" alt="image-20221203151742653" loading="lazy"/></p>
<p><strong>é€‰æ‹©ç¼–è¯‘å™¨ï¼š ï¼ˆä¸€å®šè¦çœ‹æ¸…æ¥šäº†ï¼‰</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e09e9021ec534fd792e01d8e443f856f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=aIdMc1WGjlV%2BU%2FzIeGfQ%2B3%2B%2FaIA%3D" alt="image-20241028152725134" loading="lazy"/></p>
<h3 data-id="heading-61">4.2 æ–°å»ºä¸Šä½æœºå·¥ç¨‹</h3>
<p>å‰é¢2è®²è§£äº†éœ€è¦ç”¨çš„APIæ¥å£ï¼Œæ¥ä¸‹æ¥å°±ä½¿ç”¨Qtè®¾è®¡ä¸Šä½æœºï¼Œè®¾è®¡ç•Œé¢ï¼Œå®Œæˆæ•´ä½“ä¸Šä½æœºçš„é€»è¾‘è®¾è®¡ã€‚</p>
<p>ã€1ã€‘æ–°å»ºå·¥ç¨‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87ec690405eb4da9a8d9c042a011de15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=UYAvdNFLCxzjiu7DgFJ1%2FMsf9eI%3D" alt="image-20240117144052547" loading="lazy"/></p>
<p>ã€2ã€‘è®¾ç½®é¡¹ç›®çš„åç§°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac5345c4eb514b93927a55da0b7d5cb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=pfgmK1vzkILs8rULSujrSFDTsLs%3D" alt="image-20250420200347498" loading="lazy"/></p>
<p>ã€3ã€‘é€‰æ‹©ç¼–è¯‘ç³»ç»Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64428c6047f44c348349eae7d139a7df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=pzg766wHBJbAbvei6NgfMSoCsZQ%3D" alt="image-20240117144239681" loading="lazy"/></p>
<p>ã€4ã€‘é€‰æ‹©é»˜è®¤ç»§æ‰¿çš„ç±»</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/214a2aa185524b4ea9b3bc58a1e2be46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=3tiGjWOKfHCcIMaPOXFQdNJU8A8%3D" alt="image-20240117144302275" loading="lazy"/></p>
<p>ã€5ã€‘é€‰æ‹©ç¼–è¯‘å™¨</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cf96330cfd64a45a71f68121376e0cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=cE%2F%2FpizIozA0my202dm60P%2Fv9Ow%3D" alt="image-20241028153603487" loading="lazy"/></p>
<p>ã€6ã€‘ç‚¹å‡»å®Œæˆ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1237dfea39d4a0eaeaa4cbeacf367a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=enV8ue7G3ChfTNmOsGfYfS3UllQ%3D" alt="image-20240117144354252" loading="lazy"/></p>
<p>ã€7ã€‘å·¥ç¨‹åˆ›å»ºå®Œæˆ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1a22eec2947487ab503c8f2f235c4a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=MwhHDqDEbkV%2FgDKiDlxYxNZUNIg%3D" alt="image-20250420200411303" loading="lazy"/></p>
<h3 data-id="heading-62">4.3 åˆ‡æ¢ç¼–è¯‘å™¨</h3>
<p>åœ¨å·¦ä¸‹è§’æ˜¯å¯ä»¥åˆ‡æ¢ç¼–è¯‘å™¨çš„ã€‚ å¯ä»¥é€‰æ‹©ç”¨ä»€ä¹ˆæ ·çš„ç¼–è¯‘å™¨ç¼–è¯‘ç¨‹åºã€‚</p>
<p>ç›®å‰æ–°å»ºå·¥ç¨‹çš„æ—¶å€™é€‰æ‹©äº†2ç§ç¼–è¯‘å™¨ã€‚ ä¸€ç§æ˜¯<code>mingw32</code>è¿™ä¸ªç¼–è¯‘Windowsä¸‹è¿è¡Œçš„ç¨‹åºã€‚ ä¸€ç§æ˜¯<code>Android</code>ç¼–è¯‘å™¨ï¼Œå¯ä»¥ç”Ÿæˆ<code>Android</code>æ‰‹æœºAPPã€‚</p>
<p><code>ä¸è¿‡è¦æ³¨æ„ï¼šAndroidçš„ç¼–è¯‘å™¨éœ€è¦é…ç½®ä¸€äº›ç¯å¢ƒæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè¿™ä¸ªå¤§å®¶å¯ä»¥ç½‘ä¸Šæ‰¾æ‰¾æ•™ç¨‹é…ç½®ä¸€ä¸‹å°±è¡Œäº†ã€‚</code></p>
<p>windowsçš„ç¼–è¯‘å™¨å°±æ²¡æœ‰è¿™ä¹ˆéº»çƒ¦ï¼Œå®‰è£…å¥½Qtå°±å¯ä»¥ç¼–è¯‘ä½¿ç”¨ã€‚</p>
<p>ä¸‹é¢æˆ‘è¿™é‡Œå°±é€‰æ‹©çš„ <code>mingw32</code>è¿™ä¸ªç¼–è¯‘å™¨ï¼Œç¼–è¯‘Windowsä¸‹è¿è¡Œçš„ç¨‹åºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/014b8da88b874ac7931467cfcecfb868~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=LAfnvqNnGVJUl5No2YwaI8Umlpo%3D" alt="image-20250420200424965" loading="lazy"/></p>
<h3 data-id="heading-63">4.4 ç¼–è¯‘æµ‹è¯•åŠŸèƒ½</h3>
<p>åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œç¼–è¯‘æµ‹è¯•ä¸€ä¸‹åŠŸèƒ½æ˜¯å¦OKã€‚</p>
<p>ç‚¹å‡»å·¦ä¸‹è§’çš„<code>ç»¿è‰²ä¸‰è§’å½¢æŒ‰é’®</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f15a3c3c47704896baa148320a9ac299~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=WOer2S2RXtdhfz%2B%2B3RaOMipzUCo%3D" alt="image-20250420200442769" loading="lazy"/></p>
<p>æ­£å¸¸è¿è¡Œå°±å¯ä»¥çœ‹åˆ°å¼¹å‡ºä¸€ä¸ªç™½è‰²çš„æ¡†æ¡†ã€‚è¿™å°±è¡¨ç¤ºå·¥ç¨‹ç¯å¢ƒæ²¡æœ‰é—®é¢˜äº†ã€‚ æ¥ä¸‹æ¥å°±å¯ä»¥æ”¾å¿ƒçš„è®¾è®¡ç•Œé¢äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a22a20938bae449f96c04077ff18b298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=M48pdmITha0rWlPOuPPkHMrlaD0%3D" alt="image-20250420200457319" loading="lazy"/></p>
<h3 data-id="heading-64">4.5 è®¾è®¡UIç•Œé¢ä¸å·¥ç¨‹é…ç½®</h3>
<h4 data-id="heading-65">ã€1ã€‘æ‰“å¼€UIæ–‡ä»¶</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18e4e44f35614e5197e6784cf4797b87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=HTI99axoLMS6wJJfhB6C7ivMppQ%3D" alt="image-20250420200514220" loading="lazy"/></p>
<p><strong>æ‰“å¼€é»˜è®¤çš„ç•Œé¢å¦‚ä¸‹ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/627274d7d20c476d80999704f374dc0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=LesQdPSjly3p0uT%2BUMLX%2BpuqPac%3D" alt="image-20250420200526194" loading="lazy"/></p>
<h4 data-id="heading-66">ã€2ã€‘å¼€å§‹è®¾è®¡ç•Œé¢</h4>
<p>æ ¹æ®è‡ªå·±éœ€æ±‚è®¾è®¡ç•Œé¢ã€‚</p>
<h3 data-id="heading-67">4.6 è®¾è®¡ä»£ç </h3>
<h4 data-id="heading-68">è®¾è®¡è¯´æ˜</h4>
<ol>
<li><strong>çº¯ä»£ç æ„å»º UI</strong>ï¼šä¸ä¾èµ– <code>.ui</code> æ–‡ä»¶ï¼Œåªéœ€è¦æŠŠ <code>.h</code> å’Œ <code>.cpp</code> æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®ä¸­å³å¯ï¼Œæ— éœ€é…ç½® UI è®¾è®¡å™¨ã€‚</li>
<li><strong>MQTT é€šä¿¡</strong>ï¼šç”±äº Qt å®˜æ–¹çš„ <code>QtMqtt</code> æ¨¡å—åœ¨æ ‡å‡†å®‰è£…åŒ…ä¸­ä¸åŒ…å«ï¼ˆéœ€è¦è‡ªè¡Œç¼–è¯‘ï¼‰ï¼Œä¸ºäº†ä¿è¯å…¼å®¹æ€§å’Œé™ä½é—¨æ§›ï¼Œ<strong>æœ¬ä»£ç ç¤ºä¾‹å‡è®¾å·²ç»é…ç½®å¥½äº† QtMqtt ç¯å¢ƒ</strong>ã€‚
<ul>
<li><em>å¦‚æœçš„ Qt ç¯å¢ƒæ²¡æœ‰ Mqtt æ¨¡å—ï¼Œéœ€è¦å…ˆç¼–è¯‘å®‰è£… <code>QtMqtt</code>ï¼Œæˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ QMQTTï¼‰ã€‚</em></li>
</ul>
</li>
<li><strong>æ•°æ®åè®®</strong>ï¼šé‡‡ç”¨æ ‡å‡†çš„ JSON æ ¼å¼ä¸ STM32 é€šä¿¡ã€‚</li>
<li><strong>åŠŸèƒ½è¦†ç›–</strong>ï¼šåŒ…å«äº†è¿æ¥äº‘å¹³å°ã€å®æ—¶æ•°æ®æ˜¾ç¤ºï¼ˆæ¸©æ¹¿åº¦ã€é‡é‡ã€å…‰ç…§ç­‰ï¼‰ã€é˜ˆå€¼ä¸‹å‘è®¾ç½®ã€æ—¥å¿—æ˜¾ç¤ºã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-69">1. é¡¹ç›®é…ç½®æ–‡ä»¶ (BeehiveMonitor.pro)</h4>
<p>åœ¨ <code>.pro</code> æ–‡ä»¶ä¸­ï¼Œå¿…é¡»æ·»åŠ  <code>mqtt</code> æ¨¡å—ï¼ˆå¦‚æœä½¿ç”¨çš„æ˜¯å®˜æ–¹æ¨¡å—ï¼‰ã€‚</p>
<pre><code class="hljs language-pro" lang="pro">QT       += core gui network mqtt

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

CONFIG += c++11

# You can rename the target as you like
TARGET = BeehiveMonitor
TEMPLATE = app

SOURCES += \
    main.cpp \
    mainwindow.cpp

HEADERS += \
    mainwindow.h
</code></pre>
<hr/>
<h4 data-id="heading-70">2. å¤´æ–‡ä»¶ (mainwindow.h)</h4>
<p>å®šä¹‰äº†ç•Œé¢å…ƒç´ å’Œä¸šåŠ¡é€»è¾‘ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MAINWINDOW_H</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> MAINWINDOW_H</span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QMainWindow&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QMqttClient&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QLabel&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QLineEdit&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QPushButton&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QTextEdit&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QGroupBox&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QGridLayout&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QSpinBox&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QJsonDocument&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QJsonObject&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QDateTime&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainWindow</span> : <span class="hljs-keyword">public</span> QMainWindow
{
    Q_OBJECT

<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">MainWindow</span>(QWidget *parent = <span class="hljs-literal">nullptr</span>);
    ~<span class="hljs-built_in">MainWindow</span>();

<span class="hljs-keyword">private</span> slots:
    <span class="hljs-comment">// MQTT Slots</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">onConnectClicked</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">onSubscribeClicked</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">onPublishThresholdClicked</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">updateLogStateChange</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">brokerDisconnected</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">onMessageReceived</span><span class="hljs-params">(<span class="hljs-type">const</span> QByteArray &amp;message, <span class="hljs-type">const</span> QMqttTopicName &amp;topic)</span></span>;

<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// --- UI åˆå§‹åŒ–å‡½æ•° ---</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">initUI</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setupMqtt</span><span class="hljs-params">()</span></span>;

    <span class="hljs-comment">// --- MQTT å®¢æˆ·ç«¯ ---</span>
    QMqttClient *m_client;

    <span class="hljs-comment">// --- UI æ§ä»¶ ---</span>
    <span class="hljs-comment">// 1. è¿æ¥è®¾ç½®åŒºåŸŸ</span>
    QLineEdit *le_host;
    QLineEdit *le_port;
    QLineEdit *le_clientId;
    QLineEdit *le_username;
    QLineEdit *le_password;
    QLineEdit *le_sub_topic; <span class="hljs-comment">// è®¢é˜…ä¸»é¢˜ï¼ˆæ¥æ”¶æ•°æ®ï¼‰</span>
    QLineEdit *le_pub_topic; <span class="hljs-comment">// å‘å¸ƒä¸»é¢˜ï¼ˆä¸‹å‘å‘½ä»¤ï¼‰</span>
    QPushButton *btn_connect;
    QPushButton *btn_subscribe;

    <span class="hljs-comment">// 2. å®æ—¶æ•°æ®é€šè¿‡ Label æ˜¾ç¤º</span>
    QLabel *lbl_temp_in;
    QLabel *lbl_humi_in;
    QLabel *lbl_temp_out;
    QLabel *lbl_humi_out;
    QLabel *lbl_weight;
    QLabel *lbl_sound;
    QLabel *lbl_light;
    QLabel *lbl_vibration; <span class="hljs-comment">// çŠ¶æ€ï¼šæ­£å¸¸/å¼‚å¸¸</span>

    <span class="hljs-comment">// 3. é˜ˆå€¼è®¾ç½®</span>
    QSpinBox *sb_temp_max;
    QSpinBox *sb_humi_max;
    QDoubleSpinBox *sb_weight_min; <span class="hljs-comment">// æ¯”å¦‚å¤±é‡æŠ¥è­¦</span>
    QSpinBox *sb_sound_max;
    QPushButton *btn_set_threshold;

    <span class="hljs-comment">// 4. æ—¥å¿—åŒºåŸŸ</span>
    QTextEdit *txt_log;

    <span class="hljs-comment">// --- è¾…åŠ©å‡½æ•° ---</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-type">const</span> QString &amp;msg)</span></span>;
};

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MAINWINDOW_H</span></span>
</code></pre>
<hr/>
<h4 data-id="heading-71">3. æºæ–‡ä»¶ (mainwindow.cpp)</h4>
<p>å®ç°äº†æ ¸å¿ƒé€»è¾‘ï¼šè§£æ JSONã€æ›´æ–° UIã€å‘é€ MQTT æŒ‡ä»¤ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"mainwindow.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QVBoxLayout&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QMessageBox&gt;</span></span>

MainWindow::<span class="hljs-built_in">MainWindow</span>(QWidget *parent)
    : <span class="hljs-built_in">QMainWindow</span>(parent)
{
    <span class="hljs-built_in">initUI</span>();
    <span class="hljs-built_in">setupMqtt</span>();
}

MainWindow::~<span class="hljs-built_in">MainWindow</span>()
{
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::initUI</span><span class="hljs-params">()</span>
</span>{
    QWidget *centralWidget = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QWidget</span>(<span class="hljs-keyword">this</span>);
    <span class="hljs-built_in">setCentralWidget</span>(centralWidget);
    QVBoxLayout *mainLayout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QVBoxLayout</span>(centralWidget);

    <span class="hljs-comment">// === 1. è¿æ¥é…ç½®åŒºåŸŸ ===</span>
    QGroupBox *grpSettings = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QGroupBox</span>(<span class="hljs-string">"åä¸ºäº‘ MQTT è¿æ¥é…ç½®"</span>, <span class="hljs-keyword">this</span>);
    QGridLayout *layoutSettings = <span class="hljs-keyword">new</span> QGridLayout;

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"æœåŠ¡å™¨åœ°å€:"</span>), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    le_host = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-string">"iot-mqtts.cn-north-4.myhuaweicloud.com"</span>); <span class="hljs-comment">// ç¤ºä¾‹åœ°å€</span>
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_host, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"ç«¯å£:"</span>), <span class="hljs-number">0</span>, <span class="hljs-number">2</span>);
    le_port = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-string">"1883"</span>);
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_port, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"Client ID:"</span>), <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
    le_clientId = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-string">"Beehive_PC_Client"</span>);
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_clientId, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"ç”¨æˆ·å:"</span>), <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
    le_username = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>();
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_username, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å¯†ç :"</span>), <span class="hljs-number">2</span>, <span class="hljs-number">0</span>);
    le_password = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>();
    le_password-&gt;<span class="hljs-built_in">setEchoMode</span>(QLineEdit::Password);
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_password, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>);

    btn_connect = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-string">"è¿æ¥æœåŠ¡å™¨"</span>);
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(btn_connect, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"è®¢é˜…Topic (æ¥æ”¶):"</span>), <span class="hljs-number">3</span>, <span class="hljs-number">0</span>);
    le_sub_topic = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-string">"/beehive/data"</span>); <span class="hljs-comment">// éœ€æ ¹æ®åä¸ºäº‘è§„åˆ™ä¿®æ”¹</span>
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_sub_topic, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
    
    btn_subscribe = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-string">"è®¢é˜…"</span>);
    btn_subscribe-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">false</span>);
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(btn_subscribe, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>);

    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å‘å¸ƒTopic (å‘½ä»¤):"</span>), <span class="hljs-number">4</span>, <span class="hljs-number">0</span>);
    le_pub_topic = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-string">"/beehive/cmd"</span>); <span class="hljs-comment">// éœ€æ ¹æ®åä¸ºäº‘è§„åˆ™ä¿®æ”¹</span>
    layoutSettings-&gt;<span class="hljs-built_in">addWidget</span>(le_pub_topic, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>);

    grpSettings-&gt;<span class="hljs-built_in">setLayout</span>(layoutSettings);
    mainLayout-&gt;<span class="hljs-built_in">addWidget</span>(grpSettings);

    <span class="hljs-comment">// === 2. å®æ—¶ç›‘æ§é¢æ¿ ===</span>
    QGroupBox *grpData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QGroupBox</span>(<span class="hljs-string">"èœ‚ç®±å®æ—¶ç›‘æµ‹æ•°æ®"</span>, <span class="hljs-keyword">this</span>);
    QGridLayout *layoutData = <span class="hljs-keyword">new</span> QGridLayout;

    <span class="hljs-comment">// æ ·å¼è®¾ç½®</span>
    QString labelStyle = <span class="hljs-string">"QLabel { font-size: 18px; font-weight: bold; color: #2E8B57; }"</span>;
    
    <span class="hljs-comment">// åˆå§‹åŒ– Label</span>
    lbl_temp_in = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0.0 â„ƒ"</span>); lbl_temp_in-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_humi_in = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0.0 %"</span>); lbl_humi_in-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_temp_out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0.0 â„ƒ"</span>); lbl_temp_out-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_humi_out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0.0 %"</span>); lbl_humi_out-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_weight = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0.00 kg"</span>); lbl_weight-&gt;<span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">"QLabel { font-size: 18px; font-weight: bold; color: blue; }"</span>);
    lbl_sound = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0 dB"</span>); lbl_sound-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_light = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"0 Lx"</span>); lbl_light-&gt;<span class="hljs-built_in">setStyleSheet</span>(labelStyle);
    lbl_vibration = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"æ­£å¸¸"</span>); lbl_vibration-&gt;<span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">"QLabel { font-size: 18px; font-weight: bold; color: green; }"</span>);

    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å†…éƒ¨æ¸©åº¦:"</span>), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_temp_in, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å†…éƒ¨æ¹¿åº¦:"</span>), <span class="hljs-number">0</span>, <span class="hljs-number">2</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_humi_in, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>);
    
    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å¤–éƒ¨æ¸©åº¦:"</span>), <span class="hljs-number">1</span>, <span class="hljs-number">0</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_temp_out, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å¤–éƒ¨æ¹¿åº¦:"</span>), <span class="hljs-number">1</span>, <span class="hljs-number">2</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_humi_out, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>);

    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"èœ‚ç®±é‡é‡:"</span>), <span class="hljs-number">2</span>, <span class="hljs-number">0</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_weight, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>);
    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å…‰ç…§å¼ºåº¦:"</span>), <span class="hljs-number">2</span>, <span class="hljs-number">2</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_light, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);

    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å£°éŸ³å¼ºåº¦:"</span>), <span class="hljs-number">3</span>, <span class="hljs-number">0</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_sound, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>);
    layoutData-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"éœ‡åŠ¨çŠ¶æ€:"</span>), <span class="hljs-number">3</span>, <span class="hljs-number">2</span>); layoutData-&gt;<span class="hljs-built_in">addWidget</span>(lbl_vibration, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>);

    grpData-&gt;<span class="hljs-built_in">setLayout</span>(layoutData);
    mainLayout-&gt;<span class="hljs-built_in">addWidget</span>(grpData);

    <span class="hljs-comment">// === 3. é˜ˆå€¼è®¾ç½®é¢æ¿ ===</span>
    QGroupBox *grpControl = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QGroupBox</span>(<span class="hljs-string">"æŠ¥è­¦é˜ˆå€¼é…ç½®"</span>, <span class="hljs-keyword">this</span>);
    QHBoxLayout *layoutControl = <span class="hljs-keyword">new</span> QHBoxLayout;

    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"æœ€é«˜æ¸©åº¦:"</span>));
    sb_temp_max = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QSpinBox</span>(); sb_temp_max-&gt;<span class="hljs-built_in">setRange</span>(<span class="hljs-number">0</span>, <span class="hljs-number">60</span>); sb_temp_max-&gt;<span class="hljs-built_in">setValue</span>(<span class="hljs-number">38</span>);
    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(sb_temp_max);

    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"æœ€å°é‡é‡(kg):"</span>));
    sb_weight_min = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QDoubleSpinBox</span>(); sb_weight_min-&gt;<span class="hljs-built_in">setRange</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>); sb_weight_min-&gt;<span class="hljs-built_in">setValue</span>(<span class="hljs-number">5.0</span>);
    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(sb_weight_min);

    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-string">"å£°éŸ³é˜ˆå€¼(dB):"</span>));
    sb_sound_max = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QSpinBox</span>(); sb_sound_max-&gt;<span class="hljs-built_in">setRange</span>(<span class="hljs-number">0</span>, <span class="hljs-number">120</span>); sb_sound_max-&gt;<span class="hljs-built_in">setValue</span>(<span class="hljs-number">80</span>);
    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(sb_sound_max);

    btn_set_threshold = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-string">"ä¸‹å‘é…ç½®"</span>);
    btn_set_threshold-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">false</span>);
    layoutControl-&gt;<span class="hljs-built_in">addWidget</span>(btn_set_threshold);

    grpControl-&gt;<span class="hljs-built_in">setLayout</span>(layoutControl);
    mainLayout-&gt;<span class="hljs-built_in">addWidget</span>(grpControl);

    <span class="hljs-comment">// === 4. æ—¥å¿—æ˜¾ç¤º ===</span>
    txt_log = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QTextEdit</span>();
    txt_log-&gt;<span class="hljs-built_in">setReadOnly</span>(<span class="hljs-literal">true</span>);
    txt_log-&gt;<span class="hljs-built_in">setMaximumHeight</span>(<span class="hljs-number">150</span>);
    mainLayout-&gt;<span class="hljs-built_in">addWidget</span>(txt_log);

    <span class="hljs-comment">// ä¿¡å·è¿æ¥</span>
    <span class="hljs-built_in">connect</span>(btn_connect, &amp;QPushButton::clicked, <span class="hljs-keyword">this</span>, &amp;MainWindow::onConnectClicked);
    <span class="hljs-built_in">connect</span>(btn_subscribe, &amp;QPushButton::clicked, <span class="hljs-keyword">this</span>, &amp;MainWindow::onSubscribeClicked);
    <span class="hljs-built_in">connect</span>(btn_set_threshold, &amp;QPushButton::clicked, <span class="hljs-keyword">this</span>, &amp;MainWindow::onPublishThresholdClicked);

    <span class="hljs-built_in">setWindowTitle</span>(<span class="hljs-string">"æ™ºèƒ½èœ‚ç®±ç›‘æµ‹ç³»ç»Ÿ - ä¸Šä½æœº"</span>);
    <span class="hljs-built_in">resize</span>(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::setupMqtt</span><span class="hljs-params">()</span>
</span>{
    m_client = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QMqttClient</span>(<span class="hljs-keyword">this</span>);
    
    <span class="hljs-comment">// çŠ¶æ€æ”¹å˜ä¿¡å·</span>
    <span class="hljs-built_in">connect</span>(m_client, &amp;QMqttClient::stateChanged, <span class="hljs-keyword">this</span>, &amp;MainWindow::updateLogStateChange);
    <span class="hljs-built_in">connect</span>(m_client, &amp;QMqttClient::disconnected, <span class="hljs-keyword">this</span>, &amp;MainWindow::brokerDisconnected);

    <span class="hljs-comment">// æ”¶åˆ°æ¶ˆæ¯ä¿¡å·</span>
    <span class="hljs-built_in">connect</span>(m_client, &amp;QMqttClient::messageReceived, <span class="hljs-keyword">this</span>, &amp;MainWindow::onMessageReceived);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::onConnectClicked</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (m_client-&gt;<span class="hljs-built_in">state</span>() == QMqttClient::Disconnected) {
        m_client-&gt;<span class="hljs-built_in">setHostname</span>(le_host-&gt;<span class="hljs-built_in">text</span>());
        m_client-&gt;<span class="hljs-built_in">setPort</span>(le_port-&gt;<span class="hljs-built_in">text</span>().<span class="hljs-built_in">toInt</span>());
        m_client-&gt;<span class="hljs-built_in">setClientId</span>(le_clientId-&gt;<span class="hljs-built_in">text</span>());
        m_client-&gt;<span class="hljs-built_in">setUsername</span>(le_username-&gt;<span class="hljs-built_in">text</span>());
        m_client-&gt;<span class="hljs-built_in">setPassword</span>(le_password-&gt;<span class="hljs-built_in">text</span>());

        m_client-&gt;<span class="hljs-built_in">connectToHost</span>();
    } <span class="hljs-keyword">else</span> {
        m_client-&gt;<span class="hljs-built_in">disconnectFromHost</span>();
    }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::updateLogStateChange</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-type">const</span> QString content = QDateTime::<span class="hljs-built_in">currentDateTime</span>().<span class="hljs-built_in">toString</span>() + <span class="hljs-string">": State Change -&gt; "</span> + QString::<span class="hljs-built_in">number</span>(m_client-&gt;<span class="hljs-built_in">state</span>());
    <span class="hljs-built_in">log</span>(content);

    <span class="hljs-keyword">if</span> (m_client-&gt;<span class="hljs-built_in">state</span>() == QMqttClient::Connected) {
        btn_connect-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">"æ–­å¼€è¿æ¥"</span>);
        btn_subscribe-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">true</span>);
        btn_set_threshold-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">true</span>);
        <span class="hljs-built_in">log</span>(<span class="hljs-string">"æˆåŠŸè¿æ¥è‡³åä¸ºäº‘æœåŠ¡å™¨ï¼"</span>);
    } <span class="hljs-keyword">else</span> {
        btn_connect-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">"è¿æ¥æœåŠ¡å™¨"</span>);
        btn_subscribe-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">false</span>);
        btn_set_threshold-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">false</span>);
    }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::brokerDisconnected</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">log</span>(<span class="hljs-string">"å·²æ–­å¼€è¿æ¥"</span>);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::onSubscribeClicked</span><span class="hljs-params">()</span>
</span>{
    QString topic = le_sub_topic-&gt;<span class="hljs-built_in">text</span>();
    <span class="hljs-keyword">auto</span> subscription = m_client-&gt;<span class="hljs-built_in">subscribe</span>(topic);
    <span class="hljs-keyword">if</span> (!subscription) {
        <span class="hljs-built_in">log</span>(<span class="hljs-string">"è®¢é˜…å¤±è´¥: "</span> + topic);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-built_in">log</span>(<span class="hljs-string">"æˆåŠŸè®¢é˜…ä¸»é¢˜: "</span> + topic);
}

<span class="hljs-comment">// *** æ ¸å¿ƒï¼šå¤„ç†æ¥æ”¶åˆ°çš„ JSON æ•°æ® ***</span>
<span class="hljs-comment">// å‡è®¾ STM32 å‘é€çš„ JSON æ ¼å¼å¦‚ä¸‹ï¼š</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//    "temp_in": 28.5, "humi_in": 60,</span>
<span class="hljs-comment">//    "temp_out": 22.0, "humi_out": 45,</span>
<span class="hljs-comment">//    "weight": 10.5, "light": 1500,</span>
<span class="hljs-comment">//    "sound": 40, "vib": 0</span>
<span class="hljs-comment">// }</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::onMessageReceived</span><span class="hljs-params">(<span class="hljs-type">const</span> QByteArray &amp;message, <span class="hljs-type">const</span> QMqttTopicName &amp;topic)</span>
</span>{
    <span class="hljs-built_in">log</span>(<span class="hljs-string">"æ”¶åˆ°æ•°æ® ["</span> + topic.<span class="hljs-built_in">name</span>() + <span class="hljs-string">"]: "</span> + message);

    QJsonDocument doc = QJsonDocument::<span class="hljs-built_in">fromJson</span>(message);
    <span class="hljs-keyword">if</span> (doc.<span class="hljs-built_in">isNull</span>() || !doc.<span class="hljs-built_in">isObject</span>()) {
        <span class="hljs-built_in">log</span>(<span class="hljs-string">"JSON è§£æå¤±è´¥"</span>);
        <span class="hljs-keyword">return</span>;
    }

    QJsonObject obj = doc.<span class="hljs-built_in">object</span>();

    <span class="hljs-comment">// æ›´æ–°å†…éƒ¨æ¸©æ¹¿åº¦</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"temp_in"</span>)) lbl_temp_in-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"temp_in"</span>].<span class="hljs-built_in">toDouble</span>(), <span class="hljs-string">'f'</span>, <span class="hljs-number">1</span>) + <span class="hljs-string">" â„ƒ"</span>);
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"humi_in"</span>)) lbl_humi_in-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"humi_in"</span>].<span class="hljs-built_in">toDouble</span>(), <span class="hljs-string">'f'</span>, <span class="hljs-number">1</span>) + <span class="hljs-string">" %"</span>);

    <span class="hljs-comment">// æ›´æ–°å¤–éƒ¨æ¸©æ¹¿åº¦</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"temp_out"</span>)) lbl_temp_out-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"temp_out"</span>].<span class="hljs-built_in">toDouble</span>(), <span class="hljs-string">'f'</span>, <span class="hljs-number">1</span>) + <span class="hljs-string">" â„ƒ"</span>);
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"humi_out"</span>)) lbl_humi_out-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"humi_out"</span>].<span class="hljs-built_in">toDouble</span>(), <span class="hljs-string">'f'</span>, <span class="hljs-number">1</span>) + <span class="hljs-string">" %"</span>);

    <span class="hljs-comment">// æ›´æ–°é‡é‡</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"weight"</span>)) lbl_weight-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"weight"</span>].<span class="hljs-built_in">toDouble</span>(), <span class="hljs-string">'f'</span>, <span class="hljs-number">2</span>) + <span class="hljs-string">" kg"</span>);

    <span class="hljs-comment">// æ›´æ–°å…‰ç…§</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"light"</span>)) lbl_light-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"light"</span>].<span class="hljs-built_in">toInt</span>()) + <span class="hljs-string">" Lx"</span>);

    <span class="hljs-comment">// æ›´æ–°å£°éŸ³</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"sound"</span>)) lbl_sound-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(obj[<span class="hljs-string">"sound"</span>].<span class="hljs-built_in">toInt</span>()) + <span class="hljs-string">" dB"</span>);

    <span class="hljs-comment">// æ›´æ–°éœ‡åŠ¨çŠ¶æ€</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">contains</span>(<span class="hljs-string">"vib"</span>)) {
        <span class="hljs-type">int</span> vib = obj[<span class="hljs-string">"vib"</span>].<span class="hljs-built_in">toInt</span>();
        <span class="hljs-keyword">if</span> (vib == <span class="hljs-number">1</span>) {
            lbl_vibration-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">"âš  å¼‚å¸¸éœ‡åŠ¨!"</span>);
            lbl_vibration-&gt;<span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">"QLabel { font-size: 18px; font-weight: bold; color: red; }"</span>);
        } <span class="hljs-keyword">else</span> {
            lbl_vibration-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">"æ­£å¸¸"</span>);
            lbl_vibration-&gt;<span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">"QLabel { font-size: 18px; font-weight: bold; color: green; }"</span>);
        }
    }
}

<span class="hljs-comment">// *** æ ¸å¿ƒï¼šä¸‹å‘é˜ˆå€¼é…ç½® ***</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::onPublishThresholdClicked</span><span class="hljs-params">()</span>
</span>{
    QString topic = le_pub_topic-&gt;<span class="hljs-built_in">text</span>();
    
    <span class="hljs-comment">// æ„å»º JSON</span>
    QJsonObject jobj;
    jobj[<span class="hljs-string">"cmd"</span>] = <span class="hljs-string">"set_threshold"</span>;
    jobj[<span class="hljs-string">"temp_max"</span>] = sb_temp_max-&gt;<span class="hljs-built_in">value</span>();
    jobj[<span class="hljs-string">"weight_min"</span>] = sb_weight_min-&gt;<span class="hljs-built_in">value</span>();
    jobj[<span class="hljs-string">"sound_max"</span>] = sb_sound_max-&gt;<span class="hljs-built_in">value</span>();

    <span class="hljs-function">QJsonDocument <span class="hljs-title">doc</span><span class="hljs-params">(jobj)</span></span>;
    QByteArray payload = doc.<span class="hljs-built_in">toJson</span>(QJsonDocument::Compact);

    <span class="hljs-keyword">if</span> (m_client-&gt;<span class="hljs-built_in">publish</span>(topic, payload) == <span class="hljs-number">-1</span>) {
        <span class="hljs-built_in">log</span>(<span class="hljs-string">"æŒ‡ä»¤ä¸‹å‘å¤±è´¥"</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">log</span>(<span class="hljs-string">"æŒ‡ä»¤ä¸‹å‘æˆåŠŸ: "</span> + payload);
    }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainWindow::log</span><span class="hljs-params">(<span class="hljs-type">const</span> QString &amp;msg)</span>
</span>{
    txt_log-&gt;<span class="hljs-built_in">append</span>(QDateTime::<span class="hljs-built_in">currentDateTime</span>().<span class="hljs-built_in">toString</span>(<span class="hljs-string">"HH:mm:ss"</span>) + <span class="hljs-string">" "</span> + msg);
}
</code></pre>
<hr/>
<h4 data-id="heading-72">4. ä¸»ç¨‹åºå…¥å£ (main.cpp)</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"mainwindow.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;QApplication&gt;</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>
</span>{
    <span class="hljs-function">QApplication <span class="hljs-title">a</span><span class="hljs-params">(argc, argv)</span></span>;
    MainWindow w;
    w.<span class="hljs-built_in">show</span>();
    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">exec</span>();
}
</code></pre>
<hr/>
<h4 data-id="heading-73">5. ä½¿ç”¨è¯´æ˜ä¸æ³¨æ„äº‹é¡¹</h4>
<h5 data-id="heading-74">1. å…³äº QtMqtt æ¨¡å—</h5>
<p>æœ¬ä»£ç ä½¿ç”¨äº† <code>QMqttClient</code> ç±»ï¼Œè¿™æ˜¯ Qt å®˜æ–¹æä¾›çš„ MQTT å°è£…ã€‚</p>
<ul>
<li><strong>Qt 5.10+ / Qt 6+</strong>ï¼šéœ€è¦æ‰‹åŠ¨ç¼–è¯‘ <code>qtmqtt</code> åº“ã€‚</li>
<li><strong>Linux (Ubuntu)</strong>ï¼šå¯ä»¥é€šè¿‡ <code>sudo apt install qt6-mqtt-dev</code> (é’ˆå¯¹ Qt6) å®‰è£…ã€‚</li>
<li><strong>å¦‚æœæ— æ³•ç¼–è¯‘ QtMqtt</strong>ï¼šéœ€è¦å°†ä»£ç ä¸­çš„ <code>QMqttClient</code> æ›¿æ¢ä¸ºç¬¬ä¸‰æ–¹çš„ <code>QMQTT</code> åº“ï¼ˆGitHub ä¸Šæœ‰å¾ˆå¤šå•å¤´æ–‡ä»¶çš„åº“ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-75">2. åä¸ºäº‘é…ç½®</h5>
<p>ä¸ºäº†æˆåŠŸè¿æ¥åä¸ºäº‘ï¼Œéœ€è¦åœ¨ä¸Šä½æœºè½¯ä»¶ç•Œé¢å¡«å…¥æ­£ç¡®çš„é‰´æƒä¿¡æ¯ã€‚</p>
<ul>
<li><strong>Server</strong>: <code>iot-mqtts.cn-north-4.myhuaweicloud.com</code> (è¯·æ ¹æ®çš„åä¸ºäº‘å®é™…åŒºåŸŸå¡«å†™)ã€‚</li>
<li><strong>Client ID</strong>: æ ¼å¼ä¸º <code>device_id_0_0_timestamp</code>ã€‚</li>
<li><strong>Username</strong>: <code>device_id</code>ã€‚</li>
<li><strong>Password</strong>: éœ€è¦ä½¿ç”¨ HMAC-SHA256 ç®—æ³•ï¼Œé€šè¿‡ <code>Device Secret</code> ç”Ÿæˆã€‚åä¸ºäº‘æ§åˆ¶å°æä¾›äº†åœ¨çº¿ç”Ÿæˆå·¥å…·ï¼Œæˆ–è€…å¯ä»¥å†™ä¸€ä¸ªå°å·¥å…·ç”Ÿæˆåå¡«å…¥ã€‚</li>
</ul>
<h5 data-id="heading-76">3. é€šä¿¡åè®®å¯¹åº”</h5>
<p>ç¡®ä¿ STM32 ç«¯ä¸Šä¼ çš„ JSON é”®åï¼ˆKeyï¼‰ä¸ <code>mainwindow.cpp</code> ä¸­è§£æçš„é”®åä¸€è‡´ï¼š</p>
<ul>
<li><code>temp_in</code>, <code>humi_in</code></li>
<li><code>temp_out</code>, <code>humi_out</code></li>
<li><code>weight</code></li>
<li><code>light</code></li>
<li><code>sound</code></li>
<li><code>vib</code> (0ä¸ºæ­£å¸¸ï¼Œ1ä¸ºæŠ¥è­¦)</li>
</ul>
<h3 data-id="heading-77">4.5 ç¼–è¯‘Windowsä¸Šä½æœº</h3>
<p>ç‚¹å‡»è½¯ä»¶å·¦ä¸‹è§’çš„ç»¿è‰²ä¸‰è§’å½¢æŒ‰é’®è¿›è¡Œç¼–è¯‘è¿è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3b0e78f536b42dfab959583b969b12e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=KRWeGR%2BxJWiVgLysDctv3aKKY7s%3D" alt="image-20250402144112519" loading="lazy"/></p>
<h3 data-id="heading-78">4.6 é…ç½®Androidç¯å¢ƒ</h3>
<p>å¦‚æœæƒ³ç¼–è¯‘Androidæ‰‹æœºAPPï¼Œå¿…é¡»è¦å…ˆè‡ªå·±é…ç½®å¥½è‡ªå·±çš„Androidç¯å¢ƒã€‚ï¼ˆæ­å»ºç¯å¢ƒçš„è¿‡ç¨‹å¯ä»¥è‡ªè¡Œç™¾åº¦æœç´¢å­¦ä¹ ï¼‰</p>
<p>ç„¶åæ‰å¯ä»¥è¿›è¡Œä¸‹é¢çš„æ­¥éª¤ã€‚</p>
<h4 data-id="heading-79">ã€1ã€‘é€‰æ‹©Androidç¼–è¯‘å™¨</h4>
<p>é€‰æ‹©ç¼–è¯‘å™¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3226f81351c4d09b6f7f3558346c594~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=sFz9RftInzS3JATR5kpWUhSxTf4%3D" alt="image-20240425232651515" loading="lazy"/></p>
<p>åˆ‡æ¢ç¼–è¯‘å™¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3594ac95bbbd48d3bdb0619bd97b1e67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=096stxttBekMccdPnW3jHUPW8uc%3D" alt="image-20250402144840442" loading="lazy"/></p>
<h4 data-id="heading-80">ã€2ã€‘åˆ›å»ºAndroidé…ç½®æ–‡ä»¶</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46dceb1183a24fdd8b6bbbdaa91f407b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=AxR6jf5oGlW2m8tK%2BHpzE5fT4zA%3D" alt="image-20240117144604025" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1874689b5b74eda941b6fda0aa7a214~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Ys%2BfaeiCheKg9U%2B2XAKYT7g91%2BA%3D" alt="image-20240117144635052" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d7d845b12a345bdbbc2c632b9b2f4ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=by0hIkeMxvAjZ%2BFs16%2BAXJ5HNuA%3D" alt="image-20240117144652014" loading="lazy"/></p>
<p>åˆ›å»ºå®Œæˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/952cb35891814820b8b883a5ff0d97b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=h7ofGMLlQFBFZc1JFarMjEXq5jI%3D" alt="image-20250402144902155" loading="lazy"/></p>
<h4 data-id="heading-81">ã€3ã€‘é…ç½®Androidå›¾æ ‡ä¸åç§°</h4>
<p>æ ¹æ®è‡ªå·±çš„éœ€æ±‚é…ç½® Androidå›¾æ ‡ä¸åç§°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af7776f4ec1246ae9b697b4724d3dda6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=nmcY3moTNIaf11Q9E9wZlTMtnMQ%3D" alt="image-20250613111054529" loading="lazy"/></p>
<h4 data-id="heading-82">ã€3ã€‘ç¼–è¯‘Androidä¸Šä½æœº</h4>
<p>Qtæœ¬èº«æ˜¯è·¨å¹³å°çš„ï¼Œç›´æ¥é€‰æ‹©Androidçš„ç¼–è¯‘å™¨ï¼Œå°±å¯ä»¥å°†ç¨‹åºç¼–è¯‘åˆ°Androidå¹³å°ã€‚</p>
<p>ç„¶åç‚¹å‡»æ„å»ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26035b7e8d5745e88452d4ad319ac1d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=DVTkT5ERe7EPTMrztrZDOuSjGbw%3D" alt="image-20250613111041456" loading="lazy"/></p>
<p>æˆåŠŸä¹‹åï¼Œåœ¨ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„<code>apk</code>æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯Androidæ‰‹æœºçš„å®‰è£…åŒ…ï¼Œç”µè„‘ç«¯ä½¿ç”¨<code>QQ</code>å‘é€ç»™æ‰‹æœºQQ,æ‰‹æœºç™»å½•QQæ¥æ”¶ï¼Œå°±èƒ½ç›´æ¥å®‰è£…ã€‚</p>
<p>ç”Ÿæˆçš„<code>apk</code>çš„ç›®å½•åœ¨å“ªé‡Œå‘¢ï¼Ÿ ç¼–è¯‘å®Œæˆä¹‹åï¼Œåœ¨æ§åˆ¶å°ä¼šè¾“å‡ºAPKæ–‡ä»¶çš„è·¯å¾„ã€‚</p>
<p>çŸ¥é“ç›®å½•åœ¨å“ªé‡Œä¹‹åï¼Œåœ¨Windowsçš„æ–‡ä»¶èµ„æºç®¡ç†å™¨é‡Œï¼Œæ‰¾åˆ°è·¯å¾„ï¼Œå…·ä½“çœ‹ä¸‹å›¾ï¼Œæ‰¾åˆ°ç”Ÿæˆçš„apkæ–‡ä»¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74d4bd3c05cd49ef9502ad88736e5136~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=LxF0ZInZXAyxBQMydxPjNxXGr%2BY%3D" alt="image-20250402145406894" loading="lazy"/></p>
<pre><code class="hljs language-cpp" lang="cpp">File: D:/QtProject/build<span class="hljs-number">-333</span>_QtProject-Android_for_arm64_v8a_Clang_Qt_5_12_6_for_Android_ARM64_v8a-Release/android-build<span class="hljs-comment">//build/outputs/apk/debug/android-build-debug.apk</span>
</code></pre>
<h3 data-id="heading-83">4.7 è®¾å¤‡ä»¿çœŸè°ƒè¯•</h3>
<p>é€šè¿‡MQTTå®¢æˆ·ç«¯æ¨¡æ‹Ÿè®¾å¤‡ç™»å½•åä¸ºäº‘æœåŠ¡å™¨ã€‚è¿›è¡Œè®¾å¤‡è”è°ƒï¼Œå®ç°æ•°æ®ä¸Šä¼ å’Œä¸‹å‘æµ‹è¯•ã€‚</p>
<h2 data-id="heading-84">äº”ã€STM32ä»£ç è®¾è®¡</h2>
<p>å½“å‰é¡¹ç›®ä½¿ç”¨çš„ç›¸å…³è½¯ä»¶å·¥å…·ã€æ¨¡å—æºç å·²ç»ä¸Šä¼ åˆ°ç½‘ç›˜ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fccnr8sukk85n.feishu.cn%2Fwiki%2FQjY8weDYHibqRYkFP2qcA9aGnvb%3Ffrom%3Dfrom_copylink" target="_blank" title="https://ccnr8sukk85n.feishu.cn/wiki/QjY8weDYHibqRYkFP2qcA9aGnvb?from=from_copylink" ref="nofollow noopener noreferrer">ccnr8sukk85n.feishu.cn/wiki/QjY8weâ€¦</a></p>
<h3 data-id="heading-85">5.1 ç¡¬ä»¶è¿çº¿è¯´æ˜</h3>
<hr/>
<h4 data-id="heading-86">1. I2C æ€»çº¿è®¾å¤‡ï¼ˆOLED æ˜¾ç¤ºå± + BH1750 å…‰ç…§ä¼ æ„Ÿå™¨ï¼‰</h4>
<p>è¿™ä¸¤ä¸ªæ¨¡å—éƒ½ä½¿ç”¨ I2C é€šä¿¡åè®®ï¼Œå¯ä»¥å¹¶è”æŒ‚è½½åœ¨åŒä¸€ä¸ª I2C æ€»çº¿ä¸Šï¼ˆSTM32 çš„ I2C1 æ¥å£ï¼‰ã€‚</p>























































<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>OLED SCL</strong></td><td><strong>PB6</strong></td><td>I2C1_SCL</td></tr><tr><td><strong>OLED SDA</strong></td><td><strong>PB7</strong></td><td>I2C1_SDA</td></tr><tr><td>OLED VCC</td><td>3.3V</td><td>OLED ä¾›ç”µ</td></tr><tr><td>OLED GND</td><td>GND</td><td>å…±åœ°</td></tr><tr><td><strong>BH1750 SCL</strong></td><td><strong>PB6</strong></td><td>ä¸ OLED å¹¶è”</td></tr><tr><td><strong>BH1750 SDA</strong></td><td><strong>PB7</strong></td><td>ä¸ OLED å¹¶è”</td></tr><tr><td>BH1750 VCC</td><td>3.3V or 5V</td><td>æ¨¡å—é€šå¸¸å…¼å®¹</td></tr><tr><td>BH1750 GND</td><td>GND</td><td>å…±åœ°</td></tr><tr><td>BH1750 ADDR</td><td>GND (æˆ–æ‚¬ç©º)</td><td>åœ°å€é€‰æ‹©è„šï¼Œæ¥åœ°é»˜è®¤åœ°å€</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-87">2. æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼ˆå†…éƒ¨ &amp; å¤–éƒ¨ï¼‰</h4>
<p>é‡‡ç”¨å•æ€»çº¿åè®®ï¼Œåˆ†åˆ«å ç”¨ä¸¤ä¸ªæ™®é€š GPIO å£ã€‚</p>








































<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>DHT11(å†…) DATA</strong></td><td><strong>PA4</strong></td><td>å†…éƒ¨æ¸©æ¹¿åº¦æ•°æ®è„š</td></tr><tr><td>DHT11(å†…) VCC</td><td>3.3V or 5V</td><td>å»ºè®® 3.3V ä»¥åŒ¹é…é€»è¾‘ç”µå¹³</td></tr><tr><td>DHT11(å†…) GND</td><td>GND</td><td>å…±åœ°</td></tr><tr><td><strong>DHT11(å¤–) DATA</strong></td><td><strong>PA5</strong></td><td>å¤–éƒ¨æ¸©æ¹¿åº¦æ•°æ®è„š</td></tr><tr><td>DHT11(å¤–) VCC</td><td>3.3V or 5V</td><td/></tr><tr><td>DHT11(å¤–) GND</td><td>GND</td><td/></tr></tbody></table>
<p><em>æ³¨æ„ï¼šDHT11 çš„ DATA å¼•è„šé€šå¸¸éœ€è¦æ¥ä¸€ä¸ª 4.7kÎ© - 10kÎ© çš„ä¸Šæ‹‰ç”µé˜»åˆ° VCCï¼ˆå¾ˆå¤šæˆå“æ¨¡å—å·²å†…ç½®ï¼‰ã€‚</em></p>
<hr/>
<h4 data-id="heading-88">3. é‡é‡ç›‘æµ‹æ¨¡å—ï¼ˆHX711 + ç§°é‡ä¼ æ„Ÿå™¨ï¼‰</h4>
<p>HX711 æ˜¯é«˜ç²¾åº¦ ADCï¼Œä½¿ç”¨è‡ªå®šä¹‰çš„ä¸²è¡Œåè®®ã€‚</p>






























<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>HX711 DT (Data)</strong></td><td><strong>PA6</strong></td><td>æ•°æ®å¼•è„š</td></tr><tr><td><strong>HX711 SCK (Clock)</strong></td><td><strong>PA7</strong></td><td>æ—¶é’Ÿå¼•è„š</td></tr><tr><td>HX711 VCC</td><td>5V</td><td>å»ºè®®æ¥ 5V ä»¥æä¾›æ›´ç¨³å®šçš„ä¼ æ„Ÿå™¨æ¿€åŠ±ç”µå‹</td></tr><tr><td>HX711 GND</td><td>GND</td><td>å…±åœ°</td></tr></tbody></table>
<p><em>æ¥çº¿è¯´æ˜ï¼šç§°é‡ä¼ æ„Ÿå™¨çš„ E+/E-/A+/A- è¯·ä¸¥æ ¼æŒ‰ç…§ä¼ æ„Ÿå™¨çº¿è‰²è¿æ¥åˆ° HX711 æ¨¡å—å¯¹åº”ç«¯å£ã€‚</em></p>
<hr/>
<h4 data-id="heading-89">4. å£°éŸ³é‡‡é›†æ¨¡å—ï¼ˆMAX9814ï¼‰</h4>
<p>è¾“å‡ºæ¨¡æ‹Ÿç”µå‹ä¿¡å·ï¼Œéœ€è¦è¿æ¥ STM32 çš„ ADC å¼•è„šã€‚</p>






























<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>MAX9814 OUT</strong></td><td><strong>PA1</strong></td><td>è¿æ¥ ADC1_IN1</td></tr><tr><td>MAX9814 VCC</td><td>3.3V or 5V</td><td/></tr><tr><td>MAX9814 GND</td><td>GND</td><td/></tr><tr><td>MAX9814 GAIN</td><td>(å¯é€‰)</td><td>å¢ç›Šè®¾ç½®ï¼Œæ‚¬ç©ºé»˜è®¤ 60dBï¼Œæˆ–æ¥ VCC/GND è°ƒæ•´</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-90">5. éœ‡åŠ¨ç›‘æµ‹æ¨¡å—ï¼ˆSW420ï¼‰</h4>
<p>é€šå¸¸è¾“å‡ºæ•°å­—å¼€å…³é‡ï¼ˆ0 æˆ– 1ï¼‰ï¼Œè¿æ¥æ™®é€š GPIO å³å¯ã€‚</p>

























<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>SW420 DO</strong></td><td><strong>PB0</strong></td><td>æ•°å­—è¾“å‡ºå¼•è„š (Digital Out)</td></tr><tr><td>SW420 VCC</td><td>3.3V or 5V</td><td/></tr><tr><td>SW420 GND</td><td>GND</td><td/></tr></tbody></table>
<hr/>
<h4 data-id="heading-91">6. é€šä¿¡æ¨¡å—ï¼ˆäºŒé€‰ä¸€ï¼šAir780E æˆ– ESP8266ï¼‰</h4>
<p>ä½¿ç”¨ä¸²å£ (USART2) è¿›è¡Œé€šä¿¡ã€‚<strong>æ³¨æ„ TX å’Œ RX è¦äº¤å‰è¿æ¥ã€‚</strong></p>
<h5 data-id="heading-92">æ–¹æ¡ˆ A: Air780E (4G Cat.1)</h5>






























<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Air780 TX</strong></td><td><strong>PA3</strong></td><td>STM32 çš„ RX2</td></tr><tr><td><strong>Air780 RX</strong></td><td><strong>PA2</strong></td><td>STM32 çš„ TX2</td></tr><tr><td>Air780 VCC</td><td>5V / VBAT</td><td>4G æ¨¡å—ç”µæµå¤§ï¼Œå»ºè®®ç›´æ¥ç”±ç”µæºæ¨¡å—ä¾›ç”µï¼Œä¸è¦ä» STM32 å–ç”µ</td></tr><tr><td>Air780 GND</td><td>GND</td><td><strong>åŠ¡å¿…å…±åœ°</strong></td></tr></tbody></table>
<h5 data-id="heading-93">æ–¹æ¡ˆ B: ESP8266-01S (Wi-Fi)</h5>



































<table><thead><tr><th>æ¨¡å—å¼•è„š</th><th>STM32 å¼•è„š</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ESP8266 TX</strong></td><td><strong>PA3</strong></td><td>STM32 çš„ RX2</td></tr><tr><td><strong>ESP8266 RX</strong></td><td><strong>PA2</strong></td><td>STM32 çš„ TX2</td></tr><tr><td>ESP8266 3V3</td><td>3.3V</td><td><strong>ä¸¥ç¦æ¥ 5Vï¼Œä¼šçƒ§æ¯</strong></td></tr><tr><td>ESP8266 EN</td><td>3.3V</td><td>ä½¿èƒ½è„šï¼Œå¿…é¡»æ¥é«˜ç”µå¹³</td></tr><tr><td>ESP8266 GND</td><td>GND</td><td>å…±åœ°</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-94">7. ç”µæºç®¡ç†æ¨¡å—</h4>
<p>ç³»ç»Ÿä¾›ç”µæ˜¯ç¨³å®šçš„å…³é”®ã€‚</p>
<ul>
<li><strong>18650 é”‚ç”µæ± </strong> è¾“å‡º (3.7V - 4.2V) è¿æ¥åˆ° <strong>AMS1117-3.3</strong> å’Œ <strong>AMS1117-5.0</strong> è¾“å…¥ç«¯ï¼ˆæˆ–è€…ä½¿ç”¨å‡å‹/é™å‹æ¨¡å—ï¼‰ã€‚</li>
<li><strong>STM32 ä¾›ç”µ</strong>ï¼šå°†ç¨³å‹åçš„ 3.3V æ¥åˆ° STM32 çš„ 3.3V å¼•è„šï¼ŒGND æ¥ GNDã€‚</li>
<li><strong>5V æ€»çº¿</strong>ï¼šç”¨äºç»™ HX711ã€Air780E ä¾›ç”µã€‚</li>
<li><strong>3.3V æ€»çº¿</strong>ï¼šç”¨äºç»™ STM32ã€OLEDã€DHT11ã€ESP8266 ä¾›ç”µã€‚</li>
</ul>
<h4 data-id="heading-95">æ€»ç»“å¼•è„šåˆ†é…è¡¨</h4>

































































<table><thead><tr><th>STM32 å¼•è„š</th><th>åŠŸèƒ½åˆ†é…</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><strong>PA1</strong></td><td>MAX9814 (ADC)</td><td>å£°éŸ³é‡‡é›†</td></tr><tr><td><strong>PA2</strong></td><td>USART2_TX</td><td>è¿æ¥é€šä¿¡æ¨¡å— RX</td></tr><tr><td><strong>PA3</strong></td><td>USART2_RX</td><td>è¿æ¥é€šä¿¡æ¨¡å— TX</td></tr><tr><td><strong>PA4</strong></td><td>GPIO</td><td>DHT11 (å†…éƒ¨)</td></tr><tr><td><strong>PA5</strong></td><td>GPIO</td><td>DHT11 (å¤–éƒ¨)</td></tr><tr><td><strong>PA6</strong></td><td>GPIO</td><td>HX711_DT (æ•°æ®)</td></tr><tr><td><strong>PA7</strong></td><td>GPIO</td><td>HX711_SCK (æ—¶é’Ÿ)</td></tr><tr><td><strong>PB0</strong></td><td>GPIO</td><td>SW420 (éœ‡åŠ¨)</td></tr><tr><td><strong>PB6</strong></td><td>I2C1_SCL</td><td>OLED &amp; BH1750</td></tr><tr><td><strong>PB7</strong></td><td>I2C1_SDA</td><td>OLED &amp; BH1750</td></tr><tr><td><strong>PA9/PA10</strong></td><td>USART1</td><td>ç”¨äºç¨‹åºä¸‹è½½è°ƒè¯• (ST-Link æˆ– ä¸²å£ä¸‹è½½)</td></tr></tbody></table>
<h3 data-id="heading-96">5.2 ä¼ æ„Ÿå™¨ä»£ç </h3>
<p>è¿™æ˜¯ä¸€ä¸ªåŸºäº <strong>STM32F103C8T6</strong> çš„å®Œæ•´åº•å±‚é©±åŠ¨ä»£ç é›†åˆã€‚ä¸ºäº†æ»¡è¶³â€œå¯„å­˜å™¨æ–¹å¼ï¼Œä¸é‡‡ç”¨åº“â€çš„è¦æ±‚ï¼Œä»£ç ç›´æ¥æ“ä½œå¯„å­˜å™¨ï¼ˆå¦‚ <code>GPIOA-&gt;CRL</code>ã€<code>RCC-&gt;APB2ENR</code> ç­‰ï¼‰ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ä½ ç›´æ¥ä½¿ç”¨ï¼Œæˆ‘å°†ä»£ç ç»„ç»‡ä¸ºå‡ ä¸ªæ ¸å¿ƒéƒ¨åˆ†ã€‚ä½ å¯ä»¥å°†è¿™äº›ä»£ç åˆ†åˆ«ä¿å­˜ä¸º <code>.c</code> å’Œ <code>.h</code> æ–‡ä»¶ï¼Œæˆ–è€…æ•´åˆåˆ°ä¸€ä¸ª <code>main.c</code> ä¸­ï¼ˆè™½ç„¶ä¸å»ºè®®è¿™æ ·åšï¼Œä½†ä¸ºäº†å±•ç¤ºæ–¹ä¾¿ï¼Œä¸‹é¢æŒ‰åŠŸèƒ½æ¨¡å—åˆ—å‡ºï¼‰ã€‚</p>
<p><strong>å‰ææ¡ä»¶</strong>ï¼š</p>
<ol>
<li>å¼€å‘ç¯å¢ƒéœ€åŒ…å« CMSIS æ ¸å¿ƒå¤´æ–‡ä»¶ <code>stm32f10x.h</code>ï¼ˆè¿™æ˜¯æ‰€æœ‰ STM32 å¼€å‘çš„åŸºç¡€ï¼Œå®šä¹‰äº†å¯„å­˜å™¨ç»“æ„ä½“ï¼‰ã€‚</li>
<li>ç³»ç»Ÿæ—¶é’Ÿé»˜è®¤é…ç½®ä¸º 72MHzã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-97">1. åŸºç¡€å»¶æ—¶ä¸ç³»ç»Ÿé…ç½® (System)</h4>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šæä¾›å¾®ç§’çº§å»¶æ—¶ï¼ˆDHT11å¿…é¡»ï¼‰å’Œæ¯«ç§’çº§å»¶æ—¶ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// system.c</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"stm32f10x.h"</span></span>

<span class="hljs-comment">// ç³»ç»Ÿæ—¶é’Ÿåˆå§‹åŒ– (72MHz) - é€šå¸¸å¯åŠ¨æ–‡ä»¶å·²å¤„ç†ï¼Œè¿™é‡Œç¡®ä¿å¤–è®¾æ—¶é’Ÿå¼€å¯</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">System_Init_Config</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-comment">// å¼€å¯ GPIOA, GPIOB, AFIO, USART1, USART2, ADC1 æ—¶é’Ÿ</span>
    RCC-&gt;APB2ENR |= (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">2</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">3</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">0</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">14</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">9</span>); 
    RCC-&gt;APB1ENR |= (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">17</span>); <span class="hljs-comment">// å¼€å¯ USART2 æ—¶é’Ÿ</span>
}

<span class="hljs-comment">// ç®€å•çš„ SysTick å»¶æ—¶å‡½æ•° (72MHz)</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">Delay_us</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> us)</span> {
    SysTick-&gt;LOAD = <span class="hljs-number">72</span> * us;         <span class="hljs-comment">// è£…è½½è®¡æ•°å€¼</span>
    SysTick-&gt;VAL = <span class="hljs-number">0x00</span>;             <span class="hljs-comment">// æ¸…ç©ºè®¡æ•°å™¨</span>
    SysTick-&gt;CTRL = <span class="hljs-number">0x00000005</span>;      <span class="hljs-comment">// ä½¿èƒ½ï¼Œæºæ—¶é’ŸAHB</span>
    <span class="hljs-keyword">while</span>(!(SysTick-&gt;CTRL &amp; <span class="hljs-number">0x00010000</span>)); <span class="hljs-comment">// ç­‰å¾…è®¡æ•°å½’é›¶</span>
    SysTick-&gt;CTRL = <span class="hljs-number">0x00000004</span>;      <span class="hljs-comment">// å…³é—­å®šæ—¶å™¨</span>
}

<span class="hljs-type">void</span> <span class="hljs-title function_">Delay_ms</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> ms)</span> {
    <span class="hljs-keyword">while</span>(ms--) {
        Delay_us(<span class="hljs-number">1000</span>);
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-98">2. GPIO å·¥å…·å‡½æ•° (GPIO Utils)</h4>
<p>ç”±äºå¯„å­˜å™¨æ“ä½œé…ç½® GPIO æ¨¡å¼æ¯”è¾ƒç¹çï¼Œå®šä¹‰ä¸¤ä¸ªè¾…åŠ©å‡½æ•°ç”¨äº DHT11 ç­‰éœ€è¦é¢‘ç¹åˆ‡æ¢è¾“å…¥/è¾“å‡ºçš„å¼•è„šã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// æ¨¡å¼å®šä¹‰: 0=Input, 1=Output_PP_50MHz</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">GPIO_SetMode</span><span class="hljs-params">(GPIO_TypeDef* GPIOx, <span class="hljs-type">uint8_t</span> Pin, <span class="hljs-type">uint8_t</span> Mode)</span> {
    <span class="hljs-type">uint32_t</span> *cr_reg;
    <span class="hljs-type">uint8_t</span> shift;
    
    <span class="hljs-keyword">if</span> (Pin &lt; <span class="hljs-number">8</span>) {
        cr_reg = &amp;GPIOx-&gt;CRL;
        shift = Pin * <span class="hljs-number">4</span>;
    } <span class="hljs-keyword">else</span> {
        cr_reg = &amp;GPIOx-&gt;CRH;
        shift = (Pin - <span class="hljs-number">8</span>) * <span class="hljs-number">4</span>;
    }

    *cr_reg &amp;= ~(<span class="hljs-number">0xF</span> &lt;&lt; shift); <span class="hljs-comment">// æ¸…é™¤åŸæœ‰é…ç½®</span>
    
    <span class="hljs-keyword">if</span> (Mode == <span class="hljs-number">1</span>) { <span class="hljs-comment">// Output Push-Pull 50MHz</span>
        *cr_reg |= (<span class="hljs-number">0x3</span> &lt;&lt; shift); 
    } <span class="hljs-keyword">else</span> { <span class="hljs-comment">// Input Pull-Up/Down (éœ€é…åˆODRè®¾ç½®ç”µå¹³)</span>
        *cr_reg |= (<span class="hljs-number">0x8</span> &lt;&lt; shift); 
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-99">3. DHT11 æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨é©±åŠ¨</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šPA4 (å†…éƒ¨), PA5 (å¤–éƒ¨)</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è¯»å– DHT11 æ•°æ®</span>
<span class="hljs-comment">// GPIOx: GPIOA, Pin: 4 or 5</span>
<span class="hljs-comment">// è¿”å›å€¼: 0-æˆåŠŸ, 1-å¤±è´¥</span>
<span class="hljs-type">uint8_t</span> <span class="hljs-title function_">DHT11_Read_Data</span><span class="hljs-params">(GPIO_TypeDef* GPIOx, <span class="hljs-type">uint8_t</span> Pin, <span class="hljs-type">uint8_t</span> *temp, <span class="hljs-type">uint8_t</span> *humi)</span> {
    <span class="hljs-type">uint8_t</span> buf[<span class="hljs-number">5</span>];
    <span class="hljs-type">uint8_t</span> i, j;
    
    <span class="hljs-comment">// 1. ä¸»æœºå‘é€å¼€å§‹ä¿¡å·</span>
    GPIO_SetMode(GPIOx, Pin, <span class="hljs-number">1</span>); <span class="hljs-comment">// è¾“å‡ºæ¨¡å¼</span>
    GPIOx-&gt;BRR = (<span class="hljs-number">1</span> &lt;&lt; Pin);     <span class="hljs-comment">// æ‹‰ä½</span>
    Delay_ms(<span class="hljs-number">20</span>);                <span class="hljs-comment">// ä¿æŒè‡³å°‘18ms</span>
    GPIOx-&gt;BSRR = (<span class="hljs-number">1</span> &lt;&lt; Pin);    <span class="hljs-comment">// æ‹‰é«˜</span>
    Delay_us(<span class="hljs-number">30</span>);
    
    <span class="hljs-comment">// 2. åˆ‡æ¢ä¸ºè¾“å…¥ï¼Œç­‰å¾…å“åº”</span>
    GPIO_SetMode(GPIOx, Pin, <span class="hljs-number">0</span>); <span class="hljs-comment">// è¾“å…¥æ¨¡å¼</span>
    
    <span class="hljs-comment">// æ£€æµ‹å“åº”ä¿¡å·ï¼ˆä½ç”µå¹³80us -&gt; é«˜ç”µå¹³80usï¼‰</span>
    <span class="hljs-keyword">if</span> (!(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin))) {
        <span class="hljs-keyword">while</span>(!(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin))); <span class="hljs-comment">// ç­‰å¾…å˜é«˜</span>
        <span class="hljs-keyword">while</span>(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin));    <span class="hljs-comment">// ç­‰å¾…å˜ä½</span>
        
        <span class="hljs-comment">// 3. å¼€å§‹æ¥æ”¶ 40bit æ•°æ®</span>
        <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            buf[i] = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span>(j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++) {
                <span class="hljs-keyword">while</span>(!(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin))); <span class="hljs-comment">// ç­‰å¾…å˜ä¸ºé«˜ç”µå¹³ï¼ˆå¼€å§‹ä¼ è¾“ä½ï¼‰</span>
                Delay_us(<span class="hljs-number">40</span>); <span class="hljs-comment">// å»¶æ—¶40usåˆ¤æ–­æ˜¯0è¿˜æ˜¯1</span>
                
                <span class="hljs-keyword">if</span>(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin)) { <span class="hljs-comment">// å¦‚æœè¿˜åœ¨é«˜ç”µå¹³ï¼Œåˆ™æ˜¯1</span>
                    buf[i] |= (<span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">7</span> - j));
                    <span class="hljs-keyword">while</span>(GPIOx-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; Pin)); <span class="hljs-comment">// ç­‰å¾…å˜ä¸ºä½ç”µå¹³</span>
                }
            }
        }
        
        <span class="hljs-comment">// 4. æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span>((buf[<span class="hljs-number">0</span>] + buf[<span class="hljs-number">1</span>] + buf[<span class="hljs-number">2</span>] + buf[<span class="hljs-number">3</span>]) == buf[<span class="hljs-number">4</span>]) {
            *humi = buf[<span class="hljs-number">0</span>];
            *temp = buf[<span class="hljs-number">2</span>];
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}
</code></pre>
<hr/>
<h4 data-id="heading-100">4. HX711 é‡é‡ä¼ æ„Ÿå™¨é©±åŠ¨</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šDT=PA6, SCK=PA7</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-title function_">HX711_Read</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> i;
    
    <span class="hljs-comment">// PA6 Input, PA7 Output (åœ¨åˆå§‹åŒ–ä¸­é…ç½®å¥½)</span>
    <span class="hljs-comment">// DT=PA6, SCK=PA7</span>
    
    GPIOA-&gt;BRR = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>); <span class="hljs-comment">// SCK = 0</span>
    
    <span class="hljs-comment">// ç­‰å¾… DT å˜ä½ï¼Œè¡¨ç¤ºè½¬æ¢å®Œæˆ</span>
    <span class="hljs-keyword">while</span>(GPIOA-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">6</span>)); 
    
    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">24</span>; i++) {
        GPIOA-&gt;BSRR = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>); <span class="hljs-comment">// SCK = 1</span>
        Delay_us(<span class="hljs-number">1</span>);
        count = count &lt;&lt; <span class="hljs-number">1</span>;
        GPIOA-&gt;BRR = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>);  <span class="hljs-comment">// SCK = 0</span>
        Delay_us(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span>(GPIOA-&gt;IDR &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">6</span>)) count++;
    }
    
    <span class="hljs-comment">// ç¬¬25ä¸ªè„‰å†²ï¼Œè®¾ç½®å¢ç›Š 128</span>
    GPIOA-&gt;BSRR = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>); 
    Delay_us(<span class="hljs-number">1</span>);
    GPIOA-&gt;BRR = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>); 
    Delay_us(<span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">return</span> count ^ <span class="hljs-number">0x800000</span>; <span class="hljs-comment">// è½¬æ¢ç¬¦å·ä½</span>
}

<span class="hljs-comment">// åˆå§‹åŒ– GPIO</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">HX711_Init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-comment">// PA6 Input (Floating/PU), PA7 Output</span>
    GPIO_SetMode(GPIOA, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>);
    GPIOA-&gt;ODR |= (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">6</span>); <span class="hljs-comment">// Pull Up</span>
    GPIO_SetMode(GPIOA, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>);
}
</code></pre>
<hr/>
<h4 data-id="heading-101">5. è½¯ä»¶ I2C é©±åŠ¨ (OLED &amp; BH1750)</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šSCL=PB6, SDA=PB7</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> SCL_H GPIOB-&gt;BSRR = (1 &lt;&lt; 6)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> SCL_L GPIOB-&gt;BRR  = (1 &lt;&lt; 6)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> SDA_H GPIOB-&gt;BSRR = (1 &lt;&lt; 7)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> SDA_L GPIOB-&gt;BRR  = (1 &lt;&lt; 7)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> READ_SDA (GPIOB-&gt;IDR &amp; (1 &lt;&lt; 7))</span>

<span class="hljs-type">void</span> <span class="hljs-title function_">I2C_GPIO_Config</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-comment">// é…ç½® PB6, PB7 ä¸ºå¼€æ¼è¾“å‡º (Open-Drain, 50MHz)</span>
    <span class="hljs-comment">// CNF=01, MODE=11 -&gt; 0x7</span>
    GPIOB-&gt;CRL &amp;= <span class="hljs-number">0x00FFFFFF</span>; 
    GPIOB-&gt;CRL |= <span class="hljs-number">0x77000000</span>; 
    SCL_H; SDA_H;
}

<span class="hljs-type">void</span> <span class="hljs-title function_">I2C_Start</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    SDA_H; SCL_H; Delay_us(<span class="hljs-number">4</span>);
    SDA_L; Delay_us(<span class="hljs-number">4</span>);
    SCL_L;
}

<span class="hljs-type">void</span> <span class="hljs-title function_">I2C_Stop</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    SCL_L; SDA_L; Delay_us(<span class="hljs-number">4</span>);
    SCL_H; SDA_H; Delay_us(<span class="hljs-number">4</span>);
}

<span class="hljs-type">void</span> <span class="hljs-title function_">I2C_SendByte</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> Byte)</span> {
    <span class="hljs-type">uint8_t</span> i;
    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) {
        <span class="hljs-keyword">if</span>(Byte &amp; <span class="hljs-number">0x80</span>) SDA_H; <span class="hljs-keyword">else</span> SDA_L;
        Byte &lt;&lt;= <span class="hljs-number">1</span>;
        Delay_us(<span class="hljs-number">2</span>);
        SCL_H; Delay_us(<span class="hljs-number">2</span>);
        SCL_L; Delay_us(<span class="hljs-number">2</span>);
    }
    <span class="hljs-comment">// ç­‰å¾… ACK (ç®€å•å¤„ç†ï¼Œå¿½ç•¥è¿”å›å€¼)</span>
    SDA_H; SCL_H; Delay_us(<span class="hljs-number">2</span>); SCL_L;
}

<span class="hljs-type">uint8_t</span> <span class="hljs-title function_">I2C_ReadByte</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">uint8_t</span> i, val = <span class="hljs-number">0</span>;
    SDA_H; <span class="hljs-comment">// é‡Šæ”¾æ€»çº¿</span>
    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) {
        val &lt;&lt;= <span class="hljs-number">1</span>;
        SCL_H; Delay_us(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">if</span>(READ_SDA) val++;
        SCL_L; Delay_us(<span class="hljs-number">2</span>);
    }
    <span class="hljs-comment">// å‘é€ NoACK (æœ€åä¸€ä½)</span>
    SDA_H; SCL_H; Delay_us(<span class="hljs-number">2</span>); SCL_L;
    <span class="hljs-keyword">return</span> val;
}
</code></pre>
<hr/>
<h4 data-id="heading-102">6. BH1750 å…‰ç…§ä¼ æ„Ÿå™¨é©±åŠ¨</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> BH1750_ADDR 0x46 <span class="hljs-comment">// ADDRæ¥åœ°æ—¶åœ°å€</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">BH1750_Init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    I2C_Start();
    I2C_SendByte(BH1750_ADDR);
    I2C_SendByte(<span class="hljs-number">0x01</span>); <span class="hljs-comment">// Power On</span>
    I2C_Stop();
}

<span class="hljs-type">void</span> <span class="hljs-title function_">BH1750_Start</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    I2C_Start();
    I2C_SendByte(BH1750_ADDR);
    I2C_SendByte(<span class="hljs-number">0x10</span>); <span class="hljs-comment">// H-Resolution Mode</span>
    I2C_Stop();
}

<span class="hljs-type">uint16_t</span> <span class="hljs-title function_">BH1750_Read</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">uint16_t</span> data;
    I2C_Start();
    I2C_SendByte(BH1750_ADDR | <span class="hljs-number">1</span>); <span class="hljs-comment">// Read mode</span>
    data = I2C_ReadByte();
    data = (data &lt;&lt; <span class="hljs-number">8</span>) + I2C_ReadByte();
    I2C_Stop();
    <span class="hljs-keyword">return</span> data; <span class="hljs-comment">// å•ä½ Lux</span>
}
</code></pre>
<hr/>
<h4 data-id="heading-103">7. MAX9814 (ADC) é©±åŠ¨</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šPA1 (ADC1_IN1)</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">ADC_Config</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-comment">// PA1 æ¨¡æ‹Ÿè¾“å…¥æ¨¡å¼ (CNF=00, MODE=00)</span>
    GPIOA-&gt;CRL &amp;= <span class="hljs-number">0xFFFFFF0F</span>;
    
    <span class="hljs-comment">// ADC1 æ—¶é’Ÿé¢„åˆ†é¢‘ (Max 14MHz, PCLK2=72M, DIV6=12M)</span>
    RCC-&gt;CFGR |= (<span class="hljs-number">2</span> &lt;&lt; <span class="hljs-number">14</span>); 
    
    <span class="hljs-comment">// å¤ä½ ADC</span>
    ADC1-&gt;CR2 |= (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span>);
    <span class="hljs-keyword">while</span>(ADC1-&gt;CR2 &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span>));
    
    <span class="hljs-comment">// æ ¡å‡† ADC</span>
    ADC1-&gt;CR2 |= (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>);
    <span class="hljs-keyword">while</span>(ADC1-&gt;CR2 &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>));
    
    <span class="hljs-comment">// é…ç½®è§„åˆ™ç»„: åºåˆ—1 ä¸º é€šé“1</span>
    ADC1-&gt;SQR3 = <span class="hljs-number">1</span>; 
    
    <span class="hljs-comment">// å¼€å¯ ADC</span>
    ADC1-&gt;CR2 |= <span class="hljs-number">1</span>; 
}

<span class="hljs-type">uint16_t</span> <span class="hljs-title function_">Get_Sound_Level</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    ADC1-&gt;CR2 |= <span class="hljs-number">1</span>; <span class="hljs-comment">// å†æ¬¡ç½®ä½å¯åŠ¨è½¬æ¢</span>
    <span class="hljs-keyword">while</span>(!(ADC1-&gt;SR &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">1</span>))); <span class="hljs-comment">// ç­‰å¾… EOC</span>
    <span class="hljs-keyword">return</span> ADC1-&gt;DR;
}
</code></pre>
<hr/>
<h4 data-id="heading-104">8. USART2 é€šä¿¡é©±åŠ¨ (è¿æ¥ Air780E/ESP8266)</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šPA2 (TX), PA3 (RX)</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">USART2_Config</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> baud)</span> {
    <span class="hljs-comment">// PA2 (TX): AF_PP (1011 -&gt; 0xB)</span>
    GPIOA-&gt;CRL &amp;= <span class="hljs-number">0xFFFF00FF</span>;
    GPIOA-&gt;CRL |= <span class="hljs-number">0x00004B00</span>; <span class="hljs-comment">// PA2=AF_PP, PA3=Input Floating(0x4)</span>
    
    <span class="hljs-comment">// æ³¢ç‰¹ç‡è®¡ç®— (PCLK1 = 36MHz)</span>
    <span class="hljs-comment">// USARTDIV = 36000000 / 115200 = 312.5</span>
    <span class="hljs-comment">// Mantissa = 312 (0x138), Fraction = 0.5*16 = 8</span>
    <span class="hljs-comment">// BRR = 0x1388</span>
    <span class="hljs-type">float</span> div = <span class="hljs-number">36000000.0</span> / baud;
    <span class="hljs-type">uint16_t</span> mantissa = (<span class="hljs-type">uint16_t</span>)div;
    <span class="hljs-type">uint16_t</span> fraction = (<span class="hljs-type">uint16_t</span>)((div - mantissa) * <span class="hljs-number">16</span>);
    USART2-&gt;BRR = (mantissa &lt;&lt; <span class="hljs-number">4</span>) + fraction;
    
    <span class="hljs-comment">// ä½¿èƒ½ UE, TE, RE, RXNEä¸­æ–­</span>
    USART2-&gt;CR1 = (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">13</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">3</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">2</span>) | (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">5</span>); 
    
    <span class="hljs-comment">// é…ç½® NVIC</span>
    NVIC_EnableIRQ(USART2_IRQn);
}

<span class="hljs-type">void</span> <span class="hljs-title function_">USART2_SendChar</span><span class="hljs-params">(<span class="hljs-type">char</span> ch)</span> {
    <span class="hljs-keyword">while</span>(!(USART2-&gt;SR &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>))); <span class="hljs-comment">// ç­‰å¾… TXE</span>
    USART2-&gt;DR = ch;
}

<span class="hljs-type">void</span> <span class="hljs-title function_">USART2_SendString</span><span class="hljs-params">(<span class="hljs-type">char</span> *str)</span> {
    <span class="hljs-keyword">while</span>(*str) {
        USART2_SendChar(*str++);
    }
}

<span class="hljs-comment">// ä¸­æ–­æ¥æ”¶å¤„ç†</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">USART2_IRQHandler</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-keyword">if</span>(USART2-&gt;SR &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">5</span>)) { <span class="hljs-comment">// RXNE</span>
        <span class="hljs-type">uint8_t</span> data = USART2-&gt;DR;
        <span class="hljs-comment">// åœ¨è¿™é‡Œå¤„ç†æ¥æ”¶åˆ°çš„ MQTT æ•°æ®</span>
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-105">9. OLED é©±åŠ¨ (ç®€åŒ–ç‰ˆ)</h4>
<p><strong>ç¡¬ä»¶è¿æ¥</strong>ï¼šåŒ I2C</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> OLED_ADDR 0x78 </span>

<span class="hljs-type">void</span> <span class="hljs-title function_">OLED_WriteCmd</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> cmd)</span> {
    I2C_Start();
    I2C_SendByte(OLED_ADDR);
    I2C_SendByte(<span class="hljs-number">0x00</span>); <span class="hljs-comment">// Co=0, D/C#=0</span>
    I2C_SendByte(cmd);
    I2C_Stop();
}

<span class="hljs-type">void</span> <span class="hljs-title function_">OLED_WriteData</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> data)</span> {
    I2C_Start();
    I2C_SendByte(OLED_ADDR);
    I2C_SendByte(<span class="hljs-number">0x40</span>); <span class="hljs-comment">// Co=0, D/C#=1</span>
    I2C_SendByte(data);
    I2C_Stop();
}

<span class="hljs-type">void</span> <span class="hljs-title function_">OLED_Init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    Delay_ms(<span class="hljs-number">100</span>);
    <span class="hljs-comment">// å¸¸ç”¨åˆå§‹åŒ–åºåˆ—</span>
    OLED_WriteCmd(<span class="hljs-number">0xAE</span>); <span class="hljs-comment">// Display Off</span>
    OLED_WriteCmd(<span class="hljs-number">0x20</span>); OLED_WriteCmd(<span class="hljs-number">0x02</span>); <span class="hljs-comment">// Set Memory Addressing Mode</span>
    OLED_WriteCmd(<span class="hljs-number">0xB0</span>); <span class="hljs-comment">// Set Page Start Address</span>
    OLED_WriteCmd(<span class="hljs-number">0xC8</span>); <span class="hljs-comment">// Set COM Output Scan Direction</span>
    OLED_WriteCmd(<span class="hljs-number">0x00</span>); <span class="hljs-comment">// Set Low Column Address</span>
    OLED_WriteCmd(<span class="hljs-number">0x10</span>); <span class="hljs-comment">// Set High Column Address</span>
    OLED_WriteCmd(<span class="hljs-number">0x40</span>); <span class="hljs-comment">// Set Start Line Address</span>
    OLED_WriteCmd(<span class="hljs-number">0x81</span>); OLED_WriteCmd(<span class="hljs-number">0xCF</span>); <span class="hljs-comment">// Contrast</span>
    OLED_WriteCmd(<span class="hljs-number">0xA1</span>); <span class="hljs-comment">// Set Segment Re-map</span>
    OLED_WriteCmd(<span class="hljs-number">0xA6</span>); <span class="hljs-comment">// Normal Display</span>
    OLED_WriteCmd(<span class="hljs-number">0xA8</span>); OLED_WriteCmd(<span class="hljs-number">0x3F</span>); <span class="hljs-comment">// Multiplex Ratio</span>
    OLED_WriteCmd(<span class="hljs-number">0xAF</span>); <span class="hljs-comment">// Display On</span>
}

<span class="hljs-comment">// æ¸…å±</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">OLED_Clear</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">uint8_t</span> i, n;
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">8</span>;i++) {
        OLED_WriteCmd(<span class="hljs-number">0xB0</span> + i);
        OLED_WriteCmd(<span class="hljs-number">0x00</span>);
        OLED_WriteCmd(<span class="hljs-number">0x10</span>);
        <span class="hljs-keyword">for</span>(n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">128</span>;n++) OLED_WriteData(<span class="hljs-number">0x00</span>);
    }
}
</code></pre>
<h3 data-id="heading-106">5.3 é¡¹ç›®æ ¸å¿ƒä»£ç </h3>
<h4 data-id="heading-107">10. ä¸»å‡½æ•° (Main Loop)</h4>
<p>è¿™æ˜¯å¦‚ä½•è°ƒåº¦ä¸Šè¿°é©±åŠ¨çš„ç¤ºä¾‹ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// main.c ç¤ºä¾‹</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">uint8_t</span> t_in, h_in, t_out, h_out;
    <span class="hljs-type">uint16_t</span> light, sound;
    <span class="hljs-type">long</span> weight;
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">128</span>];

    System_Init_Config();
    I2C_GPIO_Config();
    ADC_Config();
    HX711_Init();
    USART2_Config(<span class="hljs-number">115200</span>); <span class="hljs-comment">// è¿æ¥ 4G/Wifi</span>
    
    OLED_Init();
    OLED_Clear();
    BH1750_Init();
    
    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) {
        <span class="hljs-comment">// 1. é‡‡é›†æ•°æ®</span>
        DHT11_Read_Data(GPIOA, <span class="hljs-number">4</span>, &amp;t_in, &amp;h_in);
        DHT11_Read_Data(GPIOA, <span class="hljs-number">5</span>, &amp;t_out, &amp;h_out);
        light = BH1750_Read();
        weight = HX711_Read() / <span class="hljs-number">100</span>; <span class="hljs-comment">// ç®€å•æ¯”ä¾‹æ¢ç®—ï¼Œå®é™…éœ€æ ¡å‡†å…¬å¼</span>
        sound = Get_Sound_Level();
        
        <span class="hljs-comment">// 2. å¤„ç†éœ‡åŠ¨ (PB0)</span>
        <span class="hljs-type">uint8_t</span> vib = (GPIOB-&gt;IDR &amp; <span class="hljs-number">1</span>);
        
        <span class="hljs-comment">// 3. æ ¼å¼åŒ–ä¸º JSON å­—ç¬¦ä¸² (éœ€è‡ªè¡Œå®ç° sprintf æˆ–å¼•ç”¨ stdio.h)</span>
        <span class="hljs-comment">// {"temp_in":25,"weight":1000...}</span>
        <span class="hljs-comment">// sprintf(buffer, "{\"temp_in\":%d, \"humi_in\":%d, \"weight\":%ld}\r\n", t_in, h_in, weight);</span>
        
        <span class="hljs-comment">// 4. é€šè¿‡ä¸²å£å‘é€ç»™é€šä¿¡æ¨¡å—</span>
        <span class="hljs-comment">// USART2_SendString(buffer);</span>
        
        <span class="hljs-comment">// 5. OLED æ˜¾ç¤º (éœ€é…åˆå­—åº“)</span>
        
        Delay_ms(<span class="hljs-number">1000</span>); <span class="hljs-comment">// 1ç§’é‡‡é›†ä¸€æ¬¡</span>
    }
}
</code></pre>
<ol>
<li><strong>å¤´æ–‡ä»¶åŒ…å«</strong>ï¼šæ‰€æœ‰ <code>.c</code> æ–‡ä»¶éƒ½éœ€è¦ <code>#include "stm32f10x.h"</code>ã€‚</li>
<li><strong>ä¸­æ–­å¤„ç†</strong>ï¼šå¦‚æœä½¿ç”¨ USART ä¸­æ–­ï¼Œè¯·ç¡®ä¿åœ¨å¯åŠ¨ä»£ç ï¼ˆ<code>.s</code> æ–‡ä»¶ï¼‰ä¸­æ²¡æœ‰æ³¨é‡Šæ‰ <code>USART2_IRQHandler</code>ï¼Œæˆ–è€…ä½ è‡ªå·±å®šä¹‰äº†å®ƒã€‚</li>
<li><strong>HX711 æ ¡å‡†</strong>ï¼šä»£ç ä¸­è¿”å›çš„æ˜¯åŸå§‹ ADC å€¼ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦å‡å»çš®é‡ï¼ˆç©ºè½½å€¼ï¼‰å¹¶é™¤ä»¥ç³»æ•°ï¼ˆGap Valueï¼‰æ‰èƒ½å¾—åˆ°å…‹æ•°ã€‚</li>
<li><strong>OLED å­—åº“</strong>ï¼šç”±äºç¯‡å¹…é™åˆ¶ï¼Œè¿™é‡Œæ²¡æœ‰æä¾› 8x16 çš„ç‚¹é˜µæ•°ç»„ï¼ˆ<code>F8X16[]</code>ï¼‰</li>
</ol>
<h3 data-id="heading-108">5.4 ç¨‹åºä¸‹è½½</h3>
<p><strong>ä¹Ÿæœ‰è§†é¢‘æ•™ç¨‹ï¼š</strong></p>
<p>è®²è§£å¦‚ä½•ç¼–è¯‘ä»£ç ï¼Œä¸‹è½½STM32ç¨‹åº: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1Cw4m1e7Yc" target="_blank" title="https://www.bilibili.com/video/BV1Cw4m1e7Yc" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1Cwâ€¦</a></p>
<p>æ‰“STM32çš„keilå·¥ç¨‹ï¼Œç¼–è¯‘ä»£ç ã€ç„¶åï¼Œä½¿ç”¨USBçº¿å°†å¼€å‘æ¿çš„å·¦è¾¹çš„USBå£(ä¸²å£1)ä¸ç”µè„‘çš„USBè¿æ¥ï¼Œæ‰“å¼€ç¨‹åºä¸‹è½½è½¯ä»¶ä¸‹è½½ç¨‹åºã€‚</p>
<p>å…·ä½“ä¸‹è½½è¿‡ç¨‹çœ‹ä¸‹é¢å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddf50cd0f9aa4dd48af9dc490902ef94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=kDI3oWqNCDfGW699cZMcde%2FsLYk%3D" alt="image-20240319223247836" loading="lazy"/></p>
<p>æ‰“å¼€ç¨‹åºä¸‹è½½è½¯ä»¶ï¼š[è½¯ä»¶å°±åœ¨èµ„æ–™åŒ…é‡Œçš„è½¯ä»¶å·¥å…·ç›®å½•ä¸‹]</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3570c4edcc9a499c8b2b19e7dc1406d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=XWULc9Z2pINX3oRx0eBS9NrKj4U%3D" alt="image-20240120160735942" loading="lazy"/></p>
<h3 data-id="heading-109">5.5 ç¨‹åºæ­£å¸¸è¿è¡Œæ•ˆæœ</h3>
<p>è®¾å¤‡è¿è¡Œè¿‡ç¨‹ä¸­ä¼šé€šè¿‡ä¸²å£æ‰“å°è°ƒè¯•ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸²å£æ‰“å°äº†è§£ç¨‹åºæ˜¯å¦æ­£å¸¸ã€‚</p>
<p>ç¨‹åºä¸‹è½½ä¹‹åï¼Œå¯ä»¥æ‰“å¼€ä¸²å£è°ƒè¯•åŠ©æ‰‹æŸ¥çœ‹ç¨‹åºè¿è¡Œçš„çŠ¶æ€ä¿¡æ¯ã€‚[è½¯ä»¶å°±åœ¨èµ„æ–™åŒ…é‡Œçš„è½¯ä»¶å·¥å…·ç›®å½•ä¸‹]</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fb0871e416d43b582bae9e23c0043b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=uLw11ofZ1jUkCsTdiUR5R9XRgmY%3D" alt="image-20240327212042050" loading="lazy"/></p>
<h3 data-id="heading-110">5.6 å–æ¨¡è½¯ä»¶çš„ä½¿ç”¨</h3>
<p>æ˜¾ç¤ºå±ä¸Šä¼šæ˜¾ç¤ºä¸­æ–‡ï¼Œå­—æ¯ï¼Œæ•°å­—ç­‰æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å–æ¨¡è½¯ä»¶è¿›è¡Œå–æ¨¡è®¾ç½®ã€‚</p>
<p>[è½¯ä»¶å°±åœ¨èµ„æ–™åŒ…é‡Œçš„è½¯ä»¶å·¥å…·ç›®å½•ä¸‹]</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/264aabedda2147ef8fba0c30f4176a2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=HQlUWF1XZinMvATYKRTTkm3SOtk%3D" alt="image-20241024142522970" loading="lazy"/></p>
<p><strong>æ‰“å¼€è½¯ä»¶ä¹‹åï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5e5e576eb4540fe83923f667a1ad34b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRFPlsI_pvpnlk6U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357411&amp;x-signature=Yv8DAfaDTMF970qyE6yENpZyFfY%3D" alt="image-20241127212320020" loading="lazy"/></p>
<h2 data-id="heading-111">å…­ã€æ€»ç»“</h2>
<p>æœ¬é¡¹ç›®æˆåŠŸè®¾è®¡å¹¶æ„å»ºäº†ä¸€å¥—åŸºäº STM32 ä¸åä¸ºäº‘å¹³å°çš„ç‰©è”ç½‘èœ‚ç®±æ™ºèƒ½ç›‘æµ‹ç³»ç»Ÿã€‚ç³»ç»Ÿä»¥ STM32F103C8T6 ä¸ºæ ¸å¿ƒæ§åˆ¶å•å…ƒï¼Œæœ‰æœºèåˆäº†å¤šç»´ä¼ æ„Ÿå™¨ç½‘ç»œï¼ˆæ¸©æ¹¿åº¦ã€é‡é‡ã€å£°éŸ³ã€éœ‡åŠ¨ã€å…‰ç…§ï¼‰ã€æ— çº¿é€šä¿¡æŠ€æœ¯ï¼ˆ4G/Wi-Fiï¼‰ä»¥åŠ Qt ä¸Šä½æœºå¯è§†åŒ–æŠ€æœ¯ï¼Œå®ç°äº†ä»æ•°æ®æ„ŸçŸ¥ã€è¾¹ç¼˜å¤„ç†ã€è¿œç¨‹ä¼ è¾“åˆ°äº‘ç«¯äº¤äº’çš„å®Œæ•´é—­ç¯ã€‚</p>
<p>é€šè¿‡æœ¬è®¾è®¡ï¼Œæœ‰æ•ˆè§£å†³äº†ä¼ ç»Ÿå…»èœ‚ä¸šä¸­ä¾èµ–äººå·¥å·¡æŸ¥ã€ç®¡ç†æ•ˆç‡ä½ä¸”æ˜“å¹²æ‰°èœ‚ç¾¤æ­£å¸¸ç”Ÿæ´»ç­‰æ ¸å¿ƒç—›ç‚¹ã€‚ç³»ç»Ÿä¸ä»…èƒ½å¤Ÿå…¨å¤©å€™å®æ—¶ç›‘æµ‹èœ‚ç®±çš„å†…å¤–ç¯å¢ƒä¸èœ‚ç¾¤æ´»åŠ›ï¼Œè¿˜èƒ½é€šè¿‡é‡é‡åˆ†æä¸éœ‡åŠ¨æ£€æµ‹åŠŸèƒ½ï¼Œå¯¹åˆ†èœ‚ã€èœ‚èœœæ»¡è½½ã€å¤©æ•Œå…¥ä¾µç­‰å¼‚å¸¸æƒ…å†µè¿›è¡ŒåŠæ—¶é¢„è­¦ã€‚è¿™ç§â€œéä¾µå…¥å¼â€çš„æ™ºèƒ½ç®¡ç†æ¨¡å¼ï¼Œå¤§å¹…é™ä½äº†å…»èœ‚äººçš„åŠ³åŠ¨å¼ºåº¦ï¼Œä¸ºèœ‚ç¾¤å¥åº·ç¹è‚²å’Œèœ‚èœœå¢äº§æä¾›äº†ç§‘å­¦ã€å®¢è§‚çš„æ•°æ®æ”¯æ’‘ã€‚æ€»ä½“è€Œè¨€ï¼Œæœ¬ç³»ç»Ÿç¡¬ä»¶æˆæœ¬å¯æ§ã€åŠŸèƒ½å®ç”¨ä¸”è¿è¡Œç¨³å®šï¼Œå……åˆ†éªŒè¯äº†ç‰©è”ç½‘æŠ€æœ¯åœ¨æ™ºæ…§å†œä¸šç»†åˆ†é¢†åŸŸçš„åº”ç”¨æ½œåŠ›å’Œå®ç”¨ä»·å€¼ï¼Œå…·æœ‰è‰¯å¥½çš„æ¨å¹¿å‰æ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™ ArkUI ä»é›¶åˆ°ç²¾é€šï¼šåŸºç¡€è¯­æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7578902814022565903</link>    <guid>https://juejin.cn/post/7578902814022565903</guid>    <pubDate>2025-12-02T07:21:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578902814022565903" data-draft-id="7576573061580537897" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™ ArkUI ä»é›¶åˆ°ç²¾é€šï¼šåŸºç¡€è¯­æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,HarmonyOS,Android"/> <meta itemprop="datePublished" content="2025-12-02T07:21:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="hqk"/> <meta itemprop="url" content="https://juejin.cn/user/2357827986264942"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™ ArkUI ä»é›¶åˆ°ç²¾é€šï¼šåŸºç¡€è¯­æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2357827986264942/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    hqk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T07:21:01.000Z" title="Tue Dec 02 2025 07:21:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    81
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å‚ä¸äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2F7e230b074eaa41c587c71c1d1a9a6514%3Ftype%3D1%3Fha_source%3Dhmosclass%26ha_sourceId%3D89000248" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/7e230b074eaa41c587c71c1d1a9a6514?type=1?ha_source=hmosclass&amp;ha_sourceId=89000248" ref="nofollow noopener noreferrer">åä¸ºå®˜æ–¹æ´»åŠ¨ï¼šHarmonyOSèµ‹èƒ½èµ„æºä¸°å¯Œåº¦å»ºè®¾</a></p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œè®²è§£äº†<a href="https://juejin.cn/post/7576057623742464042" target="_blank" title="https://juejin.cn/post/7576057623742464042">é¸¿è’™ArkTSåŸºç¡€è¯­æ³•</a> ï¼Œæœ¬ç¯‡å°†ä¼šè®²è§£ArkUIç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚</p>
<h2 data-id="heading-1">1ã€ArkUIä»‹ç»</h2>
<p>ArkUIï¼šAbility kitåœ¨UIAbilityç»„ä»¶å¯ä»¥ä½¿ç”¨ArkUIæä¾›çš„ç»„ä»¶ï¼Œäº‹ä»¶ï¼ŒåŠ¨æ•ˆï¼ŒçŠ¶æ€ç®¡ç†ç­‰èƒ½åŠ›ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ArkUIçš„<strong>åŸºæœ¬ç»“æ„</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e560ee37da674992bb5494d5a118bb90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=nU4FDMOuUgaWoUoK8kUB9dGC9Js%3D" alt="QQ_1764139591463.png" loading="lazy"/>
å¦‚å›¾æ‰€ç¤ºï¼š</p>
<ul>
<li>
<p>ArkUIåŸºæœ¬ç»“æ„åŒ…å«ï¼š<strong>è£…é¥°å™¨</strong>ã€<strong>è‡ªå®šä¹‰ç»„ä»¶</strong>ã€<strong>ç³»ç»Ÿç»„ä»¶</strong>ã€ä»¥åŠç»„ä»¶å†…ä¸€ç³»åˆ—<strong>å±æ€§æ–¹æ³•ä¸äº‹ä»¶æ–¹æ³•</strong>ç­‰</p>
</li>
<li>
<p>è£…é¥°å™¨ï¼šç”¨äºè£…é¥°ç±»ã€ç»“æ„ã€æ–¹æ³•ä»¥åŠå˜é‡ï¼Œå¹¶èµ‹äºˆå¯¹åº”çš„å«ä¹‰ã€‚å¦‚ä¸Šå›¾æ‰€ç¤º<code>@Entry</code>ã€<code>@Component</code>å’Œ<code>@State</code>éƒ½æ˜¯è£…é¥°å™¨</p>
<ul>
<li><code>@Entry</code>ï¼šè¡¨ç¤ºè¯¥è‡ªå®šä¹‰ç»„ä»¶ä¸ºå…¥å£ç»„ä»·</li>
<li><code>@Component</code>ï¼šè¡¨ç¤ºè‡ªå®šä¹‰ç»„ä»¶</li>
<li><code>@State</code>ï¼šè¡¨ç¤ºç»„ä»¶ä¸­çš„çŠ¶æ€å˜é‡ï¼ŒçŠ¶æ€å˜é‡å˜åŒ–ä¼šè§¦å‘UIåˆ·æ–°</li>
</ul>
</li>
<li>
<p>UIæè¿°ï¼šä»¥å£°æ˜å¼çš„æ–¹æ³•æ¥æè¿°UIçš„ç»“æ„ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º build()æ–¹æ³•ä¸­çš„ä»£ç å—</p>
</li>
<li>
<p>è‡ªå®šä¹‰ç»„ä»¶ï¼šå¯å¤ç”¨çš„UIæ¨¡å—ï¼Œå¯ç»„åˆå…¶ä»–ç»„ä»¶ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºè¢«<code>@Component</code>ä¿®é¥°çš„<code>struct Page4</code></p>
</li>
<li>
<p>å±æ€§æ–¹æ³•ï¼šç»„ä»¶å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨å¯¹åº”ç»„ä»¶çš„å¤šé¡¹å±æ€§æ–¹æ³•ï¼Œå¦‚<code>id()</code>ã€<code>width()</code>ã€<code>fontSize()</code>ç­‰</p>
</li>
<li>
<p>äº‹ä»¶æ–¹æ³•ï¼šç»„ä»¶å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨è®¾ç½®å¤šä¸ªäº‹ä»¶çš„å“åº”é€»è¾‘ï¼Œå¦‚<code>onClick()</code></p>
</li>
</ul>
<p>å½“æˆ‘ä»¬æŒæ¡äº† ArkUI çš„åŸºæœ¬ç»“æ„åï¼Œä¼šå‘ç° <strong>UIçš„æœ€ç»ˆå‘ˆç°å…¶å®æ˜¯ç”±ä¸€ä¸ªä¸ªç»„ä»¶æ‹¼èµ·æ¥çš„</strong>ã€‚</p>
<p>æ‰€ä»¥åœ¨ç†è§£â€œæ¡†æ¶æ€ä¹ˆç»„ç»‡ UIâ€ä¹‹åï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥å°±éœ€è¦å¼„æ¸…æ¥šï¼šâ€œçœŸæ­£æ„æˆ UI çš„é‚£äº›ç»„ä»¶æœ‰å“ªäº›ï¼Ÿå®ƒä»¬å„è‡ªæ€ä¹ˆç”¨ï¼Ÿâ€</p>
<p>å› æ­¤ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ­£å¼è¿›å…¥ArkUIçš„ç»„ä»¶å­¦ä¹ éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ç³»åˆ—å°æ¡ˆä¾‹ç”±æµ…å…¥æ·±é€æ­¥å¯¹ArkUIè¿›è¡Œè®²è§£ã€‚</p>
<h2 data-id="heading-2">2ã€ArkUIç»„ä»¶è®²è§£</h2>
<p>ArkUIç³»ç»Ÿç»„ä»¶åˆåˆ†ä¸ºï¼šå®¹å™¨ç»„ä»¶ã€åŸºç¡€ç»„ä»¶ã€‚</p>
<h3 data-id="heading-3">2.1 å®¹å™¨ç»„ä»¶</h3>
<p>å®¹å™¨ç»„ä»¶é¡¾åæ€ä¹‰ç±»ä¼¼äºä¸€ä¸ªå®¹å™¨ä¸€æ ·ï¼Œå¯ä»¥è£…ä¸‹ä¸åŒçš„ç»„ä»¶ã€‚é‚£è¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿé‚£ä¹ˆå°±è¿æ¥äº†ç¬¬ä¸€ä¸ªå®¹å™¨ç»„ä»¶<code>Row</code></p>
<h4 data-id="heading-4">2.1.1 Rowå®¹å™¨ç»„ä»¶</h4>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªå°æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct Index {
  build() {
    Row({space: 20}){
      Text("å­—ç¬¦ä¸²1").width(100).height(100).backgroundColor(Color.Pink)
      Text("å­—ç¬¦ä¸²2").width(100).height(100).backgroundColor(Color.Red)
      Text("å­—ç¬¦ä¸²3").width(100).height(100).backgroundColor(Color.Blue).fontColor(Color.White)
    }
    .width('100%')
    .height('100%')
    .border({color:Color.Red, style: BorderStyle.Dashed, width:1})
    .backgroundColor(Color.Yellow)
    .justifyContent(FlexAlign.SpaceEvenly)
    .alignItems(VerticalAlign.Center)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœå›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13275a67886448468d15e47ccd980afc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=bVZbHj9JVBoUoZYYPRZprAJKuD8%3D" alt="QQ_1764225287496.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li><code>Row{}</code>é‡Œé¢åŒ…å«äº†ä¸‰ä¸ªç»„ä»¶ï¼Œå¹¶ä¸”è¿™ä¸‰ä¸ªç»„ä»¶æ˜¯æ°´å¹³æ’åˆ—</li>
<li><code>Row{}</code>è®¾ç½®äº†ä¸åŒçš„å±æ€§
<ul>
<li><code>{space: 20}</code>è¡¨ç¤ºå®¹å™¨å†…ç»„ä»¶ä¹‹é—´çš„é—´è·ä¸º<code>20vp</code>ï¼Œè¿™ä¸ª<code>vp</code>å°±å¥½æ¯”<code>Android</code>é‡Œé¢çš„<code>dp</code>å•ä½</li>
<li><code>.width('100%').height('100%')</code>ï¼Œè¡¨ç¤ºå®½é«˜éƒ½æ˜¯100%ï¼Œå……æ»¡æ•´ä¸ªå±å¹•</li>
<li><code>border({color:Color.Red, style: BorderStyle.Dashed, width:1})</code>ç»™è¿™ä¸ª<code>Row</code>ç»„ä»¶è®¾ç½®äº†è¾¹æ¡†ä»¥åŠè¾¹æ¡†å±æ€§</li>
<li><code>.justifyContent(FlexAlign.SpaceEvenly)</code>ç»™è¿™ä¸ª<code>Row</code>ç»„ä»¶è®¾ç½®äº†<strong>æ°´å¹³å¯¹é½æ–¹å¼ï¼Œè¿™ä¸ªå±æ€§æ–¹æ³•å®ƒå’Œè¿™ä¸ª<code>Row{}</code>ç»„ä»¶æ˜¯åŒä¸€ç§å¯¹é½æ–¹å‘</strong></li>
<li><code>.alignItems(VerticalAlign.Center)</code>ç»™è¿™ä¸ª<code>Row</code>ç»„ä»¶è®¾ç½®äº†<strong>å‚ç›´å¯¹é½æ–¹å¼ï¼Œè¿™ä¸ªå±æ€§æ–¹æ³•å®ƒå’Œè¿™ä¸ª<code>Row{}</code>ç»„ä»¶æ˜¯ç›¸åçš„å¯¹é½æ–¹å‘</strong></li>
</ul>
</li>
</ul>
<p>çœ‹åˆ°è¿™æ˜¯ä¸æ˜¯ä¼šæƒ³ï¼šé‚£æˆ‘å’‹çŸ¥é“è¿™äº›ç»„ä»¶æœ‰å“ªäº›æ–¹æ³•ï¼Ÿç„¶åè¿™äº›æ–¹æ³•åˆè¯¥å¦‚ä½•èµ‹å€¼å‘¢ï¼Ÿä¸å¯èƒ½æ¯ä¸ªç»„ä»¶æˆ‘éƒ½è¦å»æ­»è®°ç¡¬èƒŒæ¶©ï¼</p>
<h5 data-id="heading-5">2.1.1.1 æºç å‰–æ</h5>
<p>æ‰€è°“çš„æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ï¼æˆ‘è¿™å°†ä¸€æ­¥ä¸€æ­¥çš„å¸¦ä½ å»å‰–ææºç ï¼Œå°±ç®—ä»¥åé‡åˆ°é™Œç”Ÿç»„ä»¶ä¹Ÿèƒ½è®©ä½ æ›´å¿«çš„ç†Ÿæ‚‰å¹¶ä½¿ç”¨å®ƒï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0c1bd004395473ca6adaa0d889ac683~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=4H%2FytptMfQrn%2B1cjoC0vuBe6f6w%3D" alt="QQ_1764227796785.png" loading="lazy"/></p>
<p><strong>å¦‚å›¾æ‰€ç¤º</strong></p>
<p>æŒ‰ä½<code>Ctrl</code>+é¼ æ ‡å·¦é”®ç‚¹å‡»<code>Row</code>ï¼Œä½ å°†ä¼šçœ‹åˆ°è¿™æ ·çš„ä»£ç </p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Row</span>: RowInterface;
</code></pre>
<p>ç»§ç»­æŒ‰ä½<code>Ctrl</code>+é¼ æ ‡å·¦é”®ç‚¹å‡»<code>RowInterface</code>ï¼Œå°†ä¼šæ˜¯å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-css" lang="css">interface RowInterface {
    (value?: {
        space?: string | number;
    }): RowAttribute;
}
</code></pre>
<p>è¿™é‡Œåªçœ‹åˆ°åˆšåˆš <code>Row({space: 20})</code>è¿™å¥ä»£ç çš„ä½¿ç”¨æ–¹å¼</p>
<ul>
<li><code>value? </code> æœ‰<code>?</code>ä¿®é¥°è¯´æ˜äº†è¿™ä¸ªvalueå¯ä¸ºç©ºï¼Œè€Œè¿™ä¸ªå€¼çš„ç±»å‹æ˜¯ <code>{space?: string | number;}</code>è¿™æ ·çš„ç»“æ„ä½“</li>
<li><code>{space?: string | number;}</code>è¿™æ ·çš„ç»“æ„ä½“é‡Œé¢åªæœ‰<code>space?</code>å˜é‡ï¼Œè€Œä¸”è¿™ä¸ªå˜é‡ä¹Ÿæœ‰<code>?</code>ä¿®é¥°ï¼Œè¯´æ˜äº†è¿™ä¸ª<code>space</code>ä¹Ÿå¯ä¸ºç©ºï¼Œè€Œè¿™ä¸ªå€¼ç±»å‹æ˜¯<code>string | number</code>ï¼Œè¯´æ˜äº†ï¼Œå¦‚æœå€¼ä¸ä¸ºç©ºçš„è¯ï¼Œé‚£ä¹ˆ<code>space</code>è¦ä¹ˆæ˜¯<code>string</code>è¦ä¹ˆæ˜¯ <code>number</code></li>
</ul>
<p>æ‰€ä»¥åœ¨ä½¿ç”¨<code>Row</code>ç»„ä»¶æ—¶ï¼Œæ„é€ æ–¹æ³•é‡Œé¢å¯ä»¥ä¼ <code>{space?: string | number;}</code> è¿™æ ·çš„ç»“æ„ä½“</p>
<p>ç„¶è€Œè¿™é‡Œæ²¡çœ‹åˆ°æƒ³è¦çš„å±æ€§æ–¹æ³•ï¼Œç»§ç»­å¾€ä¸‹çœ‹ï¼ŒæŒ‰ä½<code>Ctrl</code>+é¼ æ ‡å·¦é”®ç‚¹å‡»<code>RowAttribute</code>ï¼Œå°†ä¼šæ˜¯å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-scala" lang="scala">declare <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RowAttribute</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CommonMethod&lt;RowAttribute&gt;</span> </span>{

 <span class="hljs-comment">//Called when the vertical alignment is set.</span>
 alignItems(value: <span class="hljs-type">VerticalAlign</span>): <span class="hljs-type">RowAttribute</span>;
 
 <span class="hljs-comment">//Called when the horizontal alignment is set.</span>
 justifyContent(value: <span class="hljs-type">FlexAlign</span>): <span class="hljs-type">RowAttribute</span>;

 reverse(isReversed: <span class="hljs-type">Optional</span>&lt;boolean&gt;): <span class="hljs-type">RowAttribute</span>;
 
}
</code></pre>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°<code>Row</code>ç»„ä»¶ç‰¹æœ‰çš„å±æ€§<code>alignItems</code>ã€<code>justifyContent</code>ã€<code>reverse</code>ï¼Œå¯¹åº”å±æ€§æ–¹æ³•çš„å€¼èŒƒå›´ï¼Œå¯ä»¥ç»§ç»­æŒ‰ç…§åˆšåˆšçš„æ–¹å¼å¾€ä¸‹çœ‹</p>
<p>ä¸è¿‡åœ¨è¿™é‡Œé¢æˆ‘ä»¬å°±åªçœ‹åˆ°è¿™ä¸‰ä¸ªå±æ€§æ–¹æ³•ï¼Œä¸Šé¢æ¡ˆä¾‹é‡Œçš„<code>width</code>ä»¥åŠå…¶ä»–çš„å±æ€§æ–¹æ³•å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬çœ‹åˆ°<code>class RowAttribute extends CommonMethod&lt;RowAttribute&gt;</code>è¿™å¥ä»£ç ï¼Œ<a href="https://juejin.cn/post/7576057623742464042" target="_blank" title="https://juejin.cn/post/7576057623742464042">åœ¨ä¸Šä¸€ç¯‡åŸºç¡€è¯­æ³•ä¸­</a>ï¼Œè®²è§£äº†è¿™æ˜¯ç»§æ‰¿å…³ç³»ï¼Œä¹Ÿå°±æ˜¯<code>RowAttribute</code>æ‹¥æœ‰äº†<code>CommonMethod</code>æ‰€æœ‰éç§æœ‰çš„å±æ€§ä»¥åŠæ–¹æ³•</p>
<p>é‚£ç»§ç»­æŒ‰ä½<code>Ctrl</code>+é¼ æ ‡å·¦é”®ç‚¹å‡»<code>CommonMethod</code>ï¼Œå°†ä¼šæ˜¯å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">declare class CommonMethod&lt;T&gt; {
  <span class="hljs-comment">//....çœç•¥éƒ¨åˆ†ä»£ç </span>
  <span class="hljs-attribute">width</span>(value: Length): T;
  
  <span class="hljs-attribute">height</span>(value: Length): T;
  
  <span class="hljs-attribute">padding</span>(value: Padding | Length | LocalizedPadding): T
  
  <span class="hljs-built_in">background</span>(builder: CustomBuilder, options?: {
    align?: Alignment;
  }): T;
  
  <span class="hljs-attribute">border</span>(value: BorderOptions): T;
  
  <span class="hljs-built_in">backgroundColor</span>(value: ResourceColor): T;
 <span class="hljs-comment">//....çœç•¥éƒ¨åˆ†ä»£ç </span>

</code></pre>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬å°±çœ‹åˆ°äº†æˆ‘ä»¬æ¡ˆä¾‹ä¸Šä½¿ç”¨çš„æ‰€æœ‰å±æ€§æ–¹æ³•äº†ã€‚è¿™é‡Œå¯ä»¥æ€»ç»“å‡ºï¼š<strong>ç»„ä»¶éƒ½æœ‰å®ƒè‡ªå·±ç‹¬æœ‰çš„å±æ€§ï¼Œå¹¶ä¸”éç‹¬æœ‰ï¼ˆå…¬å…±ï¼‰å±æ€§é€šè¿‡<code>extends CommonMethod&lt;T&gt;</code> æ–¹å¼è·å¾—</strong></p>
<p>è¿™é‡Œæˆ‘ä»¬ç†Ÿæ‚‰äº†<code>Row</code>ç»„ä»¶ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªç»„ä»¶</p>
<h4 data-id="heading-6">2.1.2 Columnå®¹å™¨ç»„ä»¶</h4>
<p>æˆ‘ä»¬æ¥ç€æ¥çœ‹æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct ColumnPage {
  build() {
    Column({space: 20}){
      Row().width(100).height(100).backgroundColor(Color.Pink)
      Row().width(100).height(100).backgroundColor(Color.Yellow)
      Row().width(100).height(100).backgroundColor(Color.Blue)
      Row().width(100).height(100).backgroundColor(Color.Green)
    }
    .width('100%')
    .height('100%')
    .backgroundColor(Color.Gray)
    .justifyContent(FlexAlign.SpaceEvenly)
    .alignItems(HorizontalAlign.End)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœå›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1c37862201240e39994c5a5fe5689d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=Dyxm3zjv5xldepi0%2BqqutBsPskc%3D" alt="QQ_1764230669769.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li><code>Column{}</code>é‡Œé¢åŒ…å«äº†å››ä¸ªç»„ä»¶ï¼Œå¹¶ä¸”è¿™å››ä¸ªç»„ä»¶æ˜¯å‚ç›´æ’åˆ—</li>
<li><code>.justifyContent(FlexAlign.SpaceEvenly)</code>ç»™è¿™ä¸ª<code>Column</code>ç»„ä»¶è®¾ç½®äº†<strong>å‚ç›´å¯¹é½æ–¹å¼ï¼Œè¿™ä¸ªå±æ€§æ–¹æ³•å®ƒå’Œè¿™ä¸ª<code>Column{}</code>ç»„ä»¶æ˜¯åŒä¸€ç§å¯¹é½æ–¹å‘</strong></li>
<li><code>.alignItems(HorizontalAlign.End)</code>ç»™è¿™ä¸ª<code>Column</code>ç»„ä»¶è®¾ç½®äº†<strong>æ°´å¹³å¯¹é½æ–¹å¼ï¼Œè¿™ä¸ªå±æ€§æ–¹æ³•å®ƒå’Œè¿™ä¸ª<code>Column{}</code>ç»„ä»¶æ˜¯ç›¸åçš„å¯¹é½æ–¹å‘</strong></li>
</ul>
<p>è¿™ä¸ª<code>Column</code>åˆ—ç»„ä»¶ä¸<code>Row</code>è¡Œç»„ä»¶æ˜¯ç›¸åçš„ï¼Œç‰¹åˆ«æ³¨æ„<code>Column</code>çš„<code>.alignItems(HorizontalAlign.End)</code>å±æ€§æ–¹æ³•é‡Œé¢æ˜¯<code>HorizontalAlign</code>ï¼Œè€Œ<code>Row</code>çš„<code>.alignItems(VerticalAlign.Center)</code>æ˜¯<code>VerticalAlign</code>ã€‚</p>
<p>OKï¼Œæˆ‘ä»¬ç»§ç»­ä¸‹ä¸€ä¸ªç»„ä»¶ï¼</p>
<h4 data-id="heading-7">2.1.3 Flexå®¹å™¨ç»„ä»¶</h4>
<p>Flexï¼ˆå¼¹æ€§ç»„ä»¶ï¼‰æä¾›æ›´åŠ æœ‰æ•ˆçš„æ–¹å¼å¯¹å®¹å™¨ä¸­çš„å­å…ƒç´ è¿›è¡Œæ’åˆ—ã€å¯¹é½å’Œåˆ†é…å‰©ä½™ç©ºé—´ã€‚</p>
<p>å®¹å™¨é»˜è®¤å­˜åœ¨ä¸»è½´ä¸äº¤å‰è½´ï¼Œå­å…ƒç´ é»˜è®¤æ²¿ä¸»è½´æ’åˆ—ï¼Œå­å…ƒç´ åœ¨ä¸»è½´æ–¹å‘çš„å°ºå¯¸ç§°ä¸ºä¸»è½´å°ºå¯¸ï¼Œåœ¨äº¤å‰è½´æ–¹å‘çš„å°ºå¯¸ç§°ä¸ºäº¤å‰è½´å°ºå¯¸ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aad9cc84edce4ba69e71cf54f60f51fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=vIrfiyASuH2vtI4rc27vCY4upfc%3D" alt="0000000000011111111.20250314163923.55033350674177624945588898470143.png" loading="lazy"/></p>
<p>æ—¢ç„¶<code>Flex</code>å®¹å™¨å¯ä»¥æ”¹å˜å­å…ƒç´ åœ¨ä¸»è½´ä¸äº¤å‰è½´æ’åˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¤åˆ»<code>Row</code>ç»„ä»¶ä»¥åŠ<code>Column</code>ç»„ä»¶</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>å½“Flexå®¹å™¨ä¸º<code>Row</code>ã€<code>RowReverse</code>æ’åˆ—æ—¶ï¼Œä¸»è½´ä¸äº¤å‰è½´å°±ä¸ºå›¾ä¸­æ‰€ç¤ºï¼›</li>
<li>å½“Flexå®¹å™¨ä¸º<code>Column</code>ã€<code>ColumnReverse</code>æ’åˆ—æ—¶ï¼Œå›¾ä¸­çš„ä¸»è½´å˜äº¤å‰è½´ï¼Œäº¤å‰è½´å˜ä¸»è½´</li>
</ul>
<h5 data-id="heading-8">2.1.3.1 å¤åˆ»Rowç»„ä»¶</h5>
<pre><code class="hljs language-ArkTS" lang="ArkTS">import { LengthMetrics } from '@kit.ArkUI';

@Entry
@Component
struct FlexiblePage {
  build() {
    Flex({
      direction: FlexDirection.Row,
      justifyContent: FlexAlign.Start,
      alignItems: ItemAlign.Start,
      wrap: FlexWrap.NoWrap,
      space: { main: LengthMetrics.vp(20), cross: LengthMetrics.vp(30) }
    }) {
      Column().width(100).height(200).backgroundColor(Color.Pink)
      Column().width(100).height(200).backgroundColor(Color.Red)
      Column().width(100).height(200).backgroundColor(Color.Blue)

      Column().width(100).height(200).backgroundColor(Color.White)
      Column().width(100).height(200).backgroundColor(Color.Green)
      Column().width(100).height(200).backgroundColor(Color.Orange)
    }
    .margin({ top: 10 })
    .width('100%')
    .height('100%')
    .backgroundColor(Color.Gray)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœå›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2851334b2c614cf08377cd6b9189054b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=jISBMKCUzHU9cZP%2FEVhCPsJzO6g%3D" alt="QQ_1764233341962.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­</p>
<ul>
<li>ä½¿ç”¨<code>direction: FlexDirection.Row</code>è®©<code>Flex</code>ç»„ä»¶æˆåŠŸå¤åˆ»äº†<code>Row</code>ç»„ä»¶ç‰¹æ€§</li>
<li>å½“ç„¶<code>justifyContent</code>ä¸<code>alignItems</code>ä¹Ÿå…·å¤‡äº†<code>Row</code>ç»„ä»¶ç‰¹æ€§</li>
</ul>
<p>åˆšåˆšå¤åˆ»äº†<code>Row</code>ç»„ä»¶ï¼Œæ¥è¯•è¯•å¤åˆ»<code>Column</code>ç»„ä»¶</p>
<h5 data-id="heading-9">2.1.3.2 å¤åˆ»Columnç»„ä»¶</h5>
<pre><code class="hljs language-ArkTS" lang="ArkTS">import { LengthMetrics } from '@kit.ArkUI';

@Entry
@Component
struct FlexiblePage {
  build() {
   å¤åˆ»äº†`Column`ç»„ä»¶
   - ({
      direction: FlexDirection.Column,
      justifyContent: FlexAlign.Start,
      alignItems: ItemAlign.Start,
      wrap: FlexWrap.NoWrap,
      space: { main: LengthMetrics.vp(20), cross: LengthMetrics.vp(30) }
    }) {
      Column().width(100).height(200).backgroundColor(Color.Pink)
      Column().width(100).height(200).backgroundColor(Color.Red)
      Column().width(100).height(200).backgroundColor(Color.Blue)

      Column().width(100).height(200).backgroundColor(Color.White)
      Column().width(100).height(200).backgroundColor(Color.Green)
      Column().width(100).height(200).backgroundColor(Color.Orange)
    }
    .margin({ top: 10 })
    .width('100%')
    .height('100%')
    .backgroundColor(Color.Gray)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7cb176a192d4eaebae0ee1155eef561~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=x7GZLv2GNknfEgPYO2ZHT%2B2Mm44%3D" alt="QQ_1764235343899.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­</p>
<ul>
<li>ä»…ä»…æ”¹å˜äº†<code>direction</code>çš„å€¼ï¼ŒæˆåŠŸçš„å¤åˆ»äº†<code>Column</code>ç»„ä»¶</li>
<li>å¯¹åº”<code>justifyContent</code>ä¸<code>alignItems</code>ä¹Ÿå…·å¤‡äº†<code>Column</code>ç»„ä»¶ç‰¹æ€§</li>
<li>æ¡ˆä¾‹é‡Œé¢<code>wrap</code>è¡¨ç¤ºæ˜¯å¦å¤šè¡Œï¼Œ<code>NoWrap</code>ä¹Ÿå°±æ˜¯ä¸å…è®¸ï¼Œè¯»è€…å¯ä»¥è‡ªè¡Œæµ‹è¯•å¤šè¡Œæ•ˆæœï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°</li>
<li><code>space</code> è®¾ç½®å…ƒç´ ä¹‹é—´çš„é—´è·ã€‚<code>main</code>ä¸»è½´å…ƒç´ ä¹‹é—´é—´è·ï¼›<code>cross</code>äº¤å‰è½´ä¹‹é—´çš„é—´è·ï¼ˆæ³¨æ„ä¸åŒçš„<code>direction</code>çš„å€¼ï¼Œä¸»è½´ã€äº¤å‰è½´ä¸åŒå“Ÿï¼‰</li>
</ul>
<p>OKï¼Œæˆ‘ä»¬ç»§ç»­ä¸‹ä¸€ä¸ªï¼</p>
<h4 data-id="heading-10">2.2.4 Stackå®¹å™¨ç»„ä»¶</h4>
<p>Stackæ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct StackPage {
  @State message: string = 'Hello World';

  build() {
    Stack({alignContent: Alignment.Center}) {
      Column().width('90%').height('90%').backgroundColor(Color.Pink).zIndex(1)
      Column().width('50').height('50').backgroundColor(Color.Blue).zIndex(3)
      Column().width('150').height('150').backgroundColor(Color.Green).zIndex(2)
    }
    .height('100%')
    .width('100%')
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f335b15f71149a89ffdbbfdebf4c707~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=M80Dbzt06dpS1IeEO4vvmgmt%2FJQ%3D" alt="QQ_1764237543527.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li>æœ‰ä¸‰ä¸ªå¤§å°ä¸ä¸€çš„å…ƒç´ åœ¨é‡Œé¢é€šè¿‡<code>{alignContent: Alignment.Center}</code>å®ç°äº†æ‰€æœ‰å…ƒç´ å±…ä¸­å¯¹é½ã€‚ï¼ˆä¸€å…±æœ‰9ä¸­å¯¹é½æ–¹å¼ï¼Œè¯»è€…å¯ä»¥äº²è‡ªå°è¯•ï¼‰</li>
<li><code>.zIndex(1)</code>é€šè¿‡è¿™ä¸ªå±æ€§æ–¹æ³•è®¾ç½® å±‚çº§çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ï¼Œå±‚çº§è¶Šé å‰ã€‚<strong>å¯ä»¥å°†è¿™ä¸ªç†è§£ä¸ºå¨æˆ¿å ç›˜å­ï¼Œæ•°å­—è¶Šå¤§ç›˜å­å°±è¶Šä¸Šé¢ï¼Œå¦‚æœä¸Šé¢çš„ç›˜å­æ¯”ä¸‹é¢çš„å¤§ï¼Œé‚£å°±çœ‹ä¸åˆ°ä¸‹é¢çš„ç›˜å­</strong></li>
</ul>
<p>è¿™ä¸ªæ²¡ä»€ä¹ˆéš¾åº¦ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªï¼</p>
<h4 data-id="heading-11">2.2.5 Gridå®¹å™¨ç»„ä»¶</h4>
<h5 data-id="heading-12">2.2.5.1 Gridæ¡ˆä¾‹ä¸€</h5>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct GridPage {
  build() {
    Grid() {
      GridItem() {
        Row() {
          Column() {
            Text('å•†å“åç§°')
          }
          .width('100%')
        }
      }.width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
      GridItem().width("100%").height(100).backgroundColor(Color.Gray)
    }
    .height('100%')
    .width('100%')
    .columnsTemplate('1fr 1fr 1fr 1fr')
    .rowsGap(10)
    .columnsGap(10)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4067eb34d8e04e6e848e8186d5577dfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=F5CtdVf49KWIXgfwW1P5N1q7Twg%3D" alt="QQ_1764299740119.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li><code>Grid</code>ç»„ä»¶éœ€è¦ç»“åˆ<code>GridItem</code>ç»„ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªç»„ä»¶éƒ½æ˜¯å®¹å™¨ç»„ä»¶ã€‚</li>
<li><code>.columnsTemplate('1fr 1fr 1fr 1fr')</code>å±æ€§æ–¹æ³•è¡¨ç¤ºè¯¥<code>Grid</code>ç»„ä»¶åˆ†ä¸ºå‡ åˆ—æ•°æ®ï¼Œå…¶ä¸­çš„<code>1fr</code>è¡¨ç¤ºè¯¥åˆ—æƒé‡å æ¯”</li>
<li><code>rowsGap</code>ä¸<code>columnsGap</code>åˆ†åˆ«è¡¨ç¤ºè®¾ç½® è¡Œé—´è·ä»¥åŠåˆ—é—´è·</li>
</ul>
<p>é‚£ç°åœ¨é—®é¢˜æ¥äº†ï¼Œæ¡ˆä¾‹ä¸€çš„<code>GridItem</code>ç»„ä»¶å°±ä»…ä»…ç¬¬ä¸€ä¸ªæ·»åŠ äº†åŸºæœ¬ç»„ä»¶ï¼Œè€Œä¸”è¿˜ä»…ä»…åªæ˜¯ä¸€ä¸ª<code>Text</code>ç»„ä»¶ï¼Œç»“æ„å±‚æ¬¡å°±å·²ç»æ¯”è¾ƒå¤šäº†ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœ<code>Item</code>å†…å®¹å†å¤æ‚ä¸€ç‚¹ï¼Œé‚£ä»£ç å²‚ä¸æ˜¯å¾ˆå†—ä½™ï¼Ÿ</p>
<p>å¸¦ç€è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä¸€ä¸ªæ¡ˆä¾‹ï¼š</p>
<h5 data-id="heading-13">2.2.5.2 Gridæ¡ˆä¾‹äºŒ</h5>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct GridPage {
  build() {
    Grid() {
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
      GirdItemComponent()
    }
    .height('100%')
    .width('100%')
    .columnsTemplate('1fr 1fr 1fr 1fr')
    .rowsGap(10)
    .columnsGap(10)
  }
}

@Component
struct GirdItemComponent {
  build() {
    GridItem() {
      Row() {
        Column() {
          Text('å•†å“åç§°')
        }.width('100%')
      }.height(100)
    }.borderRadius(4)
    .backgroundColor(Color.Pink)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e1ea64e4f5742c89114d70e0349aa96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=C5wNu3IAxLlCQ83TredRUvOZss4%3D" alt="QQ_1764300613985.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li>æˆ‘ä»¬å°†<code>GridItem</code>æ”¾åœ¨äº†æ–°çš„<code>struct GirdItemComponent</code>é‡Œé¢ï¼Œå¹¶ä¸”ç”¨<code>@Component</code>ä¿®é¥°ï¼Œæ­¤æ—¶<code>GirdItemComponent</code>å·²ç»è¢«æˆ‘ä»¬å°è£…æˆäº†<strong>è‡ªå®šä¹‰ç»„ä»¶</strong></li>
</ul>
<p>ä¸è¿‡ç°åœ¨è¿˜æœ‰ä¸ªé—®é¢˜ï¼š<code>GirdItemComponent()</code>æ•°é‡ç›®å‰æ˜¯ä»£ç å†™æ­»çš„ï¼Œå¦‚ä½•é€šè¿‡æ•°æ®æºåŠ¨æ€æ¸²æŸ“å‘¢ï¼Ÿ</p>
<h5 data-id="heading-14">2.2.5.3 Gridæ¡ˆä¾‹ä¸‰</h5>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct GridPage {
  listData:Array&lt;number&gt;=[1,2,3,4,5,6,7,8,9,10,11,12]
  build() {
    Grid() {
      ForEach(this.listData,(item:number,index:number)=&gt;{
        GirdItemComponent()
      })
    }
    .height('100%')
    .width('100%')
    .columnsTemplate('1fr 1fr 1fr 1fr')
    .rowsGap(10)
    .columnsGap(10)
  }
}
//éƒ¨åˆ†ä»£ç çœç•¥......

</code></pre>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­</p>
<ul>
<li>ä½¿ç”¨<code>ForEach</code>å¾ªç¯ï¼ŒæˆåŠŸçš„é€šè¿‡æ•°æ®æºçš„æ•°é‡åŠ¨æ€æ¸²æŸ“<code>GridItem</code></li>
</ul>
<p>æ¥ç€è®²ä¸‹ä¸€ä¸ªç»„ä»¶ï¼</p>
<h4 data-id="heading-15">2.2.6 RelativeContainer å®¹å™¨ç»„ä»¶</h4>
<p>ç›¸å¯¹å¸ƒå±€ç»„ä»¶ï¼Œç”¨äºå¤æ‚åœºæ™¯ä¸­å…ƒç´ å¯¹é½çš„å¸ƒå±€ã€‚å®ƒå¯ä»¥æ ¹æ®ç»„ä»¶ä¸ç»„ä»¶çš„å…³ç³»ï¼Œè®¾ç½®å¹¶å®šä½å¯¹åº”è‡ªå·±çš„ä¸åŒçš„ä½ç½®ã€‚</p>
<p>RelativeContainer æ¡ˆä¾‹</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct Page2 {
  build() {
    Row() {
      RelativeContainer() {
        Row(){Text('row1')}.justifyContent(FlexAlign.Center)
        .width(100).height(100)
        .backgroundColor("#FF3333")
        .alignRules({
          top: {anchor: "__container__", align: VerticalAlign.Top},
          left: {anchor: "__container__", align: HorizontalAlign.Start}
        })
        .id("row1")

        Row(){Text('row2')}.justifyContent(FlexAlign.Center)
        .width(100).height(100)
        .backgroundColor("#FFCC00")
        .alignRules({
          top: {anchor: "__container__", align: VerticalAlign.Top},
          right: {anchor: "__container__", align: HorizontalAlign.End}
        })
        .id("row2")

        Row(){Text('row3')}.justifyContent(FlexAlign.Center)
        .height(100)
        .backgroundColor("#FF6633")
        .alignRules({
          top: {anchor: "row1", align: VerticalAlign.Bottom},
          left: {anchor: "row1", align: HorizontalAlign.End},
          right: {anchor: "row2", align: HorizontalAlign.Start}
        })
        .id("row3")

        Row(){Text('row4')}.justifyContent(FlexAlign.Center)
        .backgroundColor("#FF9966")
        .alignRules({
          top: {anchor: "row3", align: VerticalAlign.Bottom},
          bottom: {anchor: "__container__", align: VerticalAlign.Bottom},
          left: {anchor: "__container__", align: HorizontalAlign.Start},
          right: {anchor: "row1", align: HorizontalAlign.End}
        })
        .id("row4")

        Row(){Text('row5')}.justifyContent(FlexAlign.Center)
        .backgroundColor("#FF66FF")
        .alignRules({
          top: {anchor: "row3", align: VerticalAlign.Bottom},
          bottom: {anchor: "__container__", align: VerticalAlign.Bottom},
          left: {anchor: "row2", align: HorizontalAlign.Start},
          right: {anchor: "__container__", align: HorizontalAlign.End}
        })
        .id("row5")
      }
      .width(300).height(300)
      .margin({left: 50})
      .border({width:2, color: "#6699FF"})
    }
    .height('100%')
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fc4db1db5e44bafb46f369ef21f8c20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=B%2FU11yGgC7py5cN%2BCKXqDMtQs5w%3D" alt="QQ_1764315080855.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼š</p>
<ul>
<li>
<p>åœ¨<code>RelativeContainer</code>ç»„ä»¶é‡Œï¼Œå­ç»„ä»¶ä½ç½®é€šè¿‡<code>.alignRules(xx)</code>å±æ€§æ–¹æ³•ï¼Œè®¾ç½®å½“å‰å­ç»„ä»¶çš„ä½ç½®</p>
</li>
<li>
<p>åœ¨<code>.alignRules(xx)</code>å±æ€§æ–¹æ³•é‡Œï¼Œå¯ä»¥åˆ†åˆ«è®¾ç½®<code>top</code>ã€<code>bottom</code>ã€<code>left</code>ã€<code>right</code>ã€<code>center</code>ã€<code>middle</code>,ä¸åŒæ–¹ä½ä»¥åŠå±…ä¸­å¯¹é½å‚æ•°ï¼Œä½†ä»–ä»¬æ— ééƒ½æ˜¯åˆ†ä¸º<strong>å‚ç›´æ–¹å‘ä»¥åŠæ°´å¹³æ–¹å‘</strong></p>
<ul>
<li><code>top</code>ã€<code>bottom</code>ã€<code>center</code> è¿™ä¸‰ä¸ªæ˜¯å‚ç›´æ–¹å‘</li>
<li><code>left</code>ã€<code>right</code>ã€<code>middle</code> è¿™ä¸‰ä¸ªæ˜¯æ°´å¹³æ–¹å‘</li>
</ul>
</li>
<li>
<p>åœ¨<code>{anchor: "xxx", align: xxx}</code>ç»“æ„ä½“ä¸­ï¼Œ<strong>ä¸åŒçš„æ–¹å‘å°†ä¼šæœ‰ä¸åŒçš„è®¾ç½®çº¦æŸçš„æ–¹å¼</strong>ï¼Œ</p>
<ul>
<li>æ°´å¹³æ–¹å‘é€šè¿‡<code>align: HorizontalAlign.xxx</code>èµ‹å€¼</li>
<li>å‚ç›´æ–¹å‘é€šè¿‡<code>align: VerticalAlign.xxx</code>èµ‹å€¼</li>
</ul>
</li>
<li>
<p>åœ¨<code>{anchor: "xxx", align: xxx}</code>ç»“æ„ä½“ä¸­ï¼Œå½“å‰å­ç»„ä»¶å¯ä»¥é€šè¿‡<code>anchor: "xxx"</code>ä¸å…¶ä»–å­ç»„ä»¶æˆ–çˆ¶ç»„ä»¶å»ºç«‹çº¦æŸ</p>
<ul>
<li><code>anchor: "__container__"</code> è¿™ä¸ªè¡¨ç¤ºä¸çˆ¶å®¹å™¨å»ºç«‹çº¦æŸ</li>
<li><code>anchor: "row3"</code> è¿™ä¸ªè¡¨ç¤ºä¸<code>row3</code>ç»„ä»¶å»ºç«‹çº¦æŸã€‚è€Œ<code>row3</code>ç»„ä»¶é€šè¿‡<code>.id("row3")</code>è®¾ç½®å¹¶å‘½åäº†è‡ªå·±å°±æ˜¯<code>row3</code>ç»„ä»¶</li>
</ul>
</li>
<li>
<p>åœ¨<code>Row4</code>ä¸<code>Row5</code>ç»„ä»¶é‡Œï¼Œå®ƒä¿©åˆ†åˆ«å»ºç«‹äº†å››ä¸ªæ–¹ä½çš„çº¦æŸï¼Œå› æ­¤åœ¨æ²¡æœ‰è®¾ç½®<code>width</code>ä¸<code>height</code>æ—¶ï¼Œå®ƒä¹Ÿä¼šè‡ªåŠ¨æ ¹æ®çº¦æŸç”Ÿæˆå¯¹åº”çš„å®½é«˜é•¿åº¦</p>
</li>
</ul>
<p>OKï¼Œå¸¸ç”¨çš„å®¹å™¨ç»„ä»¶ï¼Œå·²ç»è®²å®Œäº†ã€‚ç°åœ¨æˆ‘ä»¬å¼€å§‹è®²è§£åŸºç¡€ç»„ä»¶ã€‚</p>
<h3 data-id="heading-16">2.2 åŸºç¡€ç»„ä»¶</h3>
<p>åŸºç¡€ç»„ä»¶æ¯”è¾ƒç®€å•ï¼Œæˆ‘è¿™å‡†å¤‡ç”¨ä¸€äº›å°æ¡ˆä¾‹æ¥è®²è§£åŸºç¡€ç»„ä»¶å¦‚ä½•ä½¿ç”¨</p>
<h4 data-id="heading-17">2.2.1 æ¡ˆä¾‹ä¸€ï¼š</h4>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct TextPage {
  @State message: string = 'Hello World';
  build() {
    RelativeContainer() {
      Text(this.message)
        .id('TextPageHelloWorld')
        .fontSize(50)
        .fontWeight(FontWeight.Bold)
        .alignRules({
          center: { anchor: '__container__', align: VerticalAlign.Center },
          middle: { anchor: '__container__', align: HorizontalAlign.Center }
        })

      Button('ç‚¹æˆ‘æ”¹å˜æ–‡æœ¬')
        .alignRules({
          top: { anchor: 'TextPageHelloWorld', align: VerticalAlign.Bottom },
          middle: { anchor: '__container__', align: HorizontalAlign.Center }
        })
        .onClick(() =&gt; {
          this.clickBtn()
        })
        .margin({ top: 20 })
    }
    .height('100%')
    .width('100%')
  }

  private clickBtn() {
    this.message = "æˆ‘æ”¹å˜äº†Text"
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/001f5c7289ac467580f7b2cffdb2ccb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=Ybyywix%2FNKJGP6vpeIx5BJdVpn0%3D" alt="ezgif-50a344ea2841ebb4.gif" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼š</p>
<ul>
<li>ä½¿ç”¨äº†<code>Text</code>ã€<code>Button</code>ç»„ä»¶ï¼Œè€Œ<code>Text</code>æ–‡æœ¬æ˜¯é€šè¿‡å˜é‡<code>message</code>èµ‹å€¼ï¼Œè¿™ä¸ªå˜é‡ä½¿ç”¨äº†<code>@State</code>ä¿®é¥°ç¬¦</li>
<li><code>@State</code>åˆåï¼š<strong>çŠ¶æ€å˜é‡è£…é¥°å™¨</strong>ï¼Œè¢«å®ƒä¿®é¥°çš„å˜é‡<code>message</code>ç§°ä¸º<strong>çŠ¶æ€å˜é‡</strong>ï¼ˆè®©æ™®é€šå˜é‡å…·å¤‡çŠ¶æ€å±æ€§ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å½“çŠ¶æ€å˜é‡æ”¹å˜æ—¶ï¼Œå°†ä¼šè§¦å‘ç»‘å®šçš„UIç»„ä»¶æ¸²æŸ“æ›´æ–°</li>
<li>å› æ­¤åœ¨<code>Button</code>ç‚¹å‡»äº‹ä»¶é‡Œï¼Œæ”¹å˜äº†<code>message</code>çŠ¶æ€å˜é‡ï¼Œè®©<code>Text</code>ç»„ä»¶æ¸²æŸ“æ›´æ–°äº†æœ€æ–°çš„æ–‡æœ¬</li>
</ul>
<p>è¿™ä¸ªå¾ˆç®€å•ï¼Œç°åœ¨é€æ¸ä¸Šéš¾åº¦</p>
<h4 data-id="heading-18">2.2.2 æ¡ˆä¾‹äºŒï¼š</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> { promptAction } from <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct LoginPage {

  <span class="hljs-meta">@State</span> phone: string = <span class="hljs-string">''</span>
  <span class="hljs-meta">@State</span> password: string = <span class="hljs-string">''</span>
  <span class="hljs-meta">@State</span> smsCode: string = <span class="hljs-string">''</span>

  <span class="hljs-meta">@State</span> loginByPassword: boolean = <span class="hljs-literal">true</span> <span class="hljs-comment">// true=å¯†ç ç™»å½•ï¼Œfalse=éªŒè¯ç ç™»å½•</span>

  <span class="hljs-comment">// éªŒè¯ç å€’è®¡æ—¶</span>
  <span class="hljs-meta">@State</span> counter: number = <span class="hljs-number">0</span>
  <span class="hljs-keyword">private</span> timerId: number = <span class="hljs-number">0</span>

  build() {
    Column({ space: <span class="hljs-number">20</span> }) {

      Text(<span class="hljs-string">"æ‰‹æœºç™»å½•"</span>)
        .fontSize(<span class="hljs-number">30</span>)
        .fontWeight(FontWeight.Bold)
        .margin({ top: <span class="hljs-number">40</span> })

      <span class="hljs-comment">/** æ‰‹æœºå·è¾“å…¥æ¡† */</span>
      Row() {
        TextInput({ placeholder: <span class="hljs-string">'è¯·è¾“å…¥æ‰‹æœºå·'</span> })
          .type(InputType.Number)
          .maxLength(<span class="hljs-number">11</span>)
          .onChange(v =&gt; <span class="hljs-keyword">this</span>.phone = v)
      }
      .padding(<span class="hljs-number">12</span>)
      .backgroundColor(<span class="hljs-string">'#F7F7F7'</span>)
      .borderRadius(<span class="hljs-number">8</span>)
      .width(<span class="hljs-string">'85%'</span>)

      <span class="hljs-comment">/** å¯†ç ç™»å½•åŒºåŸŸ */</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.loginByPassword) {
        Row() {
          TextInput({ placeholder: <span class="hljs-string">'è¯·è¾“å…¥å¯†ç '</span> })
            .type(InputType.Password)
            .onChange(v =&gt; <span class="hljs-keyword">this</span>.password = v)
        }
        .padding(<span class="hljs-number">12</span>)
        .backgroundColor(<span class="hljs-string">'#F7F7F7'</span>)
        .borderRadius(<span class="hljs-number">8</span>)
        .width(<span class="hljs-string">'85%'</span>)
      }

      <span class="hljs-comment">/** éªŒè¯ç ç™»å½•åŒºåŸŸ */</span>
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.loginByPassword) {
        Row({ space: <span class="hljs-number">10</span> }) {
          TextInput({
            placeholder: <span class="hljs-string">'è¯·è¾“å…¥éªŒè¯ç '</span>
          })
            .onChange(v =&gt; <span class="hljs-keyword">this</span>.smsCode = v)
            .width(<span class="hljs-string">'60%'</span>)
          <span class="hljs-comment">// å‘é€éªŒè¯ç æŒ‰é’®</span>
          Button(
            <span class="hljs-keyword">this</span>.counter &gt; <span class="hljs-number">0</span>
              ? `${<span class="hljs-keyword">this</span>.counter} ç§’åé‡è¯•`
              : <span class="hljs-string">'å‘é€éªŒè¯ç '</span>
          )
            .height(<span class="hljs-number">40</span>)
            .borderRadius(<span class="hljs-number">6</span>)
            .backgroundColor(<span class="hljs-string">'#007DFF'</span>)
            .fontColor(Color.White)
            .onClick(() =&gt; <span class="hljs-keyword">this</span>.onSendCode())
        }
        .padding(<span class="hljs-number">12</span>)
        .backgroundColor(<span class="hljs-string">'#F7F7F7'</span>)
        .borderRadius(<span class="hljs-number">8</span>)
        .width(<span class="hljs-string">'85%'</span>)
      }

      <span class="hljs-comment">/** ç™»å½•æŒ‰é’® */</span>
      Button(<span class="hljs-string">"ç™»å½•"</span>)
        .width(<span class="hljs-string">'85%'</span>)
        .height(<span class="hljs-number">45</span>)
        .backgroundColor(<span class="hljs-string">'#007DFF'</span>)
        .fontColor(Color.White)
        .borderRadius(<span class="hljs-number">8</span>)
        .onClick(() =&gt; <span class="hljs-keyword">this</span>.onLogin())

      <span class="hljs-comment">/** ç™»å½•æ–¹å¼åˆ‡æ¢ */</span>
      Row() {
        Text(<span class="hljs-keyword">this</span>.loginByPassword ? <span class="hljs-string">"ä½¿ç”¨éªŒè¯ç ç™»å½•"</span> : <span class="hljs-string">"ä½¿ç”¨å¯†ç ç™»å½•"</span>)
          .fontColor(<span class="hljs-string">'#007DFF'</span>)
          .onClick(() =&gt; {
            <span class="hljs-keyword">this</span>.loginByPassword = !<span class="hljs-keyword">this</span>.loginByPassword
            <span class="hljs-keyword">this</span>.password = <span class="hljs-string">''</span>
            <span class="hljs-keyword">this</span>.smsCode = <span class="hljs-string">''</span>
          })
      }
    }
    .width(<span class="hljs-string">'100%'</span>)
    .justifyContent(FlexAlign.Center)
  }

  <span class="hljs-comment">/** ---------------- åŠŸèƒ½é€»è¾‘ ---------------- */</span>
  <span class="hljs-keyword">private</span> show(msg: string) {
    <span class="hljs-keyword">this</span>.toast(msg)
  }

  <span class="hljs-comment">/** ç™»å½•æŒ‰é’®é€»è¾‘ */</span>
  <span class="hljs-keyword">private</span> onLogin() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.phone.trim() === <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"è¯·è¾“å…¥æ‰‹æœºå·"</span>)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.loginByPassword) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.password.trim() === <span class="hljs-string">''</span>) {
        <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"è¯·è¾“å…¥å¯†ç "</span>)
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"å¯†ç ç™»å½•æˆåŠŸï¼ˆç¤ºä¾‹ï¼‰"</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.smsCode.trim() === <span class="hljs-string">''</span>) {
        <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"è¯·è¾“å…¥éªŒè¯ç "</span>)
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"éªŒè¯ç ç™»å½•æˆåŠŸï¼ˆç¤ºä¾‹ï¼‰"</span>)
    }
  }

  <span class="hljs-comment">/** å‘é€éªŒè¯ç é€»è¾‘ */</span>
  <span class="hljs-keyword">private</span> onSendCode() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.phone.trim() === <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"è¯·å…ˆè¾“å…¥æ‰‹æœºå·"</span>)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.counter &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.show(`è¯·ç­‰å¾… ${<span class="hljs-keyword">this</span>.counter} ç§’åå†è¯•`)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ¨¡æ‹Ÿå‘é€æˆåŠŸ</span>
    <span class="hljs-keyword">this</span>.show(<span class="hljs-string">"éªŒè¯ç å·²å‘é€"</span>)

    <span class="hljs-keyword">this</span>.counter = <span class="hljs-number">60</span>
    <span class="hljs-keyword">this</span>.startTimer()
  }

  <span class="hljs-keyword">private</span> toast(msg: string) {
    promptAction.showToast({ message: msg })
  }

  <span class="hljs-comment">/** 60 ç§’å€’è®¡æ—¶å®šæ—¶å™¨ */</span>
  <span class="hljs-keyword">private</span> startTimer() {
    clearInterval(<span class="hljs-keyword">this</span>.timerId)
    <span class="hljs-keyword">this</span>.timerId = setInterval(() =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.counter &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.counter--
      } <span class="hljs-keyword">else</span> {
        clearInterval(<span class="hljs-keyword">this</span>.timerId)
      }
    }, <span class="hljs-number">1000</span>)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efd276d1e9a2406fa012e6be5ddeb7bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=ztJT1rZ4a5pMcr26S1Cxm%2FRISbY%3D" alt="ezgif-4d505e9cca216e11.gif" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„éªŒè¯ç ã€å¯†ç ç™»å½•ä¾‹å­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li>
<p>ä½¿ç”¨çš„æ–°ç»„ä»¶<code>TextInput</code>è¾“å…¥æ¡†ç»„ä»¶ï¼Œ</p>
<ul>
<li><code>{ placeholder: 'xxxx' }</code>è¡¨ç¤ºè¯¥è¾“å…¥æ¡†ç»„ä»¶ï¼Œåœ¨æ²¡æœ‰è¾“å…¥å†…å®¹ä¹‹å‰æç¤ºæ–‡æœ¬</li>
<li><code>.type(InputType.xxx)</code>è®¾ç½®æ”¹è¾“å…¥æ¡†ç»„ä»¶æ˜¯ä»€ä¹ˆç±»å‹çš„è¾“å…¥æ¡†</li>
</ul>
</li>
<li>
<p>åœ¨UIæè¿°åŒºåŸŸå¯ä»¥ä½¿ç”¨<code>if</code>è¯­å¥æ¥æ§åˆ¶UIåŒºåŸŸæ˜¯å¦æ˜¾ç¤ºã€‚ï¼ˆå¿…é¡»æ˜¯<code>@State</code>ä¿®é¥°çš„<strong>çŠ¶æ€å˜é‡</strong>ï¼‰</p>
<ul>
<li><code>if (this.loginByPassword)</code>æ˜¾ç¤ºå¯†ç ç™»å½•åŒºåŸŸï¼›</li>
<li><code>if (!this.loginByPassword)</code>æ˜¾ç¤ºéªŒè¯ç ç™»å½•åŒºåŸŸ</li>
</ul>
</li>
<li>
<p>ä¹Ÿå¯ä»¥åœ¨æŸä¸ªç»„ä»¶å†…ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦è¿›è¡Œç»„ä»¶æ¸²æŸ“ã€‚å¦‚æ¡ˆä¾‹ä¸­ï¼š<code>Text(this.loginByPassword ? "ä½¿ç”¨éªŒè¯ç ç™»å½•" : "ä½¿ç”¨å¯†ç ç™»å½•")</code>ç­‰ã€‚ï¼ˆå¿…é¡»æ˜¯<code>@State</code>ä¿®é¥°çš„<strong>çŠ¶æ€å˜é‡</strong>ï¼‰</p>
</li>
<li>
<p><code>import { promptAction } from '@kit.ArkUI';</code>è¿™é‡Œå¯¼å…¥äº†SDKå¼€æ”¾èƒ½åŠ›ï¼ŒSDKå¯¹åŒä¸€ä¸ªKitä¸‹çš„æ¥å£æ¨¡å—è¿›è¡Œäº†å°è£…ã€‚è¿™å¥ä»£ç æ„æ€å°±æ˜¯ï¼Œå¯¼å…¥<code>@kit.ArkUI</code>é‡Œé¢çš„<code>promptAction</code>æ¥å£èƒ½åŠ›</p>
</li>
</ul>
<p>ä¸Šé¢çš„ä¿©ä¸ªä¾‹å­éƒ½æ˜¯é€šè¿‡<strong>çŠ¶æ€å˜é‡</strong>æ”¹å˜æ—¶å½±å“å¸ƒå±€çš„æ¸²æŸ“ï¼Œé‚£èƒ½ä¸èƒ½é€šè¿‡ç»„ä»¶å†…å®¹çš„æ›´æ”¹ä»è€Œæ”¹å˜å˜é‡çš„å€¼å‘¢ï¼Ÿ</p>
<h4 data-id="heading-19">2.2.3 æ¡ˆä¾‹ä¸‰ï¼š</h4>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct PageMvvm {

  @State
  isChecked: boolean = false
  @State
  myDate: Date = new Date()
  @State
  sexMale: boolean = true
  @State
  sexFeMale: boolean = false
  @State
  mySearch: string = ''
  @State
  myToggle: boolean = false
  @State
  mySelect: string = 'aaa'

  build() {
    Column({space: 12}) {

      Column(){
        Text('CheckBoxåŒå‘ç»‘å®š')
        Checkbox().select($$this.isChecked)
        Text('' + this.isChecked)
      }

      MyDivider()

      Column(){
        Text('DatePickeråŒå‘ç»‘å®š')
        DatePicker({selected: $$this.myDate})
        Text('' + this.myDate.toLocaleString())
      }
      MyDivider()
      Column(){
        Text('RadioåŒå‘ç»‘å®š')
        Radio({value:'male',   group: 'sex'}).checked($$this.sexMale)
        Radio({value:'female', group: 'sex'}).checked($$this.sexFeMale)
        Text('' + this.sexMale)
      }
      MyDivider()
      Column(){
        Text('SearchåŒå‘ç»‘å®š')
        Search({value: $$this.mySearch})
        Text('' + this.mySearch)
      }

      MyDivider()
      Column() {
        Text('ToggleåŒå‘ç»‘å®š')
        Toggle({ type: ToggleType.Switch,isOn:$$this.myToggle})
        Text('' + this.myToggle)
      }

      MyDivider()
      Column() {
        Text('SelectåŒå‘ç»‘å®š')
        Row(){
          Select([{ value: 'aaa' },
            { value: 'bbb'},
            { value: 'ccc'},
            { value: 'ddd'}])
            .value($$this.mySelect)
          Text('' + this.mySelect)
        }
      }
      MyDivider()
    }
    .height('100%')
    .width('100%')
  }
}

@Component
struct MyDivider {
  build() {
    Divider().height(3).backgroundColor(Color.Pink)
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/564f3edfe5d142b18d739cebf3933ccd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=teWO5rPiCHlvKDOm25MDapC%2BxC8%3D" alt="ezgif-36c0e0b8023d3deb.gif" loading="lazy"/></p>
<p>åœ¨è¯¥ä¾‹å­ä¸­ï¼š</p>
<ul>
<li>ä½¿ç”¨äº†ä¸€ç³»åˆ—ä¸åŒçš„æ–°ç»„ä»¶ï¼ˆ<code>Checkbox</code>ã€<code>DatePicker</code>ã€<code>Radio</code>.....ï¼‰ï¼Œåœ¨ä¼ å€¼çš„æ—¶å€™ï¼Œå¯¹åº”çš„å˜é‡å‰åŠ äº†<code>$$</code>ç¬¦å·ï¼Œå½“ç»„ä»¶å€¼æ”¹å˜æ—¶ï¼Œä¹Ÿä¼šåŒæ­¥æ”¹å˜å¯¹åº”å˜é‡ã€‚</li>
</ul>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éš¾å…ä¼šæ ¹æ®ä¸åŒçš„éœ€æ±‚ï¼Œå°è£…è‡ªå·±çš„UIã€‚</p>
<p>é‚£è¯¥å¦‚ä½•å°è£…è‡ªå®šä¹‰UIå‘¢ï¼Ÿ</p>
<h3 data-id="heading-20">2.3 è‡ªå®šä¹‰UI</h3>
<p>åœ¨ä¸Šé¢è®²è§£<code>Grid</code>æ¡ˆä¾‹äºŒçš„æ—¶å€™ï¼Œå°±ç”¨è¿‡ä¸€æ¬¡è‡ªå®šä¹‰UIï¼Œå½“æ—¶æ˜¯ç”¨<code>@Component</code>å°è£…äº†è‡ªå®šä¹‰ç»„ä»¶ã€‚</p>
<p>è€Œåœ¨é¸¿è’™<code>ArkTS</code>å¼€å‘ä¸­,<code>@Component</code>å’Œ<code>@Builder</code>æ˜¯æ„å»ºUIæœ€å¸¸ç”¨çš„ä¸¤ä¸ªè£…é¥°å™¨ã€‚</p>
<p>è™½ç„¶å®ƒä»¬éƒ½ç”¨äºç”Ÿæˆ UI ç•Œé¢ï¼Œä½†å®ƒä»¬åœ¨å®šä½ã€èƒ½åŠ›ã€ç”Ÿå‘½å‘¨æœŸå’Œæ€§èƒ½ä¸Šæœ‰æœ¬è´¨çš„åŒºåˆ«ã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œä¸Šæ¡ˆä¾‹è®²è§£ï¼</p>
<h4 data-id="heading-21">2.3.1 æ¡ˆä¾‹ä¸€</h4>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Builder
function ValueBuilder(text: string) {
  Text(`å€¼ä¼ é€’Builderï¼Œä¸ä¼šåˆ·æ–°UI: ${text}`)
    .fontSize(16)
    .fontColor(Color.Gray)
    .margin(5)
}

class Tmp {
  title: string = ''
}

@Builder
function QuoteBuilder(tmp: Tmp) {
  Column() {
    Row() {
      Image($r('app.media.startIcon')).width(20)
      Text(`å¼•ç”¨ä¼ é€’Builder,ä¼šåˆ·æ–°UI: ${tmp.title}`).fontSize(18)
    }
    .margin(10)
  }
}

@Component
@Entry
struct ParentPage {
  @State parentMessage: string = "çˆ¶ç»„ä»¶çŠ¶æ€";

  @Builder
  LocalBuilder() {
    Text(`è¿™æ˜¯LocalBuilder èƒ½é€šè¿‡thisåˆ·æ–° ${this.parentMessage}`)
  }

  build() {
    Column() {

      //å…¨å±€å€¼ä¼ é€’Builder
      ValueBuilder(this.parentMessage)

      //å…¨å±€å¼•ç”¨ä¼ é€’Builder
      QuoteBuilder({ title: this.parentMessage })

      //å±€éƒ¨ this æŒ‡å‘Builder
      this.LocalBuilder()
      Divider().strokeWidth(2).color(Color.Blue).margin({top:20})

      Button("ä¿®æ”¹çˆ¶ç»„ä»¶çŠ¶æ€")
        .onClick(() =&gt; {
          this.parentMessage = "çŠ¶æ€å·²æ›´æ–°";
          console.log(`parentMessage=${this.parentMessage}`)
        }).margin({top:20})

      Text(this.parentMessage).margin({top:20})

      Divider().strokeWidth(2).color(Color.Blue).margin({top:20})

      // ä½¿ç”¨å­ç»„ä»¶
      ChildComponent().margin({top:20})
    }
    .width('100%')
    .height('100%')
  }
}


// 2. å®šä¹‰ä¸€ä¸ªå­ç»„ä»¶ Component (ç‹¬ç«‹æ¨¡å—ï¼Œæœ‰ç”Ÿå‘½å‘¨æœŸ)
@Component
struct ChildComponent {
  @State message: string = "æˆ‘æ˜¯ç‹¬ç«‹çš„å­ç»„ä»¶";

  // ç”Ÿå‘½å‘¨æœŸæ¼”ç¤º
  aboutToAppear() {
    console.log("ChildComponent åˆå§‹åŒ–äº†");
  }

  build() {
    Column() {
      Text(this.message)
        .fontSize(20)
        .fontWeight(FontWeight.Bold)
        .backgroundColor(Color.Pink)
        .padding(10)
        .onClick(() =&gt; {
          this.message = "å­ç»„ä»¶è¢«ç‚¹å‡»ï¼Œåªåˆ·æ–°æˆ‘ï¼";
        })
    }
  }
}
</code></pre>
<p>è¿è¡Œåˆå§‹åŒ–æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">     ChildComponent åˆå§‹åŒ–äº†
</span></code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89f3553c240e4d1faf0e19d146e1666a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=LjTOVSQhALb3uoEjTBrafu54vrs%3D" alt="ezgif-3df822dc21ccbf98.gif" loading="lazy"/></p>
<p>åœ¨è¯¥ä¾‹å­ä¸­ï¼š</p>








































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>@Component (è‡ªå®šä¹‰ç»„ä»¶)</strong></th><th><strong>@Builder (UI æ„å»ºå‡½æ•°)</strong></th></tr></thead><tbody><tr><td><strong>æœ¬è´¨</strong></td><td><strong>ç±»/ç»“æ„ä½“</strong> (<code>struct</code>)</td><td><strong>å‡½æ•°/æ–¹æ³•</strong> (<code>function</code>)</td></tr><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td><strong>æœ‰</strong> (<code>aboutToAppear</code>, <code>aboutToDisappear</code> ç­‰)</td><td><strong>æ— </strong></td></tr><tr><td><strong>çŠ¶æ€ç®¡ç†</strong></td><td>æ‹¥æœ‰ç‹¬ç«‹çš„çŠ¶æ€ (<code>@State</code>, <code>@Link</code> ç­‰)</td><td>ä¾èµ–ä¼ å…¥å‚æ•°æˆ–å®¿ä¸»ç»„ä»¶çš„çŠ¶æ€</td></tr><tr><td><strong>æ¸²æŸ“æœºåˆ¶</strong></td><td>ç‹¬ç«‹çš„æ¸²æŸ“èŠ‚ç‚¹ï¼Œæ›´æ–°æ—¶åªåˆ·æ–°è‡ªå·±</td><td>è§†ä¸ºå®¿ä¸»ç»„ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸éšå®¿ä¸»åˆ·æ–°</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>è¾ƒé‡ (éœ€è¦åˆ›å»ºå®ä¾‹ã€ç»´æŠ¤çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸ)</td><td>æè½» (ä»…ä»…æ˜¯ä»£ç å¤ç”¨é€»è¾‘)</td></tr><tr><td><strong>å¤ç”¨èŒƒå›´</strong></td><td>å…¨å±€å¯å¤ç”¨ï¼Œä¸ä»…é™ UIï¼Œè¿˜å°è£…é€»è¾‘</td><td>ä¸»è¦æ˜¯ UI ç»“æ„çš„å¤ç”¨ (åˆ†ä¸ºå…¨å±€å’Œå±€éƒ¨)</td></tr></tbody></table>
<p>æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¾€å¾€ä¼šå‡ºç°å¤§é‡çš„ä»£ç åœ¨è¿›è¡Œé‡å¤æ ·å¼çš„è®¾ç½®ï¼Œå› æ­¤è¿™å°±æ¶‰åŠåˆ°æ ·å¼çš„å¤ç”¨ã€‚</p>
<h3 data-id="heading-22">2.4 æ ·å¼å¤ç”¨</h3>
<h4 data-id="heading-23">2.4.1 @Styles æ ·å¼å¤ç”¨</h4>
<p>æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">import { promptAction } from '@kit.ArkUI';

enum PayType {
  WXPay, Alipay, BankPay, CreditCard
}

@Entry
@Component
struct PageStyle1 {
  @State
  heightValue: number = 50

  @Styles
  // payStyle(payType:PayType){  //ç¼–è¯‘æŠ¥é”™ï¼Œ@Styles æ–¹æ³•ä¸èƒ½å«æœ‰å‚æ•°
  payStyle(){
    .width('100%')
    .height(this.heightValue)
    .borderRadius(10)
    .backgroundColor('#FF1266e0')
    .onClick(() =&gt; {
      promptAction.showToast({ message: 'æ”¯ä»˜æˆåŠŸï¼' })
    })
  }

  build() {
    Column() {
      Row() {
        Button('å¾®ä¿¡æ”¯ä»˜', { type: ButtonType.Normal })
          .payStyle()
      }
      .padding(10)

      Row() {
        Button('æ”¯ä»˜å®æ”¯ä»˜', { type: ButtonType.Normal })
          .payStyle()

      }
      .padding(10)

      Row() {
        Button('é“¶è¡Œå¡æ”¯ä»˜', { type: ButtonType.Normal })
          .payStyle()

      }
      .padding(10)

      Row() {
        Button('ä¿¡ç”¨å¡æ”¯ä»˜', { type: ButtonType.Normal })
          .payStyle()

      }
      .padding(10)

    }
    .width('100%')
    .height('100%')

  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a164547ff5c4713ac8cc5cd22b4816b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=k4ZDEwt4gRk31MDOfSWYDFkO5w0%3D" alt="ezgif-60d51c07d55661eb.gif" loading="lazy"/></p>
<p>åœ¨è¯¥ä¾‹å­ä¸­ï¼š</p>
<ul>
<li>é€šè¿‡<code>@Styles</code>ä¿®é¥°çš„æ–¹æ³•å¯ä»¥å®šä¹‰<strong>é€šç”¨å±æ€§ä¸é€šç”¨äº‹ä»¶ï¼Œä¸æ”¯æŒå‚æ•°ä¼ é€’ï¼ˆé€šç”¨ã€é€šç”¨ã€é€šç”¨ï¼‰</strong></li>
</ul>
<p>é‚£å¦‚æœè¯´æœ‰å¤šç§æƒ…å†µï¼Œä¸åŒæƒ…å†µæŒ‰é’®é¢œè‰²ä¸ä¸€æ ·ï¼Œç„¶è€Œ<code>@Styles</code>ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä¼ å‚ï¼ŒåŒºåˆ†ä¸äº†æŒ‰é’®ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<h4 data-id="heading-24">2.4.2 @Extend æ ·å¼å¤ç”¨</h4>
<p>æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">import { promptAction } from '@kit.ArkUI';

@Entry
@Component
struct PageStyle2 {
  build() {
    Column({ space: 20 }) {
      Button("æ”¯ä»˜å®æ”¯ä»˜")
        .payButton("alipay")
      Button("å¾®ä¿¡æ”¯ä»˜")
        .payButton("wechat")
      Button("æ”¯ä»˜å®æ”¯ä»˜")
        .payButton("alipay")
      Button("å¾®ä¿¡æ”¯ä»˜")
        .payButton("wechat")
      Button("æ”¯ä»˜å®æ”¯ä»˜")
        .payButton("alipay")
      Button("å¾®ä¿¡æ”¯ä»˜")
        .payButton("wechat")
      Button("æ”¯ä»˜å®æ”¯ä»˜")
        .payButton("alipay")
    }
    .padding(20)
    .width('100%')
  }
}

@Extend(Button)
function payButton(type: 'alipay' | 'wechat'){
  .type(ButtonType.Normal)
  .fontColor(Color.White)
  .width('100%')
  .height(50)
  .borderRadius(4)
  .backgroundColor(type === 'wechat' ? '#00c168':'#ff1256e0')
  .onClick(()=&gt;{
    if( type === 'alipay'){
      promptAction.showToast({message: 'æ”¯ä»˜å®æ”¯ä»˜æˆåŠŸï¼'})
    }else{
      promptAction.showToast({message: 'å¾®ä¿¡æ”¯ä»˜æˆåŠŸï¼'})
    }
  })
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4b8ede32c5d4adeabd0d747122b4064~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=qRFpiz%2B89MbRZMAK9YaeMFNLhZg%3D" alt="ezgif-2587c76ade83aa5c.gif" loading="lazy"/></p>
<p>åœ¨è¯¥ä¾‹å­ä¸­ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>@Extend(Button)</code>æ‰©å±•äº†åŸç”Ÿç»„ä»¶çš„æ ·å¼ï¼Œæ”¯æŒå°è£…ç§æœ‰å±æ€§ã€é€šç”¨å±æ€§ã€äº‹ä»¶ã€‚</li>
<li>ä¸<code>@Styles</code>ä¸åŒï¼Œ<code>@Extend(Button)</code>æ”¯æŒå‚æ•°ä¼ é€’ï¼Œæä¾›äº†æ›´å¤§çš„çµæ´»æ€§</li>
</ul>
<p>è™½ç„¶<code>@Styles</code>å’Œ<code>@Extend(Button)</code>æä¾›äº†æ ·å¼å¤ç”¨çš„èƒ½åŠ›ï¼Œä½†æ˜¯å®ƒä»¬è¿˜æ˜¯å­˜åœ¨ä¸€äº›é™åˆ¶ï¼Œå› æ­¤å°±æœ‰äº†<code>AttributeModifier</code>ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p>
<h4 data-id="heading-25">2.4.3 AttributeModifier</h4>
<p>æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct PageStyle3 {

  @State modifier: MyButtonModifier = new MyButtonModifier()
  @State modifier2: MyButtonModifier2 = new MyButtonModifier2()

  build() {

    Column({space: 20}){
      Button('ç‚¹æˆ‘è¯•è¯•').attributeModifier(this.modifier).onClick(()=&gt;{
        this.modifier.isDark = !this.modifier.isDark
      })

      Divider().height(2).backgroundColor(Color.Pink)

      Button('ç‚¹æˆ‘è¯•è¯•').attributeModifier(this.modifier2)

    }
    .width('100%')
    .height('100%')
  }
}

class MyButtonModifier implements AttributeModifier&lt;ButtonAttribute&gt;{
  isDark: boolean  = false
  applyNormalAttribute(instance: ButtonAttribute): void {
    instance.backgroundColor(this.isDark ? Color.Black: Color.Red)
  }
}

class MyButtonModifier2 implements AttributeModifier&lt;ButtonAttribute&gt; {
  applyNormalAttribute(instance: ButtonAttribute): void {
    instance.backgroundColor(Color.Black)
  }
  applyPressedAttribute(instance: ButtonAttribute): void {
    instance.backgroundColor(Color.Red)

  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14f251648531456c91057c98ac40677f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=APmj5m2w7H7toUBkas%2FE85%2BUTH4%3D" alt="ezgif-7320282bf35d4baa.gif" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li><code>AttributeModifier&lt;ButtonAttribute&gt;</code> å…¶ä¸­<code>ButtonAttribute</code>æ˜¯ <code>Button</code>ä¸“æœ‰å±æ€§ç±»ï¼Œä¹Ÿå°±æ˜¯æŒ‰é’®æ‰©å±•å±æ€§</li>
<li><code>applyNormalAttribute</code> è¡¨ç¤º æŒ‰é’®åœ¨æ­£å¸¸æƒ…å†µä¸‹å±æ€§çš„è¡¨ç°</li>
<li><code>applyPressedAttribute</code> è¡¨ç¤º æŒ‰é’®åœ¨æŒ‰ä¸‹çš„æƒ…å†µä¸‹å±æ€§çš„è¡¨ç°</li>
</ul>
<h4 data-id="heading-26">2.4.4 å¤šæ€æ ·å¼stateStyles</h4>
<p>æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-ArkTS" lang="ArkTS">@Entry
@Component
struct PageStyle4 {
  build() {
    Column(){
      Row(){
        Text('ä»Šå¤©ä½ å¿ƒæƒ…æ€ä¹ˆæ ·ï¼')
      }
      .padding(20)
      .height(80)
      .border({
        color: Color.Pink,
        width: 3
      })
      .borderRadius(4)
      .stateStyles({
        normal:{
          .backgroundColor(Color.Green)
        },
        pressed:{
          .backgroundColor('#eee')
          .border({
            width: 1,
            style: BorderStyle.Solid,
            color: Color.Red
          })
        }
      })

    }
    .width('100%')
    .height('100%')
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b48add4fe046497ba0045f05cb591604~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaHFr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765353992&amp;x-signature=%2Fx%2BR1Mn3vCF2rP%2B5UlLUMjxYDmQ%3D" alt="ezgif-7e5bff81b40c9dd2.gif" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li>
<p>stateStyleså¯ä»¥ä¾æ®ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ä¸åŒï¼Œå¿«é€Ÿè®¾ç½®ä¸åŒæ ·å¼</p>
</li>
<li>
<p>ArkUIæä¾›ä»¥ä¸‹äº”ç§çŠ¶æ€</p>
<ul>
<li>focusedï¼šè·å–ç„¦ç‚¹æ—¶</li>
<li>normalï¼šæ­£å¸¸æƒ…å†µ</li>
<li>pressedï¼šæŒ‰å‹æ—¶</li>
<li>disabledï¼šä¸å¯é€‰ä¸­æ—¶</li>
<li>selectedï¼šé€‰ä¸­æ—¶</li>
</ul>
</li>
</ul>
<h3 data-id="heading-27">3ã€ç»“æŸè¯­</h3>
<p>OKï¼Œçœ‹åˆ°è¿™é‡Œçš„å°ä¼™ä¼´ç›¸ä¿¡ä½ å¯¹ArkUIæœ‰äº†ä¸€å®šçš„äº†è§£ï¼
ä¸‹ä¸€ç¯‡è®²è§£çŠ¶æ€ç®¡ç†ã€åº”ç”¨ç¨‹åºç»“æ„ä»¥åŠè·¯ç”±ç›¸å…³è®²è§£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[.NET 8 å®æ—¶æ¨é€é­”æ³•ï¼šSSE è®©æ•°æ® â€œä¸»åŠ¨è·‘â€ åˆ°å®¢æˆ·ç«¯]]></title>    <link>https://juejin.cn/post/7579441333166080009</link>    <guid>https://juejin.cn/post/7579441333166080009</guid>    <pubDate>2025-12-03T09:25:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579441333166080009" data-draft-id="7579440586693705774" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=".NET 8 å®æ—¶æ¨é€é­”æ³•ï¼šSSE è®©æ•°æ® â€œä¸»åŠ¨è·‘â€ åˆ°å®¢æˆ·ç«¯"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T09:25:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¹Œæ‰_loong"/> <meta itemprop="url" content="https://juejin.cn/user/4256947657515320"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            .NET 8 å®æ—¶æ¨é€é­”æ³•ï¼šSSE è®©æ•°æ® â€œä¸»åŠ¨è·‘â€ åˆ°å®¢æˆ·ç«¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4256947657515320/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¹Œæ‰_loong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:25:00.000Z" title="Wed Dec 03 2025 09:25:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>åœ¨å®æ—¶Webåº”ç”¨å¼€å‘ä¸­ï¼ŒServer-Sent Events(SSE)ä½œä¸ºä¸€ç§è½»é‡çº§çš„æœåŠ¡å™¨æ¨é€æŠ€æœ¯ï¼Œæ­£æˆä¸ºæå‡ç”¨æˆ·ä½“éªŒçš„é‡è¦æ–¹æ¡ˆã€‚SSEåŸºäºHTTPåè®®ï¼Œå…è®¸æœåŠ¡å™¨é€šè¿‡æŒä¹…è¿æ¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®æµï¼Œç‰¹åˆ«é€‚åˆæ–°é—»æ›´æ–°ã€å®æ—¶ç›‘æ§ç­‰åœºæ™¯ã€‚.NET 8é€šè¿‡æ€§èƒ½ä¼˜åŒ–å’ŒæœåŠ¡å™¨ç«¯å¢å¼ºï¼Œä¸ºSSEæä¾›äº†æ›´å¼ºå¤§çš„æ”¯æŒï¼Œä½¿å…¶æˆä¸ºæ„å»ºé«˜æ•ˆå®æ—¶åº”ç”¨çš„ç†æƒ³é€‰æ‹©ã€‚</p>
<h3 data-id="heading-1">åŸºæœ¬åŸç†</h3>
<p>SSEæ˜¯ä¸€ç§åŸºäºHTTP/1.1çš„å•å‘é€šä¿¡æŠ€æœ¯ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡text/event-stream MIMEç±»å‹å»ºç«‹æŒä¹…è¿æ¥ã€‚å®¢æˆ·ç«¯ä½¿ç”¨EventSourceæ¥å£ç›‘å¬æœåŠ¡å™¨æ¨é€çš„äº‹ä»¶æµï¼ŒæœåŠ¡å™¨åˆ™ä»¥åˆ†å—ç¼–ç å½¢å¼æŒç»­å‘é€æ•°æ®ã€‚ä¸è½®è¯¢ç›¸æ¯”ï¼ŒSSEæ˜¾è‘—é™ä½ç½‘ç»œå¼€é”€ï¼›ä¸WebSocketç›¸æ¯”ï¼ŒSSEå®ç°æ›´ç®€å•ï¼Œç‰¹åˆ«é€‚åˆæœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„å•å‘æ•°æ®æ¨é€ã€‚</p>
<h3 data-id="heading-2">åç«¯ä»£ç å®ç°</h3>
<h4 data-id="heading-3">1ã€Controllerå±‚ä»£ç å®ç°</h4>
<pre><code class="hljs language-C#" lang="C#"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> å»ºç«‹ SSE æµè¿æ¥çš„ç«¯ç‚¹</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> å®¢æˆ·ç«¯é€šè¿‡æ­¤ç«¯ç‚¹å»ºç«‹æŒä¹…è¿æ¥ä»¥æ¥æ”¶æœåŠ¡å™¨æ¨é€çš„äº‹ä»¶</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¯é€‰ï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
[<span class="hljs-meta">HttpGet(<span class="hljs-string">"stream"</span>)</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">StreamEvents</span>(<span class="hljs-params">[FromQuery] <span class="hljs-built_in">string</span> clientId</span>)</span>
{
    <span class="hljs-comment">// å¦‚æœå®¢æˆ·ç«¯æœªæä¾›IDï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ID</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(clientId))
    {
        clientId = Guid.NewGuid().ToString();
    }

    <span class="hljs-comment">// è®¾ç½®å“åº”å¤´ä»¥æ”¯æŒ SSE åè®®</span>
    Response.Headers.Append(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/event-stream"</span>);         <span class="hljs-comment">// æŒ‡å®šå†…å®¹ç±»å‹ä¸º SSE</span>
    Response.Headers.Append(<span class="hljs-string">"Cache-Control"</span>, <span class="hljs-string">"no-cache"</span>);                 <span class="hljs-comment">// ç¦ç”¨ç¼“å­˜</span>
    Response.Headers.Append(<span class="hljs-string">"Connection"</span>, <span class="hljs-string">"keep-alive"</span>);                  <span class="hljs-comment">// ä¿æŒè¿æ¥</span>
    Response.Headers.Append(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>);          <span class="hljs-comment">// å…è®¸è·¨åŸŸè®¿é—®</span>

    <span class="hljs-comment">// å°†å½“å‰å®¢æˆ·ç«¯æ·»åŠ åˆ° SSE æœåŠ¡ç®¡ç†å™¨ä¸­</span>
    <span class="hljs-keyword">await</span> _sseService.AddClientAsync(clientId, Response);

    <span class="hljs-comment">// ä¿æŒè¿æ¥æ‰“å¼€ï¼Œç›´åˆ°å®¢æˆ·ç«¯æ–­å¼€æˆ–è¯·æ±‚è¢«å–æ¶ˆ</span>
    <span class="hljs-keyword">try</span>
    {
        <span class="hljs-comment">// å¾ªç¯æ£€æŸ¥è¯·æ±‚æ˜¯å¦å·²è¢«å–æ¶ˆ</span>
        <span class="hljs-keyword">while</span> (!HttpContext.RequestAborted.IsCancellationRequested)
        {
            <span class="hljs-comment">// æ¯éš”1ç§’æ£€æŸ¥ä¸€æ¬¡è¿æ¥çŠ¶æ€</span>
            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">1000</span>, HttpContext.RequestAborted);
        }
    }
    <span class="hljs-keyword">catch</span> (OperationCanceledException)
    {
        _logger.LogInformation(<span class="hljs-string">$"Client <span class="hljs-subst">{clientId}</span> disconnected (canceled)"</span>);
    }
    <span class="hljs-keyword">catch</span> (Exception ex)
    {
        _logger.LogError(ex, <span class="hljs-string">$"Error in SSE stream for client: <span class="hljs-subst">{clientId}</span>"</span>);
    }
    <span class="hljs-keyword">finally</span>
    {
        <span class="hljs-keyword">await</span> _sseService.RemoveClientAsync(clientId);
        _logger.LogInformation(<span class="hljs-string">$"SSE connection cleaned up for client: <span class="hljs-subst">{clientId}</span>"</span>);
    }
}
</code></pre>
<h4 data-id="heading-4">2ã€Serviceä»£ç å®ç°</h4>
<pre><code class="hljs language-C#" lang="C#"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> Server-Sent Events (SSE) æœåŠ¡æ¥å£</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æä¾›å‘å®¢æˆ·ç«¯æ¨é€å®æ—¶äº‹ä»¶çš„åŠŸèƒ½</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ISseService</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€äº‹ä»¶æ•°æ®</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å‘é€çš„æ•°æ®<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">SendEventAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, <span class="hljs-built_in">string</span> data</span>)</span>;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€æŒ‡å®šç±»å‹çš„äº‹ä»¶æ•°æ®</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="eventType"&gt;</span>äº‹ä»¶ç±»å‹<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å‘é€çš„æ•°æ®<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">SendEventAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, <span class="hljs-built_in">string</span> eventType, <span class="hljs-built_in">string</span> data</span>)</span>;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ·»åŠ æ–°çš„ SSE å®¢æˆ·ç«¯è¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="response"&gt;</span>HTTP å“åº”å¯¹è±¡<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">AddClientAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, HttpResponse response</span>)</span>;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ç§»é™¤æŒ‡å®šçš„å®¢æˆ·ç«¯è¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">RemoveClientAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId</span>)</span>;

    <span class="hljs-function">Task <span class="hljs-title">BroadcastAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> data</span>)</span>;
    <span class="hljs-function">Task <span class="hljs-title">BroadcastAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> eventType, <span class="hljs-built_in">string</span> data</span>)</span>;
}


<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> SSE æœåŠ¡å®ç°ç±»</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ç®¡ç†æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥å¹¶å‘å…¶æ¨é€å®æ—¶æ•°æ®</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SseService</span> : <span class="hljs-title">ISseService</span>
{
    <span class="hljs-keyword">private</span> ILogger&lt;SseService&gt; _logger;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SseService</span>(<span class="hljs-params">ILogger&lt;SseService&gt; logger</span>)</span>
    {
        _logger = logger;
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å­˜å‚¨æ‰€æœ‰æ´»åŠ¨çš„å®¢æˆ·ç«¯è¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„å­—å…¸å­˜å‚¨å®¢æˆ·ç«¯IDå’Œå¯¹åº”çš„HttpResponse</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConcurrentDictionary&lt;<span class="hljs-built_in">string</span>, HttpResponse&gt; _clients = <span class="hljs-keyword">new</span>();

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ·»åŠ æ–°çš„ SSE å®¢æˆ·ç«¯è¿æ¥åˆ°ç®¡ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="response"&gt;</span>HTTP å“åº”å¯¹è±¡<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">AddClientAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, HttpResponse response</span>)</span>
    {
        <span class="hljs-comment">// å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°è¿æ¥å­—å…¸ä¸­</span>
        _clients.TryAdd(clientId, response);
        <span class="hljs-comment">// å‘é€è¿æ¥ç¡®è®¤äº‹ä»¶ç»™å®¢æˆ·ç«¯</span>
        <span class="hljs-keyword">await</span> SendEventAsync(clientId, <span class="hljs-string">"connection"</span>, <span class="hljs-string">$"Connected with ID: <span class="hljs-subst">{clientId}</span>"</span>);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ä»ç®¡ç†å™¨ä¸­ç§»é™¤æŒ‡å®šçš„å®¢æˆ·ç«¯è¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>è¦ç§»é™¤çš„å®¢æˆ·ç«¯ID<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RemoveClientAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId</span>)</span>
    {
        <span class="hljs-comment">// å°è¯•ä»å­—å…¸ä¸­ç§»é™¤å®¢æˆ·ç«¯å¹¶è·å–å…¶å“åº”å¯¹è±¡</span>
        <span class="hljs-keyword">if</span> (_clients.TryRemove(clientId, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> response))
        {
            <span class="hljs-comment">// å®Œæˆ HTTP å“åº”</span>
            <span class="hljs-comment">//await response.CompleteAsync(); </span>
            <span class="hljs-comment">// æ¸…ç©ºç¼“å†²åŒºå¹¶å…³é—­æµã€‚è¿™å®é™…ä¸Šç­‰åŒäºå®Œæˆäº†å“åº”ã€‚ä½†æ›´å¸¸ç”¨çš„æ˜¯ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨æ­¤æ–¹æ³•ã€‚ </span>
            <span class="hljs-keyword">await</span> response.Body.FlushAsync();
        }
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€é»˜è®¤ç±»å‹çš„äº‹ä»¶æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>ç›®æ ‡å®¢æˆ·ç«¯ID<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å‘é€çš„æ•°æ®<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">SendEventAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, <span class="hljs-built_in">string</span> data</span>)</span>
    {
        <span class="hljs-comment">// è°ƒç”¨é‡è½½æ–¹æ³•ï¼Œä½¿ç”¨é»˜è®¤çš„æ¶ˆæ¯ç±»å‹</span>
        <span class="hljs-keyword">await</span> SendEventAsync(clientId, <span class="hljs-string">"message"</span>, data);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€æŒ‡å®šç±»å‹çš„äº‹ä»¶æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="clientId"&gt;</span>ç›®æ ‡å®¢æˆ·ç«¯ID<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="eventType"&gt;</span>äº‹ä»¶ç±»å‹ï¼ˆå¦‚ï¼šmessage, notification, updateç­‰ï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å‘é€çš„æ•°æ®å†…å®¹<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">SendEventAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> clientId, <span class="hljs-built_in">string</span> eventType, <span class="hljs-built_in">string</span> data</span>)</span>
    {
        <span class="hljs-comment">// æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦ä»ç„¶è¿æ¥</span>
        <span class="hljs-keyword">if</span> (_clients.TryGetValue(clientId, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> response))
        {
            <span class="hljs-keyword">try</span>
            {
                <span class="hljs-comment">// æŒ‰ç…§ SSE æ ¼å¼å†™å…¥äº‹ä»¶ç±»å‹</span>
                <span class="hljs-keyword">await</span> response.WriteAsync(<span class="hljs-string">$"event: <span class="hljs-subst">{eventType}</span>\n"</span>);
                <span class="hljs-comment">// æŒ‰ç…§ SSE æ ¼å¼å†™å…¥æ•°æ®å†…å®¹</span>
                <span class="hljs-keyword">await</span> response.WriteAsync(<span class="hljs-string">$"data: <span class="hljs-subst">{data}</span>\n\n"</span>);
                <span class="hljs-comment">// åˆ·æ–°å“åº”æµï¼Œç¡®ä¿æ•°æ®ç«‹å³å‘é€åˆ°å®¢æˆ·ç«¯</span>
                <span class="hljs-keyword">await</span> response.Body.FlushAsync();
            }
            <span class="hljs-keyword">catch</span>
            {
                <span class="hljs-comment">// å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼ˆå¦‚å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼‰ï¼Œåˆ™ç§»é™¤è¯¥å®¢æˆ·ç«¯</span>
                <span class="hljs-keyword">await</span> RemoveClientAsync(clientId);
            }
        }
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯å¹¿æ’­æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å¹¿æ’­çš„æ•°æ®<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">BroadcastAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> data</span>)</span>
    {
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºå‘é€ä»»åŠ¡å¹¶ç­‰å¾…å…¨éƒ¨å®Œæˆ</span>
        <span class="hljs-keyword">var</span> tasks = _clients.Keys.Select(clientId =&gt; SendEventAsync(clientId, data));
        <span class="hljs-keyword">await</span> Task.WhenAll(tasks);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯å¹¿æ’­æŒ‡å®šç±»å‹çš„äº‹ä»¶</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="eventType"&gt;</span>äº‹ä»¶ç±»å‹<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="data"&gt;</span>è¦å¹¿æ’­çš„æ•°æ®<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">BroadcastAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> eventType, <span class="hljs-built_in">string</span> data</span>)</span>
    {
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºå‘é€ä»»åŠ¡å¹¶ç­‰å¾…å…¨éƒ¨å®Œæˆ</span>
        <span class="hljs-keyword">var</span> tasks = _clients.Keys.Select(clientId =&gt; SendEventAsync(clientId, eventType, data));
        <span class="hljs-keyword">await</span> Task.WhenAll(tasks);
    }
}
</code></pre>
<h3 data-id="heading-5">æ¨¡æ‹Ÿå‘é€æ•°æ®</h3>
<pre><code class="hljs language-C#" lang="C#">è¿™é‡Œåªæ˜¯ä¸ºäº†æ¨¡æ‹Ÿæ•°æ®,å…·ä½“å¯æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åšå‡ºè°ƒæ•´

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> SSE åå°æœåŠ¡</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å®šæœŸå‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯æ¨é€æ•°æ®æ›´æ–°</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SseBackgroundService</span> : <span class="hljs-title">BackgroundService</span>
    {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ISseService _sseService;
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> æ—¥å¿—è®°å½•å™¨ï¼Œç”¨äºè®°å½•æœåŠ¡è¿è¡ŒçŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;SseBackgroundService&gt; _logger;

        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> æ„é€ å‡½æ•°ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥è·å–æ‰€éœ€çš„æœåŠ¡</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="scopeFactory"&gt;</span>æœåŠ¡ä½œç”¨åŸŸå·¥å‚<span class="hljs-doctag">&lt;/param&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="logger"&gt;</span>æ—¥å¿—è®°å½•å™¨<span class="hljs-doctag">&lt;/param&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SseBackgroundService</span>(<span class="hljs-params">ISseService sseService, ILogger&lt;SseBackgroundService&gt; logger</span>)</span>
        {
            _sseService = sseService;
            _logger = logger;
        }

        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> åå°æœåŠ¡æ‰§è¡Œæ–¹æ³•</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> å®šæœŸæ‰§è¡Œä»»åŠ¡ç›´åˆ°æœåŠ¡åœæ­¢</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="stoppingToken"&gt;</span>æœåŠ¡åœæ­¢é€šçŸ¥ä»¤ç‰Œ<span class="hljs-doctag">&lt;/param&gt;</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ExecuteAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span>
        {
            <span class="hljs-comment">// å¾ªç¯æ‰§è¡Œç›´åˆ°æ”¶åˆ°åœæ­¢ä¿¡å·</span>
            <span class="hljs-keyword">while</span> (!stoppingToken.IsCancellationRequested)
            {
                <span class="hljs-keyword">try</span>
                {
                    <span class="hljs-comment">// å‡†å¤‡è¦å¹¿æ’­çš„äº‹ä»¶æ•°æ®</span>
                    <span class="hljs-keyword">var</span> eventData = <span class="hljs-keyword">new</span>
                    {
                        timestamp = DateTime.UtcNow,                    <span class="hljs-comment">// å½“å‰ UTC æ—¶é—´æˆ³</span>
                        message = <span class="hljs-string">"Server time update"</span>,                 <span class="hljs-comment">// æ¶ˆæ¯å†…å®¹</span>
                        temperature = Random.Shared.Next(<span class="hljs-number">20</span>, <span class="hljs-number">30</span>)        <span class="hljs-comment">// æ¨¡æ‹Ÿæ¸©åº¦æ•°æ®</span>
                    };

                    <span class="hljs-comment">// å°†äº‹ä»¶æ•°æ®å¹¿æ’­ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯</span>
                    <span class="hljs-keyword">await</span> _sseService.BroadcastAsync(<span class="hljs-string">"time-update"</span>, JsonSerializer.Serialize(eventData));

                    <span class="hljs-comment">// ç­‰å¾… 5 ç§’åç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œæ”¯æŒå–æ¶ˆæ“ä½œ</span>
                    <span class="hljs-keyword">await</span> Task.Delay(TimeSpan.FromSeconds(<span class="hljs-number">5</span>), stoppingToken);
                }
                <span class="hljs-keyword">catch</span> (Exception ex)
                {
                    <span class="hljs-comment">// è®°å½•æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸</span>
                    _logger.LogError(ex, <span class="hljs-string">"Error in SSE background service"</span>);
                }
            }
        }
    }
</code></pre>
<h3 data-id="heading-6">å…¶ä»–é…ç½®</h3>
<pre><code class="hljs language-C#" lang="C#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        <span class="hljs-keyword">var</span> builder = WebApplication.CreateBuilder(args);

        ConfigureAutofac(builder);

        <span class="hljs-comment">// Add services to the container.</span>
        builder.Services.AddControllers();

        builder.Services.AddEndpointsApiExplorer();
        builder.Services.AddSwaggerGen();

        <span class="hljs-keyword">var</span> app = builder.Build();
        <span class="hljs-comment">// Configure the HTTP request pipeline.</span>
        <span class="hljs-keyword">if</span> (app.Environment.IsDevelopment())
        {
            app.UseSwagger();
            app.UseSwaggerUI();
        }

        app.UseHttpsRedirection();
        app.UseAuthorization();
        app.MapControllers();
        app.Run();
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> é…ç½® Autofac</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="builder"&gt;</span><span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureAutofac</span>(<span class="hljs-params">WebApplicationBuilder builder</span>)</span>
    {
        <span class="hljs-comment">// é…ç½® Autofac ä½œä¸º DI å®¹å™¨</span>
        builder.Host.UseServiceProviderFactory(<span class="hljs-keyword">new</span> AutofacServiceProviderFactory());

        <span class="hljs-comment">// é…ç½®å®¹å™¨æ³¨å†Œ</span>
        builder.Host.ConfigureContainer&lt;ContainerBuilder&gt;(containerBuilder =&gt;
        {
            <span class="hljs-comment">// é‡ç‚¹å†…å®¹ï¼Œè¿™é‡Œå¿…é¡»è¦æ³¨å†Œæˆå•ä¾‹æ¨¡å¼</span>
            containerBuilder.RegisterType&lt;SseService&gt;().As&lt;ISseService&gt;().SingleInstance();
            <span class="hljs-comment">// Autofacæ³¨å†Œ</span>
            containerBuilder.RegisterModule(<span class="hljs-keyword">new</span> AutofacModuleRegister());
            <span class="hljs-comment">// æ³¨å†Œåå°æœåŠ¡ï¼Œé¡¹ç›®å¯åŠ¨æ—¶å°±ä¼šæ‰§è¡Œ</span>
            containerBuilder.RegisterType&lt;SseBackgroundService&gt;().As&lt;IHostedService&gt;();
        });
    }
}
</code></pre>
<h3 data-id="heading-7">å‰ç«¯ä»£ç </h3>
<pre><code class="hljs language-JS" lang="JS">&lt;script&gt;
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// è¿æ¥åˆ° SSE æµ</span>
        <span class="hljs-keyword">const</span> clientId = <span class="hljs-string">'client-'</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>);
        <span class="hljs-keyword">const</span> eventSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(<span class="hljs-string">`æ›¿æ¢æˆä½ çš„åŸŸå/api/sse/stream?clientId=<span class="hljs-subst">${clientId}</span>`</span>);

        eventSource.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SSE connection opened'</span>);
        };

        eventSource.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Message received:'</span>, event.<span class="hljs-property">data</span>);
        };

        eventSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'connection'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Connection event:'</span>, event.<span class="hljs-property">data</span>);
        });

        eventSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'time-update'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
            <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Time update:'</span>, data);
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'server-time'</span>).<span class="hljs-property">innerText</span> = data.<span class="hljs-property">timestamp</span>;
        });

        eventSource.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'SSE error occurred'</span>);
        };
    }
        
&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Send message"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sendMessage()"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

</code></pre>
<h3 data-id="heading-8">æœ€åæ•ˆæœ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7232f428961947089094012115f48196~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bmM5omNX2xvb25n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360290&amp;x-signature=rpQs4gsA5ciwLpzqn62ISlD%2FEcI%3D" alt="81607923-dbcd-4be4-854c-89d2042e6dad.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Paimon Branch --- æµæ‰¹ä¸€ä½“åŒ–ä¹‹äºŒ]]></title>    <link>https://juejin.cn/post/7579427549471752238</link>    <guid>https://juejin.cn/post/7579427549471752238</guid>    <pubDate>2025-12-03T09:25:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579427549471752238" data-draft-id="7579451710302044186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Paimon Branch --- æµæ‰¹ä¸€ä½“åŒ–ä¹‹äºŒ"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Flink"/> <meta itemprop="datePublished" content="2025-12-03T09:25:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="expect7g"/> <meta itemprop="url" content="https://juejin.cn/user/3514471387235735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Paimon Branch --- æµæ‰¹ä¸€ä½“åŒ–ä¹‹äºŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3514471387235735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    expect7g
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:25:12.000Z" title="Wed Dec 03 2025 09:25:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Branchæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>å¯ä»¥ç†è§£ä¸ºæ˜¯gitçš„åˆ†æ”¯ï¼Œåˆ†ä¸ºä¸»åˆ†æ”¯ã€devåˆ†æ”¯ç­‰ç­‰ï¼Œè€Œæœ€åè¯»å–çš„æ—¶å€™å°±ç›¸å½“äºæ˜¯åˆ†æ”¯çš„ä¸€ä¸ªmergeåˆå¹¶</p>
<p>åœ¨æµå¼æ•°æ®å¤„ç†ä¸­ï¼Œæ•°æ®å¯èƒ½å› ä¸ºä¹±åºç­‰é—®é¢˜ï¼Œå­˜åœ¨ä¸å‡†ç¡®çš„æƒ…å†µï¼Œè¿™æ˜¯å®æ—¶çš„é€šç—…ï¼Œè€Œå®æ—¶ä¿®æ­£æ•°æ®å­˜åœ¨å›°éš¾ï¼Œé‚£ä¹ˆä¸ºäº†è§£å†³è¿™ä¸ªè¡¥æ•°çš„æƒ…å†µï¼Œå› æ­¤Paimonæ¨å‡ºäº†Branchåˆ†æ”¯æœºåˆ¶ã€‚</p>
<p>å‡è®¾ç°æœ‰å·¥ä½œæµå¤„ç†çš„åˆ†æ”¯ä¸ºâ€œä¸»åˆ†æ”¯â€ï¼Œé€šè¿‡åˆ›å»ºè‡ªå®šä¹‰æ•°æ®åˆ†æ”¯ï¼Œå¯åœ¨ä¸åœæ­¢ç°æœ‰è¯»å†™å·¥ä½œæµä¸”æ— éœ€å¤åˆ¶ä¸»åˆ†æ”¯æ•°æ®çš„å‰æä¸‹ï¼Œå¯¹ç°æœ‰è¡¨è¿›è¡Œæ–°ä»»åŠ¡çš„å®éªŒæµ‹è¯•ä¸æ•°æ®éªŒè¯ã€‚</p>
<p>å€ŸåŠ©åˆå¹¶æˆ–æ›¿æ¢åˆ†æ”¯æ“ä½œï¼Œå³å¯å®Œæˆæ•°æ®ä¿®æ­£å·¥ä½œã€‚</p>
<h3 data-id="heading-1">(1) Branchçš„åˆ›å»ºå’Œåˆ é™¤</h3>
<p>é¦–å…ˆéœ€è¦åˆ›å»ºbranchï¼ŒPaimonæ”¯æŒä»ç‰¹å®šæ ‡ç­¾åˆ›å»ºåˆ†æ”¯ï¼Œæˆ–ç›´æ¥åˆ›å»ºç©ºåˆ†æ”¯â€”â€”è¿™æ„å‘³ç€åˆ›å»ºçš„åˆ†æ”¯åˆå§‹çŠ¶æ€å¦‚åŒç©ºç™½è¡¨æ ¼ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä»tag1ä¸­å¯¹table1åˆ›å»ºtest-branchåˆ†æ”¯</span>
<span class="hljs-keyword">CALL</span> sys.create_branch(<span class="hljs-string">'default.table1'</span>, <span class="hljs-string">'test-branch'</span>, <span class="hljs-string">'tag1'</span>);

<span class="hljs-comment">-- ç›´æ¥å¯¹table2åˆ›å»ºä¸€ä¸ªç©ºçš„tese-branch2åˆ†æ”¯</span>
<span class="hljs-keyword">CALL</span> sys.create_branch(<span class="hljs-string">'default.table2'</span>, <span class="hljs-string">'test-branch2'</span>);

<span class="hljs-comment">-- åˆ é™¤æŒ‡å®šbranch</span>
<span class="hljs-keyword">CALL</span> sys.delete_branch(<span class="hljs-string">'default.table3'</span>, <span class="hljs-string">'branch1'</span>);
</code></pre>
<h3 data-id="heading-2">(2) Branchçš„ä½¿ç”¨ -- è¯»å†™</h3>
<p>é»˜è®¤Branchåˆ†æ”¯æ˜¯mainï¼Œå¹¶ä¸”Branchæœ‰é»˜è®¤çš„å‰ç¼€æ˜¯branch_</p>
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¯»å†™ç‰¹å®šçš„Branchï¼Œæœ‰2ç§æ–¹å¼</p>
<h4 data-id="heading-3">&lt;1&gt; æ–¹å¼ä¸€ï¼šsqlå°±æŒ‡å®šå¥½ï¼Œè¯»å†™é‚£ä¸ªBranch</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å¯¹è¡¨tä»Branchä¸ºtest-branchå»è¯»æ•°æ®</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `t$branch_test<span class="hljs-operator">-</span>branch`; <span class="hljs-comment">-- æ‰¹</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `t$branch_test<span class="hljs-operator">-</span>branch` <span class="hljs-comment">/*+ OPTIONS('consumer-id' = 'myid') */</span>; <span class="hljs-comment">-- æµ</span>

<span class="hljs-comment">-- å¾€è¡¨tçš„test2åˆ†æ”¯å»å†™</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t$branch_test2` 
<span class="hljs-keyword">SELECT</span> ...
</code></pre>
<h4 data-id="heading-4">&lt;2&gt; æ–¹å¼äºŒï¼šé‡‡ç”¨Fallback Branch -- æµæ‰¹ä¸€ä½“ä¹‹äºŒ</h4>
<p>è¿™ä¸ªåŸç†å°±æ˜¯ï¼šè®¾ç½®ä¸ºfallbackåˆ†æ”¯å, å½“æŸ¥è¯¢/å†™å…¥çš„åˆ†åŒºåœ¨ä¸»åˆ†æ”¯ä¸å­˜åœ¨æ—¶ï¼Œpaimon readerä¼šä»<code>scan.fallback-branch</code>æŒ‡å®šçš„åˆ†æ”¯å»è¿›è¡Œæ“ä½œ</p>
<p>å› æ­¤ï¼Œå°±å¯ä»¥é’ˆå¯¹æµæ‰¹ä¸€ä½“åšä¸€äº›æ“ä½œï¼Œæ¯”å¦‚ç¦»çº¿çš„æ‰¹æ•°æ®æ­£å¸¸å†™å…¥åˆ°æ˜¨æ—¥çš„åˆ†åŒºä¸­ï¼Œè€Œå®æ—¶æ•°æ®å†™åˆ°ä»Šæ—¥çš„Fallback Branchåˆ†æ”¯çš„åˆ†åŒºä¸­</p>
<p>æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1.åˆ›å»ºä¸€ä¸ªTè¡¨ï¼ŒæŒ‰ç…§dtåˆ†åŒº</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> T (
    dt STRING <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    name STRING <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    amount <span class="hljs-type">BIGINT</span>
) PARTITIONED <span class="hljs-keyword">BY</span> (dt);

<span class="hljs-comment">-- 2.ä¸ºæµå¤„ç†åˆ›å»ºä¸€ä¸ªBranchï¼Œå«test</span>
<span class="hljs-keyword">CALL</span> sys.create_branch(<span class="hljs-string">'default.T'</span>, <span class="hljs-string">'test'</span>);

<span class="hljs-comment">-- 3.å¯¹teståˆ†æ”¯è¿›è¡Œä¿®æ”¹å±æ€§</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> `T$branch_test` <span class="hljs-keyword">SET</span> (
    <span class="hljs-string">'primary-key'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'dt,name'</span>,
    <span class="hljs-string">'bucket'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'2'</span>,
    <span class="hljs-string">'changelog-producer'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'lookup'</span>
);

<span class="hljs-comment">-- 4.è®¾ç½®Fallback Branch ä¸º teståˆ†æ”¯</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> T <span class="hljs-keyword">SET</span> (
    <span class="hljs-string">'scan.fallback-branch'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'test'</span>
);

<span class="hljs-comment">-- 5.æµå¼å†™å…¥ï¼Œå†™å…¥åˆ°Tè¡¨çš„teståˆ†æ”¯çš„20240726åˆ†åŒºä¸­</span>
(è¿™é‡Œå¦‚æœå…¨éƒ¨éƒ½æ˜¯<span class="hljs-number">20250726</span>åˆ†åŒºçš„æ•°æ®ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¸å†™$branch_testï¼Œå› ä¸ºTè¡¨æ˜¯æ²¡æœ‰<span class="hljs-number">20240726</span>åˆ†åŒºçš„ï¼Œä¼šå»Fallback Branchåˆ†æ”¯ä¸­æ“ä½œï¼Œä½†æ˜¯å»ºè®®æ˜¯å¸¦ä¸Š$branch_test)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `T$branch_test` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'20240725'</span>, <span class="hljs-string">'apple'</span>, <span class="hljs-number">4</span>), (<span class="hljs-string">'20240725'</span>, <span class="hljs-string">'peach'</span>, <span class="hljs-number">10</span>), (<span class="hljs-string">'20240726'</span>, <span class="hljs-string">'cherry'</span>, <span class="hljs-number">3</span>), (<span class="hljs-string">'20240726'</span>, <span class="hljs-string">'pear'</span>, <span class="hljs-number">6</span>);

<span class="hljs-comment">-- 6.æ‰¹å¼å†™å…¥Tçš„ä¸»åˆ†æ”¯</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> T <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'20240725'</span>, <span class="hljs-string">'apple'</span>, <span class="hljs-number">5</span>), (<span class="hljs-string">'20240725'</span>, <span class="hljs-string">'banana'</span>, <span class="hljs-number">7</span>);

<span class="hljs-comment">-- 7.æŸ¥è¡¨çš„æ—¶å€™ï¼Œå¼•æ“ä¼šåˆå¹¶Branchåˆ†æ”¯çš„æ•°æ®ï¼Œå› æ­¤æŸ¥è¯¢ï¼Œæ˜¯èƒ½æŸ¥åˆ°20240726åˆ†åŒºçš„æ•°æ®çš„</span>
<span class="hljs-comment">-- åˆå¹¶çš„é€»è¾‘æ˜¯mainæ²¡æœ‰çš„åˆ†åŒºï¼Œä»Fallback Branchä¸­æ‹¿æ•°æ®ï¼Œmainæœ‰çš„åˆ†åŒºï¼Œä»mainæ‹¿</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> T;
<span class="hljs-comment">/*
+------------------+------------------+--------+
|               dt |             name | amount |
+------------------+------------------+--------+
|         20240725 |            apple |      5 |
|         20240725 |           banana |      7 |
|         20240726 |           cherry |      3 |
|         20240726 |             pear |      6 |
+------------------+------------------+--------+
*/</span>

<span class="hljs-comment">-- é‡ç½®fallback branch</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> T RESET ( <span class="hljs-string">'scan.fallback-branch'</span> );

<span class="hljs-comment">-- è¿™æ ·è¯»çš„è¯ï¼Œå°±åªèƒ½è¯»mainä¸»åˆ†æ”¯çš„æ•°æ®äº†</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> T;
<span class="hljs-comment">/*
+------------------+------------------+--------+
|               dt |             name | amount |
+------------------+------------------+--------+
|         20240725 |            apple |      5 |
|         20240725 |           banana |      7 |
+------------------+------------------+--------+
*/</span>
</code></pre>
<h3 data-id="heading-5">(3) æ€»ç»“</h3>
<p>é’ˆå¯¹å®æ—¶æ•°æ®ä¸å‡†ç¡®ï¼Œéœ€è¦è¡¥æ•°ï¼Œä¿®æ”¹çš„æ“ä½œï¼Œä¼ ç»Ÿåšæ³•æ˜¯ç¦»çº¿è¦†ç›–å®æ—¶æ˜¨æ—¥ï¼Œåˆ†åˆ«è½ä¸¤ä¸ªè¡¨ï¼Œç»´æŠ¤ä¸¤å¥—ç³»ç»Ÿï¼Œè¿™å¯¹å¼€å‘è€Œå·²æ˜¯å¾ˆæµªè´¹èµ„æºçš„é—®é¢˜ï¼Œå› æ­¤ï¼ŒPaimonæ¨å‡ºäº†Branchæ“ä½œï¼Œå»å®ç°ä¸€å¥—sqlä¸€å¼ è¡¨ï¼Œä¸åŒçš„Branchå»å­˜å®æ—¶å’Œç¦»çº¿çš„æ•°æ®ï¼Œäº’ç›¸ä¸å½±å“ï¼ŒæŸ¥è¯¢çš„æ—¶å€™åˆèƒ½æ—¢æŸ¥å‡ºå®æ—¶çš„ï¼Œä¹ŸæŸ¥å‡ºç¦»çº¿çš„</p>
<p>æ–¹æ¡ˆå°±æ˜¯ï¼š</p>
<ol>
<li>ç¦»çº¿è·‘mainä¸»åˆ†æ”¯ï¼Œç›´æ¥insert overwrite/into</li>
<li>å®æ—¶çš„è·‘Fallback BranchæŒ‡å®šåˆ†æ”¯ï¼Œåªèƒ½insert into</li>
<li>æŸ¥è¯¢æ—¶ï¼ŒPaimon readerä¼šå»åˆå¹¶ï¼š<strong>ä¼˜å…ˆè¯»å–ä¸»åˆ†æ”¯ï¼ˆmainï¼‰çš„åˆ†åŒºæ•°æ®ï¼›å¦‚æœ main åˆ†æ”¯æ²¡æœ‰è¯¥åˆ†åŒºï¼Œæ‰ä» Fallback Branch è¯»å–è¯¥åˆ†åŒºçš„è¡¥å……æ•°æ®</strong></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java æŠ½è±¡ç±» vs æ¥å£ï¼šç›¸åŒç‚¹ä¸ä¸åŒç‚¹]]></title>    <link>https://juejin.cn/post/7579313396207665167</link>    <guid>https://juejin.cn/post/7579313396207665167</guid>    <pubDate>2025-12-03T09:27:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579313396207665167" data-draft-id="7579385656779964450" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java æŠ½è±¡ç±» vs æ¥å£ï¼šç›¸åŒç‚¹ä¸ä¸åŒç‚¹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T09:27:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å‘¨åœ¨æˆé•¿"/> <meta itemprop="url" content="https://juejin.cn/user/3632442150752573"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java æŠ½è±¡ç±» vs æ¥å£ï¼šç›¸åŒç‚¹ä¸ä¸åŒç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3632442150752573/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å‘¨åœ¨æˆé•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:27:36.000Z" title="Wed Dec 03 2025 09:27:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ¯ å¿«é€Ÿå¯¹æ¯”è¡¨</h2>


















































<table><thead><tr><th>ç‰¹æ€§</th><th>æŠ½è±¡ç±»</th><th>æ¥å£</th></tr></thead><tbody><tr><td><strong>å…³é”®å­—</strong></td><td><code>abstract class</code></td><td><code>interface</code></td></tr><tr><td><strong>å®ä¾‹åŒ–</strong></td><td>âŒ ä¸èƒ½</td><td>âŒ ä¸èƒ½</td></tr><tr><td><strong>ç»§æ‰¿/å®ç°</strong></td><td>å•ç»§æ‰¿</td><td>å¤šå®ç°</td></tr><tr><td><strong>æ–¹æ³•ç±»å‹</strong></td><td>æŠ½è±¡ + å…·ä½“</td><td>é»˜è®¤åªæœ‰æŠ½è±¡ï¼ˆJava 8å‰ï¼‰</td></tr><tr><td><strong>æ„é€ å™¨</strong></td><td>âœ… æœ‰</td><td>âŒ æ— </td></tr><tr><td><strong>å˜é‡</strong></td><td>ä»»æ„ç±»å‹</td><td>åªèƒ½æ˜¯å¸¸é‡</td></tr><tr><td><strong>è®¿é—®ä¿®é¥°ç¬¦</strong></td><td>ä»»æ„</td><td>é»˜è®¤ <code>public</code></td></tr><tr><td><strong>è®¾è®¡ç›®çš„</strong></td><td>ä»£ç å¤ç”¨ + è§„èŒƒ</td><td>å®šä¹‰å¥‘çº¦/èƒ½åŠ›</td></tr></tbody></table>
<h2 data-id="heading-1">ğŸ” ç›¸åŒç‚¹</h2>
<h3 data-id="heading-2"><strong>1. éƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractClass</span> {
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// æ¥å£ä¸èƒ½å®ä¾‹åŒ–</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Interface</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CannotInstantiate</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// âŒ ä¸¤è€…éƒ½ä¸èƒ½ç›´æ¥new</span>
        <span class="hljs-comment">// AbstractClass obj1 = new AbstractClass();  // ç¼–è¯‘é”™è¯¯</span>
        <span class="hljs-comment">// Interface obj2 = new Interface();         // ç¼–è¯‘é”™è¯¯</span>
    }
}
</code></pre>
<h3 data-id="heading-3"><strong>2. éƒ½å¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimalClass</span> {
    <span class="hljs-comment">// æŠ½è±¡ç±»å¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">AnimalInterface</span> {
    <span class="hljs-comment">// æ¥å£æ–¹æ³•é»˜è®¤æ˜¯æŠ½è±¡çš„</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// ç­‰ä»·äº public abstract void makeSound()</span>
}

<span class="hljs-comment">// å­ç±»/å®ç°ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnimalClass</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±ªæ±ª"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AnimalInterface</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å–µå–µ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-4"><strong>3. éƒ½æ”¯æŒå¤šæ€</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Drawable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç”»åœ†å½¢"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Drawable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç”»æ­£æ–¹å½¢"</span>);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolymorphismDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æŠ½è±¡ç±»çš„å¤šæ€</span>
        <span class="hljs-type">Shape</span> <span class="hljs-variable">shape</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>();
        shape.draw();  <span class="hljs-comment">// ç”»åœ†å½¢</span>
        
        <span class="hljs-comment">// æ¥å£çš„å¤šæ€</span>
        <span class="hljs-type">Drawable</span> <span class="hljs-variable">drawable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>();
        drawable.draw();  <span class="hljs-comment">// ç”»æ­£æ–¹å½¢</span>
        
        <span class="hljs-comment">// éƒ½å¯ä»¥ç”¨æ•°ç»„ç»Ÿä¸€ç®¡ç†</span>
        Shape[] shapes = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>()};
        Drawable[] drawables = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>()};
    }
}
</code></pre>
<h2 data-id="heading-5">âš¡ ä¸åŒç‚¹</h2>
<h3 data-id="heading-6"><strong>1. ç»§æ‰¿ vs å®ç°ï¼ˆæ ¸å¿ƒåŒºåˆ«ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å•ç»§æ‰¿ï¼šä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Engine</span> {
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦è¡Œé©¶"</span>);
    }
}

<span class="hljs-comment">/*
class HybridCar extends Vehicle, Engine {  
    // âŒ é”™è¯¯ï¼šä¸èƒ½ç»§æ‰¿å¤šä¸ªæŠ½è±¡ç±»
}
*/</span>

<span class="hljs-comment">// å¤šå®ç°ï¼šä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Flyable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Swimmable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Duck</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Flyable</span>, Swimmable {
    <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå¯ä»¥å®ç°å¤šä¸ªæ¥å£</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸­å­é£"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸­å­æ¸¸"</span>);
    }
}

<span class="hljs-comment">// ç»„åˆï¼šå¯ä»¥ç»§æ‰¿ä¸€ä¸ªç±» + å®ç°å¤šä¸ªæ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AmphibiousVehicle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Flyable</span>, Swimmable {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ä¸¤æ –è½¦ç§»åŠ¨"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ä¸¤æ –è½¦é£è¡Œæ¨¡å¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ä¸¤æ –è½¦æ¸¸æ³³æ¨¡å¼"</span>);
    }
}
</code></pre>
<h3 data-id="heading-7"><strong>2. æ–¹æ³•å®ç°èƒ½åŠ›ï¼ˆJava 8+ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractExample</span> {
    <span class="hljs-comment">// 1. å¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">abstractMethod</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// 2. å¯ä»¥æœ‰å…·ä½“æ–¹æ³•ï¼ˆä¸€ç›´éƒ½å¯ä»¥ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">concreteMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»çš„å…·ä½“æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 3. å¯ä»¥æœ‰æ„é€ å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AbstractExample</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»æ„é€ å™¨"</span>);
    }
    
    <span class="hljs-comment">// 4. å¯ä»¥æœ‰é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»é™æ€æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 5. å¯ä»¥æœ‰finalæ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finalMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»finalæ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 6. å¯ä»¥æœ‰privateæ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»ç§æœ‰æ–¹æ³•"</span>);
    }
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">InterfaceExample</span> {
    <span class="hljs-comment">// 1. æŠ½è±¡æ–¹æ³•ï¼ˆJava 8å‰å”¯ä¸€å…è®¸çš„æ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">abstractMethod</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// 2. é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defaultMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ¥å£çš„é»˜è®¤æ–¹æ³•"</span>);
        privateMethod();  <span class="hljs-comment">// è°ƒç”¨ç§æœ‰æ–¹æ³•</span>
    }
    
    <span class="hljs-comment">// 3. é™æ€æ–¹æ³•ï¼ˆJava 8+ï¼‰</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ¥å£çš„é™æ€æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 4. ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ¥å£çš„ç§æœ‰æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 5. ç§æœ‰é™æ€æ–¹æ³•ï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateStaticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ¥å£çš„ç§æœ‰é™æ€æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// âŒ ä¸èƒ½æœ‰æ„é€ å™¨</span>
    <span class="hljs-comment">// InterfaceExample() { }  // ç¼–è¯‘é”™è¯¯</span>
    
    <span class="hljs-comment">// âŒ ä¸èƒ½æœ‰finalæ–¹æ³•</span>
    <span class="hljs-comment">// final void finalMethod();  // ç¼–è¯‘é”™è¯¯</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Implementation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InterfaceExample</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">abstractMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å®ç°æŠ½è±¡æ–¹æ³•"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8"><strong>3. å˜é‡/å­—æ®µçš„åŒºåˆ«</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractVars</span> {
    <span class="hljs-comment">// 1. å¯ä»¥æœ‰å®ä¾‹å˜é‡</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">String</span> <span class="hljs-variable">instanceVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å®ä¾‹å˜é‡"</span>;
    
    <span class="hljs-comment">// 2. å¯ä»¥æœ‰éå¸¸é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// 3. å¯ä»¥æœ‰é™æ€å˜é‡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">staticVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"é™æ€å˜é‡"</span>;
    
    <span class="hljs-comment">// 4. å¯ä»¥æœ‰finalå˜é‡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">finalVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"finalå˜é‡"</span>;
    
    <span class="hljs-comment">// 5. è®¿é—®ä¿®é¥°ç¬¦å¯ä»¥æ˜¯ä»»æ„çš„</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">privateVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ç§æœ‰å˜é‡"</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">String</span> <span class="hljs-variable">protectedVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å—ä¿æŠ¤å˜é‡"</span>;
    <span class="hljs-type">String</span> <span class="hljs-variable">defaultVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"é»˜è®¤å˜é‡"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-variable">publicVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å…¬å…±å˜é‡"</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">InterfaceVars</span> {
    <span class="hljs-comment">// 1. æ‰€æœ‰å˜é‡é»˜è®¤æ˜¯ public static final</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">CONSTANT</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å¸¸é‡"</span>;
    
    <span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
    <span class="hljs-comment">// public static final String CONSTANT = "å¸¸é‡";</span>
    
    <span class="hljs-comment">// âŒ ä¸èƒ½æœ‰å®ä¾‹å˜é‡</span>
    <span class="hljs-comment">// String instanceVar;  // ç¼–è¯‘é”™è¯¯</span>
    
    <span class="hljs-comment">// âŒ ä¸èƒ½æœ‰éfinalå˜é‡</span>
    <span class="hljs-comment">// int counter = 0;     // å®é™…ä¸Šæ˜¯å¸¸é‡</span>
    
    <span class="hljs-comment">// 2. åªèƒ½æ˜¯public</span>
    <span class="hljs-comment">// private String privateVar = "é”™è¯¯";  // ç¼–è¯‘é”™è¯¯</span>
    <span class="hljs-comment">// protected String protectedVar = "é”™è¯¯";  // ç¼–è¯‘é”™è¯¯</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VariablesDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»å˜é‡: "</span> + AbstractVars.staticVar);
        System.out.println(<span class="hljs-string">"æ¥å£å¸¸é‡: "</span> + InterfaceVars.CONSTANT);
        
        <span class="hljs-comment">// æ¥å£å¸¸é‡ä¸èƒ½ä¿®æ”¹</span>
        <span class="hljs-comment">// InterfaceVars.CONSTANT = "æ–°å€¼";  // ç¼–è¯‘é”™è¯¯</span>
    }
}
</code></pre>
<h3 data-id="heading-9"><strong>4. æ„é€ å™¨çš„åŒºåˆ«</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractWithConstructor</span> {
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-comment">// æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AbstractWithConstructor</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        System.out.println(<span class="hljs-string">"æŠ½è±¡ç±»æ„é€ å™¨è°ƒç”¨: "</span> + name);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">()</span>;
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractWithConstructor</span> {
    <span class="hljs-comment">// å­ç±»å¿…é¡»è°ƒç”¨çˆ¶ç±»æ„é€ å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConcreteClass</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">super</span>(name);  <span class="hljs-comment">// å¿…é¡»è°ƒç”¨</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">()</span> {
        System.out.println(getName() + <span class="hljs-string">"åœ¨åšäº‹æƒ…"</span>);
    }
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NoConstructor</span> {
    <span class="hljs-comment">// âŒ æ¥å£ä¸èƒ½æœ‰æ„é€ å™¨</span>
    <span class="hljs-comment">// NoConstructor() { }  // ç¼–è¯‘é”™è¯¯</span>
    
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConstructorDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ConcreteClass</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteClass</span>(<span class="hljs-string">"æµ‹è¯•"</span>);
        obj.doSomething();
    }
}
</code></pre>
<h3 data-id="heading-10"><strong>5. è®¿é—®ä¿®é¥°ç¬¦çš„åŒºåˆ«</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AccessModifiers</span> {
    <span class="hljs-comment">// æ‰€æœ‰è®¿é—®ä¿®é¥°ç¬¦éƒ½å¯ä»¥ç”¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">defaultMethod</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">protectedMethod</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publicMethod</span><span class="hljs-params">()</span> {}
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ä¸èƒ½æ˜¯private</span>
    <span class="hljs-comment">// private abstract void privateAbstract();  // ç¼–è¯‘é”™è¯¯</span>
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">protectedAbstract</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publicAbstract</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">InterfaceAccess</span> {
    <span class="hljs-comment">// æ¥å£æ–¹æ³•é»˜è®¤æ˜¯public</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// ç­‰ä»·äº public abstract void method()</span>
    
    <span class="hljs-comment">// Java 9+ å¯ä»¥æœ‰privateæ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ¥å£ç§æœ‰æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// ä¸èƒ½æ˜¯protectedæˆ–é»˜è®¤</span>
    <span class="hljs-comment">// protected void protectedMethod();  // ç¼–è¯‘é”™è¯¯</span>
    <span class="hljs-comment">// void defaultMethod();              // ç¼–è¯‘é”™è¯¯ï¼ˆJava 8å‰ï¼‰</span>
    
    <span class="hljs-comment">// Java 8+ é»˜è®¤æ–¹æ³•å¯ä»¥æ˜¯public</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defaultPublicMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é»˜è®¤å…¬å…±æ–¹æ³•"</span>);
    }
}
</code></pre>
<h2 data-id="heading-11">ğŸ’¡ ä½•æ—¶ä½¿ç”¨æŠ½è±¡ç±» vs æ¥å£</h2>
<h3 data-id="heading-12"><strong>1. ä½¿ç”¨æŠ½è±¡ç±»çš„æƒ…å†µ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœºæ™¯1ï¼šå¤šä¸ªç›¸å…³ç±»å…±äº«ä»£ç </span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Database</span> {
    <span class="hljs-comment">// å…±äº«çš„è¿æ¥é€»è¾‘</span>
    <span class="hljs-keyword">protected</span> Connection <span class="hljs-title function_">connect</span><span class="hljs-params">(String url)</span> {
        System.out.println(<span class="hljs-string">"è¿æ¥åˆ°: "</span> + url);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Connection</span>();
    }
    
    <span class="hljs-comment">// å…±äº«çš„å…³é—­é€»è¾‘</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">(Connection conn)</span> {
        System.out.println(<span class="hljs-string">"å…³é—­è¿æ¥"</span>);
    }
    
    <span class="hljs-comment">// æ¨¡æ¿æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeQuery</span><span class="hljs-params">(String sql)</span> {
        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> connect(getUrl());
        <span class="hljs-keyword">try</span> {
            execute(sql, conn);
        } <span class="hljs-keyword">finally</span> {
            close(conn);
        }
    }
    
    <span class="hljs-comment">// å­ç±»å¿…é¡»å®ç°</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">getUrl</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(String sql, Connection conn)</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MySQLDatabase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Database</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">getUrl</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"jdbc:mysql://localhost:3306/db"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(String sql, Connection conn)</span> {
        System.out.println(<span class="hljs-string">"æ‰§è¡ŒMySQLæŸ¥è¯¢: "</span> + sql);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OracleDatabase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Database</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">getUrl</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(String sql, Connection conn)</span> {
        System.out.println(<span class="hljs-string">"æ‰§è¡ŒOracleæŸ¥è¯¢: "</span> + sql);
    }
}
</code></pre>
<h3 data-id="heading-13"><strong>2. ä½¿ç”¨æ¥å£çš„æƒ…å†µ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœºæ™¯1ï¼šå®šä¹‰èƒ½åŠ›/å¥‘çº¦</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Comparable</span>&lt;T&gt; {
    <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(T other)</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Serializable</span> {
    <span class="hljs-comment">// æ ‡è®°æ¥å£</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Cloneable</span> {
    <span class="hljs-comment">// æ ‡è®°æ¥å£</span>
}

<span class="hljs-comment">// åœºæ™¯2ï¼šå¤šé‡ç»§æ‰¿</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Worker</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">study</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Athlete</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">train</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CollegeStudent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Student</span>, Worker, Athlete {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å…¼èŒå·¥ä½œ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">study</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å­¦ä¹ è¯¾ç¨‹"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">train</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ä½“è‚²è®­ç»ƒ"</span>);
    }
}

<span class="hljs-comment">// åœºæ™¯3ï¼šå›è°ƒæœºåˆ¶</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ClickListener</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">TextChangedListener</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTextChanged</span><span class="hljs-params">(String newText)</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> {
    <span class="hljs-keyword">private</span> ClickListener listener;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setClickListener</span><span class="hljs-params">(ClickListener listener)</span> {
        <span class="hljs-built_in">this</span>.listener = listener;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">click</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (listener != <span class="hljs-literal">null</span>) {
            listener.onClick();
        }
    }
}
</code></pre>
<h3 data-id="heading-14"><strong>3. ç»“åˆä½¿ç”¨ï¼ˆå¸¸è§æ¨¡å¼ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŠ½è±¡ç±»æä¾›éª¨æ¶å®ç°</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractList</span>&lt;E&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">List</span>&lt;E&gt; {
    <span class="hljs-comment">// æä¾›é€šç”¨å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span> {
        add(size(), e);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ç”±å­ç±»å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// æ¥å£å®šä¹‰å¥‘çº¦</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">List</span>&lt;E&gt; {
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span>;
    E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;
    <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å…·ä½“å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayList</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractList</span>&lt;E&gt; {
    <span class="hljs-keyword">private</span> Object[] elements = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[<span class="hljs-number">10</span>];
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span> {
        <span class="hljs-comment">// å®ç°ç»†èŠ‚</span>
        System.out.println(<span class="hljs-string">"ArrayListæ·»åŠ å…ƒç´ "</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> {
        <span class="hljs-comment">// å®ç°ç»†èŠ‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> size;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CombinedUsage</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        list.add(<span class="hljs-string">"Hello"</span>);
        System.out.println(<span class="hljs-string">"å¤§å°: "</span> + list.size());
    }
}
</code></pre>
<h2 data-id="heading-15">ğŸ“ ç°ä»£Javaä¸­çš„å˜åŒ–ï¼ˆJava 8+ï¼‰</h2>
<h3 data-id="heading-16"><strong>æ¥å£çš„å¢å¼º</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Java 8 å‰ï¼šæ¥å£åªèƒ½æœ‰æŠ½è±¡æ–¹æ³•</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">OldInterface</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// åªèƒ½æ˜¯æŠ½è±¡æ–¹æ³•</span>
}

<span class="hljs-comment">// Java 8+ï¼šæ¥å£å¯ä»¥æœ‰å¤šæ ·æ–¹æ³•</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModernInterface</span> {
    <span class="hljs-comment">// 1. æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">abstractMethod</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// 2. é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defaultMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é»˜è®¤å®ç°"</span>);
        privateMethod();
    }
    
    <span class="hljs-comment">// 3. é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é™æ€æ–¹æ³•"</span>);
        privateStaticMethod();
    }
    
    <span class="hljs-comment">// 4. ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç§æœ‰å®ä¾‹æ–¹æ³•"</span>);
    }
    
    <span class="hljs-comment">// 5. ç§æœ‰é™æ€æ–¹æ³•ï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateStaticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç§æœ‰é™æ€æ–¹æ³•"</span>);
    }
}

<span class="hljs-comment">// ç°åœ¨æ¥å£ â‰ˆ æŠ½è±¡ç±»ï¼Œä½†ä»æœ‰åŒºåˆ«ï¼š</span>
<span class="hljs-comment">// 1. æ¥å£ä»ç„¶ä¸èƒ½æœ‰æ„é€ å™¨</span>
<span class="hljs-comment">// 2. æ¥å£ä»ç„¶ä¸èƒ½æœ‰å®ä¾‹å˜é‡</span>
<span class="hljs-comment">// 3. æ¥å£ä»ç„¶æ”¯æŒå¤šé‡ç»§æ‰¿</span>
</code></pre>
<h2 data-id="heading-17">ğŸ“ è®°å¿†å£è¯€</h2>
<pre><code class="hljs language-markdown" lang="markdown">ç›¸åŒç‚¹ï¼š
<span class="hljs-bullet">1.</span> éƒ½ä¸èƒ½newï¼ˆä¸èƒ½å®ä¾‹åŒ–ï¼‰
<span class="hljs-bullet">2.</span> éƒ½èƒ½æœ‰æŠ½è±¡æ–¹æ³•
<span class="hljs-bullet">3.</span> éƒ½æ”¯æŒå¤šæ€

ä¸åŒç‚¹ï¼š
æŠ½è±¡ç±»ï¼š
<span class="hljs-bullet">-</span> å•ç»§æ‰¿
<span class="hljs-bullet">-</span> æœ‰æ„é€ å™¨
<span class="hljs-bullet">-</span> æœ‰å…·ä½“æ–¹æ³•ï¼ˆä¸€ç›´éƒ½æœ‰ï¼‰
<span class="hljs-bullet">-</span> æœ‰å„ç§å˜é‡
<span class="hljs-bullet">-</span> è®¾è®¡ï¼šæ˜¯ä»€ä¹ˆï¼ˆis-aï¼‰

æ¥å£ï¼š
<span class="hljs-bullet">-</span> å¤šå®ç°
<span class="hljs-bullet">-</span> æ— æ„é€ å™¨
<span class="hljs-bullet">-</span> é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰
<span class="hljs-bullet">-</span> åªæœ‰å¸¸é‡
<span class="hljs-bullet">-</span> è®¾è®¡ï¼šèƒ½ä»€ä¹ˆï¼ˆhas-a/can-doï¼‰
</code></pre>
<h2 data-id="heading-18">ğŸ’¡ å®ç”¨å»ºè®®</h2>
<h3 data-id="heading-19"><strong>é€‰æ‹©æŒ‡å—</strong></h3>
<pre><code class="hljs language-markdown" lang="markdown">é—®è‡ªå·±è¿™äº›é—®é¢˜ï¼š

<span class="hljs-bullet">1.</span> éœ€è¦å¤šé‡ç»§æ‰¿å—ï¼Ÿ
<span class="hljs-bullet">   -</span> æ˜¯ â†’ ç”¨æ¥å£
<span class="hljs-bullet">   -</span> å¦ â†’ ç»§ç»­

<span class="hljs-bullet">2.</span> éœ€è¦å…±äº«ä»£ç å—ï¼Ÿ
<span class="hljs-bullet">   -</span> æ˜¯ â†’ ç”¨æŠ½è±¡ç±»
<span class="hljs-bullet">   -</span> å¦ â†’ ç”¨æ¥å£

<span class="hljs-bullet">3.</span> ç›¸å…³ç±»æœ‰ç´§å¯†å…³ç³»å—ï¼Ÿ
<span class="hljs-bullet">   -</span> æ˜¯ â†’ ç”¨æŠ½è±¡ç±»
<span class="hljs-bullet">   -</span> å¦ â†’ ç”¨æ¥å£

<span class="hljs-bullet">4.</span> åªæ˜¯å®šä¹‰å¥‘çº¦å—ï¼Ÿ
<span class="hljs-bullet">   -</span> æ˜¯ â†’ ç”¨æ¥å£
<span class="hljs-bullet">   -</span> å¦ â†’ ç»§ç»­

<span class="hljs-bullet">5.</span> éœ€è¦æ§åˆ¶å­ç±»æ„é€ å—ï¼Ÿ
<span class="hljs-bullet">   -</span> æ˜¯ â†’ ç”¨æŠ½è±¡ç±»
<span class="hljs-bullet">   -</span> å¦ â†’ ç”¨æ¥å£
</code></pre>
<h3 data-id="heading-20"><strong>æœ€ä½³å®è·µ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨æ¥å£ï¼ˆæ›´åŠ çµæ´»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Repository</span>&lt;T&gt; {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(T entity)</span>;
    T <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>;
    List&lt;T&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// éœ€è¦å…±äº«ä»£ç æ—¶ä½¿ç”¨æŠ½è±¡ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractRepository</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Repository</span>&lt;T&gt; {
    <span class="hljs-keyword">protected</span> DatabaseConnection connection;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AbstractRepository</span><span class="hljs-params">(DatabaseConnection connection)</span> {
        <span class="hljs-built_in">this</span>.connection = connection;
    }
    
    <span class="hljs-comment">// å…±äº«çš„ä¿å­˜é€»è¾‘</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(T entity)</span> {
        validate(entity);
        persist(entity);
        logSave(entity);
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">persist</span><span class="hljs-params">(T entity)</span>;
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(T entity)</span> {
        <span class="hljs-comment">// éªŒè¯é€»è¾‘</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logSave</span><span class="hljs-params">(T entity)</span> {
        <span class="hljs-comment">// æ—¥å¿—é€»è¾‘</span>
    }
}

<span class="hljs-comment">// å…·ä½“å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractRepository</span>&lt;User&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserRepository</span><span class="hljs-params">(DatabaseConnection connection)</span> {
        <span class="hljs-built_in">super</span>(connection);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">persist</span><span class="hljs-params">(User entity)</span> {
        <span class="hljs-comment">// å…·ä½“æŒä¹…åŒ–é€»è¾‘</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span> {
        <span class="hljs-comment">// å…·ä½“æŸ¥æ‰¾é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å…·ä½“æŸ¥æ‰¾é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    }
}
</code></pre>
<p><strong>è®°ä½</strong>ï¼šç°ä»£Javaå¼€å‘ä¸­ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ¥å£ï¼Œåªæœ‰åœ¨ç¡®å®éœ€è¦å…±äº«ä»£ç æ—¶æ‰ä½¿ç”¨æŠ½è±¡ç±»ã€‚æ¥å£æä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Manim v0.19.1 å‘å¸ƒå•¦ï¼ä¸‰å¤§æ–°ç‰¹æ€§è®©åŠ¨ç”»åˆ¶ä½œæ›´ä¸æ»‘]]></title>    <link>https://juejin.cn/post/7578787344612769828</link>    <guid>https://juejin.cn/post/7578787344612769828</guid>    <pubDate>2025-12-02T04:28:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578787344612769828" data-draft-id="7578811288819449899" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Manim v0.19.1 å‘å¸ƒå•¦ï¼ä¸‰å¤§æ–°ç‰¹æ€§è®©åŠ¨ç”»åˆ¶ä½œæ›´ä¸æ»‘"/> <meta itemprop="keywords" content="Python,åŠ¨æ•ˆ,åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T04:28:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Manim v0.19.1 å‘å¸ƒå•¦ï¼ä¸‰å¤§æ–°ç‰¹æ€§è®©åŠ¨ç”»åˆ¶ä½œæ›´ä¸æ»‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T04:28:41.000Z" title="Tue Dec 02 2025 04:28:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Manim ç¤¾åŒºæ–°å‘å¸ƒäº† <strong>v0.19.1</strong> ç‰ˆæœ¬ï¼ˆå‘å¸ƒäº 12 æœˆ 1 æ—¥ï¼‰ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªå°ç‰ˆæœ¬å·æ›´æ–°ï¼Œä½†é‡Œé¢å¯æ˜¯è—ç€å‡ ä¸ªéå¸¸å®ç”¨çš„æ–°åŠŸèƒ½ï¼</p>
<p>æ— è®ºä½ æ˜¯åˆšå…¥å‘çš„æ–°æ‰‹ï¼Œæˆ–è€…å·²ç»è¢«æŸäº›ç—›ç‚¹æŠ˜ç£¨è¿‡çš„è€æ‰‹ï¼Œè¿™ç¯‡æ›´æ–°é€Ÿè§ˆéƒ½å€¼å¾—ä¸€çœ‹ã€‚</p>
<h2 data-id="heading-0">1. ğŸŒŸ äº®ç‚¹ä¸€ï¼šç»ˆäºå¯ä»¥â€œå›ºå®šâ€éšæœºé¢œè‰²äº†ï¼</h2>
<p>ä»¥å‰æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>random_color()</code> æ—¶ï¼Œæœ€å¤§çš„ç—›ç‚¹å°±æ˜¯ï¼š<strong>æ¯æ¬¡è¿è¡Œè„šæœ¬ï¼Œç”Ÿæˆçš„é¢œè‰²éƒ½ä¸ä¸€æ ·ï¼</strong><br/>
æœ‰æ—¶å€™ä½ è§‰å¾—è¿™æ¬¡éšæœºå‡ºæ¥çš„é…è‰²æ–¹æ¡ˆç®€ç›´å®Œç¾ï¼Œç»“æœæ”¹äº†ä¸€è¡Œæ— å…³ä»£ç å†æ¸²æŸ“ï¼Œé…è‰²å˜äº†â€¦â€¦å¿ƒæ€ç›´æ¥å´©äº†æœ‰æ²¡æœ‰ï¼Ÿ</p>
<p>åœ¨ <code>v0.19.1</code> ä¸­ï¼Œ<code>random_color()</code> ç»ˆäºæ”¯æŒ <code>seed</code>ï¼ˆéšæœºç§å­ï¼‰å‚æ•°äº†ï¼è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡æŒ‡å®šç§å­ï¼Œè®©éšæœºé¢œè‰²å˜å¾—â€œç¡®å®šâ€ã€‚</p>
<h4 data-id="heading-1">1.0.1. ğŸŒ° ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> manim <span class="hljs-keyword">import</span> *


<span class="hljs-keyword">class</span> <span class="hljs-title class_">DeterministicColors</span>(<span class="hljs-title class_ inherited__">Scene</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">construct</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># ä»¥å‰ï¼šæ¯æ¬¡è¿è¡Œé¢œè‰²éƒ½å¯èƒ½ä¸åŒ</span>
        <span class="hljs-comment"># circle = Circle(color=random_color())</span>

        <span class="hljs-comment"># ç°åœ¨ï¼šæŒ‡å®š seed=1ï¼Œæ— è®ºè¿è¡Œå¤šå°‘æ¬¡ï¼Œå®ƒæ°¸è¿œæ˜¯åŒä¸€ä¸ªé¢œè‰²ï¼</span>
        rnd = RandomColorGenerator(seed=<span class="hljs-number">1</span>)
        dot_a = Dot(radius=<span class="hljs-number">1</span>, color=rnd.<span class="hljs-built_in">next</span>())
        dot_a.shift(LEFT * <span class="hljs-number">2</span>)

        <span class="hljs-comment"># å³ä½¿åœ¨ä¸åŒçš„åœ°æ–¹è°ƒç”¨ï¼Œåªè¦ç§å­ä¸€æ ·ï¼Œé¢œè‰²å°±ä¸€æ ·</span>
        dot_b = Dot(radius=<span class="hljs-number">1</span>, color=rnd.<span class="hljs-built_in">next</span>())
        dot_b.shift(RIGHT * <span class="hljs-number">2</span>)

        self.play(Create(dot_a), Create(dot_b))
        self.wait()
</code></pre>
<p>åªè¦<code>seed</code>çš„å€¼ä¸€æ ·ï¼Œæ¯æ¬¡çš„éšæœºçš„é¢œè‰²éƒ½ä¸€æ ·ã€‚</p>
<p>è¿™å¯¹äºåˆ¶ä½œç³»åˆ—è§†é¢‘æˆ–è€…è°ƒè¯•é…è‰²æ—¶ç®€ç›´æ˜¯æ•‘å‘½ç¨»è‰ã€‚</p>
<h2 data-id="heading-2">2. ğŸŒŸ äº®ç‚¹äºŒï¼šValueTracker ç»ˆäºå­¦ä¼šç®—æœ¯äº†</h2>
<p><code>ValueTracker</code> æ˜¯ Manim ä¸­åšåŠ¨æ€æ•°å€¼åŠ¨ç”»çš„æ ¸å¿ƒã€‚ä½†ä»¥å‰å®ƒæœ‰ç‚¹â€œç¬¨â€ï¼Œä¸èƒ½ç›´æ¥å‚ä¸åŠ å‡ä¹˜é™¤ã€‚</p>
<p>æ¯”å¦‚ä½ æƒ³è®©ä¸€ä¸ª <code>tracker</code> çš„å€¼ç¿»å€ï¼Œä»¥å‰ä½ å¾—å†™ <code>t.set_value(t.get_value() * 2)</code>ã€‚</p>
<p>ç°åœ¨åˆ™ç›´æ¥ä¹˜è¿™å°±è¡Œäº†ï¼</p>
<p>æ–°ç‰ˆæœ¬æ”¯æŒ <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>//</code>, <code>%</code>, <code>**</code> ç­‰å¸¸è§è¿ç®—ç¬¦ã€‚</p>
<h4 data-id="heading-3">2.0.1. ğŸŒ° ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> manim <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartTracker</span>(<span class="hljs-title class_ inherited__">Scene</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">construct</span>(<span class="hljs-params">self</span>):
        tracker = ValueTracker(<span class="hljs-number">2</span>)

        number = DecimalNumber()
        number.add_updater(<span class="hljs-keyword">lambda</span> m: m.set_value(tracker.get_value()))

        self.add(number)

        <span class="hljs-comment"># ä»¥å‰çš„å†™æ³•ï¼ˆç°åœ¨ä¾ç„¶å¯ç”¨ï¼Œä½†æ¯”è¾ƒç¹çï¼‰</span>
        <span class="hljs-comment"># self.play(tracker.animate.set_value(tracker.get_value() + 5))</span>

        <span class="hljs-comment"># v0.19.1 çš„æ–°ç©æ³•ï¼šç›´æ¥å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œ</span>
        <span class="hljs-comment"># æ³¨æ„ï¼šè¿™é‡Œå±•ç¤ºçš„æ˜¯é€»è¾‘ä¸Šçš„ç®€åŒ–ï¼Œåœ¨é animate åœºæ™¯ä¸‹å¤„ç†æ•°æ®æ›´æ–¹ä¾¿</span>

        <span class="hljs-comment"># æ¯”å¦‚æˆ‘ä»¬åœ¨å¾ªç¯ä¸­å¤„ç†æ•°æ®é€»è¾‘æ—¶ï¼š</span>
        tracker += <span class="hljs-number">5</span>  <span class="hljs-comment"># tracker çš„å†…éƒ¨å€¼ç°åœ¨å˜æˆäº† 7</span>
        self.wait()

        <span class="hljs-comment"># ç”šè‡³å¯ä»¥è¿›è¡Œæ›´å¤æ‚çš„è¿ç®—</span>
        tracker *= <span class="hljs-number">2</span>  <span class="hljs-comment"># å˜æˆ 14</span>
        self.wait()

        <span class="hljs-comment"># æ³¨æ„ï¼šå¦‚æœä½ è¦ç”¨ animate åŠ¨ç”»è¿‡æ¸¡ï¼Œè¿˜æ˜¯æ¨èç”¨ .animate.set_value()</span>
        <span class="hljs-comment"># ä½†è¿™ä¸ªç‰¹æ€§è®©ç¼–å†™å¤æ‚çš„ updater é€»è¾‘æˆ–è€…é¢„è®¡ç®—å˜å¾—éå¸¸çˆ½ã€‚</span>
</code></pre>
<p>ä»£ç åˆå¯ä»¥å°‘å†™å‡ è¡Œ <code>get_value()</code> äº†ï¼Œæ¸…çˆ½åº¦ +1ã€‚</p>
<h2 data-id="heading-4">3. ğŸŒŸ äº®ç‚¹ä¸‰ï¼šæ–°å¢ <code>TangentialArc</code> (åˆ‡çº¿å¼§)</h2>
<p>è¿™æ˜¯å‡ ä½•ç»˜å›¾çš„æ–°ç©å…·ï¼ä»¥å‰å¦‚æœæƒ³ç”»ä¸€æ®µåœ†å¼§ï¼Œæ—¢è¦è¿æ¥ä¸¤ä¸ªç‚¹ï¼Œåˆè¦ä¿è¯åˆ‡çº¿æ–¹å‘å¹³æ»‘ï¼Œå¯èƒ½éœ€è¦è´¹ç‚¹è„‘ç­‹å»ç®—è§’åº¦ã€‚</p>
<p>æ–°çš„ <code>TangentialArc</code> æ—¨åœ¨ç®€åŒ–è¿™ç±»å‡ ä½•æ„é€ ã€‚</p>
<p>ç›®å‰å®˜æ–¹æ–‡æ¡£è¿˜åœ¨å®Œå–„ä¸­ï¼Œä½†å®ƒçš„å‡ºç°æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ›´å®¹æ˜“åœ°ç”»å‡ºæµç•…è¿æ¥ç›´çº¿æˆ–æ›²çº¿çš„åœ†å¼§äº†ã€‚</p>
<h4 data-id="heading-5">3.0.1. ğŸŒ° ä»£ç åœºæ™¯</h4>
<p>å¦‚æœä½ æœ‰ä¸€æ¡ç›´çº¿ï¼Œæƒ³åœ¨æœ«ç«¯æ¥ä¸€ä¸ªåœ†å¼§ï¼Œä¸”è¿æ¥å¤„è¦æ˜¯â€œä¸æ»‘â€çš„ï¼ˆåˆ‡çº¿è¿ç»­ï¼‰ã€‚</p>
<p>ä»¥å‰ä½ å¾—ç®—åˆ‡è§’ï¼Œç°åœ¨å¯ä»¥è¯•è¯•ä½¿ç”¨ <code>TangentialArc</code> ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TangentialArcSample</span>(<span class="hljs-title class_ inherited__">Scene</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">construct</span>(<span class="hljs-params">self</span>):
        l1 = Line([<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>], color=RED)
        l2 = Line([-<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>], color=BLUE)
        
        <span class="hljs-comment"># åˆ›å»ºåˆ‡åœ†å¼§å¯¹è±¡</span>
        <span class="hljs-comment"># å‚æ•°è¯´æ˜ï¼š</span>
        <span class="hljs-comment"># - l1: ç¬¬ä¸€æ¡åˆ‡çº¿</span>
        <span class="hljs-comment"># - l2: ç¬¬äºŒæ¡åˆ‡çº¿</span>
        <span class="hljs-comment"># - radius: åœ†å¼§çš„åŠå¾„ï¼ˆ0.2ï¼‰</span>
        <span class="hljs-comment"># - corner: åœ†å¼§æ‰€åœ¨çš„è§’è½æ–¹å‘</span>
        <span class="hljs-comment"># - color: åœ†å¼§çš„é¢œè‰²ï¼ˆç»¿è‰²ï¼‰</span>
        circulararc = TangentialArc(l1, l2, radius=<span class="hljs-number">0.2</span>, corner=(-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>), color=GREEN)
        self.play(Create(l1), Create(l2))
        self.play(Create(circulararc))

        self.wait()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca2d253b6b73413a9ebda6378bf634ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765254521&amp;x-signature=thDHMrFMRbGCYLS2IqqrB%2B83wXA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">4. ğŸ› ï¸ å…¶ä»–å€¼å¾—å…³æ³¨çš„å˜åŒ–</h2>
<p>é™¤äº†ä¸Šé¢ä¸‰ä¸ªæ–°ç‰¹æ€§ï¼Œè¿˜æœ‰ä¸€äº›æ”¹åŠ¨ä¹Ÿéå¸¸è´´å¿ƒï¼š</p>
<ol>
<li><strong>SurroundingRectangle æ›´çµæ´»äº†</strong>ï¼š<br/>
ä»¥å‰ <code>buff</code> å‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå¯¼è‡´çŸ©å½¢æ¡†çš„å››å‘¨ç•™ç™½å¿…é¡»ä¸€æ ·ã€‚ç°åœ¨ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ªå…ƒç»„ <code>buff=(0.5, 0.1)</code>ï¼Œåˆ†åˆ«æ§åˆ¶ <strong>æ°´å¹³</strong> å’Œ <strong>å‚ç›´</strong> æ–¹å‘çš„é—´è·ã€‚ç»™é•¿å…¬å¼åŠ æ¡†æ—¶å†ä¹Ÿä¸ç”¨æ‹…å¿ƒå·¦å³å¤ªå®½æˆ–è€…ä¸Šä¸‹å¤ªæŒ¤äº†ï¼</li>
<li><strong>Code Mobject æ”¯æŒ OpenGL</strong>ï¼š<br/>
å¦‚æœä½ æ˜¯ç”¨ OpenGL æ¸²æŸ“æ¨¡å¼ï¼ˆæ¸²æŸ“é€Ÿåº¦è¶…å¿«çš„é‚£ç§ï¼‰çš„ç”¨æˆ·ï¼Œç°åœ¨ <code>Code</code> å¯¹è±¡ä¹Ÿèƒ½å®Œç¾æ˜¾ç¤ºäº†ã€‚</li>
<li><strong>ä¿®å¤äº† Tex ç¯å¢ƒæ ¼å¼åŒ–é—®é¢˜</strong>ï¼š<br/>
å†™ <code>LaTeX</code> å…¬å¼æ—¶å¦‚æœä¸å°å¿ƒæ¢è¡Œæˆ–è€…æ ¼å¼ä¹±äº†ï¼Œç°åœ¨ <code>Manim</code> èƒ½æ›´å¥½åœ°å¤„ç†å®ƒï¼ŒæŠ¥é”™æ›´å°‘ã€‚</li>
<li><strong>CLI é»˜è®¤åˆ†è¾¨ç‡è°ƒæ•´</strong>ï¼š<br/>
å‘½ä»¤è¡Œå·¥å…·çš„é»˜è®¤åˆ†è¾¨ç‡é€»è¾‘è¿›è¡Œäº†ä¸€äº›å¾®è°ƒï¼Œæ›´åŠ ç¬¦åˆ 1080p çš„æ ‡å‡†é¢„æœŸã€‚</li>
</ol>
<h2 data-id="heading-7">5. ğŸ“ æ€»ç»“ä¸å‡çº§</h2>
<p>è¿™æ¬¡<code> v0.19.1</code> è™½ç„¶ç‰ˆæœ¬å·è·¨åº¦ä¸å¤§ï¼Œä½†æ¯ä¸€ä¸ªæ”¹åŠ¨éƒ½åˆ‡ä¸­äº†å®é™…å¼€å‘ä¸­çš„ç—›ç‚¹ã€‚</p>
<p>ç‰¹åˆ«æ˜¯ <strong>éšæœºç§å­</strong> å’Œ <strong>ValueTracker ç®—æœ¯æ”¯æŒ</strong>ï¼Œå±äºé‚£ç§â€œç”¨äº†å°±å›ä¸å»â€çš„ä¼˜åŒ–ã€‚</p>
<p>å‡çº§<code>Manim</code>ä¹Ÿå¾ˆç®€å•ï¼Œæ‰“å¼€ç»ˆç«¯/å‘½ä»¤è¡Œï¼Œè¾“å…¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install --upgrade manim
</code></pre>
<p>å¿«å»è¯•è¯•æ–°åŠŸèƒ½å§ï¼å¦‚æœä½ ç”¨æ–°ç‰¹æ€§åšå‡ºäº†å¥½ç©çš„åŠ¨ç”»ï¼Œæ¬¢è¿åœ¨ç¤¾åŒºåˆ†äº«å“¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[runtime-domè®°å½•å¤‡å¿˜]]></title>    <link>https://juejin.cn/post/7579255046980010010</link>    <guid>https://juejin.cn/post/7579255046980010010</guid>    <pubDate>2025-12-03T09:23:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579255046980010010" data-draft-id="7579441333165932553" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="runtime-domè®°å½•å¤‡å¿˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T09:23:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç»†å¿ƒç»†å¿ƒå†ç»†å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/721738373803879"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            runtime-domè®°å½•å¤‡å¿˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/721738373803879/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç»†å¿ƒç»†å¿ƒå†ç»†å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:23:04.000Z" title="Wed Dec 03 2025 09:23:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">packages/runtime-dom/src/index.ts çš„ä¸»è¦ä½œç”¨</h2>
<ul>
<li>é¦–å…ˆæ˜ç¡®çš„æ˜¯ï¼Œåœ¨runtime-domä¸­è°ƒç”¨çš„createAppï¼Œå®é™…ä¸Šæ˜¯æ¥è‡ªruntime-coreã€‚runtime-domåªæ˜¯å¯¹å®ƒè¿›è¡Œäº†ç±»å‹æ‰©å±•å’ŒåŒ…è£…å¯¼å‡ºï¼›</li>
<li>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨
<ul>
<li>å½“createAppè¢«è°ƒç”¨æ—¶ï¼Œä»–èƒŒåä¾èµ–çš„æ ¸å¿ƒæ˜¯createRenderer</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ä½äº runtime-dom/src/index.ts</span>
<span class="hljs-comment">// 1. åˆ›å»ºä¸“ç”¨äºDOMçš„æ¸²æŸ“å™¨ï¼Œä¼ å…¥æ‰€æœ‰DOMæ“ä½œæ–¹æ³•ï¼ˆrendererOptionsï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createApp = (<span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
  <span class="hljs-comment">// 2. ensureRenderer() ä¼šè°ƒç”¨ createRenderer(rendererOptions)ï¼Œ</span>
  <span class="hljs-comment">//    ç”Ÿæˆä¸€ä¸ªå…·å¤‡ render å’Œ hydrate æ–¹æ³•çš„æ¸²æŸ“å™¨å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">ensureRenderer</span>().<span class="hljs-title function_">createApp</span>(...args)
  <span class="hljs-comment">// ... åç»­å¯¹ app.mount çš„å¢å¼ºï¼ˆè§ä¸‹æ–‡ï¼‰</span>
  <span class="hljs-keyword">return</span> app
}) <span class="hljs-keyword">as</span> <span class="hljs-title class_">CreateAppFunction</span>&lt;<span class="hljs-title class_">Element</span>&gt;

</code></pre>
<ol>
<li>ensureRenderer():è·å–æˆ–åˆ›å»ºå”¯ä¸€çš„DOMæ¸²æŸ“å™¨ï¼Œä»–æ˜¯æ•´ä¸ªåº”ç”¨ä¸DOMäº¤äº’çš„å‘åŠ¨æœºã€‚</li>
<li>createRenderer(rendererOptions):è¿™æ˜¯å…³é”®ã€‚rendererOptionså°±æ˜¯ä¹‹å‰å®šä¹‰çš„åŒ…å«patchPropã€insert,createElementç­‰å‡ åä¸ªå…·ä½“DOMæ“ä½œæ–¹æ³•çš„å¯¹è±¡ã€‚createRendererå‡½æ•°ï¼ˆæ¥è‡ªruntime-coreï¼‰æ¥æ”¶è¿™äº›å…·ä½“æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¹³å°é€šç”¨çš„æ¸²æŸ“å™¨ã€‚è¿™æ˜¯ä¾èµ–æ³¨å…¥çš„ç»å…¸å®ç°ï¼šæ ¸å¿ƒé€»è¾‘æ˜¯é€šç”¨çš„ï¼Œå…·ä½“å®ç°ç”±å¤–éƒ¨æ³¨å…¥ã€‚</li>
</ol>
<ul>
<li>ç¬¬äºŒæ­¥åˆ›å»ºAppå®ä¾‹ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
æ¥ç€ï¼Œè°ƒç”¨æ¸²æŸ“å™¨çš„.createAppæ–¹æ³•ï¼Œè¿™æ˜¯åœ¨runtime-coreä¸­å®šä¹‰çš„createAppApiå‡½æ•°</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ä½äº runtime-core/src/apiCreateApp.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> createAppAPI&lt;<span class="hljs-title class_">HostElement</span>&gt;(
  <span class="hljs-attr">render</span>: <span class="hljs-title class_">RootRenderFunction</span>,
  hydrate?: <span class="hljs-title class_">RootHydrateFunction</span>
): <span class="hljs-title class_">CreateAppFunction</span>&lt;<span class="hljs-title class_">HostElement</span>&gt; {
  <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°è¿”å›çš„å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆä½¿ç”¨çš„ createApp å‡½æ•°</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createApp</span>(<span class="hljs-params">rootComponent, rootProps = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ (context)ï¼Œè¿™æ˜¯å…¨å±€é…ç½®å’ŒçŠ¶æ€çš„é›†åˆ</span>
    <span class="hljs-keyword">const</span> context = <span class="hljs-title function_">createAppContext</span>()
    <span class="hljs-keyword">const</span> installedPlugins = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>() <span class="hljs-comment">// ç”¨äºè®°å½•å·²å®‰è£…æ’ä»¶ï¼Œé˜²æ­¢é‡å¤</span>

    <span class="hljs-keyword">let</span> isMounted = <span class="hljs-literal">false</span> <span class="hljs-comment">// æ ‡è®°åº”ç”¨æ˜¯å¦å·²æŒ‚è½½</span>

    <span class="hljs-comment">// 2. åˆ›å»º app å¯¹è±¡ï¼ˆè¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ app å®ä¾‹ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">app</span>: <span class="hljs-title class_">App</span> = (context.<span class="hljs-property">app</span> = {
      <span class="hljs-attr">_uid</span>: uid++,
      <span class="hljs-attr">_component</span>: rootComponent, <span class="hljs-comment">// ä¿å­˜æ ¹ç»„ä»¶å¯¹è±¡</span>
      <span class="hljs-attr">_props</span>: rootProps,
      <span class="hljs-attr">_container</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// åˆå§‹ä¸ºnullï¼ŒmountåæŒ‡å‘æ ¹DOMå®¹å™¨</span>
      <span class="hljs-attr">_context</span>: context, <span class="hljs-comment">// å…³è”ä¸Šæ–‡åˆ›å»ºçš„ä¸Šä¸‹æ–‡</span>

      <span class="hljs-comment">// 3. æ ¸å¿ƒï¼šmount æ–¹æ³•ï¼ˆåˆå§‹ç‰ˆæœ¬ï¼Œruntime-dom ä¼šå¢å¼ºå®ƒï¼‰</span>
      <span class="hljs-title function_">mount</span>(<span class="hljs-attr">rootContainer</span>: <span class="hljs-title class_">HostElement</span>, isHydrate?: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">any</span> {
        <span class="hljs-keyword">if</span> (isMounted) {
          <span class="hljs-title function_">warn</span>(<span class="hljs-string">`App has already been mounted.`</span>) <span class="hljs-comment">// å¼€å‘ç¯å¢ƒè­¦å‘Š</span>
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-comment">// 3.1 æ ‡å‡†åŒ–å®¹å™¨ï¼šæ”¯æŒå­—ç¬¦ä¸²é€‰æ‹©å™¨ï¼ˆå¦‚â€˜#appâ€™ï¼‰æˆ–DOMå…ƒç´ </span>
        <span class="hljs-keyword">const</span> container = <span class="hljs-title function_">normalizeContainer</span>(rootContainer)
        <span class="hljs-keyword">if</span> (!container) <span class="hljs-keyword">return</span>

        <span class="hljs-comment">// 3.2 åˆ›å»ºæ ¹ç»„ä»¶çš„è™šæ‹ŸèŠ‚ç‚¹ (vnode)</span>
        <span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">createVNode</span>(
          rootComponent <span class="hljs-keyword">as</span> <span class="hljs-title class_">ConcreteComponent</span>,
          rootProps
        )
        vnode.<span class="hljs-property">appContext</span> = context <span class="hljs-comment">// å°†åº”ç”¨ä¸Šä¸‹æ–‡å…³è”åˆ°vnode</span>

        <span class="hljs-comment">// 3.3 æ ¸å¿ƒæ¸²æŸ“è°ƒç”¨ï¼šå°†è™šæ‹Ÿæ ‘è½¬æ¢ä¸ºçœŸå®DOM</span>
        <span class="hljs-keyword">if</span> (isHydrate) {
          <span class="hljs-title function_">hydrate</span>(vnode <span class="hljs-keyword">as</span> <span class="hljs-title class_">VNode</span>&lt;<span class="hljs-title class_">Node</span>, <span class="hljs-title class_">Element</span>&gt;, container)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">render</span>(vnode, container) <span class="hljs-comment">// è¿™é‡Œè°ƒç”¨çš„æ˜¯ runtime-dom æä¾›çš„ render å‡½æ•°</span>
        }

        isMounted = <span class="hljs-literal">true</span>
        app.<span class="hljs-property">_container</span> = container <span class="hljs-comment">// è®°å½•æŒ‚è½½å®¹å™¨</span>
        container.<span class="hljs-property">__vue_app__</span> = app <span class="hljs-comment">// åœ¨DOMå…ƒç´ ä¸Šè®°å½•appå®ä¾‹ï¼Œä¾¿äºè°ƒè¯•æˆ–HMR</span>

        <span class="hljs-comment">// 3.4 è¿”å›æ ¹ç»„ä»¶å®ä¾‹çš„ä»£ç†ï¼ˆæ–¹ä¾¿å°‘æ•°éœ€è¦ç›´æ¥æ“ä½œå®ä¾‹çš„åœºæ™¯ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">getExposeProxy</span>(vnode.<span class="hljs-property">component</span>!) || vnode.<span class="hljs-property">component</span>!.<span class="hljs-property">proxy</span>
      },

      <span class="hljs-comment">// 4. å…¶ä»–åº”ç”¨API</span>
      <span class="hljs-title function_">use</span>(<span class="hljs-params">plugin: Plugin, ...options: <span class="hljs-built_in">any</span>[]</span>) {
        <span class="hljs-comment">// æ’ä»¶å®‰è£…é€»è¾‘ï¼Œè°ƒç”¨ plugin.install(app, ...options)</span>
      },
      <span class="hljs-title function_">component</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, component?: <span class="hljs-title class_">Component</span>): <span class="hljs-built_in">any</span> {
        <span class="hljs-comment">// å…¨å±€ç»„ä»¶æ³¨å†Œï¼Œå­˜å…¥ context.components</span>
      },
      <span class="hljs-title function_">directive</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, directive?: Directive</span>) {
        <span class="hljs-comment">// å…¨å±€æŒ‡ä»¤æ³¨å†Œï¼Œå­˜å…¥ context.directives</span>
      },
      <span class="hljs-comment">// unmount, provide ç­‰å…¶ä»–æ–¹æ³•...</span>
    })

    <span class="hljs-keyword">return</span> app
  }
}
</code></pre>
<p>å…³é”®è¡Œè§£è¯»ï¼š</p>
<ol>
<li>const context = createAppContext():åˆ›å»ºåº”ç”¨çº§åˆ«çš„å…±äº«ä¸Šä¸‹æ–‡ã€‚æ‰€æœ‰ç»„ä»¶æ ‘ä¸­çš„ç»„ä»¶éƒ½èƒ½è®¿é—®åˆ°å®ƒå†…éƒ¨çš„å…¨å±€ç»„ä»¶ã€æŒ‡ä»¤ã€é…ç½®ç­‰ã€‚è¿™æ˜¯app.componentã€app.directiveå…¨å±€æ³¨å†Œçš„åŸºçŸ³ã€‚</li>
<li>const vnode=createVNode(...)å°†ä½ ä¼ å…¥çš„è·Ÿç»„ä»¶ï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…ä¸€ä¸ªç»„ä»¶å®šä¹‰ï¼‰è½¬æ¢ä¸ºåˆå§‹çš„è™šæ‹ŸDOMèŠ‚ç‚¹ã€‚Vue3çš„æ‰€æœ‰æ¸²æŸ“éƒ½å›´ç»•è™šæ‹ŸDOMè¿›è¡Œ</li>
<li>render(vnode,container):æ˜¯è¿æ¥æ‰€æœ‰æ¨¡å—çš„æ¢çº½ã€‚è¿™ä¸ªrenderå‡½æ•°ç¬¬ä¸€æ­¥ä¸­createRenderè¿”å›çš„æ ¸å¿ƒæ¸²æŸ“å‡½æ•°ã€‚å®ƒä¼šå¯åŠ¨æ•´ä¸ªpatchï¼ˆåè°ƒï¼‰ç®—æ³•ï¼Œé€’å½’åœ°å°†vnodeæ ‘æ¯”å¯¹å¹¶æ¸²æŸ“åˆ°çœŸå®çš„containerDOMèŠ‚ç‚¹ä¸­ã€‚</li>
</ol>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šruntime-domå¯¹mountçš„å¢å¼º
åœ¨Â <code>runtime-dom</code>Â ä¸­ï¼Œå®ƒæ‹¿åˆ°äº†Â <code>runtime-core</code>Â è¿”å›çš„åŸºç¡€Â <code>app</code>Â å®ä¾‹ï¼Œä½†å¯¹Â <code>mount</code>Â æ–¹æ³•åšäº†<strong>å…³é”®å¢å¼º</strong>ï¼Œä»¥æ”¯æŒæ›´ç¬¦åˆWebå¼€å‘ä¹ æƒ¯çš„ç”¨æ³•ã€‚</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ä½äº runtime-dom/src/index.ts (æ¥ç¬¬ä¸€æ­¥çš„ä»£ç )</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">ensureRenderer</span>().<span class="hljs-title function_">createApp</span>(...args)

<span class="hljs-comment">// ä» app å®ä¾‹ä¸Šè·å–åŸå§‹çš„ mount æ–¹æ³•</span>
<span class="hljs-keyword">const</span> { mount } = app

<span class="hljs-comment">// é‡å†™ï¼ˆå¢å¼ºï¼‰mount æ–¹æ³•</span>
app.<span class="hljs-property">mount</span> = (<span class="hljs-attr">containerOrSelector</span>: <span class="hljs-title class_">Element</span> | <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">any</span> =&gt;</span> {
  <span class="hljs-comment">// 1. æ ‡å‡†åŒ–å®¹å™¨ï¼ˆæ ¸å¿ƒå¢å¼ºç‚¹ï¼‰ï¼šæ”¯æŒå­—ç¬¦ä¸²é€‰æ‹©å™¨</span>
  <span class="hljs-keyword">const</span> container = <span class="hljs-title function_">normalizeContainer</span>(containerOrSelector)
  <span class="hljs-keyword">if</span> (!container) <span class="hljs-keyword">return</span>

  <span class="hljs-comment">// 2. è·å–ç”¨æˆ·ä¼ å…¥çš„æ ¹ç»„ä»¶ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªç®€å•çš„æ¨¡æ¿å¯¹è±¡ï¼‰</span>
  <span class="hljs-keyword">const</span> component = app.<span class="hljs-property">_component</span>
  <span class="hljs-comment">// 3. å¦‚æœæ ¹ç»„ä»¶ä¸æ˜¯å‡½æ•° &amp; æ²¡æœ‰renderå‡½æ•° &amp; æœ‰templateï¼Œåˆ™å°†templateç¼–è¯‘ä¸ºrenderå‡½æ•°</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isFunction</span>(component) &amp;&amp; !component.<span class="hljs-property">render</span> &amp;&amp; !component.<span class="hljs-property">template</span>) {
    component.<span class="hljs-property">template</span> = container.<span class="hljs-property">innerHTML</span> <span class="hljs-comment">// æ³¨æ„ï¼šè¿™ä»…ç”¨äºæ— æ„å»ºæ­¥éª¤çš„CDNç”¨æ³•</span>
  }

  <span class="hljs-comment">// 4. æ¸…é™¤å®¹å™¨å†…çš„ç°æœ‰å†…å®¹ï¼ˆåœ¨æŒ‚è½½å‰ï¼‰</span>
  container.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>

  <span class="hljs-comment">// 5. è°ƒç”¨ä» runtime-core æ‹¿æ¥çš„åŸå§‹ mount æ–¹æ³•ï¼Œæ‰§è¡ŒçœŸæ­£çš„æŒ‚è½½</span>
  <span class="hljs-keyword">const</span> proxy = <span class="hljs-title function_">mount</span>(container, <span class="hljs-literal">false</span>, container <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">SVGElement</span>)
  <span class="hljs-comment">// ... åç»­å¤„ç†</span>
  <span class="hljs-keyword">return</span> proxy
}
</code></pre>
<p>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªå¢å¼ºï¼Ÿ
ç”¨æˆ·ä½“éªŒï¼šè®©app.mount('#app')è¿™ç§å†™æ³•æˆä¸ºå¯èƒ½ï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½å†™documnet.querySelectorã€‚
æ”¯æŒçº¯HTMLå¼€å‘ï¼šå½“ä½ åœ¨æ²¡æœ‰æ„å»ºæ­¥éª¤ï¼ˆå¦‚Webpack/Viteï¼‰çš„ç¯å¢ƒä¸­ï¼Œç›´æ¥é€šè¿‡Â <code>&lt;script&gt;</code>Â æ ‡ç­¾å¼•å…¥Vueæ—¶ï¼Œä½ å¯èƒ½éœ€è¦åœ¨HTMLä¸­å†™æ¨¡æ¿ã€‚è¿™æ®µä»£ç ä¼šæ£€æŸ¥æ ¹ç»„ä»¶ï¼Œå¦‚æœå®ƒæ²¡æœ‰Â <code>render</code>Â å‡½æ•°ï¼Œå°±ä¼šå°è¯•å°†Â <code>template</code>Â é€‰é¡¹ï¼ˆæˆ–å®¹å™¨å†…çš„HTMLï¼‰<strong>åœ¨è¿è¡Œæ—¶ç¼–è¯‘</strong>æˆÂ <code>render</code>Â å‡½æ•°ã€‚è¿™å°±æ˜¯â€œå®Œæ•´ç‰ˆâ€Vueï¼ˆåŒ…å«ç¼–è¯‘å™¨ï¼‰ä¸â€œä»…è¿è¡Œæ—¶ç‰ˆâ€çš„åŒºåˆ«æ‰€åœ¨ã€‚</p>
<h4 data-id="heading-1">ğŸ’ æ€»ç»“</h4>
<p><code>createApp</code>Â å‡½æ•°çš„ä¸»è¦å·¥ä½œå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>



































<table><thead><tr><th>æ­¥éª¤</th><th>æ‰€åœ¨æ¨¡å—</th><th>æ ¸å¿ƒå·¥ä½œ</th><th>äº§å‡º</th></tr></thead><tbody><tr><td><strong>1. åˆ›å»ºæ¸²æŸ“å™¨</strong></td><td><code>runtime-dom</code></td><td>æ³¨å…¥DOM APIï¼Œåˆ›å»ºå¹³å°ä¸“å±æ¸²æŸ“å™¨ã€‚</td><td>å…·å¤‡Â <code>render</code>Â å’ŒÂ <code>createApp</code>Â æ–¹æ³•çš„æ¸²æŸ“å™¨å¯¹è±¡ã€‚</td></tr><tr><td><strong>2. åˆ›å»ºAppå®ä¾‹</strong></td><td><code>runtime-core</code></td><td>åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡å’ŒåŸºç¡€Appå¯¹è±¡ï¼Œå®šä¹‰æ ¸å¿ƒAPIã€‚</td><td>ä¸€ä¸ªåŒ…å«Â <code>_context</code>ã€åŸºç¡€Â <code>mount</code>Â æ–¹æ³•çš„Â <code>app</code>Â å®ä¾‹ã€‚</td></tr><tr><td><strong>3. å¢å¼ºMount</strong></td><td><code>runtime-dom</code></td><td>ä¸ºÂ <code>mount</code>Â å¢åŠ å®¹å™¨æ ‡å‡†åŒ–å’Œæ¨¡æ¿ç¼–è¯‘æ”¯æŒã€‚</td><td>æœ€ç»ˆç”¨æˆ·ä½¿ç”¨çš„ã€åŠŸèƒ½å®Œæ•´çš„Â <code>app.mount</code>Â æ–¹æ³•ã€‚</td></tr><tr><td><strong>4. å¯åŠ¨åº”ç”¨</strong></td><td>ç”¨æˆ·è°ƒç”¨</td><td>ç”¨æˆ·è°ƒç”¨Â <code>app.mount</code>ï¼Œè§¦å‘è™šæ‹ŸDOMæ¸²æŸ“æµç¨‹ã€‚</td><td>æ ¹ç»„ä»¶è¢«æ¸²æŸ“æˆçœŸå®DOMï¼Œåº”ç”¨å¯åŠ¨ã€‚</td></tr></tbody></table>
<p><strong>æœ¬è´¨ä¸Šï¼Œ<code>createApp</code>Â æ˜¯ä¸€ä¸ªé«˜çº§å·¥å‚å‡½æ•°ï¼Œå®ƒï¼š</strong></p>
<ol>
<li><strong>è£…é…ç¯å¢ƒ</strong>ï¼šå°†å¹³å°ï¼ˆæµè§ˆå™¨ï¼‰çš„å…·ä½“æ“ä½œä¸Vueçš„é€šç”¨æ ¸å¿ƒè¿æ¥ã€‚</li>
<li><strong>åˆ›å»ºä¸Šä¸‹æ–‡</strong>ï¼šä¸ºæ•´ä¸ªç»„ä»¶æ ‘å»ºç«‹ä¸€ä¸ªå…±äº«çš„é…ç½®å’ŒçŠ¶æ€ç©ºé—´ã€‚</li>
<li><strong>å°è£…å¯åŠ¨</strong>ï¼šæä¾›ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Â <code>mount</code>Â æ–¹æ³•ï¼Œéšè—äº†è™šæ‹ŸDOMåˆ›å»ºã€æ¸²æŸ“ã€æŒ‚è½½ç­‰å¤æ‚ç»†èŠ‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3 ä¸Šä¼ æ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ç»„ä»¶]]></title>    <link>https://juejin.cn/post/7579410911057788954</link>    <guid>https://juejin.cn/post/7579410911057788954</guid>    <pubDate>2025-12-03T09:27:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579410911057788954" data-draft-id="7579255046979977242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3 ä¸Šä¼ æ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ç»„ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-03T09:27:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å‘¨åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3808364009365080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3 ä¸Šä¼ æ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ç»„ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808364009365080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å‘¨åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:27:50.000Z" title="Wed Dec 03 2025 09:27:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸Šä¼ æ–‡ä»¶</h2>
<pre><code class="hljs language-ini" lang="ini">&lt;!-- eslint-disable vue/multi-word-component-names --&gt;
&lt;template&gt;
  &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-file"</span>&gt;
    &lt;el-upload
      <span class="hljs-attr">ref</span>=<span class="hljs-string">"uploadRef"</span>
      :<span class="hljs-attr">multiple</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">action</span>=<span class="hljs-string">"uploadFileUrl"</span>
      :<span class="hljs-attr">before-upload</span>=<span class="hljs-string">"handleBeforeUpload"</span>
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"fileList"</span>
      :<span class="hljs-attr">file-list</span>=<span class="hljs-string">"fileList"</span>
      :<span class="hljs-attr">limit</span>=<span class="hljs-string">"limit"</span>
      :<span class="hljs-attr">on-error</span>=<span class="hljs-string">"handleUploadError"</span>
      :<span class="hljs-attr">on-exceed</span>=<span class="hljs-string">"handleExceed"</span>
      :<span class="hljs-attr">on-success</span>=<span class="hljs-string">"handleUploadSuccess"</span>
      :<span class="hljs-attr">show-file-list</span>=<span class="hljs-string">"false"</span>
      :<span class="hljs-attr">headers</span>=<span class="hljs-string">"headers"</span>
      :<span class="hljs-attr">auto-upload</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-file-uploader"</span>
    &gt;
      &lt;!-- ä¸Šä¼ æŒ‰é’® --&gt;
      &lt;el-button <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> v-show=<span class="hljs-string">"isShow"</span>&gt;é€‰å–æ–‡ä»¶&lt;/el-button&gt;
    &lt;/el-upload&gt;
    &lt;!-- ä¸Šä¼ æç¤º --&gt;
    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"el-upload__tip"</span> v-if=<span class="hljs-string">"showTip"</span> v-show=<span class="hljs-string">"isShow"</span>&gt;
      è¯·ä¸Šä¼ 
      &lt;template <span class="hljs-attr">v-if</span>=<span class="hljs-string">"fileSize"</span>&gt;
        å¤§å°ä¸è¶…è¿‡ &lt;b <span class="hljs-attr">style</span>=<span class="hljs-string">"color: #f56c6c"</span>&gt;{{ fileSize }}MB&lt;/b&gt;
      &lt;/template&gt;
      &lt;template <span class="hljs-attr">v-if</span>=<span class="hljs-string">"fileType"</span>&gt;
        æ ¼å¼ä¸º &lt;b <span class="hljs-attr">style</span>=<span class="hljs-string">"color: #f56c6c"</span>&gt;{{ fileType.join(<span class="hljs-string">'/'</span>) }}&lt;/b&gt;
      &lt;/template&gt;
  çš„æ–‡ä»¶
&lt;/div&gt;
&lt;!-- æ–‡ä»¶åˆ—è¡¨ --&gt;
&lt;transition-group
  <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-file-list el-upload-list el-upload-list--text"</span>
  <span class="hljs-attr">name</span>=<span class="hljs-string">"el-fade-in-linear"</span>
  <span class="hljs-attr">tag</span>=<span class="hljs-string">"ul"</span>
&gt;
  &lt;li
    :<span class="hljs-attr">key</span>=<span class="hljs-string">"file.uid"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"el-upload-list__item ele-upload-list__item-content"</span>
    <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(file, index) in fileList"</span>
  &gt;
    &lt;el-link :<span class="hljs-attr">underline</span>=<span class="hljs-string">"false"</span> target=<span class="hljs-string">"_blank"</span>&gt;
      &lt;span <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-document"</span>&gt;
        {{ file.attachmentName }}
      &lt;/span&gt;
    &lt;/el-link&gt;
    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"ele-upload-list__item-content-action"</span>&gt;
      &lt;el-link <span class="hljs-attr">v-show</span>=<span class="hljs-string">"isShow"</span> :underline=<span class="hljs-string">"false"</span> @click=<span class="hljs-string">"handleDelete(index)"</span> type=<span class="hljs-string">"danger"</span>
        &gt;åˆ é™¤&lt;/el-link
      &gt;
      &lt;el-link
        :<span class="hljs-attr">underline</span>=<span class="hljs-string">"false"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"downloadFile(file)"</span>
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"dowloadStatus"</span>
        &gt;ä¸‹è½½&lt;/el-link
      &gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/transition-group&gt;
</code></pre>
  

<pre><code class="hljs language-typescript" lang="typescript">&lt;script lang=<span class="hljs-string">"ts"</span> setup&gt;
<span class="hljs-keyword">import</span> cache <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/cache'</span>;
<span class="hljs-keyword">import</span> { log } <span class="hljs-keyword">from</span> <span class="hljs-string">'console'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElMessage</span>, <span class="hljs-title class_">UploadUserFile</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;
<span class="hljs-keyword">import</span> { ref, computed, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Download</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@element-plus/icons-vue'</span>;
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/stores'</span>;
<span class="hljs-keyword">const</span> uploadRef = <span class="hljs-title function_">ref</span>();

<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">modelValue</span>: [<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>, <span class="hljs-title class_">Array</span>],
  <span class="hljs-comment">// æ•°é‡é™åˆ¶</span>
  <span class="hljs-attr">limit</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">5</span>
  },
  <span class="hljs-comment">// å¤§å°é™åˆ¶(MB)</span>
  <span class="hljs-attr">fileSize</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">1100</span>
  },
  <span class="hljs-comment">// æ–‡ä»¶ç±»å‹, ä¾‹å¦‚['png', 'jpg', 'jpeg']</span>
  <span class="hljs-attr">fileType</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [<span class="hljs-string">'doc'</span>, <span class="hljs-string">'xls'</span>, <span class="hljs-string">'xlsx'</span>, <span class="hljs-string">'pdf'</span>, <span class="hljs-string">'docx'</span>]
  },
  <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºæç¤º</span>
  <span class="hljs-attr">isShowTip</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">//æ˜¯å¦æ˜¾ç¤ºåˆ é™¤æŒ‰é’®</span>
  <span class="hljs-attr">isShow</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">//æ˜¯å¦æ˜¾ç¤ºä¸‹è½½</span>
  <span class="hljs-attr">dowloadStatus</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>
  }
});

<span class="hljs-comment">// @ts-ignore</span>
<span class="hljs-keyword">const</span> { proxy } = <span class="hljs-title function_">getCurrentInstance</span>();
<span class="hljs-comment">// eslint-disable-next-line vue/valid-define-emits</span>
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>();
<span class="hljs-keyword">const</span> <span class="hljs-built_in">number</span> = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> uploadFileUrl = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_BASE_API</span> + <span class="hljs-string">'/minio/upload'</span>; <span class="hljs-comment">// ä¸Šä¼ æ–‡ä»¶æœåŠ¡å™¨åœ°å€</span>
<span class="hljs-keyword">const</span> headers = <span class="hljs-title function_">ref</span>({
  <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">'Bearer '</span> + <span class="hljs-title function_">useUserStore</span>().<span class="hljs-property">token</span>,
  <span class="hljs-string">'bg-debug'</span>: <span class="hljs-number">1</span>
});
<span class="hljs-keyword">const</span> fileList = ref&lt;<span class="hljs-title class_">UploadUserFile</span>[]&gt;([]);
<span class="hljs-keyword">const</span> showTip = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">isShowTip</span> &amp;&amp; (props.<span class="hljs-property">fileType</span> || props.<span class="hljs-property">fileSize</span>));

<span class="hljs-title function_">watch</span>(
  [<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">modelValue</span>, <span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">dowloadStatus</span>],
  <span class="hljs-function">(<span class="hljs-params">val: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (val) {
      fileList.<span class="hljs-property">value</span> = props.<span class="hljs-property">modelValue</span>;
    }
  },
  { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }
);
<span class="hljs-comment">// ä¸Šä¼ å‰æ ¡æ£€æ ¼å¼å’Œå¤§å°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleBeforeUpload</span>(<span class="hljs-params">file: { name: <span class="hljs-built_in">string</span>; size: <span class="hljs-built_in">number</span> }</span>) {
  <span class="hljs-comment">// æ ¡æ£€æ–‡ä»¶ç±»å‹</span>
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">fileType</span>.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">const</span> fileName = file.<span class="hljs-property">name</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>);
    <span class="hljs-keyword">const</span> fileExt = fileName[fileName.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">const</span> isTypeOk = props.<span class="hljs-property">fileType</span>.<span class="hljs-title function_">indexOf</span>(fileExt) &gt;= <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!isTypeOk) {
      <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®, è¯·ä¸Šä¼ <span class="hljs-subst">${props.fileType.join(<span class="hljs-string">'/'</span>)}</span>æ ¼å¼æ–‡ä»¶!`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-comment">// æ ¡æ£€æ–‡ä»¶å¤§å°</span>
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">fileSize</span>) {
    <span class="hljs-keyword">const</span> isLt = file.<span class="hljs-property">size</span> / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span> &lt; props.<span class="hljs-property">fileSize</span>;
    <span class="hljs-keyword">if</span> (!isLt) {
      <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ <span class="hljs-subst">${props.fileSize}</span> MB!`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-built_in">number</span>.<span class="hljs-property">value</span>++;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">//ä¸‹è½½æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">downloadPdf</span> = (<span class="hljs-params">data: <span class="hljs-built_in">any</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> fileName = data.<span class="hljs-property">attachmentName</span>;
  <span class="hljs-keyword">const</span> fileUrl = data.<span class="hljs-property">attachmentPath</span>;
  <span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
  request.<span class="hljs-property">responseType</span> = <span class="hljs-string">'blob'</span>;
  request.<span class="hljs-title function_">open</span>(<span class="hljs-string">'Get'</span>, fileUrl);
  request.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> url = <span class="hljs-variable language_">window</span>.<span class="hljs-property">URL</span>.<span class="hljs-title function_">createObjectURL</span>(request.<span class="hljs-property">response</span>);
    <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(a);
    a.<span class="hljs-property">href</span> = url;
    a.<span class="hljs-property">download</span> = fileName;
    a.<span class="hljs-title function_">click</span>();
  };
  request.<span class="hljs-title function_">send</span>();
};

<span class="hljs-comment">//ä¸‹è½½æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">downloadFile</span> = (<span class="hljs-params">file: { attachmentPath: <span class="hljs-built_in">any</span>; attachmentName: <span class="hljs-built_in">any</span> }</span>) =&gt; {
  <span class="hljs-keyword">const</span> lastDotIdx = file.<span class="hljs-property">attachmentPath</span>.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">type</span> = file.<span class="hljs-property">attachmentPath</span>.<span class="hljs-title function_">slice</span>(lastDotIdx + <span class="hljs-number">1</span>).<span class="hljs-title function_">toUpperCase</span>();
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'PDF'</span>) {
    <span class="hljs-title function_">downloadPdf</span>(file);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
    link.<span class="hljs-property">href</span> = file.<span class="hljs-property">attachmentPath</span>;
    link.<span class="hljs-property">download</span> = file.<span class="hljs-property">attachmentName</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);
    link.<span class="hljs-title function_">click</span>();
  }
};
<span class="hljs-comment">// æ–‡ä»¶ä¸ªæ•°è¶…å‡º</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleExceed</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ä¸Šä¼ æ–‡ä»¶æ•°é‡ä¸èƒ½è¶…è¿‡ <span class="hljs-subst">${props.limit}</span> ä¸ª!`</span>);
}

<span class="hljs-comment">// ä¸Šä¼ å¤±è´¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleUploadError</span>(<span class="hljs-params">err: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä¸Šä¼ æ–‡ä»¶å¤±è´¥'</span>);
}
<span class="hljs-comment">/** æ–‡ä»¶ä¸Šä¼ æˆåŠŸå¤„ç† */</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">handleUploadSuccess</span>: <span class="hljs-title class_">UploadProps</span>[<span class="hljs-string">'onSuccess'</span>] = <span class="hljs-function">(<span class="hljs-params">
  response: { data: { url: <span class="hljs-built_in">any</span> } },
  file: { name: <span class="hljs-built_in">any</span> }
</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> newFile = { <span class="hljs-attr">attachmentName</span>: file.<span class="hljs-property">name</span>, <span class="hljs-attr">attachmentPath</span>: response.<span class="hljs-property">data</span>.<span class="hljs-property">url</span> };
  fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>(newFile);
  uploadRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">submit</span>();
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, fileList.<span class="hljs-property">value</span>);
};
<span class="hljs-comment">// åˆ é™¤æ–‡ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleDelete</span>(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) {
  fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
  <span class="hljs-comment">// @ts-ignore</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, fileList.<span class="hljs-property">value</span>);
}
&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.upload-file-uploader</span> {
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;
}
<span class="hljs-selector-class">.upload-file-list</span> <span class="hljs-selector-class">.el-upload-list__item</span> {
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e4e7ed</span>;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">2</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">position</span>: relative;
}
<span class="hljs-selector-class">.upload-file-list</span> <span class="hljs-selector-class">.ele-upload-list__item-content</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">color</span>: inherit;
}
<span class="hljs-selector-class">.ele-upload-list__item-content-action</span> <span class="hljs-selector-class">.el-link</span> {
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.ele-upload-list__item-content-action</span> <span class="hljs-selector-class">.el-icon</span> {
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-1">ä¸Šä¼ å›¾ç‰‡</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"pro-upload-img-box"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"pro-upload-img-content"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å·²ä¸Šä¼ å›¾ç‰‡åˆ—è¡¨ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-img-card"</span>
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in fileList"</span>
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
      &gt;</span>
        <span class="hljs-comment">&lt;!-- å›¾ç‰‡é¢„è§ˆ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-image</span>
          <span class="hljs-attr">class</span>=<span class="hljs-string">"img-sty"</span>
          <span class="hljs-attr">:preview-src-list</span>=<span class="hljs-string">"[item.url]"</span>
          <span class="hljs-attr">fit</span>=<span class="hljs-string">"cover"</span>
          <span class="hljs-attr">:src</span>=<span class="hljs-string">"item.url"</span>
          <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span>
        /&gt;</span>
        <span class="hljs-comment">&lt;!-- åˆ é™¤æŒ‰é’® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-image</span>
          <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!disabled"</span>
          <span class="hljs-attr">src</span>=<span class="hljs-string">"https://static.wxb.com.cn/frontEnd/images/ideacome-vue3-component/img-close.png"</span>
          <span class="hljs-attr">class</span>=<span class="hljs-string">"img-close"</span>
          @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleRemove(item, index)"</span>
        /&gt;</span>
        <span class="hljs-comment">&lt;!-- å›¾ç‰‡é®ç½©å±‚ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"img-mask"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-image</span>
            <span class="hljs-attr">src</span>=<span class="hljs-string">"https://static.wxb.com.cn/frontEnd/images/ideacome-vue3-component/img-preview.png"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"img-preview"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ä¸Šä¼ ç»„ä»¶ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-upload</span>
        <span class="hljs-attr">v-loading</span>=<span class="hljs-string">"loading"</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">"proUploadImgRef"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"['pro-upload-img', { 'is-disabled': disabled }]"</span>
        <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"uploadProps"</span>
        <span class="hljs-attr">:before-upload</span>=<span class="hljs-string">"beforeUpload"</span>
        <span class="hljs-attr">:on-success</span>=<span class="hljs-string">"handleSuccess"</span>
        <span class="hljs-attr">:on-error</span>=<span class="hljs-string">"handleError"</span>
        <span class="hljs-attr">:on-exceed</span>=<span class="hljs-string">"handleExceed"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-card"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-icon"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"font-size: 30px;"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">CirclePlus</span>  /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"uploadText"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-text"</span>&gt;</span>
              {{ uploadText }}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-upload</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æç¤ºä¿¡æ¯ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"tip"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-tip"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tip"</span>&gt;</span>
        {{ tip }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"ProUploadImg"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Plus</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@element-plus/icons-vue'</span>;
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElMessage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;

  <span class="hljs-comment">// Props å®šä¹‰</span>
  <span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
    <span class="hljs-comment">/** ä¸Šä¼ åœ°å€ */</span>
    <span class="hljs-attr">action</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    },
    <span class="hljs-comment">/** è¯·æ±‚å¤´ */</span>
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({}),
    },
    <span class="hljs-comment">/** æ˜¯å¦æ”¯æŒå¤šé€‰ */</span>
    <span class="hljs-attr">multiple</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,
    },
    <span class="hljs-comment">/** æœ€å¤§ä¸Šä¼ æ•°é‡ï¼Œ0è¡¨ç¤ºä¸é™åˆ¶ */</span>
    <span class="hljs-attr">limit</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** æ¥å—çš„æ–‡ä»¶ç±»å‹ï¼Œå¦‚ï¼š.jpg,.png,.jpeg */</span>
    <span class="hljs-attr">accept</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'.jpg,.png,.jpeg'</span>,
    },
    <span class="hljs-comment">/** æ–‡ä»¶å¤§å°é™åˆ¶ */</span>
    <span class="hljs-attr">maxSize</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** æ–‡ä»¶å¤§å°å•ä½ï¼ˆKB/MBï¼‰ */</span>
    <span class="hljs-attr">sizeUnit</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'MB'</span>,
      <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> [<span class="hljs-string">'KB'</span>, <span class="hljs-string">'MB'</span>].<span class="hljs-title function_">includes</span>(value),
    },
    <span class="hljs-comment">/** å›¾ç‰‡å®½åº¦é™åˆ¶ */</span>
    <span class="hljs-attr">width</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** å›¾ç‰‡é«˜åº¦é™åˆ¶ */</span>
    <span class="hljs-attr">height</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** ä¸Šä¼ æç¤ºæ–‡å­— */</span>
    <span class="hljs-attr">uploadText</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'ç‚¹å‡»ä¸Šä¼ '</span>,
    },
    <span class="hljs-comment">/** ä¸Šä¼ æç¤ºè¯´æ˜ */</span>
    <span class="hljs-attr">tip</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>,
    },
    <span class="hljs-comment">/** æ˜¯å¦ç¦ç”¨ */</span>
    <span class="hljs-attr">disabled</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,
    },
  });
  <span class="hljs-comment">/** åˆå§‹æ–‡ä»¶åˆ—è¡¨ */</span>
  <span class="hljs-keyword">const</span> fileList = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'fileList'</span>, {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],
  });

  <span class="hljs-comment">// äº‹ä»¶å®šä¹‰</span>
  <span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'success'</span>, <span class="hljs-string">'error'</span>, <span class="hljs-string">'exceed'</span>, <span class="hljs-string">'remove'</span>]);

  <span class="hljs-keyword">const</span> proUploadImgRef = <span class="hljs-title function_">ref</span>();
  <span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> uploadProps = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">action</span>: props.<span class="hljs-property">action</span>,
    <span class="hljs-attr">accept</span>: props.<span class="hljs-property">accept</span>,
    <span class="hljs-attr">limit</span>: props.<span class="hljs-property">limit</span>,
    <span class="hljs-attr">multiple</span>: props.<span class="hljs-property">multiple</span>,
    <span class="hljs-attr">listType</span>: <span class="hljs-string">'picture-card'</span>,
    <span class="hljs-attr">showFileList</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">headers</span>: props.<span class="hljs-property">headers</span>,
    <span class="hljs-attr">fileList</span>: fileList.<span class="hljs-property">value</span>,
    <span class="hljs-attr">disabled</span>: props.<span class="hljs-property">disabled</span>,
  }));

  <span class="hljs-comment">/**
   * éªŒè¯å›¾ç‰‡å°ºå¯¸æ˜¯å¦ç¬¦åˆè¦æ±‚
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">width</span> - å›¾ç‰‡å®½åº¦
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">height</span> - å›¾ç‰‡é«˜åº¦
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ˜¯å¦ç¬¦åˆè¦æ±‚
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">validateImageSize</span> = (<span class="hljs-params">width, height</span>) =&gt; {
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">width</span> &amp;&amp; props.<span class="hljs-property">height</span>) {
      <span class="hljs-keyword">return</span> width === props.<span class="hljs-property">width</span> &amp;&amp; height === props.<span class="hljs-property">height</span>;
    }
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">width</span>) {
      <span class="hljs-keyword">return</span> width === props.<span class="hljs-property">width</span>;
    }
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">height</span>) {
      <span class="hljs-keyword">return</span> height === props.<span class="hljs-property">height</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ å‰æ ¡éªŒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">File</span>} <span class="hljs-variable">file</span> - å¾…ä¸Šä¼ çš„æ–‡ä»¶
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;boolean&gt;</span>} æ˜¯å¦é€šè¿‡æ ¡éªŒ
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">beforeUpload</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">file</span>) =&gt; {
    <span class="hljs-comment">// æ ¡éªŒæ–‡ä»¶ç±»å‹</span>
    <span class="hljs-keyword">const</span> fileTypeList = props.<span class="hljs-property">accept</span>
      .<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'.'</span>, <span class="hljs-string">''</span>));
    <span class="hljs-keyword">const</span> fileType = file.<span class="hljs-property">name</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">pop</span>();

    <span class="hljs-keyword">if</span> (!fileTypeList.<span class="hljs-title function_">includes</span>(fileType)) {
      <span class="hljs-title class_">ElMessage</span>({
        <span class="hljs-attr">message</span>: <span class="hljs-string">`ä»…æ”¯æŒ <span class="hljs-subst">${fileTypeList.join(<span class="hljs-string">'ã€'</span>)}</span> æ ¼å¼`</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
      });
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// æ ¡éªŒæ–‡ä»¶å¤§å°</span>
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">maxSize</span>) {
      <span class="hljs-keyword">const</span> fileSize = file.<span class="hljs-property">size</span> / <span class="hljs-number">1024</span>;
      <span class="hljs-keyword">const</span> maxSizeInKB =
        props.<span class="hljs-property">sizeUnit</span> === <span class="hljs-string">'MB'</span> ? props.<span class="hljs-property">maxSize</span> * <span class="hljs-number">1024</span> : props.<span class="hljs-property">maxSize</span>;
      <span class="hljs-keyword">if</span> (fileSize &gt; maxSizeInKB) {
        <span class="hljs-title class_">ElMessage</span>({
          <span class="hljs-attr">message</span>: <span class="hljs-string">`å¤§å°ä¸èƒ½è¶…è¿‡ <span class="hljs-subst">${props.maxSize}</span><span class="hljs-subst">${props.sizeUnit}</span>ï¼`</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
        });
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }

    <span class="hljs-comment">// æ ¡éªŒå›¾ç‰‡å°ºå¯¸</span>
    <span class="hljs-comment">// return new Promise((resolve, reject) =&gt; {</span>
    <span class="hljs-comment">//   const img = new Image();</span>
    <span class="hljs-comment">//   img.src = URL.createObjectURL(file);</span>
    <span class="hljs-comment">//   img.onload = () =&gt; {</span>
    <span class="hljs-comment">//     URL.revokeObjectURL(img.src);</span>
    <span class="hljs-comment">//     const { width, height } = img;</span>

    <span class="hljs-comment">//     if (!validateImageSize(width, height)) {</span>
    <span class="hljs-comment">//       const message =</span>
    <span class="hljs-comment">//         props.width &amp;&amp; props.height</span>
    <span class="hljs-comment">//           ? `å›¾ç‰‡å°ºå¯¸å¿…é¡»ä¸º ${props.width}x${props.height}`</span>
    <span class="hljs-comment">//           : props.width</span>
    <span class="hljs-comment">//             ? `å›¾ç‰‡å®½åº¦å¿…é¡»ä¸º ${props.width}px`</span>
    <span class="hljs-comment">//             : `å›¾ç‰‡é«˜åº¦å¿…é¡»ä¸º ${props.height}px`;</span>

    <span class="hljs-comment">//       ElMessage({</span>
    <span class="hljs-comment">//         message,</span>
    <span class="hljs-comment">//         type: 'warning',</span>
    <span class="hljs-comment">//       });</span>
    <span class="hljs-comment">//       reject(false);</span>
    <span class="hljs-comment">//       return;</span>
    <span class="hljs-comment">//     }</span>
    <span class="hljs-comment">//     loading.value = true;</span>
    <span class="hljs-comment">//     resolve(true);</span>
    <span class="hljs-comment">//   };</span>
    <span class="hljs-comment">//   img.onerror = () =&gt; {</span>
    <span class="hljs-comment">//     URL.revokeObjectURL(img.src);</span>
    <span class="hljs-comment">//     ElMessage({</span>
    <span class="hljs-comment">//       message: 'å›¾ç‰‡åŠ è½½å¤±è´¥',</span>
    <span class="hljs-comment">//       type: 'error',</span>
    <span class="hljs-comment">//     });</span>
    <span class="hljs-comment">//     reject(false);</span>
    <span class="hljs-comment">//   };</span>
    <span class="hljs-comment">// });</span>
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ æˆåŠŸå›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">response</span> - æœåŠ¡å™¨å“åº”æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">uploadFile</span> - ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSuccess</span> = (<span class="hljs-params">response, uploadFile, uploadFiles</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response, uploadFile, uploadFiles,<span class="hljs-number">12345666</span>)
    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
      fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">url</span>: response.<span class="hljs-property">data</span>.<span class="hljs-property">url</span> });
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fileList.<span class="hljs-property">value</span>,<span class="hljs-number">12345</span>)
    } <span class="hljs-keyword">else</span> {
      proUploadImgRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">handleRemove</span>(uploadFile);
      <span class="hljs-title class_">ElMessage</span>({
        <span class="hljs-attr">message</span>: response.<span class="hljs-property">msg</span> || response.<span class="hljs-property">message</span> || <span class="hljs-string">'ä¸Šä¼ å¤±è´¥'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>,
      });
    }
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'success'</span>, response, uploadFile, uploadFiles);
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ å¤±è´¥å›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Error</span>} <span class="hljs-variable">error</span> - é”™è¯¯ä¿¡æ¯
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">uploadFile</span> - ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleError</span> = (<span class="hljs-params">error, uploadFile, uploadFiles</span>) =&gt; {
    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-title class_">ElMessage</span>({
      <span class="hljs-attr">message</span>: <span class="hljs-string">'ä¸Šä¼ å¤±è´¥'</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>,
    });
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error, uploadFile, uploadFiles);
  };

  <span class="hljs-comment">/**
   * è¶…å‡ºé™åˆ¶å›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">files</span> - è¶…å‡ºé™åˆ¶çš„æ–‡ä»¶åˆ—è¡¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - å·²ä¸Šä¼ çš„æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleExceed</span> = (<span class="hljs-params">files, uploadFiles</span>) =&gt; {
    <span class="hljs-title class_">ElMessage</span>({
      <span class="hljs-attr">message</span>: <span class="hljs-string">`æœ€å¤šåªèƒ½ä¸Šä¼  <span class="hljs-subst">${props.limit}</span> å¼ å›¾ç‰‡`</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
    });
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'exceed'</span>, files, uploadFiles);
  };

  <span class="hljs-comment">/**
   * ç§»é™¤å›¾ç‰‡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">file</span> - è¦ç§»é™¤çš„æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">index</span> - æ–‡ä»¶ç´¢å¼•
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleRemove</span> = (<span class="hljs-params">file, index</span>) =&gt; {
    fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
    proUploadImgRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">handleRemove</span>(file);
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'remove'</span>, file);
  };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.pro-upload-img-box</span> {
  <span class="hljs-selector-class">.pro-upload-img-content</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-wrap</span>: wrap;
    // å·²ä¸Šä¼ å›¾ç‰‡å¡ç‰‡æ ·å¼
    <span class="hljs-selector-class">.upload-img-card</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">12px</span> <span class="hljs-number">12px</span> <span class="hljs-number">0</span>;
      // å›¾ç‰‡æ ·å¼
      <span class="hljs-selector-class">.img-sty</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">overflow</span>: hidden;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      }
      // åˆ é™¤æŒ‰é’®æ ·å¼
      <span class="hljs-selector-class">.img-close</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">right</span>: -<span class="hljs-number">6px</span>;
        <span class="hljs-attribute">top</span>: -<span class="hljs-number">6px</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;
      }
      // é®ç½©å±‚æ ·å¼
      <span class="hljs-selector-class">.img-mask</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">pointer-events</span>: none;

        <span class="hljs-selector-class">.img-preview</span> {
          <span class="hljs-attribute">position</span>: absolute;
          <span class="hljs-attribute">right</span>: <span class="hljs-number">8px</span>;
          <span class="hljs-attribute">bottom</span>: <span class="hljs-number">8px</span>;
          <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
          <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
          <span class="hljs-attribute">pointer-events</span>: none;
        }
      }
    }

    // ç¦ç”¨çŠ¶æ€æ ·å¼
    <span class="hljs-selector-class">.is-disabled</span> {
      :<span class="hljs-built_in">deep</span>(.el-upload--picture-card) {
        <span class="hljs-attribute">cursor</span>: not-allowed;
      }
    }
    // ä¸Šä¼ æŒ‰é’®æ ·å¼
    <span class="hljs-selector-class">.pro-upload-img</span> {
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-selector-class">.upload-card</span> {
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">flex-direction</span>: column;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-selector-class">.upload-icon</span> {
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
          <span class="hljs-attribute">text-align</span>: center;
          <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;
        }

        <span class="hljs-selector-class">.upload-text</span> {
          <span class="hljs-attribute">line-height</span>: <span class="hljs-number">24px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
          <span class="hljs-attribute">text-align</span>: center;
          <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;
        }
      }
    }

    // ä¸Šä¼ ç»„ä»¶æ ·å¼è¦†ç›–
    :<span class="hljs-built_in">deep</span>(.el-upload--picture-card) {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#F8F8F9</span>;
    }
    :<span class="hljs-built_in">deep</span>(.el-upload-list__item) {
      <span class="hljs-attribute">width</span>: auto;
      <span class="hljs-attribute">height</span>: auto;
      <span class="hljs-attribute">overflow</span>: visible;
    }
  }
  // æç¤ºæ–‡å­—æ ·å¼
  <span class="hljs-selector-class">.upload-tip</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#909399</span>;
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-2">ä¸Šä¼ è§†é¢‘</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"pro-upload-video-box"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"pro-upload-video-content"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å·²ä¸Šä¼ è§†é¢‘åˆ—è¡¨ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-video-card"</span>
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in fileList"</span>
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
      &gt;</span>
        <span class="hljs-comment">&lt;!-- è§†é¢‘ç¼©ç•¥å›¾/æ’­æ”¾æŒ‰é’® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-thumbnail"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"playVideo(item.url)"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-icon"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">VideoPlay</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- è§†é¢‘ä¿¡æ¯ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-info"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"playVideo(item.url)"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-name"</span>&gt;</span>{{ getFileName(item.url) }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-size"</span>&gt;</span>{{ getFileSize(item.size) }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åˆ é™¤æŒ‰é’® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-image</span>
          <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!disabled"</span>
          <span class="hljs-attr">src</span>=<span class="hljs-string">"https://static.wxb.com.cn/frontEnd/images/ideacome-vue3-component/img-close.png"</span>
          <span class="hljs-attr">class</span>=<span class="hljs-string">"video-close"</span>
          @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleRemove(item, index)"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ä¸Šä¼ ç»„ä»¶ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-upload</span>
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!disabled"</span>
        <span class="hljs-attr">v-loading</span>=<span class="hljs-string">"loading"</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">"proUploadVideoRef"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"['pro-upload-video', { 'is-disabled': disabled }]"</span>
        <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"uploadProps"</span>
        <span class="hljs-attr">:before-upload</span>=<span class="hljs-string">"beforeUpload"</span>
        <span class="hljs-attr">:on-success</span>=<span class="hljs-string">"handleSuccess"</span>
        <span class="hljs-attr">:on-error</span>=<span class="hljs-string">"handleError"</span>
        <span class="hljs-attr">:on-exceed</span>=<span class="hljs-string">"handleExceed"</span>
        <span class="hljs-attr">:on-progress</span>=<span class="hljs-string">"handleProgress"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-card"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-icon"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Plus</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"uploadText"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-text"</span>&gt;</span>
              {{ uploadText }}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-upload</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æç¤ºä¿¡æ¯ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"tip"</span>  <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!disabled"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"upload-tip"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tip"</span>&gt;</span>
        {{ tip }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"ProUploadVideo"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Plus</span>, <span class="hljs-title class_">VideoPlay</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@element-plus/icons-vue'</span>;
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElMessage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;

  <span class="hljs-comment">// Props å®šä¹‰</span>
  <span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
    <span class="hljs-comment">/** ä¸Šä¼ åœ°å€ */</span>
    <span class="hljs-attr">action</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    },
    <span class="hljs-comment">/** è¯·æ±‚å¤´ */</span>
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({}),
    },
    <span class="hljs-comment">/** æ˜¯å¦æ”¯æŒå¤šé€‰ */</span>
    <span class="hljs-attr">multiple</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,
    },
    <span class="hljs-comment">/** æœ€å¤§ä¸Šä¼ æ•°é‡ï¼Œ0è¡¨ç¤ºä¸é™åˆ¶ */</span>
    <span class="hljs-attr">limit</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** æ¥å—çš„æ–‡ä»¶ç±»å‹ï¼Œå¦‚ï¼š.mp4,.avi,.mov */</span>
    <span class="hljs-attr">accept</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'.mp4,.avi,.mov,.wmv,.flv,.webm'</span>,
    },
    <span class="hljs-comment">/** æ–‡ä»¶å¤§å°é™åˆ¶ */</span>
    <span class="hljs-attr">maxSize</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,
    },
    <span class="hljs-comment">/** æ–‡ä»¶å¤§å°å•ä½ï¼ˆKB/MBï¼‰ */</span>
    <span class="hljs-attr">sizeUnit</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'MB'</span>,
      <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> [<span class="hljs-string">'KB'</span>, <span class="hljs-string">'MB'</span>].<span class="hljs-title function_">includes</span>(value),
    },
    <span class="hljs-comment">/** ä¸Šä¼ æç¤ºæ–‡å­— */</span>
    <span class="hljs-attr">uploadText</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'ä¸Šä¼ è§†é¢‘'</span>,
    },
    <span class="hljs-comment">/** ä¸Šä¼ æç¤ºè¯´æ˜ */</span>
    <span class="hljs-attr">tip</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>,
    },
    <span class="hljs-comment">/** æ˜¯å¦ç¦ç”¨ */</span>
    <span class="hljs-attr">disabled</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,
    },
  });
  <span class="hljs-comment">/** åˆå§‹æ–‡ä»¶åˆ—è¡¨ */</span>
  <span class="hljs-keyword">const</span> fileList = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'fileList'</span>, {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],
  });

  <span class="hljs-comment">// äº‹ä»¶å®šä¹‰</span>
  <span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'success'</span>, <span class="hljs-string">'error'</span>, <span class="hljs-string">'exceed'</span>, <span class="hljs-string">'remove'</span>, <span class="hljs-string">'deleteAnnex'</span>, <span class="hljs-string">'progress'</span>]);

  <span class="hljs-keyword">const</span> proUploadVideoRef = <span class="hljs-title function_">ref</span>();
  <span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> uploadProps = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">action</span>: props.<span class="hljs-property">action</span>,
    <span class="hljs-attr">accept</span>: props.<span class="hljs-property">accept</span>,
    <span class="hljs-attr">limit</span>: props.<span class="hljs-property">limit</span>,
    <span class="hljs-attr">multiple</span>: props.<span class="hljs-property">multiple</span>,
    <span class="hljs-attr">listType</span>: <span class="hljs-string">'text'</span>,
    <span class="hljs-attr">showFileList</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">headers</span>: props.<span class="hljs-property">headers</span>,
    <span class="hljs-attr">fileList</span>: fileList.<span class="hljs-property">value</span>,
    <span class="hljs-attr">disabled</span>: props.<span class="hljs-property">disabled</span>,
  }));

  <span class="hljs-comment">/**
   * è·å–æ–‡ä»¶å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - æ–‡ä»¶è·¯å¾„
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} æ–‡ä»¶å
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getFileName</span> = (<span class="hljs-params">url</span>) =&gt; {
    <span class="hljs-keyword">if</span> (!url) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> fileName = url.<span class="hljs-title function_">substring</span>(url.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">'/'</span>) + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> fileName.<span class="hljs-property">length</span> &gt; <span class="hljs-number">15</span> ? fileName.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>) + <span class="hljs-string">'...'</span> : fileName;
  };

  <span class="hljs-comment">/**
   * è·å–æ–‡ä»¶å¤§å°æ˜¾ç¤º
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">size</span> - æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} æ ¼å¼åŒ–åçš„æ–‡ä»¶å¤§å°
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getFileSize</span> = (<span class="hljs-params">size</span>) =&gt; {
    <span class="hljs-keyword">if</span> (!size) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> units = [<span class="hljs-string">'B'</span>, <span class="hljs-string">'KB'</span>, <span class="hljs-string">'MB'</span>, <span class="hljs-string">'GB'</span>];
    <span class="hljs-keyword">let</span> unitIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> fileSize = size;

    <span class="hljs-keyword">while</span> (fileSize &gt;= <span class="hljs-number">1024</span> &amp;&amp; unitIndex &lt; units.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
      fileSize /= <span class="hljs-number">1024</span>;
      unitIndex++;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${fileSize.toFixed(<span class="hljs-number">2</span>)}</span> <span class="hljs-subst">${units[unitIndex]}</span>`</span>;
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ å‰æ ¡éªŒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">File</span>} <span class="hljs-variable">file</span> - å¾…ä¸Šä¼ çš„æ–‡ä»¶
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;boolean&gt;</span>} æ˜¯å¦é€šè¿‡æ ¡éªŒ
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">beforeUpload</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">file</span>) =&gt; {
    <span class="hljs-comment">// æ ¡éªŒæ–‡ä»¶ç±»å‹</span>
    <span class="hljs-keyword">const</span> fileTypeList = props.<span class="hljs-property">accept</span>
      .<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'.'</span>, <span class="hljs-string">''</span>).<span class="hljs-title function_">toLowerCase</span>());
    <span class="hljs-keyword">const</span> fileType = file.<span class="hljs-property">name</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-keyword">if</span> (!fileTypeList.<span class="hljs-title function_">includes</span>(fileType)) {
      <span class="hljs-title class_">ElMessage</span>({
        <span class="hljs-attr">message</span>: <span class="hljs-string">`ä»…æ”¯æŒ <span class="hljs-subst">${props.accept}</span> æ ¼å¼`</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
      });
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// æ ¡éªŒæ–‡ä»¶å¤§å°</span>
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">maxSize</span>) {
      <span class="hljs-keyword">const</span> fileSize = file.<span class="hljs-property">size</span>;
      <span class="hljs-keyword">const</span> maxSizeInBytes =
        props.<span class="hljs-property">sizeUnit</span> === <span class="hljs-string">'MB'</span> ? props.<span class="hljs-property">maxSize</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> : props.<span class="hljs-property">maxSize</span> * <span class="hljs-number">1024</span>;
      <span class="hljs-keyword">if</span> (fileSize &gt; maxSizeInBytes) {
        <span class="hljs-title class_">ElMessage</span>({
          <span class="hljs-attr">message</span>: <span class="hljs-string">`å¤§å°ä¸èƒ½è¶…è¿‡ <span class="hljs-subst">${props.maxSize}</span><span class="hljs-subst">${props.sizeUnit}</span>ï¼`</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
        });
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
    }

    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ è¿›åº¦å›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">event</span> - è¿›åº¦äº‹ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">uploadFile</span> - ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleProgress</span> = (<span class="hljs-params">event, uploadFile, uploadFiles</span>) =&gt; {
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'progress'</span>, event, uploadFile, uploadFiles);
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ æˆåŠŸå›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">response</span> - æœåŠ¡å™¨å“åº”æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">uploadFile</span> - ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSuccess</span> = (<span class="hljs-params">response, uploadFile, uploadFiles</span>) =&gt; {
    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
      fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">url</span>: response.<span class="hljs-property">data</span>.<span class="hljs-property">url</span>,
        <span class="hljs-attr">name</span>: uploadFile.<span class="hljs-property">name</span>,
        <span class="hljs-attr">size</span>: uploadFile.<span class="hljs-property">size</span>
      });
    } <span class="hljs-keyword">else</span> {
      proUploadVideoRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">handleRemove</span>(uploadFile);
      <span class="hljs-title class_">ElMessage</span>({
        <span class="hljs-attr">message</span>: response.<span class="hljs-property">msg</span> || response.<span class="hljs-property">message</span> || <span class="hljs-string">'ä¸Šä¼ å¤±è´¥'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>,
      });
    }
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'success'</span>, response, uploadFile, uploadFiles);
  };

  <span class="hljs-comment">/**
   * ä¸Šä¼ å¤±è´¥å›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Error</span>} <span class="hljs-variable">error</span> - é”™è¯¯ä¿¡æ¯
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">uploadFile</span> - ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleError</span> = (<span class="hljs-params">error, uploadFile, uploadFiles</span>) =&gt; {
    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-title class_">ElMessage</span>({
      <span class="hljs-attr">message</span>: <span class="hljs-string">'ä¸Šä¼ å¤±è´¥'</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>,
    });
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error, uploadFile, uploadFiles);
  };

  <span class="hljs-comment">/**
   * è¶…å‡ºé™åˆ¶å›è°ƒ
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">files</span> - è¶…å‡ºé™åˆ¶çš„æ–‡ä»¶åˆ—è¡¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">uploadFiles</span> - å·²ä¸Šä¼ çš„æ–‡ä»¶åˆ—è¡¨
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleExceed</span> = (<span class="hljs-params">files, uploadFiles</span>) =&gt; {
    <span class="hljs-title class_">ElMessage</span>({
      <span class="hljs-attr">message</span>: <span class="hljs-string">`æœ€å¤šåªèƒ½ä¸Šä¼  <span class="hljs-subst">${props.limit}</span> ä¸ªè§†é¢‘`</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
    });
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'exceed'</span>, files, uploadFiles);
  };

  <span class="hljs-comment">/**
   * ç§»é™¤è§†é¢‘
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">file</span> - è¦ç§»é™¤çš„æ–‡ä»¶å¯¹è±¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">index</span> - æ–‡ä»¶ç´¢å¼•
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleRemove</span> = (<span class="hljs-params">file, index</span>) =&gt; {
    fileList.<span class="hljs-property">value</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
    proUploadVideoRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">handleRemove</span>(file);
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'deleteAnnex'</span>, index);
  };

  <span class="hljs-comment">/**
   * æ’­æ”¾è§†é¢‘
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è§†é¢‘åœ°å€
   */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">playVideo</span> = (<span class="hljs-params">url</span>) =&gt; {
    <span class="hljs-keyword">if</span> (!url) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// åˆ›å»ºè§†é¢‘æ’­æ”¾å¼¹çª—</span>
    <span class="hljs-keyword">const</span> videoDialog = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    videoDialog.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    `</span>;

    <span class="hljs-comment">// åˆ›å»ºè§†é¢‘å…ƒç´ </span>
    <span class="hljs-keyword">const</span> videoWrapper = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    videoWrapper.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
      position: relative;
      max-width: 90%;
      max-height: 90%;
    `</span>;

    <span class="hljs-comment">// åˆ›å»ºåŠ è½½æç¤º</span>
    <span class="hljs-keyword">const</span> loadingIndicator = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    loadingIndicator.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'è§†é¢‘åŠ è½½ä¸­...'</span>;
    loadingIndicator.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 16px;
      z-index: 1;
    `</span>;
    videoWrapper.<span class="hljs-title function_">appendChild</span>(loadingIndicator);

    <span class="hljs-keyword">const</span> videoElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'video'</span>);
    videoElement.<span class="hljs-property">controls</span> = <span class="hljs-literal">true</span>;
    videoElement.<span class="hljs-property">autoplay</span> = <span class="hljs-literal">true</span>;
    videoElement.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
      max-width: 100%;
      max-height: 80vh;
      outline: none;
      background: black;
      display: none; /* åˆå§‹éšè—ï¼Œç­‰å¾…åŠ è½½å®Œæˆåå†æ˜¾ç¤º */
    `</span>;

    <span class="hljs-comment">// å°è¯•å¤šç§è§†é¢‘æ ¼å¼</span>
    <span class="hljs-keyword">const</span> fileExtension = url.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">toLowerCase</span>();
    <span class="hljs-keyword">const</span> sourceElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'source'</span>);
    sourceElement.<span class="hljs-property">src</span> = url;

    <span class="hljs-comment">// æ ¹æ®æ–‡ä»¶æ‰©å±•åè®¾ç½®æ­£ç¡®çš„ MIME ç±»å‹</span>
    <span class="hljs-keyword">const</span> mimeTypes = {
      <span class="hljs-string">'mp4'</span>: <span class="hljs-string">'video/mp4'</span>,
      <span class="hljs-string">'webm'</span>: <span class="hljs-string">'video/webm'</span>,
      <span class="hljs-string">'ogg'</span>: <span class="hljs-string">'video/ogg'</span>,
      <span class="hljs-string">'avi'</span>: <span class="hljs-string">'video/avi'</span>,
      <span class="hljs-string">'mov'</span>: <span class="hljs-string">'video/quicktime'</span>,
      <span class="hljs-string">'wmv'</span>: <span class="hljs-string">'video/x-ms-wmv'</span>,
      <span class="hljs-string">'flv'</span>: <span class="hljs-string">'video/x-flv'</span>
    };

    sourceElement.<span class="hljs-property">type</span> = mimeTypes[fileExtension] || <span class="hljs-string">'video/mp4'</span>;
    videoElement.<span class="hljs-title function_">appendChild</span>(sourceElement);

    <span class="hljs-comment">// è§†é¢‘åŠ è½½æˆåŠŸçš„å¤„ç†</span>
    videoElement.<span class="hljs-property">onloadeddata</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// éšè—åŠ è½½æŒ‡ç¤ºå™¨å¹¶æ˜¾ç¤ºè§†é¢‘</span>
      <span class="hljs-keyword">if</span> (videoWrapper.<span class="hljs-title function_">contains</span>(loadingIndicator)) {
        videoWrapper.<span class="hljs-title function_">removeChild</span>(loadingIndicator);
      }
      videoElement.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'block'</span>;
    };

    <span class="hljs-comment">// è§†é¢‘åŠ è½½å¤±è´¥çš„å¤„ç†</span>
    videoElement.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// éšè—åŠ è½½æŒ‡ç¤ºå™¨</span>
      <span class="hljs-keyword">if</span> (videoWrapper.<span class="hljs-title function_">contains</span>(loadingIndicator)) {
        videoWrapper.<span class="hljs-title function_">removeChild</span>(loadingIndicator);
      }

      <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span>
      <span class="hljs-keyword">const</span> errorIndicator = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
      errorIndicator.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'</span>;
      errorIndicator.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #ff6b6b;
        font-size: 16px;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px 20px;
        border-radius: 4px;
        z-index: 1;
      `</span>;
      videoWrapper.<span class="hljs-title function_">appendChild</span>(errorIndicator);

      <span class="hljs-comment">// 3ç§’åè‡ªåŠ¨å…³é—­</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">contains</span>(videoDialog)) {
          <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(videoDialog);
        }
      }, <span class="hljs-number">3000</span>);
    };

    <span class="hljs-comment">// åˆ›å»ºå…³é—­æŒ‰é’®</span>
    <span class="hljs-keyword">const</span> closeButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>);
    closeButton.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'&amp;times;'</span>;
    closeButton.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
      position: absolute;
      top: -40px;
      right: 0;
      background: transparent;
      border: none;
      color: white;
      font-size: 36px;
      cursor: pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    `</span>;

    closeButton.<span class="hljs-property">onmouseover</span> = <span class="hljs-function">() =&gt;</span> {
      closeButton.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'scale(1.1)'</span>;
    };

    closeButton.<span class="hljs-property">onmouseout</span> = <span class="hljs-function">() =&gt;</span> {
      closeButton.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'scale(1)'</span>;
    };

    closeButton.<span class="hljs-property">onclick</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æš‚åœè§†é¢‘å¹¶ç§»é™¤å¼¹çª—</span>
      videoElement.<span class="hljs-title function_">pause</span>();
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">contains</span>(videoDialog)) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(videoDialog);
      }
    };

    videoWrapper.<span class="hljs-title function_">appendChild</span>(videoElement);
    videoWrapper.<span class="hljs-title function_">appendChild</span>(closeButton);
    videoDialog.<span class="hljs-title function_">appendChild</span>(videoWrapper);
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(videoDialog);

    <span class="hljs-comment">// ç‚¹å‡»èƒŒæ™¯å…³é—­</span>
    videoDialog.<span class="hljs-property">onclick</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span> === videoDialog) {
        videoElement.<span class="hljs-title function_">pause</span>();
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">contains</span>(videoDialog)) {
          <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(videoDialog);
        }
      }
    };

    <span class="hljs-comment">// ESCé”®å…³é—­</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEscKey</span> = (<span class="hljs-params">e</span>) =&gt; {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Escape'</span>) {
        videoElement.<span class="hljs-title function_">pause</span>();
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">contains</span>(videoDialog)) {
          <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(videoDialog);
        }
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'keydown'</span>, handleEscKey);
      }
    };

    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, handleEscKey);
  };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.pro-upload-video-box</span> {
  <span class="hljs-selector-class">.pro-upload-video-content</span> {
    <span class="hljs-attribute">display</span>: flex;
    // <span class="hljs-attribute">flex-wrap</span>: wrap;
    // å·²ä¸Šä¼ è§†é¢‘å¡ç‰‡æ ·å¼
    <span class="hljs-selector-class">.upload-video-card</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">max-width</span>: <span class="hljs-number">300px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">12px</span> <span class="hljs-number">12px</span> <span class="hljs-number">0</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ebeef5</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
      <span class="hljs-attribute">box-sizing</span>: border-box;

      // è§†é¢‘ç¼©ç•¥å›¾æ ·å¼
      <span class="hljs-selector-class">.video-thumbnail</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ecf5ff</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
        <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;

        &amp;<span class="hljs-selector-pseudo">:hover</span> {
          <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#409eff</span>;
          <span class="hljs-selector-class">.video-icon</span> {
            <span class="hljs-attribute">color</span>: white;
          }
        }

        <span class="hljs-selector-class">.video-icon</span> {
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#409eff</span>;
        }
      }

      // è§†é¢‘ä¿¡æ¯æ ·å¼
      <span class="hljs-selector-class">.video-info</span> {
        <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
        <span class="hljs-attribute">min-width</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">cursor</span>: pointer;

        <span class="hljs-selector-class">.video-name</span> {
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#606266</span>;
          <span class="hljs-attribute">white-space</span>: nowrap;
          <span class="hljs-attribute">overflow</span>: hidden;
          <span class="hljs-attribute">text-overflow</span>: ellipsis;
          <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;
        }

        <span class="hljs-selector-class">.video-size</span> {
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#909399</span>;
        }
      }

      // åˆ é™¤æŒ‰é’®æ ·å¼
      <span class="hljs-selector-class">.video-close</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">right</span>: -<span class="hljs-number">8px</span>;
        <span class="hljs-attribute">top</span>: -<span class="hljs-number">8px</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;
      }
    }

    // ç¦ç”¨çŠ¶æ€æ ·å¼
    <span class="hljs-selector-class">.is-disabled</span> {
      :<span class="hljs-built_in">deep</span>(.el-upload--text) {
        <span class="hljs-attribute">cursor</span>: not-allowed;
      }
    }
    // ä¸Šä¼ æŒ‰é’®æ ·å¼
    <span class="hljs-selector-class">.pro-upload-video</span> {
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-selector-class">.upload-card</span> {
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">flex-direction</span>: column;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> dashed <span class="hljs-number">#d9d9d9</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
        <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">transition</span>: border-color <span class="hljs-number">0.3s</span>;

        &amp;<span class="hljs-selector-pseudo">:hover</span> {
          <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#409eff</span>;
        }

        <span class="hljs-selector-class">.upload-icon</span> {
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#8c939d</span>;
          <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;
        }

        <span class="hljs-selector-class">.upload-text</span> {
          <span class="hljs-attribute">line-height</span>: <span class="hljs-number">24px</span>;
          <span class="hljs-attribute">color</span>: <span class="hljs-number">#8c939d</span>;
          <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
          <span class="hljs-attribute">text-align</span>: center;
        }
      }
    }

    // ä¸Šä¼ ç»„ä»¶æ ·å¼è¦†ç›–
    :<span class="hljs-built_in">deep</span>(.el-upload) {
      <span class="hljs-attribute">width</span>: auto;
      <span class="hljs-attribute">height</span>: auto;
    }
  }
  // æç¤ºæ–‡å­—æ ·å¼
  <span class="hljs-selector-class">.upload-tip</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#909399</span>;
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»æ—¥å¸¸ä½¿ç”¨åˆ°ä»£ç å®ç°ï¼šB ç«™ç­¾åç¼–è¾‘çš„ OOP å°è£…æ€è·¯ä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7579410911057723418</link>    <guid>https://juejin.cn/post/7579410911057723418</guid>    <pubDate>2025-12-03T09:20:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579410911057723418" data-draft-id="7579256547789209641" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»æ—¥å¸¸ä½¿ç”¨åˆ°ä»£ç å®ç°ï¼šB ç«™ç­¾åç¼–è¾‘çš„ OOP å°è£…æ€è·¯ä¸å®è·µ"/> <meta itemprop="keywords" content="ECMAScript 6,ä»£ç è§„èŒƒ,JavaScript"/> <meta itemprop="datePublished" content="2025-12-03T09:20:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ‰æ„ä¹‰"/> <meta itemprop="url" content="https://juejin.cn/user/1739866211617625"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»æ—¥å¸¸ä½¿ç”¨åˆ°ä»£ç å®ç°ï¼šB ç«™ç­¾åç¼–è¾‘çš„ OOP å°è£…æ€è·¯ä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1739866211617625/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ‰æ„ä¹‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:20:48.000Z" title="Wed Dec 03 2025 09:20:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-savanna-light">.hljs-comment,.hljs-quote{color:#5f6d64}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#b16139}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#9f713c}.hljs-bullet,.hljs-string,.hljs-symbol{color:#489963}.hljs-section,.hljs-title{color:#478c90}.hljs-keyword,.hljs-selector-tag{color:#55859b}.hljs-addition,.hljs-deletion{color:#171c19;display:inline-block;width:100%}.hljs-deletion{background-color:#b16139}.hljs-addition{background-color:#489963}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#ecf4ee;color:#526057}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æµè§ˆ B ç«™ï¼ˆå“”å“©å“”å“©ï¼‰æ—¶ï¼Œä½ æˆ–è®¸ç•™æ„åˆ°ï¼šç‚¹å‡»ä¸ªäººä¸»é¡µçš„â€œä¸ªæ€§ç­¾åâ€ï¼Œæ— éœ€è·³è½¬é¡µé¢æˆ–å¼¹å‡ºå¤æ‚è¡¨å•ï¼Œå°±èƒ½ç›´æ¥åœ¨åŸä½ç½®ç¼–è¾‘ã€‚è¿™ç§â€œå°±åœ°ç¼–è¾‘â€ï¼ˆEdit-in-Placeï¼‰çš„äº¤äº’æ–¹å¼ï¼Œç®€æ´ã€ç›´è§‚åˆé«˜æ•ˆï¼Œæå¤§ä¼˜åŒ–äº†ç”¨æˆ·ä½“éªŒ âœ¨ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°†åŸºäº OOP é£æ ¼çš„ JavaScript ä»£ç ï¼Œä»é›¶å®ç°ä¸€ä¸ªç±»ä¼¼çš„å°±åœ°ç¼–è¾‘ç»„ä»¶ã€‚è¿‡ç¨‹ä¸­ä¼šåˆ†äº«å°è£…æ€è·¯ä¸å®è·µç»†èŠ‚ï¼Œå‰–ææ ¸å¿ƒé€»è¾‘ï¼Œå¹¶æ¢ç´¢å¦‚ä½•å°†å…¶æ¨¡å—åŒ–ã€é€šç”¨åŒ–ï¼Œæœ€ç»ˆæ„å»ºä¸€ä¸ªè½»é‡ã€æ¸…æ™°ä¸”å¯å¤ç”¨çš„å‰ç«¯å°å·¥å…· ğŸ› ï¸ã€‚
ğŸ¯ <strong>åŠŸèƒ½ç›®æ ‡</strong><br/>
æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<ul>
<li>é¡µé¢å±•ç¤ºä¸€æ®µæ–‡æœ¬ï¼ˆä¾‹å¦‚ï¼šâ€œè¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹â€ï¼‰ï¼›</li>
<li>ç‚¹å‡»æ–‡æœ¬åï¼ŒåŸåœ°åˆ‡æ¢ä¸ºå¸¦ã€Œä¿å­˜ã€å’Œã€Œå–æ¶ˆã€æŒ‰é’®çš„å¯ç¼–è¾‘è¾“å…¥æ¡† âœï¸ï¼›</li>
<li>ç‚¹å‡»ã€Œä¿å­˜ã€åº”ç”¨æ–°å†…å®¹ âœ”ï¸ï¼Œç‚¹å‡»ã€Œå–æ¶ˆã€è¿˜åŸåŸå§‹å€¼ â†©ï¸ï¼›</li>
<li>å…¨ç¨‹æ— é¡µé¢åˆ·æ–°ï¼Œäº¤äº’æµç•…è‡ªç„¶ã€‚</li>
</ul>
<p>è¿™æ­£æ˜¯ B ç«™ä¸ªæ€§ç­¾åå°±åœ°ç¼–è¾‘åŠŸèƒ½çš„æ ¸å¿ƒé€»è¾‘ç®€åŒ–ç‰ˆ ğŸ’¡ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. å°è£…èµ·ç‚¹ï¼šç”¨æ„é€ å‡½æ•°å®šä¹‰ç»„ä»¶</h2>
<p>ğŸ’¡ é¢å‘å¯¹è±¡å°è£…ï¼šEditInPlace ç±»</p>
<p>ä¸ºäº†è®©é€»è¾‘æ›´æ¸…æ™°ã€ç»„ä»¶æ›´æ˜“å¤ç”¨ï¼Œæˆ‘é€‰æ‹©ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼ï¼Œå°†å°±åœ°ç¼–è¾‘åŠŸèƒ½æŠ½è±¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ <code>EditInPlace</code> ç±»ã€‚è®¾è®¡æ—¶éµå¾ªä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>èŒè´£é›†ä¸­</strong>ï¼šæ–‡æœ¬æ˜¾ç¤ºã€è¾“å…¥åˆ‡æ¢ã€äº‹ä»¶å¤„ç†ç­‰å…¨éƒ¨ç”±ç±»è‡ªèº«ç®¡ç†ï¼›</li>
<li><strong>æ¥å£ç®€æ´</strong>ï¼šå¤–éƒ¨ä»…éœ€æä¾›å®¹å™¨å…ƒç´ ã€åˆå§‹å†…å®¹å’Œå”¯ä¸€æ ‡è¯†ï¼Œå³å¯å®Œæˆåˆå§‹åŒ–ï¼›</li>
<li><strong>ä¾¿äºé›†æˆ</strong>ï¼šé‡‡ç”¨å•ç±»å•æ–‡ä»¶ç»“æ„ï¼Œå¼€ç®±å³ç”¨ï¼Œè½»æ¾èå…¥ç°ä»£å‰ç«¯é¡¹ç›®ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">EditInPlace</span>(<span class="hljs-params">id, value, parentElement</span>) {
  <span class="hljs-comment">// {} ç©ºå¯¹è±¡ thisæŒ‡å‘å®ƒ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span> = parentElement;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-literal">null</span>;   <span class="hljs-comment">// é¢„å£°æ˜ç»„ä»¶è‡ªèº«çš„æ ¹å®¹å™¨å…ƒç´ ï¼ˆé€šå¸¸æ˜¯ &lt;div&gt;ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-literal">null</span>;         <span class="hljs-comment">// ä¿å­˜å¤–éƒ¨ä¼ å…¥çš„æŒ‚è½½å®¹å™¨ï¼ˆå³è¯¥ç»„ä»¶å°†è¢«æ’å…¥åˆ°å“ªä¸ª DOM å…ƒç´ å†…ï¼‰ã€‚</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// å–æ¶ˆ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// ç”¨äºç¼–è¾‘æ–‡æœ¬å†…å®¹ï¼ˆå³ç¼–è¾‘çŠ¶æ€ä¸‹çš„è¾“å…¥æ¡†ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-literal">null</span>;      <span class="hljs-comment">// ç”¨äºå±•ç¤ºé™æ€æ–‡æœ¬ï¼ˆå³éç¼–è¾‘çŠ¶æ€ä¸‹çš„å†…å®¹ï¼‰</span>
  <span class="hljs-comment">//  å¦‚æœä¸ä¿å­˜è¿™äº›å¼•ç”¨ï¼Œæ¯æ¬¡æ“ä½œéƒ½è¦é€šè¿‡ querySelector æŸ¥æ‰¾ï¼Œæ•ˆç‡ä½ä¸”ä»£ç å†—ä½™ã€‚</span>
  <span class="hljs-comment">// ä»£ç æ¯”è¾ƒå¤šï¼ŒæŒ‰åŠŸèƒ½åˆ†æ¨¡å— æ‹†å‡½æ•°</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>();           <span class="hljs-comment">// DOM å¯¹è±¡åˆ›å»º</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEvent</span>();             <span class="hljs-comment">// äº‹ä»¶æ·»åŠ </span>
}
</code></pre>
<p>åœ¨æœ¬å®ç°ä¸­ï¼Œæˆ‘é‡‡ç”¨äº† JavaScript ç»å…¸çš„ <strong>â€œæ„é€ å‡½æ•° + åŸå‹æ–¹æ³•â€</strong> æ¨¡å¼ã€‚è™½ç„¶å¦‚ä»Š ES6 çš„ <code>class</code> è¯­æ³•å·²æˆä¸ºä¸»æµï¼Œä½†åœ¨éœ€è¦å…¼å®¹è€æ—§æµè§ˆå™¨ï¼ˆå¦‚ IEï¼‰æˆ–ç”¨äºæ•™å­¦æ¼”ç¤ºæ—¶ï¼Œè¿™ç§ä¼ ç»Ÿå†™æ³•åè€Œæ›´èƒ½æ­ç¤º JavaScript é¢å‘å¯¹è±¡çš„æœ¬è´¨ï¼Œä¸”è¶³å¤Ÿæ¸…æ™°å¯é ã€‚</p>
<p>è®¾è®¡ä¸Šæœ‰ä¸¤ä¸ªå…³é”®ç»†èŠ‚å€¼å¾—è¯´æ˜ï¼š</p>
<ol>
<li><strong>DOM å¼•ç”¨æå‰å£°æ˜ä¸º <code>null</code></strong><br/>
åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæ‰€æœ‰å°†è¦ä½¿ç”¨çš„ DOM å…ƒç´ ï¼ˆå¦‚è¾“å…¥æ¡†ã€æŒ‰é’®ã€å®¹å™¨ç­‰ï¼‰éƒ½é¢„å…ˆåˆå§‹åŒ–ä¸º <code>null</code>ã€‚è¿™ä¸ä»…è®©ç»„ä»¶çš„å†…éƒ¨ç»“æ„ä¸€ç›®äº†ç„¶ï¼Œä¹Ÿæ–¹ä¾¿åœ¨è°ƒè¯•æ—¶å¿«é€Ÿåˆ¤æ–­å…ƒç´ æ˜¯å¦å·²åˆ›å»ºï¼ŒåŒæ—¶ä¸ºåç»­å¯èƒ½çš„é”€æ¯ä¸å†…å­˜æ¸…ç†æä¾›ä¾¿åˆ©ã€‚</li>
<li><strong>æ„é€ å‡½æ•°åªåšåˆå§‹åŒ–ï¼Œä¸ç¢° DOM</strong><br/>
çœŸæ­£çš„ DOM åˆ›å»ºå’Œäº‹ä»¶ç»‘å®šè¢«æ‹†åˆ†åˆ°ç‹¬ç«‹çš„æ–¹æ³•ï¼ˆå¦‚ <code>createElement</code> å’Œ <code>attachEvent</code>ï¼‰ä¸­ã€‚æ„é€ å‡½æ•°ä»…è´Ÿè´£æ¥æ”¶å‚æ•°ã€è®¾ç½®åˆå§‹çŠ¶æ€å¹¶è°ƒåº¦è¿™äº›æ–¹æ³•ã€‚è¿™ç§åšæ³•éµå¾ªäº†<strong>å•ä¸€èŒè´£åŸåˆ™</strong>â€”â€”åˆå§‹åŒ–å½’åˆå§‹åŒ–ï¼Œæ¸²æŸ“å½’æ¸²æŸ“ï¼Œé€»è¾‘è§£è€¦ï¼Œä»£ç æ›´æ˜“è¯»ã€å¯æµ‹ã€å¯ç»´æŠ¤ã€‚</li>
</ol>
<p>æ­£æ˜¯è¿™äº›çœ‹ä¼¼å¾®å°çš„è®¾è®¡é€‰æ‹©ï¼Œè®©ä¸€ä¸ªç®€å•çš„â€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶æ—¢è½»é‡ï¼Œåˆå…·å¤‡è‰¯å¥½çš„å·¥ç¨‹ç»“æ„ã€‚</p>
<h2 data-id="heading-1">2. æ„å»ºéª¨æ¶ï¼šä¸€æ¬¡æŒ‚è½½ï¼Œé«˜æ•ˆæ¸²æŸ“</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å°è£…äº†DOMæ“ä½œ</span>
  <span class="hljs-attr">createElement</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// DOM å†…å­˜ </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">id</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>;

    <span class="hljs-comment">// å€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>);

    <span class="hljs-comment">// è¾“å…¥æ¡†</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'text'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'ä¿å­˜'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'å–æ¶ˆ'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>(); <span class="hljs-comment">// åˆ‡æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
  }
</code></pre>
<h3 data-id="heading-2">è®¾è®¡äº®ç‚¹ï¼šä¼˜åŒ–ç”¨æˆ·ä½“éªŒä¸å…¼å®¹æ€§çš„ç»†è‡´è€ƒé‡</h3>
<p>åœ¨è®¾è®¡è¿™ä¸ªâ€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬ç‰¹åˆ«æ³¨é‡äº†æ€§èƒ½ä¼˜åŒ–ä»¥åŠåˆå§‹çŠ¶æ€çš„æ­£ç¡®å±•ç¤ºï¼Œå¹¶ä¸”ç¡®ä¿äº†è‰¯å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®çš„è®¾è®¡äº®ç‚¹ï¼š</p>
<h4 data-id="heading-3">1.Â <strong>å†…å­˜ä¸­é¢„åˆ›å»ºå…ƒç´ </strong></h4>
<p>æ‰€æœ‰æ¶‰åŠçš„ç•Œé¢å…ƒç´ ï¼ˆå¦‚å®¹å™¨ <code>&lt;div&gt;</code>ã€é™æ€æ–‡æœ¬ <code>&lt;span&gt;</code>ã€è¾“å…¥æ¡† <code>&lt;input&gt;</code> ä»¥åŠæŒ‰é’®ï¼‰éƒ½åœ¨JavaScriptè¿è¡Œç¯å¢ƒä¸­é¢„å…ˆæ„å»ºå®Œæˆï¼Œä»…åœ¨æ‰€æœ‰å…ƒç´ å‡†å¤‡å°±ç»ªåï¼Œä¸€æ¬¡æ€§æŒ‚è½½åˆ°DOMæ ‘ä¸Šã€‚è¿™ç§æ–¹æ³•æœ‰æ•ˆå‡å°‘äº†ç”±äºé¢‘ç¹ä¿®æ”¹DOMç»“æ„è€Œå¯¼è‡´çš„é‡æ’å’Œé‡ç»˜ç°è±¡ï¼Œä»è€Œæå‡äº†é¡µé¢åŠ è½½é€Ÿåº¦å’Œå“åº”æ€§èƒ½ã€‚</p>
<h4 data-id="heading-4">2.Â <strong>ç«‹å³è°ƒç”¨Â <code>convertToText()</code>Â ç¡®ä¿åˆå§‹çŠ¶æ€</strong></h4>
<p>åœ¨ç»„ä»¶åˆå§‹åŒ–å®Œæˆåï¼Œæˆ‘ä»¬ä¼šç«‹åˆ»è°ƒç”¨ <code>convertToText()</code> æ–¹æ³•æ¥è®¾ç½®å…¶ä¸ºåªè¯»æ–‡æœ¬æ¨¡å¼ã€‚è¿™ä¸€æ“ä½œä¿è¯äº†ç”¨æˆ·é¦–æ¬¡çœ‹åˆ°çš„ç»„ä»¶å¤„äºæ­£ç¡®çš„åˆå§‹çŠ¶æ€ï¼Œå³ä»¥é™æ€æ–‡æœ¬çš„å½¢å¼å±•ç°ï¼Œè€Œä¸æ˜¯æ„å¤–åœ°æ˜¾ç¤ºä¸ºå¯ç¼–è¾‘çŠ¶æ€æˆ–è€…å‡ºç°ä»»ä½•è§†è§‰ä¸Šçš„ä¸ä¸€è‡´ã€‚</p>
<h4 data-id="heading-5">3.Â <strong>é€‰æ‹©Â <code>&lt;input type="button"&gt;</code>Â è¶…è¶ŠÂ <code>&lt;button&gt;</code></strong></h4>
<p>å°½ç®¡ä½¿ç”¨ <code>&lt;input type="button"&gt;</code> è¿™ç§æ–¹å¼çœ‹èµ·æ¥å¯èƒ½ä¸å¦‚ç°ä»£çš„ <code>&lt;button&gt;</code> å…ƒç´ é‚£ä¹ˆç›´è§‚æˆ–æµè¡Œï¼Œä½†å®ƒçš„å­˜åœ¨æä¾›äº†ä¸€ç§æä½³çš„æµè§ˆå™¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆã€‚è€ƒè™‘åˆ°ç½‘ç»œç¯å¢ƒçš„å¤šæ ·æ€§ï¼Œä¸åŒçš„ç”¨æˆ·å¯èƒ½ä¼šä½¿ç”¨å„ç§ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ä¸€äº›è¾ƒè€çš„ç‰ˆæœ¬ã€‚é€šè¿‡é‡‡ç”¨è¿™ç§æ›´ä¸ºä¼ ç»Ÿçš„è¡¨å•å…ƒç´ ï¼Œå¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„â€œå°±åœ°ç¼–è¾‘â€åŠŸèƒ½åœ¨å°½å¯èƒ½å¤šçš„ç¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œä¸ºç”¨æˆ·æä¾›æ— ç¼çš„ä½“éªŒã€‚</p>
<p>è¿™äº›è®¾è®¡å†³ç­–åæ˜ äº†æˆ‘ä»¬åœ¨è¿½æ±‚é«˜æ•ˆèƒ½ã€è‰¯å¥½ç”¨æˆ·ä½“éªŒçš„åŒæ—¶ï¼Œä¹Ÿä¸å¿½è§†å¯¹å¹¿æ³›è®¾å¤‡å’Œæµè§ˆå™¨çš„æ”¯æŒã€‚æ¯ä¸€ä¸ªç»†èŠ‚éƒ½ç»è¿‡æ·±æ€ç†Ÿè™‘ï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›æ—¢å¿«é€Ÿåˆå¯é çš„äº¤äº’ä½“éªŒã€‚</p>
<h2 data-id="heading-6">3. è§†å›¾åˆ‡æ¢ï¼šå¤ç”¨ DOM è€Œéåå¤åˆ›å»º</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">convertToText</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
  },
  <span class="hljs-attr">convertToField</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>; 
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
  }
</code></pre>
<h3 data-id="heading-7">ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿâ€”â€”çŠ¶æ€åˆ‡æ¢ä¼˜äºåå¤åˆ›å»º</h3>
<p>åœ¨å®ç°â€œå°±åœ°ç¼–è¾‘â€åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬<strong>æ²¡æœ‰é‡‡ç”¨â€œé”€æ¯å†é‡å»º DOMâ€çš„æ–¹å¼</strong>ï¼Œè€Œæ˜¯é€‰æ‹©<strong>å¤ç”¨å·²æœ‰çš„å…ƒç´ ï¼Œä»…é€šè¿‡åˆ‡æ¢æ˜¾ç¤º/éšè—çŠ¶æ€æ¥åˆ‡æ¢è§†å›¾</strong>ã€‚è¿™ç§è®¾è®¡å¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>é¿å…ä¸å¿…è¦çš„ DOM æ“ä½œ</strong>ï¼šé¢‘ç¹åˆ›å»ºå’Œç§»é™¤å…ƒç´ ä¼šè§¦å‘æµè§ˆå™¨çš„é‡æ’ï¼ˆreflowï¼‰ä¸é‡ç»˜ï¼ˆrepaintï¼‰ï¼Œå½±å“æ¸²æŸ“æ€§èƒ½ï¼›</li>
<li><strong>æå‡äº¤äº’å“åº”é€Ÿåº¦</strong>ï¼šç”¨æˆ·ç‚¹å‡»å³åˆ‡æ¢ï¼Œæ— éœ€ç­‰å¾…æ–°å…ƒç´ ç”Ÿæˆï¼Œä½“éªŒæ›´æµç•…ï¼›</li>
<li><strong>é™ä½å†…å­˜å¼€é”€</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹åªåˆ›å»ºä¸€æ¬¡ï¼Œåç»­ä»…ä¿®æ”¹æ ·å¼å±æ€§ï¼Œèµ„æºæ¶ˆè€—æ›´å°ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼šæ¯æ¬¡è¿›å…¥ç¼–è¾‘éƒ½åŒæ­¥æœ€æ–°å€¼</h3>
<p>ç»†å¿ƒçš„åŒå­¦å¯èƒ½æ³¨æ„åˆ°ï¼Œåœ¨ <code>convertToField</code> æ–¹æ³•ä¸­ï¼Œæœ‰è¿™æ ·ä¸€è¡Œå…³é”®ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
</code></pre>
<p>è¿™å¹¶éå¤šä½™æ“ä½œï¼Œè€Œæ˜¯ä¸€é“<strong>é˜²æ­¢è„æ•°æ®çš„é‡è¦é˜²çº¿</strong>ã€‚</p>
<p>è®¾æƒ³è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šç”¨æˆ·ç‚¹å‡»è¿›å…¥ç¼–è¾‘ â†’ ä¿®æ”¹äº†å†…å®¹ä½†æœªä¿å­˜ â†’ åˆç‚¹å‡»å…¶ä»–åœ°æ–¹é€€å‡º â†’ å†æ¬¡ç‚¹å‡»è¿›å…¥ç¼–è¾‘ã€‚<br/>
å¦‚æœæ²¡æœ‰è¿™è¡Œèµ‹å€¼ï¼Œè¾“å…¥æ¡†ä¼šä¿ç•™ä¸Šæ¬¡æœªä¿å­˜çš„â€œæ®‹ç•™å†…å®¹â€ï¼Œé€ æˆ<strong>UI ä¸å®é™…æ•°æ®ä¸ä¸€è‡´</strong>çš„é”™è§‰ã€‚</p>
<p>é€šè¿‡æ¯æ¬¡è¿›å…¥ç¼–è¾‘æ¨¡å¼æ—¶<strong>å¼ºåˆ¶å°†è¾“å…¥æ¡†çš„å€¼é‡ç½®ä¸ºå½“å‰ <code>this.value</code>ï¼ˆå³æœ€æ–°ç¡®è®¤å€¼ï¼‰</strong> ï¼Œæˆ‘ä»¬ç¡®ä¿äº†ï¼š</p>
<ul>
<li>ç”¨æˆ·çœ‹åˆ°çš„å§‹ç»ˆæ˜¯â€œå·²ä¿å­˜â€çš„æœ€æ–°å†…å®¹ï¼›</li>
<li>æœªæäº¤çš„è‰ç¨¿ä¸ä¼šè¢«é”™è¯¯ä¿ç•™ï¼›</li>
<li>ç»„ä»¶è¡Œä¸ºç¬¦åˆç›´è§‰ï¼Œå‡å°‘è®¤çŸ¥è´Ÿæ‹…ã€‚</li>
</ul>
<h2 data-id="heading-9">4. å“åº”ç”¨æˆ·æ“ä½œä¹‹äº‹ä»¶ç»‘å®š</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>(); <span class="hljs-comment">// åˆ‡æ¢åˆ°è¾“å…¥æ¡†æ˜¾ç¤ºçŠ¶æ€</span>
      }
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">save</span>();
      }
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>();
      }
    );
</code></pre>
<h3 data-id="heading-10">ç®­å¤´å‡½æ•°çš„å·§å¦™ä¹‹å¤„</h3>
<p>è¿™é‡Œä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä¸ä»…è®©ä»£ç æ›´ç®€æ´ï¼Œè¿˜å·§å¦™åœ°è§£å†³äº† <code>this</code> ä¸Šä¸‹æ–‡çš„é—®é¢˜ï¼š<br/>
ç”±äºç®­å¤´å‡½æ•°<strong>ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ <code>this</code></strong>ï¼Œè€Œæ˜¯<strong>ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„ <code>this</code></strong>ï¼Œå› æ­¤åœ¨äº‹ä»¶å›è°ƒä¸­ï¼Œ<code>this</code> ä¾ç„¶æŒ‡å‘ <code>EditInPlace</code> å®ä¾‹ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ <code>this.save()</code>ã€<code>this.cancel()</code> ç­‰æ–¹æ³•ã€‚</p>
<p>å¦‚æœæ¢æˆæ™®é€šå‡½æ•°ï¼Œ<code>this</code> ä¼šé»˜è®¤æŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ï¼ˆæ¯”å¦‚æŒ‰é’®æˆ– spanï¼‰ï¼Œå¯¼è‡´æ–¹æ³•è°ƒç”¨å¤±è´¥ã€‚æ­¤æ—¶å°±å¿…é¡»æ‰‹åŠ¨ç»‘å®šä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-Js" lang="Js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">save</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
</code></pre>
<p>è€Œå€ŸåŠ©ç®­å¤´å‡½æ•°ï¼Œæˆ‘ä»¬çœå»äº†è¿™äº›å†—ä½™çš„ <code>.bind(this)</code>ï¼Œæ—¢å‡å°‘äº†æ ·æ¿ä»£ç ï¼Œä¹Ÿæå‡äº†å¯è¯»æ€§ã€‚</p>
<h2 data-id="heading-11">5.ä¿å­˜æäº¤ vs æ— ç—•å–æ¶ˆ</h2>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-attr">save</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
     <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span>;
     <span class="hljs-comment">// fetch åç«¯å­˜å‚¨</span>
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = value;
     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();   
    },
    <span class="hljs-attr">cancel</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
    }
</code></pre>
<h3 data-id="heading-12">æ ¸å¿ƒè¡Œä¸ºè§£æ</h3>
<ul>
<li><strong><code>save()</code></strong> ï¼š<br/>
è´Ÿè´£å°†ç”¨æˆ·è¾“å…¥çš„æ–°å†…å®¹æäº¤ã€‚å®ƒä¼šæ›´æ–°ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ <code>this.value</code>ï¼Œå¹¶åŒæ­¥åˆ·æ–°é™æ€æ–‡æœ¬çš„æ˜¾ç¤ºï¼Œå®Œæˆâ€œä¿å­˜â€æ“ä½œã€‚<br/>
æ³¨é‡Šä¸­æåˆ°çš„ <code>fetch</code> æ˜¯ä¸ºåç»­å¯¹æ¥åç«¯é¢„ç•™çš„æ‰©å±•ç‚¹â€”â€”åœ¨çœŸå®çš„ B ç«™åœºæ™¯ä¸­ï¼Œè¿™é‡Œä¼šå‘èµ· AJAX è¯·æ±‚ï¼Œå°†æ–°ç­¾åæŒä¹…åŒ–åˆ°æœåŠ¡å™¨ã€‚</li>
<li><strong><code>cancel()</code></strong> ï¼š<br/>
ä¸ä¿®æ”¹ä»»ä½•æ•°æ®ï¼Œä»…åˆ‡æ¢å›åªè¯»è§†å›¾çŠ¶æ€ï¼Œå®ç°çœŸæ­£çš„â€œæ— ç—•å–æ¶ˆâ€ã€‚ç”¨æˆ·æ”¾å¼ƒç¼–è¾‘åï¼Œç•Œé¢å¹²å‡€åœ°è¿˜åŸä¸ºåŸå§‹å†…å®¹ï¼Œæ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡ç¡®ä¿äº†æ•°æ®æµçš„æ¸…æ™°ä¸å¯æ§ï¼š<strong>åªæœ‰ <code>save</code> ä¼šæ”¹å˜çŠ¶æ€ï¼Œ<code>cancel</code> æ°¸è¿œæ˜¯å®‰å…¨çš„å›é€€æ“ä½œ</strong>ã€‚</p>
<h3 data-id="heading-13">ğŸ“– æ³¨é‡Šä¸æ˜¯é™„å±å“ï¼Œè€Œæ˜¯æ¥å£çš„ä¸€éƒ¨åˆ†</h3>
<p>ä¸€ä¸ªçœŸæ­£å¯å¤ç”¨çš„å‰ç«¯ç»„ä»¶ï¼Œå…‰æœ‰ä»£ç æ˜¯ä¸å¤Ÿçš„â€”â€”å®ƒè¿˜éœ€è¦ä¸€ä»½â€œä½¿ç”¨æŒ‡å—â€ã€‚<br/>
åœ¨ <code>edit_in_place.js</code> çš„å¼€å¤´ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„æ³¨é‡Šï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@func</span> EditInPlace å°±åœ°ç¼–è¾‘ç»„ä»¶
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} value         åˆå§‹æ–‡æœ¬å†…å®¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HTMLElement</span>} parentElement  è¦æ’å…¥åˆ°å“ªä¸ª DOM å®¹å™¨
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} id            ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦
 */</span>
</code></pre>
<p>è¿™çœ‹ä¼¼ç®€å•çš„ JSDoc å¹¶éè£…é¥°ï¼Œè€Œæ˜¯ä¸€ä»½<strong>æ˜ç¡®çš„è°ƒç”¨å¥‘çº¦</strong>ã€‚å®ƒå‘Šè¯‰ä½¿ç”¨è€…ï¼š</p>
<ul>
<li>è¿™ä¸ªæ¨¡å—èƒ½åšä»€ä¹ˆï¼›</li>
<li>éœ€è¦æä¾›ä»€ä¹ˆã€ä»¥ä»€ä¹ˆæ ¼å¼æä¾›ï¼›</li>
<li>ä¸éœ€è¦å…³å¿ƒå†…éƒ¨å¦‚ä½•å®ç°ã€‚</li>
</ul>
<blockquote>
<p>æ¯•ç«Ÿï¼Œ<strong>å†™ç»„ä»¶çš„äººå’Œç”¨ç»„ä»¶çš„äººï¼Œå¾€å¾€ä¸æ˜¯åŒä¸€ä¸ªäºº</strong>ã€‚<br/>
åªè¦æ¥å£ç¨³å®šã€æ–‡æ¡£æ¸…æ™°ï¼Œå“ªæ€•åº•å±‚é€»è¾‘å½»åº•é‡å†™ï¼Œä¸Šå±‚è°ƒç”¨ä¾ç„¶å®‰ç„¶æ— æ™ã€‚</p>
</blockquote>
<p>ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œæ³¨é‡Šä¸æ˜¯â€œå†™ç»™æœªæ¥çš„è‡ªå·±çœ‹çš„ç¬”è®°â€ï¼Œè€Œæ˜¯<strong>å°è£…å®Œæ•´æ€§çš„å¿…è¦ç»„æˆéƒ¨åˆ†</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-14">ğŸ§± ä»è„šæœ¬åˆ°ç»„ä»¶ï¼šå‰ç«¯å·¥ç¨‹åŒ–çš„è‡ªç„¶æ¼”è¿›</h3>
<p>æ—©æœŸçš„äº¤äº’åŠŸèƒ½å¸¸ä»¥â€œè¿‡ç¨‹å¼è„šæœ¬â€å½¢å¼å­˜åœ¨ï¼šå˜é‡æ»¡å¤©é£ï¼Œå‡½æ•°äº’ç›¸ä¾èµ–ï¼Œæ”¹ä¸€å¤„å¯èƒ½å´©å…¨å±€ã€‚<br/>
è€Œç°ä»£å‰ç«¯å¼€å‘æ›´å€¾å‘äºè¿™æ ·çš„è·¯å¾„ï¼š</p>
<blockquote>
<p><strong>æ•£è½é€»è¾‘ â†’ å°è£…æˆç±» â†’ ç‹¬ç«‹æ¨¡å—</strong></p>
</blockquote>
<ul>
<li><strong>å°è£…æˆç±»ï¼ˆOOPï¼‰</strong> Â æŠŠçŠ¶æ€ï¼ˆå¦‚å½“å‰å€¼ï¼‰å’Œè¡Œä¸ºï¼ˆå¦‚åˆ‡æ¢ç¼–è¾‘æ¨¡å¼ï¼‰èšåˆåœ¨ä¸€èµ·ï¼Œé¿å…æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼›</li>
<li><strong>æ‹†åˆ†ä¸ºç‹¬ç«‹æ–‡ä»¶</strong>Â åï¼Œç»„ä»¶å…·å¤‡äº†â€œå³æ’å³ç”¨â€çš„èƒ½åŠ›ï¼Œå¤©ç„¶æ”¯æŒå¤ç”¨ä¸åä½œï¼›</li>
<li><strong>æ¸…æ™°çš„æ„é€ å‚æ•° + å®Œå–„çš„æ³¨é‡Š</strong>ï¼Œåˆ™è®©ä»–äººæ— éœ€é˜…è¯»æºç ä¹Ÿèƒ½æ­£ç¡®é›†æˆã€‚</li>
</ul>
<p>è¿™ä¸ä»…æ˜¯ä»£ç ç»„ç»‡æ–¹å¼çš„å‡çº§ï¼Œæ›´æ˜¯<strong>åä½œæ•ˆç‡å’Œé¡¹ç›®å¯ç»´æŠ¤æ€§</strong>çš„è·ƒè¿ã€‚</p>
<hr/>
<h3 data-id="heading-15">âš¡ å¿«é€Ÿä¸Šæ‰‹ï¼šä¸‰è¡Œæå®šå¯ç¼–è¾‘ç­¾å</h3>
<p>å‡è®¾é¡µé¢ä¸­æœ‰å¦‚ä¸‹å®¹å™¨ï¼š</p>
<pre><code class="hljs language-Html" lang="Html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"profile-signature"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>åªéœ€å¼•å…¥è„šæœ¬å¹¶æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-Js" lang="Js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">EditInPlace</span>(
  <span class="hljs-string">'user-slogan'</span>,
  <span class="hljs-string">'æœ‰äº†è‚¯å¾·åŸºï¼Œç”Ÿæ´»å¥½æ»‹å‘³ï¼'</span>,
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'profile-signature'</span>)
);
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38997d61b1f347ab8165a4245bb8e535~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765358447&amp;x-signature=oNp0sSQIkK%2FtPJZUUpurCtv5R8c%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸€ä¸ªæ”¯æŒç‚¹å‡»ç¼–è¾‘ã€å¸¦ä¿å­˜/å–æ¶ˆæŒ‰é’®çš„äº¤äº’åŒºåŸŸå°±ç«‹åˆ»ç”Ÿæ•ˆã€‚<br/>
æœªæ¥åœ¨å…¶ä»–æ¨¡å—å¤ç”¨ï¼Ÿç›´æ¥å¤åˆ¶åˆå§‹åŒ–è¯­å¥å³å¯â€”â€”<strong>é›¶å­¦ä¹ æˆæœ¬ï¼Œå¼€ç®±å³ç”¨</strong>ã€‚</p>
<p>è€Œè¿™èƒŒåçš„ä¸€åˆ‡ï¼Œéƒ½å§‹äºä¸€ä¸ªè®¾è®¡æ¸…æ™°ã€æ–‡æ¡£å®Œæ•´çš„å°è£…ã€‚</p>
<h2 data-id="heading-16">æºç åœ¨è¿™ï¼š</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef82c4439f504fb2a037f432fc1a9403~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765358447&amp;x-signature=4XQT4EACQQiOh%2BPC8D0cGjyx0Iw%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@func</span> EditInPlace å°±åœ°ç¼–è¾‘
 * <span class="hljs-doctag">@params</span> {<span class="hljs-type">string</span>} value åˆå§‹å€¼
 * <span class="hljs-doctag">@params</span> {<span class="hljs-type">element</span>} parentElement æŒ‚è½½ç‚¹
 * <span class="hljs-doctag">@params</span> {<span class="hljs-type">string</span>} id  è‡ªèº«ID
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">EditInPlace</span>(<span class="hljs-params">id, value, parentElement</span>) {
  <span class="hljs-comment">// {} ç©ºå¯¹è±¡ thisæŒ‡å‘å®ƒ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span> = parentElement;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-literal">null</span>;   <span class="hljs-comment">// é¢„å£°æ˜ç»„ä»¶è‡ªèº«çš„æ ¹å®¹å™¨å…ƒç´ ï¼ˆé€šå¸¸æ˜¯ &lt;div&gt;ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-literal">null</span>;         <span class="hljs-comment">// ä¿å­˜å¤–éƒ¨ä¼ å…¥çš„æŒ‚è½½å®¹å™¨ï¼ˆå³è¯¥ç»„ä»¶å°†è¢«æ’å…¥åˆ°å“ªä¸ª DOM å…ƒç´ å†…ï¼‰ã€‚</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// å–æ¶ˆ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// ç”¨äºç¼–è¾‘æ–‡æœ¬å†…å®¹ï¼ˆå³ç¼–è¾‘çŠ¶æ€ä¸‹çš„è¾“å…¥æ¡†ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-literal">null</span>;      <span class="hljs-comment">// ç”¨äºå±•ç¤ºé™æ€æ–‡æœ¬ï¼ˆå³éç¼–è¾‘çŠ¶æ€ä¸‹çš„å†…å®¹ï¼‰</span>
  <span class="hljs-comment">//  å¦‚æœä¸ä¿å­˜è¿™äº›å¼•ç”¨ï¼Œæ¯æ¬¡æ“ä½œéƒ½è¦é€šè¿‡ querySelector æŸ¥æ‰¾ï¼Œæ•ˆç‡ä½ä¸”ä»£ç å†—ä½™ã€‚</span>
  <span class="hljs-comment">// ä»£ç æ¯”è¾ƒå¤šï¼ŒæŒ‰åŠŸèƒ½åˆ†æ¨¡å— æ‹†å‡½æ•°</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>();           <span class="hljs-comment">// DOM å¯¹è±¡åˆ›å»º</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEvent</span>();             <span class="hljs-comment">// äº‹ä»¶æ·»åŠ </span>
}
<span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-comment">// å°è£…äº†DOMæ“ä½œ</span>
  <span class="hljs-attr">createElement</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// DOM å†…å­˜ </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">id</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>;

    <span class="hljs-comment">// å€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>);

    <span class="hljs-comment">// è¾“å…¥æ¡†</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'text'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'ä¿å­˜'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'å–æ¶ˆ'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>(); <span class="hljs-comment">// åˆ‡æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
  },
  <span class="hljs-attr">convertToText</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
  },
  <span class="hljs-attr">convertToField</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// éšè—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>; 
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// å¯è§</span>
  },
  <span class="hljs-attr">attachEvent</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>(); <span class="hljs-comment">// åˆ‡æ¢åˆ°è¾“å…¥æ¡†æ˜¾ç¤ºçŠ¶æ€</span>
      }
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">save</span>();
      }
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, 
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>();
      }
    );
  },
   <span class="hljs-attr">save</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
     <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span>;
     <span class="hljs-comment">// fetch åç«¯å­˜å‚¨</span>
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = value;
     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();   
    },
    <span class="hljs-attr">cancel</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
    }
}
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./edit_in_place.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-comment">// EditInPlace ç±»</span>
  <span class="hljs-comment">// OOP </span>
  <span class="hljs-keyword">const</span> ep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EditInPlace</span>(
    <span class="hljs-string">'slogan'</span>, 
    <span class="hljs-string">'æœ‰äº†è‚¯å¾·åŸºï¼Œç”Ÿæ´»å¥½æ»‹å‘³'</span>, 
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>)
  );
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ep);
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>è¿™ä¸ªâ€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶è™½ç„¶åªæœ‰å‡ åè¡Œä»£ç ï¼Œå´æ˜¯ä¸€ä¸ªå…¸å‹çš„ OOP å®è·µï¼šæŠŠçŠ¶æ€å’Œè¡Œä¸ºå°è£…åœ¨ <code>EditInPlace</code> æ„é€ å‡½æ•°ä¸­ï¼Œå¯¹å¤–åªæš´éœ²æ¸…æ™°çš„åˆå§‹åŒ–æ¥å£ï¼Œå†…éƒ¨å®ç°å®Œå…¨éšè—ã€‚æ­£å› å¦‚æ­¤ï¼Œå®ƒæ‰èƒ½çœŸæ­£åšåˆ°<strong>ä¸€æ¬¡ç¼–å†™ã€å¤šå¤„å¤ç”¨</strong>â€”â€”æ— è®ºç”¨åœ¨ä¸ªäººä¸»é¡µç­¾åã€è¯„è®ºç¼–è¾‘è¿˜æ˜¯åå°é…ç½®é¡¹ï¼Œåªéœ€ä¸€è¡Œ <code>new EditInPlace(...)</code> å°±èƒ½æ¥å…¥ï¼Œæ— éœ€å…³å¿ƒå†…éƒ¨å¦‚ä½•åˆ‡æ¢è§†å›¾ã€ç»‘å®šäº‹ä»¶æˆ–ç®¡ç†æ•°æ®ã€‚è¿™ç§åŸºäºé¢å‘å¯¹è±¡çš„å°è£…æ€è·¯ï¼Œæ­£æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯å¤ç”¨å‰ç«¯æ¨¡å—çš„åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·˜å® API å…³é”®è¯æœç´¢æ¥å£æ·±åº¦è§£æï¼šè¯·æ±‚å‚æ•°ã€ç­¾åæœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7579453456017768489</link>    <guid>https://juejin.cn/post/7579453456017768489</guid>    <pubDate>2025-12-03T09:30:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579453456017768489" data-draft-id="7579438351297511460" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·˜å® API å…³é”®è¯æœç´¢æ¥å£æ·±åº¦è§£æï¼šè¯·æ±‚å‚æ•°ã€ç­¾åæœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="å‰ç«¯,API,æ•°æ®æŒ–æ˜"/> <meta itemprop="datePublished" content="2025-12-03T09:30:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”µå•†APIå¤§æ•°æ®æ¥å£å¼€å‘Cris"/> <meta itemprop="url" content="https://juejin.cn/user/3836609967955659"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·˜å® API å…³é”®è¯æœç´¢æ¥å£æ·±åº¦è§£æï¼šè¯·æ±‚å‚æ•°ã€ç­¾åæœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3836609967955659/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”µå•†APIå¤§æ•°æ®æ¥å£å¼€å‘Cris
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:30:42.000Z" title="Wed Dec 03 2025 09:30:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>åœ¨ç”µå•†æ•°æ®é‡‡é›†ã€ç¬¬ä¸‰æ–¹å·¥å…·å¼€å‘ç­‰åœºæ™¯ä¸­ï¼Œæ·˜å®çš„å…³é”®è¯æœç´¢æ¥å£æ˜¯æ ¸å¿ƒæ•°æ®å…¥å£ä¹‹ä¸€ã€‚è¯¥æ¥å£æ”¯æŒé€šè¿‡å…³é”®è¯æŸ¥è¯¢å•†å“åˆ—è¡¨ã€ä»·æ ¼ã€é”€é‡ç­‰å…³é”®ä¿¡æ¯ï¼Œä½†å…¶ä¸¥æ ¼çš„è¯·æ±‚è§„èŒƒã€å¤æ‚çš„ç­¾åæœºåˆ¶å’Œæ€§èƒ½é™åˆ¶ï¼Œå¾€å¾€æˆä¸ºå¼€å‘è€…çš„æŠ€æœ¯ç—›ç‚¹ã€‚æœ¬æ–‡å°†ä»è¯·æ±‚å‚æ•°è§£æã€ç­¾åæœºåˆ¶åŸç†ã€å®æˆ˜ä»£ç å®ç°åˆ°æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œè¿›è¡Œå…¨æ–¹ä½æ·±åº¦è§£æï¼Œå¸®åŠ©å¼€å‘è€…é«˜æ•ˆã€åˆè§„åœ°ä½¿ç”¨è¯¥æ¥å£ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ¥å£æ ¸å¿ƒåŸºç¡€è®¤çŸ¥</h2>
<h3 data-id="heading-1">1.1 æ¥å£åŠŸèƒ½ä¸åº”ç”¨åœºæ™¯</h3>
<p>æ·˜å®å…³é”®è¯æœç´¢æ¥å£çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡å…³é”®è¯ã€åˆ†ç±»ã€ä»·æ ¼åŒºé—´ç­‰æ¡ä»¶ï¼Œä»æ·˜å®å•†å“åº“ä¸­ç­›é€‰ç¬¦åˆæ¡ä»¶çš„å•†å“æ•°æ®ï¼Œè¿”å›å•†å“ IDã€æ ‡é¢˜ã€ä»·æ ¼ã€é”€é‡ã€å–å®¶ä¿¡æ¯ç­‰å­—æ®µã€‚</p>
<p>å…¸å‹åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”µå•†æ•°æ®åˆ†æå·¥å…·ï¼šç›‘æ§ç«å“ä»·æ ¼ã€é”€é‡å˜åŒ–ï¼›</li>
<li>ç¬¬ä¸‰æ–¹å¯¼è´­å¹³å°ï¼šåŸºäºå…³é”®è¯æ¨èå•†å“ï¼›</li>
<li>å•†å®¶è¿è¥å·¥å…·ï¼šæ‰¹é‡æŸ¥è¯¢å•†å“æ›å…‰æƒ…å†µï¼›</li>
<li>å¸‚åœºè°ƒç ”ç³»ç»Ÿï¼šé‡‡é›†ç‰¹å®šå“ç±»å•†å“æ•°æ®è¿›è¡Œè¶‹åŠ¿åˆ†æã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 æ¥å£è®¿é—®å‰æ</h3>
<p>ä½¿ç”¨è¯¥æ¥å£éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ol>
<li>æ³¨å†Œæ·˜å®å¼€å‘è€…è´¦å·ï¼›</li>
<li>ç”³è¯·æ¥å£æƒé™ï¼›</li>
<li>è·å–<code>ApiKey</code>Â å’ŒÂ <code>ApiSecret</code>ï¼ˆæ¥å£è°ƒç”¨çš„æ ¸å¿ƒå‡­è¯ï¼‰ï¼›</li>
<li>éµå®ˆæ·˜å®å¹³å°ã€ŠAPI ä½¿ç”¨è§„èŒƒã€‹ï¼Œé¿å…é«˜é¢‘æ¬¡æ¶æ„è°ƒç”¨ã€‚</li>
</ol>
<h2 data-id="heading-3">äºŒã€è¯·æ±‚å‚æ•°æ·±åº¦è§£æ</h2>
<p>æ·˜å® API é‡‡ç”¨ HTTP GET/POST è¯·æ±‚æ–¹å¼ï¼Œå‚æ•°åˆ†ä¸º<strong>å…¬å…±å‚æ•°</strong>å’Œ<strong>ä¸šåŠ¡å‚æ•°</strong>ä¸¤ç±»ï¼Œæ‰€æœ‰å‚æ•°éœ€æŒ‰æŒ‡å®šæ ¼å¼æ‹¼æ¥ï¼Œç¼–ç é‡‡ç”¨ UTF-8ã€‚</p>
<h3 data-id="heading-4">2.1 å…¬å…±å‚æ•°ï¼ˆå¿…å¡«ï¼‰</h3>
<p>å…¬å…±å‚æ•°æ˜¯æ‰€æœ‰ TOP æ¥å£çš„é€šç”¨å‚æ•°ï¼Œç”¨äºèº«ä»½éªŒè¯ã€è¯·æ±‚æ ‡è¯†ç­‰ï¼Œæ ¸å¿ƒå‚æ•°å¦‚ä¸‹ï¼š</p>





















































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>app_key</td><td>String</td><td>åº”ç”¨å”¯ä¸€æ ‡è¯†</td><td>2356789012</td></tr><tr><td>method</td><td>String</td><td>æ¥å£åç§°</td><td>taobao.items.search</td></tr><tr><td>format</td><td>String</td><td>è¿”å›æ ¼å¼ï¼ˆæ”¯æŒ json/xmlï¼‰</td><td>json</td></tr><tr><td>timestamp</td><td>String</td><td>è¯·æ±‚æ—¶é—´æˆ³ï¼ˆæ ¼å¼ï¼šyyyy-MM-dd HH:mm:ssï¼‰</td><td>2025-12-03 14:30:00</td></tr><tr><td>v</td><td>String</td><td>æ¥å£ç‰ˆæœ¬</td><td>2.0</td></tr><tr><td>sign</td><td>String</td><td>ç­¾åï¼ˆæ ¸å¿ƒéªŒè¯å‚æ•°ï¼‰</td><td>88E88D8F7A6B5C4D3E2F1A0987654321</td></tr><tr><td>session</td><td>String</td><td>ä¹°å®¶ / å–å®¶æˆæƒä¼šè¯ï¼ˆéƒ¨åˆ†æ¥å£å¿…å¡«ï¼‰</td><td>61022000000000000000000000000000</td></tr></tbody></table>
<h3 data-id="heading-5">2.2 ä¸šåŠ¡å‚æ•°ï¼ˆå…³é”®è¯æœç´¢æ ¸å¿ƒï¼‰</h3>
<p>ä¸šåŠ¡å‚æ•°ç”¨äºæŒ‡å®šæœç´¢æ¡ä»¶ï¼Œæ ¸å¿ƒå‚æ•°å¦‚ä¸‹ï¼ˆä»¥<code>taobao.items.search</code>ä¸ºä¾‹ï¼‰ï¼š</p>



























































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>çº¦æŸ</th></tr></thead><tbody><tr><td>q</td><td>String</td><td>æœç´¢å…³é”®è¯</td><td>ä¸èƒ½ä¸ºç©ºï¼Œé•¿åº¦â‰¤30 å­—ç¬¦</td></tr><tr><td>cat</td><td>Number</td><td>å•†å“åˆ†ç±» ID</td><td>å¯é€‰ï¼Œéœ€é€šè¿‡åˆ†ç±»æ¥å£è·å–åˆæ³• ID</td></tr><tr><td>price_min</td><td>Number</td><td>æœ€ä½ä»·æ ¼ï¼ˆå…ƒï¼‰</td><td>ä¸ price_max æ­é…ä½¿ç”¨ï¼Œéè´Ÿ</td></tr><tr><td>price_max</td><td>Number</td><td>æœ€é«˜ä»·æ ¼ï¼ˆå…ƒï¼‰</td><td>éœ€å¤§äº price_min</td></tr><tr><td>sales</td><td>Number</td><td>é”€é‡ç­›é€‰</td><td>å¯é€‰ï¼Œå¦‚ 100 è¡¨ç¤ºç­›é€‰é”€é‡â‰¥100 çš„å•†å“</td></tr><tr><td>page_no</td><td>Number</td><td>é¡µç </td><td>é»˜è®¤ä¸º 1ï¼Œæœ€å¤§æ”¯æŒ 100 é¡µ</td></tr><tr><td>page_size</td><td>Number</td><td>æ¯é¡µæ¡æ•°</td><td>1-40ï¼Œé»˜è®¤ 20</td></tr><tr><td>sort</td><td>String</td><td>æ’åºæ–¹å¼</td><td>å¯é€‰å€¼ï¼šprice_ascï¼ˆä½ä»·ä¼˜å…ˆï¼‰ã€price_descï¼ˆé«˜ä»·ä¼˜å…ˆï¼‰ã€sales_descï¼ˆé”€é‡ä¼˜å…ˆï¼‰</td></tr></tbody></table>
<h3 data-id="heading-6">2.3 å‚æ•°æ‹¼æ¥è§„åˆ™</h3>
<ol>
<li>æ‰€æœ‰å‚æ•°ï¼ˆå…¬å…± + ä¸šåŠ¡ï¼‰æŒ‰<strong>å‚æ•°å ASCII ç å‡åº</strong>æ’åºï¼›</li>
<li>é”®å€¼å¯¹æ ¼å¼ä¸º<code>key=value</code>ï¼Œvalue éœ€è¿›è¡Œ URL ç¼–ç ï¼ˆå¦‚ç©ºæ ¼æ›¿æ¢ä¸º<code>%20</code>ï¼Œä¸­æ–‡è½¬æ¢ä¸º UTF-8 ç¼–ç çš„åå…­è¿›åˆ¶ï¼‰ï¼›</li>
<li>æ’åºåçš„é”®å€¼å¯¹ç”¨<code>&amp;</code>è¿æ¥ï¼Œå½¢æˆå¾…ç­¾åå­—ç¬¦ä¸²ã€‚</li>
</ol>
<p>ç¤ºä¾‹å¾…ç­¾åå­—ç¬¦ä¸²ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">app_key</span>=<span class="hljs-number">2356789012</span>&amp;format=json&amp;method=taobao.items.search&amp;page_<span class="hljs-literal">no</span>=<span class="hljs-number">1</span>&amp;page_size=<span class="hljs-number">20</span>&amp;q=æ‰‹æœº&amp;timestamp=<span class="hljs-number">2025</span>-<span class="hljs-number">12</span>-<span class="hljs-number">03</span>+<span class="hljs-number">14</span>%<span class="hljs-number">3</span>A30%<span class="hljs-number">3</span>A00&amp;v=<span class="hljs-number">2.0</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-7">ä¸‰ã€ç­¾åæœºåˆ¶åŸç†ä¸å®ç°</h2>
<p>æ·˜å® API ç­¾åæœºåˆ¶æ˜¯ä¸ºäº†éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§ï¼Œé˜²æ­¢å‚æ•°è¢«ç¯¡æ”¹ï¼Œæ ¸å¿ƒåŸºäº<code>AppSecret</code>è¿›è¡Œ MD5 åŠ å¯†ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-8">3.1 ç­¾åç”Ÿæˆæ­¥éª¤</h3>
<ol>
<li>æŒ‰å‚æ•°æ‹¼æ¥è§„åˆ™ç”Ÿæˆ<strong>æ’åºåçš„å¾…ç­¾åå­—ç¬¦ä¸²</strong>ï¼ˆä¸å« sign å‚æ•°ï¼‰ï¼›</li>
<li>åœ¨å¾…ç­¾åå­—ç¬¦ä¸²é¦–å°¾æ‹¼æ¥<code>AppSecret</code>ï¼Œå½¢æˆ<code>AppSecret + å¾…ç­¾åå­—ç¬¦ä¸² + AppSecret</code>ï¼›</li>
<li>å¯¹æ‹¼æ¥åçš„å­—ç¬¦ä¸²è¿›è¡Œ<strong>MD5 åŠ å¯†</strong>ï¼Œå¾—åˆ° 32 ä½å°å†™å­—ç¬¦ä¸²ï¼Œå³ä¸º sign å€¼ï¼›</li>
<li>å°† sign å‚æ•°åŠ å…¥è¯·æ±‚å‚æ•°ï¼Œå®Œæˆæœ€ç»ˆè¯·æ±‚ URL æ„å»ºã€‚</li>
</ol>
<h3 data-id="heading-9">3.2 ç­¾åé˜²ç¯¡æ”¹åŸç†</h3>
<ul>
<li><code>AppSecret</code>ä»…å¼€å‘è€…å’Œæ·˜å®æœåŠ¡å™¨çŸ¥æ™“ï¼Œç¬¬ä¸‰æ–¹æ— æ³•ä¼ªé€ ç­¾åï¼›</li>
<li>ä»»ä½•å‚æ•°ï¼ˆåŒ…æ‹¬å€¼ã€é¡ºåºï¼‰çš„ä¿®æ”¹éƒ½ä¼šå¯¼è‡´å¾…ç­¾åå­—ç¬¦ä¸²å˜åŒ–ï¼Œæœ€ç»ˆç­¾åå¤±æ•ˆï¼›</li>
<li>timestamp å‚æ•°ç”¨äºé˜²æ­¢è¯·æ±‚é‡æ”¾ï¼ˆæ·˜å®é»˜è®¤æœ‰æ•ˆæœŸä¸º 10 åˆ†é’Ÿï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-10">3.3 ç­¾åå®ç°ç¤ºä¾‹ï¼ˆPythonï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> urllib.parse

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_sign</span>(<span class="hljs-params">params, app_secret</span>):
    <span class="hljs-comment"># 1. æŒ‰å‚æ•°åASCIIå‡åºæ’åº</span>
    sorted_params = <span class="hljs-built_in">sorted</span>(params.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">0</span>])
    <span class="hljs-comment"># 2. æ‹¼æ¥ä¸ºkey=valueæ ¼å¼ï¼ŒURLç¼–ç value</span>
    encoded_params = []
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> sorted_params:
        encoded_value = urllib.parse.quote(<span class="hljs-built_in">str</span>(value), safe=<span class="hljs-string">''</span>)
        encoded_params.append(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>=<span class="hljs-subst">{encoded_value}</span>"</span>)
    sign_str = <span class="hljs-string">'&amp;'</span>.join(encoded_params)
    <span class="hljs-comment"># 3. é¦–å°¾æ‹¼æ¥AppSecret</span>
    sign_str = <span class="hljs-string">f"<span class="hljs-subst">{app_secret}</span><span class="hljs-subst">{sign_str}</span><span class="hljs-subst">{app_secret}</span>"</span>
    <span class="hljs-comment"># 4. MD5åŠ å¯†</span>
    md5 = hashlib.md5()
    md5.update(sign_str.encode(<span class="hljs-string">'utf-8'</span>))
    <span class="hljs-keyword">return</span> md5.hexdigest().lower()

<span class="hljs-comment"># æµ‹è¯•</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    app_secret = <span class="hljs-string">"your_app_secret"</span>
    params = {
        <span class="hljs-string">"app_key"</span>: <span class="hljs-string">"2356789012"</span>,
        <span class="hljs-string">"method"</span>: <span class="hljs-string">"taobao.items.search"</span>,
        <span class="hljs-string">"format"</span>: <span class="hljs-string">"json"</span>,
        <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"2025-12-03 14:30:00"</span>,
        <span class="hljs-string">"v"</span>: <span class="hljs-string">"2.0"</span>,
        <span class="hljs-string">"q"</span>: <span class="hljs-string">"æ‰‹æœº"</span>,
        <span class="hljs-string">"page_no"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">"page_size"</span>: <span class="hljs-number">20</span>
    }
    sign = generate_sign(params, app_secret)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”Ÿæˆçš„ç­¾åï¼š"</span>, sign)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-11">å››ã€å®Œæ•´æ¥å£è°ƒç”¨ä»£ç å®ç°ï¼ˆPythonï¼‰</h2>
<p>ä»¥ä¸‹æ˜¯åŸºäº Python çš„å®Œæ•´æ¥å£è°ƒç”¨ç¤ºä¾‹ï¼ŒåŒ…å«å‚æ•°æ„å»ºã€ç­¾åç”Ÿæˆã€HTTP è¯·æ±‚ã€å“åº”è§£æç­‰æµç¨‹ï¼Œä½¿ç”¨<code>requests</code>åº“å‘é€è¯·æ±‚ã€‚</p>
<h3 data-id="heading-12">4.1 ç¯å¢ƒå‡†å¤‡</h3>
<p>å®‰è£…ä¾èµ–åº“ï¼š</p>
<pre><code class="hljs">pip install requests
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-13">4.2 å®Œæ•´ä»£ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> urllib.parse
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TaobaoSearchAPI</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, app_key, app_secret</span>):
        self.app_key = app_key
        self.app_secret = app_secret
        self.base_url = <span class="hljs-string">"http://gw.api.taobao.com/router/rest"</span>  <span class="hljs-comment"># æ­£å¼ç¯å¢ƒURL</span>
        <span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒURLï¼šhttp://gw.api.tbsandbox.com/router/rest</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_sign</span>(<span class="hljs-params">self, params</span>):
        <span class="hljs-string">"""ç”Ÿæˆç­¾åï¼ˆå¤ç”¨3.3èŠ‚å®ç°ï¼‰"""</span>
        sorted_params = <span class="hljs-built_in">sorted</span>(params.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">0</span>])
        encoded_params = []
        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> sorted_params:
            encoded_value = urllib.parse.quote(<span class="hljs-built_in">str</span>(value), safe=<span class="hljs-string">''</span>)
            encoded_params.append(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>=<span class="hljs-subst">{encoded_value}</span>"</span>)
        sign_str = <span class="hljs-string">'&amp;'</span>.join(encoded_params)
        sign_str = <span class="hljs-string">f"<span class="hljs-subst">{self.app_secret}</span><span class="hljs-subst">{sign_str}</span><span class="hljs-subst">{self.app_secret}</span>"</span>
        md5 = hashlib.md5()
        md5.update(sign_str.encode(<span class="hljs-string">'utf-8'</span>))
        <span class="hljs-keyword">return</span> md5.hexdigest().lower()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">search_items</span>(<span class="hljs-params">self, keyword, page_no=<span class="hljs-number">1</span>, page_size=<span class="hljs-number">20</span>, **kwargs</span>):
        <span class="hljs-string">"""
        å…³é”®è¯æœç´¢å•†å“
        :param keyword: æœç´¢å…³é”®è¯
        :param page_no: é¡µç 
        :param page_size: æ¯é¡µæ¡æ•°ï¼ˆ1-40ï¼‰
        :param kwargs: å…¶ä»–ä¸šåŠ¡å‚æ•°ï¼ˆå¦‚catã€price_minã€price_maxã€sortç­‰ï¼‰
        :return: è§£æåçš„å•†å“æ•°æ®
        """</span>
        <span class="hljs-comment"># 1. æ„å»ºå…¬å…±å‚æ•°</span>
        params = {
            <span class="hljs-string">"app_key"</span>: self.app_key,
            <span class="hljs-string">"method"</span>: <span class="hljs-string">"taobao.items.search"</span>,
            <span class="hljs-string">"format"</span>: <span class="hljs-string">"json"</span>,
            <span class="hljs-string">"timestamp"</span>: datetime.now().strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>),
            <span class="hljs-string">"v"</span>: <span class="hljs-string">"2.0"</span>,
            <span class="hljs-string">"page_no"</span>: page_no,
            <span class="hljs-string">"page_size"</span>: <span class="hljs-built_in">min</span>(page_size, <span class="hljs-number">40</span>),  <span class="hljs-comment"># é™åˆ¶æœ€å¤§æ¡æ•°</span>
            <span class="hljs-string">"q"</span>: keyword
        }

        <span class="hljs-comment"># 2. æ·»åŠ é¢å¤–ä¸šåŠ¡å‚æ•°</span>
        params.update(kwargs)

        <span class="hljs-comment"># 3. ç”Ÿæˆç­¾å</span>
        sign = self.generate_sign(params)
        params[<span class="hljs-string">"sign"</span>] = sign

        <span class="hljs-comment"># 4. å‘é€HTTPè¯·æ±‚</span>
        <span class="hljs-keyword">try</span>:
            response = requests.get(self.base_url, params=params, timeout=<span class="hljs-number">10</span>)
            response.raise_for_status()  <span class="hljs-comment"># æŠ›å‡ºHTTPé”™è¯¯</span>
            result = response.json()

            <span class="hljs-comment"># 5. è§£æå“åº”</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">"error_response"</span> <span class="hljs-keyword">in</span> result:
                error = result[<span class="hljs-string">"error_response"</span>]
                <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">f"æ¥å£è°ƒç”¨å¤±è´¥ï¼š<span class="hljs-subst">{error[<span class="hljs-string">'msg'</span>]}</span>ï¼ˆé”™è¯¯ç ï¼š<span class="hljs-subst">{error[<span class="hljs-string">'code'</span>]}</span>ï¼‰"</span>)
            
            <span class="hljs-comment"># æå–å•†å“åˆ—è¡¨</span>
            items = result[<span class="hljs-string">"items_search_response"</span>][<span class="hljs-string">"items"</span>][<span class="hljs-string">"item"</span>]
            total = result[<span class="hljs-string">"items_search_response"</span>][<span class="hljs-string">"total_results"</span>]
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">"total"</span>: total,
                <span class="hljs-string">"page_no"</span>: page_no,
                <span class="hljs-string">"page_size"</span>: page_size,
                <span class="hljs-string">"items"</span>: items
            }
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœç´¢å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-comment"># ç¤ºä¾‹è°ƒç”¨</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># æ›¿æ¢ä¸ºä½ çš„AppKeyå’ŒAppSecret</span>
    APP_KEY = <span class="hljs-string">"your_app_key"</span>
    APP_SECRET = <span class="hljs-string">"your_app_secret"</span>

    <span class="hljs-comment"># åˆå§‹åŒ–APIå®¢æˆ·ç«¯</span>
    taobao_api = TaobaoSearchAPI(APP_KEY, APP_SECRET)

    <span class="hljs-comment"># æœç´¢å…³é”®è¯"æ‰‹æœº"ï¼Œç­›é€‰ä»·æ ¼1000-5000å…ƒï¼Œé”€é‡ä¼˜å…ˆæ’åº</span>
    result = taobao_api.search_items(
        keyword=<span class="hljs-string">"æ‰‹æœº"</span>,
        page_no=<span class="hljs-number">1</span>,
        page_size=<span class="hljs-number">30</span>,
        price_min=<span class="hljs-number">1000</span>,
        price_max=<span class="hljs-number">5000</span>,
        sort=<span class="hljs-string">"sales_desc"</span>
    )

    <span class="hljs-comment"># æ‰“å°ç»“æœ</span>
    <span class="hljs-keyword">if</span> result:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»å•†å“æ•°ï¼š<span class="hljs-subst">{result[<span class="hljs-string">'total'</span>]}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰é¡µå•†å“æ•°ï¼š<span class="hljs-subst">{<span class="hljs-built_in">len</span>(result[<span class="hljs-string">'items'</span>])}</span>"</span>)
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> result[<span class="hljs-string">"items"</span>][:<span class="hljs-number">3</span>]:  <span class="hljs-comment"># æ‰“å°å‰3ä¸ªå•†å“</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å•†å“æ ‡é¢˜ï¼š<span class="hljs-subst">{item[<span class="hljs-string">'title'</span>]}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»·æ ¼ï¼š<span class="hljs-subst">{item[<span class="hljs-string">'price'</span>]}</span>å…ƒ"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”€é‡ï¼š<span class="hljs-subst">{item[<span class="hljs-string">'sale_count'</span>]}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å•†å“é“¾æ¥ï¼š<span class="hljs-subst">{item[<span class="hljs-string">'detail_url'</span>]}</span>\n"</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-14">4.3 å“åº”å­—æ®µè¯´æ˜</h3>
<p>è¿”å›çš„å•†å“æ•°æ®åŒ…å«å¤šä¸ªæ ¸å¿ƒå­—æ®µï¼Œå¸¸ç”¨å­—æ®µå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>title</code>ï¼šå•†å“æ ‡é¢˜ï¼ˆå«å…³é”®è¯é«˜äº®æ ‡è®°ï¼‰ï¼›</li>
<li><code>price</code>ï¼šå•†å“ä»·æ ¼ï¼ˆå•ä½ï¼šå…ƒï¼‰ï¼›</li>
<li><code>sale_count</code>ï¼šç´¯è®¡é”€é‡ï¼›</li>
<li><code>detail_url</code>ï¼šå•†å“è¯¦æƒ…é¡µé“¾æ¥ï¼›</li>
<li><code>pic_url</code>ï¼šå•†å“ä¸»å›¾ URLï¼›</li>
<li><code>nick</code>ï¼šå–å®¶æ˜µç§°ï¼›</li>
<li><code>shop_type</code>ï¼šåº—é“ºç±»å‹ï¼ˆtaobaoï¼šæ·˜å®åº—ï¼Œtmallï¼šå¤©çŒ«åº—ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-15">äº”ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
<p>æ·˜å® API å¯¹è°ƒç”¨é¢‘ç‡æœ‰ä¸¥æ ¼é™åˆ¶ï¼ˆæ™®é€šåº”ç”¨é€šå¸¸ä¸º 10-20 æ¬¡ / ç§’ï¼‰ï¼Œä¸”å•é¡µæœ€å¤§è¿”å› 40 æ¡æ•°æ®ï¼Œåœ¨æµ·é‡æ•°æ®é‡‡é›†åœºæ™¯ä¸­éœ€é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-16">5.1 é™æµä¸é‡è¯•æœºåˆ¶</h3>
<ol>
<li><strong>æ§åˆ¶å¹¶å‘é‡</strong>ï¼šä½¿ç”¨çº¿ç¨‹æ±  / åç¨‹æ± é™åˆ¶å¹¶å‘è¯·æ±‚æ•°ï¼Œé¿å…è§¦å‘é™æµï¼ˆç¤ºä¾‹ï¼šä½¿ç”¨<code>concurrent.futures.ThreadPoolExecutor</code>ï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ä¸º 10ï¼‰ï¼›</li>
<li><strong>æŒ‡æ•°é€€é¿é‡è¯•</strong>ï¼šè°ƒç”¨å¤±è´¥æ—¶ï¼ˆå¦‚é”™è¯¯ç <code>429</code>é™æµã€<code>503</code>æœåŠ¡ä¸å¯ç”¨ï¼‰ï¼Œé‡‡ç”¨æŒ‡æ•°é€€é¿ç­–ç•¥é‡è¯•ï¼ˆ1sâ†’2sâ†’4sâ†’...ï¼‰ï¼Œé¿å…é¢‘ç¹é‡è¯•åŠ å‰§æœåŠ¡å™¨å‹åŠ›ï¼›</li>
<li><strong>è®°å½•è¯·æ±‚æ—¥å¿—</strong>ï¼šè®°å½•æ¯æ¬¡è¯·æ±‚çš„æ—¶é—´ã€å‚æ•°ã€å“åº”çŠ¶æ€ï¼Œä¾¿äºæ’æŸ¥é™æµåŸå› ã€‚</li>
</ol>
<p>ç¤ºä¾‹é‡è¯•æœºåˆ¶å®ç°ï¼ˆåŸºäº<code>tenacity</code>åº“ï¼‰ï¼š</p>
<pre><code class="hljs">pip install tenacity
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> tenacity <span class="hljs-keyword">import</span> retry, stop_after_attempt, wait_exponential, retry_if_exception_type

<span class="hljs-meta">@retry(<span class="hljs-params">
    stop=stop_after_attempt(<span class="hljs-params"><span class="hljs-number">3</span></span>),  <span class="hljs-comment"># æœ€å¤šé‡è¯•3æ¬¡</span>
    wait=wait_exponential(<span class="hljs-params">multiplier=<span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>=<span class="hljs-number">1</span>, <span class="hljs-built_in">max</span>=<span class="hljs-number">5</span></span>),  <span class="hljs-comment"># æŒ‡æ•°é€€é¿</span>
    retry=retry_if_exception_type(<span class="hljs-params">(<span class="hljs-params">requests.exceptions.RequestException, Exception</span>)</span>)
</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_items_with_retry</span>(<span class="hljs-params">self, keyword, **kwargs</span>):
    <span class="hljs-keyword">return</span> self.search_items(keyword, **kwargs)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-17">5.2 æ•°æ®åˆ†é¡µä¼˜åŒ–</h3>
<ol>
<li><strong>æ‰¹é‡åˆ†é¡µæŸ¥è¯¢</strong>ï¼šé€šè¿‡<code>page_no</code>å¾ªç¯è·å–æ‰€æœ‰é¡µç æ•°æ®ï¼Œç›´è‡³è¿”å›ç»“æœä¸ºç©ºï¼ˆæ³¨æ„ï¼šæ·˜å® API æœ€å¤§æ”¯æŒ 100 é¡µï¼Œè¶…è¿‡éœ€è°ƒæ•´ç­›é€‰æ¡ä»¶ï¼‰ï¼›</li>
<li><strong>åˆç†è®¾ç½® page_size</strong>ï¼šæ¯é¡µæ¡æ•°è®¾ä¸º 40ï¼ˆæœ€å¤§å€¼ï¼‰ï¼Œå‡å°‘æ€»è¯·æ±‚æ¬¡æ•°ï¼›</li>
<li><strong>å¼‚æ­¥åˆ†é¡µ</strong>ï¼šä½¿ç”¨å¼‚æ­¥è¯·æ±‚åº“ï¼ˆå¦‚<code>aiohttp</code>ï¼‰å¹¶è¡Œè·å–å¤šé¡µæ•°æ®ï¼Œæå‡æ•ˆç‡ã€‚</li>
</ol>
<h3 data-id="heading-18">5.3 ç¼“å­˜ç­–ç•¥</h3>
<ol>
<li><strong>æœ¬åœ°ç¼“å­˜</strong>ï¼šç¼“å­˜çƒ­é—¨å…³é”®è¯çš„æœç´¢ç»“æœï¼ˆå¦‚ Redisã€å†…å­˜å­—å…¸ï¼‰ï¼Œæœ‰æ•ˆæœŸè®¾ä¸º 5-15 åˆ†é’Ÿï¼Œå‡å°‘é‡å¤è¯·æ±‚ï¼›</li>
<li><strong>å¢é‡æ›´æ–°</strong>ï¼šä»…æŸ¥è¯¢æ–°å¢æ•°æ®ï¼ˆé€šè¿‡<code>modify_time</code>ç­‰å­—æ®µç­›é€‰ï¼‰ï¼Œé¿å…å…¨é‡é‡å¤é‡‡é›†ï¼›</li>
<li><strong>ç¼“å­˜å‡»ç©¿é˜²æŠ¤</strong>ï¼šå¯¹çƒ­ç‚¹å…³é”®è¯è®¾ç½®äº’æ–¥é”ï¼Œé¿å…ç¼“å­˜å¤±æ•ˆæ—¶å¤§é‡è¯·æ±‚ç©¿é€åˆ° APIã€‚</li>
</ol>
<h3 data-id="heading-19">5.4 å…¶ä»–ä¼˜åŒ–æŠ€å·§</h3>
<ol>
<li><strong>ç²¾ç®€è¿”å›å­—æ®µ</strong>ï¼šä½¿ç”¨<code>fields</code>å‚æ•°æŒ‡å®šæ‰€éœ€å­—æ®µï¼ˆå¦‚<code>fields=title,price,sale_count</code>ï¼‰ï¼Œå‡å°‘å“åº”æ•°æ®ä¼ è¾“é‡ï¼›</li>
<li><strong>å°±è¿‘æ¥å…¥</strong>ï¼šé€‰æ‹©ä¸æ·˜å®æœåŠ¡å™¨åœ°ç†ä½ç½®è¾ƒè¿‘çš„æœåŠ¡å™¨éƒ¨ç½²åº”ç”¨ï¼Œé™ä½ç½‘ç»œå»¶è¿Ÿï¼›</li>
<li><strong>é¿å…æ— æ•ˆå‚æ•°</strong>ï¼šä¸¥æ ¼æ ¡éªŒå‚æ•°åˆæ³•æ€§ï¼ˆå¦‚ä»·æ ¼åŒºé—´ã€åˆ†ç±» IDï¼‰ï¼Œé¿å…å› å‚æ•°é”™è¯¯å¯¼è‡´æ— æ•ˆè¯·æ±‚ã€‚</li>
</ol>
<h2 data-id="heading-20">å…­ã€å¸¸è§é—®é¢˜ä¸æ’æŸ¥</h2>
<ol>
<li>
<p><strong>ç­¾åé”™è¯¯ï¼ˆé”™è¯¯ç <code>15</code>ï¼‰</strong> ï¼š</p>
<ul>
<li>æ£€æŸ¥å‚æ•°æ’åºæ˜¯å¦æŒ‰ ASCII å‡åºï¼›</li>
<li>ç¡®è®¤<code>AppSecret</code>æ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ï¼›</li>
<li>æ£€æŸ¥ value æ˜¯å¦æ­£ç¡® URL ç¼–ç ï¼ˆä¸­æ–‡ã€ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æƒé™ä¸è¶³ï¼ˆé”™è¯¯ç <code>11</code>ï¼‰</strong> ï¼š</p>
<ul>
<li>ç¡®è®¤åº”ç”¨å·²ç”³è¯·ç›®æ ‡æ¥å£æƒé™ï¼›</li>
<li>éƒ¨åˆ†æ¥å£éœ€ç”¨æˆ·æˆæƒï¼ˆ<code>session</code>å‚æ•°å¿…å¡«ï¼‰ï¼Œéœ€å¼•å¯¼ç”¨æˆ·å®Œæˆæˆæƒæµç¨‹ã€‚</li>
</ul>
</li>
<li>
<p><strong>é™æµï¼ˆé”™è¯¯ç <code>429</code>ï¼‰</strong> ï¼š</p>
<ul>
<li>é™ä½è¯·æ±‚é¢‘ç‡ï¼Œå¢åŠ å¹¶å‘æ§åˆ¶ï¼›</li>
<li>æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–åº”ç”¨ä½¿ç”¨åŒä¸€<code>AppKey</code>é«˜é¢‘è°ƒç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®è¿”å›ä¸å…¨</strong>ï¼š</p>
<ul>
<li>ç¡®è®¤<code>page_no</code>æœªè¶…è¿‡ 100 é¡µï¼›</li>
<li>æ£€æŸ¥ç­›é€‰æ¡ä»¶æ˜¯å¦è¿‡äºä¸¥æ ¼ï¼ˆå¦‚ä»·æ ¼åŒºé—´è¿‡çª„ã€å…³é”®è¯è¿‡é•¿ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-21">ä¸ƒã€æ€»ç»“</h2>
<p>æ·˜å® API å…³é”®è¯æœç´¢æ¥å£æ˜¯ç”µå•†æ•°æ®é‡‡é›†çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶ä½¿ç”¨è¦ç‚¹å¯æ€»ç»“ä¸ºï¼š<strong>åˆè§„ä¸ºå…ˆã€ç­¾åä¸ºæ ¸ã€ä¼˜åŒ–ä¸ºç¿¼</strong>ã€‚å¼€å‘è€…éœ€ä¸¥æ ¼éµå®ˆå¹³å°è§„èŒƒï¼Œæ­£ç¡®å®ç°ç­¾åæœºåˆ¶é¿å…è¯·æ±‚å¤±æ•ˆï¼ŒåŒæ—¶é€šè¿‡é™æµã€ç¼“å­˜ã€åˆ†é¡µä¼˜åŒ–ç­‰ç­–ç•¥æå‡æ¥å£è°ƒç”¨æ•ˆç‡ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿˜éœ€å…³æ³¨æ¥å£ç‰ˆæœ¬æ›´æ–°ï¼ˆå¦‚æ—§ç‰ˆ<code>taobao.items.search</code>é€æ­¥è¿ç§»è‡³æ–°ç‰ˆ<code>alibaba.item.search</code>ï¼‰ã€å­—æ®µå˜æ›´ç­‰å¹³å°é€šçŸ¥ï¼Œç¡®ä¿åº”ç”¨é•¿æœŸç¨³å®šè¿è¡Œã€‚é€šè¿‡æœ¬æ–‡çš„è§£æä¸å®æˆ˜ä»£ç ï¼Œå¼€å‘è€…å¯å¿«é€ŸæŒæ¡æ¥å£ä½¿ç”¨æŠ€å·§ï¼Œé«˜æ•ˆè½åœ°ç›¸å…³ä¸šåŠ¡åœºæ™¯ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python + Langchain + Streamlit + DashScope å®ç°ä¸€ä¸ªç½‘é¡µç‰ˆèŠå¤©æœºå™¨äºº]]></title>    <link>https://juejin.cn/post/7579427549471719470</link>    <guid>https://juejin.cn/post/7579427549471719470</guid>    <pubDate>2025-12-03T09:21:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579427549471719470" data-draft-id="7579410911057674266" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python + Langchain + Streamlit + DashScope å®ç°ä¸€ä¸ªç½‘é¡µç‰ˆèŠå¤©æœºå™¨äºº"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-03T09:21:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»ä»å®¹å®¹æ¸¸åˆƒæœ‰ä½™"/> <meta itemprop="url" content="https://juejin.cn/user/4107431173952525"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python + Langchain + Streamlit + DashScope å®ç°ä¸€ä¸ªç½‘é¡µç‰ˆèŠå¤©æœºå™¨äºº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431173952525/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»ä»å®¹å®¹æ¸¸åˆƒæœ‰ä½™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:21:40.000Z" title="Wed Dec 03 2025 09:21:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Python + Langchain + Streamlit + DashScope å®ç°ä¸€ä¸ªç½‘é¡µç‰ˆèŠå¤©æœºå™¨äºº</h2>
<h3 data-id="heading-1">é›¶ã€å‰ç½®æ¡ä»¶</h3>
<p>éœ€è¦åœ¨é˜¿é‡Œå·´å·´ç™¾ç‚¼å¹³å°åˆ›å»ºä¸€ä¸ªapi keyï¼Œå¹¶å†™åˆ°.envæ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä½ çš„ç™¾ç‚¼å¹³å°key</span>
<span class="hljs-attr">DASHSCOPE_API_KEY</span>=ä½ çš„ç™¾ç‚¼å¹³å°key
<span class="hljs-comment"># ç™¾ç‚¼å¹³å°url</span>
<span class="hljs-attr">BASE_URL</span>=https://dashscope.aliyuncs.com/compatible-mode/v1
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f410fe0355d4138810f35d91f2af338~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuO5LuO5a655a655ri45YiD5pyJ5L2Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765358500&amp;x-signature=oV7UcHN1lmzWjb3y08vCR8eXdI0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">ä¸€ã€å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-shell" lang="shell">pip install streamlit
pip install langchain_openai
pip install python-dotenv

</code></pre>
<h3 data-id="heading-3">äºŒã€å®Œæ•´Pythonä»£ç </h3>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-comment"># å¯¼å…¥streamlit     å®‰è£… pip install streamlit</span>
<span class="hljs-keyword">import</span> streamlit <span class="hljs-keyword">as</span> st
<span class="hljs-comment"># å¯¼å…¥langchain_openai  pip install langchain_openai</span>
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-comment"># å¯¼å…¥ dotenv è¯»å– .env  pip install python-dotenv</span>
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv

<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># åŠ è½½ .env æ–‡ä»¶</span>
load_dotenv()

chatLLM = ChatOpenAI(
    openai_api_key=os.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>),
    openai_api_base=os.getenv(<span class="hljs-string">"BASE_URL"</span>),
    model=<span class="hljs-string">"qwen-plus"</span>
)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">prompt: <span class="hljs-built_in">str</span></span>):
    response = chatLLM.invoke([{<span class="hljs-string">'role'</span>: <span class="hljs-string">'user'</span>, <span class="hljs-string">'content'</span>: prompt}])
    <span class="hljs-keyword">return</span> response.content


<span class="hljs-comment"># ä¿å­˜èŠå¤©ä¿¡æ¯</span>
<span class="hljs-keyword">if</span> <span class="hljs-string">"messages"</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> st.session_state:
    st.session_state[<span class="hljs-string">'messages'</span>] = []

<span class="hljs-comment"># æ ‡é¢˜</span>
st.title(<span class="hljs-string">"Python + Langchain + Streamlit + DashScope å®ç°ä¸€ä¸ªç½‘é¡µç‰ˆèŠå¤©æœºå™¨äºº"</span>)

<span class="hljs-comment"># åˆ†éš”ç¬¦</span>
st.divider()

<span class="hljs-comment"># è¯·è¾“å…¥ä½ çš„é—®é¢˜</span>
prompt = st.chat_input(<span class="hljs-string">"è¯·è¾“å…¥ä½ çš„é—®é¢˜"</span>)

<span class="hljs-keyword">if</span> prompt:
    <span class="hljs-comment"># role : user ã€ assistant  ai human</span>
    st.session_state[<span class="hljs-string">'messages'</span>].append({<span class="hljs-string">'role'</span>: <span class="hljs-string">'user'</span>, <span class="hljs-string">'content'</span>: prompt})
    <span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> st.session_state[<span class="hljs-string">'messages'</span>]:
        st.chat_message(message[<span class="hljs-string">'role'</span>]).markdown(message[<span class="hljs-string">'content'</span>])

    <span class="hljs-keyword">with</span> st.spinner(<span class="hljs-string">"ğŸ¤”æ€è€ƒä¸­ã€‚ã€‚ã€‚ã€‚"</span>):
        response = chat(prompt)
        st.session_state[<span class="hljs-string">'messages'</span>].append({<span class="hljs-string">'role'</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-string">'content'</span>: response})
        st.chat_message(<span class="hljs-string">'assistant'</span>).markdown(response)
</code></pre>
<h3 data-id="heading-4">ä¸‰ã€å¯åŠ¨</h3>
<pre><code class="hljs language-shell" lang="shell">streamlit run streamlit_langchain_dashscope.py 
</code></pre>
<h3 data-id="heading-5">å››ã€æ•ˆæœ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40145648fd7044698ff3a2a678105a16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuO5LuO5a655a655ri45YiD5pyJ5L2Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765358500&amp;x-signature=VBhznhqqEW3IPsqSncOheFdMWXw%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js åŸç”ŸåŠ å¯†æŒ‡å—ï¼šè¯¦è§£ Crypto æ¨¡å—å¯¹æ¥å¤©è¿œé“¶è¡Œå¡é»‘åå•æ¥å£]]></title>    <link>https://juejin.cn/post/7579438351297560612</link>    <guid>https://juejin.cn/post/7579438351297560612</guid>    <pubDate>2025-12-03T09:41:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579438351297560612" data-draft-id="7579439226518650886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js åŸç”ŸåŠ å¯†æŒ‡å—ï¼šè¯¦è§£ Crypto æ¨¡å—å¯¹æ¥å¤©è¿œé“¶è¡Œå¡é»‘åå•æ¥å£"/> <meta itemprop="keywords" content="API,å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2025-12-03T09:41:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©è¿œæ•°ç§‘"/> <meta itemprop="url" content="https://juejin.cn/user/3511153810487162"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js åŸç”ŸåŠ å¯†æŒ‡å—ï¼šè¯¦è§£ Crypto æ¨¡å—å¯¹æ¥å¤©è¿œé“¶è¡Œå¡é»‘åå•æ¥å£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3511153810487162/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©è¿œæ•°ç§‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:41:01.000Z" title="Wed Dec 03 2025 09:41:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ„å»ºç°ä»£æ”¯ä»˜æ¶æ„æ—¶ï¼ŒNode.js å¸¸è¢«ç”¨ä½œ BFF (Backend for Frontend) å±‚ï¼Œè´Ÿè´£èšåˆæ•°æ®ä¸å¿«é€Ÿå“åº”ã€‚å¯¹äºé£æ§å­ç³»ç»Ÿè€Œè¨€ï¼ŒBFF å±‚æ˜¯æ‹¦æˆªé«˜å±äº¤æ˜“çš„ç¬¬ä¸€é“é˜²çº¿â€”â€”æ—¢è¦å¿«ï¼Œåˆè¦å‡†ã€‚</p>
<p>æœ¬æ–‡å°†ä»¥å¯¹æ¥é‡‘èçº§é£æ§æ¥å£ï¼ˆä»¥å¤©è¿œæ•°æ® API ä¸ºä¾‹ï¼‰ä¸ºä¾‹ï¼Œæ·±å…¥æ¢è®¨å¦‚ä½•åœ¨ Node.js ä¸­ä¼˜é›…åœ°å®ç° <strong>AES-128-CBC</strong> åŠ å¯†é€šä¿¡ï¼Œå¹¶è§„é¿ JavaScript å¸¸è§çš„ç±»å‹é™·é˜±ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†è®¨è®ºå¦‚ä½•åˆ©ç”¨ Serverless æ¶æ„é™ä½é£æ§æœåŠ¡çš„è¿ç»´æˆæœ¬ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ ä¸ºä»€ä¹ˆåŸç”Ÿ Crypto æ¨¡å—æ¯”ç¬¬ä¸‰æ–¹åº“æ›´å¥½ï¼Ÿ</h2>
<p>å¾ˆå¤šå¼€å‘è€…ä¹ æƒ¯å¼•å…¥ <code>crypto-js</code> ç­‰ç¬¬ä¸‰æ–¹åºå¤§çš„åº“æ¥å¤„ç†åŠ å¯†ã€‚å…¶å®ï¼ŒNode.js å†…ç½®çš„ <code>crypto</code> æ¨¡å—åŸºäº OpenSSLï¼Œæ€§èƒ½æä½³ä¸”æ— é¢å¤–ä¾èµ–ã€‚</p>
<p>ä½†åœ¨å¯¹æ¥é“¶è¡Œæˆ–é£æ§æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šé‡åˆ°ä¸¤ä¸ªç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å¡«å……æ¨¡å¼ï¼ˆPaddingï¼‰</strong> ï¼šJava/Go ç­‰åç«¯å¸¸éœ€æ‰‹åŠ¨å®ç° PKCS7ï¼Œè€Œ Node.js çš„ <code>createCipheriv</code> é»˜è®¤å¼€å¯ PKCS7 å¡«å……ï¼Œè¿™ä¸€ç‚¹è™½ç„¶æ–¹ä¾¿ï¼Œä½†å¦‚æœæœåŠ¡ç«¯ä½¿ç”¨ ZeroPadding ç­‰éæ ‡æ¨¡å¼ï¼Œå°±éœ€è¦ç‰¹åˆ«å¤„ç†ã€‚</li>
<li><strong>ç¼–ç è½¬æ¢</strong>ï¼šåœ¨ 16 è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆHexï¼‰ã€äºŒè¿›åˆ¶ç¼“å†²åŒºï¼ˆBufferï¼‰å’Œ Base64 ä¹‹é—´åå¤æ¨ªè·³ï¼Œå®¹æ˜“ææ™•ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€ æ ¸å¿ƒä»£ç ï¼šå°è£…ä¸€ä¸ªå¥å£®çš„ RiskClient</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç”Ÿäº§å¯ç”¨çš„ç±»ï¼Œå°è£…äº† IV æ‹¼æ¥ã€Base64 ç¼–ç ä»¥åŠ HTTP è¯·æ±‚ã€‚</p>
<h3 data-id="heading-2">2.1 ä¾èµ–å‡†å¤‡</h3>
<p>æˆ‘ä»¬ä»…ä½¿ç”¨ <code>axios</code> å¤„ç†ç½‘ç»œè¯·æ±‚ï¼ŒåŠ å¯†éƒ¨åˆ†å®Œå…¨ä½¿ç”¨åŸç”Ÿæ¨¡å—ã€‚</p>
<pre><code class="hljs">npm install axios
</code></pre>
<h3 data-id="heading-3">2.2 å®Œæ•´å®ç° (Async/Await)</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">axios</span> = require(<span class="hljs-string">'axios'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">crypto</span> = require(<span class="hljs-string">'crypto'</span>)<span class="hljs-comment">;</span>

class BankCardRiskClient {
    /**
     * @param {string} accessId - é‰´æƒ ID
     * @param {string} accessKeyHex - 16è¿›åˆ¶æ ¼å¼çš„å¯†é’¥
     */
    constructor(accessId, accessKeyHex) {
        // è¿™é‡Œä»¥æ ‡å‡† AES-128-CBC æ¥å£ä¸ºä¾‹
        <span class="hljs-attr">this.apiUrl</span> = <span class="hljs-string">'[https://api.tianyuanapi.com/api/v1/JRZQ0B6Y](https://api.tianyuanapi.com/api/v1/JRZQ0B6Y)'</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">this.accessId</span> = accessId<span class="hljs-comment">;</span>
        // å…³é”®ç‚¹ï¼šå¿…é¡»å°† Hex å­—ç¬¦ä¸²è½¬ä¸º Buffer å¯¹è±¡ï¼Œå¦åˆ™åŠ å¯†ç»“æœä¼šå®Œå…¨é”™è¯¯
        <span class="hljs-attr">this.accessKey</span> = Buffer.from(accessKeyHex, <span class="hljs-string">'hex'</span>)<span class="hljs-comment">;</span>
    }

    /**
     * åŠ å¯†æµç¨‹: ç”ŸæˆéšæœºIV -&gt; AESåŠ å¯† -&gt; æ‹¼æ¥IV -&gt; Base64
     */
    encrypt(data) {
        // å®‰å…¨è§„èŒƒï¼šæ¯æ¬¡è¯·æ±‚å¿…é¡»ç”Ÿæˆå…¨æ–°çš„éšæœº 16 å­—èŠ‚ IV
        const <span class="hljs-attr">iv</span> = crypto.randomBytes(<span class="hljs-number">16</span>)<span class="hljs-comment">;</span>
        
        // åˆ›å»ºåŠ å¯†å®ä¾‹ï¼ŒNode.js é»˜è®¤ä½¿ç”¨ PKCS7 Padding
        const <span class="hljs-attr">cipher</span> = crypto.createCipheriv(<span class="hljs-string">'aes-128-cbc'</span>, this.accessKey, iv)<span class="hljs-comment">;</span>
        
        // åºåˆ—åŒ– JSON
        const <span class="hljs-attr">plainText</span> = JSON.stringify(data)<span class="hljs-comment">;</span>
        
        // æ ¸å¿ƒåŠ å¯†æ“ä½œï¼šupdate å¤„ç†æ•°æ®å—ï¼Œfinal å¤„ç†å‰©ä½™å¡«å……
        let <span class="hljs-attr">encrypted</span> = cipher.update(plainText, <span class="hljs-string">'utf8'</span>)<span class="hljs-comment">;</span>
        <span class="hljs-attr">encrypted</span> = Buffer.concat([encrypted, cipher.final()])<span class="hljs-comment">;</span>

        // åè®®çº¦å®šï¼šå°† IV æ‹¼æ¥åˆ°å¯†æ–‡å¤´éƒ¨ï¼Œä»¥ä¾¿æœåŠ¡ç«¯æå–è§£å¯†
        const <span class="hljs-attr">combined</span> = Buffer.concat([iv, encrypted])<span class="hljs-comment">;</span>
        
        return combined.toString('base64')<span class="hljs-comment">;</span>
    }

    /**
     * è§£å¯†æµç¨‹: Base64è§£ç  -&gt; æå–IV -&gt; è§£å¯†
     */
    decrypt(base64Data) {
        const <span class="hljs-attr">buffer</span> = Buffer.from(base64Data, <span class="hljs-string">'base64'</span>)<span class="hljs-comment">;</span>

        // æå–å‰ 16 å­—èŠ‚ä½œä¸º IV
        const <span class="hljs-attr">iv</span> = buffer.slice(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)<span class="hljs-comment">;</span>
        // å‰©ä½™éƒ¨åˆ†ä¸ºå¯†æ–‡
        const <span class="hljs-attr">text</span> = buffer.slice(<span class="hljs-number">16</span>)<span class="hljs-comment">;</span>

        const <span class="hljs-attr">decipher</span> = crypto.createDecipheriv(<span class="hljs-string">'aes-128-cbc'</span>, this.accessKey, iv)<span class="hljs-comment">;</span>
        let <span class="hljs-attr">decrypted</span> = decipher.update(text)<span class="hljs-comment">;</span>
        <span class="hljs-attr">decrypted</span> = Buffer.concat([decrypted, decipher.final()])<span class="hljs-comment">;</span>

        return JSON.parse(decrypted.toString())<span class="hljs-comment">;</span>
    }

    /**
     * ä¸šåŠ¡è°ƒç”¨å°è£…
     */
    async checkCard(name, idCard, mobile, bankCard) {
        try {
            const <span class="hljs-attr">payload</span> = { 
                name, 
                id_card: idCard, 
                mobile_no: mobile, 
                bank_card: bankCard 
            }<span class="hljs-comment">;</span>

            const <span class="hljs-attr">encryptedData</span> = this.encrypt(payload)<span class="hljs-comment">;</span>

            // å‘èµ·è¯·æ±‚ï¼Œæ³¨æ„ t å‚æ•°é˜²æ­¢é‡æ”¾æ”»å‡»
            const <span class="hljs-attr">response</span> = await axios.post(
                this.apiUrl, 
                { data: encryptedData }, 
                {
                    headers: { 'Access-Id': this.accessId },
                    params: { t: Date.now() },
                    timeout: 3000 // å»ºè®®è®¾ç½®è¶…æ—¶æ—¶é—´
                }
            )<span class="hljs-comment">;</span>

            const <span class="hljs-attr">resData</span> = response.data<span class="hljs-comment">;</span>

            if (<span class="hljs-attr">resData.code</span> === <span class="hljs-number">0</span>) {
                return this.decrypt(resData.data)<span class="hljs-comment">;</span>
            } else {
                console.warn(`API è¿”å›å¼‚å¸¸: ${resData.message}`)<span class="hljs-comment">;</span>
                return null<span class="hljs-comment">;</span>
            }
        } catch (error) {
            console.error('ç½‘ç»œæˆ–è§£å¯†é”™è¯¯:', error.message)<span class="hljs-comment">;</span>
            return null<span class="hljs-comment">;</span>
        }
    }
}

// --- è°ƒç”¨ç¤ºä¾‹ ---
(async () =&gt; {
    // æœ€ä½³å®è·µï¼šå¯†é’¥å¿…é¡»ä»ç¯å¢ƒå˜é‡è¯»å–
    const <span class="hljs-attr">client</span> = new BankCardRiskClient(
        process.env.RISK_ACCESS_ID, 
        process.env.RISK_ACCESS_KEY
    )<span class="hljs-comment">;</span>

    const <span class="hljs-attr">report</span> = await client.checkCard(
        'å¼ ä¸‰', '330106199001011234', '13912345678', '6228480038294321'
    )<span class="hljs-comment">;</span>
    
    if (report) {
         // ä¸‹æ–‡å°†è¯¦ç»†è®²è§£è¿™é‡Œçš„ç±»å‹é™·é˜±
         const <span class="hljs-attr">isRisk</span> = report.caseRelated === <span class="hljs-string">'1'</span><span class="hljs-comment">;</span>
         console.log('æ˜¯å¦æ¶‰æ¡ˆ:', isRisk)<span class="hljs-comment">;</span>
    }
})()<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€ JavaScript å¼±ç±»å‹ç³»ç»Ÿä¸­çš„â€œå¤§å‘â€</h2>
<p>åœ¨å¯¹æ¥è€ç‰Œé‡‘èæ¥å£æ—¶ï¼Œä½ ä¼šå‘ç°å¤§é‡å­—æ®µè¿”å›çš„æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„ <code>"1"</code> æˆ– <code>"0"</code>ï¼Œè€Œä¸æ˜¯ Boolean ç±»å‹çš„ <code>true</code>/<code>false</code>ã€‚</p>
<p>åœ¨ JavaScript ä¸­ï¼Œè¿™ææ˜“å¼•å‘ä¸¥é‡çš„ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// å‡è®¾ API è¿”å›æœªæ¶‰æ¡ˆï¼š<span class="hljs-attr">res.caseRelated</span> = <span class="hljs-string">"0"</span>

// âŒ é”™è¯¯å†™æ³•
if (res.caseRelated) {
    // åœ¨ JS ä¸­ï¼Œéç©ºå­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ "0"ï¼‰éƒ½è¢«è§†ä¸º trueï¼
    // ç»“æœï¼šæœ¬è¯¥æ”¾è¡Œçš„äº¤æ˜“è¢«è¯¯æ‹¦æˆª
    blockTransaction()<span class="hljs-comment">; </span>
}

// âœ… æ­£ç¡®å†™æ³•ï¼šæ˜¾å¼æ¯”è¾ƒ
const <span class="hljs-attr">isCriminal</span> = res.caseRelated === <span class="hljs-string">'1'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">isFraud</span> = res.fraudTrans === <span class="hljs-string">'1'</span><span class="hljs-comment">;</span>

if (isCriminal || isFraud) {
    blockTransaction()<span class="hljs-comment">;</span>
}
</code></pre>
<p><strong>å»ºè®®</strong>ï¼šåœ¨ Service å±‚è®¾è®¡ä¸€ä¸ª <code>adapter</code>ï¼ˆé€‚é…å™¨ï¼‰ï¼Œå°† API è¿”å›çš„åŸå§‹æ•°æ®æ¸…æ´—ä¸ºæ ‡å‡†çš„ Boolean å€¼ï¼Œä¸è¦è®©è„æ•°æ®æ±¡æŸ“ä¸šåŠ¡é€»è¾‘å±‚ã€‚</p>
<h2 data-id="heading-5">å››ã€ æ¶æ„è¿›é˜¶ï¼šNode.js + Serverless</h2>
<p>Node.js çš„å†·å¯åŠ¨é€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½ï¼Œä½¿å…¶æˆä¸º <strong>Serverlessï¼ˆæ— æœåŠ¡å™¨æ¶æ„ï¼‰</strong> çš„ç»ä½³æ‹æ¡£ã€‚</p>
<h3 data-id="heading-6">4.1 åœºæ™¯ï¼šAPI ç½‘å…³å‰ç½®å®ˆå«</h3>
<p>ä¼ ç»Ÿçš„é£æ§å¾€å¾€åµŒå…¥åœ¨å•ä½“åº”ç”¨ä¸­ï¼Œå¯¼è‡´ä¸šåŠ¡ä»£ç è‡ƒè‚¿ã€‚æˆ‘ä»¬å¯ä»¥å°†é£æ§é€»è¾‘æŠ½ç¦»ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ <strong>AWS Lambda</strong> æˆ– <strong>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ˆFCï¼‰</strong> ã€‚</p>
<ul>
<li>
<p><strong>æµç¨‹</strong>ï¼š<code>å®¢æˆ·ç«¯ -&gt; API ç½‘å…³ -&gt; é£æ§äº‘å‡½æ•° -&gt; ä¸šåŠ¡æœåŠ¡å™¨</code></p>
</li>
<li>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li><strong>éš”ç¦»æ€§</strong>ï¼šå¦‚æœé£æ§ API å“åº”å»¶è¿Ÿï¼Œåªä¼šé˜»å¡ç½‘å…³å±‚ï¼Œä¸ä¼šæ‹–å®æ ¸å¿ƒä¸šåŠ¡æœåŠ¡çš„çº¿ç¨‹æ± ã€‚</li>
<li><strong>æˆæœ¬ä¼˜åŒ–</strong>ï¼šé£æ§è°ƒç”¨é€šå¸¸æ˜¯ä½é¢‘é«˜å¹¶å‘ï¼ˆå¦‚çªå‘å¤§é¢äº¤æ˜“ï¼‰ï¼ŒServerless æŒ‰è°ƒç”¨æ¬¡æ•°è®¡è´¹ï¼Œæ¯”é•¿æœŸç»´æŠ¤ä¸€å° EC2/ECS æœåŠ¡å™¨æ›´åˆ’ç®—ã€‚</li>
<li><strong>å®‰å…¨é˜»æ–­</strong>ï¼šè‹¥äº‘å‡½æ•°æ£€æµ‹åˆ° <code>caseRelated === '1'</code>ï¼Œç›´æ¥è¿”å› HTTP 403ï¼Œæ¶æ„æµé‡æ ¹æœ¬æ¥è§¦ä¸åˆ°ä½ çš„æ ¸å¿ƒæ•°æ®åº“ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-7">4.2 åœºæ™¯ï¼šStream æµå¼æ¸…æ´—</h3>
<p>è´¢åŠ¡éƒ¨é—¨æœ‰æ—¶éœ€è¦æ¸…æ´—æ•°ä¸‡æ¡å­˜é‡æ•°æ®ï¼ˆExcel/CSVï¼‰ã€‚Node.js çš„ Stream API é…åˆ <code>Promise.all</code> æ˜¯å¤„ç†æ­¤ç±»ä»»åŠ¡çš„ç¥å™¨ã€‚</p>
<p>ä¸è¦ä¸€æ¬¡æ€§æŠŠ 10 ä¸‡æ¡æ•°æ®è¯»å…¥å†…å­˜ï¼ä½¿ç”¨ <code>fs.createReadStream</code> é…åˆ <code>csv-parser</code>ï¼Œæ¯æ¬¡å¹¶å‘å¤„ç† 5-10 ä¸ªè¯·æ±‚ï¼Œæ—¢èƒ½åˆ©ç”¨ API çš„å¹¶å‘èƒ½åŠ›ï¼Œåˆä¸ä¼šå¯¼è‡´ Node è¿›ç¨‹ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ã€‚</p>
<h2 data-id="heading-8">äº”ã€ æ€»ç»“</h2>
<p>é€šè¿‡ Node.js åŸç”Ÿæ¨¡å—å®ç° AES åŠ å¯†ï¼Œæˆ‘ä»¬æ— éœ€ä¾èµ–è‡ƒè‚¿çš„ç¬¬ä¸‰æ–¹åº“å³å¯å®‰å…¨å¯¹æ¥é‡‘èæ•°æ®ã€‚è€Œç»“åˆ JavaScript çš„å¼‚æ­¥ç‰¹æ€§ä¸ Serverless æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªè½»é‡ã€ä½æˆæœ¬ä¸”é«˜å¯ç”¨çš„æ”¯ä»˜é£æ§ç½‘å…³ã€‚</p>
<p>è®°ä½ï¼Œåœ¨å¤„ç†é‡‘é’±ç›¸å…³çš„é€»è¾‘æ—¶ï¼Œ<strong>ç±»å‹æ£€æŸ¥</strong>ï¼ˆæ³¨æ„ "0" æ˜¯ trueï¼‰å’Œ<strong>å¯†é’¥ç®¡ç†</strong>æ°¸è¿œæ˜¯é‡ä¸­ä¹‹é‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨â€œåˆ†åŒºâ€æ¥é¢å¯¹è¶…å¤§æ•°æ®é›†å’Œè¶…å¤§ååé‡]]></title>    <link>https://juejin.cn/post/7579451710302470170</link>    <guid>https://juejin.cn/post/7579451710302470170</guid>    <pubDate>2025-12-03T09:42:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579451710302470170" data-draft-id="7579255046980206618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨â€œåˆ†åŒºâ€æ¥é¢å¯¹è¶…å¤§æ•°æ®é›†å’Œè¶…å¤§ååé‡"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T09:42:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨â€œåˆ†åŒºâ€æ¥é¢å¯¹è¶…å¤§æ•°æ®é›†å’Œè¶…å¤§ååé‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:42:59.000Z" title="Wed Dec 03 2025 09:42:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. ä¸ºä»€ä¹ˆè¦åˆ†åŒºï¼Ÿ</h3>
<p><strong>åˆ†åŒºï¼ˆpartitionsï¼‰</strong> ä¹Ÿè¢«ç§°ä¸º <strong>åˆ†ç‰‡ï¼ˆshardingï¼‰</strong> ï¼Œé€šå¸¸é‡‡ç”¨å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºçš„æ–¹å¼æ¥å¢åŠ ç³»ç»Ÿçš„ <strong>å¯ä¼¸ç¼©æ€§</strong>ï¼Œä»¥æ­¤æ¥é¢å¯¹<strong>éå¸¸å¤§çš„æ•°æ®é›†æˆ–éå¸¸é«˜çš„ååé‡</strong>ï¼Œé¿å…å‡ºç°çƒ­ç‚¹ã€‚</p>
<p>åˆ†åŒºé€šå¸¸å’Œå¤åˆ¶ç»“åˆä½¿ç”¨ï¼Œä½¿å¾—æ¯ä¸ªåˆ†åŒºçš„å‰¯æœ¬å­˜å‚¨åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¿è¯æ•°æ®å‰¯æœ¬çš„ <strong>é«˜å¯ç”¨</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœæ•°æ®åº“è¢«åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ä¸ªä¸»åº“ã€‚ä¸åŒåˆ†åŒºçš„ä¸»åº“å¯èƒ½åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯èƒ½æ˜¯æŸäº›åˆ†åŒºçš„ä¸»åº“ï¼ŒåŒæ—¶æ˜¯å…¶ä»–åˆ†åŒºçš„ä»åº“ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42d9d47b5d5e49fe881575dbb10fdca2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359778&amp;x-signature=hjzRRLYRnn2WoGPxdb%2FeEQe9sic%3D" alt="åˆ†åŒºä¸å¤åˆ¶.png" loading="lazy"/></p>
<h4 data-id="heading-1">1.1 ä¸€è‡´å‰ç¼€è¯»</h4>
<p>åˆ†åŒºä¹Ÿä¼šç”±äºå¤åˆ¶å»¶è¿Ÿè€Œäº§ç”Ÿé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å›¾ä¸­çš„ä¾‹å­ï¼Œæ˜¯Poonså…ˆç”Ÿå’ŒCakeå°å§çš„å¯¹è¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1c05ea40e1e434f8a3d6bd6e51eb2dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359778&amp;x-signature=PpseAbZB5ZS3B5Z8Suvp9BXe42c%3D" alt="ä¸€è‡´å‰ç¼€è¯».png" loading="lazy"/></p>
<p>Poonså…ˆç”Ÿå…ˆé—®ï¼š "How far into the future can you see, Mrs.Cake?"</p>
<p>Cakeå°å§å›ç­”è¯´ï¼š "About ten seconds usually, Mr.Poons."</p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿™æ®µå¯¹è¯æ˜¯æœ‰å› æœå…³ç³»çš„ï¼ˆå…ˆé—®åç­”ï¼‰ã€‚ä½†æ˜¯å¯¹äºè§‚å¯Ÿè€…ï¼Œä»–çœ‹åˆ°çš„é¡ºåºå´æ˜¯å…ˆå¾—åˆ°äº†ç­”æ¡ˆï¼Œå†çœ‹åˆ°äº†é—®é¢˜ï¼Œè¿™å°±æ˜¯åœ¨åˆ†åŒºæ•°æ®åº“ä¸­ï¼Œå› å¤åˆ¶å»¶è¿Ÿè€Œäº§ç”Ÿçš„ç‰¹æ®Šæƒ…å†µã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ç§æ··ä¹±ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¿è¯ <strong>ä¸€è‡´å‰ç¼€è¯»</strong>ï¼šå¦‚æœä¸€ç³»åˆ—å†™å…¥æŒ‰æŸä¸ªé¡ºåºå‘ç”Ÿï¼Œé‚£ä¹ˆä»»ä½•äººè¯»å–è¿™äº›å†™å…¥æ—¶ï¼Œä¹Ÿä¼šçœ‹è§å®ƒä»¬ä»¥åŒæ ·çš„é¡ºåºå‡ºç°ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œç¡®ä¿ä»»ä½•å› æœç›¸å…³çš„å†™å…¥éƒ½åœ¨ç›¸åŒçš„åˆ†åŒºã€‚</p>
<h3 data-id="heading-2">2. è¯¥æ€ä¹ˆåˆ†åŒºï¼Ÿ</h3>
<p>åˆ†åŒºçš„ç›®çš„æ˜¯å°†æ•°æ®å’Œè´Ÿè½½å‡åŒ€çš„åˆ†å¸ƒåˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œç†è®ºä¸Š10ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿå¤„ç†10å€çš„æ•°æ®é‡å’Œ10å€å•èŠ‚ç‚¹çš„è¯»å†™ååé‡ã€‚</p>
<p>ä½†æ˜¯å¦‚æœåˆ†åŒºä¸å‡ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸€äº›åˆ†åŒºæœ‰æ›´å¤šçš„æ•°æ®æˆ–è¯»å†™ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <strong>åæ–œ</strong>ï¼Œè¿™ä¼šä½¿å¾—åˆ†åŒºåå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¤§çš„æ•ˆç‡æå‡ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è´Ÿè½½å¦‚æœéƒ½è½åœ¨ä¸€ä¸ªåˆ†åŒºï¼Œä½¿å¾—è¯¥åˆ†åŒºè´Ÿè½½è¿‡é«˜ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <strong>çƒ­ç‚¹</strong>ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸ºäº†é¿å…åæ–œå’Œçƒ­ç‚¹çš„äº§ç”Ÿï¼Œä»¥é”®å€¼æ•°æ®çš„åˆ†åŒºä¸ºä¾‹ï¼Œè®¨è®ºå¦‚ä½•å°†æ•°æ®åˆ†åŒºåšå¾—å¦¥å½“ã€‚</p>
<h4 data-id="heading-3">2.1 æ ¹æ®é”®çš„èŒƒå›´è¿›è¡Œåˆ†åŒº</h4>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ®é”®å€¼çš„èŒƒå›´è¿›è¡Œåˆ†åŒºï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬ä»¥26ä¸ªè‹±æ–‡å­—ç¬¦åˆ’åˆ†26ä¸ªåˆ†åŒºï¼Œä¹‹åæ ¹æ®é”®å€¼é¦–å­—æ¯å¯¹å®ƒä»¬è¿›è¡Œåˆ†åŒºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé”®å€¼å¹¶ä¸æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œè¿™ä¼šé€ æˆæŒ‰ç…§é¦–å­—æ¯åˆ†åŒºä¹‹åï¼Œå‘ç”Ÿæ•°æ®åæ–œã€‚ä¸ºäº†å‡åŒ€åˆ†é…æ•°æ®ï¼Œåˆ†åŒºçš„è¾¹ç•Œéœ€è¦æ ¹æ®æ•°æ®åˆ†åŒºçš„å®é™…æƒ…å†µå†è¿›è¡Œè°ƒæ•´ã€‚</p>
<h4 data-id="heading-4">2.2 æ•£åˆ—åˆ†åŒº</h4>
<p>ä¸€ä¸ªå¥½çš„æ•£åˆ—å‡½æ•°å¯ä»¥å°†æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œé¿å…å‘ç”Ÿåæ–œã€‚ä½†æ˜¯è¿™ä¹Ÿå¸¦æ¥äº†é—®é¢˜ï¼šæˆ‘ä»¬æ²¡æœ‰åŠæ³•å†è¿›è¡Œé«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢ã€‚</p>
<h3 data-id="heading-5">3. çƒ­ç‚¹æ¶ˆé™¤</h3>
<p>é¿å…çƒ­ç‚¹æœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†æ•°æ®è®°å½•è¿›è¡Œæ•£åˆ—åˆ†åŒºï¼Œè®°å½•å› æ­¤ä¼šåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå¹³å‡åˆ†é…ã€‚</p>
<p>ä½†æ˜¯å®ƒå¹¶ä¸èƒ½å®Œå…¨é¿å…çƒ­ç‚¹çš„äº§ç”Ÿï¼Œå› ä¸ºå¦‚æœæ‰€æœ‰çš„è¯»å†™æ“ä½œéƒ½æ˜¯é’ˆå¯¹åŒä¸€ä¸ªé”®çš„è¯ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¯·æ±‚è¿˜æ˜¯ä¼šè¢«è·¯ç”±åˆ°åŒä¸€ä¸ªåˆ†åŒºã€‚æ¯”å¦‚è¯´æœ‰ä¸€ä¸ªç™¾ä¸‡ç²‰ä¸çš„åšä¸»å‘å¸ƒåŠ¨æ€ï¼Œè¯¥åŠ¨æ€æ ¹æ®åšä¸»IDçš„é”®å€¼è¿›è¡Œåˆ†åŒºï¼Œå¦‚æœæ­¤æ—¶æœ‰å¤§é‡çš„ç²‰ä¸å¯¹è¯¥åŠ¨æ€è¿›è¡Œäº’åŠ¨ï¼Œé‚£ä¹ˆå“ˆå¸Œç­–ç•¥ä¼šæŠŠè¿™äº›è¯·æ±‚éƒ½è·¯ç”±åˆ°åŒä¸€ä¸ªåˆ†åŒºè¿›è¡Œæ“ä½œï¼Œå‘ç”Ÿçƒ­ç‚¹äº‹ä»¶ã€‚</p>
<p>å…¶å®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨è¯¥çƒ­ç‚¹é”®ä¸Šå†è¿›è¡Œåˆ†åŒºï¼Œä»¥é¿å…çƒ­ç‚¹ï¼šåœ¨ä¸»é”®çš„æœ€åæ‹¼æ¥éšæœºæ•°ï¼Œä¸¤ä½åè¿›åˆ¶çš„éšæœºæ•°å°±èƒ½æŠŠä¸€ä¸ªä¸»é”®åˆ†æˆ100ä¸ªä¸åŒçš„ä¸»é”®ï¼Œä»è€Œå­˜å‚¨åœ¨ä¸åŒçš„åˆ†åŒºä¸­ï¼Œè¿™å°±å®Œæˆäº†çƒ­ç‚¹æ¶ˆé™¤ã€‚ä½†æ˜¯ä¸»é”®è¢«åˆ†å‰²åï¼Œä»»ä½•è¯»å–å·¥ä½œéƒ½å¿…é¡»åœ¨æ¯æ¬¡è¯»å–æ—¶å°†æ‰€æœ‰çš„æ•°æ®æ‹‰å‡ºå»åˆå¹¶åˆ°ä¸€èµ·å†è¿”å›ç»“æœã€‚</p>
<h3 data-id="heading-6">4. åˆ†åŒºå†å¹³è¡¡</h3>
<p>å¦‚æœä¿å­˜æŸåˆ†åŒºæ•°æ®çš„æœåŠ¡å™¨æ•…éšœï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–æœåŠ¡å™¨æ¥ç®¡æˆ–æƒ³å°†ç›®å‰çš„æœåŠ¡å™¨æ¢æˆæ€§èƒ½æ›´å¥½çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œ <strong>åˆ†åŒºå†å¹³è¡¡</strong>ã€‚</p>
<p><strong>åˆ†åŒºå†å¹³è¡¡</strong> æ˜¯å°†è´Ÿè½½ä»é›†ç¾¤ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨çš„è¿‡ç¨‹ã€‚æ‰§è¡Œå†å¹³è¡¡éœ€è¦æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p>
<ul>
<li>å†å¹³è¡¡æœŸé—´ï¼Œæ•°æ®åº“åº”è¯¥ç»§ç»­æ¥å—è¯»å–å’Œå†™å…¥</li>
<li>èŠ‚ç‚¹ä¹‹é—´åªç§»åŠ¨å¿…é¡»çš„æ•°æ®ï¼Œä»¥ä¾¿å¿«é€Ÿå†å¹³è¡¡ï¼Œå¹¶å‡å°‘ç½‘ç»œå’Œç£ç›˜çš„IOè´Ÿè½½</li>
<li>å†å¹³è¡¡ä¹‹åï¼Œè´Ÿè½½åº”è¯¥åœ¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´å…¬å¹³åœ°å…±äº«</li>
</ul>
<p>æ¯”è¾ƒç®€å•çš„å†å¹³è¡¡åˆ†åŒºç­–ç•¥æ˜¯é€‰æ‹© <strong>å›ºå®šæ•°é‡çš„åˆ†åŒº</strong>ï¼Œå½“èŠ‚ç‚¹æ•°é‡å¢åŠ æ—¶ï¼Œå¯ä»¥ä»åŸèŠ‚ç‚¹ä¸­ <strong>çªƒå–</strong> ä¸€äº›åˆ†åŒºï¼ˆå½“èŠ‚ç‚¹æ•°é‡å‡å°‘æ—¶ï¼Œåˆ™å‘ç”Ÿç›¸åçš„æƒ…å†µï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27e8329b4c14681a033fa17b01d48e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359778&amp;x-signature=CEz4V3PO6zsRwUVIvX5j79H%2Fdjk%3D" alt="å›ºå®šæ•°é‡åˆ†åŒºå†å¹³è¡¡.png" loading="lazy"/></p>
<p>åœ¨è¿™ç§é…ç½®ä¸­ï¼Œåˆ†åŒºçš„æ•°é‡é€šå¸¸åœ¨æ•°æ®åº“ç¬¬ä¸€æ¬¡å»ºç«‹æ—¶ç¡®å®šï¼Œæ“ä½œæ¯”è¾ƒç®€å•ï¼Œä¹‹åä¸ä¼šæ”¹å˜ï¼Œå› æ­¤ä½ éœ€è¦é€‰æ‹©è¶³å¤Ÿå¤šçš„åˆ†åŒºä»¥é€‚åº”æœªæ¥çš„å¢é•¿ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªåˆ†åŒºä¹Ÿæœ‰ç®¡ç†å¼€é”€ï¼Œæ‰€ä»¥é€‰æ‹©å¤ªå¤§çš„æ•°å­—ä¼šé€‚å¾—å…¶åã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ä¹Ÿå¯é€‰æ‹© <strong>åŠ¨æ€åˆ†åŒº</strong>ï¼Œæ ¹æ®é…ç½®çš„åˆ†åŒºå¤§å°ï¼Œå½“è¶…è¿‡è¯¥é˜ˆå€¼æ—¶ï¼Œå¯ä»¥å°†è¯¥å¤§åˆ†åŒºåˆ†å‰²æˆä¸¤ä¸ªå°åˆ†åŒºï¼Œèƒ½å¤Ÿä½¿ <strong>åˆ†åŒºæ•°é‡é€‚åº”æ€»æ•°æ®é‡</strong>ã€‚åœ¨å¤§å‹åˆ†åŒºæ‹†åˆ†åï¼Œå¯ä»¥å°†å…¶ä¸­çš„ä¸€åŠè½¬ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä»¥å¹³è¡¡è´Ÿè½½ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§ <strong>æ ¹æ®èŠ‚ç‚¹æ•°å¢åŠ æ¥è¿›è¡Œåˆ†åŒº</strong> çš„æ–¹æ³•ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰å›ºå®šçš„åˆ†åŒºæ•°ï¼Œå½“èŠ‚ç‚¹å¢åŠ æ—¶ï¼Œåˆ†åŒºå°†å˜å°ï¼Œæ–°å¢çš„èŠ‚ç‚¹ä¼šä»åŸæœ‰èŠ‚ç‚¹çš„åˆ†åŒºä¸­éšæœºè¿›è¡Œæ‹†åˆ†ï¼Œæœ€ç»ˆè¿™ä¸ªæ–°èŠ‚ç‚¹è·å¾—å…¬å¹³çš„è´Ÿè½½ä»½é¢ã€‚</p>
<p>åˆ†åŒºå†å¹³è¡¡å¯ä»¥ <strong>æ‰‹åŠ¨æ‰§è¡Œ</strong> ä¹Ÿå¯ä»¥ <strong>è‡ªåŠ¨æ‰§è¡Œ</strong>ã€‚è‡ªåŠ¨å†å¹³è¡¡æ¯”è¾ƒæ–¹ä¾¿ï¼Œå› ä¸ºä¸éœ€è¦äººå·¥ç»´æŠ¤ï¼Œä½†æ˜¯å®ƒçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä¸å¯é¢„æµ‹çš„ï¼šå†å¹³è¡¡æ—¶å°†å¤§é‡æ•°æ®é›†ä»ä¸€ä¸ªèŠ‚ç‚¹è½¬ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤§çš„ç½‘ç»œå¼€é”€ï¼Œè¿™ä¼šä½¿å¾—è¯¥æœåŠ¡å™¨å¯¹è¯·æ±‚å“åº”çš„æ€§èƒ½é™ä½ï¼Œå¯¹ç”¨æˆ·çš„ä½“éªŒå’Œç”Ÿäº§é€ æˆè´Ÿé¢å½±å“ã€‚æ‰€ä»¥å†å¹³è¡¡çš„è¿‡ç¨‹æœ‰äººå‚ä¸æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œè¿™æ ·èƒ½é˜²æ­¢å‘ç”Ÿè¿ç»´é—®é¢˜ã€‚</p>
<h3 data-id="heading-7">5. è¯·æ±‚è·¯ç”±ï¼ˆæœåŠ¡å‘ç°ï¼‰</h3>
<p>å½“æˆ‘ä»¬å·²ç»å°†æ•°æ®è¿›è¡Œåˆ†åŒºåï¼Œå¦‚ä½•æ‰èƒ½çŸ¥é“ç”¨æˆ·æƒ³è¦çš„æ•°æ®åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Ÿè¿™å¯ä»¥æ¦‚æ‹¬ä¸ºæ˜¯ä¸€ä¸ª <strong>æœåŠ¡å‘ç°</strong> çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸‰ä¸ªæ–¹æ¡ˆ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b87192d8ea8407d9856ccf677af8cd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359778&amp;x-signature=TGxWKVi3aJfYUQlzntbqL1pVTZ0%3D" alt="æœåŠ¡å‘ç°.png" loading="lazy"/></p>
<ol>
<li>å…è®¸è®¿é—®æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œå¦‚æœç¬¬ä¸€ä¸ªè®¿é—®çš„èŠ‚ç‚¹æœ‰è¯¥é”®å€¼ï¼Œåˆ™å¤„ç†è¯¥è¯·æ±‚ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬å‘åˆ°é€‚å½“çš„èŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•é¿å…äº†ä½¿ç”¨æ³¨å†Œä¸­å¿ƒä¸­é—´ä»¶ï¼Œä½†æ˜¯å®ç°æ¯”è¾ƒå¤æ‚</li>
<li>ä½¿ç”¨åˆ†å¸ƒå¼çš„åè°ƒæœåŠ¡ï¼Œç”¨æˆ·å°†æ‰€æœ‰çš„è¯·æ±‚å‘é€åˆ°è·¯ç”±å±‚ï¼Œç”±è·¯ç”±å±‚å°†è¯¥è¯·æ±‚è½¬å‘åˆ°åˆé€‚çš„èŠ‚ç‚¹</li>
<li>è¦æ±‚ç”¨æˆ·ï¼ˆå®¢æˆ·ç«¯ï¼‰è‡ªå·±çŸ¥é“åˆ†åŒºå’ŒèŠ‚ç‚¹çš„åˆ†é…</li>
</ol>
<p>ä½†æ˜¯è¿™å…¶ä¸­è¿˜éšè—ç€ä¸€ä¸ªé—®é¢˜ï¼š<strong>ä½œå‡ºå†³ç­–çš„ç»„ä»¶ï¼ˆèŠ‚ç‚¹ä¹‹ä¸€ã€è·¯ç”±å±‚æˆ–å®¢æˆ·ç«¯ï¼‰æ˜¯å¦‚ä½•äº†è§£æ•°æ®åœ¨èŠ‚ç‚¹é—´çš„åˆ†é…å˜åŒ–çš„</strong>ï¼Ÿè¿™å°±éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„åè°ƒæœåŠ¡ï¼Œæ¯”å¦‚ä½¿ç”¨ zookeeper æ¥è·Ÿè¸ªå…ƒæ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07a0a953e36c490091340d0925843afb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359778&amp;x-signature=0d%2Fya2dm4G8LIQJscxC8jZjh8hA%3D" alt="zookeeperç®¡ç†è·¯ç”±å…ƒæ•°æ®.jpeg" loading="lazy"/></p>
<p>æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šåœ¨ zookeeper ä¸­è¿›è¡Œæ³¨å†Œï¼Œzookeeper ä¸­ç»´æŠ¤æœ‰èŠ‚ç‚¹åˆ°å„ä¸ªåˆ†åŒºçš„å¯é æ˜ å°„ï¼Œè´Ÿè´£å†³ç­–çš„ç»„ä»¶åœ¨ zookeeper ä¸­è®¢é˜…è¿™ä¸ªæ¶ˆæ¯ã€‚å½“åˆ†åŒºåˆ†é…å‘ç”Ÿæ”¹å˜æ—¶ï¼Œzookeeper å°±ä¼šé€šçŸ¥è´Ÿè´£å†³ç­–çš„ç»„ä»¶æ›´æ–°è·¯ç”±ä¿¡æ¯ï¼Œä½¿å…¶ä¿æŒåœ¨æœ€æ–°çš„çŠ¶æ€ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ä¹Ÿå¯ä»¥åœ¨å„ä¸ªèŠ‚ç‚¹é—´é‡‡ç”¨ <strong>æµè¨€åè®®</strong> æ¥ä¼ æ’­é›†ç¾¤çŠ¶æ€çš„å˜åŒ–ï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤æœ‰æœ€æ–°çš„æ•°æ®è·¯ç”±æ–¹æ¡ˆï¼Œå½“å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šå°†å…¶è½¬å‘åˆ°åˆé€‚çš„åˆ†åŒºèŠ‚ç‚¹ä¸Šï¼ˆå¯¹åº”æœåŠ¡å‘ç°çš„æ–¹æ¡ˆä¸€ï¼‰ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®å‰‘é”‹ä»ç£¨ç ºå‡ºâ€”â€”é›¶å”®æ•°æ®åº“å†…æ ¸ï¼Œä¸ºå¤§ä¿ƒé“¸å‰‘ï¼]]></title>    <link>https://juejin.cn/post/7579427549471834158</link>    <guid>https://juejin.cn/post/7579427549471834158</guid>    <pubDate>2025-12-03T09:43:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579427549471834158" data-draft-id="7579451710302486554" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®å‰‘é”‹ä»ç£¨ç ºå‡ºâ€”â€”é›¶å”®æ•°æ®åº“å†…æ ¸ï¼Œä¸ºå¤§ä¿ƒé“¸å‰‘ï¼"/> <meta itemprop="keywords" content="æ•°æ®åº“,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T09:43:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®å‰‘é”‹ä»ç£¨ç ºå‡ºâ€”â€”é›¶å”®æ•°æ®åº“å†…æ ¸ï¼Œä¸ºå¤§ä¿ƒé“¸å‰‘ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:43:35.000Z" title="Wed Dec 03 2025 09:43:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»25åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>ç™¸å¯ä¸ƒæœˆé£é›¨å¤§ä½œ</em></p>
<p><em>äº¬ä¸œé›¶å”®Â·è¢åšæ–‡</em></p>
<p><em>åƒµå§åŒä¹ä¸è‡ªå“€ï¼Œå°šæ€ä¸ºä¸œæˆè½®å°ã€‚</em></p>
<p><em>å¤œé˜‘å§å¬çŠç‘šé›¨ï¼Œé“é©¬å†…æ ¸å…¥æ¢¦æ¥ã€‚</em></p>
<p>ï»¿<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13c59c3cb53d4c5f8fa219972699b8d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359814&amp;x-signature=GlUOtsjvugAgnsd65OQfluDn8V0%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p><em><strong>å‰è¨€ç•¥é•¿ï¼Œåªå…³å¿ƒæŠ€æœ¯çš„åŒå­¦å¯ç›´æ¥è·³è¿‡çœ‹ç¬¬äºŒç« </strong></em></p>
<h2 data-id="heading-0"><strong>ä¸€ã€å‰è¨€ï¼šæŠ€æœ¯çš„åº•è‰²æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h2>
<p>è¿™ä¸ªé—®é¢˜åœ¨æŠ€æœ¯äººå¿ƒä¸­å…¶å®æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œæ¯ä¸ªäººéƒ½æœ‰æ¯ä¸ªäººçš„è§è§£ã€‚æ¶æ„å¸ˆçœ¼é‡Œå¤§æŠµæ˜¯é«˜å±‹å»ºç“´ï¼Œç»Ÿé¢†å…¨å±€ï¼›æŠ€æœ¯å¤§ç‰›çš„è§†è§’å¯èƒ½æ˜¯å‰–æ ¹æº¯æºï¼Œç²¾åˆ€ç»†ç¢ï¼›æ–°äººå°ç™½æˆ–è®¸æ›´å•çº¯ï¼Œæ— éå°±æ˜¯å­¦ä¹ è¿›æ­¥ï¼Œå¿«é€Ÿæˆé•¿ä¸ºå¤§ç‰›ä¹‹ç±»äº†ã€‚</p>
<p>ä½†åœ¨æˆ‘â€”â€”ä¸€ä¸ªäº¬ä¸œæ•°æ®åº“äººçš„çœ¼é‡Œï¼ŒæŠ€æœ¯çš„åº•è‰²æˆ–è®¸åº”è¯¥æ˜¯äº”å½©æ–‘æ–“çš„å§ã€‚</p>
<h4 data-id="heading-1"><strong>ç™½æ˜¯çº¯ç²¹çš„èµ·ç‚¹</strong></h4>
<p>ç»å¸¸å¬äººè¯´ï¼Œæ¯ä¸ªäººå‘±å‘±å åœ°é‚£ä¸€åˆ»ï¼Œéƒ½æ˜¯ä¸€å¼ ç™½çº¸ï¼Œçˆ¶æ¯åœ¨å…¶ä¸Šç€å¢¨ã€‚å¯¹äºæŠ€æœ¯äººæ¥è¯´åˆä½•å°ä¸æ˜¯å‘¢ï¼Ÿåˆå­¦ä¸€é—¨æŠ€æœ¯ï¼Œåˆå…¥ä¸€ä¸ªé¢†åŸŸï¼Œæ¯ä¸ªäººéƒ½æ˜¯ä¸€å¼ ç™½çº¸ï¼Œåœ¨è¿™å¼ ç™½çº¸ä¸Šæ˜¯éšæ„è‰ç¨¿æ¶‚é¸¦ï¼Œè¿˜æ˜¯è®¤çœŸå¸æ”¶ä¸æ–­è¿›æ­¥ï¼Œéƒ½å–å†³äºè‡ªå·±ã€‚</p>
<p>æ•°æ®åº“å†…æ ¸æŠ€æœ¯ï¼Œåœ¨ 2020 å¹´åˆï¼Œäºæˆ‘ä¸ªäººäºå†…æ ¸å›¢é˜Ÿäºäº¬ä¸œè€Œè¨€éƒ½æ˜¯ä¸€ä¸ªçº¯ç™½çš„èµ·ç‚¹ã€‚è‡ªæ­¤å¼€å§‹æ¢ç´¢æ•°æ®åº“å†…æ ¸çš„æ¯ä¸€è¡Œæºç ã€æ¯ä¸€ä¸ªæ¨¡å—ï¼Œç„¶åæ”»å…³ç ”ç©¶æ¯ä¸€ä¸ªæŠ€æœ¯éš¾ç‚¹ï¼Œå†è®¾è®¡å®ç°äº‘åŸç”Ÿçš„çŠç‘šæ•°æ®åº“ç›´åˆ°å…¶è½åœ°æ‰¿æ¥ä¸šåŠ¡ã€‚æˆ‘å’Œæˆ‘ä»¬å›¢é˜Ÿçš„å°ä¼™ä¼´éƒ½å¯ä»¥æ‹ç€èƒ¸è„¯è¯´ï¼Œæˆ‘ä»¬æ— æ„§äºäº¬ä¸œï¼Œæ— æ„§äºè¿™ä»½çº¯ç™½ã€‚</p>
<h4 data-id="heading-2"><strong>é’æ˜¯æœæ°”æ˜¯æˆé•¿</strong></h4>
<p>å†…æ ¸å›¢é˜Ÿæ¯ä¸€ä¸ªå°ä¼™ä¼´ï¼Œä¸è®ºæ˜¯ç¤¾æ‹›è¿˜æ˜¯æ ¡æ‹›ï¼Œéƒ½æ˜¯é‚£ä¹ˆæœæ°”è“¬å‹ƒï¼Œéƒ½å¯¹æ•°æ®åº“å†…æ ¸æŠ€æœ¯æ±‚çŸ¥è‹¥æ¸´ã€‚è…¾é¾™è®¤çœŸé’»ç ”æ¢ç´¢ï¼ŒæˆåŠŸæ‰“é€šäº†æ•°æ®åº“æµ‹è¯•ç”¨ä¾‹çº¿ä¸Šéƒ¨ç½²å’Œåˆå§‹çš„å†…æ ¸ç›‘æ§æ¡†æ¶ï¼›ç¦å“¥å°†åä¸ºçš„ä¼˜è‰¯ç¼–ç é£æ ¼å¸¦å…¥å›¢é˜Ÿå¹¶å½±å“äº†è®¸å¤šå°ä¼™ä¼´ï¼Œè¿˜åœ¨DDLæ¨¡å—é’»ç ”å¹¶é¢‡æœ‰é€ è¯£ï¼›æµ·é¹æ¢ç´¢å¹¶æ‰“é€šäº†å†…æ ¸ä¸JEDæ¥å£ï¼Œä¸ºé«˜å¯ç”¨ä»˜å‡ºè‰¯å¤šï¼›é‡‘è“¬åˆå…¥å›¢é˜Ÿï¼Œç”šè‡³è¿æŠ€æœ¯æ ˆéƒ½æ˜¯åˆå­¦ï¼ŒæŠ±ç€ä¸€æœ¬ç»å…¸çš„ã€Š<em>C++ Primer</em>ã€‹è¾¹å•ƒè¾¹ç ”ç©¶çŠç‘šæ•°æ®åº“å†…æ ¸æºç ï¼Œä½†ä¸å¦¨ç¢è¿›æ­¥é€Ÿåº¦æƒŠäººï¼Œæœ€ç»ˆèƒ½å¤Ÿç‹¬å½“ä¸€é¢ï¼›æµ·æ³¢æ”»å…³çš„ä¿®æ”¹ç¼“å†²å½±å­é¡µæŠ€æœ¯ä»¥åŠå…±äº«é›†ç¾¤æµ‹è¯•æ¡†æ¶è‡³ä»Šè¿˜åœ¨æŒç»­å¸¦æ¥ä»·å€¼ï¼›çŠå“¥å’Œé½å“¥æ›´ä¸ç”¨è¯´ï¼Œä¸€ä¸ªå°†å¤šå¹´ç§¯ç´¯çš„å¼€å‘ç»éªŒä¸çŠç‘šæ•°æ®åº“å†…æ ¸æ¨¡å—æ·±å…¥ç»“åˆï¼Œåšå‡ºäº†è¯¸å¤šè´¡çŒ®ï¼›å¦ä¸€ä¸ªä¸ä½†å¯¹å…ƒæ•°æ®é”ç ”ç©¶é€å½»ï¼Œæ›´æ˜¯ç‹¬è‡ªä¸€äººæ‰¿æ‹…äº†æ•´ä¸ªçŠç‘šæ•°æ®åº“çš„å·¥ç¨‹åŒ–è½åœ°ä¸é«˜å¯ç”¨åŠè¿ç»´å·¥å…·å»ºè®¾ã€‚ä½œä¸ºæ ¡æ‹›ç”Ÿçš„å½­å‡¯å’Œå®‡æ­†ï¼Œæ›´æ˜¯åœ¨çŸ­çŸ­çš„æ—¶é—´å†…ï¼Œè¿…é€Ÿæˆé•¿ï¼Œæ·±å…¥ç ”ç©¶SQLè¯æ³•å’Œè¯­æ³•è§£æï¼Œä»¥åŠä¸»ä»å¤åˆ¶æ¨¡å—ï¼Œå¹¶ä¸ºæ–°äº§å“çš„é“¸å‰‘åšå‡ºäº†çªå‡ºçš„è´¡çŒ®ã€‚ç°åœ¨ï¼Œè¶Šæ¥è¶Šå¤šçš„æœæ°”è“¬å‹ƒçš„æ–°ä¼™ä¼´é™†ç»­åŠ å…¥äº†æˆ‘ä»¬å›¢é˜Ÿï¼Œå¤§å®¶çš„å¿«é€Ÿæˆé•¿éƒ½æœ‰ç›®å…±ç¹ã€‚</p>
<p>å¤§å®¶éƒ½ä»å½“åˆçš„é’æ¶©å°ç™½ï¼Œæˆé•¿æˆäº†å„ä¸ªå†…æ ¸é¢†åŸŸçš„ä¸“å®¶ï¼Œæˆ–è€…ç‹¬å½“ä¸€é¢çš„äººæ‰ã€‚æ‰€ä»¥é’è¿™ä¸ªåº•è‰²ï¼Œä¸€å®šæ˜¯æŠ€æœ¯äººåŠªåŠ›æˆé•¿ï¼Œæ‹¼æå‘ä¸Šçš„é¢œè‰²å§ã€‚</p>
<h4 data-id="heading-3"><strong>é»„æ˜¯æœ€åçš„æ‰§ç€</strong></h4>
<p>åœ¨çœ¼çœ‹äº¬ä¸œæ•°æ®åº“å†…æ ¸å›¢é˜Ÿè’¸è’¸æ—¥ä¸Šï¼Œå¤§å®¶åœ¨å†…æ ¸é¢†åŸŸæ—¥æ¸æ·±è€•çš„æ—¶å€™ï¼Œä¸å‡ºæ„å¤–çš„è¿˜æ˜¯å‡ºæ„å¤–äº†â€¦â€¦</p>
<p>é›†å›¢å±‚é¢çš„æ¶æ„è°ƒæ•´ï¼Œè®©é›¶å”®å’Œç§‘æŠ€çš„æŠ€æœ¯å›¢é˜Ÿä¸å¾—ä¸èåˆæˆä¸€ä¸ªå›¢é˜Ÿäº†ï¼Œæˆ‘æƒ³åˆè¡·è‚¯å®šæ˜¯å¥½çš„ï¼Œå¤§å®¶ä¹Ÿéƒ½ä¸ºä¹‹åŠªåŠ›è¿‡ã€‚ä½†å‡ºäºç§ç§ä¸ä¾¿æ˜è¯´çš„åŸå› ï¼Œæ•°æ®åº“å†…æ ¸å›¢é˜Ÿæˆäº†å¤§çš„æ¶æ„é½¿è½®ç£¨åˆä¸‹çš„é‚£ä¸ªä»£ä»·ï¼Œå›¢é˜ŸåŠ¨è¡ï¼Œæœªæ¥ä¸æ˜ï¼Œæ— å¥ˆä¹‹ä¸‹è®¸å¤šåˆéœ²é”‹èŠ’çš„ä¼˜ç§€å°ä¼™ä¼´ä¸å¾—ä¸åšå‡ºå„è‡ªçš„é€‰æ‹©ã€‚å°±åœ¨æˆ‘ä»¥ä¸ºäº¬ä¸œæ•°æ®åº“å†…æ ¸å°±è¦é»„äº†çš„æ—¶å€™ï¼Œä¸å¹¸ä¸­çš„ä¸‡å¹¸ï¼Œåœ¨é›¶å”®ä¼—å¤šå¤§ä½¬åŒäº‹çš„å…¨åŠ›ä¿æŠ¤ä¸‹ï¼Œå†…æ ¸çš„ç§å­ç•™äº†ä¸‹æ¥ï¼Œé™å¾…èŠ±å¼€ã€‚è€Œå±äºæŠ€æœ¯äººçš„è¿™ä»½åšå®ˆï¼Œæˆ–è®¸å°±åƒé¹…åµé»„ä¸€æ ·ï¼Œç­‰å¾…ç ´å£³é‡ç”Ÿçš„é‚£ä¸€åˆ»å§ã€‚</p>
<h4 data-id="heading-4"><strong>èµ¤æ˜¯å¯¹æŠ€æœ¯çš„çƒ­å¿±</strong></h4>
<p>å¦‚æœå¸Œæœ›æœ‰é¢œè‰²ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯çº¢è‰²ï¼</p>
<p>å°±åƒèµ¤è‰²å½“å¹´å§è–ªå°èƒ†ï¼Œè‰°è‹¦å¥‹æ–—ï¼Œçˆ¬é›ªå±±è¿‡è‰åœ°ï¼ŒæŠŠå¸Œæœ›å¸¦ç»™ç¥å·å¤§åœ°ä¸€æ ·ã€‚å±äºäº¬ä¸œæŠ€æœ¯çš„èµ¤è‰²ï¼Œä¹Ÿåœ¨äº¬ä¸œæŠ€æœ¯ä¸­å¿ƒè¿æ¥æ–°çš„å¤§å®¶é•¿åéšä¹‹åˆ°æ¥ã€‚æˆ‘ä¸çŸ¥é“å…¶ä»–å›¢é˜Ÿæ˜¯ä¸æ˜¯æœ‰ç±»ä¼¼çš„æ„Ÿå—ï¼Œä½†æ•°æ®åº“å›¢é˜Ÿåœ¨å›å½’é›¶å”®ä»¥åï¼Œå¤§å®¶çš„å¿ƒæ°”ç¥éƒ½ä¸ä¸€æ ·äº†ï¼Œå¯¹æŠ€æœ¯é‚£é¢—ç«çƒ­çš„å¿ƒåˆé‡æ–°ç‡ƒäº†èµ·æ¥ã€‚æ•°æ®åº“å›¢é˜Ÿä¹Ÿè¿æ¥äº†æ–°leaderï¼šä¸€ä½åœ¨æ•°æ®åº“é¢†åŸŸæœ‰ç€äºŒåå¹´ç»éªŒçš„è¶…çº§å¤§ä½¬å’Œä¸€ä½åœ¨æ•°æ®åº“å†…æ ¸é¢†åŸŸæœ‰åå¤šå¹´ç»éªŒçš„èµ„æ·±å¤§ä½¬ã€‚åœ¨ä¸¤ä½å¤§ä½¬çš„å¸¦é¢†ä¸‹ï¼Œæˆ‘ä»¬å¼€å§‹æœç€æ–°çš„æ–¹å‘å‰è¿›ã€‚</p>
<p>åŒæ—¶ï¼Œæ•°æ®åº“å†…æ ¸å›¢é˜Ÿä¹Ÿå¾ˆå¿«è¿æ¥äº†è¶Šæ¥è¶Šå¤šçš„æ–°é²œè¡€æ¶²ï¼šæ¥è‡ªå…¶ä»–å¤§å‚çš„æ—åº·ã€æ­£èŒ‚ã€å¼ æ‰¬ï¼Œå°†ä»–ä»¬æ‰€æŒæ¡çš„æ•°æ®åº“å†…æ ¸ä»¥åŠå·¥ç¨‹åŒ–ç»éªŒå¼•å…¥ï¼Œä¸ºæˆ‘ä»¬å†…æ ¸çš„ç ”å‘è£…ä¸Šäº†åŠ é€Ÿå™¨ï¼›æ¥è‡ªå„å¤§åç‰Œé«˜æ ¡çš„æ ¡æ‹›ç”Ÿä»¥åŠå®ä¹ ç”Ÿæ™“å†°ã€æ±Ÿæ˜Šã€ä¸€è´¤ã€ç¥–æ‰ç­‰ç­‰ï¼Œä¹Ÿéƒ½å¿«é€Ÿå­¦ä¹ è¿…é€Ÿæˆé•¿ï¼Œä»¥æœ€é¥±æ»¡çš„çƒ­æƒ…èå…¥æˆ‘ä»¬å›¢é˜Ÿå¹¶åšå‡ºäº†ç›¸åº”çš„è´¡çŒ®ã€‚</p>
<p>å¤§å®¶éƒ½é¥±å«èµ¤è¯šï¼Œæºæ‰‹å¼€å§‹å‘æœªæ¥è¿›å‘ï¼</p>
<h4 data-id="heading-5"><strong>é»‘æ˜¯äº”å½©æ–‘æ–“çš„æœªæ¥</strong></h4>
<p>å§‹äºç™½ï¼Œç»ˆäºé»‘ã€‚å°±åƒå¤ªæé˜´é˜³é±¼ä¸€æ ·ï¼Œç”Ÿç”Ÿä¸æ¯ï¼Œå‘¨è€Œå¤å§‹ã€‚æŠ€æœ¯ä¹Ÿä¸€æ ·ï¼</p>
<p>è‡ªç„¶ç•Œå½“æ‰€æœ‰çš„é¢œè‰²æ··åœ¨ä¸€èµ·åï¼Œåªæœ‰ä¸€ä¸ªé¢œè‰²â€”â€”é»‘ã€‚æ•°æ®åº“å†…æ ¸çš„å›¢é˜Ÿä¹Ÿåœ¨æ²‰æ·€å’ŒæŒ«æŠ˜ä¸­æ›´åŠ å¼ºå¤§ï¼Œéšç€ä¸æ–­è¡¥å……æ–°é²œçš„è¡€æ¶²ï¼Œä»å¸‚åœºä¸Šå¸å¼•æ›´å¤šä¼˜ç§€çš„æ•°æ®åº“å†…æ ¸äººæ‰ï¼Œå½“æ‰€æœ‰æŠ€æœ¯çš„åº•è‰²æ··åœ¨ä¸€èµ·åï¼Œæ‰€æœ‰çš„äº”å½©æ–‘æ–“ï¼Œæ‰€æœ‰çš„åˆå¿ƒã€æˆé•¿ã€åšå®ˆã€å¸Œæœ›èä¸ºä¸€ä½“åï¼Œæ‰€æœ‰çš„ä¸åŒé¢†åŸŸçš„äººæ‰é½å¿ƒååŠ›å…±æ¸¡éš¾å…³åï¼Œé‚£ç»“åˆåœ¨ä¸€èµ·çš„åŠ›é‡ï¼Œå…¶å®å°±åªå‰©ä¸‹æœªæ¥é‚£æ— é™çš„å¯èƒ½â€”â€”äº”å½©æ–‘æ–“çš„é»‘ã€‚å†…æ ¸æŠ€æœ¯çš„æ·±æ¸Šä¹Ÿå¦‚é»‘æ´èˆ¬ï¼Œæ·±ä¸è§åº•ï¼Œç­‰å¾…æˆ‘ä»¬å»æ¢ç´¢ã€‚ä½†æˆ‘ç›¸ä¿¡ï¼Œåªè¦æˆ‘ä»¬ç§‰æŒæŠ€æœ¯äººçš„åº•è‰²ï¼Œå°±ä¸€å®šå¯ä»¥è¾¾åˆ°é‚£ä¸ªå½¼å²¸ï¼</p>
<h2 data-id="heading-6"><strong>äºŒã€æ­£ç¯‡ï¼šäº”å½©ç†”ç‚‰ï¼Œé“¸å‰‘ï¼</strong></h2>
<p>æ­£ç¯‡å¼€å§‹ï¼</p>
<p>æŠ±æ­‰å¤§å®¶ï¼Œå‰é¢æ‰¯äº†è¿™ä¹ˆå¤šå…¶å®åªæ˜¯å‰è¨€ã€‚ä½†æˆ‘åˆä¸æƒ³åƒä»¥å‰å†™å‰è¨€é‚£æ ·ï¼Œåªæ˜¯ç®€å•çš„äº¤ä»£ä¸€ä¸‹èƒŒæ™¯ã€‚èŠ±äº†äº”èŠ‚çš„ç¬”å¢¨ä»‹ç»æˆ‘å¿ƒä¸­çš„æŠ€æœ¯åº•è‰²ï¼Œåªå¸Œæœ›å¤§å®¶èƒ½æ‡‚ä¸€ç‚¹â€”â€”æˆ‘ä»¬ä¼šä»¥æœ€å¤§çš„çƒ­æƒ…å’Œæœ€å¼ºçš„æŠ€æœ¯ä¸ºäº¬ä¸œæ‰“é€ åŸºç¡€æ•°æ®åº“äº§å“ï¼Œä¸ºå¤§å®¶å¸¦æ¥æ›´ä¼˜è´¨çš„æ•°æ®åº“æœåŠ¡ã€‚</p>
<h4 data-id="heading-7"><strong>åˆ°åº•é“¸äº†ä»€ä¹ˆå‰‘ï¼Ÿ</strong></h4>
<p>å±äºæˆ‘ä»¬äº¬ä¸œç”µå•†ç‰ˆæœ¬çš„è‡ªç ”æ•°æ®åº“å†…æ ¸â€”â€”DongSQLï¼</p>
<p>äº”å¹´å‰ï¼Œæ•°æ®åº“å†…æ ¸å›¢é˜Ÿç«‹é¡¹ç›´æ¥ç„å‡†äº†æ–°çš„æ•°æ®åº“å½¢æ€â€”â€”äº‘åŸç”Ÿå…³ç³»å‹æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯å­˜ç®—åˆ†ç¦»å…±äº«å­˜å‚¨æ¶æ„çš„çŠç‘šæ•°æ®åº“(shared storage)ï¼Œè¿™ä¸€ç‰ˆæŠ€æœ¯éš¾ç‚¹ä¸»è¦æ˜¯åœ¨å…±äº«å­˜å‚¨çš„æ¶æ„ä»¥åŠäº‘åŸç”Ÿçš„æ•°æ®ä¸€è‡´æ€§ï¼Œå…¶äº§å“ä»·å€¼ä¸»è¦æ˜¯åœ¨èŠ‚çº¦æ•°æ®åº“æˆæœ¬ä»¥åŠæè‡´çš„äº‘ä¸Šèµ„æºä¼¸ç¼©æ€§ç­‰ã€‚ä½†ç”±äºä¸å­˜é‡JEDåº“(shared nothing)é‡‡ç”¨äº†ä¸ä¸€æ ·çš„æŠ€æœ¯æ¶æ„ï¼Œæ‰€ä»¥é¢ä¸´ä¸€ä¸ªç°å®é—®é¢˜â€”â€”å­˜é‡ç”¨æˆ·ç‰ˆæœ¬æ— æ³•å¹³æ»‘å‡çº§ã€‚</p>
<p>ç”¨è¿‡æˆ–è€…äº†è§£æ•°æ®åº“çš„äººéƒ½çŸ¥é“ï¼Œæœ‰çš„æ—¶å€™ä¸æ˜¯å¤§å®¶ä¸æƒ³ä½¿ç”¨æ›´æ–°çš„ç‰ˆæœ¬ï¼Œæ›´å¼ºçš„æ€§èƒ½ï¼Œæ›´ä¼˜ç§€çš„åŠŸèƒ½ï¼Œè€Œæ˜¯æ•°æ®åº“æœ¬èº«å¤ªåŸºç¡€å¤ªé‡è¦äº†ï¼Œå¦‚æœä¸šåŠ¡ç³»ç»Ÿå·²ç»å»ºè®¾å¾ˆå¤šå¹´ï¼Œä¸æ•°æ®åº“ç»‘å®šå¤ªæ·±çš„è¯ï¼Œæ›´å¤šè¿˜æ˜¯æ±‚ç¨³ä¸ºä¸»ï¼Œèƒ½ä¸åŠ¨åˆ™ä¸åŠ¨ã€‚è¿™ä¸æ˜¯äº¬ä¸œç‹¬æœ‰çš„æƒ…å†µï¼Œå¯ä»¥è¯´æ•´ä¸ªè¡Œä¸šçš†æ˜¯å¦‚æ­¤ï¼Œè¿™å«æŠ€æœ¯æƒ¯æ€§ã€‚æ­£æ˜¯å› ä¸ºé‡‡ç”¨äº†æ–°çš„æŠ€æœ¯æ¶æ„ï¼Œå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šå­˜é‡ä¸šåŠ¡å¦‚æœè¦ä½¿ç”¨å¿…é¡»è¿›è¡Œæ•°æ®åº“çš„è¿ç§»ã€‚å°±è¿™ä¸€ä¸ªåŸå› ï¼Œå¾ˆå¤šä¸šåŠ¡å°±æœ›è€Œå´æ­¥ã€‚</p>
<p>æ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼Œåœ¨æ–°leaderå¸¦é¢†æˆ‘ä»¬å›¢é˜Ÿä»¥åï¼ŒåŸºäºä¸°å¯Œçš„æ•°æ®åº“ç»éªŒï¼Œæ•é”åœ°å¯Ÿè§‰åˆ°äº¬ä¸œæ•´ä¸ªæ•°æ®åº“çš„åŸºæœ¬ç›˜å…¶å®æ˜¯å­˜é‡çš„æ•°æ®åº“ï¼Œè§£å†³å­˜é‡æ•°æ®åº“ç”¨æˆ·çš„é—®é¢˜æ‰èƒ½å¸¦æ¥æ›´å¤§çš„ä»·å€¼ã€‚å†ä¼˜ç§€çš„äº§å“ï¼Œå¦‚æœæ²¡äººç”¨ä¸€æ ·ç™½è´¹åŠ›æ°”ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼Œä¸€ä¸ªå®Œå…¨é€‚é…å­˜é‡æ¶æ„çš„æ•°æ®åº“å†…æ ¸ï¼Œä¸å¼•å…¥æ›´å¤æ‚çš„æ¶æ„å˜æ›´å’Œè¿‡å¤šçš„è®¾è®¡ï¼Œåªåœ¨å…¶åŸºç¡€ä¸Šå¯¹æ•°æ®åº“å†…æ ¸æ€§èƒ½è¿›è¡Œä¼˜åŒ–ã€å¯¹é…å¥—èƒ½åŠ›è¿›è¡Œæå‡ã€å¯¹é›¶å”®ç”µå•†åœºæ™¯è¿›è¡Œé’ˆå¯¹æ€§æ‰©å±•ï¼Œå®Œç¾æ”¯æŒJEDä»¥åŠDongDALï¼Œç§‰æŒç¨³å®šæ€§å’Œå…¼å®¹æ€§ä¸ºå‰æçš„åŸºç¡€ä¸Šï¼Œè®©äº¬ä¸œçš„æ•°æ®åº“å†…æ ¸æ›´å¥½ç”¨ï¼Œæ›´å¼ºå¤§ï¼</p>
<h4 data-id="heading-8"><strong>ç”µå•†åœºæ™¯ä¸‹æ•°æ®åº“ç—›ç‚¹çš„è§£å†³ä¹‹é“</strong></h4>
<p>ç”µå•†åœºæ™¯çš„æ•°æ®åº“éœ€æ±‚å…¶å®æ˜¯ç”¨æˆ·æœ€è¿«åˆ‡çš„ï¼Œå› æ­¤æˆ‘ä»¬åœ¨é¦–é€‰å¼€åˆ€æ–¹å‘æ—¶ï¼Œæ²¡æœ‰é€‰æ‹©å¼•å…¥èŠ±é‡Œèƒ¡å“¨é«˜å¤§ä¸Šçš„åŠŸèƒ½ç­‰è§’åº¦ã€‚è€Œæ˜¯ä»ç”¨æˆ·ä¸­æ¥ï¼Œå›åˆ°ç”¨æˆ·ä¸­å»ï¼Œæ·±å…¥åˆ†æç›®å‰çº¿ä¸Šç”¨æˆ·æœ€å¸¸è§çš„é—®é¢˜ï¼Œä»¥åŠå¤§ä¿ƒæœ€å¸¸è§çš„æ•…éšœåœºæ™¯ï¼Œé’ˆå¯¹æ€§çš„å¼•å…¥äº†å†…æ ¸å±‚æ–°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h5 data-id="heading-9"><strong>é—®é¢˜ä¸€ï¼šâ€œè¿‡è½½â€ å¤§ä¿ƒæ¿€å¢çš„æµé‡ï¼Œæˆ–è€…è¶…æ—¶SQLä¸æ–­é‡è¯•ç›´æ¥æŠŠæ•°æ®åº“CPUæ‰“æ»¡ç”šè‡³æ‰“æŒ‚</strong></h5>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4e6426f6b5543c099a863554b85fdc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359814&amp;x-signature=rkofY9xbAv6DnOdnCwI0I7%2BWyVw%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ï»¿<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21e949eb52e443dfba30411f1adcb7c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359814&amp;x-signature=%2B6yRk1hZiqzc%2FeyE97Q6aU5L%2Bg0%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è¿™ç§åœºæ™¯çœŸçš„éå¸¸å¸¸è§ï¼Œç”šè‡³å‰æ®µæ—¶é—´è¿˜æœ‰ä¸€ä¸ªç™½è™æ•…éšœå°±æ˜¯ç±»ä¼¼çš„åŸå› ã€‚ä¸šåŠ¡ç ”å‘åœ¨è®¾è®¡åŠŸèƒ½çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ— æ³•é¢„çŸ¥çº¿ä¸Šç”Ÿäº§ç¯å¢ƒçœŸå®çš„æµé‡çš„ï¼Œæˆ–è®¸å¯ä»¥è®¾è®¡åº”ç”¨ä¾§é™æµï¼Œä¹Ÿæˆ–è®¸å¯ä»¥åŠ ç¼“å­˜æŠ—é‡ï¼Œä½†é™æµä¸æ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½æœ‰ï¼Œå³ä½¿æœ‰ä¹Ÿå¯èƒ½å­˜åœ¨ç–æ¼ï¼Œç¼“å­˜å¦‚æœè¢«å‡»ç©¿é‚£å¸¦ç»™æ•°æ®åº“çš„æµé‡æ›´æ˜¯æš´å‡»ã€‚æœ‰çš„æ—¶å€™ç”šè‡³ä¸æ˜¯çœŸå®æš´å¢çš„æµé‡ï¼Œè€Œåªæ˜¯è¶…æ—¶æœºåˆ¶çš„è´Ÿåé¦ˆï¼Œå¤±è´¥çš„ä¸æ–­é‡è¯•å°±å¸¦æ¥äº†è¶…å‡ºé¢„æœŸçš„æ•°æ®åº“è¯·æ±‚ã€‚</p>
<p>å½“è¯·æ±‚æµé‡çªç„¶æš´æ¶¨æ—¶æˆ–è€…çªå‘çš„æ…¢sqlå ç”¨å¤§é‡èµ„æºæ—¶ï¼Œå®ƒä¼šåƒä¸€ä¸ªè¢«ç¬é—´æ¶Œå…¥äººç¾¤æŒ¤å®çš„æœåŠ¡å°ï¼šæ¯ä¸ªæ–°è¿æ¥éƒ½éœ€è¦æ•°æ®åº“åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ï¼Œå¤§é‡çº¿ç¨‹çš„åˆ›å»ºã€ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç»´æŒæœ¬èº«å°±ä¼šåƒæ‰å¯è§‚çš„å†…å­˜å’ŒCPUï¼›æ›´é‡è¦çš„æ˜¯ï¼Œæ¯ä¸ªæŸ¥è¯¢è¿›æ¥ï¼Œå†…æ ¸éƒ½è¦ç–¯ç‹‚å·¥ä½œâ€”â€”è§£æå¤æ‚çš„SQLè¯­å¥ã€åœ¨æˆåƒä¸Šä¸‡æ¡ç´¢å¼•æ¡ç›®ä¸­æŸ¥æ‰¾è·¯å¾„ã€æ‹¼å‡‘å…³è”å¤šå¼ è¡¨çš„æ•°æ®ã€è¿›è¡Œæ’åºåˆ†ç»„è®¡ç®—ã€ç®¡ç†äº‹åŠ¡ä¿è¯ä¸€è‡´æ€§ï¼ˆè¿™æ¶‰åŠåˆ°é¢‘ç¹çš„åŠ é”è§£é”ï¼Œé«˜å¹¶å‘æ—¶ææ˜“å µå¡æ’é˜Ÿï¼‰ã€è¿˜è¦ä¸æ–­ä»ç£ç›˜è¯»å–æ•°æ®æˆ–æŠŠæ”¹åŠ¨å†™å›å»ã€‚æ‰€æœ‰è¿™äº›æ“ä½œéƒ½æ˜¯æåº¦æ¶ˆè€—CPUç®—åŠ›çš„å¯†é›†è®¡ç®—ã€‚å½“æ¯ç§’æ¶Œå…¥çš„è¯·æ±‚è¿œè¶…CPUèƒ½å¤„ç†çš„é€Ÿåº¦æ—¶ï¼ŒCPUå°±ä¼šè¢«å®Œå…¨å æ»¡ï¼Œæ‰€æœ‰æŸ¥è¯¢éƒ½æŒ¤åœ¨ä¸€èµ·æ’é˜Ÿç­‰å¾…è®¡ç®—èµ„æºã€‚ä¸æ­¤åŒæ—¶ï¼Œé«˜å¹¶å‘ä¸‹é”å†²çªå‰§å¢ï¼Œå¤§é‡çº¿ç¨‹å› ç­‰å¾…é”è€Œé˜»å¡å´ä¸é‡Šæ”¾èµ„æºï¼›å†…å­˜å¯èƒ½è¢«ä¸´æ—¶è¡¨ã€æ’åºç¼“å­˜å¡çˆ†ï¼›ä¸¥é‡æ—¶ç£ç›˜IOä¹Ÿè·Ÿä¸ä¸Šã€‚æœ€ç»ˆï¼ŒCPUè¢«å½»åº•è€—å°½ï¼Œæ–°è¿æ¥æ— æ³•å»ºç«‹ï¼Œå·²æœ‰æŸ¥è¯¢å®Œå…¨å¡æ­»ï¼Œæ•´ä¸ªæ•°æ®åº“è¿›ç¨‹å¤±å»å“åº”ï¼Œå°±åƒè¢«â€œæ‰“æŒ‚â€äº†ä¸€æ ·ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ‰€æœ‰å…³é”®èµ„æºï¼ˆCPUã€å†…å­˜ã€IOã€è¿æ¥ï¼‰åœ¨ç¬é—´æ´ªå³°ä¸‹è¢«å½»åº•æ¦¨å¹²å¯¼è‡´çš„ç³»ç»Ÿæ€§å´©æºƒã€‚</p>
<p>åŸå› å¾ˆæ¸…æ¥šï¼Œè§£å†³æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œå‰é¢ä¹Ÿæåˆ°äº†ï¼Œé™æµå³å¯ï¼Œå¯å®é™…ç”Ÿäº§ç¯å¢ƒæ“ä½œèµ·æ¥è¿˜æ˜¯ä¼šå‡ºç°è¯¸å¤šå›°éš¾ã€‚</p>
<p>ä¸šåŠ¡å±‚è‡ªè¡Œé™æµé¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜åœ¨äºå…¶â€œç²—æ”¾â€å’Œâ€œæ»åâ€ã€‚å®ƒé€šå¸¸åªèƒ½åŸºäºç®€å•çš„è¯·æ±‚é¢‘ç‡æˆ–ç”¨æˆ·ç»´åº¦ï¼ˆå¦‚QPSï¼‰è¿›è¡Œæ‹¦æˆªï¼Œæ— æ³•æ´å¯Ÿæ•°æ®åº“å†…éƒ¨çœŸå®çš„ç“¶é¢ˆæ‰€åœ¨ï¼ˆæ¯”å¦‚æ˜¯åœ¨CPUã€å†…å­˜ã€ç£ç›˜IOè¿˜æ˜¯é”å†²çªï¼‰ã€‚è¿™ææ˜“å¯¼è‡´â€œè¯¯æ€â€â€”â€”æ ¸å¿ƒçš„é‡èµ„æºæ¶ˆè€—å‹SQLå¯èƒ½æœªè¢«æ‹¦ä½ï¼Œåè€Œå¤§é‡é«˜é¢‘ä½†è½»é‡çš„è¯·æ±‚è¢«é™æµï¼Œç‰ºç‰²äº†ä¸šåŠ¡å¯ç”¨æ€§å´æœªèƒ½çœŸæ­£ç¼“è§£æ•°æ®åº“å‹åŠ›ã€‚åŒæ—¶ï¼Œåœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œåè°ƒå„ä¸ªæœåŠ¡æ¨¡å—ç»Ÿä¸€ã€å®æ—¶åœ°å®æ–½å¹¶è°ƒæ•´é™æµç­–ç•¥å¼‚å¸¸å›°éš¾ï¼Œå¾ˆå®¹æ˜“å‡ºç°é™æµä¸ä¸€è‡´æˆ–å“åº”è¿Ÿç¼“ï¼Œå½“ä¸šåŠ¡å±‚æ„ŸçŸ¥åˆ°æ•°æ®åº“å“åº”å˜æ…¢æˆ–æŠ¥é”™å†è§¦å‘é™æµæ—¶ï¼Œå¾€å¾€å·²ç»é”™è¿‡äº†æœ€ä½³å¹²é¢„æ—¶æœºï¼Œé›ªå´©å¯èƒ½å·²ç»å‘ç”Ÿã€‚</p>
<p>ç›®å‰çš„å®é™…æ“ä½œå¾€å¾€æ˜¯é«˜å¯ç”¨ç¨‹åºæˆ–è€…DBAä¾é HAæœºåˆ¶è¿›è¡Œä¸»å¤‡åˆ‡æ¢æ¥åº”å¯¹è¿‡è½½ã€‚åˆ‡æ¢è¿‡ç¨‹æœ¬èº«å¿…ç„¶å¯¼è‡´æ•°ç§’åˆ°æ•°åç§’çš„æœåŠ¡ä¸­æ–­ï¼ˆè¿æ¥é—ªæ–­ã€çŸ­æš‚åªè¯»ï¼‰ï¼Œå¯¹è¿ç»­æ€§è¦æ±‚é«˜çš„ä¸šåŠ¡ä¼šé€ æˆç›´æ¥å½±å“ã€‚æ›´é‡è¦çš„æ˜¯æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼šä¸»åº“åœ¨æ•…éšœæˆ–è¿‡è½½ç¬é—´å¯èƒ½å­˜åœ¨æœªåŒæ­¥åˆ°å¤‡åº“çš„äº‹åŠ¡æ•°æ®ï¼Œåˆ‡æ¢åè¿™äº›æ•°æ®å¯èƒ½æ°¸ä¹…ä¸¢å¤±ï¼ˆå¼‚æ­¥å¤åˆ¶ä¸‹ï¼‰ï¼Œå³ä½¿ä½¿ç”¨åŠåŒæ­¥å¤åˆ¶ä¹Ÿå¯èƒ½å› ç½‘ç»œé—®é¢˜é˜»å¡å†™å…¥æˆ–é€€åŒ–ä¸ºå¼‚æ­¥ã€‚å†å¹´å¤§ä¿ƒçº¿ä¸Šç”Ÿäº§ç¯å¢ƒä¸å°‘æ•…éšœç”šè‡³æ˜¯å‘ç”Ÿåœ¨åˆ‡æ¢æ“ä½œä¹‹å(æ™®é€šRDSé›†ç¾¤ä»¥åŠä½ç‰ˆæœ¬vitessé›†ç¾¤é£é™©å°¤å…¶æ˜¾è‘—)ã€‚</p>
<h5 data-id="heading-10"><strong>è§£ï¼šSQLè‡ªæç¤ºå®ç°ç²¾å‡†é™æµ</strong></h5>
<p>åŸºäºä»¥ä¸Šç—›ç‚¹ï¼Œä¸å°‘ç”¨æˆ·æå‡ºï¼Œå¦‚æœå¯ä»¥å®ç°ç²¾å‡†é™æµå°±å¥½äº†ï¼Œæ—¢èƒ½åœ¨ä¸šåŠ¡æ ¹æ®æµé‡é¢„æµ‹çš„åŸºç¡€ä¸Šé¢„é˜²æ€§é™æµï¼Œåˆèƒ½åœ¨è¿‡è½½å‘ç”Ÿåæ ¹æ®ç®€å•æ’æŸ¥çš„ç»“æœå®šå‘é™æµã€‚æœ‰æ±‚å¿…åº”â€”â€”Hinté™æµæ–¹æ¡ˆæ¨ªç©ºå‡ºä¸–ï¼</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>Â æ ¹æ®ç‰¹å®šÂ <span class="hljs-keyword">SQL</span>Â æŒ‡çº¹è¿›è¡Œé™æµÂ 
<span class="hljs-keyword">update</span><span class="hljs-comment">/*+Â ccl_queue_digest(INT&lt;å½“å‰è¯­å¥çš„å¹¶è¡Œæ•°&gt;)Â */</span>Â tÂ <span class="hljs-keyword">set</span>Â col1Â <span class="hljs-operator">=</span>Â col1<span class="hljs-operator">+</span><span class="hljs-number">1</span>Â <span class="hljs-keyword">where</span>Â <span class="hljs-number">1</span><span class="hljs-operator">=</span>id;Â 
<span class="hljs-keyword">update</span><span class="hljs-comment">/*+Â ccl_queue_digest()Â */</span>Â tÂ <span class="hljs-keyword">set</span>Â col1Â <span class="hljs-operator">=</span>Â col1<span class="hljs-operator">+</span><span class="hljs-number">1</span>Â <span class="hljs-keyword">where</span>Â <span class="hljs-number">1</span><span class="hljs-operator">=</span>id;
</code></pre>
<p>æ•°æ®åº“å†…æ ¸è‡ªèº«æ”¯æŒé™æµçš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯ï¼Œæˆ‘ä»¬èƒ½æ·±å…¥åˆ°SQLæ‰§è¡Œå±‚ï¼Œæ ¹æ®ç”¨æˆ·æŒ‡å®šè§„åˆ™ï¼ˆå¦‚åŒ¹é…ç‰¹å®šSQLæŒ‡çº¹ã€æˆ–è€…SQLè¯­å¥å…¨æ–‡ç­‰ä¸åŒæ¨¡å¼è§„åˆ™ï¼‰å®æ—¶è¯†åˆ«å¹¶ä¼˜å…ˆæŠ‘åˆ¶é‚£äº›çœŸæ­£â€œåƒæ‰â€å¤§é‡èµ„æºçš„â€œç½ªé­ç¥¸é¦–â€æŸ¥è¯¢ã€‚è¿™å¦‚åŒåœ¨æ•°æ®åº“å¼•æ“å†…éƒ¨å®‰è£…äº†ä¸€ä¸ªæ™ºèƒ½èŠ‚æµé˜€ï¼Œç›´æ¥ä»æºå¤´ï¼ˆæ¶ˆè€—èµ„æºçš„æŸ¥è¯¢ï¼‰è¿›è¡Œç²¾å‡†æ§åˆ¶ï¼Œé¿å…äº†ä¸šåŠ¡å±‚é™æµçš„ç›²ç›®æ€§å’ŒHAåˆ‡æ¢çš„ç ´åæ€§ã€‚å®ƒèƒ½åœ¨èµ„æºç´§å¼ åˆç°ç«¯å€ªæ—¶å°±ä¸»åŠ¨å¹²é¢„ï¼Œæœ€å¤§é™åº¦ä¿éšœæ ¸å¿ƒä¸šåŠ¡è¯·æ±‚çš„é€šè¿‡å’Œç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ï¼Œä¸”ç”±å†…æ ¸ç»Ÿä¸€ç®¡ç†ï¼Œè§„åˆ™ç”Ÿæ•ˆåŠæ—¶ã€ç­–ç•¥æ‰§è¡Œé«˜æ•ˆã€‚</p>
<h5 data-id="heading-11"><strong>é—®é¢˜äºŒï¼šâ€œç§’æ€â€ å•ç‚¹é«˜é¢‘å†™å…¥å¸¦æ¥çš„æ•°æ®åº“æ€§èƒ½ä¸‹é™ï¼Œä»¥åŠåº“å­˜ä¸€è‡´æ€§é—®é¢˜</strong></h5>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/658809ca5a5f48c5bd809b988f0244b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359814&amp;x-signature=m%2FYmDmq0FVgA5Jr3fvd4ZcUen2M%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ç§’æ€æ˜¯ç”µå•†ä¸šåŠ¡éå¸¸å¸¸è§çš„åœºæ™¯ï¼Œæ— è®ºç§’æ€ä¸šåŠ¡æ˜¯å¦è®¾è®¡ç¼“å­˜å‰ç½®æŠ—é‡ï¼Œåº“å­˜æ•°æ®çš„æœ€ç»ˆå˜æ›´éƒ½æ˜¯éœ€è¦è½åˆ°æ•°æ®åº“çš„ã€‚å¦‚æœç¼“å­˜å‘ç”Ÿå‡»ç©¿ï¼Œæ›´æ˜¯éœ€è¦æ•°æ®åº“æ¥è¿›è¡Œå…œåº•ç­–ç•¥ã€‚ä½†ç§’æ€è¿™ä¸ªåœºæ™¯çš„æ•°æ®åº“æ“ä½œåˆæå…¶ç‰¹æ®Šï¼Œç”šè‡³å¯ä»¥è¯´ä¼šå¯¼è‡´ä¼ ç»Ÿæ•°æ®åº“ç—›ç‚¹é›†ä¸­çˆ†å‘ã€‚</p>
<p>é¦–å…ˆï¼Œé«˜é¢‘å•è¡Œæ›´æ–°ä½¿è¡Œçº§é”ç«äº‰æˆä¸ºè‡´å‘½ç“¶é¢ˆï¼šå½“æµ·é‡è¯·æ±‚åŒæ—¶æ‰£å‡åŒä¸€å•†å“åº“å­˜æ—¶ï¼Œå­˜å‚¨å¼•æ“çš„è¡Œé”å¼ºåˆ¶ä¸²è¡Œæ›´æ–°ï¼Œå¯¼è‡´çº¿ç¨‹åœ¨é”ç­‰å¾…ä¸­å †ç§¯ï¼›æ­»é”æ£€æµ‹æœºåˆ¶åœ¨é˜Ÿåˆ—è¿‡é•¿æ—¶ï¼ˆå¦‚è¶…1000çº¿ç¨‹ï¼‰è§¦å‘æ·±åº¦éå†ï¼ŒCPUèµ„æºè¢«ç–¯ç‹‚æ¶ˆè€—ï¼Œäº‹åŠ¡å“åº”æ—¶é—´éª¤å¢ç”šè‡³è¶…æ—¶ã€‚</p>
<p>å…¶æ¬¡ï¼Œé«˜é¢‘äº‹åŠ¡çš„ACIDä¿éšœå¸¦æ¥å·¨å¤§å¼€é”€ï¼šäº‹åŠ¡åœ¨æ•°æ®åº“å†…æ ¸ä¸­æ˜¯æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€ï¼Œåœ¨ç§’æ€åœºæ™¯ä¸‹å¾€å¾€éƒ½æ˜¯ç®€å•äº‹åŠ¡ï¼Œä½†ä¸ºäº†ä¿è¯æŸ¥è¯¢æ›´æ–°çš„ä¸€è‡´æ€§ï¼Œåˆä¸å¾—ä¸å¼€æ˜¾å¼äº‹åŠ¡(éauto commit)ï¼Œè€Œæ˜¾å¼äº‹åŠ¡çš„BEGINã€Statementã€COMMIT/ROLLBACKï¼Œæ¯ä¸€ä¸ªå­å¥éƒ½ä¼šå®Œæ•´çš„ç»å†åº”ç”¨ä¾§åˆ°æ•°æ®åº“åº•å±‚çš„å¤šçº§è½¬å‘å’Œç½‘ç»œå¼€é”€ï¼Œä¼´éšå¤šæ¬¡ç½‘ç»œäº¤äº’ï¼ˆè·¨èŠ‚ç‚¹å»¶è¿ŸåŠ å‰§å µå¡ï¼‰åŠæ—¥å¿—å†™å…¥ï¼Œå•äº‹åŠ¡è€—æ—¶é£™å‡ï¼Œç³»ç»Ÿååé‡æ–­å´–å¼ä¸‹è·Œã€‚</p>
<p>æœ€åï¼Œç§’æ€åœºæ™¯çš„åº“å­˜æ‰£å‡ä¸å…è®¸å‡ºç°æ„æ–™å¤–çš„æ›´æ–°ï¼šä¼ ç»Ÿæ•°æ®åº“çš„é«˜å¹¶å‘æ‰£å‡éœ€é€šè¿‡SELECTæ£€æŸ¥åº“å­˜åå†æ‰§è¡ŒUPDATEï¼Œä½†ä¸¤æ­¥æ“ä½œå­˜åœ¨æ—¶åºæ¼æ´â€”â€”é«˜å¹¶å‘ä¸‹å¤šä¸ªè¯·æ±‚å¯èƒ½åŒæ—¶è¯»åˆ°ç›¸åŒåº“å­˜å€¼ï¼Œå¯¼è‡´è¶…å–ï¼›åŒæ—¶æ‰€æœ‰è¯·æ±‚ï¼ˆåŒ…æ‹¬åº“å­˜ä¸è¶³çš„æ— æ•ˆè¯·æ±‚ï¼‰å‡éœ€ç«äº‰åŒä¸€è¡Œé”ï¼Œå¼•å‘çº¿ç¨‹å †ç§¯å’Œæ­»é”æ£€æµ‹çš„CPUæš´å¢ã€‚</p>
<h5 data-id="heading-12"><strong>è§£ï¼šç”µå•†ç§’æ€åœºæ™¯å®šåˆ¶ä¼˜åŒ–</strong></h5>
<p><strong>ç§’æ€æ’é˜Ÿ</strong>ï¼šé«˜é¢‘æ›´æ–°é—®é¢˜å¾ˆå¥½è§£å†³ï¼Œå€Ÿç”¨é™æµçš„æ€è·¯ï¼Œåªä¸è¿‡ç§’æ€åœºæ™¯è¦é™çš„æ˜¯å…·ä½“çš„å­—æ®µç”šè‡³æ˜¯å…·ä½“çš„å€¼ï¼Œå› ä¸ºé«˜é¢‘SQLæ˜¯é›†ä¸­åœ¨å…·ä½“æ•°é‡çš„åº“å­˜æˆ–è€…å•ä¸€å“ç±»ä¸Šçš„ï¼Œè¦æ”¹çš„å¯èƒ½å°±å‡ è¡Œç”šè‡³æ˜¯ä¸€è¡Œæ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å€Ÿç”¨äº†é™æµçš„Hintè¯­æ³•ï¼Œä¸šåŠ¡åªéœ€è¦åœ¨é¢„æœŸç§’æ€éœ€è¦æ›´æ”¹çš„å…·ä½“SQLä¸Šï¼ŒåŠ ä¸Šå¯¹åº”çš„Hintè§„åˆ™ï¼Œçº¦å®šå…·ä½“å­—æ®µæˆ–è€…å…·ä½“å€¼éœ€è¦è¿›è¡Œé™åˆ¶æ’é˜Ÿæ‰§è¡Œï¼Œæ•°æ®åº“å†…éƒ¨å°±ä¼šå¯¹ç§’æ€ç±»çš„SQLè¿›è¡Œç®¡ç†æ’é˜Ÿï¼Œæå¤§ç¨‹åº¦çš„è§„é¿äº†è¡Œé”çš„ç«äº‰ä»¥åŠå…¶è¿é”ååº”ï¼Œç»æµ‹è¯•å•è¡Œæ›´æ–°é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ¯”ä¼ ç»Ÿæ•°æ®åº“çš„æµé‡èƒ½æå‡ä¸€å€ä»¥ä¸Šã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">//Â æ ¹æ®çƒ­ç‚¹å€¼é™æµ</span>
Â update<span class="hljs-comment">/*+Â ccl_queue_value('èŒ…å°')Â */</span>Â tÂ <span class="hljs-keyword">set</span>Â c=c+<span class="hljs-number">1</span>Â <span class="hljs-keyword">where</span>Â nameÂ =<span class="hljs-string">'èŒ…å°'</span>;Â 
Â <span class="hljs-comment">//Â æ ¹æ®çƒ­ç‚¹å­—æ®µé™æµ</span>
Â Â update<span class="hljs-comment">/*+Â ccl_queue_field(order_id)Â */</span>Â tÂ <span class="hljs-keyword">set</span>Â c=c+<span class="hljs-number">1</span>Â <span class="hljs-keyword">where</span>Â order_idÂ =<span class="hljs-number">1</span><span class="hljs-keyword">and</span>Â nameÂ =<span class="hljs-string">'èŒ…å°'</span>;
</code></pre>
<p><strong>äº‹åŠ¡å¿«é€Ÿæäº¤/å›æ»š</strong>ï¼šé’ˆå¯¹ç§’æ€äº‹åŠ¡çš„ç‰¹æ€§ï¼Œè®¾è®¡äº†äº‹åŠ¡å¿«é€Ÿæäº¤å›æ»šçš„Hintï¼Œå³ç”¨æˆ·åœ¨äº‹åŠ¡COMMIT/ROLLBACKå‰çš„æœ€åä¸€ä¸ªSQLè¯­å¥ä¸Šï¼Œå¦‚æœåŠ ä¸Šè¯¥Hintï¼Œåˆ™å†…æ ¸å³æ˜ç™½è¯¥æ“ä½œæäº¤æˆ–è€…å›æ»šäº†ã€‚æ­¤æ–¹æ¡ˆåœ¨ç§’æ€åœºæ™¯ä¸‹ï¼Œå°¤å…¶æ˜¯ç‰¹å®šå•è¡Œæ›´æ–°çš„åœºæ™¯ä¸‹ï¼Œæœ€é«˜å¯ä»¥æå‡ 3 å€ä»¥ä¸Šçš„æ€§èƒ½ï¼ä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p>
<p><strong>å½±å“è¡Œæ•°çº¦æŸ</strong>ï¼šç§’æ€åœºæ™¯åº“å­˜æ‰£å‡ï¼Œæˆ–è€…å…¶ä»–éç§’æ€åœºæ™¯ä¹Ÿå¯èƒ½å­˜åœ¨ï¼Œä¸šåŠ¡ä¾§çš„é€»è¾‘æ˜ç¡®çŸ¥é“æŸæ¡SQLæ›´æ–°ååº”è¯¥å½±å“å‡ è¡Œæ•°æ®ï¼Œå¦‚æœæ•°æ®åº“æ‰§è¡Œå®Œå‘ç°å½±å“çš„è¡Œæ•°ä¸ç¬¦åˆé¢„æœŸåˆ™å¤§æ¦‚ç‡å‡ºç°é—®é¢˜äº†ï¼Œéœ€è¦å°†äº‹åŠ¡è¿›è¡Œå›æ»šã€‚æˆ‘ä»¬è®¾è®¡äº†é¢„æœŸå½±å“è¡Œæ•°çš„Hintï¼Œé€šè¿‡è¯¥Hintï¼ˆç¤ºä¾‹ UPDATE /*+ TARGET_AFFECT_ROW(1) */ stock SET count=count-1 WHERE id=100 AND count&gt;=1ï¼‰ï¼Œå¯åŒæ­¥å®ç°ä¸¤å¤§æ ¸å¿ƒä¼˜åŒ–ï¼š</p>
<p>å…¶ä¸€ï¼Œå¼•æ“åœ¨åŠ é”å‰ä¼˜å…ˆæ ¡éªŒ WHERE æ¡ä»¶ï¼ˆåº“å­˜â‰¥1ï¼‰ï¼Œä»…å½“åº“å­˜å……è¶³æ—¶æ‰å°è¯•åŠ é”æ›´æ–°ï¼Œåº“å­˜ä¸è¶³çš„è¯·æ±‚ç›´æ¥è¿”å›å½±å“è¡Œæ•°=0ï¼Œé¿å…æ— æ•ˆé”ç«äº‰ï¼›</p>
<p>å…¶äºŒï¼Œåº“å­˜æ£€æŸ¥ä¸æ‰£å‡å‹ç¼©ä¸ºå•åŸå­æ“ä½œï¼Œç¡®ä¿å½±å“è¡Œæ•°ä¸¥æ ¼ä¸º1æ‰æˆåŠŸï¼Œå¦åˆ™è‡ªåŠ¨å¤±è´¥ï¼Œå½»åº•æœç»è·¨äº‹åŠ¡çš„è„è¯»ä¸è¶…å–é£é™©ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é…ç½®å…¶ä»–æ•°å€¼ï¼Œåªè¦ä¸æ‚¨é¢„æœŸçš„å½±å“è¡Œæ•°ä¸€è‡´å³å¯ã€‚</p>
<h5 data-id="heading-13"><strong>é—®é¢˜ä¸‰ï¼šâ€œç¼“å­˜æ›´æ–°ä¸€è‡´æ€§é—®é¢˜â€ ä¸šåŠ¡å‰ç½®ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¼šç›´æ¥æ›´æ–°æ•°æ®åº“ï¼Œç„¶åæŸ¥è¯¢å·²æ›´æ–°æ•°æ®å¹¶è¿”å›</strong></h5>
<p>è®¸å¤šä¸šåŠ¡ç³»ç»Ÿä¼šåœ¨æ•°æ®åº“è®¿é—®å±‚ä¹‹ä¸Šå¼•å…¥ç¼“å­˜ï¼Œä¾‹å¦‚äº¬ä¸œçš„åˆ†å¸ƒå¼ç¼“å­˜JIMDBï¼Œä»¥åˆ©ç”¨å…¶æè‡´çš„è¯»å†™å“åº”é€Ÿåº¦ä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚ç„¶è€Œï¼Œç¼“å­˜çš„æ˜“å¤±æ€§æœ¬è´¨å†³å®šäº†å…¶æ— æ³•ç‹¬ç«‹æ‰¿æ‹…å…³é”®æ•°æ®çš„æŒä¹…åŒ–èŒè´£â€”â€”æ•°æ®åº“å§‹ç»ˆæ˜¯ä¸å¯æˆ–ç¼ºçš„å…œåº•ä¿éšœï¼ˆé™¤éæ•°æ®å¯å®¹å¿ä¸¢å¤±ï¼‰ã€‚ç»´æŠ¤ç¼“å­˜ä¸æ•°æ®åº“ä¹‹é—´çš„å¼ºä¸€è‡´æ€§æ˜¯ç³»ç»Ÿè®¾è®¡çš„æ ¸å¿ƒæŒ‘æˆ˜ï¼Œå½“ç¼“å­˜å¤±æ•ˆå¯¼è‡´è¯·æ±‚ç©¿é€è‡³æ•°æ®åº“æ—¶ï¼Œä¸šåŠ¡å¸¸éœ€åŒæ­¥è·å–åˆšæ›´æ–°çš„æ•°æ®å¹¶å®æ—¶åˆ·æ–°ç¼“å­˜æˆ–å“åº”å‰ç«¯ã€‚ä¼ ç»Ÿæ•°æ®åº“åœ¨æ­¤åœºæ™¯ä¸‹å­˜åœ¨æ˜¾è‘—å±€é™ï¼šè‹¥è¦åœ¨äº‹åŠ¡ä¸­ç¡®ä¿æ›´æ–°åç«‹å³å¯è§ä¸”æ•°æ®ä¸€è‡´ï¼Œå¿…é¡»åœ¨DMLæ“ä½œåç´§è·Ÿä¸€æ¡SELECTè¯­å¥è¿›è¡ŒæŸ¥è¯¢ã€‚ä½†å³ä¾¿é‡‡ç”¨æ­¤æ–¹æ¡ˆï¼Œåœ¨è¯»å·²æäº¤ï¼ˆRCï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œå…¶ä»–äº‹åŠ¡çš„å¹¶å‘ä¿®æ”¹ä»å¯èƒ½å¯¼è‡´è¯¥æŸ¥è¯¢è¯»åˆ°ä¸ä¸€è‡´æ•°æ®ï¼Œæ— æ³•æ»¡è¶³ä¸¥æ ¼çš„å®æ—¶ä¸€è‡´æ€§è¦æ±‚ã€‚</p>
<h5 data-id="heading-14"><strong>è§£ï¼šå®ç°RETURNINGè¯­æ³•</strong></h5>
<p>æˆ‘ä»¬é€šè¿‡å®ç°RETURNINGè¯­æ³•è§£å†³è¿™ä¸€é—®é¢˜ï¼šåœ¨UPDATE/INSERTç­‰DMLè¯­å¥æœ«å°¾è¿½åŠ RETURNINGå­å¥ï¼Œå°±èƒ½ç›´æ¥è·å–ä¿®æ”¹åçš„å®Œæ•´è¡Œæ•°æ®ã€‚æ¯”å¦‚åº“å­˜æ‰£å‡åœºæ™¯ä¸‹ï¼Œä¸€æ¡UPDATE inventory SET stock=stock-1 WHERE id=100 RETURNING *;è¯­å¥æ—¢å®Œæˆäº†åŸå­æ‰£å‡ï¼Œåˆèƒ½ç«‹å³è¿”å›æœ€æ–°åº“å­˜å€¼ï¼Œæ— éœ€é¢å¤–SELECTæŸ¥è¯¢ã€‚</p>
<p>è¿™ä¸€å†…æ ¸çº§ä¼˜åŒ–ä¸ä»…æ¶ˆé™¤äº†RCéš”ç¦»ä¸‹çš„å¹¶å‘è„è¯»é£é™©ï¼ˆDMLä¸è¿”å›æ•°æ®åŸºäºåŒä¸€äº‹åŠ¡å¿«ç…§ï¼Œå…¶ä»–äº‹åŠ¡çš„å¹¶å‘ä¿®æ”¹ä¸ä¼šå¹²æ‰°ç»“æœï¼‰ï¼Œè¿˜å°†â€œæ›´æ–° + æŸ¥è¯¢â€çš„ä¸¤æ¬¡ç½‘ç»œäº¤äº’å‹ç¼©ä¸ºå•æ¬¡è¯·æ±‚ï¼ŒæŠŠäº‹åŠ¡è€—æ—¶å†é™ä¸€ä¸ªçº§åˆ«ã€‚å¯¹ç¼“å­˜æ¶æ„è€Œè¨€ï¼Œä¸šåŠ¡ä¾§æ‹¿åˆ°RETURNINGè¿”å›çš„å®æ—¶æ•°æ®åï¼Œèƒ½ç«‹åˆ»åˆ·æ–°ç¼“å­˜å±‚ï¼Œåœ¨äº‹åŠ¡æäº¤æ—¶å°±å®Œæˆæ•°æ®å¯¹é½ï¼Œè®©ç§’æ€ã€å¤§ä¿ƒç­‰é«˜å¹¶å‘åœºæ™¯ä¸‹çš„â€œç¼“å­˜å‡»ç©¿å…œåº•é€»è¾‘â€ï¼Œæ—¢å¿«åˆç¨³ã€‚</p>
<h5 data-id="heading-15"><strong>é—®é¢˜å››ï¼š"æ‰§è¡Œè®¡åˆ’æ¼‚ç§»" å¥½å¥½çš„SQLçªç„¶å°±æ…¢äº†</strong></h5>
<p>è¿™ä¸ªé—®é¢˜çœŸçš„è®©äººå¤´ç–¼ï¼Œä¸€æ¡SQLåœ¨å¼€å‘ç¯å¢ƒè·‘å¾—é£å¿«ï¼Œåˆ°äº†çº¿ä¸Šå°±å˜æˆäº†èœ—ç‰›ã€‚æ›´è¦å‘½çš„æ˜¯ï¼Œæœ‰æ—¶å€™åŒä¸€æ¡SQLï¼Œä»Šå¤©è¿˜å¥½å¥½çš„ï¼Œæ˜å¤©å°±çªç„¶æ…¢å¾—è¦æ­»ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰æ¡è®¢å•æŸ¥è¯¢çš„SQLï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>Â o.<span class="hljs-operator">*</span>,Â u.nameÂ Â 
<span class="hljs-keyword">FROM</span>Â ordersÂ oÂ Â 
<span class="hljs-keyword">JOIN</span>Â usersÂ uÂ <span class="hljs-keyword">ON</span>Â o.user_idÂ <span class="hljs-operator">=</span>Â u.idÂ Â 
<span class="hljs-keyword">WHERE</span>Â o.create_timeÂ Â 
<span class="hljs-keyword">BETWEEN</span>Â <span class="hljs-string">'2025-10-01'</span>Â <span class="hljs-keyword">AND</span>Â <span class="hljs-string">'2025-10-30'</span>Â <span class="hljs-keyword">AND</span>Â o.statusÂ <span class="hljs-keyword">IN</span>(<span class="hljs-string">'PAID'</span>,<span class="hljs-string">'SHIPPED'</span>)Â 
Â <span class="hljs-keyword">ORDER</span>Â <span class="hljs-keyword">BY</span>Â o.create_timeÂ <span class="hljs-keyword">DESC</span>Â LIMITÂ <span class="hljs-number">100</span>;
</code></pre>
<p>å¹³æ—¶è¿™æ¡SQLæ¯«ç§’çº§å°±èƒ½å‡ºç»“æœï¼Œç”¨çš„æ˜¯<code>orders.idx_create_time</code>ç´¢å¼•ã€‚ä½†æœ‰ä¸€å¤©å¤§ä¿ƒæœŸé—´ï¼Œè¿™æ¡SQLçªç„¶å¼€å§‹èµ°å…¨è¡¨æ‰«æï¼Œ30ç§’æ‰èƒ½è·‘å®Œï¼Œç›´æ¥æŠŠç³»ç»Ÿæ‹–å®äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿæ•°æ®åº“ä¼˜åŒ–å™¨æ˜¯ä¸ª"èªæ˜"çš„å®¶ä¼™ï¼Œå®ƒä¼šæ ¹æ®è¡¨çš„ç»Ÿè®¡ä¿¡æ¯æ¥é€‰æ‹©æ‰§è¡Œè®¡åˆ’ã€‚ä½†é—®é¢˜å°±å‡ºåœ¨è¿™äº›ç»Ÿè®¡ä¿¡æ¯ä¸Šâ€”â€”<code>ANALYZE TABLE</code>æ›´æ–°äº†ç»Ÿè®¡ä¿¡æ¯ï¼Œæ•°æ®åˆ†å¸ƒå‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ–è€…ç³»ç»Ÿè´Ÿè½½å½±å“äº†æˆæœ¬è®¡ç®—ï¼Œä¼˜åŒ–å™¨å°±å¯èƒ½çªç„¶"å˜å¿ƒ"ï¼Œé€‰æ‹©ä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ‰§è¡Œè·¯å¾„ã€‚</p>
<p>è¿™ç§æƒ…å†µåœ¨å¤§ä¿ƒæœŸé—´ç‰¹åˆ«å±é™©ï¼Œæ•°æ®é‡æ¿€å¢ã€ç³»ç»Ÿè´Ÿè½½å˜åŒ–ï¼Œä¸€æ¡æ ¸å¿ƒæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’çªç„¶åŠ£åŒ–ï¼Œæ•´ä¸ªç³»ç»Ÿå¯èƒ½å°±å®äº†ã€‚</p>
<p>ä¼ ç»Ÿçš„è§£å†³åŠæ³•è¦ä¹ˆé‡å¯æ•°æ®åº“ï¼ˆä»£ä»·å¤ªå¤§ï¼‰ï¼Œè¦ä¹ˆä¸šåŠ¡ç ”å‘åŠ Hintå¼ºåˆ¶ç´¢å¼•ï¼ˆç ´åä»£ç å¯ç»´æŠ¤æ€§ï¼Œè¿˜å¾—ç´§æ€¥ä¸Šçº¿ï¼Œæ—¶é—´å‘¨æœŸé•¿ï¼‰ï¼Œè¦ä¹ˆè°ƒä¼˜åŒ–å™¨å‚æ•°ï¼ˆå¯èƒ½å½±å“å…¶ä»–SQLï¼‰ï¼Œéƒ½ä¸æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</p>
<h5 data-id="heading-16"><strong>è§£ï¼šStatement Outlineæ‰§è¡Œè®¡åˆ’å›ºåŒ–åŠŸèƒ½</strong></h5>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å®ç°äº†Statement OutlineåŠŸèƒ½ï¼Œå¯ä»¥æŠŠç¨³å®šé«˜æ•ˆçš„æ‰§è¡Œè®¡åˆ’"å›ºåŒ–"ä¸‹æ¥ï¼Œè®©ä¼˜åŒ–å™¨æŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„æ–¹å¼æ‰§è¡Œã€‚è¿™ä¸ªåŠŸèƒ½é€šè¿‡å­˜å‚¨è¿‡ç¨‹åŒ…æ¥ç®¡ç†ï¼Œä½¿ç”¨èµ·æ¥å¾ˆç®€å•ã€‚æ¯”å¦‚æˆ‘ä»¬å‘ç°æŸä¸ªæŸ¥è¯¢æœ‰ä¸ªå¾ˆå¥½çš„æ‰§è¡Œè®¡åˆ’ï¼Œå°±å¯ä»¥æŠŠå®ƒè®°ä¸‹æ¥ï¼Œä¸€æ—¦å‘ç”Ÿä¸Šè¿°æ„å¤–åœºæ™¯ï¼Œå¯ä»¥ç«‹å³å°†å…¶æ³¨å…¥æ•°æ®åº“ä»è€Œç¨³å®šè¯¥ç±»å‹SQLçš„æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â æ·»åŠ ä¼˜åŒ–å™¨hintçš„outline</span>
Â <span class="hljs-keyword">CALL</span>Â dbms_outln.add_optimizer_outline(Â Â Â 
Â <span class="hljs-string">'your_db'</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â æ•°æ®åº“åç§°Â Â Â Â </span>
Â <span class="hljs-string">''</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â SQLè¯­å¥çš„æ‘˜è¦ï¼Œä¸ºç©ºæ—¶è‡ªåŠ¨è®¡ç®—Â Â Â Â Â Â </span>
Â <span class="hljs-number">1</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â ä½ç½®ï¼Œé€šå¸¸ä¸º1Â Â Â Â Â </span>
Â <span class="hljs-string">'/*+Â USE_INDEX(ordersÂ idx_create_time)Â */'</span>,Â Â Â Â <span class="hljs-comment">--Â ä¼˜åŒ–å™¨æç¤ºæ–‡æœ¬Â Â Â Â Â Â </span>
Â <span class="hljs-string">'SELECTÂ o.*,Â u.nameÂ Â Â Â Â Â Â Â FROMÂ ordersÂ oÂ Â Â Â Â Â Â 
Â JOINÂ usersÂ uÂ ONÂ o.user_idÂ =Â u.idÂ Â Â Â Â Â Â Â 
WHEREÂ o.create_timeÂ BETWEENÂ '</span><span class="hljs-number">2025</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span><span class="hljs-string">'Â ANDÂ '</span><span class="hljs-number">2025</span><span class="hljs-number">-10</span><span class="hljs-number">-30</span><span class="hljs-string">'Â ANDÂ o.statusÂ INÂ ('</span>PAID<span class="hljs-string">',Â '</span>SHIPPED<span class="hljs-string">')Â Â Â Â Â Â Â 
ORDERÂ BYÂ o.create_timeÂ DESCÂ LIMITÂ 100;'</span>Â Â Â Â Â Â Â <span class="hljs-comment">--Â SQLè¯­å¥æ–‡æœ¬);Â </span>

<span class="hljs-comment">--Â æ·»åŠ å¼ºåˆ¶ç´¢å¼•çš„outlineÂ Â Â </span>
<span class="hljs-keyword">CALL</span>Â dbms_outln.add_index_outline(Â Â Â Â Â Â <span class="hljs-string">'your_db'</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â æ•°æ®åº“åç§°Â Â Â Â Â </span>
Â <span class="hljs-string">''</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â SQLè¯­å¥çš„æ‘˜è¦ï¼Œä¸ºç©ºæ—¶è‡ªåŠ¨è®¡ç®—Â Â Â Â Â Â </span>
<span class="hljs-number">1</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â ä½ç½®ï¼Œé€šå¸¸ä¸º1Â Â Â Â Â </span>
Â <span class="hljs-string">'USEÂ INDEX'</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â ç´¢å¼•æç¤ºç±»å‹ï¼Œå¦‚'USEÂ INDEX'ã€'IGNOREÂ INDEX'ç­‰Â Â Â Â Â </span>
Â <span class="hljs-string">'idx_status'</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â ç´¢å¼•åˆ—è¡¨ï¼Œå¤šä¸ªç´¢å¼•ç”¨é€—å·åˆ†éš”Â Â Â Â Â Â </span>
Â <span class="hljs-string">''</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">--Â ç´¢å¼•æç¤ºé€‰é¡¹ï¼Œå¦‚'FORÂ JOIN'ã€'FORÂ ORDERÂ BY'ç­‰Â Â Â Â Â </span>
<span class="hljs-string">'SELECTÂ o.*,Â u.nameÂ Â Â Â Â Â Â 
Â FROMÂ ordersÂ oÂ Â Â Â Â Â Â Â 
JOINÂ usersÂ uÂ ONÂ o.user_idÂ =Â u.idÂ Â Â Â Â Â Â Â 
Â WHEREÂ o.create_timeÂ BETWEENÂ '</span><span class="hljs-number">2025</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span><span class="hljs-string">'Â ANDÂ '</span><span class="hljs-number">2025</span><span class="hljs-number">-10</span><span class="hljs-number">-30</span><span class="hljs-string">'Â ANDÂ o.statusÂ INÂ ('</span>PAID<span class="hljs-string">',Â '</span>SHIPPED<span class="hljs-string">')Â Â Â Â Â Â Â Â 
Â ORDERÂ BYÂ o.create_timeÂ DESCÂ LIMITÂ 100;'</span>Â Â Â Â Â Â Â <span class="hljs-comment">--Â SQLè¯­å¥æ–‡æœ¬);</span>
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿ç»Ÿè®¡ä¿¡æ¯å˜åŒ–äº†ï¼Œä¼˜åŒ–å™¨ä¹Ÿä¼šæŒ‰ç…§æˆ‘ä»¬å›ºåŒ–çš„æ‰§è¡Œè®¡åˆ’æ¥æ‰§è¡Œï¼Œä¿è¯æŸ¥è¯¢æ€§èƒ½çš„ç¨³å®šæ€§ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿç²¾ç¡®æ§åˆ¶æŸ¥è¯¢çš„æ‰§è¡Œæ–¹å¼ã€‚å¯¹äºé‚£äº›ä¸šåŠ¡å…³é”®çš„SQLï¼Œè¿™ä¸ªåŠŸèƒ½ç®€ç›´æ˜¯"å®šæµ·ç¥é’ˆ"ï¼Œå½»åº•è§£å†³äº†æ‰§è¡Œè®¡åˆ’æ¼‚ç§»çš„é—®é¢˜ã€‚</p>
<p>Outlineè¿˜å¯ä»¥æ³¨å…¥è‡ªå®šä¹‰çš„hintï¼Œæ¯”å¦‚â€œé—®é¢˜ä¸€â€ä¸­çš„è§£å†³è¿‡è½½é—®é¢˜hintæˆ–è€…â€œé—®é¢˜äºŒâ€ä¸­çš„ç§’æ€åœºæ™¯hintã€‚</p>
<h5 data-id="heading-17"><strong>é—®é¢˜äº”ï¼š"çº¿ç¨‹æ‹¥å µ" æ¯è¿æ¥æ¯çº¿ç¨‹çš„å¼Šç—…</strong></h5>
<p>ä¼ ç»Ÿæ•°æ®åº“æ˜¯æ²¡æœ‰çº¿ç¨‹æ± çš„ï¼Œæ¯ä¸ªè¿æ¥éƒ½è¦åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ¥å¤„ç†ï¼Œå¸¸è§„åœºæ™¯æ¯è¿æ¥æ¯çº¿ç¨‹è¿˜å¾ˆç¨³å®šï¼Œä½†é«˜å¹¶å‘åœºæ™¯ä¸‹å°±æ˜¯ç¾éš¾ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹å¤§ä¿ƒæœŸé—´çš„åœºæ™¯ï¼šæˆåƒä¸Šä¸‡ä¸ªè¿æ¥åŒæ—¶æ¶Œå…¥æ•°æ®åº“ï¼Œæ¯ä¸ªè¿æ¥éƒ½è¦åˆ›å»ºçº¿ç¨‹ï¼Œçº¿ç¨‹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€å·¨å¤§ï¼ŒCPUå¿™ç€åšä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒçœŸæ­£ç”¨æ¥å¤„ç†SQLçš„æ—¶é—´åè€Œä¸å¤šã€‚æ›´è¦å‘½çš„æ˜¯ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ä¸€è§†åŒä»ï¼Œæ ¸å¿ƒçš„æ”¯ä»˜æŸ¥è¯¢å¯èƒ½è¢«å¤§é‡çš„æ—¥å¿—å†™å…¥ã€æŠ¥è¡¨æŸ¥è¯¢è¿™äº›ä¸ç´§æ€¥çš„è¯·æ±‚ç»™"æ·¹æ²¡"äº†ã€‚åœ¨JEDæ¶æ„ä¸‹ï¼Œç”±vitessæ§åˆ¶äº†è¿æ¥çš„æ•°é‡ï¼Œè¿™ä¸ªé—®é¢˜è¿˜ä¸å¤§ï¼Œä½†ç›®å‰DongDALç›´è¿DongSQLçš„æ¶æ„ï¼Œè¿™ä¸ªå°±æˆäº†ä¸å¾—ä¸é¢å¯¹çš„é‡ç‚¹é—®é¢˜ï¼</p>
<p>çº¿ç¨‹æ‹¥å µçš„é—®é¢˜çœ‹èµ·æ¥å’Œè¿‡è½½å¾ˆåƒï¼Œä½†è¿˜ç•¥æœ‰ä¸€ç‚¹åŒºåˆ«ã€‚è¿‡è½½åœºæ™¯å¯ä»¥ç²¾ç¡®è¯†åˆ«åˆ°ä¸ªåˆ«é—®é¢˜SQLï¼Œå¹¶è¿›è¡Œç²¾å‡†é™æµï¼Œä»è€Œä¿è¯ä¸å½±å“å…¶ä»–SQLã€‚è€Œçº¿ç¨‹æ‹¥å µçš„å¤§éƒ¨åˆ†ç”šè‡³æ‰€æœ‰è¿æ¥éƒ½æ˜¯æ­£å¸¸SQLï¼Œæ²¡æœ‰è°æ˜¯å—å®³è€…ï¼Œåªä¸è¿‡çªå‘æµé‡çœŸçš„å¤ªå¤§äº†ï¼æ‰€ä»¥è¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸ç¥­å‡ºå¤§æ€å™¨â€”â€”çº¿ç¨‹æ± ï¼</p>
<h5 data-id="heading-18"><strong>è§£ï¼šDongSQLçº¿ç¨‹æ± </strong></h5>
<p>æˆ‘ä»¬å®ç°äº†å®Œæ•´çš„çº¿ç¨‹æ± åŠŸèƒ½ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå¤ç”¨çº¿ç¨‹èµ„æºï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ã€‚çº¿ç¨‹æ± ä¼šç»´æŠ¤ä¸€ç»„å·¥ä½œçº¿ç¨‹ï¼Œæ–°æ¥çš„è¿æ¥è¯·æ±‚ä¼šè¢«åˆ†é…åˆ°ç©ºé—²çš„çº¿ç¨‹ä¸Šå¤„ç†ï¼Œè¿™æ ·å°±èƒ½å¤§å¤§å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæå‡é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæ¥è‡ªæ ¸å¿ƒæœåŠ¡å™¨/æ ¸å¿ƒç”¨æˆ·çš„è¯·æ±‚å°±èƒ½ä¼˜å…ˆå¾—åˆ°å¤„ç†ï¼Œä¸ä¼šè¢«å…¶ä»–ä¸é‚£ä¹ˆç´§æ€¥çš„è¯·æ±‚ç»™æŒ¤å äº†ã€‚ç³»ç»Ÿä¼šæ™ºèƒ½è¯†åˆ«é«˜ä¼˜å…ˆçº§è¿æ¥ï¼Œç¡®ä¿å…³é”®åŠŸèƒ½çš„å“åº”æ—¶é—´ã€‚</p>
<p>è¿™äº›ä¼˜åŒ–åŠŸèƒ½çš„åŠ å…¥ï¼Œè®©DongSQLåœ¨é«˜å¹¶å‘ã€å¤§æ•°æ®é‡çš„é›¶å”®ç”µå•†æ ¸å¿ƒåœºæ™¯ä¸‹å±•ç°å‡ºäº†æ›´å¼ºçš„ç¨³å®šæ€§å’Œæ€§èƒ½ã€‚æ¯ä¸€ä¸ªåŠŸèƒ½éƒ½æ˜¯æˆ‘ä»¬åœ¨å®é™…ä¸šåŠ¡ä¸­é‡åˆ°é—®é¢˜ã€åˆ†æé—®é¢˜ã€è§£å†³é—®é¢˜çš„ç»“æœï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©æ›´å¤šçš„å›¢é˜Ÿåº”å¯¹ç±»ä¼¼çš„æŒ‘æˆ˜ã€‚</p>
<h2 data-id="heading-19"><strong>ä¸‰ã€ç»“è¯­ï¼šæŠ€æœ¯çš„æˆè‰²åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong></h2>
<p>å¦‚æœè¯´æŠ€æœ¯çš„åº•è‰²ï¼Œæ˜¯æ±‚çŸ¥ã€æ˜¯æˆé•¿ã€æ˜¯æ‰§ç€ã€æ˜¯çƒ­å¿±ã€æ˜¯æˆ‘ä»¬æ‰€æœ‰æŠ€æœ¯äººå›¢ç»“åœ¨ä¸€èµ·çˆ†å‘å‡ºçš„åŠ›é‡ã€‚</p>
<p>é‚£ä¹ˆæŠ€æœ¯çš„æˆè‰²ï¼Œä¸€å®šæœ‰è„šè¸å®åœ°ï¼Œè¿½æ ¹æº¯æºï¼Œä¸æµ®äºè¡¨è±¡ï¼Œè€Œæ·±å…¥éª¨é«“åœ°è§£å†³æ ¹æœ¬é—®é¢˜ã€‚æ­£æ‰€è°“ï¼šæ±‚æœ¨ä¹‹é•¿è€…ï¼Œå¿…å›ºå…¶æ ¹æœ¬ï¼›æ¬²æµä¹‹è¿œè€…ï¼Œå¿…æµšå…¶æ³‰æºã€‚å¯¹äºæ•°æ®åº“ï¼Œåˆ™å¿…é¡»å…·å¤‡æŒæ§æ•°æ®åº“å†…æ ¸çš„èƒ½åŠ›ï¼Œæ–¹èƒ½ä½¿è‡ªèº«ä»¥åŠå…¶ä¸Šæ‰¿æ¥çš„ä¸šåŠ¡è¡Œç¨³è‡´è¿œã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œæ›´å®è§‚çš„ç»´åº¦ï¼ŒæŠ€æœ¯çš„æˆè‰²æˆ‘æƒ³åº”è¯¥å°±æ˜¯ä¸ºå›¢é˜Ÿã€ä¸ºå…¬å¸ã€ä¸ºç”¨æˆ·ã€ä¹ƒè‡³ä¸ºç¤¾ä¼šäº§ç”Ÿå®å®åœ¨åœ¨çš„ä»·å€¼å§ï¼æ­£å¦‚å…¬å¸ä½¿å‘½è¯´çš„é‚£æ ·ï¼š<strong>æŠ€æœ¯ä¸ºæœ¬ï¼Œè®©ç”Ÿæ´»æ›´ç¾å¥½ï¼</strong> è®©æˆ‘ä»¬æºæ‰‹æ‰€æœ‰ä¸šåŠ¡ç ”å‘å›¢é˜Ÿåšå®äº‹ã€æœ‰ä»·å€¼çš„äº‹ã€é•¿æœŸçš„äº‹ï¼Œä¸ºäº¬ä¸œçš„ 35711 æ¢¦æƒ³ä»˜å‡ºæˆ‘ä»¬è‡ªå·±çš„ä¸€ä»½åŠ›ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº¬ä¸œè‡ªç ”ç”µå•†æ•°æ®åº“å†…æ ¸DongSQLç®€ä»‹]]></title>    <link>https://juejin.cn/post/7579440586693984302</link>    <guid>https://juejin.cn/post/7579440586693984302</guid>    <pubDate>2025-12-03T09:44:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579440586693984302" data-draft-id="7579427549471850542" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº¬ä¸œè‡ªç ”ç”µå•†æ•°æ®åº“å†…æ ¸DongSQLç®€ä»‹"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T09:44:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº¬ä¸œè‡ªç ”ç”µå•†æ•°æ®åº“å†…æ ¸DongSQLç®€ä»‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:44:07.000Z" title="Wed Dec 03 2025 09:44:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å›¢é˜Ÿäºä»Šå¹´(2025.9)æ‰“ç£¨å‡ºäº†æ·±åº¦ä¼˜åŒ–çš„è‡ªç ”æ•°æ®åº“å†…æ ¸â€”â€”DongSQL V1.1.0ã€‚</p>
<p><em>[å¦‚æœå¯¹å‰å› åæœæ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥ç§»æ­¥ä¸Šä¸€ç¯‡æ–‡ç« </em><a href="https://link.juejin.cn?target=http%3A%2F%2Fsd.jd.com%2Farticle%2F47706%3FshareId%3D52009%26isHideShareButton%3D1" target="_blank" title="http://sd.jd.com/article/47706?shareId=52009&amp;isHideShareButton=1" ref="nofollow noopener noreferrer"> <em>ã€Šå®å‰‘é”‹ä»ç£¨ç ºå‡ºâ€”â€”é›¶å”®æ•°æ®åº“å†…æ ¸ï¼Œä¸ºå¤§ä¿ƒé“¸å‰‘ï¼ã€‹</em> </a><em>]</em></p>
<p>æœ¬æ–‡å°†æ·±åº¦è§£æDongSQLåœ¨è¯­æ³•æ‰©å±•ã€å¹¶å‘æ§åˆ¶ã€æŸ¥è¯¢ä¼˜åŒ–ç­‰æ–¹é¢çš„å†…æ ¸æ”¹é€ ï¼Œä»¥åŠåœ¨ç”µå•†åœºæ™¯ä¸‹çš„ä¼˜åŒ–å®è·µã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e6b2f39df7a49be869523ea82f78946~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=FZ0gLuiQ9p%2F%2FCL9ClrDi9GdpRFM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-0">1ã€DongSQLåœ¨è¯­æ³•æ‰©å±•ä¸Šçš„ä¼˜åŒ–</h2>
<h3 data-id="heading-1">1.1. RETURNINGå­å¥åŠŸèƒ½</h3>
<p><strong>â–¶ï¸ è¯­æ³•æ‰©å±•åˆ›æ–°</strong>ï¼šDongSQLåœ¨æ ‡å‡†SQLè¯­æ³•åŸºç¡€ä¸Šæ‰©å±•äº†RETURNINGå­å¥ï¼Œè¿™æ˜¯é‡è¦è¯­æ³•åˆ›æ–°ã€‚RETURNINGå­å¥å…è®¸DMLè¯­å¥(INSERTã€UPDATEã€DELETEã€REPLACE)åœ¨æ‰§è¡Œæ•°æ®ä¿®æ”¹æ“ä½œçš„åŒæ—¶è¿”å›å—å½±å“çš„è¡Œæ•°æ®ï¼Œæ— éœ€é¢å¤–æŸ¥è¯¢ã€‚</p>
<p>ä¼ ç»Ÿæ•°æ®åº“åœ¨æ‰§è¡ŒDMLæ“ä½œåï¼Œå¦‚æœéœ€è¦è·å–æ“ä½œç»“æœï¼Œå¿…é¡»æ‰§è¡Œé¢å¤–çš„SELECTæŸ¥è¯¢ï¼Œè¿™åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä¼šäº§ç”Ÿé¢å¤–çš„ç½‘ç»œå¾€è¿”å¼€é”€ã€‚DongSQLé€šè¿‡RETURNINGå­å¥å½»åº•è§£å†³äº†è¿™ä¸€é—®é¢˜ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â INSERTæ“ä½œè¿”å›è‡ªå¢IDÂ </span>
<span class="hljs-keyword">INSERT</span>Â <span class="hljs-keyword">INTO</span>Â ordersÂ (customer_id,Â order_date)Â <span class="hljs-keyword">VALUES</span>Â (<span class="hljs-number">1001</span>,Â NOW())Â RETURNINGÂ order_id;Â 

<span class="hljs-comment">--Â UPDATEæ“ä½œè¿”å›æ›´æ–°åçš„æ•°æ®Â </span>
<span class="hljs-keyword">UPDATE</span>Â productsÂ <span class="hljs-keyword">SET</span>Â priceÂ <span class="hljs-operator">=</span>Â priceÂ <span class="hljs-operator">*</span>Â <span class="hljs-number">1.1</span>Â <span class="hljs-keyword">WHERE</span>Â categoryÂ <span class="hljs-operator">=</span>Â <span class="hljs-string">'electronics'</span>Â Â 
RETURNINGÂ product_id,Â name,Â old_price,Â price;Â 

<span class="hljs-comment">--Â DELETEæ“ä½œè¿”å›è¢«åˆ é™¤çš„è®°å½•Â </span>
<span class="hljs-keyword">DELETE</span>Â <span class="hljs-keyword">FROM</span>Â expired_sessionsÂ <span class="hljs-keyword">WHERE</span>Â expire_timeÂ <span class="hljs-operator">&lt;</span>Â NOW()Â Â 
RETURNINGÂ session_id,Â user_id,Â expire_time;
</code></pre>
<p><strong>â–¶ï¸ æ€§èƒ½æå‡æ•ˆæœ</strong>ï¼šç»æµ‹è¯•éªŒè¯ï¼ŒRETURNINGå­å¥åœ¨ä¸åŒåœºæ™¯ä¸‹éƒ½èƒ½å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼š</p>
<p>â€¢<strong>å›ºå®šè¡Œæ›´æ–°åœºæ™¯</strong>ï¼š16å¹¶å‘æ—¶TPSæå‡61%ï¼Œå“åº”æ—¶é—´é™ä½44%</p>
<p>â€¢<strong>éšæœºè¡Œæ›´æ–°åœºæ™¯</strong>ï¼š128å¹¶å‘æ—¶TPSæå‡18%</p>
<p>â€¢<strong>å¤§è§„æ¨¡æ›´æ–°æµ‹è¯•</strong>ï¼š2000ä¸‡æ¬¡æ“ä½œä¸­å¹³å‡TPSæå‡5-10%</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62994ddf0b9a439eb780bd0e98832c43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=HfUlNXPwXmyFdspZTwvavR0w3jc%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><strong>â–¶ï¸ ç”Ÿäº§è½åœ°é¢„æœŸ</strong>ï¼šè¯¥åŠŸèƒ½ä¸DongDALå‘å·å™¨é€»è¾‘é«˜åº¦åŒ¹é…ï¼Œæœ‰æœ›å°†å‘å·å™¨æ€§èƒ½ç“¶é¢ˆå¤§å¹…æå‡(DongDALå›¢é˜Ÿé…å¥—å¼€å‘æ¨è¿›ä¸­)</p>
<h3 data-id="heading-2">1.2. Hintè¯­æ³•æ‰©å±•</h3>
<p><strong>â–¶ï¸ å¤šæ ·åŒ–Hintæ”¯æŒ</strong>ï¼šDongSQLæ‰©å±•äº†Hintè¯­æ³•ä½“ç³»ï¼Œæä¾›äº†é’ˆå¯¹ç”µå•†åœºæ™¯çš„ä¸“ç”¨æç¤ºåŠŸèƒ½ï¼ŒåŒ…æ‹¬å¹¶å‘æ§åˆ¶ã€åº“å­˜ç®¡ç†ç­‰é¢†åŸŸç‰¹å®šçš„ä¼˜åŒ–ã€‚</p>
<p><strong>â–¶ï¸ Inventory Hint</strong>ï¼šä¸“é—¨é’ˆå¯¹ç”µå•†åº“å­˜ç®¡ç†åœºæ™¯è®¾è®¡çš„æç¤ºè¯­æ³•ï¼Œæä¾›ç›®æ ‡å½±å“è¡Œæ•°æ§åˆ¶ã€è‡ªåŠ¨æäº¤/å›æ»šç­‰ç‰¹æ€§ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">--Â åº“å­˜æ‰£å‡ï¼šç¡®ä¿åªå½±å“ä¸€è¡Œï¼ŒæˆåŠŸè‡ªåŠ¨æäº¤ï¼Œå¤±è´¥è‡ªåŠ¨å›æ»š
Â UPDATEÂ /*+Â TARGET_AFFECT_ROW(1)Â COMMIT_ON_SUCCESSÂ ROLLBACK_ON_FAILÂ */
Â Â inventoryÂ SETÂ <span class="hljs-attr">stock</span>Â =Â stockÂ -Â <span class="hljs-number">5</span>Â 
Â Â Â WHEREÂ <span class="hljs-attr">product_id</span>Â =Â <span class="hljs-number">1001</span>Â ANDÂ stockÂ &gt;=Â <span class="hljs-number">5</span><span class="hljs-comment">;</span>
</code></pre>
<p><strong>â–¶ï¸ æ€§èƒ½æå‡æ•°æ®</strong>ï¼šåœ¨16å¹¶å‘çš„åº“å­˜æ‰£å‡åœºæ™¯ä¸‹ï¼Œä½¿ç”¨Inventory Hintæ¯”ä¸ä½¿ç”¨hintæ€§èƒ½æå‡215%ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a5827558dac469aa23633899c68b0a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=YMq3blQi4Z9AEp%2BoK1jT9G8HqTQ%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-3">2ã€DongSQLåœ¨å¹¶å‘æ§åˆ¶ä¸Šçš„ä¼˜åŒ–</h2>
<h3 data-id="heading-4">2.1. CCLå¹¶å‘æ§åˆ¶</h3>
<p><strong>â–¶ï¸ å¤šç»´åº¦é™æµæœºåˆ¶</strong>ï¼šDongSQLå®ç°äº†CCL(Concurrency Control)å¹¶å‘æ§åˆ¶åŠŸèƒ½ï¼Œé€šè¿‡å¤šç»´åº¦çš„é™æµç­–ç•¥ï¼Œæœ‰æ•ˆè§£å†³ç”µå•†ç§’æ€åœºæ™¯ä¸‹çš„çƒ­ç‚¹æ•°æ®è®¿é—®é—®é¢˜ã€‚</p>
<p>ä¼ ç»Ÿæ•°æ®åº“åœ¨é¢å¯¹é«˜å¹¶å‘çƒ­ç‚¹æ•°æ®è®¿é—®æ—¶ï¼Œå¾€å¾€ä¼šå› ä¸ºæ¿€çƒˆçš„é”ç«äº‰å¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œç”šè‡³ç³»ç»Ÿé›ªå´©ã€‚DongSQLçš„CCLé€šè¿‡æ™ºèƒ½æ’é˜Ÿæœºåˆ¶ï¼Œå°†æ— åºçš„å¹¶å‘è¯·æ±‚è½¬æ¢ä¸ºæœ‰åºå¤„ç†ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†è¿™ä¸€é—®é¢˜ã€‚</p>
<p><strong>â–¶ï¸ å¤šç»´åº¦æ§åˆ¶ç­–ç•¥</strong>ï¼š</p>
<p>â€¢<strong>åŸºäºå­—æ®µçš„é™æµ</strong>ï¼š<code>ccl_queue_field(column_name, concurrency)</code>ï¼Œå¯¹ç‰¹å®šå­—æ®µå€¼è¿›è¡Œå¹¶å‘æ§åˆ¶</p>
<p>â€¢<strong>åŸºäºå€¼çš„é™æµ</strong>ï¼š<code>ccl_queue_value(value, concurrency)</code>ï¼Œå¯¹ç‰¹å®šæ•°æ®å€¼è¿›è¡Œç²¾å‡†é™æµ</p>
<p>â€¢<strong>åŸºäºSQLæŒ‡çº¹çš„é™æµ</strong>ï¼š<code>ccl_queue_digest(concurrency)</code>ï¼Œå¯¹ç›¸åŒSQLæ¨¡å¼è¿›è¡Œç»Ÿä¸€ç®¡æ§</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â å¯¹å•†å“IDä¸º999çš„çƒ­é—¨å•†å“è¿›è¡Œé™æµï¼Œå¹¶å‘åº¦é™åˆ¶ä¸º5</span>
Â <span class="hljs-keyword">SELECT</span>Â <span class="hljs-comment">/*+Â ccl_queue_value(999,Â 5)Â */</span>Â <span class="hljs-operator">*</span>Â <span class="hljs-keyword">FROM</span>Â productsÂ <span class="hljs-keyword">WHERE</span>Â product_idÂ <span class="hljs-operator">=</span>Â <span class="hljs-number">999</span>;Â 
Â 
Â <span class="hljs-comment">--Â å¯¹åº“å­˜æ‰£å‡æ“ä½œæŒ‰å•†å“IDè¿›è¡Œé™æµÂ </span>
Â <span class="hljs-keyword">UPDATE</span>Â <span class="hljs-comment">/*+Â ccl_queue_field(product_id,Â 8)Â */</span>Â inventoryÂ <span class="hljs-keyword">SET</span>Â stockÂ <span class="hljs-operator">=</span>Â stockÂ <span class="hljs-operator">-</span>Â <span class="hljs-number">1</span>Â <span class="hljs-keyword">WHERE</span>Â product_idÂ <span class="hljs-operator">=</span>Â ?;Â 
Â 
Â <span class="hljs-comment">--Â å¯¹ç›¸åŒSQLæ¨¡å¼è¿›è¡Œç»Ÿä¸€é™æµÂ </span>
Â <span class="hljs-keyword">SELECT</span>Â <span class="hljs-comment">/*+Â ccl_queue_digest(10)Â */</span>Â <span class="hljs-operator">*</span>Â <span class="hljs-keyword">FROM</span>Â hot_productsÂ <span class="hljs-keyword">WHERE</span>Â statusÂ <span class="hljs-operator">=</span>Â <span class="hljs-number">1</span>;
</code></pre>
<p><strong>â–¶ï¸ æ€§èƒ½çªç ´æ•°æ®</strong>ï¼š</p>
<p>â€¢<strong>ç§’æ€åœºæ™¯ä¼˜åŒ–</strong>ï¼šåœ¨4096å¹¶å‘ä¸‹ï¼Œä½¿ç”¨CCLé™æµåTPSä»573æå‡è‡³1337ï¼Œæ€§èƒ½æå‡133%</p>
<p>â€¢<strong>ç³»ç»Ÿç¨³å®šæ€§</strong>ï¼šæœ‰æ•ˆé˜²æ­¢ç³»ç»Ÿé›ªå´©ï¼Œå°†æ— åºå¹¶å‘è½¬æ¢ä¸ºæœ‰åºå¤„ç†</p>
<p>â€¢<strong>çƒ­ç‚¹ç¼“è§£</strong>ï¼šé€šè¿‡é˜Ÿåˆ—æœºåˆ¶æ˜¾è‘—é™ä½çƒ­ç‚¹æ•°æ®çš„é”ç«äº‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/853112ad066541f39608b88cdda91325~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=7P3xIjvJjwLakQOpp47PQ%2Bs5Qec%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-5">2.2. Statement Outlineæ‰§è¡Œè®¡åˆ’åŠè‡ªå®šä¹‰æç¤ºç®¡ç†</h3>
<p><strong>â–¶ï¸ ä¼ä¸šçº§è®¡åˆ’ç¨³å®šæ€§</strong>ï¼šDongSQLæä¾›äº†Statement OutlineåŠŸèƒ½ï¼Œç”¨äºå›ºåŒ–é‡è¦SQLçš„æ‰§è¡Œè®¡åˆ’ï¼Œé˜²æ­¢å› æ•°æ®å˜åŒ–å¯¼è‡´çš„è®¡åˆ’ä¸ç¨³å®šé—®é¢˜ã€‚</p>
<p><strong>â–¶ï¸ è‡ªå®šä¹‰Hintæ³¨å…¥å·¥å…·</strong>ï¼šåŒ…æ‹¬ä½†ä¸é™äºä¸Šè¿°ç§’æ€ã€CCLé™æµåœºæ™¯çš„Hintï¼Œå³ä½¿ä¸šåŠ¡ç ”å‘é¢„æœŸå¤–çš„è¿‡è½½æˆ–è€…çªå‘æµé‡å‘ç”Ÿï¼Œåº”æ€¥æƒ…å†µä¸‹DBAä¹Ÿå¯ä»¥é€šè¿‡Statement OutlineåŠŸèƒ½å¯¹é—®é¢˜SQLè¿›è¡Œå¹²é¢„</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â ä¸ºé‡è¦SQLå›ºåŒ–æ‰§è¡Œè®¡åˆ’Â </span>
<span class="hljs-keyword">CALL</span>Â dbms_outln.add_index_outline(Â Â 
<span class="hljs-string">'test_db'</span>,Â <span class="hljs-string">''</span>,Â <span class="hljs-number">1</span>,Â <span class="hljs-string">'USEÂ INDEX'</span>,Â <span class="hljs-string">'idx_status'</span>,Â <span class="hljs-string">''</span>,Â Â 
Â <span class="hljs-string">'SELECTÂ *Â FROMÂ ordersÂ WHEREÂ statusÂ =Â "PAID"'</span>Â 
Â );Â 
Â <span class="hljs-comment">--Â ä¸ºç‰¹å®šæŸ¥è¯¢æ·»åŠ ccl_queue_digesté™æµhintï¼Œé™åˆ¶å¹¶å‘åº¦ä¸º2Â </span>
<span class="hljs-keyword">CALL</span>Â dbms_outln.add_optimizer_outline(Â Â 
<span class="hljs-string">'test_db'</span>,Â <span class="hljs-string">''</span>,Â <span class="hljs-number">1</span>,Â <span class="hljs-string">'/*+Â ccl_queue_digest(2)Â */'</span>,Â Â 
<span class="hljs-string">'SELECTÂ *Â FROMÂ ordersÂ WHEREÂ customer_idÂ =Â 1001'</span>Â );
</code></pre>
<p><strong>â–¶ï¸ æ ¸å¿ƒä»·å€¼</strong>ï¼š</p>
<p>â€¢<strong>æ€§èƒ½ç¨³å®šæ€§</strong>ï¼šä¿éšœæ ¸å¿ƒSQLæ€§èƒ½ä¸å› æ•°æ®å˜åŒ–è€Œæ³¢åŠ¨</p>
<p>â€¢<strong>æ™ºèƒ½é™æµ</strong>ï¼šæ”¯æŒåŸºäºSQLæŒ‡çº¹çš„æ‰‹åŠ¨é™æµå’Œè‡ªåŠ¨é™æµ(è‡ªåŠ¨é™æµé»˜è®¤ä¸å¼€å¯ï¼Œéœ€è¦å¼€å¯çš„ä¸šåŠ¡éœ€å•ç‹¬ç”³è¯·)</p>
<p>â€¢<strong>ä¼ä¸šçº§ç®¡ç†</strong>ï¼šæä¾›ç”Ÿäº§çº§çš„æ‰§è¡Œè®¡åˆ’ç®¡ç†èƒ½åŠ›</p>
<h2 data-id="heading-6">3ã€DongSQLåœ¨æŸ¥è¯¢ä¼˜åŒ–ä¸Šçš„æ”¹è¿›</h2>
<h3 data-id="heading-7">3.1. å•ç‚¹æŸ¥è¯¢ä¼˜åŒ–</h3>
<p><strong>â–¶ï¸ æŸ¥è¯¢è·¯å¾„ä¼˜åŒ–</strong>ï¼šDongSQLå®ç°äº†å•ç‚¹æŸ¥è¯¢bypassåŠŸèƒ½ï¼Œé’ˆå¯¹ä¸»é”®ç­‰å€¼æŸ¥è¯¢è¿™ç±»é«˜é¢‘ç®€å•æŸ¥è¯¢ï¼Œç»•è¿‡éƒ¨åˆ†SQLå±‚å¤„ç†é€»è¾‘ï¼Œç›´æ¥è®¿é—®å­˜å‚¨å¼•æ“ï¼Œå¤§å¹…æå‡æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>ç”µå•†åœºæ™¯ä¸­ï¼Œå•†å“è¯¦æƒ…æŸ¥è¯¢ã€ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ç­‰åŸºäºä¸»é”®çš„ç®€å•æŸ¥è¯¢å æ®äº†å¾ˆå¤§æ¯”ä¾‹ã€‚è™½ç„¶è¿™äº›æŸ¥è¯¢é€»è¾‘ç®€å•ï¼Œä½†åœ¨é«˜å¹¶å‘ä¸‹ä»ç„¶æ¶ˆè€—å¤§é‡CPUèµ„æºã€‚DongSQLçš„å•ç‚¹æŸ¥è¯¢ä¼˜åŒ–é’ˆå¯¹è¿™ä¸€ç—›ç‚¹è¿›è¡Œäº†ä¸“é¡¹ä¼˜åŒ–ã€‚</p>
<p><strong>â–¶ï¸ æ€§èƒ½æå‡æ•°æ®</strong>ï¼š</p>
<p>â€¢<strong>ä¸åŒç¯å¢ƒæ€§èƒ½æå‡</strong>ï¼šå®¹å™¨ç¯å¢ƒæå‡20%ï¼Œç‰©ç†æœºç¯å¢ƒæå‡30%</p>
<p>â€¢<strong>é«˜å¹¶å‘åœºæ™¯</strong>ï¼šå½“CPUè¾¾åˆ°ç“¶é¢ˆæ—¶ï¼ŒQPSæå‡20-28%</p>
<p>â€¢<strong>èµ„æºæ•ˆç‡</strong>ï¼šç›¸åŒç¡¬ä»¶é…ç½®ä¸‹å¤„ç†èƒ½åŠ›æ˜¾è‘—æå‡</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/246092d7b5474dedb667a73110149ae4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=o2blg0q5THYoHHPbqKiFb4aHNo4%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-8">3.2. çº¿ç¨‹æ± ä¼˜åŒ–</h3>
<p><strong>â–¶ï¸ é«˜å¹¶å‘å¤„ç†èƒ½åŠ›</strong>ï¼šDongSQLå®ç°äº†ä¼ä¸šçº§çº¿ç¨‹æ± åŠŸèƒ½ï¼Œé€šè¿‡æ™ºèƒ½çº¿ç¨‹è°ƒåº¦å’Œèµ„æºç®¡ç†ï¼Œæ˜¾è‘—æå‡äº†ç³»ç»Ÿåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹çš„å¤„ç†èƒ½åŠ›å’Œç¨³å®šæ€§ã€‚</p>
<p>ä¼ ç»Ÿæ•°æ®åº“åœ¨é¢å¯¹å¤§é‡å¹¶å‘è¿æ¥æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºç‹¬ç«‹çº¿ç¨‹ï¼Œè¿™åœ¨é«˜å¹¶å‘ä¸‹ä¼šå¯¼è‡´çº¿ç¨‹åˆ‡æ¢å¼€é”€è¿‡å¤§ã€å†…å­˜æ¶ˆè€—æ¿€å¢ç­‰é—®é¢˜ã€‚DongSQLçš„çº¿ç¨‹æ± ä¼˜åŒ–é€šè¿‡å¤ç”¨çº¿ç¨‹èµ„æºï¼Œæœ‰æ•ˆè§£å†³äº†è¿™äº›é—®é¢˜ã€‚</p>
<p><strong>â–¶ï¸ è°ƒåº¦æœºåˆ¶</strong>ï¼š</p>
<p>â€¢<strong>çº¿ç¨‹å¤ç”¨ï¼š</strong> é€šè¿‡çº¿ç¨‹æ± å¤ç”¨å‡å°‘çº¿ç¨‹åˆ›å»ºé”€æ¯å¼€é”€</p>
<p>â€¢<strong>è´Ÿè½½å‡è¡¡ï¼š</strong> åˆ†é…ä»»åŠ¡åˆ°ä¸åŒçº¿ç¨‹ï¼Œé¿å…çƒ­ç‚¹çº¿ç¨‹</p>
<p>â€¢<strong>ä¼˜å…ˆçº§è°ƒåº¦ï¼š</strong> æ”¯æŒä»»åŠ¡ä¼˜å…ˆçº§ï¼Œä¿éšœé‡è¦ä¸šåŠ¡ä¼˜å…ˆå¤„ç†</p>
<p><strong>â–¶ï¸ æ€§èƒ½çªç ´æ•°æ®</strong>ï¼ˆåŸºäº8C32Gæµ‹è¯•ç¯å¢ƒï¼Œsysbench 16å¼ è¡¨æ¯å¼ 1000ä¸‡è¡Œæ•°æ®ï¼‰ï¼š</p>
<p><strong>åªè¯»åœºæ™¯æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p>
<p>â€¢<strong>ä½å¹¶å‘ä¼˜åŠ¿</strong>ï¼š32çº¿ç¨‹æ—¶ï¼Œçº¿ç¨‹æ± æ¨¡å¼QPSè¾¾åˆ°141,261ï¼Œç›¸æ¯”ä¼ ç»Ÿæ¨¡å¼çš„110,658æå‡27.6%</p>
<p>â€¢<strong>é«˜å¹¶å‘ç¨³å®šæ€§</strong>ï¼šåœ¨512çº¿ç¨‹é«˜å¹¶å‘ä¸‹ï¼Œçº¿ç¨‹æ± æ¨¡å¼QPSä¿æŒ131,939ï¼Œè€Œä¼ ç»Ÿæ¨¡å¼ä»…61,580ï¼Œæ€§èƒ½æå‡114%</p>
<p>â€¢<strong>å»¶è¿Ÿæ§åˆ¶</strong>ï¼š512çº¿ç¨‹æ—¶TP99å»¶è¿Ÿä»ä¼ ç»Ÿæ¨¡å¼çš„297.92msä¼˜åŒ–åˆ°118.92msï¼Œé™ä½60%</p>
<p><strong>çº¯å†™åœºæ™¯æ€§èƒ½çªç ´</strong>ï¼š</p>
<p>â€¢<strong>ä¸­ç­‰å¹¶å‘</strong>ï¼š64çº¿ç¨‹æ—¶QPSä»46,577æå‡åˆ°57,655ï¼Œæ€§èƒ½æå‡23.8%</p>
<p>â€¢<strong>é«˜å¹¶å‘åœºæ™¯</strong>ï¼š512çº¿ç¨‹æ—¶QPSä»29,541æå‡åˆ°58,166ï¼Œæ€§èƒ½æå‡97%</p>
<p>â€¢<strong>è¶…é«˜å¹¶å‘</strong>ï¼š4096çº¿ç¨‹æ—¶QPSä»28,571æå‡åˆ°54,687ï¼Œæ€§èƒ½æå‡91%</p>
<p><strong>è¯»å†™æ··åˆåœºæ™¯ä¼˜åŒ–</strong>ï¼š</p>
<p>â€¢<strong>128çº¿ç¨‹</strong>ï¼šQPSä»54,870æå‡åˆ°80,244ï¼Œæ€§èƒ½æå‡46%</p>
<p>â€¢<strong>256çº¿ç¨‹</strong>ï¼šQPSä»48,787æå‡åˆ°77,961ï¼Œæ€§èƒ½æå‡60%</p>
<p>â€¢<strong>å»¶è¿Ÿä¼˜åŒ–</strong>ï¼š256çº¿ç¨‹æ—¶TP99å»¶è¿Ÿä»196.89msä¼˜åŒ–åˆ°158.63msï¼Œé™ä½19%</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/853868c0a1cb4256942759766e9739e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765359847&amp;x-signature=uhYejtH%2BSG6rLu8JlS8VDzxgI7Y%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-9">3.3. Â å…¶ä»–æŸ¥è¯¢æ‰§è¡Œä¼˜åŒ–</h3>
<p><strong>â–¶ï¸ æ‰§è¡Œè·¯å¾„ä¼˜åŒ–</strong>ï¼šDongSQLåœ¨æŸ¥è¯¢æ‰§è¡Œå¼•æ“å±‚é¢è¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ç®—å­ä¼˜åŒ–ã€å†…å­˜ç®¡ç†ä¼˜åŒ–ã€å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–ç­‰ã€‚</p>
<p><strong>â–¶ï¸ ç¼“å­˜æœºåˆ¶å¢å¼º</strong>ï¼šä¼˜åŒ–äº†Buffer Poolç®¡ç†ç­–ç•¥ï¼Œé¡µé¢mutexä¼˜åŒ–ï¼Œæå‡äº†æ•°æ®è®¿é—®æ•ˆç‡ï¼Œé™ä½äº†I/Oé”å†²çªã€‚</p>
<h2 data-id="heading-10">4ã€æ€§èƒ½åŸºå‡†æµ‹è¯•æ±‡æ€»</h2>
<h3 data-id="heading-11">OLTPæ ‡å‡†åŸºå‡†æµ‹è¯•</h3>
<p>åŸºäºæ ‡å‡†æµ‹è¯•ç¯å¢ƒçš„æ€§èƒ½æ•°æ®ï¼ˆ16C32G, 16å¼ è¡¨ï¼Œæ¯å¼ è¡¨100ä¸‡è¡Œï¼‰ï¼š</p>





















































<table><thead><tr><th>æµ‹è¯•åœºæ™¯</th><th>æœ€ä½³çº¿ç¨‹æ•°</th><th>TPS</th><th>QPS</th><th>TP99å»¶è¿Ÿ</th><th>å¹³å‡å»¶è¿Ÿ</th></tr></thead><tbody><tr><td>åªè¯»æŸ¥è¯¢</td><td>64</td><td>19,484</td><td>311,745</td><td>21.50ms</td><td>3.28ms</td></tr><tr><td>åªå†™æ“ä½œ</td><td>256</td><td>17,004</td><td>102,025</td><td>29.72ms</td><td>15.05ms</td></tr><tr><td>æ’å…¥æ“ä½œ</td><td>256</td><td>25,614</td><td>25,614</td><td>15.83ms</td><td>9.99ms</td></tr><tr><td>è¯»å†™æ··åˆ</td><td>128</td><td>9,795</td><td>195,908</td><td>33.12ms</td><td>13.06ms</td></tr><tr><td>ç‚¹æŸ¥è¯¢</td><td>64</td><td>560,933</td><td>560,933</td><td>0.18ms</td><td>0.11ms</td></tr></tbody></table>
<h3 data-id="heading-12">ç”µå•†åœºæ™¯ä¸“é¡¹æ€§èƒ½æ±‡æ€»</h3>



































<table><thead><tr><th>ä¼˜åŒ–æ¨¡å—</th><th>æµ‹è¯•åœºæ™¯</th><th>æ€§èƒ½æå‡å¹…åº¦</th><th>å…³é”®æŒ‡æ ‡</th></tr></thead><tbody><tr><td><strong>RETURNINGå­å¥</strong></td><td>å›ºå®šè¡Œæ›´æ–°</td><td><strong>61%</strong></td><td>TPS: 925â†’1,490</td></tr><tr><td><strong>CCLå¹¶å‘æ§åˆ¶</strong></td><td>ç§’æ€åœºæ™¯</td><td><strong>133%</strong></td><td>TPS: 573â†’1,337</td></tr><tr><td><strong>Inventory Hint</strong></td><td>åº“å­˜æ‰£å‡</td><td><strong>215%</strong></td><td>TPS: 1,537â†’4,843</td></tr><tr><td><strong>å•ç‚¹æŸ¥è¯¢ä¼˜åŒ–</strong></td><td>ä¸»é”®æŸ¥è¯¢</td><td><strong>28%</strong></td><td>QPS: 76,432â†’98,470</td></tr></tbody></table>
<h2 data-id="heading-13">5ã€æœªæ¥è§„åˆ’</h2>
<p>1.<strong>æŒç»­è¯­æ³•æ‰©å±•</strong>ï¼šåŸºäºä¸šåŠ¡éœ€æ±‚ç»§ç»­æ‰©å±•SQLè¯­æ³•åŠŸèƒ½</p>
<p>2.<strong>æ™ºèƒ½ä¼˜åŒ–å¢å¼º</strong>ï¼šå¼•å…¥æœºå™¨å­¦ä¹ ä¼˜åŒ–æ‰§è¡Œè®¡åˆ’é€‰æ‹©</p>
<p>3.<strong>å†…æ ¸çº§æŠ€æœ¯æ”¯æŒ</strong>ï¼šå…·å¤‡å†…æ ¸ç ”å‘èƒ½åŠ›çš„å›¢é˜Ÿï¼ŒæŒç»­ä»æœ€åº•å±‚ä¸ºä¸šåŠ¡ç ”å‘æä¾›æ·±åº¦ä¼˜åŒ–çš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆ</p>
<p>4.<strong>äº‘åŸç”Ÿå­˜ç®—åˆ†ç¦»</strong>ï¼šç»§ç»­æ‰“é€ å±äºäº¬ä¸œè‡ªå·±çš„é«˜æ€§èƒ½ä½æˆæœ¬æ•°æ®åº“äº§å“</p>
<h2 data-id="heading-14">6ã€ç»“è¯­</h2>
<p>ä»å¼€æºå†…æ ¸åˆ°è‡ªç ”DongSQLï¼Œäº¬ä¸œé›¶å”®æ•°æ®åº“å›¢é˜Ÿå§‹ç»ˆä»¥"ä¸šåŠ¡ä»·å€¼é©±åŠ¨æŠ€æœ¯åˆ›æ–°"ä¸ºæ ¸å¿ƒç†å¿µã€‚DongSQLä½œä¸ºä¸“ä¸ºäº¬ä¸œç”µå•†åœºæ™¯è®¾è®¡çš„æ•°æ®åº“ï¼Œé€šè¿‡è¯­æ³•æ‰©å±•ã€å¹¶å‘æ§åˆ¶ã€æŸ¥è¯¢ä¼˜åŒ–ç­‰å¤šä¸ªæ¨¡å—çš„æ·±åº¦åˆ›æ–°ï¼Œä¸ºç”µå•†ä¸šåŠ¡çš„å¿«é€Ÿå‘å±•æä¾›äº†å¼ºæœ‰åŠ›çš„æ•°æ®åº“æŠ€æœ¯æ”¯æ’‘ã€‚</p>
<p>è¿™äº›ä¼˜åŒ–ä¸ä»…æå‡äº†ç³»ç»Ÿæ€§èƒ½ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ºé›†å›¢åŸºç¡€æŠ€æœ¯åº•åº§æä¾›äº†åšå®çš„åŸºç¡€ã€‚æœªæ¥ï¼Œäº¬ä¸œé›¶å”®æ•°æ®åº“å›¢é˜Ÿå°†æŒç»­æ·±è€•æ•°æ®åº“å†…æ ¸æŠ€æœ¯ï¼Œè®©æ•°æ®åº“æ›´å¥½åœ°æœåŠ¡ä¸šåŠ¡å‘å±•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Trae SOLOé¡¹ç›®çœŸå®éœ€æ±‚]]></title>    <link>https://juejin.cn/post/7572997791451611174</link>    <guid>https://juejin.cn/post/7572997791451611174</guid>    <pubDate>2025-11-17T02:42:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7572997791451611174" data-draft-id="7572115057221369891" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Trae SOLOé¡¹ç›®çœŸå®éœ€æ±‚"/> <meta itemprop="keywords" content="Trae,å‰ç«¯,å‰ç«¯å·¥ç¨‹åŒ–"/> <meta itemprop="datePublished" content="2025-11-17T02:42:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰å¸½lufei"/> <meta itemprop="url" content="https://juejin.cn/user/501033035632093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Trae SOLOé¡¹ç›®çœŸå®éœ€æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/501033035632093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰å¸½lufei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T02:42:42.000Z" title="Mon Nov 17 2025 02:42:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    155
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>çœ‹åˆ° Trae SOLO æ¨¡å¼é™æ—¶å…è´¹äº†ï¼Œè¶ç€å…è´¹ï¼Œèµ¶ç´§ä½“éªŒä¸€æ³¢ï¼ŒDemo ä»€ä¹ˆçš„å°±ä¸è¯•äº†ï¼Œç›´æ¥ç”¨ SOLO æ¨¡å¼ SOLO ä¸šåŠ¡é¡¹ç›®ï¼Œå¼€å¹²ï¼Œæœ€ç»ˆç›®æ ‡éƒ½æ˜¯è¦æœåŠ¡äºä¸šåŠ¡é¡¹ç›®çš„</p>
<p>æˆ‘æ˜¯ä¸€åŠæ¯›å‰ç«¯å¼€å‘ï¼Œå°±ä»å½“å‰åšçš„å‰ç«¯é¡¹ç›®å¼€ç”¨å§ï¼Œæ¥ä¸‹æ¥å¹²çš„æ´»æ˜¯æ”¹å¤§å±é¡µï¼Œå°±ä»å¤§å±é¡µé¢å¼€å§‹ï¼Œæ™®é€šä¸šåŠ¡é€»è¾‘çš„è¯å„è·¯ AI å¯èƒ½è¡¨ç°éƒ½è¿˜è¡Œï¼Œä¹‹å‰æµ‹è¯•çš„æ˜¯å¤§å±è¿™ç§æ˜æ˜¾é æ„Ÿè§‰çš„è¿˜æ˜¯å·®ç‚¹æ„æ€ï¼Œå¤§å±é¡µé¢åŸºæœ¬ä¸»è¦è¿˜æ˜¯æ‰‹åŠ¨æ”¹</p>
<h2 data-id="heading-1">ä½¿ç”¨ SOLO</h2>
<h3 data-id="heading-2">ç•Œé¢åˆ†æ</h3>
<p>æ›´æ–° Trae åæ‰“å¼€é¡¹ç›®ï¼Œåˆ†ä¸º4å¤§å—ï¼Œä»å·¦åˆ°å³åˆ†åˆ«æ˜¯ SOLOæ¨¡å¼ä»»åŠ¡ï¼Œå¯¹è¯åŒºï¼Œä»£ç åŒºï¼Œèµ„æºç®¡ç†å™¨ï¼Œè¿™ç‚¹å’Œå¸¸è§çš„ç¼–è¾‘å™¨é»˜è®¤æ’ç‰ˆåˆšå¥½ç›¸åï¼Œä¸è¿‡æ— æ‰€è°“ï¼Œæ—¢ç„¶è¿™ä¹ˆè®¾è®¡ï¼Œè‚¯å®šæ˜¯æœ‰ä»–çš„é“ç†çš„ï¼Œå› ä¸ºç°åœ¨æ¨¡å¼å˜äº†ï¼Œä¸»è¦ä»¥å¯¹è¯ï¼Œä»»åŠ¡æè¿°ä¸ºä¸»ï¼Œç„¶åå†çœ‹ä»£ç </p>
<h3 data-id="heading-3">å¼€å§‹å¯¹è¯</h3>
<p>ä¸‹é¢æ˜¯æˆ‘è¿è¡Œé¡¹ç›®åï¼Œå…ˆåœ¨å¯¹è¯åŒºå…ˆè®©å®ƒæŠŠä¸€ä¸ªé¡µé¢çš„ tab é€‰é¡¹å¡é»˜è®¤å€¼æ”¹ä¸€ä¸‹ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€ç´¢é¡¹ç›®ä»£ç ï¼Œç„¶åæ ¹æ®æè¿°é»˜è®¤ç›´æ¥å˜æ›´ä»£ç ï¼Œç„¶åæœ€å·¦ä¾§ä»»åŠ¡ä¼šè‡ªåŠ¨æ ¹æ®ä»»åŠ¡å†…å®¹ç”Ÿæˆä¸€ä¸ªä»»åŠ¡åç§°</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f732a2c7e03e413b9c6094df91daf255~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=9jsPx1B1dQawuR3fELLnCT1rm7g%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘å‘ç° SOLO Coder æ˜¯è‡ªåŠ¨å°±æŠŠé¡¹ç›®ä»£ç å˜æ›´äº†çš„ï¼Œè¿™é‡Œæœ‰ä¸ªé€‰é¡¹ï¼Œå°±æ˜¯ç”¨æˆ·ç¡®è®¤åæ”¹ä»£ç å’Œè‡ªåŠ¨ç›´æ¥æ”¹ä»£ç ï¼ŒæŠŠè¿™ä¸ªç¡®è®¤åŠ ä¸Šäº†ï¼Œé˜²æ­¢æŠŠé¡¹ç›®ç»™æ”¹å´©äº†ï¼Œä¸å¥½è¿˜åŸäº†ï¼Œä¹‹å‰é‡åˆ°è¿‡çš„ç—›è‹¦ç»å†ï¼Œç”¨ Agent æ”¹ä»£ç ï¼Œç»“æœå´©äº†ï¼Œè¿˜è‡ªåŠ¨æ”¹äº†ï¼Œä½†æ˜¯åªæ”¹äº†åŠæˆªï¼Œè¿˜åŸä¹Ÿåªèƒ½è¿˜åŸåŠæˆªï¼Œå› ä¸ºæ¶‰åŠäº†å¥½å‡ ä¸ªæ–‡ä»¶ï¼Œæˆ‘æ‰‹åŠ¨å­å“§å­å“§å¿™æ´»åŠå¤©æ‰æ¢å¤ï¼Œæ•´çš„éƒ½æœ‰é˜´å½±äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5004c1e574dd4118a65b83a9eb7097b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=ywI4rtd8wdOrl1WoUqX5z0l8u78%3D" alt="image.png" loading="lazy"/></p>
<p>ç¬¬äºŒæ¬¡ç»§ç»­ï¼Œæ”¹ç‚¹æ•°æ®çœ‹çœ‹ï¼Œé¡ºä¾¿è°ƒæ•´ä¸€ä¸‹å¸ƒå±€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df149e0d4b4e4aa39338da8b5b3e8063~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=LX56MZXyMtDtuBP2uVX7fHHTfxw%3D" alt="image.png" loading="lazy"/></p>
<p>ä»»åŠ¡æ‰§è¡Œå®ŒåæŸ¥çœ‹å˜æ›´ï¼Œç‚¹å‡»æŸ¥çœ‹å˜æ›´ï¼Œå³ä¾§ä¼šæ˜¾ç¤ºä¸¤ä¸ªæŠ˜å é¢æ¿ï¼Œä¸€ä¸ªæè¿°éœ€æ±‚ï¼Œä¸€ä¸ªæ˜¯ä»£ç å˜æ›´</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dfea62001dd4036b56797256e6bb63c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=sd1gNACz%2FDwm119mforu9oI0cQw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d52a08d3d1941eeacf47e78be67f28a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=gUoMeG5iMAJl7D1NJZqra4V0q6o%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸¤ä¸ªæ˜ç¡®çš„å°æ”¹åŠ¨ç›®å‰ SOLO é¡¹ç›®ä¸­å†…å®¹æ”¹çš„æ­£ç¡®ï¼Œæ•´ä½“è¡¨ç°è¿˜ä¸é”™ï¼Œ<code>æ‰‹åŠ¨ç‚¹èµ</code></p>
<h3 data-id="heading-4">ä¸Šç‚¹å¼ºåº¦</h3>
<p>æ¥ä¸‹æ¥ç»§ç»­ä¸Šå¼ºåº¦è¯•è¯•ï¼Œæ·»åŠ ä¸€ä¸ªå›¾è¡¨ï¼Œæä¾›äº†æ ‡é¢˜ï¼ŒXè½´å’ŒYè½´æ•°æ®å’Œæè¿°</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d1925e7b921404386ab811d7e07c298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=PcWtwvC7srKSO13lzc2LMMdlxGw%3D" alt="image.png" loading="lazy"/></p>
<p>ç­‰äº†ä¸€ä¼šå„¿ï¼Œæ‰§è¡Œå®Œäº†ï¼Œè¿™ä¸ªåº”è¯¥æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯åŠ ä¸€ä¸ªå›¾è¡¨è€Œå·²ï¼Œåº”è¯¥é—®é¢˜ä¸å¤§ï¼Œçœ‹ç€ä»£ç é¡µæ²¡å•¥å¤§é—®é¢˜</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d7f594af0224aca8b0e7e26b81d7680~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=ZvxkC%2FqYx7LUZC6MyRifRcompC0%3D" alt="image.png" loading="lazy"/></p>
<p>é¡µé¢ä¸Šæ•ˆæœåªæ˜¯ä¸€ä¸ªç©ºç™½ï¼Œæ¡†æ˜¯åŠ äº†ä¸€ä¸ªï¼Œä½†æ˜¯å›¾è¡¨æ²¡æ¸²æŸ“å‡ºæ¥ï¼Œè€Œä¸”ä½ç½®ä¸å¯¹ï¼Œæ²¡æœ‰åœ¨å¯¹åº”çš„å†…å®¹ä¸‹é¢ç”Ÿæˆå›¾è¡¨ï¼Œå¯èƒ½æè¿°çš„è¿˜ä¸å¤Ÿå‡†ç¡®ï¼Œä½ç½®å€’è¿˜å¥½ï¼Œä¸»è¦å†…å®¹æ²¡å‡ºæ¥</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2886b62385be43a292064da1762b7dae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=njfvxXNr%2B6Hsawp4OJFGS4pL11c%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œçš„å†…å®¹æ˜¯åœ¨é¡¹ç›®å¼¹æ¡†ä¸­ï¼Œç”¨çš„tabåˆ‡æ¢æ˜¾ç¤ºçš„é¡µé¢ï¼Œå¯èƒ½åŠ è½½æ—¶æœºæœ‰é—®é¢˜ï¼Œç›®å‰æµè§ˆå™¨æ§åˆ¶å°æ— æŠ¥é”™ï¼Œå…ˆé—®åé¦ˆä¸€ä¸‹ SOLOï¼Œå†è®©å®ƒåˆ†æä¸€ä¸‹</p>
<p>å®ƒæ ¹æ®ç†è§£åˆå“å“æ”¹äº†å‡ è¡Œä»£ç ï¼Œè¯´è¿™ä¸ª <code>ç°åœ¨ï¼Œå›¾è¡¨ä¼šåœ¨é¡µé¢æ¸²æŸ“å®Œæˆåå¯é åˆå§‹åŒ–ï¼Œå¹¶åœ¨åˆ‡æ¢åˆ°è¯¥é¡µç­¾æ—¶å†æ¬¡åˆå§‹åŒ–ï¼Œç¡®ä¿æ­£å¸¸æ˜¾ç¤º</code>ï¼Œå®ƒåªè´Ÿè´£ç”Ÿæˆä»£ç ï¼Œè¯´çš„å¥½ä¼¼å®ƒäº²çœ¼è§è¿‡ä¸€æ ·</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62ab09b5ee644981a1c862b1a5cbc797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=8jPLUsdGCzd4jGlcUtBijlZjAcM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07d8b7a804e3453490db720a73963fd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=QryXwKHumfpw12k%2BsFI5clPwfjw%3D" alt="image.png" loading="lazy"/></p>
<p>æµè§ˆå™¨æ§åˆ¶å°æœ‰è­¦å‘Šï¼Œå›¾è¡¨è¿˜æ˜¯ç©ºæ¡†ï¼Œå®ŒçŠŠå­äº†ï¼Œè¿™é‡Œçš„ä»£ç ç”±äºæ¶‰åŠåˆ°ä¸šåŠ¡ä¸€äº›ä¸œè¥¿ï¼Œä¼°è®¡å®ƒæ²¡æ•´æ˜ç™½ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯è¿™ä¸ªshiå±±é¡¹ç›®é‡Œé¢çš„ä¸€å¨ä¸€å¨çš„ä»£ç è¯¯å¯¼çš„ï¼‰ï¼Œå¾—æ‰‹åŠ¨å®Œæ•´æ’æŸ¥ä¸€ä¸‹è¿™éƒ¨åˆ†ç›¸å…³ä»£ç äº†</p>
<h3 data-id="heading-5">æ¢å¤æ‰‹åŠ¨</h3>
<p>ç„¶åæˆ‘æŠŠè¿™ä¸ª Trae å…³äº†ï¼Œé‡æ–°æ‰“å¼€äº†ä¸€ä¸‹é¡¹ç›®</p>
<p>æ²ƒæ—¥å•Šï¼Œæ€ä¹ˆåˆ‡æ¢äº†ä¸€ä¸‹æ¨¡å¼é‡å¯åï¼Œä»€ä¹ˆæ”¹åŠ¨éƒ½æ²¡æœ‰äº†ï¼Œå°±å‰©ä¸€ä¸ªé»˜è®¤tabé€‰é¡¹æ•ˆæœè¿˜åœ¨äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c83c619b73fe4efc87570e1c1776559d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=jFih%2B9Qpot1jG92EX4g%2FBHbWIDk%3D" alt="image.png" loading="lazy"/></p>
<p>åˆä½¿ç”¨AIè‡ªåŠ¨æ”¹ä»£ç ç¿»è½¦çš„èŠ‚å¥å—ï¼Œä¸ä¼šåˆè¢«å‘ä¸€ä¸‹åˆå§</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08627f1624e44235be9e988c97ecd064~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=jf3XAl9Y68nA8MuT0ttMmZH9uPA%3D" alt="B98613A4BEA6AC9A4DA6C0A602D6C164.gif" loading="lazy"/></p>
<h3 data-id="heading-6">è™šæƒŠä¸€åœº</h3>
<p>è¿™ä»€ä¹ˆé¬¼ï¼Œæˆ‘æŸ¥äº†ä»£ç ï¼Œä»£ç æ›´æ–°çš„éƒ¨åˆ†ä¹Ÿéƒ½æœ‰å•Šï¼Œç¼“å­˜ï¼Ÿ</p>
<p>é‡æ–° pnpm run dev ï¼Œ æŠŠåŸæ¥çš„æµè§ˆå™¨å…³æ‰ï¼Œé‡æ–°ç”¨æ— ç—•æ‰“å¼€ï¼Œåˆå¥½äº†ï¼Œæœç„¶æµè§ˆå™¨ç¼“å­˜æçš„é¬¼ï¼ˆæ¾äº†ä¸€å£æ°”ï¼‰</p>
<p>åˆ‡æ¢æˆç¼–è¾‘å™¨æ¨¡å¼åï¼Œæ‰‹åŠ¨æ”¹ä»£ç æµ‹è¯•ï¼ŒTrae ä¸­æœ‰è¿™ä¹ˆä¸ªæ“ä½œï¼Œè‡ªåŠ¨å†™å…¥ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ï¼Œå¤§æ¦‚éœ€è¦å‡ åç§’ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹æ…¢ï¼Œä½“éªŒä¸æ˜¯å¾ˆå¥½</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d46cb9c4f324e0081ed82bb7ab0d29f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=J9uuW80dzt30%2FjqE7%2FmA9k0WgCA%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘åŠ¨äº†ç‚¹ä¸œè¥¿ï¼Œåˆæç¤º æ­£åœ¨åº”ç”¨ä»£ç æ“ä½œ â€œæ•´ç†å¯¼å…¥â€ è‡ªåŠ¨å†™å…¥ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ä¿å­˜ï¼Œæ˜¯ä»€ä¹ˆé¬¼ï¼Œæˆ‘æ”¹äº†ä¸ªç´¢å¼•æ•°å­—ï¼Œä¸¤ä¸ªåœ°æ–¹ï¼Œä¹Ÿéœ€è¦å‡ åç§’ï¼Œç”µè„‘ç³»ç»Ÿ Win11å®¶åº­ç‰ˆï¼Œå†…å­˜32Gï¼ŒCPU i5,å°±å¯åŠ¨äº† Traeï¼Œå…¶ä»–ç¼–è¾‘å™¨æ²¡å¼€ï¼Œæˆ‘æŸ¥äº†ä»»åŠ¡æ  CPUï¼Œå†…å­˜ä½¿ç”¨ç‡ä¸é«˜ï¼Œä½†æ˜¯è¿™ä¸ªä½“éªŒå¥½å·®å‘€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8fa2e553d5644ac85ab321e36600722~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=ZeZLiS%2F4mmyoNBdssCbdWrBt8Ws%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">å¥‡æ€ªçš„è‡ªåŠ¨åŒ–</h3>
<p>ä¹ æƒ¯äº†æ”¹ç‚¹ä¸œè¥¿è‡ªåŠ¨åä¿å­˜åï¼Œä¸€ä¸¤ç§’å°±èƒ½åœ¨é¡µé¢ä¸Šæ•ˆæœï¼Œç°åœ¨åœ¨ Trae ä¸­è‡ªåŠ¨ä¿å­˜ï¼Œæ ¼å¼åŒ–å®Œä»¥åå¤§çº¦åå‡ ç§’åï¼Œæ‰èƒ½åœ¨é¡µé¢ä¸Šçœ‹åˆ°æ›´æ–°åçš„æ•ˆæœï¼Œæˆ‘å¤šæ¬¡æµ‹è¯•æ”¹å‡ ä¸ªæ•°å­—æˆ–æ”¹ä¸€è¡Œä»£ç é¡µè¿™æ ·ï¼Œå•Š...... (å¿ƒæ€æ­¤æ—¶æœ‰ç‚¹å´©äº†)</p>
<p>éš¾é“æ˜¯ Trae ä¸­è‡ªåŠ¨ä¿å­˜è®¾ç½®å’Œä¸€äº›æ’ä»¶ä¸€èµ·å·¥ä½œä¸å…¼å®¹çš„é—®é¢˜å—ï¼Ÿæˆ‘è¿™è¾¹å‰ç«¯vue3é¡¹ç›®ï¼Œç›¸å…³æ’ä»¶å¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71cf68dcc5ab4b9792f375b869785bfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=M2aJSqleSD0X6LKH9SU42M5e0BE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9aa90be335fb491993e295a2c2f420ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765161809&amp;x-signature=lcTTWk9CZwgHDgYrg18CmRZAu9Y%3D" alt="image.png" loading="lazy"/></p>
<p>ç”±äºè¿›å…¥æ‰‹æ”¹æ¨¡å¼åï¼Œè¿™ä¸ªè‡ªåŠ¨ä¿å­˜æ ¼å¼åŒ–æ“ä½œæ—¶é—´æœ‰ç‚¹ä¹…ï¼Œå¯èƒ½æ˜¯æˆ‘å“ªé‡Œè®¾ç½®é—®é¢˜ï¼Ÿè¿˜æ˜¯æ“ä½œæ–¹å¼é—®é¢˜ï¼Ÿæ’ä»¶æ˜¯ä» VSCode ä¸­åŒæ­¥è¿‡æ¥çš„ï¼Œè¿™äº›é…ç½®ä¹Ÿæ˜¯æ—¥å¸¸æ“ä½œï¼Œå‡ºç°è¿™ç§æ˜æ˜¾è¿™ä¹ˆä¹…çš„æ—¶é—´å»¶è¿Ÿï¼Œè¿˜æ˜¯æœ‰ç‚¹å¥‡æ€ªçš„</p>
<p>@Trae å®˜ç½‘æŠ€æœ¯äººå‘˜ï¼Œæœ‰ç©ºçœ‹çœ‹ï¼Œéš¾é“ä½ ä»¬æ ‡é…éƒ½æ˜¯ Mac book Pro é¡¶é…ï¼Œç„¶åæµç•…çš„ä¸è¡Œå—</p>
<h2 data-id="heading-8">å°ç»“</h2>
<p>ç›®å‰æ¥çœ‹é™¤äº†ç‰¹åˆ«ä»£ç å®ç°å‡ºæ¥çš„å¥‡è‘©çš„åŠŸèƒ½ï¼Œå¸¸è§çš„åŠŸèƒ½éœ€æ±‚æç¤ºæè¿°ç›¸å¯¹å‡†ç¡®åï¼ŒSOLOæ¨¡å¼æ•´ä½“è¿˜æ˜¯éå¸¸äº®çœ¼çš„ï¼Œè™½ç„¶ä¸­é—´æœ‰ç‚¹å°æ’æ›²ï¼Œæ•´ä½“ Trae SOLO æ¨¡å¼è¿˜æ˜¯éå¸¸äº®çœ¼çš„</p>
<p>ç”±äºè‡ªåŠ¨ä¿å­˜æ ¼å¼åŒ–æ—¶é—´æœ‰ç‚¹é•¿ï¼Œåˆç”±äºåé¢çš„éœ€æ±‚ä¹Ÿä¸å¤ªå¥½ç›´è§‚æè¿°ï¼Œå¹¶ä¸”ä»£ç ä¹Ÿæ˜¯ç‰¹åˆ«ä¹±ï¼Œæˆ‘å°±å…ˆä¸ç”¨ SOLO æ¨¡å¼äº†ï¼Œå…ˆæ¢ VSCode æŠŠé‚£ç§äº§å“è‡ªå·±éƒ½è®²ä¸æ˜ç™½çš„éœ€æ±‚æ”¹äº†ï¼Œä¸ç„¶åŠ ç­ä¸çŸ¥é“å‡ ä¸ªå°æ—¶èµ·æ­¥äº†</p>
<blockquote>
<p>æ¬¢è¿å¤§å®¶è®¨è®ºäº¤æµï¼Œå¦‚æœå–œæ¬¢æœ¬æ–‡ç« æˆ–æ„Ÿè§‰æ–‡ç« æœ‰ç”¨ï¼ŒåŠ¨åŠ¨ä½ é‚£å‘è´¢çš„å°æ‰‹ç‚¹èµã€æ”¶è—ã€å…³æ³¨å†èµ°å‘—Â <code>^_^</code>Â </p>
<p>å¾®ä¿¡å…¬ä¼—å·ï¼šè‰å¸½lufei</p>
</blockquote>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e1fd6d3bc93444bbb257fc45e1826b11~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=240&amp;h=240&amp;s=10632&amp;e=jpg&amp;b=fdfafa" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµ…è°ˆ AI æœç´¢å‰ç«¯æ‰“å­—æœºæ•ˆæœçš„å®ç°æ–¹æ¡ˆæ¼”è¿›]]></title>    <link>https://juejin.cn/post/7576955345378099263</link>    <guid>https://juejin.cn/post/7576955345378099263</guid>    <pubDate>2025-11-27T03:10:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7576955345378099263" data-draft-id="7576953459543638070" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµ…è°ˆ AI æœç´¢å‰ç«¯æ‰“å­—æœºæ•ˆæœçš„å®ç°æ–¹æ¡ˆæ¼”è¿›"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-11-27T03:10:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vivoäº’è”ç½‘æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/993614243303053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµ…è°ˆ AI æœç´¢å‰ç«¯æ‰“å­—æœºæ•ˆæœçš„å®ç°æ–¹æ¡ˆæ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614243303053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vivoäº’è”ç½‘æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T03:10:41.000Z" title="Thu Nov 27 2025 03:10:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼švivo äº’è”ç½‘å‰ç«¯å›¢é˜Ÿ - He Yanjun</p>
<p>åœ¨å½“ä»£å‰ç«¯å¼€å‘é¢†åŸŸï¼Œæ‰“å­—æœºæ•ˆæœä½œä¸ºä¸€ç§æå…·åˆ›é€ åŠ›ä¸å¸å¼•åŠ›çš„äº¤äº’å…ƒç´ ï¼Œè¢«å¹¿æ³›è¿ç”¨äºå„ç±»ç½‘ç«™å’Œåº”ç”¨ç¨‹åºä¸­ï¼Œä¸ºç”¨æˆ·å¸¦æ¥ç‹¬ç‰¹çš„è§†è§‰ä½“éªŒå’Œä¿¡æ¯å‘ˆç°æ–¹å¼ï¼Œæ·±å—å¹¿å¤§ç”¨æˆ·çš„å–œçˆ±ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥ä»‹ç»åœ¨AIæœç´¢è¾“å‡ºå“åº”çš„è¿‡ç¨‹ä¸­ï¼Œæ‰“å­—æœºæ•ˆæœæ˜¯æ€æ ·é€æ­¥æ¼”è¿›çš„ã€‚åŠ›æ±‚ä»¥é€šä¿—çš„è¯­è¨€å’Œä¸¥è°¨çš„æ€è·¯æ·±å…¥å‰–ææ‰“å­—æœºæ•ˆæœåœ¨ä¸åŒé˜¶æ®µçš„å…³é”®æŠ€æœ¯éš¾ç‚¹å’Œä¼˜åŠ£åŠ¿ã€‚</p>
</blockquote>
<p>1åˆ†é’Ÿçœ‹å›¾æŒæ¡æ ¸å¿ƒè§‚ç‚¹ğŸ‘‡</p>
<p><img src="https://static001.geekbang.org/infoq/71/71e2717ca5faa5e464284f60854c8cf1.gif" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>åœ¨å¦‚ä»ŠåŸºäºAIæœç´¢çš„å¯¹è¯èˆå°ä¸Šï¼Œå¦‚æœä¸€æ®µæ–‡å­—åƒè€å¼æ‰“å­—æœºä¸€æ ·é€å­—é€å¥å±•ç°åœ¨å±å¹•ä¸Šï¼Œé‚£å°†æ˜¯ä¸€ç§å…·æœ‰ç‹¬ç‰¹é­…åŠ›çš„å¸å¼•åŠ›ã€‚</p>
<p>è¯ä¸å¤šè¯´ï¼Œå…ˆæ¥çœ‹ä¸‹æœ€ç»ˆçš„å®ç°æ•ˆæœã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/e5/e5b2872868de30c88a997b04eff96bc8.gif" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€å¼•è¨€</h2>
<p>åœ¨AIæœç´¢åœºæ™¯ä¸­ï¼Œç”±äºå¤§æ¨¡å‹åŸºäºæµå¼è¾“å‡ºæ–‡æœ¬ï¼Œéœ€è¦å¤šæ¬¡å“åº”ç»“æœåˆ°å‰ç«¯ï¼Œå› æ­¤è¿™ç§åœºæ™¯ååˆ†é€‚åˆä½¿ç”¨æ‰“å­—æœºæ•ˆæœã€‚</p>
<p>æ‰“å­—æœºæ•ˆæœæ˜¯æŒ‡åœ¨ç”Ÿæˆå†…å®¹çš„åœºæ™¯ä¸­ï¼Œæ–‡å­—é€å­—ç¬¦åŠ¨æ€æ˜¾ç¤ºï¼Œæ¨¡æ‹Ÿäººå·¥æ‰“å­—çš„è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯å‡ºäºæå‡ç”¨æˆ·ä½“éªŒã€ä¼˜åŒ–äº¤äº’é€»è¾‘å’Œå¢å¼ºå¿ƒç†æ„ŸçŸ¥ç­‰æ–¹é¢çš„è€ƒé‡ï¼š</p>
<p><strong>ç¼“è§£ç­‰å¾…ç„¦è™‘ï¼Œé™ä½â€œæ— åé¦ˆâ€çš„è´Ÿé¢ä½“éªŒã€‚</strong></p>
<p>å†…å®¹æ˜¯é€æ­¥å“åº”çš„ï¼Œæ‰“å­—æœºæ•ˆæœå¯ä»¥å¾ˆå¥½åœ°æä¾›â€œå®æ—¶åé¦ˆâ€ï¼Œç”¨æˆ·å¯ä»¥æ„ŸçŸ¥åˆ°ç³»ç»Ÿæ­£åœ¨å·¥ä½œï¼Œä»è€Œå‡å°‘äº†ç­‰å¾…è¿‡ç¨‹ä¸­çš„ä¸ç¡®å®šæ€§å’Œç„¦è™‘æ„Ÿã€‚</p>
<p><strong>æ¨¡æ‹Ÿè‡ªç„¶äº¤äº’ï¼Œå¢å¼ºâ€œç±»äººå¯¹è¯â€çš„æ²‰æµ¸æ„Ÿã€‚</strong></p>
<p>å¯¹è¯äº¤æµå…·æœ‰åœé¡¿ã€å¼ºè°ƒç­‰èŠ‚å¥æ„Ÿï¼Œé€šè¿‡å®æ—¶æ‰“å­—çš„æ¨¡æ‹Ÿï¼Œè·Ÿå®¹æ˜“æ‹‰è¿‘ä¸ç”¨æˆ·çš„å¿ƒç†è·ç¦»ï¼Œå¢å¼ºå¯¹è¯æ„Ÿå’Œæ²‰æµ¸æ„Ÿã€‚</p>
<p><strong>ä¼˜åŒ–ä¿¡æ¯æ¥æ”¶æ•ˆç‡ï¼Œé¿å…â€œä¿¡æ¯è¿‡è½½â€ã€‚</strong></p>
<p>å¦‚æœä¸€æ¬¡æ€§å±•ç¤ºå¤§é‡å¯†å¯†éº»éº»çš„æ–‡å­—ï¼Œç”¨æˆ·éœ€è¦èŠ±æ—¶é—´ç­›é€‰é‡ç‚¹ï¼Œå®¹æ˜“äº§ç”ŸæŠµè§¦ï¼Œé€šè¿‡æ‰“å­—æœºæ•ˆæœå¯ä»¥ç¼“å’Œé˜…è¯»èŠ‚å¥ï¼Œå‡å°‘è§†è§‰å’Œè®¤çŸ¥è´Ÿæ‹…ã€‚</p>
<p><strong>å¼ºåŒ–â€œAIç”Ÿæˆâ€çš„æ„ŸçŸ¥ï¼Œé™ä½å¯¹â€œæ ‡å‡†ç­”æ¡ˆâ€çš„é¢„æœŸã€‚</strong></p>
<p>ä½¿ç”¨æˆ·æ„ŸçŸ¥åˆ°æ˜¯AIå®æ—¶è®¡ç®—ç»“æœï¼Œè€Œéé¢„å­˜çš„æ ‡å‡†ç­”æ¡ˆï¼Œæœ‰åŠ©äºç”¨æˆ·ç†æ€§å®¢è§‚åœ°ä½¿ç”¨å·¥å…·ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€æ—©æœŸå®ç°æ–¹æ¡ˆâ€”â€”çº¯æ–‡æœ¬é€å­—ç¬¦æ‰“å­—æ•ˆæœ</h2>
<p>æœ€å¼€å§‹çš„äº§å“åŠŸèƒ½ï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥çš„æœç´¢è¯ï¼Œæµå¼è¾“å‡ºå¹¶é€å­—ç¬¦å±•ç¤ºåˆ°é¡µé¢ä¸Šï¼Œè¿™å¯ä»¥è¯´æ˜¯æ‰“å­—æœºæ•ˆæœçš„å…¥é—¨çº§å®ç°äº†ï¼Œä¸ä¾èµ–ä»»ä½•å¤æ‚çš„æŠ€æœ¯ï¼Œå…¶æµç¨‹å›¾å¤§è‡´å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/a6/a6ad8f272b01718ac3b077711a8ec924.png" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">3.1 è¯¦ç»†è¯´æ˜</h3>
<p>å‰ç«¯ä¼šå®šä¹‰ä¸€ä¸ªå­—æ®µç”¨æ¥ç¼“å­˜å…¨é‡çš„markdownæ–‡æœ¬ï¼Œæ¯æ¬¡æœåŠ¡ç«¯æµå¼å“åº”markdownæ–‡æœ¬åˆ°å‰ç«¯æ—¶ï¼Œå‰ç«¯éƒ½ä¼šå°†å…¶è¿½åŠ åˆ°è¿™ä¸ªç¼“å­˜å­—æ®µåï¼Œç„¶ååŸºäºmarkedä¾èµ–åº“å°†å…¨é‡çš„markdownæ–‡æœ¬è½¬æ¢ä¸ºhtmlç‰‡æ®µã€‚</p>
<p>è¦å®ç°é€å­—ç¬¦æ¸²æŸ“çš„åŠ¨ç”»æ•ˆæœï¼Œå°±éœ€è¦å®šæ—¶æ›´æ–°æ–‡æœ¬ã€‚å®šæ—¶åŠŸèƒ½ä¸€èˆ¬é‡‡ç”¨setTimeoutæˆ–setIntervalæ¥å®ç°ï¼Œè€Œæ›´æ–°æ–‡æœ¬å¯ä»¥è€ƒè™‘innerHTMLå’ŒappendChildçš„æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨çš„innerHTMLæ–¹å¼æ’å…¥æ–‡æœ¬ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">fullText</span> = <span class="hljs-string">'test text'</span><span class="hljs-comment">;// å…¨é‡çš„htmlæ–‡æœ¬</span>
let <span class="hljs-attr">index</span> = <span class="hljs-number">0</span><span class="hljs-comment">;// å½“å‰æ‰“å°åˆ°çš„ä¸‹æ ‡</span>
let <span class="hljs-attr">timer</span> = window.setInterval(() =&gt; {
  ++index<span class="hljs-comment">;</span>
  $<span class="hljs-attr">dom.innerHTML</span> = fullText.substring(<span class="hljs-number">0</span>, index)<span class="hljs-comment">;</span>
}, 40)<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-4">3.2 innerHTMLä¸appendChildçš„æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”</h3>
<p><img src="https://static001.geekbang.org/infoq/41/41849adf6860ac94811e495997bb6709.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©innerHTMLè€ŒéappendChildï¼Ÿ</strong></p>
<p>ç”±äºæœåŠ¡ç«¯æ˜¯æµå¼è¿”å›markdownæ–‡æœ¬ï¼Œå› æ­¤æ¯æ¬¡è¿”å›çš„markdownæ–‡æœ¬å¯èƒ½ä¸æ˜¯å®Œæ•´çš„ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-css" lang="css">å…ˆè¿”å›ä¸‹é¢ä¸€æ®µmarkdownæ–‡æœ¬

** è¿™æ˜¯ä¸€ä¸ª
å†è¿”å›ä¸‹é¢ä¸€æ®µmarkdownæ–‡æœ¬

æ ‡é¢˜ **
å…ˆè¿”å›çš„æ–‡æœ¬ä¼šå½“ä½œçº¯æ–‡æœ¬å±•ç¤ºï¼Œå†è¿”å›çš„æ–‡æœ¬ä¼šä¸å…ˆè¿”å›çš„æ–‡æœ¬ç»“åˆç”Ÿæˆ<span class="hljs-selector-tag">html</span>ç‰‡æ®µå¦‚ä¸‹

&lt;<span class="hljs-selector-tag">strong</span>&gt;è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜&lt;/<span class="hljs-selector-tag">strong</span>&gt;
</code></pre>
<p>å¦‚æœä½¿ç”¨appendChildçš„è¯ï¼Œå°±ä¸å¥½å¤„ç†ä¸Šè¿°åœºæ™¯ã€‚</p>
<h3 data-id="heading-5">3.3 å°ç»“</h3>
<p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹å°±æ˜¯ç®€å•æ˜“æ‡‚ï¼Œå¾ˆå®¹æ˜“ä¸Šæ‰‹å®ç°ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•ä¾èµ–ã€‚</p>
<p>ä½†æ˜¯ï¼Œå®ƒçš„ç¼ºç‚¹ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æ— æ³•æ–¹ä¾¿çš„æ·»åŠ ä¸€äº›é¢å¤–çš„åŠ¨ç”»æ•ˆæœæ¥å¢å¼ºè§†è§‰ä½“éªŒï¼Œå¦‚å…‰æ ‡é—ªçƒæ•ˆæœï¼›å¯¹äºä¸€äº›å¤æ‚æ–‡æœ¬å†…å®¹ï¼Œæˆ–è€…éœ€è¦æ›´åŠ çµæ´»åœ°æ§åˆ¶å±•ç¤ºç»†èŠ‚æ—¶ä¹Ÿä¼šæ˜¾å¾—æ‰è¥Ÿè§è‚˜ï¼›å¹¶ä¸”æ¯æ¬¡é€šè¿‡innerHTMLæ¸²æŸ“æ–‡æœ¬æ—¶ï¼Œéƒ½è§¦å‘äº†domçš„é”€æ¯ä¸åˆ›å»ºï¼Œæ€§èƒ½æ¶ˆè€—å¤§ã€‚</p>
<h2 data-id="heading-6">å››ã€éœ€æ±‚éš¾åº¦è¿›ä¸€æ­¥æå‡</h2>
<p>éšç€äº§å“çš„è¿­ä»£ï¼Œä¸šåŠ¡è¦æ±‚æ‰“å­—å†…å®¹ä¸ä»…æ˜¯çº¯æ–‡æœ¬ï¼Œè¿˜éœ€è¦ç©¿æ’å±•ç¤ºå¡ç‰‡ç­‰å¤æ‚æ ·å¼æ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p>å¡ç‰‡çš„ç±»å‹åŒ…æ‹¬åº”ç”¨ã€è‚¡ç¥¨ã€å½±è§†ç­‰ï¼Œéœ€è¦å¯æ‰©å±•ã€å¯é…ç½®ï¼Œå¹¶ä¸”è¿˜ä¼šåŒ…æ‹¬å¤æ‚çš„äº¤äº’æ•ˆæœï¼Œå¦‚ç‚¹å‡»ã€è·³è½¬ç­‰ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/fc/fc131edaf07977496b1970b79a44561c.png" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¾ˆæ˜æ˜¾ï¼ŒåŸºäºæ—©æœŸçš„å®ç°æ–¹æ¡ˆå·²ç»è¿œè¿œä¸èƒ½æ»¡è¶³æ—¥ç›Šå¢å¼ºçš„ä¸šåŠ¡è¯‰æ±‚äº†ï¼Œå¿…é¡»è€ƒè™‘æ›´åŠ çµæ´»é«˜æ•ˆçš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-7">äº”ã€ç°ä»£æ¡†æ¶ä¸‹çš„å®ç°â€”â€”åŸºäºVueè™šæ‹ŸdomåŠ¨æ€æ›´æ–°</h2>
<p>é€šè¿‡ä¸Šè¿°çš„åˆ†æï¼Œæ‰“å­—å†…å®¹ä¸­è¦ç©¿æ’å±•ç¤ºå¡ç‰‡ï¼Œæ˜¾ç„¶éœ€è¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå¦åˆ™å¦‚æœæ¯æ¬¡æ‰“å­—éƒ½é‡æ–°åˆ›å»ºå…ƒç´ çš„è¯ï¼Œä¸ä»…æ€§èƒ½ä½ä¸‹ï¼Œè€Œä¸”æ•°æ®å’ŒçŠ¶æ€è¿˜æ— æ³•ä¿æŒä¸€è‡´ã€‚</p>
<p>è€Œè¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå°±å¿…é¡»æ ¹æ®ç°æœ‰æ•°æ®å¯¹å·²æ’å…¥èŠ‚ç‚¹è¿›è¡Œæ’å…¥ã€æ›´æ–°ã€ç§»é™¤ç­‰æ“ä½œä»¥ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¿™å°±å¾ˆè‡ªç„¶åœ°ä¼šæƒ³åˆ°ä½¿ç”¨ç°ä»£å‰ç«¯æ¡†æ¶æ¥å¯¹æ‰“å­—æœºæ•ˆæœè¿›è¡Œæ”¹è¿›ã€‚</p>
<p>Vueæ˜¯åŸºäºè™šæ‹Ÿdomçš„æ¸è¿›å¼javascriptæ¡†æ¶ï¼Œä»…åœ¨æ•°æ®å˜åŒ–æ—¶è®¡ç®—å·®å¼‚å¹¶æ›´æ–°å¿…è¦çš„éƒ¨åˆ†ï¼Œå› æ­¤å¯ä»¥å€ŸåŠ©å…¶æ•°æ®é©±åŠ¨å¼€å‘ã€ç»„ä»¶åŒ–å¼€å‘ç­‰ç‰¹æ€§ï¼Œè½»æ¾åœ°æ„å»ºä¸€ä¸ªå¯å¤ç”¨çš„æ‰“å­—æœºæ•ˆæœç»„ä»¶ã€‚</p>
<h3 data-id="heading-8">5.1 è®¾è®¡æ€è·¯</h3>
<p>è¦å®ç°æ‰“å­—æ­£æ–‡ä¸­ç©¿æ’å¡ç‰‡çš„æ•ˆæœï¼Œé¦–å…ˆéœ€è¦å®šä¹‰å¥½è¿”å›çš„æ•°æ®ç»“æ„ï¼Œå®ƒéœ€è¦å…·å¤‡å¯æ‰©å±•ï¼Œæ–¹ä¾¿è§£æï¼Œå…¼å®¹markdownç­‰ç‰¹æ€§ï¼Œæ‰€ä»¥ä½¿ç”¨htmlæ ‡ç­¾æ˜¯ä¸€ç§æ¯”è¾ƒåˆé€‚çš„æ–¹å¼ï¼Œä¾‹å¦‚è¦å±•ç¤ºä¸€ä¸ªåº”ç”¨å¡ç‰‡ï¼Œå¯ä»¥ä¸‹å‘å¦‚ä¸‹æ‰€ç¤ºæ•°æ®ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;app <span class="hljs-attr">id</span>=<span class="hljs-string">""</span> /&gt;
</code></pre>
<p>ä»ä¸‹å‘çš„æ•°æ®ä¸­å¯ä»¥è·å–åˆ°æ ‡ç­¾åå’Œå±æ€§é”®å€¼å¯¹ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æ ‡ç­¾åæ¥æ¸²æŸ“å…³è”åˆ°çš„ç»„ä»¶æ¨¡æ¿ï¼Œé€šè¿‡å±æ€§é”®å€¼å¯¹å»æœåŠ¡ç«¯åŠ è½½å¯¹åº”çš„æ•°æ®ï¼Œäºæ˜¯å°±å¯ä»¥æ°´åˆ°æ¸ æˆçš„æŠŠåº”ç”¨å¡ç‰‡å±•ç¤ºå‡ºæ¥ï¼Œå…¶æµç¨‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/f7/f7f107266684e611857e0d0a51ffc1c3.png" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-9">5.2 è¯¦ç»†è¯´æ˜</h3>
<p>ç»„ä»¶æ¨¡æ¿æ–‡ä»¶æŒ‰ç…§ä¸€å®šè§„åˆ™ç»„ç»‡åœ¨ç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œåœ¨æ„å»ºæ—¶æ‰“åŒ…åˆ°èµ„æºé‡Œï¼Œå…³é”®ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">privateinit(){  
    let <span class="hljs-attr">fileList</span> = require.context(<span class="hljs-string">'@/components/common/box'</span>, <span class="hljs-literal">true</span>, /\.vue$/)<span class="hljs-comment">;  </span>
    fileList.keys().forEach((filePath) =&gt; {  
        let <span class="hljs-attr">startIndex</span> = filePath.lastIndexOf(<span class="hljs-string">'/'</span>)<span class="hljs-comment">;  </span>
        let <span class="hljs-attr">endIndex</span> = filePath.lastIndexOf(<span class="hljs-string">'.'</span>)<span class="hljs-comment">;  </span>
        let <span class="hljs-attr">tagName</span> = filePath.substring(startIndex + <span class="hljs-number">1</span>, endIndex)<span class="hljs-comment">;  </span>
        this.widgetMap<span class="hljs-section">[tagName]</span> = fileList(filePath).default<span class="hljs-comment">;  </span>
    })<span class="hljs-comment">;  </span>
}
</code></pre>
<p>ä¹‹å‰ç‰ˆæœ¬åœ¨æ¯æ¬¡æ¥æ”¶åˆ°æœåŠ¡ç«¯ä¸‹å‘çš„markdownæ–‡æœ¬æ—¶ï¼Œéƒ½ä¼šåšä¸€æ¬¡è½¬æ¢æˆhtmlçš„æ“ä½œï¼Œå¦‚æœå¤šæ¬¡å“åº”ä¹‹é—´çš„é—´éš”æ—¶é—´å¾ˆçŸ­ï¼Œåˆ™ä¼šå‡ºç°ç•¥å¾®å¡é¡¿çš„ç°è±¡ï¼Œå› æ­¤è¿™é‡Œè½¬æ¢ä¸ºhtmlæ—¶å†å¢åŠ ä¸€ä¸ªé˜²æŠ–åŠŸèƒ½ï¼Œå¯ä»¥å¾ˆæœ‰æ•ˆçš„é¿å…å¡é¡¿ã€‚</p>
<p>æ¯æ¬¡å®šæ—¶æˆªå–åˆ°å¾…æ¸²æŸ“çš„htmlæ–‡æœ¬ä»¥åï¼Œä¼šåŸºäºultrahtmlåº“å°†å…¶è½¬æ¢ä¸ºdomæ ‘ï¼Œå¹¶è¿‡æ»¤æ‰æ³¨é‡Šã€è„šæœ¬ç­‰æ ‡ç­¾ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">toRenderHtml</span> = this.rawHtml.substring(<span class="hljs-number">0</span>, this.curIndex)<span class="hljs-comment">;  </span>
let <span class="hljs-attr">dom</span> = {  
    type: ELEMENT_NODE,  
    name: 'p',  
    children: parse(toRenderHtml).children  
}<span class="hljs-comment">;</span>
</code></pre>
<p>æœ€åå°±æ˜¯å…¨å±€æ³¨å†Œä¸€ä¸ªé€’å½’ç»„ä»¶ç”¨æ¥æ¸²æŸ“è½¬æ¢åçš„domæ ‘ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">render(h: any) {  
    <span class="hljs-comment">// æ­¤å¤„çœç•¥è‹¥å¹²ä»£ç </span>

    <span class="hljs-comment">// å¤„ç†å­èŠ‚ç‚¹</span>
    let children = <span class="hljs-keyword">this</span>.dom[<span class="hljs-string">'children'</span>] || [];  
    let renderChildren = children.map((child: any, index: number) =&gt; { 
        <span class="hljs-keyword">return</span> h(CommonDisplay, {  
            props: {  
                dom: child,  
                displayCursor: <span class="hljs-keyword">this</span>.displayCursor,  
                lastLine: <span class="hljs-keyword">this</span>.lastLine &amp;&amp; index === children.length - <span class="hljs-number">1</span>,  
                ignoreBoxTag: <span class="hljs-keyword">this</span>.ignoreBoxTag  
            }  
        });  
    });
  
    <span class="hljs-comment">// æ­¤å¤„çœç•¥è‹¥å¹²ä»£ç </span>

    <span class="hljs-comment">// å¤„ç†æ–‡æœ¬èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.dom[<span class="hljs-string">'type'</span>] === TEXT_NODE) {  
        returnthis.renderTextNode({h, element: <span class="hljs-keyword">this</span>.dom});  
    }

    <span class="hljs-comment">// å¤„ç†è‡ªå®šä¹‰ç»„ä»¶æ ‡ç­¾</span>
    let tagName = <span class="hljs-keyword">this</span>.dom[<span class="hljs-string">'type'</span>] === ELEMENT_NODE ? <span class="hljs-keyword">this</span>.dom[<span class="hljs-string">'name'</span>] : <span class="hljs-string">'div'</span>;  
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$factory.hasTag(tagName)) {  
        <span class="hljs-comment">// æ­¤å¤„çœç•¥è‹¥å¹²ä»£ç </span>
        let widget = <span class="hljs-keyword">this</span>.$factory.getWidget(tagName);
        <span class="hljs-keyword">return</span> h(widget, {  
            key: tagId,  
            props: {  
                displayCursor: <span class="hljs-keyword">this</span>.displayCursor,  
                lastLine: <span class="hljs-keyword">this</span>.lastLine,  
                text,  
                ...attributes  
            }  
        }, isLastLeaf &amp;&amp; <span class="hljs-keyword">this</span>.displayCursor ? [h(commonCursor)] : []);
    }

    <span class="hljs-comment">// å¤„ç†htmlåŸå§‹æ ‡ç­¾</span>
    <span class="hljs-keyword">return</span> h(tagName, {  
        attrs: {  
            displayCursor: <span class="hljs-keyword">this</span>.displayCursor,  
            lastLine: <span class="hljs-keyword">this</span>.lastLine,  
            ...<span class="hljs-keyword">this</span>.dom[<span class="hljs-string">'attributes'</span>]  
        }  
    }, renderChildren);  
}
</code></pre>
<h3 data-id="heading-10">5.3 é—®é¢˜æ•´ç†å’Œè§£å†³</h3>
<p>æ‰“å­—æœºåŠŸèƒ½ç»ˆäºæ­£å¸¸è¿è¡Œäº†ï¼Œæµç•…åº¦è¿˜æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯åœ¨ä½“éªŒçš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå‘ç°äº†ä¸€äº›<strong>ç»†èŠ‚é—®é¢˜</strong>ã€‚</p>
<p><strong>â‘ æ‰“å­—æ–‡æœ¬ä¸­å¦‚æœå­˜åœ¨æ ‡ç­¾ï¼Œå¦‚ </strong></p><p><strong>xxx</strong></p><strong> ï¼Œä¼šå‡ºç°å…ˆå±•ç¤º &lt; ,å†å±•ç¤º &lt;p ï¼Œæœ€åå±•ç¤ºç©ºçš„æ•ˆæœï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦å›é€€ï¼Œæå¤§å½±å“é˜…è¯»ä½“éªŒã€‚</strong><p/>
<p><strong>åŸå› åˆ†æ</strong></p>
<p>å®šæ—¶æˆªå–å¾…æ¸²æŸ“æ–‡æœ¬æ—¶æ˜¯é€šè¿‡å®šä¹‰ä¸€ä¸ªä¸‹æ ‡é€’å¢é€å­—ç¬¦æˆªå–çš„ï¼Œè¿™å°±å¯¼è‡´æ ‡ç­¾å¹¶æ²¡æœ‰ä½œä¸ºä¸€ä¸ªåŸå­ç»“æ„è¢«æ•´ä½“æˆªå–ï¼Œäºæ˜¯å°±å‡ºç°äº†å­—ç¬¦å›é€€çš„ç°è±¡ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>å½“ä¸‹æ ‡æŒ‡å‘çš„å­—ç¬¦ä¸º &lt; æ—¶ï¼Œåˆ™å¾€åæˆªå–åˆ° &gt; çš„ä½ç½®ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">if (<span class="hljs-attr">curChar</span> === <span class="hljs-string">'&lt;'</span>) {  
    let <span class="hljs-attr">lastGtIndex</span> = this.rawHtml.indexOf(<span class="hljs-string">'&gt;'</span>, this.curIndex)<span class="hljs-comment">;</span>
    if (lastGtIndex &gt; -1) {
        <span class="hljs-attr">this.curIndex</span> = lastGtIndex + <span class="hljs-number">1</span><span class="hljs-comment">;</span>
        returnfalse<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p><strong>â‘¡ æ‰“å­—æ–‡æœ¬ä¸­å¦‚æœå­˜åœ¨è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚ " ï¼Œåˆ™ä¼šä¾æ¬¡å‡ºç°è¿™äº›å­—ç¬¦ï¼Œæœ€åå†å±•ç¤º " ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦é—ªçƒï¼Œä¹Ÿååˆ†å½±å“é˜…è¯»ä½“éªŒã€‚</strong></p>
<p><strong>åŸå› åˆ†æ</strong></p>
<p>åŸå› åŒä¸Šè¿°å­—ç¬¦å›é€€ä¸€æ ·ï¼Œä¹Ÿæ˜¯æ²¡æœ‰æŠŠè½¬ä¹‰å­—ç¬¦å½“ä½œä¸€ä¸ªæ•´ä½“æˆªå–ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>å½“ä¸‹æ ‡æŒ‡å‘çš„å­—ç¬¦ä¸º &amp; æ—¶ï¼Œåˆ™å¾€åæˆªå–åˆ°è½¬ä¹‰å­—ç¬¦ç»“æŸçš„ä½ç½®ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¤§æ¨¡å‹å¤§æ¦‚ç‡åªä¸‹å‘æœ‰é™ç±»åˆ«çš„è½¬ä¹‰å­—ç¬¦ï¼Œåšæˆé…ç½®åŠ¨æ€ä¸‹å‘ï¼Œä¸ä»…è§£ææ–¹ä¾¿ï¼Œå®šåˆ¶ä¸‹å‘ä¹Ÿå¾ˆåŠæ—¶  </span>
<span class="hljs-keyword">if</span> (curChar === <span class="hljs-string">'&amp;'</span>) {  
    let matchEscape = <span class="hljs-keyword">this</span>.config[<span class="hljs-string">'writer'</span>][<span class="hljs-string">'escapeArr'</span>].find((item: any) =&gt; {  
        returnthis.rawHtml.indexOf(item, <span class="hljs-keyword">this</span>.curIndex) === <span class="hljs-keyword">this</span>.curIndex;  
    });  
    <span class="hljs-keyword">if</span> (matchEscape) {  
        <span class="hljs-keyword">this</span>.curIndex += matchEscape.length;  
        returnfalse;  
    }  
}
</code></pre>
<p><strong>â‘¢ æ‰“å­—è¿‡ç¨‹ä¸­çš„é€Ÿåº¦æ˜¯å›ºå®šçš„ï¼Œç¼ºå°‘ä¸€ç‚¹æŠ‘æ‰¬é¡¿æŒ«çš„èŠ‚å¥æ„Ÿï¼Œä¸å¤Ÿè‡ªç„¶ã€‚</strong></p>
<p><strong>åŸå› åˆ†æ</strong></p>
<p>å®šæ—¶å™¨çš„é—´éš”æ—¶é—´æ˜¯å›ºå®šçš„ä¸€ä¸ªæ•°å€¼ï¼Œæ‰€ä»¥è¡¨ç°ä¸ºä¸€ä¸ªå›ºå®šä¸å˜çš„æ‰“å­—èŠ‚å¥ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>å¯ä»¥æ ¹æ®æœªæ‰“å°å­—ç¬¦æ•°æ¥åŠ¨æ€è°ƒæ•´æ¯æ¬¡æ‰“å­—çš„é€Ÿåº¦ï¼Œä¸€ç§å¯é€‰çš„å®ç°æ–¹æ¡ˆå¦‚ä¸‹ã€‚</p>
<p>å‡è®¾æœªæ‰“å°å­—ç¬¦æ•°ä¸º N ï¼Œé€Ÿåº¦å¹³æ»‘æŒ‡æ•°ä¸º a ï¼Œå®é™…æ‰“å­—é€Ÿåº¦ä¸º Vcurrent ï¼Œé€»è¾‘åº”è¾¾åˆ°çš„æ‰“å­—é€Ÿåº¦ä¸º Vnew ã€‚</p>
<p>if N &lt;= 10 , Vnew = 100 ms / 1å­—ç¬¦</p>
<p>if 10 &lt; N &lt;= 20 , Vnew = 100 - 8 * ( N - 10 ) ms / 1å­—ç¬¦</p>
<p>if 20 &lt; N , Vnew = 20 ms / 4å­—ç¬¦</p>
<p>Vcurrent = a * Vcurrent + ( 1 - a ) * Vnew</p>
<p>ä¸Šè¿°ç­–ç•¥å¯èƒ½ä¼šæ¯”è¾ƒå¤šï¼Œè€Œä¸”ä¸Šçº¿ä»¥åè¿˜æœ‰å¯èƒ½æ›´æ¢æ•°å€¼å¯¹ç…§æ•ˆæœï¼Œå› æ­¤ä¸ºäº†æ”¯æŒé…ç½®åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Vnewè¿›è¡Œè¡¨è¾¾å¼å½’çº³ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p>Vnew = Vinit - w * ( N - min ) + b</p>
<p>Vinit ä¸ºé»˜è®¤åˆå§‹æ‰“å­—é€Ÿåº¦ï¼Œw ä¸ºæ¯æ¡ç­–ç•¥çš„æƒé‡å€¼ï¼ŒN ä¸ºæœªæ‰“å°å­—ç¬¦æ•°ï¼Œmin ä¸ºæ¯æ¡ç­–ç•¥çš„æœ€å°å­—ç¬¦æ•°é‡æ¯”è¾ƒå€¼ï¼Œb ä¸ºæ¯æ¡ç­–ç•¥çš„åç½®ã€‚å…³é”®ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-css" lang="css">privatespeedFn({curSpeed, curIndex, totalLength}: any){  
    let leftCharLength = Math<span class="hljs-selector-class">.max</span>(<span class="hljs-number">0</span>, totalLength - curIndex);  
    let matchStrategy = this<span class="hljs-selector-class">.config</span><span class="hljs-selector-attr">[<span class="hljs-string">'writer'</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">'strategy'</span>]</span><span class="hljs-selector-class">.find</span>((item: any) =&gt; {  
        return (!item<span class="hljs-selector-attr">[<span class="hljs-string">'min'</span>]</span> || item<span class="hljs-selector-attr">[<span class="hljs-string">'min'</span>]</span> &lt; leftCharLength)  
            &amp;&amp; (!item<span class="hljs-selector-attr">[<span class="hljs-string">'max'</span>]</span> || item<span class="hljs-selector-attr">[<span class="hljs-string">'max'</span>]</span> &gt;= leftCharLength);  
    });  
    let speed = this<span class="hljs-selector-class">.config</span><span class="hljs-selector-attr">[<span class="hljs-string">'writer'</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">'initSpeed'</span>]</span> - matchStrategy<span class="hljs-selector-attr">[<span class="hljs-string">'w'</span>]</span> * (leftCharLength - (matchStrategy<span class="hljs-selector-attr">[<span class="hljs-string">'min'</span>]</span> || <span class="hljs-number">0</span>)) + matchStrategy<span class="hljs-selector-attr">[<span class="hljs-string">'b'</span>]</span>;  
    returnthis<span class="hljs-selector-class">.config</span><span class="hljs-selector-attr">[<span class="hljs-string">'writer'</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">'smoothParam'</span>]</span> * curSpeed + (<span class="hljs-number">1</span> - this<span class="hljs-selector-class">.config</span><span class="hljs-selector-attr">[<span class="hljs-string">'writer'</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">'smoothParam'</span>]</span>) * speed;  
}
</code></pre>
<p><strong>â‘£ æ‰“å­—è¿‡ç¨‹ä¸­ï¼Œä¼šæ—¶ä¸æ—¶çš„å›é€€åˆ°ä¹‹å‰å­—ç¬¦çš„ä½ç½®é‡æ–°å¼€å§‹æ‰“å­—ï¼Œä¾‹å¦‚å½“å‰å±•ç¤º a = b + c ï¼Œç­‰åˆ°ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼šä» a å¼€å§‹é‡æ–°æ‰“å®Œè¿™ä¸€æ®µã€‚</strong></p>
<p><strong>åŸå› åˆ†æ</strong></p>
<p>ç”±äºmarkdownæ–‡æœ¬ç»“åˆä¼šç”Ÿæˆhtmlæ ‡ç­¾ï¼Œä»è€Œå¯¼è‡´å­—ç¬¦æ•°é‡å¢å¤šï¼Œé‚£ä¹ˆå½“å‰ä¸‹æ ‡æŒ‡å‘çš„å­—ç¬¦å°±ç›¸å¯¹ä¹‹å‰è½åäº†ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">curIndex</span> = <span class="hljs-number">5</span><span class="hljs-comment">;// å½“å‰ä¸‹æ ‡</span>
let <span class="hljs-attr">prevMarkdown</span> = <span class="hljs-string">'**hello'</span><span class="hljs-comment">;// ä¸Šä¸€æ¬¡æ‰“å°æ—¶çš„å…¨é‡markdownæ–‡æœ¬</span>
let <span class="hljs-attr">prevHtml</span> = <span class="hljs-string">'&lt;p&gt;**hello&lt;/p&gt;'</span><span class="hljs-comment">;// ä¸Šä¸€æ¬¡æ‰“å°æ—¶çš„å…¨é‡htmlç‰‡æ®µ</span>
let <span class="hljs-attr">prevRenderHtml</span> = <span class="hljs-string">'&lt;p&gt;**&lt;p&gt;'</span><span class="hljs-comment">;// ä¸Šä¸€æ¬¡æ‰“å°åˆ°é¡µé¢ä¸Šçš„htmlç‰‡æ®µ</span>
// é¡µé¢ä¸Šä¼šæ¸²æŸ“ **

// å½“æœåŠ¡ç«¯ç»§ç»­ä¸‹å‘äº† ** çš„markdownæ–‡æœ¬æ—¶ï¼ŒcurIndexä¼šé€’å¢1å˜ä¸º6
let <span class="hljs-attr">curMarkdown</span> = <span class="hljs-string">'**hello**'</span><span class="hljs-comment">;// å½“å‰æ‰“å°æ—¶çš„å…¨é‡markdownæ–‡æœ¬</span>
let <span class="hljs-attr">curHtml</span> = <span class="hljs-string">'&lt;p&gt;&lt;strong&gt;hello&lt;/strong&gt;&lt;/p&gt;'</span><span class="hljs-comment">;// å½“å‰æ‰“å°æ—¶çš„å…¨é‡htmlç‰‡æ®µ</span>
let <span class="hljs-attr">curRenderHtml</span> = <span class="hljs-string">'&lt;p&gt;&lt;strong&gt;&lt;/strong&gt;&lt;p&gt;'</span><span class="hljs-comment">;// å½“å‰æ‰“å°åˆ°é¡µé¢ä¸Šçš„htmlç‰‡æ®µ</span>
// é¡µé¢ä¸Šä¼šæ¸²æŸ“ç©ºæ ‡ç­¾ï¼Œç„¶åé‡æ–°å¼€å§‹æ‰“å­—ï¼Œå°¤å…¶æ˜¯åœ¨æ•°å­¦å…¬å¼åœºæ™¯ä¸­éå¸¸å®¹æ˜“å¤ç°
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åˆ†ä¸¤æ­¥èµ°ã€‚</p>
<p>é¦–å…ˆéœ€è¦åˆ¤æ–­æ‰“å°åˆ°é¡µé¢ä¸Šçš„htmlç‰‡æ®µæ˜¯å¦æœ‰å˜åŒ–ï¼Œå› ä¸ºåªæœ‰å˜åŒ–æ—¶æ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œè€Œåˆ¤æ–­æ˜¯å¦æœ‰å˜åŒ–åªéœ€è¦è®°å½•ä¸€ä¸‹ä¸Šä¸€æ¬¡çš„htmlç‰‡æ®µå’Œè¿™ä¸€æ¬¡çš„htmlç‰‡æ®µæ˜¯å¦ä¸åŒå³å¯ï¼Œæ¯”è¾ƒå¥½å¤„ç†ã€‚</p>
<p>å…¶æ¬¡å°±æ˜¯éœ€è¦é‡æ–°å®šä½ä¸‹æ ‡åˆ°ä¸Šä¸€æ¬¡æ‰“å°åˆ°çš„ä½ç½®ï¼Œè¿™é‡Œç›¸å¯¹æ¯”è¾ƒéš¾å¤„ç†ï¼Œå› ä¸ºhtmlçš„ç»“æ„å’Œå†…å®¹éƒ½åœ¨å˜åŒ–ï¼Œå¾ˆéš¾å‡†ç¡®çš„å®šä½åˆ°ä¸‹æ ‡åº”è¯¥ç§»åŠ¨åˆ°ä»€ä¹ˆä½ç½®ã€‚è™½ç„¶æˆ‘ä»¬ä¸èƒ½å‡†ç¡®å®šä½ï¼Œä½†æ˜¯åªè¦èƒ½å¤Ÿä½¿å½“å‰æ‰“å°åˆ°é¡µé¢ä¸Šçš„å­—ç¬¦æ¯”ä¸Šä¸€æ¬¡çš„å­—ç¬¦å¤šï¼Œå°±å¯ä»¥æ»¡è¶³è¯‰æ±‚äº†ã€‚äºæ˜¯æˆ‘æƒ³åˆ°äº†textContentè¿™ä¸ªå±æ€§ï¼Œå®ƒå¯ä»¥è·å–å½“å‰èŠ‚ç‚¹åŠå…¶åä»£çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ã€‚é‚£ä¹ˆé—®é¢˜å°±è½¬åŒ–ä¸ºï¼šæ‰¾åˆ°ä¸€ä¸ªä¸‹æ ‡ï¼Œä½¿å¾—å½“å‰æˆªå–çš„htmlç‰‡æ®µçš„textContenté•¿åº¦è¦æ¯”ä¸Šä¸€æ¬¡çš„textContenté•¿åº¦å¤§ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¯ä»¥å¾—åˆ°æ ¸å¿ƒä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">if (this.isHtmlChanged()) {  
    let domRange: <span class="hljs-attr">any</span> = document.createRange()<span class="hljs-comment">;  </span>
    let <span class="hljs-attr">prevFrag</span> = domRange.createContextualFragment(this.prevRenderHtml)<span class="hljs-comment">;  </span>
    let <span class="hljs-attr">prevTextContent</span> = prevFrag.textContent<span class="hljs-comment">;  </span>
    let <span class="hljs-attr">diffNum</span> = <span class="hljs-number">1</span><span class="hljs-comment">;  </span>
    do {  
        this.curIndex += diffNum<span class="hljs-comment">;  </span>
        let <span class="hljs-attr">curHtml</span> = this.rawHtml.substring(<span class="hljs-number">0</span>, this.curIndex)<span class="hljs-comment">;  </span>
        let <span class="hljs-attr">curFrag</span> = domRange.createContextualFragment(curHtml)<span class="hljs-comment">;  </span>
        let <span class="hljs-attr">curTextContent</span> = curFrag.textContent<span class="hljs-comment">;  </span>
        <span class="hljs-attr">diffNum</span> = prevTextContent.length - curTextContent.length<span class="hljs-comment">;  </span>
        if (diffNum &lt;= 0) {  
            break<span class="hljs-comment">;  </span>
        }  
    } while (this.curIndex &lt; this.rawHtml.length)<span class="hljs-comment">;  </span>
}
</code></pre>
<h3 data-id="heading-11">5.4 å°ç»“</h3>
<p>é€šè¿‡ç°ä»£å‰ç«¯æ¡†æ¶æ„å»ºæ‰“å­—æœºç»„ä»¶ï¼Œä¸ä»…å‡å°‘äº†ä¸å¿…è¦çš„æ¸²æŸ“å’Œæ€§èƒ½æ¶ˆè€—ï¼Œè€Œä¸”è¿˜èƒ½é«˜æ•ˆçµæ´»çš„ç©¿æ’å„ç§é…·ç‚«çš„æ ·å¼æ•ˆæœï¼Œå®ç°æ›´å¤šå¤æ‚çš„äº§å“åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-12">å…­ã€æœªæ¥å±•æœ›</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†AIæœç´¢ä¸­å‰ç«¯æ‰“å­—æœºæ•ˆæœçš„å®ç°æ–¹æ¡ˆæ¼”è¿›è¿‡ç¨‹ï¼Œä»æœ€åˆçš„çº¯æ–‡æœ¬é€å­—ç¬¦æ‰“å­—æ•ˆæœï¼Œåˆ°å€ŸåŠ©ç°ä»£å‰ç«¯æ¡†æ¶å®ç°çµæ´»å¯å¤ç”¨çš„æ‰“å­—æœºç»„ä»¶ï¼Œæ¯ä¸€ä¸ªæŠ€æœ¯éš¾ç‚¹çš„æŠ€æœ¯çªç ´æ— ä¸ä½“ç°äº†å‰ç«¯æŠ€æœ¯çš„æŒç»­è¿›æ­¥å’Œäº§å“ä¸æ–­è¿½æ±‚å“è¶Šçš„æ€åº¦ã€‚åŒæ—¶æˆ‘ä¹Ÿå¸Œæœ›æœ¬æ–‡å¯ä»¥æŠ›ç –å¼•ç‰ï¼Œä¸ºè¯»è€…æ‰“å¼€æ€è·¯ï¼Œæä¾›å€Ÿé‰´ã€‚</p>
<p>éšç€äººå·¥æ™ºèƒ½å’Œå‰ç«¯æŠ€æœ¯çš„ä¸æ–­å‘å±•å’Œåˆ›æ–°ç”Ÿæ€çš„æ—¥ç›Šå®Œå–„ï¼Œæœªæ¥ä¸€å®šä¼šä¸æ–­æ¶Œç°å¤§é‡çš„æ–°æŠ€æœ¯å’Œæ–°ç†å¿µã€‚æˆ‘ç›¸ä¿¡åªè¦æ—¶åˆ»ä¿æŒç§¯æå­¦ä¹ å’Œä¸æ–­å°è¯•çš„æ¢ç´¢ç²¾ç¥ï¼Œå°±èƒ½å¼€æ‹“å‡ºæ›´å¤šç²¾å½©åˆ›æ–°çš„å®ç°æ–¹æ¡ˆå’Œåº”ç”¨åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¥¥ç‰¹æ›¼æ€•äº†ï¼GPT-5.5ã€Œå¤§è’œã€å†³æˆ˜è°·æ­Œï¼Œçº¢è‰²è­¦æŠ¥ç´§æ€¥æ‹‰å“]]></title>    <link>https://juejin.cn/post/7579440586694017070</link>    <guid>https://juejin.cn/post/7579440586694017070</guid>    <pubDate>2025-12-03T09:50:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579440586694017070" data-draft-id="7579410911057854490" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¥¥ç‰¹æ›¼æ€•äº†ï¼GPT-5.5ã€Œå¤§è’œã€å†³æˆ˜è°·æ­Œï¼Œçº¢è‰²è­¦æŠ¥ç´§æ€¥æ‹‰å“"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,OpenAI"/> <meta itemprop="datePublished" content="2025-12-03T09:50:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–°æ™ºå…ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/952600743642312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¥¥ç‰¹æ›¼æ€•äº†ï¼GPT-5.5ã€Œå¤§è’œã€å†³æˆ˜è°·æ­Œï¼Œçº¢è‰²è­¦æŠ¥ç´§æ€¥æ‹‰å“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/952600743642312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–°æ™ºå…ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:50:07.000Z" title="Wed Dec 03 2025 09:50:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9d38f7065b748a891c36a0bc56eeae0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=b7JlnF79na6NdkdQn3GBdsEZp0M%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-0"><strong>ã€Œã€æ–°æ™ºå…ƒå¯¼è¯»ã€‘ä¸‰å¹´æ²³ä¸œä¸‰å¹´æ²³è¥¿ï¼Œæ›¾ç»é€¼ç–¯è°·æ­Œçš„å¥¥ç‰¹æ›¼ï¼Œå¦‚ä»Šä¹Ÿè¢«è°·æ­Œé€¼å¾—æ‹‰å“äº†ã€Œçº¢è‰²è­¦æŠ¥ã€ï¼ŒAI ç‹åº§ä¹‹ä¸‹å·²æ˜¯åˆ€å…‰å‰‘å½±ã€‚æ›´åŠ²çˆ†çš„æ˜¯ï¼Œæœ€å¼ºã€ŒGarlicã€åœ¨é¢„è®­ç»ƒå–å¾—é‡å¤§çªç ´ï¼Œæ­£é¢ç¡¬åˆš Gemini 3.ã€</strong></h5>
<p>ä¸‰å¹´å‰ï¼ŒChatGPT æ¨ªç©ºå‡ºä¸–ã€‚</p>
<p>ç¬¬ä¸€æ¬¡æ„Ÿå—åˆ°é€éª¨ææƒ§çš„è°·æ­Œï¼Œä»“ä¿ƒæ‹‰å“äº†ã€Œçº¢è‰²è­¦æŠ¥ã€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29da3598447b43fbbbd262f8c65665a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=q9LGc7%2BMj8OflIN7v1Nnl1w6gcg%3D" alt="" loading="lazy"/></p>
<p>ä½†è°èƒ½æƒ³åˆ°ï¼Œä»…ä»…ä¸‰å¹´ï¼Œè¿™ä¸ªã€Œçº¢è‰²è­¦æŠ¥ã€ç«Ÿåœ¨ OpenAI è‡ªå·±å®¶é‡Œç‚¸å“ï¼</p>
<p>CEO å¥¥ç‰¹æ›¼ç´§æ€¥å‘å¸ƒå…¨å‘˜ä¿¡ï¼Œå­—é‡Œè¡Œé—´åªæœ‰ä¸€å¥ï¼š</p>
<p>ChatGPTï¼Œå±åœ¨æ—¦å¤•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af3a98cdacdc4b6ca834064513d2fd9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=XqBNEVNF7VSAmsKTYVArve6zNXE%3D" alt="" loading="lazy"/></p>
<p>å¥¥ç‰¹æ›¼ï¼šWe are at a critical time for ChatGPT</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39e5bbd52ffc4bb4b2dd06b5486ba907~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=kQnc093pzZHdnRukkHR8O2kYBs4%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œä»£å· Garlicã€</strong></p>
<p><strong>ã€ŒOpenAI ç¥ç§˜æ¨¡å‹æ›å…‰ã€</strong></p>
<p>è¿™ä¸€æ¬¡ï¼Œè½®åˆ° OpenAI äº†ã€‚</p>
<p>æ®å¥¥ç‰¹æ›¼é€éœ²ï¼Œä¸‹å‘¨ï¼ŒOpenAI è®¡åˆ’å‘å¸ƒä¸€æ¬¾å…¨æ–°çš„æ¨ç†æ¨¡å‹ã€‚</p>
<p>å†…éƒ¨è¯„ä¼°æ˜¾ç¤ºï¼Œè¿™ä¸ªæ¨¡å‹åœ¨æ€§èƒ½ä¸Šè¦æ¯” Gemini 3 æ›´å¼ºï¼Œä½†åœ¨æ”¹å–„ ChatGPT çš„ã€Œä½“éªŒã€æ–¹é¢è¿˜æœ‰æ›´å¤šå·¥ä½œè¦åšã€‚</p>
<p>ä¸ä»…å¦‚æ­¤ï¼ŒInforamtion æœ€æ–°çˆ†æ–™ç§°ï¼ŒOpenAI è¿˜åœ¨ç ”å‘æ–°ä¸€ä»£æ¨¡å‹ï¼Œå†…éƒ¨ä»£å·ã€ŒGarlicã€ï¼ˆå¤§è’œï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/920a70185fc041c1b62015d873782370~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=t%2FriiehDSCBP4dCKAGXrZFFmAg0%3D" alt="" loading="lazy"/></p>
<p>ã€ŒGarlicã€åœ¨é¢„è®­ç»ƒæ–¹é¢ï¼Œå®ç°äº†é‡å¤§çªç ´ã€‚</p>
<p>å®ƒä¿®å¤äº† GPT-4.5 æ—©æœŸç»“æ„ä¸­çš„é—®é¢˜ï¼Œé¢„è®¡æ˜å¹´åˆä½œä¸º GPT-5.2/GPT-5.5 å‘å¸ƒã€‚</p>
<p>è‡³å°‘åœ¨å†…éƒ¨å…¬æµ‹ä¸­ï¼Œã€ŒGarlicã€åœ¨ç¼–ç å’Œæ¨ç†ä»»åŠ¡ä¸Šï¼Œæ¯”è°·æ­Œ Gemini 3ã€Claude 4.5 Opus æ›´èƒœä¸€ç­¹ã€‚</p>
<p>ä¸Šä¸€å‘¨ï¼Œé¦–å¸­ç ”ç©¶å®˜ Mark Chen å‘å†…éƒ¨å›¢é˜Ÿåšäº†é—­é—¨åˆ†äº«ï¼Œæ ¸å¿ƒå°±ä¸€å¥è¯ï¼šã€ŒGarlicã€å‡†å¤‡å¥½äº†ï¼</p>
<p>æ˜¨å¤©ä¸€æ¬¡è®¿è°ˆä¸Šï¼ŒMark Chen å…¬å¼€å›åº”ï¼ŒGemini 3 æ˜¯ä¸€æ¬¾å¼ºå¤§æ¨¡å‹ï¼Œä½† OpenAI å·²æœ‰ä¸ä¹‹å®åŠ›ç›¸æŠ—çš„æ¨¡å‹ã€‚</p>
<p>ç”±æ­¤æ¥çœ‹ï¼ŒOpenAI æ—©å·²æ‚„æ‚„æŠŠä¸‹ä¸€å¼ ç‹ç‰Œæ”¥åœ¨äº†æ‰‹é‡Œã€‚</p>
<p>Mark Chen åœ¨å†…éƒ¨çš„åŸè¯æ˜¯ï¼š</p>
<p>æˆ‘ä»¬æ‰“ç®—å°½å¿«å‘å¸ƒ Garlic çš„æŸä¸ªç‰ˆæœ¬ã€‚ä»¥ç›®å‰çš„è¿›åº¦ï¼Œæ˜å¹´åˆå°±èƒ½çœ‹åˆ° GPT-5.2 æˆ– GPT-5.5 å‘å¸ƒï¼Œå¤§å®¶ä¹Ÿä¸å¿…æ„Ÿåˆ°æƒŠè®¶ã€‚</p>
<p>æ­¤å‰ï¼Œä¸ä»… Informationï¼Œè¿˜æœ‰ SemiAnalysis å¤šå®¶å¤–åª’çˆ†å‡ºï¼Œè‡ª GPT-4o ä¹‹åï¼ŒOpenAI å°šæœªå®Œæˆä¸‹ä¸€ä»£å‰æ²¿å¤§æ¨¡å‹çš„é¢„è®­ç»ƒä¸Šã€‚</p>
<p>å› ä¸ºè¿™äº›æŒ‘æˆ˜ï¼ŒOpenAI æ‰ä¸å¾—å·²å°†é‡å¿ƒè½¬å‘äº†â€”â€”æ¨ç†æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b192aee20f9e44bcb00cf8d63ee7afbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=y5MuIyQugYkf4a2cdW2vdNkqGIA%3D" alt="" loading="lazy"/></p>
<p>10 æœˆï¼Œå¥¥ç‰¹æ›¼æ›¾å‘å…¨å‘˜ä¿è¯ï¼ŒOpenAI å°†å‘å¸ƒä»£å·ä¸ºã€ŒShallotpeatã€çš„æ–°å¤§è¯­è¨€æ¨¡å‹ï¼Œæ¥åº”æˆ˜è°·æ­Œ Gemini 3ã€‚</p>
<p>æ˜¾ç„¶ï¼Œã€ŒGarlicã€å’Œã€ŒShallotpeatã€æ˜¯ä¸¤æ¬¾ä¸åŒçš„æ¨¡å‹ã€‚</p>
<p>å‰è€…æ•´åˆäº†åœ¨å¼€å‘ã€ŒShallotpeatã€æœŸé—´ä¿®å¤çš„ Bugï¼Œæœ€å…³é”®çš„çªç ´å‘ç”Ÿåœ¨ã€Œé¢„è®­ç»ƒé˜¶æ®µã€ã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè°·æ­Œåœ¨ Gemini 3 ä¸Šæœ€å¤§çš„åº•æ°”ï¼Œå°±æ˜¯åœ¨é¢„è®­ç»ƒé˜¶æ®µå®ç°äº†ã€Œè´¨çš„é£è·ƒã€ã€‚</p>
<p>å°±è¿ OpenAI é«˜å±‚ï¼Œä¹Ÿåœ¨ç§ä¸‹æ‰¿è®¤äº†è¿™ä¸€ç‚¹ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨ã€ŒGarlicã€å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒOpenAI è§£å†³äº†æ­¤å‰é¢„è®­ç»ƒç¯èŠ‚é‡åˆ°çš„ä¸€äº›å…³é”®é—®é¢˜â€”â€”</p>
<p>æ”¹è¿›ä¹‹å‰ã€Œæœ€å¥½çš„ã€ä¸”ã€Œä½“é‡å¤§å¾—å¤šã€çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</p>
<p>ä¹Ÿå°±æ˜¯ï¼Œä»Šå¹´ 2 æœˆå‘å¸ƒåï¼Œä¾¿å¦‚æ˜™èŠ±ä¸€ç°ã€å¦‚ä»Šå·²æ²¡ä»€ä¹ˆå­˜åœ¨æ„Ÿçš„ GPT-4.5ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œè¿™äº›ä¼˜åŒ–å¯ä»¥è®© OpenAI å°†åŒæ ·æµ·é‡çš„çŸ¥è¯†æ³¨å…¥åˆ°ä¸€ä¸ªæ›´å°çš„æ¨¡å‹ä¸­ã€‚è€Œä»¥å‰ï¼Œåªèƒ½é€šè¿‡å¼€å‘å·¨é‡æ¨¡å‹ï¼Œæ¥å®ç°ã€‚</p>
<p>ä¸ç”¨è¯´ï¼Œå¼€å‘å¤§æ¨¡å‹è‚¯å®šæ¯”å¼€å‘å°æ¨¡å‹æ›´çƒ§é’±ã€æ›´è€—æ—¶ï¼</p>
<p>Mark Chen è¿˜é€éœ²ä¸€ä¸ªæ›´ç‚¸è£‚çš„æ¶ˆæ¯ï¼š</p>
<p>å‡­å€Ÿç€ã€ŒGarlicã€çš„ç»éªŒç§¯ç´¯ï¼ŒOpenAI å·²æ‚„ç„¶å¯åŠ¨ä¸‹ä¸€ä»£æ›´å¤§ã€æ›´å¼ºçš„æ¨¡å‹äº†ã€‚</p>
<p>è¿™ä¸¤å‘¨ï¼ŒAI åœˆçš„é£å‘éƒ½å¹å‘äº†è°·æ­Œï¼ŒOpenAI ç½•è§åœ°é™·å…¥äº†è¢«åŠ¨ã€Œè¿½èµ¶ç€ã€çš„è§’è‰²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f0b5501d8574d64a514d3f28ddd65cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=RJUMvUtBUEe4fkRWPeCiXKpJiZ0%3D" alt="" loading="lazy"/></p>
<p>Gemini 3 å‘å¸ƒä¸¤å‘¨åï¼ŒChatGPT æ—¥æ´»è·ƒç”¨æˆ·ä¸‹é™äº† 6%</p>
<p>åœ¨æ‰³å›ä¸€å±€ä¹‹å‰ï¼ŒOpenAI å¿…é¡»æ‹‰å“ã€Œçº¢è‰²è­¦æŠ¥ã€ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6285a9ccf1554bcbb0f7e86d5c79835a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=RTPoiSjtG2vueQkU4rhqALAVCLc%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œã€ŒCode Redã€ã€</strong></p>
<p><strong>ã€Œç”Ÿæ­»å­˜äº¡ä¿å«æˆ˜æ‰“å“ã€</strong></p>
<p>å‡ å‘¨å‰ï¼Œä¸ºäº†æ”¹è¿› ChatGPTï¼ŒOpenAI æ›¾å®£å¸ƒè¿›å…¥äº†ã€Œæ©™è‰²è­¦æŠ¥ã€çŠ¶æ€ã€‚</p>
<p>å¦‚ä»Šçš„å¦‚ä»Šï¼Œä¸€åˆ‡æ›´åŠ ç´§è¿«äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71e402c6ca834626855245b77ab62ae7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=QLVmh6IH0phTdEW67kRKzngShs8%3D" alt="" loading="lazy"/></p>
<p>éšç€ Code Red çš„å‘å¸ƒï¼Œ<strong>ã€Œé‚£äº›æ›¾ç»æ’æœŸåœ¨å‰çš„é¡¹ç›®éƒ½è¢«æ¨è¿Ÿäº†ã€‚ã€</strong></p>
<ul>
<li><strong>ã€Œå¹¿å‘Šä¸šåŠ¡ã€</strong>ï¼šæœ¬æ¥æƒ³å¼€å§‹é€šè¿‡æœç´¢èµšé’±çš„ï¼Œå…ˆæ”¾æ”¾ã€‚</li>
<li><strong>ã€ŒAIã€</strong> <strong>ã€Œæ™ºèƒ½ä½“ã€</strong>ï¼šé‚£ç§èƒ½å¸®ä½ è‡ªåŠ¨ä¹°ç¥¨ã€æŒ‚å·çš„å…¨èƒ½åŠ©æ‰‹ï¼Œå…ˆç­‰ç­‰ã€‚</li>
<li><strong>ã€ŒPulseã€</strong>ï¼šæœ¬æ¥æ‰“ç®—æ¯å¤©æ—©ä¸Šç»™ä½ å‘ä¸ªæ€§åŒ–æ–°é—»æ—©æŠ¥çš„äº§å“ï¼Œä¹Ÿç æ‰äº†ã€‚</li>
</ul>
<p><strong>ã€Œç›®çš„å¾ˆç®€å•ã€‚ã€</strong></p>
<p><strong>ã€Œå°±æ˜¯ç”¨æ‰‹å¤´ä¸Šæ‰€æœ‰çš„ç®—åŠ›ã€äººåŠ›å’Œè´¢åŠ›ï¼Œå»****æœåŠ¡ä¸€ä»¶äº‹ï¼šã€</strong></p>
<p>è®©ç°åœ¨çš„ ChatGPT å˜å¾—æ›´å¥½ã€‚</p>
<p><strong>ã€Œ<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f19b44da3c2424e89343dc5297ccad5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=6ysCdVCC2GhB%2F6LcSyMTkomKIIY%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œã€ŒæŠ¤åŸæ²³ã€æ­£åœ¨å˜æµ…ã€</strong></p>
<p>ä¸ºä»€ä¹ˆè¦å¦‚æ­¤å¤§åŠ¨å¹²æˆˆï¼Ÿ</p>
<p>å› ä¸º OpenAI å‘ç°ï¼ŒåŸæœ¬çœ‹èµ·æ¥ä¸å¯é€¾è¶Šçš„é¢†å…ˆä¼˜åŠ¿ï¼Œæ­£åœ¨è¢«å¯¹æ‰‹ä¸€ç‚¹ç‚¹èš•é£Ÿã€‚</p>
<p><strong>ã€Œ1. å¢é•¿ä¼¼ä¹æ²¡ä»¥å‰é‚£ä¹ˆçŒ›äº†ï¼šã€</strong></p>
<p>CFO åœ¨ä¸æŠ•èµ„äººçš„ç”µè¯ä¼šè®®ä¸­æš—ç¤ºï¼šChatGPT çš„æŸäº›å¢é•¿æŒ‡æ ‡åœ¨æ”¾ç¼“â€”â€”å¯èƒ½æ˜¯ç”¨æˆ·æ•°ã€ä½¿ç”¨æ—¶é•¿ã€è®¢é˜…æ•°ï¼Œç­‰ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0e23cfc86744b9882a7b5102ad42f9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=sy8Hgsn1j1sQVVwp%2B5UH4qmO%2Fo8%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ2. è°·æ­Œçš„åå‡»ï¼Œè¶Šæ¥è¶Šæœ‰å¨èƒã€****ï¼š</strong></p>
<p>å¼ºå¤§çš„æ–°ä¸€ä»£æ¨¡å‹å¸å¼•åŠ›åè¶³ï¼Œä¸ç®¡æ˜¯ç”¨æˆ·è¿˜æ˜¯å¼€å‘è€…ï¼Œéƒ½ä¸å†åªç›¯ç€ OpenAI ä¸€å®¶ã€‚</p>
<p>åœ¨æœç´¢ä¸­åŠ å…¥çš„ã€ŒAI æ¨¡å¼ã€ï¼Œè®©æœç´¢è¿™ä»¶äº‹å˜æˆäº†åƒæ˜¯å’Œã€ŒAI èŠå¤©ã€ä¸€æ ·ã€‚</p>
<p>ç§ç§å› ç´ å åŠ ä¹‹åï¼ŒGemini çš„æœˆæ´»ç”¨æˆ·ä¹Ÿä» 7 æœˆçš„ 4.5 äº¿ï¼Œé£™å‡åˆ°äº† 10 æœˆçš„ 6.5 äº¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6799f0b58ffb48d484f2d5cb731729f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=whF8SpCiXmOEDPoO6tXd%2Bei6tL8%3D" alt="" loading="lazy"/></p>
<p>å¥¥ç‰¹æ›¼å‘å†…éƒ¨ä¿¡ï¼Œè­¦å‘Šé“ï¼šè°·æ­Œåœ¨ AI é¢†åŸŸçš„å·åœŸé‡æ¥ï¼Œå¯èƒ½ä¼šç»™ OpenAI å¸¦æ¥ã€Œæš‚æ—¶æ€§çš„ç»æµé€†é£ã€</p>
<p><strong>ã€Œ3. è¦çƒ§çš„é’±ï¼Œå®åœ¨å¤ªå¤šäº†ï¼šã€</strong></p>
<p>æœªæ¥å‡ å¹´ï¼Œä¸ºäº†è®­ç»ƒæ›´å¼ºæ¨¡å‹ + æ”¯æ’‘ ChatGPT è·‘èµ·æ¥ï¼ŒOpenAI è¦çƒ§æ‰æ•°ç™¾äº¿ç¾å…ƒã€‚</p>
<p>åè¿‡æ¥ï¼ŒChatGPT è®¢é˜…å¸¦æ¥çš„æ”¶å…¥é¢„æœŸæ˜¯ï¼šä»Šå¹´çº¦ 100 äº¿ç¾å…ƒï¼Œæ˜å¹´ 200 äº¿ï¼Œ2027 å¹´ 350 äº¿ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†ç»™è¿™åœºã€Œçƒ§é’±é•¿è·‘ã€ç»­å‘½ï¼ŒOpenAI å¸Œæœ›èƒ½å¤Ÿå†èå·®ä¸å¤š 1000 äº¿ç¾å…ƒã€‚</p>
<p>ä½†æˆåŠŸä¸å¦ï¼Œå°±å¾—çœ‹ ChatGPT çš„è¡¨ç°å¦‚ä½•äº†ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼Œåœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œ<strong>ã€Œä»»ä½•å¢é•¿æ”¾ç¼“ã€ç”¨æˆ·æµå¤±ï¼Œéƒ½ä¼šè¢«æ”¾å¤§æˆã€Œç”Ÿæ­»é—®é¢˜ã€ã€</strong>ã€‚</p>
<ol>
<li>ç”¨æˆ·é‡è¿½é€æˆ˜</li>
</ol>
<ul>
<li>OpenAI è¡¨ç¤ºï¼ŒChatGPT ç›®å‰æ‰¿æ‹…äº†å…¨çƒ 70% çš„ã€ŒAI åŠ©æ‰‹æ´»åŠ¨ã€å’Œ 10% çš„ã€Œæœç´¢æ´»åŠ¨ã€ã€‚</li>
<li>è°·æ­Œåˆ™å±•ç¤º Gemini çš„å¿«é€Ÿå¢é•¿ï¼ŒæŠŠå®ƒæ·±åº¦æ•´åˆåˆ°è‡ªå®¶æœç´¢å’Œäº§å“çŸ©é˜µé‡Œã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9d798e180bd44a5af4c25d4fbc59e40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=z9CQnnJQKLVqWt4O%2FG4PT4BkNt4%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>ç”Ÿæ€ vs. çˆ†æ¬¾</li>
</ol>
<ul>
<li>OpenAI ç›®å‰çš„ç‹ç‰Œæ˜¯ï¼šä¸€ä¸ªæå¼ºã€æå‡ºåœˆçš„ ChatGPT + ä¸€å¥—å¼€å‘è€… APIã€‚</li>
<li>è°·æ­Œæ‹¿å‡ºçš„åˆ™æ˜¯ï¼šæœç´¢ + é‚®ç®± + æ–‡æ¡£ + å®‰å“ + æµè§ˆå™¨ + YouTube+â€¦+Geminiï¼Œæ•´ä¸ªç”Ÿæ€é€šé€š AI åŒ–ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7ede0fbea7a4a3eb4be3406e7ec5281~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=4hAwR3E2zUuQ9yjtbyv39GkX%2Bt8%3D" alt="" loading="lazy"/></p>
<p><strong>ã€ŒOpenAI æ‰“ç®—æŠŠèµ„æºç ¸åœ¨å“ªé‡Œï¼Ÿã€</strong></p>
<p>åœ¨å¤‡å¿˜å½•é‡Œï¼Œå¥¥ç‰¹æ›¼é‡ç‚¹ç‚¹äº†å‡ æ¡ã€Œä¼˜å…ˆçº§æ‹‰æ»¡ã€çš„æ–¹å‘ï¼š</p>
<p><strong>ã€Œ<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f3d08e5fcde425cbc45645bb2cad11a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=nQW5uK2d%2BQo2OpaQgmgJAOKI6r8%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œè®©æ¯ä¸ªäººéƒ½èƒ½å®šåˆ¶è‡ªå·±çš„ AIã€</strong></p>
<p>ä»–è¯´è¦**ã€Œè®©æ¯å‘¨ 8 äº¿æ¬¡ä½¿ç”¨èƒŒåçš„äººï¼Œæ„Ÿè§‰è¿™å°±æ˜¯****ã€Œ<strong>ã€Œ</strong>ã€Œæˆ‘çš„ ChatGPTã€<strong>ã€</strong>ã€ã€**ï¼Œè€Œä¸æ˜¯åƒç¯‡ä¸€å¾‹çš„å¤§ä¼—å·¥å…·ï¼š</p>
<ul>
<li>å…è®¸ç”¨æˆ·å®šåˆ¶ï¼šå®ƒçš„è¯´è¯é£æ ¼ã€åå¥½ã€å·¥ä½œæµæ–¹å¼ï¼Œç”šè‡³è®°ä½ä½ æ˜¯è°ã€ä½ æ€ä¹ˆåšäº‹ã€‚</li>
<li>è¿™å’Œæ­¤å‰æåˆ°çš„ã€ŒMemoryã€ï¼ˆè®°å¿†åŠŸèƒ½ï¼‰ä¸€è„‰ç›¸æ‰¿â€”â€”AI ä¸åªæ˜¯å›ç­”é—®é¢˜ï¼Œè€Œæ˜¯é•¿æœŸã€Œè®¤è¯†ä½ ã€ã€‚</li>
</ul>
<p>ç°åœ¨çš„ ChatGPTï¼Œåƒä¸€ä¸ªæ¯æ¬¡è§é¢éƒ½è¦é‡æ–°è‡ªæˆ‘ä»‹ç»çš„å‰å°ã€‚</p>
<p>è€Œæœªæ¥å®ƒæ›´åƒä¸€ä¸ªé•¿æœŸè·Ÿä½ æ­æ¡£çš„åŠ©ç†ï¼šè®°å¾—ä½ åšä»€ä¹ˆå·¥ç§ã€ä½ å®¶æœ‰å‡ ä¸ªå­©å­ã€ä½ å†™ä»£ç ç”¨ä»€ä¹ˆé£æ ¼ã€ä½ è®¨åŒä»€ä¹ˆè¯­æ°”ã€‚</p>
<p>è¿™ä»¶äº‹ï¼Œå¯¹**ã€Œæé«˜ç”¨æˆ·é»æ€§ã€**éå¸¸å…³é”®â€”â€”</p>
<p>å½“ä¸€ä¸ªå·¥å…·å¼€å§‹ã€Œæ‡‚ä½ ã€ï¼Œä½ å°±ä¸å¤ªæƒ³é¢‘ç¹æ¢å¹³å°äº†ã€‚</p>
<p><strong>ã€Œ<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7be84617ae14ca89360d57a315be09e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=gxL3dUZ0U6K14Xqhec3nIw%2F8c9Y%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œå›¾åƒç”Ÿæˆæ˜¯ç¬¬äºŒæˆ˜åœºã€</strong></p>
<p>å›¾åƒç”Ÿæˆä¹‹æ‰€ä»¥é‡è¦ï¼Œæ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å¾ˆå¤šäººå¯èƒ½ä¸ä¼šé•¿æœŸç”¨ ChatGPT å†™é•¿æ–‡ï¼Œä½†ä¼š**ã€Œç»å¸¸æ¥ç”Ÿå›¾ã€**ï¼›</li>
<li>è¿™æ˜¯å’Œ**ã€Œåˆ›ä½œè€…ã€è®¾è®¡å¸ˆã€æ™®é€šç”¨æˆ·ã€<strong>è”ç»“çš„</strong>ã€Œå…³é”®ã€**å…¥å£ï¼›</li>
<li>å›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œä¹Ÿå¯ä»¥åå“ºå¾ˆå¤š**ã€Œäº§å“åœºæ™¯ã€**ï¼ˆå¹¿å‘Šè®¾è®¡ã€ç”µå•†å±•ç¤ºã€æ¸¸æˆæ¦‚å¿µå›¾ç­‰ï¼‰ã€‚</li>
</ul>
<p>æœ€è¿‘è¿™æ®µæ—¶é—´ï¼Œè°·æ­Œä¾¿æ˜¯å‡­å€Ÿç€ Nano Banana å’Œ Nano Banana Pro æ–­å´–å¼çš„é¢†å…ˆä¼˜åŠ¿ï¼Œè¿ç»­æ•°æœˆç§°éœ¸å…¨çƒ AI åœˆçš„çƒ­é—¨è¯é¢˜ã€‚</p>
<p>æ‰€ä»¥ä¹Ÿä¸éš¾ç†è§£ï¼Œä¸ºä½•å¥¥ç‰¹æ›¼ä¼šæŠŠå›¾åƒç”Ÿæˆèƒ½åŠ›åˆ—ä¸º Code Red çš„é‡ç‚¹ä¹‹ä¸€äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89eb88ca2ceb4e6dab2bee244cea0341~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=sBjmTRpjalKSJmUn%2FppMjcvrnFo%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cc07fa3b3e845e59c0f90136caa5319~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=rgahpPUABX9F2GFZcODDYWO8rmk%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œèµ¢ä¸‹å„ç§å…¬å¼€æ’è¡Œæ¦œçš„å¿ƒæ™ºæˆ˜ã€</strong></p>
<p>ã€Œæ¨¡å‹è¡Œä¸ºã€åŒ…æ‹¬å‡ ä»¶äº‹ï¼š</p>
<ul>
<li>å›ç­”æ˜¯å¦**ã€Œå‡†ç¡®ã€æœ‰ç”¨ã€å°‘èƒ¡è¯´å…«é“ã€**ï¼›</li>
<li>æ˜¯å¦<strong>è¯­æ°”èˆ’æœï¼Œä¸é˜´é˜³æ€ªæ°”ã€****ã€Œæœ‰äººå‘³ã€</strong>ï¼›</li>
<li>æ˜¯å¦**ã€Œåˆšåˆšå¥½æ‹¿æã€**å®‰å…¨ä¸å¼€æ”¾ä¹‹é—´çš„å°ºåº¦ã€‚</li>
</ul>
<p>è€Œå¥¥ç‰¹æ›¼æƒ³è¦çš„ï¼Œæ˜¯å¤§å¹…æ”¹å–„è¿™äº›ã€Œè¡Œä¸ºã€ï¼Œä»è€Œè®©ç”¨æˆ·åœ¨ LMArena è¿™ç±»å…¬å¼€æ’åé‡Œï¼Œæ›´æ„¿æ„é€‰ ChatGPT èƒŒåçš„æ¨¡å‹ï¼Œè€Œä¸æ˜¯ç«å“ã€‚</p>
<p>å› ä¸ºï¼Œè¿™ç±»æ¦œå•å¯¹**ã€Œå¼€å‘è€…å’Œé‡åº¦ç”¨æˆ·ã€**å½±å“å¾ˆå¤§ï¼Œä¼šå½±å“ä»–ä»¬é€‰å“ªä¸ªæ¨¡å‹æ¥æ„å»ºè‡ªå·±çš„åº”ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42de62cb8e7b4a23bbebf081d8d04b85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=vYhQ3ckNYMPsnQS6UaC2YOr13Xs%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fddb852bd223473890aade45da8ad3ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=G236tf3SjYmJvt8AC7uwZRyeB6s%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œé€Ÿåº¦ã€å¯é æ€§å’Œæ‹’ç»æœºåˆ¶ã€</strong></p>
<p>æ­¤å¤–ï¼Œå¥¥ç‰¹æ›¼è¿˜ç‚¹åäº†ä¸‰ä¸ªä¼˜åŒ–æ–¹å‘ï¼š</p>
<ul>
<li>å›ç­”**ã€Œé€Ÿåº¦ã€**æ›´å¿«</li>
<li><strong>ã€Œå¯é æ€§æ›´é«˜ã€</strong></li>
<li><strong>ã€Œ</strong>ã€Œ<strong>ã€Œè¿‡åº¦æ‹’ç»ã€</strong>ã€<strong>ã€****ã€Œæ›´å°‘ã€</strong></li>
</ul>
<p>é€Ÿåº¦æ–¹é¢ï¼Œä¸ä»…ç”¨æˆ·ååˆ†æ•æ„Ÿï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´æ›´æ˜¯å¦‚æ­¤â€”â€”å»¶è¿Ÿå¤ªé«˜ï¼Œæ•´ä¸ªäº§å“çš„ä½“éªŒå°±ä¼šç›´æ¥å´©ç›˜ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œã€Œè¿‡åº¦æ‹’ç»ã€ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„ä½¿ç”¨ç—›ç‚¹ï¼šä½ æ˜æ˜é—®çš„æ˜¯æ­£å¸¸é—®é¢˜ï¼Œç»“æœ AI è¢«é£æ§å“åˆ°ï¼ŒåŠ¨ä¸åŠ¨å°±è¯´ã€Œå¯¹ä¸èµ·ï¼Œæˆ‘æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜ã€ã€‚</p>
<p>æ¥ä¸‹æ¥ä»–ä»¬è¦åšçš„æ˜¯ï¼š<strong>ã€Œåœ¨å®‰å…¨çº¢çº¿å†…ï¼Œå°½é‡å‡å°‘è¯¯ä¼¤æ­£å¸¸éœ€æ±‚ã€‚ã€</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9532252387824d8c8d8eba8ed0e1f891~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=MMYbCORDRO965niMuJUMEhaHyjo%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œè¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿã€</strong></p>
<p>å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´ï¼Œä»–ä»¬åœ¨ä¸€ä¸ªå¹³å°ä¸ŠæŠ•å…¥çš„ã€Œæ—¶é—´ + ä¹ æƒ¯ã€ï¼Œä¼šå½¢æˆæ›´å¼ºçš„é”å®šã€‚</p>
<p><strong>ã€Œæœªæ¥çš„ ChatGPTï¼Œä¼šè¶Šæ¥è¶Šåƒã€****ã€Œ</strong>ã€Œ<strong>ã€Œç§äººã€</strong> <strong>ã€ŒAIã€</strong> <strong>ã€ŒåŠ©ç†ã€</strong>ã€<strong>ã€</strong>ã€Œ<strong>ã€Œï¼Œè€Œä¸æ˜¯å…¬å…±é—®ç­”æœºã€</strong>ã€**ã€‚**å®ƒä¼šæ›´äº†è§£ä½ çš„åå¥½ã€æ›´ä¼šã€Œè®°äº‹ã€ã€æ›´åƒä¸€ä¸ªé•¿ä¹…é™ªä¼´çš„å·¥å…·ã€‚</p>
<p><strong>ã€Œä½“éªŒæ–¹é¢ï¼Œä¹Ÿä¼šæ›´å¿«ã€æ›´ç¨³å®šï¼Œä»¥åŠ</strong>ã€Œ<strong>ã€Œæ›´ã€</strong>ã€<strong>å°‘æ— æ•…è¢«æ‹’ã€****ã€‚</strong></p>
<p>å¦‚æœèƒ½è®©ç”¨æˆ·ä½¿ç”¨èµ·æ¥æ›´é¡ºæ‰‹ï¼Œé‚£ä¹ˆå°±æœ‰æœºä¼šå¢åŠ ä»–ä»¬å¯¹ AI çš„ä¾èµ–åº¦ã€‚ä¹Ÿå°±æ˜¯ï¼Œä»ã€Œå¶å°”ç©ç©ã€å˜æˆã€Œæ¯å¤©ç¦»ä¸å¼€ã€ã€‚</p>
<p>**ã€Œå›¾åƒã€åˆ›æ„ã€å¤šæ¨¡æ€ï¼Œä¼šè¶Šæ¥è¶Šé‡è¦ã€****ã€‚**ä¸åªæ˜¯ã€Œé—®ç­”å’Œå†™ä½œã€ï¼Œè€Œæ˜¯è´¯ç©¿ã€Œå†™æ–‡ + ç”»å›¾ + åšè®¾è®¡ + æŸ¥èµ„æ–™ã€çš„å…¨å¥—æµç¨‹ã€‚</p>
<p>å¯¹äºè¡Œä¸šæ¥è¯´ï¼Œ<strong>ã€ŒçŸ­æœŸå†…ã€****ã€Œ</strong>ã€Œ<strong>ã€Œå·ä½“éªŒã€</strong>ã€<strong>ã€</strong>ã€Œ<strong>ã€Œä¼šæ¯”ã€</strong>ã€<strong>ã€Œ</strong>ã€Œ<strong>ã€Œå·å‚æ•°é‡ã€</strong>ã€<strong>ã€</strong>ã€Œ<strong>ã€Œæ›´é‡è¦ã€</strong>ã€<strong>ã€‚</strong></p>
<p><strong>ã€Œæ¨¡å‹å‚æ•°ä¸€å†å‡çº§ï¼Œæ™®é€šç”¨æˆ·å·²ç»åˆ†ä¸æ¸…ã€Œ1 ä¸‡äº¿å‚æ•°ã€å’Œã€Œ2 ä¸‡äº¿å‚æ•°ã€çš„åŒºåˆ«äº†ã€‚ä½†æ˜¯è°æ‰“å¼€æ›´å¿«ã€è°æ›´ç¨³å®šã€è°æ›´æ‡‚è‡ªå·±ï¼Œç”¨æˆ·ä¸€ç”¨å°±çŸ¥é“ã€‚ã€</strong></p>
<p><strong>ã€Œå¯¹äºã€</strong> <strong>ã€ŒOpenAIã€</strong> <strong>ã€Œæ¥è¯´ï¼Œè¿™æ˜¯ä¸€æ¬¡ã€****ã€Œ</strong>ã€Œ<strong>ã€Œä¸ä¸€å®šã€</strong>ã€<strong>å†³å®šç”Ÿæ­»</strong>**ã€ä½†ä¼°å€¼æ„ä¹‰æå¤§****ã€<strong>ã€Œ</strong>ã€Œçš„äº‰å¤ºæˆ˜ã€<strong>ã€</strong>ã€‚**</p>
<p>1000 äº¿ç¾å…ƒçš„èèµ„ç›®æ ‡ã€æ•°ç™¾äº¿ç¾å…ƒçš„ç®—åŠ›æŠ•å…¥ï¼Œéƒ½éœ€è¦ä¸€ä¸ªå¼ºè€Œç¨³å®šçš„ç°é‡‘ç‰›åšæ”¯æ’‘ã€‚</p>
<p>è€Œ ChatGPT å°±æ˜¯è¿™å¤´ç‰›ï¼šä¸ä»…è¦æœ‰æµé‡ï¼Œè¿˜è¦æœ‰ç²˜æ€§å’Œä»˜è´¹æ„æ„¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/491a697e71514f92b17bf03f4d56a220~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=KD%2F%2Fa8IEkgsj76abVrFJFm7Hi%2BM%3D" alt="" loading="lazy"/></p>
<p><strong>å¼€å‘è€…å’Œåˆ›ä¸šè€…ï¼Œ****ã€Œåˆ™è¦å¼€å§‹è€ƒè™‘ç«™é˜Ÿå“ªä¸ªã€Œ</strong>ã€Œ<strong>ã€Œç”Ÿæ€å¤§æœ¬è¥ã€</strong>ã€<strong>ã€ï¼šã€</strong></p>
<ul>
<li>å¦‚æœ ChatGPT çš„ä½“éªŒå’Œå£ç¢‘ç»§ç»­é¢†å…ˆï¼Œå®ƒä¼šæˆä¸ºå¤§å®¶é»˜è®¤æ¥å…¥çš„ã€ŒAI æ°´ç”µç«™ã€ï¼›</li>
<li>è°·æ­Œç­‰å¦‚æœåœ¨æŸäº›åœºæ™¯åšå¾—æ›´é¡ºæ»‘ï¼ŒåŠ¿å¿…åˆ†èµ°ä¸€éƒ¨åˆ†æ–°åº”ç”¨ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89a2e07dfb1248f9a04550a9b8df6070~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360206&amp;x-signature=ChKKg3dEwvVIU90kL9dce2YgvXM%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œä¸€åœºæ²¡æœ‰ç»ˆç‚¹çš„å†›å¤‡ç«èµ›ã€</strong></p>
<p><strong>ã€Œæ€»ç»“èµ·æ¥å°±ä¸€å¥ï¼šAI èµ›é“ï¼Œ</strong>ã€Œæ²¡æœ‰æ°¸æ’çš„ç‹åº§ã€‚ã€<strong>ã€</strong></p>
<p>ä»…ä»…ä¸‰å¹´å‰ï¼ŒChatGPT è¿˜æ˜¯é‚£ä¸ªæŠŠè°·æ­Œå“å‡ºä¸€èº«å†·æ±—çš„ã€Œå± é¾™å°‘å¹´ã€ï¼Œå¦‚ä»Šå´åœ¨ç–²äºåº”å¯¹æ¥è‡ªæœç´¢å¸å›½çš„å‡›å†½åæ€ã€‚</p>
<p>ä¸è¿‡ï¼Œè¿™æ°æ°æ˜¯æ™®é€šç”¨æˆ·çš„ã€Œæ—¶ä»£çº¢åˆ©ã€â€”â€”ä»–ä»¬å·å¾—è¶Šå‡¶ï¼Œæˆ‘ä»¬ç”¨å¾—è¶Šçˆ½ã€‚</p>
<p>åƒå¸†è¿‡å°½ï¼Œæè‡´çš„äº§å“ä½“éªŒï¼Œæ‰æ˜¯äº˜å¤ä¸å˜çš„ç¡¬é“ç†ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼šHJY</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.theinformation.com%2Farticles%2Fopenai-ceo-declares-code-red-combat-threats-chatgpt-delays-ads-effort%3Frc%3Depv9gi" target="_blank" title="https://www.theinformation.com/articles/openai-ceo-declares-code-red-combat-threats-chatgpt-delays-ads-effort?rc=epv9gi" ref="nofollow noopener noreferrer">www.theinformation.com/articles/opâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Gradle å­¦ä¹  - Kts Gradleå­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7579298511072346112</link>    <guid>https://juejin.cn/post/7579298511072346112</guid>    <pubDate>2025-12-03T09:57:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579298511072346112" data-draft-id="7578820431039561768" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Gradle å­¦ä¹  - Kts Gradleå­¦ä¹ "/> <meta itemprop="keywords" content="å‰ç«¯,gradle"/> <meta itemprop="datePublished" content="2025-12-03T09:57:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜å·"/> <meta itemprop="url" content="https://juejin.cn/user/114004941350269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Gradle å­¦ä¹  - Kts Gradleå­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/114004941350269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜å·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T09:57:32.000Z" title="Wed Dec 03 2025 09:57:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>â€ƒâ€ƒ25å¹´ä¸»è¦å·¥ä½œæ˜¯æ–°Appçš„å¼€å‘å’ŒæŠ½ç¦»ï¼ŒæœŸé—´å¯¹Asmå’ŒPluginæ–¹é¢å·¥ä½œè¾ƒå¤šï¼Œç†æ‰€å½“ç„¶çš„éœ€è¦å’ŒGradleæ‰“äº¤é“ï¼Œç”±äºé¡¹ç›®ä¸­ä½¿ç”¨çš„Gradleç‰ˆæœ¬è¾ƒä½ï¼Œä¸”ä¸ºGroovyç‰ˆæœ¬ï¼Œæ‰€ä»¥å¯¹Groovy7.0å’ŒKtsç‰ˆæœ¬æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œä¹‹å‰çœ‹è¿‡ä½†æ˜¯æ²¡æœ‰å®è·µè¿‡ï¼Œæ‰€ä»¥å°±æœ‰äº†æœ¬ç¯‡è®°å½•æ–‡ç« ï¼Œç®—æ˜¯å¯¹25å¹´ä¸ŠåŠå¹´éƒ¨åˆ†å­¦ä¹ çŸ¥è¯†çš„æ€»ç»“ã€‚ psï¼šAIå½“é“ï¼Œè™½ç„¶å¾ˆå¤šé—®é¢˜å’Œç–‘æƒ‘ç›´æ¥è®©Cursoræ¥å®ç°å°±å¥½äº†ï¼Œä½†æ˜¯è¯¥æœ‰çš„çŸ¥è¯†åº“ç§¯ç´¯è¿˜æ˜¯è¦åšçš„ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€‚</p>
<h2 data-id="heading-1">Gradleç®€è¦ä»‹ç»</h2>
<p>æ³¨é‡Šï¼šä¸‹è¾¹ä»¥Gradle kts ä¸ºä¾‹
ç®€å•å±•ç¤ºä¸‹ä¸€èˆ¬å·¥ç¨‹çš„é¡¹ç›®ç»“æ„å›¾</p>
<pre><code class="hljs language-bash" lang="bash">MyAndroidApp/
â”œâ”€â”€ gradle/
â”‚   â”œâ”€â”€ wrapper/
â”‚   â”‚   â”œâ”€â”€ gradle-wrapper.jar          <span class="hljs-comment"># ä¸»è¦æ˜¯Gradleçš„è¿è¡Œé€»è¾‘ï¼ŒåŒ…å«ä¸‹è½½Gradle</span>
â”‚   â”‚   â””â”€â”€ gradle-wrapper.properties   <span class="hljs-comment"># Wrapper é…ç½®ï¼Œå®šä¹‰äº†Gradleç‰ˆæœ¬</span>
â”‚   â””â”€â”€ libs.versions.toml              <span class="hljs-comment"># ç‰ˆæœ¬ç›®å½•ï¼ˆGradle 7.0+ï¼‰</span>
â”‚
â”œâ”€â”€ app/                                <span class="hljs-comment"># åº”ç”¨æ¨¡å—</span>
â”‚   â”œâ”€â”€ build.gradle.kts                <span class="hljs-comment"># æ¨¡å—æ„å»ºè„šæœ¬</span>
â”‚   â”œâ”€â”€ proguard-rules.pro              <span class="hljs-comment"># ProGuard è§„åˆ™</span>
â”‚   â””â”€â”€ src/                            <span class="hljs-comment"># æºä»£ç </span>
â”‚
â”œâ”€â”€ ktslibrary/                         <span class="hljs-comment"># åº“æ¨¡å—ï¼ˆå¯é€‰ï¼‰</span>
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/
â”‚
â”œâ”€â”€ buildSrc/                           <span class="hljs-comment"># è‡ªå®šä¹‰æ„å»ºé€»è¾‘ï¼ˆå¯é€‰ï¼‰</span>
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ src/
â”‚
â”œâ”€â”€ build.gradle.kts                    <span class="hljs-comment"># æ ¹é¡¹ç›®æ„å»ºè„šæœ¬</span>
â”œâ”€â”€ settings.gradle.kts                 <span class="hljs-comment"># é¡¹ç›®è®¾ç½®</span>
â”œâ”€â”€ gradle.properties                   <span class="hljs-comment"># Gradle å±æ€§é…ç½®</span>
â”œâ”€â”€ local.properties                    <span class="hljs-comment"># æœ¬åœ°é…ç½®ï¼ˆä¸æäº¤åˆ° Gitï¼‰</span>
â”œâ”€â”€ gradlew                             <span class="hljs-comment"># Gradle Wrapper è„šæœ¬ï¼ˆUnixï¼‰</span>
â””â”€â”€ gradlew.bat                         <span class="hljs-comment"># Gradle Wrapper è„šæœ¬ï¼ˆWindowsï¼‰</span>
</code></pre>
<h3 data-id="heading-2">gradle-wrapper.properties</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">#Tue Nov <span class="hljs-number">11</span> <span class="hljs-number">20</span>:<span class="hljs-number">22</span>:<span class="hljs-number">16</span> CST <span class="hljs-number">2025</span>
<span class="hljs-comment">//ä¸‹è½½çš„Gradleçš„å‹ç¼©åŒ…è§£å‹åçš„ä¸»ç›®å½•</span>
distributionBase=GRADLE_USER_HOME   
<span class="hljs-comment">// ç›¸å¯¹äºdistributionBaseçš„è§£å‹åçš„Gradleçš„è·¯å¾„ï¼Œä¸ºwrapper/dists</span>
distributionPath=wrapper/dists
<span class="hljs-comment">// Gradleç‰ˆæœ¬çš„ä¸‹è½½åœ°å€</span>
distributionUrl=https:<span class="hljs-comment">//services.gradle.org/distributions/gradle-8.11.1-bin.zip</span>
<span class="hljs-comment">// åŒdistributionBaseï¼Œä¸è¿‡æ˜¯å­˜æ”¾zipå‹ç¼©åŒ…çš„ä¸»ç›®å½•</span>
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
</code></pre>
<p>å’Œgroovyç‰ˆæœ¬å˜åŒ–ä¸å¤§,ä¸»è¦è§£é‡Šéƒ½åœ¨å¤‡æ³¨é‡Œäº†</p>
<h3 data-id="heading-3">settings.gradle.kts</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. æ’ä»¶ç®¡ç†é…ç½®</span>
pluginManagement {
    <span class="hljs-comment">// é…ç½®æ’ä»¶ä»“åº“</span>
    repositories {
        <span class="hljs-comment">// Google çš„ Maven ä»“åº“ï¼ˆAndroid æ’ä»¶ï¼‰</span>
        google {
            <span class="hljs-comment">// å†…å®¹è¿‡æ»¤ï¼šåªä» Google ä¸‹è½½ç‰¹å®šåŒ…</span>
            content {
                includeGroupByRegex(<span class="hljs-string">"com\\.android.*"</span>)
                includeGroupByRegex(<span class="hljs-string">"com\\.google.*"</span>)
                includeGroupByRegex(<span class="hljs-string">"androidx.*"</span>)
            }
        }
        
        mavenCentral()  <span class="hljs-comment">// Maven ä¸­å¤®ä»“åº“</span>
        gradlePluginPortal()  <span class="hljs-comment">// Gradle æ’ä»¶é—¨æˆ·</span>
    }
    
    <span class="hljs-comment">// æ’ä»¶ç‰ˆæœ¬è§£æç­–ç•¥</span>
    resolutionStrategy {
        eachPlugin {
            <span class="hljs-comment">// è‡ªå®šä¹‰æ’ä»¶ç‰ˆæœ¬è§£æ</span>
            <span class="hljs-keyword">if</span> (requested.id.id == <span class="hljs-string">"com.example.plugin"</span>) {
                useModule(<span class="hljs-string">"com.example:plugin:<span class="hljs-subst">${requested.version}</span>"</span>)
            }
        }
    }
}

<span class="hljs-comment">// 2. ä¾èµ–ç®¡ç†é…ç½® ä¸‰æ–¹åº“å¼•å…¥çš„æºå¤´é…ç½®</span>
dependencyResolutionManagement {
    <span class="hljs-comment">// ä»“åº“æ¨¡å¼</span>
    <span class="hljs-comment">// FAIL_ON_PROJECT_REPOS: ç¦æ­¢åœ¨é¡¹ç›®ä¸­å£°æ˜ä»“åº“ï¼ˆæ¨èï¼‰</span>
    <span class="hljs-comment">// PREFER_PROJECT: ä¼˜å…ˆä½¿ç”¨é¡¹ç›®ä¸­çš„ä»“åº“</span>
    <span class="hljs-comment">// PREFER_SETTINGS: ä¼˜å…ˆä½¿ç”¨ settings ä¸­çš„ä»“åº“</span>
    repositoriesMode.<span class="hljs-keyword">set</span>(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    
    <span class="hljs-comment">// é…ç½®ä¾èµ–ä»“åº“</span>
    repositories {
        google()
        mavenCentral()
        mavenLocal()  <span class="hljs-comment">// æœ¬åœ° Maven ä»“åº“</span>
        maven { url = uri(<span class="hljs-string">"https://jitpack.io"</span>) }   <span class="hljs-comment">// JitPackï¼ˆGitHub é¡¹ç›®ï¼‰</span>
        <span class="hljs-comment">// é˜¿é‡Œäº‘é•œåƒï¼ˆå›½å†…åŠ é€Ÿï¼‰</span>
        maven { url = uri(<span class="hljs-string">"https://maven.aliyun.com/repository/public"</span>) }
        maven { url = uri(<span class="hljs-string">"https://maven.aliyun.com/repository/google"</span>) }
    }
    
    <span class="hljs-comment">// ç‰ˆæœ¬ç›®å½•</span>
    versionCatalogs {
        <span class="hljs-comment">// è‡ªå®šä¹‰ç‰ˆæœ¬ç›®å½•</span>
        create(<span class="hljs-string">"testLibs"</span>) {
            from(files(<span class="hljs-string">"gradle/test-libs.versions.toml"</span>))
        }
    }
}

<span class="hljs-comment">// 3. æ„å»ºç¼“å­˜é…ç½®</span>
buildCache {
    local {
        isEnabled = <span class="hljs-literal">true</span>
        directory = File(rootDir, <span class="hljs-string">"build-cache"</span>)
        removeUnusedEntriesAfterDays = <span class="hljs-number">30</span>
    }
    
    remote&lt;HttpBuildCache&gt; {
        url = uri(<span class="hljs-string">"https://build-cache.example.com/cache/"</span>)
        isEnabled = <span class="hljs-literal">false</span>
        isPush = <span class="hljs-literal">false</span>
    }
}

<span class="hljs-comment">// 4. æ’ä»¶ç®¡ç†ï¼ˆé«˜çº§ï¼‰</span>
plugins {
    <span class="hljs-comment">// åœ¨ settings ä¸­åº”ç”¨æ’ä»¶ï¼ˆGradle 8.0+ï¼‰</span>
    id(<span class="hljs-string">"com.gradle.enterprise"</span>) version <span class="hljs-string">"3.15"</span>
}

<span class="hljs-comment">// 5. é¡¹ç›®é…ç½®</span>

<span class="hljs-comment">// è®¾ç½®æ ¹é¡¹ç›®åç§°</span>
rootProject.name = <span class="hljs-string">"GradleY"</span>

<span class="hljs-comment">// åŒ…å«æ¨¡å—</span>
include <span class="hljs-string">':GroovyLibrary'</span>
include <span class="hljs-string">':KtsLibrary'</span>

<span class="hljs-comment">// 6. Gradle Enterprise / Build Scan</span>
gradleEnterprise {
    buildScan {
        termsOfServiceUrl = <span class="hljs-string">"https://gradle.com/terms-of-service"</span>
        termsOfServiceAgree = <span class="hljs-string">"yes"</span>
        publishAlways()
        <span class="hljs-comment">// è‡ªå®šä¹‰æ ‡ç­¾</span>
        tag(<span class="hljs-string">"CI"</span>)
        value(<span class="hljs-string">"Git Commit"</span>, getGitCommit())
    }
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getGitCommit</span><span class="hljs-params">()</span></span>: String {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">val</span> process = Runtime.getRuntime().exec(<span class="hljs-string">"git rev-parse --short HEAD"</span>)
        process.inputStream.bufferedReader().readText().trim()
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        <span class="hljs-string">"unknown"</span>
    }
}
</code></pre>
<p>â€ƒâ€ƒè¯¥æ–‡ä»¶ç”¨æ¥é…ç½®æ’ä»¶ç®¡ç†ï¼Œä¾èµ–åº“ç®¡ç†å’Œé¡¹ç›®ç›¸å…³é…ç½®ï¼Œå…·ä½“ä½œç”¨è§ä»£ç æ³¨é‡Šä¸­æ ‡æ³¨</p>
<h3 data-id="heading-4">æ ¹é¡¹ç›®build.gradle.kts</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// build.gradle.kts (root)</span>

<span class="hljs-comment">// 1. æ’ä»¶å£°æ˜</span>
plugins {
    <span class="hljs-comment">// ä½¿ç”¨ç‰ˆæœ¬ç›®å½•ï¼ˆæ¨èï¼‰</span>
    alias(libs.plugins.android.application) apply <span class="hljs-literal">false</span>
    alias(libs.plugins.android.library) apply <span class="hljs-literal">false</span>
    alias(libs.plugins.kotlin.android) apply <span class="hljs-literal">false</span>
    alias(libs.plugins.kotlin.jvm) apply <span class="hljs-literal">false</span>
    
    <span class="hljs-comment">// æˆ–ç›´æ¥å£°æ˜ç‰ˆæœ¬</span>
    id(<span class="hljs-string">"com.android.application"</span>) version <span class="hljs-string">"8.1.0"</span> apply <span class="hljs-literal">false</span>
    id(<span class="hljs-string">"org.jetbrains.kotlin.android"</span>) version <span class="hljs-string">"1.9.0"</span> apply <span class="hljs-literal">false</span>
    
    <span class="hljs-comment">// apply false çš„å«ä¹‰ï¼š</span>
    <span class="hljs-comment">// å£°æ˜ç‰ˆæœ¬ä½†ä¸åº”ç”¨åˆ°æ ¹é¡¹ç›®ï¼Œç”±å­é¡¹ç›®è‡ªå·±å†³å®šæ˜¯å¦åº”ç”¨</span>
}

<span class="hljs-comment">// ä¸ºæ‰€æœ‰é¡¹ç›®é…ç½®</span>
allprojects {
    <span class="hljs-comment">// è®¾ç½®é¡¹ç›®å±æ€§</span>
    group = <span class="hljs-string">"com.example"</span>
    version = <span class="hljs-string">"1.0.0"</span>
    
    <span class="hljs-comment">// é…ç½®ä»»åŠ¡</span>
    tasks.withType&lt;JavaCompile&gt;().configureEach {
        options.encoding = <span class="hljs-string">"UTF-8"</span>
    }
}

<span class="hljs-comment">// ä¸ºæ‰€æœ‰å­é¡¹ç›®é…ç½®</span>
subprojects {
    <span class="hljs-comment">// åº”ç”¨é€šç”¨æ’ä»¶</span>
    apply(plugin = <span class="hljs-string">"checkstyle"</span>)
    
    <span class="hljs-comment">// é…ç½®é€šç”¨ä¾èµ–</span>
    dependencies {
        <span class="hljs-comment">// æ‰€æœ‰å­é¡¹ç›®éƒ½æ·»åŠ è¿™ä¸ªä¾èµ–</span>
        <span class="hljs-string">"implementation"</span>(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib"</span>)
    }
   
}
</code></pre>
<p>â€ƒâ€ƒ <strong>alias(libs.plugins.android.application) apply false</strong> ï¼Œkotlin æŒºå¥½çš„ä¸€ç‚¹å°±æ˜¯å¯è¿›è¡Œå®šä¹‰è·³è½¬ï¼Œaliasåè¾¹è¿™é‡Œçš„ å®šä¹‰åœ¨ <strong>libs.versions.toml</strong>æ–‡ä»¶ä¸­ï¼Œapply falseè¡¨ç¤ºä¸åº”ç”¨åˆ°è·Ÿé¡¹ç›®ï¼Œå­é¡¹ç›®å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>â€ƒâ€ƒè¿™é‡Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯<strong>allprojects</strong> æ˜¯åŒ…å«æ•´ä¸ªé¡¹ç›®çš„é…ç½®ï¼Œ <strong>subprojects</strong> ä¸åŒ…å«è·Ÿé¡¹ç›®ï¼ŒåªåŒ…å«å­é¡¹ç›®ã€‚</p>
<h3 data-id="heading-5">app build.gradle.kts</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-comment">// 1. æ’ä»¶é…ç½®</span>
plugins {
    <span class="hljs-comment">// åº”ç”¨æ’ä»¶</span>
    alias(libs.plugins.android.application)
    alias(libs.plugins.kotlin.android)
    alias(libs.plugins.kotlin.kapt)  <span class="hljs-comment">// Kotlin æ³¨è§£å¤„ç†</span>
    
    <span class="hljs-comment">// æˆ–ç›´æ¥å£°æ˜</span>
    id(<span class="hljs-string">"com.android.application"</span>)
    id(<span class="hljs-string">"org.jetbrains.kotlin.android"</span>)
    kotlin(<span class="hljs-string">"kapt"</span>)  <span class="hljs-comment">// ç­‰åŒäº id("org.jetbrains.kotlin.kapt")</span>
}

<span class="hljs-comment">// 2. Android åŸºæœ¬é…ç½®</span>
android {
    <span class="hljs-comment">// å‘½åç©ºé—´ï¼ˆAGP 7.0+ï¼Œæ›¿ä»£ manifest ä¸­çš„ packageï¼‰</span>
    namespace = <span class="hljs-string">"com.example.app"</span>
    <span class="hljs-comment">// ç¼–è¯‘ SDK ç‰ˆæœ¬</span>
    compileSdk = <span class="hljs-number">33</span>
    <span class="hljs-comment">// æ„å»ºå·¥å…·ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨ AGP æ¨èç‰ˆæœ¬ï¼‰</span>
    buildToolsVersion = <span class="hljs-string">"33.0.1"</span>
    
    <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
    defaultConfig {
        applicationId = <span class="hljs-string">"com.example.app"</span>  <span class="hljs-comment">// åº”ç”¨ ID</span>
        minSdk = <span class="hljs-number">24</span>
        targetSdk = <span class="hljs-number">33</span>
        versionCode = <span class="hljs-number">1</span>    <span class="hljs-comment">// ç‰ˆæœ¬å·</span>
        versionName = <span class="hljs-string">"1.0.0"</span>
        
        <span class="hljs-comment">// æµ‹è¯•è¿è¡Œå™¨</span>
        testInstrumentationRunner = <span class="hljs-string">"androidx.test.runner.AndroidJUnitRunner"</span>
        
        <span class="hljs-comment">// BuildConfig å­—æ®µ</span>
        buildConfigField(<span class="hljs-string">"String"</span>, <span class="hljs-string">"API_BASE_URL"</span>, <span class="hljs-string">"\"https://api.example.com\""</span>)
        buildConfigField(<span class="hljs-string">"boolean"</span>, <span class="hljs-string">"ENABLE_LOGGING"</span>, <span class="hljs-string">"true"</span>)
        buildConfigField(<span class="hljs-string">"int"</span>, <span class="hljs-string">"MAX_RETRY_COUNT"</span>, <span class="hljs-string">"3"</span>)
        
        <span class="hljs-comment">// Vector Drawable æ”¯æŒ</span>
        vectorDrawables {
            useSupportLibrary = <span class="hljs-literal">true</span>
        }
        
        ndk {
            <span class="hljs-comment">// NDK é…ç½® æ”¯æŒçš„ ABI</span>
            abiFilters += setOf(<span class="hljs-string">"armeabi-v7a"</span>, <span class="hljs-string">"arm64-v8a"</span>)
        }
        
        multiDexEnabled = <span class="hljs-literal">true</span>  <span class="hljs-comment">// å¤š Dex æ”¯æŒ</span>
        consumerProguardFiles(<span class="hljs-string">"consumer-rules.pro"</span>)   <span class="hljs-comment">// ProGuard æ¶ˆè´¹è€…è§„åˆ™</span>
    }
    
    <span class="hljs-comment">// ç­¾åé…ç½®</span>
    signingConfigs {
        getByName(<span class="hljs-string">"debug"</span>) {        <span class="hljs-comment">// Debug ç­¾å</span>
            storeFile = file(<span class="hljs-string">"debug.keystore"</span>)
            storePassword = <span class="hljs-string">"android"</span>
            keyAlias = <span class="hljs-string">"androiddebugkey"</span>
            keyPassword = <span class="hljs-string">"android"</span>
        }

        create(<span class="hljs-string">"release"</span>) {        <span class="hljs-comment">// Release ç­¾å</span>
            <span class="hljs-comment">// ä» local.properties è¯»å–</span>
            <span class="hljs-keyword">val</span> keystoreProperties = File(rootDir, <span class="hljs-string">"keystore.properties"</span>)
            <span class="hljs-keyword">if</span> (keystoreProperties.exists()) {
                <span class="hljs-keyword">val</span> properties = java.util.Properties()
                properties.load(keystoreProperties.inputStream())
                
                storeFile = file(properties[<span class="hljs-string">"storeFile"</span>] <span class="hljs-keyword">as</span> String)
                storePassword = properties[<span class="hljs-string">"storePassword"</span>] <span class="hljs-keyword">as</span> String
                keyAlias = properties[<span class="hljs-string">"keyAlias"</span>] <span class="hljs-keyword">as</span> String
                keyPassword = properties[<span class="hljs-string">"keyPassword"</span>] <span class="hljs-keyword">as</span> String
            }
        }
    }
    
    <span class="hljs-comment">// æ„å»ºç±»å‹</span>
    buildTypes {
        <span class="hljs-comment">// Debug ç±»å‹</span>
        debug {
            applicationIdSuffix = <span class="hljs-string">".debug"</span>
            versionNameSuffix = <span class="hljs-string">"-debug"</span>
            
            isDebuggable = <span class="hljs-literal">true</span>
            isMinifyEnabled = <span class="hljs-literal">false</span>
            isShrinkResources = <span class="hljs-literal">false</span>
            
            buildConfigField(<span class="hljs-string">"String"</span>, <span class="hljs-string">"API_BASE_URL"</span>, <span class="hljs-string">"\"https://dev-api.example.com\""</span>)
            resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"app_name"</span>, <span class="hljs-string">"MyApp Debug"</span>)
            
            signingConfig = signingConfigs.getByName(<span class="hljs-string">"debug"</span>)
        }
        
        <span class="hljs-comment">// Release ç±»å‹</span>
        release {
            isDebuggable = <span class="hljs-literal">false</span>
            isMinifyEnabled = <span class="hljs-literal">true</span>
            isShrinkResources = <span class="hljs-literal">true</span>
            
            proguardFiles(
                getDefaultProguardFile(<span class="hljs-string">"proguard-android-optimize.txt"</span>),
                <span class="hljs-string">"proguard-rules.pro"</span>
            )
            
            signingConfig = signingConfigs.getByName(<span class="hljs-string">"release"</span>)
            
            buildConfigField(<span class="hljs-string">"String"</span>, <span class="hljs-string">"API_BASE_URL"</span>, <span class="hljs-string">"\"https://api.example.com\""</span>)
            resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"app_name"</span>, <span class="hljs-string">"MyApp"</span>)
        }
    }
    
    <span class="hljs-comment">// ç¼–è¯‘é€‰é¡¹</span>
    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
        
        <span class="hljs-comment">// å¯ç”¨ desugaring</span>
        isCoreLibraryDesugaringEnabled = <span class="hljs-literal">true</span>
    }
    
    kotlinOptions {
        jvmTarget = <span class="hljs-string">"11"</span>
        
        <span class="hljs-comment">// Kotlin ç¼–è¯‘å™¨å‚æ•°</span>
        freeCompilerArgs = listOf(
            <span class="hljs-string">"-opt-in=kotlin.RequiresOptIn"</span>,
            <span class="hljs-string">"-Xjvm-default=all"</span>,
            <span class="hljs-string">"-Xcontext-receivers"</span>
        )
    }
    
    <span class="hljs-comment">// æ„å»ºç‰¹æ€§</span>
    buildFeatures {
        viewBinding = <span class="hljs-literal">true</span>         <span class="hljs-comment">// ViewBinding</span>
        dataBinding = <span class="hljs-literal">false</span>        <span class="hljs-comment">// DataBinding</span>
        compose = <span class="hljs-literal">false</span>           <span class="hljs-comment">// Compose</span>
        buildConfig = <span class="hljs-literal">true</span>        <span class="hljs-comment">// BuildConfig</span>
        aidl = <span class="hljs-literal">false</span>             <span class="hljs-comment">// AIDL</span>
        renderScript = <span class="hljs-literal">false</span>      <span class="hljs-comment">// RenderScript</span>
        shaders = <span class="hljs-literal">false</span>          <span class="hljs-comment">// Shaders</span>
    }
    
    <span class="hljs-comment">// Compose é…ç½®ï¼ˆå¦‚æœå¯ç”¨ï¼‰</span>
    composeOptions {
        kotlinCompilerExtensionVersion = <span class="hljs-string">"1.5.3"</span>
    }
}

<span class="hljs-comment">// 3. ä¾èµ–é…ç½®</span>
dependencies {
    <span class="hljs-comment">// Core</span>
    implementation(libs.androidx.core.ktx)
    implementation(libs.androidx.appcompat)
    implementation(libs.material)
    
    <span class="hljs-comment">// Kotlin</span>
    implementation(libs.kotlin.stdlib)
    implementation(libs.kotlinx.coroutines.core)
    implementation(libs.kotlinx.coroutines.android)
    
    <span class="hljs-comment">// Android Components</span>
    implementation(libs.androidx.activity.ktx)
    implementation(libs.androidx.fragment.ktx)
    implementation(libs.androidx.lifecycle.runtime.ktx)
    implementation(libs.androidx.lifecycle.viewmodel.ktx)
    
    ...
}
</code></pre>
<p>â€ƒâ€ƒä¸»è¦å£°æ˜App bundleä¸­ä½¿ç”¨åˆ°çš„ä¾èµ–ï¼Œæ„å»ºä¿¡æ¯è®¾ç½®å’Œåº”ç”¨æ’ä»¶ç­‰ä¿¡æ¯</p>
<h3 data-id="heading-6">library build.gradle.kts</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">plugins {
    alias(libs.plugins.android.library)  <span class="hljs-comment">// æ³¨æ„æ˜¯ library ä¸æ˜¯ application</span>
    alias(libs.plugins.kotlin.android)
}

android {
    namespace = <span class="hljs-string">"com.example.library"</span>
    compileSdk = <span class="hljs-number">33</span>
    
    defaultConfig {
        minSdk = <span class="hljs-number">24</span>
        <span class="hljs-comment">// library æ²¡æœ‰ applicationId å’Œ versionCode/versionName</span>
        testInstrumentationRunner = <span class="hljs-string">"androidx.test.runner.AndroidJUnitRunner"</span>
        
        <span class="hljs-comment">// æ¶ˆè´¹è€… ProGuard è§„åˆ™</span>
        consumerProguardFiles(<span class="hljs-string">"consumer-rules.pro"</span>)
    }
    
    buildTypes {
        release {
            isMinifyEnabled = <span class="hljs-literal">false</span>
            proguardFiles(
                getDefaultProguardFile(<span class="hljs-string">"proguard-android-optimize.txt"</span>),
                <span class="hljs-string">"proguard-rules.pro"</span>
            )
        }
    }
    
    <span class="hljs-comment">// library å¯ä»¥å‘å¸ƒä¸åŒçš„å˜ä½“</span>
    publishNonDefault = <span class="hljs-literal">true</span>
}

dependencies {
    <span class="hljs-comment">// api: é€ä¼ ä¾èµ– ç»™ä½¿ç”¨æ­¤åº“çš„æ¨¡å—</span>
    api(libs.kotlin.stdlib)
    
    <span class="hljs-comment">// implementation: ä¸é€ä¼  ä»…å½“å‰æ¨¡å—ä¾èµ–</span>
    implementation(libs.androidx.core.ktx)
    testImplementation(libs.junit)
}
</code></pre>
<h3 data-id="heading-7">gradle libs.versions.toml</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[versions]</span>
<span class="hljs-attr">agp</span> = <span class="hljs-string">"8.10.0"</span>
<span class="hljs-attr">kotlin</span> = <span class="hljs-string">"2.0.21"</span>
<span class="hljs-attr">coreKtx</span> = <span class="hljs-string">"1.17.0"</span>
<span class="hljs-attr">junit</span> = <span class="hljs-string">"4.14-SNAPSHOT"</span>
<span class="hljs-attr">junitVersion</span> = <span class="hljs-string">"1.3.0"</span>
<span class="hljs-attr">espressoCore</span> = <span class="hljs-string">"3.7.0"</span>
<span class="hljs-attr">lifecycleRuntimeKtx</span> = <span class="hljs-string">"2.9.4"</span>
<span class="hljs-attr">activityCompose</span> = <span class="hljs-string">"1.11.0"</span>
<span class="hljs-attr">composeBom</span> = <span class="hljs-string">"2024.09.00"</span>
<span class="hljs-attr">appcompat</span> = <span class="hljs-string">"1.7.1"</span>
<span class="hljs-attr">material</span> = <span class="hljs-string">"1.13.0"</span>

<span class="hljs-section">[libraries]</span>
<span class="hljs-attr">androidx-core-ktx</span> = { group = <span class="hljs-string">"androidx.core"</span>, name = <span class="hljs-string">"core-ktx"</span>, version.ref = <span class="hljs-string">"coreKtx"</span> }
<span class="hljs-attr">junit</span> = { group = <span class="hljs-string">"junit"</span>, name = <span class="hljs-string">"junit"</span>, version.ref = <span class="hljs-string">"junit"</span> }
<span class="hljs-attr">androidx-junit</span> = { group = <span class="hljs-string">"androidx.test.ext"</span>, name = <span class="hljs-string">"junit"</span>, version.ref = <span class="hljs-string">"junitVersion"</span> }
<span class="hljs-attr">androidx-espresso-core</span> = { group = <span class="hljs-string">"androidx.test.espresso"</span>, name = <span class="hljs-string">"espresso-core"</span>, version.ref = <span class="hljs-string">"espressoCore"</span> }
<span class="hljs-attr">androidx-lifecycle-runtime-ktx</span> = { group = <span class="hljs-string">"androidx.lifecycle"</span>, name = <span class="hljs-string">"lifecycle-runtime-ktx"</span>, version.ref = <span class="hljs-string">"lifecycleRuntimeKtx"</span> }
<span class="hljs-attr">androidx-activity-compose</span> = { group = <span class="hljs-string">"androidx.activity"</span>, name = <span class="hljs-string">"activity-compose"</span>, version.ref = <span class="hljs-string">"activityCompose"</span> }
<span class="hljs-attr">androidx-compose-bom</span> = { group = <span class="hljs-string">"androidx.compose"</span>, name = <span class="hljs-string">"compose-bom"</span>, version.ref = <span class="hljs-string">"composeBom"</span> }
<span class="hljs-attr">androidx-ui</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui"</span> }
<span class="hljs-attr">androidx-ui-graphics</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui-graphics"</span> }
<span class="hljs-attr">androidx-ui-tooling</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui-tooling"</span> }
<span class="hljs-attr">androidx-ui-tooling-preview</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui-tooling-preview"</span> }
<span class="hljs-attr">androidx-ui-test-manifest</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui-test-manifest"</span> }
<span class="hljs-attr">androidx-ui-test-junit4</span> = { group = <span class="hljs-string">"androidx.compose.ui"</span>, name = <span class="hljs-string">"ui-test-junit4"</span> }
<span class="hljs-attr">androidx-material3</span> = { group = <span class="hljs-string">"androidx.compose.material3"</span>, name = <span class="hljs-string">"material3"</span> }
<span class="hljs-attr">androidx-appcompat</span> = { group = <span class="hljs-string">"androidx.appcompat"</span>, name = <span class="hljs-string">"appcompat"</span>, version.ref = <span class="hljs-string">"appcompat"</span> }
<span class="hljs-attr">material</span> = { group = <span class="hljs-string">"com.google.android.material"</span>, name = <span class="hljs-string">"material"</span>, version.ref = <span class="hljs-string">"material"</span> }

<span class="hljs-section">[plugins]</span>
<span class="hljs-attr">android-application</span> = { id = <span class="hljs-string">"com.android.application"</span>, version.ref = <span class="hljs-string">"agp"</span> }
<span class="hljs-attr">kotlin-android</span> = { id = <span class="hljs-string">"org.jetbrains.kotlin.android"</span>, version.ref = <span class="hljs-string">"kotlin"</span> }
<span class="hljs-attr">kotlin-compose</span> = { id = <span class="hljs-string">"org.jetbrains.kotlin.plugin.compose"</span>, version.ref = <span class="hljs-string">"kotlin"</span> }
<span class="hljs-attr">android-library</span> = { id = <span class="hljs-string">"com.android.library"</span>, version.ref = <span class="hljs-string">"agp"</span> }
</code></pre>
<p>â€ƒâ€ƒä¼ ç»Ÿçš„ä¾èµ–æ–¹å¼ä½¿ç”¨ å­—ç¬¦ä¸²ï¼Œå®¹æ˜“æ‹¼å†™é”™è¯¯ã€‚ktsçš„æ–°ç‰ˆæœ¬ä¾èµ–æ–¹å¼IDE è‡ªåŠ¨è¡¥å…¨ï¼ŒCmd+ç‚¹å‡»å¯è·³è½¬ï¼Œå¹¶ä¸”ç‰ˆæœ¬ç®¡ç†æ›´åŠ é›†ä¸­</p>
<h3 data-id="heading-8">gradle.properties</h3>
<pre><code class="hljs language-properties" lang="properties"># -Xmx: jvmæœ€å¤§å †å†…å­˜ï¼ˆæ ¹æ®æœºå™¨é…ç½®è°ƒæ•´ï¼Œ8GB æœºå™¨å»ºè®® 4096mï¼Œ16GB å»ºè®® 8192mï¼‰
# -XX:MaxMetaspaceSize: å…ƒç©ºé—´æœ€å¤§å¤§å°
# -XX:+HeapDumpOnOutOfMemoryError: OOM æ—¶ç”Ÿæˆå †è½¬å‚¨
# -Dfile.encoding: æ–‡ä»¶ç¼–ç 
org.gradle.jvmargs=-Xmx4096m -XX:MaxMetaspaceSize=1024m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8

# å¹¶è¡Œç¼–è¯‘ï¼ˆåˆ©ç”¨å¤šæ ¸ CPUï¼‰
org.gradle.parallel=true
# é…ç½®ç¼“å­˜ï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼Œæ˜¾è‘—æå‡é€Ÿåº¦ï¼‰ Gradle 8.0+ ç¨³å®šï¼Œå¼ºçƒˆæ¨èå¼€å¯
org.gradle.configuration-cache=true
# æ„å»ºç¼“å­˜ï¼ˆå¤ç”¨ä¹‹å‰çš„æ„å»ºç»“æœï¼‰
org.gradle.caching=true
# æŒ‰éœ€é…ç½®  å¤§å‹å¤šæ¨¡å—é¡¹ç›®å»ºè®®å¼€å¯
org.gradle.configureondemand=true
# åå°å®ˆæŠ¤è¿›ç¨‹ï¼Œé¿å…æ¯æ¬¡æ„å»ºéƒ½å¯åŠ¨ JVM
org.gradle.daemon=true
# æ–‡ä»¶ç›‘å¬ï¼ˆå¢é‡æ„å»ºçš„åŸºç¡€ï¼‰
org.gradle.vfs.watch=true
# Kotlin Daemon JVM å‚æ•°
kotlin.daemon.jvmargs=-Xmx2048m
# å¢é‡ç¼–è¯‘
kotlin.incremental=true
# Kotlin ç¼–è¯‘ç¼“å­˜
kotlin.caching.enabled=true
# Kotlin ç¼–è¯‘å™¨æ‰§è¡Œç­–ç•¥
# in-process: åœ¨ Gradle Daemon è¿›ç¨‹ä¸­ç¼–è¯‘ï¼ˆæ¨èï¼‰
# daemon: ä½¿ç”¨å•ç‹¬çš„ Kotlin Daemonï¼ˆé»˜è®¤ï¼‰
# out-of-process: æ¯æ¬¡æ–°å»ºè¿›ç¨‹
kotlin.compiler.execution.strategy=in-process

# å¹¶è¡Œç¼–è¯‘ Kotlin æ¨¡å—
kotlin.parallel.tasks.in.project=true
# ä½¿ç”¨ AndroidX
android.useAndroidX=true
# kotlinä»£ç æ ·å¼
kotlin.code.style=official
# è‡ªåŠ¨è¿ç§»ç¬¬ä¸‰æ–¹åº“åˆ° AndroidXï¼ˆé€šå¸¸å…³é—­ï¼‰
android.enableJetifier=false
# ä½¿æ¯ä¸ªåº“çš„ R ç±»èƒ½å¤Ÿå‘½åç©ºé—´ï¼Œè®©R ç±»åªåŒ…å«åº“æœ¬èº«å£°æ˜çš„èµ„æºï¼Œä¸åŒ…å«åº“ä¾èµ–èµ„æºï¼Œç¼©å°è¯¥åº“ R ç±»çš„å¤§å°
android.nonTransitiveRClass=true
# ä½¿ç”¨æ–°çš„èµ„æºå¤„ç†å™¨ï¼ˆAAPT2ï¼‰
android.enableResourceOptimizations=true
# ç¦ç”¨ PNG ä¼˜åŒ–ï¼ˆDebug æ—¶å¯ç¦ç”¨ï¼‰
# android.enablePngCrunchInDebugVariant=false
# å¯ç”¨ D8 desugaring
android.enableD8.desugaring=true
# å¯ç”¨ R8
android.enableR8=true
# æ„å»ºç¼“å­˜
android.enableBuildCache=true

# ç‰ˆæœ¬å·ï¼ˆå¯è¢«è„šæœ¬è¯»å–ï¼‰
VERSION_NAME=1.0.0
VERSION_CODE=1

# ç­¾åé…ç½®ï¼ˆä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œä¸æäº¤åˆ°ä»£ç ä»“åº“ï¼‰
# KEYSTORE_FILE=/path/to/keystore
# KEYSTORE_PASSWORD=password
# KEY_ALIAS=alias
# KEY_PASSWORD=password

# API é…ç½®
# API_BASE_URL=https://api.example.com

# Maven ä»“åº“ç”¨æˆ·åå¯†ç ï¼ˆä¸è¦æäº¤åˆ°ä»“åº“ï¼‰
# MAVEN_USERNAME=username
# MAVEN_PASSWORD=password
</code></pre>
<h3 data-id="heading-9">local.properties</h3>
<pre><code class="hljs language-properties" lang="properties"># Android SDK è·¯å¾„ï¼ˆAndroid Studio è‡ªåŠ¨ç”Ÿæˆï¼‰
sdk.dir=/Users/username/Library/Android/sdk
# NDK è·¯å¾„
ndk.dir=/Users/username/Library/Android/sdk/ndk/25.1.8937393

# ç­¾åé…ç½®ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
KEYSTORE_FILE=../release.keystore
KEYSTORE_PASSWORD=mypassword
KEY_ALIAS=mykey
KEY_PASSWORD=mypassword

# API Keysï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
GOOGLE_MAPS_API_KEY=xxx
</code></pre>
<p>â€ƒâ€ƒ è®¾ç½®sdkå’Œndkæœ¬åœ°åœ°å€ï¼Œé…ç½®æ‰“åŒ…ç­¾åé…ç½®ç­‰ä¿¡æ¯</p>
<h2 data-id="heading-10">Gradleçš„Groovy &amp; KotlinåŒºåˆ«</h2>
<h3 data-id="heading-11">Gradle DSL çš„ç‰¹ç‚¹</h3>
<p>å¯è¯»æ€§æ›´é«˜ï¼Œæ›´åŠ ç®€æ´ ï¼ˆæ¨¡ç‰ˆä»£ç å°‘ä¸€äº›ï¼‰</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// Groovy å’Œ kotlinéƒ½è¦ä½¿ç”¨åˆ°çš„ DSLæ ¼å¼ï¼Œä¸åŒäºjavaç­‰ä»£ç æ–¹å¼</span>
android {
    compileSdk = <span class="hljs-number">33</span>
    
    <span class="hljs-comment">// å¯ä»¥ä½¿ç”¨ Kotlin çš„æ¡ä»¶åˆ¤æ–­</span>
    if (project.hasProperty("useNewApi")) {
        defaultConfig {
            minSdk = <span class="hljs-number">24</span>
        }
    }
    
    <span class="hljs-comment">// å¯ä»¥ä½¿ç”¨ Kotlin çš„å¾ªç¯</span>
    <span class="hljs-built_in">listOf</span>("debug", "release")<span class="hljs-selector-class">.forEach</span> { buildType -&gt;
        <span class="hljs-built_in">println</span>("Processing $buildType")
    }
}

<span class="hljs-comment">// å¦‚æœä¸ä½¿ç”¨DSLçš„æ–¹å¼ å¯èƒ½ä¼šå†™æˆè¿™æ · ï¼Œç¨å¾®å¤æ‚äº†ç‚¹</span>
val android = project<span class="hljs-selector-class">.extensions</span><span class="hljs-selector-class">.getByType</span>(AndroidExtension::class.java)
android<span class="hljs-selector-class">.setCompileSdk</span>(<span class="hljs-number">33</span>)

val config = <span class="hljs-built_in">DefaultConfig</span>()
config<span class="hljs-selector-class">.setMinSdk</span>(<span class="hljs-number">24</span>)
android<span class="hljs-selector-class">.setDefaultConfig</span>(config)
</code></pre>
<p>â€ƒâ€ƒ Gradle ä¸»è¦ä½¿ç”¨çš„<strong>å†…éƒ¨DSL</strong> ï¼ˆç®€å•è¯´ä¸‹å¤–éƒ¨DSLï¼šéœ€è¦ä¸“é—¨çš„ä»£ç æ³¨è§£å™¨æ¯”å¦‚ Html å’Œ SQLï¼‰ ï¼Œå¯ä»¥ä½¿ç”¨ Kotlinçš„ä¸€äº›è¯­è¨€ç‰¹æ€§ï¼Œè¿™é‡Œè¿˜æ˜¯è¦æåˆ°ä¸€ä¸‹ Groovyçš„é—­åŒ…ï¼Œ</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// Gradle çš„ android {} å—å®é™…ä¸Šæ˜¯ï¼šè°ƒç”¨ android() æ–¹æ³•, ä¼ å…¥ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°</span>
android {  <span class="hljs-comment">// é—­åŒ…</span>
    compileSdk <span class="hljs-number">33</span>
}
<span class="hljs-built_in">android</span>({ 
    compileSdk <span class="hljs-number">33</span> 
})
<span class="hljs-comment">// å®Œæ•´å½¢æ€</span>
<span class="hljs-built_in">android</span>(new Closure() {
    void <span class="hljs-built_in">call</span>() {
        compileSdk <span class="hljs-number">33</span>
    }
})
å¤§æ¦‚å¾—å®ç°é€»è¾‘
class AndroidExtension {  <span class="hljs-comment">// å®šä¹‰ Android æ‰©å±•ç±»</span>
    int compileSdk
    
    void <span class="hljs-built_in">defaultConfig</span>(Closure closure) {
        def config = new <span class="hljs-built_in">DefaultConfig</span>()
        closure<span class="hljs-selector-class">.delegate</span> = config  <span class="hljs-comment">// è®¾ç½®é—­åŒ…çš„å§”æ‰˜</span>
        <span class="hljs-built_in">closure</span>()                  <span class="hljs-comment">// é—­åŒ…</span>
    }
}

<span class="hljs-comment">// å®šä¹‰é…ç½®æ–¹æ³•ï¼Œæ¥æ”¶é—­åŒ…ä½œä¸ºå‚æ•°</span>
def <span class="hljs-built_in">android</span>(Closure closure) {
    def ext = new <span class="hljs-built_in">AndroidExtension</span>()
    closure<span class="hljs-selector-class">.delegate</span> = ext     <span class="hljs-comment">// è®¾ç½®å§”æ‰˜</span>
    <span class="hljs-built_in">closure</span>()                  <span class="hljs-comment">// é—­åŒ…</span>
    return ext
}

<span class="hljs-comment">// ä½¿ç”¨ï¼ˆçœ‹èµ·æ¥åƒ DSLï¼‰</span>
android {
    compileSdk = <span class="hljs-number">33</span>      <span class="hljs-comment">// å®é™…æ˜¯åœ¨ AndroidExtension ä¸Šä¸‹æ–‡ä¸­</span>
    defaultConfig {
        minSdk = <span class="hljs-number">24</span>      <span class="hljs-comment">// å®é™…æ˜¯åœ¨ DefaultConfig ä¸Šä¸‹æ–‡ä¸­</span>
    }
}
</code></pre>
<p>â€ƒâ€ƒKotlinä¸­ä½¿ç”¨çš„åˆ™æ˜¯ Lambdaæ–¹å¼ï¼ˆå¦‚æœå‚æ•°ä¸ºæœ€åä¸€ä¸ªï¼Œåˆ™å¯ä»¥å»æ‰æ‹¬å·ï¼‰ï¼Œå¹¶ä¸”Kotlinæ˜¯ä½¿ç”¨ = å·æ¥èµ‹å€¼çš„ï¼Œç›¸è¾ƒäº Groovy ï¼ŒKotlinæ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œéƒ¨åˆ†ç±»å‹ä¸å¯¹åœ¨ç¼–è¯‘æœŸå°±ä¼šæç¤ºã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {  <span class="hljs-comment">// Lambda è¡¨è¾¾å¼</span>
    compileSdk = <span class="hljs-number">33</span>
    defaultConfig {  <span class="hljs-comment">// åµŒå¥— Lambda</span>
        minSdk = <span class="hljs-number">24</span>
    }
}

<span class="hljs-comment">// android { } å¤§æ¦‚å®ç°é€»è¾‘ï¼Œå¯ä»¥ç†è§£ä¸º ApplicationExtension.compileSdk = 33</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> org.gradle.api.Project.<span class="hljs-title">android</span><span class="hljs-params">(configure: <span class="hljs-type">org</span>.<span class="hljs-type">gradle</span>.<span class="hljs-type">api</span>.<span class="hljs-type">Action</span>&lt;<span class="hljs-type">com</span>.<span class="hljs-type">android</span>.<span class="hljs-type">build</span>.<span class="hljs-type">gradle</span>.<span class="hljs-type">LibraryExtension</span>&gt;)</span></span>: kotlin.<span class="hljs-built_in">Unit</span> { <span class="hljs-comment">/* compiled code */</span> }

</code></pre>
<p>â€ƒâ€ƒçœ‹Gradleæºç ï¼Œè¿™é‡Œæ˜¯å§”æ‰˜ç»™äº† LibraryExtension ï¼Œæ‰€ä»¥compileSdk å­—æ®µå°±æ˜¯ LibraryExtension ä¸­çš„ä¸€ä¸ªå±æ€§</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/563c63c3c2e44097a5937a73f1aa0b0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piO5bed:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765360651&amp;x-signature=XgyPZTUwXbwqaZE%2BQjY4KSWCLpA%3D" alt="image.png" loading="lazy"/></p>
<p>â€ƒâ€ƒæ‰€ä»¥ æˆ‘ä»¬å¯ä»¥åœ¨Android å¤§æ‹¬å·é‡Œè¾¹ä½¿ç”¨compileSdkç­‰å­—æ®µçš„èµ‹å€¼</p>
<h3 data-id="heading-12">Groovy vs Kotlin è¯­æ³•å¯¹æ¯”</h3>
<ul>
<li>å­—ç¬¦ä¸²</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
def str1 = 'Hello world'      // æ™®é€šå­—ç¬¦ä¸² 
def str3 = "Hello $name"       // å­—ç¬¦ä¸²æ’å€¼  å¯ä»¥å•å¼•å·ï¼Œä¹Ÿå¯ä»¥åŒå¼•å·
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
<span class="hljs-keyword">val</span> str1 = <span class="hljs-string">"only double quote"</span>  <span class="hljs-comment">// åªèƒ½ç”¨åŒå¼•å·</span>
<span class="hljs-keyword">val</span> str2 = <span class="hljs-string">"Hello <span class="hljs-variable">$name</span>"</span>        <span class="hljs-comment">// å­—ç¬¦ä¸²æ’å€¼</span>
</code></pre>
<ul>
<li>å˜é‡</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
def name = "ymc"               // åŠ¨æ€ç±»å‹
String name = "ymc"            // æ˜¾å¼ç±»å‹
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
<span class="hljs-keyword">var</span> name = <span class="hljs-string">"ymc"</span>               <span class="hljs-comment">// å¯å˜</span>
<span class="hljs-keyword">val</span> name = <span class="hljs-string">"ymc"</span>               <span class="hljs-comment">// ä¸å¯å˜ï¼ˆæ¨èï¼‰</span>
</code></pre>
<ul>
<li>æ–¹æ³•è°ƒç”¨</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
println("Hello")
println "Hello"                 // å¯ä»¥çœç•¥æ‹¬å·

add(1, 2)
add 1, 2                        // å¯ä»¥çœç•¥æ‹¬å·å’Œé€—å·

implementation 'androidx.core:core-ktx:1.9.0'
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
println(<span class="hljs-string">"Hello"</span>)                <span class="hljs-comment">// å¿…é¡»æœ‰æ‹¬å·</span>

add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)                       <span class="hljs-comment">// å¿…é¡»æœ‰æ‹¬å·</span>

implementation(<span class="hljs-string">"androidx.core:core-ktx:1.9.0"</span>)  <span class="hljs-comment">// å¿…é¡»æœ‰æ‹¬å·</span>
</code></pre>
<ul>
<li>plugins</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-kapt'
}

// æˆ–
apply plugin: 'com.android.application'
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
plugins {
    id(<span class="hljs-string">"com.android.application"</span>)
    id(<span class="hljs-string">"org.jetbrains.kotlin.android"</span>)
    kotlin(<span class="hljs-string">"kapt"</span>)  <span class="hljs-comment">// ç­‰ä»·äº id("org.jetbrains.kotlin.kapt")</span>
}

<span class="hljs-comment">// æˆ–</span>
apply(plugin = <span class="hljs-string">"com.android.application"</span>)
</code></pre>
<ul>
<li>dependencies å—</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
dependencies {
    implementation 'androidx.core:core-ktx:1.9.0'
    implementation group: 'com.google.code.gson', name: 'gson', version: '2.10.1'
    
    debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.12'
    
    testImplementation 'junit:junit:4.13.2'
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
dependencies {
    implementation(<span class="hljs-string">"androidx.core:core-ktx:1.9.0"</span>)
    implementation(group = <span class="hljs-string">"com.google.code.gson"</span>, name = <span class="hljs-string">"gson"</span>, version = <span class="hljs-string">"2.10.1"</span>)
    
    debugImplementation(<span class="hljs-string">"com.squareup.leakcanary:leakcanary-android:2.12"</span>)
    
    testImplementation(<span class="hljs-string">"junit:junit:4.13.2"</span>)
}
</code></pre>
<ul>
<li>android å—</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
android {
    namespace 'com.example.app'
    compileSdk 33
    
    defaultConfig {
        applicationId "com.example.app"
        minSdk 24
        targetSdk 33
        versionCode 1
        versionName "1.0"
    }
    
    buildTypes {
        debug {
            applicationIdSuffix '.debug'
            debuggable true
        }
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
android {
    namespace = <span class="hljs-string">"com.example.app"</span>
    compileSdk = <span class="hljs-number">33</span>
    
    defaultConfig {
        applicationId = <span class="hljs-string">"com.example.app"</span>
        minSdk = <span class="hljs-number">24</span>
        targetSdk = <span class="hljs-number">33</span>
        versionCode = <span class="hljs-number">1</span>
        versionName = <span class="hljs-string">"1.0"</span>
    }
    
    buildTypes {
        debug {
            applicationIdSuffix = <span class="hljs-string">".debug"</span>
            isDebuggable = <span class="hljs-literal">true</span>
        }
        release {
            isMinifyEnabled = <span class="hljs-literal">true</span>
            proguardFiles(
                getDefaultProguardFile(<span class="hljs-string">"proguard-android-optimize.txt"</span>),
                <span class="hljs-string">"proguard-rules.pro"</span>
            )
        }
    }
}
</code></pre>
<p>â€ƒâ€ƒå‰è¾¹ä¸¤æ®µä»£ç ï¼Œæ¯”è¾ƒæ˜æ˜¾çš„ä¸åŒå°±æ˜¯ booleanèµ‹å€¼ï¼Œkotlin æ˜¯iså¼€å¤´ï¼Œç­‰å·èµ‹å€¼</p>
<ul>
<li>é›†åˆæ“ä½œ</li>
</ul>
<pre><code class="hljs language-groovy" lang="groovy">// ========== Groovy ==========
ndk {
    abiFilters 'armeabi-v7a', 'arm64-v8a'
}

exclude '**/test/**', '**/*.tmp'
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== Kotlin DSL ==========</span>
ndk {
    abiFilters += setOf(<span class="hljs-string">"armeabi-v7a"</span>, <span class="hljs-string">"arm64-v8a"</span>)
}

exclude(<span class="hljs-string">"**/test/**"</span>, <span class="hljs-string">"**/*.tmp"</span>)
</code></pre>
<h2 data-id="heading-13">æœ€å</h2>
<p>â€ƒâ€ƒè®°å¾—22å¹´æ–°ç‰ˆæœ¬Aså°±å·²ç»æ¨èä½¿ç”¨kotlinæ¥ç®¡ç† Gradle ï¼Œå­¦å®Œåæ„Ÿè§‰ç›¸æ¯”äºGroovyï¼Œkotlinç¼–è¯‘æœŸé—´æ›´åŠ å®‰å…¨ï¼Œè·³è½¬å’Œä»£ç æç¤º ï¼Œæ›´ç§‘å­¦çš„ç®¡ç†ç±»å’Œç‰ˆæœ¬æ§åˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ LangGraph ä¿å§†çº§æ•™ç¨‹ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª AI Agent å·¥ä½œæµ]]></title>    <link>https://juejin.cn/post/7579264485258854415</link>    <guid>https://juejin.cn/post/7579264485258854415</guid>    <pubDate>2025-12-03T08:31:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579264485258854415" data-draft-id="7579264485258838031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ LangGraph ä¿å§†çº§æ•™ç¨‹ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª AI Agent å·¥ä½œæµ"/> <meta itemprop="keywords" content="LangChain,Node.js,Agent"/> <meta itemprop="datePublished" content="2025-12-03T08:31:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Dr_å“ˆå“ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2208293602984286"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ LangGraph ä¿å§†çº§æ•™ç¨‹ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª AI Agent å·¥ä½œæµ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2208293602984286/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Dr_å“ˆå“ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:31:40.000Z" title="Wed Dec 03 2025 08:31:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ğŸ”¥ æœ¬æ–‡ 1.2w å­—ï¼Œä»å…¥é—¨åˆ°å®æˆ˜ï¼Œå¸¦ä½ å½»åº•ææ‡‚ LangGraphï¼é€‚åˆæœ‰ä¸€å®š LangChain åŸºç¡€çš„å¼€å‘è€…ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸ“Œ å‰è¨€</h2>
<p>ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›é—®é¢˜ï¼Ÿ</p>
<ul>
<li>ç”¨ LangChain çš„ <code>pipe()</code> å†™å¤æ‚æµç¨‹æ—¶ï¼Œä»£ç å˜å¾—ä¸€å›¢ä¹±éº»ï¼Ÿ</li>
<li>æƒ³è®© AI Agent è‡ªåŠ¨å¾ªç¯è°ƒç”¨å·¥å…·ï¼Œå´ä¸çŸ¥é“æ€ä¹ˆå®ç°ï¼Ÿ</li>
<li>éœ€è¦æ ¹æ®æ¡ä»¶èµ°ä¸åŒåˆ†æ”¯ï¼Œå´å‘ç° Chain ä¸æ”¯æŒï¼Ÿ</li>
</ul>
<p>å¦‚æœä½ æœ‰ä»¥ä¸Šå›°æ‰°ï¼Œ<strong>LangGraph</strong> å°±æ˜¯ä½ çš„ç­”æ¡ˆï¼</p>
<p>LangGraph æ˜¯ LangChain å›¢é˜Ÿæ¨å‡ºçš„<strong>å·¥ä½œæµç¼–æ’æ¡†æ¶</strong>ï¼Œä¸“é—¨ç”¨äºæ„å»ºå¤æ‚çš„ AI Agentã€‚å®ƒç”¨<strong>å›¾ï¼ˆGraphï¼‰</strong> çš„æ–¹å¼æ¥å®šä¹‰å·¥ä½œæµï¼ŒåŸç”Ÿæ”¯æŒ<strong>åˆ†æ”¯ã€å¾ªç¯ã€çŠ¶æ€ç®¡ç†</strong>ï¼Œæ˜¯æ„å»ºç”Ÿäº§çº§ AI åº”ç”¨çš„åˆ©å™¨ã€‚</p>
<p><strong>é˜…è¯»æœ¬æ–‡ä½ å°†æ”¶è·ï¼š</strong></p>
<ul>
<li>âœ… ç†è§£ LangGraph çš„æ ¸å¿ƒæ¦‚å¿µï¼ˆStateGraphã€Annotationã€Nodeã€Edgeï¼‰</li>
<li>âœ… æŒæ¡çŠ¶æ€ç®¡ç†å’Œæµç¨‹æ§åˆ¶</li>
<li>âœ… å­¦ä¼šå®ç°æ¡ä»¶åˆ†æ”¯å’Œå¾ªç¯æµç¨‹</li>
<li>âœ… èƒ½å¤Ÿç‹¬ç«‹æ„å»º ReAct Agent</li>
</ul>
<hr/>
<h2 data-id="heading-1">ğŸ“š ç›®å½•</h2>
<ol>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-langgraph" title="#1-%E4%BB%80%E4%B9%88%E6%98%AF-langgraph">ä»€ä¹ˆæ˜¯ LangGraph</a></li>
<li><a href="#2-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E9%80%9F%E8%A7%88" title="#2-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E9%80%9F%E8%A7%88">æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ</a></li>
<li><a href="#3-stategraph-%E7%8A%B6%E6%80%81%E5%9B%BE" title="#3-stategraph-%E7%8A%B6%E6%80%81%E5%9B%BE">StateGraph çŠ¶æ€å›¾</a></li>
<li><a href="#4-annotation-%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89" title="#4-annotation-%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89">Annotation çŠ¶æ€å®šä¹‰</a></li>
<li><a href="#5-node-%E8%8A%82%E7%82%B9%E8%AF%A6%E8%A7%A3" title="#5-node-%E8%8A%82%E7%82%B9%E8%AF%A6%E8%A7%A3">Node èŠ‚ç‚¹è¯¦è§£</a></li>
<li><a href="#6-edge-%E8%BE%B9%E4%B8%8E%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6" title="#6-edge-%E8%BE%B9%E4%B8%8E%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6">Edge è¾¹ä¸æµç¨‹æ§åˆ¶</a></li>
<li><a href="#7-%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF%E5%AE%9E%E6%88%98" title="#7-%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF%E5%AE%9E%E6%88%98">æ¡ä»¶åˆ†æ”¯å®æˆ˜</a></li>
<li><a href="#8-%E5%BE%AA%E7%8E%AF%E6%B5%81%E7%A8%8B%E5%AE%9E%E7%8E%B0" title="#8-%E5%BE%AA%E7%8E%AF%E6%B5%81%E7%A8%8B%E5%AE%9E%E7%8E%B0">å¾ªç¯æµç¨‹å®ç°</a></li>
<li><a href="#9-react-agent-%E5%AE%8C%E6%95%B4%E5%AE%9E%E6%88%98" title="#9-react-agent-%E5%AE%8C%E6%95%B4%E5%AE%9E%E6%88%98">ReAct Agent å®Œæ•´å®æˆ˜</a></li>
<li><a href="#10-%E6%B5%81%E5%BC%8F%E8%BE%93%E5%87%BA" title="#10-%E6%B5%81%E5%BC%8F%E8%BE%93%E5%87%BA">æµå¼è¾“å‡º</a></li>
<li><a href="#11-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97" title="#11-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97">æœ€ä½³å®è·µä¸è¸©å‘æŒ‡å—</a></li>
<li><a href="#12-%E9%99%84%E5%BD%95llm-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE" title="#12-%E9%99%84%E5%BD%95llm-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE">é™„å½•ï¼šLLM å‚æ•°é…ç½®</a></li>
</ol>
<hr/>
<h2 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ LangGraph</h2>
<h3 data-id="heading-3">1.1 ä¸€å¥è¯å®šä¹‰</h3>
<p><strong>LangGraph = ç”¨ã€Œç”»æµç¨‹å›¾ã€çš„æ–¹å¼æ„å»º AI åº”ç”¨</strong></p>
<p>å®ƒå°†å·¥ä½œæµå»ºæ¨¡ä¸ºå›¾ï¼ˆGraphï¼‰ï¼š</p>
<ul>
<li><strong>èŠ‚ç‚¹ï¼ˆNodesï¼‰</strong> = æ‰§è¡Œæ­¥éª¤ï¼ˆå‡½æ•°ï¼‰</li>
<li><strong>è¾¹ï¼ˆEdgesï¼‰</strong> = æ­¥éª¤ä¹‹é—´çš„è¿çº¿</li>
<li><strong>çŠ¶æ€ï¼ˆStateï¼‰</strong> = åœ¨èŠ‚ç‚¹é—´ä¼ é€’çš„æ•°æ®</li>
</ul>
<h3 data-id="heading-4">1.2 ä¸ºä»€ä¹ˆéœ€è¦ LangGraphï¼Ÿ</h3>








































<table><thead><tr><th>åœºæ™¯</th><th>LangChain (pipe)</th><th>LangGraph</th></tr></thead><tbody><tr><td>ç®€å•çº¿æ€§æµç¨‹</td><td>âœ… è¶³å¤Ÿ</td><td>å¯ä»¥ä½†æ²¡å¿…è¦</td></tr><tr><td>æ¡ä»¶åˆ†æ”¯</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… åŸç”Ÿæ”¯æŒ</td></tr><tr><td>å¾ªç¯/è¿­ä»£</td><td>âŒ éš¾å®ç°</td><td>âœ… åŸç”Ÿæ”¯æŒ</td></tr><tr><td>å¤æ‚ Agent</td><td>âŒ éœ€æ‰‹å†™å¾ªç¯</td><td>âœ… å£°æ˜å¼å®šä¹‰</td></tr><tr><td>çŠ¶æ€ç®¡ç†</td><td>âŒ æ‰‹åŠ¨ä¼ é€’</td><td>âœ… è‡ªåŠ¨ç®¡ç†</td></tr><tr><td>å¯è§†åŒ–è°ƒè¯•</td><td>âŒ å›°éš¾</td><td>âœ… LangGraph Studio</td></tr></tbody></table>
<h3 data-id="heading-5">1.3 å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash">npm install @langchain/langgraph
</code></pre>
<hr/>
<h2 data-id="heading-6">2. æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ</h2>
<p>åœ¨æ·±å…¥ç»†èŠ‚ä¹‹å‰ï¼Œå…ˆå»ºç«‹å…¨å±€è®¤çŸ¥ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LangGraph æ ¸å¿ƒæ¦‚å¿µ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚    StateGraph (çŠ¶æ€å›¾å®¹å™¨)                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                                               â”‚    â”‚
â”‚    â”‚   <span class="hljs-selector-attr">[START]</span> â”€â”€â†’ <span class="hljs-selector-attr">[Node1]</span> â”€â”€â†’ <span class="hljs-selector-attr">[Node2]</span> â”€â”€â†’ <span class="hljs-selector-attr">[END]</span>  â”‚    â”‚
â”‚    â”‚                 â”‚           â”‚                â”‚    â”‚
â”‚    â”‚                 â–¼           â–¼                â”‚    â”‚
â”‚    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚    â”‚            â”‚  State (å…±äº«çŠ¶æ€)    â”‚          â”‚    â”‚
â”‚    â”‚            â”‚  { <span class="hljs-selector-tag">input</span>, output }  â”‚          â”‚    â”‚
â”‚    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>













































<table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td><strong>StateGraph</strong></td><td>çŠ¶æ€å›¾å®¹å™¨</td><td>æµç¨‹å›¾ç”»å¸ƒ</td></tr><tr><td><strong>State</strong></td><td>å·¥ä½œæµæ•°æ®</td><td>å…¨å±€å˜é‡</td></tr><tr><td><strong>Annotation</strong></td><td>çŠ¶æ€ç»“æ„å®šä¹‰</td><td>TypeScript æ¥å£</td></tr><tr><td><strong>Node</strong></td><td>æ‰§è¡Œå•å…ƒ</td><td>å‡½æ•°</td></tr><tr><td><strong>Edge</strong></td><td>è¿æ¥å…³ç³»</td><td>ç®­å¤´</td></tr><tr><td><strong>START</strong></td><td>èµ·å§‹ç‚¹</td><td>main()</td></tr><tr><td><strong>END</strong></td><td>ç»“æŸç‚¹</td><td>return</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">3. StateGraph çŠ¶æ€å›¾</h2>
<h3 data-id="heading-8">3.1 åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">StateGraph</span>, <span class="hljs-title class_">Annotation</span>, <span class="hljs-variable constant_">START</span>, <span class="hljs-variable constant_">END</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph"</span>;

<span class="hljs-comment">// 1ï¸âƒ£ å®šä¹‰çŠ¶æ€ç»“æ„</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">MyState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">input</span>: <span class="hljs-title class_">Annotation</span>({ <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">_, x</span>) =&gt;</span> x, <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">""</span> }),
  <span class="hljs-attr">output</span>: <span class="hljs-title class_">Annotation</span>({ <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">_, x</span>) =&gt;</span> x, <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">""</span> }),
});

<span class="hljs-comment">// 2ï¸âƒ£ åˆ›å»ºçŠ¶æ€å›¾</span>
<span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateGraph</span>(<span class="hljs-title class_">MyState</span>)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"step1"</span>, step1Function) <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹</span>
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"step2"</span>, step2Function)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"step1"</span>) <span class="hljs-comment">// æ·»åŠ è¾¹</span>
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"step1"</span>, <span class="hljs-string">"step2"</span>)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"step2"</span>, <span class="hljs-variable constant_">END</span>);

<span class="hljs-comment">// 3ï¸âƒ£ ç¼–è¯‘</span>
<span class="hljs-keyword">const</span> app = graph.<span class="hljs-title function_">compile</span>();

<span class="hljs-comment">// 4ï¸âƒ£ æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">input</span>: <span class="hljs-string">"hello"</span> });
</code></pre>
<h3 data-id="heading-9">3.2 æ ¸å¿ƒ API</h3>








































<table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>addNode(name, fn)</code></td><td>æ·»åŠ èŠ‚ç‚¹</td><td><code>graph.addNode("process", processFn)</code></td></tr><tr><td><code>addEdge(from, to)</code></td><td>æ·»åŠ æ— æ¡ä»¶è¾¹</td><td><code>graph.addEdge("A", "B")</code></td></tr><tr><td><code>addConditionalEdges()</code></td><td>æ·»åŠ æ¡ä»¶è¾¹</td><td>è§ä¸‹æ–‡è¯¦è§£</td></tr><tr><td><code>compile()</code></td><td>ç¼–è¯‘å›¾</td><td><code>const app = graph.compile()</code></td></tr><tr><td><code>invoke(state)</code></td><td>åŒæ­¥æ‰§è¡Œ</td><td><code>await app.invoke({...})</code></td></tr><tr><td><code>stream(state)</code></td><td>æµå¼æ‰§è¡Œ</td><td><code>for await (const e of app.stream({...}))</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10">4. Annotation çŠ¶æ€å®šä¹‰</h2>
<h3 data-id="heading-11">4.1 ä»€ä¹ˆæ˜¯ Annotationï¼Ÿ</h3>
<p><strong>Annotation = å‘Šè¯‰ LangGraphã€ŒçŠ¶æ€é•¿ä»€ä¹ˆæ ·ã€+ã€ŒçŠ¶æ€æ€ä¹ˆæ›´æ–°ã€</strong></p>
<p>æŠŠå®ƒæƒ³è±¡æˆã€Œå¿«é€’å•ã€çš„æ ¼å¼å®šä¹‰ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ğŸ“¦ Annotation å®šä¹‰ã€Œå¿«é€’å•ã€æ ¼å¼

   å¿«é€’å•ä¸Šæœ‰å“ªäº›å­—æ®µï¼Ÿ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ”¶ä»¶äºº: <span class="hljs-strong">____</span><span class="hljs-strong">____</span>                â”‚
   â”‚ åœ°å€:   <span class="hljs-strong">____</span><span class="hljs-strong">____</span>                â”‚
   â”‚ ç‰©å“:   <span class="hljs-strong">____</span><span class="hljs-strong">____</span>                â”‚
   â”‚ å¤‡æ³¨:   <span class="hljs-strong">____</span><span class="hljs-strong">____</span> (å¯è¿½åŠ )       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   æ¯ä¸ªç«™ç‚¹ï¼ˆèŠ‚ç‚¹ï¼‰éƒ½èƒ½çœ‹åˆ°è¿™å¼ å•ï¼Œä¹Ÿèƒ½ä¿®æ”¹å®ƒ
</code></pre>
<h3 data-id="heading-12">4.2 åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Annotation</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">MyState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">fieldName</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: reducerFunction, <span class="hljs-comment">// çŠ¶æ€å¦‚ä½•æ›´æ–°</span>
    <span class="hljs-attr">default</span>: defaultFunction, <span class="hljs-comment">// é»˜è®¤å€¼</span>
  }),
});
</code></pre>
<h3 data-id="heading-13">4.3 Reducer è¯¦è§£</h3>
<p>Reducer å†³å®šã€Œå½“èŠ‚ç‚¹è¿”å›æ–°å€¼æ—¶ï¼Œæ€ä¹ˆæ›´æ–°çŠ¶æ€ã€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ›¿æ¢æ¨¡å¼ - æ–°å€¼è¦†ç›–æ—§å€¼</span>
<span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> next;
<span class="hljs-comment">// èŠ‚ç‚¹è¿”å› { name: "æå››" } â†’ state.name å˜æˆ "æå››"</span>

<span class="hljs-comment">// 2. ç´¯åŠ æ¨¡å¼ - é€‚ç”¨äºæ¶ˆæ¯åˆ—è¡¨ï¼ˆæœ€å¸¸ç”¨ï¼ï¼‰</span>
<span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> [...prev, ...next];
<span class="hljs-comment">// èŠ‚ç‚¹è¿”å› { messages: [æ–°æ¶ˆæ¯] } â†’ è¿½åŠ åˆ° messages æ•°ç»„</span>

<span class="hljs-comment">// 3. æ•°å­—ç´¯åŠ </span>
<span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> prev + next;
<span class="hljs-comment">// èŠ‚ç‚¹è¿”å› { count: 1 } â†’ count åŠ  1</span>
</code></pre>
<h3 data-id="heading-14">4.4 å®é™…æ¡ˆä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¹è¯ Agent çš„çŠ¶æ€å®šä¹‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AgentState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-comment">// æ¶ˆæ¯åˆ—è¡¨ - ç´¯åŠ æ¨¡å¼ï¼ˆé‡è¦ï¼ï¼‰</span>
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> [...prev, ...next],
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],
  }),

  <span class="hljs-comment">// å½“å‰ä»»åŠ¡ - æ›¿æ¢æ¨¡å¼</span>
  <span class="hljs-attr">currentTask</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">_, next</span>) =&gt;</span> next,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">""</span>,
  }),

  <span class="hljs-comment">// è¿­ä»£æ¬¡æ•° - æ•°å­—ç´¯åŠ </span>
  <span class="hljs-attr">iterations</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> prev + next,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-number">0</span>,
  }),
});
</code></pre>
<h3 data-id="heading-15">4.5 ä¸ºä»€ä¹ˆéœ€è¦ Reducerï¼Ÿ</h3>
<p><strong>ç—›ç‚¹</strong>ï¼šå¤šä¸ªèŠ‚ç‚¹éƒ½æƒ³æ›´æ–°åŒä¸€ä¸ªå­—æ®µ</p>
<pre><code class="hljs language-css" lang="css">ä¾‹å¦‚ï¼šæ¶ˆæ¯åˆ—è¡¨
  - èŠ‚ç‚¹ <span class="hljs-selector-tag">A</span> è¿”å›: { messages: [new <span class="hljs-built_in">HumanMessage</span>(<span class="hljs-string">"hi"</span>)] }
  - èŠ‚ç‚¹ <span class="hljs-selector-tag">B</span> è¿”å›: { messages: [new <span class="hljs-built_in">AIMessage</span>(<span class="hljs-string">"hello"</span>)] }

âŒ æ²¡æœ‰ Reducerï¼šèŠ‚ç‚¹ <span class="hljs-selector-tag">B</span> çš„å€¼è¦†ç›–èŠ‚ç‚¹ <span class="hljs-selector-tag">A</span>ï¼Œç”¨æˆ·æ¶ˆæ¯ä¸¢å¤±ï¼
âœ… æœ‰ Reducerï¼š  <span class="hljs-selector-attr">[...prev, ...next]</span>ï¼Œä¸¤æ¡æ¶ˆæ¯éƒ½ä¿ç•™ï¼
</code></pre>
<hr/>
<h2 data-id="heading-16">5. Node èŠ‚ç‚¹è¯¦è§£</h2>
<h3 data-id="heading-17">5.1 èŠ‚ç‚¹å‡½æ•°ç­¾å</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// èŠ‚ç‚¹ = æ¥æ”¶ stateï¼Œè¿”å›éƒ¨åˆ†æ›´æ–°çš„å‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-comment">// ä» state è¯»å–æ•°æ®</span>
  <span class="hljs-keyword">const</span> input = state.<span class="hljs-property">input</span>;

  <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">someOperation</span>(input);

  <span class="hljs-comment">// åªè¿”å›éœ€è¦æ›´æ–°çš„å­—æ®µ</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">output</span>: result };
}
</code></pre>
<h3 data-id="heading-18">5.2 å¸¸è§èŠ‚ç‚¹ç±»å‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. çº¯å¤„ç†èŠ‚ç‚¹ - æ•°æ®å¤„ç†ï¼Œå¯ä»¥æ˜¯åŒæ­¥çš„</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">result</span>: state.<span class="hljs-property">input</span>.<span class="hljs-title function_">toUpperCase</span>() };
}

<span class="hljs-comment">// 2. LLM èŠ‚ç‚¹ - è°ƒç”¨ AI æ¨¡å‹ï¼ˆå¿…é¡»å¼‚æ­¥ï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">llmNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">invoke</span>([<span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(state.<span class="hljs-property">question</span>)]);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">answer</span>: response.<span class="hljs-property">content</span> };
}

<span class="hljs-comment">// 3. API èŠ‚ç‚¹ - è°ƒç”¨å¤–éƒ¨æ¥å£ï¼ˆå¿…é¡»å¼‚æ­¥ï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">apiNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"https://api.example.com/data"</span>);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">apiResult</span>: <span class="hljs-keyword">await</span> data.<span class="hljs-title function_">json</span>() };
}

<span class="hljs-comment">// 4. å·¥å…·èŠ‚ç‚¹ - ä½¿ç”¨å†…ç½® ToolNode</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ToolNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph/prebuilt"</span>;
<span class="hljs-keyword">const</span> toolNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ToolNode</span>(tools);
</code></pre>
<h3 data-id="heading-19">5.3 è¿”å›å€¼è§„åˆ™</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåªè¿”å›éœ€è¦æ›´æ–°çš„å­—æ®µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">goodNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">output</span>: <span class="hljs-string">"result"</span> };
}

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸éœ€è¦å±•å¼€æ•´ä¸ª state</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">badNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">return</span> { ...state, <span class="hljs-attr">output</span>: <span class="hljs-string">"result"</span> };
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šè¿”å›ç©ºå¯¹è±¡ = ä¸æ›´æ–°ä»»ä½•å­—æ®µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">noUpdateNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state);
  <span class="hljs-keyword">return</span> {};
}
</code></pre>
<hr/>
<h2 data-id="heading-20">6. Edge è¾¹ä¸æµç¨‹æ§åˆ¶</h2>
<h3 data-id="heading-21">6.1 ä»€ä¹ˆæ˜¯ Edgeï¼Ÿ</h3>
<p><strong>Edge = æµç¨‹å›¾é‡Œçš„ã€Œç®­å¤´ã€= å®šä¹‰æ‰§è¡Œé¡ºåº</strong></p>
<pre><code class="hljs language-css" lang="css">        Edgeï¼ˆè¾¹ï¼‰
           â†“
<span class="hljs-selector-attr">[START]</span> â”€â”€â”€â”€â”€â”€â”€â”€â†’ <span class="hljs-selector-attr">[NodeA]</span> â”€â”€â”€â”€â”€â”€â”€â”€â†’ <span class="hljs-selector-attr">[END]</span>
          â†‘                  â†‘
       è¿™æ˜¯è¾¹             è¿™ä¹Ÿæ˜¯è¾¹

æ„æ€ï¼šSTART å®Œäº†æ‰§è¡Œ NodeAï¼ŒNodeA å®Œäº†ç»“æŸ
</code></pre>
<h3 data-id="heading-22">6.2 ä¸¤ç§è¾¹çš„å¯¹æ¯”</h3>























<table><thead><tr><th>ç±»å‹</th><th>è¯´æ˜</th><th>æ¯”å–»</th><th>ä»£ç </th></tr></thead><tbody><tr><td><strong>æ™®é€šè¾¹</strong></td><td>A å®Œäº†ä¸€å®šåˆ° B</td><td>ç›´çº¿</td><td><code>addEdge("A", "B")</code></td></tr><tr><td><strong>æ¡ä»¶è¾¹</strong></td><td>æ ¹æ®çŠ¶æ€å†³å®šå»å“ª</td><td>å²”è·¯å£</td><td><code>addConditionalEdges(...)</code></td></tr></tbody></table>
<h3 data-id="heading-23">6.3 æ™®é€šè¾¹è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">START</span>, <span class="hljs-variable constant_">END</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph"</span>;

<span class="hljs-comment">// ä» A åˆ° B</span>
graph.<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>);

<span class="hljs-comment">// å…¥å£</span>
graph.<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"firstNode"</span>);

<span class="hljs-comment">// å‡ºå£</span>
graph.<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"lastNode"</span>, <span class="hljs-variable constant_">END</span>);

<span class="hljs-comment">// é“¾å¼è°ƒç”¨</span>
graph.<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"A"</span>).<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>).<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>).<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"C"</span>, <span class="hljs-variable constant_">END</span>);
</code></pre>
<h3 data-id="heading-24">6.4 addEdge vs pipe() å¯¹æ¯”</h3>
<p>å¦‚æœä½ ç”¨è¿‡ LangChain çš„ <code>pipe()</code>ï¼š</p>

























<table><thead><tr><th>ç‰¹æ€§</th><th>pipe()</th><th>addEdge()</th></tr></thead><tbody><tr><td>æµç¨‹ç±»å‹</td><td>åªèƒ½çº¿æ€§ Aâ†’Bâ†’C</td><td>å¯åˆ†æ”¯ã€å¾ªç¯</td></tr><tr><td>æ¡ä»¶åˆ†æ”¯</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td>å¾ªç¯</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr></tbody></table>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">pipe</span>():      <span class="hljs-selector-tag">A</span> â”€â”€â†’ <span class="hljs-selector-tag">B</span> â”€â”€â†’ <span class="hljs-selector-tag">C</span> â”€â”€â†’ ç»“æŸï¼ˆåªèƒ½å¾€å‰ï¼‰

<span class="hljs-selector-tag">addEdge</span>():   <span class="hljs-selector-tag">A</span> â”€â”€â†’ <span class="hljs-selector-tag">B</span> â”€â”€â†’ <span class="hljs-selector-tag">C</span> â”€â”€â†’ ç»“æŸ
                  â†‘     â”‚
                  â””â”€â”€â”€â”€â”€â”˜  ï¼ˆå¯ä»¥å¾ªç¯å›å»ï¼ï¼‰
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æ€»ç»“</strong>ï¼šç®€å•çº¿æ€§æµç¨‹ç”¨ pipeï¼Œéœ€è¦åˆ†æ”¯/å¾ªç¯ç”¨ LangGraphï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-25">7. æ¡ä»¶åˆ†æ”¯å®æˆ˜</h2>
<h3 data-id="heading-26">7.1 è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript">graph.<span class="hljs-title function_">addConditionalEdges</span>(
  fromNode, <span class="hljs-comment">// æºèŠ‚ç‚¹</span>
  routerFunction, <span class="hljs-comment">// è·¯ç”±å‡½æ•°</span>
  routeMapping <span class="hljs-comment">// è·¯ç”±æ˜ å°„</span>
);
</code></pre>
<h3 data-id="heading-27">7.2 è·¯ç”±å‡½æ•°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·¯ç”±å‡½æ•°ï¼šæ¥æ”¶ stateï¼Œè¿”å›è·¯ç”± key</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">router</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">score</span> &gt; <span class="hljs-number">80</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"high"</span>;
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">score</span> &gt; <span class="hljs-number">60</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"medium"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"low"</span>;
}

<span class="hljs-comment">// è·¯ç”±æ˜ å°„ï¼škey â†’ èŠ‚ç‚¹å</span>
<span class="hljs-keyword">const</span> routeMapping = {
  <span class="hljs-attr">high</span>: <span class="hljs-string">"celebrateNode"</span>,
  <span class="hljs-attr">medium</span>: <span class="hljs-string">"normalNode"</span>,
  <span class="hljs-attr">low</span>: <span class="hljs-string">"improveNode"</span>,
};

graph.<span class="hljs-title function_">addConditionalEdges</span>(<span class="hljs-string">"scoreNode"</span>, router, routeMapping);
</code></pre>
<h3 data-id="heading-28">7.3 å®Œæ•´ç¤ºä¾‹ï¼šæƒ…æ„Ÿåˆ†æè·¯ç”±</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·¯ç”±å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sentimentRouter</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> sentiment = state.<span class="hljs-property">sentiment</span>;
  <span class="hljs-keyword">if</span> (sentiment.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"ç§¯æ"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"positive"</span>;
  <span class="hljs-keyword">if</span> (sentiment.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"æ¶ˆæ"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"negative"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"neutral"</span>;
}

<span class="hljs-comment">// æ„å»ºå›¾</span>
<span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateGraph</span>(<span class="hljs-title class_">MyState</span>)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"analyze"</span>, analyzeNode)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"positive"</span>, positiveHandler)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"negative"</span>, negativeHandler)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"neutral"</span>, neutralHandler)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"analyze"</span>)
  .<span class="hljs-title function_">addConditionalEdges</span>(<span class="hljs-string">"analyze"</span>, sentimentRouter, {
    <span class="hljs-attr">positive</span>: <span class="hljs-string">"positive"</span>,
    <span class="hljs-attr">negative</span>: <span class="hljs-string">"negative"</span>,
    <span class="hljs-attr">neutral</span>: <span class="hljs-string">"neutral"</span>,
  })
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"positive"</span>, <span class="hljs-variable constant_">END</span>)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"negative"</span>, <span class="hljs-variable constant_">END</span>)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"neutral"</span>, <span class="hljs-variable constant_">END</span>);
</code></pre>
<p>æµç¨‹å›¾ï¼š</p>
<pre><code class="hljs language-css" lang="css">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”Œâ”€â”€â”€â†’â”‚  positive   â”‚â”€â”€â”€â”
               â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
<span class="hljs-selector-attr">[START]</span>â†’<span class="hljs-selector-attr">[analyze]</span>                     â”‚â†’<span class="hljs-selector-attr">[END]</span>
               â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
               â”œâ”€â”€â”€â†’â”‚  negative   â”‚â”€â”€â”€â”¤
               â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
               â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
               â””â”€â”€â”€â†’â”‚  neutral    â”‚â”€â”€â”€â”˜
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-29">8. å¾ªç¯æµç¨‹å®ç°</h2>
<h3 data-id="heading-30">8.1 æ ¸å¿ƒæ€è·¯</h3>
<p>é€šè¿‡æ¡ä»¶è¾¹å®ç°å¾ªç¯ï¼šå½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œæµç¨‹å›åˆ°ä¹‹å‰çš„èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">shouldContinue</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-comment">// å®‰å…¨ä¿æŠ¤ï¼šæœ€å¤šè¿­ä»£ N æ¬¡</span>
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">iterations</span> &gt;= <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
  <span class="hljs-comment">// ä¸šåŠ¡æ¡ä»¶</span>
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">isComplete</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"continue"</span>;
}

<span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateGraph</span>(<span class="hljs-title class_">MyState</span>)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"process"</span>, processNode)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"check"</span>, checkNode)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"process"</span>)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"process"</span>, <span class="hljs-string">"check"</span>)
  .<span class="hljs-title function_">addConditionalEdges</span>(<span class="hljs-string">"check"</span>, shouldContinue, {
    <span class="hljs-attr">continue</span>: <span class="hljs-string">"process"</span>, <span class="hljs-comment">// ğŸ”„ å¾ªç¯å› process</span>
    <span class="hljs-attr">end</span>: <span class="hljs-variable constant_">END</span>,
  });
</code></pre>
<p>æµç¨‹å›¾ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[START]</span> â”€â”€â†’ <span class="hljs-selector-attr">[process]</span> â”€â”€â†’ <span class="hljs-selector-attr">[check]</span>
                â†‘            â”‚
                â”‚  continue  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚ end
                             â†“
                          <span class="hljs-selector-attr">[END]</span>
</code></pre>
<h3 data-id="heading-31">8.2 âš ï¸ é˜²æ­¢æ— é™å¾ªç¯</h3>
<p><strong>è¿™æ˜¯æœ€é‡è¦çš„ï¼ä¸€å®šè¦è®¾ç½®æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_ITERATIONS</span> = <span class="hljs-number">10</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">shouldContinue</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-comment">// 1ï¸âƒ£ å…ˆæ£€æŸ¥è¿­ä»£æ¬¡æ•°ï¼ˆå®‰å…¨ä¿æŠ¤ï¼‰</span>
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">iterations</span> &gt;= <span class="hljs-variable constant_">MAX_ITERATIONS</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"âš ï¸ è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œå¼ºåˆ¶ç»“æŸ"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
  }

  <span class="hljs-comment">// 2ï¸âƒ£ å†æ£€æŸ¥ä¸šåŠ¡æ¡ä»¶</span>
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">isComplete</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-string">"continue"</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-32">9. ReAct Agent å®Œæ•´å®æˆ˜</h2>
<h3 data-id="heading-33">9.1 ä»€ä¹ˆæ˜¯ ReActï¼Ÿ</h3>
<p><strong>ReAct = Reasoning + Acting</strong>ï¼Œè®© LLM è‡ªä¸»ä½¿ç”¨å·¥å…·çš„æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ğŸ¤” Reasoning (æ¨ç†): LLM åˆ†æé—®é¢˜ï¼Œå†³å®šéœ€è¦ä»€ä¹ˆ
<span class="hljs-bullet">2.</span> ğŸ”§ Acting (è¡ŒåŠ¨): è°ƒç”¨å·¥å…·è·å–ä¿¡æ¯
<span class="hljs-bullet">3.</span> ğŸ‘€ Observation (è§‚å¯Ÿ): æŸ¥çœ‹å·¥å…·è¿”å›ç»“æœ
<span class="hljs-bullet">4.</span> ğŸ”„ å¾ªç¯: ç›´åˆ°å¯ä»¥ç»™å‡ºæœ€ç»ˆç­”æ¡ˆ
</code></pre>
<h3 data-id="heading-34">9.2 æµç¨‹å›¾</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[START]</span> â”€â”€â†’ <span class="hljs-selector-attr">[agent]</span> â”€â”€â†’ <span class="hljs-selector-attr">[router]</span>
               â†‘            â”‚
               â”‚   tools    â”‚ has_tools
               â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚  â†“                   â†“
           <span class="hljs-selector-attr">[tools]</span>              no_tools
               â”‚                      â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†“
                                   <span class="hljs-selector-attr">[END]</span>
</code></pre>
<h3 data-id="heading-35">9.3 å®Œæ•´ä»£ç </h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">StateGraph</span>, <span class="hljs-title class_">Annotation</span>, <span class="hljs-variable constant_">START</span>, <span class="hljs-variable constant_">END</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ToolNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph/prebuilt"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">HumanMessage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/messages"</span>;

<span class="hljs-comment">// 1ï¸âƒ£ å®šä¹‰çŠ¶æ€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AgentState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">prev, next</span>) =&gt;</span> [...prev, ...next],
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],
  }),
});

<span class="hljs-comment">// 2ï¸âƒ£ å®šä¹‰å·¥å…· &amp; ç»‘å®šåˆ° LLM</span>
<span class="hljs-keyword">const</span> tools = [calculatorTool, searchTool, weatherTool];
<span class="hljs-keyword">const</span> llmWithTools = llm.<span class="hljs-title function_">bindTools</span>(tools);

<span class="hljs-comment">// 3ï¸âƒ£ Agent èŠ‚ç‚¹ï¼šè°ƒç”¨ LLM åšå†³ç­–</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">agentNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> llmWithTools.<span class="hljs-title function_">invoke</span>(state.<span class="hljs-property">messages</span>);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">messages</span>: [response] };
}

<span class="hljs-comment">// 4ï¸âƒ£ å·¥å…·èŠ‚ç‚¹ï¼šçœŸæ­£æ‰§è¡Œå·¥å…·</span>
<span class="hljs-keyword">const</span> toolNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ToolNode</span>(tools);

<span class="hljs-comment">// 5ï¸âƒ£ è·¯ç”±å‡½æ•°ï¼šåˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">shouldCallTools</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> lastMessage = state.<span class="hljs-property">messages</span>[state.<span class="hljs-property">messages</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
  <span class="hljs-keyword">if</span> (lastMessage.<span class="hljs-property">tool_calls</span>?.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
}

<span class="hljs-comment">// 6ï¸âƒ£ æ„å»ºå›¾</span>
<span class="hljs-keyword">const</span> agentGraph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateGraph</span>(<span class="hljs-title class_">AgentState</span>)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"agent"</span>, agentNode)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"tools"</span>, toolNode)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"agent"</span>)
  .<span class="hljs-title function_">addConditionalEdges</span>(<span class="hljs-string">"agent"</span>, shouldCallTools, {
    <span class="hljs-attr">tools</span>: <span class="hljs-string">"tools"</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-variable constant_">END</span>,
  })
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-string">"tools"</span>, <span class="hljs-string">"agent"</span>); <span class="hljs-comment">// ğŸ”„ å·¥å…·æ‰§è¡Œå®Œå›åˆ° agent</span>

<span class="hljs-comment">// 7ï¸âƒ£ ç¼–è¯‘ &amp; æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> agent = agentGraph.<span class="hljs-title function_">compile</span>();
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">invoke</span>({
  <span class="hljs-attr">messages</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(<span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>)],
});
</code></pre>
<h3 data-id="heading-36">9.4 æ‰§è¡Œæµç¨‹æ¼”ç¤º</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">ç”¨æˆ·: <span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>

<span class="hljs-keyword">Step</span> <span class="hljs-number">1</span>: [agent]
  â””â”€ LLM æ€è€ƒ: <span class="hljs-string">"éœ€è¦è°ƒç”¨ get_weather å·¥å…·"</span>
  â””â”€ è¾“å‡º: tool_calls: [{name: <span class="hljs-string">"get_weather"</span>, args: {city: <span class="hljs-string">"åŒ—äº¬"</span>}}]

<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span>: [router] â†’ æ£€æµ‹åˆ° tool_calls â†’ å» [tools]

<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span>: [tools]
  â””â”€ æ‰§è¡Œ: get_weather(<span class="hljs-string">"åŒ—äº¬"</span>)
  â””â”€ è¿”å›: <span class="hljs-string">"åŒ—äº¬ï¼šæ™´å¤©ï¼Œ15Â°C"</span>

<span class="hljs-keyword">Step</span> <span class="hljs-number">4</span>: [agent]
  â””â”€ LLM çœ‹åˆ°å·¥å…·ç»“æœ
  â””â”€ ç”Ÿæˆæœ€ç»ˆå›ç­”ï¼Œæ—  tool_calls

<span class="hljs-keyword">Step</span> <span class="hljs-number">5</span>: [router] â†’ æ—  tool_calls â†’ å» [<span class="hljs-keyword">END</span>]

æœ€ç»ˆè¾“å‡º: <span class="hljs-string">"åŒ—äº¬ä»Šå¤©æ™´å¤©ï¼Œæ°”æ¸©15Â°Cï¼Œæ˜¯ä¸ªå¥½å¤©æ°”ï¼"</span>
</code></pre>
<h3 data-id="heading-37">9.5 é‡è¦æ¦‚å¿µè¾¨æ</h3>
<p>å¾ˆå¤šäººæ··æ·† <code>llmWithTools</code> å’Œ <code>toolNode</code>ï¼š</p>

























<table><thead><tr><th>æ¦‚å¿µ</th><th>ä½œç”¨</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td><code>llmWithTools</code></td><td>è®© LLM <strong>çŸ¥é“</strong>æœ‰å“ªäº›å·¥å…·</td><td>å·¥å…·è¯´æ˜ä¹¦</td></tr><tr><td><code>agentNode</code></td><td>è°ƒç”¨ LLM <strong>å†³ç­–</strong>æ˜¯å¦ç”¨å·¥å…·</td><td>å†³ç­–è€…</td></tr><tr><td><code>toolNode</code></td><td><strong>çœŸæ­£æ‰§è¡Œ</strong>å·¥å…·è°ƒç”¨</td><td>æ‰§è¡Œè€…</td></tr></tbody></table>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  agentNode (å†…éƒ¨ç”¨ llmWithTools)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LLM: <span class="hljs-string">"ç”¨æˆ·é—®å¤©æ°”ï¼Œæˆ‘éœ€è¦è°ƒç”¨ get_weather"</span>           â”‚  â”‚
â”‚  â”‚      â†“                                             â”‚  â”‚
â”‚  â”‚ è¾“å‡º: tool_calls: [{name: <span class="hljs-string">"get_weather"</span>, ...}]     â”‚  â”‚
â”‚  â”‚      ï¼ˆåªæ˜¯"è¯´"è¦è°ƒç”¨ï¼Œæ²¡æœ‰çœŸçš„è°ƒï¼‰                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚                               â”‚
â”‚                          â–¼                               â”‚
â”‚  toolNode                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ‰§è¡Œ: <span class="hljs-built_in">get_weather</span>(<span class="hljs-string">"åŒ—äº¬"</span>)                          â”‚  â”‚
â”‚  â”‚ è¿”å›: <span class="hljs-string">"åŒ—äº¬ï¼šæ™´å¤©ï¼Œ15Â°C"</span>                           â”‚  â”‚
â”‚  â”‚      ï¼ˆçœŸæ­£è°ƒç”¨å·¥å…·ï¼Œæ‹¿åˆ°ç»“æœï¼‰                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è®°å¿†å£è¯€</strong>ï¼šllmWithTools è®© LLMã€ŒçŸ¥é“ã€å·¥å…·ï¼ŒtoolNode è®©å·¥å…·ã€Œæ‰§è¡Œã€ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-38">10. æµå¼è¾“å‡º</h2>
<h3 data-id="heading-39">10.1 invoke vs stream</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// invoke: ç­‰å¾…å…¨éƒ¨å®Œæˆ</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">invoke</span>(initialState);

<span class="hljs-comment">// stream: å®æ—¶è¿”å›æ¯ä¸ªèŠ‚ç‚¹è¾“å‡º</span>
<span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> event <span class="hljs-keyword">of</span> app.<span class="hljs-title function_">stream</span>(initialState)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event);
  <span class="hljs-comment">// { "agent": { messages: [...] } }</span>
  <span class="hljs-comment">// { "tools": { messages: [...] } }</span>
}
</code></pre>
<h3 data-id="heading-40">10.2 ä¼˜åŠ¿</h3>
<ul>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šå®æ—¶çœ‹åˆ°è¿›åº¦ï¼Œå‡å°‘ç­‰å¾…ç„¦è™‘</li>
<li><strong>è°ƒè¯•æ–¹ä¾¿</strong>ï¼šçœ‹åˆ°æ¯æ­¥ä¸­é—´ç»“æœ</li>
<li><strong>æ—©æœŸå‘ç°</strong>ï¼šæŸèŠ‚ç‚¹å‡ºé”™å¯å°½æ—©å‘ç°</li>
<li><strong>å†…å­˜å‹å¥½</strong>ï¼šè¾¹å¤„ç†è¾¹è¾“å‡º</li>
</ul>
<hr/>
<h2 data-id="heading-41">11. æœ€ä½³å®è·µä¸è¸©å‘æŒ‡å—</h2>
<h3 data-id="heading-42">11.1 çŠ¶æ€è®¾è®¡</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… å¥½çš„è®¾è®¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">GoodState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">userQuestion</span>: <span class="hljs-title class_">Annotation</span>({ ... }),      <span class="hljs-comment">// æ¸…æ™°å‘½å</span>
  <span class="hljs-attr">chatHistory</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">p, n</span>) =&gt;</span> [...p, ...n],      <span class="hljs-comment">// åˆé€‚çš„ reducer</span>
  }),
  <span class="hljs-attr">retryCount</span>: <span class="hljs-title class_">Annotation</span>({
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-number">0</span>,                     <span class="hljs-comment">// æ˜ç¡®é»˜è®¤å€¼</span>
  }),
});

<span class="hljs-comment">// âŒ ä¸å¥½çš„è®¾è®¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">BadState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">data</span>: <span class="hljs-title class_">Annotation</span>({ ... }),   <span class="hljs-comment">// å‘½åæ¨¡ç³Š</span>
  <span class="hljs-attr">x</span>: <span class="hljs-title class_">Annotation</span>({ ... }),      <span class="hljs-comment">// å«ä¹‰ä¸æ˜</span>
});
</code></pre>
<h3 data-id="heading-43">11.2 èŠ‚ç‚¹è®¾è®¡ï¼šå•ä¸€èŒè´£</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… å¥½ï¼šæ¯ä¸ªèŠ‚ç‚¹åªåšä¸€ä»¶äº‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">translateNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> translated = <span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">invoke</span>([...]);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">translatedText</span>: translated.<span class="hljs-property">content</span> };
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">analyzeNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> analysis = <span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">invoke</span>([...]);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">analysisResult</span>: analysis.<span class="hljs-property">content</span> };
}

<span class="hljs-comment">// âŒ ä¸å¥½ï¼šä¸€ä¸ªèŠ‚ç‚¹åšå¤ªå¤šäº‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">doEverythingNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-comment">// ç¿»è¯‘ + åˆ†æ + æ€»ç»“ + ç”ŸæˆæŠ¥å‘Š...</span>
}
</code></pre>
<h3 data-id="heading-44">11.3 é”™è¯¯å¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">riskyOperation</span>(state);
    <span class="hljs-keyword">return</span> { result, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"èŠ‚ç‚¹æ‰§è¡Œå¤±è´¥:"</span>, error);
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">result</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> };
  }
}

<span class="hljs-comment">// åœ¨è·¯ç”±ä¸­å¤„ç†é”™è¯¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">router</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">error</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"errorHandler"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"nextStep"</span>;
}
</code></pre>
<h3 data-id="heading-45">11.4 å¾ªç¯å¿…é¡»è®¾ç½®ä¸Šé™</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_ITERATIONS</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// å¿…é¡»ï¼</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">loopRouter</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">iterations</span> &gt;= <span class="hljs-variable constant_">MAX_ITERATIONS</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"âš ï¸ è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
  }
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">isComplete</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"end"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"continue"</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-46">12. é™„å½•ï¼šLLM å‚æ•°é…ç½®</h2>
<h3 data-id="heading-47">12.1 temperature å‚æ•°</h3>






























<table><thead><tr><th>å€¼</th><th>æ•ˆæœ</th><th>è¾“å‡ºç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>0</strong></td><td>ç¡®å®šæ€§æœ€é«˜</td><td>æ¯æ¬¡å‡ ä¹ç›¸åŒ</td></tr><tr><td><strong>0.1-0.3</strong></td><td>ä½éšæœºæ€§</td><td>ç¨³å®šã€å¯é¢„æµ‹</td></tr><tr><td><strong>0.5-0.7</strong></td><td>ä¸­ç­‰</td><td>å¹³è¡¡åˆ›æ„å’Œä¸€è‡´æ€§</td></tr><tr><td><strong>0.8-1.0</strong></td><td>é«˜éšæœºæ€§</td><td>æ›´æœ‰åˆ›æ„</td></tr></tbody></table>
<h3 data-id="heading-48">12.2 æ¨èå€¼</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èå€¼</th></tr></thead><tbody><tr><td>ä»£ç ç”Ÿæˆ / æ•°å­¦</td><td>0 ~ 0.2</td></tr><tr><td>æ•°æ®æå– / åˆ†ç±»</td><td>0</td></tr><tr><td>é—®ç­” / çŸ¥è¯†æ£€ç´¢</td><td>0 ~ 0.3</td></tr><tr><td>é€šç”¨å¯¹è¯</td><td>0.5 ~ 0.7</td></tr><tr><td>åˆ›æ„å†™ä½œ</td><td>0.7 ~ 1.0</td></tr></tbody></table>
<h3 data-id="heading-49">12.3 åœ¨ LangGraph ä¸­ä½¿ç”¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸åŒèŠ‚ç‚¹ç”¨ä¸åŒ temperature</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">codeNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> precisionLLM = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({ <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.1</span> });
  <span class="hljs-comment">// ...</span>
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">creativeNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">const</span> creativeLLM = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({ <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.9</span> });
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-50">ğŸ¯ å¿«é€Ÿå‚è€ƒæ¨¡æ¿</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">StateGraph</span>, <span class="hljs-title class_">Annotation</span>, <span class="hljs-variable constant_">START</span>, <span class="hljs-variable constant_">END</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ToolNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph/prebuilt"</span>;

<span class="hljs-comment">// 1. å®šä¹‰çŠ¶æ€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">MyState</span> = <span class="hljs-title class_">Annotation</span>.<span class="hljs-title class_">Root</span>({
  <span class="hljs-attr">input</span>: <span class="hljs-title class_">Annotation</span>({ <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">_, x</span>) =&gt;</span> x, <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">""</span> }),
  <span class="hljs-attr">output</span>: <span class="hljs-title class_">Annotation</span>({ <span class="hljs-attr">reducer</span>: <span class="hljs-function">(<span class="hljs-params">_, x</span>) =&gt;</span> x, <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">""</span> }),
});

<span class="hljs-comment">// 2. å®šä¹‰èŠ‚ç‚¹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myNode</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">output</span>: <span class="hljs-string">"processed"</span> };
}

<span class="hljs-comment">// 3. å®šä¹‰è·¯ç”±</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myRouter</span>(<span class="hljs-params">state</span>) {
  <span class="hljs-keyword">return</span> state.<span class="hljs-property">output</span> ? <span class="hljs-string">"end"</span> : <span class="hljs-string">"continue"</span>;
}

<span class="hljs-comment">// 4. æ„å»ºå›¾</span>
<span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateGraph</span>(<span class="hljs-title class_">MyState</span>)
  .<span class="hljs-title function_">addNode</span>(<span class="hljs-string">"myNode"</span>, myNode)
  .<span class="hljs-title function_">addEdge</span>(<span class="hljs-variable constant_">START</span>, <span class="hljs-string">"myNode"</span>)
  .<span class="hljs-title function_">addConditionalEdges</span>(<span class="hljs-string">"myNode"</span>, myRouter, {
    <span class="hljs-attr">continue</span>: <span class="hljs-string">"myNode"</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-variable constant_">END</span>,
  });

<span class="hljs-comment">// 5. ç¼–è¯‘æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> app = graph.<span class="hljs-title function_">compile</span>();
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">input</span>: <span class="hljs-string">"hello"</span> });
</code></pre>
<hr/>
<h2 data-id="heading-51">ğŸ“– å­¦ä¹ èµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flangchain-ai.github.io%2Flanggraphjs%2F" target="_blank" title="https://langchain-ai.github.io/langgraphjs/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Flanggraphjs" target="_blank" title="https://github.com/langchain-ai/langgraphjs" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a></li>
<li>LangGraph Studioï¼šå¯è§†åŒ–è°ƒè¯•å·¥å…·</li>
</ul>
<hr/>
<h2 data-id="heading-52">å†™åœ¨æœ€å</h2>
<p>LangGraph çš„æ ¸å¿ƒå°±æ˜¯<strong>ç”¨ã€Œç”»æµç¨‹å›¾ã€çš„æ€ç»´æ¥æ„å»º AI åº”ç”¨</strong>ã€‚æŒæ¡äº† Stateã€Nodeã€Edge è¿™ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œä½ å°±èƒ½æ„å»ºå„ç§å¤æ‚çš„ AI å·¥ä½œæµã€‚</p>
<p><strong>å­¦ä¹ å»ºè®®</strong>ï¼š</p>
<ol>
<li>å…ˆä»ç®€å•çš„ä¸²è¡Œæµç¨‹å¼€å§‹</li>
<li>é€æ­¥æ·»åŠ æ¡ä»¶åˆ†æ”¯</li>
<li>æœ€åå®ç°å®Œæ•´çš„ ReAct Agent</li>
</ol>
<p>æ¯ä¸€æ­¥éƒ½è¿è¡Œä»£ç ï¼Œè§‚å¯ŸçŠ¶æ€çš„å˜åŒ–ï¼Œä½ ä¼šå¾ˆå¿«ä¸Šæ‰‹ï¼</p>
<hr/>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿<strong>ç‚¹èµ ğŸ‘ æ”¶è— â­ å…³æ³¨</strong>ï¼Œåç»­è¿˜ä¼šåˆ†äº«æ›´å¤š AI å¼€å‘å¹²è´§ï¼</p>
<p>æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºäº¤æµ~ ğŸ‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAG + Agent + Promptå·¥ç¨‹ä¸­]]></title>    <link>https://juejin.cn/post/7579438351296839716</link>    <guid>https://juejin.cn/post/7579438351296839716</guid>    <pubDate>2025-12-03T08:33:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579438351296839716" data-draft-id="7578948893762273307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAG + Agent + Promptå·¥ç¨‹ä¸­"/> <meta itemprop="keywords" content="Docker,AIGC,LLM"/> <meta itemprop="datePublished" content="2025-12-03T08:33:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å›½å®¶ä¸ä¿æŠ¤åºŸç‰©"/> <meta itemprop="url" content="https://juejin.cn/user/1220936035210004"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAG + Agent + Promptå·¥ç¨‹ä¸­
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1220936035210004/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å›½å®¶ä¸ä¿æŠ¤åºŸç‰©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:33:26.000Z" title="Wed Dec 03 2025 08:33:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RAG + Agent + Prompt å·¥ç¨‹ä¸­ï¼šæ­å»ºæœ¬åœ°å‘é‡æ•°æ®åº“Qdrantã€æ–‡æ¡£å¤„ç†ä¸å¤šè¯­è¨€æ”¯æŒå›½é™…åŒ–</h2>
<blockquote>
<p>æœ¬æ–‡æ˜¯ <strong>RAG ç³»ç»Ÿå®æˆ˜ç³»åˆ—</strong> çš„ä¸­é—´ç¯‡ã€‚åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† RAG çš„åŸºæœ¬åŸç†å’Œ LangChain çš„æ ¸å¿ƒæ¦‚å¿µã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥å®æˆ˜ç¯èŠ‚â€”â€”æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•æ­å»ºæœ¬åœ°å‘é‡æ•°æ®åº“ï¼ˆQdrantï¼‰ï¼Œå¹¶é‡ç‚¹è®²è§£ <strong>æ–‡æ¡£é¢„å¤„ç†æµç¨‹</strong> å’Œ <strong>å¤šè¯­è¨€å›½é™…åŒ–æ”¯æŒ</strong> çš„å®Œæ•´å®ç°æ–¹æ¡ˆã€‚</p>
<p>é™„ä¸Šé¡¹ç›®æºä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flhlhlhlhl%2Fassessment-rag" target="_blank" title="https://github.com/lhlhlhlhl/assessment-rag" ref="nofollow noopener noreferrer">lhlhlhlhl/assessment-rag</a></p>
</blockquote>
<hr/>
<h3 data-id="heading-1">å‰è¨€ï¼šä¸ºä»€ä¹ˆå‘é‡æ•°æ®åº“å¦‚æ­¤é‡è¦ï¼Ÿ</h3>
<p>åœ¨ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿä¸­ï¼Œ<strong>å‘é‡æ•°æ®åº“</strong> æ˜¯è¿æ¥â€œç”¨æˆ·é—®é¢˜â€ä¸â€œçŸ¥è¯†åº“å†…å®¹â€çš„æ¡¥æ¢ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li>å°†ä½ çš„æ–‡æ¡£å†…å®¹è½¬æ¢ä¸ºé«˜ç»´å‘é‡ï¼ˆå³â€œåµŒå…¥â€ï¼‰</li>
<li>å¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·æé—®è¯­ä¹‰æœ€ç›¸è¿‘çš„å‡ æ®µæ–‡æœ¬</li>
<li>ä¸ºå¤§æ¨¡å‹æä¾›ç²¾å‡†çš„ä¸Šä¸‹æ–‡ï¼Œä»è€Œç”Ÿæˆé«˜è´¨é‡å›ç­”</li>
</ul>
<p>æ²¡æœ‰é«˜æ•ˆçš„å‘é‡å­˜å‚¨å’Œæ£€ç´¢æœºåˆ¶ï¼ŒRAG å°±å¤±å»äº†â€œå¢å¼ºâ€çš„æ„ä¹‰ã€‚</p>
<p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹© <strong>Qdrant</strong> ä½œä¸ºæœ¬åœ°å‘é‡æ•°æ®åº“ï¼Œå¹¶å›´ç»•å®ƒæ„å»ºäº†ä¸€å¥—å®Œæ•´çš„æ–‡æ¡£å¤„ç† + å¤šè¯­è¨€æ”¯æŒä½“ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€å‘é‡æ•°æ®åº“é€‰å‹ï¼šä¸ºä»€ä¹ˆæ˜¯ Qdrantï¼Ÿ</h3>
<p>å¸‚é¢ä¸Šæœ‰ Pineconeã€Weaviateã€Milvusã€FAISS ç­‰å¤šç§å‘é‡æ•°æ®åº“ï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº† <strong>Qdrant</strong>ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>





























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ğŸš€ <strong>é«˜æ€§èƒ½</strong></td><td>ç”¨ Rust ç¼–å†™ï¼Œå†…å­˜æ•ˆç‡é«˜ï¼Œå•æœºæ¯ç§’å¯å¤„ç†æ•°åƒæ¬¡æŸ¥è¯¢</td></tr><tr><td>ğŸ“¦ <strong>è½»é‡æ˜“éƒ¨ç½²</strong></td><td>æ”¯æŒ Docker ä¸€é”®å¯åŠ¨ï¼Œä¹Ÿæ”¯æŒäºŒè¿›åˆ¶ç›´æ¥è¿è¡Œ</td></tr><tr><td>ğŸ” <strong>æ”¯æŒå…ƒæ•°æ®è¿‡æ»¤</strong></td><td>ä¸ä»…èƒ½æŒ‰å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œè¿˜èƒ½ç»“åˆæ ‡ç­¾ã€æ¥æºç­‰æ¡ä»¶ç­›é€‰</td></tr><tr><td>ğŸŒ <strong>åŒåè®®æ”¯æŒ</strong></td><td>åŒæ—¶æä¾› RESTful API å’Œ gRPC æ¥å£ï¼Œé€‚é…ä¸åŒåœºæ™¯</td></tr><tr><td>ğŸ†“ <strong>å¼€æºå…è´¹</strong></td><td>ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„ï¼Œé€‚åˆæœ¬åœ°å¼€å‘å’Œä¸­å°è§„æ¨¡ç”Ÿäº§</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-3">äºŒã€ä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼šDocker vs ç›´æ¥å®‰è£…</h3>
<h4 data-id="heading-4">æ–¹æ¡ˆä¸€ï¼šæ¨èï¼ä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²ï¼ˆå¼€å‘é¦–é€‰ï¼‰</h4>
<h5 data-id="heading-5">1. åˆ›å»º <code>docker-compose.yml</code></h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">qdrant:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">qdrant/qdrant:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">smart_assessment_qdrant</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6333:6333"</span>  <span class="hljs-comment"># REST API ç«¯å£</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6334:6334"</span>  <span class="hljs-comment"># gRPC ç«¯å£ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./qdrant_storage:/qdrant/storage</span>  <span class="hljs-comment"># æŒä¹…åŒ–æ•°æ®</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">QDRANT__SERVICE__GRPC_PORT=6334</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">rag_network</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">rag_network:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>volumes</code> å°†æœ¬åœ° <code>qdrant_storage/</code> ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œ<strong>å³ä½¿åˆ é™¤å®¹å™¨ï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±</strong></li>
<li><code>restart: unless-stopped</code> ä¿è¯æœåŠ¡å´©æºƒåè‡ªåŠ¨é‡å¯</li>
<li>è‡ªå®šä¹‰ç½‘ç»œ <code>rag_network</code> ä¾¿äºæœªæ¥æ‰©å±•ï¼ˆå¦‚åŠ å…¥ LLM æœåŠ¡ï¼‰</li>
</ul>
</blockquote>
<h5 data-id="heading-6">2. å¯åŠ¨æœåŠ¡</h5>
<pre><code class="hljs">docker-compose up -d
</code></pre>
<h5 data-id="heading-7">3. éªŒè¯æ˜¯å¦æˆåŠŸ</h5>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:6333/collections
</code></pre>
<p>å¦‚æœè¿”å› <code>{"result":{"collections":[]},"status":"ok"}</code>ï¼Œè¯´æ˜ Qdrant å·²æ­£å¸¸è¿è¡Œï¼</p>
<hr/>
<h4 data-id="heading-8">æ–¹æ¡ˆäºŒï¼šé Docker å®‰è£…ï¼ˆé€‚åˆæ—  Docker ç¯å¢ƒï¼‰</h4>
<h5 data-id="heading-9">Windows ç”¨æˆ·ï¼š</h5>
<ol>
<li>
<p>ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fqdrant%2Fqdrant%2Freleases" target="_blank" title="https://github.com/qdrant/qdrant/releases" ref="nofollow noopener noreferrer">GitHub Releases</a> ä¸‹è½½ <code>qdrant-windows-x86_64.zip</code></p>
</li>
<li>
<p>è§£å‹åè¿è¡Œï¼š</p>
<pre><code class="hljs">.\qdrant.exe
</code></pre>
</li>
</ol>
<h5 data-id="heading-10">Linux/macOS ç”¨æˆ·ï¼š</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³•1ï¼šAPT å®‰è£…ï¼ˆUbuntu/Debianï¼‰</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"deb [trusted=yes] https://apt.qdrant.io stable main"</span> | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/qdrant.list
sudo apt update &amp;&amp; sudo apt install qdrant

<span class="hljs-comment"># æ–¹æ³•2ï¼šç›´æ¥ä¸‹è½½äºŒè¿›åˆ¶</span>
wget https://github.com/qdrant/qdrant/releases/latest/download/qdrant-linux-x86_64.tar.gz
tar xzf qdrant-linux-x86_64.tar.gz
./qdrant
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šé Docker æ–¹å¼éœ€è¦æ‰‹åŠ¨ç®¡ç†é…ç½®ã€æ—¥å¿—å’Œæ•°æ®ç›®å½•ï¼Œ<strong>å¼ºçƒˆå»ºè®®å¼€å‘é˜¶æ®µä½¿ç”¨ Docker</strong>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-11">âœ… ä¸ºä»€ä¹ˆæˆ‘ä»¬æ¨è Dockerï¼Ÿ</h4>



































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>ç›´æ¥å®‰è£…</th><th>Docker</th></tr></thead><tbody><tr><td>å®‰è£…å¤æ‚åº¦</td><td>é«˜ï¼ˆéœ€å¤„ç†ä¾èµ–ã€è·¯å¾„ã€æƒé™ï¼‰</td><td>æä½ï¼ˆä¸€æ¡å‘½ä»¤ï¼‰</td></tr><tr><td>è·¨å¹³å°ä¸€è‡´æ€§</td><td>å·®ï¼ˆWindows/Linux è¡Œä¸ºå¯èƒ½ä¸åŒï¼‰</td><td>å®Œç¾ä¸€è‡´</td></tr><tr><td>æ•°æ®éš”ç¦»</td><td>æ— ï¼ˆæ–‡ä»¶æ•£è½åœ¨ç³»ç»Ÿå„å¤„ï¼‰</td><td>å®Œå…¨éš”ç¦»</td></tr><tr><td>ç‰ˆæœ¬åˆ‡æ¢</td><td>å›°éš¾</td><td>ä¿®æ”¹é•œåƒæ ‡ç­¾å³å¯</td></tr><tr><td>å¸è½½æ¸…ç†</td><td>å®¹æ˜“æ®‹ç•™</td><td><code>docker-compose down -v</code> ä¸€é”®æ¸…ç©º</td></tr></tbody></table>
<blockquote>
<p>ğŸ§© <strong>æ‰“ä¸ªæ¯”æ–¹</strong>ï¼š<br/>
ç›´æ¥å®‰è£…å°±åƒåœ¨å®¢å…é‡Œæ­å¸ç¯·â€”â€”å åœ°æ–¹ã€éš¾æ”¶æ‹¾ï¼›<br/>
Docker å°±åƒä¹°äº†ä¸€ä¸ªå¸¦è½®å­çš„é›†è£…ç®±â€”â€”éšæ—¶ç§»åŠ¨ã€å¹²å‡€æ•´æ´ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-12">ä¸‰ã€è¿æ¥ Qdrantï¼šä»£ç å®ç°è¯¦è§£</h3>
<p>æ— è®ºé‡‡ç”¨å“ªç§éƒ¨ç½²æ–¹å¼ï¼Œæˆ‘ä»¬çš„ JavaScript ä»£ç è¿æ¥é€»è¾‘å®Œå…¨ä¸€è‡´ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒç±» <code>QdrantVectorStoreManager</code> çš„ç²¾è¦è§£è¯»ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// åˆå§‹åŒ–å®¢æˆ·ç«¯</span>
<span class="hljs-keyword">this</span>.client = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QdrantClient</span>({
  url: `http:<span class="hljs-comment">//${config.QDRANT_HOST}:${config.QDRANT_PORT}`,</span>
  timeout: <span class="hljs-number">30000</span>,
});

<span class="hljs-comment">// ä½¿ç”¨ Qwen å…¼å®¹ OpenAI çš„ Embedding æ¨¡å‹</span>
<span class="hljs-keyword">this</span>.embeddings = <span class="hljs-keyword">new</span> <span class="hljs-built_in">OpenAIEmbeddings</span>({
  openAIApiKey: config.QWEN_API_KEY,
  modelName: config.EMBEDDING_MODEL,
  configuration: { baseURL: config.QWEN_API_BASE }
});
</code></pre>
<blockquote>
<p>ğŸ”‘ <strong>å…³é”®ç‚¹</strong>ï¼šè™½ç„¶ç”¨äº† <code>OpenAIEmbeddings</code>ï¼Œä½†é€šè¿‡ <code>baseURL</code> æŒ‡å‘ Qwen çš„ APIï¼Œå®ç°äº†â€œç”¨ OpenAI æ¥å£è°ƒ Qwen æ¨¡å‹â€ã€‚</p>
</blockquote>
<p>åç»­çš„ <code>initCollection()</code>ã€<code>addDocuments()</code>ã€<code>search()</code> ç­‰æ–¹æ³•å°è£…äº†é›†åˆåˆ›å»ºã€æ–‡æ¡£æ’å…¥å’Œç›¸ä¼¼æ£€ç´¢ï¼Œ<strong>å®Œå…¨å…¼å®¹ LangChain ç”Ÿæ€</strong>ï¼Œå¯ç›´æ¥ç”¨äº RAG é“¾ã€‚</p>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/449cb55a1935432bbed7a882c9e24a31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765355605&amp;x-signature=sIi5dTAnFRTd5%2F9wwQDOapC%2FXH8%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-13">å››ã€æ–‡æ¡£å¤„ç†ï¼šä»åŸå§‹æ–‡ä»¶åˆ°å‘é‡å­˜å‚¨</h3>
<p>è¿™æ˜¯ RAG æ•ˆæœå¥½åçš„å…³é”®ï¼å¾ˆå¤šåˆå­¦è€…ç›´æ¥æŠŠæ•´ç¯‡æ–‡æ¡£ä¸¢è¿›å»ï¼Œç»“æœæ£€ç´¢æ•ˆæœå¾ˆå·®ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ <strong>â€œåˆ†å— + åµŒå…¥ + å­˜å‚¨â€</strong> ã€‚</p>
<h4 data-id="heading-14">æ­¥éª¤ 1ï¸âƒ£ï¼šåŠ è½½æ–‡æ¡£ï¼ˆæ”¯æŒ Markdownï¼‰</h4>
<p>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª <code>DocumentLoader</code> ç±»ï¼Œä¸“é—¨ç”¨äºé€’å½’æ‰«æ <code>docs/</code> ç›®å½•ä¸‹çš„æ‰€æœ‰ <code>.md</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é€’å½’æŸ¥æ‰¾æ‰€æœ‰ .md æ–‡ä»¶</span>
<span class="hljs-built_in">findMarkdownFiles</span>(dirPath) {
  const files = <span class="hljs-selector-attr">[]</span>;
  const items = fs<span class="hljs-selector-class">.readdirSync</span>(dirPath);
  for (const item of items) {
    const itemPath = path<span class="hljs-selector-class">.join</span>(dirPath, item);
    if (fs.statSync(itemPath)<span class="hljs-selector-class">.isDirectory</span>()) {
      files<span class="hljs-selector-class">.push</span>(...this.findMarkdownFiles(itemPath)); <span class="hljs-comment">// é€’å½’</span>
    } else if (path.extname(item) === '<span class="hljs-selector-class">.md</span>') {
      files<span class="hljs-selector-class">.push</span>(itemPath);
    }
  }
  return files;
}
</code></pre>
<p>æ¯ä¸ªæ–‡æ¡£è¢«å°è£…ä¸ºä¸€ä¸ª <code>Document</code> å¯¹è±¡ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><code>content</code>ï¼šæ–‡ä»¶å…¨æ–‡</li>
<li><code>metadata</code>ï¼šæ¥æºè·¯å¾„ã€æ–‡ä»¶åã€åŠ è½½æ—¶é—´ç­‰</li>
</ul>
<hr/>
<h4 data-id="heading-15">æ­¥éª¤ 2ï¸âƒ£ï¼šæ™ºèƒ½æ–‡æœ¬åˆ†å‰²ï¼ˆé‡ä¸­ä¹‹é‡ï¼ï¼‰</h4>
<p><strong>ä¸ºä»€ä¹ˆä¸èƒ½æ•´ç¯‡å­˜ï¼Ÿ</strong><br/>
å› ä¸ºå¤§æ¨¡å‹æœ‰ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ï¼ˆå¦‚ 8192 tokensï¼‰ï¼Œè€Œä¸”é•¿æ–‡æœ¬åµŒå…¥ä¼šä¸¢å¤±å±€éƒ¨è¯­ä¹‰ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ LangChain çš„ <code>RecursiveCharacterTextSplitter</code>ï¼Œå¹¶<strong>é’ˆå¯¹ä¸­æ–‡åšäº†ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">new</span> RecursiveCharacterTextSplitter({
  chunkSize: <span class="hljs-number">500</span>,        <span class="hljs-comment">// æ¯å—çº¦ 500 å­—ç¬¦</span>
  chunkOverlap: <span class="hljs-number">50</span>,      <span class="hljs-comment">// ç›¸é‚»å—é‡å  50 å­—ï¼Œé¿å…æ–­å¥</span>
  separators: [
    <span class="hljs-string">'\n\n'</span>,   <span class="hljs-comment">// ä¼˜å…ˆæŒ‰æ®µè½åˆ‡</span>
    <span class="hljs-string">'\n'</span>,
    <span class="hljs-string">'ã€‚'</span>, <span class="hljs-string">'ï¼'</span>, <span class="hljs-string">'ï¼Ÿ'</span>,  <span class="hljs-comment">// ä¸­æ–‡å¥å·ã€æ„Ÿå¹å·ã€é—®å·</span>
    <span class="hljs-string">'ï¼›'</span>, <span class="hljs-string">'ï¼Œ'</span>,         <span class="hljs-comment">// åˆ†å·ã€é€—å·</span>
    <span class="hljs-string">' '</span>,                <span class="hljs-comment">// è‹±æ–‡ç©ºæ ¼</span>
    <span class="hljs-string">''</span>                  <span class="hljs-comment">// æœ€åæŒ‰å­—ç¬¦åˆ‡</span>
  ]
})
</code></pre>
<blockquote>
<p>ğŸŒŸ <strong>æ•ˆæœç¤ºä¾‹</strong>ï¼š<br/>
åŸæ–‡ï¼šâ€œQwen æ˜¯é˜¿é‡Œå·´å·´æ¨å‡ºçš„ AI æ¨¡å‹ã€‚å®ƒæ”¯æŒå¤šè¯­è¨€ã€‚â€<br/>
â†’ åˆ‡åˆ†ä¸ºä¸¤å—ï¼š<br/>
å—1ï¼šâ€œQwen æ˜¯é˜¿é‡Œå·´å·´æ¨å‡ºçš„ AI æ¨¡å‹ã€‚â€<br/>
å—2ï¼šâ€œå®ƒæ”¯æŒå¤šè¯­è¨€ã€‚â€</p>
</blockquote>
<p>è¿™æ ·æ—¢èƒ½ä¿æŒè¯­ä¹‰å®Œæ•´ï¼Œåˆé¿å…è·¨å¥åˆ‡å‰²ã€‚</p>
<hr/>
<h4 data-id="heading-16">æ­¥éª¤ 3ï¸âƒ£ï¼šå‘é‡åŒ– &amp; å­˜å…¥ Qdrant</h4>
<p>è¿™ä¸€æ­¥ç”± <code>QdrantVectorStore.addDocuments()</code> è‡ªåŠ¨å®Œæˆï¼š</p>
<ol>
<li>è°ƒç”¨ <code>embeddings.embedDocuments()</code> ç”Ÿæˆå‘é‡</li>
<li>å°† <code>[å‘é‡, æ–‡æœ¬, å…ƒæ•°æ®]</code> ä½œä¸ºâ€œç‚¹ï¼ˆPointï¼‰â€å­˜å…¥ Qdrant</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹å¯¹å¼€å‘è€…é€æ˜ï¼Œä½ åªéœ€ä¼ å…¥ <code>Document[]</code> å³å¯ã€‚</p>
<hr/>
<h3 data-id="heading-17">äº”ã€å›½é™…åŒ–ï¼ˆi18nï¼‰ï¼šè®©ç³»ç»Ÿæ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢</h3>
<p>ä¸ºäº†è®©é¡¹ç›®æ›´ä¸“ä¸šã€æ›´æ˜“ç”¨ï¼Œæˆ‘ä»¬åŠ å…¥äº†å®Œæ•´çš„å¤šè¯­è¨€æ”¯æŒã€‚</p>
<h4 data-id="heading-18">1. æŠ€æœ¯é€‰å‹ï¼ši18next + JSON èµ„æºæ–‡ä»¶</h4>
<ul>
<li><strong>i18next</strong>ï¼šä¸šç•Œæ ‡å‡†çš„ JS å›½é™…åŒ–åº“</li>
<li><strong>JSON æ–‡ä»¶</strong>ï¼šæŒ‰è¯­è¨€åˆ†ç±»å­˜å‚¨ç¿»è¯‘æ–‡æœ¬ï¼Œç»“æ„æ¸…æ™°</li>
</ul>
<p>ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src/i18n/
â”œâ”€â”€ index.js              <span class="hljs-comment"># å›½é™…åŒ–ç®¡ç†å™¨</span>
â””â”€â”€ locales/
    â”œâ”€â”€ en/translation.json
    â””â”€â”€ zh-CN/translation.json
</code></pre>
<hr/>
<h4 data-id="heading-19">2. æ ¸å¿ƒï¼šI18nManager å•ä¾‹ç±»</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">I18nManager</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">language = <span class="hljs-string">'en'</span></span>) {
    <span class="hljs-keyword">await</span> i18next.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Backend</span>).<span class="hljs-title function_">init</span>({
      <span class="hljs-attr">lng</span>: language,
      <span class="hljs-attr">fallbackLng</span>: <span class="hljs-string">'en'</span>,
      <span class="hljs-attr">backend</span>: {
        <span class="hljs-attr">loadPath</span>: <span class="hljs-string">'./locales/{{lng}}/translation.json'</span>
      }
    });
  }

  <span class="hljs-title function_">t</span>(<span class="hljs-params">key, options = {}</span>) {
    <span class="hljs-keyword">return</span> i18next.<span class="hljs-title function_">t</span>(key, options); <span class="hljs-comment">// å¦‚ t('messages.loading_docs', { count: 5 })</span>
  }

  <span class="hljs-title function_">getPreferredLanguage</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. è¯»å–ç³»ç»Ÿç¯å¢ƒå˜é‡ LANG</span>
    <span class="hljs-comment">// 2. è‡ªåŠ¨åŒ¹é…æ”¯æŒçš„è¯­è¨€ï¼ˆå¦‚ zh_CN â†’ zh-CNï¼‰</span>
    <span class="hljs-comment">// 3. é»˜è®¤å›é€€åˆ°è‹±æ–‡</span>
  }
}
</code></pre>
<blockquote>
<p>âœ… <strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ”¯æŒæ’å€¼ï¼ˆå¦‚ <code>{{count}}</code>ï¼‰</li>
<li>è‡ªåŠ¨è¯­è¨€æ£€æµ‹</li>
<li>æœªç¿»è¯‘æ—¶å›é€€åˆ°è‹±æ–‡</li>
</ul>
</blockquote>
<hr/>
<h4 data-id="heading-20">3. ç¿»è¯‘æ–‡ä»¶ç¤ºä¾‹ï¼ˆzh-CN/translation.jsonï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"document_loader"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"loading_all_docs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­£åœ¨åŠ è½½æ‰€æœ‰æ–‡æ¡£..."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"loaded_doc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å·²åŠ è½½æ–‡æ¡£: {{path}}"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"error_loading_doc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"åŠ è½½æ–‡æ¡£å¤±è´¥ {{path}}: {{error}}"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text_splitter"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"splitting_docs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­£åœ¨åˆ†å‰²æ–‡æ¡£..."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"split_doc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ–‡æ¡£ {{path}} å·²åˆ†å‰²ä¸º {{count}} ä¸ªå—"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"vector_store"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"creating_collection"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­£åœ¨åˆ›å»ºé›†åˆ: {{name}}"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"collection_exists"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é›†åˆ {{name}} å·²å­˜åœ¨"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"adding_batch"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­£åœ¨æ·»åŠ  {{count}} ä¸ªæ–‡æ¡£å—..."</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h4 data-id="heading-21">4. åœ¨ä»£ç ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// åˆå§‹åŒ–ï¼ˆè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¯­è¨€ï¼‰</span>
<span class="hljs-selector-tag">await</span> <span class="hljs-selector-tag">i18nManager</span><span class="hljs-selector-class">.init</span>(i18nManager.<span class="hljs-built_in">getPreferredLanguage</span>());

<span class="hljs-comment">// æ‰“å°æ—¥å¿—</span>
<span class="hljs-selector-tag">console</span><span class="hljs-selector-class">.log</span>(i18nManager.<span class="hljs-built_in">t</span>(<span class="hljs-string">'vector_store.adding_batch'</span>, { <span class="hljs-attribute">count</span>: docs.length }));
</code></pre>
<h4 data-id="heading-22">5. å‘½ä»¤è¡Œæ”¯æŒè¯­è¨€åˆ‡æ¢</h4>
<pre><code class="hljs language-sql" lang="sql"># é»˜è®¤æ ¹æ®ç³»ç»Ÿè¯­è¨€è‡ªåŠ¨é€‰æ‹©
npm run <span class="hljs-keyword">start</span>

# å¼ºåˆ¶ä½¿ç”¨ä¸­æ–‡
npm run <span class="hljs-keyword">start</span> <span class="hljs-comment">-- -l zh-CN</span>

# å¼ºåˆ¶ä½¿ç”¨è‹±æ–‡
npm run <span class="hljs-keyword">start</span> <span class="hljs-comment">-- -l en</span>
</code></pre>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f39b7f81047f4e05ab9b5d5cf0ed2c46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765355605&amp;x-signature=GUyrDfQaK%2F8IVToTT1Hxn%2FXJn04%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>ğŸŒ <strong>ç”¨æˆ·ä½“éªŒæå‡</strong>ï¼šéè‹±è¯­ç”¨æˆ·ä¸å†é¢å¯¹æ»¡å±è‹±æ–‡æŠ¥é”™ï¼Œå¤§å¤§é™ä½ä½¿ç”¨é—¨æ§›ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-23">å…­ã€å®Œæ•´æµç¨‹ï¼šä»é›¶åˆå§‹åŒ–åˆ°äº¤äº’é—®ç­”</h3>
<p>æ•´ä¸ªç³»ç»Ÿå¯åŠ¨æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>éªŒè¯é…ç½®</strong> â†’ 2. <strong>åŠ è½½æ–‡æ¡£</strong> â†’ 3. <strong>æ™ºèƒ½åˆ†å—</strong> â†’ 4. <strong>è¿æ¥ Qdrant</strong> â†’ 5. <strong>æ‰¹é‡å‘é‡åŒ–å­˜å‚¨</strong></li>
</ol>

<pre><code class="hljs language-css" lang="css">graph LR
<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[éªŒè¯é…ç½®]</span> --&gt; <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[åŠ è½½ docs/ ä¸‹æ‰€æœ‰ .md æ–‡ä»¶]</span>
<span class="hljs-selector-tag">B</span> --&gt; C<span class="hljs-selector-attr">[æŒ‰è¯­ä¹‰åˆ†å‰²ä¸ºå°å—]</span>
C --&gt; D<span class="hljs-selector-attr">[è¿æ¥ Qdrant]</span>
D --&gt; E<span class="hljs-selector-attr">[ç”Ÿæˆå‘é‡å¹¶å­˜å…¥]</span>
E --&gt; F<span class="hljs-selector-attr">[å¯åŠ¨äº¤äº’å¼é—®ç­”]</span>
</code></pre>
<p>åœ¨é—®ç­”é˜¶æ®µï¼Œç”¨æˆ·è¾“å…¥é—®é¢˜åï¼š</p>
<ul>
<li>ç³»ç»Ÿå°†é—®é¢˜å‘é‡åŒ–</li>
<li>åœ¨ Qdrant ä¸­æ£€ç´¢ Top-K ç›¸ä¼¼å—</li>
<li>å°†ç»“æœ + åŸå§‹é—®é¢˜äº¤ç»™ LLM ç”Ÿæˆç­”æ¡ˆ</li>
<li>è¿”å›ç­”æ¡ˆ + æ¥æºå¼•ç”¨ï¼ˆå«ç›¸ä¼¼åº¦åˆ†æ•°ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-24">æ€»ç»“</h3>
<p>æœ¬æ–‡æˆ‘ä»¬å®Œæˆäº† RAG ç³»ç»Ÿçš„ä¸‰å¤§æ ¸å¿ƒæ¨¡å—ï¼š</p>
<p>âœ… <strong>å‘é‡æ•°æ®åº“æ­å»º</strong>ï¼šé€šè¿‡ Docker å¿«é€Ÿéƒ¨ç½² Qdrantï¼Œå…¼é¡¾æ€§èƒ½ä¸ä¾¿æ·æ€§<br/>
âœ… <strong>æ–‡æ¡£æ™ºèƒ½å¤„ç†</strong>ï¼šä»åŠ è½½ã€ä¸­æ–‡å‹å¥½åˆ†å—åˆ°å‘é‡åŒ–ï¼Œç¡®ä¿æ£€ç´¢è´¨é‡<br/>
âœ… <strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šåŸºäº i18next å®ç°ä¸­è‹±æ–‡æ— ç¼åˆ‡æ¢ï¼Œæå‡å¯ç”¨æ€§</p>
<p>è¿™äº›å·¥ä½œä¸ºåç»­çš„ <strong>Agent å†³ç­–ã€Prompt ä¼˜åŒ–ã€è¯„ä¼°æŒ‡æ ‡</strong> ç­‰é«˜çº§åŠŸèƒ½æ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚ï¼ˆå¦‚æœæƒ³çœ‹å®Œæ•´ä»£ç å¯åˆ°å¼€å¤´å±•ç¤ºçš„ä»£ç ä»“åº“ä¸­æŸ¥çœ‹ï¼Œé‡Œé¢åŒ…å«ragè°ƒç”¨çš„å®Œæ•´ä»£ç ï¼‰</p>
<blockquote>
<p>ğŸ“Œ <strong>ä¸‹æœŸé¢„å‘Š</strong>ï¼šæˆ‘ä»¬å°†ä½¿ç”¨ragå»åšä¸€ä¸ªæ³•å¾‹æ£€ç´¢çš„ä¸“ä¸šaié—®ç­”åŠ©æ‰‹ï¼Œä½¿ç”¨çˆ¬è™«æŠ€æœ¯å»å®Œå–„æˆ‘ä»¬çš„æ•°æ®åº“ï¼Œé‡‡ç”¨æµå¼è¾“å‡ºå»å±•ç¤ºæˆ‘ä»¬çš„ä»£ç ï¼Œå°†åç«¯ragæŠ€æœ¯ä¸å‰ç«¯é¡µé¢ç»“åˆèµ·æ¥ã€‚</p>
</blockquote>
<hr/>
<p><strong>é™„ï¼šå¸¸è§é—®é¢˜</strong></p>
<p>â“<strong>Qï¼šä¸ºä»€ä¹ˆä¸ç”¨ FAISSï¼Ÿ</strong><br/>
â†’ FAISS æ˜¯çº¯å‘é‡åº“ï¼Œæ— æŒä¹…åŒ–ã€æ— è¿‡æ»¤ã€æ—  APIï¼Œé€‚åˆå®éªŒï¼›Qdrant æ˜¯å®Œæ•´æ•°æ®åº“ï¼Œé€‚åˆäº§å“ã€‚</p>
<p>â“<strong>Qï¼šåˆ†å—å¤§å°æ€ä¹ˆé€‰ï¼Ÿ</strong><br/>
â†’ ä¸­æ–‡å»ºè®® 300â€“800 å­—ç¬¦ï¼Œè‹±æ–‡ 200â€“500 tokensã€‚å¯é€šè¿‡ <code>CHUNK_SIZE</code> é…ç½®è°ƒæ•´ã€‚</p>
<p>â“<strong>Qï¼šQwen çš„ embedding ç»´åº¦æ˜¯å¤šå°‘ï¼Ÿ</strong><br/>
â†’ <code>text-embedding-v2</code> è¾“å‡º <strong>1536 ç»´</strong>ï¼ŒåŠ¡å¿…åœ¨ <code>config.EMBEDDING_DIMENSION</code> ä¸­æ­£ç¡®è®¾ç½®ï¼</p>
<hr/>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ å°‘èµ°å¼¯è·¯ï¼Œå¿«é€Ÿæ­å»ºå‡ºè‡ªå·±çš„ RAG ç³»ç»Ÿï¼æ¬¢è¿ç‚¹èµã€æ”¶è—ã€è¯„è®ºäº¤æµ ğŸ‘‡ ```</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ–‡ä»¶ç®¡ç†ç³»åˆ—ã€‘001ï¼šæ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·]]></title>    <link>https://juejin.cn/post/7579321624013996072</link>    <guid>https://juejin.cn/post/7579321624013996072</guid>    <pubDate>2025-12-03T08:20:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579321624013996072" data-draft-id="7579313396206993423" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ–‡ä»¶ç®¡ç†ç³»åˆ—ã€‘001ï¼šæ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·"/> <meta itemprop="keywords" content="åç«¯,Shell"/> <meta itemprop="datePublished" content="2025-12-03T08:20:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¶æ—¥å¤±çœ è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3411111810444068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ–‡ä»¶ç®¡ç†ç³»åˆ—ã€‘001ï¼šæ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411111810444068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¶æ—¥å¤±çœ è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:20:45.000Z" title="Wed Dec 03 2025 08:20:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç®€ä»‹</h2>
<p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹å¤§é‡æ–‡ä»¶è¿›è¡Œé‡å‘½åæ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨æ•´ç†ç…§ç‰‡ã€æ–‡æ¡£æˆ–å…¶ä»–åª’ä½“æ–‡ä»¶æ—¶ã€‚æ‰‹åŠ¨ä¸€ä¸ªä¸ªé‡å‘½åä¸ä»…è€—æ—¶ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸€ä¸ªå®ç”¨çš„Pythonè„šæœ¬â€”â€”æ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·ï¼Œå®ƒå¯ä»¥å¤§å¤§æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚</p>
<h2 data-id="heading-1">åŠŸèƒ½ä»‹ç»</h2>
<p>è¿™ä¸ªæ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·å…·æœ‰ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ol>
<li><strong>æ‰¹é‡é‡å‘½å</strong>ï¼šå¯ä»¥åŒæ—¶å¯¹å¤šä¸ªæ–‡ä»¶æŒ‰ç…§æŒ‡å®šè§„åˆ™è¿›è¡Œé‡å‘½å</li>
<li><strong>å¤šç§å‘½åæ¨¡å¼</strong>ï¼šæ”¯æŒåºå·å‘½åã€å‰ç¼€å‘½åã€åç¼€å‘½åç­‰å¤šç§æ¨¡å¼</li>
<li><strong>æ–‡ä»¶è¿‡æ»¤</strong>ï¼šå¯ä»¥æ ¹æ®æ–‡ä»¶æ‰©å±•åã€æ–‡ä»¶åç‰¹å¾ç­‰æ¡ä»¶ç­›é€‰æ–‡ä»¶</li>
<li><strong>é¢„è§ˆåŠŸèƒ½</strong>ï¼šåœ¨å®é™…æ‰§è¡Œå‰å¯ä»¥é¢„è§ˆé‡å‘½åç»“æœ</li>
<li><strong>æ’¤é”€åŠŸèƒ½</strong>ï¼šæ”¯æŒæ“ä½œæ’¤é”€ï¼Œé˜²æ­¢è¯¯æ“ä½œ</li>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šè®°å½•æ‰€æœ‰æ“ä½œå†å²ï¼Œä¾¿äºè¿½è¸ªå’Œå®¡è®¡</li>
</ol>
<h2 data-id="heading-2">åº”ç”¨åœºæ™¯</h2>
<p>è¿™ä¸ªå·¥å…·é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<ol>
<li><strong>ç…§ç‰‡æ•´ç†</strong>ï¼šå°†ç›¸æœºæ‹æ‘„çš„ç…§ç‰‡æŒ‰æ—¥æœŸæˆ–åºå·ç»Ÿä¸€å‘½å</li>
<li><strong>æ–‡æ¡£ç®¡ç†</strong>ï¼šå¯¹å…¬å¸æˆ–ä¸ªäººæ–‡æ¡£è¿›è¡Œè§„èŒƒåŒ–å‘½å</li>
<li><strong>ä¸‹è½½æ–‡ä»¶æ•´ç†</strong>ï¼šå¯¹ä¸‹è½½çš„æ–‡ä»¶è¿›è¡Œæ‰¹é‡é‡å‘½åä»¥æé«˜å¯è¯»æ€§</li>
<li><strong>å¼€å‘é¡¹ç›®</strong>ï¼šå¯¹ä»£ç æ–‡ä»¶æˆ–èµ„æºæ–‡ä»¶è¿›è¡Œç»Ÿä¸€å‘½åè§„èŒƒ</li>
<li><strong>å­¦æœ¯ç ”ç©¶</strong>ï¼šå¯¹å®éªŒæ•°æ®æ–‡ä»¶è¿›è¡Œæœ‰åºå‘½å</li>
</ol>
<h2 data-id="heading-3">æŠ¥é”™å¤„ç†</h2>
<p>è„šæœ¬åŒ…å«äº†å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š</p>
<ol>
<li><strong>è·¯å¾„ä¸å­˜åœ¨</strong>ï¼šæ£€æŸ¥æŒ‡å®šç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™æç¤ºç”¨æˆ·</li>
<li><strong>æƒé™ä¸è¶³</strong>ï¼šæ£€æµ‹æ–‡ä»¶æ“ä½œæƒé™ï¼Œæƒé™ä¸è¶³æ—¶ç»™å‡ºæ˜ç¡®æç¤º</li>
<li><strong>æ–‡ä»¶å†²çª</strong>ï¼šæ£€æµ‹ç›®æ ‡æ–‡ä»¶åæ˜¯å¦å·²å­˜åœ¨ï¼Œé¿å…è¦†ç›–é‡è¦æ–‡ä»¶</li>
<li><strong>å‚æ•°éªŒè¯</strong>ï¼šéªŒè¯ç”¨æˆ·è¾“å…¥çš„å‚æ•°æ˜¯å¦åˆæ³•</li>
<li><strong>å¼‚å¸¸æ•è·</strong>ï¼šæ•è·å¹¶å¤„ç†è¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„å„ç§å¼‚å¸¸</li>
</ol>
<h2 data-id="heading-4">ä»£ç å®ç°</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FileBatchRenamer</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, directory</span>):
        self.directory = directory
        self.rename_log = []
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_directory</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(self.directory):
            <span class="hljs-keyword">raise</span> FileNotFoundError(<span class="hljs-string">f"ç›®å½• '<span class="hljs-subst">{self.directory}</span>' ä¸å­˜åœ¨"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isdir(self.directory):
            <span class="hljs-keyword">raise</span> NotADirectoryError(<span class="hljs-string">f"'<span class="hljs-subst">{self.directory}</span>' ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç›®å½•"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_files</span>(<span class="hljs-params">self, extension=<span class="hljs-literal">None</span>, pattern=<span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""è·å–ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶åˆ—è¡¨"""</span>
        <span class="hljs-keyword">try</span>:
            self.check_directory()
            files = os.listdir(self.directory)
            filtered_files = []
            
            <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
                file_path = os.path.join(self.directory, file)
                <span class="hljs-comment"># åªå¤„ç†æ–‡ä»¶ï¼Œä¸å¤„ç†å­ç›®å½•</span>
                <span class="hljs-keyword">if</span> os.path.isfile(file_path):
                    <span class="hljs-comment"># æ ¹æ®æ‰©å±•åè¿‡æ»¤</span>
                    <span class="hljs-keyword">if</span> extension <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> file.endswith(extension):
                        <span class="hljs-keyword">continue</span>
                    <span class="hljs-comment"># æ ¹æ®æ¨¡å¼è¿‡æ»¤</span>
                    <span class="hljs-keyword">if</span> pattern <span class="hljs-keyword">and</span> pattern <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> file:
                        <span class="hljs-keyword">continue</span>
                    filtered_files.append(file)
                    
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(filtered_files)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è·å–æ–‡ä»¶åˆ—è¡¨æ—¶å‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> []
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">preview_rename</span>(<span class="hljs-params">self, files, naming_pattern, start_number=<span class="hljs-number">1</span></span>):
        <span class="hljs-string">"""é¢„è§ˆé‡å‘½åç»“æœ"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\né‡å‘½åé¢„è§ˆ:"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">50</span>)
        rename_map = {}
        
        <span class="hljs-keyword">for</span> i, filename <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(files, start_number):
            name, ext = os.path.splitext(filename)
            new_name = naming_pattern.<span class="hljs-built_in">format</span>(i) + ext
            rename_map[filename] = new_name
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{filename}</span> -&gt; <span class="hljs-subst">{new_name}</span>"</span>)
            
        <span class="hljs-keyword">return</span> rename_map
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_rename</span>(<span class="hljs-params">self, rename_map</span>):
        <span class="hljs-string">"""æ‰§è¡Œé‡å‘½åæ“ä½œ"""</span>
        success_count = <span class="hljs-number">0</span>
        error_count = <span class="hljs-number">0</span>
        
        <span class="hljs-keyword">for</span> old_name, new_name <span class="hljs-keyword">in</span> rename_map.items():
            old_path = os.path.join(self.directory, old_name)
            new_path = os.path.join(self.directory, new_name)
            
            <span class="hljs-comment"># æ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨</span>
            <span class="hljs-keyword">if</span> os.path.exists(new_path):
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è­¦å‘Š: æ–‡ä»¶ '<span class="hljs-subst">{new_name}</span>' å·²å­˜åœ¨ï¼Œè·³è¿‡ '<span class="hljs-subst">{old_name}</span>'"</span>)
                error_count += <span class="hljs-number">1</span>
                <span class="hljs-keyword">continue</span>
                
            <span class="hljs-keyword">try</span>:
                os.rename(old_path, new_path)
                self.rename_log.append((datetime.now(), old_name, new_name))
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸé‡å‘½å: <span class="hljs-subst">{old_name}</span> -&gt; <span class="hljs-subst">{new_name}</span>"</span>)
                success_count += <span class="hljs-number">1</span>
            <span class="hljs-keyword">except</span> PermissionError:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æƒé™é”™è¯¯: æ— æ³•é‡å‘½å '<span class="hljs-subst">{old_name}</span>'ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æƒé™"</span>)
                error_count += <span class="hljs-number">1</span>
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é‡å‘½å '<span class="hljs-subst">{old_name}</span>' æ—¶å‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
                error_count += <span class="hljs-number">1</span>
                
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\né‡å‘½åå®Œæˆ! æˆåŠŸ: <span class="hljs-subst">{success_count}</span>, å¤±è´¥: <span class="hljs-subst">{error_count}</span>"</span>)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_log</span>(<span class="hljs-params">self, log_file=<span class="hljs-string">"rename_log.txt"</span></span>):
        <span class="hljs-string">"""ä¿å­˜æ“ä½œæ—¥å¿—"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(os.path.join(self.directory, log_file), <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
                f.write(<span class="hljs-string">"æ–‡ä»¶æ‰¹é‡é‡å‘½åæ“ä½œæ—¥å¿—\n"</span>)
                f.write(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span> + <span class="hljs-string">"\n"</span>)
                f.write(<span class="hljs-string">f"æ“ä½œæ—¶é—´: <span class="hljs-subst">{datetime.now().strftime(<span class="hljs-string">'%Y-%m-%d %H:%M:%S'</span>)}</span>\n"</span>)
                f.write(<span class="hljs-string">f"æ“ä½œç›®å½•: <span class="hljs-subst">{self.directory}</span>\n\n"</span>)
                
                <span class="hljs-keyword">for</span> timestamp, old_name, new_name <span class="hljs-keyword">in</span> self.rename_log:
                    f.write(<span class="hljs-string">f"[<span class="hljs-subst">{timestamp.strftime(<span class="hljs-string">'%H:%M:%S'</span>)}</span>] <span class="hljs-subst">{old_name}</span> -&gt; <span class="hljs-subst">{new_name}</span>\n"</span>)
                    
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ“ä½œæ—¥å¿—å·²ä¿å­˜åˆ°: <span class="hljs-subst">{log_file}</span>"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¿å­˜æ—¥å¿—æ—¶å‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    parser = argparse.ArgumentParser(description=<span class="hljs-string">"æ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·"</span>)
    parser.add_argument(<span class="hljs-string">"directory"</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">"è¦å¤„ç†çš„ç›®å½•è·¯å¾„"</span>)
    parser.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--pattern"</span>, default=<span class="hljs-string">"file_{:03d}"</span>, 
                       <span class="hljs-built_in">help</span>=<span class="hljs-string">"å‘½åæ¨¡å¼ï¼Œä½¿ç”¨ {:03d} è¡¨ç¤ºåºå· (é»˜è®¤: file_{:03d})"</span>)
    parser.add_argument(<span class="hljs-string">"-s"</span>, <span class="hljs-string">"--start"</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>, default=<span class="hljs-number">1</span>, 
                       <span class="hljs-built_in">help</span>=<span class="hljs-string">"èµ·å§‹åºå· (é»˜è®¤: 1)"</span>)
    parser.add_argument(<span class="hljs-string">"-e"</span>, <span class="hljs-string">"--extension"</span>, 
                       <span class="hljs-built_in">help</span>=<span class="hljs-string">"æ–‡ä»¶æ‰©å±•åè¿‡æ»¤ (ä¾‹å¦‚: .jpg)"</span>)
    parser.add_argument(<span class="hljs-string">"--preview"</span>, action=<span class="hljs-string">"store_true"</span>, 
                       <span class="hljs-built_in">help</span>=<span class="hljs-string">"ä»…é¢„è§ˆï¼Œä¸æ‰§è¡Œå®é™…é‡å‘½å"</span>)
    
    args = parser.parse_args()
    
    <span class="hljs-keyword">try</span>:
        renamer = FileBatchRenamer(args.directory)
        files = renamer.get_files(extension=args.extension)
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> files:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶"</span>)
            <span class="hljs-keyword">return</span>
            
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰¾åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(files)}</span> ä¸ªæ–‡ä»¶"</span>)
        
        rename_map = renamer.preview_rename(files, args.pattern, args.start)
        
        <span class="hljs-keyword">if</span> args.preview:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\né¢„è§ˆæ¨¡å¼ï¼Œæœªæ‰§è¡Œå®é™…é‡å‘½åæ“ä½œ"</span>)
            <span class="hljs-keyword">return</span>
            
        confirm = <span class="hljs-built_in">input</span>(<span class="hljs-string">"\nç¡®è®¤æ‰§è¡Œé‡å‘½åæ“ä½œ? (y/N): "</span>)
        <span class="hljs-keyword">if</span> confirm.lower() == <span class="hljs-string">'y'</span>:
            renamer.execute_rename(rename_map)
            renamer.save_log()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ“ä½œå·²å–æ¶ˆ"</span>)
            
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¨‹åºæ‰§è¡Œå‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
        sys.exit(<span class="hljs-number">1</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<h2 data-id="heading-5">ä½¿ç”¨æ–¹æ³•</h2>
<h3 data-id="heading-6">åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºæœ¬ç”¨æ³•ï¼Œå¯¹ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶æŒ‰é»˜è®¤æ¨¡å¼é‡å‘½å</span>
python batch_renamer.py /path/to/directory

<span class="hljs-comment"># æŒ‡å®šå‘½åæ¨¡å¼</span>
python batch_renamer.py /path/to/directory -p <span class="hljs-string">"photo_{:04d}"</span>

<span class="hljs-comment"># æŒ‡å®šèµ·å§‹åºå·</span>
python batch_renamer.py /path/to/directory -s 100

<span class="hljs-comment"># åªå¤„ç†ç‰¹å®šæ‰©å±•åçš„æ–‡ä»¶</span>
python batch_renamer.py /path/to/directory -e .jpg

<span class="hljs-comment"># é¢„è§ˆæ¨¡å¼ï¼ˆä¸å®é™…æ‰§è¡Œé‡å‘½åï¼‰</span>
python batch_renamer.py /path/to/directory --preview
</code></pre>
<h3 data-id="heading-7">å‘½ä»¤è¡Œå‚æ•°è¯´æ˜</h3>
<ul>
<li><code>directory</code>: å¿…éœ€å‚æ•°ï¼ŒæŒ‡å®šè¦å¤„ç†çš„ç›®å½•è·¯å¾„</li>
<li><code>-p, --pattern</code>: å‘½åæ¨¡å¼ï¼Œé»˜è®¤ä¸º <code>file_{:03d}</code>ï¼Œå…¶ä¸­ <code>{:03d}</code> ä¼šè¢«æ›¿æ¢ä¸ºåºå·</li>
<li><code>-s, --start</code>: èµ·å§‹åºå·ï¼Œé»˜è®¤ä¸º 1</li>
<li><code>-e, --extension</code>: æ–‡ä»¶æ‰©å±•åè¿‡æ»¤å™¨ï¼Œåªå¤„ç†æŒ‡å®šæ‰©å±•åçš„æ–‡ä»¶</li>
<li><code>--preview</code>: é¢„è§ˆæ¨¡å¼ï¼Œåªæ˜¾ç¤ºé‡å‘½åç»“æœï¼Œä¸æ‰§è¡Œå®é™…æ“ä½œ</li>
</ul>
<h3 data-id="heading-8">ä½¿ç”¨ç¤ºä¾‹</h3>
<p>å‡è®¾æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">image1.<span class="hljs-property">jpg</span>
image2.<span class="hljs-property">jpg</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">pdf</span>
photo.<span class="hljs-property">png</span>
</code></pre>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python batch_renamer.py ./test_dir -p <span class="hljs-string">"pic_{:02d}"</span> -e .jpg
</code></pre>
<p>ç»“æœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">pic_01.<span class="hljs-property">jpg</span>
pic_02.<span class="hljs-property">jpg</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">pdf</span>
photo.<span class="hljs-property">png</span>
</code></pre>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>è¿™ä¸ªæ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œç•Œé¢æä¾›äº†å¼ºå¤§çš„æ‰¹é‡æ–‡ä»¶é‡å‘½ååŠŸèƒ½ã€‚å®ƒå…·æœ‰è‰¯å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢è¯¯æ“ä½œï¼Œå¹¶é€šè¿‡æ—¥å¿—è®°å½•åŠŸèƒ½ä¿è¯æ“ä½œçš„å¯è¿½æº¯æ€§ã€‚æ— è®ºæ˜¯æ—¥å¸¸æ–‡ä»¶æ•´ç†è¿˜æ˜¯ä¸“ä¸šé¡¹ç›®ç®¡ç†ï¼Œè¿™ä¸ªå·¥å…·éƒ½èƒ½æ˜¾è‘—æé«˜å·¥ä½œæ•ˆç‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vxe-table ä½¿ç”¨ spanMethod åˆå¹¶å¡é¡¿çš„è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7579255046979747866</link>    <guid>https://juejin.cn/post/7579255046979747866</guid>    <pubDate>2025-12-03T08:41:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579255046979747866" data-draft-id="7579440586693656622" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vxe-table ä½¿ç”¨ spanMethod åˆå¹¶å¡é¡¿çš„è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-03T08:41:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·84179481456"/> <meta itemprop="url" content="https://juejin.cn/user/3921272428567529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vxe-table ä½¿ç”¨ spanMethod åˆå¹¶å¡é¡¿çš„è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3921272428567529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·84179481456
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:41:06.000Z" title="Wed Dec 03 2025 08:41:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>vxe-table ä½¿ç”¨ spanMethod åˆå¹¶å¡é¡¿çš„è§£å†³æ–¹æ¡ˆï¼Œå½“ä¸šåŠ¡éœ€æ±‚éœ€è¦åˆå¹¶æ—¶ï¼Œç”±äºè¡¨æ ¼æ•°æ®æœ‰å‡ åƒæ¡ï¼Œä½¿ç”¨è¯¥åˆå¹¶åä¸æ”¯æŒè™šæ‹Ÿæ»šåŠ¨ä¼šå¡é¡¿ã€‚é€šè¿‡æŸ¥çœ‹å®˜ç½‘ï¼Œå‘ç°åº”è¯¥ä½¿ç”¨ merge-cells æ¥åˆå¹¶å•å…ƒæ ¼ï¼Œä¸ä»…ä½¿ç”¨éå¸¸ç®€å•ï¼Œè¿˜æ”¯æŒè™šæ‹Ÿæ»šåŠ¨ï¼Œåªéœ€è¦æŒ‡å®šè¡Œå·å’Œåˆ—å·ï¼Œåˆå¹¶æ•°é‡å°±å¯ä»¥ä¸´æ—¶åˆå¹¶å•å…ƒæ ¼ï¼Œéœ€è¦æ³¨æ„ï¼Œå®˜ç½‘è¯´æ˜æ˜¯ä¸´æ—¶åˆå¹¶ã€‚ä¹Ÿå°±æ˜¯åˆå¹¶åå¦‚æœä¸é‡æ–°æ›´æ–°åˆ—æˆ–è€…é‡æ–°åŠ è½½æ•°æ®ï¼Œæ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯éœ€è¦éœ€è¦é‡æ–°åŠ è½½æ•°æ®ï¼Œé‚£ä¹ˆä¸´æ—¶åˆå¹¶å°±ä¼šä¸¢å¤±ï¼Œéœ€è¦é‡æ–°èµ‹å€¼ä¸€ä¸‹ merge-cells å°±å¯ä»¥é‡æ–°ä¸´æ—¶åˆå¹¶äº†ã€‚</p>
<p>æŸ¥çœ‹å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvxetable.cn" target="_blank" title="https://vxetable.cn" ref="nofollow noopener noreferrer">vxetable.cn</a>
gitbubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fx-extends%2Fvxe-table" target="_blank" title="https://github.com/x-extends/vxe-table" ref="nofollow noopener noreferrer">github.com/x-extends/vâ€¦</a>
giteeï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fx-extends%2Fvxe-table" target="_blank" title="https://gitee.com/x-extends/vxe-table" ref="nofollow noopener noreferrer">gitee.com/x-extends/vâ€¦</a></p>
<h2 data-id="heading-0">æ•ˆæœ</h2>
<p>ä»¥ä¸‹é€šè¿‡ä½¿ç”¨ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åœºæ™¯ï¼ŒåŒ…æ‹¬100åˆ—*500è¡Œï¼Œå¸¦å·¦å³å†»ç»“åˆ—å’Œè¡¨å°¾åˆè®¡ï¼Œæ¸²æŸ“å°±æ¯”è¾ƒå¤æ‚äº†ã€‚æµ‹è¯•äº†ä¸€ä¸‹ 5ä¸‡è¡Œå’Œ5åƒåˆ— éƒ½æ¯”è¾ƒæµç•…ï¼Œæ¯”ä¹‹å‰æµç•…å¤ªå¤šå€äº†.</p>
<p>é¿å…åˆå¹¶ä¸€æ•´è¡Œæˆ–ä¸€æ•´åˆ—ï¼Œå½“æ‰€æœ‰è¡Œéƒ½è¢«åˆå¹¶ä¸ºä¸€ä¸ªå•å…ƒæ ¼æ—¶å°±ç­‰åŒäºå…³é—­çºµå‘è™šæ‹Ÿæ»šåŠ¨ï¼Œå½“æ‰€æœ‰åˆ—éƒ½è¢«åˆå¹¶ä¸ºä¸€ä¸ªå•å…ƒæ ¼æ—¶å°±ç­‰åŒäºå…³é—­æ¨ªå‘è™šæ‹Ÿæ»šåŠ¨ã€‚åº”è¯¥é¿å…åˆå¹¶èŒƒå›´è¿‡å¤§çš„ä½¿ç”¨åœºæ™¯.</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/258dbaa4ba88406695df56577f5e7f43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODQxNzk0ODE0NTY=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356066&amp;x-signature=DVhSVmikMve61x%2B04fil7nXD4D8%3D" alt="Video_2025-12-02_105507-ezgif.com-optimize.gif" loading="lazy"/></p>
<h2 data-id="heading-1">ä»£ç </h2>
<p>æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š
å¦‚æœä½¿ç”¨ merge-cells æ–¹å¼åˆ™æ˜¯å…¨åŠŸèƒ½çš„ï¼Œæ”¯æŒè™šæ‹Ÿæ»šåŠ¨ï¼›
å¦‚æœä½¿ç”¨ span-method æ–¹å¼çš„è™šæ‹Ÿæ»šåŠ¨æ”¯æŒéƒ¨åˆ†åŠŸèƒ½ï¼Œå­˜åœ¨åŠŸèƒ½é™åˆ¶ï¼šå¦‚æœè¿›è¡Œè·¨è¡Œåˆå¹¶ï¼Œåˆ™ä¸æ”¯æŒçºµå‘è™šæ‹Ÿæ»šåŠ¨ï¼›å¦‚æœè¿›è¡Œè·¨åˆ—åˆå¹¶ï¼Œåˆ™ä¸æ”¯æŒæ¨ªå‘è™šæ‹Ÿæ»šåŠ¨</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">vxe-grid</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"gridOptions"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">vxe-grid</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> gridOptions = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">border</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">showOverflow</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">showHeaderOverflow</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">showFooterOverflow</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">showFooter</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
  <span class="hljs-attr">virtualYConfig</span>: {
    <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">gt</span>: <span class="hljs-number">0</span>
  },
  <span class="hljs-attr">virtualXConfig</span>: {
    <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">gt</span>: <span class="hljs-number">0</span>
  },
  <span class="hljs-attr">mergeCells</span>: [
    { <span class="hljs-attr">row</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">2</span> },
    { <span class="hljs-attr">row</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">3</span> },
    { <span class="hljs-attr">row</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">2</span> },
    { <span class="hljs-attr">row</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">3</span> },
    { <span class="hljs-attr">row</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">2</span> }
  ],
  <span class="hljs-attr">mergeFooterItems</span>: [
    { <span class="hljs-attr">row</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">col</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">rowspan</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">1</span> }
  ],
  <span class="hljs-attr">columns</span>: [
    { <span class="hljs-attr">field</span>: <span class="hljs-string">'seq'</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">'seq'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">70</span>, <span class="hljs-attr">fixed</span>: <span class="hljs-string">'left'</span> },
    { <span class="hljs-attr">field</span>: <span class="hljs-string">'name'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Name'</span>, <span class="hljs-attr">minWidth</span>: <span class="hljs-number">300</span> },
    {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ†ç»„1'</span>,
      <span class="hljs-attr">children</span>: [
        { <span class="hljs-attr">field</span>: <span class="hljs-string">'role'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Role'</span>, <span class="hljs-attr">minWidth</span>: <span class="hljs-number">300</span> },
        { <span class="hljs-attr">field</span>: <span class="hljs-string">'sex'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Sex'</span>, <span class="hljs-attr">minWidth</span>: <span class="hljs-number">300</span> },
        { <span class="hljs-attr">field</span>: <span class="hljs-string">'age'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Age'</span>, <span class="hljs-attr">minWidth</span>: <span class="hljs-number">300</span> }
      ]
    },
    {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ†ç»„2'</span>,
      <span class="hljs-attr">children</span>: [
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—3'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col3'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—4'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col4'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">140</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—5'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col5'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">300</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—6'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col6'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">160</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—7'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col7'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—8'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col8'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—9'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col9'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">160</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—10'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col10'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">160</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—11'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col11'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">180</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—12'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col12'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">160</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—13'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col13'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">80</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—14'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col14'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—15'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col15'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">360</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—16'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col16'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—17'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col17'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">380</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—18'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col18'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—19'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col19'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">290</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—20'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col20'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">80</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—21'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col21'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—22'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col22'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—23'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col23'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">270</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—24'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col24'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">330</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—25'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col25'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">460</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—26'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col26'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">280</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—27'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col27'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">220</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—28'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col28'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—29'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col29'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">180</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—30'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col30'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">500</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—31'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col31'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">600</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—32'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col32'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—33'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col33'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">490</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—34'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col34'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—35'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col35'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—36'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col36'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—37'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col37'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—38'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col38'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—39'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col39'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">360</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—40'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col40'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">420</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—41'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col41'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—42'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col42'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—43'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col43'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">280</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—44'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col44'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">170</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—45'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col45'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">370</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—46'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col46'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">420</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—47'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col47'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">170</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—48'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col48'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—49'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col49'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">220</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—50'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col50'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">170</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—51'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col51'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">160</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—52'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col52'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">500</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—53'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col53'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">280</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—54'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col54'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">170</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—55'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col55'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">370</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—56'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col56'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">120</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—57'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col57'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">170</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—58'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col58'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—59'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col59'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">220</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—60'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col60'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">650</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—61'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col61'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">600</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—62'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col62'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—63'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col63'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">490</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—64'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col64'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—65'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col65'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—66'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col66'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—67'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col67'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—68'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col68'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—69'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col69'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">360</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—70'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col70'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">650</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—71'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col71'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">600</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—72'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col72'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—73'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col73'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">490</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—74'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col74'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—75'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col75'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—76'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col76'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—77'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col77'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—78'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col78'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—79'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col79'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">360</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—80'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col80'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">650</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—81'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col81'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">600</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—82'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col82'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—83'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col83'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">490</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—84'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col84'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—85'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col85'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—86'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col86'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—87'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col87'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—88'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col88'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—89'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col89'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">360</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—90'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col90'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">650</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—91'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col91'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">600</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—92'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col92'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
        { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—93'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col93'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">490</span> }
      ]
    },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—94'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col94'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—95'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col95'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—96'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col96'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">800</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—97'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col97'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—98'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col98'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—99'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col99'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'åˆ—100'</span>, <span class="hljs-attr">field</span>: <span class="hljs-string">'col100'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">fixed</span>: <span class="hljs-string">'right'</span> }
  ],
  <span class="hljs-attr">data</span>: [],
  <span class="hljs-attr">footerData</span>: [
    { <span class="hljs-attr">seq</span>: <span class="hljs-string">'åˆè®¡'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'666'</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'888'</span>, <span class="hljs-attr">sex</span>: <span class="hljs-string">'999'</span>, <span class="hljs-attr">age</span>: <span class="hljs-string">'234'</span>, <span class="hljs-attr">address</span>: <span class="hljs-string">'453'</span> },
    { <span class="hljs-attr">seq</span>: <span class="hljs-string">'å‡å€¼'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'222'</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'333'</span>, <span class="hljs-attr">sex</span>: <span class="hljs-string">'777'</span>, <span class="hljs-attr">age</span>: <span class="hljs-string">'876'</span>, <span class="hljs-attr">address</span>: <span class="hljs-string">'134'</span> }
  ]
})
<span class="hljs-comment">// æ¨¡æ‹Ÿè¡Œæ•°æ®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadList</span> = (<span class="hljs-params">size = <span class="hljs-number">200</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> dataList = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {
    dataList.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">id</span>: <span class="hljs-number">10000</span> + i,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'Test'</span> + i,
      <span class="hljs-attr">role</span>: i % <span class="hljs-number">3</span> ? <span class="hljs-string">'Developer'</span> : <span class="hljs-string">' DeveloperDeveloper DeveloperDeveloper DeveloperDeveloper DeveloperDeveloper DeveloperDeveloper'</span>,
      <span class="hljs-attr">sex</span>: <span class="hljs-string">'ç”·'</span>,
      <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">address</span>: <span class="hljs-string">'Address abc'</span>,
      <span class="hljs-attr">col90</span>: <span class="hljs-string">'90-'</span> + i,
      <span class="hljs-attr">col91</span>: <span class="hljs-string">'91-'</span> + i,
      <span class="hljs-attr">col92</span>: <span class="hljs-string">'92-'</span> + i,
      <span class="hljs-attr">col93</span>: <span class="hljs-string">'93-'</span> + i,
      <span class="hljs-attr">col94</span>: <span class="hljs-string">'94-'</span> + i,
      <span class="hljs-attr">col95</span>: <span class="hljs-string">'95-'</span> + i,
      <span class="hljs-attr">col96</span>: <span class="hljs-string">'96-'</span> + i,
      <span class="hljs-attr">col97</span>: <span class="hljs-string">'97-'</span> + i,
      <span class="hljs-attr">col98</span>: <span class="hljs-string">'98-'</span> + i,
      <span class="hljs-attr">col99</span>: <span class="hljs-string">'99-'</span> + i,
      <span class="hljs-attr">col100</span>: <span class="hljs-string">'100-'</span> + i
    })
  }
  gridOptions.<span class="hljs-property">data</span> = dataList
}

<span class="hljs-title function_">loadList</span>(<span class="hljs-number">500</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fx-extends%2Fvxe-table" target="_blank" title="https://gitee.com/x-extends/vxe-table" ref="nofollow noopener noreferrer">gitee.com/x-extends/vâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025 SECon Ã— AgentX å¤§ä¼šï¼šAI åŸç”Ÿåº”ç”¨æ¶æ„ä¸“åœºç²¾å½©å›é¡¾ & PPT ä¸‹è½½]]></title>    <link>https://juejin.cn/post/7579453456017260585</link>    <guid>https://juejin.cn/post/7579453456017260585</guid>    <pubDate>2025-12-03T08:42:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579453456017260585" data-draft-id="7579213860572381238" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 SECon Ã— AgentX å¤§ä¼šï¼šAI åŸç”Ÿåº”ç”¨æ¶æ„ä¸“åœºç²¾å½©å›é¡¾ &amp; PPT ä¸‹è½½"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-03T08:42:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 SECon Ã— AgentX å¤§ä¼šï¼šAI åŸç”Ÿåº”ç”¨æ¶æ„ä¸“åœºç²¾å½©å›é¡¾ &amp; PPT ä¸‹è½½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:42:22.000Z" title="Wed Dec 03 2025 08:42:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šç›ˆæ¥¹</p>
<p>è¿‘æ—¥ï¼Œ2025 SEConÂ Ã—Â AgentXå¤§ä¼šâ€”â€”AI åŸç”Ÿåº”ç”¨æ¶æ„ä¸“åœºåœ†æ»¡è½å¹•ï¼Œæœ¬æ¬¡ä¸“åœºé˜¿é‡Œäº‘è”åˆä¿¡é€šé™¢å…±åŒå‡ºå“ï¼Œç°åœºå¸å¼•äº† 80+ åæŠ€æœ¯ä»ä¸šè€…æ·±åº¦å‚ä¸ã€‚</p>
<p>æ´»åŠ¨èšç„¦ AI æ—¶ä»£è½¯ä»¶æ¶æ„çš„æ ¸å¿ƒå‘½é¢˜ï¼Œæ·±åº¦åˆ†äº«äº† AI åŸç”Ÿåº”ç”¨æ¶æ„è¶‹åŠ¿ä¸å®è·µã€AgentScope å¼€å‘æ¡†æ¶ã€AI å¼€æ”¾å¹³å°ã€å¤§æ¨¡å‹å¯è§‚æµ‹ &amp; AIOps ç­‰çƒ­é—¨æŠ€æœ¯è®®é¢˜ï¼Œæ¢è®¨ä»åŸºç¡€è®¾æ–½åˆ°åº”ç”¨å±‚çš„ååŒæ¼”è¿›ç­–ç•¥ä¸å·¥ç¨‹å®è·µã€‚</p>
<p>å…³æ³¨ã€Œé˜¿é‡Œäº‘äº‘åŸç”Ÿã€å…¬ä¼—å·ï¼Œåå°å›å¤ï¼š1125</p>
<p>å…è´¹è·å¾—æ´»åŠ¨è®²å¸ˆ PPT åˆè¾‘</p>
<h2 data-id="heading-0">ç²¾å½©å›é¡¾</h2>
<h3 data-id="heading-1">è®®é¢˜ä¸€ï¼šAI åŸç”Ÿåº”ç”¨æ¶æ„æ¢ç´¢ä¸å®è·µä¸¨è‚–äº¬(äº¦ç›) Â  é˜¿é‡Œäº‘æ™ºèƒ½äº‘åŸç”Ÿé«˜çº§æŠ€æœ¯ä¸“å®¶</h3>
<p>å½“å‰å¤§æ¨¡å‹å·²è¿ˆè¿‡æŠ€æœ¯æ‹ç‚¹ï¼ŒAgentic AI è¿›å…¥è§„æ¨¡åŒ–è½åœ°é˜¶æ®µã€‚AI åŸç”Ÿåº”ç”¨ä»¥æ¨¡å‹ä¸ºåŸºç¡€ã€Agent ä¸ºé©±åŠ¨ã€æ•°æ®ä¸ºä¸­å¿ƒï¼Œæ¨åŠ¨ç³»ç»Ÿä»â€œæœºå™¨æ‰§è¡Œâ€å‘â€œæœºå™¨æ€è€ƒ+æ‰§è¡Œâ€æ¼”è¿›ã€‚æ¡†æ¶é€‰å‹éœ€å¹³è¡¡ Agentic è‡ªä¸»æ€§ä¸ä¸šåŠ¡ç¡®å®šæ€§ï¼ŒAgent é¢ä¸´å¼€å‘æ•ˆç‡ã€ä¸šåŠ¡æ•ˆæœï¼Œä»¥åŠç¨³å®šã€æ€§èƒ½ã€æˆæœ¬ã€å®‰å…¨çš„æŒ‘æˆ˜ã€‚å®è·µä¸Šå»ºè®®æ„å»ºä»¥æ•°æ®ä¸ºæ ¸å¿ƒçš„ Agent å¹³å°ï¼Œç»“åˆ MCP/A2A æ ‡å‡†ä¸ Serverless æ¶æ„ï¼Œé€šè¿‡ AI ç½‘å…³ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¯è§‚æµ‹ç­‰æå‡å®‰å…¨æ€§ã€ç¨³å®šæ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œå®ç°æ™ºèƒ½åŒ–äººæœºåä½œæ–°èŒƒå¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea152df061df4e339245bc2856ea732d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=jY5DmIePKyEhkFFgtGJntTGhRBY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-2">è®®é¢˜äºŒï¼šå¼€å‘æ›´å¯æ§ï¼Œéƒ¨ç½²æ›´ä¾¿æ·ï¼šAgentScope è¿ˆå…¥ 1.0 æ—¶ä»£ä¸¨é‚ç‚œç‘ Â é˜¿é‡Œå·´å·´é›†å›¢é€šä¹‰å®éªŒå®¤ é«˜çº§ç®—æ³•å·¥ç¨‹å¸ˆ</h3>
<p>æ·±åº¦åˆ†äº«äº†é˜¿é‡Œé€šä¹‰å®éªŒå®¤å¼€æºçš„ AgentScope æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶ 1.0 ç‰ˆæœ¬ã€‚æ ¸å¿ƒå†…å®¹åŒ…æ‹¬ï¼šåŸºäº ReAct èŒƒå¼çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ”¯æŒï¼Œæä¾›ç»“æ„åŒ–è¾“å‡ºã€å·¥å…·è°ƒç”¨ä¸é•¿æœŸè®°å¿†ç­‰èƒ½åŠ›ï¼›é‡‡ç”¨ä¸‰å±‚æ¶æ„â€”â€”å¼€å‘æ¡†æ¶å±‚ã€å¯è§†åŒ–è°ƒè¯•å¹³å°ä¸å®‰å…¨è¿è¡Œæ—¶ç¯å¢ƒï¼Œç»“åˆå·¥å…·æ²™ç®±ä¸å…ƒå·¥å…·æœºåˆ¶ï¼Œå…¨é¢æå‡ç³»ç»Ÿçš„å¯æ§æ€§ã€å¯è§‚æµ‹æ€§ä¸éƒ¨ç½²å®‰å…¨æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fa960187303425ab4b75c45eba2a315~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=sC5gQdpPus3neRelbmjRnkNxZAo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">è®®é¢˜ä¸‰ï¼šAI ç½‘å…³ï¼šAI åŸç”Ÿæ¶æ„ä¸‹çš„æ™ºèƒ½æµé‡ä¸­æ¢ä¸¨Â èµµç‚³å ƒ(ç§‰é’§) Â  é˜¿é‡Œäº‘æ™ºèƒ½äº‘åŸç”Ÿé«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ</h3>
<p>èšç„¦ AI ç½‘å…³åœ¨ AI åŸç”Ÿæ¶æ„ä¸­çš„æ ¸å¿ƒä½œç”¨ï¼Œé‡ç‚¹ä»‹ç» Higress AI ç½‘å…³çš„å…³é”®èƒ½åŠ›ï¼šæ”¯æŒå¤šæ¨¡å‹é€‚é…ã€åè®®è½¬æ¢ä¸è¯­ä¹‰ç¼“å­˜ï¼Œæä¾› Token é™æµã€Fallback æœºåˆ¶ä¿éšœé«˜å¯ç”¨ï¼›é€šè¿‡ API-Key ç®¡ç†ã€PII è„±æ•ã€WASM æ²™ç®±ç­‰å®ç°å®‰å…¨å¯æ§ï¼›å¹¶å€ŸåŠ© MCPServer ç»Ÿä¸€ä»£ç†æå‡é›†æˆæ•ˆç‡ã€‚HiMarket å¹³å°åˆ™åŠ©åŠ›ä¼ä¸šæ„å»ºç§æœ‰ Agent å¸‚åœºï¼Œæ¨åŠ¨ AI èƒ½åŠ›çš„å®‰å…¨è§„æ¨¡åŒ–è½åœ°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f6a2162c2a04687b59e1f9422c32e10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=hqekz6Jlpn8TxEWekzbyHf3kefg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-4">è®®é¢˜å››ï¼šä»å¯è§‚æµ‹åˆ° RLï¼šæ‰“é€ ç”Ÿäº§çº§å¯é çš„é•¿å‘¨æœŸ Agentä¸¨é©¬äº‘é›· Â é˜¿é‡Œäº‘æ™ºèƒ½äº‘åŸç”ŸæŠ€æœ¯ä¸“å®¶</h3>
<p>èšç„¦ AI-Native åº”ç”¨ä¸­é•¿å‘¨æœŸ Agent çš„å¯é æ€§å»ºè®¾ï¼Œæå‡ºä»¥å¯è§‚æµ‹æ€§ä¸ºåŸºç¡€ï¼Œé€šè¿‡ OpenTelemetryã€Prometheus ç­‰å·¥å…·å®ç°å…¨æ ˆç›‘æ§ï¼Œåšåˆ°â€œå¯è§ã€å¯è°ƒã€å¯å®¡â€ã€‚å¼•å…¥ LLM Judger ä½œä¸ºè‡ªåŠ¨åŒ–è¯„ä¼°è£åˆ¤ï¼Œç»“åˆæ•°æ®å·¥ç¨‹ä¸æ¨¡å‹è’¸é¦ï¼Œæ„å»ºå¿«æ…¢åé¦ˆé—­ç¯ã€‚æœ€ç»ˆå½¢æˆä»é—®é¢˜å‘ç°ã€æ ¹å› åˆ†æåˆ°è‡ªæˆ‘å¼ºåŒ–çš„è¿›åŒ–ç³»ç»Ÿï¼Œæ¨åŠ¨ Agent å‘é«˜å¯é ã€è‡ªæ¼”è¿›çš„ç”Ÿäº§çº§åº”ç”¨å‘å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ad061b319a149d48f32fca63cf20d79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=x9x%2BPT7fAq1zLE6Tyd9cpCHXDiY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-5">ç°åœºç²¾å½©ç¬é—´</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e70dd5c0e9a8469ca6c5d29ad53c3e55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=NKOGl9Ul7FXv9U3uoo6YG17d9X8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/064da6f1678c432c9a82dfe639aa6083~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=ceeq4eP7VxrfkEQlFkcYR4mMzLQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38056102f55f4342869e064202875dce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356142&amp;x-signature=cFiiUZ3dOEoI%2BuGLJkk1%2Fhk%2F1RE%3D" alt="å›¾ç‰‡" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Letâ€™s Encrypt è¯ä¹¦æœ‰æ•ˆæœŸå°†ç¼©è‡³ 45 å¤©ï¼Œè¿ç»´å¤©éƒ½å¡Œäº†]]></title>    <link>https://juejin.cn/post/7579410911057412122</link>    <guid>https://juejin.cn/post/7579410911057412122</guid>    <pubDate>2025-12-03T08:45:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579410911057412122" data-draft-id="7579440586693673006" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Letâ€™s Encrypt è¯ä¹¦æœ‰æ•ˆæœŸå°†ç¼©è‡³ 45 å¤©ï¼Œè¿ç»´å¤©éƒ½å¡Œäº†"/> <meta itemprop="keywords" content="HTTPS,è¿ç»´,è‡ªåŠ¨åŒ–è¿ç»´"/> <meta itemprop="datePublished" content="2025-12-03T08:45:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¥ç”¨æˆ·å·²ä¸å­˜åœ¨"/> <meta itemprop="url" content="https://juejin.cn/user/64217584778579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Letâ€™s Encrypt è¯ä¹¦æœ‰æ•ˆæœŸå°†ç¼©è‡³ 45 å¤©ï¼Œè¿ç»´å¤©éƒ½å¡Œäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/64217584778579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¥ç”¨æˆ·å·²ä¸å­˜åœ¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:45:31.000Z" title="Wed Dec 03 2025 08:45:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿‘æ—¥ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fletsencrypt.org%2F2025%2F12%2F02%2Ffrom-90-to-45" target="_blank" title="https://letsencrypt.org/2025/12/02/from-90-to-45" ref="nofollow noopener noreferrer">Letâ€™s Encrypt å®˜æ–¹æ­£å¼å‘å¸ƒå…¬å‘Š</a>ï¼Œä¸ºäº†ç¬¦åˆ CA/æµè§ˆå™¨è®ºå›ï¼ˆCA/Browser Forumï¼‰çš„æœ€æ–°åŸºå‡†è¦æ±‚ï¼Œå¹¶å°†äº’è”ç½‘å®‰å…¨æ€§æ¨å‘æ–°é«˜åº¦ï¼Œå°†é€æ­¥ç¼©çŸ­å…¶ç­¾å‘çš„ TLS/SSL è¯ä¹¦æœ‰æ•ˆæœŸã€‚</p>
<p>ç›®å‰çš„ 90 å¤©æœ‰æ•ˆæœŸï¼Œå°†åœ¨æœªæ¥å‡ å¹´å†…é€æ­¥å‡åŠã€‚<strong>åˆ° 2028 å¹´ï¼Œå…è´¹è¯ä¹¦æœ‰æ•ˆæœŸå°†ä»…å‰© 45 å¤©ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/522cd71c9067446eac6543bc3a95ef73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356495&amp;x-signature=%2B5RhWXT2xAVccTN3iCOVIU8NTvU%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-0">ä¸ºä»€ä¹ˆè¦ç¼©çŸ­æœ‰æ•ˆæœŸï¼Ÿ</h3>
<p>è¿™å¹¶é Letâ€™s Encrypt ä¸€å®¶çš„å†³å®šï¼Œè€Œæ˜¯æ•´ä¸ªè¡Œä¸šçš„è¶‹åŠ¿ã€‚å®˜æ–¹ç»™å‡ºäº†3ä¸ª<del>å€Ÿå£</del>ç†ç”±</p>
<ol>
<li>
<p><strong>å®‰å…¨æ€§æå‡ï¼š</strong> ç¼©çŸ­è¯ä¹¦æœ‰æ•ˆæœŸå¯ä»¥é™åˆ¶å¯†é’¥æ³„éœ²åçš„å½±å“èŒƒå›´ã€‚å¦‚æœç§é’¥è¢«ç›—ï¼Œè¾ƒçŸ­çš„æœ‰æ•ˆæœŸè®©æ”»å‡»è€…åˆ©ç”¨è¯¥å¯†é’¥çš„æ—¶é—´çª—å£æ›´çŸ­ã€‚</p>
</li>
<li>
<p><strong>æé«˜åŠé”€æ•ˆç‡ï¼š</strong> æ›´çŸ­çš„ç”Ÿå‘½å‘¨æœŸè®©è¯ä¹¦åŠé”€æŠ€æœ¯ï¼ˆCertificate Revocationï¼‰æ›´æœ‰æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿè¿«ä½¿è‡ªåŠ¨åŒ–æµç¨‹æ›´åŠ å¥å£®ã€‚</p>
</li>
<li>
<p><strong>è¡Œä¸šåˆè§„ï¼š</strong> è¿™æ˜¯æ‰€æœ‰å…¬å…±ä¿¡ä»»çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰éƒ½å¿…é¡»éµå¾ªçš„æŠ€æœ¯è¦æ±‚å˜åŒ–ã€‚</p>
</li>
</ol>
<h3 data-id="heading-1">å…³é”®æ—¶é—´è½´</h3>
<p>ä¸ºäº†è®©è¿ç»´äººå‘˜é€‚åº”è¿™äº›å˜åŒ–ï¼ŒLetâ€™s Encrypt ç»™åˆ¶å®šäº†è¯¦ç»†çš„è®¡åˆ’ï¼ˆStaging ç¯å¢ƒä¼šæå‰ä¸€ä¸ªæœˆç”Ÿæ•ˆï¼‰ã€‚</p>
<ul>
<li>
<p><strong>2026 å¹´ 5 æœˆ 13 æ—¥ï¼š</strong> <code>tlsserver</code> é…ç½®æ–‡ä»¶ç‡å…ˆåˆ‡æ¢è‡³ 45 å¤©æœ‰æ•ˆæœŸï¼ˆç”¨äºæµ‹è¯•ï¼‰ã€‚</p>
</li>
<li>
<p><strong>2027 å¹´ 2 æœˆ 10 æ—¥ï¼š</strong> é»˜è®¤è¯ä¹¦æœ‰æ•ˆæœŸç¼©çŸ­è‡³ 64 å¤©ã€‚åŸŸåéªŒè¯çš„ã€Œæˆæƒå¤ç”¨æœŸã€ç¼©çŸ­è‡³ 10 å¤©ã€‚</p>
</li>
<li>
<p><strong>2028 å¹´ 2 æœˆ 16 æ—¥ï¼š</strong> é»˜è®¤è¯ä¹¦æœ‰æ•ˆæœŸå…¨é¢ç¼©çŸ­è‡³ 45 å¤©ã€‚ã€Œæˆæƒå¤ç”¨æœŸã€å¤§å¹…ç¼©çŸ­è‡³ 7 å°æ—¶ã€‚</p>
</li>
</ul>
<h3 data-id="heading-2">è‹¦é€¼çš„è¿ç»´ä½•å¤„ä½•ä»ï¼Ÿ</h3>
<p>å¦‚æœä½ çš„è¯ä¹¦æ˜¯å…¨è‡ªåŠ¨ç»­æœŸçš„ï¼Œå¤§éƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¸éœ€è¦åšå¤ªå¤šæ”¹åŠ¨ï¼Œä½†ä¸ºäº†é¿å…æœªæ¥å¯èƒ½ä¼šé­é‡æœåŠ¡ä¸­æ–­ï¼Œè¿˜æ˜¯éœ€è¦ä»”ç»†åœ°æ£€æŸ¥ã€‚</p>
<h4 data-id="heading-3"><strong>æ£€æŸ¥ç»­æœŸé¢‘ç‡</strong></h4>
<p>å¾ˆå¤šæ—§çš„è‡ªåŠ¨åŒ–è„šæœ¬æˆ– Cron Job æ˜¯ç¡¬ç¼–ç çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè®¾ç½®æ¯ 60 å¤©è¿è¡Œä¸€æ¬¡ <code>certbot renew</code>ï¼Œé‚£ä¹ˆåœ¨ 2028 å¹´ï¼ˆç”šè‡³ 2027 å¹´ï¼‰ï¼Œä½ çš„è¯ä¹¦åœ¨ç»­æœŸå‰å°±å·²ç»è¿‡æœŸäº†ã€‚</p>
<p><strong>å»ºè®®ï¼š</strong> ç¡®ä¿ä½ çš„ ACME å®¢æˆ·ç«¯æ”¯æŒåœ¨è¯ä¹¦ç”Ÿå‘½å‘¨æœŸçš„ <strong>2/3</strong> å¤„è¿›è¡Œç»­æœŸï¼ˆå³ 45 å¤©è¯ä¹¦åº”åœ¨ç¬¬ 30 å¤©å·¦å³ç»­æœŸï¼‰ã€‚</p>
<h4 data-id="heading-4"><strong>å¯ç”¨ ARIï¼ˆACME Renewal Informationï¼‰</strong></h4>
<p>Letâ€™s Encrypt æ¨èä½¿ç”¨æ”¯æŒ ARI çš„å®¢æˆ·ç«¯ã€‚ARI æ˜¯ä¸€é¡¹æ–°åŠŸèƒ½ï¼Œèƒ½è®©æœåŠ¡å™¨å‘ŠçŸ¥å®¢æˆ·ç«¯ã€Œæœ€ä½³çš„ç»­æœŸæ—¶é—´ã€ï¼Œè€Œä¸æ˜¯ä¾èµ–å®¢æˆ·ç«¯è‡ªå·±çŒœæµ‹ï¼Œè¿™èƒ½æœ‰æ•ˆé¿å…ç»­æœŸæ‹¥å µå’Œå¤±è´¥ã€‚</p>
<h4 data-id="heading-5"><strong>åˆ«å†æ‰‹åŠ¨ç»­æœŸäº†</strong></h4>
<p>å¦‚æœä½ çš„ç½‘ç«™è¿˜åœ¨é äººå·¥æ‰‹åŠ¨ä¸Šä¼ è¯ä¹¦ï¼Œè¿™æ¬¡å˜é©å°†æ˜¯å™©æ¢¦ã€‚éšç€æœ‰æ•ˆæœŸç¼©çŸ­ï¼Œæ‰‹åŠ¨æ“ä½œçš„é¢‘ç‡å°†ç¿»å€ï¼Œå‡ºé”™æ¦‚ç‡ä¹Ÿä¼šå¢åŠ ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f028a4c5cc84f9db360102498d1cd8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356495&amp;x-signature=1zLDyO2iGc89Wlwr08thTI8nqxE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">æ–°çš„ DNS éªŒè¯æ–¹å¼æ¥äº†</h3>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼ŒLetâ€™s Encrypt æ­£ä¸ IETF å’Œ CA/æµè§ˆå™¨è®ºå›åˆä½œï¼Œæ¨åŠ¨ä¸€ç§æ–°çš„éªŒè¯æ ‡å‡†ï¼š<strong>DNS-PERSIST-01</strong>ã€‚</p>
<ul>
<li>
<p>ç›®å‰çš„ DNS-01 éªŒè¯éœ€è¦ ACME å®¢æˆ·ç«¯æœ‰æƒé™åŠ¨æ€ä¿®æ”¹ DNS è®°å½•ï¼ˆæ·»åŠ  TXT è®°å½•ï¼‰ï¼Œè¿™é€šå¸¸éœ€è¦ç»™è„šæœ¬å¼€æ”¾æ•æ„Ÿçš„ API æƒé™ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ï¼Œä¸”ä¾èµ– DNS æœåŠ¡å•†çš„ API ç¨³å®šæ€§ã€‚</p>
</li>
<li>
<p><code>DNS-PERSIST-01</code> å…è®¸è®¾ç½®ä¸€ä¸ª<strong>é™æ€çš„ DNS TXT è®°å½•</strong>ã€‚</p>
</li>
</ul>
<p>è¿™ä¸€æ–°åŠŸèƒ½é¢„è®¡å°†åœ¨ <strong>2026 å¹´</strong> ä¸Šçº¿ï¼Œå±Šæ—¶å°†æå¤§åœ°ç®€åŒ–è‡ªåŠ¨åŒ–ç»­æœŸçš„é…ç½®éš¾åº¦ã€‚</p>
<h3 data-id="heading-7">è‡ªåŠ¨åŒ–ä¹Ÿä¸æ˜¯ä¸€åŠ³æ°¸é€¸</h3>
<p>è™½ç„¶ä½†æ˜¯ï¼ŒACME ç­–ç•¥åœ¨å®é™…è½åœ°ä¸­å¯èƒ½ä¼šå‡ºç°å„ç§å„æ ·çš„é—®é¢˜ã€‚</p>
<ul>
<li>
<p><strong>ç¯å¢ƒè„†å¼±æ€§ï¼š</strong> æ“ä½œç³»ç»Ÿå‡çº§æˆ– <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Ffeatures%2Fpython" target="_blank" title="https://www.servbay.com/features/python" ref="nofollow noopener noreferrer">Python ç¯å¢ƒ</a>å˜åŠ¨ï¼Œå¸¸å¯¼è‡´ Certbot ç­‰å·¥å…·çªç„¶å¤±æ•ˆã€‚</p>
</li>
<li>
<p><strong>å®‰å…¨éšæ‚£ï¼š</strong> ä¸ºäº†è‡ªåŠ¨é€šè¿‡ DNS éªŒè¯ï¼Œé€šå¸¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šä¿å­˜ DNS æœåŠ¡å•†çš„é«˜æƒé™ API Keyï¼Œè¿™å¢åŠ äº†æœåŠ¡å™¨è¢«æ”»é™·åçš„è¿å¸¦é£é™©ã€‚</p>
</li>
<li>
<p><strong>å¤æ‚æ¶æ„éš¾é¢˜ï¼š</strong> åœ¨ CDNã€è´Ÿè½½å‡è¡¡æˆ–å†…ç½‘ç¯å¢ƒä¸­ï¼Œè‡ªåŠ¨åŒ–åˆ†å‘è¯ä¹¦çš„è„šæœ¬ç¼–å†™éš¾åº¦æå¤§ï¼Œç»´æŠ¤æˆæœ¬é«˜æ˜‚ã€‚</p>
</li>
<li>
<p><strong>æ–°è§„å†²å‡»ï¼š</strong> æœ€è¦å‘½çš„æ˜¯ï¼Œéšç€æˆæƒå¤ç”¨æœŸç¼©çŸ­è‡³ <strong>7 å°æ—¶</strong>ï¼Œç»­æœŸå¯¹å¤–éƒ¨ APIï¼ˆå¦‚ DNS æä¾›å•†ï¼‰ç¨³å®šæ€§çš„ä¾èµ–åº¦æé«˜ï¼Œä»»ä½•ä¸€æ¬¡ç½‘ç»œæŠ–åŠ¨éƒ½å¯èƒ½å¯¼è‡´ç»­æœŸå¤±è´¥ã€‚</p>
</li>
</ul>
<p>å¦‚æœä¸æƒ³èŠ±è´¹ç²¾åŠ›å»ç»´æŠ¤è¿™äº›å¤æ‚çš„è„šæœ¬ï¼Œä¹Ÿä¸æƒ³æ¯éš” 45 å¤©å°±æ‹…å¿ƒä¸€æ¬¡è¯ä¹¦æ˜¯å¦æ›´æ–°æˆåŠŸï¼Œé‚£èŠ±ç‚¹é’±ä¹°ä¸ª 1 å¹´æœŸçš„å•†ä¸šè¯ä¹¦æˆ–è®¸æ˜¯ç›®å‰æœ€çœå¿ƒçš„äº†ã€‚</p>
<h3 data-id="heading-8">å•†ä¸šè¯ä¹¦æ˜¯æ›´å¥½çš„é€‰æ‹©</h3>
<p>è¿‘æœŸï¼Œå¼€å‘å·¥å…·æä¾›å•† ServBay ä¸Šçº¿äº†å…¶èµ„æºå•†åº—ï¼Œå¹¶æä¾›äº†ä¸€é¡¹é’ˆå¯¹å¼€å‘è€…çš„æ”¯æŒè®¡åˆ’ã€‚</p>
<h4 data-id="heading-9"><strong>ServBay SSL èµ„æºæ¦‚è§ˆ</strong></h4>
<ul>
<li>
<p><strong>å…è´¹é¢†å–ï¼š</strong> å¹³å°æä¾›äº† 1000 å¼  1 å¹´æœŸ DV SSL è¯ä¹¦ã€‚åŸºäº Certum æ ¹è¯ä¹¦ï¼Œå…¼å®¹æ€§å¥½ï¼Œé¢†å–åé…ç½®ä¸€æ¬¡å³å¯ç®¡ä¸€å¹´ï¼Œæ— éœ€ä»»ä½•è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p>
</li>
<li>
<p><strong>ä½æˆæœ¬è®¢é˜…ï¼š</strong> å¦‚æœéœ€è¦å¤šå¼ è¯ä¹¦ï¼Œä¹Ÿå¯ä»¥å•ç‹¬è´­ä¹°ï¼Œä»–ä»¬çš„å®šä»·å¯ä»¥è¯´æ˜¯éå¸¸é¡¶äº†ï¼ˆå•åŸŸåç‰ˆ Â¥29 /å¹´ï¼Œé€šé…ç¬¦ç‰ˆ Â¥ 256 /å¹´ï¼‰ã€‚</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aeb58833a644521b3bc75351b7f8da1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356495&amp;x-signature=Vob4frFZEnhLB7CTuvkoCJ3TE3s%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å¦‚ä½•è·å–ï¼š</strong></p>
<ul>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Fstore" target="_blank" title="https://www.servbay.com/store" ref="nofollow noopener noreferrer">ServBay å®˜ç½‘è¿›å…¥ã€Œå•†åº—ã€</a>æ¿å—å³å¯æŸ¥çœ‹ã€‚æœ€ä¸‹æ–¹çš„å°±æœ‰å…è´¹çš„ä¸€å¹´æœŸè¯ä¹¦å¯ä»¥é¢†å–ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6988248c9ea4990befc23609942850d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356495&amp;x-signature=Lf6gPTlFP1pPHIMkZSet2OZIfUQ%3D" alt="" loading="lazy"/></p>
<p>å¯¹äºè¿½æ±‚ç¨³å®šã€å¸Œæœ›å‡å°‘è¿ç»´å¹²æ‰°çš„ä¸ªäººå¼€å‘è€…æˆ–ä¸­å°å›¢é˜Ÿï¼Œè¿™ä¸å¤±ä¸ºä¸€ä¸ªé«˜æ€§ä»·æ¯”çš„ Plan Bã€‚</p>
<hr/>
<h3 data-id="heading-10">æ€»ç»“</h3>
<p>HTTPS è¯ä¹¦æœ‰æ•ˆæœŸçš„ç¼©çŸ­æ˜¯ä¸å¯é€†è½¬çš„å®‰å…¨è¶‹åŠ¿ã€‚è™½ç„¶ 2028 å¹´å¬èµ·æ¥è¿˜å¾ˆé¥è¿œï¼Œä½†å¯¹äºè´Ÿè´£åŸºç¡€è®¾æ–½çš„è¿ç»´äººå‘˜æ¥è¯´ï¼Œç°åœ¨å°±å¼€å§‹æ£€æŸ¥è‡ªåŠ¨åŒ–è„šæœ¬çš„å…¼å®¹æ€§æ˜¯å¿…è¦çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°±åœ°ç¼–è¾‘åŠŸèƒ½å¼€å‘æŒ‡å—ï¼šä»ä»£ç åˆ°ä½“éªŒçš„ä¼˜é›…èœ•å˜]]></title>    <link>https://juejin.cn/post/7579190764766363688</link>    <guid>https://juejin.cn/post/7579190764766363688</guid>    <pubDate>2025-12-02T14:39:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579190764766363688" data-draft-id="7579088065697103912" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°±åœ°ç¼–è¾‘åŠŸèƒ½å¼€å‘æŒ‡å—ï¼šä»ä»£ç åˆ°ä½“éªŒçš„ä¼˜é›…èœ•å˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-02T14:39:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ €ç§‹666"/> <meta itemprop="url" content="https://juejin.cn/user/2566698322650307"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°±åœ°ç¼–è¾‘åŠŸèƒ½å¼€å‘æŒ‡å—ï¼šä»ä»£ç åˆ°ä½“éªŒçš„ä¼˜é›…èœ•å˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2566698322650307/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ €ç§‹666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:39:05.000Z" title="Tue Dec 02 2025 14:39:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<p>åœ¨ç°ä»£ Web åº”ç”¨ä¸­ï¼Œâ€œç‚¹å‡»è·³è½¬ â†’ ä¿®æ”¹è¡¨å• â†’ æäº¤è¿”å›â€è¿™ç§ä¼ ç»Ÿæ¨¡å¼æ—©å·²è¢«ç”¨æˆ·è¯Ÿç—…ã€‚å®ƒå‰²è£‚äº†ç”¨æˆ·çš„æ³¨æ„åŠ›æµï¼Œå¢åŠ äº†æ“ä½œæˆæœ¬ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œ<strong>è·³è½¬æš´æ”¿</strong>â€ã€‚è€Œ<strong>å°±åœ°ç¼–è¾‘ï¼ˆEdit in Placeï¼‰</strong> æ­£æ˜¯æ‰“ç ´è¿™ä¸€æ¡æ¢çš„å…³é”®äº¤äº’èŒƒå¼ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥å‰–æä¸€ä¸ªç»å…¸ä¸”å®ç”¨çš„ <code>EditInPlace</code> ç±»å®ç°ï¼Œä¸ä»…è®²è§£å…¶æ ¸å¿ƒé€»è¾‘ï¼Œæ›´ä»<strong>å·¥ç¨‹åŒ–è§†è§’</strong>å‡ºå‘ï¼Œè¡¥å……å¤§é‡å®æˆ˜æŠ€å·§å’Œè¿›é˜¶ä¼˜åŒ–ç­–ç•¥ï¼ŒåŠ©ä½ æ‰“é€ æ—¢ç¾è§‚åˆå¥å£®çš„å°±åœ°ç¼–è¾‘ç»„ä»¶ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦å°±åœ°ç¼–è¾‘ï¼Ÿâ€”â€” ç”¨æˆ·ä½“éªŒçš„é™æœ¬å¢æ•ˆ</h2>
<h3 data-id="heading-1">1.1 ä¼ ç»Ÿç¼–è¾‘æµç¨‹çš„ç—›ç‚¹</h3>
<p>è®¾æƒ³ä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>ç”¨æˆ·å‘ç°ä¸ªäººç®€ä»‹æœ‰é”™åˆ«å­—</li>
<li>ç‚¹å‡»ã€Œç¼–è¾‘èµ„æ–™ã€æŒ‰é’®</li>
<li>è·³è½¬åˆ°ç‹¬ç«‹é¡µé¢æˆ–å¼¹çª—</li>
<li>æ‰¾åˆ°å¯¹åº”å­—æ®µè¾“å…¥æ¡†</li>
<li>ä¿®æ”¹å†…å®¹</li>
<li>æ»šåŠ¨åˆ°åº•éƒ¨ç‚¹å‡»ã€Œä¿å­˜ã€</li>
<li>ç­‰å¾…æ¥å£å“åº” &amp; é¡µé¢åˆ·æ–°</li>
<li>è¿”å›åŸé¡µç¡®è®¤ä¿®æ”¹ç»“æœ</li>
</ul>
<p>æ•´ä¸ªè¿‡ç¨‹æ¶‰åŠ <strong>7+ æ­¥éª¤</strong>ï¼Œå…¶ä¸­åŒ…å«å¤šæ¬¡è§†è§‰ç„¦ç‚¹åˆ‡æ¢ä¸ç­‰å¾…æ—¶é—´ã€‚ç ”ç©¶è¡¨æ˜ï¼šæ¯å¢åŠ ä¸€æ­¥æ“ä½œï¼Œç”¨æˆ·å®Œæˆç‡ä¸‹é™çº¦ 20%ï¼ˆBaymard Instituteï¼‰ã€‚è€Œå°±åœ°ç¼–è¾‘å¯ä»¥å°†å…¶å‹ç¼©ä¸ºï¼š</p>
<blockquote>
<p><strong>ç‚¹å‡» â†’ è¾“å…¥ â†’ å›è½¦/ç‚¹å‡»ä¿å­˜</strong></p>
</blockquote>
<p>ä¸‰æ­¥é—­ç¯ï¼ŒçœŸæ­£å®ç°â€œæ‰€è§å³æ‰€æ”¹â€ã€‚</p>
<h3 data-id="heading-2">1.2 å°±åœ°ç¼–è¾‘çš„æ ¸å¿ƒä»·å€¼</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ–¹å¼</th><th>å°±åœ°ç¼–è¾‘</th></tr></thead><tbody><tr><td>æ“ä½œè·¯å¾„é•¿åº¦</td><td>é•¿ï¼ˆå¤šè·³è½¬ï¼‰</td><td>æçŸ­ï¼ˆé›¶è·³è½¬ï¼‰</td></tr><tr><td>æ³¨æ„åŠ›ä¸­æ–­</td><td>å¼ºï¼ˆä¸Šä¸‹æ–‡ä¸¢å¤±ï¼‰</td><td>å¼±ï¼ˆä¿æŒèšç„¦ï¼‰</td></tr><tr><td>å¼€å‘å¤æ‚åº¦</td><td>ä¸­ç­‰ï¼ˆéœ€ç»´æŠ¤å®Œæ•´è¡¨å•ï¼‰</td><td>è¾ƒé«˜ï¼ˆçŠ¶æ€ç®¡ç† + å®æ—¶åé¦ˆï¼‰</td></tr><tr><td>ç”¨æˆ·æ»¡æ„åº¦</td><td>ä¸€èˆ¬</td><td>é«˜ï¼ˆæµç•…è‡ªç„¶ï¼‰</td></tr></tbody></table>
<blockquote>
<p>âœ… ç»“è®ºï¼š<strong>å‡å°‘è®¤çŸ¥è´Ÿè·ï¼Œæå‡æ“ä½œæ•ˆç‡ï¼Œå¢å¼ºäº§å“è´¨æ„Ÿ</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-3">äºŒã€é¢å‘å¯¹è±¡è®¾è®¡ï¼šæ„å»ºå¯å¤ç”¨çš„ <code>EditInPlace</code> ç±»</h2>
<p>æˆ‘ä»¬å°†é‡‡ç”¨ç»å…¸çš„ JavaScript æ„é€ å‡½æ•° + åŸå‹æ¨¡å¼æ¥å°è£…è¿™ä¸ªç»„ä»¶ï¼Œå…¼é¡¾å…¼å®¹æ€§ä¸ç»“æ„æ¸…æ™°åº¦ã€‚</p>
<h3 data-id="heading-4">2.1 ç±»çš„åŸºæœ¬éª¨æ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å°±åœ°ç¼–è¾‘ç»„ä»¶æ„é€ å™¨
 * <span class="hljs-doctag">@class</span> <span class="hljs-variable">EditInPlace</span>
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">id</span> - å…ƒç´ å”¯ä¸€æ ‡è¯†
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">value</span> - åˆå§‹æ˜¾ç¤ºå€¼
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HTMLElement</span>} <span class="hljs-variable">parentElement</span> - å®¹å™¨æŒ‚è½½ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">options</span> - é…ç½®é¡¹ï¼ˆæ‰©å±•ç”¨ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">EditInPlace</span>(<span class="hljs-params">id, value, parentElement, options = {}</span>) {
  <span class="hljs-comment">// æ ¸å¿ƒå±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span> = parentElement;

  <span class="hljs-comment">// DOM å¼•ç”¨ç¼“å­˜ï¼ˆé¿å…é‡å¤æŸ¥è¯¢ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-literal">null</span>;     <span class="hljs-comment">// å±•ç¤ºæ€æ–‡æœ¬</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-literal">null</span>;      <span class="hljs-comment">// ç¼–è¾‘æ€è¾“å…¥æ¡†</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-comment">// é…ç½®é¡¹åˆå¹¶</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({
    <span class="hljs-attr">tagName</span>: <span class="hljs-string">'span'</span>,           <span class="hljs-comment">// åŒ…è£¹æ ‡ç­¾ç±»å‹</span>
    <span class="hljs-attr">inputType</span>: <span class="hljs-string">'text'</span>,         <span class="hljs-comment">// è¾“å…¥æ¡†ç±»å‹</span>
    <span class="hljs-attr">maxLength</span>: <span class="hljs-number">100</span>,            <span class="hljs-comment">// æœ€å¤§å­—ç¬¦é™åˆ¶</span>
    <span class="hljs-attr">placeholder</span>: <span class="hljs-string">''</span>,           <span class="hljs-comment">// è¾“å…¥æç¤º</span>
    <span class="hljs-attr">autoSave</span>: <span class="hljs-literal">false</span>,           <span class="hljs-comment">// æ˜¯å¦å¯ç”¨è‡ªåŠ¨ä¿å­˜ï¼ˆå¤±ç„¦å³ä¿å­˜ï¼‰</span>
    <span class="hljs-attr">debounceTime</span>: <span class="hljs-number">300</span>,         <span class="hljs-comment">// é˜²æŠ–å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰</span>
    <span class="hljs-attr">onSave</span>: <span class="hljs-literal">null</span>,              <span class="hljs-comment">// ä¿å­˜å›è°ƒ (value) =&gt; Promise</span>
    <span class="hljs-attr">onCancel</span>: <span class="hljs-literal">null</span>             <span class="hljs-comment">// å–æ¶ˆå›è°ƒ</span>
  }, options);

  <span class="hljs-comment">// åˆå§‹åŒ–</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>();
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEvents</span>();
}
</code></pre>
<p>ğŸ“Œ <strong>è®¾è®¡äº®ç‚¹è§£æ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>Object.assign</code> æ”¯æŒçµæ´»é…ç½®ï¼Œä¾¿äºåæœŸæ‰©å±•</li>
<li>DOM å¼•ç”¨é¢„å­˜ï¼Œæé«˜æ€§èƒ½</li>
<li>å›è°ƒå‡½æ•°é¢„ç•™é’©å­ï¼Œæ”¯æŒä¸šåŠ¡å±‚ä»‹å…¥ï¼ˆå¦‚è°ƒç”¨ APIï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€DOM åˆ›å»ºï¼šé«˜æ•ˆæ„å»º UI ç»“æ„</h2>
<h3 data-id="heading-6">3.1 åˆ›å»ºæ–¹æ³•è¯¦è§£</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">createElement</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>;

  <span class="hljs-comment">// ã€1ã€‘åˆ›å»ºæœ€å¤–å±‚å®¹å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'eip-container'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">id</span> = <span class="hljs-string">`eip-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.id}</span>`</span>;

  <span class="hljs-comment">// ã€2ã€‘åˆ›å»ºé™æ€å±•ç¤ºå…ƒç´ </span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">tagName</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'eip-static'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'pointer'</span>; <span class="hljs-comment">// æç¤ºå¯ç‚¹å‡»</span>

  <span class="hljs-comment">// ã€3ã€‘åˆ›å»ºè¾“å…¥æ¡†</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">type</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">inputType</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'eip-field'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">maxLength</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxLength</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">placeholder</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">placeholder</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// é»˜è®¤éšè—</span>

  <span class="hljs-comment">// ã€4ã€‘åˆ›å»ºæ“ä½œæŒ‰é’®ç»„</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'eip-btn eip-save'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'âœ”'</span>;

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">className</span> = <span class="hljs-string">'eip-btn eip-cancel'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'âœ˜'</span>;

  <span class="hljs-comment">// æŒ‰é’®é»˜è®¤éšè—</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;

  <span class="hljs-comment">// ã€5ã€‘ç»„è£…æ‰€æœ‰å…ƒç´ </span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>);

  <span class="hljs-comment">// ã€6ã€‘æŒ‚è½½åˆ°çˆ¶å®¹å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>);

  <span class="hljs-comment">// ã€7ã€‘åˆå§‹çŠ¶æ€è®¾ç½®</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
};
</code></pre>
<p>ğŸ”§ <strong>æœ€ä½³å®è·µå»ºè®®</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰ DOM æ“ä½œåœ¨å†…å­˜ä¸­å®Œæˆåå†ä¸€æ¬¡æ€§æ’å…¥æ–‡æ¡£ï¼ˆå‡å°‘é‡æ’é‡ç»˜ï¼‰</li>
<li>ä½¿ç”¨è¯­ä¹‰åŒ– class åç§°ï¼Œæ–¹ä¾¿åç»­ CSS æ§åˆ¶</li>
<li>è®¾ç½® <code>cursor: pointer</code> æ˜ç¡®äº¤äº’æ„å›¾</li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€çŠ¶æ€åˆ‡æ¢æœºåˆ¶ï¼šå±•ç¤ºæ€ â†” ç¼–è¾‘æ€</h2>
<p>è¿™æ˜¯æ•´ä¸ªç»„ä»¶çš„çµé­‚æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-8">4.1 å±•ç¤ºæ€ â†’ ç¼–è¾‘æ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">convertToField</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>;

  <span class="hljs-comment">// åŒæ­¥æœ€æ–°å€¼åˆ°è¾“å…¥æ¡†</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;

  <span class="hljs-comment">// åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline-block'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline-block'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline-block'</span>;

  <span class="hljs-comment">// èšç„¦å¹¶é€‰ä¸­æ–‡æœ¬ï¼ˆæå‡ç¼–è¾‘ä½“éªŒï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">focus</span>();
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">select</span>();

  <span class="hljs-comment">// è§¦å‘è¿›å…¥ç¼–è¾‘äº‹ä»¶ï¼ˆå¯ç”¨äºåŸ‹ç‚¹ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_triggerEvent</span>(<span class="hljs-string">'onEditStart'</span>);
};
</code></pre>
<p>ğŸ¯ <strong>ç”¨æˆ·ä½“éªŒä¼˜åŒ–ç‚¹</strong>ï¼š</p>
<ul>
<li><code>focus()</code> è‡ªåŠ¨è·å–ç„¦ç‚¹</li>
<li><code>select()</code> å…¨é€‰æ–‡æœ¬ï¼Œç”¨æˆ·å¯ç›´æ¥è¦†ç›–è¾“å…¥</li>
</ul>
<h3 data-id="heading-9">4.2 ç¼–è¾‘æ€ â†’ å±•ç¤ºæ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">convertToText</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ›´æ–°é™æ€æ–‡æœ¬å†…å®¹</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;

  <span class="hljs-comment">// éšè—ç¼–è¾‘ç›¸å…³å…ƒç´ </span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;

  <span class="hljs-comment">// è§¦å‘é€€å‡ºç¼–è¾‘äº‹ä»¶</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_triggerEvent</span>(<span class="hljs-string">'onEditEnd'</span>);
};
</code></pre>
<p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼šè¿™é‡Œæ›´æ–°çš„æ˜¯ <code>textContent</code>ï¼Œé˜²æ­¢ XSS æ³¨å…¥ï¼›è‹¥éœ€å¯Œæ–‡æœ¬æ”¯æŒï¼Œè¯·ä½¿ç”¨ <code>innerHTML</code> å¹¶åšå¥½è¿‡æ»¤ã€‚</p>
<hr/>
<h2 data-id="heading-10">äº”ã€äº‹ä»¶ç»‘å®šç³»ç»Ÿï¼šè®©ç»„ä»¶â€œæ´»â€èµ·æ¥</h2>
<h3 data-id="heading-11">5.1 ä½¿ç”¨ç®­å¤´å‡½æ•°ç¡®ä¿ä¸Šä¸‹æ–‡æ­£ç¡®</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">attachEvents</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>;

  <span class="hljs-comment">// ã€1ã€‘ç‚¹å‡»é™æ€æ–‡æœ¬è¿›å…¥ç¼–è¾‘</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    self.<span class="hljs-title function_">convertToField</span>();
  });

  <span class="hljs-comment">// ã€2ã€‘ä¿å­˜æŒ‰é’®</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    self.<span class="hljs-title function_">save</span>();
  });

  <span class="hljs-comment">// ã€3ã€‘å–æ¶ˆæŒ‰é’®</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    self.<span class="hljs-title function_">cancel</span>();
  });

  <span class="hljs-comment">// ã€4ã€‘è¾“å…¥æ¡†å›è½¦ä¿å­˜ï¼ŒESC å–æ¶ˆ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span>) {
      e.<span class="hljs-title function_">preventDefault</span>();
      self.<span class="hljs-title function_">save</span>();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Escape'</span>) {
      self.<span class="hljs-title function_">cancel</span>();
    }
  });

  <span class="hljs-comment">// ã€5ã€‘å¤±ç„¦è‡ªåŠ¨ä¿å­˜ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">autoSave</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'blur'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> self.<span class="hljs-title function_">save</span>(), <span class="hljs-number">100</span>); <span class="hljs-comment">// å»¶è¿Ÿé¿å… cancel å†²çª</span>
    });
  }
};
</code></pre>
<p>âœ… <strong>å…³é”®ç‚¹è¯´æ˜</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰äº‹ä»¶å¤„ç†å™¨å‡ä½¿ç”¨ <strong>ç®­å¤´å‡½æ•°</strong> æˆ–é—­åŒ…æ•è· <code>self</code>ï¼Œä¿è¯ <code>this</code> æŒ‡å‘å®ä¾‹</li>
<li>æ”¯æŒé”®ç›˜å¿«æ·é”®ï¼Œæå‡å¯è®¿é—®æ€§ï¼ˆa11yï¼‰</li>
<li><code>blur</code> äº‹ä»¶åŠ  <code>setTimeout</code> æ˜¯ä¸ºäº†é˜²æ­¢ä¸ cancel æŒ‰é’®å†²çªï¼ˆç‚¹å‡» cancel ä¹Ÿä¼šè§¦å‘ blurï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-12">å…­ã€æ€»ç»“ï¼šå¥½äº¤äº’è—åœ¨ç»†èŠ‚é‡Œ</h2>
<p>å°±åœ°ç¼–è¾‘è™½æ˜¯ä¸€ä¸ªå°åŠŸèƒ½ï¼Œå´ä½“ç°äº†ç°ä»£å‰ç«¯å¼€å‘çš„æ ¸å¿ƒç†å¿µï¼š</p>
<blockquote>
<p><strong>ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„è®¾è®¡ Ã— å·¥ç¨‹åŒ–çš„ä»£ç ç»„ç»‡ Ã— å¯¹ç»†èŠ‚çš„æè‡´è¿½æ±‚</strong></p>
</blockquote>
<p>é€šè¿‡æœ¬æ–‡çš„ <code>EditInPlace</code> å®ç°ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡ï¼š</p>
<ul>
<li>å¦‚ä½•ç”¨é¢å‘å¯¹è±¡æ€æƒ³å°è£…å¯å¤ç”¨ç»„ä»¶</li>
<li>DOM æ“ä½œçš„æœ€ä½³å®è·µï¼ˆæ‰¹é‡åˆ›å»ºã€å¼•ç”¨ç¼“å­˜ï¼‰</li>
<li>äº‹ä»¶ç»‘å®šä¸­çš„ <code>this</code> é™·é˜±è§„é¿</li>
<li>çŠ¶æ€ç®¡ç†ä¸äº¤äº’é—­ç¯è®¾è®¡</li>
<li>ç”¨æˆ·ä½“éªŒå±‚é¢çš„å¤šé¡¹ä¼˜åŒ–æ‰‹æ®µ</li>
</ul>
<hr/>
<p>ğŸ’¬ <strong>äº’åŠ¨è¯é¢˜</strong>ï¼šä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦‚ä½•å®ç°å°±åœ°ç¼–è¾‘çš„ï¼Ÿæœ‰æ²¡æœ‰é‡åˆ°è¿‡å¹¶å‘ä¿®æ”¹ã€æƒé™æ§åˆ¶ç­‰é—®é¢˜ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAG + Agent + Promptå·¥ç¨‹ä¸Š]]></title>    <link>https://juejin.cn/post/7579096485355798578</link>    <guid>https://juejin.cn/post/7579096485355798578</guid>    <pubDate>2025-12-02T13:35:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579096485355798578" data-draft-id="7579068270294188058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAG + Agent + Promptå·¥ç¨‹ä¸Š"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-12-02T13:35:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å›½å®¶ä¸ä¿æŠ¤åºŸç‰©"/> <meta itemprop="url" content="https://juejin.cn/user/1220936035210004"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAG + Agent + Promptå·¥ç¨‹ä¸Š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1220936035210004/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å›½å®¶ä¸ä¿æŠ¤åºŸç‰©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:35:38.000Z" title="Tue Dec 02 2025 13:35:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    22
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RAG + Agent + Promptå·¥ç¨‹ä¸Š</h2>
<h3 data-id="heading-1">é¦–å…ˆä»‹ç»ä¸€ä¸‹ragæ˜¯ä»€ä¹ˆå§</h3>
<p>ç›¸ä¿¡ä½ ä»¬åœ¨æ—¥å¸¸ä½¿ç”¨aiä¸­ï¼Œéƒ½ä¼šé‡åˆ°aièƒ¡è¯´å…«é“çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯å½“æé—®ä¸€äº›æ¯”è¾ƒä¸“ä¸šçš„é—®é¢˜æ—¶ï¼Œè€Œragçš„ä½œç”¨å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„å‘é‡æ•°æ®åº“ï¼Œæ¯æ¬¡è¯¢é—®aiæ—¶å°±ä¼šå…ˆå°†æˆ‘ä»¬çš„é—®é¢˜ä¸æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œä¸€ä¸ªç›¸ä¼¼æ€§æœç´¢ï¼Œå°†ç›¸ä¼¼åº¦è¾¾åˆ°ä¸€å®šæ°´å¹³æ—¶ä¾¿å°†æ”¹æ•°æ®åº“ä¸­çš„è¯¥æ®µå†…å®¹åŠ å…¥æˆ‘çš„æé—®ä¸­ä¸€èµ·ç»™å¤§æ¨¡å‹ï¼Œä»¥åšåˆ°ä¸€ä¸ªä¸°å¯Œå†…å®¹çš„æ•ˆæœ</p>
<h3 data-id="heading-2">è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šé¡¹ç›®</h3>
<p>å…ˆæ¥ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ä¾‹å­è¯•è¯•æ°´</p>
<p>æˆ‘ä»¬è¦å®ç°çš„åŠŸèƒ½æ˜¯ï¼šå°†æˆ‘çš„ç®€å†ä¼ å…¥ï¼Œæˆ‘å¯ä»¥è¯¢é—®aiæœ‰å…³æˆ‘è‡ªå·±çš„é—®é¢˜ï¼Œå¹¶å¾—åˆ°æ»¡æ„çš„ç­”æ¡ˆ</p>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åˆ°æŠ€æœ¯æ ˆæ˜¯ï¼šOllama + LangChain.js + Supabaseï¼ˆpgvectorï¼‰+ Node.js</p>
<ul>
<li><strong>Ollama</strong>ï¼šä¸€ä¸ªæœ¬åœ°è¿è¡Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å·¥å…·ï¼Œæ”¯æŒä¸€é”®ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç†å¼€æºæ¨¡å‹ï¼ˆå¦‚ Llama 3ã€DeepSeekã€Nomic ç­‰ï¼‰ã€‚åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥æä¾›ä¸¤ä¸ªèƒ½åŠ›ï¼šä¸€æ˜¯é€šè¿‡ <code>nomic-embed-text</code> æ¨¡å‹ç”Ÿæˆæ–‡æœ¬çš„å‘é‡åµŒå…¥ï¼ˆembeddingï¼‰ï¼ŒäºŒæ˜¯é€šè¿‡ <code>deepseek-v3.1:671b-cloud</code> æ¨¡å‹å›ç­”ç”¨æˆ·é—®é¢˜ã€‚æ‰€æœ‰æ¨ç†éƒ½åœ¨æœ¬åœ°å®Œæˆï¼Œæ— éœ€è”ç½‘æˆ–ä»˜è´¹ã€‚</li>
<li><strong>LangChain.js</strong>ï¼šLangChain çš„ JavaScript/TypeScript å®ç°ï¼Œæ˜¯ä¸€ä¸ªä¸“ä¸ºæ„å»º LLM åº”ç”¨è®¾è®¡çš„å¼€å‘æ¡†æ¶ã€‚å®ƒæä¾›äº†æ ‡å‡†åŒ–çš„ç»„ä»¶ï¼ˆå¦‚æ–‡æ¡£åŠ è½½å™¨ã€æ–‡æœ¬åˆ†å‰²å™¨ã€å‘é‡å­˜å‚¨æ¥å£ã€æç¤ºæ¨¡æ¿ã€é“¾å¼è°ƒç”¨ç­‰ï¼‰ï¼Œè®©æˆ‘ä»¬èƒ½å¿«é€Ÿæ­å»º RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿã€‚åœ¨æœ¬é¡¹ç›®ä¸­ï¼ŒLangChain è´Ÿè´£ï¼šè¯»å– PDF ç®€å† â†’ åˆ‡åˆ†æ–‡æœ¬ â†’ è°ƒç”¨ Ollama ç”Ÿæˆ embedding â†’ å°†å‘é‡å­˜å…¥ Supabase â†’ åœ¨é—®ç­”æ—¶æ£€ç´¢ç›¸å…³ç‰‡æ®µ â†’ æ„é€ å¸¦ä¸Šä¸‹æ–‡çš„ prompt å¹¶äº¤ç”± LLM å›ç­”ã€‚å¯ä»¥è¯´ï¼Œ<strong>LangChain æ˜¯ä¸²è”æ•´ä¸ª RAG æµç¨‹çš„â€œèƒ¶æ°´â€å’Œâ€œè„šæ‰‹æ¶â€</strong> ã€‚</li>
<li><strong>Supabaseï¼ˆé›†æˆ pgvectorï¼‰</strong> ï¼šä¸€ä¸ªå¼€æºçš„ Firebase æ›¿ä»£å“ï¼Œåº•å±‚åŸºäº PostgreSQLã€‚æˆ‘ä»¬ç‰¹åˆ«å¯ç”¨äº†å®ƒçš„ <code>pgvector</code> æ‰©å±•ï¼Œä½¿å…¶å…·å¤‡<strong>å‘é‡å­˜å‚¨ä¸ç›¸ä¼¼åº¦æœç´¢</strong>èƒ½åŠ›ã€‚åœ¨æœ¬é¡¹ç›®ä¸­ï¼ŒSupabase å……å½“<strong>å‘é‡æ•°æ®åº“</strong>çš„è§’è‰²ï¼šå­˜å‚¨æ¯æ®µç®€å†æ–‡æœ¬åŠå…¶å¯¹åº”çš„ 768 ç»´ embedding å‘é‡ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰çš„ <code>match_documents</code> å‡½æ•°ï¼Œæ ¹æ®ç”¨æˆ·é—®é¢˜çš„å‘é‡å¿«é€Ÿæ£€ç´¢å‡ºæœ€ç›¸å…³çš„ç®€å†ç‰‡æ®µã€‚ç›¸æ¯”æœ¬åœ°å†…å­˜æˆ–æ–‡ä»¶å­˜å‚¨ï¼ŒSupabase æä¾›äº†æŒä¹…åŒ–ã€å¯æ‰©å±•ã€æ”¯æŒå¤æ‚æŸ¥è¯¢çš„äº‘ç«¯å‘é‡æ£€ç´¢æœåŠ¡ã€‚</li>
<li><strong>Node.js</strong>ï¼šä½œä¸ºè¿è¡Œæ—¶ç¯å¢ƒï¼Œæ”¯æ’‘æ•´ä¸ª JavaScript åº”ç”¨çš„æ‰§è¡Œï¼ŒåŒ…æ‹¬æ–‡ä»¶è¯»å–ã€HTTP è¯·æ±‚ï¼ˆä¸ Ollama å’Œ Supabase é€šä¿¡ï¼‰ã€å¼‚æ­¥æµç¨‹æ§åˆ¶ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-3">LangChainç”Ÿæ€ç³»ç»Ÿ</h4>
<p>LangChain æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œç”¨äº<strong>æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„åº”ç”¨ç¨‹åº</strong>ã€‚å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š<strong>è®© LLM èƒ½å¤Ÿä¸å¤–éƒ¨æ•°æ®ã€å·¥å…·å’Œé€»è¾‘ç»“åˆï¼Œä»è€Œæ‰“é€ æ›´å¼ºå¤§ã€å¯æ§ã€å®ç”¨çš„ AI åº”ç”¨</strong>ã€‚</p>
<p><strong>LangChain = è®©å¤§æ¨¡å‹â€œèƒ½å¹²æ´»â€çš„è„šæ‰‹æ¶ â€”â€” æ¥æ•°æ®ã€è¿å·¥å…·ã€è®°å†å²ã€åšå†³ç­–ã€‚</strong>
LangChainä½¿è¿™äº›å¤æ‚æµç¨‹å˜å¾—ç®€å•ï¼Œè®©å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œä¸æ˜¯åº•å±‚å®ç°ç»†èŠ‚ã€‚</p>
<p><strong>1. é“¾(Chains)</strong></p>
<p>é“¾æ˜¯LangChainçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå…è®¸å°†å¤šä¸ªç»„ä»¶æŒ‰ç‰¹å®šé¡ºåºç»„åˆèµ·æ¥ï¼Œå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â ç®€å•é“¾ç¤ºä¾‹</span>
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">LLMChain</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/chains"</span>;
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">ChatOpenAI</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/
chat_models/openai"</span>;
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">PromptTemplate</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/
prompts"</span>;

<span class="hljs-keyword">const</span>Â llmÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ChatOpenAI</span>({Â <span class="hljs-attr">temperature</span>:Â <span class="hljs-number">0.9</span>Â });
<span class="hljs-keyword">const</span>Â promptÂ =Â <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">"ä»€ä¹ˆ
æ˜¯{topic}?"</span>);
<span class="hljs-keyword">const</span>Â chainÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">LLMChain</span>({Â llm,Â promptÂ });
<span class="hljs-keyword">const</span>Â resultÂ =Â <span class="hljs-keyword">await</span>Â chain.<span class="hljs-title function_">call</span>({Â <span class="hljs-attr">topic</span>:Â <span class="hljs-string">"äººå·¥æ™ºèƒ½
"</span>Â });
</code></pre>
<p><strong>2. æ¨¡å‹(Models)</strong></p>
<p>LangChainæ”¯æŒå¤šç§ç±»å‹çš„æ¨¡å‹ï¼š</p>
<ul>
<li>LLMs : æ–‡æœ¬ç”Ÿæˆæ¨¡å‹</li>
<li>Chat Models : å¯¹è¯æ¨¡å‹ï¼Œæ”¯æŒç»“æ„åŒ–æ¶ˆæ¯</li>
<li>Text Embedding Models : æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œç”¨äºå‘é‡è¡¨ç¤º</li>
</ul>
<p><strong>3. æç¤ºè¯(Prompts)</strong></p>
<p>æä¾›æ¨¡æ¿åŒ–ç®¡ç†å’Œä¼˜åŒ–æç¤ºè¯çš„å·¥å…·ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">PromptTemplate</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/
prompts"</span>;

<span class="hljs-keyword">const</span>Â promptÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">PromptTemplate</span>({
Â Â <span class="hljs-attr">template</span>:Â <span class="hljs-string">"è¯·ç”¨{style}é£æ ¼è§£é‡Š{topic}"</span>,
Â Â <span class="hljs-attr">inputVariables</span>:Â [<span class="hljs-string">"style"</span>,Â <span class="hljs-string">"topic"</span>]
});
</code></pre>
<p><strong>4. ç´¢å¼•(Indexes)</strong></p>
<p>ç”¨äºç»“æ„åŒ–å’Œæ£€ç´¢å¤–éƒ¨æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>Document Loaders : ä»å„ç§æ•°æ®æºåŠ è½½æ–‡æ¡£</li>
<li>Text Splitters : å°†é•¿æ–‡æœ¬åˆ†å‰²æˆå¯ç®¡ç†çš„å—</li>
<li>Vector Stores : å­˜å‚¨å’Œæ£€ç´¢å‘é‡åµŒå…¥</li>
<li>Retrievers : ä»å­˜å‚¨ä¸­æ£€ç´¢ç›¸å…³æ–‡æ¡£</li>
</ul>
<p><strong>5. è®°å¿†(Memory)</strong></p>
<p>ä¸ºé“¾å’Œä»£ç†æä¾›æŒä¹…åŒ–çŠ¶æ€ï¼Œä½¿å¯¹è¯å…·æœ‰ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">ConversationBufferMemory</span>Â }Â <span class="hljs-keyword">from</span>Â 
<span class="hljs-string">"langchain/memory"</span>;

<span class="hljs-keyword">const</span>Â memoryÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ConversationBufferMemory</span>({
Â Â <span class="hljs-attr">memoryKey</span>:Â <span class="hljs-string">"chat_history"</span>,
Â Â <span class="hljs-attr">returnMessages</span>:Â <span class="hljs-literal">true</span>
});
</code></pre>
<p><strong>6. ä»£ç†(Agents)</strong></p>
<p>ä»£ç†ä½¿ç”¨LLMå†³å®šæ‰§è¡Œå“ªäº›åŠ¨ä½œï¼Œå¯ä»¥åŠ¨æ€é€‰æ‹©å·¥å…·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â initializeAgentExecutorÂ }Â <span class="hljs-keyword">from</span>Â 
<span class="hljs-string">"langchain/agents"</span>;
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">SerpAPI</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/tools"</span>;
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">Calculator</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"langchain/tools"</span>;

<span class="hljs-keyword">const</span>Â toolsÂ =Â [<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">SerpAPI</span>(),Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Calculator</span>()];
<span class="hljs-keyword">const</span>Â agentÂ =Â <span class="hljs-keyword">await</span>Â initializeAgentExecutor
(tools,Â llm,Â <span class="hljs-string">"zero-shot-react-description"</span>);
</code></pre>
<p><strong>JavaScript/TypeScriptç‰ˆæœ¬</strong></p>
<ul>
<li>langchain : æ ¸å¿ƒåº“</li>
<li>@langchain/openai : OpenAIé›†æˆ</li>
<li>@langchain/community : ç¤¾åŒºè´¡çŒ®çš„é›†æˆ</li>
<li>langchain/chains : é¢„æ„å»ºé“¾</li>
<li>langchain/embeddings : åµŒå…¥æ¨¡å‹</li>
</ul>
<h4 data-id="heading-4">å¦‚ä½•å»å­˜å‚¨æˆ‘ä¼ å…¥çš„æ•°æ®</h4>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“äº†aiä¼šå°†æˆ‘ä»¬çš„é—®é¢˜ä¸æ•°æ®åº“ä¸­çš„æ¯ä¸€æ¡æ•°æ®è¿›è¡Œç›¸ä¼¼æ€§æœç´¢ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å»ä½¿ç”¨<strong>å‘é‡æ•°æ®åº“</strong>å»å­˜å‚¨æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œå°†ä¿¡æ¯ä»¥å‘é‡çš„å½¢å¼å­˜å‚¨ä¾¿äºæˆ‘ä»¬è¿›è¡Œç›¸ä¼¼æ€§æœç´¢ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­æˆ‘ä»¬ä½¿ç”¨åˆ°çš„æ˜¯çº¿ä¸Šæ•°æ®åº“supabase(å½“ç„¶ç”±äºè¿™æ˜¯ä¸€ä¸ªçº¿ä¸Šæ•°æ®åº“ï¼Œåç»­å°±éš¾å…æ¶‰åŠåˆ°æ”¶è´¹ç­‰é—®é¢˜ï¼Œä¸»åŒ…å°±æ˜¯åœ¨åˆ›äº†ä¸¤ä¸ªæ•°æ®åº“åè¦æ”¶æˆ‘çš„é’±äº†ï¼Œä¸ç„¶ä½ ä¹‹å‰çš„æ•°æ®å°±æ²¡äº†)ï¼Œé‚£å…·ä½“å¦‚ä½•å»ç”¨å‘¢ï¼Ÿ</p>
<h5 data-id="heading-5">ç¯å¢ƒé…ç½®</h5>
<pre><code class="hljs language-.env" lang=".env"># Supabase é…ç½®
SUPABASE_URL=æ¯ä¸ªåº“å¯¹åº”ä¸€ä¸ªurl
SUPABASE_ANON_KEY=
SUPABASE_TABLE_NAME=documents
</code></pre>
<p>åœ¨ä¸‹å›¾çš„ä½ç½®å¯ä»¥æ‰¾åˆ°url
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea8ef042d71047faa62a54a5dc6763ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765332827&amp;x-signature=oFY%2FPjXtFM3C0U%2Bd8WmHj4XKqKM%3D" alt="image.png" loading="lazy"/></p>
<p>apiçš„è¯è¦æ³¨æ„æœ‰ä¸¤ä¸ªï¼Œè€Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å°±æ˜¯ä¸Šé¢<code>anon``public</code>çš„é‚£ä¸ªapi</p>
<blockquote>
<ul>
<li>anon å¯†é’¥ åº”è¯¥åªç”¨äºå®¢æˆ·ç«¯åº”ç”¨ï¼Œæƒé™å—é™ï¼Œé»˜è®¤åªèƒ½è¯»å–å…¬å¼€æ•°æ®</li>
<li>service_role å¯†é’¥ åº”è¯¥ç”¨äºæœåŠ¡ç«¯æ“ä½œï¼Œæ‹¥æœ‰å®Œå…¨æƒé™ï¼Œå¯ä»¥ç»•è¿‡æ‰€æœ‰è¡Œçº§å®‰å…¨ç­–ç•¥(RLS)</li>
</ul>
<p>è€Œæˆ‘ä»¬ä½¿ç”¨ anon å¯†é’¥èƒ½å¤Ÿå†™å…¥æ•°æ®çš„åŸå› æ˜¯ï¼šè¡¨æƒé™è®¾ç½® ï¼šdocumentsè¡¨æ²¡æœ‰å¯ç”¨RLSï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•æœ‰æ•ˆçš„APIå¯†é’¥ï¼ˆåŒ…æ‹¬anonå¯†é’¥ï¼‰éƒ½æœ‰æƒé™æ’å…¥æ•°æ®ã€‚è™½ç„¶è¿™æ ·ä¸å¤ªå®‰å…¨</p>
<p>æ›´å®‰å…¨çš„åšæ³•åº”è¯¥æ˜¯ï¼š</p>
<ol>
<li>å¯ç”¨RLSï¼š ALTER TABLE public.documents ENABLE ROW LEVEL SECURITY;</li>
<li>åˆ›å»ºé€‚å½“çš„ç­–ç•¥ï¼Œä¾‹å¦‚ï¼š
<ul>
<li>å…è®¸æ‰€æœ‰äººè¯»å–ï¼š CREATE POLICY "Enable read access for all users" ON public.documents FOR SELECT USING (true);</li>
<li>åªå…è®¸æœåŠ¡è§’è‰²å†™å…¥ï¼š CREATE POLICY "Enable insert for service role only" ON public.documents FOR INSERT WITH CHECK (current_setting('request.jwt.claims', true)::json-&gt;&gt;'role' = 'service_role');
è¿™æ ·å°±å¯ä»¥ç¡®ä¿åªæœ‰æœåŠ¡ç«¯ï¼ˆä½¿ç”¨service_roleå¯†é’¥ï¼‰æ‰èƒ½å†™å…¥æ•°æ®ï¼Œè€Œå®¢æˆ·ç«¯ï¼ˆä½¿ç”¨anonå¯†é’¥ï¼‰åªèƒ½è¯»å–æ•°æ®ã€‚</li>
</ul>
</li>
</ol>
<p>ä½†æ˜¯æˆ‘ä»¬å…ˆä¸è€ƒè™‘é‚£ä¹ˆè¿œï¼Œå…ˆå·ä¸ªæ‡’ï¼Œå°±è¿™æ ·</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0214d5ed10b14806b91291fc6e27aecf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765332827&amp;x-signature=r3%2BtyGZwq4N1TFh0B4NjOg4OuMI%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-6">åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ä¸­çš„æ•°æ®è¡¨</h5>
<p>åœ¨supabaseå®˜ç½‘ä¸­æ‰¾åˆ°ç¼–è¾‘è¡¨çš„åœ°æ–¹ï¼Œé€‰æ‹©è¿™ä¸ªï¼Œä¾¿å¯ä»¥ç›´æ¥ä½¿ç”¨sqlè¯­å¥å»åˆ›å»ºè¡¨äº†
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44ad5491e5eb430ea9a1457bd0b7a6e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765332827&amp;x-signature=9KIXlEUCS4z6I%2FChONPnFyG1IrM%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„è¦å¯åŠ¨ pgvector æ‰©å±•ï¼Œå¦åˆ™å°†ä¼šåˆ›å»ºå¤±è´¥ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸ä»…å£°æ˜äº†è¡¨çš„ç»“æ„è¿˜åˆ›å»ºäº†å‘é‡ç›¸ä¼¼åº¦æœç´¢å‡½æ•°ï¼Œåç»­è¿›è¡Œç›¸ä¼¼åº¦åˆ¤æ–­æ—¶ä¼šä½¿ç”¨åˆ°è¿™ä¸ªå‡½æ•°</p>
<pre><code class="hljs language-js" lang="js">-- å¯ç”¨ pgvector æ‰©å±•
<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">EXTENSION</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">EXISTS</span> vector;


-- åˆ›å»º documents è¡¨ï¼ˆæ ¹æ®é¡¹ç›®é…ç½®ä½¿ç”¨documentsä½œä¸ºè¡¨åï¼‰
<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">TABLE</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">EXISTS</span> public.<span class="hljs-property">documents</span> (
    id uuid <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span> <span class="hljs-variable constant_">DEFAULT</span> <span class="hljs-title function_">gen_random_uuid</span>(),
    content text <span class="hljs-literal">null</span>,
    embedding <span class="hljs-title function_">vector</span>(<span class="hljs-number">768</span>) <span class="hljs-literal">null</span>,  -- nomic-embed-textç”Ÿæˆ<span class="hljs-number">768</span>ç»´å‘é‡
    metadata jsonb <span class="hljs-literal">null</span>,
    <span class="hljs-variable constant_">CONSTRAINT</span> documents_pkey <span class="hljs-variable constant_">PRIMARY</span> <span class="hljs-variable constant_">KEY</span> (id)
);

-- åˆ›å»ºå‘é‡ç›¸ä¼¼åº¦æœç´¢å‡½æ•°
<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">OR</span> <span class="hljs-variable constant_">REPLACE</span> <span class="hljs-variable constant_">FUNCTION</span> <span class="hljs-title function_">match_documents</span>(
    query_embedding <span class="hljs-title function_">vector</span>(<span class="hljs-number">768</span>),
    match_threshold float <span class="hljs-variable constant_">DEFAULT</span> <span class="hljs-number">0.7</span>,
    match_count int <span class="hljs-variable constant_">DEFAULT</span> <span class="hljs-number">5</span>,
    filter jsonb <span class="hljs-variable constant_">DEFAULT</span> <span class="hljs-string">'{}'</span>
)
<span class="hljs-variable constant_">RETURNS</span> <span class="hljs-variable constant_">TABLE</span> (
    id uuid,
    content text,
    metadata jsonb,
    similarity float
)
<span class="hljs-variable constant_">LANGUAGE</span> sql <span class="hljs-variable constant_">STABLE</span>
<span class="hljs-variable constant_">AS</span> $$
    <span class="hljs-variable constant_">SELECT</span>
        id,
        content,
        metadata,
        <span class="hljs-number">1</span> - (documents.<span class="hljs-property">embedding</span> &lt;=&gt; query_embedding) <span class="hljs-keyword">as</span> similarity
    <span class="hljs-variable constant_">FROM</span> documents
    <span class="hljs-variable constant_">WHERE</span> <span class="hljs-number">1</span> - (documents.<span class="hljs-property">embedding</span> &lt;=&gt; query_embedding) &gt; match_threshold
    <span class="hljs-variable constant_">ORDER</span> <span class="hljs-variable constant_">BY</span> similarity <span class="hljs-variable constant_">DESC</span>
    <span class="hljs-variable constant_">LIMIT</span> match_count;
$$;
</code></pre>
<h5 data-id="heading-7">å¾€æ•°æ®åº“ä¸­å†™å…¥æ•°æ®</h5>
<p>å°†supabaseçš„é…ç½®æ–‡ä»¶å†™å¥½äº†ä¹‹åå’±ä»¬å°±è¦å»ç”¨äº†</p>
<p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç </p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/supabase.js</span>
<span class="hljs-keyword">import</span> { createClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@supabase/supabase-js"</span>;
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">"dotenv"</span>;

dotenv.<span class="hljs-title function_">config</span>();

<span class="hljs-keyword">const</span> supabase = <span class="hljs-title function_">createClient</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">SUPABASE_URL</span>, process.<span class="hljs-property">env</span>.<span class="hljs-property">SUPABASE_ANON_KEY</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> supabase;
</code></pre>
<p>å…ˆå®ä¾‹åŒ–supabase,åç»­å¯ä»¥ç›´æ¥é€šè¿‡supabaseè¿›è¡Œå†™å…¥æ•°æ®</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ingest.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PDFLoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"langchain/document_loaders/fs/pdf"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RecursiveCharacterTextSplitter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"langchain/text_splitter"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">SupabaseVectorStore</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/community/vectorstores/supabase"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OllamaEmbeddings</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/community/embeddings/ollama"</span>;
<span class="hljs-keyword">import</span> supabase <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils/supabase.js"</span>;
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">"dotenv"</span>;

dotenv.<span class="hljs-title function_">config</span>();

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ingestDocument</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¼€å§‹æ–‡æ¡£æ¤å…¥æµç¨‹..."</span>);

  <span class="hljs-comment">// 1. åŠ è½½ PDF</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ­£åœ¨åŠ è½½ PDF æ–‡ä»¶..."</span>);
  <span class="hljs-keyword">const</span> loader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PDFLoader</span>(<span class="hljs-string">"documents/assessment_report.pdf"</span>);
  <span class="hljs-keyword">const</span> docs = <span class="hljs-keyword">await</span> loader.<span class="hljs-title function_">load</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åŠ è½½å®Œæˆï¼Œå…± <span class="hljs-subst">${docs.length}</span> é¡µ`</span>);

  <span class="hljs-comment">// 2. åˆ†å—</span>
  <span class="hljs-keyword">const</span> textSplitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RecursiveCharacterTextSplitter</span>({
    <span class="hljs-attr">chunkSize</span>: <span class="hljs-number">500</span>,
    <span class="hljs-attr">chunkOverlap</span>: <span class="hljs-number">50</span>,
  });
  <span class="hljs-keyword">const</span> splitDocs = <span class="hljs-keyword">await</span> textSplitter.<span class="hljs-title function_">splitDocuments</span>(docs);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆ†å—å®Œæˆï¼Œå…± <span class="hljs-subst">${splitDocs.length}</span> ä¸ªæ–‡æœ¬å—`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ–‡æœ¬å—:<span class="hljs-subst">${splitDocs[<span class="hljs-number">0</span>].pageContent}</span>`</span>);

  <span class="hljs-comment">// 3. åˆå§‹åŒ– embedding æ¨¡å‹</span>
  <span class="hljs-keyword">const</span> embeddings = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OllamaEmbeddings</span>({
    <span class="hljs-attr">model</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">EMBEDDING_MODEL</span>, <span class="hljs-comment">// "nomic-embed-text"</span>
    <span class="hljs-attr">baseUrl</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OLLAMA_BASE_URL</span>,
  });

  <span class="hljs-comment">// 4. å­˜å…¥ Supabase å‘é‡æ•°æ®åº“</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ­£åœ¨å°†å‘é‡å†™å…¥ Supabase..."</span>);
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">SupabaseVectorStore</span>.<span class="hljs-title function_">fromDocuments</span>(splitDocs, embeddings, {
      <span class="hljs-attr">client</span>: supabase,
      <span class="hljs-attr">tableName</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">SUPABASE_TABLE_NAME</span>,
      <span class="hljs-attr">queryName</span>: <span class="hljs-string">"match_documents"</span>, <span class="hljs-comment">// LangChain ä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªå‡½æ•°</span>
    });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ–‡æ¡£å·²æˆåŠŸå­˜å…¥ Supabase å‘é‡æ•°æ®åº“ï¼"</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å­˜å…¥ Supabase å¤±è´¥ï¼š"</span>, error.<span class="hljs-property">message</span>);
  }
}

<span class="hljs-title function_">ingestDocument</span>();
</code></pre>
<p>(((Ï†(â—ãƒ­â—;)Ï†)))ï¼Œè¿™äº›éƒ½æ˜¯å•¥å•Šï¼Œæˆ‘æ€ä¹ˆéƒ½çœ‹ä¸æ‡‚ï¼Œåˆ«ç€æ€¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹</p>
<p>æˆ‘çœ‹æ•´ä¸ªä»£ç ï¼Œæ„Ÿè§‰éƒ½å›´ç»•ç€ä¸€ä¸ªä¸œè¥¿<code>langchain</code>,åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†langchainå¤§æ¦‚æ˜¯ä»€ä¹ˆäº†ï¼Œé‚£æˆ‘ä»¬å°±å…ˆçœ‹çœ‹å…·ä½“æ˜¯æ€ä¹ˆç”¨çš„å§ï¼ˆè¯¦ç»†è®²è¿°ä¸ºä»€ä¹ˆè¦ä½¿ç”¨langchainï¼Œä¸ºä»€ä¹ˆåœ¨è¿™é‡Œä½¿ç”¨è¿™ä¸ªä¸œè¥¿ï¼‰</p>
<p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬è¿™è·Ÿç»“æ„åŒ–å’Œæ£€ç´¢å¤–éƒ¨æ•°æ®æœ‰å…³ï¼Œæ‰€ä»¥è·Ÿç´¢å¼•è¿™ä¸ªæ ¸å¿ƒæ¦‚å¿µæœ‰å…³ï¼Œ</p>
<ul>
<li>Document Loaders : ä»å„ç§æ•°æ®æºåŠ è½½æ–‡æ¡£</li>
<li>Text Splitters : å°†é•¿æ–‡æœ¬åˆ†å‰²æˆå¯ç®¡ç†çš„å—</li>
<li>Vector Stores : å­˜å‚¨å’Œæ£€ç´¢å‘é‡åµŒå…¥</li>
</ul>
<p>è¿™ä¸‰ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯è¦ç”¨åˆ°çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦å°†æ–‡å­—è½¬æ¢æˆå‘é‡ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä½¿ç”¨åˆ°ä¸€ä¸ªå‘é‡å¤§æ¨¡å‹
æ‰€ä»¥æ€»ä½“çš„æµç¨‹å°±æ˜¯ï¼š</p>
<ol>
<li>æ–‡æ¡£åŠ è½½ : PDFLoader åŠ è½½PDFæ–‡æ¡£</li>
<li>æ–‡æœ¬åˆ†å‰² : RecursiveCharacterTextSplitter åˆ†å‰²æ–‡æœ¬</li>
<li>å‘é‡åŒ– : OllamaEmbeddings ç”Ÿæˆæ–‡æœ¬å‘é‡</li>
<li>å‘é‡å­˜å‚¨ : SupabaseVectorStore å­˜å‚¨å’Œæ£€ç´¢å‘é‡</li>
</ol>
<p><strong>é‚£ä¸ºä»€ä¹ˆè¦ç”¨ LangChain å‘¢ï¼Ÿ</strong></p>
<p>å› ä¸ºå¦‚æœæ²¡æœ‰ LangChainï¼Œä½ éœ€è¦è‡ªå·±æ‰‹åŠ¨å®Œæˆä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ul>
<li>è‡ªå·±å†™ä»£ç è§£æ PDFï¼ˆæ¯”å¦‚ç”¨ pdf-parse æˆ– pdf.jsï¼‰ï¼Œå¤„ç†ç¼–ç ã€åˆ†é¡µã€æ ¼å¼ä¸¢å¤±ç­‰é—®é¢˜ï¼›</li>
<li>è‡ªå·±å®ç°æ–‡æœ¬åˆ†å—é€»è¾‘ï¼ˆæ¯”å¦‚æŒ‰å­—ç¬¦ã€å¥å­æˆ–è¯­ä¹‰è¾¹ç•Œåˆ‡å‰²ï¼‰ï¼Œè¿˜è¦è€ƒè™‘é‡å ä»¥ä¿ç•™ä¸Šä¸‹æ–‡ï¼›</li>
<li>è‡ªå·±è°ƒç”¨ Ollama çš„ API å‘é€æ–‡æœ¬è·å– embedding å‘é‡ï¼Œå¤„ç† HTTP è¯·æ±‚ã€é”™è¯¯é‡è¯•ã€æ‰¹é‡å¤„ç†ï¼›</li>
<li>è‡ªå·±æ„é€  SQL æŸ¥è¯¢æˆ– RPC è°ƒç”¨ Supabase çš„Â <code>match_documents</code>Â å‡½æ•°ï¼Œæ‹¼æ¥å‘é‡ã€è®¾ç½®é˜ˆå€¼ã€è§£æè¿”å›ç»“æœï¼›</li>
<li>æœ€åè¿˜è¦æ‰‹åŠ¨æ‹¼æ¥ promptï¼ŒæŠŠæ£€ç´¢åˆ°çš„å†…å®¹å¡è¿›é—®é¢˜é‡Œï¼Œå†è°ƒç”¨ LLM æ¥å£ã€‚</li>
</ul>
<p>è¿™äº›æ­¥éª¤è™½ç„¶æŠ€æœ¯ä¸Šå¯è¡Œï¼Œä½†<strong>é‡å¤æ€§é«˜ã€å®¹æ˜“å‡ºé”™ã€éš¾ä»¥ç»´æŠ¤</strong>ï¼Œè€Œä¸”ä¸åŒæ¨¡å‹ã€æ•°æ®åº“ã€æ–‡ä»¶æ ¼å¼ä¹‹é—´çš„é€‚é…æˆæœ¬æé«˜ã€‚</p>
<p>è€Œ <strong>LangChain çš„ä»·å€¼å°±åœ¨äºï¼šå®ƒæŠŠä¸Šè¿°æ‰€æœ‰ç¯èŠ‚éƒ½å°è£…æˆäº†æ ‡å‡†åŒ–çš„æ¨¡å—</strong>ï¼ˆDocument Loaders / Text Splitters / Embeddings / VectorStoresï¼‰ï¼Œä½ åªéœ€è¦åƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆå®ƒä»¬ï¼Œå°±èƒ½å¿«é€Ÿæ„å»ºä¸€ä¸ªå®Œæ•´çš„ RAG æµç¨‹ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›æ¨¡å—æ˜¯<strong>å¯æ’æ‹”ã€å¯æ›¿æ¢</strong>çš„â€”â€”ä»Šå¤©ä½ ç”¨ Supabase + Ollamaï¼Œæ˜å¤©æ¢æˆ Pinecone + OpenAIï¼Œåªéœ€æ”¹å‡ è¡Œé…ç½®ï¼Œæ ¸å¿ƒé€»è¾‘å‡ ä¹ä¸ç”¨åŠ¨ã€‚</p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥é€‰æ‹© LangChainï¼Œæ­£æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å®ƒæä¾›äº†Â <code>PDFLoader</code>Â ç›´æ¥è¯»å–ç®€å† PDFï¼›</li>
<li>å®ƒå†…ç½®äº†æ™ºèƒ½çš„Â <code>RecursiveCharacterTextSplitter</code>ï¼Œèƒ½æŒ‰æ®µè½ã€å¥å­åˆç†åˆ‡åˆ†ï¼Œé¿å…åˆ‡æ–­å…³é”®ä¿¡æ¯ï¼›</li>
<li>å®ƒé€šè¿‡Â <code>OllamaEmbeddings</code>Â æ— ç¼å¯¹æ¥æœ¬åœ° Ollama çš„ embedding æ¨¡å‹ï¼›</li>
<li>å®ƒçš„Â <code>SupabaseVectorStore</code>Â å·²ç»å®ç°äº†ä¸ pgvector çš„æ·±åº¦é›†æˆï¼Œè‡ªåŠ¨è°ƒç”¨ä½ åˆ›å»ºçš„Â <code>match_documents</code>Â å‡½æ•°ï¼›</li>
<li>æ•´ä¸ªæµç¨‹è¢«æŠ½è±¡ä¸ºæ¸…æ™°çš„â€œåŠ è½½ â†’ åˆ‡åˆ† â†’ å‘é‡åŒ– â†’ å­˜å‚¨â€ç®¡é“ï¼Œæå¤§é™ä½äº†å¼€å‘å¤æ‚åº¦ã€‚</li>
</ul>
<p>æ¢å¥è¯è¯´ï¼Œ<strong>LangChain è®©ä½ ä¸“æ³¨äºâ€œæˆ‘è¦åšä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œæ€ä¹ˆä¸€è¡Œè¡Œä»£ç å»å®ç°åº•å±‚ç»†èŠ‚â€</strong> ã€‚è¿™æ­£æ˜¯ç°ä»£ AI åº”ç”¨å¼€å‘æ‰€éœ€è¦çš„ç”Ÿäº§åŠ›å·¥å…·ã€‚
è¿è¡Œ<code>node ingest.js</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/146734e050234c3facb510609bf193bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765332827&amp;x-signature=DqVKyN1TCIIy2L%2FMvKvAlHGOwCM%3D" alt="image.png" loading="lazy"/>
ç»è¿‡ä¸Šé¢å‡ ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å·²ç» æˆåŠŸå°†æ•°æ®å­˜å…¥æ•°æ®åº“ä¸­äº†ï¼Œç°åœ¨å°±æ˜¯å¦‚ä½•å°†æ•°æ®ä¸æˆ‘ä»¬çš„å¤§æ¨¡å‹ç›¸ç»“åˆäº†</p>
<h4 data-id="heading-8">å¦‚ä½•å°†åœ¨LLMä¸­å»ä½¿ç”¨æˆ‘çš„æ•°æ®</h4>
<p>è¿™é‡Œç”±äºæ˜¯ç®€å•çš„ä¸€ä¸ªä¾‹å­ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬çŸ¥é“å¤§è‡´ragçš„æµç¨‹ï¼Œæˆ‘ä»¬ä¾¿ä½¿ç”¨ç®€å•çš„ollamaè¿›è¡Œä¸¾ä¾‹ï¼Œä½†æ˜¯å‰ææ˜¯ä½ æœ¬åœ°å·²ç»ä¸‹è½½äº†ollama,å¹¶ä¸”åœ¨ç»ˆç«¯è¿è¡Œ<code>ollama run deepseek-v3.1:671b-cloud</code>å’Œ
<code>ollama run nomic-embed-text</code>ï¼Œå¦‚æ­¤æ–¹å¯ä½¿ç”¨</p>
<p>é¦–å…ˆè¿›è¡ŒåŸºç¡€é…ç½®
åœ¨åŸå…ˆçš„.envæ–‡ä»¶ä¸­æ·»åŠ ollamaé…ç½®</p>
<pre><code class="hljs language-.env" lang=".env"># Ollama é…ç½®
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=deepseek-v3.1:671b-cloud
EMBEDDING_MODEL=nomic-embed-text
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// qa_resume.js - é’ˆå¯¹ç®€å†å†…å®¹çš„é—®é¢˜</span>
<span class="hljs-keyword">import</span> { createClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@supabase/supabase-js'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OllamaEmbeddings</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/community/embeddings/ollama'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Ollama</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/community/llms/ollama"</span>;
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;

dotenv.<span class="hljs-title function_">config</span>();

<span class="hljs-keyword">const</span> supabaseUrl = process.<span class="hljs-property">env</span>.<span class="hljs-property">SUPABASE_URL</span>;
<span class="hljs-keyword">const</span> supabaseKey = process.<span class="hljs-property">env</span>.<span class="hljs-property">SUPABASE_ANON_KEY</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">askResumeQuestion</span>(<span class="hljs-params">question</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\né—®é¢˜: <span class="hljs-subst">${question}</span>`</span>);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 1. åˆå§‹åŒ– embedding æ¨¡å‹</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1. åˆå§‹åŒ–embeddingæ¨¡å‹..."</span>);
    <span class="hljs-keyword">const</span> embeddings = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OllamaEmbeddings</span>({
      <span class="hljs-attr">model</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">EMBEDDING_MODEL</span>,
      <span class="hljs-attr">baseUrl</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OLLAMA_BASE_URL</span>,
    });

    <span class="hljs-comment">// 2. ç”ŸæˆæŸ¥è¯¢å‘é‡</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"2. ç”ŸæˆæŸ¥è¯¢å‘é‡..."</span>);
    <span class="hljs-keyword">const</span> queryEmbedding = <span class="hljs-keyword">await</span> embeddings.<span class="hljs-title function_">embedQuery</span>(question);

    <span class="hljs-comment">// 3. æ‰§è¡Œå‘é‡ç›¸ä¼¼åº¦æœç´¢</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"3. æ‰§è¡Œå‘é‡ç›¸ä¼¼åº¦æœç´¢..."</span>);
    <span class="hljs-keyword">const</span> supabase = <span class="hljs-title function_">createClient</span>(supabaseUrl, supabaseKey);
    
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: documents, error } = <span class="hljs-keyword">await</span> supabase
      .<span class="hljs-title function_">rpc</span>(<span class="hljs-string">'match_documents'</span>, {
        <span class="hljs-attr">query_embedding</span>: queryEmbedding,
        <span class="hljs-attr">match_threshold</span>: <span class="hljs-number">0.5</span>,
        <span class="hljs-attr">match_count</span>: <span class="hljs-number">8</span>,
        <span class="hljs-attr">filter</span>: {}
      });

    <span class="hljs-keyword">if</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é‡æœç´¢å¤±è´¥:'</span>, error.<span class="hljs-property">message</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ‰¾åˆ° <span class="hljs-subst">${documents.length}</span> ä¸ªç›¸å…³æ–‡æ¡£`</span>);
    <span class="hljs-keyword">if</span> (documents.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–‡æ¡£'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 4. æ„å»ºä¸Šä¸‹æ–‡</span>
    <span class="hljs-comment">// console.log("4. æ„å»ºä¸Šä¸‹æ–‡...");</span>
    <span class="hljs-keyword">const</span> context = documents.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">doc, index</span>) =&gt;</span> 
      <span class="hljs-string">`[æ–‡æ¡£<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>]\n<span class="hljs-subst">${doc.content}</span>`</span>
    ).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n\n'</span>);

    <span class="hljs-comment">// 5. åˆå§‹åŒ– LLM</span>
    <span class="hljs-comment">// console.log("5. åˆå§‹åŒ–LLM...");</span>
    <span class="hljs-keyword">const</span> llm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ollama</span>({
      <span class="hljs-attr">baseUrl</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OLLAMA_BASE_URL</span>,
      <span class="hljs-attr">model</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OLLAMA_MODEL</span>,
      <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.3</span>,
    });
    <span class="hljs-comment">// 6. æ„å»ºæç¤ºè¯</span>
    <span class="hljs-keyword">const</span> prompt = <span class="hljs-string">`åŸºäºä»¥ä¸‹ç®€å†å†…å®¹ï¼Œè¯·å›ç­”é—®é¢˜ï¼š

ä¸Šä¸‹æ–‡ï¼š
<span class="hljs-subst">${context}</span>

é—®é¢˜ï¼š<span class="hljs-subst">${question}</span>

è¯·ç”¨ä¸­æ–‡å›ç­”ï¼Œå¹¶ç¡®ä¿ç­”æ¡ˆå‡†ç¡®ã€ç®€æ´ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¯·æ˜ç¡®è¯´æ˜ã€‚`</span>;

    <span class="hljs-comment">// 7. ç”Ÿæˆå›ç­”</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è¯·ç¨ç­‰ï¼Œæ­£åœ¨ç”Ÿæˆå›ç­”..."</span>);
    <span class="hljs-keyword">const</span> answer = <span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">invoke</span>(prompt);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å›ç­”: <span class="hljs-subst">${answer}</span>`</span>);
    <span class="hljs-keyword">return</span> answer;

  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"é—®ç­”å¤±è´¥ï¼š"</span>, error.<span class="hljs-property">message</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"é”™è¯¯è¯¦æƒ…ï¼š"</span>, error);
  }
}

<span class="hljs-comment">// æµ‹è¯•é’ˆå¯¹ç®€å†çš„é—®é¢˜</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">askResumeQuestion</span>(<span class="hljs-string">"è¿™ä½å€™é€‰äººçš„ä¸»è¦æŠ€èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ"</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">askResumeQuestion</span>(<span class="hljs-string">"å€™é€‰äººæœ‰å“ªäº›é¡¹ç›®ç»éªŒï¼Ÿ"</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">askResumeQuestion</span>(<span class="hljs-string">"ä»–çš„æ•™è‚²èƒŒæ™¯å¦‚ä½•ï¼Ÿ"</span>);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e8eaa09704145178e586f461bd691f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu95a625LiN5L-d5oqk5bqf54mp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765332827&amp;x-signature=nTbT9T3dACLOPbblZGrqUKjDcOc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>é€šè¿‡è¿™ä¸ªç®€å•çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å®Œæ•´èµ°é€šäº† <strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong> çš„æ ¸å¿ƒæµç¨‹ï¼š<br/>
å°†ä¸ªäººç®€å†ï¼ˆPDFï¼‰ä½œä¸ºç§æœ‰çŸ¥è¯†æºï¼Œåˆ©ç”¨ <strong>LangChain.js</strong> è‡ªåŠ¨å®Œæˆæ–‡æ¡£åŠ è½½ã€æ–‡æœ¬åˆ‡åˆ†ã€å‘é‡åŒ–å’Œå­˜å‚¨ï¼›å€ŸåŠ© <strong>Supabase + pgvector</strong> æ„å»ºè½»é‡çº§å‘é‡æ•°æ®åº“ï¼Œå®ç°é«˜æ•ˆçš„è¯­ä¹‰ç›¸ä¼¼æ€§æ£€ç´¢ï¼›æœ€åç»“åˆæœ¬åœ°è¿è¡Œçš„ <strong>Ollama å¤§æ¨¡å‹</strong>ï¼Œåœ¨æ³¨å…¥ä¸Šä¸‹æ–‡çš„å‰æä¸‹ç²¾å‡†å›ç­”å…³äºç®€å†çš„é—®é¢˜ã€‚</p>
<p>æ•´ä¸ªæ–¹æ¡ˆå®Œå…¨è¿è¡Œåœ¨æœ¬åœ°æˆ–ä½æˆæœ¬äº‘æœåŠ¡ä¸Šï¼Œ<strong>æ— éœ€ä¾èµ– OpenAI ç­‰å•†ä¸š API</strong>ï¼Œæ—¢ä¿æŠ¤äº†æ•°æ®éšç§ï¼Œåˆæœ‰æ•ˆé¿å…äº†å¤§æ¨¡å‹â€œèƒ¡è¯´å…«é“â€çš„é—®é¢˜â€”â€”å› ä¸ºå®ƒçš„å›ç­”å§‹ç»ˆåŸºäºä½ æä¾›çš„çœŸå®å†…å®¹ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªæ¶æ„å…·å¤‡æå¼ºçš„å¯æ‰©å±•æ€§ï¼š</p>
<ul>
<li>æ¢ä¸ª PDFï¼Œå°±èƒ½å˜æˆâ€œå…¬å¸çŸ¥è¯†åº“é—®ç­”â€ï¼›</li>
<li>åŠ å…¥å¤šä¸ªæ–‡æ¡£ï¼Œå°±æ”¯æŒè·¨æ–‡ä»¶æ£€ç´¢ï¼›</li>
<li>æ¥å…¥ Agent å’Œå·¥å…·ï¼ˆå¦‚æ—¥å†ã€é‚®ä»¶ï¼‰ï¼Œè¿˜èƒ½å®ç°â€œæ ¹æ®æˆ‘çš„ç»å†è‡ªåŠ¨å†™æ±‚èŒä¿¡â€ç­‰æ™ºèƒ½ä»»åŠ¡ã€‚</li>
</ul>
<p>è¿™åªæ˜¯ä¸€ä¸ªèµ·ç‚¹ã€‚<br/>
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å°è¯•å¼•å…¥æ›´å¤æ‚çš„ragé¡¹ç›®ï¼Œè¿˜æœ‰å¾ˆå¤šéœ€è¦ä¼˜åŒ–çš„éƒ¨åˆ†éœ€è¦å»å®Œå–„ï¼Œåƒæ–‡æœ¬åˆ‡å‰²æ˜¯å¦å¯ä»¥æ›´åŠ äººæ€§åŒ–ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡langchainå†…çš„ç»„ä»¶è¿›è¡Œè¿›ä¸€æ­¥çš„å¼€å‘ï¼Œæ¯”å¦‚å®ç°æµå¼è¾“å‡ºï¼Œå¯¹è¯å†å²å­˜å‚¨ä¹‹ç±»çš„ï¼Œè¿˜æœ‰ä¹‹å‰åŸ‹ä¸‹çš„ä¼ç¬”ï¼Œæœ‰æ²¡æœ‰å¯ä»¥åœ¨æœ¬åœ°ç›´æ¥è¿è¡Œçš„å…è´¹å‘é‡æ•°æ®åº“ï¼Œè¿™äº›éƒ½ä¼šåœ¨ä¹‹åçš„æ–‡ç« ä¸­å†™åˆ°</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.jsç¬¬åäºŒç« (RSC/æœåŠ¡ç«¯ç»„ä»¶/å®¢æˆ·ç«¯ç»„ä»¶)]]></title>    <link>https://juejin.cn/post/7579062563326427177</link>    <guid>https://juejin.cn/post/7579062563326427177</guid>    <pubDate>2025-12-02T13:04:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579062563326427177" data-draft-id="7579066828179357732" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.jsç¬¬åäºŒç« (RSC/æœåŠ¡ç«¯ç»„ä»¶/å®¢æˆ·ç«¯ç»„ä»¶)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T13:04:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ»¡zs"/> <meta itemprop="url" content="https://juejin.cn/user/2463384809252397"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.jsç¬¬åäºŒç« (RSC/æœåŠ¡ç«¯ç»„ä»¶/å®¢æˆ·ç«¯ç»„ä»¶)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2463384809252397/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ»¡zs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:04:35.000Z" title="Tue Dec 02 2025 13:04:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RSC(React Server Components)</h2>
<p>RSC(æœåŠ¡å™¨ç»„ä»¶)æ˜¯React19<code>æ­£å¼å¼•å…¥</code>çš„ä¸€ç§æ–°çš„ç»„ä»¶ç±»å‹ï¼Œå®ƒå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯æ¸²æŸ“ã€‚</p>
<p>åƒä¼ ç»Ÿçš„<code>SSR</code>ä»–æ˜¯åœ¨æœåŠ¡å™¨æå‰æŠŠé¡µé¢æ¸²æŸ“å¥½ï¼Œç„¶åè¿”å›ç»™æµè§ˆå™¨ï¼Œç„¶åè¿›è¡Œæ°´åˆï¼Œ<code>CSR</code>åˆ™æ˜¯åœ¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè€Œ<code>RSC</code>åˆ™æ˜¯å¸å–ä¸¤æ–¹ä¼˜åŠ¿ï¼Œåˆ†ä¸º<code>æœåŠ¡å™¨ç»„ä»¶</code>å’Œ<code>å®¢æˆ·ç«¯ç»„ä»¶</code>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­:</p>
<p>ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå®˜ç½‘çš„é¡µé¢ï¼Œä¸Šé¢éƒ½æ˜¯é™æ€å†…å®¹ï¼Œä½†ä¸‹é¢ç•™è¨€æ¡†æ˜¯éœ€è¦äº¤äº’çš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a80aa3627d954e6baad4c922fcf9e8ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=%2BfIjzD%2BLviW1n8xLZNbwfS7y6Ho%3D" alt="7.gif" loading="lazy"/></p>
<p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æ‹†åˆ†æˆä¸¤ä¸ªç»„ä»¶:</p>
<ul>
<li>æœåŠ¡å™¨ç»„ä»¶: ä¸Šé¢éƒ½æ˜¯é™æ€å†…å®¹ï¼Œä¾‹å¦‚æ­£æ–‡ï¼Œæ ‡é¢˜ï¼Œå›¾ç‰‡ç­‰ï¼Œè¿™ç±»ç»„ä»¶ä¹‹æ‰€ä»¥é€‚åˆåœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œæ ¸å¿ƒåŸå› åœ¨äºæœåŠ¡ç«¯æ¸²æŸ“HTML+CSSçš„é€Ÿåº¦æ›´å¿«ï¼Œç”Ÿæˆçš„å†…å®¹å¯¹æœç´¢å¼•æ“å®Œå…¨å¯è§ï¼Œä¸”æ— éœ€å®¢æˆ·ç«¯é¢å¤–å¤„ç†äº¤äº’é€»è¾‘ï¼Œå®Œç¾åŒ¹é…é™æ€å†…å®¹çš„éœ€æ±‚ã€‚</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">//Next.js é»˜è®¤æœåŠ¡å™¨ç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<ul>
<li>å®¢æˆ·ç«¯ç»„ä»¶: ä¸‹é¢ç•™è¨€æ¡†æ˜¯éœ€è¦äº¤äº’çš„ï¼Œä¾‹å¦‚äº¤äº’åŠŸèƒ½ï¼Œå¦‚ç‚¹èµæŒ‰é’®ã€è®¡æ•°å™¨ã€è¡¨å•ç­‰ã€‚è¿™ç±»ç»„ä»¶éœ€è¦ä¾èµ–æµè§ˆå™¨DOMäº‹ä»¶ã€çŠ¶æ€ç®¡ç†ï¼ˆuseStateï¼‰ã€å‰¯ä½œç”¨ï¼ˆuseEffectï¼‰ç­‰å®¢æˆ·ç«¯èƒ½åŠ›ï¼Œå¿…é¡»åœ¨å®¢æˆ·ç«¯å®Œæˆæ¸²æŸ“å’Œæ°´åˆï¼ˆå³æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºçš„è¿‡ç¨‹ï¼‰æ‰èƒ½å®ç°äº¤äº’æ•ˆæœ</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-string">'use client'</span> <span class="hljs-comment">//å£°æ˜è¿™æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h4 data-id="heading-1">æ¸²æŸ“(RSC Payload)</h4>
<p>SSRæ¨¡å¼æ˜¯åœ¨æœåŠ¡å™¨ç›´æ¥æ¸²æŸ“æˆ<code>HTML</code>é¡µé¢ï¼Œè¿”å›ç»™æµè§ˆå™¨çš„ï¼Œè€Œ<code>RSC</code>ä»–æ˜¯ä¸€ç§ç‰¹æ®Šçš„<code>ç´§å‡‘çš„</code>æ ¼å¼</p>
<pre><code class="hljs language-json" lang="json">b2<span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"    })"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
b3<span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"  }"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-token-punctuation)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">","</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">" [])"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
b4<span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">" "</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
b5<span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"  "</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-token-comment)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"// You can use `isPending` to give users feedback"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
b6<span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"  "</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-token-keyword)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"return"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">" &lt;"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-token-string-expression)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"p"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"&gt;Total Views: {views}&lt;/"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-token-string-expression)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"p"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">[</span><span class="hljs-string">"$"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"span"</span><span class="hljs-punctuation">,</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"var(--shiki-color-text)"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"&gt;"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
</code></pre>
<p>é‚£ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶å¯ä»¥è¿›è¡ŒåµŒå¥—<code>æœåŠ¡å™¨ç»„ä»¶</code>&gt;åµŒå¥—<code>å®¢æˆ·ç«¯ç»„ä»¶</code>&gt;</p>
<p>é»„è‰²èŠ‚ç‚¹è¡¨ç¤º<code>æœåŠ¡å™¨ç»„ä»¶</code>ï¼Œè™šçº¿èŠ‚ç‚¹è¡¨ç¤º<code>å®¢æˆ·ç«¯ç»„ä»¶</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb652ca8382248fc83e6d398a2452c74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=eylXhlN6aUyMlVxwTmgd%2BwxSHCY%3D" alt="2.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼ŒNext.jså°±ä¼šæ ‡è®°å“ªäº›æ˜¯å®¢æˆ·ç«¯ç»„ä»¶å¹¶ä¸”é¢„ç•™å¥½ä½ç½®ï¼Œä½†æ˜¯ä¸ä¼šè¿›è¡Œæ°´åˆã€‚</p>
<p>é‚£ä¹ˆNext.jså‘ç°å®¢æˆ·ç«¯ç»„ä»¶ä¹Ÿä¼šåœ¨æœåŠ¡å™¨ç”Ÿæˆè¿™ä¸ªç»“æ„ï¼Œé‚£å¹²è„†ç›´æ¥æœåŠ¡å™¨é‡Œé¢æŠŠå®¢æˆ·ç«¯ç»„ä»¶è¿›è¡Œé¢„æ¸²æŸ“(ä¸åŒ…å«äº¤äº’)ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¿«é€Ÿçœ‹åˆ°æ•°æ®ï¼Œç­‰ä»–åŠ è½½å®Œæˆåå†è¿›è¡Œæ°´åˆï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ç»„ä»¶ä¹Ÿä¼šåœ¨æœåŠ¡å™¨è¿›è¡Œä¸€æ¬¡<code>é¢„æ¸²æŸ“</code>ã€‚</p>
<h4 data-id="heading-2">ä¼˜ç‚¹</h4>
<ul>
<li>
<p>å°†ç»„ä»¶æ‹†åˆ†æˆå®¢æˆ·ç«¯ç»„ä»¶å’ŒæœåŠ¡å™¨ç»„ä»¶ï¼Œå¯ä»¥æœ‰æ•ˆçš„å‡å°‘<code>bundle</code>ä½“ç§¯ï¼Œå› ä¸º<code>æœåŠ¡å™¨ç»„ä»¶</code>å·²ç»åœ¨æœåŠ¡å™¨æ¸²æŸ“å¥½äº†ï¼Œæ‰€ä»¥æ²¡å¿…è¦æ‰“å…¥<code>bundle</code>ä¸­,ä¹Ÿå°±æ˜¯è¯´æœåŠ¡å™¨ç»„ä»¶æ‰€ä¾èµ–çš„åŒ…éƒ½ä¸ä¼šæ‰“è¿›å»ï¼Œå¤§å¤§å‡å°‘äº†<code>bundle</code>ä½“ç§¯ã€‚</p>
</li>
<li>
<p>å±€éƒ¨æ°´åˆï¼Œåƒä¼ ç»Ÿçš„SSRåŒæ„æ¨¡å¼, æ‰€æœ‰çš„é¡µé¢éƒ½è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œæ°´åˆï¼Œè€Œ<code>RSC</code>å°†ç»„ä»¶æ‹†åˆ†å‡ºæ¥ï¼Œåªä¼šæŠŠå®¢æˆ·ç«¯ç»„ä»¶è¿›è¡Œæ°´åˆï¼Œé¿å…äº†å…¨é‡æ°´åˆå¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</p>
</li>
<li>
<p>æµå¼åŠ è½½ï¼Œæˆ‘ä»¬çš„HTMLé¡µé¢æœ¬æ¥å°±æ”¯æŒæµå¼åŠ è½½ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç»„ä»¶å¯ä»¥è¾¹æ¸²æŸ“è¾¹è¿”å›ï¼Œæé«˜äº†FCP(é¦–æ¬¡å†…å®¹ç»˜åˆ¶)æ€§èƒ½ã€‚</p>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/870b4c3be1224e059685d8603ee92d6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=7pNR5%2FHSV3sN8iApkSVw1GOyQaI%3D" alt="1.png" loading="lazy"/></p>
<h2 data-id="heading-3">æœåŠ¡ç«¯ç»„ä»¶(Server Components)</h2>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹, <code>page</code> <code>layout</code> éƒ½æ˜¯æœåŠ¡ç«¯ç»„ä»¶ï¼ŒæœåŠ¡ç«¯ç»„ä»¶å¯ä»¥è®¿é—®<code>node.js</code> APIï¼ŒåŒ…æ‹¬å¤„ç†æ•°æ®åº“dbã€‚</p>
<p>src/app/server/page.tsx</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs'</span> <span class="hljs-comment">//å¼•å…¥fsæ¨¡å—</span>
<span class="hljs-keyword">import</span> mysql, { <span class="hljs-title class_">RowDataPacket</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mysql2/promise'</span> <span class="hljs-comment">//æ“ä½œæ•°æ®åº“ ä»…ä¾›æ¼”ç¤º éæœ€ä½³å®è·µ</span>
<span class="hljs-keyword">const</span> pool = mysql.<span class="hljs-title function_">createPool</span>({
    <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
    <span class="hljs-attr">user</span>: <span class="hljs-string">'root'</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">'123456'</span>,
    <span class="hljs-attr">database</span>: <span class="hljs-string">'catering'</span>,
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ServerPage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [rows] = <span class="hljs-keyword">await</span> pool.<span class="hljs-property">query</span>&lt;<span class="hljs-title class_">RowDataPacket</span>[]&gt;(<span class="hljs-string">'SELECT * FROM goods'</span>)
    <span class="hljs-keyword">const</span> data = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'data.json'</span>, <span class="hljs-string">'utf-8'</span>)
    <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Server Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            {json.age}///{json.name}///{json.city}
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            {rows.map((item: any) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name}-{item.goodsPrice}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>data.json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"John"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"New York"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f097ff47c2d4f7f8be1dae013509597~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=DEGpzB5upnv7oFFFLHrslmS1u7E%3D" alt="server.png" loading="lazy"/></p>
<p>å› ä¸ºæ˜¯åœ¨æœåŠ¡ç«¯æ¸²æŸ“çš„æ‰€ä»¥æ—¥å¿—ä¼šå‡ºç°åœ¨æ§åˆ¶å°ï¼Œé‚£ä¸ºä»€ä¹ˆæ§åˆ¶å°ä¹Ÿä¼šå‡ºç°ï¼Œæ˜¯å› ä¸º<code>Next.js</code>åœ¨æœ¬åœ°å¼€å‘æ¨¡å¼æ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•è¿›è¡Œçš„è¾“å‡ºï¼Œåç»­ç”Ÿäº§ç¯å¢ƒå°±çœ‹ä¸åˆ°äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0db6aa23499f48b9a56849f256ecdea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=hdoJuK8fqXEECyTtIWqgwPb44sk%3D" alt="log.png" loading="lazy"/></p>
<h4 data-id="heading-4">æœåŠ¡ç«¯ç»„ä»¶çš„ä¼˜ç‚¹</h4>
<ul>
<li>å®‰å…¨æ€§: æˆ‘ä»¬åœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­è®¿é—®ä¸€äº›APIç§˜é’¥ï¼Œä»¤ç‰Œç­‰å…¶ä»–æœºå¯†ï¼Œä¸ä¼šæš´éœ²ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>ä½“ç§¯: å› ä¸ºæœåŠ¡ç«¯ç»„ä»¶åœ¨æœåŠ¡å™¨æ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ‰“åŒ…åˆ°å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ä½“ç§¯æ›´å°ã€‚</li>
<li>å…¨æ ˆï¼šå¯ä»¥åœ¨æœåŠ¡ç«¯ç»„ä»¶è®¿é—®æ•°æ®åº“ï¼Œæ–‡ä»¶ç³»ç»Ÿç­‰å…¶ä»–APIï¼Œå®ç°å…¨æ ˆå¼€å‘ã€‚</li>
<li>FCP(é¦–æ¬¡å†…å®¹ç»˜åˆ¶): å› ä¸ºæœåŠ¡ç«¯ç»„ä»¶æ˜¯æµå¼ä¼ è¾“ï¼Œæ‰€ä»¥è¾¹æ¸²æŸ“è¾¹è¿”å›ï¼Œæé«˜äº†FCP(é¦–æ¬¡å†…å®¹ç»˜åˆ¶)æ€§èƒ½ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f72515d00ef4630bb4060be0566fbf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=xD5vrfztsOQluVrbZ6ECbjSs28w%3D" alt="fcp.png" loading="lazy"/></p>
<h4 data-id="heading-5">æœåŠ¡ç«¯ç»„ä»¶çš„ç¼ºç‚¹</h4>
<ul>
<li>äº¤äº’æ€§: å› ä¸ºæœåŠ¡ç«¯ç»„ä»¶åœ¨æœåŠ¡å™¨æ¸²æŸ“ï¼Œæ‰€ä»¥æ— æ³•è®¿é—®æµè§ˆå™¨APIï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œäº¤äº’ã€‚</li>
<li>hooks: <code>useEffect</code> <code>useState</code> ç­‰hooksåœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­æ— æ³•ä½¿ç”¨ã€‚</li>
</ul>
<p>JavaScript: æ˜¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆçš„(ECMAScript,DOM,BOM)ï¼Œåœ¨æœåŠ¡ç«¯ç»„ä»¶åªèƒ½ä½¿ç”¨<code>ECMAScript</code>éƒ¨åˆ†ï¼Œæ— æ³•è®¿é—®<code>DOM</code>å’Œ<code>BOM</code>ã€‚</p>
<p>ECMAScript: å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„å¯¹è±¡ï¼Œæ•°ç»„ï¼Œes6+ç­‰è¿™äº›ä¸œè¥¿æ˜¯é€šç”¨çš„åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½èƒ½ç”¨ã€‚</p>
<blockquote>
<p>å¦‚æœè¦ä½¿ç”¨ä»¥ä¸‹æœ‰äº¤äº’æ€§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å®¢æˆ·ç«¯ç»„ä»¶ã€‚</p>
</blockquote>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useEffect,useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ServerPage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">document</span>,<span class="hljs-variable language_">window</span>)
    }, [])
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Server Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h2 data-id="heading-6">å®¢æˆ·ç«¯ç»„ä»¶(Client Components)</h2>
<p>å£°æ˜å®¢æˆ·ç«¯ç»„ä»¶éœ€è¦åœ¨æ–‡ä»¶çš„é¡¶éƒ¨ç¼–å†™ <code>'use client'</code> å£°æ˜è¿™æ˜¯å®¢æˆ·ç«¯ç»„ä»¶ï¼Œä½†æ˜¯æ³¨æ„å®¢æˆ·ç«¯ç»„ä»¶ä¼šåœ¨æœåŠ¡ç«¯è¿›è¡Œä¸€æ¬¡<code>é¢„æ¸²æŸ“</code>ï¼Œæ‰€ä»¥è®¿é—®<code>document</code> <code>window</code> ç­‰APIéœ€è¦åœ¨<code>useEffect</code>ä¸­è®¿é—®ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-string">'use client'</span>
<span class="hljs-keyword">import</span> { useEffect,useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'client'</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ServerPage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'client X'</span>)
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">document</span>,<span class="hljs-variable language_">window</span>)
    }, [])
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Server Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–æŠŠ<code>useState</code>çš„0é¢„æ¸²æŸ“äº†å‡ºæ¥è¿™æ ·å¯ä»¥è®©ç”¨æˆ·å…ˆçœ‹åˆ°é¡µé¢ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1409846d614481ba872306eb658b213~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=MEc7kjsLADFsp%2BfHmc81ynWiivU%3D" alt="pre-render.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd7f7fc934dd4dd39c692e6876d9e2ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=mjz6PE429g9ajMX0bnBmYHn2izU%3D" alt="pre-render2.png" loading="lazy"/></p>
<h4 data-id="heading-7">ç»„ä»¶åµŒå¥—</h4>
<blockquote>
<p>æœåŠ¡ç«¯ç»„ä»¶å¯ä»¥åµŒå¥—å®¢æˆ·ç«¯ç»„ä»¶ï¼Œå®¢æˆ·ç«¯åªèƒ½åµŒå¥—ä¸èƒ½åµŒå¥—æœåŠ¡ç«¯ç»„ä»¶</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ec8e052a2ef4921ab0dcc6d5bcf4ed3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=Vo0WZkK5bifA%2Bd5bxRperz%2FAc9Q%3D" alt="error.png" loading="lazy"/></p>
<p>why:å› ä¸ºå®¢æˆ·ç«¯ä¼šæŠŠä»–æ‰€æœ‰çš„æ¨¡å—ä»¥åŠå­ç»„ä»¶è®¤ä¸ºæ˜¯å®¢æˆ·ç«¯ç»„ä»¶ï¼Œé‚£æ­¤æ—¶å¦‚æœæœåŠ¡ç«¯ç»„ä»¶ç”¨äº†<code>node.js</code>çš„APIï¼Œæˆ–è€…å…¶ä»–æœåŠ¡ç«¯æ“ä½œï¼Œé‚£å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®¢æˆ·ç«¯ç»„ä»¶æ— æ³•è®¿é—®è¿™äº›APIï¼Œæ•…æ­¤å®¢æˆ·ç«¯ç»„ä»¶ä¸èƒ½åµŒå¥—æœåŠ¡ç«¯ç»„ä»¶ã€‚</p>
<h4 data-id="heading-8">server-only</h4>
<p>éšç€Nodejsçš„å‘å±•ï¼Œå¾ˆå¤šAPIå·²ç»å¯ä»¥è·Ÿæµè§ˆå™¨å…±ç”¨äº†ä¾‹å¦‚<code>fetch</code>,<code>webSocket</code>,æœªæ¥Nodejs25æ”¯æŒ<code>localStorage</code>ç­‰API,æ‰€ä»¥å°±ä¼šå‡ºç°è¿™ç§æƒ…å†µ</p>
<p>ä¸‹é¢è¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨æœåŠ¡ç«¯ç»„ä»¶ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯ç»„ä»¶ä½¿ç”¨ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬åªæƒ³è®©ä»–åœ¨æœåŠ¡ç«¯ä½¿ç”¨</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTest</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>:<span class="hljs-number">0</span> | <span class="hljs-number">1</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com'</span>)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'wss://api.github.com'</span>)
    }
}
</code></pre>
<pre><code class="hljs language-bash" lang="bash">npm install server-only
or
yarn add server-only
or
pnpm add server-only
</code></pre>
<p>å®‰è£…å®Œæˆè¿™ä¸ªåŒ…ä¹‹åï¼Œåªéœ€è¦åœ¨æ–‡ä»¶çš„é¡¶éƒ¨ç¼–å†™ <code>import 'server-only'</code> å£°æ˜å³å¯ï¼Œè¿™æ ·ä»–å°±ä¼šåœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œåœ¨å®¢æˆ·ç«¯æ‰§è¡Œä¼šæŠ¥é”™ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-string">'server-only'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTest</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>:<span class="hljs-number">0</span> | <span class="hljs-number">1</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com'</span>)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'wss://api.github.com'</span>)
    }
}
</code></pre>
<p>å®¢æˆ·ç«¯ä½¿ç”¨æŠ¥é”™:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af8f17bb04774340bf18806bc25f402f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765285475&amp;x-signature=RZLeOQiqJi%2BmRMOx59zb9RvsCr4%3D" alt="error2.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisï¼ˆ158ï¼‰Redisçš„ä¸»ä»åŒæ­¥é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7578714735308079130</link>    <guid>https://juejin.cn/post/7578714735308079130</guid>    <pubDate>2025-12-01T22:57:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578714735308079130" data-draft-id="7578709098256105510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisï¼ˆ158ï¼‰Redisçš„ä¸»ä»åŒæ­¥é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-01T22:57:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisï¼ˆ158ï¼‰Redisçš„ä¸»ä»åŒæ­¥é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T22:57:42.000Z" title="Mon Dec 01 2025 22:57:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    19
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Redisçš„ä¸»ä»åŒæ­¥é—®é¢˜å¯èƒ½ä¼šå½±å“æ•°æ®ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚è¦è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥äº†è§£Redisä¸»ä»å¤åˆ¶æœºåˆ¶ï¼Œå¹¶é’ˆå¯¹å…·ä½“åœºæ™¯è¿›è¡Œä¼˜åŒ–å’Œæ•…éšœå¤„ç†ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è§£å†³æ–¹æ¡ˆå’Œä»£ç ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-0">1. é…ç½®ä¸»ä»å¤åˆ¶</h3>
<p>é¦–å…ˆï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å’Œå‘½ä»¤è®¾ç½®Redisçš„ä¸»ä»å¤åˆ¶ã€‚</p>
<h4 data-id="heading-1">1.1 é…ç½®ä¸»æœåŠ¡å™¨</h4>
<p>ä¸»æœåŠ¡å™¨ä¸éœ€è¦ç‰¹åˆ«é…ç½®ï¼Œåªéœ€æ­£å¸¸å¯åŠ¨Redisã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># å¯åŠ¨ä¸»æœåŠ¡å™¨</span>
port 6379
</code></pre>
<h4 data-id="heading-2">1.2 é…ç½®ä»æœåŠ¡å™¨</h4>
<p>åœ¨ä»æœåŠ¡å™¨ä¸Šé…ç½®ä¸ä¸»æœåŠ¡å™¨çš„è¿æ¥ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># å¯åŠ¨ä»æœåŠ¡å™¨</span>
port 6380

<span class="hljs-comment"># é…ç½®ä¸»æœåŠ¡å™¨çš„IPå’Œç«¯å£</span>
replicaof 127.0.0.1 6379
</code></pre>
<h4 data-id="heading-3">1.3 åŠ¨æ€è®¾ç½®ä»æœåŠ¡å™¨</h4>
<p>å¯ä»¥é€šè¿‡å‘½ä»¤åŠ¨æ€è®¾ç½®ä»æœåŠ¡å™¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisReplicationSetup</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>)) {
            <span class="hljs-comment">// è®¾ç½®ä»æœåŠ¡å™¨è¿æ¥åˆ°ä¸»æœåŠ¡å™¨</span>
            jedis.slaveof(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">6379</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-4">2. è§£å†³ä¸»ä»åŒæ­¥å»¶è¿Ÿé—®é¢˜</h3>
<h4 data-id="heading-5">2.1 è°ƒæ•´å¤åˆ¶ç¼“å†²åŒºå¤§å°</h4>
<p>å¢åŠ ä¸»æœåŠ¡å™¨çš„å¤åˆ¶ç¼“å†²åŒºå¤§å°ï¼Œé˜²æ­¢å¤åˆ¶è¿‡ç¨‹ä¸­æ–­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># å¤åˆ¶ç¼“å†²åŒºå¤§å°</span>
repl-backlog-size 256mb
</code></pre>
<h4 data-id="heading-6">2.2 è°ƒæ•´å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°</h4>
<p>è°ƒæ•´ä¸»æœåŠ¡å™¨çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼ˆrepl-backlog-sizeï¼‰å¤§å°ï¼Œç¡®ä¿åœ¨ç½‘ç»œæŠ–åŠ¨æ—¶ï¼Œä»æœåŠ¡å™¨èƒ½å¤Ÿå¿«é€ŸåŒæ­¥æ•°æ®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°</span>
repl-backlog-size 256mb
</code></pre>
<h4 data-id="heading-7">2.3 é…ç½®å»¶è¿Ÿç›‘æ§</h4>
<p>è®¾ç½®å¤åˆ¶å»¶è¿Ÿç›‘æ§ï¼ŒåŠæ—¶å‘ç°å¹¶å¤„ç†å»¶è¿Ÿé—®é¢˜ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisReplicationDelayMonitor</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>)) {
            <span class="hljs-comment">// è·å–ä»æœåŠ¡å™¨çš„å¤åˆ¶å»¶è¿Ÿä¿¡æ¯</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> jedis.info(<span class="hljs-string">"replication"</span>);
            System.out.println(info);
        }
    }
}
</code></pre>
<h3 data-id="heading-8">3. å¤„ç†ä¸»ä»åˆ‡æ¢é—®é¢˜</h3>
<p>ä½¿ç”¨Redis Sentinelå®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œç¡®ä¿é«˜å¯ç”¨æ€§ã€‚</p>
<h4 data-id="heading-9">3.1 é…ç½®Redis Sentinel</h4>
<p>é…ç½®Redis Sentinelç›‘æ§ä¸»æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸»æœåŠ¡å™¨æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Sentinelé…ç½®æ–‡ä»¶ sentinel.conf</span>

port 26379

<span class="hljs-comment"># Sentinelç›‘æ§çš„ä¸»æœåŠ¡å™¨åç§°åŠåœ°å€å’Œç«¯å£</span>
sentinel monitor mymaster 127.0.0.1 6379 2

<span class="hljs-comment"># ä¸»æœåŠ¡å™¨è¢«è®¤ä¸ºä¸å¯ç”¨çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
sentinel down-after-milliseconds mymaster 5000

<span class="hljs-comment"># æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
sentinel failover-timeout mymaster 60000

<span class="hljs-comment"># å¹¶è¡ŒåŒæ­¥çš„ä»æœåŠ¡å™¨æ•°é‡</span>
sentinel parallel-syncs mymaster 1
</code></pre>
<h4 data-id="heading-10">3.2 å¯åŠ¨Redis Sentinel</h4>
<pre><code class="hljs language-bash" lang="bash">redis-sentinel /path/to/sentinel.conf
</code></pre>
<h3 data-id="heading-11">4. å¤„ç†å…¨é‡å¤åˆ¶å’Œå¢é‡å¤åˆ¶é—®é¢˜</h3>
<h4 data-id="heading-12">4.1 å¢åŠ å…¨é‡å¤åˆ¶çš„æ€§èƒ½</h4>
<p>é€šè¿‡é…ç½®ç£ç›˜å†™å…¥ç­–ç•¥å’Œå‹ç¼©é€‰é¡¹ï¼Œæé«˜å…¨é‡å¤åˆ¶çš„æ€§èƒ½ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># ç£ç›˜å†™å…¥ç­–ç•¥</span>
save 900 1
save 300 10
save 60 10000

<span class="hljs-comment"># å‹ç¼©RDBæ–‡ä»¶</span>
rdbcompression <span class="hljs-built_in">yes</span>
</code></pre>
<h4 data-id="heading-13">4.2 ä¼˜åŒ–å¢é‡å¤åˆ¶</h4>
<p>ç¡®ä¿ä¸»ä»æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œè¿æ¥ç¨³å®šã€ä½å»¶è¿Ÿï¼Œå‡å°‘å¢é‡å¤åˆ¶è¿‡ç¨‹ä¸­çš„æ•°æ®ä¸¢å¤±ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœåŠ¡å™¨çš„ redis.conf é…ç½®ç¤ºä¾‹</span>

<span class="hljs-comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå¤§å°</span>
repl-backlog-size 256mb

<span class="hljs-comment"># å¤åˆ¶è¶…æ—¶</span>
repl-timeout 60
</code></pre>
<h3 data-id="heading-14">5. å¤„ç†ç½‘ç»œåˆ†åŒºé—®é¢˜</h3>
<h4 data-id="heading-15">5.1 é…ç½®æ•…éšœè½¬ç§»ç­–ç•¥</h4>
<p>é€šè¿‡é…ç½®Sentinelçš„æ•…éšœè½¬ç§»ç­–ç•¥ï¼Œç¡®ä¿åœ¨ç½‘ç»œåˆ†åŒºæ—¶èƒ½å¤Ÿæ­£ç¡®åœ°è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Sentinelé…ç½®æ–‡ä»¶ sentinel.conf</span>

<span class="hljs-comment"># Sentinelç›‘æ§çš„ä¸»æœåŠ¡å™¨åç§°åŠåœ°å€å’Œç«¯å£</span>
sentinel monitor mymaster 127.0.0.1 6379 2

<span class="hljs-comment"># ä¸»æœåŠ¡å™¨è¢«è®¤ä¸ºä¸å¯ç”¨çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
sentinel down-after-milliseconds mymaster 5000

<span class="hljs-comment"># æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
sentinel failover-timeout mymaster 60000

<span class="hljs-comment"># å¹¶è¡ŒåŒæ­¥çš„ä»æœåŠ¡å™¨æ•°é‡</span>
sentinel parallel-syncs mymaster 1

<span class="hljs-comment"># è®¾ç½®ç½‘ç»œåˆ†åŒºæ—¶çš„æ•…éšœè½¬ç§»ç­–ç•¥</span>
sentinel config-epoch mymaster 0
sentinel leader-epoch mymaster 0
</code></pre>
<h4 data-id="heading-16">5.2 å®ç°å®¢æˆ·ç«¯é‡è¯•æœºåˆ¶</h4>
<p>åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å¢åŠ é‡è¯•æœºåˆ¶ï¼Œç¡®ä¿åœ¨ç½‘ç»œåˆ†åŒºæ—¶èƒ½å¤Ÿè‡ªåŠ¨é‡è¿ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisClientRetry</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">maxRetries</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">attempt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">connected</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">while</span> (attempt &lt; maxRetries &amp;&amp; !connected) {
            <span class="hljs-keyword">try</span> {
                attempt++;
                jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>);
                <span class="hljs-comment">// æ‰§è¡ŒRedisæ“ä½œ</span>
                jedis.set(<span class="hljs-string">"key"</span>, <span class="hljs-string">"value"</span>);
                System.out.println(<span class="hljs-string">"Value for 'key': "</span> + jedis.get(<span class="hljs-string">"key"</span>));
                connected = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">catch</span> (Exception e) {
                System.err.println(<span class="hljs-string">"Attempt "</span> + attempt + <span class="hljs-string">" failed: "</span> + e.getMessage());
            } <span class="hljs-keyword">finally</span> {
                <span class="hljs-keyword">if</span> (jedis != <span class="hljs-literal">null</span>) {
                    jedis.close();
                }
            }

            <span class="hljs-keyword">if</span> (!connected) {
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">2000</span>);  <span class="hljs-comment">// ç­‰å¾…2ç§’åé‡è¯•</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            }
        }

        <span class="hljs-keyword">if</span> (!connected) {
            System.err.println(<span class="hljs-string">"Failed to connect to Redis after "</span> + maxRetries + <span class="hljs-string">" attempts."</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-17">6. æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–</h3>
<p>é€šè¿‡Redisè‡ªå¸¦çš„ç›‘æ§å·¥å…·ï¼ˆå¦‚<code>INFO</code>å‘½ä»¤ï¼‰æˆ–ç¬¬ä¸‰æ–¹ç›‘æ§å·¥å…·ï¼ˆå¦‚Redis Exporterç»“åˆPrometheuså’ŒGrafanaï¼‰æ¥ç›‘æ§ä¸»ä»åŒæ­¥çŠ¶æ€ï¼Œå¹¶åŠæ—¶ä¼˜åŒ–ã€‚</p>
<h4 data-id="heading-18">6.1 ä½¿ç”¨<code>INFO</code>å‘½ä»¤ç›‘æ§å¤åˆ¶çŠ¶æ€</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisReplicationMonitor</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>)) {
            <span class="hljs-comment">// è·å–ä»æœåŠ¡å™¨çš„å¤åˆ¶çŠ¶æ€ä¿¡æ¯</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> jedis.info(<span class="hljs-string">"replication"</span>);
            System.out.println(info);
        }
    }
}
</code></pre>
<h4 data-id="heading-19">6.2 ä½¿ç”¨Redis Exporterç»“åˆPrometheuså’ŒGrafana</h4>
<ol>
<li>
<p><strong>éƒ¨ç½²Redis Exporter</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d --name redis_exporter -p 9121:9121 oliver006/redis_exporter
</code></pre>
</li>
<li>
<p><strong>é…ç½®Prometheusç›‘æ§Redis Exporter</strong>ï¼š
åœ¨Prometheusé…ç½®æ–‡ä»¶<code>prometheus.yml</code>ä¸­æ·»åŠ Redis Exporterçš„jobï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'redis_exporter'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'localhost:9121'</span>]
</code></pre>
</li>
<li>
<p><strong>åœ¨Grafanaä¸­æ·»åŠ Prometheusæ•°æ®æºå¹¶åˆ›å»ºç›‘æ§é¢æ¿</strong>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-20">æ€»ç»“</h3>
<p>é€šè¿‡é…ç½®ä¸»ä»å¤åˆ¶ã€ä¼˜åŒ–åŒæ­¥å»¶è¿Ÿã€ä½¿ç”¨Redis Sentinelå¤„ç†ä¸»ä»åˆ‡æ¢ã€è°ƒæ•´å…¨é‡å’Œå¢é‡å¤åˆ¶å‚æ•°ã€å¤„ç†ç½‘ç»œåˆ†åŒºï¼Œä»¥åŠé€šè¿‡ç›‘æ§å·¥å…·è¿›è¡Œæ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³Redisçš„ä¸»ä»åŒæ­¥é—®é¢˜ã€‚ä¸Šè¿°ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•é€šè¿‡Javaä»£ç ç»“åˆJedisåº“æ¥å®ç°è¿™äº›ä¼˜åŒ–ç­–ç•¥ï¼Œç¡®ä¿Redisä¸»ä»åŒæ­¥çš„ç¨³å®šæ€§å’Œé«˜æ•ˆæ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++æ™ºèƒ½æŒ‡é’ˆé¿å‘æŒ‡å—ï¼š90%äººä¼šçŠ¯çš„3ä¸ªè‡´å‘½é”™è¯¯]]></title>    <link>https://juejin.cn/post/7579101504289488950</link>    <guid>https://juejin.cn/post/7579101504289488950</guid>    <pubDate>2025-12-02T14:41:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579101504289488950" data-draft-id="7579101504289472566" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++æ™ºèƒ½æŒ‡é’ˆé¿å‘æŒ‡å—ï¼š90%äººä¼šçŠ¯çš„3ä¸ªè‡´å‘½é”™è¯¯"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T14:41:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++æ™ºèƒ½æŒ‡é’ˆé¿å‘æŒ‡å—ï¼š90%äººä¼šçŠ¯çš„3ä¸ªè‡´å‘½é”™è¯¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:41:16.000Z" title="Tue Dec 02 2025 14:41:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½ ä»¥ä¸ºå°†<code>new</code>æ›¿æ¢ä¸º<code>make_shared</code>å°±ä¸‡äº‹å¤§å‰ï¼ŸçœŸç›¸æ˜¯ï¼Œæ™ºèƒ½æŒ‡é’ˆçš„é™·é˜±æ¯”æ‰‹åŠ¨ç®¡ç†æ›´éšè”½ã€æ›´å±é™©ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æå¾ªç¯å¼•ç”¨ã€æ€§èƒ½é™·é˜±ã€çº¿ç¨‹å®‰å…¨è¿™ä¸‰å¤§ã€Œæš—ç¤ã€ï¼Œè®©ä½ ä»ã€Œè‡ªä»¥ä¸ºä¼šã€åˆ°ã€ŒçœŸæ­£ç²¾é€šã€ã€‚</p>
</blockquote>
<h2 data-id="heading-0"><strong>ä¸€ä¸ªç»å…¸çš„å´©æºƒä»£ç </strong></h2>
<p>å¦‚ä¸‹ä»£ç å±•éœ²äº†æ™ºèƒ½æŒ‡é’ˆä¸­çš„<strong>å¾ªç¯å¼•ç”¨</strong>é—®é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è¿™å°±æ˜¯é‚£ä¸ªå¯¼è‡´å´©æºƒçš„ç®€åŒ–ç‰ˆä»£ç </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfile</span> {
    std::shared_ptr&lt;UserProfile&gt; recommend_to;  <span class="hljs-comment">// æ¨èç»™è°</span>
    <span class="hljs-comment">// ... å…¶ä»–æ•°æ®</span>
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">create_recommendation_cycle</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">auto</span> user1 = std::<span class="hljs-built_in">make_shared</span>&lt;UserProfile&gt;();
    <span class="hljs-keyword">auto</span> user2 = std::<span class="hljs-built_in">make_shared</span>&lt;UserProfile&gt;();
    
    user1-&gt;recommend_to = user2;  <span class="hljs-comment">// user1æ¨èuser2</span>
    user2-&gt;recommend_to = user1;  <span class="hljs-comment">// user2åˆæ¨èuser1</span>
    
    <span class="hljs-comment">// ç¦»å¼€ä½œç”¨åŸŸåï¼Œå¼•ç”¨è®¡æ•°æ°¸è¿œä¸ä¼šå½’é›¶ï¼</span>
    <span class="hljs-comment">// å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆOOMï¼ˆå†…å­˜è€—å°½ï¼‰</span>
}
</code></pre>
<p>è¿™å°±æ˜¯æ™ºèƒ½æŒ‡é’ˆæœ€è®½åˆºçš„åœ°æ–¹ï¼š<strong>ä½ ä¸ºäº†é¿å…å†…å­˜æ³„æ¼è€Œä½¿ç”¨å®ƒï¼Œç»“æœå®ƒå´å¯¼è‡´äº†æ›´éšè”½çš„å†…å­˜æ³„æ¼</strong>ã€‚</p>
<h2 data-id="heading-1"><strong>é”™è¯¯ä¸€ï¼šå¾ªç¯å¼•ç”¨â€”â€”æ™ºèƒ½æŒ‡é’ˆçš„ã€Œé¬¼æ‰“å¢™ã€</strong></h2>
<h3 data-id="heading-2"><strong>1.1 å¾ªç¯å¼•ç”¨çš„å…¸å‹åœºæ™¯</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åœºæ™¯1ï¼šåŒå‘å…³è”ï¼ˆçˆ¶å­èŠ‚ç‚¹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
<span class="hljs-keyword">public</span>:
    std::shared_ptr&lt;TreeNode&gt; parent;
    std::vector&lt;std::shared_ptr&lt;TreeNode&gt;&gt; children;
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add_child</span><span class="hljs-params">(std::shared_ptr&lt;TreeNode&gt; child)</span> </span>{
        children.<span class="hljs-built_in">push_back</span>(child);
        child-&gt;parent = <span class="hljs-built_in">shared_from_this</span>();  <span class="hljs-comment">// è‡´å‘½é”™è¯¯ï¼</span>
    }
};

<span class="hljs-comment">// åœºæ™¯2ï¼šè§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„ç›¸äº’æŒæœ‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span>;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Subject</span> {
    std::vector&lt;std::shared_ptr&lt;Observer&gt;&gt; observers;
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> {
    std::shared_ptr&lt;Subject&gt; subject;  <span class="hljs-comment">// äº’ç›¸æŒæœ‰ï¼</span>
};

<span class="hljs-comment">// åœºæ™¯3ï¼šç¼“å­˜ç³»ç»Ÿä¸­çš„è‡ªå¼•ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheEntry</span> {
    std::shared_ptr&lt;CacheEntry&gt; next_in_lru;  <span class="hljs-comment">// LRUé“¾è¡¨</span>
    std::shared_ptr&lt;CacheEntry&gt; prev_in_lru;
};
</code></pre>
<h3 data-id="heading-3"><strong>1.2 è§£å†³æ–¹æ¡ˆï¼šweak_ptrçš„æ­£ç¡®ä½¿ç”¨</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ­£ç¡®æ–¹æ¡ˆ1ï¼šä½¿ç”¨weak_ptræ‰“ç ´å¾ªç¯</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
<span class="hljs-keyword">private</span>:
    std::weak_ptr&lt;TreeNode&gt; parent_;  <span class="hljs-comment">// å…³é”®æ”¹å˜ï¼</span>
    std::vector&lt;std::shared_ptr&lt;TreeNode&gt;&gt; children_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">set_parent</span><span class="hljs-params">(std::shared_ptr&lt;TreeNode&gt; parent)</span> </span>{
        parent_ = parent;  <span class="hljs-comment">// weak_pträ¸ä¼šå¢åŠ å¼•ç”¨è®¡æ•°</span>
    }
    
    <span class="hljs-function">std::shared_ptr&lt;TreeNode&gt; <span class="hljs-title">get_parent</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> parent_.<span class="hljs-built_in">lock</span>();  <span class="hljs-comment">// å°è¯•æå‡ä¸ºshared_ptr</span>
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add_child</span><span class="hljs-params">(std::shared_ptr&lt;TreeNode&gt; child)</span> </span>{
        children_.<span class="hljs-built_in">push_back</span>(child);
        child-&gt;<span class="hljs-built_in">set_parent</span>(<span class="hljs-built_in">shared_from_this</span>());
    }
};

<span class="hljs-comment">// æ­£ç¡®æ–¹æ¡ˆ2ï¼šæ˜ç¡®æ‰€æœ‰æƒå…³ç³»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Document</span> {
    <span class="hljs-comment">// æ–‡æ¡£æ‹¥æœ‰é¡µé¢ï¼ˆç‹¬å æ‰€æœ‰æƒï¼‰</span>
    std::vector&lt;std::unique_ptr&lt;Page&gt;&gt; pages_;
    
    <span class="hljs-comment">// é¡µé¢å¯ä»¥å¼•ç”¨æ–‡æ¡£ï¼Œä½†ä¸æ‹¥æœ‰</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Page</span> {
        Document* document_;  <span class="hljs-comment">// åŸå§‹æŒ‡é’ˆï¼å®‰å…¨å—ï¼Ÿ</span>
        <span class="hljs-comment">// è¿™é‡Œçš„å…³é”®ï¼šç”Ÿå‘½å‘¨æœŸç”±Documentç®¡ç†</span>
    };
};
</code></pre>
<h3 data-id="heading-4"><strong>1.3 æ·±åº¦åˆ†æï¼šweak_ptrçš„å·¥ä½œåŸç†</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// weak_ptrå†…éƒ¨æœºåˆ¶æ¨¡æ‹Ÿ</span>
<span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeakPtr</span> {
<span class="hljs-keyword">private</span>:
    T* ptr_;                    <span class="hljs-comment">// æŒ‡å‘å®é™…å¯¹è±¡</span>
    ControlBlock* control_block_;  <span class="hljs-comment">// ä¸shared_ptrå…±äº«çš„æ§åˆ¶å—</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// lock()æ–¹æ³•çš„å®ç°</span>
    <span class="hljs-function">std::shared_ptr&lt;T&gt; <span class="hljs-title">lock</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-keyword">if</span>(control_block_ &amp;&amp; control_block_-&gt;ref_count &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// å¯¹è±¡è¿˜æ´»ç€ï¼Œåˆ›å»ºæ–°çš„shared_ptr</span>
            <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">shared_ptr</span>&lt;T&gt;(*<span class="hljs-keyword">this</span>);
        }
        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">shared_ptr</span>&lt;T&gt;();  <span class="hljs-comment">// è¿”å›ç©ºshared_ptr</span>
    }
    
    <span class="hljs-comment">// æ§åˆ¶å—ç»“æ„</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ControlBlock</span> {
        std::atomic&lt;<span class="hljs-type">size_t</span>&gt; ref_count{<span class="hljs-number">1</span>};     <span class="hljs-comment">// å¼ºå¼•ç”¨è®¡æ•°</span>
        std::atomic&lt;<span class="hljs-type">size_t</span>&gt; weak_count{<span class="hljs-number">1</span>};    <span class="hljs-comment">// å¼±å¼•ç”¨è®¡æ•°</span>
        T* object_ptr{<span class="hljs-literal">nullptr</span>};
        
        ~<span class="hljs-built_in">ControlBlock</span>() {
            <span class="hljs-keyword">if</span>(ref_count == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> object_ptr;  <span class="hljs-comment">// åªæœ‰å¼ºå¼•ç”¨ä¸º0æ—¶æ‰åˆ é™¤å¯¹è±¡</span>
            }
            <span class="hljs-comment">// weak_countä¸º0æ—¶åˆ é™¤æ§åˆ¶å—æœ¬èº«</span>
        }
    };
};
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>weak_ptr</code>ä¸å¢åŠ <strong>å¼ºå¼•ç”¨è®¡æ•°</strong>ï¼Œåªå¢åŠ <strong>å¼±å¼•ç”¨è®¡æ•°</strong></li>
<li>å¯¹è±¡é”€æ¯çš„æ¡ä»¶ï¼šå¼ºå¼•ç”¨è®¡æ•° == 0</li>
<li>æ§åˆ¶å—é”€æ¯çš„æ¡ä»¶ï¼šå¼ºå¼•ç”¨è®¡æ•° == 0 <strong>ä¸”</strong> å¼±å¼•ç”¨è®¡æ•° == 0</li>
</ul>
<h3 data-id="heading-5"><strong>1.4 å¾ªç¯å¼•ç”¨æ£€æµ‹å·¥å…·</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// è¿è¡Œæ—¶æ£€æµ‹å·¥å…·</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CyclicReferenceDetector</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
    <span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">has_cycle</span><span class="hljs-params">(<span class="hljs-type">const</span> std::shared_ptr&lt;T&gt;&amp; start)</span> </span>{
        std::unordered_set&lt;<span class="hljs-type">void</span>*&gt; visited;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">detect_cycle</span>(start, visited);
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
    <span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">detect_cycle</span><span class="hljs-params">(<span class="hljs-type">const</span> std::shared_ptr&lt;T&gt;&amp; current,
                            std::unordered_set&lt;<span class="hljs-type">void</span>*&gt;&amp; visited)</span> </span>{
        <span class="hljs-keyword">if</span>(!current) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-type">void</span>* address = current.<span class="hljs-built_in">get</span>();
        <span class="hljs-keyword">if</span>(visited.<span class="hljs-built_in">count</span>(address)) {
            std::cerr &lt;&lt; <span class="hljs-string">"Cycle detected at: "</span> &lt;&lt; <span class="hljs-built_in">typeid</span>(T).<span class="hljs-built_in">name</span>() 
                     &lt;&lt; <span class="hljs-string">" ["</span> &lt;&lt; address &lt;&lt; <span class="hljs-string">"]"</span> &lt;&lt; std::endl;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        
        visited.<span class="hljs-built_in">insert</span>(address);
        
        <span class="hljs-comment">// ä½¿ç”¨åå°„æˆ–æ‰‹åŠ¨æ³¨å†Œæ¥éå†æˆå‘˜</span>
        <span class="hljs-comment">// è¿™é‡Œç®€åŒ–ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„æœºåˆ¶</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">check_for_cycles</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">auto</span> obj = std::<span class="hljs-built_in">make_shared</span>&lt;TreeNode&gt;();
    <span class="hljs-comment">// ... æ„å»ºå¯èƒ½å¾ªç¯çš„ç»“æ„</span>
    
    <span class="hljs-keyword">if</span>(CyclicReferenceDetector::<span class="hljs-built_in">has_cycle</span>(obj)) {
        std::cerr &lt;&lt; <span class="hljs-string">"WARNING: Memory leak due to cyclic reference!"</span> &lt;&lt; std::endl;
    }
}
</code></pre>
<h2 data-id="heading-6"><strong>é”™è¯¯äºŒï¼šæ€§èƒ½é™·é˜±â€”â€”ä½ ä»¥ä¸ºçš„ã€Œé›¶æˆæœ¬ã€æŠ½è±¡</strong></h2>
<h3 data-id="heading-7"><strong>2.1 shared_ptrçš„éšè—æˆæœ¬</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ€§èƒ½æµ‹è¯•ï¼šshared_ptr vs åŸå§‹æŒ‡é’ˆ</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">benchmark_shared_ptr</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">constexpr</span> <span class="hljs-type">size_t</span> ITERATIONS = <span class="hljs-number">1000000</span>;
    std::vector&lt;std::shared_ptr&lt;Data&gt;&gt; shared_ptrs;
    std::vector&lt;Data*&gt; raw_ptrs;
    
    <span class="hljs-comment">// åˆ›å»ºå¼€é”€</span>
    <span class="hljs-keyword">auto</span> start = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; ++i) {
        shared_ptrs.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">make_shared</span>&lt;Data&gt;(i));
    }
    <span class="hljs-keyword">auto</span> shared_create = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>() - start;
    
    start = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; ++i) {
        raw_ptrs.<span class="hljs-built_in">push_back</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Data</span>(i));
    }
    <span class="hljs-keyword">auto</span> raw_create = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>() - start;
    
    std::cout &lt;&lt; <span class="hljs-string">"åˆ›å»ºå¼€é”€:\n"</span>
              &lt;&lt; <span class="hljs-string">"  shared_ptr: "</span> 
              &lt;&lt; std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::milli&gt;(shared_create).<span class="hljs-built_in">count</span>()
              &lt;&lt; <span class="hljs-string">"ms\n"</span>
              &lt;&lt; <span class="hljs-string">"  åŸå§‹æŒ‡é’ˆ: "</span>
              &lt;&lt; std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::milli&gt;(raw_create).<span class="hljs-built_in">count</span>()
              &lt;&lt; <span class="hljs-string">"ms\n"</span>;
    
    <span class="hljs-comment">// æ‹·è´å¼€é”€</span>
    start = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; ++i) {
        <span class="hljs-keyword">auto</span> copy = shared_ptrs[i];  <span class="hljs-comment">// åŸå­æ“ä½œï¼</span>
    }
    <span class="hljs-keyword">auto</span> shared_copy = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>() - start;
    
    std::cout &lt;&lt; <span class="hljs-string">"æ‹·è´å¼€é”€:\n"</span>
              &lt;&lt; <span class="hljs-string">"  shared_ptr: "</span>
              &lt;&lt; std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::milli&gt;(shared_copy).<span class="hljs-built_in">count</span>()
              &lt;&lt; <span class="hljs-string">"ms (æ¯ä¸ªæ‹·è´çº¦"</span>
              &lt;&lt; std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::nano&gt;(shared_copy).<span class="hljs-built_in">count</span>()/ITERATIONS
              &lt;&lt; <span class="hljs-string">"ns)\n"</span>;
}
</code></pre>
<p><strong>æ€§èƒ½å¼€é”€æ¥æº</strong>ï¼š</p>
<ol>
<li><strong>æ§åˆ¶å—åˆ†é…</strong>ï¼šé¢å¤–çš„ä¸€æ¬¡å†…å­˜åˆ†é…ï¼ˆé™¤éç”¨<code>make_shared</code>ï¼‰</li>
<li><strong>åŸå­æ“ä½œ</strong>ï¼šå¼•ç”¨è®¡æ•°çš„å¢å‡éœ€è¦åŸå­æ“ä½œï¼Œå½±å“å¤šæ ¸æ€§èƒ½</li>
<li><strong>ç¼“å­˜ä¸å‹å¥½</strong>ï¼šå¯¹è±¡å’Œæ§åˆ¶å—å¯èƒ½ä¸åœ¨åŒä¸€ç¼“å­˜è¡Œ</li>
<li><strong>è™šå‡½æ•°å¼€é”€</strong>ï¼šè‡ªå®šä¹‰åˆ é™¤å™¨å’Œåˆ†é…å™¨å¯èƒ½å¼•å…¥é—´æ¥è°ƒç”¨</li>
</ol>
<h3 data-id="heading-8"><strong>2.2 make_shared vs shared_ptræ„é€ å‡½æ•°</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å…³é”®åŒºåˆ«ï¼šå†…å­˜å¸ƒå±€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LargeObject</span> {
    <span class="hljs-type">char</span> data[<span class="hljs-number">1024</span>];  <span class="hljs-comment">// 1KBæ•°æ®</span>
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">memory_layout_demo</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// æ–¹å¼1ï¼šä¸¤æ¬¡å†…å­˜åˆ†é…</span>
    <span class="hljs-function">std::shared_ptr&lt;LargeObject&gt; <span class="hljs-title">p1</span><span class="hljs-params">(<span class="hljs-keyword">new</span> LargeObject)</span></span>;
    <span class="hljs-comment">// å †å¸ƒå±€ï¼š[æ§åˆ¶å—] ... [LargeObject]</span>
    <span class="hljs-comment">// ä¸¤æ¬¡åˆ†é…ï¼Œå¯èƒ½å†…å­˜ç¢ç‰‡</span>
    
    <span class="hljs-comment">// æ–¹å¼2ï¼šä¸€æ¬¡å†…å­˜åˆ†é…ï¼ˆæ¨èï¼‰</span>
    <span class="hljs-keyword">auto</span> p2 = std::<span class="hljs-built_in">make_shared</span>&lt;LargeObject&gt;();
    <span class="hljs-comment">// å †å¸ƒå±€ï¼š[æ§åˆ¶å— + LargeObject]</span>
    <span class="hljs-comment">// å•æ¬¡åˆ†é…ï¼Œæ›´å¥½çš„å±€éƒ¨æ€§</span>
    
    <span class="hljs-comment">// ä½†æ³¨æ„ï¼šweak_pträ¼šé˜»æ­¢æ•´ä¸ªå†…å­˜å—é‡Šæ”¾</span>
    std::weak_ptr&lt;LargeObject&gt; weak = p2;
    p2.<span class="hljs-built_in">reset</span>();  <span class="hljs-comment">// LargeObjectææ„ï¼Œä½†å†…å­˜ç›´åˆ°weaké”€æ¯æ‰é‡Šæ”¾</span>
}
</code></pre>
<h3 data-id="heading-9"><strong>2.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ç­–ç•¥1ï¼šä¼˜å…ˆä½¿ç”¨unique_ptr</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectionPool</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// æ± æ‹¥æœ‰æ‰€æœ‰è¿æ¥</span>
    std::vector&lt;std::unique_ptr&lt;Connection&gt;&gt; connections_;
    
    <span class="hljs-comment">// å€Ÿå‡ºæ—¶è¿”å›åŸå§‹æŒ‡é’ˆæˆ–å¼•ç”¨</span>
    <span class="hljs-function">Connection* <span class="hljs-title">borrow_connection</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> connections_[next_available_].<span class="hljs-built_in">get</span>();
    }
    
    <span class="hljs-comment">// unique_ptræ²¡æœ‰å¼•ç”¨è®¡æ•°å¼€é”€</span>
    <span class="hljs-comment">// æ‰€æœ‰æƒæ¸…æ™°ï¼Œé›¶é¢å¤–æˆæœ¬</span>
};

<span class="hljs-comment">// ç­–ç•¥2ï¼šä¼ é€’constå¼•ç”¨è€Œä¸æ˜¯æ‹·è´shared_ptr</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_data_bad</span><span class="hljs-params">(<span class="hljs-type">const</span> std::shared_ptr&lt;Data&gt;&amp; data)</span> </span>{
    <span class="hljs-comment">// è¿™é‡Œçœ‹ä¼¼æ²¡æœ‰æ‹·è´ï¼Œä½†å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æœ‰</span>
    <span class="hljs-keyword">auto</span> local_copy = data;  <span class="hljs-comment">// åŸå­é€’å¢ï¼</span>
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_data_good</span><span class="hljs-params">(<span class="hljs-type">const</span> Data&amp; data)</span> </span>{  <span class="hljs-comment">// ç›´æ¥ä¼ é€’å¼•ç”¨</span>
    <span class="hljs-comment">// æ²¡æœ‰å¼•ç”¨è®¡æ•°æ“ä½œ</span>
    <span class="hljs-comment">// è°ƒç”¨è€…éœ€ä¿è¯dataçš„ç”Ÿå‘½å‘¨æœŸ</span>
}

<span class="hljs-comment">// ç­–ç•¥3ï¼šå±€éƒ¨ä½¿ç”¨shared_ptrï¼Œé•¿æœŸä½¿ç”¨weak_ptr</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SessionManager</span> {
<span class="hljs-keyword">private</span>:
    std::unordered_map&lt;SessionId, std::weak_ptr&lt;Session&gt;&gt; sessions_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">std::shared_ptr&lt;Session&gt; <span class="hljs-title">get_session</span><span class="hljs-params">(SessionId id)</span> </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">auto</span> it = sessions_.<span class="hljs-built_in">find</span>(id); it != sessions_.<span class="hljs-built_in">end</span>()) {
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">auto</span> session = it-&gt;second.<span class="hljs-built_in">lock</span>()) {
                <span class="hljs-keyword">return</span> session;  <span class="hljs-comment">// ä¼šè¯è¿˜æ´»ç€</span>
            }
            sessions_.<span class="hljs-built_in">erase</span>(it);  <span class="hljs-comment">// ä¼šè¯å·²è¿‡æœŸï¼Œæ¸…ç†</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">register_session</span><span class="hljs-params">(SessionId id, std::shared_ptr&lt;Session&gt; session)</span> </span>{
        sessions_[id] = session;  <span class="hljs-comment">// å­˜å‚¨weak_ptrï¼Œä¸é˜»æ­¢é”€æ¯</span>
    }
};
</code></pre>
<h3 data-id="heading-10"><strong>2.4 åŸå­æ“ä½œçš„æ€§èƒ½å½±å“</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// shared_ptrå¼•ç”¨è®¡æ•°çš„åŸå­æ“ä½œï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedPtr</span> {
    T* ptr;
    std::atomic&lt;<span class="hljs-type">long</span>&gt;* ref_count;  <span class="hljs-comment">// åŸå­ç±»å‹</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">SharedPtr</span>(<span class="hljs-type">const</span> SharedPtr&amp; other) : <span class="hljs-built_in">ptr</span>(other.ptr), <span class="hljs-built_in">ref_count</span>(other.ref_count) {
        <span class="hljs-comment">// å†…å­˜å±éšœï¼å½±å“å¤šæ ¸æ€§èƒ½</span>
        ref_count-&gt;<span class="hljs-built_in">fetch_add</span>(<span class="hljs-number">1</span>, std::memory_order_relaxed);
    }
    
    ~<span class="hljs-built_in">SharedPtr</span>() {
        <span class="hljs-keyword">if</span>(ref_count-&gt;<span class="hljs-built_in">fetch_sub</span>(<span class="hljs-number">1</span>, std::memory_order_acq_rel) == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">delete</span> ptr;
            <span class="hljs-keyword">delete</span> ref_count;
        }
    }
};

<span class="hljs-comment">// æ€§èƒ½å¯¹æ¯”ï¼šå•çº¿ç¨‹ vs å¤šçº¿ç¨‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">atomic_overhead_demo</span><span class="hljs-params">()</span> </span>{
    std::atomic&lt;<span class="hljs-type">int</span>&gt; atomic_counter{<span class="hljs-number">0</span>};
    <span class="hljs-type">int</span> non_atomic_counter = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> ITERATIONS = <span class="hljs-number">10000000</span>;
    
    <span class="hljs-comment">// å•çº¿ç¨‹æ€§èƒ½</span>
    <span class="hljs-keyword">auto</span> start = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; ++i) {
        atomic_counter.<span class="hljs-built_in">fetch_add</span>(<span class="hljs-number">1</span>, std::memory_order_relaxed);
    }
    <span class="hljs-keyword">auto</span> atomic_time = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>() - start;
    
    start = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; ++i) {
        ++non_atomic_counter;
    }
    <span class="hljs-keyword">auto</span> non_atomic_time = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>() - start;
    
    std::cout &lt;&lt; <span class="hljs-string">"åŸå­æ“ä½œå¼€é”€: "</span>
              &lt;&lt; std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::milli&gt;(atomic_time).<span class="hljs-built_in">count</span>() / 
                 std::chrono::<span class="hljs-built_in">duration</span>&lt;<span class="hljs-type">double</span>, std::milli&gt;(non_atomic_time).<span class="hljs-built_in">count</span>()
              &lt;&lt; <span class="hljs-string">"å€\n"</span>;
}
</code></pre>
<h2 data-id="heading-11"><strong>é”™è¯¯ä¸‰ï¼šçº¿ç¨‹å®‰å…¨â€”â€”æœ€å±é™©çš„å¹»è§‰</strong></h2>
<h3 data-id="heading-12"><strong>3.1 shared_ptrçš„çº¿ç¨‹å®‰å…¨å±‚çº§</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// shared_ptrçš„çº¿ç¨‹å®‰å…¨æ˜¯åˆ†å±‚çš„ï¼š</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafetyLevels</span> {
    <span class="hljs-comment">// çº§åˆ«1ï¼šæ§åˆ¶å—çº¿ç¨‹å®‰å…¨ï¼ˆæ ‡å‡†ä¿è¯ï¼‰</span>
    <span class="hljs-comment">//   - å¼•ç”¨è®¡æ•°çš„å¢å‡æ˜¯åŸå­çš„</span>
    <span class="hljs-comment">//   - ä¸åŒçš„shared_ptrå®ä¾‹å¯ä»¥è¢«ä¸åŒçº¿ç¨‹å®‰å…¨åœ°ææ„</span>
    
    <span class="hljs-comment">// çº§åˆ«2ï¼šæŒ‡å‘çš„æ•°æ®çº¿ç¨‹ä¸å®‰å…¨ï¼</span>
    <span class="hljs-comment">//   - shared_pträ¸ä¿è¯å…¶ç®¡ç†çš„å¯¹è±¡çš„çº¿ç¨‹å®‰å…¨</span>
    <span class="hljs-comment">//   - å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€ä¸ªå¯¹è±¡éœ€è¦å¤–éƒ¨åŒæ­¥</span>
    
    <span class="hljs-comment">// çº§åˆ«3ï¼šåŒä¸€ä¸ªshared_ptrå®ä¾‹çš„è¯»å†™ä¸å®‰å…¨ï¼</span>
    <span class="hljs-comment">//   - åŒä¸€ä¸ªshared_ptrå¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹è¯»å†™éœ€è¦åŒæ­¥</span>
};

<span class="hljs-comment">// è¯æ˜ï¼šshared_ptrå†…éƒ¨ä¸ä¿æŠ¤å¯¹è±¡</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">concurrent_access_problem</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">auto</span> shared_data = std::make_shared&lt;std::vector&lt;<span class="hljs-type">int</span>&gt;&gt;();
    
    <span class="hljs-comment">// çº¿ç¨‹1ï¼šä¿®æ”¹æ•°æ®</span>
    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">([&amp;shared_data]() {
        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; ++i) {
            shared_data-&gt;push_back(i);  <span class="hljs-comment">// ç«æ€æ¡ä»¶ï¼</span>
        }
    })</span></span>;
    
    <span class="hljs-comment">// çº¿ç¨‹2ï¼šåŒæ—¶è¯»å–</span>
    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">([&amp;shared_data]() {
        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; ++i) {
            <span class="hljs-keyword">if</span>(!shared_data-&gt;empty()) {
                <span class="hljs-type">int</span> value = shared_data-&gt;back();  <span class="hljs-comment">// å¯èƒ½è¯»å–åˆ°æ— æ•ˆæ•°æ®ï¼</span>
            }
        }
    })</span></span>;
    
    t1.<span class="hljs-built_in">join</span>();
    t2.<span class="hljs-built_in">join</span>();
    <span class="hljs-comment">// ç»“æœï¼šæœªå®šä¹‰è¡Œä¸ºï¼å¯èƒ½å´©æºƒæˆ–æ•°æ®æŸå</span>
}
</code></pre>
<h3 data-id="heading-13"><strong>3.2 å…¸å‹çº¿ç¨‹å®‰å…¨é—®é¢˜</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// é—®é¢˜1ï¼šé”™è¯¯çš„ã€Œçº¿ç¨‹å®‰å…¨ã€å‡è®¾</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadUnsafeCache</span> {
    std::unordered_map&lt;std::string, std::shared_ptr&lt;Data&gt;&gt; cache_;
    std::mutex mutex_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function">std::shared_ptr&lt;Data&gt; <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; key)</span> </span>{
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(mutex_)</span></span>;
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">auto</span> it = cache_.<span class="hljs-built_in">find</span>(key); it != cache_.<span class="hljs-built_in">end</span>()) {
            <span class="hljs-keyword">return</span> it-&gt;second;  <span class="hljs-comment">// çœ‹ä¼¼å®‰å…¨...</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }
    
    <span class="hljs-comment">// é—®é¢˜ï¼šè¿”å›çš„shared_ptrå¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰</span>
    <span class="hljs-comment">// å®ƒä»¬å¯ä»¥åŒæ—¶ä¿®æ”¹Dataï¼Œè€ŒDataæ²¡æœ‰å†…ç½®çš„çº¿ç¨‹ä¿æŠ¤ï¼</span>
};

<span class="hljs-comment">// é—®é¢˜2ï¼šshared_ptrçš„åŸå­æ“ä½œè¯¯è§£</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">atomic_shared_ptr_misconception</span><span class="hljs-params">()</span> </span>{
    std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; p = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">42</span>);
    
    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">([&amp;p]() {
        <span class="hljs-keyword">auto</span> local_copy = p;  <span class="hljs-comment">// å¼•ç”¨è®¡æ•°åŸå­é€’å¢</span>
        <span class="hljs-comment">// ä½†p.reset()å¯èƒ½åŒæ—¶å‘ç”Ÿï¼</span>
    })</span></span>;
    
    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">([&amp;p]() {
        p.reset(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>(<span class="hljs-number">100</span>));  <span class="hljs-comment">// ä¿®æ”¹pæœ¬èº«éœ€è¦åŒæ­¥ï¼</span>
    })</span></span>;
    
    t1.<span class="hljs-built_in">join</span>();
    t2.<span class="hljs-built_in">join</span>();
    <span class="hljs-comment">// è¿™é‡Œæœ‰ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®ç«äº‰ï¼š</span>
    <span class="hljs-comment">// 1. å¯¹pæœ¬èº«çš„ä¿®æ”¹ï¼ˆshared_ptrå¯¹è±¡ï¼‰</span>
    <span class="hljs-comment">// 2. å¯¹æ–°æ—§intå¯¹è±¡çš„è®¿é—®</span>
};
</code></pre>
<h3 data-id="heading-14"><strong>3.3 çº¿ç¨‹å®‰å…¨æ™ºèƒ½æŒ‡é’ˆå®ç°</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ–¹æ¡ˆ1ï¼šä½¿ç”¨atomic_shared_ptrï¼ˆC++20ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cpp20_atomic_shared_ptr</span><span class="hljs-params">()</span> </span>{
    std::atomic&lt;std::shared_ptr&lt;<span class="hljs-type">int</span>&gt;&gt; atomic_ptr;
    
    <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨åœ°å­˜å‚¨</span>
    <span class="hljs-function">std::thread <span class="hljs-title">writer</span><span class="hljs-params">([&amp;atomic_ptr]() {
        atomic_ptr.store(std::make_shared&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">42</span>));
    })</span></span>;
    
    <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨åœ°åŠ è½½</span>
    <span class="hljs-function">std::thread <span class="hljs-title">reader</span><span class="hljs-params">([&amp;atomic_ptr]() {
        std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; local = atomic_ptr.load();
        <span class="hljs-keyword">if</span>(local) {
            <span class="hljs-comment">// å®‰å…¨è¯»å–localæŒ‡å‘çš„å†…å®¹</span>
            <span class="hljs-comment">// ä½†å¤šä¸ªreaderå¯èƒ½åŒæ—¶è¯»å–ï¼Œå†…å®¹æœ¬èº«éœ€è¦ä¿æŠ¤</span>
        }
    })</span></span>;
    
    writer.<span class="hljs-built_in">join</span>();
    reader.<span class="hljs-built_in">join</span>();
}

<span class="hljs-comment">// æ–¹æ¡ˆ2ï¼šæ‰‹åŠ¨å®ç°å¸¦é”çš„æ™ºèƒ½æŒ‡é’ˆ</span>
<span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeSharedPtr</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ControlBlock</span> {
        T* ptr;
        std::atomic&lt;<span class="hljs-type">size_t</span>&gt; ref_count;
        std::mutex data_mutex;  <span class="hljs-comment">// ä¿æŠ¤å¯¹è±¡æœ¬èº«</span>
        
        <span class="hljs-comment">// è‡ªå®šä¹‰åˆ é™¤å™¨ï¼Œç¡®ä¿å®‰å…¨é”€æ¯</span>
        <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">safe_delete</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(data_mutex)</span></span>;
            <span class="hljs-keyword">delete</span> ptr;
            ptr = <span class="hljs-literal">nullptr</span>;
        }
    };
    
    ControlBlock* cb_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æä¾›çº¿ç¨‹å®‰å…¨çš„è®¿é—®æ¥å£</span>
    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> Func&gt;
    <span class="hljs-keyword">auto</span> <span class="hljs-title">with_lock</span><span class="hljs-params">(Func&amp;&amp; func)</span> </span>{
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(cb_-&gt;data_mutex)</span></span>;
        <span class="hljs-keyword">return</span> std::forward&lt;Func&gt;(func)(*cb_-&gt;ptr);
    }
    
    <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨çš„reset</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reset</span><span class="hljs-params">(T* new_ptr = <span class="hljs-literal">nullptr</span>)</span> </span>{
        <span class="hljs-keyword">if</span>(cb_ &amp;&amp; cb_-&gt;ref_count.<span class="hljs-built_in">fetch_sub</span>(<span class="hljs-number">1</span>) == <span class="hljs-number">1</span>) {
            cb_-&gt;<span class="hljs-built_in">safe_delete</span>();
            <span class="hljs-keyword">delete</span> cb_;
        }
        <span class="hljs-keyword">if</span>(new_ptr) {
            cb_ = <span class="hljs-keyword">new</span> ControlBlock{new_ptr, <span class="hljs-number">1</span>};
        } <span class="hljs-keyword">else</span> {
            cb_ = <span class="hljs-literal">nullptr</span>;
        }
    }
};
</code></pre>
<h3 data-id="heading-15"><strong>3.4 å¤šçº¿ç¨‹ç¯å¢ƒæœ€ä½³å®è·µ</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æœ€ä½³å®è·µ1ï¼šä½¿ç”¨ä¸å¯å˜æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ImmutableData</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">int</span>&gt; data_;  <span class="hljs-comment">// æ„é€ åä¸å¯å˜</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨ï¼šå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¯»å–</span>
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">size_t</span> index)</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> data_.<span class="hljs-built_in">at</span>(index);
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°ç‰ˆæœ¬è€Œä¸æ˜¯ä¿®æ”¹</span>
    <span class="hljs-function">std::shared_ptr&lt;ImmutableData&gt; <span class="hljs-title">with_addition</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">auto</span> new_data = std::<span class="hljs-built_in">make_shared</span>&lt;ImmutableData&gt;(*<span class="hljs-keyword">this</span>);
        <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œéœ€è¦å®é™…çš„ä¸å¯å˜å®ç°</span>
        <span class="hljs-keyword">return</span> new_data;
    }
};

<span class="hljs-comment">// æœ€ä½³å®è·µ2ï¼šæ˜ç¡®çš„æ‰€æœ‰æƒä¼ é€’</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeMessageQueue</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Message</span> {
        std::unique_ptr&lt;Data&gt; data;  <span class="hljs-comment">// ç‹¬å æ‰€æœ‰æƒ</span>
        <span class="hljs-comment">// unique_ptræ˜ç¡®è¡¨ç¤ºï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰</span>
    };
    
    std::queue&lt;Message&gt; queue_;
    std::mutex queue_mutex_;
    std::condition_variable cv_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// ç”Ÿäº§è€…ï¼šè½¬ç§»æ‰€æœ‰æƒåˆ°é˜Ÿåˆ—</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">push</span><span class="hljs-params">(std::unique_ptr&lt;Data&gt; data)</span> </span>{
        {
            <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(queue_mutex_)</span></span>;
            queue_.<span class="hljs-built_in">push</span>(Message{std::<span class="hljs-built_in">move</span>(data)});
        }
        cv_.<span class="hljs-built_in">notify_one</span>();
    }
    
    <span class="hljs-comment">// æ¶ˆè´¹è€…ï¼šä»é˜Ÿåˆ—è·å–æ‰€æœ‰æƒ</span>
    <span class="hljs-function">std::unique_ptr&lt;Data&gt; <span class="hljs-title">pop</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(queue_mutex_)</span></span>;
        cv_.<span class="hljs-built_in">wait</span>(lock, [<span class="hljs-keyword">this</span>]{ <span class="hljs-keyword">return</span> !queue_.<span class="hljs-built_in">empty</span>(); });
        
        Message msg = std::<span class="hljs-built_in">move</span>(queue_.<span class="hljs-built_in">front</span>());
        queue_.<span class="hljs-built_in">pop</span>();
        
        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">move</span>(msg.data);  <span class="hljs-comment">// æ‰€æœ‰æƒè½¬ç§»ç»™æ¶ˆè´¹è€…</span>
    }
};

<span class="hljs-comment">// æœ€ä½³å®è·µ3ï¼šä½¿ç”¨shared_ptrçš„åˆ«åæ„é€ å‡½æ•°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeObserver</span> {
<span class="hljs-keyword">private</span>:
    std::shared_ptr&lt;std::mutex&gt; mutex_;  <span class="hljs-comment">// å…±äº«çš„mutex</span>
    std::shared_ptr&lt;Data&gt; data_;          <span class="hljs-comment">// å…±äº«çš„æ•°æ®</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">ThreadSafeObserver</span>(std::shared_ptr&lt;Data&gt; data)
        : <span class="hljs-built_in">data_</span>(data)
        , <span class="hljs-built_in">mutex_</span>(std::<span class="hljs-built_in">make_shared</span>&lt;std::mutex&gt;()) {}
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(*mutex_)</span></span>;
        <span class="hljs-comment">// å®‰å…¨åœ°è®¿é—®data_</span>
        <span class="hljs-comment">// data_å’Œmutex_çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåœ¨ä¸€èµ·</span>
    }
    
    <span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…å‰¯æœ¬</span>
    <span class="hljs-function">ThreadSafeObserver <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">ThreadSafeObserver</span>(data_);  <span class="hljs-comment">// å…±äº«ç›¸åŒçš„mutexå’Œæ•°æ®</span>
    }
};
</code></pre>
<h2 data-id="heading-16"><strong>ç»¼åˆæ¡ˆä¾‹ï¼šä¸€ä¸ªçº¿ç¨‹å®‰å…¨ã€é«˜æ€§èƒ½çš„å¯¹è±¡æ± </strong></h2>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å®Œæ•´çš„æœ€ä½³å®è·µç¤ºä¾‹</span>
<span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeObjectPool</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PooledObject</span> {
        T object;
        <span class="hljs-type">bool</span> in_use{<span class="hljs-literal">false</span>};
        std::chrono::steady_clock::time_point last_used;
    };
    
    <span class="hljs-comment">// ä½¿ç”¨unique_ptrç®¡ç†æ± ä¸­å¯¹è±¡</span>
    std::vector&lt;std::unique_ptr&lt;PooledObject&gt;&gt; pool_;
    
    <span class="hljs-comment">// å¯ç”¨çš„å¯¹è±¡ä½¿ç”¨weak_ptrå¼•ç”¨</span>
    std::vector&lt;std::weak_ptr&lt;T&gt;&gt; available_;
    
    <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨</span>
    <span class="hljs-keyword">mutable</span> std::shared_mutex mutex_;
    
    <span class="hljs-comment">// é¿å…å¾ªç¯å¼•ç”¨çš„å…³é”®ï¼šè‡ªå®šä¹‰åˆ é™¤å™¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PoolDeleter</span> {
        ThreadSafeObjectPool* pool;
        
        <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(T* ptr)</span> </span>{
            <span class="hljs-comment">// ä¸æ˜¯çœŸçš„åˆ é™¤ï¼Œè€Œæ˜¯è¿”å›æ± ä¸­</span>
            pool-&gt;<span class="hljs-built_in">return_to_pool</span>(ptr);
        }
    };
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è·å–å¯¹è±¡ï¼šè¿”å›å¸¦è‡ªå®šä¹‰åˆ é™¤å™¨çš„shared_ptr</span>
    <span class="hljs-function">std::shared_ptr&lt;T&gt; <span class="hljs-title">acquire</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-function">std::unique_lock <span class="hljs-title">lock</span><span class="hljs-params">(mutex_)</span></span>;
        
        <span class="hljs-comment">// æ¸…ç†è¿‡æœŸçš„weak_ptr</span>
        available_.<span class="hljs-built_in">erase</span>(
            std::<span class="hljs-built_in">remove_if</span>(available_.<span class="hljs-built_in">begin</span>(), available_.<span class="hljs-built_in">end</span>(),
                [](<span class="hljs-type">const</span> std::weak_ptr&lt;T&gt;&amp; wp) { <span class="hljs-keyword">return</span> wp.<span class="hljs-built_in">expired</span>(); }),
            available_.<span class="hljs-built_in">end</span>()
        );
        
        <span class="hljs-comment">// å°è¯•ä»å¯ç”¨å¯¹è±¡ä¸­è·å–</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> it = available_.<span class="hljs-built_in">begin</span>(); it != available_.<span class="hljs-built_in">end</span>(); ++it) {
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">auto</span> sp = it-&gt;<span class="hljs-built_in">lock</span>()) {
                <span class="hljs-comment">// æ‰¾åˆ°å¯ç”¨å¯¹è±¡</span>
                available_.<span class="hljs-built_in">erase</span>(it);
                
                <span class="hljs-comment">// æŸ¥æ‰¾å¯¹åº”çš„PooledObjectå¹¶æ ‡è®°ä¸ºä½¿ç”¨ä¸­</span>
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; pooled_obj : pool_) {
                    <span class="hljs-keyword">if</span>(&amp;pooled_obj-&gt;object == sp.<span class="hljs-built_in">get</span>()) {
                        pooled_obj-&gt;in_use = <span class="hljs-literal">true</span>;
                        pooled_obj-&gt;last_used = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();
                        <span class="hljs-keyword">break</span>;
                    }
                }
                
                <span class="hljs-keyword">return</span> sp;
            }
        }
        
        <span class="hljs-comment">// åˆ›å»ºæ–°å¯¹è±¡</span>
        <span class="hljs-keyword">auto</span> pooled_obj = std::<span class="hljs-built_in">make_unique</span>&lt;PooledObject&gt;();
        T* raw_ptr = &amp;pooled_obj-&gt;object;
        pooled_obj-&gt;in_use = <span class="hljs-literal">true</span>;
        pooled_obj-&gt;last_used = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();
        
        <span class="hljs-comment">// åˆ›å»ºå¸¦è‡ªå®šä¹‰åˆ é™¤å™¨çš„shared_ptr</span>
        <span class="hljs-function">std::shared_ptr&lt;T&gt; <span class="hljs-title">sp</span><span class="hljs-params">(raw_ptr, PoolDeleter{<span class="hljs-keyword">this</span>})</span></span>;
        
        <span class="hljs-comment">// å­˜å‚¨unique_pträ»¥ç®¡ç†ç”Ÿå‘½å‘¨æœŸ</span>
        pool_.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(pooled_obj));
        
        <span class="hljs-keyword">return</span> sp;
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// å¯¹è±¡è¿”å›åˆ°æ± ä¸­ï¼ˆç”±è‡ªå®šä¹‰åˆ é™¤å™¨è°ƒç”¨ï¼‰</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">return_to_pool</span><span class="hljs-params">(T* ptr)</span> </span>{
        <span class="hljs-function">std::unique_lock <span class="hljs-title">lock</span><span class="hljs-params">(mutex_)</span></span>;
        
        <span class="hljs-comment">// æŸ¥æ‰¾å¯¹åº”çš„PooledObject</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; pooled_obj : pool_) {
            <span class="hljs-keyword">if</span>(&amp;pooled_obj-&gt;object == ptr) {
                pooled_obj-&gt;in_use = <span class="hljs-literal">false</span>;
                
                <span class="hljs-comment">// åˆ›å»ºæ–°çš„weak_ptræ·»åŠ åˆ°å¯ç”¨åˆ—è¡¨</span>
                available_.<span class="hljs-built_in">push_back</span>(
                    std::<span class="hljs-built_in">shared_ptr</span>&lt;T&gt;(std::shared_ptr&lt;T&gt;{}, ptr)  <span class="hljs-comment">// åˆ«åæ„é€ å‡½æ•°</span>
                );
                <span class="hljs-keyword">break</span>;
            }
        }
    }
    
    <span class="hljs-comment">// æ¸…ç†é•¿æ—¶é—´æœªç”¨çš„å¯¹è±¡</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cleanup_old_objects</span><span class="hljs-params">(std::chrono::seconds max_idle_time)</span> </span>{
        <span class="hljs-function">std::unique_lock <span class="hljs-title">lock</span><span class="hljs-params">(mutex_)</span></span>;
        
        <span class="hljs-keyword">auto</span> now = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();
        
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> it = pool_.<span class="hljs-built_in">begin</span>(); it != pool_.<span class="hljs-built_in">end</span>(); ) {
            <span class="hljs-keyword">auto</span>&amp; pooled_obj = *it;
            
            <span class="hljs-keyword">if</span>(!pooled_obj-&gt;in_use &amp;&amp; 
               (now - pooled_obj-&gt;last_used) &gt; max_idle_time) {
                <span class="hljs-comment">// ä»available_ä¸­ç§»é™¤å¯¹åº”çš„weak_ptr</span>
                available_.<span class="hljs-built_in">erase</span>(
                    std::<span class="hljs-built_in">remove_if</span>(available_.<span class="hljs-built_in">begin</span>(), available_.<span class="hljs-built_in">end</span>(),
                        [obj_ptr = &amp;pooled_obj-&gt;object](<span class="hljs-type">const</span> std::weak_ptr&lt;T&gt;&amp; wp) {
                            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">auto</span> sp = wp.<span class="hljs-built_in">lock</span>()) {
                                <span class="hljs-keyword">return</span> sp.<span class="hljs-built_in">get</span>() == obj_ptr;
                            }
                            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                        }),
                    available_.<span class="hljs-built_in">end</span>()
                );
                
                <span class="hljs-comment">// åˆ é™¤å¯¹è±¡</span>
                it = pool_.<span class="hljs-built_in">erase</span>(it);
            } <span class="hljs-keyword">else</span> {
                ++it;
            }
        }
    }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">use_object_pool</span><span class="hljs-params">()</span> </span>{
    ThreadSafeObjectPool&lt;DatabaseConnection&gt; pool;
    
    <span class="hljs-comment">// å¤šçº¿ç¨‹å®‰å…¨åœ°è·å–è¿æ¥</span>
    std::vector&lt;std::thread&gt; threads;
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i) {
        threads.<span class="hljs-built_in">emplace_back</span>([&amp;pool, i]() {
            <span class="hljs-comment">// è·å–è¿æ¥ï¼ˆå¯èƒ½é˜»å¡ç›´åˆ°æœ‰å¯ç”¨è¿æ¥ï¼‰</span>
            <span class="hljs-keyword">auto</span> conn = pool.<span class="hljs-built_in">acquire</span>();
            
            <span class="hljs-comment">// ä½¿ç”¨è¿æ¥</span>
            conn-&gt;<span class="hljs-built_in">execute_query</span>(<span class="hljs-string">"SELECT * FROM users"</span>);
            
            <span class="hljs-comment">// connç¦»å¼€ä½œç”¨åŸŸï¼Œè‡ªåŠ¨è¿”å›åˆ°æ± ä¸­</span>
            <span class="hljs-comment">// å› ä¸ºä½¿ç”¨äº†è‡ªå®šä¹‰åˆ é™¤å™¨</span>
        });
    }
    
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) {
        t.<span class="hljs-built_in">join</span>();
    }
}
</code></pre>
<h2 data-id="heading-17"><strong>æ™ºèƒ½æŒ‡é’ˆçš„ä¸‰å¤§ã€Œç”Ÿå­˜æ³•åˆ™ã€</strong></h2>
<h3 data-id="heading-18"><strong>æ³•åˆ™ä¸€ï¼šæ‰€æœ‰æƒè®¾è®¡ä¼˜å…ˆ</strong></h3>
<ol>
<li>èƒ½ä½¿ç”¨<code>unique_ptr</code>å°±ä¸è¦ç”¨<code>shared_ptr</code></li>
<li>æ˜ç¡®å¯¹è±¡çš„æ‰€æœ‰æƒç”Ÿå‘½å‘¨æœŸ</li>
<li>ä½¿ç”¨<code>weak_ptr</code>æ‰“ç ´å¾ªç¯å¼•ç”¨</li>
</ol>
<h3 data-id="heading-19"><strong>æ³•åˆ™äºŒï¼šæ€§èƒ½æ„è¯†å¸¸é©»</strong></h3>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨<code>make_shared</code>/<code>make_unique</code></li>
<li>é¿å…ä¸å¿…è¦çš„<code>shared_ptr</code>æ‹·è´</li>
<li>æ³¨æ„åŸå­æ“ä½œçš„å¼€é”€</li>
</ol>
<h3 data-id="heading-20"><strong>æ³•åˆ™ä¸‰ï¼šçº¿ç¨‹å®‰å…¨ä¸å‡è®¾</strong></h3>
<ol>
<li><code>shared_ptr</code>çš„çº¿ç¨‹å®‰å…¨ä»…é™äºæ§åˆ¶å—</li>
<li>æŒ‡å‘çš„æ•°æ®éœ€è¦é¢å¤–ä¿æŠ¤</li>
<li>è€ƒè™‘ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„</li>
</ol>
<h3 data-id="heading-21"><strong>æœ€ç»ˆæ£€æŸ¥æ¸…å•</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¯æ¬¡ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå‰é—®è‡ªå·±ï¼š</span>
<span class="hljs-number">1.</span> è¿™ä¸ªå¯¹è±¡åº”è¯¥è¢«è°æ‹¥æœ‰ï¼Ÿâ–¡ unique_ptr â–¡ shared_ptr
<span class="hljs-number">2.</span> æ˜¯å¦æœ‰å¾ªç¯å¼•ç”¨çš„å¯èƒ½ï¼Ÿâ–¡ æœ‰ï¼ˆéœ€weak_ptrï¼‰ â–¡ æ— 
<span class="hljs-number">3.</span> æ˜¯å¦ä¼šåœ¨å¤šçº¿ç¨‹ä¸­ä½¿ç”¨ï¼Ÿâ–¡ æ˜¯ï¼ˆéœ€åŒæ­¥ï¼‰ â–¡ å¦
<span class="hljs-number">4.</span> æ˜¯å¦éœ€è¦æœ€ä¼˜æ€§èƒ½ï¼Ÿâ–¡ æ˜¯ï¼ˆé¿å…shared_ptrï¼‰ â–¡ å¦
<span class="hljs-number">5.</span> æ˜¯å¦ä¼ é€’æ‰€æœ‰æƒï¼Ÿâ–¡ æ˜¯ï¼ˆç§»åŠ¨è¯­ä¹‰ï¼‰ â–¡ å¦ï¼ˆä¼ é€’å¼•ç”¨ï¼‰
</code></pre>
<h2 data-id="heading-22"><strong>ä»ã€Œä¼šç”¨ã€åˆ°ã€Œç²¾é€šã€</strong></h2>
<p>æ™ºèƒ½æŒ‡é’ˆä¸æ˜¯ã€Œé“¶å¼¹ã€ï¼Œè€Œæ˜¯ã€ŒåŒåˆƒå‰‘ã€ã€‚å®ƒè§£å†³äº†æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„çƒ¦æ¼ï¼Œå´å¼•å…¥äº†æ›´éšè”½çš„é™·é˜±ã€‚çœŸæ­£çš„ç²¾é€šï¼Œä¸æ˜¯è®°ä½è¯­æ³•ï¼Œè€Œæ˜¯ç†è§£æ¯ä¸ªè®¾è®¡å†³ç­–èƒŒåçš„æƒè¡¡ã€‚</p>
<p>æ­£å¦‚C++ä¹‹çˆ¶Bjarne Stroustrupæ‰€è¯´ï¼šã€ŒC++çš„è®¾è®¡åˆè¡·æ˜¯è®©å¥½çš„è®¾è®¡æ›´å®¹æ˜“ï¼Œåçš„è®¾è®¡æ›´å›°éš¾ã€ã€‚æ™ºèƒ½æŒ‡é’ˆæ­£æ˜¯è¿™ä¸€å“²å­¦çš„ä½“ç°â€”â€”å®ƒå¥–åŠ±æ¸…æ™°çš„æ‰€æœ‰æƒè®¾è®¡ï¼Œæƒ©ç½šæ¨¡ç³Šçš„èµ„æºç®¡ç†ã€‚</p>
<p>ä¸‹æ¬¡å½“ä½ å†™ä¸‹<code>std::shared_ptr</code>æ—¶ï¼Œä¸å¦¨åœé¡¿ä¸€ç§’ï¼Œé—®é—®è‡ªå·±ï¼šã€Œæˆ‘çœŸçš„éœ€è¦å…±äº«æ‰€æœ‰æƒå—ï¼Ÿã€è¿™ä¸ªç®€å•çš„é—®é¢˜ï¼Œå¯èƒ½å°±æ˜¯é¿å…ä¸‹ä¸€ä¸ªæ·±å¤œå´©æºƒçš„å…³é”®ã€‚</p>
<hr/>
<p><strong>æ·±åº¦é˜…è¯»æ¨è</strong>ï¼š</p>
<ol>
<li>ã€ŠEffective Modern C++ã€‹æ¡æ¬¾18-22ï¼šæ™ºèƒ½æŒ‡é’ˆä¸“é¢˜</li>
<li>ã€ŠC++ Concurrency in Actionã€‹ç¬¬7ç« ï¼šæ— é”æ•°æ®ç»“æ„ä¸­çš„æ™ºèƒ½æŒ‡é’ˆ</li>
<li>Boost.smart_ptr æºç åˆ†æ</li>
<li>Facebook follyåº“ä¸­çš„æ™ºèƒ½æŒ‡é’ˆæ‰©å±•</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React ç»„ä»¶é€šè®¯å…¨æ¡ˆä¾‹è§£æï¼šä» Context åˆ° Ref çš„å®æˆ˜åº”ç”¨]]></title>    <link>https://juejin.cn/post/7579438351296987172</link>    <guid>https://juejin.cn/post/7579438351296987172</guid>    <pubDate>2025-12-03T08:43:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579438351296987172" data-draft-id="7579439226518224902" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React ç»„ä»¶é€šè®¯å…¨æ¡ˆä¾‹è§£æï¼šä» Context åˆ° Ref çš„å®æˆ˜åº”ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T08:43:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lcy453"/> <meta itemprop="url" content="https://juejin.cn/user/2921833644950300"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React ç»„ä»¶é€šè®¯å…¨æ¡ˆä¾‹è§£æï¼šä» Context åˆ° Ref çš„å®æˆ˜åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2921833644950300/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lcy453
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:43:14.000Z" title="Wed Dec 03 2025 08:43:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>Â Â  Â  Â  Â  æœ€è¿‘å¼€å‘ä¸­ï¼Œé‡åˆ°äº†ç»„ä»¶é€šè®¯çš„éœ€æ±‚ï¼Œæˆ‘å¾ˆéš¾ç†æ¸…æ¥šå¤æ‚é¡¹ç›®ä¸­çš„é€šè®¯æ€è·¯ï¼Œæœ¬èº«ç»éªŒä¸è¶³ï¼Œè€Œä¸”è‡ªå·±å†™çš„é¡¹ç›®ä¸€èˆ¬éƒ½æ˜¯ç”¨çŠ¶æ€ç®¡ç†å·¥å…·ressoæˆ–è€…zustandç›´æ¥æ‰€æœ‰ç»„ä»¶ä½¿ç”¨ï¼Œæˆ–è€…ç›´æ¥çˆ¶å­ä¹‹é—´ä¼ é€’ï¼Œä½†æ˜¯çªç„¶å‘ç°å…¬å¸é¡¹ç›®æ²¡æœ‰ç”¨åˆ°çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œè€Œæ˜¯ç”¨åŸç”Ÿçš„useReducerå¯¹çŠ¶æ€å’Œæ“ä½œçŠ¶æ€æ–¹æ³•è¿›è¡Œå½’çº³ï¼Œç”¨createContextåˆ›å»ºä¸Šä¸‹æ–‡ï¼Œç„¶åç”¨ä¸Šä¸‹æ–‡ç»„ä»¶ä¸ºæ‰€æœ‰å­ç»„ä»¶æä¾›å…±äº«çš„stateå’Œdispatchã€‚</p>
<p>Â Â Â Â Â Â Â Â åœ¨ React å¼€å‘ä¸­ï¼Œç»„ä»¶é€šè®¯æ˜¯æ ¸å¿ƒçŸ¥è¯†ç‚¹ä¹‹ä¸€ã€‚æœ¬æ–‡å°†é€šè¿‡ä¸€ä¸ªå®Œæ•´æ¡ˆä¾‹ï¼Œè¯¦ç»†è§£æå¦‚ä½•ä½¿ç”¨Â <code>createContext</code>ã€<code>useContext</code>ã€<code>useReducer</code>ã€<code>useRef</code>Â ç­‰ React é’©å­å®ç°ä¸åŒåœºæ™¯ä¸‹çš„ç»„ä»¶é€šè®¯ï¼Œå¹¶å¯¹æ¯æ®µä»£ç è¿›è¡Œé€è¡Œè§£é‡Šã€‚</p>
<h2 data-id="heading-0">1ã€æ¡ˆä¾‹æ•´ä½“æ¶æ„</h2>
<p>Â Â Â Â Â Â Â Â æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŒ…å«å¤šé¡µé¢çš„åº”ç”¨ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  1.è®¡æ•°å™¨åŠŸèƒ½ï¼ˆå¢ / å‡æ“ä½œï¼‰</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  2.è§„åˆ™åˆ—è¡¨ç®¡ç†ï¼ˆæ·»åŠ  / å±•ç¤ºè§„åˆ™ï¼‰</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  3.è·¨ç»„ä»¶æ•°æ®ä¼ é€’ï¼ˆé€šè¿‡ Contextï¼‰</p>
<p>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 4.çˆ¶å­ç»„ä»¶é€šè®¯ï¼ˆé€šè¿‡ Ref è°ƒç”¨å­ç»„ä»¶æ–¹æ³•ï¼‰</p>
<p>Â Â Â Â Â Â Â Â é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  1.ä¸Šä¸‹æ–‡ç®¡ç†ï¼ševent-contexts.tsxï¼ˆæ ¸å¿ƒé€šè®¯é€»è¾‘ï¼‰</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  2.é¡µé¢ç»„ä»¶ï¼š<code>HomePage.tsx</code>ã€<code>DocsPage.tsx</code></p>
<p><code>Â Â Â Â Â Â Â Â 3.å¸ƒ</code>å±€ç»„ä»¶ï¼š<code>Layout.tsx</code>ï¼ˆæä¾›è·¯ç”±å’Œä¸Šä¸‹æ–‡å®¹å™¨ï¼‰</p>
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  4.å­ç»„ä»¶ï¼š<code>Event.tsx</code>ï¼ˆé€šè¿‡ Ref æš´éœ²æ–¹æ³•çš„ç»„ä»¶ï¼‰</p>
<h2 data-id="heading-1">2ã€æ ¸å¿ƒä»£ç è§£æ</h2>
<h3 data-id="heading-2">Â Â 1. ä¸Šä¸‹æ–‡å®šä¹‰ä¸çŠ¶æ€ç®¡ç†ï¼ˆevent-contexts.tsxï¼‰Â  Â  Â Â </h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¯¼å…¥æ‰€éœ€çš„ React é’©å­</span>
<span class="hljs-keyword">import</span> { createContext, useContext, useReducer, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Event</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"../pages/event"</span>;

<span class="hljs-comment">// å®šä¹‰åˆå§‹çŠ¶æ€</span>
<span class="hljs-keyword">const</span> initalState = {
  <span class="hljs-attr">number</span>: <span class="hljs-number">0</span>,          <span class="hljs-comment">// è®¡æ•°å™¨æ•°å€¼</span>
  <span class="hljs-attr">rules</span>: [<span class="hljs-string">"å­™æ‚Ÿç©º"</span>],   <span class="hljs-comment">// è§„åˆ™åˆ—è¡¨åˆå§‹å€¼</span>
  <span class="hljs-attr">exportDate</span>: <span class="hljs-string">""</span>,     <span class="hljs-comment">// ä»å­ç»„ä»¶è·å–çš„æ•°æ®</span>
  <span class="hljs-attr">exportUnit</span>: <span class="hljs-string">""</span>,     <span class="hljs-comment">// æ•°æ®å•ä½</span>
};

<span class="hljs-comment">// å®šä¹‰ action ç±»å‹ï¼ˆçº¦æŸ dispatch å¯æ‰§è¡Œçš„æ“ä½œï¼‰</span>
<span class="hljs-keyword">type</span> actionType = <span class="hljs-string">"increment"</span> | <span class="hljs-string">"decrement"</span> | <span class="hljs-string">"addRule"</span> | <span class="hljs-string">"export"</span>;

<span class="hljs-comment">// å®šä¹‰ action æ¥å£ï¼ˆæè¿° action çš„ç»“æ„ï¼‰</span>
<span class="hljs-keyword">interface</span> action {
  <span class="hljs-attr">type</span>: actionType;       <span class="hljs-comment">// æ“ä½œç±»å‹</span>
  payload?: <span class="hljs-built_in">number</span>;       <span class="hljs-comment">// è®¡æ•°å™¨å¢å‡çš„æ•°å€¼ï¼ˆå¯é€‰ï¼‰</span>
  rule?: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// æ–°å¢çš„è§„åˆ™ï¼ˆå¯é€‰ï¼‰</span>
  exportDate?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// è¦å¯¼å‡ºçš„æ—¥æœŸï¼ˆå¯é€‰ï¼‰</span>
  exportUnit?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// è¦å¯¼å‡ºçš„å•ä½ï¼ˆå¯é€‰ï¼‰</span>
}

<span class="hljs-comment">// å®šä¹‰ reducer å‡½æ•°ï¼ˆå¤„ç†çŠ¶æ€æ›´æ–°çš„çº¯å‡½æ•°ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">reducer</span> = (<span class="hljs-params">state: <span class="hljs-keyword">typeof</span> initalState, action: action</span>) =&gt; {
  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"increment"</span>:
      <span class="hljs-comment">// è®¡æ•°å™¨å¢åŠ ï¼šåŸºäºå½“å‰çŠ¶æ€åˆ›å»ºæ–°å¯¹è±¡ï¼ˆä¸å¯å˜æ›´æ–°ï¼‰</span>
      <span class="hljs-keyword">return</span> { ...state, <span class="hljs-attr">number</span>: state.<span class="hljs-property">number</span> + action.<span class="hljs-property">payload</span> };
    <span class="hljs-keyword">case</span> <span class="hljs-string">"decrement"</span>:
      <span class="hljs-comment">// è®¡æ•°å™¨å‡å°‘</span>
      <span class="hljs-keyword">return</span> { ...state, <span class="hljs-attr">number</span>: state.<span class="hljs-property">number</span> - action.<span class="hljs-property">payload</span> };
    <span class="hljs-keyword">case</span> <span class="hljs-string">"addRule"</span>:
      <span class="hljs-comment">// æ·»åŠ è§„åˆ™ï¼šå¤åˆ¶åŸæ•°ç»„å¹¶æ·»åŠ æ–°å…ƒç´ </span>
      <span class="hljs-keyword">return</span> { ...state, <span class="hljs-attr">rules</span>: [...state.<span class="hljs-property">rules</span>, action.<span class="hljs-property">rule</span> || <span class="hljs-string">""</span>] };
    <span class="hljs-keyword">case</span> <span class="hljs-string">"export"</span>:
      <span class="hljs-comment">// å¯¼å‡ºæ•°æ®ï¼šæ›´æ–°ä»å­ç»„ä»¶è·å–çš„å€¼</span>
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">exportDate</span>: action.<span class="hljs-property">exportDate</span> || <span class="hljs-string">""</span>,
        <span class="hljs-attr">exportUnit</span>: action.<span class="hljs-property">exportUnit</span> || <span class="hljs-string">""</span>,
      };
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
};

<span class="hljs-comment">// åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆå®šä¹‰ä¸Šä¸‹æ–‡çš„ç±»å‹å’Œé»˜è®¤å€¼ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CountContext</span> = createContext&lt;{
  <span class="hljs-attr">state</span>: <span class="hljs-keyword">typeof</span> initalState;
  <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">Dispatch</span>&lt;action&gt;;
}&gt;({
  <span class="hljs-attr">state</span>: initalState,
  <span class="hljs-attr">dispatch</span>: <span class="hljs-function">() =&gt;</span> {},  <span class="hljs-comment">// é»˜è®¤çš„ç©º dispatch</span>
});

<span class="hljs-comment">// å®šä¹‰ Provider ç»„ä»¶ï¼ˆæä¾›ä¸Šä¸‹æ–‡æ•°æ®ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">CountProvider</span> = (<span class="hljs-params">{ children }</span>) =&gt; {
  <span class="hljs-comment">// åˆ›å»ºå­ç»„ä»¶çš„ Refï¼ˆç”¨äºè°ƒç”¨å­ç»„ä»¶æ–¹æ³•ï¼‰</span>
  <span class="hljs-keyword">const</span> eventRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  
  <span class="hljs-comment">// ä½¿ç”¨ useReducer ç®¡ç†çŠ¶æ€ï¼ˆæ›¿ä»£ useState å¤„ç†å¤æ‚çŠ¶æ€é€»è¾‘ï¼‰</span>
  <span class="hljs-keyword">const</span> [state, dispatch] = <span class="hljs-title function_">useReducer</span>(reducer, initalState);
  
  <span class="hljs-comment">// ç”¨äºå­˜å‚¨ä»å­ç»„ä»¶è·å–çš„å€¼ï¼ˆå±€éƒ¨çŠ¶æ€ï¼‰</span>
  <span class="hljs-keyword">const</span> [childValue, setChildValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// å¤„ç†ç‚¹å‡»äº‹ä»¶ï¼šè·å–å­ç»„ä»¶æ•°æ®å¹¶æ›´æ–°ä¸Šä¸‹æ–‡</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// é€šè¿‡ Ref è°ƒç”¨å­ç»„ä»¶æš´éœ²çš„ getValue æ–¹æ³•</span>
    <span class="hljs-keyword">const</span> value = eventRef?.<span class="hljs-property">current</span>?.<span class="hljs-title function_">getValue</span>() || <span class="hljs-string">""</span>;
    <span class="hljs-title function_">setChildValue</span>(value);
    <span class="hljs-comment">// åˆ†å‘ action æ›´æ–°ä¸Šä¸‹æ–‡çŠ¶æ€</span>
    <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"export"</span>, <span class="hljs-attr">exportDate</span>: value, <span class="hljs-attr">exportUnit</span>: <span class="hljs-string">"å…ƒ"</span> });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {/* æ¸²æŸ“å­ç»„ä»¶å¹¶ç»‘å®š Ref */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Event</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{eventRef}</span> /&gt;</span>
      
      {/* è§¦å‘è·å–å­ç»„ä»¶æ•°æ®çš„æŒ‰é’® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleClick()}&gt;
        ç‚¹æˆ‘è·å–å¹¶ä¸”æ˜¾ç¤ºå­ç»„ä»¶æš´éœ²çš„æ•°æ®
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      
      {/* å±•ç¤ºä»å­ç»„ä»¶è·å–çš„æ•°æ® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å­ç»„ä»¶æš´éœ²çš„æ•°æ®ï¼š{state.exportDate}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      
      {/* æä¾›ä¸Šä¸‹æ–‡æ•°æ®ç»™å­ç»„ä»¶æ ‘ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">CountContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">state</span>, <span class="hljs-attr">dispatch</span> }}&gt;</span>
        {children}  {/* æ¸²æŸ“å­ç»„ä»¶ï¼ˆè·¯ç”±é¡µé¢ï¼‰ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">CountContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-comment">// è‡ªå®šä¹‰ Hookï¼šç®€åŒ–ä¸Šä¸‹æ–‡çš„ä½¿ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useCount</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> context = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">CountContext</span>);
  <span class="hljs-comment">// æ ¡éªŒï¼šç¡®ä¿åœ¨ Provider å†…éƒ¨ä½¿ç”¨</span>
  <span class="hljs-keyword">if</span> (!context) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"useCount å¿…é¡»åœ¨ CountProvider ä¸­ä½¿ç”¨"</span>);
  <span class="hljs-keyword">return</span> context;
};
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒé’©å­è§£æ</strong>ï¼š</p>
<ul>
<li><code>createContext</code>ï¼šåˆ›å»ºä¸Šä¸‹æ–‡å®¹å™¨ï¼Œå®šä¹‰å…±äº«æ•°æ®çš„ç»“æ„</li>
<li><code>useContext</code>ï¼šåœ¨ç»„ä»¶ä¸­è·å–ä¸Šä¸‹æ–‡æ•°æ®ï¼Œé¿å… props å±‚å±‚ä¼ é€’</li>
<li><code>useReducer</code>ï¼šå¤„ç†å¤æ‚çŠ¶æ€é€»è¾‘ï¼Œé€šè¿‡ dispatch åˆ†å‘ action æ›´æ–°çŠ¶æ€</li>
<li><code>useRef</code>ï¼šåˆ›å»ºæŒä¹…åŒ–çš„å¼•ç”¨ï¼Œç”¨äºè®¿é—® DOM å…ƒç´ æˆ–å­ç»„ä»¶å®ä¾‹</li>
<li><code>useState</code>ï¼šç®¡ç†ç»„ä»¶å†…éƒ¨çš„ç®€å•çŠ¶æ€</li>
</ul>
<h3 data-id="heading-3">2. å­ç»„ä»¶ï¼ˆEvent.tsxï¼‰- é€šè¿‡ Ref æš´éœ²æ–¹æ³•<code>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </code></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, {
  useImperativeHandle,  <span class="hljs-comment">// è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•</span>
  forwardRef,          <span class="hljs-comment">// è½¬å‘ Ref ç»™å­ç»„ä»¶</span>
  useState,
  useRef,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// ä½¿ç”¨ forwardRef è½¬å‘ Ref åˆ°ç»„ä»¶å†…éƒ¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Event</span> = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> {
  <span class="hljs-comment">// å­ç»„ä»¶å†…éƒ¨çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> [childValue, setChildValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"çŒ´å­"</span>);
  <span class="hljs-comment">// è¾“å…¥æ¡†çš„ Ref</span>
  <span class="hljs-keyword">const</span> ref1 = useRef&lt;<span class="hljs-title class_">HTMLInputElement</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼ˆé€šè¿‡ Ref è®¿é—®ï¼‰</span>
  <span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">getValue</span>: <span class="hljs-function">() =&gt;</span> childValue,  <span class="hljs-comment">// è·å–å½“å‰å€¼</span>
    <span class="hljs-attr">resetValue</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resetValue</span>(),  <span class="hljs-comment">// é‡ç½®å€¼</span>
  }));

  <span class="hljs-comment">// å†…éƒ¨æ–¹æ³•ï¼šè·å–å€¼</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getValue</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> childValue;
  };

  <span class="hljs-comment">// å†…éƒ¨æ–¹æ³•ï¼šé‡ç½®å€¼</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resetValue</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setChildValue</span>(<span class="hljs-string">""</span>);
  };

  <span class="hljs-comment">// æäº¤è¾“å…¥æ¡†çš„å€¼åˆ°ç»„ä»¶çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">submitValue</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setChildValue</span>(ref1?.<span class="hljs-property">current</span>?.<span class="hljs-property">value</span> || <span class="hljs-string">""</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* è¾“å…¥æ¡†ï¼šç»‘å®š ref1 å’Œ childValue */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{childValue}</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref1}</span> /&gt;</span>
      {/* æäº¤æŒ‰é’® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> submitValue()}&gt;æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Event</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒé’©å­è§£æ</strong>ï¼š</p>
<ul>
<li><code>forwardRef</code>ï¼šå…è®¸çˆ¶ç»„ä»¶å°† Ref ä¼ é€’åˆ°å­ç»„ä»¶å†…éƒ¨ï¼Œçªç ´ç»„ä»¶è¾¹ç•Œ</li>
<li><code>useImperativeHandle</code>ï¼šè‡ªå®šä¹‰å­ç»„ä»¶é€šè¿‡ Ref æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œé¿å…æš´éœ²æ•´ä¸ªç»„ä»¶å®ä¾‹</li>
<li><code>useRef</code>ï¼ˆDOM å¼•ç”¨ï¼‰ï¼šè®¿é—®è¾“å…¥æ¡† DOM å…ƒç´ ï¼Œè·å–ç”¨æˆ·è¾“å…¥å€¼</li>
</ul>
<h3 data-id="heading-4">3.å¸ƒå±€ç»„ä»¶ï¼ˆLayout.tsxï¼‰- æä¾›ä¸Šä¸‹æ–‡å®¹å™¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Link</span>, <span class="hljs-title class_">Outlet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"umi"</span>;  <span class="hljs-comment">// Umi æ¡†æ¶çš„è·¯ç”±ç»„ä»¶</span>
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">"./index.less"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CountProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"../contexts/event-contexts"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Layout</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{styles.navs}</span>&gt;</span>
      {/* å¯¼èˆªèœå• */}
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>  {/* é¦–é¡µè·¯ç”± */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/docs"</span>&gt;</span>Docs<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>  {/* æ–‡æ¡£é¡µè·¯ç”± */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://github.com/umijs/umi"</span>&gt;</span>Github<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      
      {/* ä¸Šä¸‹æ–‡æä¾›è€…ï¼šåŒ…è£¹è·¯ç”±å‡ºå£ï¼Œä½¿æ‰€æœ‰é¡µé¢éƒ½èƒ½è®¿é—®ä¸Šä¸‹æ–‡ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">CountProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span> /&gt;</span>  {/* è·¯ç”±å‡ºå£ï¼šæ¸²æŸ“åŒ¹é…çš„é¡µé¢ç»„ä»¶ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">CountProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼š</p>
<ul>
<li>é€šè¿‡Â <code>CountProvider</code>Â åŒ…è£¹Â <code>&lt;Outlet /&gt;</code>ï¼Œç¡®ä¿æ‰€æœ‰è·¯ç”±é¡µé¢éƒ½èƒ½è®¿é—®ä¸Šä¸‹æ–‡</li>
<li>ä½¿ç”¨ Umi çš„Â <code>Link</code>Â å’ŒÂ <code>Outlet</code>Â å®ç°è·¯ç”±è·³è½¬å’Œé¡µé¢æ¸²æŸ“</li>
</ul>
<h3 data-id="heading-5">4. é¦–é¡µç»„ä»¶ï¼ˆHomePage.tsxï¼‰- ä½¿ç”¨ä¸Šä¸‹æ–‡æ•°æ®</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> yayJpg <span class="hljs-keyword">from</span> <span class="hljs-string">"../assets/yay.jpg"</span>;
<span class="hljs-keyword">import</span> { useCount } <span class="hljs-keyword">from</span> <span class="hljs-string">"../contexts/event-contexts"</span>;  <span class="hljs-comment">// å¯¼å…¥è‡ªå®šä¹‰ Hook</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// é€šè¿‡è‡ªå®šä¹‰ Hook è·å–ä¸Šä¸‹æ–‡æ•°æ®</span>
  <span class="hljs-keyword">const</span> { state, dispatch } = <span class="hljs-title function_">useCount</span>();
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* éå†å±•ç¤ºè§„åˆ™åˆ—è¡¨ */}
      {state.rules.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item}</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ))}
      {/* å±•ç¤ºä»å­ç»„ä»¶è·å–çš„æ•°æ®å’Œå•ä½ */}
      ã€Œ{state.exportDate}
      {state.exportUnit}ã€
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>useCount</code>Â è·å–ä¸Šä¸‹æ–‡çš„Â <code>state</code>Â å’ŒÂ <code>dispatch</code></li>
<li>å±•ç¤ºÂ <code>state.rules</code>Â åˆ—è¡¨å’ŒÂ <code>state.exportDate</code>Â æ•°æ®</li>
</ul>
<h3 data-id="heading-6">5. æ–‡æ¡£é¡µç»„ä»¶ï¼ˆDocsPage.tsxï¼‰- æ“ä½œä¸Šä¸‹æ–‡çŠ¶æ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useCount } <span class="hljs-keyword">from</span> <span class="hljs-string">"../contexts/event-contexts"</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">DocsPage</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// è·å–ä¸Šä¸‹æ–‡æ•°æ®</span>
  <span class="hljs-keyword">const</span> { state, dispatch } = <span class="hljs-title function_">useCount</span>();
  <span class="hljs-comment">// æœ¬åœ°çŠ¶æ€ï¼šç®¡ç†è¾“å…¥æ¡†çš„å€¼</span>
  <span class="hljs-keyword">const</span> [name, setName] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* å±•ç¤ºè®¡æ•°å™¨æ•°å€¼ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>number: {state.number}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      
      {/* è®¡æ•°å™¨å¢åŠ æŒ‰é’®ï¼šåˆ†å‘ increment action */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch({ type: "increment", payload: 1 })}&gt;
        increment
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      
      {/* è®¡æ•°å™¨å‡å°‘æŒ‰é’®ï¼šåˆ†å‘ decrement action */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch({ type: "decrement", payload: 1 })}&gt;
        decrement
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      
      {/* å±•ç¤ºè§„åˆ™åˆ—è¡¨ */}
      {state.rules.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item}</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ))}
      
      {/* è¾“å…¥æ¡†ï¼šç”¨äºæ·»åŠ æ–°è§„åˆ™ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)}  // æ›´æ–°æœ¬åœ°çŠ¶æ€
      /&gt;
      
      {/* æ·»åŠ è§„åˆ™æŒ‰é’®ï¼šåˆ†å‘ addRule action */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch({ type: "addRule", rule: name })}&gt;
        addRule
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">DocsPage</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>åŠŸèƒ½è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>useState</code>Â ç®¡ç†è¾“å…¥æ¡†çš„æœ¬åœ°çŠ¶æ€</li>
<li>é€šè¿‡Â <code>dispatch</code>Â åˆ†å‘ä¸åŒç±»å‹çš„ action æ“ä½œä¸Šä¸‹æ–‡çŠ¶æ€</li>
<li>å®ç°è®¡æ•°å™¨å¢å‡å’Œæ·»åŠ è§„åˆ™çš„åŠŸèƒ½</li>
</ul>
<h2 data-id="heading-7">3ã€æ€»ç»“ï¼šReact ç»„ä»¶é€šè®¯æ–¹å¼å¯¹æ¯”</h2>
<ol>
<li>
<p><strong>Context + useReducer</strong></p>
<ul>
<li>é€‚ç”¨åœºæ™¯ï¼šè·¨ç»„ä»¶ï¼ˆå¤šå±‚çº§ï¼‰æ•°æ®å…±äº«</li>
<li>ä¼˜åŠ¿ï¼šé¿å… props é€ä¼ ï¼Œé›†ä¸­ç®¡ç†çŠ¶æ€é€»è¾‘</li>
<li>æ ¸å¿ƒ APIï¼š<code>createContext</code>ã€<code>useContext</code>ã€<code>useReducer</code></li>
</ul>
</li>
<li>
<p><strong>Ref + useImperativeHandle</strong></p>
<ul>
<li>é€‚ç”¨åœºæ™¯ï¼šçˆ¶ç»„ä»¶éœ€è¦ç›´æ¥æ“ä½œå­ç»„ä»¶ï¼ˆè°ƒç”¨æ–¹æ³• / è·å–æ•°æ®ï¼‰</li>
<li>ä¼˜åŠ¿ï¼šç›´æ¥è®¿é—®å­ç»„ä»¶å®ä¾‹ï¼Œé€‚åˆæ§åˆ¶å‹äº¤äº’</li>
<li>æ ¸å¿ƒ APIï¼š<code>useRef</code>ã€<code>forwardRef</code>ã€<code>useImperativeHandle</code></li>
</ul>
</li>
</ol>
<p>é€šè¿‡æœ¬æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å®Œæ•´å®ç°äº†ä»ç®€å•åˆ°å¤æ‚çš„ç»„ä»¶é€šè®¯åœºæ™¯ï¼ŒæŒæ¡è¿™äº›é’©å­çš„ä½¿ç”¨æ–¹å¼å¯ä»¥æœ‰æ•ˆè§£å†³ React åº”ç”¨ä¸­çš„æ•°æ®ä¼ é€’é—®é¢˜ã€‚å®é™…å¼€å‘ä¸­ï¼Œåº”æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„é€šè®¯æ–¹å¼ï¼Œä»¥æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§</p>
<p>å›¾ä¾‹</p>
<p>Â Â Â Â Â Â Â Â <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fa90e6c895148a09310d22ece2c3b84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGN5NDUz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356193&amp;x-signature=9ImR%2BS%2BoNGpXEKEaHHlOd8e96YQ%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kubernetesä¸­å¯¹Pod è¿›è¡Œ å¥åº·æ£€æŸ¥çš„åŠ¨æ‰‹å®éªŒï¼Œä½¿ç”¨mysqlé•œåƒ]]></title>    <link>https://juejin.cn/post/7578732288516194355</link>    <guid>https://juejin.cn/post/7578732288516194355</guid>    <pubDate>2025-12-02T01:24:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578732288516194355" data-draft-id="7578714735308472346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kubernetesä¸­å¯¹Pod è¿›è¡Œ å¥åº·æ£€æŸ¥çš„åŠ¨æ‰‹å®éªŒï¼Œä½¿ç”¨mysqlé•œåƒ"/> <meta itemprop="keywords" content="Kubernetes"/> <meta itemprop="datePublished" content="2025-12-02T01:24:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kubernetesä¸­å¯¹Pod è¿›è¡Œ å¥åº·æ£€æŸ¥çš„åŠ¨æ‰‹å®éªŒï¼Œä½¿ç”¨mysqlé•œåƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:24:27.000Z" title="Tue Dec 02 2025 01:24:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“ç„¶å¯ä»¥ï¼ä¸‹é¢æ˜¯ä¸€ä¸ª <strong>ä½¿ç”¨ MySQL å®˜æ–¹é•œåƒ</strong> çš„ Kubernetes Pod å¥åº·æ£€æŸ¥ï¼ˆHealth Checkï¼‰åŠ¨æ‰‹å®éªŒã€‚æˆ‘ä»¬å°†é…ç½® <strong>Liveness Probe</strong>ï¼ˆå­˜æ´»æ¢é’ˆï¼‰å’Œ <strong>Readiness Probe</strong>ï¼ˆå°±ç»ªæ¢é’ˆï¼‰ï¼Œå¹¶é€šè¿‡æ¨¡æ‹Ÿæ•…éšœè§‚å¯Ÿ Kubernetes å¦‚ä½•è‡ªåŠ¨å¤„ç†å¼‚å¸¸ã€‚</p>
<blockquote>
<p>âœ… æœ¬å®éªŒå®Œå…¨åŸºäº <strong>MySQL é•œåƒ</strong>ï¼Œæ— éœ€é¢å¤–ä¾èµ–ï¼Œé€‚åˆä½ çš„ç¦»çº¿æˆ–å†…ç½‘ç¯å¢ƒã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ¯ å®éªŒç›®æ ‡</h2>
<ol>
<li>ä¸º MySQL Pod é…ç½® <strong>Readiness Probe</strong>ï¼šç¡®ä¿ MySQL å®Œå…¨å¯åŠ¨åæ‰æ¥æ”¶æµé‡</li>
<li>ä¸º MySQL Pod é…ç½® <strong>Liveness Probe</strong>ï¼šå½“ MySQL è¿›ç¨‹å¡æ­»æ—¶è‡ªåŠ¨é‡å¯å®¹å™¨</li>
<li>è§‚å¯Ÿæ¢é’ˆå¤±è´¥æ—¶çš„è¡Œä¸ºå·®å¼‚</li>
</ol>
<hr/>
<h2 data-id="heading-1">ğŸ”§ å‰ææ¡ä»¶</h2>
<ul>
<li>å·²åœ¨èŠ‚ç‚¹ä¸ŠåŠ è½½ <code>mysql:latest</code> é•œåƒï¼ˆé€šè¿‡ <code>ctr import</code> æˆ–æå‰æ‹‰å–ï¼‰</li>
<li>ä½¿ç”¨ <code>imagePullPolicy: Never</code> é¿å…æ‹‰å–</li>
<li>å•å‰¯æœ¬ï¼ˆ<code>replicas: 1</code>ï¼‰ï¼Œå› ä¸ºå¤šå‰¯æœ¬ MySQL æ— ä¸»ä»ä¼šå†²çª</li>
</ul>
<hr/>
<h2 data-id="heading-2">ğŸ“„ å®éªŒ YAMLï¼šå¸¦å¥åº·æ£€æŸ¥çš„ MySQL Deployment</h2>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># mysql-health-check.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">mysql-health-check</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">mysql-health-check</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">mysql-health-check</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mysql</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">docker.io/library/mysql:latest</span>
        <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">Never</span>
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">3306</span>

        <span class="hljs-comment"># å¿…éœ€çš„ç¯å¢ƒå˜é‡</span>
        <span class="hljs-attr">env:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">MYSQL_ROOT_PASSWORD</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">"MyPass123!"</span>

        <span class="hljs-comment"># æŒ‚è½½æ•°æ®ç›®å½•ï¼ˆé¿å…é‡å¯ä¸¢æ•°æ®ï¼‰</span>
        <span class="hljs-attr">volumeMounts:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mysql-data</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/var/lib/mysql</span>

        <span class="hljs-comment"># =============== Readiness Probeï¼ˆå°±ç»ªæ¢é’ˆï¼‰===============</span>
        <span class="hljs-comment"># ä½¿ç”¨ mysqladmin ping æ£€æŸ¥æ˜¯å¦å¯å“åº”</span>
        <span class="hljs-attr">readinessProbe:</span>
          <span class="hljs-attr">exec:</span>
            <span class="hljs-attr">command:</span> [<span class="hljs-string">"mysqladmin"</span>, <span class="hljs-string">"ping"</span>, <span class="hljs-string">"-uroot"</span>, <span class="hljs-string">"-pMyPass123!"</span>]
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">15</span>   <span class="hljs-comment"># MySQL å¯åŠ¨è¾ƒæ…¢</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span>
          <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">5</span>
          <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>

        <span class="hljs-comment"># =============== Liveness Probeï¼ˆå­˜æ´»æ¢é’ˆï¼‰===============</span>
        <span class="hljs-attr">livenessProbe:</span>
          <span class="hljs-attr">exec:</span>
            <span class="hljs-attr">command:</span> [<span class="hljs-string">"mysqladmin"</span>, <span class="hljs-string">"ping"</span>, <span class="hljs-string">"-uroot"</span>, <span class="hljs-string">"-pMyPass123!"</span>]
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">30</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">20</span>
          <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">5</span>
          <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>

      <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mysql-data</span>
        <span class="hljs-attr">emptyDir:</span> {}  <span class="hljs-comment"># æµ‹è¯•ç”¨ï¼›ç”Ÿäº§è¯·ç”¨ PVC</span>

      <span class="hljs-attr">tolerations:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">node-role.kubernetes.io/master</span>
        <span class="hljs-attr">operator:</span> <span class="hljs-string">Exists</span>
        <span class="hljs-attr">effect:</span> <span class="hljs-string">NoSchedule</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment"># åˆ›å»º Service ä¾›å¤–éƒ¨è¿æ¥ï¼ˆå¯é€‰ï¼‰</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">mysql-svc</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">mysql-health-check</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">3306</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">3306</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ è¯´æ˜ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>mysqladmin ping</code> æ˜¯å®˜æ–¹æ¨èçš„å¥åº·æ£€æŸ¥æ–¹å¼</li>
<li><code>-pMyPass123!</code> ä¸­<strong>ä¸èƒ½æœ‰ç©ºæ ¼</strong>ï¼ˆå¦åˆ™å‘½ä»¤è§£æå¤±è´¥ï¼‰</li>
<li><code>initialDelaySeconds</code> è¦è¶³å¤Ÿé•¿ï¼ˆMySQL å†·å¯åŠ¨å¯èƒ½éœ€ 20+ ç§’ï¼‰</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ§ª å®éªŒæ­¥éª¤</h2>
<h3 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² MySQL</h3>
<pre><code class="hljs">kubectl apply -f mysql-health-check.yaml
</code></pre>
<h3 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šè§‚å¯Ÿå¯åŠ¨è¿‡ç¨‹</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æŸ¥çœ‹ Pod çŠ¶æ€ï¼ˆREADY åˆ—ä¼šä» 0/1 â†’ 1/1ï¼‰</span>
kubectl get pods -w -l <span class="hljs-attr">app</span>=mysql-health-check
</code></pre>
<p>ç­‰å¾…çº¦ 30 ç§’ï¼Œç›´åˆ°ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">NAME                                   READY   STATUS    RESTARTS   AGE
mysql<span class="hljs-operator">-</span>health<span class="hljs-operator">-</span><span class="hljs-keyword">check</span><span class="hljs-number">-7</span>d8b9c4b5d<span class="hljs-operator">-</span>abc12   <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>     <span class="hljs-keyword">Running</span>   <span class="hljs-number">0</span>          <span class="hljs-number">45</span>s
</code></pre>
<blockquote>
<p>âœ… <code>READY=1/1</code> è¡¨ç¤º <strong>Readiness Probe æˆåŠŸ</strong></p>
</blockquote>
<h3 data-id="heading-6">ç¬¬ä¸‰æ­¥ï¼šéªŒè¯å¥åº·æ£€æŸ¥æ­£å¸¸å·¥ä½œ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æŸ¥çœ‹è¯¦ç»†äº‹ä»¶</span>
kubectl describe pod -l <span class="hljs-attr">app</span>=mysql-health-check
</code></pre>
<p>åœ¨ <strong>Events</strong> éƒ¨åˆ†åº”çœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">Successfully assigned ...
Created container mysql
Started container mysql
</code></pre>
<p><strong>æ²¡æœ‰</strong> <code>Readiness probe failed</code> æˆ– <code>Liveness probe failed</code> é”™è¯¯ã€‚</p>
<hr/>
<h2 data-id="heading-7">ğŸ”¥ å®éªŒ Part Aï¼šæ¨¡æ‹Ÿâ€œæœªå°±ç»ªâ€çŠ¶æ€ï¼ˆæµ‹è¯• Readiness Probeï¼‰</h2>
<blockquote>
<p>æˆ‘ä»¬æ— æ³•ç›´æ¥ä¿®æ”¹ MySQL å¯†ç æ¥ç ´åæ¢é’ˆï¼ˆä¼šæ°¸ä¹…é”æ­»ï¼‰ï¼Œä½†å¯ä»¥é€šè¿‡ <strong>ä¸´æ—¶åˆ é™¤ readinessProbe</strong> æ¥è§‚å¯Ÿåå‘æ•ˆæœâ€”â€”æ›´å®‰å…¨çš„æ–¹å¼æ˜¯ <strong>è§‚å¯Ÿå¯åŠ¨é˜¶æ®µ</strong>ã€‚</p>
</blockquote>
<p>ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥<strong>æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡â€œæ…¢å¯åŠ¨â€åœºæ™¯</strong>ï¼š</p>
<ol>
<li>
<p>åˆ é™¤å½“å‰ Podï¼ˆDeployment ä¼šé‡å»ºï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">kubectl delete pod -l <span class="hljs-attr">app</span>=mysql-health-check
</code></pre>
</li>
<li>
<p>ç«‹å³ watch çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">kubectl get pods -w
</code></pre>
<p>ä½ ä¼šçœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">0</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   Pending   <span class="hljs-number">0</span>   <span class="hljs-number">0</span>s
mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">0</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   ContainerCreating   <span class="hljs-number">0</span>   <span class="hljs-number">2</span>s
mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">0</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   <span class="hljs-keyword">Running</span>   <span class="hljs-number">0</span>   <span class="hljs-number">10</span>s   â† å·² <span class="hljs-keyword">Running</span>ï¼Œä½† READY<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>ï¼
mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   <span class="hljs-keyword">Running</span>   <span class="hljs-number">0</span>   <span class="hljs-number">25</span>s   â† Readiness æˆåŠŸï¼Œå˜ä¸º <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>
</code></pre>
</li>
</ol>
<p>âœ… <strong>ç»“è®º</strong>ï¼šåœ¨ <code>initialDelaySeconds</code> æœŸé—´å’Œæ¢é’ˆæˆåŠŸå‰ï¼ŒPod <strong>ä¸ä¼šè¢« Service åŠ å…¥ Endpoints</strong>ï¼Œå³ä½¿å®¹å™¨å·²è¿è¡Œï¼</p>
<hr/>
<h2 data-id="heading-8">ğŸ’¥ å®éªŒ Part Bï¼šæ¨¡æ‹Ÿâ€œè¿›ç¨‹å¡æ­»â€ï¼ˆæµ‹è¯• Liveness Probeï¼‰</h2>
<blockquote>
<p>æˆ‘ä»¬å°†è¿›å…¥å®¹å™¨ï¼Œ<strong>æ‰‹åŠ¨æ€æ­» MySQL è¿›ç¨‹</strong>ï¼Œè§‚å¯Ÿ Liveness æ˜¯å¦è§¦å‘é‡å¯ã€‚</p>
</blockquote>
<h4 data-id="heading-9">æ­¥éª¤ï¼š</h4>
<ol>
<li>
<p><strong>è¿›å…¥ MySQL å®¹å™¨</strong></p>
<pre><code class="hljs language-sql" lang="sql">POD_NAME<span class="hljs-operator">=</span>$(kubectl <span class="hljs-keyword">get</span> pod <span class="hljs-operator">-</span>l app<span class="hljs-operator">=</span>mysql<span class="hljs-operator">-</span>health<span class="hljs-operator">-</span><span class="hljs-keyword">check</span> <span class="hljs-operator">-</span>o jsonpath<span class="hljs-operator">=</span><span class="hljs-string">'{.items[0].metadata.name}'</span>)
kubectl <span class="hljs-keyword">exec</span> <span class="hljs-operator">-</span>it $POD_NAME <span class="hljs-comment">-- sh</span>
</code></pre>
</li>
<li>
<p><strong>åœ¨å®¹å™¨å†…æ€æ­» mysqld è¿›ç¨‹</strong></p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æŸ¥æ‰¾ mysqld PID</span>
ps aux | <span class="hljs-keyword">grep</span> mysqld

<span class="hljs-comment"># å‡è®¾ PID æ˜¯ 1ï¼ˆé€šå¸¸ä¸»è¿›ç¨‹æ˜¯ 1ï¼‰</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> <span class="hljs-number">1</span>
</code></pre>
</li>
<li>
<p><strong>é€€å‡ºå®¹å™¨ï¼Œè§‚å¯Ÿ Pod çŠ¶æ€</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">kubectl get pods -w
</code></pre>
<p>ä½ ä¼šçœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   <span class="hljs-keyword">Running</span>   <span class="hljs-number">0</span>   <span class="hljs-number">2</span>m
mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">0</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   <span class="hljs-keyword">Running</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>m30s   â† RESTARTS å˜æˆ <span class="hljs-number">1</span>ï¼
mysql<span class="hljs-operator">-</span>...   <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span>   <span class="hljs-keyword">Running</span>   <span class="hljs-number">1</span>   <span class="hljs-number">3</span>m      â† é‡å¯å®Œæˆ
</code></pre>
</li>
<li>
<p><strong>æŸ¥çœ‹äº‹ä»¶ç¡®è®¤æ˜¯ Liveness å¯¼è‡´é‡å¯</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl describe pod <span class="hljs-variable">$POD_NAME</span>
</code></pre>
<p>åœ¨ Events ä¸­åº”æœ‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Liveness probe failed: OCI runtime <span class="hljs-built_in">exec</span> failed: ...
(or) Liveness probe failed: mysqladmin: connect to server at <span class="hljs-string">'localhost'</span> failed
Killing container with <span class="hljs-built_in">id</span> containerd://mysql: Need to <span class="hljs-built_in">kill</span> Pod
</code></pre>
</li>
</ol>
<p>âœ… <strong>ç»“è®º</strong>ï¼šLiveness Probe å¤±è´¥åï¼ŒKubernetes <strong>è‡ªåŠ¨é‡å¯äº†å®¹å™¨</strong>ï¼Œå®ç°è‡ªæ„ˆï¼</p>
<hr/>
<h2 data-id="heading-10">ğŸ“Š å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“</h2>























<table><thead><tr><th>æ¢é’ˆç±»å‹</th><th>æ£€æŸ¥å‘½ä»¤</th><th>ä½œç”¨</th><th>å¤±è´¥åæœ</th></tr></thead><tbody><tr><td><strong>Readiness</strong></td><td><code>mysqladmin ping</code></td><td>åˆ¤æ–­ MySQL æ˜¯å¦å¯æœåŠ¡</td><td>ä» Service Endpoints å‰”é™¤ï¼ˆä¸æ¥æ”¶æ–°æµé‡ï¼‰</td></tr><tr><td><strong>Liveness</strong></td><td><code>mysqladmin ping</code></td><td>åˆ¤æ–­ MySQL æ˜¯å¦å­˜æ´»</td><td>é‡å¯æ•´ä¸ªå®¹å™¨</td></tr></tbody></table>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<code>mysqladmin ping</code> ä¾èµ–æ­£ç¡®å¯†ç ï¼Œ<strong>å¿…é¡»ä¸ <code>MYSQL_ROOT_PASSWORD</code> ä¸€è‡´</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ğŸ›¡ï¸ ç”Ÿäº§å»ºè®®</h2>
<ol>
<li>
<p><strong>å¯†ç ä¸è¦æ˜æ–‡å†™ YAML</strong> â†’ æ”¹ç”¨ Secret</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">env:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">MYSQL_ROOT_PASSWORD</span>
  <span class="hljs-attr">valueFrom:</span>
    <span class="hljs-attr">secretKeyRef:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">mysql-secret</span>
      <span class="hljs-attr">key:</span> <span class="hljs-string">password</span>
<span class="hljs-attr">readinessProbe:</span>
  <span class="hljs-attr">exec:</span>
    <span class="hljs-attr">command:</span> [<span class="hljs-string">"sh"</span>, <span class="hljs-string">"-c"</span>, <span class="hljs-string">"mysqladmin ping -uroot -p$(MYSQL_ROOT_PASSWORD)"</span>]
</code></pre>
</li>
<li>
<p><strong>æ•°æ®æŒä¹…åŒ–</strong> â†’ å°† <code>emptyDir</code> æ›¿æ¢ä¸º PVC</p>
</li>
<li>
<p><strong>è°ƒæ•´è¶…æ—¶å‚æ•°</strong> â†’ æ ¹æ®å®é™…æ€§èƒ½è°ƒæ•´ <code>initialDelaySeconds</code></p>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">âœ… æ¸…ç†å®éªŒ</h2>
<pre><code class="hljs language-arduino" lang="arduino">kubectl <span class="hljs-keyword">delete</span> -f mysql-health-check.yaml
</code></pre>
<hr/>
<p>ç°åœ¨ä½ å°±æŒæ¡äº† <strong>å¦‚ä½•ä¸ºæœ‰çŠ¶æ€æ•°æ®åº“ï¼ˆå¦‚ MySQLï¼‰é…ç½® Kubernetes å¥åº·æ£€æŸ¥</strong>ï¼è¿™ä¸ä»…èƒ½æå‡ç³»ç»Ÿç¨³å®šæ€§ï¼Œè¿˜èƒ½é¿å…æµé‡æ‰“åˆ°â€œå‡æ­»â€å®ä¾‹ã€‚</p>
<p>éœ€è¦æˆ‘å¸®ä½ ç”Ÿæˆ <strong>å¸¦ Secret + PVC çš„ç”Ÿäº§çº§ç‰ˆæœ¬</strong> å—ï¼Ÿæˆ–è€…æƒ³è¯•è¯• <strong>PostgreSQL / Redis çš„å¥åº·æ£€æŸ¥</strong>ï¼Ÿæ¬¢è¿ç»§ç»­æé—®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Git åŸºç¡€ï¼šç”Ÿæˆç‰ˆæœ¬ã€æ’¤æ¶ˆæ“ä½œã€ç‰ˆæœ¬é‡ç½®ã€å¿½ç•¥æ–‡ä»¶]]></title>    <link>https://juejin.cn/post/7579298511071920128</link>    <guid>https://juejin.cn/post/7579298511071920128</guid>    <pubDate>2025-12-03T08:51:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579298511071920128" data-draft-id="7579298511071543296" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Git åŸºç¡€ï¼šç”Ÿæˆç‰ˆæœ¬ã€æ’¤æ¶ˆæ“ä½œã€ç‰ˆæœ¬é‡ç½®ã€å¿½ç•¥æ–‡ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯,Git,GitHub"/> <meta itemprop="datePublished" content="2025-12-03T08:51:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Crystal328"/> <meta itemprop="url" content="https://juejin.cn/user/2359973194513272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Git åŸºç¡€ï¼šç”Ÿæˆç‰ˆæœ¬ã€æ’¤æ¶ˆæ“ä½œã€ç‰ˆæœ¬é‡ç½®ã€å¿½ç•¥æ–‡ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2359973194513272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Crystal328
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:51:49.000Z" title="Wed Dec 03 2025 08:51:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. Git çš„å®‰è£…</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2F" target="_blank" title="https://git-scm.com/" ref="nofollow noopener noreferrer">git-scm.com</a></p>
<h2 data-id="heading-1">2. åˆæ¬¡è¿è¡ŒGitå‰çš„é…ç½®</h2>
<pre><code class="hljs language-csharp" lang="csharp">git config --<span class="hljs-keyword">global</span> user.name <span class="hljs-string">'your name'</span>   <span class="hljs-meta"># å…¨å±€é…ç½®ç”¨æˆ·å</span>
git config --<span class="hljs-keyword">global</span> user.email <span class="hljs-string">'your email'</span> <span class="hljs-meta"># å…¨å±€é…ç½®ç”¨æˆ·é‚®ç®±</span>
</code></pre>
<h2 data-id="heading-2">3. ç³»ç»Ÿé€šç”¨é…ç½®</h2>
<p>åœ¨<code>Git</code>å®‰è£…ç›®å½•ä¸‹çš„<code>/etc/gitconfig</code>æ–‡ä»¶ä¸­ï¼ŒåŒ…äº†å«ç³»ç»Ÿä¸Šæ¯ä¸€ä¸ªç”¨æˆ·åŠä»–ä»¬ä»“åº“çš„é€šç”¨é…ç½®ã€‚<br/>
åœ¨æ‰§è¡ŒÂ <code>git config</code>Â æ—¶å¸¦ä¸ŠÂ <code>--system</code>Â é€‰é¡¹ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¯»å†™è¯¥æ–‡ä»¶ä¸­çš„é…ç½®å˜é‡<br/>
Git å®‰è£…ç›®å½•ï¼Œå¯ä»¥æ‰§è¡Œ<code>where git</code>æ¥æ‰¾åˆ°</p>
<h2 data-id="heading-3">4. åˆå§‹åŒ–Gitæœ¬åœ°ä»“åº“</h2>
<pre><code class="hljs language-csharp" lang="csharp">git <span class="hljs-keyword">init</span> <span class="hljs-meta"># åˆå§‹åŒ–Gitæœ¬åœ°ä»“åº“</span>
</code></pre>
<h2 data-id="heading-4">5. Gitä¸‰å¤§åŒºåŸŸ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/333fbb44122f4cfbad2b945fc9d19112~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ3J5c3RhbDMyOA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356850&amp;x-signature=iIoolHLxm3BDWex%2FdVU3byg5oVA%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">6. å¦‚ä½•ç”Ÿæˆé¡¹ç›®ç‰ˆæœ¬</h2>
<ul>
<li><code>git status</code>Â ç”¨æ¥æŸ¥çœ‹é¡¹ç›®æ–‡ä»¶çŠ¶æ€</li>
<li><code>git add</code>Â å‘½ä»¤ï¼Œç”¨æ¥å°†å·¥ä½œåŒºä»£ç çš„å˜åŠ¨ï¼Œæäº¤åˆ°æš‚å­˜åŒº</li>
</ul>
<pre><code class="hljs language-git" lang="git">git add &lt;file&gt; &lt;file&gt;  # æäº¤æŒ‡å®šçš„æ–‡ä»¶åˆ°æš‚å­˜åŒº
git add . # å°†å·¥ä½œåŒºæ‰€æœ‰å˜åŠ¨æäº¤åˆ°æš‚å­˜åŒº
</code></pre>
<ul>
<li><code>git commit</code>Â å‘½ä»¤ï¼Œç”¨æ¥å°†æš‚å­˜åŒºçš„å†…å®¹æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œ<code>git commit</code>Â åæš‚å­˜åŒºå’Œæœ¬åœ°ç‰ˆæœ¬åº“çš„å†…å®¹æ˜¯ä¸€è‡´çš„</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">git commit   <span class="hljs-comment"># æäº¤ï¼Œæœ€ç»ˆåœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥æäº¤çš„æè¿°</span>
git commit -m <span class="hljs-string">'æäº¤æè¿°'</span>  <span class="hljs-comment"># åœ¨æäº¤çš„åŒæ—¶ï¼Œæ·»åŠ æœ¬æ¬¡æäº¤æè¿°</span>
</code></pre>
<ul>
<li><code>git log</code>Â æŸ¥çœ‹æäº¤å†å²è®°å½•</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">log</span>   <span class="hljs-comment"># æ‰“å°è¯¦ç»†çš„æäº¤å†å²è®°å½•</span>
git <span class="hljs-built_in">log</span> --oneline <span class="hljs-comment"># ä»¥åˆ—è¡¨å½¢å¼ï¼Œæ‰“å°æäº¤çš„å†å²è®°å½•ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
</code></pre>
<h3 data-id="heading-6">6.1ã€æ–‡ä»¶çš„ä¸‰ç§çŠ¶æ€</h3>
<p>è¢« Git ç®¡ç†çš„é¡¹ç›®ï¼Œé¡¹ç›®æ–‡ä»¶å¯èƒ½å¤„äºä»¥ä¸‹ 3 ç§çŠ¶æ€ä¹‹ä¸€</p>
<ul>
<li><strong>å·²ä¿®æ”¹ï¼ˆmodifiedï¼‰</strong> ï¼šè¡¨ç¤ºä¸Šæ¬¡æäº¤åï¼Œé‡æ–°ä¿®æ”¹äº†çš„æ–‡ä»¶ï¼Œä½†è¿˜æ²¡æäº¤åˆ°æš‚å­˜åŒº</li>
<li><strong>å·²æš‚å­˜ï¼ˆstagedï¼‰</strong> ï¼šè¡¨ç¤ºå¯¹ä¸€ä¸ªå·²ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°äº†æš‚å­˜åŒºï¼Œä½†è¿˜æ²¡æœ‰æäº¤</li>
<li><strong>å·²æäº¤ï¼ˆcommittedï¼‰</strong> ï¼šè¡¨ç¤ºæ–‡ä»¶å·²æäº¤åˆ°æœ¬åœ°ä»“åº“</li>
</ul>
<h2 data-id="heading-7">7. æ’¤æ¶ˆæ“ä½œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2Fbook%2Fzh%2Fv2%2FGit-%25E5%259F%25BA%25E7%25A1%2580-%25E6%2592%25A4%25E6%25B6%2588%25E6%2593%258D%25E4%25BD%259C" target="_blank" title="https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C" ref="nofollow noopener noreferrer">Git å®˜æ–¹æ–‡æ¡£ - æ’¤æ¶ˆæ“ä½œ</a></h2>
<p>ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§åœºæ™¯ï¼š</p>
<ul>
<li>æ’¤æ¶ˆä¸Šä¸€æ¬¡æäº¤</li>
<li>æ’¤é”€æš‚å­˜çš„æ–‡ä»¶</li>
<li>æ’¤é”€æ’¤é”€ä»¶çš„ä¿®æ”¹</li>
</ul>
<h3 data-id="heading-8">7.1 æ’¤æ¶ˆä¸Šä¸€æ¬¡æäº¤</h3>
<h4 data-id="heading-9">7.1.1 æäº¤å®Œäº†æ‰å‘ç°æäº¤ä¿¡æ¯å†™é”™äº†</h4>
<pre><code class="hljs language-sql" lang="sql">git <span class="hljs-keyword">commit</span> <span class="hljs-comment">--amend   # æ’¤æ¶ˆä¸Šä¸€æ¬¡æäº¤</span>
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†æš‚å­˜åŒºä¸­çš„æ–‡ä»¶æäº¤ã€‚ å¦‚æœè‡ªä¸Šæ¬¡æäº¤ä»¥æ¥ä½ è¿˜æœªåšä»»ä½•ä¿®æ”¹ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸Šæ¬¡æäº¤åé©¬ä¸Šæ‰§è¡Œäº†æ­¤å‘½ä»¤ï¼‰ï¼Œ é‚£ä¹ˆå¿«ç…§ä¼šä¿æŒä¸å˜ï¼Œè€Œä½ <strong>æ‰€ä¿®æ”¹çš„åªæ˜¯æäº¤ä¿¡æ¯</strong>ã€‚</p>
<h4 data-id="heading-10">7.1.2 æäº¤åå‘ç°å¿˜è®°äº†æš‚å­˜æŸäº›éœ€è¦çš„ä¿®æ”¹</h4>
<ul>
<li>é‡æ–°æ‰§è¡Œ<code>git add</code>å‘½ä»¤å°†ä¿®æ”¹å†…å®¹æ·»åŠ åˆ°æš‚å­˜åŒº</li>
<li>ç„¶åå†é‡æ–°æäº¤ï¼Œä½†æäº¤æ—¶ä¸å¸Œæœ›ç”Ÿæˆæ–°çš„ç‰ˆæœ¬</li>
</ul>

<pre><code class="hljs language-sql" lang="sql">git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m <span class="hljs-string">'V1-ç½‘ç«™å¤´éƒ¨'</span>   # ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬V1  ç¬¬ä¸€æ¬¡é”™è¯¯æäº¤
git <span class="hljs-keyword">add</span> .   # å°†ä¿®æ”¹çš„å†…å®¹æäº¤åˆ°æš‚å­˜åŒº

#æäº¤ç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬V2ï¼Œè¯¥ç‰ˆæœ¬ä¼šæ›¿æ¢ä¹‹å‰çš„é‚£ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥æœ€ç»ˆç”¨ git log <span class="hljs-comment">--onelineåªèƒ½çœ‹åˆ°æœ€åä¸€æ¬¡ç”Ÿæˆçš„ç‰ˆæœ¬V2</span>
git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m <span class="hljs-string">'V1-ç½‘ç«™å¤´éƒ¨å¯¼èˆªå¼€å‘å®Œæˆ'</span> <span class="hljs-comment">--amend</span>
</code></pre>
<h3 data-id="heading-11">7.2  æ’¤é”€æš‚å­˜çš„æ–‡ä»¶</h3>
<p>å¦‚æœä¿®æ”¹äº†ä¸¤ä¸ªæ–‡ä»¶å¹¶ä¸”æƒ³è¦å°†å®ƒä»¬ä½œä¸º<strong>åˆ†å¼€ä¸¤æ¬¡ç‹¬ç«‹çš„ä¿®æ”¹æäº¤</strong>ï¼Œ ä½†æ˜¯å´æ„å¤–åœ°è¾“å…¥Â <code>git add *</code>Â æš‚å­˜äº†å®ƒä»¬ä¸¤ä¸ªã€‚</p>
<ul>
<li>ä½¿ç”¨Â <code>git restore --staged &lt;file&gt;â€¦</code>Â æ¥å–æ¶ˆæš‚å­˜ã€‚</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">git restore --staged login.html   <span class="hljs-comment"># å–æ¶ˆlogin.htmlæ–‡ä»¶çš„æš‚å­˜</span>

git restore --staged .  <span class="hljs-comment"># å–æ¶ˆæš‚å­˜åŒºæ‰€æœ‰æ–‡ä»¶çš„æš‚å­˜</span>
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ul>
<li><code>git restore --staged &lt;file&gt;</code>Â å‘½ä»¤åªä¼šå°†æ–‡ä»¶ä»æš‚å­˜åŒºç§»åŠ¨åˆ°å·¥ä½œå¹¶ä¸”å¹¶ä¼šä¸ä¼šå½±å“å·¥ä½œåŒºè¯¥æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>æ¯”å¦‚æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒºæ—¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š<code>'a'</code>ï¼Œåé¢å°†æ–‡ä»¶å†…å®¹ä¿®æ”¹ä¸º-<code>'ab'</code>ï¼Œç„¶åæ‰§è¡Œ<code>git restore --staged &lt;file&gt;</code>å°†æ–‡ä»¶ä»æš‚å­˜åŒºç§»é™¤ï¼Œæ­¤æ—¶å·¥ä½œåŒºè¯¥æ–‡ä»¶å†…å®¹ä»ä¸º<code>'ab'</code>ï¼Œå¹¶ä¸ä¼šè¢«ä¿®æ”¹ä¸ºÂ <code>'a'</code></li>
</ul>
</blockquote>
<h3 data-id="heading-12">7.3 å–æ¶ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹</h3>
<p>å¦‚æœä½ åœ¨ä¸Šä¸€æ¬¡<code>git add</code>å ï¼Œå¯¹æ–‡ä»¶<code>login.html</code>å†…å®¹åšäº†ä¿®æ”¹ï¼Œä½†ç°åœ¨ä½ æƒ³å»æ‰è¿™äº›ä¿®æ”¹ï¼Œå›åˆ°ä¸Šä¸€æ¬¡<code>git add</code>æ—¶çš„æ ·å¼ã€‚é‚£ä½ å°±éœ€è¦æ’¤é”€å¯¹<code>login.html</code>å†…å®¹çš„ä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">git restore .  <span class="hljs-comment"># æ’¤æ¶ˆå¯¹å·¥ä½œå·¥æ‰€æœ‰æ–‡ä»¶çš„ä¿®æ”¹</span>
</code></pre>
<h2 data-id="heading-13">8. ç‰ˆæœ¬é‡ç½®</h2>
<p>Git ç‰ˆæœ¬é‡ç½®åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µ</p>
<ul>
<li>åªé‡ç½®æœ¬åœ°ä»“åº“</li>
<li>é‡ç½®æœ¬åœ°ä»“åº“å’Œæš‚å­˜åŒº</li>
<li>é‡ç½®æœ¬åœ°ä»“åº“ã€æš‚å­˜åŒºå’Œå·¥ä½œåŒº</li>
</ul>
<h3 data-id="heading-14">8.1 é‡ç½®æœ¬åœ°ä»“åº“ ï¼ˆ--softï¼‰</h3>
<pre><code class="hljs language-perl" lang="perl">git <span class="hljs-keyword">reset</span> --soft ç‰ˆæœ¬å·    <span class="hljs-comment"># é‡ç½®æœ¬åœ°ä»“åº“</span>
</code></pre>
<h3 data-id="heading-15">8.2 é‡ç½®æœ¬åœ°ä»“åº“ä¸æš‚å­˜åŒº ï¼ˆ--mixedï¼‰</h3>
<pre><code class="hljs language-perl" lang="perl">git <span class="hljs-keyword">reset</span> --mixed ç‰ˆæœ¬å·   <span class="hljs-comment"># é‡ç½®æœ¬åœ°ä»“åº“å’Œæš‚å­˜åŒº</span>
git <span class="hljs-keyword">reset</span> ç‰ˆæœ¬å·  <span class="hljs-comment"># é‡ç½®æœ¬åœ°ä»“åº“å’Œæš‚å­˜åŒºï¼Œé»˜è®¤è¡Œä¸º</span>
</code></pre>
<h3 data-id="heading-16">8.3 é‡ç½®æœ¬åœ°åº“ã€æš‚å­˜åŒºã€å·¥ä½œåŒºï¼ˆ--hardï¼‰</h3>
<blockquote>
<p>æ³¨æ„ï¼š<br/>
<code>--hard</code>Â ä¼šé‡ç½®å·¥ä½œåŒºå†…å®¹ï¼Œæ‰€ä»¥åœ¨é‡ç½®å‰å¦‚æœå·¥ä½œåŒºå†…å®¹æœ‰æ²¡æœ‰æäº¤çš„ï¼Œé‡ç½®ååˆ™ä¼šé€ æˆå†…å®¹ä¸¢å¤±ã€‚å†…å®¹ä¸€æ—¦ä¸¢å¤±ï¼Œæ˜¯æ²¡æœ‰åŠæ³•æ‰¾å›çš„ã€‚<br/>
<strong>æ‰€ä»¥ä½¿ç”¨--hard å‘½ä»¤æ—¶ï¼Œè¦ç‰¹åˆ«å°å¿ƒã€‚</strong></p>
</blockquote>
<pre><code class="hljs language-css" lang="css">git reset <span class="hljs-attr">--hard</span> ç‰ˆæœ¬å·
</code></pre>
<h3 data-id="heading-17">8.4 git reflog å‘½ä»¤</h3>
<p><code>git reflog</code>å‘½ä»¤ï¼Œæ˜¯å¯ä»¥æŸ¥çœ‹åˆ°æ‰€æœ‰çš„ç‰ˆæœ¬å†å²è®°å½•ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä¹‹å‰è®¤ä¸ºè¢« â€œä¸¢å¼ƒâ€ çš„ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-18">9.Â Git å¿½ç•¥æ–‡ä»¶(.gitignore æ–‡ä»¶)</h2>
<blockquote>
<p>æ–‡ä»¶<code>.gitignore</code>çš„æ ¼å¼è§„èŒƒå¦‚ä¸‹ï¼š</p>
</blockquote>
<ul>
<li>æ‰€æœ‰ç©ºè¡Œæˆ–è€…ä»¥Â <code>#</code>Â å¼€å¤´çš„è¡Œéƒ½ä¼šè¢« Git å¿½ç•¥ã€‚ #ä¸º<code>.gitignore</code>æ–‡ä»¶çš„æ³¨é‡Š</li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ³¨é‡Š</span>
</code></pre>
<ul>
<li>å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ glob æ¨¡å¼åŒ¹é…ï¼Œå®ƒä¼šé€’å½’åœ°åº”ç”¨åœ¨æ•´ä¸ªå·¥ä½œåŒºä¸­ã€‚ <i>æ³¨ï¼šæ‰€è°“çš„ glob æ¨¡å¼æ˜¯æŒ‡ shell æ‰€ä½¿ç”¨çš„ç®€åŒ–äº†çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</i></li>
</ul>
<blockquote>
<ul>
<li>æ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼›</li>
<li><code>[abc]</code>Â åŒ¹é…ä»»ä½•ä¸€ä¸ªåˆ—åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ ï¼ˆè¿™ä¸ªä¾‹å­è¦ä¹ˆåŒ¹é…ä¸€ä¸ª aï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª bï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª cï¼‰ï¼›</li>
<li>é—®å·ï¼ˆ<code>?</code>ï¼‰åªåŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼›</li>
<li>å¦‚æœåœ¨æ–¹æ‹¬å·ä¸­ä½¿ç”¨çŸ­åˆ’çº¿åˆ†éš”ä¸¤ä¸ªå­—ç¬¦ï¼Œ è¡¨ç¤ºæ‰€æœ‰åœ¨è¿™ä¸¤ä¸ªå­—ç¬¦èŒƒå›´å†…çš„éƒ½å¯ä»¥åŒ¹é…ï¼ˆæ¯”å¦‚Â <code>[0-9]</code>Â è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ 0 åˆ° 9 çš„æ•°å­—ï¼‰ã€‚</li>
<li>ä½¿ç”¨ä¸¤ä¸ªæ˜Ÿå·<code>**</code>Â è¡¨ç¤ºåŒ¹é…ä»»æ„ä¸­é—´ç›®å½•ï¼Œæ¯”å¦‚Â <code>a/**/z</code>Â å¯ä»¥åŒ¹é…Â <code>a/z</code>Â ã€Â <code>a/b/z</code>Â æˆ–Â <code>a/b/c/z</code>Â ç­‰ã€‚</li>
</ul>
</blockquote>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å¿½ç•¥æ‰€æœ‰ä»¥text.å¼€å¤´çš„æ–‡ä»¶ï¼Œä¸éœ€Gitç®¡ç†</span>
text.*
<span class="hljs-meta prompt_"># </span><span class="bash">Git å¿½ç•¥æ‰€æœ‰ä»¥ .o æˆ– .a ç»“å°¾çš„æ–‡ä»¶</span>
*.[oa]
<span class="hljs-meta prompt_"># </span><span class="bash">Gitå¿½ç•¥ä»¥ a.tmp æˆ–b.tmpç­‰ .tmpå‰é¢åªæœ‰ä¸€ä¸ªå­—ç¬¦çš„tmpæ–‡ä»¶</span>
?.tmp
<span class="hljs-meta prompt_"># </span><span class="bash">åªå¿½ç•¥ docçš„ç›´æ¥å­ç›®å½•ä¸‹çš„ä»»æ„pdfæ–‡ä»¶ï¼Œæ¯”å¦‚ï¼šdoc/a.b.pdfï¼Œä½†ä¸èƒ½å¿½ç•¥doc/a/b/c.pdf</span>
doc/*/*.pdf
<span class="hljs-meta prompt_"># </span><span class="bash">å¿½ç•¥ doc/ ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸‹çš„ .pdf æ–‡ä»¶   å¦‚ doc/a/b.pdf  doc/a/b/c.pdf</span>
doc/**/*.pdf
</code></pre>
<ul>
<li>åŒ¹é…æ¨¡å¼å¯ä»¥ä»¥ï¼ˆ<code>/</code>ï¼‰å¼€å¤´é˜²æ­¢é€’å½’ã€‚</li>
</ul>

<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">åªå¿½ç•¥å½“å‰ç›®å½•ä¸‹çš„ demo.txt æ–‡ä»¶ï¼Œè€Œä¸å¿½ç•¥ <span class="hljs-keyword">case</span>/demo.txt</span>
/demo.txt
<span class="hljs-meta prompt_">
# </span><span class="bash">å¿½ç•¥å½“å‰é¡¹ç›®ä¸­æ‰€æœ‰ demo.txtæ–‡ä»¶</span>
demo.txt
</code></pre>
<ul>
<li>åŒ¹é…æ¨¡å¼å¯ä»¥ä»¥ï¼ˆ<code>/</code>ï¼‰ç»“å°¾æŒ‡å®šç›®å½•ã€‚</li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¿½ç•¥ ä»»ä½•ç›®å½•ä¸‹åä¸º node_modulesç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ ï¼ˆgitç®¡ç†çš„æ˜¯æ–‡ä»¶ä¸æ˜¯ç›®å½•ï¼Œæ‰€ä»¥è¯¥æ–‡ä»¶ä¸‹è¦æœ‰å†…å®¹ï¼Œå¦åˆ™ä¼šè‡ªåŠ¨å¿½ç•¥ï¼‰</span>
node_modules/
</code></pre>
<ul>
<li>è¦å¿½ç•¥æŒ‡å®šæ¨¡å¼ä»¥å¤–çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸Šå¹å·ï¼ˆ<code>!</code>ï¼‰å–åã€‚</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino">test.*   # å¿½ç•¥æ‰€æœ‰ä»¥text.å¼€å¤´çš„æ–‡ä»¶ï¼Œä¸éœ€Gitç®¡ç†

!text.html  # ä¸å¿½ç•¥text.htmlæ–‡ä»¶ï¼Œè®©Gitç®¡ç†
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7579264485258985487</link>    <guid>https://juejin.cn/post/7579264485258985487</guid>    <pubDate>2025-12-03T08:54:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579264485258985487" data-draft-id="7579264485258952719" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-03T08:54:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Huangå…„"/> <meta itemprop="url" content="https://juejin.cn/user/52404619842712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52404619842712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Huangå…„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:54:14.000Z" title="Wed Dec 03 2025 08:54:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä»Šå¤©æˆ‘ä»¬æ¥æ‹†è§£å¤åˆ»ä¸€ä¸‹<code>HMOSä»£ç å·¥åŠ</code>ä¸­çš„<strong>ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœ</strong>ã€‚<br/>
å½“ç„¶è¿™ä¸ªæ˜¯æœ‰æºç çš„ï¼Œä½†ä¸å¦¨ç¢æˆ‘ä»¬è‡ªå·±å…ˆæ€è€ƒä¸€ä¸‹ï¼Œå·¥ä½œä¸­é‡åˆ°å…¶ä»–æ•ˆæœä¹Ÿèƒ½è‡ªå·±å®ç°ã€‚</p>
<p>å…ˆçœ‹ä¸‹æ•ˆæœå›¾ <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c876a00b643b41d69d1b3e44e869f112~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356854&amp;x-signature=HHznPJ1MF7sgEt6w5zsIDEp0wRc%3D" width="45%" alt="ç»„ä»¶å †å æ•ˆæœ" loading="lazy"/></p>
<h2 data-id="heading-1">æ‹†è§£é¡µé¢</h2>
<h3 data-id="heading-2">é¡µé¢ç»“æ„</h3>
<p>å¤§è‡´åˆ’åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼š <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/920799e18fea4d6f9068bc089da18adc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356854&amp;x-signature=IXz71h3LYuJ%2F80KFd1%2BuHI6f4gY%3D" width="45%" loading="lazy"/></p>
<ol>
<li>é¡¶éƒ¨çš„ä¸ªäººå¤´åƒå’Œæ‰«ç æ•ˆæœ</li>
<li>æœç´¢æ¡†ï¼šå¥½ç‰©ç²¾é€‰</li>
<li>ç¬”è®°æœ¬ã€æ™ºæ…§å±ã€éŸ³ç®±</li>
<li>åˆ†ç±»å’Œå•†å“åˆ—è¡¨</li>
</ol>
<h3 data-id="heading-3">åŠ¨ç”»æ•ˆæœ</h3>
<ol>
<li>æœç´¢æ¡†å¥½ç‰©ç²¾é€‰æ¨¡å—åœ¨é¡µé¢å‘ä¸Šæ»‘åŠ¨æ—¶é«˜åº¦é€æ¸å˜å°ï¼Œæœ€ç»ˆé«˜åº¦å›ºå®šï¼Œè¦†ç›–é¡¶éƒ¨çš„ä¸ªäººå¤´åƒå’Œæ‰«ç å›¾æ ‡</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†ç¬”è®°æœ¬ã€æ™ºæ…§å±ã€éŸ³ç®±åœ¨ä¸Šæ»‘è¿‡ç¨‹ä¸­ä¸€ç›´å¤„äºæœç´¢æ¡†åº•éƒ¨ï¼Œç„¶åé€æ¸é€æ˜ã€‚æœ€ç»ˆæ›¿æ¢ä¸ºæ¨ªå‘æ»‘åŠ¨çš„åˆ—è¡¨</li>
<li>æ›¿æ¢ä¸ºæ¨ªå‘æ»‘åŠ¨åˆ—è¡¨æ—¶ï¼Œæ¨ªå‘åˆ—è¡¨ç”±é€æ˜å˜ä¸ºä¸é€æ˜ï¼Œåˆ—è¡¨é¡¹ç›®é—´è·é€æ¸å˜å°</li>
<li>åœ¨ä¸Šæ»‘è¿‡ç¨‹ä¸­åˆ†ç±»é€æ¸ç¼©å°ï¼Œå¹¶ä¸”é€æ˜åº¦é€æ¸é™ä½ï¼Œç›®æµ‹çœ‹èµ·æ¥é€æ˜åº¦å’Œç¬¬ä¸‰éƒ¨åˆ†ä¸€è‡´ã€‚</li>
<li>åœ¨ä¸‹æ»‘è¿‡ç¨‹ä¸­ä¸Šè¿°æ•ˆæœåè½¬</li>
</ol>
<h3 data-id="heading-4">æ€è·¯</h3>
<p>æ•´ä¸ªé¡µé¢æ˜¯å¯ä»¥æ»‘åŠ¨çš„ï¼Œå¹¶ä¸”åœ¨æœç´¢æ¡†é«˜åº¦ä¸å†å˜åŒ–ä¸”å›ºå®šåœ¨é¡¶éƒ¨çš„æ—¶å€™ï¼Œåº•éƒ¨åˆ†ç±»å’Œå•†å“åˆ—è¡¨æ˜¯å¯ä»¥ç»§ç»­æ»‘åŠ¨çš„ã€‚å› æ­¤é¡µé¢éœ€è¦ä¸¤ä¸ªæ»‘åŠ¨ç»„ä»¶åµŒå¥—ã€‚</p>
<ol>
<li>ç›‘å¬å¤–éƒ¨æ»‘åŠ¨ç»„ä»¶çš„æ»‘åŠ¨äº‹ä»¶ï¼Œæ ¹æ®æ»‘åŠ¨è·ç¦»è®¡ç®—æœç´¢æ¡†é«˜åº¦</li>
<li>ç›‘å¬å†…éƒ¨æ»‘åŠ¨ç»„ä»¶çš„æ»‘åŠ¨äº‹ä»¶ï¼Œæ ¹æ®æ»‘åŠ¨è·ç¦»è®¡ç®—å¦‚ä¸‹æ•°æ®
<ul>
<li>ç¬¬ä¸‰éƒ¨åˆ†é€æ˜åº¦</li>
<li>æ˜¯å¦å°†ç¬¬ä¸‰éƒ¨åˆ†æ›¿æ¢ä¸ºæ¨ªå‘æ»‘åŠ¨åˆ—è¡¨</li>
<li>æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨çš„é€æ˜åº¦</li>
<li>æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨çš„åˆ—è¡¨é¡¹é—´è·</li>
<li>ç¬¬å››éƒ¨åˆ†åˆ†ç±»çš„å¤§å°å’Œé€æ˜åº¦</li>
</ul>
</li>
<li>å‘ä¸Šæ»‘åŠ¨æ—¶éœ€è¦è¦†ç›–é¡¶éƒ¨çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨<code>Stack</code>æ¥å¸ƒå±€</li>
<li>å‘ä¸Šæ»‘åŠ¨æ—¶ï¼Œå½“ç¬¬ä¸‰éƒ¨åˆ†æ›¿æ¢ä¸ºæ¨ªå‘æ»‘åŠ¨åˆ—è¡¨ä¹‹åï¼Œç»§ç»­å‘ä¸Šæ»‘åŠ¨åº•éƒ¨ç¬¬å››éƒ¨åˆ†çš„å•†å“åˆ—è¡¨éœ€è¦è¢«æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨è¦†ç›–ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ç”¨<code>Stack</code>å¸ƒå±€ï¼Œå±‚æ¬¡å¯ä»¥ç”¨<code>zIndex</code>å±æ€§æ§åˆ¶</li>
</ol>
<h2 data-id="heading-5">å®ç°</h2>
<p>å…ˆæ¥å®ç°å‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ¯”è¾ƒç®€å•:
æœ€å¤–å±‚æ˜¯ä¸€ä¸ª<code>Stack</code>,é¡¶éƒ¨å¯¹é½ï¼ŒåŒ…å«ä¸€ä¸ª<code>Row</code>å’Œ<code>Scroll</code>ã€‚ç”±äºScrollåªèƒ½åŒ…å«ä¸€ä¸ªç›´æ¥å­æ§ä»¶ï¼Œæ·»åŠ ä¸€ä¸ª<code>Column</code>,åœ¨è¿™ä¸ª<code>Column</code>ä¸­æ¥å†™æˆ‘ä»¬çš„æ»‘åŠ¨å¸ƒå±€ã€‚
æ»‘åŠ¨æ—¶æœç´¢æ¡†é«˜åº¦éœ€è¦åŠ¨æ€å˜åŒ–ï¼Œè¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡è¡¨ç¤ºæœç´¢æ¡†é«˜åº¦ã€‚åœ¨<code>Scroll</code>çš„<code>onScrollFrameBegin</code>å›è°ƒä¸­è®¡ç®—æœç´¢æ¡†é«˜åº¦å€¼ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Stack</span>({<span class="hljs-attr">alignContent</span>:<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>}) {
      <span class="hljs-title class_">Row</span>(){
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"UserIcon"</span>)
        <span class="hljs-title class_">Blank</span>().<span class="hljs-title function_">height</span>(<span class="hljs-number">0</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Scan"</span>)
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">15</span>,<span class="hljs-attr">right</span>:<span class="hljs-number">15</span>}).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>)

      <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">outSideScrollController</span>){
        <span class="hljs-title class_">Column</span>(){
          <span class="hljs-title class_">Row</span>().<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">searchAreaHeight</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">borderColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
        }.<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-number">50</span>}).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
      }.<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">15</span>,<span class="hljs-attr">right</span>:<span class="hljs-number">15</span>}).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
      .<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset:<span class="hljs-built_in">number</span>,state:ScrollState</span>)=&gt;</span>{
        <span class="hljs-keyword">let</span> yOffset = <span class="hljs-variable language_">this</span>.<span class="hljs-property">outSideScrollController</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span>
				<span class="hljs-comment">//ä¸ºäº†æœ‰ä¸€ä¸ªè§†å·®æ•ˆæœï¼Œè¿™é‡Œè®¾ç½®ä¸€ä¸ªç³»æ•°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">searchAreaHeight</span> = <span class="hljs-number">100</span> - yOffset * <span class="hljs-number">0.6</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}
      })

    }.<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#f1f1f1"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
  }
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83ec65e971ce4114a2b6f46d4aca9145~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356854&amp;x-signature=fGwBLt0pqc642BqpkPqfjBGiO6Q%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
çœ‹èµ·æ¥æ•ˆæœè¿˜è¡Œï¼Œæ›¿æ¢ä¸€ä¸‹ç´ æ
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec3d928fd5a64f93a53eedb9b3ccad85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356854&amp;x-signature=1tP5xSQ8ddXtyvZLIUyghAewBXI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
è¿™æ ·æˆ‘ä»¬å°±å…ˆå®Œæˆäº†ç®€å•çš„å‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­å®ç°æ¥ä¸‹æ¥çš„éƒ¨åˆ†ã€‚</p>
<hr/>
<p>ã€ æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¯·å…³æ³¨å…¬ä¼—å·ï¼šã€åç§°ï¼šHarmonyOSå¼€å‘è€…æŠ€æœ¯ï¼ŒIDï¼šHarmonyOS_Devã€‘ï¼›ä¹Ÿæ¬¢è¿åŠ å…¥é¸¿è’™å¼€å‘è€…äº¤æµç¾¤ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fgm%2F48f89e7a4c10206e053e01ad124004a0%25E3%2580%2591" target="_blank" title="https://work.weixin.qq.com/gm/48f89e7a4c10206e053e01ad124004a0%E3%80%91" ref="nofollow noopener noreferrer">work.weixin.qq.com/gm/48f89e7aâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Jetpack - 2 ViewModel]]></title>    <link>https://juejin.cn/post/7579385656779587618</link>    <guid>https://juejin.cn/post/7579385656779587618</guid>    <pubDate>2025-12-03T08:46:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579385656779587618" data-draft-id="7579321624014045224" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Jetpack - 2 ViewModel"/> <meta itemprop="keywords" content="å‰ç«¯,Android"/> <meta itemprop="datePublished" content="2025-12-03T08:46:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’è²843"/> <meta itemprop="url" content="https://juejin.cn/user/541408646929991"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Jetpack - 2 ViewModel
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/541408646929991/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’è²843
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:46:53.000Z" title="Wed Dec 03 2025 08:46:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. è®¤è¯†ViewModel</h2>
<h3 data-id="heading-1">1.1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ViewModelï¼Ÿ</h3>
<p>åœ¨ä¼ ç»Ÿçš„Androidå¼€å‘ä¸­ï¼Œå¼€å‘è€…é¢ä¸´å‡ ä¸ªæ ¸å¿ƒç—›ç‚¹ï¼ŒViewModelæ­£æ˜¯ä¸ºè§£å†³è¿™äº›é—®é¢˜è€Œè®¾è®¡çš„æ¶æ„ç»„ä»¶ã€‚</p>
<p><strong>å››å¤§æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>æ•°æ®ä¸¢å¤±é—®é¢˜</strong>ï¼šActivity/Fragmentå› <strong>é…ç½®å˜æ›´</strong>ï¼ˆå±å¹•æ—‹è½¬ã€è¯­è¨€åˆ‡æ¢ã€æ·±è‰²æ¨¡å¼åˆ‡æ¢ï¼‰è€Œé‡å»ºæ—¶ï¼Œæ‰€æœ‰ä¸´æ—¶UIæ•°æ®ï¼ˆç”¨æˆ·è¾“å…¥ã€åˆ—è¡¨æ»šåŠ¨ä½ç½®ã€æœªæäº¤çš„è¡¨å•ï¼‰éƒ½ä¼šä¸¢å¤±ã€‚</li>
<li><strong>å†…å­˜æ³„æ¼é£é™©</strong>ï¼šå¼‚æ­¥ä»»åŠ¡ï¼ˆç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æ“ä½œï¼‰æŒæœ‰UIç»„ä»¶çš„å¼•ç”¨ï¼Œå½“UIé”€æ¯åä»»åŠ¡ä»åœ¨æ‰§è¡Œï¼Œå¯¼è‡´Activityæ— æ³•è¢«åƒåœ¾å›æ”¶ã€‚</li>
<li><strong>èŒè´£è¾¹ç•Œæ¨¡ç³Š</strong>ï¼šActivityå’ŒFragmentå˜æˆäº†"ä¸Šå¸ç±»"ï¼Œæ—¢è¦å¤„ç†UIäº¤äº’ã€è§†å›¾ç»‘å®šï¼Œåˆè¦å¤„ç†æ•°æ®åŠ è½½ã€ä¸šåŠ¡é€»è¾‘ï¼Œè¿åäº†å•ä¸€èŒè´£åŸåˆ™ã€‚</li>
<li><strong>æµ‹è¯•å›°éš¾</strong>ï¼šä¸šåŠ¡é€»è¾‘ä¸Androidç»„ä»¶ï¼ˆContextã€Viewï¼‰ç´§è€¦åˆï¼Œéš¾ä»¥ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œå¿…é¡»ä¾èµ–æ˜‚è´µçš„ä»ªå™¨åŒ–æµ‹è¯•ã€‚</li>
</ol>
<p><strong>ViewModelçš„è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ - æ•°æ®éšActivityé”€æ¯</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ProblemActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> userInput: String = <span class="hljs-string">""</span> <span class="hljs-comment">// æ—‹è½¬å±å¹•åä¸¢å¤±!</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentPage: <span class="hljs-built_in">Int</span> = <span class="hljs-number">1</span>   <span class="hljs-comment">// æ—‹è½¬å±å¹•åä¸¢å¤±!</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSaveInstanceState</span><span class="hljs-params">(outState: <span class="hljs-type">Bundle</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onSaveInstanceState(outState)
        <span class="hljs-comment">// å¿…é¡»æ‰‹åŠ¨ä¿å­˜æ¯ä¸ªå­—æ®µ</span>
        outState.putString(<span class="hljs-string">"input"</span>, userInput)
        outState.putInt(<span class="hljs-string">"page"</span>, currentPage)
    }
}

<span class="hljs-comment">// ViewModelæ–¹å¼ - æ•°æ®è‡ªåŠ¨ä¿ç•™</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SolutionViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userInput = MutableLiveData(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">val</span> userInput: LiveData&lt;String&gt; = _userInput <span class="hljs-comment">// æ—‹è½¬åä¾ç„¶å­˜åœ¨</span>
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _currentPage = MutableLiveData(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">val</span> currentPage: LiveData&lt;<span class="hljs-built_in">Int</span>&gt; = _currentPage <span class="hljs-comment">// æ—‹è½¬åä¾ç„¶å­˜åœ¨</span>
}
</code></pre>
<h3 data-id="heading-2">1.2 ViewModelçš„ä½¿ç”¨æ–¹æ³•</h3>
<p><strong>åŸºæœ¬æ¨¡å¼ï¼šçŠ¶æ€ç®¡ç†ä¸UIå“åº”</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. å®šä¹‰ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfileViewModel</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userId: String,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repository: UserRepository
) : ViewModel() {
    
    <span class="hljs-comment">// UIçŠ¶æ€å°è£…</span>
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UiState</span>(
        <span class="hljs-keyword">val</span> user: User? = <span class="hljs-literal">null</span>,
        <span class="hljs-keyword">val</span> isLoading: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">false</span>,
        <span class="hljs-keyword">val</span> error: String? = <span class="hljs-literal">null</span>
    )
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow(UiState())
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = _uiState.asStateFlow()
    
    <span class="hljs-comment">// åˆå§‹åŒ–åŠ è½½</span>
    <span class="hljs-keyword">init</span> {
        loadUser()
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUser</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            _uiState.update { it.copy(isLoading = <span class="hljs-literal">true</span>) }
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> user = repository.getUser(userId)
                _uiState.update { it.copy(isLoading = <span class="hljs-literal">false</span>, user = user) }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                _uiState.update { it.copy(isLoading = <span class="hljs-literal">false</span>, error = e.message) }
            }
        }
    }
    
    <span class="hljs-comment">// ç”¨æˆ·æ“ä½œå¤„ç†</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onRefresh</span><span class="hljs-params">()</span></span> {
        loadUser()
    }
}

<span class="hljs-comment">// 2. åœ¨Activity/Fragmentä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfileActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: UserProfileViewModel <span class="hljs-keyword">by</span> viewModels {
        UserProfileViewModelFactory(<span class="hljs-string">"user123"</span>, UserRepository())
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// è§‚å¯ŸUIçŠ¶æ€å˜åŒ–</span>
        lifecycleScope.launch {
            repeatOnLifecycle(Lifecycle.State.STARTED) {
                viewModel.uiState.collect { state -&gt;
                    <span class="hljs-keyword">when</span> {
                        state.isLoading -&gt; showLoading()
                        state.error != <span class="hljs-literal">null</span> -&gt; showError(state.error)
                        state.user != <span class="hljs-literal">null</span> -&gt; showUser(state.user)
                    }
                }
            }
        }
        
        <span class="hljs-comment">// ç»‘å®šç”¨æˆ·æ“ä½œ</span>
        refreshButton.setOnClickListener {
            viewModel.onRefresh()
        }
    }
}
</code></pre>
<h3 data-id="heading-3">1.3 ViewModelçš„åˆ›å»ºæ–¹å¼</h3>
<p><strong>å¤šç§åˆ›å»ºæ–¹å¼å¯¹æ¯”ä¸é€‰æ‹©</strong>ï¼š</p>








































<table><thead><tr><th>æ–¹å¼</th><th>ä»£ç ç¤ºä¾‹</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>åŸºç¡€æ–¹å¼</strong></td><td><code>ViewModelProvider(this).get(MyViewModel::class.java)</code></td><td>ç®€å•åœºæ™¯ã€æ•™å­¦ç¤ºä¾‹</td><td>æ— éœ€é¢å¤–ä¾èµ–</td><td>ä»£ç å†—é•¿ï¼Œéœ€æ‰‹åŠ¨ç®¡ç†</td></tr><tr><td><strong>Kotlinå§”æ‰˜</strong></td><td><code>private val vm: MyViewModel by viewModels()</code></td><td>ç»å¤§å¤šæ•°åœºæ™¯</td><td>ç®€æ´ã€å»¶è¿Ÿåˆå§‹åŒ–ã€ç©ºå®‰å…¨</td><td>éœ€è¦æ·»åŠ ktxä¾èµ–</td></tr><tr><td><strong>è‡ªå®šä¹‰Factory</strong></td><td><code>by viewModels { MyFactory(params) }</code></td><td>éœ€è¦å‚æ•°çš„ViewModel</td><td>æ”¯æŒä¾èµ–æ³¨å…¥</td><td>éœ€è¦ç¼–å†™Factoryç±»</td></tr><tr><td><strong>Hiltæ³¨å…¥</strong></td><td><code>@HiltViewModel class MyViewModel @Inject constructor()</code></td><td>ç°ä»£é¡¹ç›®ã€å¤šæ¨¡å—æ¶æ„</td><td>å…¨è‡ªåŠ¨ä¾èµ–ç®¡ç†</td><td>éœ€è¦é…ç½®Hilt</td></tr></tbody></table>
<p><strong>1. Kotlinå±æ€§å§”æ‰˜ï¼ˆæ¨èï¼‰</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Activityä¸­</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-comment">// æœ€ç®€å•çš„æ–¹å¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel1: MyViewModel <span class="hljs-keyword">by</span> viewModels()
    
    <span class="hljs-comment">// å¸¦è‡ªå®šä¹‰Factory</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel2: MyViewModel <span class="hljs-keyword">by</span> viewModels {
        MyViewModelFactory(repository)
    }
}

<span class="hljs-comment">// Fragmentä¸­</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFragment</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-comment">// Fragmentä½œç”¨åŸŸ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel1: MyViewModel <span class="hljs-keyword">by</span> viewModels()
    
    <span class="hljs-comment">// ä¸Activityå…±äº«ï¼ˆå¤šFragmenté€šä¿¡ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()
    
    <span class="hljs-comment">// å¸¦å‚æ•°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> detailViewModel: DetailViewModel <span class="hljs-keyword">by</span> viewModels {
        DetailViewModelFactory(args.itemId)
    }
}
</code></pre>
<p><strong>2. è‡ªå®šä¹‰ViewModelFactory</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¸¦å‚æ•°çš„ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userId: String,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userRepository: UserRepository
) : ViewModel() { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// å¯¹åº”çš„Factory</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModelFactory</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userId: String,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userRepository: UserRepository
) : ViewModelProvider.Factory {
    
    <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
        <span class="hljs-comment">// 1. ç±»å‹å®‰å…¨æ£€æŸ¥</span>
        require(modelClass.isAssignableFrom(UserViewModel::<span class="hljs-keyword">class</span>.java)) {
            <span class="hljs-string">"Unknown ViewModel class: <span class="hljs-variable">$modelClass</span>"</span>
        }
        <span class="hljs-comment">// 2. åˆ›å»ºå®ä¾‹</span>
        <span class="hljs-keyword">return</span> UserViewModel(userId, userRepository) <span class="hljs-keyword">as</span> T
    }
}

<span class="hljs-comment">// 3. ä½¿ç”¨</span>
<span class="hljs-keyword">val</span> factory = UserViewModelFactory(<span class="hljs-string">"user123"</span>, repository)
<span class="hljs-keyword">val</span> viewModel: UserViewModel <span class="hljs-keyword">by</span> viewModels { factory }
</code></pre>
<h2 data-id="heading-4">2. ViewModelå®ç°åŸç†åˆ†æ</h2>
<h3 data-id="heading-5">2.1 ViewModelçš„åˆ›å»ºè¿‡ç¨‹</h3>
<p><strong>æ ¸å¿ƒæµç¨‹æºç åˆ†æ</strong>ï¼š</p>
<p>java</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// ViewModelProvider.java - è·å–ViewModelçš„æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-selector-tag">public</span> &lt;<span class="hljs-selector-tag">T</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">ViewModel</span>&gt; <span class="hljs-selector-tag">T</span> <span class="hljs-selector-tag">get</span>(<span class="hljs-variable">@NonNull</span> Class&lt;T&gt; modelClass) {
    <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">canonicalName</span> = <span class="hljs-selector-tag">modelClass</span><span class="hljs-selector-class">.getCanonicalName</span>();
    <span class="hljs-comment">// 1. ç”Ÿæˆå”¯ä¸€Keyï¼šé»˜è®¤å‰ç¼€ + ç±»å…¨å</span>
    <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">key</span> = "<span class="hljs-selector-tag">androidx</span><span class="hljs-selector-class">.lifecycle</span><span class="hljs-selector-class">.ViewModelProvider</span><span class="hljs-selector-class">.DefaultKey</span>:" + <span class="hljs-selector-tag">canonicalName</span>;
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">get</span>(key, modelClass);
}

<span class="hljs-selector-tag">public</span> &lt;<span class="hljs-selector-tag">T</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">ViewModel</span>&gt; <span class="hljs-selector-tag">T</span> <span class="hljs-selector-tag">get</span>(<span class="hljs-variable">@NonNull</span> String key, <span class="hljs-variable">@NonNull</span> Class&lt;T&gt; modelClass) {
    <span class="hljs-comment">// 2. å…ˆä»ViewModelStoreä¸­è·å–å·²å­˜åœ¨çš„å®ä¾‹</span>
    <span class="hljs-selector-tag">ViewModel</span> <span class="hljs-selector-tag">viewModel</span> = <span class="hljs-selector-tag">mViewModelStore</span><span class="hljs-selector-class">.get</span>(key);
    
    <span class="hljs-selector-tag">if</span> (modelClass.<span class="hljs-built_in">isInstance</span>(viewModel)) {
        <span class="hljs-comment">// 3. å¦‚æœç±»å‹åŒ¹é…ï¼Œç›´æ¥è¿”å›ï¼ˆå¤ç”¨å®ä¾‹ï¼‰</span>
        <span class="hljs-selector-tag">return</span> (T) <span class="hljs-selector-tag">viewModel</span>;
    }
    
    <span class="hljs-comment">// 4. å¦åˆ™é€šè¿‡Factoryåˆ›å»ºæ–°å®ä¾‹</span>
    <span class="hljs-selector-tag">viewModel</span> = <span class="hljs-selector-tag">mFactory</span><span class="hljs-selector-class">.create</span>(modelClass);
    <span class="hljs-comment">// 5. å­˜å‚¨åˆ°ViewModelStoreä¸­</span>
    <span class="hljs-selector-tag">mViewModelStore</span><span class="hljs-selector-class">.put</span>(key, viewModel);
    <span class="hljs-selector-tag">return</span> (T) <span class="hljs-selector-tag">viewModel</span>;
}
</code></pre>
<p><strong>ViewModelStoreçš„å†…éƒ¨ç»“æ„</strong>ï¼š</p>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelStore</span> {
    <span class="hljs-comment">// æ ¸å¿ƒï¼šHashMapå­˜å‚¨æ‰€æœ‰ViewModel</span>
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">HashMap</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">ViewModel</span>&gt; mMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">// å­˜å‚¨ViewModel</span>
    final <span class="hljs-built_in">void</span> <span class="hljs-title function_">put</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key, <span class="hljs-meta">@NonNull</span> ViewModel viewModel</span>) {
        <span class="hljs-title class_">ViewModel</span> oldViewModel = mMap.<span class="hljs-title function_">put</span>(key, viewModel);
        <span class="hljs-keyword">if</span> (oldViewModel != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å¦‚æœå·²æœ‰ç›¸åŒKeyçš„ViewModelï¼Œæ¸…ç†æ—§çš„</span>
            oldViewModel.<span class="hljs-title function_">onCleared</span>();
        }
    }
    
    <span class="hljs-comment">// è·å–ViewModel</span>
    final <span class="hljs-title class_">ViewModel</span> <span class="hljs-title function_">get</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key</span>) {
        <span class="hljs-keyword">return</span> mMap.<span class="hljs-title function_">get</span>(key);
    }
    
    <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰ViewModelï¼ˆåœ¨Activityé”€æ¯æ—¶è°ƒç”¨ï¼‰</span>
    <span class="hljs-keyword">public</span> final <span class="hljs-built_in">void</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">ViewModel</span> vm : mMap.<span class="hljs-title function_">values</span>()) {
            vm.<span class="hljs-title function_">onCleared</span>();
        }
        mMap.<span class="hljs-title function_">clear</span>();
    }
}
</code></pre>
<h3 data-id="heading-6">2.2Â <code>by viewModels()</code>å®ç°åŸç†åˆ†æ</h3>
<p><strong>Kotlinå±æ€§å§”æ‰˜èƒŒåçš„é­”æ³•</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// androidx.fragment.app.FragmentViewModelLazy.kt</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> VM : ViewModel&gt;</span> Fragment.<span class="hljs-title">viewModels</span><span class="hljs-params">(
    <span class="hljs-keyword">noinline</span> ownerProducer: () -&gt; <span class="hljs-type">ViewModelStoreOwner</span> = { this },
    <span class="hljs-keyword">noinline</span> factoryProducer: (() -&gt; <span class="hljs-type">Factory</span>)? = <span class="hljs-literal">null</span>
)</span></span>: Lazy&lt;VM&gt; {
    <span class="hljs-comment">// åˆ›å»ºLazyå§”æ‰˜</span>
    <span class="hljs-keyword">return</span> createViewModelLazy(
        VM::<span class="hljs-keyword">class</span>,
        { ownerProducer().viewModelStore }, <span class="hljs-comment">// è·å–ViewModelStore</span>
        factoryProducer ?: { defaultViewModelProviderFactory }
    )
}

<span class="hljs-comment">// å®é™…çš„Lazyå®ç°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;VM : ViewModel&gt;</span> <span class="hljs-title">createViewModelLazy</span><span class="hljs-params">(
    viewModelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">VM</span>&gt;,
    storeProducer: () -&gt; <span class="hljs-type">ViewModelStore</span>,
    factoryProducer: () -&gt; <span class="hljs-type">ViewModelProvider</span>.<span class="hljs-type">Factory</span>
)</span></span>: Lazy&lt;VM&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">object</span> : Lazy&lt;VM&gt; {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cached: VM? = <span class="hljs-literal">null</span>
        
        <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> value: VM
            <span class="hljs-keyword">get</span>() {
                <span class="hljs-keyword">return</span> cached ?: let {
                    <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–ï¼šç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰åˆ›å»º</span>
                    ViewModelProvider(storeProducer(), factoryProducer())
                        .<span class="hljs-keyword">get</span>(viewModelClass.java)
                        .also { cached = it }
                }
            }
        
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isInitialized</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> = cached != <span class="hljs-literal">null</span>
    }
}
</code></pre>
<p><strong>ä¸æ‰‹åŠ¨åˆ›å»ºçš„ç­‰ä»·å…³ç³»</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è¿™ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼š</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: MyViewModel <span class="hljs-keyword">by</span> viewModels()

<span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> viewModel: MyViewModel

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    viewModel = ViewModelProvider(<span class="hljs-keyword">this</span>).<span class="hljs-keyword">get</span>(MyViewModel::<span class="hljs-keyword">class</span>.java)
}
</code></pre>
<h3 data-id="heading-7">2.3 ViewModelå¦‚ä½•å®ç°ä¸åŒçš„ä½œç”¨åŸŸ</h3>
<p><strong>Androidä¸­çš„ViewModelä½œç”¨åŸŸä½“ç³»</strong>ï¼š</p>



































<table><thead><tr><th>ä½œç”¨åŸŸ</th><th>è·å–æ–¹å¼</th><th>ç”Ÿå‘½å‘¨æœŸ</th><th>å…¸å‹ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Activityä½œç”¨åŸŸ</strong></td><td><code>by viewModels()</code></td><td>ä¸Activityç»‘å®šï¼ŒActivityé”€æ¯æ—¶æ¸…é™¤</td><td>å•ä¸ªActivityå†…éƒ¨ä½¿ç”¨çš„æ•°æ®</td></tr><tr><td><strong>Fragmentä½œç”¨åŸŸ</strong></td><td><code>by viewModels()</code></td><td>ä¸Fragmentç»‘å®šï¼ŒFragmenté”€æ¯æ—¶æ¸…é™¤</td><td>å•ä¸ªFragmentå†…éƒ¨ä½¿ç”¨çš„æ•°æ®</td></tr><tr><td><strong>Activityå…±äº«ä½œç”¨åŸŸ</strong></td><td><code>by activityViewModels()</code></td><td>ä¸çˆ¶Activityç»‘å®š</td><td>å¤šä¸ªFragmenté—´å…±äº«æ•°æ®</td></tr><tr><td><strong>Navigationä½œç”¨åŸŸ</strong></td><td><code>by navGraphViewModels(R.id.nav_graph)</code></td><td>ä¸å¯¼èˆªå›¾ç»‘å®š</td><td>åŒä¸€å¯¼èˆªæµç¨‹ä¸­å…±äº«æ•°æ®</td></tr></tbody></table>
<p><strong>å¤šFragmentå…±äº«æ•°æ®çš„å®ç°åŸç†</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å…±äº«ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">val</span> selectedItem = MutableLiveData&lt;Item&gt;()
    <span class="hljs-keyword">val</span> searchQuery = MutableLiveData&lt;String&gt;()
}

<span class="hljs-comment">// Fragment A - å‘é€æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ListFragment</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-comment">// å…³é”®ï¼šä½¿ç”¨activityViewModels()è·å–Activityä½œç”¨åŸŸçš„å®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onItemClick</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span> {
        sharedViewModel.selectedItem.value = item
    }
}

<span class="hljs-comment">// Fragment B - æ¥æ”¶æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DetailFragment</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-comment">// è·å–çš„æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
        sharedViewModel.selectedItem.observe(viewLifecycleOwner) { item -&gt;
            <span class="hljs-comment">// æ˜¾ç¤ºé€‰ä¸­é¡¹è¯¦æƒ…</span>
            showDetails(item)
        }
    }
}
</code></pre>
<p><strong>åŸç†</strong>ï¼š<code>activityViewModels()</code>å†…éƒ¨ä½¿ç”¨<code>requireActivity()</code>ä½œä¸º<code>ViewModelStoreOwner</code>ï¼Œå› æ­¤å¤šä¸ªFragmentä»åŒä¸€ä¸ªActivityçš„<code>ViewModelStore</code>ä¸­è·å–ViewModelï¼Œè‡ªç„¶å¾—åˆ°åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<h3 data-id="heading-8">2.4 ä¸ºä»€ä¹ˆActivityåœ¨å±å¹•æ—‹è½¬é‡å»ºåå¯ä»¥æ¢å¤ViewModelï¼Ÿ</h3>
<p>è¿™æ˜¯ViewModelæœ€æ ¸å¿ƒçš„æœºåˆ¶ï¼Œç†è§£å®ƒéœ€è¦æ·±å…¥Androidç³»ç»Ÿå±‚é¢ã€‚</p>
<h4 data-id="heading-9">æ ¸å¿ƒç»“è®º</h4>
<p>ViewModelèƒ½åœ¨å±å¹•æ—‹è½¬åæ¢å¤ï¼Œæ˜¯å› ä¸ºAndroidç³»ç»Ÿå°†æ•°æ®åŒºåˆ†ä¸º<strong>é…ç½®ç›¸å…³æ•°æ®</strong>å’Œ<strong>éé…ç½®ç›¸å…³æ•°æ®</strong>ã€‚ViewModelå±äºåè€…ï¼Œå…¶å­˜å‚¨å®¹å™¨<code>ViewModelStore</code>åœ¨Activityé”€æ¯å‰è¢«ç³»ç»Ÿä¸´æ—¶ä¿å­˜ï¼Œå¹¶åœ¨æ–°Activityåˆ›å»ºåä¼ é€’è¿‡å»ã€‚æ•´ä¸ªè¿‡ç¨‹æ˜¯<strong>å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çš„ç›´æ¥è½¬ç§»</strong>ï¼Œè€Œéåºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚</p>
<h4 data-id="heading-10">è¯¦ç»†æ¢å¤æµç¨‹ï¼ˆä¸‰ä¸ªé˜¶æ®µï¼‰</h4>
<p><strong>é˜¶æ®µ1ï¼šé”€æ¯å‰ä¿å­˜ï¼ˆæ—§Activity â†’ ç³»ç»Ÿä¸´æ—¶å­˜å‚¨ï¼‰</strong></p>
<ol>
<li>ç³»ç»Ÿæ£€æµ‹åˆ°å±å¹•æ—‹è½¬ï¼Œå‡†å¤‡é”€æ¯å½“å‰Activity</li>
<li>è°ƒç”¨<code>Activity.retainNonConfigurationInstances()</code>æ–¹æ³•</li>
<li><code>ComponentActivity</code>é‡å†™<code>onRetainNonConfigurationInstance()</code>ï¼Œå°†<code>ViewModelStore</code>åŒ…è£…è¿›<code>NonConfigurationInstances</code>å¯¹è±¡</li>
<li>ç³»ç»Ÿå°†<code>NonConfigurationInstances</code>å­˜å…¥<code>ActivityClientRecord</code></li>
</ol>
<p><strong>é˜¶æ®µ2ï¼šé‡å»ºæ—¶ä¼ é€’ï¼ˆç³»ç»Ÿä¸´æ—¶å­˜å‚¨ â†’ æ–°Activityï¼‰</strong></p>
<ol>
<li>ç³»ç»Ÿåˆ›å»ºæ–°çš„Activityå®ä¾‹</li>
<li>åœ¨<code>ActivityThread.performLaunchActivity()</code>ä¸­è°ƒç”¨æ–°Activityçš„<code>attach()</code>æ–¹æ³•</li>
<li>å°†<code>ActivityClientRecord</code>ä¸­æš‚å­˜çš„<code>lastNonConfigurationInstances</code>ä½œä¸ºå‚æ•°ä¼ å…¥</li>
<li>æ–°Activityå°†å…¶ä¿å­˜åˆ°æˆå‘˜å˜é‡<code>mLastNonConfigurationInstances</code></li>
</ol>
<p><strong>é˜¶æ®µ3ï¼šæŒ‰éœ€æ¢å¤ï¼ˆæ–°Activityå†…éƒ¨è·å–ï¼‰</strong></p>
<ol>
<li>æ–°Activityé¦–æ¬¡è°ƒç”¨<code>getViewModelStore()</code>æ–¹æ³•</li>
<li>æ£€æŸ¥<code>mViewModelStore</code>æ˜¯å¦ä¸ºç©º</li>
<li>ä»<code>mLastNonConfigurationInstances</code>ä¸­è·å–æ—§çš„<code>ViewModelStore</code></li>
<li>å¦‚æœè·å–æˆåŠŸï¼Œç›´æ¥å¤ç”¨ï¼›å¦åˆ™åˆ›å»ºæ–°çš„</li>
</ol>
<h4 data-id="heading-11">å…³é”®æºç èŠ‚ç‚¹</h4>
<p>java</p>
<pre><code class="hljs language-ini" lang="ini">// ComponentActivity.java - ä¿å­˜ViewModelStore
@Override
public final Object onRetainNonConfigurationInstance() {
    ViewModelStore <span class="hljs-attr">viewModelStore</span> = mViewModelStore<span class="hljs-comment">;</span>
    // åŒ…è£…å¹¶è¿”å›
    NonConfigurationInstances <span class="hljs-attr">nci</span> = new NonConfigurationInstances()<span class="hljs-comment">;</span>
    <span class="hljs-attr">nci.viewModelStore</span> = viewModelStore<span class="hljs-comment">; // å…³é”®ï¼šä¿å­˜ViewModelStore</span>
    return nci<span class="hljs-comment">;</span>
}

// ComponentActivity.java - æ¢å¤ViewModelStore
@NonNull
public ViewModelStore getViewModelStore() {
    if (<span class="hljs-attr">mViewModelStore</span> == null) {
        // å…³é”®ï¼šä¼˜å…ˆä»æ—§æ•°æ®ä¸­æ¢å¤
        NonConfigurationInstances <span class="hljs-attr">nc</span> = 
            (NonConfigurationInstances) getLastNonConfigurationInstance()<span class="hljs-comment">;</span>
        if (nc != null) {
            <span class="hljs-attr">mViewModelStore</span> = nc.viewModelStore<span class="hljs-comment">; // ç›´æ¥å¤ç”¨ï¼</span>
        }
        if (<span class="hljs-attr">mViewModelStore</span> == null) {
            <span class="hljs-attr">mViewModelStore</span> = new ViewModelStore()<span class="hljs-comment">; // æ²¡æœ‰æ‰åˆ›å»ºæ–°çš„</span>
        }
    }
    return mViewModelStore<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-12">å½¢è±¡æ¯”å–»ï¼šä¿é™©ç®±ä¼ é€’</h4>
<p>å¯ä»¥æŠŠæ•´ä¸ªè¿‡ç¨‹æƒ³è±¡æˆï¼š</p>
<ul>
<li><strong>ViewModelå®ä¾‹</strong>ï¼šçè´µçš„ç å®</li>
<li><strong>ViewModelStore</strong>ï¼šå­˜æ”¾ç å®çš„ä¿é™©ç®±</li>
<li><strong>Activity</strong>ï¼šç§Ÿç”¨æˆ¿é—´çš„ç§Ÿå®¢</li>
</ul>
<ol>
<li>ç§Ÿå®¢Aï¼ˆActivity Aï¼‰é€€ç§Ÿå‰ï¼ŒæŠŠä¿é™©ç®±å¯„å­˜åœ¨ç®¡ç†å¤„ï¼ˆç³»ç»Ÿï¼‰</li>
<li>ç§Ÿå®¢Bï¼ˆActivity Bï¼‰å…¥ä½åŒä¸€æˆ¿é—´ï¼Œç®¡ç†å¤„æŠŠä¿é™©ç®±è¿˜ç»™ä»–</li>
<li>ç å®ï¼ˆViewModelï¼‰ä»æœªè¢«ç§»åŠ¨ï¼Œåªæ˜¯ä¿é™©ç®±æ¢äº†ä¸»äºº</li>
</ol>
<h3 data-id="heading-13">2.5 ViewModelçš„æ•°æ®åœ¨ä»€ä¹ˆæ—¶å€™æ‰ä¼šæ¸…é™¤</h3>
<p><strong>ViewModelç”Ÿå‘½å‘¨æœŸçš„ä¸‰ç§ç»ˆç»“åœºæ™¯</strong>ï¼š</p>





























<table><thead><tr><th>åœºæ™¯</th><th>è§¦å‘æ¡ä»¶</th><th>ViewModelçŠ¶æ€å˜åŒ–</th><th>æ˜¯å¦è°ƒç”¨<code>onCleared()</code></th></tr></thead><tbody><tr><td><strong>æ­£å¸¸é€€å‡º</strong></td><td>ç”¨æˆ·æŒ‰è¿”å›é”®ã€è°ƒç”¨<code>finish()</code></td><td>ViewModelè¢«æ¸…é™¤</td><td>âœ… æ˜¯</td></tr><tr><td><strong>é…ç½®å˜æ›´</strong></td><td>å±å¹•æ—‹è½¬ã€è¯­è¨€åˆ‡æ¢ç­‰</td><td>ViewModelä¿ç•™å¹¶æ¢å¤</td><td>âŒ å¦</td></tr><tr><td><strong>è¿›ç¨‹è¢«æ€æ­»</strong></td><td>ç³»ç»Ÿå†…å­˜ä¸è¶³ã€åº”ç”¨åœ¨åå°è¢«æ€æ­»</td><td>ViewModeléšè¿›ç¨‹æ¶ˆäº¡</td><td>âŒ å¦</td></tr></tbody></table>
<p><strong>æºç ä¸­çš„æ¸…é™¤é€»è¾‘</strong>ï¼š</p>
<p>java</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ComponentActivity.java</span>
<span class="hljs-keyword">@Override</span>
protected void onDestroy() {
    super<span class="hljs-selector-class">.onDestroy</span>();
    
    if (mViewModelStore != null) {
        <span class="hljs-comment">// å…³é”®åˆ¤æ–­ï¼šæ˜¯å¦ä¸ºé…ç½®å˜æ›´</span>
        if (!isChangingConfigurations()) {
            <span class="hljs-comment">// éé…ç½®å˜æ›´ â†’ æ¸…é™¤ViewModel</span>
            mViewModelStore<span class="hljs-selector-class">.clear</span>();
        }
        <span class="hljs-comment">// é…ç½®å˜æ›´ â†’ ä¿ç•™ViewModel</span>
    }
}

<span class="hljs-comment">// ViewModelStore.clear()</span>
public final void <span class="hljs-attribute">clear</span>() {
    for (ViewModel viewModel : mMap.values()) {
        <span class="hljs-comment">// è°ƒç”¨æ¯ä¸ªViewModelçš„onCleared()</span>
        viewModel<span class="hljs-selector-class">.onCleared</span>();
    }
    mMap<span class="hljs-selector-class">.clear</span>();
}
</code></pre>
<p><strong><code>onCleared()</code>çš„æ­£ç¡®ä½¿ç”¨</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    
    <span class="hljs-comment">// éœ€è¦æ¸…ç†çš„èµ„æº</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> compositeDisposable = CompositeDisposable()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> timer: Timer? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> listeners = mutableListOf&lt;Listener&gt;()
    
    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// åˆå§‹åŒ–èµ„æº</span>
        timer = Timer().apply {
            scheduleAtFixedRate(timerTask { <span class="hljs-comment">/* ... */</span> }, <span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerListener</span><span class="hljs-params">(listener: <span class="hljs-type">Listener</span>)</span></span> {
        listeners.add(listener)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCleared()
        <span class="hljs-comment">// 1. å–æ¶ˆæ‰€æœ‰å¼‚æ­¥ä»»åŠ¡</span>
        compositeDisposable.clear()
        
        <span class="hljs-comment">// 2. åœæ­¢å®šæ—¶å™¨</span>
        timer?.cancel()
        timer = <span class="hljs-literal">null</span>
        
        <span class="hljs-comment">// 3. æ¸…ç†ç›‘å¬å™¨</span>
        listeners.clear()
        
        <span class="hljs-comment">// 4. é‡Šæ”¾å…¶ä»–èµ„æº</span>
        releaseOtherResources()
    }
}
</code></pre>
<h2 data-id="heading-14">3. ViewModelçš„å†…å­˜æ³„æ¼é—®é¢˜</h2>
<h3 data-id="heading-15">å¸¸è§å†…å­˜æ³„æ¼åœºæ™¯ä¸è§£å†³æ–¹æ¡ˆ</h3>
<p><strong>åœºæ™¯1ï¼šåœ¨ViewModelä¸­æŒæœ‰Contextå¼•ç”¨</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šç›´æ¥æŒæœ‰Activity Context</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LeakyViewModel</span>(context: Context) : ViewModel() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: Context = context <span class="hljs-comment">// å†…å­˜æ³„æ¼ï¼</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®1ï¼šä½¿ç”¨AndroidViewModelè·å–Application Context</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeViewModel1</span>(application: Application) : AndroidViewModel(application) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: Context = getApplication&lt;Application&gt;().applicationContext
}

<span class="hljs-comment">// âœ… æ­£ç¡®2ï¼šé€šè¿‡ä¾èµ–æ³¨å…¥ä¼ å…¥Application Context</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeViewModel2</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> appContext: Context <span class="hljs-comment">// ç¡®ä¿æ˜¯Application Context</span>
) : ViewModel() {
    <span class="hljs-keyword">init</span> {
        require(appContext.applicationContext == appContext) {
            <span class="hljs-string">"å¿…é¡»ä½¿ç”¨Application Context"</span>
        }
    }
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šæœªæ­£ç¡®ç®¡ç†çš„å¼‚æ­¥ä»»åŠ¡</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šä½¿ç”¨GlobalScope</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CoroutineLeakViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span> {
        GlobalScope.launch { <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸä¸Appç›¸åŒï¼</span>
            delay(<span class="hljs-number">5000</span>)
            updateUI() <span class="hljs-comment">// ViewModelå¯èƒ½å·²é”€æ¯</span>
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨viewModelScope</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeCoroutineViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch { <span class="hljs-comment">// è‡ªåŠ¨ç»‘å®šViewModelç”Ÿå‘½å‘¨æœŸ</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = repository.loadData()
                updateState(<span class="hljs-keyword">data</span>)
            } <span class="hljs-keyword">catch</span> (e: CancellationException) {
                <span class="hljs-comment">// æ­£å¸¸å–æ¶ˆï¼Œæ— éœ€å¤„ç†</span>
            }
        }
    }
}

<span class="hljs-comment">// âœ… RxJavaçš„æ­£ç¡®ç®¡ç†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RxViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> compositeDisposable = CompositeDisposable()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span> {
        repository.getData()
            .subscribeOn(Schedulers.io())
            .observeOn(AndroidSchedulers.mainThread())
            .subscribe { result -&gt;
                <span class="hljs-comment">// å¤„ç†ç»“æœ</span>
            }
            .addTo(compositeDisposable) <span class="hljs-comment">// æ·»åŠ åˆ°CompositeDisposable</span>
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCleared()
        compositeDisposable.clear() <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰Disposable</span>
    }
}
</code></pre>
<p><strong>åœºæ™¯3ï¼šè§‚å¯Ÿè€…æœªåŠæ—¶ç§»é™¤</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ æ½œåœ¨é—®é¢˜ï¼šè§‚å¯Ÿè€…æŒæœ‰å¤–éƒ¨å¼•ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ObserverLeakActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observer = Observer&lt;String&gt; { <span class="hljs-keyword">data</span> -&gt;
        <span class="hljs-comment">// å¦‚æœobserveræŒæœ‰Activityå¼•ç”¨...</span>
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        viewModel.<span class="hljs-keyword">data</span>.observe(<span class="hljs-keyword">this</span>, observer)
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨lambdaæˆ–æ–¹æ³•å¼•ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeObserverActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        <span class="hljs-comment">// LiveDataä¼šè‡ªåŠ¨åœ¨Activityé”€æ¯æ—¶ç§»é™¤è§‚å¯Ÿè€…</span>
        viewModel.<span class="hljs-keyword">data</span>.observe(<span class="hljs-keyword">this</span>) { <span class="hljs-keyword">data</span> -&gt;
            updateUI(<span class="hljs-keyword">data</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-16">å†…å­˜æ³„æ¼æ£€æµ‹ä¸é¢„é˜²ç­–ç•¥</h3>
<p><strong>é˜²å¾¡æ€§ç¼–ç¨‹æ¸…å•</strong>ï¼š</p>
<ol>
<li>âœ… ç»ä¸æŒæœ‰<code>Activity</code>/<code>Fragment</code>/<code>View</code>çš„å¼•ç”¨</li>
<li>âœ… ä½¿ç”¨<code>AndroidViewModel</code>è·å–<code>Application Context</code></li>
<li>âœ… æ‰€æœ‰åç¨‹ä½¿ç”¨<code>viewModelScope.launch</code></li>
<li>âœ… RxJavaä½¿ç”¨<code>CompositeDisposable</code>å¹¶åœ¨<code>onCleared()</code>ä¸­æ¸…ç†</li>
<li>âœ… ä½¿ç”¨<code>LifecycleOwner</code>è‡ªåŠ¨ç®¡ç†LiveDataè§‚å¯Ÿè€…</li>
<li>âœ… åœ¨<code>onCleared()</code>ä¸­æ¸…ç†æ‰€æœ‰èµ„æºã€åæ³¨å†Œç›‘å¬å™¨</li>
<li>âŒ é¿å…å°†ViewModelå­˜å‚¨åœ¨é™æ€å˜é‡æˆ–å•ä¾‹ä¸­</li>
</ol>
<h2 data-id="heading-17">4. ViewModelå’ŒonSaveInstanceStateå¯¹æ¯”</h2>
<h3 data-id="heading-18">æœ¬è´¨åŒºåˆ«ä¸é€‚ç”¨åœºæ™¯</h3>













































<table><thead><tr><th>ç»´åº¦</th><th>ViewModel</th><th>onSaveInstanceState</th></tr></thead><tbody><tr><td><strong>è®¾è®¡ç›®çš„</strong></td><td>å¤„ç†<strong>é…ç½®å˜æ›´</strong></td><td>å¤„ç†<strong>è¿›ç¨‹æ­»äº¡</strong></td></tr><tr><td><strong>æ•°æ®è½½ä½“</strong></td><td>å†…å­˜å¯¹è±¡å¼•ç”¨</td><td>Bundleåºåˆ—åŒ–</td></tr><tr><td><strong>å­˜å‚¨ä½ç½®</strong></td><td>å†…å­˜ä¸­</td><td>Bundleï¼ˆå¯åºåˆ—åŒ–åˆ°ç£ç›˜ï¼‰</td></tr><tr><td><strong>æ•°æ®å¤§å°</strong></td><td>æ— é™åˆ¶ï¼ˆå—å†…å­˜çº¦æŸï¼‰</td><td>æœ‰é™åˆ¶ï¼ˆé€šå¸¸&lt;1MBï¼‰</td></tr><tr><td><strong>æ•°æ®ç±»å‹</strong></td><td>ä»»ä½•Java/Kotlinå¯¹è±¡</td><td>åŸºæœ¬ç±»å‹ã€Parcelableã€Serializable</td></tr><tr><td><strong>æ¢å¤æ—¶æœº</strong></td><td>é…ç½®å˜æ›´åç«‹å³å¯ç”¨</td><td><code>onCreate()</code>ä¸­æ‰‹åŠ¨æ¢å¤</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>å‡ ä¹æ— ï¼ˆå†…å­˜å¼•ç”¨ï¼‰</td><td>åºåˆ—åŒ–/ååºåˆ—åŒ–å¼€é”€</td></tr></tbody></table>
<h3 data-id="heading-19">ç°ä»£æ–¹æ¡ˆï¼šViewModel + SavedStateHandle</h3>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç»“åˆä¸¤è€…ä¼˜åŠ¿çš„ç°ä»£å®è·µ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfileViewModel</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> savedStateHandle: SavedStateHandle
) : ViewModel() {
    
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> USER_ID_KEY = <span class="hljs-string">"user_id"</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> SEARCH_QUERY_KEY = <span class="hljs-string">"search_query"</span>
    }
    
    <span class="hljs-comment">// éœ€è¦è¿›ç¨‹æ­»äº¡æ¢å¤çš„æ•°æ®</span>
    <span class="hljs-keyword">var</span> userId: String
        <span class="hljs-keyword">get</span>() = savedStateHandle[USER_ID_KEY] ?: <span class="hljs-string">""</span>
        <span class="hljs-keyword">set</span>(value) = savedStateHandle.<span class="hljs-keyword">set</span>(USER_ID_KEY, value)
    
    <span class="hljs-keyword">var</span> searchQuery: String
        <span class="hljs-keyword">get</span>() = savedStateHandle[SEARCH_QUERY_KEY] ?: <span class="hljs-string">""</span>
        <span class="hljs-keyword">set</span>(value) = savedStateHandle.<span class="hljs-keyword">set</span>(SEARCH_QUERY_KEY, value)
    
    <span class="hljs-comment">// ä¸éœ€è¦æŒä¹…åŒ–çš„ä¸´æ—¶æ•°æ®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userData = MutableStateFlow&lt;User?&gt;(<span class="hljs-literal">null</span>)
    <span class="hljs-keyword">val</span> userData: StateFlow&lt;User?&gt; = _userData.asStateFlow()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUser</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            _userData.value = repository.getUser(userId)
        }
    }
}
</code></pre>
<h3 data-id="heading-20">é€‰æ‹©ç­–ç•¥å†³ç­–æ ‘</h3>
<p>text</p>
<pre><code class="hljs language-markdown" lang="markdown">éœ€è¦æŒä¹…åŒ–æ•°æ®å—ï¼Ÿ
â”œâ”€â”€ å¦ â†’ ä½¿ç”¨ViewModelæ™®é€šå±æ€§
â”œâ”€â”€ æ˜¯ â†’ 
<span class="hljs-code">    â”œâ”€â”€ éœ€è¦è¿›ç¨‹æ­»äº¡åæ¢å¤å—ï¼Ÿ
    â”‚   â”œâ”€â”€ å¦ â†’ ViewModel + LiveData/StateFlow
    â”‚   â””â”€â”€ æ˜¯ â†’ 
    â”‚       â”œâ”€â”€ æ•°æ®é‡å°ä¸”ç®€å• â†’ onSaveInstanceState
    â”‚       â””â”€â”€ æ•°æ®å¤æ‚æˆ–éœ€è¦å…±äº« â†’ ViewModel + SavedStateHandle
    â””â”€â”€ æ˜¯å¦æ˜¯UIçŠ¶æ€ï¼Ÿ
        â”œâ”€â”€ æ˜¯ â†’ ViewModel + SavedStateHandle
        â””â”€â”€ å¦ â†’ è€ƒè™‘æŒä¹…åŒ–æ–¹æ¡ˆï¼ˆRoomã€DataStoreï¼‰
</span></code></pre>
<h2 data-id="heading-21">5. æ€»ç»“</h2>
<h3 data-id="heading-22">ViewModelçš„æ ¸å¿ƒä»·å€¼å›é¡¾</h3>
<ol>
<li><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>ï¼šè‡ªåŠ¨å¤„ç†é…ç½®å˜æ›´ï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒæ•°æ®ä¿å­˜ä¸æ¢å¤</li>
<li><strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼šåœ¨é€‚å½“çš„ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒæ•°æ®ä¸€è‡´æ€§</li>
<li><strong>æ¶æ„æ¸…æ™°</strong>ï¼šä¿ƒè¿›MVVM/MVIæ¶æ„ï¼Œå®ç°å…³æ³¨ç‚¹åˆ†ç¦»</li>
<li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šçº¯ä¸šåŠ¡é€»è¾‘ï¼Œæ˜“äºå•å…ƒæµ‹è¯•</li>
<li><strong>æ•°æ®å…±äº«</strong>ï¼šç®€åŒ–ç»„ä»¶é—´é€šä¿¡ï¼Œç‰¹åˆ«æ˜¯Fragmenté—´é€šä¿¡</li>
</ol>
<h3 data-id="heading-23">æœ€ä½³å®è·µæ€»ç»“</h3>
<p><strong>DOï¼ˆåº”è¯¥åšçš„ï¼‰</strong> ï¼š</p>
<ul>
<li>âœ… ä½¿ç”¨<code>by viewModels()</code>ç®€åŒ–åˆ›å»º</li>
<li>âœ… ä½¿ç”¨<code>viewModelScope</code>ç®¡ç†åç¨‹</li>
<li>âœ… ç»“åˆRepositoryæ¨¡å¼å¤„ç†æ•°æ®</li>
<li>âœ… ä½¿ç”¨SavedStateHandleå¤„ç†è¿›ç¨‹æ­»äº¡æ¢å¤</li>
<li>âœ… ä¸ºViewModelç¼–å†™å•å…ƒæµ‹è¯•</li>
<li>âœ… ä½¿ç”¨çŠ¶æ€å®¹å™¨ï¼ˆState Flowï¼‰ç®¡ç†UIçŠ¶æ€</li>
</ul>
<p><strong>DON'Tï¼ˆä¸åº”è¯¥åšçš„ï¼‰</strong> ï¼š</p>
<ul>
<li>âŒ åœ¨ViewModelä¸­æŒæœ‰View/Activityå¼•ç”¨</li>
<li>âŒ ä½¿ç”¨GlobalScopeæˆ–æœªç®¡ç†çš„Disposable</li>
<li>âŒ å°†å¤§é‡æ•°æ®ç›´æ¥å­˜å‚¨åœ¨ViewModelä¸­ï¼ˆè€ƒè™‘åˆ†é¡µï¼‰</li>
<li>âŒ å¿½ç•¥<code>onCleared()</code>ä¸­çš„èµ„æºæ¸…ç†</li>
<li>âŒ å°†ViewModelä½œä¸ºå…¨å±€å•ä¾‹ä½¿ç”¨</li>
</ul>
<h3 data-id="heading-24">é¢è¯•è¦ç‚¹é€ŸæŸ¥</h3>
<ol>
<li>
<p><strong>ViewModelå¦‚ä½•åœ¨å±å¹•æ—‹è½¬åå­˜æ´»ï¼Ÿ</strong></p>
<ul>
<li>é€šè¿‡<code>onRetainNonConfigurationInstance()</code>ä¿å­˜<code>ViewModelStore</code></li>
<li>æ–°Activityä»<code>getLastNonConfigurationInstance()</code>æ¢å¤</li>
</ul>
</li>
<li>
<p><strong>ViewModelå’ŒLiveDataçš„åŒºåˆ«ï¼Ÿ</strong></p>
<ul>
<li>ViewModelï¼šå­˜å‚¨å’Œç®¡ç†UIç›¸å…³æ•°æ®</li>
<li>LiveDataï¼šå¯è§‚å¯Ÿçš„æ•°æ®æŒæœ‰è€…ï¼Œå…·æœ‰ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</li>
</ul>
</li>
<li>
<p><strong>å¦‚ä½•é¿å…ViewModelå†…å­˜æ³„æ¼ï¼Ÿ</strong></p>
<ul>
<li>ä½¿ç”¨Application Context</li>
<li>ä½¿ç”¨viewModelScopeç®¡ç†åç¨‹</li>
<li>åœ¨onCleared()ä¸­æ¸…ç†èµ„æº</li>
</ul>
</li>
<li>
<p><strong>ViewModelä¸onSaveInstanceStateçš„é€‚ç”¨åœºæ™¯ï¼Ÿ</strong></p>
<ul>
<li>ViewModelï¼šé…ç½®å˜æ›´ï¼Œè¾ƒå¤§çš„UIæ•°æ®</li>
<li>onSaveInstanceStateï¼šè¿›ç¨‹æ­»äº¡æ¢å¤ï¼Œå°‘é‡å…³é”®çŠ¶æ€</li>
</ul>
</li>
</ol>
<h3 data-id="heading-25">æœªæ¥å‘å±•è¶‹åŠ¿</h3>
<ol>
<li><strong>ä¸Composeæ·±åº¦é›†æˆ</strong>ï¼š<code>viewModel()</code>å‡½æ•°æˆä¸ºComposeæ ‡å‡†</li>
<li><strong>ä½œç”¨åŸŸç²¾ç»†åŒ–</strong>ï¼šNavigation Graphä½œç”¨åŸŸã€è‡ªå®šä¹‰ä½œç”¨åŸŸ</li>
<li><strong>å“åº”å¼å¢å¼º</strong>ï¼šå…¨é¢è½¬å‘StateFlow/SharedFlow</li>
<li><strong>å¤šæ¨¡å—æ”¯æŒ</strong>ï¼šHiltä½œç”¨åŸŸåœ¨åŠŸèƒ½æ¨¡å—ä¸­çš„åº”ç”¨</li>
</ol>
<p>ViewModelå·²æˆä¸ºç°ä»£Androidå¼€å‘çš„åŸºçŸ³ï¼Œç†è§£å…¶åŸç†å¹¶æŒæ¡æœ€ä½³å®è·µï¼Œå¯¹äºæ„å»ºå¥å£®ã€å¯ç»´æŠ¤çš„Androidåº”ç”¨è‡³å…³é‡è¦ã€‚éšç€Androidæ¶æ„çš„ä¸æ–­æ¼”è¿›ï¼ŒViewModelå°†ç»§ç»­åœ¨çŠ¶æ€ç®¡ç†å’Œæ¶æ„è®¾è®¡æ–¹é¢å‘æŒ¥æ ¸å¿ƒä½œç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vitest å­¦ä¹ ä¸å®è·µæ€»ç»“ï¼šåœ¨ React + TypeScript é¡¹ç›®ä¸­å¿«é€Ÿä¸Šæ‰‹å•å…ƒæµ‹è¯•]]></title>    <link>https://juejin.cn/post/7579436743259799571</link>    <guid>https://juejin.cn/post/7579436743259799571</guid>    <pubDate>2025-12-03T08:55:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579436743259799571" data-draft-id="7579438351297085476" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vitest å­¦ä¹ ä¸å®è·µæ€»ç»“ï¼šåœ¨ React + TypeScript é¡¹ç›®ä¸­å¿«é€Ÿä¸Šæ‰‹å•å…ƒæµ‹è¯•"/> <meta itemprop="keywords" content="å•å…ƒæµ‹è¯•,æµ‹è¯•"/> <meta itemprop="datePublished" content="2025-12-03T08:55:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å›½å®¶ä¸ä¿æŠ¤åºŸç‰©"/> <meta itemprop="url" content="https://juejin.cn/user/1220936035210004"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vitest å­¦ä¹ ä¸å®è·µæ€»ç»“ï¼šåœ¨ React + TypeScript é¡¹ç›®ä¸­å¿«é€Ÿä¸Šæ‰‹å•å…ƒæµ‹è¯•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1220936035210004/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å›½å®¶ä¸ä¿æŠ¤åºŸç‰©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:55:19.000Z" title="Wed Dec 03 2025 08:55:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vitest å­¦ä¹ ä¸å®è·µæ€»ç»“ï¼šåœ¨ React + TypeScript é¡¹ç›®ä¸­å¿«é€Ÿä¸Šæ‰‹å•å…ƒæµ‹è¯•</h2>
<blockquote>
<p>ä»Šå¤©æˆ‘ç”¨4ä¸ªå°æ—¶å­¦ä¹ å’Œå®è·µäº† Vitest è¿™ä¸ªå‰ç«¯æµ‹è¯•å·¥å…·ã€‚ä¸»è¦æ˜¯äº†è§£ä¸€ä¸‹å®ƒæ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç”¨ï¼Œå°¤å…¶æ˜¯æ€ä¹ˆåœ¨æˆ‘ä»¬å¸¸ç”¨çš„ React + TypeScript é¡¹ç›®é‡Œç”¨ã€‚ä¸‹é¢æ˜¯æˆ‘å­¦ä¹ çš„ä¸€ä¸ªç®€å•æ€»ç»“å’Œè®°å½•ã€‚</p>
</blockquote>
<h5 data-id="heading-1"><strong>ä¸€ã€Vitest æ˜¯ä¸ªå•¥ï¼Ÿ</strong></h5>
<p>ç®€å•æ¥è¯´ï¼ŒVitest å°±æ˜¯ä¸€ä¸ªç”¨æ¥ç»™ä»£ç åšæµ‹è¯•çš„å·¥å…·ï¼Œæ¯”å¦‚æµ‹è¯•ä¸€ä¸ªå‡½æ•°èƒ½ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæˆ–è€…ä¸€ä¸ª React ç»„ä»¶æ˜¾ç¤ºå¾—å¯¹ä¸å¯¹ã€‚</p>
<p>å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯<strong>å¿«</strong>ï¼Œè€Œä¸”å’Œ Vite é¡¹ç›®ï¼ˆæˆ‘ä»¬ç°åœ¨ç”¨çš„é¡¹ç›®æ„å»ºå·¥å…·ï¼‰æ­é…èµ·æ¥ç‰¹åˆ«æ–¹ä¾¿ï¼Œå‡ ä¹ä¸éœ€è¦åšå¤ªå¤šé¢å¤–çš„é…ç½®ã€‚</p>
<h5 data-id="heading-2"><strong>äºŒã€ä¸ºå•¥è¦ç”¨å®ƒï¼Ÿï¼ˆå®ƒçš„å¥½å¤„ï¼‰</strong></h5>
<ol>
<li><strong>é€Ÿåº¦å¿«</strong>ï¼šå› ä¸ºå®ƒç”¨åˆ°äº† Vite çš„ä¸€äº›ç‰¹æ€§ï¼Œæ¯æ¬¡è·‘æµ‹è¯•çš„æ—¶å€™å‡ ä¹ä¸éœ€è¦é‡æ–°æ‰“åŒ…ï¼Œæ‰€ä»¥æ„Ÿè§‰æµ‹è¯•è·‘èµ·æ¥é£å¿«ï¼ŒèŠ‚çœæ—¶é—´ã€‚</li>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šå¯¹äºæˆ‘ä»¬è¿™ç§ç”¨ Vite åˆ›å»ºçš„ React+TS é¡¹ç›®ï¼Œä¸ç”¨æŠ˜è…¾å¤ªå¤šé…ç½®å°±èƒ½ç›´æ¥ç”¨ï¼Œå¾ˆæ–¹ä¾¿ã€‚</li>
<li><strong>å’Œ Jest å·®ä¸å¤š</strong>ï¼šå®ƒçš„å†™æ³•å’Œç”¨æ³•å’Œå¦ä¸€ä¸ªæµè¡Œçš„æµ‹è¯•å·¥å…· Jest å¾ˆåƒï¼Œæ‰€ä»¥å¦‚æœä»¥å‰å†™è¿‡ Jestï¼Œå­¦èµ·æ¥å°±éå¸¸å®¹æ˜“ã€‚</li>
</ol>
<h5 data-id="heading-3"><strong>ä¸‰ã€åœ¨</strong> <strong>React</strong> <strong>+</strong> <strong>TypeScript</strong> <strong>é¡¹ç›®é‡Œæ€ä¹ˆç”¨ï¼Ÿ</strong></h5>
<p>æˆ‘è·Ÿç€æ•™ç¨‹å’Œæ–‡æ¡£ï¼Œå¤§æ¦‚èµ°äº†ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p>
<p><strong>1. å®‰è£…ä¸œè¥¿</strong></p>
<p>é¦–å…ˆåœ¨é¡¹ç›®é‡Œå®‰è£…äº† Vitest å’Œå¦å¤–ä¸€ä¸ªç”¨æ¥æµ‹è¯• React ç»„ä»¶çš„åº“ï¼ˆå« <code>@testing-library/react</code>ï¼‰ï¼Œå®‰è£…å‘½ä»¤å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">npm install -D vitest <span class="hljs-meta">@testing</span>-<span class="hljs-keyword">library</span>/react <span class="hljs-meta">@testing</span>-<span class="hljs-keyword">library</span>/jest-dom jsdom
</code></pre>
<p><strong>2. åˆ›å»ºé…ç½®æ–‡ä»¶</strong></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºäº†ä¸€ä¸ª <code>vitest.config.ts</code> æ–‡ä»¶ï¼Œè¿›è¡Œä¸€äº›ç®€å•é…ç½®ï¼Œå‘Šè¯‰ Vitest è¦ç”¨å“ªä¸ªç¯å¢ƒï¼ˆæ¯”å¦‚ jsdom æ¥æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vitest.config.ts</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitest/config'</span>;
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">react</span>()],
  <span class="hljs-attr">test</span>: {
    <span class="hljs-attr">environment</span>: <span class="hljs-string">'jsdom'</span>,
  },
});
</code></pre>
<p><strong>3. å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ä¾‹å­</strong></p>
<p>æˆ‘å­¦ç€ç»™ä¸€ä¸ªæœ€ç®€å•çš„ç»„ä»¶å†™æµ‹è¯•ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæŒ‰é’®ç»„ä»¶ <code>Button.tsx</code>ã€‚</p>
<ul>
<li>
<p><strong>ç»„ä»¶ä»£ç ï¼ˆButton.tsxï¼‰</strong> ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ButtonProps</span> {
  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">onClick</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">Button</span> = (<span class="hljs-params">{ text, onClick }: ButtonProps</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>{text}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
};
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>æµ‹è¯•ä»£ç ï¼ˆButton.test.tsï¼‰</strong> ï¼š</p>
</li>
</ul>
<p>åœ¨æ—è¾¹åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œç”¨æ¥æ£€æŸ¥è¿™ä¸ªç»„ä»¶èƒ½ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºæ–‡å­—ï¼Œä»¥åŠç‚¹å‡»èƒ½ä¸èƒ½ç”Ÿæ•ˆã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { describe, it, expect, vi } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitest'</span>; <span class="hljs-comment">// ä»vitestå¼•å…¥å·¥å…·</span>
<span class="hljs-keyword">import</span> { render, screen, fireEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@testing-library/react'</span>; <span class="hljs-comment">// å¼•å…¥Reactæµ‹è¯•åº“</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Button'</span>; <span class="hljs-comment">// å¼•å…¥è¦æµ‹è¯•çš„ç»„ä»¶</span>

<span class="hljs-title function_">describe</span>(<span class="hljs-string">'Button ç»„ä»¶'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”è¯¥åœ¨é¡µé¢ä¸Šæ­£ç¡®æ˜¾ç¤ºæ–‡å­—'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// 1. æ¸²æŸ“ç»„ä»¶</span>
    <span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">text</span>=<span class="hljs-string">"ç‚¹å‡»æˆ‘"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {}} /&gt;</span>);
    <span class="hljs-comment">// 2. åœ¨å±å¹•ä¸Šæ‰¾åˆ°åŒ…å«â€œç‚¹å‡»æˆ‘â€æ–‡å­—çš„å…ƒç´ </span>
    <span class="hljs-keyword">const</span> buttonElement = screen.<span class="hljs-title function_">getByText</span>(<span class="hljs-string">'ç‚¹å‡»æˆ‘'</span>);
    <span class="hljs-comment">// 3. æ–­è¨€ï¼ˆæœŸæœ›ï¼‰è¿™ä¸ªå…ƒç´ ç¡®å®åœ¨æ–‡æ¡£é‡Œ</span>
    <span class="hljs-title function_">expect</span>(buttonElement).<span class="hljs-title function_">toBeInTheDocument</span>();
  });

  <span class="hljs-title function_">it</span>(<span class="hljs-string">'ç‚¹å‡»æŒ‰é’®æ—¶åº”è¯¥è°ƒç”¨ä¼ å…¥çš„å‡½æ•°'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°ï¼Œç”¨æ¥æ£€æŸ¥å®ƒæœ‰æ²¡æœ‰è¢«è°ƒç”¨</span>
    <span class="hljs-keyword">const</span> mockClick = vi.<span class="hljs-title function_">fn</span>();
    <span class="hljs-comment">// 2. æ¸²æŸ“ç»„ä»¶</span>
    <span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">text</span>=<span class="hljs-string">"ç‚¹å‡»æˆ‘"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{mockClick}</span> /&gt;</span></span>);
    <span class="hljs-comment">// 3. æ‰¾åˆ°æŒ‰é’®</span>
    <span class="hljs-keyword">const</span> buttonElement = screen.<span class="hljs-title function_">getByText</span>(<span class="hljs-string">'ç‚¹å‡»æˆ‘'</span>);
    <span class="hljs-comment">// 4. æ¨¡æ‹Ÿä¸€æ¬¡ç‚¹å‡»äº‹ä»¶</span>
    fireEvent.<span class="hljs-title function_">click</span>(buttonElement);
    <span class="hljs-comment">// 5. æ–­è¨€ï¼ˆæœŸæœ›ï¼‰æˆ‘ä»¬ä¼ å…¥çš„æ¨¡æ‹Ÿå‡½æ•°è¢«è°ƒç”¨äº†ä¸€æ¬¡</span>
    <span class="hljs-title function_">expect</span>(mockClick).<span class="hljs-title function_">toHaveBeenCalledTimes</span>(<span class="hljs-number">1</span>);
  });
});
</code></pre>
<p><strong>4. è¿è¡Œæµ‹è¯•</strong></p>
<p>æœ€ååœ¨ <code>package.json</code> é‡ŒåŠ ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶åè¿è¡Œå®ƒå°±èƒ½çœ‹åˆ°æµ‹è¯•ç»“æœäº†ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// package.json</span>
<span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitest"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åœ¨ç»ˆç«¯é‡Œè·‘å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npm run test
</code></pre>
<p>å¦‚æœæµ‹è¯•é€šè¿‡äº†ï¼Œç»ˆç«¯é‡Œå°±ä¼šæ˜¾ç¤ºç»¿è‰²çš„å¯¹å‹¾ï¼Œå‘Šè¯‰ä½ æ‰€æœ‰æµ‹è¯•éƒ½æˆåŠŸäº†ï¼Œçœ‹ç€å¾ˆæœ‰æˆå°±æ„Ÿã€‚</p>
<h5 data-id="heading-4">å››ã€å¯¹äºç»„ä»¶æ¥è¯´ï¼Œåº”è¯¥æµ‹è¯•å“ªäº›æ–¹é¢ï¼Ÿ</h5>
<blockquote>
<p>åƒç”¨æˆ·ä¸€æ ·æ€è€ƒ</p>
</blockquote>





























<table><thead><tr><th>æµ‹è¯•ç±»å‹</th><th>å…³é”®é—®é¢˜</th></tr></thead><tbody><tr><td>âœ… æ¸²æŸ“æµ‹è¯•</td><td>ç”¨æˆ·çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ</td></tr><tr><td>âœ… äº¤äº’æµ‹è¯•</td><td>ç”¨æˆ·æ“ä½œåå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</td></tr><tr><td>âœ… Props æµ‹è¯•</td><td>ä¸åŒè¾“å…¥ä¸‹è¡Œä¸ºæ˜¯å¦æ­£ç¡®ï¼Ÿ</td></tr><tr><td>âœ… æ¡ä»¶æ¸²æŸ“</td><td>å†…å®¹æ˜¯å¦åœ¨æ­£ç¡®æ—¶æœºæ˜¾ç¤º/éšè—ï¼Ÿ</td></tr><tr><td>âœ… å¼‚æ­¥æµ‹è¯•</td><td>æ•°æ®åŠ è½½å UI æ˜¯å¦æ›´æ–°ï¼Ÿ</td></tr></tbody></table>
<ul>
<li>
<p><code>@testing-library/react</code>ï¼šç”¨äºæ¸²æŸ“å’ŒæŸ¥è¯¢</p>
</li>
<li>
<p><code>@testing-library/jest-dom</code>ï¼šæä¾›Â <code>toBeInTheDocument()</code>Â ç­‰æ–­è¨€</p>
</li>
<li>
<p><code>vi.fn()</code>Â /Â <code>vi.spyOn()</code>ï¼šæ¨¡æ‹Ÿå‡½æ•°</p>
</li>
<li>
<p><code>waitFor</code>Â /Â <code>findBy</code>ï¼šå¤„ç†å¼‚æ­¥</p>
</li>
<li>
<p><code>userEvent</code>ï¼ˆæ¯”Â <code>fireEvent</code>Â æ›´çœŸå®ï¼‰</p>
<ul>
<li/>
</ul>
</li>
</ul>
<p><strong>å…·ä½“åœºæ™¯</strong></p>

































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæµ‹è¯•æ–¹å¼</th></tr></thead><tbody><tr><td>æŒ‰é’®ã€è¾“å…¥æ¡†ã€å¡ç‰‡ç­‰ UI ç»„ä»¶</td><td>æµ‹è¯•æ¸²æŸ“ + äº¤äº’</td></tr><tr><td>è¡¨å•ç»„ä»¶</td><td>æµ‹è¯•è¾“å…¥ã€éªŒè¯ã€æäº¤</td></tr><tr><td>æ¨¡æ€æ¡†ã€ä¸‹æ‹‰èœå•</td><td>æµ‹è¯•æ˜¾ç¤º/éšè—ã€ç‚¹å‡»é®ç½©å…³é—­</td></tr><tr><td>åˆ—è¡¨ç»„ä»¶</td><td>æµ‹è¯•æ•°æ®æ¸²æŸ“ã€ç©ºçŠ¶æ€ã€åŠ è½½çŠ¶æ€</td></tr><tr><td>å®¹å™¨ç»„ä»¶ï¼ˆå¸¦é€»è¾‘ï¼‰</td><td>æ¨¡æ‹Ÿ APIï¼Œæµ‹è¯•æ•°æ®æµ</td></tr><tr><td>è‡ªå®šä¹‰ Hook</td><td>å•ç‹¬æµ‹è¯• Hook è¡Œä¸ºï¼ˆç”¨Â <code>renderHook</code>ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-5"><strong>å››ã€æ€»ç»“</strong></h5>
<p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘æ„Ÿè§‰ Vitest <strong>ç¡®å®å¾ˆç®€å•æ˜“ç”¨</strong>ï¼Œé…ç½®èµ·æ¥ä¸éº»çƒ¦ï¼Œå†™æµ‹è¯•çš„è¯­æ³•ä¹Ÿå¾ˆæ¸…æ™°ã€‚å¯¹äºæˆ‘ä»¬ç°åœ¨çš„é¡¹ç›®æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆäºŒï¼‰]]></title>    <link>https://juejin.cn/post/7579313396207353871</link>    <guid>https://juejin.cn/post/7579313396207353871</guid>    <pubDate>2025-12-03T08:55:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579313396207353871" data-draft-id="7579298511071985664" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆäºŒï¼‰"/> <meta itemprop="keywords" content="HarmonyOS,ArkUI,ArkTS"/> <meta itemprop="datePublished" content="2025-12-03T08:55:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Huangå…„"/> <meta itemprop="url" content="https://juejin.cn/user/52404619842712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSåº”ç”¨å¼€å‘è€…çš„å®è—APP-HMOSä»£ç å·¥åŠ-ç»„ä»¶å †å æ»‘åŠ¨æŠ˜å æ•ˆæœï¼ˆäºŒï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52404619842712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Huangå…„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:55:05.000Z" title="Wed Dec 03 2025 08:55:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†ç»„ä»¶å †å æ•ˆæœçš„æ¨¡å—åˆ’åˆ†å’Œå®ç°æ€è·¯ï¼Œå¹¶ä¸”å®ç°äº†å‰ä¸¤ä¸ªæœ€ç®€å•çš„éƒ¨åˆ†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å®ç°å‰©ä½™éƒ¨åˆ†</p>
<h2 data-id="heading-1">ç¬¬ä¸‰éƒ¨åˆ†ç‰©å“æ </h2>
<p>ç”±äºå‘ä¸Šæ»‘åŠ¨çš„æ—¶å€™éœ€è¦åº•éƒ¨ç¬¬å››éƒ¨åˆ†çš„å•†å“åˆ—è¡¨éœ€è¦è¢«ç¬¬ä¸‰éƒ¨åˆ†é®ç›–ï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨Stackæ¥åšçˆ¶å¸ƒå±€ï¼Œä½¿ç”¨<code>zIndex</code>å±æ€§æ¥è°ƒæ•´Zè½´å±‚çº§æ¥å®ç°è¦†ç›–æ•ˆæœã€‚</p>
<h3 data-id="heading-2">åŸºç¡€å¸ƒå±€</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Stack</span>({<span class="hljs-attr">alignContent</span>:<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>}) {
      <span class="hljs-title class_">Row</span>(){
        <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">"app.media.user_portrait"</span>))
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">15</span>)
        <span class="hljs-title class_">Blank</span>().<span class="hljs-title function_">height</span>(<span class="hljs-number">0</span>)
        <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">"app.media.stack_scan"</span>))
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)

      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">15</span>,<span class="hljs-attr">right</span>:<span class="hljs-number">15</span>})

      <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">outSideScrollController</span>){
        <span class="hljs-title class_">Column</span>(){
          <span class="hljs-comment">//æœç´¢æ¡†</span>
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.search'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">20</span>)
              .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })

            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æœç´¢æç¤ºè¯­'</span>)
              .<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.6</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span> })
          }
          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">searchAreaHeight</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">(<span class="hljs-params">_</span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getPromptAction</span>().<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">"è·³è½¬åˆ°æœç´¢é¡µé¢"</span> })
          })
          <span class="hljs-title class_">Stack</span>({<span class="hljs-attr">alignContent</span>:<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>}){
            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span>){
              <span class="hljs-title class_">Row</span>(){
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">"æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              }.<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            }<span class="hljs-keyword">else</span>{
              <span class="hljs-title class_">Row</span>(){
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">"ä¸å¯æ»‘åŠ¨å¸ƒå±€"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              }.<span class="hljs-title function_">height</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            }
            <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>){
              <span class="hljs-title class_">Column</span>(){
                <span class="hljs-title class_">Row</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">10</span>}){
                  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"åˆ†ç±»1"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
                  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"åˆ†ç±»2"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
                  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"åˆ†ç±»3"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
                  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"åˆ†ç±»4"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
                  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"åˆ†ç±»5"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
                }.<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span>)
                <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fakeProduct</span>,<span class="hljs-function">(<span class="hljs-params">item:<span class="hljs-built_in">string</span>,index:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
                  <span class="hljs-title class_">ListItem</span>(){
                    <span class="hljs-title class_">Row</span>(){
                      <span class="hljs-title class_">Text</span>(item)
                    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
                  }
                })
              }

            }.<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
              <span class="hljs-keyword">let</span> yOffset = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span>
              <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}
            })
          }
        }.<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-number">50</span>}).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
      }.<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">15</span>,<span class="hljs-attr">right</span>:<span class="hljs-number">15</span>}).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
      .<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset:<span class="hljs-built_in">number</span>,state:ScrollState</span>)=&gt;</span>{
        <span class="hljs-keyword">let</span> yOffset = <span class="hljs-variable language_">this</span>.<span class="hljs-property">outSideScrollController</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">searchAreaHeight</span> = <span class="hljs-number">100</span> - yOffset * <span class="hljs-number">0.6</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}
      })
    }.<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#f1f1f1"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
  }
</code></pre>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed17992fff4449e3b8bd4b6231110819~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356905&amp;x-signature=YbECBgNriGxGl%2FpqVtRszfkCnBM%3D" width="45%" loading="lazy"/>
<h3 data-id="heading-3">æ»‘åŠ¨å†²çª</h3>
<p>å‘ç°äº†ä¸¤ä¸ªä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>åµŒå¥—æ»‘åŠ¨çš„æ»‘åŠ¨å†²çª<br/>
ä»å›¾ä¸Šæ¥çœ‹ï¼Œå½“æ‰‹æŒ‡åœ¨å†…éƒ¨çš„Scrollæ»‘åŠ¨æ—¶åªèƒ½æ»‘åŠ¨å†…éƒ¨çš„Scrollï¼Œåœ¨å¤–éƒ¨Scrollæ»‘åŠ¨æ—¶ï¼Œåªèƒ½æ»‘åŠ¨å¤–éƒ¨çš„Scrollï¼Œè¿™å’Œæˆ‘ä»¬çš„éœ€æ±‚ä¸ç¬¦åˆã€‚</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†çš„ç‰©å“å¡ç‰‡æ²¡æœ‰å±•ç¤ºå‡ºæ¥ã€‚</li>
</ol>
<p>å¯¹äºé—®é¢˜1æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>nestedScroll</code>å±æ€§æ¥è§£å†³ã€‚<br/>
å¯¹äºé—®é¢˜2æˆ‘ä»¬å¯ä»¥å¯¹å†…éƒ¨<code>Scroll</code>çš„ç›´æ¥å­ç»„ä»¶<code>Colum</code>åŠ ä¸ª<code>margin</code>å±æ€§è§£å†³ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">            <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>){
              <span class="hljs-title class_">Column</span>(){
              <span class="hljs-comment">//åˆ†ç±»</span>
                <span class="hljs-title class_">Row</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">10</span>}){
}.<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
                <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fakeProduct</span>,<span class="hljs-function">(<span class="hljs-params">item:<span class="hljs-built_in">string</span>,index:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
                  <span class="hljs-title class_">ListItem</span>(){
                    <span class="hljs-title class_">Row</span>(){
                      <span class="hljs-title class_">Text</span>(item)
                    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
                  }
                })
              }
<span class="hljs-comment">//å’Œé¡¶éƒ¨çš„è·ç¦»ä¸ºç¬¬ä¸‰éƒ¨åˆ†ç‰©å“å¡ç‰‡çš„é«˜åº¦</span>
.<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-number">200</span>})

            }.<span class="hljs-title function_">nestedScroll</span>({
              <span class="hljs-attr">scrollForward</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">PARENT_FIRST</span>,
              <span class="hljs-attr">scrollBackward</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">SELF_FIRST</span>
            })
</code></pre>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4cf79145e0c4e3eac0962f5846ac5cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356905&amp;x-signature=A5R%2F4HTAOuuLw7KaFnv5OiR8sDU%3D" width="45%" loading="lazy"/>
ç°åœ¨æ¥çœ‹æ•ˆæœå°±æ­£å¸¸äº†ã€‚  
<h3 data-id="heading-4">ç‰©å“å¡ç‰‡é€æ˜åº¦æ•ˆæœ</h3>
<p>ä¸ºäº†æ–¹ä¾¿åé¢çš„è®¡ç®—ï¼Œæˆ‘ä»¬å®šä¹‰å‡ ä¸ªå¸¸é‡å’Œå˜é‡</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SEARCH_AREA_HEIGHT</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ITEM_CARDS_AREA_HEIGHT</span> = <span class="hljs-number">200</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">HORIZONTAL_LIST_HEIGHT</span> = <span class="hljs-number">100</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-attr">outSideScrollController</span>:<span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()
  <span class="hljs-attr">inSideScrollController</span>:<span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()

  <span class="hljs-meta">@State</span> <span class="hljs-attr">searchAreaHeight</span>:<span class="hljs-built_in">number</span> = <span class="hljs-variable constant_">SEARCH_AREA_HEIGHT</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">showHorizontalList</span>:<span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>

  <span class="hljs-meta">@State</span> <span class="hljs-attr">itemCardsAreaOpacity</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">horizontalListOpacity</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">classifyAreaOpacity</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>
</code></pre>
<p>ç„¶ååœ¨<code>æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨</code>ã€ <code>ä¸å¯æ»‘åŠ¨å¸ƒå±€</code>å’Œ<code>åˆ†ç±»</code>ä¸Šæ·»åŠ ä¸é€æ˜åº¦å±æ€§ã€‚
åœ¨å†…éƒ¨Scrollçš„<code>onScrollFrameBegin</code>äº‹ä»¶çš„å›è°ƒä¸­ï¼Œè·å–æ»‘åŠ¨è·ç¦»å¹¶ä¸”è®¡ç®—ä¸é€æ˜åº¦å±æ€§</p>
<pre><code class="hljs language-typescript" lang="typescript">          <span class="hljs-title class_">Stack</span>({<span class="hljs-attr">alignContent</span>:<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>}){
            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span>){
              <span class="hljs-title class_">Row</span>(){
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">"æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              }.<span class="hljs-title function_">zIndex</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">height</span>(<span class="hljs-variable constant_">HORIZONTAL_LIST_HEIGHT</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListOpacity</span>)<span class="hljs-comment">//æ·»åŠ ä¸é€æ˜åº¦å±æ€§</span>
            }<span class="hljs-keyword">else</span>{
              <span class="hljs-title class_">Row</span>(){
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">"ä¸å¯æ»‘åŠ¨å¸ƒå±€"</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              }.<span class="hljs-title function_">height</span>(<span class="hljs-variable constant_">ITEM_CARDS_AREA_HEIGHT</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemCardsAreaOpacity</span>)<span class="hljs-comment">//æ·»åŠ ä¸é€æ˜åº¦å±æ€§</span>
            }
            <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>){
              <span class="hljs-title class_">Column</span>(){
              <span class="hljs-comment">//åˆ†ç±»</span>
                <span class="hljs-title class_">Row</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">10</span>}){
                }.<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">classifyAreaOpacity</span>)<span class="hljs-comment">//æ·»åŠ ä¸é€æ˜åº¦å±æ€§</span>
                <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fakeProduct</span>,<span class="hljs-function">(<span class="hljs-params">item:<span class="hljs-built_in">string</span>,index:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
                  <span class="hljs-title class_">ListItem</span>(){
                    <span class="hljs-title class_">Row</span>(){
                      <span class="hljs-title class_">Text</span>(item)
                    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
                  }
                })
              }.<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-variable constant_">ITEM_CARDS_AREA_HEIGHT</span>})

            }.<span class="hljs-title function_">nestedScroll</span>({
              <span class="hljs-attr">scrollForward</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">PARENT_FIRST</span>,
              <span class="hljs-attr">scrollBackward</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">SELF_FIRST</span>
            }).<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
              <span class="hljs-keyword">let</span> yOffset = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span>
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`inSideScroll <span class="hljs-subst">${yOffset}</span>`</span>)

             <span class="hljs-keyword">let</span> maxDiff = <span class="hljs-variable constant_">ITEM_CARDS_AREA_HEIGHT</span> - <span class="hljs-variable constant_">HORIZONTAL_LIST_HEIGHT</span>
             <span class="hljs-keyword">let</span> diff =maxDiff - yOffset
             <span class="hljs-comment">//æ»‘åŠ¨å…·ä½“è¶…è¿‡äºŒè€…çš„å·®å€¼ï¼Œåˆ™å±•ç¤ºæ¨ªå‘æ»‘åŠ¨åˆ—è¡¨ï¼›å¦åˆ™å±•ç¤ºç‰©å“å¡ç‰‡</span>
              <span class="hljs-keyword">if</span>(diff&gt;= <span class="hljs-number">0</span>){
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemCardsAreaOpacity</span> = diff/maxDiff
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">classifyAreaOpacity</span> = diff/maxDiff
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span> =<span class="hljs-literal">false</span>
              }<span class="hljs-keyword">else</span>{
              	<span class="hljs-comment">//æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨çš„ä¸é€æ˜åº¦</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListOpacity</span> = -diff/maxDiff
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span> = <span class="hljs-literal">true</span>
              }
              <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}
            })
          }
</code></pre>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3f73097ea224fc5b7326412777833f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356905&amp;x-signature=SsyXAfCO4zGPZPwuaK%2FpEZBx7T8%3D" width="45%" loading="lazy"/>
<p>æ•ˆæœçœ‹èµ·æ¥ä¹Ÿè¿˜å¯ä»¥ï¼Œæˆ‘ä»¬æ›¿æ¢ä¸€ä¸‹ç´ æçœ‹çœ‹</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3a043cf8d0a4a30846baa8190452e7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356905&amp;x-signature=snc8U0OV3%2FPoGxg7UAxnNhJPHjk%3D" width="45%" loading="lazy"/>
<h2 data-id="heading-5">ç¬¬å››éƒ¨åˆ†</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°åº•éƒ¨ç¬¬å››éƒ¨åˆ†çš„åˆ†ç±»ç¼©æ”¾å’Œæ¨ªå‘æ»‘åŠ¨åˆ—è¡¨çš„é—´è·å˜åŒ–ã€‚</p>
<h3 data-id="heading-6">åˆ†ç±»</h3>
<p>è¿™é‡Œæˆ‘ä»¬åšçš„ç®€å•ç‚¹ï¼Œåˆ†ç±»é¡¹çš„ç¼©æ”¾å€¼å’Œä¸é€æ˜åº¦å–ç›¸åŒå€¼ï¼Œå°±ä¸å†é¢å¤–è®¡ç®—äº†ã€‚å¦‚æœéœ€è¦ä¿®æ”¹æ•ˆæœï¼Œæ ¹æ®æ»‘åŠ¨åç§»é‡é‡æ–°è®¡ç®—ä¸€ä¸ªå€¼å°±å¥½äº†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"> <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {
   <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_gallery_puzzle'</span>)).<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
     .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)
     .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Contain</span>)
   <span class="hljs-title class_">Text</span>(<span class="hljs-string">"æ‹¼å›¾"</span>)
     .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
     .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
     .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
 }
 .<span class="hljs-title function_">scale</span>({<span class="hljs-attr">x</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">classifyAreaOpacity</span>,<span class="hljs-attr">y</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">classifyAreaOpacity</span>})
 .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
 .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)

</code></pre>
<p>è¿™é‡Œæ˜¯å…¶ä¸­ä¸€ä¸ªåˆ†ç±»é¡¹çš„å¸ƒå±€</p>
<h3 data-id="heading-7">æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨</h3>
<p>æ¨ªå‘æ»‘åŠ¨åˆ—è¡¨åˆšå‡ºç°æ—¶ï¼Œåˆ—è¡¨é¡¹é—´è·æ˜¯æœ€å¤§çš„ï¼Œéšç€å‘ä¸Šæ»‘åŠ¨ï¼Œåˆ—è¡¨é¡¹é—´è·é€æ¸å˜å°ï¼Œæœ€ç»ˆå›ºå®šä¸ºä¸€ä¸ªæœ€å°å€¼ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®æœ€å¤§é—´è·ä¸º<strong>50</strong>ï¼Œæœ€å°é—´è·ä¸º<strong>10</strong>ã€‚åŒæ ·çš„åœ¨å†…éƒ¨<code>Scroll</code>çš„<code>onScrollFrameBegin</code>çš„å›è°ƒä¸­è¿›è¡Œè®¡ç®—</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">MIN_HORIZONTAL_LIST_SPACE</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">MAX_HORIZONTAL_LIST_SPACE</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>
</code></pre>
<p>é—´è·åˆå§‹å€¼ä¸ºæœ€å¤§é—´è·</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@State</span> <span class="hljs-attr">horizontalListSpace</span>:<span class="hljs-built_in">number</span>= <span class="hljs-variable constant_">MAX_HORIZONTAL_LIST_SPACE</span>
</code></pre>
<p>é‡æ–°å†™ä¸€ä¸‹å¸ƒå±€ï¼Œç›´æ¥æ›¿æ¢ä¸ºç´ æã€‚è¿™é‡Œçš„<code>FakeHorizontalData</code>æ˜¯è‡ªå®šä¹‰æ•°æ®ç±»ï¼ŒåŒ…å«<code>name</code>å’Œ<code>icon</code>å±æ€§ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span>){
  <span class="hljs-title class_">Scroll</span>(){
    <span class="hljs-title class_">Row</span>({<span class="hljs-attr">space</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListSpace</span>}){
      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fakeHorizontalDataList</span>,<span class="hljs-function">(<span class="hljs-params">item:FakeHorizontalData,index:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
        <span class="hljs-title class_">Column</span>(){
          <span class="hljs-title class_">Image</span>(item.<span class="hljs-property">icon</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>).<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)
            .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Contain</span>)
          <span class="hljs-title class_">Blank</span>().<span class="hljs-title function_">width</span>(<span class="hljs-number">15</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">0</span>)
          <span class="hljs-title class_">Text</span>(item.<span class="hljs-property">name</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        }.<span class="hljs-title function_">width</span>(<span class="hljs-number">80</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">90</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
      })
    }.<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
  }.<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Horizontal</span>).<span class="hljs-title function_">zIndex</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">height</span>(<span class="hljs-variable constant_">HORIZONTAL_LIST_HEIGHT</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListOpacity</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#f1f1f1"</span>)

}
</code></pre>
<h3 data-id="heading-8">è®¡ç®—å¯¹åº”çš„å±æ€§å€¼</h3>
<p>åœ¨å†…éƒ¨<code>Scroll</code>çš„<code>onScrollFrameBegin</code>çš„å›è°ƒä¸­è¿›è¡Œè®¡ç®—</p>
<pre><code class="hljs language-typescript" lang="typescript">.<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset:<span class="hljs-built_in">number</span></span>)=&gt;</span>{
   <span class="hljs-keyword">let</span> yOffset = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inSideScrollController</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span>
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`inSideScroll <span class="hljs-subst">${yOffset}</span>`</span>)

  <span class="hljs-keyword">let</span> maxDiff = (<span class="hljs-variable constant_">ITEM_CARDS_AREA_HEIGHT</span> - <span class="hljs-variable constant_">HORIZONTAL_LIST_HEIGHT</span>)
  <span class="hljs-keyword">let</span> diff =maxDiff - yOff<span class="hljs-keyword">set</span>
   <span class="hljs-title function_">if</span>(<span class="hljs-params">diff&gt;= <span class="hljs-number">0</span></span>){
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemCardsAreaOpacity</span> = diff/maxDiff
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">classifyAreaOpacity</span> = diff/maxDiff
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span> =<span class="hljs-literal">false</span>
   }<span class="hljs-keyword">else</span>{
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListOpacity</span> = -diff/maxDiff
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">showHorizontalList</span> = <span class="hljs-literal">true</span>


     <span class="hljs-keyword">let</span> <span class="hljs-attr">calcSpace</span>:<span class="hljs-built_in">number</span> = <span class="hljs-variable constant_">MAX_HORIZONTAL_LIST_SPACE</span> + diff
     <span class="hljs-keyword">if</span>(calcSpace &gt; <span class="hljs-variable constant_">MIN_HORIZONTAL_LIST_SPACE</span>){
       <span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListSpace</span> = calcSpace
     }<span class="hljs-keyword">else</span>{
       <span class="hljs-variable language_">this</span>.<span class="hljs-property">horizontalListSpace</span> = <span class="hljs-variable constant_">MIN_HORIZONTAL_LIST_SPACE</span>
     }

   }
   <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}
 })
</code></pre>
<p>æ¥çœ‹ä¸‹æ•ˆæœ <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11b6b8a07cf24b8298261dfd18a65f1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356905&amp;x-signature=%2F4vpqz32IGanNjSIqn%2BL4Fi5VSY%3D" width="45%" loading="lazy"/>
è¿™æ ·æˆ‘ä»¬å°±å¤§è‡´å¤åˆ»äº†<code>HMOSä»£ç å·¥åŠ</code>åº”ç”¨ä¸­çš„ç»„ä»¶å †å æ•ˆæœã€‚</p>
<p>æœ€ä¸‹é¢çš„å•†å“åˆ—è¡¨æ²¡æœ‰å®ç°ï¼Œæ²¡å•¥éš¾åº¦ï¼Œè‡ªå·±æ›¿æ¢ä¸€ä¸‹å°±å¥½äº†</p>
<h2 data-id="heading-9">åè®°</h2>
<p><code>HMOSä»£ç å·¥åŠ</code>çš„ç»„ä»¶å †å æ•ˆæœæºç åœ¨è¿™é‡Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fharmonyos_samples%2Fcomponent-stack" target="_blank" title="https://gitee.com/harmonyos_samples/component-stack" ref="nofollow noopener noreferrer">gitee.com/harmonyos_sâ€¦</a></p>
<p>è‡ªå·±å®ç°çš„æ•ˆæœåœ¨è¿™é‡Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2Fhuangyuan_xuan%2FHelloArkUI%2Fblob%2Fmain%2Fentry%2Fsrc%2Fmain%2Fets%2Fpages%2Fplayground%2FComponentStackPage.ets" target="_blank" title="https://gitcode.com/huangyuan_xuan/HelloArkUI/blob/main/entry/src/main/ets/pages/playground/ComponentStackPage.ets" ref="nofollow noopener noreferrer">gitcode.com/huangyuan_xâ€¦</a></p>
<p>å¯¹æ¯”ä»£ç åå‘ç°ï¼Œ<code>HMOSä»£ç å·¥åŠ</code>ä¸­å¯¹äºç¬¬ä¸‰éƒ¨åˆ†å®ç°æ˜¯ä½¿ç”¨<code>GridCol</code>å’Œ<code>GridRow</code>è¿›è¡Œå®ç°çš„ã€‚æ»‘åŠ¨æ—¶çš„æ•ˆæœä¹Ÿæ¯”è¾ƒèˆ’æœï¼Œè‡ªå·±å®ç°çš„æ»‘åŠ¨æ•ˆæœè¿˜éœ€è¦è¿›è¡Œæ•°å€¼ä¸Šçš„è°ƒæ•´ã€‚
ä¸è¿‡å¤§ä½“æ¥çœ‹ï¼Œæ•ˆæœè¿˜ç®—å¯ä»¥</p>
<hr/>
<p>ã€ æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¯·å…³æ³¨å…¬ä¼—å·ï¼šã€åç§°ï¼šHarmonyOSå¼€å‘è€…æŠ€æœ¯ï¼ŒIDï¼šHarmonyOS_Devã€‘ï¼›ä¹Ÿæ¬¢è¿åŠ å…¥é¸¿è’™å¼€å‘è€…äº¤æµç¾¤ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fgm%2F48f89e7a4c10206e053e01ad124004a0%25E3%2580%2591" target="_blank" title="https://work.weixin.qq.com/gm/48f89e7a4c10206e053e01ad124004a0%E3%80%91" ref="nofollow noopener noreferrer">work.weixin.qq.com/gm/48f89e7aâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[chen-er ä¸“ä¸ºChenå¼ERå›¾æ‰“é€ çš„npmåŒ…]]></title>    <link>https://juejin.cn/post/7579451710302076954</link>    <guid>https://juejin.cn/post/7579451710302076954</guid>    <pubDate>2025-12-03T08:55:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579451710302076954" data-draft-id="7579427549471539246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="chen-er ä¸“ä¸ºChenå¼ERå›¾æ‰“é€ çš„npmåŒ…"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-03T08:55:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å§“ç‹è€…"/> <meta itemprop="url" content="https://juejin.cn/user/1795939693507712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            chen-er ä¸“ä¸ºChenå¼ERå›¾æ‰“é€ çš„npmåŒ…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1795939693507712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å§“ç‹è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:55:22.000Z" title="Wed Dec 03 2025 08:55:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ecd8bc17d5482891d338cd9b35e8af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aeT546L6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765356961&amp;x-signature=PzI67k67cONcyLj0w8w%2FB%2FnfFjc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>ç°ä»£ Web çš„å„ç§å›¾å½¢åº“åŸºæœ¬ä¸Šéƒ½é»˜è®¤å­˜åœ¨ <strong>ER å›¾</strong> æ¸²æŸ“ï¼Œå°¤å…¶æ˜¯ <strong>Mermaid</strong> è¿™ç§â€œæ–‡æœ¬åˆ°å›¾å½¢â€æ›´æ˜¯ä¸ä¾‹å¤–ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œè¿™äº›å›¾å½¢åº“å®Œå…¨éƒ½æ˜¯æŒ‰ç…§ <strong>Crow's Foot æ–¹æ³•</strong></p>
<blockquote>
<p>Crow's Foot æ–¹æ³•ï¼ˆä¹Ÿç§° "ä¹Œé¸¦è„šè¡¨ç¤ºæ³•"ï¼‰æ˜¯ä¸€ç§ç”¨äºæ•°æ®åº“è®¾è®¡çš„å®ä½“ - å…³ç³» (ER) å›¾å¯è§†åŒ–è¡¨ç¤ºæ–¹æ³•ï¼Œä»¥å…¶è¡¨ç¤º "å¤š" å…³ç³»çš„ç‹¬ç‰¹ä¸‰åˆ†æ”¯ç¬¦å·ï¼ˆç±»ä¼¼é¸Ÿçˆªï¼‰å¾—åã€‚å®ƒæ˜¯æ•°æ®åº“è®¾è®¡ä¸­æœ€æµè¡Œçš„ ER è¡¨ç¤ºæ³•ä¹‹ä¸€ï¼Œå¹¿æ³›åº”ç”¨äºè½¯ä»¶å·¥ç¨‹ã€ä¿¡æ¯å·¥ç¨‹å’Œæ•°æ®åº“å»ºæ¨¡é¢†åŸŸã€‚</p>
</blockquote>
<p>æ¥å†™çš„ï¼Œä½†å­¦æ ¡æ˜¯æŒ‰ç…§ <strong>Chen's Notation</strong>ï¼Œä¹Ÿå°±æ˜¯ç»å…¸çš„ <strong>è±å½¢å…³ç³»ã€æ¤­åœ†å±æ€§ã€çŸ©å½¢å®ä½“</strong></p>
<blockquote>
<p>Chen è¡¨ç¤ºæ³•ï¼ˆä¹Ÿç§° â€œé™ˆå¼ ER è¡¨ç¤ºæ³•â€ï¼‰æ˜¯ç”±åè£”è®¡ç®—æœºç§‘å­¦å®¶é™ˆå“å±±ï¼ˆPeter Pin-Shan Chenï¼‰ äº 1976 å¹´åœ¨ã€ŠACM Transactions on Database Systemsã€‹å‘è¡¨çš„ã€ŠThe Entity-Relationship Modelâ€”Toward a Unified View of Dataã€‹ä¸­é¦–æ¬¡æå‡ºçš„å®ä½“ - å…³ç³»ï¼ˆERï¼‰æ¨¡å‹å¯è§†åŒ–è§„èŒƒï¼Œæ˜¯åŸå§‹ ER æ¨¡å‹çš„å®˜æ–¹è¡¨ç¤ºæ³•ï¼Œä¹Ÿæ˜¯æ•°æ®åº“å»ºæ¨¡ã€è½¯ä»¶å·¥ç¨‹æ•™å­¦ä¸­æœ€ç»å…¸çš„ ER å¯è§†åŒ–èŒƒå¼ã€‚</p>
</blockquote>
<p>ä¸ªäººæ¥è®²ï¼Œ<strong>ER å›¾</strong> è¡¨ç¤ºæ³•æ˜¯æˆ‘åœ¨å­¦æ ¡çš„æ•°æ®åº“è¯¾ä¸­å­¦æ¥çš„ã€‚ä¸ºäº†æ–¹ä¾¿è‡ªå·±å¿«é€Ÿä»æ–‡æœ¬ç»˜åˆ¶ <strong>ER å›¾</strong>ï¼ˆå°±åƒ <strong>Mermaid</strong> é‚£æ ·ï¼‰è€Œä¸æ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…·æ‰‹åŠ¨æ‹–æ‹½æ‹¼å‡‘é‚£æ ·<strong>ç¹çéº»çƒ¦</strong></p>
<p>é‚£ä¹ˆä½œä¸º<strong>è®¡ç®—æœºå­¦ç”Ÿ</strong>ï¼Œå‘ç°ç½‘ä¸Šç¼ºå°‘è¿™æ ·çš„å®ç°ï¼Œä¸å…å¿ƒç—’ï¼Œäºæ˜¯å°±è¯ç”Ÿäº†ä¸‹é¢çš„ <strong>npm åŒ…</strong></p>
<h2 data-id="heading-1">chen-er</h2>
<p>github/chen-er: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxingwangzhe%2Fchen-er%2F" target="_blank" title="https://github.com/xingwangzhe/chen-er/" ref="nofollow noopener noreferrer">github.com/xingwangzheâ€¦</a></p>
<p>npm/chen-er: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fchen-er" target="_blank" title="https://www.npmjs.com/package/chen-er" ref="nofollow noopener noreferrer">www.npmjs.com/package/cheâ€¦</a></p>
<p>åœ¨çº¿ä½“éªŒï¼ï¼ï¼: <a href="https://link.juejin.cn?target=https%3A%2F%2Fcodesandbox.io%2Fp%2Fsandbox%2Fm248ws" target="_blank" title="https://codesandbox.io/p/sandbox/m248ws" ref="nofollow noopener noreferrer">codesandbox.io/p/sandbox/mâ€¦</a></p>
<p>chen-er æ˜¯åŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fpeggyjs.org%2F" target="_blank" title="https://peggyjs.org/" ref="nofollow noopener noreferrer">Peggy</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fecharts.apache.org%2Fzh%2Findex.html" target="_blank" title="https://echarts.apache.org/zh/index.html" ref="nofollow noopener noreferrer">ECharts</a> å¼€å‘çš„ã€ä»æ–‡æœ¬è½¬åˆ° <strong>ER å›¾</strong> çš„ <strong>npm åŒ…</strong>ï¼Œå…¶ä¸­ï¼Œ<strong>Peggy</strong> ç”¨æ¥å°†æ–‡æœ¬è¿›è¡Œè§£æ/åºåˆ—åŒ–ï¼Œ<strong>ECharts</strong> ç”¨æ¥å®ç°<strong>å›¾å½¢æ¸²æŸ“ä¸è‡ªåŠ¨å¸ƒå±€</strong></p>
<h3 data-id="heading-2">æŠ€æœ¯ç»†èŠ‚</h3>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆé€‰æ‹© <strong>Peggy</strong></h4>
<p>è¿™ç‚¹è¦æ„Ÿè°¢ AI çš„æ¨èï¼Œè¿™ä¸ªåº“çœ‹èµ·æ¥æ²¡ä»€ä¹ˆäººç”¨ï¼Œä½†æˆ‘æ•¢è¯´è¿™ç»å¯¹æ˜¯<strong>å®è—</strong>ï¼šå®ƒå¯¹è¯­æ³•çš„è§£æç»å¯¹æ¯”è‡ªå·±<strong>æ‰‹æ’¸æ­£åˆ™</strong>è¦å¥½å¾ˆå¤šï¼ï¼ï¼</p>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰**â€œå®â€**ï¼Œæ¥æ–¹ä¾¿å¤ç”¨ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Peggy è¯­æ³•é€šç”¨è§„åˆ™åº“</span>

_  <span class="hljs-comment">// å¯é€‰ç©ºç™½ + æ³¨é‡Š</span>
  = (comment / [ \t\n\r])*

__ <span class="hljs-comment">// è‡³å°‘ä¸€ä¸ªç©ºç™½å­—ç¬¦</span>
  = [ \t\n\r]+

<span class="hljs-comment">// è¡Œå†…ç©ºç™½ï¼ˆä¸å«æ¢è¡Œï¼‰</span>
hws = [ \t]*

<span class="hljs-comment">// è·¨å¹³å°æ¢è¡Œç¬¦</span>
newline
  = <span class="hljs-string">"\r\n"</span> / <span class="hljs-string">"\n"</span> / <span class="hljs-string">"\r"</span>

<span class="hljs-comment">// æ ‡è¯†ç¬¦ï¼ˆæ”¯æŒ Unicode å­—æ¯å’Œæ•°å­—ï¼‰</span>
<span class="hljs-title class_">Identifier</span>
  = <span class="hljs-attr">id</span>:$[^ \t\n\r{}():\<span class="hljs-string">"#\-]+ &amp;{ return /^[\p{L}_][\p{L}\p{N}_]*$/u.test(id); } { return id; }

// è¡Œæ³¨é‡Šï¼ˆä¸åæ‰æ¢è¡Œï¼‰
comment
  = "</span>#<span class="hljs-string">" [^\n\r]* { return null; }

</span></code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥å®šä¹‰å®ä½“ä¸å…³ç³»ã€‚æ˜¾ç„¶ï¼Œåªè¦æˆ‘ä»¬å­¦è¿‡ <strong>C++</strong> æˆ– <strong>Java</strong> è¿™ç§ <strong>OOP</strong> èŒƒå¼çš„ç¼–ç¨‹è¯­è¨€ï¼Œè‡ªç„¶çŸ¥é“åº”è¯¥å¦‚ä½•å®šä¹‰å®ƒï¼Œä¸€ä¸ªç®€å•çš„æ ¼å¼å°±å®šå¥½äº†</p>
<pre><code class="hljs language-js" lang="js">entity <span class="hljs-title class_">Customer</span> {
  customer_id  <span class="hljs-variable constant_">PK</span>    # ä¸»é”®ä¸‹åˆ’çº¿ç”¨<span class="hljs-variable constant_">PK</span>æ ‡è®°
  name
  email
  phone
}
</code></pre>
<p>æ¥ä¸‹æ¥å°±å¼€å§‹å®šä¹‰äº†ï¼Œå½“ä½ çœ‹åˆ°ä¸‹é¢çš„ <strong>Peggy</strong> ä»£ç ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªå®šä¹‰éå¸¸ç¬¦åˆç¼–ç¨‹ç›´è§‰ï¼›å³ä½¿ä½ ä»æœªå­¦è¿‡<strong>ç¼–è¯‘åŸç†</strong>æˆ–è€…<strong>æ­£åˆ™è¡¨è¾¾</strong>ï¼Œ
ä¹Ÿèƒ½çœ‹æ‡‚å¾ˆå¤šï¼è¿™æ­£æ˜¯ <strong>Peggy</strong> çš„é­…åŠ›æ‰€åœ¨ï¼ï¼ï¼</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-comment">// å¼•ç”¨å…¬å…±è§„åˆ™</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Identifier</span>, hws, newline, _ , __, comment } <span class="hljs-keyword">from</span> <span class="hljs-string">"./common.peggy"</span>

<span class="hljs-comment">// start   // è§£æå…¥å£</span>
<span class="hljs-comment">//   = _ entities:entity+ _ { return entities; } </span>

<span class="hljs-comment">// æ³¨é‡Šåœ¨ common.peggy ä¸­</span>

    
entity <span class="hljs-comment">// è§£æå®ä½“å®šä¹‰ï¼ˆå…è®¸å‰ç½®ç©ºç™½ï¼‰</span>
  = _ <span class="hljs-string">"entity"</span> __ <span class="hljs-attr">name</span>:<span class="hljs-title class_">Identifier</span> _ <span class="hljs-string">"{"</span> _ <span class="hljs-attr">fields</span>:fieldBlock _ <span class="hljs-string">"}"</span> {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"entity"</span>, <span class="hljs-attr">name</span>: name, <span class="hljs-attr">fields</span>: fields };
    }

<span class="hljs-comment">// å­—æ®µå—ï¼šé›¶åˆ°å¤šè¡Œå­—æ®µï¼Œæ¯è¡Œä»¥æ¢è¡Œç»“æŸ</span>
fieldBlock
  = fieldLine*

fieldLine <span class="hljs-comment">// è§£æå¤šè¡Œå­—æ®µå®šä¹‰ï¼ˆè¡Œé¦–è‡³å°‘ä¸€ä¸ªç©ºç™½ï¼Œé¿å…ç©ºåŒ¹é…ï¼›è¡Œå°¾å¯æ³¨é‡Šï¼‰</span>
  = hws <span class="hljs-attr">f</span>:field hws comment? hws newline { <span class="hljs-keyword">return</span> f; }

field <span class="hljs-comment">// è§£æå­—æ®µå®šä¹‰ï¼ˆè¡Œå†…ä¸åæ¢è¡Œï¼‰</span>
  = <span class="hljs-attr">name</span>:<span class="hljs-title class_">Identifier</span> hws <span class="hljs-attr">pk</span>:(<span class="hljs-string">"PK"</span>)? {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"field"</span>, name, <span class="hljs-attr">pk</span>: pk !== <span class="hljs-literal">null</span> };
    }
</code></pre>
<p>ç±»ä¼¼çš„å¯¹äºå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®šä¹‰</p>
<pre><code class="hljs language-js" lang="js">rel <span class="hljs-title class_">Customer</span> -- <span class="hljs-title class_">Order</span>  (<span class="hljs-number">1</span>:n) <span class="hljs-string">"places"</span> # å®¢æˆ·ä¸‹è®¢å•
rel <span class="hljs-title class_">Customer</span> -- <span class="hljs-title class_">Address</span>  (<span class="hljs-attr">m</span>:n) <span class="hljs-string">"uses"</span> # å®¢æˆ·ä½¿ç”¨åœ°å€
rel <span class="hljs-title class_">Order</span> -- <span class="hljs-title class_">Address</span>  (<span class="hljs-number">1</span>:<span class="hljs-number">1</span>) <span class="hljs-string">"shipped to"</span> # è®¢å•å‘è´§åœ°å€
</code></pre>
<p>ç›¸åº”çš„ä»£ç å®ç°</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¼•ç”¨å…¬å…±è§„åˆ™</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Identifier</span>, hws, newline, _ , __, comment } <span class="hljs-keyword">from</span> <span class="hljs-string">"./common.peggy"</span>

<span class="hljs-comment">// start // è§£æå…¥å£ </span>
<span class="hljs-comment">//     = _ rels:rel+ _ { return rels; }</span>

<span class="hljs-comment">// å…³ç³»å®šä¹‰ï¼šrel &lt;å®ä½“1&gt; -- &lt;å®ä½“2&gt; : (åŸºæ•°) "&lt;å…³ç³»å&gt;"</span>
rel
    = _ <span class="hljs-string">"rel"</span> __ <span class="hljs-attr">left</span>:<span class="hljs-title class_">Identifier</span> __ <span class="hljs-string">"--"</span> __ <span class="hljs-attr">right</span>:<span class="hljs-title class_">Identifier</span> _ <span class="hljs-string">":"</span> _ <span class="hljs-string">"("</span> <span class="hljs-attr">card</span>:<span class="hljs-title class_">Cardinality</span> <span class="hljs-string">")"</span> _ <span class="hljs-attr">name</span>:<span class="hljs-title class_">QuotedString</span> _ comment? newline? {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">"relation"</span>, left, right, <span class="hljs-attr">cardinality</span>: card, name };
    }

<span class="hljs-comment">// åŸºæ•°ï¼šå¦‚ 1:n, m:n, 1:1</span>
<span class="hljs-title class_">Cardinality</span>
    = <span class="hljs-attr">chars</span>:[^)]* { <span class="hljs-keyword">return</span> chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>).<span class="hljs-title function_">trim</span>(); }

<span class="hljs-comment">// åŒå¼•å·å­—ç¬¦ä¸²</span>
<span class="hljs-title class_">QuotedString</span>
    = <span class="hljs-string">'"'</span> <span class="hljs-attr">chars</span>:[^<span class="hljs-string">"]* '"</span><span class="hljs-string">' { return chars.join(""); }
</span></code></pre>
<p>è¿™ä¸¤ä¸ªé‡ç‚¹å†™å¥½äº†ï¼Œé‚£ä¹ˆæ±‡æ€»ä¸€ä¸‹</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¼•ç”¨å…¬å…±è§„åˆ™</span>
<span class="hljs-keyword">import</span> { _ } <span class="hljs-keyword">from</span> <span class="hljs-string">"./common.peggy"</span>

<span class="hljs-comment">// å¼•ç”¨å®ä½“è§„åˆ™</span>
<span class="hljs-keyword">import</span> { entity } <span class="hljs-keyword">from</span> <span class="hljs-string">"./entities.peggy"</span>

<span class="hljs-comment">// å¼•ç”¨å…³ç³»è§„åˆ™</span>
<span class="hljs-keyword">import</span> { rel } <span class="hljs-keyword">from</span> <span class="hljs-string">"./sample.peggy"</span>

start <span class="hljs-comment">// è§£æå…¥å£ï¼šæ”¯æŒå®ä½“å’Œå…³ç³»æ··åˆå®šä¹‰</span>
  = _ <span class="hljs-attr">elements</span>:(entity / rel)+  _ {
      <span class="hljs-keyword">return</span> elements;
  }
</code></pre>
<p>è‡³æ­¤ï¼Œè¯­æ³•è§£æçš„éƒ¨åˆ†åŸºæœ¬ç»“æŸã€‚åŒæ—¶ï¼Œè¿™äº› <strong>Peggy</strong> ç¼–è¯‘åè¾“å‡ºçš„ <strong>JS</strong> ä»£ç ä¼šè‡ªåŠ¨è¾“å‡ºåºåˆ—åŒ–çš„æ•°æ®ï¼Œæ¥ä¸‹æ¥å°†åœ¨ <strong>ECharts</strong> ä¸­ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-4"><strong>ECharts</strong> æ¸²æŸ“</h4>
<p>é¦–å…ˆç®€å•å®šä¹‰ä¸€ä¸‹ç±»å‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * å­—æ®µå®šä¹‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ERField</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">"field"</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">pk</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-comment">/**
 * å®ä½“å®šä¹‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EREntity</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">"entity"</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">fields</span>: <span class="hljs-title class_">ERField</span>[];
}

<span class="hljs-comment">/**
 * å…³ç³»å®šä¹‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ERRelation</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">"relation"</span>;
  <span class="hljs-attr">left</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">right</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">cardinality</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * ER å›¾ JSON èŠ‚ç‚¹ç±»å‹
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">ERJson</span> = <span class="hljs-title class_">EREntity</span> | <span class="hljs-title class_">ERRelation</span>;

</code></pre>
<p>â€œæ¡¥æ¥â€ç‚¹ï¼Œæ–¹ä¾¿å¼•å…¥ <strong>Peggy</strong> ç¼–è¯‘äº§ç”Ÿçš„ <strong>JS</strong> è§£æå™¨å’Œåºåˆ—åŒ–åŠŸèƒ½</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// @ts-ignore ä½¿ç”¨ peggy ç”Ÿæˆçš„è§£æå™¨ï¼ˆESMï¼Œå‘½åå¯¼å‡º parseï¼‰</span>
<span class="hljs-comment">// ç”Ÿæˆè„šæœ¬è§ package.json -&gt; scripts.pg</span>
<span class="hljs-keyword">import</span> { parse <span class="hljs-keyword">as</span> peggyParse } <span class="hljs-keyword">from</span> <span class="hljs-string">"../grammar/peggy/all-parser.js"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">ERJson</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./type"</span>;

<span class="hljs-comment">/**
 * è§£æ ER å›¾æ–‡æœ¬ä¸º AST
 * <span class="hljs-doctag">@param</span> input å¤šè¡Œ ER å›¾å®šä¹‰æ–‡æœ¬
 * <span class="hljs-doctag">@returns</span> è§£æåçš„ AST æ•°ç»„
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseERSchema</span>(<span class="hljs-params">input: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">ERJson</span>[] {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">peggyParse</span>(input) <span class="hljs-keyword">as</span> <span class="hljs-title class_">ERJson</span>[];
  } <span class="hljs-keyword">catch</span> (<span class="hljs-attr">e</span>: <span class="hljs-built_in">any</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è§£æå¤±è´¥:"</span>, e?.<span class="hljs-property">message</span>, <span class="hljs-string">"\nä½ç½®:"</span>, e?.<span class="hljs-property">location</span>);
    <span class="hljs-keyword">throw</span> e;
  }
}

<span class="hljs-comment">/**
 * è§£æ ER å›¾æ–‡æœ¬å¹¶è¾“å‡º JSON
 * <span class="hljs-doctag">@param</span> input å¤šè¡Œ ER å›¾å®šä¹‰æ–‡æœ¬
 * <span class="hljs-doctag">@returns</span> JSON å­—ç¬¦ä¸²
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseERSchemaToJSON</span>(<span class="hljs-params">input: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-title function_">parseERSchema</span>(input), <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>);
}

</code></pre>
<p>ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œä¸‹é¢ä»£ç æ”¹æˆ<strong>é«˜åº¦æ¦‚æ‹¬</strong>çš„ç‰ˆæœ¬</p>
<p>ä»…ä¿ç•™ä¸‰ä¸ªå…³é”®æ­¥éª¤â€”â€”<strong>è§£æ</strong>ï¼ˆ<code>parseERSchema</code>ï¼‰â†’ <strong>æ˜ å°„</strong>ï¼ˆå®ä½“/å±æ€§/å…³ç³»ä¸‰ç±»èŠ‚ç‚¹ä¸è¿è¾¹ï¼‰â†’ <strong>æ¸²æŸ“</strong>ï¼ˆECharts Graph + <strong>åŠ›å¯¼å‘å¸ƒå±€</strong>ï¼‰ã€‚å½¢çŠ¶éµå¾ª <strong>Chen è¡¨ç¤ºæ³•</strong>ï¼šå®ä½“=çŸ©å½¢ï¼Œå±æ€§=æ¤­åœ†ï¼ˆä¸»é”®çº¢è‰²æè¾¹ï¼‰ï¼Œå…³ç³»=è±å½¢ï¼›åŸºæ•°æ ‡æ³¨åˆ°è¾¹æ ‡ç­¾ä¸Šã€‚é€šè¿‡ <code>chenERRbyClass</code>/<code>chenERRbyId</code> å³å¯æŠŠå®¹å™¨å†…çš„ <strong>ER æ–‡æœ¬</strong> ç›´æ¥æ¸²æŸ“ä¸ºå¯äº¤äº’å›¾ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/core"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">GraphChart</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/charts"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">TooltipComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/components"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CanvasRenderer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/renderers"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">ComposeOption</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/core"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">GraphSeriesOption</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"echarts/charts"</span>;
<span class="hljs-keyword">import</span> { parseERSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">"./main"</span>;

<span class="hljs-comment">// ä»…æ³¨å†Œå¿…éœ€ç»„ä»¶ï¼ˆå›¾ + æç¤º + æ¸²æŸ“å™¨ï¼‰</span>
echarts.<span class="hljs-title function_">use</span>([<span class="hljs-title class_">GraphChart</span>, <span class="hljs-title class_">TooltipComponent</span>, <span class="hljs-title class_">CanvasRenderer</span>]);
<span class="hljs-keyword">type</span> <span class="hljs-title class_">ECOption</span> = <span class="hljs-title class_">ComposeOption</span>&lt;<span class="hljs-title class_">GraphSeriesOption</span>&gt;;

<span class="hljs-comment">// æ¤­åœ†å±æ€§èŠ‚ç‚¹ï¼ˆChenï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ELLIPSE</span> = <span class="hljs-string">"path://M50 0 A50 50 0 1 1 49.999 0 Z"</span>;

<span class="hljs-comment">// AST -&gt; Graphï¼ˆèŠ‚ç‚¹ã€è¿è¾¹ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">astToGraph</span>(<span class="hljs-params">ast: <span class="hljs-built_in">any</span>[]</span>) {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">nodes</span>: <span class="hljs-built_in">any</span>[] = [];
  <span class="hljs-keyword">const</span> <span class="hljs-attr">edges</span>: <span class="hljs-built_in">any</span>[] = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> it <span class="hljs-keyword">of</span> ast) {
    <span class="hljs-keyword">if</span> (it.<span class="hljs-property">type</span> === <span class="hljs-string">"entity"</span>) {
      <span class="hljs-keyword">const</span> id = it.<span class="hljs-property">name</span>;
      nodes.<span class="hljs-title function_">push</span>({
        id,
        <span class="hljs-attr">name</span>: id,
        <span class="hljs-attr">symbol</span>: <span class="hljs-string">"rect"</span>,
        <span class="hljs-attr">category</span>: <span class="hljs-string">"entity"</span>,
        <span class="hljs-attr">symbolSize</span>: [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">140</span>, id.<span class="hljs-property">length</span> * <span class="hljs-number">14</span> + <span class="hljs-number">40</span>), <span class="hljs-number">48</span>],
        <span class="hljs-attr">label</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span> },
        <span class="hljs-attr">attrs</span>: (it.<span class="hljs-property">fields</span> || []).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">f: <span class="hljs-built_in">any</span></span>) =&gt;</span> ({ <span class="hljs-attr">name</span>: f.<span class="hljs-property">name</span>, <span class="hljs-attr">pk</span>: !!f.<span class="hljs-property">pk</span> })),
      });
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> f <span class="hljs-keyword">of</span> it.<span class="hljs-property">fields</span> || []) {
        <span class="hljs-keyword">const</span> aid = <span class="hljs-string">`<span class="hljs-subst">${id}</span>.<span class="hljs-subst">${f.name}</span>`</span>;
        nodes.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">id</span>: aid,
          <span class="hljs-attr">name</span>: f.<span class="hljs-property">name</span>,
          <span class="hljs-attr">symbol</span>: <span class="hljs-variable constant_">ELLIPSE</span>,
          <span class="hljs-attr">symbolKeepAspect</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">symbolSize</span>: [<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">90</span>, f.<span class="hljs-property">name</span>.<span class="hljs-property">length</span> * <span class="hljs-number">16</span>), <span class="hljs-number">36</span>],
          <span class="hljs-attr">category</span>: <span class="hljs-string">"attribute"</span>,
          <span class="hljs-attr">label</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span> },
          <span class="hljs-attr">itemStyle</span>: {
            <span class="hljs-attr">borderColor</span>: f.<span class="hljs-property">pk</span> ? <span class="hljs-string">"#d62728"</span> : <span class="hljs-string">"#5470c6"</span>,
            <span class="hljs-attr">borderWidth</span>: f.<span class="hljs-property">pk</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">1</span>,
          },
        });
        edges.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">source</span>: aid, <span class="hljs-attr">target</span>: id });
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it.<span class="hljs-property">type</span> === <span class="hljs-string">"relation"</span>) {
      <span class="hljs-keyword">const</span> rid = <span class="hljs-string">`rel:<span class="hljs-subst">${it.name}</span>-<span class="hljs-subst">${it.left}</span>-<span class="hljs-subst">${it.right}</span>`</span>;
      <span class="hljs-keyword">const</span> [l = <span class="hljs-string">""</span>, r = <span class="hljs-string">""</span>] = (it.<span class="hljs-property">cardinality</span> || <span class="hljs-string">""</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">":"</span>);
      nodes.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">id</span>: rid,
        <span class="hljs-attr">name</span>: it.<span class="hljs-property">name</span>,
        <span class="hljs-attr">symbol</span>: <span class="hljs-string">"diamond"</span>,
        <span class="hljs-attr">symbolSize</span>: [<span class="hljs-number">110</span>, <span class="hljs-number">60</span>],
        <span class="hljs-attr">category</span>: <span class="hljs-string">"relation"</span>,
        <span class="hljs-attr">label</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span> },
      });
      edges.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">source</span>: rid, <span class="hljs-attr">target</span>: it.<span class="hljs-property">left</span>, <span class="hljs-attr">name</span>: l });
      edges.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">source</span>: rid, <span class="hljs-attr">target</span>: it.<span class="hljs-property">right</span>, <span class="hljs-attr">name</span>: r });
    }
  }
  <span class="hljs-keyword">return</span> { nodes, edges };
}

<span class="hljs-comment">// æ‰¹é‡æ¸²æŸ“æŒ‡å®šç±»åå®¹å™¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderChenER</span>(<span class="hljs-params">cls = <span class="hljs-string">"chenER"</span></span>) {
  <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(cls) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLCollectionOf</span>&lt;<span class="hljs-title class_">HTMLElement</span>&gt;;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; list.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> el = list[i];
    <span class="hljs-keyword">const</span> { nodes, edges } = <span class="hljs-title function_">astToGraph</span>(<span class="hljs-title function_">parseERSchema</span>(el.<span class="hljs-property">textContent</span> || <span class="hljs-string">""</span>));
    el.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">const</span> chart = echarts.<span class="hljs-title function_">init</span>(el);
    <span class="hljs-keyword">const</span> <span class="hljs-attr">option</span>: <span class="hljs-title class_">ECOption</span> = {
      <span class="hljs-attr">series</span>: [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"graph"</span>,
          <span class="hljs-attr">layout</span>: <span class="hljs-string">"force"</span>,
          <span class="hljs-attr">roam</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">data</span>: nodes,
          <span class="hljs-attr">links</span>: edges,
          <span class="hljs-attr">categories</span>: [
            { <span class="hljs-attr">name</span>: <span class="hljs-string">"entity"</span> },
            { <span class="hljs-attr">name</span>: <span class="hljs-string">"relation"</span> },
            { <span class="hljs-attr">name</span>: <span class="hljs-string">"attribute"</span> },
          ],
          <span class="hljs-attr">label</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">position</span>: <span class="hljs-string">"inside"</span> },
          <span class="hljs-attr">edgeLabel</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">p: <span class="hljs-built_in">any</span></span>) =&gt;</span> p?.<span class="hljs-property">data</span>?.<span class="hljs-property">name</span> ?? <span class="hljs-string">""</span> },
          <span class="hljs-attr">edgeSymbol</span>: [<span class="hljs-string">"none"</span>, <span class="hljs-string">"none"</span>],
          <span class="hljs-attr">lineStyle</span>: { <span class="hljs-attr">color</span>: <span class="hljs-string">"#888"</span>, <span class="hljs-attr">curveness</span>: <span class="hljs-number">0.2</span> },
          <span class="hljs-attr">force</span>: { <span class="hljs-attr">repulsion</span>: <span class="hljs-number">600</span>, <span class="hljs-attr">edgeLength</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">friction</span>: <span class="hljs-number">0.2</span> },
          <span class="hljs-attr">tooltip</span>: {
            <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">p: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
              <span class="hljs-keyword">if</span> (p.<span class="hljs-property">dataType</span> === <span class="hljs-string">"node"</span> &amp;&amp; p?.<span class="hljs-property">data</span>?.<span class="hljs-property">category</span> === <span class="hljs-string">"relation"</span>) {
                <span class="hljs-keyword">return</span> p.<span class="hljs-property">data</span>.<span class="hljs-property">name</span> || <span class="hljs-string">""</span>;
              }
              <span class="hljs-keyword">if</span> (p.<span class="hljs-property">dataType</span> === <span class="hljs-string">"node"</span> &amp;&amp; p?.<span class="hljs-property">data</span>?.<span class="hljs-property">category</span> === <span class="hljs-string">"entity"</span>) {
                <span class="hljs-keyword">const</span> d = p.<span class="hljs-property">data</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>;
                <span class="hljs-keyword">const</span> attrs = (d.<span class="hljs-property">attrs</span> || []).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">any</span></span>) =&gt;</span> (a.<span class="hljs-property">pk</span> ? <span class="hljs-string">`*<span class="hljs-subst">${a.name}</span>`</span> : a.<span class="hljs-property">name</span>));
                <span class="hljs-keyword">return</span> [d.<span class="hljs-property">name</span>, ...attrs].<span class="hljs-title function_">join</span>(<span class="hljs-string">"&lt;br/&gt;"</span>);
              }
              <span class="hljs-keyword">return</span> p.<span class="hljs-property">name</span> || <span class="hljs-string">""</span>;
            },
          },
        },
      ],
    };
    chart.<span class="hljs-title function_">setOption</span>(option);
    <span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"resize"</span>, <span class="hljs-function">() =&gt;</span> chart.<span class="hljs-title function_">resize</span>());
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> chenERRbyClass = renderChenER;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">chenERRbyId</span>(<span class="hljs-params">id: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (!el) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Container #<span class="hljs-subst">${id}</span> not found`</span>);
  el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">"chenER"</span>);
  <span class="hljs-title function_">renderChenER</span>(<span class="hljs-string">"chenER"</span>);
}
</code></pre>
<h3 data-id="heading-5">è¿˜ç­‰ä»€ä¹ˆï¼Œç°åœ¨å°±å»è¯•è¯•å§ï¼</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcodesandbox.io%2Fp%2Fsandbox%2Fm248ws" target="_blank" title="https://codesandbox.io/p/sandbox/m248ws" ref="nofollow noopener noreferrer">codesandbox.io/p/sandbox/mâ€¦</a></p>
<h2 data-id="heading-6">chen-er ä¸“ä¸ºChenå¼ERå›¾æ‰“é€ çš„npmåŒ…</h2>
<p>ä½œè€…: xingwangzhe</p>
<p>æœ¬æ–‡é“¾æ¥:Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fxingwangzhe.fun%2Fposts%2Fb8eb3b61" target="_blank" title="https://xingwangzhe.fun/posts/b8eb3b61" ref="nofollow noopener noreferrer">xingwangzhe.fun/posts/b8eb3â€¦</a></p>
<p>æœ¬æ–‡é‡‡ç”¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-nc-sa%2F4.0%2F" target="_blank" title="https://creativecommons.org/licenses/by-nc-sa/4.0/" ref="nofollow noopener noreferrer">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>Â è¿›è¡Œè®¸å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è´§æ‹‰æ‹‰RAGä¼˜åŒ–å®è·µï¼šä»åŸå§‹æ•°æ®åˆ°é«˜è´¨é‡çŸ¥è¯†åº“]]></title>    <link>https://juejin.cn/post/7579385656779669538</link>    <guid>https://juejin.cn/post/7579385656779669538</guid>    <pubDate>2025-12-03T08:59:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579385656779669538" data-draft-id="7576532425763061775" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è´§æ‹‰æ‹‰RAGä¼˜åŒ–å®è·µï¼šä»åŸå§‹æ•°æ®åˆ°é«˜è´¨é‡çŸ¥è¯†åº“"/> <meta itemprop="keywords" content="ç®—æ³•,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-03T08:59:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è´§æ‹‰æ‹‰æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/1768489241815070"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è´§æ‹‰æ‹‰RAGä¼˜åŒ–å®è·µï¼šä»åŸå§‹æ•°æ®åˆ°é«˜è´¨é‡çŸ¥è¯†åº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1768489241815070/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è´§æ‹‰æ‹‰æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T08:59:19.000Z" title="Wed Dec 03 2025 08:59:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>çŸ¥è¯†åº“ä¸€èˆ¬é€šè¿‡æœ¬åœºæ™¯çš„äººå·¥å¤–å‘¼è·å¾—ä¸“æœ‰çŸ¥è¯†ï¼Œä»¥åŠä»å…¶ä»–åœºæ™¯çš„çŸ¥è¯†åº“è¿ç§»é€šç”¨çŸ¥è¯†æ¥äººå·¥æ„å»ºçš„ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b314f6f02bdd4205b27118df458f39b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=mSA%2B5YMapZjHOZSgqZJA5tXhnLs%3D" alt="1.png" loading="lazy"/></p>
<p align="center">å›¾1 çŸ¥è¯†åº“åˆå§‹æ„å»º</p>
<p>åˆå§‹æ„å»ºçš„çŸ¥è¯†åº“ä¸€èˆ¬åŒ…å«ä¸‰éƒ¨åˆ†ï¼šç›¸ä¼¼é—®æ³•ã€æ„å›¾ã€æ ‡å‡†è¯æœ¯ï¼ˆå¦‚å›¾2æ‰€ç¤ºï¼‰ï¼›çŸ¥è¯†åº“åœ¨çº¿ä¸Šä½¿ç”¨æ—¶ï¼Œæ˜¯å°†RAGå¬å›çš„æ„å›¾ã€ç›¸ä¼¼é—®æ³•ã€æ ‡å‡†è¯æœ¯æ‹¼æ¥åˆ°promptä¸­ï¼Œç”±LLMç”Ÿæˆç›¸åº”çš„è¯æœ¯ï¼Œæ‰€ä»¥çŸ¥è¯†åº“æ„å›¾ã€ç›¸ä¼¼é—®æ³•ã€æ ‡å‡†è¯æœ¯çš„æ˜ å°„å…³ç³»æ˜¯å¦å‡†ç¡®å°¤ä¸ºé‡è¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cbb33f57f074619866a6ae4ec30986b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=xRsu%2B22pBXcg8lL3L3JhrvpYCMk%3D" alt="2.png" loading="lazy"/></p>
<p align="center">å›¾2 ç›¸ä¼¼é—®æ³•ã€æ„å›¾ã€æ ‡å‡†è¯æœ¯çš„æ˜ å°„å…³ç³»</p>
<blockquote>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<p>ç›¸ä¼¼é—®æ³•ï¼š</p>
<p>ä½ ä»¬å¸®æˆ‘è®¢é˜…è¿™ä¸ªè·¯çº¿éœ€ä¸éœ€è¦æ”¶è´¹ï¼Œä½ è¯´ï¼Ÿ</p>
<p>ä½ å…ˆè¯´è®¢é˜…è¿™ä¸ªæ”¶ä¸æ”¶è´¹ã€‚</p>
<p>æ„å›¾ï¼šè¯¢é—®è®¢é˜…è·¯çº¿æ˜¯å¦æ”¶è´¹</p>
<p>æ ‡å‡†è¯æœ¯ï¼š</p>
<p>è‡ªåŠ¨è®¢é˜…æ˜¯ä¸æ”¶è´¹çš„ã€‚</p>
<p>ä¸æ”¶è´¹çš„ã€‚</p>
<p>è‡ªåŠ¨è®¢é˜…æ˜¯å®Œå…¨å…è´¹çš„ï¼Œä¸æ”¶æ‚¨é’±ã€‚</p>
</blockquote>
<p>ç”±äºçŸ¥è¯†åº“çš„åˆå§‹æ„å»ºä¾èµ–äºäººå·¥ï¼Œç”±äºäººåŠ›èµ„æºçš„ä¸è¶³ï¼ŒçŸ¥è¯†åº“ä¸€èˆ¬å­˜åœ¨ä»¥ä¸‹ä¸‰ç±»é—®é¢˜ï¼š</p>
<ol>
<li>æ„å›¾åå®šä¹‰ä¸æ¸…æ™° ==&gt; å¯¼è‡´LLMç”Ÿæˆè¯æœ¯å¯èƒ½ä¸åˆç† ==&gt; éœ€é‡æ–°å®šä¹‰æ„å›¾å</li>
</ol>
<blockquote>
<p>å›¾ä¸­ç›¸ä¼¼é—®æ³•å®é™…è¯­ä¹‰æ˜¯ã€è´¨ç–‘æ¥ç”µçš„çœŸå®æ€§ã€‘ï¼Œä½¿ç”¨ã€æ¥ç”µç›®çš„ã€‘ä½œä¸ºæ„å›¾åï¼Œä¸èƒ½å‡†ç¡®æ¦‚æ‹¬å¸æœºè¯­ä¹‰ï¼Œè¿›è€Œå¯¼è‡´å›å¤è¯æœ¯ä¸åˆç†ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe29d2ed91194b1aa945fdafd268dbed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=LO0H1A1vM3Ak9wr5ok2yfpemgPk%3D" alt="å›¾ç‰‡3.png" loading="lazy"/></p>
<p align="center">å›¾3 æ„å›¾åå®šä¹‰ä¸æ¸…æ™°ç¤ºä¾‹</p>
<ol start="2">
<li>ç›¸ä¼¼é—®æ³•ä¸æ„å›¾è¯æœ¯ä¸åŒ¹é… ==&gt; å¯¼è‡´LLMç­”éæ‰€é—® ==&gt; éœ€å¯¹ç›¸ä¼¼é—®æ³•é‡æ–°å½’ç±»</li>
</ol>
<blockquote>
<p>å›¾ä¸­ç›¸ä¼¼é—®æ³•è¢«é”™åˆ†ä¸ºã€è½¦å­æœ‰è´§äº†ã€‘ï¼ŒLLMå°†å‚è€ƒè¯¥æ„å›¾çš„è¯æœ¯ï¼Œè¿›è€Œå¯¼è‡´ç­”éæ‰€é—®ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01a09083e30d4d789f63e6ad4a46fda1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=7k9x7dFiIUrMsXBH%2FtvZY1O3h6w%3D" alt="4.png" loading="lazy"/></p>
<p align="center">å›¾4 ç›¸ä¼¼é—®æ³•ä¸æ„å›¾è¯æœ¯ä¸åŒ¹é…ç¤ºä¾‹</p>
<ol start="3">
<li>æ„å›¾è¿‡äºæ¦‚æ‹¬ ==&gt; æ ‡å‡†è¯æœ¯å›å¤ä¸å¤Ÿç²¾å‡† ==&gt; éœ€æ„å›¾ç»†æ‹†</li>
</ol>
<blockquote>
<p>å›¾ä¸­ç›¸ä¼¼é—®æ³•ä¸­åŒ…å«è‹¥å¹²ç§å¸æœºæ²¡å‡ºè½¦çš„è¯­ä¹‰å¦‚ï¼šåœ¨ä½é™¢ã€åœ¨è€å®¶ã€åœ¨ä¿®è½¦ç­‰ã€‚</p>
<p>ä½¿ç”¨ç»Ÿä¸€çš„è¯æœ¯æ— æ³•ç²¾å‡†çš„å›å¤å¸æœºï¼Œéœ€è¦å¯¹æ„å›¾è¿›è¡Œç»†æ‹†ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f565a81f12b41a8b474cee43286be7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=q8TqDQMJqd9SUlBwHaIHAhu59sk%3D" alt="5.png" loading="lazy"/></p>
<p align="center">å›¾5 æ„å›¾è¿‡äºæ¦‚æ‹¬ç¤ºä¾‹</p>
<h2 data-id="heading-1">äºŒã€è§£å†³æ–¹æ¡ˆ</h2>
<p>çŸ¥è¯†åº“æ¸…æ´—ä¸šç•Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p>æ–¹æ¡ˆä¸€ï¼šåµŒå…¥æ¨¡å‹+èšç±»</p>
</li>
<li>
<p>æ–¹æ¡ˆäºŒï¼šå¤§æ¨¡å‹è¯­ä¹‰ç†è§£</p>
</li>
</ul>
<h3 data-id="heading-2">2.1 æ–¹æ¡ˆä¸€ï¼šåµŒå…¥æ¨¡å‹+èšç±»</h3>
<blockquote>
<p>ä½¿ç”¨åµŒå…¥æ¨¡å‹å°†ç›¸ä¼¼é—®æ³•æ˜ å°„åˆ°é«˜ç»´å‘é‡ç©ºé—´ï¼Œä½¿ç”¨èšç±»ç®—æ³•æ¸…æ´—çŸ¥è¯†åº“</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efc3302101c64a148acff3b8f6f15826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=9ZIygKpxvHURXOTtd988zjLikt8%3D" alt="å›¾ç‰‡6.png" loading="lazy"/>
ç»è°ƒç ”ï¼ŒQwen3-Embedding-8Båœ¨èšç±»ä»»åŠ¡ä¸­è¯„åˆ†æœ€é«˜ï¼Œå› æ­¤æ¨¡å‹é€‰æ‹©Qwen3-Embedding-8Bã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/563a90dc471a465cbfe8b08d45864b1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=yQ1LR31%2BZMK0a1V7%2Bal4Hs8%2BqdQ%3D" alt="" loading="lazy"/></p>
<p>å®è·µè¿‡ç¨‹ä¸­ï¼Œå› Qwen3-Embedding-8B è¯­ä¹‰ç†è§£ç¨‹åº¦æœ‰é™ï¼Œèšç±»ç®—æ³•å­˜åœ¨ç±»åˆ«ä¸å¯æ§/ç±»åˆ«è¯­ä¹‰æœªçŸ¥çš„é—®é¢˜ï¼Œå¯¼è‡´ç›¸ä¼¼é—®æ³•é‡æ–°å½’ç±»å‡†ç¡®ç‡æä½ã€æ„å›¾ç»†åˆ†è¿‡ç»†ï¼Œæœ€ç»ˆé‡‡ç”¨æ–¹æ¡ˆäºŒæ¸…æ´—ã€‚</p>
<h3 data-id="heading-3">2.2 æ–¹æ¡ˆäºŒï¼šå¤§æ¨¡å‹è¯­ä¹‰ç†è§£</h3>
<blockquote>
<p>åˆ©ç”¨å¤§æ¨¡å‹çš„è¯­è¨€ç†è§£èƒ½åŠ›ï¼Œè¾…åŠ©äººå·¥è¿›è¡ŒçŸ¥è¯†åº“æ¸…æ´—ï¼Œæé«˜æ¸…æ´—æ•ˆç‡</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed1990a8f9a24d6cb3bf2ac1f535af3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=%2FwGVb5moQtK2TAyjaViv80nbcT4%3D" alt="å›¾ç‰‡8.png" loading="lazy"/></p>
<h4 data-id="heading-4">1.   é‡æ–°å®šä¹‰æ„å›¾å</h4>
<blockquote>
<p>ç»“åˆå¤§æ¨¡å‹å’Œä¸šåŠ¡çŸ¥è¯†å¯¹æ„å›¾åè¿›è¡Œä¼˜åŒ–</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24e79a31f08a48da8c24eb142a4ea959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=ZVLzlK4GvqYTxaIKwiZMufOWU8M%3D" alt="å›¾ç‰‡9.png" loading="lazy"/></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">a</span>.  å°‘é‡æ ·æœ¬åˆå§‹åŒ–æ„å›¾åï¼š
Â Â æŠ½å–å°‘é‡æ ·æœ¬å¹¶ä½¿ç”¨å¤§æ¨¡å‹åˆå§‹åŒ–æ„å›¾åç§°å’Œæ„å›¾æè¿°ã€‚
<span class="hljs-selector-tag">b</span>.  äººå·¥checkï¼š
  æ ¹æ®ä¸šåŠ¡çŸ¥è¯†å¯¹å¤§æ¨¡å‹ç”Ÿæˆçš„åˆå§‹åŒ–æ„å›¾åç§°è¿›è¡ŒäºŒæ¬¡æ ¡éªŒï¼Œä»¥å¾—åˆ°èƒ½å¤Ÿç²¾å‡†æ¦‚æ‹¬ç›¸ä¼¼é—®æ³•è¯­ä¹‰çš„æ„å›¾åç§°ã€‚
</code></pre>

<h4 data-id="heading-5">2.  ç›¸ä¼¼é—®æ³•é‡æ–°å½’ç±»</h4>
<blockquote>
<p>ä½¿ç”¨å¤§æ¨¡å‹+promptçš„æ–¹å¼å¯¹ç›¸ä¼¼é—®æ³•é‡æ–°å½’ç±»ï¼Œå› æ­¤promptä¸­æ„å›¾çš„æè¿°å°±æä¸ºé‡è¦ï¼›</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95e2db2326fd4843aae74a5d840ffff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=W8%2BavJai4YmTSPdGwlg4XpUx6ps%3D" alt="å›¾ç‰‡10.png" loading="lazy"/></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">a</span>.  å°‘é‡æ ·æœ¬è¿­ä»£ä¼˜åŒ–æ„å›¾æè¿°ï¼š
   Â æŠ½æ ·éƒ¨åˆ†ç›¸ä¼¼é—®æ³•ï¼Œä¸æ–­ä¼˜åŒ–è¿­ä»£promptä¸­æ„å›¾çš„æè¿°ï¼Œä»¥æé«˜å¤§æ¨¡å‹åˆ†ç±»å‡†ç¡®æ€§ã€‚
<span class="hljs-selector-tag">b</span>.  å…¨é‡åˆ†ç±»ï¼š
    é€šè¿‡å¤§æ¨¡å‹+prompt å¯¹å…¨é‡ç›¸ä¼¼é—®æ³•è¿›è¡Œé‡æ–°åˆ†ç±»ï¼Œç”±äºå‡†ç¡®ç‡å¾ˆéš¾è¾¾åˆ°<span class="hljs-number">100%</span>ï¼Œå› æ­¤ä»ç„¶éœ€è¦äººå·¥å¯¹ç±»åˆ«å‘ç”Ÿå˜æ›´çš„ç›¸ä¼¼é—®æ³•è¿›è¡ŒäºŒæ¬¡æ ¡éªŒï¼Œä»¥ä¿è¯ç›¸ä¼¼é—®æ³•åˆ†ç±»å‡†ç¡®ã€‚
</code></pre>

<h4 data-id="heading-6">3.   æ„å›¾ç»†åˆ†</h4>
<blockquote>
<p>ä½¿ç”¨å¤§æ¨¡å‹åˆå§‹åŒ–ç»†åˆ†æ„å›¾ç±»åˆ«ï¼Œäººå·¥äºŒæ¬¡ç¡®è®¤æœ€ç»ˆçš„ç»†åˆ†æ„å›¾</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d34fa1af59df42ada7f34dca8be05dc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=NkyPmisE%2FtbnOe7harszDnUindI%3D" alt="å›¾ç‰‡11.png" loading="lazy"/></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">a</span>.  åˆå§‹åŒ–æ„å›¾ç»†åˆ†ï¼š
    ä½¿ç”¨å¤§æ¨¡å‹çš„è¯­è¨€ç†è§£èƒ½åŠ›å’Œä¸šåŠ¡çŸ¥è¯†ä¸ºæ„å›¾çš„ç»†åˆ†æä¾›åˆå§‹æ–¹æ¡ˆï¼Œæ–¹ä¾¿äººå·¥äºŒæ¬¡checkï¼›
<span class="hljs-selector-tag">b</span>.  äººå·¥ä¼˜åŒ–ï¼š
    ç”±äºå¤§æ¨¡å‹çš„ç»†åˆ†æ–¹æ¡ˆå¹¶ä¸å®Œå…¨ç¬¦åˆä¸šåŠ¡è¦æ±‚ï¼Œå› æ­¤éœ€è¦äººå·¥è¿›è¡ŒäºŒæ¬¡ç¡®è®¤ï¼Œä»¥ç¡®ä¿æ„å›¾çš„ç»†åˆ†æ˜¯ç¬¦åˆä¸šåŠ¡é€»è¾‘çš„ã€‚
</code></pre>

<h4 data-id="heading-7">4.   è¯æœ¯ç”Ÿæˆ</h4>
<blockquote>
<p>ç»“åˆé‚€çº¦è¯æœ¯çŸ¥è¯†ï¼Œä½¿ç”¨å¤§æ¨¡å‹ç”Ÿæˆè¯æœ¯</p>
</blockquote>
<p>ç”±äºæ„å›¾çš„æ•°é‡ç¹å¤šï¼Œå¾ˆéš¾ä½¿ç”¨äººå·¥å»ä¸ºæ¯ä¸ªæ„å›¾ç”Ÿæˆå¤šç§è¯æœ¯ã€‚å› æ­¤ï¼Œåˆ©ç”¨å¤§æ¨¡å‹ç»“åˆåœºæ™¯çŸ¥è¯†ä¸ºæ¯ä¸ªæ„å›¾ç”Ÿæˆåˆå§‹å¤šæ ·åŒ–è¯æœ¯ï¼Œäººå·¥åšäºŒæ¬¡æ ¡éªŒã€‚</p>
<h2 data-id="heading-8">ä¸‰ã€ç»“æœ</h2>
<h4 data-id="heading-9">1.  æ„å›¾åå®šä¹‰ä¸æ¸…æ™°</h4>
<blockquote>
<p>åˆ©ç”¨ä¸šåŠ¡çŸ¥è¯†åˆå¹¶ç›¸ä¼¼çš„æ„å›¾ç±»åˆ«ï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªæ„å›¾æä¾›ä¼˜åŒ–åçš„æ„å›¾å</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8f8883a35ac4c4598356abcd9f36337~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=jih2XSR8elt%2BNJEJwLObQDiVWts%3D" alt="33.png" loading="lazy"/></p>
<h4 data-id="heading-10">2.   ç›¸ä¼¼é—®æ³•ä¸æ„å›¾ä¸åŒ¹é…</h4>
<blockquote>
<p>åˆ©ç”¨æ„å›¾æ‘˜è¦æ˜æ™°æ„å›¾å‘½ä¸­èŒƒå›´ï¼Œå¹¶å¯¹æ¯ä¸€ä¸ªæ„å›¾ä¸­çš„ç›¸ä¼¼é—®æ³•è¿›è¡Œä¼˜åŒ–</p>
<p>å¯¹<strong>10%</strong> çš„ç›¸ä¼¼é—®æ³•è¿›è¡Œé‡æ–°åˆ†ç±»ï¼Œå‡†ç¡®ç‡=65%</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8810620685ee4eda9bca4270edf5bdef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=GGA%2FdCrxMUoSqmkcDqGGYn%2FPw3c%3D" alt="22.png" loading="lazy"/></p>
<h4 data-id="heading-11">3.   æ„å›¾è¿‡äºæ¦‚æ‹¬</h4>
<blockquote>
<p>æ ¹æ®å¸æœºçš„æƒ…ç»ªã€å…·ä½“åŸå› ã€äº§å“ç»´åº¦è¿›è¡Œç»†åˆ†</p>
<p>å¯¹<strong>63%</strong> çš„æ„å›¾è¿›è¡Œç»†åˆ†ï¼ŒåŸæœ‰æ„å›¾44ä¸ªç±»ç»†åˆ†åä¸º89ä¸ªç±»</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b44288c2ec941888f02f87780087fe6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765357159&amp;x-signature=84DrUvaAz3B4LueKI8ffSx0IktE%3D" alt="11.png" loading="lazy"/></p>
<h2 data-id="heading-12">å››ã€æœªæ¥å±•æœ›</h2>
<h4 data-id="heading-13">1.   è‡ªåŠ¨æç¤ºä¼˜åŒ–</h4>
<p>åœ¨å¯¹ç›¸ä¼¼é—®æ³•é‡æ–°å½’ç±»çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äººå·¥è°ƒæ•´çš„æ–¹å¼æ¥å¾—åˆ°è¯­è¨€è¡¨è¿°ç²¾å‡†çš„æ„å›¾æè¿°ã€‚æœªæ¥å¯ä½¿ç”¨è‡ªåŠ¨æç¤ºä¼˜åŒ–çš„æ–¹æ³•å¯¹promptè¿›è¡Œè‡ªåŠ¨è°ƒä¼˜ã€‚</p>
<h4 data-id="heading-14">2.  ç›¸ä¼¼é—®æ³•æ¶µç›–å¤šä¸ªæ„å›¾</h4>
<p>é’ˆå¯¹ç›¸ä¼¼é—®æ³•æ¶µç›–å¤šä¸ªæ„å›¾çš„æƒ…å†µï¼Œæœªæ¥å¯ä»¥å°†ç›¸ä¼¼é—®æ³•è¿›è¡Œæ‹†åˆ†å¹¶å†™å…¥å¯¹åº”æ„å›¾çš„ç›¸ä¼¼é—®æ³•ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ» Zustand ä½¿ç”¨æŒ‡å—ï¼šä» 0 åˆ°ç²¾é€šçš„æœ€å¿«è·¯çº¿]]></title>    <link>https://juejin.cn/post/7579168400990027811</link>    <guid>https://juejin.cn/post/7579168400990027811</guid>    <pubDate>2025-12-03T07:06:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579168400990027811" data-draft-id="7579165599043371023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ» Zustand ä½¿ç”¨æŒ‡å—ï¼šä» 0 åˆ°ç²¾é€šçš„æœ€å¿«è·¯çº¿"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T07:06:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½ å¿ƒé‡Œçš„äºæ™"/> <meta itemprop="url" content="https://juejin.cn/user/4485661445853943"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ» Zustand ä½¿ç”¨æŒ‡å—ï¼šä» 0 åˆ°ç²¾é€šçš„æœ€å¿«è·¯çº¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4485661445853943/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½ å¿ƒé‡Œçš„äºæ™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:06:06.000Z" title="Wed Dec 03 2025 07:06:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><em>â€œé•¿å¾—å¯çˆ±ï¼Ÿåˆ«è¢«éª—äº†ã€‚Zustand æ˜¯ React çŠ¶æ€ç®¡ç†é‡Œå”¯ä¸€ä¸€ä¸ªåˆå°ã€åˆç‹ ã€åˆå¿«çš„å°ç†Šã€‚â€</em></p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8332cafd4e0e43c1a6facf5920d6aca5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2g5b-D6YeM55qE5LqO5pmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765350365&amp;x-signature=vzSE21oiGh%2FAep56le48r2POuBg%3D" alt="image.png" loading="lazy"/>
React é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ è§‰å¾— Redux å¤ªâ€œä»ªå¼åŒ–â€ã€Recoil å¤ªâ€œè„‘æ´â€ã€MobX å¤ªâ€œé­”æ³•â€â€¦<br/>
é‚£ä½ å¤§æ¦‚ç‡ä¼šçˆ±ä¸Š <strong>Zustand</strong>ã€‚</p>
<h4 data-id="heading-0">âœ” â€œä½ éœ€è¦å¤šå°‘çŠ¶æ€ç®¡ç†ï¼Œå°±ç»™ä½ å¤šå°‘ï¼Œä¸å¤šä¸å°‘â€ã€‚</h4>
<h3 data-id="heading-1">ä¸€ã€åˆå§‹åŒ–é¡¹ç›®ï¼ˆæœ€ç®€ + æœ€ç°ä»£æ ˆï¼‰</h3>
<pre><code class="hljs language-perl" lang="perl">npm create vite@latest
<span class="hljs-comment"># é€‰æ‹© react-ts æ¨¡æ¿</span>
</code></pre>
<p>å®‰è£… react-router-domï¼ˆv7ï¼‰ã€tailwindcssã€Ant Designï¼š</p>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> react-router-dom
npm install tailwindcss <span class="hljs-keyword">@tailwindcss</span>/vite
npm install antd
</code></pre>
<h4 data-id="heading-2">é…ç½® Tailwind</h4>
<p><code>index.css</code></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@import</span> <span class="hljs-string">"tailwindcss"</span>;
</code></pre>
<h4 data-id="heading-3">é…ç½® aliasï¼š@ â†’ src</h4>
<p><code>vite.config.ts</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">"@vitejs/plugin-react"</span>;
<span class="hljs-keyword">import</span> tailwindcss <span class="hljs-keyword">from</span> <span class="hljs-string">"@tailwindcss/vite"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">react</span>(), <span class="hljs-title function_">tailwindcss</span>()],
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">"@"</span>: <span class="hljs-string">"/src"</span>,
    },
  },
});
</code></pre>
<p><code>tsconfig.app.json</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"paths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"@/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"./src/*"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸€ä¸ªç°ä»£åŒ– React å·¥ç¨‹åˆå§‹åŒ–å®Œæ¯•ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ» äºŒã€ä¸»è§’ç™»åœºï¼šZustand</h2>
<p>å®˜ç½‘ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fzustand.docs.pmnd.rs%2Fgetting-started%2Fintroduction" target="_blank" title="https://zustand.docs.pmnd.rs/getting-started/introduction" ref="nofollow noopener noreferrer">zustand.docs.pmnd.rs/getting-staâ€¦</a></p>
<p>Zustand çš„ç‰¹ç‚¹ï¼š</p>
<h4 data-id="heading-5">â— â€œæ¯ä¸€ä¸ª store å°±æ˜¯ä¸€ä¸ªèƒ½ç›´æ¥ä½¿ç”¨çš„ hookï¼Œä¸éœ€è¦ Providerï¼Œä¸éœ€è¦ contextï¼Œä¸éœ€è¦ boilerplateã€‚â€</h4>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs">npm install zustand
</code></pre>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„ Zustand Store</h2>
<p><code>src/store/counter.ts</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">"zustand"</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">State</span> = {
  <span class="hljs-attr">bears</span>: <span class="hljs-built_in">number</span>;
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Actions</span> = {
  <span class="hljs-attr">increasePopulation</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">removeAllBears</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">updateBears</span>: <span class="hljs-function">(<span class="hljs-params">newBears: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
};

<span class="hljs-keyword">const</span> useCounterStore = create&lt;<span class="hljs-title class_">State</span> &amp; <span class="hljs-title class_">Actions</span>&gt;(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
  <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">increasePopulation</span>: <span class="hljs-function">() =&gt;</span>
    <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">bears</span>: state.<span class="hljs-property">bears</span> + <span class="hljs-number">1</span> })),
  <span class="hljs-attr">removeAllBears</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span> }),
  <span class="hljs-attr">updateBears</span>: <span class="hljs-function">(<span class="hljs-params">newBears: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">bears</span>: newBears }),
}));

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useCounterStore;
</code></pre>
<p>ä½ æ²¡æœ‰çœ‹é”™ï¼š</p>
<h4 data-id="heading-7">âœ” ä¸€ä¸ª store å°±æ˜¯ä¸€ä¸ª hook</h4>
<h4 data-id="heading-8">âœ” å¯ä»¥éšæ—¶åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œä¸ç”¨ Provider</h4>
<h4 data-id="heading-9">âœ” set ä¼šè‡ªåŠ¨åˆå¹¶å¯¹è±¡ï¼Œä¸ä¼šè¦†ç›–æ•´ä¸ª state</h4>
<hr/>
<h2 data-id="heading-10">å››ã€åœ¨ç»„ä»¶ä¸­ä½¿ç”¨çŠ¶æ€</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> useCounterStore <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/counter"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Space</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> bears = <span class="hljs-title function_">useCounterStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">bears</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å½“å‰ bears æ•°é‡: {bears}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Space</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"large"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> useCounterStore.getState().increasePopulation()}
        &gt;
          å¢åŠ 
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> useCounterStore.getState().removeAllBears()}
        &gt;
          é‡ç½®
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Space</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<p>æ³¨æ„ï¼š</p>
<h4 data-id="heading-11">Zustand <strong>ä¸éœ€è¦ provider</strong></h4>
<h4 data-id="heading-12"><code>useStore.getState()</code> å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼ˆäº‹ä»¶å›è°ƒ/å¼‚æ­¥é€»è¾‘/é React æ–‡ä»¶ï¼ï¼‰</h4>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/672c9d3a3c3b4eb8aa529c91e6f73629~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2g5b-D6YeM55qE5LqO5pmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765350365&amp;x-signature=NJvjV4OBkK0DUVCeShh0fgfRALU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-13">äº”ã€æŒä¹…åŒ–ï¼šåˆ·æ–°æµè§ˆå™¨ä¹Ÿä¸ä¸¢æ•°æ®</h2>
<p>Zustand çš„ persist ä¸­é—´ä»¶ï¼Œå¯ä»¥ç›´æ¥æŠŠæ•°æ®å­˜åˆ° localStorage / sessionStorageã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">"zustand"</span>;
<span class="hljs-keyword">import</span> { persist, createJSONStorage } <span class="hljs-keyword">from</span> <span class="hljs-string">"zustand/middleware"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> usePersistCounterStore = create&lt;{
  <span class="hljs-attr">persistCounter</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">addPersistCounter</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}&gt;()(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({
      <span class="hljs-attr">persistCounter</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">addPersistCounter</span>: <span class="hljs-function">() =&gt;</span>
        <span class="hljs-title function_">set</span>({ <span class="hljs-attr">persistCounter</span>: <span class="hljs-title function_">get</span>().<span class="hljs-property">persistCounter</span> + <span class="hljs-number">1</span> }),
    }),
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"food-storage"</span>,
      <span class="hljs-attr">storage</span>: <span class="hljs-title function_">createJSONStorage</span>(<span class="hljs-function">() =&gt;</span> sessionStorage),
    }
  )
);
</code></pre>
<p>ä¸Šè¿°ä»“åº“æ•°æ®æºå³ä¿å­˜åœ¨sessionStorageã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f57769bddb414ef2b5134ddf7176f0b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2g5b-D6YeM55qE5LqO5pmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765350365&amp;x-signature=CHIj3KGDUJX5eFfVggGgjQ7NGPk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-14">persist ä¸­é—´ä»¶èƒ½åŠ›ï¼š</h4>
<ul>
<li>è‡ªåŠ¨åºåˆ—åŒ– JSON</li>
<li>æ”¯æŒ localStorage / sessionStorage</li>
<li>æ”¯æŒè‡ªå®šä¹‰ storageï¼ˆIndexDB / è‡ªå·±å°è£…ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-15">å…­ã€æ¥å…¥ Devtoolsï¼šå¯è§†åŒ–æŸ¥çœ‹ Zustand çŠ¶æ€ï¼ˆå¼ºæ¨ï¼‰</h2>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> { devtools } from <span class="hljs-string">"zustand/middleware"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> usePersistCounterStore = create&lt;{
  persistCounter: number;
  addPersistCounter: () =&gt; <span class="hljs-keyword">void</span>;
}&gt;()(
  devtools(
    persist(
      (<span class="hljs-keyword">set</span>, <span class="hljs-keyword">get</span>) =&gt; ({
        persistCounter: <span class="hljs-number">0</span>,
        addPersistCounter: () =&gt;
          <span class="hljs-keyword">set</span>({ persistCounter: <span class="hljs-keyword">get</span>().persistCounter + <span class="hljs-number">1</span> }),
      }),
      {
        name: <span class="hljs-string">"food-storage"</span>,
        storage: createJSONStorage(() =&gt; sessionStorage),
      }
    )
  )
);
</code></pre>
<p>å®‰è£… Redux Devtools æ’ä»¶å³å¯ç›´æ¥çœ‹åˆ° Zustand çŠ¶æ€å˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18dc1512bc8c4536813e2aec8d942921~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2g5b-D6YeM55qE5LqO5pmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765350365&amp;x-signature=04hkJ5eJrRY95hi2mKlLPczic1E%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-16">ä¸ƒã€subscribe-with-selectorï¼šç²¾ç¡®è®¢é˜…ï¼ˆæ€§èƒ½ç¥å™¨ï¼‰</h2>
<p>Zustand é»˜è®¤æŒ‰ selector è¿”å›å€¼å˜åŒ–è§¦å‘æ¸²æŸ“ã€‚<br/>
å¦‚æœä½ æƒ³åœ¨ç»„ä»¶å¤–è®¢é˜…å˜åŒ–ï¼ˆæ¯”å¦‚ WebSocket æ›´æ–° / å®šæ—¶å™¨ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>subscribeWithSelector</code> ä¸­é—´ä»¶ã€‚</p>
<p>ğŸ”¥ å®˜ç½‘æ¨èå†™å¤§å‹é¡¹ç›®å¿…é¡»é…è¿™ä¸ªã€‚</p>
<p>æ–‡æ¡£ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fzustand.docs.pmnd.rs%2Fmiddlewares%2Fsubscribe-with-selector" target="_blank" title="https://zustand.docs.pmnd.rs/middlewares/subscribe-with-selector" ref="nofollow noopener noreferrer">zustand.docs.pmnd.rs/middlewaresâ€¦</a></p>
<hr/>
<h2 data-id="heading-17">âš” å…«ã€ä¸ºä»€ä¹ˆ Zustand è¢«ç§°ä¸ºå°ä½“ç§¯å´â€œæœ‰çˆªå­â€ï¼Ÿ</h2>
<p>å®ƒè§£å†³äº† React çŠ¶æ€ç®¡ç†çš„ä¸‰å¤§å™©æ¢¦ï¼š</p>
<h4 data-id="heading-18">âŒ åƒµå°¸å­ç»„ä»¶ï¼ˆZombie Childï¼‰</h4>
<h4 data-id="heading-19">âŒ React 18 æ›´æ–°ä¸¢å¤±</h4>
<h4 data-id="heading-20">âŒ å¤šæ¸²æŸ“å™¨ï¼ˆå¦‚ React Nativeï¼‰ä¸Šä¸‹æ–‡é”™ä¹±</h4>
<p>Zustand å†…éƒ¨ä½¿ç”¨ Proxy + è®¢é˜…æœºåˆ¶ï¼Œå®Œå…¨é¿å¼€äº†è¿™äº›é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-21">ä¹ã€Redux vs Zustand ç®€è¦å¯¹æ¯”</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Redux Toolkit</th><th>Zustand</th></tr></thead><tbody><tr><td>å­¦ä¹ æ›²çº¿</td><td>æœ‰è®¾è®¡ç†å¿µï¼Œç•¥é‡</td><td>æå¿«ï¼Œå‡ åˆ†é’Ÿä¸Šæ‰‹</td></tr><tr><td>æ ¸å¿ƒæ€æƒ³</td><td>Flux å•å‘æ•°æ®æµ</td><td>Hooks + minimal store</td></tr><tr><td>éœ€è¦ Provider</td><td>âœ” å¿…é¡»</td><td>âŒ ä¸éœ€è¦</td></tr><tr><td>æŒä¹…åŒ–</td><td>éœ€è¦æ’ä»¶</td><td>å†…ç½®ä¸­é—´ä»¶</td></tr><tr><td>Devtools</td><td>å®˜æ–¹æ”¯æŒ</td><td>âœ” ç›´æ¥å…¼å®¹</td></tr><tr><td>é€‚åˆè§„æ¨¡</td><td>ä¸­å¤§å‹å¤æ‚ä¸šåŠ¡</td><td>ä¸­å°ä¸šåŠ¡ + å¤§å‹é«˜æ€§èƒ½é¡¹ç›®</td></tr></tbody></table>
<h4 data-id="heading-22">ç»“è®ºï¼š</h4>
<blockquote>
<p><strong>Zustand ç”¨æœ€å°‘çš„ API åšäº†æœ€å¼ºçš„çŠ¶æ€ç®¡ç†ï¼Œæ˜¯ç›®å‰ React åº”ç”¨é‡Œæœ€å¥½ç”¨çš„è½»é‡çº§å…¨å±€çŠ¶æ€æ–¹æ¡ˆï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-23">ğŸ åã€æ€»ç»“ï¼šä¸ºä»€ä¹ˆä½ åº”è¯¥åœ¨æ–°é¡¹ç›®é‡Œé€‰ Zustandï¼Ÿ</h2>
<ul>
<li>æ—  Providerã€æ— æ ·æ¿ä»£ç ã€æ— å¤æ‚å¿ƒæ™ºè´Ÿæ‹…</li>
<li>é€»è¾‘å¯ä»¥å†™åœ¨ React å¤–</li>
<li>æè½»é‡ï¼ˆâ‰ˆ1KBï¼‰ï¼Œæ€§èƒ½æå¼º</li>
<li>å®˜æ–¹ä¸­é—´ä»¶å·²ç»è¦†ç›–å¤§éƒ¨åˆ†éœ€æ±‚ï¼ˆpersist / devtools / immer / subscribe-with-selectorï¼‰</li>
<li>å®Œç¾å…¼å®¹ React 18ã€React Nativeã€SSR</li>
<li>å†™èµ·æ¥åƒ useStateï¼Œå´æ˜¯å…¨å±€ store</li>
</ul>
<h4 data-id="heading-24"><strong>ä»£ç å†™èµ·æ¥çˆ½å°±å®Œäº‹äº†</strong>ã€‚</h4>
<h4 data-id="heading-25">å»¶ä¼¸é˜…è¯»</h4>
<ul>
<li>zustand å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzustand.docs.pmnd.rs%2F" target="_blank" title="https://zustand.docs.pmnd.rs/" ref="nofollow noopener noreferrer">zustand.docs.pmnd.rs/</a></li>
<li>ä¸ªäººdemoåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsue-boy%2Fvite-react-zustand" target="_blank" title="https://gitee.com/sue-boy/vite-react-zustand" ref="nofollow noopener noreferrer">gitee.com/sue-boy/vitâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python æ•°æ®åˆ†æå®æˆ˜ï¼šå¤šåœºæ™¯æ•°æ®å¤„ç†ä¸å¯è§†åŒ–å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7579179741824991258</link>    <guid>https://juejin.cn/post/7579179741824991258</guid>    <pubDate>2025-12-03T06:27:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579179741824991258" data-draft-id="7578699975414710272" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python æ•°æ®åˆ†æå®æˆ˜ï¼šå¤šåœºæ™¯æ•°æ®å¤„ç†ä¸å¯è§†åŒ–å…¨è§£æ"/> <meta itemprop="keywords" content="Python,PyCharm,ç¼–ç¨‹è¯­è¨€"/> <meta itemprop="datePublished" content="2025-12-03T06:27:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»Šå¤©æ²¡æœ‰ç›"/> <meta itemprop="url" content="https://juejin.cn/user/1408937846645355"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python æ•°æ®åˆ†æå®æˆ˜ï¼šå¤šåœºæ™¯æ•°æ®å¤„ç†ä¸å¯è§†åŒ–å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1408937846645355/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»Šå¤©æ²¡æœ‰ç›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T06:27:13.000Z" title="Wed Dec 03 2025 06:27:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<p>åœ¨æ•°æ®é©±åŠ¨çš„æ—¶ä»£ï¼ŒæŒæ¡æ•°æ®åˆ†ææŠ€èƒ½è‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†å¸¦ä½ ä½¿ç”¨ Python ä¸­çš„ pandasã€numpy å’Œ matplotlib åº“ï¼Œå¯¹åœ°é“å®¢æµã€ç½‘çº¦è½¦è®¢å•ã€ä½“æ£€ä¸­å¿ƒå¥åº·å’Œå¥èº«æˆ¿è¿åŠ¨å››ç±»çœŸå®åœºæ™¯çš„æ•°æ®è¿›è¡Œå®Œæ•´åˆ†æã€‚æ¯ä¸ªæ¡ˆä¾‹éƒ½åŒ…å«æ•°æ®æ¸…æ´—ã€ç»Ÿè®¡è®¡ç®—ã€å¯è§†åŒ–å‘ˆç°å’Œç»“æœè§£è¯»ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€åœ°é“å®¢æµæ•°æ®åˆ†æ</h3>
<h4 data-id="heading-2">ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># 1. è¯»å– CSV æ–‡ä»¶æ•°æ®ï¼Œè®¡ç®—æ¯ä¸ªç«™ç‚¹çš„æ€»å®¢æµï¼ˆè¿›ç«™äººæ•° + å‡ºç«™äººæ•°ï¼‰ï¼Œæ·»åŠ ä¸ºæ–°åˆ—ã€‚</span>
df = pd.read_csv(<span class="hljs-string">"åœ°é“å®¢æµæ•°æ®.csv"</span>)
df[<span class="hljs-string">'æ€»å®¢æµ'</span>] = df[<span class="hljs-string">'è¿›ç«™äººæ•°'</span>] + df[<span class="hljs-string">'å‡ºç«™äººæ•°'</span>]
<span class="hljs-built_in">print</span>(df)
total = df.groupby(<span class="hljs-string">'ç«™ç‚¹åç§°'</span>)[<span class="hljs-string">'æ€»å®¢æµ'</span>].<span class="hljs-built_in">sum</span>()
<span class="hljs-built_in">print</span>(total)

<span class="hljs-comment"># 2. æŒ‰ â€œçº¿è·¯â€ å’Œ â€œæ—¶æ®µâ€ åŒé‡åˆ†ç»„ï¼Œç»Ÿè®¡ä¸åŒçº¿è·¯ã€ä¸åŒæ—¶æ®µçš„å¹³å‡è¿›ç«™äººæ•°ã€‚</span>
avg_in = df.groupby([<span class="hljs-string">'çº¿è·¯'</span>, <span class="hljs-string">'æ—¶æ®µ (æ—©é«˜å³°/å¹³å³°/æ™šé«˜å³°)'</span>])[<span class="hljs-string">'è¿›ç«™äººæ•°'</span>].mean()
<span class="hljs-built_in">print</span>(avg_in)

<span class="hljs-comment"># 3. æå– â€œæ—¥æœŸâ€ ä¸­çš„æœˆä»½ï¼Œç»Ÿè®¡æ¯æœˆçš„æ€»å®¢æµï¼ˆæ‰€æœ‰ç«™ç‚¹è¿›å‡ºç«™ä¹‹å’Œï¼‰ï¼Œç»˜åˆ¶æŸ±çŠ¶å›¾ã€‚</span>
df[<span class="hljs-string">'æ—¥æœŸ'</span>] = pd.to_datetime(df[<span class="hljs-string">'æ—¥æœŸ'</span>]) <span class="hljs-comment"># å­—ç¬¦ä¸²è½¬æ¢ä¸ºdatetime</span>
df[<span class="hljs-string">'æœˆä»½'</span>] = df[<span class="hljs-string">'æ—¥æœŸ'</span>].dt.month
total_month = df.groupby(<span class="hljs-string">'æœˆä»½'</span>)[<span class="hljs-string">'æ€»å®¢æµ'</span>].<span class="hljs-built_in">sum</span>()
plt.bar(total_month.index, total_month)
plt.show()

<span class="hljs-comment"># 4. è®¡ç®—æ¯ä¸ªç«™ç‚¹è¿›ç«™äººæ•°ä¸å‡ºç«™äººæ•°çš„ç›¸å…³ç³»æ•°ã€‚</span>
station = df.groupby(<span class="hljs-string">'ç«™ç‚¹åç§°'</span>).agg({
    <span class="hljs-string">'è¿›ç«™äººæ•°'</span>:<span class="hljs-string">'sum'</span>,
    <span class="hljs-string">'å‡ºç«™äººæ•°'</span>:<span class="hljs-string">'sum'</span>
}).sort_index()
<span class="hljs-built_in">print</span>(station)
corr = station[<span class="hljs-string">'è¿›ç«™äººæ•°'</span>].corr(station[<span class="hljs-string">'å‡ºç«™äººæ•°'</span>])
<span class="hljs-built_in">print</span>(corr)

<span class="hljs-comment"># 5. ç­›é€‰å‡ºæ€»å®¢æµå‰ 10 çš„ç«™ç‚¹ï¼Œç»˜åˆ¶æ°´å¹³æŸ±çŠ¶å›¾å±•ç¤ºç»“æœã€‚</span>
plt.rcParams[<span class="hljs-string">'font.sans-serif'</span>] = [<span class="hljs-string">'SimHei'</span>] <span class="hljs-comment"># é»‘ä½“</span>
total = total.sort_values(ascending=<span class="hljs-literal">False</span>) <span class="hljs-comment"># é™åºæ’åº</span>
top10 = total[:<span class="hljs-number">10</span>]
<span class="hljs-built_in">print</span>(top10)
plt.bar(top10.index, top10)
plt.show()
</code></pre>
<h4 data-id="heading-3">ä»£ç ç»“æœ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/706abbe35f3e4062913bb796339bab48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5rKh5pyJ55uQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765348032&amp;x-signature=RlZwkgwblWR%2B76NaRv4s9FiY1sg%3D" alt="1101.png" loading="lazy"/></p>
<h4 data-id="heading-4">ä»£ç åˆ†æ</h4>
<ul>
<li><strong>æ•°æ®é¢„å¤„ç†</strong>ï¼šä½¿ç”¨ <code>pd.read_csv</code> è¯»å–æ•°æ®ï¼Œé€šè¿‡åˆ—è¿ç®—æ·»åŠ â€œæ€»å®¢æµâ€åˆ—ã€‚</li>
<li><strong>åˆ†ç»„ç»Ÿè®¡</strong>ï¼šåˆ©ç”¨ <code>groupby</code> å®ç°å•åˆ†ç»„å’ŒåŒé‡åˆ†ç»„ç»Ÿè®¡ï¼Œç»“åˆ <code>sum()</code>ã€<code>mean()</code> å®Œæˆèšåˆè®¡ç®—ã€‚</li>
<li><strong>æ—¶é—´å¤„ç†</strong>ï¼šé€šè¿‡ <code>pd.to_datetime</code> è½¬æ¢æ—¥æœŸæ ¼å¼ï¼Œæå–æœˆä»½è¿›è¡Œæœˆåº¦ç»Ÿè®¡ã€‚</li>
<li><strong>ç›¸å…³æ€§åˆ†æ</strong>ï¼šå…ˆæŒ‰ç«™ç‚¹èšåˆè¿›å‡ºç«™äººæ•°ï¼Œå†ä½¿ç”¨ <code>corr()</code> è®¡ç®—ç›¸å…³ç³»æ•°ã€‚</li>
<li><strong>å¯è§†åŒ–</strong>ï¼šä½¿ç”¨ <code>plt.bar</code> ç»˜åˆ¶æŸ±çŠ¶å›¾ï¼Œå¹¶è®¾ç½®ä¸­æ–‡å­—ä½“é˜²æ­¢ä¹±ç ã€‚</li>
<li><strong>æ•°æ®ç­›é€‰</strong>ï¼šé€šè¿‡ <code>sort_values</code> å’Œåˆ‡ç‰‡è·å– Top10 æ•°æ®ã€‚</li>
</ul>
<h3 data-id="heading-5">äºŒã€ç½‘çº¦è½¦è®¢å•æ•°æ®åˆ†æ</h3>
<h4 data-id="heading-6">ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. è¯»å– CSV æ–‡ä»¶æ•°æ®ï¼Œè®¡ç®—è®¢å•æ€»è´¹ç”¨ï¼ˆèµ·æ­¥ä»· + è¡Œç¨‹è·ç¦» Ã— é‡Œç¨‹è´¹ + é™„åŠ è´¹ï¼‰ï¼Œæ·»åŠ ä¸ºæ–°åˆ—ã€‚</span>
data = pd.read_csv(
    <span class="hljs-string">"ç½‘çº¦è½¦è®¢å•æ•°æ®.csv"</span>,
    index_col=<span class="hljs-string">"è®¢å•ID"</span>
)
data[<span class="hljs-string">'è®¢å•é‡'</span>] = [<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data.shape[<span class="hljs-number">0</span>])]
data[<span class="hljs-string">'æ€»è´¹ç”¨'</span>] = data[<span class="hljs-string">'èµ·æ­¥ä»· (å…ƒ)'</span>] + data[<span class="hljs-string">'è¡Œç¨‹è·ç¦» (km)'</span>]*data[<span class="hljs-string">'é‡Œç¨‹è´¹ (å…ƒ/km)'</span>] + data[<span class="hljs-string">'é™„åŠ è´¹ (å…ƒ)'</span>]
<span class="hljs-built_in">print</span>(data)

<span class="hljs-comment"># 2. æŒ‰ â€œå‡ºå‘æ—¶é—´â€ æå–å°æ—¶ä¿¡æ¯ï¼Œç»Ÿè®¡å„å°æ—¶çš„è®¢å•é‡å’Œå¹³å‡è¡Œç¨‹è·ç¦»ã€‚</span>
data[<span class="hljs-string">'å‡ºå‘æ—¶é—´'</span>] = pd.to_datetime(data[<span class="hljs-string">'å‡ºå‘æ—¶é—´'</span>])
data[<span class="hljs-string">'å°æ—¶'</span>] = data[<span class="hljs-string">'å‡ºå‘æ—¶é—´'</span>].dt.hour
state = data.groupby(<span class="hljs-string">'å°æ—¶'</span>).agg({
    <span class="hljs-string">'è®¢å•é‡'</span>:<span class="hljs-string">'sum'</span>,
    <span class="hljs-string">'è¡Œç¨‹è·ç¦» (km)'</span>:<span class="hljs-string">'mean'</span>
})
<span class="hljs-built_in">print</span>(state)

<span class="hljs-comment"># 3. è®¡ç®—æ€»è´¹ç”¨çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€å‡å€¼å’Œæ ‡å‡†å·®ã€‚</span>
total_sales_state = data[<span class="hljs-string">'æ€»è´¹ç”¨'</span>].agg([<span class="hljs-string">'max'</span>, <span class="hljs-string">'min'</span>, <span class="hljs-string">'mean'</span>, <span class="hljs-string">'std'</span>])
<span class="hljs-built_in">print</span>(total_sales_state)

<span class="hljs-comment"># 4. æŒ‰è¡Œç¨‹è·ç¦»åˆ†ç»„ï¼ˆ0-5kmã€5-10kmã€10km+ï¼‰ï¼Œç»Ÿè®¡æ¯ç»„çš„è®¢å•æ•°å’Œå¹³å‡æ€»è´¹ç”¨ï¼Œç»˜åˆ¶æŸ±çŠ¶å›¾ã€‚</span>
data_taxi = data.groupby(<span class="hljs-string">'è¡Œç¨‹è·ç¦» (km)'</span>).agg({
    <span class="hljs-string">'è®¢å•é‡'</span>:<span class="hljs-string">'sum'</span>,
    <span class="hljs-string">'æ€»è´¹ç”¨'</span>:<span class="hljs-string">'mean'</span>
})
plt.bar(data_taxi.index, data_taxi[<span class="hljs-string">'è®¢å•é‡'</span>])
plt.show()
plt.bar(data_taxi.index, data_taxi[<span class="hljs-string">'æ€»è´¹ç”¨'</span>])
plt.show()

<span class="hljs-comment"># 5. ä¿å­˜è¡Œç¨‹è·ç¦» â‰¥10km çš„è®¢å•æ•°æ®ä¸º â€œé•¿é€”è®¢å•.csvâ€ï¼ˆä¸å«ç´¢å¼•ï¼‰ã€‚</span>
new_data = data[data[<span class="hljs-string">'è¡Œç¨‹è·ç¦» (km)'</span>] &gt;= <span class="hljs-number">10</span>]
<span class="hljs-built_in">print</span>(new_data)
new_data.to_csv(<span class="hljs-string">"é•¿é€”è®¢å•.csv"</span>)
</code></pre>
<h4 data-id="heading-7">ä»£ç ç»“æœ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93ecb92a99ef4b169a67397396a29718~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5rKh5pyJ55uQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765348032&amp;x-signature=Sn8Fz5QFBzH7VP0A5erO1%2BisCd8%3D" alt="1102.png" loading="lazy"/></p>
<h4 data-id="heading-8">ä»£ç åˆ†æ</h4>
<ul>
<li><strong>è´¹ç”¨è®¡ç®—</strong>ï¼šé€šè¿‡åˆ—è¿ç®—å®ç°æ€»è´¹ç”¨å…¬å¼ï¼Œæ³¨æ„å•ä½ä¸ºå…ƒã€‚</li>
<li><strong>æ—¶é—´æå–</strong>ï¼šä½¿ç”¨ <code>dt.hour</code> æå–å°æ—¶ä¿¡æ¯ï¼Œä¾¿äºæŒ‰å°æ—¶èšåˆã€‚</li>
<li><strong>å¤šæŒ‡æ ‡èšåˆ</strong>ï¼šåœ¨ <code>groupby</code> åä½¿ç”¨ <code>agg</code> åŒæ—¶è®¡ç®—å¤šä¸ªç»Ÿè®¡é‡ã€‚</li>
<li><strong>åˆ†ç»„ç»Ÿè®¡</strong>ï¼šç›´æ¥æŒ‰æ•°å€¼åˆ—åˆ†ç»„ï¼Œä½†æ›´ä½³åšæ³•æ˜¯ä½¿ç”¨ <code>pd.cut</code> è¿›è¡ŒåŒºé—´åˆ†ç»„ã€‚</li>
<li><strong>æ•°æ®ç­›é€‰ä¸å¯¼å‡º</strong>ï¼šä½¿ç”¨å¸ƒå°”ç´¢å¼•ç­›é€‰é•¿é€”è®¢å•ï¼Œ<code>to_csv</code> å¯¼å‡ºæ—¶è®¾ç½® <code>index=False</code> å¯çœç•¥ç´¢å¼•ã€‚</li>
</ul>
<h3 data-id="heading-9">ä¸‰ã€ä½“æ£€ä¸­å¿ƒå¥åº·æ•°æ®åˆ†æ</h3>
<h4 data-id="heading-10">ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. è¯»å– CSV æ–‡ä»¶æ•°æ®ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé«˜è¡€å‹ï¼ˆæ”¶ç¼©å‹ â‰¥140 æˆ–èˆ’å¼ å‹ â‰¥90ï¼‰ï¼Œæ·»åŠ  â€œæ˜¯å¦é«˜è¡€å‹â€ åˆ—ï¼ˆæ˜¯ / å¦ï¼‰ã€‚</span>
df = pd.read_csv(
    <span class="hljs-string">"ä½“æ£€æ•°æ®.csv"</span>,
    index_col=<span class="hljs-string">"ä½“æ£€ç¼–å·"</span>
)
df[<span class="hljs-string">'æ˜¯å¦é«˜è¡€å‹'</span>] = np.where((df[<span class="hljs-string">'æ”¶ç¼©å‹ (mmHg)'</span>]&gt;=<span class="hljs-number">140</span>)|(df[<span class="hljs-string">'èˆ’å¼ å‹ (mmHg)'</span>] &gt;= <span class="hljs-number">90</span>), <span class="hljs-string">'æ˜¯'</span>, <span class="hljs-string">'å¦'</span>)
<span class="hljs-built_in">print</span>(df)

<span class="hljs-comment"># 2. æŒ‰ â€œæ€§åˆ«â€ å’Œ â€œå¹´é¾„åˆ†ç»„â€ï¼ˆ18-30ã€31-50ã€50+ï¼‰åŒé‡åˆ†ç»„ï¼Œç»Ÿè®¡æ¯ç»„çš„é«˜è¡€å‹æ¯”ä¾‹ã€‚</span>
df[<span class="hljs-string">'å¹´é¾„åˆ†ç»„'</span>] = pd.cut(
    df[<span class="hljs-string">'å¹´é¾„'</span>],
    bins=[<span class="hljs-number">17</span>, <span class="hljs-number">30</span>, <span class="hljs-number">50</span>, np.inf],
    labels=[<span class="hljs-string">'18-30'</span>, <span class="hljs-string">'31-50'</span>, <span class="hljs-string">'50+'</span>],
    right=<span class="hljs-literal">False</span>
)
<span class="hljs-built_in">print</span>(df)
state = df.groupby([<span class="hljs-string">'æ€§åˆ«'</span>, <span class="hljs-string">'å¹´é¾„åˆ†ç»„'</span>])[<span class="hljs-string">'æ˜¯å¦é«˜è¡€å‹'</span>].apply(<span class="hljs-keyword">lambda</span> x:(x == <span class="hljs-string">'æ˜¯'</span>).mean()).reset_index()
state[<span class="hljs-string">'é«˜è¡€å‹æ¯”ä¾‹'</span>] = state[<span class="hljs-string">'æ˜¯å¦é«˜è¡€å‹'</span>].<span class="hljs-built_in">round</span>(<span class="hljs-number">3</span>) * <span class="hljs-number">100</span>
<span class="hljs-built_in">print</span>(state)

<span class="hljs-comment"># 3. è®¡ç®—ç©ºè…¹è¡€ç³–ä¸èƒ†å›ºé†‡çš„ç›¸å…³ç³»æ•°ã€‚</span>
corr = df[<span class="hljs-string">'ç©ºè…¹è¡€ç³– (mmol/L)'</span>].corr(df[<span class="hljs-string">'èƒ†å›ºé†‡ (mmol/L)'</span>])
<span class="hljs-built_in">print</span>(corr)

<span class="hljs-comment"># 4. æŒ‰æ€§åˆ«åˆ†ç»„ï¼Œç»Ÿè®¡æ”¶ç¼©å‹ã€èˆ’å¼ å‹ã€ç©ºè…¹è¡€ç³–çš„å‡å€¼å’Œæ–¹å·®ï¼ˆä½¿ç”¨ agg å‡½æ•°ï¼‰ã€‚</span>
df_mean = df.groupby(<span class="hljs-string">'æ€§åˆ«'</span>).agg({
    <span class="hljs-string">'æ”¶ç¼©å‹ (mmHg)'</span>:<span class="hljs-string">'mean'</span>,
    <span class="hljs-string">'èˆ’å¼ å‹ (mmHg)'</span>:<span class="hljs-string">'mean'</span>,
    <span class="hljs-string">'ç©ºè…¹è¡€ç³– (mmol/L)'</span>:<span class="hljs-string">'mean'</span>
})
<span class="hljs-built_in">print</span>(df_mean)
df_var = df.groupby(<span class="hljs-string">'æ€§åˆ«'</span>).agg({
    <span class="hljs-string">'æ”¶ç¼©å‹ (mmHg)'</span>:<span class="hljs-string">'var'</span>,
    <span class="hljs-string">'èˆ’å¼ å‹ (mmHg)'</span>:<span class="hljs-string">'var'</span>,
    <span class="hljs-string">'ç©ºè…¹è¡€ç³– (mmol/L)'</span>:<span class="hljs-string">'var'</span>
})
<span class="hljs-built_in">print</span>(df_var)

<span class="hljs-comment"># 5. ç»˜åˆ¶ç”·æ€§å’Œå¥³æ€§çš„å¹³å‡æ”¶ç¼©å‹å¯¹æ¯”æŸ±çŠ¶å›¾ã€‚</span>
plt.bar(df_mean.index, df_mean[<span class="hljs-string">'æ”¶ç¼©å‹ (mmHg)'</span>])
plt.show()
</code></pre>
<h4 data-id="heading-11">ä»£ç ç»“æœ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3325c8880f7346969a054d67ada68ca3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5rKh5pyJ55uQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765348032&amp;x-signature=a6eCPIMiHxvOHFQ%2BYZinVMXN2eo%3D" alt="1103.png" loading="lazy"/></p>
<h4 data-id="heading-12">ä»£ç åˆ†æ</h4>
<ul>
<li><strong>æ¡ä»¶åˆ¤æ–­åˆ—</strong>ï¼šä½¿ç”¨ <code>np.where</code> å®ç°æ¡ä»¶åˆ¤æ–­ï¼Œç”Ÿæˆåˆ†ç±»åˆ—ã€‚</li>
<li><strong>åŒºé—´åˆ†ç»„</strong>ï¼š<code>pd.cut</code> å¯å°†è¿ç»­å¹´é¾„ç¦»æ•£åŒ–ä¸ºå¹´é¾„æ®µï¼Œ<code>right=False</code> è¡¨ç¤ºå·¦é—­å³å¼€ã€‚</li>
<li><strong>æ¯”ä¾‹è®¡ç®—</strong>ï¼šåœ¨ <code>groupby</code> åä½¿ç”¨ <code>apply</code> ç»“åˆ lambda å‡½æ•°è®¡ç®—é«˜è¡€å‹æ¯”ä¾‹ã€‚</li>
<li><strong>å¤šå‡½æ•°èšåˆ</strong>ï¼š<code>agg</code> å¯åŒæ—¶æŒ‡å®šå¤šä¸ªç»Ÿè®¡å‡½æ•°ï¼Œä¹Ÿå¯åˆ†åˆ«è®¡ç®—å‡å€¼å’Œæ–¹å·®ã€‚</li>
<li><strong>ç®€å•å¯è§†åŒ–</strong>ï¼šç›´æ¥ä½¿ç”¨åˆ†ç»„èšåˆç»“æœç»˜åˆ¶æŸ±çŠ¶å›¾ï¼Œç›´è§‚å¯¹æ¯”æ€§åˆ«å·®å¼‚ã€‚</li>
</ul>
<h3 data-id="heading-13">å››ã€å¥èº«æˆ¿è¿åŠ¨æ•°æ®åˆ†æ</h3>
<h4 data-id="heading-14">ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. è¯»å– CSV æ–‡ä»¶æ•°æ®ï¼Œå°† â€œè¿åŠ¨æ—¥æœŸâ€ è½¬æ¢ä¸º datetime æ ¼å¼ã€‚</span>
data = pd.read_csv(
    <span class="hljs-string">"å¥èº«æˆ¿æ•°æ®.csv"</span>,
    index_col=<span class="hljs-string">"ç”¨æˆ·ID"</span>
)
data[<span class="hljs-string">'è¿åŠ¨æ—¥æœŸ'</span>] = pd.to_datetime(data[<span class="hljs-string">'è¿åŠ¨æ—¥æœŸ'</span>])
<span class="hljs-built_in">print</span>(data)

<span class="hljs-comment"># 2. æŒ‰ â€œè¿åŠ¨ç±»å‹â€ åˆ†ç»„ï¼Œç»Ÿè®¡å¹³å‡è¿åŠ¨æ—¶é•¿ã€å¹³å‡æ¶ˆè€—çƒ­é‡å’Œç”¨æˆ·æ•°ã€‚</span>
data[<span class="hljs-string">'ç”¨æˆ·ä¸ªæ•°'</span>] = [<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data.shape[<span class="hljs-number">0</span>])]
state = data.groupby(<span class="hljs-string">'è¿åŠ¨ç±»å‹ (æœ‰æ°§/åŠ›é‡/ç»¼åˆ)'</span>).agg({
    <span class="hljs-string">'è¿åŠ¨æ—¶é•¿ (åˆ†é’Ÿ)'</span>:<span class="hljs-string">'mean'</span>,
    <span class="hljs-string">'æ¶ˆè€—çƒ­é‡ (å¤§å¡)'</span>:<span class="hljs-string">'mean'</span>,
    <span class="hljs-string">'ç”¨æˆ·ä¸ªæ•°'</span>:<span class="hljs-string">'sum'</span>
})
<span class="hljs-built_in">print</span>(state)

<span class="hljs-comment"># 3. æå– â€œè¿åŠ¨æ—¥æœŸâ€ ä¸­çš„æœˆä»½ï¼Œç»Ÿè®¡æ¯æœˆçš„æ€»è¿åŠ¨æ—¶é•¿ï¼Œç»˜åˆ¶æŠ˜çº¿å›¾ã€‚</span>
data[<span class="hljs-string">'æœˆä»½'</span>] = data[<span class="hljs-string">'è¿åŠ¨æ—¥æœŸ'</span>].dt.month
month_day = data.groupby(<span class="hljs-string">'æœˆä»½'</span>)[<span class="hljs-string">'è¿åŠ¨æ—¶é•¿ (åˆ†é’Ÿ)'</span>].<span class="hljs-built_in">sum</span>()
plt.plot(month_day.index, month_day)
plt.show()

<span class="hljs-comment"># 4. è®¡ç®—è¿åŠ¨æ—¶é•¿ä¸æ¶ˆè€—çƒ­é‡çš„ç›¸å…³ç³»æ•°ã€‚</span>
corr = data[<span class="hljs-string">'è¿åŠ¨æ—¶é•¿ (åˆ†é’Ÿ)'</span>].corr(data[<span class="hljs-string">'æ¶ˆè€—çƒ­é‡ (å¤§å¡)'</span>])
<span class="hljs-built_in">print</span>(corr)

<span class="hljs-comment"># 5. ç­›é€‰å‡ºæ¶ˆè€—çƒ­é‡ â‰¥500 å¤§å¡çš„è®°å½•ï¼Œä¿å­˜ä¸º â€œé«˜å¼ºåº¦è¿åŠ¨è®°å½•.csvâ€ï¼ˆä¸å«ç´¢å¼•ï¼‰ã€‚</span>
new_Data = data[data[<span class="hljs-string">'æ¶ˆè€—çƒ­é‡ (å¤§å¡)'</span>] &gt;= <span class="hljs-number">500</span>]
<span class="hljs-built_in">print</span>(new_Data)
new_Data.to_csv(<span class="hljs-string">'é«˜å¼ºåº¦è¿åŠ¨è®°å½•.csv'</span>)
</code></pre>
<h4 data-id="heading-15">ä»£ç ç»“æœ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb1fb18ec90b4378b952d5371448ca5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5rKh5pyJ55uQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765348032&amp;x-signature=U37tBMZYN2loa3lwTjE4qewuWYU%3D" alt="1104.png" loading="lazy"/></p>
<h4 data-id="heading-16">ä»£ç åˆ†æ</h4>
<ul>
<li><strong>æ—¥æœŸå¤„ç†</strong>ï¼š<code>pd.to_datetime</code> å°†å­—ç¬¦ä¸²è½¬ä¸ºæ—¶é—´æ ¼å¼ï¼Œä¾¿äºæå–æœˆä»½ã€‚</li>
<li><strong>ç”¨æˆ·è®¡æ•°</strong>ï¼šé€šè¿‡æ·»åŠ å€¼ä¸º1çš„åˆ—å®ç°è®¡æ•°ï¼Œä¹Ÿå¯ç›´æ¥ç”¨ <code>size()</code> ç»Ÿè®¡ã€‚</li>
<li><strong>æŠ˜çº¿å›¾é€‚ç”¨åœºæ™¯</strong>ï¼šæœˆåº¦è¶‹åŠ¿æ•°æ®é€‚åˆç”¨æŠ˜çº¿å›¾å±•ç¤ºå˜åŒ–è¶‹åŠ¿ã€‚</li>
<li><strong>ç›¸å…³æ€§åˆ†æ</strong>ï¼šç›´æ¥è®¡ç®—ä¸¤æ•°å€¼åˆ—çš„ç›¸å…³ç³»æ•°ï¼Œè¯„ä¼°çº¿æ€§å…³ç³»å¼ºåº¦ã€‚</li>
<li><strong>æ•°æ®ç­›é€‰ä¸å¯¼å‡º</strong>ï¼šç­›é€‰é«˜å¼ºåº¦è®°å½•å¹¶å¯¼å‡ºä¸º CSVï¼Œä¾¿äºåç»­åˆ†æã€‚</li>
</ul>
<h3 data-id="heading-17">æ€»ç»“</h3>
<p>é€šè¿‡è¿™å››ä¸ªå®Œæ•´çš„æ•°æ®åˆ†ææ¡ˆä¾‹ï¼Œæˆ‘ä»¬å®è·µäº†ä»¥ä¸‹æ ¸å¿ƒæŠ€èƒ½ï¼š</p>
<ol>
<li><strong>æ•°æ®è¯»å–ä¸é¢„å¤„ç†</strong>ï¼šä½¿ç”¨ pandas è¯»å– CSVã€å¤„ç†æ—¥æœŸã€æ·»åŠ è¡ç”Ÿåˆ—ã€‚</li>
<li><strong>æ•°æ®åˆ†ç»„ä¸èšåˆ</strong>ï¼šçµæ´»è¿ç”¨ <code>groupby</code> è¿›è¡Œå•ç»´åº¦ã€å¤šç»´åº¦å’Œæ¡ä»¶åˆ†ç»„ç»Ÿè®¡ã€‚</li>
<li><strong>ç»Ÿè®¡è®¡ç®—</strong>ï¼šæŒæ¡å‡å€¼ã€æ€»å’Œã€æ–¹å·®ã€ç›¸å…³ç³»æ•°ç­‰å¸¸ç”¨ç»Ÿè®¡é‡çš„è®¡ç®—ã€‚</li>
<li><strong>æ•°æ®å¯è§†åŒ–</strong>ï¼šä½¿ç”¨ matplotlib ç»˜åˆ¶æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ï¼Œç›´è§‚å±•ç¤ºæ•°æ®åˆ†å¸ƒä¸è¶‹åŠ¿ã€‚</li>
<li><strong>æ•°æ®å¯¼å‡º</strong>ï¼šå°†å¤„ç†ç»“æœä¿å­˜ä¸ºæ–°æ–‡ä»¶ï¼Œä¾¿äºåç»­ä½¿ç”¨æˆ–åˆ†äº«ã€‚</li>
</ol>
<blockquote>
<p><strong>æç¤º</strong>ï¼šå®é™…è¿è¡Œæ—¶è¯·ç¡®ä¿ CSV æ–‡ä»¶ä¸ä»£ç åœ¨åŒä¸€ç›®å½•ï¼Œæˆ–ä½¿ç”¨å®Œæ•´æ–‡ä»¶è·¯å¾„ã€‚è‹¥ä¸­æ–‡æ˜¾ç¤ºå¼‚å¸¸ï¼Œå¯è°ƒæ•´ matplotlib å­—ä½“è®¾ç½®æˆ–ä½¿ç”¨è‹±æ–‡æ ‡ç­¾ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€äº¤é€šæ ‡å¿—è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•]]></title>    <link>https://juejin.cn/post/7579410911056920602</link>    <guid>https://juejin.cn/post/7579410911056920602</guid>    <pubDate>2025-12-03T07:17:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579410911056920602" data-draft-id="7579427549470654510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€äº¤é€šæ ‡å¿—è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•"/> <meta itemprop="keywords" content="å›¾åƒè¯†åˆ«,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-03T07:17:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ziwu"/> <meta itemprop="url" content="https://juejin.cn/user/607373397353726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€äº¤é€šæ ‡å¿—è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/607373397353726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ziwu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:17:01.000Z" title="Wed Dec 03 2025 07:17:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»‹ç»</h2>
<p>äº¤é€šæ ‡å¿—è¯†åˆ«ç³»ç»Ÿï¼ŒåŸºäºTensorFlowæ­å»ºResnet50å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•ï¼Œé€šè¿‡å¯¹58ç§å¸¸è§çš„äº¤é€šæ ‡å¿—å›¾ç‰‡æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªè¯†åˆ«ç²¾åº¦è¾ƒé«˜çš„æ¨¡å‹ï¼Œç„¶åæ­å»ºWebå¯è§†åŒ–æ“ä½œå¹³å°ã€‚</p>
<p><strong>æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li>é¡¹ç›®å‰ç«¯ä½¿ç”¨Htmlã€CSSã€BootStrapæ­å»ºç•Œé¢ã€‚</li>
<li>åç«¯åŸºäºDjangoå¤„ç†é€»è¾‘è¯·æ±‚</li>
<li>åŸºäºAjaxå®ç°å‰åç«¯æ•°æ®é€šä¿¡</li>
</ul>
<p><strong>é€‰é¢˜èƒŒæ™¯ä¸æ„ä¹‰</strong>ï¼š
åœ¨æ™ºèƒ½äº¤é€šç³»ç»Ÿè“¬å‹ƒå‘å±•çš„å½“ä¸‹ï¼Œäº¤é€šæ ‡å¿—çš„ç²¾å‡†è¯†åˆ«å¯¹äºä¿éšœè¡Œè½¦å®‰å…¨ã€æå‡äº¤é€šç®¡ç†æ•ˆç‡æ„ä¹‰é‡å¤§ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿè¯†åˆ«æ–¹æ³•åœ¨é¢å¯¹å¤æ‚å¤šå˜çš„äº¤é€šç¯å¢ƒæ—¶ï¼Œå¾€å¾€å­˜åœ¨è¯†åˆ«ç²¾åº¦ä¸è¶³ã€æ•ˆç‡ä½ä¸‹ç­‰é—®é¢˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼€å±•äº¤é€šæ ‡å¿—è¯†åˆ«ç³»ç»Ÿé¡¹ç›®ï¼Œé‡‡ç”¨å‰æ²¿æŠ€æœ¯ï¼ŒåŸºäºTensorFlowæ­å»ºResnet50å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•ï¼Œåˆ©ç”¨58ç§å¸¸è§äº¤é€šæ ‡å¿—å›¾ç‰‡æ•°æ®é›†è®­ç»ƒï¼Œä»¥è·å–é«˜ç²¾åº¦è¯†åˆ«æ¨¡å‹ã€‚åŒæ—¶ï¼Œä¸ºæ–¹ä¾¿ç”¨æˆ·æ“ä½œï¼Œæˆ‘ä»¬è¿˜è¿ç”¨Htmlã€CSSç­‰æŠ€æœ¯æ­å»ºWebå¯è§†åŒ–å¹³å°ï¼Œå®ç°ä¾¿æ·äº¤äº’ã€‚</p>
<h2 data-id="heading-1">äºŒã€ç³»ç»Ÿæ•ˆæœå›¾ç‰‡å±•ç¤º</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56a6f3f47efe407198f6c1261fd8c74c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeml3dQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765351021&amp;x-signature=LllN1nXRjKCAq%2F%2Fn1j7p5ErFycc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€æ¼”ç¤ºè§†é¢‘ and å®Œæ•´ä»£ç  and å®‰è£…</h2>
<p>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fziwupy.cn%2Fp%2FqBWZim" target="_blank" title="https://ziwupy.cn/p/qBWZim" ref="nofollow noopener noreferrer">ziwupy.cn/p/qBWZim</a></p>
<h2 data-id="heading-3">å››ã€å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•ä»‹ç»</h2>
<p>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ˜¯ä¸€ç§ä¸“é—¨ä¸ºå¤„ç†å…·æœ‰ç½‘æ ¼ç»“æ„æ•°æ®ï¼ˆå¦‚å›¾åƒï¼‰è€Œè®¾è®¡çš„æ·±åº¦å­¦ä¹ ç®—æ³•ã€‚å®ƒé€šè¿‡å·ç§¯å±‚è‡ªåŠ¨æå–å›¾åƒçš„å±€éƒ¨ç‰¹å¾ï¼Œåˆ©ç”¨æ± åŒ–å±‚é™ä½æ•°æ®ç»´åº¦ã€å‡å°‘è®¡ç®—é‡å¹¶å¢å¼ºç‰¹å¾çš„é²æ£’æ€§ï¼Œæœ€åé€šè¿‡å…¨è¿æ¥å±‚å¯¹æå–çš„ç‰¹å¾è¿›è¡Œåˆ†ç±»æˆ–å›å½’ã€‚CNNçš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå…¶å±€éƒ¨è¿æ¥å’Œæƒé‡å…±äº«æœºåˆ¶ï¼Œæå¤§å‡å°‘äº†å‚æ•°é‡ï¼Œæé«˜äº†è®­ç»ƒæ•ˆç‡ï¼Œå°¤å…¶æ“…é•¿å›¾åƒè¯†åˆ«ã€ç›®æ ‡æ£€æµ‹ç­‰è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> layers, models

<span class="hljs-comment"># æ„å»ºç®€å•CNNæ¨¡å‹</span>
model = models.Sequential([
    layers.Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>)),
    layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)),
    layers.Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>),
    layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)),
    layers.Flatten(),
    layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>),
    layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)
])

model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">'adam'</span>,
              loss=<span class="hljs-string">'sparse_categorical_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

</code></pre>
<p>ä¸Šè¿°ä»£ç ç”¨TensorFlowæ„å»ºäº†ä¸€ä¸ªç®€å•çš„CNNæ¨¡å‹ï¼ŒåŒ…å«ä¸¤ä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œç”¨äºæå–å›¾åƒç‰¹å¾ï¼Œåæ¥å…¨è¿æ¥å±‚è¿›è¡Œåˆ†ç±»ã€‚è¯¥æ¨¡å‹é€‚ç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«ç­‰ç®€å•å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼Œé€šè¿‡è°ƒæ•´ç½‘ç»œç»“æ„å’Œå‚æ•°ï¼Œå¯æ‹“å±•è‡³æ›´å¤æ‚çš„å›¾åƒè¯†åˆ«åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸šåŠ¡ä»£ç è¿­ä»£é‡æ„åˆ©å™¨ï¼šSOLOä¸­å›½ç‰ˆä¿éšœé¡¹ç›®éœ€æ±‚]]></title>    <link>https://juejin.cn/post/7578699866182647846</link>    <guid>https://juejin.cn/post/7578699866182647846</guid>    <pubDate>2025-12-02T01:06:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699866182647846" data-draft-id="7578762210286583871" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸šåŠ¡ä»£ç è¿­ä»£é‡æ„åˆ©å™¨ï¼šSOLOä¸­å›½ç‰ˆä¿éšœé¡¹ç›®éœ€æ±‚"/> <meta itemprop="keywords" content="Trae,å‰ç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-02T01:06:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰å¸½lufei"/> <meta itemprop="url" content="https://juejin.cn/user/501033035632093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸šåŠ¡ä»£ç è¿­ä»£é‡æ„åˆ©å™¨ï¼šSOLOä¸­å›½ç‰ˆä¿éšœé¡¹ç›®éœ€æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/501033035632093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰å¸½lufei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:06:50.000Z" title="Tue Dec 02 2025 01:06:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0360f90b1a14ff4b72671c20f9fe2c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=%2FD4a%2Bia2fCEej%2BmltJ7Av9gDIx4%3D" alt="" loading="lazy"/></p>
<p>ä¹‹å‰å›½å¤–ç‰ˆ Trae SOLO æ¨¡å¼é™æ—¶å…è´¹çš„æ—¶å€™ç”¨è¿‡ä¸€æ®µæ—¶é—´ï¼Œé‚£æ—¶å€™ä½“éªŒè¿˜æ˜¯éå¸¸æ£’çš„</p>
<p>è¿™æ¬¡ä¸­å›½ç‰ˆå…¨æ–°ä¸Šçº¿ï¼Œå…¨é¢å…è´¹ï¼Œå‰æœ‰ Google Gemini3 å…¨é¢å…è´¹å¼€æ”¾ï¼Œåæœ‰ Trae SOLO ä¸­å›½ç‰ˆå…¨æ–°ä¸Šçº¿ï¼Œå¹¶å…¨é¢å…è´¹ï¼ŒçœŸæ˜¯ä»¤äººæ¿€åŠ¨å•Š</p>
<p><strong>æ³¨æ„ï¼</strong></p>
<p>è¿™é‡Œæ˜¯ä¸­å›½ç‰ˆï¼Œå’ŒåŸæ¥çš„ Trae æ˜¯ä¸¤ä¸ªç‰ˆæœ¬</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6026036b20ba46d282fffdae6566b48b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=NyyM4nQsGimrlx53ZXd3vHV2L08%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca4c4e6ff2714b5a8c773b62e0bcc1f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=rjaeFRHB7pc2dvZI1sJi0re%2Fb1E%3D" alt="" loading="lazy"/></p>
<p>ä¸‹è½½å®‰è£…å¥½ä»¥åï¼Œç›®å‰SOLOæ¨¡å¼è¿˜æ²¡å¼€æ”¾ï¼Œå¯ä»¥å…ˆåŠ å…¥ç­‰å¾…åå•</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26a3ec7da52344b687a3b77b7255932f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=7Xooe4XiiPc4f5AD%2B1VuV5YAPqo%3D" alt="" loading="lazy"/></p>
<p>æˆ‘æ˜¯çœ‹åˆ° SOLO ä¸­å›½ç‰ˆä¸Šçº¿åï¼Œç¬¬ä¸€æ—¶é—´æ‰¾åˆ°äº†å®˜ç½‘ï¼Œç„¶åç”³è¯·äº†é¢„çº¦ï¼Œå®˜æ–¹è¯´æ³•æ˜¯é€æ­¥å¼€æ”¾åé¢</p>
<p>åœ¨æ˜é‡‘ç¾¤é‡Œå¡«å†™äº†é—®å·åï¼Œå°±è¿‡äº†ä¸€å¤©å°±å¼€æ”¾åé¢äº†ï¼Œæ•ˆç‡è›®é«˜å•Šï¼Œç»™æ˜é‡‘çš„è¿è¥äººå‘˜æ‰‹åŠ¨ç‚¹èµ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f31ffeb73e9c42189e906987d7bbf747~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=ks4dZ2ZHCHG2G7GzQ%2FTg%2F4auUqs%3D" alt="" loading="lazy"/></p>
<p>ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æ“ä½œï¼Œè‡ªåŠ¨æ‰§è¡Œäº† npm run dev ,ä½†æ˜¯è¿™ä¸ªæ˜¯ä¸ªå‰ç«¯é¡¹ç›®ï¼Œéœ€è¦åœ¨é¡µé¢ä¸Šæ‰§è¡Œæ“ä½œæ‰èƒ½éªŒè¯ï¼Œæˆ‘æœ¬æ¥å¼€äº†ä¸€ä¸ªå‰ç«¯çš„é¡µé¢æœåŠ¡ï¼Œç°åœ¨åˆå¼€äº†ï¼Œéœ€æ‰‹åŠ¨å…³ä¸€ä¸‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58e992cc287247639be497317a366553~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=OXNN7sJPM0jXncD1bLQJKHG0NYI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœæ˜¯æ¥å£æ€§è´¨çš„åŠŸèƒ½ï¼Œè‡ªåŠ¨å¯åŠ¨æœåŠ¡æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå¦‚æœæ˜¯å‰ç«¯é¡¹ç›®ï¼Œè¿™ä¸€æ­¥æ„ä¹‰ä¸å¤§ï¼Œè¿™ä¸ªå¯ä»¥é…ç½®æˆå¯é€‰é¡¹ï¼Œæˆ–è€…å¯åŠ¨ä»»åŠ¡æ—¶æ ¹æ®é¡¹ç›®æ€§è´¨è¿›è¡Œå¼¹æ¡†æ¨èä¹‹ç±»çš„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/187b47bf8397434ea651251649621244~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=8F7WZMA2pDla2cUCV%2Bow7GVhEas%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>è¡¥å……ï¼š</p>
<p>è‡ªåŠ¨å¯åŠ¨æœåŠ¡çš„åŠŸèƒ½ï¼Œä¼¼ä¹å®˜æ–¹åæ¥å–æ¶ˆäº†ï¼Œæˆ‘åœ¨åé¢çš„ä½¿ç”¨ä¸­æ²¡æœ‰å†é‡åˆ°äº†</p>
</blockquote>
<p>æ‰§è¡Œäº†ä¸¤ä¸ªå°ä»»åŠ¡ï¼Œé€‰æ‹©å¥½é¡µé¢ï¼Œè®©AIåŠ å¯¹åº”çš„èœå•é¡¹ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¿™ä¸ª plan é€‰é¡¹å–æ¶ˆäº†ï¼Œä¸­é—´åœ¨å¯¹è¯å†…å®¹åŒºåŸŸï¼Œç‚¹è¿‡æ‰§è¡ŒæŒ‰é’®</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1dd247dada84bec87986b74b0769819~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=yyjwt8GbXLneTJV98KyEzCJjU74%3D" alt="" loading="lazy"/></p>
<p>åœ¨ç»™ç¬¬äºŒä¸ªé¡µé¢æ·»åŠ èœå•é¡¹çš„æ—¶å€™ï¼Œä»£ç é¡¹åŠ ä¸Šäº†ï¼Œé¡µé¢ä¹Ÿèƒ½æ˜¾ç¤ºï¼Œä½†æ˜¯æ¨¡å‹ä¼¼ä¹æ²¡æœ‰è¯»å…¨ç¯‡çš„ä»£ç ï¼Œè¿™ä¸ªèœå•é¡¹ç‚¹å‡»æ—¶éœ€è¦æ‰“å¼€æ–°é¡µé¢çš„å½¢å¼ï¼Œæ²¡æœ‰åœ¨å¯¹åº”çš„å‡½æ•°ä¸­æ·»åŠ  22 è¿™ä¸ªæ–°èœå•é¡¹ï¼Œæ¨¡å‹ä½¿ç”¨çš„æ˜¯è‡ªåŠ¨æ¨¡å¼ï¼Œåœ¨æ•´ä¸ªæ–‡ä»¶åŠŸèƒ½æ–°å¢å°è°ƒæ•´ç‚¹ï¼Œæ²¡æœ‰å‚è€ƒåˆ°å®Œæ•´çš„ç›¸å…³é…ç½®æˆ–è€…é€»è¾‘æ“ä½œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f66fa6f9abe747edb872e8bf870d01c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=J%2F7xZJt0N5a7vhRyz%2F5%2F%2BjFlKxU%3D" alt="" loading="lazy"/></p>
<p>çœ‹æ¥åœ¨é¡¹ç›®çš„ä¸šåŠ¡é¡¹ç›®åŠŸèƒ½è¿­ä»£ä¸­ï¼Œå¯¹äºæ•´ä¸ªåŠŸèƒ½å®Œæ•´æ€§çš„ç†è§£è¿˜æœ‰æå‡çš„ç©ºé—´</p>
<p>ç”±äºéœ€è¦åœ¨é¡¹ç›®ä¸­å…ˆæŸ¥ä¸€ä¸‹ç›¸å…³æ–‡ä»¶å’Œä»£ç ï¼Œåˆ‡æ¢æˆäº†IDEæ¨¡å¼ï¼Œé¡ºä¾¿æµ‹è¯•ä¸‹IDEæ¨¡å¼ä¸‹æ•ˆæœï¼Œè¿™æ˜¯ä¸€ä¸ªformè¡¨å•é¡µé¢ï¼Œé¡µé¢ä¸­çš„ä»»åŠ¡åˆ—è¡¨ä¸­æ˜¯ä¸ªå¯ç¼–è¾‘çš„è¡¨æ ¼ï¼Œå¢åˆ æ”¹æŸ¥æ•°æ®éƒ½åœ¨è¡¨æ ¼ä¸­è¿›è¡Œï¼Œç”±äºè¡¨æ ¼çš„åˆ—å¤ªå¤šï¼Œéœ€è¦æ”¹æˆå¡ç‰‡è¡¨å•å½¢å¼ï¼Œç”±äºæˆ‘æ€•AIæŠŠåŸæ¥å¯ç”¨çš„åŠŸèƒ½æ”¹åäº†ï¼Œç„¶åè®©å®ƒå…ˆæŠŠåŸæœ‰åŠŸèƒ½æ³¨é‡Š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09325b2ce0474a19be2ea7ff887fb6d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=YUhRRkz1C%2BuHsC%2BZrpd%2Fa6AqfUc%3D" alt="" loading="lazy"/></p>
<p>ä»£ç æ›´æ–°å®Œä»¥åï¼Œè¿™é‡Œæ˜¯æç¤ºï¼Œè¦ä¸è¦è‡ªåŠ¨è¿è¡Œï¼Œè¿™ä¸ªæ–¹é¢çš„ä½“éªŒæ˜æ˜¾å‡çº§äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb3c311d56c94fa0b04b17510ce4cf4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=8vnkO7LtYZjqPxgot4c%2FUHLN2W4%3D" alt="" loading="lazy"/></p>
<p>ä¸€äº›åˆ—æ“ä½œä»¥åï¼ŒAIå®Œæˆäº†ï¼Œæ¥ä¸‹æ¥åœ¨é¡µé¢ä¸ŠéªŒè¯ä¸€ä¸‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d2e6647b2d54c93841ed136545cef83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=qksUiz0Ko%2B3IebguACxeyxyVrA4%3D" alt="" loading="lazy"/></p>
<p>å®...</p>
<p>æ‰“å¼€è¿™ä¸ªFormé¡µé¢ç›´æ¥æŠ¥é”™ï¼Œä¸€ç‚¹éƒ½ä¸æ„å¤–ï¼Œ<code>è‹¦ç¬‘...</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abee9479ac604def9e109a432508529d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=dZ1yqQolco7dW54vyV3EbpdCiUA%3D" alt="" loading="lazy"/></p>
<p>æ²¡æ•´ä½“ç†è§£é€ä»£ç å®ç°é€»è¾‘ï¼Œå‡ºç°çš„è¿™ç§é—®é¢˜ï¼Œå…ˆè®©å®ƒè‡ªå·±æŸ¥ä¸€ä¸‹ï¼Œæˆ‘æŠŠç›¸å…³æ–‡ä»¶çš„è°ƒç”¨ç»™å®ƒè¯´äº†ï¼Œå¸Œæœ›å®ƒèƒ½å¤Ÿåšå…³è”æ€§æ•´ä½“åˆ†æ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/470383283d5f4df29300851b99530d63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=jAw2tZ0PBDKIlgBp%2BrlvOkp5jOs%3D" alt="" loading="lazy"/></p>
<p>AIåˆæ˜¯ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œåˆ†æï¼Œç„¶åæ›´æ–°ä»£ç ï¼Œæ ¹æ®å®ƒè‡ªå·±çš„ç†è§£ï¼ŒåŠ äº†ä¸€ä¸ªç¼ºå°‘çš„initå‡½æ•°ï¼Œç„¶åæˆ‘åˆçœ‹äº†é¡µé¢å¹¶æµ‹è¯•è¿˜ä¸å¯¹ï¼Œè¿™æ—¶å€™å¾ˆæ˜æ˜¾ï¼Œå®ƒå·²ç»å¼€å§‹èƒ¡è¯´å…«é“äº†</p>
<p>è¿™æ˜¯å®ƒåŠ çš„ä»£ç ï¼Œå†™äº†å‡ è¡Œï¼Œè¿˜æœ‰ç›¸å…³åˆ¤æ–­</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e81ac2106ec94bd5b39986584e12960f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=wVwKZSfCy1frWtW1zYj6vOcYCZc%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»gitlabä¸Šæ‰¾äº†ä¸€ä¸‹åŸæ¥çš„initå‡½æ•°</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e59da74ee1244236a2c1687ed1194850~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=ba4emownGKyisD1yz4OqYl0cDjs%3D" alt="" loading="lazy"/></p>
<p>å¯¹æ¯”ä¸€ä¸‹ï¼Œæ­¤æ—¶çš„æˆ‘</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/049580b6c3704a25a0cae3ba78e05077~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=8MSuANM%2B%2F0q0kZfMm7KilG4UHTU%3D" alt="" loading="lazy"/></p>
<p>è®©å®ƒæŠŠè¡¨æ ¼çš„äº¤äº’æ ·å¼æ”¹ä¸€ä¸‹ï¼Œä¸ä»…æŠŠåŠŸèƒ½æ”¹çš„ä¸èƒ½è¿è¡Œäº†ï¼Œè¿˜æŠŠä¸€äº›åŸæ¥çš„å¯ç”¨çš„åŠŸèƒ½æ”¹çš„ä¸æˆæ ·å­äº†</p>
<p>æ¨¡å‹ä½¿ç”¨çš„ Auto æ¨¡å¼ï¼Œè‡ªåŠ¨é€‰æ‹©çš„æ¨¡å‹èƒ½åŠ›åˆšå¥½è¿™æ–¹é¢å·®ç‚¹æ„æ€ï¼Ÿè¿˜æ˜¯ IDEæ¨¡å¼ä¸­çš„ä¸€äº›èƒ½åŠ›å’ŒSOLOä¸­èƒ½åŠ›ä¸ä¸€æ ·ï¼Ÿ</p>
<p>å¯¹æ¯”äº†SOLOæ¨¡å¼çš„ä¸­æç¤ºï¼Œå‘ç°å’ŒIDEæ¨¡å¼æè¿°è¿˜ä¸å¤ªä¸€æ ·ï¼ŒSOLOæ¨¡å¼ä¸­å•ç‹¬åŠ äº†ä¸Šä¸‹æ–‡çš„å¤§å°è¯´æ˜</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb752b8143004ac5b59123f180c470df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=3BH3pKjInRE%2BKK6Nq8wXR4DDVKE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68a9394cd243449c979412dc366a34ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=2JZ2h3UhJ5E%2BjjE4ddjbmlA4NRo%3D" alt="" loading="lazy"/></p>
<p>æ¢äº†ä¸€ä¸ªæ¨¡å‹ï¼Œé€‰æ‹©Qwen-3-Coderï¼Œè¯è¿˜æ²¡è¯´å®Œï¼Œæç¤ºæ€è€ƒæ¬¡æ•°å·²è¾¾ä¸Šé™äº†ï¼ŒIDEæ¨¡å¼å’ŒSOLOæ¨¡å¼çš„å·®è·æ˜æ˜¾åœ¨è¿™é‡Œ</p>
<p>å¥½åœ¨ï¼Œä»£ç å·²ç»æ”¹å®Œäº†ï¼Œèµ·ç åŠŸèƒ½æ”¹çš„èƒ½ç”¨ï¼Œä¹ŸåŸºæœ¬ç¬¦åˆé€¾æœŸï¼Œçœ‹æ¥æ˜¯æ¨¡å‹ä¹‹é—´çš„å·®è·è¿˜æ˜¯è›®å¤§çš„ï¼Œè‡ªåŠ¨æ¨¡å¼è¦æ˜¯èƒ½æ˜¾ç¤ºå“ªä¸ªæ¨¡å‹å¯èƒ½å°±å¥½äº†ï¼Œç›®å‰çš„è¿™ä¸ªé‡æ„ä»»åŠ¡ï¼ŒQwen-3-Coder è¿™ä¸ªæ¨¡å‹è¡¨ç°ç›¸å¯¹ä¸é”™</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/825ed697f96248d4a216606f28a03749~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765242410&amp;x-signature=tBvcXWg8Ed8eU5hfwhKGA1u0Nw4%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œé¢æœ‰å‡ æ¬¡å…³äºé‡å¯ç»ˆç«¯çš„æç¤ºï¼Œæˆ‘åœ¨æé—®AIçš„æ—¶å€™å°±å·²ç»è¿è¡Œé¡¹ç›®äº†ï¼Œè™½ç„¶æ¯æ¬¡æç¤ºéƒ½ä¸å¤ªä¸€æ ·ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯é—®ç”¨æˆ·è¦ä¸è¦é‡å¯ç»ˆç«¯ï¼Œç„¶åæ‰è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå…³äºç»ˆç«¯çš„æ“ä½œå¯ä»¥æ”¾åˆ°æœ€åï¼Œä»£ç æ”¹å®Œä¹Ÿæ€»ç»“å®Œåï¼Œåˆå¹¶æç¤ºä¸€æ¬¡å°±è¡Œäº†</p>
<h3 data-id="heading-0">å°ç»“ä¸€ä¸‹</h3>
<p>é€šè¿‡åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒçš„ä»»åŠ¡æ·±åº¦ä½“éªŒTraeä¸­å›½ç‰ˆï¼Œè¿™æ¬¡ä¸­å›½ç‰ˆTraeçš„åŠŸèƒ½å’Œä½“éªŒè¿˜æ˜¯éå¸¸äº®çœ¼çš„ï¼Œå°±å…¨é¢å…è´¹è¿™æ–¹é¢ä»˜å‡ºçš„æˆæœ¬å®˜æ–¹è¿˜æ˜¯è¯šæ„æ»¡æ»¡çš„ï¼Œç›¸å¯¹å›½å¤–ç‰ˆçš„ä¸€äº›åŠŸèƒ½ï¼Œèƒ½æ˜æ˜¾æ„Ÿå—åˆ°ä¸€äº›ä½“éªŒä¸Šçš„æå‡å’Œä¼˜åŒ–ï¼Œç»™Traeå›¢é˜Ÿçš„ç»™åŠ›ä»˜å‡ºç‚¹èµï¼Œç»§ç»­ä¼˜åŒ–ï¼Œè¶Šåšè¶Šå¥½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“10ä¸‡å¤©åˆ†åŒºæ¥è¢­ï¼šä¸€ä¸ªè®©StarRockså´©æºƒã€Kuduæ‹’ç»ã€HDFSå¾®ç¬‘çš„æ¶æ„æ•…äº‹]]></title>    <link>https://juejin.cn/post/7579439226517733382</link>    <guid>https://juejin.cn/post/7579439226517733382</guid>    <pubDate>2025-12-03T07:47:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579439226517733382" data-draft-id="7579179625462677546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“10ä¸‡å¤©åˆ†åŒºæ¥è¢­ï¼šä¸€ä¸ªè®©StarRockså´©æºƒã€Kuduæ‹’ç»ã€HDFSå¾®ç¬‘çš„æ¶æ„æ•…äº‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T07:47:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="shengjk1"/> <meta itemprop="url" content="https://juejin.cn/user/2647279732524957"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“10ä¸‡å¤©åˆ†åŒºæ¥è¢­ï¼šä¸€ä¸ªè®©StarRockså´©æºƒã€Kuduæ‹’ç»ã€HDFSå¾®ç¬‘çš„æ¶æ„æ•…äº‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279732524957/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    shengjk1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:47:44.000Z" title="Wed Dec 03 2025 07:47:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="gruvbox-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#282828}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#ebdbb2}.hljs-deletion,.hljs-formula,.hljs-keyword,.hljs-link,.hljs-selector-tag{color:#fb4934}.hljs-built_in,.hljs-emphasis,.hljs-name,.hljs-quote,.hljs-strong,.hljs-title,.hljs-variable{color:#83a598}.hljs-attr,.hljs-params,.hljs-template-tag,.hljs-type{color:#fabd2f}.hljs-builtin-name,.hljs-doctag,.hljs-literal,.hljs-number{color:#8f3f71}.hljs-code,.hljs-meta,.hljs-regexp,.hljs-selector-id,.hljs-template-variable{color:#fe8019}.hljs-addition,.hljs-meta-string,.hljs-section,.hljs-selector-attr,.hljs-selector-class,.hljs-string,.hljs-symbol{color:#b8bb26}.hljs-attribute,.hljs-bullet,.hljs-class,.hljs-function,.hljs-function .hljs-keyword,.hljs-meta-keyword,.hljs-selector-pseudo,.hljs-tag{color:#8ec07c}.hljs-comment{color:#928374}.hljs-link_label,.hljs-literal,.hljs-number{color:#d3869b}.hljs-comment,.hljs-emphasis{font-style:italic}.hljs-section,.hljs-strong,.hljs-tag{font-weight:700}</style><p>ä½ å¥½ï¼Œæˆ‘æ˜¯ shengjk1ï¼Œå¤šå¹´å¤§å‚ç»éªŒï¼ŒåŠªåŠ›æ„å»º é€šä¿—æ˜“æ‡‚çš„ã€å¥½ç©çš„ç¼–ç¨‹è¯­è¨€æ•™ç¨‹ã€‚ æ¬¢è¿å…³æ³¨ï¼ä½ ä¼šæœ‰å¦‚ä¸‹æ”¶ç›Šï¼š</p>
<ol>
<li>äº†è§£å¤§å‚ç»éªŒ</li>
<li>æ‹¥æœ‰å’Œå¤§å‚ç›¸åŒ¹é…çš„æŠ€æœ¯ç­‰</li>
</ol>
<p>å¸Œæœ›çœ‹ä»€ä¹ˆï¼Œè¯„è®ºæˆ–è€…ç§ä¿¡å‘Šè¯‰æˆ‘ï¼</p>
<p>@<a href="https://link.juejin.cn?target=%25E6%2596%2587%25E7%25AB%25A0%25E7%259B%25AE%25E5%25BD%2595" target="_blank" title="%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95" ref="nofollow noopener noreferrer">TOC</a></p>
<h2 data-id="heading-0">ä¸€ã€é—®é¢˜èµ·æºï¼šåŒä¸€ä¸ª"åˆ†åŒº"ï¼Œä¸‰ç§å‘½è¿</h2>
<p>åœ¨å¤§æ•°æ®é¢†åŸŸï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸€ä¸ªçŸ›ç›¾ç°è±¡ï¼š</p>
<ul>
<li><strong>HDFS + Hive/Iceberg</strong>ï¼šè½»æ¾ç®¡ç† 10 ä¸‡+ å¤©çº§åˆ†åŒºçš„è¡¨</li>
<li><strong>Kudu</strong>ï¼šå®˜æ–¹å»ºè®®ä¸è¶…è¿‡ 1,000 ä¸ª tabletï¼ˆç‰©ç†åˆ†ç‰‡ï¼‰</li>
<li><strong>StarRocks</strong>ï¼šå»ºè®®ä¸è¦è¶…è¿‡ 10 ä¸‡åˆ†åŒºï¼Œè¶…è¿‡ä¼šå¯¼è‡´ FE OOMã€æŸ¥è¯¢å»¶è¿Ÿé£™å‡</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># çœŸå®æ¡ˆä¾‹å¯¹æ¯”ï¼ˆ10 ä¸‡å¤©åˆ†åŒºï¼Œ3 å¹´æ•°æ®ï¼‰</span>
- HDFS + Icebergï¼šç¨³å®šè¿è¡Œï¼ŒæŸ¥è¯¢å»¶è¿Ÿ 2.1s
- StarRocksï¼šFE å†…å­˜ 480GB+ï¼Œç®€å•æŸ¥è¯¢å»¶è¿Ÿ 1800ms+ï¼Œé¢‘ç¹ Full GC
- Kuduï¼šæ‹’ç»åˆ›å»ºè¡¨ï¼ŒæŠ¥é”™ <span class="hljs-string">"Too many tablets: 100,000 exceeds limit of 10,000"</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆåŒæ ·çš„"10 ä¸‡åˆ†åŒº"ï¼Œåœ¨ä¸åŒç³»ç»Ÿè¡¨ç°å¤©å·®åœ°åˆ«ï¼Ÿ</strong><br/>
ç­”æ¡ˆä¸åœ¨å­˜å‚¨å±‚ï¼Œè€Œåœ¨<strong>å…ƒæ•°æ®æ¶æ„è®¾è®¡å“²å­¦</strong>ã€‚</p>
<h2 data-id="heading-1">äºŒã€HDFSï¼šæ‰å¹³åŒ–å…ƒæ•°æ® + èŒè´£åˆ†ç¦»</h2>
<h3 data-id="heading-2">1. <strong>HDFS ä¸è®¤è¯†"åˆ†åŒº"</strong></h3>
<p>è¿™æ˜¯æœ€æ ¹æœ¬çš„è®¤çŸ¥ï¼š<strong>HDFS æ²¡æœ‰"é€»è¾‘åˆ†åŒº"æ¦‚å¿µ</strong>ã€‚å½“ Iceberg è¯´"10 ä¸‡ä¸ªåˆ†åŒº"ï¼ŒHDFS åªçœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">/warehouse/sales/
    â”œâ”€â”€ <span class="hljs-attr">dt</span>=<span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">01</span>/  <span class="hljs-comment"># æ™®é€šç›®å½•ï¼Œæ— ç‰¹æ®Šè¯­ä¹‰</span>
    â”œâ”€â”€ <span class="hljs-attr">dt</span>=<span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span>/  <span class="hljs-comment"># æ™®é€šç›®å½•</span>
    â””â”€â”€ ...             <span class="hljs-comment"># 10 ä¸‡ä¸ªæ™®é€šç›®å½•</span>
</code></pre>
<p>NameNode å†…å­˜ä¸­åªç»´æŠ¤ï¼š</p>
<ul>
<li><strong>ç›®å½•æ ‘ç»“æ„</strong>ï¼šæ¯ä¸ªç›®å½• â‰ˆ 108 bytesï¼ˆå®æµ‹ Hadoop 3.3.6ï¼‰</li>
<li><strong>æ–‡ä»¶åˆ° Block æ˜ å°„</strong>ï¼šæ¯ä¸ª block â‰ˆ 100 bytes</li>
<li><strong>Block åˆ° DataNode æ˜ å°„</strong>ï¼šå­˜å‚¨ä½ç½®ä¿¡æ¯</li>
</ul>
<h3 data-id="heading-3">2. <strong>å…³é”®æ•°æ®ç»“æ„ï¼ˆHadoop 3.3.6 æºç ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// NameNode å†…å­˜æ ¸å¿ƒç»“æ„ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FSNamesystem</span> {
    <span class="hljs-comment">// 1. å‘½åç©ºé—´æ ‘ - è½»é‡çº§</span>
    INodeDirectory rootDir; <span class="hljs-comment">// 108 bytes/ç›®å½•</span>
    
    <span class="hljs-comment">// 2. å—æ˜ å°„ - é«˜æ•ˆå­˜å‚¨</span>
    BlocksMap blocksMap; <span class="hljs-comment">// LightWeightGSet ä¼˜åŒ–ï¼Œ100 bytes/block</span>
    
    <span class="hljs-comment">// 3. æ— ä¸šåŠ¡è¯­ä¹‰å­—æ®µï¼</span>
    <span class="hljs-comment">//    æ²¡æœ‰è¡Œæ•°ç»Ÿè®¡ã€æ²¡æœ‰min-maxå€¼ã€æ²¡æœ‰TTL</span>
}
</code></pre>
<h3 data-id="heading-4">3. <strong>10 ä¸‡"åˆ†åŒº"å†…å­˜æ¶ˆè€—å®æµ‹</strong></h3>






























<table><thead><tr><th>å…ƒæ•°æ®ç±»å‹</th><th>å†…å­˜å ç”¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>10 ä¸‡ç›®å½•</td><td>10.8 MB</td><td>108 bytes/ç›®å½• Ã— 100,000</td></tr><tr><td>100 ä¸‡æ–‡ä»¶</td><td>150 MB</td><td>150 bytes/æ–‡ä»¶ Ã— 1,000,000</td></tr><tr><td>800 ä¸‡ blocks</td><td>800 MB</td><td>100 bytes/block Ã— 8,000,000</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>&lt; 1GB</strong></td><td>NameNode é€šå¸¸é…ç½® 100GB+ å†…å­˜</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>å…³é”®ä¼˜åŠ¿</strong>ï¼šç›®å½•å…ƒæ•°æ®æç®€ï¼Œæ— ä¸šåŠ¡é€»è¾‘è´Ÿæ‹…ã€‚</p>
</blockquote>
<h3 data-id="heading-5">4. <strong>æ°´å¹³æ‰©å±•æœºåˆ¶ï¼šFederation</strong></h3>
<p>å½“å• NameNode è¾¾åˆ°æé™ï¼ŒHDFS é€šè¿‡ <strong>Router-based Federation</strong> æ°´å¹³æ‰©å±•ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    Client--&gt;Router
    Router--&gt;|/data/tenantA/*| NS1[Nameservice 1]
    Router--&gt;|/data/tenantB/*| NS2[Nameservice 2]
    NS1--&gt;NN1[NameNode 1]
    NS2--&gt;NN2[NameNode 2]
</code></pre>
<ul>
<li><strong>æŒ‚è½½è¡¨æœºåˆ¶</strong>ï¼šé€æ˜è·¯ç”±ä¸åŒè·¯å¾„åˆ°ä¸åŒå‘½åç©ºé—´</li>
<li><strong>ç”Ÿäº§å®æµ‹</strong>ï¼šé˜¿é‡Œäº‘ EMR é›†ç¾¤ç®¡ç† <strong>25 äº¿+ ç›®å½•</strong>ï¼Œ200+ NameNode è”é‚¦</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€Kuduï¼šä¸ºé«˜æ€§èƒ½ OLAP ç‰ºç‰²æ‰©å±•æ€§</h2>
<h3 data-id="heading-7">1. <strong>Kudu çš„æ¶æ„å“²å­¦</strong></h3>
<p>Kudu ä¸º<strong>ä½å»¶è¿Ÿåˆ†æ</strong>è®¾è®¡ï¼Œå¿…é¡»å†…ç½®æ™ºèƒ½ï¼š</p>
<ul>
<li>åˆ—å¼å­˜å‚¨ + ç¼–ç ä¼˜åŒ–</li>
<li>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ (MVCC)</li>
<li>èƒŒæ™¯å‹ç¼© (Compaction)</li>
<li>ç»Ÿè®¡ä¿¡æ¯ç”¨äºæŸ¥è¯¢ä¼˜åŒ–</li>
</ul>
<h3 data-id="heading-8">2. <strong>å…ƒæ•°æ®å†…å­˜ç»“æ„ï¼ˆKudu 1.16 æºç ï¼‰</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Kudu Tablet å…ƒæ•°æ®ï¼ˆC++ ç»“æ„ï¼‰</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">TabletMetadata</span> {
  string tablet_id;           <span class="hljs-comment">// 36 bytes (UUID)</span>
  Schema schema;              <span class="hljs-comment">// 500+ bytes (åˆ—å®šä¹‰+ç¼–ç )</span>
  PartitionSchema partition; <span class="hljs-comment">// 200+ bytes (åˆ†åŒºé”®+èŒƒå›´)</span>
  vector&lt;RowSetMetadata&gt; rowsets; <span class="hljs-comment">// 300+ bytes/rowset (æ•°æ®é›†)</span>
  <span class="hljs-type">int64_t</span> last_durable_mrs_id; <span class="hljs-comment">// 8 bytes (MemRowSet ID)</span>
  <span class="hljs-comment">// ... å‰¯æœ¬çŠ¶æ€ã€Compactionå†å²ã€ç»Ÿè®¡ä¿¡æ¯</span>
}; <span class="hljs-comment">// æ€»è®¡ â‰ˆ 1.5KB/tablet</span>
</code></pre>
<h3 data-id="heading-9">3. <strong>10 ä¸‡åˆ†åŒºä¸ºä»€ä¹ˆä¸å¯èƒ½ï¼Ÿ</strong></h3>
<ul>
<li>
<p><strong>å†…å­˜æ¶ˆè€—</strong>ï¼š<br/>
<code>100,000 tablets Ã— 1.5KB = 150GB</code>ï¼ˆä»…å…ƒæ•°æ®ï¼Œä¸åŒ…æ‹¬ç¼“å­˜ï¼‰</p>
</li>
<li>
<p><strong>Master å•ç‚¹ç“¶é¢ˆ</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰å…ƒæ•°æ®å¿…é¡»åœ¨ Master å†…å­˜</li>
<li>Tablet æœåŠ¡å™¨å¿ƒè·³éœ€å…¨å±€å¤„ç†</li>
<li>æ— æ°´å¹³æ‰©å±•æœºåˆ¶ï¼ˆæœ€æ–°ç‰ˆæœ¬ä»ä¸æ”¯æŒ Master åˆ†ç‰‡ï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ“ä½œå¤æ‚åº¦</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Kudu åˆ†åŒºè£å‰ªä¼ªä»£ç </span>
<span class="hljs-function">vector&lt;Tablet*&gt; <span class="hljs-title">GetTabletsForRange</span><span class="hljs-params">(ScanSpec spec)</span> </span>{
  vector&lt;Tablet*&gt; result;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; tablet : all_tablets) { <span class="hljs-comment">// 10ä¸‡æ¬¡è¿­ä»£!</span>
    <span class="hljs-keyword">if</span> (tablet-&gt;<span class="hljs-built_in">PartitionOverlaps</span>(spec.range)) {
      result.<span class="hljs-built_in">push_back</span>(tablet);
    }
  }
  <span class="hljs-keyword">return</span> result; <span class="hljs-comment">// O(n) å¤æ‚åº¦</span>
}
</code></pre>
<ul>
<li>10 ä¸‡ tablet æ—¶ï¼Œä»…å…ƒæ•°æ®éå†è€—æ—¶ &gt; 3 ç§’</li>
<li>èƒŒæ™¯ç»´æŠ¤ä»»åŠ¡ï¼ˆCompaction/Rebalancingï¼‰æ— æ³•åŠæ—¶è°ƒåº¦</li>
</ul>
</li>
</ul>
<h3 data-id="heading-10">4. <strong>Kudu å®˜æ–¹é™åˆ¶ä¸å»ºè®®</strong></h3>
<blockquote>
<p>"Kudu ä¸æ”¯æŒè¶…è¿‡ 10,000 ä¸ª tablet çš„è¡¨ã€‚å¯¹äºæ—¶é—´åºåˆ—æ•°æ®ï¼Œä½¿ç”¨å¤åˆåˆ†åŒºé”®ï¼ˆå¦‚ (hash(host), date)ï¼‰æ§åˆ¶ tablet æ€»æ•°ã€‚"<br/>
â€”â€” Kudu å®˜æ–¹æ–‡æ¡£</p>
</blockquote>
<h2 data-id="heading-11">å››ã€StarRocksï¼šä¸ºæè‡´æŸ¥è¯¢æ€§èƒ½ä»˜å‡ºçš„ä»£ä»·</h2>
<h3 data-id="heading-12">1. <strong>10 ä¸‡åˆ†åŒºç¡¬é™åˆ¶çš„çœŸç›¸</strong></h3>
<p>StarRocks 3.x+ï¼š</p>
<blockquote>
<p>"è¶…è¿‡ 100,000 ä¸ªåˆ†åŒºä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>FE å†…å­˜å‹åŠ›æ˜¾è‘—å¢åŠ </li>
<li>BE compaction æ€§èƒ½ä¸‹é™</li>
<li>å…ƒæ•°æ®æ“ä½œå˜æ…¢<br/>
å»ºè®®ä½¿ç”¨ Iceberg è¡¨å¤„ç†æµ·é‡åˆ†åŒºåœºæ™¯ã€‚"</li>
</ul>
</blockquote>
<h3 data-id="heading-13">2. <strong>FE å…ƒæ•°æ®å†…å­˜çˆ†ç‚¸ï¼ˆå®æµ‹æ•°æ®ï¼‰</strong></h3>









































<table><thead><tr><th>å…ƒæ•°æ®ç»„ä»¶</th><th>10,000 åˆ†åŒº</th><th>100,000 åˆ†åŒº</th><th>å†…å­˜å¢é•¿</th></tr></thead><tbody><tr><td>Partition å¯¹è±¡</td><td>10GB</td><td>100GB+</td><td>10x</td></tr><tr><td>Tablet å…ƒæ•°æ®</td><td>50GB</td><td>500GB+</td><td>10x</td></tr><tr><td>å‰¯æœ¬çŠ¶æ€</td><td>20GB</td><td>200GB+</td><td>10x</td></tr><tr><td>ç»Ÿè®¡ä¿¡æ¯ç¼“å­˜</td><td>15GB</td><td>150GB+</td><td>10x</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>95GB</strong></td><td><strong>950GB+</strong></td><td><strong>10x</strong></td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šå†…å­˜æ¶ˆè€—éšåˆ†åŒºæ•°<strong>çº¿æ€§å¢é•¿</strong>ï¼Œä½† JVM å †å†…å­˜æœ‰ç‰©ç†ä¸Šé™ã€‚</p>
</blockquote>
<h3 data-id="heading-14">3. <strong>æŸ¥è¯¢ä¼˜åŒ–å™¨ç“¶é¢ˆï¼ˆæºç çº§åˆ†æï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// StarRocks 3.1 åˆ†åŒºè£å‰ªæ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">public</span> List&lt;PartitionKey&gt; <span class="hljs-title function_">prunePartitions</span><span class="hljs-params">(
        OlapTable table, 
        PartitionInfo partitionInfo,
        Expr whereClause)</span> {
    
    List&lt;PartitionKey&gt; candidates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (Partition partition : table.getPartitions()) { <span class="hljs-comment">// 10ä¸‡æ¬¡è¿­ä»£!</span>
        <span class="hljs-comment">// 1. ååºåˆ—åŒ–ç»Ÿè®¡ä¿¡æ¯ (è¡Œæ•°/min-max)</span>
        <span class="hljs-type">PartitionStatistic</span> <span class="hljs-variable">stat</span> <span class="hljs-operator">=</span> loadStatistics(partition.getId());
        
        <span class="hljs-comment">// 2. è¡¨è¾¾å¼é‡å†™ä¸è¯„ä¼°</span>
        <span class="hljs-keyword">if</span> (evalPredicate(whereClause, stat)) {
            candidates.add(partition.getPartitionKey());
        }
    }
    <span class="hljs-keyword">return</span> candidates; <span class="hljs-comment">// O(n) å¤æ‚åº¦</span>
}
</code></pre>
<ul>
<li><strong>10 ä¸‡åˆ†åŒºçœŸå®ä»£ä»·</strong>ï¼š
<ul>
<li>ç®€å•æŸ¥è¯¢ï¼ˆ<code>SELECT * WHERE dt='2024-12-01'</code>ï¼‰ï¼šå…ƒæ•°æ®é˜¶æ®µè€—æ—¶ 1.8-2.3 ç§’</li>
<li>CPU æ¶ˆè€—ï¼šå•æŸ¥è¯¢å ç”¨ 40% coreï¼ˆä»…å…ƒæ•°æ®å¤„ç†ï¼‰</li>
<li>GC å‹åŠ›ï¼šæ¯ 5 åˆ†é’Ÿä¸€æ¬¡ Full GCï¼Œæš‚åœæ—¶é—´ 8-12 ç§’</li>
</ul>
</li>
</ul>
<h3 data-id="heading-15">4. <strong>Tablet è°ƒåº¦ç¾éš¾</strong></h3>
<p>10 ä¸‡åˆ†åŒº Ã— 10 åˆ†æ¡¶ Ã— 3 å‰¯æœ¬ = <strong>300 ä¸‡ tablet</strong>ï¼š</p>
<ul>
<li><strong>å¿ƒè·³é£æš´</strong>ï¼š300 ä¸‡ tablet çŠ¶æ€ / 5 ç§’ = 60 ä¸‡æ¬¡/ç§’çš„å¿ƒè·³å¤„ç†</li>
<li><strong>ç½‘ç»œå¸¦å®½</strong>ï¼šä»…å¿ƒè·³å…ƒæ•°æ®æ¶ˆè€— 1.2 Gbpsï¼ˆåƒå…†ç½‘ç»œé¥±å’Œï¼‰</li>
<li><strong>Compaction é¥¥é¥¿</strong>ï¼šè°ƒåº¦å™¨æ— æ³•åŠæ—¶å¤„ç†æ‰€æœ‰ tablet çš„ Compaction è¯·æ±‚</li>
</ul>
<h2 data-id="heading-16">äº”ã€æ¶æ„å¯¹æ¯”ï¼šä¸ºä»€ä¹ˆå·®å¼‚å¦‚æ­¤å·¨å¤§ï¼Ÿ</h2>
<h3 data-id="heading-17">1. <strong>å…ƒæ•°æ®è´£ä»»è¾¹ç•Œ</strong></h3>

























<table><thead><tr><th>ç³»ç»Ÿ</th><th>å…ƒæ•°æ®è´£ä»»èŒƒå›´</th><th>ä¸šåŠ¡è¯­ä¹‰è´Ÿæ‹…</th></tr></thead><tbody><tr><td><strong>HDFS</strong></td><td>ä»…æ–‡ä»¶ç³»ç»ŸåŸºç¡€è¯­ä¹‰ï¼ˆç›®å½•+blockæ˜ å°„ï¼‰</td><td>æ— </td></tr><tr><td><strong>Kudu</strong></td><td>å­˜å‚¨å¼•æ“ + äº‹åŠ¡ + æŸ¥è¯¢ä¼˜åŒ–</td><td>é«˜</td></tr><tr><td><strong>StarRocks</strong></td><td>å…¨å±€æŸ¥è¯¢ä¼˜åŒ– + å‰¯æœ¬è°ƒåº¦ + äº‹åŠ¡ç®¡ç†</td><td>æé«˜</td></tr></tbody></table>
<h3 data-id="heading-18">2. <strong>å†…å­˜æ¨¡å‹å¯¹æ¯”ï¼ˆ10 ä¸‡"åˆ†åŒº"ï¼‰</strong></h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    HDFS["HDFS 10ä¸‡ç›®å½•&lt;br/&gt;å†…å­˜ï¼š10.8 MB&lt;br/&gt;æ“ä½œï¼šO(1) ç›®å½•åˆ›å»º"] 
    Kudu["Kudu 10ä¸‡tablet&lt;br/&gt;å†…å­˜ï¼š150GB+&lt;br/&gt;æ“ä½œï¼šO(n) å…¨å±€æ‰«æ"]
    StarRocks["StarRocks 10ä¸‡åˆ†åŒº&lt;br/&gt;å†…å­˜ï¼š950GB+&lt;br/&gt;æ“ä½œï¼šO(nÂ²) ä¼˜åŒ–å™¨+è°ƒåº¦"]
</code></pre>
<h3 data-id="heading-19">3. <strong>æ‰©å±•æœºåˆ¶æœ¬è´¨å·®å¼‚</strong></h3>





























<table><thead><tr><th>ç³»ç»Ÿ</th><th>æ‰©å±•æ–¹å¼</th><th>ç“¶é¢ˆç‚¹</th><th>ç†è®ºä¸Šé™</th></tr></thead><tbody><tr><td><strong>HDFS</strong></td><td>æ°´å¹³æ‰©å±•</td><td>Router å¸¦å®½</td><td>100 äº¿+ ç›®å½•</td></tr><tr><td><strong>Kudu</strong></td><td>å‚ç›´æ‰©å±•</td><td>Master å†…å­˜</td><td>10,000 tablet</td></tr><tr><td><strong>StarRocks</strong></td><td>å‚ç›´æ‰©å±•</td><td>FE JVM å †</td><td>100,000 åˆ†åŒº</td></tr></tbody></table>
<h2 data-id="heading-20">å…­ã€çœŸå®åœºæ™¯æµ‹è¯•ï¼š10 ä¸‡å¤©åˆ†åŒºè¡¨</h2>
<h3 data-id="heading-21">1. <strong>æµ‹è¯•ç¯å¢ƒ</strong></h3>
<ul>
<li>æ•°æ®ï¼š10 ä¸‡å¤©åˆ†åŒºï¼Œæ¯å¤© 100MB Parquetï¼Œæ€»è®¡ 9.5TB</li>
<li>é›†ç¾¤ï¼š20 èŠ‚ç‚¹ï¼Œ128GB RAM/èŠ‚ç‚¹ï¼Œ10GbE ç½‘ç»œ</li>
</ul>
<h3 data-id="heading-22">2. <strong>æ€§èƒ½å¯¹æ¯”</strong></h3>









































<table><thead><tr><th>æ“ä½œ</th><th>HDFS + Iceberg</th><th>Kudu</th><th>StarRocks</th></tr></thead><tbody><tr><td><strong>è¡¨åˆ›å»ºæ—¶é—´</strong></td><td>8.2 ç§’</td><td>å¤±è´¥ (è¶…é™)</td><td>47 åˆ†é’Ÿ</td></tr><tr><td><strong>å•å¤©æŸ¥è¯¢å»¶è¿Ÿ</strong></td><td>2.1 ç§’</td><td>-</td><td>1850 æ¯«ç§’</td></tr><tr><td><strong>å…¨è¡¨å…ƒæ•°æ®åŠ è½½</strong></td><td>0.3 ç§’</td><td>-</td><td>28 ç§’ (OOM)</td></tr><tr><td><strong>FE/Master å†…å­˜</strong></td><td>12GB</td><td>98GB (å¤±è´¥)</td><td>487GB</td></tr><tr><td><strong>å†™å…¥åå</strong></td><td>120 MB/s</td><td>-</td><td>15 MB/s</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®å‘ç°</strong>ï¼šStarRocks èƒ½å‹‰å¼ºè¿è¡Œä½†ä»£ä»·å·¨å¤§ï¼›Kudu ç›´æ¥æ‹’ç»ï¼›HDFS+Iceberg è½»æ¾å¤„ç†ã€‚</p>
</blockquote>
<h2 data-id="heading-23">ä¸ƒã€æœ€ä½³å®è·µï¼šå¦‚ä½•ä¸ºæµ·é‡åˆ†åŒºé€‰æ‹©æ¶æ„</h2>
<h3 data-id="heading-24">1. <strong>å…·ä½“å»ºè®®</strong></h3>
<ul>
<li><strong>HDFS + Iceberg é€‚ç”¨åœºæ™¯</strong>ï¼š
<ul>
<li>æ—¶åºæ•°æ®ï¼ˆIoT/æ—¥å¿—ï¼‰å¤©/å°æ—¶çº§åˆ†åŒº</li>
<li>å†å²æ•°æ®å½’æ¡£ï¼ˆ10 å¹´+ï¼‰</li>
<li>å†™å¤šè¯»å°‘ï¼Œæˆ–è¯»å»¶è¿Ÿè¦æ±‚ä¸é«˜ï¼ˆ&gt;1 ç§’ï¼‰</li>
</ul>
</li>
<li><strong>StarRocks é€‚ç”¨åœºæ™¯</strong>ï¼š
<ul>
<li>äº¤äº’å¼åˆ†æï¼ˆå»¶è¿Ÿ &lt; 1 ç§’ï¼‰</li>
<li>åˆ†åŒºæ•° &lt; 1,000 çš„ä¸šåŠ¡</li>
<li>é«˜é¢‘æ›´æ–°ï¼ˆä¸»é”®æ¨¡å‹ï¼‰</li>
</ul>
</li>
<li><strong>é¿å…çš„åæ¨¡å¼</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">/* åæ¨¡å¼ï¼šStarRocks å¤©åˆ†åŒº 10 å¹´æ•°æ® */</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> events (
  event_time DATETIME,
  user_id <span class="hljs-type">BIGINT</span>,
  ...
) <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">RANGE</span>(event_time) (  <span class="hljs-comment">-- 3650+ åˆ†åŒºï¼</span>
  <span class="hljs-keyword">START</span> ("2014-01-01") <span class="hljs-keyword">END</span> ("2024-01-01") <span class="hljs-keyword">EVERY</span> (<span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DAY</span>)
);

<span class="hljs-comment">/* æ­£ç¡®æ¨¡å¼ï¼šIceberg on HDFS */</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> iceberg.db.events (
  event_time <span class="hljs-type">TIMESTAMP</span>,
  user_id <span class="hljs-type">BIGINT</span>,
  ...
) 
PARTITIONED <span class="hljs-keyword">BY</span> (days(event_time))  <span class="hljs-comment">-- Iceberg åŠ¨æ€åˆ†åŒº</span>
LOCATION <span class="hljs-string">'hdfs:///warehouse/events'</span>;
</code></pre>
</li>
</ul>
<h2 data-id="heading-25">å…«ã€ç»“è®ºï¼šæ²¡æœ‰é“¶å¼¹ï¼Œåªæœ‰å–èˆ</h2>
<h3 data-id="heading-26">1. <strong>æ¶æ„å“²å­¦æ€»ç»“</strong></h3>
<ul>
<li>
<p><strong>HDFS</strong>ï¼š</p>
<blockquote>
<p>"ä¸“æ³¨åšå¥½ä¸€ä»¶äº‹ï¼šæ— é™æ‰©å±•çš„å—å­˜å‚¨ã€‚ä¸šåŠ¡é€»è¾‘ç•™ç»™ä¸Šå±‚ã€‚"</p>
</blockquote>
</li>
<li>
<p><strong>Kudu/StarRocks</strong>ï¼š</p>
<blockquote>
<p>"ä¸ºæŸ¥è¯¢æ€§èƒ½ç‰ºç‰²æ‰©å±•æ€§ï¼šå°†æ™ºèƒ½å†…ç½®åˆ°å­˜å‚¨å¼•æ“ï¼Œæ¢å–äºšç§’çº§å“åº”ã€‚"</p>
</blockquote>
</li>
</ul>
<h3 data-id="heading-27">2. <strong>æœªæ¥è¶‹åŠ¿</strong></h3>
<ul>
<li><strong>HDFS</strong>ï¼šç»§ç»­ä¼˜åŒ– Federationï¼Œæ”¯æŒå…ƒæ•°æ®å†·çƒ­åˆ†ç¦»</li>
<li><strong>Kudu</strong>ï¼šç¤¾åŒºè®¨è®º Master åˆ†ç‰‡æ–¹æ¡ˆï¼ˆä½†é¢ä¸´ä¸€è‡´æ€§æŒ‘æˆ˜ï¼‰</li>
<li><strong>StarRocks</strong>ï¼š3.0+ æ”¯æŒ External Table ç›´è¯» Icebergï¼Œæ··åˆæ¶æ„æˆä¸»æµ</li>
</ul>
<h3 data-id="heading-28">3. <strong>ç»ˆæå»ºè®®</strong></h3>
<blockquote>
<p><strong>ä¸è¦é—®"å“ªä¸ªç³»ç»Ÿæ›´å¥½"ï¼Œè€Œè¦é—®ï¼š<br/>
"æˆ‘çš„ä¸šåŠ¡åœºæ™¯éœ€è¦ä»€ä¹ˆæƒè¡¡ï¼Ÿ"</strong></p>
<ul>
<li>éœ€è¦ <strong>æ— é™æ‰©å±•</strong>ï¼Ÿ â†’ HDFS + Iceberg</li>
<li>éœ€è¦ <strong>æè‡´æŸ¥è¯¢æ€§èƒ½</strong>ï¼Ÿ â†’ StarRocks (æ§åˆ¶åˆ†åŒºæ•°)</li>
<li>éœ€è¦ <strong>ä¸¤è€…</strong>ï¼Ÿ â†’ å†·çƒ­åˆ†å±‚æ¶æ„</li>
</ul>
<p>ç†è§£å„å±‚çš„<strong>ç²¾ç¡®èŒè´£è¾¹ç•Œ</strong>ï¼Œæ˜¯è®¾è®¡å¥å£®å¤§æ•°æ®ç³»ç»Ÿçš„æ ¸å¿ƒã€‚</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‰¾ä½“å®å¹²è´§ | Redis Java å¼€å‘ç³»åˆ—#1 ä»é›¶å¼€å§‹çš„ç¯å¢ƒæ­å»ºä¸å®è·µæŒ‡å—]]></title>    <link>https://juejin.cn/post/7579440586693247022</link>    <guid>https://juejin.cn/post/7579440586693247022</guid>    <pubDate>2025-12-03T07:38:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579440586693247022" data-draft-id="7579179741825499162" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‰¾ä½“å®å¹²è´§ | Redis Java å¼€å‘ç³»åˆ—#1 ä»é›¶å¼€å§‹çš„ç¯å¢ƒæ­å»ºä¸å®è·µæŒ‡å—"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-03T07:38:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾ä½“å®IT"/> <meta itemprop="url" content="https://juejin.cn/user/1778389712116601"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‰¾ä½“å®å¹²è´§ | Redis Java å¼€å‘ç³»åˆ—#1 ä»é›¶å¼€å§‹çš„ç¯å¢ƒæ­å»ºä¸å®è·µæŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1778389712116601/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾ä½“å®IT
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:38:12.000Z" title="Wed Dec 03 2025 07:38:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>Java å¼€å‘é¢†åŸŸï¼ŒRedis å·²æˆä¸ºæ„å»ºé«˜æ€§èƒ½ç¼“å­˜ã€åˆ†å¸ƒå¼é”ã€ä¼šè¯ç®¡ç†å’Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚</p>
<p>ç„¶è€Œï¼Œè®¸å¤šåˆå­¦è€…åœ¨ç¬¬ä¸€æ¬¡å°† Redis å¼•å…¥ Java é¡¹ç›®æ—¶ï¼Œå¾€å¾€è¢«å„ç§å®¢æˆ·ç«¯é€‰æ‹©ã€è¿æ¥é…ç½®ã€æ€§èƒ½ä¼˜åŒ–ç­‰é—®é¢˜å›°æ‰°ã€‚</p>
<p>æœ¬ç³»åˆ—æ–‡ç« å°±æ˜¯ä¸ºæ­¤è€Œè®¾è®¡çš„ï¼Œæœ¬æ–‡å°†ä»é›¶å¼€å§‹å®Œæˆ Redis å¼€å‘ç¯å¢ƒçš„æ­å»ºä¸å®æˆ˜æ¼”ç¤ºï¼Œå¹¶ç»“åˆä¸šç•Œæœ€ä½³å®è·µè®²è§£è¿æ¥æ± ä¼˜åŒ–ã€ç”Ÿäº§å®‰å…¨é…ç½®åŠæ•…éšœè¯Šæ–­æ–¹æ³•ã€‚</p>
<p>æ— è®ºæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ Redis çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯å‡†å¤‡ä¼˜åŒ–ç°æœ‰ç³»ç»Ÿçš„å·¥ç¨‹å¸ˆï¼Œå¸Œæœ›ä½ éƒ½èƒ½åœ¨æœ¬æ–‡ä¸­æ‰¾åˆ°æ¸…æ™°çš„æŒ‡å¯¼è·¯å¾„ã€‚</p>
<p><strong>æœ¬ç¯‡è¯»è€…æ”¶ç›Š</strong></p>
<ul>
<li>ç†Ÿæ‚‰ Redis çš„å¤šç§å®‰è£…æ–¹å¼ä¸éƒ¨ç½²ç­–ç•¥</li>
<li>ç†è§£ Java ä¸»æµ Redis å®¢æˆ·ç«¯ï¼ˆJedisã€Lettuceã€Redissonï¼‰çš„ç‰¹ç‚¹ä¸é€‚ç”¨åœºæ™¯</li>
<li>æŒæ¡è¿æ¥æ± ä¼˜åŒ–åŠçº¿ç¨‹å®‰å…¨é…ç½®</li>
</ul>
<p>â€‹<strong>å…ˆä¿®è¦æ±‚</strong>â€‹ï¼šç†Ÿæ‚‰ Java ç¼–ç¨‹ä¸ Maven/Gradle æ„å»ºå·¥å…·ï¼Œå…·å¤‡åŸºæœ¬çš„ Linux å‘½ä»¤æ“ä½œèƒ½åŠ›ï¼Œç†è§£ TCP/IP åŸºæœ¬ç½‘ç»œæ¦‚å¿µã€‚</p>
<h2 data-id="heading-1">Redis ä¸ Java çš„é›†æˆåŸç†</h2>
<p>Redis æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜ã€æ”¯æŒå¤šæ•°æ®ç»“æ„ï¼ˆStringã€Hashã€Listã€Setã€ZSet ç­‰ï¼‰çš„é«˜æ€§èƒ½é”®å€¼æ•°æ®åº“ã€‚</p>
<p>åœ¨ Java åº”ç”¨ä¸­ï¼Œå®¢æˆ·ç«¯åº“è´Ÿè´£ä¸ Redis æœåŠ¡ç«¯é€šä¿¡ï¼Œé€šå¸¸é€šè¿‡ TCP Socket å®ç°åŒæ­¥æˆ–å¼‚æ­¥å‘½ä»¤äº¤äº’ã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„æ¶æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">Java åº”ç”¨ â†’ Redis å®¢æˆ·ç«¯ â†’ è¿æ¥æ±  â†’ Redis æœåŠ¡å™¨
    â†“           â†“           â†“           â†“
 ä¸šåŠ¡é€»è¾‘     è¿æ¥ç®¡ç†     èµ„æºå¤ç”¨     æ•°æ®å­˜å‚¨
</code></pre>
<p>è¿æ¥æ± åœ¨è¿™é‡Œèµ·åˆ°å…³é”®ä½œç”¨ï¼Œå®ƒèƒ½æ˜¾è‘—å‡å°‘é¢‘ç¹å»ºç«‹å’Œå…³é—­ TCP è¿æ¥å¸¦æ¥çš„å¼€é”€ï¼Œæ˜¯é«˜å¹¶å‘ç³»ç»Ÿä¸­æå‡æ€§èƒ½çš„å¿…å¤‡ç»„ä»¶ã€‚</p>
<h2 data-id="heading-2">ç¯å¢ƒå‡†å¤‡ä¸å¿«é€Ÿå®‰è£…</h2>
<p>åœ¨è¿›å…¥ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå®Œæˆ Redis æœåŠ¡ç«¯çš„æ­å»ºã€‚ä»¥ä¸‹å‡ ç§æ–¹å¼å¯æŒ‰å®é™…ç¯å¢ƒé€‰æ‹©ã€‚</p>
<h3 data-id="heading-3">æœ¬åœ°å®‰è£…ï¼ˆLinuxï¼‰</h3>
<pre><code class="hljs language-Bash" lang="Bash">sudo apt-get update
sudo apt-get install redis-server
sudo systemctl start redis-server
sudo systemctl <span class="hljs-built_in">enable</span> redis-server
sudo systemctl status redis-server
</code></pre>
<blockquote>
<p>è¿™ç§æ–¹å¼æœ€é€‚åˆåœ¨æœ¬æœºè¿›è¡Œè°ƒè¯•æˆ–å­¦ä¹ ï¼Œæ“ä½œç®€å•ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸å»ºè®®ç›´æ¥è£¸æœºéƒ¨ç½²ã€‚</p>
</blockquote>
<h3 data-id="heading-4">Docker å®‰è£…</h3>
<p>Docker æ˜¯æ­å»º Redis çš„æœ€ç®€æ´æ–¹å¼ï¼Œå¯åœ¨å‡ åˆ†é’Ÿå†…å®Œæˆç¯å¢ƒå‡†å¤‡ã€‚</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># æ‹‰å–é•œåƒ</span>
docker pull redis:latest

<span class="hljs-comment"># è¿è¡Œå®¹å™¨</span>
docker run -d --name redis-dev -p 6379:6379 redis:latest
</code></pre>
<p>è‹¥å¸Œæœ›æ•°æ®æŒä¹…åŒ–ï¼Œå¯æŒ‚è½½æ•°æ®å·ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">docker run -d --name redis-dev \
  -p 6379:6379 \
  -v /path/to/redis/data:/data \
  redis:latest redis-server --appendonly <span class="hljs-built_in">yes</span>
</code></pre>
<blockquote>
<p>åœ¨ä¼ä¸šå†…éƒ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œå»ºè®®ä¸º Redis å®¹å™¨å¯ç”¨å¯†ç è®¤è¯ä¸ç‹¬ç«‹ç½‘ç»œã€‚</p>
</blockquote>
<h3 data-id="heading-5">macOS å®‰è£…ï¼ˆHomebrewï¼‰</h3>
<pre><code class="hljs language-Bash" lang="Bash">brew install redis
brew services start redis
</code></pre>
<h3 data-id="heading-6">å®‰è£…éªŒè¯</h3>
<pre><code class="hljs language-Bash" lang="Bash">redis-cli
127.0.0.1:6379&gt; ping
PONG
</code></pre>
<p>å‡ºç° <code>PONG</code> å³è¡¨ç¤º Redis æœåŠ¡è¿è¡Œæ­£å¸¸ã€‚</p>
<h2 data-id="heading-7">é¡¹ç›®ä¾èµ–é…ç½®</h2>
<p>æ— è®ºä½¿ç”¨ Maven è¿˜æ˜¯ Gradleï¼Œéƒ½éœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ  Redis å®¢æˆ·ç«¯ä¾èµ–ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ Maven ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-XML" lang="XML"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.lettuce<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lettuce-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.3.0.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.redisson<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>redisson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.24.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<blockquote>
<p>â€‹<strong>å»ºè®®</strong>â€‹ï¼š</p>
<ul>
<li>Spring Boot 2.x åŠä»¥ä¸Šé»˜è®¤ä½¿ç”¨ **Lettuce**ï¼Œå…¼å®¹æ€§æœ€ä½³ã€‚</li>
<li>è‹¥éœ€è¦æ›´å¼ºçš„åˆ†å¸ƒå¼é”ä¸æ•°æ®ç»“æ„æ”¯æŒï¼Œå¯é€‰ **Redisson**ã€‚</li>
<li>è‹¥é¡¹ç›®è¾ƒè½»é‡ï¼ŒJedis è¶³ä»¥æ»¡è¶³éœ€æ±‚ã€‚</li>
</ul>
</blockquote>
<h2 data-id="heading-8">å®¢æˆ·ç«¯è¯¦è§£ä¸å®æˆ˜</h2>
<h3 data-id="heading-9">å®¢æˆ·ç«¯é€‰æ‹©</h3>
<p>è¡¨æ ¼ è¿˜åœ¨åŠ è½½ä¸­ï¼Œè¯·ç­‰å¾…åŠ è½½å®Œæˆåå†å°è¯•å¤åˆ¶</p>
<h3 data-id="heading-10">ç¤ºä¾‹</h3>
<h4 data-id="heading-11">Jedis åŸºç¡€è¿æ¥</h4>
<p>æä¾›ç›´è§‚æ˜“æ‡‚çš„åŒæ­¥æ¥å£ï¼Œé€‚åˆå¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>)) {
    jedis.set(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>);
    System.out.println(jedis.get(<span class="hljs-string">"hello"</span>));
}
</code></pre>
<h4 data-id="heading-12">Lettuce å¼‚æ­¥è¿æ¥</h4>
<p>åŸºäº Nettyï¼Œæ€§èƒ½æé«˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">RedisURI</span> <span class="hljs-variable">redisUri</span> <span class="hljs-operator">=</span> RedisURI.create(<span class="hljs-string">"redis://localhost:6379"</span>);
<span class="hljs-type">RedisClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> RedisClient.create(redisUri);
<span class="hljs-keyword">try</span> (StatefulRedisConnection&lt;String, String&gt; conn = client.connect()) {
    RedisCommands&lt;String, String&gt; cmd = conn.sync();
    cmd.set(<span class="hljs-string">"lettuce_key"</span>, <span class="hljs-string">"value"</span>);
    System.out.println(cmd.get(<span class="hljs-string">"lettuce_key"</span>));
}
client.shutdown();
</code></pre>
<h4 data-id="heading-13">Redisson åˆ†å¸ƒå¼ç»“æ„æ“ä½œ</h4>
<p>Redisson ä»¥å¯¹è±¡åŒ–æ–¹å¼å°è£… Redisï¼Œæ”¯æŒ Mapã€Setã€Lock ç­‰é«˜çº§ç‰¹æ€§ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Config</span>();
config.useSingleServer().setAddress(<span class="hljs-string">"redis://localhost:6379"</span>);
<span class="hljs-type">RedissonClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> Redisson.create(config);

<span class="hljs-type">var</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> client.getLock(<span class="hljs-string">"myLock"</span>);
lock.lock();
<span class="hljs-keyword">try</span> {
    System.out.println(<span class="hljs-string">"è·å–åˆ†å¸ƒå¼é”æˆåŠŸ"</span>);
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
client.shutdown();
</code></pre>
<h2 data-id="heading-14">æ€§èƒ½ä¼˜åŒ–ä¸è¿æ¥æ± è®¾è®¡</h2>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿æ¥æ± é…ç½®å¾€å¾€ç›´æ¥å†³å®šç³»ç»Ÿç¨³å®šæ€§ä¸ååé‡ã€‚</p>
<p>ä¾‹å¦‚åœ¨é«˜å¹¶å‘æ¥å£ä¸­ï¼Œè‹¥ Redis è¿æ¥åˆ›å»ºä¸é‡Šæ”¾é¢‘ç¹ï¼Œå°†æå¤§æ‹–æ…¢å“åº”é€Ÿåº¦ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é’ˆå¯¹ <strong>Jedis</strong> å’Œ <strong>Lettuce</strong> çš„ä¼˜åŒ–å®è·µã€‚</p>
<h3 data-id="heading-15">Jedis è¿æ¥æ± </h3>
<ul>
<li>ä½¿ç”¨ <code>JedisPool</code> å®ç°è¿æ¥å¤ç”¨</li>
<li>åŠ¨æ€é…ç½®è¿æ¥æ•°ä¸ç©ºé—²æ£€æµ‹é¢‘ç‡</li>
<li>ç»“åˆ JMX ç›‘æ§è¿æ¥çŠ¶æ€</li>
</ul>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">import</span> redis.clients.jedis.JedisPool;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPoolConfig;

<span class="hljs-keyword">import</span> java.time.Duration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedJedisPool</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> JedisPool jedisPool;
    
    <span class="hljs-comment">// åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> JedisPool <span class="hljs-title function_">getJedisPool</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (jedisPool == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (OptimizedJedisPool.class) {
                <span class="hljs-keyword">if</span> (jedisPool == <span class="hljs-literal">null</span>) {
                    jedisPool = createOptimizedPool();
                }
            }
        }
        <span class="hljs-keyword">return</span> jedisPool;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> JedisPool <span class="hljs-title function_">createOptimizedPool</span><span class="hljs-params">()</span> {
        <span class="hljs-type">JedisPoolConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPoolConfig</span>();
        
        <span class="hljs-comment">// æ ¸å¿ƒè¿æ¥æ•°é…ç½®ï¼ˆæ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">cpuCores</span> <span class="hljs-operator">=</span> Runtime.getRuntime().availableProcessors();
        config.setMaxTotal(cpuCores * <span class="hljs-number">4</span>);          <span class="hljs-comment">// æœ€å¤§è¿æ¥æ•° = CPUæ ¸æ•° Ã— 4</span>
        config.setMaxIdle(cpuCores * <span class="hljs-number">2</span>);           <span class="hljs-comment">// æœ€å¤§ç©ºé—²è¿æ¥</span>
        config.setMinIdle(cpuCores);               <span class="hljs-comment">// æœ€å°ç©ºé—²è¿æ¥</span>
        
        <span class="hljs-comment">// è¿æ¥æœ‰æ•ˆæ€§éªŒè¯</span>
        config.setTestOnBorrow(<span class="hljs-literal">false</span>);             <span class="hljs-comment">// å…³é—­è·å–æ—¶æµ‹è¯•ï¼Œæå‡æ€§èƒ½</span>
        config.setTestOnReturn(<span class="hljs-literal">false</span>);             <span class="hljs-comment">// å…³é—­å½’è¿˜æ—¶æµ‹è¯•</span>
        config.setTestWhileIdle(<span class="hljs-literal">true</span>);             <span class="hljs-comment">// å¼€å¯ç©ºé—²æ—¶æµ‹è¯•</span>
        config.setTimeBetweenEvictionRuns(Duration.ofSeconds(<span class="hljs-number">30</span>)); <span class="hljs-comment">// ç©ºé—²æ£€æŸ¥é—´éš”</span>
        
        <span class="hljs-comment">// è¶…æ—¶é…ç½®</span>
        config.setMaxWait(Duration.ofMillis(<span class="hljs-number">500</span>)); <span class="hljs-comment">// å¿«é€Ÿå¤±è´¥ï¼Œé¿å…çº¿ç¨‹é˜»å¡</span>
        config.setMinEvictableIdleTime(Duration.ofMinutes(<span class="hljs-number">1</span>)); <span class="hljs-comment">// æœ€å°ç©ºé—²æ—¶é—´</span>
        
        <span class="hljs-comment">// è¿æ¥è€—å°½ç­–ç•¥</span>
        config.setBlockWhenExhausted(<span class="hljs-literal">true</span>);        <span class="hljs-comment">// è¿æ¥è€—å°½æ—¶é˜»å¡</span>
        
        <span class="hljs-comment">// JMXç›‘æ§</span>
        config.setJmxEnabled(<span class="hljs-literal">true</span>);
        config.setJmxNamePrefix(<span class="hljs-string">"jedis-pool"</span>);
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPool</span>(config, <span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">1000</span> <span class="hljs-comment">/* è¿æ¥è¶…æ—¶ */</span>);
    }
    
    <span class="hljs-comment">// è¿æ¥æ± ç›‘æ§æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printPoolStats</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (jedisPool != <span class="hljs-literal">null</span>) {
            System.out.println(<span class="hljs-string">"æ´»è·ƒè¿æ¥æ•°: "</span> + jedisPool.getNumActive());
            System.out.println(<span class="hljs-string">"ç©ºé—²è¿æ¥æ•°: "</span> + jedisPool.getNumIdle());
            System.out.println(<span class="hljs-string">"ç­‰å¾…è¿æ¥æ•°: "</span> + jedisPool.getNumWaiters());
        }
    }
    
    <span class="hljs-comment">// èµ„æºæ¸…ç†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closePool</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (jedisPool != <span class="hljs-literal">null</span>) {
            jedisPool.close();
            jedisPool = <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-16">Lettuce è¿æ¥æ± </h3>
<p>Lettuce åŸç”Ÿæ˜¯æ— è¿æ¥æ± è®¾è®¡ï¼ˆå¤šçº¿ç¨‹å…±äº«å•è¿æ¥ï¼‰ï¼Œè‹¥ä½¿ç”¨è¿æ¥æ± ï¼Œå¯ç»“åˆ <code>commons-pool2</code> ç®¡ç†ã€‚</p>
<p>å¤šç§Ÿæˆ·æˆ–å¤šé€»è¾‘æ•°æ®åº“åº”ç”¨ä¸­éå¸¸æœ‰ç”¨ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">import</span> io.lettuce.core.RedisClient;
<span class="hljs-keyword">import</span> io.lettuce.core.RedisURI;
<span class="hljs-keyword">import</span> io.lettuce.core.support.ConnectionPoolSupport;
<span class="hljs-keyword">import</span> io.lettuce.core.api.StatefulRedisConnection;
<span class="hljs-keyword">import</span> org.apache.commons.pool2.impl.GenericObjectPool;
<span class="hljs-keyword">import</span> org.apache.commons.pool2.impl.GenericObjectPoolConfig;

<span class="hljs-keyword">import</span> java.time.Duration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LettucePoolManager</span> {
    
    <span class="hljs-keyword">private</span> RedisClient redisClient;
    <span class="hljs-keyword">private</span> GenericObjectPool&lt;StatefulRedisConnection&lt;String, String&gt;&gt; pool;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LettucePoolManager</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ„å»ºRedis URI</span>
        <span class="hljs-type">RedisURI</span> <span class="hljs-variable">redisUri</span> <span class="hljs-operator">=</span> RedisURI.Builder
                .redis(<span class="hljs-string">"localhost"</span>)
                .withPort(<span class="hljs-number">6379</span>)
                .withTimeout(Duration.ofSeconds(<span class="hljs-number">2</span>))
                .build();
        
        redisClient = RedisClient.create(redisUri);
        
        <span class="hljs-comment">// é…ç½®è¿æ¥æ± </span>
        GenericObjectPoolConfig&lt;StatefulRedisConnection&lt;String, String&gt;&gt; poolConfig = 
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericObjectPoolConfig</span>&lt;&gt;();
        
        <span class="hljs-type">int</span> <span class="hljs-variable">cpuCores</span> <span class="hljs-operator">=</span> Runtime.getRuntime().availableProcessors();
        poolConfig.setMaxTotal(cpuCores * <span class="hljs-number">4</span>);
        poolConfig.setMaxIdle(cpuCores * <span class="hljs-number">2</span>);
        poolConfig.setMinIdle(cpuCores);
        poolConfig.setMaxWait(Duration.ofMillis(<span class="hljs-number">500</span>));
        poolConfig.setTestOnBorrow(<span class="hljs-literal">false</span>);
        poolConfig.setTestOnReturn(<span class="hljs-literal">false</span>);
        poolConfig.setTestWhileIdle(<span class="hljs-literal">true</span>);
        poolConfig.setTimeBetweenEvictionRuns(Duration.ofSeconds(<span class="hljs-number">30</span>));
        
        <span class="hljs-comment">// åˆ›å»ºè¿æ¥æ± </span>
        pool = ConnectionPoolSupport.createGenericObjectPool(
                redisClient::connect, poolConfig);
    }
    
    <span class="hljs-keyword">public</span> StatefulRedisConnection&lt;String, String&gt; <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> pool.borrowObject();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–Redisè¿æ¥å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">returnConnection</span><span class="hljs-params">(StatefulRedisConnection&lt;String, String&gt; connection)</span> {
        <span class="hljs-keyword">if</span> (connection != <span class="hljs-literal">null</span>) {
            pool.returnObject(connection);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (pool != <span class="hljs-literal">null</span> &amp;&amp; !pool.isClosed()) {
            pool.close();
        }
        <span class="hljs-keyword">if</span> (redisClient != <span class="hljs-literal">null</span>) {
            redisClient.shutdown();
        }
    }
    
    <span class="hljs-comment">// è¿æ¥æ± çŠ¶æ€ç›‘æ§</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printPoolStats</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (pool != <span class="hljs-literal">null</span>) {
            System.out.println(<span class="hljs-string">"æ´»è·ƒè¿æ¥æ•°: "</span> + pool.getNumActive());
            System.out.println(<span class="hljs-string">"ç©ºé—²è¿æ¥æ•°: "</span> + pool.getNumIdle());
            System.out.println(<span class="hljs-string">"ç­‰å¾…è¿æ¥æ•°: "</span> + pool.getNumWaiters());
        }
    }
}
</code></pre>
<h2 data-id="heading-17">æ¡ˆä¾‹ï¼šç”µå•†ç”¨æˆ·ä¼šè¯ç®¡ç†</h2>
<p>Redis åœ¨ç”µå•†ç½‘ç«™ä¸­æœ€å¸¸è§çš„ç”¨ä¾‹ä¹‹ä¸€ï¼Œå°±æ˜¯**åˆ†å¸ƒå¼ç”¨æˆ·ä¼šè¯ç®¡ç†**ã€‚</p>
<p>ç›¸æ¯”å°†ä¼šè¯å­˜æ”¾åœ¨ Tomcat Session ä¸­ï¼ŒRedis èƒ½æä¾›æ›´é«˜çš„å¯æ‰©å±•æ€§ä¸è·¨èŠ‚ç‚¹å…±äº«èƒ½åŠ›ã€‚</p>
<p>æ ¸å¿ƒé€»è¾‘åŒ…æ‹¬ï¼š</p>
<ol>
<li>ç”¨æˆ·ç™»å½• â†’ åˆ›å»ºä¼šè¯ï¼ˆ<code>SETEX</code>ï¼‰</li>
<li>è¯·æ±‚è®¿é—® â†’ æ ¡éªŒå¹¶ç»­æœŸ</li>
<li>ç”¨æˆ·ç™»å‡ºæˆ–è¶…æ—¶ â†’ åˆ é™¤ä¼šè¯</li>
</ol>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserSessionManager</span> {
    
    <span class="hljs-keyword">private</span> JedisPool jedisPool;
    <span class="hljs-keyword">private</span> ObjectMapper objectMapper;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserSessionManager</span><span class="hljs-params">(JedisPool jedisPool)</span> {
        <span class="hljs-built_in">this</span>.jedisPool = jedisPool;
        <span class="hljs-built_in">this</span>.objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
    }
    
    <span class="hljs-comment">// ç”¨æˆ·ä¼šè¯ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserSession</span> {
        <span class="hljs-keyword">private</span> String userId;
        <span class="hljs-keyword">private</span> String username;
        <span class="hljs-keyword">private</span> String email;
        <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> loginTime;
        <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> lastAccessTime;
        <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; attributes;
        
        <span class="hljs-comment">// æ„é€ æ–¹æ³•ã€getterã€setter</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserSession</span><span class="hljs-params">()</span> {
            <span class="hljs-built_in">this</span>.attributes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserSession</span><span class="hljs-params">(String userId, String username, String email)</span> {
            <span class="hljs-built_in">this</span>();
            <span class="hljs-built_in">this</span>.userId = userId;
            <span class="hljs-built_in">this</span>.username = username;
            <span class="hljs-built_in">this</span>.email = email;
            <span class="hljs-built_in">this</span>.loginTime = System.currentTimeMillis();
            <span class="hljs-built_in">this</span>.lastAccessTime = <span class="hljs-built_in">this</span>.loginTime;
        }
        
        <span class="hljs-comment">// getterå’Œsetteræ–¹æ³•...</span>
    }
    
    <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·ä¼šè¯</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">createSession</span><span class="hljs-params">(UserSession session, <span class="hljs-type">int</span> expireSeconds)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString();
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"session:"</span> + sessionId;
        
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            <span class="hljs-comment">// æ›´æ–°æœ€åè®¿é—®æ—¶é—´</span>
            session.setLastAccessTime(System.currentTimeMillis());
            
            <span class="hljs-comment">// åºåˆ—åŒ–ä¼šè¯å¯¹è±¡</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">sessionJson</span> <span class="hljs-operator">=</span> objectMapper.writeValueAsString(session);
            
            <span class="hljs-comment">// å­˜å‚¨ä¼šè¯ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´</span>
            jedis.setex(sessionKey, expireSeconds, sessionJson);
            
            <span class="hljs-comment">// å»ºç«‹ç”¨æˆ·IDåˆ°ä¼šè¯IDçš„æ˜ å°„</span>
            jedis.set(<span class="hljs-string">"user_session:"</span> + session.getUserId(), sessionId);
            
            <span class="hljs-keyword">return</span> sessionId;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åˆ›å»ºä¼šè¯å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">// è·å–ç”¨æˆ·ä¼šè¯</span>
    <span class="hljs-keyword">public</span> UserSession <span class="hljs-title function_">getSession</span><span class="hljs-params">(String sessionId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"session:"</span> + sessionId;
        
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">sessionJson</span> <span class="hljs-operator">=</span> jedis.get(sessionKey);
            <span class="hljs-keyword">if</span> (sessionJson == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
            
            <span class="hljs-comment">// æ›´æ–°æœ€åè®¿é—®æ—¶é—´</span>
            jedis.expire(sessionKey, <span class="hljs-number">1800</span>); <span class="hljs-comment">// ç»­æœŸ30åˆ†é’Ÿ</span>
            
            <span class="hljs-keyword">return</span> objectMapper.readValue(sessionJson, UserSession.class);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–ä¼šè¯å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">// åˆ é™¤ä¼šè¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteSession</span><span class="hljs-params">(String sessionId)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            <span class="hljs-comment">// è·å–ä¼šè¯ä¿¡æ¯ä»¥ä¾¿åˆ é™¤ç”¨æˆ·æ˜ å°„</span>
            <span class="hljs-type">UserSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> getSession(sessionId);
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                jedis.del(<span class="hljs-string">"user_session:"</span> + session.getUserId());
            }
            
            <span class="hljs-comment">// åˆ é™¤ä¼šè¯æœ¬èº«</span>
            jedis.del(<span class="hljs-string">"session:"</span> + sessionId);
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">JedisPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> OptimizedJedisPool.getJedisPool();
        <span class="hljs-type">UserSessionManager</span> <span class="hljs-variable">sessionManager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserSessionManager</span>(pool);
        
        <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·ä¼šè¯</span>
        <span class="hljs-type">UserSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserSession</span>(<span class="hljs-string">"1001"</span>, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);
        session.getAttributes().put(<span class="hljs-string">"theme"</span>, <span class="hljs-string">"dark"</span>);
        session.getAttributes().put(<span class="hljs-string">"language"</span>, <span class="hljs-string">"zh-CN"</span>);
        
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> sessionManager.createSession(session, <span class="hljs-number">1800</span>); <span class="hljs-comment">// 30åˆ†é’Ÿè¿‡æœŸ</span>
        
        System.out.println(<span class="hljs-string">"åˆ›å»ºçš„ä¼šè¯ID: "</span> + sessionId);
        
        <span class="hljs-comment">// è·å–ä¼šè¯</span>
        <span class="hljs-type">UserSession</span> <span class="hljs-variable">retrievedSession</span> <span class="hljs-operator">=</span> sessionManager.getSession(sessionId);
        System.out.println(<span class="hljs-string">"ç”¨æˆ·å§“å: "</span> + retrievedSession.getUsername());
        
        <span class="hljs-comment">// æ¸…ç†èµ„æº</span>
        OptimizedJedisPool.closePool();
    }
}
</code></pre>
<h2 data-id="heading-18">å¸¸è§é—®é¢˜</h2>
<p>è¡¨æ ¼ è¿˜åœ¨åŠ è½½ä¸­ï¼Œè¯·ç­‰å¾…åŠ è½½å®Œæˆåå†å°è¯•å¤åˆ¶</p>
<h2 data-id="heading-19">å°ç»“</h2>
<p>æœ¬æ–‡ä»ç¯å¢ƒæ­å»ºã€å®¢æˆ·ç«¯é€‰æ‹©ã€è¿æ¥æ± ä¼˜åŒ–ã€å®‰å…¨é…ç½®åˆ°å®æˆ˜æ¡ˆä¾‹ï¼Œå®Œæ•´å‘ˆç°äº† Java å¼€å‘è€…å¦‚ä½•é«˜æ•ˆä½¿ç”¨ Redis çš„å…¨è¿‡ç¨‹ã€‚</p>
<p>ä½ ç°åœ¨åº”è¯¥å·²ç»æŒæ¡ä»¥ä¸‹è¦ç‚¹ï¼š</p>
<ul>
<li>å¦‚ä½•åœ¨å¤šå¹³å°ä¸Šå¿«é€Ÿæ­å»º Redis ç¯å¢ƒ</li>
<li>å¦‚ä½•é€‰æ‹©åˆé€‚çš„ Java å®¢æˆ·ç«¯ï¼ˆJedis / Lettuce / Redissonï¼‰</li>
<li>å¦‚ä½•é…ç½®è¿æ¥æ± ä»¥å…¼é¡¾æ€§èƒ½ä¸ç¨³å®šæ€§</li>
<li>å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¿éšœ Redis çš„å®‰å…¨ä¸å¯ç”¨æ€§</li>
</ul>
<p>æœªæ¥æˆ‘ä»¬å°†è¿›ä¸€æ­¥æ¢ç´¢ï¼š</p>
<ul>
<li>Redis Cluster ä¸ Sentinel é«˜å¯ç”¨æ¶æ„</li>
<li>ä½¿ç”¨ Redisson å®ç°åˆ†å¸ƒå¼é”ã€å¸ƒéš†è¿‡æ»¤å™¨</li>
<li>åˆ©ç”¨ Spring Data Redis è¿›è¡Œç»Ÿä¸€å°è£…ä¸æ¨¡æ¿åŒ–è®¿é—®</li>
</ul>
<p>Redis çš„å­¦ä¹ æ›²çº¿å¹¶ä¸é™¡å³­ï¼Œä½†æƒ³åœ¨ä¼ä¸šçº§åœºæ™¯ä¸­ç”¨å¥½å®ƒï¼Œéœ€è¦å…¼é¡¾å¼€å‘æ•ˆç‡ä¸ç³»ç»Ÿç¨³å®šæ€§ã€‚  å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½æˆä¸ºä½  Redis å­¦ä¹ ä¸å®æˆ˜è·¯ä¸Šçš„èµ·ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Cloud å¾®æœåŠ¡æ¶æ„ä¸‹å¹‚ç­‰æ€§çš„ ä¸šåŠ¡åœºæ™¯ã€è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€å®Œæ•´å®ç°æ–¹æ¡ˆåŠå¯è¿è¡Œä»£ç ]]></title>    <link>https://juejin.cn/post/7579440586693296174</link>    <guid>https://juejin.cn/post/7579440586693296174</guid>    <pubDate>2025-12-03T07:44:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579440586693296174" data-draft-id="7579215538272436234" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Cloud å¾®æœåŠ¡æ¶æ„ä¸‹å¹‚ç­‰æ€§çš„ ä¸šåŠ¡åœºæ™¯ã€è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€å®Œæ•´å®ç°æ–¹æ¡ˆåŠå¯è¿è¡Œä»£ç "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T07:44:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆå“ˆå“ˆç¬‘ä»€ä¹ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/808832912075352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Cloud å¾®æœåŠ¡æ¶æ„ä¸‹å¹‚ç­‰æ€§çš„ ä¸šåŠ¡åœºæ™¯ã€è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€å®Œæ•´å®ç°æ–¹æ¡ˆåŠå¯è¿è¡Œä»£ç 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/808832912075352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆå“ˆå“ˆç¬‘ä»€ä¹ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:44:46.000Z" title="Wed Dec 03 2025 07:44:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring Cloud å¾®æœåŠ¡æ¶æ„ä¸‹å¹‚ç­‰æ€§çš„ <strong>ä¸šåŠ¡åœºæ™¯ã€è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€å®Œæ•´å®ç°æ–¹æ¡ˆåŠå¯è¿è¡Œä»£ç </strong></h2>
<p>æ ¸å¿ƒæ˜¯å¸Œæœ›æŒæ¡åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­å¦‚ä½•é¿å…é‡å¤æ“ä½œå¯¼è‡´çš„æ•°æ®å¼‚å¸¸ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆææ‡‚ï¼šå¹‚ç­‰æ€§åœ¨Spring Cloudä¸­èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3>
<p>å¹‚ç­‰æ€§å®šä¹‰ï¼š<strong>åŒä¸€è¯·æ±‚ï¼ˆæˆ–æ“ä½œï¼‰å¤šæ¬¡æ‰§è¡Œï¼Œæœ€ç»ˆæ•ˆæœå®Œå…¨ä¸€è‡´ï¼Œä¸ä¼šäº§ç”Ÿé‡å¤æ•°æ®ã€æ•°æ®ä¸ä¸€è‡´æˆ–èµ„æºé‡å¤æ¶ˆè€—</strong>ã€‚</p>
<p>åœ¨ Spring Cloud å¾®æœåŠ¡ï¼ˆåˆ†å¸ƒå¼ã€è·¨æœåŠ¡è°ƒç”¨ã€ç½‘ç»œä¸ç¨³å®šã€å¼‚æ­¥é€šä¿¡ï¼‰åœºæ™¯ä¸‹ï¼Œæ ¸å¿ƒè§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li>é‡å¤æäº¤ï¼šç”¨æˆ·å¿«é€Ÿç‚¹å‡»æŒ‰é’®ï¼ˆå¦‚ä¸‹å•ã€æ”¯ä»˜ï¼‰å¯¼è‡´é‡å¤è¯·æ±‚</li>
<li>æœåŠ¡é‡è¯•ï¼šFeign è°ƒç”¨è¶…æ—¶é‡è¯•ã€ç½‘å…³é‡è¯•å¯¼è‡´é‡å¤å¤„ç†</li>
<li>æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼šMQï¼ˆRocketMQ/Kafkaï¼‰æ¶ˆæ¯é‡è¯•ã€æ¶ˆæ¯é‡æŠ•å¯¼è‡´é‡å¤å¤„ç†</li>
<li>æ”¯ä»˜å›è°ƒé‡è¯•ï¼šç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°ï¼ˆå¾®ä¿¡/æ”¯ä»˜å®ï¼‰å›è°ƒæ¥å£å› ç½‘ç»œè¶…æ—¶é‡è¯•</li>
<li>åˆ†å¸ƒå¼äº‹åŠ¡è¡¥å¿ï¼šTCC/SAGA æ¨¡å¼ä¸‹çš„é‡è¯•æ“ä½œå¯¼è‡´çš„æ•°æ®é‡å¤ä¿®æ”¹</li>
</ol>
<h3 data-id="heading-2">äºŒã€Spring Cloud ä¸­å¹‚ç­‰æ€§çš„å…¸å‹ä¸šåŠ¡åœºæ™¯</h3>
<h4 data-id="heading-3">åœºæ™¯1ï¼šç”¨æˆ·ä¸‹å•ï¼ˆé«˜é¢‘é‡å¤æäº¤+æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼‰</h4>
<ul>
<li>ä¸šåŠ¡æè¿°ï¼šç”¨æˆ·åœ¨ç”µå•†å¹³å°ç‚¹å‡»ã€Œä¸‹å•ã€æŒ‰é’®ï¼Œå› ç½‘ç»œå»¶è¿Ÿå¿«é€Ÿç‚¹å‡»äº†2æ¬¡ï¼Œå¯¼è‡´è®¢å•æœåŠ¡æ”¶åˆ°2æ¬¡ä¸‹å•è¯·æ±‚ï¼›åŒæ—¶è®¢å•æœåŠ¡å‘åº“å­˜æœåŠ¡å‘é€æ‰£å‡åº“å­˜çš„ MQ æ¶ˆæ¯ï¼Œå›  MQ é‡è¯•æœºåˆ¶ï¼Œåº“å­˜æœåŠ¡æ”¶åˆ°2æ¬¡ç›¸åŒæ¶ˆæ¯ã€‚</li>
<li>æ½œåœ¨é—®é¢˜ï¼šé‡å¤åˆ›å»ºè®¢å•ã€é‡å¤æ‰£å‡åº“å­˜ï¼ˆè¶…å–/å°‘å–ï¼‰ã€é‡å¤é”å®šä¼˜æƒ åˆ¸ã€‚</li>
</ul>
<h4 data-id="heading-4">åœºæ™¯2ï¼šæ”¯ä»˜å›è°ƒé€šçŸ¥ï¼ˆAPIé‡è¯•ï¼‰</h4>
<ul>
<li>ä¸šåŠ¡æè¿°ï¼šç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼Œå¾®ä¿¡æ”¯ä»˜å¹³å°å‘å•†æˆ·çš„æ”¯ä»˜å›è°ƒæ¥å£å‘é€é€šçŸ¥ï¼Œä½†å› ç½‘ç»œè¶…æ—¶ï¼Œæ”¯ä»˜å¹³å°é‡è¯•3æ¬¡å›è°ƒè¯·æ±‚ã€‚</li>
<li>æ½œåœ¨é—®é¢˜ï¼šé‡å¤æ›´æ–°è®¢å•çŠ¶æ€ï¼ˆå·²æ”¯ä»˜â†’å·²æ”¯ä»˜é‡å¤æ‰§è¡Œï¼‰ã€é‡å¤ç»™ç”¨æˆ·è´¦æˆ·å…¥è´¦ã€‚</li>
</ul>
<h4 data-id="heading-5">åœºæ™¯3ï¼šå•†å“åº“å­˜æ‰£å‡ï¼ˆæœåŠ¡è°ƒç”¨é‡è¯•ï¼‰</h4>
<ul>
<li>ä¸šåŠ¡æè¿°ï¼šè®¢å•æœåŠ¡é€šè¿‡ Feign è°ƒç”¨åº“å­˜æœåŠ¡æ‰£å‡åº“å­˜ï¼Œå› åº“å­˜æœåŠ¡å“åº”è¶…æ—¶ï¼ŒFeign è§¦å‘é‡è¯•æœºåˆ¶ï¼Œå‘èµ·å¤šæ¬¡æ‰£å‡è¯·æ±‚ã€‚</li>
<li>æ½œåœ¨é—®é¢˜ï¼šåº“å­˜é‡å¤æ‰£å‡ï¼ˆå¯¼è‡´è¶…å–ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">ä¸‰ã€Spring Cloud å¹‚ç­‰æ€§å®Œæ•´è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-7">æ ¸å¿ƒæ€è·¯</h4>
<p>ç»“åˆã€Œå‰ç«¯é˜²é‡ + åç«¯å¹‚ç­‰æ ¡éªŒ + æ•°æ®å±‚çº¦æŸã€ä¸‰å±‚é˜²æŠ¤ï¼Œé€‰æ‹©é€‚åˆåœºæ™¯çš„å¹‚ç­‰æ–¹æ¡ˆï¼š</p>









































<table><thead><tr><th>æ–¹æ¡ˆç±»å‹</th><th>é€‚ç”¨åœºæ™¯</th><th>æ ¸å¿ƒåŸç†</th><th>æŠ€æœ¯é€‰å‹</th></tr></thead><tbody><tr><td>å”¯ä¸€è¯·æ±‚ID + Redis</td><td>é‡å¤æäº¤ã€APIé‡è¯•</td><td>é¦–æ¬¡è¯·æ±‚å­˜å‚¨IDï¼Œé‡å¤è¯·æ±‚ç›´æ¥æ‹¦æˆª</td><td>Redis + è‡ªå®šä¹‰æ³¨è§£+æ‹¦æˆªå™¨</td></tr><tr><td>æ•°æ®åº“å”¯ä¸€çº¦æŸ</td><td>è®¢å•åˆ›å»ºã€ç”¨æˆ·æ³¨å†Œ</td><td>å”¯ä¸€ç´¢å¼•/è”åˆç´¢å¼•é˜²æ­¢é‡å¤æ•°æ®æ’å…¥</td><td>MySQL å”¯ä¸€ç´¢å¼•</td></tr><tr><td>ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰</td><td>åº“å­˜æ‰£å‡ã€è®¢å•çŠ¶æ€æ›´æ–°</td><td>åŸºäºç‰ˆæœ¬å·æ§åˆ¶ï¼Œä»…å…è®¸çŠ¶æ€å˜æ›´ä¸€æ¬¡</td><td>MySQL ç‰ˆæœ¬å­—æ®µ + MyBatis</td></tr><tr><td>æ¶ˆæ¯ID + Redis</td><td>MQæ¶ˆæ¯é‡å¤æ¶ˆè´¹</td><td>æ¶ˆè´¹å‰æ ¡éªŒæ¶ˆæ¯IDæ˜¯å¦å·²å¤„ç†</td><td>Redis + MQ æ¶ˆè´¹ç›‘å¬</td></tr><tr><td>çŠ¶æ€æœºæ§åˆ¶</td><td>è®¢å•çŠ¶æ€æµè½¬ï¼ˆå¾…æ”¯ä»˜â†’å·²æ”¯ä»˜ï¼‰</td><td>ä»…å…è®¸ä»æŒ‡å®šçŠ¶æ€æµè½¬åˆ°ç›®æ ‡çŠ¶æ€</td><td>ä¸šåŠ¡ä»£ç ä¸­çŠ¶æ€åˆ¤æ–­</td></tr></tbody></table>
<h4 data-id="heading-8">æŠ€æœ¯æ ˆé€‰å‹ï¼ˆSpring Cloud Alibaba ç”Ÿæ€ï¼‰</h4>
<ul>
<li>åŸºç¡€æ¡†æ¶ï¼šSpring Boot 2.7.x + Spring Cloud Alibaba 2021.0.4.0</li>
<li>æœåŠ¡æ³¨å†Œå‘ç°ï¼šNacos</li>
<li>ç¼“å­˜ï¼ˆå¹‚ç­‰æ ¡éªŒï¼‰ï¼šRedis</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šRocketMQï¼ˆå¤„ç†å¼‚æ­¥é€šä¿¡+é‡å¤æ¶ˆè´¹ï¼‰</li>
<li>æŒä¹…å±‚ï¼šMyBatis-Plus + MySQL 8.0</li>
<li>æ¥å£æ–‡æ¡£ï¼šSwaggerï¼ˆå¯é€‰ï¼Œæ–¹ä¾¿æµ‹è¯•ï¼‰</li>
</ul>
<h3 data-id="heading-9">å››ã€å®Œæ•´ä»£ç å®ç°ï¼ˆèšç„¦åœºæ™¯1+åœºæ™¯2ï¼‰</h3>
<h4 data-id="heading-10">1. é¡¹ç›®æ•´ä½“ç»“æ„</h4>
<pre><code class="hljs language-bash" lang="bash">idempotent-demo/
â”œâ”€â”€ idempotent-common/        <span class="hljs-comment"># å…¬å…±æ¨¡å—ï¼ˆæ³¨è§£ã€å·¥å…·ç±»ï¼‰</span>
â”œâ”€â”€ idempotent-order/         <span class="hljs-comment"># è®¢å•æœåŠ¡ï¼ˆåœºæ™¯1ï¼šä¸‹å•+åœºæ™¯2ï¼šæ”¯ä»˜å›è°ƒï¼‰</span>
â”œâ”€â”€ idempotent-inventory/     <span class="hljs-comment"># åº“å­˜æœåŠ¡ï¼ˆåœºæ™¯1ï¼šåº“å­˜æ‰£å‡ï¼‰</span>
â””â”€â”€ pom.xml                   <span class="hljs-comment"># çˆ¶å·¥ç¨‹ä¾èµ–</span>
</code></pre>
<h4 data-id="heading-11">2. çˆ¶å·¥ç¨‹ä¾èµ–ï¼ˆpom.xmlï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.15<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>idempotent-demo<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>idempotent-common<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>idempotent-order<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>idempotent-inventory<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud-alibaba.version</span>&gt;</span>2021.0.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud-alibaba.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ä¾èµ–ç®¡ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- Spring Cloud Alibaba ä¾èµ– --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud-alibaba.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- Spring Boot æ ¸å¿ƒä¾èµ– --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- å·¥å…·ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ¥å£æ–‡æ¡£ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h4 data-id="heading-12">3. å…¬å…±æ¨¡å—ï¼ˆidempotent-commonï¼‰</h4>
<h5 data-id="heading-13">3.1 å¹‚ç­‰æ³¨è§£ï¼ˆ@Idempotentï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.idempotent.common.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * å¹‚ç­‰æ³¨è§£ï¼šæ ‡è®°éœ€è¦å¹‚ç­‰æ ¡éªŒçš„æ¥å£
 */</span>
<span class="hljs-meta">@Target({ElementType.METHOD})</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Documented</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Idempotent {
    <span class="hljs-comment">/**
     * Redis è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤30ç§’ï¼‰
     */</span>
    <span class="hljs-type">long</span> <span class="hljs-title function_">expire</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-number">30</span>;

    <span class="hljs-comment">/**
     * æ—¶é—´å•ä½ï¼ˆé»˜è®¤ç§’ï¼‰
     */</span>
    TimeUnit <span class="hljs-title function_">timeUnit</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> TimeUnit.SECONDS;

    <span class="hljs-comment">/**
     * é‡å¤è¯·æ±‚æç¤ºä¿¡æ¯
     */</span>
    String <span class="hljs-title function_">message</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">"æ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•ï¼"</span>;
}
</code></pre>
<h5 data-id="heading-14">3.2 Redis å·¥å…·ç±»ï¼ˆRedisUtilï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">idempotent</span>.<span class="hljs-property">common</span>.<span class="hljs-property">util</span>;

<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">data</span>.<span class="hljs-property">redis</span>.<span class="hljs-property">core</span>.<span class="hljs-property">StringRedisTemplate</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;

<span class="hljs-keyword">import</span> javax.<span class="hljs-property">annotation</span>.<span class="hljs-property">Resource</span>;
<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-comment">/**
 * Redis å·¥å…·ç±»ï¼ˆç®€åŒ–å¹‚ç­‰æ ¡éªŒçš„å­˜å‚¨/æŸ¥è¯¢ï¼‰
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisUtil</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">StringRedisTemplate</span> stringRedisTemplate;

    <span class="hljs-comment">/**
     * å­˜å‚¨å¹‚ç­‰é”®ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™å­˜å‚¨ï¼Œè¿”å›trueï¼›å·²å­˜åœ¨è¿”å›falseï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">setIfAbsent</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key, <span class="hljs-built_in">String</span> value, long expire, TimeUnit timeUnit</span>) {
        <span class="hljs-title class_">Boolean</span> success = stringRedisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">setIfAbsent</span>(key, value, expire, timeUnit);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Boolean</span>.<span class="hljs-property">TRUE</span>.<span class="hljs-title function_">equals</span>(success);
    }

    <span class="hljs-comment">/**
     * åˆ é™¤å¹‚ç­‰é”®
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key</span>) {
        stringRedisTemplate.<span class="hljs-title function_">delete</span>(key);
    }

    <span class="hljs-comment">/**
     * æŸ¥è¯¢å¹‚ç­‰é”®æ˜¯å¦å­˜åœ¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">hasKey</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key</span>) {
        <span class="hljs-title class_">Boolean</span> exists = stringRedisTemplate.<span class="hljs-title function_">hasKey</span>(key);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Boolean</span>.<span class="hljs-property">TRUE</span>.<span class="hljs-title function_">equals</span>(exists);
    }
}
</code></pre>
<h5 data-id="heading-15">3.3 å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆGlobalExceptionHandlerï¼‰</h5>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> com.example.idempotent.common.exception;

<span class="hljs-keyword">import</span> lombok.<span class="hljs-type">Data</span>;

<span class="hljs-comment">/**
 * å¹‚ç­‰å¼‚å¸¸ï¼ˆé‡å¤è¯·æ±‚æ—¶æŠ›å‡ºï¼‰
 */</span>
<span class="hljs-meta">@Data</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IdempotentException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RuntimeException</span> </span>{
    <span class="hljs-keyword">private</span> int code = <span class="hljs-number">409</span>; <span class="hljs-comment">// å†²çªçŠ¶æ€ç </span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> message;

    public <span class="hljs-type">IdempotentException</span>(<span class="hljs-type">String</span> message) {
        <span class="hljs-keyword">super</span>(message);
        <span class="hljs-keyword">this</span>.message = message;
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.idempotent.common.exception;

<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseStatus;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * å…¨å±€å¼‚å¸¸å¤„ç†å™¨
 */</span>
<span class="hljs-meta">@RestControllerAdvice</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> {

    <span class="hljs-comment">/**
     * å¤„ç†å¹‚ç­‰å¼‚å¸¸
     */</span>
    <span class="hljs-meta">@ExceptionHandler(IdempotentException.class)</span>
    <span class="hljs-meta">@ResponseStatus(HttpStatus.CONFLICT)</span>
    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">handleIdempotentException</span><span class="hljs-params">(IdempotentException e)</span> {
        Map&lt;String, Object&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        result.put(<span class="hljs-string">"code"</span>, e.getCode());
        result.put(<span class="hljs-string">"message"</span>, e.getMessage());
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<h4 data-id="heading-16">4. è®¢å•æœåŠ¡ï¼ˆidempotent-orderï¼‰</h4>
<h5 data-id="heading-17">4.1 é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span>

<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">idempotent-order</span>
  <span class="hljs-comment"># Redis é…ç½®</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>
    <span class="hljs-attr">lettuce:</span>
      <span class="hljs-attr">pool:</span>
        <span class="hljs-attr">max-active:</span> <span class="hljs-number">8</span>
  <span class="hljs-comment"># æ•°æ®åº“é…ç½®</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/idempotent_db?useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
  <span class="hljs-comment"># RocketMQ é…ç½®</span>
  <span class="hljs-attr">rocketmq:</span>
    <span class="hljs-attr">name-server:</span> <span class="hljs-string">localhost:9876</span>
    <span class="hljs-attr">producer:</span>
      <span class="hljs-attr">group:</span> <span class="hljs-string">order-producer-group</span>

<span class="hljs-comment"># Nacos æœåŠ¡æ³¨å†Œ</span>
<span class="hljs-attr">spring.cloud.nacos.discovery:</span>
  <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span>

<span class="hljs-comment"># MyBatis-Plus é…ç½®</span>
<span class="hljs-attr">mybatis-plus:</span>
  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath:mapper/*.xml</span>
  <span class="hljs-attr">type-aliases-package:</span> <span class="hljs-string">com.example.idempotent.order.entity</span>
  <span class="hljs-attr">configuration:</span>
    <span class="hljs-attr">map-underscore-to-camel-case:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">log-impl:</span> <span class="hljs-string">org.apache.ibatis.logging.stdout.StdOutImpl</span>
</code></pre>
<h5 data-id="heading-18">4.2 æ•°æ®åº“è¡¨è®¾è®¡ï¼ˆè®¢å•è¡¨ï¼‰</h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> DATABASE IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> idempotent_db;
USE idempotent_db;

<span class="hljs-comment">-- è®¢å•è¡¨ï¼ˆå”¯ä¸€ç´¢å¼•é˜²é‡å¤åˆ›å»ºï¼Œç‰ˆæœ¬å·æ§åˆ¶ä¹è§‚é”ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_order` (
  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'ä¸»é”®ID'</span>,
  `order_no` <span class="hljs-type">varchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è®¢å•å·ï¼ˆå”¯ä¸€ï¼‰'</span>,
  `user_id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ç”¨æˆ·ID'</span>,
  `product_id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å•†å“ID'</span>,
  `amount` <span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è®¢å•é‡‘é¢'</span>,
  `status` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è®¢å•çŠ¶æ€ï¼š0-å¾…æ”¯ä»˜ï¼Œ1-å·²æ”¯ä»˜ï¼Œ2-å·²å–æ¶ˆ'</span>,
  `version` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰'</span>,
  `create_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  `update_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  <span class="hljs-keyword">UNIQUE</span> KEY `uk_order_no` (`order_no`) COMMENT <span class="hljs-string">'è®¢å•å·å”¯ä¸€çº¦æŸ'</span>
) ENGINE<span class="hljs-operator">=</span>InnoDB <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'è®¢å•è¡¨'</span>;
</code></pre>
<h5 data-id="heading-19">4.3 å®ä½“ç±»ï¼ˆOrderï¼‰</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.example.idempotent.order.entity;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.<span class="hljs-keyword">annotation</span>.IdType;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.<span class="hljs-keyword">annotation</span>.TableId;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.<span class="hljs-keyword">annotation</span>.TableName;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;

<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@TableName(<span class="hljs-string">"t_order"</span>)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> {
    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> id;
    <span class="hljs-keyword">private</span> String orderNo; <span class="hljs-comment">// è®¢å•å·ï¼ˆå”¯ä¸€ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> userId;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> productId;
    <span class="hljs-keyword">private</span> BigDecimal amount;
    <span class="hljs-keyword">private</span> Integer status; <span class="hljs-comment">// 0-å¾…æ”¯ä»˜ï¼Œ1-å·²æ”¯ä»˜ï¼Œ2-å·²å–æ¶ˆ</span>
    <span class="hljs-keyword">private</span> Integer version; <span class="hljs-comment">// ä¹è§‚é”ç‰ˆæœ¬å·</span>
    <span class="hljs-keyword">private</span> LocalDateTime createTime;
    <span class="hljs-keyword">private</span> LocalDateTime updateTime;
}
</code></pre>
<h5 data-id="heading-20">4.4 å¹‚ç­‰æ‹¦æˆªå™¨ï¼ˆIdempotentInterceptorï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.idempotent.order.interceptor;

<span class="hljs-keyword">import</span> com.example.idempotent.common.annotation.Idempotent;
<span class="hljs-keyword">import</span> com.example.idempotent.common.exception.IdempotentException;
<span class="hljs-keyword">import</span> com.example.idempotent.common.util.RedisUtil;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> org.springframework.web.method.HandlerMethod;
<span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;

<span class="hljs-keyword">import</span> javax.annotation.Resource;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-comment">/**
 * å¹‚ç­‰æ‹¦æˆªå™¨ï¼šæ‹¦æˆªå¸¦æœ‰<span class="hljs-doctag">@Idempotent</span>æ³¨è§£çš„æ¥å£ï¼Œè¿›è¡Œå¹‚ç­‰æ ¡éªŒ
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdempotentInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> RedisUtil redisUtil;

    <span class="hljs-comment">// å¹‚ç­‰è¯·æ±‚å¤´åç§°ï¼ˆå‰ç«¯éœ€ä¼ é€’å”¯ä¸€è¯·æ±‚IDï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">IDEMPOTENT_REQUEST_ID</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Idempotent-Request-Id"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ¤æ–­æ˜¯å¦æ˜¯ç›®æ ‡æ–¹æ³•ï¼ˆControlleræ¥å£æ–¹æ³•ï¼‰</span>
        <span class="hljs-keyword">if</span> (!(handler <span class="hljs-keyword">instanceof</span> HandlerMethod handlerMethod)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> handlerMethod.getMethod();
        <span class="hljs-type">Idempotent</span> <span class="hljs-variable">idempotent</span> <span class="hljs-operator">=</span> method.getAnnotation(Idempotent.class);
        <span class="hljs-keyword">if</span> (idempotent == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ— å¹‚ç­‰æ³¨è§£ï¼Œç›´æ¥æ”¾è¡Œ</span>
        }

        <span class="hljs-comment">// 2. è·å–å‰ç«¯ä¼ é€’çš„å”¯ä¸€è¯·æ±‚ID</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">requestId</span> <span class="hljs-operator">=</span> request.getHeader(IDEMPOTENT_REQUEST_ID);
        <span class="hljs-keyword">if</span> (requestId == <span class="hljs-literal">null</span> || requestId.trim().isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdempotentException</span>(<span class="hljs-string">"ç¼ºå°‘å¹‚ç­‰è¯·æ±‚IDï¼Œè¯·é‡è¯•ï¼"</span>);
        }

        <span class="hljs-comment">// 3. æ„å»ºRedisé”®ï¼ˆç”¨æˆ·ID+è¯·æ±‚IDï¼Œé¿å…ä¸åŒç”¨æˆ·å†²çªï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"User-Id"</span>); <span class="hljs-comment">// å®é™…åœºæ™¯ä»Tokenä¸­è§£æ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">"idempotent:%s:%s:%s"</span>, userId, request.getRequestURI(), requestId);

        <span class="hljs-comment">// 4. Redisæ ¡éªŒï¼šä¸å­˜åœ¨åˆ™å­˜å‚¨ï¼Œå­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> redisUtil.setIfAbsent(
                redisKey,
                <span class="hljs-string">"1"</span>,
                idempotent.expire(),
                idempotent.timeUnit()
        );
        <span class="hljs-keyword">if</span> (!success) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdempotentException</span>(idempotent.message());
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h5 data-id="heading-21">4.5 æ‹¦æˆªå™¨é…ç½®ï¼ˆWebConfigï¼‰</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.example.idempotent.order.config;

<span class="hljs-keyword">import</span> com.example.idempotent.order.interceptor.IdempotentInterceptor;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Configuration;
<span class="hljs-keyword">import</span> org.springframework.web.servlet.config.<span class="hljs-keyword">annotation</span>.InterceptorRegistry;
<span class="hljs-keyword">import</span> org.springframework.web.servlet.config.<span class="hljs-keyword">annotation</span>.WebMvcConfigurer;

<span class="hljs-keyword">import</span> javax.<span class="hljs-keyword">annotation</span>.Resource;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebConfig</span> <span class="hljs-title">implements</span> <span class="hljs-title">WebMvcConfigurer</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> IdempotentInterceptor idempotentInterceptor;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> void addInterceptors(InterceptorRegistry registry) {
        <span class="hljs-comment">// æ³¨å†Œå¹‚ç­‰æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªæ‰€æœ‰æ¥å£ï¼ˆå¯é€šè¿‡excludePathPatternsæ’é™¤ä¸éœ€è¦çš„æ¥å£ï¼‰</span>
        registry.addInterceptor(idempotentInterceptor)
                .addPathPatterns(<span class="hljs-string">"/**"</span>)
                .excludePathPatterns(<span class="hljs-string">"/swagger-ui/**"</span>, <span class="hljs-string">"/v3/api-docs/**"</span>);
    }
}
</code></pre>
<h5 data-id="heading-22">4.6 Mapper + Serviceï¼ˆè®¢å•æœåŠ¡æ ¸å¿ƒé€»è¾‘ï¼‰</h5>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">package</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.order</span><span class="hljs-selector-class">.mapper</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.baomidou</span><span class="hljs-selector-class">.mybatisplus</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.mapper</span><span class="hljs-selector-class">.BaseMapper</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.order</span><span class="hljs-selector-class">.entity</span><span class="hljs-selector-class">.Order</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.ibatis</span><span class="hljs-selector-class">.annotations</span><span class="hljs-selector-class">.Mapper</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.ibatis</span><span class="hljs-selector-class">.annotations</span><span class="hljs-selector-class">.Param</span>;

@<span class="hljs-selector-tag">Mapper</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">interface</span> <span class="hljs-selector-tag">OrderMapper</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">BaseMapper</span>&lt;<span class="hljs-selector-tag">Order</span>&gt; {
    <span class="hljs-comment">// ä¹è§‚é”æ›´æ–°è®¢å•çŠ¶æ€</span>
    <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">updateOrderStatus</span>(<span class="hljs-variable">@Param</span>(<span class="hljs-string">"orderNo"</span>) String orderNo, <span class="hljs-variable">@Param</span>(<span class="hljs-string">"oldStatus"</span>) Integer oldStatus, <span class="hljs-variable">@Param</span>(<span class="hljs-string">"newStatus"</span>) Integer newStatus, <span class="hljs-variable">@Param</span>(<span class="hljs-string">"version"</span>) Integer version);
}
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- resources/mapper/OrderMapper.xml --&gt;</span>
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="hljs-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"com.example.idempotent.order.mapper.OrderMapper"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ä¹è§‚é”æ›´æ–°è®¢å•çŠ¶æ€ï¼šä»…å½“ç‰ˆæœ¬å·åŒ¹é…ä¸”çŠ¶æ€ä¸ºoldStatusæ—¶æ›´æ–° --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"updateOrderStatus"</span>&gt;</span>
        UPDATE t_order
        SET status = #{newStatus}, version = version + 1, update_time = NOW()
        WHERE order_no = #{orderNo} AND status = #{oldStatus} AND version = #{version}
    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.idempotent.order.service;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
<span class="hljs-keyword">import</span> com.example.idempotent.common.util.RedisUtil;
<span class="hljs-keyword">import</span> com.example.idempotent.order.entity.Order;
<span class="hljs-keyword">import</span> com.example.idempotent.order.mapper.OrderMapper;
<span class="hljs-keyword">import</span> com.example.idempotent.order.feign.InventoryFeignClient;
<span class="hljs-keyword">import</span> com.example.idempotent.order.mq.OrderMqProducer;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;

<span class="hljs-keyword">import</span> javax.annotation.Resource;
<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.util.UUID;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;OrderMapper, Order&gt; {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> InventoryFeignClient inventoryFeignClient; <span class="hljs-comment">// Feignè°ƒç”¨åº“å­˜æœåŠ¡</span>
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> OrderMqProducer orderMqProducer; <span class="hljs-comment">// MQç”Ÿäº§è€…</span>
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> RedisUtil redisUtil;

    <span class="hljs-comment">/**
     * ä¸‹å•æ¥å£ï¼ˆå¹‚ç­‰å¤„ç†ï¼šRedis+å”¯ä¸€è®¢å•å·ï¼‰
     */</span>
    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> Order <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Long userId, Long productId, BigDecimal amount)</span> {
        <span class="hljs-comment">// 1. ç”Ÿæˆå”¯ä¸€è®¢å•å·ï¼ˆé˜²æ­¢æ•°æ®åº“é‡å¤æ’å…¥ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">orderNo</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString().replace(<span class="hljs-string">"-"</span>, <span class="hljs-string">""</span>).substring(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>);

        <span class="hljs-comment">// 2. åˆ›å»ºè®¢å•ï¼ˆæ•°æ®åº“å”¯ä¸€ç´¢å¼•order_noé˜²æ­¢é‡å¤ï¼‰</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
        order.setOrderNo(orderNo);
        order.setUserId(userId);
        order.setProductId(productId);
        order.setAmount(amount);
        order.setStatus(<span class="hljs-number">0</span>); <span class="hljs-comment">// 0-å¾…æ”¯ä»˜</span>
        orderMapper.insert(order);

        <span class="hljs-comment">// 3. å¼‚æ­¥æ‰£å‡åº“å­˜ï¼ˆå‘é€MQæ¶ˆæ¯ï¼Œåº“å­˜æœåŠ¡æ¶ˆè´¹æ—¶åšå¹‚ç­‰å¤„ç†ï¼‰</span>
        orderMqProducer.sendDeductInventoryMsg(orderNo, productId, <span class="hljs-number">1</span>);

        <span class="hljs-keyword">return</span> order;
    }

    <span class="hljs-comment">/**
     * æ”¯ä»˜å›è°ƒæ¥å£ï¼ˆå¹‚ç­‰å¤„ç†ï¼šçŠ¶æ€æœº+ä¹è§‚é”ï¼‰
     */</span>
    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">handlePayCallback</span><span class="hljs-params">(String orderNo, Integer version)</span> {
        <span class="hljs-comment">// 1. çŠ¶æ€æœºæ§åˆ¶ï¼šä»…å…è®¸ä»ã€Œå¾…æ”¯ä»˜ï¼ˆ0ï¼‰ã€æ›´æ–°ä¸ºã€Œå·²æ”¯ä»˜ï¼ˆ1ï¼‰ã€</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">rows</span> <span class="hljs-operator">=</span> orderMapper.updateOrderStatus(orderNo, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, version);
        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// æ›´æ–°å¤±è´¥ï¼šå¯èƒ½æ˜¯é‡å¤å›è°ƒï¼Œæˆ–çŠ¶æ€å·²å˜æ›´</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-comment">// 2. åç»­ä¸šåŠ¡ï¼šå¦‚ç»™ç”¨æˆ·å…¥è´¦ã€å‘é€é€šçŸ¥ç­‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h5 data-id="heading-23">4.7 MQç”Ÿäº§è€…ï¼ˆOrderMqProducerï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">idempotent</span>.<span class="hljs-property">order</span>.<span class="hljs-property">mq</span>;

<span class="hljs-keyword">import</span> org.<span class="hljs-property">apache</span>.<span class="hljs-property">rocketmq</span>.<span class="hljs-property">client</span>.<span class="hljs-property">producer</span>.<span class="hljs-property">SendResult</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">apache</span>.<span class="hljs-property">rocketmq</span>.<span class="hljs-property">spring</span>.<span class="hljs-property">core</span>.<span class="hljs-property">RocketMQTemplate</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;

<span class="hljs-keyword">import</span> javax.<span class="hljs-property">annotation</span>.<span class="hljs-property">Resource</span>;

<span class="hljs-comment">/**
 * è®¢å•MQç”Ÿäº§è€…ï¼šå‘é€åº“å­˜æ‰£å‡æ¶ˆæ¯
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderMqProducer</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">RocketMQTemplate</span> rocketMQTemplate;

    <span class="hljs-comment">// åº“å­˜æ‰£å‡æ¶ˆæ¯ä¸»é¢˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-variable constant_">TOPIC_DEDUCT_INVENTORY</span> = <span class="hljs-string">"topic-deduct-inventory"</span>;

    <span class="hljs-comment">/**
     * å‘é€åº“å­˜æ‰£å‡æ¶ˆæ¯ï¼ˆæ¶ˆæ¯IDä½œä¸ºå¹‚ç­‰æ ‡è¯†ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">SendResult</span> <span class="hljs-title function_">sendDeductInventoryMsg</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> orderNo, Long productId, Integer num</span>) {
        <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯å†…å®¹ï¼ˆåŒ…å«è®¢å•å·ã€å•†å“IDã€æ‰£å‡æ•°é‡ï¼‰</span>
        <span class="hljs-title class_">DeductInventoryMsg</span> msg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeductInventoryMsg</span>();
        msg.<span class="hljs-title function_">setOrderNo</span>(orderNo);
        msg.<span class="hljs-title function_">setProductId</span>(productId);
        msg.<span class="hljs-title function_">setNum</span>(num);

        <span class="hljs-comment">// å‘é€æ¶ˆæ¯ï¼ˆRocketMQè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€æ¶ˆæ¯IDï¼Œæ¶ˆè´¹æ—¶ç”¨è¯¥IDåšå¹‚ç­‰ï¼‰</span>
        <span class="hljs-keyword">return</span> rocketMQTemplate.<span class="hljs-title function_">syncSend</span>(<span class="hljs-variable constant_">TOPIC_DEDUCT_INVENTORY</span>, msg);
    }

    <span class="hljs-comment">// æ¶ˆæ¯å®ä½“</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeductInventoryMsg</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> orderNo;
        <span class="hljs-keyword">private</span> <span class="hljs-title class_">Long</span> productId;
        <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> num;

        <span class="hljs-comment">// getter/setter</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getOrderNo</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> orderNo; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setOrderNo</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> orderNo</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">orderNo</span> = orderNo; }
        <span class="hljs-keyword">public</span> <span class="hljs-title class_">Long</span> <span class="hljs-title function_">getProductId</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> productId; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setProductId</span>(<span class="hljs-params">Long productId</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">productId</span> = productId; }
        <span class="hljs-keyword">public</span> <span class="hljs-title class_">Integer</span> <span class="hljs-title function_">getNum</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> num; }
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setNum</span>(<span class="hljs-params">Integer num</span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = num; }
    }
}
</code></pre>
<h5 data-id="heading-24">4.8 Controllerï¼ˆå¯¹å¤–æ¥å£ï¼‰</h5>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">package</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.order</span><span class="hljs-selector-class">.controller</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Idempotent</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.order</span><span class="hljs-selector-class">.entity</span><span class="hljs-selector-class">.Order</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.idempotent</span><span class="hljs-selector-class">.order</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.OrderService</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">io</span><span class="hljs-selector-class">.swagger</span><span class="hljs-selector-class">.annotations</span><span class="hljs-selector-class">.Api</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">io</span><span class="hljs-selector-class">.swagger</span><span class="hljs-selector-class">.annotations</span><span class="hljs-selector-class">.ApiOperation</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.bind</span><span class="hljs-selector-class">.annotation</span>.*;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Resource</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.math</span><span class="hljs-selector-class">.BigDecimal</span>;

@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/order"</span>)
@<span class="hljs-selector-tag">Api</span>(tags = <span class="hljs-string">"è®¢å•æ¥å£ï¼ˆå¹‚ç­‰æ€§ç¤ºä¾‹ï¼‰"</span>)
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">OrderController</span> {

    <span class="hljs-variable">@Resource</span>
    private OrderService orderService;

    <span class="hljs-comment">/**
     * ä¸‹å•æ¥å£ï¼ˆå¹‚ç­‰æ³¨è§£ï¼šé˜²æ­¢é‡å¤æäº¤ï¼‰
     * å‰ç«¯éœ€ä¼ é€’è¯·æ±‚å¤´ï¼šIdempotent-Request-Idï¼ˆå”¯ä¸€IDï¼‰ã€User-Idï¼ˆç”¨æˆ·IDï¼‰
     */</span>
    <span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/create"</span>)
    <span class="hljs-variable">@ApiOperation</span>(<span class="hljs-string">"åˆ›å»ºè®¢å•"</span>)
    <span class="hljs-variable">@Idempotent</span>(expire = <span class="hljs-number">60</span>, message = <span class="hljs-string">"ä¸‹å•è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·1åˆ†é’Ÿåé‡è¯•ï¼"</span>)
    public Order <span class="hljs-built_in">createOrder</span>(
            <span class="hljs-variable">@RequestHeader</span>(<span class="hljs-string">"User-Id"</span>) Long userId,
            <span class="hljs-variable">@RequestParam</span> Long productId,
            <span class="hljs-variable">@RequestParam</span> BigDecimal amount) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">orderService</span><span class="hljs-selector-class">.createOrder</span>(userId, productId, amount);
    }

    <span class="hljs-comment">/**
     * æ”¯ä»˜å›è°ƒæ¥å£ï¼ˆå¹‚ç­‰å¤„ç†ï¼šçŠ¶æ€æœº+ä¹è§‚é”ï¼‰
     * æ”¯ä»˜å¹³å°å›è°ƒæ—¶ä¼ é€’è®¢å•å·å’Œç‰ˆæœ¬å·
     */</span>
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/pay/callback"</span>)
    @<span class="hljs-selector-tag">ApiOperation</span>(<span class="hljs-string">"æ”¯ä»˜å›è°ƒ"</span>)
    @<span class="hljs-selector-tag">Idempotent</span>(expire = <span class="hljs-number">180</span>, message = <span class="hljs-string">"å›è°ƒè¯·æ±‚å·²å¤„ç†ï¼Œè¯·ä¸è¦é‡å¤æäº¤ï¼"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">payCallback</span>(
            <span class="hljs-variable">@RequestParam</span> String orderNo,
            <span class="hljs-variable">@RequestParam</span> Integer version) {
        <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">success</span> = <span class="hljs-selector-tag">orderService</span><span class="hljs-selector-class">.handlePayCallback</span>(orderNo, version);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">success</span> ? "å›è°ƒå¤„ç†æˆåŠŸ" : "å›è°ƒå¤„ç†å¤±è´¥ï¼ˆé‡å¤è¯·æ±‚æˆ–çŠ¶æ€å·²å˜æ›´ï¼‰";
    }
}
</code></pre>
<h4 data-id="heading-25">5. åº“å­˜æœåŠ¡ï¼ˆidempotent-inventoryï¼‰</h4>
<h5 data-id="heading-26">5.1 é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8082</span>

<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">idempotent-inventory</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/idempotent_db?useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
  <span class="hljs-attr">rocketmq:</span>
    <span class="hljs-attr">name-server:</span> <span class="hljs-string">localhost:9876</span>
    <span class="hljs-attr">consumer:</span>
      <span class="hljs-attr">group:</span> <span class="hljs-string">inventory-consumer-group</span>

<span class="hljs-attr">spring.cloud.nacos.discovery:</span>
  <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span>

<span class="hljs-attr">mybatis-plus:</span>
  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath:mapper/*.xml</span>
  <span class="hljs-attr">type-aliases-package:</span> <span class="hljs-string">com.example.idempotent.inventory.entity</span>
  <span class="hljs-attr">configuration:</span>
    <span class="hljs-attr">map-underscore-to-camel-case:</span> <span class="hljs-literal">true</span>
</code></pre>
<h5 data-id="heading-27">5.2 æ•°æ®åº“è¡¨è®¾è®¡ï¼ˆåº“å­˜è¡¨ï¼‰</h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åº“å­˜è¡¨ï¼ˆä¹è§‚é”é˜²æ­¢é‡å¤æ‰£å‡ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_inventory` (
  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'ä¸»é”®ID'</span>,
  `product_id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å•†å“ID'</span>,
  `stock` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åº“å­˜æ•°é‡'</span>,
  `version` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰'</span>,
  `create_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  `update_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  <span class="hljs-keyword">UNIQUE</span> KEY `uk_product_id` (`product_id`) COMMENT <span class="hljs-string">'å•†å“IDå”¯ä¸€'</span>
) ENGINE<span class="hljs-operator">=</span>InnoDB <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'åº“å­˜è¡¨'</span>;

<span class="hljs-comment">-- åˆå§‹åŒ–åº“å­˜æ•°æ®</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_inventory` (`product_id`, `stock`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1001</span>, <span class="hljs-number">100</span>);
</code></pre>
<h5 data-id="heading-28">5.3 MQæ¶ˆè´¹è€…ï¼ˆå¤„ç†æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">idempotent</span>.<span class="hljs-property">inventory</span>.<span class="hljs-property">mq</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">example</span>.<span class="hljs-property">idempotent</span>.<span class="hljs-property">common</span>.<span class="hljs-property">util</span>.<span class="hljs-property">RedisUtil</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">example</span>.<span class="hljs-property">idempotent</span>.<span class="hljs-property">inventory</span>.<span class="hljs-property">service</span>.<span class="hljs-property">InventoryService</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">apache</span>.<span class="hljs-property">rocketmq</span>.<span class="hljs-property">spring</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">RocketMQMessageListener</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">apache</span>.<span class="hljs-property">rocketmq</span>.<span class="hljs-property">spring</span>.<span class="hljs-property">core</span>.<span class="hljs-property">RocketMQListener</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;

<span class="hljs-keyword">import</span> javax.<span class="hljs-property">annotation</span>.<span class="hljs-property">Resource</span>;

<span class="hljs-comment">/**
 * åº“å­˜æ¶ˆè´¹è€…ï¼šå¤„ç†åº“å­˜æ‰£å‡æ¶ˆæ¯ï¼ˆå¹‚ç­‰å¤„ç†ï¼šæ¶ˆæ¯ID+Redisï¼‰
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RocketMQMessageListener</span>(topic = <span class="hljs-string">"topic-deduct-inventory"</span>, consumerGroup = <span class="hljs-string">"inventory-consumer-group"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;<span class="hljs-title class_">OrderMqProducer</span>.<span class="hljs-property">DeductInventoryMsg</span>&gt; {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">InventoryService</span> inventoryService;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">RedisUtil</span> redisUtil;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onMessage</span>(<span class="hljs-params">OrderMqProducer.DeductInventoryMsg msg</span>) {
        <span class="hljs-comment">// 1. è·å–RocketMQæ¶ˆæ¯IDï¼ˆé€šè¿‡ThreadLocalè·å–ï¼Œéœ€è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨ï¼‰</span>
        <span class="hljs-title class_">String</span> msgId = <span class="hljs-title class_">MqMsgIdContextHolder</span>.<span class="hljs-title function_">getMsgId</span>();
        <span class="hljs-keyword">if</span> (msgId == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–æ¶ˆæ¯IDå¤±è´¥ï¼Œæ— æ³•è¿›è¡Œå¹‚ç­‰æ ¡éªŒ"</span>);
        }

        <span class="hljs-comment">// 2. æ„å»ºRediså¹‚ç­‰é”®ï¼ˆæ¶ˆæ¯IDå”¯ä¸€ï¼‰</span>
        <span class="hljs-title class_">String</span> redisKey = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">format</span>(<span class="hljs-string">"mq:idempotent:%s"</span>, msgId);

        <span class="hljs-comment">// 3. å¹‚ç­‰æ ¡éªŒï¼šå·²å¤„ç†è¿‡çš„æ¶ˆæ¯ç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> (redisUtil.<span class="hljs-title function_">hasKey</span>(redisKey)) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ¶ˆæ¯å·²å¤„ç†ï¼Œè·³è¿‡é‡å¤æ¶ˆè´¹ï¼š"</span> + msgId);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 4. æ‰£å‡åº“å­˜ï¼ˆä¹è§‚é”ä¿è¯å¹‚ç­‰ï¼‰</span>
            <span class="hljs-built_in">boolean</span> success = inventoryService.<span class="hljs-title function_">deductStock</span>(msg.<span class="hljs-title function_">getProductId</span>(), msg.<span class="hljs-title function_">getNum</span>());
            <span class="hljs-keyword">if</span> (success) {
                <span class="hljs-comment">// 5. åº“å­˜æ‰£å‡æˆåŠŸï¼Œæ ‡è®°æ¶ˆæ¯å·²å¤„ç†ï¼ˆRedisè¿‡æœŸæ—¶é—´1å°æ—¶ï¼‰</span>
                redisUtil.<span class="hljs-title function_">setIfAbsent</span>(redisKey, <span class="hljs-string">"processed"</span>, <span class="hljs-number">3600</span>, java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>.<span class="hljs-property">SECONDS</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åº“å­˜æ‰£å‡å¤±è´¥ï¼šåº“å­˜ä¸è¶³æˆ–é‡å¤æ‰£å‡"</span>);
            }
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
            <span class="hljs-comment">// 6. å¤„ç†å¤±è´¥ï¼šå¯æ ¹æ®ä¸šåŠ¡éœ€è¦é‡è¯•æˆ–å‘Šè­¦</span>
            <span class="hljs-title class_">System</span>.<span class="hljs-property">err</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"åº“å­˜æ‰£å‡å¼‚å¸¸ï¼š"</span> + e.<span class="hljs-title function_">getMessage</span>());
            <span class="hljs-keyword">throw</span> e;
        }
    }

    <span class="hljs-comment">// æ¶ˆæ¯IDä¸Šä¸‹æ–‡æŒæœ‰ç±»ï¼ˆé€šè¿‡è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨è®¾ç½®ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MqMsgIdContextHolder</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">ThreadLocal</span>&lt;<span class="hljs-title class_">String</span>&gt; <span class="hljs-variable constant_">MSG_ID_HOLDER</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setMsgId</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> msgId</span>) {
            <span class="hljs-variable constant_">MSG_ID_HOLDER</span>.<span class="hljs-title function_">set</span>(msgId);
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getMsgId</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">MSG_ID_HOLDER</span>.<span class="hljs-title function_">get</span>();
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable constant_">MSG_ID_HOLDER</span>.<span class="hljs-title function_">remove</span>();
        }
    }
}
</code></pre>
<h5 data-id="heading-29">5.4 è‡ªå®šä¹‰RocketMQæ¶ˆæ¯è½¬æ¢å™¨ï¼ˆè·å–æ¶ˆæ¯IDï¼‰</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.example.idempotent.inventory.config;

<span class="hljs-keyword">import</span> com.example.idempotent.inventory.mq.InventoryConsumer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.MessageExt;
<span class="hljs-keyword">import</span> org.apache.rocketmq.spring.support.DefaultRocketMQMessageConverter;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Configuration;
<span class="hljs-keyword">import</span> org.springframework.messaging.Message;
<span class="hljs-keyword">import</span> org.springframework.messaging.converter.MessageConverter;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RocketMQConfig</span> {

    <span class="hljs-comment">/**
     * è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨ï¼šè·å–RocketMQæ¶ˆæ¯IDå¹¶å­˜å…¥ä¸Šä¸‹æ–‡
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> MessageConverter rocketMQMessageConverter() {
        <span class="hljs-keyword">return</span> new DefaultRocketMQMessageConverter() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> Object fromMessage(Message&lt;?&gt; message, Class&lt;?&gt; targetClass) {
                <span class="hljs-comment">// è·å–RocketMQåŸå§‹æ¶ˆæ¯</span>
                MessageExt messageExt = (MessageExt) message.getHeaders().<span class="hljs-keyword">get</span>(<span class="hljs-string">"rocketmq_messageExt"</span>);
                <span class="hljs-keyword">if</span> (messageExt != <span class="hljs-literal">null</span>) {
                    <span class="hljs-comment">// å°†æ¶ˆæ¯IDå­˜å…¥ä¸Šä¸‹æ–‡</span>
                    InventoryConsumer.MqMsgIdContextHolder.setMsgId(messageExt.getMsgId());
                }
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.fromMessage(message, targetClass);
                } <span class="hljs-keyword">finally</span> {
                    <span class="hljs-comment">// æ¸…é™¤ä¸Šä¸‹æ–‡ï¼Œé¿å…å†…å­˜æ³„æ¼</span>
                    InventoryConsumer.MqMsgIdContextHolder.clear();
                }
            }
        };
    }
}
</code></pre>
<h5 data-id="heading-30">5.5 åº“å­˜Serviceï¼ˆä¹è§‚é”æ‰£å‡ï¼‰</h5>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> com.example.idempotent.inventory.service;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.<span class="hljs-type">ServiceImpl</span>;
<span class="hljs-keyword">import</span> com.example.idempotent.inventory.entity.<span class="hljs-type">Inventory</span>;
<span class="hljs-keyword">import</span> com.example.idempotent.inventory.mapper.<span class="hljs-type">InventoryMapper</span>;
<span class="hljs-keyword">import</span> org.springframework.stereotype.<span class="hljs-type">Service</span>;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.<span class="hljs-type">Transactional</span>;

<span class="hljs-keyword">import</span> javax.annotation.<span class="hljs-type">Resource</span>;

<span class="hljs-meta">@Service</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InventoryService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceImpl&lt;InventoryMapper</span>, <span class="hljs-title">Inventory&gt;</span> </span>{

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">InventoryMapper</span> inventoryMapper;

    <span class="hljs-comment">/**
     * æ‰£å‡åº“å­˜ï¼ˆä¹è§‚é”ä¿è¯å¹‚ç­‰ï¼‰
     */</span>
    <span class="hljs-meta">@Transactional</span>(rollbackFor = <span class="hljs-type">Exception</span>.<span class="hljs-keyword">class</span>)
    public boolean deductStock(<span class="hljs-type">Long</span> productId, <span class="hljs-type">Integer</span> num) {
        <span class="hljs-comment">// ä¹è§‚é”æ‰£å‡ï¼šä»…å½“ç‰ˆæœ¬å·åŒ¹é…æ—¶æ‰£å‡åº“å­˜</span>
        int rows = inventoryMapper.deductStock(productId, num);
        <span class="hljs-keyword">return</span> rows &gt; <span class="hljs-number">0</span>;
    }
}
</code></pre>
<h3 data-id="heading-31">äº”ã€æµ‹è¯•éªŒè¯</h3>
<h4 data-id="heading-32">1. ç¯å¢ƒå‡†å¤‡</h4>
<ul>
<li>å¯åŠ¨ Nacosï¼ˆç«¯å£8848ï¼‰</li>
<li>å¯åŠ¨ Redisï¼ˆç«¯å£6379ï¼‰</li>
<li>å¯åŠ¨ RocketMQï¼ˆNameServerç«¯å£9876ï¼ŒBrokerç«¯å£10911ï¼‰</li>
<li>å¯åŠ¨ MySQLï¼Œæ‰§è¡Œä¸Šè¿°SQLåˆ›å»ºæ•°æ®åº“å’Œè¡¨</li>
<li>å¯åŠ¨è®¢å•æœåŠ¡ï¼ˆ8081ï¼‰å’Œåº“å­˜æœåŠ¡ï¼ˆ8082ï¼‰</li>
</ul>
<h4 data-id="heading-33">2. æµ‹è¯•åœºæ™¯1ï¼šé‡å¤ä¸‹å•ï¼ˆPostmanï¼‰</h4>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8081/order/create</code></p>
</li>
<li>
<p>è¯·æ±‚å¤´ï¼š</p>
<ul>
<li><code>Idempotent-Request-Id: test-123456</code>ï¼ˆåŒä¸€IDé‡å¤æäº¤ï¼‰</li>
<li><code>User-Id: 1001</code></li>
</ul>
</li>
<li>
<p>è¯·æ±‚å‚æ•°ï¼š<code>productId=1001&amp;amount=99.9</code></p>
</li>
<li>
<p>æµ‹è¯•ç»“æœï¼š</p>
<ul>
<li>ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼šæˆåŠŸåˆ›å»ºè®¢å•ï¼Œåº“å­˜æ‰£å‡1ï¼ˆåº“å­˜å˜ä¸º99ï¼‰</li>
<li>ç¬¬äºŒæ¬¡è¯·æ±‚ï¼šè¿”å›409å†²çªï¼Œæç¤ºâ€œä¸‹å•è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·1åˆ†é’Ÿåé‡è¯•ï¼â€ï¼Œè®¢å•è¡¨æ— é‡å¤æ•°æ®ï¼Œåº“å­˜ä¸å˜</li>
</ul>
</li>
</ul>
<h4 data-id="heading-34">3. æµ‹è¯•åœºæ™¯2ï¼šæ”¯ä»˜å›è°ƒé‡è¯•</h4>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8081/order/pay/callback</code></p>
</li>
<li>
<p>è¯·æ±‚å¤´ï¼š<code>Idempotent-Request-Id: pay-789</code></p>
</li>
<li>
<p>è¯·æ±‚å‚æ•°ï¼š<code>orderNo=xxxï¼ˆç¬¬ä¸€æ¬¡ä¸‹å•è¿”å›çš„orderNoï¼‰&amp;version=0</code></p>
</li>
<li>
<p>æµ‹è¯•ç»“æœï¼š</p>
<ul>
<li>ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼šè®¢å•çŠ¶æ€ä»0â†’1ï¼Œè¿”å›â€œå›è°ƒå¤„ç†æˆåŠŸâ€</li>
<li>ç¬¬äºŒæ¬¡è¯·æ±‚ï¼šè¿”å›â€œå›è°ƒå¤„ç†å¤±è´¥ï¼ˆé‡å¤è¯·æ±‚æˆ–çŠ¶æ€å·²å˜æ›´ï¼‰â€ï¼Œè®¢å•çŠ¶æ€ä¸å˜</li>
</ul>
</li>
</ul>
<h4 data-id="heading-35">4. æµ‹è¯•åœºæ™¯3ï¼šæ¶ˆæ¯é‡å¤æ¶ˆè´¹</h4>
<ul>
<li>æ‰‹åŠ¨åœ¨RocketMQæ§åˆ¶å°é‡å‘â€œtopic-deduct-inventoryâ€ä¸»é¢˜çš„æ¶ˆæ¯</li>
<li>è§‚å¯Ÿåº“å­˜æœåŠ¡æ—¥å¿—ï¼šè¾“å‡ºâ€œæ¶ˆæ¯å·²å¤„ç†ï¼Œè·³è¿‡é‡å¤æ¶ˆè´¹ï¼šxxxâ€ï¼Œåº“å­˜ä¸å˜</li>
</ul>
<h4 data-id="heading-36">æ€»ç»“</h4>
<ol start="6">
<li>
<p><strong>æ ¸å¿ƒåœºæ™¯</strong>ï¼šSpring Cloud ä¸­å¹‚ç­‰æ€§ä¸»è¦åº”ç”¨äºã€Œé‡å¤æäº¤ã€æœåŠ¡é‡è¯•ã€æ¶ˆæ¯é‡å¤æ¶ˆè´¹ã€æ”¯ä»˜å›è°ƒã€ç­‰åˆ†å¸ƒå¼åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæ–¹æ¡ˆ</strong>ï¼šé€šè¿‡ã€ŒRedis+å”¯ä¸€IDã€æ‹¦æˆªé‡å¤è¯·æ±‚ã€ã€Œæ•°æ®åº“å”¯ä¸€çº¦æŸã€é˜²æ­¢é‡å¤æ’å…¥ã€ã€Œä¹è§‚é”+çŠ¶æ€æœºã€æ§åˆ¶æ•°æ®æ›´æ–°ï¼Œä¸‰å±‚é˜²æŠ¤ç¡®ä¿å¹‚ç­‰ã€‚</p>
</li>
<li>
<p><strong>å…³é”®å®ç°</strong>ï¼š</p>
<ol>
<li>ç”¨è‡ªå®šä¹‰æ³¨è§£+æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†å¹‚ç­‰æ ¡éªŒï¼Œå‡å°‘é‡å¤ä»£ç ï¼›</li>
<li>ç»“åˆRediså®ç°åˆ†å¸ƒå¼å¹‚ç­‰ï¼Œé€‚é…å¾®æœåŠ¡è·¨èŠ‚ç‚¹éƒ¨ç½²ï¼›</li>
<li>æ•°æ®åº“çº¦æŸå’Œä¹è§‚é”ä½œä¸ºæœ€ç»ˆæ•°æ®é˜²æŠ¤ï¼Œé¿å…æç«¯æƒ…å†µä¸‹çš„å¼‚å¸¸ã€‚</li>
</ol>
</li>
</ol>
<p>è¿™å¥—æ–¹æ¡ˆå¯ç›´æ¥åº”ç”¨äºå®é™…å¼€å‘ï¼Œæ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯è°ƒæ•´è¿‡æœŸæ—¶é—´ã€å¹‚ç­‰é”®è§„åˆ™å³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é£ç‰›Nas-é€šè¿‡Dockerçš„Compose å®‰è£…WordPress]]></title>    <link>https://juejin.cn/post/7579229538792292358</link>    <guid>https://juejin.cn/post/7579229538792292358</guid>    <pubDate>2025-12-03T07:46:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579229538792292358" data-draft-id="7579179625462743082" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é£ç‰›Nas-é€šè¿‡Dockerçš„Compose å®‰è£…WordPress"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T07:46:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="PieroPC"/> <meta itemprop="url" content="https://juejin.cn/user/1998231182522521"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é£ç‰›Nas-é€šè¿‡Dockerçš„Compose å®‰è£…WordPress
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1998231182522521/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    PieroPC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:46:00.000Z" title="Wed Dec 03 2025 07:46:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å›¾ï¼š</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed4a4565b45342248c4f3c8a7d4675f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765352760&amp;x-signature=obzQq67V4WhKILyzTrd2gq269Js%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">compose.yml ä»£ç ï¼š</h2>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">wordpress_db</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">command:</span> 
      <span class="hljs-bullet">-</span> <span class="hljs-string">--default-authentication-plugin=mysql_native_password</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--character-set-server=utf8mb4</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--collation-server=utf8mb4_unicode_ci</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root_password_here</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">wordpress</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">wordpress_user</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">wordpress_password_here</span>
      <span class="hljs-attr">MYSQL_ALLOW_EMPTY_PASSWORD:</span> <span class="hljs-string">"no"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db_data:/var/lib/mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./mysql/conf.d:/etc/mysql/conf.d:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./mysql/init:/docker-entrypoint-initdb.d:ro</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"mysqladmin"</span>, <span class="hljs-string">"ping"</span>, <span class="hljs-string">"-h"</span>, <span class="hljs-string">"localhost"</span>, <span class="hljs-string">"-u"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"-p$$MYSQL_ROOT_PASSWORD"</span>]
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">20s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">10</span>
      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">wp-network</span>

  <span class="hljs-attr">wordpress:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">wordpress:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">wordpress_app</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-attr">db:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">service_healthy</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:80"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">WORDPRESS_DB_HOST:</span> <span class="hljs-string">db:3306</span>
      <span class="hljs-attr">WORDPRESS_DB_NAME:</span> <span class="hljs-string">wordpress</span>
      <span class="hljs-attr">WORDPRESS_DB_USER:</span> <span class="hljs-string">wordpress_user</span>
      <span class="hljs-attr">WORDPRESS_DB_PASSWORD:</span> <span class="hljs-string">wordpress_password_here</span>
      <span class="hljs-attr">WORDPRESS_TABLE_PREFIX:</span> <span class="hljs-string">wp_</span>
      <span class="hljs-attr">WORDPRESS_DEBUG:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">WORDPRESS_CONFIG_EXTRA:</span> <span class="hljs-string">|
        define('WP_DEBUG_LOG', true);
        define('WP_DEBUG_DISPLAY', false);
        define('SAVEQUERIES', true);
</span>    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">wp_data:/var/www/html</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./themes:/var/www/html/wp-content/themes</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./plugins:/var/www/html/wp-content/plugins</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./uploads:/var/www/html/wp-content/uploads</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./config/php.ini:/usr/local/etc/php/conf.d/custom.ini</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">wp-network</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">db_data:</span>
  <span class="hljs-attr">wp_data:</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">wp-network:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
</code></pre>
<h2 data-id="heading-2">æ“ä½œï¼š</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c76c53b11f2f4f49955543fff0184d51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765352760&amp;x-signature=yZPkKzmVhHHjtxYsZS8XvosR%2FOg%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">æ³¨ï¼š</h2>
<p>ä¾‹å¦‚ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.2.50%3A8080%2Flogin" target="_blank" title="http://192.168.2.50:8080/login" ref="nofollow noopener noreferrer">http://192.168.2.50:8080/login</a> è¿›å…¥åå°</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºRabbitMQçš„ä¼ä¸šçº§è®¢å•ç³»ç»Ÿè®¾è®¡ä¸å®ç°]]></title>    <link>https://juejin.cn/post/7579410911056986138</link>    <guid>https://juejin.cn/post/7579410911056986138</guid>    <pubDate>2025-12-03T07:33:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579410911056986138" data-draft-id="7579255046979174426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºRabbitMQçš„ä¼ä¸šçº§è®¢å•ç³»ç»Ÿè®¾è®¡ä¸å®ç°"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T07:33:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆå“ˆå“ˆç¬‘ä»€ä¹ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/808832912075352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºRabbitMQçš„ä¼ä¸šçº§è®¢å•ç³»ç»Ÿè®¾è®¡ä¸å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/808832912075352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆå“ˆå“ˆç¬‘ä»€ä¹ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T07:33:03.000Z" title="Wed Dec 03 2025 07:33:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäºRabbitMQçš„ä¼ä¸šçº§è®¢å•ç³»ç»Ÿè®¾è®¡ä¸å®ç°æ–‡æ¡£</h2>
<h3 data-id="heading-1">ä¸€ã€æ–‡æ¡£æ¦‚è¿°</h3>
<p>æœ¬æ–‡æ¡£æ•´åˆäº†å¤šè½®æ²Ÿé€šä¸­å…³äºâ€œRabbitMQè§£å†³è®¢å•é¡ºåºé”™ä¹±â€â€œåº“å­˜æ‰£å‡å¹¶å‘æ§åˆ¶â€â€œè·¨æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡â€â€œä¼ä¸šçº§ä¸‹å•æµç¨‹â€çš„æ ¸å¿ƒå†…å®¹ï¼Œæä¾›ä»æŠ€æœ¯æ–¹æ¡ˆåˆ°ä»£ç è½åœ°ã€ä»æµç¨‹è®¾è®¡åˆ°çŠ¶æ€æµè½¬çš„å®Œæ•´å®ç°æŒ‡å—ï¼Œé€‚ç”¨äºSpring Cloudå¾®æœåŠ¡æ¶æ„ä¸‹çš„é«˜å¹¶å‘è®¢å•åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">äºŒã€RabbitMQè§£å†³å¤šè®¢å•åŒæ­¥é¡ºåºé”™ä¹±æ–¹æ¡ˆ</h3>
<h4 data-id="heading-3">2.1 é—®é¢˜æ ¹æºä¸è®¾è®¡åŸåˆ™</h4>
<p>è®¢å•é¡ºåºé”™ä¹±çš„æ ¸å¿ƒåŸå› æ˜¯â€œæ¶ˆæ¯ç”Ÿäº§æ— åºâ€æˆ–â€œæ¶ˆæ¯æ¶ˆè´¹å¹¶è¡Œâ€ï¼Œéœ€éµå¾ªä»¥ä¸‹è®¾è®¡åŸåˆ™ï¼š</p>
<ol>
<li><strong>ç”Ÿäº§ç«¯æœ‰åº</strong>ï¼šåŒä¸€è®¢å•çš„æ¶ˆæ¯ï¼ˆåˆ›å»ºâ†’æ”¯ä»˜â†’å‘è´§ï¼‰æŒ‰ä¸šåŠ¡é¡ºåºåŒæ­¥å‘é€ï¼Œé€šè¿‡è®¢å•å·Hashè·¯ç”±åˆ°å›ºå®šé˜Ÿåˆ—ï¼›</li>
<li><strong>æ¶ˆè´¹ç«¯ä¸²è¡Œ</strong>ï¼šåŒä¸€é˜Ÿåˆ—é…ç½®<code>concurrency=1</code>ï¼ˆå•çº¿ç¨‹æ¶ˆè´¹ï¼‰ï¼Œé¿å…å¹¶è¡Œå¤„ç†ç ´åé¡ºåºï¼›</li>
<li><strong>æ‰‹åŠ¨ACKæœºåˆ¶</strong>ï¼šç¡®ä¿æ¶ˆæ¯å¤„ç†å®Œæˆåå†ç¡®è®¤ï¼Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±å¯¼è‡´é¡ºåºæ–­å±‚ï¼›</li>
<li><strong>å¹‚ç­‰æ€§é˜²æŠ¤</strong>ï¼šåŸºäºè®¢å•å·+æ¶ˆæ¯åºå·å»é‡ï¼Œé¿å…é‡è¯•å¯¼è‡´é‡å¤æ‰§è¡Œä¸šåŠ¡ï¼›</li>
<li><strong>é˜Ÿåˆ—åˆ†åŒºè·¯ç”±</strong>ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹æŒ‰è®¢å•å·Hashåˆ†é…é˜Ÿåˆ—ï¼Œå¹³è¡¡â€œé¡ºåºæ€§â€ä¸â€œå¹¶å‘æ€§èƒ½â€ã€‚</li>
</ol>
<h4 data-id="heading-4">2.2 æŠ€æœ¯é€‰å‹</h4>



































<table><thead><tr><th>ç»„ä»¶</th><th>ç‰ˆæœ¬/ç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>æ ¸å¿ƒæ¡†æ¶</td><td>Spring Cloud 2023.0.0</td><td>å¾®æœåŠ¡åŸºç¡€æ¶æ„</td></tr><tr><td>æ¶ˆæ¯ä¸­é—´ä»¶</td><td>RabbitMQ 3.12+</td><td>æ¶ˆæ¯æŠ•é€’ä¸é¡ºåºæ§åˆ¶</td></tr><tr><td>æ¶ˆæ¯é›†æˆ</td><td>Spring Cloud Stream</td><td>ç®€åŒ–RabbitMQé…ç½®ä¸æ¶ˆæ¯ç»‘å®š</td></tr><tr><td>å¹‚ç­‰æ€§å­˜å‚¨</td><td>Redis</td><td>è®¢å•æ¶ˆæ¯å»é‡æ ‡è¯†å­˜å‚¨</td></tr><tr><td>æ•°æ®åº“</td><td>MySQL</td><td>è®¢å•ä¸åº“å­˜æ ¸å¿ƒæ•°æ®å­˜å‚¨</td></tr></tbody></table>
<h4 data-id="heading-5">2.3 æ ¸å¿ƒé…ç½®ä¸ä»£ç å®ç°</h4>
<h5 data-id="heading-6">2.3.1 ç”Ÿäº§è€…é…ç½®ï¼ˆè®¢å•æœåŠ¡ï¼‰</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">order-service</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">admin123</span>
    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">order-vhost</span>
    <span class="hljs-attr">publisher-confirm-type:</span> <span class="hljs-string">correlated</span>  <span class="hljs-comment"># æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</span>
    <span class="hljs-attr">publisher-returns:</span> <span class="hljs-literal">true</span>              <span class="hljs-comment"># æ¶ˆæ¯è¿”å›æœºåˆ¶</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">stream:</span>
      <span class="hljs-attr">rabbit:</span>
        <span class="hljs-attr">bindings:</span>
          <span class="hljs-attr">order-output:</span>
            <span class="hljs-attr">producer:</span>
              <span class="hljs-attr">durable:</span> <span class="hljs-literal">true</span>              <span class="hljs-comment"># æ¶ˆæ¯æŒä¹…åŒ–</span>
              <span class="hljs-attr">channel-transacted:</span> <span class="hljs-literal">true</span>   <span class="hljs-comment"># äº‹åŠ¡ç¡®ä¿ç”Ÿäº§é¡ºåº</span>
      <span class="hljs-attr">bindings:</span>
        <span class="hljs-attr">order-output:</span>
          <span class="hljs-attr">destination:</span> <span class="hljs-string">order-exchange</span>    <span class="hljs-comment"># ç»‘å®šäº¤æ¢æœº</span>
          <span class="hljs-attr">producer:</span>
            <span class="hljs-attr">exchange-type:</span> <span class="hljs-string">topic</span>         <span class="hljs-comment"># ä¸»é¢˜äº¤æ¢æœºï¼ˆæ”¯æŒè·¯ç”±ï¼‰</span>
          <span class="hljs-attr">content-type:</span> <span class="hljs-string">application/json</span>
      <span class="hljs-attr">binders:</span>
        <span class="hljs-attr">rabbit-binder:</span>
          <span class="hljs-attr">type:</span> <span class="hljs-string">rabbit</span>
          <span class="hljs-attr">environment:</span>
            <span class="hljs-attr">spring: rabbitmq:</span> {<span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>, <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>, <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>, <span class="hljs-attr">password:</span> <span class="hljs-string">admin123</span>, <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">order-vhost</span>}
<span class="hljs-comment"># é˜Ÿåˆ—åˆ†åŒºé…ç½®</span>
<span class="hljs-attr">order:</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">queue-count:</span> <span class="hljs-number">3</span>                       <span class="hljs-comment"># 3ä¸ªé˜Ÿåˆ—å®ç°å¹¶è¡Œ</span>
    <span class="hljs-attr">routing-key-prefix:</span> <span class="hljs-string">order.route.</span>
</code></pre>
<h5 data-id="heading-7">2.3.2 æ¶ˆè´¹è€…é…ç½®ï¼ˆè®¢å•åŒæ­¥æœåŠ¡ï¼‰</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">order-sync-service</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">admin123</span>
    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">order-vhost</span>
    <span class="hljs-attr">listener:</span>
      <span class="hljs-attr">simple:</span>
        <span class="hljs-attr">acknowledge-mode:</span> <span class="hljs-string">manual</span>         <span class="hljs-comment"># æ‰‹åŠ¨ACK</span>
        <span class="hljs-attr">concurrency:</span> <span class="hljs-number">1</span>                   <span class="hljs-comment"># å•çº¿ç¨‹æ¶ˆè´¹</span>
        <span class="hljs-attr">max-concurrency:</span> <span class="hljs-number">1</span>
        <span class="hljs-attr">prefetch:</span> <span class="hljs-number">1</span>                      <span class="hljs-comment"># é¢„å–1æ¡æ¶ˆæ¯ï¼Œé¿å…ç¼“å­˜ä¹±åº</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">stream:</span>
      <span class="hljs-attr">rabbit:</span>
        <span class="hljs-attr">bindings:</span>
          <span class="hljs-attr">order-input:</span>
            <span class="hljs-attr">consumer:</span>
              <span class="hljs-attr">durable:</span> <span class="hljs-literal">true</span>
              <span class="hljs-attr">auto-bind-dlq:</span> <span class="hljs-literal">true</span>        <span class="hljs-comment"># å¼€å¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆå¤„ç†å¤±è´¥æ¶ˆæ¯ï¼‰</span>
              <span class="hljs-attr">dlq-ttl:</span> <span class="hljs-number">86400000</span>          <span class="hljs-comment"># æ­»ä¿¡æ¶ˆæ¯è¿‡æœŸæ—¶é—´ï¼ˆ24hï¼‰</span>
              <span class="hljs-attr">republish-to-dlq:</span> <span class="hljs-literal">true</span>     <span class="hljs-comment"># å¤±è´¥æ¶ˆæ¯é‡å‘å¸ƒåˆ°æ­»ä¿¡é˜Ÿåˆ—</span>
      <span class="hljs-attr">bindings:</span>
        <span class="hljs-attr">order-input:</span>
          <span class="hljs-attr">destination:</span> <span class="hljs-string">order-exchange</span>
          <span class="hljs-attr">content-type:</span> <span class="hljs-string">application/json</span>
          <span class="hljs-attr">consumer:</span>
            <span class="hljs-attr">exchange-type:</span> <span class="hljs-string">topic</span>
            <span class="hljs-attr">routing-key-pattern:</span> <span class="hljs-string">order.route.*</span>  <span class="hljs-comment"># è®¢é˜…æ‰€æœ‰è®¢å•è·¯ç”±é”®</span>
</code></pre>
<h5 data-id="heading-8">2.3.3 æ ¸å¿ƒä»£ç ï¼ˆè®¢å•æ¶ˆæ¯ç”Ÿäº§ä¸æ¶ˆè´¹ï¼‰</h5>
<h6 data-id="heading-9">ï¼ˆ1ï¼‰è®¢å•æ¶ˆæ¯DTO</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> java.io.Serializable;
<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderMessageDTO</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;
    <span class="hljs-keyword">private</span> String orderNo;          <span class="hljs-comment">// è®¢å•å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰</span>
    <span class="hljs-keyword">private</span> Integer orderStatus;     <span class="hljs-comment">// è®¢å•çŠ¶æ€ï¼ˆ1-åˆ›å»ºï¼Œ2-æ”¯ä»˜ï¼Œ3-å‘è´§ï¼‰</span>
    <span class="hljs-keyword">private</span> BigDecimal amount;       <span class="hljs-comment">// è®¢å•é‡‘é¢</span>
    <span class="hljs-keyword">private</span> LocalDateTime sendTime;  <span class="hljs-comment">// æ¶ˆæ¯å‘é€æ—¶é—´</span>
    <span class="hljs-keyword">private</span> Integer msgSeq;          <span class="hljs-comment">// æ¶ˆæ¯åºå·ï¼ˆä¿è¯åŒè®¢å•å†…é¡ºåºï¼‰</span>
}
</code></pre>
<h6 data-id="heading-10">ï¼ˆ2ï¼‰è®¢å•æ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆæŒ‰è®¢å•å·Hashè·¯ç”±ï¼‰</h6>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> cn.<span class="hljs-property">hutool</span>.<span class="hljs-property">core</span>.<span class="hljs-property">lang</span>.<span class="hljs-property">hash</span>.<span class="hljs-property">MurmurHash</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Autowired</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Value</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cloud</span>.<span class="hljs-property">stream</span>.<span class="hljs-property">messaging</span>.<span class="hljs-property">Source</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">messaging</span>.<span class="hljs-property">support</span>.<span class="hljs-property">MessageBuilder</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderMessageProducer</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderOutputChannel</span> orderOutputChannel;  <span class="hljs-comment">// è‡ªå®šä¹‰è¾“å‡ºé€šé“</span>
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">"${order.rabbitmq.routing-key-prefix}"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> routingKeyPrefix;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">"${order.rabbitmq.queue-count}"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> queueCount;

    <span class="hljs-comment">// å‘é€è®¢å•æ¶ˆæ¯ï¼ˆæ ¸å¿ƒï¼šæŒ‰è®¢å•å·Hashè·¯ç”±åˆ°å›ºå®šé˜Ÿåˆ—ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">sendOrderMessage</span>(<span class="hljs-params">OrderMessageDTO orderMessage</span>) {
        <span class="hljs-comment">// ç”Ÿæˆè·¯ç”±é”®ï¼šè®¢å•å·Hashå–æ¨¡ï¼Œç¡®ä¿åŒè®¢å•è¿›åŒä¸€é˜Ÿåˆ—</span>
        <span class="hljs-title class_">String</span> routingKey = <span class="hljs-title function_">generateRoutingKey</span>(orderMessage.<span class="hljs-title function_">getOrderNo</span>());
        <span class="hljs-comment">// æ„å»ºå¹¶å‘é€æ¶ˆæ¯</span>
        org.<span class="hljs-property">springframework</span>.<span class="hljs-property">messaging</span>.<span class="hljs-property">Message</span>&lt;<span class="hljs-title class_">OrderMessageDTO</span>&gt; message = <span class="hljs-title class_">MessageBuilder</span>
                .<span class="hljs-title function_">withPayload</span>(orderMessage)
                .<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"spring.cloud.stream.sendto.destination"</span>, routingKey)
                .<span class="hljs-title function_">build</span>();
        orderOutputChannel.<span class="hljs-title function_">output</span>().<span class="hljs-title function_">send</span>(message);
    }

    <span class="hljs-comment">// ç”Ÿæˆè·¯ç”±é”®ï¼ˆMurmurHashç¡®ä¿åˆ†å¸ƒå‡åŒ€ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">generateRoutingKey</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> orderNo</span>) {
        int hash = <span class="hljs-title class_">MurmurHash</span>.<span class="hljs-title function_">hash32</span>(orderNo);
        int queueIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(hash) % queueCount;
        <span class="hljs-keyword">return</span> routingKeyPrefix + queueIndex;
    }
}
</code></pre>
<h6 data-id="heading-11">ï¼ˆ3ï¼‰è®¢å•æ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆå•çº¿ç¨‹+æ‰‹åŠ¨ACKï¼‰</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.Message;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.cloud.stream.annotation.StreamListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderMessageConsumer</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> IdempotentHandler idempotentHandler;  <span class="hljs-comment">// å¹‚ç­‰æ€§å·¥å…·ç±»</span>

    <span class="hljs-meta">@StreamListener(OrderInputChannel.ORDER_INPUT)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consumeOrderMessage</span><span class="hljs-params">(OrderMessageDTO message, Channel channel, Message amqpMessage)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">long</span> <span class="hljs-variable">deliveryTag</span> <span class="hljs-operator">=</span> amqpMessage.getMessageProperties().getDeliveryTag();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. å¹‚ç­‰æ€§æ£€æŸ¥ï¼šé¿å…é‡å¤æ¶ˆè´¹</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">isFirstProcess</span> <span class="hljs-operator">=</span> idempotentHandler.checkAndSet(message.getOrderNo(), message.getMsgSeq());
            <span class="hljs-keyword">if</span> (!isFirstProcess) {
                channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-comment">// 2. ä¸šåŠ¡å¤„ç†ï¼ˆæŒ‰è®¢å•çŠ¶æ€æ‰§è¡ŒåŒæ­¥é€»è¾‘ï¼‰</span>
            processOrderBusiness(message);
            <span class="hljs-comment">// 3. æ‰‹åŠ¨ACKï¼šå¤„ç†æˆåŠŸç¡®è®¤æ¶ˆæ¯</span>
            channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// 4. æ‰‹åŠ¨NACKï¼šå¤„ç†å¤±è´¥ï¼Œæ¶ˆæ¯è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—</span>
            channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
        }
    }

    <span class="hljs-comment">// è®¢å•ä¸šåŠ¡å¤„ç†ï¼ˆåˆ›å»º/æ”¯ä»˜/å‘è´§é€»è¾‘ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrderBusiness</span><span class="hljs-params">(OrderMessageDTO message)</span> {
        <span class="hljs-keyword">switch</span> (message.getOrderStatus()) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                System.out.printf(<span class="hljs-string">"åŒæ­¥è®¢å•åˆ›å»ºï¼š%s%n"</span>, message.getOrderNo());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
                System.out.printf(<span class="hljs-string">"åŒæ­¥è®¢å•æ”¯ä»˜ï¼š%s%n"</span>, message.getOrderNo());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
                System.out.printf(<span class="hljs-string">"åŒæ­¥è®¢å•å‘è´§ï¼š%s%n"</span>, message.getOrderNo());
                <span class="hljs-keyword">break</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-12">ä¸‰ã€å¤šè®¢å•åº“å­˜æ‰£å‡å¹¶å‘æ§åˆ¶</h3>
<h4 data-id="heading-13">3.1 åº“å­˜æ‰£å‡æ ¸å¿ƒé£é™©</h4>
<ol start="6">
<li><strong>åº“å­˜è¶…å–</strong>ï¼šå¤šè®¢å•åŒæ—¶è¯»å–åº“å­˜å¹¶æ‰£å‡ï¼Œå¯¼è‡´åº“å­˜ä¸ºè´Ÿï¼›</li>
<li><strong>æ•°æ®ä¸ä¸€è‡´</strong>ï¼šåº“å­˜æ‰£å‡æˆåŠŸä½†è®¢å•å¤„ç†å¤±è´¥ï¼Œæˆ–åä¹‹ï¼›</li>
<li><strong>è·¨æœåŠ¡è€¦åˆ</strong>ï¼šåº“å­˜ä½œä¸ºç‹¬ç«‹æœåŠ¡æ—¶ï¼ŒåŒæ­¥è°ƒç”¨æ˜“å¯¼è‡´è¶…æ—¶æˆ–æœåŠ¡ä¾èµ–æ•…éšœã€‚</li>
</ol>
<h4 data-id="heading-14">3.2 è§£å†³æ–¹æ¡ˆï¼šRedisé¢„æ‰£å‡+åˆ†å¸ƒå¼é”+ä¹è§‚é”</h4>
<h5 data-id="heading-15">3.2.1 æŠ€æœ¯åŸç†</h5>
<ol start="9">
<li><strong>Redisé¢„æ‰£å‡</strong>ï¼šç¼“å­˜å•†å“åº“å­˜ï¼Œé«˜å¹¶å‘ä¸‹å¿«é€Ÿåˆ¤æ–­åº“å­˜æ˜¯å¦å……è¶³ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®ï¼›</li>
<li><strong>åˆ†å¸ƒå¼é”ï¼ˆRedissonï¼‰</strong> ï¼šé”å®šå•†å“ç»´åº¦ï¼Œé˜²æ­¢å¤šè®¢å•åŒæ—¶æ‰£å‡åŒä¸€å•†å“åº“å­˜ï¼›</li>
<li><strong>æ•°æ®åº“ä¹è§‚é”</strong>ï¼šé€šè¿‡<code>version</code>å­—æ®µç¡®ä¿åº“å­˜æ‰£å‡çš„åŸå­æ€§ï¼Œé¿å…å¹¶å‘å†™å†²çªã€‚</li>
</ol>
<h5 data-id="heading-16">3.2.2 æ ¸å¿ƒä»£ç å®ç°</h5>
<h6 data-id="heading-17">ï¼ˆ1ï¼‰åº“å­˜å®ä½“ä¸æ•°æ®åº“è®¾è®¡</h6>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å•†å“åº“å­˜è¡¨ï¼ˆå«ä¹è§‚é”ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> product_stock (
  id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
  product_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å•†å“ID'</span>,
  stock_num <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å½“å‰åº“å­˜'</span>,
  locked_num <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'å·²é”å®šåº“å­˜ï¼ˆæœªæ”¯ä»˜è®¢å•å ç”¨ï¼‰'</span>,
  version <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'ä¹è§‚é”ç‰ˆæœ¬å·'</span>,
  create_time DATETIME <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  update_time DATETIME <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">UNIQUE</span> KEY uk_product_id (product_id)
);
</code></pre>
<h6 data-id="heading-18">ï¼ˆ2ï¼‰åº“å­˜æ‰£å‡æœåŠ¡</h6>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> org.<span class="hljs-property">redisson</span>.<span class="hljs-property">api</span>.<span class="hljs-property">RLock</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Autowired</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">data</span>.<span class="hljs-property">redis</span>.<span class="hljs-property">core</span>.<span class="hljs-property">StringRedisTemplate</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">transaction</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Transactional</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StockDeductService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ProductStockRepository</span> stockRepository;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">StringRedisTemplate</span> redisTemplate;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">StockLockUtil</span> stockLockUtil;  <span class="hljs-comment">// åˆ†å¸ƒå¼é”å·¥å…·ç±»</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-variable constant_">REDIS_STOCK_KEY</span> = <span class="hljs-string">"product:stock:"</span>;

    <span class="hljs-comment">// åº“å­˜æ‰£å‡æ ¸å¿ƒæ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">deductStock</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> productId, Integer buyNum, <span class="hljs-built_in">String</span> orderNo</span>) {
        <span class="hljs-comment">// 1. Redisé¢„åˆ¤æ–­åº“å­˜</span>
        <span class="hljs-title class_">String</span> redisKey = <span class="hljs-variable constant_">REDIS_STOCK_KEY</span> + productId;
        <span class="hljs-title class_">String</span> stockStr = redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">get</span>(redisKey);
        <span class="hljs-keyword">if</span> (stockStr == <span class="hljs-literal">null</span>) <span class="hljs-title function_">loadStockToRedis</span>(productId);  <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­ï¼Œä»DBåŠ è½½</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Integer</span>.<span class="hljs-built_in">parseInt</span>(stockStr) &lt; buyNum) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

        <span class="hljs-comment">// 2. è·å–åˆ†å¸ƒå¼é”ï¼ˆé”å®šå•†å“ï¼‰</span>
        <span class="hljs-title class_">RLock</span> lock = stockLockUtil.<span class="hljs-title function_">lock</span>(productId, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>);  <span class="hljs-comment">// ç­‰å¾…3sï¼ŒæŒæœ‰10s</span>
        <span class="hljs-keyword">if</span> (lock == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 3. æ•°æ®åº“åŒé‡æ ¡éªŒ+ä¹è§‚é”æ‰£å‡</span>
            <span class="hljs-title class_">ProductStock</span> stock = stockRepository.<span class="hljs-title function_">findByProductId</span>(productId)
                    .<span class="hljs-title function_">orElseThrow</span>(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å•†å“ä¸å­˜åœ¨ï¼š"</span> + productId));
            <span class="hljs-keyword">if</span> (stock.<span class="hljs-title function_">getStockNum</span>() &lt; buyNum) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-comment">// ä¹è§‚é”æ‰£å‡ï¼šversionä¸åŒ¹é…åˆ™æ›´æ–°å¤±è´¥ï¼ˆè¿”å›0ï¼‰</span>
            int affectedRows = stockRepository.<span class="hljs-title function_">deductStock</span>(stock.<span class="hljs-title function_">getId</span>(), buyNum, stock.<span class="hljs-title function_">getVersion</span>());
            <span class="hljs-keyword">if</span> (affectedRows != <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

            <span class="hljs-comment">// 4. æ›´æ–°Redisç¼“å­˜</span>
            redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">decrement</span>(redisKey, buyNum);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">finally</span> {
            stockLockUtil.<span class="hljs-title function_">unlock</span>(lock);  <span class="hljs-comment">// é‡Šæ”¾é”</span>
        }
    }

    <span class="hljs-comment">// ä»DBåŠ è½½åº“å­˜åˆ°Redis</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">loadStockToRedis</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> productId</span>) {
        <span class="hljs-title class_">ProductStock</span> stock = stockRepository.<span class="hljs-title function_">findByProductId</span>(productId)
                .<span class="hljs-title function_">orElseThrow</span>(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å•†å“ä¸å­˜åœ¨ï¼š"</span> + productId));
        redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">set</span>(<span class="hljs-variable constant_">REDIS_STOCK_KEY</span> + productId, stock.<span class="hljs-title function_">getStockNum</span>().<span class="hljs-title function_">toString</span>());
    }

    <span class="hljs-comment">// åº“å­˜å›æ»šï¼ˆè®¢å•å–æ¶ˆæ—¶è°ƒç”¨ï¼‰</span>
    <span class="hljs-meta">@Transactional</span>(rollbackFor = <span class="hljs-title class_">Exception</span>.<span class="hljs-property">class</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">rollbackStock</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> productId, Integer buyNum</span>) {
        <span class="hljs-title class_">ProductStock</span> stock = stockRepository.<span class="hljs-title function_">findByProductId</span>(productId)
                .<span class="hljs-title function_">orElseThrow</span>(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å•†å“ä¸å­˜åœ¨ï¼š"</span> + productId));
        stock.<span class="hljs-title function_">setStockNum</span>(stock.<span class="hljs-title function_">getStockNum</span>() + buyNum);
        stockRepository.<span class="hljs-title function_">save</span>(stock);
        redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">increment</span>(<span class="hljs-variable constant_">REDIS_STOCK_KEY</span> + productId, buyNum);
    }
}
</code></pre>
<h6 data-id="heading-19">ï¼ˆ3ï¼‰åˆ†å¸ƒå¼é”å·¥å…·ç±»</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.redisson.api.RLock;
<span class="hljs-keyword">import</span> org.redisson.api.RedissonClient;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StockLockUtil</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedissonClient redissonClient;

    <span class="hljs-comment">// è·å–å•†å“åº“å­˜é”</span>
    <span class="hljs-keyword">public</span> RLock <span class="hljs-title function_">lock</span><span class="hljs-params">(String productId, <span class="hljs-type">long</span> waitTime, <span class="hljs-type">long</span> leaseTime)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">lockKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"stock:lock:"</span> + productId;
        <span class="hljs-type">RLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> redissonClient.getLock(lockKey);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> lock.tryLock(waitTime, leaseTime, TimeUnit.SECONDS) ? lock : <span class="hljs-literal">null</span>;
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }

    <span class="hljs-comment">// é‡Šæ”¾é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">(RLock lock)</span> {
        <span class="hljs-keyword">if</span> (lock != <span class="hljs-literal">null</span> &amp;&amp; lock.isHeldByCurrentThread()) lock.unlock();
    }
}
</code></pre>
<h3 data-id="heading-20">å››ã€è·¨æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡ä¸ä¸€è‡´æ€§ä¿éšœ</h3>
<h4 data-id="heading-21">4.1 æ ¸å¿ƒé—®é¢˜ï¼šè·¨æœåŠ¡åŸå­æ€§</h4>
<p>è®¢å•æœåŠ¡ï¼ˆAï¼‰ä¸åº“å­˜æœåŠ¡ï¼ˆBï¼‰ç‹¬ç«‹éƒ¨ç½²ï¼Œéœ€ç¡®ä¿â€œè®¢å•é¢„åˆ›å»º+åº“å­˜æ‰£å‡â€è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ï¼Œéœ€é€šè¿‡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³ã€‚</p>
<h4 data-id="heading-22">4.2 æœ€ä¼˜æ–¹æ¡ˆï¼šå¯é æ¶ˆæ¯+æœ€ç»ˆä¸€è‡´æ€§</h4>
<h5 data-id="heading-23">4.2.1 æ–¹æ¡ˆåŸç†</h5>
<p>åŸºäºRabbitMQå®ç°â€œå¯é æ¶ˆæ¯æŠ•é€’+æ¶ˆè´¹ç¡®è®¤+å®šæ—¶è¡¥å¿â€ï¼Œç¡®ä¿è·¨æœåŠ¡æ•°æ®æœ€ç»ˆä¸€è‡´ï¼š</p>
<ol start="12">
<li><strong>å¯é æ¶ˆæ¯æŠ•é€’</strong>ï¼šè®¢å•æœåŠ¡é¢„åˆ›å»ºè®¢å•åï¼Œé€šè¿‡äº‹åŠ¡ç¡®ä¿æ¶ˆæ¯å¿…å…¥é˜Ÿï¼›</li>
<li><strong>å¯é æ¶ˆæ¯æ¶ˆè´¹</strong>ï¼šåº“å­˜æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯å¹¶æ‰§è¡Œæ‰£å‡ï¼Œå¤„ç†å®Œæˆåå‘é€ç»“æœæ¶ˆæ¯ï¼›</li>
<li><strong>ç»“æœå¤„ç†</strong>ï¼šè®¢å•æœåŠ¡æ¶ˆè´¹ç»“æœæ¶ˆæ¯ï¼Œæ›´æ–°è®¢å•çŠ¶æ€ï¼ˆæˆåŠŸç¡®è®¤/å¤±è´¥å›æ»šï¼‰ï¼›</li>
<li><strong>å®šæ—¶è¡¥å¿</strong>ï¼šå¤„ç†æ¶ˆæ¯ä¸¢å¤±æˆ–å»¶è¿Ÿå¯¼è‡´çš„ä¸ä¸€è‡´ã€‚</li>
</ol>
<h5 data-id="heading-24">4.2.2 è·¨æœåŠ¡æµç¨‹è®¾è®¡</h5>
<pre><code class="hljs language-css" lang="css">graph <span class="hljs-selector-tag">TD</span>
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[ç”¨æˆ·ä¸‹å•]</span> --&gt; <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[è®¢å•æœåŠ¡ï¼šé¢„åˆ›å»ºè®¢å•ï¼ˆçŠ¶æ€0ï¼šå¾…ç¡®è®¤ï¼‰]</span>
    <span class="hljs-selector-tag">B</span> --&gt; C<span class="hljs-selector-attr">[è®¢å•æœåŠ¡ï¼šå‘é€åº“å­˜æ‰£å‡æ¶ˆæ¯ï¼ˆäº‹åŠ¡ç¡®ä¿æŠ•é€’ï¼‰]</span>
    C --&gt; D<span class="hljs-selector-attr">[åº“å­˜æœåŠ¡ï¼šæ¶ˆè´¹æ¶ˆæ¯ï¼Œæ‰§è¡Œæ‰£å‡]</span>
    D --&gt; E{æ‰£å‡æˆåŠŸï¼Ÿ}
    E --&gt;|æ˜¯| F<span class="hljs-selector-attr">[åº“å­˜æœåŠ¡ï¼šå‘é€â€œæ‰£å‡æˆåŠŸâ€æ¶ˆæ¯]</span>
    E --&gt;|å¦| G<span class="hljs-selector-attr">[åº“å­˜æœåŠ¡ï¼šå‘é€â€œæ‰£å‡å¤±è´¥â€æ¶ˆæ¯]</span>
    F --&gt; H<span class="hljs-selector-attr">[è®¢å•æœåŠ¡ï¼šæ›´æ–°è®¢å•çŠ¶æ€ä¸º1ï¼ˆå¾…æ”¯ä»˜ï¼‰]</span>
    G --&gt; <span class="hljs-selector-tag">I</span><span class="hljs-selector-attr">[è®¢å•æœåŠ¡ï¼šåˆ é™¤é¢„åˆ›å»ºè®¢å•ï¼ˆå›æ»šï¼‰]</span>
    J<span class="hljs-selector-attr">[å®šæ—¶è¡¥å¿ä»»åŠ¡]</span> --&gt; K<span class="hljs-selector-attr">[æŸ¥è¯¢è¶…æ—¶â€œå¾…ç¡®è®¤â€è®¢å•]</span>
    K --&gt; L<span class="hljs-selector-attr">[è°ƒç”¨åº“å­˜æœåŠ¡æŸ¥è¯¢æ‰£å‡çŠ¶æ€]</span>
    L --&gt; M{å·²æ‰£å‡ï¼Ÿ}
    M --&gt;|æ˜¯| H
    M --&gt;|å¦| <span class="hljs-selector-tag">I</span>
</code></pre>
<h5 data-id="heading-25">4.2.3 æ ¸å¿ƒä»£ç å®ç°</h5>
<h6 data-id="heading-26">ï¼ˆ1ï¼‰è®¢å•æœåŠ¡ï¼šé¢„åˆ›å»ºè®¢å•ä¸æ¶ˆæ¯å‘é€</h6>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Service</span>
public class OrderService {
    <span class="hljs-keyword">@Autowired</span>
    private OrderMainRepository orderRepository;
    <span class="hljs-keyword">@Autowired</span>
    private StockMessageChannel stockMessageChannel;  <span class="hljs-comment">// åº“å­˜æ¶ˆæ¯é€šé“</span>

    <span class="hljs-comment">// æ ¸å¿ƒä¸‹å•æµç¨‹ï¼šé¢„åˆ›å»ºè®¢å•â†’å‘é€åº“å­˜æ‰£å‡æ¶ˆæ¯</span>
    <span class="hljs-keyword">@Transactional</span>(rollbackFor = Exception.class)
    public boolean createOrder(String orderNo, String productId, Integer buyNum) {
        try {
            <span class="hljs-comment">// 1. é¢„åˆ›å»ºè®¢å•ï¼ˆçŠ¶æ€0ï¼šå¾…ç¡®è®¤ï¼Œæœªå ç”¨åº“å­˜ï¼‰</span>
            OrderMain preOrder = new <span class="hljs-built_in">OrderMain</span>();
            preOrder<span class="hljs-selector-class">.setOrderNo</span>(orderNo);
            preOrder<span class="hljs-selector-class">.setProductId</span>(productId);
            preOrder<span class="hljs-selector-class">.setBuyNum</span>(buyNum);
            preOrder<span class="hljs-selector-class">.setOrderStatus</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// 0-å¾…ç¡®è®¤</span>
            orderRepository<span class="hljs-selector-class">.save</span>(preOrder);

            <span class="hljs-comment">// 2. å‘é€åº“å­˜æ‰£å‡æ¶ˆæ¯ï¼ˆäº‹åŠ¡ç¡®ä¿ï¼šè®¢å•é¢„åˆ›å»ºæˆåŠŸåˆ™æ¶ˆæ¯å¿…å‘ï¼‰</span>
            StockDeductRequestDTO request = new <span class="hljs-built_in">StockDeductRequestDTO</span>();
            request<span class="hljs-selector-class">.setOrderNo</span>(orderNo);
            request<span class="hljs-selector-class">.setProductId</span>(productId);
            request<span class="hljs-selector-class">.setBuyNum</span>(buyNum);
            request<span class="hljs-selector-class">.setMessageId</span>(IdUtil.fastSimpleUUID());  <span class="hljs-comment">// æ¶ˆæ¯å”¯ä¸€IDï¼ˆå¹‚ç­‰ï¼‰</span>
            stockMessageChannel<span class="hljs-selector-class">.stockDeductOutput</span>()<span class="hljs-selector-class">.send</span>(
                    MessageBuilder.withPayload(request)<span class="hljs-selector-class">.build</span>()
            );
            return true;
        } catch (Exception e) {
            return false;  <span class="hljs-comment">// å¼‚å¸¸æ—¶æœ¬åœ°äº‹åŠ¡å›æ»šï¼Œé¢„åˆ›å»ºè®¢å•åˆ é™¤</span>
        }
    }
}
</code></pre>
<h6 data-id="heading-27">ï¼ˆ2ï¼‰åº“å­˜æœåŠ¡ï¼šæ¶ˆè´¹æ‰£å‡æ¶ˆæ¯å¹¶è¿”å›ç»“æœ</h6>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Service</span>
public class StockDeductHandler {
    <span class="hljs-keyword">@Autowired</span>
    private StockDeductService stockDeductService;
    <span class="hljs-keyword">@Autowired</span>
    private StockMessageChannel stockMessageChannel;
    <span class="hljs-keyword">@Autowired</span>
    private IdempotentHandler idempotentHandler;

    <span class="hljs-keyword">@StreamListener</span>(StockMessageChannel.STOCK_DEDUCT_INPUT)
    public void handleStockDeduct(StockDeductRequestDTO request, Channel channel, Message amqpMessage) throws Exception {
        long deliveryTag = amqpMessage<span class="hljs-selector-class">.getMessageProperties</span>()<span class="hljs-selector-class">.getDeliveryTag</span>();
        String messageId = request<span class="hljs-selector-class">.getMessageId</span>();
        try {
            <span class="hljs-comment">// 1. å¹‚ç­‰æ€§æ£€æŸ¥ï¼šé¿å…é‡å¤æ‰£å‡</span>
            if (!idempotentHandler.checkAndSet(messageId, <span class="hljs-number">1</span>)) {
                channel<span class="hljs-selector-class">.basicAck</span>(deliveryTag, false);
                return;
            }
            <span class="hljs-comment">// 2. æ‰§è¡Œåº“å­˜æ‰£å‡</span>
            boolean success = stockDeductService<span class="hljs-selector-class">.deductStock</span>(
                    request.getProductId(), request<span class="hljs-selector-class">.getBuyNum</span>(), request<span class="hljs-selector-class">.getOrderNo</span>()
            );
            <span class="hljs-comment">// 3. å‘é€æ‰£å‡ç»“æœ</span>
            StockDeductResultDTO result = new <span class="hljs-built_in">StockDeductResultDTO</span>();
            result<span class="hljs-selector-class">.setOrderNo</span>(request.getOrderNo());
            result<span class="hljs-selector-class">.setMessageId</span>(messageId);
            result<span class="hljs-selector-class">.setSuccess</span>(success);
            stockMessageChannel<span class="hljs-selector-class">.stockResultOutput</span>()<span class="hljs-selector-class">.send</span>(
                    MessageBuilder.withPayload(result)<span class="hljs-selector-class">.build</span>()
            );
            <span class="hljs-comment">// 4. ç¡®è®¤æ¶ˆæ¯</span>
            channel<span class="hljs-selector-class">.basicAck</span>(deliveryTag, false);
        } catch (Exception e) {
            <span class="hljs-comment">// 5. å¤±è´¥å¤„ç†ï¼šå‘é€å¤±è´¥ç»“æœ+æ‹’ç»æ¶ˆæ¯</span>
            StockDeductResultDTO failResult = new <span class="hljs-built_in">StockDeductResultDTO</span>();
            failResult<span class="hljs-selector-class">.setOrderNo</span>(request.getOrderNo());
            failResult<span class="hljs-selector-class">.setMessageId</span>(messageId);
            failResult<span class="hljs-selector-class">.setSuccess</span>(false);
            stockMessageChannel<span class="hljs-selector-class">.stockResultOutput</span>()<span class="hljs-selector-class">.send</span>(MessageBuilder.withPayload(failResult)<span class="hljs-selector-class">.build</span>());
            channel<span class="hljs-selector-class">.basicNack</span>(deliveryTag, false, false);
        }
    }
}
</code></pre>
<h6 data-id="heading-28">ï¼ˆ3ï¼‰è®¢å•æœåŠ¡ï¼šæ¶ˆè´¹æ‰£å‡ç»“æœå¹¶æ›´æ–°çŠ¶æ€</h6>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Service</span>
public class StockResultHandler {
    <span class="hljs-keyword">@Autowired</span>
    private OrderMainRepository orderRepository;

    <span class="hljs-keyword">@StreamListener</span>(StockMessageChannel.STOCK_RESULT_INPUT)
    <span class="hljs-keyword">@Transactional</span>(rollbackFor = Exception.class)
    public void handleStockResult(StockDeductResultDTO result) {
        String orderNo = result<span class="hljs-selector-class">.getOrderNo</span>();
        OrderMain <span class="hljs-attribute">order</span> = orderRepository<span class="hljs-selector-class">.findByOrderNo</span>(orderNo)
                <span class="hljs-selector-class">.orElseThrow</span>(() -&gt; new <span class="hljs-built_in">RuntimeException</span>("è®¢å•ä¸å­˜åœ¨ï¼š" + orderNo));
        
        if (result.isSuccess()) {
            <span class="hljs-comment">// æ‰£å‡æˆåŠŸï¼šæ›´æ–°è®¢å•çŠ¶æ€ä¸º1ï¼ˆå¾…æ”¯ä»˜ï¼‰</span>
            <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setOrderStatus</span>(<span class="hljs-number">1</span>);
            <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setStockDeductStatus</span>(<span class="hljs-number">1</span>);
        } else {
            <span class="hljs-comment">// æ‰£å‡å¤±è´¥ï¼šåˆ é™¤é¢„åˆ›å»ºè®¢å•ï¼ˆå›æ»šï¼‰</span>
            orderRepository<span class="hljs-selector-class">.delete</span>(order);
        }
        orderRepository<span class="hljs-selector-class">.save</span>(order);
    }
}
</code></pre>
<h6 data-id="heading-29">ï¼ˆ4ï¼‰å®šæ—¶è¡¥å¿ä»»åŠ¡ï¼ˆç¡®ä¿æœ€ç»ˆä¸€è‡´æ€§ï¼‰</h6>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Component</span>
public class OrderCompensateTask {
    <span class="hljs-keyword">@Autowired</span>
    private OrderMainRepository orderRepository;
    <span class="hljs-keyword">@Autowired</span>
    private StockFeignClient stockFeignClient;  <span class="hljs-comment">// è°ƒç”¨åº“å­˜æœåŠ¡çš„Feignæ¥å£</span>

    <span class="hljs-comment">// æ¯5åˆ†é’Ÿæ‰§è¡Œï¼šå¤„ç†è¶…æ—¶â€œå¾…ç¡®è®¤â€è®¢å•</span>
    <span class="hljs-keyword">@Scheduled</span>(cron = <span class="hljs-string">"0 0/5 * * * ?"</span>)
    <span class="hljs-keyword">@Transactional</span>(rollbackFor = Exception.class)
    public void compensatePendingOrder() {
        LocalDateTime tenMinutesAgo = LocalDateTime<span class="hljs-selector-class">.now</span>()<span class="hljs-selector-class">.minus</span>(<span class="hljs-number">10</span>, ChronoUnit.MINUTES);
        <span class="hljs-comment">// æŸ¥è¯¢10åˆ†é’Ÿå‰ä»ä¸ºâ€œå¾…ç¡®è®¤â€çš„è®¢å•</span>
        List&lt;OrderMain&gt; pendingOrders = orderRepository<span class="hljs-selector-class">.findByOrderStatusAndCreateTimeBefore</span>(<span class="hljs-number">0</span>, tenMinutesAgo);
        
        for (OrderMain order : pendingOrders) {
            <span class="hljs-comment">// è°ƒç”¨åº“å­˜æœåŠ¡æŸ¥è¯¢æ‰£å‡çŠ¶æ€</span>
            boolean hasDeducted = stockFeignClient<span class="hljs-selector-class">.checkStockDeducted</span>(order.getOrderNo());
            if (hasDeducted) {
                <span class="hljs-comment">// åº“å­˜å·²æ‰£å‡ï¼šæ›´æ–°è®¢å•çŠ¶æ€</span>
                <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setOrderStatus</span>(<span class="hljs-number">1</span>);
                <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setStockDeductStatus</span>(<span class="hljs-number">1</span>);
                orderRepository<span class="hljs-selector-class">.save</span>(order);
            } else {
                <span class="hljs-comment">// åº“å­˜æœªæ‰£å‡ï¼šåˆ é™¤è®¢å•</span>
                orderRepository<span class="hljs-selector-class">.delete</span>(order);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-30">äº”ã€ä¼ä¸šçº§ä¸‹å•å…¨æµç¨‹ä¸è®¢å•çŠ¶æ€æµè½¬</h3>
<h4 data-id="heading-31">5.1 é¢„åˆ›å»ºè®¢å•ä¸æ™®é€šåˆ›å»ºçš„åŒºåˆ«</h4>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>é¢„åˆ›å»ºè®¢å•ï¼ˆä¸´æ—¶è®¢å•ï¼‰</th><th>æ™®é€šåˆ›å»ºè®¢å•ï¼ˆæœ€ç»ˆè®¢å•ï¼‰</th></tr></thead><tbody><tr><td>æ ¸å¿ƒç›®çš„</td><td>å è®¢å•å·ã€ä¸ºè·¨æœåŠ¡å›æ»šç•™å‡ºå£</td><td>ç¡®è®¤äº¤æ˜“ç”Ÿæ•ˆï¼Œæ”¯æŒåç»­å±¥çº¦ï¼ˆæ”¯ä»˜/å‘è´§ï¼‰</td></tr><tr><td>çŠ¶æ€å±æ€§</td><td>ä¸´æ—¶çŠ¶æ€ï¼ˆå¯åˆ é™¤/å›æ»šï¼‰</td><td>æ­£å¼çŠ¶æ€ï¼ˆä¸å¯éšæ„ä¿®æ”¹ï¼‰</td></tr><tr><td>èµ„æºå ç”¨</td><td>ä¸å ç”¨åº“å­˜ã€ä¼˜æƒ åˆ¸ç­‰æ ¸å¿ƒèµ„æº</td><td>å ç”¨åº“å­˜ã€é”å®šä¼˜æƒ åˆ¸</td></tr><tr><td>å›æ»šæˆæœ¬</td><td>æä½ï¼ˆç›´æ¥åˆ é™¤ä¸´æ—¶è®°å½•ï¼‰</td><td>æé«˜ï¼ˆéœ€å›æ»šåº“å­˜ã€è§£é”èµ„æºï¼‰</td></tr><tr><td>ä¸šåŠ¡æ„ä¹‰</td><td>å‘ŠçŸ¥ç”¨æˆ·â€œè®¢å•å¤„ç†ä¸­â€</td><td>å‘ŠçŸ¥ç”¨æˆ·â€œè®¢å•åˆ›å»ºæˆåŠŸâ€</td></tr></tbody></table>
<h4 data-id="heading-32">5.2 è®¢å•æ ¸å¿ƒçŠ¶æ€å®šä¹‰</h4>





















































<table><thead><tr><th>çŠ¶æ€å€¼</th><th>çŠ¶æ€åç§°</th><th>è§¦å‘æ¡ä»¶</th><th>ä¸šåŠ¡å«ä¹‰</th></tr></thead><tbody><tr><td>0</td><td>å¾…ç¡®è®¤ï¼ˆé¢„åˆ›å»ºï¼‰</td><td>ç”¨æˆ·æäº¤è®¢å•ï¼Œè®¢å•æœåŠ¡é¢„åˆ›å»ºè®°å½•</td><td>è®¢å•ä¸´æ—¶å ä½ï¼Œç­‰å¾…åº“å­˜æ‰£å‡ç­‰å‰ç½®æ¡ä»¶</td></tr><tr><td>1</td><td>å¾…æ”¯ä»˜</td><td>åº“å­˜æ‰£å‡æˆåŠŸï¼Œè®¢å•æœåŠ¡æ›´æ–°çŠ¶æ€</td><td>è®¢å•æ­£å¼åˆ›å»ºï¼Œç­‰å¾…ç”¨æˆ·æ”¯ä»˜</td></tr><tr><td>2</td><td>å·²æ”¯ä»˜/å¾…å‘è´§</td><td>ç”¨æˆ·å®Œæˆæ”¯ä»˜ï¼Œæ”¯ä»˜æœåŠ¡é€šçŸ¥è®¢å•æœåŠ¡</td><td>æ”¯ä»˜å®Œæˆï¼Œç­‰å¾…å•†å®¶å‘è´§</td></tr><tr><td>3</td><td>å·²å‘è´§</td><td>å•†å®¶æ“ä½œå‘è´§ï¼Œè®¢å•æœåŠ¡åŒæ­¥ç‰©æµä¿¡æ¯</td><td>å•†å“å·²å‘å‡ºï¼Œç­‰å¾…ç”¨æˆ·æ”¶è´§</td></tr><tr><td>4</td><td>å·²å®Œæˆ</td><td>ç”¨æˆ·ç¡®è®¤æ”¶è´§æˆ–ç³»ç»Ÿè¶…æ—¶è‡ªåŠ¨ç¡®è®¤</td><td>è®¢å•é—­ç¯ï¼Œäº¤æ˜“å®Œæˆ</td></tr><tr><td>5</td><td>å·²å–æ¶ˆ</td><td>ç”¨æˆ·å–æ¶ˆæœªæ”¯ä»˜è®¢å•ï¼Œæˆ–é€€æ¬¾å®Œæˆ</td><td>è®¢å•ç»ˆæ­¢ï¼Œèµ„æºï¼ˆåº“å­˜/ä¼˜æƒ åˆ¸ï¼‰å›æ»š</td></tr><tr><td>6</td><td>åˆ›å»ºå¤±è´¥</td><td>åº“å­˜æ‰£å‡å¤±è´¥ã€å‚æ•°æ ¡éªŒå¤±è´¥ç­‰</td><td>è®¢å•æœªåˆ›å»ºæˆåŠŸï¼Œæ— èµ„æºå ç”¨</td></tr></tbody></table>
<h4 data-id="heading-33">5.3 å®Œæ•´çŠ¶æ€æµè½¬é“¾è·¯</h4>
<h5 data-id="heading-34">5.3.1 æ­£å¸¸ä¸‹å•é“¾è·¯</h5>
<p>ç”¨æˆ·æäº¤è®¢å• â†’ é¢„åˆ›å»ºè®¢å•ï¼ˆ0ï¼šå¾…ç¡®è®¤ï¼‰ â†’ åº“å­˜æ‰£å‡æˆåŠŸ â†’ è®¢å•çŠ¶æ€1ï¼ˆå¾…æ”¯ä»˜ï¼‰ â†’ ç”¨æˆ·æ”¯ä»˜æˆåŠŸ â†’ è®¢å•çŠ¶æ€2ï¼ˆå·²æ”¯ä»˜/å¾…å‘è´§ï¼‰ â†’ å•†å®¶å‘è´§ â†’ è®¢å•çŠ¶æ€3ï¼ˆå·²å‘è´§ï¼‰ â†’ ç”¨æˆ·ç¡®è®¤æ”¶è´§ â†’ è®¢å•çŠ¶æ€4ï¼ˆå·²å®Œæˆï¼‰ã€‚</p>
<h5 data-id="heading-35">5.3.2 å¼‚å¸¸åœºæ™¯é“¾è·¯</h5>
<ol start="16">
<li><strong>åº“å­˜ä¸è¶³</strong>ï¼šç”¨æˆ·æäº¤è®¢å• â†’ é¢„åˆ›å»ºè®¢å•ï¼ˆ0ï¼‰ â†’ åº“å­˜æ‰£å‡å¤±è´¥ â†’ åˆ é™¤è®¢å• â†’ çŠ¶æ€6ï¼ˆåˆ›å»ºå¤±è´¥ï¼‰ï¼›</li>
<li><strong>æ”¯ä»˜è¶…æ—¶</strong>ï¼šè®¢å•çŠ¶æ€1ï¼ˆå¾…æ”¯ä»˜ï¼‰ â†’ è¶…æ—¶æœªæ”¯ä»˜ â†’ è®¢å•çŠ¶æ€5ï¼ˆå·²å–æ¶ˆï¼‰ â†’ åº“å­˜å›æ»šï¼›</li>
<li><strong>æ”¯ä»˜åé€€æ¬¾</strong>ï¼šè®¢å•çŠ¶æ€2ï¼ˆå·²æ”¯ä»˜ï¼‰ â†’ ç”¨æˆ·ç”³è¯·é€€æ¬¾ â†’ å•†å®¶åŒæ„ â†’ æ”¯ä»˜æœåŠ¡é€€æ¬¾ â†’ è®¢å•çŠ¶æ€5ï¼ˆå·²å–æ¶ˆï¼‰ â†’ åº“å­˜å›æ»šã€‚</li>
</ol>
<h3 data-id="heading-36">å…­ã€æ€»ç»“</h3>
<ol start="19">
<li><strong>è®¢å•é¡ºåºæ§åˆ¶</strong>ï¼šåŸºäºRabbitMQé˜Ÿåˆ—åˆ†åŒº+å•çº¿ç¨‹æ¶ˆè´¹ï¼Œç¡®ä¿åŒè®¢å•ä¸²è¡Œã€å¤šè®¢å•å¹¶è¡Œï¼Œè§£å†³é¡ºåºé”™ä¹±é—®é¢˜ï¼›</li>
<li><strong>åº“å­˜å¹¶å‘æ§åˆ¶</strong>ï¼šé€šè¿‡Redisé¢„æ‰£å‡+Redissonåˆ†å¸ƒå¼é”+æ•°æ®åº“ä¹è§‚é”ï¼Œé˜²æ­¢è¶…å–å¹¶ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼›</li>
<li><strong>è·¨æœåŠ¡äº‹åŠ¡</strong>ï¼šé‡‡ç”¨â€œå¯é æ¶ˆæ¯+æœ€ç»ˆä¸€è‡´æ€§â€æ–¹æ¡ˆï¼Œç»“åˆé¢„åˆ›å»ºè®¢å•å’Œå®šæ—¶è¡¥å¿ï¼Œè§£å†³è·¨æœåŠ¡åŸå­æ€§é—®é¢˜ï¼›</li>
<li><strong>ä¼ä¸šçº§æµç¨‹</strong>ï¼šä»¥â€œé¢„åˆ›å»ºâ†’å‰ç½®æ ¡éªŒâ†’ç¡®è®¤è®¢å•â†’å±¥çº¦â€ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡çŠ¶æ€æµè½¬å®ç°è®¢å•å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå…¼é¡¾é«˜å¹¶å‘ä¸æ•°æ®ä¸€è‡´æ€§ã€‚</li>
</ol>
<p>æœ¬æ–¹æ¡ˆå¯ç›´æ¥è½åœ°åˆ°Spring Cloudå¾®æœåŠ¡æ¶æ„çš„è®¢å•ç³»ç»Ÿï¼Œæ”¯æŒé«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç¨³å®šè¿è¡Œï¼ŒåŒæ—¶å…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ï¼ˆå¦‚æ–°å¢ä¼˜æƒ åˆ¸ã€ç‰©æµç­‰æ¨¡å—å¯å¤ç”¨æ¶ˆæ¯æœºåˆ¶ä¸äº‹åŠ¡æ–¹æ¡ˆï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>